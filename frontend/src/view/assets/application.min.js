/* ==========================================================================
   Emm JS - nightly build 12-11-2019
   ========================================================================== */

/* License
   ========================================================================== */

/**
 * EMM License to be added
 *
 **/



/* Libraries
   ========================================================================== */

/**
 * jQuery JavaScript Library v1.11.1
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * (c) 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Licensed under MIT (http://jquery.org/license)
 *
 * http://jquery.com
 **/

/**
 * Lo-Dash 2.4.1 (Custom Build)
 *
 * Build: `lodash -o ./dist/lodash.compat.js`
 *
 * Based on Underscore.js 1.5.2
 * Licensed under MIT (http://underscorejs.org/LICENSE)
 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 *
 * (c) 2012-2013 The Dojo Foundation http://dojofoundation.org/
 * Licensed under MIT (http://lodash.com/license)
 *
 * https://lodash.com/
 **/

 /**
 * D3.js 3.5.5
 *
 * Licensed under MIT (https://github.com/mbostock/d3/blob/master/LICENSE)
 * (c) 2010-2015, Michael Bostock
 *
 * http://d3js.org/
 **/

  /**
 * C3.js 0.4.10
 *
 * Licensed under MIT (https://github.com/masayuki0812/c3/blob/master/LICENSE)
 * (c) 2013 Masayuki Tanaka
 *
 * http://c3js.org/
 **/

/**
 * jQuery Plugins
 *
 * jquery-i18n v1.1.1
 * Licensed under MIT
 * (c) 2010 Dave Perrett
 * https://github.com/recurser/jquery-i18n
 *
 * jquery-migrate v1.2.1
 * Licensed under MIT
 * (c) 2005, 2013 jQuery Foundation, Inc. and other contributors
 * https://github.com/jquery/jquery-migrate
 *
 * jquery-select2 v3.5.2
 * Licensed under Apache License, Version 2.0 & GNU General Public License version 2
 * (c) 2012 Igor Vaynberg
 * https://ivaynberg.github.io/select2/
 *
 * jquery-mousewheel v3.1.9
 * Licensed under MIT
 * (c) 2013 Brandon Aaron
 * http://brandon.aaron.sh
 *
 * jquery-perfect-scrollbar v0.5.7
 * Licensed under MIT
 * (c) 2012, 2014 Hyunje Alex Jun and other contributors
 * https://noraesae.github.io/perfect-scrollbar/
 *
 * jquery DoubleScroll v0.4
 * Dual licensed under the MIT and GPL licenses
 * (c) Pawel Suwala, Antoine Vianey
 * https://github.com/avianey/jqDoubleScroll
 *
 * jquery Endless Scroll
 * Dual licensed under the MIT and GPL licenses
 * (c) 2008-2012 Fred Wu
 * https://github.com/fredwu/jquery-endless-scroll
 *
 * jQuery File Upload Plugin
 * Licensed under the MIT license
 * (c) 2010, Sebastian Tschan
 * https://github.com/blueimp/jQuery-File-Upload
 **/

/**
 * Bootstrap Components v3.2.0
 *
 * dropdown.js
 * modal.js
 * popover.js
 * tooltip.js
 *
 * (c) 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 *
 * http://getbootstrap.com/
 **/

/**
 * Bootstrap Extensions
 *
 * bootstrap-slider v4.8.1
 * Licensed under MIT
 * (c) 2015 Kyle Kemp, Rohit Kalkur, and contributors
 *
 * bootstrap-colorpicker v2.2.0
 * Licensed under Apache License v2.0
 * (c) 2012 Stefan Petre
 *
 **/

/**
 * jQuery UI v1.11.1
 *
 * core.js, widget.js, mouse.js, position.js, accordion.js, autocomplete.js, button.js, datepicker.js, dialog.js, draggable.js, droppable.js, effect.js, effect-blind.js, effect-bounce.js, effect-clip.js, effect-drop.js, effect-explode.js, effect-fade.js, effect-fold.js, effect-highlight.js, effect-puff.js, effect-pulsate.js, effect-scale.js, effect-shake.js, effect-size.js, effect-slide.js, effect-transfer.js, menu.js, progressbar.js, resizable.js, selectable.js, selectmenu.js, slider.js, sortable.js, spinner.js, tabs.js, tooltip.js
 *
 * (c) 2014 jQuery Foundation and other contributors
 * Licensed under MIT
 *
 * http://jqueryui.com
 **/

/**
 * Pickadate v3.5.4
 *
 * date.js
 * time.js
 * legacy.js
 *
 * (c) 2014 Amsul, http://amsul.ca
 * Licensed under https://github.com/amsul/pickadate.js/blob/3.5.4/LICENSE.md
 *
 * https://amsul.github.io/pickadate.js
 **/

/**
 * Ace Editor
 *
 * Distributed under the BSD license:

 * Copyright (c) 2010, Ajax.org B.V.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *     * Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in the
 *       documentation and/or other materials provided with the distribution.
 *     * Neither the name of Ajax.org B.V. nor the
 *       names of its contributors may be used to endorse or promote products
 *       derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * http://ace.c9.io/
 **/

/**
 * iFrame Resizer v2.6.3
 *
 * (c) 2014 David J. Bradshaw - dave@bradshaw.net
 * Licensed under MIT
 *
 * https://davidjbradshaw.github.io/iframe-resizer/
 **/

/**
 * Toastr (modified version)
 *
 * (c) 2012-2014 John Papa and Hans Fj√§llemark
 * Licensed under MIT
 *
 * https://github.com/CodeSeven/toastr
 **/

/**
 * EmojiOne Area v v3.4.1
 *
 * EmojiOneArea is released under the MIT license.
 *
 * Copyright (c) 2015-2017 Andrey Izman <izmanw@gmail.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

var EndlessScroll;if(function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(f,e){function t(e,t){return t.toUpperCase()}var d=[],u=d.slice,g=d.concat,s=d.push,o=d.indexOf,i={},n=i.toString,m=i.hasOwnProperty,v={},r="1.11.1",A=function(e,t){return new A.fn.init(e,t)},a=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,l=/^-ms-/,c=/-([\da-z])/gi;function h(e){var t=e.length,i=A.type(e);return"function"!==i&&!A.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===i||0===t||"number"==typeof t&&0<t&&t-1 in e))}A.fn=A.prototype={jquery:r,constructor:A,selector:"",length:0,toArray:function(){return u.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:u.call(this)},pushStack:function(e){var t=A.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return A.each(this,e,t)},map:function(i){return this.pushStack(A.map(this,function(e,t){return i.call(e,t,e)}))},slice:function(){return this.pushStack(u.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(0<=i&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:s,sort:d.sort,splice:d.splice},A.extend=A.fn.extend=function(){var e,t,i,n,o,r,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||A.isFunction(a)||(a={}),s===l&&(a=this,s--);s<l;s++)if(null!=(o=arguments[s]))for(n in o)e=a[n],a!==(i=o[n])&&(c&&i&&(A.isPlainObject(i)||(t=A.isArray(i)))?(r=t?(t=!1,e&&A.isArray(e)?e:[]):e&&A.isPlainObject(e)?e:{},a[n]=A.extend(c,r,i)):void 0!==i&&(a[n]=i));return a},A.extend({expando:"jQuery"+(r+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===A.type(e)},isArray:Array.isArray||function(e){return"array"===A.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!A.isArray(e)&&0<=e-parseFloat(e)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==A.type(e)||e.nodeType||A.isWindow(e))return!1;try{if(e.constructor&&!m.call(e,"constructor")&&!m.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(v.ownLast)for(t in e)return m.call(e,t);for(t in e);return void 0===t||m.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?i[n.call(e)]||"object":typeof e},globalEval:function(e){e&&A.trim(e)&&(f.execScript||function(e){f.eval.call(f,e)})(e)},camelCase:function(e){return e.replace(l,"ms-").replace(c,t)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var n=0,o=e.length,r=h(e);if(i){if(r)for(;n<o&&!1!==t.apply(e[n],i);n++);else for(n in e)if(!1===t.apply(e[n],i))break}else if(r)for(;n<o&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},trim:function(e){return null==e?"":(e+"").replace(a,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(h(Object(e))?A.merge(i,"string"==typeof e?[e]:e):s.call(i,e)),i},inArray:function(e,t,i){var n;if(t){if(o)return o.call(t,e,i);for(n=t.length,i=i?i<0?Math.max(0,n+i):i:0;i<n;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,t){for(var i=+t.length,n=0,o=e.length;n<i;)e[o++]=t[n++];if(i!=i)for(;void 0!==t[n];)e[o++]=t[n++];return e.length=o,e},grep:function(e,t,i){for(var n=[],o=0,r=e.length,a=!i;o<r;o++)!t(e[o],o)!=a&&n.push(e[o]);return n},map:function(e,t,i){var n,o=0,r=e.length,a=[];if(h(e))for(;o<r;o++)null!=(n=t(e[o],o,i))&&a.push(n);else for(o in e)null!=(n=t(e[o],o,i))&&a.push(n);return g.apply([],a)},guid:1,proxy:function(e,t){var i,n,o;if("string"==typeof t&&(o=e[t],t=e,e=o),A.isFunction(e))return i=u.call(arguments,2),(n=function(){return e.apply(t||this,i.concat(u.call(arguments)))}).guid=e.guid=e.guid||A.guid++,n},now:function(){return+new Date},support:v}),A.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){i["[object "+t+"]"]=t.toLowerCase()});var p=function(i){function d(e,t,i){var n="0x"+t-65536;return n!=n||i?t:n<0?String.fromCharCode(65536+n):String.fromCharCode(n>>10|55296,1023&n|56320)}var e,f,w,r,n,g,h,m,C,c,u,v,_,o,y,b,a,s,A,E="sizzle"+-new Date,x=i.document,S=0,p=0,l=oe(),T=oe(),D=oe(),k=function(e,t){return e===t&&(u=!0),0},R="undefined",O={}.hasOwnProperty,t=[],N=t.pop,F=t.push,M=t.push,P=t.slice,I=t.indexOf||function(e){for(var t=0,i=this.length;t<i;t++)if(this[t]===e)return t;return-1},L="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",G="[\\x20\\t\\r\\n\\f]",$="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",B=$.replace("w","w#"),j="\\["+G+"*("+$+")(?:"+G+"*([*^$|!~]?=)"+G+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+B+"))|)"+G+"*\\]",W=":("+$+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+j+")*)|.*)\\)|)",H=new RegExp("^"+G+"+|((?:^|[^\\\\])(?:\\\\.)*)"+G+"+$","g"),z=new RegExp("^"+G+"*,"+G+"*"),V=new RegExp("^"+G+"*([>+~]|"+G+")"+G+"*"),U=new RegExp("="+G+"*([^\\]'\"]*?)"+G+"*\\]","g"),Y=new RegExp(W),q=new RegExp("^"+B+"$"),Q={ID:new RegExp("^#("+$+")"),CLASS:new RegExp("^\\.("+$+")"),TAG:new RegExp("^("+$.replace("w","w*")+")"),ATTR:new RegExp("^"+j),PSEUDO:new RegExp("^"+W),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+G+"*(even|odd|(([+-]|)(\\d*)n|)"+G+"*(?:([+-]|)"+G+"*(\\d+)|))"+G+"*\\)|)","i"),bool:new RegExp("^(?:"+L+")$","i"),needsContext:new RegExp("^"+G+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+G+"*((?:-\\d)?\\d*)"+G+"*\\)|)(?=[^-]|$)","i")},K=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=/'|\\/g,ie=new RegExp("\\\\([\\da-f]{1,6}"+G+"?|("+G+")|.)","ig");try{M.apply(t=P.call(x.childNodes),x.childNodes),t[x.childNodes.length].nodeType}catch(e){M={apply:t.length?function(e,t){F.apply(e,P.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}function ne(e,t,i,n){var o,r,a,s,l,c,u,d,h,p;if((t?t.ownerDocument||t:x)!==_&&v(t),i=i||[],!e||"string"!=typeof e)return i;if(1!==(s=(t=t||_).nodeType)&&9!==s)return[];if(y&&!n){if(o=Z.exec(e))if(a=o[1]){if(9===s){if(!(r=t.getElementById(a))||!r.parentNode)return i;if(r.id===a)return i.push(r),i}else if(t.ownerDocument&&(r=t.ownerDocument.getElementById(a))&&A(t,r)&&r.id===a)return i.push(r),i}else{if(o[2])return M.apply(i,t.getElementsByTagName(e)),i;if((a=o[3])&&f.getElementsByClassName&&t.getElementsByClassName)return M.apply(i,t.getElementsByClassName(a)),i}if(f.qsa&&(!b||!b.test(e))){if(d=u=E,h=t,p=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(c=g(e),(u=t.getAttribute("id"))?d=u.replace(te,"\\$&"):t.setAttribute("id",d),d="[id='"+d+"'] ",l=c.length;l--;)c[l]=d+fe(c[l]);h=ee.test(e)&&he(t.parentNode)||t,p=c.join(",")}if(p)try{return M.apply(i,h.querySelectorAll(p)),i}catch(e){}finally{u||t.removeAttribute("id")}}}return m(e.replace(H,"$1"),t,i,n)}function oe(){var n=[];return function e(t,i){return n.push(t+" ")>w.cacheLength&&delete e[n.shift()],e[t+" "]=i}}function re(e){return e[E]=!0,e}function ae(e){var t=_.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function se(e,t){for(var i=e.split("|"),n=e.length;n--;)w.attrHandle[i[n]]=t}function le(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function ce(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ue(i){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===i}}function de(a){return re(function(r){return r=+r,re(function(e,t){for(var i,n=a([],e.length,r),o=n.length;o--;)e[i=n[o]]&&(e[i]=!(t[i]=e[i]))})})}function he(e){return e&&typeof e.getElementsByTagName!==R&&e}for(e in f=ne.support={},n=ne.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},v=ne.setDocument=function(e){var t,l=e?e.ownerDocument||e:x,i=l.defaultView;return l!==_&&9===l.nodeType&&l.documentElement?(o=(_=l).documentElement,y=!n(l),i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",function(){v()},!1):i.attachEvent&&i.attachEvent("onunload",function(){v()})),f.attributes=ae(function(e){return e.className="i",!e.getAttribute("className")}),f.getElementsByTagName=ae(function(e){return e.appendChild(l.createComment("")),!e.getElementsByTagName("*").length}),f.getElementsByClassName=J.test(l.getElementsByClassName)&&ae(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),f.getById=ae(function(e){return o.appendChild(e).id=E,!l.getElementsByName||!l.getElementsByName(E).length}),f.getById?(w.find.ID=function(e,t){if(typeof t.getElementById!==R&&y){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},w.filter.ID=function(e){var t=e.replace(ie,d);return function(e){return e.getAttribute("id")===t}}):(delete w.find.ID,w.filter.ID=function(e){var i=e.replace(ie,d);return function(e){var t=typeof e.getAttributeNode!==R&&e.getAttributeNode("id");return t&&t.value===i}}),w.find.TAG=f.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==R)return t.getElementsByTagName(e)}:function(e,t){var i,n=[],o=0,r=t.getElementsByTagName(e);if("*"!==e)return r;for(;i=r[o++];)1===i.nodeType&&n.push(i);return n},w.find.CLASS=f.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==R&&y)return t.getElementsByClassName(e)},a=[],b=[],(f.qsa=J.test(l.querySelectorAll))&&(ae(function(e){e.innerHTML="<select msallowclip=''><option selected=''></option></select>",e.querySelectorAll("[msallowclip^='']").length&&b.push("[*^$]="+G+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||b.push("\\["+G+"*(?:value|"+L+")"),e.querySelectorAll(":checked").length||b.push(":checked")}),ae(function(e){var t=l.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&b.push("name"+G+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||b.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),b.push(",.*:")})),(f.matchesSelector=J.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ae(function(e){f.disconnectedMatch=s.call(e,"div"),s.call(e,"[s!='']:x"),a.push("!=",W)}),b=b.length&&new RegExp(b.join("|")),a=a.length&&new RegExp(a.join("|")),t=J.test(o.compareDocumentPosition),A=t||J.test(o.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},k=t?function(e,t){if(e===t)return u=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i||(1&(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!f.sortDetached&&t.compareDocumentPosition(e)===i?e===l||e.ownerDocument===x&&A(x,e)?-1:t===l||t.ownerDocument===x&&A(x,t)?1:c?I.call(c,e)-I.call(c,t):0:4&i?-1:1)}:function(e,t){if(e===t)return u=!0,0;var i,n=0,o=e.parentNode,r=t.parentNode,a=[e],s=[t];if(!o||!r)return e===l?-1:t===l?1:o?-1:r?1:c?I.call(c,e)-I.call(c,t):0;if(o===r)return le(e,t);for(i=e;i=i.parentNode;)a.unshift(i);for(i=t;i=i.parentNode;)s.unshift(i);for(;a[n]===s[n];)n++;return n?le(a[n],s[n]):a[n]===x?-1:s[n]===x?1:0},l):_},ne.matches=function(e,t){return ne(e,null,null,t)},ne.matchesSelector=function(e,t){if((e.ownerDocument||e)!==_&&v(e),t=t.replace(U,"='$1']"),f.matchesSelector&&y&&(!a||!a.test(t))&&(!b||!b.test(t)))try{var i=s.call(e,t);if(i||f.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){}return 0<ne(t,_,null,[e]).length},ne.contains=function(e,t){return(e.ownerDocument||e)!==_&&v(e),A(e,t)},ne.attr=function(e,t){(e.ownerDocument||e)!==_&&v(e);var i=w.attrHandle[t.toLowerCase()],n=i&&O.call(w.attrHandle,t.toLowerCase())?i(e,t,!y):void 0;return void 0!==n?n:f.attributes||!y?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},ne.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ne.uniqueSort=function(e){var t,i=[],n=0,o=0;if(u=!f.detectDuplicates,c=!f.sortStable&&e.slice(0),e.sort(k),u){for(;t=e[o++];)t===e[o]&&(n=i.push(o));for(;n--;)e.splice(i[n],1)}return c=null,e},r=ne.getText=function(e){var t,i="",n=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=r(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[n++];)i+=r(t);return i},(w=ne.selectors={cacheLength:50,createPseudo:re,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ie,d),e[3]=(e[3]||e[4]||e[5]||"").replace(ie,d),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ne.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ne.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return Q.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&Y.test(i)&&(t=g(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ie,d).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=l[e+" "];return t||(t=new RegExp("(^|"+G+")"+e+"("+G+"|$)"))&&l(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==R&&e.getAttribute("class")||"")})},ATTR:function(i,n,o){return function(e){var t=ne.attr(e,i);return null==t?"!="===n:!n||(t+="","="===n?t===o:"!="===n?t!==o:"^="===n?o&&0===t.indexOf(o):"*="===n?o&&-1<t.indexOf(o):"$="===n?o&&t.slice(-o.length)===o:"~="===n?-1<(" "+t+" ").indexOf(o):"|="===n&&(t===o||t.slice(0,o.length+1)===o+"-"))}},CHILD:function(p,e,t,f,g){var m="nth"!==p.slice(0,3),v="last"!==p.slice(-4),y="of-type"===e;return 1===f&&0===g?function(e){return!!e.parentNode}:function(e,t,i){var n,o,r,a,s,l,c=m!=v?"nextSibling":"previousSibling",u=e.parentNode,d=y&&e.nodeName.toLowerCase(),h=!i&&!y;if(u){if(m){for(;c;){for(r=e;r=r[c];)if(y?r.nodeName.toLowerCase()===d:1===r.nodeType)return!1;l=c="only"===p&&!l&&"nextSibling"}return!0}if(l=[v?u.firstChild:u.lastChild],v&&h){for(s=(n=(o=u[E]||(u[E]={}))[p]||[])[0]===S&&n[1],a=n[0]===S&&n[2],r=s&&u.childNodes[s];r=++s&&r&&r[c]||(a=s=0)||l.pop();)if(1===r.nodeType&&++a&&r===e){o[p]=[S,s,a];break}}else if(h&&(n=(e[E]||(e[E]={}))[p])&&n[0]===S)a=n[1];else for(;(r=++s&&r&&r[c]||(a=s=0)||l.pop())&&((y?r.nodeName.toLowerCase()!==d:1!==r.nodeType)||!++a||(h&&((r[E]||(r[E]={}))[p]=[S,a]),r!==e)););return(a-=g)===f||a%f==0&&0<=a/f}}},PSEUDO:function(e,r){var t,a=w.pseudos[e]||w.setFilters[e.toLowerCase()]||ne.error("unsupported pseudo: "+e);return a[E]?a(r):1<a.length?(t=[e,e,"",r],w.setFilters.hasOwnProperty(e.toLowerCase())?re(function(e,t){for(var i,n=a(e,r),o=n.length;o--;)e[i=I.call(e,n[o])]=!(t[i]=n[o])}):function(e){return a(e,0,t)}):a}},pseudos:{not:re(function(e){var n=[],o=[],s=h(e.replace(H,"$1"));return s[E]?re(function(e,t,i,n){for(var o,r=s(e,null,n,[]),a=e.length;a--;)(o=r[a])&&(e[a]=!(t[a]=o))}):function(e,t,i){return n[0]=e,s(n,null,i,o),!o.pop()}}),has:re(function(t){return function(e){return 0<ne(t,e).length}}),contains:re(function(t){return function(e){return-1<(e.textContent||e.innerText||r(e)).indexOf(t)}}),lang:re(function(i){return q.test(i||"")||ne.error("unsupported lang: "+i),i=i.replace(ie,d).toLowerCase(),function(e){var t;do{if(t=y?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===i||0===t.indexOf(i+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=i.location&&i.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===o},focus:function(e){return e===_.activeElement&&(!_.hasFocus||_.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!w.pseudos.empty(e)},header:function(e){return X.test(e.nodeName)},input:function(e){return K.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:de(function(){return[0]}),last:de(function(e,t){return[t-1]}),eq:de(function(e,t,i){return[i<0?i+t:i]}),even:de(function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e}),odd:de(function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e}),lt:de(function(e,t,i){for(var n=i<0?i+t:i;0<=--n;)e.push(n);return e}),gt:de(function(e,t,i){for(var n=i<0?i+t:i;++n<t;)e.push(n);return e})}}).pseudos.nth=w.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[e]=ce(e);for(e in{submit:!0,reset:!0})w.pseudos[e]=ue(e);function pe(){}function fe(e){for(var t=0,i=e.length,n="";t<i;t++)n+=e[t].value;return n}function ge(a,e,t){var s=e.dir,l=t&&"parentNode"===s,c=p++;return e.first?function(e,t,i){for(;e=e[s];)if(1===e.nodeType||l)return a(e,t,i)}:function(e,t,i){var n,o,r=[S,c];if(i){for(;e=e[s];)if((1===e.nodeType||l)&&a(e,t,i))return!0}else for(;e=e[s];)if(1===e.nodeType||l){if((n=(o=e[E]||(e[E]={}))[s])&&n[0]===S&&n[1]===c)return r[2]=n[2];if((o[s]=r)[2]=a(e,t,i))return!0}}}function me(o){return 1<o.length?function(e,t,i){for(var n=o.length;n--;)if(!o[n](e,t,i))return!1;return!0}:o[0]}function ve(e,t,i,n,o){for(var r,a=[],s=0,l=e.length,c=null!=t;s<l;s++)(r=e[s])&&(i&&!i(r,n,o)||(a.push(r),c&&t.push(s)));return a}function ye(p,f,g,m,v,e){return m&&!m[E]&&(m=ye(m)),v&&!v[E]&&(v=ye(v,e)),re(function(e,t,i,n){var o,r,a,s=[],l=[],c=t.length,u=e||function(e,t,i){for(var n=0,o=t.length;n<o;n++)ne(e,t[n],i);return i}(f||"*",i.nodeType?[i]:i,[]),d=!p||!e&&f?u:ve(u,s,p,i,n),h=g?v||(e?p:c||m)?[]:t:d;if(g&&g(d,h,i,n),m)for(o=ve(h,l),m(o,[],i,n),r=o.length;r--;)(a=o[r])&&(h[l[r]]=!(d[l[r]]=a));if(e){if(v||p){if(v){for(o=[],r=h.length;r--;)(a=h[r])&&o.push(d[r]=a);v(null,h=[],o,n)}for(r=h.length;r--;)(a=h[r])&&-1<(o=v?I.call(e,a):s[r])&&(e[o]=!(t[o]=a))}}else h=ve(h===t?h.splice(c,h.length):h),v?v(null,t,h,n):M.apply(t,h)})}function be(e){for(var n,t,i,o=e.length,r=w.relative[e[0].type],a=r||w.relative[" "],s=r?1:0,l=ge(function(e){return e===n},a,!0),c=ge(function(e){return-1<I.call(n,e)},a,!0),u=[function(e,t,i){return!r&&(i||t!==C)||((n=t).nodeType?l(e,t,i):c(e,t,i))}];s<o;s++)if(t=w.relative[e[s].type])u=[ge(me(u),t)];else{if((t=w.filter[e[s].type].apply(null,e[s].matches))[E]){for(i=++s;i<o&&!w.relative[e[i].type];i++);return ye(1<s&&me(u),1<s&&fe(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(H,"$1"),t,s<i&&be(e.slice(s,i)),i<o&&be(e=e.slice(i)),i<o&&fe(e))}u.push(t)}return me(u)}return pe.prototype=w.filters=w.pseudos,w.setFilters=new pe,g=ne.tokenize=function(e,t){var i,n,o,r,a,s,l,c=T[e+" "];if(c)return t?0:c.slice(0);for(a=e,s=[],l=w.preFilter;a;){for(r in i&&!(n=z.exec(a))||(n&&(a=a.slice(n[0].length)||a),s.push(o=[])),i=!1,(n=V.exec(a))&&(i=n.shift(),o.push({value:i,type:n[0].replace(H," ")}),a=a.slice(i.length)),w.filter)!(n=Q[r].exec(a))||l[r]&&!(n=l[r](n))||(i=n.shift(),o.push({value:i,type:r,matches:n}),a=a.slice(i.length));if(!i)break}return t?a.length:a?ne.error(e):T(e,s).slice(0)},h=ne.compile=function(e,t){var i,n=[],o=[],r=D[e+" "];if(!r){for(i=(t=t||g(e)).length;i--;)(r=be(t[i]))[E]?n.push(r):o.push(r);(r=D(e,function(m,v){function e(e,t,i,n,o){var r,a,s,l=0,c="0",u=e&&[],d=[],h=C,p=e||b&&w.find.TAG("*",o),f=S+=null==h?1:Math.random()||.1,g=p.length;for(o&&(C=t!==_&&t);c!==g&&null!=(r=p[c]);c++){if(b&&r){for(a=0;s=m[a++];)if(s(r,t,i)){n.push(r);break}o&&(S=f)}y&&((r=!s&&r)&&l--,e&&u.push(r))}if(l+=c,y&&c!==l){for(a=0;s=v[a++];)s(u,d,t,i);if(e){if(0<l)for(;c--;)u[c]||d[c]||(d[c]=N.call(n));d=ve(d)}M.apply(n,d),o&&!e&&0<d.length&&1<l+v.length&&ne.uniqueSort(n)}return o&&(S=f,C=h),u}var y=0<v.length,b=0<m.length;return y?re(e):e}(o,n))).selector=e}return r},m=ne.select=function(e,t,i,n){var o,r,a,s,l,c="function"==typeof e&&e,u=!n&&g(e=c.selector||e);if(i=i||[],1===u.length){if(2<(r=u[0]=u[0].slice(0)).length&&"ID"===(a=r[0]).type&&f.getById&&9===t.nodeType&&y&&w.relative[r[1].type]){if(!(t=(w.find.ID(a.matches[0].replace(ie,d),t)||[])[0]))return i;c&&(t=t.parentNode),e=e.slice(r.shift().value.length)}for(o=Q.needsContext.test(e)?0:r.length;o--&&(a=r[o],!w.relative[s=a.type]);)if((l=w.find[s])&&(n=l(a.matches[0].replace(ie,d),ee.test(r[0].type)&&he(t.parentNode)||t))){if(r.splice(o,1),!(e=n.length&&fe(r)))return M.apply(i,n),i;break}}return(c||h(e,u))(n,t,!y,i,ee.test(e)&&he(t.parentNode)||t),i},f.sortStable=E.split("").sort(k).join("")===E,f.detectDuplicates=!!u,v(),f.sortDetached=ae(function(e){return 1&e.compareDocumentPosition(_.createElement("div"))}),ae(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||se("type|href|height|width",function(e,t,i){if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),f.attributes&&ae(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||se("value",function(e,t,i){if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ae(function(e){return null==e.getAttribute("disabled")})||se(L,function(e,t,i){var n;if(!i)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),ne}(f);A.find=p,A.expr=p.selectors,A.expr[":"]=A.expr.pseudos,A.unique=p.uniqueSort,A.text=p.getText,A.isXMLDoc=p.isXML,A.contains=p.contains;var y=A.expr.match.needsContext,b=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;function C(e,i,n){if(A.isFunction(i))return A.grep(e,function(e,t){return!!i.call(e,t,e)!==n});if(i.nodeType)return A.grep(e,function(e){return e===i!==n});if("string"==typeof i){if(w.test(i))return A.filter(i,e,n);i=A.filter(i,e)}return A.grep(e,function(e){return 0<=A.inArray(e,i)!==n})}A.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?A.find.matchesSelector(n,e)?[n]:[]:A.find.matches(e,A.grep(t,function(e){return 1===e.nodeType}))},A.fn.extend({find:function(e){var t,i=[],n=this,o=n.length;if("string"!=typeof e)return this.pushStack(A(e).filter(function(){for(t=0;t<o;t++)if(A.contains(n[t],this))return!0}));for(t=0;t<o;t++)A.find(e,n[t],i);return(i=this.pushStack(1<o?A.unique(i):i)).selector=this.selector?this.selector+" "+e:e,i},filter:function(e){return this.pushStack(C(this,e||[],!1))},not:function(e){return this.pushStack(C(this,e||[],!0))},is:function(e){return!!C(this,"string"==typeof e&&y.test(e)?A(e):e||[],!1).length}});var _,E=f.document,x=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(A.fn.init=function(e,t){var i,n;if(!e)return this;if("string"!=typeof e)return e.nodeType?(this.context=this[0]=e,this.length=1,this):A.isFunction(e)?void 0!==_.ready?_.ready(e):e(A):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),A.makeArray(e,this));if(!(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:x.exec(e))||!i[1]&&t)return!t||t.jquery?(t||_).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof A?t[0]:t,A.merge(this,A.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:E,!0)),b.test(i[1])&&A.isPlainObject(t))for(i in t)A.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}if((n=E.getElementById(i[2]))&&n.parentNode){if(n.id!==i[2])return _.find(e);this.length=1,this[0]=n}return this.context=E,this.selector=e,this}).prototype=A.fn,_=A(E);var S=/^(?:parents|prev(?:Until|All))/,T={children:!0,contents:!0,next:!0,prev:!0};function D(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}A.extend({dir:function(e,t,i){for(var n=[],o=e[t];o&&9!==o.nodeType&&(void 0===i||1!==o.nodeType||!A(o).is(i));)1===o.nodeType&&n.push(o),o=o[t];return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}}),A.fn.extend({has:function(e){var t,i=A(e,this),n=i.length;return this.filter(function(){for(t=0;t<n;t++)if(A.contains(this,i[t]))return!0})},closest:function(e,t){for(var i,n=0,o=this.length,r=[],a=y.test(e)||"string"!=typeof e?A(e,t||this.context):0;n<o;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(a?-1<a.index(i):1===i.nodeType&&A.find.matchesSelector(i,e))){r.push(i);break}return this.pushStack(1<r.length?A.unique(r):r)},index:function(e){return e?"string"==typeof e?A.inArray(this[0],A(e)):A.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(A.unique(A.merge(this.get(),A(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),A.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return A.dir(e,"parentNode")},parentsUntil:function(e,t,i){return A.dir(e,"parentNode",i)},next:function(e){return D(e,"nextSibling")},prev:function(e){return D(e,"previousSibling")},nextAll:function(e){return A.dir(e,"nextSibling")},prevAll:function(e){return A.dir(e,"previousSibling")},nextUntil:function(e,t,i){return A.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return A.dir(e,"previousSibling",i)},siblings:function(e){return A.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return A.sibling(e.firstChild)},contents:function(e){return A.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:A.merge([],e.childNodes)}},function(n,o){A.fn[n]=function(e,t){var i=A.map(this,o,e);return"Until"!==n.slice(-5)&&(t=e),t&&"string"==typeof t&&(i=A.filter(t,i)),1<this.length&&(T[n]||(i=A.unique(i)),S.test(n)&&(i=i.reverse())),this.pushStack(i)}});var k,R=/\S+/g,O={};function N(){E.addEventListener?(E.removeEventListener("DOMContentLoaded",F,!1),f.removeEventListener("load",F,!1)):(E.detachEvent("onreadystatechange",F),f.detachEvent("onload",F))}function F(){!E.addEventListener&&"load"!==event.type&&"complete"!==E.readyState||(N(),A.ready())}A.Callbacks=function(o){o="string"==typeof o?O[o]||function(e){var i=O[e]={};return A.each(e.match(R)||[],function(e,t){i[t]=!0}),i}(o):A.extend({},o);var n,t,i,r,a,s,l=[],c=!o.once&&[],u=function(e){for(t=o.memory&&e,i=!0,a=s||0,s=0,r=l.length,n=!0;l&&a<r;a++)if(!1===l[a].apply(e[0],e[1])&&o.stopOnFalse){t=!1;break}n=!1,l&&(c?c.length&&u(c.shift()):t?l=[]:d.disable())},d={add:function(){if(l){var e=l.length;!function n(e){A.each(e,function(e,t){var i=A.type(t);"function"===i?o.unique&&d.has(t)||l.push(t):t&&t.length&&"string"!==i&&n(t)})}(arguments),n?r=l.length:t&&(s=e,u(t))}return this},remove:function(){return l&&A.each(arguments,function(e,t){for(var i;-1<(i=A.inArray(t,l,i));)l.splice(i,1),n&&(i<=r&&r--,i<=a&&a--)}),this},has:function(e){return e?-1<A.inArray(e,l):!(!l||!l.length)},empty:function(){return l=[],r=0,this},disable:function(){return l=c=t=void 0,this},disabled:function(){return!l},lock:function(){return c=void 0,t||d.disable(),this},locked:function(){return!c},fireWith:function(e,t){return!l||i&&!c||(t=[e,(t=t||[]).slice?t.slice():t],n?c.push(t):u(t)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!i}};return d},A.extend({Deferred:function(e){var r=[["resolve","done",A.Callbacks("once memory"),"resolved"],["reject","fail",A.Callbacks("once memory"),"rejected"],["notify","progress",A.Callbacks("memory")]],o="pending",a={state:function(){return o},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var o=arguments;return A.Deferred(function(n){A.each(r,function(e,t){var i=A.isFunction(o[e])&&o[e];s[t[1]](function(){var e=i&&i.apply(this,arguments);e&&A.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[t[0]+"With"](this===a?n.promise():this,i?[e]:arguments)})}),o=null}).promise()},promise:function(e){return null!=e?A.extend(e,a):a}},s={};return a.pipe=a.then,A.each(r,function(e,t){var i=t[2],n=t[3];a[t[1]]=i.add,n&&i.add(function(){o=n},r[1^e][2].disable,r[2][2].lock),s[t[0]]=function(){return s[t[0]+"With"](this===s?a:this,arguments),this},s[t[0]+"With"]=i.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){function t(t,i,n){return function(e){i[t]=this,n[t]=1<arguments.length?u.call(arguments):e,n===o?c.notifyWith(i,n):--l||c.resolveWith(i,n)}}var o,i,n,r=0,a=u.call(arguments),s=a.length,l=1!==s||e&&A.isFunction(e.promise)?s:0,c=1===l?e:A.Deferred();if(1<s)for(o=new Array(s),i=new Array(s),n=new Array(s);r<s;r++)a[r]&&A.isFunction(a[r].promise)?a[r].promise().done(t(r,n,a)).fail(c.reject).progress(t(r,i,o)):--l;return l||c.resolveWith(n,a),c.promise()}}),A.fn.ready=function(e){return A.ready.promise().done(e),this},A.extend({isReady:!1,readyWait:1,holdReady:function(e){e?A.readyWait++:A.ready(!0)},ready:function(e){if(!0===e?!--A.readyWait:!A.isReady){if(!E.body)return setTimeout(A.ready);(A.isReady=!0)!==e&&0<--A.readyWait||(k.resolveWith(E,[A]),A.fn.triggerHandler&&(A(E).triggerHandler("ready"),A(E).off("ready")))}}}),A.ready.promise=function(e){if(!k)if(k=A.Deferred(),"complete"===E.readyState)setTimeout(A.ready);else if(E.addEventListener)E.addEventListener("DOMContentLoaded",F,!1),f.addEventListener("load",F,!1);else{E.attachEvent("onreadystatechange",F),f.attachEvent("onload",F);var i=!1;try{i=null==f.frameElement&&E.documentElement}catch(e){}i&&i.doScroll&&!function t(){if(!A.isReady){try{i.doScroll("left")}catch(e){return setTimeout(t,50)}N(),A.ready()}}()}return k.promise(e)};var M,P="undefined";for(M in A(v))break;v.ownLast="0"!==M,v.inlineBlockNeedsLayout=!1,A(function(){var e,t,i,n;(i=E.getElementsByTagName("body")[0])&&i.style&&(t=E.createElement("div"),(n=E.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",i.appendChild(n).appendChild(t),typeof t.style.zoom!==P&&(t.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",v.inlineBlockNeedsLayout=e=3===t.offsetWidth,e&&(i.style.zoom=1)),i.removeChild(n))}),function(){var e=E.createElement("div");if(null==v.deleteExpando){v.deleteExpando=!0;try{delete e.test}catch(e){v.deleteExpando=!1}}e=null}(),A.acceptData=function(e){var t=A.noData[(e.nodeName+" ").toLowerCase()],i=+e.nodeType||1;return(1===i||9===i)&&(!t||!0!==t&&e.getAttribute("classid")===t)};var I=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,L=/([A-Z])/g;function G(e,t,i){if(void 0===i&&1===e.nodeType){var n="data-"+t.replace(L,"-$1").toLowerCase();if("string"==typeof(i=e.getAttribute(n))){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:I.test(i)?A.parseJSON(i):i)}catch(e){}A.data(e,t,i)}else i=void 0}return i}function $(e){var t;for(t in e)if(("data"!==t||!A.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function B(e,t,i,n){if(A.acceptData(e)){var o,r,a=A.expando,s=e.nodeType,l=s?A.cache:e,c=s?e[a]:e[a]&&a;if(c&&l[c]&&(n||l[c].data)||void 0!==i||"string"!=typeof t)return l[c=c||(s?e[a]=d.pop()||A.guid++:a)]||(l[c]=s?{}:{toJSON:A.noop}),"object"!=typeof t&&"function"!=typeof t||(n?l[c]=A.extend(l[c],t):l[c].data=A.extend(l[c].data,t)),r=l[c],n||(r.data||(r.data={}),r=r.data),void 0!==i&&(r[A.camelCase(t)]=i),"string"==typeof t?null==(o=r[t])&&(o=r[A.camelCase(t)]):o=r,o}}function j(e,t,i){if(A.acceptData(e)){var n,o,r=e.nodeType,a=r?A.cache:e,s=r?e[A.expando]:A.expando;if(a[s]){if(t&&(n=i?a[s]:a[s].data)){o=(t=A.isArray(t)?t.concat(A.map(t,A.camelCase)):t in n?[t]:(t=A.camelCase(t))in n?[t]:t.split(" ")).length;for(;o--;)delete n[t[o]];if(i?!$(n):!A.isEmptyObject(n))return}(i||(delete a[s].data,$(a[s])))&&(r?A.cleanData([e],!0):v.deleteExpando||a!=a.window?delete a[s]:a[s]=null)}}}A.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return!!(e=e.nodeType?A.cache[e[A.expando]]:e[A.expando])&&!$(e)},data:function(e,t,i){return B(e,t,i)},removeData:function(e,t){return j(e,t)},_data:function(e,t,i){return B(e,t,i,!0)},_removeData:function(e,t){return j(e,t,!0)}}),A.fn.extend({data:function(e,t){var i,n,o,r=this[0],a=r&&r.attributes;if(void 0!==e)return"object"==typeof e?this.each(function(){A.data(this,e)}):1<arguments.length?this.each(function(){A.data(this,e,t)}):r?G(r,e,A.data(r,e)):void 0;if(this.length&&(o=A.data(r),1===r.nodeType&&!A._data(r,"parsedAttrs"))){for(i=a.length;i--;)a[i]&&0===(n=a[i].name).indexOf("data-")&&G(r,n=A.camelCase(n.slice(5)),o[n]);A._data(r,"parsedAttrs",!0)}return o},removeData:function(e){return this.each(function(){A.removeData(this,e)})}}),A.extend({queue:function(e,t,i){var n;if(e)return t=(t||"fx")+"queue",n=A._data(e,t),i&&(!n||A.isArray(i)?n=A._data(e,t,A.makeArray(i)):n.push(i)),n||[]},dequeue:function(e,t){t=t||"fx";var i=A.queue(e,t),n=i.length,o=i.shift(),r=A._queueHooks(e,t);"inprogress"===o&&(o=i.shift(),n--),o&&("fx"===t&&i.unshift("inprogress"),delete r.stop,o.call(e,function(){A.dequeue(e,t)},r)),!n&&r&&r.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return A._data(e,i)||A._data(e,i,{empty:A.Callbacks("once memory").add(function(){A._removeData(e,t+"queue"),A._removeData(e,i)})})}}),A.fn.extend({queue:function(t,i){var e=2;return"string"!=typeof t&&(i=t,t="fx",e--),arguments.length<e?A.queue(this[0],t):void 0===i?this:this.each(function(){var e=A.queue(this,t,i);A._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&A.dequeue(this,t)})},dequeue:function(e){return this.each(function(){A.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){function i(){--o||r.resolveWith(a,[a])}var n,o=1,r=A.Deferred(),a=this,s=this.length;for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(n=A._data(a[s],e+"queueHooks"))&&n.empty&&(o++,n.empty.add(i));return i(),r.promise(t)}});function W(e,t){return e=t||e,"none"===A.css(e,"display")||!A.contains(e.ownerDocument,e)}var H=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,z=["Top","Right","Bottom","Left"],V=A.access=function(e,t,i,n,o,r,a){var s=0,l=e.length,c=null==i;if("object"===A.type(i))for(s in o=!0,i)A.access(e,t,s,i[s],!0,r,a);else if(void 0!==n&&(o=!0,A.isFunction(n)||(a=!0),c&&(t=a?(t.call(e,n),null):(c=t,function(e,t,i){return c.call(A(e),i)})),t))for(;s<l;s++)t(e[s],i,a?n:n.call(e[s],s,t(e[s],i)));return o?e:c?t.call(e):l?t(e[0],i):r},U=/^(?:checkbox|radio)$/i;!function(){var e=E.createElement("input"),t=E.createElement("div"),i=E.createDocumentFragment();if(t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",v.leadingWhitespace=3===t.firstChild.nodeType,v.tbody=!t.getElementsByTagName("tbody").length,v.htmlSerialize=!!t.getElementsByTagName("link").length,v.html5Clone="<:nav></:nav>"!==E.createElement("nav").cloneNode(!0).outerHTML,e.type="checkbox",e.checked=!0,i.appendChild(e),v.appendChecked=e.checked,t.innerHTML="<textarea>x</textarea>",v.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,i.appendChild(t),t.innerHTML="<input type='radio' checked='checked' name='t'/>",v.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,v.noCloneEvent=!0,t.attachEvent&&(t.attachEvent("onclick",function(){v.noCloneEvent=!1}),t.cloneNode(!0).click()),null==v.deleteExpando){v.deleteExpando=!0;try{delete t.test}catch(e){v.deleteExpando=!1}}}(),function(){var e,t,i=E.createElement("div");for(e in{submit:!0,change:!0,focusin:!0})t="on"+e,(v[e+"Bubbles"]=t in f)||(i.setAttribute(t,"t"),v[e+"Bubbles"]=!1===i.attributes[t].expando);i=null}();var Y=/^(?:input|select|textarea)$/i,q=/^key/,Q=/^(?:mouse|pointer|contextmenu)|click/,K=/^(?:focusinfocus|focusoutblur)$/,X=/^([^.]*)(?:\.(.+)|)$/;function J(){return!0}function Z(){return!1}function ee(){try{return E.activeElement}catch(e){}}function te(e){var t=ie.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}A.event={global:{},add:function(e,t,i,n,o){var r,a,s,l,c,u,d,h,p,f,g,m=A._data(e);if(m){for(i.handler&&(i=(l=i).handler,o=l.selector),i.guid||(i.guid=A.guid++),(a=m.events)||(a=m.events={}),(u=m.handle)||((u=m.handle=function(e){return typeof A===P||e&&A.event.triggered===e.type?void 0:A.event.dispatch.apply(u.elem,arguments)}).elem=e),s=(t=(t||"").match(R)||[""]).length;s--;)p=g=(r=X.exec(t[s])||[])[1],f=(r[2]||"").split(".").sort(),p&&(c=A.event.special[p]||{},p=(o?c.delegateType:c.bindType)||p,c=A.event.special[p]||{},d=A.extend({type:p,origType:g,data:n,handler:i,guid:i.guid,selector:o,needsContext:o&&A.expr.match.needsContext.test(o),namespace:f.join(".")},l),(h=a[p])||((h=a[p]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(e,n,f,u)||(e.addEventListener?e.addEventListener(p,u,!1):e.attachEvent&&e.attachEvent("on"+p,u))),c.add&&(c.add.call(e,d),d.handler.guid||(d.handler.guid=i.guid)),o?h.splice(h.delegateCount++,0,d):h.push(d),A.event.global[p]=!0);e=null}},remove:function(e,t,i,n,o){var r,a,s,l,c,u,d,h,p,f,g,m=A.hasData(e)&&A._data(e);if(m&&(u=m.events)){for(c=(t=(t||"").match(R)||[""]).length;c--;)if(p=g=(s=X.exec(t[c])||[])[1],f=(s[2]||"").split(".").sort(),p){for(d=A.event.special[p]||{},h=u[p=(n?d.delegateType:d.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=r=h.length;r--;)a=h[r],!o&&g!==a.origType||i&&i.guid!==a.guid||s&&!s.test(a.namespace)||n&&n!==a.selector&&("**"!==n||!a.selector)||(h.splice(r,1),a.selector&&h.delegateCount--,d.remove&&d.remove.call(e,a));l&&!h.length&&(d.teardown&&!1!==d.teardown.call(e,f,m.handle)||A.removeEvent(e,p,m.handle),delete u[p])}else for(p in u)A.event.remove(e,p+t[c],i,n,!0);A.isEmptyObject(u)&&(delete m.handle,A._removeData(e,"events"))}},trigger:function(e,t,i,n){var o,r,a,s,l,c,u,d=[i||E],h=m.call(e,"type")?e.type:e,p=m.call(e,"namespace")?e.namespace.split("."):[];if(a=c=i=i||E,3!==i.nodeType&&8!==i.nodeType&&!K.test(h+A.event.triggered)&&(0<=h.indexOf(".")&&(h=(p=h.split(".")).shift(),p.sort()),r=h.indexOf(":")<0&&"on"+h,(e=e[A.expando]?e:new A.Event(h,"object"==typeof e&&e)).isTrigger=n?2:3,e.namespace=p.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),t=null==t?[e]:A.makeArray(t,[e]),l=A.event.special[h]||{},n||!l.trigger||!1!==l.trigger.apply(i,t))){if(!n&&!l.noBubble&&!A.isWindow(i)){for(s=l.delegateType||h,K.test(s+h)||(a=a.parentNode);a;a=a.parentNode)d.push(a),c=a;c===(i.ownerDocument||E)&&d.push(c.defaultView||c.parentWindow||f)}for(u=0;(a=d[u++])&&!e.isPropagationStopped();)e.type=1<u?s:l.bindType||h,(o=(A._data(a,"events")||{})[e.type]&&A._data(a,"handle"))&&o.apply(a,t),(o=r&&a[r])&&o.apply&&A.acceptData(a)&&(e.result=o.apply(a,t),!1===e.result&&e.preventDefault());if(e.type=h,!n&&!e.isDefaultPrevented()&&(!l._default||!1===l._default.apply(d.pop(),t))&&A.acceptData(i)&&r&&i[h]&&!A.isWindow(i)){(c=i[r])&&(i[r]=null),A.event.triggered=h;try{i[h]()}catch(e){}A.event.triggered=void 0,c&&(i[r]=c)}return e.result}},dispatch:function(e){e=A.event.fix(e);var t,i,n,o,r,a,s=u.call(arguments),l=(A._data(this,"events")||{})[e.type]||[],c=A.event.special[e.type]||{};if((s[0]=e).delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,e)){for(a=A.event.handlers.call(this,e,l),t=0;(o=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,r=0;(n=o.handlers[r++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(n.namespace)||(e.handleObj=n,e.data=n.data,void 0!==(i=((A.event.special[n.origType]||{}).handle||n.handler).apply(o.elem,s))&&!1===(e.result=i)&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,n,o,r,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(o=[],r=0;r<s;r++)void 0===o[i=(n=t[r]).selector+" "]&&(o[i]=n.needsContext?0<=A(i,this).index(l):A.find(i,this,null,[l]).length),o[i]&&o.push(n);o.length&&a.push({elem:l,handlers:o})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},fix:function(e){if(e[A.expando])return e;var t,i,n,o=e.type,r=e,a=this.fixHooks[o];for(a||(this.fixHooks[o]=a=Q.test(o)?this.mouseHooks:q.test(o)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,e=new A.Event(r),t=n.length;t--;)e[i=n[t]]=r[i];return e.target||(e.target=r.srcElement||E),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,r):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,n,o,r=t.button,a=t.fromElement;return null==e.pageX&&null!=t.clientX&&(o=(n=e.target.ownerDocument||E).documentElement,i=n.body,e.pageX=t.clientX+(o&&o.scrollLeft||i&&i.scrollLeft||0)-(o&&o.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(o&&o.scrollTop||i&&i.scrollTop||0)-(o&&o.clientTop||i&&i.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?t.toElement:a),e.which||void 0===r||(e.which=1&r?1:2&r?3:4&r?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ee()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===ee()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(A.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return A.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var o=A.extend(new A.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?A.event.trigger(o,null,t):A.event.dispatch.call(t,o),o.isDefaultPrevented()&&i.preventDefault()}},A.removeEvent=E.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var n="on"+t;e.detachEvent&&(typeof e[n]===P&&(e[n]=null),e.detachEvent(n,i))},A.Event=function(e,t){if(!(this instanceof A.Event))return new A.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?J:Z):this.type=e,t&&A.extend(this,t),this.timeStamp=e&&e.timeStamp||A.now(),this[A.expando]=!0},A.Event.prototype={isDefaultPrevented:Z,isPropagationStopped:Z,isImmediatePropagationStopped:Z,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=J,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=J,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=J,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},A.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,o){A.event.special[e]={delegateType:o,bindType:o,handle:function(e){var t,i=e.relatedTarget,n=e.handleObj;return i&&(i===this||A.contains(this,i))||(e.type=n.origType,t=n.handler.apply(this,arguments),e.type=o),t}}}),v.submitBubbles||(A.event.special.submit={setup:function(){if(A.nodeName(this,"form"))return!1;A.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,i=A.nodeName(t,"input")||A.nodeName(t,"button")?t.form:void 0;i&&!A._data(i,"submitBubbles")&&(A.event.add(i,"submit._submit",function(e){e._submit_bubble=!0}),A._data(i,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&A.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(A.nodeName(this,"form"))return!1;A.event.remove(this,"._submit")}}),v.changeBubbles||(A.event.special.change={setup:function(){if(Y.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(A.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),A.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),A.event.simulate("change",this,e,!0)})),!1;A.event.add(this,"beforeactivate._change",function(e){var t=e.target;Y.test(t.nodeName)&&!A._data(t,"changeBubbles")&&(A.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||A.event.simulate("change",this.parentNode,e,!0)}),A._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return A.event.remove(this,"._change"),!Y.test(this.nodeName)}}),v.focusinBubbles||A.each({focus:"focusin",blur:"focusout"},function(i,n){function o(e){A.event.simulate(n,e.target,A.event.fix(e),!0)}A.event.special[n]={setup:function(){var e=this.ownerDocument||this,t=A._data(e,n);t||e.addEventListener(i,o,!0),A._data(e,n,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=A._data(e,n)-1;t?A._data(e,n,t):(e.removeEventListener(i,o,!0),A._removeData(e,n))}}}),A.fn.extend({on:function(e,t,i,n,o){var r,a;if("object"==typeof e){for(r in"string"!=typeof t&&(i=i||t,t=void 0),e)this.on(r,t,i,e[r],o);return this}if(null==i&&null==n?(n=t,i=t=void 0):null==n&&("string"==typeof t?(n=i,i=void 0):(n=i,i=t,t=void 0)),!1===n)n=Z;else if(!n)return this;return 1===o&&(a=n,(n=function(e){return A().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=A.guid++)),this.each(function(){A.event.add(this,e,n,i,t)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,t,i){var n,o;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,A(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(i=t,t=void 0),!1===i&&(i=Z),this.each(function(){A.event.remove(this,e,i,t)});for(o in e)this.off(o,t,e[o]);return this},trigger:function(e,t){return this.each(function(){A.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i)return A.event.trigger(e,t,i,!0)}});var ie="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ne=/ jQuery\d+="(?:null|\d+)"/g,oe=new RegExp("<(?:"+ie+")[\\s/>]","i"),re=/^\s+/,ae=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,se=/<([\w:]+)/,le=/<tbody/i,ce=/<|&#?\w+;/,ue=/<(?:script|style|link)/i,de=/checked\s*(?:[^=]|=\s*.checked.)/i,he=/^$|\/(?:java|ecma)script/i,pe=/^true\/(.*)/,fe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ge={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:v.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},me=te(E).appendChild(E.createElement("div"));function ve(e,t){var i,n,o=0,r=typeof e.getElementsByTagName!==P?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==P?e.querySelectorAll(t||"*"):void 0;if(!r)for(r=[],i=e.childNodes||e;null!=(n=i[o]);o++)!t||A.nodeName(n,t)?r.push(n):A.merge(r,ve(n,t));return void 0===t||t&&A.nodeName(e,t)?A.merge([e],r):r}function ye(e){U.test(e.type)&&(e.defaultChecked=e.checked)}function be(e,t){return A.nodeName(e,"table")&&A.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function we(e){return e.type=(null!==A.find.attr(e,"type"))+"/"+e.type,e}function Ce(e){var t=pe.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function _e(e,t){for(var i,n=0;null!=(i=e[n]);n++)A._data(i,"globalEval",!t||A._data(t[n],"globalEval"))}function Ae(e,t){if(1===t.nodeType&&A.hasData(e)){var i,n,o,r=A._data(e),a=A._data(t,r),s=r.events;if(s)for(i in delete a.handle,a.events={},s)for(n=0,o=s[i].length;n<o;n++)A.event.add(t,i,s[i][n]);a.data&&(a.data=A.extend({},a.data))}}function Ee(e,t){var i,n,o;if(1===t.nodeType){if(i=t.nodeName.toLowerCase(),!v.noCloneEvent&&t[A.expando]){for(n in(o=A._data(t)).events)A.removeEvent(t,n,o.handle);t.removeAttribute(A.expando)}"script"===i&&t.text!==e.text?(we(t).text=e.text,Ce(t)):"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),v.html5Clone&&e.innerHTML&&!A.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&U.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.defaultSelected=t.selected=e.defaultSelected:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}}ge.optgroup=ge.option,ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td,A.extend({clone:function(e,t,i){var n,o,r,a,s,l=A.contains(e.ownerDocument,e);if(v.html5Clone||A.isXMLDoc(e)||!oe.test("<"+e.nodeName+">")?r=e.cloneNode(!0):(me.innerHTML=e.outerHTML,me.removeChild(r=me.firstChild)),!(v.noCloneEvent&&v.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||A.isXMLDoc(e)))for(n=ve(r),s=ve(e),a=0;null!=(o=s[a]);++a)n[a]&&Ee(o,n[a]);if(t)if(i)for(s=s||ve(e),n=n||ve(r),a=0;null!=(o=s[a]);a++)Ae(o,n[a]);else Ae(e,r);return 0<(n=ve(r,"script")).length&&_e(n,!l&&ve(e,"script")),n=s=o=null,r},buildFragment:function(e,t,i,n){for(var o,r,a,s,l,c,u,d=e.length,h=te(t),p=[],f=0;f<d;f++)if((r=e[f])||0===r)if("object"===A.type(r))A.merge(p,r.nodeType?[r]:r);else if(ce.test(r)){for(s=s||h.appendChild(t.createElement("div")),l=(se.exec(r)||["",""])[1].toLowerCase(),u=ge[l]||ge._default,s.innerHTML=u[1]+r.replace(ae,"<$1></$2>")+u[2],o=u[0];o--;)s=s.lastChild;if(!v.leadingWhitespace&&re.test(r)&&p.push(t.createTextNode(re.exec(r)[0])),!v.tbody)for(o=(r="table"!==l||le.test(r)?"<table>"!==u[1]||le.test(r)?0:s:s.firstChild)&&r.childNodes.length;o--;)A.nodeName(c=r.childNodes[o],"tbody")&&!c.childNodes.length&&r.removeChild(c);for(A.merge(p,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=h.lastChild}else p.push(t.createTextNode(r));for(s&&h.removeChild(s),v.appendChecked||A.grep(ve(p,"input"),ye),f=0;r=p[f++];)if((!n||-1===A.inArray(r,n))&&(a=A.contains(r.ownerDocument,r),s=ve(h.appendChild(r),"script"),a&&_e(s),i))for(o=0;r=s[o++];)he.test(r.type||"")&&i.push(r);return s=null,h},cleanData:function(e,t){for(var i,n,o,r,a=0,s=A.expando,l=A.cache,c=v.deleteExpando,u=A.event.special;null!=(i=e[a]);a++)if((t||A.acceptData(i))&&(r=(o=i[s])&&l[o])){if(r.events)for(n in r.events)u[n]?A.event.remove(i,n):A.removeEvent(i,n,r.handle);l[o]&&(delete l[o],c?delete i[s]:typeof i.removeAttribute!==P?i.removeAttribute(s):i[s]=null,d.push(o))}}}),A.fn.extend({text:function(e){return V(this,function(e){return void 0===e?A.text(this):this.empty().append((this[0]&&this[0].ownerDocument||E).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||be(this,e).appendChild(e)})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=be(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=e?A.filter(e,this):this,o=0;null!=(i=n[o]);o++)t||1!==i.nodeType||A.cleanData(ve(i)),i.parentNode&&(t&&A.contains(i.ownerDocument,i)&&_e(ve(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&A.cleanData(ve(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&A.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return A.clone(this,e,t)})},html:function(e){return V(this,function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(ne,""):void 0;if("string"==typeof e&&!ue.test(e)&&(v.htmlSerialize||!oe.test(e))&&(v.leadingWhitespace||!re.test(e))&&!ge[(se.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(ae,"<$1></$2>");try{for(;i<n;i++)1===(t=this[i]||{}).nodeType&&(A.cleanData(ve(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,A.cleanData(ve(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(i,n){i=g.apply([],i);var e,t,o,r,a,s,l=0,c=this.length,u=this,d=c-1,h=i[0],p=A.isFunction(h);if(p||1<c&&"string"==typeof h&&!v.checkClone&&de.test(h))return this.each(function(e){var t=u.eq(e);p&&(i[0]=h.call(this,e,t.html())),t.domManip(i,n)});if(c&&(e=(s=A.buildFragment(i,this[0].ownerDocument,!1,this)).firstChild,1===s.childNodes.length&&(s=e),e)){for(o=(r=A.map(ve(s,"script"),we)).length;l<c;l++)t=s,l!==d&&(t=A.clone(t,!0,!0),o&&A.merge(r,ve(t,"script"))),n.call(this[l],t,l);if(o)for(a=r[r.length-1].ownerDocument,A.map(r,Ce),l=0;l<o;l++)t=r[l],he.test(t.type||"")&&!A._data(t,"globalEval")&&A.contains(a,t)&&(t.src?A._evalUrl&&A._evalUrl(t.src):A.globalEval((t.text||t.textContent||t.innerHTML||"").replace(fe,"")));s=e=null}return this}}),A.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){A.fn[e]=function(e){for(var t,i=0,n=[],o=A(e),r=o.length-1;i<=r;i++)t=i===r?this:this.clone(!0),A(o[i])[a](t),s.apply(n,t.get());return this.pushStack(n)}});var xe,Se,Te={};function De(e,t){var i,n=A(t.createElement(e)).appendTo(t.body),o=f.getDefaultComputedStyle&&(i=f.getDefaultComputedStyle(n[0]))?i.display:A.css(n[0],"display");return n.detach(),o}function ke(e){var t=E,i=Te[e];return i||("none"!==(i=De(e,t))&&i||((t=((xe=(xe||A("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentWindow||xe[0].contentDocument).document).write(),t.close(),i=De(e,t),xe.detach()),Te[e]=i),i}v.shrinkWrapBlocks=function(){return null!=Se?Se:(Se=!1,(t=E.getElementsByTagName("body")[0])&&t.style?(e=E.createElement("div"),(i=E.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",t.appendChild(i).appendChild(e),typeof e.style.zoom!==P&&(e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",e.appendChild(E.createElement("div")).style.width="5px",Se=3!==e.offsetWidth),t.removeChild(i),Se):void 0);var e,t,i};var Re,Oe,Ne,Fe,Me,Pe,Ie,Le,Ge,$e=/^margin/,Be=new RegExp("^("+H+")(?!px)[a-z%]+$","i"),je=/^(top|right|bottom|left)$/;function We(t,i){return{get:function(){var e=t();if(null!=e){if(!e)return(this.get=i).apply(this,arguments);delete this.get}}}}function He(){var e,t,i,n;(t=E.getElementsByTagName("body")[0])&&t.style&&(e=E.createElement("div"),(i=E.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",t.appendChild(i).appendChild(e),e.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",Pe=Ie=!1,Ge=!0,f.getComputedStyle&&(Pe="1%"!==(f.getComputedStyle(e,null)||{}).top,Ie="4px"===(f.getComputedStyle(e,null)||{width:"4px"}).width,(n=e.appendChild(E.createElement("div"))).style.cssText=e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",e.style.width="1px",Ge=!parseFloat((f.getComputedStyle(n,null)||{}).marginRight)),e.innerHTML="<table><tr><td></td><td>t</td></tr></table>",(n=e.getElementsByTagName("td"))[0].style.cssText="margin:0;border:0;padding:0;display:none",(Le=0===n[0].offsetHeight)&&(n[0].style.display="",n[1].style.display="none",Le=0===n[0].offsetHeight),t.removeChild(i))}f.getComputedStyle?(Re=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)},Oe=function(e,t,i){var n,o,r,a,s=e.style;return a=(i=i||Re(e))?i.getPropertyValue(t)||i[t]:void 0,i&&(""!==a||A.contains(e.ownerDocument,e)||(a=A.style(e,t)),Be.test(a)&&$e.test(t)&&(n=s.width,o=s.minWidth,r=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=i.width,s.width=n,s.minWidth=o,s.maxWidth=r)),void 0===a?a:a+""}):E.documentElement.currentStyle&&(Re=function(e){return e.currentStyle},Oe=function(e,t,i){var n,o,r,a,s=e.style;return null==(a=(i=i||Re(e))?i[t]:void 0)&&s&&s[t]&&(a=s[t]),Be.test(a)&&!je.test(t)&&(n=s.left,(r=(o=e.runtimeStyle)&&o.left)&&(o.left=e.currentStyle.left),s.left="fontSize"===t?"1em":a,a=s.pixelLeft+"px",s.left=n,r&&(o.left=r)),void 0===a?a:a+""||"auto"}),(Ne=E.createElement("div")).innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(Fe=(Me=Ne.getElementsByTagName("a")[0])&&Me.style)&&(Fe.cssText="float:left;opacity:.5",v.opacity="0.5"===Fe.opacity,v.cssFloat=!!Fe.cssFloat,Ne.style.backgroundClip="content-box",Ne.cloneNode(!0).style.backgroundClip="",v.clearCloneStyle="content-box"===Ne.style.backgroundClip,v.boxSizing=""===Fe.boxSizing||""===Fe.MozBoxSizing||""===Fe.WebkitBoxSizing,A.extend(v,{reliableHiddenOffsets:function(){return null==Le&&He(),Le},boxSizingReliable:function(){return null==Ie&&He(),Ie},pixelPosition:function(){return null==Pe&&He(),Pe},reliableMarginRight:function(){return null==Ge&&He(),Ge}})),A.swap=function(e,t,i,n){var o,r,a={};for(r in t)a[r]=e.style[r],e.style[r]=t[r];for(r in o=i.apply(e,n||[]),t)e.style[r]=a[r];return o};var ze=/alpha\([^)]*\)/i,Ve=/opacity\s*=\s*([^)]*)/,Ue=/^(none|table(?!-c[ea]).+)/,Ye=new RegExp("^("+H+")(.*)$","i"),qe=new RegExp("^([+-])=("+H+")","i"),Qe={position:"absolute",visibility:"hidden",display:"block"},Ke={letterSpacing:"0",fontWeight:"400"},Xe=["Webkit","O","Moz","ms"];function Je(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,o=Xe.length;o--;)if((t=Xe[o]+i)in e)return t;return n}function Ze(e,t){for(var i,n,o,r=[],a=0,s=e.length;a<s;a++)(n=e[a]).style&&(r[a]=A._data(n,"olddisplay"),i=n.style.display,t?(r[a]||"none"!==i||(n.style.display=""),""===n.style.display&&W(n)&&(r[a]=A._data(n,"olddisplay",ke(n.nodeName)))):(o=W(n),(i&&"none"!==i||!o)&&A._data(n,"olddisplay",o?i:A.css(n,"display"))));for(a=0;a<s;a++)(n=e[a]).style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?r[a]||"":"none"));return e}function et(e,t,i){var n=Ye.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function tt(e,t,i,n,o){for(var r=i===(n?"border":"content")?4:"width"===t?1:0,a=0;r<4;r+=2)"margin"===i&&(a+=A.css(e,i+z[r],!0,o)),n?("content"===i&&(a-=A.css(e,"padding"+z[r],!0,o)),"margin"!==i&&(a-=A.css(e,"border"+z[r]+"Width",!0,o))):(a+=A.css(e,"padding"+z[r],!0,o),"padding"!==i&&(a+=A.css(e,"border"+z[r]+"Width",!0,o)));return a}function it(e,t,i){var n=!0,o="width"===t?e.offsetWidth:e.offsetHeight,r=Re(e),a=v.boxSizing&&"border-box"===A.css(e,"boxSizing",!1,r);if(o<=0||null==o){if(((o=Oe(e,t,r))<0||null==o)&&(o=e.style[t]),Be.test(o))return o;n=a&&(v.boxSizingReliable()||o===e.style[t]),o=parseFloat(o)||0}return o+tt(e,t,i||(a?"border":"content"),n,r)+"px"}function nt(e,t,i,n,o){return new nt.prototype.init(e,t,i,n,o)}A.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=Oe(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:v.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,r,a,s=A.camelCase(t),l=e.style;if(t=A.cssProps[s]||(A.cssProps[s]=Je(l,s)),a=A.cssHooks[t]||A.cssHooks[s],void 0===i)return a&&"get"in a&&void 0!==(o=a.get(e,!1,n))?o:l[t];if("string"===(r=typeof i)&&(o=qe.exec(i))&&(i=(o[1]+1)*o[2]+parseFloat(A.css(e,t)),r="number"),null!=i&&i==i&&("number"!==r||A.cssNumber[s]||(i+="px"),v.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),!(a&&"set"in a&&void 0===(i=a.set(e,i,n)))))try{l[t]=i}catch(e){}}},css:function(e,t,i,n){var o,r,a,s=A.camelCase(t);return t=A.cssProps[s]||(A.cssProps[s]=Je(e.style,s)),(a=A.cssHooks[t]||A.cssHooks[s])&&"get"in a&&(r=a.get(e,!0,i)),void 0===r&&(r=Oe(e,t,n)),"normal"===r&&t in Ke&&(r=Ke[t]),""===i||i?(o=parseFloat(r),!0===i||A.isNumeric(o)?o||0:r):r}}),A.each(["height","width"],function(e,o){A.cssHooks[o]={get:function(e,t,i){if(t)return Ue.test(A.css(e,"display"))&&0===e.offsetWidth?A.swap(e,Qe,function(){return it(e,o,i)}):it(e,o,i)},set:function(e,t,i){var n=i&&Re(e);return et(0,t,i?tt(e,o,i,v.boxSizing&&"border-box"===A.css(e,"boxSizing",!1,n),n):0)}}}),v.opacity||(A.cssHooks.opacity={get:function(e,t){return Ve.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,o=A.isNumeric(t)?"alpha(opacity="+100*t+")":"",r=n&&n.filter||i.filter||"";((i.zoom=1)<=t||""===t)&&""===A.trim(r.replace(ze,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===t||n&&!n.filter)||(i.filter=ze.test(r)?r.replace(ze,o):r+" "+o)}}),A.cssHooks.marginRight=We(v.reliableMarginRight,function(e,t){if(t)return A.swap(e,{display:"inline-block"},Oe,[e,"marginRight"])}),A.each({margin:"",padding:"",border:"Width"},function(o,r){A.cssHooks[o+r]={expand:function(e){for(var t=0,i={},n="string"==typeof e?e.split(" "):[e];t<4;t++)i[o+z[t]+r]=n[t]||n[t-2]||n[0];return i}},$e.test(o)||(A.cssHooks[o+r].set=et)}),A.fn.extend({css:function(e,t){return V(this,function(e,t,i){var n,o,r={},a=0;if(A.isArray(t)){for(n=Re(e),o=t.length;a<o;a++)r[t[a]]=A.css(e,t[a],!1,n);return r}return void 0!==i?A.style(e,t,i):A.css(e,t)},e,t,1<arguments.length)},show:function(){return Ze(this,!0)},hide:function(){return Ze(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){W(this)?A(this).show():A(this).hide()})}}),((A.Tween=nt).prototype={constructor:nt,init:function(e,t,i,n,o,r){this.elem=e,this.prop=i,this.easing=o||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=r||(A.cssNumber[i]?"":"px")},cur:function(){var e=nt.propHooks[this.prop];return e&&e.get?e.get(this):nt.propHooks._default.get(this)},run:function(e){var t,i=nt.propHooks[this.prop];return this.options.duration?this.pos=t=A.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):nt.propHooks._default.set(this),this}}).init.prototype=nt.prototype,(nt.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=A.css(e.elem,e.prop,""))&&"auto"!==t?t:0:e.elem[e.prop]},set:function(e){A.fx.step[e.prop]?A.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[A.cssProps[e.prop]]||A.cssHooks[e.prop])?A.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}}).scrollTop=nt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},A.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},A.fx=nt.prototype.init,A.fx.step={};var ot,rt,at,st,lt,ct,ut,dt=/^(?:toggle|show|hide)$/,ht=new RegExp("^(?:([+-])=|)("+H+")([a-z%]*)$","i"),pt=/queueHooks$/,ft=[function(t,e,i){var n,o,r,a,s,l,c,u=this,d={},h=t.style,p=t.nodeType&&W(t),f=A._data(t,"fxshow");i.queue||(null==(s=A._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,A.queue(t,"fx").length||s.empty.fire()})}));1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[h.overflow,h.overflowX,h.overflowY],c=A.css(t,"display"),"inline"===("none"===c?A._data(t,"olddisplay")||ke(t.nodeName):c)&&"none"===A.css(t,"float")&&(v.inlineBlockNeedsLayout&&"inline"!==ke(t.nodeName)?h.zoom=1:h.display="inline-block"));i.overflow&&(h.overflow="hidden",v.shrinkWrapBlocks()||u.always(function(){h.overflow=i.overflow[0],h.overflowX=i.overflow[1],h.overflowY=i.overflow[2]}));for(n in e)if(o=e[n],dt.exec(o)){if(delete e[n],r=r||"toggle"===o,o===(p?"hide":"show")){if("show"!==o||!f||void 0===f[n])continue;p=!0}d[n]=f&&f[n]||A.style(t,n)}else c=void 0;if(A.isEmptyObject(d))"inline"===("none"===c?ke(t.nodeName):c)&&(h.display=c);else for(n in f?"hidden"in f&&(p=f.hidden):f=A._data(t,"fxshow",{}),r&&(f.hidden=!p),p?A(t).show():u.done(function(){A(t).hide()}),u.done(function(){var e;for(e in A._removeData(t,"fxshow"),d)A.style(t,e,d[e])}),d)a=yt(p?f[n]:0,n,u),n in f||(f[n]=a.start,p&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}],gt={"*":[function(e,t){var i=this.createTween(e,t),n=i.cur(),o=ht.exec(t),r=o&&o[3]||(A.cssNumber[e]?"":"px"),a=(A.cssNumber[e]||"px"!==r&&+n)&&ht.exec(A.css(i.elem,e)),s=1,l=20;if(a&&a[3]!==r)for(r=r||a[3],o=o||[],a=+n||1;a/=s=s||".5",A.style(i.elem,e,a+r),s!==(s=i.cur()/n)&&1!==s&&--l;);return o&&(a=i.start=+a||+n||0,i.unit=r,i.end=o[1]?a+(o[1]+1)*o[2]:+o[2]),i}]};function mt(){return setTimeout(function(){ot=void 0}),ot=A.now()}function vt(e,t){var i,n={height:e},o=0;for(t=t?1:0;o<4;o+=2-t)n["margin"+(i=z[o])]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function yt(e,t,i){for(var n,o=(gt[t]||[]).concat(gt["*"]),r=0,a=o.length;r<a;r++)if(n=o[r].call(i,t,e))return n}function bt(r,e,t){var i,a,n=0,o=ft.length,s=A.Deferred().always(function(){delete l.elem}),l=function(){if(a)return!1;for(var e=ot||mt(),t=Math.max(0,c.startTime+c.duration-e),i=1-(t/c.duration||0),n=0,o=c.tweens.length;n<o;n++)c.tweens[n].run(i);return s.notifyWith(r,[c,i,t]),i<1&&o?t:(s.resolveWith(r,[c]),!1)},c=s.promise({elem:r,props:A.extend({},e),opts:A.extend(!0,{specialEasing:{}},t),originalProperties:e,originalOptions:t,startTime:ot||mt(),duration:t.duration,tweens:[],createTween:function(e,t){var i=A.Tween(r,c.opts,e,t,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(i),i},stop:function(e){var t=0,i=e?c.tweens.length:0;if(a)return this;for(a=!0;t<i;t++)c.tweens[t].run(1);return e?s.resolveWith(r,[c,e]):s.rejectWith(r,[c,e]),this}}),u=c.props;for(!function(e,t){var i,n,o,r,a;for(i in e)if(o=t[n=A.camelCase(i)],r=e[i],A.isArray(r)&&(o=r[1],r=e[i]=r[0]),i!==n&&(e[n]=r,delete e[i]),(a=A.cssHooks[n])&&"expand"in a)for(i in r=a.expand(r),delete e[n],r)i in e||(e[i]=r[i],t[i]=o);else t[n]=o}(u,c.opts.specialEasing);n<o;n++)if(i=ft[n].call(c,r,u,c.opts))return i;return A.map(u,yt,c),A.isFunction(c.opts.start)&&c.opts.start.call(r,c),A.fx.timer(A.extend(l,{elem:r,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}A.Animation=A.extend(bt,{tweener:function(e,t){for(var i,n=0,o=(e=A.isFunction(e)?(t=e,["*"]):e.split(" ")).length;n<o;n++)i=e[n],gt[i]=gt[i]||[],gt[i].unshift(t)},prefilter:function(e,t){t?ft.unshift(e):ft.push(e)}}),A.speed=function(e,t,i){var n=e&&"object"==typeof e?A.extend({},e):{complete:i||!i&&t||A.isFunction(e)&&e,duration:e,easing:i&&t||t&&!A.isFunction(t)&&t};return n.duration=A.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in A.fx.speeds?A.fx.speeds[n.duration]:A.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){A.isFunction(n.old)&&n.old.call(this),n.queue&&A.dequeue(this,n.queue)},n},A.fn.extend({fadeTo:function(e,t,i,n){return this.filter(W).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(t,e,i,n){function o(){var e=bt(this,A.extend({},t),a);(r||A._data(this,"finish"))&&e.stop(!0)}var r=A.isEmptyObject(t),a=A.speed(e,i,n);return o.finish=o,r||!1===a.queue?this.each(o):this.queue(a.queue,o)},stop:function(o,e,r){function a(e){var t=e.stop;delete e.stop,t(r)}return"string"!=typeof o&&(r=e,e=o,o=void 0),e&&!1!==o&&this.queue(o||"fx",[]),this.each(function(){var e=!0,t=null!=o&&o+"queueHooks",i=A.timers,n=A._data(this);if(t)n[t]&&n[t].stop&&a(n[t]);else for(t in n)n[t]&&n[t].stop&&pt.test(t)&&a(n[t]);for(t=i.length;t--;)i[t].elem!==this||null!=o&&i[t].queue!==o||(i[t].anim.stop(r),e=!1,i.splice(t,1));!e&&r||A.dequeue(this,o)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=A._data(this),i=t[a+"queue"],n=t[a+"queueHooks"],o=A.timers,r=i?i.length:0;for(t.finish=!0,A.queue(this,a,[]),n&&n.stop&&n.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===a&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<r;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete t.finish})}}),A.each(["toggle","show","hide"],function(e,n){var o=A.fn[n];A.fn[n]=function(e,t,i){return null==e||"boolean"==typeof e?o.apply(this,arguments):this.animate(vt(n,!0),e,t,i)}}),A.each({slideDown:vt("show"),slideUp:vt("hide"),slideToggle:vt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,n){A.fn[e]=function(e,t,i){return this.animate(n,e,t,i)}}),A.timers=[],A.fx.tick=function(){var e,t=A.timers,i=0;for(ot=A.now();i<t.length;i++)(e=t[i])()||t[i]!==e||t.splice(i--,1);t.length||A.fx.stop(),ot=void 0},A.fx.timer=function(e){A.timers.push(e),e()?A.fx.start():A.timers.pop()},A.fx.interval=13,A.fx.start=function(){rt=rt||setInterval(A.fx.tick,A.fx.interval)},A.fx.stop=function(){clearInterval(rt),rt=null},A.fx.speeds={slow:600,fast:200,_default:400},A.fn.delay=function(n,e){return n=A.fx&&A.fx.speeds[n]||n,e=e||"fx",this.queue(e,function(e,t){var i=setTimeout(e,n);t.stop=function(){clearTimeout(i)}})},(st=E.createElement("div")).setAttribute("className","t"),st.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",ct=st.getElementsByTagName("a")[0],ut=(lt=E.createElement("select")).appendChild(E.createElement("option")),at=st.getElementsByTagName("input")[0],ct.style.cssText="top:1px",v.getSetAttribute="t"!==st.className,v.style=/top/.test(ct.getAttribute("style")),v.hrefNormalized="/a"===ct.getAttribute("href"),v.checkOn=!!at.value,v.optSelected=ut.selected,v.enctype=!!E.createElement("form").enctype,lt.disabled=!0,v.optDisabled=!ut.disabled,(at=E.createElement("input")).setAttribute("value",""),v.input=""===at.getAttribute("value"),at.value="t",at.setAttribute("type","radio"),v.radioValue="t"===at.value;var wt=/\r/g;A.fn.extend({val:function(i){var n,e,o,t=this[0];return arguments.length?(o=A.isFunction(i),this.each(function(e){var t;1===this.nodeType&&(null==(t=o?i.call(this,e,A(this).val()):i)?t="":"number"==typeof t?t+="":A.isArray(t)&&(t=A.map(t,function(e){return null==e?"":e+""})),(n=A.valHooks[this.type]||A.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&void 0!==n.set(this,t,"value")||(this.value=t))})):t?(n=A.valHooks[t.type]||A.valHooks[t.nodeName.toLowerCase()])&&"get"in n&&void 0!==(e=n.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(wt,""):null==e?"":e:void 0}}),A.extend({valHooks:{option:{get:function(e){var t=A.find.attr(e,"value");return null!=t?t:A.trim(A.text(e))}},select:{get:function(e){for(var t,i,n=e.options,o=e.selectedIndex,r="select-one"===e.type||o<0,a=r?null:[],s=r?o+1:n.length,l=o<0?s:r?o:0;l<s;l++)if(((i=n[l]).selected||l===o)&&(v.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!A.nodeName(i.parentNode,"optgroup"))){if(t=A(i).val(),r)return t;a.push(t)}return a},set:function(e,t){for(var i,n,o=e.options,r=A.makeArray(t),a=o.length;a--;)if(n=o[a],0<=A.inArray(A.valHooks.option.get(n),r))try{n.selected=i=!0}catch(e){n.scrollHeight}else n.selected=!1;return i||(e.selectedIndex=-1),o}}}}),A.each(["radio","checkbox"],function(){A.valHooks[this]={set:function(e,t){if(A.isArray(t))return e.checked=0<=A.inArray(A(e).val(),t)}},v.checkOn||(A.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Ct,_t,At=A.expr.attrHandle,Et=/^(?:checked|selected)$/i,xt=v.getSetAttribute,St=v.input;A.fn.extend({attr:function(e,t){return V(this,A.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){A.removeAttr(this,e)})}}),A.extend({attr:function(e,t,i){var n,o,r=e.nodeType;if(e&&3!==r&&8!==r&&2!==r)return typeof e.getAttribute===P?A.prop(e,t,i):(1===r&&A.isXMLDoc(e)||(t=t.toLowerCase(),n=A.attrHooks[t]||(A.expr.match.bool.test(t)?_t:Ct)),void 0===i?n&&"get"in n&&null!==(o=n.get(e,t))?o:null==(o=A.find.attr(e,t))?void 0:o:null!==i?n&&"set"in n&&void 0!==(o=n.set(e,i,t))?o:(e.setAttribute(t,i+""),i):void A.removeAttr(e,t))},removeAttr:function(e,t){var i,n,o=0,r=t&&t.match(R);if(r&&1===e.nodeType)for(;i=r[o++];)n=A.propFix[i]||i,A.expr.match.bool.test(i)?St&&xt||!Et.test(i)?e[n]=!1:e[A.camelCase("default-"+i)]=e[n]=!1:A.attr(e,i,""),e.removeAttribute(xt?i:n)},attrHooks:{type:{set:function(e,t){if(!v.radioValue&&"radio"===t&&A.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}}}),_t={set:function(e,t,i){return!1===t?A.removeAttr(e,i):St&&xt||!Et.test(i)?e.setAttribute(!xt&&A.propFix[i]||i,i):e[A.camelCase("default-"+i)]=e[i]=!0,i}},A.each(A.expr.match.bool.source.match(/\w+/g),function(e,t){var r=At[t]||A.find.attr;At[t]=St&&xt||!Et.test(t)?function(e,t,i){var n,o;return i||(o=At[t],At[t]=n,n=null!=r(e,t,i)?t.toLowerCase():null,At[t]=o),n}:function(e,t,i){if(!i)return e[A.camelCase("default-"+t)]?t.toLowerCase():null}}),St&&xt||(A.attrHooks.value={set:function(e,t,i){if(!A.nodeName(e,"input"))return Ct&&Ct.set(e,t,i);e.defaultValue=t}}),xt||(Ct={set:function(e,t,i){var n=e.getAttributeNode(i);if(n||e.setAttributeNode(n=e.ownerDocument.createAttribute(i)),n.value=t+="","value"===i||t===e.getAttribute(i))return t}},At.id=At.name=At.coords=function(e,t,i){var n;if(!i)return(n=e.getAttributeNode(t))&&""!==n.value?n.value:null},A.valHooks.button={get:function(e,t){var i=e.getAttributeNode(t);if(i&&i.specified)return i.value},set:Ct.set},A.attrHooks.contenteditable={set:function(e,t,i){Ct.set(e,""!==t&&t,i)}},A.each(["width","height"],function(e,i){A.attrHooks[i]={set:function(e,t){if(""===t)return e.setAttribute(i,"auto"),t}}})),v.style||(A.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var Tt=/^(?:input|select|textarea|button|object)$/i,Dt=/^(?:a|area)$/i;A.fn.extend({prop:function(e,t){return V(this,A.prop,e,t,1<arguments.length)},removeProp:function(e){return e=A.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(e){}})}}),A.extend({propFix:{for:"htmlFor",class:"className"},prop:function(e,t,i){var n,o,r=e.nodeType;if(e&&3!==r&&8!==r&&2!==r)return(1!==r||!A.isXMLDoc(e))&&(t=A.propFix[t]||t,o=A.propHooks[t]),void 0!==i?o&&"set"in o&&void 0!==(n=o.set(e,i,t))?n:e[t]=i:o&&"get"in o&&null!==(n=o.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=A.find.attr(e,"tabindex");return t?parseInt(t,10):Tt.test(e.nodeName)||Dt.test(e.nodeName)&&e.href?0:-1}}}}),v.hrefNormalized||A.each(["href","src"],function(e,t){A.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),v.optSelected||(A.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),A.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){A.propFix[this.toLowerCase()]=this}),v.enctype||(A.propFix.enctype="encoding");var kt=/[\t\r\n\f]/g;A.fn.extend({addClass:function(t){var e,i,n,o,r,a,s=0,l=this.length,c="string"==typeof t&&t;if(A.isFunction(t))return this.each(function(e){A(this).addClass(t.call(this,e,this.className))});if(c)for(e=(t||"").match(R)||[];s<l;s++)if(n=1===(i=this[s]).nodeType&&(i.className?(" "+i.className+" ").replace(kt," "):" ")){for(r=0;o=e[r++];)n.indexOf(" "+o+" ")<0&&(n+=o+" ");a=A.trim(n),i.className!==a&&(i.className=a)}return this},removeClass:function(t){var e,i,n,o,r,a,s=0,l=this.length,c=0===arguments.length||"string"==typeof t&&t;if(A.isFunction(t))return this.each(function(e){A(this).removeClass(t.call(this,e,this.className))});if(c)for(e=(t||"").match(R)||[];s<l;s++)if(n=1===(i=this[s]).nodeType&&(i.className?(" "+i.className+" ").replace(kt," "):"")){for(r=0;o=e[r++];)for(;0<=n.indexOf(" "+o+" ");)n=n.replace(" "+o+" "," ");a=t?A.trim(n):"",i.className!==a&&(i.className=a)}return this},toggleClass:function(o,t){var r=typeof o;return"boolean"==typeof t&&"string"==r?t?this.addClass(o):this.removeClass(o):A.isFunction(o)?this.each(function(e){A(this).toggleClass(o.call(this,e,this.className,t),t)}):this.each(function(){if("string"==r)for(var e,t=0,i=A(this),n=o.match(R)||[];e=n[t++];)i.hasClass(e)?i.removeClass(e):i.addClass(e);else r!==P&&"boolean"!=r||(this.className&&A._data(this,"__className__",this.className),this.className=this.className||!1===o?"":A._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;i<n;i++)if(1===this[i].nodeType&&0<=(" "+this[i].className+" ").replace(kt," ").indexOf(t))return!0;return!1}}),A.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,i){A.fn[i]=function(e,t){return 0<arguments.length?this.on(i,null,e,t):this.trigger(i)}}),A.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var Rt=A.now(),Ot=/\?/,Nt=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;A.parseJSON=function(e){if(f.JSON&&f.JSON.parse)return f.JSON.parse(e+"");var o,r=null,t=A.trim(e+"");return t&&!A.trim(t.replace(Nt,function(e,t,i,n){return o&&t&&(r=0),0===r?e:(o=i||t,r+=!n-!i,"")}))?Function("return "+t)():A.error("Invalid JSON: "+e)},A.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{f.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e))}catch(e){t=void 0}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length||A.error("Invalid XML: "+e),t};var Ft,Mt,Pt=/#.*$/,It=/([?&])_=[^&]*/,Lt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Gt=/^(?:GET|HEAD)$/,$t=/^\/\//,Bt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,jt={},Wt={},Ht="*/".concat("*");try{Mt=location.href}catch(e){(Mt=E.createElement("a")).href="",Mt=Mt.href}function zt(r){return function(e,t){"string"!=typeof e&&(t=e,e="*");var i,n=0,o=e.toLowerCase().match(R)||[];if(A.isFunction(t))for(;i=o[n++];)"+"===i.charAt(0)?(i=i.slice(1)||"*",(r[i]=r[i]||[]).unshift(t)):(r[i]=r[i]||[]).push(t)}}function Vt(t,o,r,a){var s={},l=t===Wt;function c(e){var n;return s[e]=!0,A.each(t[e]||[],function(e,t){var i=t(o,r,a);return"string"!=typeof i||l||s[i]?l?!(n=i):void 0:(o.dataTypes.unshift(i),c(i),!1)}),n}return c(o.dataTypes[0])||!s["*"]&&c("*")}function Ut(e,t){var i,n,o=A.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((o[n]?e:i=i||{})[n]=t[n]);return i&&A.extend(!0,e,i),e}Ft=Bt.exec(Mt.toLowerCase())||[],A.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Mt,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ft[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ht,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":A.parseJSON,"text xml":A.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ut(Ut(e,A.ajaxSettings),t):Ut(A.ajaxSettings,e)},ajaxPrefilter:zt(jt),ajaxTransport:zt(Wt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,n,u,d,h,p,f,o,g=A.ajaxSetup({},t),m=g.context||g,v=g.context&&(m.nodeType||m.jquery)?A(m):A.event,y=A.Deferred(),b=A.Callbacks("once memory"),w=g.statusCode||{},r={},a={},C=0,s="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(2===C){if(!o)for(o={};t=Lt.exec(d);)o[t[1].toLowerCase()]=t[2];t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===C?d:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return C||(e=a[i]=a[i]||e,r[e]=t),this},overrideMimeType:function(e){return C||(g.mimeType=e),this},statusCode:function(e){var t;if(e)if(C<2)for(t in e)w[t]=[w[t],e[t]];else _.always(e[_.status]);return this},abort:function(e){var t=e||s;return f&&f.abort(t),l(0,t),this}};if(y.promise(_).complete=b.add,_.success=_.done,_.error=_.fail,g.url=((e||g.url||Mt)+"").replace(Pt,"").replace($t,Ft[1]+"//"),g.type=t.method||t.type||g.method||g.type,g.dataTypes=A.trim(g.dataType||"*").toLowerCase().match(R)||[""],null==g.crossDomain&&(i=Bt.exec(g.url.toLowerCase()),g.crossDomain=!(!i||i[1]===Ft[1]&&i[2]===Ft[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(Ft[3]||("http:"===Ft[1]?"80":"443")))),g.data&&g.processData&&"string"!=typeof g.data&&(g.data=A.param(g.data,g.traditional)),Vt(jt,g,t,_),2===C)return _;for(n in(p=g.global)&&0==A.active++&&A.event.trigger("ajaxStart"),g.type=g.type.toUpperCase(),g.hasContent=!Gt.test(g.type),u=g.url,g.hasContent||(g.data&&(u=g.url+=(Ot.test(u)?"&":"?")+g.data,delete g.data),!1===g.cache&&(g.url=It.test(u)?u.replace(It,"$1_="+Rt++):u+(Ot.test(u)?"&":"?")+"_="+Rt++)),g.ifModified&&(A.lastModified[u]&&_.setRequestHeader("If-Modified-Since",A.lastModified[u]),A.etag[u]&&_.setRequestHeader("If-None-Match",A.etag[u])),(g.data&&g.hasContent&&!1!==g.contentType||t.contentType)&&_.setRequestHeader("Content-Type",g.contentType),_.setRequestHeader("Accept",g.dataTypes[0]&&g.accepts[g.dataTypes[0]]?g.accepts[g.dataTypes[0]]+("*"!==g.dataTypes[0]?", "+Ht+"; q=0.01":""):g.accepts["*"]),g.headers)_.setRequestHeader(n,g.headers[n]);if(g.beforeSend&&(!1===g.beforeSend.call(m,_,g)||2===C))return _.abort();for(n in s="abort",{success:1,error:1,complete:1})_[n](g[n]);if(f=Vt(Wt,g,t,_)){_.readyState=1,p&&v.trigger("ajaxSend",[_,g]),g.async&&0<g.timeout&&(h=setTimeout(function(){_.abort("timeout")},g.timeout));try{C=1,f.send(r,l)}catch(e){if(!(C<2))throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,i,n){var o,r,a,s,l,c=t;2!==C&&(C=2,h&&clearTimeout(h),f=void 0,d=n||"",_.readyState=0<e?4:0,o=200<=e&&e<300||304===e,i&&(s=function(e,t,i){for(var n,o,r,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===o&&(o=e.mimeType||t.getResponseHeader("Content-Type"));if(o)for(a in s)if(s[a]&&s[a].test(o)){l.unshift(a);break}if(l[0]in i)r=l[0];else{for(a in i){if(!l[0]||e.converters[a+" "+l[0]]){r=a;break}n=n||a}r=r||n}if(r)return r!==l[0]&&l.unshift(r),i[r]}(g,_,i)),s=function(e,t,i,n){var o,r,a,s,l,c={},u=e.dataTypes.slice();if(u[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(r=u.shift();r;)if(e.responseFields[r]&&(i[e.responseFields[r]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=r,r=u.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(a=c[l+" "+r]||c["* "+r]))for(o in c)if((s=o.split(" "))[1]===r&&(a=c[l+" "+s[0]]||c["* "+s[0]])){!0===a?a=c[o]:!0!==c[o]&&(r=s[0],u.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+l+" to "+r}}}return{state:"success",data:t}}(g,s,_,o),o?(g.ifModified&&((l=_.getResponseHeader("Last-Modified"))&&(A.lastModified[u]=l),(l=_.getResponseHeader("etag"))&&(A.etag[u]=l)),204===e||"HEAD"===g.type?c="nocontent":304===e?c="notmodified":(c=s.state,r=s.data,o=!(a=s.error))):(a=c,!e&&c||(c="error",e<0&&(e=0))),_.status=e,_.statusText=(t||c)+"",o?y.resolveWith(m,[r,c,_]):y.rejectWith(m,[_,c,a]),_.statusCode(w),w=void 0,p&&v.trigger(o?"ajaxSuccess":"ajaxError",[_,g,o?r:a]),b.fireWith(m,[_,c]),p&&(v.trigger("ajaxComplete",[_,g]),--A.active||A.event.trigger("ajaxStop")))}return _},getJSON:function(e,t,i){return A.get(e,t,i,"json")},getScript:function(e,t){return A.get(e,void 0,t,"script")}}),A.each(["get","post"],function(e,o){A[o]=function(e,t,i,n){return A.isFunction(t)&&(n=n||i,i=t,t=void 0),A.ajax({url:e,type:o,dataType:n,data:t,success:i})}}),A.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){A.fn[t]=function(e){return this.on(t,e)}}),A._evalUrl=function(e){return A.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},A.fn.extend({wrapAll:function(t){if(A.isFunction(t))return this.each(function(e){A(this).wrapAll(t.call(this,e))});if(this[0]){var e=A(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(i){return A.isFunction(i)?this.each(function(e){A(this).wrapInner(i.call(this,e))}):this.each(function(){var e=A(this),t=e.contents();t.length?t.wrapAll(i):e.append(i)})},wrap:function(t){var i=A.isFunction(t);return this.each(function(e){A(this).wrapAll(i?t.call(this,e):t)})},unwrap:function(){return this.parent().each(function(){A.nodeName(this,"body")||A(this).replaceWith(this.childNodes)}).end()}}),A.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!v.reliableHiddenOffsets()&&"none"===(e.style&&e.style.display||A.css(e,"display"))},A.expr.filters.visible=function(e){return!A.expr.filters.hidden(e)};var Yt=/%20/g,qt=/\[\]$/,Qt=/\r?\n/g,Kt=/^(?:submit|button|image|reset|file)$/i,Xt=/^(?:input|select|textarea|keygen)/i;function Jt(i,e,n,o){var t;if(A.isArray(e))A.each(e,function(e,t){n||qt.test(i)?o(i,t):Jt(i+"["+("object"==typeof t?e:"")+"]",t,n,o)});else if(n||"object"!==A.type(e))o(i,e);else for(t in e)Jt(i+"["+t+"]",e[t],n,o)}A.param=function(e,t){function i(e,t){t=A.isFunction(t)?t():null==t?"":t,o[o.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)}var n,o=[];if(void 0===t&&(t=A.ajaxSettings&&A.ajaxSettings.traditional),A.isArray(e)||e.jquery&&!A.isPlainObject(e))A.each(e,function(){i(this.name,this.value)});else for(n in e)Jt(n,e[n],t,i);return o.join("&").replace(Yt,"+")},A.fn.extend({serialize:function(){return A.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=A.prop(this,"elements");return e?A.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!A(this).is(":disabled")&&Xt.test(this.nodeName)&&!Kt.test(e)&&(this.checked||!U.test(e))}).map(function(e,t){var i=A(this).val();return null==i?null:A.isArray(i)?A.map(i,function(e){return{name:t.name,value:e.replace(Qt,"\r\n")}}):{name:t.name,value:i.replace(Qt,"\r\n")}}).get()}}),A.ajaxSettings.xhr=void 0!==f.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&ii()||function(){try{return new f.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}()}:ii;var Zt=0,ei={},ti=A.ajaxSettings.xhr();function ii(){try{return new f.XMLHttpRequest}catch(e){}}f.ActiveXObject&&A(f).on("unload",function(){for(var e in ei)ei[e](void 0,!0)}),v.cors=!!ti&&"withCredentials"in ti,(ti=v.ajax=!!ti)&&A.ajaxTransport(function(l){var c;if(!l.crossDomain||v.cors)return{send:function(e,r){var t,a=l.xhr(),s=++Zt;if(a.open(l.type,l.url,l.async,l.username,l.password),l.xhrFields)for(t in l.xhrFields)a[t]=l.xhrFields[t];for(t in l.mimeType&&a.overrideMimeType&&a.overrideMimeType(l.mimeType),l.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)void 0!==e[t]&&a.setRequestHeader(t,e[t]+"");a.send(l.hasContent&&l.data||null),c=function(e,t){var i,n,o;if(c&&(t||4===a.readyState))if(delete ei[s],c=void 0,a.onreadystatechange=A.noop,t)4!==a.readyState&&a.abort();else{o={},i=a.status,"string"==typeof a.responseText&&(o.text=a.responseText);try{n=a.statusText}catch(e){n=""}i||!l.isLocal||l.crossDomain?1223===i&&(i=204):i=o.text?200:404}o&&r(i,n,o,a.getAllResponseHeaders())},l.async?4===a.readyState?setTimeout(c):a.onreadystatechange=ei[s]=c:c()},abort:function(){c&&c(void 0,!0)}}}),A.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return A.globalEval(e),e}}}),A.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),A.ajaxTransport("script",function(t){if(t.crossDomain){var n,o=E.head||A("head")[0]||E.documentElement;return{send:function(e,i){(n=E.createElement("script")).async=!0,t.scriptCharset&&(n.charset=t.scriptCharset),n.src=t.url,n.onload=n.onreadystatechange=function(e,t){!t&&n.readyState&&!/loaded|complete/.test(n.readyState)||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},o.insertBefore(n,o.firstChild)},abort:function(){n&&n.onload(void 0,!0)}}}});var ni=[],oi=/(=)\?(?=&|$)|\?\?/;A.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=ni.pop()||A.expando+"_"+Rt++;return this[e]=!0,e}}),A.ajaxPrefilter("json jsonp",function(e,t,i){var n,o,r,a=!1!==e.jsonp&&(oi.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&oi.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return n=e.jsonpCallback=A.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(oi,"$1"+n):!1!==e.jsonp&&(e.url+=(Ot.test(e.url)?"&":"?")+e.jsonp+"="+n),e.converters["script json"]=function(){return r||A.error(n+" was not called"),r[0]},e.dataTypes[0]="json",o=f[n],f[n]=function(){r=arguments},i.always(function(){f[n]=o,e[n]&&(e.jsonpCallback=t.jsonpCallback,ni.push(n)),r&&A.isFunction(o)&&o(r[0]),r=o=void 0}),"script"}),A.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||E;var n=b.exec(e),o=!i&&[];return n?[t.createElement(n[1])]:(n=A.buildFragment([e],t,o),o&&o.length&&A(o).remove(),A.merge([],n.childNodes))};var ri=A.fn.load;A.fn.load=function(e,t,i){if("string"!=typeof e&&ri)return ri.apply(this,arguments);var n,o,r,a=this,s=e.indexOf(" ");return 0<=s&&(n=A.trim(e.slice(s,e.length)),e=e.slice(0,s)),A.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(r="POST"),0<a.length&&A.ajax({url:e,type:r,dataType:"html",data:t}).done(function(e){o=arguments,a.html(n?A("<div>").append(A.parseHTML(e)).find(n):e)}).complete(i&&function(e,t){a.each(i,o||[e.responseText,t,e])}),this},A.expr.filters.animated=function(t){return A.grep(A.timers,function(e){return t===e.elem}).length};var ai=f.document.documentElement;function si(e){return A.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}A.offset={setOffset:function(e,t,i){var n,o,r,a,s,l,c=A.css(e,"position"),u=A(e),d={};"static"===c&&(e.style.position="relative"),s=u.offset(),r=A.css(e,"top"),l=A.css(e,"left"),o=("absolute"===c||"fixed"===c)&&-1<A.inArray("auto",[r,l])?(a=(n=u.position()).top,n.left):(a=parseFloat(r)||0,parseFloat(l)||0),A.isFunction(t)&&(t=t.call(e,i,s)),null!=t.top&&(d.top=t.top-s.top+a),null!=t.left&&(d.left=t.left-s.left+o),"using"in t?t.using.call(e,d):u.css(d)}},A.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){A.offset.setOffset(this,t,e)});var e,i,n={top:0,left:0},o=this[0],r=o&&o.ownerDocument;return r?(e=r.documentElement,A.contains(e,o)?(typeof o.getBoundingClientRect!==P&&(n=o.getBoundingClientRect()),i=si(r),{top:n.top+(i.pageYOffset||e.scrollTop)-(e.clientTop||0),left:n.left+(i.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):n):void 0},position:function(){if(this[0]){var e,t,i={top:0,left:0},n=this[0];return"fixed"===A.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),A.nodeName(e[0],"html")||(i=e.offset()),i.top+=A.css(e[0],"borderTopWidth",!0),i.left+=A.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-A.css(n,"marginTop",!0),left:t.left-i.left-A.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||ai;e&&!A.nodeName(e,"html")&&"static"===A.css(e,"position");)e=e.offsetParent;return e||ai})}}),A.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,o){var r=/Y/.test(o);A.fn[t]=function(e){return V(this,function(e,t,i){var n=si(e);if(void 0===i)return n?o in n?n[o]:n.document.documentElement[t]:e[t];n?n.scrollTo(r?A(n).scrollLeft():i,r?i:A(n).scrollTop()):e[t]=i},t,e,arguments.length,null)}}),A.each(["top","left"],function(e,i){A.cssHooks[i]=We(v.pixelPosition,function(e,t){if(t)return t=Oe(e,i),Be.test(t)?A(e).position()[i]+"px":t})}),A.each({Height:"height",Width:"width"},function(r,a){A.each({padding:"inner"+r,content:a,"":"outer"+r},function(n,e){A.fn[e]=function(e,t){var i=arguments.length&&(n||"boolean"!=typeof e),o=n||(!0===e||!0===t?"margin":"border");return V(this,function(e,t,i){var n;return A.isWindow(e)?e.document.documentElement["client"+r]:9===e.nodeType?(n=e.documentElement,Math.max(e.body["scroll"+r],n["scroll"+r],e.body["offset"+r],n["offset"+r],n["client"+r])):void 0===i?A.css(e,t,o):A.style(e,t,i,o)},a,i?e:void 0,i,null)}})}),A.fn.size=function(){return this.length},A.fn.andSelf=A.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return A});var li=f.jQuery,ci=f.$;return A.noConflict=function(e){return f.$===A&&(f.$=ci),e&&f.jQuery===A&&(f.jQuery=li),A},typeof e===P&&(f.jQuery=f.$=A),A}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(D){function n(e,t){var i,n,o,r=e.nodeName.toLowerCase();return"area"===r?(n=(i=e.parentNode).name,!(!e.href||!n||"map"!==i.nodeName.toLowerCase())&&(!!(o=D("img[usemap='#"+n+"']")[0])&&a(o))):(/input|select|textarea|button|object/.test(r)?!e.disabled:"a"===r&&e.href||t)&&a(e)}function a(e){return D.expr.filters.visible(e)&&!D(e).parents().addBack().filter(function(){return"hidden"===D.css(this,"visibility")}).length}function e(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},D.extend(this._defaults,this.regional[""]),this.regional.en=D.extend(!0,{},this.regional[""]),this.regional["en-US"]=D.extend(!0,{},this.regional.en),this.dpDiv=i(D("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function i(e){var t="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(t,"mouseout",function(){D(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&D(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&D(this).removeClass("ui-datepicker-next-hover")}).delegate(t,"mouseover",r)}function r(){D.datepicker._isDisabledDatepicker(y.inline?y.dpDiv.parent()[0]:y.input[0])||(D(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),D(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&D(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&D(this).addClass("ui-datepicker-next-hover"))}function d(e,t){for(var i in D.extend(e,t),t)null==t[i]&&(e[i]=t[i]);return e}function t(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}var o,s,l,c;D.ui=D.ui||{},D.extend(D.ui,{version:"1.11.1",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),D.fn.extend({scrollParent:function(e){var t=this.css("position"),i="absolute"===t,n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var e=D(this);return(!i||"static"!==e.css("position"))&&n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==t&&o.length?o:D(this[0].ownerDocument||document)},uniqueId:(c=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++c)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&D(this).removeAttr("id")})}}),D.extend(D.expr[":"],{data:D.expr.createPseudo?D.expr.createPseudo(function(t){return function(e){return!!D.data(e,t)}}):function(e,t,i){return!!D.data(e,i[3])},focusable:function(e){return n(e,!isNaN(D.attr(e,"tabindex")))},tabbable:function(e){var t=D.attr(e,"tabindex"),i=isNaN(t);return(i||0<=t)&&n(e,!i)}}),D("<a>").outerWidth(1).jquery||D.each(["Width","Height"],function(e,i){function n(e,t,i,n){return D.each(o,function(){t-=parseFloat(D.css(e,"padding"+this))||0,i&&(t-=parseFloat(D.css(e,"border"+this+"Width"))||0),n&&(t-=parseFloat(D.css(e,"margin"+this))||0)}),t}var o="Width"===i?["Left","Right"]:["Top","Bottom"],r=i.toLowerCase(),a={innerWidth:D.fn.innerWidth,innerHeight:D.fn.innerHeight,outerWidth:D.fn.outerWidth,outerHeight:D.fn.outerHeight};D.fn["inner"+i]=function(e){return void 0===e?a["inner"+i].call(this):this.each(function(){D(this).css(r,n(this,e)+"px")})},D.fn["outer"+i]=function(e,t){return"number"!=typeof e?a["outer"+i].call(this,e):this.each(function(){D(this).css(r,n(this,e,!0,t)+"px")})}}),D.fn.addBack||(D.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),D("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(D.fn.removeData=(l=D.fn.removeData,function(e){return arguments.length?l.call(this,D.camelCase(e)):l.call(this)})),D.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),D.fn.extend({focus:(s=D.fn.focus,function(t,i){return"number"==typeof t?this.each(function(){var e=this;setTimeout(function(){D(e).focus(),i&&i.call(e)},t)}):s.apply(this,arguments)}),disableSelection:(o="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.bind(o+".ui-disableSelection",function(e){e.preventDefault()})}),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var t,i,n=D(this[0]);n.length&&n[0]!==document;){if(("absolute"===(t=n.css("position"))||"relative"===t||"fixed"===t)&&(i=parseInt(n.css("zIndex"),10),!isNaN(i)&&0!==i))return i;n=n.parent()}return 0}}),D.ui.plugin={add:function(e,t,i){var n,o=D.ui[e].prototype;for(n in i)o.plugins[n]=o.plugins[n]||[],o.plugins[n].push([t,i[n]])},call:function(e,t,i,n){var o,r=e.plugins[t];if(r&&(n||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(o=0;r.length>o;o++)e.options[r[o][0]]&&r[o][1].apply(e.element,i)}};var u,h=0,p=Array.prototype.slice;D.cleanData=(u=D.cleanData,function(e){var t,i,n;for(n=0;null!=(i=e[n]);n++)try{(t=D._data(i,"events"))&&t.remove&&D(i).triggerHandler("remove")}catch(e){}u(e)}),D.widget=function(e,i,t){var n,o,r,a,s={},l=e.split(".")[0];return e=e.split(".")[1],n=l+"-"+e,t||(t=i,i=D.Widget),D.expr[":"][n.toLowerCase()]=function(e){return!!D.data(e,n)},D[l]=D[l]||{},o=D[l][e],r=D[l][e]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new r(e,t)},D.extend(r,o,{version:t.version,_proto:D.extend({},t),_childConstructors:[]}),(a=new i).options=D.widget.extend({},a.options),D.each(t,function(t,n){return D.isFunction(n)?void(s[t]=function(){var e,t=this._super,i=this._superApply;return this._super=o,this._superApply=r,e=n.apply(this,arguments),this._super=t,this._superApply=i,e}):void(s[t]=n);function o(){return i.prototype[t].apply(this,arguments)}function r(e){return i.prototype[t].apply(this,e)}}),r.prototype=D.widget.extend(a,{widgetEventPrefix:o&&a.widgetEventPrefix||e},s,{constructor:r,namespace:l,widgetName:e,widgetFullName:n}),o?(D.each(o._childConstructors,function(e,t){var i=t.prototype;D.widget(i.namespace+"."+i.widgetName,r,t._proto)}),delete o._childConstructors):i._childConstructors.push(r),D.widget.bridge(e,r),r},D.widget.extend=function(e){for(var t,i,n=p.call(arguments,1),o=0,r=n.length;o<r;o++)for(t in n[o])i=n[o][t],n[o].hasOwnProperty(t)&&void 0!==i&&(e[t]=D.isPlainObject(i)?D.isPlainObject(e[t])?D.widget.extend({},e[t],i):D.widget.extend({},i):i);return e},D.widget.bridge=function(r,t){var a=t.prototype.widgetFullName||r;D.fn[r]=function(i){var e="string"==typeof i,n=p.call(arguments,1),o=this;return i=!e&&n.length?D.widget.extend.apply(null,[i].concat(n)):i,e?this.each(function(){var e,t=D.data(this,a);return"instance"===i?(o=t,!1):t?D.isFunction(t[i])&&"_"!==i.charAt(0)?(e=t[i].apply(t,n))!==t&&void 0!==e?(o=e&&e.jquery?o.pushStack(e.get()):e,!1):void 0:D.error("no such method '"+i+"' for "+r+" widget instance"):D.error("cannot call methods on "+r+" prior to initialization; attempted to call method '"+i+"'")}):this.each(function(){var e=D.data(this,a);e?(e.option(i||{}),e._init&&e._init()):D.data(this,a,new t(i,this))}),o}},D.Widget=function(){},D.Widget._childConstructors=[],D.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,t){t=D(t||this.defaultElement||this)[0],this.element=D(t),this.uuid=h++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=D.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=D(),this.hoverable=D(),this.focusable=D(),t!==this&&(D.data(t,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===t&&this.destroy()}}),this.document=D(t.style?t.ownerDocument:t.document||t),this.window=D(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:D.noop,_getCreateEventData:D.noop,_create:D.noop,_init:D.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(D.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:D.noop,widget:function(){return this.element},option:function(e,t){var i,n,o,r=e;if(0===arguments.length)return D.widget.extend({},this.options);if("string"==typeof e)if(r={},e=(i=e.split(".")).shift(),i.length){for(n=r[e]=D.widget.extend({},this.options[e]),o=0;i.length-1>o;o++)n[i[o]]=n[i[o]]||{},n=n[i[o]];if(e=i.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=t}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];r[e]=t}return this._setOptions(r),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(a,s,e){var l,c=this;"boolean"!=typeof a&&(e=s,s=a,a=!1),e?(s=l=D(s),this.bindings=this.bindings.add(s)):(e=s,s=this.element,l=this.widget()),D.each(e,function(e,t){function i(){return a||!0!==c.options.disabled&&!D(this).hasClass("ui-state-disabled")?("string"==typeof t?c[t]:t).apply(c,arguments):void 0}"string"!=typeof t&&(i.guid=t.guid=t.guid||i.guid||D.guid++);var n=e.match(/^([\w:-]*)\s*(.*)$/),o=n[1]+c.eventNamespace,r=n[2];r?l.delegate(r,o,i):s.bind(o,i)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){var i=this;return setTimeout(function(){return("string"==typeof e?i[e]:e).apply(i,arguments)},t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){D(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){D(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){D(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){D(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,t,i){var n,o,r=this.options[e];if(i=i||{},(t=D.Event(t)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),t.target=this.element[0],o=t.originalEvent)for(n in o)n in t||(t[n]=o[n]);return this.element.trigger(t,i),!(D.isFunction(r)&&!1===r.apply(this.element[0],[t].concat(i))||t.isDefaultPrevented())}},D.each({show:"fadeIn",hide:"fadeOut"},function(r,a){D.Widget.prototype["_"+r]=function(t,e,i){"string"==typeof e&&(e={effect:e});var n,o=e?!0===e||"number"==typeof e?a:e.effect||a:r;"number"==typeof(e=e||{})&&(e={duration:e}),n=!D.isEmptyObject(e),e.complete=i,e.delay&&t.delay(e.delay),n&&D.effects&&D.effects.effect[o]?t[r](e):o!==r&&t[o]?t[o](e.duration,e.easing,i):t.queue(function(e){D(this)[r](),i&&i.call(t[0]),e()})}}),D.widget;var f=!1;D(document).mouseup(function(){f=!1}),D.widget("ui.mouse",{version:"1.11.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(e){return!0===D.data(e.target,t.widgetName+".preventClickEvent")?(D.removeData(e.target,t.widgetName+".preventClickEvent"),e.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!f){this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var t=this,i=1===e.which,n=!("string"!=typeof this.options.cancel||!e.target.nodeName)&&D(e.target).closest(this.options.cancel).length;return i&&!n&&this._mouseCapture(e)&&(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){t.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?e.preventDefault():(!0===D.data(e.target,this.widgetName+".preventClickEvent")&&D.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return t._mouseMove(e)},this._mouseUpDelegate=function(e){return t._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),f=!0)),!0}},_mouseMove:function(e){return D.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button?this._mouseUp(e):e.which?this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted):this._mouseUp(e)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&D.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),f=!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function _(e,t,i){return[parseFloat(e[0])*(l.test(e[0])?t/100:1),parseFloat(e[1])*(l.test(e[1])?i/100:1)]}function A(e,t){return parseInt(D.css(e,t),10)||0}D.ui=D.ui||{};var o,E,x=Math.max,S=Math.abs,T=Math.round,n=/left|center|right/,r=/top|center|bottom/,a=/[\+\-]\d+(\.[\d]+)?%?/,s=/^\w+/,l=/%$/,t=D.fn.position;D.position={scrollbarWidth:function(){if(void 0!==o)return o;var e,t,i=D("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),n=i.children()[0];return D("body").append(i),e=n.offsetWidth,i.css("overflow","scroll"),e===(t=n.offsetWidth)&&(t=i[0].clientWidth),i.remove(),o=e-t},getScrollInfo:function(e){var t=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),i=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),n="scroll"===t||"auto"===t&&e.width<e.element[0].scrollWidth;return{width:"scroll"===i||"auto"===i&&e.height<e.element[0].scrollHeight?D.position.scrollbarWidth():0,height:n?D.position.scrollbarWidth():0}},getWithinInfo:function(e){var t=D(e||window),i=D.isWindow(t[0]),n=!!t[0]&&9===t[0].nodeType;return{element:t,isWindow:i,isDocument:n,offset:t.offset()||{left:0,top:0},scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop(),width:i||n?t.width():t.outerWidth(),height:i||n?t.height():t.outerHeight()}}},D.fn.position=function(d){if(!d||!d.of)return t.apply(this,arguments);d=D.extend({},d);var h,p,f,g,m,e,v=D(d.of),y=D.position.getWithinInfo(d.within),b=D.position.getScrollInfo(y),w=(d.collision||"flip").split(" "),C={};return e=function(e){var t=e[0];return 9===t.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:D.isWindow(t)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:t.preventDefault?{width:0,height:0,offset:{top:t.pageY,left:t.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}(v),v[0].preventDefault&&(d.at="left top"),p=e.width,f=e.height,g=e.offset,m=D.extend({},g),D.each(["my","at"],function(){var e,t,i=(d[this]||"").split(" ");1===i.length&&(i=n.test(i[0])?i.concat(["center"]):r.test(i[0])?["center"].concat(i):["center","center"]),i[0]=n.test(i[0])?i[0]:"center",i[1]=r.test(i[1])?i[1]:"center",e=a.exec(i[0]),t=a.exec(i[1]),C[this]=[e?e[0]:0,t?t[0]:0],d[this]=[s.exec(i[0])[0],s.exec(i[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===d.at[0]?m.left+=p:"center"===d.at[0]&&(m.left+=p/2),"bottom"===d.at[1]?m.top+=f:"center"===d.at[1]&&(m.top+=f/2),h=_(C.at,p,f),m.left+=h[0],m.top+=h[1],this.each(function(){var i,e,a=D(this),s=a.outerWidth(),l=a.outerHeight(),t=A(this,"marginLeft"),n=A(this,"marginTop"),o=s+t+A(this,"marginRight")+b.width,r=l+n+A(this,"marginBottom")+b.height,c=D.extend({},m),u=_(C.my,a.outerWidth(),a.outerHeight());"right"===d.my[0]?c.left-=s:"center"===d.my[0]&&(c.left-=s/2),"bottom"===d.my[1]?c.top-=l:"center"===d.my[1]&&(c.top-=l/2),c.left+=u[0],c.top+=u[1],E||(c.left=T(c.left),c.top=T(c.top)),i={marginLeft:t,marginTop:n},D.each(["left","top"],function(e,t){D.ui.position[w[e]]&&D.ui.position[w[e]][t](c,{targetWidth:p,targetHeight:f,elemWidth:s,elemHeight:l,collisionPosition:i,collisionWidth:o,collisionHeight:r,offset:[h[0]+u[0],h[1]+u[1]],my:d.my,at:d.at,within:y,elem:a})}),d.using&&(e=function(e){var t=g.left-c.left,i=t+p-s,n=g.top-c.top,o=n+f-l,r={target:{element:v,left:g.left,top:g.top,width:p,height:f},element:{element:a,left:c.left,top:c.top,width:s,height:l},horizontal:i<0?"left":0<t?"right":"center",vertical:o<0?"top":0<n?"bottom":"middle"};p<s&&p>S(t+i)&&(r.horizontal="center"),f<l&&f>S(n+o)&&(r.vertical="middle"),r.important=x(S(t),S(i))>x(S(n),S(o))?"horizontal":"vertical",d.using.call(this,e,r)}),a.offset(D.extend(c,{using:e}))})},D.ui.position={fit:{left:function(e,t){var i,n=t.within,o=n.isWindow?n.scrollLeft:n.offset.left,r=n.width,a=e.left-t.collisionPosition.marginLeft,s=o-a,l=a+t.collisionWidth-r-o;t.collisionWidth>r?0<s&&l<=0?(i=e.left+s+t.collisionWidth-r-o,e.left+=s-i):e.left=0<l&&s<=0?o:l<s?o+r-t.collisionWidth:o:0<s?e.left+=s:0<l?e.left-=l:e.left=x(e.left-a,e.left)},top:function(e,t){var i,n=t.within,o=n.isWindow?n.scrollTop:n.offset.top,r=t.within.height,a=e.top-t.collisionPosition.marginTop,s=o-a,l=a+t.collisionHeight-r-o;t.collisionHeight>r?0<s&&l<=0?(i=e.top+s+t.collisionHeight-r-o,e.top+=s-i):e.top=0<l&&s<=0?o:l<s?o+r-t.collisionHeight:o:0<s?e.top+=s:0<l?e.top-=l:e.top=x(e.top-a,e.top)}},flip:{left:function(e,t){var i,n,o=t.within,r=o.offset.left+o.scrollLeft,a=o.width,s=o.isWindow?o.scrollLeft:o.offset.left,l=e.left-t.collisionPosition.marginLeft,c=l-s,u=l+t.collisionWidth-a-s,d="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,h="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,p=-2*t.offset[0];c<0?((i=e.left+d+h+p+t.collisionWidth-a-r)<0||S(c)>i)&&(e.left+=d+h+p):0<u&&((0<(n=e.left-t.collisionPosition.marginLeft+d+h+p-s)||u>S(n))&&(e.left+=d+h+p))},top:function(e,t){var i,n,o=t.within,r=o.offset.top+o.scrollTop,a=o.height,s=o.isWindow?o.scrollTop:o.offset.top,l=e.top-t.collisionPosition.marginTop,c=l-s,u=l+t.collisionHeight-a-s,d="top"===t.my[1]?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,h="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,p=-2*t.offset[1];c<0?(n=e.top+d+h+p+t.collisionHeight-a-r,e.top+d+h+p>c&&(n<0||S(c)>n)&&(e.top+=d+h+p)):0<u&&(i=e.top-t.collisionPosition.marginTop+d+h+p-s,e.top+d+h+p>u&&(0<i||u>S(i))&&(e.top+=d+h+p))}},flipfit:{left:function(){D.ui.position.flip.left.apply(this,arguments),D.ui.position.fit.left.apply(this,arguments)},top:function(){D.ui.position.flip.top.apply(this,arguments),D.ui.position.fit.top.apply(this,arguments)}}},function(){var e,t,i,n,o,r=document.getElementsByTagName("body")[0],a=document.createElement("div");for(o in e=document.createElement(r?"div":"body"),i={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&D.extend(i,{position:"absolute",left:"-1000px",top:"-1000px"}),i)e.style[o]=i[o];e.appendChild(a),(t=r||document.documentElement).insertBefore(e,t.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",n=D(a).offset().left,E=10<n&&n<11,e.innerHTML="",t.removeChild(e)}()}(),D.ui.position,D.widget("ui.accordion",{version:"1.11.1",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var e=this.options;this.prevShow=this.prevHide=D(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),e.collapsible||!1!==e.active&&null!=e.active||(e.active=0),this._processPanels(),e.active<0&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():D()}},_createIcons:function(){var e=this.options.icons;e&&(D("<span>").addClass("ui-accordion-header-icon ui-icon "+e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?void this._activate(t):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||!1!==this.options.active||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),void("disabled"===e&&(this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t))))},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var t=D.ui.keyCode,i=this.headers.length,n=this.headers.index(e.target),o=!1;switch(e.keyCode){case t.RIGHT:case t.DOWN:o=this.headers[(n+1)%i];break;case t.LEFT:case t.UP:o=this.headers[(n-1+i)%i];break;case t.SPACE:case t.ENTER:this._eventHandler(e);break;case t.HOME:o=this.headers[0];break;case t.END:o=this.headers[i-1]}o&&(D(e.target).attr("tabIndex",-1),D(o).attr("tabIndex",0),o.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===D.ui.keyCode.UP&&e.ctrlKey&&D(e.currentTarget).prev().focus()},refresh:function(){var e=this.options;this._processPanels(),!1===e.active&&!0===e.collapsible||!this.headers.length?(e.active=!1,this.active=D()):!1===e.active?this._activate(0):this.active.length&&!D.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=D()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var i,e=this.options,t=e.heightStyle,n=this.element.parent();this.active=this._findActive(e.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var e=D(this),t=e.uniqueId().attr("id"),i=e.next(),n=i.uniqueId().attr("id");e.attr("aria-controls",n),i.attr("aria-labelledby",t)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(e.event),"fill"===t?(i=n.height(),this.element.siblings(":visible").each(function(){var e=D(this),t=e.css("position");"absolute"!==t&&"fixed"!==t&&(i-=e.outerHeight(!0))}),this.headers.each(function(){i-=D(this).outerHeight(!0)}),this.headers.next().each(function(){D(this).height(Math.max(0,i-D(this).innerHeight()+D(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.headers.next().each(function(){i=Math.max(i,D(this).css("height","").height())}).height(i))},_activate:function(e){var t=this._findActive(e)[0];t!==this.active[0]&&(t=t||this.active[0],this._eventHandler({target:t,currentTarget:t,preventDefault:D.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):D()},_setupEvents:function(e){var i={keydown:"_keydown"};e&&D.each(e.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var t=this.options,i=this.active,n=D(e.currentTarget),o=n[0]===i[0],r=o&&t.collapsible,a=r?D():n.next(),s=i.next(),l={oldHeader:i,oldPanel:s,newHeader:r?D():n,newPanel:a};e.preventDefault(),o&&!t.collapsible||!1===this._trigger("beforeActivate",e,l)||(t.active=!r&&this.headers.index(n),this.active=o?D():n,this._toggle(l),i.removeClass("ui-accordion-header-active ui-state-active"),t.icons&&i.children(".ui-accordion-header-icon").removeClass(t.icons.activeHeader).addClass(t.icons.header),o||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),t.icons&&n.children(".ui-accordion-header-icon").removeClass(t.icons.header).addClass(t.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(e){var t=e.newPanel,i=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=t,this.prevHide=i,this.options.animate?this._animate(t,i,e):(i.hide(),t.show(),this._toggleComplete(e)),i.attr({"aria-hidden":"true"}),i.prev().attr("aria-selected","false"),t.length&&i.length?i.prev().attr({tabIndex:-1,"aria-expanded":"false"}):t.length&&this.headers.filter(function(){return 0===D(this).attr("tabIndex")}).attr("tabIndex",-1),t.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(e,i,t){function n(){s._toggleComplete(t)}var o,r,a,s=this,l=0,c=e.length&&(!i.length||e.index()<i.index()),u=this.options.animate||{},d=c&&u.down||u;return"number"==typeof d&&(a=d),"string"==typeof d&&(r=d),r=r||d.easing||u.easing,a=a||d.duration||u.duration,i.length?e.length?(o=e.show().outerHeight(),i.animate(this.hideProps,{duration:a,easing:r,step:function(e,t){t.now=Math.round(e)}}),void e.hide().animate(this.showProps,{duration:a,easing:r,complete:n,step:function(e,t){t.now=Math.round(e),"height"!==t.prop?l+=t.now:"content"!==s.options.heightStyle&&(t.now=Math.round(o-i.outerHeight()-l),l=0)}})):i.animate(this.hideProps,a,r,n):e.animate(this.showProps,a,r,n)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),D.widget("ui.menu",{version:"1.11.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(e){var t=D(e.target);!this.mouseHandled&&t.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),t.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&D(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){var t=D(e.currentTarget);t.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(e,t)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,i)},blur:function(e){this._delay(function(){D.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=D(this);e.data("ui-menu-submenu-carat")&&e.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){function t(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var i,n,o,r,a,s=!0;switch(e.keyCode){case D.ui.keyCode.PAGE_UP:this.previousPage(e);break;case D.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case D.ui.keyCode.HOME:this._move("first","first",e);break;case D.ui.keyCode.END:this._move("last","last",e);break;case D.ui.keyCode.UP:this.previous(e);break;case D.ui.keyCode.DOWN:this.next(e);break;case D.ui.keyCode.LEFT:this.collapse(e);break;case D.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case D.ui.keyCode.ENTER:case D.ui.keyCode.SPACE:this._activate(e);break;case D.ui.keyCode.ESCAPE:this.collapse(e);break;default:s=!1,n=this.previousFilter||"",o=String.fromCharCode(e.keyCode),r=!1,clearTimeout(this.filterTimer),o===n?r=!0:o=n+o,a=RegExp("^"+t(o),"i"),i=this.activeMenu.find(this.options.items).filter(function(){return a.test(D(this).text())}),(i=r&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i).length||(o=String.fromCharCode(e.keyCode),a=RegExp("^"+t(o),"i"),i=this.activeMenu.find(this.options.items).filter(function(){return a.test(D(this).text())})),i.length?(this.focus(e,i),1<i.length?(this.previousFilter=o,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}s&&e.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(e):this.select(e))},refresh:function(){var e,t=this,n=this.options.icons.submenu,i=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),i.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=D(this),t=e.parent(),i=D("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);t.attr("aria-haspopup","true").prepend(i),e.attr("aria-labelledby",t.attr("id"))}),(e=i.add(this.element).find(this.options.items)).not(".ui-menu-item").each(function(){var e=D(this);t._isDivider(e)&&e.addClass("ui-widget-content ui-menu-divider")}),e.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),e.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!D.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},focus:function(e,t){var i,n;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),n=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(i=t.children(".ui-menu")).length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(e){var t,i,n,o,r,a;this._hasScroll()&&(t=parseFloat(D.css(this.activeMenu[0],"borderTopWidth"))||0,i=parseFloat(D.css(this.activeMenu[0],"paddingTop"))||0,n=e.offset().top-this.activeMenu.offset().top-t-i,o=this.activeMenu.scrollTop(),r=this.activeMenu.height(),a=e.outerHeight(),n<0?this.activeMenu.scrollTop(o+n):r<n+a&&this.activeMenu.scrollTop(o+n-r+a))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(e){var t=D.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(t)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var e=i?this.element:D(t&&t.target).closest(this.element.find(".ui-menu"));e.length||(e=this.element),this._close(e),this.blur(t),this.activeMenu=e},this.delay)},_close:function(e){(e=e||(this.active?this.active.parent():this.element)).find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(e){return!D(e.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var n;this.active&&(n="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.find(this.options.items)[t]()),this.focus(i,n)},nextPage:function(e){var t,i,n;return this.active?void(this.isLastItem()||(this._hasScroll()?(i=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return(t=D(this)).offset().top-i-n<0}),this.focus(e,t)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(e)},previousPage:function(e){var t,i,n;return this.active?void(this.isFirstItem()||(this._hasScroll()?(i=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return 0<(t=D(this)).offset().top-i+n}),this.focus(e,t)):this.focus(e,this.activeMenu.find(this.options.items).first()))):void this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||D(e.target).closest(".ui-menu-item");var t={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,t)}}),D.widget("ui.autocomplete",{version:"1.11.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var i,n,o,e=this.element[0].nodeName.toLowerCase(),t="textarea"===e,r="input"===e;this.isMultiLine=t||!r&&this.element.prop("isContentEditable"),this.valueMethod=this.element[t||r?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(e){if(this.element.prop("readOnly"))n=o=i=!0;else{n=o=i=!1;var t=D.ui.keyCode;switch(e.keyCode){case t.PAGE_UP:i=!0,this._move("previousPage",e);break;case t.PAGE_DOWN:i=!0,this._move("nextPage",e);break;case t.UP:i=!0,this._keyEvent("previous",e);break;case t.DOWN:i=!0,this._keyEvent("next",e);break;case t.ENTER:this.menu.active&&(i=!0,e.preventDefault(),this.menu.select(e));break;case t.TAB:this.menu.active&&this.menu.select(e);break;case t.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(e),e.preventDefault());break;default:n=!0,this._searchTimeout(e)}}},keypress:function(e){if(i)return i=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||e.preventDefault());if(!n){var t=D.ui.keyCode;switch(e.keyCode){case t.PAGE_UP:this._move("previousPage",e);break;case t.PAGE_DOWN:this._move("nextPage",e);break;case t.UP:this._keyEvent("previous",e);break;case t.DOWN:this._keyEvent("next",e)}}},input:function(e){return o?(o=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),void this._change(e))}}),this._initSource(),this.menu=D("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];D(e.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(e){e.target===t.element[0]||e.target===i||D.contains(i,e.target)||t.close()})})},menufocus:function(e,t){var i,n;return this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){D(e.target).trigger(e.originalEvent)})):(n=t.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",e,{item:n})&&e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(n.value),void((i=t.item.attr("aria-label")||n.value)&&D.trim(i).length&&(this.liveRegion.children().hide(),D("<div>").text(i).appendTo(this.liveRegion))))},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=D("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return(e=e&&(e.jquery||e.nodeType?D(e):this.document.find(e).eq(0)))&&e[0]||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_initSource:function(){var i,n,o=this;D.isArray(this.options.source)?(i=this.options.source,this.source=function(e,t){t(D.ui.autocomplete.filter(i,e.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(e,t){o.xhr&&o.xhr.abort(),o.xhr=D.ajax({url:n,data:e,dataType:"json",success:function(e){t(e)},error:function(){t([])}})}):this.source=this.options.source},_searchTimeout:function(n){clearTimeout(this.searching),this.searching=this._delay(function(){var e=this.term===this._value(),t=this.menu.element.is(":visible"),i=n.altKey||n.ctrlKey||n.metaKey||n.shiftKey;e&&(!e||t||i)||(this.selectedItem=null,this.search(null,n))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):!1!==this._trigger("search",t)?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return D.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e=e&&this._normalize(e),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:D.map(e,function(e){return"string"==typeof e?{label:e,value:e}:D.extend({},e,{label:e.label||e.value,value:e.value||e.label})})},_suggest:function(e){var t=this.menu.element.empty();this._renderMenu(t,e),this.isNewMenu=!0,this.menu.refresh(),t.show(),this._resizeMenu(),t.position(D.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(i,e){var n=this;D.each(e,function(e,t){n._renderItemData(i,t)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(e,t){return D("<li>").text(t.label).appendTo(e)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(e,t),t.preventDefault())}}),D.extend(D.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,t){var i=RegExp(D.ui.autocomplete.escapeRegex(t),"i");return D.grep(e,function(e){return i.test(e.label||e.value||e)})}}),D.widget("ui.autocomplete",D.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(1<e?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.children().hide(),D("<div>").text(t).appendTo(this.liveRegion))}}),D.ui.autocomplete;function g(){var e=D(this);setTimeout(function(){e.find(":ui-button").button("refresh")},1)}function m(e){var t=e.name,i=e.form,n=D([]);return t&&(t=t.replace(/'/g,"\\'"),n=i?D(i).find("[name='"+t+"'][type=radio]"):D("[name='"+t+"'][type=radio]",e.ownerDocument).filter(function(){return!this.form})),n}var v,y,b="ui-button ui-widget ui-state-default ui-corner-all",w="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only";function C(e,t,i){return t<=e&&e<t+i}D.widget("ui.button",{version:"1.11.1",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,g),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,i=this.options,e="checkbox"===this.type||"radio"===this.type,n=e?"":"ui-state-active";null===i.label&&(i.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(b).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){i.disabled||this===v&&D(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){i.disabled||D(this).removeClass(n)}).bind("click"+this.eventNamespace,function(e){i.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),e&&this.element.bind("change"+this.eventNamespace,function(){t.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return!i.disabled&&void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1;D(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var e=t.element[0];m(e).not(e).map(function(){return D(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return!i.disabled&&(D(this).addClass("ui-state-active"),v=this,void t.document.one("mouseup",function(){v=null}))}).bind("mouseup"+this.eventNamespace,function(){return!i.disabled&&void D(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(e){return!i.disabled&&void(e.keyCode!==D.ui.keyCode.SPACE&&e.keyCode!==D.ui.keyCode.ENTER||D(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){D(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===D.ui.keyCode.SPACE&&D(this).click()})),this._setOption("disabled",i.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),(i=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(b+" ui-state-active "+w).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),void(t&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")))):void this._resetButton()},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e),"radio"===this.type?m(this.element[0]).each(function(){D(this).is(":checked")?D(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):D(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"!==this.type){var e=this.buttonElement.removeClass(w),t=D("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),i=this.options.icons,n=i.primary&&i.secondary,o=[];i.primary||i.secondary?(this.options.text&&o.push("ui-button-text-icon"+(n?"s":i.primary?"-primary":"-secondary")),i.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+i.primary+"'></span>"),i.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+i.secondary+"'></span>"),this.options.text||(o.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||e.attr("title",D.trim(t)))):o.push("ui-button-text-only"),e.addClass(o.join(" "))}else this.options.label&&this.element.val(this.options.label)}}),D.widget("ui.buttonset",{version:"1.11.1",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var e="rtl"===this.element.css("direction"),t=this.element.find(this.options.items),i=t.filter(":ui-button");t.not(":ui-button").button(),i.button("refresh"),this.buttons=t.map(function(){return D(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return D(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),D.ui.button,D.extend(D.ui,{datepicker:{version:"1.11.1"}}),D.extend(e.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return d(this._defaults,e||{}),this},_attachDatepicker:function(e,t){var i,n,o;n="div"===(i=e.nodeName.toLowerCase())||"span"===i,e.id||(this.uuid+=1,e.id="dp"+this.uuid),(o=this._newInst(D(e),n)).settings=D.extend({},t||{}),"input"===i?this._connectDatepicker(e,o):n&&this._inlineDatepicker(e,o)},_newInst:function(e,t){return{id:e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:t?i(D("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,t){var i=D(e);t.append=D([]),t.trigger=D([]),i.hasClass(this.markerClassName)||(this._attachments(i,t),i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(t),D.data(e,"datepicker",t),t.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,t){var i,n,o,r=this._get(t,"appendText"),a=this._get(t,"isRTL");t.append&&t.append.remove(),r&&(t.append=D("<span class='"+this._appendClass+"'>"+r+"</span>"),e[a?"before":"after"](t.append)),e.unbind("focus",this._showDatepicker),t.trigger&&t.trigger.remove(),"focus"!==(i=this._get(t,"showOn"))&&"both"!==i||e.focus(this._showDatepicker),"button"!==i&&"both"!==i||(n=this._get(t,"buttonText"),o=this._get(t,"buttonImage"),t.trigger=D(this._get(t,"buttonImageOnly")?D("<img/>").addClass(this._triggerClass).attr({src:o,alt:n,title:n}):D("<button type='button'></button>").addClass(this._triggerClass).html(o?D("<img/>").attr({src:o,alt:n,title:n}):n)),e[a?"before":"after"](t.trigger),t.trigger.click(function(){return D.datepicker._datepickerShowing&&D.datepicker._lastInput===e[0]?D.datepicker._hideDatepicker():(D.datepicker._datepickerShowing&&D.datepicker._lastInput!==e[0]&&D.datepicker._hideDatepicker(),D.datepicker._showDatepicker(e[0])),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,n,o,r=new Date(2009,11,20),a=this._get(e,"dateFormat");a.match(/[DM]/)&&(t=function(e){for(o=n=i=0;e.length>o;o++)e[o].length>i&&(i=e[o].length,n=o);return n},r.setMonth(t(this._get(e,a.match(/MM/)?"monthNames":"monthNamesShort"))),r.setDate(t(this._get(e,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-r.getDay())),e.input.attr("size",this._formatDate(e,r).length)}},_inlineDatepicker:function(e,t){var i=D(e);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(t.dpDiv),D.data(e,"datepicker",t),this._setDate(t,this._getDefaultDate(t),!0),this._updateDatepicker(t),this._updateAlternate(t),t.settings.disabled&&this._disableDatepicker(e),t.dpDiv.css("display","block"))},_dialogDatepicker:function(e,t,i,n,o){var r,a,s,l,c,u=this._dialogInst;return u||(this.uuid+=1,r="dp"+this.uuid,this._dialogInput=D("<input type='text' id='"+r+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),D("body").append(this._dialogInput),(u=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},D.data(this._dialogInput[0],"datepicker",u)),d(u.settings,n||{}),t=t&&t.constructor===Date?this._formatDate(u,t):t,this._dialogInput.val(t),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,this._pos||(a=document.documentElement.clientWidth,s=document.documentElement.clientHeight,l=document.documentElement.scrollLeft||document.body.scrollLeft,c=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[a/2-100+l,s/2-150+c]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),u.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),D.blockUI&&D.blockUI(this.dpDiv),D.data(this._dialogInput[0],"datepicker",u),this},_destroyDatepicker:function(e){var t,i=D(e),n=D.data(e,"datepicker");i.hasClass(this.markerClassName)&&(t=e.nodeName.toLowerCase(),D.removeData(e,"datepicker"),"input"===t?(n.append.remove(),n.trigger.remove(),i.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):"div"!==t&&"span"!==t||i.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var e,i,n=D(t),o=D.data(t,"datepicker");n.hasClass(this.markerClassName)&&("input"===(e=t.nodeName.toLowerCase())?(t.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==e&&"span"!==e||((i=n.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=D.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var e,i,n=D(t),o=D.data(t,"datepicker");n.hasClass(this.markerClassName)&&("input"===(e=t.nodeName.toLowerCase())?(t.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==e&&"span"!==e||((i=n.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=D.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(e){try{return D.data(e,"datepicker")}catch(e){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,i){var n,o,r,a,s=this._getInst(e);return 2===arguments.length&&"string"==typeof t?"defaults"===t?D.extend({},D.datepicker._defaults):s?"all"===t?D.extend({},s.settings):this._get(s,t):null:(n=t||{},"string"==typeof t&&((n={})[t]=i),void(s&&(this._curInst===s&&this._hideDatepicker(),o=this._getDateDatepicker(e,!0),r=this._getMinMaxDate(s,"min"),a=this._getMinMaxDate(s,"max"),d(s.settings,n),null!==r&&void 0!==n.dateFormat&&void 0===n.minDate&&(s.settings.minDate=this._formatDate(s,r)),null!==a&&void 0!==n.dateFormat&&void 0===n.maxDate&&(s.settings.maxDate=this._formatDate(s,a)),"disabled"in n&&(n.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(D(e),s),this._autoSize(s),this._setDate(s,o),this._updateAlternate(s),this._updateDatepicker(s))))},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(e){var t,i,n,o=D.datepicker._getInst(e.target),r=!0,a=o.dpDiv.is(".ui-datepicker-rtl");if(o._keyEvent=!0,D.datepicker._datepickerShowing)switch(e.keyCode){case 9:D.datepicker._hideDatepicker(),r=!1;break;case 13:return(n=D("td."+D.datepicker._dayOverClass+":not(."+D.datepicker._currentClass+")",o.dpDiv))[0]&&D.datepicker._selectDay(e.target,o.selectedMonth,o.selectedYear,n[0]),(t=D.datepicker._get(o,"onSelect"))?(i=D.datepicker._formatDate(o),t.apply(o.input?o.input[0]:null,[i,o])):D.datepicker._hideDatepicker(),!1;case 27:D.datepicker._hideDatepicker();break;case 33:D.datepicker._adjustDate(e.target,e.ctrlKey?-D.datepicker._get(o,"stepBigMonths"):-D.datepicker._get(o,"stepMonths"),"M");break;case 34:D.datepicker._adjustDate(e.target,e.ctrlKey?+D.datepicker._get(o,"stepBigMonths"):+D.datepicker._get(o,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&D.datepicker._clearDate(e.target),r=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&D.datepicker._gotoToday(e.target),r=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&D.datepicker._adjustDate(e.target,a?1:-1,"D"),r=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&D.datepicker._adjustDate(e.target,e.ctrlKey?-D.datepicker._get(o,"stepBigMonths"):-D.datepicker._get(o,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&D.datepicker._adjustDate(e.target,-7,"D"),r=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&D.datepicker._adjustDate(e.target,a?-1:1,"D"),r=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&D.datepicker._adjustDate(e.target,e.ctrlKey?+D.datepicker._get(o,"stepBigMonths"):+D.datepicker._get(o,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&D.datepicker._adjustDate(e.target,7,"D"),r=e.ctrlKey||e.metaKey;break;default:r=!1}else 36===e.keyCode&&e.ctrlKey?D.datepicker._showDatepicker(this):r=!1;r&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var t,i,n=D.datepicker._getInst(e.target);return D.datepicker._get(n,"constrainInput")?(t=D.datepicker._possibleChars(D.datepicker._get(n,"dateFormat")),i=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||i<" "||!t||-1<t.indexOf(i)):void 0},_doKeyUp:function(e){var t=D.datepicker._getInst(e.target);if(t.input.val()!==t.lastVal)try{D.datepicker.parseDate(D.datepicker._get(t,"dateFormat"),t.input?t.input.val():null,D.datepicker._getFormatConfig(t))&&(D.datepicker._setDateFromField(t),D.datepicker._updateAlternate(t),D.datepicker._updateDatepicker(t))}catch(e){}return!0},_showDatepicker:function(e){var t,i,n,o,r,a,s;"input"!==(e=e.target||e).nodeName.toLowerCase()&&(e=D("input",e.parentNode)[0]),D.datepicker._isDisabledDatepicker(e)||D.datepicker._lastInput===e||(t=D.datepicker._getInst(e),D.datepicker._curInst&&D.datepicker._curInst!==t&&(D.datepicker._curInst.dpDiv.stop(!0,!0),t&&D.datepicker._datepickerShowing&&D.datepicker._hideDatepicker(D.datepicker._curInst.input[0])),!1!==(n=(i=D.datepicker._get(t,"beforeShow"))?i.apply(e,[e,t]):{})&&(d(t.settings,n),t.lastVal=null,D.datepicker._lastInput=e,D.datepicker._setDateFromField(t),D.datepicker._inDialog&&(e.value=""),D.datepicker._pos||(D.datepicker._pos=D.datepicker._findPos(e),D.datepicker._pos[1]+=e.offsetHeight),o=!1,D(e).parents().each(function(){return!(o|="fixed"===D(this).css("position"))}),r={left:D.datepicker._pos[0],top:D.datepicker._pos[1]},D.datepicker._pos=null,t.dpDiv.empty(),t.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),D.datepicker._updateDatepicker(t),r=D.datepicker._checkOffset(t,r,o),t.dpDiv.css({position:D.datepicker._inDialog&&D.blockUI?"static":o?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"}),t.inline||(a=D.datepicker._get(t,"showAnim"),s=D.datepicker._get(t,"duration"),t.dpDiv.css("z-index",function(e){for(var t,i;e.length&&e[0]!==document;){if(("absolute"===(t=e.css("position"))||"relative"===t||"fixed"===t)&&(i=parseInt(e.css("zIndex"),10),!isNaN(i)&&0!==i))return i;e=e.parent()}return 0}(D(e))+1),D.datepicker._datepickerShowing=!0,D.effects&&D.effects.effect[a]?t.dpDiv.show(a,D.datepicker._get(t,"showOptions"),s):t.dpDiv[a||"show"](a?s:null),D.datepicker._shouldFocusInput(t)&&t.input.focus(),D.datepicker._curInst=t)))},_updateDatepicker:function(e){this.maxRows=4,(y=e).dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var t,i=this._getNumberOfMonths(e),n=i[1],o=e.dpDiv.find("."+this._dayOverClass+" a");0<o.length&&r.apply(o.get(0)),e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),1<n&&e.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",17*n+"em"),e.dpDiv[(1!==i[0]||1!==i[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===D.datepicker._curInst&&D.datepicker._datepickerShowing&&D.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(t=e.yearshtml,setTimeout(function(){t===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),t=e.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(e,t,i){var n=e.dpDiv.outerWidth(),o=e.dpDiv.outerHeight(),r=e.input?e.input.outerWidth():0,a=e.input?e.input.outerHeight():0,s=document.documentElement.clientWidth+(i?0:D(document).scrollLeft()),l=document.documentElement.clientHeight+(i?0:D(document).scrollTop());return t.left-=this._get(e,"isRTL")?n-r:0,t.left-=i&&t.left===e.input.offset().left?D(document).scrollLeft():0,t.top-=i&&t.top===e.input.offset().top+a?D(document).scrollTop():0,t.left-=Math.min(t.left,t.left+n>s&&n<s?Math.abs(t.left+n-s):0),t.top-=Math.min(t.top,t.top+o>l&&o<l?Math.abs(o+a):0),t},_findPos:function(e){for(var t,i=this._getInst(e),n=this._get(i,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||D.expr.filters.hidden(e));)e=e[n?"previousSibling":"nextSibling"];return[(t=D(e).offset()).left,t.top]},_hideDatepicker:function(e){var t,i,n,o,r=this._curInst;!r||e&&r!==D.data(e,"datepicker")||this._datepickerShowing&&(t=this._get(r,"showAnim"),i=this._get(r,"duration"),n=function(){D.datepicker._tidyDialog(r)},D.effects&&(D.effects.effect[t]||D.effects[t])?r.dpDiv.hide(t,D.datepicker._get(r,"showOptions"),i,n):r.dpDiv["slideDown"===t?"slideUp":"fadeIn"===t?"fadeOut":"hide"](t?i:null,n),t||n(),this._datepickerShowing=!1,(o=this._get(r,"onClose"))&&o.apply(r.input?r.input[0]:null,[r.input?r.input.val():"",r]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),D.blockUI&&(D.unblockUI(),D("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(D.datepicker._curInst){var t=D(e.target),i=D.datepicker._getInst(t[0]);(t[0].id===D.datepicker._mainDivId||0!==t.parents("#"+D.datepicker._mainDivId).length||t.hasClass(D.datepicker.markerClassName)||t.closest("."+D.datepicker._triggerClass).length||!D.datepicker._datepickerShowing||D.datepicker._inDialog&&D.blockUI)&&(!t.hasClass(D.datepicker.markerClassName)||D.datepicker._curInst===i)||D.datepicker._hideDatepicker()}},_adjustDate:function(e,t,i){var n=D(e),o=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(o,t+("M"===i?this._get(o,"showCurrentAtPos"):0),i),this._updateDatepicker(o))},_gotoToday:function(e){var t,i=D(e),n=this._getInst(i[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(t=new Date,n.selectedDay=t.getDate(),n.drawMonth=n.selectedMonth=t.getMonth(),n.drawYear=n.selectedYear=t.getFullYear()),this._notifyChange(n),this._adjustDate(i)},_selectMonthYear:function(e,t,i){var n=D(e),o=this._getInst(n[0]);o["selected"+("M"===i?"Month":"Year")]=o["draw"+("M"===i?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10),this._notifyChange(o),this._adjustDate(n)},_selectDay:function(e,t,i,n){var o,r=D(e);D(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(r[0])||((o=this._getInst(r[0])).selectedDay=o.currentDay=D("a",n).html(),o.selectedMonth=o.currentMonth=t,o.selectedYear=o.currentYear=i,this._selectDate(e,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear)))},_clearDate:function(e){var t=D(e);this._selectDate(t,"")},_selectDate:function(e,t){var i,n=D(e),o=this._getInst(n[0]);t=null!=t?t:this._formatDate(o),o.input&&o.input.val(t),this._updateAlternate(o),(i=this._get(o,"onSelect"))?i.apply(o.input?o.input[0]:null,[t,o]):o.input&&o.input.trigger("change"),o.inline?this._updateDatepicker(o):(this._hideDatepicker(),this._lastInput=o.input[0],"object"!=typeof o.input[0]&&o.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var t,i,n,o=this._get(e,"altField");o&&(t=this._get(e,"altFormat")||this._get(e,"dateFormat"),i=this._getDate(e),n=this.formatDate(t,i,this._getFormatConfig(e)),D(o).each(function(){D(this).val(n)}))},noWeekends:function(e){var t=e.getDay();return[0<t&&t<6,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(i,r,e){if(null==i||null==r)throw"Invalid arguments";if(""===(r="object"==typeof r?""+r:r+""))return null;function a(e){var t=i.length>s+1&&i.charAt(s+1)===e;return t&&s++,t}function t(e){var t=a(e),i="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,n=RegExp("^\\d{"+("y"===e?i:1)+","+i+"}"),o=r.substring(d).match(n);if(!o)throw"Missing number at position "+d;return d+=o[0].length,parseInt(o[0],10)}function n(e,t,i){var n=-1,o=D.map(a(e)?i:t,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(D.each(o,function(e,t){var i=t[1];return r.substr(d,i.length).toLowerCase()===i.toLowerCase()?(n=t[0],d+=i.length,!1):void 0}),-1!==n)return n+1;throw"Unknown name at position "+d}function o(){if(r.charAt(d)!==i.charAt(s))throw"Unexpected literal at position "+d;d++}var s,l,c,u,d=0,h=(e?e.shortYearCutoff:null)||this._defaults.shortYearCutoff,p="string"!=typeof h?h:(new Date).getFullYear()%100+parseInt(h,10),f=(e?e.dayNamesShort:null)||this._defaults.dayNamesShort,g=(e?e.dayNames:null)||this._defaults.dayNames,m=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort,v=(e?e.monthNames:null)||this._defaults.monthNames,y=-1,b=-1,w=-1,C=-1,_=!1;for(s=0;i.length>s;s++)if(_)"'"!==i.charAt(s)||a("'")?o():_=!1;else switch(i.charAt(s)){case"d":w=t("d");break;case"D":n("D",f,g);break;case"o":C=t("o");break;case"m":b=t("m");break;case"M":b=n("M",m,v);break;case"y":y=t("y");break;case"@":y=(u=new Date(t("@"))).getFullYear(),b=u.getMonth()+1,w=u.getDate();break;case"!":y=(u=new Date((t("!")-this._ticksTo1970)/1e4)).getFullYear(),b=u.getMonth()+1,w=u.getDate();break;case"'":a("'")?o():_=!0;break;default:o()}if(r.length>d&&(c=r.substr(d),!/^\s+/.test(c)))throw"Extra/unparsed characters found in date: "+c;if(-1===y?y=(new Date).getFullYear():y<100&&(y+=(new Date).getFullYear()-(new Date).getFullYear()%100+(y<=p?0:-100)),-1<C)for(b=1,w=C;!(w<=(l=this._getDaysInMonth(y,b-1)));)b++,w-=l;if((u=this._daylightSavingAdjust(new Date(y,b-1,w))).getFullYear()!==y||u.getMonth()+1!==b||u.getDate()!==w)throw"Invalid date";return u},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(i,e,t){if(!e)return"";function o(e){var t=i.length>a+1&&i.charAt(a+1)===e;return t&&a++,t}function n(e,t,i){var n=""+t;if(o(e))for(;i>n.length;)n="0"+n;return n}function r(e,t,i,n){return o(e)?n[t]:i[t]}var a,s=(t?t.dayNamesShort:null)||this._defaults.dayNamesShort,l=(t?t.dayNames:null)||this._defaults.dayNames,c=(t?t.monthNamesShort:null)||this._defaults.monthNamesShort,u=(t?t.monthNames:null)||this._defaults.monthNames,d="",h=!1;if(e)for(a=0;i.length>a;a++)if(h)"'"!==i.charAt(a)||o("'")?d+=i.charAt(a):h=!1;else switch(i.charAt(a)){case"d":d+=n("d",e.getDate(),2);break;case"D":d+=r("D",e.getDay(),s,l);break;case"o":d+=n("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=n("m",e.getMonth()+1,2);break;case"M":d+=r("M",e.getMonth(),c,u);break;case"y":d+=o("y")?e.getFullYear():(e.getYear()%100<10?"0":"")+e.getYear()%100;break;case"@":d+=e.getTime();break;case"!":d+=1e4*e.getTime()+this._ticksTo1970;break;case"'":o("'")?d+="'":h=!0;break;default:d+=i.charAt(a)}return d},_possibleChars:function(i){function e(e){var t=i.length>n+1&&i.charAt(n+1)===e;return t&&n++,t}var n,t="",o=!1;for(n=0;i.length>n;n++)if(o)"'"!==i.charAt(n)||e("'")?t+=i.charAt(n):o=!1;else switch(i.charAt(n)){case"d":case"m":case"y":case"@":t+="0123456789";break;case"D":case"M":return null;case"'":e("'")?t+="'":o=!0;break;default:t+=i.charAt(n)}return t},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),n=e.lastVal=e.input?e.input.val():null,o=this._getDefaultDate(e),r=o,a=this._getFormatConfig(e);try{r=this.parseDate(i,n,a)||o}catch(e){n=t?"":n}e.selectedDay=r.getDate(),e.drawMonth=e.selectedMonth=r.getMonth(),e.drawYear=e.selectedYear=r.getFullYear(),e.currentDay=n?r.getDate():0,e.currentMonth=n?r.getMonth():0,e.currentYear=n?r.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(s,e,t){var i,n,o=null==e||""===e?t:"string"==typeof e?function(e){try{return D.datepicker.parseDate(D.datepicker._get(s,"dateFormat"),e,D.datepicker._getFormatConfig(s))}catch(e){}for(var t=(e.toLowerCase().match(/^c/)?D.datepicker._getDate(s):null)||new Date,i=t.getFullYear(),n=t.getMonth(),o=t.getDate(),r=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,a=r.exec(e);a;){switch(a[2]||"d"){case"d":case"D":o+=parseInt(a[1],10);break;case"w":case"W":o+=7*parseInt(a[1],10);break;case"m":case"M":n+=parseInt(a[1],10),o=Math.min(o,D.datepicker._getDaysInMonth(i,n));break;case"y":case"Y":i+=parseInt(a[1],10),o=Math.min(o,D.datepicker._getDaysInMonth(i,n))}a=r.exec(e)}return new Date(i,n,o)}(e):"number"==typeof e?isNaN(e)?t:(i=e,(n=new Date).setDate(n.getDate()+i),n):new Date(e.getTime());return(o=o&&"Invalid Date"==""+o?t:o)&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(12<e.getHours()?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var n=!t,o=e.selectedMonth,r=e.selectedYear,a=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=a.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=a.getMonth(),e.drawYear=e.selectedYear=e.currentYear=a.getFullYear(),o===e.selectedMonth&&r===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(n?"":this._formatDate(e))},_getDate:function(e){return!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay))},_attachHandlers:function(e){var t=this._get(e,"stepMonths"),i="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){D.datepicker._adjustDate(i,-t,"M")},next:function(){D.datepicker._adjustDate(i,+t,"M")},hide:function(){D.datepicker._hideDatepicker()},today:function(){D.datepicker._gotoToday(i)},selectDay:function(){return D.datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return D.datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return D.datepicker._selectMonthYear(i,this,"Y"),!1}};D(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,n,o,r,a,s,l,c,u,d,h,p,f,g,m,v,y,b,w,C,_,A,E,x,S,T,D,k,R,O,N,F,M,P,I,L,G,$,B=new Date,j=this._daylightSavingAdjust(new Date(B.getFullYear(),B.getMonth(),B.getDate())),W=this._get(e,"isRTL"),H=this._get(e,"showButtonPanel"),z=this._get(e,"hideIfNoPrevNext"),V=this._get(e,"navigationAsDateFormat"),U=this._getNumberOfMonths(e),Y=this._get(e,"showCurrentAtPos"),q=this._get(e,"stepMonths"),Q=1!==U[0]||1!==U[1],K=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),X=this._getMinMaxDate(e,"min"),J=this._getMinMaxDate(e,"max"),Z=e.drawMonth-Y,ee=e.drawYear;if(Z<0&&(Z+=12,ee--),J)for(t=this._daylightSavingAdjust(new Date(J.getFullYear(),J.getMonth()-U[0]*U[1]+1,J.getDate())),t=X&&t<X?X:t;this._daylightSavingAdjust(new Date(ee,Z,1))>t;)--Z<0&&(Z=11,ee--);for(e.drawMonth=Z,e.drawYear=ee,i=this._get(e,"prevText"),i=V?this.formatDate(i,this._daylightSavingAdjust(new Date(ee,Z-q,1)),this._getFormatConfig(e)):i,n=this._canAdjustMonth(e,-1,ee,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(W?"e":"w")+"'>"+i+"</span></a>":z?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(W?"e":"w")+"'>"+i+"</span></a>",o=this._get(e,"nextText"),o=V?this.formatDate(o,this._daylightSavingAdjust(new Date(ee,Z+q,1)),this._getFormatConfig(e)):o,r=this._canAdjustMonth(e,1,ee,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(W?"w":"e")+"'>"+o+"</span></a>":z?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(W?"w":"e")+"'>"+o+"</span></a>",a=this._get(e,"currentText"),s=this._get(e,"gotoCurrent")&&e.currentDay?K:j,a=V?this.formatDate(a,s,this._getFormatConfig(e)):a,l=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",c=H?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(W?l:"")+(this._isInRange(e,s)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+a+"</button>":"")+(W?"":l)+"</div>":"",u=parseInt(this._get(e,"firstDay"),10),u=isNaN(u)?0:u,d=this._get(e,"showWeek"),h=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),g=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),w="",_=0;U[0]>_;_++){for(A="",this.maxRows=4,E=0;U[1]>E;E++){if(x=this._daylightSavingAdjust(new Date(ee,Z,e.selectedDay)),S=" ui-corner-all",T="",Q){if(T+="<div class='ui-datepicker-group",1<U[1])switch(E){case 0:T+=" ui-datepicker-group-first",S=" ui-corner-"+(W?"right":"left");break;case U[1]-1:T+=" ui-datepicker-group-last",S=" ui-corner-"+(W?"left":"right");break;default:T+=" ui-datepicker-group-middle",S=""}T+="'>"}for(T+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+S+"'>"+(/all|left/.test(S)&&0===_?W?r:n:"")+(/all|right/.test(S)&&0===_?W?n:r:"")+this._generateMonthYearHeader(e,Z,ee,X,J,0<_||0<E,f,g)+"</div><table class='ui-datepicker-calendar'><thead><tr>",D=d?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",C=0;C<7;C++)D+="<th scope='col'"+(5<=(C+u+6)%7?" class='ui-datepicker-week-end'":"")+"><span title='"+h[k=(C+u)%7]+"'>"+p[k]+"</span></th>";for(T+=D+"</tr></thead><tbody>",R=this._getDaysInMonth(ee,Z),ee===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,R)),O=(this._getFirstDayOfMonth(ee,Z)-u+7)%7,N=Math.ceil((O+R)/7),F=Q&&this.maxRows>N?this.maxRows:N,this.maxRows=F,M=this._daylightSavingAdjust(new Date(ee,Z,1-O)),P=0;P<F;P++){for(T+="<tr>",I=d?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(M)+"</td>":"",C=0;C<7;C++)L=m?m.apply(e.input?e.input[0]:null,[M]):[!0,""],$=(G=M.getMonth()!==Z)&&!y||!L[0]||X&&M<X||J&&J<M,I+="<td class='"+(5<=(C+u+6)%7?" ui-datepicker-week-end":"")+(G?" ui-datepicker-other-month":"")+(M.getTime()===x.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===M.getTime()&&b.getTime()===x.getTime()?" "+this._dayOverClass:"")+($?" "+this._unselectableClass+" ui-state-disabled":"")+(G&&!v?"":" "+L[1]+(M.getTime()===K.getTime()?" "+this._currentClass:"")+(M.getTime()===j.getTime()?" ui-datepicker-today":""))+"'"+(G&&!v||!L[2]?"":" title='"+L[2].replace(/'/g,"&#39;")+"'")+($?"":" data-handler='selectDay' data-event='click' data-month='"+M.getMonth()+"' data-year='"+M.getFullYear()+"'")+">"+(G&&!v?"&#xa0;":$?"<span class='ui-state-default'>"+M.getDate()+"</span>":"<a class='ui-state-default"+(M.getTime()===j.getTime()?" ui-state-highlight":"")+(M.getTime()===K.getTime()?" ui-state-active":"")+(G?" ui-priority-secondary":"")+"' href='#'>"+M.getDate()+"</a>")+"</td>",M.setDate(M.getDate()+1),M=this._daylightSavingAdjust(M);T+=I+"</tr>"}11<++Z&&(Z=0,ee++),A+=T+="</tbody></table>"+(Q?"</div>"+(0<U[0]&&E===U[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}w+=A}return w+=c,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,i,n,o,r,a,s){var l,c,u,d,h,p,f,g,m=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",w="";if(r||!m)w+="<span class='ui-datepicker-month'>"+a[t]+"</span>";else{for(l=n&&n.getFullYear()===i,c=o&&o.getFullYear()===i,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;u<12;u++)(!l||u>=n.getMonth())&&(!c||o.getMonth()>=u)&&(w+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+s[u]+"</option>");w+="</select>"}if(y||(b+=w+(!r&&m&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",r||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(d=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),f=(p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t})(d[0]),g=Math.max(f,p(d[1]||"")),f=n?Math.max(f,n.getFullYear()):f,g=o?Math.min(g,o.getFullYear()):g,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";f<=g;f++)e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),y&&(b+=(!r&&m&&v?"":"&#xa0;")+w),b+"</div>"},_adjustInstDate:function(e,t,i){var n=e.drawYear+("Y"===i?t:0),o=e.drawMonth+("M"===i?t:0),r=Math.min(e.selectedDay,this._getDaysInMonth(n,o))+("D"===i?t:0),a=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(n,o,r)));e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),"M"!==i&&"Y"!==i||this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),n=this._getMinMaxDate(e,"max"),o=i&&t<i?i:t;return n&&n<o?n:o},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,n){var o=this._getNumberOfMonths(e),r=this._daylightSavingAdjust(new Date(i,n+(t<0?t:o[0]*o[1]),1));return t<0&&r.setDate(this._getDaysInMonth(r.getFullYear(),r.getMonth())),this._isInRange(e,r)},_isInRange:function(e,t){var i,n,o=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),a=null,s=null,l=this._get(e,"yearRange");return l&&(i=l.split(":"),n=(new Date).getFullYear(),a=parseInt(i[0],10),s=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(a+=n),i[1].match(/[+\-].*/)&&(s+=n)),(!o||t.getTime()>=o.getTime())&&(!r||t.getTime()<=r.getTime())&&(!a||t.getFullYear()>=a)&&(!s||s>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return{shortYearCutoff:t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,n){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var o=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(n,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),o,this._getFormatConfig(e))}}),D.fn.datepicker=function(e){if(!this.length)return this;D.datepicker.initialized||(D(document).mousedown(D.datepicker._checkExternalClick),D.datepicker.initialized=!0),0===D("#"+D.datepicker._mainDivId).length&&D("body").append(D.datepicker.dpDiv);var t=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?D.datepicker["_"+e+"Datepicker"].apply(D.datepicker,[this[0]].concat(t)):this.each(function(){"string"==typeof e?D.datepicker["_"+e+"Datepicker"].apply(D.datepicker,[this].concat(t)):D.datepicker._attachDatepicker(this,e)}):D.datepicker["_"+e+"Datepicker"].apply(D.datepicker,[this[0]].concat(t))},D.datepicker=new e,D.datepicker.initialized=!1,D.datepicker.uuid=(new Date).getTime(),D.datepicker.version="1.11.1",D.datepicker,D.widget("ui.draggable",D.ui.mouse,{version:"1.11.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(e){var t=this.document[0],i=this.options;try{t.activeElement&&"body"!==t.activeElement.nodeName.toLowerCase()&&D(t.activeElement).blur()}catch(e){}return!(this.helper||i.disabled||0<D(e.target).closest(".ui-resizable-handle").length)&&(this.handle=this._getHandle(e),!!this.handle&&(D(!0===i.iframeFix?"iframe":i.iframeFix).each(function(){D("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(D(this).offset()).appendTo("body")}),!0))},_mouseStart:function(e){var t=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),D.ui.ddmanager&&(D.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,D.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,t.cursorAt&&this._adjustOffsetFromHelper(t.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),D.ui.ddmanager&&!t.dropBehaviour&&D.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),D.ui.ddmanager&&D.ui.ddmanager.dragStart(this,e),!0)},_mouseDrag:function(e,t){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!t){var i=this._uiHash();if(!1===this._trigger("drag",e,i))return this._mouseUp({}),!1;this.position=i.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",D.ui.ddmanager&&D.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var t=this,i=!1;return D.ui.ddmanager&&!this.options.dropBehaviour&&(i=D.ui.ddmanager.drop(this,e)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||!0===this.options.revert||D.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?D(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==t._trigger("stop",e)&&t._clear()}):!1!==this._trigger("stop",e)&&this._clear(),!1},_mouseUp:function(e){return D("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),D.ui.ddmanager&&D.ui.ddmanager.dragStop(this,e),this.element.focus(),D.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!D(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var t=this.options,i=D.isFunction(t.helper)?D(t.helper.apply(this.element[0],[e])):"clone"===t.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"===t.appendTo?this.element[0].parentNode:t.appendTo),i[0]===this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),D.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),t=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==t&&D.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,i,n=this.options,o=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?void(this.containment=[D(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,D(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,D(window).scrollLeft()+D(window).width()-this.helperProportions.width-this.margins.left,D(window).scrollTop()+(D(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===n.containment?void(this.containment=[0,0,D(o).width()-this.helperProportions.width-this.margins.left,(D(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):n.containment.constructor===Array?void(this.containment=n.containment):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),void((i=(t=D(n.containment))[0])&&(e="hidden"!==t.css("overflow"),this.containment=[(parseInt(t.css("borderLeftWidth"),10)||0)+(parseInt(t.css("paddingLeft"),10)||0),(parseInt(t.css("borderTopWidth"),10)||0)+(parseInt(t.css("paddingTop"),10)||0),(e?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(t.css("borderRightWidth"),10)||0)-(parseInt(t.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(t.css("borderBottomWidth"),10)||0)-(parseInt(t.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=t))):void(this.containment=null)},_convertPositionTo:function(e,t){t=t||this.position;var i="absolute"===e?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,n,o,r,a=this.options,s=this._isRootNode(this.scrollParent[0]),l=e.pageX,c=e.pageY;return s&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(i=this.relativeContainer?(n=this.relativeContainer.offset(),[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):this.containment,e.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(c=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(c=i[3]+this.offset.click.top)),a.grid&&(o=a.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,c=i?o-this.offset.click.top>=i[1]||o-this.offset.click.top>i[3]?o:o-this.offset.click.top>=i[1]?o-a.grid[1]:o+a.grid[1]:o,r=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=i?r-this.offset.click.left>=i[0]||r-this.offset.click.left>i[2]?r:r-this.offset.click.left>=i[0]?r-a.grid[0]:r+a.grid[0]:r),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(e,t,i){return i=i||this._uiHash(),D.ui.plugin.call(this,e,[t,i,this],!0),"drag"===e&&(this.positionAbs=this._convertPositionTo("absolute")),D.Widget.prototype._trigger.call(this,e,t,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),D.ui.plugin.add("draggable","connectToSortable",{start:function(t,e,i){var n=i.options,o=D.extend({},e,{item:i.element});i.sortables=[],D(n.connectToSortable).each(function(){var e=D(this).sortable("instance");e&&!e.options.disabled&&(i.sortables.push({instance:e,shouldRevert:e.options.revert}),e.refreshPositions(),e._trigger("activate",t,o))})},stop:function(e,t,i){var n=D.extend({},t,{item:i.element});D.each(i.sortables,function(){this.instance.isOver?(this.instance.isOver=0,i.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(e),this.instance.options.helper=this.instance.options._helper,"original"===i.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",e,n))})},drag:function(i,n,o){var r=this;D.each(o.sortables,function(){var e=!1,t=this;this.instance.positionAbs=o.positionAbs,this.instance.helperProportions=o.helperProportions,this.instance.offset.click=o.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(e=!0,D.each(o.sortables,function(){return this.instance.positionAbs=o.positionAbs,this.instance.helperProportions=o.helperProportions,this.instance.offset.click=o.offset.click,this!==t&&this.instance._intersectsWith(this.instance.containerCache)&&D.contains(t.instance.element[0],this.instance.element[0])&&(e=!1),e})),e?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=D(r).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},i.target=this.instance.currentItem[0],this.instance._mouseCapture(i,!0),this.instance._mouseStart(i,!0,!0),this.instance.offset.click.top=o.offset.click.top,this.instance.offset.click.left=o.offset.click.left,this.instance.offset.parent.left-=o.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=o.offset.parent.top-this.instance.offset.parent.top,o._trigger("toSortable",i),o.dropped=this.instance.element,o.currentItem=o.element,this.instance.fromOutside=o),this.instance.currentItem&&this.instance._mouseDrag(i)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",i,this.instance._uiHash(this.instance)),this.instance._mouseStop(i,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),o._trigger("fromSortable",i),o.dropped=!1)})}}),D.ui.plugin.add("draggable","cursor",{start:function(e,t,i){var n=D("body"),o=i.options;n.css("cursor")&&(o._cursor=n.css("cursor")),n.css("cursor",o.cursor)},stop:function(e,t,i){var n=i.options;n._cursor&&D("body").css("cursor",n._cursor)}}),D.ui.plugin.add("draggable","opacity",{start:function(e,t,i){var n=D(t.helper),o=i.options;n.css("opacity")&&(o._opacity=n.css("opacity")),n.css("opacity",o.opacity)},stop:function(e,t,i){var n=i.options;n._opacity&&D(t.helper).css("opacity",n._opacity)}}),D.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,t,i){var n=i.options,o=!1,r=i.scrollParentNotHidden[0],a=i.document[0];r!==a&&"HTML"!==r.tagName?(n.axis&&"x"===n.axis||(i.overflowOffset.top+r.offsetHeight-e.pageY<n.scrollSensitivity?r.scrollTop=o=r.scrollTop+n.scrollSpeed:e.pageY-i.overflowOffset.top<n.scrollSensitivity&&(r.scrollTop=o=r.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(i.overflowOffset.left+r.offsetWidth-e.pageX<n.scrollSensitivity?r.scrollLeft=o=r.scrollLeft+n.scrollSpeed:e.pageX-i.overflowOffset.left<n.scrollSensitivity&&(r.scrollLeft=o=r.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(e.pageY-D(a).scrollTop()<n.scrollSensitivity?o=D(a).scrollTop(D(a).scrollTop()-n.scrollSpeed):D(window).height()-(e.pageY-D(a).scrollTop())<n.scrollSensitivity&&(o=D(a).scrollTop(D(a).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(e.pageX-D(a).scrollLeft()<n.scrollSensitivity?o=D(a).scrollLeft(D(a).scrollLeft()-n.scrollSpeed):D(window).width()-(e.pageX-D(a).scrollLeft())<n.scrollSensitivity&&(o=D(a).scrollLeft(D(a).scrollLeft()+n.scrollSpeed)))),!1!==o&&D.ui.ddmanager&&!n.dropBehaviour&&D.ui.ddmanager.prepareOffsets(i,e)}}),D.ui.plugin.add("draggable","snap",{start:function(e,t,i){var n=i.options;i.snapElements=[],D(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var e=D(this),t=e.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:t.top,left:t.left})})},drag:function(e,t,i){var n,o,r,a,s,l,c,u,d,h,p=i.options,f=p.snapTolerance,g=t.offset.left,m=g+i.helperProportions.width,v=t.offset.top,y=v+i.helperProportions.height;for(d=i.snapElements.length-1;0<=d;d--)l=(s=i.snapElements[d].left)+i.snapElements[d].width,u=(c=i.snapElements[d].top)+i.snapElements[d].height,m<s-f||l+f<g||y<c-f||u+f<v||!D.contains(i.snapElements[d].item.ownerDocument,i.snapElements[d].item)?(i.snapElements[d].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,e,D.extend(i._uiHash(),{snapItem:i.snapElements[d].item})),i.snapElements[d].snapping=!1):("inner"!==p.snapMode&&(n=f>=Math.abs(c-y),o=f>=Math.abs(u-v),r=f>=Math.abs(s-m),a=f>=Math.abs(l-g),n&&(t.position.top=i._convertPositionTo("relative",{top:c-i.helperProportions.height,left:0}).top-i.margins.top),o&&(t.position.top=i._convertPositionTo("relative",{top:u,left:0}).top-i.margins.top),r&&(t.position.left=i._convertPositionTo("relative",{top:0,left:s-i.helperProportions.width}).left-i.margins.left),a&&(t.position.left=i._convertPositionTo("relative",{top:0,left:l}).left-i.margins.left)),h=n||o||r||a,"outer"!==p.snapMode&&(n=f>=Math.abs(c-v),o=f>=Math.abs(u-y),r=f>=Math.abs(s-g),a=f>=Math.abs(l-m),n&&(t.position.top=i._convertPositionTo("relative",{top:c,left:0}).top-i.margins.top),o&&(t.position.top=i._convertPositionTo("relative",{top:u-i.helperProportions.height,left:0}).top-i.margins.top),r&&(t.position.left=i._convertPositionTo("relative",{top:0,left:s}).left-i.margins.left),a&&(t.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left-i.margins.left)),!i.snapElements[d].snapping&&(n||o||r||a||h)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,e,D.extend(i._uiHash(),{snapItem:i.snapElements[d].item})),i.snapElements[d].snapping=n||o||r||a||h)}}),D.ui.plugin.add("draggable","stack",{start:function(e,t,i){var n,o=i.options,r=D.makeArray(D(o.stack)).sort(function(e,t){return(parseInt(D(e).css("zIndex"),10)||0)-(parseInt(D(t).css("zIndex"),10)||0)});r.length&&(n=parseInt(D(r[0]).css("zIndex"),10)||0,D(r).each(function(e){D(this).css("zIndex",n+e)}),this.css("zIndex",n+r.length))}}),D.ui.plugin.add("draggable","zIndex",{start:function(e,t,i){var n=D(t.helper),o=i.options;n.css("zIndex")&&(o._zIndex=n.css("zIndex")),n.css("zIndex",o.zIndex)},stop:function(e,t,i){var n=i.options;n._zIndex&&D(t.helper).css("zIndex",n._zIndex)}}),D.ui.draggable,D.widget("ui.resizable",D.ui.mouse,{version:"1.11.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(e,t){if("hidden"===D(e).css("overflow"))return!1;var i=t&&"left"===t?"scrollLeft":"scrollTop",n=!1;return 0<e[i]||(e[i]=1,n=0<e[i],e[i]=0,n)},_create:function(){var e,t,i,n,o=this,r=this.options;if(this.element.addClass("ui-resizable"),D.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(D("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=r.handles||(D(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),e=this.handles.split(","),this.handles={},t=0;e.length>t;t++)i=D.trim(e[t]),(n=D("<div class='ui-resizable-handle "+("ui-resizable-"+i)+"'></div>")).css({zIndex:r.zIndex}),"se"===i&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[i]=".ui-resizable-"+i,this.element.append(n);this._renderAxis=function(e){var t,i,n,o;for(t in e=e||this.element,this.handles)this.handles[t].constructor===String&&(this.handles[t]=this.element.children(this.handles[t]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(i=D(this.handles[t],this.element),o=/sw|ne|nw|se|n|s/.test(t)?i.outerHeight():i.outerWidth(),n=["padding",/ne|nw|n/.test(t)?"Top":/se|sw|s/.test(t)?"Bottom":/^e$/.test(t)?"Right":"Left"].join(""),e.css(n,o),this._proportionallyResize()),D(this.handles[t]).length},this._renderAxis(this.element),this._handles=D(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=n&&n[1]?n[1]:"se")}),r.autoHide&&(this._handles.hide(),D(this.element).addClass("ui-resizable-autohide").mouseenter(function(){r.disabled||(D(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){r.disabled||o.resizing||(D(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();function e(e){D(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()}var t;return this.elementIsWrapper&&(e(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),e(this.originalElement),this},_mouseCapture:function(e){var t,i,n=!1;for(t in this.handles)(i=D(this.handles[t])[0])!==e.target&&!D.contains(i,e.target)||(n=!0);return!this.options.disabled&&n},_mouseStart:function(e){var t,i,n,o=this.options,r=this.element;return this.resizing=!0,this._renderProxy(),t=this._num(this.helper.css("left")),i=this._num(this.helper.css("top")),o.containment&&(t+=D(o.containment).scrollLeft()||0,i+=D(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:t,top:i},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:r.width(),height:r.height()},this.originalSize=this._helper?{width:r.outerWidth(),height:r.outerHeight()}:{width:r.width(),height:r.height()},this.sizeDiff={width:r.outerWidth()-r.width(),height:r.outerHeight()-r.height()},this.originalPosition={left:t,top:i},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=D(".ui-resizable-"+this.axis).css("cursor"),D("body").css("cursor","auto"===n?this.axis+"-resize":n),r.addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var t,i,n=this.originalMousePosition,o=this.axis,r=e.pageX-n.left||0,a=e.pageY-n.top||0,s=this._change[o];return this._updatePrevProperties(),s&&(t=s.apply(this,[e,r,a]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(t=this._updateRatio(t,e)),t=this._respectSize(t,e),this._updateCache(t),this._propagate("resize",e),i=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),D.isEmptyObject(i)||(this._updatePrevProperties(),this._trigger("resize",e,this.ui()),this._applyChanges())),!1},_mouseStop:function(e){this.resizing=!1;var t,i,n,o,r,a,s,l=this.options,c=this;return this._helper&&(n=(i=(t=this._proportionallyResizeElements).length&&/textarea/i.test(t[0].nodeName))&&this._hasScroll(t[0],"left")?0:c.sizeDiff.height,o=i?0:c.sizeDiff.width,r={width:c.helper.width()-o,height:c.helper.height()-n},a=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,s=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null,l.animate||this.element.css(D.extend(r,{top:s,left:a})),c.helper.height(c.size.height),c.helper.width(c.size.width),this._helper&&!l.animate&&this._proportionallyResize()),D("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,i,n,o,r,a=this.options;r={minWidth:this._isNumber(a.minWidth)?a.minWidth:0,maxWidth:this._isNumber(a.maxWidth)?a.maxWidth:1/0,minHeight:this._isNumber(a.minHeight)?a.minHeight:0,maxHeight:this._isNumber(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||e)&&(t=r.minHeight*this.aspectRatio,n=r.minWidth/this.aspectRatio,i=r.maxHeight*this.aspectRatio,o=r.maxWidth/this.aspectRatio,t>r.minWidth&&(r.minWidth=t),n>r.minHeight&&(r.minHeight=n),r.maxWidth>i&&(r.maxWidth=i),r.maxHeight>o&&(r.maxHeight=o)),this._vBoundaries=r},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,i=this.size,n=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===n&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"===n&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,n=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,o=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,r=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,a=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,s=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,c=/sw|nw|w/.test(i),u=/nw|ne|n/.test(i);return r&&(e.width=t.minWidth),a&&(e.height=t.minHeight),n&&(e.width=t.maxWidth),o&&(e.height=t.maxHeight),r&&c&&(e.left=s-t.minWidth),n&&c&&(e.left=s-t.maxWidth),a&&u&&(e.top=l-t.minHeight),o&&u&&(e.top=l-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,i=[],n=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],o=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];t<4;t++)i[t]=parseInt(n[t],10)||0,i[t]+=parseInt(o[t],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,i=this.helper||this.element;this._proportionallyResizeElements.length>t;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,t=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||D("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++t.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize;return{left:this.originalPosition.left+t,width:i.width-t}},n:function(e,t,i){var n=this.originalSize;return{top:this.originalPosition.top+i,height:n.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(e,t,i){return D.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,t,i]))},sw:function(e,t,i){return D.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,t,i]))},ne:function(e,t,i){return D.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,t,i]))},nw:function(e,t,i){return D.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,t,i]))}},_propagate:function(e,t){D.ui.plugin.call(this,e,[t,this.ui()]),"resize"!==e&&this._trigger(e,t,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),D.ui.plugin.add("resizable","animate",{stop:function(t){var i=D(this).resizable("instance"),e=i.options,n=i._proportionallyResizeElements,o=n.length&&/textarea/i.test(n[0].nodeName),r=o&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,a=o?0:i.sizeDiff.width,s={width:i.size.width-a,height:i.size.height-r},l=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,c=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(D.extend(s,c&&l?{top:c,left:l}:{}),{duration:e.animateDuration,easing:e.animateEasing,step:function(){var e={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};n&&n.length&&D(n[0]).css({width:e.width,height:e.height}),i._updateCache(e),i._propagate("resize",t)}})}}),D.ui.plugin.add("resizable","containment",{start:function(){var i,n,e,t,o,r,a,s=D(this).resizable("instance"),l=s.options,c=s.element,u=l.containment,d=u instanceof D?u.get(0):/parent/.test(u)?c.parent().get(0):u;d&&(s.containerElement=D(d),/document/.test(u)||u===document?(s.containerOffset={left:0,top:0},s.containerPosition={left:0,top:0},s.parentData={element:D(document),left:0,top:0,width:D(document).width(),height:D(document).height()||document.body.parentNode.scrollHeight}):(i=D(d),n=[],D(["Top","Right","Left","Bottom"]).each(function(e,t){n[e]=s._num(i.css("padding"+t))}),s.containerOffset=i.offset(),s.containerPosition=i.position(),s.containerSize={height:i.innerHeight()-n[3],width:i.innerWidth()-n[1]},e=s.containerOffset,t=s.containerSize.height,o=s.containerSize.width,r=s._hasScroll(d,"left")?d.scrollWidth:o,a=s._hasScroll(d)?d.scrollHeight:t,s.parentData={element:d,left:e.left,top:e.top,width:r,height:a}))},resize:function(e){var t,i,n,o,r=D(this).resizable("instance"),a=r.options,s=r.containerOffset,l=r.position,c=r._aspectRatio||e.shiftKey,u={top:0,left:0},d=r.containerElement,h=!0;d[0]!==document&&/static/.test(d.css("position"))&&(u=s),l.left<(r._helper?s.left:0)&&(r.size.width=r.size.width+(r._helper?r.position.left-s.left:r.position.left-u.left),c&&(r.size.height=r.size.width/r.aspectRatio,h=!1),r.position.left=a.helper?s.left:0),l.top<(r._helper?s.top:0)&&(r.size.height=r.size.height+(r._helper?r.position.top-s.top:r.position.top),c&&(r.size.width=r.size.height*r.aspectRatio,h=!1),r.position.top=r._helper?s.top:0),n=r.containerElement.get(0)===r.element.parent().get(0),o=/relative|absolute/.test(r.containerElement.css("position")),n&&o?(r.offset.left=r.parentData.left+r.position.left,r.offset.top=r.parentData.top+r.position.top):(r.offset.left=r.element.offset().left,r.offset.top=r.element.offset().top),t=Math.abs(r.sizeDiff.width+(r._helper?r.offset.left-u.left:r.offset.left-s.left)),i=Math.abs(r.sizeDiff.height+(r._helper?r.offset.top-u.top:r.offset.top-s.top)),t+r.size.width>=r.parentData.width&&(r.size.width=r.parentData.width-t,c&&(r.size.height=r.size.width/r.aspectRatio,h=!1)),i+r.size.height>=r.parentData.height&&(r.size.height=r.parentData.height-i,c&&(r.size.width=r.size.height*r.aspectRatio,h=!1)),h||(r.position.left=r.prevPosition.left,r.position.top=r.prevPosition.top,r.size.width=r.prevSize.width,r.size.height=r.prevSize.height)},stop:function(){var e=D(this).resizable("instance"),t=e.options,i=e.containerOffset,n=e.containerPosition,o=e.containerElement,r=D(e.helper),a=r.offset(),s=r.outerWidth()-e.sizeDiff.width,l=r.outerHeight()-e.sizeDiff.height;e._helper&&!t.animate&&/relative/.test(o.css("position"))&&D(this).css({left:a.left-n.left-i.left,width:s,height:l}),e._helper&&!t.animate&&/static/.test(o.css("position"))&&D(this).css({left:a.left-n.left-i.left,width:s,height:l})}}),D.ui.plugin.add("resizable","alsoResize",{start:function(){function t(e){D(e).each(function(){var e=D(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})}var e=D(this).resizable("instance").options;"object"!=typeof e.alsoResize||e.alsoResize.parentNode?t(e.alsoResize):e.alsoResize.length?(e.alsoResize=e.alsoResize[0],t(e.alsoResize)):D.each(e.alsoResize,function(e){t(e)})},resize:function(e,r){function i(e,i){D(e).each(function(){var e=D(this),n=D(this).data("ui-resizable-alsoresize"),o={},t=i&&i.length?i:e.parents(r.originalElement[0]).length?["width","height"]:["width","height","top","left"];D.each(t,function(e,t){var i=(n[t]||0)+(s[t]||0);i&&0<=i&&(o[t]=i||null)}),e.css(o)})}var t=D(this).resizable("instance"),n=t.options,o=t.originalSize,a=t.originalPosition,s={height:t.size.height-o.height||0,width:t.size.width-o.width||0,top:t.position.top-a.top||0,left:t.position.left-a.left||0};"object"!=typeof n.alsoResize||n.alsoResize.nodeType?i(n.alsoResize):D.each(n.alsoResize,function(e,t){i(e,t)})},stop:function(){D(this).removeData("resizable-alsoresize")}}),D.ui.plugin.add("resizable","ghost",{start:function(){var e=D(this).resizable("instance"),t=e.options,i=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof t.ghost?t.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){var e=D(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=D(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),D.ui.plugin.add("resizable","grid",{resize:function(){var e,t=D(this).resizable("instance"),i=t.options,n=t.size,o=t.originalSize,r=t.originalPosition,a=t.axis,s="number"==typeof i.grid?[i.grid,i.grid]:i.grid,l=s[0]||1,c=s[1]||1,u=Math.round((n.width-o.width)/l)*l,d=Math.round((n.height-o.height)/c)*c,h=o.width+u,p=o.height+d,f=i.maxWidth&&h>i.maxWidth,g=i.maxHeight&&p>i.maxHeight,m=i.minWidth&&i.minWidth>h,v=i.minHeight&&i.minHeight>p;i.grid=s,m&&(h+=l),v&&(p+=c),f&&(h-=l),g&&(p-=c),/^(se|s|e)$/.test(a)?(t.size.width=h,t.size.height=p):/^(ne)$/.test(a)?(t.size.width=h,t.size.height=p,t.position.top=r.top-d):/^(sw)$/.test(a)?(t.size.width=h,t.size.height=p,t.position.left=r.left-u):((p-c<=0||h-l<=0)&&(e=t._getPaddingPlusBorderDimensions(this)),0<p-c?(t.size.height=p,t.position.top=r.top-d):(p=c-e.height,t.size.height=p,t.position.top=r.top+o.height-p),0<h-l?(t.size.width=h,t.position.left=r.left-u):(h=c-e.height,t.size.width=h,t.position.left=r.left+o.width-h))}}),D.ui.resizable,D.widget("ui.dialog",{version:"1.11.1",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var t=D(this).css(e).offset().top;t<0&&D(this).css("top",e.top-t)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&D.fn.draggable&&this._makeDraggable(),this.options.resizable&&D.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?D(e):this.document.find(e||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(e=t.parent.children().eq(t.index)).length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:D.noop,enable:D.noop,close:function(e){var t,i=this;if(this._isOpen&&!1!==this._trigger("beforeClose",e)){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{(t=this.document[0].activeElement)&&"body"!==t.nodeName.toLowerCase()&&D(t).blur()}catch(e){}this._hide(this.uiDialog,this.options.hide,function(){i._trigger("close",e)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,t){var i=!1,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+D(this).css("z-index")}).get(),o=Math.max.apply(null,n);return o>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",o+1),i=!0),i&&!t&&this._trigger("focus",e),i},open:function(){var e=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=D(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable(),e._trigger("focus")}),this._makeFocusTarget(),void this._trigger("open"))},_focusTabbable:function(){var e=this._focusedElement;(e=e||this.element.find("[autofocus]")).length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(e){function t(){var e=this.document[0].activeElement;this.uiDialog[0]===e||D.contains(this.uiDialog[0],e)||this._focusTabbable()}e.preventDefault(),t.call(this),this._delay(t)},_createWrapper:function(){this.uiDialog=D("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===D.ui.keyCode.ESCAPE)return e.preventDefault(),void this.close(e);if(e.keyCode===D.ui.keyCode.TAB&&!e.isDefaultPrevented()){var t=this.uiDialog.find(":tabbable"),i=t.filter(":first"),n=t.filter(":last");e.target!==n[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==i[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(this._delay(function(){n.focus()}),e.preventDefault()):(this._delay(function(){i.focus()}),e.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=D("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(e){D(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=D("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),e=D("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(e),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=D("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=D("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var o=this,e=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),D.isEmptyObject(e)||D.isArray(e)&&!e.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(D.each(e,function(e,t){var i,n;t=D.isFunction(t)?{click:t,text:e}:t,t=D.extend({type:"button"},t),i=t.click,t.click=function(){i.apply(o.element[0],arguments)},n={icons:t.icons,text:t.showText},delete t.icons,delete t.showText,D("<button></button>",t).button(n).appendTo(o.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function o(e){return{position:e.position,offset:e.offset}}var r=this,a=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(e,t){D(this).addClass("ui-dialog-dragging"),r._blockFrames(),r._trigger("dragStart",e,o(t))},drag:function(e,t){r._trigger("drag",e,o(t))},stop:function(e,t){var i=t.offset.left-r.document.scrollLeft(),n=t.offset.top-r.document.scrollTop();a.position={my:"left top",at:"left"+(0<=i?"+":"")+i+" top"+(0<=n?"+":"")+n,of:r.window},D(this).removeClass("ui-dialog-dragging"),r._unblockFrames(),r._trigger("dragStop",e,o(t))}})},_makeResizable:function(){function r(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var a=this,s=this.options,e=s.resizable,t=this.uiDialog.css("position"),i="string"==typeof e?e:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:i,start:function(e,t){D(this).addClass("ui-dialog-resizing"),a._blockFrames(),a._trigger("resizeStart",e,r(t))},resize:function(e,t){a._trigger("resize",e,r(t))},stop:function(e,t){var i=a.uiDialog.offset(),n=i.left-a.document.scrollLeft(),o=i.top-a.document.scrollTop();s.height=a.uiDialog.height(),s.width=a.uiDialog.width(),s.position={my:"left top",at:"left"+(0<=n?"+":"")+n+" top"+(0<=o?"+":"")+o,of:a.window},D(this).removeClass("ui-dialog-resizing"),a._unblockFrames(),a._trigger("resizeStop",e,r(t))}}).css("position",t)},_trackFocus:function(){this._on(this.widget(),{focusin:function(e){this._makeFocusTarget(),this._focusedElement=D(e.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),t=D.inArray(this,e);-1!==t&&e.splice(t,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(e){var i=this,n=!1,o={};D.each(e,function(e,t){i._setOption(e,t),e in i.sizeRelatedOptions&&(n=!0),e in i.resizableRelatedOptions&&(o[e]=t)}),n&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",o)},_setOption:function(e,t){var i,n,o=this.uiDialog;"dialogClass"===e&&o.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&((i=o.is(":data(ui-draggable)"))&&!t&&o.draggable("destroy"),!i&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&((n=o.is(":data(ui-resizable)"))&&!t&&o.resizable("destroy"),n&&"string"==typeof t&&o.resizable("option","handles",t),n||!1===t||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),e=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),t=Math.max(0,n.minHeight-e),i="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-e):"none","auto"===n.height?this.element.css({minHeight:t,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,n.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=D(this);return D("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return!!D(e.target).closest(".ui-dialog").length||!!D(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=D("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),D.widget("ui.droppable",{version:"1.11.1",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,t=this.options,i=t.accept;this.isover=!1,this.isout=!0,this.accept=D.isFunction(i)?i:function(e){return e.is(i)},this.proportions=function(){return arguments.length?void(e=arguments[0]):e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight})},this._addToManager(t.scope),t.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(e){D.ui.ddmanager.droppables[e]=D.ui.ddmanager.droppables[e]||[],D.ui.ddmanager.droppables[e].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var e=D.ui.ddmanager.droppables[this.options.scope];this._splice(e),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,t){if("accept"===e)this.accept=D.isFunction(t)?t:function(e){return e.is(t)};else if("scope"===e){var i=D.ui.ddmanager.droppables[this.options.scope];this._splice(i),this._addToManager(t)}this._super(e,t)},_activate:function(e){var t=D.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),t&&this._trigger("activate",e,this.ui(t))},_deactivate:function(e){var t=D.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),t&&this._trigger("deactivate",e,this.ui(t))},_over:function(e){var t=D.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(t)))},_out:function(e){var t=D.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(t)))},_drop:function(t,e){var i=e||D.ui.ddmanager.current,n=!1;return!(!i||(i.currentItem||i.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var e=D(this).droppable("instance");return e.options.greedy&&!e.options.disabled&&e.options.scope===i.options.scope&&e.accept.call(e.element[0],i.currentItem||i.element)&&D.ui.intersect(i,D.extend(e,{offset:e.element.offset()}),e.options.tolerance,t)?!(n=!0):void 0}),!n&&(!!this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(i)),this.element)))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),D.ui.intersect=function(e,t,i,n){if(!t.offset)return!1;var o=(e.positionAbs||e.position.absolute).left,r=(e.positionAbs||e.position.absolute).top,a=o+e.helperProportions.width,s=r+e.helperProportions.height,l=t.offset.left,c=t.offset.top,u=l+t.proportions().width,d=c+t.proportions().height;switch(i){case"fit":return l<=o&&a<=u&&c<=r&&s<=d;case"intersect":return o+e.helperProportions.width/2>l&&u>a-e.helperProportions.width/2&&r+e.helperProportions.height/2>c&&d>s-e.helperProportions.height/2;case"pointer":return C(n.pageY,c,t.proportions().height)&&C(n.pageX,l,t.proportions().width);case"touch":return(c<=r&&r<=d||c<=s&&s<=d||r<c&&d<s)&&(l<=o&&o<=u||l<=a&&a<=u||o<l&&u<a);default:return!1}},D.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,t){var i,n,o=D.ui.ddmanager.droppables[e.options.scope]||[],r=t?t.type:null,a=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();e:for(i=0;o.length>i;i++)if(!(o[i].options.disabled||e&&!o[i].accept.call(o[i].element[0],e.currentItem||e.element))){for(n=0;a.length>n;n++)if(a[n]===o[i].element[0]){o[i].proportions().height=0;continue e}o[i].visible="none"!==o[i].element.css("display"),o[i].visible&&("mousedown"===r&&o[i]._activate.call(o[i],t),o[i].offset=o[i].element.offset(),o[i].proportions({width:o[i].element[0].offsetWidth,height:o[i].element[0].offsetHeight}))}},drop:function(e,t){var i=!1;return D.each((D.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&D.ui.intersect(e,this,this.options.tolerance,t)&&(i=this._drop.call(this,t)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,t)))}),i},dragStart:function(e,t){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||D.ui.ddmanager.prepareOffsets(e,t)})},drag:function(r,a){r.options.refreshPositions&&D.ui.ddmanager.prepareOffsets(r,a),D.each(D.ui.ddmanager.droppables[r.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var e,t,i,n=D.ui.intersect(r,this,this.options.tolerance,a),o=!n&&this.isover?"isout":n&&!this.isover?"isover":null;o&&(this.options.greedy&&(t=this.options.scope,(i=this.element.parents(":data(ui-droppable)").filter(function(){return D(this).droppable("instance").options.scope===t})).length&&((e=D(i[0]).droppable("instance")).greedyChild="isover"===o)),e&&"isover"===o&&(e.isover=!1,e.isout=!0,e._out.call(e,a)),this[o]=!0,this["isout"===o?"isover":"isout"]=!1,this["isover"===o?"_over":"_out"].call(this,a),e&&"isout"===o&&(e.isout=!1,e.isover=!0,e._over.call(e,a)))}})},dragStop:function(e,t){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||D.ui.ddmanager.prepareOffsets(e,t)}},D.ui.droppable;var _,A,E,x,S,T,k,R,O,N,F,M,P,I,L,G,$,B,j,W,H,z="ui-effects-",V=D;function U(e,t,i,n){return D.isPlainObject(e)&&(e=(t=e).effect),e={effect:e},null==t&&(t={}),D.isFunction(t)&&(n=t,i=null,t={}),"number"!=typeof t&&!D.fx.speeds[t]||(n=i,i=t,t={}),D.isFunction(i)&&(n=i,i=null),t&&D.extend(e,t),i=i||t.duration,e.duration=D.fx.off?0:"number"==typeof i?i:i in D.fx.speeds?D.fx.speeds[i]:D.fx.speeds._default,e.complete=n||t.complete,e}function Y(e){return!(e&&"number"!=typeof e&&!D.fx.speeds[e])||("string"==typeof e&&!D.effects.effect[e]||(!!D.isFunction(e)||"object"==typeof e&&!e.effect))}function q(e){var t,i,n=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,o={};if(n&&n.length&&n[0]&&n[n[0]])for(i=n.length;i--;)"string"==typeof n[t=n[i]]&&(o[D.camelCase(t)]=n[t]);else for(t in n)"string"==typeof n[t]&&(o[t]=n[t]);return o}function Q(e,t,i){var n=B[t.type]||{};return null==e?i||!t.def?null:t.def:(e=n.floor?~~e:parseFloat(e),isNaN(e)?t.def:n.mod?(e+n.mod)%n.mod:e<0?0:e>n.max?n.max:e)}function K(a){var s=G(),l=s._rgba=[];return a=a.toLowerCase(),H(L,function(e,t){var i,n=t.re.exec(a),o=n&&t.parse(n),r=t.space||"rgba";return o?(i=s[r](o),s[$[r].cache]=i[$[r].cache],l=s._rgba=i._rgba,!1):M}),l.length?("0,0,0,0"===l.join()&&F.extend(l,P.transparent),s):P[a]}function X(e,t,i){return 6*(i=(i+1)%1)<1?e+6*(t-e)*i:2*i<1?t:3*i<2?e+6*(t-e)*(2/3-i):e}D.effects={effect:{}},I=/^([\-+])=\s*(\d+\.?\d*)/,L=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],G=(F=V).Color=function(e,t,i,n){return new F.Color.fn.parse(e,t,i,n)},$={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},B={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},j=G.support={},W=F("<p>")[0],H=F.each,W.style.cssText="background-color:rgba(1,1,1,.5)",j.rgba=-1<W.style.backgroundColor.indexOf("rgba"),H($,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),G.fn=F.extend(G.prototype,{parse:function(o,e,t,i){if(o===M)return this._rgba=[null,null,null,null],this;(o.jquery||o.nodeType)&&(o=F(o).css(e),e=M);var r=this,n=F.type(o),a=this._rgba=[];return e!==M&&(o=[o,e,t,i],n="array"),"string"===n?this.parse(K(o)||P._default):"array"===n?(H($.rgba.props,function(e,t){a[t.idx]=Q(o[t.idx],t)}),this):"object"===n?(H($,o instanceof G?function(e,t){o[t.cache]&&(r[t.cache]=o[t.cache].slice())}:function(e,i){var n=i.cache;H(i.props,function(e,t){if(!r[n]&&i.to){if("alpha"===e||null==o[e])return;r[n]=i.to(r._rgba)}r[n][t.idx]=Q(o[e],t,!0)}),r[n]&&F.inArray(null,r[n].slice(0,3))<0&&(r[n][3]=1,i.from&&(r._rgba=i.from(r[n])))}),this):M},is:function(e){var o=G(e),r=!0,a=this;return H($,function(e,t){var i,n=o[t.cache];return n&&(i=a[t.cache]||t.to&&t.to(a._rgba)||[],H(t.props,function(e,t){return null!=n[t.idx]?r=n[t.idx]===i[t.idx]:M})),r}),r},_space:function(){var i=[],n=this;return H($,function(e,t){n[t.cache]&&i.push(e)}),i.pop()},transition:function(e,a){var s=G(e),t=s._space(),i=$[t],n=0===this.alpha()?G("transparent"):this,l=n[i.cache]||i.to(n._rgba),c=l.slice();return s=s[i.cache],H(i.props,function(e,t){var i=t.idx,n=l[i],o=s[i],r=B[t.type]||{};null!==o&&(null===n?c[i]=o:(r.mod&&(o-n>r.mod/2?n+=r.mod:n-o>r.mod/2&&(n-=r.mod)),c[i]=Q((o-n)*a+n,t)))}),this[t](c)},blend:function(e){if(1===this._rgba[3])return this;var t=this._rgba.slice(),i=t.pop(),n=G(e)._rgba;return G(F.map(t,function(e,t){return(1-i)*n[t]+i*e}))},toRgbaString:function(){var e="rgba(",t=F.map(this._rgba,function(e,t){return null==e?2<t?1:0:e});return 1===t[3]&&(t.pop(),e="rgb("),e+t.join()+")"},toHslaString:function(){var e="hsla(",t=F.map(this.hsla(),function(e,t){return null==e&&(e=2<t?1:0),t&&t<3&&(e=Math.round(100*e)+"%"),e});return 1===t[3]&&(t.pop(),e="hsl("),e+t.join()+")"},toHexString:function(e){var t=this._rgba.slice(),i=t.pop();return e&&t.push(~~(255*i)),"#"+F.map(t,function(e){return 1===(e=(e||0).toString(16)).length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),G.fn.parse.prototype=G.fn,$.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,n=e[0]/255,o=e[1]/255,r=e[2]/255,a=e[3],s=Math.max(n,o,r),l=Math.min(n,o,r),c=s-l,u=s+l,d=.5*u;return t=l===s?0:n===s?60*(o-r)/c+360:o===s?60*(r-n)/c+120:60*(n-o)/c+240,i=0==c?0:d<=.5?c/u:c/(2-u),[Math.round(t)%360,i,d,null==a?1:a]},$.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],n=e[2],o=e[3],r=n<=.5?n*(1+i):n+i-n*i,a=2*n-r;return[Math.round(255*X(a,r,t+1/3)),Math.round(255*X(a,r,t)),Math.round(255*X(a,r,t-1/3)),o]},H($,function(l,e){var i=e.props,a=e.cache,s=e.to,c=e.from;G.fn[l]=function(e){if(s&&!this[a]&&(this[a]=s(this._rgba)),e===M)return this[a].slice();var t,n=F.type(e),o="array"===n||"object"===n?e:arguments,r=this[a].slice();return H(i,function(e,t){var i=o["object"===n?e:t.idx];null==i&&(i=r[t.idx]),r[t.idx]=Q(i,t)}),c?((t=G(c(r)))[a]=r,t):G(r)},H(i,function(a,s){G.fn[a]||(G.fn[a]=function(e){var t,i=F.type(e),n="alpha"===a?this._hsla?"hsla":"rgba":l,o=this[n](),r=o[s.idx];return"undefined"===i?r:("function"===i&&(e=e.call(this,r),i=F.type(e)),null==e&&s.empty?this:("string"===i&&(t=I.exec(e))&&(e=r+parseFloat(t[2])*("+"===t[1]?1:-1)),o[s.idx]=e,this[n](o)))})})}),G.hook=function(e){var t=e.split(" ");H(t,function(e,r){F.cssHooks[r]={set:function(e,t){var i,n,o="";if("transparent"!==t&&("string"!==F.type(t)||(i=K(t)))){if(t=G(i||t),!j.rgba&&1!==t._rgba[3]){for(n="backgroundColor"===r?e.parentNode:e;(""===o||"transparent"===o)&&n&&n.style;)try{o=F.css(n,"backgroundColor"),n=n.parentNode}catch(e){}t=t.blend(o&&"transparent"!==o?o:"_default")}t=t.toRgbaString()}try{e.style[r]=t}catch(e){}}},F.fx.step[r]=function(e){e.colorInit||(e.start=G(e.elem,r),e.end=G(e.end),e.colorInit=!0),F.cssHooks[r].set(e.elem,e.start.transition(e.end,e.pos))}})},G.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),F.cssHooks.borderColor={expand:function(i){var n={};return H(["Top","Right","Bottom","Left"],function(e,t){n["border"+t+"Color"]=i}),n}},P=F.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"},O=["add","remove","toggle"],N={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1},D.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,t){D.fx.step[t]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(V.style(e.elem,t,e.end),e.setAttr=!0)}}),D.fn.addBack||(D.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),D.effects.animateClass=function(o,e,t,i){var r=D.speed(e,t,i);return this.queue(function(){var e,i=D(this),t=i.attr("class")||"",n=r.children?i.find("*").addBack():i;n=n.map(function(){return{el:D(this),start:q(this)}}),(e=function(){D.each(O,function(e,t){o[t]&&i[t+"Class"](o[t])})})(),n=n.map(function(){return this.end=q(this.el[0]),this.diff=function(e,t){var i,n,o={};for(i in t)n=t[i],e[i]!==n&&(N[i]||!D.fx.step[i]&&isNaN(parseFloat(n))||(o[i]=n));return o}(this.start,this.end),this}),i.attr("class",t),n=n.map(function(){var e=this,t=D.Deferred(),i=D.extend({},r,{queue:!1,complete:function(){t.resolve(e)}});return this.el.animate(this.diff,i),t.promise()}),D.when.apply(D,n.get()).done(function(){e(),D.each(arguments,function(){var t=this.el;D.each(this.diff,function(e){t.css(e,"")})}),r.complete.call(i[0])})})},D.fn.extend({addClass:(R=D.fn.addClass,function(e,t,i,n){return t?D.effects.animateClass.call(this,{add:e},t,i,n):R.apply(this,arguments)}),removeClass:(k=D.fn.removeClass,function(e,t,i,n){return 1<arguments.length?D.effects.animateClass.call(this,{remove:e},t,i,n):k.apply(this,arguments)}),toggleClass:(T=D.fn.toggleClass,function(e,t,i,n,o){return"boolean"==typeof t||void 0===t?i?D.effects.animateClass.call(this,t?{add:e}:{remove:e},i,n,o):T.apply(this,arguments):D.effects.animateClass.call(this,{toggle:e},t,i,n)}),switchClass:function(e,t,i,n,o){return D.effects.animateClass.call(this,{add:t,remove:e},i,n,o)}}),D.extend(D.effects,{version:"1.11.1",save:function(e,t){for(var i=0;t.length>i;i++)null!==t[i]&&e.data(z+t[i],e[0].style[t[i]])},restore:function(e,t){var i,n;for(n=0;t.length>n;n++)null!==t[n]&&(void 0===(i=e.data(z+t[n]))&&(i=""),e.css(t[n],i))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var i,n;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=e[1]/t.width}return{x:n,y:i}},createWrapper:function(i){if(i.parent().is(".ui-effects-wrapper"))return i.parent();var n={width:i.outerWidth(!0),height:i.outerHeight(!0),float:i.css("float")},e=D("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),t={width:i.width(),height:i.height()},o=document.activeElement;try{o.id}catch(e){o=document.body}return i.wrap(e),i[0]!==o&&!D.contains(i[0],o)||D(o).focus(),e=i.parent(),"static"===i.css("position")?(e.css({position:"relative"}),i.css({position:"relative"})):(D.extend(n,{position:i.css("position"),zIndex:i.css("z-index")}),D.each(["top","left","bottom","right"],function(e,t){n[t]=i.css(t),isNaN(parseInt(n[t],10))&&(n[t]="auto")}),i.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),i.css(t),e.css(n).show()},removeWrapper:function(e){var t=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),e[0]!==t&&!D.contains(e[0],t)||D(t).focus()),e},setTransition:function(n,e,o,r){return r=r||{},D.each(e,function(e,t){var i=n.cssUnit(t);0<i[0]&&(r[t]=i[0]*o+i[1])}),r}}),D.fn.extend({effect:function(){function e(e){function t(){D.isFunction(n)&&n.call(i[0]),D.isFunction(e)&&e()}var i=D(this),n=r.complete,o=r.mode;(i.is(":hidden")?"hide"===o:"show"===o)?(i[o](),t()):a.call(i[0],r,t)}var r=U.apply(this,arguments),t=r.mode,i=r.queue,a=D.effects.effect[r.effect];return D.fx.off||!a?t?this[t](r.duration,r.complete):this.each(function(){r.complete&&r.complete.call(this)}):!1===i?this.each(e):this.queue(i||"fx",e)},show:(S=D.fn.show,function(e){if(Y(e))return S.apply(this,arguments);var t=U.apply(this,arguments);return t.mode="show",this.effect.call(this,t)}),hide:(x=D.fn.hide,function(e){if(Y(e))return x.apply(this,arguments);var t=U.apply(this,arguments);return t.mode="hide",this.effect.call(this,t)}),toggle:(E=D.fn.toggle,function(e){if(Y(e)||"boolean"==typeof e)return E.apply(this,arguments);var t=U.apply(this,arguments);return t.mode="toggle",this.effect.call(this,t)}),cssUnit:function(e){var i=this.css(e),n=[];return D.each(["em","px","%","pt"],function(e,t){0<i.indexOf(t)&&(n=[parseFloat(i),t])}),n}}),A={},D.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,e){A[e]=function(e){return Math.pow(e,t+2)}}),D.extend(A,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;((t=Math.pow(2,--i))-1)/11>e;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),D.each(A,function(e,t){D.easing["easeIn"+e]=t,D.easing["easeOut"+e]=function(e){return 1-t(1-e)},D.easing["easeInOut"+e]=function(e){return e<.5?t(2*e)/2:1-t(-2*e+2)/2}}),D.effects,D.effects.effect.blind=function(e,t){var i,n,o,r=D(this),a=["position","top","bottom","left","right","height","width"],s=D.effects.setMode(r,e.mode||"hide"),l=e.direction||"up",c=/up|down|vertical/.test(l),u=c?"height":"width",d=c?"top":"left",h=/up|left|vertical|horizontal/.test(l),p={},f="show"===s;r.parent().is(".ui-effects-wrapper")?D.effects.save(r.parent(),a):D.effects.save(r,a),r.show(),n=(i=D.effects.createWrapper(r).css({overflow:"hidden"}))[u](),o=parseFloat(i.css(d))||0,p[u]=f?n:0,h||(r.css(c?"bottom":"right",0).css(c?"top":"left","auto").css({position:"absolute"}),p[d]=f?o:n+o),f&&(i.css(u,0),h||i.css(d,o+n)),i.animate(p,{duration:e.duration,easing:e.easing,queue:!1,complete:function(){"hide"===s&&r.hide(),D.effects.restore(r,a),D.effects.removeWrapper(r),t()}})},D.effects.effect.bounce=function(e,t){var i,n,o,r=D(this),a=["position","top","bottom","left","right","height","width"],s=D.effects.setMode(r,e.mode||"effect"),l="hide"===s,c="show"===s,u=e.direction||"up",d=e.distance,h=e.times||5,p=2*h+(c||l?1:0),f=e.duration/p,g=e.easing,m="up"===u||"down"===u?"top":"left",v="up"===u||"left"===u,y=r.queue(),b=y.length;for((c||l)&&a.push("opacity"),D.effects.save(r,a),r.show(),D.effects.createWrapper(r),d=d||r["top"==m?"outerHeight":"outerWidth"]()/3,c&&((o={opacity:1})[m]=0,r.css("opacity",0).css(m,v?2*-d:2*d).animate(o,f,g)),l&&(d/=Math.pow(2,h-1)),i=(o={})[m]=0;i<h;i++)(n={})[m]=(v?"-=":"+=")+d,r.animate(n,f,g).animate(o,f,g),d=l?2*d:d/2;l&&((n={opacity:0})[m]=(v?"-=":"+=")+d,r.animate(n,f,g)),r.queue(function(){l&&r.hide(),D.effects.restore(r,a),D.effects.removeWrapper(r),t()}),1<b&&y.splice.apply(y,[1,0].concat(y.splice(b,1+p))),r.dequeue()},D.effects.effect.clip=function(e,t){var i,n,o,r=D(this),a=["position","top","bottom","left","right","height","width"],s="show"===D.effects.setMode(r,e.mode||"hide"),l="vertical"===(e.direction||"vertical"),c=l?"height":"width",u=l?"top":"left",d={};D.effects.save(r,a),r.show(),i=D.effects.createWrapper(r).css({overflow:"hidden"}),o=(n="IMG"===r[0].tagName?i:r)[c](),s&&(n.css(c,0),n.css(u,o/2)),d[c]=s?o:0,d[u]=s?0:o/2,n.animate(d,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){s||r.hide(),D.effects.restore(r,a),D.effects.removeWrapper(r),t()}})},D.effects.effect.drop=function(e,t){var i,n=D(this),o=["position","top","bottom","left","right","opacity","height","width"],r=D.effects.setMode(n,e.mode||"hide"),a="show"===r,s=e.direction||"left",l="up"===s||"down"===s?"top":"left",c="up"===s||"left"===s?"pos":"neg",u={opacity:a?1:0};D.effects.save(n,o),n.show(),D.effects.createWrapper(n),i=e.distance||n["top"==l?"outerHeight":"outerWidth"](!0)/2,a&&n.css("opacity",0).css(l,"pos"==c?-i:i),u[l]=(a?"pos"==c?"+=":"-=":"pos"==c?"-=":"+=")+i,n.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===r&&n.hide(),D.effects.restore(n,o),D.effects.removeWrapper(n),t()}})},D.effects.effect.explode=function(e,t){function i(){m.push(this),m.length===c*u&&(d.css({visibility:"visible"}),D(m).remove(),h||d.hide(),t())}var n,o,r,a,s,l,c=e.pieces?Math.round(Math.sqrt(e.pieces)):3,u=c,d=D(this),h="show"===D.effects.setMode(d,e.mode||"hide"),p=d.show().css("visibility","hidden").offset(),f=Math.ceil(d.outerWidth()/u),g=Math.ceil(d.outerHeight()/c),m=[];for(n=0;n<c;n++)for(a=p.top+n*g,l=n-(c-1)/2,o=0;o<u;o++)r=p.left+o*f,s=o-(u-1)/2,d.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*f,top:-n*g}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:f,height:g,left:r+(h?s*f:0),top:a+(h?l*g:0),opacity:h?0:1}).animate({left:r+(h?0:s*f),top:a+(h?0:l*g),opacity:h?1:0},e.duration||500,e.easing,i)},D.effects.effect.fade=function(e,t){var i=D(this),n=D.effects.setMode(i,e.mode||"toggle");i.animate({opacity:n},{queue:!1,duration:e.duration,easing:e.easing,complete:t})},D.effects.effect.fold=function(e,t){var i,n,o=D(this),r=["position","top","bottom","left","right","height","width"],a=D.effects.setMode(o,e.mode||"hide"),s="show"===a,l="hide"===a,c=e.size||15,u=/([0-9]+)%/.exec(c),d=!!e.horizFirst,h=s!=d,p=h?["width","height"]:["height","width"],f=e.duration/2,g={},m={};D.effects.save(o,r),o.show(),i=D.effects.createWrapper(o).css({overflow:"hidden"}),n=h?[i.width(),i.height()]:[i.height(),i.width()],u&&(c=parseInt(u[1],10)/100*n[l?0:1]),s&&i.css(d?{height:0,width:c}:{height:c,width:0}),g[p[0]]=s?n[0]:c,m[p[1]]=s?n[1]:0,i.animate(g,f,e.easing).animate(m,f,e.easing,function(){l&&o.hide(),D.effects.restore(o,r),D.effects.removeWrapper(o),t()})},D.effects.effect.highlight=function(e,t){var i=D(this),n=["backgroundImage","backgroundColor","opacity"],o=D.effects.setMode(i,e.mode||"show"),r={backgroundColor:i.css("backgroundColor")};"hide"===o&&(r.opacity=0),D.effects.save(i,n),i.show().css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(r,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&i.hide(),D.effects.restore(i,n),t()}})},D.effects.effect.size=function(r,e){var t,i,a,s=D(this),n=["position","top","bottom","left","right","width","height","overflow","opacity"],l=["width","height","overflow"],o=["fontSize"],c=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],u=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],d=D.effects.setMode(s,r.mode||"effect"),h=r.restore||"effect"!==d,p=r.scale||"both",f=r.origin||["middle","center"],g=s.css("position"),m=h?n:["position","top","bottom","left","right","overflow","opacity"],v={height:0,width:0,outerHeight:0,outerWidth:0};"show"===d&&s.show(),t={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},"toggle"===r.mode&&"show"===d?(s.from=r.to||v,s.to=r.from||t):(s.from=r.from||("show"===d?v:t),s.to=r.to||("hide"===d?v:t)),a={from:{y:s.from.height/t.height,x:s.from.width/t.width},to:{y:s.to.height/t.height,x:s.to.width/t.width}},"box"!==p&&"both"!==p||(a.from.y!==a.to.y&&(m=m.concat(c),s.from=D.effects.setTransition(s,c,a.from.y,s.from),s.to=D.effects.setTransition(s,c,a.to.y,s.to)),a.from.x!==a.to.x&&(m=m.concat(u),s.from=D.effects.setTransition(s,u,a.from.x,s.from),s.to=D.effects.setTransition(s,u,a.to.x,s.to))),"content"!==p&&"both"!==p||a.from.y===a.to.y||(m=m.concat(o).concat(l),s.from=D.effects.setTransition(s,o,a.from.y,s.from),s.to=D.effects.setTransition(s,o,a.to.y,s.to)),D.effects.save(s,m),s.show(),D.effects.createWrapper(s),s.css("overflow","hidden").css(s.from),f&&(i=D.effects.getBaseline(f,t),s.from.top=(t.outerHeight-s.outerHeight())*i.y,s.from.left=(t.outerWidth-s.outerWidth())*i.x,s.to.top=(t.outerHeight-s.to.outerHeight)*i.y,s.to.left=(t.outerWidth-s.to.outerWidth)*i.x),s.css(s.from),"content"!==p&&"both"!==p||(c=c.concat(["marginTop","marginBottom"]).concat(o),u=u.concat(["marginLeft","marginRight"]),l=n.concat(c).concat(u),s.find("*[width]").each(function(){var e=D(this),t=e.height(),i=e.width(),n=e.outerHeight(),o=e.outerWidth();h&&D.effects.save(e,l),e.from={height:t*a.from.y,width:i*a.from.x,outerHeight:n*a.from.y,outerWidth:o*a.from.x},e.to={height:t*a.to.y,width:i*a.to.x,outerHeight:t*a.to.y,outerWidth:i*a.to.x},a.from.y!==a.to.y&&(e.from=D.effects.setTransition(e,c,a.from.y,e.from),e.to=D.effects.setTransition(e,c,a.to.y,e.to)),a.from.x!==a.to.x&&(e.from=D.effects.setTransition(e,u,a.from.x,e.from),e.to=D.effects.setTransition(e,u,a.to.x,e.to)),e.css(e.from),e.animate(e.to,r.duration,r.easing,function(){h&&D.effects.restore(e,l)})})),s.animate(s.to,{queue:!1,duration:r.duration,easing:r.easing,complete:function(){0===s.to.opacity&&s.css("opacity",s.from.opacity),"hide"===d&&s.hide(),D.effects.restore(s,m),h||("static"===g?s.css({position:"relative",top:s.to.top,left:s.to.left}):D.each(["top","left"],function(o,e){s.css(e,function(e,t){var i=parseInt(t,10),n=o?s.to.left:s.to.top;return"auto"===t?n+"px":i+n+"px"})})),D.effects.removeWrapper(s),e()}})},D.effects.effect.scale=function(e,t){var i=D(this),n=D.extend(!0,{},e),o=D.effects.setMode(i,e.mode||"effect"),r=parseInt(e.percent,10)||(0===parseInt(e.percent,10)?0:"hide"===o?0:100),a=e.direction||"both",s=e.origin,l={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()},c="horizontal"!==a?r/100:1,u="vertical"!==a?r/100:1;n.effect="size",n.queue=!1,n.complete=t,"effect"!==o&&(n.origin=s||["middle","center"],n.restore=!0),n.from=e.from||("show"===o?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*c,width:l.width*u,outerHeight:l.outerHeight*c,outerWidth:l.outerWidth*u},n.fade&&("show"===o&&(n.from.opacity=0,n.to.opacity=1),"hide"===o&&(n.from.opacity=1,n.to.opacity=0)),i.effect(n)},D.effects.effect.puff=function(e,t){var i=D(this),n=D.effects.setMode(i,e.mode||"hide"),o="hide"===n,r=parseInt(e.percent,10)||150,a=r/100,s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};D.extend(e,{effect:"scale",queue:!1,fade:!0,mode:n,complete:t,percent:o?r:100,from:o?s:{height:s.height*a,width:s.width*a,outerHeight:s.outerHeight*a,outerWidth:s.outerWidth*a}}),i.effect(e)},D.effects.effect.pulsate=function(e,t){var i,n=D(this),o=D.effects.setMode(n,e.mode||"show"),r="show"===o,a="hide"===o,s=r||"hide"===o,l=2*(e.times||5)+(s?1:0),c=e.duration/l,u=0,d=n.queue(),h=d.length;for(!r&&n.is(":visible")||(n.css("opacity",0).show(),u=1),i=1;i<l;i++)n.animate({opacity:u},c,e.easing),u=1-u;n.animate({opacity:u},c,e.easing),n.queue(function(){a&&n.hide(),t()}),1<h&&d.splice.apply(d,[1,0].concat(d.splice(h,1+l))),n.dequeue()},D.effects.effect.shake=function(e,t){var i,n=D(this),o=["position","top","bottom","left","right","height","width"],r=D.effects.setMode(n,e.mode||"effect"),a=e.direction||"left",s=e.distance||20,l=e.times||3,c=2*l+1,u=Math.round(e.duration/c),d="up"===a||"down"===a?"top":"left",h="up"===a||"left"===a,p={},f={},g={},m=n.queue(),v=m.length;for(D.effects.save(n,o),n.show(),D.effects.createWrapper(n),p[d]=(h?"-=":"+=")+s,f[d]=(h?"+=":"-=")+2*s,g[d]=(h?"-=":"+=")+2*s,n.animate(p,u,e.easing),i=1;i<l;i++)n.animate(f,u,e.easing).animate(g,u,e.easing);n.animate(f,u,e.easing).animate(p,u/2,e.easing).queue(function(){"hide"===r&&n.hide(),D.effects.restore(n,o),D.effects.removeWrapper(n),t()}),1<v&&m.splice.apply(m,[1,0].concat(m.splice(v,1+c))),n.dequeue()},D.effects.effect.slide=function(e,t){var i,n=D(this),o=["position","top","bottom","left","right","width","height"],r=D.effects.setMode(n,e.mode||"show"),a="show"===r,s=e.direction||"left",l="up"===s||"down"===s?"top":"left",c="up"===s||"left"===s,u={};D.effects.save(n,o),n.show(),i=e.distance||n["top"==l?"outerHeight":"outerWidth"](!0),D.effects.createWrapper(n).css({overflow:"hidden"}),a&&n.css(l,c?isNaN(i)?"-"+i:-i:i),u[l]=(a?c?"+=":"-=":c?"-=":"+=")+i,n.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===r&&n.hide(),D.effects.restore(n,o),D.effects.removeWrapper(n),t()}})},D.effects.effect.transfer=function(e,t){var i=D(this),n=D(e.to),o="fixed"===n.css("position"),r=D("body"),a=o?r.scrollTop():0,s=o?r.scrollLeft():0,l=n.offset(),c={top:l.top-a,left:l.left-s,height:n.innerHeight(),width:n.innerWidth()},u=i.offset(),d=D("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(e.className).css({top:u.top-a,left:u.left-s,height:i.innerHeight(),width:i.innerWidth(),position:o?"fixed":"absolute"}).animate(c,e.duration,e.easing,function(){d.remove(),t()})},D.widget("ui.progressbar",{version:"1.11.1",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=D("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return void 0===e?this.options.value:(this.options.value=this._constrainedValue(e),void this._refreshValue())},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=!1===e,"number"!=typeof e&&(e=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,t=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(t.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=D("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}}),D.widget("ui.selectable",D.ui.mouse,{version:"1.11.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,t=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){(e=D(t.options.filter,t.element[0])).addClass("ui-selectee"),e.each(function(){var e=D(this),t=e.offset();D.data(this,"selectable-item",{element:this,$element:e,left:t.left,top:t.top,right:t.left+e.outerWidth(),bottom:t.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=e.addClass("ui-selectee"),this._mouseInit(),this.helper=D("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(i){var n=this,e=this.options;this.opos=[i.pageX,i.pageY],this.options.disabled||(this.selectees=D(e.filter,this.element[0]),this._trigger("start",i),D(e.appendTo).append(this.helper),this.helper.css({left:i.pageX,top:i.pageY,width:0,height:0}),e.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var e=D.data(this,"selectable-item");e.startselected=!0,i.metaKey||i.ctrlKey||(e.$element.removeClass("ui-selected"),e.selected=!1,e.$element.addClass("ui-unselecting"),e.unselecting=!0,n._trigger("unselecting",i,{unselecting:e.element}))}),D(i.target).parents().addBack().each(function(){var e,t=D.data(this,"selectable-item");return t?(e=!i.metaKey&&!i.ctrlKey||!t.$element.hasClass("ui-selected"),t.$element.removeClass(e?"ui-unselecting":"ui-selected").addClass(e?"ui-selecting":"ui-unselecting"),t.unselecting=!e,t.selecting=e,(t.selected=e)?n._trigger("selecting",i,{selecting:t.element}):n._trigger("unselecting",i,{unselecting:t.element}),!1):void 0}))},_mouseDrag:function(i){if(this.dragged=!0,!this.options.disabled){var e,n=this,o=this.options,r=this.opos[0],a=this.opos[1],s=i.pageX,l=i.pageY;return s<r&&(e=s,s=r,r=e),l<a&&(e=l,l=a,a=e),this.helper.css({left:r,top:a,width:s-r,height:l-a}),this.selectees.each(function(){var e=D.data(this,"selectable-item"),t=!1;e&&e.element!==n.element[0]&&("touch"===o.tolerance?t=!(e.left>s||r>e.right||e.top>l||a>e.bottom):"fit"===o.tolerance&&(t=e.left>r&&s>e.right&&e.top>a&&l>e.bottom),t?(e.selected&&(e.$element.removeClass("ui-selected"),e.selected=!1),e.unselecting&&(e.$element.removeClass("ui-unselecting"),e.unselecting=!1),e.selecting||(e.$element.addClass("ui-selecting"),e.selecting=!0,n._trigger("selecting",i,{selecting:e.element}))):(e.selecting&&((i.metaKey||i.ctrlKey)&&e.startselected?(e.$element.removeClass("ui-selecting"),e.selecting=!1,e.$element.addClass("ui-selected"),e.selected=!0):(e.$element.removeClass("ui-selecting"),e.selecting=!1,e.startselected&&(e.$element.addClass("ui-unselecting"),e.unselecting=!0),n._trigger("unselecting",i,{unselecting:e.element}))),e.selected&&(i.metaKey||i.ctrlKey||e.startselected||(e.$element.removeClass("ui-selected"),e.selected=!1,e.$element.addClass("ui-unselecting"),e.unselecting=!0,n._trigger("unselecting",i,{unselecting:e.element})))))}),!1}},_mouseStop:function(t){var i=this;return this.dragged=!1,D(".ui-unselecting",this.element[0]).each(function(){var e=D.data(this,"selectable-item");e.$element.removeClass("ui-unselecting"),e.unselecting=!1,e.startselected=!1,i._trigger("unselected",t,{unselected:e.element})}),D(".ui-selecting",this.element[0]).each(function(){var e=D.data(this,"selectable-item");e.$element.removeClass("ui-selecting").addClass("ui-selected"),e.selecting=!1,e.selected=!0,e.startselected=!0,i._trigger("selected",t,{selected:e.element})}),this._trigger("stop",t),this.helper.remove(),!1}}),D.widget("ui.selectmenu",{version:"1.11.1",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var e=this,t=this.element.attr("tabindex");this.label=D("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(e){this.button.focus(),e.preventDefault()}}),this.element.hide(),this.button=D("<span>",{class:"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:t||this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),D("<span>",{class:"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=D("<span>",{class:"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){e.menuItems||e._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var n=this;this.menu=D("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=D("<div>",{class:"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(e,t){e.preventDefault(),n._select(t.item.data("ui-selectmenu-item"),e)},focus:function(e,t){var i=t.item.data("ui-selectmenu-item");null!=n.focusIndex&&i.index!==n.focusIndex&&(n._trigger("focus",e,{item:i}),n.isOpen||n._select(i,e)),n.focusIndex=i.index,n.button.attr("aria-activedescendant",n.menuItems.eq(i.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var e,t=this.element.find("option");t.length&&(this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e))},_position:function(){this.menuWrap.position(D.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(i,e){var n=this,o="";D.each(e,function(e,t){t.optgroup!==o&&(D("<li>",{class:"ui-selectmenu-optgroup ui-menu-divider"+(t.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:t.optgroup}).appendTo(i),o=t.optgroup),n._renderItemData(i,t)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(e,t){var i=D("<li>");return t.disabled&&i.addClass("ui-state-disabled"),this._setText(i,t.label),i.appendTo(e)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var i,n,o=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),o+=":not(.ui-state-disabled)"),(n="first"===e||"last"===e?i["first"===e?"prevAll":"nextAll"](o).eq(-1):i[e+"All"](o).eq(0)).length&&this.menuInstance.focus(t,n)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_documentClick:{mousedown:function(e){this.isOpen&&(D(e.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(e))}},_buttonEvents:{mousedown:function(e){e.preventDefault()},click:"_toggle",keydown:function(e){var t=!0;switch(e.keyCode){case D.ui.keyCode.TAB:case D.ui.keyCode.ESCAPE:this.close(e),t=!1;break;case D.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(e);break;case D.ui.keyCode.UP:e.altKey?this._toggle(e):this._move("prev",e);break;case D.ui.keyCode.DOWN:e.altKey?this._toggle(e):this._move("next",e);break;case D.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(e):this._toggle(e);break;case D.ui.keyCode.LEFT:this._move("prev",e);break;case D.ui.keyCode.RIGHT:this._move("next",e);break;case D.ui.keyCode.HOME:case D.ui.keyCode.PAGE_UP:this._move("first",e);break;case D.ui.keyCode.END:case D.ui.keyCode.PAGE_DOWN:this._move("last",e);break;default:this.menu.trigger(e),t=!1}t&&e.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex);t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this._setText(this.buttonText,e.label),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==i&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){"icons"===e&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(t.button),this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"disabled"===e&&(this.menuInstance.option("disabled",t),this.button.toggleClass("ui-state-disabled",t).attr("aria-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===e&&this._resizeButton()},_appendTo:function(){var e=this.options.appendTo;return(e=e&&(e.jquery||e.nodeType?D(e):this.document.find(e).eq(0)))&&e[0]||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;e||(e=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(e)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(e){var o=[];e.each(function(e,t){var i=D(t),n=i.parent("optgroup");o.push({element:i,index:e,value:i.attr("value"),label:i.text(),optgroup:n.attr("label")||"",disabled:n.prop("disabled")||i.prop("disabled")})}),this.items=o},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),D.widget("ui.slider",D.ui.mouse,{version:"1.11.1",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,t,i=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),o=[];for(t=i.values&&i.values.length||1,n.length>t&&(n.slice(t).remove(),n=n.slice(0,t)),e=n.length;e<t;e++)o.push("<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>");this.handles=n.add(D(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(e){D(this).data("ui-slider-handle-index",e)})},_createRange:function(){var e=this.options,t="";e.range?(!0===e.range&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:D.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=D("<div></div>").appendTo(this.element),t="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(t+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var t,i,n,o,r,a,s,l=this,c=this.options;return!c.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var t=Math.abs(i-l.values(e));(t<n||n===t&&(e===l._lastChangedValue||l.values(e)===c.min))&&(n=t,o=D(this),r=e)}),!1!==this._start(e,r)&&(this._mouseSliding=!0,this._handleIndex=r,o.addClass("ui-state-active").focus(),a=o.offset(),s=!D(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=s?{left:0,top:0}:{left:e.pageX-a.left-o.width()/2,top:e.pageY-a.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,r,i),this._animateOff=!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,n,o;return 1<(i=("horizontal"===this.orientation?(t=this.elementSize.width,e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)))/t)&&(i=1),i<0&&(i=0),"vertical"===this.orientation&&(i=1-i),n=this._valueMax()-this._valueMin(),o=this._valueMin()+i*n,this._trimAlignValue(o)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var n,o,r;this.options.values&&this.options.values.length?(n=this.values(t?0:1),2===this.options.values.length&&!0===this.options.range&&(0===t&&n<i||1===t&&i<n)&&(i=n),i!==this.values(t)&&((o=this.values())[t]=i,r=this._trigger("slide",e,{handle:this.handles[t],value:i,values:o}),n=this.values(t?0:1),!1!==r&&this.values(t,i))):i===this.value()||!1!==(r=this._trigger("slide",e,{handle:this.handles[t],value:i}))&&this.value(i)},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,t){var i,n,o;if(1<arguments.length)return this.options.values[e]=this._trimAlignValue(t),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!D.isArray(e))return this.options.values&&this.options.values.length?this._values(e):this.value();for(i=this.options.values,n=e,o=0;i.length>o;o+=1)i[o]=this._trimAlignValue(n[o]),this._change(null,o);this._refreshValue()},_setOption:function(e,t){var i,n=0;switch("range"===e&&!0===this.options.range&&("min"===t?(this.options.value=this._values(0),this.options.values=null):"max"===t&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),D.isArray(this.options.values)&&(n=this.options.values.length),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t),this._super(e,t),e){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===t?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=0;i<n;i+=1)this._change(null,i);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return this._trimAlignValue(e)},_values:function(e){var t,i,n;if(arguments.length)return t=this.options.values[e],this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),n=0;i.length>n;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(e){if(this._valueMin()>=e)return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=0<this.options.step?this.options.step:1,i=(e-this._valueMin())%t,n=e-i;return 2*Math.abs(i)>=t&&(n+=0<i?t:-t),parseFloat(n.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,i,e,n,o,r=this.options.range,a=this.options,s=this,l=!this._animateOff&&a.animate,c={};this.options.values&&this.options.values.length?this.handles.each(function(e){i=(s.values(e)-s._valueMin())/(s._valueMax()-s._valueMin())*100,c["horizontal"===s.orientation?"left":"bottom"]=i+"%",D(this).stop(1,1)[l?"animate":"css"](c,a.animate),!0===s.options.range&&("horizontal"===s.orientation?(0===e&&s.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},a.animate),1===e&&s.range[l?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:a.animate})):(0===e&&s.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},a.animate),1===e&&s.range[l?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:a.animate}))),t=i}):(e=this.value(),n=this._valueMin(),o=this._valueMax(),i=o!==n?(e-n)/(o-n)*100:0,c["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](c,a.animate),"min"===r&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},a.animate),"max"===r&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:a.animate}),"min"===r&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},a.animate),"max"===r&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:a.animate}))},_handleEvents:{keydown:function(e){var t,i,n,o=D(e.target).data("ui-slider-handle-index");switch(e.keyCode){case D.ui.keyCode.HOME:case D.ui.keyCode.END:case D.ui.keyCode.PAGE_UP:case D.ui.keyCode.PAGE_DOWN:case D.ui.keyCode.UP:case D.ui.keyCode.RIGHT:case D.ui.keyCode.DOWN:case D.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,D(e.target).addClass("ui-state-active"),!1===this._start(e,o)))return}switch(n=this.options.step,t=i=this.options.values&&this.options.values.length?this.values(o):this.value(),e.keyCode){case D.ui.keyCode.HOME:i=this._valueMin();break;case D.ui.keyCode.END:i=this._valueMax();break;case D.ui.keyCode.PAGE_UP:i=this._trimAlignValue(t+(this._valueMax()-this._valueMin())/this.numPages);break;case D.ui.keyCode.PAGE_DOWN:i=this._trimAlignValue(t-(this._valueMax()-this._valueMin())/this.numPages);break;case D.ui.keyCode.UP:case D.ui.keyCode.RIGHT:if(t===this._valueMax())return;i=this._trimAlignValue(t+n);break;case D.ui.keyCode.DOWN:case D.ui.keyCode.LEFT:if(t===this._valueMin())return;i=this._trimAlignValue(t-n)}this._slide(e,o,i)},keyup:function(e){var t=D(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,t),this._change(e,t),D(e.target).removeClass("ui-state-active"))}}}),D.widget("ui.sortable",D.ui.mouse,{version:"1.11.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return t<=e&&e<t+i},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=!!this.items.length&&("x"===e.axis||this._isFloating(this.items[0].item)),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),D.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;0<=e;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,t){var i=null,n=!1,o=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(e),D(e.target).parents().each(function(){return D.data(this,o.widgetName+"-item")===o?(i=D(this),!1):void 0}),D.data(e.target,o.widgetName+"-item")===o&&(i=D(e.target)),!!i&&(!(this.options.handle&&!t&&(D(this.options.handle,i).find("*").addBack().each(function(){this===e.target&&(n=!0)}),!n))&&(this.currentItem=i,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(e,t,i){var n,o,r=this.options;if((this.currentContainer=this).refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},D.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,r.cursorAt&&this._adjustOffsetFromHelper(r.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),r.containment&&this._setContainment(),r.cursor&&"auto"!==r.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",r.cursor),this.storedStylesheet=D("<style>*{ cursor: "+r.cursor+" !important; }</style>").appendTo(o)),r.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",r.opacity)),r.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",r.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(n=this.containers.length-1;0<=n;n--)this.containers[n]._trigger("activate",e,this._uiHash(this));return D.ui.ddmanager&&(D.ui.ddmanager.current=this),D.ui.ddmanager&&!r.dropBehaviour&&D.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var t,i,n,o,r=this.options,a=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<r.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+r.scrollSpeed:e.pageY-this.overflowOffset.top<r.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-r.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<r.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+r.scrollSpeed:e.pageX-this.overflowOffset.left<r.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-r.scrollSpeed)):(e.pageY-D(document).scrollTop()<r.scrollSensitivity?a=D(document).scrollTop(D(document).scrollTop()-r.scrollSpeed):D(window).height()-(e.pageY-D(document).scrollTop())<r.scrollSensitivity&&(a=D(document).scrollTop(D(document).scrollTop()+r.scrollSpeed)),e.pageX-D(document).scrollLeft()<r.scrollSensitivity?a=D(document).scrollLeft(D(document).scrollLeft()-r.scrollSpeed):D(window).width()-(e.pageX-D(document).scrollLeft())<r.scrollSensitivity&&(a=D(document).scrollLeft(D(document).scrollLeft()+r.scrollSpeed))),!1!==a&&D.ui.ddmanager&&!r.dropBehaviour&&D.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),t=this.items.length-1;0<=t;t--)if(n=(i=this.items[t]).item[0],(o=this._intersectsWithPointer(i))&&i.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===o?"next":"prev"]()[0]!==n&&!D.contains(this.placeholder[0],n)&&("semi-dynamic"!==this.options.type||!D.contains(this.element[0],n))){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;this._rearrange(e,i),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),D.ui.ddmanager&&D.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,t){if(e){if(D.ui.ddmanager&&!this.options.dropBehaviour&&D.ui.ddmanager.drop(this,e),this.options.revert){var i=this,n=this.placeholder.offset(),o=this.options.axis,r={};o&&"x"!==o||(r.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(r.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,D(this.helper).animate(r,parseInt(this.options.revert,10)||500,function(){i._clear(e)})}else this._clear(e,t);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;0<=e;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),D.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?D(this.domPosition.prev).after(this.currentItem):D(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var e=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},D(e).each(function(){var e=(D(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);e&&i.push((t.key||e[1]+"[]")+"="+(t.key&&t.expression?e[1]:e[2]))}),!i.length&&t.key&&i.push(t.key+"="),i.join("&")},toArray:function(e){var t=this._getItemsAsjQuery(e&&e.connected),i=[];return e=e||{},t.each(function(){i.push(D(e.item||this).attr(e.attribute||"id")||"")}),i},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,n=this.positionAbs.top,o=n+this.helperProportions.height,r=e.left,a=r+e.width,s=e.top,l=s+e.height,c=this.offset.click.top,u=this.offset.click.left,d="x"===this.options.axis||s<n+c&&n+c<l,h="y"===this.options.axis||r<t+u&&t+u<a,p=d&&h;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:t+this.helperProportions.width/2>r&&a>i-this.helperProportions.width/2&&n+this.helperProportions.height/2>s&&l>o-this.helperProportions.height/2},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),n=t&&i,o=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return!!n&&(this.floating?r&&"right"===r||"down"===o?2:1:o&&("down"===o?2:1))},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),n=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return this.floating&&o?"right"===o&&i||"left"===o&&!i:n&&("down"===n&&t||"up"===n&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!=e&&(0<e?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!=e&&(0<e?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(e){function t(){a.push(this)}var i,n,o,r,a=[],s=[],l=this._connectWith();if(l&&e)for(i=l.length-1;0<=i;i--)for(n=(o=D(l[i])).length-1;0<=n;n--)(r=D.data(o[n],this.widgetFullName))&&r!==this&&!r.options.disabled&&s.push([D.isFunction(r.options.items)?r.options.items.call(r.element):D(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r]);for(s.push([D.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):D(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=s.length-1;0<=i;i--)s[i][0].each(t);return D(a)},_removeCurrentsFromItems:function(){var i=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=D.grep(this.items,function(e){for(var t=0;i.length>t;t++)if(i[t]===e.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var t,i,n,o,r,a,s,l,c=this.items,u=[[D.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):D(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(t=d.length-1;0<=t;t--)for(i=(n=D(d[t])).length-1;0<=i;i--)(o=D.data(n[i],this.widgetFullName))&&o!==this&&!o.options.disabled&&(u.push([D.isFunction(o.options.items)?o.options.items.call(o.element[0],e,{item:this.currentItem}):D(o.options.items,o.element),o]),this.containers.push(o));for(t=u.length-1;0<=t;t--)for(r=u[t][1],i=0,l=(a=u[t][0]).length;i<l;i++)(s=D(a[i])).data(this.widgetName+"-item",r),c.push({item:s,instance:r,width:0,height:0,left:0,top:0})},refreshPositions:function(e){var t,i,n,o;for(this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),t=this.items.length-1;0<=t;t--)(i=this.items[t]).instance!==this.currentContainer&&this.currentContainer&&i.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?D(this.options.toleranceElement,i.item):i.item,e||(i.width=n.outerWidth(),i.height=n.outerHeight()),o=n.offset(),i.left=o.left,i.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(t=this.containers.length-1;0<=t;t--)o=this.containers[t].element.offset(),this.containers[t].containerCache.left=o.left,this.containers[t].containerCache.top=o.top,this.containers[t].containerCache.width=this.containers[t].element.outerWidth(),this.containers[t].containerCache.height=this.containers[t].element.outerHeight();return this},_createPlaceholder:function(i){var n,o=(i=i||this).options;o.placeholder&&o.placeholder.constructor!==String||(n=o.placeholder,o.placeholder={element:function(){var e=i.currentItem[0].nodeName.toLowerCase(),t=D("<"+e+">",i.document[0]).addClass(n||i.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===e?i.currentItem.children().each(function(){D("<td>&#160;</td>",i.document[0]).attr("colspan",D(this).attr("colspan")||1).appendTo(t)}):"img"===e&&t.attr("src",i.currentItem.attr("src")),n||t.css("visibility","hidden"),t},update:function(e,t){n&&!o.forcePlaceholderSize||(t.height()||t.height(i.currentItem.innerHeight()-parseInt(i.currentItem.css("paddingTop")||0,10)-parseInt(i.currentItem.css("paddingBottom")||0,10)),t.width()||t.width(i.currentItem.innerWidth()-parseInt(i.currentItem.css("paddingLeft")||0,10)-parseInt(i.currentItem.css("paddingRight")||0,10)))}}),i.placeholder=D(o.placeholder.element.call(i.element,i.currentItem)),i.currentItem.after(i.placeholder),o.placeholder.update(i,i.placeholder)},_contactContainers:function(e){var t,i,n,o,r,a,s,l,c,u,d=null,h=null;for(t=this.containers.length-1;0<=t;t--)if(!D.contains(this.currentItem[0],this.containers[t].element[0]))if(this._intersectsWith(this.containers[t].containerCache)){if(d&&D.contains(this.containers[t].element[0],d.element[0]))continue;d=this.containers[t],h=t}else this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",e,this._uiHash(this)),this.containers[t].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[h].containerCache.over||(this.containers[h]._trigger("over",e,this._uiHash(this)),this.containers[h].containerCache.over=1);else{for(n=1e4,o=null,r=(c=d.floating||this._isFloating(this.currentItem))?"left":"top",a=c?"width":"height",u=c?"clientX":"clientY",i=this.items.length-1;0<=i;i--)D.contains(this.containers[h].element[0],this.items[i].item[0])&&this.items[i].item[0]!==this.currentItem[0]&&(s=this.items[i].item.offset()[r],l=!1,e[u]-s>this.items[i][a]/2&&(l=!0),n>Math.abs(e[u]-s)&&(n=Math.abs(e[u]-s),o=this.items[i],this.direction=l?"up":"down"));if(!o&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[h])return;o?this._rearrange(e,o,null,!0):this._rearrange(e,null,this.containers[h].element,!0),this._trigger("change",e,this._uiHash()),this.containers[h]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[h],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[h]._trigger("over",e,this._uiHash(this)),this.containers[h].containerCache.over=1}},_createHelper:function(e){var t=this.options,i=D.isFunction(t.helper)?D(t.helper.apply(this.element[0],[e,this.currentItem])):"clone"===t.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||D("parent"!==t.appendTo?t.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),i[0].style.width&&!t.forceHelperSize||i.width(this.currentItem.width()),i[0].style.height&&!t.forceHelperSize||i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),D.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&D.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&D.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,i,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),"document"!==n.containment&&"window"!==n.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,D("document"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,(D("document"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(e=D(n.containment)[0],t=D(n.containment).offset(),i="hidden"!==D(e).css("overflow"),this.containment=[t.left+(parseInt(D(e).css("borderLeftWidth"),10)||0)+(parseInt(D(e).css("paddingLeft"),10)||0)-this.margins.left,t.top+(parseInt(D(e).css("borderTopWidth"),10)||0)+(parseInt(D(e).css("paddingTop"),10)||0)-this.margins.top,t.left+(i?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(D(e).css("borderLeftWidth"),10)||0)-(parseInt(D(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,t.top+(i?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(D(e).css("borderTopWidth"),10)||0)-(parseInt(D(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,t){t=t||this.position;var i="absolute"===e?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&D.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop())*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())*i}},_generatePosition:function(e){var t,i,n=this.options,o=e.pageX,r=e.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&D.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(r=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(r=this.containment[3]+this.offset.click.top)),n.grid&&(t=this.originalPageY+Math.round((r-this.originalPageY)/n.grid[1])*n.grid[1],r=this.containment?t-this.offset.click.top>=this.containment[1]&&t-this.offset.click.top<=this.containment[3]?t:t-this.offset.click.top>=this.containment[1]?t-n.grid[1]:t+n.grid[1]:t,i=this.originalPageX+Math.round((o-this.originalPageX)/n.grid[0])*n.grid[0],o=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-n.grid[0]:i+n.grid[0]:i)),{top:r-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:a.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:a.scrollLeft())}},_rearrange:function(e,t,i,n){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var o=this.counter;this._delay(function(){o===this.counter&&this.refreshPositions(!n)})},_clear:function(e,t){function i(t,i,n){return function(e){n._trigger(t,e,i._uiHash(i))}}this.reverting=!1;var n,o=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)"auto"!==this._storedCSS[n]&&"static"!==this._storedCSS[n]||(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&o.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||o.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(o.push(function(e){this._trigger("remove",e,this._uiHash())}),o.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),o.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;0<=n;n--)t||o.push(i("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(o.push(i("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!t){for(this._trigger("beforeStop",e,this._uiHash()),n=0;o.length>n;n++)o[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1}if(t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!t){for(n=0;o.length>n;n++)o[n].call(this,e);this._trigger("stop",e,this._uiHash())}return!(this.fromOutside=!1)},_trigger:function(){!1===D.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(e){var t=e||this;return{helper:t.helper,placeholder:t.placeholder||D([]),position:t.position,originalPosition:t.originalPosition,offset:t.positionAbs,item:t.currentItem,sender:e?e.element:null}}}),D.widget("ui.spinner",{version:"1.11.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var n={},o=this.element;return D.each(["min","max","step"],function(e,t){var i=o.attr(t);void 0!==i&&i.length&&(n[t]=i)}),n},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",e)))},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((0<t?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(e){function t(){this.element[0]===this.document[0].activeElement||(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i}))}var i;i=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),e.preventDefault(),t.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,t.call(this)}),!1!==this._start(e)&&this._repeat(null,D(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return D(e.currentTarget).hasClass("ui-state-active")?!1!==this._start(e)&&void this._repeat(null,D(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&0<e.height()&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(e){var t=this.options,i=D.ui.keyCode;switch(e.keyCode){case i.UP:return this._repeat(null,1,e),!0;case i.DOWN:return this._repeat(null,-1,e),!0;case i.PAGE_UP:return this._repeat(null,t.page,e),!0;case i.PAGE_DOWN:return this._repeat(null,-t.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(e){return!(!this.spinning&&!1===this._trigger("start",e))&&(this.counter||(this.counter=1),this.spinning=!0)},_repeat:function(e,t,i){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,i)},e),this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+e*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",t,{value:i})||(this._value(i),this.counter++)},_increment:function(e){var t=this.options.incremental;return t?D.isFunction(t)?t(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=""+e,i=t.indexOf(".");return-1===i?0:t.length-i-1},_adjustValue:function(e){var t,i,n=this.options;return i=e-(t=null!==n.min?n.min:0),e=t+(i=Math.round(i/n.step)*n.step),e=parseFloat(e.toFixed(this._precision())),null!==n.max&&e>n.max?n.max:null!==n.min&&n.min>e?n.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var i=this._parse(this.element.val());return this.options[e]=t,void this.element.val(this._format(i))}"max"!==e&&"min"!==e&&"step"!==e||"string"!=typeof t||(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable"))},_setOptions:t(function(e){this._super(e)}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null!==e&&e===this._adjustValue(e)},_value:function(e,t){var i;""===e||null!==(i=this._parse(e))&&(t||(i=this._adjustValue(i)),e=this._format(i)),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?void t(this._value).call(this,e):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),D.widget("ui.tabs",{version:"1.11.1",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:(_=/#.*$/,function(e){var t,i;t=(e=e.cloneNode(!1)).href.replace(_,""),i=location.href.replace(_,"");try{t=decodeURIComponent(t)}catch(e){}try{i=decodeURIComponent(i)}catch(e){}return 1<e.hash.length&&t===i}),_create:function(){var t=this,e=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",e.collapsible),this._processTabs(),e.active=this._initialActive(),D.isArray(e.disabled)&&(e.disabled=D.unique(e.disabled.concat(D.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=!1!==this.options.active&&this.anchors.length?this._findActive(e.active):D(),this._refresh(),this.active.length&&this.load(e.active)},_initialActive:function(){var i=this.options.active,e=this.options.collapsible,n=location.hash.substring(1);return null===i&&(n&&this.tabs.each(function(e,t){return D(t).attr("aria-controls")===n?(i=e,!1):void 0}),null===i&&(i=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null!==i&&-1!==i||(i=!!this.tabs.length&&0)),!1!==i&&(-1===(i=this.tabs.index(this.tabs.eq(i)))&&(i=!e&&0)),!e&&!1===i&&this.anchors.length&&(i=0),i},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):D()}},_tabKeydown:function(e){var t=D(this.document[0].activeElement).closest("li"),i=this.tabs.index(t),n=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case D.ui.keyCode.RIGHT:case D.ui.keyCode.DOWN:i++;break;case D.ui.keyCode.UP:case D.ui.keyCode.LEFT:n=!1,i--;break;case D.ui.keyCode.END:i=this.anchors.length-1;break;case D.ui.keyCode.HOME:i=0;break;case D.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(i);case D.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(i!==this.options.active&&i);default:return}e.preventDefault(),clearTimeout(this.activating),i=this._focusNextTab(i,n),e.ctrlKey||(t.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",i)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===D.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(e){return e.altKey&&e.keyCode===D.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===D.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,t){for(var i=this.tabs.length-1;-1!==D.inArray((i<e&&(e=0),e<0&&(e=i),e),this.options.disabled);)e=t?e+1:e-1;return e},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?void this._activate(t):"disabled"===e?void this._setupDisabled(t):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||!1!==this.options.active||this._activate(0)),"event"===e&&this._setupEvents(t),void("heightStyle"===e&&this._setupHeightStyle(t)))},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,t=this.tablist.children(":has(a[href])");e.disabled=D.map(t.filter(".ui-state-disabled"),function(e){return t.index(e)}),this._processTabs(),!1!==e.active&&this.anchors.length?this.active.length&&!D.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=D()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=D()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var l=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(e){D(this).is(".ui-state-disabled")&&e.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){D(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return D("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=D(),this.anchors.each(function(e,t){var i,n,o,r=D(t).uniqueId().attr("id"),a=D(t).closest("li"),s=a.attr("aria-controls");l._isLocal(t)?(o=(i=t.hash).substring(1),n=l.element.find(l._sanitizeSelector(i))):(i="#"+(o=a.attr("aria-controls")||D({}).uniqueId()[0].id),(n=l.element.find(i)).length||(n=l._createPanel(o)).insertAfter(l.panels[e-1]||l.tablist),n.attr("aria-live","polite")),n.length&&(l.panels=l.panels.add(n)),s&&a.data("ui-tabs-aria-controls",s),a.attr({"aria-controls":o,"aria-labelledby":r}),n.attr("aria-labelledby",r)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(e){return D("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){D.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var t,i=0;t=this.tabs[i];i++)!0===e||-1!==D.inArray(i,e)?D(t).addClass("ui-state-disabled").attr("aria-disabled","true"):D(t).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var i={};e&&D.each(e.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,t=this.element.parent();"fill"===e?(i=t.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var e=D(this),t=e.css("position");"absolute"!==t&&"fixed"!==t&&(i-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=D(this).outerHeight(!0)}),this.panels.each(function(){D(this).height(Math.max(0,i-D(this).innerHeight()+D(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each(function(){i=Math.max(i,D(this).height("").height())}).height(i))},_eventHandler:function(e){var t=this.options,i=this.active,n=D(e.currentTarget).closest("li"),o=n[0]===i[0],r=o&&t.collapsible,a=r?D():this._getPanelForTab(n),s=i.length?this._getPanelForTab(i):D(),l={oldTab:i,oldPanel:s,newTab:r?D():n,newPanel:a};e.preventDefault(),n.hasClass("ui-state-disabled")||n.hasClass("ui-tabs-loading")||this.running||o&&!t.collapsible||!1===this._trigger("beforeActivate",e,l)||(t.active=!r&&this.tabs.index(n),this.active=o?D():n,this.xhr&&this.xhr.abort(),s.length||a.length||D.error("jQuery UI Tabs: Mismatching fragment identifier."),a.length&&this.load(this.tabs.index(n),e),this._toggle(e,l))},_toggle:function(e,t){function i(){o.running=!1,o._trigger("activate",e,t)}function n(){t.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),r.length&&o.options.show?o._show(r,o.options.show,i):(r.show(),i())}var o=this,r=t.newPanel,a=t.oldPanel;this.running=!0,a.length&&this.options.hide?this._hide(a,this.options.hide,function(){t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a.hide(),n()),a.attr("aria-hidden","true"),t.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),r.length&&a.length?t.oldTab.attr("tabIndex",-1):r.length&&this.tabs.filter(function(){return 0===D(this).attr("tabIndex")}).attr("tabIndex",-1),r.attr("aria-hidden","false"),t.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(e){var t,i=this._findActive(e);i[0]!==this.active[0]&&(i.length||(i=this.active),t=i.find(".ui-tabs-anchor")[0],this._eventHandler({target:t,currentTarget:t,preventDefault:D.noop}))},_findActive:function(e){return!1===e?D():this.tabs.eq(e)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){D.data(this,"ui-tabs-destroy")?D(this).remove():D(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var e=D(this),t=e.data("ui-tabs-aria-controls");t?e.attr("aria-controls",t).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var e=this.options.disabled;!1!==e&&(e=void 0!==i&&(i=this._getIndex(i),D.isArray(e)?D.map(e,function(e){return e!==i?e:null}):D.map(this.tabs,function(e,t){return t!==i?t:null})),this._setupDisabled(e))},disable:function(e){var t=this.options.disabled;if(!0!==t){if(void 0===e)t=!0;else{if(e=this._getIndex(e),-1!==D.inArray(e,t))return;t=D.isArray(t)?D.merge([e],t).sort():[e]}this._setupDisabled(t)}},load:function(e,t){e=this._getIndex(e);var i=this,n=this.tabs.eq(e),o=n.find(".ui-tabs-anchor"),r=this._getPanelForTab(n),a={tab:n,panel:r};this._isLocal(o[0])||(this.xhr=D.ajax(this._ajaxSettings(o,t,a)),this.xhr&&"canceled"!==this.xhr.statusText&&(n.addClass("ui-tabs-loading"),r.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){r.html(e),i._trigger("load",t,a)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&i.panels.stop(!1,!0),n.removeClass("ui-tabs-loading"),r.removeAttr("aria-busy"),e===i.xhr&&delete i.xhr},1)})))},_ajaxSettings:function(e,i,n){var o=this;return{url:e.attr("href"),beforeSend:function(e,t){return o._trigger("beforeLoad",i,D.extend({jqXHR:e,ajaxSettings:t},n))}}},_getPanelForTab:function(e){var t=D(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+t))}}),D.widget("ui.tooltip",{version:"1.11.1",options:{content:function(){var e=D(this).attr("title")||"";return D("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(e,t){var i=(e.attr("aria-describedby")||"").split(/\s+/);i.push(t),e.data("ui-tooltip-id",t).attr("aria-describedby",D.trim(i.join(" ")))},_removeDescribedBy:function(e){var t=e.data("ui-tooltip-id"),i=(e.attr("aria-describedby")||"").split(/\s+/),n=D.inArray(t,i);-1!==n&&i.splice(n,1),e.removeData("ui-tooltip-id"),(i=D.trim(i.join(" ")))?e.attr("aria-describedby",i):e.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=D("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(e,t){var i=this;return"disabled"===e?(this[t?"_disable":"_enable"](),void(this.options[e]=t)):(this._super(e,t),void("content"===e&&D.each(this.tooltips,function(e,t){i._updateContent(t)})))},_disable:function(){var n=this;D.each(this.tooltips,function(e,t){var i=D.Event("blur");i.target=i.currentTarget=t[0],n.close(i,!0)}),this.element.find(this.options.items).addBack().each(function(){var e=D(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var e=D(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var i=this,t=D(e?e.target:this.element).closest(this.options.items);t.length&&!t.data("ui-tooltip-id")&&(t.attr("title")&&t.data("ui-tooltip-title",t.attr("title")),t.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&t.parents().each(function(){var e,t=D(this);t.data("ui-tooltip-open")&&((e=D.Event("blur")).target=e.currentTarget=this,i.close(e,!0)),t.attr("title")&&(t.uniqueId(),i.parents[this.id]={element:this,title:t.attr("title")},t.attr("title",""))}),this._updateContent(t,e))},_updateContent:function(t,i){var e,n=this.options.content,o=this,r=i?i.type:null;return"string"==typeof n?this._open(i,t,n):void((e=n.call(t[0],function(e){t.data("ui-tooltip-open")&&o._delay(function(){i&&(i.type=r),this._open(i,t,e)})}))&&this._open(i,t,e))},_open:function(e,i,t){function n(e){l.of=e,o.is(":hidden")||o.position(l)}var o,r,a,s,l=D.extend({},this.options.position);if(t){if((o=this._find(i)).length)return void o.find(".ui-tooltip-content").html(t);i.is("[title]")&&(e&&"mouseover"===e.type?i.attr("title",""):i.removeAttr("title")),o=this._tooltip(i),this._addDescribedBy(i,o.attr("id")),o.find(".ui-tooltip-content").html(t),this.liveRegion.children().hide(),t.clone?(s=t.clone()).removeAttr("id").find("[id]").removeAttr("id"):s=t,D("<div>").html(s).appendTo(this.liveRegion),this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:n}),n(e)):o.position(D.extend({of:i},this.options.position)),this.hiding=!1,this.closing=!1,o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(a=this.delayedShow=setInterval(function(){o.is(":visible")&&(n(l.of),clearInterval(a))},D.fx.interval)),this._trigger("open",e,{tooltip:o}),r={keyup:function(e){if(e.keyCode===D.ui.keyCode.ESCAPE){var t=D.Event(e);t.currentTarget=i[0],this.close(t,!0)}}},i[0]!==this.element[0]&&(r.remove=function(){this._removeTooltip(o)}),e&&"mouseover"!==e.type||(r.mouseleave="close"),e&&"focusin"!==e.type||(r.focusout="close"),this._on(!0,i,r)}},close:function(e){var i=this,t=D(e?e.currentTarget:this.element),n=this._find(t);this.closing||(clearInterval(this.delayedShow),t.data("ui-tooltip-title")&&!t.attr("title")&&t.attr("title",t.data("ui-tooltip-title")),this._removeDescribedBy(t),this.hiding=!0,n.stop(!0),this._hide(n,this.options.hide,function(){i._removeTooltip(D(this)),this.hiding=!1,this.closing=!1}),t.removeData("ui-tooltip-open"),this._off(t,"mouseleave focusout keyup"),t[0]!==this.element[0]&&this._off(t,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&D.each(this.parents,function(e,t){D(t.element).attr("title",t.title),delete i.parents[e]}),this.closing=!0,this._trigger("close",e,{tooltip:n}),this.hiding||(this.closing=!1))},_tooltip:function(e){var t=D("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),i=t.uniqueId().attr("id");return D("<div>").addClass("ui-tooltip-content").appendTo(t),t.appendTo(this.document[0].body),this.tooltips[i]=e,t},_find:function(e){var t=e.data("ui-tooltip-id");return t?D("#"+t):D()},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var n=this;D.each(this.tooltips,function(e,t){var i=D.Event("blur");i.target=i.currentTarget=t[0],n.close(i,!0),D("#"+e).remove(),t.data("ui-tooltip-title")&&(t.attr("title")||t.attr("title",t.data("ui-tooltip-title")),t.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}})}),function(){var na,oa="Expected a function",ra="__lodash_hash_undefined__",aa="__lodash_placeholder__",sa=9007199254740991,la=NaN,ca=4294967295,ua=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],da="[object Arguments]",ha="[object Array]",pa="[object Boolean]",fa="[object Date]",ga="[object Error]",ma="[object Function]",va="[object GeneratorFunction]",ya="[object Map]",ba="[object Number]",wa="[object Object]",Ca="[object Promise]",_a="[object RegExp]",Aa="[object Set]",Ea="[object String]",xa="[object Symbol]",Sa="[object WeakMap]",Ta="[object ArrayBuffer]",Da="[object DataView]",ka="[object Float32Array]",Ra="[object Float64Array]",Oa="[object Int8Array]",Na="[object Int16Array]",Fa="[object Int32Array]",Ma="[object Uint8Array]",Pa="[object Uint8ClampedArray]",Ia="[object Uint16Array]",La="[object Uint32Array]",Ga=/\b__p \+= '';/g,$a=/\b(__p \+=) '' \+/g,Ba=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ja=/&(?:amp|lt|gt|quot|#39);/g,Wa=/[&<>"']/g,Ha=RegExp(ja.source),za=RegExp(Wa.source),Va=/<%-([\s\S]+?)%>/g,Ua=/<%([\s\S]+?)%>/g,Ya=/<%=([\s\S]+?)%>/g,qa=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Qa=/^\w*$/,Ka=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Xa=/[\\^$.*+?()[\]{}|]/g,Ja=RegExp(Xa.source),Za=/^\s+|\s+$/g,es=/^\s+/,ts=/\s+$/,is=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ns=/\{\n\/\* \[wrapped with (.+)\] \*/,os=/,? & /,rs=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,as=/\\(\\)?/g,ss=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ls=/\w*$/,cs=/^[-+]0x[0-9a-f]+$/i,us=/^0b[01]+$/i,ds=/^\[object .+?Constructor\]$/,hs=/^0o[0-7]+$/i,ps=/^(?:0|[1-9]\d*)$/,fs=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,gs=/($^)/,ms=/['\n\r\u2028\u2029\\]/g,e="\\ud800-\\udfff",t="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",i="\\u2700-\\u27bf",n="a-z\\xdf-\\xf6\\xf8-\\xff",o="A-Z\\xc0-\\xd6\\xd8-\\xde",r="\\ufe0e\\ufe0f",a="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",s="["+e+"]",l="["+a+"]",c="["+t+"]",u="\\d+",d="["+i+"]",h="["+n+"]",p="[^"+e+a+u+i+n+o+"]",f="\\ud83c[\\udffb-\\udfff]",g="[^"+e+"]",m="(?:\\ud83c[\\udde6-\\uddff]){2}",v="[\\ud800-\\udbff][\\udc00-\\udfff]",y="["+o+"]",b="(?:"+h+"|"+p+")",w="(?:"+y+"|"+p+")",C="(?:['‚Äô](?:d|ll|m|re|s|t|ve))?",_="(?:['‚Äô](?:D|LL|M|RE|S|T|VE))?",A="(?:"+c+"|"+f+")"+"?",E="["+r+"]?",x=E+A+("(?:\\u200d(?:"+[g,m,v].join("|")+")"+E+A+")*"),S="(?:"+[d,m,v].join("|")+")"+x,T="(?:"+[g+c+"?",c,m,v,s].join("|")+")",vs=RegExp("['‚Äô]","g"),ys=RegExp(c,"g"),D=RegExp(f+"(?="+f+")|"+T+x,"g"),bs=RegExp([y+"?"+h+"+"+C+"(?="+[l,y,"$"].join("|")+")",w+"+"+_+"(?="+[l,y+b,"$"].join("|")+")",y+"?"+b+"+"+C,y+"+"+_,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",u,S].join("|"),"g"),k=RegExp("[\\u200d"+e+t+r+"]"),ws=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Cs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],_s=-1,As={};As[ka]=As[Ra]=As[Oa]=As[Na]=As[Fa]=As[Ma]=As[Pa]=As[Ia]=As[La]=!0,As[da]=As[ha]=As[Ta]=As[pa]=As[Da]=As[fa]=As[ga]=As[ma]=As[ya]=As[ba]=As[wa]=As[_a]=As[Aa]=As[Ea]=As[Sa]=!1;var Es={};Es[da]=Es[ha]=Es[Ta]=Es[Da]=Es[pa]=Es[fa]=Es[ka]=Es[Ra]=Es[Oa]=Es[Na]=Es[Fa]=Es[ya]=Es[ba]=Es[wa]=Es[_a]=Es[Aa]=Es[Ea]=Es[xa]=Es[Ma]=Es[Pa]=Es[Ia]=Es[La]=!0,Es[ga]=Es[ma]=Es[Sa]=!1;var R={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},xs=parseFloat,Ss=parseInt,O="object"==typeof global&&global&&global.Object===Object&&global,N="object"==typeof self&&self&&self.Object===Object&&self,Ts=O||N||Function("return this")(),F="object"==typeof exports&&exports&&!exports.nodeType&&exports,M=F&&"object"==typeof module&&module&&!module.nodeType&&module,Ds=M&&M.exports===F,P=Ds&&O.process,I=function(){try{var e=M&&M.require&&M.require("util").types;return e||P&&P.binding&&P.binding("util")}catch(e){}}(),ks=I&&I.isArrayBuffer,Rs=I&&I.isDate,Os=I&&I.isMap,Ns=I&&I.isRegExp,Fs=I&&I.isSet,Ms=I&&I.isTypedArray;function Ps(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function Is(e,t,i,n){for(var o=-1,r=null==e?0:e.length;++o<r;){var a=e[o];t(n,a,i(a),e)}return n}function Ls(e,t){for(var i=-1,n=null==e?0:e.length;++i<n&&!1!==t(e[i],i,e););return e}function Gs(e,t){for(var i=null==e?0:e.length;i--&&!1!==t(e[i],i,e););return e}function $s(e,t){for(var i=-1,n=null==e?0:e.length;++i<n;)if(!t(e[i],i,e))return!1;return!0}function Bs(e,t){for(var i=-1,n=null==e?0:e.length,o=0,r=[];++i<n;){var a=e[i];t(a,i,e)&&(r[o++]=a)}return r}function js(e,t){return!!(null==e?0:e.length)&&-1<Ks(e,t,0)}function Ws(e,t,i){for(var n=-1,o=null==e?0:e.length;++n<o;)if(i(t,e[n]))return!0;return!1}function Hs(e,t){for(var i=-1,n=null==e?0:e.length,o=Array(n);++i<n;)o[i]=t(e[i],i,e);return o}function zs(e,t){for(var i=-1,n=t.length,o=e.length;++i<n;)e[o+i]=t[i];return e}function Vs(e,t,i,n){var o=-1,r=null==e?0:e.length;for(n&&r&&(i=e[++o]);++o<r;)i=t(i,e[o],o,e);return i}function Us(e,t,i,n){var o=null==e?0:e.length;for(n&&o&&(i=e[--o]);o--;)i=t(i,e[o],o,e);return i}function Ys(e,t){for(var i=-1,n=null==e?0:e.length;++i<n;)if(t(e[i],i,e))return!0;return!1}var L=el("length");function qs(e,n,t){var o;return t(e,function(e,t,i){if(n(e,t,i))return o=t,!1}),o}function Qs(e,t,i,n){for(var o=e.length,r=i+(n?1:-1);n?r--:++r<o;)if(t(e[r],r,e))return r;return-1}function Ks(e,t,i){return t==t?function(e,t,i){var n=i-1,o=e.length;for(;++n<o;)if(e[n]===t)return n;return-1}(e,t,i):Qs(e,Js,i)}function Xs(e,t,i,n){for(var o=i-1,r=e.length;++o<r;)if(n(e[o],t))return o;return-1}function Js(e){return e!=e}function Zs(e,t){var i=null==e?0:e.length;return i?il(e,t)/i:la}function el(t){return function(e){return null==e?na:e[t]}}function G(t){return function(e){return null==t?na:t[e]}}function tl(e,n,o,r,t){return t(e,function(e,t,i){o=r?(r=!1,e):n(o,e,t,i)}),o}function il(e,t){for(var i,n=-1,o=e.length;++n<o;){var r=t(e[n]);r!==na&&(i=i===na?r:i+r)}return i}function nl(e,t){for(var i=-1,n=Array(e);++i<e;)n[i]=t(i);return n}function ol(t){return function(e){return t(e)}}function rl(t,e){return Hs(e,function(e){return t[e]})}function al(e,t){return e.has(t)}function sl(e,t){for(var i=-1,n=e.length;++i<n&&-1<Ks(t,e[i],0););return i}function ll(e,t){for(var i=e.length;i--&&-1<Ks(t,e[i],0););return i}var cl=G({"√Ä":"A","√Å":"A","√Ç":"A","√É":"A","√Ñ":"A","√Ö":"A","√†":"a","√°":"a","√¢":"a","√£":"a","√§":"a","√•":"a","√á":"C","√ß":"c","√ê":"D","√∞":"d","√à":"E","√â":"E","√ä":"E","√ã":"E","√®":"e","√©":"e","√™":"e","√´":"e","√å":"I","√ç":"I","√é":"I","√è":"I","√¨":"i","√≠":"i","√Æ":"i","√Ø":"i","√ë":"N","√±":"n","√í":"O","√ì":"O","√î":"O","√ï":"O","√ñ":"O","√ò":"O","√≤":"o","√≥":"o","√¥":"o","√µ":"o","√∂":"o","√∏":"o","√ô":"U","√ö":"U","√õ":"U","√ú":"U","√π":"u","√∫":"u","√ª":"u","√º":"u","√ù":"Y","√Ω":"y","√ø":"y","√Ü":"Ae","√¶":"ae","√û":"Th","√æ":"th","√ü":"ss","ƒÄ":"A","ƒÇ":"A","ƒÑ":"A","ƒÅ":"a","ƒÉ":"a","ƒÖ":"a","ƒÜ":"C","ƒà":"C","ƒä":"C","ƒå":"C","ƒá":"c","ƒâ":"c","ƒã":"c","ƒç":"c","ƒé":"D","ƒê":"D","ƒè":"d","ƒë":"d","ƒí":"E","ƒî":"E","ƒñ":"E","ƒò":"E","ƒö":"E","ƒì":"e","ƒï":"e","ƒó":"e","ƒô":"e","ƒõ":"e","ƒú":"G","ƒû":"G","ƒ†":"G","ƒ¢":"G","ƒù":"g","ƒü":"g","ƒ°":"g","ƒ£":"g","ƒ§":"H","ƒ¶":"H","ƒ•":"h","ƒß":"h","ƒ®":"I","ƒ™":"I","ƒ¨":"I","ƒÆ":"I","ƒ∞":"I","ƒ©":"i","ƒ´":"i","ƒ≠":"i","ƒØ":"i","ƒ±":"i","ƒ¥":"J","ƒµ":"j","ƒ∂":"K","ƒ∑":"k","ƒ∏":"k","ƒπ":"L","ƒª":"L","ƒΩ":"L","ƒø":"L","≈Å":"L","ƒ∫":"l","ƒº":"l","ƒæ":"l","≈Ä":"l","≈Ç":"l","≈É":"N","≈Ö":"N","≈á":"N","≈ä":"N","≈Ñ":"n","≈Ü":"n","≈à":"n","≈ã":"n","≈å":"O","≈é":"O","≈ê":"O","≈ç":"o","≈è":"o","≈ë":"o","≈î":"R","≈ñ":"R","≈ò":"R","≈ï":"r","≈ó":"r","≈ô":"r","≈ö":"S","≈ú":"S","≈û":"S","≈†":"S","≈õ":"s","≈ù":"s","≈ü":"s","≈°":"s","≈¢":"T","≈§":"T","≈¶":"T","≈£":"t","≈•":"t","≈ß":"t","≈®":"U","≈™":"U","≈¨":"U","≈Æ":"U","≈∞":"U","≈≤":"U","≈©":"u","≈´":"u","≈≠":"u","≈Ø":"u","≈±":"u","≈≥":"u","≈¥":"W","≈µ":"w","≈∂":"Y","≈∑":"y","≈∏":"Y","≈π":"Z","≈ª":"Z","≈Ω":"Z","≈∫":"z","≈º":"z","≈æ":"z","ƒ≤":"IJ","ƒ≥":"ij","≈í":"Oe","≈ì":"oe","≈â":"'n","≈ø":"s"}),ul=G({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function dl(e){return"\\"+R[e]}function hl(e){return k.test(e)}function pl(e){var i=-1,n=Array(e.size);return e.forEach(function(e,t){n[++i]=[t,e]}),n}function fl(t,i){return function(e){return t(i(e))}}function gl(e,t){for(var i=-1,n=e.length,o=0,r=[];++i<n;){var a=e[i];a!==t&&a!==aa||(e[i]=aa,r[o++]=i)}return r}function ml(e){var t=-1,i=Array(e.size);return e.forEach(function(e){i[++t]=e}),i}function vl(e){return hl(e)?function(e){var t=D.lastIndex=0;for(;D.test(e);)++t;return t}(e):L(e)}function yl(e){return hl(e)?function(e){return e.match(D)||[]}(e):function(e){return e.split("")}(e)}var bl=G({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var wl=function e(t){var i,x=(t=null==t?Ts:wl.defaults(Ts.Object(),t,wl.pick(Ts,Cs))).Array,n=t.Date,o=t.Error,m=t.Function,r=t.Math,g=t.Object,v=t.RegExp,u=t.String,y=t.TypeError,a=x.prototype,s=m.prototype,d=g.prototype,l=t["__core-js_shared__"],c=s.toString,w=d.hasOwnProperty,h=0,p=(i=/[^.]+$/.exec(l&&l.keys&&l.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",f=d.toString,b=c.call(g),C=Ts._,_=v("^"+c.call(w).replace(Xa,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),A=Ds?t.Buffer:na,E=t.Symbol,S=t.Uint8Array,T=A?A.allocUnsafe:na,D=fl(g.getPrototypeOf,g),k=g.create,R=d.propertyIsEnumerable,O=a.splice,N=E?E.isConcatSpreadable:na,F=E?E.iterator:na,M=E?E.toStringTag:na,P=function(){try{var e=Bi(g,"defineProperty");return e({},"",{}),e}catch(e){}}(),I=t.clearTimeout!==Ts.clearTimeout&&t.clearTimeout,L=n&&n.now!==Ts.Date.now&&n.now,G=t.setTimeout!==Ts.setTimeout&&t.setTimeout,$=r.ceil,B=r.floor,j=g.getOwnPropertySymbols,W=A?A.isBuffer:na,H=t.isFinite,z=a.join,V=fl(g.keys,g),U=r.max,Y=r.min,q=n.now,Q=t.parseInt,K=r.random,X=a.reverse,J=Bi(t,"DataView"),Z=Bi(t,"Map"),ee=Bi(t,"Promise"),te=Bi(t,"Set"),ie=Bi(t,"WeakMap"),ne=Bi(g,"create"),oe=ie&&new ie,re={},ae=gn(J),se=gn(Z),le=gn(ee),ce=gn(te),ue=gn(ie),de=E?E.prototype:na,he=de?de.valueOf:na,pe=de?de.toString:na;function fe(e){if(Fo(e)&&!_o(e)&&!(e instanceof be)){if(e instanceof ye)return e;if(w.call(e,"__wrapped__"))return mn(e)}return new ye(e)}var ge=function(e){if(!No(e))return{};if(k)return k(e);me.prototype=e;var t=new me;return me.prototype=na,t};function me(){}function ve(){}function ye(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=na}function be(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ca,this.__views__=[]}function we(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function Ce(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function _e(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function Ae(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new _e;++t<i;)this.add(e[t])}function Ee(e){var t=this.__data__=new Ce(e);this.size=t.size}function xe(e,t){var i=_o(e),n=!i&&Co(e),o=!i&&!n&&So(e),r=!i&&!n&&!o&&jo(e),a=i||n||o||r,s=a?nl(e.length,u):[],l=s.length;for(var c in e)!t&&!w.call(e,c)||a&&("length"==c||o&&("offset"==c||"parent"==c)||r&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Yi(c,l))||s.push(c);return s}function Se(e){var t=e.length;return t?e[At(0,t-1)]:na}function Te(e,t){return un(oi(e),Ie(t,0,e.length))}function De(e){return un(oi(e))}function ke(e,t,i){(i===na||yo(e[t],i))&&(i!==na||t in e)||Me(e,t,i)}function Re(e,t,i){var n=e[t];w.call(e,t)&&yo(n,i)&&(i!==na||t in e)||Me(e,t,i)}function Oe(e,t){for(var i=e.length;i--;)if(yo(e[i][0],t))return i;return-1}function Ne(e,n,o,r){return je(e,function(e,t,i){n(r,e,o(e),i)}),r}function Fe(e,t){return e&&ri(t,cr(t),e)}function Me(e,t,i){"__proto__"==t&&P?P(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function Pe(e,t){for(var i=-1,n=t.length,o=x(n),r=null==e;++i<n;)o[i]=r?na:or(e,t[i]);return o}function Ie(e,t,i){return e==e&&(i!==na&&(e=e<=i?e:i),t!==na&&(e=t<=e?e:t)),e}function Le(i,n,o,e,t,r){var a,s=1&n,l=2&n,c=4&n;if(o&&(a=t?o(i,e,t,r):o(i)),a!==na)return a;if(!No(i))return i;var u=_o(i);if(u){if(a=function(e){var t=e.length,i=new e.constructor(t);t&&"string"==typeof e[0]&&w.call(e,"index")&&(i.index=e.index,i.input=e.input);return i}(i),!s)return oi(i,a)}else{var d=Hi(i),h=d==ma||d==va;if(So(i))return Jt(i,s);if(d==wa||d==da||h&&!t){if(a=l||h?{}:Vi(i),!s)return l?function(e,t){return ri(e,Wi(e),t)}(i,function(e,t){return e&&ri(t,ur(t),e)}(a,i)):function(e,t){return ri(e,ji(e),t)}(i,Fe(a,i))}else{if(!Es[d])return t?i:{};a=function(e,t,i){var n=e.constructor;switch(t){case Ta:return Zt(e);case pa:case fa:return new n(+e);case Da:return function(e,t){var i=t?Zt(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}(e,i);case ka:case Ra:case Oa:case Na:case Fa:case Ma:case Pa:case Ia:case La:return ei(e,i);case ya:return new n;case ba:case Ea:return new n(e);case _a:return function(e){var t=new e.constructor(e.source,ls.exec(e));return t.lastIndex=e.lastIndex,t}(e);case Aa:return new n;case xa:return function(e){return he?g(he.call(e)):{}}(e)}}(i,d,s)}}var p=(r=r||new Ee).get(i);if(p)return p;r.set(i,a),Go(i)?i.forEach(function(e){a.add(Le(e,n,o,e,i,r))}):Mo(i)&&i.forEach(function(e,t){a.set(t,Le(e,n,o,t,i,r))});var f=u?na:(c?l?Fi:Ni:l?ur:cr)(i);return Ls(f||i,function(e,t){f&&(e=i[t=e]),Re(a,t,Le(e,n,o,t,i,r))}),a}function Ge(e,t,i){var n=i.length;if(null==e)return!n;for(e=g(e);n--;){var o=i[n],r=t[o],a=e[o];if(a===na&&!(o in e)||!r(a))return!1}return!0}function $e(e,t,i){if("function"!=typeof e)throw new y(oa);return an(function(){e.apply(na,i)},t)}function Be(e,t,i,n){var o=-1,r=js,a=!0,s=e.length,l=[],c=t.length;if(!s)return l;i&&(t=Hs(t,ol(i))),n?(r=Ws,a=!1):200<=t.length&&(r=al,a=!1,t=new Ae(t));e:for(;++o<s;){var u=e[o],d=null==i?u:i(u);if(u=n||0!==u?u:0,a&&d==d){for(var h=c;h--;)if(t[h]===d)continue e;l.push(u)}else r(t,d,n)||l.push(u)}return l}fe.templateSettings={escape:Va,evaluate:Ua,interpolate:Ya,variable:"",imports:{_:fe}},(fe.prototype=ve.prototype).constructor=fe,(ye.prototype=ge(ve.prototype)).constructor=ye,(be.prototype=ge(ve.prototype)).constructor=be,we.prototype.clear=function(){this.__data__=ne?ne(null):{},this.size=0},we.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},we.prototype.get=function(e){var t=this.__data__;if(ne){var i=t[e];return i===ra?na:i}return w.call(t,e)?t[e]:na},we.prototype.has=function(e){var t=this.__data__;return ne?t[e]!==na:w.call(t,e)},we.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=ne&&t===na?ra:t,this},Ce.prototype.clear=function(){this.__data__=[],this.size=0},Ce.prototype.delete=function(e){var t=this.__data__,i=Oe(t,e);return!(i<0)&&(i==t.length-1?t.pop():O.call(t,i,1),--this.size,!0)},Ce.prototype.get=function(e){var t=this.__data__,i=Oe(t,e);return i<0?na:t[i][1]},Ce.prototype.has=function(e){return-1<Oe(this.__data__,e)},Ce.prototype.set=function(e,t){var i=this.__data__,n=Oe(i,e);return n<0?(++this.size,i.push([e,t])):i[n][1]=t,this},_e.prototype.clear=function(){this.size=0,this.__data__={hash:new we,map:new(Z||Ce),string:new we}},_e.prototype.delete=function(e){var t=Gi(this,e).delete(e);return this.size-=t?1:0,t},_e.prototype.get=function(e){return Gi(this,e).get(e)},_e.prototype.has=function(e){return Gi(this,e).has(e)},_e.prototype.set=function(e,t){var i=Gi(this,e),n=i.size;return i.set(e,t),this.size+=i.size==n?0:1,this},Ae.prototype.add=Ae.prototype.push=function(e){return this.__data__.set(e,ra),this},Ae.prototype.has=function(e){return this.__data__.has(e)},Ee.prototype.clear=function(){this.__data__=new Ce,this.size=0},Ee.prototype.delete=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i},Ee.prototype.get=function(e){return this.__data__.get(e)},Ee.prototype.has=function(e){return this.__data__.has(e)},Ee.prototype.set=function(e,t){var i=this.__data__;if(i instanceof Ce){var n=i.__data__;if(!Z||n.length<199)return n.push([e,t]),this.size=++i.size,this;i=this.__data__=new _e(n)}return i.set(e,t),this.size=i.size,this};var je=li(Qe),We=li(Ke,!0);function He(e,n){var o=!0;return je(e,function(e,t,i){return o=!!n(e,t,i)}),o}function ze(e,t,i){for(var n=-1,o=e.length;++n<o;){var r=e[n],a=t(r);if(null!=a&&(s===na?a==a&&!Bo(a):i(a,s)))var s=a,l=r}return l}function Ve(e,n){var o=[];return je(e,function(e,t,i){n(e,t,i)&&o.push(e)}),o}function Ue(e,t,i,n,o){var r=-1,a=e.length;for(i=i||Ui,o=o||[];++r<a;){var s=e[r];0<t&&i(s)?1<t?Ue(s,t-1,i,n,o):zs(o,s):n||(o[o.length]=s)}return o}var Ye=ci(),qe=ci(!0);function Qe(e,t){return e&&Ye(e,t,cr)}function Ke(e,t){return e&&qe(e,t,cr)}function Xe(t,e){return Bs(e,function(e){return ko(t[e])})}function Je(e,t){for(var i=0,n=(t=qt(t,e)).length;null!=e&&i<n;)e=e[fn(t[i++])];return i&&i==n?e:na}function Ze(e,t,i){var n=t(e);return _o(e)?n:zs(n,i(e))}function et(e){return null==e?e===na?"[object Undefined]":"[object Null]":M&&M in g(e)?function(e){var t=w.call(e,M),i=e[M];try{e[M]=na;var n=!0}catch(e){}var o=f.call(e);n&&(t?e[M]=i:delete e[M]);return o}(e):function(e){return f.call(e)}(e)}function tt(e,t){return t<e}function it(e,t){return null!=e&&w.call(e,t)}function nt(e,t){return null!=e&&t in g(e)}function ot(e,t,i){for(var n=i?Ws:js,o=e[0].length,r=e.length,a=r,s=x(r),l=1/0,c=[];a--;){var u=e[a];a&&t&&(u=Hs(u,ol(t))),l=Y(u.length,l),s[a]=!i&&(t||120<=o&&120<=u.length)?new Ae(a&&u):na}u=e[0];var d=-1,h=s[0];e:for(;++d<o&&c.length<l;){var p=u[d],f=t?t(p):p;if(p=i||0!==p?p:0,!(h?al(h,f):n(c,f,i))){for(a=r;--a;){var g=s[a];if(!(g?al(g,f):n(e[a],f,i)))continue e}h&&h.push(f),c.push(p)}}return c}function rt(e,t,i){var n=null==(e=nn(e,t=qt(t,e)))?e:e[fn(Tn(t))];return null==n?na:Ps(n,e,i)}function at(e){return Fo(e)&&et(e)==da}function st(e,t,i,n,o){return e===t||(null==e||null==t||!Fo(e)&&!Fo(t)?e!=e&&t!=t:function(e,t,i,n,o,r){var a=_o(e),s=_o(t),l=a?ha:Hi(e),c=s?ha:Hi(t),u=(l=l==da?wa:l)==wa,d=(c=c==da?wa:c)==wa,h=l==c;if(h&&So(e)){if(!So(t))return!1;u=!(a=!0)}if(h&&!u)return r=r||new Ee,a||jo(e)?Ri(e,t,i,n,o,r):function(e,t,i,n,o,r,a){switch(i){case Da:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ta:return!(e.byteLength!=t.byteLength||!r(new S(e),new S(t)));case pa:case fa:case ba:return yo(+e,+t);case ga:return e.name==t.name&&e.message==t.message;case _a:case Ea:return e==t+"";case ya:var s=pl;case Aa:var l=1&n;if(s=s||ml,e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;n|=2,a.set(e,t);var u=Ri(s(e),s(t),n,o,r,a);return a.delete(e),u;case xa:if(he)return he.call(e)==he.call(t)}return!1}(e,t,l,i,n,o,r);if(!(1&i)){var p=u&&w.call(e,"__wrapped__"),f=d&&w.call(t,"__wrapped__");if(p||f){var g=p?e.value():e,m=f?t.value():t;return r=r||new Ee,o(g,m,i,n,r)}}return h&&(r=r||new Ee,function(e,t,i,n,o,r){var a=1&i,s=Ni(e),l=s.length,c=Ni(t).length;if(l!=c&&!a)return!1;var u=l;for(;u--;){var d=s[u];if(!(a?d in t:w.call(t,d)))return!1}var h=r.get(e);if(h&&r.get(t))return h==t;var p=!0;r.set(e,t),r.set(t,e);var f=a;for(;++u<l;){d=s[u];var g=e[d],m=t[d];if(n)var v=a?n(m,g,d,t,e,r):n(g,m,d,e,t,r);if(!(v===na?g===m||o(g,m,i,n,r):v)){p=!1;break}f=f||"constructor"==d}if(p&&!f){var y=e.constructor,b=t.constructor;y!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(p=!1)}return r.delete(e),r.delete(t),p}(e,t,i,n,o,r))}(e,t,i,n,st,o))}function lt(e,t,i,n){var o=i.length,r=o,a=!n;if(null==e)return!r;for(e=g(e);o--;){var s=i[o];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<r;){var l=(s=i[o])[0],c=e[l],u=s[1];if(a&&s[2]){if(c===na&&!(l in e))return!1}else{var d=new Ee;if(n)var h=n(c,u,l,e,t,d);if(!(h===na?st(u,c,3,n,d):h))return!1}}return!0}function ct(e){return!(!No(e)||function(e){return!!p&&p in e}(e))&&(ko(e)?_:ds).test(gn(e))}function ut(e){return"function"==typeof e?e:null==e?Pr:"object"==typeof e?_o(e)?mt(e[0],e[1]):gt(e):zr(e)}function dt(e){if(!Ji(e))return V(e);var t=[];for(var i in g(e))w.call(e,i)&&"constructor"!=i&&t.push(i);return t}function ht(e){if(!No(e))return function(e){var t=[];if(null!=e)for(var i in g(e))t.push(i);return t}(e);var t=Ji(e),i=[];for(var n in e)("constructor"!=n||!t&&w.call(e,n))&&i.push(n);return i}function pt(e,t){return e<t}function ft(e,n){var o=-1,r=Eo(e)?x(e.length):[];return je(e,function(e,t,i){r[++o]=n(e,t,i)}),r}function gt(t){var i=$i(t);return 1==i.length&&i[0][2]?en(i[0][0],i[0][1]):function(e){return e===t||lt(e,t,i)}}function mt(i,n){return Qi(i)&&Zi(n)?en(fn(i),n):function(e){var t=or(e,i);return t===na&&t===n?rr(e,i):st(n,t,3)}}function vt(n,o,r,a,s){n!==o&&Ye(o,function(e,t){if(s=s||new Ee,No(e))!function(e,t,i,n,o,r,a){var s=on(e,i),l=on(t,i),c=a.get(l);if(c)return ke(e,i,c);var u=r?r(s,l,i+"",e,t,a):na,d=u===na;if(d){var h=_o(l),p=!h&&So(l),f=!h&&!p&&jo(l);u=l,h||p||f?u=_o(s)?s:xo(s)?oi(s):p?Jt(l,!(d=!1)):f?ei(l,!(d=!1)):[]:Io(l)||Co(l)?Co(u=s)?u=Qo(s):No(s)&&!ko(s)||(u=Vi(l)):d=!1}d&&(a.set(l,u),o(u,l,n,r,a),a.delete(l));ke(e,i,u)}(n,o,t,r,vt,a,s);else{var i=a?a(on(n,t),e,t+"",n,o,s):na;i===na&&(i=e),ke(n,t,i)}},ur)}function yt(e,t){var i=e.length;if(i)return Yi(t+=t<0?i:0,i)?e[t]:na}function bt(e,n,i){var o=-1;return n=Hs(n.length?n:[Pr],ol(Li())),function(e,t){var i=e.length;for(e.sort(t);i--;)e[i]=e[i].value;return e}(ft(e,function(t,e,i){return{criteria:Hs(n,function(e){return e(t)}),index:++o,value:t}}),function(e,t){return function(e,t,i){var n=-1,o=e.criteria,r=t.criteria,a=o.length,s=i.length;for(;++n<a;){var l=ti(o[n],r[n]);if(l){if(s<=n)return l;var c=i[n];return l*("desc"==c?-1:1)}}return e.index-t.index}(e,t,i)})}function wt(e,t,i){for(var n=-1,o=t.length,r={};++n<o;){var a=t[n],s=Je(e,a);i(s,a)&&Dt(r,qt(a,e),s)}return r}function Ct(e,t,i,n){var o=n?Xs:Ks,r=-1,a=t.length,s=e;for(e===t&&(t=oi(t)),i&&(s=Hs(e,ol(i)));++r<a;)for(var l=0,c=t[r],u=i?i(c):c;-1<(l=o(s,u,l,n));)s!==e&&O.call(s,l,1),O.call(e,l,1);return e}function _t(e,t){for(var i=e?t.length:0,n=i-1;i--;){var o=t[i];if(i==n||o!==r){var r=o;Yi(o)?O.call(e,o,1):Bt(e,o)}}return e}function At(e,t){return e+B(K()*(t-e+1))}function Et(e,t){var i="";if(!e||t<1||sa<t)return i;for(;t%2&&(i+=e),(t=B(t/2))&&(e+=e),t;);return i}function xt(e,t){return sn(tn(e,t,Pr),e+"")}function St(e){return Se(yr(e))}function Tt(e,t){var i=yr(e);return un(i,Ie(t,0,i.length))}function Dt(e,t,i,n){if(!No(e))return e;for(var o=-1,r=(t=qt(t,e)).length,a=r-1,s=e;null!=s&&++o<r;){var l=fn(t[o]),c=i;if(o!=a){var u=s[l];(c=n?n(u,l,s):na)===na&&(c=No(u)?u:Yi(t[o+1])?[]:{})}Re(s,l,c),s=s[l]}return e}var kt=oe?function(e,t){return oe.set(e,t),e}:Pr,Rt=P?function(e,t){return P(e,"toString",{configurable:!0,enumerable:!1,value:Nr(t),writable:!0})}:Pr;function Ot(e){return un(yr(e))}function Nt(e,t,i){var n=-1,o=e.length;t<0&&(t=o<-t?0:o+t),(i=o<i?o:i)<0&&(i+=o),o=i<t?0:i-t>>>0,t>>>=0;for(var r=x(o);++n<o;)r[n]=e[n+t];return r}function Ft(e,n){var o;return je(e,function(e,t,i){return!(o=n(e,t,i))}),!!o}function Mt(e,t,i){var n=0,o=null==e?n:e.length;if("number"==typeof t&&t==t&&o<=2147483647){for(;n<o;){var r=n+o>>>1,a=e[r];null!==a&&!Bo(a)&&(i?a<=t:a<t)?n=1+r:o=r}return o}return Pt(e,t,Pr,i)}function Pt(e,t,i,n){t=i(t);for(var o=0,r=null==e?0:e.length,a=t!=t,s=null===t,l=Bo(t),c=t===na;o<r;){var u=B((o+r)/2),d=i(e[u]),h=d!==na,p=null===d,f=d==d,g=Bo(d);if(a)var m=n||f;else m=c?f&&(n||h):s?f&&h&&(n||!p):l?f&&h&&!p&&(n||!g):!p&&!g&&(n?d<=t:d<t);m?o=u+1:r=u}return Y(r,4294967294)}function It(e,t){for(var i=-1,n=e.length,o=0,r=[];++i<n;){var a=e[i],s=t?t(a):a;if(!i||!yo(s,l)){var l=s;r[o++]=0===a?0:a}}return r}function Lt(e){return"number"==typeof e?e:Bo(e)?la:+e}function Gt(e){if("string"==typeof e)return e;if(_o(e))return Hs(e,Gt)+"";if(Bo(e))return pe?pe.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function $t(e,t,i){var n=-1,o=js,r=e.length,a=!0,s=[],l=s;if(i)a=!1,o=Ws;else if(200<=r){var c=t?null:Ei(e);if(c)return ml(c);a=!1,o=al,l=new Ae}else l=t?[]:s;e:for(;++n<r;){var u=e[n],d=t?t(u):u;if(u=i||0!==u?u:0,a&&d==d){for(var h=l.length;h--;)if(l[h]===d)continue e;t&&l.push(d),s.push(u)}else o(l,d,i)||(l!==s&&l.push(d),s.push(u))}return s}function Bt(e,t){return null==(e=nn(e,t=qt(t,e)))||delete e[fn(Tn(t))]}function jt(e,t,i,n){return Dt(e,t,i(Je(e,t)),n)}function Wt(e,t,i,n){for(var o=e.length,r=n?o:-1;(n?r--:++r<o)&&t(e[r],r,e););return i?Nt(e,n?0:r,n?r+1:o):Nt(e,n?r+1:0,n?o:r)}function Ht(e,t){var i=e;return i instanceof be&&(i=i.value()),Vs(t,function(e,t){return t.func.apply(t.thisArg,zs([e],t.args))},i)}function zt(e,t,i){var n=e.length;if(n<2)return n?$t(e[0]):[];for(var o=-1,r=x(n);++o<n;)for(var a=e[o],s=-1;++s<n;)s!=o&&(r[o]=Be(r[o]||a,e[s],t,i));return $t(Ue(r,1),t,i)}function Vt(e,t,i){for(var n=-1,o=e.length,r=t.length,a={};++n<o;){var s=n<r?t[n]:na;i(a,e[n],s)}return a}function Ut(e){return xo(e)?e:[]}function Yt(e){return"function"==typeof e?e:Pr}function qt(e,t){return _o(e)?e:Qi(e,t)?[e]:pn(Ko(e))}var Qt=xt;function Kt(e,t,i){var n=e.length;return i=i===na?n:i,!t&&n<=i?e:Nt(e,t,i)}var Xt=I||function(e){return Ts.clearTimeout(e)};function Jt(e,t){if(t)return e.slice();var i=e.length,n=T?T(i):new e.constructor(i);return e.copy(n),n}function Zt(e){var t=new e.constructor(e.byteLength);return new S(t).set(new S(e)),t}function ei(e,t){var i=t?Zt(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}function ti(e,t){if(e!==t){var i=e!==na,n=null===e,o=e==e,r=Bo(e),a=t!==na,s=null===t,l=t==t,c=Bo(t);if(!s&&!c&&!r&&t<e||r&&a&&l&&!s&&!c||n&&a&&l||!i&&l||!o)return 1;if(!n&&!r&&!c&&e<t||c&&i&&o&&!n&&!r||s&&i&&o||!a&&o||!l)return-1}return 0}function ii(e,t,i,n){for(var o=-1,r=e.length,a=i.length,s=-1,l=t.length,c=U(r-a,0),u=x(l+c),d=!n;++s<l;)u[s]=t[s];for(;++o<a;)(d||o<r)&&(u[i[o]]=e[o]);for(;c--;)u[s++]=e[o++];return u}function ni(e,t,i,n){for(var o=-1,r=e.length,a=-1,s=i.length,l=-1,c=t.length,u=U(r-s,0),d=x(u+c),h=!n;++o<u;)d[o]=e[o];for(var p=o;++l<c;)d[p+l]=t[l];for(;++a<s;)(h||o<r)&&(d[p+i[a]]=e[o++]);return d}function oi(e,t){var i=-1,n=e.length;for(t=t||x(n);++i<n;)t[i]=e[i];return t}function ri(e,t,i,n){var o=!i;i=i||{};for(var r=-1,a=t.length;++r<a;){var s=t[r],l=n?n(i[s],e[s],s,i,e):na;l===na&&(l=e[s]),o?Me(i,s,l):Re(i,s,l)}return i}function ai(o,r){return function(e,t){var i=_o(e)?Is:Ne,n=r?r():{};return i(e,o,Li(t,2),n)}}function si(s){return xt(function(e,t){var i=-1,n=t.length,o=1<n?t[n-1]:na,r=2<n?t[2]:na;for(o=3<s.length&&"function"==typeof o?(n--,o):na,r&&qi(t[0],t[1],r)&&(o=n<3?na:o,n=1),e=g(e);++i<n;){var a=t[i];a&&s(e,a,i,o)}return e})}function li(r,a){return function(e,t){if(null==e)return e;if(!Eo(e))return r(e,t);for(var i=e.length,n=a?i:-1,o=g(e);(a?n--:++n<i)&&!1!==t(o[n],n,o););return e}}function ci(l){return function(e,t,i){for(var n=-1,o=g(e),r=i(e),a=r.length;a--;){var s=r[l?a:++n];if(!1===t(o[s],s,o))break}return e}}function ui(o){return function(e){var t=hl(e=Ko(e))?yl(e):na,i=t?t[0]:e.charAt(0),n=t?Kt(t,1).join(""):e.slice(1);return i[o]()+n}}function di(t){return function(e){return Vs(kr(Cr(e).replace(vs,"")),t,"")}}function hi(n){return function(){var e=arguments;switch(e.length){case 0:return new n;case 1:return new n(e[0]);case 2:return new n(e[0],e[1]);case 3:return new n(e[0],e[1],e[2]);case 4:return new n(e[0],e[1],e[2],e[3]);case 5:return new n(e[0],e[1],e[2],e[3],e[4]);case 6:return new n(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new n(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var t=ge(n.prototype),i=n.apply(t,e);return No(i)?i:t}}function pi(a){return function(e,t,i){var n=g(e);if(!Eo(e)){var o=Li(t,3);e=cr(e),t=function(e){return o(n[e],e,n)}}var r=a(e,t,i);return-1<r?n[o?e[r]:r]:na}}function fi(l){return Oi(function(o){var r=o.length,e=r,t=ye.prototype.thru;for(l&&o.reverse();e--;){var i=o[e];if("function"!=typeof i)throw new y(oa);if(t&&!a&&"wrapper"==Pi(i))var a=new ye([],!0)}for(e=a?e:r;++e<r;){var n=Pi(i=o[e]),s="wrapper"==n?Mi(i):na;a=s&&Ki(s[0])&&424==s[1]&&!s[4].length&&1==s[9]?a[Pi(s[0])].apply(a,s[3]):1==i.length&&Ki(i)?a[n]():a.thru(i)}return function(){var e=arguments,t=e[0];if(a&&1==e.length&&_o(t))return a.plant(t).value();for(var i=0,n=r?o[i].apply(this,e):t;++i<r;)n=o[i].call(this,n);return n}})}function gi(c,u,d,h,p,f,g,m,v,y){var b=128&u,w=1&u,C=2&u,_=24&u,A=512&u,E=C?na:hi(c);return function e(){for(var t=arguments.length,i=x(t),n=t;n--;)i[n]=arguments[n];if(_)var o=Ii(e),r=function(e,t){for(var i=e.length,n=0;i--;)e[i]===t&&++n;return n}(i,o);if(h&&(i=ii(i,h,p,_)),f&&(i=ni(i,f,g,_)),t-=r,_&&t<y){var a=gl(i,o);return _i(c,u,gi,e.placeholder,d,i,a,m,v,y-t)}var s=w?d:this,l=C?s[c]:c;return t=i.length,m?i=function(e,t){for(var i=e.length,n=Y(t.length,i),o=oi(e);n--;){var r=t[n];e[n]=Yi(r,i)?o[r]:na}return e}(i,m):A&&1<t&&i.reverse(),b&&v<t&&(i.length=v),this&&this!==Ts&&this instanceof e&&(l=E||hi(l)),l.apply(s,i)}}function mi(i,n){return function(e,t){return function(e,n,o,r){return Qe(e,function(e,t,i){n(r,o(e),t,i)}),r}(e,i,n(t),{})}}function vi(n,o){return function(e,t){var i;if(e===na&&t===na)return o;if(e!==na&&(i=e),t!==na){if(i===na)return t;t="string"==typeof e||"string"==typeof t?(e=Gt(e),Gt(t)):(e=Lt(e),Lt(t)),i=n(e,t)}return i}}function yi(n){return Oi(function(e){return e=Hs(e,ol(Li())),xt(function(t){var i=this;return n(e,function(e){return Ps(e,i,t)})})})}function bi(e,t){var i=(t=t===na?" ":Gt(t)).length;if(i<2)return i?Et(t,e):t;var n=Et(t,$(e/vl(t)));return hl(t)?Kt(yl(n),0,e).join(""):n.slice(0,e)}function wi(n){return function(e,t,i){return i&&"number"!=typeof i&&qi(e,t,i)&&(t=i=na),e=Vo(e),t===na?(t=e,e=0):t=Vo(t),function(e,t,i,n){for(var o=-1,r=U($((t-e)/(i||1)),0),a=x(r);r--;)a[n?r:++o]=e,e+=i;return a}(e,t,i=i===na?e<t?1:-1:Vo(i),n)}}function Ci(i){return function(e,t){return"string"==typeof e&&"string"==typeof t||(e=qo(e),t=qo(t)),i(e,t)}}function _i(e,t,i,n,o,r,a,s,l,c){var u=8&t;t|=u?32:64,4&(t&=~(u?64:32))||(t&=-4);var d=[e,t,o,u?r:na,u?a:na,u?na:r,u?na:a,s,l,c],h=i.apply(na,d);return Ki(e)&&rn(h,d),h.placeholder=n,ln(h,e,t)}function Ai(e){var n=r[e];return function(e,t){if(e=qo(e),(t=null==t?0:Y(Uo(t),292))&&H(e)){var i=(Ko(e)+"e").split("e");return+((i=(Ko(n(i[0]+"e"+(+i[1]+t)))+"e").split("e"))[0]+"e"+(+i[1]-t))}return n(e)}}var Ei=te&&1/ml(new te([,-0]))[1]==1/0?function(e){return new te(e)}:Br;function xi(i){return function(e){var t=Hi(e);return t==ya?pl(e):t==Aa?function(e){var t=-1,i=Array(e.size);return e.forEach(function(e){i[++t]=[e,e]}),i}(e):function(t,e){return Hs(e,function(e){return[e,t[e]]})}(e,i(e))}}function Si(e,t,i,n,o,r,a,s){var l=2&t;if(!l&&"function"!=typeof e)throw new y(oa);var c=n?n.length:0;if(c||(t&=-97,n=o=na),a=a===na?a:U(Uo(a),0),s=s===na?s:Uo(s),c-=o?o.length:0,64&t){var u=n,d=o;n=o=na}var h=l?na:Mi(e),p=[e,t,i,n,o,u,d,r,a,s];if(h&&function(e,t){var i=e[1],n=t[1],o=i|n,r=o<131,a=128==n&&8==i||128==n&&256==i&&e[7].length<=t[8]||384==n&&t[7].length<=t[8]&&8==i;if(!r&&!a)return;1&n&&(e[2]=t[2],o|=1&i?0:4);var s=t[3];if(s){var l=e[3];e[3]=l?ii(l,s,t[4]):s,e[4]=l?gl(e[3],aa):t[4]}(s=t[5])&&(l=e[5],e[5]=l?ni(l,s,t[6]):s,e[6]=l?gl(e[5],aa):t[6]);(s=t[7])&&(e[7]=s);128&n&&(e[8]=null==e[8]?t[8]:Y(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=o}(p,h),e=p[0],t=p[1],i=p[2],n=p[3],o=p[4],!(s=p[9]=p[9]===na?l?0:e.length:U(p[9]-c,0))&&24&t&&(t&=-25),t&&1!=t)f=8==t||16==t?function(a,s,l){var c=hi(a);return function e(){for(var t=arguments.length,i=x(t),n=t,o=Ii(e);n--;)i[n]=arguments[n];var r=t<3&&i[0]!==o&&i[t-1]!==o?[]:gl(i,o);return(t-=r.length)<l?_i(a,s,gi,e.placeholder,na,i,r,na,na,l-t):Ps(this&&this!==Ts&&this instanceof e?c:a,this,i)}}(e,t,s):32!=t&&33!=t||o.length?gi.apply(na,p):function(s,e,l,c){var u=1&e,d=hi(s);return function e(){for(var t=-1,i=arguments.length,n=-1,o=c.length,r=x(o+i),a=this&&this!==Ts&&this instanceof e?d:s;++n<o;)r[n]=c[n];for(;i--;)r[n++]=arguments[++t];return Ps(a,u?l:this,r)}}(e,t,i,n);else var f=function(t,e,i){var n=1&e,o=hi(t);return function e(){return(this&&this!==Ts&&this instanceof e?o:t).apply(n?i:this,arguments)}}(e,t,i);return ln((h?kt:rn)(f,p),e,t)}function Ti(e,t,i,n){return e===na||yo(e,d[i])&&!w.call(n,i)?t:e}function Di(e,t,i,n,o,r){return No(e)&&No(t)&&(r.set(t,e),vt(e,t,na,Di,r),r.delete(t)),e}function ki(e){return Io(e)?na:e}function Ri(e,t,i,n,o,r){var a=1&i,s=e.length,l=t.length;if(s!=l&&!(a&&s<l))return!1;var c=r.get(e);if(c&&r.get(t))return c==t;var u=-1,d=!0,h=2&i?new Ae:na;for(r.set(e,t),r.set(t,e);++u<s;){var p=e[u],f=t[u];if(n)var g=a?n(f,p,u,t,e,r):n(p,f,u,e,t,r);if(g!==na){if(g)continue;d=!1;break}if(h){if(!Ys(t,function(e,t){if(!al(h,t)&&(p===e||o(p,e,i,n,r)))return h.push(t)})){d=!1;break}}else if(p!==f&&!o(p,f,i,n,r)){d=!1;break}}return r.delete(e),r.delete(t),d}function Oi(e){return sn(tn(e,na,_n),e+"")}function Ni(e){return Ze(e,cr,ji)}function Fi(e){return Ze(e,ur,Wi)}var Mi=oe?function(e){return oe.get(e)}:Br;function Pi(e){for(var t=e.name+"",i=re[t],n=w.call(re,t)?i.length:0;n--;){var o=i[n],r=o.func;if(null==r||r==e)return o.name}return t}function Ii(e){return(w.call(fe,"placeholder")?fe:e).placeholder}function Li(){var e=fe.iteratee||Ir;return e=e===Ir?ut:e,arguments.length?e(arguments[0],arguments[1]):e}function Gi(e,t){var i=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?i["string"==typeof t?"string":"hash"]:i.map}function $i(e){for(var t=cr(e),i=t.length;i--;){var n=t[i],o=e[n];t[i]=[n,o,Zi(o)]}return t}function Bi(e,t){var i=function(e,t){return null==e?na:e[t]}(e,t);return ct(i)?i:na}var ji=j?function(t){return null==t?[]:(t=g(t),Bs(j(t),function(e){return R.call(t,e)}))}:Yr,Wi=j?function(e){for(var t=[];e;)zs(t,ji(e)),e=D(e);return t}:Yr,Hi=et;function zi(e,t,i){for(var n=-1,o=(t=qt(t,e)).length,r=!1;++n<o;){var a=fn(t[n]);if(!(r=null!=e&&i(e,a)))break;e=e[a]}return r||++n!=o?r:!!(o=null==e?0:e.length)&&Oo(o)&&Yi(a,o)&&(_o(e)||Co(e))}function Vi(e){return"function"!=typeof e.constructor||Ji(e)?{}:ge(D(e))}function Ui(e){return _o(e)||Co(e)||!!(N&&e&&e[N])}function Yi(e,t){var i=typeof e;return!!(t=null==t?sa:t)&&("number"==i||"symbol"!=i&&ps.test(e))&&-1<e&&e%1==0&&e<t}function qi(e,t,i){if(!No(i))return!1;var n=typeof t;return!!("number"==n?Eo(i)&&Yi(t,i.length):"string"==n&&t in i)&&yo(i[t],e)}function Qi(e,t){if(_o(e))return!1;var i=typeof e;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=e&&!Bo(e))||(Qa.test(e)||!qa.test(e)||null!=t&&e in g(t))}function Ki(e){var t=Pi(e),i=fe[t];if("function"!=typeof i||!(t in be.prototype))return!1;if(e===i)return!0;var n=Mi(i);return!!n&&e===n[0]}(J&&Hi(new J(new ArrayBuffer(1)))!=Da||Z&&Hi(new Z)!=ya||ee&&Hi(ee.resolve())!=Ca||te&&Hi(new te)!=Aa||ie&&Hi(new ie)!=Sa)&&(Hi=function(e){var t=et(e),i=t==wa?e.constructor:na,n=i?gn(i):"";if(n)switch(n){case ae:return Da;case se:return ya;case le:return Ca;case ce:return Aa;case ue:return Sa}return t});var Xi=l?ko:qr;function Ji(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||d)}function Zi(e){return e==e&&!No(e)}function en(t,i){return function(e){return null!=e&&(e[t]===i&&(i!==na||t in g(e)))}}function tn(r,a,s){return a=U(a===na?r.length-1:a,0),function(){for(var e=arguments,t=-1,i=U(e.length-a,0),n=x(i);++t<i;)n[t]=e[a+t];t=-1;for(var o=x(a+1);++t<a;)o[t]=e[t];return o[a]=s(n),Ps(r,this,o)}}function nn(e,t){return t.length<2?e:Je(e,Nt(t,0,-1))}function on(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var rn=cn(kt),an=G||function(e,t){return Ts.setTimeout(e,t)},sn=cn(Rt);function ln(e,t,i){var n=t+"";return sn(e,function(e,t){var i=t.length;if(!i)return e;var n=i-1;return t[n]=(1<i?"& ":"")+t[n],t=t.join(2<i?", ":" "),e.replace(is,"{\n/* [wrapped with "+t+"] */\n")}(n,function(i,n){return Ls(ua,function(e){var t="_."+e[0];n&e[1]&&!js(i,t)&&i.push(t)}),i.sort()}(function(e){var t=e.match(ns);return t?t[1].split(os):[]}(n),i)))}function cn(i){var n=0,o=0;return function(){var e=q(),t=16-(e-o);if(o=e,0<t){if(800<=++n)return arguments[0]}else n=0;return i.apply(na,arguments)}}function un(e,t){var i=-1,n=e.length,o=n-1;for(t=t===na?n:t;++i<t;){var r=At(i,o),a=e[r];e[r]=e[i],e[i]=a}return e.length=t,e}var dn,hn,pn=(hn=(dn=ho(function(e){var o=[];return 46===e.charCodeAt(0)&&o.push(""),e.replace(Ka,function(e,t,i,n){o.push(i?n.replace(as,"$1"):t||e)}),o},function(e){return 500===hn.size&&hn.clear(),e})).cache,dn);function fn(e){if("string"==typeof e||Bo(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function gn(e){if(null!=e){try{return c.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function mn(e){if(e instanceof be)return e.clone();var t=new ye(e.__wrapped__,e.__chain__);return t.__actions__=oi(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var vn=xt(function(e,t){return xo(e)?Be(e,Ue(t,1,xo,!0)):[]}),yn=xt(function(e,t){var i=Tn(t);return xo(i)&&(i=na),xo(e)?Be(e,Ue(t,1,xo,!0),Li(i,2)):[]}),bn=xt(function(e,t){var i=Tn(t);return xo(i)&&(i=na),xo(e)?Be(e,Ue(t,1,xo,!0),na,i):[]});function wn(e,t,i){var n=null==e?0:e.length;if(!n)return-1;var o=null==i?0:Uo(i);return o<0&&(o=U(n+o,0)),Qs(e,Li(t,3),o)}function Cn(e,t,i){var n=null==e?0:e.length;if(!n)return-1;var o=n-1;return i!==na&&(o=Uo(i),o=i<0?U(n+o,0):Y(o,n-1)),Qs(e,Li(t,3),o,!0)}function _n(e){return(null==e?0:e.length)?Ue(e,1):[]}function An(e){return e&&e.length?e[0]:na}var En=xt(function(e){var t=Hs(e,Ut);return t.length&&t[0]===e[0]?ot(t):[]}),xn=xt(function(e){var t=Tn(e),i=Hs(e,Ut);return t===Tn(i)?t=na:i.pop(),i.length&&i[0]===e[0]?ot(i,Li(t,2)):[]}),Sn=xt(function(e){var t=Tn(e),i=Hs(e,Ut);return(t="function"==typeof t?t:na)&&i.pop(),i.length&&i[0]===e[0]?ot(i,na,t):[]});function Tn(e){var t=null==e?0:e.length;return t?e[t-1]:na}var Dn=xt(kn);function kn(e,t){return e&&e.length&&t&&t.length?Ct(e,t):e}var Rn=Oi(function(e,t){var i=null==e?0:e.length,n=Pe(e,t);return _t(e,Hs(t,function(e){return Yi(e,i)?+e:e}).sort(ti)),n});function On(e){return null==e?e:X.call(e)}var Nn=xt(function(e){return $t(Ue(e,1,xo,!0))}),Fn=xt(function(e){var t=Tn(e);return xo(t)&&(t=na),$t(Ue(e,1,xo,!0),Li(t,2))}),Mn=xt(function(e){var t=Tn(e);return t="function"==typeof t?t:na,$t(Ue(e,1,xo,!0),na,t)});function Pn(t){if(!t||!t.length)return[];var i=0;return t=Bs(t,function(e){if(xo(e))return i=U(e.length,i),!0}),nl(i,function(e){return Hs(t,el(e))})}function In(e,t){if(!e||!e.length)return[];var i=Pn(e);return null==t?i:Hs(i,function(e){return Ps(t,na,e)})}var Ln=xt(function(e,t){return xo(e)?Be(e,t):[]}),Gn=xt(function(e){return zt(Bs(e,xo))}),$n=xt(function(e){var t=Tn(e);return xo(t)&&(t=na),zt(Bs(e,xo),Li(t,2))}),Bn=xt(function(e){var t=Tn(e);return t="function"==typeof t?t:na,zt(Bs(e,xo),na,t)}),jn=xt(Pn);var Wn=xt(function(e){var t=e.length,i=1<t?e[t-1]:na;return i="function"==typeof i?(e.pop(),i):na,In(e,i)});function Hn(e){var t=fe(e);return t.__chain__=!0,t}function zn(e,t){return t(e)}var Vn=Oi(function(t){function e(e){return Pe(e,t)}var i=t.length,n=i?t[0]:0,o=this.__wrapped__;return!(1<i||this.__actions__.length)&&o instanceof be&&Yi(n)?((o=o.slice(n,+n+(i?1:0))).__actions__.push({func:zn,args:[e],thisArg:na}),new ye(o,this.__chain__).thru(function(e){return i&&!e.length&&e.push(na),e})):this.thru(e)});var Un=ai(function(e,t,i){w.call(e,i)?++e[i]:Me(e,i,1)});var Yn=pi(wn),qn=pi(Cn);function Qn(e,t){return(_o(e)?Ls:je)(e,Li(t,3))}function Kn(e,t){return(_o(e)?Gs:We)(e,Li(t,3))}var Xn=ai(function(e,t,i){w.call(e,i)?e[i].push(t):Me(e,i,[t])});var Jn=xt(function(e,t,i){var n=-1,o="function"==typeof t,r=Eo(e)?x(e.length):[];return je(e,function(e){r[++n]=o?Ps(t,e,i):rt(e,t,i)}),r}),Zn=ai(function(e,t,i){Me(e,i,t)});function eo(e,t){return(_o(e)?Hs:ft)(e,Li(t,3))}var to=ai(function(e,t,i){e[i?0:1].push(t)},function(){return[[],[]]});var io=xt(function(e,t){if(null==e)return[];var i=t.length;return 1<i&&qi(e,t[0],t[1])?t=[]:2<i&&qi(t[0],t[1],t[2])&&(t=[t[0]]),bt(e,Ue(t,1),[])}),no=L||function(){return Ts.Date.now()};function oo(e,t,i){return t=i?na:t,t=e&&null==t?e.length:t,Si(e,128,na,na,na,na,t)}function ro(e,t){var i;if("function"!=typeof t)throw new y(oa);return e=Uo(e),function(){return 0<--e&&(i=t.apply(this,arguments)),e<=1&&(t=na),i}}var ao=xt(function(e,t,i){var n=1;if(i.length){var o=gl(i,Ii(ao));n|=32}return Si(e,n,t,i,o)}),so=xt(function(e,t,i){var n=3;if(i.length){var o=gl(i,Ii(so));n|=32}return Si(t,n,e,i,o)});function lo(n,i,e){var o,r,a,s,l,c,u=0,d=!1,h=!1,t=!0;if("function"!=typeof n)throw new y(oa);function p(e){var t=o,i=r;return o=r=na,u=e,s=n.apply(i,t)}function f(e){var t=e-c;return c===na||i<=t||t<0||h&&a<=e-u}function g(){var e=no();if(f(e))return m(e);l=an(g,function(e){var t=i-(e-c);return h?Y(t,a-(e-u)):t}(e))}function m(e){return l=na,t&&o?p(e):(o=r=na,s)}function v(){var e=no(),t=f(e);if(o=arguments,r=this,c=e,t){if(l===na)return function(e){return u=e,l=an(g,i),d?p(e):s}(c);if(h)return Xt(l),l=an(g,i),p(c)}return l===na&&(l=an(g,i)),s}return i=qo(i)||0,No(e)&&(d=!!e.leading,a=(h="maxWait"in e)?U(qo(e.maxWait)||0,i):a,t="trailing"in e?!!e.trailing:t),v.cancel=function(){l!==na&&Xt(l),u=0,o=c=r=l=na},v.flush=function(){return l===na?s:m(no())},v}var co=xt(function(e,t){return $e(e,1,t)}),uo=xt(function(e,t,i){return $e(e,qo(t)||0,i)});function ho(o,r){if("function"!=typeof o||null!=r&&"function"!=typeof r)throw new y(oa);var a=function(){var e=arguments,t=r?r.apply(this,e):e[0],i=a.cache;if(i.has(t))return i.get(t);var n=o.apply(this,e);return a.cache=i.set(t,n)||i,n};return a.cache=new(ho.Cache||_e),a}function po(t){if("function"!=typeof t)throw new y(oa);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}ho.Cache=_e;var fo=Qt(function(n,o){var r=(o=1==o.length&&_o(o[0])?Hs(o[0],ol(Li())):Hs(Ue(o,1),ol(Li()))).length;return xt(function(e){for(var t=-1,i=Y(e.length,r);++t<i;)e[t]=o[t].call(this,e[t]);return Ps(n,this,e)})}),go=xt(function(e,t){var i=gl(t,Ii(go));return Si(e,32,na,t,i)}),mo=xt(function(e,t){var i=gl(t,Ii(mo));return Si(e,64,na,t,i)}),vo=Oi(function(e,t){return Si(e,256,na,na,na,t)});function yo(e,t){return e===t||e!=e&&t!=t}var bo=Ci(tt),wo=Ci(function(e,t){return t<=e}),Co=at(function(){return arguments}())?at:function(e){return Fo(e)&&w.call(e,"callee")&&!R.call(e,"callee")},_o=x.isArray,Ao=ks?ol(ks):function(e){return Fo(e)&&et(e)==Ta};function Eo(e){return null!=e&&Oo(e.length)&&!ko(e)}function xo(e){return Fo(e)&&Eo(e)}var So=W||qr,To=Rs?ol(Rs):function(e){return Fo(e)&&et(e)==fa};function Do(e){if(!Fo(e))return!1;var t=et(e);return t==ga||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!Io(e)}function ko(e){if(!No(e))return!1;var t=et(e);return t==ma||t==va||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Ro(e){return"number"==typeof e&&e==Uo(e)}function Oo(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=sa}function No(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Fo(e){return null!=e&&"object"==typeof e}var Mo=Os?ol(Os):function(e){return Fo(e)&&Hi(e)==ya};function Po(e){return"number"==typeof e||Fo(e)&&et(e)==ba}function Io(e){if(!Fo(e)||et(e)!=wa)return!1;var t=D(e);if(null===t)return!0;var i=w.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&c.call(i)==b}var Lo=Ns?ol(Ns):function(e){return Fo(e)&&et(e)==_a};var Go=Fs?ol(Fs):function(e){return Fo(e)&&Hi(e)==Aa};function $o(e){return"string"==typeof e||!_o(e)&&Fo(e)&&et(e)==Ea}function Bo(e){return"symbol"==typeof e||Fo(e)&&et(e)==xa}var jo=Ms?ol(Ms):function(e){return Fo(e)&&Oo(e.length)&&!!As[et(e)]};var Wo=Ci(pt),Ho=Ci(function(e,t){return e<=t});function zo(e){if(!e)return[];if(Eo(e))return $o(e)?yl(e):oi(e);if(F&&e[F])return function(e){for(var t,i=[];!(t=e.next()).done;)i.push(t.value);return i}(e[F]());var t=Hi(e);return(t==ya?pl:t==Aa?ml:yr)(e)}function Vo(e){return e?(e=qo(e))!==1/0&&e!==-1/0?e==e?e:0:17976931348623157e292*(e<0?-1:1):0===e?e:0}function Uo(e){var t=Vo(e),i=t%1;return t==t?i?t-i:t:0}function Yo(e){return e?Ie(Uo(e),0,ca):0}function qo(e){if("number"==typeof e)return e;if(Bo(e))return la;if(No(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=No(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Za,"");var i=us.test(e);return i||hs.test(e)?Ss(e.slice(2),i?2:8):cs.test(e)?la:+e}function Qo(e){return ri(e,ur(e))}function Ko(e){return null==e?"":Gt(e)}var Xo=si(function(e,t){if(Ji(t)||Eo(t))ri(t,cr(t),e);else for(var i in t)w.call(t,i)&&Re(e,i,t[i])}),Jo=si(function(e,t){ri(t,ur(t),e)}),Zo=si(function(e,t,i,n){ri(t,ur(t),e,n)}),er=si(function(e,t,i,n){ri(t,cr(t),e,n)}),tr=Oi(Pe);var ir=xt(function(e,t){e=g(e);var i=-1,n=t.length,o=2<n?t[2]:na;for(o&&qi(t[0],t[1],o)&&(n=1);++i<n;)for(var r=t[i],a=ur(r),s=-1,l=a.length;++s<l;){var c=a[s],u=e[c];(u===na||yo(u,d[c])&&!w.call(e,c))&&(e[c]=r[c])}return e}),nr=xt(function(e){return e.push(na,Di),Ps(hr,na,e)});function or(e,t,i){var n=null==e?na:Je(e,t);return n===na?i:n}function rr(e,t){return null!=e&&zi(e,t,nt)}var ar=mi(function(e,t,i){null!=t&&"function"!=typeof t.toString&&(t=f.call(t)),e[t]=i},Nr(Pr)),sr=mi(function(e,t,i){null!=t&&"function"!=typeof t.toString&&(t=f.call(t)),w.call(e,t)?e[t].push(i):e[t]=[i]},Li),lr=xt(rt);function cr(e){return Eo(e)?xe(e):dt(e)}function ur(e){return Eo(e)?xe(e,!0):ht(e)}var dr=si(function(e,t,i){vt(e,t,i)}),hr=si(function(e,t,i,n){vt(e,t,i,n)}),pr=Oi(function(t,e){var i={};if(null==t)return i;var n=!1;e=Hs(e,function(e){return e=qt(e,t),n=n||1<e.length,e}),ri(t,Fi(t),i),n&&(i=Le(i,7,ki));for(var o=e.length;o--;)Bt(i,e[o]);return i});var fr=Oi(function(e,t){return null==e?{}:function(i,e){return wt(i,e,function(e,t){return rr(i,t)})}(e,t)});function gr(e,i){if(null==e)return{};var t=Hs(Fi(e),function(e){return[e]});return i=Li(i),wt(e,t,function(e,t){return i(e,t[0])})}var mr=xi(cr),vr=xi(ur);function yr(e){return null==e?[]:rl(e,cr(e))}var br=di(function(e,t,i){return t=t.toLowerCase(),e+(i?wr(t):t)});function wr(e){return Dr(Ko(e).toLowerCase())}function Cr(e){return(e=Ko(e))&&e.replace(fs,cl).replace(ys,"")}var _r=di(function(e,t,i){return e+(i?"-":"")+t.toLowerCase()}),Ar=di(function(e,t,i){return e+(i?" ":"")+t.toLowerCase()}),Er=ui("toLowerCase");var xr=di(function(e,t,i){return e+(i?"_":"")+t.toLowerCase()});var Sr=di(function(e,t,i){return e+(i?" ":"")+Dr(t)});var Tr=di(function(e,t,i){return e+(i?" ":"")+t.toUpperCase()}),Dr=ui("toUpperCase");function kr(e,t,i){return e=Ko(e),(t=i?na:t)===na?function(e){return ws.test(e)}(e)?function(e){return e.match(bs)||[]}(e):function(e){return e.match(rs)||[]}(e):e.match(t)||[]}var Rr=xt(function(e,t){try{return Ps(e,na,t)}catch(e){return Do(e)?e:new o(e)}}),Or=Oi(function(t,e){return Ls(e,function(e){e=fn(e),Me(t,e,ao(t[e],t))}),t});function Nr(e){return function(){return e}}var Fr=fi(),Mr=fi(!0);function Pr(e){return e}function Ir(e){return ut("function"==typeof e?e:Le(e,1))}var Lr=xt(function(t,i){return function(e){return rt(e,t,i)}}),Gr=xt(function(t,i){return function(e){return rt(t,e,i)}});function $r(n,t,e){var i=cr(t),o=Xe(t,i);null!=e||No(t)&&(o.length||!i.length)||(e=t,t=n,n=this,o=Xe(t,cr(t)));var r=!(No(e)&&"chain"in e&&!e.chain),a=ko(n);return Ls(o,function(e){var i=t[e];n[e]=i,a&&(n.prototype[e]=function(){var e=this.__chain__;if(r||e){var t=n(this.__wrapped__);return(t.__actions__=oi(this.__actions__)).push({func:i,args:arguments,thisArg:n}),t.__chain__=e,t}return i.apply(n,zs([this.value()],arguments))})}),n}function Br(){}var jr=yi(Hs),Wr=yi($s),Hr=yi(Ys);function zr(e){return Qi(e)?el(fn(e)):function(t){return function(e){return Je(e,t)}}(e)}var Vr=wi(),Ur=wi(!0);function Yr(){return[]}function qr(){return!1}var Qr=vi(function(e,t){return e+t},0),Kr=Ai("ceil"),Xr=vi(function(e,t){return e/t},1),Jr=Ai("floor");var Zr,ea=vi(function(e,t){return e*t},1),ta=Ai("round"),ia=vi(function(e,t){return e-t},0);return fe.after=function(e,t){if("function"!=typeof t)throw new y(oa);return e=Uo(e),function(){if(--e<1)return t.apply(this,arguments)}},fe.ary=oo,fe.assign=Xo,fe.assignIn=Jo,fe.assignInWith=Zo,fe.assignWith=er,fe.at=tr,fe.before=ro,fe.bind=ao,fe.bindAll=Or,fe.bindKey=so,fe.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return _o(e)?e:[e]},fe.chain=Hn,fe.chunk=function(e,t,i){t=(i?qi(e,t,i):t===na)?1:U(Uo(t),0);var n=null==e?0:e.length;if(!n||t<1)return[];for(var o=0,r=0,a=x($(n/t));o<n;)a[r++]=Nt(e,o,o+=t);return a},fe.compact=function(e){for(var t=-1,i=null==e?0:e.length,n=0,o=[];++t<i;){var r=e[t];r&&(o[n++]=r)}return o},fe.concat=function(){var e=arguments.length;if(!e)return[];for(var t=x(e-1),i=arguments[0],n=e;n--;)t[n-1]=arguments[n];return zs(_o(i)?oi(i):[i],Ue(t,1))},fe.cond=function(n){var o=null==n?0:n.length,t=Li();return n=o?Hs(n,function(e){if("function"!=typeof e[1])throw new y(oa);return[t(e[0]),e[1]]}):[],xt(function(e){for(var t=-1;++t<o;){var i=n[t];if(Ps(i[0],this,e))return Ps(i[1],this,e)}})},fe.conforms=function(e){return function(t){var i=cr(t);return function(e){return Ge(e,t,i)}}(Le(e,1))},fe.constant=Nr,fe.countBy=Un,fe.create=function(e,t){var i=ge(e);return null==t?i:Fe(i,t)},fe.curry=function e(t,i,n){var o=Si(t,8,na,na,na,na,na,i=n?na:i);return o.placeholder=e.placeholder,o},fe.curryRight=function e(t,i,n){var o=Si(t,16,na,na,na,na,na,i=n?na:i);return o.placeholder=e.placeholder,o},fe.debounce=lo,fe.defaults=ir,fe.defaultsDeep=nr,fe.defer=co,fe.delay=uo,fe.difference=vn,fe.differenceBy=yn,fe.differenceWith=bn,fe.drop=function(e,t,i){var n=null==e?0:e.length;return n?Nt(e,(t=i||t===na?1:Uo(t))<0?0:t,n):[]},fe.dropRight=function(e,t,i){var n=null==e?0:e.length;return n?Nt(e,0,(t=n-(t=i||t===na?1:Uo(t)))<0?0:t):[]},fe.dropRightWhile=function(e,t){return e&&e.length?Wt(e,Li(t,3),!0,!0):[]},fe.dropWhile=function(e,t){return e&&e.length?Wt(e,Li(t,3),!0):[]},fe.fill=function(e,t,i,n){var o=null==e?0:e.length;return o?(i&&"number"!=typeof i&&qi(e,t,i)&&(i=0,n=o),function(e,t,i,n){var o=e.length;for((i=Uo(i))<0&&(i=o<-i?0:o+i),(n=n===na||o<n?o:Uo(n))<0&&(n+=o),n=n<i?0:Yo(n);i<n;)e[i++]=t;return e}(e,t,i,n)):[]},fe.filter=function(e,t){return(_o(e)?Bs:Ve)(e,Li(t,3))},fe.flatMap=function(e,t){return Ue(eo(e,t),1)},fe.flatMapDeep=function(e,t){return Ue(eo(e,t),1/0)},fe.flatMapDepth=function(e,t,i){return i=i===na?1:Uo(i),Ue(eo(e,t),i)},fe.flatten=_n,fe.flattenDeep=function(e){return(null==e?0:e.length)?Ue(e,1/0):[]},fe.flattenDepth=function(e,t){return(null==e?0:e.length)?Ue(e,t=t===na?1:Uo(t)):[]},fe.flip=function(e){return Si(e,512)},fe.flow=Fr,fe.flowRight=Mr,fe.fromPairs=function(e){for(var t=-1,i=null==e?0:e.length,n={};++t<i;){var o=e[t];n[o[0]]=o[1]}return n},fe.functions=function(e){return null==e?[]:Xe(e,cr(e))},fe.functionsIn=function(e){return null==e?[]:Xe(e,ur(e))},fe.groupBy=Xn,fe.initial=function(e){return(null==e?0:e.length)?Nt(e,0,-1):[]},fe.intersection=En,fe.intersectionBy=xn,fe.intersectionWith=Sn,fe.invert=ar,fe.invertBy=sr,fe.invokeMap=Jn,fe.iteratee=Ir,fe.keyBy=Zn,fe.keys=cr,fe.keysIn=ur,fe.map=eo,fe.mapKeys=function(e,n){var o={};return n=Li(n,3),Qe(e,function(e,t,i){Me(o,n(e,t,i),e)}),o},fe.mapValues=function(e,n){var o={};return n=Li(n,3),Qe(e,function(e,t,i){Me(o,t,n(e,t,i))}),o},fe.matches=function(e){return gt(Le(e,1))},fe.matchesProperty=function(e,t){return mt(e,Le(t,1))},fe.memoize=ho,fe.merge=dr,fe.mergeWith=hr,fe.method=Lr,fe.methodOf=Gr,fe.mixin=$r,fe.negate=po,fe.nthArg=function(t){return t=Uo(t),xt(function(e){return yt(e,t)})},fe.omit=pr,fe.omitBy=function(e,t){return gr(e,po(Li(t)))},fe.once=function(e){return ro(2,e)},fe.orderBy=function(e,t,i,n){return null==e?[]:(_o(t)||(t=null==t?[]:[t]),_o(i=n?na:i)||(i=null==i?[]:[i]),bt(e,t,i))},fe.over=jr,fe.overArgs=fo,fe.overEvery=Wr,fe.overSome=Hr,fe.partial=go,fe.partialRight=mo,fe.partition=to,fe.pick=fr,fe.pickBy=gr,fe.property=zr,fe.propertyOf=function(t){return function(e){return null==t?na:Je(t,e)}},fe.pull=Dn,fe.pullAll=kn,fe.pullAllBy=function(e,t,i){return e&&e.length&&t&&t.length?Ct(e,t,Li(i,2)):e},fe.pullAllWith=function(e,t,i){return e&&e.length&&t&&t.length?Ct(e,t,na,i):e},fe.pullAt=Rn,fe.range=Vr,fe.rangeRight=Ur,fe.rearg=vo,fe.reject=function(e,t){return(_o(e)?Bs:Ve)(e,po(Li(t,3)))},fe.remove=function(e,t){var i=[];if(!e||!e.length)return i;var n=-1,o=[],r=e.length;for(t=Li(t,3);++n<r;){var a=e[n];t(a,n,e)&&(i.push(a),o.push(n))}return _t(e,o),i},fe.rest=function(e,t){if("function"!=typeof e)throw new y(oa);return xt(e,t=t===na?t:Uo(t))},fe.reverse=On,fe.sampleSize=function(e,t,i){return t=(i?qi(e,t,i):t===na)?1:Uo(t),(_o(e)?Te:Tt)(e,t)},fe.set=function(e,t,i){return null==e?e:Dt(e,t,i)},fe.setWith=function(e,t,i,n){return n="function"==typeof n?n:na,null==e?e:Dt(e,t,i,n)},fe.shuffle=function(e){return(_o(e)?De:Ot)(e)},fe.slice=function(e,t,i){var n=null==e?0:e.length;return n?(i=i&&"number"!=typeof i&&qi(e,t,i)?(t=0,n):(t=null==t?0:Uo(t),i===na?n:Uo(i)),Nt(e,t,i)):[]},fe.sortBy=io,fe.sortedUniq=function(e){return e&&e.length?It(e):[]},fe.sortedUniqBy=function(e,t){return e&&e.length?It(e,Li(t,2)):[]},fe.split=function(e,t,i){return i&&"number"!=typeof i&&qi(e,t,i)&&(t=i=na),(i=i===na?ca:i>>>0)?(e=Ko(e))&&("string"==typeof t||null!=t&&!Lo(t))&&!(t=Gt(t))&&hl(e)?Kt(yl(e),0,i):e.split(t,i):[]},fe.spread=function(n,o){if("function"!=typeof n)throw new y(oa);return o=null==o?0:U(Uo(o),0),xt(function(e){var t=e[o],i=Kt(e,0,o);return t&&zs(i,t),Ps(n,this,i)})},fe.tail=function(e){var t=null==e?0:e.length;return t?Nt(e,1,t):[]},fe.take=function(e,t,i){return e&&e.length?Nt(e,0,(t=i||t===na?1:Uo(t))<0?0:t):[]},fe.takeRight=function(e,t,i){var n=null==e?0:e.length;return n?Nt(e,(t=n-(t=i||t===na?1:Uo(t)))<0?0:t,n):[]},fe.takeRightWhile=function(e,t){return e&&e.length?Wt(e,Li(t,3),!1,!0):[]},fe.takeWhile=function(e,t){return e&&e.length?Wt(e,Li(t,3)):[]},fe.tap=function(e,t){return t(e),e},fe.throttle=function(e,t,i){var n=!0,o=!0;if("function"!=typeof e)throw new y(oa);return No(i)&&(n="leading"in i?!!i.leading:n,o="trailing"in i?!!i.trailing:o),lo(e,t,{leading:n,maxWait:t,trailing:o})},fe.thru=zn,fe.toArray=zo,fe.toPairs=mr,fe.toPairsIn=vr,fe.toPath=function(e){return _o(e)?Hs(e,fn):Bo(e)?[e]:oi(pn(Ko(e)))},fe.toPlainObject=Qo,fe.transform=function(e,n,o){var t=_o(e),i=t||So(e)||jo(e);if(n=Li(n,4),null==o){var r=e&&e.constructor;o=i?t?new r:[]:No(e)&&ko(r)?ge(D(e)):{}}return(i?Ls:Qe)(e,function(e,t,i){return n(o,e,t,i)}),o},fe.unary=function(e){return oo(e,1)},fe.union=Nn,fe.unionBy=Fn,fe.unionWith=Mn,fe.uniq=function(e){return e&&e.length?$t(e):[]},fe.uniqBy=function(e,t){return e&&e.length?$t(e,Li(t,2)):[]},fe.uniqWith=function(e,t){return t="function"==typeof t?t:na,e&&e.length?$t(e,na,t):[]},fe.unset=function(e,t){return null==e||Bt(e,t)},fe.unzip=Pn,fe.unzipWith=In,fe.update=function(e,t,i){return null==e?e:jt(e,t,Yt(i))},fe.updateWith=function(e,t,i,n){return n="function"==typeof n?n:na,null==e?e:jt(e,t,Yt(i),n)},fe.values=yr,fe.valuesIn=function(e){return null==e?[]:rl(e,ur(e))},fe.without=Ln,fe.words=kr,fe.wrap=function(e,t){return go(Yt(t),e)},fe.xor=Gn,fe.xorBy=$n,fe.xorWith=Bn,fe.zip=jn,fe.zipObject=function(e,t){return Vt(e||[],t||[],Re)},fe.zipObjectDeep=function(e,t){return Vt(e||[],t||[],Dt)},fe.zipWith=Wn,fe.entries=mr,fe.entriesIn=vr,fe.extend=Jo,fe.extendWith=Zo,$r(fe,fe),fe.add=Qr,fe.attempt=Rr,fe.camelCase=br,fe.capitalize=wr,fe.ceil=Kr,fe.clamp=function(e,t,i){return i===na&&(i=t,t=na),i!==na&&(i=(i=qo(i))==i?i:0),t!==na&&(t=(t=qo(t))==t?t:0),Ie(qo(e),t,i)},fe.clone=function(e){return Le(e,4)},fe.cloneDeep=function(e){return Le(e,5)},fe.cloneDeepWith=function(e,t){return Le(e,5,t="function"==typeof t?t:na)},fe.cloneWith=function(e,t){return Le(e,4,t="function"==typeof t?t:na)},fe.conformsTo=function(e,t){return null==t||Ge(e,t,cr(t))},fe.deburr=Cr,fe.defaultTo=function(e,t){return null==e||e!=e?t:e},fe.divide=Xr,fe.endsWith=function(e,t,i){e=Ko(e),t=Gt(t);var n=e.length,o=i=i===na?n:Ie(Uo(i),0,n);return 0<=(i-=t.length)&&e.slice(i,o)==t},fe.eq=yo,fe.escape=function(e){return(e=Ko(e))&&za.test(e)?e.replace(Wa,ul):e},fe.escapeRegExp=function(e){return(e=Ko(e))&&Ja.test(e)?e.replace(Xa,"\\$&"):e},fe.every=function(e,t,i){var n=_o(e)?$s:He;return i&&qi(e,t,i)&&(t=na),n(e,Li(t,3))},fe.find=Yn,fe.findIndex=wn,fe.findKey=function(e,t){return qs(e,Li(t,3),Qe)},fe.findLast=qn,fe.findLastIndex=Cn,fe.findLastKey=function(e,t){return qs(e,Li(t,3),Ke)},fe.floor=Jr,fe.forEach=Qn,fe.forEachRight=Kn,fe.forIn=function(e,t){return null==e?e:Ye(e,Li(t,3),ur)},fe.forInRight=function(e,t){return null==e?e:qe(e,Li(t,3),ur)},fe.forOwn=function(e,t){return e&&Qe(e,Li(t,3))},fe.forOwnRight=function(e,t){return e&&Ke(e,Li(t,3))},fe.get=or,fe.gt=bo,fe.gte=wo,fe.has=function(e,t){return null!=e&&zi(e,t,it)},fe.hasIn=rr,fe.head=An,fe.identity=Pr,fe.includes=function(e,t,i,n){e=Eo(e)?e:yr(e),i=i&&!n?Uo(i):0;var o=e.length;return i<0&&(i=U(o+i,0)),$o(e)?i<=o&&-1<e.indexOf(t,i):!!o&&-1<Ks(e,t,i)},fe.indexOf=function(e,t,i){var n=null==e?0:e.length;if(!n)return-1;var o=null==i?0:Uo(i);return o<0&&(o=U(n+o,0)),Ks(e,t,o)},fe.inRange=function(e,t,i){return t=Vo(t),i===na?(i=t,t=0):i=Vo(i),function(e,t,i){return e>=Y(t,i)&&e<U(t,i)}(e=qo(e),t,i)},fe.invoke=lr,fe.isArguments=Co,fe.isArray=_o,fe.isArrayBuffer=Ao,fe.isArrayLike=Eo,fe.isArrayLikeObject=xo,fe.isBoolean=function(e){return!0===e||!1===e||Fo(e)&&et(e)==pa},fe.isBuffer=So,fe.isDate=To,fe.isElement=function(e){return Fo(e)&&1===e.nodeType&&!Io(e)},fe.isEmpty=function(e){if(null==e)return!0;if(Eo(e)&&(_o(e)||"string"==typeof e||"function"==typeof e.splice||So(e)||jo(e)||Co(e)))return!e.length;var t=Hi(e);if(t==ya||t==Aa)return!e.size;if(Ji(e))return!dt(e).length;for(var i in e)if(w.call(e,i))return!1;return!0},fe.isEqual=function(e,t){return st(e,t)},fe.isEqualWith=function(e,t,i){var n=(i="function"==typeof i?i:na)?i(e,t):na;return n===na?st(e,t,na,i):!!n},fe.isError=Do,fe.isFinite=function(e){return"number"==typeof e&&H(e)},fe.isFunction=ko,fe.isInteger=Ro,fe.isLength=Oo,fe.isMap=Mo,fe.isMatch=function(e,t){return e===t||lt(e,t,$i(t))},fe.isMatchWith=function(e,t,i){return i="function"==typeof i?i:na,lt(e,t,$i(t),i)},fe.isNaN=function(e){return Po(e)&&e!=+e},fe.isNative=function(e){if(Xi(e))throw new o("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return ct(e)},fe.isNil=function(e){return null==e},fe.isNull=function(e){return null===e},fe.isNumber=Po,fe.isObject=No,fe.isObjectLike=Fo,fe.isPlainObject=Io,fe.isRegExp=Lo,fe.isSafeInteger=function(e){return Ro(e)&&-sa<=e&&e<=sa},fe.isSet=Go,fe.isString=$o,fe.isSymbol=Bo,fe.isTypedArray=jo,fe.isUndefined=function(e){return e===na},fe.isWeakMap=function(e){return Fo(e)&&Hi(e)==Sa},fe.isWeakSet=function(e){return Fo(e)&&"[object WeakSet]"==et(e)},fe.join=function(e,t){return null==e?"":z.call(e,t)},fe.kebabCase=_r,fe.last=Tn,fe.lastIndexOf=function(e,t,i){var n=null==e?0:e.length;if(!n)return-1;var o=n;return i!==na&&(o=(o=Uo(i))<0?U(n+o,0):Y(o,n-1)),t==t?function(e,t,i){for(var n=i+1;n--;)if(e[n]===t)return n;return n}(e,t,o):Qs(e,Js,o,!0)},fe.lowerCase=Ar,fe.lowerFirst=Er,fe.lt=Wo,fe.lte=Ho,fe.max=function(e){return e&&e.length?ze(e,Pr,tt):na},fe.maxBy=function(e,t){return e&&e.length?ze(e,Li(t,2),tt):na},fe.mean=function(e){return Zs(e,Pr)},fe.meanBy=function(e,t){return Zs(e,Li(t,2))},fe.min=function(e){return e&&e.length?ze(e,Pr,pt):na},fe.minBy=function(e,t){return e&&e.length?ze(e,Li(t,2),pt):na},fe.stubArray=Yr,fe.stubFalse=qr,fe.stubObject=function(){return{}},fe.stubString=function(){return""},fe.stubTrue=function(){return!0},fe.multiply=ea,fe.nth=function(e,t){return e&&e.length?yt(e,Uo(t)):na},fe.noConflict=function(){return Ts._===this&&(Ts._=C),this},fe.noop=Br,fe.now=no,fe.pad=function(e,t,i){e=Ko(e);var n=(t=Uo(t))?vl(e):0;if(!t||t<=n)return e;var o=(t-n)/2;return bi(B(o),i)+e+bi($(o),i)},fe.padEnd=function(e,t,i){e=Ko(e);var n=(t=Uo(t))?vl(e):0;return t&&n<t?e+bi(t-n,i):e},fe.padStart=function(e,t,i){e=Ko(e);var n=(t=Uo(t))?vl(e):0;return t&&n<t?bi(t-n,i)+e:e},fe.parseInt=function(e,t,i){return t=i||null==t?0:t&&+t,Q(Ko(e).replace(es,""),t||0)},fe.random=function(e,t,i){if(i&&"boolean"!=typeof i&&qi(e,t,i)&&(t=i=na),i===na&&("boolean"==typeof t?(i=t,t=na):"boolean"==typeof e&&(i=e,e=na)),e===na&&t===na?(e=0,t=1):(e=Vo(e),t===na?(t=e,e=0):t=Vo(t)),t<e){var n=e;e=t,t=n}if(i||e%1||t%1){var o=K();return Y(e+o*(t-e+xs("1e-"+((o+"").length-1))),t)}return At(e,t)},fe.reduce=function(e,t,i){var n=_o(e)?Vs:tl,o=arguments.length<3;return n(e,Li(t,4),i,o,je)},fe.reduceRight=function(e,t,i){var n=_o(e)?Us:tl,o=arguments.length<3;return n(e,Li(t,4),i,o,We)},fe.repeat=function(e,t,i){return t=(i?qi(e,t,i):t===na)?1:Uo(t),Et(Ko(e),t)},fe.replace=function(){var e=arguments,t=Ko(e[0]);return e.length<3?t:t.replace(e[1],e[2])},fe.result=function(e,t,i){var n=-1,o=(t=qt(t,e)).length;for(o||(o=1,e=na);++n<o;){var r=null==e?na:e[fn(t[n])];r===na&&(n=o,r=i),e=ko(r)?r.call(e):r}return e},fe.round=ta,fe.runInContext=e,fe.sample=function(e){return(_o(e)?Se:St)(e)},fe.size=function(e){if(null==e)return 0;if(Eo(e))return $o(e)?vl(e):e.length;var t=Hi(e);return t==ya||t==Aa?e.size:dt(e).length},fe.snakeCase=xr,fe.some=function(e,t,i){var n=_o(e)?Ys:Ft;return i&&qi(e,t,i)&&(t=na),n(e,Li(t,3))},fe.sortedIndex=function(e,t){return Mt(e,t)},fe.sortedIndexBy=function(e,t,i){return Pt(e,t,Li(i,2))},fe.sortedIndexOf=function(e,t){var i=null==e?0:e.length;if(i){var n=Mt(e,t);if(n<i&&yo(e[n],t))return n}return-1},fe.sortedLastIndex=function(e,t){return Mt(e,t,!0)},fe.sortedLastIndexBy=function(e,t,i){return Pt(e,t,Li(i,2),!0)},fe.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var i=Mt(e,t,!0)-1;if(yo(e[i],t))return i}return-1},fe.startCase=Sr,fe.startsWith=function(e,t,i){return e=Ko(e),i=null==i?0:Ie(Uo(i),0,e.length),t=Gt(t),e.slice(i,i+t.length)==t},fe.subtract=ia,fe.sum=function(e){return e&&e.length?il(e,Pr):0},fe.sumBy=function(e,t){return e&&e.length?il(e,Li(t,2)):0},fe.template=function(a,e,t){var i=fe.templateSettings;t&&qi(a,e,t)&&(e=na),a=Ko(a),e=Zo({},e,i,Ti);var s,l,n=Zo({},e.imports,i.imports,Ti),o=cr(n),r=rl(n,o),c=0,u=e.interpolate||gs,d="__p += '",h=v((e.escape||gs).source+"|"+u.source+"|"+(u===Ya?ss:gs).source+"|"+(e.evaluate||gs).source+"|$","g"),p="//# sourceURL="+(w.call(e,"sourceURL")?(e.sourceURL+"").replace(/[\r\n]/g," "):"lodash.templateSources["+ ++_s+"]")+"\n";a.replace(h,function(e,t,i,n,o,r){return i=i||n,d+=a.slice(c,r).replace(ms,dl),t&&(s=!0,d+="' +\n__e("+t+") +\n'"),o&&(l=!0,d+="';\n"+o+";\n__p += '"),i&&(d+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),c=r+e.length,e}),d+="';\n";var f=w.call(e,"variable")&&e.variable;f||(d="with (obj) {\n"+d+"\n}\n"),d=(l?d.replace(Ga,""):d).replace($a,"$1").replace(Ba,"$1;"),d="function("+(f||"obj")+") {\n"+(f?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(s?", __e = _.escape":"")+(l?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=Rr(function(){return m(o,p+"return "+d).apply(na,r)});if(g.source=d,Do(g))throw g;return g},fe.times=function(e,t){if((e=Uo(e))<1||sa<e)return[];var i=ca,n=Y(e,ca);t=Li(t),e-=ca;for(var o=nl(n,t);++i<e;)t(i);return o},fe.toFinite=Vo,fe.toInteger=Uo,fe.toLength=Yo,fe.toLower=function(e){return Ko(e).toLowerCase()},fe.toNumber=qo,fe.toSafeInteger=function(e){return e?Ie(Uo(e),-sa,sa):0===e?e:0},fe.toString=Ko,fe.toUpper=function(e){return Ko(e).toUpperCase()},fe.trim=function(e,t,i){if((e=Ko(e))&&(i||t===na))return e.replace(Za,"");if(!e||!(t=Gt(t)))return e;var n=yl(e),o=yl(t);return Kt(n,sl(n,o),ll(n,o)+1).join("")},fe.trimEnd=function(e,t,i){if((e=Ko(e))&&(i||t===na))return e.replace(ts,"");if(!e||!(t=Gt(t)))return e;var n=yl(e);return Kt(n,0,ll(n,yl(t))+1).join("")},fe.trimStart=function(e,t,i){if((e=Ko(e))&&(i||t===na))return e.replace(es,"");if(!e||!(t=Gt(t)))return e;var n=yl(e);return Kt(n,sl(n,yl(t))).join("")},fe.truncate=function(e,t){var i=30,n="...";if(No(t)){var o="separator"in t?t.separator:o;i="length"in t?Uo(t.length):i,n="omission"in t?Gt(t.omission):n}var r=(e=Ko(e)).length;if(hl(e)){var a=yl(e);r=a.length}if(r<=i)return e;var s=i-vl(n);if(s<1)return n;var l=a?Kt(a,0,s).join(""):e.slice(0,s);if(o===na)return l+n;if(a&&(s+=l.length-s),Lo(o)){if(e.slice(s).search(o)){var c,u=l;for(o.global||(o=v(o.source,Ko(ls.exec(o))+"g")),o.lastIndex=0;c=o.exec(u);)var d=c.index;l=l.slice(0,d===na?s:d)}}else if(e.indexOf(Gt(o),s)!=s){var h=l.lastIndexOf(o);-1<h&&(l=l.slice(0,h))}return l+n},fe.unescape=function(e){return(e=Ko(e))&&Ha.test(e)?e.replace(ja,bl):e},fe.uniqueId=function(e){var t=++h;return Ko(e)+t},fe.upperCase=Tr,fe.upperFirst=Dr,fe.each=Qn,fe.eachRight=Kn,fe.first=An,$r(fe,(Zr={},Qe(fe,function(e,t){w.call(fe.prototype,t)||(Zr[t]=e)}),Zr),{chain:!1}),fe.VERSION="4.17.15",Ls(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){fe[e].placeholder=fe}),Ls(["drop","take"],function(i,n){be.prototype[i]=function(e){e=e===na?1:U(Uo(e),0);var t=this.__filtered__&&!n?new be(this):this.clone();return t.__filtered__?t.__takeCount__=Y(e,t.__takeCount__):t.__views__.push({size:Y(e,ca),type:i+(t.__dir__<0?"Right":"")}),t},be.prototype[i+"Right"]=function(e){return this.reverse()[i](e).reverse()}}),Ls(["filter","map","takeWhile"],function(e,t){var i=t+1,n=1==i||3==i;be.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Li(e,3),type:i}),t.__filtered__=t.__filtered__||n,t}}),Ls(["head","last"],function(e,t){var i="take"+(t?"Right":"");be.prototype[e]=function(){return this[i](1).value()[0]}}),Ls(["initial","tail"],function(e,t){var i="drop"+(t?"":"Right");be.prototype[e]=function(){return this.__filtered__?new be(this):this[i](1)}}),be.prototype.compact=function(){return this.filter(Pr)},be.prototype.find=function(e){return this.filter(e).head()},be.prototype.findLast=function(e){return this.reverse().find(e)},be.prototype.invokeMap=xt(function(t,i){return"function"==typeof t?new be(this):this.map(function(e){return rt(e,t,i)})}),be.prototype.reject=function(e){return this.filter(po(Li(e)))},be.prototype.slice=function(e,t){e=Uo(e);var i=this;return i.__filtered__&&(0<e||t<0)?new be(i):(e<0?i=i.takeRight(-e):e&&(i=i.drop(e)),t!==na&&(i=(t=Uo(t))<0?i.dropRight(-t):i.take(t-e)),i)},be.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},be.prototype.toArray=function(){return this.take(ca)},Qe(be.prototype,function(d,e){var h=/^(?:filter|find|map|reject)|While$/.test(e),p=/^(?:head|last)$/.test(e),f=fe[p?"take"+("last"==e?"Right":""):e],g=p||/^find/.test(e);f&&(fe.prototype[e]=function(){function e(e){var t=f.apply(fe,zs([e],i));return p&&a?t[0]:t}var t=this.__wrapped__,i=p?[1]:arguments,n=t instanceof be,o=i[0],r=n||_o(t);r&&h&&"function"==typeof o&&1!=o.length&&(n=r=!1);var a=this.__chain__,s=!!this.__actions__.length,l=g&&!a,c=n&&!s;if(g||!r)return l&&c?d.apply(this,i):(u=this.thru(e),l?p?u.value()[0]:u.value():u);t=c?t:new be(this);var u=d.apply(t,i);return u.__actions__.push({func:zn,args:[e],thisArg:na}),new ye(u,a)})}),Ls(["pop","push","shift","sort","splice","unshift"],function(e){var i=a[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",o=/^(?:pop|shift)$/.test(e);fe.prototype[e]=function(){var t=arguments;if(!o||this.__chain__)return this[n](function(e){return i.apply(_o(e)?e:[],t)});var e=this.value();return i.apply(_o(e)?e:[],t)}}),Qe(be.prototype,function(e,t){var i=fe[t];if(i){var n=i.name+"";w.call(re,n)||(re[n]=[]),re[n].push({name:t,func:i})}}),re[gi(na,2).name]=[{name:"wrapper",func:na}],be.prototype.clone=function(){var e=new be(this.__wrapped__);return e.__actions__=oi(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=oi(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=oi(this.__views__),e},be.prototype.reverse=function(){if(this.__filtered__){var e=new be(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},be.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,i=_o(e),n=t<0,o=i?e.length:0,r=function(e,t,i){var n=-1,o=i.length;for(;++n<o;){var r=i[n],a=r.size;switch(r.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=Y(t,e+a);break;case"takeRight":e=U(e,t-a)}}return{start:e,end:t}}(0,o,this.__views__),a=r.start,s=r.end,l=s-a,c=n?s:a-1,u=this.__iteratees__,d=u.length,h=0,p=Y(l,this.__takeCount__);if(!i||!n&&o==l&&p==l)return Ht(e,this.__actions__);var f=[];e:for(;l--&&h<p;){for(var g=-1,m=e[c+=t];++g<d;){var v=u[g],y=v.iteratee,b=v.type,w=y(m);if(2==b)m=w;else if(!w){if(1==b)continue e;break e}}f[h++]=m}return f},fe.prototype.at=Vn,fe.prototype.chain=function(){return Hn(this)},fe.prototype.commit=function(){return new ye(this.value(),this.__chain__)},fe.prototype.next=function(){this.__values__===na&&(this.__values__=zo(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?na:this.__values__[this.__index__++]}},fe.prototype.plant=function(e){for(var t,i=this;i instanceof ve;){var n=mn(i);n.__index__=0,n.__values__=na,t?o.__wrapped__=n:t=n;var o=n;i=i.__wrapped__}return o.__wrapped__=e,t},fe.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof be){var t=e;return this.__actions__.length&&(t=new be(this)),(t=t.reverse()).__actions__.push({func:zn,args:[On],thisArg:na}),new ye(t,this.__chain__)}return this.thru(On)},fe.prototype.toJSON=fe.prototype.valueOf=fe.prototype.value=function(){return Ht(this.__wrapped__,this.__actions__)},fe.prototype.first=fe.prototype.head,F&&(fe.prototype[F]=function(){return this}),fe}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(Ts._=wl,define(function(){return wl})):M?((M.exports=wl)._=wl,F._=wl):Ts._=wl}.call(this),function(c,i,a){var n={};function u(e){var t=i.console;n[e]||(n[e]=!0,c.migrateWarnings.push(e),t&&t.warn&&!c.migrateMute&&(t.warn("JQMIGRATE: "+e),c.migrateTrace&&t.trace&&t.trace()))}function e(e,t,i,n){if(Object.defineProperty)try{return void Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){return u(n),i},set:function(e){u(n),i=e}})}catch(e){}c._definePropertyBroken=!0,e[t]=i}c.migrateWarnings=[],!c.migrateMute&&i.console&&i.console.log&&i.console.log("JQMIGRATE: Logging is active"),c.migrateTrace===a&&(c.migrateTrace=!0),c.migrateReset=function(){n={},c.migrateWarnings.length=0},"BackCompat"===document.compatMode&&u("jQuery is not compatible with Quirks Mode");var s=c("<input/>",{size:1}).attr("size")&&c.attrFn,l=c.attr,o=c.attrHooks.value&&c.attrHooks.value.get||function(){return null},r=c.attrHooks.value&&c.attrHooks.value.set||function(){return a},d=/^(?:input|button)$/i,h=/^[238]$/,p=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,f=/^(?:checked|selected)$/i;e(c,"attrFn",s||{},"jQuery.attrFn is deprecated"),c.attr=function(e,t,i,n){var o=t.toLowerCase(),r=e&&e.nodeType;return n&&(l.length<4&&u("jQuery.fn.attr( props, pass ) is deprecated"),e&&!h.test(r)&&(s?t in s:c.isFunction(c.fn[t])))?c(e)[t](i):("type"===t&&i!==a&&d.test(e.nodeName)&&e.parentNode&&u("Can't change the 'type' of an input or button in IE 6/7/8"),!c.attrHooks[o]&&p.test(o)&&(c.attrHooks[o]={get:function(e,t){var i,n=c.prop(e,t);return!0===n||"boolean"!=typeof n&&(i=e.getAttributeNode(t))&&!1!==i.nodeValue?t.toLowerCase():a},set:function(e,t,i){var n;return!1===t?c.removeAttr(e,i):((n=c.propFix[i]||i)in e&&(e[n]=!0),e.setAttribute(i,i.toLowerCase())),i}},f.test(o)&&u("jQuery.fn.attr('"+o+"') may use property instead of attribute")),l.call(c,e,t,i))},c.attrHooks.value={get:function(e,t){var i=(e.nodeName||"").toLowerCase();return"button"===i?o.apply(this,arguments):("input"!==i&&"option"!==i&&u("jQuery.fn.attr('value') no longer gets properties"),t in e?e.value:null)},set:function(e,t){var i=(e.nodeName||"").toLowerCase();if("button"===i)return r.apply(this,arguments);"input"!==i&&"option"!==i&&u("jQuery.fn.attr('value', val) no longer sets properties"),e.value=t}};var t,g,m=c.fn.init,v=c.parseJSON,y=/^([^<]*)(<[\w\W]+>)([^>]*)$/;c.fn.init=function(e,t,i){var n;return e&&"string"==typeof e&&!c.isPlainObject(t)&&(n=y.exec(c.trim(e)))&&n[0]&&("<"!==e.charAt(0)&&u("$(html) HTML strings must start with '<' character"),n[3]&&u("$(html) HTML text after last tag is ignored"),"#"===n[0].charAt(0)&&(u("HTML string cannot start with a '#' character"),c.error("JQMIGRATE: Invalid selector string (XSS)")),t&&t.context&&(t=t.context),c.parseHTML)?m.call(this,c.parseHTML(n[2],t,!0),t,i):m.apply(this,arguments)},c.fn.init.prototype=c.fn,c.parseJSON=function(e){return e||null===e?v.apply(this,arguments):(u("jQuery.parseJSON requires a valid JSON string"),null)},c.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},c.browser||(g={},(t=c.uaMatch(navigator.userAgent)).browser&&(g[t.browser]=!0,g.version=t.version),g.chrome?g.webkit=!0:g.webkit&&(g.safari=!0),c.browser=g),e(c,"browser",c.browser,"jQuery.browser is deprecated"),c.sub=function(){function i(e,t){return new i.fn.init(e,t)}c.extend(!0,i,this),i.superclass=this,((i.fn=i.prototype=this()).constructor=i).sub=this.sub,i.fn.init=function(e,t){return t&&t instanceof c&&!(t instanceof i)&&(t=i(t)),c.fn.init.call(this,e,t,n)},i.fn.init.prototype=i.fn;var n=i(document);return u("jQuery.sub() is deprecated"),i},c.ajaxSetup({converters:{"text json":c.parseJSON}});var b=c.fn.data;c.fn.data=function(e){var t,i,n=this[0];return!n||"events"!==e||1!==arguments.length||(t=c.data(n,e),i=c._data(n,e),t!==a&&t!==i||i===a)?b.apply(this,arguments):(u("Use of jQuery.fn.data('events') is deprecated"),i)};var w=/\/(java|ecma)script/i,C=c.fn.andSelf||c.fn.addBack;c.fn.andSelf=function(){return u("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),C.apply(this,arguments)},c.clean||(c.clean=function(e,t,i,n){t=(t=!(t=t||document).nodeType&&t[0]||t).ownerDocument||t,u("jQuery.clean() is deprecated");var o,r,a,s,l=[];if(c.merge(l,c.buildFragment(e,t).childNodes),i)for(a=function(e){if(!e.type||w.test(e.type))return n?n.push(e.parentNode?e.parentNode.removeChild(e):e):i.appendChild(e)},o=0;null!=(r=l[o]);o++)c.nodeName(r,"script")&&a(r)||(i.appendChild(r),void 0!==r.getElementsByTagName&&(s=c.grep(c.merge([],r.getElementsByTagName("script")),a),l.splice.apply(l,[o+1,0].concat(s)),o+=s.length));return l});function _(e){return"string"!=typeof e||c.event.special.hover?e:(O.test(e)&&u("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'"),e&&e.replace(O,"mouseenter$1 mouseleave$1"))}var A=c.event.add,E=c.event.remove,x=c.event.trigger,S=c.fn.toggle,T=c.fn.live,D=c.fn.die,k="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",R=new RegExp("\\b(?:"+k+")\\b"),O=/(?:^|\s)hover(\.\S+|)\b/;c.event.props&&"attrChange"!==c.event.props[0]&&c.event.props.unshift("attrChange","attrName","relatedNode","srcElement"),c.event.dispatch&&e(c.event,"handle",c.event.dispatch,"jQuery.event.handle is undocumented and deprecated"),c.event.add=function(e,t,i,n,o){e!==document&&R.test(t)&&u("AJAX events should be attached to document: "+t),A.call(this,e,_(t||""),i,n,o)},c.event.remove=function(e,t,i,n,o){E.call(this,e,_(t)||"",i,n,o)},c.fn.error=function(){var e=Array.prototype.slice.call(arguments,0);return u("jQuery.fn.error() is deprecated"),e.splice(0,0,"error"),arguments.length?this.bind.apply(this,e):(this.triggerHandler.apply(this,e),this)},c.fn.toggle=function(i,e){if(!c.isFunction(i)||!c.isFunction(e))return S.apply(this,arguments);u("jQuery.fn.toggle(handler, handler...) is deprecated");function t(e){var t=(c._data(this,"lastToggle"+i.guid)||0)%r;return c._data(this,"lastToggle"+i.guid,1+t),e.preventDefault(),n[t].apply(this,arguments)||!1}var n=arguments,o=i.guid||c.guid++,r=0;for(t.guid=o;r<n.length;)n[r++].guid=o;return this.click(t)},c.fn.live=function(e,t,i){return u("jQuery.fn.live() is deprecated"),T?T.apply(this,arguments):(c(this.context).on(e,this.selector,t,i),this)},c.fn.die=function(e,t){return u("jQuery.fn.die() is deprecated"),D?D.apply(this,arguments):(c(this.context).off(e,this.selector||"**",t),this)},c.event.trigger=function(e,t,i,n){return i||R.test(e)||u("Global events are undocumented and deprecated"),x.call(this,e,t,i||document,n)},c.each(k.split("|"),function(e,t){c.event.special[t]={setup:function(){var e=this;return e!==document&&(c.event.add(document,t+"."+c.guid,function(){c.event.trigger(t,null,e,!0)}),c._data(this,t,c.guid++)),!1},teardown:function(){return this!==document&&c.event.remove(document,t+"."+c._data(this,t)),!1}}})}(jQuery,window),function(i){var t=Array.prototype.slice,n={dict:null,load:function(e){null!==this.dict?i.extend(this.dict,e):this.dict=e},_:function(e){return dict=this.dict,dict&&dict.hasOwnProperty(e)&&(e=dict[e]),args=t.call(arguments),args[0]=e,this.printf.apply(this,args)},printf:function(e,n){return arguments.length<2?e:(n=i.isArray(n)?n:t.call(arguments,1),e.replace(/([^%]|^)%(?:(\d+)\$)?s/g,function(e,t,i){return i?t+n[parseInt(i)-1]:t+n.shift()}).replace(/%%s/g,"%s"))}};i.fn._t=function(e,t){return i(this).html(n._.apply(n,arguments))},i.i18n=n}(jQuery),function(o){void 0===o.fn.each2&&o.extend(o.fn,{each2:function(e){for(var t=o([0]),i=-1,n=this.length;++i<n&&(t.context=t[0]=this[i])&&!1!==e.call(t[0],i,t););return this}})}(jQuery),function(C,w){"use strict";if(window.Select2===w){var e,t,i,_,r,o,A,n,a={x:0,y:0},s={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case s.LEFT:case s.RIGHT:case s.UP:case s.DOWN:return!0}return!1},isControl:function(e){switch(e.which){case s.SHIFT:case s.CTRL:case s.ALT:return!0}return!!e.metaKey},isFunctionKey:function(e){return 112<=(e=e.which?e.which:e)&&e<=123}},l={"‚í∂":"A","Ôº°":"A","√Ä":"A","√Å":"A","√Ç":"A","·∫¶":"A","·∫§":"A","·∫™":"A","·∫®":"A","√É":"A","ƒÄ":"A","ƒÇ":"A","·∫∞":"A","·∫Æ":"A","·∫¥":"A","·∫≤":"A","»¶":"A","«†":"A","√Ñ":"A","«û":"A","·∫¢":"A","√Ö":"A","«∫":"A","«ç":"A","»Ä":"A","»Ç":"A","·∫†":"A","·∫¨":"A","·∫∂":"A","·∏Ä":"A","ƒÑ":"A","»∫":"A","‚±Ø":"A","Íú≤":"AA","√Ü":"AE","«º":"AE","«¢":"AE","Íú¥":"AO","Íú∂":"AU","Íú∏":"AV","Íú∫":"AV","Íúº":"AY","‚í∑":"B","Ôº¢":"B","·∏Ç":"B","·∏Ñ":"B","·∏Ü":"B","…É":"B","∆Ç":"B","∆Å":"B","‚í∏":"C","Ôº£":"C","ƒÜ":"C","ƒà":"C","ƒä":"C","ƒå":"C","√á":"C","·∏à":"C","∆á":"C","»ª":"C","Íúæ":"C","‚íπ":"D","Ôº§":"D","·∏ä":"D","ƒé":"D","·∏å":"D","·∏ê":"D","·∏í":"D","·∏é":"D","ƒê":"D","∆ã":"D","∆ä":"D","∆â":"D","Íùπ":"D","«±":"DZ","«Ñ":"DZ","«≤":"Dz","«Ö":"Dz","‚í∫":"E","Ôº•":"E","√à":"E","√â":"E","√ä":"E","·ªÄ":"E","·∫æ":"E","·ªÑ":"E","·ªÇ":"E","·∫º":"E","ƒí":"E","·∏î":"E","·∏ñ":"E","ƒî":"E","ƒñ":"E","√ã":"E","·∫∫":"E","ƒö":"E","»Ñ":"E","»Ü":"E","·∫∏":"E","·ªÜ":"E","»®":"E","·∏ú":"E","ƒò":"E","·∏ò":"E","·∏ö":"E","∆ê":"E","∆é":"E","‚íª":"F","Ôº¶":"F","·∏û":"F","∆ë":"F","Íùª":"F","‚íº":"G","Ôºß":"G","«¥":"G","ƒú":"G","·∏†":"G","ƒû":"G","ƒ†":"G","«¶":"G","ƒ¢":"G","«§":"G","∆ì":"G","Íû†":"G","ÍùΩ":"G","Íùæ":"G","‚íΩ":"H","Ôº®":"H","ƒ§":"H","·∏¢":"H","·∏¶":"H","»û":"H","·∏§":"H","·∏®":"H","·∏™":"H","ƒ¶":"H","‚±ß":"H","‚±µ":"H","Íûç":"H","‚íæ":"I","Ôº©":"I","√å":"I","√ç":"I","√é":"I","ƒ®":"I","ƒ™":"I","ƒ¨":"I","ƒ∞":"I","√è":"I","·∏Æ":"I","·ªà":"I","«è":"I","»à":"I","»ä":"I","·ªä":"I","ƒÆ":"I","·∏¨":"I","∆ó":"I","‚íø":"J","Ôº™":"J","ƒ¥":"J","…à":"J","‚ìÄ":"K","Ôº´":"K","·∏∞":"K","«®":"K","·∏≤":"K","ƒ∂":"K","·∏¥":"K","∆ò":"K","‚±©":"K","ÍùÄ":"K","ÍùÇ":"K","ÍùÑ":"K","Íû¢":"K","‚ìÅ":"L","Ôº¨":"L","ƒø":"L","ƒπ":"L","ƒΩ":"L","·∏∂":"L","·∏∏":"L","ƒª":"L","·∏º":"L","·∏∫":"L","≈Å":"L","»Ω":"L","‚±¢":"L","‚±†":"L","Íùà":"L","ÍùÜ":"L","ÍûÄ":"L","«á":"LJ","«à":"Lj","‚ìÇ":"M","Ôº≠":"M","·∏æ":"M","·πÄ":"M","·πÇ":"M","‚±Æ":"M","∆ú":"M","‚ìÉ":"N","ÔºÆ":"N","«∏":"N","≈É":"N","√ë":"N","·πÑ":"N","≈á":"N","·πÜ":"N","≈Ö":"N","·πä":"N","·πà":"N","»†":"N","∆ù":"N","Íûê":"N","Íû§":"N","«ä":"NJ","«ã":"Nj","‚ìÑ":"O","ÔºØ":"O","√í":"O","√ì":"O","√î":"O","·ªí":"O","·ªê":"O","·ªñ":"O","·ªî":"O","√ï":"O","·πå":"O","»¨":"O","·πé":"O","≈å":"O","·πê":"O","·πí":"O","≈é":"O","»Æ":"O","»∞":"O","√ñ":"O","»™":"O","·ªé":"O","≈ê":"O","«ë":"O","»å":"O","»é":"O","∆†":"O","·ªú":"O","·ªö":"O","·ª†":"O","·ªû":"O","·ª¢":"O","·ªå":"O","·ªò":"O","«™":"O","«¨":"O","√ò":"O","«æ":"O","∆Ü":"O","∆ü":"O","Íùä":"O","Íùå":"O","∆¢":"OI","Íùé":"OO","»¢":"OU","‚ìÖ":"P","Ôº∞":"P","·πî":"P","·πñ":"P","∆§":"P","‚±£":"P","Íùê":"P","Íùí":"P","Íùî":"P","‚ìÜ":"Q","Ôº±":"Q","Íùñ":"Q","Íùò":"Q","…ä":"Q","‚ìá":"R","Ôº≤":"R","≈î":"R","·πò":"R","≈ò":"R","»ê":"R","»í":"R","·πö":"R","·πú":"R","≈ñ":"R","·πû":"R","…å":"R","‚±§":"R","Íùö":"R","Íû¶":"R","ÍûÇ":"R","‚ìà":"S","Ôº≥":"S","·∫û":"S","≈ö":"S","·π§":"S","≈ú":"S","·π†":"S","≈†":"S","·π¶":"S","·π¢":"S","·π®":"S","»ò":"S","≈û":"S","‚±æ":"S","Íû®":"S","ÍûÑ":"S","‚ìâ":"T","Ôº¥":"T","·π™":"T","≈§":"T","·π¨":"T","»ö":"T","≈¢":"T","·π∞":"T","·πÆ":"T","≈¶":"T","∆¨":"T","∆Æ":"T","»æ":"T","ÍûÜ":"T","Íú®":"TZ","‚ìä":"U","Ôºµ":"U","√ô":"U","√ö":"U","√õ":"U","≈®":"U","·π∏":"U","≈™":"U","·π∫":"U","≈¨":"U","√ú":"U","«õ":"U","«ó":"U","«ï":"U","«ô":"U","·ª¶":"U","≈Æ":"U","≈∞":"U","«ì":"U","»î":"U","»ñ":"U","∆Ø":"U","·ª™":"U","·ª®":"U","·ªÆ":"U","·ª¨":"U","·ª∞":"U","·ª§":"U","·π≤":"U","≈≤":"U","·π∂":"U","·π¥":"U","…Ñ":"U","‚ìã":"V","Ôº∂":"V","·πº":"V","·πæ":"V","∆≤":"V","Íùû":"V","…Ö":"V","Íù†":"VY","‚ìå":"W","Ôº∑":"W","·∫Ä":"W","·∫Ç":"W","≈¥":"W","·∫Ü":"W","·∫Ñ":"W","·∫à":"W","‚±≤":"W","‚ìç":"X","Ôº∏":"X","·∫ä":"X","·∫å":"X","‚ìé":"Y","Ôºπ":"Y","·ª≤":"Y","√ù":"Y","≈∂":"Y","·ª∏":"Y","»≤":"Y","·∫é":"Y","≈∏":"Y","·ª∂":"Y","·ª¥":"Y","∆≥":"Y","…é":"Y","·ªæ":"Y","‚ìè":"Z","Ôº∫":"Z","≈π":"Z","·∫ê":"Z","≈ª":"Z","≈Ω":"Z","·∫í":"Z","·∫î":"Z","∆µ":"Z","»§":"Z","‚±ø":"Z","‚±´":"Z","Íù¢":"Z","‚ìê":"a","ÔΩÅ":"a","·∫ö":"a","√†":"a","√°":"a","√¢":"a","·∫ß":"a","·∫•":"a","·∫´":"a","·∫©":"a","√£":"a","ƒÅ":"a","ƒÉ":"a","·∫±":"a","·∫Ø":"a","·∫µ":"a","·∫≥":"a","»ß":"a","«°":"a","√§":"a","«ü":"a","·∫£":"a","√•":"a","«ª":"a","«é":"a","»Å":"a","»É":"a","·∫°":"a","·∫≠":"a","·∫∑":"a","·∏Å":"a","ƒÖ":"a","‚±•":"a","…ê":"a","Íú≥":"aa","√¶":"ae","«Ω":"ae","«£":"ae","Íúµ":"ao","Íú∑":"au","Íúπ":"av","Íúª":"av","ÍúΩ":"ay","‚ìë":"b","ÔΩÇ":"b","·∏É":"b","·∏Ö":"b","·∏á":"b","∆Ä":"b","∆É":"b","…ì":"b","‚ìí":"c","ÔΩÉ":"c","ƒá":"c","ƒâ":"c","ƒã":"c","ƒç":"c","√ß":"c","·∏â":"c","∆à":"c","»º":"c","Íúø":"c","‚ÜÑ":"c","‚ìì":"d","ÔΩÑ":"d","·∏ã":"d","ƒè":"d","·∏ç":"d","·∏ë":"d","·∏ì":"d","·∏è":"d","ƒë":"d","∆å":"d","…ñ":"d","…ó":"d","Íù∫":"d","«≥":"dz","«Ü":"dz","‚ìî":"e","ÔΩÖ":"e","√®":"e","√©":"e","√™":"e","·ªÅ":"e","·∫ø":"e","·ªÖ":"e","·ªÉ":"e","·∫Ω":"e","ƒì":"e","·∏ï":"e","·∏ó":"e","ƒï":"e","ƒó":"e","√´":"e","·∫ª":"e","ƒõ":"e","»Ö":"e","»á":"e","·∫π":"e","·ªá":"e","»©":"e","·∏ù":"e","ƒô":"e","·∏ô":"e","·∏õ":"e","…á":"e","…õ":"e","«ù":"e","‚ìï":"f","ÔΩÜ":"f","·∏ü":"f","∆í":"f","Íùº":"f","‚ìñ":"g","ÔΩá":"g","«µ":"g","ƒù":"g","·∏°":"g","ƒü":"g","ƒ°":"g","«ß":"g","ƒ£":"g","«•":"g","…†":"g","Íû°":"g","·µπ":"g","Íùø":"g","‚ìó":"h","ÔΩà":"h","ƒ•":"h","·∏£":"h","·∏ß":"h","»ü":"h","·∏•":"h","·∏©":"h","·∏´":"h","·∫ñ":"h","ƒß":"h","‚±®":"h","‚±∂":"h","…•":"h","∆ï":"hv","‚ìò":"i","ÔΩâ":"i","√¨":"i","√≠":"i","√Æ":"i","ƒ©":"i","ƒ´":"i","ƒ≠":"i","√Ø":"i","·∏Ø":"i","·ªâ":"i","«ê":"i","»â":"i","»ã":"i","·ªã":"i","ƒØ":"i","·∏≠":"i","…®":"i","ƒ±":"i","‚ìô":"j","ÔΩä":"j","ƒµ":"j","«∞":"j","…â":"j","‚ìö":"k","ÔΩã":"k","·∏±":"k","«©":"k","·∏≥":"k","ƒ∑":"k","·∏µ":"k","∆ô":"k","‚±™":"k","ÍùÅ":"k","ÍùÉ":"k","ÍùÖ":"k","Íû£":"k","‚ìõ":"l","ÔΩå":"l","≈Ä":"l","ƒ∫":"l","ƒæ":"l","·∏∑":"l","·∏π":"l","ƒº":"l","·∏Ω":"l","·∏ª":"l","≈ø":"l","≈Ç":"l","∆ö":"l","…´":"l","‚±°":"l","Íùâ":"l","ÍûÅ":"l","Íùá":"l","«â":"lj","‚ìú":"m","ÔΩç":"m","·∏ø":"m","·πÅ":"m","·πÉ":"m","…±":"m","…Ø":"m","‚ìù":"n","ÔΩé":"n","«π":"n","≈Ñ":"n","√±":"n","·πÖ":"n","≈à":"n","·πá":"n","≈Ü":"n","·πã":"n","·πâ":"n","∆û":"n","…≤":"n","≈â":"n","Íûë":"n","Íû•":"n","«å":"nj","‚ìû":"o","ÔΩè":"o","√≤":"o","√≥":"o","√¥":"o","·ªì":"o","·ªë":"o","·ªó":"o","·ªï":"o","√µ":"o","·πç":"o","»≠":"o","·πè":"o","≈ç":"o","·πë":"o","·πì":"o","≈è":"o","»Ø":"o","»±":"o","√∂":"o","»´":"o","·ªè":"o","≈ë":"o","«í":"o","»ç":"o","»è":"o","∆°":"o","·ªù":"o","·ªõ":"o","·ª°":"o","·ªü":"o","·ª£":"o","·ªç":"o","·ªô":"o","«´":"o","«≠":"o","√∏":"o","«ø":"o","…î":"o","Íùã":"o","Íùç":"o","…µ":"o","∆£":"oi","»£":"ou","Íùè":"oo","‚ìü":"p","ÔΩê":"p","·πï":"p","·πó":"p","∆•":"p","·µΩ":"p","Íùë":"p","Íùì":"p","Íùï":"p","‚ì†":"q","ÔΩë":"q","…ã":"q","Íùó":"q","Íùô":"q","‚ì°":"r","ÔΩí":"r","≈ï":"r","·πô":"r","≈ô":"r","»ë":"r","»ì":"r","·πõ":"r","·πù":"r","≈ó":"r","·πü":"r","…ç":"r","…Ω":"r","Íùõ":"r","Íûß":"r","ÍûÉ":"r","‚ì¢":"s","ÔΩì":"s","√ü":"s","≈õ":"s","·π•":"s","≈ù":"s","·π°":"s","≈°":"s","·πß":"s","·π£":"s","·π©":"s","»ô":"s","≈ü":"s","»ø":"s","Íû©":"s","ÍûÖ":"s","·∫õ":"s","‚ì£":"t","ÔΩî":"t","·π´":"t","·∫ó":"t","≈•":"t","·π≠":"t","»õ":"t","≈£":"t","·π±":"t","·πØ":"t","≈ß":"t","∆≠":"t"," à":"t","‚±¶":"t","Íûá":"t","Íú©":"tz","‚ì§":"u","ÔΩï":"u","√π":"u","√∫":"u","√ª":"u","≈©":"u","·ππ":"u","≈´":"u","·πª":"u","≈≠":"u","√º":"u","«ú":"u","«ò":"u","«ñ":"u","«ö":"u","·ªß":"u","≈Ø":"u","≈±":"u","«î":"u","»ï":"u","»ó":"u","∆∞":"u","·ª´":"u","·ª©":"u","·ªØ":"u","·ª≠":"u","·ª±":"u","·ª•":"u","·π≥":"u","≈≥":"u","·π∑":"u","·πµ":"u"," â":"u","‚ì•":"v","ÔΩñ":"v","·πΩ":"v","·πø":"v"," ã":"v","Íùü":"v"," å":"v","Íù°":"vy","‚ì¶":"w","ÔΩó":"w","·∫Å":"w","·∫É":"w","≈µ":"w","·∫á":"w","·∫Ö":"w","·∫ò":"w","·∫â":"w","‚±≥":"w","‚ìß":"x","ÔΩò":"x","·∫ã":"x","·∫ç":"x","‚ì®":"y","ÔΩô":"y","·ª≥":"y","√Ω":"y","≈∑":"y","·ªπ":"y","»≥":"y","·∫è":"y","√ø":"y","·ª∑":"y","·∫ô":"y","·ªµ":"y","∆¥":"y","…è":"y","·ªø":"y","‚ì©":"z","ÔΩö":"z","≈∫":"z","·∫ë":"z","≈º":"z","≈æ":"z","·∫ì":"z","·∫ï":"z","∆∂":"z","»•":"z","…Ä":"z","‚±¨":"z","Íù£":"z","ŒÜ":"Œë","Œà":"Œï","Œâ":"Œó","Œä":"Œô","Œ™":"Œô","Œå":"Œü","Œé":"Œ•","Œ´":"Œ•","Œè":"Œ©","Œ¨":"Œ±","Œ≠":"Œµ","ŒÆ":"Œ∑","ŒØ":"Œπ","œä":"Œπ","Œê":"Œπ","œå":"Œø","œç":"œÖ","œã":"œÖ","Œ∞":"œÖ","œâ":"œâ","œÇ":"œÉ"};o=C(document),n=1,_=function(){return n++},t=O(e=O(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(e){var r,t,i=".select2-results";this.opts=e=this.prepareOpts(e),this.id=e.id,e.element.data("select2")!==w&&null!==e.element.data("select2")&&e.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=C(".select2-hidden-accessible"),0==this.liveRegion.length&&(this.liveRegion=C("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body)),this.containerId="s2id_"+(e.element.attr("id")||"autogen"+_()),this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.container.attr("title",e.element.attr("title")),this.body=C(document.body),y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",e.element.attr("style")),this.container.css(k(e.containerCss,this.opts.element)),this.container.addClass(k(e.containerCssClass,this.opts.element)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",v),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(k(e.dropdownCssClass,this.opts.element)),this.dropdown.data("select2",this),this.dropdown.on("click",v),this.results=r=this.container.find(i),this.search=t=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",function(e){if(!e.target||!C(e.target).is(".select2-search-choice *"))return v(e)}),function(e){e.on("mousemove",function(e){var t=a;t!==w&&t.x===e.pageX&&t.y===e.pageY||C(e.target).trigger("mousemove-filtered",e)})}(this.results),this.dropdown.on("mousemove-filtered",i,this.bind(this.highlightUnderEvent)),this.dropdown.on("touchstart touchmove touchend",i,this.bind(function(e){this._touchEvent=!0,this.highlightUnderEvent(e)})),this.dropdown.on("touchmove",i,this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",i,this.bind(this.clearTouchMoved)),this.dropdown.on("click",this.bind(function(e){this._touchEvent&&(this._touchEvent=!1,this.selectHighlighted())})),function(e,t){var i=m(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){0<=d(e.target,t.get())&&i(e)})}(80,this.results),this.dropdown.on("scroll-debounced",i,this.bind(this.loadMoreIfNeeded)),C(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),C(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),C.fn.mousewheel&&r.mousewheel(function(e,t,i,n){var o=r.scrollTop();0<n&&o-n<=0?(r.scrollTop(0),v(e)):n<0&&r.get(0).scrollHeight-r.scrollTop()+n<=r.height()&&(r.scrollTop(r.get(0).scrollHeight-r.height()),v(e))}),g(t),t.on("keyup-change input paste",this.bind(this.updateResults)),t.on("focus",function(){t.addClass("select2-focused")}),t.on("blur",function(){t.removeClass("select2-focused")}),this.dropdown.on("mouseup",i,this.bind(function(e){0<C(e.target).closest(".select2-result-selectable").length&&(this.highlightUnderEvent(e),this.selectHighlighted(e))})),this.dropdown.on("click mouseup mousedown touchstart touchend focusin",function(e){var t=C.Event(e.type+".sortable");e.stopPropagation(),C(e.target).trigger(t)}),this.nextSearchTerm=w,C.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==e.maximumInputLength&&this.search.attr("maxlength",e.maximumInputLength);var n=e.element.prop("disabled");n===w&&(n=!1),this.enable(!n);var o=e.element.prop("readonly");o===w&&(o=!1),this.readonly(o),A=A||function(){var e=C("<div class='select2-measure-scrollbar'></div>");e.appendTo(document.body);var t={width:e.width()-e[0].clientWidth,height:e.height()-e[0].clientHeight};return e.remove(),t}(),this.autofocus=e.element.prop("autofocus"),e.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",e.searchInputPlaceholder)},destroy:function(){var e=this.opts.element,t=e.data("select2"),i=this;this.close(),e.length&&e[0].detachEvent&&i._sync&&e.each(function(){i._sync&&this.detachEvent("onpropertychange",i._sync)}),this.propertyObserver&&(this.propertyObserver.disconnect(),this.propertyObserver=null),this._sync=null,t!==w&&(t.container.remove(),t.liveRegion.remove(),t.dropdown.remove(),e.show().removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show()),R.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(e){return e.is("option")?{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:p(e.attr("locked"),"locked")||p(e.data("locked"),!0)}:e.is("optgroup")?{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}:void 0},prepareOpts:function(y){var n,e,t,i,b=this;if("select"===(n=y.element).get(0).tagName.toLowerCase()&&(this.select=e=y.element),e&&C.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in y)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),"function"!=typeof(y=C.extend({},{populateResults:function(e,t,f){var g,m=this.opts.id,v=this.liveRegion;(g=function(e,t,i){var n,o,r,a,s,l,c,u,d,h,p=[];for(n=0,o=(e=y.sortResults(e,t,f)).length;n<o;n+=1)a=!(s=!0===(r=e[n]).disabled)&&m(r)!==w,l=r.children&&0<r.children.length,(c=C("<li></li>")).addClass("select2-results-dept-"+i),c.addClass("select2-result"),c.addClass(a?"select2-result-selectable":"select2-result-unselectable"),s&&c.addClass("select2-disabled"),l&&c.addClass("select2-result-with-children"),c.addClass(b.opts.formatResultCssClass(r)),c.attr("role","presentation"),(u=C(document.createElement("div"))).addClass("select2-result-label"),u.attr("id","select2-result-label-"+_()),u.attr("role","option"),(h=y.formatResult(r,u,f,b.opts.escapeMarkup))!==w&&(u.html(h),c.append(u)),l&&((d=C("<ul></ul>")).addClass("select2-result-sub"),g(r.children,d,i+1),c.append(d)),c.data("select2-data",r),p.push(c[0]);t.append(p),v.text(y.formatMatches(e.length))})(t,e,0)}},C.fn.select2.defaults,y)).id&&(t=y.id,y.id=function(e){return e[t]}),C.isArray(y.element.data("select2Tags"))){if("tags"in y)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+y.element.attr("id");y.tags=y.element.data("select2Tags")}if(e){var l=e.hasClass("js-tree-select");y.query=this.bind(function(o){var e,t,r,i={results:[],more:!1},a=o.term;if(e=n.children(),this.getPlaceholder()!==w&&0<e.length&&(t=this.getPlaceholderOption())&&(e=e.not(t)),l){var s=function(e){var n=[],o=null;return e.each2(function(e,t){var i={element:C(t[0]),id:parseInt(t.data("id")),children:[]};t.is("option")?o&&o.id==parseInt(t.data("parent-id"))?o.children.push(i):(o=i,n.push(i)):t.is("optgroup")&&(i.children=s(t.children()),n.push(i),o=null)}),n};(r=function(e,n){e.forEach(function(e){if(e.element.is("option")){var t=[];r(e.children,t),o.matcher(a,e.element.text(),e.element)?n.push(C.extend(b.optionToData(e.element),{children:t})):0<t.length&&n.push(C.extend(b.optionToData(e.element),{disabled:!0,children:t}))}else if(e.element.is("optgroup")){var i=b.optionToData(e.element);r(e.children,i.children),0<i.children.length&&n.push(i)}})})(s(e),i.results)}else r=function(e,t){var i;e.is("option")?o.matcher(a,e.text(),e)&&t.push(b.optionToData(e)):e.is("optgroup")&&(i=b.optionToData(e),e.children().each2(function(e,t){r(t,i.children)}),0<i.children.length&&t.push(i))},e.each2(function(e,t){r(t,i.results)});o.callback(i)}),y.id=function(e){return e.id}}else"query"in y||("ajax"in y?((i=y.element.data("ajax-url"))&&0<i.length&&(y.ajax.url=i),y.query=x.call(y.element,y.ajax)):"data"in y?y.query=S(y.data):"tags"in y&&(y.query=T(y.tags),y.createSearchChoice===w&&(y.createSearchChoice=function(e){return{id:C.trim(e),text:C.trim(e)}}),y.initSelection===w&&(y.initSelection=function(e,t){var i=[];C(h(e.val(),y.separator,y.transformVal)).each(function(){var e={id:this,text:this},t=y.tags;C.isFunction(t)&&(t=t()),C(t).each(function(){if(p(this.id,e.id))return e=this,!1}),i.push(e)}),t(i)})));if("function"!=typeof y.query)throw"query function not defined for Select2 "+y.element.attr("id");if("top"===y.createSearchChoicePosition)y.createSearchChoicePosition=function(e,t){e.unshift(t)};else if("bottom"===y.createSearchChoicePosition)y.createSearchChoicePosition=function(e,t){e.push(t)};else if("function"!=typeof y.createSearchChoicePosition)throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return y},monitorSource:function(){var e,i=this.opts.element,t=this;i.on("change.select2",this.bind(function(e){!0!==this.opts.element.data("select2-change-triggered")&&this.initSelection()})),this._sync=this.bind(function(){var e=i.prop("disabled");e===w&&(e=!1),this.enable(!e);var t=i.prop("readonly");t===w&&(t=!1),this.readonly(t),this.container&&(y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(k(this.opts.containerCssClass,this.opts.element))),this.dropdown&&(y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(k(this.opts.dropdownCssClass,this.opts.element)))}),i.length&&i[0].attachEvent&&i.each(function(){this.attachEvent("onpropertychange",t._sync)}),(e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)!==w&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new e(function(e){C.each(e,t._sync)}),this.propertyObserver.observe(i.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(e){var t=C.Event("select2-selecting",{val:this.id(e),object:e,choice:e});return this.opts.element.trigger(t),!t.isDefaultPrevented()},triggerChange:function(e){e=e||{},e=C.extend({},e,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(e),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return!0===this.enabledInterface},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e!==this.enabledInterface&&(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){e===w&&(e=!0),this._enabled!==e&&(this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(e){e===w&&(e=!1),this._readonly!==e&&(this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface())},opened:function(){return!!this.container&&this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var e,t,i,n,o,r=this.dropdown,a=this.container,s=a.offset(),l=a.outerHeight(!1),c=a.outerWidth(!1),u=r.outerHeight(!1),d=C(window),h=d.width(),p=d.height(),f=d.scrollLeft()+h,g=d.scrollTop()+p,m=s.top+l,v=s.left,y=m+u<=g,b=s.top-u>=d.scrollTop(),w=r.outerWidth(!1);r.hasClass("select2-drop-above")?(t=!0,!b&&y&&(t=!(i=!0))):(t=!1,!y&&b&&(t=i=!0)),i&&(r.hide(),s=this.container.offset(),l=this.container.outerHeight(!1),c=this.container.outerWidth(!1),u=r.outerHeight(!1),f=d.scrollLeft()+h,g=d.scrollTop()+p,m=s.top+l,v=s.left,w=r.outerWidth(!1),r.show(),this.focusSearch()),this.opts.dropdownAutoWidth?(o=C(".select2-results",r)[0],r.addClass("select2-drop-auto-width"),r.css("width",""),c<(w=r.outerWidth(!1)+(o.scrollHeight===o.clientHeight?0:A.width))?c=w:w=c,u=r.outerHeight(!1)):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body.css("position")&&(m-=(e=this.body.offset()).top,v-=e.left),!(v+w<=f)&&s.left+f+a.outerWidth(!1)>w&&(v=s.left+this.container.outerWidth(!1)-w),n={left:v,width:c},t?(n.top=s.top-u,n.bottom="auto",this.container.addClass("select2-drop-above"),r.addClass("select2-drop-above")):(n.top=m,n.bottom="auto",this.container.removeClass("select2-drop-above"),r.removeClass("select2-drop-above")),n=C.extend(n,k(this.opts.dropdownCss,this.opts.element)),r.css(n)},shouldOpen:function(){var e;return!this.opened()&&(!1!==this._enabled&&!0!==this._readonly&&(e=C.Event("select2-opening"),this.opts.element.trigger(e),!e.isDefaultPrevented()))},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return!!this.shouldOpen()&&(this.opening(),o.on("mousemove.select2Event",function(e){a.x=e.pageX,a.y=e.pageY}),!0)},opening:function(){var n,e=this.containerEventName,t="scroll."+e,i="resize."+e,o="orientationchange."+e;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),0===(n=C("#select2-drop-mask")).length&&((n=C(document.createElement("div"))).attr("id","select2-drop-mask").attr("class","select2-drop-mask"),n.hide(),n.appendTo(this.body),n.on("mousedown touchstart click",function(e){c(n);var t,i=C("#select2-drop");0<i.length&&((t=i.data("select2")).opts.selectOnBlur&&t.selectHighlighted({noFocus:!0}),t.close(),e.preventDefault(),e.stopPropagation())})),this.dropdown.prev()[0]!==n[0]&&this.dropdown.before(n),C("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),n.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var r=this;this.container.parents().add(window).each(function(){C(this).on(i+" "+t+" "+o,function(e){r.opened()&&r.positionDropdown()})})},close:function(){if(this.opened()){var e=this.containerEventName,t="scroll."+e,i="resize."+e,n="orientationchange."+e;this.container.parents().add(window).each(function(){C(this).off(t).off(i).off(n)}),this.clearDropdownAlignmentPreference(),C("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),o.off("mousemove.select2Event"),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(C.Event("select2-close"))}},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return k(this.opts.maximumSelectionSize,this.opts.element)},ensureHighlightVisible:function(){var e,t,i,n,o,r,a,s,l=this.results;(t=this.highlight())<0||(0!=t?(e=this.findHighlightableChoices().find(".select2-result-label"),n=(s=((i=C(e[t])).offset()||{}).top||0)+i.outerHeight(!0),t===e.length-1&&0<(a=l.find("li.select2-more-results")).length&&(n=a.offset().top+a.outerHeight(!0)),(o=l.offset().top+l.outerHeight(!1))<n&&l.scrollTop(l.scrollTop()+(n-o)),(r=s-l.offset().top)<0&&"none"!=i.css("display")&&l.scrollTop(l.scrollTop()+r)):l.scrollTop(0))},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(e){for(var t=this.findHighlightableChoices(),i=this.highlight();-1<i&&i<t.length;){var n=C(t[i+=e]);if(n.hasClass("select2-result-selectable")&&!n.hasClass("select2-disabled")&&!n.hasClass("select2-selected")){this.highlight(i);break}}},highlight:function(e){var t,i,n=this.findHighlightableChoices();if(0===arguments.length)return d(n.filter(".select2-highlighted")[0],n.get());e>=n.length&&(e=n.length-1),e<0&&(e=0),this.removeHighlight(),(t=C(n[e])).addClass("select2-highlighted"),this.search.attr("aria-activedescendant",t.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(t.text()),(i=t.data("select2-data"))&&this.opts.element.trigger({type:"select2-highlight",val:this.id(i),choice:i})},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(e){var t=C(e.target).closest(".select2-result-selectable");if(0<t.length&&!t.is(".select2-highlighted")){var i=this.findHighlightableChoices();this.highlight(i.index(t))}else 0==t.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var t=this.results,i=t.find("li.select2-more-results"),n=this.resultsPage+1,o=this,r=this.search.val(),a=this.context;0!==i.length&&i.offset().top-t.offset().top-t.height()<=this.opts.loadMorePadding&&(i.addClass("select2-active"),this.opts.query({element:this.opts.element,term:r,page:n,context:a,matcher:this.opts.matcher,callback:this.bind(function(e){o.opened()&&(o.opts.populateResults.call(this,t,e.results,{term:r,page:n,context:a}),o.postprocessResults(e,!1,!1),!0===e.more?(i.detach().appendTo(t).html(o.opts.escapeMarkup(k(o.opts.formatLoadMore,o.opts.element,n+1))),window.setTimeout(function(){o.loadMoreIfNeeded()},10)):i.remove(),o.positionDropdown(),o.resultsPage=n,o.context=e.context,this.opts.element.trigger({type:"select2-loaded",items:e}))})}))},tokenize:function(){},updateResults:function(i){var e,t,n,o=this.search,r=this.results,a=this.opts,s=this,l=o.val(),c=C.data(this.container,"select2-last-term");if((!0===i||!c||!p(l,c))&&(C.data(this.container,"select2-last-term",l),!0===i||!1!==this.showSearchInput&&this.opened())){n=++this.queryCount;var u=this.getMaximumSelectionSize();if(!(1<=u&&(e=this.data(),C.isArray(e)&&e.length>=u&&D(a.formatSelectionTooBig,"formatSelectionTooBig"))))return o.val().length<a.minimumInputLength?(D(a.formatInputTooShort,"formatInputTooShort")?h("<li class='select2-no-results'>"+k(a.formatInputTooShort,a.element,o.val(),a.minimumInputLength)+"</li>"):h(""),void(i&&this.showSearch&&this.showSearch(!0))):void(a.maximumInputLength&&o.val().length>a.maximumInputLength?D(a.formatInputTooLong,"formatInputTooLong")?h("<li class='select2-no-results'>"+k(a.formatInputTooLong,a.element,o.val(),a.maximumInputLength)+"</li>"):h(""):(a.formatSearching&&0===this.findHighlightableChoices().length&&h("<li class='select2-searching'>"+k(a.formatSearching,a.element)+"</li>"),o.addClass("select2-active"),this.removeHighlight(),(t=this.tokenize())!=w&&null!=t&&o.val(t),this.resultsPage=1,a.query({element:a.element,term:o.val(),page:this.resultsPage,context:null,matcher:a.matcher,callback:this.bind(function(e){var t;n==this.queryCount&&(this.opened()?e.hasError!==w&&D(a.formatAjaxError,"formatAjaxError")?h("<li class='select2-ajax-error'>"+k(a.formatAjaxError,a.element,e.jqXHR,e.textStatus,e.errorThrown)+"</li>"):(this.context=e.context===w?null:e.context,this.opts.createSearchChoice&&""!==o.val()&&(t=this.opts.createSearchChoice.call(s,o.val(),e.results))!==w&&null!==t&&s.id(t)!==w&&null!==s.id(t)&&0===C(e.results).filter(function(){return p(s.id(this),s.id(t))}).length&&this.opts.createSearchChoicePosition(e.results,t),0===e.results.length&&D(a.formatNoMatches,"formatNoMatches")?h("<li class='select2-no-results'>"+k(a.formatNoMatches,a.element,o.val())+"</li>"):(r.empty(),s.opts.populateResults.call(this,r,e.results,{term:o.val(),page:this.resultsPage,context:null}),!0===e.more&&D(a.formatLoadMore,"formatLoadMore")&&(r.append("<li class='select2-more-results'>"+a.escapeMarkup(k(a.formatLoadMore,a.element,this.resultsPage))+"</li>"),window.setTimeout(function(){s.loadMoreIfNeeded()},10)),this.postprocessResults(e,i),d(),this.opts.element.trigger({type:"select2-loaded",items:e}))):this.search.removeClass("select2-active"))})})));h("<li class='select2-selection-limit'>"+k(a.formatSelectionTooBig,a.element,u)+"</li>")}function d(){o.removeClass("select2-active"),s.positionDropdown(),r.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?s.liveRegion.text(r.text()):s.liveRegion.text(s.opts.formatMatches(r.find('.select2-result-selectable:not(".select2-selected")').length))}function h(e){r.html(e),d()}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){!function(n){n[0]!==document.activeElement&&window.setTimeout(function(){var e,t=n[0],i=n.val().length;n.focus(),(0<t.offsetWidth||0<t.offsetHeight)&&t===document.activeElement&&(t.setSelectionRange?t.setSelectionRange(i,i):t.createTextRange&&((e=t.createTextRange()).collapse(!1),e.select()))},0)}(this.search)},selectHighlighted:function(e){if(this._touchMoved)this.clearTouchMoved();else{var t=this.highlight(),i=this.results.find(".select2-highlighted").closest(".select2-result").data("select2-data");i?(this.highlight(t),this.onSelect(i,e)):e&&e.noFocus&&this.close()}},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==w?e.text():w)},getPlaceholderOption:function(){if(this.select){var e=this.select.children("option").first();if(this.opts.placeholderOption!==w)return"first"===this.opts.placeholderOption&&e||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===C.trim(e.text())&&""===e.val())return e}},initContainerWidth:function(){var e=function(){var e,t,i,n,o;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"!==this.opts.width&&"resolve"!==this.opts.width)return C.isFunction(this.opts.width)?this.opts.width():this.opts.width;if((e=this.opts.element.attr("style"))!==w)for(n=0,o=(t=e.split(";")).length;n<o;n+=1)if(null!==(i=t[n].replace(/\s/g,"").match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i))&&1<=i.length)return i[1];return"resolve"===this.opts.width?0<(e=this.opts.element.css("width")).indexOf("%")?e:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px":null}.call(this);null!==e&&this.container.css("width",e)}}),{createContainer:function(){return C(document.createElement("div")).attr({class:"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""))},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var e,t,i;0<=this.opts.minimumResultsForSearch&&this.showSearch(!0),this.parent.opening.apply(this,arguments),!1!==this.showSearchInput&&this.search.val(this.focusser.val()),this.opts.shouldFocusInput(this)&&(this.search.focus(),(e=this.search.get(0)).createTextRange?((t=e.createTextRange()).collapse(!1),t.select()):e.setSelectionRange&&(i=this.search.val().length,e.setSelectionRange(i,i))),""===this.search.val()&&this.nextSearchTerm!=w&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(C.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){C("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),R.call(this,"selection","focusser")},initContainer:function(){var t,e,i=this.container,n=this.dropdown,o=_();this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=t=i.find(".select2-choice"),this.focusser=i.find(".select2-focusser"),t.find(".select2-chosen").attr("id","select2-chosen-"+o),this.focusser.attr("aria-labelledby","select2-chosen-"+o),this.results.attr("id","select2-results-"+o),this.search.attr("aria-owns","select2-results-"+o),this.focusser.attr("id","s2id_autogen"+o),e=C("label[for='"+this.opts.element.attr("id")+"']"),this.opts.element.focus(this.bind(function(){this.focus()})),this.focusser.prev().text(e.text()).attr("for",this.focusser.attr("id"));var r=this.opts.element.attr("title");this.opts.element.attr("title",r||e.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text(C("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&229!=e.keyCode)if(e.which!==s.PAGE_UP&&e.which!==s.PAGE_DOWN)switch(e.which){case s.UP:case s.DOWN:return this.moveHighlight(e.which===s.UP?-1:1),void v(e);case s.ENTER:return this.selectHighlighted(),void v(e);case s.TAB:return void this.selectHighlighted({noFocus:!0});case s.ESC:return this.cancel(e),void v(e)}else v(e)})),this.search.on("blur",this.bind(function(e){document.activeElement===this.body.get(0)&&window.setTimeout(this.bind(function(){this.opened()&&this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==s.TAB&&!s.isControl(e)&&!s.isFunctionKey(e)&&e.which!==s.ESC){if(!1!==this.opts.openOnEnter||e.which!==s.ENTER){if(e.which==s.DOWN||e.which==s.UP||e.which==s.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),void v(e)}return e.which==s.DELETE||e.which==s.BACKSPACE?(this.opts.allowClear&&this.clear(),void v(e)):void 0}v(e)}})),g(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(0<=this.opts.minimumResultsForSearch){if(e.stopPropagation(),this.opened())return;this.open()}})),t.on("mousedown touchstart","abbr",this.bind(function(e){this.isInterfaceEnabled()&&(this.clear(),function(e){e.preventDefault(),e.stopImmediatePropagation()}(e),this.close(),this.selection&&this.selection.focus())})),t.on("mousedown touchstart",this.bind(function(e){c(t),this.container.hasClass("select2-container-active")||this.opts.element.trigger(C.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),v(e)})),n.on("mousedown touchstart",this.bind(function(){this.opts.shouldFocusInput(this)&&this.search.focus()})),t.on("focus",this.bind(function(e){v(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(C.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(C.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(C.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.hide(),this.setPlaceholder()},clear:function(e){var t=this.selection.data("select2-data");if(t){var i=C.Event("select2-clearing");if(this.opts.element.trigger(i),i.isDefaultPrevented())return;var n=this.getPlaceholderOption();this.opts.element.val(n?n.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),!1!==e&&(this.opts.element.trigger({type:"select2-removed",val:this.id(t),choice:t}),this.triggerChange({removed:t}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var t=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==w&&null!==e&&(t.updateSelection(e),t.close(),t.setPlaceholder(),t.nextSearchTerm=t.opts.nextSearchTerm(e,t.search.val()))})}},isPlaceholderOptionSelected:function(){var e;return this.getPlaceholder()!==w&&((e=this.getPlaceholderOption())!==w&&e.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===w||null===this.opts.element.val())},prepareOpts:function(){var a=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===a.element.get(0).tagName.toLowerCase()?a.initSelection=function(e,t){var i=e.find("option").filter(function(){return this.selected&&!this.disabled});t(n.optionToData(i))}:"data"in a&&(a.initSelection=a.initSelection||function(e,t){var o=e.val(),r=null;a.query({matcher:function(e,t,i){var n=p(o,a.id(i));return n&&(r=i),n},callback:C.isFunction(t)?function(){t(r)}:C.noop})}),a},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===w?w:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==w){if(this.select&&this.getPlaceholderOption()===w)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,i){var n=0,o=this;if(this.findHighlightableChoices().each2(function(e,t){if(p(o.id(t.data("select2-data")),o.opts.element.val()))return n=e,!1}),!1!==i&&(!0===t&&0<=n?this.highlight(n):this.highlight(0)),!0===t){var r=this.opts.minimumResultsForSearch;0<=r&&this.showSearch(function i(e){var n=0;return C.each(e,function(e,t){C(t.element).is("optgroup")?n+=i(t.children):(t.children&&t.children.length&&(n+=i(t.children)),n++)}),n}(e.results)>=r)}},showSearch:function(e){this.showSearchInput!==e&&(this.showSearchInput=e,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!e),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!e),C(this.dropdown,this.container).toggleClass("select2-with-searchbox",e))},onSelect:function(e,t){if(this.triggerSelect(e)){var i=this.opts.element.val(),n=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.close(),t&&t.noFocus||!this.opts.shouldFocusInput(this)||this.focusser.focus(),p(i,this.id(e))||this.triggerChange({added:e,removed:n})}},updateSelection:function(e){var t,i,n=this.selection.find(".select2-chosen");this.selection.data("select2-data",e),n.empty(),null!==e&&(t=this.opts.formatSelection(e,n,this.opts.escapeMarkup),n.prop("title",C(e.element).prop("title")||e.text)),t!==w&&n.append(t),(i=this.opts.formatSelectionCssClass(e,n))!==w&&n.addClass(i),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==w&&this.container.addClass("select2-allowclear")},val:function(){var e,t=!1,i=null,n=this,o=this.data();if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],1<arguments.length&&(t=arguments[1]),this.select)this.select.val(e).find("option").filter(function(){return this.selected}).each2(function(e,t){return i=n.optionToData(t),!1}),this.updateSelection(i),this.setPlaceholder(),t&&this.triggerChange({added:i,removed:o});else{if(!e&&0!==e)return void this.clear(t);if(this.opts.initSelection===w)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){n.opts.element.val(e?n.id(e):""),n.updateSelection(e),n.setPlaceholder(),t&&n.triggerChange({added:e,removed:o})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var t,i=!1;if(0===arguments.length)return(t=this.selection.data("select2-data"))==w&&(t=null),t;1<arguments.length&&(i=arguments[1]),e?(t=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),i&&this.triggerChange({added:e,removed:t})):this.clear(i)}}),i=O(e,{createContainer:function(){return C(document.createElement("div")).attr({class:"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""))},prepareOpts:function(){var l=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===l.element.get(0).tagName.toLowerCase()?l.initSelection=function(e,t){var i=[];e.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(e,t){i.push(n.optionToData(t))}),t(i)}:"data"in l&&(l.initSelection=l.initSelection||function(e,r){var a=h(e.val(),l.separator,l.transformVal),s=[];l.query({matcher:function(e,t,i){var n=C.grep(a,function(e){return p(e,l.id(i))}).length;return n&&s.push(i),n},callback:C.isFunction(r)?function(){for(var e=[],t=0;t<a.length;t++)for(var i=a[t],n=0;n<s.length;n++){var o=s[n];if(p(i,l.id(o))){e.push(o),s.splice(n,1);break}}r(e)}:C.noop})}),l},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");t.length&&e&&e[0]==t[0]||(t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e)))},destroy:function(){C("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),R.call(this,"searchContainer","selection")},initContainer:function(){var a,e=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=a=this.container.find(e);var t=this;this.selection.on("click",".select2-container:not(.select2-container-disabled) .select2-search-choice:not(.select2-locked)",function(e){t.search[0].focus(),t.selectChoice(C(this))}),this.search.attr("id","s2id_autogen"+_()),this.search.prev().text(C("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.opts.element.focus(this.bind(function(){this.focus()})),this.search.on("input paste",this.bind(function(){this.search.attr("placeholder")&&0==this.search.val().length||this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){++this.keydowns;var t=a.find(".select2-search-choice-focus"),i=t.prev(".select2-search-choice:not(.select2-locked)"),n=t.next(".select2-search-choice:not(.select2-locked)"),o=function(e){var t=0,i=0;if("selectionStart"in(e=C(e)[0]))t=e.selectionStart,i=e.selectionEnd-t;else if("selection"in document){e.focus();var n=document.selection.createRange();i=document.selection.createRange().text.length,n.moveStart("character",-e.value.length),t=n.text.length-i}return{offset:t,length:i}}(this.search);if(t.length&&(e.which==s.LEFT||e.which==s.RIGHT||e.which==s.BACKSPACE||e.which==s.DELETE||e.which==s.ENTER)){var r=t;return e.which==s.LEFT&&i.length?r=i:e.which==s.RIGHT?r=n.length?n:null:e.which===s.BACKSPACE?this.unselect(t.first())&&(this.search.width(10),r=i.length?i:n):e.which==s.DELETE?this.unselect(t.first())&&(this.search.width(10),r=n.length?n:null):e.which==s.ENTER&&(r=null),this.selectChoice(r),v(e),void(r&&r.length||this.open())}if((e.which===s.BACKSPACE&&1==this.keydowns||e.which==s.LEFT)&&0==o.offset&&!o.length)return this.selectChoice(a.find(".select2-search-choice:not(.select2-locked)").last()),void v(e);if(this.selectChoice(null),this.opened())switch(e.which){case s.UP:case s.DOWN:return this.moveHighlight(e.which===s.UP?-1:1),void v(e);case s.ENTER:return this.selectHighlighted(),void v(e);case s.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case s.ESC:return this.cancel(e),void v(e)}if(e.which!==s.TAB&&!s.isControl(e)&&!s.isFunctionKey(e)&&e.which!==s.BACKSPACE&&e.which!==s.ESC){if(e.which===s.ENTER){if(!1===this.opts.openOnEnter)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),e.which!==s.PAGE_UP&&e.which!==s.PAGE_DOWN||v(e),e.which===s.ENTER&&v(e)}}})),this.search.on("keyup",this.bind(function(e){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),e.stopImmediatePropagation(),this.opts.element.trigger(C.Event("select2-blur"))})),this.container.on("click",e,this.bind(function(e){this.isInterfaceEnabled()&&(0<C(e.target).closest(".select2-search-choice").length||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(C.Event("select2-focus")),this.open(),this.focusSearch(),e.preventDefault()))})),this.container.on("focus",e,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(C.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.hide(),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var t=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==w&&null!==e&&(t.updateSelection(e),t.close(),t.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder(),t=this.getMaxSearchWidth();e!==w&&0===this.getVal().length&&!1===this.search.hasClass("select2-focused")?(this.search.val(e).addClass("select2-default"),this.search.width(0<t?t:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),""===this.search.val()&&this.nextSearchTerm!=w&&(this.search.val(this.nextSearchTerm),this.search.select()),this.updateResults(!0),this.opts.shouldFocusInput(this)&&this.search.focus(),this.opts.element.trigger(C.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(e){var t=[],i=[],n=this;C(e).each(function(){d(n.id(this),t)<0&&(t.push(n.id(this)),i.push(this))}),e=i,this.selection.find(".select2-search-choice").remove(),C(e).each(function(){n.addSelectedChoice(this)}),n.postprocessResults()},tokenize:function(){var e=this.search.val();null!=(e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts))&&e!=w&&(this.search.val(e),0<e.length&&this.open())},onSelect:function(e,t){this.triggerSelect(e)&&""!==e.text&&(this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.clearSearch(),this.updateResults(),!this.select&&this.opts.closeOnSelect||this.postprocessResults(e,!1,!0===this.opts.closeOnSelect),this.opts.closeOnSelect?(this.close(),this.search.width(10)):0<this.countSelectableResults()?(this.search.width(10),this.resizeSearch(),0<this.getMaximumSelectionSize()&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.nextSearchTerm!=w&&(this.search.val(this.nextSearchTerm),this.updateResults(),this.search.select()),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),t&&t.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(e){var t,i,n=!e.locked,o=C("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),r=C("<li class='select2-search-choice select2-locked'><div></div></li>"),a=n?o:r,s=this.id(e),l=this.getVal();(t=this.opts.formatSelection(e,a.find("div"),this.opts.escapeMarkup))!=w&&a.find("div").replaceWith(C("<div></div>").html(t)),(i=this.opts.formatSelectionCssClass(e,a.find("div")))!=w&&a.addClass(i),n&&a.find(".select2-search-choice-close").on("mousedown",v).on("click dblclick",this.bind(function(e){this.isInterfaceEnabled()&&(this.unselect(C(e.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),v(e),this.close(),this.focusSearch())})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),a.data("select2-data",e),a.insertBefore(this.searchContainer),l.push(s),this.setVal(l)},unselect:function(e){var t,i,n=this.getVal();if(0===(e=e.closest(".select2-search-choice")).length)throw"Invalid argument: "+e+". Must be .select2-search-choice";if(t=e.data("select2-data")){var o=C.Event("select2-removing");if(o.val=this.id(t),o.choice=t,this.opts.element.trigger(o),o.isDefaultPrevented())return!1;for(;0<=(i=d(this.id(t),n));)n.splice(i,1),this.setVal(n),this.select&&this.postprocessResults();return e.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(t),choice:t}),this.triggerChange({removed:t}),!0}},postprocessResults:function(e,t,i){var n=this.getVal(),o=this.results.find(".select2-result"),r=this.results.find(".select2-result-with-children"),a=this;o.each2(function(e,t){0<=d(a.id(t.data("select2-data")),n)&&(t.is("optgroup")?(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected")):0<t.find(".select2-result-selectable").length?t.addClass("select2-disabled"):t.addClass("select2-selected"))}),r.each2(function(e,t){0===t.find(".select2-result-selectable:not(.select2-selected)").length&&(t.is(".select2-result-selectable")&&!t.is(".select2-disabled")||t.addClass("select2-selected"))}),-1==this.highlight()&&!1!==i&&!0===this.opts.closeOnSelect&&a.highlight(0),!this.opts.createSearchChoice&&0<!o.filter(".select2-result:not(.select2-selected)").length&&(!e||e&&!e.more&&0===this.results.find(".select2-no-results").length)&&D(a.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+k(a.opts.formatNoMatches,a.opts.element,a.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-f(this.search)},resizeSearch:function(){var e,t,i,n,o=f(this.search);e=function(e){if(!r){var t=e[0].currentStyle||window.getComputedStyle(e[0],null);(r=C(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:t.fontSize,fontFamily:t.fontFamily,fontStyle:t.fontStyle,fontWeight:t.fontWeight,letterSpacing:t.letterSpacing,textTransform:t.textTransform,whiteSpace:"nowrap"})).attr("class","select2-sizer"),C(document.body).append(r)}return r.text(e.val()),r.width()}(this.search)+10,t=this.search.offset().left,(n=(i=this.selection.width())-(t-this.selection.offset().left)-o)<e&&(n=i-o),n<40&&(n=i-o),n<=0&&(n=e),this.search.width(Math.floor(n))},getVal:function(){var e;return this.select?null===(e=this.select.val())?[]:e:h(e=this.opts.element.val(),this.opts.separator,this.opts.transformVal)},setVal:function(e){var t;this.select?this.select.val(e):(t=[],C(e).each(function(){d(this,t)<0&&t.push(this)}),this.opts.element.val(0===t.length?"":t.join(this.opts.separator)))},buildChangeDetails:function(e,t){t=t.slice(0),e=e.slice(0);for(var i=0;i<t.length;i++)for(var n=0;n<e.length;n++)p(this.opts.id(t[i]),this.opts.id(e[n]))&&(t.splice(i,1),0<i&&i--,e.splice(n,1),n--);return{added:t,removed:e}},val:function(e,i){var n,o=this;if(0===arguments.length)return this.getVal();if((n=this.data()).length||(n=[]),!e&&0!==e)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(i&&this.triggerChange({added:this.data(),removed:n}));if(this.setVal(e),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),i&&this.triggerChange(this.buildChangeDetails(n,this.data()));else{if(this.opts.initSelection===w)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(e){var t=C.map(e,o.id);o.setVal(t),o.updateSelection(e),o.clearSearch(),i&&o.triggerChange(o.buildChangeDetails(n,o.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var e=[],t=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){e.push(t.opts.id(C(this).data("select2-data")))}),this.setVal(e),this.triggerChange()},data:function(e,t){var i,n,o=this;if(0===arguments.length)return this.selection.children(".select2-search-choice").map(function(){return C(this).data("select2-data")}).get();n=this.data(),e=e||[],i=C.map(e,function(e){return o.opts.id(e)}),this.setVal(i),this.updateSelection(e),this.clearSearch(),t&&this.triggerChange(this.buildChangeDetails(n,this.data()))}}),C.fn.select2=function(){var e,t,i,n,o,r=Array.prototype.slice.call(arguments,0),a=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],s=["opened","isFocused","container","dropdown"],l=["val","data"],c={search:"externalSearch"};return this.each(function(){if(0===r.length||"object"==typeof r[0])(e=0===r.length?{}:C.extend({},r[0])).element=C(this),"select"===e.element.get(0).tagName.toLowerCase()?o=e.element.prop("multiple"):(o=e.multiple||!1,"tags"in e&&(e.multiple=o=!0)),(t=o?new window.Select2.class.multi:new window.Select2.class.single).init(e);else{if("string"!=typeof r[0])throw"Invalid arguments to select2 plugin: "+r;if(d(r[0],a)<0)throw"Unknown method: "+r[0];if(n=w,(t=C(this).data("select2"))===w)return;if(i=r[0],n="container"===i?t.container:"dropdown"===i?t.dropdown:(c[i]&&(i=c[i]),t[i].apply(t,r.slice(1))),0<=d(r[0],s)||0<=d(r[0],l)&&1==r.length)return!1}}),n===w?this:n},C.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,i,n){var o=[];return b(this.text(e),i.term,o,n),o.join("")},transformVal:function(e){return C.trim(e)},formatSelection:function(e,t,i){return e?i(this.text(e)):w},sortResults:function(e,t,i){return e},formatResultCssClass:function(e){return e.css},formatSelectionCssClass:function(e,t){return w},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==w?null:e.id},text:function(e){return e&&this.data&&this.data.text?C.isFunction(this.data.text)?this.data.text(e):e[this.data.text]:e.text},matcher:function(e,t){return 0<=u(""+t).toUpperCase().indexOf(u(""+e).toUpperCase())},separator:",",tokenSeparators:[],tokenizer:function(e,t,i,n){var o,r,a,s,l,c=e,u=!1;if(!n.createSearchChoice||!n.tokenSeparators||n.tokenSeparators.length<1)return w;for(;;){for(r=-1,a=0,s=n.tokenSeparators.length;a<s&&(l=n.tokenSeparators[a],!(0<=(r=e.indexOf(l))));a++);if(r<0)break;if(o=e.substring(0,r),e=e.substring(r+l.length),0<o.length&&(o=n.createSearchChoice.call(this,o,t))!==w&&null!==o&&n.id(o)!==w&&null!==n.id(o)){for(u=!1,a=0,s=t.length;a<s;a++)if(p(n.id(o),n.id(t[a]))){u=!0;break}u||i(o)}}return c!==e?e:void 0},escapeMarkup:E,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null},nextSearchTerm:function(e,t){return w},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(e){return!("ontouchstart"in window||0<navigator.msMaxTouchPoints)||!(e.opts.minimumResultsForSearch<0)}},C.fn.select2.locales=[],C.fn.select2.locales.en={formatMatches:function(e){return 1===e?"One result is available, press enter to select it.":e+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatAjaxError:function(e,t,i){return"Loading failed"},formatInputTooShort:function(e,t){var i=t-e.length;return"Please enter "+i+" or more character"+(1==i?"":"s")},formatInputTooLong:function(e,t){var i=e.length-t;return"Please delete "+i+" character"+(1==i?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(e){return"Loading more results‚Ä¶"},formatSearching:function(){return"Searching‚Ä¶"}},C.extend(C.fn.select2.defaults,C.fn.select2.locales.en),C.fn.select2.ajaxDefaults={transport:C.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:x,local:S,tags:T},util:{debounce:m,markMatch:b,escapeMarkup:E,stripDiacritics:u},class:{abstract:e,single:t,multi:i}}}function c(e){var t=C(document.createTextNode(""));e.before(t),t.before(e),t.remove()}function u(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return l[e]||e})}function d(e,t){for(var i=0,n=t.length;i<n;i+=1)if(p(e,t[i]))return i;return-1}function p(e,t){return e===t||e!==w&&t!==w&&(null!==e&&null!==t&&(e.constructor===String?e+""==t+"":t.constructor===String&&t+""==e+""))}function h(e,t,i){var n,o,r;if(null===e||e.length<1)return[];for(o=0,r=(n=e.split(t)).length;o<r;o+=1)n[o]=i(n[o]);return n}function f(e){return e.outerWidth(!1)-e.width()}function g(t){var i="keyup-change-value";t.on("keydown",function(){C.data(t,i)===w&&C.data(t,i,t.val())}),t.on("keyup",function(){var e=C.data(t,i);e!==w&&t.val()!==e&&(C.removeData(t,i),t.trigger("keyup-change"))})}function m(t,i,n){var o;return n=n||w,function(){var e=arguments;window.clearTimeout(o),o=window.setTimeout(function(){i.apply(n,e)},t)}}function v(e){e.preventDefault(),e.stopPropagation()}function y(e,t,i){var n,o,r=[];(n=C.trim(e.attr("class")))&&C((n=""+n).split(/\s+/)).each2(function(){0===this.indexOf("select2-")&&r.push(this)}),(n=C.trim(t.attr("class")))&&C((n=""+n).split(/\s+/)).each2(function(){0!==this.indexOf("select2-")&&(o=i(this))&&r.push(o)}),e.attr("class",r.join(" "))}function b(e,t,i,n){var o=u(e.toUpperCase()).indexOf(u(t.toUpperCase())),r=t.length;o<0?i.push(n(e)):(i.push(n(e.substring(0,o))),i.push("<span class='select2-match'>"),i.push(n(e.substring(o,o+r))),i.push("</span>"),i.push(n(e.substring(o+r,e.length))))}function E(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function x(a){var e,s=null,t=a.quietMillis||100,l=a.url,c=this;return function(r){window.clearTimeout(e),e=window.setTimeout(function(){var e=a.data,t=l,i=a.transport||C.fn.select2.ajaxDefaults.transport,n={type:a.type||"GET",cache:a.cache||!1,jsonpCallback:a.jsonpCallback||w,dataType:a.dataType||"json"},o=C.extend({},C.fn.select2.ajaxDefaults.params,n);e=e?e.call(c,r.term,r.page,r.context):null,t="function"==typeof t?t.call(c,r.term,r.page,r.context):t,s&&"function"==typeof s.abort&&s.abort(),a.params&&(C.isFunction(a.params)?C.extend(o,a.params.call(c)):C.extend(o,a.params)),C.extend(o,{url:t,dataType:a.dataType,data:e,success:function(e){var t=a.results(e,r.page,r);r.callback(t)},error:function(e,t,i){var n={hasError:!0,jqXHR:e,textStatus:t,errorThrown:i};r.callback(n)}}),s=i.call(c,o)},t)}}function S(e){var t,i,n=e,s=function(e){return""+e.text};C.isArray(n)&&(n={results:i=n}),!1===C.isFunction(n)&&(i=n,n=function(){return i});var o=n();return o.text&&(s=o.text,C.isFunction(s)||(t=o.text,s=function(e){return e[t]})),function(o){var r,a=o.term,i={results:[]};""!==a?(r=function(e,t){var i,n;if((e=e[0]).children){for(n in i={},e)e.hasOwnProperty(n)&&(i[n]=e[n]);i.children=[],C(e.children).each2(function(e,t){r(t,i.children)}),(i.children.length||o.matcher(a,s(i),e))&&t.push(i)}else o.matcher(a,s(e),e)&&t.push(e)},C(n().results).each2(function(e,t){r(t,i.results)}),o.callback(i)):o.callback(n())}}function T(t){var r=C.isFunction(t);return function(i){var n=i.term,o={results:[]},e=r?t(i):t;C.isArray(e)&&(C(e).each(function(){var e=this.text!==w,t=e?this.text:this;""!==n&&!i.matcher(n,t)||o.results.push(e?this:{id:this,text:this})}),i.callback(o))}}function D(e,t){if(C.isFunction(e))return!0;if(!e)return!1;if("string"==typeof e)return!0;throw new Error(t+" must be a string, function, or falsy value")}function k(e,t){if(C.isFunction(e)){var i=Array.prototype.slice.call(arguments,2);return e.apply(t,i)}return e}function R(){var i=this;C.each(arguments,function(e,t){i[t].remove(),i[t]=null})}function O(e,t){function i(){}return((i.prototype=new e).constructor=i).prototype.parent=e.prototype,i.prototype=C.extend(i.prototype,t),i}}(jQuery),EndlessScroll=function(){var n;function e(e,t){var i=this;this.options=$.extend({},n,t),this.firing=!0,this.fired=!1,this.fireSequence=0,this.didScroll=!1,this.isScrollable=!0,this.target=e,this.targetId="",this.content="",this.innerWrap=$(".endless_scroll_inner_wrap",this.target),this.options.data&&(this.options.content=this.options.data),$(e).scroll(function(){return i.didScroll=!0,i.target=e,i.targetId=$(i.target).attr("id")})}return e.name="EndlessScroll",n={bottomPixels:50,fireOnce:!0,fireDelay:150,loader:"Loading...",content:"",insertAfter:"div:last",intervalFrequency:250,resetCounter:function(){return!1},callback:function(){return!0},ceaseFire:function(){return!1}},e.prototype.run=function(){var e=this;return setInterval(function(){if(e.shouldTryFiring()){if(e.didScroll=!1,e.ceaseFireWhenNecessary())return;if(e.shouldBeFiring())return e.resetFireSequenceWhenNecessary(),e.acknowledgeFiring(),e.insertLoader(),e.hasContent()&&(e.showContent(),e.fireCallback(),e.delayFireingWhenNecessary()),e.removeLoader()}},this.options.intervalFrequency)},e.prototype.shouldTryFiring=function(){return this.didScroll&&!0===this.firing},e.prototype.ceaseFireWhenNecessary=function(){return!!this.options.ceaseFire.apply(this.target,[this.fireSequence])&&!(this.firing=!1)},e.prototype.wrapContainer=function(){if(0===this.innerWrap.length)return this.innerWrap=$(this.target).wrapInner('<div class="endless_scroll_inner_wrap" />').find(".endless_scroll_inner_wrap")},e.prototype.isScrollableOrNot=function(){return this.target===document||this.target===window?this.isScrollable=$(document).height()-$(window).height()<=$(window).scrollTop()+this.options.bottomPixels:(this.wrapContainer(),this.isScrollable=0<this.innerWrap.length&&this.innerWrap.height()-$(this.target).height()<=$(this.target).scrollTop()+this.options.bottomPixels)},e.prototype.shouldBeFiring=function(){return this.isScrollableOrNot(),this.isScrollable&&(!1===this.options.fireOnce||!0===this.options.fireOnce&&!0!==this.fired)},e.prototype.resetFireSequenceWhenNecessary=function(){if(!0===this.options.resetCounter.apply(this.target))return this.fireSequence=0},e.prototype.acknowledgeFiring=function(){return this.fired=!0,this.fireSequence++},e.prototype.insertLoader=function(){return $(this.options.insertAfter).after('<div class="endless_scroll_loader_'+this.targetId+' endless_scroll_loader">'+this.options.loader+"</div>")},e.prototype.removeLoader=function(){return $(".endless_scroll_loader_"+this.targetId).fadeOut(function(){return $(this).remove()})},e.prototype.hasContent=function(){return"function"==typeof this.options.content?this.content=this.options.content.apply(this.target,[this.fireSequence]):this.content=this.options.content,!1!==this.content},e.prototype.showContent=function(){return $(this.options.insertAfter).after('<div id="endless_scroll_content">'+this.content+"</div>"),$("#endless_scroll_content").hide().fadeIn(250,function(){return $(this).removeAttr("id")})},e.prototype.fireCallback=function(){return this.options.callback.apply(this.target,[this.fireSequence])},e.prototype.delayFireingWhenNecessary=function(){var e=this;return 0<this.options.fireDelay?($("body").after('<div id="endless_scroll_marker"></div>'),$("#endless_scroll_marker").fadeTo(this.options.fireDelay,1,function(){return $("#endless_scroll_marker").remove(),e.fired=!1})):this.fired=!1},e}(),jQuery.fn.endlessScroll=function(e){return new EndlessScroll(this,e).run()},function(s){"use strict";function n(e){s(e).on("click.bs.dropdown",this.toggle)}var l='[data-toggle="dropdown"]';function r(i){i&&3===i.which||i.preventDropdownClose||(s(".dropdown-backdrop").remove(),s(l).each(function(){var e=c(s(this)),t={relatedTarget:this};e.hasClass("open")&&(e.trigger(i=s.Event("hide.bs.dropdown",t)),i.isDefaultPrevented()||e.removeClass("open").trigger("hidden.bs.dropdown",t))}))}function c(e){var t=e.attr("data-target"),i=(t=t||(t=e.attr("href"))&&/#[A-Za-z]/.test(t)&&t.replace(/.*(?=#[^\s]*$)/,""))&&s(document).find(t);return i&&i.length?i:e.parent()}n.VERSION="3.2.0",n.prototype.toggle=function(e){var t=s(this);if(!t.is(".disabled, :disabled")){var i=c(t),n=i.hasClass("open");if(r(e),!n){"ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length&&s('<div class="dropdown-backdrop"/>').insertAfter(s(this)).on("click",r);var o={relatedTarget:this};if(i.trigger(e=s.Event("show.bs.dropdown",o)),e.isDefaultPrevented())return;t.trigger("focus"),i.toggleClass("open").trigger("shown.bs.dropdown",o)}return!1}},n.prototype.keydown=function(e){if(/(38|40|27)/.test(e.keyCode)){var t=s(this);if(e.preventDefault(),e.stopPropagation(),!t.is(".disabled, :disabled")){var i=c(t),n=i.hasClass("open");if(!n||n&&27==e.keyCode)return 27==e.which&&i.find(l).trigger("focus"),t.trigger("click");var o=" li:not(.divider):visible a",r=i.find('[role="menu"]'+o+', [role="listbox"]'+o);if(r.length){var a=r.index(r.filter(":focus"));38==e.keyCode&&0<a&&a--,40==e.keyCode&&a<r.length-1&&a++,~a||(a=0),r.eq(a).trigger("focus")}}}};var e=s.fn.dropdown;s.fn.dropdown=function(i){return this.each(function(){var e=s(this),t=e.data("bs.dropdown");t||e.data("bs.dropdown",t=new n(this)),"string"==typeof i&&t[i].call(e)})},s.fn.dropdown.Constructor=n,s.fn.dropdown.noConflict=function(){return s.fn.dropdown=e,this},s(document).on("click.bs.dropdown.data-api",r).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",l,n.prototype.toggle).on("keydown.bs.dropdown.data-api",l+', [role="menu"], [role="listbox"]',n.prototype.keydown)}(jQuery),function(a){"use strict";function r(e,t){this.options=t,this.$body=a(document.body),this.$element=a(e),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))}function s(n,o){return this.each(function(){var e=a(this),t=e.data("bs.modal"),i=a.extend({},r.DEFAULTS,e.data(),"object"==typeof n&&n);t||e.data("bs.modal",t=new r(this,i)),"string"==typeof n?t[n](o):i.show&&t.show(o)})}r.VERSION="3.2.0",r.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},r.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},r.prototype.show=function(i){var n=this,e=a.Event("show.bs.modal",{relatedTarget:i});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.$body.addClass("modal-open"),this.setScrollbar(),this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.backdrop(function(){var e=a.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(n.$body),n.$element.show().scrollTop(0),e&&n.$element[0].offsetWidth,n.$element.addClass("in").attr("aria-hidden",!1),n.enforceFocus();var t=a.Event("shown.bs.modal",{relatedTarget:i});e?n.$element.find(".modal-dialog").one("bsTransitionEnd",function(){n.$element.trigger("focus").trigger(t)}).emulateTransitionEnd(300):n.$element.trigger("focus").trigger(t)}))},r.prototype.hide=function(e){e&&e.preventDefault(),e=a.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},r.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},r.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",a.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},r.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$element.trigger("hidden.bs.modal")})},r.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},r.prototype.backdrop=function(e){var t=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=a.support.transition&&i;if(this.$backdrop=a('<div class="modal-backdrop '+i+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),this.$backdrop.on("click.dismiss.bs.modal",a.proxy(function(e){this.hide.call(this)},this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;n?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(150):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var o=function(){t.removeBackdrop(),e&&e()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",o).emulateTransitionEnd(150):o()}else e&&e()},r.prototype.checkScrollbar=function(){document.body.clientWidth>=window.innerWidth||(this.scrollbarWidth=this.scrollbarWidth||this.measureScrollbar())},r.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.scrollbarWidth&&this.$body.css("padding-right",e+this.scrollbarWidth)},r.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},r.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var e=a.fn.modal;a.fn.modal=s,a.fn.modal.Constructor=r,a.fn.modal.noConflict=function(){return a.fn.modal=e,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var t=a(this),i=t.attr("href"),n=t.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,""),o=a(document).find(n),r=o.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(i)&&i},o.data(),t.data());t.is("a")&&e.preventDefault(),o.one("show.bs.modal",function(e){e.isDefaultPrevented()||o.one("hidden.bs.modal",function(){t.is(":visible")&&t.trigger("focus")})}),s.call(o,r,this)})}(jQuery),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");!function(m){"use strict";function o(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)}o.VERSION="3.2.0",o.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},o.prototype.init=function(e,t,i){this.enabled=!0,this.type=e,this.$element=m(t),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&m(this.options.viewport.selector||this.options.viewport);for(var n=this.options.trigger.split(" "),o=n.length;o--;){var r=n[o];if("click"==r)this.$element.on("click."+this.type,this.options.selector,m.proxy(this.toggle,this));else if("manual"!=r){var a="hover"==r?"mouseenter":"focusin",s="hover"==r?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,m.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,m.proxy(this.leave,this))}}this.options.selector?this._options=m.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},o.prototype.getDefaults=function(){return o.DEFAULTS},o.prototype.getOptions=function(e){return(e=m.extend({},this.getDefaults(),this.$element.data(),e)).delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},o.prototype.getDelegateOptions=function(){var i={},n=this.getDefaults();return this._options&&m.each(this._options,function(e,t){n[e]!=t&&(i[e]=t)}),i},o.prototype.enter=function(e){var t=e instanceof this.constructor?e:m(e.currentTarget).data("bs."+this.type);if(t||(t=new this.constructor(e.currentTarget,this.getDelegateOptions()),m(e.currentTarget).data("bs."+this.type,t)),clearTimeout(t.timeout),t.hoverState="in",!t.options.delay||!t.options.delay.show)return t.show();t.timeout=setTimeout(function(){"in"==t.hoverState&&t.show()},t.options.delay.show)},o.prototype.leave=function(e){var t=e instanceof this.constructor?e:m(e.currentTarget).data("bs."+this.type);if(t||(t=new this.constructor(e.currentTarget,this.getDelegateOptions()),m(e.currentTarget).data("bs."+this.type,t)),clearTimeout(t.timeout),t.hoverState="out",!t.options.delay||!t.options.delay.hide)return t.hide();t.timeout=setTimeout(function(){"out"==t.hoverState&&t.hide()},t.options.delay.hide)},o.prototype.show=function(){var e=m.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var t=m.contains(document.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!t)return;var i=this,n=this.tip(),o=this.getUID(this.type);this.setContent(),n.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&n.addClass("fade"),n.detach().css({top:0,left:0,display:"block"}).data("bs."+this.type,this),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var r="function"==typeof this.options.placement?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,s=a.test(r);s&&(r=r.replace(a,"")||"top"),n.addClass(r);var l=this.getPosition(),c=n[0].offsetWidth,u=n[0].offsetHeight;if(s){var d=r,h=this.$element.parent(),p=this.getPosition(h);r="bottom"==r&&l.top+l.height+u-p.scroll>p.height?"top":"top"==r&&l.top-p.scroll-u<0?"bottom":"right"==r&&l.right+c>p.width?"left":"left"==r&&l.left-c<p.left?"right":r,n.removeClass(d).addClass(r)}var f=this.getCalculatedOffset(r,l,c,u);this.applyPlacement(f,r);var g=function(){i.$element.trigger("shown.bs."+i.type),i.hoverState=null};m.support.transition&&this.$tip.hasClass("fade")?n.one("bsTransitionEnd",g).emulateTransitionEnd(150):g()}},o.prototype.applyPlacement=function(e,t){var i=this.tip(),n=i[0].offsetWidth,o=i[0].offsetHeight,r=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(a)&&(a=0),e.top=e.top+r,e.left=e.left+a,m.offset.setOffset(i[0],m.extend({using:function(e){i.css({top:Math.round(e.top),left:Math.round(e.left)})}},e),0),i.addClass("in");var s=i[0].offsetWidth,l=i[0].offsetHeight;"top"==t&&l!=o&&(e.top=e.top+o-l);var c=this.getViewportAdjustedDelta(t,e,s,l);c.left?e.left+=c.left:e.top+=c.top;var u=c.left?2*c.left-n+s:2*c.top-o+l,d=c.left?"left":"top",h=c.left?"offsetWidth":"offsetHeight";i.offset(e),this.replaceArrow(u,i[0][h],d)},o.prototype.replaceArrow=function(e,t,i){this.arrow().css(i,e?50*(1-e/t)+"%":"")},o.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},o.prototype.hide=function(){var e=this,t=this.tip(),i=m.Event("hide.bs."+this.type);function n(){"in"!=e.hoverState&&t.detach(),e.$element.trigger("hidden.bs."+e.type)}if(this.$element.removeAttr("aria-describedby"),this.$element.trigger(i),!i.isDefaultPrevented())return t.removeClass("in"),m.support.transition&&this.$tip.hasClass("fade")?t.one("bsTransitionEnd",n).emulateTransitionEnd(150):n(),this.hoverState=null,this},o.prototype.fixTitle=function(){var e=this.$element;!e.attr("title")&&"string"==typeof e.attr("data-original-title")||e.attr("data-original-title",e.attr("title")||"").attr("title","")},o.prototype.hasContent=function(){return this.getTitle()},o.prototype.getPosition=function(e){var t=(e=e||this.$element)[0],i="BODY"==t.tagName;return m.extend({},"function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():null,{scroll:i?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop(),width:i?m(window).width():e.outerWidth(),height:i?m(window).height():e.outerHeight()},i?{top:0,left:0}:e.offset())},o.prototype.getCalculatedOffset=function(e,t,i,n){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-i/2}:"top"==e?{top:t.top-n,left:t.left+t.width/2-i/2}:"left"==e?{top:t.top+t.height/2-n/2,left:t.left-i}:{top:t.top+t.height/2-n/2,left:t.left+t.width}},o.prototype.getViewportAdjustedDelta=function(e,t,i,n){var o={top:0,left:0};if(!this.$viewport)return o;var r=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(e)){var s=t.top-r-a.scroll,l=t.top+r-a.scroll+n;s<a.top?o.top=a.top-s:l>a.top+a.height&&(o.top=a.top+a.height-l)}else{var c=t.left-r,u=t.left+r+i;c<a.left?o.left=a.left-c:u>a.width&&(o.left=a.left+a.width-u)}return o},o.prototype.getTitle=function(){var e=this.$element,t=this.options;return e.attr("data-original-title")||("function"==typeof t.title?t.title.call(e[0]):t.title)},o.prototype.getUID=function(e){for(;e+=~~(1e6*Math.random()),document.getElementById(e););return e},o.prototype.tip=function(){return this.$tip=this.$tip||m(this.options.template)},o.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},o.prototype.validate=function(){document.contains(this.$element[0])||(this.hide(),this.$element=null,this.options=null)},o.prototype.enable=function(){this.enabled=!0},o.prototype.disable=function(){this.enabled=!1},o.prototype.toggleEnabled=function(){this.enabled=!this.enabled},o.prototype.toggle=function(e){var t=this;e&&((t=m(e.currentTarget).data("bs."+this.type))||(t=new this.constructor(e.currentTarget,this.getDelegateOptions()),m(e.currentTarget).data("bs."+this.type,t))),t.tip().hasClass("in")?t.leave(t):t.enter(t)},o.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var e=m.fn.bsTooltip;m.fn.bsTooltip=function(n){return this.each(function(){var e=m(this),t=e.data("bs.tooltip"),i="object"==typeof n&&n;!t&&"destroy"==n||(t||e.data("bs.tooltip",t=new o(this,i)),"string"==typeof n&&t[n]())})},m.fn.bsTooltip.Constructor=o,m.fn.bsTooltip.noConflict=function(){return m.fn.bsTooltip=e,this}}(jQuery),function(o){"use strict";function r(e,t){this.init("popover",e,t)}if(!o.fn.bsTooltip)throw new Error("Popover requires tooltip.js");r.VERSION="3.2.0",r.DEFAULTS=o.extend({},o.fn.bsTooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),((r.prototype=o.extend({},o.fn.bsTooltip.Constructor.prototype)).constructor=r).prototype.getDefaults=function(){return r.DEFAULTS},r.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),i=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").empty()[this.options.html?"string"==typeof i?"html":"append":"text"](i),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},r.prototype.hasContent=function(){return this.getTitle()||this.getContent()},r.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},r.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},r.prototype.tip=function(){return this.$tip||(this.$tip=o(this.options.template)),this.$tip};var e=o.fn.popover;o.fn.popover=function(n){return this.each(function(){var e=o(this),t=e.data("bs.popover"),i="object"==typeof n&&n;!t&&"destroy"==n||(t||e.data("bs.popover",t=new r(this,i)),"string"==typeof n&&t[n]())})},o.fn.popover.Constructor=r,o.fn.popover.noConflict=function(){return o.fn.popover=e,this}}(jQuery),function(e,t){if("function"==typeof define&&define.amd)define(["jquery"],t);else if("object"==typeof module&&module.exports){var i;try{i=require("jquery")}catch(e){i=null}module.exports=t(i)}else e.Slider=t(e.jQuery)}(this,function(e){var t;return function(e){"use strict";var h=Array.prototype.slice;function t(){}!function(u){if(u){var d="undefined"==typeof console?t:function(e){console.error(e)};u.bridget=function(e,t){!function(e){e.prototype.option||(e.prototype.option=function(e){u.isPlainObject(e)&&(this.options=u.extend(!0,this.options,e))})}(t),function(l,c){u.fn[l]=function(t){if("string"==typeof t){for(var e=h.call(arguments,1),i=0,n=this.length;i<n;i++){var o=this[i],r=u.data(o,l);if(r)if(u.isFunction(r[t])&&"_"!==t.charAt(0)){var a=r[t].apply(r,e);if(void 0!==a&&a!==r)return a}else d("no such method '"+t+"' for "+l+" instance");else d("cannot call methods on "+l+" prior to initialization; attempted to call '"+t+"'")}return this}var s=this.map(function(){var e=u.data(this,l);return e?(e.option(t),e._init()):(e=new c(this,t),u.data(this,l,e)),u(this)});return!s||1<s.length?s:s[0]}}(e,t)},u.bridget}}(e)}(e),function(_){var n=function(e){return"Invalid input value '"+e+"' passed in"},A={linear:{toValue:function(e){var t=e/100*(this.options.max-this.options.min);if(0<this.options.ticks_positions.length){for(var i,n,o,r=0,a=0;a<this.options.ticks_positions.length;a++)if(e<=this.options.ticks_positions[a]){i=0<a?this.options.ticks[a-1]:0,o=0<a?this.options.ticks_positions[a-1]:0,n=this.options.ticks[a],r=this.options.ticks_positions[a];break}if(0<a)t=i+(e-o)/(r-o)*(n-i)}var s=this.options.min+Math.round(t/this.options.step)*this.options.step;return s<this.options.min?this.options.min:s>this.options.max?this.options.max:s},toPercentage:function(e){if(this.options.max===this.options.min)return 0;if(0<this.options.ticks_positions.length){for(var t,i,n,o=0,r=0;r<this.options.ticks.length;r++)if(e<=this.options.ticks[r]){t=0<r?this.options.ticks[r-1]:0,n=0<r?this.options.ticks_positions[r-1]:0,i=this.options.ticks[r],o=this.options.ticks_positions[r];break}if(0<r)return n+(e-t)/(i-t)*(o-n)}return 100*(e-this.options.min)/(this.options.max-this.options.min)}},logarithmic:{toValue:function(e){var t=0===this.options.min?0:Math.log(this.options.min),i=Math.log(this.options.max),n=Math.exp(t+(i-t)*e/100);return(n=this.options.min+Math.round((n-this.options.min)/this.options.step)*this.options.step)<this.options.min?this.options.min:n>this.options.max?this.options.max:n},toPercentage:function(e){if(this.options.max===this.options.min)return 0;var t=Math.log(this.options.max),i=0===this.options.min?0:Math.log(this.options.min);return 100*((0===e?0:Math.log(e))-i)/(t-i)}}};function i(e,t){"string"==typeof e?this.element=document.querySelector(e):e instanceof HTMLElement&&(this.element=e),t=t||{};for(var i=Object.keys(this.defaultOptions),n=0;n<i.length;n++){var o=i[n],r=t[o];r=null!==(r=void 0!==r?r:a(this.element,o))?r:this.defaultOptions[o],this.options||(this.options={}),this.options[o]=r}function a(e,t){var i="data-slider-"+t.replace(/_/g,"-"),n=e.getAttribute(i);try{return JSON.parse(n)}catch(e){return n}}var s,l,c,u,d,h=this.element.style.width,p=!1,f=this.element.parentNode;if(this.sliderElem)p=!0;else{this.sliderElem=document.createElement("div"),this.sliderElem.className="slider";var g=document.createElement("div");if(g.className="slider-track",(l=document.createElement("div")).className="slider-track-low",(s=document.createElement("div")).className="slider-selection",(c=document.createElement("div")).className="slider-track-high",(u=document.createElement("div")).className="slider-handle min-slider-handle",(d=document.createElement("div")).className="slider-handle max-slider-handle",g.appendChild(l),g.appendChild(s),g.appendChild(c),this.ticks=[],Array.isArray(this.options.ticks)&&0<this.options.ticks.length){for(n=0;n<this.options.ticks.length;n++){var m=document.createElement("div");m.className="slider-tick",this.ticks.push(m),g.appendChild(m)}s.className+=" tick-slider-selection"}if(g.appendChild(u),g.appendChild(d),this.tickLabels=[],Array.isArray(this.options.ticks_labels)&&0<this.options.ticks_labels.length)for(this.tickLabelContainer=document.createElement("div"),this.tickLabelContainer.className="slider-tick-label-container",n=0;n<this.options.ticks_labels.length;n++){var v=document.createElement("div");v.className="slider-tick-label",v.innerHTML=this.options.ticks_labels[n],this.tickLabels.push(v),this.tickLabelContainer.appendChild(v)}function y(e){var t=document.createElement("div");t.className="tooltip-arrow";var i=document.createElement("div");i.className="tooltip-inner",e.appendChild(t),e.appendChild(i)}var b=document.createElement("div");b.className="tooltip tooltip-main",y(b);var w=document.createElement("div");w.className="tooltip tooltip-min",y(w);var C=document.createElement("div");C.className="tooltip tooltip-max",y(C),this.sliderElem.appendChild(g),this.sliderElem.appendChild(b),this.sliderElem.appendChild(w),this.sliderElem.appendChild(C),this.tickLabelContainer&&this.sliderElem.appendChild(this.tickLabelContainer),f.insertBefore(this.sliderElem,this.element),this.element.style.display="none"}if(_&&(this.$element=_(this.element),this.$sliderElem=_(this.sliderElem)),this.eventToCallbackMap={},this.sliderElem.id=this.options.id,this.touchCapable="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,this.tooltip=this.sliderElem.querySelector(".tooltip-main"),this.tooltipInner=this.tooltip.querySelector(".tooltip-inner"),this.tooltip_min=this.sliderElem.querySelector(".tooltip-min"),this.tooltipInner_min=this.tooltip_min.querySelector(".tooltip-inner"),this.tooltip_max=this.sliderElem.querySelector(".tooltip-max"),this.tooltipInner_max=this.tooltip_max.querySelector(".tooltip-inner"),A[this.options.scale]&&(this.options.scale=A[this.options.scale]),!0===p&&(this._removeClass(this.sliderElem,"slider-horizontal"),this._removeClass(this.sliderElem,"slider-vertical"),this._removeClass(this.tooltip,"hide"),this._removeClass(this.tooltip_min,"hide"),this._removeClass(this.tooltip_max,"hide"),["left","top","width","height"].forEach(function(e){this._removeProperty(this.trackLow,e),this._removeProperty(this.trackSelection,e),this._removeProperty(this.trackHigh,e)},this),[this.handle1,this.handle2].forEach(function(e){this._removeProperty(e,"left"),this._removeProperty(e,"top")},this),[this.tooltip,this.tooltip_min,this.tooltip_max].forEach(function(e){this._removeProperty(e,"left"),this._removeProperty(e,"top"),this._removeProperty(e,"margin-left"),this._removeProperty(e,"margin-top"),this._removeClass(e,"right"),this._removeClass(e,"top")},this)),"vertical"===this.options.orientation?(this._addClass(this.sliderElem,"slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight",this._addClass(this.tooltip,"right"),this.tooltip.style.left="100%",this._addClass(this.tooltip_min,"right"),this.tooltip_min.style.left="100%",this._addClass(this.tooltip_max,"right"),this.tooltip_max.style.left="100%"):(this._addClass(this.sliderElem,"slider-horizontal"),this.sliderElem.style.width=h,this.options.orientation="horizontal",this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth",this._addClass(this.tooltip,"top"),this.tooltip.style.top=-this.tooltip.outerHeight-14+"px",this._addClass(this.tooltip_min,"top"),this.tooltip_min.style.top=-this.tooltip_min.outerHeight-14+"px",this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top=-this.tooltip_max.outerHeight-14+"px"),Array.isArray(this.options.ticks)&&0<this.options.ticks.length&&(this.options.max=Math.max.apply(Math,this.options.ticks),this.options.min=Math.min.apply(Math,this.options.ticks)),Array.isArray(this.options.value)?this.options.range=!0:this.options.range&&(this.options.value=[this.options.value,this.options.max]),this.trackLow=l||this.trackLow,this.trackSelection=s||this.trackSelection,this.trackHigh=c||this.trackHigh,"none"===this.options.selection&&(this._addClass(this.trackLow,"hide"),this._addClass(this.trackSelection,"hide"),this._addClass(this.trackHigh,"hide")),this.handle1=u||this.handle1,this.handle2=d||this.handle2,!0===p)for(this._removeClass(this.handle1,"round triangle"),this._removeClass(this.handle2,"round triangle hide"),n=0;n<this.ticks.length;n++)this._removeClass(this.ticks[n],"round triangle hide");if(-1!==["round","triangle","custom"].indexOf(this.options.handle))for(this._addClass(this.handle1,this.options.handle),this._addClass(this.handle2,this.options.handle),n=0;n<this.ticks.length;n++)this._addClass(this.ticks[n],this.options.handle);this.offset=this._offset(this.sliderElem),this.size=this.sliderElem[this.sizePos],this.setValue(this.options.value),this.handle1Keydown=this._keydown.bind(this,0),this.handle1.addEventListener("keydown",this.handle1Keydown,!1),this.handle2Keydown=this._keydown.bind(this,1),this.handle2.addEventListener("keydown",this.handle2Keydown,!1),this.mousedown=this._mousedown.bind(this),this.touchCapable&&this.sliderElem.addEventListener("touchstart",this.mousedown,!1),this.sliderElem.addEventListener("mousedown",this.mousedown,!1),"hide"===this.options.tooltip?(this._addClass(this.tooltip,"hide"),this._addClass(this.tooltip_min,"hide"),this._addClass(this.tooltip_max,"hide")):"always"===this.options.tooltip?(this._showTooltip(),this._alwaysShowTooltip=!0):(this.showTooltip=this._showTooltip.bind(this),this.hideTooltip=this._hideTooltip.bind(this),this.sliderElem.addEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.addEventListener("mouseleave",this.hideTooltip,!1),this.handle1.addEventListener("focus",this.showTooltip,!1),this.handle1.addEventListener("blur",this.hideTooltip,!1),this.handle2.addEventListener("focus",this.showTooltip,!1),this.handle2.addEventListener("blur",this.hideTooltip,!1)),this.options.enabled?this.enable():this.disable()}if((t=function(e,t){return i.call(this,e,t),this}).prototype={_init:function(){},constructor:t,defaultOptions:{id:"",min:0,max:10,step:1,precision:0,orientation:"horizontal",value:5,range:!1,selection:"before",tooltip:"show",tooltip_split:!1,handle:"round",reversed:!1,enabled:!0,formatter:function(e){return Array.isArray(e)?e[0]+" : "+e[1]:e},natural_arrow_keys:!1,ticks:[],ticks_positions:[],ticks_labels:[],ticks_snap_bounds:0,scale:"linear",focus:!1},over:!1,inDrag:!1,getValue:function(){return this.options.range?this.options.value:this.options.value[0]},setValue:function(e,t,i){e=e||0;var n=this.getValue();this.options.value=this._validateInputValue(e);var o=this._applyPrecision.bind(this);this.options.range?(this.options.value[0]=o(this.options.value[0]),this.options.value[1]=o(this.options.value[1]),this.options.value[0]=Math.max(this.options.min,Math.min(this.options.max,this.options.value[0])),this.options.value[1]=Math.max(this.options.min,Math.min(this.options.max,this.options.value[1]))):(this.options.value=o(this.options.value),this.options.value=[Math.max(this.options.min,Math.min(this.options.max,this.options.value))],this._addClass(this.handle2,"hide"),"after"===this.options.selection?this.options.value[1]=this.options.max:this.options.value[1]=this.options.min),this.options.max>this.options.min?this.percentage=[this._toPercentage(this.options.value[0]),this._toPercentage(this.options.value[1]),100*this.options.step/(this.options.max-this.options.min)]:this.percentage=[0,0,100],this._layout();var r=this.options.range?this.options.value:this.options.value[0];return!0===t&&this._trigger("slide",r),n!==r&&!0===i&&this._trigger("change",{oldValue:n,newValue:r}),this._setDataVal(r),this},destroy:function(){this._removeSliderEventHandlers(),this.sliderElem.parentNode.removeChild(this.sliderElem),this.element.style.display="",this._cleanUpEventCallbacksMap(),this.element.removeAttribute("data"),_&&(this._unbindJQueryEventHandlers(),this.$element.removeData("slider"))},disable:function(){return this.options.enabled=!1,this.handle1.removeAttribute("tabindex"),this.handle2.removeAttribute("tabindex"),this._addClass(this.sliderElem,"slider-disabled"),this._trigger("slideDisabled"),this},enable:function(){return this.options.enabled=!0,this.handle1.setAttribute("tabindex",0),this.handle2.setAttribute("tabindex",0),this._removeClass(this.sliderElem,"slider-disabled"),this._trigger("slideEnabled"),this},toggle:function(){return this.options.enabled?this.disable():this.enable(),this},isEnabled:function(){return this.options.enabled},on:function(e,t){return this._bindNonQueryEventHandler(e,t),this},getAttribute:function(e){return e?this.options[e]:this.options},setAttribute:function(e,t){return this.options[e]=t,this},refresh:function(){return this._removeSliderEventHandlers(),i.call(this,this.element,this.options),_&&_.data(this.element,"slider",this),this},relayout:function(){return this._layout(),this},_removeSliderEventHandlers:function(){this.handle1.removeEventListener("keydown",this.handle1Keydown,!1),this.handle1.removeEventListener("focus",this.showTooltip,!1),this.handle1.removeEventListener("blur",this.hideTooltip,!1),this.handle2.removeEventListener("keydown",this.handle2Keydown,!1),this.handle2.removeEventListener("focus",this.handle2Keydown,!1),this.handle2.removeEventListener("blur",this.handle2Keydown,!1),this.sliderElem.removeEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.removeEventListener("mouseleave",this.hideTooltip,!1),this.sliderElem.removeEventListener("touchstart",this.mousedown,!1),this.sliderElem.removeEventListener("mousedown",this.mousedown,!1)},_bindNonQueryEventHandler:function(e,t){void 0===this.eventToCallbackMap[e]&&(this.eventToCallbackMap[e]=[]),this.eventToCallbackMap[e].push(t)},_cleanUpEventCallbacksMap:function(){for(var e=Object.keys(this.eventToCallbackMap),t=0;t<e.length;t++){var i=e[t];this.eventToCallbackMap[i]=null}},_showTooltip:function(){!1===this.options.tooltip_split?this._addClass(this.tooltip,"in"):(this._addClass(this.tooltip_min,"in"),this._addClass(this.tooltip_max,"in")),this.over=!0},_hideTooltip:function(){!1===this.inDrag&&!0!==this.alwaysShowTooltip&&(this._removeClass(this.tooltip,"in"),this._removeClass(this.tooltip_min,"in"),this._removeClass(this.tooltip_max,"in")),this.over=!1},_layout:function(){var e,t;if(e=this.options.reversed?[100-this.percentage[0],this.percentage[1]]:[this.percentage[0],this.percentage[1]],this.handle1.style[this.stylePos]=e[0]+"%",this.handle2.style[this.stylePos]=e[1]+"%",Array.isArray(this.options.ticks)&&0<this.options.ticks.length){var i=Math.max.apply(Math,this.options.ticks),n=Math.min.apply(Math,this.options.ticks),o="vertical"===this.options.orientation?"height":"width",r="vertical"===this.options.orientation?"marginTop":"marginLeft",a=this.size/(this.options.ticks.length-1);if(this.tickLabelContainer){var s=0;if(0===this.options.ticks_positions.length)this.tickLabelContainer.style[r]=-a/2+"px",s=this.tickLabelContainer.offsetHeight;else for(l=0;l<this.tickLabelContainer.childNodes.length;l++)this.tickLabelContainer.childNodes[l].offsetHeight>s&&(s=this.tickLabelContainer.childNodes[l].offsetHeight);"horizontal"===this.options.orientation&&(this.sliderElem.style.marginBottom=s+"px")}for(var l=0;l<this.options.ticks.length;l++){var c=this.options.ticks_positions[l]||100*(this.options.ticks[l]-n)/(i-n);this.ticks[l].style[this.stylePos]=c+"%",this._removeClass(this.ticks[l],"in-selection"),this.options.range?c>=e[0]&&c<=e[1]&&this._addClass(this.ticks[l],"in-selection"):"after"===this.options.selection&&c>=e[0]?this._addClass(this.ticks[l],"in-selection"):"before"===this.options.selection&&c<=e[0]&&this._addClass(this.ticks[l],"in-selection"),this.tickLabels[l]&&(this.tickLabels[l].style[o]=a+"px",void 0!==this.options.ticks_positions[l]&&(this.tickLabels[l].style.position="absolute",this.tickLabels[l].style[this.stylePos]=this.options.ticks_positions[l]+"%",this.tickLabels[l].style[r]=-a/2+"px"))}}if("vertical"===this.options.orientation)this.trackLow.style.top="0",this.trackLow.style.height=Math.min(e[0],e[1])+"%",this.trackSelection.style.top=Math.min(e[0],e[1])+"%",this.trackSelection.style.height=Math.abs(e[0]-e[1])+"%",this.trackHigh.style.bottom="0",this.trackHigh.style.height=100-Math.min(e[0],e[1])-Math.abs(e[0]-e[1])+"%";else{this.trackLow.style.left="0",this.trackLow.style.width=Math.min(e[0],e[1])+"%",this.trackSelection.style.left=Math.min(e[0],e[1])+"%",this.trackSelection.style.width=Math.abs(e[0]-e[1])+"%",this.trackHigh.style.right="0",this.trackHigh.style.width=100-Math.min(e[0],e[1])-Math.abs(e[0]-e[1])+"%";var u=this.tooltip_min.getBoundingClientRect(),d=this.tooltip_max.getBoundingClientRect();u.right>d.left?(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top="18px"):(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top=this.tooltip_min.style.top)}if(this.options.range){t=this.options.formatter(this.options.value),this._setText(this.tooltipInner,t),this.tooltip.style[this.stylePos]=(e[1]+e[0])/2+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px"),"vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px");var h=this.options.formatter(this.options.value[0]);this._setText(this.tooltipInner_min,h);var p=this.options.formatter(this.options.value[1]);this._setText(this.tooltipInner_max,p),this.tooltip_min.style[this.stylePos]=e[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip_min,"margin-top",-this.tooltip_min.offsetHeight/2+"px"):this._css(this.tooltip_min,"margin-left",-this.tooltip_min.offsetWidth/2+"px"),this.tooltip_max.style[this.stylePos]=e[1]+"%","vertical"===this.options.orientation?this._css(this.tooltip_max,"margin-top",-this.tooltip_max.offsetHeight/2+"px"):this._css(this.tooltip_max,"margin-left",-this.tooltip_max.offsetWidth/2+"px")}else t=this.options.formatter(this.options.value[0]),this._setText(this.tooltipInner,t),this.tooltip.style[this.stylePos]=e[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px")},_removeProperty:function(e,t){e.style.removeProperty?e.style.removeProperty(t):e.style.removeAttribute(t)},_mousedown:function(e){if(!this.options.enabled)return!1;this.offset=this._offset(this.sliderElem),this.size=this.sliderElem[this.sizePos];var t=this._getPercentage(e);if(this.options.range){var i=Math.abs(this.percentage[0]-t),n=Math.abs(this.percentage[1]-t);this.dragged=i<n?0:1}else this.dragged=0;this.percentage[this.dragged]=this.options.reversed?100-t:t,this._layout(),this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),this.mousemove&&document.removeEventListener("mousemove",this.mousemove,!1),this.mouseup&&document.removeEventListener("mouseup",this.mouseup,!1),this.mousemove=this._mousemove.bind(this),this.mouseup=this._mouseup.bind(this),this.touchCapable&&(document.addEventListener("touchmove",this.mousemove,!1),document.addEventListener("touchend",this.mouseup,!1)),document.addEventListener("mousemove",this.mousemove,!1),document.addEventListener("mouseup",this.mouseup,!1),this.inDrag=!0;var o=this._calculateValue();return this._trigger("slideStart",o),this._setDataVal(o),this.setValue(o,!1,!0),this._pauseEvent(e),this.options.focus&&this._triggerFocusOnHandle(this.dragged),!0},_triggerFocusOnHandle:function(e){0===e&&this.handle1.focus(),1===e&&this.handle2.focus()},_keydown:function(e,t){if(!this.options.enabled)return!1;var i;switch(t.keyCode){case 37:case 40:i=-1;break;case 39:case 38:i=1}if(i){if(this.options.natural_arrow_keys){var n="vertical"===this.options.orientation&&!this.options.reversed,o="horizontal"===this.options.orientation&&this.options.reversed;(n||o)&&(i=-i)}var r=this.options.value[e]+i*this.options.step;return this.options.range&&(r=[e?this.options.value[0]:r,e?r:this.options.value[1]]),this._trigger("slideStart",r),this._setDataVal(r),this.setValue(r,!0,!0),this._trigger("slideStop",r),this._setDataVal(r),this._layout(),this._pauseEvent(t),!1}},_pauseEvent:function(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1},_mousemove:function(e){if(!this.options.enabled)return!1;var t=this._getPercentage(e);this._adjustPercentageForRangeSliders(t),this.percentage[this.dragged]=this.options.reversed?100-t:t,this._layout();var i=this._calculateValue(!0);return this.setValue(i,!0,!0),!1},_adjustPercentageForRangeSliders:function(e){this.options.range&&(0===this.dragged&&this.percentage[1]<e?(this.percentage[0]=this.percentage[1],this.dragged=1):1===this.dragged&&this.percentage[0]>e&&(this.percentage[1]=this.percentage[0],this.dragged=0))},_mouseup:function(){if(!this.options.enabled)return!1;this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),document.removeEventListener("mousemove",this.mousemove,!1),document.removeEventListener("mouseup",this.mouseup,!1),(this.inDrag=!1)===this.over&&this._hideTooltip();var e=this._calculateValue(!0);return this._layout(),this._trigger("slideStop",e),this._setDataVal(e),!1},_calculateValue:function(e){var t;if(this.options.range?(t=[this.options.min,this.options.max],0!==this.percentage[0]&&(t[0]=this._toValue(this.percentage[0]),t[0]=this._applyPrecision(t[0])),100!==this.percentage[1]&&(t[1]=this._toValue(this.percentage[1]),t[1]=this._applyPrecision(t[1]))):(t=this._toValue(this.percentage[0]),t=parseFloat(t),t=this._applyPrecision(t)),e){for(var i=[t,1/0],n=0;n<this.options.ticks.length;n++){var o=Math.abs(this.options.ticks[n]-t);o<=i[1]&&(i=[this.options.ticks[n],o])}if(i[1]<=this.options.ticks_snap_bounds)return i[0]}return t},_applyPrecision:function(e){var t=this.options.precision||this._getNumDigitsAfterDecimalPlace(this.options.step);return this._applyToFixedAndParseFloat(e,t)},_getNumDigitsAfterDecimalPlace:function(e){var t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},_applyToFixedAndParseFloat:function(e,t){var i=e.toFixed(t);return parseFloat(i)},_getPercentage:function(e){!this.touchCapable||"touchstart"!==e.type&&"touchmove"!==e.type||(e=e.touches[0]);var t=(e[this.mousePos]-this.offset[this.stylePos])/this.size*100;return t=Math.round(t/this.percentage[2])*this.percentage[2],Math.max(0,Math.min(100,t))},_validateInputValue:function(e){if("number"==typeof e)return e;if(Array.isArray(e))return this._validateArray(e),e;throw new Error(n(e))},_validateArray:function(e){for(var t=0;t<e.length;t++){var i=e[t];if("number"!=typeof i)throw new Error(n(i))}},_setDataVal:function(e){var t="value: '"+e+"'";this.element.setAttribute("data",t),this.element.setAttribute("value",e),this.element.value=e},_trigger:function(e,t){t=t||0===t?t:void 0;var i=this.eventToCallbackMap[e];if(i&&i.length)for(var n=0;n<i.length;n++){(0,i[n])(t)}_&&this._triggerJQueryEvent(e,t)},_triggerJQueryEvent:function(e,t){var i={type:e,value:t};this.$element.trigger(i),this.$sliderElem.trigger(i)},_unbindJQueryEventHandlers:function(){this.$element.off(),this.$sliderElem.off()},_setText:function(e,t){void 0!==e.innerText?e.innerText=t:void 0!==e.textContent&&(e.textContent=t)},_removeClass:function(e,t){for(var i=t.split(" "),n=e.className,o=0;o<i.length;o++){var r=i[o],a=new RegExp("(?:\\s|^)"+r+"(?:\\s|$)");n=n.replace(a," ")}e.className=n.trim()},_addClass:function(e,t){for(var i=t.split(" "),n=e.className,o=0;o<i.length;o++){var r=i[o];new RegExp("(?:\\s|^)"+r+"(?:\\s|$)").test(n)||(n+=" "+r)}e.className=n.trim()},_offsetLeft:function(e){for(var t=e.offsetLeft;(e=e.offsetParent)&&!isNaN(e.offsetLeft);)t+=e.offsetLeft;return t},_offsetTop:function(e){for(var t=e.offsetTop;(e=e.offsetParent)&&!isNaN(e.offsetTop);)t+=e.offsetTop;return t},_offset:function(e){return{left:this._offsetLeft(e),top:this._offsetTop(e)}},_css:function(e,t,i){if(_)_.style(e,t,i);else{var n=t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()});e.style[n]=i}},_toValue:function(e){return this.options.scale.toValue.apply(this,[e])},_toPercentage:function(e){return this.options.scale.toPercentage.apply(this,[e])}},_){var e=_.fn.slider?"bootstrapSlider":"slider";_.bridget(e,t)}}(e),t}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):window.jQuery&&!window.jQuery.fn.colorpicker&&e(window.jQuery)}(function(l){"use strict";function n(e){this.value={h:0,s:0,b:0,a:1},this.origFormat=null,e&&(void 0!==e.toLowerCase?(e+="",this.setColor(e)):void 0!==e.h&&(this.value=e))}function a(e,t){this.element=l(e).addClass("colorpicker-element"),this.options=l.extend(!0,{},i,this.element.data(),t),this.component=this.options.component,this.component=!1!==this.component&&this.element.find(this.component),this.component&&0===this.component.length&&(this.component=!1),this.container=!0===this.options.container?this.element:this.options.container,this.container=!1!==this.container&&l(this.container),this.input=this.element.is("input")?this.element:!!this.options.input&&this.element.find(this.options.input),this.input&&0===this.input.length&&(this.input=!1),this.color=new n(!1!==this.options.color?this.options.color:this.getValue()),this.format=!1!==this.options.format?this.options.format:this.color.origFormat,this.picker=l(this.options.template),this.options.customClass&&this.picker.addClass(this.options.customClass),this.options.inline?this.picker.addClass("colorpicker-inline colorpicker-visible"):this.picker.addClass("colorpicker-hidden"),this.options.horizontal&&this.picker.addClass("colorpicker-horizontal"),"rgba"!==this.format&&"hsla"!==this.format&&!1!==this.options.format||this.picker.addClass("colorpicker-with-alpha"),"right"===this.options.align&&this.picker.addClass("colorpicker-right"),this.picker.on("mousedown.colorpicker touchstart.colorpicker",l.proxy(this.mousedown,this)),this.picker.appendTo(this.container?this.container:l("body")),!1!==this.input&&(this.input.on({"keyup.colorpicker":l.proxy(this.keyup,this)}),!1===this.component&&this.element.on({"focus.colorpicker":l.proxy(this.show,this)}),!1===this.options.inline&&this.element.on({"focusout.colorpicker":l.proxy(this.hide,this)})),!1!==this.component&&this.component.on({"click.colorpicker":l.proxy(this.show,this)}),!1===this.input&&!1===this.component&&this.element.on({"click.colorpicker":l.proxy(this.show,this)}),!1!==this.input&&!1!==this.component&&"color"===this.input.attr("type")&&this.input.on({"click.colorpicker":l.proxy(this.show,this),"focus.colorpicker":l.proxy(this.show,this)}),this.update(),l(l.proxy(function(){this.element.trigger("create")},this))}var i={horizontal:!(n.prototype={constructor:n,colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:"transparent"},_sanitizeNumber:function(e){return"number"==typeof e?e:isNaN(e)||null===e||""===e||void 0===e?1:void 0!==e.toLowerCase?parseFloat(e):1},isTransparent:function(e){return!!e&&("transparent"===(e=e.toLowerCase().trim())||e.match(/#?00000000/)||e.match(/(rgba|hsla)\(0,0,0,0?\.?0\)/))},rgbaIsTransparent:function(e){return 0===e.r&&0===e.g&&0===e.b&&0===e.a},setColor:function(e){(e=e.toLowerCase().trim())&&(this.isTransparent(e)?this.value={h:0,s:0,b:0,a:0}:this.value=this.stringToHSB(e)||{h:0,s:0,b:0,a:1})},stringToHSB:function(r){r=r.toLowerCase();var a=this,s=!1;return l.each(this.stringParsers,function(e,t){var i=t.re.exec(r),n=i&&t.parse.apply(a,[i]),o=t.format||"rgba";return!n||(s=o.match(/hsla?/)?a.RGBtoHSB.apply(a,a.HSLtoRGB.apply(a,n)):a.RGBtoHSB.apply(a,n),a.origFormat=o,!1)}),s},setHue:function(e){this.value.h=1-e},setSaturation:function(e){this.value.s=e},setBrightness:function(e){this.value.b=1-e},setAlpha:function(e){this.value.a=parseInt(100*(1-e),10)/100},toRGB:function(e,t,i,n){var o,r,a,s,l;return e||(e=this.value.h,t=this.value.s,i=this.value.b),e=(e*=360)%360/60,o=r=a=i-(l=i*t),o+=[l,s=l*(1-Math.abs(e%2-1)),0,0,s,l][e=~~e],r+=[s,l,l,s,0,0][e],a+=[0,0,s,l,l,s][e],{r:Math.round(255*o),g:Math.round(255*r),b:Math.round(255*a),a:n||this.value.a}},toHex:function(e,t,i,n){var o=this.toRGB(e,t,i,n);return this.rgbaIsTransparent(o)?"transparent":"#"+(1<<24|parseInt(o.r)<<16|parseInt(o.g)<<8|parseInt(o.b)).toString(16).substr(1)},toHSL:function(e,t,i,n){e=e||this.value.h,t=t||this.value.s,i=i||this.value.b,n=n||this.value.a;var o=e,r=(2-t)*i,a=t*i;return a/=0<r&&r<=1?r:2-r,r/=2,1<a&&(a=1),{h:isNaN(o)?0:o,s:isNaN(a)?0:a,l:isNaN(r)?0:r,a:isNaN(n)?0:n}},toAlias:function(e,t,i,n){var o=this.toHex(e,t,i,n);for(var r in this.colors)if(this.colors[r]===o)return r;return!1},RGBtoHSB:function(e,t,i,n){var o,r,a,s;return e/=255,t/=255,i/=255,o=((o=0==(s=(a=Math.max(e,t,i))-Math.min(e,t,i))?null:a===e?(t-i)/s:a===t?(i-e)/s+2:(e-t)/s+4)+360)%6*60/360,r=0==s?0:s/a,{h:this._sanitizeNumber(o),s:r,b:a,a:this._sanitizeNumber(n)}},HueToRGB:function(e,t,i){return i<0?i+=1:1<i&&(i-=1),6*i<1?e+(t-e)*i*6:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e},HSLtoRGB:function(e,t,i,n){var o;t<0&&(t=0);var r=2*i-(o=i<=.5?i*(1+t):i+t-i*t),a=e+1/3,s=e,l=e-1/3;return[Math.round(255*this.HueToRGB(r,o,a)),Math.round(255*this.HueToRGB(r,o,s)),Math.round(255*this.HueToRGB(r,o,l)),this._sanitizeNumber(n)]},toString:function(e){var t=!1;switch(e=e||"rgba"){case"rgb":return t=this.toRGB(),this.rgbaIsTransparent(t)?"transparent":"rgb("+t.r+","+t.g+","+t.b+")";case"rgba":return"rgba("+(t=this.toRGB()).r+","+t.g+","+t.b+","+t.a+")";case"hsl":return t=this.toHSL(),"hsl("+Math.round(360*t.h)+","+Math.round(100*t.s)+"%,"+Math.round(100*t.l)+"%)";case"hsla":return t=this.toHSL(),"hsla("+Math.round(360*t.h)+","+Math.round(100*t.s)+"%,"+Math.round(100*t.l)+"%,"+t.a+")";case"hex":return this.toHex();case"alias":return this.toAlias()||this.toHex();default:return t}},stringParsers:[{re:/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*?\)/,format:"rgb",parse:function(e){return[e[1],e[2],e[3],1]}},{re:/rgb\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*?\)/,format:"rgb",parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],1]}},{re:/rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,format:"rgba",parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,format:"rgba",parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/hsl\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*?\)/,format:"hsl",parse:function(e){return[e[1]/360,e[2]/100,e[3]/100,e[4]]}},{re:/hsla\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,format:"hsla",parse:function(e){return[e[1]/360,e[2]/100,e[3]/100,e[4]]}},{re:/#?([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,format:"hex",parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),1]}},{re:/#?([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,format:"hex",parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),1]}},{re:/^([a-z]{3,})$/,format:"alias",parse:function(e){var t=this.colorNameToHex(e[0])||"#000000",i=this.stringParsers[6].re.exec(t);return i&&this.stringParsers[6].parse.apply(this,[i])}}],colorNameToHex:function(e){return void 0!==this.colors[e.toLowerCase()]&&this.colors[e.toLowerCase()]}}),inline:!1,color:!1,format:!1,input:"input",container:!1,component:".add-on, .input-group-addon",sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setBrightness"},hue:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setHue"},alpha:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setAlpha"}},slidersHorz:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setBrightness"},hue:{maxLeft:100,maxTop:0,callLeft:"setHue",callTop:!1},alpha:{maxLeft:100,maxTop:0,callLeft:"setAlpha",callTop:!1}},template:'<div class="colorpicker dropdown-menu"><div class="colorpicker-saturation"><i><b></b></i></div><div class="colorpicker-hue"><i></i></div><div class="colorpicker-alpha"><i></i></div><div class="colorpicker-color"><div /></div></div>',align:"right",customClass:null};a.Color=n,a.prototype={constructor:a,destroy:function(){this.picker.remove(),this.element.removeData("colorpicker").off(".colorpicker"),!1!==this.input&&this.input.off(".colorpicker"),!1!==this.component&&this.component.off(".colorpicker"),this.element.removeClass("colorpicker-element"),this.element.trigger({type:"destroy"})},reposition:function(){if(!1!==this.options.inline||this.options.container)return!1;var e=this.container&&this.container[0]!==document.body?"position":"offset",t=this.component||this.element,i=t[e]();"right"===this.options.align&&(i.left-=this.picker.outerWidth()-t.outerWidth()),this.picker.css({top:i.top+t.outerHeight(),left:i.left})},show:function(e){if(this.isDisabled())return!1;this.picker.addClass("colorpicker-visible").removeClass("colorpicker-hidden"),this.reposition(),l(window).on("resize.colorpicker",l.proxy(this.reposition,this)),!e||this.hasInput()&&"color"!==this.input.attr("type")||e.stopPropagation&&e.preventDefault&&(e.stopPropagation(),e.preventDefault()),!1===this.options.inline&&l(window.document).on({"mousedown.colorpicker":l.proxy(this.hide,this)}),this.element.trigger({type:"showPicker",color:this.color})},hide:function(){this.picker.addClass("colorpicker-hidden").removeClass("colorpicker-visible"),l(window).off("resize.colorpicker",this.reposition),l(document).off({"mousedown.colorpicker":this.hide}),this.update(),this.element.trigger({type:"hidePicker",color:this.color})},updateData:function(e){return e=e||this.color.toString(this.format),this.element.data("color",e),e},updateInput:function(e){return e=e||this.color.toString(this.format),!1!==this.input&&this.input.prop("value",e),e},updatePicker:function(e){void 0!==e&&(this.color=new n(e));var t=!1===this.options.horizontal?this.options.sliders:this.options.slidersHorz,i=this.picker.find("i");if(0!==i.length)return!1===this.options.horizontal?(t=this.options.sliders,i.eq(1).css("top",t.hue.maxTop*(1-this.color.value.h)).end().eq(2).css("top",t.alpha.maxTop*(1-this.color.value.a))):(t=this.options.slidersHorz,i.eq(1).css("left",t.hue.maxLeft*(1-this.color.value.h)).end().eq(2).css("left",t.alpha.maxLeft*(1-this.color.value.a))),i.eq(0).css({top:t.saturation.maxTop-this.color.value.b*t.saturation.maxTop,left:this.color.value.s*t.saturation.maxLeft}),this.picker.find(".colorpicker-saturation").css("backgroundColor",this.color.toHex(this.color.value.h,1,1,1)),this.picker.find(".colorpicker-alpha").css("backgroundColor",this.color.toHex()),this.picker.find(".colorpicker-color, .colorpicker-color div").css("backgroundColor",this.color.toString(this.format)),e},updateComponent:function(e){if(e=e||this.color.toString(this.format),!1!==this.component){var t=this.component.find("i").eq(0);0<t.length?t.css({backgroundColor:e}):this.component.css({backgroundColor:e})}return e},update:function(e){var t;return!1===this.getValue(!1)&&!0!==e||(t=this.updateComponent(),this.updateInput(t),this.updateData(t),this.updatePicker()),t},setValue:function(e){this.color=new n(e),this.update(),this.element.trigger({type:"changeColor",color:this.color,value:e})},getValue:function(e){var t;return e=void 0===e?"#000000":e,void 0!==(t=this.hasInput()?this.input.val():this.element.data("color"))&&""!==t&&null!==t||(t=e),t},hasInput:function(){return!1!==this.input},isDisabled:function(){return!!this.hasInput()&&!0===this.input.prop("disabled")},disable:function(){return!!this.hasInput()&&(this.input.prop("disabled",!0),this.element.trigger({type:"disable",color:this.color,value:this.getValue()}),!0)},enable:function(){return!!this.hasInput()&&(this.input.prop("disabled",!1),this.element.trigger({type:"enable",color:this.color,value:this.getValue()}),!0)},currentSlider:null,mousePointer:{left:0,top:0},mousedown:function(e){e.pageX||e.pageY||!e.originalEvent||(e.pageX=e.originalEvent.touches[0].pageX,e.pageY=e.originalEvent.touches[0].pageY),e.stopPropagation(),e.preventDefault();var t=l(e.target).closest("div"),i=this.options.horizontal?this.options.slidersHorz:this.options.sliders;if(!t.is(".colorpicker")){if(t.is(".colorpicker-saturation"))this.currentSlider=l.extend({},i.saturation);else if(t.is(".colorpicker-hue"))this.currentSlider=l.extend({},i.hue);else{if(!t.is(".colorpicker-alpha"))return!1;this.currentSlider=l.extend({},i.alpha)}var n=t.offset();this.currentSlider.guide=t.find("i")[0].style,this.currentSlider.left=e.pageX-n.left,this.currentSlider.top=e.pageY-n.top,this.mousePointer={left:e.pageX,top:e.pageY},l(document).on({"mousemove.colorpicker":l.proxy(this.mousemove,this),"touchmove.colorpicker":l.proxy(this.mousemove,this),"mouseup.colorpicker":l.proxy(this.mouseup,this),"touchend.colorpicker":l.proxy(this.mouseup,this)}).trigger("mousemove")}return!1},mousemove:function(e){e.pageX||e.pageY||!e.originalEvent||(e.pageX=e.originalEvent.touches[0].pageX,e.pageY=e.originalEvent.touches[0].pageY),e.stopPropagation(),e.preventDefault();var t=Math.max(0,Math.min(this.currentSlider.maxLeft,this.currentSlider.left+((e.pageX||this.mousePointer.left)-this.mousePointer.left))),i=Math.max(0,Math.min(this.currentSlider.maxTop,this.currentSlider.top+((e.pageY||this.mousePointer.top)-this.mousePointer.top)));return this.currentSlider.guide.left=t+"px",this.currentSlider.guide.top=i+"px",this.currentSlider.callLeft&&this.color[this.currentSlider.callLeft].call(this.color,t/this.currentSlider.maxLeft),this.currentSlider.callTop&&this.color[this.currentSlider.callTop].call(this.color,i/this.currentSlider.maxTop),"setAlpha"===this.currentSlider.callTop&&!1===this.options.format&&(1!==this.color.value.a?(this.format="rgba",this.color.origFormat="rgba"):(this.format="hex",this.color.origFormat="hex")),this.update(!0),this.element.trigger({type:"changeColor",color:this.color}),!1},mouseup:function(e){return e.stopPropagation(),e.preventDefault(),l(document).off({"mousemove.colorpicker":this.mousemove,"touchmove.colorpicker":this.mousemove,"mouseup.colorpicker":this.mouseup,"touchend.colorpicker":this.mouseup}),!1},keyup:function(e){38===e.keyCode?(this.color.value.a<1&&(this.color.value.a=Math.round(100*(this.color.value.a+.01))/100),this.update(!0)):40===e.keyCode?(0<this.color.value.a&&(this.color.value.a=Math.round(100*(this.color.value.a-.01))/100),this.update(!0)):(this.color=new n(this.input.val()),this.color.origFormat&&!1===this.options.format&&(this.format=this.color.origFormat),!1!==this.getValue(!1)&&(this.updateData(),this.updateComponent(),this.updatePicker())),this.element.trigger({type:"changeColor",color:this.color,value:this.input.val()})}},l.colorpicker=a,l.fn.colorpicker=function(n){var o,r=arguments,e=this.each(function(){var e=l(this),t=e.data("colorpicker"),i="object"==typeof n?n:{};t||"string"==typeof n?"string"==typeof n&&(o=t[n].apply(t,Array.prototype.slice.call(r,1))):e.data("colorpicker",new a(this,i))});return"getValue"===n?o:e},l.fn.colorpicker.constructor=a}),function(){var M={version:"3.5.5"},o=[].slice,d=function(e){return o.call(e)},b=this.document;function s(e){return e&&(e.ownerDocument||e.document||e).documentElement}function P(e){return e&&(e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView)}if(b)try{d(b.documentElement.childNodes)[0].nodeType}catch(e){d=function(e){for(var t=e.length,i=new Array(t);t--;)i[t]=e[t];return i}}if(Date.now||(Date.now=function(){return+new Date}),b)try{b.createElement("DIV").style.setProperty("opacity",0,"")}catch(e){var t=this.Element.prototype,i=t.setAttribute,n=t.setAttributeNS,r=this.CSSStyleDeclaration.prototype,a=r.setProperty;t.setAttribute=function(e,t){i.call(this,e,t+"")},t.setAttributeNS=function(e,t,i){n.call(this,e,t,i+"")},r.setProperty=function(e,t,i){a.call(this,e,t+"",i)}}function l(e,t){return e<t?-1:t<e?1:t<=e?0:NaN}function c(e){return null===e?NaN:+e}function u(e){return!isNaN(e)}function e(r){return{left:function(e,t,i,n){for(arguments.length<3&&(i=0),arguments.length<4&&(n=e.length);i<n;){var o=i+n>>>1;r(e[o],t)<0?i=1+o:n=o}return i},right:function(e,t,i,n){for(arguments.length<3&&(i=0),arguments.length<4&&(n=e.length);i<n;){var o=i+n>>>1;0<r(e[o],t)?n=o:i=1+o}return i}}}M.ascending=l,M.descending=function(e,t){return t<e?-1:e<t?1:e<=t?0:NaN},M.min=function(e,t){var i,n,o=-1,r=e.length;if(1===arguments.length){for(;++o<r;)if(null!=(n=e[o])&&n<=n){i=n;break}for(;++o<r;)null!=(n=e[o])&&n<i&&(i=n)}else{for(;++o<r;)if(null!=(n=t.call(e,e[o],o))&&n<=n){i=n;break}for(;++o<r;)null!=(n=t.call(e,e[o],o))&&n<i&&(i=n)}return i},M.max=function(e,t){var i,n,o=-1,r=e.length;if(1===arguments.length){for(;++o<r;)if(null!=(n=e[o])&&n<=n){i=n;break}for(;++o<r;)null!=(n=e[o])&&i<n&&(i=n)}else{for(;++o<r;)if(null!=(n=t.call(e,e[o],o))&&n<=n){i=n;break}for(;++o<r;)null!=(n=t.call(e,e[o],o))&&i<n&&(i=n)}return i},M.extent=function(e,t){var i,n,o,r=-1,a=e.length;if(1===arguments.length){for(;++r<a;)if(null!=(n=e[r])&&n<=n){i=o=n;break}for(;++r<a;)null!=(n=e[r])&&(n<i&&(i=n),o<n&&(o=n))}else{for(;++r<a;)if(null!=(n=t.call(e,e[r],r))&&n<=n){i=o=n;break}for(;++r<a;)null!=(n=t.call(e,e[r],r))&&(n<i&&(i=n),o<n&&(o=n))}return[i,o]},M.sum=function(e,t){var i,n=0,o=e.length,r=-1;if(1===arguments.length)for(;++r<o;)u(i=+e[r])&&(n+=i);else for(;++r<o;)u(i=+t.call(e,e[r],r))&&(n+=i);return n},M.mean=function(e,t){var i,n=0,o=e.length,r=-1,a=o;if(1===arguments.length)for(;++r<o;)u(i=c(e[r]))?n+=i:--a;else for(;++r<o;)u(i=c(t.call(e,e[r],r)))?n+=i:--a;if(a)return n/a},M.quantile=function(e,t){var i=(e.length-1)*t+1,n=Math.floor(i),o=+e[n-1],r=i-n;return r?o+r*(e[n]-o):o},M.median=function(e,t){var i,n=[],o=e.length,r=-1;if(1===arguments.length)for(;++r<o;)u(i=c(e[r]))&&n.push(i);else for(;++r<o;)u(i=c(t.call(e,e[r],r)))&&n.push(i);if(n.length)return M.quantile(n.sort(l),.5)},M.variance=function(e,t){var i,n,o=e.length,r=0,a=0,s=-1,l=0;if(1===arguments.length)for(;++s<o;)u(i=c(e[s]))&&(a+=(n=i-r)*(i-(r+=n/++l)));else for(;++s<o;)u(i=c(t.call(e,e[s],s)))&&(a+=(n=i-r)*(i-(r+=n/++l)));if(1<l)return a/(l-1)},M.deviation=function(){var e=M.variance.apply(this,arguments);return e?Math.sqrt(e):e};var h=e(l);function p(e){return e.length}M.bisectLeft=h.left,M.bisect=M.bisectRight=h.right,M.bisector=function(i){return e(1===i.length?function(e,t){return l(i(e),t)}:i)},M.shuffle=function(e,t,i){(r=arguments.length)<3&&(i=e.length,r<2&&(t=0));for(var n,o,r=i-t;r;)o=Math.random()*r--|0,n=e[r+t],e[r+t]=e[o+t],e[o+t]=n;return e},M.permute=function(e,t){for(var i=t.length,n=new Array(i);i--;)n[i]=e[t[i]];return n},M.pairs=function(e){for(var t=0,i=e.length-1,n=e[0],o=new Array(i<0?0:i);t<i;)o[t]=[n,n=e[++t]];return o},M.zip=function(){if(!(n=arguments.length))return[];for(var e=-1,t=M.min(arguments,p),i=new Array(t);++e<t;)for(var n,o=-1,r=i[e]=new Array(n);++o<n;)r[o]=arguments[o][e];return i},M.transpose=function(e){return M.zip.apply(M,e)},M.keys=function(e){var t=[];for(var i in e)t.push(i);return t},M.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},M.entries=function(e){var t=[];for(var i in e)t.push({key:i,value:e[i]});return t},M.merge=function(e){for(var t,i,n,o=e.length,r=-1,a=0;++r<o;)a+=e[r].length;for(i=new Array(a);0<=--o;)for(t=(n=e[o]).length;0<=--t;)i[--a]=n[t];return i};var F=Math.abs;function f(e,t){for(var i in t)Object.defineProperty(e.prototype,i,{value:t[i],enumerable:!1})}function y(){this._=Object.create(null)}M.range=function(e,t,i){if(arguments.length<3&&(i=1,arguments.length<2&&(t=e,e=0)),(t-e)/i==1/0)throw new Error("infinite range");var n,o=[],r=function(e){var t=1;for(;e*t%1;)t*=10;return t}(F(i)),a=-1;if(e*=r,t*=r,(i*=r)<0)for(;(n=e+i*++a)>t;)o.push(n/r);else for(;(n=e+i*++a)<t;)o.push(n/r);return o},M.map=function(e,t){var i=new y;if(e instanceof y)e.forEach(function(e,t){i.set(e,t)});else if(Array.isArray(e)){var n,o=-1,r=e.length;if(1===arguments.length)for(;++o<r;)i.set(o,e[o]);else for(;++o<r;)i.set(t.call(e,n=e[o],o),n)}else for(var a in e)i.set(a,e[a]);return i};var g="__proto__",m="\0";function v(e){return(e+="")===g||e[0]===m?m+e:e}function w(e){return(e+="")[0]===m?e.slice(1):e}function C(e){return v(e)in this._}function _(e){return(e=v(e))in this._&&delete this._[e]}function A(){var e=[];for(var t in this._)e.push(w(t));return e}function E(){var e=0;for(var t in this._)++e;return e}function x(){for(var e in this._)return!1;return!0}function S(){this._=Object.create(null)}function I(e){return e}function T(t,i,n){return function(){var e=n.apply(i,arguments);return e===i?t:e}}function D(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var i=0,n=k.length;i<n;++i){var o=k[i]+t;if(o in e)return o}}f(y,{has:C,get:function(e){return this._[v(e)]},set:function(e,t){return this._[v(e)]=t},remove:_,keys:A,values:function(){var e=[];for(var t in this._)e.push(this._[t]);return e},entries:function(){var e=[];for(var t in this._)e.push({key:w(t),value:this._[t]});return e},size:E,empty:x,forEach:function(e){for(var t in this._)e.call(this,w(t),this._[t])}}),M.nest=function(){var d,h,p={},f=[],t=[];function g(i,e,n){if(n>=f.length)return h?h.call(p,e):d?e.sort(d):e;for(var t,o,r,a,s=-1,l=e.length,c=f[n++],u=new y;++s<l;)(a=u.get(t=c(o=e[s])))?a.push(o):u.set(t,[o]);return r=i?(o=i(),function(e,t){o.set(e,g(i,t,n))}):(o={},function(e,t){o[e]=g(i,t,n)}),u.forEach(r),o}return p.map=function(e,t){return g(t,e,0)},p.entries=function(e){return function i(e,n){if(n>=f.length)return e;var o=[],r=t[n++];return e.forEach(function(e,t){o.push({key:e,values:i(t,n)})}),r?o.sort(function(e,t){return r(e.key,t.key)}):o}(g(M.map,e,0),0)},p.key=function(e){return f.push(e),p},p.sortKeys=function(e){return t[f.length-1]=e,p},p.sortValues=function(e){return d=e,p},p.rollup=function(e){return h=e,p},p},M.set=function(e){var t=new S;if(e)for(var i=0,n=e.length;i<n;++i)t.add(e[i]);return t},f(S,{has:C,add:function(e){return this._[v(e+="")]=!0,e},remove:_,values:A,size:E,empty:x,forEach:function(e){for(var t in this._)e.call(this,w(t))}}),M.behavior={},M.rebind=function(e,t){for(var i,n=1,o=arguments.length;++n<o;)e[i=arguments[n]]=T(e,t,t[i]);return e};var k=["webkit","ms","moz","Moz","o","O"];function R(){}function O(){}function N(o){var r=[],a=new y;function e(){for(var e,t=r,i=-1,n=t.length;++i<n;)(e=t[i].on)&&e.apply(this,arguments);return o}return e.on=function(e,t){var i,n=a.get(e);return arguments.length<2?n&&n.on:(n&&(n.on=null,r=r.slice(0,i=r.indexOf(n)).concat(r.slice(i+1)),a.remove(e)),t&&r.push(a.set(e,{on:t})),o)},e}function L(){M.event.preventDefault()}function G(){for(var e,t=M.event;e=t.sourceEvent;)t=e;return t}function $(o){for(var r=new O,e=0,t=arguments.length;++e<t;)r[arguments[e]]=N(r);return r.of=function(i,n){return function(e){try{var t=e.sourceEvent=M.event;e.target=o,M.event=e,r[e.type].apply(i,n)}finally{M.event=t}}},r}M.dispatch=function(){for(var e=new O,t=-1,i=arguments.length;++t<i;)e[arguments[t]]=N(e);return e},O.prototype.on=function(e,t){var i=e.indexOf("."),n="";if(0<=i&&(n=e.slice(i+1),e=e.slice(0,i)),e)return arguments.length<2?this[e].on(n):this[e].on(n,t);if(2===arguments.length){if(null==t)for(e in this)this.hasOwnProperty(e)&&this[e].on(n,null);return this}},M.event=null,M.requote=function(e){return e.replace(B,"\\$&")};var B=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,j={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)e[i]=t[i]};function W(e){return j(e,U),e}var H=function(e,t){return t.querySelector(e)},z=function(e,t){return t.querySelectorAll(e)},V=function(e,t){var i=e.matches||e[D(e,"matchesSelector")];return(V=function(e,t){return i.call(e,t)})(e,t)};"function"==typeof Sizzle&&(H=function(e,t){return Sizzle(e,t)[0]||null},z=Sizzle,V=Sizzle.matchesSelector),M.selection=function(){return M.select(b.documentElement)};var U=M.selection.prototype=[];function Y(e){return"function"==typeof e?e:function(){return H(e,this)}}function q(e){return"function"==typeof e?e:function(){return z(e,this)}}U.select=function(e){var t,i,n,o,r=[];e=Y(e);for(var a=-1,s=this.length;++a<s;){r.push(t=[]),t.parentNode=(n=this[a]).parentNode;for(var l=-1,c=n.length;++l<c;)(o=n[l])?(t.push(i=e.call(o,o.__data__,l,a)),i&&"__data__"in o&&(i.__data__=o.__data__)):t.push(null)}return W(r)},U.selectAll=function(e){var t,i,n=[];e=q(e);for(var o=-1,r=this.length;++o<r;)for(var a=this[o],s=-1,l=a.length;++s<l;)(i=a[s])&&(n.push(t=d(e.call(i,i.__data__,s,o))),t.parentNode=i);return W(n)};var Q={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function K(t,i){return t=M.ns.qualify(t),null==i?t.local?function(){this.removeAttributeNS(t.space,t.local)}:function(){this.removeAttribute(t)}:"function"==typeof i?t.local?function(){var e=i.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}:function(){var e=i.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}:t.local?function(){this.setAttributeNS(t.space,t.local,i)}:function(){this.setAttribute(t,i)}}function X(e){return e.trim().replace(/\s+/g," ")}function J(e){return new RegExp("(?:^|\\s+)"+M.requote(e)+"(?:\\s+|$)","g")}function Z(e){return(e+"").trim().split(/^|\s+/)}function ee(i,n){var o=(i=Z(i).map(te)).length;return"function"==typeof n?function(){for(var e=-1,t=n.apply(this,arguments);++e<o;)i[e](this,t)}:function(){for(var e=-1;++e<o;)i[e](this,n)}}function te(n){var o=J(n);return function(e,t){if(i=e.classList)return t?i.add(n):i.remove(n);var i=e.getAttribute("class")||"";t?(o.lastIndex=0,o.test(i)||e.setAttribute("class",X(i+" "+n))):e.setAttribute("class",X(i.replace(o," ")))}}function ie(t,i,n){return null==i?function(){this.style.removeProperty(t)}:"function"==typeof i?function(){var e=i.apply(this,arguments);null==e?this.style.removeProperty(t):this.style.setProperty(t,e,n)}:function(){this.style.setProperty(t,i,n)}}function ne(t,i){return null==i?function(){delete this[t]}:"function"==typeof i?function(){var e=i.apply(this,arguments);null==e?delete this[t]:this[t]=e}:function(){this[t]=i}}function oe(i){return"function"==typeof i?i:(i=M.ns.qualify(i)).local?function(){return this.ownerDocument.createElementNS(i.space,i.local)}:function(){var e=this.ownerDocument,t=this.namespaceURI;return t?e.createElementNS(t,i):e.createElement(i)}}function re(){var e=this.parentNode;e&&e.removeChild(this)}function ae(e){return{__data__:e}}function se(e){return function(){return V(this,e)}}function le(e,t){for(var i=0,n=e.length;i<n;i++)for(var o,r=e[i],a=0,s=r.length;a<s;a++)(o=r[a])&&t(o,a,i);return e}function ce(e){return j(e,ue),e}M.ns={prefix:Q,qualify:function(e){var t=e.indexOf(":"),i=e;return 0<=t&&(i=e.slice(0,t),e=e.slice(t+1)),Q.hasOwnProperty(i)?{space:Q[i],local:e}:e}},U.attr=function(e,t){if(arguments.length<2){if("string"==typeof e){var i=this.node();return(e=M.ns.qualify(e)).local?i.getAttributeNS(e.space,e.local):i.getAttribute(e)}for(t in e)this.each(K(t,e[t]));return this}return this.each(K(e,t))},U.classed=function(e,t){if(arguments.length<2){if("string"==typeof e){var i=this.node(),n=(e=Z(e)).length,o=-1;if(t=i.classList){for(;++o<n;)if(!t.contains(e[o]))return!1}else for(t=i.getAttribute("class");++o<n;)if(!J(e[o]).test(t))return!1;return!0}for(t in e)this.each(ee(t,e[t]));return this}return this.each(ee(e,t))},U.style=function(e,t,i){var n=arguments.length;if(n<3){if("string"!=typeof e){for(i in n<2&&(t=""),e)this.each(ie(i,e[i],t));return this}if(n<2){var o=this.node();return P(o).getComputedStyle(o,null).getPropertyValue(e)}i=""}return this.each(ie(e,t,i))},U.property=function(e,t){if(arguments.length<2){if("string"==typeof e)return this.node()[e];for(t in e)this.each(ne(t,e[t]));return this}return this.each(ne(e,t))},U.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},U.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},U.append=function(e){return e=oe(e),this.select(function(){return this.appendChild(e.apply(this,arguments))})},U.insert=function(e,t){return e=oe(e),t=Y(t),this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)})},U.remove=function(){return this.each(re)},U.data=function(e,f){var t,i,n=-1,o=this.length;if(!arguments.length){for(e=new Array(o=(t=this[0]).length);++n<o;)(i=t[n])&&(e[n]=i.__data__);return e}function r(e,t){var i,n,o,r=e.length,a=t.length,s=Math.min(r,a),l=new Array(a),c=new Array(a),u=new Array(r);if(f){var d,h=new y,p=new Array(r);for(i=-1;++i<r;)h.has(d=f.call(n=e[i],n.__data__,i))?u[i]=n:h.set(d,n),p[i]=d;for(i=-1;++i<a;)(n=h.get(d=f.call(t,o=t[i],i)))?!0!==n&&((l[i]=n).__data__=o):c[i]=ae(o),h.set(d,!0);for(i=-1;++i<r;)!0!==h.get(p[i])&&(u[i]=e[i])}else{for(i=-1;++i<s;)n=e[i],o=t[i],n?(n.__data__=o,l[i]=n):c[i]=ae(o);for(;i<a;++i)c[i]=ae(t[i]);for(;i<r;++i)u[i]=e[i]}c.update=l,c.parentNode=l.parentNode=u.parentNode=e.parentNode,g.push(c),m.push(l),v.push(u)}var g=ce([]),m=W([]),v=W([]);if("function"==typeof e)for(;++n<o;)r(t=this[n],e.call(t,t.parentNode.__data__,n));else for(;++n<o;)r(t=this[n],e);return m.enter=function(){return g},m.exit=function(){return v},m},U.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")},U.filter=function(e){var t,i,n,o=[];"function"!=typeof e&&(e=se(e));for(var r=0,a=this.length;r<a;r++){o.push(t=[]),t.parentNode=(i=this[r]).parentNode;for(var s=0,l=i.length;s<l;s++)(n=i[s])&&e.call(n,n.__data__,s,r)&&t.push(n)}return W(o)},U.order=function(){for(var e=-1,t=this.length;++e<t;)for(var i,n=this[e],o=n.length-1,r=n[o];0<=--o;)(i=n[o])&&(r&&r!==i.nextSibling&&r.parentNode.insertBefore(i,r),r=i);return this},U.sort=function(e){e=function(i){arguments.length||(i=l);return function(e,t){return e&&t?i(e.__data__,t.__data__):!e-!t}}.apply(this,arguments);for(var t=-1,i=this.length;++t<i;)this[t].sort(e);return this.order()},U.each=function(n){return le(this,function(e,t,i){n.call(e,e.__data__,t,i)})},U.call=function(e){var t=d(arguments);return e.apply(t[0]=this,t),this},U.empty=function(){return!this.node()},U.node=function(){for(var e=0,t=this.length;e<t;e++)for(var i=this[e],n=0,o=i.length;n<o;n++){var r=i[n];if(r)return r}return null},U.size=function(){var e=0;return le(this,function(){++e}),e};var ue=[];function de(o,t,i){var n="__on"+o,e=o.indexOf("."),r=pe;0<e&&(o=o.slice(0,e));var a=he.get(o);function s(){var e=this[n];e&&(this.removeEventListener(o,e,e.$),delete this[n])}return a&&(o=a,r=fe),e?t?function(){var e=r(t,d(arguments));s.call(this),this.addEventListener(o,this[n]=e,e.$=i),e._=t}:s:t?R:function(){var e,t=new RegExp("^__on([^.]+)"+M.requote(o)+"$");for(var i in this)if(e=i.match(t)){var n=this[i];this.removeEventListener(e[1],n,n.$),delete this[i]}}}M.selection.enter=ce,(M.selection.enter.prototype=ue).append=U.append,ue.empty=U.empty,ue.node=U.node,ue.call=U.call,ue.size=U.size,ue.select=function(e){for(var t,i,n,o,r,a=[],s=-1,l=this.length;++s<l;){n=(o=this[s]).update,a.push(t=[]),t.parentNode=o.parentNode;for(var c=-1,u=o.length;++c<u;)(r=o[c])?(t.push(n[c]=i=e.call(o.parentNode,r.__data__,c,s)),i.__data__=r.__data__):t.push(null)}return W(a)},ue.insert=function(e,t){return arguments.length<2&&(t=function(a){var s,l;return function(e,t,i){var n,o=a[i].update,r=o.length;for(i!=l&&(l=i,s=0),s<=t&&(s=t+1);!(n=o[s])&&++s<r;);return n}}(this)),U.insert.call(this,e,t)},M.select=function(e){var t;return"string"==typeof e?(t=[H(e,b)]).parentNode=b.documentElement:(t=[e]).parentNode=s(e),W([t])},M.selectAll=function(e){var t;return"string"==typeof e?(t=d(z(e,b))).parentNode=b.documentElement:(t=e).parentNode=null,W([t])},U.on=function(e,t,i){var n=arguments.length;if(n<3){if("string"!=typeof e){for(i in n<2&&(t=!1),e)this.each(de(i,e[i],t));return this}if(n<2)return(n=this.node()["__on"+e])&&n._;i=!1}return this.each(de(e,t,i))};var he=M.map({mouseenter:"mouseover",mouseleave:"mouseout"});function pe(i,n){return function(e){var t=M.event;M.event=e,n[0]=this.__data__;try{i.apply(this,n)}finally{M.event=t}}}function fe(e,t){var i=pe(e,t);return function(e){var t=e.relatedTarget;t&&(t===this||8&t.compareDocumentPosition(this))||i.call(this,e)}}b&&he.forEach(function(e){"on"+e in b&&he.remove(e)});var ge,me=0;function ve(e){var i=".dragsuppress-"+ ++me,n="click"+i,o=M.select(P(e)).on("touchmove"+i,L).on("dragstart"+i,L).on("selectstart"+i,L);if(null==ge&&(ge=!("onselectstart"in e)&&D(e.style,"userSelect")),ge){var r=s(e).style,a=r[ge];r[ge]="none"}return function(e){if(o.on(i,null),ge&&(r[ge]=a),e){function t(){o.on(n,null)}o.on(n,function(){L(),t()},!0),setTimeout(t,0)}}}M.mouse=function(e){return be(e,G())};var ye=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function be(e,t){t.changedTouches&&(t=t.changedTouches[0]);var i=e.ownerSVGElement||e;if(i.createSVGPoint){var n=i.createSVGPoint();if(ye<0){var o=P(e);if(o.scrollX||o.scrollY){var r=(i=M.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();ye=!(r.f||r.e),i.remove()}}return ye?(n.x=t.pageX,n.y=t.pageY):(n.x=t.clientX,n.y=t.clientY),[(n=n.matrixTransform(e.getScreenCTM().inverse())).x,n.y]}var a=e.getBoundingClientRect();return[t.clientX-a.left-e.clientLeft,t.clientY-a.top-e.clientTop]}function we(){return M.event.changedTouches[0].identifier}M.touch=function(e,t,i){if(arguments.length<3&&(i=t,t=G().changedTouches),t)for(var n,o=0,r=t.length;o<r;++o)if((n=t[o]).identifier===i)return be(e,n)},M.behavior.drag=function(){var g=$(i,"drag","dragstart","dragend"),m=null,e=n(R,M.mouse,P,"mousemove","mouseup"),t=n(we,M.touch,I,"touchmove","touchend");function i(){this.on("mousedown.drag",e).on("touchstart.drag",t)}function n(u,d,h,p,f){return function(){var n,e=M.event.target,o=this.parentNode,r=g.of(this,arguments),a=0,s=u(),t=".drag"+(null==s?"":"-"+s),i=M.select(h(e)).on(p+t,function(){var e,t,i=d(o,s);if(!i)return;e=i[0]-c[0],t=i[1]-c[1],a|=e|t,r({type:"drag",x:(c=i)[0]+n[0],y:i[1]+n[1],dx:e,dy:t})}).on(f+t,function(){if(!d(o,s))return;i.on(p+t,null).on(f+t,null),l(a&&M.event.target===e),r({type:"dragend"})}),l=ve(e),c=d(o,s);n=m?[(n=m.apply(this,arguments)).x-c[0],n.y-c[1]]:[0,0],r({type:"dragstart"})}}return i.origin=function(e){return arguments.length?(m=e,i):m},M.rebind(i,g,"on")},M.touches=function(i,e){return arguments.length<2&&(e=G().touches),e?d(e).map(function(e){var t=be(i,e);return t.identifier=e.identifier,t}):[]};var Ce=1e-6,_e=Ce*Ce,Ae=Math.PI,Ee=2*Ae,xe=Ee-Ce,Se=Ae/2,Te=Ae/180,De=180/Ae;function ke(e){return 0<e?1:e<0?-1:0}function Re(e,t,i){return(t[0]-e[0])*(i[1]-e[1])-(t[1]-e[1])*(i[0]-e[0])}function Oe(e){return 1<e?0:e<-1?Ae:Math.acos(e)}function Ne(e){return 1<e?Se:e<-1?-Se:Math.asin(e)}function Fe(e){return((e=Math.exp(e))+1/e)/2}function Me(e){return(e=Math.sin(e/2))*e}var Pe=Math.SQRT2;M.interpolateZoom=function(e,t){var o=e[0],r=e[1],a=e[2],i=t[0],n=t[1],s=t[2],l=i-o,c=n-r,u=l*l+c*c,d=Math.sqrt(u),h=(s*s-a*a+4*u)/(2*a*2*d),p=(s*s-a*a-4*u)/(2*s*2*d),f=Math.log(Math.sqrt(h*h+1)-h),g=Math.log(Math.sqrt(p*p+1)-p)-f,m=(g||Math.log(s/a))/Pe;function v(e){var t=e*m;if(g){var i=Fe(f),n=a/(2*d)*(i*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(Pe*t+f)-function(e){return((e=Math.exp(e))-1/e)/2}(f));return[o+n*l,r+n*c,a*i/Fe(Pe*t+f)]}return[o+e*l,r+e*c,a*Math.exp(Pe*t)]}return v.duration=1e3*m,v},M.behavior.zoom=function(){var t,l,i,n,w,o,r,a,s,C={x:0,y:0,k:1},c=[960,500],u=Ge,d=250,h=0,_="mousedown.zoom",p="mousemove.zoom",f="mouseup.zoom",A="touchstart.zoom",E=$(g,"zoomstart","zoom","zoomend");function g(e){e.on(_,N).on(Le+".zoom",v).on("dblclick.zoom",y).on(A,F)}function x(e){return[(e[0]-C.x)/C.k,(e[1]-C.y)/C.k]}function S(e){C.k=Math.max(u[0],Math.min(u[1],e))}function T(e,t){t=function(e){return[e[0]*C.k+C.x,e[1]*C.k+C.y]}(t),C.x+=e[0]-t[0],C.y+=e[1]-t[1]}function D(e,t,i,n){e.__chart__={x:C.x,y:C.y,k:C.k},S(Math.pow(2,n)),T(l=t,i),e=M.select(e),0<d&&(e=e.transition().duration(d)),e.call(g.event)}function m(){r&&r.domain(o.range().map(function(e){return(e-C.x)/C.k}).map(o.invert)),s&&s.domain(a.range().map(function(e){return(e-C.y)/C.k}).map(a.invert))}function k(e){h++||e({type:"zoomstart"})}function R(e){m(),e({type:"zoom",scale:C.k,translate:[C.x,C.y]})}function O(e){--h||e({type:"zoomend"}),l=null}function N(){var e=this,t=M.event.target,i=E.of(e,arguments),n=0,o=M.select(P(e)).on(p,function(){n=1,T(M.mouse(e),r),R(i)}).on(f,function(){o.on(p,null).on(f,null),a(n&&M.event.target===t),O(i)}),r=x(M.mouse(e)),a=ve(e);Ds.call(e),k(i)}function F(){var c,u=this,d=E.of(u,arguments),h={},p=0,o=".zoom-"+M.event.changedTouches[0].identifier,f="touchmove"+o,g="touchend"+o,m=[],r=M.select(u),a=ve(u);function v(){var e=M.touches(u);return c=C.k,e.forEach(function(e){e.identifier in h&&(h[e.identifier]=x(e))}),e}function e(){var e=M.event.target;M.select(e).on(f,y).on(g,b),m.push(e);for(var t=M.event.changedTouches,i=0,n=t.length;i<n;++i)h[t[i].identifier]=null;var o=v(),r=Date.now();if(1===o.length){if(r-w<500){var a=o[0];D(u,a,h[a.identifier],Math.floor(Math.log(C.k)/Math.LN2)+1),L()}w=r}else if(1<o.length){a=o[0];var s=o[1],l=a[0]-s[0],c=a[1]-s[1];p=l*l+c*c}}function y(){var e,t,i,n,o=M.touches(u);Ds.call(u);for(var r=0,a=o.length;r<a;++r,n=null)if(i=o[r],n=h[i.identifier]){if(t)break;e=i,t=n}if(n){var s=(s=i[0]-e[0])*s+(s=i[1]-e[1])*s,l=p&&Math.sqrt(s/p);e=[(e[0]+i[0])/2,(e[1]+i[1])/2],t=[(t[0]+n[0])/2,(t[1]+n[1])/2],S(l*c)}w=null,T(e,t),R(d)}function b(){if(M.event.touches.length){for(var e=M.event.changedTouches,t=0,i=e.length;t<i;++t)delete h[e[t].identifier];for(var n in h)return void v()}M.selectAll(m).on(o,null),r.on(_,N).on(A,F),a(),O(d)}e(),k(d),r.on(_,null).on(A,e)}function v(){var e=E.of(this,arguments);n?clearTimeout(n):(t=x(l=i||M.mouse(this)),Ds.call(this),k(e)),n=setTimeout(function(){n=null,O(e)},50),L(),S(Math.pow(2,.002*Ie())*C.k),T(l,t),R(e)}function y(){var e=M.mouse(this),t=Math.log(C.k)/Math.LN2;D(this,e,x(e),M.event.shiftKey?Math.ceil(t)-1:Math.floor(t)+1)}return Le=Le||("onwheel"in b?(Ie=function(){return-M.event.deltaY*(M.event.deltaMode?120:1)},"wheel"):"onmousewheel"in b?(Ie=function(){return M.event.wheelDelta},"mousewheel"):(Ie=function(){return-M.event.detail},"MozMousePixelScroll")),g.event=function(e){e.each(function(){var s=E.of(this,arguments),t=C;Os?M.select(this).transition().each("start.zoom",function(){C=this.__chart__||{x:0,y:0,k:1},k(s)}).tween("zoom:zoom",function(){var n=c[0],e=c[1],o=l?l[0]:n/2,r=l?l[1]:e/2,a=M.interpolateZoom([(o-C.x)/C.k,(r-C.y)/C.k,n/C.k],[(o-t.x)/t.k,(r-t.y)/t.k,n/t.k]);return function(e){var t=a(e),i=n/t[2];this.__chart__=C={x:o-t[0]*i,y:r-t[1]*i,k:i},R(s)}}).each("interrupt.zoom",function(){O(s)}).each("end.zoom",function(){O(s)}):(this.__chart__=C,k(s),R(s),O(s))})},g.translate=function(e){return arguments.length?(C={x:+e[0],y:+e[1],k:C.k},m(),g):[C.x,C.y]},g.scale=function(e){return arguments.length?(C={x:C.x,y:C.y,k:+e},m(),g):C.k},g.scaleExtent=function(e){return arguments.length?(u=null==e?Ge:[+e[0],+e[1]],g):u},g.center=function(e){return arguments.length?(i=e&&[+e[0],+e[1]],g):i},g.size=function(e){return arguments.length?(c=e&&[+e[0],+e[1]],g):c},g.duration=function(e){return arguments.length?(d=+e,g):d},g.x=function(e){return arguments.length?(o=(r=e).copy(),C={x:0,y:0,k:1},g):r},g.y=function(e){return arguments.length?(a=(s=e).copy(),C={x:0,y:0,k:1},g):s},M.rebind(g,E,"on")};var Ie,Le,Ge=[0,1/0];function $e(){}function Be(e,t,i){return this instanceof Be?(this.h=+e,this.s=+t,void(this.l=+i)):arguments.length<2?e instanceof Be?new Be(e.h,e.s,e.l):lt(""+e,ct,Be):new Be(e,t,i)}(M.color=$e).prototype.toString=function(){return this.rgb()+""};var je=(M.hsl=Be).prototype=new $e;function We(e,t,i){var n,o;function r(e){return Math.round(255*function(e){return 360<e?e-=360:e<0&&(e+=360),e<60?n+(o-n)*e/60:e<180?o:e<240?n+(o-n)*(240-e)/60:n}(e))}return e=isNaN(e)?0:(e%=360)<0?e+360:e,t=isNaN(t)?0:t<0?0:1<t?1:t,n=2*(i=i<0?0:1<i?1:i)-(o=i<=.5?i*(1+t):i+t-i*t),new nt(r(e+120),r(e),r(e-120))}function He(e,t,i){return this instanceof He?(this.h=+e,this.c=+t,void(this.l=+i)):arguments.length<2?e instanceof He?new He(e.h,e.c,e.l):Ze(e instanceof Ue?e.l:(e=ut((e=M.rgb(e)).r,e.g,e.b)).l,e.a,e.b):new He(e,t,i)}je.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),new Be(this.h,this.s,this.l/e)},je.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),new Be(this.h,this.s,e*this.l)},je.rgb=function(){return We(this.h,this.s,this.l)};var ze=(M.hcl=He).prototype=new $e;function Ve(e,t,i){return isNaN(e)&&(e=0),isNaN(t)&&(t=0),new Ue(i,Math.cos(e*=Te)*t,Math.sin(e)*t)}function Ue(e,t,i){return this instanceof Ue?(this.l=+e,this.a=+t,void(this.b=+i)):arguments.length<2?e instanceof Ue?new Ue(e.l,e.a,e.b):e instanceof He?Ve(e.h,e.c,e.l):ut((e=nt(e)).r,e.g,e.b):new Ue(e,t,i)}ze.brighter=function(e){return new He(this.h,this.c,Math.min(100,this.l+Ye*(arguments.length?e:1)))},ze.darker=function(e){return new He(this.h,this.c,Math.max(0,this.l-Ye*(arguments.length?e:1)))},ze.rgb=function(){return Ve(this.h,this.c,this.l).rgb()},M.lab=Ue;var Ye=18,qe=.95047,Qe=1,Ke=1.08883,Xe=Ue.prototype=new $e;function Je(e,t,i){var n=(e+16)/116,o=n+t/500,r=n-i/200;return new nt(it(3.2404542*(o=et(o)*qe)-1.5371385*(n=et(n)*Qe)-.4985314*(r=et(r)*Ke)),it(-.969266*o+1.8760108*n+.041556*r),it(.0556434*o-.2040259*n+1.0572252*r))}function Ze(e,t,i){return 0<e?new He(Math.atan2(i,t)*De,Math.sqrt(t*t+i*i),e):new He(NaN,NaN,e)}function et(e){return.206893034<e?e*e*e:(e-4/29)/7.787037}function tt(e){return.008856<e?Math.pow(e,1/3):7.787037*e+4/29}function it(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}function nt(e,t,i){return this instanceof nt?(this.r=~~e,this.g=~~t,void(this.b=~~i)):arguments.length<2?e instanceof nt?new nt(e.r,e.g,e.b):lt(""+e,nt,We):new nt(e,t,i)}function ot(e){return new nt(e>>16,e>>8&255,255&e)}function rt(e){return ot(e)+""}Xe.brighter=function(e){return new Ue(Math.min(100,this.l+Ye*(arguments.length?e:1)),this.a,this.b)},Xe.darker=function(e){return new Ue(Math.max(0,this.l-Ye*(arguments.length?e:1)),this.a,this.b)},Xe.rgb=function(){return Je(this.l,this.a,this.b)};var at=(M.rgb=nt).prototype=new $e;function st(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function lt(e,t,i){var n,o,r,a=0,s=0,l=0;if(n=/([a-z]+)\((.*)\)/i.exec(e))switch(o=n[2].split(","),n[1]){case"hsl":return i(parseFloat(o[0]),parseFloat(o[1])/100,parseFloat(o[2])/100);case"rgb":return t(ht(o[0]),ht(o[1]),ht(o[2]))}return(r=pt.get(e.toLowerCase()))?t(r.r,r.g,r.b):(null==e||"#"!==e.charAt(0)||isNaN(r=parseInt(e.slice(1),16))||(4===e.length?(a=(3840&r)>>4,a|=a>>4,s=240&r,s|=s>>4,l=15&r,l|=l<<4):7===e.length&&(a=(16711680&r)>>16,s=(65280&r)>>8,l=255&r)),t(a,s,l))}function ct(e,t,i){var n,o,r=Math.min(e/=255,t/=255,i/=255),a=Math.max(e,t,i),s=a-r,l=(a+r)/2;return s?(o=l<.5?s/(a+r):s/(2-a-r),n=e==a?(t-i)/s+(t<i?6:0):t==a?(i-e)/s+2:(e-t)/s+4,n*=60):(n=NaN,o=0<l&&l<1?0:n),new Be(n,o,l)}function ut(e,t,i){var n=tt((.4124564*(e=dt(e))+.3575761*(t=dt(t))+.1804375*(i=dt(i)))/qe),o=tt((.2126729*e+.7151522*t+.072175*i)/Qe);return Ue(116*o-16,500*(n-o),200*(o-tt((.0193339*e+.119192*t+.9503041*i)/Ke)))}function dt(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ht(e){var t=parseFloat(e);return"%"===e.charAt(e.length-1)?Math.round(2.55*t):t}at.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,i=this.g,n=this.b;return t||i||n?(t&&t<30&&(t=30),i&&i<30&&(i=30),n&&n<30&&(n=30),new nt(Math.min(255,t/e),Math.min(255,i/e),Math.min(255,n/e))):new nt(30,30,30)},at.darker=function(e){return new nt((e=Math.pow(.7,arguments.length?e:1))*this.r,e*this.g,e*this.b)},at.hsl=function(){return ct(this.r,this.g,this.b)},at.toString=function(){return"#"+st(this.r)+st(this.g)+st(this.b)};var pt=M.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function ft(e){return"function"==typeof e?e:function(){return e}}function gt(n){return function(e,t,i){return 2===arguments.length&&"function"==typeof t&&(i=t,t=null),mt(e,t,n,i)}}function mt(o,r,i,e){var a={},s=M.dispatch("beforesend","progress","load","error"),l={},c=new XMLHttpRequest,u=null;function t(){var e,t=c.status;if(!t&&function(e){var t=e.responseType;return t&&"text"!==t?e.response:e.responseText}(c)||200<=t&&t<300||304===t){try{e=i.call(a,c)}catch(e){return void s.error.call(a,e)}s.load.call(a,e)}else s.error.call(a,c)}return!this.XDomainRequest||"withCredentials"in c||!/^(http(s)?:)?\/\//.test(o)||(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=t:c.onreadystatechange=function(){3<c.readyState&&t()},c.onprogress=function(e){var t=M.event;M.event=e;try{s.progress.call(a,c)}finally{M.event=t}},a.header=function(e,t){return e=(e+"").toLowerCase(),arguments.length<2?l[e]:(null==t?delete l[e]:l[e]=t+"",a)},a.mimeType=function(e){return arguments.length?(r=null==e?null:e+"",a):r},a.responseType=function(e){return arguments.length?(u=e,a):u},a.response=function(e){return i=e,a},["get","post"].forEach(function(e){a[e]=function(){return a.send.apply(a,[e].concat(d(arguments)))}}),a.send=function(e,t,i){if(2===arguments.length&&"function"==typeof t&&(i=t,t=null),c.open(e,o,!0),null==r||"accept"in l||(l.accept=r+",*/*"),c.setRequestHeader)for(var n in l)c.setRequestHeader(n,l[n]);return null!=r&&c.overrideMimeType&&c.overrideMimeType(r),null!=u&&(c.responseType=u),null!=i&&a.on("error",i).on("load",function(e){i(null,e)}),s.beforesend.call(a,c),c.send(null==t?null:t),a},a.abort=function(){return c.abort(),a},M.rebind(a,s,"on"),null==e?a:a.get(function(i){return 1===i.length?function(e,t){i(null==e?t:null)}:i}(e))}pt.forEach(function(e,t){pt.set(e,ot(t))}),M.functor=ft,M.xhr=gt(I),M.dsv=function(o,r){var t=new RegExp('["'+o+"\n]"),h=o.charCodeAt(0);function a(e,t,i){arguments.length<3&&(i=t,t=null);var n=mt(e,r,null==t?s:l(t),i);return n.row=function(e){return arguments.length?n.response(null==(t=e)?s:l(e)):t},n}function s(e){return a.parse(e.responseText)}function l(t){return function(e){return a.parse(e.responseText,t)}}function i(e){return e.map(c).join(o)}function c(e){return t.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}return a.parse=function(e,n){var o;return a.parseRows(e,function(e,t){if(o)return o(e,t-1);var i=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");o=n?function(e,t){return n(i(e),t)}:i})},a.parseRows=function(o,e){var t,r,a={},s={},i=[],l=o.length,c=0,n=0;function u(){if(l<=c)return s;if(r)return r=!1,a;var e=c;if(34===o.charCodeAt(e)){for(var t=e;t++<l;)if(34===o.charCodeAt(t)){if(34!==o.charCodeAt(t+1))break;++t}return c=t+2,13===(i=o.charCodeAt(t+1))?(r=!0,10===o.charCodeAt(t+2)&&++c):10===i&&(r=!0),o.slice(e+1,t).replace(/""/g,'"')}for(;c<l;){var i,n=1;if(10===(i=o.charCodeAt(c++)))r=!0;else if(13===i)r=!0,10===o.charCodeAt(c)&&(++c,++n);else if(i!==h)continue;return o.slice(e,c-n)}return o.slice(e)}for(;(t=u())!==s;){for(var d=[];t!==a&&t!==s;)d.push(t),t=u();e&&null==(d=e(d,n++))||i.push(d)}return i},a.format=function(e){if(Array.isArray(e[0]))return a.formatRows(e);var i=new S,n=[];return e.forEach(function(e){for(var t in e)i.has(t)||n.push(i.add(t))}),[n.map(c).join(o)].concat(e.map(function(t){return n.map(function(e){return c(t[e])}).join(o)})).join("\n")},a.formatRows=function(e){return e.map(i).join("\n")},a},M.csv=M.dsv(",","text/csv"),M.tsv=M.dsv(" ","text/tab-separated-values");var vt,yt,bt,wt,Ct,_t=this[D(this,"requestAnimationFrame")]||function(e){setTimeout(e,17)};function At(){var e=Et(),t=xt()-e;24<t?(isFinite(t)&&(clearTimeout(wt),wt=setTimeout(At,t)),bt=0):(bt=1,_t(At))}function Et(){var e=Date.now();for(Ct=vt;Ct;)e>=Ct.t&&(Ct.f=Ct.c(e-Ct.t)),Ct=Ct.n;return e}function xt(){for(var e,t=vt,i=1/0;t;)t=t.f?e?e.n=t.n:vt=t.n:(t.t<i&&(i=t.t),(e=t).n);return yt=e,i}function St(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)}M.timer=function(e,t,i){var n=arguments.length;n<2&&(t=0),n<3&&(i=Date.now());var o={c:e,t:i+t,f:!1,n:null};yt?yt.n=o:vt=o,yt=o,bt||(wt=clearTimeout(wt),bt=1,_t(At))},M.timer.flush=function(){Et(),xt()},M.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)};var Tt=["y","z","a","f","p","n","¬µ","m","","k","M","G","T","P","E","Z","Y"].map(function(e,t){var i=Math.pow(10,3*F(8-t));return{scale:8<t?function(e){return e/i}:function(e){return e*i},symbol:e}});M.formatPrefix=function(e,t){var i=0;return e&&(e<0&&(e*=-1),t&&(e=M.round(e,St(e,t))),i=1+Math.floor(1e-12+Math.log(e)/Math.LN10),i=Math.max(-24,Math.min(24,3*Math.floor((i-1)/3)))),Tt[8+i/3]};var Dt=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,kt=M.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return(e=M.round(e,St(e,t))).toFixed(Math.max(0,Math.min(20,St(e*(1+1e-15),t))))}});function Rt(e){return e+""}var Ot=M.time={},Nt=Date;function Ft(){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}Ft.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Mt.setUTCDate.apply(this._,arguments)},setDay:function(){Mt.setUTCDay.apply(this._,arguments)},setFullYear:function(){Mt.setUTCFullYear.apply(this._,arguments)},setHours:function(){Mt.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Mt.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Mt.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Mt.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Mt.setUTCSeconds.apply(this._,arguments)},setTime:function(){Mt.setTime.apply(this._,arguments)}};var Mt=Date.prototype;function Pt(n,r,a){function e(e){var t=n(e),i=o(t,1);return e-t<i-e?t:i}function s(e){return r(e=n(new Nt(e-1)),1),e}function o(e,t){return r(e=new Nt(+e),t),e}function l(e,t,i){var n=s(e),o=[];if(1<i)for(;n<t;)a(n)%i||o.push(new Date(+n)),r(n,1);else for(;n<t;)o.push(new Date(+n)),r(n,1);return o}(n.floor=n).round=e,n.ceil=s,n.offset=o,n.range=l;var t=n.utc=It(n);return(t.floor=t).round=It(e),t.ceil=It(s),t.offset=It(o),t.range=function(e,t,i){try{var n=new(Nt=Ft);return n._=e,l(n,t,i)}finally{Nt=Date}},n}function It(n){return function(e,t){try{var i=new(Nt=Ft);return i._=e,n(i,t)._}finally{Nt=Date}}}Ot.year=Pt(function(e){return(e=Ot.day(e)).setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),Ot.years=Ot.year.range,Ot.years.utc=Ot.year.utc.range,Ot.day=Pt(function(e){var t=new Nt(2e3,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),Ot.days=Ot.day.range,Ot.days.utc=Ot.day.utc.range,Ot.dayOfYear=function(e){var t=Ot.year(e);return Math.floor((e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(e,i){i=7-i;var t=Ot[e]=Pt(function(e){return(e=Ot.day(e)).setDate(e.getDate()-(e.getDay()+i)%7),e},function(e,t){e.setDate(e.getDate()+7*Math.floor(t))},function(e){var t=Ot.year(e).getDay();return Math.floor((Ot.dayOfYear(e)+(t+i)%7)/7)-(t!==i)});Ot[e+"s"]=t.range,Ot[e+"s"].utc=t.utc.range,Ot[e+"OfYear"]=function(e){var t=Ot.year(e).getDay();return Math.floor((Ot.dayOfYear(e)+(t+i)%7)/7)}}),Ot.week=Ot.sunday,Ot.weeks=Ot.sunday.range,Ot.weeks.utc=Ot.sunday.utc.range,Ot.weekOfYear=Ot.sundayOfYear;var Lt={"-":"",_:" ",0:"0"},Gt=/^\s*\d+/,$t=/^%/;function Bt(e,t,i){var n=e<0?"-":"",o=(n?-e:e)+"",r=o.length;return n+(r<i?new Array(i-r+1).join(t)+o:o)}function jt(e){return new RegExp("^(?:"+e.map(M.requote).join("|")+")","i")}function Wt(e){for(var t=new y,i=-1,n=e.length;++i<n;)t.set(e[i].toLowerCase(),i);return t}function Ht(e,t,i){Gt.lastIndex=0;var n=Gt.exec(t.slice(i,i+1));return n?(e.w=+n[0],i+n[0].length):-1}function zt(e,t,i){Gt.lastIndex=0;var n=Gt.exec(t.slice(i));return n?(e.U=+n[0],i+n[0].length):-1}function Vt(e,t,i){Gt.lastIndex=0;var n=Gt.exec(t.slice(i));return n?(e.W=+n[0],i+n[0].length):-1}function Ut(e,t,i){Gt.lastIndex=0;var n=Gt.exec(t.slice(i,i+4));return n?(e.y=+n[0],i+n[0].length):-1}function Yt(e,t,i){Gt.lastIndex=0;var n=Gt.exec(t.slice(i,i+2));return n?(e.y=function(e){return e+(68<e?1900:2e3)}(+n[0]),i+n[0].length):-1}function qt(e,t,i){return/^[+-]\d{4}$/.test(t=t.slice(i,i+5))?(e.Z=-t,i+5):-1}function Qt(e,t,i){Gt.lastIndex=0;var n=Gt.exec(t.slice(i,i+2));return n?(e.m=n[0]-1,i+n[0].length):-1}function Kt(e,t,i){Gt.lastIndex=0;var n=Gt.exec(t.slice(i,i+2));return n?(e.d=+n[0],i+n[0].length):-1}function Xt(e,t,i){Gt.lastIndex=0;var n=Gt.exec(t.slice(i,i+3));return n?(e.j=+n[0],i+n[0].length):-1}function Jt(e,t,i){Gt.lastIndex=0;var n=Gt.exec(t.slice(i,i+2));return n?(e.H=+n[0],i+n[0].length):-1}function Zt(e,t,i){Gt.lastIndex=0;var n=Gt.exec(t.slice(i,i+2));return n?(e.M=+n[0],i+n[0].length):-1}function ei(e,t,i){Gt.lastIndex=0;var n=Gt.exec(t.slice(i,i+2));return n?(e.S=+n[0],i+n[0].length):-1}function ti(e,t,i){Gt.lastIndex=0;var n=Gt.exec(t.slice(i,i+3));return n?(e.L=+n[0],i+n[0].length):-1}function ii(e){var t=e.getTimezoneOffset(),i=0<t?"-":"+",n=F(t)/60|0,o=F(t)%60;return i+Bt(n,"0",2)+Bt(o,"0",2)}function ni(e,t,i){$t.lastIndex=0;var n=$t.exec(t.slice(i,i+1));return n?i+n[0].length:-1}function oi(n){for(var e=n.length,t=-1;++t<e;)n[t][0]=this(n[t][0]);return function(e){for(var t=0,i=n[t];!i[1](e);)i=n[++t];return i[0](e)}}M.locale=function(e){return{numberFormat:function(e){var E=e.decimal,s=e.thousands,l=e.grouping,n=e.currency,x=l&&s?function(e,t){for(var i=e.length,n=[],o=0,r=l[0],a=0;0<i&&0<r&&(t<a+r+1&&(r=Math.max(1,t-a)),n.push(e.substring(i-=r,i+r)),!((a+=r+1)>t));)r=l[o=(o+1)%l.length];return n.reverse().join(s)}:I;return function(e){var t=Dt.exec(e),u=t[1]||" ",d=t[2]||">",h=t[3]||"-",i=t[4]||"",p=t[5],f=+t[6],g=t[7],m=t[8],v=t[9],y=1,b="",w="",C=!1,_=!0;switch(m=m&&+m.substring(1),(p||"0"===u&&"="===d)&&(p=u="0",d="="),v){case"n":g=!0,v="g";break;case"%":y=100,w="%",v="f";break;case"p":y=100,w="%",v="r";break;case"b":case"o":case"x":case"X":"#"===i&&(b="0"+v.toLowerCase());case"c":_=!1;case"d":C=!0,m=0;break;case"s":y=-1,v="r"}"$"===i&&(b=n[0],w=n[1]),"r"!=v||m||(v="g"),null!=m&&("g"==v?m=Math.max(1,Math.min(21,m)):"e"!=v&&"f"!=v||(m=Math.max(0,Math.min(20,m)))),v=kt.get(v)||Rt;var A=p&&g;return function(e){var t=w;if(C&&e%1)return"";var i=e<0||0===e&&1/e<0?(e=-e,"-"):"-"===h?"":h;if(y<0){var n=M.formatPrefix(e,m);e=n.scale(e),t=n.symbol+w}else e*=y;var o,r,a=(e=v(e,m)).lastIndexOf(".");if(a<0){var s=_?e.lastIndexOf("e"):-1;r=s<0?(o=e,""):(o=e.substring(0,s),e.substring(s))}else o=e.substring(0,a),r=E+e.substring(a+1);!p&&g&&(o=x(o,1/0));var l=b.length+o.length+r.length+(A?0:i.length),c=l<f?new Array(l=f-l+1).join(u):"";return A&&(o=x(c+o,c.length?f-r.length:1/0)),i+=b,e=o+r,("<"===d?i+e+c:">"===d?c+i+e:"^"===d?c.substring(0,l>>=1)+i+e+c.substring(l):i+(A?e:c+e))+t}}}(e),timeFormat:function(e){var t=e.dateTime,i=e.date,n=e.time,o=e.periods,r=e.days,a=e.shortDays,s=e.months,l=e.shortMonths;function c(s){var l=s.length;function e(e){for(var t,i,n,o=[],r=-1,a=0;++r<l;)37===s.charCodeAt(r)&&(o.push(s.slice(a,r)),null!=(i=Lt[t=s.charAt(++r)])&&(t=s.charAt(++r)),(n=w[t])&&(t=n(e,null==i?"e"===t?" ":"0":i)),o.push(t),a=r+1);return o.push(s.slice(a,r)),o.join("")}return e.parse=function(e){var t={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(u(t,s,e,0)!=e.length)return null;"p"in t&&(t.H=t.H%12+12*t.p);var i=null!=t.Z&&Nt!==Ft,n=new(i?Ft:Nt);return"j"in t?n.setFullYear(t.y,0,t.j):"w"in t&&("W"in t||"U"in t)?(n.setFullYear(t.y,0,1),n.setFullYear(t.y,0,"W"in t?(t.w+6)%7+7*t.W-(n.getDay()+5)%7:t.w+7*t.U-(n.getDay()+6)%7)):n.setFullYear(t.y,t.m,t.d),n.setHours(t.H+(t.Z/100|0),t.M+t.Z%100,t.S,t.L),i?n._:n},e.toString=function(){return s},e}function u(e,t,i,n){for(var o,r,a,s=0,l=t.length,c=i.length;s<l;){if(c<=n)return-1;if(37===(o=t.charCodeAt(s++))){if(a=t.charAt(s++),!(r=C[a in Lt?t.charAt(s++):a])||(n=r(e,i,n))<0)return-1}else if(o!=i.charCodeAt(n++))return-1}return n}c.multi=(c.utc=function(e){var i=c(e);function t(e){try{var t=new(Nt=Ft);return t._=e,i(t)}finally{Nt=Date}}return t.parse=function(e){try{Nt=Ft;var t=i.parse(e);return t&&t._}finally{Nt=Date}},t.toString=i.toString,t}).multi=oi;var d=M.map(),h=jt(r),p=Wt(r),f=jt(a),g=Wt(a),m=jt(s),v=Wt(s),y=jt(l),b=Wt(l);o.forEach(function(e,t){d.set(e.toLowerCase(),t)});var w={a:function(e){return a[e.getDay()]},A:function(e){return r[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:c(t),d:function(e,t){return Bt(e.getDate(),t,2)},e:function(e,t){return Bt(e.getDate(),t,2)},H:function(e,t){return Bt(e.getHours(),t,2)},I:function(e,t){return Bt(e.getHours()%12||12,t,2)},j:function(e,t){return Bt(1+Ot.dayOfYear(e),t,3)},L:function(e,t){return Bt(e.getMilliseconds(),t,3)},m:function(e,t){return Bt(e.getMonth()+1,t,2)},M:function(e,t){return Bt(e.getMinutes(),t,2)},p:function(e){return o[+(12<=e.getHours())]},S:function(e,t){return Bt(e.getSeconds(),t,2)},U:function(e,t){return Bt(Ot.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return Bt(Ot.mondayOfYear(e),t,2)},x:c(i),X:c(n),y:function(e,t){return Bt(e.getFullYear()%100,t,2)},Y:function(e,t){return Bt(e.getFullYear()%1e4,t,4)},Z:ii,"%":function(){return"%"}},C={a:function(e,t,i){f.lastIndex=0;var n=f.exec(t.slice(i));return n?(e.w=g.get(n[0].toLowerCase()),i+n[0].length):-1},A:function(e,t,i){h.lastIndex=0;var n=h.exec(t.slice(i));return n?(e.w=p.get(n[0].toLowerCase()),i+n[0].length):-1},b:function(e,t,i){y.lastIndex=0;var n=y.exec(t.slice(i));return n?(e.m=b.get(n[0].toLowerCase()),i+n[0].length):-1},B:function(e,t,i){m.lastIndex=0;var n=m.exec(t.slice(i));return n?(e.m=v.get(n[0].toLowerCase()),i+n[0].length):-1},c:function(e,t,i){return u(e,w.c.toString(),t,i)},d:Kt,e:Kt,H:Jt,I:Jt,j:Xt,L:ti,m:Qt,M:Zt,p:function(e,t,i){var n=d.get(t.slice(i,i+=2).toLowerCase());return null==n?-1:(e.p=n,i)},S:ei,U:zt,w:Ht,W:Vt,x:function(e,t,i){return u(e,w.x.toString(),t,i)},X:function(e,t,i){return u(e,w.X.toString(),t,i)},y:Yt,Y:Ut,Z:qt,"%":ni};return c}(e)}};var ri=M.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ai(){}M.format=ri.numberFormat,M.geo={},ai.prototype={s:0,t:0,add:function(e){li(e,this.t,si),li(si.s,this.s,this),this.s?this.t+=si.t:this.s=si.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var si=new ai;function li(e,t,i){var n=i.s=e+t,o=n-e,r=n-o;i.t=e-r+(t-o)}function ci(e,t){e&&di.hasOwnProperty(e.type)&&di[e.type](e,t)}M.geo.stream=function(e,t){e&&ui.hasOwnProperty(e.type)?ui[e.type](e,t):ci(e,t)};var ui={Feature:function(e,t){ci(e.geometry,t)},FeatureCollection:function(e,t){for(var i=e.features,n=-1,o=i.length;++n<o;)ci(i[n].geometry,t)}},di={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var i=e.coordinates,n=-1,o=i.length;++n<o;)e=i[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){hi(e.coordinates,t,0)},MultiLineString:function(e,t){for(var i=e.coordinates,n=-1,o=i.length;++n<o;)hi(i[n],t,0)},Polygon:function(e,t){pi(e.coordinates,t)},MultiPolygon:function(e,t){for(var i=e.coordinates,n=-1,o=i.length;++n<o;)pi(i[n],t)},GeometryCollection:function(e,t){for(var i=e.geometries,n=-1,o=i.length;++n<o;)ci(i[n],t)}};function hi(e,t,i){var n,o=-1,r=e.length-i;for(t.lineStart();++o<r;)n=e[o],t.point(n[0],n[1],n[2]);t.lineEnd()}function pi(e,t){var i=-1,n=e.length;for(t.polygonStart();++i<n;)hi(e[i],t,1);t.polygonEnd()}M.geo.area=function(e){return fi=0,M.geo.stream(e,$i),fi};var fi,gi,mi,vi,yi,bi,wi,Ci,_i,Ai,Ei,xi,Si,Ti,Di,ki,Ri,Oi,Ni,Fi,Mi,Pi,Ii,Li,Gi=new ai,$i={sphere:function(){fi+=4*Ae},point:R,lineStart:R,lineEnd:R,polygonStart:function(){Gi.reset(),$i.lineStart=Bi},polygonEnd:function(){var e=2*Gi;fi+=e<0?4*Ae+e:e,$i.lineStart=$i.lineEnd=$i.point=R}};function Bi(){var i,n,u,d,h;function o(e,t){t=t*Te/2+Ae/4;var i=(e*=Te)-u,n=0<=i?1:-1,o=n*i,r=Math.cos(t),a=Math.sin(t),s=h*a,l=d*r+s*Math.cos(o),c=s*n*Math.sin(o);Gi.add(Math.atan2(c,l)),u=e,d=r,h=a}$i.point=function(e,t){$i.point=o,u=(i=e)*Te,d=Math.cos(t=(n=t)*Te/2+Ae/4),h=Math.sin(t)},$i.lineEnd=function(){o(i,n)}}function ji(e){var t=e[0],i=e[1],n=Math.cos(i);return[n*Math.cos(t),n*Math.sin(t),Math.sin(i)]}function Wi(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Hi(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function zi(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Vi(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Ui(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Yi(e){return[Math.atan2(e[1],e[0]),Ne(e[2])]}function qi(e,t){return F(e[0]-t[0])<Ce&&F(e[1]-t[1])<Ce}function Qi(e,t){Ei.push(xi=[gi=e,vi=e]),t<mi&&(mi=t),yi<t&&(yi=t)}function Ki(e,t){var i=ji([e*Te,t*Te]);if(_i){var n=Hi(_i,i),o=Hi([n[1],-n[0],0],n);Ui(o),o=Yi(o);var r=e-bi,a=0<r?1:-1,s=o[0]*De*a,l=180<F(r);if(l^(a*bi<s&&s<a*e)){var c=o[1]*De;yi<c&&(yi=c)}else if(l^(a*bi<(s=(s+360)%360-180)&&s<a*e)){(c=-o[1]*De)<mi&&(mi=c)}else t<mi&&(mi=t),yi<t&&(yi=t);l?e<bi?nn(gi,e)>nn(gi,vi)&&(vi=e):nn(e,vi)>nn(gi,vi)&&(gi=e):gi<=vi?(e<gi&&(gi=e),vi<e&&(vi=e)):bi<e?nn(gi,e)>nn(gi,vi)&&(vi=e):nn(e,vi)>nn(gi,vi)&&(gi=e)}else Qi(e,t);_i=i,bi=e}function Xi(){Si.point=Ki}function Ji(){xi[0]=gi,xi[1]=vi,Si.point=Qi,_i=null}function Zi(e,t){if(_i){var i=e-bi;Ai+=180<F(i)?i+(0<i?360:-360):i}else wi=e,Ci=t;$i.point(e,t),Ki(e,t)}function en(){$i.lineStart()}function tn(){Zi(wi,Ci),$i.lineEnd(),F(Ai)>Ce&&(gi=-(vi=180)),xi[0]=gi,xi[1]=vi,_i=null}function nn(e,t){return(t-=e)<0?t+360:t}function on(e,t){return e[0]-t[0]}function rn(e,t){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}M.geo.bounds=(Si={point:Qi,lineStart:Xi,lineEnd:Ji,polygonStart:function(){Si.point=Zi,Si.lineStart=en,Si.lineEnd=tn,Ai=0,$i.polygonStart()},polygonEnd:function(){$i.polygonEnd(),Si.point=Qi,Si.lineStart=Xi,Si.lineEnd=Ji,Gi<0?(gi=-(vi=180),mi=-(yi=90)):Ce<Ai?yi=90:Ai<-Ce&&(mi=-90),xi[0]=gi,xi[1]=vi}},function(e){if(yi=vi=-(gi=mi=1/0),Ei=[],M.geo.stream(e,Si),o=Ei.length){Ei.sort(on);for(var t=1,i=[s=Ei[0]];t<o;++t)rn((r=Ei[t])[0],s)||rn(r[1],s)?(nn(s[0],r[1])>nn(s[0],s[1])&&(s[1]=r[1]),nn(r[0],s[1])>nn(s[0],s[1])&&(s[0]=r[0])):i.push(s=r);for(var n,o,r,a=-1/0,s=(t=0,i[o=i.length-1]);t<=o;s=r,++t)r=i[t],(n=nn(s[1],r[0]))>a&&(a=n,gi=r[0],vi=s[1])}return Ei=xi=null,gi===1/0||mi===1/0?[[NaN,NaN],[NaN,NaN]]:[[gi,mi],[vi,yi]]}),M.geo.centroid=function(e){Ti=Di=ki=Ri=Oi=Ni=Fi=Mi=Pi=Ii=Li=0,M.geo.stream(e,an);var t=Pi,i=Ii,n=Li,o=t*t+i*i+n*n;return o<_e&&(t=Ni,i=Fi,n=Mi,Di<Ce&&(t=ki,i=Ri,n=Oi),(o=t*t+i*i+n*n)<_e)?[NaN,NaN]:[Math.atan2(i,t)*De,Ne(n/Math.sqrt(o))*De]};var an={sphere:R,point:sn,lineStart:cn,lineEnd:un,polygonStart:function(){an.lineStart=dn},polygonEnd:function(){an.lineStart=cn}};function sn(e,t){e*=Te;var i=Math.cos(t*=Te);ln(i*Math.cos(e),i*Math.sin(e),Math.sin(t))}function ln(e,t,i){ki+=(e-ki)/++Ti,Ri+=(t-Ri)/Ti,Oi+=(i-Oi)/Ti}function cn(){var s,l,c;function n(e,t){e*=Te;var i=Math.cos(t*=Te),n=i*Math.cos(e),o=i*Math.sin(e),r=Math.sin(t),a=Math.atan2(Math.sqrt((a=l*r-c*o)*a+(a=c*n-s*r)*a+(a=s*o-l*n)*a),s*n+l*o+c*r);Di+=a,Ni+=a*(s+(s=n)),Fi+=a*(l+(l=o)),Mi+=a*(c+(c=r)),ln(s,l,c)}an.point=function(e,t){e*=Te;var i=Math.cos(t*=Te);s=i*Math.cos(e),l=i*Math.sin(e),c=Math.sin(t),an.point=n,ln(s,l,c)}}function un(){an.point=sn}function dn(){var n,o,p,f,g;function r(e,t){e*=Te;var i=Math.cos(t*=Te),n=i*Math.cos(e),o=i*Math.sin(e),r=Math.sin(t),a=f*r-g*o,s=g*n-p*r,l=p*o-f*n,c=Math.sqrt(a*a+s*s+l*l),u=p*n+f*o+g*r,d=c&&-Oe(u)/c,h=Math.atan2(c,u);Pi+=d*a,Ii+=d*s,Li+=d*l,Di+=h,Ni+=h*(p+(p=n)),Fi+=h*(f+(f=o)),Mi+=h*(g+(g=r)),ln(p,f,g)}an.point=function(e,t){n=e,o=t,an.point=r,e*=Te;var i=Math.cos(t*=Te);p=i*Math.cos(e),f=i*Math.sin(e),g=Math.sin(t),ln(p,f,g)},an.lineEnd=function(){r(n,o),an.lineEnd=un,an.point=sn}}function hn(i,n){function e(e,t){return e=i(e,t),n(e[0],e[1])}return i.invert&&n.invert&&(e.invert=function(e,t){return(e=n.invert(e,t))&&i.invert(e[0],e[1])}),e}function pn(){return!0}function fn(e,t,i,n,s){var l=[],c=[];if(e.forEach(function(e){if(!((t=e.length-1)<=0)){var t,i=e[0],n=e[t];if(qi(i,n)){s.lineStart();for(var o=0;o<t;++o)s.point((i=e[o])[0],i[1]);s.lineEnd()}else{var r=new mn(i,e,null,!0),a=new mn(i,null,r,!1);r.o=a,l.push(r),c.push(a),a=new mn(n,null,r=new mn(n,e,null,!1),!0),r.o=a,l.push(r),c.push(a)}}}),c.sort(t),gn(l),gn(c),l.length){for(var o=0,r=i,a=c.length;o<a;++o)c[o].e=r=!r;for(var u,d,h=l[0];;){for(var p=h,f=!0;p.v;)if((p=p.n)===h)return;u=p.z,s.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(o=0,a=u.length;o<a;++o)s.point((d=u[o])[0],d[1]);else n(p.x,p.n.x,1,s);p=p.n}else{if(f)for(o=(u=p.p.z).length-1;0<=o;--o)s.point((d=u[o])[0],d[1]);else n(p.x,p.p.x,-1,s);p=p.p}u=(p=p.o).z,f=!f}while(!p.v);s.lineEnd()}}}function gn(e){if(t=e.length){for(var t,i,n=0,o=e[0];++n<t;)o.n=i=e[n],i.p=o,o=i;o.n=i=e[0],i.p=o}}function mn(e,t,i,n){this.x=e,this.z=t,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function vn(y,b,w,C){return function(n,a){var s,o=b(a),t=n.invert(C[0],C[1]),i={point:r,lineStart:l,lineEnd:c,polygonStart:function(){i.point=g,i.lineStart=m,i.lineEnd=v,s=[],u=[]},polygonEnd:function(){i.point=r,i.lineStart=l,i.lineEnd=c,s=M.merge(s);var e=function(e,t){var i=e[0],n=e[1],o=[Math.sin(i),-Math.cos(i),0],r=0,a=0;Gi.reset();for(var s=0,l=t.length;s<l;++s){var c=t[s],u=c.length;if(u)for(var d=c[0],h=d[0],p=d[1]/2+Ae/4,f=Math.sin(p),g=Math.cos(p),m=1;;){m===u&&(m=0);var v=(e=c[m])[0],y=e[1]/2+Ae/4,b=Math.sin(y),w=Math.cos(y),C=v-h,_=0<=C?1:-1,A=_*C,E=Ae<A,x=f*b;if(Gi.add(Math.atan2(x*_*Math.sin(A),g*w+x*Math.cos(A))),r+=E?C+_*Ee:C,E^i<=h^i<=v){var S=Hi(ji(d),ji(e));Ui(S);var T=Hi(o,S);Ui(T);var D=(E^0<=C?-1:1)*Ne(T[2]);(D<n||n===D&&(S[0]||S[1]))&&(a+=E^0<=C?1:-1)}if(!m++)break;h=v,f=b,g=w,d=e}}return(r<-Ce||r<Ce&&Gi<0)^1&a}(t,u);s.length?(f||(a.polygonStart(),f=!0),fn(s,wn,e,w,a)):e&&(f||(a.polygonStart(),f=!0),a.lineStart(),w(null,null,1,a),a.lineEnd()),f&&(a.polygonEnd(),f=!1),s=u=null},sphere:function(){a.polygonStart(),a.lineStart(),w(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function r(e,t){var i=n(e,t);y(e=i[0],t=i[1])&&a.point(e,t)}function e(e,t){var i=n(e,t);o.point(i[0],i[1])}function l(){i.point=e,o.lineStart()}function c(){i.point=r,o.lineEnd()}var u,d,h=bn(),p=b(h),f=!1;function g(e,t){d.push([e,t]);var i=n(e,t);p.point(i[0],i[1])}function m(){p.lineStart(),d=[]}function v(){g(d[0][0],d[0][1]),p.lineEnd();var e,t=p.clean(),i=h.buffer(),n=i.length;if(d.pop(),u.push(d),d=null,n)if(1&t){var o,r=-1;if(0<(n=(e=i[0]).length-1)){for(f||(a.polygonStart(),f=!0),a.lineStart();++r<n;)a.point((o=e[r])[0],o[1]);a.lineEnd()}}else 1<n&&2&t&&i.push(i.pop().concat(i.shift())),s.push(i.filter(yn))}return i}}function yn(e){return 1<e.length}function bn(){var i,t=[];return{lineStart:function(){t.push(i=[])},point:function(e,t){i.push([e,t])},lineEnd:R,buffer:function(){var e=t;return t=[],i=null,e},rejoin:function(){1<t.length&&t.push(t.pop().concat(t.shift()))}}}function wn(e,t){return((e=e.x)[0]<0?e[1]-Se-Ce:Se-e[1])-((t=t.x)[0]<0?t[1]-Se-Ce:Se-t[1])}var Cn=vn(pn,function(o){var r,a=NaN,s=NaN,l=NaN;return{lineStart:function(){o.lineStart(),r=1},point:function(e,t){var i=0<e?Ae:-Ae,n=F(e-a);F(n-Ae)<Ce?(o.point(a,s=0<(s+t)/2?Se:-Se),o.point(l,s),o.lineEnd(),o.lineStart(),o.point(i,s),o.point(e,s),r=0):l!==i&&Ae<=n&&(F(a-l)<Ce&&(a-=l*Ce),F(e-i)<Ce&&(e-=i*Ce),s=function(e,t,i,n){var o,r,a=Math.sin(e-i);return F(a)>Ce?Math.atan((Math.sin(t)*(r=Math.cos(n))*Math.sin(i)-Math.sin(n)*(o=Math.cos(t))*Math.sin(e))/(o*r*a)):(t+n)/2}(a,s,e,t),o.point(l,s),o.lineEnd(),o.lineStart(),o.point(i,s),r=0),o.point(a=e,s=t),l=i},lineEnd:function(){o.lineEnd(),a=s=NaN},clean:function(){return 2-r}}},function(e,t,i,n){var o;if(null==e)o=i*Se,n.point(-Ae,o),n.point(0,o),n.point(Ae,o),n.point(Ae,0),n.point(Ae,-o),n.point(0,-o),n.point(-Ae,-o),n.point(-Ae,0),n.point(-Ae,o);else if(F(e[0]-t[0])>Ce){var r=e[0]<t[0]?Ae:-Ae;o=i*r/2,n.point(-r,o),n.point(0,o),n.point(r,o)}else n.point(t[0],t[1])},[-Ae,-Ae/2]);function _n(u,d,h,p){return function(e){var t,i=e.a,n=e.b,o=i.x,r=i.y,a=0,s=1,l=n.x-o,c=n.y-r;if(t=u-o,l||!(0<t)){if(t/=l,l<0){if(t<a)return;t<s&&(s=t)}else if(0<l){if(s<t)return;a<t&&(a=t)}if(t=h-o,l||!(t<0)){if(t/=l,l<0){if(s<t)return;a<t&&(a=t)}else if(0<l){if(t<a)return;t<s&&(s=t)}if(t=d-r,c||!(0<t)){if(t/=c,c<0){if(t<a)return;t<s&&(s=t)}else if(0<c){if(s<t)return;a<t&&(a=t)}if(t=p-r,c||!(t<0)){if(t/=c,c<0){if(s<t)return;a<t&&(a=t)}else if(0<c){if(t<a)return;t<s&&(s=t)}return 0<a&&(e.a={x:o+a*l,y:r+a*c}),s<1&&(e.b={x:o+s*l,y:r+s*c}),e}}}}}}var An=1e9;function En(w,C,_,A){return function(o){var n,u,r,a,s,l,c,d,h,p,f,g=o,e=bn(),m=_n(w,C,_,A),t={point:i,lineStart:function(){t.point=b,u&&u.push(r=[]);p=!0,h=!1,c=d=NaN},lineEnd:function(){n&&(b(a,s),l&&h&&e.rejoin(),n.push(e.buffer()));t.point=i,h&&o.lineEnd()},polygonStart:function(){o=e,n=[],u=[],f=!0},polygonEnd:function(){o=g,n=M.merge(n);var e=function(e){for(var t=0,i=u.length,n=e[1],o=0;o<i;++o)for(var r,a=1,s=u[o],l=s.length,c=s[0];a<l;++a)r=s[a],c[1]<=n?r[1]>n&&0<Re(c,r,e)&&++t:r[1]<=n&&Re(c,r,e)<0&&--t,c=r;return 0!==t}([w,A]),t=f&&e,i=n.length;(t||i)&&(o.polygonStart(),t&&(o.lineStart(),v(null,null,1,o),o.lineEnd()),i&&fn(n,x,e,v,o),o.polygonEnd()),n=u=r=null}};function v(e,t,i,n){var o=0,r=0;if(null==e||(o=E(e,i))!==(r=E(t,i))||S(e,t)<0^0<i)for(;n.point(0===o||3===o?w:_,1<o?A:C),(o=(o+i+4)%4)!==r;);else n.point(t[0],t[1])}function y(e,t){return w<=e&&e<=_&&C<=t&&t<=A}function i(e,t){y(e,t)&&o.point(e,t)}function b(e,t){var i=y(e=Math.max(-An,Math.min(An,e)),t=Math.max(-An,Math.min(An,t)));if(u&&r.push([e,t]),p)a=e,s=t,p=!1,(l=i)&&(o.lineStart(),o.point(e,t));else if(i&&h)o.point(e,t);else{var n={a:{x:c,y:d},b:{x:e,y:t}};m(n)?(h||(o.lineStart(),o.point(n.a.x,n.a.y)),o.point(n.b.x,n.b.y),i||o.lineEnd(),f=!1):i&&(o.lineStart(),o.point(e,t),f=!1)}c=e,d=t,h=i}return t};function E(e,t){return F(e[0]-w)<Ce?0<t?0:3:F(e[0]-_)<Ce?0<t?2:1:F(e[1]-C)<Ce?0<t?1:0:0<t?3:2}function x(e,t){return S(e.x,t.x)}function S(e,t){var i=E(e,1),n=E(t,1);return i!==n?i-n:0===i?t[1]-e[1]:1===i?e[0]-t[0]:2===i?e[1]-t[1]:t[0]-e[0]}}function xn(e){var t=0,i=Ae/3,n=Qn(e),o=n(t,i);return o.parallels=function(e){return arguments.length?n(t=e[0]*Ae/180,i=e[1]*Ae/180):[t/Ae*180,i/Ae*180]},o}function Sn(e,t){var i=Math.sin(e),n=(i+Math.sin(t))/2,o=1+i*(2*n-i),r=Math.sqrt(o)/n;function a(e,t){var i=Math.sqrt(o-2*n*Math.sin(t))/n;return[i*Math.sin(e*=n),r-i*Math.cos(e)]}return a.invert=function(e,t){var i=r-t;return[Math.atan2(e,i)/n,Ne((o-(e*e+i*i)*n*n)/(2*n))]},a}M.geo.clipExtent=function(){var t,i,n,o,r,a,s={stream:function(e){return r&&(r.valid=!1),(r=a(e)).valid=!0,r},extent:function(e){return arguments.length?(a=En(t=+e[0][0],i=+e[0][1],n=+e[1][0],o=+e[1][1]),r&&(r.valid=!1,r=null),s):[[t,i],[n,o]]}};return s.extent([[0,0],[960,500]])},(M.geo.conicEqualArea=function(){return xn(Sn)}).raw=Sn,M.geo.albers=function(){return M.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},M.geo.albersUsa=function(){var n,o,r,a,s=M.geo.albers(),l=M.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=M.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(e,t){n=[e,t]}};function d(e){var t=e[0],i=e[1];return n=null,o(t,i),n||(r(t,i),n)||a(t,i),n}return d.invert=function(e){var t=s.scale(),i=s.translate(),n=(e[0]-i[0])/t,o=(e[1]-i[1])/t;return(.12<=o&&o<.234&&-.425<=n&&n<-.214?l:.166<=o&&o<.234&&-.214<=n&&n<-.115?c:s).invert(e)},d.stream=function(e){var i=s.stream(e),n=l.stream(e),o=c.stream(e);return{point:function(e,t){i.point(e,t),n.point(e,t),o.point(e,t)},sphere:function(){i.sphere(),n.sphere(),o.sphere()},lineStart:function(){i.lineStart(),n.lineStart(),o.lineStart()},lineEnd:function(){i.lineEnd(),n.lineEnd(),o.lineEnd()},polygonStart:function(){i.polygonStart(),n.polygonStart(),o.polygonStart()},polygonEnd:function(){i.polygonEnd(),n.polygonEnd(),o.polygonEnd()}}},d.precision=function(e){return arguments.length?(s.precision(e),l.precision(e),c.precision(e),d):s.precision()},d.scale=function(e){return arguments.length?(s.scale(e),l.scale(.35*e),c.scale(e),d.translate(s.translate())):s.scale()},d.translate=function(e){if(!arguments.length)return s.translate();var t=s.scale(),i=+e[0],n=+e[1];return o=s.translate(e).clipExtent([[i-.455*t,n-.238*t],[i+.455*t,n+.238*t]]).stream(u).point,r=l.translate([i-.307*t,n+.201*t]).clipExtent([[i-.425*t+Ce,n+.12*t+Ce],[i-.214*t-Ce,n+.234*t-Ce]]).stream(u).point,a=c.translate([i-.205*t,n+.212*t]).clipExtent([[i-.214*t+Ce,n+.166*t+Ce],[i-.115*t-Ce,n+.234*t-Ce]]).stream(u).point,d},d.scale(1070)};var Tn,Dn,kn,Rn,On,Nn,Fn={point:R,lineStart:R,lineEnd:R,polygonStart:function(){Dn=0,Fn.lineStart=Mn},polygonEnd:function(){Fn.lineStart=Fn.lineEnd=Fn.point=R,Tn+=F(Dn/2)}};function Mn(){var i,n,o,r;function a(e,t){Dn+=r*e-o*t,o=e,r=t}Fn.point=function(e,t){Fn.point=a,i=o=e,n=r=t},Fn.lineEnd=function(){a(i,n)}}var Pn={point:function(e,t){e<kn&&(kn=e);On<e&&(On=e);t<Rn&&(Rn=t);Nn<t&&(Nn=t)},lineStart:R,lineEnd:R,polygonStart:R,polygonEnd:R};function In(){var i=Ln(4.5),n=[],o={point:e,lineStart:function(){o.point=t},lineEnd:a,polygonStart:function(){o.lineEnd=s},polygonEnd:function(){o.lineEnd=a,o.point=e},pointRadius:function(e){return i=Ln(e),o},result:function(){if(n.length){var e=n.join("");return n=[],e}}};function e(e,t){n.push("M",e,",",t,i)}function t(e,t){n.push("M",e,",",t),o.point=r}function r(e,t){n.push("L",e,",",t)}function a(){o.point=e}function s(){n.push("Z")}return o}function Ln(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}var Gn,$n={point:Bn,lineStart:jn,lineEnd:Wn,polygonStart:function(){$n.lineStart=Hn},polygonEnd:function(){$n.point=Bn,$n.lineStart=jn,$n.lineEnd=Wn}};function Bn(e,t){ki+=e,Ri+=t,++Oi}function jn(){var r,a;function i(e,t){var i=e-r,n=t-a,o=Math.sqrt(i*i+n*n);Ni+=o*(r+e)/2,Fi+=o*(a+t)/2,Mi+=o,Bn(r=e,a=t)}$n.point=function(e,t){$n.point=i,Bn(r=e,a=t)}}function Wn(){$n.point=Bn}function Hn(){var i,n,r,a;function o(e,t){var i=e-r,n=t-a,o=Math.sqrt(i*i+n*n);Ni+=o*(r+e)/2,Fi+=o*(a+t)/2,Mi+=o,Pi+=(o=a*e-r*t)*(r+e),Ii+=o*(a+t),Li+=3*o,Bn(r=e,a=t)}$n.point=function(e,t){$n.point=o,Bn(i=r=e,n=a=t)},$n.lineEnd=function(){o(i,n)}}function zn(i){var n=4.5,o={point:e,lineStart:function(){o.point=t},lineEnd:a,polygonStart:function(){o.lineEnd=s},polygonEnd:function(){o.lineEnd=a,o.point=e},pointRadius:function(e){return n=e,o},result:R};function e(e,t){i.moveTo(e+n,t),i.arc(e,t,n,0,Ee)}function t(e,t){i.moveTo(e,t),o.point=r}function r(e,t){i.lineTo(e,t)}function a(){o.point=e}function s(){i.closePath()}return o}function Vn(k){var R=.5,O=Math.cos(30*Te),C=16;function t(e){return(C?function(o){var i,n,r,a,s,l,c,u,d,h,p,f,g={point:e,lineStart:t,lineEnd:v,polygonStart:function(){o.polygonStart(),g.lineStart=y},polygonEnd:function(){o.polygonEnd(),g.lineStart=t}};function e(e,t){e=k(e,t),o.point(e[0],e[1])}function t(){u=NaN,g.point=m,o.lineStart()}function m(e,t){var i=ji([e,t]),n=k(e,t);N(u,d,c,h,p,f,u=n[0],d=n[1],c=e,h=i[0],p=i[1],f=i[2],C,o),o.point(u,d)}function v(){g.point=e,o.lineEnd()}function y(){t(),g.point=b,g.lineEnd=w}function b(e,t){m(i=e,t),n=u,r=d,a=h,s=p,l=f,g.point=m}function w(){N(u,d,c,h,p,f,n,r,i,a,s,l,C,o),(g.lineEnd=v)()}return g}:function(i){return Yn(i,function(e,t){e=k(e,t),i.point(e[0],e[1])})})(e)}function N(e,t,i,n,o,r,a,s,l,c,u,d,h,p){var f=a-e,g=s-t,m=f*f+g*g;if(4*R<m&&h--){var v=n+c,y=o+u,b=r+d,w=Math.sqrt(v*v+y*y+b*b),C=Math.asin(b/=w),_=F(F(b)-1)<Ce||F(i-l)<Ce?(i+l)/2:Math.atan2(y,v),A=k(_,C),E=A[0],x=A[1],S=E-e,T=x-t,D=g*S-f*T;(R<D*D/m||.3<F((f*S+g*T)/m-.5)||n*c+o*u+r*d<O)&&(N(e,t,i,n,o,r,E,x,_,v/=w,y/=w,b,h,p),p.point(E,x),N(E,x,_,v,y,b,a,s,l,c,u,d,h,p))}}return t.precision=function(e){return arguments.length?(C=0<(R=e*e)&&16,t):Math.sqrt(R)},t}function Un(e){this.stream=e}function Yn(e,t){return{point:t,sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}function qn(e){return Qn(function(){return e})()}function Qn(e){var i,t,n,o,r,a,s=Vn(function(e,t){return[(e=i(e,t))[0]*l+o,r-e[1]*l]}),l=150,c=480,u=250,d=0,h=0,p=0,f=0,g=0,m=Cn,v=I,y=null,b=null;function w(e){return[(e=n(e[0]*Te,e[1]*Te))[0]*l+o,r-e[1]*l]}function C(e){return(e=n.invert((e[0]-o)/l,(r-e[1])/l))&&[e[0]*De,e[1]*De]}function _(){n=hn(t=Zn(p,f,g),i);var e=i(d,h);return o=c-e[0]*l,r=u+e[1]*l,A()}function A(){return a&&(a.valid=!1,a=null),w}return w.stream=function(e){return a&&(a.valid=!1),(a=Kn(m(t,s(v(e))))).valid=!0,a},w.clipAngle=function(e){return arguments.length?(m=null==e?(y=e,Cn):function(o){var S=Math.cos(o),p=0<S,f=F(S)>Ce;return vn(g,function(s){var l,c,u,d,h;return{lineStart:function(){d=u=!1,h=1},point:function(e,t){var i,n=[e,t],o=g(e,t),r=p?o?0:v(e,t):o?v(e+(e<0?Ae:-Ae),t):0;if(!l&&(d=u=o)&&s.lineStart(),o!==u&&(i=m(l,n),(qi(l,i)||qi(n,i))&&(n[0]+=Ce,n[1]+=Ce,o=g(n[0],n[1]))),o!==u)h=0,o?(s.lineStart(),i=m(n,l),s.point(i[0],i[1])):(i=m(l,n),s.point(i[0],i[1]),s.lineEnd()),l=i;else if(f&&l&&p^o){var a;r&c||!(a=m(n,l,!0))||(h=0,p?(s.lineStart(),s.point(a[0][0],a[0][1]),s.point(a[1][0],a[1][1]),s.lineEnd()):(s.point(a[1][0],a[1][1]),s.lineEnd(),s.lineStart(),s.point(a[0][0],a[0][1])))}!o||l&&qi(l,n)||s.point(n[0],n[1]),l=n,u=o,c=r},lineEnd:function(){u&&s.lineEnd(),l=null},clean:function(){return h|(d&&u)<<1}}},no(o,6*Te),p?[0,-o]:[-Ae,o-Ae]);function g(e,t){return Math.cos(e)*Math.cos(t)>S}function m(e,t,i){var n=[1,0,0],o=Hi(ji(e),ji(t)),r=Wi(o,o),a=o[0],s=r-a*a;if(!s)return!i&&e;var l=S*r/s,c=-S*a/s,u=Hi(n,o),d=Vi(n,l);zi(d,Vi(o,c));var h=u,p=Wi(d,h),f=Wi(h,h),g=p*p-f*(Wi(d,d)-1);if(!(g<0)){var m=Math.sqrt(g),v=Vi(h,(-p-m)/f);if(zi(v,d),v=Yi(v),!i)return v;var y,b=e[0],w=t[0],C=e[1],_=t[1];w<b&&(y=b,b=w,w=y);var A=w-b,E=F(A-Ae)<Ce;if(!E&&_<C&&(y=C,C=_,_=y),E||A<Ce?E?0<C+_^v[1]<(F(v[0]-b)<Ce?C:_):C<=v[1]&&v[1]<=_:Ae<A^(b<=v[0]&&v[0]<=w)){var x=Vi(h,(-p+m)/f);return zi(x,d),[v,Yi(x)]}}}function v(e,t){var i=p?o:Ae-o,n=0;return e<-i?n|=1:i<e&&(n|=2),t<-i?n|=4:i<t&&(n|=8),n}}((y=+e)*Te),A()):y},w.clipExtent=function(e){return arguments.length?(v=(b=e)?En(e[0][0],e[0][1],e[1][0],e[1][1]):I,A()):b},w.scale=function(e){return arguments.length?(l=+e,_()):l},w.translate=function(e){return arguments.length?(c=+e[0],u=+e[1],_()):[c,u]},w.center=function(e){return arguments.length?(d=e[0]%360*Te,h=e[1]%360*Te,_()):[d*De,h*De]},w.rotate=function(e){return arguments.length?(p=e[0]%360*Te,f=e[1]%360*Te,g=2<e.length?e[2]%360*Te:0,_()):[p*De,f*De,g*De]},M.rebind(w,s,"precision"),function(){return i=e.apply(this,arguments),w.invert=i.invert&&C,_()}}function Kn(i){return Yn(i,function(e,t){i.point(e*Te,t*Te)})}function Xn(e,t){return[e,t]}function Jn(e,t){return[Ae<e?e-Ee:e<-Ae?e+Ee:e,t]}function Zn(e,t,i){return e?t||i?hn(to(e),io(t,i)):to(e):t||i?io(t,i):Jn}function eo(i){return function(e,t){return[Ae<(e+=i)?e-Ee:e<-Ae?e+Ee:e,t]}}function to(e){var t=eo(e);return t.invert=eo(-e),t}function io(e,t){var s=Math.cos(e),l=Math.sin(e),c=Math.cos(t),u=Math.sin(t);function i(e,t){var i=Math.cos(t),n=Math.cos(e)*i,o=Math.sin(e)*i,r=Math.sin(t),a=r*s+n*l;return[Math.atan2(o*c-a*u,n*s-r*l),Ne(a*c+o*u)]}return i.invert=function(e,t){var i=Math.cos(t),n=Math.cos(e)*i,o=Math.sin(e)*i,r=Math.sin(t),a=r*c-o*u;return[Math.atan2(o*c+r*u,n*s+a*l),Ne(a*s-n*l)]},i}function no(s,l){var c=Math.cos(s),u=Math.sin(s);return function(e,t,i,n){var o=i*l;null!=e?(e=oo(c,e),t=oo(c,t),(0<i?e<t:t<e)&&(e+=i*Ee)):(e=s+i*Ee,t=s-.5*o);for(var r,a=e;0<i?t<a:a<t;a-=o)n.point((r=Yi([c,-u*Math.cos(a),-u*Math.sin(a)]))[0],r[1])}}function oo(e,t){var i=ji(t);i[0]-=e,Ui(i);var n=Oe(-i[1]);return((-i[2]<0?-n:n)+2*Math.PI-Ce)%(2*Math.PI)}function ro(e,t,i){var n=M.range(e,t-Ce,i).concat(t);return function(t){return n.map(function(e){return[t,e]})}}function ao(e,t,i){var n=M.range(e,t-Ce,i).concat(t);return function(t){return n.map(function(e){return[e,t]})}}function so(e){return e.source}function lo(e){return e.target}M.geo.path=function(){var t,i,n,o,r,a=4.5;function s(e){return e&&("function"==typeof a&&o.pointRadius(+a.apply(this,arguments)),r&&r.valid||(r=n(o)),M.geo.stream(e,r)),o.result()}function l(){return r=null,s}return s.area=function(e){return Tn=0,M.geo.stream(e,n(Fn)),Tn},s.centroid=function(e){return ki=Ri=Oi=Ni=Fi=Mi=Pi=Ii=Li=0,M.geo.stream(e,n($n)),Li?[Pi/Li,Ii/Li]:Mi?[Ni/Mi,Fi/Mi]:Oi?[ki/Oi,Ri/Oi]:[NaN,NaN]},s.bounds=function(e){return On=Nn=-(kn=Rn=1/0),M.geo.stream(e,n(Pn)),[[kn,Rn],[On,Nn]]},s.projection=function(e){return arguments.length?(n=(t=e)?e.stream||function(i){var t=Vn(function(e,t){return i([e*De,t*De])});return function(e){return Kn(t(e))}}(e):I,l()):t},s.context=function(e){return arguments.length?(o=null==(i=e)?new In:new zn(e),"function"!=typeof a&&o.pointRadius(a),l()):i},s.pointRadius=function(e){return arguments.length?(a="function"==typeof e?e:(o.pointRadius(+e),+e),s):a},s.projection(M.geo.albersUsa()).context(null)},M.geo.transform=function(n){return{stream:function(e){var t=new Un(e);for(var i in n)t[i]=n[i];return t}}},Un.prototype={point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},M.geo.projection=qn,M.geo.projectionMutator=Qn,(M.geo.equirectangular=function(){return qn(Xn)}).raw=Xn.invert=Xn,M.geo.rotation=function(t){function e(e){return(e=t(e[0]*Te,e[1]*Te))[0]*=De,e[1]*=De,e}return t=Zn(t[0]%360*Te,t[1]*Te,2<t.length?t[2]*Te:0),e.invert=function(e){return(e=t.invert(e[0]*Te,e[1]*Te))[0]*=De,e[1]*=De,e},e},Jn.invert=Xn,M.geo.circle=function(){var t,o,r=[0,0],i=6;function n(){var e="function"==typeof r?r.apply(this,arguments):r,i=Zn(-e[0]*Te,-e[1]*Te,0).invert,n=[];return o(null,null,1,{point:function(e,t){n.push(e=i(e,t)),e[0]*=De,e[1]*=De}}),{type:"Polygon",coordinates:[n]}}return n.origin=function(e){return arguments.length?(r=e,n):r},n.angle=function(e){return arguments.length?(o=no((t=+e)*Te,i*Te),n):t},n.precision=function(e){return arguments.length?(o=no(t*Te,(i=+e)*Te),n):i},n.angle(90)},M.geo.distance=function(e,t){var i,n=(t[0]-e[0])*Te,o=e[1]*Te,r=t[1]*Te,a=Math.sin(n),s=Math.cos(n),l=Math.sin(o),c=Math.cos(o),u=Math.sin(r),d=Math.cos(r);return Math.atan2(Math.sqrt((i=d*a)*i+(i=c*u-l*d*s)*i),l*u+c*d*s)},M.geo.graticule=function(){var t,i,n,o,r,a,s,l,c,u,d,h,p=10,f=p,g=90,m=360,v=2.5;function y(){return{type:"MultiLineString",coordinates:e()}}function e(){return M.range(Math.ceil(o/g)*g,n,g).map(d).concat(M.range(Math.ceil(l/m)*m,s,m).map(h)).concat(M.range(Math.ceil(i/p)*p,t,p).filter(function(e){return F(e%g)>Ce}).map(c)).concat(M.range(Math.ceil(a/f)*f,r,f).filter(function(e){return F(e%m)>Ce}).map(u))}return y.lines=function(){return e().map(function(e){return{type:"LineString",coordinates:e}})},y.outline=function(){return{type:"Polygon",coordinates:[d(o).concat(h(s).slice(1),d(n).reverse().slice(1),h(l).reverse().slice(1))]}},y.extent=function(e){return arguments.length?y.majorExtent(e).minorExtent(e):y.minorExtent()},y.majorExtent=function(e){return arguments.length?(o=+e[0][0],n=+e[1][0],l=+e[0][1],s=+e[1][1],n<o&&(e=o,o=n,n=e),s<l&&(e=l,l=s,s=e),y.precision(v)):[[o,l],[n,s]]},y.minorExtent=function(e){return arguments.length?(i=+e[0][0],t=+e[1][0],a=+e[0][1],r=+e[1][1],t<i&&(e=i,i=t,t=e),r<a&&(e=a,a=r,r=e),y.precision(v)):[[i,a],[t,r]]},y.step=function(e){return arguments.length?y.majorStep(e).minorStep(e):y.minorStep()},y.majorStep=function(e){return arguments.length?(g=+e[0],m=+e[1],y):[g,m]},y.minorStep=function(e){return arguments.length?(p=+e[0],f=+e[1],y):[p,f]},y.precision=function(e){return arguments.length?(v=+e,c=ro(a,r,90),u=ao(i,t,v),d=ro(l,s,90),h=ao(o,n,v),y):v},y.majorExtent([[-180,-90+Ce],[180,90-Ce]]).minorExtent([[-180,-80-Ce],[180,80+Ce]])},M.geo.greatArc=function(){var t,i,n=so,o=lo;function r(){return{type:"LineString",coordinates:[t||n.apply(this,arguments),i||o.apply(this,arguments)]}}return r.distance=function(){return M.geo.distance(t||n.apply(this,arguments),i||o.apply(this,arguments))},r.source=function(e){return arguments.length?(t="function"==typeof(n=e)?null:e,r):n},r.target=function(e){return arguments.length?(i="function"==typeof(o=e)?null:e,r):o},r.precision=function(){return arguments.length?r:0},r},M.geo.interpolate=function(e,t){return function(e,t,i,n){var o=Math.cos(t),a=Math.sin(t),r=Math.cos(n),s=Math.sin(n),l=o*Math.cos(e),c=o*Math.sin(e),u=r*Math.cos(i),d=r*Math.sin(i),h=2*Math.asin(Math.sqrt(Me(n-t)+o*r*Me(i-e))),p=1/Math.sin(h),f=h?function(e){var t=Math.sin(e*=h)*p,i=Math.sin(h-e)*p,n=i*l+t*u,o=i*c+t*d,r=i*a+t*s;return[Math.atan2(o,n)*De,Math.atan2(r,Math.sqrt(n*n+o*o))*De]}:function(){return[e*De,t*De]};return f.distance=h,f}(e[0]*Te,e[1]*Te,t[0]*Te,t[1]*Te)},M.geo.length=function(e){return Gn=0,M.geo.stream(e,co),Gn};var co={sphere:R,point:R,lineStart:function(){var a,s,l;function i(e,t){var i=Math.sin(t*=Te),n=Math.cos(t),o=F((e*=Te)-a),r=Math.cos(o);Gn+=Math.atan2(Math.sqrt((o=n*Math.sin(o))*o+(o=l*i-s*n*r)*o),s*i+l*n*r),a=e,s=i,l=n}co.point=function(e,t){a=e*Te,s=Math.sin(t*=Te),l=Math.cos(t),co.point=i},co.lineEnd=function(){co.point=co.lineEnd=R}},lineEnd:R,polygonStart:R,polygonEnd:R};function uo(r,a){function e(e,t){var i=Math.cos(e),n=Math.cos(t),o=r(i*n);return[o*n*Math.sin(e),o*Math.sin(t)]}return e.invert=function(e,t){var i=Math.sqrt(e*e+t*t),n=a(i),o=Math.sin(n),r=Math.cos(n);return[Math.atan2(e*o,i*r),Math.asin(i&&t*o/i)]},e}var ho=uo(function(e){return Math.sqrt(2/(1+e))},function(e){return 2*Math.asin(e/2)});(M.geo.azimuthalEqualArea=function(){return qn(ho)}).raw=ho;var po=uo(function(e){var t=Math.acos(e);return t&&t/Math.sin(t)},I);function fo(e,t){function n(e){return Math.tan(Ae/4+e/2)}var i=Math.cos(e),o=e===t?Math.sin(e):Math.log(i/Math.cos(t))/Math.log(n(t)/n(e)),r=i*Math.pow(n(e),o)/o;if(!o)return vo;function a(e,t){0<r?t<-Se+Ce&&(t=-Se+Ce):Se-Ce<t&&(t=Se-Ce);var i=r/Math.pow(n(t),o);return[i*Math.sin(o*e),r-i*Math.cos(o*e)]}return a.invert=function(e,t){var i=r-t,n=ke(o)*Math.sqrt(e*e+i*i);return[Math.atan2(e,i)/o,2*Math.atan(Math.pow(r/n,1/o))-Se]},a}function go(e,t){var i=Math.cos(e),n=e===t?Math.sin(e):(i-Math.cos(t))/(t-e),o=i/n+e;if(F(n)<Ce)return Xn;function r(e,t){var i=o-t;return[i*Math.sin(n*e),o-i*Math.cos(n*e)]}return r.invert=function(e,t){var i=o-t;return[Math.atan2(e,i)/n,o-ke(n)*Math.sqrt(e*e+i*i)]},r}(M.geo.azimuthalEquidistant=function(){return qn(po)}).raw=po,(M.geo.conicConformal=function(){return xn(fo)}).raw=fo,(M.geo.conicEquidistant=function(){return xn(go)}).raw=go;var mo=uo(function(e){return 1/e},Math.atan);function vo(e,t){return[e,Math.log(Math.tan(Ae/4+t/2))]}function yo(e){var o,r=qn(e),a=r.scale,s=r.translate,l=r.clipExtent;return r.scale=function(){var e=a.apply(r,arguments);return e===r?o?r.clipExtent(null):r:e},r.translate=function(){var e=s.apply(r,arguments);return e===r?o?r.clipExtent(null):r:e},r.clipExtent=function(e){var t=l.apply(r,arguments);if(t===r){if(o=null==e){var i=Ae*a(),n=s();l([[n[0]-i,n[1]-i],[n[0]+i,n[1]+i]])}}else o&&(t=null);return t},r.clipExtent(null)}(M.geo.gnomonic=function(){return qn(mo)}).raw=mo,vo.invert=function(e,t){return[e,2*Math.atan(Math.exp(t))-Se]},(M.geo.mercator=function(){return yo(vo)}).raw=vo;var bo=uo(function(){return 1},Math.asin);(M.geo.orthographic=function(){return qn(bo)}).raw=bo;var wo=uo(function(e){return 1/(1+e)},function(e){return 2*Math.atan(e)});function Co(e,t){return[Math.log(Math.tan(Ae/4+t/2)),-e]}function _o(e){return e[0]}function Ao(e){return e[1]}function Eo(e){for(var t=e.length,i=[0,1],n=2,o=2;o<t;o++){for(;1<n&&Re(e[i[n-2]],e[i[n-1]],e[o])<=0;)--n;i[n++]=o}return i.slice(0,n)}function xo(e,t){return e[0]-t[0]||e[1]-t[1]}(M.geo.stereographic=function(){return qn(wo)}).raw=wo,Co.invert=function(e,t){return[-t,2*Math.atan(Math.exp(e))-Se]},(M.geo.transverseMercator=function(){var e=yo(Co),t=e.center,i=e.rotate;return e.center=function(e){return e?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return e?i([e[0],e[1],2<e.length?e[2]+90:90]):[(e=i())[0],e[1],e[2]-90]},i([0,0,90])}).raw=Co,M.geom={},M.geom.hull=function(e){var h=_o,p=Ao;if(arguments.length)return t(e);function t(e){if(e.length<3)return[];var t,i=ft(h),n=ft(p),o=e.length,r=[],a=[];for(t=0;t<o;t++)r.push([+i.call(this,e[t],t),+n.call(this,e[t],t),t]);for(r.sort(xo),t=0;t<o;t++)a.push([r[t][0],-r[t][1]]);var s=Eo(r),l=Eo(a),c=l[0]===s[0],u=l[l.length-1]===s[s.length-1],d=[];for(t=s.length-1;0<=t;--t)d.push(e[r[s[t]][2]]);for(t=+c;t<l.length-u;++t)d.push(e[r[l[t]][2]]);return d}return t.x=function(e){return arguments.length?(h=e,t):h},t.y=function(e){return arguments.length?(p=e,t):p},t},M.geom.polygon=function(e){return j(e,So),e};var So=M.geom.polygon.prototype=[];function To(e,t,i){return(i[0]-t[0])*(e[1]-t[1])<(i[1]-t[1])*(e[0]-t[0])}function Do(e,t,i,n){var o=e[0],r=i[0],a=t[0]-o,s=n[0]-r,l=e[1],c=i[1],u=t[1]-l,d=n[1]-c,h=(s*(l-c)-d*(o-r))/(d*a-s*u);return[o+h*a,l+h*u]}function ko(e){var t=e[0],i=e[e.length-1];return!(t[0]-i[0]||t[1]-i[1])}So.area=function(){for(var e,t=-1,i=this.length,n=this[i-1],o=0;++t<i;)e=n,n=this[t],o+=e[1]*n[0]-e[0]*n[1];return.5*o},So.centroid=function(e){var t,i,n=-1,o=this.length,r=0,a=0,s=this[o-1];for(arguments.length||(e=-1/(6*this.area()));++n<o;)t=s,s=this[n],i=t[0]*s[1]-s[0]*t[1],r+=(t[0]+s[0])*i,a+=(t[1]+s[1])*i;return[r*e,a*e]},So.clip=function(e){for(var t,i,n,o,r,a,s=ko(e),l=-1,c=this.length-ko(this),u=this[c-1];++l<c;){for(t=e.slice(),e.length=0,o=this[l],r=t[(n=t.length-s)-1],i=-1;++i<n;)To(a=t[i],u,o)?(To(r,u,o)||e.push(Do(r,a,u,o)),e.push(a)):To(r,u,o)&&e.push(Do(r,a,u,o)),r=a;s&&e.push(e[0]),u=o}return e};var Ro,Oo,No,Fo,Mo,Po=[],Io=[];function Lo(){ir(this),this.edge=this.site=this.circle=null}function Go(e){var t=Po.pop()||new Lo;return t.site=e,t}function $o(e){qo(e),No.remove(e),Po.push(e),ir(e)}function Bo(e){var t=e.circle,i=t.x,n=t.cy,o={x:i,y:n},r=e.P,a=e.N,s=[e];$o(e);for(var l=r;l.circle&&F(i-l.circle.x)<Ce&&F(n-l.circle.cy)<Ce;)r=l.P,s.unshift(l),$o(l),l=r;s.unshift(l),qo(l);for(var c=a;c.circle&&F(i-c.circle.x)<Ce&&F(n-c.circle.cy)<Ce;)a=c.N,s.push(c),$o(c),c=a;s.push(c),qo(c);var u,d=s.length;for(u=1;u<d;++u)c=s[u],l=s[u-1],Zo(c.edge,l.site,c.site,o);l=s[0],(c=s[d-1]).edge=Xo(l.site,c.site,null,o),Yo(l),Yo(c)}function jo(e){for(var t,i,n,o,r=e.x,a=e.y,s=No._;s;)if(n=Wo(s,a)-r,Ce<n)s=s.L;else{if(o=r-Ho(s,a),!(Ce<o)){-Ce<n?(t=s.P,i=s):-Ce<o?i=(t=s).N:t=i=s;break}if(!s.R){t=s;break}s=s.R}var l=Go(e);if(No.insert(t,l),t||i){if(t===i)return qo(t),i=Go(t.site),No.insert(l,i),l.edge=i.edge=Xo(t.site,l.site),Yo(t),void Yo(i);if(i){qo(t),qo(i);var c=t.site,u=c.x,d=c.y,h=e.x-u,p=e.y-d,f=i.site,g=f.x-u,m=f.y-d,v=2*(h*m-p*g),y=h*h+p*p,b=g*g+m*m,w={x:(m*y-p*b)/v+u,y:(h*b-g*y)/v+d};Zo(i.edge,c,f,w),l.edge=Xo(c,e,null,w),i.edge=Xo(e,f,null,w),Yo(t),Yo(i)}else l.edge=Xo(t.site,l.site)}}function Wo(e,t){var i=e.site,n=i.x,o=i.y,r=o-t;if(!r)return n;var a=e.P;if(!a)return-1/0;var s=(i=a.site).x,l=i.y,c=l-t;if(!c)return s;var u=s-n,d=1/r-1/c,h=u/c;return d?(-h+Math.sqrt(h*h-2*d*(u*u/(-2*c)-l+c/2+o-r/2)))/d+n:(n+s)/2}function Ho(e,t){var i=e.N;if(i)return Wo(i,t);var n=e.site;return n.y===t?n.x:1/0}function zo(e){this.site=e,this.edges=[]}function Vo(e,t){return t.angle-e.angle}function Uo(){ir(this),this.x=this.y=this.arc=this.site=this.cy=null}function Yo(e){var t=e.P,i=e.N;if(t&&i){var n=t.site,o=e.site,r=i.site;if(n!==r){var a=o.x,s=o.y,l=n.x-a,c=n.y-s,u=r.x-a,d=2*(l*(m=r.y-s)-c*u);if(!(-_e<=d)){var h=l*l+c*c,p=u*u+m*m,f=(m*h-c*p)/d,g=(l*p-u*h)/d,m=g+s,v=Io.pop()||new Uo;v.arc=e,v.site=o,v.x=f+a,v.y=m+Math.sqrt(f*f+g*g),v.cy=m,e.circle=v;for(var y=null,b=Mo._;b;)if(v.y<b.y||v.y===b.y&&v.x<=b.x){if(!b.L){y=b.P;break}b=b.L}else{if(!b.R){y=b;break}b=b.R}Mo.insert(y,v),y||(Fo=v)}}}}function qo(e){var t=e.circle;t&&(t.P||(Fo=t.N),Mo.remove(t),Io.push(t),ir(t),e.circle=null)}function Qo(e,t){var i=e.b;if(i)return!0;var n,o,r=e.a,a=t[0][0],s=t[1][0],l=t[0][1],c=t[1][1],u=e.l,d=e.r,h=u.x,p=u.y,f=d.x,g=d.y,m=(h+f)/2,v=(p+g)/2;if(g===p){if(m<a||s<=m)return;if(f<h){if(r){if(r.y>=c)return}else r={x:m,y:l};i={x:m,y:c}}else{if(r){if(r.y<l)return}else r={x:m,y:c};i={x:m,y:l}}}else if(o=v-(n=(h-f)/(g-p))*m,n<-1||1<n)if(f<h){if(r){if(r.y>=c)return}else r={x:(l-o)/n,y:l};i={x:(c-o)/n,y:c}}else{if(r){if(r.y<l)return}else r={x:(c-o)/n,y:c};i={x:(l-o)/n,y:l}}else if(p<g){if(r){if(r.x>=s)return}else r={x:a,y:n*a+o};i={x:s,y:n*s+o}}else{if(r){if(r.x<a)return}else r={x:s,y:n*s+o};i={x:a,y:n*a+o}}return e.a=r,e.b=i,!0}function Ko(e,t){this.l=e,this.r=t,this.a=this.b=null}function Xo(e,t,i,n){var o=new Ko(e,t);return Ro.push(o),i&&Zo(o,e,t,i),n&&Zo(o,t,e,n),Oo[e.i].edges.push(new er(o,e,t)),Oo[t.i].edges.push(new er(o,t,e)),o}function Jo(e,t,i){var n=new Ko(e,null);return n.a=t,n.b=i,Ro.push(n),n}function Zo(e,t,i,n){e.a||e.b?e.l===i?e.b=n:e.a=n:(e.a=n,e.l=t,e.r=i)}function er(e,t,i){var n=e.a,o=e.b;this.edge=e,this.site=t,this.angle=i?Math.atan2(i.y-t.y,i.x-t.x):e.l===t?Math.atan2(o.x-n.x,n.y-o.y):Math.atan2(n.x-o.x,o.y-n.y)}function tr(){this._=null}function ir(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function nr(e,t){var i=t,n=t.R,o=i.U;o?o.L===i?o.L=n:o.R=n:e._=n,n.U=o,i.U=n,i.R=n.L,i.R&&(i.R.U=i),n.L=i}function or(e,t){var i=t,n=t.L,o=i.U;o?o.L===i?o.L=n:o.R=n:e._=n,n.U=o,i.U=n,i.L=n.R,i.L&&(i.L.U=i),n.R=i}function rr(e){for(;e.L;)e=e.L;return e}function ar(e,t){var i,n,o,r=e.sort(sr).pop();for(Ro=[],Oo=new Array(e.length),No=new tr,Mo=new tr;;)if(o=Fo,r&&(!o||r.y<o.y||r.y===o.y&&r.x<o.x))r.x===i&&r.y===n||(Oo[r.i]=new zo(r),jo(r),i=r.x,n=r.y),r=e.pop();else{if(!o)break;Bo(o.arc)}t&&(function(e){for(var t,i=Ro,n=_n(e[0][0],e[0][1],e[1][0],e[1][1]),o=i.length;o--;)Qo(t=i[o],e)&&n(t)&&!(F(t.a.x-t.b.x)<Ce&&F(t.a.y-t.b.y)<Ce)||(t.a=t.b=null,i.splice(o,1))}(t),function(e){for(var t,i,n,o,r,a,s,l,c,u,d=e[0][0],h=e[1][0],p=e[0][1],f=e[1][1],g=Oo,m=g.length;m--;)if((r=g[m])&&r.prepare())for(l=(s=r.edges).length,a=0;a<l;)n=(u=s[a].end()).x,o=u.y,t=(c=s[++a%l].start()).x,i=c.y,(F(n-t)>Ce||F(o-i)>Ce)&&(s.splice(a,0,new er(Jo(r.site,u,F(n-d)<Ce&&Ce<f-o?{x:d,y:F(t-d)<Ce?i:f}:F(o-f)<Ce&&Ce<h-n?{x:F(i-f)<Ce?t:h,y:f}:F(n-h)<Ce&&Ce<o-p?{x:h,y:F(t-h)<Ce?i:p}:F(o-p)<Ce&&Ce<n-d?{x:F(i-p)<Ce?t:d,y:p}:null),r.site,null)),++l)}(t));var a={cells:Oo,edges:Ro};return No=Mo=Ro=Oo=null,a}function sr(e,t){return t.y-e.y||t.x-e.x}zo.prototype.prepare=function(){for(var e,t=this.edges,i=t.length;i--;)(e=t[i].edge).b&&e.a||t.splice(i,1);return t.sort(Vo),t.length},er.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},tr.prototype={insert:function(e,t){var i,n,o;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;i=e}else i=this._?(e=rr(this._),t.P=null,(t.N=e).P=e.L=t,e):(t.P=t.N=null,this._=t,null);for(t.L=t.R=null,t.U=i,t.C=!0,e=t;i&&i.C;)i===(n=i.U).L?(o=n.R)&&o.C?(i.C=o.C=!1,n.C=!0,e=n):(e===i.R&&(nr(this,i),i=(e=i).U),i.C=!1,n.C=!0,or(this,n)):(o=n.L)&&o.C?(i.C=o.C=!1,n.C=!0,e=n):(e===i.L&&(or(this,i),i=(e=i).U),i.C=!1,n.C=!0,nr(this,n)),i=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t,i,n,o=e.U,r=e.L,a=e.R;if(i=r?a?rr(a):r:a,o?o.L===e?o.L=i:o.R=i:this._=i,r&&a?(n=i.C,i.C=e.C,((i.L=r).U=i)!==a?(o=i.U,i.U=e.U,e=i.R,o.L=e,(i.R=a).U=i):(i.U=o,e=(o=i).R)):(n=e.C,e=i),e&&(e.U=o),!n)if(e&&e.C)e.C=!1;else{do{if(e===this._)break;if(e===o.L){if((t=o.R).C&&(t.C=!1,o.C=!0,nr(this,o),t=o.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,or(this,t),t=o.R),t.C=o.C,o.C=t.R.C=!1,nr(this,o),e=this._;break}}else if((t=o.L).C&&(t.C=!1,o.C=!0,or(this,o),t=o.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,nr(this,t),t=o.L),t.C=o.C,o.C=t.L.C=!1,or(this,o),e=this._;break}t.C=!0,o=(e=o).U}while(!e.C);e&&(e.C=!1)}}},M.geom.voronoi=function(e){var t=_o,i=Ao,n=t,o=i,u=lr;if(e)return r(e);function r(o){var r=new Array(o.length),a=u[0][0],s=u[0][1],l=u[1][0],c=u[1][1];return ar(d(o),u).cells.forEach(function(e,t){var i=e.edges,n=e.site;(r[t]=i.length?i.map(function(e){var t=e.start();return[t.x,t.y]}):n.x>=a&&n.x<=l&&n.y>=s&&n.y<=c?[[a,c],[l,c],[l,s],[a,s]]:[]).point=o[t]}),r}function d(e){return e.map(function(e,t){return{x:Math.round(n(e,t)/Ce)*Ce,y:Math.round(o(e,t)/Ce)*Ce,i:t}})}return r.links=function(t){return ar(d(t)).edges.filter(function(e){return e.l&&e.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},r.triangles=function(h){var p=[];return ar(d(h)).cells.forEach(function(e,t){for(var i,n,o,r,a=e.site,s=e.edges.sort(Vo),l=-1,c=s.length,u=s[c-1].edge,d=u.l===a?u.r:u.l;++l<c;)u,i=d,d=(u=s[l].edge).l===a?u.r:u.l,t<i.i&&t<d.i&&(o=i,r=d,((n=a).x-r.x)*(o.y-n.y)-(n.x-o.x)*(r.y-n.y)<0)&&p.push([h[t],h[i.i],h[d.i]])}),p},r.x=function(e){return arguments.length?(n=ft(t=e),r):t},r.y=function(e){return arguments.length?(o=ft(i=e),r):i},r.clipExtent=function(e){return arguments.length?(u=null==e?lr:e,r):u===lr?null:u},r.size=function(e){return arguments.length?r.clipExtent(e&&[[0,0],e]):u===lr?null:u&&u[1]},r};var lr=[[-1e6,-1e6],[1e6,1e6]];function cr(e){return e.x}function ur(e){return e.y}function dr(e,t){e=M.rgb(e),t=M.rgb(t);var i=e.r,n=e.g,o=e.b,r=t.r-i,a=t.g-n,s=t.b-o;return function(e){return"#"+st(Math.round(i+r*e))+st(Math.round(n+a*e))+st(Math.round(o+s*e))}}function hr(e,t){var i,n={},o={};for(i in e)i in t?n[i]=vr(e[i],t[i]):o[i]=e[i];for(i in t)i in e||(o[i]=t[i]);return function(e){for(i in n)o[i]=n[i](e);return o}}function pr(t,i){return t=+t,i=+i,function(e){return t*(1-e)+i*e}}function fr(e,n){var t,i,o,r=gr.lastIndex=mr.lastIndex=0,a=-1,s=[],l=[];for(e+="",n+="";(t=gr.exec(e))&&(i=mr.exec(n));)(o=i.index)>r&&(o=n.slice(r,o),s[a]?s[a]+=o:s[++a]=o),(t=t[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:pr(t,i)})),r=mr.lastIndex;return r<n.length&&(o=n.slice(r),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?(n=l[0].x,function(e){return n(e)+""}):function(){return n}:(n=l.length,function(e){for(var t,i=0;i<n;++i)s[(t=l[i]).i]=t.x(e);return s.join("")})}M.geom.delaunay=function(e){return M.geom.voronoi().triangles(e)},M.geom.quadtree=function(e,b,w,C,_){var A,E=_o,x=Ao;if(A=arguments.length)return E=cr,x=ur,3===A&&(_=w,C=b,w=b=0),t(e);function t(e){var t,i,n,o,r,a,s,l,c,u=ft(E),d=ft(x);if(null!=b)a=b,s=w,l=C,c=_;else if(l=c=-(a=s=1/0),i=[],n=[],r=e.length,A)for(o=0;o<r;++o)(t=e[o]).x<a&&(a=t.x),t.y<s&&(s=t.y),t.x>l&&(l=t.x),t.y>c&&(c=t.y),i.push(t.x),n.push(t.y);else for(o=0;o<r;++o){var h=+u(t=e[o],o),p=+d(t,o);h<a&&(a=h),p<s&&(s=p),l<h&&(l=h),c<p&&(c=p),i.push(h),n.push(p)}var f=l-a,g=c-s;function m(e,t,i,n,o,r,a,s){if(!isNaN(i)&&!isNaN(n))if(e.leaf){var l=e.x,c=e.y;if(null!=l)if(F(l-i)+F(c-n)<.01)v(e,t,i,n,o,r,a,s);else{var u=e.point;e.x=e.y=e.point=null,v(e,u,l,c,o,r,a,s),v(e,t,i,n,o,r,a,s)}else e.x=i,e.y=n,e.point=t}else v(e,t,i,n,o,r,a,s)}function v(e,t,i,n,o,r,a,s){var l=.5*(o+a),c=.5*(r+s),u=l<=i,d=c<=n,h=d<<1|u;e.leaf=!1,u?o=l:a=l,d?r=c:s=c,m(e=e.nodes[h]||(e.nodes[h]={leaf:!0,nodes:[],point:null,x:null,y:null}),t,i,n,o,r,a,s)}g<f?c=s+f:l=a+g;var y={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(e){m(y,e,+u(e,++o),+d(e,o),a,s,l,c)}};if(y.visit=function(e){!function e(t,i,n,o,r,a){if(!t(i,n,o,r,a)){var s=.5*(n+r),l=.5*(o+a),c=i.nodes;c[0]&&e(t,c[0],n,o,s,l),c[1]&&e(t,c[1],s,o,r,l),c[2]&&e(t,c[2],n,l,s,a),c[3]&&e(t,c[3],s,l,r,a)}}(e,y,a,s,l,c)},y.find=function(e){return function(e,m,v,y,b,w,C){var _,A=1/0;return function e(t,i,n,o,r){if(!(w<i||C<n||o<y||r<b)){if(a=t.point){var a,s=m-t.x,l=v-t.y,c=s*s+l*l;if(c<A){var u=Math.sqrt(A=c);y=m-u,b=v-u,w=m+u,C=v+u,_=a}}for(var d=t.nodes,h=.5*(i+o),p=.5*(n+r),f=(p<=v)<<1|h<=m,g=f+4;f<g;++f)if(t=d[3&f])switch(3&f){case 0:e(t,i,n,h,p);break;case 1:e(t,h,n,o,p);break;case 2:e(t,i,p,h,r);break;case 3:e(t,h,p,o,r)}}}(e,y,b,w,C),_}(y,e[0],e[1],a,s,l,c)},o=-1,null==b){for(;++o<r;)m(y,e[o],i[o],n[o],a,s,l,c);--o}else e.forEach(y.add);return i=n=e=t=null,y}return t.x=function(e){return arguments.length?(E=e,t):E},t.y=function(e){return arguments.length?(x=e,t):x},t.extent=function(e){return arguments.length?(null==e?b=w=C=_=null:(b=+e[0][0],w=+e[0][1],C=+e[1][0],_=+e[1][1]),t):null==b?null:[[b,w],[C,_]]},t.size=function(e){return arguments.length?(null==e?b=w=C=_=null:(b=w=0,C=+e[0],_=+e[1]),t):null==b?null:[C-b,_-w]},t},M.interpolateRgb=dr,M.interpolateObject=hr,M.interpolateNumber=pr,M.interpolateString=fr;var gr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,mr=new RegExp(gr.source,"g");function vr(e,t){for(var i,n=M.interpolators.length;0<=--n&&!(i=M.interpolators[n](e,t)););return i}function yr(e,t){var i,n=[],o=[],r=e.length,a=t.length,s=Math.min(e.length,t.length);for(i=0;i<s;++i)n.push(vr(e[i],t[i]));for(;i<r;++i)o[i]=e[i];for(;i<a;++i)o[i]=t[i];return function(e){for(i=0;i<s;++i)o[i]=n[i](e);return o}}M.interpolate=vr,M.interpolators=[function(e,t){var i=typeof t;return("string"==i?pt.has(t)||/^(#|rgb\(|hsl\()/.test(t)?dr:fr:t instanceof $e?dr:Array.isArray(t)?yr:"object"==i&&isNaN(t)?hr:pr)(e,t)}],M.interpolateArray=yr;function br(){return I}var wr=M.map({linear:br,poly:function(t){return function(e){return Math.pow(e,t)}},quad:function(){return Er},cubic:function(){return xr},sin:function(){return Tr},exp:function(){return Dr},circle:function(){return kr},elastic:function(t,i){var n;arguments.length<2&&(i=.45);n=arguments.length?i/Ee*Math.asin(1/t):(t=1,i/4);return function(e){return 1+t*Math.pow(2,-10*e)*Math.sin((e-n)*Ee/i)}},back:function(t){t=t||1.70158;return function(e){return e*e*((t+1)*e-t)}},bounce:function(){return Rr}}),Cr=M.map({in:I,out:_r,"in-out":Ar,"out-in":function(e){return Ar(_r(e))}});function _r(t){return function(e){return 1-t(1-e)}}function Ar(t){return function(e){return.5*(e<.5?t(2*e):2-t(2-2*e))}}function Er(e){return e*e}function xr(e){return e*e*e}function Sr(e){if(e<=0)return 0;if(1<=e)return 1;var t=e*e,i=t*e;return 4*(e<.5?i:3*(e-t)+i-.75)}function Tr(e){return 1-Math.cos(e*Se)}function Dr(e){return Math.pow(2,10*(e-1))}function kr(e){return 1-Math.sqrt(1-e*e)}function Rr(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function Or(t,i){return i-=t,function(e){return Math.round(t+i*e)}}function Nr(e){var t=[e.a,e.b],i=[e.c,e.d],n=Mr(t),o=Fr(t,i),r=Mr(function(e,t,i){return e[0]+=i*t[0],e[1]+=i*t[1],e}(i,t,-o))||0;t[0]*i[1]<i[0]*t[1]&&(t[0]*=-1,t[1]*=-1,n*=-1,o*=-1),this.rotate=(n?Math.atan2(t[1],t[0]):Math.atan2(-i[0],i[1]))*De,this.translate=[e.e,e.f],this.scale=[n,r],this.skew=r?Math.atan2(o,r)*De:0}function Fr(e,t){return e[0]*t[0]+e[1]*t[1]}function Mr(e){var t=Math.sqrt(Fr(e,e));return t&&(e[0]/=t,e[1]/=t),t}M.ease=function(e){var t=e.indexOf("-"),i=0<=t?e.slice(0,t):e,n=0<=t?e.slice(t+1):"in";return i=wr.get(i)||br,function(t){return function(e){return e<=0?0:1<=e?1:t(e)}}((n=Cr.get(n)||I)(i.apply(null,o.call(arguments,1))))},M.interpolateHcl=function(e,t){e=M.hcl(e),t=M.hcl(t);var i=e.h,n=e.c,o=e.l,r=t.h-i,a=t.c-n,s=t.l-o;isNaN(a)&&(a=0,n=isNaN(n)?t.c:n);isNaN(r)?(r=0,i=isNaN(i)?t.h:i):180<r?r-=360:r<-180&&(r+=360);return function(e){return Ve(i+r*e,n+a*e,o+s*e)+""}},M.interpolateHsl=function(e,t){e=M.hsl(e),t=M.hsl(t);var i=e.h,n=e.s,o=e.l,r=t.h-i,a=t.s-n,s=t.l-o;isNaN(a)&&(a=0,n=isNaN(n)?t.s:n);isNaN(r)?(r=0,i=isNaN(i)?t.h:i):180<r?r-=360:r<-180&&(r+=360);return function(e){return We(i+r*e,n+a*e,o+s*e)+""}},M.interpolateLab=function(e,t){e=M.lab(e),t=M.lab(t);var i=e.l,n=e.a,o=e.b,r=t.l-i,a=t.a-n,s=t.b-o;return function(e){return Je(i+r*e,n+a*e,o+s*e)+""}},M.interpolateRound=Or,M.transform=function(e){var i=b.createElementNS(M.ns.prefix.svg,"g");return(M.transform=function(e){if(null!=e){i.setAttribute("transform",e);var t=i.transform.baseVal.consolidate()}return new Nr(t?t.matrix:Pr)})(e)},Nr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Pr={a:1,b:0,c:0,d:1,e:0,f:0};function Ir(e,t){var n,o=[],r=[],i=M.transform(e),a=M.transform(t),s=i.translate,l=a.translate,c=i.rotate,u=a.rotate,d=i.skew,h=a.skew,p=i.scale,f=a.scale;return s[0]!=l[0]||s[1]!=l[1]?(o.push("translate(",null,",",null,")"),r.push({i:1,x:pr(s[0],l[0])},{i:3,x:pr(s[1],l[1])})):l[0]||l[1]?o.push("translate("+l+")"):o.push(""),c!=u?(180<c-u?u+=360:180<u-c&&(c+=360),r.push({i:o.push(o.pop()+"rotate(",null,")")-2,x:pr(c,u)})):u&&o.push(o.pop()+"rotate("+u+")"),d!=h?r.push({i:o.push(o.pop()+"skewX(",null,")")-2,x:pr(d,h)}):h&&o.push(o.pop()+"skewX("+h+")"),p[0]!=f[0]||p[1]!=f[1]?(n=o.push(o.pop()+"scale(",null,",",null,")"),r.push({i:n-4,x:pr(p[0],f[0])},{i:n-2,x:pr(p[1],f[1])})):1==f[0]&&1==f[1]||o.push(o.pop()+"scale("+f+")"),n=r.length,function(e){for(var t,i=-1;++i<n;)o[(t=r[i]).i]=t.x(e);return o.join("")}}function Lr(t,i){return i=(i-=t=+t)||1/i,function(e){return(e-t)/i}}function Gr(t,i){return i=(i-=t=+t)||1/i,function(e){return Math.max(0,Math.min(1,(e-t)/i))}}function $r(e){for(var t=e.source,i=e.target,n=function(e,t){if(e===t)return e;var i=Br(e),n=Br(t),o=i.pop(),r=n.pop(),a=null;for(;o===r;)a=o,o=i.pop(),r=n.pop();return a}(t,i),o=[t];t!==n;)t=t.parent,o.push(t);for(var r=o.length;i!==n;)o.splice(r,0,i),i=i.parent;return o}function Br(e){for(var t=[],i=e.parent;null!=i;)t.push(e),i=(e=i).parent;return t.push(e),t}function jr(e){e.fixed|=2}function Wr(e){e.fixed&=-7}function Hr(e){e.fixed|=4,e.px=e.x,e.py=e.y}function zr(e){e.fixed&=-5}M.interpolateTransform=Ir,M.layout={},M.layout.bundle=function(){return function(e){for(var t=[],i=-1,n=e.length;++i<n;)t.push($r(e[i]));return t}},M.layout.chord=function(){var m,v,y,b,w,C,_,t={},A=0;function e(){var e,t,i,n,o,r={},a=[],s=M.range(b),l=[];for(m=[],v=[],e=0,n=-1;++n<b;){for(t=0,o=-1;++o<b;)t+=y[n][o];a.push(t),l.push(M.range(b)),e+=t}for(w&&s.sort(function(e,t){return w(a[e],a[t])}),C&&l.forEach(function(e,i){e.sort(function(e,t){return C(y[i][e],y[i][t])})}),e=(Ee-A*b)/e,t=0,n=-1;++n<b;){for(i=t,o=-1;++o<b;){var c=s[n],u=l[c][o],d=y[c][u],h=t,p=t+=d*e;r[c+"-"+u]={index:c,subindex:u,startAngle:h,endAngle:p,value:d}}v[c]={index:c,startAngle:i,endAngle:t,value:(t-i)/e},t+=A}for(n=-1;++n<b;)for(o=n-1;++o<b;){var f=r[n+"-"+o],g=r[o+"-"+n];(f.value||g.value)&&m.push(f.value<g.value?{source:g,target:f}:{source:f,target:g})}_&&E()}function E(){m.sort(function(e,t){return _((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}return t.matrix=function(e){return arguments.length?(b=(y=e)&&y.length,m=v=null,t):y},t.padding=function(e){return arguments.length?(A=e,m=v=null,t):A},t.sortGroups=function(e){return arguments.length?(w=e,m=v=null,t):w},t.sortSubgroups=function(e){return arguments.length?(C=e,m=null,t):C},t.sortChords=function(e){return arguments.length?(_=e,m&&E(),t):_},t.chords=function(){return m||e(),m},t.groups=function(){return v||e(),v},t},M.layout.force=function(){var e,d,h,p,f,o={},g=M.dispatch("start","tick","end"),m=[1,1],v=.9,r=Vr,a=Ur,y=-30,u=Yr,b=.1,w=.64,C=[],_=[];function A(c){return function(e,t,i,n){if(e.point!==c){var o=e.cx-c.x,r=e.cy-c.y,a=n-t,s=o*o+r*r;if(a*a/w<s){if(s<u){var l=e.charge/s;c.px-=o*l,c.py-=r*l}return!0}if(e.point&&s&&s<u){l=e.pointCharge/s;c.px-=o*l,c.py-=r*l}}return!e.charge}}function t(e){e.px=M.event.x,e.py=M.event.y,o.resume()}return o.tick=function(){if((d*=.99)<.005)return g.end({type:"end",alpha:d=0}),!0;var e,t,i,n,o,r,a,s,l,c=C.length,u=_.length;for(t=0;t<u;++t)n=(i=_[t]).source,(r=(s=(o=i.target).x-n.x)*s+(l=o.y-n.y)*l)&&(s*=r=d*p[t]*((r=Math.sqrt(r))-h[t])/r,l*=r,o.x-=s*(a=n.weight/(o.weight+n.weight)),o.y-=l*a,n.x+=s*(a=1-a),n.y+=l*a);if((a=d*b)&&(s=m[0]/2,l=m[1]/2,t=-1,a))for(;++t<c;)(i=C[t]).x+=(s-i.x)*a,i.y+=(l-i.y)*a;if(y)for(!function e(t,i,n){var o=0,r=0;t.charge=0;if(!t.leaf)for(var a,s=t.nodes,l=s.length,c=-1;++c<l;)null!=(a=s[c])&&(e(a,i,n),t.charge+=a.charge,o+=a.charge*a.cx,r+=a.charge*a.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var u=i*n[t.point.index];t.charge+=t.pointCharge=u,o+=u*t.point.x,r+=u*t.point.y}t.cx=o/t.charge;t.cy=r/t.charge}(e=M.geom.quadtree(C),d,f),t=-1;++t<c;)(i=C[t]).fixed||e.visit(A(i));for(t=-1;++t<c;)(i=C[t]).fixed?(i.x=i.px,i.y=i.py):(i.x-=(i.px-(i.px=i.x))*v,i.y-=(i.py-(i.py=i.y))*v);g.tick({type:"tick",alpha:d})},o.nodes=function(e){return arguments.length?(C=e,o):C},o.links=function(e){return arguments.length?(_=e,o):_},o.size=function(e){return arguments.length?(m=e,o):m},o.linkDistance=function(e){return arguments.length?(r="function"==typeof e?e:+e,o):r},o.distance=o.linkDistance,o.linkStrength=function(e){return arguments.length?(a="function"==typeof e?e:+e,o):a},o.friction=function(e){return arguments.length?(v=+e,o):v},o.charge=function(e){return arguments.length?(y="function"==typeof e?e:+e,o):y},o.chargeDistance=function(e){return arguments.length?(u=e*e,o):Math.sqrt(u)},o.gravity=function(e){return arguments.length?(b=+e,o):b},o.theta=function(e){return arguments.length?(w=e*e,o):Math.sqrt(w)},o.alpha=function(e){return arguments.length?(e=+e,d?d=0<e?e:0:0<e&&(g.start({type:"start",alpha:d=e}),M.timer(o.tick)),o):d},o.start=function(){var s,l,e,c=C.length,u=_.length,t=m[0],i=m[1];for(s=0;s<c;++s)(e=C[s]).index=s,e.weight=0;for(s=0;s<u;++s)"number"==typeof(e=_[s]).source&&(e.source=C[e.source]),"number"==typeof e.target&&(e.target=C[e.target]),++e.source.weight,++e.target.weight;for(s=0;s<c;++s)e=C[s],isNaN(e.x)&&(e.x=n("x",t)),isNaN(e.y)&&(e.y=n("y",i)),isNaN(e.px)&&(e.px=e.x),isNaN(e.py)&&(e.py=e.y);if(h=[],"function"==typeof r)for(s=0;s<u;++s)h[s]=+r.call(this,_[s],s);else for(s=0;s<u;++s)h[s]=r;if(p=[],"function"==typeof a)for(s=0;s<u;++s)p[s]=+a.call(this,_[s],s);else for(s=0;s<u;++s)p[s]=a;if(f=[],"function"==typeof y)for(s=0;s<c;++s)f[s]=+y.call(this,C[s],s);else for(s=0;s<c;++s)f[s]=y;function n(e,t){if(!l){for(l=new Array(c),r=0;r<c;++r)l[r]=[];for(r=0;r<u;++r){var i=_[r];l[i.source.index].push(i.target),l[i.target.index].push(i.source)}}for(var n,o=l[s],r=-1,a=o.length;++r<a;)if(!isNaN(n=o[r][e]))return n;return Math.random()*t}return o.resume()},o.resume=function(){return o.alpha(.1)},o.stop=function(){return o.alpha(0)},o.drag=function(){if(e=e||M.behavior.drag().origin(I).on("dragstart.force",jr).on("drag.force",t).on("dragend.force",Wr),!arguments.length)return e;this.on("mouseover.force",Hr).on("mouseout.force",zr).call(e)},M.rebind(o,g,"on")};var Vr=20,Ur=1,Yr=1/0;function qr(e,t){return M.rebind(e,t,"sort","children","value"),(e.nodes=e).links=ea,e}function Qr(e,t){for(var i=[e];null!=(e=i.pop());)if(t(e),(o=e.children)&&(n=o.length))for(var n,o;0<=--n;)i.push(o[n])}function Kr(e,t){for(var i=[e],n=[];null!=(e=i.pop());)if(n.push(e),(r=e.children)&&(o=r.length))for(var o,r,a=-1;++a<o;)i.push(r[a]);for(;null!=(e=n.pop());)t(e)}function Xr(e){return e.children}function Jr(e){return e.value}function Zr(e,t){return t.value-e.value}function ea(e){return M.merge(e.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}M.layout.hierarchy=function(){var s=Zr,l=Xr,c=Jr;function u(e){var t,i=[e],n=[];for(e.depth=0;null!=(t=i.pop());)if(n.push(t),(r=l.call(u,t,t.depth))&&(o=r.length)){for(var o,r,a;0<=--o;)i.push(a=r[o]),a.parent=t,a.depth=t.depth+1;c&&(t.value=0),t.children=r}else c&&(t.value=+c.call(u,t,t.depth)||0),delete t.children;return Kr(e,function(e){var t,i;s&&(t=e.children)&&t.sort(s),c&&(i=e.parent)&&(i.value+=e.value)}),n}return u.sort=function(e){return arguments.length?(s=e,u):s},u.children=function(e){return arguments.length?(l=e,u):l},u.value=function(e){return arguments.length?(c=e,u):c},u.revalue=function(e){return c&&(Qr(e,function(e){e.children&&(e.value=0)}),Kr(e,function(e){var t;e.children||(e.value=+c.call(u,e,e.depth)||0),(t=e.parent)&&(t.value+=e.value)})),e},u},M.layout.partition=function(){var n=M.layout.hierarchy(),o=[1,1];function t(e,t){var i=n.call(this,e,t);return function e(t,i,n,o){var r=t.children;if(t.x=i,t.y=t.depth*o,t.dx=n,t.dy=o,r&&(a=r.length)){var a,s,l,c=-1;for(n=t.value?n/t.value:0;++c<a;)e(s=r[c],i,l=s.value*n,o),i+=l}}(i[0],0,o[0],o[1]/function e(t){var i=t.children,n=0;if(i&&(o=i.length))for(var o,r=-1;++r<o;)n=Math.max(n,e(i[r]));return 1+n}(i[0])),i}return t.size=function(e){return arguments.length?(o=e,t):o},qr(t,n)},M.layout.pie=function(){var d=Number,h=ta,p=0,f=Ee,g=0;function m(i){var t,e=i.length,n=i.map(function(e,t){return+d.call(m,e,t)}),o=+("function"==typeof p?p.apply(this,arguments):p),r=("function"==typeof f?f.apply(this,arguments):f)-o,a=Math.min(Math.abs(r)/e,+("function"==typeof g?g.apply(this,arguments):g)),s=a*(r<0?-1:1),l=(r-e*s)/M.sum(n),c=M.range(e),u=[];return null!=h&&c.sort(h===ta?function(e,t){return n[t]-n[e]}:function(e,t){return h(i[e],i[t])}),c.forEach(function(e){u[e]={data:i[e],value:t=n[e],startAngle:o,endAngle:o+=t*l+s,padAngle:a}}),u}return m.value=function(e){return arguments.length?(d=e,m):d},m.sort=function(e){return arguments.length?(h=e,m):h},m.startAngle=function(e){return arguments.length?(p=e,m):p},m.endAngle=function(e){return arguments.length?(f=e,m):f},m.padAngle=function(e){return arguments.length?(g=e,m):g},m};var ta={};function ia(e){return e.x}function na(e){return e.y}function oa(e,t,i){e.y0=t,e.y=i}M.layout.stack=function(){var d=I,h=sa,p=la,f=oa,g=ia,m=na;function v(e,t){if(!(r=e.length))return e;var i=e.map(function(e,t){return d.call(v,e,t)}),n=i.map(function(e){return e.map(function(e,t){return[g.call(v,e,t),m.call(v,e,t)]})}),o=h.call(v,n,t);i=M.permute(i,o),n=M.permute(n,o);var r,a,s,l,c=p.call(v,n,t),u=i[0].length;for(s=0;s<u;++s)for(f.call(v,i[0][s],l=c[s],n[0][s][1]),a=1;a<r;++a)f.call(v,i[a][s],l+=n[a-1][s][1],n[a][s][1]);return e}return v.values=function(e){return arguments.length?(d=e,v):d},v.order=function(e){return arguments.length?(h="function"==typeof e?e:ra.get(e)||sa,v):h},v.offset=function(e){return arguments.length?(p="function"==typeof e?e:aa.get(e)||la,v):p},v.x=function(e){return arguments.length?(g=e,v):g},v.y=function(e){return arguments.length?(m=e,v):m},v.out=function(e){return arguments.length?(f=e,v):f},v};var ra=M.map({"inside-out":function(e){var t,i,n=e.length,o=e.map(ca),r=e.map(ua),a=M.range(n).sort(function(e,t){return o[e]-o[t]}),s=0,l=0,c=[],u=[];for(t=0;t<n;++t)i=a[t],s<l?(s+=r[i],c.push(i)):(l+=r[i],u.push(i));return u.reverse().concat(c)},reverse:function(e){return M.range(e.length).reverse()},default:sa}),aa=M.map({silhouette:function(e){var t,i,n,o=e.length,r=e[0].length,a=[],s=0,l=[];for(i=0;i<r;++i){for(n=t=0;t<o;t++)n+=e[t][i][1];s<n&&(s=n),a.push(n)}for(i=0;i<r;++i)l[i]=(s-a[i])/2;return l},wiggle:function(e){var t,i,n,o,r,a,s,l,c,u=e.length,d=e[0],h=d.length,p=[];for(p[0]=l=c=0,i=1;i<h;++i){for(o=t=0;t<u;++t)o+=e[t][i][1];for(r=t=0,s=d[i][0]-d[i-1][0];t<u;++t){for(n=0,a=(e[t][i][1]-e[t][i-1][1])/(2*s);n<t;++n)a+=(e[n][i][1]-e[n][i-1][1])/s;r+=a*e[t][i][1]}p[i]=l-=o?r/o*s:0,l<c&&(c=l)}for(i=0;i<h;++i)p[i]-=c;return p},expand:function(e){var t,i,n,o=e.length,r=e[0].length,a=1/o,s=[];for(i=0;i<r;++i){for(n=t=0;t<o;t++)n+=e[t][i][1];if(n)for(t=0;t<o;t++)e[t][i][1]/=n;else for(t=0;t<o;t++)e[t][i][1]=a}for(i=0;i<r;++i)s[i]=0;return s},zero:la});function sa(e){return M.range(e.length)}function la(e){for(var t=-1,i=e[0].length,n=[];++t<i;)n[t]=0;return n}function ca(e){for(var t,i=1,n=0,o=e[0][1],r=e.length;i<r;++i)(t=e[i][1])>o&&(n=i,o=t);return n}function ua(e){return e.reduce(da,0)}function da(e,t){return e+t[1]}function ha(e,t){return pa(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function pa(e,t){for(var i=-1,n=+e[0],o=(e[1]-n)/t,r=[];++i<=t;)r[i]=o*i+n;return r}function fa(e){return[M.min(e),M.max(e)]}function ga(e,t){return e.value-t.value}function ma(e,t){var i=e._pack_next;(e._pack_next=t)._pack_prev=e,(t._pack_next=i)._pack_prev=t}function va(e,t){(e._pack_next=t)._pack_prev=e}function ya(e,t){var i=t.x-e.x,n=t.y-e.y,o=e.r+t.r;return i*i+n*n<.999*o*o}function ba(e){if((t=e.children)&&(l=t.length)){var t,i,n,o,r,a,s,l,c=1/0,u=-1/0,d=1/0,h=-1/0;if(t.forEach(wa),(i=t[0]).x=-i.r,i.y=0,b(i),1<l&&((n=t[1]).x=n.r,n.y=0,b(n),2<l))for(_a(i,n,o=t[2]),b(o),ma(i,o),ma(i._pack_prev=o,n),n=i._pack_next,r=3;r<l;r++){_a(i,n,o=t[r]);var p=0,f=1,g=1;for(a=n._pack_next;a!==n;a=a._pack_next,f++)if(ya(a,o)){p=1;break}if(1==p)for(s=i._pack_prev;s!==a._pack_prev&&!ya(s,o);s=s._pack_prev,g++);p?(f<g||f==g&&n.r<i.r?va(i,n=a):va(i=s,n),r--):(ma(i,o),b(n=o))}var m=(c+u)/2,v=(d+h)/2,y=0;for(r=0;r<l;r++)(o=t[r]).x-=m,o.y-=v,y=Math.max(y,o.r+Math.sqrt(o.x*o.x+o.y*o.y));e.r=y,t.forEach(Ca)}function b(e){c=Math.min(e.x-e.r,c),u=Math.max(e.x+e.r,u),d=Math.min(e.y-e.r,d),h=Math.max(e.y+e.r,h)}}function wa(e){e._pack_next=e._pack_prev=e}function Ca(e){delete e._pack_next,delete e._pack_prev}function _a(e,t,i){var n=e.r+i.r,o=t.x-e.x,r=t.y-e.y;if(n&&(o||r)){var a=t.r+i.r,s=o*o+r*r,l=.5+((n*=n)-(a*=a))/(2*s),c=Math.sqrt(Math.max(0,2*a*(n+s)-(n-=s)*n-a*a))/(2*s);i.x=e.x+l*o+c*r,i.y=e.y+l*r-c*o}else i.x=e.x+n,i.y=e.y}function Aa(e,t){return e.parent==t.parent?1:2}function Ea(e){var t=e.children;return t.length?t[0]:e.t}function xa(e){var t,i=e.children;return(t=i.length)?i[t-1]:e.t}function Sa(e,t,i){var n=i/(t.i-e.i);t.c-=n,t.s+=i,e.c+=n,t.z+=i,t.m+=i}function Ta(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function Da(e,t){var i=e.x+t[3],n=e.y+t[0],o=e.dx-t[1]-t[3],r=e.dy-t[0]-t[2];return o<0&&(i+=o/2,o=0),r<0&&(n+=r/2,r=0),{x:i,y:n,dx:o,dy:r}}function ka(e){var t=e[0],i=e[e.length-1];return t<i?[t,i]:[i,t]}function Ra(e){return e.rangeExtent?e.rangeExtent():ka(e.range())}function Oa(e,t,i,n){var o=i(e[0],e[1]),r=n(t[0],t[1]);return function(e){return r(o(e))}}function Na(e,t){var i,n=0,o=e.length-1,r=e[n],a=e[o];return a<r&&(i=n,n=o,o=i,i=r,r=a,a=i),e[n]=t.floor(r),e[o]=t.ceil(a),e}M.layout.histogram=function(){var d=!0,h=Number,p=fa,f=ha;function i(e,t){for(var i,n,o=[],r=e.map(h,this),a=p.call(this,r,t),s=f.call(this,a,r,t),l=(t=-1,r.length),c=s.length-1,u=d?1:1/l;++t<c;)(i=o[t]=[]).dx=s[t+1]-(i.x=s[t]),i.y=0;if(0<c)for(t=-1;++t<l;)(n=r[t])>=a[0]&&n<=a[1]&&((i=o[M.bisect(s,n,1,c)-1]).y+=u,i.push(e[t]));return o}return i.value=function(e){return arguments.length?(h=e,i):h},i.range=function(e){return arguments.length?(p=ft(e),i):p},i.bins=function(t){return arguments.length?(f="number"==typeof t?function(e){return pa(e,t)}:ft(t),i):f},i.frequency=function(e){return arguments.length?(d=!!e,i):d},i},M.layout.pack=function(){var l,c=M.layout.hierarchy().sort(ga),u=0,d=[1,1];function t(e,t){var i=c.call(this,e,t),n=i[0],o=d[0],r=d[1],a=null==l?Math.sqrt:"function"==typeof l?l:function(){return l};if(n.x=n.y=0,Kr(n,function(e){e.r=+a(e.value)}),Kr(n,ba),u){var s=u*(l?1:Math.max(2*n.r/o,2*n.r/r))/2;Kr(n,function(e){e.r+=s}),Kr(n,ba),Kr(n,function(e){e.r-=s})}return function e(t,i,n,o){var r=t.children;t.x=i+=o*t.x;t.y=n+=o*t.y;t.r*=o;if(r)for(var a=-1,s=r.length;++a<s;)e(r[a],i,n,o)}(n,o/2,r/2,l?1:1/Math.max(2*n.r/o,2*n.r/r)),i}return t.size=function(e){return arguments.length?(d=e,t):d},t.radius=function(e){return arguments.length?(l=null==e||"function"==typeof e?e:+e,t):l},t.padding=function(e){return arguments.length?(u=+e,t):u},qr(t,c)},M.layout.tree=function(){var d=M.layout.hierarchy().sort(null).value(null),g=Aa,h=[1,1],p=null;function t(e,t){var i=d.call(this,e,t),n=i[0],o=function(e){var t,i={A:null,children:[e]},n=[i];for(;null!=(t=n.pop());)for(var o,r=t.children,a=0,s=r.length;a<s;++a)n.push((r[a]=o={_:r[a],parent:t,children:(o=r[a].children)&&o.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=o);return i.children[0]}(n);if(Kr(o,f),o.parent.m=-o.z,Qr(o,m),p)Qr(n,v);else{var r=n,a=n,s=n;Qr(n,function(e){e.x<r.x&&(r=e),e.x>a.x&&(a=e),e.depth>s.depth&&(s=e)});var l=g(r,a)/2-r.x,c=h[0]/(a.x+g(a,r)/2+l),u=h[1]/(s.depth||1);Qr(n,function(e){e.x=(e.x+l)*c,e.y=e.depth*u})}return i}function f(e){var t=e.children,i=e.parent.children,n=e.i?i[e.i-1]:null;if(t.length){!function(e){var t,i=0,n=0,o=e.children,r=o.length;for(;0<=--r;)(t=o[r]).z+=i,t.m+=i,i+=t.s+(n+=t.c)}(e);var o=(t[0].z+t[t.length-1].z)/2;n?(e.z=n.z+g(e._,n._),e.m=e.z-o):e.z=o}else n&&(e.z=n.z+g(e._,n._));e.parent.A=function(e,t,i){if(t){for(var n,o=e,r=e,a=t,s=o.parent.children[0],l=o.m,c=r.m,u=a.m,d=s.m;a=xa(a),o=Ea(o),a&&o;)s=Ea(s),(r=xa(r)).a=e,0<(n=a.z+u-o.z-l+g(a._,o._))&&(Sa((p=e,f=i,(h=a).a.parent===p.parent?h.a:f),e,n),l+=n,c+=n),u+=a.m,l+=o.m,d+=s.m,c+=r.m;a&&!xa(r)&&(r.t=a,r.m+=u-c),o&&!Ea(s)&&(s.t=o,s.m+=l-d,i=e)}var h,p,f;return i}(e,n,e.parent.A||i[0])}function m(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function v(e){e.x*=h[0],e.y=e.depth*h[1]}return t.separation=function(e){return arguments.length?(g=e,t):g},t.size=function(e){return arguments.length?(p=null==(h=e)?v:null,t):p?null:h},t.nodeSize=function(e){return arguments.length?(p=null==(h=e)?null:v,t):p?h:null},qr(t,d)},M.layout.cluster=function(){var u=M.layout.hierarchy().sort(null).value(null),d=Aa,h=[1,1],p=!1;function t(e,t){var i,n=u.call(this,e,t),o=n[0],r=0;Kr(o,function(e){var t=e.children;t&&t.length?(e.x=function(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}(t),e.y=function(e){return 1+M.max(e,function(e){return e.y})}(t)):(e.x=i?r+=d(e,i):0,e.y=0,i=e)});var a=function e(t){var i=t.children;return i&&i.length?e(i[0]):t}(o),s=function e(t){var i,n=t.children;return n&&(i=n.length)?e(n[i-1]):t}(o),l=a.x-d(a,s)/2,c=s.x+d(s,a)/2;return Kr(o,p?function(e){e.x=(e.x-o.x)*h[0],e.y=(o.y-e.y)*h[1]}:function(e){e.x=(e.x-l)/(c-l)*h[0],e.y=(1-(o.y?e.y/o.y:1))*h[1]}),n}return t.separation=function(e){return arguments.length?(d=e,t):d},t.size=function(e){return arguments.length?(p=null==(h=e),t):p?null:h},t.nodeSize=function(e){return arguments.length?(p=null!=(h=e),t):p?h:null},qr(t,u)},M.layout.treemap=function(){var n,o=M.layout.hierarchy(),u=Math.round,r=[1,1],a=null,d=Ta,s=!1,h="squarify",l=.5*(1+Math.sqrt(5));function p(e,t){for(var i,n,o=-1,r=e.length;++o<r;)n=(i=e[o]).value*(t<0?0:t),i.area=isNaN(n)||n<=0?0:n}function f(e){var t=e.children;if(t&&t.length){var i,n,o,r=d(e),a=[],s=t.slice(),l=1/0,c="slice"===h?r.dx:"dice"===h?r.dy:"slice-dice"===h?1&e.depth?r.dy:r.dx:Math.min(r.dx,r.dy);for(p(s,r.dx*r.dy/e.value),a.area=0;0<(o=s.length);)a.push(i=s[o-1]),a.area+=i.area,l="squarify"!==h||(n=g(a,c))<=l?(s.pop(),n):(a.area-=a.pop().area,m(a,c,r,!1),c=Math.min(r.dx,r.dy),a.length=a.area=0,1/0);a.length&&(m(a,c,r,!0),a.length=a.area=0),t.forEach(f)}}function c(e){var t=e.children;if(t&&t.length){var i,n=d(e),o=t.slice(),r=[];for(p(o,n.dx*n.dy/e.value),r.area=0;i=o.pop();)r.push(i),r.area+=i.area,null!=i.z&&(m(r,i.z?n.dx:n.dy,n,!o.length),r.length=r.area=0);t.forEach(c)}}function g(e,t){for(var i,n=e.area,o=0,r=1/0,a=-1,s=e.length;++a<s;)(i=e[a].area)&&(i<r&&(r=i),o<i&&(o=i));return t*=t,(n*=n)?Math.max(t*o*l/n,n/(t*r*l)):1/0}function m(e,t,i,n){var o,r=-1,a=e.length,s=i.x,l=i.y,c=t?u(e.area/t):0;if(t==i.dx){for((n||c>i.dy)&&(c=i.dy);++r<a;)(o=e[r]).x=s,o.y=l,o.dy=c,s+=o.dx=Math.min(i.x+i.dx-s,c?u(o.area/c):0);o.z=!0,o.dx+=i.x+i.dx-s,i.y+=c,i.dy-=c}else{for((n||c>i.dx)&&(c=i.dx);++r<a;)(o=e[r]).x=s,o.y=l,o.dx=c,l+=o.dy=Math.min(i.y+i.dy-l,c?u(o.area/c):0);o.z=!1,o.dy+=i.y+i.dy-l,i.x+=c,i.dx-=c}}function v(e){var t=n||o(e),i=t[0];return i.x=0,i.y=0,i.dx=r[0],i.dy=r[1],n&&o.revalue(i),p([i],i.dx*i.dy/i.value),(n?c:f)(i),s&&(n=t),t}return v.size=function(e){return arguments.length?(r=e,v):r},v.padding=function(i){if(!arguments.length)return a;function e(e){return Da(e,i)}var t;return d=null==(a=i)?Ta:"function"==(t=typeof i)?function(e){var t=i.call(v,e,e.depth);return null==t?Ta(e):Da(e,"number"==typeof t?[t,t,t,t]:t)}:("number"==t&&(i=[i,i,i,i]),e),v},v.round=function(e){return arguments.length?(u=e?Math.round:Number,v):u!=Number},v.sticky=function(e){return arguments.length?(s=e,n=null,v):s},v.ratio=function(e){return arguments.length?(l=e,v):l},v.mode=function(e){return arguments.length?(h=e+"",v):h},qr(v,o)},M.random={normal:function(n,o){var e=arguments.length;return e<2&&(o=1),e<1&&(n=0),function(){for(var e,t,i;!(i=(e=2*Math.random()-1)*e+(t=2*Math.random()-1)*t)||1<i;);return n+o*e*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var e=M.random.normal.apply(M,arguments);return function(){return Math.exp(e())}},bates:function(e){var t=M.random.irwinHall(e);return function(){return t()/e}},irwinHall:function(i){return function(){for(var e=0,t=0;t<i;t++)e+=Math.random();return e}}},M.scale={};var Fa={floor:I,ceil:I};function Ma(i,e,t,n){var o=[],r=[],a=0,s=Math.min(i.length,e.length)-1;for(i[s]<i[0]&&(i=i.slice().reverse(),e=e.slice().reverse());++a<=s;)o.push(t(i[a-1],i[a])),r.push(n(e[a-1],e[a]));return function(e){var t=M.bisect(i,e,1,s)-1;return r[t](o[t](e))}}function Pa(e,t){return M.rebind(e,t,"range","rangeRound","interpolate","clamp")}function Ia(e,t){return Na(e,function(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:Fa}(La(e,t)[2]))}function La(e,t){null==t&&(t=10);var i=ka(e),n=i[1]-i[0],o=Math.pow(10,Math.floor(Math.log(n/t)/Math.LN10)),r=t/n*o;return r<=.15?o*=10:r<=.35?o*=5:r<=.75&&(o*=2),i[0]=Math.ceil(i[0]/o)*o,i[1]=Math.floor(i[1]/o)*o+.5*o,i[2]=o,i}function Ga(e,t){return M.range.apply(M,La(e,t))}function $a(e,t,i){var n=La(e,t);if(i){var o=Dt.exec(i);if(o.shift(),"s"===o[8]){var r=M.formatPrefix(Math.max(F(n[0]),F(n[1])));return o[7]||(o[7]="."+ja(r.scale(n[2]))),o[8]="f",i=M.format(o.join("")),function(e){return i(r.scale(e))+r.symbol}}o[7]||(o[7]="."+function(e,t){var i=ja(t[2]);return e in Ba?Math.abs(i-ja(Math.max(F(t[0]),F(t[1]))))+ +("e"!==e):i-2*("%"===e)}(o[8],n)),i=o.join("")}else i=",."+ja(n[2])+"f";return M.format(i)}M.scale.linear=function(){return function e(i,n,o,r){var a,s;function t(){var e=2<Math.min(i.length,n.length)?Ma:Oa,t=r?Gr:Lr;return a=e(i,n,t,o),s=e(n,i,t,vr),l}function l(e){return a(e)}l.invert=function(e){return s(e)};l.domain=function(e){return arguments.length?(i=e.map(Number),t()):i};l.range=function(e){return arguments.length?(n=e,t()):n};l.rangeRound=function(e){return l.range(e).interpolate(Or)};l.clamp=function(e){return arguments.length?(r=e,t()):r};l.interpolate=function(e){return arguments.length?(o=e,t()):o};l.ticks=function(e){return Ga(i,e)};l.tickFormat=function(e,t){return $a(i,e,t)};l.nice=function(e){return Ia(i,e),t()};l.copy=function(){return e(i,n,o,r)};return t()}([0,1],[0,1],vr,!1)};var Ba={s:1,g:1,p:1,r:1,e:1};function ja(e){return-Math.floor(Math.log(e)/Math.LN10+.01)}M.scale.log=function(){return function e(t,l,c,u){function d(e){return(c?Math.log(e<0?0:e):-Math.log(0<e?0:-e))/Math.log(l)}function h(e){return c?Math.pow(l,e):-Math.pow(l,-e)}function r(e){return t(d(e))}r.invert=function(e){return h(t.invert(e))};r.domain=function(e){return arguments.length?(c=0<=e[0],t.domain((u=e.map(Number)).map(d)),r):u};r.base=function(e){return arguments.length?(l=+e,t.domain(u.map(d)),r):l};r.nice=function(){var e=Na(u.map(d),c?Math:Ha);return t.domain(e),u=e.map(h),r};r.ticks=function(){var e=ka(u),t=[],i=e[0],n=e[1],o=Math.floor(d(i)),r=Math.ceil(d(n)),a=l%1?2:l;if(isFinite(r-o)){if(c){for(;o<r;o++)for(var s=1;s<a;s++)t.push(h(o)*s);t.push(h(o))}else for(t.push(h(o));o++<r;)for(var s=a-1;0<s;s--)t.push(h(o)*s);for(o=0;t[o]<i;o++);for(r=t.length;t[r-1]>n;r--);t=t.slice(o,r)}return t};r.tickFormat=function(e,t){if(!arguments.length)return Wa;arguments.length<2?t=Wa:"function"!=typeof t&&(t=M.format(t));var i,n=Math.max(.1,e/r.ticks().length),o=c?(i=1e-12,Math.ceil):(i=-1e-12,Math.floor);return function(e){return e/h(o(d(e)+i))<=n?t(e):""}};r.copy=function(){return e(t.copy(),l,c,u)};return Pa(r,t)}(M.scale.linear().domain([0,1]),10,!0,[1,10])};var Wa=M.format(".0e"),Ha={floor:function(e){return-Math.ceil(-e)},ceil:function(e){return-Math.floor(-e)}};function za(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}M.scale.pow=function(){return function e(t,i,n){var o=za(i),r=za(1/i);function a(e){return t(o(e))}a.invert=function(e){return r(t.invert(e))};a.domain=function(e){return arguments.length?(t.domain((n=e.map(Number)).map(o)),a):n};a.ticks=function(e){return Ga(n,e)};a.tickFormat=function(e,t){return $a(n,e,t)};a.nice=function(e){return a.domain(Ia(n,e))};a.exponent=function(e){return arguments.length?(o=za(i=e),r=za(1/i),t.domain(n.map(o)),a):i};a.copy=function(){return e(t.copy(),i,n)};return Pa(a,t)}(M.scale.linear(),1,[0,1])},M.scale.sqrt=function(){return M.scale.pow().exponent(.5)},M.scale.ordinal=function(){return function e(s,l){var o,c,u;function d(e){return c[((o.get(e)||("range"===l.t?o.set(e,s.push(e)):NaN))-1)%c.length]}function h(t,i){return M.range(s.length).map(function(e){return t+i*e})}d.domain=function(e){if(!arguments.length)return s;s=[],o=new y;for(var t,i=-1,n=e.length;++i<n;)o.has(t=e[i])||o.set(t,s.push(t));return d[l.t].apply(d,l.a)};d.range=function(e){return arguments.length?(c=e,u=0,l={t:"range",a:arguments},d):c};d.rangePoints=function(e,t){arguments.length<2&&(t=0);var i=e[0],n=e[1],o=s.length<2?(i=(i+n)/2,0):(n-i)/(s.length-1+t);return c=h(i+o*t/2,o),u=0,l={t:"rangePoints",a:arguments},d};d.rangeRoundPoints=function(e,t){arguments.length<2&&(t=0);var i=e[0],n=e[1],o=s.length<2?(i=n=Math.round((i+n)/2),0):(n-i)/(s.length-1+t)|0;return c=h(i+Math.round(o*t/2+(n-i-(s.length-1+t)*o)/2),o),u=0,l={t:"rangeRoundPoints",a:arguments},d};d.rangeBands=function(e,t,i){arguments.length<2&&(t=0),arguments.length<3&&(i=t);var n=e[1]<e[0],o=e[n-0],r=e[1-n],a=(r-o)/(s.length-t+2*i);return c=h(o+a*i,a),n&&c.reverse(),u=a*(1-t),l={t:"rangeBands",a:arguments},d};d.rangeRoundBands=function(e,t,i){arguments.length<2&&(t=0),arguments.length<3&&(i=t);var n=e[1]<e[0],o=e[n-0],r=e[1-n],a=Math.floor((r-o)/(s.length-t+2*i));return c=h(o+Math.round((r-o-(s.length-t)*a)/2),a),n&&c.reverse(),u=Math.round(a*(1-t)),l={t:"rangeRoundBands",a:arguments},d};d.rangeBand=function(){return u};d.rangeExtent=function(){return ka(l.a[0])};d.copy=function(){return e(s,l)};return d.domain(s)}([],{t:"range",a:[[]]})},M.scale.category10=function(){return M.scale.ordinal().range(Va)},M.scale.category20=function(){return M.scale.ordinal().range(Ua)},M.scale.category20b=function(){return M.scale.ordinal().range(Ya)},M.scale.category20c=function(){return M.scale.ordinal().range(qa)};var Va=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(rt),Ua=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(rt),Ya=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(rt),qa=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(rt);function Qa(){return 0}M.scale.quantile=function(){return function e(i,n){var o;function t(){var e=0,t=n.length;for(o=[];++e<t;)o[e-1]=M.quantile(i,e/t);return r}function r(e){if(!isNaN(e=+e))return n[M.bisect(o,e)]}r.domain=function(e){return arguments.length?(i=e.map(c).filter(u).sort(l),t()):i};r.range=function(e){return arguments.length?(n=e,t()):n};r.quantiles=function(){return o};r.invertExtent=function(e){return(e=n.indexOf(e))<0?[NaN,NaN]:[0<e?o[e-1]:i[0],e<o.length?o[e]:i[i.length-1]]};r.copy=function(){return e(i,n)};return t()}([],[])},M.scale.quantize=function(){return function e(t,i,n){var o,r;function a(e){return n[Math.max(0,Math.min(r,Math.floor(o*(e-t))))]}function s(){return o=n.length/(i-t),r=n.length-1,a}a.domain=function(e){return arguments.length?(t=+e[0],i=+e[e.length-1],s()):[t,i]};a.range=function(e){return arguments.length?(n=e,s()):n};a.invertExtent=function(e){return[e=(e=n.indexOf(e))<0?NaN:e/o+t,e+1/o]};a.copy=function(){return e(t,i,n)};return s()}(0,1,[0,1])},M.scale.threshold=function(){return function e(t,i){function n(e){if(e<=e)return i[M.bisect(t,e)]}n.domain=function(e){return arguments.length?(t=e,n):t};n.range=function(e){return arguments.length?(i=e,n):i};n.invertExtent=function(e){return e=i.indexOf(e),[t[e-1],t[e]]};n.copy=function(){return e(t,i)};return n}([.5],[0,1])},M.scale.identity=function(){return function e(i){function t(e){return+e}t.invert=t;t.domain=t.range=function(e){return arguments.length?(i=e.map(t),t):i};t.ticks=function(e){return Ga(i,e)};t.tickFormat=function(e,t){return $a(i,e,t)};t.copy=function(){return e(i)};return t}([0,1])},M.svg={},M.svg.arc=function(){var G=Xa,$=Ja,B=Qa,j=Ka,W=Za,H=es,z=ts;function t(){var e=Math.max(0,+G.apply(this,arguments)),t=Math.max(0,+$.apply(this,arguments)),i=W.apply(this,arguments)-Se,n=H.apply(this,arguments)-Se,o=Math.abs(n-i),r=n<i?0:1;if(t<e&&(a=t,t=e,e=a),xe<=o)return V(t,r)+(e?V(e,1-r):"")+"Z";var a,s,l,c,u,d,h,p,f,g,m,v,y=0,b=0,w=[];if((c=(+z.apply(this,arguments)||0)/2)&&(l=j===Ka?Math.sqrt(e*e+t*t):+j.apply(this,arguments),r||(b*=-1),t&&(b=Ne(l/t*Math.sin(c))),e&&(y=Ne(l/e*Math.sin(c)))),t){u=t*Math.cos(i+b),d=t*Math.sin(i+b),h=t*Math.cos(n-b),p=t*Math.sin(n-b);var C=Math.abs(n-i-2*b)<=Ae?0:1;if(b&&is(u,d,h,p)===r^C){var _=(i+n)/2;u=t*Math.cos(_),d=t*Math.sin(_),h=p=null}}else u=d=0;if(e){f=e*Math.cos(n-y),g=e*Math.sin(n-y),m=e*Math.cos(i+y),v=e*Math.sin(i+y);var A=Math.abs(i-n+2*y)<=Ae?0:1;if(y&&is(f,g,m,v)===1-r^A){var E=(i+n)/2;f=e*Math.cos(E),g=e*Math.sin(E),m=v=null}}else f=g=0;if(.001<(a=Math.min(Math.abs(t-e)/2,+B.apply(this,arguments)))){s=e<t^r?0:1;var x=null==m?[f,g]:null==h?[u,d]:Do([u,d],[m,v],[h,p],[f,g]),S=u-x[0],T=d-x[1],D=h-x[0],k=p-x[1],R=1/Math.sin(Math.acos((S*D+T*k)/(Math.sqrt(S*S+T*T)*Math.sqrt(D*D+k*k)))/2),O=Math.sqrt(x[0]*x[0]+x[1]*x[1]);if(null!=h){var N=Math.min(a,(t-O)/(1+R)),F=ns(null==m?[f,g]:[m,v],[u,d],t,N,r),M=ns([h,p],[f,g],t,N,r);a===N?w.push("M",F[0],"A",N,",",N," 0 0,",s," ",F[1],"A",t,",",t," 0 ",1-r^is(F[1][0],F[1][1],M[1][0],M[1][1]),",",r," ",M[1],"A",N,",",N," 0 0,",s," ",M[0]):w.push("M",F[0],"A",N,",",N," 0 1,",s," ",M[0])}else w.push("M",u,",",d);if(null!=m){var P=Math.min(a,(e-O)/(R-1)),I=ns([u,d],[m,v],e,-P,r),L=ns([f,g],null==h?[u,d]:[h,p],e,-P,r);a===P?w.push("L",L[0],"A",P,",",P," 0 0,",s," ",L[1],"A",e,",",e," 0 ",r^is(L[1][0],L[1][1],I[1][0],I[1][1]),",",1-r," ",I[1],"A",P,",",P," 0 0,",s," ",I[0]):w.push("L",L[0],"A",P,",",P," 0 0,",s," ",I[0])}else w.push("L",f,",",g)}else w.push("M",u,",",d),null!=h&&w.push("A",t,",",t," 0 ",C,",",r," ",h,",",p),w.push("L",f,",",g),null!=m&&w.push("A",e,",",e," 0 ",A,",",1-r," ",m,",",v);return w.push("Z"),w.join("")}function V(e,t){return"M0,"+e+"A"+e+","+e+" 0 1,"+t+" 0,"+-e+"A"+e+","+e+" 0 1,"+t+" 0,"+e}return t.innerRadius=function(e){return arguments.length?(G=ft(e),t):G},t.outerRadius=function(e){return arguments.length?($=ft(e),t):$},t.cornerRadius=function(e){return arguments.length?(B=ft(e),t):B},t.padRadius=function(e){return arguments.length?(j=e==Ka?Ka:ft(e),t):j},t.startAngle=function(e){return arguments.length?(W=ft(e),t):W},t.endAngle=function(e){return arguments.length?(H=ft(e),t):H},t.padAngle=function(e){return arguments.length?(z=ft(e),t):z},t.centroid=function(){var e=(+G.apply(this,arguments)+ +$.apply(this,arguments))/2,t=(+W.apply(this,arguments)+ +H.apply(this,arguments))/2-Se;return[Math.cos(t)*e,Math.sin(t)*e]},t};var Ka="auto";function Xa(e){return e.innerRadius}function Ja(e){return e.outerRadius}function Za(e){return e.startAngle}function es(e){return e.endAngle}function ts(e){return e&&e.padAngle}function is(e,t,i,n){return 0<(e-i)*t-(t-n)*e?0:1}function ns(e,t,i,n,o){var r=e[0]-t[0],a=e[1]-t[1],s=(o?n:-n)/Math.sqrt(r*r+a*a),l=s*a,c=-s*r,u=e[0]+l,d=e[1]+c,h=t[0]+l,p=t[1]+c,f=(u+h)/2,g=(d+p)/2,m=h-u,v=p-d,y=m*m+v*v,b=i-n,w=u*p-h*d,C=(v<0?-1:1)*Math.sqrt(b*b*y-w*w),_=(w*v-m*C)/y,A=(-w*m-v*C)/y,E=(w*v+m*C)/y,x=(-w*m+v*C)/y,S=_-f,T=A-g,D=E-f,k=x-g;return D*D+k*k<S*S+T*T&&(_=E,A=x),[[_-l,A-c],[_*i/b,A*i/b]]}function os(c){var u=_o,d=Ao,h=pn,p=as,t=p.key,f=.7;function i(e){var t,i=[],n=[],o=-1,r=e.length,a=ft(u),s=ft(d);function l(){i.push("M",p(c(n),f))}for(;++o<r;)h.call(this,t=e[o],o)?n.push([+a.call(this,t,o),+s.call(this,t,o)]):n.length&&(l(),n=[]);return n.length&&l(),i.length?i.join(""):null}return i.x=function(e){return arguments.length?(u=e,i):u},i.y=function(e){return arguments.length?(d=e,i):d},i.defined=function(e){return arguments.length?(h=e,i):h},i.interpolate=function(e){return arguments.length?(t="function"==typeof e?p=e:(p=rs.get(e)||as).key,i):t},i.tension=function(e){return arguments.length?(f=e,i):f},i}M.svg.line=function(){return os(I)};var rs=M.map({linear:as,"linear-closed":function(e){return as(e)+"Z"},step:function(e){var t=0,i=e.length,n=e[0],o=[n[0],",",n[1]];for(;++t<i;)o.push("H",(n[0]+(n=e[t])[0])/2,"V",n[1]);1<i&&o.push("H",n[0]);return o.join("")},"step-before":ss,"step-after":ls,basis:ds,"basis-open":function(e){if(e.length<4)return as(e);var t,i=[],n=-1,o=e.length,r=[0],a=[0];for(;++n<3;)t=e[n],r.push(t[0]),a.push(t[1]);i.push(hs(gs,r)+","+hs(gs,a)),--n;for(;++n<o;)t=e[n],r.shift(),r.push(t[0]),a.shift(),a.push(t[1]),ms(i,r,a);return i.join("")},"basis-closed":function(e){var t,i,n=-1,o=e.length,r=o+4,a=[],s=[];for(;++n<4;)i=e[n%o],a.push(i[0]),s.push(i[1]);t=[hs(gs,a),",",hs(gs,s)],--n;for(;++n<r;)i=e[n%o],a.shift(),a.push(i[0]),s.shift(),s.push(i[1]),ms(t,a,s);return t.join("")},bundle:function(e,t){var i=e.length-1;if(i)for(var n,o,r=e[0][0],a=e[0][1],s=e[i][0]-r,l=e[i][1]-a,c=-1;++c<=i;)n=e[c],o=c/i,n[0]=t*n[0]+(1-t)*(r+o*s),n[1]=t*n[1]+(1-t)*(a+o*l);return ds(e)},cardinal:function(e,t){return e.length<3?as(e):e[0]+cs(e,us(e,t))},"cardinal-open":function(e,t){return e.length<4?as(e):e[1]+cs(e.slice(1,-1),us(e,t))},"cardinal-closed":function(e,t){return e.length<3?as(e):e[0]+cs((e.push(e[0]),e),us([e[e.length-2]].concat(e,[e[1]]),t))},monotone:function(e){return e.length<3?as(e):e[0]+cs(e,function(e){var t,i,n,o,r=[],a=function(e){var t=0,i=e.length-1,n=[],o=e[0],r=e[1],a=n[0]=vs(o,r);for(;++t<i;)n[t]=(a+(a=vs(o=r,r=e[t+1])))/2;return n[t]=a,n}(e),s=-1,l=e.length-1;for(;++s<l;)t=vs(e[s],e[s+1]),F(t)<Ce?a[s]=a[s+1]=0:(i=a[s]/t,n=a[s+1]/t,9<(o=i*i+n*n)&&(o=3*t/Math.sqrt(o),a[s]=o*i,a[s+1]=o*n));s=-1;for(;++s<=l;)o=(e[Math.min(l,s+1)][0]-e[Math.max(0,s-1)][0])/(6*(1+a[s]*a[s])),r.push([o||0,a[s]*o||0]);return r}(e))}});function as(e){return e.join("L")}function ss(e){for(var t=0,i=e.length,n=e[0],o=[n[0],",",n[1]];++t<i;)o.push("V",(n=e[t])[1],"H",n[0]);return o.join("")}function ls(e){for(var t=0,i=e.length,n=e[0],o=[n[0],",",n[1]];++t<i;)o.push("H",(n=e[t])[0],"V",n[1]);return o.join("")}function cs(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2)return as(e);var i=e.length!=t.length,n="",o=e[0],r=e[1],a=t[0],s=a,l=1;if(i&&(n+="Q"+(r[0]-2*a[0]/3)+","+(r[1]-2*a[1]/3)+","+r[0]+","+r[1],o=e[1],l=2),1<t.length){s=t[1],r=e[l],l++,n+="C"+(o[0]+a[0])+","+(o[1]+a[1])+","+(r[0]-s[0])+","+(r[1]-s[1])+","+r[0]+","+r[1];for(var c=2;c<t.length;c++,l++)r=e[l],s=t[c],n+="S"+(r[0]-s[0])+","+(r[1]-s[1])+","+r[0]+","+r[1]}if(i){var u=e[l];n+="Q"+(r[0]+2*s[0]/3)+","+(r[1]+2*s[1]/3)+","+u[0]+","+u[1]}return n}function us(e,t){for(var i,n=[],o=(1-t)/2,r=e[0],a=e[1],s=1,l=e.length;++s<l;)i=r,r=a,a=e[s],n.push([o*(a[0]-i[0]),o*(a[1]-i[1])]);return n}function ds(e){if(e.length<3)return as(e);var t=1,i=e.length,n=e[0],o=n[0],r=n[1],a=[o,o,o,(n=e[1])[0]],s=[r,r,r,n[1]],l=[o,",",r,"L",hs(gs,a),",",hs(gs,s)];for(e.push(e[i-1]);++t<=i;)n=e[t],a.shift(),a.push(n[0]),s.shift(),s.push(n[1]),ms(l,a,s);return e.pop(),l.push("L",n),l.join("")}function hs(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}rs.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var ps=[0,2/3,1/3,0],fs=[0,1/3,2/3,0],gs=[0,1/6,2/3,1/6];function ms(e,t,i){e.push("C",hs(ps,t),",",hs(ps,i),",",hs(fs,t),",",hs(fs,i),",",hs(gs,t),",",hs(gs,i))}function vs(e,t){return(t[1]-e[1])/(t[0]-e[0])}function ys(e){for(var t,i,n,o=-1,r=e.length;++o<r;)i=(t=e[o])[0],n=t[1]-Se,t[0]=i*Math.cos(n),t[1]=i*Math.sin(n);return e}function bs(f){var g=_o,m=_o,v=0,y=Ao,b=pn,w=as,t=w.key,C=w,_="L",A=.7;function i(e){var t,i,n,o=[],r=[],a=[],s=-1,l=e.length,c=ft(g),u=ft(v),d=g===m?function(){return i}:ft(m),h=v===y?function(){return n}:ft(y);function p(){o.push("M",w(f(a),A),_,C(f(r.reverse()),A),"Z")}for(;++s<l;)b.call(this,t=e[s],s)?(r.push([i=+c.call(this,t,s),n=+u.call(this,t,s)]),a.push([+d.call(this,t,s),+h.call(this,t,s)])):r.length&&(p(),r=[],a=[]);return r.length&&p(),o.length?o.join(""):null}return i.x=function(e){return arguments.length?(g=m=e,i):m},i.x0=function(e){return arguments.length?(g=e,i):g},i.x1=function(e){return arguments.length?(m=e,i):m},i.y=function(e){return arguments.length?(v=y=e,i):y},i.y0=function(e){return arguments.length?(v=e,i):v},i.y1=function(e){return arguments.length?(y=e,i):y},i.defined=function(e){return arguments.length?(b=e,i):b},i.interpolate=function(e){return arguments.length?(t="function"==typeof e?w=e:(w=rs.get(e)||as).key,C=w.reverse||w,_=w.closed?"M":"L",i):t},i.tension=function(e){return arguments.length?(A=e,i):A},i}function ws(e){return e.radius}function Cs(e){return[e.x,e.y]}function _s(){return 64}function As(){return"circle"}function Es(e){var t=Math.sqrt(e/Ae);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}M.svg.line.radial=function(){var e=os(ys);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},(ss.reverse=ls).reverse=ss,M.svg.area=function(){return bs(I)},M.svg.area.radial=function(){var e=bs(ys);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},M.svg.chord=function(){var o=so,r=lo,l=ws,c=Za,u=es;function t(e,t){var i=a(this,o,e,t),n=a(this,r,e,t);return"M"+i.p0+s(i.r,i.p1,i.a1-i.a0)+(function(e,t){return e.a0==t.a0&&e.a1==t.a1}(i,n)?d(i.r,i.p1,i.r,i.p0):d(i.r,i.p1,n.r,n.p0)+s(n.r,n.p1,n.a1-n.a0)+d(n.r,n.p1,i.r,i.p0))+"Z"}function a(e,t,i,n){var o=t.call(e,i,n),r=l.call(e,o,n),a=c.call(e,o,n)-Se,s=u.call(e,o,n)-Se;return{r:r,a0:a,a1:s,p0:[r*Math.cos(a),r*Math.sin(a)],p1:[r*Math.cos(s),r*Math.sin(s)]}}function s(e,t,i){return"A"+e+","+e+" 0 "+ +(Ae<i)+",1 "+t}function d(e,t,i,n){return"Q 0,0 "+n}return t.radius=function(e){return arguments.length?(l=ft(e),t):l},t.source=function(e){return arguments.length?(o=ft(e),t):o},t.target=function(e){return arguments.length?(r=ft(e),t):r},t.startAngle=function(e){return arguments.length?(c=ft(e),t):c},t.endAngle=function(e){return arguments.length?(u=ft(e),t):u},t},M.svg.diagonal=function(){var a=so,s=lo,l=Cs;function t(e,t){var i=a.call(this,e,t),n=s.call(this,e,t),o=(i.y+n.y)/2,r=[i,{x:i.x,y:o},{x:n.x,y:o},n];return"M"+(r=r.map(l))[0]+"C"+r[1]+" "+r[2]+" "+r[3]}return t.source=function(e){return arguments.length?(a=ft(e),t):a},t.target=function(e){return arguments.length?(s=ft(e),t):s},t.projection=function(e){return arguments.length?(l=e,t):l},t},M.svg.diagonal.radial=function(){var e=M.svg.diagonal(),t=Cs,i=e.projection;return e.projection=function(e){return arguments.length?i(function(n){return function(){var e=n.apply(this,arguments),t=e[0],i=e[1]-Se;return[t*Math.cos(i),t*Math.sin(i)]}}(t=e)):t},e},M.svg.symbol=function(){var i=As,n=_s;function t(e,t){return(xs.get(i.call(this,e,t))||Es)(n.call(this,e,t))}return t.type=function(e){return arguments.length?(i=ft(e),t):i},t.size=function(e){return arguments.length?(n=ft(e),t):n},t};var xs=M.map({circle:Es,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*Ts)),i=t*Ts;return"M0,"+-t+"L"+i+",0 0,"+t+" "+-i+",0Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/Ss),i=t*Ss/2;return"M0,"+i+"L"+t+","+-i+" "+-t+","+-i+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/Ss),i=t*Ss/2;return"M0,"+-i+"L"+t+","+i+" "+-t+","+i+"Z"}});M.svg.symbolTypes=xs.keys();var Ss=Math.sqrt(3),Ts=Math.tan(30*Te);U.transition=function(e){for(var t,i,n=Os||++Ms,o=Ls(e),r=[],a=Ns||{time:Date.now(),ease:Sr,delay:0,duration:250},s=-1,l=this.length;++s<l;){r.push(t=[]);for(var c=this[s],u=-1,d=c.length;++u<d;)(i=c[u])&&Gs(i,u,o,n,a),t.push(i)}return Rs(r,o,n)},U.interrupt=function(e){return this.each(null==e?Ds:ks(Ls(e)))};var Ds=ks(Ls());function ks(i){return function(){var e,t;(e=this[i])&&(t=e[e.active])&&(--e.count?delete e[e.active]:delete this[i],e.active+=.5,t.event&&t.event.interrupt.call(this,this.__data__,t.index))}}function Rs(e,t,i){return j(e,Fs),e.namespace=t,e.id=i,e}var Os,Ns,Fs=[],Ms=0;function Ps(e,n,o,r){var a=e.id,s=e.namespace;return le(e,"function"==typeof o?function(e,t,i){e[s][a].tween.set(n,r(o.call(e,e.__data__,t,i)))}:(o=r(o),function(e){e[s][a].tween.set(n,o)}))}function Is(e){return null==e&&(e=""),function(){this.textContent=e}}function Ls(e){return null==e?"__transition__":"__transition_"+e+"__"}function Gs(c,u,d,h,e){var p=c[d]||(c[d]={active:0,count:0}),f=p[h];if(!f){var g=e.time;f=p[h]={tween:new y,time:g,delay:e.delay,duration:e.duration,ease:e.ease,index:u},e=null,++p.count,M.timer(function(e){var o,r,t=f.delay,i=Ct,a=[];if(i.t=t+g,t<=e)return n(e-t);function n(e){if(p.active>h)return l();var t=p[p.active];t&&(--p.count,delete p[p.active],t.event&&t.event.interrupt.call(c,c.__data__,t.index)),p.active=h,f.event&&f.event.start.call(c,c.__data__,u),f.tween.forEach(function(e,t){(t=t.call(c,c.__data__,u))&&a.push(t)}),r=f.ease,o=f.duration,M.timer(function(){return i.c=s(e||1)?pn:s,1},0,g)}function s(e){if(p.active!==h)return 1;for(var t=e/o,i=r(t),n=a.length;0<n;)a[--n].call(c,i);return 1<=t?(f.event&&f.event.end.call(c,c.__data__,u),l()):void 0}function l(){return--p.count?delete p[h]:delete c[d],1}i.c=n},0,g)}}Fs.call=U.call,Fs.empty=U.empty,Fs.node=U.node,Fs.size=U.size,M.transition=function(e,t){return e&&e.transition?Os?e.transition(t):e:M.selection().transition(e)},(M.transition.prototype=Fs).select=function(e){var t,i,n,o=this.id,r=this.namespace,a=[];e=Y(e);for(var s=-1,l=this.length;++s<l;){a.push(t=[]);for(var c=this[s],u=-1,d=c.length;++u<d;)(n=c[u])&&(i=e.call(n,n.__data__,u,s))?("__data__"in n&&(i.__data__=n.__data__),Gs(i,u,r,o,n[r][o]),t.push(i)):t.push(null)}return Rs(a,r,o)},Fs.selectAll=function(e){var t,i,n,o,r,a=this.id,s=this.namespace,l=[];e=q(e);for(var c=-1,u=this.length;++c<u;)for(var d=this[c],h=-1,p=d.length;++h<p;)if(n=d[h]){r=n[s][a],i=e.call(n,n.__data__,h,c),l.push(t=[]);for(var f=-1,g=i.length;++f<g;)(o=i[f])&&Gs(o,f,s,a,r),t.push(o)}return Rs(l,s,a)},Fs.filter=function(e){var t,i,n=[];"function"!=typeof e&&(e=se(e));for(var o=0,r=this.length;o<r;o++){n.push(t=[]);for(var a,s=0,l=(a=this[o]).length;s<l;s++)(i=a[s])&&e.call(i,i.__data__,s,o)&&t.push(i)}return Rs(n,this.namespace,this.id)},Fs.tween=function(t,i){var n=this.id,o=this.namespace;return arguments.length<2?this.node()[o][n].tween.get(t):le(this,null==i?function(e){e[o][n].tween.remove(t)}:function(e){e[o][n].tween.set(t,i)})},Fs.attr=function(e,t){if(arguments.length<2){for(t in e)this.attr(t,e[t]);return this}var n="transform"==e?Ir:vr,o=M.ns.qualify(e);function r(){this.removeAttribute(o)}function a(){this.removeAttributeNS(o.space,o.local)}return Ps(this,"attr."+e,t,o.local?function(i){return null==i?a:(i+="",function(){var t,e=this.getAttributeNS(o.space,o.local);return e!==i&&(t=n(e,i),function(e){this.setAttributeNS(o.space,o.local,t(e))})})}:function(i){return null==i?r:(i+="",function(){var t,e=this.getAttribute(o);return e!==i&&(t=n(e,i),function(e){this.setAttribute(o,t(e))})})})},Fs.attrTween=function(e,n){var o=M.ns.qualify(e);return this.tween("attr."+e,o.local?function(e,t){var i=n.call(this,e,t,this.getAttributeNS(o.space,o.local));return i&&function(e){this.setAttributeNS(o.space,o.local,i(e))}}:function(e,t){var i=n.call(this,e,t,this.getAttribute(o));return i&&function(e){this.setAttribute(o,i(e))}})},Fs.style=function(n,e,o){var t=arguments.length;if(t<3){if("string"!=typeof n){for(o in t<2&&(e=""),n)this.style(o,n[o],e);return this}o=""}function r(){this.style.removeProperty(n)}return Ps(this,"style."+n,e,function(i){return null==i?r:(i+="",function(){var t,e=P(this).getComputedStyle(this,null).getPropertyValue(n);return e!==i&&(t=vr(e,i),function(e){this.style.setProperty(n,t(e),o)})})})},Fs.styleTween=function(n,o,r){return arguments.length<3&&(r=""),this.tween("style."+n,function(e,t){var i=o.call(this,e,t,P(this).getComputedStyle(this,null).getPropertyValue(n));return i&&function(e){this.style.setProperty(n,i(e),r)}})},Fs.text=function(e){return Ps(this,"text",e,Is)},Fs.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var e;this[t].count<2&&(e=this.parentNode)&&e.removeChild(this)})},Fs.ease=function(t){var i=this.id,n=this.namespace;return arguments.length<1?this.node()[n][i].ease:("function"!=typeof t&&(t=M.ease.apply(M,arguments)),le(this,function(e){e[n][i].ease=t}))},Fs.delay=function(n){var o=this.id,r=this.namespace;return arguments.length<1?this.node()[r][o].delay:le(this,"function"==typeof n?function(e,t,i){e[r][o].delay=+n.call(e,e.__data__,t,i)}:(n=+n,function(e){e[r][o].delay=n}))},Fs.duration=function(n){var o=this.id,r=this.namespace;return arguments.length<1?this.node()[r][o].duration:le(this,"function"==typeof n?function(e,t,i){e[r][o].duration=Math.max(1,n.call(e,e.__data__,t,i))}:(n=Math.max(1,n),function(e){e[r][o].duration=n}))},Fs.each=function(n,i){var o=this.id,r=this.namespace;if(arguments.length<2){var e=Ns,t=Os;try{Os=o,le(this,function(e,t,i){Ns=e[r][o],n.call(e,e.__data__,t,i)})}finally{Ns=e,Os=t}}else le(this,function(e){var t=e[r][o];(t.event||(t.event=M.dispatch("start","end","interrupt"))).on(n,i)});return this},Fs.transition=function(){for(var e,t,i,n=this.id,o=++Ms,r=this.namespace,a=[],s=0,l=this.length;s<l;s++){a.push(e=[]);for(var c,u=0,d=(c=this[s]).length;u<d;u++)(t=c[u])&&Gs(t,u,r,o,{time:(i=t[r][n]).time,ease:i.ease,delay:i.delay+i.duration,duration:i.duration}),e.push(t)}return Rs(a,r,o)},M.svg.axis=function(){var S,T=M.scale.linear(),D=$s,k=6,R=6,O=3,N=[10],F=null;function i(e){e.each(function(){var e,t=M.select(this),i=this.__chart__||T,n=this.__chart__=T.copy(),o=null==F?n.ticks?n.ticks.apply(n,N):n.domain():F,r=null==S?n.tickFormat?n.tickFormat.apply(n,N):I:S,a=t.selectAll(".tick").data(o,n),s=a.enter().insert("g",".domain").attr("class","tick").style("opacity",Ce),l=M.transition(a.exit()).style("opacity",Ce).remove(),c=M.transition(a.order()).style("opacity",1),u=Math.max(k,0)+O,d=Ra(n),h=t.selectAll(".domain").data([0]),p=(h.enter().append("path").attr("class","domain"),M.transition(h));s.append("line"),s.append("text");var f,g,m,v,y=s.select("line"),b=c.select("line"),w=a.select("text").text(r),C=s.select("text"),_=c.select("text"),A="top"===D||"left"===D?-1:1;if("bottom"===D||"top"===D?(e=js,f="x",m="y",g="x2",v="y2",w.attr("dy",A<0?"0em":".71em").style("text-anchor","middle"),p.attr("d","M"+d[0]+","+A*R+"V0H"+d[1]+"V"+A*R)):(e=Ws,f="y",m="x",g="y2",v="x2",w.attr("dy",".32em").style("text-anchor",A<0?"end":"start"),p.attr("d","M"+A*R+","+d[0]+"H0V"+d[1]+"H"+A*R)),y.attr(v,A*k),C.attr(m,A*u),b.attr(g,0).attr(v,A*k),_.attr(f,0).attr(m,A*u),n.rangeBand){var E=n,x=E.rangeBand()/2;i=n=function(e){return E(e)+x}}else i.rangeBand?i=n:l.call(e,n,i);s.call(e,i,n),c.call(e,n,n)})}return i.scale=function(e){return arguments.length?(T=e,i):T},i.orient=function(e){return arguments.length?(D=e in Bs?e+"":$s,i):D},i.ticks=function(){return arguments.length?(N=arguments,i):N},i.tickValues=function(e){return arguments.length?(F=e,i):F},i.tickFormat=function(e){return arguments.length?(S=e,i):S},i.tickSize=function(e){var t=arguments.length;return t?(k=+e,R=+arguments[t-1],i):k},i.innerTickSize=function(e){return arguments.length?(k=+e,i):k},i.outerTickSize=function(e){return arguments.length?(R=+e,i):R},i.tickPadding=function(e){return arguments.length?(O=+e,i):O},i.tickSubdivide=function(){return arguments.length&&i},i};var $s="bottom",Bs={top:1,right:1,bottom:1,left:1};function js(e,i,n){e.attr("transform",function(e){var t=i(e);return"translate("+(isFinite(t)?t:n(e))+",0)"})}function Ws(e,i,n){e.attr("transform",function(e){var t=i(e);return"translate(0,"+(isFinite(t)?t:n(e))+")"})}M.svg.brush=function(){var y,b,w=$(T,"brushstart","brush","brushend"),C=null,_=null,A=[0,0],E=[0,0],x=!0,S=!0,a=zs[0];function T(e){e.each(function(){var e=M.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",s).on("touchstart.brush",s),t=e.selectAll(".background").data([0]);t.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),e.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var i=e.selectAll(".resize").data(a,I);i.exit().remove(),i.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return Hs[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),i.style("display",T.empty()?"none":null);var n,o=M.transition(e),r=M.transition(t);C&&(n=Ra(C),r.attr("x",n[0]).attr("width",n[1]-n[0]),k(o)),_&&(n=Ra(_),r.attr("y",n[0]).attr("height",n[1]-n[0]),R(o)),D(o)})}function D(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+A[+/e$/.test(e)]+","+E[+/^s/.test(e)]+")"})}function k(e){e.select(".extent").attr("x",A[0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",A[1]-A[0])}function R(e){e.select(".extent").attr("y",E[0]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",E[1]-E[0])}function s(){var d,i,n=this,e=M.select(M.event.target),o=w.of(n,arguments),r=M.select(n),t=e.datum(),a=!/^(n|s)$/.test(t)&&C,s=!/^(e|w)$/.test(t)&&_,h=e.classed("extent"),l=ve(n),p=M.mouse(n),c=M.select(P(n)).on("keydown.brush",function(){32==M.event.keyCode&&(h||(d=null,p[0]-=A[1],p[1]-=E[1],h=2),L())}).on("keyup.brush",function(){32==M.event.keyCode&&2==h&&(p[0]+=A[1],p[1]+=E[1],h=0,L())});if(M.event.changedTouches?c.on("touchmove.brush",g).on("touchend.brush",v):c.on("mousemove.brush",g).on("mouseup.brush",v),r.interrupt().selectAll("*").interrupt(),h)p[0]=A[0]-p[0],p[1]=E[0]-p[1];else if(t){var u=+/w$/.test(t),f=+/^n/.test(t);i=[A[1-u]-p[0],E[1-f]-p[1]],p[0]=A[u],p[1]=E[f]}else M.event.altKey&&(d=p.slice());function g(){var e=M.mouse(n),t=!1;i&&(e[0]+=i[0],e[1]+=i[1]),h||(M.event.altKey?(d=d||[(A[0]+A[1])/2,(E[0]+E[1])/2],p[0]=A[+(e[0]<d[0])],p[1]=E[+(e[1]<d[1])]):d=null),a&&m(e,C,0)&&(k(r),t=!0),s&&m(e,_,1)&&(R(r),t=!0),t&&(D(r),o({type:"brush",mode:h?"move":"resize"}))}function m(e,t,i){var n,o,r=Ra(t),a=r[0],s=r[1],l=p[i],c=i?E:A,u=c[1]-c[0];if(h&&(a-=l,s-=u+l),n=(i?S:x)?Math.max(a,Math.min(s,e[i])):e[i],h?o=(n+=l)+u:(d&&(l=Math.max(a,Math.min(s,2*d[i]-n))),l<n?(o=n,n=l):o=l),c[0]!=n||c[1]!=o)return i?b=null:y=null,c[0]=n,c[1]=o,!0}function v(){g(),r.style("pointer-events","all").selectAll(".resize").style("display",T.empty()?"none":null),M.select("body").style("cursor",null),c.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),l(),o({type:"brushend"})}r.style("pointer-events","none").selectAll(".resize").style("display",null),M.select("body").style("cursor",e.style("cursor")),o({type:"brushstart"}),g()}return T.event=function(e){e.each(function(){var n=w.of(this,arguments),o={x:A,y:E,i:y,j:b},e=this.__chart__||o;this.__chart__=o,Os?M.select(this).transition().each("start.brush",function(){y=e.i,b=e.j,A=e.x,E=e.y,n({type:"brushstart"})}).tween("brush:brush",function(){var t=yr(A,o.x),i=yr(E,o.y);return y=b=null,function(e){A=o.x=t(e),E=o.y=i(e),n({type:"brush",mode:"resize"})}}).each("end.brush",function(){y=o.i,b=o.j,n({type:"brush",mode:"resize"}),n({type:"brushend"})}):(n({type:"brushstart"}),n({type:"brush",mode:"resize"}),n({type:"brushend"}))})},T.x=function(e){return arguments.length?(a=zs[!(C=e)<<1|!_],T):C},T.y=function(e){return arguments.length?(a=zs[!C<<1|!(_=e)],T):_},T.clamp=function(e){return arguments.length?(C&&_?(x=!!e[0],S=!!e[1]):C?x=!!e:_&&(S=!!e),T):C&&_?[x,S]:C?x:_?S:null},T.extent=function(e){var t,i,n,o,r;return arguments.length?(C&&(t=e[0],i=e[1],_&&(t=t[0],i=i[0]),y=[t,i],C.invert&&(t=C(t),i=C(i)),i<t&&(r=t,t=i,i=r),t==A[0]&&i==A[1]||(A=[t,i])),_&&(n=e[0],o=e[1],C&&(n=n[1],o=o[1]),b=[n,o],_.invert&&(n=_(n),o=_(o)),o<n&&(r=n,n=o,o=r),n==E[0]&&o==E[1]||(E=[n,o])),T):(C&&(y?(t=y[0],i=y[1]):(t=A[0],i=A[1],C.invert&&(t=C.invert(t),i=C.invert(i)),i<t&&(r=t,t=i,i=r))),_&&(b?(n=b[0],o=b[1]):(n=E[0],o=E[1],_.invert&&(n=_.invert(n),o=_.invert(o)),o<n&&(r=n,n=o,o=r))),C&&_?[[t,n],[i,o]]:C?[t,i]:_&&[n,o])},T.clear=function(){return T.empty()||(A=[0,0],E=[0,0],y=b=null),T},T.empty=function(){return!!C&&A[0]==A[1]||!!_&&E[0]==E[1]},M.rebind(T,w,"on")};var Hs={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},zs=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Vs=Ot.format=ri.timeFormat,Us=Vs.utc,Ys=Us("%Y-%m-%dT%H:%M:%S.%LZ");function qs(e){return e.toISOString()}function Qs(t,o,e){function a(e){return t(e)}function s(e,t){var i=(e[1]-e[0])/t,n=M.bisect(Xs,i);return n==Xs.length?[o.year,La(e.map(function(e){return e/31536e6}),t)[2]]:n?o[i/Xs[n-1]<Xs[n]/i?n-1:n]:[el,La(e,t)[2]]}return a.invert=function(e){return Ks(t.invert(e))},a.domain=function(e){return arguments.length?(t.domain(e),a):t.domain().map(Ks)},a.nice=function(t,i){var e=a.domain(),n=ka(e),o=null==t?s(n,10):"number"==typeof t&&s(n,t);function r(e){return!isNaN(e)&&!t.range(e,Ks(+e+1),i).length}return o&&(t=o[0],i=o[1]),a.domain(Na(e,1<i?{floor:function(e){for(;r(e=t.floor(e));)e=Ks(e-1);return e},ceil:function(e){for(;r(e=t.ceil(e));)e=Ks(+e+1);return e}}:t))},a.ticks=function(e,t){var i=ka(a.domain()),n=null==e?s(i,10):"number"==typeof e?s(i,e):!e.range&&[{range:e},t];return n&&(e=n[0],t=n[1]),e.range(i[0],Ks(+i[1]+1),t<1?1:t)},a.tickFormat=function(){return e},a.copy=function(){return Qs(t.copy(),o,e)},Pa(a,t)}function Ks(e){return new Date(e)}Vs.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?qs:Ys,qs.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},qs.toString=Ys.toString,Ot.second=Pt(function(e){return new Nt(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(e.getTime()+1e3*Math.floor(t))},function(e){return e.getSeconds()}),Ot.seconds=Ot.second.range,Ot.seconds.utc=Ot.second.utc.range,Ot.minute=Pt(function(e){return new Nt(6e4*Math.floor(e/6e4))},function(e,t){e.setTime(e.getTime()+6e4*Math.floor(t))},function(e){return e.getMinutes()}),Ot.minutes=Ot.minute.range,Ot.minutes.utc=Ot.minute.utc.range,Ot.hour=Pt(function(e){var t=e.getTimezoneOffset()/60;return new Nt(36e5*(Math.floor(e/36e5-t)+t))},function(e,t){e.setTime(e.getTime()+36e5*Math.floor(t))},function(e){return e.getHours()}),Ot.hours=Ot.hour.range,Ot.hours.utc=Ot.hour.utc.range,Ot.month=Pt(function(e){return(e=Ot.day(e)).setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),Ot.months=Ot.month.range,Ot.months.utc=Ot.month.utc.range;var Xs=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Js=[[Ot.second,1],[Ot.second,5],[Ot.second,15],[Ot.second,30],[Ot.minute,1],[Ot.minute,5],[Ot.minute,15],[Ot.minute,30],[Ot.hour,1],[Ot.hour,3],[Ot.hour,6],[Ot.hour,12],[Ot.day,1],[Ot.day,2],[Ot.week,1],[Ot.month,1],[Ot.month,3],[Ot.year,1]],Zs=Vs.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%a %d",function(e){return e.getDay()&&1!=e.getDate()}],["%b %d",function(e){return 1!=e.getDate()}],["%B",function(e){return e.getMonth()}],["%Y",pn]]),el={range:function(e,t,i){return M.range(Math.ceil(e/i)*i,+t,i).map(Ks)},floor:I,ceil:I};Js.year=Ot.year,Ot.scale=function(){return Qs(M.scale.linear(),Js,Zs)};var tl=Js.map(function(e){return[e[0].utc,e[1]]}),il=Us.multi([[".%L",function(e){return e.getUTCMilliseconds()}],[":%S",function(e){return e.getUTCSeconds()}],["%I:%M",function(e){return e.getUTCMinutes()}],["%I %p",function(e){return e.getUTCHours()}],["%a %d",function(e){return e.getUTCDay()&&1!=e.getUTCDate()}],["%b %d",function(e){return 1!=e.getUTCDate()}],["%B",function(e){return e.getUTCMonth()}],["%Y",pn]]);function nl(e){return JSON.parse(e.responseText)}function ol(e){var t=b.createRange();return t.selectNode(b.body),t.createContextualFragment(e.responseText)}tl.year=Ot.year.utc,Ot.scale.utc=function(){return Qs(M.scale.linear(),tl,il)},M.text=gt(function(e){return e.responseText}),M.json=function(e,t){return mt(e,"application/json",nl,t)},M.html=function(e,t){return mt(e,"text/html",ol,t)},M.xml=gt(function(e){return e.responseXML}),"function"==typeof define&&define.amd?define(M):"object"==typeof module&&module.exports&&(module.exports=M),this.d3=M}(),function(c){"use strict";var i,u,e={version:"0.4.10"};function t(e){this.owner=e}function n(e){var t=this.internal=new o(this);t.loadConfig(e),t.init(),function t(i,n,o){Object.keys(i).forEach(function(e){n[e]=i[e].bind(o),0<Object.keys(i[e]).length&&t(i[e],n[e],o)})}(i,this,this)}function o(e){this.d3=c.d3?c.d3:"undefined"!=typeof require?require("d3"):void 0,this.api=e,this.config=this.getDefaultConfig(),this.data={},this.cache={},this.axes={}}function s(e){t.call(this,e)}e.generate=function(e){return new n(e)},e.chart={fn:n.prototype,internal:{fn:o.prototype,axis:{fn:s.prototype}}},i=e.chart.fn,u=e.chart.internal.fn,e.chart.internal.axis.fn,u.init=function(){var e=this,t=e.config;if(e.initParams(),t.data_url)e.convertUrlToData(t.data_url,t.data_mimeType,t.data_keys,e.initWithData);else if(t.data_json)e.initWithData(e.convertJsonToData(t.data_json,t.data_keys));else if(t.data_rows)e.initWithData(e.convertRowsToData(t.data_rows));else{if(!t.data_columns)throw Error("url or json or rows or columns is required.");e.initWithData(e.convertColumnsToData(t.data_columns))}},u.initParams=function(){var e=this,t=e.d3,i=e.config;e.clipId="c3-"+ +new Date+"-clip",e.clipIdForXAxis=e.clipId+"-xaxis",e.clipIdForYAxis=e.clipId+"-yaxis",e.clipIdForGrid=e.clipId+"-grid",e.clipIdForSubchart=e.clipId+"-subchart",e.clipPath=e.getClipPath(e.clipId),e.clipPathForXAxis=e.getClipPath(e.clipIdForXAxis),e.clipPathForYAxis=e.getClipPath(e.clipIdForYAxis),e.clipPathForGrid=e.getClipPath(e.clipIdForGrid),e.clipPathForSubchart=e.getClipPath(e.clipIdForSubchart),e.dragStart=null,e.dragging=!1,e.flowing=!1,e.cancelClick=!1,e.mouseover=!1,e.transiting=!1,e.color=e.generateColor(),e.levelColor=e.generateLevelColor(),e.dataTimeFormat=i.data_xLocaltime?t.time.format:t.time.format.utc,e.axisTimeFormat=i.axis_x_localtime?t.time.format:t.time.format.utc,e.defaultAxisTimeFormat=e.axisTimeFormat.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%-m/%-d",function(e){return e.getDay()&&1!==e.getDate()}],["%-m/%-d",function(e){return 1!==e.getDate()}],["%-m/%-d",function(e){return e.getMonth()}],["%Y/%-m/%-d",function(){return!0}]]),e.hiddenTargetIds=[],e.hiddenLegendIds=[],e.focusedTargetIds=[],e.defocusedTargetIds=[],e.xOrient=i.axis_rotated?"left":"bottom",e.yOrient=i.axis_rotated?i.axis_y_inner?"top":"bottom":i.axis_y_inner?"right":"left",e.y2Orient=i.axis_rotated?i.axis_y2_inner?"bottom":"top":i.axis_y2_inner?"left":"right",e.subXOrient=i.axis_rotated?"left":"bottom",e.isLegendRight="right"===i.legend_position,e.isLegendInset="inset"===i.legend_position,e.isLegendTop="top-left"===i.legend_inset_anchor||"top-right"===i.legend_inset_anchor,e.isLegendLeft="top-left"===i.legend_inset_anchor||"bottom-left"===i.legend_inset_anchor,e.legendStep=0,e.legendItemWidth=0,e.legendItemHeight=0,e.currentMaxTickWidths={x:0,y:0,y2:0},e.rotated_padding_left=30,e.rotated_padding_right=i.axis_rotated&&!i.axis_x_show?0:30,e.rotated_padding_top=5,e.withoutFadeIn={},e.intervalForObserveInserted=void 0,e.axes.subx=t.selectAll([])},u.initChartElements=function(){this.initBar&&this.initBar(),this.initLine&&this.initLine(),this.initArc&&this.initArc(),this.initGauge&&this.initGauge(),this.initText&&this.initText()},u.initWithData=function(e){var t,i,n=this,o=n.d3,r=n.config,a=!0;n.axis=new s(n),n.initPie&&n.initPie(),n.initBrush&&n.initBrush(),n.initZoom&&n.initZoom(),r.bindto?"function"==typeof r.bindto.node?n.selectChart=r.bindto:n.selectChart=o.select(r.bindto):n.selectChart=o.selectAll([]),n.selectChart.empty()&&(n.selectChart=o.select(document.createElement("div")).style("opacity",0),n.observeInserted(n.selectChart),a=!1),n.selectChart.html("").classed("c3",!0),n.data.xs={},n.data.targets=n.convertDataToTargets(e),r.data_filter&&(n.data.targets=n.data.targets.filter(r.data_filter)),r.data_hide&&n.addHiddenTargetIds(!0===r.data_hide?n.mapToIds(n.data.targets):r.data_hide),r.legend_hide&&n.addHiddenLegendIds(!0===r.legend_hide?n.mapToIds(n.data.targets):r.legend_hide),n.hasType("gauge")&&(r.legend_show=!1),n.updateSizes(),n.updateScales(),n.x.domain(o.extent(n.getXDomain(n.data.targets))),n.y.domain(n.getYDomain(n.data.targets,"y")),n.y2.domain(n.getYDomain(n.data.targets,"y2")),n.subX.domain(n.x.domain()),n.subY.domain(n.y.domain()),n.subY2.domain(n.y2.domain()),n.orgXDomain=n.x.domain(),n.brush&&n.brush.scale(n.subX),r.zoom_enabled&&n.zoom.scale(n.x),n.svg=n.selectChart.append("svg").style("overflow","hidden").on("mouseenter",function(){return r.onmouseover.call(n)}).on("mouseleave",function(){return r.onmouseout.call(n)}),t=n.svg.append("defs"),n.clipChart=n.appendClip(t,n.clipId),n.clipXAxis=n.appendClip(t,n.clipIdForXAxis),n.clipYAxis=n.appendClip(t,n.clipIdForYAxis),n.clipGrid=n.appendClip(t,n.clipIdForGrid),n.clipSubchart=n.appendClip(t,n.clipIdForSubchart),n.updateSvgSize(),i=n.main=n.svg.append("g").attr("transform",n.getTranslate("main")),n.initSubchart&&n.initSubchart(),n.initTooltip&&n.initTooltip(),n.initLegend&&n.initLegend(),i.append("text").attr("class",$.text+" "+$.empty).attr("text-anchor","middle").attr("dominant-baseline","middle"),n.initRegion(),n.initGrid(),i.append("g").attr("clip-path",n.clipPath).attr("class",$.chart),r.grid_lines_front&&n.initGridLines(),n.initEventRect(),n.initChartElements(),i.insert("rect",r.zoom_privileged?null:"g."+$.regions).attr("class",$.zoomRect).attr("width",n.width).attr("height",n.height).style("opacity",0).on("dblclick.zoom",null),r.axis_x_extent&&n.brush.extent(n.getDefaultExtent()),n.axis.init(),n.updateTargets(n.data.targets),a&&(n.updateDimension(),n.config.oninit.call(n),n.redraw({withTransition:!1,withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withTransitionForAxis:!1})),null==c.onresize&&(c.onresize=n.generateResize()),c.onresize.add&&(c.onresize.add(function(){r.onresize.call(n)}),c.onresize.add(function(){n.api.flush()}),c.onresize.add(function(){r.onresized.call(n)})),n.api.element=n.selectChart.node()},u.smoothLines=function(e,t){var r=this;"grid"===t&&e.each(function(){var e=r.d3.select(this),t=e.attr("x1"),i=e.attr("x2"),n=e.attr("y1"),o=e.attr("y2");e.attr({x1:Math.ceil(t),x2:Math.ceil(i),y1:Math.ceil(n),y2:Math.ceil(o)})})},u.updateSizes=function(){var e=this,t=e.config,i=e.legend?e.getLegendHeight():0,n=e.legend?e.getLegendWidth():0,o=e.isLegendRight||e.isLegendInset?0:i,r=e.hasArcType(),a=t.axis_rotated||r?0:e.getHorizontalAxisHeight("x"),s=t.subchart_show&&!r?t.subchart_size_height+a:0;e.currentWidth=e.getCurrentWidth(),e.currentHeight=e.getCurrentHeight(),e.margin=t.axis_rotated?{top:e.getHorizontalAxisHeight("y2")+e.getCurrentPaddingTop(),right:r?0:e.getCurrentPaddingRight(),bottom:e.getHorizontalAxisHeight("y")+o+e.getCurrentPaddingBottom(),left:s+(r?0:e.getCurrentPaddingLeft())}:{top:4+e.getCurrentPaddingTop(),right:r?0:e.getCurrentPaddingRight(),bottom:a+s+o+e.getCurrentPaddingBottom(),left:r?0:e.getCurrentPaddingLeft()},e.margin2=t.axis_rotated?{top:e.margin.top,right:NaN,bottom:20+o,left:e.rotated_padding_left}:{top:e.currentHeight-s-o,right:NaN,bottom:a+o,left:e.margin.left},e.margin3={top:0,right:NaN,bottom:0,left:0},e.updateSizeForLegend&&e.updateSizeForLegend(i,n),e.width=e.currentWidth-e.margin.left-e.margin.right,e.height=e.currentHeight-e.margin.top-e.margin.bottom,e.width<0&&(e.width=0),e.height<0&&(e.height=0),e.width2=t.axis_rotated?e.margin.left-e.rotated_padding_left-e.rotated_padding_right:e.width,e.height2=t.axis_rotated?e.height:e.currentHeight-e.margin2.top-e.margin2.bottom,e.width2<0&&(e.width2=0),e.height2<0&&(e.height2=0),e.arcWidth=e.width-(e.isLegendRight?n+10:0),e.arcHeight=e.height-(e.isLegendRight?0:10),e.hasType("gauge")&&(e.arcHeight+=e.height-e.getGaugeLabelHeight()),e.updateRadius&&e.updateRadius(),e.isLegendRight&&r&&(e.margin3.left=e.arcWidth/2+1.1*e.radiusExpanded)},u.updateTargets=function(e){this.updateTargetsForText(e),this.updateTargetsForBar(e),this.updateTargetsForLine(e),this.hasArcType()&&this.updateTargetsForArc&&this.updateTargetsForArc(e),this.updateTargetsForSubchart&&this.updateTargetsForSubchart(e),this.showTargets()},u.showTargets=function(){var t=this;t.svg.selectAll("."+$.target).filter(function(e){return t.isTargetToShow(e.id)}).transition().duration(t.config.transition_duration).style("opacity",1)},u.redraw=function(e,t){var i,n,o,r,a,s,l,c,u,d,h,p,f,g,m,v,y,b,w,C,_,A,E,x,S,T,D,k=this,R=k.main,O=k.d3,N=k.config,F=k.getShapeIndices(k.isAreaType),M=k.getShapeIndices(k.isBarType),P=k.getShapeIndices(k.isLineType),I=k.hasArcType(),L=k.filterTargetsToShow(k.data.targets),G=k.xv.bind(k);i=B(e=e||{},"withY",!0),n=B(e,"withSubchart",!0),o=B(e,"withTransition",!0),s=B(e,"withTransform",!1),l=B(e,"withUpdateXDomain",!1),c=B(e,"withUpdateOrgXDomain",!1),u=B(e,"withTrimXDomain",!0),f=B(e,"withUpdateXAxis",l),d=B(e,"withLegend",!1),h=B(e,"withEventRect",!0),p=B(e,"withDimension",!0),r=B(e,"withTransitionForExit",o),a=B(e,"withTransitionForAxis",o),w=o?N.transition_duration:0,C=r?w:0,_=a?w:0,t=t||k.axis.generateTransitions(_),d&&N.legend_show?k.updateLegend(k.mapToIds(k.data.targets),e,t):p&&k.updateDimension(!0),k.isCategorized()&&0===L.length&&k.x.domain([0,k.axes.x.selectAll(".tick").size()]),L.length?(k.updateXDomain(L,l,c,u),N.axis_x_tick_values||(x=k.axis.updateXAxisTickValues(L))):(k.xAxis.tickValues([]),k.subXAxis.tickValues([])),N.zoom_rescale&&!e.flow&&(S=k.x.orgDomain()),k.y.domain(k.getYDomain(L,"y",S)),k.y2.domain(k.getYDomain(L,"y2",S)),!N.axis_y_tick_values&&N.axis_y_tick_count&&k.yAxis.tickValues(k.axis.generateTickValues(k.y.domain(),N.axis_y_tick_count)),!N.axis_y2_tick_values&&N.axis_y2_tick_count&&k.y2Axis.tickValues(k.axis.generateTickValues(k.y2.domain(),N.axis_y2_tick_count)),k.axis.redraw(t,I),k.axis.updateLabels(o),(l||f)&&L.length&&(N.axis_x_tick_culling&&x?k.svg.selectAll("."+$.axisX).each(function(){var e=O.select(this),n=e.select("path.domain").node().getTotalLength()-(N.axis_x_tick_outer?12:0),i=[];if(e.selectAll(".tick text").each(function(e){var t=x.indexOf(e);0<=t&&i.push({e:this,index:t})}),i.sort(function(e,t){return e.index-t.index}),N.axis_x_tick_rotate||i.forEach(function(e){var t=e.e.getBoundingClientRect().width/2,i=O.transform(O.select(e.e.parentNode).attr("transform"));O.select(e.e).style("text-anchor",function(){return i.translate[0]<t?"start":i.translate[0]+t>n?"end":"middle"})}),i.length>N.axis_x_tick_culling_max)if(1<N.axis_x_tick_culling_max){for(var t=N.axis_x_tick_culling_max,o=Math.floor(i.length/t);i.length/o>=t+1;)t--,o=Math.floor(i.length/t);var r=Math.floor((i.length-o*(t-1)-1)/2);i.forEach(function(e,t){O.select(e.e).style("display",(t+o-r)%o?"none":"block")})}else{var a=Math.round(i.length/2);i.forEach(function(e,t){O.select(e.e).style("display",t==a?"block":"none")})}else i.forEach(function(e){O.select(e.e).style("display","block")})}):k.svg.selectAll("."+$.axisX+" .tick text").style("display","block")),g=k.generateDrawArea?k.generateDrawArea(F,!1):void 0,m=k.generateDrawBar?k.generateDrawBar(M):void 0,v=k.generateDrawLine?k.generateDrawLine(P,!1):void 0,y=k.generateXYForText(F,M,P,!0),b=k.generateXYForText(F,M,P,!1),i&&(k.subY.domain(k.getYDomain(L,"y")),k.subY2.domain(k.getYDomain(L,"y2"))),k.tooltip.style("display","none"),k.updateXgridFocus(),R.select("text."+$.text+"."+$.empty).attr("x",k.width/2).attr("y",k.height/2).text(N.data_empty_label_text).transition().style("opacity",L.length?0:1),k.updateGrid(w),k.updateRegion(w),k.updateBar(C),k.updateLine(C),k.updateArea(C),k.updateCircle(),k.hasDataLabel()&&k.updateText(C),k.redrawArc&&k.redrawArc(w,C,s),k.redrawSubchart&&k.redrawSubchart(n,t,w,C,F,M,P),R.selectAll("."+$.selectedCircles).filter(k.isBarType.bind(k)).selectAll("circle").remove(),N.interaction_enabled&&!e.flow&&h&&(k.redrawEventRect(),k.updateZoom&&k.updateZoom()),k.updateCircleY(),T=(k.config.axis_rotated?k.circleY:k.circleX).bind(k),D=(k.config.axis_rotated?k.circleX:k.circleY).bind(k),e.flow&&(E=k.generateFlow({targets:L,flow:e.flow,duration:e.flow.duration,drawBar:m,drawLine:v,drawArea:g,cx:T,cy:D,xv:G,xForText:y,yForText:b})),(w||E)&&k.isTabVisible()?O.transition().duration(w).each(function(){var t=[];[k.redrawBar(m,!0),k.redrawLine(v,!0),k.redrawArea(g,!0),k.redrawCircle(T,D,!0),k.redrawText(y,b,e.flow,!0),k.redrawRegion(!0),k.redrawGrid(!0)].forEach(function(e){e.forEach(function(e){t.push(e)})}),A=k.generateWait(),t.forEach(function(e){A.add(e)})}).call(A,function(){E&&E(),N.onrendered&&N.onrendered.call(k)}):(k.redrawBar(m),k.redrawLine(v),k.redrawArea(g),k.redrawCircle(T,D),k.redrawText(y,b,e.flow),k.redrawRegion(),k.redrawGrid(),N.onrendered&&N.onrendered.call(k)),k.mapToIds(k.data.targets).forEach(function(e){k.withoutFadeIn[e]=!0})},u.updateAndRedraw=function(e){var t,i=this.config;(e=e||{}).withTransition=B(e,"withTransition",!0),e.withTransform=B(e,"withTransform",!1),e.withLegend=B(e,"withLegend",!1),e.withUpdateXDomain=!0,e.withUpdateOrgXDomain=!0,e.withTransitionForExit=!1,e.withTransitionForTransform=B(e,"withTransitionForTransform",e.withTransition),this.updateSizes(),e.withLegend&&i.legend_show||(t=this.axis.generateTransitions(e.withTransitionForAxis?i.transition_duration:0),this.updateScales(),this.updateSvgSize(),this.transformAll(e.withTransitionForTransform,t)),this.redraw(e,t)},u.redrawWithoutRescale=function(){this.redraw({withY:!1,withSubchart:!1,withEventRect:!1,withTransitionForAxis:!1})},u.isTimeSeries=function(){return"timeseries"===this.config.axis_x_type},u.isCategorized=function(){return 0<=this.config.axis_x_type.indexOf("categor")},u.isCustomX=function(){var e=this.config;return!this.isTimeSeries()&&(e.data_x||T(e.data_xs))},u.isTimeSeriesY=function(){return"timeseries"===this.config.axis_y_type},u.getTranslate=function(e){var t,i,n=this,o=n.config;return"main"===e?(t=l(n.margin.left),i=l(n.margin.top)):"context"===e?(t=l(n.margin2.left),i=l(n.margin2.top)):"legend"===e?(t=n.margin3.left,i=n.margin3.top):"x"===e?(t=0,i=o.axis_rotated?0:n.height):"y"===e?(t=0,i=o.axis_rotated?n.height:0):"y2"===e?(t=o.axis_rotated?0:n.width,i=o.axis_rotated?1:0):"subx"===e?(t=0,i=o.axis_rotated?0:n.height2):"arc"===e&&(t=n.arcWidth/2,i=n.arcHeight/2),"translate("+t+","+i+")"},u.initialOpacity=function(e){return null!==e.value&&this.withoutFadeIn[e.id]?1:0},u.initialOpacityForCircle=function(e){return null!==e.value&&this.withoutFadeIn[e.id]?this.opacityForCircle(e):0},u.opacityForCircle=function(e){var t=this.config.point_show?1:0;return S(e.value)?this.isScatterType(e)?.5:t:0},u.opacityForText=function(){return this.hasDataLabel()?1:0},u.xx=function(e){return e?this.x(e.x):null},u.xv=function(e){var t=e.value;return this.isTimeSeries()?t=this.parseDate(e.value):this.isCategorized()&&"string"==typeof e.value&&(t=this.config.axis_x_categories.indexOf(e.value)),Math.ceil(this.x(t))},u.yv=function(e){var t=e.axis&&"y2"===e.axis?this.y2:this.y;return Math.ceil(t(e.value))},u.subxx=function(e){return e?this.subX(e.x):null},u.transformMain=function(e,t){var i,n,o,r=this;t&&t.axisX?i=t.axisX:(i=r.main.select("."+$.axisX),e&&(i=i.transition())),t&&t.axisY?n=t.axisY:(n=r.main.select("."+$.axisY),e&&(n=n.transition())),t&&t.axisY2?o=t.axisY2:(o=r.main.select("."+$.axisY2),e&&(o=o.transition())),(e?r.main.transition():r.main).attr("transform",r.getTranslate("main")),i.attr("transform",r.getTranslate("x")),n.attr("transform",r.getTranslate("y")),o.attr("transform",r.getTranslate("y2")),r.main.select("."+$.chartArcs).attr("transform",r.getTranslate("arc"))},u.transformAll=function(e,t){this.transformMain(e,t),this.config.subchart_show&&this.transformContext(e,t),this.legend&&this.transformLegend(e)},u.updateSvgSize=function(){var e=this,t=e.svg.select(".c3-brush .background");e.svg.attr("width",e.currentWidth).attr("height",e.currentHeight),e.svg.selectAll(["#"+e.clipId,"#"+e.clipIdForGrid]).select("rect").attr("width",e.width).attr("height",e.height),e.svg.select("#"+e.clipIdForXAxis).select("rect").attr("x",e.getXAxisClipX.bind(e)).attr("y",e.getXAxisClipY.bind(e)).attr("width",e.getXAxisClipWidth.bind(e)).attr("height",e.getXAxisClipHeight.bind(e)),e.svg.select("#"+e.clipIdForYAxis).select("rect").attr("x",e.getYAxisClipX.bind(e)).attr("y",e.getYAxisClipY.bind(e)).attr("width",e.getYAxisClipWidth.bind(e)).attr("height",e.getYAxisClipHeight.bind(e)),e.svg.select("#"+e.clipIdForSubchart).select("rect").attr("width",e.width).attr("height",t.size()?t.attr("height"):0),e.svg.select("."+$.zoomRect).attr("width",e.width).attr("height",e.height),e.selectChart.style("max-height",e.currentHeight+"px")},u.updateDimension=function(e){var t=this;e||(t.config.axis_rotated?(t.axes.x.call(t.xAxis),t.axes.subx.call(t.subXAxis)):(t.axes.y.call(t.yAxis),t.axes.y2.call(t.y2Axis))),t.updateSizes(),t.updateScales(),t.updateSvgSize(),t.transformAll(!1)},u.observeInserted=function(t){var i,n=this;"undefined"!=typeof MutationObserver?(i=new MutationObserver(function(e){e.forEach(function(e){"childList"===e.type&&e.previousSibling&&(i.disconnect(),n.intervalForObserveInserted=c.setInterval(function(){t.node().parentNode&&(c.clearInterval(n.intervalForObserveInserted),n.updateDimension(),n.config.oninit.call(n),n.redraw({withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withTransition:!1,withTransitionForTransform:!1,withLegend:!0}),t.transition().style("opacity",1))},10))})})).observe(t.node(),{attributes:!0,childList:!0,characterData:!0}):c.console.error("MutationObserver not defined.")},u.generateResize=function(){var t=[];function e(){t.forEach(function(e){e()})}return e.add=function(e){t.push(e)},e},u.endall=function(e,t){var i=0;e.each(function(){++i}).each("end",function(){--i||t.apply(this,arguments)})},u.generateWait=function(){function e(e,i){var n=setInterval(function(){var t=0;o.forEach(function(e){if(e.empty())t+=1;else try{e.transition()}catch(e){t+=1}}),t===o.length&&(clearInterval(n),i&&i())},10)}var o=[];return e.add=function(e){o.push(e)},e},u.parseDate=function(e){var t;return e instanceof Date?t=e:"string"==typeof e?t=this.dataTimeFormat(this.config.data_xFormat).parse(e):"number"!=typeof e&&isNaN(e)||(t=new Date(+e)),t&&!isNaN(+t)||c.console.error("Failed to parse x '"+e+"' to Date object"),t},u.isTabVisible=function(){var e;return void 0!==document.hidden?e="hidden":void 0!==document.mozHidden?e="mozHidden":void 0!==document.msHidden?e="msHidden":void 0!==document.webkitHidden&&(e="webkitHidden"),!document[e]},u.getDefaultConfig=function(){var t={bindto:"#chart",size_width:void 0,size_height:void 0,padding_left:void 0,padding_right:void 0,padding_top:void 0,padding_bottom:void 0,zoom_enabled:!1,zoom_extent:void 0,zoom_privileged:!1,zoom_rescale:!1,zoom_onzoom:function(){},zoom_onzoomstart:function(){},zoom_onzoomend:function(){},interaction_enabled:!0,onmouseover:function(){},onmouseout:function(){},onresize:function(){},onresized:function(){},oninit:function(){},onrendered:function(){},transition_duration:350,data_x:void 0,data_xs:{},data_xFormat:"%Y-%m-%d",data_xLocaltime:!0,data_xSort:!0,data_idConverter:function(e){return e},data_names:{},data_classes:{},data_groups:[],data_axes:{},data_type:void 0,data_types:{},data_labels:{},data_order:"desc",data_regions:{},data_color:void 0,data_colors:{},data_hide:!1,data_filter:void 0,data_selection_enabled:!1,data_selection_grouped:!1,data_selection_isselectable:function(){return!0},data_selection_multiple:!0,data_selection_draggable:!1,data_onclick:function(){},data_onmouseover:function(){},data_onmouseout:function(){},data_onselected:function(){},data_onunselected:function(){},data_url:void 0,data_json:void 0,data_rows:void 0,data_columns:void 0,data_mimeType:void 0,data_keys:void 0,data_empty_label_text:"",subchart_show:!1,subchart_size_height:60,subchart_onbrush:function(){},color_pattern:[],color_threshold:{},legend_show:!0,legend_hide:!1,legend_position:"bottom",legend_inset_anchor:"top-left",legend_inset_x:10,legend_inset_y:0,legend_inset_step:void 0,legend_item_onclick:void 0,legend_item_onmouseover:void 0,legend_item_onmouseout:void 0,legend_equally:!1,axis_rotated:!1,axis_x_show:!0,axis_x_type:"indexed",axis_x_localtime:!0,axis_x_categories:[],axis_x_tick_centered:!1,axis_x_tick_format:void 0,axis_x_tick_culling:{},axis_x_tick_culling_max:10,axis_x_tick_count:void 0,axis_x_tick_fit:!0,axis_x_tick_values:null,axis_x_tick_rotate:0,axis_x_tick_outer:!0,axis_x_tick_multiline:!0,axis_x_tick_width:null,axis_x_max:void 0,axis_x_min:void 0,axis_x_padding:{},axis_x_height:void 0,axis_x_extent:void 0,axis_x_label:{},axis_y_show:!0,axis_y_type:void 0,axis_y_max:void 0,axis_y_min:void 0,axis_y_inverted:!1,axis_y_center:void 0,axis_y_inner:void 0,axis_y_label:{},axis_y_tick_format:void 0,axis_y_tick_outer:!0,axis_y_tick_values:null,axis_y_tick_count:void 0,axis_y_tick_time_value:void 0,axis_y_tick_time_interval:void 0,axis_y_padding:{},axis_y_default:void 0,axis_y2_show:!1,axis_y2_max:void 0,axis_y2_min:void 0,axis_y2_inverted:!1,axis_y2_center:void 0,axis_y2_inner:void 0,axis_y2_label:{},axis_y2_tick_format:void 0,axis_y2_tick_outer:!0,axis_y2_tick_values:null,axis_y2_tick_count:void 0,axis_y2_padding:{},axis_y2_default:void 0,grid_x_show:!1,grid_x_type:"tick",grid_x_lines:[],grid_y_show:!1,grid_y_lines:[],grid_y_ticks:10,grid_focus_show:!0,grid_lines_front:!0,point_show:!0,point_r:2.5,point_focus_expand_enabled:!0,point_focus_expand_r:void 0,point_select_r:void 0,line_connectNull:!1,line_step_type:"step",bar_width:void 0,bar_width_ratio:.6,bar_width_max:void 0,bar_zerobased:!0,area_zerobased:!0,pie_label_show:!0,pie_label_format:void 0,pie_label_threshold:.05,pie_expand:!0,gauge_label_show:!0,gauge_label_format:void 0,gauge_expand:!0,gauge_min:0,gauge_max:100,gauge_units:void 0,gauge_width:void 0,donut_label_show:!0,donut_label_format:void 0,donut_label_threshold:.05,donut_width:void 0,donut_expand:!0,donut_title:"",regions:[],tooltip_show:!0,tooltip_grouped:!0,tooltip_format_title:void 0,tooltip_format_name:void 0,tooltip_format_value:void 0,tooltip_position:void 0,tooltip_contents:function(e,t,i,n){return this.getTooltipContent?this.getTooltipContent(e,t,i,n):""},tooltip_init_show:!1,tooltip_init_x:0,tooltip_init_position:{top:"0px",left:"50px"}};return Object.keys(this.additionalConfig).forEach(function(e){t[e]=this.additionalConfig[e]},this),t},u.additionalConfig={},u.loadConfig=function(t){var i,n,o,r=this.config;Object.keys(r).forEach(function(e){i=t,n=e.split("_"),o=function e(){var t=n.shift();return t&&i&&"object"==typeof i&&t in i?(i=i[t],e()):t?void 0:i}(),N(o)&&(r[e]=o)})},u.getScale=function(e,t,i){return(i?this.d3.time.scale():this.d3.scale.linear()).range([e,t])},u.getX=function(e,t,i,n){var o,r=this.getScale(e,t,this.isTimeSeries()),a=i?r.domain(i):r;for(o in r=this.isCategorized()?(n=n||function(){return 0},function(e,t){var i=a(e)+n(e);return t?i:Math.ceil(i)}):function(e,t){var i=a(e);return t?i:Math.ceil(i)},a)r[o]=a[o];return r.orgDomain=function(){return a.domain()},this.isCategorized()&&(r.domain=function(e){return arguments.length?(a.domain(e),r):[(e=this.orgDomain())[0],e[1]+1]}),r},u.getY=function(e,t,i){var n=this.getScale(e,t,this.isTimeSeriesY());return i&&n.domain(i),n},u.getYScale=function(e){return"y2"===this.axis.getId(e)?this.y2:this.y},u.getSubYScale=function(e){return"y2"===this.axis.getId(e)?this.subY2:this.subY},u.updateScales=function(){var t=this,e=t.config,i=!t.x;t.xMin=e.axis_rotated?1:0,t.xMax=e.axis_rotated?t.height:t.width,t.yMin=e.axis_rotated?0:t.height,t.yMax=e.axis_rotated?t.width:1,t.subXMin=t.xMin,t.subXMax=t.xMax,t.subYMin=e.axis_rotated?0:t.height2,t.subYMax=e.axis_rotated?t.width2:1,t.x=t.getX(t.xMin,t.xMax,i?void 0:t.x.orgDomain(),function(){return t.xAxis.tickOffset()}),t.y=t.getY(t.yMin,t.yMax,i?e.axis_y_default:t.y.domain()),t.y2=t.getY(t.yMin,t.yMax,i?e.axis_y2_default:t.y2.domain()),t.subX=t.getX(t.xMin,t.xMax,t.orgXDomain,function(e){return e%1?0:t.subXAxis.tickOffset()}),t.subY=t.getY(t.subYMin,t.subYMax,i?e.axis_y_default:t.subY.domain()),t.subY2=t.getY(t.subYMin,t.subYMax,i?e.axis_y2_default:t.subY2.domain()),t.xAxisTickFormat=t.axis.getXAxisTickFormat(),t.xAxisTickValues=t.axis.getXAxisTickValues(),t.yAxisTickValues=t.axis.getYAxisTickValues(),t.y2AxisTickValues=t.axis.getY2AxisTickValues(),t.xAxis=t.axis.getXAxis(t.x,t.xOrient,t.xAxisTickFormat,t.xAxisTickValues,e.axis_x_tick_outer),t.subXAxis=t.axis.getXAxis(t.subX,t.subXOrient,t.xAxisTickFormat,t.xAxisTickValues,e.axis_x_tick_outer),t.yAxis=t.axis.getYAxis(t.y,t.yOrient,e.axis_y_tick_format,t.yAxisTickValues,e.axis_y_tick_outer),t.y2Axis=t.axis.getYAxis(t.y2,t.y2Orient,e.axis_y2_tick_format,t.y2AxisTickValues,e.axis_y2_tick_outer),i||(t.brush&&t.brush.scale(t.subX),e.zoom_enabled&&t.zoom.scale(t.x)),t.updateArc&&t.updateArc()},u.getYDomainMin=function(e){var t,i,n,o,r,a,s=this,l=s.config,c=s.mapToIds(e),u=s.getValuesAsIdKeyed(e);if(0<l.data_groups.length)for(a=s.hasNegativeValueInTargets(e),t=0;t<l.data_groups.length;t++)if(0!==(o=l.data_groups[t].filter(function(e){return 0<=c.indexOf(e)})).length)for(n=o[0],a&&u[n]&&u[n].forEach(function(e,t){u[n][t]=e<0?e:0}),i=1;i<o.length;i++)r=o[i],u[r]&&u[r].forEach(function(e,t){s.axis.getId(r)!==s.axis.getId(n)||!u[n]||a&&0<+e||(u[n][t]+=+e)});return s.d3.min(Object.keys(u).map(function(e){return s.d3.min(u[e])}))},u.getYDomainMax=function(e){var t,i,n,o,r,a,s=this,l=s.config,c=s.mapToIds(e),u=s.getValuesAsIdKeyed(e);if(0<l.data_groups.length)for(a=s.hasPositiveValueInTargets(e),t=0;t<l.data_groups.length;t++)if(0!==(o=l.data_groups[t].filter(function(e){return 0<=c.indexOf(e)})).length)for(n=o[0],a&&u[n]&&u[n].forEach(function(e,t){u[n][t]=0<e?e:0}),i=1;i<o.length;i++)r=o[i],u[r]&&u[r].forEach(function(e,t){s.axis.getId(r)!==s.axis.getId(n)||!u[n]||a&&+e<0||(u[n][t]+=+e)});return s.d3.max(Object.keys(u).map(function(e){return s.d3.max(u[e])}))},u.getYDomain=function(e,t,i){var n,o,r,a,s,l,c,u,d,h,p=this,f=p.config,g=e.filter(function(e){return p.axis.getId(e.id)===t}),m=i?p.filterByXDomain(g,i):g,v="y2"===t?f.axis_y2_min:f.axis_y_min,y="y2"===t?f.axis_y2_max:f.axis_y_max,b=p.getYDomainMin(m),w=p.getYDomainMax(m),C="y2"===t?f.axis_y2_center:f.axis_y_center,_=p.hasType("bar",m)&&f.bar_zerobased||p.hasType("area",m)&&f.area_zerobased,A="y2"===t?f.axis_y2_inverted:f.axis_y_inverted,E=p.hasDataLabel()&&f.axis_rotated,x=p.hasDataLabel()&&!f.axis_rotated;return b=S(v)?v:S(y)?b<y?b:y-10:b,w=S(y)?y:S(v)?v<w?w:v+10:w,0===m.length?"y2"===t?p.y2.domain():p.y.domain():(isNaN(b)&&(b=0),isNaN(w)&&(w=b),b===w&&(b<0?w=0:b=0),d=0<=b&&0<=w,h=b<=0&&w<=0,(S(v)&&d||S(y)&&h)&&(_=!1),_&&(d&&(b=0),h&&(w=0)),r=a=.1*(o=Math.abs(w-b)),void 0!==C&&(w=C+(s=Math.max(Math.abs(b),Math.abs(w))),b=C-s),E?(l=p.getDataLabelLength(b,w,"width"),c=P(p.y.range()),r+=o*((u=[l[0]/c,l[1]/c])[1]/(1-u[0]-u[1])),a+=o*(u[0]/(1-u[0]-u[1]))):x&&(l=p.getDataLabelLength(b,w,"height"),r+=p.axis.convertPixelsToAxisPadding(l[1],o),a+=p.axis.convertPixelsToAxisPadding(l[0],o)),"y"===t&&T(f.axis_y_padding)&&(r=p.axis.getPadding(f.axis_y_padding,"top",r,o),a=p.axis.getPadding(f.axis_y_padding,"bottom",a,o)),"y2"===t&&T(f.axis_y2_padding)&&(r=p.axis.getPadding(f.axis_y2_padding,"top",r,o),a=p.axis.getPadding(f.axis_y2_padding,"bottom",a,o)),_&&(d&&(a=b),h&&(r=-w)),n=p.config.axis_rotated?[b,w]:[b-a,w+r],A?n.reverse():n)},u.getXDomainMin=function(e){var t=this,i=t.config;return N(i.axis_x_min)?t.isTimeSeries()?this.parseDate(i.axis_x_min):i.axis_x_min:t.d3.min(e,function(e){return t.d3.min(e.values,function(e){return e.x})})},u.getXDomainMax=function(e){var t=this,i=t.config;return N(i.axis_x_max)?t.isTimeSeries()?this.parseDate(i.axis_x_max):i.axis_x_max:t.d3.max(e,function(e){return t.d3.max(e.values,function(e){return e.x})})},u.getXDomainPadding=function(e){var t,i,n,o,r=this.config,a=e[1]-e[0];return i=this.isCategorized()?0:this.hasType("bar")?1<(t=this.getMaxDataCount())?a/(t-1)/2:.5:.01*a,"object"==typeof r.axis_x_padding&&T(r.axis_x_padding)?(n=S(r.axis_x_padding.left)?r.axis_x_padding.left:i,o=S(r.axis_x_padding.right)?r.axis_x_padding.right:i):n=o="number"==typeof r.axis_x_padding?r.axis_x_padding:i,{left:n,right:o}},u.getXDomain=function(e){var t=[this.getXDomainMin(e),this.getXDomainMax(e)],i=t[0],n=t[1],o=this.getXDomainPadding(t),r=0,a=0;return i-n!=0||this.isCategorized()||(n=this.isTimeSeries()?(i=new Date(.5*i.getTime()),new Date(1.5*n.getTime())):(i=0===i?1:.5*i,0===n?-1:1.5*n)),!i&&0!==i||(r=this.isTimeSeries()?new Date(i.getTime()-o.left):i-o.left),!n&&0!==n||(a=this.isTimeSeries()?new Date(n.getTime()+o.right):n+o.right),[r,a]},u.updateXDomain=function(e,t,i,n,o){var r=this,a=r.config;return i&&(r.x.domain(o||r.d3.extent(r.getXDomain(e))),r.orgXDomain=r.x.domain(),a.zoom_enabled&&r.zoom.scale(r.x).updateScaleExtent(),r.subX.domain(r.x.domain()),r.brush&&r.brush.scale(r.subX)),t&&(r.x.domain(o||(!r.brush||r.brush.empty()?r.orgXDomain:r.brush.extent())),a.zoom_enabled&&r.zoom.scale(r.x).updateScaleExtent()),n&&r.x.domain(r.trimXDomain(r.x.orgDomain())),r.x.domain()},u.trimXDomain=function(e){return e[0]<=this.orgXDomain[0]&&(e[1]=+e[1]+(this.orgXDomain[0]-e[0]),e[0]=this.orgXDomain[0]),this.orgXDomain[1]<=e[1]&&(e[0]=+e[0]-(e[1]-this.orgXDomain[1]),e[1]=this.orgXDomain[1]),e},u.isX=function(e){var t=this.config;return t.data_x&&e===t.data_x||T(t.data_xs)&&p(t.data_xs,e)},u.isNotX=function(e){return!this.isX(e)},u.getXKey=function(e){var t=this.config;return t.data_x?t.data_x:T(t.data_xs)?t.data_xs[e]:null},u.getXValuesOfXKey=function(t,e){var i,n=this;return(e&&T(e)?n.mapToIds(e):[]).forEach(function(e){n.getXKey(e)===t&&(i=n.data.xs[e])}),i},u.getIndexByX=function(e){var t=this.filterByX(this.data.targets,e);return t.length?t[0].index:null},u.getXValue=function(e,t){return e in this.data.xs&&this.data.xs[e]&&S(this.data.xs[e][t])?this.data.xs[e][t]:t},u.getOtherTargetXs=function(){var e=Object.keys(this.data.xs);return e.length?this.data.xs[e[0]]:null},u.getOtherTargetX=function(e){var t=this.getOtherTargetXs();return t&&e<t.length?t[e]:null},u.addXs=function(t){var i=this;Object.keys(t).forEach(function(e){i.config.data_xs[e]=t[e]})},u.hasMultipleX=function(t){return 1<this.d3.set(Object.keys(t).map(function(e){return t[e]})).size()},u.isMultipleX=function(){return T(this.config.data_xs)||!this.config.data_xSort||this.hasType("scatter")},u.addName=function(e){var t;return e&&(t=this.config.data_names[e.id],e.name=t||e.id),e},u.getValueOnIndex=function(e,t){var i=e.filter(function(e){return e.index===t});return i.length?i[0]:null},u.updateTargetX=function(e,n){var o=this;e.forEach(function(i){i.values.forEach(function(e,t){e.x=o.generateTargetX(n[t],i.id,t)}),o.data.xs[i.id]=n})},u.updateTargetXs=function(e,t){var i=this;e.forEach(function(e){t[e.id]&&i.updateTargetX([e],t[e.id])})},u.generateTargetX=function(e,t,i){return this.isTimeSeries()?e?this.parseDate(e):this.parseDate(this.getXValue(t,i)):this.isCustomX()&&!this.isCategorized()?S(e)?+e:this.getXValue(t,i):i},u.cloneTarget=function(e){return{id:e.id,id_org:e.id_org,values:e.values.map(function(e){return{x:e.x,value:e.value,id:e.id}})}},u.updateXs=function(){var t=this;t.data.targets.length&&(t.xs=[],t.data.targets[0].values.forEach(function(e){t.xs[e.index]=e.x}))},u.getPrevX=function(e){var t=this.xs[e-1];return void 0!==t?t:null},u.getNextX=function(e){var t=this.xs[e+1];return void 0!==t?t:null},u.getMaxDataCount=function(){return this.d3.max(this.data.targets,function(e){return e.values.length})},u.getMaxDataCountTarget=function(e){var t,i=e.length,n=0;return 1<i?e.forEach(function(e){e.values.length>n&&(n=(t=e).values.length)}):t=i?e[0]:null,t},u.getEdgeX=function(e){return e.length?[this.d3.min(e,function(e){return e.values[0].x}),this.d3.max(e,function(e){return e.values[e.values.length-1].x})]:[0,0]},u.mapToIds=function(e){return e.map(function(e){return e.id})},u.mapToTargetIds=function(e){return e?r(e)?[e]:e:this.mapToIds(this.data.targets)},u.hasTarget=function(e,t){var i,n=this.mapToIds(e);for(i=0;i<n.length;i++)if(n[i]===t)return!0;return!1},u.isTargetToShow=function(e){return this.hiddenTargetIds.indexOf(e)<0},u.isLegendToShow=function(e){return this.hiddenLegendIds.indexOf(e)<0},u.filterTargetsToShow=function(e){var t=this;return e.filter(function(e){return t.isTargetToShow(e.id)})},u.mapTargetsToUniqueXs=function(e){var t=this.d3.set(this.d3.merge(e.map(function(e){return e.values.map(function(e){return+e.x})}))).values();return this.isTimeSeries()?t.map(function(e){return new Date(+e)}):t.map(function(e){return+e})},u.addHiddenTargetIds=function(e){this.hiddenTargetIds=this.hiddenTargetIds.concat(e)},u.removeHiddenTargetIds=function(t){this.hiddenTargetIds=this.hiddenTargetIds.filter(function(e){return t.indexOf(e)<0})},u.addHiddenLegendIds=function(e){this.hiddenLegendIds=this.hiddenLegendIds.concat(e)},u.removeHiddenLegendIds=function(t){this.hiddenLegendIds=this.hiddenLegendIds.filter(function(e){return t.indexOf(e)<0})},u.getValuesAsIdKeyed=function(e){var i={};return e.forEach(function(t){i[t.id]=[],t.values.forEach(function(e){i[t.id].push(e.value)})}),i},u.checkValueInTargets=function(e,t){var i,n,o,r=Object.keys(e);for(i=0;i<r.length;i++)for(o=e[r[i]].values,n=0;n<o.length;n++)if(t(o[n].value))return!0;return!1},u.hasNegativeValueInTargets=function(e){return this.checkValueInTargets(e,function(e){return e<0})},u.hasPositiveValueInTargets=function(e){return this.checkValueInTargets(e,function(e){return 0<e})},u.isOrderDesc=function(){var e=this.config;return"string"==typeof e.data_order&&"desc"===e.data_order.toLowerCase()},u.isOrderAsc=function(){var e=this.config;return"string"==typeof e.data_order&&"asc"===e.data_order.toLowerCase()},u.orderTargets=function(e){var t=this.config,r=this.isOrderAsc(),i=this.isOrderDesc();return r||i?e.sort(function(e,t){function i(e,t){return e+Math.abs(t.value)}var n=e.values.reduce(i,0),o=t.values.reduce(i,0);return r?o-n:n-o}):d(t.data_order)&&e.sort(t.data_order),e},u.filterByX=function(e,t){return this.d3.merge(e.map(function(e){return e.values})).filter(function(e){return e.x-t==0})},u.filterRemoveNull=function(e){return e.filter(function(e){return S(e.value)})},u.filterByXDomain=function(e,t){return e.map(function(e){return{id:e.id,id_org:e.id_org,values:e.values.filter(function(e){return t[0]<=e.x&&e.x<=t[1]})}})},u.hasDataLabel=function(){var e=this.config;return!("boolean"!=typeof e.data_labels||!e.data_labels)||!("object"!=typeof e.data_labels||!T(e.data_labels))},u.getDataLabelLength=function(e,t,i){var n=this,o=[0,0];return n.selectChart.select("svg").selectAll(".dummy").data([e,t]).enter().append("text").text(function(e){return n.dataLabelFormat(e.id)(e)}).each(function(e,t){o[t]=1.3*this.getBoundingClientRect()[i]}).remove(),o},u.isNoneArc=function(e){return this.hasTarget(this.data.targets,e.id)},u.isArc=function(e){return"data"in e&&this.hasTarget(this.data.targets,e.data.id)},u.findSameXOfValues=function(e,t){var i,n=e[t].x,o=[];for(i=t-1;0<=i&&n===e[i].x;i--)o.push(e[i]);for(i=t;i<e.length&&n===e[i].x;i++)o.push(e[i]);return o},u.findClosestFromTargets=function(e,t){var i,n=this;return i=e.map(function(e){return n.findClosest(e.values,t)}),n.findClosest(i,t)},u.findClosest=function(e,i){var n,o=this,r=100;return e.filter(function(e){return e&&o.isBarType(e.id)}).forEach(function(e){var t=o.main.select("."+$.bars+o.getTargetSelectorSuffix(e.id)+" ."+$.bar+"-"+e.index).node();!n&&o.isWithinBar(t)&&(n=e)}),e.filter(function(e){return e&&!o.isBarType(e.id)}).forEach(function(e){var t=o.dist(e,i);t<r&&(r=t,n=e)}),n},u.dist=function(e,t){var i=this.config,n=i.axis_rotated?1:0,o=i.axis_rotated?0:1,r=this.circleY(e,e.index),a=this.x(e.x);return Math.pow(a-t[n],2)+Math.pow(r-t[o],2)},u.convertValuesToStep=function(e){var t,i=[].concat(e);if(!this.isCategorized())return e;for(t=e.length+1;0<t;t--)i[t]=i[t-1];return i[0]={x:i[0].x-1,value:i[0].value,id:i[0].id},i[e.length+1]={x:i[e.length].x+1,value:i[e.length].value,id:i[e.length].id},i},u.updateDataAttributes=function(e,t){var i=this.config["data_"+e];return void 0===t||(Object.keys(t).forEach(function(e){i[e]=t[e]}),this.redraw({withLegend:!0})),i},u.convertUrlToData=function(e,t,n,o){var r=this,a=t||"csv";r.d3.xhr(e,function(e,t){var i;if(!t)throw new Error(e.responseURL+" "+e.status+" ("+e.statusText+")");i="json"===a?r.convertJsonToData(JSON.parse(t.response),n):"tsv"===a?r.convertTsvToData(t.response):r.convertCsvToData(t.response),o.call(r,i)})},u.convertXsvToData=function(e,t){var i,n=t.parseRows(e);return 1===n.length?(i=[{}],n[0].forEach(function(e){i[0][e]=null})):i=t.parse(e),i},u.convertCsvToData=function(e){return this.convertXsvToData(e,this.d3.csv)},u.convertTsvToData=function(e){return this.convertXsvToData(e,this.d3.tsv)},u.convertJsonToData=function(t,e){var o,r=[];return e?(e.x?(o=e.value.concat(e.x),this.config.data_x=e.x):o=e.value,r.push(o),t.forEach(function(i){var n=[];o.forEach(function(e){var t=_(i[e])?null:i[e];n.push(t)}),r.push(n)}),this.convertRowsToData(r)):(Object.keys(t).forEach(function(e){r.push([e].concat(t[e]))}),this.convertColumnsToData(r))},u.convertRowsToData=function(e){var t,i,n=e[0],o={},r=[];for(t=1;t<e.length;t++){for(o={},i=0;i<e[t].length;i++){if(_(e[t][i]))throw new Error("Source data is missing a component at ("+t+","+i+")!");o[n[i]]=e[t][i]}r.push(o)}return r},u.convertColumnsToData=function(e){var t,i,n,o=[];for(t=0;t<e.length;t++)for(n=e[t][0],i=1;i<e[t].length;i++){if(_(o[i-1])&&(o[i-1]={}),_(e[t][i]))throw new Error("Source data is missing a component at ("+t+","+i+")!");o[i-1][n]=e[t][i]}return o},u.convertDataToTargets=function(e,n){var t,s=this,l=s.config,i=s.d3.keys(e[0]).filter(s.isNotX,s),o=s.d3.keys(e[0]).filter(s.isX,s);return i.forEach(function(i){var t=s.getXKey(i);s.isCustomX()||s.isTimeSeries()?0<=o.indexOf(t)?s.data.xs[i]=(n&&s.data.xs[i]?s.data.xs[i]:[]).concat(e.map(function(e){return e[t]}).filter(S).map(function(e,t){return s.generateTargetX(e,i,t)})):l.data_x?s.data.xs[i]=s.getOtherTargetXs():T(l.data_xs)&&(s.data.xs[i]=s.getXValuesOfXKey(t,s.data.targets)):s.data.xs[i]=e.map(function(e,t){return t})}),i.forEach(function(e){if(!s.data.xs[e])throw new Error('x is not defined for id = "'+e+'".')}),(t=i.map(function(o,r){var a=l.data_idConverter(o);return{id:a,id_org:o,values:e.map(function(e,t){var i=e[s.getXKey(o)],n=s.generateTargetX(i,o,t);return s.isCustomX()&&s.isCategorized()&&0===r&&i&&(0===t&&(l.axis_x_categories=[]),l.axis_x_categories.push(i)),(_(e[o])||s.data.xs[o].length<=t)&&(n=void 0),{x:n,value:null===e[o]||isNaN(e[o])?null:+e[o],id:a}}).filter(function(e){return N(e.x)})}})).forEach(function(e){var t;l.data_xSort&&(e.values=e.values.sort(function(e,t){return(e.x||0===e.x?e.x:1/0)-(t.x||0===t.x?t.x:1/0)})),t=0,e.values.forEach(function(e){e.index=t++}),s.data.xs[e.id].sort(function(e,t){return e-t})}),l.data_type&&s.setTargetType(s.mapToIds(t).filter(function(e){return!(e in l.data_types)}),l.data_type),t.forEach(function(e){s.addCache(e.id_org,e)}),t},u.load=function(i,n){var o=this;i&&(n.filter&&(i=i.filter(n.filter)),(n.type||n.types)&&i.forEach(function(e){var t=n.types&&n.types[e.id]?n.types[e.id]:n.type;o.setTargetType(e.id,t)}),o.data.targets.forEach(function(e){for(var t=0;t<i.length;t++)if(e.id===i[t].id){e.values=i[t].values,i.splice(t,1);break}}),o.data.targets=o.data.targets.concat(i)),o.updateTargets(o.data.targets),o.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),n.done&&n.done()},u.loadFromArgs=function(t){var i=this;t.data?i.load(i.convertDataToTargets(t.data),t):t.url?i.convertUrlToData(t.url,t.mimeType,t.keys,function(e){i.load(i.convertDataToTargets(e),t)}):t.json?i.load(i.convertDataToTargets(i.convertJsonToData(t.json,t.keys)),t):t.rows?i.load(i.convertDataToTargets(i.convertRowsToData(t.rows)),t):t.columns?i.load(i.convertDataToTargets(i.convertColumnsToData(t.columns)),t):i.load(null,t)},u.unload=function(e,t){var i=this;t=t||function(){},(e=e.filter(function(e){return i.hasTarget(i.data.targets,e)}))&&0!==e.length?(i.svg.selectAll(e.map(function(e){return i.selectorTarget(e)})).transition().style("opacity",0).remove().call(i.endall,t),e.forEach(function(t){i.withoutFadeIn[t]=!1,i.legend&&i.legend.selectAll("."+$.legendItem+i.getTargetSelectorSuffix(t)).remove(),i.data.targets=i.data.targets.filter(function(e){return e.id!==t})})):t()},u.categoryName=function(e){var t=this.config;return e<t.axis_x_categories.length?t.axis_x_categories[e]:e},u.initEventRect=function(){this.main.select("."+$.chart).append("g").attr("class",$.eventRects).style("fill-opacity",0)},u.redrawEventRect=function(){var e,t,i=this,n=i.config,o=i.isMultipleX(),r=i.main.select("."+$.eventRects).style("cursor",n.zoom_enabled?n.axis_rotated?"ns-resize":"ew-resize":null).classed($.eventRectsMultiple,o).classed($.eventRectsSingle,!o);r.selectAll("."+$.eventRect).remove(),i.eventRect=r.selectAll("."+$.eventRect),o?(e=i.eventRect.data([0]),i.generateEventRectsForMultipleXs(e.enter()),i.updateEventRect(e)):(t=i.getMaxDataCountTarget(i.data.targets),r.datum(t?t.values:[]),i.eventRect=r.selectAll("."+$.eventRect),e=i.eventRect.data(function(e){return e}),i.generateEventRectsForSingleX(e.enter()),i.updateEventRect(e),e.exit().remove())},u.updateEventRect=function(e){var t,i,n,o,r,a,s=this,l=s.config;e=e||s.eventRect.data(function(e){return e}),o=s.isMultipleX()?(i=t=0,n=s.width,s.height):(a=!s.isCustomX()&&!s.isTimeSeries()||s.isCategorized()?(r=s.getEventRectWidth(),function(e){return s.x(e.x)-r/2}):(s.updateXs(),r=function(e){var t=s.getPrevX(e.index),i=s.getNextX(e.index);return null===t&&null===i?l.axis_rotated?s.height:s.width:(null===t&&(t=s.x.domain()[0]),null===i&&(i=s.x.domain()[1]),Math.max(0,(s.x(i)-s.x(t))/2))},function(e){var t=s.getPrevX(e.index),i=s.getNextX(e.index),n=s.data.xs[e.id][e.index];return null===t&&null===i?0:(null===t&&(t=s.x.domain()[0]),(s.x(n)+s.x(t))/2)}),t=l.axis_rotated?0:a,i=l.axis_rotated?a:0,n=l.axis_rotated?s.width:r,l.axis_rotated?r:s.height),e.attr("class",s.classEvent.bind(s)).attr("x",t).attr("y",i).attr("width",n).attr("height",o)},u.generateEventRectsForSingleX=function(e){var o=this,r=o.d3,a=o.config;e.append("rect").attr("class",o.classEvent.bind(o)).style("cursor",a.data_selection_enabled&&a.data_selection_grouped?"pointer":null).on("mouseover",function(e){var t=e.index;o.dragging||o.flowing||o.hasArcType()||(a.point_focus_expand_enabled&&o.expandCircles(t,null,!0),o.expandBars(t,null,!0),o.main.selectAll("."+$.shape+"-"+t).each(function(e){a.data_onmouseover.call(o.api,e)}))}).on("mouseout",function(e){var t=e.index;o.config&&(o.hasArcType()||(o.hideXGridFocus(),o.hideTooltip(),o.unexpandCircles(),o.unexpandBars(),o.main.selectAll("."+$.shape+"-"+t).each(function(e){a.data_onmouseout.call(o.api,e)})))}).on("mousemove",function(e){var t,i=e.index,n=o.svg.select("."+$.eventRect+"-"+i);o.dragging||o.flowing||o.hasArcType()||(o.isStepType(e)&&"step-after"===o.config.line_step_type&&r.mouse(this)[0]<o.x(o.getXValue(e.id,i))&&(i-=1),t=o.filterTargetsToShow(o.data.targets).map(function(e){return o.addName(o.getValueOnIndex(e.values,i))}),a.tooltip_grouped&&(o.showTooltip(t,this),o.showXGridFocus(t)),a.tooltip_grouped&&(!a.data_selection_enabled||a.data_selection_grouped)||o.main.selectAll("."+$.shape+"-"+i).each(function(){r.select(this).classed($.EXPANDED,!0),a.data_selection_enabled&&n.style("cursor",a.data_selection_grouped?"pointer":null),a.tooltip_grouped||(o.hideXGridFocus(),o.hideTooltip(),a.data_selection_grouped||(o.unexpandCircles(i),o.unexpandBars(i)))}).filter(function(e){return o.isWithinShape(this,e)}).each(function(e){a.data_selection_enabled&&(a.data_selection_grouped||a.data_selection_isselectable(e))&&n.style("cursor","pointer"),a.tooltip_grouped||(o.showTooltip([e],this),o.showXGridFocus([e]),a.point_focus_expand_enabled&&o.expandCircles(i,e.id,!0),o.expandBars(i,e.id,!0))}))}).on("click",function(e){var t=e.index;!o.hasArcType()&&o.toggleShape&&(o.cancelClick?o.cancelClick=!1:(o.isStepType(e)&&"step-after"===a.line_step_type&&r.mouse(this)[0]<o.x(o.getXValue(e.id,t))&&(t-=1),o.main.selectAll("."+$.shape+"-"+t).each(function(e){(a.data_selection_grouped||o.isWithinShape(this,e))&&(o.toggleShape(this,e,t),o.config.data_onclick.call(o.api,e,this))})))}).call(a.data_selection_draggable&&o.drag?r.behavior.drag().origin(Object).on("drag",function(){o.drag(r.mouse(this))}).on("dragstart",function(){o.dragstart(r.mouse(this))}).on("dragend",function(){o.dragend()}):function(){})},u.generateEventRectsForMultipleXs=function(e){var o=this,r=o.d3,a=o.config;function s(){o.svg.select("."+$.eventRect).style("cursor",null),o.hideXGridFocus(),o.hideTooltip(),o.unexpandCircles(),o.unexpandBars()}e.append("rect").attr("x",0).attr("y",0).attr("width",o.width).attr("height",o.height).attr("class",$.eventRect).on("mouseout",function(){o.config&&(o.hasArcType()||s())}).on("mousemove",function(){var e,t,i,n=o.filterTargetsToShow(o.data.targets);o.dragging||o.hasArcType(n)||(e=r.mouse(this),t=o.findClosestFromTargets(n,e),!o.mouseover||t&&t.id===o.mouseover.id||(a.data_onmouseout.call(o.api,o.mouseover),o.mouseover=void 0),t?(i=(o.isScatterType(t)||!a.tooltip_grouped?[t]:o.filterByX(n,t.x)).map(function(e){return o.addName(e)}),o.showTooltip(i,this),a.point_focus_expand_enabled&&o.expandCircles(t.index,t.id,!0),o.expandBars(t.index,t.id,!0),o.showXGridFocus(i),(o.isBarType(t.id)||o.dist(t,e)<100)&&(o.svg.select("."+$.eventRect).style("cursor","pointer"),o.mouseover||(a.data_onmouseover.call(o.api,t),o.mouseover=t))):s())}).on("click",function(){var e,t,i=o.filterTargetsToShow(o.data.targets);o.hasArcType(i)||(e=r.mouse(this),(t=o.findClosestFromTargets(i,e))&&(o.isBarType(t.id)||o.dist(t,e)<100)&&o.main.selectAll("."+$.shapes+o.getTargetSelectorSuffix(t.id)).selectAll("."+$.shape+"-"+t.index).each(function(){(a.data_selection_grouped||o.isWithinShape(this,t))&&(o.toggleShape(this,t,t.index),o.config.data_onclick.call(o.api,t,this))}))}).call(a.data_selection_draggable&&o.drag?r.behavior.drag().origin(Object).on("drag",function(){o.drag(r.mouse(this))}).on("dragstart",function(){o.dragstart(r.mouse(this))}).on("dragend",function(){o.dragend()}):function(){})},u.dispatchEvent=function(e,t,i){var n="."+$.eventRect+(this.isMultipleX()?"":"-"+t),o=this.main.select(n).node(),r=o.getBoundingClientRect(),a=r.left+(i?i[0]:0),s=r.top+(i?i[1]:0),l=document.createEvent("MouseEvents");l.initMouseEvent(e,!0,!0,c,0,a,s,a,s,!1,!1,!1,!1,0,null),o.dispatchEvent(l)},u.getCurrentWidth=function(){var e=this.config;return e.size_width?e.size_width:this.getParentWidth()},u.getCurrentHeight=function(){var e=this.config,t=e.size_height?e.size_height:this.getParentHeight();return 0<t?t:320/(this.hasType("gauge")?2:1)},u.getCurrentPaddingTop=function(){var e=this.config;return S(e.padding_top)?e.padding_top:0},u.getCurrentPaddingBottom=function(){var e=this.config;return S(e.padding_bottom)?e.padding_bottom:0},u.getCurrentPaddingLeft=function(e){var t=this.config;return S(t.padding_left)?t.padding_left:t.axis_rotated?t.axis_x_show?Math.max(a(this.getAxisWidthByAxisId("x",e)),40):1:!t.axis_y_show||t.axis_y_inner?this.axis.getYAxisLabelPosition().isOuter?30:1:a(this.getAxisWidthByAxisId("y",e))},u.getCurrentPaddingRight=function(){var e=this.config,t=this.isLegendRight?this.getLegendWidth()+20:0;return S(e.padding_right)?e.padding_right+1:e.axis_rotated?10+t:!e.axis_y2_show||e.axis_y2_inner?2+t+(this.axis.getY2AxisLabelPosition().isOuter?20:0):a(this.getAxisWidthByAxisId("y2"))+t},u.getParentRectValue=function(t){for(var i,n=this.selectChart.node();n&&"BODY"!==n.tagName;){try{i=n.getBoundingClientRect()[t]}catch(e){"width"===t&&(i=n.offsetWidth)}if(i)break;n=n.parentNode}return i},u.getParentWidth=function(){return this.getParentRectValue("width")},u.getParentHeight=function(){var e=this.selectChart.style("height");return 0<e.indexOf("px")?+e.replace("px",""):0},u.getSvgLeft=function(e){var t=this.config,i=t.axis_rotated||!t.axis_rotated&&!t.axis_y_inner,n=t.axis_rotated?$.axisX:$.axisY,o=this.main.select("."+n).node(),r=o&&i?o.getBoundingClientRect():{right:0},a=this.selectChart.node().getBoundingClientRect(),s=this.hasArcType(),l=r.right-a.left-(s?0:this.getCurrentPaddingLeft(e));return 0<l?l:0},u.getAxisWidthByAxisId=function(e,t){var i=this.axis.getLabelPositionById(e);return this.axis.getMaxTickWidth(e,t)+(i.isInner?20:40)},u.getHorizontalAxisHeight=function(e){var t=this.config,i=30;return"x"!==e||t.axis_x_show?"x"===e&&t.axis_x_height?t.axis_x_height:"y"!==e||t.axis_y_show?"y2"!==e||t.axis_y2_show?("x"===e&&!t.axis_rotated&&t.axis_x_tick_rotate&&(i=30+this.axis.getMaxTickWidth(e)*Math.cos(Math.PI*(90-t.axis_x_tick_rotate)/180)),i+(this.axis.getLabelPositionById(e).isInner?0:10)+("y2"===e?-10:0)):this.rotated_padding_top:!t.legend_show||this.isLegendRight||this.isLegendInset?1:10:8},u.getEventRectWidth=function(){return Math.max(0,this.xAxis.tickInterval())},u.getShapeIndices=function(e){var t,i,n=this.config,o={},r=0;return this.filterTargetsToShow(this.data.targets.filter(e,this)).forEach(function(e){for(t=0;t<n.data_groups.length;t++)if(!(n.data_groups[t].indexOf(e.id)<0))for(i=0;i<n.data_groups[t].length;i++)if(n.data_groups[t][i]in o){o[e.id]=o[n.data_groups[t][i]];break}_(o[e.id])&&(o[e.id]=r++)}),o.__max__=r-1,o},u.getShapeX=function(i,n,o,e){var r=e?this.subX:this.x;return function(e){var t=e.id in o?o[e.id]:0;return e.x||0===e.x?r(e.x)-i*(n/2-t):0}},u.getShapeY=function(t){var i=this;return function(e){return(t?i.getSubYScale(e.id):i.getYScale(e.id))(e.value)}},u.getShapeOffset=function(e,s,t){var l=this,c=l.orderTargets(l.filterTargetsToShow(l.data.targets.filter(e,l))),u=c.map(function(e){return e.id});return function(i,n){var o=t?l.getSubYScale(i.id):l.getYScale(i.id),r=o(0),a=r;return c.forEach(function(e){var t=l.isStepType(i)?l.convertValuesToStep(e.values):e.values;e.id!==i.id&&s[e.id]===s[i.id]&&u.indexOf(e.id)<u.indexOf(i.id)&&0<=t[n].value*i.value&&(a+=o(t[n].value)-r)}),a}},u.isWithinShape=function(e,t){var i,n=this.d3.select(e);return this.isTargetToShow(t.id)?"circle"===e.nodeName?i=this.isStepType(t)?this.isWithinStep(e,this.getYScale(t.id)(t.value)):this.isWithinCircle(e,1.5*this.pointSelectR(t)):"path"===e.nodeName&&(i=!n.classed($.bar)||this.isWithinBar(e)):i=!1,i},u.getInterpolate=function(e){return this.isSplineType(e)?"cardinal":this.isStepType(e)?this.config.line_step_type:"linear"},u.initLine=function(){this.main.select("."+$.chart).append("g").attr("class",$.chartLines)},u.updateTargetsForLine=function(e){var t,i=this,n=i.config,o=i.classChartLine.bind(i),r=i.classLines.bind(i),a=i.classAreas.bind(i),s=i.classCircles.bind(i),l=i.classFocus.bind(i);(t=i.main.select("."+$.chartLines).selectAll("."+$.chartLine).data(e).attr("class",function(e){return o(e)+l(e)}).enter().append("g").attr("class",o).style("opacity",0).style("pointer-events","none")).append("g").attr("class",r),t.append("g").attr("class",a),t.append("g").attr("class",function(e){return i.generateClass($.selectedCircles,e.id)}),t.append("g").attr("class",s).style("cursor",function(e){return n.data_selection_isselectable(e)?"pointer":null}),e.forEach(function(t){i.main.selectAll("."+$.selectedCircles+i.getTargetSelectorSuffix(t.id)).selectAll("."+$.selectedCircle).each(function(e){e.value=t.values[e.index].value})})},u.updateLine=function(e){var t=this;t.mainLine=t.main.selectAll("."+$.lines).selectAll("."+$.line).data(t.lineData.bind(t)),t.mainLine.enter().append("path").attr("class",t.classLine.bind(t)).style("stroke",t.color),t.mainLine.style("opacity",t.initialOpacity.bind(t)).style("shape-rendering",function(e){return t.isStepType(e)?"crispEdges":""}).attr("transform",null),t.mainLine.exit().transition().duration(e).style("opacity",0).remove()},u.redrawLine=function(e,t){return[(t?this.mainLine.transition():this.mainLine).attr("d",e).style("stroke",this.color).style("opacity",1)]},u.generateDrawLine=function(e,a){function t(e){return(a?s.subxx:s.xx).call(s,e)}function i(e,t){return 0<l.data_groups.length?n(e,t)[0][1]:u.call(s,e.id)(e.value)}var s=this,l=s.config,c=s.d3.svg.line(),n=s.generateGetLinePoints(e,a),u=a?s.getSubYScale:s.getYScale;return c=l.axis_rotated?c.x(i).y(t):c.x(t).y(i),l.line_connectNull||(c=c.defined(function(e){return null!=e.value})),function(e){var t=l.line_connectNull?s.filterRemoveNull(e.values):e.values,i=a?s.x:s.subX,n=u.call(s,e.id),o=0,r=0;return(s.isLineType(e)?l.data_regions[e.id]?s.lineWithRegions(t,i,n,l.data_regions[e.id]):(s.isStepType(e)&&(t=s.convertValuesToStep(t)),c.interpolate(s.getInterpolate(e))(t)):(t[0]&&(o=i(t[0].x),r=n(t[0].value)),l.axis_rotated?"M "+r+" "+o:"M "+o+" "+r))||"M 0 0"}},u.generateGetLinePoints=function(e,t){var a=this,s=a.config,i=e.__max__+1,l=a.getShapeX(0,i,e,!!t),c=a.getShapeY(!!t),u=a.getShapeOffset(a.isLineType,e,!!t),d=t?a.getSubYScale:a.getYScale;return function(e,t){var i=d.call(a,e.id)(0),n=u(e,t)||i,o=l(e),r=c(e);return s.axis_rotated&&(0<e.value&&r<i||e.value<0&&i<r)&&(r=i),[[o,r-(i-n)],[o,r-(i-n)],[o,r-(i-n)],[o,r-(i-n)]]}},u.lineWithRegions=function(e,l,c,t){var i,n,o,r,u,a,s,d,h,p,f,g=this,m=g.config,v="M",y=g.isCategorized()?.5:0,b=[];function w(e,t){var i;for(i=0;i<t.length;i++)if(t[i].start<e&&e<=t[i].end)return!0;return!1}if(N(t))for(i=0;i<t.length;i++)b[i]={},_(t[i].start)?b[i].start=e[0].x:b[i].start=g.isTimeSeries()?g.parseDate(t[i].start):t[i].start,_(t[i].end)?b[i].end=e[e.length-1].x:b[i].end=g.isTimeSeries()?g.parseDate(t[i].end):t[i].end;function C(e){return"M"+e[0][0]+" "+e[0][1]+" "+e[1][0]+" "+e[1][1]}for(p=m.axis_rotated?function(e){return c(e.value)}:function(e){return l(e.x)},f=m.axis_rotated?function(e){return l(e.x)}:function(e){return c(e.value)},o=g.isTimeSeries()?function(e,t,i,n){var o=e.x.getTime(),r=t.x-e.x,a=new Date(o+r*i),s=new Date(o+r*(i+n));return C(m.axis_rotated?[[c(u(i)),l(a)],[c(u(i+n)),l(s)]]:[[l(a),c(u(i))],[l(s),c(u(i+n))]])}:function(e,t,i,n){return C(m.axis_rotated?[[c(u(i),!0),l(r(i))],[c(u(i+n),!0),l(r(i+n))]]:[[l(r(i),!0),c(u(i))],[l(r(i+n),!0),c(u(i+n))]])},i=0;i<e.length;i++){if(_(b)||!w(e[i].x,b))v+=" "+p(e[i])+" "+f(e[i]);else for(r=g.getScale(e[i-1].x+y,e[i].x+y,g.isTimeSeries()),u=g.getScale(e[i-1].value,e[i].value),a=l(e[i].x)-l(e[i-1].x),s=c(e[i].value)-c(e[i-1].value),h=2*(d=2/Math.sqrt(Math.pow(a,2)+Math.pow(s,2))),n=d;n<=1;n+=h)v+=o(e[i-1],e[i],n,d);e[i].x}return v},u.updateArea=function(e){var t=this,i=t.d3;t.mainArea=t.main.selectAll("."+$.areas).selectAll("."+$.area).data(t.lineData.bind(t)),t.mainArea.enter().append("path").attr("class",t.classArea.bind(t)).style("fill",t.color).style("opacity",function(){return t.orgAreaOpacity=+i.select(this).style("opacity"),0}),t.mainArea.style("opacity",t.orgAreaOpacity),t.mainArea.exit().transition().duration(e).style("opacity",0).remove()},u.redrawArea=function(e,t){return[(t?this.mainArea.transition():this.mainArea).attr("d",e).style("fill",this.color).style("opacity",this.orgAreaOpacity)]},u.generateDrawArea=function(e,t){function i(e){return(t?r.subxx:r.xx).call(r,e)}function n(e,t){return 0<a.data_groups.length?l(e,t)[0][1]:c.call(r,e.id)(r.getAreaBaseValue(e.id))}function o(e,t){return 0<a.data_groups.length?l(e,t)[1][1]:c.call(r,e.id)(e.value)}var r=this,a=r.config,s=r.d3.svg.area(),l=r.generateGetAreaPoints(e,t),c=t?r.getSubYScale:r.getYScale;return s=a.axis_rotated?s.x0(n).x1(o).y(i):s.x(i).y0(n).y1(o),a.line_connectNull||(s=s.defined(function(e){return null!==e.value})),function(e){var t=a.line_connectNull?r.filterRemoveNull(e.values):e.values,i=0,n=0;return(r.isAreaType(e)?(r.isStepType(e)&&(t=r.convertValuesToStep(t)),s.interpolate(r.getInterpolate(e))(t)):(t[0]&&(i=r.x(t[0].x),n=r.getYScale(e.id)(t[0].value)),a.axis_rotated?"M "+n+" "+i:"M "+i+" "+n))||"M 0 0"}},u.getAreaBaseValue=function(){return 0},u.generateGetAreaPoints=function(e,t){var a=this,s=a.config,i=e.__max__+1,l=a.getShapeX(0,i,e,!!t),c=a.getShapeY(!!t),u=a.getShapeOffset(a.isAreaType,e,!!t),d=t?a.getSubYScale:a.getYScale;return function(e,t){var i=d.call(a,e.id)(0),n=u(e,t)||i,o=l(e),r=c(e);return s.axis_rotated&&(0<e.value&&r<i||e.value<0&&i<r)&&(r=i),[[o,n],[o,r-(i-n)],[o,r-(i-n)],[o,n]]}},u.updateCircle=function(){var e=this;e.mainCircle=e.main.selectAll("."+$.circles).selectAll("."+$.circle).data(e.lineOrScatterData.bind(e)),e.mainCircle.enter().append("circle").attr("class",e.classCircle.bind(e)).attr("r",e.pointR.bind(e)).style("fill",e.color),e.mainCircle.style("opacity",e.initialOpacityForCircle.bind(e)),e.mainCircle.exit().remove()},u.redrawCircle=function(e,t,i){var n=this.main.selectAll("."+$.selectedCircle);return[(i?this.mainCircle.transition():this.mainCircle).style("opacity",this.opacityForCircle.bind(this)).style("fill",this.color).attr("cx",e).attr("cy",t),(i?n.transition():n).attr("cx",e).attr("cy",t)]},u.circleX=function(e){return e.x||0===e.x?this.x(e.x):null},u.updateCircleY=function(){var e,i,t=this;0<t.config.data_groups.length?(e=t.getShapeIndices(t.isLineType),i=t.generateGetLinePoints(e),t.circleY=function(e,t){return i(e,t)[0][1]}):t.circleY=function(e){return t.getYScale(e.id)(e.value)}},u.getCircles=function(e,t){return(t?this.main.selectAll("."+$.circles+this.getTargetSelectorSuffix(t)):this.main).selectAll("."+$.circle+(S(e)?"-"+e:""))},u.expandCircles=function(e,t,i){var n=this.pointExpandedR.bind(this);i&&this.unexpandCircles(),this.getCircles(e,t).classed($.EXPANDED,!0).attr("r",n)},u.unexpandCircles=function(e){var t=this,i=t.pointR.bind(t);t.getCircles(e).filter(function(){return t.d3.select(this).classed($.EXPANDED)}).classed($.EXPANDED,!1).attr("r",i)},u.pointR=function(e){var t=this.config;return this.isStepType(e)?0:d(t.point_r)?t.point_r(e):t.point_r},u.pointExpandedR=function(e){var t=this.config;return t.point_focus_expand_enabled?t.point_focus_expand_r?t.point_focus_expand_r:1.75*this.pointR(e):this.pointR(e)},u.pointSelectR=function(e){var t=this.config;return t.point_select_r?t.point_select_r:4*this.pointR(e)},u.isWithinCircle=function(e,t){var i=this.d3,n=i.mouse(e),o=i.select(e),r=+o.attr("cx"),a=+o.attr("cy");return Math.sqrt(Math.pow(r-n[0],2)+Math.pow(a-n[1],2))<t},u.isWithinStep=function(e,t){return Math.abs(t-this.d3.mouse(e)[1])<30},u.initBar=function(){this.main.select("."+$.chart).append("g").attr("class",$.chartBars)},u.updateTargetsForBar=function(e){var t=this.config,i=this.classChartBar.bind(this),n=this.classBars.bind(this),o=this.classFocus.bind(this);this.main.select("."+$.chartBars).selectAll("."+$.chartBar).data(e).attr("class",function(e){return i(e)+o(e)}).enter().append("g").attr("class",i).style("opacity",0).style("pointer-events","none").append("g").attr("class",n).style("cursor",function(e){return t.data_selection_isselectable(e)?"pointer":null})},u.updateBar=function(e){function t(e){return i.color(e.id)}var i=this,n=i.barData.bind(i),o=i.classBar.bind(i),r=i.initialOpacity.bind(i);i.mainBar=i.main.selectAll("."+$.bars).selectAll("."+$.bar).data(n),i.mainBar.enter().append("path").attr("class",o).style("stroke",t).style("fill",t),i.mainBar.style("opacity",r),i.mainBar.exit().transition().duration(e).style("opacity",0).remove()},u.redrawBar=function(e,t){return[(t?this.mainBar.transition():this.mainBar).attr("d",e).style("fill",this.color).style("opacity",1)]},u.getBarW=function(e,t){var i=this.config,n="number"==typeof i.bar_width?i.bar_width:t?e.tickInterval()*i.bar_width_ratio/t:0;return i.bar_width_max&&n>i.bar_width_max?i.bar_width_max:n},u.getBars=function(e,t){return(t?this.main.selectAll("."+$.bars+this.getTargetSelectorSuffix(t)):this.main).selectAll("."+$.bar+(S(e)?"-"+e:""))},u.expandBars=function(e,t,i){i&&this.unexpandBars(),this.getBars(e,t).classed($.EXPANDED,!0)},u.unexpandBars=function(e){this.getBars(e).classed($.EXPANDED,!1)},u.generateDrawBar=function(e,t){var r=this.config,a=this.generateGetBarPoints(e,t);return function(e,t){var i=a(e,t),n=r.axis_rotated?1:0,o=r.axis_rotated?0:1;return"M "+i[0][n]+","+i[0][o]+" L"+i[1][n]+","+i[1][o]+" L"+i[2][n]+","+i[2][o]+" L"+i[3][n]+","+i[3][o]+" z"}},u.generateGetBarPoints=function(e,t){var a=this,i=t?a.subXAxis:a.xAxis,n=e.__max__+1,s=a.getBarW(i,n),l=a.getShapeX(s,n,e,!!t),c=a.getShapeY(!!t),u=a.getShapeOffset(a.isBarType,e,!!t),d=t?a.getSubYScale:a.getYScale;return function(e,t){var i=d.call(a,e.id)(0),n=u(e,t)||i,o=l(e),r=c(e);return a.config.axis_rotated&&(0<e.value&&r<i||e.value<0&&i<r)&&(r=i),[[o,n],[o,r-(i-n)],[o+s,r-(i-n)],[o+s,n]]}},u.isWithinBar=function(e){var t=this.d3.mouse(e),i=e.getBoundingClientRect(),n=e.pathSegList.getItem(0),o=e.pathSegList.getItem(1),r=Math.min(n.x,o.x),a=Math.min(n.y,o.y),s=r+i.width+2,l=a+i.height+2,c=a-2;return r-2<t[0]&&t[0]<s&&c<t[1]&&t[1]<l},u.initText=function(){this.main.select("."+$.chart).append("g").attr("class",$.chartTexts),this.mainText=this.d3.selectAll([])},u.updateTargetsForText=function(e){var t=this.classChartText.bind(this),i=this.classTexts.bind(this),n=this.classFocus.bind(this);this.main.select("."+$.chartTexts).selectAll("."+$.chartText).data(e).attr("class",function(e){return t(e)+n(e)}).enter().append("g").attr("class",t).style("opacity",0).style("pointer-events","none").append("g").attr("class",i)},u.updateText=function(e){var n=this,t=n.config,i=n.barOrLineData.bind(n),o=n.classText.bind(n);n.mainText=n.main.selectAll("."+$.texts).selectAll("."+$.text).data(i),n.mainText.enter().append("text").attr("class",o).attr("text-anchor",function(e){return t.axis_rotated?e.value<0?"end":"start":"middle"}).style("stroke","none").style("fill",function(e){return n.color(e)}).style("fill-opacity",0),n.mainText.text(function(e,t,i){return n.dataLabelFormat(e.id)(e.value,e.id,t,i)}),n.mainText.exit().transition().duration(e).style("fill-opacity",0).remove()},u.redrawText=function(e,t,i,n){return[(n?this.mainText.transition():this.mainText).attr("x",e).attr("y",t).style("fill",this.color).style("fill-opacity",i?0:this.opacityForText.bind(this))]},u.getTextRect=function(e,t){var i,n=this.d3.select("body").append("div").classed("c3",!0);return n.append("svg").style("visibility","hidden").style("position","fixed").style("top",0).style("left",0).selectAll(".dummy").data([e]).enter().append("text").classed(t||"",!0).text(e).each(function(){i=this.getBoundingClientRect()}),n.remove(),i},u.generateXYForText=function(e,t,i,n){var o=this,r=o.generateGetAreaPoints(e,!1),a=o.generateGetBarPoints(t,!1),s=o.generateGetLinePoints(i,!1),l=n?o.getXForText:o.getYForText;return function(e,t){var i=o.isAreaType(e)?r:o.isBarType(e)?a:s;return l.call(o,i(e,t),e,this)}},u.getXForText=function(e,t,i){var n,o,r=i.getBoundingClientRect();return n=this.config.axis_rotated?(o=this.isBarType(t)?4:6,e[2][1]+o*(t.value<0?-1:1)):this.hasType("bar")?(e[2][0]+e[0][0])/2:e[0][0],null===t.value&&(n>this.width?n=this.width-r.width:n<0&&(n=4)),n},u.getYForText=function(e,t,i){var n,o=i.getBoundingClientRect();return this.config.axis_rotated?n=(e[0][0]+e[2][0]+.6*o.height)/2:(n=e[2][1],t.value<0?(n+=o.height,this.isBarType(t)&&this.isSafari()?n-=3:!this.isBarType(t)&&this.isChrome()&&(n+=3)):n+=this.isBarType(t)?-3:-6),null!==t.value||this.config.axis_rotated||(n<o.height?n=o.height:n>this.height&&(n=this.height-4)),n},u.setTargetType=function(e,t){var i=this,n=i.config;i.mapToTargetIds(e).forEach(function(e){i.withoutFadeIn[e]=t===n.data_types[e],n.data_types[e]=t}),e||(n.data_type=t)},u.hasType=function(i,e){var n=this.config.data_types,o=!1;return(e=e||this.data.targets)&&e.length?e.forEach(function(e){var t=n[e.id];(t&&0<=t.indexOf(i)||!t&&"line"===i)&&(o=!0)}):Object.keys(n).length?Object.keys(n).forEach(function(e){n[e]===i&&(o=!0)}):o=this.config.data_type===i,o},u.hasArcType=function(e){return this.hasType("pie",e)||this.hasType("donut",e)||this.hasType("gauge",e)},u.isLineType=function(e){var t=this.config,i=r(e)?e:e.id;return!t.data_types[i]||0<=["line","spline","area","area-spline","step","area-step"].indexOf(t.data_types[i])},u.isStepType=function(e){var t=r(e)?e:e.id;return 0<=["step","area-step"].indexOf(this.config.data_types[t])},u.isSplineType=function(e){var t=r(e)?e:e.id;return 0<=["spline","area-spline"].indexOf(this.config.data_types[t])},u.isAreaType=function(e){var t=r(e)?e:e.id;return 0<=["area","area-spline","area-step"].indexOf(this.config.data_types[t])},u.isBarType=function(e){var t=r(e)?e:e.id;return"bar"===this.config.data_types[t]},u.isScatterType=function(e){var t=r(e)?e:e.id;return"scatter"===this.config.data_types[t]},u.isPieType=function(e){var t=r(e)?e:e.id;return"pie"===this.config.data_types[t]},u.isGaugeType=function(e){var t=r(e)?e:e.id;return"gauge"===this.config.data_types[t]},u.isDonutType=function(e){var t=r(e)?e:e.id;return"donut"===this.config.data_types[t]},u.isArcType=function(e){return this.isPieType(e)||this.isDonutType(e)||this.isGaugeType(e)},u.lineData=function(e){return this.isLineType(e)?[e]:[]},u.arcData=function(e){return this.isArcType(e.data)?[e]:[]},u.barData=function(e){return this.isBarType(e)?e.values:[]},u.lineOrScatterData=function(e){return this.isLineType(e)||this.isScatterType(e)?e.values:[]},u.barOrLineData=function(e){return this.isBarType(e)||this.isLineType(e)?e.values:[]},u.initGrid=function(){var e=this,t=e.config,i=e.d3;e.grid=e.main.append("g").attr("clip-path",e.clipPathForGrid).attr("class",$.grid),t.grid_x_show&&e.grid.append("g").attr("class",$.xgrids),t.grid_y_show&&e.grid.append("g").attr("class",$.ygrids),t.grid_focus_show&&e.grid.append("g").attr("class",$.xgridFocus).append("line").attr("class",$.xgridFocus),e.xgrid=i.selectAll([]),t.grid_lines_front||e.initGridLines()},u.initGridLines=function(){var e=this.d3;this.gridLines=this.main.append("g").attr("clip-path",this.clipPathForGrid).attr("class",$.grid+" "+$.gridLines),this.gridLines.append("g").attr("class",$.xgridLines),this.gridLines.append("g").attr("class",$.ygridLines),this.xgridLines=e.selectAll([])},u.updateXGrid=function(e){var t=this,i=t.config,n=t.d3,o=t.generateGridData(i.grid_x_type,t.x),r=t.isCategorized()?t.xAxis.tickOffset():0;t.xgridAttr=i.axis_rotated?{x1:0,x2:t.width,y1:function(e){return t.x(e)-r},y2:function(e){return t.x(e)-r}}:{x1:function(e){return t.x(e)+r},x2:function(e){return t.x(e)+r},y1:0,y2:t.height},t.xgrid=t.main.select("."+$.xgrids).selectAll("."+$.xgrid).data(o),t.xgrid.enter().append("line").attr("class",$.xgrid),e||t.xgrid.attr(t.xgridAttr).style("opacity",function(){return+n.select(this).attr(i.axis_rotated?"y1":"x1")===(i.axis_rotated?t.height:0)?0:1}),t.xgrid.exit().remove()},u.updateYGrid=function(){var e=this,t=e.config,i=e.yAxis.tickValues()||e.y.ticks(t.grid_y_ticks);e.ygrid=e.main.select("."+$.ygrids).selectAll("."+$.ygrid).data(i),e.ygrid.enter().append("line").attr("class",$.ygrid),e.ygrid.attr("x1",t.axis_rotated?e.y:0).attr("x2",t.axis_rotated?e.y:e.width).attr("y1",t.axis_rotated?0:e.y).attr("y2",t.axis_rotated?e.height:e.y),e.ygrid.exit().remove(),e.smoothLines(e.ygrid,"grid")},u.gridTextAnchor=function(e){return e.position?e.position:"end"},u.gridTextDx=function(e){return"start"===e.position?4:"middle"===e.position?0:-4},u.xGridTextX=function(e){return"start"===e.position?-this.height:"middle"===e.position?-this.height/2:0},u.yGridTextX=function(e){return"start"===e.position?0:"middle"===e.position?this.width/2:this.width},u.updateGrid=function(e){var t,i,n,o=this,r=o.main,a=o.config;o.grid.style("visibility",o.hasArcType()?"hidden":"visible"),r.select("line."+$.xgridFocus).style("visibility","hidden"),a.grid_x_show&&o.updateXGrid(),o.xgridLines=r.select("."+$.xgridLines).selectAll("."+$.xgridLine).data(a.grid_x_lines),(t=o.xgridLines.enter().append("g").attr("class",function(e){return $.xgridLine+(e.class?" "+e.class:"")})).append("line").style("opacity",0),t.append("text").attr("text-anchor",o.gridTextAnchor).attr("transform",a.axis_rotated?"":"rotate(-90)").attr("dx",o.gridTextDx).attr("dy",-5).style("opacity",0),o.xgridLines.exit().transition().duration(e).style("opacity",0).remove(),a.grid_y_show&&o.updateYGrid(),o.ygridLines=r.select("."+$.ygridLines).selectAll("."+$.ygridLine).data(a.grid_y_lines),(i=o.ygridLines.enter().append("g").attr("class",function(e){return $.ygridLine+(e.class?" "+e.class:"")})).append("line").style("opacity",0),i.append("text").attr("text-anchor",o.gridTextAnchor).attr("transform",a.axis_rotated?"rotate(-90)":"").attr("dx",o.gridTextDx).attr("dy",-5).style("opacity",0),n=o.yv.bind(o),o.ygridLines.select("line").transition().duration(e).attr("x1",a.axis_rotated?n:0).attr("x2",a.axis_rotated?n:o.width).attr("y1",a.axis_rotated?0:n).attr("y2",a.axis_rotated?o.height:n).style("opacity",1),o.ygridLines.select("text").transition().duration(e).attr("x",a.axis_rotated?o.xGridTextX.bind(o):o.yGridTextX.bind(o)).attr("y",n).text(function(e){return e.text}).style("opacity",1),o.ygridLines.exit().transition().duration(e).style("opacity",0).remove()},u.redrawGrid=function(e){var t=this,i=t.config,n=t.xv.bind(t),o=t.xgridLines.select("line"),r=t.xgridLines.select("text");return[(e?o.transition():o).attr("x1",i.axis_rotated?0:n).attr("x2",i.axis_rotated?t.width:n).attr("y1",i.axis_rotated?n:0).attr("y2",i.axis_rotated?n:t.height).style("opacity",1),(e?r.transition():r).attr("x",i.axis_rotated?t.yGridTextX.bind(t):t.xGridTextX.bind(t)).attr("y",n).text(function(e){return e.text}).style("opacity",1)]},u.showXGridFocus=function(e){var t=this.config,i=e.filter(function(e){return e&&S(e.value)}),n=this.main.selectAll("line."+$.xgridFocus),o=this.xx.bind(this);t.tooltip_show&&(this.hasType("scatter")||this.hasArcType()||(n.style("visibility","visible").data([i[0]]).attr(t.axis_rotated?"y1":"x1",o).attr(t.axis_rotated?"y2":"x2",o),this.smoothLines(n,"grid")))},u.hideXGridFocus=function(){this.main.select("line."+$.xgridFocus).style("visibility","hidden")},u.updateXgridFocus=function(){var e=this.config;this.main.select("line."+$.xgridFocus).attr("x1",e.axis_rotated?0:-10).attr("x2",e.axis_rotated?this.width:-10).attr("y1",e.axis_rotated?-10:0).attr("y2",e.axis_rotated?-10:this.height)},u.generateGridData=function(e,t){var i,n,o,r,a=[],s=this.main.select("."+$.axisX).selectAll(".tick").size();if("year"===e)for(n=(i=this.getXDomain())[0].getFullYear(),o=i[1].getFullYear(),r=n;r<=o;r++)a.push(new Date(r+"-01-01 00:00:00"));else(a=t.ticks(10)).length>s&&(a=a.filter(function(e){return(""+e).indexOf(".")<0}));return a},u.getGridFilterToRemove=function(e){return e?function(t){var i=!1;return[].concat(e).forEach(function(e){("value"in e&&t.value===e.value||"class"in e&&t.class===e.class)&&(i=!0)}),i}:function(){return!0}},u.removeGridLines=function(e,t){function i(e){return!o(e)}var n=this.config,o=this.getGridFilterToRemove(e),r=t?$.xgridLines:$.ygridLines,a=t?$.xgridLine:$.ygridLine;this.main.select("."+r).selectAll("."+a).filter(o).transition().duration(n.transition_duration).style("opacity",0).remove(),t?n.grid_x_lines=n.grid_x_lines.filter(i):n.grid_y_lines=n.grid_y_lines.filter(i)},u.initTooltip=function(){var e,t=this,i=t.config;if(t.tooltip=t.selectChart.style("position","relative").append("div").attr("class",$.tooltipContainer).style("position","absolute").style("pointer-events","none").style("display","none"),i.tooltip_init_show){if(t.isTimeSeries()&&r(i.tooltip_init_x)){for(i.tooltip_init_x=t.parseDate(i.tooltip_init_x),e=0;e<t.data.targets[0].values.length&&t.data.targets[0].values[e].x-i.tooltip_init_x!=0;e++);i.tooltip_init_x=e}t.tooltip.html(i.tooltip_contents.call(t,t.data.targets.map(function(e){return t.addName(e.values[i.tooltip_init_x])}),t.axis.getXAxisTickFormat(),t.getYFormat(t.hasArcType()),t.color)),t.tooltip.style("top",i.tooltip_init_position.top).style("left",i.tooltip_init_position.left).style("display","block")}},u.getTooltipContent=function(e,t,i,n){var o,r,a,s,l,c,u=this.config,d=u.tooltip_format_title||t,h=u.tooltip_format_name||function(e){return e},p=u.tooltip_format_value||i;for(r=0;r<e.length;r++)e[r]&&(e[r].value||0===e[r].value)&&(o||(a=d?d(e[r].x):e[r].x,o="<table class='"+$.tooltip+"'>"+(a||0===a?"<tr><th colspan='2'>"+a+"</th></tr>":"")),void 0!==(s=p(e[r].value,e[r].ratio,e[r].id,e[r].index))&&(l=h(e[r].name,e[r].ratio,e[r].id,e[r].index),c=this.levelColor?this.levelColor(e[r].value):n(e[r].id),o+="<tr class='"+$.tooltipName+"-"+e[r].id+"'>",o+="<td class='name'><span style='background-color:"+c+"'></span>"+l+"</td>",o+="<td class='value'>"+s+"</td>",o+="</tr>"));return o+"</table>"},u.tooltipPosition=function(e,t,i,n){var o,r,a,s,l,c=this,u=c.config,d=c.d3,h=c.hasArcType(),p=d.mouse(n);return h?(r=(c.width-(c.isLegendRight?c.getLegendWidth():0))/2+p[0],s=c.height/2+p[1]+20):(o=c.getSvgLeft(!0),s=u.axis_rotated?(a=(r=o+p[0]+100)+t,l=c.currentWidth-c.getCurrentPaddingRight(),c.x(e[0].x)+20):(a=(r=o+c.getCurrentPaddingLeft(!0)+c.x(e[0].x)+20)+t,l=o+c.currentWidth-c.getCurrentPaddingRight(),p[1]+15),l<a&&(r-=a-l+20),s+i>c.currentHeight&&(s-=i+30)),s<0&&(s=0),{top:s,left:r}},u.showTooltip=function(e,t){var i,n,o,r=this,a=r.config,s=r.hasArcType(),l=e.filter(function(e){return e&&S(e.value)}),c=a.tooltip_position||u.tooltipPosition;0!==l.length&&a.tooltip_show&&(r.tooltip.html(a.tooltip_contents.call(r,e,r.axis.getXAxisTickFormat(),r.getYFormat(s),r.color)).style("display","block"),i=r.tooltip.property("offsetWidth"),n=r.tooltip.property("offsetHeight"),o=c.call(this,l,i,n,t),r.tooltip.style("top",o.top+"px").style("left",o.left+"px"))},u.hideTooltip=function(){this.tooltip.style("display","none")},u.initLegend=function(){var e=this;if(e.legendItemTextBox={},e.legendHasRendered=!1,e.legend=e.svg.append("g").attr("transform",e.getTranslate("legend")),!e.config.legend_show)return e.legend.style("visibility","hidden"),void(e.hiddenLegendIds=e.mapToIds(e.data.targets));e.updateLegendWithDefaults()},u.updateLegendWithDefaults=function(){this.updateLegend(this.mapToIds(this.data.targets),{withTransform:!1,withTransitionForTransform:!1,withTransition:!1})},u.updateSizeForLegend=function(e,t){var i=this,n=i.config,o={top:i.isLegendTop?i.getCurrentPaddingTop()+n.legend_inset_y+5.5:i.currentHeight-e-i.getCurrentPaddingBottom()-n.legend_inset_y,left:i.isLegendLeft?i.getCurrentPaddingLeft()+n.legend_inset_x+.5:i.currentWidth-t-i.getCurrentPaddingRight()-n.legend_inset_x+.5};i.margin3={top:i.isLegendRight?0:i.isLegendInset?o.top:i.currentHeight-e,right:NaN,bottom:0,left:i.isLegendRight?i.currentWidth-t:i.isLegendInset?o.left:0}},u.transformLegend=function(e){(e?this.legend.transition():this.legend).attr("transform",this.getTranslate("legend"))},u.updateLegendStep=function(e){this.legendStep=e},u.updateLegendItemWidth=function(e){this.legendItemWidth=e},u.updateLegendItemHeight=function(e){this.legendItemHeight=e},u.getLegendWidth=function(){return this.config.legend_show?this.isLegendRight||this.isLegendInset?this.legendItemWidth*(this.legendStep+1):this.currentWidth:0},u.getLegendHeight=function(){var e=0;return this.config.legend_show&&(e=this.isLegendRight?this.currentHeight:Math.max(20,this.legendItemHeight)*(this.legendStep+1)),e},u.opacityForLegend=function(e){return e.classed($.legendItemHidden)?null:1},u.opacityForUnfocusedLegend=function(e){return e.classed($.legendItemHidden)?null:.3},u.toggleFocusLegend=function(t,e){var i=this;t=i.mapToTargetIds(t),i.legend.selectAll("."+$.legendItem).filter(function(e){return 0<=t.indexOf(e)}).classed($.legendItemFocused,e).transition().duration(100).style("opacity",function(){return(e?i.opacityForLegend:i.opacityForUnfocusedLegend).call(i,i.d3.select(this))})},u.revertLegend=function(){var e=this,t=e.d3;e.legend.selectAll("."+$.legendItem).classed($.legendItemFocused,!1).transition().duration(100).style("opacity",function(){return e.opacityForLegend(t.select(this))})},u.showLegend=function(e){var t=this,i=t.config;i.legend_show||(i.legend_show=!0,t.legend.style("visibility","visible"),t.legendHasRendered||t.updateLegendWithDefaults()),t.removeHiddenLegendIds(e),t.legend.selectAll(t.selectorLegends(e)).style("visibility","visible").transition().style("opacity",function(){return t.opacityForLegend(t.d3.select(this))})},u.hideLegend=function(e){var t=this.config;t.legend_show&&h(e)&&(t.legend_show=!1,this.legend.style("visibility","hidden")),this.addHiddenLegendIds(e),this.legend.selectAll(this.selectorLegends(e)).style("opacity",0).style("visibility","hidden")},u.clearLegendItemTextBoxCache=function(){this.legendItemTextBox={}},u.updateLegend=function(p,e,t){var i,n,o,r,a,s,l,c,u,d,h,f,g,m=this,v=m.config,y=4,b=10,w=0,C=0,_=10,A=15,E=0,x={},S={},T={},D=[0],k={},R=0;function O(e,t,i){var n,o,r=0===i,a=i===p.length-1,s=function(e,t){return m.legendItemTextBox[t]||(m.legendItemTextBox[t]=m.getTextRect(e.textContent,$.legendItem)),m.legendItemTextBox[t]}(e,t),l=s.width+A+(!a||m.isLegendRight||m.isLegendInset?b:0),c=s.height+y,u=m.isLegendRight||m.isLegendInset?c:l,d=m.isLegendRight||m.isLegendInset?m.getLegendHeight():m.getLegendWidth();function h(e,t){t||(n=(d-E-u)/2)<_&&(n=(d-u)/2,E=0,R++),k[e]=R,D[R]=m.isLegendInset?10:n,x[e]=E,E+=u}r&&(C=w=R=E=0),!v.legend_show||m.isLegendToShow(t)?(S[t]=l,T[t]=c,(!w||w<=l)&&(w=l),(!C||C<=c)&&(C=c),o=m.isLegendRight||m.isLegendInset?C:w,v.legend_equally?(Object.keys(S).forEach(function(e){S[e]=w}),Object.keys(T).forEach(function(e){T[e]=C}),(n=(d-o*p.length)/2)<_?(R=E=0,p.forEach(function(e){h(e)})):h(t,!0)):h(t)):S[t]=T[t]=k[t]=x[t]=0}c=B(e=e||{},"withTransition",!0),u=B(e,"withTransitionForTransform",!0),m.isLegendInset&&(R=v.legend_inset_step?v.legend_inset_step:p.length,m.updateLegendStep(R)),r=m.isLegendRight?(i=function(e){return w*k[e]},function(e){return D[k[e]]+x[e]}):m.isLegendInset?(i=function(e){return w*k[e]+10},function(e){return D[k[e]]+x[e]}):(i=function(e){return D[k[e]]+x[e]},function(e){return C*k[e]}),n=function(e,t){return i(e,t)+14},a=function(e,t){return r(e,t)+9},o=function(e,t){return i(e,t)},s=function(e,t){return r(e,t)-5},(l=m.legend.selectAll("."+$.legendItem).data(p).enter().append("g").attr("class",function(e){return m.generateClass($.legendItem,e)}).style("visibility",function(e){return m.isLegendToShow(e)?"visible":"hidden"}).style("cursor","pointer").on("click",function(e){v.legend_item_onclick?v.legend_item_onclick.call(m,e):m.d3.event.altKey?(m.api.hide(),m.api.show(e)):(m.api.toggle(e),m.isTargetToShow(e)?m.api.focus(e):m.api.revert())}).on("mouseover",function(e){m.d3.select(this).classed($.legendItemFocused,!0),!m.transiting&&m.isTargetToShow(e)&&m.api.focus(e),v.legend_item_onmouseover&&v.legend_item_onmouseover.call(m,e)}).on("mouseout",function(e){m.d3.select(this).classed($.legendItemFocused,!1),m.api.revert(),v.legend_item_onmouseout&&v.legend_item_onmouseout.call(m,e)})).append("text").text(function(e){return N(v.data_names[e])?v.data_names[e]:e}).each(function(e,t){O(this,e,t)}).style("pointer-events","none").attr("x",m.isLegendRight||m.isLegendInset?n:-200).attr("y",m.isLegendRight||m.isLegendInset?-200:a),l.append("rect").attr("class",$.legendItemEvent).style("fill-opacity",0).attr("x",m.isLegendRight||m.isLegendInset?o:-200).attr("y",m.isLegendRight||m.isLegendInset?-200:s),l.append("rect").attr("class",$.legendItemTile).style("pointer-events","none").style("fill",m.color).attr("x",m.isLegendRight||m.isLegendInset?n:-200).attr("y",m.isLegendRight||m.isLegendInset?-200:r).attr("width",10).attr("height",10),g=m.legend.select("."+$.legendBackground+" rect"),m.isLegendInset&&0<w&&0===g.size()&&(g=m.legend.insert("g","."+$.legendItem).attr("class",$.legendBackground).append("rect")),d=m.legend.selectAll("text").data(p).text(function(e){return N(v.data_names[e])?v.data_names[e]:e}).each(function(e,t){O(this,e,t)}),(c?d.transition():d).attr("x",n).attr("y",a),h=m.legend.selectAll("rect."+$.legendItemEvent).data(p),(c?h.transition():h).attr("width",function(e){return S[e]}).attr("height",function(e){return T[e]}).attr("x",o).attr("y",s),f=m.legend.selectAll("rect."+$.legendItemTile).data(p),(c?f.transition():f).style("fill",m.color).attr("x",i).attr("y",r),g&&(c?g.transition():g).attr("height",m.getLegendHeight()-12).attr("width",w*(R+1)+10),m.legend.selectAll("."+$.legendItem).classed($.legendItemHidden,function(e){return!m.isTargetToShow(e)}),m.updateLegendItemWidth(w),m.updateLegendItemHeight(C),m.updateLegendStep(R),m.updateSizes(),m.updateScales(),m.updateSvgSize(),m.transformAll(u,t),m.legendHasRendered=!0},function(e,t){if(Object.create)t.prototype=Object.create(e.prototype);else{var i=function(){};i.prototype=e.prototype,t.prototype=new i}t.prototype.constructor=t}(t,s),s.prototype.init=function(){var e=this.owner,t=e.config,i=e.main;e.axes.x=i.append("g").attr("class",$.axis+" "+$.axisX).attr("clip-path",e.clipPathForXAxis).attr("transform",e.getTranslate("x")).style("visibility",t.axis_x_show?"visible":"hidden"),e.axes.x.append("text").attr("class",$.axisXLabel).attr("transform",t.axis_rotated?"rotate(-90)":"").style("text-anchor",this.textAnchorForXAxisLabel.bind(this)),e.axes.y=i.append("g").attr("class",$.axis+" "+$.axisY).attr("clip-path",t.axis_y_inner?"":e.clipPathForYAxis).attr("transform",e.getTranslate("y")).style("visibility",t.axis_y_show?"visible":"hidden"),e.axes.y.append("text").attr("class",$.axisYLabel).attr("transform",t.axis_rotated?"":"rotate(-90)").style("text-anchor",this.textAnchorForYAxisLabel.bind(this)),e.axes.y2=i.append("g").attr("class",$.axis+" "+$.axisY2).attr("transform",e.getTranslate("y2")).style("visibility",t.axis_y2_show?"visible":"hidden"),e.axes.y2.append("text").attr("class",$.axisY2Label).attr("transform",t.axis_rotated?"":"rotate(-90)").style("text-anchor",this.textAnchorForY2AxisLabel.bind(this))},s.prototype.getXAxis=function(e,t,i,n,o,r,a){var s=this.owner,l=s.config,c={isCategory:s.isCategorized(),withOuterTick:o,tickMultiline:l.axis_x_tick_multiline,tickWidth:l.axis_x_tick_width,tickTextRotate:a?0:l.axis_x_tick_rotate,withoutTransition:r},u=f(s.d3,c).scale(e).orient(t);return s.isTimeSeries()&&n&&(n=n.map(function(e){return s.parseDate(e)})),u.tickFormat(i).tickValues(n),s.isCategorized()&&(u.tickCentered(l.axis_x_tick_centered),h(l.axis_x_tick_culling)&&(l.axis_x_tick_culling=!1)),u},s.prototype.updateXAxisTickValues=function(e,t){var i,n=this.owner,o=n.config;return(o.axis_x_tick_fit||o.axis_x_tick_count)&&(i=this.generateTickValues(n.mapTargetsToUniqueXs(e),o.axis_x_tick_count,n.isTimeSeries())),t?t.tickValues(i):(n.xAxis.tickValues(i),n.subXAxis.tickValues(i)),i},s.prototype.getYAxis=function(e,t,i,n,o,r){var a={withOuterTick:o,withoutTransition:r},s=this.owner,l=s.d3,c=s.config,u=f(l,a).scale(e).orient(t).tickFormat(i);return s.isTimeSeriesY()?u.ticks(l.time[c.axis_y_tick_time_value],c.axis_y_tick_time_interval):u.tickValues(n),u},s.prototype.getId=function(e){var t=this.owner.config;return e in t.data_axes?t.data_axes[e]:"y"},s.prototype.getXAxisTickFormat=function(){var t=this.owner,i=t.config,n=t.isTimeSeries()?t.defaultAxisTimeFormat:t.isCategorized()?t.categoryName:function(e){return e<0?e.toFixed(0):e};return i.axis_x_tick_format&&(d(i.axis_x_tick_format)?n=i.axis_x_tick_format:t.isTimeSeries()&&(n=function(e){return e?t.axisTimeFormat(i.axis_x_tick_format)(e):""})),d(n)?function(e){return n.call(t,e)}:n},s.prototype.getTickValues=function(e,t){return e||(t?t.tickValues():void 0)},s.prototype.getXAxisTickValues=function(){return this.getTickValues(this.owner.config.axis_x_tick_values,this.owner.xAxis)},s.prototype.getYAxisTickValues=function(){return this.getTickValues(this.owner.config.axis_y_tick_values,this.owner.yAxis)},s.prototype.getY2AxisTickValues=function(){return this.getTickValues(this.owner.config.axis_y2_tick_values,this.owner.y2Axis)},s.prototype.getLabelOptionByAxisId=function(e){var t,i=this.owner.config;return"y"===e?t=i.axis_y_label:"y2"===e?t=i.axis_y2_label:"x"===e&&(t=i.axis_x_label),t},s.prototype.getLabelText=function(e){var t=this.getLabelOptionByAxisId(e);return r(t)?t:t?t.text:null},s.prototype.setLabelText=function(e,t){var i=this.owner.config,n=this.getLabelOptionByAxisId(e);r(n)?"y"===e?i.axis_y_label=t:"y2"===e?i.axis_y2_label=t:"x"===e&&(i.axis_x_label=t):n&&(n.text=t)},s.prototype.getLabelPosition=function(e,t){var i=this.getLabelOptionByAxisId(e),n=i&&"object"==typeof i&&i.position?i.position:t;return{isInner:0<=n.indexOf("inner"),isOuter:0<=n.indexOf("outer"),isLeft:0<=n.indexOf("left"),isCenter:0<=n.indexOf("center"),isRight:0<=n.indexOf("right"),isTop:0<=n.indexOf("top"),isMiddle:0<=n.indexOf("middle"),isBottom:0<=n.indexOf("bottom")}},s.prototype.getXAxisLabelPosition=function(){return this.getLabelPosition("x",this.owner.config.axis_rotated?"inner-top":"inner-right")},s.prototype.getYAxisLabelPosition=function(){return this.getLabelPosition("y",this.owner.config.axis_rotated?"inner-right":"inner-top")},s.prototype.getY2AxisLabelPosition=function(){return this.getLabelPosition("y2",this.owner.config.axis_rotated?"inner-right":"inner-top")},s.prototype.getLabelPositionById=function(e){return"y2"===e?this.getY2AxisLabelPosition():"y"===e?this.getYAxisLabelPosition():this.getXAxisLabelPosition()},s.prototype.textForXAxisLabel=function(){return this.getLabelText("x")},s.prototype.textForYAxisLabel=function(){return this.getLabelText("y")},s.prototype.textForY2AxisLabel=function(){return this.getLabelText("y2")},s.prototype.xForAxisLabel=function(e,t){var i=this.owner;return e?t.isLeft?0:t.isCenter?i.width/2:i.width:t.isBottom?-i.height:t.isMiddle?-i.height/2:0},s.prototype.dxForAxisLabel=function(e,t){return e?t.isLeft?"0.5em":t.isRight?"-0.5em":"0":t.isTop?"-0.5em":t.isBottom?"0.5em":"0"},s.prototype.textAnchorForAxisLabel=function(e,t){return e?t.isLeft?"start":t.isCenter?"middle":"end":t.isBottom?"start":t.isMiddle?"middle":"end"},s.prototype.xForXAxisLabel=function(){return this.xForAxisLabel(!this.owner.config.axis_rotated,this.getXAxisLabelPosition())},s.prototype.xForYAxisLabel=function(){return this.xForAxisLabel(this.owner.config.axis_rotated,this.getYAxisLabelPosition())},s.prototype.xForY2AxisLabel=function(){return this.xForAxisLabel(this.owner.config.axis_rotated,this.getY2AxisLabelPosition())},s.prototype.dxForXAxisLabel=function(){return this.dxForAxisLabel(!this.owner.config.axis_rotated,this.getXAxisLabelPosition())},s.prototype.dxForYAxisLabel=function(){return this.dxForAxisLabel(this.owner.config.axis_rotated,this.getYAxisLabelPosition())},s.prototype.dxForY2AxisLabel=function(){return this.dxForAxisLabel(this.owner.config.axis_rotated,this.getY2AxisLabelPosition())},s.prototype.dyForXAxisLabel=function(){var e=this.owner.config,t=this.getXAxisLabelPosition();return e.axis_rotated?t.isInner?"1.2em":-25-this.getMaxTickWidth("x"):t.isInner?"-0.5em":e.axis_x_height?e.axis_x_height-10:"3em"},s.prototype.dyForYAxisLabel=function(){var e=this.owner,t=this.getYAxisLabelPosition();return e.config.axis_rotated?t.isInner?"-0.5em":"3em":t.isInner?"1.2em":-10-(e.config.axis_y_inner?0:this.getMaxTickWidth("y")+10)},s.prototype.dyForY2AxisLabel=function(){var e=this.owner,t=this.getY2AxisLabelPosition();return e.config.axis_rotated?t.isInner?"1.2em":"-2.2em":t.isInner?"-0.5em":15+(e.config.axis_y2_inner?0:this.getMaxTickWidth("y2")+15)},s.prototype.textAnchorForXAxisLabel=function(){var e=this.owner;return this.textAnchorForAxisLabel(!e.config.axis_rotated,this.getXAxisLabelPosition())},s.prototype.textAnchorForYAxisLabel=function(){var e=this.owner;return this.textAnchorForAxisLabel(e.config.axis_rotated,this.getYAxisLabelPosition())},s.prototype.textAnchorForY2AxisLabel=function(){var e=this.owner;return this.textAnchorForAxisLabel(e.config.axis_rotated,this.getY2AxisLabelPosition())},s.prototype.getMaxTickWidth=function(e,t){var i,n,o,r,a=this.owner,s=a.config,l=0;return t&&a.currentMaxTickWidths[e]||(a.svg&&(i=a.filterTargetsToShow(a.data.targets),"y"===e?(n=a.y.copy().domain(a.getYDomain(i,"y")),o=this.getYAxis(n,a.yOrient,s.axis_y_tick_format,a.yAxisTickValues,!1,!0)):"y2"===e?(n=a.y2.copy().domain(a.getYDomain(i,"y2")),o=this.getYAxis(n,a.y2Orient,s.axis_y2_tick_format,a.y2AxisTickValues,!1,!0)):(n=a.x.copy().domain(a.getXDomain(i)),o=this.getXAxis(n,a.xOrient,a.xAxisTickFormat,a.xAxisTickValues,!1,!0,!0),this.updateXAxisTickValues(i,o)),(r=a.d3.select("body").append("div").classed("c3",!0)).append("svg").style("visibility","hidden").style("position","fixed").style("top",0).style("left",0).append("g").call(o).each(function(){a.d3.select(this).selectAll("text").each(function(){var e=this.getBoundingClientRect();l<e.width&&(l=e.width)}),r.remove()})),a.currentMaxTickWidths[e]=l<=0?a.currentMaxTickWidths[e]:l),a.currentMaxTickWidths[e]},s.prototype.updateLabels=function(e){var t=this.owner,i=t.main.select("."+$.axisX+" ."+$.axisXLabel),n=t.main.select("."+$.axisY+" ."+$.axisYLabel),o=t.main.select("."+$.axisY2+" ."+$.axisY2Label);(e?i.transition():i).attr("x",this.xForXAxisLabel.bind(this)).attr("dx",this.dxForXAxisLabel.bind(this)).attr("dy",this.dyForXAxisLabel.bind(this)).text(this.textForXAxisLabel.bind(this)),(e?n.transition():n).attr("x",this.xForYAxisLabel.bind(this)).attr("dx",this.dxForYAxisLabel.bind(this)).attr("dy",this.dyForYAxisLabel.bind(this)).text(this.textForYAxisLabel.bind(this)),(e?o.transition():o).attr("x",this.xForY2AxisLabel.bind(this)).attr("dx",this.dxForY2AxisLabel.bind(this)).attr("dy",this.dyForY2AxisLabel.bind(this)).text(this.textForY2AxisLabel.bind(this))},s.prototype.getPadding=function(e,t,i,n){return S(e[t])?"ratio"===e.unit?e[t]*n:this.convertPixelsToAxisPadding(e[t],n):i},s.prototype.convertPixelsToAxisPadding=function(e,t){var i=this.owner;return t*(e/(i.config.axis_rotated?i.width:i.height))},s.prototype.generateTickValues=function(e,t,i){var n,o,r,a,s,l,c,u=e;if(t)if(1===(n=d(t)?t():t))u=[e[0]];else if(2===n)u=[e[0],e[e.length-1]];else if(2<n){for(a=n-2,o=e[0],s=((r=e[e.length-1])-o)/(1+a),u=[o],l=0;l<a;l++)c=+o+s*(l+1),u.push(i?new Date(c):c);u.push(r)}return i||(u=u.sort(function(e,t){return e-t})),u},s.prototype.generateTransitions=function(e){var t=this.owner.axes;return{axisX:e?t.x.transition().duration(e):t.x,axisY:e?t.y.transition().duration(e):t.y,axisY2:e?t.y2.transition().duration(e):t.y2,axisSubX:e?t.subx.transition().duration(e):t.subx}},s.prototype.redraw=function(e,t){var i=this.owner;i.axes.x.style("opacity",t?0:1),i.axes.y.style("opacity",t?0:1),i.axes.y2.style("opacity",t?0:1),i.axes.subx.style("opacity",t?0:1),e.axisX.call(i.xAxis),e.axisY.call(i.yAxis),e.axisY2.call(i.y2Axis),e.axisSubX.call(i.subXAxis)},u.getClipPath=function(e){return"url("+(0<=c.navigator.appVersion.toLowerCase().indexOf("msie 9.")?"":document.URL.split("#")[0])+"#"+e+")"},u.appendClip=function(e,t){return e.append("clipPath").attr("id",t).append("rect")},u.getAxisClipX=function(e){var t=Math.max(30,this.margin.left);return e?-(1+t):-(t-1)},u.getAxisClipY=function(e){return e?-20:-this.margin.top},u.getXAxisClipX=function(){return this.getAxisClipX(!this.config.axis_rotated)},u.getXAxisClipY=function(){return this.getAxisClipY(!this.config.axis_rotated)},u.getYAxisClipX=function(){return this.config.axis_y_inner?-1:this.getAxisClipX(this.config.axis_rotated)},u.getYAxisClipY=function(){return this.getAxisClipY(this.config.axis_rotated)},u.getAxisClipWidth=function(e){var t=Math.max(30,this.margin.left),i=Math.max(30,this.margin.right);return e?this.width+2+t+i:this.margin.left+20},u.getAxisClipHeight=function(e){return(e?this.margin.bottom:this.margin.top+this.height)+20},u.getXAxisClipWidth=function(){return this.getAxisClipWidth(!this.config.axis_rotated)},u.getXAxisClipHeight=function(){return this.getAxisClipHeight(!this.config.axis_rotated)},u.getYAxisClipWidth=function(){return this.getAxisClipWidth(this.config.axis_rotated)+(this.config.axis_y_inner?20:0)},u.getYAxisClipHeight=function(){return this.getAxisClipHeight(this.config.axis_rotated)},u.initPie=function(){var e=this.d3,t=this.config;this.pie=e.layout.pie().value(function(e){return e.values.reduce(function(e,t){return e+t.value},0)}),t.data_order||this.pie.sort(null)},u.updateRadius=function(){var e=this,t=e.config,i=t.gauge_width||t.donut_width;e.radiusExpanded=Math.min(e.arcWidth,e.arcHeight)/2,e.radius=.95*e.radiusExpanded,e.innerRadiusRatio=i?(e.radius-i)/e.radius:.6,e.innerRadius=e.hasType("donut")||e.hasType("gauge")?e.radius*e.innerRadiusRatio:0},u.updateArc=function(){this.svgArc=this.getSvgArc(),this.svgArcExpanded=this.getSvgArcExpanded(),this.svgArcExpandedSub=this.getSvgArcExpanded(.98)},u.updateAngle=function(t){var e,i,n=this.config,o=!1,r=0,a=n.gauge_min,s=n.gauge_max;return this.pie(this.filterTargetsToShow(this.data.targets)).forEach(function(e){o||e.data.id!==t.data.id||(o=!0,(t=e).index=r),r++}),isNaN(t.startAngle)&&(t.startAngle=0),isNaN(t.endAngle)&&(t.endAngle=t.startAngle),this.isGaugeType(t.data)&&(e=Math.PI/(s-a),i=t.value<a?0:t.value<s?t.value-a:s-a,t.startAngle=Math.PI/2*-1,t.endAngle=t.startAngle+e*i),o?t:null},u.getSvgArc=function(){function e(e,t){var i;return t?o(e):(i=n.updateAngle(e))?o(i):"M 0 0"}var n=this,o=n.d3.svg.arc().outerRadius(n.radius).innerRadius(n.innerRadius);return e.centroid=o.centroid,e},u.getSvgArcExpanded=function(e){var i=this,n=i.d3.svg.arc().outerRadius(i.radiusExpanded*(e||1)).innerRadius(i.innerRadius);return function(e){var t=i.updateAngle(e);return t?n(t):"M 0 0"}},u.getArc=function(e,t,i){return i||this.isArcType(e.data)?this.svgArc(e,t):"M 0 0"},u.transformForArcLabel=function(e){var t,i,n,o,r,a=this.updateAngle(e),s="";return a&&!this.hasType("gauge")&&(t=this.svgArc.centroid(a),i=isNaN(t[0])?0:t[0],n=isNaN(t[1])?0:t[1],o=Math.sqrt(i*i+n*n),s="translate("+i*(r=this.radius&&o?(.375<36/this.radius?1.175-36/this.radius:.8)*this.radius/o:0)+","+n*r+")"),s},u.getArcRatio=function(e){var t=this.hasType("gauge")?Math.PI:2*Math.PI;return e?(e.endAngle-e.startAngle)/t:null},u.convertToArcData=function(e){return this.addName({id:e.data.id,value:e.value,ratio:this.getArcRatio(e),index:e.index})},u.textForArcLabel=function(e){var t,i,n,o,r;return this.shouldShowArcLabel()?(i=(t=this.updateAngle(e))?t.value:null,n=this.getArcRatio(t),o=e.data.id,this.hasType("gauge")||this.meetsArcLabelThreshold(n)?(r=this.getArcLabelFormat())?r(i,n,o):this.defaultArcValueFormat(i,n):""):""},u.expandArc=function(e){var t,i=this;i.transiting?t=c.setInterval(function(){i.transiting||(c.clearInterval(t),0<i.legend.selectAll(".c3-legend-item-focused").size()&&i.expandArc(e))},10):(e=i.mapToTargetIds(e),i.svg.selectAll(i.selectorTargets(e,"."+$.chartArc)).each(function(e){i.shouldExpand(e.data.id)&&i.d3.select(this).selectAll("path").transition().duration(50).attr("d",i.svgArcExpanded).transition().duration(100).attr("d",i.svgArcExpandedSub).each(function(e){i.isDonutType(e.data)})}))},u.unexpandArc=function(e){this.transiting||(e=this.mapToTargetIds(e),this.svg.selectAll(this.selectorTargets(e,"."+$.chartArc)).selectAll("path").transition().duration(50).attr("d",this.svgArc),this.svg.selectAll("."+$.arc).style("opacity",1))},u.shouldExpand=function(e){var t=this.config;return this.isDonutType(e)&&t.donut_expand||this.isGaugeType(e)&&t.gauge_expand||this.isPieType(e)&&t.pie_expand},u.shouldShowArcLabel=function(){var e=this.config,t=!0;return this.hasType("donut")?t=e.donut_label_show:this.hasType("pie")&&(t=e.pie_label_show),t},u.meetsArcLabelThreshold=function(e){var t=this.config;return(this.hasType("donut")?t.donut_label_threshold:t.pie_label_threshold)<=e},u.getArcLabelFormat=function(){var e=this.config,t=e.pie_label_format;return this.hasType("gauge")?t=e.gauge_label_format:this.hasType("donut")&&(t=e.donut_label_format),t},u.getArcTitle=function(){return this.hasType("donut")?this.config.donut_title:""},u.updateTargetsForArc=function(e){var t,i=this.main,n=this.classChartArc.bind(this),o=this.classArcs.bind(this),r=this.classFocus.bind(this);(t=i.select("."+$.chartArcs).selectAll("."+$.chartArc).data(this.pie(e)).attr("class",function(e){return n(e)+r(e.data)}).enter().append("g").attr("class",n)).append("g").attr("class",o),t.append("text").attr("dy",this.hasType("gauge")?"-.1em":".35em").style("opacity",0).style("text-anchor","middle").style("pointer-events","none")},u.initArc=function(){this.arcs=this.main.select("."+$.chart).append("g").attr("class",$.chartArcs).attr("transform",this.getTranslate("arc")),this.arcs.append("text").attr("class",$.chartArcsTitle).style("text-anchor","middle").text(this.getArcTitle())},u.redrawArc=function(e,t,i){var n,o=this,r=o.d3,a=o.config,s=o.main;(n=s.selectAll("."+$.arcs).selectAll("."+$.arc).data(o.arcData.bind(o))).enter().append("path").attr("class",o.classArc.bind(o)).style("fill",function(e){return o.color(e.data)}).style("cursor",function(e){return a.interaction_enabled&&a.data_selection_isselectable(e)?"pointer":null}).style("opacity",0).each(function(e){o.isGaugeType(e.data)&&(e.startAngle=e.endAngle=Math.PI/2*-1),this._current=e}),n.attr("transform",function(e){return!o.isGaugeType(e.data)&&i?"scale(0)":""}).style("opacity",function(e){return e===this._current?0:1}).on("mouseover",a.interaction_enabled?function(e){var t,i;o.transiting||(t=o.updateAngle(e),i=o.convertToArcData(t),o.expandArc(t.data.id),o.api.focus(t.data.id),o.toggleFocusLegend(t.data.id,!0),o.config.data_onmouseover(i,this))}:null).on("mousemove",a.interaction_enabled?function(e){var t=o.updateAngle(e),i=[o.convertToArcData(t)];o.showTooltip(i,this)}:null).on("mouseout",a.interaction_enabled?function(e){var t,i;o.transiting||(t=o.updateAngle(e),i=o.convertToArcData(t),o.unexpandArc(t.data.id),o.api.revert(),o.revertLegend(),o.hideTooltip(),o.config.data_onmouseout(i,this))}:null).on("click",a.interaction_enabled?function(e,t){var i=o.updateAngle(e),n=o.convertToArcData(i);o.toggleShape&&o.toggleShape(this,n,t),o.config.data_onclick.call(o.api,n,this)}:null).each(function(){o.transiting=!0}).transition().duration(e).attrTween("d",function(i){var n,e=o.updateAngle(i);return e?(isNaN(this._current.startAngle)&&(this._current.startAngle=0),isNaN(this._current.endAngle)&&(this._current.endAngle=this._current.startAngle),n=r.interpolate(this._current,e),this._current=n(0),function(e){var t=n(e);return t.data=i.data,o.getArc(t,!0)}):function(){return"M 0 0"}}).attr("transform",i?"scale(1)":"").style("fill",function(e){return o.levelColor?o.levelColor(e.data.values[0].value):o.color(e.data.id)}).style("opacity",1).call(o.endall,function(){o.transiting=!1}),n.exit().transition().duration(t).style("opacity",0).remove(),s.selectAll("."+$.chartArc).select("text").style("opacity",0).attr("class",function(e){return o.isGaugeType(e.data)?$.gaugeValue:""}).text(o.textForArcLabel.bind(o)).attr("transform",o.transformForArcLabel.bind(o)).style("font-size",function(e){return o.isGaugeType(e.data)?Math.round(o.radius/5)+"px":""}).transition().duration(e).style("opacity",function(e){return o.isTargetToShow(e.data.id)&&o.isArcType(e.data)?1:0}),s.select("."+$.chartArcsTitle).style("opacity",o.hasType("donut")||o.hasType("gauge")?1:0),o.hasType("gauge")&&(o.arcs.select("."+$.chartArcsBackground).attr("d",function(){var e={data:[{value:a.gauge_max}],startAngle:Math.PI/2*-1,endAngle:Math.PI/2};return o.getArc(e,!0,!0)}),o.arcs.select("."+$.chartArcsGaugeUnit).attr("dy",".75em").text(a.gauge_label_show?a.gauge_units:""),o.arcs.select("."+$.chartArcsGaugeMin).attr("dx",-1*(o.innerRadius+(o.radius-o.innerRadius)/2)+"px").attr("dy","1.2em").text(a.gauge_label_show?a.gauge_min:""),o.arcs.select("."+$.chartArcsGaugeMax).attr("dx",o.innerRadius+(o.radius-o.innerRadius)/2+"px").attr("dy","1.2em").text(a.gauge_label_show?a.gauge_max:""))},u.initGauge=function(){var e=this.arcs;this.hasType("gauge")&&(e.append("path").attr("class",$.chartArcsBackground),e.append("text").attr("class",$.chartArcsGaugeUnit).style("text-anchor","middle").style("pointer-events","none"),e.append("text").attr("class",$.chartArcsGaugeMin).style("text-anchor","middle").style("pointer-events","none"),e.append("text").attr("class",$.chartArcsGaugeMax).style("text-anchor","middle").style("pointer-events","none"))},u.getGaugeLabelHeight=function(){return this.config.gauge_label_show?20:0},u.initRegion=function(){this.region=this.main.append("g").attr("clip-path",this.clipPath).attr("class",$.regions)},u.updateRegion=function(e){var t=this.config;this.region.style("visibility",this.hasArcType()?"hidden":"visible"),this.mainRegion=this.main.select("."+$.regions).selectAll("."+$.region).data(t.regions),this.mainRegion.enter().append("g").attr("class",this.classRegion.bind(this)).append("rect").style("fill-opacity",0),this.mainRegion.exit().transition().duration(e).style("opacity",0).remove()},u.redrawRegion=function(e){var t=this.mainRegion.selectAll("rect"),i=this.regionX.bind(this),n=this.regionY.bind(this),o=this.regionWidth.bind(this),r=this.regionHeight.bind(this);return[(e?t.transition():t).attr("x",i).attr("y",n).attr("width",o).attr("height",r).style("fill-opacity",function(e){return S(e.opacity)?e.opacity:.1})]},u.regionX=function(e){var t=this.config,i="y"===e.axis?this.y:this.y2;return"y"===e.axis||"y2"===e.axis?t.axis_rotated&&"start"in e?i(e.start):0:t.axis_rotated?0:"start"in e?this.x(this.isTimeSeries()?this.parseDate(e.start):e.start):0},u.regionY=function(e){var t=this.config,i="y"===e.axis?this.y:this.y2;return"y"===e.axis||"y2"===e.axis?t.axis_rotated?0:"end"in e?i(e.end):0:t.axis_rotated&&"start"in e?this.x(this.isTimeSeries()?this.parseDate(e.start):e.start):0},u.regionWidth=function(e){var t,i=this,n=i.config,o=i.regionX(e),r="y"===e.axis?i.y:i.y2;return(t="y"===e.axis||"y2"===e.axis?n.axis_rotated&&"end"in e?r(e.end):i.width:n.axis_rotated?i.width:"end"in e?i.x(i.isTimeSeries()?i.parseDate(e.end):e.end):i.width)<o?0:t-o},u.regionHeight=function(e){var t,i=this,n=i.config,o=this.regionY(e),r="y"===e.axis?i.y:i.y2;return(t="y"===e.axis||"y2"===e.axis?n.axis_rotated?i.height:"start"in e?r(e.start):i.height:n.axis_rotated&&"end"in e?i.x(i.isTimeSeries()?i.parseDate(e.end):e.end):i.height)<o?0:t-o},u.isRegionOnX=function(e){return!e.axis||"x"===e.axis},u.drag=function(e){var t,i,n,o,h,p,f,g,m=this,r=m.config,a=m.main,v=m.d3;m.hasArcType()||r.data_selection_enabled&&(r.zoom_enabled&&!m.zoom.altDomain||r.data_selection_multiple&&(t=m.dragStart[0],i=m.dragStart[1],n=e[0],o=e[1],h=Math.min(t,n),p=Math.max(t,n),f=r.data_selection_grouped?m.margin.top:Math.min(i,o),g=r.data_selection_grouped?m.height:Math.max(i,o),a.select("."+$.dragarea).attr("x",h).attr("y",f).attr("width",p-h).attr("height",g-f),a.selectAll("."+$.shapes).selectAll("."+$.shape).filter(function(e){return r.data_selection_isselectable(e)}).each(function(e,t){var i,n,o,r,a,s,l=v.select(this),c=l.classed($.SELECTED),u=l.classed($.INCLUDED),d=!1;if(l.classed($.circle))i=1*l.attr("cx"),n=1*l.attr("cy"),a=m.togglePoint,d=h<i&&i<p&&f<n&&n<g;else{if(!l.classed($.bar))return;i=(s=y(this)).x,n=s.y,o=s.width,r=s.height,a=m.togglePath,d=!(p<i||i+o<h||g<n||n+r<f)}d^u&&(l.classed($.INCLUDED,!u),l.classed($.SELECTED,!c),a.call(m,!c,l,e,t))})))},u.dragstart=function(e){var t=this.config;this.hasArcType()||t.data_selection_enabled&&(this.dragStart=e,this.main.select("."+$.chart).append("rect").attr("class",$.dragarea).style("opacity",.1),this.dragging=!0)},u.dragend=function(){var e=this.config;this.hasArcType()||e.data_selection_enabled&&(this.main.select("."+$.dragarea).transition().duration(100).style("opacity",0).remove(),this.main.selectAll("."+$.shape).classed($.INCLUDED,!1),this.dragging=!1)},u.selectPoint=function(e,t,i){var n=this,o=n.config,r=(o.axis_rotated?n.circleY:n.circleX).bind(n),a=(o.axis_rotated?n.circleX:n.circleY).bind(n),s=n.pointSelectR.bind(n);o.data_onselected.call(n.api,t,e.node()),n.main.select("."+$.selectedCircles+n.getTargetSelectorSuffix(t.id)).selectAll("."+$.selectedCircle+"-"+i).data([t]).enter().append("circle").attr("class",function(){return n.generateClass($.selectedCircle,i)}).attr("cx",r).attr("cy",a).attr("stroke",function(){return n.color(t)}).attr("r",function(e){return 1.4*n.pointSelectR(e)}).transition().duration(100).attr("r",s)},u.unselectPoint=function(e,t,i){this.config.data_onunselected(t,e.node()),this.main.select("."+$.selectedCircles+this.getTargetSelectorSuffix(t.id)).selectAll("."+$.selectedCircle+"-"+i).transition().duration(100).attr("r",0).remove()},u.togglePoint=function(e,t,i,n){e?this.selectPoint(t,i,n):this.unselectPoint(t,i,n)},u.selectPath=function(e,t){var i=this;i.config.data_onselected.call(i,t,e.node()),e.transition().duration(100).style("fill",function(){return i.d3.rgb(i.color(t)).brighter(.75)})},u.unselectPath=function(e,t){var i=this;i.config.data_onunselected.call(i,t,e.node()),e.transition().duration(100).style("fill",function(){return i.color(t)})},u.togglePath=function(e,t,i,n){e?this.selectPath(t,i,n):this.unselectPath(t,i,n)},u.getToggle=function(e,t){var i;return"circle"===e.nodeName?i=this.isStepType(t)?function(){}:this.togglePoint:"path"===e.nodeName&&(i=this.togglePath),i},u.toggleShape=function(e,t,i){var n=this.d3,o=this.config,r=n.select(e),a=r.classed($.SELECTED),s=this.getToggle(e,t).bind(this);o.data_selection_enabled&&o.data_selection_isselectable(t)&&(o.data_selection_multiple||this.main.selectAll("."+$.shapes+(o.data_selection_grouped?this.getTargetSelectorSuffix(t.id):"")).selectAll("."+$.shape).each(function(e,t){var i=n.select(this);i.classed($.SELECTED)&&s(!1,i.classed($.SELECTED,!1),e,t)}),r.classed($.SELECTED,!a),s(!a,r,t,i))},u.initBrush=function(){var t=this,e=t.d3;t.brush=e.svg.brush().on("brush",function(){t.redrawForBrush()}),t.brush.update=function(){return t.context&&t.context.select("."+$.brush).call(this),this},t.brush.scale=function(e){return t.config.axis_rotated?this.y(e):this.x(e)}},u.initSubchart=function(){var e=this,t=e.config,i=e.context=e.svg.append("g").attr("transform",e.getTranslate("context"));i.style("visibility",t.subchart_show?"visible":"hidden"),i.append("g").attr("clip-path",e.clipPathForSubchart).attr("class",$.chart),i.select("."+$.chart).append("g").attr("class",$.chartBars),i.select("."+$.chart).append("g").attr("class",$.chartLines),i.append("g").attr("clip-path",e.clipPath).attr("class",$.brush).call(e.brush),e.axes.subx=i.append("g").attr("class",$.axisX).attr("transform",e.getTranslate("subx")).attr("clip-path",t.axis_rotated?"":e.clipPathForXAxis)},u.updateTargetsForSubchart=function(e){var t,i=this,n=i.context,o=i.config,r=i.classChartBar.bind(i),a=i.classBars.bind(i),s=i.classChartLine.bind(i),l=i.classLines.bind(i),c=i.classAreas.bind(i);o.subchart_show&&(n.select("."+$.chartBars).selectAll("."+$.chartBar).data(e).attr("class",r).enter().append("g").style("opacity",0).attr("class",r).append("g").attr("class",a),(t=n.select("."+$.chartLines).selectAll("."+$.chartLine).data(e).attr("class",s).enter().append("g").style("opacity",0).attr("class",s)).append("g").attr("class",l),t.append("g").attr("class",c),n.selectAll("."+$.brush+" rect").attr(o.axis_rotated?"width":"height",o.axis_rotated?i.width2:i.height2))},u.updateBarForSubchart=function(e){var t=this;t.contextBar=t.context.selectAll("."+$.bars).selectAll("."+$.bar).data(t.barData.bind(t)),t.contextBar.enter().append("path").attr("class",t.classBar.bind(t)).style("stroke","none").style("fill",t.color),t.contextBar.style("opacity",t.initialOpacity.bind(t)),t.contextBar.exit().transition().duration(e).style("opacity",0).remove()},u.redrawBarForSubchart=function(e,t,i){(t?this.contextBar.transition().duration(i):this.contextBar).attr("d",e).style("opacity",1)},u.updateLineForSubchart=function(e){var t=this;t.contextLine=t.context.selectAll("."+$.lines).selectAll("."+$.line).data(t.lineData.bind(t)),t.contextLine.enter().append("path").attr("class",t.classLine.bind(t)).style("stroke",t.color),t.contextLine.style("opacity",t.initialOpacity.bind(t)),t.contextLine.exit().transition().duration(e).style("opacity",0).remove()},u.redrawLineForSubchart=function(e,t,i){(t?this.contextLine.transition().duration(i):this.contextLine).attr("d",e).style("opacity",1)},u.updateAreaForSubchart=function(e){var t=this,i=t.d3;t.contextArea=t.context.selectAll("."+$.areas).selectAll("."+$.area).data(t.lineData.bind(t)),t.contextArea.enter().append("path").attr("class",t.classArea.bind(t)).style("fill",t.color).style("opacity",function(){return t.orgAreaOpacity=+i.select(this).style("opacity"),0}),t.contextArea.style("opacity",0),t.contextArea.exit().transition().duration(e).style("opacity",0).remove()},u.redrawAreaForSubchart=function(e,t,i){(t?this.contextArea.transition().duration(i):this.contextArea).attr("d",e).style("fill",this.color).style("opacity",this.orgAreaOpacity)},u.redrawSubchart=function(e,t,i,n,o,r,a){var s,l,c,u=this,d=u.d3,h=u.config;u.context.style("visibility",h.subchart_show?"visible":"hidden"),h.subchart_show&&(d.event&&"zoom"===d.event.type&&u.brush.extent(u.x.orgDomain()).update(),e&&(u.brush.empty()||u.brush.extent(u.x.orgDomain()).update(),s=u.generateDrawArea(o,!0),l=u.generateDrawBar(r,!0),c=u.generateDrawLine(a,!0),u.updateBarForSubchart(i),u.updateLineForSubchart(i),u.updateAreaForSubchart(i),u.redrawBarForSubchart(l,i,i),u.redrawLineForSubchart(c,i,i),u.redrawAreaForSubchart(s,i,i)))},u.redrawForBrush=function(){var e=this.x;this.redraw({withTransition:!1,withY:this.config.zoom_rescale,withSubchart:!1,withUpdateXDomain:!0,withDimension:!1}),this.config.subchart_onbrush.call(this.api,e.orgDomain())},u.transformContext=function(e,t){var i;t&&t.axisSubX?i=t.axisSubX:(i=this.context.select("."+$.axisX),e&&(i=i.transition())),this.context.attr("transform",this.getTranslate("context")),i.attr("transform",this.getTranslate("subx"))},u.getDefaultExtent=function(){var e=this.config,t=d(e.axis_x_extent)?e.axis_x_extent(this.getXDomain(this.data.targets)):e.axis_x_extent;return this.isTimeSeries()&&(t=[this.parseDate(t[0]),this.parseDate(t[1])]),t},u.initZoom=function(){var t,i=this,n=i.d3,o=i.config;i.zoom=n.behavior.zoom().on("zoomstart",function(){t=n.event.sourceEvent,i.zoom.altDomain=n.event.sourceEvent.altKey?i.x.orgDomain():null,o.zoom_onzoomstart.call(i.api,n.event.sourceEvent)}).on("zoom",function(){i.redrawForZoom.call(i)}).on("zoomend",function(){var e=n.event.sourceEvent;e&&t.clientX===e.clientX&&t.clientY===e.clientY||(i.redrawEventRect(),i.updateZoom(),o.zoom_onzoomend.call(i.api,i.x.orgDomain()))}),i.zoom.scale=function(e){return o.axis_rotated?this.y(e):this.x(e)},i.zoom.orgScaleExtent=function(){var e=o.zoom_extent?o.zoom_extent:[1,10];return[e[0],Math.max(i.getMaxDataCount()/e[1],e[1])]},i.zoom.updateScaleExtent=function(){var e=P(i.x.orgDomain())/P(i.orgXDomain),t=this.orgScaleExtent();return this.scaleExtent([t[0]*e,t[1]*e]),this}},u.updateZoom=function(){var e=this.config.zoom_enabled?this.zoom:function(){};this.main.select("."+$.zoomRect).call(e).on("dblclick.zoom",null),this.main.selectAll("."+$.eventRect).call(e).on("dblclick.zoom",null)},u.redrawForZoom=function(){var e=this,t=e.d3,i=e.config,n=e.zoom,o=e.x;if(i.zoom_enabled&&0!==e.filterTargetsToShow(e.data.targets).length){if("mousemove"===t.event.sourceEvent.type&&n.altDomain)return o.domain(n.altDomain),void n.scale(o).updateScaleExtent();e.isCategorized()&&o.orgDomain()[0]===e.orgXDomain[0]&&o.domain([e.orgXDomain[0]-1e-10,o.orgDomain()[1]]),e.redraw({withTransition:!1,withY:i.zoom_rescale,withSubchart:!1,withEventRect:!1,withDimension:!1}),"mousemove"===t.event.sourceEvent.type&&(e.cancelClick=!0),i.zoom_onzoom.call(e.api,o.orgDomain())}},u.generateColor=function(){var e=this.config,t=this.d3,n=e.data_colors,o=T(e.color_pattern)?e.color_pattern:t.scale.category10().range(),r=e.data_color,a=[];return function(e){var t,i=e.id||e.data&&e.data.id||e;return n[i]instanceof Function?t=n[i](e):n[i]?t=n[i]:(a.indexOf(i)<0&&a.push(i),t=o[a.indexOf(i)%o.length],n[i]=t),r instanceof Function?r(t,e):t}},u.generateLevelColor=function(){var e=this.config,n=e.color_pattern,t=e.color_threshold,o="value"===t.unit,r=t.values&&t.values.length?t.values:[],a=t.max||100;return T(e.color_threshold)?function(e){var t,i=n[n.length-1];for(t=0;t<r.length;t++)if((o?e:100*e/a)<r[t]){i=n[t];break}return i}:null},u.getYFormat=function(e){var n=this,o=e&&!n.hasType("gauge")?n.defaultArcValueFormat:n.yFormat,r=e&&!n.hasType("gauge")?n.defaultArcValueFormat:n.y2Format;return function(e,t,i){return("y2"===n.axis.getId(i)?r:o).call(n,e,t)}},u.yFormat=function(e){var t=this.config;return(t.axis_y_tick_format?t.axis_y_tick_format:this.defaultValueFormat)(e)},u.y2Format=function(e){var t=this.config;return(t.axis_y2_tick_format?t.axis_y2_tick_format:this.defaultValueFormat)(e)},u.defaultValueFormat=function(e){return S(e)?+e:""},u.defaultArcValueFormat=function(e,t){return(100*t).toFixed(1)+"%"},u.dataLabelFormat=function(e){function t(e){return S(e)?+e:""}var i=this.config.data_labels;return"function"==typeof i.format?i.format:"object"==typeof i.format?i.format[e]?!0===i.format[e]?t:i.format[e]:function(){return""}:t},u.hasCaches=function(e){for(var t=0;t<e.length;t++)if(!(e[t]in this.cache))return!1;return!0},u.addCache=function(e,t){this.cache[e]=this.cloneTarget(t)},u.getCaches=function(e){var t,i=[];for(t=0;t<e.length;t++)e[t]in this.cache&&i.push(this.cloneTarget(this.cache[e[t]]));return i};var $=u.CLASS={target:"c3-target",chart:"c3-chart",chartLine:"c3-chart-line",chartLines:"c3-chart-lines",chartBar:"c3-chart-bar",chartBars:"c3-chart-bars",chartText:"c3-chart-text",chartTexts:"c3-chart-texts",chartArc:"c3-chart-arc",chartArcs:"c3-chart-arcs",chartArcsTitle:"c3-chart-arcs-title",chartArcsBackground:"c3-chart-arcs-background",chartArcsGaugeUnit:"c3-chart-arcs-gauge-unit",chartArcsGaugeMax:"c3-chart-arcs-gauge-max",chartArcsGaugeMin:"c3-chart-arcs-gauge-min",selectedCircle:"c3-selected-circle",selectedCircles:"c3-selected-circles",eventRect:"c3-event-rect",eventRects:"c3-event-rects",eventRectsSingle:"c3-event-rects-single",eventRectsMultiple:"c3-event-rects-multiple",zoomRect:"c3-zoom-rect",brush:"c3-brush",focused:"c3-focused",defocused:"c3-defocused",region:"c3-region",regions:"c3-regions",tooltipContainer:"c3-tooltip-container",tooltip:"c3-tooltip",tooltipName:"c3-tooltip-name",shape:"c3-shape",shapes:"c3-shapes",line:"c3-line",lines:"c3-lines",bar:"c3-bar",bars:"c3-bars",circle:"c3-circle",circles:"c3-circles",arc:"c3-arc",arcs:"c3-arcs",area:"c3-area",areas:"c3-areas",empty:"c3-empty",text:"c3-text",texts:"c3-texts",gaugeValue:"c3-gauge-value",grid:"c3-grid",gridLines:"c3-grid-lines",xgrid:"c3-xgrid",xgrids:"c3-xgrids",xgridLine:"c3-xgrid-line",xgridLines:"c3-xgrid-lines",xgridFocus:"c3-xgrid-focus",ygrid:"c3-ygrid",ygrids:"c3-ygrids",ygridLine:"c3-ygrid-line",ygridLines:"c3-ygrid-lines",axis:"c3-axis",axisX:"c3-axis-x",axisXLabel:"c3-axis-x-label",axisY:"c3-axis-y",axisYLabel:"c3-axis-y-label",axisY2:"c3-axis-y2",axisY2Label:"c3-axis-y2-label",legendBackground:"c3-legend-background",legendItem:"c3-legend-item",legendItemEvent:"c3-legend-item-event",legendItemTile:"c3-legend-item-tile",legendItemHidden:"c3-legend-item-hidden",legendItemFocused:"c3-legend-item-focused",dragarea:"c3-dragarea",EXPANDED:"_expanded_",SELECTED:"_selected_",INCLUDED:"_included_"};u.generateClass=function(e,t){return" "+e+" "+e+this.getTargetSelectorSuffix(t)},u.classText=function(e){return this.generateClass($.text,e.index)},u.classTexts=function(e){return this.generateClass($.texts,e.id)},u.classShape=function(e){return this.generateClass($.shape,e.index)},u.classShapes=function(e){return this.generateClass($.shapes,e.id)},u.classLine=function(e){return this.classShape(e)+this.generateClass($.line,e.id)},u.classLines=function(e){return this.classShapes(e)+this.generateClass($.lines,e.id)},u.classCircle=function(e){return this.classShape(e)+this.generateClass($.circle,e.index)},u.classCircles=function(e){return this.classShapes(e)+this.generateClass($.circles,e.id)},u.classBar=function(e){return this.classShape(e)+this.generateClass($.bar,e.index)},u.classBars=function(e){return this.classShapes(e)+this.generateClass($.bars,e.id)},u.classArc=function(e){return this.classShape(e.data)+this.generateClass($.arc,e.data.id)},u.classArcs=function(e){return this.classShapes(e.data)+this.generateClass($.arcs,e.data.id)},u.classArea=function(e){return this.classShape(e)+this.generateClass($.area,e.id)},u.classAreas=function(e){return this.classShapes(e)+this.generateClass($.areas,e.id)},u.classRegion=function(e,t){return this.generateClass($.region,t)+" "+("class"in e?e.class:"")},u.classEvent=function(e){return this.generateClass($.eventRect,e.index)},u.classTarget=function(e){var t=this.config.data_classes[e],i="";return t&&(i=" "+$.target+"-"+t),this.generateClass($.target,e)+i},u.classFocus=function(e){return this.classFocused(e)+this.classDefocused(e)},u.classFocused=function(e){return" "+(0<=this.focusedTargetIds.indexOf(e.id)?$.focused:"")},u.classDefocused=function(e){return" "+(0<=this.defocusedTargetIds.indexOf(e.id)?$.defocused:"")},u.classChartText=function(e){return $.chartText+this.classTarget(e.id)},u.classChartLine=function(e){return $.chartLine+this.classTarget(e.id)},u.classChartBar=function(e){return $.chartBar+this.classTarget(e.id)},u.classChartArc=function(e){return $.chartArc+this.classTarget(e.data.id)},u.getTargetSelectorSuffix=function(e){return e||0===e?("-"+e).replace(/[\s?!@#$%^&*()_=+,.<>'":;\[\]\/|~`{}\\]/g,"-"):""},u.selectorTarget=function(e,t){return(t||"")+"."+$.target+this.getTargetSelectorSuffix(e)},u.selectorTargets=function(e,t){var i=this;return(e=e||[]).length?e.map(function(e){return i.selectorTarget(e,t)}):null},u.selectorLegend=function(e){return"."+$.legendItem+this.getTargetSelectorSuffix(e)},u.selectorLegends=function(e){var t=this;return e&&e.length?e.map(function(e){return t.selectorLegend(e)}):null};var q,S=u.isValue=function(e){return e||0===e},d=u.isFunction=function(e){return"function"==typeof e},r=u.isString=function(e){return"string"==typeof e},_=u.isUndefined=function(e){return void 0===e},N=u.isDefined=function(e){return void 0!==e},a=u.ceil10=function(e){return 10*Math.ceil(e/10)},l=u.asHalfPixel=function(e){return Math.ceil(e)+.5},P=u.diffDomain=function(e){return e[1]-e[0]},h=u.isEmpty=function(e){return!e||r(e)&&0===e.length||"object"==typeof e&&0===Object.keys(e).length},T=u.notEmpty=function(e){return 0<Object.keys(e).length},B=u.getOption=function(e,t,i){return N(e[t])?e[t]:i},p=u.hasValue=function(t,i){var n=!1;return Object.keys(t).forEach(function(e){t[e]===i&&(n=!0)}),n},y=u.getPathBox=function(e){var t=e.getBoundingClientRect(),i=[e.pathSegList.getItem(0),e.pathSegList.getItem(1)];return{x:i[0].x,y:Math.min(i[0].y,i[1].y),width:t.width,height:t.height}};function f(N,F){var M,i,P,I,L=N.scale.linear(),G="bottom",$=6,B=3,j=null,W=0,t=!0;function H(e,t){e.attr("transform",function(e){return"translate("+Math.ceil(t(e)+W)+", 0)"})}function z(e,t){e.attr("transform",function(e){return"translate(0,"+Math.ceil(t(e))+")"})}function V(e){var t=i?i(e):e;return void 0!==t?t:""}function U(e){return F.withoutTransition?e:N.transition(e)}function Y(e){e.each(function(){var e,t,i,n=Y.g=N.select(this),o=this.__chart__||L,l=this.__chart__=function(){var e,t=L.copy();return F.isCategory&&(e=L.domain(),t.domain([e[0],e[1]-1])),t}(),c=j||function(e){var t,i,n=[];if(e.ticks)return e.ticks.apply(e,P);for(i=e.domain(),t=Math.ceil(i[0]);t<i[1];t++)n.push(t);return 0<n.length&&0<n[0]&&n.unshift(n[0]-(n[1]-n[0])),n}(l),r=n.selectAll(".tick").data(c,l),a=r.enter().insert("g",".domain").attr("class","tick").style("opacity",1e-6),s=r.exit().remove(),u=U(r).style("opacity",1),d=L.rangeExtent?L.rangeExtent():function(e){var t=e[0],i=e[e.length-1];return t<i?[t,i]:[i,t]}(L.range()),h=n.selectAll(".domain").data([0]),p=(h.enter().append("path").attr("class","domain"),U(h));a.append("line"),a.append("text");var f=a.select("line"),g=u.select("line"),m=a.select("text"),v=u.select("text");F.isCategory?(W=Math.ceil((l(1)-l(0))/2),t=I?0:W,i=I?W:0):W=t=0;var y,b,w=function(e){if(q)return q;var r={h:11.5,w:5.5};return e.select("text").text(V).each(function(e){var t=this.getBoundingClientRect(),i=V(e),n=t.height,o=i?t.width/i.length:void 0;n&&o&&(r.h=n,r.w=o)}).text(""),q=r}(n.select(".tick")),C=[],_=Math.max($,0)+B,A="left"===G||"right"===G;function E(e,t){var i=w.h;return 0===t&&(i="left"===G||"right"===G?-((C[e.index]-1)*(w.h/2)-3):".71em"),i}(b=(y=r.select("text")).selectAll("tspan").data(function(e,t){var i=F.tickMultiline?function(e,o){var r,a,s,t=V(e);return"[object Array]"===Object.prototype.toString.call(t)?t:((!o||o<=0)&&(o=A?95:F.isCategory?Math.ceil(l(c[1])-l(c[0]))-12:110),function e(t,i){a=void 0;for(var n=1;n<i.length;n++)if(" "===i.charAt(n)&&(a=n),r=i.substr(0,n+1),s=w.w*r.length,o<s)return e(t.concat(i.substr(0,a||n)),i.slice(a?a+1:n));return t.concat(i)}([],t+""))}(e,F.tickWidth):[].concat(V(e));return C[t]=i.length,i.map(function(e){return{index:t,splitted:e}})})).enter().append("tspan"),b.exit().remove(),b.text(function(e){return e.splitted});var x,S,T,D,k=F.tickTextRotate;switch(G){case"bottom":e=H,f.attr("y2",$),m.attr("y",_),g.attr("x1",t).attr("x2",t).attr("y2",function(e){var t=L(e)+(I?0:W);return d[0]<t&&t<d[1]?$:0}),v.attr("x",0).attr("y",(D=k)?11.5-D/15*2.5*(0<D?1:-1):_).style("text-anchor",(T=k)?0<T?"start":"end":"middle").attr("transform",(S=k)?"rotate("+S+")":""),b.attr("x",0).attr("dy",E).attr("dx",(x=k)?8*Math.sin(Math.PI*(x/180)):0),p.attr("d","M"+d[0]+","+M+"V0H"+d[1]+"V"+M);break;case"top":e=H,f.attr("y2",-$),m.attr("y",-_),g.attr("x2",0).attr("y2",-$),v.attr("x",0).attr("y",-_),y.style("text-anchor","middle"),b.attr("x",0).attr("dy","0em"),p.attr("d","M"+d[0]+","+-M+"V0H"+d[1]+"V"+-M);break;case"left":e=z,f.attr("x2",-$),m.attr("x",-_),g.attr("x2",-$).attr("y1",i).attr("y2",i),v.attr("x",-_).attr("y",W),y.style("text-anchor","end"),b.attr("x",-_).attr("dy",E),p.attr("d","M"+-M+","+d[0]+"H0V"+d[1]+"H"+-M);break;case"right":e=z,f.attr("x2",$),m.attr("x",_),g.attr("x2",$).attr("y2",0),v.attr("x",_).attr("y",0),y.style("text-anchor","start"),b.attr("x",_).attr("dy",E),p.attr("d","M"+M+","+d[0]+"H0V"+d[1]+"H"+M)}if(l.rangeBand){var R=l,O=R.rangeBand()/2;o=l=function(e){return R(e)+O}}else o.rangeBand?o=l:s.call(e,l);a.call(e,o),u.call(e,l)})}return M=(F=F||{}).withOuterTick?6:0,Y.scale=function(e){return arguments.length?(L=e,Y):L},Y.orient=function(e){return arguments.length?(G=e in{top:1,right:1,bottom:1,left:1}?e+"":"bottom",Y):G},Y.tickFormat=function(e){return arguments.length?(i=e,Y):i},Y.tickCentered=function(e){return arguments.length?(I=e,Y):I},Y.tickOffset=function(){return W},Y.tickInterval=function(){var e;return(e=F.isCategory?2*W:(Y.g.select("path.domain").node().getTotalLength()-2*M)/Y.g.selectAll("line").size())===1/0?0:e},Y.ticks=function(){return arguments.length?(P=arguments,Y):P},Y.tickCulling=function(e){return arguments.length?(t=e,Y):t},Y.tickValues=function(e){if("function"==typeof e)j=function(){return e(L.domain())};else{if(!arguments.length)return j;j=e}return Y},Y}i.focus=function(t){var e,i=this.internal;t=i.mapToTargetIds(t),e=i.svg.selectAll(i.selectorTargets(t.filter(i.isTargetToShow,i))),this.revert(),this.defocus(),e.classed($.focused,!0).classed($.defocused,!1),i.hasArcType()&&i.expandArc(t),i.toggleFocusLegend(t,!0),i.focusedTargetIds=t,i.defocusedTargetIds=i.defocusedTargetIds.filter(function(e){return t.indexOf(e)<0})},i.defocus=function(t){var e=this.internal;t=e.mapToTargetIds(t),e.svg.selectAll(e.selectorTargets(t.filter(e.isTargetToShow,e))).classed($.focused,!1).classed($.defocused,!0),e.hasArcType()&&e.unexpandArc(t),e.toggleFocusLegend(t,!1),e.focusedTargetIds=e.focusedTargetIds.filter(function(e){return t.indexOf(e)<0}),e.defocusedTargetIds=t},i.revert=function(e){var t=this.internal;e=t.mapToTargetIds(e),t.svg.selectAll(t.selectorTargets(e)).classed($.focused,!1).classed($.defocused,!1),t.hasArcType()&&t.unexpandArc(e),t.config.legend_show&&(t.showLegend(e.filter(t.isLegendToShow.bind(t))),t.legend.selectAll(t.selectorLegends(e)).filter(function(){return t.d3.select(this).classed($.legendItemFocused)}).classed($.legendItemFocused,!1)),t.focusedTargetIds=[],t.defocusedTargetIds=[]},i.show=function(e,t){var i,n=this.internal;e=n.mapToTargetIds(e),t=t||{},n.removeHiddenTargetIds(e),(i=n.svg.selectAll(n.selectorTargets(e))).transition().style("opacity",1,"important").call(n.endall,function(){i.style("opacity",null).style("opacity",1)}),t.withLegend&&n.showLegend(e),n.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0})},i.hide=function(e,t){var i,n=this.internal;e=n.mapToTargetIds(e),t=t||{},n.addHiddenTargetIds(e),(i=n.svg.selectAll(n.selectorTargets(e))).transition().style("opacity",0,"important").call(n.endall,function(){i.style("opacity",null).style("opacity",0)}),t.withLegend&&n.hideLegend(e),n.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0})},i.toggle=function(e,t){var i=this,n=this.internal;n.mapToTargetIds(e).forEach(function(e){n.isTargetToShow(e)?i.hide(e,t):i.show(e,t)})},i.zoom=function(e){var t=this.internal;return e&&(t.isTimeSeries()&&(e=e.map(function(e){return t.parseDate(e)})),t.brush.extent(e),t.redraw({withUpdateXDomain:!0,withY:t.config.zoom_rescale}),t.config.zoom_onzoom.call(this,t.x.orgDomain())),t.brush.extent()},i.zoom.enable=function(e){var t=this.internal;t.config.zoom_enabled=e,t.updateAndRedraw()},i.unzoom=function(){var e=this.internal;e.brush.clear().update(),e.redraw({withUpdateXDomain:!0})},i.load=function(t){var e=this.internal,i=e.config;t.xs&&e.addXs(t.xs),"classes"in t&&Object.keys(t.classes).forEach(function(e){i.data_classes[e]=t.classes[e]}),"categories"in t&&e.isCategorized()&&(i.axis_x_categories=t.categories),"axes"in t&&Object.keys(t.axes).forEach(function(e){i.data_axes[e]=t.axes[e]}),"colors"in t&&Object.keys(t.colors).forEach(function(e){i.data_colors[e]=t.colors[e]}),"cacheIds"in t&&e.hasCaches(t.cacheIds)?e.load(e.getCaches(t.cacheIds),t.done):"unload"in t?e.unload(e.mapToTargetIds("boolean"==typeof t.unload&&t.unload?null:t.unload),function(){e.loadFromArgs(t)}):e.loadFromArgs(t)},i.unload=function(e){var t=this.internal;(e=e||{})instanceof Array?e={ids:e}:"string"==typeof e&&(e={ids:[e]}),t.unload(t.mapToTargetIds(e.ids),function(){t.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),e.done&&e.done()})},i.flow=function(e){var o,t,i,n,r,a,s,l=this.internal,c=[],u=l.getMaxDataCount(),d=0,h=0;if(e.json)t=l.convertJsonToData(e.json,e.keys);else if(e.rows)t=l.convertRowsToData(e.rows);else{if(!e.columns)return;t=l.convertColumnsToData(e.columns)}o=l.convertDataToTargets(t,!0),l.data.targets.forEach(function(e){var t,i,n=!1;for(t=0;t<o.length;t++)if(e.id===o[t].id){for(n=!0,e.values[e.values.length-1]&&(h=e.values[e.values.length-1].index+1),d=o[t].values.length,i=0;i<d;i++)o[t].values[i].index=h+i,l.isTimeSeries()||(o[t].values[i].x=h+i);e.values=e.values.concat(o[t].values),o.splice(t,1);break}n||c.push(e.id)}),l.data.targets.forEach(function(e){var t,i;for(t=0;t<c.length;t++)if(e.id===c[t])for(h=e.values[e.values.length-1].index+1,i=0;i<d;i++)e.values.push({id:e.id,index:h+i,x:l.isTimeSeries()?l.getOtherTargetX(h+i):h+i,value:null})}),l.data.targets.length&&o.forEach(function(e){var t,i=[];for(t=l.data.targets[0].values[0].index;t<h;t++)i.push({id:e.id,index:t,x:l.isTimeSeries()?l.getOtherTargetX(t):t,value:null});e.values.forEach(function(e){e.index+=h,l.isTimeSeries()||(e.x+=h)}),e.values=i.concat(e.values)}),l.data.targets=l.data.targets.concat(o),l.getMaxDataCount(),r=(n=l.data.targets[0]).values[0],N(e.to)?(d=0,s=l.isTimeSeries()?l.parseDate(e.to):e.to,n.values.forEach(function(e){e.x<s&&d++})):N(e.length)&&(d=e.length),u?1===u&&l.isTimeSeries()&&(a=(n.values[n.values.length-1].x-r.x)/2,i=[new Date(+r.x-a),new Date(+r.x+a)],l.updateXDomain(null,!0,!0,!1,i)):(a=l.isTimeSeries()?1<n.values.length?n.values[n.values.length-1].x-r.x:r.x-l.getXDomain(l.data.targets)[0]:1,i=[r.x-a,r.x],l.updateXDomain(null,!0,!0,!1,i)),l.updateTargets(l.data.targets),l.redraw({flow:{index:r.index,length:d,duration:S(e.duration)?e.duration:l.config.transition_duration,done:e.done,orgDataCount:u},withLegend:!0,withTransition:1<u,withTrimXDomain:!1,withUpdateXAxis:!0})},u.generateFlow=function(O){var N=this,F=N.config,M=N.d3;return function(){var e,t,i,n,o=O.targets,r=O.flow,a=O.drawBar,s=O.drawLine,l=O.drawArea,c=O.cx,u=O.cy,d=O.xv,h=O.xForText,p=O.yForText,f=O.duration,g=r.index,m=r.length,v=N.getValueOnIndex(N.data.targets[0].values,g),y=N.getValueOnIndex(N.data.targets[0].values,g+m),b=N.x.domain(),w=r.duration||f,C=r.done||function(){},_=N.generateWait(),A=N.xgrid||M.selectAll([]),E=N.xgridLines||M.selectAll([]),x=N.mainRegion||M.selectAll([]),S=N.mainText||M.selectAll([]),T=N.mainBar||M.selectAll([]),D=N.mainLine||M.selectAll([]),k=N.mainArea||M.selectAll([]),R=N.mainCircle||M.selectAll([]);N.flowing=!0,N.data.targets.forEach(function(e){e.values.splice(0,m)}),n=N.updateXDomain(o,!0,!0),N.updateXGrid&&N.updateXGrid(!0),e=r.orgDataCount?1===r.orgDataCount||v.x===y.x?N.x(b[0])-N.x(n[0]):N.isTimeSeries()?N.x(b[0])-N.x(n[0]):N.x(v.x)-N.x(y.x):1!==N.data.targets[0].values.length?N.x(b[0])-N.x(n[0]):N.isTimeSeries()?(v=N.getValueOnIndex(N.data.targets[0].values,0),y=N.getValueOnIndex(N.data.targets[0].values,N.data.targets[0].values.length-1),N.x(v.x)-N.x(y.x)):P(n)/2,t=P(b)/P(n),i="translate("+e+",0) scale("+t+",1)",N.hideXGridFocus(),N.hideTooltip(),M.transition().ease("linear").duration(w).each(function(){_.add(N.axes.x.transition().call(N.xAxis)),_.add(T.transition().attr("transform",i)),_.add(D.transition().attr("transform",i)),_.add(k.transition().attr("transform",i)),_.add(R.transition().attr("transform",i)),_.add(S.transition().attr("transform",i)),_.add(x.filter(N.isRegionOnX).transition().attr("transform",i)),_.add(A.transition().attr("transform",i)),_.add(E.transition().attr("transform",i))}).call(_,function(){var e,t=[],i=[],n=[];if(m){for(e=0;e<m;e++)t.push("."+$.shape+"-"+(g+e)),i.push("."+$.text+"-"+(g+e)),n.push("."+$.eventRect+"-"+(g+e));N.svg.selectAll("."+$.shapes).selectAll(t).remove(),N.svg.selectAll("."+$.texts).selectAll(i).remove(),N.svg.selectAll("."+$.eventRects).selectAll(n).remove(),N.svg.select("."+$.xgrid).remove()}A.attr("transform",null).attr(N.xgridAttr),E.attr("transform",null),E.select("line").attr("x1",F.axis_rotated?0:d).attr("x2",F.axis_rotated?N.width:d),E.select("text").attr("x",F.axis_rotated?N.width:0).attr("y",d),T.attr("transform",null).attr("d",a),D.attr("transform",null).attr("d",s),k.attr("transform",null).attr("d",l),R.attr("transform",null).attr("cx",c).attr("cy",u),S.attr("transform",null).attr("x",h).attr("y",p).style("fill-opacity",N.opacityForText.bind(N)),x.attr("transform",null),x.select("rect").filter(N.isRegionOnX).attr("x",N.regionX.bind(N)).attr("width",N.regionWidth.bind(N)),F.interaction_enabled&&N.redrawEventRect(),C(),N.flowing=!1})}},i.selected=function(e){var t=this.internal,i=t.d3;return i.merge(t.main.selectAll("."+$.shapes+t.getTargetSelectorSuffix(e)).selectAll("."+$.shape).filter(function(){return i.select(this).classed($.SELECTED)}).map(function(e){return e.map(function(e){var t=e.__data__;return t.data?t.data:t})}))},i.select=function(l,c,u){var d=this.internal,h=d.d3,p=d.config;p.data_selection_enabled&&d.main.selectAll("."+$.shapes).selectAll("."+$.shape).each(function(e,t){var i=h.select(this),n=e.data?e.data.id:e.id,o=d.getToggle(this,e).bind(d),r=p.data_selection_grouped||!l||0<=l.indexOf(n),a=!c||0<=c.indexOf(t),s=i.classed($.SELECTED);i.classed($.line)||i.classed($.area)||(r&&a?p.data_selection_isselectable(e)&&!s&&o(!0,i.classed($.SELECTED,!0),e,t):N(u)&&u&&s&&o(!1,i.classed($.SELECTED,!1),e,t))})},i.unselect=function(l,c){var u=this.internal,d=u.d3,h=u.config;h.data_selection_enabled&&u.main.selectAll("."+$.shapes).selectAll("."+$.shape).each(function(e,t){var i=d.select(this),n=e.data?e.data.id:e.id,o=u.getToggle(this,e).bind(u),r=h.data_selection_grouped||!l||0<=l.indexOf(n),a=!c||0<=c.indexOf(t),s=i.classed($.SELECTED);i.classed($.line)||i.classed($.area)||r&&a&&h.data_selection_isselectable(e)&&s&&o(!1,i.classed($.SELECTED,!1),e,t)})},i.transform=function(e,t){var i=this.internal,n=0<=["pie","donut"].indexOf(e)?{withTransform:!0}:null;i.transformTo(t,e,n)},u.transformTo=function(e,t,i){var n=!this.hasArcType(),o=i||{withTransitionForAxis:n};o.withTransitionForTransform=!1,this.transiting=!1,this.setTargetType(e,t),this.updateTargets(this.data.targets),this.updateAndRedraw(o)},i.groups=function(e){var t=this.internal,i=t.config;return _(e)||(i.data_groups=e,t.redraw()),i.data_groups},i.xgrids=function(e){var t=this.internal,i=t.config;return e&&(i.grid_x_lines=e,t.redrawWithoutRescale()),i.grid_x_lines},i.xgrids.add=function(e){var t=this.internal;return this.xgrids(t.config.grid_x_lines.concat(e||[]))},i.xgrids.remove=function(e){this.internal.removeGridLines(e,!0)},i.ygrids=function(e){var t=this.internal,i=t.config;return e&&(i.grid_y_lines=e,t.redrawWithoutRescale()),i.grid_y_lines},i.ygrids.add=function(e){var t=this.internal;return this.ygrids(t.config.grid_y_lines.concat(e||[]))},i.ygrids.remove=function(e){this.internal.removeGridLines(e,!1)},i.regions=function(e){var t=this.internal,i=t.config;return e&&(i.regions=e,t.redrawWithoutRescale()),i.regions},i.regions.add=function(e){var t=this.internal,i=t.config;return e&&(i.regions=i.regions.concat(e),t.redrawWithoutRescale()),i.regions},i.regions.remove=function(e){var t,i,n,o=this.internal,r=o.config;return e=e||{},t=o.getOption(e,"duration",r.transition_duration),i=o.getOption(e,"classes",[$.region]),n=o.main.select("."+$.regions).selectAll(i.map(function(e){return"."+e})),(t?n.transition().duration(t):n).style("opacity",0).remove(),r.regions=r.regions.filter(function(e){var t=!1;return!e.class||(e.class.split(" ").forEach(function(e){0<=i.indexOf(e)&&(t=!0)}),!t)}),r.regions},i.data=function(t){var e=this.internal.data.targets;return void 0===t?e:e.filter(function(e){return 0<=[].concat(t).indexOf(e.id)})},i.data.shown=function(e){return this.internal.filterTargetsToShow(this.data(e))},i.data.values=function(e){var t,i=null;return e&&(i=(t=this.data(e))[0]?t[0].values.map(function(e){return e.value}):null),i},i.data.names=function(e){return this.internal.clearLegendItemTextBoxCache(),this.internal.updateDataAttributes("names",e)},i.data.colors=function(e){return this.internal.updateDataAttributes("colors",e)},i.data.axes=function(e){return this.internal.updateDataAttributes("axes",e)},i.category=function(e,t){var i=this.internal,n=i.config;return 1<arguments.length&&(n.axis_x_categories[e]=t,i.redraw()),n.axis_x_categories[e]},i.categories=function(e){var t=this.internal,i=t.config;return arguments.length&&(i.axis_x_categories=e,t.redraw()),i.axis_x_categories},i.color=function(e){return this.internal.color(e)},i.x=function(e){var t=this.internal;return arguments.length&&(t.updateTargetX(t.data.targets,e),t.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})),t.data.xs},i.xs=function(e){var t=this.internal;return arguments.length&&(t.updateTargetXs(t.data.targets,e),t.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})),t.data.xs},i.axis=function(){},i.axis.labels=function(t){var i=this.internal;arguments.length&&(Object.keys(t).forEach(function(e){i.axis.setLabelText(e,t[e])}),i.axis.updateLabels())},i.axis.max=function(e){var t=this.internal,i=t.config;if(!arguments.length)return{x:i.axis_x_max,y:i.axis_y_max,y2:i.axis_y2_max};"object"==typeof e?(S(e.x)&&(i.axis_x_max=e.x),S(e.y)&&(i.axis_y_max=e.y),S(e.y2)&&(i.axis_y2_max=e.y2)):i.axis_y_max=i.axis_y2_max=e,t.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})},i.axis.min=function(e){var t=this.internal,i=t.config;if(!arguments.length)return{x:i.axis_x_min,y:i.axis_y_min,y2:i.axis_y2_min};"object"==typeof e?(S(e.x)&&(i.axis_x_min=e.x),S(e.y)&&(i.axis_y_min=e.y),S(e.y2)&&(i.axis_y2_min=e.y2)):i.axis_y_min=i.axis_y2_min=e,t.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})},i.axis.range=function(e){if(!arguments.length)return{max:this.axis.max(),min:this.axis.min()};N(e.max)&&this.axis.max(e.max),N(e.min)&&this.axis.min(e.min)},i.legend=function(){},i.legend.show=function(e){var t=this.internal;t.showLegend(t.mapToTargetIds(e)),t.updateAndRedraw({withLegend:!0})},i.legend.hide=function(e){var t=this.internal;t.hideLegend(t.mapToTargetIds(e)),t.updateAndRedraw({withLegend:!0})},i.resize=function(e){var t=this.internal.config;t.size_width=e?e.width:null,t.size_height=e?e.height:null,this.flush()},i.flush=function(){this.internal.updateAndRedraw({withLegend:!0,withTransition:!1,withTransitionForTransform:!1})},i.destroy=function(){var t=this.internal;return c.clearInterval(t.intervalForObserveInserted),c.onresize=null,t.selectChart.classed("c3",!1).html(""),Object.keys(t).forEach(function(e){t[e]=null}),null},i.tooltip=function(){},i.tooltip.show=function(e){var t,i,n=this.internal;e.mouse&&(i=e.mouse),e.data?t=n.isMultipleX()?(i=[n.x(e.data.x),n.getYScale(e.data.id)(e.data.value)],null):S(e.data.index)?e.data.index:n.getIndexByX(e.data.x):void 0!==e.x?t=n.getIndexByX(e.x):void 0!==e.index&&(t=e.index),n.dispatchEvent("mouseover",t,i),n.dispatchEvent("mousemove",t,i)},i.tooltip.hide=function(){this.internal.dispatchEvent("mouseout",0)},u.isSafari=function(){var e=c.navigator.userAgent;return 0<=e.indexOf("Safari")&&e.indexOf("Chrome")<0},u.isChrome=function(){return 0<=c.navigator.userAgent.indexOf("Chrome")},Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");function t(){}function i(){return o.apply(this instanceof t?this:e,n.concat(Array.prototype.slice.call(arguments)))}var n=Array.prototype.slice.call(arguments,1),o=this;return t.prototype=this.prototype,i.prototype=new t,i}),"function"==typeof define&&define.amd?define("c3",["d3"],e):"undefined"!=typeof exports&&"undefined"!=typeof module?module.exports=e:c.c3=e}(window),("function"==typeof define&&define.amd?define:function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery","lodash")):window.toastr=t(window.jQuery,window._)})(["jquery","lodash"],function(u,d){return v=0,r="alert",a="info",s="success",l="warning",i={clear:function(e){var t=f();m||h(t),n(e,t)||function(e){for(var t=m.children(),i=t.length-1;0<=i;i--)n(u(t[i]),e)}(t)},remove:function(e){var t=f();m||h(t),e&&0===u(":focus",e).length?g(e):m.children().length&&m.remove()},alert:function(e,t,i){return o({type:r,title:e,message:t,options:i})},getContainer:h,info:function(e,t,i){return o({type:a,title:e,message:t,options:i})},options:{},subscribe:function(e){t=e},success:function(e,t,i){return o({type:s,title:e,message:t,options:i})},version:"2.0.3",warning:e,warning_permanent:e};function e(e,t,i){return o({type:l,title:e,message:t,options:i})}function h(e,t){return e=e||f(),(m=u("#"+e.containerId)).length||t&&(m=function(e){return(m=u("<div/>").attr("id",e.containerId).addClass(e.positionClass).attr("aria-live","polite").attr("role","alert")).appendTo(u(e.target)),m}(e)),m}function n(e,t){return!(!e||0!==u(":focus",e).length||(e[t.hideMethod]({duration:t.hideDuration,easing:t.hideEasing,complete:function(){g(e)}}),0))}function p(e){t&&t(e)}function o(e){var t=f(),i=u.extend(t,e);void 0!==e.options&&(i=u.extend(i,e.options)),v++,m=h(i,!0);var n=d.template(function(){return this._template||(this._template='<div class="{{= toastClass }} {{= toastClass }}-{{= type }}"><div class="notification-header"><p class="{{= titleClass }}"><i class="icon icon-state-{{= type }}"></i>&nbsp;<span class="text">{{= title }}</span><i class="js-close close-icon {{= closeIcon }}"></i></p></div><div class="{{= messageClass }}" style="display: none;">{{= message }}</div></div>')}())(i),o=u(n),r=null,a=o,s=a.find(".js-close"),l={toastId:v,state:"visible",startTime:new Date,options:i};return i.message&&a.find("."+i.messageClass).show(),a.hide(),i.newestOnTop?m.prepend(a):m.append(a),a[i.showMethod]({duration:i.showDuration,easing:i.showEasing,complete:i.onShown}),0<i.timeOut&&(r=setTimeout(c,i.timeOut)),a.hover(function(){clearTimeout(r),a.stop(!0,!0)[i.showMethod]({duration:i.showDuration,easing:i.showEasing})},function(){(0<i.timeOut||0<i.extendedTimeOut)&&(r=setTimeout(c,i.extendedTimeOut))}),!i.onclick&&i.tapToDismiss&&a.click(c),s&&s.click(function(e){e.stopPropagation?e.stopPropagation():void 0!==e.cancelBubble&&!0!==e.cancelBubble&&(e.cancelBubble=!0),i.onCloseClick&&i.onCloseClick(e),c(!0)}),i.onclick&&a.click(function(){i.onclick(),c()}),p(l),i.debug&&console&&console.log(l),a;function c(e){if(!u(":focus",a).length||e)return a[i.hideMethod]({duration:i.hideDuration,easing:i.hideEasing,complete:function(){g(a),i.onHidden&&"hidden"!==l.state&&i.onHidden(),l.state="hidden",l.endTime=new Date,p(l)}})}}function f(){return u.extend({},{tapToDismiss:!1,toastClass:"notification",containerId:"notifications-container",debug:!1,showMethod:"fadeIn",showDuration:300,showEasing:"swing",onShown:void 0,hideMethod:"fadeOut",hideDuration:1e3,hideEasing:"swing",onHidden:void 0,extendedTimeOut:1e3,onCloseClick:void 0,positionClass:"notification-below-header",timeOut:5e3,titleClass:"headline",messageClass:"notification-content",closeIcon:"icon icon-times-circle",target:"body",newestOnTop:!0},i.options)}function g(e){m=m||h(),e.is(":visible")||(e.remove(),e=null,0===m.children().length&&m.remove())}var m,t,v,r,a,s,l,i}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.moment=t()}(this,function(){"use strict";var e,o;function h(){return e.apply(null,arguments)}function a(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function s(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function r(e){return void 0===e}function l(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function c(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function n(e,t){var i,n=[];for(i=0;i<e.length;++i)n.push(t(e[i],i));return n}function p(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function u(e,t){for(var i in t)p(t,i)&&(e[i]=t[i]);return p(t,"toString")&&(e.toString=t.toString),p(t,"valueOf")&&(e.valueOf=t.valueOf),e}function d(e,t,i,n){return Tt(e,t,i,n,!0).utc()}function f(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function g(e){if(null==e._isValid){var t=f(e),i=o.call(t.parsedDateParts,function(e){return null!=e}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&i);if(e._strict&&(n=n&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return n;e._isValid=n}return e._isValid}function m(e){var t=d(NaN);return null!=e?u(f(t),e):f(t).userInvalidated=!0,t}o=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),i=t.length>>>0,n=0;n<i;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};var v=h.momentProperties=[];function y(e,t){var i,n,o;if(r(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),r(t._i)||(e._i=t._i),r(t._f)||(e._f=t._f),r(t._l)||(e._l=t._l),r(t._strict)||(e._strict=t._strict),r(t._tzm)||(e._tzm=t._tzm),r(t._isUTC)||(e._isUTC=t._isUTC),r(t._offset)||(e._offset=t._offset),r(t._pf)||(e._pf=f(t)),r(t._locale)||(e._locale=t._locale),0<v.length)for(i=0;i<v.length;i++)r(o=t[n=v[i]])||(e[n]=o);return e}var t=!1;function b(e){y(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===t&&(t=!0,h.updateOffset(this),t=!1)}function w(e){return e instanceof b||null!=e&&null!=e._isAMomentObject}function C(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function _(e){var t=+e,i=0;return 0!=t&&isFinite(t)&&(i=C(t)),i}function A(e,t,i){var n,o=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),a=0;for(n=0;n<o;n++)(i&&e[n]!==t[n]||!i&&_(e[n])!==_(t[n]))&&a++;return a+r}function E(e){!1===h.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function i(o,r){var a=!0;return u(function(){if(null!=h.deprecationHandler&&h.deprecationHandler(null,o),a){for(var e,t=[],i=0;i<arguments.length;i++){if(e="","object"==typeof arguments[i]){for(var n in e+="\n["+i+"] ",arguments[0])e+=n+": "+arguments[0][n]+", ";e=e.slice(0,-2)}else e=arguments[i];t.push(e)}E(o+"\nArguments: "+Array.prototype.slice.call(t).join("")+"\n"+(new Error).stack),a=!1}return r.apply(this,arguments)},r)}var x,S={};function T(e,t){null!=h.deprecationHandler&&h.deprecationHandler(e,t),S[e]||(E(t),S[e]=!0)}function D(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function k(e,t){var i,n=u({},e);for(i in t)p(t,i)&&(s(e[i])&&s(t[i])?(n[i]={},u(n[i],e[i]),u(n[i],t[i])):null!=t[i]?n[i]=t[i]:delete n[i]);for(i in e)p(e,i)&&!p(t,i)&&s(e[i])&&(n[i]=u({},n[i]));return n}function R(e){null!=e&&this.set(e)}h.suppressDeprecationWarnings=!1,h.deprecationHandler=null,x=Object.keys?Object.keys:function(e){var t,i=[];for(t in e)p(e,t)&&i.push(t);return i};var O={};function N(e,t){var i=e.toLowerCase();O[i]=O[i+"s"]=O[t]=e}function F(e){return"string"==typeof e?O[e]||O[e.toLowerCase()]:void 0}function M(e){var t,i,n={};for(i in e)p(e,i)&&(t=F(i))&&(n[t]=e[i]);return n}var P={};function I(e,t){P[e]=t}function L(e,t,i){var n=""+Math.abs(e),o=t-n.length;return(0<=e?i?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var G=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,$=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,B={},j={};function W(e,t,i,n){var o=n;"string"==typeof n&&(o=function(){return this[n]()}),e&&(j[e]=o),t&&(j[t[0]]=function(){return L(o.apply(this,arguments),t[1],t[2])}),i&&(j[i]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function H(e,t){return e.isValid()?(t=z(t,e.localeData()),B[t]=B[t]||function(n){var e,o,t,r=n.match(G);for(e=0,o=r.length;e<o;e++)j[r[e]]?r[e]=j[r[e]]:r[e]=(t=r[e]).match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"");return function(e){var t,i="";for(t=0;t<o;t++)i+=D(r[t])?r[t].call(e,n):r[t];return i}}(t),B[t](e)):e.localeData().invalidDate()}function z(e,t){var i=5;function n(e){return t.longDateFormat(e)||e}for($.lastIndex=0;0<=i&&$.test(e);)e=e.replace($,n),$.lastIndex=0,i-=1;return e}var V=/\d/,U=/\d\d/,Y=/\d{3}/,q=/\d{4}/,Q=/[+-]?\d{6}/,K=/\d\d?/,X=/\d\d\d\d?/,J=/\d\d\d\d\d\d?/,Z=/\d{1,3}/,ee=/\d{1,4}/,te=/[+-]?\d{1,6}/,ie=/\d+/,ne=/[+-]?\d+/,oe=/Z|[+-]\d\d:?\d\d/gi,re=/Z|[+-]\d\d(?::?\d\d)?/gi,ae=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,se={};function le(e,i,n){se[e]=D(i)?i:function(e,t){return e&&n?n:i}}function ce(e,t){return p(se,e)?se[e](t._strict,t._locale):new RegExp(function(e){return ue(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,n,o){return t||i||n||o}))}(e))}function ue(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var de={};function he(e,i){var t,n=i;for("string"==typeof e&&(e=[e]),l(i)&&(n=function(e,t){t[i]=_(e)}),t=0;t<e.length;t++)de[e[t]]=n}function pe(e,o){he(e,function(e,t,i,n){i._w=i._w||{},o(e,i._w,i,n)})}var fe=0,ge=1,me=2,ve=3,ye=4,be=5,we=6,Ce=7,_e=8;function Ae(e){return Ee(e)?366:365}function Ee(e){return e%4==0&&e%100!=0||e%400==0}W("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),W(0,["YY",2],0,function(){return this.year()%100}),W(0,["YYYY",4],0,"year"),W(0,["YYYYY",5],0,"year"),W(0,["YYYYYY",6,!0],0,"year"),N("year","y"),I("year",1),le("Y",ne),le("YY",K,U),le("YYYY",ee,q),le("YYYYY",te,Q),le("YYYYYY",te,Q),he(["YYYYY","YYYYYY"],fe),he("YYYY",function(e,t){t[fe]=2===e.length?h.parseTwoDigitYear(e):_(e)}),he("YY",function(e,t){t[fe]=h.parseTwoDigitYear(e)}),he("Y",function(e,t){t[fe]=parseInt(e,10)}),h.parseTwoDigitYear=function(e){return _(e)+(68<_(e)?1900:2e3)};var xe,Se=Te("FullYear",!0);function Te(t,i){return function(e){return null!=e?(ke(this,t,e),h.updateOffset(this,i),this):De(this,t)}}function De(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function ke(e,t,i){e.isValid()&&!isNaN(i)&&("FullYear"===t&&Ee(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](i,e.month(),Re(i,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](i))}function Re(e,t){if(isNaN(e)||isNaN(t))return NaN;var i=function(e,t){return(e%t+t)%t}(t,12);return e+=(t-i)/12,1===i?Ee(e)?29:28:31-i%7%2}xe=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},W("M",["MM",2],"Mo",function(){return this.month()+1}),W("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),W("MMMM",0,0,function(e){return this.localeData().months(this,e)}),N("month","M"),I("month",8),le("M",K),le("MM",K,U),le("MMM",function(e,t){return t.monthsShortRegex(e)}),le("MMMM",function(e,t){return t.monthsRegex(e)}),he(["M","MM"],function(e,t){t[ge]=_(e)-1}),he(["MMM","MMMM"],function(e,t,i,n){var o=i._locale.monthsParse(e,n,i._strict);null!=o?t[ge]=o:f(i).invalidMonth=e});var Oe=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Ne="January_February_March_April_May_June_July_August_September_October_November_December".split("_");var Fe="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Me(e,t){var i;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=_(t);else if(!l(t=e.localeData().monthsParse(t)))return e;return i=Math.min(e.date(),Re(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,i),e}function Pe(e){return null!=e?(Me(this,e),h.updateOffset(this,!0),this):De(this,"Month")}var Ie=ae;var Le=ae;function Ge(){function e(e,t){return t.length-e.length}var t,i,n=[],o=[],r=[];for(t=0;t<12;t++)i=d([2e3,t]),n.push(this.monthsShort(i,"")),o.push(this.months(i,"")),r.push(this.months(i,"")),r.push(this.monthsShort(i,""));for(n.sort(e),o.sort(e),r.sort(e),t=0;t<12;t++)n[t]=ue(n[t]),o[t]=ue(o[t]);for(t=0;t<24;t++)r[t]=ue(r[t]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function $e(e){var t;if(e<100&&0<=e){var i=Array.prototype.slice.call(arguments);i[0]=e+400,t=new Date(Date.UTC.apply(null,i)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)}else t=new Date(Date.UTC.apply(null,arguments));return t}function Be(e,t,i){var n=7+t-i;return n-(7+$e(e,0,n).getUTCDay()-t)%7-1}function je(e,t,i,n,o){var r,a,s=1+7*(t-1)+(7+i-n)%7+Be(e,n,o);return a=s<=0?Ae(r=e-1)+s:s>Ae(e)?(r=e+1,s-Ae(e)):(r=e,s),{year:r,dayOfYear:a}}function We(e,t,i){var n,o,r=Be(e.year(),t,i),a=Math.floor((e.dayOfYear()-r-1)/7)+1;return a<1?n=a+He(o=e.year()-1,t,i):a>He(e.year(),t,i)?(n=a-He(e.year(),t,i),o=e.year()+1):(o=e.year(),n=a),{week:n,year:o}}function He(e,t,i){var n=Be(e,t,i),o=Be(e+1,t,i);return(Ae(e)-n+o)/7}W("w",["ww",2],"wo","week"),W("W",["WW",2],"Wo","isoWeek"),N("week","w"),N("isoWeek","W"),I("week",5),I("isoWeek",5),le("w",K),le("ww",K,U),le("W",K),le("WW",K,U),pe(["w","ww","W","WW"],function(e,t,i,n){t[n.substr(0,1)]=_(e)});function ze(e,t){return e.slice(t,7).concat(e.slice(0,t))}W("d",0,"do","day"),W("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),W("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),W("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),W("e",0,0,"weekday"),W("E",0,0,"isoWeekday"),N("day","d"),N("weekday","e"),N("isoWeekday","E"),I("day",11),I("weekday",11),I("isoWeekday",11),le("d",K),le("e",K),le("E",K),le("dd",function(e,t){return t.weekdaysMinRegex(e)}),le("ddd",function(e,t){return t.weekdaysShortRegex(e)}),le("dddd",function(e,t){return t.weekdaysRegex(e)}),pe(["dd","ddd","dddd"],function(e,t,i,n){var o=i._locale.weekdaysParse(e,n,i._strict);null!=o?t.d=o:f(i).invalidWeekday=e}),pe(["d","e","E"],function(e,t,i,n){t[n]=_(e)});var Ve="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");var Ue="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");var Ye="Su_Mo_Tu_We_Th_Fr_Sa".split("_");var qe=ae;var Qe=ae;var Ke=ae;function Xe(){function e(e,t){return t.length-e.length}var t,i,n,o,r,a=[],s=[],l=[],c=[];for(t=0;t<7;t++)i=d([2e3,1]).day(t),n=this.weekdaysMin(i,""),o=this.weekdaysShort(i,""),r=this.weekdays(i,""),a.push(n),s.push(o),l.push(r),c.push(n),c.push(o),c.push(r);for(a.sort(e),s.sort(e),l.sort(e),c.sort(e),t=0;t<7;t++)s[t]=ue(s[t]),l[t]=ue(l[t]),c[t]=ue(c[t]);this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Je(){return this.hours()%12||12}function Ze(e,t){W(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function et(e,t){return t._meridiemParse}W("H",["HH",2],0,"hour"),W("h",["hh",2],0,Je),W("k",["kk",2],0,function(){return this.hours()||24}),W("hmm",0,0,function(){return""+Je.apply(this)+L(this.minutes(),2)}),W("hmmss",0,0,function(){return""+Je.apply(this)+L(this.minutes(),2)+L(this.seconds(),2)}),W("Hmm",0,0,function(){return""+this.hours()+L(this.minutes(),2)}),W("Hmmss",0,0,function(){return""+this.hours()+L(this.minutes(),2)+L(this.seconds(),2)}),Ze("a",!0),Ze("A",!1),N("hour","h"),I("hour",13),le("a",et),le("A",et),le("H",K),le("h",K),le("k",K),le("HH",K,U),le("hh",K,U),le("kk",K,U),le("hmm",X),le("hmmss",J),le("Hmm",X),le("Hmmss",J),he(["H","HH"],ve),he(["k","kk"],function(e,t,i){var n=_(e);t[ve]=24===n?0:n}),he(["a","A"],function(e,t,i){i._isPm=i._locale.isPM(e),i._meridiem=e}),he(["h","hh"],function(e,t,i){t[ve]=_(e),f(i).bigHour=!0}),he("hmm",function(e,t,i){var n=e.length-2;t[ve]=_(e.substr(0,n)),t[ye]=_(e.substr(n)),f(i).bigHour=!0}),he("hmmss",function(e,t,i){var n=e.length-4,o=e.length-2;t[ve]=_(e.substr(0,n)),t[ye]=_(e.substr(n,2)),t[be]=_(e.substr(o)),f(i).bigHour=!0}),he("Hmm",function(e,t,i){var n=e.length-2;t[ve]=_(e.substr(0,n)),t[ye]=_(e.substr(n))}),he("Hmmss",function(e,t,i){var n=e.length-4,o=e.length-2;t[ve]=_(e.substr(0,n)),t[ye]=_(e.substr(n,2)),t[be]=_(e.substr(o))});var tt,it=Te("Hours",!0),nt={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Ne,monthsShort:Fe,week:{dow:0,doy:6},weekdays:Ve,weekdaysMin:Ye,weekdaysShort:Ue,meridiemParse:/[ap]\.?m?\.?/i},ot={},rt={};function at(e){return e?e.toLowerCase().replace("_","-"):e}function st(e){var t=null;if(!ot[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=tt._abbr,require("./locale/"+e),lt(t)}catch(e){}return ot[e]}function lt(e,t){var i;return e&&((i=r(t)?ut(e):ct(e,t))?tt=i:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),tt._abbr}function ct(e,t){if(null===t)return delete ot[e],null;var i,n=nt;if(t.abbr=e,null!=ot[e])T("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=ot[e]._config;else if(null!=t.parentLocale)if(null!=ot[t.parentLocale])n=ot[t.parentLocale]._config;else{if(null==(i=st(t.parentLocale)))return rt[t.parentLocale]||(rt[t.parentLocale]=[]),rt[t.parentLocale].push({name:e,config:t}),null;n=i._config}return ot[e]=new R(k(n,t)),rt[e]&&rt[e].forEach(function(e){ct(e.name,e.config)}),lt(e),ot[e]}function ut(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return tt;if(!a(e)){if(t=st(e))return t;e=[e]}return function(e){for(var t,i,n,o,r=0;r<e.length;){for(t=(o=at(e[r]).split("-")).length,i=(i=at(e[r+1]))?i.split("-"):null;0<t;){if(n=st(o.slice(0,t).join("-")))return n;if(i&&i.length>=t&&A(o,i,!0)>=t-1)break;t--}r++}return tt}(e)}function dt(e){var t,i=e._a;return i&&-2===f(e).overflow&&(t=i[ge]<0||11<i[ge]?ge:i[me]<1||i[me]>Re(i[fe],i[ge])?me:i[ve]<0||24<i[ve]||24===i[ve]&&(0!==i[ye]||0!==i[be]||0!==i[we])?ve:i[ye]<0||59<i[ye]?ye:i[be]<0||59<i[be]?be:i[we]<0||999<i[we]?we:-1,f(e)._overflowDayOfYear&&(t<fe||me<t)&&(t=me),f(e)._overflowWeeks&&-1===t&&(t=Ce),f(e)._overflowWeekday&&-1===t&&(t=_e),f(e).overflow=t),e}function ht(e,t,i){return null!=e?e:null!=t?t:i}function pt(e){var t,i,n,o,r,a=[];if(!e._d){for(n=function(e){var t=new Date(h.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}(e),e._w&&null==e._a[me]&&null==e._a[ge]&&function(e){var t,i,n,o,r,a,s,l;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)r=1,a=4,i=ht(t.GG,e._a[fe],We(Dt(),1,4).year),n=ht(t.W,1),((o=ht(t.E,1))<1||7<o)&&(l=!0);else{r=e._locale._week.dow,a=e._locale._week.doy;var c=We(Dt(),r,a);i=ht(t.gg,e._a[fe],c.year),n=ht(t.w,c.week),null!=t.d?((o=t.d)<0||6<o)&&(l=!0):null!=t.e?(o=t.e+r,(t.e<0||6<t.e)&&(l=!0)):o=r}n<1||n>He(i,r,a)?f(e)._overflowWeeks=!0:null!=l?f(e)._overflowWeekday=!0:(s=je(i,n,o,r,a),e._a[fe]=s.year,e._dayOfYear=s.dayOfYear)}(e),null!=e._dayOfYear&&(r=ht(e._a[fe],n[fe]),(e._dayOfYear>Ae(r)||0===e._dayOfYear)&&(f(e)._overflowDayOfYear=!0),i=$e(r,0,e._dayOfYear),e._a[ge]=i.getUTCMonth(),e._a[me]=i.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=a[t]=n[t];for(;t<7;t++)e._a[t]=a[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ve]&&0===e._a[ye]&&0===e._a[be]&&0===e._a[we]&&(e._nextDay=!0,e._a[ve]=0),e._d=(e._useUTC?$e:function(e,t,i,n,o,r,a){var s;return e<100&&0<=e?(s=new Date(e+400,t,i,n,o,r,a),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,i,n,o,r,a),s}).apply(null,a),o=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ve]=24),e._w&&void 0!==e._w.d&&e._w.d!==o&&(f(e).weekdayMismatch=!0)}}var ft=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mt=/Z|[+-]\d\d(?::?\d\d)?/,vt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],yt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],bt=/^\/?Date\((\-?\d+)/i;function wt(e){var t,i,n,o,r,a,s=e._i,l=ft.exec(s)||gt.exec(s);if(l){for(f(e).iso=!0,t=0,i=vt.length;t<i;t++)if(vt[t][1].exec(l[1])){o=vt[t][0],n=!1!==vt[t][2];break}if(null==o)return void(e._isValid=!1);if(l[3]){for(t=0,i=yt.length;t<i;t++)if(yt[t][1].exec(l[3])){r=(l[2]||" ")+yt[t][0];break}if(null==r)return void(e._isValid=!1)}if(!n&&null!=r)return void(e._isValid=!1);if(l[4]){if(!mt.exec(l[4]))return void(e._isValid=!1);a="Z"}e._f=o+(r||"")+(a||""),xt(e)}else e._isValid=!1}var Ct=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function _t(e,t,i,n,o,r){var a=[function(e){var t=parseInt(e,10);{if(t<=49)return 2e3+t;if(t<=999)return 1900+t}return t}(e),Fe.indexOf(t),parseInt(i,10),parseInt(n,10),parseInt(o,10)];return r&&a.push(parseInt(r,10)),a}var At={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Et(e){var t=Ct.exec(function(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}(e._i));if(t){var i=_t(t[4],t[3],t[2],t[5],t[6],t[7]);if(!function(e,t,i){return!e||Ue.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(f(i).weekdayMismatch=!0,i._isValid=!1)}(t[1],i,e))return;e._a=i,e._tzm=function(e,t,i){if(e)return At[e];if(t)return 0;var n=parseInt(i,10),o=n%100;return 60*((n-o)/100)+o}(t[8],t[9],t[10]),e._d=$e.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),f(e).rfc2822=!0}else e._isValid=!1}function xt(e){if(e._f!==h.ISO_8601)if(e._f!==h.RFC_2822){e._a=[],f(e).empty=!0;var t,i,n,o,r,a,s,l,c=""+e._i,u=c.length,d=0;for(n=z(e._f,e._locale).match(G)||[],t=0;t<n.length;t++)o=n[t],(i=(c.match(ce(o,e))||[])[0])&&(0<(r=c.substr(0,c.indexOf(i))).length&&f(e).unusedInput.push(r),c=c.slice(c.indexOf(i)+i.length),d+=i.length),j[o]?(i?f(e).empty=!1:f(e).unusedTokens.push(o),a=o,l=e,null!=(s=i)&&p(de,a)&&de[a](s,l._a,l,a)):e._strict&&!i&&f(e).unusedTokens.push(o);f(e).charsLeftOver=u-d,0<c.length&&f(e).unusedInput.push(c),e._a[ve]<=12&&!0===f(e).bigHour&&0<e._a[ve]&&(f(e).bigHour=void 0),f(e).parsedDateParts=e._a.slice(0),f(e).meridiem=e._meridiem,e._a[ve]=function(e,t,i){var n;if(null==i)return t;return null!=e.meridiemHour?e.meridiemHour(t,i):(null!=e.isPM&&((n=e.isPM(i))&&t<12&&(t+=12),n||12!==t||(t=0)),t)}(e._locale,e._a[ve],e._meridiem),pt(e),dt(e)}else Et(e);else wt(e)}function St(e){var t=e._i,i=e._f;return e._locale=e._locale||ut(e._l),null===t||void 0===i&&""===t?m({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),w(t)?new b(dt(t)):(c(t)?e._d=t:a(i)?function(e){var t,i,n,o,r;if(0===e._f.length)return f(e).invalidFormat=!0,e._d=new Date(NaN);for(o=0;o<e._f.length;o++)r=0,t=y({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[o],xt(t),g(t)&&(r+=f(t).charsLeftOver,r+=10*f(t).unusedTokens.length,f(t).score=r,(null==n||r<n)&&(n=r,i=t));u(e,i||t)}(e):i?xt(e):function(e){var t=e._i;r(t)?e._d=new Date(h.now()):c(t)?e._d=new Date(t.valueOf()):"string"==typeof t?function(e){var t=bt.exec(e._i);null===t?(wt(e),!1===e._isValid&&(delete e._isValid,Et(e),!1===e._isValid&&(delete e._isValid,h.createFromInputFallback(e)))):e._d=new Date(+t[1])}(e):a(t)?(e._a=n(t.slice(0),function(e){return parseInt(e,10)}),pt(e)):s(t)?function(e){if(!e._d){var t=M(e._i);e._a=n([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),pt(e)}}(e):l(t)?e._d=new Date(t):h.createFromInputFallback(e)}(e),g(e)||(e._d=null),e))}function Tt(e,t,i,n,o){var r={};return!0!==i&&!1!==i||(n=i,i=void 0),(s(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)||a(e)&&0===e.length)&&(e=void 0),r._isAMomentObject=!0,r._useUTC=r._isUTC=o,r._l=i,r._i=e,r._f=t,r._strict=n,function(e){var t=new b(dt(St(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}(r)}function Dt(e,t,i,n){return Tt(e,t,i,n,!1)}h.createFromInputFallback=i("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),h.ISO_8601=function(){},h.RFC_2822=function(){};var kt=i("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Dt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:m()}),Rt=i("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Dt.apply(null,arguments);return this.isValid()&&e.isValid()?this<e?this:e:m()});function Ot(e,t){var i,n;if(1===t.length&&a(t[0])&&(t=t[0]),!t.length)return Dt();for(i=t[0],n=1;n<t.length;++n)t[n].isValid()&&!t[n][e](i)||(i=t[n]);return i}var Nt=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Ft(e){var t=M(e),i=t.year||0,n=t.quarter||0,o=t.month||0,r=t.week||t.isoWeek||0,a=t.day||0,s=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===xe.call(Nt,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var i=!1,n=0;n<Nt.length;++n)if(e[Nt[n]]){if(i)return!1;parseFloat(e[Nt[n]])!==_(e[Nt[n]])&&(i=!0)}return!0}(t),this._milliseconds=+u+1e3*c+6e4*l+1e3*s*60*60,this._days=+a+7*r,this._months=+o+3*n+12*i,this._data={},this._locale=ut(),this._bubble()}function Mt(e){return e instanceof Ft}function Pt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function It(e,i){W(e,0,0,function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+L(~~(e/60),2)+i+L(~~e%60,2)})}It("Z",":"),It("ZZ",""),le("Z",re),le("ZZ",re),he(["Z","ZZ"],function(e,t,i){i._useUTC=!0,i._tzm=Gt(re,e)});var Lt=/([\+\-]|\d\d)/gi;function Gt(e,t){var i=(t||"").match(e);if(null===i)return null;var n=((i[i.length-1]||[])+"").match(Lt)||["-",0,0],o=60*n[1]+_(n[2]);return 0===o?0:"+"===n[0]?o:-o}function $t(e,t){var i,n;return t._isUTC?(i=t.clone(),n=(w(e)||c(e)?e.valueOf():Dt(e).valueOf())-i.valueOf(),i._d.setTime(i._d.valueOf()+n),h.updateOffset(i,!1),i):Dt(e).local()}function Bt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function jt(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}h.updateOffset=function(){};var Wt=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Ht=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function zt(e,t){var i,n,o,r=e,a=null;return Mt(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:l(e)?(r={},t?r[t]=e:r.milliseconds=e):(a=Wt.exec(e))?(i="-"===a[1]?-1:1,r={y:0,d:_(a[me])*i,h:_(a[ve])*i,m:_(a[ye])*i,s:_(a[be])*i,ms:_(Pt(1e3*a[we]))*i}):(a=Ht.exec(e))?(i="-"===a[1]?-1:1,r={y:Vt(a[2],i),M:Vt(a[3],i),w:Vt(a[4],i),d:Vt(a[5],i),h:Vt(a[6],i),m:Vt(a[7],i),s:Vt(a[8],i)}):null==r?r={}:"object"==typeof r&&("from"in r||"to"in r)&&(o=function(e,t){var i;if(!e.isValid()||!t.isValid())return{milliseconds:0,months:0};t=$t(t,e),e.isBefore(t)?i=Ut(e,t):((i=Ut(t,e)).milliseconds=-i.milliseconds,i.months=-i.months);return i}(Dt(r.from),Dt(r.to)),(r={}).ms=o.milliseconds,r.M=o.months),n=new Ft(r),Mt(e)&&p(e,"_locale")&&(n._locale=e._locale),n}function Vt(e,t){var i=e&&parseFloat(e.replace(",","."));return(isNaN(i)?0:i)*t}function Ut(e,t){var i={};return i.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+e.clone().add(i.months,"M"),i}function Yt(n,o){return function(e,t){var i;return null===t||isNaN(+t)||(T(o,"moment()."+o+"(period, number) is deprecated. Please use moment()."+o+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=e,e=t,t=i),qt(this,zt(e="string"==typeof e?+e:e,t),n),this}}function qt(e,t,i,n){var o=t._milliseconds,r=Pt(t._days),a=Pt(t._months);e.isValid()&&(n=null==n||n,a&&Me(e,De(e,"Month")+a*i),r&&ke(e,"Date",De(e,"Date")+r*i),o&&e._d.setTime(e._d.valueOf()+o*i),n&&h.updateOffset(e,r||a))}zt.fn=Ft.prototype,zt.invalid=function(){return zt(NaN)};var Qt=Yt(1,"add"),Kt=Yt(-1,"subtract");function Xt(e,t){var i=12*(t.year()-e.year())+(t.month()-e.month()),n=e.clone().add(i,"months");return-(i+(t-n<0?(t-n)/(n-e.clone().add(i-1,"months")):(t-n)/(e.clone().add(1+i,"months")-n)))||0}function Jt(e){var t;return void 0===e?this._locale._abbr:(null!=(t=ut(e))&&(this._locale=t),this)}h.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",h.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Zt=i("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});function ei(){return this._locale}var ti=126227808e5;function ii(e,t){return(e%t+t)%t}function ni(e,t,i){return e<100&&0<=e?new Date(e+400,t,i)-ti:new Date(e,t,i).valueOf()}function oi(e,t,i){return e<100&&0<=e?Date.UTC(e+400,t,i)-ti:Date.UTC(e,t,i)}function ri(e,t){W(0,[e,e.length],0,t)}function ai(e,t,i,n,o){var r;return null==e?We(this,n,o).year:((r=He(e,n,o))<t&&(t=r),function(e,t,i,n,o){var r=je(e,t,i,n,o),a=$e(r.year,0,r.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}.call(this,e,t,i,n,o))}W(0,["gg",2],0,function(){return this.weekYear()%100}),W(0,["GG",2],0,function(){return this.isoWeekYear()%100}),ri("gggg","weekYear"),ri("ggggg","weekYear"),ri("GGGG","isoWeekYear"),ri("GGGGG","isoWeekYear"),N("weekYear","gg"),N("isoWeekYear","GG"),I("weekYear",1),I("isoWeekYear",1),le("G",ne),le("g",ne),le("GG",K,U),le("gg",K,U),le("GGGG",ee,q),le("gggg",ee,q),le("GGGGG",te,Q),le("ggggg",te,Q),pe(["gggg","ggggg","GGGG","GGGGG"],function(e,t,i,n){t[n.substr(0,2)]=_(e)}),pe(["gg","GG"],function(e,t,i,n){t[n]=h.parseTwoDigitYear(e)}),W("Q",0,"Qo","quarter"),N("quarter","Q"),I("quarter",7),le("Q",V),he("Q",function(e,t){t[ge]=3*(_(e)-1)}),W("D",["DD",2],"Do","date"),N("date","D"),I("date",9),le("D",K),le("DD",K,U),le("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),he(["D","DD"],me),he("Do",function(e,t){t[me]=_(e.match(K)[0])});var si=Te("Date",!0);W("DDD",["DDDD",3],"DDDo","dayOfYear"),N("dayOfYear","DDD"),I("dayOfYear",4),le("DDD",Z),le("DDDD",Y),he(["DDD","DDDD"],function(e,t,i){i._dayOfYear=_(e)}),W("m",["mm",2],0,"minute"),N("minute","m"),I("minute",14),le("m",K),le("mm",K,U),he(["m","mm"],ye);var li=Te("Minutes",!1);W("s",["ss",2],0,"second"),N("second","s"),I("second",15),le("s",K),le("ss",K,U),he(["s","ss"],be);var ci,ui=Te("Seconds",!1);for(W("S",0,0,function(){return~~(this.millisecond()/100)}),W(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),W(0,["SSS",3],0,"millisecond"),W(0,["SSSS",4],0,function(){return 10*this.millisecond()}),W(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),W(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),W(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),W(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),W(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),N("millisecond","ms"),I("millisecond",16),le("S",Z,V),le("SS",Z,U),le("SSS",Z,Y),ci="SSSS";ci.length<=9;ci+="S")le(ci,ie);function di(e,t){t[we]=_(1e3*("0."+e))}for(ci="S";ci.length<=9;ci+="S")he(ci,di);var hi=Te("Milliseconds",!1);W("z",0,0,"zoneAbbr"),W("zz",0,0,"zoneName");var pi=b.prototype;function fi(e){return e}pi.add=Qt,pi.calendar=function(e,t){var i=e||Dt(),n=$t(i,this).startOf("day"),o=h.calendarFormat(this,n)||"sameElse",r=t&&(D(t[o])?t[o].call(this,i):t[o]);return this.format(r||this.localeData().calendar(o,this,Dt(i)))},pi.clone=function(){return new b(this)},pi.diff=function(e,t,i){var n,o,r;if(!this.isValid())return NaN;if(!(n=$t(e,this)).isValid())return NaN;switch(o=6e4*(n.utcOffset()-this.utcOffset()),t=F(t)){case"year":r=Xt(this,n)/12;break;case"month":r=Xt(this,n);break;case"quarter":r=Xt(this,n)/3;break;case"second":r=(this-n)/1e3;break;case"minute":r=(this-n)/6e4;break;case"hour":r=(this-n)/36e5;break;case"day":r=(this-n-o)/864e5;break;case"week":r=(this-n-o)/6048e5;break;default:r=this-n}return i?r:C(r)},pi.endOf=function(e){var t;if(void 0===(e=F(e))||"millisecond"===e||!this.isValid())return this;var i=this._isUTC?oi:ni;switch(e){case"year":t=i(this.year()+1,0,1)-1;break;case"quarter":t=i(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=i(this.year(),this.month()+1,1)-1;break;case"week":t=i(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=i(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=36e5-ii(t+(this._isUTC?0:6e4*this.utcOffset()),36e5)-1;break;case"minute":t=this._d.valueOf(),t+=6e4-ii(t,6e4)-1;break;case"second":t=this._d.valueOf(),t+=1e3-ii(t,1e3)-1}return this._d.setTime(t),h.updateOffset(this,!0),this},pi.format=function(e){e=e||(this.isUtc()?h.defaultFormatUtc:h.defaultFormat);var t=H(this,e);return this.localeData().postformat(t)},pi.from=function(e,t){return this.isValid()&&(w(e)&&e.isValid()||Dt(e).isValid())?zt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},pi.fromNow=function(e){return this.from(Dt(),e)},pi.to=function(e,t){return this.isValid()&&(w(e)&&e.isValid()||Dt(e).isValid())?zt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},pi.toNow=function(e){return this.to(Dt(),e)},pi.get=function(e){return D(this[e=F(e)])?this[e]():this},pi.invalidAt=function(){return f(this).overflow},pi.isAfter=function(e,t){var i=w(e)?e:Dt(e);return!(!this.isValid()||!i.isValid())&&("millisecond"===(t=F(t)||"millisecond")?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(t).valueOf())},pi.isBefore=function(e,t){var i=w(e)?e:Dt(e);return!(!this.isValid()||!i.isValid())&&("millisecond"===(t=F(t)||"millisecond")?this.valueOf()<i.valueOf():this.clone().endOf(t).valueOf()<i.valueOf())},pi.isBetween=function(e,t,i,n){var o=w(e)?e:Dt(e),r=w(t)?t:Dt(t);return!!(this.isValid()&&o.isValid()&&r.isValid())&&(("("===(n=n||"()")[0]?this.isAfter(o,i):!this.isBefore(o,i))&&(")"===n[1]?this.isBefore(r,i):!this.isAfter(r,i)))},pi.isSame=function(e,t){var i,n=w(e)?e:Dt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=F(t)||"millisecond")?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(t).valueOf()<=i&&i<=this.clone().endOf(t).valueOf()))},pi.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},pi.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},pi.isValid=function(){return g(this)},pi.lang=Zt,pi.locale=Jt,pi.localeData=ei,pi.max=Rt,pi.min=kt,pi.parsingFlags=function(){return u({},f(this))},pi.set=function(e,t){if("object"==typeof e)for(var i=function(e){var t=[];for(var i in e)t.push({unit:i,priority:P[i]});return t.sort(function(e,t){return e.priority-t.priority}),t}(e=M(e)),n=0;n<i.length;n++)this[i[n].unit](e[i[n].unit]);else if(D(this[e=F(e)]))return this[e](t);return this},pi.startOf=function(e){var t;if(void 0===(e=F(e))||"millisecond"===e||!this.isValid())return this;var i=this._isUTC?oi:ni;switch(e){case"year":t=i(this.year(),0,1);break;case"quarter":t=i(this.year(),this.month()-this.month()%3,1);break;case"month":t=i(this.year(),this.month(),1);break;case"week":t=i(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=i(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=ii(t+(this._isUTC?0:6e4*this.utcOffset()),36e5);break;case"minute":t=this._d.valueOf(),t-=ii(t,6e4);break;case"second":t=this._d.valueOf(),t-=ii(t,1e3)}return this._d.setTime(t),h.updateOffset(this,!0),this},pi.subtract=Kt,pi.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]},pi.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}},pi.toDate=function(){return new Date(this.valueOf())},pi.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,i=t?this.clone().utc():this;return i.year()<0||9999<i.year()?H(i,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):D(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",H(i,"Z")):H(i,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},pi.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var i="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o=t+'[")]';return this.format(i+n+"-MM-DD[T]HH:mm:ss.SSS"+o)},pi.toJSON=function(){return this.isValid()?this.toISOString():null},pi.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},pi.unix=function(){return Math.floor(this.valueOf()/1e3)},pi.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},pi.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},pi.year=Se,pi.isLeapYear=function(){return Ee(this.year())},pi.weekYear=function(e){return ai.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},pi.isoWeekYear=function(e){return ai.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},pi.quarter=pi.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},pi.month=Pe,pi.daysInMonth=function(){return Re(this.year(),this.month())},pi.week=pi.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},pi.isoWeek=pi.isoWeeks=function(e){var t=We(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},pi.weeksInYear=function(){var e=this.localeData()._week;return He(this.year(),e.dow,e.doy)},pi.isoWeeksInYear=function(){return He(this.year(),1,4)},pi.date=si,pi.day=pi.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=function(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}(e,this.localeData()),this.add(e-t,"d")):t},pi.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},pi.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null==e)return this.day()||7;var t=function(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}(e,this.localeData());return this.day(this.day()%7?t:t-7)},pi.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},pi.hour=pi.hours=it,pi.minute=pi.minutes=li,pi.second=pi.seconds=ui,pi.millisecond=pi.milliseconds=hi,pi.utcOffset=function(e,t,i){var n,o=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null==e)return this._isUTC?o:Bt(this);if("string"==typeof e){if(null===(e=Gt(re,e)))return this}else Math.abs(e)<16&&!i&&(e*=60);return!this._isUTC&&t&&(n=Bt(this)),this._offset=e,this._isUTC=!0,null!=n&&this.add(n,"m"),o!==e&&(!t||this._changeInProgress?qt(this,zt(e-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,h.updateOffset(this,!0),this._changeInProgress=null)),this},pi.utc=function(e){return this.utcOffset(0,e)},pi.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Bt(this),"m")),this},pi.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Gt(oe,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},pi.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Dt(e).utcOffset():0,(this.utcOffset()-e)%60==0)},pi.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},pi.isLocal=function(){return!!this.isValid()&&!this._isUTC},pi.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},pi.isUtc=jt,pi.isUTC=jt,pi.zoneAbbr=function(){return this._isUTC?"UTC":""},pi.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},pi.dates=i("dates accessor is deprecated. Use date instead.",si),pi.months=i("months accessor is deprecated. Use month instead",Pe),pi.years=i("years accessor is deprecated. Use year instead",Se),pi.zone=i("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}),pi.isDSTShifted=i("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!r(this._isDSTShifted))return this._isDSTShifted;var e={};if(y(e,this),(e=St(e))._a){var t=e._isUTC?d(e._a):Dt(e._a);this._isDSTShifted=this.isValid()&&0<A(e._a,t.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var gi=R.prototype;function mi(e,t,i,n){var o=ut(),r=d().set(n,t);return o[i](r,e)}function vi(e,t,i){if(l(e)&&(t=e,e=void 0),e=e||"",null!=t)return mi(e,t,i,"month");var n,o=[];for(n=0;n<12;n++)o[n]=mi(e,n,i,"month");return o}function yi(e,t,i,n){t=("boolean"==typeof e?l(t)&&(i=t,t=void 0):(t=e,e=!1,l(i=t)&&(i=t,t=void 0)),t||"");var o,r=ut(),a=e?r._week.dow:0;if(null!=i)return mi(t,(i+a)%7,n,"day");var s=[];for(o=0;o<7;o++)s[o]=mi(t,(o+a)%7,n,"day");return s}gi.calendar=function(e,t,i){var n=this._calendar[e]||this._calendar.sameElse;return D(n)?n.call(t,i):n},gi.longDateFormat=function(e){var t=this._longDateFormat[e],i=this._longDateFormat[e.toUpperCase()];return t||!i?t:(this._longDateFormat[e]=i.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])},gi.invalidDate=function(){return this._invalidDate},gi.ordinal=function(e){return this._ordinal.replace("%d",e)},gi.preparse=fi,gi.postformat=fi,gi.relativeTime=function(e,t,i,n){var o=this._relativeTime[i];return D(o)?o(e,t,i,n):o.replace(/%d/i,e)},gi.pastFuture=function(e,t){var i=this._relativeTime[0<e?"future":"past"];return D(i)?i(t):i.replace(/%s/i,t)},gi.set=function(e){var t,i;for(i in e)D(t=e[i])?this[i]=t:this["_"+i]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},gi.months=function(e,t){return e?a(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Oe).test(t)?"format":"standalone"][e.month()]:a(this._months)?this._months:this._months.standalone},gi.monthsShort=function(e,t){return e?a(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Oe.test(t)?"format":"standalone"][e.month()]:a(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},gi.monthsParse=function(e,t,i){var n,o,r;if(this._monthsParseExact)return function(e,t,i){var n,o,r,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)r=d([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(r,"").toLocaleLowerCase();return i?"MMM"===t?-1!==(o=xe.call(this._shortMonthsParse,a))?o:null:-1!==(o=xe.call(this._longMonthsParse,a))?o:null:"MMM"===t?-1!==(o=xe.call(this._shortMonthsParse,a))?o:-1!==(o=xe.call(this._longMonthsParse,a))?o:null:-1!==(o=xe.call(this._longMonthsParse,a))?o:-1!==(o=xe.call(this._shortMonthsParse,a))?o:null}.call(this,e,t,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=d([2e3,n]),i&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),i||this._monthsParse[n]||(r="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(r.replace(".",""),"i")),i&&"MMMM"===t&&this._longMonthsParse[n].test(e))return n;if(i&&"MMM"===t&&this._shortMonthsParse[n].test(e))return n;if(!i&&this._monthsParse[n].test(e))return n}},gi.monthsRegex=function(e){return this._monthsParseExact?(p(this,"_monthsRegex")||Ge.call(this),e?this._monthsStrictRegex:this._monthsRegex):(p(this,"_monthsRegex")||(this._monthsRegex=Le),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},gi.monthsShortRegex=function(e){return this._monthsParseExact?(p(this,"_monthsRegex")||Ge.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(p(this,"_monthsShortRegex")||(this._monthsShortRegex=Ie),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},gi.week=function(e){return We(e,this._week.dow,this._week.doy).week},gi.firstDayOfYear=function(){return this._week.doy},gi.firstDayOfWeek=function(){return this._week.dow},gi.weekdays=function(e,t){var i=a(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?ze(i,this._week.dow):e?i[e.day()]:i},gi.weekdaysMin=function(e){return!0===e?ze(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin},gi.weekdaysShort=function(e){return!0===e?ze(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort},gi.weekdaysParse=function(e,t,i){var n,o,r;if(this._weekdaysParseExact)return function(e,t,i){var n,o,r,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)r=d([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(r,"").toLocaleLowerCase();return i?"dddd"===t?-1!==(o=xe.call(this._weekdaysParse,a))?o:null:"ddd"===t?-1!==(o=xe.call(this._shortWeekdaysParse,a))?o:null:-1!==(o=xe.call(this._minWeekdaysParse,a))?o:null:"dddd"===t?-1!==(o=xe.call(this._weekdaysParse,a))?o:-1!==(o=xe.call(this._shortWeekdaysParse,a))?o:-1!==(o=xe.call(this._minWeekdaysParse,a))?o:null:"ddd"===t?-1!==(o=xe.call(this._shortWeekdaysParse,a))?o:-1!==(o=xe.call(this._weekdaysParse,a))?o:-1!==(o=xe.call(this._minWeekdaysParse,a))?o:null:-1!==(o=xe.call(this._minWeekdaysParse,a))?o:-1!==(o=xe.call(this._weekdaysParse,a))?o:-1!==(o=xe.call(this._shortWeekdaysParse,a))?o:null}.call(this,e,t,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=d([2e3,1]).day(n),i&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(r="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(r.replace(".",""),"i")),i&&"dddd"===t&&this._fullWeekdaysParse[n].test(e))return n;if(i&&"ddd"===t&&this._shortWeekdaysParse[n].test(e))return n;if(i&&"dd"===t&&this._minWeekdaysParse[n].test(e))return n;if(!i&&this._weekdaysParse[n].test(e))return n}},gi.weekdaysRegex=function(e){return this._weekdaysParseExact?(p(this,"_weekdaysRegex")||Xe.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(p(this,"_weekdaysRegex")||(this._weekdaysRegex=qe),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},gi.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(p(this,"_weekdaysRegex")||Xe.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(p(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Qe),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},gi.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(p(this,"_weekdaysRegex")||Xe.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(p(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ke),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},gi.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},gi.meridiem=function(e,t,i){return 11<e?i?"pm":"PM":i?"am":"AM"},lt("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===_(e%100/10)?"th":1==t?"st":2==t?"nd":3==t?"rd":"th")}}),h.lang=i("moment.lang is deprecated. Use moment.locale instead.",lt),h.langData=i("moment.langData is deprecated. Use moment.localeData instead.",ut);var bi=Math.abs;function wi(e,t,i,n){var o=zt(t,i);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function Ci(e){return e<0?Math.floor(e):Math.ceil(e)}function _i(e){return 4800*e/146097}function Ai(e){return 146097*e/4800}function Ei(e){return function(){return this.as(e)}}var xi=Ei("ms"),Si=Ei("s"),Ti=Ei("m"),Di=Ei("h"),ki=Ei("d"),Ri=Ei("w"),Oi=Ei("M"),Ni=Ei("Q"),Fi=Ei("y");function Mi(e){return function(){return this.isValid()?this._data[e]:NaN}}var Pi=Mi("milliseconds"),Ii=Mi("seconds"),Li=Mi("minutes"),Gi=Mi("hours"),$i=Mi("days"),Bi=Mi("months"),ji=Mi("years");var Wi=Math.round,Hi={ss:44,s:45,m:45,h:22,d:26,M:11};var zi=Math.abs;function Vi(e){return(0<e)-(e<0)||+e}function Ui(){if(!this.isValid())return this.localeData().invalidDate();var e,t,i=zi(this._milliseconds)/1e3,n=zi(this._days),o=zi(this._months);t=C((e=C(i/60))/60),i%=60,e%=60;var r=C(o/12),a=o%=12,s=n,l=t,c=e,u=i?i.toFixed(3).replace(/\.?0+$/,""):"",d=this.asSeconds();if(!d)return"P0D";var h=d<0?"-":"",p=Vi(this._months)!==Vi(d)?"-":"",f=Vi(this._days)!==Vi(d)?"-":"",g=Vi(this._milliseconds)!==Vi(d)?"-":"";return h+"P"+(r?p+r+"Y":"")+(a?p+a+"M":"")+(s?f+s+"D":"")+(l||c||u?"T":"")+(l?g+l+"H":"")+(c?g+c+"M":"")+(u?g+u+"S":"")}var Yi=Ft.prototype;return Yi.isValid=function(){return this._isValid},Yi.abs=function(){var e=this._data;return this._milliseconds=bi(this._milliseconds),this._days=bi(this._days),this._months=bi(this._months),e.milliseconds=bi(e.milliseconds),e.seconds=bi(e.seconds),e.minutes=bi(e.minutes),e.hours=bi(e.hours),e.months=bi(e.months),e.years=bi(e.years),this},Yi.add=function(e,t){return wi(this,e,t,1)},Yi.subtract=function(e,t){return wi(this,e,t,-1)},Yi.as=function(e){if(!this.isValid())return NaN;var t,i,n=this._milliseconds;if("month"===(e=F(e))||"quarter"===e||"year"===e)switch(t=this._days+n/864e5,i=this._months+_i(t),e){case"month":return i;case"quarter":return i/3;case"year":return i/12}else switch(t=this._days+Math.round(Ai(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return 24*t+n/36e5;case"minute":return 1440*t+n/6e4;case"second":return 86400*t+n/1e3;case"millisecond":return Math.floor(864e5*t)+n;default:throw new Error("Unknown unit "+e)}},Yi.asMilliseconds=xi,Yi.asSeconds=Si,Yi.asMinutes=Ti,Yi.asHours=Di,Yi.asDays=ki,Yi.asWeeks=Ri,Yi.asMonths=Oi,Yi.asQuarters=Ni,Yi.asYears=Fi,Yi.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*_(this._months/12):NaN},Yi._bubble=function(){var e,t,i,n,o,r=this._milliseconds,a=this._days,s=this._months,l=this._data;return 0<=r&&0<=a&&0<=s||r<=0&&a<=0&&s<=0||(r+=864e5*Ci(Ai(s)+a),s=a=0),l.milliseconds=r%1e3,e=C(r/1e3),l.seconds=e%60,t=C(e/60),l.minutes=t%60,i=C(t/60),l.hours=i%24,s+=o=C(_i(a+=C(i/24))),a-=Ci(Ai(o)),n=C(s/12),s%=12,l.days=a,l.months=s,l.years=n,this},Yi.clone=function(){return zt(this)},Yi.get=function(e){return e=F(e),this.isValid()?this[e+"s"]():NaN},Yi.milliseconds=Pi,Yi.seconds=Ii,Yi.minutes=Li,Yi.hours=Gi,Yi.days=$i,Yi.weeks=function(){return C(this.days()/7)},Yi.months=Bi,Yi.years=ji,Yi.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),i=function(e,t,i){var n=zt(e).abs(),o=Wi(n.as("s")),r=Wi(n.as("m")),a=Wi(n.as("h")),s=Wi(n.as("d")),l=Wi(n.as("M")),c=Wi(n.as("y")),u=o<=Hi.ss&&["s",o]||o<Hi.s&&["ss",o]||r<=1&&["m"]||r<Hi.m&&["mm",r]||a<=1&&["h"]||a<Hi.h&&["hh",a]||s<=1&&["d"]||s<Hi.d&&["dd",s]||l<=1&&["M"]||l<Hi.M&&["MM",l]||c<=1&&["y"]||["yy",c];return u[2]=t,u[3]=0<+e,u[4]=i,function(e,t,i,n,o){return o.relativeTime(t||1,!!i,e,n)}.apply(null,u)}(this,!e,t);return e&&(i=t.pastFuture(+this,i)),t.postformat(i)},Yi.toISOString=Ui,Yi.toString=Ui,Yi.toJSON=Ui,Yi.locale=Jt,Yi.localeData=ei,Yi.toIsoString=i("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Ui),Yi.lang=Zt,W("X",0,0,"unix"),W("x",0,0,"valueOf"),le("x",ne),le("X",/[+-]?\d+(\.\d{1,3})?/),he("X",function(e,t,i){i._d=new Date(1e3*parseFloat(e,10))}),he("x",function(e,t,i){i._d=new Date(_(e))}),h.version="2.24.0",e=Dt,h.fn=pi,h.min=function(){return Ot("isBefore",[].slice.call(arguments,0))},h.max=function(){return Ot("isAfter",[].slice.call(arguments,0))},h.now=function(){return Date.now?Date.now():+new Date},h.utc=d,h.unix=function(e){return Dt(1e3*e)},h.months=function(e,t){return vi(e,t,"months")},h.isDate=c,h.locale=lt,h.invalid=m,h.duration=zt,h.isMoment=w,h.weekdays=function(e,t,i){return yi(e,t,i,"weekdays")},h.parseZone=function(){return Dt.apply(null,arguments).parseZone()},h.localeData=ut,h.isDuration=Mt,h.monthsShort=function(e,t){return vi(e,t,"monthsShort")},h.weekdaysMin=function(e,t,i){return yi(e,t,i,"weekdaysMin")},h.defineLocale=ct,h.updateLocale=function(e,t){if(null!=t){var i,n,o=nt;null!=(n=st(e))&&(o=n._config),(i=new R(t=k(o,t))).parentLocale=ot[e],ot[e]=i,lt(e)}else null!=ot[e]&&(null!=ot[e].parentLocale?ot[e]=ot[e].parentLocale:null!=ot[e]&&delete ot[e]);return ot[e]},h.locales=function(){return x(ot)},h.weekdaysShort=function(e,t,i){return yi(e,t,i,"weekdaysShort")},h.normalizeUnits=F,h.relativeTimeRounding=function(e){return void 0===e?Wi:"function"==typeof e&&(Wi=e,!0)},h.relativeTimeThreshold=function(e,t){return void 0!==Hi[e]&&(void 0===t?Hi[e]:(Hi[e]=t,"s"===e&&(Hi.ss=t-1),!0))},h.calendarFormat=function(e,t){var i=e.diff(t,"days",!0);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"},h.prototype=pi,h.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},h}),function(e,t){"use strict";"object"==typeof module&&module.exports?module.exports=t(require("moment")):"function"==typeof define&&define.amd?define(["moment"],t):t(e.moment)}(this,function(r){"use strict";var t,a={},s={},c={},u={};r&&"string"==typeof r.version||T("Moment Timezone requires Moment.js. See https://momentjs.com/timezone/docs/#/use-it/browser/");var e=r.version.split("."),i=+e[0],n=+e[1];function l(e){return 96<e?e-87:64<e?e-29:e-48}function o(e){var t=0,i=e.split("."),n=i[0],o=i[1]||"",r=1,a=0,s=1;for(45===e.charCodeAt(0)&&(s=-(t=1));t<n.length;t++)a=60*a+l(n.charCodeAt(t));for(t=0;t<o.length;t++)r/=60,a+=l(o.charCodeAt(t))*r;return a*s}function d(e){for(var t=0;t<e.length;t++)e[t]=o(e[t])}function h(e,t){var i,n=[];for(i=0;i<t.length;i++)n[i]=e[t[i]];return n}function p(e){var t=e.split("|"),i=t[2].split(" "),n=t[3].split(""),o=t[4].split(" ");return d(i),d(n),d(o),function(e,t){for(var i=0;i<t;i++)e[i]=Math.round((e[i-1]||0)+6e4*e[i]);e[t-1]=1/0}(o,n.length),{name:t[0],abbrs:h(t[1].split(" "),n),offsets:h(i,n),untils:o,population:0|t[5]}}function f(e){e&&this._set(p(e))}function g(e){var t=e.toTimeString(),i=t.match(/\([a-z ]+\)/i);"GMT"===(i=i&&i[0]?(i=i[0].match(/[A-Z]/g))?i.join(""):void 0:(i=t.match(/[A-Z]{3,5}/g))?i[0]:void 0)&&(i=void 0),this.at=+e,this.abbr=i,this.offset=e.getTimezoneOffset()}function m(e){this.zone=e,this.offsetScore=0,this.abbrScore=0}function v(e,t){for(var i,n;n=6e4*((t.at-e.at)/12e4|0);)(i=new g(new Date(e.at+n))).offset===e.offset?e=i:t=i;return e}function y(e,t){return e.offsetScore!==t.offsetScore?e.offsetScore-t.offsetScore:e.abbrScore!==t.abbrScore?e.abbrScore-t.abbrScore:t.zone.population-e.zone.population}function b(e,t){var i,n;for(d(t),i=0;i<t.length;i++)n=t[i],u[n]=u[n]||{},u[n][e]=!0}function w(){try{var e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(e&&3<e.length){var t=c[C(e)];if(t)return t;T("Moment Timezone found "+e+" from the Intl api, but did not have that data loaded.")}}catch(e){}var i,n,o,r=function(){var e,t,i,n=(new Date).getFullYear()-2,o=new g(new Date(n,0,1)),r=[o];for(i=1;i<48;i++)(t=new g(new Date(n,i,1))).offset!==o.offset&&(e=v(o,t),r.push(e),r.push(new g(new Date(e.at+6e4)))),o=t;for(i=0;i<4;i++)r.push(new g(new Date(n+i,0,1))),r.push(new g(new Date(n+i,6,1)));return r}(),a=r.length,s=function(e){var t,i,n,o=e.length,r={},a=[];for(t=0;t<o;t++)for(i in n=u[e[t].offset]||{})n.hasOwnProperty(i)&&(r[i]=!0);for(t in r)r.hasOwnProperty(t)&&a.push(c[t]);return a}(r),l=[];for(n=0;n<s.length;n++){for(i=new m(A(s[n]),a),o=0;o<a;o++)i.scoreOffsetAt(r[o]);l.push(i)}return l.sort(y),0<l.length?l[0].zone.name:void 0}function C(e){return(e||"").toLowerCase().replace(/\//g,"_")}function _(e){var t,i,n,o;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)o=C(i=(n=e[t].split("|"))[0]),a[o]=e[t],c[o]=i,b(o,n[2].split(" "))}function A(e,t){e=C(e);var i,n=a[e];return n instanceof f?n:"string"==typeof n?(n=new f(n),a[e]=n):s[e]&&t!==A&&(i=A(s[e],A))?((n=a[e]=new f)._set(i),n.name=c[e],n):null}function E(e){var t,i,n,o;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)n=C((i=e[t].split("|"))[0]),o=C(i[1]),s[n]=o,c[n]=i[0],s[o]=n,c[o]=i[1]}function x(e){_(e.zones),E(e.links),D.dataVersion=e.version}function S(e){var t="X"===e._f||"x"===e._f;return!(!e._a||void 0!==e._tzm||t)}function T(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}function D(e){var t=Array.prototype.slice.call(arguments,0,-1),i=arguments[arguments.length-1],n=A(i),o=r.utc.apply(null,t);return n&&!r.isMoment(e)&&S(o)&&o.add(n.parse(o),"minutes"),o.tz(i),o}(i<2||2==i&&n<6)&&T("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+r.version+". See momentjs.com"),f.prototype={_set:function(e){this.name=e.name,this.abbrs=e.abbrs,this.untils=e.untils,this.offsets=e.offsets,this.population=e.population},_index:function(e){var t,i=+e,n=this.untils;for(t=0;t<n.length;t++)if(i<n[t])return t},parse:function(e){var t,i,n,o,r=+e,a=this.offsets,s=this.untils,l=s.length-1;for(o=0;o<l;o++)if(t=a[o],i=a[o+1],n=a[o?o-1:o],t<i&&D.moveAmbiguousForward?t=i:n<t&&D.moveInvalidForward&&(t=n),r<s[o]-6e4*t)return a[o];return a[l]},abbr:function(e){return this.abbrs[this._index(e)]},offset:function(e){return T("zone.offset has been deprecated in favor of zone.utcOffset"),this.offsets[this._index(e)]},utcOffset:function(e){return this.offsets[this._index(e)]}},m.prototype.scoreOffsetAt=function(e){this.offsetScore+=Math.abs(this.zone.utcOffset(e.at)-e.offset),this.zone.abbr(e.at).replace(/[^A-Z]/g,"")!==e.abbr&&this.abbrScore++},D.version="0.5.25",D.dataVersion="",D._zones=a,D._links=s,D._names=c,D.add=_,D.link=E,D.load=x,D.zone=A,D.zoneExists=function e(t){return e.didShowError||(e.didShowError=!0,T("moment.tz.zoneExists('"+t+"') has been deprecated in favor of !moment.tz.zone('"+t+"')")),!!A(t)},D.guess=function(e){return t&&!e||(t=w()),t},D.names=function(){var e,t=[];for(e in c)c.hasOwnProperty(e)&&(a[e]||a[s[e]])&&c[e]&&t.push(c[e]);return t.sort()},D.Zone=f,D.unpack=p,D.unpackBase60=o,D.needsOffset=S,D.moveInvalidForward=!0,D.moveAmbiguousForward=!1;var k,R=r.fn;function O(e){return function(){return this._z?this._z.abbr(this):e.call(this)}}function N(e){return function(){return this._z=null,e.apply(this,arguments)}}r.tz=D,r.defaultZone=null,r.updateOffset=function(e,t){var i,n=r.defaultZone;if(void 0===e._z&&(n&&S(e)&&!e._isUTC&&(e._d=r.utc(e._a)._d,e.utc().add(n.parse(e),"minutes")),e._z=n),e._z)if(i=e._z.utcOffset(e),Math.abs(i)<16&&(i/=60),void 0!==e.utcOffset){var o=e._z;e.utcOffset(-i,t),e._z=o}else e.zone(i,t)},R.tz=function(e,t){if(e){if("string"!=typeof e)throw new Error("Time zone name must be a string, got "+e+" ["+typeof e+"]");return this._z=A(e),this._z?r.updateOffset(this,t):T("Moment Timezone has no data for "+e+". See http://momentjs.com/timezone/docs/#/data-loading/."),this}if(this._z)return this._z.name},R.zoneName=O(R.zoneName),R.zoneAbbr=O(R.zoneAbbr),R.utc=N(R.utc),R.local=N(R.local),R.utcOffset=(k=R.utcOffset,function(){return 0<arguments.length&&(this._z=null),k.apply(this,arguments)}),r.tz.setDefault=function(e){return(i<2||2==i&&n<9)&&T("Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js "+r.version+"."),r.defaultZone=e?A(e):null,r};var F=r.momentProperties;return"[object Array]"===Object.prototype.toString.call(F)?(F.push("_z"),F.push("_a")):F&&(F._z=null),x({version:"2019a",zones:["Africa/Abidjan|GMT|0|0||48e5","Africa/Nairobi|EAT|-30|0||47e5","Africa/Algiers|CET|-10|0||26e5","Africa/Lagos|WAT|-10|0||17e6","Africa/Maputo|CAT|-20|0||26e5","Africa/Cairo|EET EEST|-20 -30|01010|1M2m0 gL0 e10 mn0|15e6","Africa/Casablanca|+00 +01|0 -10|01010101010101010101010101010101|1LHC0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 28M0 e00 2600 e00 28M0 e00 2600 gM0 2600 e00 28M0 e00|32e5","Europe/Paris|CET CEST|-10 -20|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|11e6","Africa/Johannesburg|SAST|-20|0||84e5","Africa/Khartoum|EAT CAT|-30 -20|01|1Usl0|51e5","Africa/Sao_Tome|GMT WAT|0 -10|010|1UQN0 2q00","Africa/Tripoli|EET|-20|0||11e5","Africa/Windhoek|CAT WAT|-20 -10|010101010|1LKo0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0|32e4","America/Adak|HST HDT|a0 90|01010101010101010101010|1Lzo0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|326","America/Anchorage|AKST AKDT|90 80|01010101010101010101010|1Lzn0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|30e4","America/Santo_Domingo|AST|40|0||29e5","America/Fortaleza|-03|30|0||34e5","America/Asuncion|-03 -04|30 40|01010101010101010101010|1LEP0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1ip0|28e5","America/Panama|EST|50|0||15e5","America/Mexico_City|CST CDT|60 50|01010101010101010101010|1LKw0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0|20e6","America/Managua|CST|60|0||22e5","America/La_Paz|-04|40|0||19e5","America/Lima|-05|50|0||11e6","America/Denver|MST MDT|70 60|01010101010101010101010|1Lzl0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|26e5","America/Campo_Grande|-03 -04|30 40|01010101010101010101010|1LqP0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1HB0 FX0 1HB0 FX0 1HB0 IL0 1HB0 FX0 1HB0 IL0 1EN0 FX0 1HB0|77e4","America/Cancun|CST CDT EST|60 50 50|0102|1LKw0 1lb0 Dd0|63e4","America/Caracas|-0430 -04|4u 40|01|1QMT0|29e5","America/Chicago|CST CDT|60 50|01010101010101010101010|1Lzk0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|92e5","America/Chihuahua|MST MDT|70 60|01010101010101010101010|1LKx0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0|81e4","America/Phoenix|MST|70|0||42e5","America/Los_Angeles|PST PDT|80 70|01010101010101010101010|1Lzm0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|15e6","America/New_York|EST EDT|50 40|01010101010101010101010|1Lzj0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e6","America/Fort_Nelson|PST PDT MST|80 70 70|0102|1Lzm0 1zb0 Op0|39e2","America/Halifax|AST ADT|40 30|01010101010101010101010|1Lzi0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|39e4","America/Godthab|-03 -02|30 20|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|17e3","America/Grand_Turk|EST EDT AST|50 40 40|0101210101010101010|1Lzj0 1zb0 Op0 1zb0 5Ip0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e2","America/Havana|CST CDT|50 40|01010101010101010101010|1Lzh0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0|21e5","America/Metlakatla|PST AKST AKDT|80 90 80|012121201212121212121|1PAa0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 uM0 jB0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|14e2","America/Miquelon|-03 -02|30 20|01010101010101010101010|1Lzh0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|61e2","America/Montevideo|-02 -03|20 30|0101|1Lzg0 1o10 11z0|17e5","America/Noronha|-02|20|0||30e2","America/Port-au-Prince|EST EDT|50 40|010101010101010101010|1Lzj0 1zb0 Op0 1zb0 3iN0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e5","Antarctica/Palmer|-03 -04|30 40|01010|1LSP0 Rd0 46n0 Ap0|40","America/Santiago|-03 -04|30 40|010101010101010101010|1LSP0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1zb0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0|62e5","America/Sao_Paulo|-02 -03|20 30|01010101010101010101010|1LqO0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1HB0 FX0 1HB0 FX0 1HB0 IL0 1HB0 FX0 1HB0 IL0 1EN0 FX0 1HB0|20e6","Atlantic/Azores|-01 +00|10 0|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|25e4","America/St_Johns|NST NDT|3u 2u|01010101010101010101010|1Lzhu 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|11e4","Antarctica/Casey|+08 +11|-80 -b0|010|1RWg0 3m10|10","Asia/Bangkok|+07|-70|0||15e6","Pacific/Port_Moresby|+10|-a0|0||25e4","Pacific/Guadalcanal|+11|-b0|0||11e4","Asia/Tashkent|+05|-50|0||23e5","Pacific/Auckland|NZDT NZST|-d0 -c0|01010101010101010101010|1LKe0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00|14e5","Asia/Baghdad|+03|-30|0||66e5","Antarctica/Troll|+00 +02|0 -20|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|40","Asia/Dhaka|+06|-60|0||16e6","Asia/Amman|EET EEST|-20 -30|01010101010101010101010|1LGK0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|25e5","Asia/Kamchatka|+12|-c0|0||18e4","Asia/Baku|+04 +05|-40 -50|01010|1LHA0 1o00 11A0 1o00|27e5","Asia/Barnaul|+07 +06|-70 -60|010|1N7v0 3rd0","Asia/Beirut|EET EEST|-20 -30|01010101010101010101010|1LHy0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0|22e5","Asia/Kuala_Lumpur|+08|-80|0||71e5","Asia/Kolkata|IST|-5u|0||15e6","Asia/Chita|+10 +08 +09|-a0 -80 -90|012|1N7s0 3re0|33e4","Asia/Ulaanbaatar|+08 +09|-80 -90|01010|1O8G0 1cJ0 1cP0 1cJ0|12e5","Asia/Shanghai|CST|-80|0||23e6","Asia/Colombo|+0530|-5u|0||22e5","Asia/Damascus|EET EEST|-20 -30|01010101010101010101010|1LGK0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0|26e5","Asia/Dili|+09|-90|0||19e4","Asia/Dubai|+04|-40|0||39e5","Asia/Famagusta|EET EEST +03|-20 -30 -30|0101012010101010101010|1LHB0 1o00 11A0 1o00 11A0 15U0 2Ks0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00","Asia/Gaza|EET EEST|-20 -30|01010101010101010101010|1LGK0 1nX0 1210 1nz0 1220 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0|18e5","Asia/Hong_Kong|HKT|-80|0||73e5","Asia/Hovd|+07 +08|-70 -80|01010|1O8H0 1cJ0 1cP0 1cJ0|81e3","Asia/Irkutsk|+09 +08|-90 -80|01|1N7t0|60e4","Europe/Istanbul|EET EEST +03|-20 -30 -30|0101012|1LI10 1nA0 11A0 1tA0 U00 15w0|13e6","Asia/Jakarta|WIB|-70|0||31e6","Asia/Jayapura|WIT|-90|0||26e4","Asia/Jerusalem|IST IDT|-20 -30|01010101010101010101010|1LGM0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0|81e4","Asia/Kabul|+0430|-4u|0||46e5","Asia/Karachi|PKT|-50|0||24e6","Asia/Kathmandu|+0545|-5J|0||12e5","Asia/Yakutsk|+10 +09|-a0 -90|01|1N7s0|28e4","Asia/Krasnoyarsk|+08 +07|-80 -70|01|1N7u0|10e5","Asia/Magadan|+12 +10 +11|-c0 -a0 -b0|012|1N7q0 3Cq0|95e3","Asia/Makassar|WITA|-80|0||15e5","Asia/Manila|PST|-80|0||24e6","Europe/Athens|EET EEST|-20 -30|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|35e5","Asia/Novosibirsk|+07 +06|-70 -60|010|1N7v0 4eN0|15e5","Asia/Omsk|+07 +06|-70 -60|01|1N7v0|12e5","Asia/Pyongyang|KST KST|-90 -8u|010|1P4D0 6BA0|29e5","Asia/Qyzylorda|+06 +05|-60 -50|01|1Xei0|73e4","Asia/Rangoon|+0630|-6u|0||48e5","Asia/Sakhalin|+11 +10|-b0 -a0|010|1N7r0 3rd0|58e4","Asia/Seoul|KST|-90|0||23e6","Asia/Srednekolymsk|+12 +11|-c0 -b0|01|1N7q0|35e2","Asia/Tehran|+0330 +0430|-3u -4u|01010101010101010101010|1LEku 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0|14e6","Asia/Tokyo|JST|-90|0||38e6","Asia/Tomsk|+07 +06|-70 -60|010|1N7v0 3Qp0|10e5","Asia/Vladivostok|+11 +10|-b0 -a0|01|1N7r0|60e4","Asia/Yekaterinburg|+06 +05|-60 -50|01|1N7w0|14e5","Europe/Lisbon|WET WEST|0 -10|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|27e5","Atlantic/Cape_Verde|-01|10|0||50e4","Australia/Sydney|AEDT AEST|-b0 -a0|01010101010101010101010|1LKg0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0|40e5","Australia/Adelaide|ACDT ACST|-au -9u|01010101010101010101010|1LKgu 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0|11e5","Australia/Brisbane|AEST|-a0|0||20e5","Australia/Darwin|ACST|-9u|0||12e4","Australia/Eucla|+0845|-8J|0||368","Australia/Lord_Howe|+11 +1030|-b0 -au|01010101010101010101010|1LKf0 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1fzu 1cMu|347","Australia/Perth|AWST|-80|0||18e5","Pacific/Easter|-05 -06|50 60|010101010101010101010|1LSP0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1zb0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0|30e2","Europe/Dublin|GMT IST|0 -10|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|12e5","Etc/GMT-1|+01|-10|0|","Pacific/Fakaofo|+13|-d0|0||483","Pacific/Kiritimati|+14|-e0|0||51e2","Etc/GMT-2|+02|-20|0|","Pacific/Tahiti|-10|a0|0||18e4","Pacific/Niue|-11|b0|0||12e2","Etc/GMT+12|-12|c0|0|","Pacific/Galapagos|-06|60|0||25e3","Etc/GMT+7|-07|70|0|","Pacific/Pitcairn|-08|80|0||56","Pacific/Gambier|-09|90|0||125","Etc/UTC|UTC|0|0|","Europe/Ulyanovsk|+04 +03|-40 -30|010|1N7y0 3rd0|13e5","Europe/London|GMT BST|0 -10|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|10e6","Europe/Chisinau|EET EEST|-20 -30|01010101010101010101010|1LHA0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|67e4","Europe/Kaliningrad|+03 EET|-30 -20|01|1N7z0|44e4","Europe/Kirov|+04 +03|-40 -30|01|1N7y0|48e4","Europe/Moscow|MSK MSK|-40 -30|01|1N7y0|16e6","Europe/Saratov|+04 +03|-40 -30|010|1N7y0 5810","Europe/Simferopol|EET MSK MSK|-20 -40 -30|012|1LHA0 1nW0|33e4","Europe/Volgograd|+04 +03|-40 -30|010|1N7y0 9Jd0|10e5","Pacific/Honolulu|HST|a0|0||37e4","MET|MET MEST|-10 -20|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00","Pacific/Chatham|+1345 +1245|-dJ -cJ|01010101010101010101010|1LKe0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00|600","Pacific/Apia|+14 +13|-e0 -d0|01010101010101010101010|1LKe0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00|37e3","Pacific/Bougainville|+10 +11|-a0 -b0|01|1NwE0|18e4","Pacific/Fiji|+13 +12|-d0 -c0|01010101010101010101010|1Lfp0 1SN0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 s00 1VA0|88e4","Pacific/Guam|ChST|-a0|0||17e4","Pacific/Marquesas|-0930|9u|0||86e2","Pacific/Pago_Pago|SST|b0|0||37e2","Pacific/Norfolk|+1130 +11|-bu -b0|01|1PoCu|25e4","Pacific/Tongatapu|+13 +14|-d0 -e0|010|1S4d0 s00|75e3"],links:["Africa/Abidjan|Africa/Accra","Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Bissau","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Monrovia","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|America/Danmarkshavn","Africa/Abidjan|Atlantic/Reykjavik","Africa/Abidjan|Atlantic/St_Helena","Africa/Abidjan|Etc/GMT","Africa/Abidjan|Etc/GMT+0","Africa/Abidjan|Etc/GMT-0","Africa/Abidjan|Etc/GMT0","Africa/Abidjan|Etc/Greenwich","Africa/Abidjan|GMT","Africa/Abidjan|GMT+0","Africa/Abidjan|GMT-0","Africa/Abidjan|GMT0","Africa/Abidjan|Greenwich","Africa/Abidjan|Iceland","Africa/Algiers|Africa/Tunis","Africa/Cairo|Egypt","Africa/Casablanca|Africa/El_Aaiun","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Lagos|Africa/Bangui","Africa/Lagos|Africa/Brazzaville","Africa/Lagos|Africa/Douala","Africa/Lagos|Africa/Kinshasa","Africa/Lagos|Africa/Libreville","Africa/Lagos|Africa/Luanda","Africa/Lagos|Africa/Malabo","Africa/Lagos|Africa/Ndjamena","Africa/Lagos|Africa/Niamey","Africa/Lagos|Africa/Porto-Novo","Africa/Maputo|Africa/Blantyre","Africa/Maputo|Africa/Bujumbura","Africa/Maputo|Africa/Gaborone","Africa/Maputo|Africa/Harare","Africa/Maputo|Africa/Kigali","Africa/Maputo|Africa/Lubumbashi","Africa/Maputo|Africa/Lusaka","Africa/Nairobi|Africa/Addis_Ababa","Africa/Nairobi|Africa/Asmara","Africa/Nairobi|Africa/Asmera","Africa/Nairobi|Africa/Dar_es_Salaam","Africa/Nairobi|Africa/Djibouti","Africa/Nairobi|Africa/Juba","Africa/Nairobi|Africa/Kampala","Africa/Nairobi|Africa/Mogadishu","Africa/Nairobi|Indian/Antananarivo","Africa/Nairobi|Indian/Comoro","Africa/Nairobi|Indian/Mayotte","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|America/Juneau","America/Anchorage|America/Nome","America/Anchorage|America/Sitka","America/Anchorage|America/Yakutat","America/Anchorage|US/Alaska","America/Campo_Grande|America/Cuiaba","America/Chicago|America/Indiana/Knox","America/Chicago|America/Indiana/Tell_City","America/Chicago|America/Knox_IN","America/Chicago|America/Matamoros","America/Chicago|America/Menominee","America/Chicago|America/North_Dakota/Beulah","America/Chicago|America/North_Dakota/Center","America/Chicago|America/North_Dakota/New_Salem","America/Chicago|America/Rainy_River","America/Chicago|America/Rankin_Inlet","America/Chicago|America/Resolute","America/Chicago|America/Winnipeg","America/Chicago|CST6CDT","America/Chicago|Canada/Central","America/Chicago|US/Central","America/Chicago|US/Indiana-Starke","America/Chihuahua|America/Mazatlan","America/Chihuahua|Mexico/BajaSur","America/Denver|America/Boise","America/Denver|America/Cambridge_Bay","America/Denver|America/Edmonton","America/Denver|America/Inuvik","America/Denver|America/Ojinaga","America/Denver|America/Shiprock","America/Denver|America/Yellowknife","America/Denver|Canada/Mountain","America/Denver|MST7MDT","America/Denver|Navajo","America/Denver|US/Mountain","America/Fortaleza|America/Araguaina","America/Fortaleza|America/Argentina/Buenos_Aires","America/Fortaleza|America/Argentina/Catamarca","America/Fortaleza|America/Argentina/ComodRivadavia","America/Fortaleza|America/Argentina/Cordoba","America/Fortaleza|America/Argentina/Jujuy","America/Fortaleza|America/Argentina/La_Rioja","America/Fortaleza|America/Argentina/Mendoza","America/Fortaleza|America/Argentina/Rio_Gallegos","America/Fortaleza|America/Argentina/Salta","America/Fortaleza|America/Argentina/San_Juan","America/Fortaleza|America/Argentina/San_Luis","America/Fortaleza|America/Argentina/Tucuman","America/Fortaleza|America/Argentina/Ushuaia","America/Fortaleza|America/Bahia","America/Fortaleza|America/Belem","America/Fortaleza|America/Buenos_Aires","America/Fortaleza|America/Catamarca","America/Fortaleza|America/Cayenne","America/Fortaleza|America/Cordoba","America/Fortaleza|America/Jujuy","America/Fortaleza|America/Maceio","America/Fortaleza|America/Mendoza","America/Fortaleza|America/Paramaribo","America/Fortaleza|America/Recife","America/Fortaleza|America/Rosario","America/Fortaleza|America/Santarem","America/Fortaleza|Antarctica/Rothera","America/Fortaleza|Atlantic/Stanley","America/Fortaleza|Etc/GMT+3","America/Halifax|America/Glace_Bay","America/Halifax|America/Goose_Bay","America/Halifax|America/Moncton","America/Halifax|America/Thule","America/Halifax|Atlantic/Bermuda","America/Halifax|Canada/Atlantic","America/Havana|Cuba","America/La_Paz|America/Boa_Vista","America/La_Paz|America/Guyana","America/La_Paz|America/Manaus","America/La_Paz|America/Porto_Velho","America/La_Paz|Brazil/West","America/La_Paz|Etc/GMT+4","America/Lima|America/Bogota","America/Lima|America/Eirunepe","America/Lima|America/Guayaquil","America/Lima|America/Porto_Acre","America/Lima|America/Rio_Branco","America/Lima|Brazil/Acre","America/Lima|Etc/GMT+5","America/Los_Angeles|America/Dawson","America/Los_Angeles|America/Ensenada","America/Los_Angeles|America/Santa_Isabel","America/Los_Angeles|America/Tijuana","America/Los_Angeles|America/Vancouver","America/Los_Angeles|America/Whitehorse","America/Los_Angeles|Canada/Pacific","America/Los_Angeles|Canada/Yukon","America/Los_Angeles|Mexico/BajaNorte","America/Los_Angeles|PST8PDT","America/Los_Angeles|US/Pacific","America/Los_Angeles|US/Pacific-New","America/Managua|America/Belize","America/Managua|America/Costa_Rica","America/Managua|America/El_Salvador","America/Managua|America/Guatemala","America/Managua|America/Regina","America/Managua|America/Swift_Current","America/Managua|America/Tegucigalpa","America/Managua|Canada/Saskatchewan","America/Mexico_City|America/Bahia_Banderas","America/Mexico_City|America/Merida","America/Mexico_City|America/Monterrey","America/Mexico_City|Mexico/General","America/New_York|America/Detroit","America/New_York|America/Fort_Wayne","America/New_York|America/Indiana/Indianapolis","America/New_York|America/Indiana/Marengo","America/New_York|America/Indiana/Petersburg","America/New_York|America/Indiana/Vevay","America/New_York|America/Indiana/Vincennes","America/New_York|America/Indiana/Winamac","America/New_York|America/Indianapolis","America/New_York|America/Iqaluit","America/New_York|America/Kentucky/Louisville","America/New_York|America/Kentucky/Monticello","America/New_York|America/Louisville","America/New_York|America/Montreal","America/New_York|America/Nassau","America/New_York|America/Nipigon","America/New_York|America/Pangnirtung","America/New_York|America/Thunder_Bay","America/New_York|America/Toronto","America/New_York|Canada/Eastern","America/New_York|EST5EDT","America/New_York|US/East-Indiana","America/New_York|US/Eastern","America/New_York|US/Michigan","America/Noronha|Atlantic/South_Georgia","America/Noronha|Brazil/DeNoronha","America/Noronha|Etc/GMT+2","America/Panama|America/Atikokan","America/Panama|America/Cayman","America/Panama|America/Coral_Harbour","America/Panama|America/Jamaica","America/Panama|EST","America/Panama|Jamaica","America/Phoenix|America/Creston","America/Phoenix|America/Dawson_Creek","America/Phoenix|America/Hermosillo","America/Phoenix|MST","America/Phoenix|US/Arizona","America/Santiago|Chile/Continental","America/Santo_Domingo|America/Anguilla","America/Santo_Domingo|America/Antigua","America/Santo_Domingo|America/Aruba","America/Santo_Domingo|America/Barbados","America/Santo_Domingo|America/Blanc-Sablon","America/Santo_Domingo|America/Curacao","America/Santo_Domingo|America/Dominica","America/Santo_Domingo|America/Grenada","America/Santo_Domingo|America/Guadeloupe","America/Santo_Domingo|America/Kralendijk","America/Santo_Domingo|America/Lower_Princes","America/Santo_Domingo|America/Marigot","America/Santo_Domingo|America/Martinique","America/Santo_Domingo|America/Montserrat","America/Santo_Domingo|America/Port_of_Spain","America/Santo_Domingo|America/Puerto_Rico","America/Santo_Domingo|America/St_Barthelemy","America/Santo_Domingo|America/St_Kitts","America/Santo_Domingo|America/St_Lucia","America/Santo_Domingo|America/St_Thomas","America/Santo_Domingo|America/St_Vincent","America/Santo_Domingo|America/Tortola","America/Santo_Domingo|America/Virgin","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","Antarctica/Palmer|America/Punta_Arenas","Asia/Baghdad|Antarctica/Syowa","Asia/Baghdad|Asia/Aden","Asia/Baghdad|Asia/Bahrain","Asia/Baghdad|Asia/Kuwait","Asia/Baghdad|Asia/Qatar","Asia/Baghdad|Asia/Riyadh","Asia/Baghdad|Etc/GMT-3","Asia/Baghdad|Europe/Minsk","Asia/Bangkok|Antarctica/Davis","Asia/Bangkok|Asia/Ho_Chi_Minh","Asia/Bangkok|Asia/Novokuznetsk","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Saigon","Asia/Bangkok|Asia/Vientiane","Asia/Bangkok|Etc/GMT-7","Asia/Bangkok|Indian/Christmas","Asia/Dhaka|Antarctica/Vostok","Asia/Dhaka|Asia/Almaty","Asia/Dhaka|Asia/Bishkek","Asia/Dhaka|Asia/Dacca","Asia/Dhaka|Asia/Kashgar","Asia/Dhaka|Asia/Qostanay","Asia/Dhaka|Asia/Thimbu","Asia/Dhaka|Asia/Thimphu","Asia/Dhaka|Asia/Urumqi","Asia/Dhaka|Etc/GMT-6","Asia/Dhaka|Indian/Chagos","Asia/Dili|Etc/GMT-9","Asia/Dili|Pacific/Palau","Asia/Dubai|Asia/Muscat","Asia/Dubai|Asia/Tbilisi","Asia/Dubai|Asia/Yerevan","Asia/Dubai|Etc/GMT-4","Asia/Dubai|Europe/Samara","Asia/Dubai|Indian/Mahe","Asia/Dubai|Indian/Mauritius","Asia/Dubai|Indian/Reunion","Asia/Gaza|Asia/Hebron","Asia/Hong_Kong|Hongkong","Asia/Jakarta|Asia/Pontianak","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kamchatka|Asia/Anadyr","Asia/Kamchatka|Etc/GMT-12","Asia/Kamchatka|Kwajalein","Asia/Kamchatka|Pacific/Funafuti","Asia/Kamchatka|Pacific/Kwajalein","Asia/Kamchatka|Pacific/Majuro","Asia/Kamchatka|Pacific/Nauru","Asia/Kamchatka|Pacific/Tarawa","Asia/Kamchatka|Pacific/Wake","Asia/Kamchatka|Pacific/Wallis","Asia/Kathmandu|Asia/Katmandu","Asia/Kolkata|Asia/Calcutta","Asia/Kuala_Lumpur|Asia/Brunei","Asia/Kuala_Lumpur|Asia/Kuching","Asia/Kuala_Lumpur|Asia/Singapore","Asia/Kuala_Lumpur|Etc/GMT-8","Asia/Kuala_Lumpur|Singapore","Asia/Makassar|Asia/Ujung_Pandang","Asia/Rangoon|Asia/Yangon","Asia/Rangoon|Indian/Cocos","Asia/Seoul|ROK","Asia/Shanghai|Asia/Chongqing","Asia/Shanghai|Asia/Chungking","Asia/Shanghai|Asia/Harbin","Asia/Shanghai|Asia/Macao","Asia/Shanghai|Asia/Macau","Asia/Shanghai|Asia/Taipei","Asia/Shanghai|PRC","Asia/Shanghai|ROC","Asia/Tashkent|Antarctica/Mawson","Asia/Tashkent|Asia/Aqtau","Asia/Tashkent|Asia/Aqtobe","Asia/Tashkent|Asia/Ashgabat","Asia/Tashkent|Asia/Ashkhabad","Asia/Tashkent|Asia/Atyrau","Asia/Tashkent|Asia/Dushanbe","Asia/Tashkent|Asia/Oral","Asia/Tashkent|Asia/Samarkand","Asia/Tashkent|Etc/GMT-5","Asia/Tashkent|Indian/Kerguelen","Asia/Tashkent|Indian/Maldives","Asia/Tehran|Iran","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Choibalsan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Asia/Vladivostok|Asia/Ust-Nera","Asia/Yakutsk|Asia/Khandyga","Atlantic/Azores|America/Scoresbysund","Atlantic/Cape_Verde|Etc/GMT+1","Australia/Adelaide|Australia/Broken_Hill","Australia/Adelaide|Australia/South","Australia/Adelaide|Australia/Yancowinna","Australia/Brisbane|Australia/Lindeman","Australia/Brisbane|Australia/Queensland","Australia/Darwin|Australia/North","Australia/Lord_Howe|Australia/LHI","Australia/Perth|Australia/West","Australia/Sydney|Australia/ACT","Australia/Sydney|Australia/Canberra","Australia/Sydney|Australia/Currie","Australia/Sydney|Australia/Hobart","Australia/Sydney|Australia/Melbourne","Australia/Sydney|Australia/NSW","Australia/Sydney|Australia/Tasmania","Australia/Sydney|Australia/Victoria","Etc/UTC|Etc/UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UCT","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Athens|Asia/Nicosia","Europe/Athens|EET","Europe/Athens|Europe/Bucharest","Europe/Athens|Europe/Helsinki","Europe/Athens|Europe/Kiev","Europe/Athens|Europe/Mariehamn","Europe/Athens|Europe/Nicosia","Europe/Athens|Europe/Riga","Europe/Athens|Europe/Sofia","Europe/Athens|Europe/Tallinn","Europe/Athens|Europe/Uzhgorod","Europe/Athens|Europe/Vilnius","Europe/Athens|Europe/Zaporozhye","Europe/Chisinau|Europe/Tiraspol","Europe/Dublin|Eire","Europe/Istanbul|Asia/Istanbul","Europe/Istanbul|Turkey","Europe/Lisbon|Atlantic/Canary","Europe/Lisbon|Atlantic/Faeroe","Europe/Lisbon|Atlantic/Faroe","Europe/Lisbon|Atlantic/Madeira","Europe/Lisbon|Portugal","Europe/Lisbon|WET","Europe/London|Europe/Belfast","Europe/London|Europe/Guernsey","Europe/London|Europe/Isle_of_Man","Europe/London|Europe/Jersey","Europe/London|GB","Europe/London|GB-Eire","Europe/Moscow|W-SU","Europe/Paris|Africa/Ceuta","Europe/Paris|Arctic/Longyearbyen","Europe/Paris|Atlantic/Jan_Mayen","Europe/Paris|CET","Europe/Paris|Europe/Amsterdam","Europe/Paris|Europe/Andorra","Europe/Paris|Europe/Belgrade","Europe/Paris|Europe/Berlin","Europe/Paris|Europe/Bratislava","Europe/Paris|Europe/Brussels","Europe/Paris|Europe/Budapest","Europe/Paris|Europe/Busingen","Europe/Paris|Europe/Copenhagen","Europe/Paris|Europe/Gibraltar","Europe/Paris|Europe/Ljubljana","Europe/Paris|Europe/Luxembourg","Europe/Paris|Europe/Madrid","Europe/Paris|Europe/Malta","Europe/Paris|Europe/Monaco","Europe/Paris|Europe/Oslo","Europe/Paris|Europe/Podgorica","Europe/Paris|Europe/Prague","Europe/Paris|Europe/Rome","Europe/Paris|Europe/San_Marino","Europe/Paris|Europe/Sarajevo","Europe/Paris|Europe/Skopje","Europe/Paris|Europe/Stockholm","Europe/Paris|Europe/Tirane","Europe/Paris|Europe/Vaduz","Europe/Paris|Europe/Vatican","Europe/Paris|Europe/Vienna","Europe/Paris|Europe/Warsaw","Europe/Paris|Europe/Zagreb","Europe/Paris|Europe/Zurich","Europe/Paris|Poland","Europe/Ulyanovsk|Europe/Astrakhan","Pacific/Auckland|Antarctica/McMurdo","Pacific/Auckland|Antarctica/South_Pole","Pacific/Auckland|NZ","Pacific/Chatham|NZ-CHAT","Pacific/Easter|Chile/EasterIsland","Pacific/Fakaofo|Etc/GMT-13","Pacific/Fakaofo|Pacific/Enderbury","Pacific/Galapagos|Etc/GMT+6","Pacific/Gambier|Etc/GMT+9","Pacific/Guadalcanal|Antarctica/Macquarie","Pacific/Guadalcanal|Etc/GMT-11","Pacific/Guadalcanal|Pacific/Efate","Pacific/Guadalcanal|Pacific/Kosrae","Pacific/Guadalcanal|Pacific/Noumea","Pacific/Guadalcanal|Pacific/Pohnpei","Pacific/Guadalcanal|Pacific/Ponape","Pacific/Guam|Pacific/Saipan","Pacific/Honolulu|HST","Pacific/Honolulu|Pacific/Johnston","Pacific/Honolulu|US/Hawaii","Pacific/Kiritimati|Etc/GMT-14","Pacific/Niue|Etc/GMT+11","Pacific/Pago_Pago|Pacific/Midway","Pacific/Pago_Pago|Pacific/Samoa","Pacific/Pago_Pago|US/Samoa","Pacific/Pitcairn|Etc/GMT+8","Pacific/Port_Moresby|Antarctica/DumontDUrville","Pacific/Port_Moresby|Etc/GMT-10","Pacific/Port_Moresby|Pacific/Chuuk","Pacific/Port_Moresby|Pacific/Truk","Pacific/Port_Moresby|Pacific/Yap","Pacific/Tahiti|Etc/GMT+10","Pacific/Tahiti|Pacific/Rarotonga"]}),r}),function(e){"function"==typeof define&&define.amd?define("picker",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):this.Picker=e(jQuery)}(function(g){var n=g(window),m=g(document),v=g(document.documentElement),y=null!=document.documentElement.style.transition;function b(n,e,t,i){if(!n)return b;function o(){return this.start()}var r=!1,s={id:n.id||"P"+Math.abs(~~(Math.random()*new Date))},l=t?g.extend(!0,{},t.defaults,i):i||{},a=g.extend({},b.klasses(),l.klass),c=g(n),u=o.prototype={constructor:o,$node:c,start:function(){return s&&s.start?u:(s.methods={},s.start=!0,s.open=!1,s.type=n.type,n.autofocus=n==_(),n.readOnly=!l.editable,n.id=n.id||s.id,"text"!=n.type&&(n.type="text"),u.component=new t(u,l),u.$root=g('<div class="'+a.picker+'" id="'+n.id+'_root" />'),C(u.$root[0],"hidden",!0),u.$holder=g(d()).appendTo(u.$root),h(),l.formatSubmit&&function(){var e;!0===l.hiddenName?(e=n.name,n.name=""):e=(e=["string"==typeof l.hiddenPrefix?l.hiddenPrefix:"","string"==typeof l.hiddenSuffix?l.hiddenSuffix:"_submit"])[0]+n.name+e[1];u._hidden=g('<input type=hidden name="'+e+'"'+(c.data("value")||n.value?' value="'+u.get("select",l.formatSubmit)+'"':"")+">")[0],c.on("change."+s.id,function(){u._hidden.value=n.value?u.get("select",l.formatSubmit):""})}(),function(){c.data(e,u).addClass(a.input).val(c.data("value")?u.get("select",l.format):n.value),l.editable||c.on("focus."+s.id+" click."+s.id,function(e){e.preventDefault(),u.open()}).on("keydown."+s.id,f);C(n,{haspopup:!0,expanded:!1,readonly:!1,owns:n.id+"_root"})}(),l.containerHidden?g(l.containerHidden).append(u._hidden):c.after(u._hidden),l.container?g(l.container).append(u.$root):c.after(u.$root),u.on({start:u.component.onStart,render:u.component.onRender,stop:u.component.onStop,open:u.component.onOpen,close:u.component.onClose,set:u.component.onSet}).on({start:l.onStart,render:l.onRender,stop:l.onStop,open:l.onOpen,close:l.onClose,set:l.onSet}),r=function(e){var t;e.currentStyle?t=e.currentStyle.position:window.getComputedStyle&&(t=getComputedStyle(e).position);return"fixed"==t}(u.$holder[0]),n.autofocus&&u.open(),u.trigger("start").trigger("render"))},render:function(e){return e?(u.$holder=g(d()),h(),u.$root.html(u.$holder)):u.$root.find("."+a.box).html(u.component.nodes(s.open)),u.trigger("render")},stop:function(){return s.start&&(u.close(),u._hidden&&u._hidden.parentNode.removeChild(u._hidden),u.$root.remove(),c.removeClass(a.input).removeData(e),setTimeout(function(){c.off("."+s.id)},0),n.type=s.type,n.readOnly=!1,u.trigger("stop"),s.methods={},s.start=!1),u},open:function(e){return s.open?u:(c.addClass(a.active),C(n,"expanded",!0),setTimeout(function(){u.$root.addClass(a.opened),C(u.$root[0],"hidden",!1)},0),!1!==e&&(s.open=!0,r&&v.css("overflow","hidden").css("padding-right","+="+w()),r&&y?u.$holder.find("."+a.frame).one("transitionend",function(){u.$holder[0].focus()}):u.$holder[0].focus(),m.on("click."+s.id+" focusin."+s.id,function(e){var t=e.target;t!=n&&t!=document&&3!=e.which&&u.close(t===u.$holder[0])}).on("keydown."+s.id,function(e){var t=e.keyCode,i=u.component.key[t],n=e.target;27==t?u.close(!0):n!=u.$holder[0]||!i&&13!=t?g.contains(u.$root[0],n)&&13==t&&(e.preventDefault(),n.click()):(e.preventDefault(),i?b._.trigger(u.component.key.go,u,[b._.trigger(i)]):u.$root.find("."+a.highlighted).hasClass(a.disabled)||(u.set("select",u.component.item.highlight),l.closeOnSelect&&u.close(!0)))})),u.trigger("open"))},close:function(e){return e&&(l.editable?n.focus():(u.$holder.off("focus.toOpen").focus(),setTimeout(function(){u.$holder.on("focus.toOpen",p)},0))),c.removeClass(a.active),C(n,"expanded",!1),setTimeout(function(){u.$root.removeClass(a.opened+" "+a.focused),C(u.$root[0],"hidden",!0)},0),s.open?(s.open=!1,r&&v.css("overflow","").css("padding-right","-="+w()),m.off("."+s.id),u.trigger("close")):u},clear:function(e){return u.set("clear",null,e)},set:function(e,t,i){var n,o,r=g.isPlainObject(e),a=r?e:{};if(i=r&&g.isPlainObject(t)?t:i||{},e){for(n in r||(a[e]=t),a)o=a[n],n in u.component.item&&(void 0===o&&(o=null),u.component.set(n,o,i)),"select"!=n&&"clear"!=n||c.val("clear"==n?"":u.get(n,l.format)).trigger("change");u.render()}return i.muted?u:u.trigger("set",a)},get:function(e,t){if(null!=s[e=e||"value"])return s[e];if("valueSubmit"==e){if(u._hidden)return u._hidden.value;e="value"}if("value"==e)return n.value;if(e in u.component.item){if("string"!=typeof t)return u.component.get(e);var i=u.component.get(e);return i?b._.trigger(u.component.formats.toString,u.component,[t,i]):""}},on:function(e,t,i){var n,o,r=g.isPlainObject(e),a=r?e:{};if(e)for(n in r||(a[e]=t),a)o=a[n],i&&(n="_"+n),s.methods[n]=s.methods[n]||[],s.methods[n].push(o);return u},off:function(){var e,t,i=arguments;for(e=0,namesCount=i.length;e<namesCount;e+=1)(t=i[e])in s.methods&&delete s.methods[t];return u},trigger:function(e,i){function t(e){var t=s.methods[e];t&&t.map(function(e){b._.trigger(e,u,[i])})}return t("_"+e),t(e),u}};function d(){return b._.node("div",b._.node("div",b._.node("div",b._.node("div",u.component.nodes(s.open),a.box),a.wrap),a.frame),a.holder,'tabindex="-1"')}function h(){u.$holder.on({keydown:f,"focus.toOpen":p,blur:function(){c.removeClass(a.target)},focusin:function(e){u.$root.removeClass(a.focused),e.stopPropagation()},"mousedown click":function(e){var t=e.target;t!=u.$holder[0]&&(e.stopPropagation(),"mousedown"!=e.type||g(t).is("input, select, textarea, button, option")||(e.preventDefault(),u.$holder[0].focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var e=g(this),t=e.data(),i=e.hasClass(a.navDisabled)||e.hasClass(a.disabled),n=_();n=n&&(n.type||n.href),(i||n&&!g.contains(u.$root[0],n))&&u.$holder[0].focus(),!i&&t.nav?u.set("highlight",u.component.item.highlight,{nav:t.nav}):!i&&"pick"in t?(u.set("select",t.pick),l.closeOnSelect&&u.close(!0)):t.clear?(u.clear(),l.closeOnClear&&u.close(!0)):t.close&&u.close(!0)})}function p(e){e.stopPropagation(),c.addClass(a.target),u.$root.addClass(a.focused),u.open()}function f(e){var t=e.keyCode,i=/^(8|46)$/.test(t);if(27==t)return u.close(!0),!1;(32==t||i||!s.open&&u.component.key[t])&&(e.preventDefault(),e.stopPropagation(),i?u.clear().close():u.open())}return new o}function w(){if(v.height()<=n.height())return 0;var e=g('<div style="visibility:hidden;width:100px" />').appendTo("body"),t=e[0].offsetWidth;e.css("overflow","scroll");var i=g('<div style="width:100%" />').appendTo(e)[0].offsetWidth;return e.remove(),t-i}function C(e,t,i){if(g.isPlainObject(t))for(var n in t)o(e,n,t[n]);else o(e,t,i)}function o(e,t,i){e.setAttribute(("role"==t?"":"aria-")+t,i)}function _(){try{return document.activeElement}catch(e){}}return b.klasses=function(e){return{picker:e=e||"picker",opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",target:e+"__input--target",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},b._={group:function(e){for(var t,i="",n=b._.trigger(e.min,e);n<=b._.trigger(e.max,e,[n]);n+=e.i)t=b._.trigger(e.item,e,[n]),i+=b._.node(e.node,t[0],t[1],t[2]);return i},node:function(e,t,i,n){return t?"<"+e+(i=i?' class="'+i+'"':"")+(n=n?" "+n:"")+">"+(t=g.isArray(t)?t.join(""):t)+"</"+e+">":""},lead:function(e){return(e<10?"0":"")+e},trigger:function(e,t,i){return"function"==typeof e?e.apply(t,i||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return-1<{}.toString.call(e).indexOf("Date")&&this.isInteger(e.getDate())},isInteger:function(e){return-1<{}.toString.call(e).indexOf("Number")&&e%1==0},ariaAttr:function(e,t){g.isPlainObject(e)||(e={attribute:t});for(var i in t="",e){var n=("role"==i?"":"aria-")+i,o=e[i];t+=null==o?"":n+'="'+e[i]+'"'}return t}},b.extend=function(n,o){g.fn[n]=function(e,t){var i=this.data(n);return"picker"==e?i:i&&"string"==typeof e?b._.trigger(i[e],i,[t]):this.each(function(){g(this).data(n)||new b(this,n,o,e)})},g.fn[n].defaults=o.defaults},b}),function(e){"function"==typeof define&&define.amd?define(["picker","jquery"],e):"object"==typeof exports?module.exports=e(require("./picker.js"),require("jquery")):e(Picker,jQuery)}(function(e,f){var t,v=e._;function i(t,i){function e(){return r.currentStyle?"rtl"==r.currentStyle.direction:"rtl"==getComputedStyle(t.$root[0]).direction}var n,o=this,r=t.$node[0],a=r.value,s=t.$node.data("value"),l=s||a,c=s?i.formatSubmit:i.format;o.settings=i,o.$node=t.$node,o.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},o.item={},o.item.clear=null,o.item.disable=(i.disable||[]).slice(0),o.item.enable=-(!0===(n=o.item.disable)[0]?n.shift():-1),o.set("min",i.min).set("max",i.max).set("now"),l?o.set("select",l,{format:c,defaultValue:!0}):o.set("select",null).set("highlight",o.item.now),o.key={40:7,38:-7,39:function(){return e()?-1:1},37:function(){return e()?1:-1},go:function(e){var t=o.item.highlight,i=new Date(t.year,t.month,t.date+e);o.set("highlight",i,{interval:e}),this.render()}},t.on("render",function(){t.$root.find("."+i.klass.selectMonth).on("change",function(){var e=this.value;e&&(t.set("highlight",[t.get("view").year,e,t.get("highlight").date]),t.$root.find("."+i.klass.selectMonth).trigger("focus"))}),t.$root.find("."+i.klass.selectYear).on("change",function(){var e=this.value;e&&(t.set("highlight",[e,t.get("view").month,t.get("highlight").date]),t.$root.find("."+i.klass.selectYear).trigger("focus"))})},1).on("open",function(){var e="";o.disabled(o.get("now"))&&(e=":not(."+i.klass.buttonToday+")"),t.$root.find("button"+e+", select").attr("disabled",!1)},1).on("close",function(){t.$root.find("button, select").attr("disabled",!0)},1)}function n(e,t,i){var n=e.match(/[^\x00-\x7F]+|\w+/)[0];return i.mm||i.m||(i.m=t.indexOf(n)+1),n.length}function o(e){return e.match(/\w+/)[0].length}i.prototype.set=function(t,i,n){var o=this,e=o.item;return null===i?("clear"==t&&(t="select"),e[t]=i):(e["enable"==t?"disable":"flip"==t?"enable":t]=o.queue[t].split(" ").map(function(e){return i=o[e](t,i,n)}).pop(),"select"==t?o.set("highlight",e.select,n):"highlight"==t?o.set("view",e.highlight,n):t.match(/^(flip|min|max|disable|enable)$/)&&(e.select&&o.disabled(e.select)&&o.set("select",e.select,n),e.highlight&&o.disabled(e.highlight)&&o.set("highlight",e.highlight,n))),o},i.prototype.get=function(e){return this.item[e]},i.prototype.create=function(e,t,i){var n;return(t=void 0===t?e:t)==-1/0||t==1/0?n=t:t=f.isPlainObject(t)&&v.isInteger(t.pick)?t.obj:f.isArray(t)?(t=new Date(t[0],t[1],t[2]),v.isDate(t)?t:this.create().obj):v.isInteger(t)||v.isDate(t)?this.normalize(new Date(t),i):this.now(e,t,i),{year:n||t.getFullYear(),month:n||t.getMonth(),date:n||t.getDate(),day:n||t.getDay(),obj:n||t,pick:n||t.getTime()}},i.prototype.createRange=function(e,t){function i(e){return!0===e||f.isArray(e)||v.isDate(e)?n.create(e):e}var n=this;return v.isInteger(e)||(e=i(e)),v.isInteger(t)||(t=i(t)),v.isInteger(e)&&f.isPlainObject(t)?e=[t.year,t.month,t.date+e]:v.isInteger(t)&&f.isPlainObject(e)&&(t=[e.year,e.month,e.date+t]),{from:i(e),to:i(t)}},i.prototype.withinRange=function(e,t){return e=this.createRange(e.from,e.to),t.pick>=e.from.pick&&t.pick<=e.to.pick},i.prototype.overlapRanges=function(e,t){return e=this.createRange(e.from,e.to),t=this.createRange(t.from,t.to),this.withinRange(e,t.from)||this.withinRange(e,t.to)||this.withinRange(t,e.from)||this.withinRange(t,e.to)},i.prototype.now=function(e,t,i){return t=new Date,i&&i.rel&&t.setDate(t.getDate()+i.rel),this.normalize(t,i)},i.prototype.navigate=function(e,t,i){var n,o,r,a,s=f.isArray(t),l=f.isPlainObject(t),c=this.item.view;if(s||l){for(a=l?(o=t.year,r=t.month,t.date):(o=+t[0],r=+t[1],+t[2]),i&&i.nav&&c&&c.month!==r&&(o=c.year,r=c.month),o=(n=new Date(o,r+(i&&i.nav?i.nav:0),1)).getFullYear(),r=n.getMonth();new Date(o,r,a).getMonth()!==r;)a-=1;t=[o,r,a]}return t},i.prototype.normalize=function(e){return e.setHours(0,0,0,0),e},i.prototype.measure=function(e,t){return t?"string"==typeof t?t=this.parse(e,t):v.isInteger(t)&&(t=this.now(e,t,{rel:t})):t="min"==e?-1/0:1/0,t},i.prototype.viewset=function(e,t){return this.create([t.year,t.month,1])},i.prototype.validate=function(e,i,t){var n,o,r,a,s=this,l=i,c=t&&t.interval?t.interval:1,u=-1===s.item.enable,d=s.item.min,h=s.item.max,p=u&&s.item.disable.filter(function(e){if(f.isArray(e)){var t=s.create(e).pick;t<i.pick?n=!0:t>i.pick&&(o=!0)}return v.isInteger(e)}).length;if((!t||!t.nav&&!t.defaultValue)&&(!u&&s.disabled(i)||u&&s.disabled(i)&&(p||n||o)||!u&&(i.pick<=d.pick||i.pick>=h.pick)))for(u&&!p&&(!o&&0<c||!n&&c<0)&&(c*=-1);s.disabled(i)&&(1<Math.abs(c)&&(i.month<l.month||i.month>l.month)&&(i=l,c=0<c?1:-1),i.pick<=d.pick?(r=!0,c=1,i=s.create([d.year,d.month,d.date+(i.pick===d.pick?0:-1)])):i.pick>=h.pick&&(a=!0,c=-1,i=s.create([h.year,h.month,h.date+(i.pick===h.pick?0:1)])),!r||!a);)i=s.create([i.year,i.month,i.date+c]);return i},i.prototype.disabled=function(t){var i=this,e=i.item.disable.filter(function(e){return v.isInteger(e)?t.day===(i.settings.firstDay?e:e-1)%7:f.isArray(e)||v.isDate(e)?t.pick===i.create(e).pick:f.isPlainObject(e)?i.withinRange(e,t):void 0});return e=e.length&&!e.filter(function(e){return f.isArray(e)&&"inverted"==e[3]||f.isPlainObject(e)&&e.inverted}).length,-1===i.item.enable?!e:e||t.pick<i.item.min.pick||t.pick>i.item.max.pick},i.prototype.parse=function(e,n,t){var o=this,r={};return n&&"string"==typeof n?(t&&t.format||((t=t||{}).format=o.settings.format),o.formats.toArray(t.format).map(function(e){var t=o.formats[e],i=t?v.trigger(t,o,[n,r]):e.replace(/^!/,"").length;t&&(r[e]=n.substr(0,i)),n=n.substr(i)}),[r.yyyy||r.yy,+(r.mm||r.m)-1,r.dd||r.d]):n},i.prototype.formats={d:function(e,t){return e?v.digits(e):t.date},dd:function(e,t){return e?2:v.lead(t.date)},ddd:function(e,t){return e?o(e):this.settings.weekdaysShort[t.day]},dddd:function(e,t){return e?o(e):this.settings.weekdaysFull[t.day]},m:function(e,t){return e?v.digits(e):t.month+1},mm:function(e,t){return e?2:v.lead(t.month+1)},mmm:function(e,t){var i=this.settings.monthsShort;return e?n(e,i,t):i[t.month]},mmmm:function(e,t){var i=this.settings.monthsFull;return e?n(e,i,t):i[t.month]},yy:function(e,t){return e?2:(""+t.year).slice(2)},yyyy:function(e,t){return e?4:t.year},toArray:function(e){return e.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(e,t){var i=this;return i.formats.toArray(e).map(function(e){return v.trigger(i.formats[e],i,[0,t])||e.replace(/^!/,"")}).join("")}},i.prototype.isDateExact=function(e,t){return v.isInteger(e)&&v.isInteger(t)||"boolean"==typeof e&&"boolean"==typeof t?e===t:(v.isDate(e)||f.isArray(e))&&(v.isDate(t)||f.isArray(t))?this.create(e).pick===this.create(t).pick:!(!f.isPlainObject(e)||!f.isPlainObject(t))&&(this.isDateExact(e.from,t.from)&&this.isDateExact(e.to,t.to))},i.prototype.isDateOverlap=function(e,t){var i=this.settings.firstDay?1:0;return v.isInteger(e)&&(v.isDate(t)||f.isArray(t))?(e=e%7+i)===this.create(t).day+1:v.isInteger(t)&&(v.isDate(e)||f.isArray(e))?(t=t%7+i)===this.create(e).day+1:!(!f.isPlainObject(e)||!f.isPlainObject(t))&&this.overlapRanges(e,t)},i.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(-1==t.enable?1:-1)},i.prototype.deactivate=function(e,t){var n=this,o=n.item.disable.slice(0);return"flip"==t?n.flipEnable():!1===t?(n.flipEnable(1),o=[]):!0===t?(n.flipEnable(-1),o=[]):t.map(function(e){for(var t,i=0;i<o.length;i+=1)if(n.isDateExact(e,o[i])){t=!0;break}t||(v.isInteger(e)||v.isDate(e)||f.isArray(e)||f.isPlainObject(e)&&e.from&&e.to)&&o.push(e)}),o},i.prototype.activate=function(e,t){var r=this,a=r.item.disable,s=a.length;return"flip"==t?r.flipEnable():!0===t?(r.flipEnable(1),a=[]):!1===t?(r.flipEnable(-1),a=[]):t.map(function(e){var t,i,n,o;for(n=0;n<s;n+=1){if(i=a[n],r.isDateExact(i,e)){t=a[n]=null,o=!0;break}if(r.isDateOverlap(i,e)){f.isPlainObject(e)?(e.inverted=!0,t=e):f.isArray(e)?(t=e)[3]||t.push("inverted"):v.isDate(e)&&(t=[e.getFullYear(),e.getMonth(),e.getDate(),"inverted"]);break}}if(t)for(n=0;n<s;n+=1)if(r.isDateExact(a[n],e)){a[n]=null;break}if(o)for(n=0;n<s;n+=1)if(r.isDateOverlap(a[n],e)){a[n]=null;break}t&&a.push(t)}),a.filter(function(e){return null!=e})},i.prototype.nodes=function(l){function e(e){return v.node("div"," ",u.klass["nav"+(e?"Next":"Prev")]+(e&&h.year>=g.year&&h.month>=g.month||!e&&h.year<=f.year&&h.month<=f.month?" "+u.klass.navDisabled:""),"data-nav="+(e||-1)+" "+v.ariaAttr({role:"button",controls:c.$node[0].id+"_table"})+' title="'+(e?u.labelMonthNext:u.labelMonthPrev)+'"')}function t(){var t=u.showMonthsShort?u.monthsShort:u.monthsFull;return u.selectMonths?v.node("select",v.group({min:0,max:11,i:1,node:"option",item:function(e){return[t[e],0,"value="+e+(h.month==e?" selected":"")+(h.year==f.year&&e<f.month||h.year==g.year&&e>g.month?" disabled":"")]}}),u.klass.selectMonth,(l?"":"disabled")+" "+v.ariaAttr({controls:c.$node[0].id+"_table"})+' title="'+u.labelMonthSelect+'"'):v.node("div",t[h.month],u.klass.month)}function i(){var t=h.year,e=!0===u.selectYears?5:~~(u.selectYears/2);if(e){var i=f.year,n=g.year,o=t-e,r=t+e;if(o<i&&(r+=i-o,o=i),n<r){var a=o-i,s=r-n;o-=s<a?s:a,r=n}return v.node("select",v.group({min:o,max:r,i:1,node:"option",item:function(e){return[e,0,"value="+e+(t==e?" selected":"")]}}),u.klass.selectYear,(l?"":"disabled")+" "+v.ariaAttr({controls:c.$node[0].id+"_table"})+' title="'+u.labelYearSelect+'"')}return v.node("div",t,u.klass.year)}var n,o,c=this,u=c.settings,r=c.item,a=r.now,s=r.select,d=r.highlight,h=r.view,p=r.disable,f=r.min,g=r.max,m=(n=(u.showWeekdaysFull?u.weekdaysFull:u.weekdaysShort).slice(0),o=u.weekdaysFull.slice(0),u.firstDay&&(n.push(n.shift()),o.push(o.shift())),v.node("thead",v.node("tr",v.group({min:0,max:6,i:1,node:"th",item:function(e){return[n[e],u.klass.weekdays,'scope=col title="'+o[e]+'"']}}))));return v.node("div",(u.selectYears?i()+t():t()+i())+e()+e(1),u.klass.header)+v.node("table",m+v.node("tbody",v.group({min:0,max:5,i:1,node:"tr",item:function(e){var t=u.firstDay&&0===c.create([h.year,h.month,1]).day?-7:0;return[v.group({min:7*e-h.day+t+1,max:function(){return this.min+7-1},i:1,node:"td",item:function(e){e=c.create([h.year,h.month,e+(u.firstDay?1:0)]);var t,i=s&&s.pick==e.pick,n=d&&d.pick==e.pick,o=p&&c.disabled(e)||e.pick<f.pick||e.pick>g.pick,r=v.trigger(c.formats.toString,c,[u.format,e]);return[v.node("div",e.date,(t=[u.klass.day],t.push(h.month==e.month?u.klass.infocus:u.klass.outfocus),a.pick==e.pick&&t.push(u.klass.now),i&&t.push(u.klass.selected),n&&t.push(u.klass.highlighted),o&&t.push(u.klass.disabled),t.join(" ")),"data-pick="+e.pick+" "+v.ariaAttr({role:"gridcell",label:r,selected:!(!i||c.$node.val()!==r)||null,activedescendant:!!n||null,disabled:!!o||null})),"",v.ariaAttr({role:"presentation"})]}})]}})),u.klass.table,'id="'+c.$node[0].id+'_table" '+v.ariaAttr({role:"grid",controls:c.$node[0].id,readonly:!0}))+v.node("div",v.node("button",u.today,u.klass.buttonToday,"type=button data-pick="+a.pick+(l&&!c.disabled(a)?"":" disabled")+" "+v.ariaAttr({controls:c.$node[0].id}))+v.node("button",u.clear,u.klass.buttonClear,"type=button data-clear=1"+(l?"":" disabled")+" "+v.ariaAttr({controls:c.$node[0].id}))+v.node("button",u.close,u.klass.buttonClose,"type=button data-close=true "+(l?"":" disabled")+" "+v.ariaAttr({controls:c.$node[0].id})),u.klass.footer)},i.defaults={labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",close:"Close",closeOnSelect:!0,closeOnClear:!0,format:"d mmmm, yyyy",klass:{table:(t=e.klasses().picker+"__")+"table",header:t+"header",navPrev:t+"nav--prev",navNext:t+"nav--next",navDisabled:t+"nav--disabled",month:t+"month",year:t+"year",selectMonth:t+"select--month",selectYear:t+"select--year",weekdays:t+"weekday",day:t+"day",disabled:t+"day--disabled",selected:t+"day--selected",highlighted:t+"day--highlighted",now:t+"day--today",infocus:t+"day--infocus",outfocus:t+"day--outfocus",footer:t+"footer",buttonClear:t+"button--clear",buttonToday:t+"button--today",buttonClose:t+"button--close"}},e.extend("pickadate",i)}),function(e){"function"==typeof define&&define.amd?define(["picker","jquery"],e):"object"==typeof exports?module.exports=e(require("./picker.js"),require("jquery")):e(Picker,jQuery)}(function(e,l){var t,p=e._;function i(o,r){var e,t=this,i=o.$node[0].value,n=o.$node.data("value"),a=n||i,s=n?r.formatSubmit:r.format;t.settings=r,t.$node=o.$node,t.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse create validate",view:"parse create validate",disable:"deactivate",enable:"activate"},t.item={},t.item.clear=null,t.item.interval=r.interval||30,t.item.disable=(r.disable||[]).slice(0),t.item.enable=-(!0===(e=t.item.disable)[0]?e.shift():-1),t.set("min",r.min).set("max",r.max).set("now"),a?t.set("select",a,{format:s}):t.set("select",null).set("highlight",t.item.now),t.key={40:1,38:-1,39:1,37:-1,go:function(e){t.set("highlight",t.item.highlight.pick+e*t.item.interval,{interval:e*t.item.interval}),this.render()}},o.on("render",function(){function e(t){return["webkit","moz","ms","o",""].map(function(e){return(e?"-"+e+"-":"")+t})}function t(t,i){e("transform").map(function(e){t.css(e,i)}),e("transition").map(function(e){t.css(e,i)})}var i=o.$root.children(),n=i.find("."+r.klass.viewset);n.length&&(t(i,"none"),i[0].scrollTop=~~n.position().top-2*n[0].clientHeight,t(i,""))},1).on("open",function(){o.$root.find("button").attr("disabled",!1)},1).on("close",function(){o.$root.find("button").attr("disabled",!0)},1)}i.prototype.set=function(t,i,n){var o=this,e=o.item;return null===i?("clear"==t&&(t="select"),e[t]=i):(e["enable"==t?"disable":"flip"==t?"enable":t]=o.queue[t].split(" ").map(function(e){return i=o[e](t,i,n)}).pop(),"select"==t?o.set("highlight",e.select,n):"highlight"==t?o.set("view",e.highlight,n):"interval"==t?o.set("min",e.min,n).set("max",e.max,n):t.match(/^(flip|min|max|disable|enable)$/)&&(e.select&&o.disabled(e.select)&&o.set("select",i,n),e.highlight&&o.disabled(e.highlight)&&o.set("highlight",i,n),"min"==t&&o.set("max",e.max,n))),o},i.prototype.get=function(e){return this.item[e]},i.prototype.create=function(e,t,i){return t=void 0===t?e:t,p.isDate(t)&&(t=[t.getHours(),t.getMinutes()]),l.isPlainObject(t)&&p.isInteger(t.pick)?t=t.pick:l.isArray(t)?t=60*+t[0]+ +t[1]:p.isInteger(t)||(t=this.now(e,t,i)),"max"==e&&t<this.item.min.pick&&(t+=1440),"min"!=e&&"max"!=e&&(t-this.item.min.pick)%this.item.interval!=0&&(t+=this.item.interval),{hour:~~(24+(t=this.normalize(e,t,i))/60)%24,mins:(60+t%60)%60,time:(1440+t)%1440,pick:t%1440}},i.prototype.createRange=function(e,t){function i(e){return!0===e||l.isArray(e)||p.isDate(e)?n.create(e):e}var n=this;return p.isInteger(e)||(e=i(e)),p.isInteger(t)||(t=i(t)),p.isInteger(e)&&l.isPlainObject(t)?e=[t.hour,t.mins+e*n.settings.interval]:p.isInteger(t)&&l.isPlainObject(e)&&(t=[e.hour,e.mins+t*n.settings.interval]),{from:i(e),to:i(t)}},i.prototype.withinRange=function(e,t){return e=this.createRange(e.from,e.to),t.pick>=e.from.pick&&t.pick<=e.to.pick},i.prototype.overlapRanges=function(e,t){return e=this.createRange(e.from,e.to),t=this.createRange(t.from,t.to),this.withinRange(e,t.from)||this.withinRange(e,t.to)||this.withinRange(t,e.from)||this.withinRange(t,e.to)},i.prototype.now=function(e,t){var i,n=this.item.interval,o=new Date,r=60*o.getHours()+o.getMinutes();return r-=r%n,i=t<0&&n*t+r<=-n,r+="min"==e&&i?0:n,p.isInteger(t)&&(r+=n*(i&&"max"!=e?t+1:t)),r},i.prototype.normalize=function(e,t){var i=this.item.interval,n=this.item.min&&this.item.min.pick||0;return t-="min"==e?0:(t-n)%i},i.prototype.measure=function(e,t,i){return"string"==typeof(t=t||("min"==e?[0,0]:[23,59]))?t=this.parse(e,t):!0===t||p.isInteger(t)?t=this.now(e,t,i):l.isPlainObject(t)&&p.isInteger(t.pick)&&(t=this.normalize(e,t.pick,i)),t},i.prototype.validate=function(e,t,i){var n=i&&i.interval?i.interval:this.item.interval;return this.disabled(t)&&(t=this.shift(t,n)),t=this.scope(t),this.disabled(t)&&(t=this.shift(t,-1*n)),t},i.prototype.disabled=function(t){var i=this,e=i.item.disable.filter(function(e){return p.isInteger(e)?t.hour==e:l.isArray(e)||p.isDate(e)?t.pick==i.create(e).pick:l.isPlainObject(e)?i.withinRange(e,t):void 0});return e=e.length&&!e.filter(function(e){return l.isArray(e)&&"inverted"==e[2]||l.isPlainObject(e)&&e.inverted}).length,-1===i.item.enable?!e:e||t.pick<i.item.min.pick||t.pick>i.item.max.pick},i.prototype.shift=function(e,t){var i=this.item.min.pick,n=this.item.max.pick;for(t=t||this.item.interval;this.disabled(e)&&!((e=this.create(e.pick+=t)).pick<=i||e.pick>=n););return e},i.prototype.scope=function(e){var t=this.item.min.pick,i=this.item.max.pick;return this.create(e.pick>i?i:e.pick<t?t:e)},i.prototype.parse=function(e,o,t){var i,n,r,a,s,l=this,c={};if(!o||"string"!=typeof o)return o;for(a in t&&t.format||((t=t||{}).format=l.settings.format),l.formats.toArray(t.format).map(function(e){var t,i=l.formats[e],n=i?p.trigger(i,l,[o,c]):e.replace(/^!/,"").length;i&&(t=o.substr(0,n),c[e]=t.match(/^\d+$/)?+t:t),o=o.substr(n)}),c)s=c[a],p.isInteger(s)?a.match(/^(h|hh)$/i)?(i=s,"h"!=a&&"hh"!=a||(i%=12)):"i"==a&&(n=s):a.match(/^a$/i)&&s.match(/^p/i)&&("h"in c||"hh"in c)&&(r=!0);return 60*(r?i+12:i)+n},i.prototype.formats={h:function(e,t){return e?p.digits(e):t.hour%12||12},hh:function(e,t){return e?2:p.lead(t.hour%12||12)},H:function(e,t){return e?p.digits(e):""+t.hour%24},HH:function(e,t){return e?p.digits(e):p.lead(t.hour%24)},i:function(e,t){return e?2:p.lead(t.mins)},a:function(e,t){return e?4:t.time%1440<720?"a.m.":"p.m."},A:function(e,t){return e?2:t.time%1440<720?"AM":"PM"},toArray:function(e){return e.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(e,t){var i=this;return i.formats.toArray(e).map(function(e){return p.trigger(i.formats[e],i,[0,t])||e.replace(/^!/,"")}).join("")}},i.prototype.isTimeExact=function(e,t){return p.isInteger(e)&&p.isInteger(t)||"boolean"==typeof e&&"boolean"==typeof t?e===t:(p.isDate(e)||l.isArray(e))&&(p.isDate(t)||l.isArray(t))?this.create(e).pick===this.create(t).pick:!(!l.isPlainObject(e)||!l.isPlainObject(t))&&(this.isTimeExact(e.from,t.from)&&this.isTimeExact(e.to,t.to))},i.prototype.isTimeOverlap=function(e,t){return p.isInteger(e)&&(p.isDate(t)||l.isArray(t))?e===this.create(t).hour:p.isInteger(t)&&(p.isDate(e)||l.isArray(e))?t===this.create(e).hour:!(!l.isPlainObject(e)||!l.isPlainObject(t))&&this.overlapRanges(e,t)},i.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(-1==t.enable?1:-1)},i.prototype.deactivate=function(e,t){var n=this,o=n.item.disable.slice(0);return"flip"==t?n.flipEnable():!1===t?(n.flipEnable(1),o=[]):!0===t?(n.flipEnable(-1),o=[]):t.map(function(e){for(var t,i=0;i<o.length;i+=1)if(n.isTimeExact(e,o[i])){t=!0;break}t||(p.isInteger(e)||p.isDate(e)||l.isArray(e)||l.isPlainObject(e)&&e.from&&e.to)&&o.push(e)}),o},i.prototype.activate=function(e,t){var r=this,a=r.item.disable,s=a.length;return"flip"==t?r.flipEnable():!0===t?(r.flipEnable(1),a=[]):!1===t?(r.flipEnable(-1),a=[]):t.map(function(e){var t,i,n,o;for(n=0;n<s;n+=1){if(i=a[n],r.isTimeExact(i,e)){t=a[n]=null,o=!0;break}if(r.isTimeOverlap(i,e)){l.isPlainObject(e)?(e.inverted=!0,t=e):l.isArray(e)?(t=e)[2]||t.push("inverted"):p.isDate(e)&&(t=[e.getFullYear(),e.getMonth(),e.getDate(),"inverted"]);break}}if(t)for(n=0;n<s;n+=1)if(r.isTimeExact(a[n],e)){a[n]=null;break}if(o)for(n=0;n<s;n+=1)if(r.isTimeOverlap(a[n],e)){a[n]=null;break}t&&a.push(t)}),a.filter(function(e){return null!=e})},i.prototype.i=function(e,t){return p.isInteger(t)&&0<t?t:this.item.interval},i.prototype.nodes=function(e){var s=this,l=s.settings,c=s.item.select,u=s.item.highlight,d=s.item.view,h=s.item.disable;return p.node("ul",p.group({min:s.item.min.pick,max:s.item.max.pick,i:s.item.interval,node:"li",item:function(e){var t,i=(e=s.create(e)).pick,n=c&&c.pick==i,o=u&&u.pick==i,r=h&&s.disabled(e),a=p.trigger(s.formats.toString,s,[l.format,e]);return[p.trigger(s.formats.toString,s,[p.trigger(l.formatLabel,s,[e])||l.format,e]),(t=[l.klass.listItem],n&&t.push(l.klass.selected),o&&t.push(l.klass.highlighted),d&&d.pick==i&&t.push(l.klass.viewset),r&&t.push(l.klass.disabled),t.join(" ")),"data-pick="+e.pick+" "+p.ariaAttr({role:"option",label:a,selected:!(!n||s.$node.val()!==a)||null,activedescendant:!!o||null,disabled:!!r||null})]}})+p.node("li",p.node("button",l.clear,l.klass.buttonClear,"type=button data-clear=1"+(e?"":" disabled")+" "+p.ariaAttr({controls:s.$node[0].id})),"",p.ariaAttr({role:"presentation"})),l.klass.list,p.ariaAttr({role:"listbox",controls:s.$node[0].id}))},i.defaults={clear:"Clear",format:"h:i A",interval:30,closeOnSelect:!0,closeOnClear:!0,klass:{picker:(t=e.klasses().picker)+" "+t+"--time",holder:t+"__holder",list:t+"__list",listItem:t+"__list-item",disabled:t+"__list-item--disabled",selected:t+"__list-item--selected",highlighted:t+"__list-item--highlighted",viewset:t+"__list-item--viewset",now:t+"__list-item--now",buttonClear:t+"__button--clear"}},e.extend("pickatime",i)}),[].map||(Array.prototype.map=function(e,t){for(var i=this.length,n=new Array(i),o=0;o<i;o++)o in this&&(n[o]=e.call(t,this[o],o,this));return n}),[].filter||(Array.prototype.filter=function(e){if(null==this)throw new TypeError;var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var n=[],o=arguments[1],r=0;r<i;r++)if(r in t){var a=t[r];e.call(o,a,r,t)&&n.push(a)}return n}),[].indexOf||(Array.prototype.indexOf=function(e){if(null==this)throw new TypeError;var t=Object(this),i=t.length>>>0;if(0==i)return-1;var n=0;if(1<arguments.length&&((n=Number(arguments[1]))!=n?n=0:0!==n&&n!=1/0&&n!=-1/0&&(n=(0<n||-1)*Math.floor(Math.abs(n)))),i<=n)return-1;for(var o=0<=n?n:Math.max(i-Math.abs(n),0);o<i;o++)if(o in t&&t[o]===e)return o;return-1});var nativeSplit=String.prototype.split,compliantExecNpcg=void 0===/()??/.exec("")[1],constants,constants;String.prototype.split=function(e,t){var i=this;if("[object RegExp]"!==Object.prototype.toString.call(e))return nativeSplit.call(i,e,t);var n,o,r,a,s=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),c=0;for(e=new RegExp(e.source,l+"g"),i+="",compliantExecNpcg||(n=new RegExp("^"+e.source+"$(?!\\s)",l)),t=void 0===t?-1>>>0:t>>>0;(o=e.exec(i))&&!(c<(r=o.index+o[0].length)&&(s.push(i.slice(c,o.index)),!compliantExecNpcg&&1<o.length&&o[0].replace(n,function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(o[e]=void 0)}),1<o.length&&o.index<i.length&&Array.prototype.push.apply(s,o.slice(1)),a=o[0].length,c=r,s.length>=t));)e.lastIndex===o.index&&e.lastIndex++;return c===i.length?!a&&e.test("")||s.push(""):s.push(i.slice(c)),s.length>t?s.slice(0,t):s},function(){var e=function(){return this}();var t,i,r=function(e,t,i){"string"==typeof e?(2==arguments.length&&(i=t),r.modules||(r.modules={},r.payloads={}),r.payloads[e]=i,r.modules[e]=null):r.original?r.original.apply(window,arguments):(console.error("dropping module because define wasn't a string."),console.trace())},l=function(e,t,i){if("[object Array]"===Object.prototype.toString.call(t)){for(var n=[],o=0,r=t.length;o<r;++o){var a=c(e,t[o]);if(!a&&l.original)return l.original.apply(window,arguments);n.push(a)}i&&i.apply(null,n)}else{if("string"==typeof t){var s=c(e,t);return!s&&l.original?l.original.apply(window,arguments):(i&&i(),s)}if(l.original)return l.original.apply(window,arguments)}},a=function(e,t){if(-1!==t.indexOf("!")){var i=t.split("!");return a(e,i[0])+"!"+a(e,i[1])}if("."==t.charAt(0))for(t=e.split("/").slice(0,-1).join("/")+"/"+t;-1!==t.indexOf(".")&&n!=t;){var n=t;t=t.replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}return t},c=function(e,i){i=a(e,i);var t=r.modules[i];if(!t){if("function"==typeof(t=r.payloads[i])){var n={},o={id:i,uri:"",exports:n,packaged:!0};n=t(function(e,t){return l(i,e,t)},n,o)||o.exports,r.modules[i]=n,delete r.payloads[i]}t=r.modules[i]=n||t}return t};i=e,(t="ace")&&(e[t]||(e[t]={}),i=e[t]),i.define&&i.define.packaged||(r.original=i.define,i.define=r,i.define.packaged=!0),i.require&&i.require.packaged||(l.original=i.require,i.require=function(e,t){return l("",e,t)},i.require.packaged=!0)}(),ace.define("ace/lib/regexp",["require","exports","module"],function(e,t,i){"use strict";var n,r={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},a=void 0===r.exec.call(/()??/,"")[1],s=(n=/^/g,r.test.call(n,""),!n.lastIndex);s&&a||(RegExp.prototype.exec=function(e){var t,i,n=r.exec.apply(this,arguments);if("string"==typeof e&&n){if(!a&&1<n.length&&-1<function(e,t,i){if(Array.prototype.indexOf)return e.indexOf(t,i);for(var n=i||0;n<e.length;n++)if(e[n]===t)return n;return-1}(n,"")&&(i=RegExp(this.source,r.replace.call(function(e){return(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":"")}(this),"g","")),r.replace.call(e.slice(n.index),i,function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(n[e]=void 0)})),this._xregexp&&this._xregexp.captureNames)for(var o=1;o<n.length;o++)(t=this._xregexp.captureNames[o-1])&&(n[t]=n[o]);!s&&this.global&&!n[0].length&&this.lastIndex>n.index&&this.lastIndex--}return n},s||(RegExp.prototype.test=function(e){var t=r.exec.call(this,e);return t&&this.global&&!t[0].length&&this.lastIndex>t.index&&this.lastIndex--,!!t}))}),ace.define("ace/lib/es5-shim",["require","exports","module"],function(e,t,i){function r(){}Function.prototype.bind||(Function.prototype.bind=function(t){var i=this;if("function"!=typeof i)throw new TypeError("Function.prototype.bind called on incompatible "+i);var n=h.call(arguments,1),o=function(){if(this instanceof o){var e=i.apply(this,n.concat(h.call(arguments)));return Object(e)===e?e:this}return i.apply(t,n.concat(h.call(arguments)))};return i.prototype&&(r.prototype=i.prototype,o.prototype=new r,r.prototype=null),o});var o,a,s,l,c,n=Function.prototype.call,u=Array.prototype,d=Object.prototype,h=u.slice,p=n.bind(d.toString),f=n.bind(d.hasOwnProperty);if((c=f(d,"__defineGetter__"))&&(o=n.bind(d.__defineGetter__),a=n.bind(d.__defineSetter__),s=n.bind(d.__lookupGetter__),l=n.bind(d.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function e(e){var t=new Array(e+2);return t[0]=t[1]=0,t}var t,i=[];if(i.splice.apply(i,e(20)),i.splice.apply(i,e(26)),t=i.length,i.splice(5,0,"XXX"),i.length,t+1==i.length)return!0}()){var g=Array.prototype.splice;Array.prototype.splice=function(e,t){return arguments.length?g.apply(this,[void 0===e?0:e,void 0===t?this.length-e:t].concat(h.call(arguments,2))):[]}}else Array.prototype.splice=function(e,t){var i=this.length;0<e?i<e&&(e=i):null==e?e=0:e<0&&(e=Math.max(i+e,0)),e+t<i||(t=i-e);var n=this.slice(e,e+t),o=h.call(arguments,2),r=o.length;if(e===i)r&&this.push.apply(this,o);else{var a=Math.min(t,i-e),s=e+a,l=s+r-a,c=i-s,u=i-a;if(l<s)for(var d=0;d<c;++d)this[l+d]=this[s+d];else if(s<l)for(d=c;d--;)this[l+d]=this[s+d];if(r&&e===u)this.length=u,this.push.apply(this,o);else for(this.length=u+r,d=0;d<r;++d)this[e+d]=o[d]}return n};Array.isArray||(Array.isArray=function(e){return"[object Array]"==p(e)});var m,v=Object("a"),y="a"!=v[0]||!(0 in v);if(Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var i=k(this),n=y&&"[object String]"==p(this)?this.split(""):i,o=t,r=-1,a=n.length>>>0;if("[object Function]"!=p(e))throw new TypeError;for(;++r<a;)r in n&&e.call(o,n[r],r,i)}),Array.prototype.map||(Array.prototype.map=function(e,t){var i=k(this),n=y&&"[object String]"==p(this)?this.split(""):i,o=n.length>>>0,r=Array(o),a=t;if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var s=0;s<o;s++)s in n&&(r[s]=e.call(a,n[s],s,i));return r}),Array.prototype.filter||(Array.prototype.filter=function(e,t){var i,n=k(this),o=y&&"[object String]"==p(this)?this.split(""):n,r=o.length>>>0,a=[],s=t;if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var l=0;l<r;l++)l in o&&(i=o[l],e.call(s,i,l,n)&&a.push(i));return a}),Array.prototype.every||(Array.prototype.every=function(e,t){var i=k(this),n=y&&"[object String]"==p(this)?this.split(""):i,o=n.length>>>0,r=t;if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var a=0;a<o;a++)if(a in n&&!e.call(r,n[a],a,i))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(e,t){var i=k(this),n=y&&"[object String]"==p(this)?this.split(""):i,o=n.length>>>0,r=t;if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var a=0;a<o;a++)if(a in n&&e.call(r,n[a],a,i))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(e,t){var i=k(this),n=y&&"[object String]"==p(this)?this.split(""):i,o=n.length>>>0;if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");if(!o&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var r,a=0;if(2<=arguments.length)r=t;else for(;;){if(a in n){r=n[a++];break}if(++a>=o)throw new TypeError("reduce of empty array with no initial value")}for(;a<o;a++)a in n&&(r=e.call(void 0,r,n[a],a,i));return r}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(e,t){var i=k(this),n=y&&"[object String]"==p(this)?this.split(""):i,o=n.length>>>0;if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");if(!o&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var r,a=o-1;if(2<=arguments.length)r=t;else for(;;){if(a in n){r=n[a--];break}if(--a<0)throw new TypeError("reduceRight of empty array with no initial value")}for(;a in this&&(r=e.call(void 0,r,n[a],a,i)),a--;);return r}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(e,t){var i=y&&"[object String]"==p(this)?this.split(""):k(this),n=i.length>>>0;if(!n)return-1;var o=0;for(1<arguments.length&&(o=D(t)),o=0<=o?o:Math.max(0,n+o);o<n;o++)if(o in i&&i[o]===e)return o;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(e,t){var i=y&&"[object String]"==p(this)?this.split(""):k(this),n=i.length>>>0;if(!n)return-1;var o=n-1;for(1<arguments.length&&(o=Math.min(o,D(t))),o=0<=o?o:n-Math.abs(o);0<=o;o--)if(o in i&&e===i[o])return o;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.__proto__||(e.constructor?e.constructor.prototype:d)}),!Object.getOwnPropertyDescriptor){Object.getOwnPropertyDescriptor=function(e,t){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.getOwnPropertyDescriptor called on a non-object: "+e);if(f(e,t)){var i;if(i={enumerable:!0,configurable:!0},c){var n=e.__proto__;e.__proto__=d;var o=s(e,t),r=l(e,t);if(e.__proto__=n,o||r)return o&&(i.get=o),r&&(i.set=r),i}return i.value=e[t],i}}}Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(e){return Object.keys(e)}),Object.create||(m=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var e={};for(var t in e)e[t]=null;return e.constructor=e.hasOwnProperty=e.propertyIsEnumerable=e.isPrototypeOf=e.toLocaleString=e.toString=e.valueOf=e.__proto__=null,e},Object.create=function(e,t){var i;if(null===e)i=m();else{if("object"!=typeof e)throw new TypeError("typeof prototype["+typeof e+"] != 'object'");function n(){}n.prototype=e,(i=new n).__proto__=e}return void 0!==t&&Object.defineProperties(i,t),i});function b(e){try{return Object.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(e){}}if(Object.defineProperty){var w=b({}),C="undefined"==typeof document||b(document.createElement("div"));if(!w||!C)var _=Object.defineProperty}if(!Object.defineProperty||_){Object.defineProperty=function(e,t,i){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.defineProperty called on non-object: "+e);if("object"!=typeof i&&"function"!=typeof i||null===i)throw new TypeError("Property description must be an object: "+i);if(_)try{return _.call(Object,e,t,i)}catch(e){}if(f(i,"value"))if(c&&(s(e,t)||l(e,t))){var n=e.__proto__;e.__proto__=d,delete e[t],e[t]=i.value,e.__proto__=n}else e[t]=i.value;else{if(!c)throw new TypeError("getters & setters can not be defined on this javascript engine");f(i,"get")&&o(e,t,i.get),f(i,"set")&&a(e,t,i.set)}return e}}Object.defineProperties||(Object.defineProperties=function(e,t){for(var i in t)f(t,i)&&Object.defineProperty(e,i,t[i]);return e}),Object.seal||(Object.seal=function(e){return e}),Object.freeze||(Object.freeze=function(e){return e});try{Object.freeze(function(){})}catch(e){Object.freeze=function(t){return function(e){return"function"==typeof e?e:t(e)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(e){return e}),Object.isSealed||(Object.isSealed=function(e){return!1}),Object.isFrozen||(Object.isFrozen=function(e){return!1}),Object.isExtensible||(Object.isExtensible=function(e){if(Object(e)===e)throw new TypeError;for(var t="";f(e,t);)t+="?";e[t]=!0;var i=f(e,t);return delete e[t],i}),!Object.keys){var A=!0,E=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],x=E.length;for(var S in{toString:null})A=!1;Object.keys=function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on a non-object");var t=[];for(var i in e)f(e,i)&&t.push(i);if(A)for(var n=0,o=x;n<o;n++){var r=E[n];f(e,r)&&t.push(r)}return t}}Date.now||(Date.now=function(){return(new Date).getTime()});var T="\t\n\v\f\r ¬†·öÄ·†é‚ÄÄ‚ÄÅ‚ÄÇ‚ÄÉ‚ÄÑ‚ÄÖ‚ÄÜ‚Äá‚Äà‚Äâ‚Ää‚ÄØ‚Åü„ÄÄ\u2028\u2029\ufeff";if(!String.prototype.trim||T.trim()){String.prototype.trim=function(){if(this){var e=function(e){var t,i,n=e.length;for(i=0;i<n;i++)if(t=e.charAt(i),-1===T.indexOf(t))return i;return-1}(this);return-1==e?"":this.substring(e,function(e){var t,i;for(i=e.length-1;0<=i;i--)if(t=e.charAt(i),-1===T.indexOf(t))return i+1;return-1}(this))}return this}}function D(e){return(e=+e)!=e?e=0:0!==e&&e!==1/0&&e!==-1/0&&(e=(0<e||-1)*Math.floor(Math.abs(e))),e}var k=function(e){if(null==e)throw new TypeError("can't convert "+e+" to object");return Object(e)}}),ace.define("ace/lib/fixoldbrowsers",["require","exports","module","ace/lib/regexp","ace/lib/es5-shim"],function(e,t,i){"use strict";e("./regexp"),e("./es5-shim")}),ace.define("ace/lib/dom",["require","exports","module"],function(e,s,t){"use strict";var o="http://www.w3.org/1999/xhtml";s.getDocumentHead=function(e){return(e=e||document).head||e.getElementsByTagName("head")[0]||e.documentElement},s.createElement=function(e,t){return document.createElementNS?document.createElementNS(t||o,e):document.createElement(e)},s.hasCssClass=function(e,t){return-1!==(e.className||"").split(/\s+/g).indexOf(t)},s.addCssClass=function(e,t){s.hasCssClass(e,t)||(e.className+=" "+t)},s.removeCssClass=function(e,t){for(var i=e.className.split(/\s+/g);;){var n=i.indexOf(t);if(-1==n)break;i.splice(n,1)}e.className=i.join(" ")},s.toggleCssClass=function(e,t){for(var i=e.className.split(/\s+/g),n=!0;;){var o=i.indexOf(t);if(-1==o)break;n=!1,i.splice(o,1)}return n&&i.push(t),e.className=i.join(" "),n},s.setCssClass=function(e,t,i){i?s.addCssClass(e,t):s.removeCssClass(e,t)},s.hasCssString=function(e,t){var i,n=0;if((t=t||document).createStyleSheet&&(i=t.styleSheets)){for(;n<i.length;)if(i[n++].owningElement.id===e)return!0}else if(i=t.getElementsByTagName("style"))for(;n<i.length;)if(i[n++].id===e)return!0;return!1},s.importCssString=function(e,t,i){if(i=i||document,t&&s.hasCssString(t,i))return null;var n;i.createStyleSheet?((n=i.createStyleSheet()).cssText=e,t&&(n.owningElement.id=t)):((n=i.createElementNS?i.createElementNS(o,"style"):i.createElement("style")).appendChild(i.createTextNode(e)),t&&(n.id=t),s.getDocumentHead(i).appendChild(n))},s.importCssStylsheet=function(e,t){if(t.createStyleSheet)t.createStyleSheet(e);else{var i=s.createElement("link");i.rel="stylesheet",i.href=e,s.getDocumentHead(t).appendChild(i)}},s.getInnerWidth=function(e){return parseInt(s.computedStyle(e,"paddingLeft"),10)+parseInt(s.computedStyle(e,"paddingRight"),10)+e.clientWidth},s.getInnerHeight=function(e){return parseInt(s.computedStyle(e,"paddingTop"),10)+parseInt(s.computedStyle(e,"paddingBottom"),10)+e.clientHeight},"undefined"!=typeof document&&(void 0!==window.pageYOffset?(s.getPageScrollTop=function(){return window.pageYOffset},s.getPageScrollLeft=function(){return window.pageXOffset}):(s.getPageScrollTop=function(){return document.body.scrollTop},s.getPageScrollLeft=function(){return document.body.scrollLeft}),window.getComputedStyle?s.computedStyle=function(e,t){return t?(window.getComputedStyle(e,"")||{})[t]||"":window.getComputedStyle(e,"")||{}}:s.computedStyle=function(e,t){return t?e.currentStyle[t]:e.currentStyle},s.scrollbarWidth=function(e){var t=s.createElement("ace_inner");t.style.width="100%",t.style.minWidth="0px",t.style.height="200px",t.style.display="block";var i=s.createElement("ace_outer"),n=i.style;n.position="absolute",n.left="-10000px",n.overflow="hidden",n.width="200px",n.minWidth="0px",n.height="150px",n.display="block",i.appendChild(t);var o=e.documentElement;o.appendChild(i);var r=t.offsetWidth;n.overflow="scroll";var a=t.offsetWidth;return r==a&&(a=i.clientWidth),o.removeChild(i),r-a},s.setInnerHtml=function(e,t){var i=e.cloneNode(!1);return i.innerHTML=t,e.parentNode.replaceChild(i,e),i},"textContent"in document.documentElement?(s.setInnerText=function(e,t){e.textContent=t},s.getInnerText=function(e){return e.textContent}):(s.setInnerText=function(e,t){e.innerText=t},s.getInnerText=function(e){return e.innerText}),s.getParentWindow=function(e){return e.defaultView||e.parentWindow})}),ace.define("ace/lib/oop",["require","exports","module"],function(e,i,t){"use strict";i.inherits=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},i.mixin=function(e,t){for(var i in t)e[i]=t[i];return e},i.implement=function(e,t){i.mixin(e,t)}}),ace.define("ace/lib/keys",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/oop"],function(e,t,i){"use strict";e("./fixoldbrowsers");var n=e("./oop"),o=function(){var e,t,i={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta"},KEY_MODS:{ctrl:1,alt:2,option:2,shift:4,super:8,meta:8,command:8,cmd:8},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}};for(t in i.FUNCTION_KEYS)e=i.FUNCTION_KEYS[t].toLowerCase(),i[e]=parseInt(t,10);for(t in i.PRINTABLE_KEYS)e=i.PRINTABLE_KEYS[t].toLowerCase(),i[e]=parseInt(t,10);return n.mixin(i,i.MODIFIER_KEYS),n.mixin(i,i.PRINTABLE_KEYS),n.mixin(i,i.FUNCTION_KEYS),i.enter=i.return,i.escape=i.esc,i.del=i.delete,i[173]="-",function(){for(var e=["cmd","ctrl","alt","shift"],t=Math.pow(2,e.length);t--;)i.KEY_MODS[t]=e.filter(function(e){return t&i.KEY_MODS[e]}).join("-")+"-"}(),i.KEY_MODS[0]="",i.KEY_MODS[-1]="input",i}();n.mixin(t,o),t.keyCodeToString=function(e){var t=o[e];return"string"!=typeof t&&(t=String.fromCharCode(e)),t.toLowerCase()}}),ace.define("ace/lib/useragent",["require","exports","module"],function(e,t,i){"use strict";if(t.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"},t.getOS=function(){return t.isMac?t.OS.MAC:t.isLinux?t.OS.LINUX:t.OS.WINDOWS},"object"==typeof navigator){var n=(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),o=navigator.userAgent;t.isWin="win"==n,t.isMac="mac"==n,t.isLinux="linux"==n,t.isIE="Microsoft Internet Explorer"==navigator.appName||0<=navigator.appName.indexOf("MSAppHost")?parseFloat((o.match(/(?:MSIE |Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]):parseFloat((o.match(/(?:Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]),t.isOldIE=t.isIE&&t.isIE<9,t.isGecko=t.isMozilla=(window.Controllers||window.controllers)&&"Gecko"===window.navigator.product,t.isOldGecko=t.isGecko&&parseInt((o.match(/rv\:(\d+)/)||[])[1],10)<4,t.isOpera=window.opera&&"[object Opera]"==Object.prototype.toString.call(window.opera),t.isWebKit=parseFloat(o.split("WebKit/")[1])||void 0,t.isChrome=parseFloat(o.split(" Chrome/")[1])||void 0,t.isAIR=0<=o.indexOf("AdobeAIR"),t.isIPad=0<=o.indexOf("iPad"),t.isTouchPad=0<=o.indexOf("TouchPad"),t.isChromeOS=0<=o.indexOf(" CrOS ")}}),ace.define("ace/lib/event",["require","exports","module","ace/lib/keys","ace/lib/useragent"],function(e,u,t){"use strict";var a=e("./keys"),d=e("./useragent");u.addListener=function(e,t,i){if(e.addEventListener)return e.addEventListener(t,i,!1);if(e.attachEvent){var n=function(){i.call(e,window.event)};i._wrapper=n,e.attachEvent("on"+t,n)}},u.removeListener=function(e,t,i){if(e.removeEventListener)return e.removeEventListener(t,i,!1);e.detachEvent&&e.detachEvent("on"+t,i._wrapper||i)},u.stopEvent=function(e){return u.stopPropagation(e),u.preventDefault(e),!1},u.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},u.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},u.getButton=function(e){return"dblclick"==e.type?0:"contextmenu"==e.type||d.isMac&&e.ctrlKey&&!e.altKey&&!e.shiftKey?2:e.preventDefault?e.button:{1:0,2:2,4:1}[e.button]},u.capture=function(e,t,i){function n(e){t&&t(e),i&&i(e),u.removeListener(document,"mousemove",t,!0),u.removeListener(document,"mouseup",n,!0),u.removeListener(document,"dragstart",n,!0)}return u.addListener(document,"mousemove",t,!0),u.addListener(document,"mouseup",n,!0),u.addListener(document,"dragstart",n,!0),n},u.addMouseWheelListener=function(e,t){"onmousewheel"in e?u.addListener(e,"mousewheel",function(e){void 0!==e.wheelDeltaX?(e.wheelX=-e.wheelDeltaX/8,e.wheelY=-e.wheelDeltaY/8):(e.wheelX=0,e.wheelY=-e.wheelDelta/8),t(e)}):"onwheel"in e?u.addListener(e,"wheel",function(e){switch(e.deltaMode){case e.DOM_DELTA_PIXEL:e.wheelX=.35*e.deltaX||0,e.wheelY=.35*e.deltaY||0;break;case e.DOM_DELTA_LINE:case e.DOM_DELTA_PAGE:e.wheelX=5*(e.deltaX||0),e.wheelY=5*(e.deltaY||0)}t(e)}):u.addListener(e,"DOMMouseScroll",function(e){e.axis&&e.axis==e.HORIZONTAL_AXIS?(e.wheelX=5*(e.detail||0),e.wheelY=0):(e.wheelX=0,e.wheelY=5*(e.detail||0)),t(e)})},u.addMultiMouseDownListener=function(e,i,n,o){var r,a,s,l=0,c={2:"dblclick",3:"tripleclick",4:"quadclick"};u.addListener(e,"mousedown",function(e){if(0!==u.getButton(e)?l=0:1<e.detail?4<++l&&(l=1):l=1,d.isIE){var t=5<Math.abs(e.clientX-r)||5<Math.abs(e.clientY-a);s&&!t||(l=1),s&&clearTimeout(s),s=setTimeout(function(){s=null},i[l-1]||600),1==l&&(r=e.clientX,a=e.clientY)}if(e._clicks=l,n[o]("mousedown",e),4<l)l=0;else if(1<l)return n[o](c[l],e)}),d.isOldIE&&u.addListener(e,"dblclick",function(e){l=2,s&&clearTimeout(s),s=setTimeout(function(){s=null},i[l-1]||600),n[o]("mousedown",e),n[o](c[l],e)})};var s=!d.isMac||!d.isOpera||"KeyboardEvent"in window?function(e){return 0|(e.ctrlKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.metaKey?8:0)}:function(e){return 0|(e.metaKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.ctrlKey?8:0)};function r(e,t,i){var n=s(t);if(!d.isMac&&l){if((l[91]||l[92])&&(n|=8),l.altGr){if(3==(3&n))return;l.altGr=0}if(18===i||17===i){var o="location"in t?t.location:t.keyLocation;if(17===i&&1===o)c=t.timeStamp;else if(18===i&&3===n&&2===o){var r=-c;(r+=c=t.timeStamp)<3&&(l.altGr=!0)}}}if(i in a.MODIFIER_KEYS){switch(a.MODIFIER_KEYS[i]){case"Alt":n=2;break;case"Shift":n=4;break;case"Ctrl":n=1;break;default:n=8}i=-1}if((8&n&&(91===i||93===i)&&(i=-1),!n&&13===i)&&(3===(o="location"in t?t.location:t.keyLocation)&&(e(t,n,-i),t.defaultPrevented)))return;if(d.isChromeOS&&8&n){if(e(t,n,i),t.defaultPrevented)return;n&=-9}return!!(n||i in a.FUNCTION_KEYS||i in a.PRINTABLE_KEYS)&&e(t,n,i)}u.getModifierString=function(e){return a.KEY_MODS[s(e)]};var l=null,c=0;if(u.addCommandKeyListener=function(e,i){var t=u.addListener;if(d.isOldGecko||d.isOpera&&!("KeyboardEvent"in window)){var n=null;t(e,"keydown",function(e){n=e.keyCode}),t(e,"keypress",function(e){return r(i,e,n)})}else{var o=null;t(e,"keydown",function(e){l[e.keyCode]=!0;var t=r(i,e,e.keyCode);return o=e.defaultPrevented,t}),t(e,"keypress",function(e){o&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&(u.stopEvent(e),o=null)}),t(e,"keyup",function(e){l[e.keyCode]=null}),l||(l=Object.create(null),t(window,"focus",function(e){l=Object.create(null)}))}},window.postMessage&&!d.isOldIE){u.nextTick=function(i,n){n=n||window;var o="zero-timeout-message-1";u.addListener(n,"message",function e(t){t.data==o&&(u.stopPropagation(t),u.removeListener(n,"message",e),i())}),n.postMessage(o,"*")}}u.nextFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame,u.nextFrame?u.nextFrame=u.nextFrame.bind(window):u.nextFrame=function(e){setTimeout(e,17)}}),ace.define("ace/lib/lang",["require","exports","module"],function(e,o,t){"use strict";o.last=function(e){return e[e.length-1]},o.stringReverse=function(e){return e.split("").reverse().join("")},o.stringRepeat=function(e,t){for(var i="";0<t;)1&t&&(i+=e),(t>>=1)&&(e+=e);return i};var i=/^\s\s*/,n=/\s\s*$/;o.stringTrimLeft=function(e){return e.replace(i,"")},o.stringTrimRight=function(e){return e.replace(n,"")},o.copyObject=function(e){var t={};for(var i in e)t[i]=e[i];return t},o.copyArray=function(e){for(var t=[],i=0,n=e.length;i<n;i++)e[i]&&"object"==typeof e[i]?t[i]=this.copyObject(e[i]):t[i]=e[i];return t},o.deepCopy=function(e){if("object"!=typeof e||!e)return e;var t=e.constructor;if(t===RegExp)return e;var i=t();for(var n in e)"object"==typeof e[n]?i[n]=o.deepCopy(e[n]):i[n]=e[n];return i},o.arrayToMap=function(e){for(var t={},i=0;i<e.length;i++)t[e[i]]=1;return t},o.createMap=function(e){var t=Object.create(null);for(var i in e)t[i]=e[i];return t},o.arrayRemove=function(e,t){for(var i=0;i<=e.length;i++)t===e[i]&&e.splice(i,1)},o.escapeRegExp=function(e){return e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},o.escapeHTML=function(e){return e.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},o.getMatchOffsets=function(e,t){var i=[];return e.replace(t,function(e){i.push({offset:arguments[arguments.length-2],length:e.length})}),i},o.deferredCall=function(e){function t(){i=null,e()}var i=null,n=function(e){return n.cancel(),i=setTimeout(t,e||0),n};return(n.schedule=n).call=function(){return this.cancel(),e(),n},n.cancel=function(){return clearTimeout(i),i=null,n},n.isPending=function(){return i},n},o.delayedCall=function(e,t){function i(){o=null,e()}function n(e){null==o&&(o=setTimeout(i,e||t))}var o=null;return n.delay=function(e){o&&clearTimeout(o),o=setTimeout(i,e||t)},(n.schedule=n).call=function(){this.cancel(),e()},n.cancel=function(){o&&clearTimeout(o),o=null},n.isPending=function(){return o},n}}),ace.define("ace/keyboard/textinput",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/lib/dom","ace/lib/lang"],function(e,t,i){"use strict";var M=e("../lib/event"),P=e("../lib/useragent"),I=e("../lib/dom"),L=e("../lib/lang"),G=P.isChrome<18,$=P.isIE;t.TextInput=function(e,l){var c=I.createElement("textarea");c.className="ace_text-input",P.isTouchPad&&c.setAttribute("x-palm-disable-auto-cap",!0),c.setAttribute("wrap","off"),c.setAttribute("autocorrect","off"),c.setAttribute("autocapitalize","off"),c.setAttribute("spellcheck",!1),c.style.opacity="0",P.isOldIE&&(c.style.top="-100px"),e.insertBefore(c,e.firstChild);var i="",n=!1,o=!1,r=!1,u="",t=!0;try{var a=document.activeElement===c}catch(e){}M.addListener(c,"blur",function(e){l.onBlur(e),a=!1}),M.addListener(c,"focus",function(e){a=!0,l.onFocus(e),h()}),this.focus=function(){c.style.position="fixed",c.style.top="-10000000px",c.focus(),setTimeout(function(){c.style.position=""},0)},this.blur=function(){c.blur()},this.isFocused=function(){return a};var s=L.delayedCall(function(){a&&h(t)}),d=L.delayedCall(function(){r||(c.value=i,a&&h())});function h(e){if(!r){if(b)t=0,i=e?0:c.value.length-1;else var t=e?2:1,i=2;try{c.setSelectionRange(t,i)}catch(e){}}}function p(){r||(c.value=i,P.isWebKit&&d.schedule())}P.isWebKit||l.addEventListener("changeSelection",function(){l.selection.isEmpty()!=t&&(t=!t,s.schedule())}),p(),a&&l.onFocus();var f=function(e){return 0===e.selectionStart&&e.selectionEnd===e.value.length};if(!c.setSelectionRange&&c.createTextRange&&(c.setSelectionRange=function(e,t){var i=this.createTextRange();i.collapse(!0),i.moveStart("character",e),i.moveEnd("character",t),i.select()},f=function(e){try{var t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&t.text==e.value}),P.isOldIE){var g=!1,m=function(e){if(!g){var t=c.value;if(!r&&t&&t!=i){if(e&&t==i[0])return v.schedule();S(t),g=!0,p(),g=!1}}},v=L.delayedCall(m);M.addListener(c,"propertychange",m);var y={13:1,27:1};M.addListener(c,"keyup",function(e){if(!r||c.value&&!y[e.keyCode]||setTimeout(R,0),(c.value.charCodeAt(0)||0)<129)return v.call();r?k():D()}),M.addListener(c,"keydown",function(e){v.schedule(50)})}var b=null;this.setInputHandler=function(e){b=e};function w(e,t){var i=e.clipboardData||window.clipboardData;if(i&&!G){var n=$?"Text":"text/plain";return t?!1!==i.setData(n,t):i.getData(n)}}function C(e,t){var i=l.getCopyText();if(!i)return M.preventDefault(e);w(e,i)?(t?l.onCut():l.onCopy(),M.preventDefault(e)):(n=!0,c.value=i,c.select(),setTimeout(function(){n=!1,p(),h(),t?l.onCut():l.onCopy()}))}function _(e){C(e,!0)}function A(e){C(e,!1)}function E(e){var t=w(e);"string"==typeof t?(t&&l.onPaste(t),P.isIE&&setTimeout(h),M.preventDefault(e)):(c.value="",o=!0)}var x=!(this.getInputHandler=function(){return b}),S=function(e){b&&(e=b(e),b=null),o?(h(),e&&l.onPaste(e),o=!1):e==i.charAt(0)?x?l.execCommand("del",{source:"ace"}):l.execCommand("backspace",{source:"ace"}):(e.substring(0,2)==i?e=e.substr(2):e.charAt(0)==i.charAt(0)?e=e.substr(1):e.charAt(e.length-1)==i.charAt(0)&&(e=e.slice(0,-1)),e.charAt(e.length-1)==i.charAt(0)&&(e=e.slice(0,-1)),e&&l.onTextInput(e)),x=x&&!1};M.addCommandKeyListener(c,l.onCommandKey.bind(l)),M.addListener(c,"select",function(e){n?n=!1:f(c)?(l.selectAll(),h()):b&&h(l.selection.isEmpty())}),M.addListener(c,"input",function(e){if(!r){var t=c.value;S(t),p()}}),M.addListener(c,"cut",_),M.addListener(c,"copy",A),M.addListener(c,"paste",E),"oncut"in c&&"oncopy"in c&&"onpaste"in c||M.addListener(e,"keydown",function(e){if((!P.isMac||e.metaKey)&&e.ctrlKey)switch(e.keyCode){case 67:A(e);break;case 86:E(e);break;case 88:_(e)}});var T,D=function(e){r||!l.onCompositionStart||l.$readOnly||(r={},l.onCompositionStart(),setTimeout(k,0),l.on("mousedown",R),l.selection.isEmpty()||(l.insert(""),l.session.markUndoGroup(),l.selection.clearSelection()),l.session.markUndoGroup())},k=function(){if(r&&l.onCompositionUpdate&&!l.$readOnly){var e=c.value.replace(/\x01/g,"");if(r.lastValue!==e&&(l.onCompositionUpdate(e),r.lastValue&&l.undo(),r.lastValue=e,r.lastValue)){var t=l.selection.getRange();l.insert(r.lastValue),l.session.markUndoGroup(),r.range=l.selection.getRange(),l.selection.setRange(t),l.selection.clearSelection()}}},R=function(e){if(l.onCompositionEnd&&!l.$readOnly){var t=r;r=!1;var i=setTimeout(function(){i=null;var e=c.value.replace(/\x01/g,"");r||(e==t.lastValue?p():!t.lastValue&&e&&(p(),S(e)))});b=function(e){return i&&clearTimeout(i),(e=e.replace(/\x01/g,""))==t.lastValue?"":(t.lastValue&&i&&l.undo(),e)},l.onCompositionEnd(),l.removeListener("mousedown",R),"compositionend"==e.type&&t.range&&l.selection.setRange(t.range)}},O=L.delayedCall(k,50);function N(){clearTimeout(T),T=setTimeout(function(){u&&(c.style.cssText=u,u=""),null==l.renderer.$keepTextAreaAtCursor&&(l.renderer.$keepTextAreaAtCursor=!0,l.renderer.$moveTextAreaToCursor())},P.isOldIE?200:0)}M.addListener(c,"compositionstart",D),P.isGecko?M.addListener(c,"text",function(){O.schedule()}):(M.addListener(c,"keyup",function(){O.schedule()}),M.addListener(c,"keydown",function(){O.schedule()})),M.addListener(c,"compositionend",R),this.getElement=function(){return c},this.setReadOnly=function(e){c.readOnly=e},this.onContextMenu=function(e){x=!0,h(l.selection.isEmpty()),l._emit("nativecontextmenu",{target:l,domEvent:e}),this.moveToMouse(e,!0)},this.moveToMouse=function(e,t){if(t||!P.isOldIE){u=u||c.style.cssText,c.style.cssText=(t?"z-index:100000;":"")+"height:"+c.style.height+";"+(P.isIE?"opacity:0.1;":"");var i=l.container.getBoundingClientRect(),n=I.computedStyle(l.container),o=i.top+(parseInt(n.borderTopWidth)||0),r=i.left+(parseInt(i.borderLeftWidth)||0),a=i.bottom-o-c.clientHeight-2,s=function(e){c.style.left=e.clientX-r-2+"px",c.style.top=Math.min(e.clientY-o-2,a)+"px"};s(e),"mousedown"==e.type&&(l.renderer.$keepTextAreaAtCursor&&(l.renderer.$keepTextAreaAtCursor=null),P.isWin&&!P.isOldIE&&M.capture(l.container,s,N))}},this.onContextMenuClose=N;function F(e){l.textInput.onContextMenu(e),N()}M.addListener(l.renderer.scroller,"contextmenu",F),M.addListener(c,"contextmenu",F)}}),ace.define("ace/mouse/default_handlers",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],function(e,t,i){"use strict";e("../lib/dom"),e("../lib/event"),e("../lib/useragent");function n(t){t.$clickSelection=null;var e=t.editor;e.setDefaultHandler("mousedown",this.onMouseDown.bind(t)),e.setDefaultHandler("dblclick",this.onDoubleClick.bind(t)),e.setDefaultHandler("tripleclick",this.onTripleClick.bind(t)),e.setDefaultHandler("quadclick",this.onQuadClick.bind(t)),e.setDefaultHandler("mousewheel",this.onMouseWheel.bind(t));["select","startSelect","selectEnd","selectAllEnd","selectByWordsEnd","selectByLinesEnd","dragWait","dragWaitEnd","focusWait"].forEach(function(e){t[e]=this[e]},this),t.selectByLines=this.extendSelectionBy.bind(t,"getLineRange"),t.selectByWords=this.extendSelectionBy.bind(t,"getWordRange")}function l(e,t){if(e.start.row==e.end.row)var i=2*t.column-e.start.column-e.end.column;else if(e.start.row!=e.end.row-1||e.start.column||e.end.column)i=2*t.row-e.start.row-e.end.row;else var i=t.column-4;return i<0?{cursor:e.start,anchor:e.end}:{cursor:e.end,anchor:e.start}}(function(){this.onMouseDown=function(e){var t=e.inSelection(),i=e.getDocumentPosition();this.mousedownEvent=e;var n=this.editor;if(0===e.getButton())return this.mousedownEvent.time=Date.now(),!t||n.isFocused()||(n.focus(),!this.$focusTimout||this.$clickSelection||n.inMultiSelectMode)?(this.captureMouse(e),this.startSelect(i,1<e.domEvent._clicks),e.preventDefault()):(this.setState("focusWait"),void this.captureMouse(e));var o=n.getSelectionRange().isEmpty();return n.$blockScrolling++,o&&n.selection.moveToPosition(i),n.$blockScrolling--,void n.textInput.onContextMenu(e.domEvent)},this.startSelect=function(e,t){e=e||this.editor.renderer.screenToTextCoordinates(this.x,this.y);var i=this.editor;i.$blockScrolling++,this.mousedownEvent.getShiftKey()?i.selection.selectToPosition(e):t||i.selection.moveToPosition(e),t||this.select(),i.renderer.scroller.setCapture&&i.renderer.scroller.setCapture(),i.setStyle("ace_selecting"),this.setState("select"),i.$blockScrolling--},this.select=function(){var e,t=this.editor,i=t.renderer.screenToTextCoordinates(this.x,this.y);if(t.$blockScrolling++,this.$clickSelection){var n=this.$clickSelection.comparePoint(i);if(-1==n)e=this.$clickSelection.end;else if(1==n)e=this.$clickSelection.start;else{var o=l(this.$clickSelection,i);i=o.cursor,e=o.anchor}t.selection.setSelectionAnchor(e.row,e.column)}t.selection.selectToPosition(i),t.$blockScrolling--,t.renderer.scrollCursorIntoView()},this.extendSelectionBy=function(e){var t,i=this.editor,n=i.renderer.screenToTextCoordinates(this.x,this.y),o=i.selection[e](n.row,n.column);if(i.$blockScrolling++,this.$clickSelection){var r=this.$clickSelection.comparePoint(o.start),a=this.$clickSelection.comparePoint(o.end);if(-1==r&&a<=0)t=this.$clickSelection.end,o.end.row==n.row&&o.end.column==n.column||(n=o.start);else if(1==a&&0<=r)t=this.$clickSelection.start,o.start.row==n.row&&o.start.column==n.column||(n=o.end);else if(-1==r&&1==a)n=o.end,t=o.start;else{var s=l(this.$clickSelection,n);n=s.cursor,t=s.anchor}i.selection.setSelectionAnchor(t.row,t.column)}i.selection.selectToPosition(n),i.$blockScrolling--,i.renderer.scrollCursorIntoView()},this.selectEnd=this.selectAllEnd=this.selectByWordsEnd=this.selectByLinesEnd=function(){this.$clickSelection=null,this.editor.unsetStyle("ace_selecting"),this.editor.renderer.scroller.releaseCapture&&this.editor.renderer.scroller.releaseCapture()},this.focusWait=function(){var e=function(e,t,i,n){return Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2))}(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y),t=Date.now();(0<e||t-this.mousedownEvent.time>this.$focusTimout)&&this.startSelect(this.mousedownEvent.getDocumentPosition())},this.onDoubleClick=function(e){var t=e.getDocumentPosition(),i=this.editor,n=i.session.getBracketRange(t);n?(n.isEmpty()&&(n.start.column--,n.end.column++),this.setState("select")):(n=i.selection.getWordRange(t.row,t.column),this.setState("selectByWords")),this.$clickSelection=n,this.select()},this.onTripleClick=function(e){var t=e.getDocumentPosition(),i=this.editor;this.setState("selectByLines");var n=i.getSelectionRange();n.isMultiLine()&&n.contains(t.row,t.column)?(this.$clickSelection=i.selection.getLineRange(n.start.row),this.$clickSelection.end=i.selection.getLineRange(n.end.row).end):this.$clickSelection=i.selection.getLineRange(t.row),this.select()},this.onQuadClick=function(e){var t=this.editor;t.selectAll(),this.$clickSelection=t.getSelectionRange(),this.setState("selectAll")},this.onMouseWheel=function(e){if(!e.getAccelKey()){e.getShiftKey()&&e.wheelY&&!e.wheelX&&(e.wheelX=e.wheelY,e.wheelY=0);var t=e.domEvent.timeStamp,i=t-(this.$lastScrollTime||0),n=this.editor;return n.renderer.isScrollableBy(e.wheelX*e.speed,e.wheelY*e.speed)||i<200?(this.$lastScrollTime=t,n.renderer.scrollBy(e.wheelX*e.speed,e.wheelY*e.speed),e.stop()):void 0}}}).call(n.prototype),t.DefaultHandlers=n}),ace.define("ace/tooltip",["require","exports","module","ace/lib/oop","ace/lib/dom"],function(e,t,i){"use strict";e("./lib/oop");var n=e("./lib/dom");function o(e){this.isOpen=!1,this.$element=null,this.$parentNode=e}(function(){this.$init=function(){return this.$element=n.createElement("div"),this.$element.className="ace_tooltip",this.$element.style.display="none",this.$parentNode.appendChild(this.$element),this.$element},this.getElement=function(){return this.$element||this.$init()},this.setText=function(e){n.setInnerText(this.getElement(),e)},this.setHtml=function(e){this.getElement().innerHTML=e},this.setPosition=function(e,t){this.getElement().style.left=e+"px",this.getElement().style.top=t+"px"},this.setClassName=function(e){n.addCssClass(this.getElement(),e)},this.show=function(e,t,i){null!=e&&this.setText(e),null!=t&&null!=i&&this.setPosition(t,i),this.isOpen||(this.getElement().style.display="block",this.isOpen=!0)},this.hide=function(){this.isOpen&&(this.getElement().style.display="none",this.isOpen=!1)},this.getHeight=function(){return this.getElement().offsetHeight},this.getWidth=function(){return this.getElement().offsetWidth}}).call(o.prototype),t.Tooltip=o}),ace.define("ace/mouse/default_gutter_handler",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/event","ace/tooltip"],function(e,t,i){"use strict";var n=e("../lib/dom"),o=e("../lib/oop"),r=e("../lib/event"),a=e("../tooltip").Tooltip;function f(e){a.call(this,e)}o.inherits(f,a),function(){this.setPosition=function(e,t){var i=window.innerWidth||document.documentElement.clientWidth,n=window.innerHeight||document.documentElement.clientHeight,o=this.getWidth(),r=this.getHeight();i<(e+=15)+o&&(e-=e+o-i),n<(t+=15)+r&&(t-=20+r),a.prototype.setPosition.call(this,e,t)}}.call(f.prototype),t.GutterHandler=function(a){var i,s,l,c=a.editor,u=c.renderer.$gutterLayer,d=new f(c.container);function h(){i=i&&clearTimeout(i),l&&(d.hide(),l=null,c.removeEventListener("mousewheel",h))}function p(e){d.setPosition(e.x,e.y)}a.editor.setDefaultHandler("guttermousedown",function(e){if(c.isFocused()&&0==e.getButton()&&"foldWidgets"!=u.getRegion(e)){var t=e.getDocumentPosition().row,i=c.session.selection;if(e.getShiftKey())i.selectTo(t,0);else{if(2==e.domEvent.detail)return c.selectAll(),e.preventDefault();a.$clickSelection=c.selection.getLineRange(t)}return a.setState("selectByLines"),a.captureMouse(e),e.preventDefault()}}),a.editor.setDefaultHandler("guttermousemove",function(e){var t=e.domEvent.target||e.domEvent.srcElement;if(n.hasCssClass(t,"ace_fold-widget"))return h();l&&a.$tooltipFollowsMouse&&p(e),s=e,i=i||setTimeout(function(){i=null,s&&!a.isMousePressed?function(){var e=s.getDocumentPosition().row,t=u.$annotations[e];if(!t)return h();if(e==c.session.getLength()){var i=c.renderer.pixelToScreenCoordinates(0,s.y).row,n=s.$pos;if(i>c.session.documentToScreenRow(n.row,n.column))return h()}if(l!=t)if(l=t.text.join("<br/>"),d.setHtml(l),d.show(),c.on("mousewheel",h),a.$tooltipFollowsMouse)p(s);else{var o=u.$cells[c.session.documentToScreenRow(e,0)].element.getBoundingClientRect(),r=d.getElement().style;r.left=o.right+"px",r.top=o.bottom+"px"}}():h()},50)}),r.addListener(c.renderer.$gutter,"mouseout",function(e){s=null,l&&!i&&(i=setTimeout(function(){i=null,h()},50))}),c.on("changeSession",h)}}),ace.define("ace/mouse/mouse_event",["require","exports","module","ace/lib/event","ace/lib/useragent"],function(e,t,i){"use strict";var n=e("../lib/event"),o=e("../lib/useragent"),r=t.MouseEvent=function(e,t){this.domEvent=e,this.editor=t,this.x=this.clientX=e.clientX,this.y=this.clientY=e.clientY,this.$pos=null,this.$inSelection=null,this.propagationStopped=!1,this.defaultPrevented=!1};(function(){this.stopPropagation=function(){n.stopPropagation(this.domEvent),this.propagationStopped=!0},this.preventDefault=function(){n.preventDefault(this.domEvent),this.defaultPrevented=!0},this.stop=function(){this.stopPropagation(),this.preventDefault()},this.getDocumentPosition=function(){return this.$pos||(this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,this.clientY)),this.$pos},this.inSelection=function(){if(null!==this.$inSelection)return this.$inSelection;var e=this.editor.getSelectionRange();if(e.isEmpty())this.$inSelection=!1;else{var t=this.getDocumentPosition();this.$inSelection=e.contains(t.row,t.column)}return this.$inSelection},this.getButton=function(){return n.getButton(this.domEvent)},this.getShiftKey=function(){return this.domEvent.shiftKey},this.getAccelKey=o.isMac?function(){return this.domEvent.metaKey}:function(){return this.domEvent.ctrlKey}}).call(r.prototype)}),ace.define("ace/mouse/dragdrop_handler",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],function(e,t,i){"use strict";var A=e("../lib/dom"),E=e("../lib/event"),x=e("../lib/useragent");function n(t){var p=t.editor,n=A.createElement("img");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",x.isOpera&&(n.style.cssText="width:1px;height:1px;position:fixed;top:0;left:0;z-index:2147483647;opacity:0;");["dragWait","dragWaitEnd","startDrag","dragReadyEnd","onMouseDrag"].forEach(function(e){t[e]=this[e]},this),p.addEventListener("mousedown",this.onMouseDown.bind(t));var i,f,g,e,o,r,a,s,m,l,c,u=p.container,d=0;function h(){var e=r;(function(e,t){var i=Date.now(),n=!t||e.row!=t.row,o=!t||e.column!=t.column;!l||n||o?(p.$blockScrolling+=1,p.moveCursorToPosition(e),p.$blockScrolling-=1,l=i,c={x:f,y:g}):5<S(c.x,c.y,f,g)?l=null:200<=i-l&&(p.renderer.scrollCursorIntoView(),l=null)})(r=p.renderer.screenToTextCoordinates(f,g),e),function(e,t){var i=Date.now(),n=p.renderer.layerConfig.lineHeight,o=p.renderer.layerConfig.characterWidth,r=p.renderer.scroller.getBoundingClientRect(),a={x:{left:f-r.left,right:r.right-f},y:{top:g-r.top,bottom:r.bottom-g}},s=Math.min(a.x.left,a.x.right),l=Math.min(a.y.top,a.y.bottom),c={row:e.row,column:e.column};s/o<=2&&(c.column+=a.x.left<a.x.right?-3:2),l/n<=1&&(c.row+=a.y.top<a.y.bottom?-1:1);var u=e.row!=c.row,d=e.column!=c.column,h=!t||e.row!=t.row;u||d&&!h?m?200<=i-m&&p.renderer.scrollCursorIntoView(c):m=i:m=null}(r,e)}function v(){o=p.selection.toOrientedRange(),i=p.session.addMarker(o,"ace_selection",p.getSelectionStyle()),p.clearSelection(),p.isFocused()&&p.renderer.$cursorLayer.setBlinking(!1),clearInterval(e),h(),e=setInterval(h,20),d=0,E.addListener(document,"mousemove",w)}function y(){clearInterval(e),p.session.removeMarker(i),i=null,p.$blockScrolling+=1,p.selection.fromOrientedRange(o),p.$blockScrolling-=1,p.isFocused()&&!s&&p.renderer.$cursorLayer.setBlinking(!p.getReadOnly()),d=0,l=m=r=o=null,E.removeListener(document,"mousemove",w)}this.onDragStart=function(e){if(this.cancelDrag||!u.draggable){var t=this;return setTimeout(function(){t.startSelect(),t.captureMouse(e)},0),e.preventDefault()}o=p.getSelectionRange();var i=e.dataTransfer;i.effectAllowed=p.getReadOnly()?"copy":"copyMove",x.isOpera&&(p.container.appendChild(n),n.scrollTop=0),i.setDragImage&&i.setDragImage(n,0,0),x.isOpera&&p.container.removeChild(n),i.clearData(),i.setData("Text",p.session.getTextRange()),s=!0,this.setState("drag")},this.onDragEnd=function(e){if(u.draggable=!1,s=!1,this.setState(null),!p.getReadOnly()){var t=e.dataTransfer.dropEffect;a||"move"!=t||p.session.remove(p.getSelectionRange()),p.renderer.$cursorLayer.setBlinking(!0)}this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle("")},this.onDragEnter=function(e){if(!p.getReadOnly()&&C(e.dataTransfer))return f=e.clientX,g=e.clientY,i||v(),d++,e.dataTransfer.dropEffect=a=_(e),E.preventDefault(e)},this.onDragOver=function(e){if(!p.getReadOnly()&&C(e.dataTransfer))return f=e.clientX,g=e.clientY,i||(v(),d++),null!==b&&(b=null),e.dataTransfer.dropEffect=a=_(e),E.preventDefault(e)},this.onDragLeave=function(e){if(--d<=0&&i)return y(),a=null,E.preventDefault(e)},this.onDrop=function(e){if(r){var t=e.dataTransfer;if(s)switch(a){case"move":o=o.contains(r.row,r.column)?{start:r,end:r}:p.moveText(o,r);break;case"copy":o=p.moveText(o,r,!0)}else{var i=t.getData("Text");o={start:r,end:p.session.insert(r,i)},p.focus(),a=null}return y(),E.preventDefault(e)}},E.addListener(u,"dragstart",this.onDragStart.bind(t)),E.addListener(u,"dragend",this.onDragEnd.bind(t)),E.addListener(u,"dragenter",this.onDragEnter.bind(t)),E.addListener(u,"dragover",this.onDragOver.bind(t)),E.addListener(u,"dragleave",this.onDragLeave.bind(t)),E.addListener(u,"drop",this.onDrop.bind(t));var b=null;function w(){null==b&&(b=setTimeout(function(){null!=b&&i&&y()},20))}function C(e){var t=e.types;return!t||Array.prototype.some.call(t,function(e){return"text/plain"==e||"Text"==e})}function _(e){var t=["copy","copymove","all","uninitialized"],i=x.isMac?e.altKey:e.ctrlKey,n="uninitialized";try{n=e.dataTransfer.effectAllowed.toLowerCase()}catch(e){}var o="none";return i&&0<=t.indexOf(n)?o="copy":0<=["move","copymove","linkmove","all","uninitialized"].indexOf(n)?o="move":0<=t.indexOf(n)&&(o="copy"),o}}function S(e,t,i,n){return Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2))}(function(){this.dragWait=function(){Date.now()-this.mousedownEvent.time>this.editor.getDragDelay()&&this.startDrag()},this.dragWaitEnd=function(){this.editor.container.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()),this.selectEnd()},this.dragReadyEnd=function(e){this.editor.renderer.$cursorLayer.setBlinking(!this.editor.getReadOnly()),this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle(""),this.dragWaitEnd()},this.startDrag=function(){this.cancelDrag=!1;var e=this.editor;e.container.draggable=!0,e.renderer.$cursorLayer.setBlinking(!1),e.setStyle("ace_dragging");var t=x.isWin?"default":"move";e.renderer.setCursorStyle(t),this.setState("dragReady")},this.onMouseDrag=function(e){var t=this.editor.container;x.isIE&&"dragReady"==this.state&&3<S(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)&&t.dragDrop();"dragWait"===this.state&&0<S(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)&&(t.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()))},this.onMouseDown=function(e){if(this.$dragEnabled){this.mousedownEvent=e;var t=this.editor,i=e.inSelection(),n=e.getButton();if(1===(e.domEvent.detail||1)&&0===n&&i){if(e.editor.inMultiSelectMode&&(e.getAccelKey()||e.getShiftKey()))return;this.mousedownEvent.time=Date.now();var o=e.domEvent.target||e.domEvent.srcElement;if("unselectable"in o&&(o.unselectable="on"),t.getDragDelay()){if(x.isWebKit)this.cancelDrag=!0,t.container.draggable=!0;this.setState("dragWait")}else this.startDrag();this.captureMouse(e,this.onMouseDrag.bind(this)),e.defaultPrevented=!0}}}}).call(n.prototype),t.DragdropHandler=n}),ace.define("ace/lib/net",["require","exports","module","ace/lib/dom"],function(e,t,i){"use strict";var o=e("./dom");t.get=function(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.onreadystatechange=function(){4===i.readyState&&t(i.responseText)},i.send(null)},t.loadScript=function(e,i){var t=o.getDocumentHead(),n=document.createElement("script");n.src=e,t.appendChild(n),n.onload=n.onreadystatechange=function(e,t){!t&&n.readyState&&"loaded"!=n.readyState&&"complete"!=n.readyState||(n=n.onload=n.onreadystatechange=null,t||i())}},t.qualifyURL=function(e){var t=document.createElement("a");return t.href=e,t.href}}),ace.define("ace/lib/event_emitter",["require","exports","module"],function(e,t,i){"use strict";function r(){this.propagationStopped=!0}function a(){this.defaultPrevented=!0}var n={};n._emit=n._dispatchEvent=function(e,t){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var i=this._eventRegistry[e]||[],n=this._defaultHandlers[e];if(i.length||n){"object"==typeof t&&t||(t={}),t.type||(t.type=e),t.stopPropagation||(t.stopPropagation=r),t.preventDefault||(t.preventDefault=a),i=i.slice();for(var o=0;o<i.length&&(i[o](t,this),!t.propagationStopped);o++);return n&&!t.defaultPrevented?n(t,this):void 0}},n._signal=function(e,t){var i=(this._eventRegistry||{})[e];if(i){i=i.slice();for(var n=0;n<i.length;n++)i[n](t,this)}},n.once=function(t,i){var n=this;i&&this.addEventListener(t,function e(){n.removeEventListener(t,e),i.apply(null,arguments)})},n.setDefaultHandler=function(e,t){var i=this._defaultHandlers;if((i=i||(this._defaultHandlers={_disabled_:{}}))[e]){var n=i[e],o=i._disabled_[e];o||(i._disabled_[e]=o=[]),o.push(n);var r=o.indexOf(t);-1!=r&&o.splice(r,1)}i[e]=t},n.removeDefaultHandler=function(e,t){var i=this._defaultHandlers;if(i){var n=i._disabled_[e];if(i[e]==t){i[e];n&&this.setDefaultHandler(e,n.pop())}else if(n){var o=n.indexOf(t);-1!=o&&n.splice(o,1)}}},n.on=n.addEventListener=function(e,t,i){this._eventRegistry=this._eventRegistry||{};var n=this._eventRegistry[e];return-1==(n=n||(this._eventRegistry[e]=[])).indexOf(t)&&n[i?"unshift":"push"](t),t},n.off=n.removeListener=n.removeEventListener=function(e,t){this._eventRegistry=this._eventRegistry||{};var i=this._eventRegistry[e];if(i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}},n.removeAllListeners=function(e){this._eventRegistry&&(this._eventRegistry[e]=[])},t.EventEmitter=n}),ace.define("ace/lib/app_config",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(e,t,i){var o=e("./oop"),n=e("./event_emitter").EventEmitter,r={setOptions:function(t){Object.keys(t).forEach(function(e){this.setOption(e,t[e])},this)},getOptions:function(e){var t={};return e?Array.isArray(e)||(t=e,e=Object.keys(t)):e=Object.keys(this.$options),e.forEach(function(e){t[e]=this.getOption(e)},this),t},setOption:function(e,t){if(this["$"+e]!==t){var i=this.$options[e];if(!i)return a('misspelled option "'+e+'"');if(i.forwardTo)return this[i.forwardTo]&&this[i.forwardTo].setOption(e,t);i.handlesSet||(this["$"+e]=t),i&&i.set&&i.set.call(this,t)}},getOption:function(e){var t=this.$options[e];return t?t.forwardTo?this[t.forwardTo]&&this[t.forwardTo].getOption(e):t&&t.get?t.get.call(this):this["$"+e]:a('misspelled option "'+e+'"')}};function a(e){"undefined"!=typeof console&&console.warn&&console.warn.apply(console,arguments)}function s(e,t){var i=new Error(e);i.data=t,"object"==typeof console&&console.error&&console.error(i),setTimeout(function(){throw i})}function l(){this.$defaultOptions={}}(function(){o.implement(this,n),this.defineOptions=function(i,e,n){return i.$options||(this.$defaultOptions[e]=i.$options={}),Object.keys(n).forEach(function(e){var t=n[e];"string"==typeof t&&(t={forwardTo:t}),t.name||(t.name=e),"initialValue"in(i.$options[t.name]=t)&&(i["$"+t.name]=t.initialValue)}),o.implement(i,r),this},this.resetOptions=function(i){Object.keys(i.$options).forEach(function(e){var t=i.$options[e];"value"in t&&i.setOption(e,t.value)})},this.setDefaultValue=function(e,t,i){var n=this.$defaultOptions[e]||(this.$defaultOptions[e]={});n[t]&&(n.forwardTo?this.setDefaultValue(n.forwardTo,t,i):n[t].value=i)},this.setDefaultValues=function(t,i){Object.keys(i).forEach(function(e){this.setDefaultValue(t,e,i[e])},this)},this.warn=a,this.reportError=s}).call(l.prototype),t.AppConfig=l}),ace.define("ace/config",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/lib/net","ace/lib/app_config"],function(f,g,m){var e=f("./lib/lang"),r=(f("./lib/oop"),f("./lib/net")),t=f("./lib/app_config").AppConfig;m.exports=g=new t;var v=function(){return this}(),y={packaged:!1,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{}};function i(e){if(y.packaged=e||f.packaged||m.packaged||v.define&&define.packaged,!v.document)return"";for(var t={},i="",n=document.currentScript||document._currentScript,o=(n&&n.ownerDocument||document).getElementsByTagName("script"),r=0;r<o.length;r++){var a=o[r],s=a.src||a.getAttribute("src");if(s){for(var l=a.attributes,c=0,u=l.length;c<u;c++){var d=l[c];0===d.name.indexOf("data-ace-")&&(t[d.name.replace(/^data-ace-/,"").replace(/-(.)/g,function(e,t){return t.toUpperCase()})]=d.value)}var h=s.match(/^(.*)\/ace(\-\w+)?\.js(\?|$)/);h&&(i=h[1])}}for(var p in i&&(t.base=t.base||i,t.packaged=!0),t.basePath=t.base,t.workerPath=t.workerPath||t.base,t.modePath=t.modePath||t.base,t.themePath=t.themePath||t.base,delete t.base,t)void 0!==t[p]&&g.set(p,t[p])}g.get=function(e){if(!y.hasOwnProperty(e))throw new Error("Unknown config key: "+e);return y[e]},g.set=function(e,t){if(!y.hasOwnProperty(e))throw new Error("Unknown config key: "+e);y[e]=t},g.all=function(){return e.copyObject(y)},g.moduleUrl=function(e,t){if(y.$moduleUrls[e])return y.$moduleUrls[e];var i=e.split("/"),n="snippets"==(t=t||i[i.length-2]||"")?"/":"-",o=i[i.length-1];if("worker"==t&&"-"==n){var r=new RegExp("^"+t+"[\\-_]|[\\-_]"+t+"$","g");o=o.replace(r,"")}(!o||o==t)&&1<i.length&&(o=i[i.length-2]);var a=y[t+"Path"];return null==a?a=y.basePath:"/"==n&&(t=n=""),a&&"/"!=a.slice(-1)&&(a+="/"),a+t+n+o+this.get("suffix")},g.setModuleUrl=function(e,t){return y.$moduleUrls[e]=t},g.$loading={},g.loadModule=function(i,e){var t,n;Array.isArray(i)&&(n=i[0],i=i[1]);try{t=f(i)}catch(e){}if(t&&!g.$loading[i])return e&&e(t);if(g.$loading[i]||(g.$loading[i]=[]),g.$loading[i].push(e),!(1<g.$loading[i].length)){function o(){f([i],function(t){g._emit("load.module",{name:i,module:t});var e=g.$loading[i];g.$loading[i]=null,e.forEach(function(e){e&&e(t)})})}if(!g.get("packaged"))return o();r.loadScript(g.moduleUrl(i,n),o)}},i(!0),g.init=i}),ace.define("ace/mouse/mouse_handler",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/mouse/default_handlers","ace/mouse/default_gutter_handler","ace/mouse/mouse_event","ace/mouse/dragdrop_handler","ace/config"],function(e,t,i){"use strict";function n(o){var r=this;function e(e){document.hasFocus&&document.hasFocus()||window.focus(),o.focus()}this.editor=o,new a(this),new s(this),new d(this);var t=o.renderer.getMouseEventTarget();l.addListener(t,"click",this.onMouseEvent.bind(this,"click")),l.addListener(t,"mousemove",this.onMouseMove.bind(this,"mousemove")),l.addMultiMouseDownListener(t,[400,300,250],this,"onMouseEvent"),o.renderer.scrollBarV&&(l.addMultiMouseDownListener(o.renderer.scrollBarV.inner,[400,300,250],this,"onMouseEvent"),l.addMultiMouseDownListener(o.renderer.scrollBarH.inner,[400,300,250],this,"onMouseEvent"),c.isIE&&(l.addListener(o.renderer.scrollBarV.element,"mousedown",e),l.addListener(o.renderer.scrollBarH.element,"mousedown",e))),l.addMouseWheelListener(o.container,this.onMouseWheel.bind(this,"mousewheel"));var i=o.renderer.$gutter;l.addListener(i,"mousedown",this.onMouseEvent.bind(this,"guttermousedown")),l.addListener(i,"click",this.onMouseEvent.bind(this,"gutterclick")),l.addListener(i,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick")),l.addListener(i,"mousemove",this.onMouseEvent.bind(this,"guttermousemove")),l.addListener(t,"mousedown",e),l.addListener(i,"mousedown",function(e){return o.focus(),l.preventDefault(e)}),o.on("mousemove",function(e){if(!r.state&&!r.$dragDelay&&r.$dragEnabled){var t=o.renderer.screenToTextCoordinates(e.x,e.y),i=o.session.selection.getRange(),n=o.renderer;!i.isEmpty()&&i.insideStart(t.row,t.column)?n.setCursorStyle("default"):n.setCursorStyle("")}})}var l=e("../lib/event"),c=e("../lib/useragent"),a=e("./default_handlers").DefaultHandlers,s=e("./default_gutter_handler").GutterHandler,u=e("./mouse_event").MouseEvent,d=e("./dragdrop_handler").DragdropHandler,o=e("../config");(function(){this.onMouseEvent=function(e,t){this.editor._emit(e,new u(t,this.editor))},this.onMouseMove=function(e,t){var i=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;i&&i.length&&this.editor._emit(e,new u(t,this.editor))},this.onMouseWheel=function(e,t){var i=new u(t,this.editor);i.speed=2*this.$scrollSpeed,i.wheelX=t.wheelX,i.wheelY=t.wheelY,this.editor._emit(e,i)},this.setState=function(e){this.state=e},this.captureMouse=function(e,t){this.x=e.x,this.y=e.y,this.isMousePressed=!0;var i=this.editor.renderer;i.$keepTextAreaAtCursor&&(i.$keepTextAreaAtCursor=null);function n(e){if(e){if(c.isWebKit&&!e.which&&r.releaseMouse)return r.releaseMouse();r.x=e.clientX,r.y=e.clientY,t&&t(e),r.mouseEvent=new u(e,r.editor),r.$mouseMoved=!0}}function o(e){clearInterval(s),a(),r[r.state+"End"]&&r[r.state+"End"](e),r.state="",null==i.$keepTextAreaAtCursor&&(i.$keepTextAreaAtCursor=!0,i.$moveTextAreaToCursor()),r.isMousePressed=!1,r.$onCaptureMouseMove=r.releaseMouse=null,e&&r.onMouseEvent("mouseup",e)}var r=this,a=function(){r[r.state]&&r[r.state](),r.$mouseMoved=!1};if(c.isOldIE&&"dblclick"==e.domEvent.type)return setTimeout(function(){o(e)});r.$onCaptureMouseMove=n,r.releaseMouse=l.capture(this.editor.container,n,o);var s=setInterval(a,20)},this.releaseMouse=null,this.cancelContextMenu=function(){var t=function(e){e&&e.domEvent&&"contextmenu"!=e.domEvent.type||(this.editor.off("nativecontextmenu",t),e&&e.domEvent&&l.stopEvent(e.domEvent))}.bind(this);setTimeout(t,10),this.editor.on("nativecontextmenu",t)}}).call(n.prototype),o.defineOptions(n.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:c.isMac?150:0},dragEnabled:{initialValue:!0},focusTimout:{initialValue:0},tooltipFollowsMouse:{initialValue:!0}}),t.MouseHandler=n}),ace.define("ace/mouse/fold_handler",["require","exports","module"],function(e,t,i){"use strict";t.FoldHandler=function(a){a.on("click",function(e){var t=e.getDocumentPosition(),i=a.session,n=i.getFoldAt(t.row,t.column,1);n&&(e.getAccelKey()?i.removeFold(n):i.expandFold(n),e.stop())}),a.on("gutterclick",function(e){if("foldWidgets"==a.renderer.$gutterLayer.getRegion(e)){var t=e.getDocumentPosition().row,i=a.session;i.foldWidgets&&i.foldWidgets[t]&&a.session.onFoldWidgetClick(t,e),a.isFocused()||a.focus(),e.stop()}}),a.on("gutterdblclick",function(e){if("foldWidgets"==a.renderer.$gutterLayer.getRegion(e)){var t=e.getDocumentPosition().row,i=a.session,n=i.getParentFoldRangeData(t,!0),o=n.range||n.firstRange;if(o){t=o.start.row;var r=i.getFoldAt(t,i.getLine(t).length,1);r?i.removeFold(r):(i.addFold("...",o),a.renderer.scrollCursorIntoView({row:o.start.row,column:0}))}e.stop()}})}}),ace.define("ace/keyboard/keybinding",["require","exports","module","ace/lib/keys","ace/lib/event"],function(e,t,i){"use strict";function n(e){this.$editor=e,this.$data={editor:e},this.$handlers=[],this.setDefaultHandler(e.commands)}var o=e("../lib/keys"),l=e("../lib/event");(function(){this.setDefaultHandler=function(e){this.removeKeyboardHandler(this.$defaultHandler),this.$defaultHandler=e,this.addKeyboardHandler(e,0)},this.setKeyboardHandler=function(e){var t=this.$handlers;if(t[t.length-1]!=e){for(;t[t.length-1]&&t[t.length-1]!=this.$defaultHandler;)this.removeKeyboardHandler(t[t.length-1]);this.addKeyboardHandler(e,1)}},this.addKeyboardHandler=function(e,t){if(e){"function"!=typeof e||e.handleKeyboard||(e.handleKeyboard=e);var i=this.$handlers.indexOf(e);-1!=i&&this.$handlers.splice(i,1),null==t?this.$handlers.push(e):this.$handlers.splice(t,0,e),-1==i&&e.attach&&e.attach(this.$editor)}},this.removeKeyboardHandler=function(e){var t=this.$handlers.indexOf(e);return-1!=t&&(this.$handlers.splice(t,1),e.detach&&e.detach(this.$editor),!0)},this.getKeyboardHandler=function(){return this.$handlers[this.$handlers.length-1]},this.getStatusText=function(){var t=this.$data,i=t.editor;return this.$handlers.map(function(e){return e.getStatusText&&e.getStatusText(i,t)||""}).filter(Boolean).join(" ")},this.$callKeyboardHandlers=function(e,t,i,n){for(var o,r=!1,a=this.$editor.commands,s=this.$handlers.length;s--&&!((o=this.$handlers[s].handleKeyboard(this.$data,e,t,i,n))&&o.command&&((r="null"==o.command||a.exec(o.command,this.$editor,o.args,n))&&n&&-1!=e&&1!=o.passEvent&&1!=o.command.passEvent&&l.stopEvent(n),r)););return r},this.onCommandKey=function(e,t,i){var n=o.keyCodeToString(i);this.$callKeyboardHandlers(t,n,i,e)},this.onTextInput=function(e){this.$callKeyboardHandlers(-1,e)||this.$editor.commands.exec("insertstring",this.$editor,e)}}).call(n.prototype),t.KeyBinding=n}),ace.define("ace/range",["require","exports","module"],function(e,t,i){"use strict";function r(e,t,i,n){this.start={row:e,column:t},this.end={row:i,column:n}}(function(){this.isEqual=function(e){return this.start.row===e.start.row&&this.end.row===e.end.row&&this.start.column===e.start.column&&this.end.column===e.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(e,t){return 0==this.compare(e,t)},this.compareRange=function(e){var t,i=e.end,n=e.start;return 1==(t=this.compare(i.row,i.column))?1==(t=this.compare(n.row,n.column))?2:0==t?1:0:-1==t?-2:-1==(t=this.compare(n.row,n.column))?-1:1==t?42:0},this.comparePoint=function(e){return this.compare(e.row,e.column)},this.containsRange=function(e){return 0==this.comparePoint(e.start)&&0==this.comparePoint(e.end)},this.intersects=function(e){var t=this.compareRange(e);return-1==t||0==t||1==t},this.isEnd=function(e,t){return this.end.row==e&&this.end.column==t},this.isStart=function(e,t){return this.start.row==e&&this.start.column==t},this.setStart=function(e,t){"object"==typeof e?(this.start.column=e.column,this.start.row=e.row):(this.start.row=e,this.start.column=t)},this.setEnd=function(e,t){"object"==typeof e?(this.end.column=e.column,this.end.row=e.row):(this.end.row=e,this.end.column=t)},this.inside=function(e,t){return 0==this.compare(e,t)&&(!this.isEnd(e,t)&&!this.isStart(e,t))},this.insideStart=function(e,t){return 0==this.compare(e,t)&&!this.isEnd(e,t)},this.insideEnd=function(e,t){return 0==this.compare(e,t)&&!this.isStart(e,t)},this.compare=function(e,t){return this.isMultiLine()||e!==this.start.row?e<this.start.row?-1:e>this.end.row?1:this.start.row===e?t>=this.start.column?0:-1:this.end.row===e?t<=this.end.column?0:1:0:t<this.start.column?-1:t>this.end.column?1:0},this.compareStart=function(e,t){return this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.compareEnd=function(e,t){return this.end.row==e&&this.end.column==t?1:this.compare(e,t)},this.compareInside=function(e,t){return this.end.row==e&&this.end.column==t?1:this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.clipRows=function(e,t){if(this.end.row>t)var i={row:t+1,column:0};else if(this.end.row<e)i={row:e,column:0};if(this.start.row>t)var n={row:t+1,column:0};else if(this.start.row<e)n={row:e,column:0};return r.fromPoints(n||this.start,i||this.end)},this.extend=function(e,t){var i=this.compare(e,t);if(0==i)return this;if(-1==i)var n={row:e,column:t};else var o={row:e,column:t};return r.fromPoints(n||this.start,o||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return r.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new r(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new r(this.start.row,0,this.end.row,0)},this.toScreenRange=function(e){var t=e.documentToScreenPosition(this.start),i=e.documentToScreenPosition(this.end);return new r(t.row,t.column,i.row,i.column)},this.moveBy=function(e,t){this.start.row+=e,this.start.column+=t,this.end.row+=e,this.end.column+=t}}).call(r.prototype),r.fromPoints=function(e,t){return new r(e.row,e.column,t.row,t.column)},r.comparePoints=function(e,t){return e.row-t.row||e.column-t.column},r.comparePoints=function(e,t){return e.row-t.row||e.column-t.column},t.Range=r}),ace.define("ace/selection",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter","ace/range"],function(e,t,i){"use strict";function n(e){this.session=e,this.doc=e.getDocument(),this.clearSelection(),this.lead=this.selectionLead=this.doc.createAnchor(0,0),this.anchor=this.selectionAnchor=this.doc.createAnchor(0,0);var t=this;this.lead.on("change",function(e){t._emit("changeCursor"),t.$isEmpty||t._emit("changeSelection"),t.$keepDesiredColumnOnChange||e.old.column==e.value.column||(t.$desiredColumn=null)}),this.selectionAnchor.on("change",function(){t.$isEmpty||t._emit("changeSelection")})}var o=e("./lib/oop"),a=e("./lib/lang"),r=e("./lib/event_emitter").EventEmitter,s=e("./range").Range;(function(){o.implement(this,r),this.isEmpty=function(){return this.$isEmpty||this.anchor.row==this.lead.row&&this.anchor.column==this.lead.column},this.isMultiLine=function(){return!this.isEmpty()&&this.getRange().isMultiLine()},this.getCursor=function(){return this.lead.getPosition()},this.setSelectionAnchor=function(e,t){this.anchor.setPosition(e,t),this.$isEmpty&&(this.$isEmpty=!1,this._emit("changeSelection"))},this.getSelectionAnchor=function(){return this.$isEmpty?this.getSelectionLead():this.anchor.getPosition()},this.getSelectionLead=function(){return this.lead.getPosition()},this.shiftSelection=function(e){if(this.$isEmpty)this.moveCursorTo(this.lead.row,this.lead.column+e);else{var t=this.getSelectionAnchor(),i=this.getSelectionLead(),n=this.isBackwards();n&&0===t.column||this.setSelectionAnchor(t.row,t.column+e),!n&&0===i.column||this.$moveSelection(function(){this.moveCursorTo(i.row,i.column+e)})}},this.isBackwards=function(){var e=this.anchor,t=this.lead;return e.row>t.row||e.row==t.row&&e.column>t.column},this.getRange=function(){var e=this.anchor,t=this.lead;return this.isEmpty()?s.fromPoints(t,t):this.isBackwards()?s.fromPoints(t,e):s.fromPoints(e,t)},this.clearSelection=function(){this.$isEmpty||(this.$isEmpty=!0,this._emit("changeSelection"))},this.selectAll=function(){var e=this.doc.getLength()-1;this.setSelectionAnchor(0,0),this.moveCursorTo(e,this.doc.getLine(e).length)},this.setRange=this.setSelectionRange=function(e,t){t?(this.setSelectionAnchor(e.end.row,e.end.column),this.selectTo(e.start.row,e.start.column)):(this.setSelectionAnchor(e.start.row,e.start.column),this.selectTo(e.end.row,e.end.column)),this.getRange().isEmpty()&&(this.$isEmpty=!0),this.$desiredColumn=null},this.$moveSelection=function(e){var t=this.lead;this.$isEmpty&&this.setSelectionAnchor(t.row,t.column),e.call(this)},this.selectTo=function(e,t){this.$moveSelection(function(){this.moveCursorTo(e,t)})},this.selectToPosition=function(e){this.$moveSelection(function(){this.moveCursorToPosition(e)})},this.moveTo=function(e,t){this.clearSelection(),this.moveCursorTo(e,t)},this.moveToPosition=function(e){this.clearSelection(),this.moveCursorToPosition(e)},this.selectUp=function(){this.$moveSelection(this.moveCursorUp)},this.selectDown=function(){this.$moveSelection(this.moveCursorDown)},this.selectRight=function(){this.$moveSelection(this.moveCursorRight)},this.selectLeft=function(){this.$moveSelection(this.moveCursorLeft)},this.selectLineStart=function(){this.$moveSelection(this.moveCursorLineStart)},this.selectLineEnd=function(){this.$moveSelection(this.moveCursorLineEnd)},this.selectFileEnd=function(){this.$moveSelection(this.moveCursorFileEnd)},this.selectFileStart=function(){this.$moveSelection(this.moveCursorFileStart)},this.selectWordRight=function(){this.$moveSelection(this.moveCursorWordRight)},this.selectWordLeft=function(){this.$moveSelection(this.moveCursorWordLeft)},this.getWordRange=function(e,t){if(void 0===t){var i=e||this.lead;e=i.row,t=i.column}return this.session.getWordRange(e,t)},this.selectWord=function(){this.setSelectionRange(this.getWordRange())},this.selectAWord=function(){var e=this.getCursor(),t=this.session.getAWordRange(e.row,e.column);this.setSelectionRange(t)},this.getLineRange=function(e,t){var i,n="number"==typeof e?e:this.lead.row,o=this.session.getFoldLine(n);return i=o?(n=o.start.row,o.end.row):n,!0===t?new s(n,0,i,this.session.getLine(i).length):new s(n,0,i+1,0)},this.selectLine=function(){this.setSelectionRange(this.getLineRange())},this.moveCursorUp=function(){this.moveCursorBy(-1,0)},this.moveCursorDown=function(){this.moveCursorBy(1,0)},this.moveCursorLeft=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,-1))this.moveCursorTo(e.start.row,e.start.column);else if(0===t.column)0<t.row&&this.moveCursorTo(t.row-1,this.doc.getLine(t.row-1).length);else{var i=this.session.getTabSize();this.session.isTabStop(t)&&this.doc.getLine(t.row).slice(t.column-i,t.column).split(" ").length-1==i?this.moveCursorBy(0,-i):this.moveCursorBy(0,-1)}},this.moveCursorRight=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,1))this.moveCursorTo(e.end.row,e.end.column);else if(this.lead.column==this.doc.getLine(this.lead.row).length)this.lead.row<this.doc.getLength()-1&&this.moveCursorTo(this.lead.row+1,0);else{var i=this.session.getTabSize();t=this.lead;this.session.isTabStop(t)&&this.doc.getLine(t.row).slice(t.column,t.column+i).split(" ").length-1==i?this.moveCursorBy(0,i):this.moveCursorBy(0,1)}},this.moveCursorLineStart=function(){var e=this.lead.row,t=this.lead.column,i=this.session.documentToScreenRow(e,t),n=this.session.screenToDocumentPosition(i,0),o=this.session.getDisplayLine(e,null,n.row,n.column).match(/^\s*/);o[0].length==t||this.session.$useEmacsStyleLineStart||(n.column+=o[0].length),this.moveCursorToPosition(n)},this.moveCursorLineEnd=function(){var e=this.lead,t=this.session.getDocumentLastRowColumnPosition(e.row,e.column);if(this.lead.column==t.column){var i=this.session.getLine(t.row);if(t.column==i.length){var n=i.search(/\s+$/);0<n&&(t.column=n)}}this.moveCursorTo(t.row,t.column)},this.moveCursorFileEnd=function(){var e=this.doc.getLength()-1,t=this.doc.getLine(e).length;this.moveCursorTo(e,t)},this.moveCursorFileStart=function(){this.moveCursorTo(0,0)},this.moveCursorLongWordRight=function(){var e=this.lead.row,t=this.lead.column,i=this.doc.getLine(e),n=i.substring(t);this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0;var o=this.session.getFoldAt(e,t,1);if(o)this.moveCursorTo(o.end.row,o.end.column);else{if(this.session.nonTokenRe.exec(n)&&(t+=this.session.nonTokenRe.lastIndex,this.session.nonTokenRe.lastIndex=0,n=i.substring(t)),t>=i.length)return this.moveCursorTo(e,i.length),this.moveCursorRight(),void(e<this.doc.getLength()-1&&this.moveCursorWordRight());this.session.tokenRe.exec(n)&&(t+=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(e,t)}},this.moveCursorLongWordLeft=function(){var e,t=this.lead.row,i=this.lead.column;if(e=this.session.getFoldAt(t,i,-1))this.moveCursorTo(e.start.row,e.start.column);else{var n=this.session.getFoldStringAt(t,i,-1);null==n&&(n=this.doc.getLine(t).substring(0,i));var o=a.stringReverse(n);if(this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0,this.session.nonTokenRe.exec(o)&&(i-=this.session.nonTokenRe.lastIndex,o=o.slice(this.session.nonTokenRe.lastIndex),this.session.nonTokenRe.lastIndex=0),i<=0)return this.moveCursorTo(t,0),this.moveCursorLeft(),void(0<t&&this.moveCursorWordLeft());this.session.tokenRe.exec(o)&&(i-=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(t,i)}},this.$shortWordEndIndex=function(e){var t,i=0,n=/\s/,o=this.session.tokenRe;if(o.lastIndex=0,this.session.tokenRe.exec(e))i=this.session.tokenRe.lastIndex;else{for(;(t=e[i])&&n.test(t);)i++;if(i<1)for(o.lastIndex=0;(t=e[i])&&!o.test(t);)if(o.lastIndex=0,i++,n.test(t)){if(2<i){i--;break}for(;(t=e[i])&&n.test(t);)i++;if(2<i)break}}return o.lastIndex=0,i},this.moveCursorShortWordRight=function(){var e=this.lead.row,t=this.lead.column,i=this.doc.getLine(e),n=i.substring(t),o=this.session.getFoldAt(e,t,1);if(o)return this.moveCursorTo(o.end.row,o.end.column);if(t==i.length){for(var r=this.doc.getLength();e++,n=this.doc.getLine(e),e<r&&/^\s*$/.test(n););/^\s+/.test(n)||(n=""),t=0}var a=this.$shortWordEndIndex(n);this.moveCursorTo(e,t+a)},this.moveCursorShortWordLeft=function(){var e,t=this.lead.row,i=this.lead.column;if(e=this.session.getFoldAt(t,i,-1))return this.moveCursorTo(e.start.row,e.start.column);var n=this.session.getLine(t).substring(0,i);if(0===i){for(;t--,n=this.doc.getLine(t),0<t&&/^\s*$/.test(n););i=n.length,/\s+$/.test(n)||(n="")}var o=a.stringReverse(n),r=this.$shortWordEndIndex(o);return this.moveCursorTo(t,i-r)},this.moveCursorWordRight=function(){this.session.$selectLongWords?this.moveCursorLongWordRight():this.moveCursorShortWordRight()},this.moveCursorWordLeft=function(){this.session.$selectLongWords?this.moveCursorLongWordLeft():this.moveCursorShortWordLeft()},this.moveCursorBy=function(e,t){var i=this.session.documentToScreenPosition(this.lead.row,this.lead.column);0===t&&(this.$desiredColumn?i.column=this.$desiredColumn:this.$desiredColumn=i.column);var n=this.session.screenToDocumentPosition(i.row+e,i.column);0!==e&&0===t&&n.row===this.lead.row&&n.column===this.lead.column&&this.session.lineWidgets&&this.session.lineWidgets[n.row]&&n.row++,this.moveCursorTo(n.row,n.column+t,0===t)},this.moveCursorToPosition=function(e){this.moveCursorTo(e.row,e.column)},this.moveCursorTo=function(e,t,i){var n=this.session.getFoldAt(e,t,1);n&&(e=n.start.row,t=n.start.column),this.$keepDesiredColumnOnChange=!0,this.lead.setPosition(e,t),this.$keepDesiredColumnOnChange=!1,i||(this.$desiredColumn=null)},this.moveCursorToScreen=function(e,t,i){var n=this.session.screenToDocumentPosition(e,t);this.moveCursorTo(n.row,n.column,i)},this.detach=function(){this.lead.detach(),this.anchor.detach(),this.session=this.doc=null},this.fromOrientedRange=function(e){this.setSelectionRange(e,e.cursor==e.start),this.$desiredColumn=e.desiredColumn||this.$desiredColumn},this.toOrientedRange=function(e){var t=this.getRange();return e?(e.start.column=t.start.column,e.start.row=t.start.row,e.end.column=t.end.column,e.end.row=t.end.row):e=t,e.cursor=this.isBackwards()?e.start:e.end,e.desiredColumn=this.$desiredColumn,e},this.getRangeOfMovements=function(e){var t=this.getCursor();try{e.call(null,this);var i=this.getCursor();return s.fromPoints(t,i)}catch(e){return s.fromPoints(t,t)}finally{this.moveCursorToPosition(t)}},this.toJSON=function(){if(this.rangeCount)var e=this.ranges.map(function(e){var t=e.clone();return t.isBackwards=e.cursor==e.start,t});else(e=this.getRange()).isBackwards=this.isBackwards();return e},this.fromJSON=function(e){if(null==e.start){if(this.rangeList){this.toSingleRange(e[0]);for(var t=e.length;t--;){var i=s.fromPoints(e[t].start,e[t].end);e.isBackwards&&(i.cursor=i.start),this.addRange(i,!0)}return}e=e[0]}this.rangeList&&this.toSingleRange(e),this.setSelectionRange(e,e.isBackwards)},this.isEqual=function(e){if((e.length||this.rangeCount)&&e.length!=this.rangeCount)return!1;if(!e.length||!this.ranges)return this.getRange().isEqual(e);for(var t=this.ranges.length;t--;)if(!this.ranges[t].isEqual(e[t]))return!1;return!0}}).call(n.prototype),t.Selection=n}),ace.define("ace/tokenizer",["require","exports","module","ace/config"],function(e,t,i){"use strict";function n(e){for(var t in this.states=e,this.regExps={},this.matchMappings={},this.states){for(var i=this.states[t],n=[],o=0,r=this.matchMappings[t]={defaultToken:"text"},a="g",s=[],l=0;l<i.length;l++){var c=i[l];if(c.defaultToken&&(r.defaultToken=c.defaultToken),c.caseInsensitive&&(a="gi"),null!=c.regex){c.regex instanceof RegExp&&(c.regex=c.regex.toString().slice(1,-1));var u=c.regex,d=new RegExp("(?:("+u+")|(.))").exec("a").length-2;Array.isArray(c.token)?1==c.token.length||1==d?c.token=c.token[0]:d-1!=c.token.length?(this.reportError("number of classes and regexp groups doesn't match",{rule:c,groupCount:d-1}),c.token=c.token[0]):(c.tokenArray=c.token,c.token=null,c.onMatch=this.$arrayTokens):"function"!=typeof c.token||c.onMatch||(c.onMatch=1<d?this.$applyToken:c.token),1<d&&(u=/\\\d/.test(c.regex)?c.regex.replace(/\\([0-9]+)/g,function(e,t){return"\\"+(parseInt(t,10)+o+1)}):(d=1,this.removeCapturingGroups(c.regex)),c.splitRegex||"string"==typeof c.token||s.push(c)),r[o]=l,o+=d,n.push(u),c.onMatch||(c.onMatch=null)}}n.length||(r[0]=0,n.push("$")),s.forEach(function(e){e.splitRegex=this.createSplitterRegexp(e.regex,a)},this),this.regExps[t]=new RegExp("("+n.join(")|(")+")|($)",a)}}var o=e("./config"),y=2e3;(function(){this.$setMaxTokenCount=function(e){y=0|e},this.$applyToken=function(e){var t=this.splitRegex.exec(e).slice(1),i=this.token.apply(this,t);if("string"==typeof i)return[{type:i,value:e}];for(var n=[],o=0,r=i.length;o<r;o++)t[o]&&(n[n.length]={type:i[o],value:t[o]});return n},this.$arrayTokens=function(e){if(!e)return[];var t=this.splitRegex.exec(e);if(!t)return"text";for(var i=[],n=this.tokenArray,o=0,r=n.length;o<r;o++)t[o+1]&&(i[i.length]={type:n[o],value:t[o+1]});return i},this.removeCapturingGroups=function(e){return e.replace(/\[(?:\\.|[^\]])*?\]|\\.|\(\?[:=!]|(\()/g,function(e,t){return t?"(?:":e})},this.createSplitterRegexp=function(e,t){if(-1!=e.indexOf("(?=")){var a=0,s=!1,l={};e.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,function(e,t,i,n,o,r){return s?s="]"!=o:o?s=!0:n?(a==l.stack&&(l.end=r+1,l.stack=-1),a--):i&&(a++,1!=i.length&&(l.stack=a,l.start=r)),e}),null!=l.end&&/^\)*$/.test(e.substr(l.end))&&(e=e.substring(0,l.start)+e.substr(l.end))}return new RegExp(e,(t||"").replace("g",""))},this.getLineTokens=function(e,t){if(t&&"string"!=typeof t)"#tmp"===(t=(i=t.slice(0))[0])&&(i.shift(),t=i.shift());else var i=[];var n=t||"start",o=this.states[n];o||(n="start",o=this.states[n]);for(var r,a=this.matchMappings[n],s=this.regExps[n],l=[],c=s.lastIndex=0,u=0,d={type:null,value:""};r=s.exec(e);){var h=a.defaultToken,p=null,f=r[0],g=s.lastIndex;if(g-f.length>c){var m=e.substring(c,g-f.length);d.type==h?d.value+=m:(d.type&&l.push(d),d={type:h,value:m})}for(var v=0;v<r.length-2;v++)if(void 0!==r[v+1]){h=(p=o[a[v]]).onMatch?p.onMatch(f,n,i):p.token,p.next&&(n="string"==typeof p.next?p.next:p.next(n,i),(o=this.states[n])||(this.reportError("state doesn't exist",n),n="start",o=this.states[n]),a=this.matchMappings[n],c=g,(s=this.regExps[n]).lastIndex=g);break}if(f)if("string"==typeof h)p&&!1===p.merge||d.type!==h?(d.type&&l.push(d),d={type:h,value:f}):d.value+=f;else if(h){d.type&&l.push(d),d={type:null,value:""};for(v=0;v<h.length;v++)l.push(h[v])}if(c==e.length)break;if(c=g,u++>y){for(u>2*e.length&&this.reportError("infinite loop with in ace tokenizer",{startState:t,line:e});c<e.length;)d.type&&l.push(d),d={value:e.substring(c,c+=2e3),type:"overflow"};n="start",i=[];break}}return d.type&&l.push(d),1<i.length&&i[0]!==n&&i.unshift("#tmp",n),{tokens:l,state:i.length?i:n}},this.reportError=o.reportError}).call(n.prototype),t.Tokenizer=n}),ace.define("ace/mode/text_highlight_rules",["require","exports","module","ace/lib/lang"],function(e,t,i){"use strict";function n(){this.$rules={start:[{token:"empty_line",regex:"^$"},{defaultToken:"text"}]}}var c=e("../lib/lang");(function(){this.addRules=function(e,t){if(t)for(var i in e){for(var n=e[i],o=0;o<n.length;o++){var r=n[o];(r.next||r.onMatch)&&("string"!=typeof r.next?r.nextState&&0!==r.nextState.indexOf(t)&&(r.nextState=t+r.nextState):0!==r.next.indexOf(t)&&(r.next=t+r.next))}this.$rules[t+i]=n}else for(var i in e)this.$rules[i]=e[i]},this.getRules=function(){return this.$rules},this.embedRules=function(e,t,i,n,o){var r="function"==typeof e?(new e).getRules():e;if(n)for(var a=0;a<n.length;a++)n[a]=t+n[a];else for(var s in n=[],r)n.push(t+s);if(this.addRules(r,t),i){var l=Array.prototype[o?"push":"unshift"];for(a=0;a<n.length;a++)l.apply(this.$rules[n[a]],c.deepCopy(i))}this.$embeds||(this.$embeds=[]),this.$embeds.push(t)},this.getEmbeds=function(){return this.$embeds};function p(e,t){return"start"==e&&!t.length||t.unshift(this.nextState,e),this.nextState}function f(e,t){return t.shift(),t.shift()||"start"}this.normalizeRules=function(){var d=0,h=this.$rules;Object.keys(h).forEach(function e(t){var i=h[t];i.processed=!0;for(var n=0;n<i.length;n++){var o=i[n];!o.regex&&o.start&&(o.regex=o.start,o.next||(o.next=[]),o.next.push({defaultToken:o.token},{token:o.token+".end",regex:o.end||o.start,next:"pop"}),o.token=o.token+".start",o.push=!0);var r=o.next||o.push;if(r&&Array.isArray(r)){var a=o.stateName;a||("string"!=typeof(a=o.token)&&(a=a[0]||""),h[a]&&(a+=d++)),h[a]=r,e(o.next=a)}else"pop"==r&&(o.next=f);if(o.push&&(o.nextState=o.next||o.push,o.next=p,delete o.push),o.rules)for(var s in o.rules)h[s]?h[s].push&&h[s].push.apply(h[s],o.rules[s]):h[s]=o.rules[s];if(o.include||"string"==typeof o)var l=o.include||o,c=h[l];else Array.isArray(o)&&(c=o);if(c){var u=[n,1].concat(c);o.noEscape&&(u=u.filter(function(e){return!e.next})),i.splice.apply(i,u),n--,c=null}o.keywordMap&&(o.token=this.createKeywordMapper(o.keywordMap,o.defaultToken||"text",o.caseInsensitive),delete o.defaultToken)}},this)},this.createKeywordMapper=function(o,t,r,a){var s=Object.create(null);return Object.keys(o).forEach(function(e){var t=o[e];r&&(t=t.toLowerCase());for(var i=t.split(a||"|"),n=i.length;n--;)s[i[n]]=e}),Object.getPrototypeOf(s)&&(s.__proto__=null),this.$keywordList=Object.keys(s),o=null,r?function(e){return s[e.toLowerCase()]||t}:function(e){return s[e]||t}},this.getKeywords=function(){return this.$keywords}}).call(n.prototype),t.TextHighlightRules=n}),ace.define("ace/mode/behaviour",["require","exports","module"],function(e,t,i){"use strict";function n(){this.$behaviours={}}(function(){this.add=function(e,t,i){switch(void 0){case this.$behaviours:this.$behaviours={};case this.$behaviours[e]:this.$behaviours[e]={}}this.$behaviours[e][t]=i},this.addBehaviours=function(e){for(var t in e)for(var i in e[t])this.add(t,i,e[t][i])},this.remove=function(e){this.$behaviours&&this.$behaviours[e]&&delete this.$behaviours[e]},this.inherit=function(e,t){if("function"==typeof e)var i=(new e).getBehaviours(t);else i=e.getBehaviours(t);this.addBehaviours(i)},this.getBehaviours=function(e){if(e){for(var t={},i=0;i<e.length;i++)this.$behaviours[e[i]]&&(t[e[i]]=this.$behaviours[e[i]]);return t}return this.$behaviours}}).call(n.prototype),t.Behaviour=n}),ace.define("ace/unicode",["require","exports","module"],function(e,n,t){"use strict";n.packages={},function(e){var t=/\w{4}/g;for(var i in e)n.packages[i]=e[i].replace(t,"\\u$&")}({L:"0041-005A0061-007A00AA00B500BA00C0-00D600D8-00F600F8-02C102C6-02D102E0-02E402EC02EE0370-037403760377037A-037D03860388-038A038C038E-03A103A3-03F503F7-0481048A-05250531-055605590561-058705D0-05EA05F0-05F20621-064A066E066F0671-06D306D506E506E606EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA07F407F507FA0800-0815081A082408280904-0939093D09500958-0961097109720979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10D05-0D0C0D0E-0D100D12-0D280D2A-0D390D3D0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E460E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EC60EDC0EDD0F000F40-0F470F49-0F6C0F88-0F8B1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10A0-10C510D0-10FA10FC1100-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317D717DC1820-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541AA71B05-1B331B45-1B4B1B83-1BA01BAE1BAF1C00-1C231C4D-1C4F1C5A-1C7D1CE9-1CEC1CEE-1CF11D00-1DBF1E00-1F151F18-1F1D1F20-1F451F48-1F4D1F50-1F571F591F5B1F5D1F5F-1F7D1F80-1FB41FB6-1FBC1FBE1FC2-1FC41FC6-1FCC1FD0-1FD31FD6-1FDB1FE0-1FEC1FF2-1FF41FF6-1FFC2071207F2090-209421022107210A-211321152119-211D212421262128212A-212D212F-2139213C-213F2145-2149214E218321842C00-2C2E2C30-2C5E2C60-2CE42CEB-2CEE2D00-2D252D30-2D652D6F2D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE2E2F300530063031-3035303B303C3041-3096309D-309F30A1-30FA30FC-30FF3105-312D3131-318E31A0-31B731F0-31FF3400-4DB54E00-9FCBA000-A48CA4D0-A4FDA500-A60CA610-A61FA62AA62BA640-A65FA662-A66EA67F-A697A6A0-A6E5A717-A71FA722-A788A78BA78CA7FB-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2A9CFAA00-AA28AA40-AA42AA44-AA4BAA60-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADB-AADDABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA2DFA30-FA6DFA70-FAD9FB00-FB06FB13-FB17FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF21-FF3AFF41-FF5AFF66-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",Ll:"0061-007A00AA00B500BA00DF-00F600F8-00FF01010103010501070109010B010D010F01110113011501170119011B011D011F01210123012501270129012B012D012F01310133013501370138013A013C013E014001420144014601480149014B014D014F01510153015501570159015B015D015F01610163016501670169016B016D016F0171017301750177017A017C017E-0180018301850188018C018D019201950199-019B019E01A101A301A501A801AA01AB01AD01B001B401B601B901BA01BD-01BF01C601C901CC01CE01D001D201D401D601D801DA01DC01DD01DF01E101E301E501E701E901EB01ED01EF01F001F301F501F901FB01FD01FF02010203020502070209020B020D020F02110213021502170219021B021D021F02210223022502270229022B022D022F02310233-0239023C023F0240024202470249024B024D024F-02930295-02AF037103730377037B-037D039003AC-03CE03D003D103D5-03D703D903DB03DD03DF03E103E303E503E703E903EB03ED03EF-03F303F503F803FB03FC0430-045F04610463046504670469046B046D046F04710473047504770479047B047D047F0481048B048D048F04910493049504970499049B049D049F04A104A304A504A704A904AB04AD04AF04B104B304B504B704B904BB04BD04BF04C204C404C604C804CA04CC04CE04CF04D104D304D504D704D904DB04DD04DF04E104E304E504E704E904EB04ED04EF04F104F304F504F704F904FB04FD04FF05010503050505070509050B050D050F05110513051505170519051B051D051F0521052305250561-05871D00-1D2B1D62-1D771D79-1D9A1E011E031E051E071E091E0B1E0D1E0F1E111E131E151E171E191E1B1E1D1E1F1E211E231E251E271E291E2B1E2D1E2F1E311E331E351E371E391E3B1E3D1E3F1E411E431E451E471E491E4B1E4D1E4F1E511E531E551E571E591E5B1E5D1E5F1E611E631E651E671E691E6B1E6D1E6F1E711E731E751E771E791E7B1E7D1E7F1E811E831E851E871E891E8B1E8D1E8F1E911E931E95-1E9D1E9F1EA11EA31EA51EA71EA91EAB1EAD1EAF1EB11EB31EB51EB71EB91EBB1EBD1EBF1EC11EC31EC51EC71EC91ECB1ECD1ECF1ED11ED31ED51ED71ED91EDB1EDD1EDF1EE11EE31EE51EE71EE91EEB1EED1EEF1EF11EF31EF51EF71EF91EFB1EFD1EFF-1F071F10-1F151F20-1F271F30-1F371F40-1F451F50-1F571F60-1F671F70-1F7D1F80-1F871F90-1F971FA0-1FA71FB0-1FB41FB61FB71FBE1FC2-1FC41FC61FC71FD0-1FD31FD61FD71FE0-1FE71FF2-1FF41FF61FF7210A210E210F2113212F21342139213C213D2146-2149214E21842C30-2C5E2C612C652C662C682C6A2C6C2C712C732C742C76-2C7C2C812C832C852C872C892C8B2C8D2C8F2C912C932C952C972C992C9B2C9D2C9F2CA12CA32CA52CA72CA92CAB2CAD2CAF2CB12CB32CB52CB72CB92CBB2CBD2CBF2CC12CC32CC52CC72CC92CCB2CCD2CCF2CD12CD32CD52CD72CD92CDB2CDD2CDF2CE12CE32CE42CEC2CEE2D00-2D25A641A643A645A647A649A64BA64DA64FA651A653A655A657A659A65BA65DA65FA663A665A667A669A66BA66DA681A683A685A687A689A68BA68DA68FA691A693A695A697A723A725A727A729A72BA72DA72F-A731A733A735A737A739A73BA73DA73FA741A743A745A747A749A74BA74DA74FA751A753A755A757A759A75BA75DA75FA761A763A765A767A769A76BA76DA76FA771-A778A77AA77CA77FA781A783A785A787A78CFB00-FB06FB13-FB17FF41-FF5A",Lu:"0041-005A00C0-00D600D8-00DE01000102010401060108010A010C010E01100112011401160118011A011C011E01200122012401260128012A012C012E01300132013401360139013B013D013F0141014301450147014A014C014E01500152015401560158015A015C015E01600162016401660168016A016C016E017001720174017601780179017B017D018101820184018601870189-018B018E-0191019301940196-0198019C019D019F01A001A201A401A601A701A901AC01AE01AF01B1-01B301B501B701B801BC01C401C701CA01CD01CF01D101D301D501D701D901DB01DE01E001E201E401E601E801EA01EC01EE01F101F401F6-01F801FA01FC01FE02000202020402060208020A020C020E02100212021402160218021A021C021E02200222022402260228022A022C022E02300232023A023B023D023E02410243-02460248024A024C024E03700372037603860388-038A038C038E038F0391-03A103A3-03AB03CF03D2-03D403D803DA03DC03DE03E003E203E403E603E803EA03EC03EE03F403F703F903FA03FD-042F04600462046404660468046A046C046E04700472047404760478047A047C047E0480048A048C048E04900492049404960498049A049C049E04A004A204A404A604A804AA04AC04AE04B004B204B404B604B804BA04BC04BE04C004C104C304C504C704C904CB04CD04D004D204D404D604D804DA04DC04DE04E004E204E404E604E804EA04EC04EE04F004F204F404F604F804FA04FC04FE05000502050405060508050A050C050E05100512051405160518051A051C051E0520052205240531-055610A0-10C51E001E021E041E061E081E0A1E0C1E0E1E101E121E141E161E181E1A1E1C1E1E1E201E221E241E261E281E2A1E2C1E2E1E301E321E341E361E381E3A1E3C1E3E1E401E421E441E461E481E4A1E4C1E4E1E501E521E541E561E581E5A1E5C1E5E1E601E621E641E661E681E6A1E6C1E6E1E701E721E741E761E781E7A1E7C1E7E1E801E821E841E861E881E8A1E8C1E8E1E901E921E941E9E1EA01EA21EA41EA61EA81EAA1EAC1EAE1EB01EB21EB41EB61EB81EBA1EBC1EBE1EC01EC21EC41EC61EC81ECA1ECC1ECE1ED01ED21ED41ED61ED81EDA1EDC1EDE1EE01EE21EE41EE61EE81EEA1EEC1EEE1EF01EF21EF41EF61EF81EFA1EFC1EFE1F08-1F0F1F18-1F1D1F28-1F2F1F38-1F3F1F48-1F4D1F591F5B1F5D1F5F1F68-1F6F1FB8-1FBB1FC8-1FCB1FD8-1FDB1FE8-1FEC1FF8-1FFB21022107210B-210D2110-211221152119-211D212421262128212A-212D2130-2133213E213F214521832C00-2C2E2C602C62-2C642C672C692C6B2C6D-2C702C722C752C7E-2C802C822C842C862C882C8A2C8C2C8E2C902C922C942C962C982C9A2C9C2C9E2CA02CA22CA42CA62CA82CAA2CAC2CAE2CB02CB22CB42CB62CB82CBA2CBC2CBE2CC02CC22CC42CC62CC82CCA2CCC2CCE2CD02CD22CD42CD62CD82CDA2CDC2CDE2CE02CE22CEB2CEDA640A642A644A646A648A64AA64CA64EA650A652A654A656A658A65AA65CA65EA662A664A666A668A66AA66CA680A682A684A686A688A68AA68CA68EA690A692A694A696A722A724A726A728A72AA72CA72EA732A734A736A738A73AA73CA73EA740A742A744A746A748A74AA74CA74EA750A752A754A756A758A75AA75CA75EA760A762A764A766A768A76AA76CA76EA779A77BA77DA77EA780A782A784A786A78BFF21-FF3A",Lt:"01C501C801CB01F21F88-1F8F1F98-1F9F1FA8-1FAF1FBC1FCC1FFC",Lm:"02B0-02C102C6-02D102E0-02E402EC02EE0374037A0559064006E506E607F407F507FA081A0824082809710E460EC610FC17D718431AA71C78-1C7D1D2C-1D611D781D9B-1DBF2071207F2090-20942C7D2D6F2E2F30053031-3035303B309D309E30FC-30FEA015A4F8-A4FDA60CA67FA717-A71FA770A788A9CFAA70AADDFF70FF9EFF9F",Lo:"01BB01C0-01C3029405D0-05EA05F0-05F20621-063F0641-064A066E066F0671-06D306D506EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA0800-08150904-0939093D09500958-096109720979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10D05-0D0C0D0E-0D100D12-0D280D2A-0D390D3D0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E450E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EDC0EDD0F000F40-0F470F49-0F6C0F88-0F8B1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10D0-10FA1100-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317DC1820-18421844-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541B05-1B331B45-1B4B1B83-1BA01BAE1BAF1C00-1C231C4D-1C4F1C5A-1C771CE9-1CEC1CEE-1CF12135-21382D30-2D652D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE3006303C3041-3096309F30A1-30FA30FF3105-312D3131-318E31A0-31B731F0-31FF3400-4DB54E00-9FCBA000-A014A016-A48CA4D0-A4F7A500-A60BA610-A61FA62AA62BA66EA6A0-A6E5A7FB-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2AA00-AA28AA40-AA42AA44-AA4BAA60-AA6FAA71-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADBAADCABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA2DFA30-FA6DFA70-FAD9FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF66-FF6FFF71-FF9DFFA0-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",M:"0300-036F0483-04890591-05BD05BF05C105C205C405C505C70610-061A064B-065E067006D6-06DC06DE-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0900-0903093C093E-094E0951-0955096209630981-098309BC09BE-09C409C709C809CB-09CD09D709E209E30A01-0A030A3C0A3E-0A420A470A480A4B-0A4D0A510A700A710A750A81-0A830ABC0ABE-0AC50AC7-0AC90ACB-0ACD0AE20AE30B01-0B030B3C0B3E-0B440B470B480B4B-0B4D0B560B570B620B630B820BBE-0BC20BC6-0BC80BCA-0BCD0BD70C01-0C030C3E-0C440C46-0C480C4A-0C4D0C550C560C620C630C820C830CBC0CBE-0CC40CC6-0CC80CCA-0CCD0CD50CD60CE20CE30D020D030D3E-0D440D46-0D480D4A-0D4D0D570D620D630D820D830DCA0DCF-0DD40DD60DD8-0DDF0DF20DF30E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F3E0F3F0F71-0F840F860F870F90-0F970F99-0FBC0FC6102B-103E1056-1059105E-10601062-10641067-106D1071-10741082-108D108F109A-109D135F1712-17141732-1734175217531772177317B6-17D317DD180B-180D18A91920-192B1930-193B19B0-19C019C819C91A17-1A1B1A55-1A5E1A60-1A7C1A7F1B00-1B041B34-1B441B6B-1B731B80-1B821BA1-1BAA1C24-1C371CD0-1CD21CD4-1CE81CED1CF21DC0-1DE61DFD-1DFF20D0-20F02CEF-2CF12DE0-2DFF302A-302F3099309AA66F-A672A67CA67DA6F0A6F1A802A806A80BA823-A827A880A881A8B4-A8C4A8E0-A8F1A926-A92DA947-A953A980-A983A9B3-A9C0AA29-AA36AA43AA4CAA4DAA7BAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1ABE3-ABEAABECABEDFB1EFE00-FE0FFE20-FE26",Mn:"0300-036F0483-04870591-05BD05BF05C105C205C405C505C70610-061A064B-065E067006D6-06DC06DF-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0900-0902093C0941-0948094D0951-095509620963098109BC09C1-09C409CD09E209E30A010A020A3C0A410A420A470A480A4B-0A4D0A510A700A710A750A810A820ABC0AC1-0AC50AC70AC80ACD0AE20AE30B010B3C0B3F0B41-0B440B4D0B560B620B630B820BC00BCD0C3E-0C400C46-0C480C4A-0C4D0C550C560C620C630CBC0CBF0CC60CCC0CCD0CE20CE30D41-0D440D4D0D620D630DCA0DD2-0DD40DD60E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F71-0F7E0F80-0F840F860F870F90-0F970F99-0FBC0FC6102D-10301032-10371039103A103D103E10581059105E-10601071-1074108210851086108D109D135F1712-17141732-1734175217531772177317B7-17BD17C617C9-17D317DD180B-180D18A91920-19221927192819321939-193B1A171A181A561A58-1A5E1A601A621A65-1A6C1A73-1A7C1A7F1B00-1B031B341B36-1B3A1B3C1B421B6B-1B731B801B811BA2-1BA51BA81BA91C2C-1C331C361C371CD0-1CD21CD4-1CE01CE2-1CE81CED1DC0-1DE61DFD-1DFF20D0-20DC20E120E5-20F02CEF-2CF12DE0-2DFF302A-302F3099309AA66FA67CA67DA6F0A6F1A802A806A80BA825A826A8C4A8E0-A8F1A926-A92DA947-A951A980-A982A9B3A9B6-A9B9A9BCAA29-AA2EAA31AA32AA35AA36AA43AA4CAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1ABE5ABE8ABEDFB1EFE00-FE0FFE20-FE26",Mc:"0903093E-09400949-094C094E0982098309BE-09C009C709C809CB09CC09D70A030A3E-0A400A830ABE-0AC00AC90ACB0ACC0B020B030B3E0B400B470B480B4B0B4C0B570BBE0BBF0BC10BC20BC6-0BC80BCA-0BCC0BD70C01-0C030C41-0C440C820C830CBE0CC0-0CC40CC70CC80CCA0CCB0CD50CD60D020D030D3E-0D400D46-0D480D4A-0D4C0D570D820D830DCF-0DD10DD8-0DDF0DF20DF30F3E0F3F0F7F102B102C10311038103B103C105610571062-10641067-106D108310841087-108C108F109A-109C17B617BE-17C517C717C81923-19261929-192B193019311933-193819B0-19C019C819C91A19-1A1B1A551A571A611A631A641A6D-1A721B041B351B3B1B3D-1B411B431B441B821BA11BA61BA71BAA1C24-1C2B1C341C351CE11CF2A823A824A827A880A881A8B4-A8C3A952A953A983A9B4A9B5A9BAA9BBA9BD-A9C0AA2FAA30AA33AA34AA4DAA7BABE3ABE4ABE6ABE7ABE9ABEAABEC",Me:"0488048906DE20DD-20E020E2-20E4A670-A672",N:"0030-003900B200B300B900BC-00BE0660-066906F0-06F907C0-07C90966-096F09E6-09EF09F4-09F90A66-0A6F0AE6-0AEF0B66-0B6F0BE6-0BF20C66-0C6F0C78-0C7E0CE6-0CEF0D66-0D750E50-0E590ED0-0ED90F20-0F331040-10491090-10991369-137C16EE-16F017E0-17E917F0-17F91810-18191946-194F19D0-19DA1A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C5920702074-20792080-20892150-21822185-21892460-249B24EA-24FF2776-27932CFD30073021-30293038-303A3192-31953220-32293251-325F3280-328932B1-32BFA620-A629A6E6-A6EFA830-A835A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",Nd:"0030-00390660-066906F0-06F907C0-07C90966-096F09E6-09EF0A66-0A6F0AE6-0AEF0B66-0B6F0BE6-0BEF0C66-0C6F0CE6-0CEF0D66-0D6F0E50-0E590ED0-0ED90F20-0F291040-10491090-109917E0-17E91810-18191946-194F19D0-19DA1A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C59A620-A629A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",Nl:"16EE-16F02160-21822185-218830073021-30293038-303AA6E6-A6EF",No:"00B200B300B900BC-00BE09F4-09F90BF0-0BF20C78-0C7E0D70-0D750F2A-0F331369-137C17F0-17F920702074-20792080-20892150-215F21892460-249B24EA-24FF2776-27932CFD3192-31953220-32293251-325F3280-328932B1-32BFA830-A835",P:"0021-00230025-002A002C-002F003A003B003F0040005B-005D005F007B007D00A100AB00B700BB00BF037E0387055A-055F0589058A05BE05C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E0964096509700DF40E4F0E5A0E5B0F04-0F120F3A-0F3D0F850FD0-0FD4104A-104F10FB1361-13681400166D166E169B169C16EB-16ED1735173617D4-17D617D8-17DA1800-180A1944194519DE19DF1A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601C3B-1C3F1C7E1C7F1CD32010-20272030-20432045-20512053-205E207D207E208D208E2329232A2768-277527C527C627E6-27EF2983-299829D8-29DB29FC29FD2CF9-2CFC2CFE2CFF2E00-2E2E2E302E313001-30033008-30113014-301F3030303D30A030FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFABEBFD3EFD3FFE10-FE19FE30-FE52FE54-FE61FE63FE68FE6AFE6BFF01-FF03FF05-FF0AFF0C-FF0FFF1AFF1BFF1FFF20FF3B-FF3DFF3FFF5BFF5DFF5F-FF65",Pd:"002D058A05BE140018062010-20152E172E1A301C303030A0FE31FE32FE58FE63FF0D",Ps:"0028005B007B0F3A0F3C169B201A201E2045207D208D23292768276A276C276E27702772277427C527E627E827EA27EC27EE2983298529872989298B298D298F299129932995299729D829DA29FC2E222E242E262E283008300A300C300E3010301430163018301A301DFD3EFE17FE35FE37FE39FE3BFE3DFE3FFE41FE43FE47FE59FE5BFE5DFF08FF3BFF5BFF5FFF62",Pe:"0029005D007D0F3B0F3D169C2046207E208E232A2769276B276D276F27712773277527C627E727E927EB27ED27EF298429862988298A298C298E2990299229942996299829D929DB29FD2E232E252E272E293009300B300D300F3011301530173019301B301E301FFD3FFE18FE36FE38FE3AFE3CFE3EFE40FE42FE44FE48FE5AFE5CFE5EFF09FF3DFF5DFF60FF63",Pi:"00AB2018201B201C201F20392E022E042E092E0C2E1C2E20",Pf:"00BB2019201D203A2E032E052E0A2E0D2E1D2E21",Pc:"005F203F20402054FE33FE34FE4D-FE4FFF3F",Po:"0021-00230025-0027002A002C002E002F003A003B003F0040005C00A100B700BF037E0387055A-055F058905C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E0964096509700DF40E4F0E5A0E5B0F04-0F120F850FD0-0FD4104A-104F10FB1361-1368166D166E16EB-16ED1735173617D4-17D617D8-17DA1800-18051807-180A1944194519DE19DF1A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601C3B-1C3F1C7E1C7F1CD3201620172020-20272030-2038203B-203E2041-20432047-205120532055-205E2CF9-2CFC2CFE2CFF2E002E012E06-2E082E0B2E0E-2E162E182E192E1B2E1E2E1F2E2A-2E2E2E302E313001-3003303D30FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFABEBFE10-FE16FE19FE30FE45FE46FE49-FE4CFE50-FE52FE54-FE57FE5F-FE61FE68FE6AFE6BFF01-FF03FF05-FF07FF0AFF0CFF0EFF0FFF1AFF1BFF1FFF20FF3CFF61FF64FF65",S:"0024002B003C-003E005E0060007C007E00A2-00A900AC00AE-00B100B400B600B800D700F702C2-02C502D2-02DF02E5-02EB02ED02EF-02FF03750384038503F604820606-0608060B060E060F06E906FD06FE07F609F209F309FA09FB0AF10B700BF3-0BFA0C7F0CF10CF20D790E3F0F01-0F030F13-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F13601390-139917DB194019E0-19FF1B61-1B6A1B74-1B7C1FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE20442052207A-207C208A-208C20A0-20B8210021012103-21062108210921142116-2118211E-2123212521272129212E213A213B2140-2144214A-214D214F2190-2328232B-23E82400-24262440-244A249C-24E92500-26CD26CF-26E126E326E8-26FF2701-27042706-2709270C-27272729-274B274D274F-27522756-275E2761-276727942798-27AF27B1-27BE27C0-27C427C7-27CA27CC27D0-27E527F0-29822999-29D729DC-29FB29FE-2B4C2B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F309B309C319031913196-319F31C0-31E33200-321E322A-32503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A700-A716A720A721A789A78AA828-A82BA836-A839AA77-AA79FB29FDFCFDFDFE62FE64-FE66FE69FF04FF0BFF1C-FF1EFF3EFF40FF5CFF5EFFE0-FFE6FFE8-FFEEFFFCFFFD",Sm:"002B003C-003E007C007E00AC00B100D700F703F60606-060820442052207A-207C208A-208C2140-2144214B2190-2194219A219B21A021A321A621AE21CE21CF21D221D421F4-22FF2308-230B23202321237C239B-23B323DC-23E125B725C125F8-25FF266F27C0-27C427C7-27CA27CC27D0-27E527F0-27FF2900-29822999-29D729DC-29FB29FE-2AFF2B30-2B442B47-2B4CFB29FE62FE64-FE66FF0BFF1C-FF1EFF5CFF5EFFE2FFE9-FFEC",Sc:"002400A2-00A5060B09F209F309FB0AF10BF90E3F17DB20A0-20B8A838FDFCFE69FF04FFE0FFE1FFE5FFE6",Sk:"005E006000A800AF00B400B802C2-02C502D2-02DF02E5-02EB02ED02EF-02FF0375038403851FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE309B309CA700-A716A720A721A789A78AFF3EFF40FFE3",So:"00A600A700A900AE00B000B60482060E060F06E906FD06FE07F609FA0B700BF3-0BF80BFA0C7F0CF10CF20D790F01-0F030F13-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F13601390-1399194019E0-19FF1B61-1B6A1B74-1B7C210021012103-21062108210921142116-2118211E-2123212521272129212E213A213B214A214C214D214F2195-2199219C-219F21A121A221A421A521A7-21AD21AF-21CD21D021D121D321D5-21F32300-2307230C-231F2322-2328232B-237B237D-239A23B4-23DB23E2-23E82400-24262440-244A249C-24E92500-25B625B8-25C025C2-25F72600-266E2670-26CD26CF-26E126E326E8-26FF2701-27042706-2709270C-27272729-274B274D274F-27522756-275E2761-276727942798-27AF27B1-27BE2800-28FF2B00-2B2F2B452B462B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F319031913196-319F31C0-31E33200-321E322A-32503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A828-A82BA836A837A839AA77-AA79FDFDFFE4FFE8FFEDFFEEFFFCFFFD",Z:"002000A01680180E2000-200A20282029202F205F3000",Zs:"002000A01680180E2000-200A202F205F3000",Zl:"2028",Zp:"2029",C:"0000-001F007F-009F00AD03780379037F-0383038B038D03A20526-05300557055805600588058B-059005C8-05CF05EB-05EF05F5-0605061C061D0620065F06DD070E070F074B074C07B2-07BF07FB-07FF082E082F083F-08FF093A093B094F095609570973-097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF00AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B72-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D290D3A-0D3C0D450D490D4E-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EDE-0EFF0F480F6D-0F700F8C-0F8F0F980FBD0FCD0FD9-0FFF10C6-10CF10FD-10FF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B-135E137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17B417B517DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BAB-1BAD1BBA-1BFF1C38-1C3A1C4A-1C4C1C80-1CCF1CF3-1CFF1DE7-1DFC1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF200B-200F202A-202E2060-206F20722073208F2095-209F20B9-20CF20F1-20FF218A-218F23E9-23FF2427-243F244B-245F26CE26E226E4-26E727002705270A270B2728274C274E2753-2755275F27602795-279727B027BF27CB27CD-27CF2B4D-2B4F2B5A-2BFF2C2F2C5F2CF2-2CF82D26-2D2F2D66-2D6E2D70-2D7F2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E32-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31B8-31BF31E4-31EF321F32FF4DB6-4DBF9FCC-9FFFA48D-A48FA4C7-A4CFA62C-A63FA660A661A674-A67BA698-A69FA6F8-A6FFA78D-A7FAA82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAE0-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-F8FFFA2EFA2FFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBB2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFD-FF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFFBFFFEFFFF",Cc:"0000-001F007F-009F",Cf:"00AD0600-060306DD070F17B417B5200B-200F202A-202E2060-2064206A-206FFEFFFFF9-FFFB",Co:"E000-F8FF",Cs:"D800-DFFF",Cn:"03780379037F-0383038B038D03A20526-05300557055805600588058B-059005C8-05CF05EB-05EF05F5-05FF06040605061C061D0620065F070E074B074C07B2-07BF07FB-07FF082E082F083F-08FF093A093B094F095609570973-097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF00AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B72-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D290D3A-0D3C0D450D490D4E-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EDE-0EFF0F480F6D-0F700F8C-0F8F0F980FBD0FCD0FD9-0FFF10C6-10CF10FD-10FF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B-135E137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BAB-1BAD1BBA-1BFF1C38-1C3A1C4A-1C4C1C80-1CCF1CF3-1CFF1DE7-1DFC1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF2065-206920722073208F2095-209F20B9-20CF20F1-20FF218A-218F23E9-23FF2427-243F244B-245F26CE26E226E4-26E727002705270A270B2728274C274E2753-2755275F27602795-279727B027BF27CB27CD-27CF2B4D-2B4F2B5A-2BFF2C2F2C5F2CF2-2CF82D26-2D2F2D66-2D6E2D70-2D7F2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E32-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31B8-31BF31E4-31EF321F32FF4DB6-4DBF9FCC-9FFFA48D-A48FA4C7-A4CFA62C-A63FA660A661A674-A67BA698-A69FA6F8-A6FFA78D-A7FAA82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAE0-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-D7FFFA2EFA2FFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBB2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFDFEFEFF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFF8FFFEFFFF"})}),ace.define("ace/token_iterator",["require","exports","module"],function(e,t,i){"use strict";function n(e,t,i){this.$session=e,this.$row=t,this.$rowTokens=e.getTokens(t);var n=e.getTokenAt(t,i);this.$tokenIndex=n?n.index:-1}(function(){this.stepBackward=function(){for(this.$tokenIndex-=1;this.$tokenIndex<0;){if(this.$row-=1,this.$row<0)return this.$row=0,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=this.$rowTokens.length-1}return this.$rowTokens[this.$tokenIndex]},this.stepForward=function(){var e;for(this.$tokenIndex+=1;this.$tokenIndex>=this.$rowTokens.length;){if(this.$row+=1,e=e||this.$session.getLength(),this.$row>=e)return this.$row=e-1,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=0}return this.$rowTokens[this.$tokenIndex]},this.getCurrentToken=function(){return this.$rowTokens[this.$tokenIndex]},this.getCurrentTokenRow=function(){return this.$row},this.getCurrentTokenColumn=function(){var e=this.$rowTokens,t=this.$tokenIndex,i=e[t].start;if(void 0!==i)return i;for(i=0;0<t;)i+=e[t-=1].value.length;return i}}).call(n.prototype),t.TokenIterator=n}),ace.define("ace/mode/text",["require","exports","module","ace/tokenizer","ace/mode/text_highlight_rules","ace/mode/behaviour","ace/unicode","ace/lib/lang","ace/token_iterator","ace/range"],function(e,t,i){"use strict";function n(){this.HighlightRules=r,this.$behaviour=new a}var o=e("../tokenizer").Tokenizer,r=e("./text_highlight_rules").TextHighlightRules,a=e("./behaviour").Behaviour,s=e("../unicode"),C=e("../lib/lang"),g=e("../token_iterator").TokenIterator,m=e("../range").Range;(function(){this.tokenRe=new RegExp("^["+s.packages.L+s.packages.Mn+s.packages.Mc+s.packages.Nd+s.packages.Pc+"\\$_]+","g"),this.nonTokenRe=new RegExp("^(?:[^"+s.packages.L+s.packages.Mn+s.packages.Mc+s.packages.Nd+s.packages.Pc+"\\$_]|\\s])+","g"),this.getTokenizer=function(){return this.$tokenizer||(this.$highlightRules=this.$highlightRules||new this.HighlightRules,this.$tokenizer=new o(this.$highlightRules.getRules())),this.$tokenizer},this.lineCommentStart="",this.blockComment="",this.toggleCommentLines=function(e,o,i,n){var r=o.doc,a=!0,s=!0,l=1/0,c=o.getTabSize(),t=!1;if(this.lineCommentStart){if(Array.isArray(this.lineCommentStart))f=this.lineCommentStart.map(C.escapeRegExp).join("|"),h=this.lineCommentStart[0];else f=C.escapeRegExp(this.lineCommentStart),h=this.lineCommentStart;f=new RegExp("^(\\s*)(?:"+f+") ?"),t=o.getUseSoftTabs();v=function(e,t){var i=e.match(f);if(i){var n=i[1].length,o=i[0].length;d(e,n,o)||" "!=i[0][o-1]||o--,r.removeInLine(t,n,o)}};var u=h+" ",d=(m=function(e,t){a&&!/\S/.test(e)||(d(e,l,l)?r.insertInLine({row:t,column:l},u):r.insertInLine({row:t,column:l},h))},y=function(e,t){return f.test(e)},function(e,t,i){for(var n=0;t--&&" "==e.charAt(t);)n++;if(n%c!=0)return!1;for(n=0;" "==e.charAt(i++);)n++;return 2<c?n%c!=c-1:n%c==0})}else{if(!this.blockComment)return!1;var h=this.blockComment.start,p=this.blockComment.end,f=new RegExp("^(\\s*)(?:"+C.escapeRegExp(h)+")"),g=new RegExp("(?:"+C.escapeRegExp(p)+")\\s*$"),m=function(e,t){y(e,t)||a&&!/\S/.test(e)||(r.insertInLine({row:t,column:e.length},p),r.insertInLine({row:t,column:l},h))},v=function(e,t){var i;(i=e.match(g))&&r.removeInLine(t,e.length-i[0].length,e.length),(i=e.match(f))&&r.removeInLine(t,i[1].length,i[0].length)},y=function(e,t){if(f.test(e))return!0;for(var i=o.getTokens(t),n=0;n<i.length;n++)if("comment"===i[n].type)return!0}}function b(e){for(var t=i;t<=n;t++)e(r.getLine(t),t)}var w=1/0;b(function(e,t){var i=e.search(/\S/);-1!==i?(i<l&&(l=i),s&&!y(e,t)&&(s=!1)):w>e.length&&(w=e.length)}),l==1/0&&(l=w,s=a=!1),t&&l%c!=0&&(l=Math.floor(l/c)*c),b(s?v:m)},this.toggleBlockComment=function(e,t,i,n){var o=this.blockComment;if(o){!o.start&&o[0]&&(o=o[0]);var r,a,s=(p=new g(t,n.row,n.column)).getCurrentToken(),l=(t.selection,t.selection.toOrientedRange());if(s&&/comment/.test(s.type)){for(var c,u;s&&/comment/.test(s.type);){if(-1!=(f=s.value.indexOf(o.start))){var d=p.getCurrentTokenRow(),h=p.getCurrentTokenColumn()+f;c=new m(d,h,d,h+o.start.length);break}s=p.stepBackward()}var p;for(s=(p=new g(t,n.row,n.column)).getCurrentToken();s&&/comment/.test(s.type);){var f;if(-1!=(f=s.value.indexOf(o.end))){d=p.getCurrentTokenRow(),h=p.getCurrentTokenColumn()+f;u=new m(d,h,d,h+o.end.length);break}s=p.stepForward()}u&&t.remove(u),c&&(t.remove(c),r=c.start.row,a=-o.start.length)}else a=o.start.length,r=i.start.row,t.insert(i.end,o.end),t.insert(i.start,o.start);l.start.row==r&&(l.start.column+=a),l.end.row==r&&(l.end.column+=a),t.selection.fromOrientedRange(l)}},this.getNextLineIndent=function(e,t,i){return this.$getIndent(t)},this.checkOutdent=function(e,t,i){return!1},this.autoOutdent=function(e,t,i){},this.$getIndent=function(e){return e.match(/^\s*/)[0]},this.createWorker=function(e){return null},this.createModeDelegates=function(e){for(var n in this.$embeds=[],this.$modes={},e)e[n]&&(this.$embeds.push(n),this.$modes[n]=new e[n]);var o=["toggleBlockComment","toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction","getCompletions"];for(n=0;n<o.length;n++)!function(e){var t=o[n],i=e[t];e[o[n]]=function(){return this.$delegator(t,arguments,i)}}(this)},this.$delegator=function(e,t,i){var n=t[0];"string"!=typeof n&&(n=n[0]);for(var o=0;o<this.$embeds.length;o++)if(this.$modes[this.$embeds[o]]){var r=n.split(this.$embeds[o]);if(!r[0]&&r[1]){t[0]=r[1];var a=this.$modes[this.$embeds[o]];return a[e].apply(a,t)}}var s=i.apply(this,t);return i?s:void 0},this.transformAction=function(e,t,i,n,o){if(this.$behaviour){var r=this.$behaviour.getBehaviours();for(var a in r)if(r[a][t]){var s=r[a][t].apply(this,arguments);if(s)return s}}},this.getKeywords=function(e){if(!this.completionKeywords){var t=this.$tokenizer.rules,i=[];for(var n in t)for(var o=t[n],r=0,a=o.length;r<a;r++)if("string"==typeof o[r].token)/keyword|support|storage/.test(o[r].token)&&i.push(o[r].regex);else if("object"==typeof o[r].token)for(var s=0,l=o[r].token.length;s<l;s++)if(/keyword|support|storage/.test(o[r].token[s])){n=o[r].regex.match(/\(.+?\)/g)[s];i.push(n.substr(1,n.length-2))}this.completionKeywords=i}return e?i.concat(this.$keywordList||[]):this.$keywordList},this.$createKeywordList=function(){return this.$highlightRules||this.getTokenizer(),this.$keywordList=this.$highlightRules.$keywordList||[]},this.getCompletions=function(e,t,i,n){return(this.$keywordList||this.$createKeywordList()).map(function(e){return{name:e,value:e,score:0,meta:"keyword"}})},this.$id="ace/mode/text"}).call(n.prototype),t.Mode=n}),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(e,t,i){"use strict";var n=e("./lib/oop"),o=e("./lib/event_emitter").EventEmitter,r=t.Anchor=function(e,t,i){this.$onChange=this.onChange.bind(this),this.attach(e),void 0===i?this.setPosition(t.row,t.column):this.setPosition(t,i)};(function(){n.implement(this,o),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(e){var t=e.data,i=t.range;if((i.start.row!=i.end.row||i.start.row==this.row)&&!(i.start.row>this.row||i.start.row==this.row&&i.start.column>this.column)){var n=this.row,o=this.column,r=i.start,a=i.end;"insertText"===t.action?r.row===n&&r.column<=o?r.column===o&&this.$insertRight||(r.row===a.row?o+=a.column-r.column:(o-=r.column,n+=a.row-r.row)):r.row!==a.row&&r.row<n&&(n+=a.row-r.row):"insertLines"===t.action?r.row===n&&0===o&&this.$insertRight||r.row<=n&&(n+=a.row-r.row):"removeText"===t.action?r.row===n&&r.column<o?o=a.column>=o?r.column:Math.max(0,o-(a.column-r.column)):r.row!==a.row&&r.row<n?(a.row===n&&(o=Math.max(0,o-a.column)+r.column),n-=a.row-r.row):a.row===n&&(n-=a.row-r.row,o=Math.max(0,o-a.column)+r.column):"removeLines"==t.action&&r.row<=n&&(a.row<=n?n-=a.row-r.row:(n=r.row,o=0)),this.setPosition(n,o,!0)}},this.setPosition=function(e,t,i){var n;if(n=i?{row:e,column:t}:this.$clipPositionToDocument(e,t),this.row!=n.row||this.column!=n.column){var o={row:this.row,column:this.column};this.row=n.row,this.column=n.column,this._signal("change",{old:o,value:n})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(e){this.document=e||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(e,t){var i={};return e>=this.document.getLength()?(i.row=Math.max(0,this.document.getLength()-1),i.column=this.document.getLine(i.row).length):e<0?(i.row=0,i.column=0):(i.row=e,i.column=Math.min(this.document.getLine(i.row).length,Math.max(0,t))),t<0&&(i.column=0),i}}).call(r.prototype)}),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/lib/event_emitter","ace/range","ace/anchor"],function(e,t,i){"use strict";function n(e){this.$lines=[],0===e.length?this.$lines=[""]:Array.isArray(e)?this._insertLines(0,e):this.insert({row:0,column:0},e)}var o=e("./lib/oop"),r=e("./lib/event_emitter").EventEmitter,l=e("./range").Range,a=e("./anchor").Anchor;(function(){o.implement(this,r),this.setValue=function(e){var t=this.getLength();this.remove(new l(0,0,t,this.getLine(t-1).length)),this.insert({row:0,column:0},e)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(e,t){return new a(this,e,t)},0==="aaa".split(/a/).length?this.$split=function(e){return e.replace(/\r\n|\r/g,"\n").split("\n")}:this.$split=function(e){return e.split(/\r\n|\r|\n/)},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=t?t[1]:"\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this.$autoNewLine||"\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(e){this.$newLineMode!==e&&(this.$newLineMode=e,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(e){return"\r\n"==e||"\r"==e||"\n"==e},this.getLine=function(e){return this.$lines[e]||""},this.getLines=function(e,t){return this.$lines.slice(e,t+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(e){if(e.start.row==e.end.row)return this.getLine(e.start.row).substring(e.start.column,e.end.column);var t=this.getLines(e.start.row,e.end.row);t[0]=(t[0]||"").substring(e.start.column);var i=t.length-1;return e.end.row-e.start.row==i&&(t[i]=t[i].substring(0,e.end.column)),t.join(this.getNewLineCharacter())},this.$clipPosition=function(e){var t=this.getLength();return e.row>=t?(e.row=Math.max(0,t-1),e.column=this.getLine(t-1).length):e.row<0&&(e.row=0),e},this.insert=function(e,t){if(!t||0===t.length)return e;e=this.$clipPosition(e),this.getLength()<=1&&this.$detectNewLine(t);var i=this.$split(t),n=i.splice(0,1)[0],o=0==i.length?null:i.splice(i.length-1,1)[0];return e=this.insertInLine(e,n),null!==o&&(e=this.insertNewLine(e),e=this._insertLines(e.row,i),e=this.insertInLine(e,o||"")),e},this.insertLines=function(e,t){return e>=this.getLength()?this.insert({row:e,column:0},"\n"+t.join("\n")):this._insertLines(Math.max(e,0),t)},this._insertLines=function(e,t){if(0==t.length)return{row:e,column:0};for(;61440<t.length;){var i=this._insertLines(e,t.slice(0,61440));t=t.slice(61440),e=i.row}var n=[e,0];n.push.apply(n,t),this.$lines.splice.apply(this.$lines,n);var o=new l(e,0,e+t.length,0),r={action:"insertLines",range:o,lines:t};return this._signal("change",{data:r}),o.end},this.insertNewLine=function(e){e=this.$clipPosition(e);var t=this.$lines[e.row]||"";this.$lines[e.row]=t.substring(0,e.column),this.$lines.splice(e.row+1,0,t.substring(e.column,t.length));var i={row:e.row+1,column:0},n={action:"insertText",range:l.fromPoints(e,i),text:this.getNewLineCharacter()};return this._signal("change",{data:n}),i},this.insertInLine=function(e,t){if(0==t.length)return e;var i=this.$lines[e.row]||"";this.$lines[e.row]=i.substring(0,e.column)+t+i.substring(e.column);var n={row:e.row,column:e.column+t.length},o={action:"insertText",range:l.fromPoints(e,n),text:t};return this._signal("change",{data:o}),n},this.remove=function(e){if(e instanceof l||(e=l.fromPoints(e.start,e.end)),e.start=this.$clipPosition(e.start),e.end=this.$clipPosition(e.end),e.isEmpty())return e.start;var t=e.start.row,i=e.end.row;if(e.isMultiLine()){var n=0==e.start.column?t:t+1,o=i-1;0<e.end.column&&this.removeInLine(i,0,e.end.column),n<=o&&this._removeLines(n,o),n!=t&&(this.removeInLine(t,e.start.column,this.getLine(t).length),this.removeNewLine(e.start.row))}else this.removeInLine(t,e.start.column,e.end.column);return e.start},this.removeInLine=function(e,t,i){if(t!=i){var n=new l(e,t,e,i),o=this.getLine(e),r=o.substring(t,i),a=o.substring(0,t)+o.substring(i,o.length);this.$lines.splice(e,1,a);var s={action:"removeText",range:n,text:r};return this._signal("change",{data:s}),n.start}},this.removeLines=function(e,t){return e<0||t>=this.getLength()?this.remove(new l(e,0,t+1,0)):this._removeLines(e,t)},this._removeLines=function(e,t){var i=new l(e,0,t+1,0),n=this.$lines.splice(e,t-e+1),o={action:"removeLines",range:i,nl:this.getNewLineCharacter(),lines:n};return this._signal("change",{data:o}),n},this.removeNewLine=function(e){var t=this.getLine(e),i=this.getLine(e+1),n=new l(e,t.length,e+1,0),o=t+i;this.$lines.splice(e,2,o);var r={action:"removeText",range:n,text:this.getNewLineCharacter()};this._signal("change",{data:r})},this.replace=function(e,t){if(e instanceof l||(e=l.fromPoints(e.start,e.end)),0==t.length&&e.isEmpty())return e.start;if(t==this.getTextRange(e))return e.end;if(this.remove(e),t)var i=this.insert(e.start,t);else i=e.start;return i},this.applyDeltas=function(e){for(var t=0;t<e.length;t++){var i=e[t],n=l.fromPoints(i.range.start,i.range.end);"insertLines"==i.action?this.insertLines(n.start.row,i.lines):"insertText"==i.action?this.insert(n.start,i.text):"removeLines"==i.action?this._removeLines(n.start.row,n.end.row-1):"removeText"==i.action&&this.remove(n)}},this.revertDeltas=function(e){for(var t=e.length-1;0<=t;t--){var i=e[t],n=l.fromPoints(i.range.start,i.range.end);"insertLines"==i.action?this._removeLines(n.start.row,n.end.row-1):"insertText"==i.action?this.remove(n):"removeLines"==i.action?this._insertLines(n.start.row,i.lines):"removeText"==i.action&&this.insert(n.start,i.text)}},this.indexToPosition=function(e,t){for(var i=this.$lines||this.getAllLines(),n=this.getNewLineCharacter().length,o=t||0,r=i.length;o<r;o++)if((e-=i[o].length+n)<0)return{row:o,column:e+i[o].length+n};return{row:r-1,column:i[r-1].length}},this.positionToIndex=function(e,t){for(var i=this.$lines||this.getAllLines(),n=this.getNewLineCharacter().length,o=0,r=Math.min(e.row,i.length),a=t||0;a<r;++a)o+=i[a].length+n;return o+e.column}}).call(n.prototype),t.Document=n}),ace.define("ace/background_tokenizer",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(e,t,i){"use strict";function n(e,t){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.tokenizer=e;var s=this;this.$worker=function(){if(s.running){for(var e=new Date,t=s.currentLine,i=-1,n=s.doc;s.lines[t];)t++;var o=t,r=n.getLength(),a=0;for(s.running=!1;t<r;){for(s.$tokenizeRow(t),i=t;t++,s.lines[t];);if(++a%5==0&&20<new Date-e){s.running=setTimeout(s.$worker,20);break}}s.currentLine=t,o<=i&&s.fireUpdateEvent(o,i)}}}var o=e("./lib/oop"),r=e("./lib/event_emitter").EventEmitter;(function(){o.implement(this,r),this.setTokenizer=function(e){this.tokenizer=e,this.lines=[],this.states=[],this.start(0)},this.setDocument=function(e){this.doc=e,this.lines=[],this.states=[],this.stop()},this.fireUpdateEvent=function(e,t){var i={first:e,last:t};this._signal("update",{data:i})},this.start=function(e){this.currentLine=Math.min(e||0,this.currentLine,this.doc.getLength()),this.lines.splice(this.currentLine,this.lines.length),this.states.splice(this.currentLine,this.states.length),this.stop(),this.running=setTimeout(this.$worker,700)},this.scheduleStart=function(){this.running||(this.running=setTimeout(this.$worker,700))},this.$updateOnChange=function(e){var t=e.range,i=t.start.row,n=t.end.row-i;if(0==n)this.lines[i]=null;else if("removeText"==e.action||"removeLines"==e.action)this.lines.splice(i,1+n,null),this.states.splice(i,1+n,null);else{var o=Array(1+n);o.unshift(i,1),this.lines.splice.apply(this.lines,o),this.states.splice.apply(this.states,o)}this.currentLine=Math.min(i,this.currentLine,this.doc.getLength()),this.stop()},this.stop=function(){this.running&&clearTimeout(this.running),this.running=!1},this.getTokens=function(e){return this.lines[e]||this.$tokenizeRow(e)},this.getState=function(e){return this.currentLine==e&&this.$tokenizeRow(e),this.states[e]||"start"},this.$tokenizeRow=function(e){var t=this.doc.getLine(e),i=this.states[e-1],n=this.tokenizer.getLineTokens(t,i,e);return this.states[e]+""!=n.state+""?(this.states[e]=n.state,this.lines[e+1]=null,this.currentLine>e+1&&(this.currentLine=e+1)):this.currentLine==e&&(this.currentLine=e+1),this.lines[e]=n.tokens}}).call(n.prototype),t.BackgroundTokenizer=n}),ace.define("ace/search_highlight",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],function(e,t,i){"use strict";function n(e,t,i){this.setRegexp(e),this.clazz=t,this.type=i||"text"}var c=e("./lib/lang"),u=(e("./lib/oop"),e("./range").Range);(function(){this.MAX_RANGES=500,this.setRegexp=function(e){this.regExp+""!=e+""&&(this.regExp=e,this.cache=[])},this.update=function(e,t,i,n){if(this.regExp)for(var o=n.firstRow,r=n.lastRow,a=o;a<=r;a++){var s=this.cache[a];null==s&&((s=c.getMatchOffsets(i.getLine(a),this.regExp)).length>this.MAX_RANGES&&(s=s.slice(0,this.MAX_RANGES)),s=s.map(function(e){return new u(a,e.offset,a,e.offset+e.length)}),this.cache[a]=s.length?s:"");for(var l=s.length;l--;)t.drawSingleLineMarker(e,s[l].toScreenRange(i),this.clazz,n)}}}).call(n.prototype),t.SearchHighlight=n}),ace.define("ace/edit_session/fold_line",["require","exports","module","ace/range"],function(e,t,i){"use strict";var n=e("../range").Range;function c(e,t){this.foldData=e,Array.isArray(t)?this.folds=t:t=this.folds=[t];var i=t[t.length-1];this.range=new n(t[0].start.row,t[0].start.column,i.end.row,i.end.column),this.start=this.range.start,this.end=this.range.end,this.folds.forEach(function(e){e.setFoldLine(this)},this)}(function(){this.shiftRow=function(t){this.start.row+=t,this.end.row+=t,this.folds.forEach(function(e){e.start.row+=t,e.end.row+=t})},this.addFold=function(e){if(e.sameRow){if(e.start.row<this.startRow||e.endRow>this.endRow)throw new Error("Can't add a fold to this FoldLine as it has no connection");this.folds.push(e),this.folds.sort(function(e,t){return-e.range.compareEnd(t.start.row,t.start.column)}),0<this.range.compareEnd(e.start.row,e.start.column)?(this.end.row=e.end.row,this.end.column=e.end.column):this.range.compareStart(e.end.row,e.end.column)<0&&(this.start.row=e.start.row,this.start.column=e.start.column)}else if(e.start.row==this.end.row)this.folds.push(e),this.end.row=e.end.row,this.end.column=e.end.column;else{if(e.end.row!=this.start.row)throw new Error("Trying to add fold to FoldRow that doesn't have a matching row");this.folds.unshift(e),this.start.row=e.start.row,this.start.column=e.start.column}e.foldLine=this},this.containsRow=function(e){return e>=this.start.row&&e<=this.end.row},this.walk=function(e,t,i){var n,o,r=0,a=this.folds,s=!0;null==t&&(t=this.end.row,i=this.end.column);for(var l=0;l<a.length;l++){if(-1==(o=(n=a[l]).range.compareStart(t,i)))return void e(null,t,i,r,s);if(!e(null,n.start.row,n.start.column,r,s)&&e(n.placeholder,n.start.row,n.start.column,r)||0===o)return;s=!n.sameRow,r=n.end.column}e(null,t,i,r,s)},this.getNextFoldTo=function(e,t){for(var i,n,o=0;o<this.folds.length;o++){if(-1==(n=(i=this.folds[o]).range.compareEnd(e,t)))return{fold:i,kind:"after"};if(0===n)return{fold:i,kind:"inside"}}return null},this.addRemoveChars=function(e,t,i){var n,o,r=this.getNextFoldTo(e,t);if(r)if(n=r.fold,"inside"==r.kind&&n.start.column!=t&&n.start.row!=e)window.console&&window.console.log(e,t,n);else if(n.start.row==e){var a=(o=this.folds).indexOf(n);for(0===a&&(this.start.column+=i);a<o.length;a++){if((n=o[a]).start.column+=i,!n.sameRow)return;n.end.column+=i}this.end.column+=i}},this.split=function(e,t){var i=this.getNextFoldTo(e,t);if(!i||"inside"==i.kind)return null;var n=i.fold,o=this.folds,r=this.foldData,a=o.indexOf(n),s=o[a-1];this.end.row=s.end.row,this.end.column=s.end.column;var l=new c(r,o=o.splice(a,o.length-a));return r.splice(r.indexOf(this)+1,0,l),l},this.merge=function(e){for(var t=e.folds,i=0;i<t.length;i++)this.addFold(t[i]);var n=this.foldData;n.splice(n.indexOf(e),1)},this.toString=function(){var t=[this.range.toString()+": ["];return this.folds.forEach(function(e){t.push("  "+e.toString())}),t.push("]"),t.join("\n")},this.idxToPosition=function(e){for(var t=0,i=0;i<this.folds.length;i++){var n=this.folds[i];if((e-=n.start.column-t)<0)return{row:n.start.row,column:n.start.column+e};if((e-=n.placeholder.length)<0)return n.start;t=n.end.column}return{row:this.end.row,column:this.end.column+e}}}).call(c.prototype),t.FoldLine=c}),ace.define("ace/range_list",["require","exports","module","ace/range"],function(e,t,i){"use strict";function n(){this.ranges=[]}var l=e("./range").Range.comparePoints;(function(){this.comparePoints=l,this.pointIndex=function(e,t,i){for(var n=this.ranges,o=i||0;o<n.length;o++){var r=n[o],a=l(e,r.end);if(!(0<a)){var s=l(e,r.start);return 0===a?t&&0!==s?-o-2:o:0<s||0===s&&!t?o:-o-1}}return-o-1},this.add=function(e){var t=!e.isEmpty(),i=this.pointIndex(e.start,t);i<0&&(i=-i-1);var n=this.pointIndex(e.end,t,i);return n<0?n=-n-1:n++,this.ranges.splice(i,n-i,e)},this.addList=function(e){for(var t=[],i=e.length;i--;)t.push.call(t,this.add(e[i]));return t},this.substractPoint=function(e){var t=this.pointIndex(e);if(0<=t)return this.ranges.splice(t,1)},this.merge=function(){for(var e,t=[],i=this.ranges,n=(i=i.sort(function(e,t){return l(e.start,t.start)}))[0],o=1;o<i.length;o++){e=n,n=i[o];var r=l(e.end,n.start);r<0||(0!=r||e.isEmpty()||n.isEmpty())&&(l(e.end,n.end)<0&&(e.end.row=n.end.row,e.end.column=n.end.column),i.splice(o,1),t.push(n),n=e,o--)}return this.ranges=i,t},this.contains=function(e,t){return 0<=this.pointIndex({row:e,column:t})},this.containsPoint=function(e){return 0<=this.pointIndex(e)},this.rangeAtPoint=function(e){var t=this.pointIndex(e);if(0<=t)return this.ranges[t]},this.clipRows=function(e,t){var i=this.ranges;if(i[0].start.row>t||i[i.length-1].start.row<e)return[];var n=this.pointIndex({row:e,column:0});n<0&&(n=-n-1);var o=this.pointIndex({row:t,column:0},n);o<0&&(o=-o-1);for(var r=[],a=n;a<o;a++)r.push(i[a]);return r},this.removeAll=function(){return this.ranges.splice(0,this.ranges.length)},this.attach=function(e){this.session&&this.detach(),this.session=e,this.onChange=this.$onChange.bind(this),this.session.on("change",this.onChange)},this.detach=function(){this.session&&(this.session.removeListener("change",this.onChange),this.session=null)},this.$onChange=function(e){var t=e.data.range;if("i"==e.data.action[0])var i=t.start,n=t.end;else n=t.start,i=t.end;for(var o=i.row,r=n.row-o,a=-i.column+n.column,s=this.ranges,l=0,c=s.length;l<c;l++){if(!((u=s[l]).end.row<o)){if(u.start.row>o)break;if(u.start.row==o&&u.start.column>=i.column&&(u.start.column==i.column&&this.$insertRight||(u.start.column+=a,u.start.row+=r)),u.end.row==o&&u.end.column>=i.column){if(u.end.column==i.column&&this.$insertRight)continue;u.end.column==i.column&&0<a&&l<c-1&&u.end.column>u.start.column&&u.end.column==s[l+1].start.column&&(u.end.column-=a),u.end.column+=a,u.end.row+=r}}}if(0!=r&&l<c)for(;l<c;l++){var u;(u=s[l]).start.row+=r,u.end.row+=r}}}).call(n.prototype),t.RangeList=n}),ace.define("ace/edit_session/fold",["require","exports","module","ace/range","ace/range_list","ace/lib/oop"],function(e,t,i){"use strict";e("../range").Range;var n=e("../range_list").RangeList,o=e("../lib/oop"),r=t.Fold=function(e,t){this.foldLine=null,this.placeholder=t,this.range=e,this.start=e.start,this.end=e.end,this.sameRow=e.start.row==e.end.row,this.subFolds=this.ranges=[]};function s(e,t){e.row-=t.row,0==e.row&&(e.column-=t.column)}function a(e,t){0==e.row&&(e.column+=t.column),e.row+=t.row}o.inherits(r,n),function(){this.toString=function(){return'"'+this.placeholder+'" '+this.range.toString()},this.setFoldLine=function(t){this.foldLine=t,this.subFolds.forEach(function(e){e.setFoldLine(t)})},this.clone=function(){var e=this.range.clone(),t=new r(e,this.placeholder);return this.subFolds.forEach(function(e){t.subFolds.push(e.clone())}),t.collapseChildren=this.collapseChildren,t},this.addSubFold=function(e){if(!this.range.isEqual(e)){if(!this.range.containsRange(e))throw new Error("A fold can't intersect already existing fold"+e.range+this.range);!function(e,t){s(e.start,t),s(e.end,t)}(e,this.start);for(var t=e.start.row,i=e.start.column,n=0,o=-1;n<this.subFolds.length&&1==(o=this.subFolds[n].range.compare(t,i));n++);var r=this.subFolds[n];if(0==o)return r.addSubFold(e);t=e.range.end.row,i=e.range.end.column;var a=n;for(o=-1;a<this.subFolds.length&&1==(o=this.subFolds[a].range.compare(t,i));a++);this.subFolds[a];if(0==o)throw new Error("A fold can't intersect already existing fold"+e.range+this.range);this.subFolds.splice(n,a-n,e);return e.setFoldLine(this.foldLine),e}},this.restoreRange=function(e){return function(e,t){a(e.start,t),a(e.end,t)}(e,this.start)}}.call(r.prototype)}),ace.define("ace/edit_session/folding",["require","exports","module","ace/range","ace/edit_session/fold_line","ace/edit_session/fold","ace/token_iterator"],function(e,t,i){"use strict";var s=e("../range").Range,g=e("./fold_line").FoldLine,m=e("./fold").Fold,l=e("../token_iterator").TokenIterator;t.Folding=function(){this.getFoldAt=function(e,t,i){var n=this.getFoldLine(e);if(!n)return null;for(var o=n.folds,r=0;r<o.length;r++){var a=o[r];if(a.range.contains(e,t)){if(1==i&&a.range.isEnd(e,t))continue;if(-1==i&&a.range.isStart(e,t))continue;return a}}},this.getFoldsInRange=function(e){var t=e.start,i=e.end,n=this.$foldData,o=[];t.column+=1,i.column-=1;for(var r=0;r<n.length;r++){var a=n[r].range.compareRange(e);if(2!=a){if(-2==a)break;for(var s=n[r].folds,l=0;l<s.length;l++){var c=s[l];if(-2==(a=c.range.compareRange(e)))break;if(2!=a){if(42==a)break;o.push(c)}}}}return t.column-=1,i.column+=1,o},this.getFoldsInRangeList=function(e){if(Array.isArray(e)){var t=[];e.forEach(function(e){t=t.concat(this.getFoldsInRange(e))},this)}else t=this.getFoldsInRange(e);return t},this.getAllFolds=function(){for(var e=[],t=this.$foldData,i=0;i<t.length;i++)for(var n=0;n<t[i].folds.length;n++)e.push(t[i].folds[n]);return e},this.getFoldStringAt=function(e,t,i,n){if(!(n=n||this.getFoldLine(e)))return null;for(var o,r,a={end:{column:0}},s=0;s<n.folds.length;s++){var l=(r=n.folds[s]).range.compareEnd(e,t);if(-1==l){o=this.getLine(r.start.row).substring(a.end.column,r.start.column);break}if(0===l)return null;a=r}return o=o||this.getLine(r.start.row).substring(a.end.column),-1==i?o.substring(0,t-a.end.column):1==i?o.substring(t-a.end.column):o},this.getFoldLine=function(e,t){var i=this.$foldData,n=0;for(t&&(n=i.indexOf(t)),-1==n&&(n=0);n<i.length;n++){var o=i[n];if(o.start.row<=e&&o.end.row>=e)return o;if(o.end.row>e)return null}return null},this.getNextFoldLine=function(e,t){var i=this.$foldData,n=0;for(t&&(n=i.indexOf(t)),-1==n&&(n=0);n<i.length;n++){var o=i[n];if(o.end.row>=e)return o}return null},this.getFoldedRowCount=function(e,t){for(var i=this.$foldData,n=t-e+1,o=0;o<i.length;o++){var r=i[o],a=r.end.row,s=r.start.row;if(t<=a){s<t&&(e<=s?n-=t-s:n=0);break}e<=a&&(n-=e<=s?a-s:a-e+1)}return n},this.$addFoldLine=function(e){return this.$foldData.push(e),this.$foldData.sort(function(e,t){return e.start.row-t.start.row}),e},this.addFold=function(e,t){var i,n=this.$foldData,o=!1;e instanceof m?i=e:(i=new m(t,e)).collapseChildren=t.collapseChildren,this.$clipRangeToDocument(i.range);var r=i.start.row,a=i.start.column,s=i.end.row,l=i.end.column;if(!(r<s||r==s&&a<=l-2))throw new Error("The range has to be at least 2 characters width");var c=this.getFoldAt(r,a,1),u=this.getFoldAt(s,l,-1);if(c&&u==c)return c.addSubFold(i);c&&!c.range.isStart(r,a)&&this.removeFold(c),u&&!u.range.isEnd(s,l)&&this.removeFold(u);var d=this.getFoldsInRange(i.range);0<d.length&&(this.removeFolds(d),d.forEach(function(e){i.addSubFold(e)}));for(var h=0;h<n.length;h++){var p=n[h];if(s==p.start.row){p.addFold(i),o=!0;break}if(r==p.end.row){if(p.addFold(i),o=!0,!i.sameRow){var f=n[h+1];if(f&&f.start.row==s){p.merge(f);break}}break}if(s<=p.start.row)break}return o||(p=this.$addFoldLine(new g(this.$foldData,i))),this.$useWrapMode?this.$updateWrapData(p.start.row,p.start.row):this.$updateRowLengthCache(p.start.row,p.start.row),this.$modified=!0,this._emit("changeFold",{data:i,action:"add"}),i},this.addFolds=function(e){e.forEach(function(e){this.addFold(e)},this)},this.removeFold=function(e){var t=e.foldLine,i=t.start.row,n=t.end.row,o=this.$foldData,r=t.folds;if(1==r.length)o.splice(o.indexOf(t),1);else if(t.range.isEnd(e.end.row,e.end.column))r.pop(),t.end.row=r[r.length-1].end.row,t.end.column=r[r.length-1].end.column;else if(t.range.isStart(e.start.row,e.start.column))r.shift(),t.start.row=r[0].start.row,t.start.column=r[0].start.column;else if(e.sameRow)r.splice(r.indexOf(e),1);else{var a=t.split(e.start.row,e.start.column);(r=a.folds).shift(),a.start.row=r[0].start.row,a.start.column=r[0].start.column}this.$updating||(this.$useWrapMode?this.$updateWrapData(i,n):this.$updateRowLengthCache(i,n)),this.$modified=!0,this._emit("changeFold",{data:e,action:"remove"})},this.removeFolds=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i]);t.forEach(function(e){this.removeFold(e)},this),this.$modified=!0},this.expandFold=function(t){this.removeFold(t),t.subFolds.forEach(function(e){t.restoreRange(e),this.addFold(e)},this),0<t.collapseChildren&&this.foldAll(t.start.row+1,t.end.row,t.collapseChildren-1),t.subFolds=[]},this.expandFolds=function(e){e.forEach(function(e){this.expandFold(e)},this)},this.unfold=function(e,t){var i,n;if(null==e?(i=new s(0,0,this.getLength(),0),t=!0):i="number"==typeof e?new s(e,0,e,this.getLine(e).length):"row"in e?s.fromPoints(e,e):e,n=this.getFoldsInRangeList(i),t)this.removeFolds(n);else for(var o=n;o.length;)this.expandFolds(o),o=this.getFoldsInRangeList(i);if(n.length)return n},this.isRowFolded=function(e,t){return!!this.getFoldLine(e,t)},this.getRowFoldEnd=function(e,t){var i=this.getFoldLine(e,t);return i?i.end.row:e},this.getRowFoldStart=function(e,t){var i=this.getFoldLine(e,t);return i?i.start.row:e},this.getFoldDisplayLine=function(e,t,i,o,r){null==o&&(o=e.start.row),null==r&&(r=0),null==t&&(t=e.end.row),null==i&&(i=this.getLine(t).length);var a=this.doc,s="";return e.walk(function(e,t,i,n){if(!(t<o)){if(t==o){if(i<r)return;n=Math.max(r,n)}s+=null!=e?e:a.getLine(t).substring(n,i)}},t,i),s},this.getDisplayLine=function(e,t,i,n){var o,r=this.getFoldLine(e);return r?this.getFoldDisplayLine(r,e,t,i,n):(o=this.doc.getLine(e)).substring(n||0,t||o.length)},this.$cloneFoldData=function(){var i=[];return i=this.$foldData.map(function(e){var t=e.folds.map(function(e){return e.clone()});return new g(i,t)})},this.toggleFold=function(e){var t,i,n=this.selection.getRange();if(n.isEmpty()){var o=n.start;if(t=this.getFoldAt(o.row,o.column))return void this.expandFold(t);(i=this.findMatchingBracket(o))?1==n.comparePoint(i)?n.end=i:(n.start=i,n.start.column++,n.end.column--):(i=this.findMatchingBracket({row:o.row,column:o.column+1}))?(1==n.comparePoint(i)?n.end=i:n.start=i,n.start.column++):n=this.getCommentFoldRange(o.row,o.column)||n}else{var r=this.getFoldsInRange(n);if(e&&r.length)return void this.expandFolds(r);1==r.length&&(t=r[0])}if((t=t||this.getFoldAt(n.start.row,n.start.column))&&t.range.toString()==n.toString())this.expandFold(t);else{var a="...";if(!n.isMultiLine()){if((a=this.getTextRange(n)).length<4)return;a=a.trim().substring(0,2)+".."}this.addFold(a,n)}},this.getCommentFoldRange=function(e,t,i){var n=new l(this,e,t),o=n.getCurrentToken();if(o&&/^comment|string/.test(o.type)){var r=new s,a=new RegExp(o.type.replace(/\..*/,"\\."));if(1!=i){for(;(o=n.stepBackward())&&a.test(o.type););n.stepForward()}if(r.start.row=n.getCurrentTokenRow(),r.start.column=n.getCurrentTokenColumn()+2,n=new l(this,e,t),-1!=i){for(;(o=n.stepForward())&&a.test(o.type););o=n.stepBackward()}else o=n.getCurrentToken();return r.end.row=n.getCurrentTokenRow(),r.end.column=n.getCurrentTokenColumn()+o.value.length-2,r}},this.foldAll=function(e,t,i){null==i&&(i=1e5);var n=this.foldWidgets;if(n){t=t||this.getLength();for(var o=e=e||0;o<t;o++)if(null==n[o]&&(n[o]=this.getFoldWidget(o)),"start"==n[o]){var r=this.getFoldWidgetRange(o);if(r&&r.isMultiLine()&&r.end.row<=t&&r.start.row>=e){o=r.end.row;try{var a=this.addFold("...",r);a&&(a.collapseChildren=i)}catch(e){}}}}},this.$foldStyles={manual:1,markbegin:1,markbeginend:1},this.$foldStyle="markbegin",this.setFoldStyle=function(e){if(!this.$foldStyles[e])throw new Error("invalid fold style: "+e+"["+Object.keys(this.$foldStyles).join(", ")+"]");if(this.$foldStyle!=e){"manual"==(this.$foldStyle=e)&&this.unfold();var t=this.$foldMode;this.$setFolding(null),this.$setFolding(t)}},this.$setFolding=function(e){this.$foldMode!=e&&(this.$foldMode=e,this.off("change",this.$updateFoldWidgets),this.off("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets),this._emit("changeAnnotation"),e&&"manual"!=this.$foldStyle?(this.foldWidgets=[],this.getFoldWidget=e.getFoldWidget.bind(e,this,this.$foldStyle),this.getFoldWidgetRange=e.getFoldWidgetRange.bind(e,this,this.$foldStyle),this.$updateFoldWidgets=this.updateFoldWidgets.bind(this),this.$tokenizerUpdateFoldWidgets=this.tokenizerUpdateFoldWidgets.bind(this),this.on("change",this.$updateFoldWidgets),this.on("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets)):this.foldWidgets=null)},this.getParentFoldRangeData=function(e,t){var i=this.foldWidgets;if(!i||t&&i[e])return{};for(var n,o=e-1;0<=o;){var r=i[o];if(null==r&&(r=i[o]=this.getFoldWidget(o)),"start"==r){var a=this.getFoldWidgetRange(o);if(n=n||a,a&&a.end.row>=e)break}o--}return{range:-1!==o&&a,firstRange:n}},this.onFoldWidgetClick=function(e,t){var i={children:(t=t.domEvent).shiftKey,all:t.ctrlKey||t.metaKey,siblings:t.altKey};if(!this.$toggleFoldWidget(e,i)){var n=t.target||t.srcElement;n&&/ace_fold-widget/.test(n.className)&&(n.className+=" ace_invalid")}},this.$toggleFoldWidget=function(e,t){if(this.getFoldWidget){var i=this.getFoldWidget(e),n=this.getLine(e),o="end"===i?-1:1,r=this.getFoldAt(e,-1==o?0:n.length,o);if(r)t.children||t.all?this.removeFold(r):this.expandFold(r);else{var a=this.getFoldWidgetRange(e,!0);if(!a||a.isMultiLine()||!(r=this.getFoldAt(a.start.row,a.start.column,1))||!a.isEqual(r.range)){if(t.siblings){var s=this.getParentFoldRangeData(e);if(s.range)var l=s.range.start.row+1,c=s.range.end.row;this.foldAll(l,c,t.all?1e4:0)}else t.children?(c=a?a.end.row:this.getLength(),this.foldAll(e+1,a.end.row,t.all?1e4:0)):a&&(t.all&&(a.collapseChildren=1e4),this.addFold("...",a));return a}this.removeFold(r)}}},this.toggleFoldWidget=function(e){var t=this.selection.getCursor().row;t=this.getRowFoldStart(t);var i=this.$toggleFoldWidget(t,{});if(!i){var n=this.getParentFoldRangeData(t,!0);if(i=n.range||n.firstRange){t=i.start.row;var o=this.getFoldAt(t,this.getLine(t).length,1);o?this.removeFold(o):this.addFold("...",i)}}},this.updateFoldWidgets=function(e){var t=e.data,i=t.range,n=i.start.row,o=i.end.row-n;if(0==o)this.foldWidgets[n]=null;else if("removeText"==t.action||"removeLines"==t.action)this.foldWidgets.splice(n,1+o,null);else{var r=Array(1+o);r.unshift(n,1),this.foldWidgets.splice.apply(this.foldWidgets,r)}},this.tokenizerUpdateFoldWidgets=function(e){var t=e.data;t.first!=t.last&&this.foldWidgets.length>t.first&&this.foldWidgets.splice(t.first,this.foldWidgets.length)}}}),ace.define("ace/edit_session/bracket_match",["require","exports","module","ace/token_iterator","ace/range"],function(e,t,i){"use strict";var d=e("../token_iterator").TokenIterator,s=e("../range").Range;t.BracketMatch=function(){this.findMatchingBracket=function(e,t){if(0==e.column)return null;var i=t||this.getLine(e.row).charAt(e.column-1);if(""==i)return null;var n=i.match(/([\(\[\{])|([\)\]\}])/);return n?n[1]?this.$findClosingBracket(n[1],e):this.$findOpeningBracket(n[2],e):null},this.getBracketRange=function(e){var t,i=this.getLine(e.row),n=!0,o=i.charAt(e.column-1),r=o&&o.match(/([\(\[\{])|([\)\]\}])/);if(r||(o=i.charAt(e.column),e={row:e.row,column:e.column+1},r=o&&o.match(/([\(\[\{])|([\)\]\}])/),n=!1),!r)return null;if(r[1]){if(!(a=this.$findClosingBracket(r[1],e)))return null;t=s.fromPoints(e,a),n||(t.end.column++,t.start.column--),t.cursor=t.end}else{var a;if(!(a=this.$findOpeningBracket(r[2],e)))return null;t=s.fromPoints(a,e),n||(t.start.column++,t.end.column--),t.cursor=t.start}return t},this.$brackets={")":"(","(":")","]":"[","[":"]","{":"}","}":"{"},this.$findOpeningBracket=function(e,t,i){var n=this.$brackets[e],o=1,r=new d(this,t.row,t.column),a=r.getCurrentToken();if(a=a||r.stepForward()){i=i||new RegExp("(\\.?"+a.type.replace(".","\\.").replace("rparen",".paren").replace(/\b(?:end|start|begin)\b/,"")+")+");for(var s=t.column-r.getCurrentTokenColumn()-2,l=a.value;;){for(;0<=s;){var c=l.charAt(s);if(c==n){if(0==(o-=1))return{row:r.getCurrentTokenRow(),column:s+r.getCurrentTokenColumn()}}else c==e&&(o+=1);s-=1}for(;(a=r.stepBackward())&&!i.test(a.type););if(null==a)break;s=(l=a.value).length-1}return null}},this.$findClosingBracket=function(e,t,i){var n=this.$brackets[e],o=1,r=new d(this,t.row,t.column),a=r.getCurrentToken();if(a=a||r.stepForward()){i=i||new RegExp("(\\.?"+a.type.replace(".","\\.").replace("lparen",".paren").replace(/\b(?:end|start|begin)\b/,"")+")+");for(var s=t.column-r.getCurrentTokenColumn();;){for(var l=a.value,c=l.length;s<c;){var u=l.charAt(s);if(u==n){if(0==(o-=1))return{row:r.getCurrentTokenRow(),column:s+r.getCurrentTokenColumn()}}else u==e&&(o+=1);s+=1}for(;(a=r.stepForward())&&!i.test(a.type););if(null==a)break;s=0}return null}}}}),ace.define("ace/edit_session",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/config","ace/lib/event_emitter","ace/selection","ace/mode/text","ace/range","ace/document","ace/background_tokenizer","ace/search_highlight","ace/edit_session/folding","ace/edit_session/bracket_match"],function(e,t,i){"use strict";function n(e,t){this.$breakpoints=[],this.$decorations=[],this.$frontMarkers={},this.$backMarkers={},this.$markerId=1,this.$undoSelect=!0,this.$foldData=[],this.$foldData.toString=function(){return this.join("\n")},this.on("changeFold",this.onChangeFold.bind(this)),this.$onChange=this.onChange.bind(this),"object"==typeof e&&e.getLine||(e=new u(e)),this.setDocument(e),this.selection=new s(this),a.resetOptions(this),this.setMode(t),a._signal("session",this)}var o=e("./lib/oop"),r=e("./lib/lang"),a=e("./config"),l=e("./lib/event_emitter").EventEmitter,s=e("./selection").Selection,c=e("./mode/text").Mode,h=e("./range").Range,u=e("./document").Document,p=e("./background_tokenizer").BackgroundTokenizer,f=e("./search_highlight").SearchHighlight;(function(){o.implement(this,l),this.setDocument=function(e){this.doc&&this.doc.removeListener("change",this.$onChange),(this.doc=e).on("change",this.$onChange),this.bgTokenizer&&this.bgTokenizer.setDocument(this.getDocument()),this.resetCaches()},this.getDocument=function(){return this.doc},this.$resetRowCache=function(e){if(!e)return this.$docRowCache=[],void(this.$screenRowCache=[]);var t=this.$docRowCache.length,i=this.$getRowCacheIndex(this.$docRowCache,e)+1;i<t&&(this.$docRowCache.splice(i,t),this.$screenRowCache.splice(i,t))},this.$getRowCacheIndex=function(e,t){for(var i=0,n=e.length-1;i<=n;){var o=i+n>>1,r=e[o];if(r<t)i=1+o;else{if(!(t<r))return o;n=o-1}}return i-1},this.resetCaches=function(){this.$modified=!0,this.$wrapData=[],this.$rowLengthCache=[],this.$resetRowCache(0),this.bgTokenizer&&this.bgTokenizer.start(0)},this.onChangeFold=function(e){var t=e.data;this.$resetRowCache(t.start.row)},this.onChange=function(e){var t=e.data;this.$modified=!0,this.$resetRowCache(t.range.start.row);var i=this.$updateInternalDataOnChange(e);this.$fromUndo||!this.$undoManager||t.ignore||(this.$deltasDoc.push(t),i&&0!=i.length&&this.$deltasFold.push({action:"removeFolds",folds:i}),this.$informUndoManager.schedule()),this.bgTokenizer&&this.bgTokenizer.$updateOnChange(t),this._signal("change",e)},this.setValue=function(e){this.doc.setValue(e),this.selection.moveTo(0,0),this.$resetRowCache(0),this.$deltas=[],this.$deltasDoc=[],this.$deltasFold=[],this.setUndoManager(this.$undoManager),this.getUndoManager().reset()},this.getValue=this.toString=function(){return this.doc.getValue()},this.getSelection=function(){return this.selection},this.getState=function(e){return this.bgTokenizer.getState(e)},this.getTokens=function(e){return this.bgTokenizer.getTokens(e)},this.getTokenAt=function(e,t){var i,n=this.bgTokenizer.getTokens(e),o=0;if(null==t)r=n.length-1,o=this.getLine(e).length;else for(var r=0;r<n.length&&!(t<=(o+=n[r].value.length));r++);return(i=n[r])?(i.index=r,i.start=o-i.value.length,i):null},this.setUndoManager=function(e){if(this.$undoManager=e,this.$deltas=[],this.$deltasDoc=[],this.$deltasFold=[],this.$informUndoManager&&this.$informUndoManager.cancel(),e){var t=this;this.$syncInformUndoManager=function(){t.$informUndoManager.cancel(),t.$deltasFold.length&&(t.$deltas.push({group:"fold",deltas:t.$deltasFold}),t.$deltasFold=[]),t.$deltasDoc.length&&(t.$deltas.push({group:"doc",deltas:t.$deltasDoc}),t.$deltasDoc=[]),0<t.$deltas.length&&e.execute({action:"aceupdate",args:[t.$deltas,t],merge:t.mergeUndoDeltas}),t.mergeUndoDeltas=!1,t.$deltas=[]},this.$informUndoManager=r.delayedCall(this.$syncInformUndoManager)}},this.markUndoGroup=function(){this.$syncInformUndoManager&&this.$syncInformUndoManager()},this.$defaultUndoManager={undo:function(){},redo:function(){},reset:function(){}},this.getUndoManager=function(){return this.$undoManager||this.$defaultUndoManager},this.getTabString=function(){return this.getUseSoftTabs()?r.stringRepeat(" ",this.getTabSize()):"\t"},this.setUseSoftTabs=function(e){this.setOption("useSoftTabs",e)},this.getUseSoftTabs=function(){return this.$useSoftTabs&&!this.$mode.$indentWithTabs},this.setTabSize=function(e){this.setOption("tabSize",e)},this.getTabSize=function(){return this.$tabSize},this.isTabStop=function(e){return this.$useSoftTabs&&e.column%this.$tabSize==0},this.$overwrite=!1,this.setOverwrite=function(e){this.setOption("overwrite",e)},this.getOverwrite=function(){return this.$overwrite},this.toggleOverwrite=function(){this.setOverwrite(!this.$overwrite)},this.addGutterDecoration=function(e,t){this.$decorations[e]||(this.$decorations[e]=""),this.$decorations[e]+=" "+t,this._signal("changeBreakpoint",{})},this.removeGutterDecoration=function(e,t){this.$decorations[e]=(this.$decorations[e]||"").replace(" "+t,""),this._signal("changeBreakpoint",{})},this.getBreakpoints=function(){return this.$breakpoints},this.setBreakpoints=function(e){this.$breakpoints=[];for(var t=0;t<e.length;t++)this.$breakpoints[e[t]]="ace_breakpoint";this._signal("changeBreakpoint",{})},this.clearBreakpoints=function(){this.$breakpoints=[],this._signal("changeBreakpoint",{})},this.setBreakpoint=function(e,t){void 0===t&&(t="ace_breakpoint"),t?this.$breakpoints[e]=t:delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},this.clearBreakpoint=function(e){delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},this.addMarker=function(e,t,i,n){var o=this.$markerId++,r={range:e,type:i||"line",renderer:"function"==typeof i?i:null,clazz:t,inFront:!!n,id:o};return n?(this.$frontMarkers[o]=r,this._signal("changeFrontMarker")):(this.$backMarkers[o]=r,this._signal("changeBackMarker")),o},this.addDynamicMarker=function(e,t){if(e.update){var i=this.$markerId++;return e.id=i,e.inFront=!!t,t?(this.$frontMarkers[i]=e,this._signal("changeFrontMarker")):(this.$backMarkers[i]=e,this._signal("changeBackMarker")),e}},this.removeMarker=function(e){var t=this.$frontMarkers[e]||this.$backMarkers[e];if(t){var i=t.inFront?this.$frontMarkers:this.$backMarkers;t&&(delete i[e],this._signal(t.inFront?"changeFrontMarker":"changeBackMarker"))}},this.getMarkers=function(e){return e?this.$frontMarkers:this.$backMarkers},this.highlight=function(e){if(!this.$searchHighlight){var t=new f(null,"ace_selected-word","text");this.$searchHighlight=this.addDynamicMarker(t)}this.$searchHighlight.setRegexp(e)},this.highlightLines=function(e,t,i,n){"number"!=typeof t&&(i=t,t=e),i=i||"ace_step";var o=new h(e,0,t,1/0);return o.id=this.addMarker(o,i,"fullLine",n),o},this.setAnnotations=function(e){this.$annotations=e,this._signal("changeAnnotation",{})},this.getAnnotations=function(){return this.$annotations||[]},this.clearAnnotations=function(){this.setAnnotations([])},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r?\n)/m);this.$autoNewLine=t?t[1]:"\n"},this.getWordRange=function(e,t){var i=this.getLine(e),n=!1;if(0<t&&(n=!!i.charAt(t-1).match(this.tokenRe)),n=n||!!i.charAt(t).match(this.tokenRe))var o=this.tokenRe;else if(/^\s+$/.test(i.slice(t-1,t+1)))o=/\s/;else o=this.nonTokenRe;var r=t;if(0<r){for(;0<=--r&&i.charAt(r).match(o););r++}for(var a=t;a<i.length&&i.charAt(a).match(o);)a++;return new h(e,r,e,a)},this.getAWordRange=function(e,t){for(var i=this.getWordRange(e,t),n=this.getLine(i.end.row);n.charAt(i.end.column).match(/[ \t]/);)i.end.column+=1;return i},this.setNewLineMode=function(e){this.doc.setNewLineMode(e)},this.getNewLineMode=function(){return this.doc.getNewLineMode()},this.setUseWorker=function(e){this.setOption("useWorker",e)},this.getUseWorker=function(){return this.$useWorker},this.onReloadTokenizer=function(e){var t=e.data;this.bgTokenizer.start(t.first),this._signal("tokenizerUpdate",e)},this.$modes={},this.$mode=null,this.$modeId=null,this.setMode=function(e,t){if(e&&"object"==typeof e){if(e.getTokenizer)return this.$onChangeMode(e);var i=e,n=i.path}else n=e||"ace/mode/text";if(this.$modes["ace/mode/text"]||(this.$modes["ace/mode/text"]=new c),this.$modes[n]&&!i)return this.$onChangeMode(this.$modes[n]),void(t&&t());this.$modeId=n,a.loadModule(["mode",n],function(e){return this.$modeId!==n?t&&t():this.$modes[n]&&!i?this.$onChangeMode(this.$modes[n]):void(e&&e.Mode&&(e=new e.Mode(i),i||((this.$modes[n]=e).$id=n),this.$onChangeMode(e),t&&t()))}.bind(this)),this.$mode||this.$onChangeMode(this.$modes["ace/mode/text"],!0)},this.$onChangeMode=function(e,t){if(t||(this.$modeId=e.$id),this.$mode!==e){this.$mode=e,this.$stopWorker(),this.$useWorker&&this.$startWorker();var i=e.getTokenizer();if(void 0!==i.addEventListener){var n=this.onReloadTokenizer.bind(this);i.addEventListener("update",n)}if(this.bgTokenizer)this.bgTokenizer.setTokenizer(i);else{this.bgTokenizer=new p(i);var o=this;this.bgTokenizer.addEventListener("update",function(e){o._signal("tokenizerUpdate",e)})}this.bgTokenizer.setDocument(this.getDocument()),this.tokenRe=e.tokenRe,this.nonTokenRe=e.nonTokenRe,t||(e.attachToSession&&e.attachToSession(this),this.$options.wrapMethod.set.call(this,this.$wrapMethod),this.$setFolding(e.foldingRules),this.bgTokenizer.start(0),this._emit("changeMode"))}},this.$stopWorker=function(){this.$worker&&(this.$worker.terminate(),this.$worker=null)},this.$startWorker=function(){try{this.$worker=this.$mode.createWorker(this)}catch(e){a.warn("Could not load worker",e),this.$worker=null}},this.getMode=function(){return this.$mode},this.$scrollTop=0,this.setScrollTop=function(e){this.$scrollTop===e||isNaN(e)||(this.$scrollTop=e,this._signal("changeScrollTop",e))},this.getScrollTop=function(){return this.$scrollTop},this.$scrollLeft=0,this.setScrollLeft=function(e){this.$scrollLeft===e||isNaN(e)||(this.$scrollLeft=e,this._signal("changeScrollLeft",e))},this.getScrollLeft=function(){return this.$scrollLeft},this.getScreenWidth=function(){return this.$computeWidth(),this.lineWidgets?Math.max(this.getLineWidgetMaxWidth(),this.screenWidth):this.screenWidth},this.getLineWidgetMaxWidth=function(){if(null!=this.lineWidgetsWidth)return this.lineWidgetsWidth;var t=0;return this.lineWidgets.forEach(function(e){e&&e.screenWidth>t&&(t=e.screenWidth)}),this.lineWidgetWidth=t},this.$computeWidth=function(e){if(this.$modified||e){if(this.$modified=!1,this.$useWrapMode)return this.screenWidth=this.$wrapLimit;for(var t=this.doc.getAllLines(),i=this.$rowLengthCache,n=0,o=0,r=this.$foldData[o],a=r?r.start.row:1/0,s=t.length,l=0;l<s;l++){if(a<l){if(s<=(l=r.end.row+1))break;a=(r=this.$foldData[o++])?r.start.row:1/0}null==i[l]&&(i[l]=this.$getStringScreenWidth(t[l])[0]),i[l]>n&&(n=i[l])}this.screenWidth=n}},this.getLine=function(e){return this.doc.getLine(e)},this.getLines=function(e,t){return this.doc.getLines(e,t)},this.getLength=function(){return this.doc.getLength()},this.getTextRange=function(e){return this.doc.getTextRange(e||this.selection.getRange())},this.insert=function(e,t){return this.doc.insert(e,t)},this.remove=function(e){return this.doc.remove(e)},this.undoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var i=null,n=e.length-1;-1!=n;n--){var o=e[n];"doc"==o.group?(this.doc.revertDeltas(o.deltas),i=this.$getUndoSelection(o.deltas,!0,i)):o.deltas.forEach(function(e){this.addFolds(e.folds)},this)}return this.$fromUndo=!1,i&&this.$undoSelect&&!t&&this.selection.setSelectionRange(i),i}},this.redoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var i=null,n=0;n<e.length;n++){var o=e[n];"doc"==o.group&&(this.doc.applyDeltas(o.deltas),i=this.$getUndoSelection(o.deltas,!1,i))}return this.$fromUndo=!1,i&&this.$undoSelect&&!t&&this.selection.setSelectionRange(i),i}},this.setUndoSelect=function(e){this.$undoSelect=e},this.$getUndoSelection=function(e,i,t){function n(e){var t="insertText"===e.action||"insertLines"===e.action;return i?!t:t}var o,r,a=e[0];n(a)?o=h.fromPoints(a.range.start,a.range.end):o=h.fromPoints(a.range.start,a.range.start);for(var s=1;s<e.length;s++)n(a=e[s])?(r=a.range.start,-1==o.compare(r.row,r.column)&&o.setStart(a.range.start),r=a.range.end,1==o.compare(r.row,r.column)&&o.setEnd(a.range.end),!0):(r=a.range.start,-1==o.compare(r.row,r.column)&&(o=h.fromPoints(a.range.start,a.range.start)),!1);if(null!=t){0===h.comparePoints(t.start,o.start)&&(t.start.column+=o.end.column-o.start.column,t.end.column+=o.end.column-o.start.column);var l=t.compareRange(o);1==l?o.setStart(t.start):-1==l&&o.setEnd(t.end)}return o},this.replace=function(e,t){return this.doc.replace(e,t)},this.moveText=function(e,t,i){var n=this.getTextRange(e),o=this.getFoldsInRange(e),r=h.fromPoints(t,t);if(!i){this.remove(e);var a=e.start.row-e.end.row;(c=a?-e.end.column:e.start.column-e.end.column)&&(r.start.row==e.end.row&&r.start.column>e.end.column&&(r.start.column+=c),r.end.row==e.end.row&&r.end.column>e.end.column&&(r.end.column+=c)),a&&r.start.row>=e.end.row&&(r.start.row+=a,r.end.row+=a)}if(r.end=this.insert(r.start,n),o.length){var s=e.start,l=r.start,c=(a=l.row-s.row,l.column-s.column);this.addFolds(o.map(function(e){return(e=e.clone()).start.row==s.row&&(e.start.column+=c),e.end.row==s.row&&(e.end.column+=c),e.start.row+=a,e.end.row+=a,e}))}return r},this.indentRows=function(e,t,i){i=i.replace(/\t/g,this.getTabString());for(var n=e;n<=t;n++)this.insert({row:n,column:0},i)},this.outdentRows=function(e){for(var t=e.collapseRows(),i=new h(0,0,0,0),n=this.getTabSize(),o=t.start.row;o<=t.end.row;++o){var r=this.getLine(o);i.start.row=o,i.end.row=o;for(var a=0;a<n&&" "==r.charAt(a);++a);a<n&&"\t"==r.charAt(a)?(i.start.column=a,i.end.column=a+1):(i.start.column=0,i.end.column=a),this.remove(i)}},this.$moveLines=function(e,t,i){if(e=this.getRowFoldStart(e),t=this.getRowFoldEnd(t),i<0){if((o=this.getRowFoldStart(e+i))<0)return 0;var n=o-e}else if(0<i){var o;if((o=this.getRowFoldEnd(t+i))>this.doc.getLength()-1)return 0;n=o-t}else{e=this.$clipRowToDocument(e);n=(t=this.$clipRowToDocument(t))-e+1}var r=new h(e,0,t,Number.MAX_VALUE),a=this.getFoldsInRange(r).map(function(e){return(e=e.clone()).start.row+=n,e.end.row+=n,e}),s=0==i?this.doc.getLines(e,t):this.doc.removeLines(e,t);return this.doc.insertLines(e+n,s),a.length&&this.addFolds(a),n},this.moveLinesUp=function(e,t){return this.$moveLines(e,t,-1)},this.moveLinesDown=function(e,t){return this.$moveLines(e,t,1)},this.duplicateLines=function(e,t){return this.$moveLines(e,t,0)},this.$clipRowToDocument=function(e){return Math.max(0,Math.min(e,this.doc.getLength()-1))},this.$clipColumnToRow=function(e,t){return t<0?0:Math.min(this.doc.getLine(e).length,t)},this.$clipPositionToDocument=function(e,t){if(t=Math.max(0,t),e<0)t=e=0;else{var i=this.doc.getLength();t=i<=e?(e=i-1,this.doc.getLine(i-1).length):Math.min(this.doc.getLine(e).length,t)}return{row:e,column:t}},this.$clipRangeToDocument=function(e){e.start.row<0?(e.start.row=0,e.start.column=0):e.start.column=this.$clipColumnToRow(e.start.row,e.start.column);var t=this.doc.getLength()-1;return e.end.row>t?(e.end.row=t,e.end.column=this.doc.getLine(t).length):e.end.column=this.$clipColumnToRow(e.end.row,e.end.column),e},this.$wrapLimit=80,this.$useWrapMode=!1,this.$wrapLimitRange={min:null,max:null},this.setUseWrapMode=function(e){if(e!=this.$useWrapMode){if(this.$useWrapMode=e,this.$modified=!0,this.$resetRowCache(0),e){var t=this.getLength();this.$wrapData=Array(t),this.$updateWrapData(0,t-1)}this._signal("changeWrapMode")}},this.getUseWrapMode=function(){return this.$useWrapMode},this.setWrapLimitRange=function(e,t){this.$wrapLimitRange.min===e&&this.$wrapLimitRange.max===t||(this.$wrapLimitRange={min:e,max:t},this.$modified=!0,this._signal("changeWrapMode"))},this.adjustWrapLimit=function(e,t){var i=this.$wrapLimitRange;i.max<0&&(i={min:t,max:t});var n=this.$constrainWrapLimit(e,i.min,i.max);return n!=this.$wrapLimit&&1<n&&(this.$wrapLimit=n,this.$modified=!0,this.$useWrapMode&&(this.$updateWrapData(0,this.getLength()-1),this.$resetRowCache(0),this._signal("changeWrapLimit")),!0)},this.$constrainWrapLimit=function(e,t,i){return t&&(e=Math.max(t,e)),i&&(e=Math.min(i,e)),e},this.getWrapLimit=function(){return this.$wrapLimit},this.setWrapLimit=function(e){this.setWrapLimitRange(e,e)},this.getWrapLimitRange=function(){return{min:this.$wrapLimitRange.min,max:this.$wrapLimitRange.max}},this.$updateInternalDataOnChange=function(e){var t,i=this.$useWrapMode,n=e.data.action,o=e.data.range.start.row,r=e.data.range.end.row,a=e.data.range.start,s=e.data.range.end,l=null;if(t=-1!=n.indexOf("Lines")?(r="insertLines"==n?o+e.data.lines.length:o,e.data.lines?e.data.lines.length:r-o):r-o,this.$updating=!0,0!=t)if(-1!=n.indexOf("remove")){this[i?"$wrapData":"$rowLengthCache"].splice(o,t);var c=this.$foldData;l=this.getFoldsInRange(e.data.range),this.removeFolds(l);var u=0;if(g=this.getFoldLine(s.row)){g.addRemoveChars(s.row,s.column,a.column-s.column),g.shiftRow(-t);var d=this.getFoldLine(o);d&&d!==g&&(d.merge(g),g=d),u=c.indexOf(g)+1}for(;u<c.length;u++){(g=c[u]).start.row>=s.row&&g.shiftRow(-t)}r=o}else{var h=Array(t);h.unshift(o,0);var p=i?this.$wrapData:this.$rowLengthCache;p.splice.apply(p,h);c=this.$foldData,u=0;if(g=this.getFoldLine(o)){var f=g.range.compareInside(a.row,a.column);0==f?(g=g.split(a.row,a.column))&&(g.shiftRow(t),g.addRemoveChars(r,0,s.column-a.column)):-1==f&&(g.addRemoveChars(o,0,s.column-a.column),g.shiftRow(t)),u=c.indexOf(g)+1}for(;u<c.length;u++){var g;(g=c[u]).start.row>=o&&g.shiftRow(t)}}else t=Math.abs(e.data.range.start.column-e.data.range.end.column),-1!=n.indexOf("remove")&&(l=this.getFoldsInRange(e.data.range),this.removeFolds(l),t=-t),(g=this.getFoldLine(o))&&g.addRemoveChars(o,a.column,t);return i&&this.$wrapData.length!=this.doc.getLength()&&console.error("doc.getLength() and $wrapData.length have to be the same!"),this.$updating=!1,i?this.$updateWrapData(o,r):this.$updateRowLengthCache(o,r),l},this.$updateRowLengthCache=function(e,t,i){this.$rowLengthCache[e]=null,this.$rowLengthCache[t]=null},this.$updateWrapData=function(e,t){var a,i,s=this.doc.getAllLines(),n=this.getTabSize(),o=this.$wrapData,r=this.$wrapLimit,l=e;for(t=Math.min(t,s.length-1);l<=t;)(i=this.getFoldLine(l,i))?(a=[],i.walk(function(e,t,i,n){var o;if(null!=e){(o=this.$getDisplayTokens(e,a.length))[0]=u;for(var r=1;r<o.length;r++)o[r]=d}else o=this.$getDisplayTokens(s[t].substring(n,i),a.length);a=a.concat(o)}.bind(this),i.end.row,s[i.end.row].length+1),o[i.start.row]=this.$computeWrapSplits(a,r,n),l=i.end.row+1):(a=this.$getDisplayTokens(s[l]),o[l]=this.$computeWrapSplits(a,r,n),l++)};var u=3,d=4;function s(e){return!(e<4352)&&(4352<=e&&e<=4447||4515<=e&&e<=4519||4602<=e&&e<=4607||9001<=e&&e<=9002||11904<=e&&e<=11929||11931<=e&&e<=12019||12032<=e&&e<=12245||12272<=e&&e<=12283||12288<=e&&e<=12350||12353<=e&&e<=12438||12441<=e&&e<=12543||12549<=e&&e<=12589||12593<=e&&e<=12686||12688<=e&&e<=12730||12736<=e&&e<=12771||12784<=e&&e<=12830||12832<=e&&e<=12871||12880<=e&&e<=13054||13056<=e&&e<=19903||19968<=e&&e<=42124||42128<=e&&e<=42182||43360<=e&&e<=43388||44032<=e&&e<=55203||55216<=e&&e<=55238||55243<=e&&e<=55291||63744<=e&&e<=64255||65040<=e&&e<=65049||65072<=e&&e<=65106||65108<=e&&e<=65126||65128<=e&&e<=65131||65281<=e&&e<=65376||65504<=e&&e<=65510)}this.$computeWrapSplits=function(n,e){if(0==n.length)return[];var o=[],t=n.length,r=0,a=0,i=this.$wrapAsCode;function s(e){var t=n.slice(r,e),i=t.length;t.join("").replace(/12/g,function(){i-=1}).replace(/2/g,function(){i-=1}),a+=i,o.push(a),r=e}for(;e<t-r;){var l=r+e;if(10<=n[l-1]&&10<=n[l])s(l);else if(n[l]!=u&&n[l]!=d){for(var c=Math.max(l-(i?10:e-(e>>2)),r-1);c<l&&n[l]<u;)l--;if(i){for(;c<l&&n[l]<u;)l--;for(;c<l&&9==n[l];)l--}else for(;c<l&&n[l]<10;)l--;c<l?s(++l):(2==n[l=r+e]&&l--,s(l))}else{for(;l!=r-1&&n[l]!=u;l--);if(r<l){s(l);continue}for(l=r+e;l<n.length&&n[l]==d;l++);if(l==n.length)break;s(l)}}return o},this.$getDisplayTokens=function(e,t){var i,n=[];t=t||0;for(var o=0;o<e.length;o++){var r=e.charCodeAt(o);if(9==r){i=this.getScreenTabSize(n.length+t),n.push(11);for(var a=1;a<i;a++)n.push(12)}else 32==r?n.push(10):39<r&&r<48||57<r&&r<64?n.push(9):4352<=r&&s(r)?n.push(1,2):n.push(1)}return n},this.$getStringScreenWidth=function(e,t,i){if(0==t)return[0,0];var n,o;for(null==t&&(t=1/0),i=i||0,o=0;o<e.length&&(9==(n=e.charCodeAt(o))?i+=this.getScreenTabSize(i):4352<=n&&s(n)?i+=2:i+=1,!(t<i));o++);return[i,o]},this.lineWidgets=null,this.getRowLength=function(e){if(this.lineWidgets)var t=this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0;else t=0;return this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1+t:1+t},this.getRowLineCount=function(e){return this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1:1},this.getScreenLastRowColumn=function(e){var t=this.screenToDocumentPosition(e,Number.MAX_VALUE);return this.documentToScreenColumn(t.row,t.column)},this.getDocumentLastRowColumn=function(e,t){var i=this.documentToScreenRow(e,t);return this.getScreenLastRowColumn(i)},this.getDocumentLastRowColumnPosition=function(e,t){var i=this.documentToScreenRow(e,t);return this.screenToDocumentPosition(i,Number.MAX_VALUE/10)},this.getRowSplitData=function(e){return this.$useWrapMode?this.$wrapData[e]:void 0},this.getScreenTabSize=function(e){return this.$tabSize-e%this.$tabSize},this.screenToDocumentRow=function(e,t){return this.screenToDocumentPosition(e,t).row},this.screenToDocumentColumn=function(e,t){return this.screenToDocumentPosition(e,t).column},this.screenToDocumentPosition=function(e,t){if(e<0)return{row:0,column:0};var i,n,o=0,r=0,a=0,s=0,l=this.$screenRowCache,c=this.$getRowCacheIndex(l,e),u=l.length;if(u&&0<=c){a=l[c],o=this.$docRowCache[c];var d=e>l[u-1]}else d=!u;for(var h=this.getLength()-1,p=this.getNextFoldLine(o),f=p?p.start.row:1/0;a<=e&&!(e<a+(s=this.getRowLength(o))||h<=o);)a+=s,f<++o&&(o=p.end.row+1,f=(p=this.getNextFoldLine(o,p))?p.start.row:1/0),d&&(this.$docRowCache.push(o),this.$screenRowCache.push(a));if(p&&p.start.row<=o)i=this.getFoldDisplayLine(p),o=p.start.row;else{if(a+s<=e||h<o)return{row:h,column:this.getLine(h).length};i=this.getLine(o),p=null}if(this.$useWrapMode){var g=this.$wrapData[o];if(g){var m=Math.floor(e-a);n=g[m],0<m&&g.length&&(r=g[m-1]||g[g.length-1],i=i.substring(r))}}return r+=this.$getStringScreenWidth(i,t)[1],this.$useWrapMode&&n<=r&&(r=n-1),p?p.idxToPosition(r):{row:o,column:r}},this.documentToScreenPosition=function(e,t){if(void 0===t)var i=this.$clipPositionToDocument(e.row,e.column);else i=this.$clipPositionToDocument(e,t);e=i.row,t=i.column;var n,o=0,r=null;(n=this.getFoldAt(e,t,1))&&(e=n.start.row,t=n.start.column);var a,s=0,l=this.$docRowCache,c=this.$getRowCacheIndex(l,e),u=l.length;if(u&&0<=c){s=l[c],o=this.$screenRowCache[c];var d=e>l[u-1]}else d=!u;for(var h=this.getNextFoldLine(s),p=h?h.start.row:1/0;s<e;){if(p<=s){if(e<(a=h.end.row+1))break;p=(h=this.getNextFoldLine(a,h))?h.start.row:1/0}else a=s+1;o+=this.getRowLength(s),s=a,d&&(this.$docRowCache.push(s),this.$screenRowCache.push(o))}var f="";if(r=h&&p<=s?(f=this.getFoldDisplayLine(h,e,t),h.start.row):(f=this.getLine(e).substring(0,t),e),this.$useWrapMode){var g=this.$wrapData[r];if(g){for(var m=0;f.length>=g[m];)o++,m++;f=f.substring(g[m-1]||0,f.length)}}return{row:o,column:this.$getStringScreenWidth(f)[0]}},this.documentToScreenColumn=function(e,t){return this.documentToScreenPosition(e,t).column},this.documentToScreenRow=function(e,t){return this.documentToScreenPosition(e,t).row},this.getScreenLength=function(){var e=0,t=null;if(this.$useWrapMode)for(var i=this.$wrapData.length,n=0,o=(s=0,(t=this.$foldData[s++])?t.start.row:1/0);n<i;){var r=this.$wrapData[n];e+=r?r.length+1:1,o<++n&&(n=t.end.row+1,o=(t=this.$foldData[s++])?t.start.row:1/0)}else{e=this.getLength();for(var a=this.$foldData,s=0;s<a.length;s++)e-=(t=a[s]).end.row-t.start.row}return this.lineWidgets&&(e+=this.$getWidgetScreenLength()),e},this.$setFontMetrics=function(e){},this.destroy=function(){this.bgTokenizer&&(this.bgTokenizer.setDocument(null),this.bgTokenizer=null),this.$stopWorker()}}).call(n.prototype),e("./edit_session/folding").Folding.call(n.prototype),e("./edit_session/bracket_match").BracketMatch.call(n.prototype),a.defineOptions(n.prototype,"session",{wrap:{set:function(e){if(e&&"off"!=e?"free"==e?e=!0:"printMargin"==e?e=-1:"string"==typeof e&&(e=parseInt(e,10)||!1):e=!1,this.$wrap!=e){if(e){var t="number"==typeof e?e:null;this.setWrapLimitRange(t,t),this.setUseWrapMode(!0)}else this.setUseWrapMode(!1);this.$wrap=e}},get:function(){return this.getUseWrapMode()?-1==this.$wrap?"printMargin":this.getWrapLimitRange().min?this.$wrap:"free":"off"},handlesSet:!0},wrapMethod:{set:function(e){(e="auto"==e?"text"!=this.$mode.type:"text"!=e)!=this.$wrapAsCode&&(this.$wrapAsCode=e,this.$useWrapMode&&(this.$modified=!0,this.$resetRowCache(0),this.$updateWrapData(0,this.getLength()-1)))},initialValue:"auto"},firstLineNumber:{set:function(){this._signal("changeBreakpoint")},initialValue:1},useWorker:{set:function(e){this.$useWorker=e,this.$stopWorker(),e&&this.$startWorker()},initialValue:!0},useSoftTabs:{initialValue:!0},tabSize:{set:function(e){isNaN(e)||this.$tabSize===e||(this.$modified=!0,this.$rowLengthCache=[],this.$tabSize=e,this._signal("changeTabSize"))},initialValue:4,handlesSet:!0},overwrite:{set:function(e){this._signal("changeOverwrite")},initialValue:!1},newLineMode:{set:function(e){this.doc.setNewLineMode(e)},get:function(){return this.doc.getNewLineMode()},handlesSet:!0},mode:{set:function(e){this.setMode(e)},get:function(){return this.$modeId}}}),t.EditSession=n}),ace.define("ace/search",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],function(e,t,i){"use strict";function n(){this.$options={}}var w=e("./lib/lang"),o=e("./lib/oop"),C=e("./range").Range;(function(){this.set=function(e){return o.mixin(this.$options,e),this},this.getOptions=function(){return w.copyObject(this.$options)},this.setOptions=function(e){this.$options=e},this.find=function(e){var o=this.$options,t=this.$matchIterator(e,o);if(!t)return!1;var r=null;return t.forEach(function(e,t,i){if(e.start)r=e;else{var n=e.offset+(i||0);if(r=new C(t,n,t,n+e.length),!e.length&&o.start&&o.start.start&&0!=o.skipCurrent&&r.isEqual(o.start))return r=null,!1}return!0}),r},this.findAll=function(e){var t=this.$options;if(!t.needle)return[];this.$assembleRegExp(t);var i=t.range,n=i?e.getLines(i.start.row,i.end.row):e.doc.getAllLines(),o=[],r=t.re;if(t.$isMultiLine){var a,s=r.length,l=n.length-s;e:for(var c=r.offset||0;c<=l;c++){for(var u=0;u<s;u++)if(-1==n[c+u].search(r[u]))continue e;var d=n[c],h=n[c+s-1],p=d.length-d.match(r[0])[0].length,f=h.match(r[s-1])[0].length;a&&a.end.row===c&&a.end.column>p||(o.push(a=new C(c,p,c+s-1,f)),2<s&&(c=c+s-2))}}else for(var g=0;g<n.length;g++){var m=w.getMatchOffsets(n[g],r);for(u=0;u<m.length;u++){var v=m[u];o.push(new C(g,v.offset,g,v.offset+v.length))}}if(i){var y=i.start.column,b=i.start.column;for(g=0,u=o.length-1;g<u&&o[g].start.column<y&&o[g].start.row==i.start.row;)g++;for(;g<u&&o[u].end.column>b&&o[u].end.row==i.end.row;)u--;for(o=o.slice(g,u+1),g=0,u=o.length;g<u;g++)o[g].start.row+=i.start.row,o[g].end.row+=i.start.row}return o},this.replace=function(e,t){var i=this.$options,n=this.$assembleRegExp(i);if(i.$isMultiLine)return t;if(n){var o=n.exec(e);if(!o||o[0].length!=e.length)return null;if(t=e.replace(n,t),i.preserveCase){t=t.split("");for(var r=Math.min(e.length,e.length);r--;){var a=e[r];a&&a.toLowerCase()!=a?t[r]=t[r].toUpperCase():t[r]=t[r].toLowerCase()}t=t.join("")}return t}},this.$matchIterator=function(s,e){var l,c=this.$assembleRegExp(e);if(!c)return!1;if(e.$isMultiLine)var u=c.length,t=function(e,t,i){var n=e.search(c[0]);if(-1!=n){for(var o=1;o<u;o++)if(-1==(e=s.getLine(t+o)).search(c[o]))return;var r=e.match(c[u-1])[0].length,a=new C(t,n,t+u-1,r);return 1==c.offset?(a.start.row--,a.start.column=Number.MAX_VALUE):i&&(a.start.column+=i),!!l(a)||void 0}};else if(e.backwards)t=function(e,t,i){for(var n=w.getMatchOffsets(e,c),o=n.length-1;0<=o;o--)if(l(n[o],t,i))return!0};else t=function(e,t,i){for(var n=w.getMatchOffsets(e,c),o=0;o<n.length;o++)if(l(n[o],t,i))return!0};var i=this.$lineIterator(s,e);return{forEach:function(e){l=e,i.forEach(t)}}},this.$assembleRegExp=function(e,t){if(e.needle instanceof RegExp)return e.re=e.needle;var i=e.needle;if(!e.needle)return e.re=!1;e.regExp||(i=w.escapeRegExp(i)),e.wholeWord&&(i="\\b"+i+"\\b");var n=e.caseSensitive?"gm":"gmi";if(e.$isMultiLine=!t&&/[\n\r]/.test(i),e.$isMultiLine)return e.re=this.$assembleMultilineRegExp(i,n);try{var o=new RegExp(i,n)}catch(e){o=!1}return e.re=o},this.$assembleMultilineRegExp=function(e,t){for(var i=e.replace(/\r\n|\r|\n/g,"$\n^").split("\n"),n=[],o=0;o<i.length;o++)try{n.push(new RegExp(i[o],t))}catch(e){return!1}return""==i[0]?(n.shift(),n.offset=1):n.offset=0,n},this.$lineIterator=function(i,n){var e=1==n.backwards,t=0!=n.skipCurrent,o=n.range,r=n.start;(r=r||(o?o[e?"end":"start"]:i.selection.getRange())).start&&(r=r[t!=e?"end":"start"]);var a=o?o.start.row:0,s=o?o.end.row:i.getLength()-1;return{forEach:e?function(e){var t=r.row;if(!e(i.getLine(t).substring(0,r.column),t)){for(t--;a<=t;t--)if(e(i.getLine(t),t))return;if(0!=n.wrap)for(t=s,a=r.row;a<=t;t--)if(e(i.getLine(t),t))return}}:function(e){var t=r.row;if(!e(i.getLine(t).substr(r.column),t,r.column)){for(t+=1;t<=s;t++)if(e(i.getLine(t),t))return;if(0!=n.wrap)for(t=a,s=r.row;t<=s;t++)if(e(i.getLine(t),t))return}}}}}).call(n.prototype),t.Search=n}),ace.define("ace/keyboard/hash_handler",["require","exports","module","ace/lib/keys","ace/lib/useragent"],function(e,t,i){"use strict";var s=e("../lib/keys"),n=e("../lib/useragent"),l=s.KEY_MODS;function o(e,t){this.platform=t||(n.isMac?"mac":"win"),this.commands={},this.commandKeyBinding={},this.addCommands(e),this.$singleCommand=!0}function r(e,t){o.call(this,e,t),this.$singleCommand=!1}r.prototype=o.prototype,function(){this.addCommand=function(e){this.commands[e.name]&&this.removeCommand(e),(this.commands[e.name]=e).bindKey&&this._buildKeyHash(e)},this.removeCommand=function(e,t){var i=e&&("string"==typeof e?e:e.name);e=this.commands[i],t||delete this.commands[i];var n=this.commandKeyBinding;for(var o in n){var r=n[o];if(r==e)delete n[o];else if(Array.isArray(r)){var a=r.indexOf(e);-1!=a&&(r.splice(a,1),1==r.length&&(n[o]=r[0]))}}},this.bindKey=function(e,r,a){if("object"==typeof e&&(e=e[this.platform]),e)return"function"==typeof r?this.addCommand({exec:r,bindKey:e,name:r.name||e}):void e.split("|").forEach(function(e){var n="";if(-1!=e.indexOf(" ")){var t=e.split(/\s+/);e=t.pop(),t.forEach(function(e){var t=this.parseKeys(e),i=l[t.hashId]+t.key;n+=(n?" ":"")+i,this._addCommandToBinding(n,"chainKeys")},this),n+=" "}var i=this.parseKeys(e),o=l[i.hashId]+i.key;this._addCommandToBinding(n+o,r,a)},this)},this._addCommandToBinding=function(e,t,i){var n,o=this.commandKeyBinding;t?!o[e]||this.$singleCommand?o[e]=t:(Array.isArray(o[e])?-1!=(n=o[e].indexOf(t))&&o[e].splice(n,1):o[e]=[o[e]],i||t.isDefault?o[e].unshift(t):o[e].push(t)):delete o[e]},this.addCommands=function(i){i&&Object.keys(i).forEach(function(e){var t=i[e];if(t){if("string"==typeof t)return this.bindKey(t,e);"function"==typeof t&&(t={exec:t}),"object"==typeof t&&(t.name||(t.name=e),this.addCommand(t))}},this)},this.removeCommands=function(t){Object.keys(t).forEach(function(e){this.removeCommand(t[e])},this)},this.bindKeys=function(t){Object.keys(t).forEach(function(e){this.bindKey(e,t[e])},this)},this._buildKeyHash=function(e){this.bindKey(e.bindKey,e)},this.parseKeys=function(e){var t=e.toLowerCase().split(/[\-\+]([\-\+])?/).filter(function(e){return e}),i=t.pop(),n=s[i];if(s.FUNCTION_KEYS[n])i=s.FUNCTION_KEYS[n].toLowerCase();else{if(!t.length)return{key:i,hashId:-1};if(1==t.length&&"shift"==t[0])return{key:i.toUpperCase(),hashId:-1}}for(var o=0,r=t.length;r--;){var a=s.KEY_MODS[t[r]];if(null==a)return"undefined"!=typeof console&&console.error("invalid modifier "+t[r]+" in "+e),!1;o|=a}return{key:i,hashId:o}},this.findKeyCommand=function(e,t){var i=l[e]+t;return this.commandKeyBinding[i]},this.handleKeyboard=function(e,t,i,n){var o=l[t]+i,r=this.commandKeyBinding[o];return e.$keyChain&&(e.$keyChain+=" "+o,r=this.commandKeyBinding[e.$keyChain]||r),!r||"chainKeys"!=r&&"chainKeys"!=r[r.length-1]?(e.$keyChain&&0<n&&(e.$keyChain=""),{command:r}):(e.$keyChain=e.$keyChain||o,{command:"null"})}}.call(o.prototype),t.HashHandler=o,t.MultiHashHandler=r}),ace.define("ace/commands/command_manager",["require","exports","module","ace/lib/oop","ace/keyboard/hash_handler","ace/lib/event_emitter"],function(e,t,i){"use strict";function n(e,t){r.call(this,t,e),this.byName=this.commands,this.setDefaultHandler("exec",function(e){return e.command.exec(e.editor,e.args||{})})}var o=e("../lib/oop"),r=e("../keyboard/hash_handler").MultiHashHandler,a=e("../lib/event_emitter").EventEmitter;o.inherits(n,r),function(){o.implement(this,a),this.exec=function(e,t,i){if(Array.isArray(e)){for(var n=e.length;n--;)if(this.exec(e[n],t,i))return!0;return!1}if("string"==typeof e&&(e=this.commands[e]),!e)return!1;if(t&&t.$readOnly&&!e.readOnly)return!1;var o={editor:t,command:e,args:i};return o.returnValue=this._emit("exec",o),this._signal("afterExec",o),!1!==o.returnValue},this.toggleRecording=function(e){if(!this.$inReplay)return e&&e._emit("changeStatus"),this.recording?(this.macro.pop(),this.removeEventListener("exec",this.$addCommandToMacro),this.macro.length||(this.macro=this.oldMacro),this.recording=!1):(this.$addCommandToMacro||(this.$addCommandToMacro=function(e){this.macro.push([e.command,e.args])}.bind(this)),this.oldMacro=this.macro,this.macro=[],this.on("exec",this.$addCommandToMacro),this.recording=!0)},this.replay=function(t){if(!this.$inReplay&&this.macro){if(this.recording)return this.toggleRecording(t);try{this.$inReplay=!0,this.macro.forEach(function(e){"string"==typeof e?this.exec(e,t):this.exec(e[0],t,e[1])},this)}finally{this.$inReplay=!1}}},this.trimMacro=function(e){return e.map(function(e){return"string"!=typeof e[0]&&(e[0]=e[0].name),e[1]||(e=e[0]),e})}}.call(n.prototype),t.CommandManager=n}),ace.define("ace/commands/default_commands",["require","exports","module","ace/lib/lang","ace/config","ace/range"],function(e,t,i){"use strict";var c=e("../lib/lang"),n=e("../config"),u=e("../range").Range;function o(e,t){return{win:e,mac:t}}t.commands=[{name:"showSettingsMenu",bindKey:o("Ctrl-,","Command-,"),exec:function(t){n.loadModule("ace/ext/settings_menu",function(e){e.init(t),t.showSettingsMenu()})},readOnly:!0},{name:"goToNextError",bindKey:o("Alt-E","Ctrl-E"),exec:function(t){n.loadModule("ace/ext/error_marker",function(e){e.showErrorMarker(t,1)})},scrollIntoView:"animate",readOnly:!0},{name:"goToPreviousError",bindKey:o("Alt-Shift-E","Ctrl-Shift-E"),exec:function(t){n.loadModule("ace/ext/error_marker",function(e){e.showErrorMarker(t,-1)})},scrollIntoView:"animate",readOnly:!0},{name:"selectall",bindKey:o("Ctrl-A","Command-A"),exec:function(e){e.selectAll()},readOnly:!0},{name:"centerselection",bindKey:o(null,"Ctrl-L"),exec:function(e){e.centerSelection()},readOnly:!0},{name:"gotoline",bindKey:o("Ctrl-L","Command-L"),exec:function(e){var t=parseInt(prompt("Enter line number:"),10);isNaN(t)||e.gotoLine(t)},readOnly:!0},{name:"fold",bindKey:o("Alt-L|Ctrl-F1","Command-Alt-L|Command-F1"),exec:function(e){e.session.toggleFold(!1)},scrollIntoView:"center",readOnly:!0},{name:"unfold",bindKey:o("Alt-Shift-L|Ctrl-Shift-F1","Command-Alt-Shift-L|Command-Shift-F1"),exec:function(e){e.session.toggleFold(!0)},scrollIntoView:"center",readOnly:!0},{name:"toggleFoldWidget",bindKey:o("F2","F2"),exec:function(e){e.session.toggleFoldWidget()},scrollIntoView:"center",readOnly:!0},{name:"toggleParentFoldWidget",bindKey:o("Alt-F2","Alt-F2"),exec:function(e){e.session.toggleFoldWidget(!0)},scrollIntoView:"center",readOnly:!0},{name:"foldall",bindKey:o("Ctrl-Alt-0","Ctrl-Command-Option-0"),exec:function(e){e.session.foldAll()},scrollIntoView:"center",readOnly:!0},{name:"foldOther",bindKey:o("Alt-0","Command-Option-0"),exec:function(e){e.session.foldAll(),e.session.unfold(e.selection.getAllRanges())},scrollIntoView:"center",readOnly:!0},{name:"unfoldall",bindKey:o("Alt-Shift-0","Command-Option-Shift-0"),exec:function(e){e.session.unfold()},scrollIntoView:"center",readOnly:!0},{name:"findnext",bindKey:o("Ctrl-K","Command-G"),exec:function(e){e.findNext()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"findprevious",bindKey:o("Ctrl-Shift-K","Command-Shift-G"),exec:function(e){e.findPrevious()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"selectOrFindNext",bindKey:o("Alt-K","Ctrl-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findNext()},readOnly:!0},{name:"selectOrFindPrevious",bindKey:o("Alt-Shift-K","Ctrl-Shift-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findPrevious()},readOnly:!0},{name:"find",bindKey:o("Ctrl-F","Command-F"),exec:function(t){n.loadModule("ace/ext/searchbox",function(e){e.Search(t)})},readOnly:!0},{name:"overwrite",bindKey:"Insert",exec:function(e){e.toggleOverwrite()},readOnly:!0},{name:"selecttostart",bindKey:o("Ctrl-Shift-Home","Command-Shift-Up"),exec:function(e){e.getSelection().selectFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotostart",bindKey:o("Ctrl-Home","Command-Home|Command-Up"),exec:function(e){e.navigateFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectup",bindKey:o("Shift-Up","Shift-Up"),exec:function(e){e.getSelection().selectUp()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golineup",bindKey:o("Up","Up|Ctrl-P"),exec:function(e,t){e.navigateUp(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttoend",bindKey:o("Ctrl-Shift-End","Command-Shift-Down"),exec:function(e){e.getSelection().selectFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotoend",bindKey:o("Ctrl-End","Command-End|Command-Down"),exec:function(e){e.navigateFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectdown",bindKey:o("Shift-Down","Shift-Down"),exec:function(e){e.getSelection().selectDown()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golinedown",bindKey:o("Down","Down|Ctrl-N"),exec:function(e,t){e.navigateDown(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordleft",bindKey:o("Ctrl-Shift-Left","Option-Shift-Left"),exec:function(e){e.getSelection().selectWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordleft",bindKey:o("Ctrl-Left","Option-Left"),exec:function(e){e.navigateWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolinestart",bindKey:o("Alt-Shift-Left","Command-Shift-Left"),exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolinestart",bindKey:o("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(e){e.navigateLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectleft",bindKey:o("Shift-Left","Shift-Left"),exec:function(e){e.getSelection().selectLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoleft",bindKey:o("Left","Left|Ctrl-B"),exec:function(e,t){e.navigateLeft(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordright",bindKey:o("Ctrl-Shift-Right","Option-Shift-Right"),exec:function(e){e.getSelection().selectWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordright",bindKey:o("Ctrl-Right","Option-Right"),exec:function(e){e.navigateWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolineend",bindKey:o("Alt-Shift-Right","Command-Shift-Right"),exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolineend",bindKey:o("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(e){e.navigateLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectright",bindKey:o("Shift-Right","Shift-Right"),exec:function(e){e.getSelection().selectRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoright",bindKey:o("Right","Right|Ctrl-F"),exec:function(e,t){e.navigateRight(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectpagedown",bindKey:"Shift-PageDown",exec:function(e){e.selectPageDown()},readOnly:!0},{name:"pagedown",bindKey:o(null,"Option-PageDown"),exec:function(e){e.scrollPageDown()},readOnly:!0},{name:"gotopagedown",bindKey:o("PageDown","PageDown|Ctrl-V"),exec:function(e){e.gotoPageDown()},readOnly:!0},{name:"selectpageup",bindKey:"Shift-PageUp",exec:function(e){e.selectPageUp()},readOnly:!0},{name:"pageup",bindKey:o(null,"Option-PageUp"),exec:function(e){e.scrollPageUp()},readOnly:!0},{name:"gotopageup",bindKey:"PageUp",exec:function(e){e.gotoPageUp()},readOnly:!0},{name:"scrollup",bindKey:o("Ctrl-Up",null),exec:function(e){e.renderer.scrollBy(0,-2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"scrolldown",bindKey:o("Ctrl-Down",null),exec:function(e){e.renderer.scrollBy(0,2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"selectlinestart",bindKey:"Shift-Home",exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectlineend",bindKey:"Shift-End",exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"togglerecording",bindKey:o("Ctrl-Alt-E","Command-Option-E"),exec:function(e){e.commands.toggleRecording(e)},readOnly:!0},{name:"replaymacro",bindKey:o("Ctrl-Shift-E","Command-Shift-E"),exec:function(e){e.commands.replay(e)},readOnly:!0},{name:"jumptomatching",bindKey:o("Ctrl-P","Ctrl-P"),exec:function(e){e.jumpToMatching()},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"selecttomatching",bindKey:o("Ctrl-Shift-P","Ctrl-Shift-P"),exec:function(e){e.jumpToMatching(!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"expandToMatching",bindKey:o("Ctrl-Shift-M","Ctrl-Shift-M"),exec:function(e){e.jumpToMatching(!0,!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"passKeysToBrowser",bindKey:o("null","null"),exec:function(){},passEvent:!0,readOnly:!0},{name:"cut",exec:function(e){var t=e.getSelectionRange();e._emit("cut",t),e.selection.isEmpty()||(e.session.remove(t),e.clearSelection())},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"removeline",bindKey:o("Ctrl-D","Command-D"),exec:function(e){e.removeLines()},scrollIntoView:"cursor",multiSelectAction:"forEachLine"},{name:"duplicateSelection",bindKey:o("Ctrl-Shift-D","Command-Shift-D"),exec:function(e){e.duplicateSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"sortlines",bindKey:o("Ctrl-Alt-S","Command-Alt-S"),exec:function(e){e.sortLines()},scrollIntoView:"selection",multiSelectAction:"forEachLine"},{name:"togglecomment",bindKey:o("Ctrl-/","Command-/"),exec:function(e){e.toggleCommentLines()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"toggleBlockComment",bindKey:o("Ctrl-Shift-/","Command-Shift-/"),exec:function(e){e.toggleBlockComment()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"modifyNumberUp",bindKey:o("Ctrl-Shift-Up","Alt-Shift-Up"),exec:function(e){e.modifyNumber(1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"modifyNumberDown",bindKey:o("Ctrl-Shift-Down","Alt-Shift-Down"),exec:function(e){e.modifyNumber(-1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"replace",bindKey:o("Ctrl-H","Command-Option-F"),exec:function(t){n.loadModule("ace/ext/searchbox",function(e){e.Search(t,!0)})}},{name:"undo",bindKey:o("Ctrl-Z","Command-Z"),exec:function(e){e.undo()}},{name:"redo",bindKey:o("Ctrl-Shift-Z|Ctrl-Y","Command-Shift-Z|Command-Y"),exec:function(e){e.redo()}},{name:"copylinesup",bindKey:o("Alt-Shift-Up","Command-Option-Up"),exec:function(e){e.copyLinesUp()},scrollIntoView:"cursor"},{name:"movelinesup",bindKey:o("Alt-Up","Option-Up"),exec:function(e){e.moveLinesUp()},scrollIntoView:"cursor"},{name:"copylinesdown",bindKey:o("Alt-Shift-Down","Command-Option-Down"),exec:function(e){e.copyLinesDown()},scrollIntoView:"cursor"},{name:"movelinesdown",bindKey:o("Alt-Down","Option-Down"),exec:function(e){e.moveLinesDown()},scrollIntoView:"cursor"},{name:"del",bindKey:o("Delete","Delete|Ctrl-D|Shift-Delete"),exec:function(e){e.remove("right")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"backspace",bindKey:o("Shift-Backspace|Backspace","Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(e){e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"cut_or_delete",bindKey:o("Shift-Delete",null),exec:function(e){if(!e.selection.isEmpty())return!1;e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestart",bindKey:o("Alt-Backspace","Command-Backspace"),exec:function(e){e.removeToLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineend",bindKey:o("Alt-Delete","Ctrl-K"),exec:function(e){e.removeToLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordleft",bindKey:o("Ctrl-Backspace","Alt-Backspace|Ctrl-Alt-Backspace"),exec:function(e){e.removeWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordright",bindKey:o("Ctrl-Delete","Alt-Delete"),exec:function(e){e.removeWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"outdent",bindKey:o("Shift-Tab","Shift-Tab"),exec:function(e){e.blockOutdent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"indent",bindKey:o("Tab","Tab"),exec:function(e){e.indent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"blockoutdent",bindKey:o("Ctrl-[","Ctrl-["),exec:function(e){e.blockOutdent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"blockindent",bindKey:o("Ctrl-]","Ctrl-]"),exec:function(e){e.blockIndent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"insertstring",exec:function(e,t){e.insert(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"inserttext",exec:function(e,t){e.insert(c.stringRepeat(t.text||"",t.times||1))},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"splitline",bindKey:o(null,"Ctrl-O"),exec:function(e){e.splitLine()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"transposeletters",bindKey:o("Ctrl-T","Ctrl-T"),exec:function(e){e.transposeLetters()},multiSelectAction:function(e){e.transposeSelections(1)},scrollIntoView:"cursor"},{name:"touppercase",bindKey:o("Ctrl-U","Ctrl-U"),exec:function(e){e.toUpperCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"tolowercase",bindKey:o("Ctrl-Shift-U","Ctrl-Shift-U"),exec:function(e){e.toLowerCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"expandtoline",bindKey:o("Ctrl-Shift-L","Command-Shift-L"),exec:function(e){var t=e.selection.getRange();t.start.column=t.end.column=0,t.end.row++,e.selection.setRange(t,!1)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"joinlines",bindKey:o(null,null),exec:function(e){for(var t=e.selection.isBackwards(),i=t?e.selection.getSelectionLead():e.selection.getSelectionAnchor(),n=t?e.selection.getSelectionAnchor():e.selection.getSelectionLead(),o=e.session.doc.getLine(i.row).length,r=e.session.doc.getTextRange(e.selection.getRange()).replace(/\n\s*/," ").length,a=e.session.doc.getLine(i.row),s=i.row+1;s<=n.row+1;s++){var l=c.stringTrimLeft(c.stringTrimRight(e.session.doc.getLine(s)));0!==l.length&&(l=" "+l),a+=l}n.row+1<e.session.doc.getLength()-1&&(a+=e.session.doc.getNewLineCharacter()),e.clearSelection(),e.session.doc.replace(new u(i.row,0,n.row+2,0),a),0<r?(e.selection.moveCursorTo(i.row,i.column),e.selection.selectTo(i.row,i.column+r)):(o=e.session.doc.getLine(i.row).length>o?o+1:o,e.selection.moveCursorTo(i.row,o))},multiSelectAction:"forEach",readOnly:!0},{name:"invertSelection",bindKey:o(null,null),exec:function(e){var t=e.session.doc.getLength()-1,i=e.session.doc.getLine(t).length,n=e.selection.rangeList.ranges,o=[];n.length<1&&(n=[e.selection.getRange()]);for(var r=0;r<n.length;r++)r==n.length-1&&(n[r].end.row===t&&n[r].end.column===i||o.push(new u(n[r].end.row,n[r].end.column,t,i))),0===r?0===n[r].start.row&&0===n[r].start.column||o.push(new u(0,0,n[r].start.row,n[r].start.column)):o.push(new u(n[r-1].end.row,n[r-1].end.column,n[r].start.row,n[r].start.column));e.exitMultiSelectMode(),e.clearSelection();for(r=0;r<o.length;r++)e.selection.addRange(o[r],!1)},readOnly:!0,scrollIntoView:"none"}]}),ace.define("ace/editor",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/keyboard/textinput","ace/mouse/mouse_handler","ace/mouse/fold_handler","ace/keyboard/keybinding","ace/edit_session","ace/search","ace/range","ace/lib/event_emitter","ace/commands/command_manager","ace/commands/default_commands","ace/config","ace/token_iterator"],function(e,t,i){"use strict";e("./lib/fixoldbrowsers");function n(e,t){var i=e.getContainerElement();this.container=i,this.renderer=e,this.commands=new m(a.isMac?"mac":"win",v),this.textInput=new s(e.getTextAreaContainer(),this),this.renderer.textarea=this.textInput.getElement(),this.keyBinding=new d(this),this.$mouseHandler=new l(this),new c(this),this.$blockScrolling=0,this.$search=(new p).set({wrap:!0}),this.$historyTracker=this.$historyTracker.bind(this),this.commands.on("exec",this.$historyTracker),this.$initOperationListeners(),this._$emitInputEvent=u.delayedCall(function(){this._signal("input",{}),this.session&&this.session.bgTokenizer&&this.session.bgTokenizer.scheduleStart()}.bind(this)),this.on("change",function(e,t){t._$emitInputEvent.schedule(31)}),this.setSession(t||new h("")),y.resetOptions(this),y._signal("editor",this)}var r=e("./lib/oop"),o=e("./lib/dom"),u=e("./lib/lang"),a=e("./lib/useragent"),s=e("./keyboard/textinput").TextInput,l=e("./mouse/mouse_handler").MouseHandler,c=e("./mouse/fold_handler").FoldHandler,d=e("./keyboard/keybinding").KeyBinding,h=e("./edit_session").EditSession,p=e("./search").Search,g=e("./range").Range,f=e("./lib/event_emitter").EventEmitter,m=e("./commands/command_manager").CommandManager,v=e("./commands/default_commands").commands,y=e("./config"),b=e("./token_iterator").TokenIterator;(function(){r.implement(this,f),this.$initOperationListeners=function(){this.selections=[],this.commands.on("exec",this.startOperation.bind(this),!0),this.commands.on("afterExec",this.endOperation.bind(this),!0),this.$opResetTimer=u.delayedCall(this.endOperation.bind(this)),this.on("change",function(){this.curOp||this.startOperation(),this.curOp.docChanged=!0}.bind(this),!0),this.on("changeSelection",function(){this.curOp||this.startOperation(),this.curOp.selectionChanged=!0}.bind(this),!0)},this.curOp=null,this.prevOp={},this.startOperation=function(e){if(this.curOp){if(!e||this.curOp.command)return;this.prevOp=this.curOp}e||(this.previousCommand=null,e={}),this.$opResetTimer.schedule(),this.curOp={command:e.command||{},args:e.args,scrollTop:this.renderer.scrollTop},this.curOp.command.name&&this.$blockScrolling++},this.endOperation=function(e){if(this.curOp){if(e&&!1===e.returnValue)return this.curOp=null;this._signal("beforeEndOperation");var t=this.curOp.command;if(t.name&&this.$blockScrolling&&this.$blockScrolling--,t&&t.scrollIntoView){switch(t.scrollIntoView){case"center":this.renderer.scrollCursorIntoView(null,.5);break;case"animate":case"cursor":this.renderer.scrollCursorIntoView();break;case"selectionPart":var i=this.selection.getRange(),n=this.renderer.layerConfig;(i.start.row>=n.lastRow||i.end.row<=n.firstRow)&&this.renderer.scrollSelectionIntoView(this.selection.anchor,this.selection.lead)}"animate"==t.scrollIntoView&&this.renderer.animateScrolling(this.curOp.scrollTop)}this.prevOp=this.curOp,this.curOp=null}},this.$mergeableCommands=["backspace","del","insertstring"],this.$historyTracker=function(e){if(this.$mergeUndoDeltas){var t=this.prevOp,i=this.$mergeableCommands,n=t.command&&e.command.name==t.command.name;if("insertstring"==e.command.name){var o=e.args;void 0===this.mergeNextCommand&&(this.mergeNextCommand=!0),n=n&&this.mergeNextCommand&&(!/\s/.test(o)||/\s/.test(t.args)),this.mergeNextCommand=!0}else n=n&&-1!==i.indexOf(e.command.name);"always"!=this.$mergeUndoDeltas&&2e3<Date.now()-this.sequenceStartTime&&(n=!1),n?this.session.mergeUndoDeltas=!0:-1!==i.indexOf(e.command.name)&&(this.sequenceStartTime=Date.now())}},this.setKeyboardHandler=function(t,i){if(t&&"string"==typeof t){this.$keybindingId=t;var n=this;y.loadModule(["keybinding",t],function(e){n.$keybindingId==t&&n.keyBinding.setKeyboardHandler(e&&e.handler),i&&i()})}else this.$keybindingId=null,this.keyBinding.setKeyboardHandler(t),i&&i()},this.getKeyboardHandler=function(){return this.keyBinding.getKeyboardHandler()},this.setSession=function(e){if(this.session!=e){var t=this.session;if(t){this.session.removeEventListener("change",this.$onDocumentChange),this.session.removeEventListener("changeMode",this.$onChangeMode),this.session.removeEventListener("tokenizerUpdate",this.$onTokenizerUpdate),this.session.removeEventListener("changeTabSize",this.$onChangeTabSize),this.session.removeEventListener("changeWrapLimit",this.$onChangeWrapLimit),this.session.removeEventListener("changeWrapMode",this.$onChangeWrapMode),this.session.removeEventListener("onChangeFold",this.$onChangeFold),this.session.removeEventListener("changeFrontMarker",this.$onChangeFrontMarker),this.session.removeEventListener("changeBackMarker",this.$onChangeBackMarker),this.session.removeEventListener("changeBreakpoint",this.$onChangeBreakpoint),this.session.removeEventListener("changeAnnotation",this.$onChangeAnnotation),this.session.removeEventListener("changeOverwrite",this.$onCursorChange),this.session.removeEventListener("changeScrollTop",this.$onScrollTopChange),this.session.removeEventListener("changeScrollLeft",this.$onScrollLeftChange);var i=this.session.getSelection();i.removeEventListener("changeCursor",this.$onCursorChange),i.removeEventListener("changeSelection",this.$onSelectionChange)}(this.session=e)?(this.$onDocumentChange=this.onDocumentChange.bind(this),e.addEventListener("change",this.$onDocumentChange),this.renderer.setSession(e),this.$onChangeMode=this.onChangeMode.bind(this),e.addEventListener("changeMode",this.$onChangeMode),this.$onTokenizerUpdate=this.onTokenizerUpdate.bind(this),e.addEventListener("tokenizerUpdate",this.$onTokenizerUpdate),this.$onChangeTabSize=this.renderer.onChangeTabSize.bind(this.renderer),e.addEventListener("changeTabSize",this.$onChangeTabSize),this.$onChangeWrapLimit=this.onChangeWrapLimit.bind(this),e.addEventListener("changeWrapLimit",this.$onChangeWrapLimit),this.$onChangeWrapMode=this.onChangeWrapMode.bind(this),e.addEventListener("changeWrapMode",this.$onChangeWrapMode),this.$onChangeFold=this.onChangeFold.bind(this),e.addEventListener("changeFold",this.$onChangeFold),this.$onChangeFrontMarker=this.onChangeFrontMarker.bind(this),this.session.addEventListener("changeFrontMarker",this.$onChangeFrontMarker),this.$onChangeBackMarker=this.onChangeBackMarker.bind(this),this.session.addEventListener("changeBackMarker",this.$onChangeBackMarker),this.$onChangeBreakpoint=this.onChangeBreakpoint.bind(this),this.session.addEventListener("changeBreakpoint",this.$onChangeBreakpoint),this.$onChangeAnnotation=this.onChangeAnnotation.bind(this),this.session.addEventListener("changeAnnotation",this.$onChangeAnnotation),this.$onCursorChange=this.onCursorChange.bind(this),this.session.addEventListener("changeOverwrite",this.$onCursorChange),this.$onScrollTopChange=this.onScrollTopChange.bind(this),this.session.addEventListener("changeScrollTop",this.$onScrollTopChange),this.$onScrollLeftChange=this.onScrollLeftChange.bind(this),this.session.addEventListener("changeScrollLeft",this.$onScrollLeftChange),this.selection=e.getSelection(),this.selection.addEventListener("changeCursor",this.$onCursorChange),this.$onSelectionChange=this.onSelectionChange.bind(this),this.selection.addEventListener("changeSelection",this.$onSelectionChange),this.onChangeMode(),this.$blockScrolling+=1,this.onCursorChange(),this.$blockScrolling-=1,this.onScrollTopChange(),this.onScrollLeftChange(),this.onSelectionChange(),this.onChangeFrontMarker(),this.onChangeBackMarker(),this.onChangeBreakpoint(),this.onChangeAnnotation(),this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit(),this.renderer.updateFull()):(this.selection=null,this.renderer.setSession(e)),this._signal("changeSession",{session:e,oldSession:t}),t&&t._signal("changeEditor",{oldEditor:this}),e&&e._signal("changeEditor",{editor:this})}},this.getSession=function(){return this.session},this.setValue=function(e,t){return this.session.doc.setValue(e),t?1==t?this.navigateFileEnd():-1==t&&this.navigateFileStart():this.selectAll(),e},this.getValue=function(){return this.session.getValue()},this.getSelection=function(){return this.selection},this.resize=function(e){this.renderer.onResize(e)},this.setTheme=function(e,t){this.renderer.setTheme(e,t)},this.getTheme=function(){return this.renderer.getTheme()},this.setStyle=function(e){this.renderer.setStyle(e)},this.unsetStyle=function(e){this.renderer.unsetStyle(e)},this.getFontSize=function(){return this.getOption("fontSize")||o.computedStyle(this.container,"fontSize")},this.setFontSize=function(e){this.setOption("fontSize",e)},this.$highlightBrackets=function(){if(this.session.$bracketHighlight&&(this.session.removeMarker(this.session.$bracketHighlight),this.session.$bracketHighlight=null),!this.$highlightPending){var n=this;this.$highlightPending=!0,setTimeout(function(){n.$highlightPending=!1;var e=n.session;if(e&&e.bgTokenizer){var t=e.findMatchingBracket(n.getCursorPosition());if(t)var i=new g(t.row,t.column,t.row,t.column+1);else if(e.$mode.getMatching)i=e.$mode.getMatching(n.session);i&&(e.$bracketHighlight=e.addMarker(i,"ace_bracket","text"))}},50)}},this.$highlightTags=function(){if(!this.$highlightTagPending){var u=this;this.$highlightTagPending=!0,setTimeout(function(){u.$highlightTagPending=!1;var e=u.session;if(e&&e.bgTokenizer){var t=u.getCursorPosition(),i=new b(u.session,t.row,t.column),n=i.getCurrentToken();if(!n||!/\b(?:tag-open|tag-name)/.test(n.type))return e.removeMarker(e.$tagHighlight),void(e.$tagHighlight=null);-1!=n.type.indexOf("tag-open")&&(n=i.stepForward());var o=n.value,r=0,a=i.stepBackward();if("<"==a.value)for(;a=n,(n=i.stepForward())&&n.value===o&&-1!==n.type.indexOf("tag-name")&&("<"===a.value?r++:"</"===a.value&&r--),n&&0<=r;);else{for(;n=a,a=i.stepBackward(),n&&n.value===o&&-1!==n.type.indexOf("tag-name")&&("<"===a.value?r++:"</"===a.value&&r--),a&&r<=0;);i.stepForward()}if(!n)return e.removeMarker(e.$tagHighlight),void(e.$tagHighlight=null);var s=i.getCurrentTokenRow(),l=i.getCurrentTokenColumn(),c=new g(s,l,s,l+n.value.length);e.$tagHighlight&&0!==c.compareRange(e.$backMarkers[e.$tagHighlight].range)&&(e.removeMarker(e.$tagHighlight),e.$tagHighlight=null),c&&!e.$tagHighlight&&(e.$tagHighlight=e.addMarker(c,"ace_bracket","text"))}},50)}},this.focus=function(){var e=this;setTimeout(function(){e.textInput.focus()}),this.textInput.focus()},this.isFocused=function(){return this.textInput.isFocused()},this.blur=function(){this.textInput.blur()},this.onFocus=function(e){this.$isFocused||(this.$isFocused=!0,this.renderer.showCursor(),this.renderer.visualizeFocus(),this._emit("focus",e))},this.onBlur=function(e){this.$isFocused&&(this.$isFocused=!1,this.renderer.hideCursor(),this.renderer.visualizeBlur(),this._emit("blur",e))},this.$cursorChange=function(){this.renderer.updateCursor()},this.onDocumentChange=function(e){var t,i=e.data,n=i.range;t=n.start.row==n.end.row&&"insertLines"!=i.action&&"removeLines"!=i.action?n.end.row:1/0,this.renderer.updateLines(n.start.row,t,this.session.$useWrapMode),this._signal("change",e),this.$cursorChange(),this.$updateHighlightActiveLine()},this.onTokenizerUpdate=function(e){var t=e.data;this.renderer.updateLines(t.first,t.last)},this.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop())},this.onScrollLeftChange=function(){this.renderer.scrollToX(this.session.getScrollLeft())},this.onCursorChange=function(){this.$cursorChange(),this.$blockScrolling||(y.warn("Automatically scrolling cursor into view after selection change","this will be disabled in the next version","set editor.$blockScrolling = Infinity to disable this message"),this.renderer.scrollCursorIntoView()),this.$highlightBrackets(),this.$highlightTags(),this.$updateHighlightActiveLine(),this._signal("changeSelection")},this.$updateHighlightActiveLine=function(){var e,t=this.getSession();if(this.$highlightActiveLine&&("line"==this.$selectionStyle&&this.selection.isMultiLine()||(e=this.getCursorPosition()),!this.renderer.$maxLines||1!==this.session.getLength()||1<this.renderer.$minLines||(e=!1)),t.$highlightLineMarker&&!e)t.removeMarker(t.$highlightLineMarker.id),t.$highlightLineMarker=null;else if(!t.$highlightLineMarker&&e){var i=new g(e.row,e.column,e.row,1/0);i.id=t.addMarker(i,"ace_active-line","screenLine"),t.$highlightLineMarker=i}else e&&(t.$highlightLineMarker.start.row=e.row,t.$highlightLineMarker.end.row=e.row,t.$highlightLineMarker.start.column=e.column,t._signal("changeBackMarker"))},this.onSelectionChange=function(e){var t=this.session;if(t.$selectionMarker&&t.removeMarker(t.$selectionMarker),t.$selectionMarker=null,this.selection.isEmpty())this.$updateHighlightActiveLine();else{var i=this.selection.getRange(),n=this.getSelectionStyle();t.$selectionMarker=t.addMarker(i,"ace_selection",n)}var o=this.$highlightSelectedWord&&this.$getSelectionHighLightRegexp();this.session.highlight(o),this._signal("changeSelection")},this.$getSelectionHighLightRegexp=function(){var e=this.session,t=this.getSelectionRange();if(!t.isEmpty()&&!t.isMultiLine()){var i=t.start.column-1,n=t.end.column+1,o=e.getLine(t.start.row),r=o.length,a=o.substring(Math.max(i,0),Math.min(n,r));if(!(0<=i&&/^[\w\d]/.test(a)||n<=r&&/[\w\d]$/.test(a)))if(a=o.substring(t.start.column,t.end.column),/^[\w\d]+$/.test(a))return this.$search.$assembleRegExp({wholeWord:!0,caseSensitive:!0,needle:a})}},this.onChangeFrontMarker=function(){this.renderer.updateFrontMarkers()},this.onChangeBackMarker=function(){this.renderer.updateBackMarkers()},this.onChangeBreakpoint=function(){this.renderer.updateBreakpoints()},this.onChangeAnnotation=function(){this.renderer.setAnnotations(this.session.getAnnotations())},this.onChangeMode=function(e){this.renderer.updateText(),this._emit("changeMode",e)},this.onChangeWrapLimit=function(){this.renderer.updateFull()},this.onChangeWrapMode=function(){this.renderer.onResize(!0)},this.onChangeFold=function(){this.$updateHighlightActiveLine(),this.renderer.updateFull()},this.getSelectedText=function(){return this.session.getTextRange(this.getSelectionRange())},this.getCopyText=function(){var e=this.getSelectedText();return this._signal("copy",e),e},this.onCopy=function(){this.commands.exec("copy",this)},this.onCut=function(){this.commands.exec("cut",this)},this.onPaste=function(e){if(!this.$readOnly){var t={text:e};if(this._signal("paste",t),e=t.text,!this.inMultiSelectMode||this.inVirtualSelectionMode)this.insert(e);else{var i=e.split(/\r\n|\r|\n/),n=this.selection.rangeList.ranges;if(i.length>n.length||i.length<2||!i[1])return this.commands.exec("insertstring",this,e);for(var o=n.length;o--;){var r=n[o];r.isEmpty()||this.session.remove(r),this.session.insert(r.start,i[o])}}this.renderer.scrollCursorIntoView()}},this.execCommand=function(e,t){return this.commands.exec(e,this,t)},this.insert=function(e,t){var i=this.session,n=i.getMode(),o=this.getCursorPosition();if(this.getBehavioursEnabled()&&!t){var r=n.transformAction(i.getState(o.row),"insertion",this,i,e);r&&(e!==r.text&&(this.session.mergeUndoDeltas=!1,this.$mergeNextCommand=!1),e=r.text)}if("\t"==e&&(e=this.session.getTabString()),this.selection.isEmpty()){if(this.session.getOverwrite()){(a=new g.fromPoints(o,o)).end.column+=e.length,this.session.remove(a)}}else{var a=this.getSelectionRange();o=this.session.remove(a),this.clearSelection()}if("\n"==e||"\r\n"==e){var s=i.getLine(o.row);if(o.column>s.search(/\S|$/)){var l=s.substr(o.column).search(/\S|$/);i.doc.removeInLine(o.row,o.column,o.column+l)}}this.clearSelection();var c=o.column,u=i.getState(o.row),d=(s=i.getLine(o.row),n.checkOutdent(u,s,e));i.insert(o,e);if(r&&r.selection&&(2==r.selection.length?this.selection.setSelectionRange(new g(o.row,c+r.selection[0],o.row,c+r.selection[1])):this.selection.setSelectionRange(new g(o.row+r.selection[0],r.selection[1],o.row+r.selection[2],r.selection[3]))),i.getDocument().isNewLine(e)){var h=n.getNextLineIndent(u,s.slice(0,o.column),i.getTabString());i.insert({row:o.row+1,column:0},h)}d&&n.autoOutdent(u,i,o.row)},this.onTextInput=function(e){this.keyBinding.onTextInput(e)},this.onCommandKey=function(e,t,i){this.keyBinding.onCommandKey(e,t,i)},this.setOverwrite=function(e){this.session.setOverwrite(e)},this.getOverwrite=function(){return this.session.getOverwrite()},this.toggleOverwrite=function(){this.session.toggleOverwrite()},this.setScrollSpeed=function(e){this.setOption("scrollSpeed",e)},this.getScrollSpeed=function(){return this.getOption("scrollSpeed")},this.setDragDelay=function(e){this.setOption("dragDelay",e)},this.getDragDelay=function(){return this.getOption("dragDelay")},this.setSelectionStyle=function(e){this.setOption("selectionStyle",e)},this.getSelectionStyle=function(){return this.getOption("selectionStyle")},this.setHighlightActiveLine=function(e){this.setOption("highlightActiveLine",e)},this.getHighlightActiveLine=function(){return this.getOption("highlightActiveLine")},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.setHighlightSelectedWord=function(e){this.setOption("highlightSelectedWord",e)},this.getHighlightSelectedWord=function(){return this.$highlightSelectedWord},this.setAnimatedScroll=function(e){this.renderer.setAnimatedScroll(e)},this.getAnimatedScroll=function(){return this.renderer.getAnimatedScroll()},this.setShowInvisibles=function(e){this.renderer.setShowInvisibles(e)},this.getShowInvisibles=function(){return this.renderer.getShowInvisibles()},this.setDisplayIndentGuides=function(e){this.renderer.setDisplayIndentGuides(e)},this.getDisplayIndentGuides=function(){return this.renderer.getDisplayIndentGuides()},this.setShowPrintMargin=function(e){this.renderer.setShowPrintMargin(e)},this.getShowPrintMargin=function(){return this.renderer.getShowPrintMargin()},this.setPrintMarginColumn=function(e){this.renderer.setPrintMarginColumn(e)},this.getPrintMarginColumn=function(){return this.renderer.getPrintMarginColumn()},this.setReadOnly=function(e){this.setOption("readOnly",e)},this.getReadOnly=function(){return this.getOption("readOnly")},this.setBehavioursEnabled=function(e){this.setOption("behavioursEnabled",e)},this.getBehavioursEnabled=function(){return this.getOption("behavioursEnabled")},this.setWrapBehavioursEnabled=function(e){this.setOption("wrapBehavioursEnabled",e)},this.getWrapBehavioursEnabled=function(){return this.getOption("wrapBehavioursEnabled")},this.setShowFoldWidgets=function(e){this.setOption("showFoldWidgets",e)},this.getShowFoldWidgets=function(){return this.getOption("showFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.remove=function(e){this.selection.isEmpty()&&("left"==e?this.selection.selectLeft():this.selection.selectRight());var t=this.getSelectionRange();if(this.getBehavioursEnabled()){var i=this.session,n=i.getState(t.start.row),o=i.getMode().transformAction(n,"deletion",this,i,t);if(0===t.end.column){var r=i.getTextRange(t);if("\n"==r[r.length-1]){var a=i.getLine(t.end.row);/^\s+$/.test(a)&&(t.end.column=a.length)}}o&&(t=o)}this.session.remove(t),this.clearSelection()},this.removeWordRight=function(){this.selection.isEmpty()&&this.selection.selectWordRight(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeWordLeft=function(){this.selection.isEmpty()&&this.selection.selectWordLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineStart=function(){this.selection.isEmpty()&&this.selection.selectLineStart(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineEnd=function(){this.selection.isEmpty()&&this.selection.selectLineEnd();var e=this.getSelectionRange();e.start.column==e.end.column&&e.start.row==e.end.row&&(e.end.column=0,e.end.row++),this.session.remove(e),this.clearSelection()},this.splitLine=function(){this.selection.isEmpty()||(this.session.remove(this.getSelectionRange()),this.clearSelection());var e=this.getCursorPosition();this.insert("\n"),this.moveCursorToPosition(e)},this.transposeLetters=function(){if(this.selection.isEmpty()){var e=this.getCursorPosition(),t=e.column;if(0!==t){var i,n,o=this.session.getLine(e.row);n=t<o.length?(i=o.charAt(t)+o.charAt(t-1),new g(e.row,t-1,e.row,t+1)):(i=o.charAt(t-1)+o.charAt(t-2),new g(e.row,t-2,e.row,t)),this.session.replace(n,i)}}},this.toLowerCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),i=this.session.getTextRange(t);this.session.replace(t,i.toLowerCase()),this.selection.setSelectionRange(e)},this.toUpperCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),i=this.session.getTextRange(t);this.session.replace(t,i.toUpperCase()),this.selection.setSelectionRange(e)},this.indent=function(){var e=this.session,t=this.getSelectionRange();if(!(t.start.row<t.end.row)){if(t.start.column<t.end.column){var i=e.getTextRange(t);if(!/^\s+$/.test(i)){c=this.$getSelectedRows();return void e.indentRows(c.first,c.last,"\t")}}var n=e.getLine(t.start.row),o=t.start,r=e.getTabSize(),a=e.documentToScreenColumn(o.row,o.column);if(this.session.getUseSoftTabs())var s=r-a%r,l=u.stringRepeat(" ",s);else{for(s=a%r;" "==n[t.start.column]&&s;)t.start.column--,s--;this.selection.setSelectionRange(t),l="\t"}return this.insert(l)}var c=this.$getSelectedRows();e.indentRows(c.first,c.last,"\t")},this.blockIndent=function(){var e=this.$getSelectedRows();this.session.indentRows(e.first,e.last,"\t")},this.blockOutdent=function(){var e=this.session.getSelection();this.session.outdentRows(e.getRange())},this.sortLines=function(){var e=this.$getSelectedRows(),t=this.session,i=[];for(o=e.first;o<=e.last;o++)i.push(t.getLine(o));i.sort(function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0});for(var n=new g(0,0,0,0),o=e.first;o<=e.last;o++){var r=t.getLine(o);n.start.row=o,n.end.row=o,n.end.column=r.length,t.replace(n,i[o-e.first])}},this.toggleCommentLines=function(){var e=this.session.getState(this.getCursorPosition().row),t=this.$getSelectedRows();this.session.getMode().toggleCommentLines(e,this.session,t.first,t.last)},this.toggleBlockComment=function(){var e=this.getCursorPosition(),t=this.session.getState(e.row),i=this.getSelectionRange();this.session.getMode().toggleBlockComment(t,this.session,i,e)},this.getNumberAt=function(e,t){var i=/[\-]?[0-9]+(?:\.[0-9]+)?/g;i.lastIndex=0;for(var n=this.session.getLine(e);i.lastIndex<t;){var o=i.exec(n);if(o.index<=t&&o.index+o[0].length>=t)return{value:o[0],start:o.index,end:o.index+o[0].length}}return null},this.modifyNumber=function(e){var t=this.selection.getCursor().row,i=this.selection.getCursor().column,n=new g(t,i-1,t,i),o=this.session.getTextRange(n);if(!isNaN(parseFloat(o))&&isFinite(o)){var r=this.getNumberAt(t,i);if(r){var a=0<=r.value.indexOf(".")?r.start+r.value.indexOf(".")+1:r.end,s=r.start+r.value.length-a,l=parseFloat(r.value);l*=Math.pow(10,s),a!==r.end&&i<a?e*=Math.pow(10,r.end-i-1):e*=Math.pow(10,r.end-i),l+=e;var c=(l/=Math.pow(10,s)).toFixed(s),u=new g(t,r.start,t,r.end);this.session.replace(u,c),this.moveCursorTo(t,Math.max(r.start+1,i+c.length-r.value.length))}}},this.removeLines=function(){var e,t=this.$getSelectedRows();e=0===t.first||t.last+1<this.session.getLength()?new g(t.first,0,t.last+1,0):new g(t.first-1,this.session.getLine(t.first-1).length,t.last,this.session.getLine(t.last).length),this.session.remove(e),this.clearSelection()},this.duplicateSelection=function(){var e=this.selection,t=this.session,i=e.getRange(),n=e.isBackwards();if(i.isEmpty()){var o=i.start.row;t.duplicateLines(o,o)}else{var r=n?i.start:i.end,a=t.insert(r,t.getTextRange(i),!1);i.start=r,i.end=a,e.setSelectionRange(i,n)}},this.moveLinesDown=function(){this.$moveLines(1,!1)},this.moveLinesUp=function(){this.$moveLines(-1,!1)},this.moveText=function(e,t,i){return this.session.moveText(e,t,i)},this.copyLinesUp=function(){this.$moveLines(-1,!0)},this.copyLinesDown=function(){this.$moveLines(1,!0)},this.$moveLines=function(e,t){var i,n,o=this.selection;if(!o.inMultiSelectMode||this.inVirtualSelectionMode){var r=o.toOrientedRange();i=this.$getSelectedRows(r),n=this.session.$moveLines(i.first,i.last,t?0:e),t&&-1==e&&(n=0),r.moveBy(n,0),o.fromOrientedRange(r)}else{var a=o.rangeList.ranges;o.rangeList.detach(this.session),this.inVirtualSelectionMode=!0;for(var s=0,l=0,c=a.length,u=0;u<c;u++){var d=u;a[u].moveBy(s,0);for(var h=(i=this.$getSelectedRows(a[u])).first,p=i.last;++u<c;){l&&a[u].moveBy(l,0);var f=this.$getSelectedRows(a[u]);if(t&&f.first!=p)break;if(!t&&f.first>p+1)break;p=f.last}for(u--,s=this.session.$moveLines(h,p,t?0:e),t&&-1==e&&(d=u+1);d<=u;)a[d].moveBy(s,0),d++;t||(s=0),l+=s}o.fromOrientedRange(o.ranges[0]),o.rangeList.attach(this.session),this.inVirtualSelectionMode=!1}},this.$getSelectedRows=function(e){return e=(e||this.getSelectionRange()).collapseRows(),{first:this.session.getRowFoldStart(e.start.row),last:this.session.getRowFoldEnd(e.end.row)}},this.onCompositionStart=function(e){this.renderer.showComposition(this.getCursorPosition())},this.onCompositionUpdate=function(e){this.renderer.setCompositionText(e)},this.onCompositionEnd=function(){this.renderer.hideComposition()},this.getFirstVisibleRow=function(){return this.renderer.getFirstVisibleRow()},this.getLastVisibleRow=function(){return this.renderer.getLastVisibleRow()},this.isRowVisible=function(e){return e>=this.getFirstVisibleRow()&&e<=this.getLastVisibleRow()},this.isRowFullyVisible=function(e){return e>=this.renderer.getFirstFullyVisibleRow()&&e<=this.renderer.getLastFullyVisibleRow()},this.$getVisibleRowCount=function(){return this.renderer.getScrollBottomRow()-this.renderer.getScrollTopRow()+1},this.$moveByPage=function(e,t){var i=this.renderer,n=this.renderer.layerConfig,o=e*Math.floor(n.height/n.lineHeight);this.$blockScrolling++,!0===t?this.selection.$moveSelection(function(){this.moveCursorBy(o,0)}):!1===t&&(this.selection.moveCursorBy(o,0),this.selection.clearSelection()),this.$blockScrolling--;var r=i.scrollTop;i.scrollBy(0,o*n.lineHeight),null!=t&&i.scrollCursorIntoView(null,.5),i.animateScrolling(r)},this.selectPageDown=function(){this.$moveByPage(1,!0)},this.selectPageUp=function(){this.$moveByPage(-1,!0)},this.gotoPageDown=function(){this.$moveByPage(1,!1)},this.gotoPageUp=function(){this.$moveByPage(-1,!1)},this.scrollPageDown=function(){this.$moveByPage(1)},this.scrollPageUp=function(){this.$moveByPage(-1)},this.scrollToRow=function(e){this.renderer.scrollToRow(e)},this.scrollToLine=function(e,t,i,n){this.renderer.scrollToLine(e,t,i,n)},this.centerSelection=function(){var e=this.getSelectionRange(),t={row:Math.floor(e.start.row+(e.end.row-e.start.row)/2),column:Math.floor(e.start.column+(e.end.column-e.start.column)/2)};this.renderer.alignCursor(t,.5)},this.getCursorPosition=function(){return this.selection.getCursor()},this.getCursorPositionScreen=function(){return this.session.documentToScreenPosition(this.getCursorPosition())},this.getSelectionRange=function(){return this.selection.getRange()},this.selectAll=function(){this.$blockScrolling+=1,this.selection.selectAll(),this.$blockScrolling-=1},this.clearSelection=function(){this.selection.clearSelection()},this.moveCursorTo=function(e,t){this.selection.moveCursorTo(e,t)},this.moveCursorToPosition=function(e){this.selection.moveCursorToPosition(e)},this.jumpToMatching=function(e,t){var i=this.getCursorPosition(),n=new b(this.session,i.row,i.column),o=n.getCurrentToken(),r=o||n.stepForward();if(r){var a,s,l=!1,c={},u=i.column-r.start,d={")":"(","(":"(","]":"[","[":"[","{":"{","}":"{"};do{if(r.value.match(/[{}()\[\]]/g)){for(;u<r.value.length&&!l;u++)if(d[r.value[u]])switch(s=d[r.value[u]]+"."+r.type.replace("rparen","lparen"),isNaN(c[s])&&(c[s]=0),r.value[u]){case"(":case"[":case"{":c[s]++;break;case")":case"]":case"}":c[s]--,-1===c[s]&&(a="bracket",l=!0)}}else r&&-1!==r.type.indexOf("tag-name")&&(isNaN(c[r.value])&&(c[r.value]=0),"<"===o.value?c[r.value]++:"</"===o.value&&c[r.value]--,-1===c[r.value]&&(a="tag",l=!0));l||(o=r,r=n.stepForward(),u=0)}while(r&&!l);if(a){var h,p;if("bracket"===a)(h=this.session.getBracketRange(i))||(p=(h=new g(n.getCurrentTokenRow(),n.getCurrentTokenColumn()+u-1,n.getCurrentTokenRow(),n.getCurrentTokenColumn()+u-1)).start,(t||p.row===i.row&&Math.abs(p.column-i.column)<2)&&(h=this.session.getBracketRange(p)));else if("tag"===a){if(!r||-1===r.type.indexOf("tag-name"))return;var f=r.value;if(0===(h=new g(n.getCurrentTokenRow(),n.getCurrentTokenColumn()-2,n.getCurrentTokenRow(),n.getCurrentTokenColumn()-2)).compare(i.row,i.column))for(l=!1;r=o,(o=n.stepBackward())&&(-1!==o.type.indexOf("tag-close")&&h.setEnd(n.getCurrentTokenRow(),n.getCurrentTokenColumn()+1),r.value===f&&-1!==r.type.indexOf("tag-name")&&("<"===o.value?c[f]++:"</"===o.value&&c[f]--,0===c[f]&&(l=!0))),o&&!l;);r&&r.type.indexOf("tag-name")&&(p=h.start).row==i.row&&Math.abs(p.column-i.column)<2&&(p=h.end)}(p=h&&h.cursor||p)&&(e?h&&t?this.selection.setRange(h):h&&h.isEqual(this.getSelectionRange())?this.clearSelection():this.selection.selectTo(p.row,p.column):this.selection.moveTo(p.row,p.column))}}},this.gotoLine=function(e,t,i){this.selection.clearSelection(),this.session.unfold({row:e-1,column:t||0}),this.$blockScrolling+=1,this.exitMultiSelectMode&&this.exitMultiSelectMode(),this.moveCursorTo(e-1,t||0),this.$blockScrolling-=1,this.isRowFullyVisible(e-1)||this.scrollToLine(e-1,!0,i)},this.navigateTo=function(e,t){this.selection.moveTo(e,t)},this.navigateUp=function(e){if(this.selection.isMultiLine()&&!this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(-e||-1,0)},this.navigateDown=function(e){if(this.selection.isMultiLine()&&this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(e||1,0)},this.navigateLeft=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorLeft();else{var t=this.getSelectionRange().start;this.moveCursorToPosition(t)}this.clearSelection()},this.navigateRight=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorRight();else{var t=this.getSelectionRange().end;this.moveCursorToPosition(t)}this.clearSelection()},this.navigateLineStart=function(){this.selection.moveCursorLineStart(),this.clearSelection()},this.navigateLineEnd=function(){this.selection.moveCursorLineEnd(),this.clearSelection()},this.navigateFileEnd=function(){this.selection.moveCursorFileEnd(),this.clearSelection()},this.navigateFileStart=function(){this.selection.moveCursorFileStart(),this.clearSelection()},this.navigateWordRight=function(){this.selection.moveCursorWordRight(),this.clearSelection()},this.navigateWordLeft=function(){this.selection.moveCursorWordLeft(),this.clearSelection()},this.replace=function(e,t){t&&this.$search.set(t);var i=this.$search.find(this.session),n=0;return i&&(this.$tryReplace(i,e)&&(n=1),null!==i&&(this.selection.setSelectionRange(i),this.renderer.scrollSelectionIntoView(i.start,i.end))),n},this.replaceAll=function(e,t){t&&this.$search.set(t);var i=this.$search.findAll(this.session),n=0;if(!i.length)return n;this.$blockScrolling+=1;var o=this.getSelectionRange();this.selection.moveTo(0,0);for(var r=i.length-1;0<=r;--r)this.$tryReplace(i[r],e)&&n++;return this.selection.setSelectionRange(o),this.$blockScrolling-=1,n},this.$tryReplace=function(e,t){var i=this.session.getTextRange(e);return null!==(t=this.$search.replace(i,t))?(e.end=this.session.replace(e,t),e):null},this.getLastSearchOptions=function(){return this.$search.getOptions()},this.find=function(e,t,i){t=t||{},"string"==typeof e||e instanceof RegExp?t.needle=e:"object"==typeof e&&r.mixin(t,e);var n=this.selection.getRange();null==t.needle&&((e=this.session.getTextRange(n)||this.$search.$options.needle)||(n=this.session.getWordRange(n.start.row,n.start.column),e=this.session.getTextRange(n)),this.$search.set({needle:e})),this.$search.set(t),t.start||this.$search.set({start:n});var o=this.$search.find(this.session);return t.preventScroll?o:o?(this.revealRange(o,i),o):(t.backwards?n.start=n.end:n.end=n.start,void this.selection.setRange(n))},this.findNext=function(e,t){this.find({skipCurrent:!0,backwards:!1},e,t)},this.findPrevious=function(e,t){this.find(e,{skipCurrent:!0,backwards:!0},t)},this.revealRange=function(e,t){this.$blockScrolling+=1,this.session.unfold(e),this.selection.setSelectionRange(e),this.$blockScrolling-=1;var i=this.renderer.scrollTop;this.renderer.scrollSelectionIntoView(e.start,e.end,.5),!1!==t&&this.renderer.animateScrolling(i)},this.undo=function(){this.$blockScrolling++,this.session.getUndoManager().undo(),this.$blockScrolling--,this.renderer.scrollCursorIntoView(null,.5)},this.redo=function(){this.$blockScrolling++,this.session.getUndoManager().redo(),this.$blockScrolling--,this.renderer.scrollCursorIntoView(null,.5)},this.destroy=function(){this.renderer.destroy(),this._signal("destroy",this),this.session&&this.session.destroy()},this.setAutoScrollEditorIntoView=function(e){if(e){var o,r=this,a=!1;this.$scrollAnchor||(this.$scrollAnchor=document.createElement("div"));var s=this.$scrollAnchor;s.style.cssText="position:absolute",this.container.insertBefore(s,this.container.firstChild);var t=this.on("changeSelection",function(){a=!0}),i=this.renderer.on("beforeRender",function(){a&&(o=r.renderer.container.getBoundingClientRect())}),n=this.renderer.on("afterRender",function(){if(a&&o&&(r.isFocused()||r.searchBox&&r.searchBox.isFocused())){var e=r.renderer,t=e.$cursorLayer.$pixelPos,i=e.layerConfig,n=t.top-i.offset;null!=(a=0<=t.top&&n+o.top<0||!(t.top<i.height&&t.top+o.top+i.lineHeight>window.innerHeight)&&null)&&(s.style.top=n+"px",s.style.left=t.left+"px",s.style.height=i.lineHeight+"px",s.scrollIntoView(a)),a=o=null}});this.setAutoScrollEditorIntoView=function(e){e||(delete this.setAutoScrollEditorIntoView,this.removeEventListener("changeSelection",t),this.renderer.removeEventListener("afterRender",n),this.renderer.removeEventListener("beforeRender",i))}}},this.$resetCursorStyle=function(){var e=this.$cursorStyle||"ace",t=this.renderer.$cursorLayer;t&&(t.setSmoothBlinking(/smooth/.test(e)),t.isBlinking=!this.$readOnly&&"wide"!=e,o.setCssClass(t.element,"ace_slim-cursors",/slim/.test(e)))}}).call(n.prototype),y.defineOptions(n.prototype,"editor",{selectionStyle:{set:function(e){this.onSelectionChange(),this._signal("changeSelectionStyle",{data:e})},initialValue:"line"},highlightActiveLine:{set:function(){this.$updateHighlightActiveLine()},initialValue:!0},highlightSelectedWord:{set:function(e){this.$onSelectionChange()},initialValue:!0},readOnly:{set:function(e){this.$resetCursorStyle()},initialValue:!1},cursorStyle:{set:function(e){this.$resetCursorStyle()},values:["ace","slim","smooth","wide"],initialValue:"ace"},mergeUndoDeltas:{values:[!1,!0,"always"],initialValue:!0},behavioursEnabled:{initialValue:!0},wrapBehavioursEnabled:{initialValue:!0},autoScrollEditorIntoView:{set:function(e){this.setAutoScrollEditorIntoView(e)}},hScrollBarAlwaysVisible:"renderer",vScrollBarAlwaysVisible:"renderer",highlightGutterLine:"renderer",animatedScroll:"renderer",showInvisibles:"renderer",showPrintMargin:"renderer",printMarginColumn:"renderer",printMargin:"renderer",fadeFoldWidgets:"renderer",showFoldWidgets:"renderer",showLineNumbers:"renderer",showGutter:"renderer",displayIndentGuides:"renderer",fontSize:"renderer",fontFamily:"renderer",maxLines:"renderer",minLines:"renderer",scrollPastEnd:"renderer",fixedWidthGutter:"renderer",theme:"renderer",scrollSpeed:"$mouseHandler",dragDelay:"$mouseHandler",dragEnabled:"$mouseHandler",focusTimout:"$mouseHandler",tooltipFollowsMouse:"$mouseHandler",firstLineNumber:"session",overwrite:"session",newLineMode:"session",useWorker:"session",useSoftTabs:"session",tabSize:"session",wrap:"session",foldStyle:"session",mode:"session"}),t.Editor=n}),ace.define("ace/undomanager",["require","exports","module"],function(e,t,i){"use strict";function n(){this.reset()}(function(){this.execute=function(e){var t=e.args[0];this.$doc=e.args[1],e.merge&&this.hasUndo()&&(this.dirtyCounter--,t=this.$undoStack.pop().concat(t)),this.$undoStack.push(t),this.$redoStack=[],this.dirtyCounter<0&&(this.dirtyCounter=NaN),this.dirtyCounter++},this.undo=function(e){var t=this.$undoStack.pop(),i=null;return t&&(i=this.$doc.undoChanges(t,e),this.$redoStack.push(t),this.dirtyCounter--),i},this.redo=function(e){var t=this.$redoStack.pop(),i=null;return t&&(i=this.$doc.redoChanges(t,e),this.$undoStack.push(t),this.dirtyCounter++),i},this.reset=function(){this.$undoStack=[],this.$redoStack=[],this.dirtyCounter=0},this.hasUndo=function(){return 0<this.$undoStack.length},this.hasRedo=function(){return 0<this.$redoStack.length},this.markClean=function(){this.dirtyCounter=0},this.isClean=function(){return 0===this.dirtyCounter}}).call(n.prototype),t.UndoManager=n}),ace.define("ace/layer/gutter",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter"],function(e,t,i){"use strict";function n(e){this.element=C.createElement("div"),this.element.className="ace_layer ace_gutter-layer",e.appendChild(this.element),this.setShowFoldWidgets(this.$showFoldWidgets),this.gutterWidth=0,this.$annotations=[],this.$updateAnnotations=this.$updateAnnotations.bind(this),this.$cells=[]}var C=e("../lib/dom"),o=e("../lib/oop"),s=e("../lib/lang"),r=e("../lib/event_emitter").EventEmitter;(function(){o.implement(this,r),this.setSession=function(e){this.session&&this.session.removeEventListener("change",this.$updateAnnotations),(this.session=e)&&e.on("change",this.$updateAnnotations)},this.addGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.addGutterDecoration"),this.session.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.removeGutterDecoration"),this.session.removeGutterDecoration(e,t)},this.setAnnotations=function(e){this.$annotations=[];for(var t=0;t<e.length;t++){var i=e[t],n=i.row,o=this.$annotations[n];o=o||(this.$annotations[n]={text:[]});var r=i.text;r=r?s.escapeHTML(r):i.html||"",-1===o.text.indexOf(r)&&o.text.push(r);var a=i.type;"error"==a?o.className=" ace_error":"warning"==a&&" ace_error"!=o.className?o.className=" ace_warning":"info"!=a||o.className||(o.className=" ace_info")}},this.$updateAnnotations=function(e){if(this.$annotations.length){var t=e.data,i=t.range,n=i.start.row,o=i.end.row-n;if(0==o);else if("removeText"==t.action||"removeLines"==t.action)this.$annotations.splice(n,1+o,null);else{var r=new Array(1+o);r.unshift(n,1),this.$annotations.splice.apply(this.$annotations,r)}}},this.update=function(e){for(var t=this.session,i=e.firstRow,n=Math.min(e.lastRow+e.gutterOffset,t.getLength()-1),o=t.getNextFoldLine(i),r=o?o.start.row:1/0,a=this.$showFoldWidgets&&t.foldWidgets,s=t.$breakpoints,l=t.$decorations,c=t.$firstLineNumber,u=0,d=t.gutterRenderer||this.$renderer,h=null,p=-1,f=i;;){if(r<f&&(f=o.end.row+1,r=(o=t.getNextFoldLine(f,o))?o.start.row:1/0),n<f){for(;this.$cells.length>p+1;)h=this.$cells.pop(),this.element.removeChild(h.element);break}(h=this.$cells[++p])||((h={element:null,textNode:null,foldWidget:null}).element=C.createElement("div"),h.textNode=document.createTextNode(""),h.element.appendChild(h.textNode),this.element.appendChild(h.element),this.$cells[p]=h);var g="ace_gutter-cell ";if(s[f]&&(g+=s[f]),l[f]&&(g+=l[f]),this.$annotations[f]&&(g+=this.$annotations[f].className),h.element.className!=g&&(h.element.className=g),(v=t.getRowLength(f)*e.lineHeight+"px")!=h.element.style.height&&(h.element.style.height=v),a){var m=a[f];null==m&&(m=a[f]=t.getFoldWidget(f))}if(m){h.foldWidget||(h.foldWidget=C.createElement("span"),h.element.appendChild(h.foldWidget));g="ace_fold-widget ace_"+m;"start"==m&&f==r&&f<o.end.row?g+=" ace_closed":g+=" ace_open",h.foldWidget.className!=g&&(h.foldWidget.className=g);var v=e.lineHeight+"px";h.foldWidget.style.height!=v&&(h.foldWidget.style.height=v)}else h.foldWidget&&(h.element.removeChild(h.foldWidget),h.foldWidget=null);var y=u=d?d.getText(t,f):f+c;y!=h.textNode.data&&(h.textNode.data=y),f++}this.element.style.height=e.minHeight+"px",(this.$fixedWidth||t.$useWrapMode)&&(u=t.getLength()+c);var b=d?d.getWidth(t,u,e):u.toString().length*e.characterWidth,w=this.$padding||this.$computePadding();(b+=w.left+w.right)===this.gutterWidth||isNaN(b)||(this.gutterWidth=b,this.element.style.width=Math.ceil(this.gutterWidth)+"px",this._emit("changeGutterWidth",b))},this.$fixedWidth=!1,this.$showLineNumbers=!0,this.$renderer="",this.setShowLineNumbers=function(e){this.$renderer=!e&&{getWidth:function(){return""},getText:function(){return""}}},this.getShowLineNumbers=function(){return this.$showLineNumbers},this.$showFoldWidgets=!0,this.setShowFoldWidgets=function(e){e?C.addCssClass(this.element,"ace_folding-enabled"):C.removeCssClass(this.element,"ace_folding-enabled"),this.$showFoldWidgets=e,this.$padding=null},this.getShowFoldWidgets=function(){return this.$showFoldWidgets},this.$computePadding=function(){if(!this.element.firstChild)return{left:0,right:0};var e=C.computedStyle(this.element.firstChild);return this.$padding={},this.$padding.left=parseInt(e.paddingLeft)+1||0,this.$padding.right=parseInt(e.paddingRight)||0,this.$padding},this.getRegion=function(e){var t=this.$padding||this.$computePadding(),i=this.element.getBoundingClientRect();return e.x<t.left+i.left?"markers":this.$showFoldWidgets&&e.x>i.right-t.right?"foldWidgets":void 0}}).call(n.prototype),t.Gutter=n}),ace.define("ace/layer/marker",["require","exports","module","ace/range","ace/lib/dom"],function(e,t,i){"use strict";function n(e){this.element=o.createElement("div"),this.element.className="ace_layer ace_marker-layer",e.appendChild(this.element)}var s=e("../range").Range,o=e("../lib/dom");(function(){this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setMarkers=function(e){this.markers=e},this.update=function(e){if(e=e||this.config){this.config=e;var t=[];for(var i in this.markers){var n=this.markers[i];if(n.range){var o=n.range.clipRows(e.firstRow,e.lastRow);if(!o.isEmpty())if(o=o.toScreenRange(this.session),n.renderer){var r=this.$getTop(o.start.row,e),a=this.$padding+o.start.column*e.characterWidth;n.renderer(t,o,a,r,e)}else"fullLine"==n.type?this.drawFullLineMarker(t,o,n.clazz,e):"screenLine"==n.type?this.drawScreenLineMarker(t,o,n.clazz,e):o.isMultiLine()?"text"==n.type?this.drawTextMarker(t,o,n.clazz,e):this.drawMultiLineMarker(t,o,n.clazz,e):this.drawSingleLineMarker(t,o,n.clazz+" ace_start",e)}else n.update(t,this,this.session,e)}this.element.innerHTML=t.join("")}},this.$getTop=function(e,t){return(e-t.firstRowScreen)*t.lineHeight},this.drawTextMarker=function(e,t,i,n,o){var r=t.start.row,a=new s(r,t.start.column,r,this.session.getScreenLastRowColumn(r));for(this.drawSingleLineMarker(e,a,i+" ace_start",n,1,o),r=t.end.row,a=new s(r,0,r,t.end.column),this.drawSingleLineMarker(e,a,i,n,0,o),r=t.start.row+1;r<t.end.row;r++)a.start.row=r,a.end.row=r,a.end.column=this.session.getScreenLastRowColumn(r),this.drawSingleLineMarker(e,a,i,n,1,o)},this.drawMultiLineMarker=function(e,t,i,n,o){var r=this.$padding,a=n.lineHeight,s=this.$getTop(t.start.row,n),l=r+t.start.column*n.characterWidth;o=o||"",e.push("<div class='",i," ace_start' style='","height:",a,"px;","right:0;","top:",s,"px;","left:",l,"px;",o,"'></div>"),s=this.$getTop(t.end.row,n);var c=t.end.column*n.characterWidth;e.push("<div class='",i,"' style='","height:",a,"px;","width:",c,"px;","top:",s,"px;","left:",r,"px;",o,"'></div>"),(a=(t.end.row-t.start.row-1)*n.lineHeight)<0||(s=this.$getTop(t.start.row+1,n),e.push("<div class='",i,"' style='","height:",a,"px;","right:0;","top:",s,"px;","left:",r,"px;",o,"'></div>"))},this.drawSingleLineMarker=function(e,t,i,n,o,r){var a=n.lineHeight,s=(t.end.column+(o||0)-t.start.column)*n.characterWidth,l=this.$getTop(t.start.row,n),c=this.$padding+t.start.column*n.characterWidth;e.push("<div class='",i,"' style='","height:",a,"px;","width:",s,"px;","top:",l,"px;","left:",c,"px;",r||"","'></div>")},this.drawFullLineMarker=function(e,t,i,n,o){var r=this.$getTop(t.start.row,n),a=n.lineHeight;t.start.row!=t.end.row&&(a+=this.$getTop(t.end.row,n)-r),e.push("<div class='",i,"' style='","height:",a,"px;","top:",r,"px;","left:0;right:0;",o||"","'></div>")},this.drawScreenLineMarker=function(e,t,i,n,o){var r=this.$getTop(t.start.row,n),a=n.lineHeight;e.push("<div class='",i,"' style='","height:",a,"px;","top:",r,"px;","left:0;right:0;",o||"","'></div>")}}).call(n.prototype),t.Marker=n}),ace.define("ace/layer/text",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/lib/event_emitter"],function(e,t,i){"use strict";function n(e){this.element=c.createElement("div"),this.element.className="ace_layer ace_text-layer",e.appendChild(this.element),this.$updateEolChar=this.$updateEolChar.bind(this)}var o=e("../lib/oop"),c=e("../lib/dom"),u=e("../lib/lang"),r=(e("../lib/useragent"),e("../lib/event_emitter").EventEmitter);(function(){o.implement(this,r),this.EOF_CHAR="¬∂",this.EOL_CHAR_LF="¬¨",this.EOL_CHAR_CRLF="¬§",this.EOL_CHAR=this.EOL_CHAR_LF,this.TAB_CHAR="‚Üí",this.SPACE_CHAR="¬∑",this.$padding=0,this.$updateEolChar=function(){var e="\n"==this.session.doc.getNewLineCharacter()?this.EOL_CHAR_LF:this.EOL_CHAR_CRLF;if(this.EOL_CHAR!=e)return this.EOL_CHAR=e,!0},this.setPadding=function(e){this.$padding=e,this.element.style.padding="0 "+e+"px"},this.getLineHeight=function(){return this.$fontMetrics.$characterSize.height||0},this.getCharacterWidth=function(){return this.$fontMetrics.$characterSize.width||0},this.$setFontMetrics=function(e){this.$fontMetrics=e,this.$fontMetrics.on("changeCharacterSize",function(e){this._signal("changeCharacterSize",e)}.bind(this)),this.$pollSizeChanges()},this.checkForSizeChanges=function(){this.$fontMetrics.checkForSizeChanges()},this.$pollSizeChanges=function(){return this.$pollSizeChangesTimer=this.$fontMetrics.$pollSizeChanges()},this.setSession=function(e){(this.session=e)&&this.$computeTabString()},this.showInvisibles=!1,this.setShowInvisibles=function(e){return this.showInvisibles!=e&&(this.showInvisibles=e,this.$computeTabString(),!0)},this.displayIndentGuides=!0,this.setDisplayIndentGuides=function(e){return this.displayIndentGuides!=e&&(this.displayIndentGuides=e,this.$computeTabString(),!0)},this.$tabStrings=[],this.onChangeTabSize=this.$computeTabString=function(){var e=this.session.getTabSize();this.tabSize=e;for(var t=this.$tabStrings=[0],i=1;i<e+1;i++)this.showInvisibles?t.push("<span class='ace_invisible ace_invisible_tab'>"+this.TAB_CHAR+u.stringRepeat("¬†",i-1)+"</span>"):t.push(u.stringRepeat("¬†",i));if(this.displayIndentGuides){this.$indentGuideRe=/\s\S| \t|\t |\s$/;var n="ace_indent-guide",o="",r="";if(this.showInvisibles){n+=" ace_invisible",o=" ace_invisible_space",r=" ace_invisible_tab";var a=u.stringRepeat(this.SPACE_CHAR,this.tabSize),s=this.TAB_CHAR+u.stringRepeat("¬†",this.tabSize-1)}else s=a=u.stringRepeat("¬†",this.tabSize);this.$tabStrings[" "]="<span class='"+n+o+"'>"+a+"</span>",this.$tabStrings["\t"]="<span class='"+n+r+"'>"+s+"</span>"}},this.updateLines=function(e,t,i){this.config.lastRow==e.lastRow&&this.config.firstRow==e.firstRow||this.scrollLines(e),this.config=e;for(var n=Math.max(t,e.firstRow),o=Math.min(i,e.lastRow),r=this.element.childNodes,a=0,s=e.firstRow;s<n;s++){if(l=this.session.getFoldLine(s)){if(l.containsRow(n)){n=l.start.row;break}s=l.end.row}a++}s=n;for(var l,c=(l=this.session.getNextFoldLine(s))?l.start.row:1/0;c<s&&(s=l.end.row+1,c=(l=this.session.getNextFoldLine(s,l))?l.start.row:1/0),!(o<s);){var u=r[a++];if(u){var d=[];this.$renderLine(d,s,!this.$useLineGroups(),s==c&&l),u.style.height=e.lineHeight*this.session.getRowLength(s)+"px",u.innerHTML=d.join("")}s++}},this.scrollLines=function(e){var t=this.config;if(this.config=e,!t||t.lastRow<e.firstRow)return this.update(e);if(e.lastRow<t.firstRow)return this.update(e);var i=this.element;if(t.firstRow<e.firstRow)for(var n=this.session.getFoldedRowCount(t.firstRow,e.firstRow-1);0<n;n--)i.removeChild(i.firstChild);if(t.lastRow>e.lastRow)for(n=this.session.getFoldedRowCount(e.lastRow+1,t.lastRow);0<n;n--)i.removeChild(i.lastChild);if(e.firstRow<t.firstRow){var o=this.$renderLinesFragment(e,e.firstRow,t.firstRow-1);i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o)}if(e.lastRow>t.lastRow){o=this.$renderLinesFragment(e,t.lastRow+1,e.lastRow);i.appendChild(o)}},this.$renderLinesFragment=function(e,t,i){for(var n=this.element.ownerDocument.createDocumentFragment(),o=t,r=this.session.getNextFoldLine(o),a=r?r.start.row:1/0;a<o&&(o=r.end.row+1,a=(r=this.session.getNextFoldLine(o,r))?r.start.row:1/0),!(i<o);){var s=c.createElement("div"),l=[];if(this.$renderLine(l,o,!1,o==a&&r),s.innerHTML=l.join(""),this.$useLineGroups())s.className="ace_line_group",n.appendChild(s),s.style.height=e.lineHeight*this.session.getRowLength(o)+"px";else for(;s.firstChild;)n.appendChild(s.firstChild);o++}return n},this.update=function(e){for(var t=[],i=(this.config=e).firstRow,n=e.lastRow,o=i,r=this.session.getNextFoldLine(o),a=r?r.start.row:1/0;a<o&&(o=r.end.row+1,a=(r=this.session.getNextFoldLine(o,r))?r.start.row:1/0),!(n<o);)this.$useLineGroups()&&t.push("<div class='ace_line_group' style='height:",e.lineHeight*this.session.getRowLength(o),"px'>"),this.$renderLine(t,o,!1,o==a&&r),this.$useLineGroups()&&t.push("</div>"),o++;this.element.innerHTML=t.join("")},this.$textToken={text:!0,rparen:!0,lparen:!0},this.$renderToken=function(e,l,t,i){var c=this,n=i.replace(/\t|&|<|( +)|([\x00-\x1f\x80-\xa0\xad\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\u3000\uFEFF])|[\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]/g,function(e,t,i,n,o){if(t)return c.showInvisibles?"<span class='ace_invisible ace_invisible_space'>"+u.stringRepeat(c.SPACE_CHAR,e.length)+"</span>":u.stringRepeat("¬†",e.length);if("&"==e)return"&#38;";if("<"==e)return"&#60;";if("\t"==e){var r=c.session.getScreenTabSize(l+n);return l+=r-1,c.$tabStrings[r]}if("„ÄÄ"!=e)return i?"<span class='ace_invisible ace_invisible_space ace_invalid'>"+c.SPACE_CHAR+"</span>":(l+=1,"<span class='ace_cjk' style='width:"+2*c.config.characterWidth+"px'>"+e+"</span>");var a=c.showInvisibles?"ace_cjk ace_invisible ace_invisible_space":"ace_cjk",s=c.showInvisibles?c.SPACE_CHAR:"";return l+=1,"<span class='"+a+"' style='width:"+2*c.config.characterWidth+"px'>"+s+"</span>"});if(this.$textToken[t.type])e.push(n);else{var o="ace_"+t.type.replace(/\./g," ace_"),r="";"fold"==t.type&&(r=" style='width:"+t.value.length*this.config.characterWidth+"px;' "),e.push("<span class='",o,"'",r,">",n,"</span>")}return l+i.length},this.renderIndentGuide=function(e,t,i){var n=t.search(this.$indentGuideRe);return n<=0||i<=n?t:" "==t[0]?(n-=n%this.tabSize,e.push(u.stringRepeat(this.$tabStrings[" "],n/this.tabSize)),t.substr(n)):"\t"==t[0]?(e.push(u.stringRepeat(this.$tabStrings["\t"],n)),t.substr(n)):t},this.$renderWrappedLine=function(e,t,i,n){for(var o=0,r=0,a=i[0],s=0,l=0;l<t.length;l++){var c=t[l],u=c.value;if(0==l&&this.displayIndentGuides){if(o=u.length,!(u=this.renderIndentGuide(e,u,a)))continue;o-=u.length}if(o+u.length<a)s=this.$renderToken(e,s,c,u),o+=u.length;else{for(;o+u.length>=a;)s=this.$renderToken(e,s,c,u.substring(0,a-o)),u=u.substring(a-o),o=a,n||e.push("</div>","<div class='ace_line' style='height:",this.config.lineHeight,"px'>"),s=0,a=i[++r]||Number.MAX_VALUE;0!=u.length&&(o+=u.length,s=this.$renderToken(e,s,c,u))}}},this.$renderSimpleLine=function(e,t){var i=0,n=t[0],o=n.value;this.displayIndentGuides&&(o=this.renderIndentGuide(e,o)),o&&(i=this.$renderToken(e,i,n,o));for(var r=1;r<t.length;r++)o=(n=t[r]).value,i=this.$renderToken(e,i,n,o)},this.$renderLine=function(e,t,i,n){if(n||0==n||(n=this.session.getFoldLine(t)),n)var o=this.$getFoldLineTokens(t,n);else o=this.session.getTokens(t);if(i||e.push("<div class='ace_line' style='height:",this.config.lineHeight*(this.$useLineGroups()?1:this.session.getRowLength(t)),"px'>"),o.length){var r=this.session.getRowSplitData(t);r&&r.length?this.$renderWrappedLine(e,o,r,i):this.$renderSimpleLine(e,o)}this.showInvisibles&&(n&&(t=n.end.row),e.push("<span class='ace_invisible ace_invisible_eol'>",t==this.session.getLength()-1?this.EOF_CHAR:this.EOL_CHAR,"</span>")),i||e.push("</div>")},this.$getFoldLineTokens=function(e,t){var r=this.session,a=[];var s=r.getTokens(e);return t.walk(function(e,t,i,n,o){null!=e?a.push({type:"fold",value:e}):(o&&(s=r.getTokens(t)),s.length&&function(e,t,i){for(var n=0,o=0;o+e[n].value.length<t;)if(o+=e[n].value.length,++n==e.length)return;for(o!=t&&((r=e[n].value.substring(t-o)).length>i-t&&(r=r.substring(0,i-t)),a.push({type:e[n].type,value:r}),o=t+r.length,n+=1);o<i&&n<e.length;){var r;(r=e[n].value).length+o>i?a.push({type:e[n].type,value:r.substring(0,i-o)}):a.push(e[n]),o+=r.length,n+=1}}(s,n,i))},t.end.row,this.session.getLine(t.end.row).length),a},this.$useLineGroups=function(){return this.session.getUseWrapMode()},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.$measureNode&&this.$measureNode.parentNode.removeChild(this.$measureNode),delete this.$measureNode}}).call(n.prototype),t.Text=n}),ace.define("ace/layer/cursor",["require","exports","module","ace/lib/dom"],function(e,t,i){"use strict";function n(e){this.element=r.createElement("div"),this.element.className="ace_layer ace_cursor-layer",e.appendChild(this.element),void 0===o&&(o="opacity"in this.element),this.isVisible=!1,this.isBlinking=!0,this.blinkInterval=1e3,this.smoothBlinking=!1,this.cursors=[],this.cursor=this.addCursor(),r.addCssClass(this.element,"ace_hidden-cursors"),this.$updateCursors=this.$updateVisibility.bind(this)}var o,r=e("../lib/dom");(function(){this.$updateVisibility=function(e){for(var t=this.cursors,i=t.length;i--;)t[i].style.visibility=e?"":"hidden"},this.$updateOpacity=function(e){for(var t=this.cursors,i=t.length;i--;)t[i].style.opacity=e?"":"0"},this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setBlinking=function(e){e!=this.isBlinking&&(this.isBlinking=e,this.restartTimer())},this.setBlinkInterval=function(e){e!=this.blinkInterval&&(this.blinkInterval=e,this.restartTimer())},this.setSmoothBlinking=function(e){e==this.smoothBlinking||o||(this.smoothBlinking=e,r.setCssClass(this.element,"ace_smooth-blinking",e),this.$updateCursors(!0),this.$updateCursors=(e?this.$updateOpacity:this.$updateVisibility).bind(this),this.restartTimer())},this.addCursor=function(){var e=r.createElement("div");return e.className="ace_cursor",this.element.appendChild(e),this.cursors.push(e),e},this.removeCursor=function(){if(1<this.cursors.length){var e=this.cursors.pop();return e.parentNode.removeChild(e),e}},this.hideCursor=function(){this.isVisible=!1,r.addCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.showCursor=function(){this.isVisible=!0,r.removeCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.restartTimer=function(){var e=this.$updateCursors;if(clearInterval(this.intervalId),clearTimeout(this.timeoutId),this.smoothBlinking&&r.removeCssClass(this.element,"ace_smooth-blinking"),e(!0),this.isBlinking&&this.blinkInterval&&this.isVisible){this.smoothBlinking&&setTimeout(function(){r.addCssClass(this.element,"ace_smooth-blinking")}.bind(this));var t=function(){this.timeoutId=setTimeout(function(){e(!1)},.6*this.blinkInterval)}.bind(this);this.intervalId=setInterval(function(){e(!0),t()},this.blinkInterval),t()}},this.getPixelPosition=function(e,t){if(!this.config||!this.session)return{left:0,top:0};e=e||this.session.selection.getCursor();var i=this.session.documentToScreenPosition(e);return{left:this.$padding+i.column*this.config.characterWidth,top:(i.row-(t?this.config.firstRowScreen:0))*this.config.lineHeight}},this.update=function(e){this.config=e;var t=this.session.$selectionMarkers,i=0,n=0;void 0!==t&&0!==t.length||(t=[{cursor:null}]);i=0;for(var o=t.length;i<o;i++){var r=this.getPixelPosition(t[i].cursor,!0);if(!((r.top>e.height+e.offset||r.top<0)&&1<i)){var a=(this.cursors[n++]||this.addCursor()).style;this.drawCursor?this.drawCursor(a,r,e,t[i],this.session):(a.left=r.left+"px",a.top=r.top+"px",a.width=e.characterWidth+"px",a.height=e.lineHeight+"px")}}for(;this.cursors.length>n;)this.removeCursor();var s=this.session.getOverwrite();this.$setOverwrite(s),this.$pixelPos=r,this.restartTimer()},this.drawCursor=null,this.$setOverwrite=function(e){e!=this.overwrite&&((this.overwrite=e)?r.addCssClass(this.element,"ace_overwrite-cursors"):r.removeCssClass(this.element,"ace_overwrite-cursors"))},this.destroy=function(){clearInterval(this.intervalId),clearTimeout(this.timeoutId)}}).call(n.prototype),t.Cursor=n}),ace.define("ace/scrollbar",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/event","ace/lib/event_emitter"],function(e,t,i){"use strict";function n(e){this.element=r.createElement("div"),this.element.className="ace_scrollbar ace_scrollbar"+this.classSuffix,this.inner=r.createElement("div"),this.inner.className="ace_scrollbar-inner",this.element.appendChild(this.inner),e.appendChild(this.element),this.setVisible(!1),this.skipEvent=!1,a.addListener(this.element,"scroll",this.onScroll.bind(this)),a.addListener(this.element,"mousedown",a.preventDefault)}var o=e("./lib/oop"),r=e("./lib/dom"),a=e("./lib/event"),s=e("./lib/event_emitter").EventEmitter;(function(){o.implement(this,s),this.setVisible=function(e){this.element.style.display=e?"":"none",this.isVisible=e}}).call(n.prototype);function l(e,t){n.call(this,e),this.scrollTop=0,t.$scrollbarWidth=this.width=r.scrollbarWidth(e.ownerDocument),this.inner.style.width=this.element.style.width=(this.width||15)+5+"px"}o.inherits(l,n),function(){this.classSuffix="-v",this.onScroll=function(){this.skipEvent||(this.scrollTop=this.element.scrollTop,this._emit("scroll",{data:this.scrollTop})),this.skipEvent=!1},this.getWidth=function(){return this.isVisible?this.width:0},this.setHeight=function(e){this.element.style.height=e+"px"},this.setInnerHeight=function(e){this.inner.style.height=e+"px"},this.setScrollHeight=function(e){this.inner.style.height=e+"px"},this.setScrollTop=function(e){this.scrollTop!=e&&(this.skipEvent=!0,this.scrollTop=this.element.scrollTop=e)}}.call(l.prototype);function c(e,t){n.call(this,e),this.scrollLeft=0,this.height=t.$scrollbarWidth,this.inner.style.height=this.element.style.height=(this.height||15)+5+"px"}o.inherits(c,n),function(){this.classSuffix="-h",this.onScroll=function(){this.skipEvent||(this.scrollLeft=this.element.scrollLeft,this._emit("scroll",{data:this.scrollLeft})),this.skipEvent=!1},this.getHeight=function(){return this.isVisible?this.height:0},this.setWidth=function(e){this.element.style.width=e+"px"},this.setInnerWidth=function(e){this.inner.style.width=e+"px"},this.setScrollWidth=function(e){this.inner.style.width=e+"px"},this.setScrollLeft=function(e){this.scrollLeft!=e&&(this.skipEvent=!0,this.scrollLeft=this.element.scrollLeft=e)}}.call(c.prototype),t.ScrollBar=l,t.ScrollBarV=l,t.ScrollBarH=c,t.VScrollBar=l,t.HScrollBar=c}),ace.define("ace/renderloop",["require","exports","module","ace/lib/event"],function(e,t,i){"use strict";function n(e,t){this.onRender=e,this.pending=!1,this.changes=0,this.window=t||window}var o=e("./lib/event");(function(){this.schedule=function(e){if(this.changes=this.changes|e,!this.pending&&this.changes){this.pending=!0;var t=this;o.nextFrame(function(){var e;for(t.pending=!1;e=t.changes;)t.changes=0,t.onRender(e)},this.window)}}}).call(n.prototype),t.RenderLoop=n}),ace.define("ace/layer/font_metrics",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/lib/event_emitter"],function(e,t,i){var n=e("../lib/oop"),o=e("../lib/dom"),r=e("../lib/lang"),a=e("../lib/useragent"),s=e("../lib/event_emitter").EventEmitter,l=0,c=t.FontMetrics=function(e,t){this.el=o.createElement("div"),this.$setMeasureNodeStyles(this.el.style,!0),this.$main=o.createElement("div"),this.$setMeasureNodeStyles(this.$main.style),this.$measureNode=o.createElement("div"),this.$setMeasureNodeStyles(this.$measureNode.style),this.el.appendChild(this.$main),this.el.appendChild(this.$measureNode),e.appendChild(this.el),l||this.$testFractionalRect(),this.$measureNode.innerHTML=r.stringRepeat("X",l),this.$characterSize={width:0,height:0},this.checkForSizeChanges()};(function(){n.implement(this,s),this.$characterSize={width:0,height:0},this.$testFractionalRect=function(){var e=o.createElement("div");this.$setMeasureNodeStyles(e.style),e.style.width="0.2px",document.documentElement.appendChild(e);var t=e.getBoundingClientRect().width;l=0<t&&t<1?50:100,e.parentNode.removeChild(e)},this.$setMeasureNodeStyles=function(e,t){e.width=e.height="auto",e.left=e.top="0px",e.visibility="hidden",e.position="absolute",e.whiteSpace="pre",a.isIE<8?e["font-family"]="inherit":e.font="inherit",e.overflow=t?"hidden":"visible"},this.checkForSizeChanges=function(){var e=this.$measureSizes();if(e&&(this.$characterSize.width!==e.width||this.$characterSize.height!==e.height)){this.$measureNode.style.fontWeight="bold";var t=this.$measureSizes();this.$measureNode.style.fontWeight="",this.$characterSize=e,this.charSizes=Object.create(null),this.allowBoldFonts=t&&t.width===e.width&&t.height===e.height,this._emit("changeCharacterSize",{data:e})}},this.$pollSizeChanges=function(){if(this.$pollSizeChangesTimer)return this.$pollSizeChangesTimer;var e=this;return this.$pollSizeChangesTimer=setInterval(function(){e.checkForSizeChanges()},500)},this.setPolling=function(e){e?this.$pollSizeChanges():this.$pollSizeChangesTimer&&this.$pollSizeChangesTimer},this.$measureSizes=function(){if(50===l){var t=null;try{t=this.$measureNode.getBoundingClientRect()}catch(e){t={width:0,height:0}}var e={height:t.height,width:t.width/l}}else e={height:this.$measureNode.clientHeight,width:this.$measureNode.clientWidth/l};return 0===e.width||0===e.height?null:e},this.$measureCharWidth=function(e){return this.$main.innerHTML=r.stringRepeat(e,l),this.$main.getBoundingClientRect().width/l},this.getCharacterWidth=function(e){var t=this.charSizes[e];return void 0===t&&(this.charSizes[e]=this.$measureCharWidth(e)/this.$characterSize.width),t},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)}}).call(c.prototype)}),ace.define("ace/virtual_renderer",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/config","ace/lib/useragent","ace/layer/gutter","ace/layer/marker","ace/layer/text","ace/layer/cursor","ace/scrollbar","ace/scrollbar","ace/renderloop","ace/layer/font_metrics","ace/lib/event_emitter"],function(e,t,i){"use strict";var n=e("./lib/oop"),r=e("./lib/dom"),a=e("./config"),o=e("./lib/useragent"),s=e("./layer/gutter").Gutter,l=e("./layer/marker").Marker,c=e("./layer/text").Text,u=e("./layer/cursor").Cursor,d=e("./scrollbar").HScrollBar,h=e("./scrollbar").VScrollBar,p=e("./renderloop").RenderLoop,f=e("./layer/font_metrics").FontMetrics,g=e("./lib/event_emitter").EventEmitter;r.importCssString('.ace_editor {position: relative;overflow: hidden;font: 12px/normal \'Monaco\', \'Menlo\', \'Ubuntu Mono\', \'Consolas\', \'source-code-pro\', monospace;direction: ltr;}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;min-width: 100%;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: \'\';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;text-indent: -1em;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;}.ace_text-input.ace_composition {background: inherit;color: inherit;z-index: 1000;opacity: 1;text-indent: 0;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;white-space: pre;height: 100%;width: 100%;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;}.ace_text-layer {font: inherit !important;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;border-left: 2px solid}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {-webkit-transition: opacity 0.18s;transition: opacity 0.18s;}.ace_editor.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.ace_line .ace_fold {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.1));background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {-webkit-transition: opacity 0.4s ease 0.05s;transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {-webkit-transition: opacity 0.05s ease 0.05s;transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}',"ace_editor");function m(e,t){var i=this;this.container=e||r.createElement("div"),this.$keepTextAreaAtCursor=!o.isOldIE,r.addCssClass(this.container,"ace_editor"),this.setTheme(t),this.$gutter=r.createElement("div"),this.$gutter.className="ace_gutter",this.container.appendChild(this.$gutter),this.scroller=r.createElement("div"),this.scroller.className="ace_scroller",this.container.appendChild(this.scroller),this.content=r.createElement("div"),this.content.className="ace_content",this.scroller.appendChild(this.content),this.$gutterLayer=new s(this.$gutter),this.$gutterLayer.on("changeGutterWidth",this.onGutterResize.bind(this)),this.$markerBack=new l(this.content);var n=this.$textLayer=new c(this.content);this.canvas=n.element,this.$markerFront=new l(this.content),this.$cursorLayer=new u(this.content),this.$horizScroll=!1,this.$vScroll=!1,this.scrollBar=this.scrollBarV=new h(this.container,this),this.scrollBarH=new d(this.container,this),this.scrollBarV.addEventListener("scroll",function(e){i.$scrollAnimation||i.session.setScrollTop(e.data-i.scrollMargin.top)}),this.scrollBarH.addEventListener("scroll",function(e){i.$scrollAnimation||i.session.setScrollLeft(e.data-i.scrollMargin.left)}),this.scrollTop=0,this.scrollLeft=0,this.cursorPos={row:0,column:0},this.$fontMetrics=new f(this.container,500),this.$textLayer.$setFontMetrics(this.$fontMetrics),this.$textLayer.addEventListener("changeCharacterSize",function(e){i.updateCharacterSize(),i.onResize(!0,i.gutterWidth,i.$size.width,i.$size.height),i._signal("changeCharacterSize",e)}),this.$size={width:0,height:0,scrollerHeight:0,scrollerWidth:0,$dirty:!0},this.layerConfig={width:1,padding:0,firstRow:0,firstRowScreen:0,lastRow:0,lineHeight:0,characterWidth:0,minHeight:1,maxHeight:1,offset:0,height:1,gutterOffset:1},this.scrollMargin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.$loop=new p(this.$renderChanges.bind(this),this.container.ownerDocument.defaultView),this.$loop.schedule(this.CHANGE_FULL),this.updateCharacterSize(),this.setPadding(4),a.resetOptions(this),a._emit("renderer",this)}(function(){this.CHANGE_CURSOR=1,this.CHANGE_MARKER=2,this.CHANGE_GUTTER=4,this.CHANGE_SCROLL=8,this.CHANGE_LINES=16,this.CHANGE_TEXT=32,this.CHANGE_SIZE=64,this.CHANGE_MARKER_BACK=128,this.CHANGE_MARKER_FRONT=256,this.CHANGE_FULL=512,this.CHANGE_H_SCROLL=1024,n.implement(this,g),this.updateCharacterSize=function(){this.$textLayer.allowBoldFonts!=this.$allowBoldFonts&&(this.$allowBoldFonts=this.$textLayer.allowBoldFonts,this.setStyle("ace_nobold",!this.$allowBoldFonts)),this.layerConfig.characterWidth=this.characterWidth=this.$textLayer.getCharacterWidth(),this.layerConfig.lineHeight=this.lineHeight=this.$textLayer.getLineHeight(),this.$updatePrintMargin()},this.setSession=function(e){this.session&&this.session.doc.off("changeNewLineMode",this.onChangeNewLineMode),(this.session=e)&&this.scrollMargin.top&&e.getScrollTop()<=0&&e.setScrollTop(-this.scrollMargin.top),this.$cursorLayer.setSession(e),this.$markerBack.setSession(e),this.$markerFront.setSession(e),this.$gutterLayer.setSession(e),this.$textLayer.setSession(e),e&&(this.$loop.schedule(this.CHANGE_FULL),this.session.$setFontMetrics(this.$fontMetrics),this.onChangeNewLineMode=this.onChangeNewLineMode.bind(this),this.onChangeNewLineMode(),this.session.doc.on("changeNewLineMode",this.onChangeNewLineMode))},this.updateLines=function(e,t,i){if(void 0===t&&(t=1/0),this.$changedLines?(this.$changedLines.firstRow>e&&(this.$changedLines.firstRow=e),this.$changedLines.lastRow<t&&(this.$changedLines.lastRow=t)):this.$changedLines={firstRow:e,lastRow:t},this.$changedLines.lastRow<this.layerConfig.firstRow){if(!i)return;this.$changedLines.lastRow=this.layerConfig.lastRow}this.$changedLines.firstRow>this.layerConfig.lastRow||this.$loop.schedule(this.CHANGE_LINES)},this.onChangeNewLineMode=function(){this.$loop.schedule(this.CHANGE_TEXT),this.$textLayer.$updateEolChar()},this.onChangeTabSize=function(){this.$loop.schedule(this.CHANGE_TEXT|this.CHANGE_MARKER),this.$textLayer.onChangeTabSize()},this.updateText=function(){this.$loop.schedule(this.CHANGE_TEXT)},this.updateFull=function(e){e?this.$renderChanges(this.CHANGE_FULL,!0):this.$loop.schedule(this.CHANGE_FULL)},this.updateFontSize=function(){this.$textLayer.checkForSizeChanges()},this.$changes=0,this.$updateSizeAsync=function(){this.$loop.pending?this.$size.$dirty=!0:this.onResize()},this.onResize=function(e,t,i,n){if(!(2<this.resizing)){0<this.resizing?this.resizing++:this.resizing=e?1:0;var o=this.container;n=n||(o.clientHeight||o.scrollHeight),i=i||(o.clientWidth||o.scrollWidth);var r=this.$updateCachedSize(e,t,i,n);if(!this.$size.scrollerHeight||!i&&!n)return this.resizing=0;e&&(this.$gutterLayer.$padding=null),e?this.$renderChanges(r|this.$changes,!0):this.$loop.schedule(r|this.$changes),this.resizing&&(this.resizing=0),this.scrollBarV.scrollLeft=this.scrollBarV.scrollTop=null}},this.$updateCachedSize=function(e,t,i,n){n-=this.$extraHeight||0;var o=0,r=this.$size,a={width:r.width,height:r.height,scrollerHeight:r.scrollerHeight,scrollerWidth:r.scrollerWidth};return n&&(e||r.height!=n)&&(r.height=n,o|=this.CHANGE_SIZE,r.scrollerHeight=r.height,this.$horizScroll&&(r.scrollerHeight-=this.scrollBarH.getHeight()),this.scrollBarV.element.style.bottom=this.scrollBarH.getHeight()+"px",o|=this.CHANGE_SCROLL),i&&(e||r.width!=i)&&(o|=this.CHANGE_SIZE,r.width=i,null==t&&(t=this.$showGutter?this.$gutter.offsetWidth:0),this.gutterWidth=t,this.scrollBarH.element.style.left=this.scroller.style.left=t+"px",r.scrollerWidth=Math.max(0,i-t-this.scrollBarV.getWidth()),this.scrollBarH.element.style.right=this.scroller.style.right=this.scrollBarV.getWidth()+"px",this.scroller.style.bottom=this.scrollBarH.getHeight()+"px",(this.session&&this.session.getUseWrapMode()&&this.adjustWrapLimit()||e)&&(o|=this.CHANGE_FULL)),r.$dirty=!i||!n,o&&this._signal("resize",a),o},this.onGutterResize=function(){var e=this.$showGutter?this.$gutter.offsetWidth:0;e!=this.gutterWidth&&(this.$changes|=this.$updateCachedSize(!0,e,this.$size.width,this.$size.height)),this.session.getUseWrapMode()&&this.adjustWrapLimit()?this.$loop.schedule(this.CHANGE_FULL):this.$size.$dirty?this.$loop.schedule(this.CHANGE_FULL):(this.$computeLayerConfig(),this.$loop.schedule(this.CHANGE_MARKER))},this.adjustWrapLimit=function(){var e=this.$size.scrollerWidth-2*this.$padding,t=Math.floor(e/this.characterWidth);return this.session.adjustWrapLimit(t,this.$showPrintMargin&&this.$printMarginColumn)},this.setAnimatedScroll=function(e){this.setOption("animatedScroll",e)},this.getAnimatedScroll=function(){return this.$animatedScroll},this.setShowInvisibles=function(e){this.setOption("showInvisibles",e)},this.getShowInvisibles=function(){return this.getOption("showInvisibles")},this.getDisplayIndentGuides=function(){return this.getOption("displayIndentGuides")},this.setDisplayIndentGuides=function(e){this.setOption("displayIndentGuides",e)},this.setShowPrintMargin=function(e){this.setOption("showPrintMargin",e)},this.getShowPrintMargin=function(){return this.getOption("showPrintMargin")},this.setPrintMarginColumn=function(e){this.setOption("printMarginColumn",e)},this.getPrintMarginColumn=function(){return this.getOption("printMarginColumn")},this.getShowGutter=function(){return this.getOption("showGutter")},this.setShowGutter=function(e){return this.setOption("showGutter",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.$updateGutterLineHighlight=function(){var e=this.$cursorLayer.$pixelPos,t=this.layerConfig.lineHeight;if(this.session.getUseWrapMode()){var i=this.session.selection.getCursor();i.column=0,e=this.$cursorLayer.getPixelPosition(i,!0),t*=this.session.getRowLength(i.row)}this.$gutterLineHighlight.style.top=e.top-this.layerConfig.offset+"px",this.$gutterLineHighlight.style.height=t+"px"},this.$updatePrintMargin=function(){if(this.$showPrintMargin||this.$printMarginEl){if(!this.$printMarginEl){var e=r.createElement("div");e.className="ace_layer ace_print-margin-layer",this.$printMarginEl=r.createElement("div"),this.$printMarginEl.className="ace_print-margin",e.appendChild(this.$printMarginEl),this.content.insertBefore(e,this.content.firstChild)}var t=this.$printMarginEl.style;t.left=this.characterWidth*this.$printMarginColumn+this.$padding+"px",t.visibility=this.$showPrintMargin?"visible":"hidden",this.session&&-1==this.session.$wrap&&this.adjustWrapLimit()}},this.getContainerElement=function(){return this.container},this.getMouseEventTarget=function(){return this.content},this.getTextAreaContainer=function(){return this.container},this.$moveTextAreaToCursor=function(){if(this.$keepTextAreaAtCursor){var e=this.layerConfig,t=this.$cursorLayer.$pixelPos.top,i=this.$cursorLayer.$pixelPos.left;t-=e.offset;var n=this.textarea.style,o=this.lineHeight;if(t<0||t>e.height-o)n.top=n.left="0";else{var r=this.characterWidth;if(this.$composition){var a=this.textarea.value.replace(/^\x01+/,"");r*=this.session.$getStringScreenWidth(a)[0]+2,o+=2}(i-=this.scrollLeft)>this.$size.scrollerWidth-r&&(i=this.$size.scrollerWidth-r),i+=this.gutterWidth,n.height=o+"px",n.width=r+"px",n.left=Math.min(i,this.$size.scrollerWidth-r)+"px",n.top=Math.min(t,this.$size.height-o)+"px"}}},this.getFirstVisibleRow=function(){return this.layerConfig.firstRow},this.getFirstFullyVisibleRow=function(){return this.layerConfig.firstRow+(0===this.layerConfig.offset?0:1)},this.getLastFullyVisibleRow=function(){var e=Math.floor((this.layerConfig.height+this.layerConfig.offset)/this.layerConfig.lineHeight);return this.layerConfig.firstRow-1+e},this.getLastVisibleRow=function(){return this.layerConfig.lastRow},this.$padding=null,this.setPadding=function(e){this.$padding=e,this.$textLayer.setPadding(e),this.$cursorLayer.setPadding(e),this.$markerFront.setPadding(e),this.$markerBack.setPadding(e),this.$loop.schedule(this.CHANGE_FULL),this.$updatePrintMargin()},this.setScrollMargin=function(e,t,i,n){var o=this.scrollMargin;o.top=0|e,o.bottom=0|t,o.right=0|n,o.left=0|i,o.v=o.top+o.bottom,o.h=o.left+o.right,o.top&&this.scrollTop<=0&&this.session&&this.session.setScrollTop(-o.top),this.updateFull()},this.getHScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible},this.setHScrollBarAlwaysVisible=function(e){this.setOption("hScrollBarAlwaysVisible",e)},this.getVScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible},this.setVScrollBarAlwaysVisible=function(e){this.setOption("vScrollBarAlwaysVisible",e)},this.$updateScrollBarV=function(){var e=this.layerConfig.maxHeight,t=this.$size.scrollerHeight;!this.$maxLines&&this.$scrollPastEnd&&(e-=(t-this.lineHeight)*this.$scrollPastEnd,this.scrollTop>e-t&&(e=this.scrollTop+t,this.scrollBarV.scrollTop=null)),this.scrollBarV.setScrollHeight(e+this.scrollMargin.v),this.scrollBarV.setScrollTop(this.scrollTop+this.scrollMargin.top)},this.$updateScrollBarH=function(){this.scrollBarH.setScrollWidth(this.layerConfig.width+2*this.$padding+this.scrollMargin.h),this.scrollBarH.setScrollLeft(this.scrollLeft+this.scrollMargin.left)},this.$frozen=!1,this.freeze=function(){this.$frozen=!0},this.unfreeze=function(){this.$frozen=!1},this.$renderChanges=function(e,t){if(this.$changes&&(e|=this.$changes,this.$changes=0),this.session&&this.container.offsetWidth&&!this.$frozen&&(e||t)){if(this.$size.$dirty)return this.$changes|=e,this.onResize(!0);this.lineHeight||this.$textLayer.checkForSizeChanges(),this._signal("beforeRender");var i=this.layerConfig;if(e&this.CHANGE_FULL||e&this.CHANGE_SIZE||e&this.CHANGE_TEXT||e&this.CHANGE_LINES||e&this.CHANGE_SCROLL||e&this.CHANGE_H_SCROLL){if(e|=this.$computeLayerConfig(),i.firstRow!=this.layerConfig.firstRow&&i.firstRowScreen==this.layerConfig.firstRowScreen){var n=this.scrollTop+(i.firstRow-this.layerConfig.firstRow)*this.lineHeight;0<n&&(this.scrollTop=n,e|=this.CHANGE_SCROLL,e|=this.$computeLayerConfig())}i=this.layerConfig,this.$updateScrollBarV(),e&this.CHANGE_H_SCROLL&&this.$updateScrollBarH(),this.$gutterLayer.element.style.marginTop=-i.offset+"px",this.content.style.marginTop=-i.offset+"px",this.content.style.width=i.width+2*this.$padding+"px",this.content.style.height=i.minHeight+"px"}if(e&this.CHANGE_H_SCROLL&&(this.content.style.marginLeft=-this.scrollLeft+"px",this.scroller.className=this.scrollLeft<=0?"ace_scroller":"ace_scroller ace_scroll-left"),e&this.CHANGE_FULL)return this.$textLayer.update(i),this.$showGutter&&this.$gutterLayer.update(i),this.$markerBack.update(i),this.$markerFront.update(i),this.$cursorLayer.update(i),this.$moveTextAreaToCursor(),this.$highlightGutterLine&&this.$updateGutterLineHighlight(),void this._signal("afterRender");if(e&this.CHANGE_SCROLL)return e&this.CHANGE_TEXT||e&this.CHANGE_LINES?this.$textLayer.update(i):this.$textLayer.scrollLines(i),this.$showGutter&&this.$gutterLayer.update(i),this.$markerBack.update(i),this.$markerFront.update(i),this.$cursorLayer.update(i),this.$highlightGutterLine&&this.$updateGutterLineHighlight(),this.$moveTextAreaToCursor(),void this._signal("afterRender");e&this.CHANGE_TEXT?(this.$textLayer.update(i),this.$showGutter&&this.$gutterLayer.update(i)):e&this.CHANGE_LINES?(this.$updateLines()||e&this.CHANGE_GUTTER&&this.$showGutter)&&this.$gutterLayer.update(i):(e&this.CHANGE_TEXT||e&this.CHANGE_GUTTER)&&this.$showGutter&&this.$gutterLayer.update(i),e&this.CHANGE_CURSOR&&(this.$cursorLayer.update(i),this.$moveTextAreaToCursor(),this.$highlightGutterLine&&this.$updateGutterLineHighlight()),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_FRONT)&&this.$markerFront.update(i),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_BACK)&&this.$markerBack.update(i),this._signal("afterRender")}else this.$changes|=e},this.$autosize=function(){var e=this.session.getScreenLength()*this.lineHeight,t=this.$maxLines*this.lineHeight,i=Math.max((this.$minLines||1)*this.lineHeight,Math.min(t,e))+this.scrollMargin.v+(this.$extraHeight||0),n=t<e;if(i!=this.desiredHeight||this.$size.height!=this.desiredHeight||n!=this.$vScroll){n!=this.$vScroll&&(this.$vScroll=n,this.scrollBarV.setVisible(n));var o=this.container.clientWidth;this.container.style.height=i+"px",this.$updateCachedSize(!0,this.$gutterWidth,o,i),this.desiredHeight=i,this._signal("autosize")}},this.$computeLayerConfig=function(){this.$maxLines&&1<this.lineHeight&&this.$autosize();var e=this.session,t=this.$size,i=t.height<=2*this.lineHeight,n=this.session.getScreenLength()*this.lineHeight,o=this.scrollTop%this.lineHeight,r=t.scrollerHeight+this.lineHeight,a=this.$getLongestLine(),s=!i&&(this.$hScrollBarAlwaysVisible||t.scrollerWidth-a-2*this.$padding<0),l=this.$horizScroll!==s;l&&(this.$horizScroll=s,this.scrollBarH.setVisible(s));var c=!this.$maxLines&&this.$scrollPastEnd?(t.scrollerHeight-this.lineHeight)*this.$scrollPastEnd:0;n+=c,this.session.setScrollTop(Math.max(-this.scrollMargin.top,Math.min(this.scrollTop,n-t.scrollerHeight+this.scrollMargin.bottom))),this.session.setScrollLeft(Math.max(-this.scrollMargin.left,Math.min(this.scrollLeft,a+2*this.$padding-t.scrollerWidth+this.scrollMargin.right)));var u=!i&&(this.$vScrollBarAlwaysVisible||t.scrollerHeight-n+c<0||this.scrollTop),d=this.$vScroll!==u;d&&(this.$vScroll=u,this.scrollBarV.setVisible(u));var h,p,f=Math.ceil(r/this.lineHeight)-1,g=Math.max(0,Math.round((this.scrollTop-o)/this.lineHeight)),m=g+f,v=this.lineHeight;g=e.screenToDocumentRow(g,0);var y=e.getFoldLine(g);y&&(g=y.start.row),h=e.documentToScreenRow(g,0),p=e.getRowLength(g)*v,m=Math.min(e.screenToDocumentRow(m,0),e.getLength()-1),r=t.scrollerHeight+e.getRowLength(m)*v+p,o=this.scrollTop-h*v;var b=0;return this.layerConfig.width!=a&&(b=this.CHANGE_H_SCROLL),(l||d)&&(b=this.$updateCachedSize(!0,this.gutterWidth,t.width,t.height),this._signal("scrollbarVisibilityChanged"),d&&(a=this.$getLongestLine())),this.layerConfig={width:a,padding:this.$padding,firstRow:g,firstRowScreen:h,lastRow:m,lineHeight:v,characterWidth:this.characterWidth,minHeight:r,maxHeight:n,offset:o,gutterOffset:Math.max(0,Math.ceil((o+t.height-t.scrollerHeight)/v)),height:this.$size.scrollerHeight},b},this.$updateLines=function(){var e=this.$changedLines.firstRow,t=this.$changedLines.lastRow;this.$changedLines=null;var i=this.layerConfig;if(!(e>i.lastRow+1||t<i.firstRow))return t===1/0?(this.$showGutter&&this.$gutterLayer.update(i),void this.$textLayer.update(i)):(this.$textLayer.updateLines(i,e,t),!0)},this.$getLongestLine=function(){var e=this.session.getScreenWidth();return this.showInvisibles&&!this.session.$useWrapMode&&(e+=1),Math.max(this.$size.scrollerWidth-2*this.$padding,Math.round(e*this.characterWidth))},this.updateFrontMarkers=function(){this.$markerFront.setMarkers(this.session.getMarkers(!0)),this.$loop.schedule(this.CHANGE_MARKER_FRONT)},this.updateBackMarkers=function(){this.$markerBack.setMarkers(this.session.getMarkers()),this.$loop.schedule(this.CHANGE_MARKER_BACK)},this.addGutterDecoration=function(e,t){this.$gutterLayer.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){this.$gutterLayer.removeGutterDecoration(e,t)},this.updateBreakpoints=function(e){this.$loop.schedule(this.CHANGE_GUTTER)},this.setAnnotations=function(e){this.$gutterLayer.setAnnotations(e),this.$loop.schedule(this.CHANGE_GUTTER)},this.updateCursor=function(){this.$loop.schedule(this.CHANGE_CURSOR)},this.hideCursor=function(){this.$cursorLayer.hideCursor()},this.showCursor=function(){this.$cursorLayer.showCursor()},this.scrollSelectionIntoView=function(e,t,i){this.scrollCursorIntoView(e,i),this.scrollCursorIntoView(t,i)},this.scrollCursorIntoView=function(e,t,i){if(0!==this.$size.scrollerHeight){var n=this.$cursorLayer.getPixelPosition(e),o=n.left,r=n.top,a=i&&i.top||0,s=i&&i.bottom||0,l=this.$scrollAnimation?this.session.getScrollTop():this.scrollTop;r<l+a?(t&&(r-=t*this.$size.scrollerHeight),0===r&&(r=-this.scrollMargin.top),this.session.setScrollTop(r)):l+this.$size.scrollerHeight-s<r+this.lineHeight&&(t&&(r+=t*this.$size.scrollerHeight),this.session.setScrollTop(r+this.lineHeight-this.$size.scrollerHeight));var c=this.scrollLeft;o<c?(o<this.$padding+2*this.layerConfig.characterWidth&&(o=-this.scrollMargin.left),this.session.setScrollLeft(o)):c+this.$size.scrollerWidth<o+this.characterWidth?this.session.setScrollLeft(Math.round(o+this.characterWidth-this.$size.scrollerWidth)):c<=this.$padding&&o-c<this.characterWidth&&this.session.setScrollLeft(0)}},this.getScrollTop=function(){return this.session.getScrollTop()},this.getScrollLeft=function(){return this.session.getScrollLeft()},this.getScrollTopRow=function(){return this.scrollTop/this.lineHeight},this.getScrollBottomRow=function(){return Math.max(0,Math.floor((this.scrollTop+this.$size.scrollerHeight)/this.lineHeight)-1)},this.scrollToRow=function(e){this.session.setScrollTop(e*this.lineHeight)},this.alignCursor=function(e,t){"number"==typeof e&&(e={row:e,column:0});var i=this.$cursorLayer.getPixelPosition(e),n=this.$size.scrollerHeight-this.lineHeight,o=i.top-n*(t||0);return this.session.setScrollTop(o),o},this.STEPS=8,this.$calcSteps=function(e,t){var i,n,o=0,r=this.STEPS,a=[];for(o=0;o<r;++o)a.push((i=o/this.STEPS,(t-(n=e))*(Math.pow(i-1,3)+1)+n));return a},this.scrollToLine=function(e,t,i,n){var o=this.$cursorLayer.getPixelPosition({row:e,column:0}).top;t&&(o-=this.$size.scrollerHeight/2);var r=this.scrollTop;this.session.setScrollTop(o),!1!==i&&this.animateScrolling(r,n)},this.animateScrolling=function(e,t){var i=this.scrollTop;if(this.$animatedScroll){var n=this;if(e!=i){if(this.$scrollAnimation){var o=this.$scrollAnimation.steps;if(o.length&&(e=o[0])==i)return}var r=n.$calcSteps(e,i);this.$scrollAnimation={from:e,to:i,steps:r},clearInterval(this.$timer),n.session.setScrollTop(r.shift()),n.session.$scrollTop=i,this.$timer=setInterval(function(){r.length?(n.session.setScrollTop(r.shift()),n.session.$scrollTop=i):null!=i?(n.session.$scrollTop=-1,n.session.setScrollTop(i),i=null):(n.$timer=clearInterval(n.$timer),n.$scrollAnimation=null,t&&t())},10)}}},this.scrollToY=function(e){this.scrollTop!==e&&(this.$loop.schedule(this.CHANGE_SCROLL),this.scrollTop=e)},this.scrollToX=function(e){this.scrollLeft!==e&&(this.scrollLeft=e),this.$loop.schedule(this.CHANGE_H_SCROLL)},this.scrollTo=function(e,t){this.session.setScrollTop(t),this.session.setScrollLeft(t)},this.scrollBy=function(e,t){t&&this.session.setScrollTop(this.session.getScrollTop()+t),e&&this.session.setScrollLeft(this.session.getScrollLeft()+e)},this.isScrollableBy=function(e,t){return t<0&&this.session.getScrollTop()>=1-this.scrollMargin.top||(0<t&&this.session.getScrollTop()+this.$size.scrollerHeight-this.layerConfig.maxHeight<-1+this.scrollMargin.bottom||(e<0&&this.session.getScrollLeft()>=1-this.scrollMargin.left||(0<e&&this.session.getScrollLeft()+this.$size.scrollerWidth-this.layerConfig.width<-1+this.scrollMargin.right||void 0)))},this.pixelToScreenCoordinates=function(e,t){var i=this.scroller.getBoundingClientRect(),n=(e+this.scrollLeft-i.left-this.$padding)/this.characterWidth,o=Math.floor((t+this.scrollTop-i.top)/this.lineHeight),r=Math.round(n);return{row:o,column:r,side:0<n-r?1:-1}},this.screenToTextCoordinates=function(e,t){var i=this.scroller.getBoundingClientRect(),n=Math.round((e+this.scrollLeft-i.left-this.$padding)/this.characterWidth),o=(t+this.scrollTop-i.top)/this.lineHeight;return this.session.screenToDocumentPosition(o,Math.max(n,0))},this.textToScreenCoordinates=function(e,t){var i=this.scroller.getBoundingClientRect(),n=this.session.documentToScreenPosition(e,t),o=this.$padding+Math.round(n.column*this.characterWidth),r=n.row*this.lineHeight;return{pageX:i.left+o-this.scrollLeft,pageY:i.top+r-this.scrollTop}},this.visualizeFocus=function(){r.addCssClass(this.container,"ace_focus")},this.visualizeBlur=function(){r.removeCssClass(this.container,"ace_focus")},this.showComposition=function(e){this.$composition||(this.$composition={keepTextAreaAtCursor:this.$keepTextAreaAtCursor,cssText:this.textarea.style.cssText}),this.$keepTextAreaAtCursor=!0,r.addCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText="",this.$moveTextAreaToCursor()},this.setCompositionText=function(e){this.$moveTextAreaToCursor()},this.hideComposition=function(){this.$composition&&(r.removeCssClass(this.textarea,"ace_composition"),this.$keepTextAreaAtCursor=this.$composition.keepTextAreaAtCursor,this.textarea.style.cssText=this.$composition.cssText,this.$composition=null)},this.setTheme=function(i,n){var o=this;if(this.$themeId=i,o._dispatchEvent("themeChange",{theme:i}),i&&"string"!=typeof i)t(i);else{var e=i||this.$options.theme.initialValue;a.loadModule(["theme",e],t)}function t(e){if(o.$themeId!=i)return n&&n();if(e.cssClass){r.importCssString(e.cssText,e.cssClass,o.container.ownerDocument),o.theme&&r.removeCssClass(o.container,o.theme.cssClass);var t="padding"in e?e.padding:"padding"in(o.theme||{})?4:o.$padding;o.$padding&&t!=o.$padding&&o.setPadding(t),o.$theme=e.cssClass,o.theme=e,r.addCssClass(o.container,e.cssClass),r.setCssClass(o.container,"ace_dark",e.isDark),o.$size&&(o.$size.width=0,o.$updateSizeAsync()),o._dispatchEvent("themeLoaded",{theme:e}),n&&n()}}},this.getTheme=function(){return this.$themeId},this.setStyle=function(e,t){r.setCssClass(this.container,e,!1!==t)},this.unsetStyle=function(e){r.removeCssClass(this.container,e)},this.setCursorStyle=function(e){this.scroller.style.cursor!=e&&(this.scroller.style.cursor=e)},this.setMouseCursor=function(e){this.scroller.style.cursor=e},this.destroy=function(){this.$textLayer.destroy(),this.$cursorLayer.destroy()}}).call(m.prototype),a.defineOptions(m.prototype,"renderer",{animatedScroll:{initialValue:!1},showInvisibles:{set:function(e){this.$textLayer.setShowInvisibles(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!1},showPrintMargin:{set:function(){this.$updatePrintMargin()},initialValue:!0},printMarginColumn:{set:function(){this.$updatePrintMargin()},initialValue:80},printMargin:{set:function(e){"number"==typeof e&&(this.$printMarginColumn=e),this.$showPrintMargin=!!e,this.$updatePrintMargin()},get:function(){return this.$showPrintMargin&&this.$printMarginColumn}},showGutter:{set:function(e){this.$gutter.style.display=e?"block":"none",this.$loop.schedule(this.CHANGE_FULL),this.onGutterResize()},initialValue:!0},fadeFoldWidgets:{set:function(e){r.setCssClass(this.$gutter,"ace_fade-fold-widgets",e)},initialValue:!1},showFoldWidgets:{set:function(e){this.$gutterLayer.setShowFoldWidgets(e)},initialValue:!0},showLineNumbers:{set:function(e){this.$gutterLayer.setShowLineNumbers(e),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},displayIndentGuides:{set:function(e){this.$textLayer.setDisplayIndentGuides(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!0},highlightGutterLine:{set:function(e){if(!this.$gutterLineHighlight)return this.$gutterLineHighlight=r.createElement("div"),this.$gutterLineHighlight.className="ace_gutter-active-line",void this.$gutter.appendChild(this.$gutterLineHighlight);this.$gutterLineHighlight.style.display=e?"":"none",this.$cursorLayer.$pixelPos&&this.$updateGutterLineHighlight()},initialValue:!1,value:!0},hScrollBarAlwaysVisible:{set:function(e){this.$hScrollBarAlwaysVisible&&this.$horizScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},vScrollBarAlwaysVisible:{set:function(e){this.$vScrollBarAlwaysVisible&&this.$vScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},fontSize:{set:function(e){"number"==typeof e&&(e+="px"),this.container.style.fontSize=e,this.updateFontSize()},initialValue:12},fontFamily:{set:function(e){this.container.style.fontFamily=e,this.updateFontSize()}},maxLines:{set:function(e){this.updateFull()}},minLines:{set:function(e){this.updateFull()}},scrollPastEnd:{set:function(e){e=+e||0,this.$scrollPastEnd!=e&&(this.$scrollPastEnd=e,this.$loop.schedule(this.CHANGE_SCROLL))},initialValue:0,handlesSet:!0},fixedWidthGutter:{set:function(e){this.$gutterLayer.$fixedWidth=!!e,this.$loop.schedule(this.CHANGE_GUTTER)}},theme:{set:function(e){this.setTheme(e)},get:function(){return this.$themeId||this.theme},initialValue:"./theme/textmate",handlesSet:!0}}),t.VirtualRenderer=m}),ace.define("ace/worker/worker_client",["require","exports","module","ace/lib/oop","ace/lib/net","ace/lib/event_emitter","ace/config"],function(c,e,t){"use strict";function i(e,t,i,n){if(this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.onMessage=this.onMessage.bind(this),c.nameToUrl&&!c.toUrl&&(c.toUrl=c.nameToUrl),u.get("packaged")||!c.toUrl)n=n||u.moduleUrl(t,"worker");else{var o=this.$normalizePath;n=n||o(c.toUrl("ace/worker/worker.js",null,"_"));var r={};e.forEach(function(e){r[e]=o(c.toUrl(e,null,"_").replace(/(\.js)?(\?.*)?$/,""))})}try{this.$worker=new Worker(n)}catch(e){if(!(e instanceof window.DOMException))throw e;var a=this.$workerBlob(n),s=window.URL||window.webkitURL,l=s.createObjectURL(a);this.$worker=new Worker(l),s.revokeObjectURL(l)}this.$worker.postMessage({init:!0,tlns:r,module:t,classname:i}),this.callbackId=1,this.callbacks={},this.$worker.onmessage=this.onMessage}var n=c("../lib/oop"),o=c("../lib/net"),l=c("../lib/event_emitter").EventEmitter,u=c("../config");(function(){n.implement(this,l),this.onMessage=function(e){var t=e.data;switch(t.type){case"event":this._signal(t.name,{data:t.data});break;case"call":var i=this.callbacks[t.id];i&&(i(t.data),delete this.callbacks[t.id]);break;case"error":this.reportError(t.data);break;case"log":window.console&&console.log&&console.log.apply(console,t.data)}},this.reportError=function(e){window.console&&console.error&&console.error(e)},this.$normalizePath=function(e){return o.qualifyURL(e)},this.terminate=function(){this._signal("terminate",{}),this.deltaQueue=null,this.$worker.terminate(),this.$worker=null,this.$doc&&this.$doc.off("change",this.changeListener),this.$doc=null},this.send=function(e,t){this.$worker.postMessage({command:e,args:t})},this.call=function(e,t,i){if(i){var n=this.callbackId++;this.callbacks[n]=i,t.push(n)}this.send(e,t)},this.emit=function(e,t){try{this.$worker.postMessage({event:e,data:{data:t.data}})}catch(e){console.error(e.stack)}},this.attachToDocument=function(e){this.$doc&&this.terminate(),this.$doc=e,this.call("setValue",[e.getValue()]),e.on("change",this.changeListener)},this.changeListener=function(e){this.deltaQueue?this.deltaQueue.push(e.data):(this.deltaQueue=[e.data],setTimeout(this.$sendDeltaQueue,0))},this.$sendDeltaQueue=function(){var e=this.deltaQueue;e&&(this.deltaQueue=null,20<e.length&&e.length>this.$doc.getLength()>>1?this.call("setValue",[this.$doc.getValue()]):this.emit("change",{data:e}))},this.$workerBlob=function(e){var t="importScripts('"+o.qualifyURL(e)+"');";try{return new Blob([t],{type:"application/javascript"})}catch(e){var i=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder);return i.append(t),i.getBlob("application/javascript")}}}).call(i.prototype);function r(e,t,i){this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.callbackId=1,this.callbacks={},this.messageBuffer=[];var n=null,o=!1,r=Object.create(l),a=this;this.$worker={},this.$worker.terminate=function(){},this.$worker.postMessage=function(e){a.messageBuffer.push(e),n&&(o?setTimeout(s):s())},this.setEmitSync=function(e){o=e};var s=function(){var e=a.messageBuffer.shift();e.command?n[e.command].apply(n,e.args):e.event&&r._signal(e.event,e.data)};r.postMessage=function(e){a.onMessage({data:e})},r.callback=function(e,t){this.postMessage({type:"call",id:t,data:e})},r.emit=function(e,t){this.postMessage({type:"event",name:e,data:t})},u.loadModule(["worker",t],function(e){for(n=new e[i](r);a.messageBuffer.length;)s()})}r.prototype=i.prototype,e.UIWorkerClient=r,e.WorkerClient=i}),ace.define("ace/placeholder",["require","exports","module","ace/range","ace/lib/event_emitter","ace/lib/oop"],function(e,t,i){"use strict";function n(e,t,i,n,o,r){var a=this;this.length=t,this.session=e,this.doc=e.getDocument(),this.mainClass=o,this.othersClass=r,this.$onUpdate=this.onUpdate.bind(this),this.doc.on("change",this.$onUpdate),this.$others=n,this.$onCursorChange=function(){setTimeout(function(){a.onCursorChange()})},this.$pos=i;var s=e.getUndoManager().$undoStack||e.getUndoManager().$undostack||{length:-1};this.$undoStackDepth=s.length,this.setup(),e.selection.on("changeCursor",this.$onCursorChange)}var l=e("./range").Range,o=e("./lib/event_emitter").EventEmitter,r=e("./lib/oop");(function(){r.implement(this,o),this.setup=function(){var i=this,n=this.doc,t=this.session,e=this.$pos;this.selectionBefore=t.selection.toJSON(),t.selection.inMultiSelectMode&&t.selection.toSingleRange(),this.pos=n.createAnchor(e.row,e.column),this.markerId=t.addMarker(new l(e.row,e.column,e.row,e.column+this.length),this.mainClass,null,!1),this.pos.on("change",function(e){t.removeMarker(i.markerId),i.markerId=t.addMarker(new l(e.value.row,e.value.column,e.value.row,e.value.column+i.length),i.mainClass,null,!1)}),this.others=[],this.$others.forEach(function(e){var t=n.createAnchor(e.row,e.column);i.others.push(t)}),t.setUndoSelect(!1)},this.showOtherMarkers=function(){if(!this.othersActive){var i=this.session,n=this;this.othersActive=!0,this.others.forEach(function(t){t.markerId=i.addMarker(new l(t.row,t.column,t.row,t.column+n.length),n.othersClass,null,!1),t.on("change",function(e){i.removeMarker(t.markerId),t.markerId=i.addMarker(new l(e.value.row,e.value.column,e.value.row,e.value.column+n.length),n.othersClass,null,!1)})})}},this.hideOtherMarkers=function(){if(this.othersActive){this.othersActive=!1;for(var e=0;e<this.others.length;e++)this.session.removeMarker(this.others[e].markerId)}},this.onUpdate=function(e){var t=e.data,n=t.range;if(n.start.row===n.end.row&&n.start.row===this.pos.row&&!this.$updating){this.$updating=!0;var o="insertText"===t.action?n.end.column-n.start.column:n.start.column-n.end.column;if(n.start.column>=this.pos.column&&n.start.column<=this.pos.column+this.length+1){var i=n.start.column-this.pos.column;if(this.length+=o,!this.session.$fromUndo){if("insertText"===t.action)for(var r=this.others.length-1;0<=r;r--){var a={row:(s=this.others[r]).row,column:s.column+i};s.row===n.start.row&&n.start.column<s.column&&(a.column+=o),this.doc.insert(a,t.text)}else if("removeText"===t.action)for(r=this.others.length-1;0<=r;r--){var s;a={row:(s=this.others[r]).row,column:s.column+i};s.row===n.start.row&&n.start.column<s.column&&(a.column+=o),this.doc.remove(new l(a.row,a.column,a.row,a.column-o))}n.start.column===this.pos.column&&"insertText"===t.action?setTimeout(function(){this.pos.setPosition(this.pos.row,this.pos.column-o);for(var e=0;e<this.others.length;e++){var t=this.others[e],i={row:t.row,column:t.column-o};t.row===n.start.row&&n.start.column<t.column&&(i.column+=o),t.setPosition(i.row,i.column)}}.bind(this),0):n.start.column===this.pos.column&&"removeText"===t.action&&setTimeout(function(){for(var e=0;e<this.others.length;e++){var t=this.others[e];t.row===n.start.row&&n.start.column<t.column&&t.setPosition(t.row,t.column-o)}}.bind(this),0)}this.pos._emit("change",{value:this.pos});for(r=0;r<this.others.length;r++)this.others[r]._emit("change",{value:this.others[r]})}this.$updating=!1}},this.onCursorChange=function(e){if(!this.$updating&&this.session){var t=this.session.selection.getCursor();t.row===this.pos.row&&t.column>=this.pos.column&&t.column<=this.pos.column+this.length?(this.showOtherMarkers(),this._emit("cursorEnter",e)):(this.hideOtherMarkers(),this._emit("cursorLeave",e))}},this.detach=function(){this.session.removeMarker(this.markerId),this.hideOtherMarkers(),this.doc.removeEventListener("change",this.$onUpdate),this.session.selection.removeEventListener("changeCursor",this.$onCursorChange),this.pos.detach();for(var e=0;e<this.others.length;e++)this.others[e].detach();this.session.setUndoSelect(!0),this.session=null},this.cancel=function(){if(-1===this.$undoStackDepth)throw Error("Canceling placeholders only supported with undo manager attached to session.");for(var e=this.session.getUndoManager(),t=(e.$undoStack||e.$undostack).length-this.$undoStackDepth,i=0;i<t;i++)e.undo(!0);this.selectionBefore&&this.session.selection.fromJSON(this.selectionBefore)}}).call(n.prototype),t.PlaceHolder=n}),ace.define("ace/mouse/multi_select_handler",["require","exports","module","ace/lib/event","ace/lib/useragent"],function(e,t,i){var x=e("../lib/event"),S=e("../lib/useragent");function T(e,t){return e.row==t.row&&e.column==t.column}t.onMouseDown=function(e){var t=e.domEvent,i=t.altKey,n=t.shiftKey,o=t.ctrlKey,r=e.getAccelKey(),a=e.getButton();if(o&&S.isMac&&(a=t.button),e.editor.inMultiSelectMode&&2==a)e.editor.textInput.onContextMenu(e.domEvent);else if(o||i||r){if(0===a){var s,l=e.editor,c=l.selection,u=l.inMultiSelectMode,d=e.getDocumentPosition(),h=c.getCursor(),p=e.inSelection()||c.isEmpty()&&T(d,h),f=e.x,g=e.y,m=l.session,v=l.renderer.pixelToScreenCoordinates(f,g),y=v;if(l.$mouseHandler.$enableJumpToDef)o&&i||r&&i?s="add":i&&(s="block");else if(r&&!i){if(s="add",!u&&n)return}else i&&(s="block");if(s&&S.isMac&&t.ctrlKey&&l.$mouseHandler.cancelContextMenu(),"add"==s){if(!u&&p)return;if(!u){var b=c.toOrientedRange();l.addSelectionMarker(b)}var w=c.rangeList.rangeAtPoint(d);l.$blockScrolling++,l.inVirtualSelectionMode=!0,n&&(w=null,b=c.ranges[0],l.removeSelectionMarker(b)),l.once("mouseup",function(){var e=c.toOrientedRange();w&&e.isEmpty()&&T(w.cursor,e.cursor)?c.substractPoint(e.cursor):(n?c.substractPoint(b.cursor):b&&(l.removeSelectionMarker(b),c.addRange(b)),c.addRange(e)),l.$blockScrolling--,l.inVirtualSelectionMode=!1})}else if("block"==s){var C;e.stop(),l.inVirtualSelectionMode=!0;var _=[];l.$blockScrolling++,u&&!r?c.toSingleRange():!u&&r&&(C=c.toOrientedRange(),l.addSelectionMarker(C)),n?v=m.documentToScreenPosition(c.lead):c.moveToPosition(d),l.$blockScrolling--,y={row:-1,column:-1};var A=function(){var e=l.renderer.pixelToScreenCoordinates(f,g),t=m.screenToDocumentPosition(e.row,e.column);T(y,e)&&T(t,c.lead)||(y=e,l.$blockScrolling++,l.selection.moveToPosition(t),l.renderer.scrollCursorIntoView(),l.removeSelectionMarkers(_),_=c.rectangularRangeBlock(y,v),l.$mouseHandler.$clickSelection&&1==_.length&&_[0].isEmpty()&&(_[0]=l.$mouseHandler.$clickSelection.clone()),_.forEach(l.addSelectionMarker,l),l.updateSelectionMarkers(),l.$blockScrolling--)};x.capture(l.container,function(e){f=e.clientX,g=e.clientY},function(e){clearInterval(E),l.removeSelectionMarkers(_),_.length||(_=[c.toOrientedRange()]),l.$blockScrolling++,C&&(l.removeSelectionMarker(C),c.toSingleRange(C));for(var t=0;t<_.length;t++)c.addRange(_[t]);l.inVirtualSelectionMode=!1,l.$mouseHandler.$clickSelection=null,l.$blockScrolling--});var E=setInterval(function(){A()},20);return e.preventDefault()}}}else 0===a&&e.editor.inMultiSelectMode&&e.editor.exitMultiSelectMode()}}),ace.define("ace/commands/multi_select_commands",["require","exports","module","ace/keyboard/hash_handler"],function(e,t,i){t.defaultCommands=[{name:"addCursorAbove",exec:function(e){e.selectMoreLines(-1)},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},scrollIntoView:"cursor",readonly:!0},{name:"addCursorBelow",exec:function(e){e.selectMoreLines(1)},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},scrollIntoView:"cursor",readonly:!0},{name:"addCursorAboveSkipCurrent",exec:function(e){e.selectMoreLines(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},scrollIntoView:"cursor",readonly:!0},{name:"addCursorBelowSkipCurrent",exec:function(e){e.selectMoreLines(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},scrollIntoView:"cursor",readonly:!0},{name:"selectMoreBefore",exec:function(e){e.selectMore(-1)},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},scrollIntoView:"cursor",readonly:!0},{name:"selectMoreAfter",exec:function(e){e.selectMore(1)},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},scrollIntoView:"cursor",readonly:!0},{name:"selectNextBefore",exec:function(e){e.selectMore(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Left",mac:"Ctrl-Alt-Shift-Left"},scrollIntoView:"cursor",readonly:!0},{name:"selectNextAfter",exec:function(e){e.selectMore(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"Ctrl-Alt-Shift-Right"},scrollIntoView:"cursor",readonly:!0},{name:"splitIntoLines",exec:function(e){e.multiSelect.splitIntoLines()},bindKey:{win:"Ctrl-Alt-L",mac:"Ctrl-Alt-L"},readonly:!0},{name:"alignCursors",exec:function(e){e.alignCursors()},bindKey:{win:"Ctrl-Alt-A",mac:"Ctrl-Alt-A"},scrollIntoView:"cursor"},{name:"findAll",exec:function(e){e.findAll()},bindKey:{win:"Ctrl-Alt-K",mac:"Ctrl-Alt-G"},scrollIntoView:"cursor",readonly:!0}],t.multiSelectCommands=[{name:"singleSelection",bindKey:"esc",exec:function(e){e.exitMultiSelectMode()},scrollIntoView:"cursor",readonly:!0,isAvailable:function(e){return e&&e.inMultiSelectMode}}];var n=e("../keyboard/hash_handler").HashHandler;t.keyboardHandler=new n(t.multiSelectCommands)}),ace.define("ace/multi_select",["require","exports","module","ace/range_list","ace/range","ace/selection","ace/mouse/multi_select_handler","ace/lib/event","ace/lib/lang","ace/commands/multi_select_commands","ace/search","ace/edit_session","ace/editor","ace/config"],function(e,t,i){var n=e("./range_list").RangeList,y=e("./range").Range,g=e("./selection").Selection,o=e("./mouse/multi_select_handler").onMouseDown,r=e("./lib/event"),m=e("./lib/lang"),a=e("./commands/multi_select_commands");t.commands=a.defaultCommands.concat(a.multiSelectCommands);var s=new(e("./search").Search);var l=e("./edit_session").EditSession;(function(){this.getSelectionMarkers=function(){return this.$selectionMarkers}}).call(l.prototype),function(){this.ranges=null,this.rangeList=null,this.addRange=function(e,t){if(e){if(!this.inMultiSelectMode&&0===this.rangeCount){var i=this.toOrientedRange();if(this.rangeList.add(i),this.rangeList.add(e),2!=this.rangeList.ranges.length)return this.rangeList.removeAll(),t||this.fromOrientedRange(e);this.rangeList.removeAll(),this.rangeList.add(i),this.$onAddRange(i)}e.cursor||(e.cursor=e.end);var n=this.rangeList.add(e);return this.$onAddRange(e),n.length&&this.$onRemoveRange(n),1<this.rangeCount&&!this.inMultiSelectMode&&(this._signal("multiSelect"),this.inMultiSelectMode=!0,this.session.$undoSelect=!1,this.rangeList.attach(this.session)),t||this.fromOrientedRange(e)}},this.toSingleRange=function(e){e=e||this.ranges[0];var t=this.rangeList.removeAll();t.length&&this.$onRemoveRange(t),e&&this.fromOrientedRange(e)},this.substractPoint=function(e){var t=this.rangeList.substractPoint(e);if(t)return this.$onRemoveRange(t),t[0]},this.mergeOverlappingRanges=function(){var e=this.rangeList.merge();e.length?this.$onRemoveRange(e):this.ranges[0]&&this.fromOrientedRange(this.ranges[0])},this.$onAddRange=function(e){this.rangeCount=this.rangeList.ranges.length,this.ranges.unshift(e),this._signal("addRange",{range:e})},this.$onRemoveRange=function(e){if(this.rangeCount=this.rangeList.ranges.length,1==this.rangeCount&&this.inMultiSelectMode){var t=this.rangeList.ranges.pop();e.push(t),this.rangeCount=0}for(var i=e.length;i--;){var n=this.ranges.indexOf(e[i]);this.ranges.splice(n,1)}this._signal("removeRange",{ranges:e}),0===this.rangeCount&&this.inMultiSelectMode&&(this.inMultiSelectMode=!1,this._signal("singleSelect"),this.session.$undoSelect=!0,this.rangeList.detach(this.session)),(t=t||this.ranges[0])&&!t.isEqual(this.getRange())&&this.fromOrientedRange(t)},this.$initRangeList=function(){this.rangeList||(this.rangeList=new n,this.ranges=[],this.rangeCount=0)},this.getAllRanges=function(){return this.rangeCount?this.rangeList.ranges.concat():[this.getRange()]},this.splitIntoLines=function(){if(1<this.rangeCount){var e=this.rangeList.ranges,t=e[e.length-1],i=y.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(i,t.cursor==t.start)}else{i=this.getRange();var n=this.isBackwards(),o=i.start.row,r=i.end.row;if(o==r){if(n)var a=i.end,s=i.start;else a=i.start,s=i.end;return this.addRange(y.fromPoints(s,s)),void this.addRange(y.fromPoints(a,a))}var l=[],c=this.getLineRange(o,!0);c.start.column=i.start.column,l.push(c);for(var u=o+1;u<r;u++)l.push(this.getLineRange(u,!0));(c=this.getLineRange(r,!0)).end.column=i.end.column,l.push(c),l.forEach(this.addRange,this)}},this.toggleBlockSelection=function(){if(1<this.rangeCount){var e=this.rangeList.ranges,t=e[e.length-1],i=y.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(i,t.cursor==t.start)}else{var n=this.session.documentToScreenPosition(this.selectionLead),o=this.session.documentToScreenPosition(this.selectionAnchor);this.rectangularRangeBlock(n,o).forEach(this.addRange,this)}},this.rectangularRangeBlock=function(e,t,i){var n=[],o=e.column<t.column;if(o)var r=e.column,a=t.column;else r=t.column,a=e.column;var s,l,c=e.row<t.row;if(c)var u=e.row,d=t.row;else u=t.row,d=e.row;r<0&&(r=0),u<0&&(u=0),u==d&&(i=!0);for(var h=u;h<=d;h++){var p=y.fromPoints(this.session.screenToDocumentPosition(h,r),this.session.screenToDocumentPosition(h,a));if(p.isEmpty()){if(f&&(s=p.end,l=f,s.row==l.row&&s.column==l.column))break;var f=p.end}p.cursor=o?p.start:p.end,n.push(p)}if(c&&n.reverse(),!i){for(var g=n.length-1;n[g].isEmpty()&&0<g;)g--;if(0<g)for(var m=0;n[m].isEmpty();)m++;for(var v=g;m<=v;v--)n[v].isEmpty()&&n.splice(v,1)}return n}}.call(g.prototype);var c=e("./editor").Editor;function u(e){e.$multiselectOnSessionChange||(e.$onAddRange=e.$onAddRange.bind(e),e.$onRemoveRange=e.$onRemoveRange.bind(e),e.$onMultiSelect=e.$onMultiSelect.bind(e),e.$onSingleSelect=e.$onSingleSelect.bind(e),e.$multiselectOnSessionChange=t.onSessionChange.bind(e),e.$checkMultiselectChange=e.$checkMultiselectChange.bind(e),e.$multiselectOnSessionChange(e),e.on("changeSession",e.$multiselectOnSessionChange),e.on("mousedown",o),e.commands.addCommands(a.defaultCommands),function(t){var e=t.textInput.getElement(),i=!1;function n(e){i&&(t.renderer.setMouseCursor(""),i=!1)}r.addListener(e,"keydown",function(e){18!=e.keyCode||e.ctrlKey||e.shiftKey||e.metaKey?i&&n():i||(t.renderer.setMouseCursor("crosshair"),i=!0)}),r.addListener(e,"keyup",n),r.addListener(e,"blur",n)}(e))}(function(){this.updateSelectionMarkers=function(){this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.addSelectionMarker=function(e){e.cursor||(e.cursor=e.end);var t=this.getSelectionStyle();return e.marker=this.session.addMarker(e,"ace_selection",t),this.session.$selectionMarkers.push(e),this.session.selectionMarkerCount=this.session.$selectionMarkers.length,e},this.removeSelectionMarker=function(e){if(e.marker){this.session.removeMarker(e.marker);var t=this.session.$selectionMarkers.indexOf(e);-1!=t&&this.session.$selectionMarkers.splice(t,1),this.session.selectionMarkerCount=this.session.$selectionMarkers.length}},this.removeSelectionMarkers=function(e){for(var t=this.session.$selectionMarkers,i=e.length;i--;){var n=e[i];if(n.marker){this.session.removeMarker(n.marker);var o=t.indexOf(n);-1!=o&&t.splice(o,1)}}this.session.selectionMarkerCount=t.length},this.$onAddRange=function(e){this.addSelectionMarker(e.range),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onRemoveRange=function(e){this.removeSelectionMarkers(e.ranges),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onMultiSelect=function(e){this.inMultiSelectMode||(this.inMultiSelectMode=!0,this.setStyle("ace_multiselect"),this.keyBinding.addKeyboardHandler(a.keyboardHandler),this.commands.setDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers())},this.$onSingleSelect=function(e){this.session.multiSelect.inVirtualMode||(this.inMultiSelectMode=!1,this.unsetStyle("ace_multiselect"),this.keyBinding.removeKeyboardHandler(a.keyboardHandler),this.commands.removeDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers(),this._emit("changeSelection"))},this.$onMultiSelectExec=function(e){var t=e.command,i=e.editor;if(i.multiSelect){if(t.multiSelectAction)n="forEach"==t.multiSelectAction?i.forEachSelection(t,e.args):"forEachLine"==t.multiSelectAction?i.forEachSelection(t,e.args,!0):"single"==t.multiSelectAction?(i.exitMultiSelectMode(),t.exec(i,e.args||{})):t.multiSelectAction(i,e.args||{});else{var n=t.exec(i,e.args||{});i.multiSelect.addRange(i.multiSelect.toOrientedRange()),i.multiSelect.mergeOverlappingRanges()}return n}},this.forEachSelection=function(e,t,i){if(!this.inVirtualSelectionMode){var n,o=i&&i.keepOrder,r=1==i||i&&i.$byLines,a=this.session,s=this.selection,l=s.rangeList,c=(o?s:l).ranges;if(!c.length)return e.exec?e.exec(this,t||{}):e(this,t||{});var u=s._eventRegistry;s._eventRegistry={};var d=new g(a);this.inVirtualSelectionMode=!0;for(var h=c.length;h--;){if(r)for(;0<h&&c[h].start.row==c[h-1].end.row;)h--;d.fromOrientedRange(c[h]),d.index=h,this.selection=a.selection=d;var p=e.exec?e.exec(this,t||{}):e(this,t||{});n||void 0===p||(n=p),d.toOrientedRange(c[h])}d.detach(),this.selection=a.selection=s,this.inVirtualSelectionMode=!1,s._eventRegistry=u,s.mergeOverlappingRanges();var f=this.renderer.$scrollAnimation;return this.onCursorChange(),this.onSelectionChange(),f&&f.from==f.to&&this.renderer.animateScrolling(f.from),n}},this.exitMultiSelectMode=function(){this.inMultiSelectMode&&!this.inVirtualSelectionMode&&this.multiSelect.toSingleRange()},this.getSelectedText=function(){var e="";if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){for(var t=this.multiSelect.rangeList.ranges,i=[],n=0;n<t.length;n++)i.push(this.session.getTextRange(t[n]));var o=this.session.getDocument().getNewLineCharacter();(e=i.join(o)).length==(i.length-1)*o.length&&(e="")}else this.selection.isEmpty()||(e=this.session.getTextRange(this.getSelectionRange()));return e},this.$checkMultiselectChange=function(e,t){if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){var i=this.multiSelect.ranges[0];if(this.multiSelect.isEmpty()&&t==this.multiSelect.anchor)return;var n=t==this.multiSelect.anchor?i.cursor==i.start?i.end:i.start:i.cursor;n.row==t.row&&this.session.$clipPositionToDocument(n.row,n.column).column==t.column||this.multiSelect.toSingleRange(this.multiSelect.toOrientedRange())}},this.findAll=function(e,t,i){if((t=t||{}).needle=e||t.needle,null==t.needle){var n=this.selection.isEmpty()?this.selection.getWordRange():this.selection.getRange();t.needle=this.session.getTextRange(n)}this.$search.set(t);var o=this.$search.findAll(this.session);if(!o.length)return 0;this.$blockScrolling+=1;var r=this.multiSelect;i||r.toSingleRange(o[0]);for(var a=o.length;a--;)r.addRange(o[a],!0);return n&&r.rangeList.rangeAtPoint(n.start)&&r.addRange(n,!0),this.$blockScrolling-=1,o.length},this.selectMoreLines=function(e,t){var i=this.selection.toOrientedRange(),n=i.cursor==i.end,o=this.session.documentToScreenPosition(i.cursor);this.selection.$desiredColumn&&(o.column=this.selection.$desiredColumn);var r,a=this.session.screenToDocumentPosition(o.row+e,o.column);if(i.isEmpty())l=a;else var s=this.session.documentToScreenPosition(n?i.end:i.start),l=this.session.screenToDocumentPosition(s.row+e,s.column);n?(r=y.fromPoints(a,l)).cursor=r.start:(r=y.fromPoints(l,a)).cursor=r.end;if(r.desiredColumn=o.column,this.selection.inMultiSelectMode){if(t)var c=i.cursor}else this.selection.addRange(i);this.selection.addRange(r),c&&this.selection.substractPoint(c)},this.transposeSelections=function(e){for(var t=this.session,i=t.multiSelect,n=i.ranges,o=n.length;o--;){if((s=n[o]).isEmpty()){var r=t.getWordRange(s.start.row,s.start.column);s.start.row=r.start.row,s.start.column=r.start.column,s.end.row=r.end.row,s.end.column=r.end.column}}i.mergeOverlappingRanges();var a=[];for(o=n.length;o--;){var s=n[o];a.unshift(t.getTextRange(s))}e<0?a.unshift(a.pop()):a.push(a.shift());for(o=n.length;o--;){r=(s=n[o]).clone();t.replace(s,a[o]),s.start.row=r.start.row,s.start.column=r.start.column}},this.selectMore=function(e,t,i){var n=this.session,o=n.multiSelect.toOrientedRange();if(!o.isEmpty()||((o=n.getWordRange(o.start.row,o.start.column)).cursor=-1==e?o.start:o.end,this.multiSelect.addRange(o),!i)){var r=n.getTextRange(o),a=function(e,t,i){return s.$options.wrap=!0,s.$options.needle=t,s.$options.backwards=-1==i,s.find(e)}(n,r,e);a&&(a.cursor=-1==e?a.start:a.end,this.$blockScrolling+=1,this.session.unfold(a),this.multiSelect.addRange(a),this.$blockScrolling-=1,this.renderer.scrollCursorIntoView(null,.5)),t&&this.multiSelect.substractPoint(o.cursor)}},this.alignCursors=function(){var r=this.session,t=r.multiSelect,e=t.ranges,i=-1,n=e.filter(function(e){if(e.cursor.row==i)return!0;i=e.cursor.row});if(e.length&&n.length!=e.length-1){n.forEach(function(e){t.substractPoint(e.cursor)});var a=0,s=1/0,l=e.map(function(e){var t=e.cursor,i=r.getLine(t.row).substr(t.column).search(/\S/g);return-1==i&&(i=0),t.column>a&&(a=t.column),i<s&&(s=i),i});e.forEach(function(e,t){var i=e.cursor,n=a-i.column,o=l[t]-s;o<n?r.insert(i,m.stringRepeat(" ",n-o)):r.remove(new y(i.row,i.column,i.row,i.column-n+o)),e.start.column=e.end.column=a,e.start.row=e.end.row=i.row,e.cursor=e.end}),t.fromOrientedRange(e[0]),this.renderer.updateCursor(),this.renderer.updateBackMarkers()}else{var o=this.selection.getRange(),c=o.start.row,u=o.end.row,d=c==u;if(d){for(var h,p=this.session.getLength();h=this.session.getLine(u),/[=:]/.test(h)&&++u<p;);for(;h=this.session.getLine(c),/[=:]/.test(h)&&0<--c;);c<0&&(c=0),p<=u&&(u=p-1)}var f=this.session.doc.removeLines(c,u);f=this.$reAlignText(f,d),this.session.doc.insert({row:c,column:0},f.join("\n")+"\n"),d||(o.start.column=0,o.end.column=f[f.length-1].length),this.selection.setRange(o)}},this.$reAlignText=function(e,t){var i,n,o,r=!0,a=!0;return e.map(function(e){var t=e.match(/(\s*)(.*?)(\s*)([=:].*)/);return t?(null==i?(i=t[1].length,n=t[2].length,o=t[3].length):(i+n+o!=t[1].length+t[2].length+t[3].length&&(a=!1),i!=t[1].length&&(r=!1),i>t[1].length&&(i=t[1].length),n<t[2].length&&(n=t[2].length),o>t[3].length&&(o=t[3].length)),t):[e]}).map(t?l:r?a?function(e){return e[2]?s(i+n-e[2].length)+e[2]+s(o)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}:l:function(e){return e[2]?s(i)+e[2]+s(o)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]});function s(e){return m.stringRepeat(" ",e)}function l(e){return e[2]?s(i)+e[2]+s(n-e[2].length+o)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}}}).call(c.prototype),t.onSessionChange=function(e){var t=e.session;t&&!t.multiSelect&&(t.$selectionMarkers=[],t.selection.$initRangeList(),t.multiSelect=t.selection),this.multiSelect=t&&t.multiSelect;var i=e.oldSession;i&&(i.multiSelect.off("addRange",this.$onAddRange),i.multiSelect.off("removeRange",this.$onRemoveRange),i.multiSelect.off("multiSelect",this.$onMultiSelect),i.multiSelect.off("singleSelect",this.$onSingleSelect),i.multiSelect.lead.off("change",this.$checkMultiselectChange),i.multiSelect.anchor.off("change",this.$checkMultiselectChange)),t&&(t.multiSelect.on("addRange",this.$onAddRange),t.multiSelect.on("removeRange",this.$onRemoveRange),t.multiSelect.on("multiSelect",this.$onMultiSelect),t.multiSelect.on("singleSelect",this.$onSingleSelect),t.multiSelect.lead.on("change",this.$checkMultiselectChange),t.multiSelect.anchor.on("change",this.$checkMultiselectChange)),t&&this.inMultiSelectMode!=t.selection.inMultiSelectMode&&(t.selection.inMultiSelectMode?this.$onMultiSelect():this.$onSingleSelect())},t.MultiSelect=u,e("./config").defineOptions(c.prototype,"editor",{enableMultiselect:{set:function(e){u(this),e?(this.on("changeSession",this.$multiselectOnSessionChange),this.on("mousedown",o)):(this.off("changeSession",this.$multiselectOnSessionChange),this.off("mousedown",o))},value:!0}})}),ace.define("ace/mode/folding/fold_mode",["require","exports","module","ace/range"],function(e,t,i){"use strict";var h=e("../../range").Range,n=t.FoldMode=function(){};(function(){this.foldingStartMarker=null,this.foldingStopMarker=null,this.getFoldWidget=function(e,t,i){var n=e.getLine(i);return this.foldingStartMarker.test(n)?"start":"markbeginend"==t&&this.foldingStopMarker&&this.foldingStopMarker.test(n)?"end":""},this.getFoldWidgetRange=function(e,t,i){return null},this.indentationBlock=function(e,t,i){var n=/\S/,o=e.getLine(t),r=o.search(n);if(-1!=r){for(var a=i||o.length,s=e.getLength(),l=t,c=t;++t<s;){var u=e.getLine(t).search(n);if(-1!=u){if(u<=r)break;c=t}}if(l<c){var d=e.getLine(c).length;return new h(l,a,c,d)}}},this.openingBracketBlock=function(e,t,i,n,o){var r={row:i,column:n+1},a=e.$findClosingBracket(t,r,o);if(a){var s=e.foldWidgets[a.row];return null==s&&(s=e.getFoldWidget(a.row)),"start"==s&&a.row>r.row&&(a.row--,a.column=e.getLine(a.row).length),h.fromPoints(r,a)}},this.closingBracketBlock=function(e,t,i,n,o){var r={row:i,column:n},a=e.$findOpeningBracket(t,r);if(a)return a.column++,r.column--,h.fromPoints(a,r)}}).call(n.prototype)}),ace.define("ace/theme/textmate",["require","exports","module","ace/lib/dom"],function(e,t,i){"use strict";t.isDark=!1,t.cssClass="ace-tm",t.cssText='.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;border-radius: 2px;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}',e("../lib/dom").importCssString(t.cssText,t.cssClass)}),ace.define("ace/line_widgets",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/range"],function(e,t,i){"use strict";e("./lib/oop");var n=e("./lib/dom");e("./range").Range;function o(e){this.session=e,(this.session.widgetManager=this).session.getRowLength=this.getRowLength,this.session.$getWidgetScreenLength=this.$getWidgetScreenLength,this.updateOnChange=this.updateOnChange.bind(this),this.renderWidgets=this.renderWidgets.bind(this),this.measureWidgets=this.measureWidgets.bind(this),this.session._changedWidgets=[],this.$onChangeEditor=this.$onChangeEditor.bind(this),this.session.on("change",this.updateOnChange),this.session.on("changeEditor",this.$onChangeEditor)}(function(){this.getRowLength=function(e){var t;return t=this.lineWidgets&&this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0,this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1+t:1+t},this.$getWidgetScreenLength=function(){var t=0;return this.lineWidgets.forEach(function(e){e&&e.rowCount&&(t+=e.rowCount)}),t},this.$onChangeEditor=function(e){this.attach(e.editor)},this.attach=function(e){e&&e.widgetManager&&e.widgetManager!=this&&e.widgetManager.detach(),this.editor!=e&&(this.detach(),(this.editor=e)&&(e.widgetManager=this,e.renderer.on("beforeRender",this.measureWidgets),e.renderer.on("afterRender",this.renderWidgets)))},this.detach=function(e){var t=this.editor;if(t){this.editor=null,t.widgetManager=null,t.renderer.off("beforeRender",this.measureWidgets),t.renderer.off("afterRender",this.renderWidgets);var i=this.session.lineWidgets;i&&i.forEach(function(e){e&&e.el&&e.el.parentNode&&(e._inDocument=!1,e.el.parentNode.removeChild(e.el))})}},this.updateOnChange=function(e){var t=this.session.lineWidgets;if(t){var i=e.data,n=i.range,o=n.start.row,r=n.end.row-o;if(0==r);else if("removeText"==i.action||"removeLines"==i.action){t.splice(o+1,r).forEach(function(e){e&&this.removeLineWidget(e)},this),this.$updateRows()}else{var a=new Array(r);a.unshift(o,0),t.splice.apply(t,a),this.$updateRows()}}},this.$updateRows=function(){var e=this.session.lineWidgets;if(e){var i=!0;e.forEach(function(e,t){e&&(i=!1,e.row=t)}),i&&(this.session.lineWidgets=null)}},this.addLineWidget=function(e){this.session.lineWidgets||(this.session.lineWidgets=new Array(this.session.getLength())),this.session.lineWidgets[e.row]=e;var t=this.editor.renderer;return e.html&&!e.el&&(e.el=n.createElement("div"),e.el.innerHTML=e.html),e.el&&(n.addCssClass(e.el,"ace_lineWidgetContainer"),e.el.style.position="absolute",e.el.style.zIndex=5,t.container.appendChild(e.el),e._inDocument=!0),e.coverGutter||(e.el.style.zIndex=3),e.pixelHeight||(e.pixelHeight=e.el.offsetHeight),null==e.rowCount&&(e.rowCount=e.pixelHeight/t.layerConfig.lineHeight),this.session._emit("changeFold",{data:{start:{row:e.row}}}),this.$updateRows(),this.renderWidgets(null,t),e},this.removeLineWidget=function(e){if(e._inDocument=!1,e.el&&e.el.parentNode&&e.el.parentNode.removeChild(e.el),e.editor&&e.editor.destroy)try{e.editor.destroy()}catch(e){}this.session.lineWidgets&&(this.session.lineWidgets[e.row]=void 0),this.session._emit("changeFold",{data:{start:{row:e.row}}}),this.$updateRows()},this.onWidgetChanged=function(e){this.session._changedWidgets.push(e),this.editor&&this.editor.renderer.updateFull()},this.measureWidgets=function(e,t){var i=this.session._changedWidgets,n=t.layerConfig;if(i&&i.length){for(var o=1/0,r=0;r<i.length;r++){var a=i[r];a._inDocument||(a._inDocument=!0,t.container.appendChild(a.el)),a.h=a.el.offsetHeight,a.fixedWidth||(a.w=a.el.offsetWidth,a.screenWidth=Math.ceil(a.w/n.characterWidth));var s=a.h/n.lineHeight;a.coverLine&&(s-=this.session.getRowLineCount(a.row))<0&&(s=0),a.rowCount!=s&&(a.rowCount=s,a.row<o&&(o=a.row))}o!=1/0&&(this.session._emit("changeFold",{data:{start:{row:o}}}),this.session.lineWidgetWidth=null),this.session._changedWidgets=[]}},this.renderWidgets=function(e,t){var i=t.layerConfig,n=this.session.lineWidgets;if(n){for(var o=Math.min(this.firstRow,i.firstRow),r=Math.max(this.lastRow,i.lastRow,n.length);0<o&&!n[o];)o--;this.firstRow=i.firstRow,this.lastRow=i.lastRow,t.$cursorLayer.config=i;for(var a=o;a<=r;a++){var s=n[a];if(s&&s.el){s._inDocument||(s._inDocument=!0,t.container.appendChild(s.el));var l=t.$cursorLayer.getPixelPosition({row:a,column:0},!0).top;s.coverLine||(l+=i.lineHeight*this.session.getRowLineCount(s.row)),s.el.style.top=l-i.offset+"px";var c=s.coverGutter?0:t.gutterWidth;s.fixedWidth||(c-=t.scrollLeft),s.el.style.left=c+"px",s.fixedWidth?s.el.style.right=t.scrollBar.getWidth()+"px":s.el.style.right=""}}}}}).call(o.prototype),t.LineWidgets=o}),ace.define("ace/ext/error_marker",["require","exports","module","ace/line_widgets","ace/lib/dom","ace/range"],function(e,t,i){"use strict";var f=e("../line_widgets").LineWidgets,g=e("../lib/dom"),m=e("../range").Range;t.showErrorMarker=function(e,t){var i=e.session;i.widgetManager||(i.widgetManager=new f(i),i.widgetManager.attach(e));var n=e.getCursorPosition(),o=n.row,r=i.lineWidgets&&i.lineWidgets[o];r?r.destroy():o-=t;var a,s=function(e,t,i){var n=e.getAnnotations().sort(m.comparePoints);if(n.length){var o=function(e,t,i){for(var n=0,o=e.length-1;n<=o;){var r=n+o>>1,a=i(t,e[r]);if(0<a)n=1+r;else{if(!(a<0))return r;o=r-1}}return-(n+1)}(n,{row:t,column:-1},m.comparePoints);o<0&&(o=-o-1),o>=n.length-1?o=0<i?0:n.length-1:0===o&&i<0&&(o=n.length-1);var r=n[o];if(r&&i){if(r.row===t){for(;(r=n[o+=i])&&r.row===t;);if(!r)return n.slice()}var a=[];for(t=r.row;a[i<0?"unshift":"push"](r),(r=n[o+=i])&&r.row==t;);return a.length&&a}}}(i,o,t);if(s){var l=s[0];n.column=(l.pos&&"number"!=typeof l.column?l.pos.sc:l.column)||0,n.row=l.row,a=e.renderer.$gutterLayer.$annotations[n.row]}else{if(r)return;a={text:["Looks good!"],className:"ace_ok"}}e.session.unfold(n.row),e.selection.moveToPosition(n);var c={row:n.row,fixedWidth:!0,coverGutter:!0,el:g.createElement("div")},u=c.el.appendChild(g.createElement("div")),d=c.el.appendChild(g.createElement("div"));d.className="error_widget_arrow "+a.className;var h=e.renderer.$cursorLayer.getPixelPosition(n).left;d.style.left=h+e.renderer.gutterWidth-5+"px",c.el.className="error_widget_wrapper",u.className="error_widget "+a.className,u.innerHTML=a.text.join("<br>"),u.appendChild(g.createElement("div"));function p(e,t,i){if(0===t&&("esc"===i||"return"===i))return c.destroy(),{command:"null"}}c.destroy=function(){e.$mouseHandler.isMousePressed||(e.keyBinding.removeKeyboardHandler(p),i.widgetManager.removeLineWidget(c),e.off("changeSelection",c.destroy),e.off("changeSession",c.destroy),e.off("mouseup",c.destroy),e.off("change",c.destroy))},e.keyBinding.addKeyboardHandler(p),e.on("changeSelection",c.destroy),e.on("changeSession",c.destroy),e.on("mouseup",c.destroy),e.on("change",c.destroy),e.session.widgetManager.addLineWidget(c),c.el.onmousedown=e.focus.bind(e),e.renderer.scrollCursorIntoView(null,.5,{bottom:c.el.offsetHeight})},g.importCssString("    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }","")}),ace.define("ace/ace",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/dom","ace/lib/event","ace/editor","ace/edit_session","ace/undomanager","ace/virtual_renderer","ace/worker/worker_client","ace/keyboard/hash_handler","ace/placeholder","ace/multi_select","ace/mode/folding/fold_mode","ace/theme/textmate","ace/ext/error_marker","ace/config"],function(e,s,t){"use strict";e("./lib/fixoldbrowsers");var l=e("./lib/dom"),c=e("./lib/event"),u=e("./editor").Editor,n=e("./edit_session").EditSession,o=e("./undomanager").UndoManager,d=e("./virtual_renderer").VirtualRenderer;e("./worker/worker_client"),e("./keyboard/hash_handler"),e("./placeholder"),e("./multi_select"),e("./mode/folding/fold_mode"),e("./theme/textmate"),e("./ext/error_marker"),s.config=e("./config"),s.require=e,s.edit=function(e){if("string"==typeof e){var t=e;if(!(e=document.getElementById(t)))throw new Error("ace.edit can't find div #"+t)}if(e&&e.env&&e.env.editor instanceof u)return e.env.editor;var i="";if(e&&/input|textarea/i.test(e.tagName)){var n=e;i=n.value,e=l.createElement("pre"),n.parentNode.replaceChild(e,n)}else i=l.getInnerText(e),e.innerHTML="";var o=s.createEditSession(i),r=new u(new d(e));r.setSession(o);var a={document:o,editor:r,onResize:r.resize.bind(r,null)};return n&&(a.textarea=n),c.addListener(window,"resize",a.onResize),r.on("destroy",function(){c.removeListener(window,"resize",a.onResize),a.editor.container.env=null}),r.container.env=r.env=a,r},s.createEditSession=function(e,t){var i=new n(e,t);return i.setUndoManager(new o),i},s.EditSession=n,s.UndoManager=o}),ace.require(["ace/ace"],function(e){for(var t in e&&e.config.init(!0),window.ace||(window.ace=e),e)e.hasOwnProperty(t)&&(window.ace[t]=e[t])}),ace.define("ace/snippets",["require","exports","module","ace/lib/oop","ace/lib/event_emitter","ace/lib/lang","ace/range","ace/anchor","ace/keyboard/hash_handler","ace/tokenizer","ace/lib/dom","ace/editor"],function(e,a,t){"use strict";function i(){this.snippetMap={},this.snippetNameMap={}}var n=e("./lib/oop"),o=e("./lib/event_emitter").EventEmitter,c=e("./lib/lang"),u=e("./range").Range,r=e("./anchor").Anchor,s=e("./keyboard/hash_handler").HashHandler,l=e("./tokenizer").Tokenizer,h=u.comparePoints;(function(){n.implement(this,o),this.getTokenizer=function(){function o(e,t,i){return e=e.substr(1),/^\d+$/.test(e)&&!i.inFormatString?[{tabstopId:parseInt(e,10)}]:[{text:e}]}function e(e){return"(?:[^\\\\"+e+"]|\\\\.)"}return i.$tokenizer=new l({start:[{regex:/:/,onMatch:function(e,t,i){return i.length&&i[0].expectIf?(i[0].expectIf=!1,i[0].elseBranch=i[0],[i[0]]):":"}},{regex:/\\./,onMatch:function(e,t,i){var n=e[1];return"}"==n&&i.length?e=n:-1!="`$\\".indexOf(n)?e=n:i.inFormatString&&("n"==n?e="\n":"t"==n?e="\n":-1!="ulULE".indexOf(n)&&(e={changeCase:n,local:"a"<n})),[e]}},{regex:/}/,onMatch:function(e,t,i){return[i.length?i.shift():e]}},{regex:/\$(?:\d+|\w+)/,onMatch:o},{regex:/\$\{[\dA-Z_a-z]+/,onMatch:function(e,t,i){var n=o(e.substr(1),0,i);return i.unshift(n[0]),n},next:"snippetVar"},{regex:/\n/,token:"newline",merge:!1}],snippetVar:[{regex:"\\|"+e("\\|")+"*\\|",onMatch:function(e,t,i){i[0].choices=e.slice(1,-1).split(",")},next:"start"},{regex:"/("+e("/")+"+)/(?:("+e("/")+"*)/)(\\w*):?",onMatch:function(e,t,i){var n=i[0];return n.fmtString=e,e=this.splitRegex.exec(e),n.guard=e[1],n.fmt=e[2],n.flag=e[3],""},next:"start"},{regex:"`"+e("`")+"*`",onMatch:function(e,t,i){return i[0].code=e.splice(1,-1),""},next:"start"},{regex:"\\?",onMatch:function(e,t,i){i[0]&&(i[0].expectIf=!0)},next:"start"},{regex:"([^:}\\\\]|\\\\.)*:?",token:"",next:"start"}],formatString:[{regex:"/("+e("/")+"+)/",token:"regex"},{regex:"",onMatch:function(e,t,i){i.inFormatString=!0},next:"start"}]}),i.prototype.getTokenizer=function(){return i.$tokenizer},i.$tokenizer},this.tokenizeTmSnippet=function(e,t){return this.getTokenizer().getLineTokens(e,t).tokens.map(function(e){return e.value||e})},this.$getDefaultValue=function(e,t){if(/^[A-Z]\d+$/.test(t)){var i=t.substr(1);return(this.variables[t[0]+"__"]||{})[i]}if(/^\d+$/.test(t))return(this.variables.__||{})[t];if(t=t.replace(/^TM_/,""),e){var n=e.session;switch(t){case"CURRENT_WORD":var o=n.getWordRange();case"SELECTION":case"SELECTED_TEXT":return n.getTextRange(o);case"CURRENT_LINE":return n.getLine(e.getCursorPosition().row);case"PREV_LINE":return n.getLine(e.getCursorPosition().row-1);case"LINE_INDEX":return e.getCursorPosition().column;case"LINE_NUMBER":return e.getCursorPosition().row+1;case"SOFT_TABS":return n.getUseSoftTabs()?"YES":"NO";case"TAB_SIZE":return n.getTabSize();case"FILENAME":case"FILEPATH":return"";case"FULLNAME":return"Ace"}}},this.variables={},this.getVariableValue=function(e,t){return this.variables.hasOwnProperty(t)?this.variables[t](e,t)||"":this.$getDefaultValue(e,t)||""},this.tmStrFormat=function(e,t,r){var i=t.flag||"",n=t.guard;n=new RegExp(n,i.replace(/[^gi]/,""));var a=this.tokenizeTmSnippet(t.fmt,"formatString"),s=this,o=e.replace(n,function(){s.variables.__=arguments;for(var e=s.resolveVariables(a,r),t="E",i=0;i<e.length;i++){var n=e[i];if("object"==typeof n)if(e[i]="",n.changeCase&&n.local){var o=e[i+1];o&&"string"==typeof o&&("u"==n.changeCase?e[i]=o[0].toUpperCase():e[i]=o[0].toLowerCase(),e[i+1]=o.substr(1))}else n.changeCase&&(t=n.changeCase);else"U"==t?e[i]=n.toUpperCase():"L"==t&&(e[i]=n.toLowerCase())}return e.join("")});return this.variables.__=null,o},this.resolveVariables=function(i,e){for(var t=[],n=0;n<i.length;n++){var o=i[n];if("string"==typeof o)t.push(o);else{if("object"!=typeof o)continue;if(o.skip)a(o);else{if(o.processed<n)continue;if(o.text){var r=this.getVariableValue(e,o.text);r&&o.fmtString&&(r=this.tmStrFormat(r,o)),o.processed=n,null==o.expectIf?r&&(t.push(r),a(o)):r?o.skip=o.elseBranch:a(o)}else null!=o.tabstopId?t.push(o):null!=o.changeCase&&t.push(o)}}}function a(e){var t=i.indexOf(e,n+1);-1!=t&&(n=t)}return t},this.insertSnippetForSelection=function(e,t){var i=e.getCursorPosition(),n=e.session.getLine(i.row),o=e.session.getTabString(),r=n.match(/^\s*/)[0];i.column<r.length&&(r=r.slice(0,i.column));var a=this.tokenizeTmSnippet(t);a=(a=this.resolveVariables(a,e)).map(function(e){return"\n"==e?e+r:"string"==typeof e?e.replace(/\t/g,o):e});var s=[];a.forEach(function(e,t){if("object"==typeof e){var i=e.tabstopId,n=s[i];if(n||((n=s[i]=[]).index=i,n.value=""),-1===n.indexOf(e)){n.push(e);var o=a.indexOf(e,t+1);if(-1!==o){var r=a.slice(t+1,o);r.some(function(e){return"object"==typeof e})&&!n.value?n.value=r:!r.length||n.value&&"string"==typeof n.value||(n.value=r.join(""))}}}}),s.forEach(function(e){e.length=0});var l={};function c(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];if("object"==typeof n){if(l[n.tabstopId])continue;n=t[e.lastIndexOf(n,i-1)]||{tabstopId:n.tabstopId}}t[i]=n}return t}for(var u=0;u<a.length;u++){var d=a[u];if("object"==typeof d){var h=d.tabstopId,p=a.indexOf(d,u+1);if(l[h])l[h]===d&&(l[h]=null);else{var f=s[h],g="string"==typeof f.value?[f.value]:c(f.value);g.unshift(u+1,Math.max(0,p-u)),g.push(d),l[h]=d,a.splice.apply(a,g),-1===f.indexOf(d)&&f.push(d)}}}var m=0,v=0,y="";a.forEach(function(e){"string"==typeof e?("\n"===e[0]?(v=e.length-1,m++):v+=e.length,y+=e):e.start?e.end={row:m,column:v}:e.start={row:m,column:v}});var b=e.getSelectionRange(),w=e.session.replace(b,y),C=new A(e),_=e.inVirtualSelectionMode&&e.selection.index;C.addTabstops(s,b.start,w,_)},this.insertSnippet=function(e,t){var i=this;if(e.inVirtualSelectionMode)return i.insertSnippetForSelection(e,t);e.forEachSelection(function(){i.insertSnippetForSelection(e,t)},null,{keepOrder:!0}),e.tabstopManager&&e.tabstopManager.tabNext()},this.$getScope=function(e){var t=e.session.$mode.$id||"";if("html"===(t=t.split("/").pop())||"php"===t){"php"!==t||e.session.$mode.inlinePhp||(t="html");var i=e.getCursorPosition(),n=e.session.getState(i.row);"object"==typeof n&&(n=n[0]),n.substring&&("js-"==n.substring(0,3)?t="javascript":"css-"==n.substring(0,4)?t="css":"php-"==n.substring(0,4)&&(t="php"))}return t},this.getActiveScopes=function(e){var t=this.$getScope(e),i=[t],n=this.snippetMap;return n[t]&&n[t].includeScopes&&i.push.apply(i,n[t].includeScopes),i.push("_"),i},this.expandWithTab=function(e,t){var i=this,n=e.forEachSelection(function(){return i.expandSnippetForSelection(e,t)},null,{keepOrder:!0});return n&&e.tabstopManager&&e.tabstopManager.tabNext(),n},this.expandSnippetForSelection=function(e,t){var i,n=e.getCursorPosition(),o=e.session.getLine(n.row),r=o.substring(0,n.column),a=o.substr(n.column),s=this.snippetMap;return this.getActiveScopes(e).some(function(e){var t=s[e];return t&&(i=this.findMatchingSnippet(t,r,a)),!!i},this),!!i&&(t&&t.dryRun||(e.session.doc.removeInLine(n.row,n.column-i.replaceBefore.length,n.column+i.replaceAfter.length),this.variables.M__=i.matchBefore,this.variables.T__=i.matchAfter,this.insertSnippetForSelection(e,i.content),this.variables.M__=this.variables.T__=null),!0)},this.findMatchingSnippet=function(e,t,i){for(var n=e.length;n--;){var o=e[n];if((!o.startRe||o.startRe.test(t))&&((!o.endRe||o.endRe.test(i))&&(o.startRe||o.endRe)))return o.matchBefore=o.startRe?o.startRe.exec(t):[""],o.matchAfter=o.endRe?o.endRe.exec(i):[""],o.replaceBefore=o.triggerRe?o.triggerRe.exec(t)[0]:"",o.replaceAfter=o.endTriggerRe?o.endTriggerRe.exec(i)[0]:"",o}},this.snippetMap={},this.snippetNameMap={},this.register=function(e,n){var o=this.snippetMap,r=this.snippetNameMap,a=this;function s(e){return e&&!/^\^?\(.*\)\$?$|^\\b$/.test(e)&&(e="(?:"+e+")"),e||""}function l(e,t,i){return e=s(e),t=s(t),i?(e=t+e)&&"$"!=e[e.length-1]&&(e+="$"):(e+=t)&&"^"!=e[0]&&(e="^"+e),new RegExp(e)}function t(e){e.scope||(e.scope=n||"_"),n=e.scope,o[n]||(o[n]=[],r[n]={});var t=r[n];if(e.name){var i=t[e.name];i&&a.unregister(i),t[e.name]=e}o[n].push(e),e.tabTrigger&&!e.trigger&&(!e.guard&&/^\w/.test(e.tabTrigger)&&(e.guard="\\b"),e.trigger=c.escapeRegExp(e.tabTrigger)),e.startRe=l(e.trigger,e.guard,!0),e.triggerRe=new RegExp(e.trigger,"",!0),e.endRe=l(e.endTrigger,e.endGuard,!0),e.endTriggerRe=new RegExp(e.endTrigger,"",!0)}(e=e||[])&&e.content?t(e):Array.isArray(e)&&e.forEach(t),this._signal("registerSnippets",{scope:n})},this.unregister=function(e,o){var r=this.snippetMap,a=this.snippetNameMap;function t(e){var t=a[e.scope||o];if(t&&t[e.name]){delete t[e.name];var i=r[e.scope||o],n=i&&i.indexOf(e);0<=n&&i.splice(n,1)}}e.content?t(e):Array.isArray(e)&&e.forEach(t)},this.parseSnippetFile=function(e){e=e.replace(/\r/g,"");for(var t,i=[],n={},o=/^#.*|^({[\s\S]*})\s*$|^(\S+) (.*)$|^((?:\n*\t.*)+)/gm;t=o.exec(e);){if(t[1])try{n=JSON.parse(t[1]),i.push(n)}catch(e){}if(t[4])n.content=t[4].replace(/^\t/gm,""),i.push(n),n={};else{var r=t[2],a=t[3];if("regex"==r){var s=/\/((?:[^\/\\]|\\.)*)|$/g;n.guard=s.exec(a)[1],n.trigger=s.exec(a)[1],n.endTrigger=s.exec(a)[1],n.endGuard=s.exec(a)[1]}else"snippet"==r?(n.tabTrigger=a.match(/^\S*/)[0],n.name||(n.name=a)):n[r]=a}}return i},this.getSnippetByName=function(i,e){var n,o=this.snippetNameMap;return this.getActiveScopes(e).some(function(e){var t=o[e];return t&&(n=t[i]),!!n},this),n}}).call(i.prototype);var A=function(e){if(e.tabstopManager)return e.tabstopManager;(e.tabstopManager=this).$onChange=this.onChange.bind(this),this.$onChangeSelection=c.delayedCall(this.onChangeSelection.bind(this)).schedule,this.$onChangeSession=this.onChangeSession.bind(this),this.$onAfterExec=this.onAfterExec.bind(this),this.attach(e)};(function(){this.attach=function(e){this.index=0,this.ranges=[],this.tabstops=[],this.$openTabstops=null,this.selectedTabstop=null,this.editor=e,this.editor.on("change",this.$onChange),this.editor.on("changeSelection",this.$onChangeSelection),this.editor.on("changeSession",this.$onChangeSession),this.editor.commands.on("afterExec",this.$onAfterExec),this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler)},this.detach=function(){this.tabstops.forEach(this.removeTabstopMarkers,this),this.ranges=null,this.tabstops=null,this.selectedTabstop=null,this.editor.removeListener("change",this.$onChange),this.editor.removeListener("changeSelection",this.$onChangeSelection),this.editor.removeListener("changeSession",this.$onChangeSession),this.editor.commands.removeListener("afterExec",this.$onAfterExec),this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.tabstopManager=null,this.editor=null},this.onChange=function(e){var t=e.data.range,i="r"==e.data.action[0],n=t.start,o=t.end,r=n.row,a=o.row-r,s=o.column-n.column;if(i&&(a=-a,s=-s),!this.$inChange&&i){var l=this.selectedTabstop;if(l&&!l.some(function(e){return h(e.start,n)<=0&&0<=h(e.end,o)}))return this.detach()}for(var c=this.ranges,u=0;u<c.length;u++){var d=c[u];d.end.row<n.row||(i&&h(n,d.start)<0&&0<h(o,d.end)?(this.removeRange(d),u--):(d.start.row==r&&d.start.column>n.column&&(d.start.column+=s),d.end.row==r&&d.end.column>=n.column&&(d.end.column+=s),d.start.row>=r&&(d.start.row+=a),d.end.row>=r&&(d.end.row+=a),0<h(d.start,d.end)&&this.removeRange(d)))}c.length||this.detach()},this.updateLinkedFields=function(){var e=this.selectedTabstop;if(e&&e.hasLinkedRanges){this.$inChange=!0;for(var t=this.editor.session,i=t.getTextRange(e.firstNonLinked),n=e.length;n--;){var o=e[n];if(o.linked){var r=a.snippetManager.tmStrFormat(i,o.original);t.replace(o,r)}}this.$inChange=!1}},this.onAfterExec=function(e){e.command&&!e.command.readOnly&&this.updateLinkedFields()},this.onChangeSelection=function(){if(this.editor){for(var e=this.editor.selection.lead,t=this.editor.selection.anchor,i=this.editor.selection.isEmpty(),n=this.ranges.length;n--;)if(!this.ranges[n].linked){var o=this.ranges[n].contains(e.row,e.column),r=i||this.ranges[n].contains(t.row,t.column);if(o&&r)return}this.detach()}},this.onChangeSession=function(){this.detach()},this.tabNext=function(e){var t=this.tabstops.length,i=this.index+(e||1);(i=Math.min(Math.max(i,1),t))==t&&(i=0),this.selectTabstop(i),0===i&&this.detach()},this.selectTabstop=function(e){this.$openTabstops=null;var t=this.tabstops[this.index];if(t&&this.addTabstopMarkers(t),this.index=e,(t=this.tabstops[this.index])&&t.length){if(this.selectedTabstop=t,this.editor.inVirtualSelectionMode)this.editor.selection.setRange(t.firstNonLinked);else{var i=this.editor.multiSelect;i.toSingleRange(t.firstNonLinked.clone());for(var n=t.length;n--;)t.hasLinkedRanges&&t[n].linked||i.addRange(t[n].clone(),!0);i.ranges[0]&&i.addRange(i.ranges[0].clone())}this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler)}},this.addTabstops=function(e,a,t){if(this.$openTabstops||(this.$openTabstops=[]),!e[0]){var i=u.fromPoints(t,t);f(i.start,a),f(i.end,a),e[0]=[i],e[0].index=0}var s=[this.index+1,0],l=this.ranges;e.forEach(function(e,t){for(var i=this.$openTabstops[t]||e,n=e.length;n--;){var o=e[n],r=u.fromPoints(o.start,o.end||o.start);p(r.start,a),p(r.end,a),r.original=o,r.tabstop=i,l.push(r),i!=e?i.unshift(r):i[n]=r,o.fmtString?(r.linked=!0,i.hasLinkedRanges=!0):i.firstNonLinked||(i.firstNonLinked=r)}i.firstNonLinked||(i.hasLinkedRanges=!1),i===e&&(s.push(i),this.$openTabstops[t]=i),this.addTabstopMarkers(i)},this),2<s.length&&(this.tabstops.length&&s.push(s.splice(2,1)[0]),this.tabstops.splice.apply(this.tabstops,s))},this.addTabstopMarkers=function(e){var t=this.editor.session;e.forEach(function(e){e.markerId||(e.markerId=t.addMarker(e,"ace_snippet-marker","text"))})},this.removeTabstopMarkers=function(e){var t=this.editor.session;e.forEach(function(e){t.removeMarker(e.markerId),e.markerId=null})},this.removeRange=function(e){var t=e.tabstop.indexOf(e);e.tabstop.splice(t,1),t=this.ranges.indexOf(e),this.ranges.splice(t,1),this.editor.session.removeMarker(e.markerId),e.tabstop.length||(-1!=(t=this.tabstops.indexOf(e.tabstop))&&this.tabstops.splice(t,1),this.tabstops.length||this.detach())},this.keyboardHandler=new s,this.keyboardHandler.bindKeys({Tab:function(e){a.snippetManager&&a.snippetManager.expandWithTab(e)||e.tabstopManager.tabNext(1)},"Shift-Tab":function(e){e.tabstopManager.tabNext(-1)},Esc:function(e){e.tabstopManager.detach()},Return:function(e){return!1}})}).call(A.prototype);var d={};d.onChange=r.prototype.onChange,d.setPosition=function(e,t){this.pos.row=e,this.pos.column=t},d.update=function(e,t,i){this.$insertRight=i,this.pos=e,this.onChange(t)};var p=function(e,t){0==e.row&&(e.column+=t.column),e.row+=t.row},f=function(e,t){e.row==t.row&&(e.column-=t.column),e.row-=t.row};e("./lib/dom").importCssString(".ace_snippet-marker {    -moz-box-sizing: border-box;    box-sizing: border-box;    background: rgba(194, 193, 208, 0.09);    border: 1px dotted rgba(211, 208, 235, 0.62);    position: absolute;}"),a.snippetManager=new i;var g=e("./editor").Editor;(function(){this.insertSnippet=function(e,t){return a.snippetManager.insertSnippet(this,e,t)},this.expandSnippet=function(e){return a.snippetManager.expandWithTab(this,e)}}).call(g.prototype)}),ace.define("ace/autocomplete/popup",["require","exports","module","ace/edit_session","ace/virtual_renderer","ace/editor","ace/range","ace/lib/event","ace/lib/lang","ace/lib/dom"],function(e,t,i){"use strict";e("../edit_session").EditSession;function l(e){var t=new n(e);t.$maxLines=4;var i=new o(t);return i.setHighlightActiveLine(!1),i.setShowPrintMargin(!1),i.renderer.setShowGutter(!1),i.renderer.setHighlightGutterLine(!1),i.$mouseHandler.$focusWaitTimout=0,i.$highlightTagPending=!0,i}var n=e("../virtual_renderer").VirtualRenderer,o=e("../editor").Editor,d=e("../range").Range,h=e("../lib/event"),p=e("../lib/lang"),f=e("../lib/dom");f.importCssString(".ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {    background-color: #CAD6FA;    z-index: 1;}.ace_editor.ace_autocomplete .ace_line-hover {    border: 1px solid #abbffe;    margin-top: -1px;    background: rgba(233,233,253,0.4);}.ace_editor.ace_autocomplete .ace_line-hover {    position: absolute;    z-index: 2;}.ace_editor.ace_autocomplete .ace_scroller {   background: none;   border: none;   box-shadow: none;}.ace_rightAlignedText {    color: gray;    display: inline-block;    position: absolute;    right: 4px;    text-align: right;    z-index: -1;}.ace_editor.ace_autocomplete .ace_completion-highlight{    color: #000;    text-shadow: 0 0 0.01em;}.ace_editor.ace_autocomplete {    width: 280px;    z-index: 200000;    background: #fbfbfb;    color: #444;    border: 1px lightgray solid;    position: fixed;    box-shadow: 2px 3px 5px rgba(0,0,0,.2);    line-height: 1.4;}"),t.AcePopup=function(e){var t=f.createElement("div"),c=new l(t);e&&e.appendChild(t),t.style.display="none",c.renderer.content.style.cursor="default",c.renderer.setStyle("ace_autocomplete"),c.setOption("displayIndentGuides",!1),c.setOption("dragDelay",150);function i(){}var u;c.focus=i,c.$isFocused=!0,c.renderer.$cursorLayer.restartTimer=i,c.renderer.$cursorLayer.element.style.opacity=0,c.renderer.$maxLines=8,c.renderer.$keepTextAreaAtCursor=!1,c.setHighlightActiveLine(!1),c.session.highlight(""),c.session.$searchHighlight.clazz="ace_highlight-marker",c.on("mousedown",function(e){var t=e.getDocumentPosition();c.selection.moveToPosition(t),o.start.row=o.end.row=t.row,e.stop()});var n=new d(-1,0,-1,1/0),o=new d(-1,0,-1,1/0);o.id=c.session.addMarker(o,"ace_active-line","fullLine"),c.setSelectOnHover=function(e){e?n.id&&(c.session.removeMarker(n.id),n.id=null):n.id=c.session.addMarker(n,"ace_line-hover","fullLine")},c.setSelectOnHover(!1),c.on("mousemove",function(e){if(u){if(u.x!=e.x||u.y!=e.y){(u=e).scrollTop=c.renderer.scrollTop;var t=u.getDocumentPosition().row;n.start.row!=t&&(n.id||c.setRow(t),a(t))}}else u=e}),c.renderer.on("beforeRender",function(){if(u&&-1!=n.start.row){u.$pos=null;var e=u.getDocumentPosition().row;n.id||c.setRow(e),a(e,!0)}}),c.renderer.on("afterRender",function(){var e=c.getRow(),t=c.renderer.$textLayer,i=t.element.childNodes[e-t.config.firstRow];i!=t.selectedNode&&(t.selectedNode&&f.removeCssClass(t.selectedNode,"ace_selected"),(t.selectedNode=i)&&f.addCssClass(i,"ace_selected"))});function r(){a(-1)}var a=function(e,t){e!==n.start.row&&(n.start.row=n.end.row=e,t||c.session._emit("changeBackMarker"),c._emit("changeHoverMarker"))};c.getHoveredRow=function(){return n.start.row},h.addListener(c.container,"mouseout",r),c.on("hide",r),c.on("changeSelection",r),c.session.doc.getLength=function(){return c.data.length},c.session.doc.getLine=function(e){var t=c.data[e];return"string"==typeof t?t:t&&t.value||""};var s=c.session.bgTokenizer;return s.$tokenizeRow=function(e){var t=c.data[e],i=[];if(!t)return i;"string"==typeof t&&(t={value:t}),t.caption||(t.caption=t.value||t.name);for(var n,o,r=-1,a=0;a<t.caption.length;a++)o=t.caption[a],r!==(n=t.matchMask&1<<a?1:0)?(i.push({type:t.className||(n?"completion-highlight":""),value:o}),r=n):i[i.length-1].value+=o;if(t.meta){var s=c.renderer.$size.scrollerWidth/c.renderer.layerConfig.characterWidth;t.meta.length+t.caption.length<s-2&&i.push({type:"rightAlignedText",value:t.meta})}return i},s.$updateOnChange=i,s.start=i,c.session.$computeWidth=function(){return this.screenWidth=0},c.$blockScrolling=1/0,c.isOpen=!1,c.isTopdown=!1,c.data=[],c.setData=function(e){c.data=e||[],c.setValue(p.stringRepeat("\n",e.length),-1),c.setRow(0)},c.getData=function(e){return c.data[e]},c.getRow=function(){return o.start.row},c.setRow=function(e){e=Math.max(-1,Math.min(this.data.length,e)),o.start.row!=e&&(c.selection.clearSelection(),o.start.row=o.end.row=e||0,c.session._emit("changeBackMarker"),c.moveCursorTo(e||0,0),c.isOpen&&c._signal("select"))},c.on("changeSelection",function(){c.isOpen&&c.setRow(c.selection.lead.row),c.renderer.scrollCursorIntoView()}),c.hide=function(){this.container.style.display="none",this._signal("hide"),c.isOpen=!1},c.show=function(e,t,i){var n=this.container,o=window.innerHeight,r=window.innerWidth,a=this.renderer.$maxLines*t*1.4,s=e.top+this.$borderSize;o-t<s+a&&!i?(n.style.top="",n.style.bottom=o-s+"px",c.isTopdown=!1):(s+=t,n.style.top=s+"px",n.style.bottom="",c.isTopdown=!0),n.style.display="",this.renderer.$textLayer.checkForSizeChanges();var l=e.left;l+n.offsetWidth>r&&(l=r-n.offsetWidth),n.style.left=l+"px",this._signal("show"),u=null,c.isOpen=!0},c.getTextLeftOffset=function(){return this.$borderSize+this.renderer.$padding+this.$imageSize},c.$imageSize=0,c.$borderSize=1,c}}),ace.define("ace/autocomplete/util",["require","exports","module"],function(e,t,i){"use strict";t.parForEach=function(e,t,i){var n=0,o=e.length;0===o&&i();for(var r=0;r<o;r++)t(e[r],function(e,t){++n===o&&i(e,t)})};var r=/[a-zA-Z_0-9\$\-\u00A2-\uFFFF]/;t.retrievePrecedingIdentifier=function(e,t,i){i=i||r;for(var n=[],o=t-1;0<=o&&i.test(e[o]);o--)n.push(e[o]);return n.reverse().join("")},t.retrieveFollowingIdentifier=function(e,t,i){i=i||r;for(var n=[],o=t;o<e.length&&i.test(e[o]);o++)n.push(e[o]);return n}}),ace.define("ace/autocomplete",["require","exports","module","ace/keyboard/hash_handler","ace/autocomplete/popup","ace/autocomplete/util","ace/lib/event","ace/lib/lang","ace/lib/dom","ace/snippets"],function(e,t,i){"use strict";function n(){this.autoInsert=!0,this.autoSelect=!0,this.exactMatch=!1,this.keyboardHandler=new o,this.keyboardHandler.bindKeys(this.commands),this.blurListener=this.blurListener.bind(this),this.changeListener=this.changeListener.bind(this),this.mousedownListener=this.mousedownListener.bind(this),this.mousewheelListener=this.mousewheelListener.bind(this),this.changeTimer=a.delayedCall(function(){this.updateCompletions(!0)}.bind(this)),this.tooltipTimer=a.delayedCall(this.updateDocTooltip.bind(this),50)}var o=e("./keyboard/hash_handler").HashHandler,r=e("./autocomplete/popup").AcePopup,c=e("./autocomplete/util"),a=(e("./lib/event"),e("./lib/lang")),s=e("./lib/dom"),l=e("./snippets").snippetManager;(function(){this.gatherCompletionsId=0,this.$init=function(){return this.popup=new r(document.body||document.documentElement),this.popup.on("click",function(e){this.insertMatch(),e.stop()}.bind(this)),this.popup.focus=this.editor.focus.bind(this.editor),this.popup.on("show",this.tooltipTimer.bind(null,null)),this.popup.on("select",this.tooltipTimer.bind(null,null)),this.popup.on("changeHoverMarker",this.tooltipTimer.bind(null,null)),this.popup},this.getPopup=function(){return this.popup||this.$init()},this.openPopup=function(e,t,i){this.popup||this.$init(),this.popup.setData(this.completions.filtered);var n=e.renderer;if(this.popup.setRow(this.autoSelect?0:-1),i)i&&!t&&this.detach();else{this.popup.setTheme(e.getTheme()),this.popup.setFontSize(e.getFontSize());var o=n.layerConfig.lineHeight,r=n.$cursorLayer.getPixelPosition(this.base,!0);r.left-=this.popup.getTextLeftOffset();var a=e.container.getBoundingClientRect();r.top+=a.top-n.layerConfig.offset,r.left+=a.left-e.renderer.scrollLeft,r.left+=n.$gutterLayer.gutterWidth,this.popup.show(r,o)}},this.detach=function(){this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.off("changeSelection",this.changeListener),this.editor.off("blur",this.blurListener),this.editor.off("mousedown",this.mousedownListener),this.editor.off("mousewheel",this.mousewheelListener),this.changeTimer.cancel(),this.hideDocTooltip(),this.popup&&this.popup.isOpen&&(this.gatherCompletionsId+=1,this.popup.hide()),this.base&&this.base.detach(),this.activated=!1,this.completions=this.base=null},this.changeListener=function(e){var t=this.editor.selection.lead;(t.row!=this.base.row||t.column<this.base.column)&&this.detach(),this.activated?this.changeTimer.schedule():this.detach()},this.blurListener=function(e){var t=document.activeElement,i=this.editor.textInput.getElement();t!=i&&t.parentNode!=this.popup.container&&t!=this.tooltipNode&&e.relatedTarget!=this.tooltipNode&&e.relatedTarget!=i&&this.detach()},this.mousedownListener=function(e){this.detach()},this.mousewheelListener=function(e){this.detach()},this.goTo=function(e){var t=this.popup.getRow(),i=this.popup.session.getLength()-1;switch(e){case"up":t=t<=0?i:t-1;break;case"down":t=i<=t?-1:t+1;break;case"start":t=0;break;case"end":t=i}this.popup.setRow(t)},this.insertMatch=function(e){if(!(e=e||this.popup.getData(this.popup.getRow())))return!1;if(e.completer&&e.completer.insertMatch)e.completer.insertMatch(this.editor,e);else{if(this.completions.filterText)for(var t,i=this.editor.selection.getAllRanges(),n=0;t=i[n];n++)t.start.column-=this.completions.filterText.length,this.editor.session.remove(t);e.snippet?l.insertSnippet(this.editor,e.snippet):this.editor.execCommand("insertstring",e.value||e)}this.detach()},this.commands={Up:function(e){e.completer.goTo("up")},Down:function(e){e.completer.goTo("down")},"Ctrl-Up|Ctrl-Home":function(e){e.completer.goTo("start")},"Ctrl-Down|Ctrl-End":function(e){e.completer.goTo("end")},Esc:function(e){e.completer.detach()},Space:function(e){e.completer.detach(),e.insert(" ")},Return:function(e){return e.completer.insertMatch()},"Shift-Return":function(e){e.completer.insertMatch(!0)},Tab:function(e){var t=e.completer.insertMatch();if(t||e.tabstopManager)return t;e.completer.goTo("down")},PageUp:function(e){e.completer.popup.gotoPageUp()},PageDown:function(e){e.completer.popup.gotoPageDown()}},this.gatherCompletions=function(o,r){var a=o.getSession(),i=o.getCursorPosition(),e=a.getLine(i.row),n=c.retrievePrecedingIdentifier(e,i.column);this.base=a.doc.createAnchor(i.row,i.column-n.length),this.base.$insertRight=!0;var s=[],l=o.completers.length;return o.completers.forEach(function(e,t){e.getCompletions(o,a,i,n,function(e,t){e||(s=s.concat(t));var i=o.getCursorPosition(),n=a.getLine(i.row);r(null,{prefix:c.retrievePrecedingIdentifier(n,i.column,t[0]&&t[0].identifierRegex),matches:s,finished:0==--l})})}),!0},this.showPopup=function(e){this.editor&&this.detach(),this.activated=!0,(this.editor=e).completer!=this&&(e.completer&&e.completer.detach(),e.completer=this),e.keyBinding.addKeyboardHandler(this.keyboardHandler),e.on("changeSelection",this.changeListener),e.on("blur",this.blurListener),e.on("mousedown",this.mousedownListener),e.on("mousewheel",this.mousewheelListener),this.updateCompletions()},this.updateCompletions=function(a){if(a&&this.base&&this.completions){var e=this.editor.getCursorPosition(),t=this.editor.session.getTextRange({start:this.base,end:e});if(t==this.completions.filterText)return;return this.completions.setFilter(t),this.completions.filtered.length?1!=this.completions.filtered.length||this.completions.filtered[0].value!=t||this.completions.filtered[0].snippet?void this.openPopup(this.editor,t,a):this.detach():this.detach()}var s=this.gatherCompletionsId;this.gatherCompletions(this.editor,function(e,t){var i=function(){if(t.finished)return this.detach()}.bind(this),n=t.prefix,o=t&&t.matches;if(!o||!o.length)return i();if(0===n.indexOf(t.prefix)&&s==this.gatherCompletionsId){this.completions=new u(o),this.exactMatch&&(this.completions.exactMatch=!0),this.completions.setFilter(n);var r=this.completions.filtered;return r.length&&(1!=r.length||r[0].value!=n||r[0].snippet)?this.autoInsert&&1==r.length&&t.finished?this.insertMatch(r[0]):void this.openPopup(this.editor,n,a):i()}}.bind(this))},this.cancelContextMenu=function(){this.editor.$mouseHandler.cancelContextMenu()},this.updateDocTooltip=function(){var e=this.popup,t=e.data,i=t&&(t[e.getHoveredRow()]||t[e.getRow()]),n=null;return i&&this.editor&&this.popup.isOpen?(this.editor.completers.some(function(e){return e.getDocTooltip&&(n=e.getDocTooltip(i)),n}),"string"==typeof(n=n||i)&&(n={docText:n}),n&&(n.docHTML||n.docText)?void this.showDocTooltip(n):this.hideDocTooltip()):this.hideDocTooltip()},this.showDocTooltip=function(e){this.tooltipNode||(this.tooltipNode=s.createElement("div"),this.tooltipNode.className="ace_tooltip ace_doc-tooltip",this.tooltipNode.style.margin=0,this.tooltipNode.style.pointerEvents="auto",this.tooltipNode.tabIndex=-1,this.tooltipNode.onblur=this.blurListener.bind(this));var t=this.tooltipNode;e.docHTML?t.innerHTML=e.docHTML:e.docText&&(t.textContent=e.docText),t.parentNode||document.body.appendChild(t);var i=this.popup,n=i.container.getBoundingClientRect();t.style.top=i.container.style.top,t.style.bottom=i.container.style.bottom,window.innerWidth-n.right<320?(t.style.right=window.innerWidth-n.left+"px",t.style.left=""):(t.style.left=n.right+1+"px",t.style.right=""),t.style.display="block"},this.hideDocTooltip=function(){if(this.tooltipTimer.cancel(),this.tooltipNode){var e=this.tooltipNode;this.editor.isFocused()||document.activeElement!=e||this.editor.focus(),this.tooltipNode=null,e.parentNode&&e.parentNode.removeChild(e)}}}).call(n.prototype),n.startCommand={name:"startAutocomplete",exec:function(e){e.completer||(e.completer=new n),e.completer.autoInsert=e.completer.autoSelect=!0,e.completer.showPopup(e),e.completer.cancelContextMenu()},bindKey:"Ctrl-Space|Ctrl-Shift-Space|Alt-Space"};var u=function(e,t,i){this.all=e,this.filtered=e,this.filterText=t||"",this.exactMatch=!1};(function(){this.setFilter=function(e){if(e.length>this.filterText&&0===e.lastIndexOf(this.filterText,0))var t=this.filtered;else t=this.all;this.filterText=e,t=(t=this.filterCompletions(t,this.filterText)).sort(function(e,t){return t.exactMatch-e.exactMatch||t.score-e.score});var i=null;t=t.filter(function(e){var t=e.snippet||e.caption||e.value;return t!==i&&(i=t,!0)}),this.filtered=t},this.filterCompletions=function(e,t){var i=[],n=t.toUpperCase(),o=t.toLowerCase();e:for(var r,a=0;r=e[a];a++){var s=r.value||r.caption||r.snippet;if(s){var l,c,u=-1,d=0,h=0;if(this.exactMatch){if(t!==s.substr(0,t.length))continue e}else for(var p=0;p<t.length;p++){var f=s.indexOf(o[p],u+1),g=s.indexOf(n[p],u+1);if((l=0<=f&&(g<0||f<g)?f:g)<0)continue e;0<(c=l-u-1)&&(-1===u&&(h+=10),h+=c),d|=1<<l,u=l}r.matchMask=d,r.exactMatch=h?0:1,r.score=(r.score||0)-h,i.push(r)}}return i}}).call(u.prototype),t.Autocomplete=n,t.FilteredList=u}),ace.define("ace/autocomplete/text_completer",["require","exports","module","ace/range"],function(e,t,i){var n=e("../range").Range,l=/[^a-zA-Z_0-9\$\-\u00C0-\u1FFF\u2C00-\uD7FF\w]+/;function a(e,t){var o=function(e,t){return e.getTextRange(n.fromPoints({row:0,column:0},t)).split(l).length-1}(e,t),r=e.getValue().split(l),a=Object.create(null),s=r[o];return r.forEach(function(e,t){if(e&&e!==s){var i=Math.abs(o-t),n=r.length-i;a[e]?a[e]=Math.max(n,a[e]):a[e]=n}}),a}t.getCompletions=function(e,t,i,n,o){var r=a(t,i);o(null,Object.keys(r).map(function(e){return{caption:e,value:e,score:r[e],meta:"local"}}))}}),ace.define("ace/ext/language_tools",["require","exports","module","ace/snippets","ace/autocomplete","ace/config","ace/lib/lang","ace/autocomplete/util","ace/autocomplete/text_completer","ace/editor","ace/config"],function(e,t,i){"use strict";var s=e("../snippets").snippetManager,n=e("../autocomplete").Autocomplete,o=e("../config"),r=e("../lib/lang"),a=e("../autocomplete/util"),l=e("../autocomplete/text_completer"),c={getCompletions:function(e,t,i,n,o){if(t.$mode.completer)return t.$mode.completer.getCompletions(e,t,i,n,o);var r=e.session.getState(i.row);o(null,t.$mode.getCompletions(r,t,i,n))}},u={getCompletions:function(e,t,i,n,o){var r=s.snippetMap,a=[];s.getActiveScopes(e).forEach(function(e){for(var t=r[e]||[],i=t.length;i--;){var n=t[i],o=n.name||n.tabTrigger;o&&a.push({caption:o,snippet:n.content,meta:n.tabTrigger&&!n.name?n.tabTrigger+"‚á• ":"snippet",type:"snippet"})}},this),o(null,a)},getDocTooltip:function(e){"snippet"!=e.type||e.docHTML||(e.docHTML=["<b>",r.escapeHTML(e.caption),"</b>","<hr></hr>",r.escapeHTML(e.snippet)].join(""))}},d=[u,l,c];t.setCompleters=function(e){d=e||[]},t.addCompleter=function(e){d.push(e)},t.textCompleter=l,t.keyWordCompleter=c,t.snippetCompleter=u;function h(e,t){f(t.session.$mode)}var p={name:"expandSnippet",exec:function(e){return s.expandWithTab(e)},bindKey:"Tab"},f=function(e){var t=e.$id;s.files||(s.files={}),g(t),e.modes&&e.modes.forEach(f)},g=function(t){if(t&&!s.files[t]){var e=t.replace("mode","snippets");s.files[t]={},o.loadModule(e,function(e){e&&(!(s.files[t]=e).snippets&&e.snippetText&&(e.snippets=s.parseSnippetFile(e.snippetText)),s.register(e.snippets||[],e.scope),e.includeScopes&&(s.snippetMap[e.scope].includeScopes=e.includeScopes,e.includeScopes.forEach(function(e){g("ace/mode/"+e)})))})}};function m(e){var t=e.getCursorPosition(),i=e.session.getLine(t.row),n=a.retrievePrecedingIdentifier(i,t.column);return e.completers.forEach(function(e){e.identifierRegexps&&e.identifierRegexps.forEach(function(e){!n&&e&&(n=a.retrievePrecedingIdentifier(i,t.column,e))})}),n}function v(e){var t=e.editor,i=(e.args,t.completer&&t.completer.activated);if("backspace"===e.command.name)i&&!m(t)&&t.completer.detach();else if("insertstring"===e.command.name){m(t)&&!i&&(t.completer||(t.completer=new n),t.completer.autoSelect=!1,t.completer.autoInsert=!1,t.completer.showPopup(t))}}var y=e("../editor").Editor;e("../config").defineOptions(y.prototype,"editor",{enableBasicAutocompletion:{set:function(e){e?(this.completers||(this.completers=Array.isArray(e)?e:d),this.commands.addCommand(n.startCommand)):this.commands.removeCommand(n.startCommand)},value:!1},enableLiveAutocompletion:{set:function(e){e?(this.completers||(this.completers=Array.isArray(e)?e:d),this.commands.on("afterExec",v)):this.commands.removeListener("afterExec",v)},value:!1},enableSnippets:{set:function(e){e?(this.commands.addCommand(p),this.on("changeMode",h),h(0,this)):(this.commands.removeCommand(p),this.off("changeMode",h))},value:!1}})}),ace.require(["ace/ext/language_tools"],function(){}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(oe){"use strict";function re(e){return"string"==typeof e?parseInt(e,10):~~e}var ae={wheelSpeed:1,wheelPropagation:!1,minScrollbarLength:null,maxScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0,includePadding:!1},se=0;oe.fn.perfectScrollbar=function(ie,ne){return this.each(function(){var r,a,s,l,o=oe.extend(!0,{},ae),h=oe(this),p=function(){return!!h};if("object"==typeof ie?oe.extend(!0,o,ie):ne=ie,"update"===ne)return h.data("perfect-scrollbar-update")&&h.data("perfect-scrollbar-update")(),h;if("destroy"===ne)return h.data("perfect-scrollbar-destroy")&&h.data("perfect-scrollbar-destroy")(),h;if(h.data("perfect-scrollbar"))return h.data("perfect-scrollbar");h.addClass("ps-container");var c,u,d,f,g,m,i="rtl"===h.css("direction"),e=function(){var i=se++;return function(e){var t=".perfect-scrollbar-"+i;return void 0===e?t:e+t}}(),v=this.ownerDocument||document,y=oe("<div class='ps-scrollbar-x-rail'>").appendTo(h),b=oe("<div class='ps-scrollbar-x'>").appendTo(y),n=re(y.css("bottom")),w=n==n,C=w?null:re(y.css("top")),_=re(y.css("borderLeftWidth"))+re(y.css("borderRightWidth")),A=oe("<div class='ps-scrollbar-y-rail'>").appendTo(h),E=oe("<div class='ps-scrollbar-y'>").appendTo(A),x=re(A.css("right")),S=x==x,T=S?null:re(A.css("left")),D=re(A.css("borderTopWidth"))+re(A.css("borderBottomWidth"));function t(e){return o.minScrollbarLength&&(e=Math.max(e,o.minScrollbarLength)),o.maxScrollbarLength&&(e=Math.min(e,o.maxScrollbarLength)),e}function k(){h.removeClass("ps-active-x"),h.removeClass("ps-active-y"),r=o.includePadding?h.innerWidth():h.width(),a=o.includePadding?h.innerHeight():h.height(),s=h.prop("scrollWidth"),l=h.prop("scrollHeight"),!o.suppressScrollX&&r+o.scrollXMarginOffset<s?(c=!0,u=t(re(r*r/s)),d=re(h.scrollLeft()*(r-u)/(s-r))):(c=!1,d=u=0,h.scrollLeft(0)),!o.suppressScrollY&&a+o.scrollYMarginOffset<l?(f=!0,g=t(re(a*a/l)),m=re(h.scrollTop()*(a-g)/(l-a))):(f=!1,m=g=0,h.scrollTop(0)),r-u<=d&&(d=r-u),a-g<=m&&(m=a-g),function(){var e={width:r};e.left=i?h.scrollLeft()+r-s:h.scrollLeft(),w?e.bottom=n-h.scrollTop():e.top=C+h.scrollTop(),y.css(e);var t={top:h.scrollTop(),height:a};S?t.right=i?s-h.scrollLeft()-x-E.outerWidth():x-h.scrollLeft():t.left=i?h.scrollLeft()+2*r-s-T-E.outerWidth():T+h.scrollLeft(),A.css(t),b.css({left:d,width:u-_}),E.css({top:m,height:g-D})}(),c&&h.addClass("ps-active-x"),f&&h.addClass("ps-active-y")}function R(){var t,i,n=!1;b.bind(e("mousedown"),function(e){i=e.pageX,t=b.position().left,y.addClass("in-scrolling"),n=!0,e.stopPropagation(),e.preventDefault()}),oe(v).bind(e("mousemove"),function(e){n&&(function(e,t){var i=e+t,n=r-u,o=re((d=i<0?0:n<i?n:i)*(s-r)/(r-u));h.scrollLeft(o)}(t,e.pageX-i),k(),e.stopPropagation(),e.preventDefault())}),oe(v).bind(e("mouseup"),function(e){n&&(n=!1,y.removeClass("in-scrolling"))}),t=i=null}function O(){var t,i,n=!1;E.bind(e("mousedown"),function(e){i=e.pageY,t=E.position().top,n=!0,A.addClass("in-scrolling"),e.stopPropagation(),e.preventDefault()}),oe(v).bind(e("mousemove"),function(e){n&&(function(e,t){var i=e+t,n=a-g,o=re((m=i<0?0:n<i?n:i)*(l-a)/(a-g));h.scrollTop(o)}(t,e.pageY-i),k(),e.stopPropagation(),e.preventDefault())}),oe(v).bind(e("mouseup"),function(e){n&&(n=!1,A.removeClass("in-scrolling"))}),t=i=null}function N(e,t){var i=h.scrollTop();if(0===e){if(!f)return!1;if(0===i&&0<t||l-a<=i&&t<0)return!o.wheelPropagation}var n=h.scrollLeft();if(0===t){if(!c)return!1;if(0===n&&e<0||s-r<=n&&0<e)return!o.wheelPropagation}return!0}function F(){var l=null,c={top:0,left:0};function u(){l&&(clearInterval(l),l=null),y.removeClass("in-scrolling"),A.removeClass("in-scrolling")}var d=!1;oe(v).bind(e("selectionchange"),function(e){oe.contains(h[0],function(){var e=window.getSelection?window.getSelection():document.getSlection?document.getSlection():{rangeCount:0};return 0===e.rangeCount?null:e.getRangeAt(0).commonAncestorContainer}())?d=!0:(d=!1,u())}),oe(window).bind(e("mouseup"),function(e){d&&(d=!1,u())}),oe(window).bind(e("mousemove"),function(e){if(d){var t=e.pageX,i=e.pageY,n=h.offset(),o=n.left,r=n.left+h.outerWidth(),a=n.top,s=n.top+h.outerHeight();t<o+3?(c.left=-5,y.addClass("in-scrolling")):r-3<t?(c.left=5,y.addClass("in-scrolling")):c.left=0,i<a+3?(c.top=a+3-i<5?-5:-20,A.addClass("in-scrolling")):s-3<i?(c.top=i-s+3<5?5:20,A.addClass("in-scrolling")):c.top=0,0===c.top&&0===c.left?u():l=l||setInterval(function(){p()?(h.scrollTop(h.scrollTop()+c.top),h.scrollLeft(h.scrollLeft()+c.left),k()):clearInterval(l)},50)}})}function M(){h.unbind(e()),oe(window).unbind(e()),oe(v).unbind(e()),h.data("perfect-scrollbar",null),h.data("perfect-scrollbar-update",null),h.data("perfect-scrollbar-destroy",null),b.remove(),E.remove(),y.remove(),A.remove(),h=y=A=b=E=c=f=r=a=s=l=u=d=n=w=C=g=m=x=S=T=i=e=null}var P,I,L,G,$,B,j,W,H,z="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,V=null!==window.navigator.msMaxTouchPoints;function U(e,t){h.scrollTop(h.scrollTop()-t),h.scrollLeft(h.scrollLeft()-e),k()}function Y(e){j=!0}function q(e){j=!1}function Q(e){return e.originalEvent.targetTouches?e.originalEvent.targetTouches[0]:e.originalEvent}function K(e){var t=e.originalEvent;return!(!t.targetTouches||1!==t.targetTouches.length)||!(!t.pointerType||"mouse"===t.pointerType||t.pointerType===t.MSPOINTER_TYPE_MOUSE)}function X(e){if(K(e)){W=!0;var t=Q(e);L.pageX=t.pageX,L.pageY=t.pageY,G=(new Date).getTime(),null!==B&&clearInterval(B),e.stopPropagation()}}function J(e){if(!j&&W&&K(e)){var t=Q(e),i={pageX:t.pageX,pageY:t.pageY},n=i.pageX-L.pageX,o=i.pageY-L.pageY;U(n,o),L=i;var r=(new Date).getTime(),a=r-G;0<a&&($.x=n/a,$.y=o/a,G=r),e.stopPropagation(),e.preventDefault()}}function Z(e){!j&&W&&(W=!1,clearInterval(B),B=setInterval(function(){p()?Math.abs($.x)<.01&&Math.abs($.y)<.01?clearInterval(B):(U(30*$.x,30*$.y),$.x*=.8,$.y*=.8):clearInterval(B)},10))}function ee(e){var t=function(e){var t=e.originalEvent.deltaX,i=-1*e.originalEvent.deltaY;return void 0!==t&&void 0!==i||(t=-1*e.originalEvent.wheelDeltaX/6,i=e.originalEvent.wheelDeltaY/6),e.originalEvent.deltaMode&&1===e.originalEvent.deltaMode&&(t*=10,i*=10),t!=t&&i!=i&&(t=0,i=e.originalEvent.wheelDelta),[t,i]}(e),i=t[0],n=t[1];H=!1,o.useBothWheelAxes?f&&!c?(n?h.scrollTop(h.scrollTop()-n*o.wheelSpeed):h.scrollTop(h.scrollTop()+i*o.wheelSpeed),H=!0):c&&!f&&(i?h.scrollLeft(h.scrollLeft()+i*o.wheelSpeed):h.scrollLeft(h.scrollLeft()-n*o.wheelSpeed),H=!0):(h.scrollTop(h.scrollTop()-n*o.wheelSpeed),h.scrollLeft(h.scrollLeft()+i*o.wheelSpeed)),k(),(H=H||N(i,n))&&(e.stopPropagation(),e.preventDefault())}function te(e){e.stopPropagation()}return k(),h.bind(e("scroll"),function(e){k()}),R(),O(),E.bind(e("click"),te),A.bind(e("click"),function(e){var t=re(g/2),i=(e.pageY-A.offset().top-t)/(a-g);i<0?i=0:1<i&&(i=1),h.scrollTop((l-a)*i)}),b.bind(e("click"),te),y.bind(e("click"),function(e){var t=re(u/2),i=(e.pageX-y.offset().left-t)/(r-u);i<0?i=0:1<i&&(i=1),h.scrollLeft((s-r)*i)}),F(),H=!1,void 0!==window.onwheel?h.bind(e("wheel"),ee):void 0!==window.onmousewheel&&h.bind(e("mousewheel"),ee),(z||V)&&(I=V,L={},G=0,B=null,W=j=!($={}),z&&(oe(window).bind(e("touchstart"),Y),oe(window).bind(e("touchend"),q),h.bind(e("touchstart"),X),h.bind(e("touchmove"),J),h.bind(e("touchend"),Z)),I&&(window.PointerEvent?(oe(window).bind(e("pointerdown"),Y),oe(window).bind(e("pointerup"),q),h.bind(e("pointerdown"),X),h.bind(e("pointermove"),J),h.bind(e("pointerup"),Z)):window.MSPointerEvent&&(oe(window).bind(e("MSPointerDown"),Y),oe(window).bind(e("MSPointerUp"),q),h.bind(e("MSPointerDown"),X),h.bind(e("MSPointerMove"),J),h.bind(e("MSPointerUp"),Z)))),o.useKeyboard&&(P=!1,h.bind(e("mouseenter"),function(e){P=!0}),h.bind(e("mouseleave"),function(e){P=!1}),oe(v).bind(e("keydown"),function(e){if((!e.isDefaultPrevented||!e.isDefaultPrevented())&&P){for(var t=document.activeElement?document.activeElement:v.activeElement;t.shadowRoot;)t=t.shadowRoot.activeElement;if(!oe(t).is(":input,[contenteditable]")){var i=0,n=0;switch(e.which){case 37:i=-30;break;case 38:n=30;break;case 39:i=30;break;case 40:n=-30;break;case 33:n=90;break;case 32:case 34:n=-90;break;case 35:n=e.ctrlKey?-l:-a;break;case 36:n=e.ctrlKey?h.scrollTop():a;break;default:return}h.scrollTop(h.scrollTop()-n),h.scrollLeft(h.scrollLeft()+i),N(i,n)&&e.preventDefault()}}})),h.data("perfect-scrollbar",h),h.data("perfect-scrollbar-update",k),h.data("perfect-scrollbar-destroy",M),h})}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(c){var u,d,e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],t="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],h=Array.prototype.slice;if(c.event.fixHooks)for(var i=e.length;i;)c.event.fixHooks[e[--i]]=c.event.mouseHooks;var n=c.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener)for(var e=t.length;e;)this.addEventListener(t[--e],o,!1);else this.onmousewheel=o;c.data(this,"mousewheel-line-height",n.getLineHeight(this)),c.data(this,"mousewheel-page-height",n.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=t.length;e;)this.removeEventListener(t[--e],o,!1);else this.onmousewheel=null},getLineHeight:function(e){return parseInt(c(e)["offsetParent"in c.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(e){return c(e).height()},settings:{adjustOldDeltas:!0}};function o(e){var t,i=e||window.event,n=h.call(arguments,1),o=0,r=0,a=0;if((e=c.event.fix(i)).type="mousewheel","detail"in i&&(a=-1*i.detail),"wheelDelta"in i&&(a=i.wheelDelta),"wheelDeltaY"in i&&(a=i.wheelDeltaY),"wheelDeltaX"in i&&(r=-1*i.wheelDeltaX),"axis"in i&&i.axis===i.HORIZONTAL_AXIS&&(r=-1*a,a=0),o=0===a?r:a,"deltaY"in i&&(o=a=-1*i.deltaY),"deltaX"in i&&(r=i.deltaX,0===a&&(o=-1*r)),0!==a||0!==r){if(1===i.deltaMode){var s=c.data(this,"mousewheel-line-height");o*=s,a*=s,r*=s}else if(2===i.deltaMode){var l=c.data(this,"mousewheel-page-height");o*=l,a*=l,r*=l}return t=Math.max(Math.abs(a),Math.abs(r)),(!d||t<d)&&f(i,d=t)&&(d/=40),f(i,t)&&(o/=40,r/=40,a/=40),o=Math[1<=o?"floor":"ceil"](o/d),r=Math[1<=r?"floor":"ceil"](r/d),a=Math[1<=a?"floor":"ceil"](a/d),e.deltaX=r,e.deltaY=a,e.deltaFactor=d,e.deltaMode=0,n.unshift(e,o,r,a),u&&clearTimeout(u),u=setTimeout(p,200),(c.event.dispatch||c.event.handle).apply(this,n)}}function p(){d=null}function f(e,t){return n.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}c.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),jQuery.fn.doubleScroll=function(e){var n={contentElement:void 0,scrollCss:{"overflow-x":"auto","overflow-y":"hidden"},contentCss:{"overflow-x":"auto","overflow-y":"hidden"},onlyIfScroll:!0,resetOnWindowResize:!1,timeToWaitForResize:30};$.extend(!0,n,e),$.extend(n,{topScrollBarMarkup:'<div class="doubleScroll-scroll-wrapper" style="height: 20px;"><div class="doubleScroll-scroll" style="height: 20px;"></div></div>',topScrollBarWrapperSelector:".doubleScroll-scroll-wrapper",topScrollBarInnerSelector:".doubleScroll-scroll"});function o(e,t){if(t.onlyIfScroll&&e.get(0).scrollWidth<=e.width())e.prev(t.topScrollBarWrapperSelector).remove();else{var i,n=e.prev(t.topScrollBarWrapperSelector);if(0==n.length){n=$(t.topScrollBarMarkup),e.before(n),n.css(t.scrollCss),e.css(t.contentCss),n.bind("scroll.doubleScroll",function(){e.scrollLeft(n.scrollLeft())});e.bind("scroll.doubleScroll",function(){n.scrollLeft(e.scrollLeft())})}i=void 0!==t.contentElement&&0!==e.find(t.contentElement).length?e.find(t.contentElement):e.find(">:first-child"),$(t.topScrollBarInnerSelector,n).width(i.outerWidth()),n.width(e.width()),n.scrollLeft(e.scrollLeft())}}return this.each(function(){var t=$(this);if(o(t,n),n.resetOnWindowResize){function e(e){o(t,n)}var i;$(window).bind("resize.doubleScroll",function(){clearTimeout(i),i=setTimeout(e,n.timeToWaitForResize)})}})},function(){"use strict";var t,r=0,l=!0,c="message".length,u="[iFrameSizer]",d=u.length,h="",p=null,n=window.requestAnimationFrame,a={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},f={},o={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,enablePublicMethods:!1,heightCalculationMethod:"offset",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,scrolling:!1,sizeHeight:!0,sizeWidth:!1,tolerance:0,closedCallback:function(){},initCallback:function(){},messageCallback:function(){},resizedCallback:function(){}};function s(e,t,i){"addEventListener"in window?e.addEventListener(t,i,!1):"attachEvent"in window&&e.attachEvent("on"+t,i)}function g(e){f.log&&"object"==typeof console&&console.log(u+"[Host page"+h+"]"+e)}function m(){null===p&&g(" Get position: "+(p={x:void 0!==window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop}).x+","+p.y)}function v(){null!==p&&(window.scrollTo(p.x,p.y),g(" Set position: "+p.x+","+p.y),p=null)}function y(e){g(" Size reset requested by "+("init"===e.type?"host page":"iFrame")),m(),w(function(){b(e),C("reset","reset",e.iframe)},e,"init")}function b(t){function e(e){t.iframe.style[e]=t[e]+"px",g(" IFrame ("+t.iframe.id+") "+e+" set to "+t[e]+"px")}f.sizeHeight&&e("height"),f.sizeWidth&&e("width")}function w(e,t,i){i!==t.type&&n?(g(" Requesting animation frame"),n(e)):e()}function C(e,t,i){g("["+e+"] Sending msg to iframe ("+t+")"),i.contentWindow.postMessage(u+t,"*")}function _(){var e,t,i=this,n=(""===(e=i.id)&&(i.id=e="iFrameResizer"+r++,g(" Added missing iframe ID: "+e+" ("+i.src+")")),e);function o(e){1/0!==f[e]&&0!==f[e]&&(i.style[e]=f[e]+"px",g(" Set "+e+" = "+f[e]+"px"))}g(" IFrame scrolling "+(f.scrolling?"enabled":"disabled")+" for "+n),i.style.overflow=!1===f.scrolling?"hidden":"auto",i.scrolling=!1===f.scrolling?"no":"yes",o("maxHeight"),o("minHeight"),o("maxWidth"),o("minWidth"),"number"!=typeof f.bodyMargin&&"0"!==f.bodyMargin||(f.bodyMarginV1=f.bodyMargin,f.bodyMargin=f.bodyMargin+"px"),t=n+":"+f.bodyMarginV1+":"+f.sizeWidth+":"+f.log+":"+f.interval+":"+f.enablePublicMethods+":"+f.autoResize+":"+f.bodyMargin+":"+f.heightCalculationMethod+":"+f.bodyBackground+":"+f.bodyPadding+":"+f.tolerance,s(i,"load",function(){var e=l;C("iFrame.onload",t,i),!e&&f.heightCalculationMethod in a&&y({iframe:i,height:0,width:0,type:"init"})}),C("init",t,i)}function A(e){if("object"!=typeof e)throw new TypeError("Options is not an object.")}function e(){function i(e){if("IFRAME"!==e.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+e.tagName+">.");_.call(e)}return function(e,t){!function(e){for(var t in A(e=e||{}),o)o.hasOwnProperty(t)&&(f[t]=e.hasOwnProperty(t)?e[t]:o[t])}(e),Array.prototype.forEach.call(document.querySelectorAll(t||"iframe"),i)}}!function(){var e,t=["moz","webkit","o","ms"];for(e=0;e<t.length&&!n;e+=1)n=window[t[e]+"RequestAnimationFrame"];n||g(" RequestAnimationFrame not supported")}(),s(window,"message",function(i){function e(){t("Height"),t("Width"),w(function(){b(s),v(),f.resizedCallback(s)},s,"resetPage")}function t(e){var t=Number(f["max"+e]),i=Number(f["min"+e]),n=e.toLowerCase(),o=Number(s[n]);if(t<i)throw new Error("Value for min"+e+" can not be greater than max"+e);g(" Checking "+n+" is in range "+i+"-"+t),o<i&&(o=i,g(" Set "+n+" to min value")),t<o&&(o=t,g(" Set "+n+" to max value")),s[n]=""+o}function n(e){var t=e?function(){var e=s.iframe.getBoundingClientRect();return m(),{x:Number(e.left)+Number(p.x),y:Number(e.top)+Number(p.y)}}():{x:0,y:0};g(" Reposition requested from iFrame (offset x:"+t.x+" y:"+t.y+")"),p={x:Number(s.width)+t.x,y:Number(s.height)+t.y},v()}var o,r,a=i.data,s={};u===(""+a).substr(0,d)&&(g(" Received: "+a),r=a.substr(d).split(":"),s={iframe:document.getElementById(r[0]),id:r[0],height:r[1],width:r[2],type:r[3]},(o=s.type in{true:1,false:1})&&g(" Ignoring init message from meta parent page"),!o&&function(){if(null===s.iframe)throw new Error("iFrame ("+s.id+") does not exist on "+h);return!0}()&&function(){var e=i.origin,t=s.iframe.src.split("/").slice(0,3).join("/");if(f.checkOrigin&&(g(" Checking connection is from: "+t),""+e!="null"&&e!==t))throw new Error("Unexpected message received from: "+e+" for "+s.iframe.id+". Message was: "+i.data+". This error can be disabled by adding the checkOrigin: false option.");return!0}()&&(function(){switch(s.type){case"close":!function(e){var t=e.id;g(" Removing iFrame: "+t),e.parentNode.removeChild(e),f.closedCallback(t),g(" --")}(s.iframe),f.resizedCallback(s);break;case"message":!function(){var e=a.substr(a.indexOf(":")+c+6);g(" MessageCallback passed: {iframe: "+s.iframe.id+", message: "+e+"}"),f.messageCallback({iframe:s.iframe,message:JSON.parse(e)}),g(" --")}();break;case"scrollTo":n(!1);break;case"scrollToOffset":n(!0);break;case"reset":y(s);break;case"init":e(),f.initCallback(s.iframe);break;default:e()}}(),l=!1))}),window.jQuery&&((t=jQuery).fn.iFrameResize=function(e){return A(e=e||{}),f=t.extend({},o,e),this.filter("iframe").each(_).end()}),"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():window.iFrameResize=e()}(),function(oe){function re(e){var t=document.createElement("input"),i="on"+e,n=i in t;return n||(t.setAttribute(i,"return;"),n="function"==typeof t[i]),t=null,n}function a(e,t,i){var n=i.aliases[e];return!!n&&(n.alias&&a(n.alias,void 0,i),oe.extend(!0,i,n),oe.extend(!0,i,t),!0)}function s(C,o){function e(e,t){if(null!=e&&""!=e){if(1==e.length&&0==C.greedy&&0!=C.repeat&&(C.placeholder=""),0<C.repeat||"*"==C.repeat||"+"==C.repeat){var i="*"==C.repeat?0:"+"==C.repeat?1:C.repeat;e=C.groupmarker.start+e+C.groupmarker.end+C.quantifiermarker.start+i+","+C.repeat+C.quantifiermarker.end}var n;return null==oe.inputmask.masksCache[e]||!0===o?(n={mask:e,maskToken:function(e){function t(e,t,i,n){this.matches=[],this.isGroup=e||!1,this.isOptional=t||!1,this.isQuantifier=i||!1,this.isAlternator=n||!1,this.quantifier={min:1,max:1}}function i(e,t,i){var n=C.definitions[t],o=0==e.matches.length;if(i=null!=i?i:e.matches.length,n&&!d){n.placeholder=oe.isFunction(n.placeholder)?n.placeholder.call(this,C):n.placeholder;for(var r=n.prevalidator,a=r?r.length:0,s=1;s<n.cardinality;s++){var l=s<=a?r[s-1]:[],c=l.validator,u=l.cardinality;e.matches.splice(i++,0,{fn:c?"string"==typeof c?new RegExp(c):new function(){this.test=c}:new RegExp("."),cardinality:u||1,optionality:e.isOptional,newBlockMarker:o,casing:n.casing,def:n.definitionSymbol||t,placeholder:n.placeholder,mask:t})}e.matches.splice(i++,0,{fn:n.validator?"string"==typeof n.validator?new RegExp(n.validator):new function(){this.test=n.validator}:new RegExp("."),cardinality:n.cardinality,optionality:e.isOptional,newBlockMarker:o,casing:n.casing,def:n.definitionSymbol||t,placeholder:n.placeholder,mask:t})}else e.matches.splice(i++,0,{fn:null,cardinality:0,optionality:e.isOptional,newBlockMarker:o,casing:null,def:t,placeholder:void 0,mask:t}),d=!1}for(var n,o,r,a,s,l,c=/(?:[?*+]|\{[0-9\+\*]+(?:,[0-9\+\*]*)?\})\??|[^.?*+^${[]()|\\]+|./g,d=!1,u=new t,h=[],p=[];n=c.exec(e);)switch(o=n[0],o.charAt(0)){case C.optionalmarker.end:case C.groupmarker.end:if(r=h.pop(),0<h.length){if((a=h[h.length-1]).matches.push(r),a.isAlternator){s=h.pop();for(var f=0;f<s.matches.length;f++)s.matches[f].isGroup=!1;0<h.length?(a=h[h.length-1]).matches.push(s):u.matches.push(s)}}else u.matches.push(r);break;case C.optionalmarker.start:h.push(new t(!1,!0));break;case C.groupmarker.start:h.push(new t(!0));break;case C.quantifiermarker.start:var g=new t(!1,!1,!0),m=(o=o.replace(/[{}]/g,"")).split(","),v=isNaN(m[0])?m[0]:parseInt(m[0]),y=1==m.length?v:isNaN(m[1])?m[1]:parseInt(m[1]);if("*"!=y&&"+"!=y||(v="*"==y?0:1),g.quantifier={min:v,max:y},0<h.length){var b=h[h.length-1].matches;if(!(n=b.pop()).isGroup)(w=new t(!0)).matches.push(n),n=w;b.push(n),b.push(g)}else{var w;if(!(n=u.matches.pop()).isGroup)(w=new t(!0)).matches.push(n),n=w;u.matches.push(n),u.matches.push(g)}break;case C.escapeChar:d=!0;break;case C.alternatormarker:(l=0<h.length?(a=h[h.length-1]).matches.pop():u.matches.pop()).isAlternator?h.push(l):((s=new t(!1,!1,!1,!0)).matches.push(l),h.push(s));break;default:if(0<h.length){if(0<(a=h[h.length-1]).matches.length&&!a.isAlternator&&((l=a.matches[a.matches.length-1]).isGroup&&(l.isGroup=!1,i(l,C.groupmarker.start,0),i(l,C.groupmarker.end))),i(a,o),a.isAlternator){s=h.pop();for(f=0;f<s.matches.length;f++)s.matches[f].isGroup=!1;0<h.length?(a=h[h.length-1]).matches.push(s):u.matches.push(s)}}else 0<u.matches.length&&((l=u.matches[u.matches.length-1]).isGroup&&(l.isGroup=!1,i(l,C.groupmarker.start,0),i(l,C.groupmarker.end))),i(u,o)}return 0<u.matches.length&&((l=u.matches[u.matches.length-1]).isGroup&&(l.isGroup=!1,i(l,C.groupmarker.start,0),i(l,C.groupmarker.end)),p.push(u)),p}(e),validPositions:{},_buffer:void 0,buffer:void 0,tests:{},metadata:t},!0!==o&&(oe.inputmask.masksCache[e]=n)):n=oe.extend(!0,{},oe.inputmask.masksCache[e]),n}}function i(e){if(e=e.toString(),C.numericInput){e=e.split("").reverse();for(var t=0;t<e.length;t++)e[t]==C.optionalmarker.start?e[t]=C.optionalmarker.end:e[t]==C.optionalmarker.end?e[t]=C.optionalmarker.start:e[t]==C.groupmarker.start?e[t]=C.groupmarker.end:e[t]==C.groupmarker.end&&(e[t]=C.groupmarker.start);e=e.join("")}return e}var t=void 0;if(oe.isFunction(C.mask)&&(C.mask=C.mask.call(this,C)),oe.isArray(C.mask)){if(1<C.mask.length){C.keepStatic=null==C.keepStatic||C.keepStatic;var n="(";return oe.each(C.mask,function(e,t){1<n.length&&(n+=")|("),n+=i(null==t.mask||oe.isFunction(t.mask)?t:t.mask)}),e(n+=")",C.mask)}C.mask=C.mask.pop()}return C.mask&&(t=null==C.mask.mask||oe.isFunction(C.mask.mask)?e(i(C.mask),C.mask):e(i(C.mask.mask),C.mask)),t}function l(e,r,w){function t(e,t,i){t=t||0;var n,o,r,a=[],s=0;do{if(!0===e&&N().validPositions[s]){var l=N().validPositions[s];o=l.match,n=l.locator.slice(),a.push(!0===i?l.input:k(s,o))}else o=(r=d(s,n,s-1)).match,n=r.locator.slice(),a.push(k(s,o));s++}while((null==V||s-1<V)&&null!=o.fn||null==o.fn&&""!=o.def||s<=t);return a.pop(),a}function N(){return r}function C(e){var t=N();t.buffer=void 0,t.tests={},!0!==e&&(t._buffer=void 0,t.validPositions={},t.p=0)}function _(e,t){var i=-1,n=N().validPositions;null==e&&(e=-1);var o=i,r=i;for(var a in n){var s=parseInt(a);n[s]&&(t||null!=n[s].match.fn)&&(s<=e&&(o=s),e<=s&&(r=s))}return-1!=o&&1<e-o||r<e?o:r}function y(e,t,i){if(w.insertMode&&null!=N().validPositions[e]&&null==i){var n,o=oe.extend(!0,{},N().validPositions),r=_();for(n=e;n<=r;n++)delete N().validPositions[n];N().validPositions[e]=t;var a,s=!0,l=N().validPositions;for(n=a=e;n<=r;n++){var c=o[n];if(null!=c)for(var u=a;u<v()&&(null==c.match.fn&&l[n]&&(!0===l[n].match.optionalQuantifier||!0===l[n].match.optionality)||null!=c.match.fn);){if(null==c.match.fn||!w.keepStatic&&l[n]&&(null!=l[n+1]&&1<b(n+1,l[n].locator.slice(),n).length||null!=l[n].alternation)?u++:u=S(a),h(u,c.match.def)){s=!1!==x(u,c.input,!0,!0),a=u;break}s=null==c.match.fn}if(!s)break}if(!s)return N().validPositions=oe.extend(!0,{},o),!1}else N().validPositions[e]=t;return!0}function m(e,t,i,n){var o,r=e;for(N().p=e,null!=N().validPositions[e]&&N().validPositions[e].input==w.radixPoint&&(t++,r++),o=r;o<t;o++)null==N().validPositions[o]||!0!==i&&0==w.canClearPosition(N(),o,_(),n,w)||delete N().validPositions[o];for(C(!0),o=r+1;o<=_();){for(;null!=N().validPositions[r];)r++;var a=N().validPositions[r];o<r&&(o=r+1);var s=N().validPositions[o];null!=s&&null==a?(h(r,s.match.def)&&!1!==x(r,s.input,!0)&&(delete N().validPositions[o],o++),r++):o++}var l=_(),c=v();for(e<=l&&null!=N().validPositions[l]&&N().validPositions[l].input==w.radixPoint&&delete N().validPositions[l],o=l+1;o<=c;o++)N().validPositions[o]&&delete N().validPositions[o];C(!0)}function d(e,t,i){var n=N().validPositions[e];if(null==n)for(var o=b(e,t,i),r=_(),a=N().validPositions[r]||b(0,void 0,void 0)[0],s=null!=a.alternation?a.locator[a.alternation].toString().split(","):[],l=0;l<o.length&&!((n=o[l]).match&&(w.greedy&&!0!==n.match.optionalQuantifier||(!1===n.match.optionality||!1===n.match.newBlockMarker)&&!0!==n.match.optionalQuantifier)&&(null==a.alternation||null!=n.locator[a.alternation]&&f(n.locator[a.alternation].toString().split(","),s)));l++);return n}function s(e){return N().validPositions[e]?N().validPositions[e].match:b(e)[0].match}function h(e,t){for(var i=!1,n=b(e),o=0;o<n.length;o++)if(n[o].match&&n[o].match.def==t){i=!0;break}return i}function b(T,e,t){function D(A,E,e,t){function x(e,t,i){if(1e4<k)return alert("jquery.inputmask: There is probably an error in your mask definition or in the code. Create an issue on github with an example of the mask you are using. "+N().mask),!0;if(k==T&&null==e.matches)return R.push({match:e,locator:t.reverse()}),!0;if(null!=e.matches){if(e.isGroup&&!0!==i){if(e=x(A.matches[S+1],t))return!0}else if(e.isOptional){var n=e;if(e=D(e,E,t,i)){var o=R[R.length-1].match;if(!(0==oe.inArray(o,n.matches)))return!0;O=!0,k=T}}else if(e.isAlternator){var r,a=e,s=[],l=R.slice(),c=t.length,u=0<E.length?E.shift():-1;if(-1==u||"string"==typeof u){var d,h=k,p=E.slice();"string"==typeof u&&(d=u.split(","));for(var f=0;f<a.matches.length;f++){R=[],e=x(a.matches[f],[f].concat(t),i)||e,r=R.slice(),k=h,R=[];for(var g=0;g<p.length;g++)E[g]=p[g];for(var m=0;m<r.length;m++){var v=r[m];v.alternation=c;for(var y=0;y<s.length;y++){var b=s[y];if(v.match.mask==b.match.mask&&("string"!=typeof u||-1!=oe.inArray(v.locator[c].toString(),d))){r.splice(m,1),b.locator[c]=b.locator[c]+","+v.locator[c],b.alternation=c;break}}}s=s.concat(r)}"string"==typeof u&&(s=oe.map(s,function(e,t){if(isFinite(t)){var i=e.locator[c].toString().split(",");e.locator[c]=void 0,e.alternation=void 0;for(var n=0;n<i.length;n++)-1!=oe.inArray(i[n],d)&&(null!=e.locator[c]?(e.locator[c]+=",",e.locator[c]+=i[n]):e.locator[c]=parseInt(i[n]),e.alternation=c);if(null!=e.locator[c])return e}})),R=l.concat(s),k=T,O=!0}else e=x(a.matches[u],[u].concat(t),i);if(e)return!0}else if(e.isQuantifier&&!0!==i)for(var w=e,C=0<E.length&&!0!==i?E.shift():0;C<(isNaN(w.quantifier.max)?C+1:w.quantifier.max)&&k<=T;C++){var _=A.matches[oe.inArray(w,A.matches)-1];if(e=x(_,[C].concat(t),!0)){if((o=R[R.length-1].match).optionalQuantifier=C>w.quantifier.min-1,0==oe.inArray(o,_.matches)){if(C>w.quantifier.min-1){O=!0,k=T;break}return!0}return!0}}else if(e=D(e,E,t,i))return!0}else k++}for(var S=0<E.length?E.shift():0;S<A.matches.length;S++)if(!0!==A.matches[S].isQuantifier){var i=x(A.matches[S],[S].concat(e),t);if(i&&k==T)return i;if(T<k)break}}var i=N().maskToken,k=e?t:0,n=e||[0],R=[],O=!1;if(null==e){for(var o,r=T-1;null==(o=N().validPositions[r])&&-1<r;)r--;if(null!=o&&-1<r)k=r,n=o.locator.slice();else{for(r=T-1;null==(o=N().tests[r])&&-1<r;)r--;null!=o&&-1<r&&(k=r,n=o[0].locator.slice())}}for(var a=n.shift();a<i.length;a++){if(D(i[a],n,[a])&&k==T||T<k)break}return 0!=R.length&&!O||R.push({match:{fn:null,cardinality:0,optionality:!0,casing:null,def:""},locator:[]}),N().tests[T]=oe.extend(!0,[],R),N().tests[T]}function p(){return null==N()._buffer&&(N()._buffer=t(!1,1)),N()._buffer}function A(){return null==N().buffer&&(N().buffer=t(!0,_(),!0)),N().buffer}function E(e,t,i){if(i=i||A().slice(),!0===e)C(),e=0,t=i.length;else for(var n=e;n<t;n++)delete N().validPositions[n],delete N().tests[n];for(n=e;n<t;n++)i[n]!=w.skipOptionalPartCharacter&&x(n,i[n],!0,!0)}function f(e,t){for(var i=w.greedy?t:t.slice(0,1),n=!1,o=0;o<e.length;o++)if(-1!=oe.inArray(e[o],i)){n=!0;break}return n}function x(e,t,i,n){function o(d,h,p,f){var g=!1;return oe.each(b(d),function(e,t){for(var i=t.match,n=h?1:0,o="",r=(A(),i.cardinality);n<r;r--)o+=(a=d-(r-1),null==N().validPositions[a]?k(a):N().validPositions[a].input);var a;if(h&&(o+=h),!1!==(g=null!=i.fn?i.fn.test(o,N(),d,p,w):(h==i.def||h==w.skipOptionalPartCharacter)&&""!=i.def&&{c:i.def,pos:d})){var s=null!=g.c?g.c:h;s=s==w.skipOptionalPartCharacter&&null===i.fn?i.def:s;var l=d,c=A();if(null!=g.remove&&(oe.isArray(g.remove)||(g.remove=[g.remove]),oe.each(g.remove.sort(function(e,t){return t-e}),function(e,t){m(t,t+1,!0)})),null!=g.insert&&(oe.isArray(g.insert)||(g.insert=[g.insert]),oe.each(g.insert.sort(function(e,t){return e-t}),function(e,t){x(t.pos,t.c,!0)})),g.refreshFromBuffer){var u=g.refreshFromBuffer;if(E((p=!0)===u?u:u.start,u.end,c),null==g.pos&&null==g.c)return g.pos=_(),!1;if((l=null!=g.pos?g.pos:d)!=d)return g=oe.extend(g,x(l,s,!0)),!1}else if(!0!==g&&null!=g.pos&&g.pos!=d&&(l=g.pos,E(d,l),l!=d))return g=oe.extend(g,x(l,s,!0)),!1;return 1!=g&&null==g.pos&&null==g.c||(0<e&&C(!0),y(l,oe.extend({},t,{input:function(e,t){switch(t.casing){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e}(s,i)}),f)||(g=!1)),!1}}),g}function r(e,t){for(var n=N().validPositions[t].locator,o=n.length,i=e;i<t;i++)if(!g(i)){var r=b(i),a=r[0],s=-1;oe.each(r,function(e,t){for(var i=0;i<o;i++)t.locator[i]&&f(t.locator[i].toString().split(","),n[i].toString().split(","))&&s<i&&(s=i,a=t)}),y(i,oe.extend({},a,{input:a.match.def}),!0)}}i=!0===i;for(var a=A(),s=e-1;-1<s&&!N().validPositions[s];s--);for(s++;s<e;s++)null==N().validPositions[s]&&((!g(s)||a[s]!=k(s))&&1<b(s).length||a[s]==w.radixPoint||"0"==a[s]&&oe.inArray(w.radixPoint,a)<s)&&o(s,a[s],!0);var l=e,c=!1,u=oe.extend(!0,{},N().validPositions);if(l<v()&&(c=o(l,t,i,n),(!i||n)&&!1===c)){var d=N().validPositions[l];if(!d||null!=d.match.fn||d.match.def!=t&&t!=w.skipOptionalPartCharacter){if((w.insertMode||null==N().validPositions[S(l)])&&!g(l))for(var h=l+1,p=S(l);h<=p;h++)if(!1!==(c=o(h,t,i,n))){r(l,h),l=h;break}}else c={caret:S(l)}}if((!1===c&&w.keepStatic&&O(a)&&(c=function(e,t,i,n){var o,r,a,s,l=oe.extend(!0,{},N().validPositions);for(o=_();0<=o;o--)if((s=N().validPositions[o])&&null!=s.alternation&&1<s.locator[s.alternation].length){r=N().validPositions[o].alternation;break}if(null!=r)for(var c in N().validPositions)if(s=N().validPositions[c],parseInt(c)>parseInt(o)&&s.alternation){for(var u=s.locator[r],d=N().validPositions[o].locator[r].toString().split(","),h=0;h<d.length;h++)if(u<d[h]){for(var p,f,g=c-1;0<=g;g--)if(null!=(p=N().validPositions[g])){f=p.locator[r],p.locator[r]=parseInt(d[h]);break}if(u!=p.locator[r]){for(var m=[],v=c;v<_()+1;v++){var y=N().validPositions[v];y&&null!=y.match.fn&&m.push(y.input),delete N().validPositions[v],delete N().tests[v]}for(C(!0),w.keepStatic=!w.keepStatic,a=!0;0<m.length;){var b=m.shift();if(b!=w.skipOptionalPartCharacter&&!(a=x(_()+1,b,!1,!0)))break}if(p.alternation=r,p.locator[r]=f,a=a&&x(e,t,i,n),w.keepStatic=!w.keepStatic,a)return a;C(),N().validPositions=oe.extend(!0,{},l)}}break}return!1}(e,t,i,n)),!0===c&&(c={pos:l}),oe.isFunction(w.postValidation)&&0!=c&&!i)&&(C(!0),!w.postValidation(A(),w)))return C(!0),N().validPositions=oe.extend(!0,{},u),!1;return c}function g(e){var t=s(e);if(null!=t.fn)return t.fn;if(w.keepStatic||null!=N().validPositions[e])return!1;for(var i=b(e),n=!0,o=0;o<i.length;o++)if(""!=i[o].match.def&&(null!==i[o].match.fn||null==i[o].alternation||1<i[o].locator[i[o].alternation].length)){n=!1;break}return n}function v(){var e;-1==(V=z.prop("maxLength"))&&(V=void 0);var t,i=_(),n=N().validPositions[i],o=null!=n?n.locator.slice():void 0;for(t=i+1;null==n||null!=n.match.fn||null==n.match.fn&&""!=n.match.def;t++)o=(n=d(t,o,t-1)).locator.slice();return e=""!=s(t-1).def?t:t-1,null==V||e<V?e:V}function S(e){var t=v();if(t<=e)return t;for(var i=e;++i<t&&!g(i)&&(!0!==w.nojumps||w.nojumpsThreshold>i););return i}function T(e){var t=e;if(t<=0)return 0;for(;0<--t&&!g(t););return t}function D(e,t,i,n,o){if(n&&oe.isFunction(w.onBeforeWrite)){var r=w.onBeforeWrite.call(e,n,t,i,w);if(r){if(r.refreshFromBuffer){var a=r.refreshFromBuffer;E(!0===a?a:a.start,a.end,r.buffer),C(!0),t=A()}i=r.caret||i}}e._valueSet(t.join("")),null!=i&&R(e,i),!0===o&&(q=!0,oe(e).trigger("input"))}function k(e,t){if(null!=(t=t||s(e)).placeholder)return t.placeholder;if(null!=t.fn)return w.placeholder.charAt(e%w.placeholder.length);if(!w.keepStatic&&null==N().validPositions[e]){for(var i=b(e),n=!0,o=0;o<i.length;o++)if(""!=i[o].match.def&&(null!==i[o].match.fn||null==i[o].alternation||1<i[o].locator[i[o].alternation].length)){n=!1;break}if(n)return w.placeholder.charAt(e%w.placeholder.length)}return t.def}function l(s,e,l,t){var i=null!=t?t.slice():s._valueGet().split(""),c="",u=0;if(C(),N().p=S(-1),e&&s._valueSet(""),!l){var n=p().slice(0,S(-1)).join(""),o=i.join("").match(new RegExp(function(e){return oe.inputmask.escapeRegex(e)}(n),"g"));o&&0<o.length&&(i.splice(0,o.length*n.length),u=S(u))}oe.each(i,function(e,t){var i=oe.Event("keypress");i.which=t.charCodeAt(0),c+=t;var n=_(void 0,!0),o=N().validPositions[n],r=d(n+1,o?o.locator.slice():void 0,n);if(!function(){var e=!1,t=p().slice(u,S(u)).join("").indexOf(c);if(-1!=t&&!g(u)){e=!0;for(var i=p().slice(u,u+t),n=0;n<i.length;n++)if(" "!=i[n]){e=!1;break}}return e}()||l){var a=l?e:null==r.match.fn&&r.match.optionality&&n+1<N().p?n+1:N().p;P.call(s,i,!0,!1,l,a),u=a+1,c=""}else P.call(s,i,!0,!1,!0,n+1)}),e&&D(s,A(),oe(s).is(":focus")?S(_(0)):void 0,oe.Event("checkval"))}function i(e){if(!e.data("_inputmask")||e.hasClass("hasDatepicker"))return e[0]._valueGet();var t=[],i=N().validPositions;for(var n in i)i[n].match&&null!=i[n].match.fn&&t.push(i[n].input);var o=(U?t.reverse():t).join(""),r=(U?A().slice().reverse():A()).join("");return oe.isFunction(w.onUnMask)&&(o=w.onUnMask.call(e,r,o,w)||o),o}function c(e){!U||"number"!=typeof e||w.greedy&&""==w.placeholder||(e=A().length-e);return e}function R(e,t,i){var n,o=e.jquery&&0<e.length?e[0]:e;if("number"!=typeof t)return o.setSelectionRange?(t=o.selectionStart,i=o.selectionEnd):window.getSelection?(n=window.getSelection().getRangeAt(0)).commonAncestorContainer.parentNode==o&&(t=n.startOffset,i=n.endOffset):document.selection&&document.selection.createRange&&(i=(t=0-(n=document.selection.createRange()).duplicate().moveStart("character",-1e5))+n.text.length),{begin:c(t),end:c(i)};if(t=c(t),i="number"==typeof(i=c(i))?i:t,oe(o).is(":visible")){var r=oe(o).css("font-size").replace("px","")*i;if(o.scrollLeft=r>o.scrollWidth?r:0,se||0!=w.insertMode||t!=i||i++,o.setSelectionRange)o.selectionStart=t,o.selectionEnd=i;else if(window.getSelection){(n=document.createRange()).setStart(o.firstChild,t<o._valueGet().length?t:o._valueGet().length),n.setEnd(o.firstChild,i<o._valueGet().length?i:o._valueGet().length),n.collapse(!0);var a=window.getSelection();a.removeAllRanges(),a.addRange(n)}else o.createTextRange&&((n=o.createTextRange()).collapse(!0),n.moveEnd("character",i),n.moveStart("character",t),n.select())}}function u(e){var t,i,n=A(),o=n.length,r=_(),a={},s=N().validPositions[r],l=null!=s?s.locator.slice():void 0;for(t=r+1;t<n.length;t++)l=(i=d(t,l,t-1)).locator.slice(),a[t]=oe.extend(!0,{},i);var c=s&&null!=s.alternation?s.locator[s.alternation]:void 0;for(t=o-1;r<t&&(((i=a[t].match).optionality||i.optionalQuantifier||c&&c!=a[t].locator[s.alternation])&&n[t]==k(t,i));t--)o--;return e?{l:o,def:a[o]?a[o].match:void 0}:o}function a(e){for(var t=u(),i=e.length-1;t<i&&!g(i);i--);return e.splice(t,i+1-t),e}function O(e){if(oe.isFunction(w.isComplete))return w.isComplete.call(z,e,w);if("*"!=w.repeat){var t=!1,i=u(!0),n=T(i.l);if(_(),null==i.def||i.def.newBlockMarker||i.def.optionality||i.def.optionalQuantifier){t=!0;for(var o=0;o<=n;o++){var r=g(o),a=s(o);if(r&&null==N().validPositions[o]&&!0!==a.optionality&&!0!==a.optionalQuantifier||!r&&e[o]!=k(o)){t=!1;break}}}return t}}function F(r,e,t,i){if((w.numericInput||U)&&(e==oe.inputmask.keyCode.BACKSPACE?e=oe.inputmask.keyCode.DELETE:e==oe.inputmask.keyCode.DELETE&&(e=oe.inputmask.keyCode.BACKSPACE),U)){var n=t.end;t.end=t.begin,t.begin=n}if(e==oe.inputmask.keyCode.BACKSPACE&&(t.end-t.begin<1||0==w.insertMode)?t.begin=T(t.begin):e==oe.inputmask.keyCode.DELETE&&t.begin==t.end&&(t.end=g(t.end)?t.end+1:S(t.end)+1),m(t.begin,t.end,!1,i),!0!==i){!function(){if(w.keepStatic){C(!0);var e,t=[],i=oe.extend(!0,{},N().validPositions);for(e=_();0<=e;e--){var n=N().validPositions[e];if(n){if(null!=n.alternation&&n.locator[n.alternation]==d(e).locator[n.alternation])break;null!=n.match.fn&&t.push(n.input),delete N().validPositions[e]}}if(0<e)for(;0<t.length;){N().p=S(_());var o=oe.Event("keypress");o.which=t.pop().charCodeAt(0),P.call(r,o,!0,!1,!1,N().p)}else N().validPositions=oe.extend(!0,{},i)}}();var o=_(t.begin);o<t.begin?(-1==o&&C(),N().p=S(o)):N().p=t.begin}}function M(t){var i=this,e=oe(i),n=t.keyCode,o=R(i);n==oe.inputmask.keyCode.BACKSPACE||n==oe.inputmask.keyCode.DELETE||ae&&127==n||t.ctrlKey&&88==n&&!re("cut")?(t.preventDefault(),88==n&&(j=A().join("")),F(i,n,o),D(i,A(),N().p,t,j!=A().join("")),i._valueGet()==p().join("")?e.trigger("cleared"):!0===O(A())&&e.trigger("complete"),w.showTooltip&&e.prop("title",N().mask)):n==oe.inputmask.keyCode.END||n==oe.inputmask.keyCode.PAGE_DOWN?setTimeout(function(){var e=S(_());w.insertMode||e!=v()||t.shiftKey||e--,R(i,t.shiftKey?o.begin:e,e)},0):n==oe.inputmask.keyCode.HOME&&!t.shiftKey||n==oe.inputmask.keyCode.PAGE_UP?R(i,0,t.shiftKey?o.begin:0):(w.undoOnEscape&&n==oe.inputmask.keyCode.ESCAPE||90==n&&t.ctrlKey)&&!0!==t.altKey?(l(i,!0,!1,j.split("")),e.click()):n!=oe.inputmask.keyCode.INSERT||t.shiftKey||t.ctrlKey?0!=w.insertMode||t.shiftKey||(n==oe.inputmask.keyCode.RIGHT?setTimeout(function(){var e=R(i);R(i,e.begin)},0):n==oe.inputmask.keyCode.LEFT&&setTimeout(function(){var e=R(i);R(i,U?e.begin+1:e.begin-1)},0)):(w.insertMode=!w.insertMode,R(i,w.insertMode||o.begin!=v()?o.begin:o.begin-1)),w.onKeyDown.call(this,t,A(),R(i).begin,w),Q=-1!=oe.inArray(n,w.ignorables)}function P(e,t,i,n,o){var r=oe(this),a=e.which||e.charCode||e.keyCode;if(!(!0===t||e.ctrlKey&&e.altKey)&&(e.ctrlKey||e.metaKey||Q))return!0;if(a){46==a&&0==e.shiftKey&&","==w.radixPoint&&(a=44);var s,l=t?{begin:o,end:o}:R(this),c=String.fromCharCode(a),u=function(e,t){return U?1<e-t||e-t==1&&w.insertMode:1<t-e||t-e==1&&w.insertMode}(l.begin,l.end);u&&(N().undoPositions=oe.extend(!0,{},N().validPositions),F(this,oe.inputmask.keyCode.DELETE,l,!0),l.begin=N().p,w.insertMode||(w.insertMode=!w.insertMode,y(l.begin,n),w.insertMode=!w.insertMode),u=!w.multi),N().writeOutBuffer=!0;var d=U&&!u?l.end:l.begin,h=x(d,c,n);if(!1!==h){if(!0!==h&&(d=null!=h.pos?h.pos:d,c=null!=h.c?h.c:c),C(!0),null!=h.caret)s=h.caret;else{var p=N().validPositions;s=!w.keepStatic&&(null!=p[d+1]&&1<b(d+1,p[d].locator.slice(),d).length||null!=p[d].alternation)?d+1:S(d)}N().p=s}if(!1!==i){var f=this;if(setTimeout(function(){w.onKeyValidation.call(f,h,w)},0),N().writeOutBuffer&&!1!==h){var g=A();D(this,g,t?void 0:w.numericInput?T(s):s,e,!0!==t),!0!==t&&setTimeout(function(){!0===O(g)&&r.trigger("complete")},0)}else u&&(N().buffer=void 0,N().validPositions=N().undoPositions)}else u&&(N().buffer=void 0,N().validPositions=N().undoPositions);if(w.showTooltip&&r.prop("title",N().mask),t&&oe.isFunction(w.onBeforeWrite)){var m=w.onBeforeWrite.call(this,e,A(),s,w);if(m&&m.refreshFromBuffer){var v=m.refreshFromBuffer;E(!0===v?v:v.start,v.end,m.buffer),C(!0),m.caret&&(N().p=m.caret)}}e.preventDefault()}}function I(e){var t=oe(this),i=this._valueGet(!0),n=R(this);if("propertychange"==e.type&&this._valueGet().length<=v())return!0;if("paste"==e.type){var o=i.substr(0,n.begin),r=i.substr(n.end,i.length);o==p().slice(0,n.begin).join("")&&(o=""),r==p().slice(n.end).join("")&&(r=""),window.clipboardData&&window.clipboardData.getData?i=o+window.clipboardData.getData("Text")+r:e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.getData&&(i=o+e.originalEvent.clipboardData.getData("text/plain")+r)}var a=i;if(oe.isFunction(w.onBeforePaste)){if(!1===(a=w.onBeforePaste.call(this,i,w)))return e.preventDefault(),!1;a=a||i}return l(this,!0,!1,U?a.split("").reverse():a.split("")),t.click(),!0===O(A())&&t.trigger("complete"),!1}function L(e){l(this,!0,!1),!0===O(A())&&oe(this).trigger("complete"),e.preventDefault()}function G(e){j=A().join(""),""!=H&&0==e.originalEvent.data.indexOf(H)||(W=R(this))}function $(e){var t=this,i=W||R(t);0==e.originalEvent.data.indexOf(H)&&(C(),i={begin:0,end:0});var n=e.originalEvent.data;R(t,i.begin,i.end);for(var o=0;o<n.length;o++){var r=oe.Event("keypress");r.which=n.charCodeAt(o),Q=Y=!1,P.call(t,r)}setTimeout(function(){var e=N().p;D(t,A(),w.numericInput?T(e):e)},0),H=e.originalEvent.data}function B(){}var j,W,H,z,V,U=!1,Y=!1,q=!1,Q=!1,K=!0;if(null!=e)switch(e.action){case"isComplete":return z=oe(e.el),r=z.data("_inputmask").maskset,w=z.data("_inputmask").opts,O(e.buffer);case"unmaskedvalue":return z=e.$input,r=z.data("_inputmask").maskset,w=z.data("_inputmask").opts,U=e.$input.data("_inputmask").isRTL,i(e.$input);case"mask":j=A().join(""),function(e){if((z=oe(e)).is(":input")&&function(e){var t="text"==e||"tel"==e;if(!t){var i=document.createElement("input");i.setAttribute("type",e),t="text"===i.type,i=null}return t}(z.attr("type"))||e.isContentEditable||z.is("div")){if(z.data("_inputmask",{maskset:r,opts:w,isRTL:!1}),w.showTooltip&&z.prop("title",N().mask),"rtl"!=e.dir&&!w.rightAlign||z.css("text-align","right"),"rtl"==e.dir||w.numericInput){e.dir="ltr",z.removeAttr("dir");var t=z.data("_inputmask");t.isRTL=!0,z.data("_inputmask",t),U=!0}z.unbind(".inputmask"),(z.is(":input")||e.isContentEditable)&&(z.closest("form").bind("submit",function(){j!=A().join("")&&z.change(),z[0]._valueGet&&z[0]._valueGet()==p().join("")&&z[0]._valueSet(""),w.removeMaskOnSubmit&&z.inputmask("remove")}).bind("reset",function(){setTimeout(function(){z.triggerHandler("setvalue.inputmask")},0)}),z.bind("mouseenter.inputmask",function(){!oe(this).is(":focus")&&w.showMaskOnHover&&this._valueGet()!=A().join("")&&D(this,A())}).bind("blur.inputmask",function(e){var t=oe(this);if(t.data("_inputmask")){var i=this._valueGet(),n=A().slice();K=!0,j!=n.join("")&&setTimeout(function(){t.change(),j=n.join("")},0),""!=i&&(w.clearMaskOnLostFocus&&(i==p().join("")?n=[]:a(n)),!1===O(n)&&(t.trigger("incomplete"),w.clearIncomplete&&(C(),n=w.clearMaskOnLostFocus?[]:p().slice())),D(this,n,void 0,e))}}).bind("focus.inputmask",function(){var e=(oe(this),this),t=e._valueGet();w.showMaskOnFocus&&(!w.showMaskOnHover||w.showMaskOnHover&&""==t)&&e._valueGet()!=A().join("")&&D(e,A(),S(_())),j=A().join("")}).bind("mouseleave.inputmask",function(){var e=oe(this);if(w.clearMaskOnLostFocus){var t=A().slice(),i=this._valueGet();e.is(":focus")||i==e.attr("placeholder")||""==i||(i==p().join("")?t=[]:a(t),D(this,t))}}).bind("click.inputmask",function(){if(oe(this).is(":focus")){var e=R(this);if(e.begin==e.end)if(w.radixFocus&&""!=w.radixPoint&&-1!=oe.inArray(w.radixPoint,A())&&(K||A().join("")==p().join("")))R(this,oe.inArray(w.radixPoint,A())),K=!1;else{var t=U?c(e.begin):e.begin,i=S(_(t));R(this,t<i?g(t)?t:S(t):i)}}}).bind("dblclick.inputmask",function(){var e=this;setTimeout(function(){R(e,0,S(_()))},0)}).bind(ce+".inputmask dragdrop.inputmask drop.inputmask",I).bind("cut.inputmask",function(e){q=!0;var t=oe(this),i=R(this);F(this,oe.inputmask.keyCode.DELETE,i),D(this,A(),N().p,e,j!=A().join("")),this._valueGet()==p().join("")&&t.trigger("cleared"),w.showTooltip&&t.prop("title",N().mask)}).bind("complete.inputmask",w.oncomplete).bind("incomplete.inputmask",w.onincomplete).bind("cleared.inputmask",w.oncleared),z.bind("keydown.inputmask",M).bind("keypress.inputmask",P),le||z.bind("compositionstart.inputmask",G).bind("compositionupdate.inputmask",$).bind("compositionend.inputmask",B),"paste"==ce&&z.bind("input.inputmask",L)),z.bind("setvalue.inputmask",function(){var e=this._valueGet();this._valueSet(oe.isFunction(w.onBeforeMask)&&w.onBeforeMask.call(this,e,w)||e),l(this,!0,!1),j=A().join(""),(w.clearMaskOnLostFocus||w.clearIncomplete)&&this._valueGet()==p().join("")&&this._valueSet("")}),function(t){function e(){var e=oe(this),t=oe(this).data("_inputmask");return t?t.opts.autoUnmask?e.inputmask("unmaskedvalue"):n.call(this)!=p().join("")?n.call(this):"":n.call(this)}function i(e){var t=oe(this).data("_inputmask");o.call(this,e),t&&oe(this).triggerHandler("setvalue.inputmask")}var n,o,r;t._valueGet||(Object.getOwnPropertyDescriptor&&null==t.value?(n=function(){return this.textContent},o=function(e){this.textContent=e},Object.defineProperty(t,"value",{get:e,set:i})):((r=Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(t,"value"))&&r.configurable,document.__lookupGetter__&&t.__lookupGetter__("value")?(n=t.__lookupGetter__("value"),o=t.__lookupSetter__("value"),t.__defineGetter__("value",e),t.__defineSetter__("value",i)):(n=function(){return t.value},o=function(e){t.value=e},function(e){if(null==oe.valHooks[e]||1!=oe.valHooks[e].inputmaskpatch){var o=oe.valHooks[e]&&oe.valHooks[e].get?oe.valHooks[e].get:function(e){return e.value},r=oe.valHooks[e]&&oe.valHooks[e].set?oe.valHooks[e].set:function(e,t){return e.value=t,e};oe.valHooks[e]={get:function(e){var t=oe(e);if(t.data("_inputmask")){if(t.data("_inputmask").opts.autoUnmask)return t.inputmask("unmaskedvalue");var i=o(e),n=t.data("_inputmask").maskset._buffer;return i!=(n=n?n.join(""):"")?i:""}return o(e)},set:function(e,t){var i,n=oe(e),o=n.data("_inputmask");return i=r(e,t),o&&n.triggerHandler("setvalue.inputmask"),i},inputmaskpatch:!0}}}(t.type),function(e){oe(e).bind("mouseenter.inputmask",function(){var e=oe(this),t=this._valueGet();""!=t&&t!=A().join("")&&e.triggerHandler("setvalue.inputmask")});var t=oe._data(e).events.mouseover;if(t){for(var i=t[t.length-1],n=t.length-1;0<n;n--)t[n]=t[n-1];t[0]=i}}(t))),t._valueGet=function(e){return U&&!0!==e?n.call(this).split("").reverse().join(""):n.call(this)},t._valueSet=function(e){o.call(this,U?e.split("").reverse().join(""):e)})}(e);var i=oe.isFunction(w.onBeforeMask)&&w.onBeforeMask.call(e,e._valueGet(),w)||e._valueGet();l(e,!0,!1,i.split(""));var n,o=A().slice();j=o.join("");try{n=document.activeElement}catch(e){}!1===O(o)&&w.clearIncomplete&&C(),w.clearMaskOnLostFocus&&(o.join("")==p().join("")?o=[]:a(o)),D(e,o),n===e&&R(e,S(_())),function(e){var t=oe._data(e).events,n=!1;oe.each(t,function(e,t){oe.each(t,function(e,t){if("inputmask"==t.namespace&&"setvalue"!=t.type){var i=t.handler;t.handler=function(e){if(!this.disabled&&(!this.readOnly||"keydown"==e.type&&e.ctrlKey&&67==e.keyCode)){switch(e.type){case"input":if(!0===q||!0===n)return q=!1,e.preventDefault();break;case"keydown":n=Y=!1;break;case"keypress":if(!0===Y)return e.preventDefault();Y=!0;break;case"compositionstart":n=!0;break;case"compositionupdate":q=!0;break;case"compositionend":n=!1}return i.apply(this,arguments)}e.preventDefault()}}})})}(e)}}(e.el);break;case"format":(z=oe({})).data("_inputmask",{maskset:r,opts:w,isRTL:w.numericInput}),w.numericInput&&(U=!0);var n=(oe.isFunction(w.onBeforeMask)&&w.onBeforeMask.call(z,e.value,w)||e.value).split("");return l(z,!1,!1,U?n.reverse():n),oe.isFunction(w.onBeforeWrite)&&w.onBeforeWrite.call(this,void 0,A(),0,w),e.metadata?{value:U?A().slice().reverse().join(""):A().join(""),metadata:z.inputmask("getmetadata")}:U?A().slice().reverse().join(""):A().join("");case"isValid":(z=oe({})).data("_inputmask",{maskset:r,opts:w,isRTL:w.numericInput}),w.numericInput&&(U=!0);n=e.value.split("");l(z,!1,!0,U?n.reverse():n);for(var o=A(),X=u(),J=o.length-1;X<J&&!g(J);J--);return o.splice(X,J+1-X),O(o)&&e.value==o.join("");case"getemptymask":return z=oe(e.el),r=z.data("_inputmask").maskset,w=z.data("_inputmask").opts,p();case"remove":var Z,ee=e.el;z=oe(ee),r=z.data("_inputmask").maskset,w=z.data("_inputmask").opts,ee._valueSet(i(z)),z.unbind(".inputmask"),z.removeData("_inputmask"),Object.getOwnPropertyDescriptor&&(Z=Object.getOwnPropertyDescriptor(ee,"value")),Z&&Z.get?ee._valueGet&&Object.defineProperty(ee,"value",{get:ee._valueGet,set:ee._valueSet}):document.__lookupGetter__&&ee.__lookupGetter__("value")&&ee._valueGet&&(ee.__defineGetter__("value",ee._valueGet),ee.__defineSetter__("value",ee._valueSet));try{delete ee._valueGet,delete ee._valueSet}catch(e){ee._valueGet=void 0,ee._valueSet=void 0}break;case"getmetadata":if(z=oe(e.el),r=z.data("_inputmask").maskset,w=z.data("_inputmask").opts,oe.isArray(r.metadata)){for(var te,ie=_(),ne=ie;0<=ne;ne--)if(N().validPositions[ne]&&null!=N().validPositions[ne].alternation){te=N().validPositions[ne].alternation;break}return null!=te?r.metadata[N().validPositions[ie].locator[te]]:r.metadata[0]}return r.metadata}}if(void 0===oe.fn.inputmask){var e=navigator.userAgent,ae=null!==e.match(new RegExp("iphone","i")),se=(e.match(new RegExp("android.*safari.*","i")),null!==e.match(new RegExp("android.*chrome.*","i"))),le=null!==e.match(new RegExp("android.*firefox.*","i")),ce=(/Kindle/i.test(e)||/Silk/i.test(e)||/KFTT/i.test(e)||/KFOT/i.test(e)||/KFJWA/i.test(e)||/KFJWI/i.test(e)||/KFSOWI/i.test(e)||/KFTHWA/i.test(e)||/KFTHWI/i.test(e)||/KFAPWA/i.test(e)||/KFAPWI/i.test(e),re("paste")?"paste":re("input")?"input":"propertychange");oe.inputmask={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},quantifiermarker:{start:"{",end:"}"},groupmarker:{start:"(",end:")"},alternatormarker:"|",escapeChar:"\\",mask:null,oncomplete:oe.noop,onincomplete:oe.noop,oncleared:oe.noop,repeat:0,greedy:!0,autoUnmask:!1,removeMaskOnSubmit:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},alias:null,onKeyDown:oe.noop,onBeforeMask:void 0,onBeforePaste:void 0,onBeforeWrite:void 0,onUnMask:void 0,showMaskOnFocus:!0,showMaskOnHover:!0,onKeyValidation:oe.noop,skipOptionalPartCharacter:" ",showTooltip:!1,numericInput:!1,rightAlign:!1,undoOnEscape:!0,radixPoint:"",radixFocus:!1,nojumps:!1,nojumpsThreshold:0,keepStatic:void 0,definitions:{9:{validator:"[0-9]",cardinality:1,definitionSymbol:"*"},a:{validator:"[A-Za-z–ê-—è–Å—ë√Ä-√ø¬µ]",cardinality:1,definitionSymbol:"*"},"*":{validator:"[0-9A-Za-z–ê-—è–Å—ë√Ä-√ø¬µ]",cardinality:1}},ignorables:[8,9,13,19,27,33,34,35,36,37,38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123],isComplete:void 0,canClearPosition:oe.noop,postValidation:void 0},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91},masksCache:{},escapeRegex:function(e){return e.replace(new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^"].join("|\\")+")","gim"),"\\$1")},format:function(e,t,i){var n=oe.extend(!0,{},oe.inputmask.defaults,t);return a(n.alias,t,n),l({action:"format",value:e,metadata:i},s(n,t&&void 0!==t.definitions),n)},isValid:function(e,t){var i=oe.extend(!0,{},oe.inputmask.defaults,t);return a(i.alias,t,i),l({action:"isValid",value:e},s(i,t&&void 0!==t.definitions),i)}},oe.fn.inputmask=function(e,n){function o(e,t,i){var n=oe(e);for(var o in n.data("inputmask-alias")&&a(n.data("inputmask-alias"),oe.extend(!0,{},t),t),t){var r=n.data("inputmask-"+o.toLowerCase());null!=r&&("mask"==o&&0==r.indexOf("[")?(t[o]=r.replace(/[\s[\]]/g,"").split("','"),t[o][0]=t[o][0].replace("'",""),t[o][t[o].length-1]=t[o][t[o].length-1].replace("'","")):t[o]="boolean"==typeof r?r:r.toString(),i&&(i[o]=t[o]))}return t}var t,r=oe.extend(!0,{},oe.inputmask.defaults,n);if("string"==typeof e)switch(e){case"mask":return a(r.alias,n,r),this.each(function(){return o(this,r),null==(t=s(r,n&&void 0!==n.definitions))?this:void l({action:"mask",el:this},t,r)});case"unmaskedvalue":var i=oe(this);return i.data("_inputmask")?l({action:"unmaskedvalue",$input:i}):i.val();case"remove":return this.each(function(){oe(this).data("_inputmask")&&l({action:"remove",el:this})});case"getemptymask":return this.data("_inputmask")?l({action:"getemptymask",el:this}):"";case"hasMaskedValue":return!!this.data("_inputmask")&&!this.data("_inputmask").opts.autoUnmask;case"isComplete":return!this.data("_inputmask")||l({action:"isComplete",buffer:this[0]._valueGet().split(""),el:this});case"getmetadata":return this.data("_inputmask")?l({action:"getmetadata",el:this}):void 0;default:return a(r.alias,n,r),a(e,n,r)||(r.mask=e),this.each(function(){return o(this,r),null==(t=s(r,n&&void 0!==n.definitions))?this:void l({action:"mask",el:this},t,r)})}else{if("object"==typeof e)return a((r=oe.extend(!0,{},oe.inputmask.defaults,e)).alias,e,r),this.each(function(){return o(this,r),null==(t=s(r,e&&void 0!==e.definitions))?this:void l({action:"mask",el:this},t,r)});if(null==e)return this.each(function(){var e=oe(this).attr("data-inputmask");if(e&&""!=e)try{e=e.replace(new RegExp("'","g"),'"');var t=oe.parseJSON("{"+e+"}");oe.extend(!0,t,n),a((r=o(this,r=oe.extend(!0,{},oe.inputmask.defaults,t))).alias,t,r),r.alias=void 0,oe(this).inputmask("mask",r)}catch(e){}if(oe(this).attr("data-inputmask-mask")||oe(this).attr("data-inputmask-alias")){var i={};a((r=o(this,r=oe.extend(!0,{},oe.inputmask.defaults,{}),i)).alias,i,r),r.alias=void 0,oe(this).inputmask("mask",r)}})}}}oe.fn.inputmask}(jQuery),function(n){n.extend(n.inputmask.defaults.definitions,{h:{validator:"[01][0-9]|2[0-3]",cardinality:2,prevalidator:[{validator:"[0-2]",cardinality:1}]},s:{validator:"[0-5][0-9]",cardinality:2,prevalidator:[{validator:"[0-5]",cardinality:1}]},d:{validator:"0[1-9]|[12][0-9]|3[01]",cardinality:2,prevalidator:[{validator:"[0-3]",cardinality:1}]},m:{validator:"0[1-9]|1[012]",cardinality:2,prevalidator:[{validator:"[01]",cardinality:1}]},y:{validator:"(19|20)\\d{2}",cardinality:4,prevalidator:[{validator:"[12]",cardinality:1},{validator:"(19|20)",cardinality:2},{validator:"(19|20)\\d",cardinality:3}]}}),n.extend(n.inputmask.defaults.aliases,{"dd/mm/yyyy":{mask:"1/2/y",placeholder:"dd/mm/yyyy",regex:{val1pre:new RegExp("[0-3]"),val1:new RegExp("0[1-9]|[12][0-9]|3[01]"),val2pre:function(e){var t=n.inputmask.escapeRegex.call(this,e);return new RegExp("((0[1-9]|[12][0-9]|3[01])"+t+"[01])")},val2:function(e){var t=n.inputmask.escapeRegex.call(this,e);return new RegExp("((0[1-9]|[12][0-9])"+t+"(0[1-9]|1[012]))|(30"+t+"(0[13-9]|1[012]))|(31"+t+"(0[13578]|1[02]))")}},leapday:"29/02/",separator:"/",yearrange:{minyear:1900,maxyear:2099},isInYearRange:function(e,t,i){if(isNaN(e))return!1;var n=parseInt(e.concat(t.toString().slice(e.length))),o=parseInt(e.concat(i.toString().slice(e.length)));return!isNaN(n)&&(t<=n&&n<=i)||!isNaN(o)&&(t<=o&&o<=i)},determinebaseyear:function(e,t,i){var n=(new Date).getFullYear();if(n<e)return e;if(t<n){for(var o=t.toString().slice(0,2),r=t.toString().slice(2,4);t<o+i;)o--;var a=o+r;return a<e?e:a}return n},onKeyDown:function(e){var t=n(this);if(e.ctrlKey&&e.keyCode==n.inputmask.keyCode.RIGHT){var i=new Date;t.val(i.getDate().toString()+(i.getMonth()+1).toString()+i.getFullYear().toString()),t.triggerHandler("setvalue.inputmask")}},getFrontValue:function(e,t,i){for(var n=0,o=0,r=0;r<e.length&&"2"!=e.charAt(r);r++){var a=i.definitions[e.charAt(r)];a?(n+=o,o=a.cardinality):o++}return t.join("").substr(n,o)},definitions:{1:{validator:function(e,t,i,n,o){var r=o.regex.val1.test(e);return n||r||e.charAt(1)!=o.separator&&-1=="-./".indexOf(e.charAt(1))||!(r=o.regex.val1.test("0"+e.charAt(0)))?r:(t.buffer[i-1]="0",{refreshFromBuffer:{start:i-1,end:i},pos:i,c:e.charAt(0)})},cardinality:2,prevalidator:[{validator:function(e,t,i,n,o){var r=e;isNaN(t.buffer[i+1])||(r+=t.buffer[i+1]);var a=1==r.length?o.regex.val1pre.test(r):o.regex.val1.test(r);if(!n&&!a){if(a=o.regex.val1.test(e+"0"))return t.buffer[i]=e,t.buffer[++i]="0",{pos:i,c:"0"};if(a=o.regex.val1.test("0"+e))return t.buffer[i]="0",{pos:++i}}return a},cardinality:1}]},2:{validator:function(e,t,i,n,o){var r=o.getFrontValue(t.mask,t.buffer,o);-1!=r.indexOf(o.placeholder[0])&&(r="01"+o.separator);var a=o.regex.val2(o.separator).test(r+e);if(!n&&!a&&(e.charAt(1)==o.separator||-1!="-./".indexOf(e.charAt(1)))&&(a=o.regex.val2(o.separator).test(r+"0"+e.charAt(0))))return t.buffer[i-1]="0",{refreshFromBuffer:{start:i-1,end:i},pos:i,c:e.charAt(0)};if(o.mask.indexOf("2")==o.mask.length-1&&a){if(t.buffer.join("").substr(4,4)+e!=o.leapday)return!0;var s=parseInt(t.buffer.join("").substr(0,4),10);return s%4==0&&(s%100!=0||s%400==0)}return a},cardinality:2,prevalidator:[{validator:function(e,t,i,n,o){isNaN(t.buffer[i+1])||(e+=t.buffer[i+1]);var r=o.getFrontValue(t.mask,t.buffer,o);-1!=r.indexOf(o.placeholder[0])&&(r="01"+o.separator);var a=1==e.length?o.regex.val2pre(o.separator).test(r+e):o.regex.val2(o.separator).test(r+e);return n||a||!(a=o.regex.val2(o.separator).test(r+"0"+e))?a:(t.buffer[i]="0",{pos:++i})},cardinality:1}]},y:{validator:function(e,t,i,n,o){if(o.isInYearRange(e,o.yearrange.minyear,o.yearrange.maxyear)){if(t.buffer.join("").substr(0,6)!=o.leapday)return!0;var r=parseInt(e,10);return r%4==0&&(r%100!=0||r%400==0)}return!1},cardinality:4,prevalidator:[{validator:function(e,t,i,n,o){var r=o.isInYearRange(e,o.yearrange.minyear,o.yearrange.maxyear);if(!n&&!r){var a=o.determinebaseyear(o.yearrange.minyear,o.yearrange.maxyear,e+"0").toString().slice(0,1);if(r=o.isInYearRange(a+e,o.yearrange.minyear,o.yearrange.maxyear))return t.buffer[i++]=a.charAt(0),{pos:i};if(a=o.determinebaseyear(o.yearrange.minyear,o.yearrange.maxyear,e+"0").toString().slice(0,2),r=o.isInYearRange(a+e,o.yearrange.minyear,o.yearrange.maxyear))return t.buffer[i++]=a.charAt(0),t.buffer[i++]=a.charAt(1),{pos:i}}return r},cardinality:1},{validator:function(e,t,i,n,o){var r=o.isInYearRange(e,o.yearrange.minyear,o.yearrange.maxyear);if(!n&&!r){var a=o.determinebaseyear(o.yearrange.minyear,o.yearrange.maxyear,e).toString().slice(0,2);if(r=o.isInYearRange(e[0]+a[1]+e[1],o.yearrange.minyear,o.yearrange.maxyear))return t.buffer[i++]=a.charAt(1),{pos:i};if(a=o.determinebaseyear(o.yearrange.minyear,o.yearrange.maxyear,e).toString().slice(0,2),o.isInYearRange(a+e,o.yearrange.minyear,o.yearrange.maxyear))if(t.buffer.join("").substr(0,6)!=o.leapday)r=!0;else{var s=parseInt(e,10);r=s%4==0&&(s%100!=0||s%400==0)}else r=!1;if(r)return t.buffer[i-1]=a.charAt(0),t.buffer[i++]=a.charAt(1),t.buffer[i++]=e.charAt(0),{refreshFromBuffer:{start:i-3,end:i},pos:i}}return r},cardinality:2},{validator:function(e,t,i,n,o){return o.isInYearRange(e,o.yearrange.minyear,o.yearrange.maxyear)},cardinality:3}]}},insertMode:!1,autoUnmask:!1},"mm/dd/yyyy":{placeholder:"mm/dd/yyyy",alias:"dd/mm/yyyy",regex:{val2pre:function(e){var t=n.inputmask.escapeRegex.call(this,e);return new RegExp("((0[13-9]|1[012])"+t+"[0-3])|(02"+t+"[0-2])")},val2:function(e){var t=n.inputmask.escapeRegex.call(this,e);return new RegExp("((0[1-9]|1[012])"+t+"(0[1-9]|[12][0-9]))|((0[13-9]|1[012])"+t+"30)|((0[13578]|1[02])"+t+"31)")},val1pre:new RegExp("[01]"),val1:new RegExp("0[1-9]|1[012]")},leapday:"02/29/",onKeyDown:function(e){var t=n(this);if(e.ctrlKey&&e.keyCode==n.inputmask.keyCode.RIGHT){var i=new Date;t.val((i.getMonth()+1).toString()+i.getDate().toString()+i.getFullYear().toString()),t.triggerHandler("setvalue.inputmask")}}},"yyyy/mm/dd":{mask:"y/1/2",placeholder:"yyyy/mm/dd",alias:"mm/dd/yyyy",leapday:"/02/29",onKeyDown:function(e){var t=n(this);if(e.ctrlKey&&e.keyCode==n.inputmask.keyCode.RIGHT){var i=new Date;t.val(i.getFullYear().toString()+(i.getMonth()+1).toString()+i.getDate().toString()),t.triggerHandler("setvalue.inputmask")}}},"dd.mm.yyyy":{mask:"1.2.y",placeholder:"dd.mm.yyyy",leapday:"29.02.",separator:".",alias:"dd/mm/yyyy"},"dd-mm-yyyy":{mask:"1-2-y",placeholder:"dd-mm-yyyy",leapday:"29-02-",separator:"-",alias:"dd/mm/yyyy"},"mm.dd.yyyy":{mask:"1.2.y",placeholder:"mm.dd.yyyy",leapday:"02.29.",separator:".",alias:"mm/dd/yyyy"},"mm-dd-yyyy":{mask:"1-2-y",placeholder:"mm-dd-yyyy",leapday:"02-29-",separator:"-",alias:"mm/dd/yyyy"},"yyyy.mm.dd":{mask:"y.1.2",placeholder:"yyyy.mm.dd",leapday:".02.29",separator:".",alias:"yyyy/mm/dd"},"yyyy-mm-dd":{mask:"y-1-2",placeholder:"yyyy-mm-dd",leapday:"-02-29",separator:"-",alias:"yyyy/mm/dd"},datetime:{mask:"1/2/y h:s",placeholder:"dd/mm/yyyy hh:mm",alias:"dd/mm/yyyy",regex:{hrspre:new RegExp("[012]"),hrs24:new RegExp("2[0-4]|1[3-9]"),hrs:new RegExp("[01][0-9]|2[0-4]"),ampm:new RegExp("^[a|p|A|P][m|M]"),mspre:new RegExp("[0-5]"),ms:new RegExp("[0-5][0-9]")},timeseparator:":",hourFormat:"24",definitions:{h:{validator:function(e,t,i,n,o){if("24"==o.hourFormat&&24==parseInt(e,10))return t.buffer[i-1]="0",{refreshFromBuffer:{start:i-1,end:i},c:t.buffer[i]="0"};var r=o.regex.hrs.test(e);if(!n&&!r&&(e.charAt(1)==o.timeseparator||-1!="-.:".indexOf(e.charAt(1)))&&(r=o.regex.hrs.test("0"+e.charAt(0))))return t.buffer[i-1]="0",t.buffer[i]=e.charAt(0),{refreshFromBuffer:{start:++i-2,end:i},pos:i,c:o.timeseparator};if(r&&"24"!==o.hourFormat&&o.regex.hrs24.test(e)){var a=parseInt(e,10);return t.buffer[i+5]=24==a?"a":"p",t.buffer[i+6]="m",(a-=12)<10?(t.buffer[i]=a.toString(),t.buffer[i-1]="0"):(t.buffer[i]=a.toString().charAt(1),t.buffer[i-1]=a.toString().charAt(0)),{refreshFromBuffer:{start:i-1,end:i+6},c:t.buffer[i]}}return r},cardinality:2,prevalidator:[{validator:function(e,t,i,n,o){var r=o.regex.hrspre.test(e);return n||r||!(r=o.regex.hrs.test("0"+e))?r:(t.buffer[i]="0",{pos:++i})},cardinality:1}]},s:{validator:"[0-5][0-9]",cardinality:2,prevalidator:[{validator:function(e,t,i,n,o){var r=o.regex.mspre.test(e);return n||r||!(r=o.regex.ms.test("0"+e))?r:(t.buffer[i]="0",{pos:++i})},cardinality:1}]},t:{validator:function(e,t,i,n,o){return o.regex.ampm.test(e+"m")},casing:"lower",cardinality:1}},insertMode:!1,autoUnmask:!1},datetime12:{mask:"1/2/y h:s t\\m",placeholder:"dd/mm/yyyy hh:mm xm",alias:"datetime",hourFormat:"12"},"hh:mm t":{mask:"h:s t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"h:s t":{mask:"h:s t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"hh:mm:ss":{mask:"h:s:s",placeholder:"hh:mm:ss",alias:"datetime",autoUnmask:!1},"hh:mm":{mask:"h:s",placeholder:"hh:mm",alias:"datetime",autoUnmask:!1},date:{alias:"dd/mm/yyyy"},"mm/yyyy":{mask:"1/y",placeholder:"mm/yyyy",leapday:"donotuse",separator:"/",alias:"mm/dd/yyyy"}}),n.fn.inputmask}(jQuery),function(e){e.extend(e.inputmask.defaults.definitions,{A:{validator:"[A-Za-z–ê-—è–Å—ë√Ä-√ø¬µ]",cardinality:1,casing:"upper"},"#":{validator:"[0-9A-Za-z–ê-—è–Å—ë√Ä-√ø¬µ]",cardinality:1,casing:"upper"}}),e.extend(e.inputmask.defaults.aliases,{url:{mask:"ir",placeholder:"",separator:"",defaultPrefix:"http://",regex:{urlpre1:new RegExp("[fh]"),urlpre2:new RegExp("(ft|ht)"),urlpre3:new RegExp("(ftp|htt)"),urlpre4:new RegExp("(ftp:|http|ftps)"),urlpre5:new RegExp("(ftp:/|ftps:|http:|https)"),urlpre6:new RegExp("(ftp://|ftps:/|http:/|https:)"),urlpre7:new RegExp("(ftp://|ftps://|http://|https:/)"),urlpre8:new RegExp("(ftp://|ftps://|http://|https://)")},definitions:{i:{validator:function(){return!0},cardinality:8,prevalidator:function(){for(var e=[],t=0;t<8;t++)e[t]=function(){var l=t;return{validator:function(e,t,i,n,o){if(o.regex["urlpre"+(l+1)]){var r,a=e;0<l+1-e.length&&(a=t.buffer.join("").substring(0,l+1-e.length)+""+a);var s=o.regex["urlpre"+(l+1)].test(a);if(n||s)return s;for(i-=l,r=0;r<o.defaultPrefix.length;r++)t.buffer[i]=o.defaultPrefix[r],i++;for(r=0;r<a.length-1;r++)t.buffer[i]=a[r],i++;return{pos:i}}return!1},cardinality:l}}();return e}()},r:{validator:".",cardinality:50}},insertMode:!1,autoUnmask:!1},ip:{mask:"i[i[i]].i[i[i]].i[i[i]].i[i[i]]",definitions:{i:{validator:function(e,t,i){return e=-1<i-1&&"."!=t.buffer[i-1]?(e=t.buffer[i-1]+e,-1<i-2&&"."!=t.buffer[i-2]?t.buffer[i-2]+e:"0"+e):"00"+e,new RegExp("25[0-5]|2[0-4][0-9]|[01][0-9][0-9]").test(e)},cardinality:1}}},email:{mask:"*{1,64}[.*{1,64}][.*{1,64}][.*{1,64}]@*{1,64}[.*{2,64}][.*{2,6}][.*{1,2}]",greedy:!1,onBeforePaste:function(e){return(e=e.toLowerCase()).replace("mailto:","")},definitions:{"*":{validator:"[0-9A-Za-z!#$%&'*+/=?^_`{|}~-]",cardinality:1,casing:"lower"}}}}),e.fn.inputmask}(jQuery),function(m){m.extend(m.inputmask.defaults.aliases,{numeric:{mask:function(n){function e(e){for(var t="",i=0;i<e.length;i++)t+=n.definitions[e[i]]?"\\"+e[i]:e[i];return t}if(0!==n.repeat&&isNaN(n.integerDigits)&&(n.integerDigits=n.repeat),n.repeat=0,n.groupSeparator==n.radixPoint&&(n.groupSeparator="."==n.radixPoint?",":","==n.radixPoint?".":"")," "===n.groupSeparator&&(n.skipOptionalPartCharacter=void 0),n.autoGroup=n.autoGroup&&""!=n.groupSeparator,n.autoGroup&&("string"==typeof n.groupSize&&isFinite(n.groupSize)&&(n.groupSize=parseInt(n.groupSize)),isFinite(n.integerDigits))){var t=Math.floor(n.integerDigits/n.groupSize),i=n.integerDigits%n.groupSize;n.integerDigits=parseInt(n.integerDigits)+(0==i?t-1:t)}1<n.placeholder.length&&(n.placeholder=n.placeholder.charAt(0)),n.radixFocus=n.radixFocus&&"0"==n.placeholder,n.definitions[";"]=n.definitions["~"];var o=e(n.prefix);return o+="[+]",o+="~{1,"+n.integerDigits+"}",null!=n.digits&&(isNaN(n.digits)||0<parseInt(n.digits))&&(o+=n.digitsOptional?"["+(n.decimalProtect?":":n.radixPoint)+";{"+n.digits+"}]":(n.decimalProtect?":":n.radixPoint)+";{"+n.digits+"}"),""!=n.negationSymbol.back&&(o+="[-]"),o+=e(n.suffix),n.greedy=!1,o},placeholder:"",greedy:!1,digits:"*",digitsOptional:!0,groupSeparator:"",radixPoint:".",radixFocus:!0,groupSize:3,autoGroup:!1,allowPlus:!0,allowMinus:!0,negationSymbol:{front:"-",back:""},integerDigits:"+",prefix:"",suffix:"",rightAlign:!0,decimalProtect:!0,min:void 0,max:void 0,postFormat:function(e,t,i,n){var o=!1;e.length>=n.suffix.length&&e.join("").indexOf(n.suffix)==e.length-n.suffix.length&&(e.length=e.length-n.suffix.length,o=!0);var r=!1,a=e[t=t>=e.length?e.length-1:t<n.prefix.length?n.prefix.length:t];if(""==n.groupSeparator||-1!=m.inArray(n.radixPoint,e)&&t>=m.inArray(n.radixPoint,e)||new RegExp("["+m.inputmask.escapeRegex(n.negationSymbol.front)+"+]").test(a)){if(o)for(var s=0,l=n.suffix.length;s<l;s++)e.push(n.suffix.charAt(s));return{pos:t}}var c=e.slice();a==n.groupSeparator&&(c.splice(t--,1),a=c[t]),i?c[t]="?":c.splice(t,0,"?");var u=c.join(""),d=u;if(0<u.length&&n.autoGroup||i&&-1!=u.indexOf(n.groupSeparator)){var h=m.inputmask.escapeRegex(n.groupSeparator);r=0==u.indexOf(n.groupSeparator);var p=(u=u.replace(new RegExp(h,"g"),"")).split(n.radixPoint);if((u=""==n.radixPoint?u:p[0])!=n.prefix+"?0"&&u.length>=n.groupSize+n.prefix.length)for(var f=new RegExp("([-+]?[\\d?]+)([\\d?]{"+n.groupSize+"})");f.test(u);)u=(u=u.replace(f,"$1"+n.groupSeparator+"$2")).replace(n.groupSeparator+n.groupSeparator,n.groupSeparator);""!=n.radixPoint&&1<p.length&&(u+=n.radixPoint+p[1])}r=d!=u,e.length=u.length;for(s=0,l=u.length;s<l;s++)e[s]=u.charAt(s);var g=m.inArray("?",e);if(i?e[g]=a:e.splice(g,1),!r&&o)for(s=0,l=n.suffix.length;s<l;s++)e.push(n.suffix.charAt(s));return{pos:g,refreshFromBuffer:r,buffer:e}},onBeforeWrite:function(e,t,i,n){if(e&&"blur"==e.type){var o=t.join("").replace(n.prefix,"");if(o=(o=o.replace(n.suffix,"")).replace(new RegExp(m.inputmask.escapeRegex(n.groupSeparator),"g"),""),","===n.radixPoint&&(o=o.replace(m.inputmask.escapeRegex(n.radixPoint),".")),isFinite(o)&&isFinite(n.min)&&parseFloat(o)<parseFloat(n.min))return m.extend(!0,{refreshFromBuffer:!0,buffer:(n.prefix+n.min).split("")},n.postFormat((n.prefix+n.min).split(""),0,!0,n));var r=""!=n.radixPoint?t.join("").split(n.radixPoint):[t.join("")],a=r[0].match(n.regex.integerPart(n)),s=2==r.length?r[1].match(n.regex.integerNPart(n)):void 0;!a||a[0]!=n.negationSymbol.front+"0"&&a[0]!=n.negationSymbol.front&&"+"!=a[0]||null!=s&&!s[0].match(/^0+$/)||t.splice(a.index,1);var l=m.inArray(n.radixPoint,t);if(-1!=l&&isFinite(n.digits)&&!n.digitsOptional){for(var c=1;c<=n.digits;c++)null!=t[l+c]&&t[l+c]!=n.placeholder.charAt(0)||(t[l+c]="0");return{refreshFromBuffer:!0,buffer:t}}}if(n.autoGroup){var u=n.postFormat(t,i-1,!0,n);return u.caret=i<=n.prefix.length?u.pos:u.pos+1,u}},regex:{integerPart:function(e){return new RegExp("["+m.inputmask.escapeRegex(e.negationSymbol.front)+"+]?\\d+")},integerNPart:function(e){return new RegExp("[\\d"+m.inputmask.escapeRegex(e.groupSeparator)+"]+")}},signHandler:function(e,t,i,n,o){if(!n&&o.allowMinus&&"-"===e||o.allowPlus&&"+"===e){var r=t.buffer.join("").match(o.regex.integerPart(o));if(r&&0<r[0].length)return t.buffer[r.index]==("-"===e?"+":o.negationSymbol.front)?"-"==e?""!=o.negationSymbol.back?{pos:r.index,c:o.negationSymbol.front,remove:r.index,caret:i,insert:{pos:t.buffer.length-o.suffix.length-1,c:o.negationSymbol.back}}:{pos:r.index,c:o.negationSymbol.front,remove:r.index,caret:i}:""!=o.negationSymbol.back?{pos:r.index,c:"+",remove:[r.index,t.buffer.length-o.suffix.length-1],caret:i}:{pos:r.index,c:"+",remove:r.index,caret:i}:t.buffer[r.index]==("-"===e?o.negationSymbol.front:"+")?"-"==e&&""!=o.negationSymbol.back?{remove:[r.index,t.buffer.length-o.suffix.length-1],caret:i-1}:{remove:r.index,caret:i-1}:"-"==e?""!=o.negationSymbol.back?{pos:r.index,c:o.negationSymbol.front,caret:i+1,insert:{pos:t.buffer.length-o.suffix.length,c:o.negationSymbol.back}}:{pos:r.index,c:o.negationSymbol.front,caret:i+1}:{pos:r.index,c:e,caret:i+1}}return!1},radixHandler:function(e,t,i,n,o){if(!n&&e===o.radixPoint&&0<o.digits){var r=m.inArray(o.radixPoint,t.buffer),a=t.buffer.join("").match(o.regex.integerPart(o));if(-1!=r&&t.validPositions[r])return t.validPositions[r-1]?{caret:r+1}:{pos:a.index,c:a[0],caret:r+1};if(!a||"0"==a[0]&&a.index+1!=i)return t.buffer[a?a.index:i]="0",{pos:(a?a.index:i)+1}}return!1},leadingZeroHandler:function(e,t,i,n,o){var r=t.buffer.join("").match(o.regex.integerNPart(o)),a=m.inArray(o.radixPoint,t.buffer);if(r&&!n&&(-1==a||i<=a))if(0==r[0].indexOf("0")){i<o.prefix.length&&(i=r.index);var s=m.inArray(o.radixPoint,t._buffer),l=t._buffer&&t.buffer.slice(a).join("")==t._buffer.slice(s).join("")||0==parseInt(t.buffer.slice(a+1).join("")),c=t._buffer&&t.buffer.slice(r.index,a).join("")==t._buffer.slice(o.prefix.length,s).join("")||"0"==t.buffer.slice(r.index,a).join("");if(-1==a||l&&c)return t.buffer.splice(r.index,1),{pos:i=i>r.index?i-1:r.index,remove:r.index};if(r.index+1==i||"0"==e)return t.buffer.splice(r.index,1),{pos:i=r.index,remove:r.index}}else if("0"===e&&i<=r.index&&r[0]!=o.groupSeparator)return!1;return!0},postValidation:function(e,t){var i=!0,n=e.join("").replace(t.prefix,"");return n=(n=n.replace(t.suffix,"")).replace(new RegExp(m.inputmask.escapeRegex(t.groupSeparator),"g"),""),","===t.radixPoint&&(n=n.replace(m.inputmask.escapeRegex(t.radixPoint),".")),n=(n=n.replace(new RegExp("^"+m.inputmask.escapeRegex(t.negationSymbol.front)),"-")).replace(new RegExp(m.inputmask.escapeRegex(t.negationSymbol.back)+"$"),""),isFinite(n)&&isFinite(t.max)&&(i=parseFloat(n)<=parseFloat(t.max)),i},definitions:{"~":{validator:function(e,t,i,n,o){var r=o.signHandler(e,t,i,n,o);if(!r&&(!(r=o.radixHandler(e,t,i,n,o))&&(!0===(r=n?new RegExp("[0-9"+m.inputmask.escapeRegex(o.groupSeparator)+"]").test(e):new RegExp("[0-9]").test(e))&&!0===(r=o.leadingZeroHandler(e,t,i,n,o))))){var a=m.inArray(o.radixPoint,t.buffer);r=!1===o.digitsOptional&&a<i&&!n?{pos:i,remove:i}:{pos:i}}return r},cardinality:1,prevalidator:null},"+":{validator:function(e,t,i,n,o){var r=o.signHandler(e,t,i,n,o);return!r&&(n&&o.allowMinus&&e===o.negationSymbol.front||o.allowMinus&&"-"==e||o.allowPlus&&"+"==e)&&(r="-"!=e||(""!=o.negationSymbol.back?{pos:i,c:"-"===e?o.negationSymbol.front:"+",caret:i+1,insert:{pos:t.buffer.length,c:o.negationSymbol.back}}:{pos:i,c:"-"===e?o.negationSymbol.front:"+",caret:i+1})),r},cardinality:1,prevalidator:null,placeholder:""},"-":{validator:function(e,t,i,n,o){var r=o.signHandler(e,t,i,n,o);return!r&&n&&o.allowMinus&&e===o.negationSymbol.back&&(r=!0),r},cardinality:1,prevalidator:null,placeholder:""},":":{validator:function(e,t,i,n,o){var r=o.signHandler(e,t,i,n,o);if(!r){var a="["+m.inputmask.escapeRegex(o.radixPoint)+"]";(r=new RegExp(a).test(e))&&t.validPositions[i]&&t.validPositions[i].match.placeholder==o.radixPoint&&(r={caret:i+1})}return r},cardinality:1,prevalidator:null,placeholder:function(e){return e.radixPoint}}},insertMode:!0,autoUnmask:!1,unmaskAsNumber:!1,onUnMask:function(e,t,i){var n=e.replace(i.prefix,"");return n=(n=n.replace(i.suffix,"")).replace(new RegExp(m.inputmask.escapeRegex(i.groupSeparator),"g"),""),i.unmaskAsNumber?(n=n.replace(m.inputmask.escapeRegex.call(this,i.radixPoint),"."),Number(n)):n},isComplete:function(e,t){var i=e.join(""),n=e.slice();if(t.postFormat(n,0,!0,t),n.join("")!=i)return!1;var o=i.replace(t.prefix,"");return o=(o=o.replace(t.suffix,"")).replace(new RegExp(m.inputmask.escapeRegex(t.groupSeparator),"g"),""),","===t.radixPoint&&(o=o.replace(m.inputmask.escapeRegex(t.radixPoint),".")),isFinite(o)},onBeforeMask:function(e,t){if(""!=t.radixPoint&&isFinite(e))e=e.toString().replace(".",t.radixPoint);else{var i=e.match(/,/g),n=e.match(/\./g);e=n&&i?n.length>i.length?(e=e.replace(/\./g,"")).replace(",",t.radixPoint):i.length>n.length?(e=e.replace(/,/g,"")).replace(".",t.radixPoint):e.indexOf(".")<e.indexOf(",")?e.replace(/\./g,""):e=e.replace(/,/g,""):e.replace(new RegExp(m.inputmask.escapeRegex(t.groupSeparator),"g"),"")}return 0==t.digits&&(-1!=e.indexOf(".")?e=e.substring(0,e.indexOf(".")):-1!=e.indexOf(",")&&(e=e.substring(0,e.indexOf(",")))),e},canClearPosition:function(e,t,i,n,o){var r=e.validPositions[t].input,a=r!=o.radixPoint&&isFinite(r)||t==i||r==o.groupSeparator||r==o.negationSymbol.front||r==o.negationSymbol.back;if(a&&isFinite(r)){var s;if(!n&&e.buffer){var l=t+1;if(null==(s=e.buffer.join("").substr(0,t).match(o.regex.integerNPart(o)))||0==parseInt(s[0].replace(new RegExp(m.inputmask.escapeRegex(o.groupSeparator),"g"),"")))for(;e.validPositions[l]&&(e.validPositions[l].input==o.groupSeparator||"0"==e.validPositions[l].input);)delete e.validPositions[l],l++}var c=[];for(var u in e.validPositions)c.push(e.validPositions[u].input);s=c.join("").match(o.regex.integerNPart(o));var d=m.inArray(o.radixPoint,e.buffer);if(s&&(-1==d||t<=d))if(0==s[0].indexOf("0"))a=s.index!=t||-1==d;else{var h=parseInt(s[0].replace(new RegExp(m.inputmask.escapeRegex(o.groupSeparator),"g"),""));-1!=d&&h<10&&"0"==o.placeholder.charAt(0)&&(e.validPositions[t].input="0",e.p=o.prefix.length+1,a=!1)}}return a}},currency:{prefix:"$ ",groupSeparator:",",alias:"numeric",placeholder:"0",autoGroup:!0,digits:2,digitsOptional:!1,clearMaskOnLostFocus:!1},decimal:{alias:"numeric"},integer:{alias:"numeric",digits:"0",radixPoint:""}}),m.fn.inputmask}(jQuery),function(e){e.extend(e.inputmask.defaults.aliases,{phone:{url:"phone-codes/phone-codes.js",maskInit:"+pp(pp)pppppppp",countrycode:"",mask:function(n){n.definitions={p:{validator:function(){return!1},cardinality:1},"#":{validator:"[0-9]",cardinality:1}};var t=[];return e.ajax({url:n.url,async:!1,dataType:"json",success:function(e){t=e},error:function(e,t,i){alert(i+" - "+n.url)}}),t=t.sort(function(e,t){return(e.mask||e)<(t.mask||t)?-1:1}),""!=n.countrycode&&(n.maskInit="+"+n.countrycode+n.maskInit.substring(3)),t.splice(0,0,n.maskInit),t},nojumps:!0,nojumpsThreshold:1,onBeforeMask:function(e,t){var i=e.replace(/^0/g,"");return(1<i.indexOf(t.countrycode)||-1==i.indexOf(t.countrycode))&&(i="+"+t.countrycode+i),i}},phonebe:{alias:"phone",url:"phone-codes/phone-be.js",countrycode:"32",nojumpsThreshold:4}}),e.fn.inputmask}(jQuery),function(b){b.extend(b.inputmask.defaults.aliases,{Regex:{mask:"r",greedy:!1,repeat:"*",regex:null,regexTokens:null,tokenizer:/\[\^?]?(?:[^\\\]]+|\\[\S\s]?)*]?|\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9][0-9]*|x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4}|c[A-Za-z]|[\S\s]?)|\((?:\?[:=!]?)?|(?:[?*+]|\{[0-9]+(?:,[0-9]*)?\})\??|[^.?*+^${[()|\\]+|./g,quantifierFilter:/[0-9]+[^,]/,isComplete:function(e,t){return new RegExp(t.regex).test(e.join(""))},definitions:{r:{validator:function(e,t,i,n,u){function d(e,t){this.matches=[],this.isGroup=e||!1,this.isQuantifier=t||!1,this.quantifier={min:1,max:1},this.repeaterPart=void 0}function g(e,t){var i=!1;t&&(m+="(",v++);for(var n=0;n<e.matches.length;n++){var o=e.matches[n];if(1==o.isGroup)i=g(o,!0);else if(1==o.isQuantifier){var r=b.inArray(o,e.matches),a=e.matches[r-1],s=m;if(isNaN(o.quantifier.max)){for(;o.repeaterPart&&o.repeaterPart!=m&&o.repeaterPart.length>m.length&&!(i=g(a,!0)););(i=i||g(a,!0))&&(o.repeaterPart=m),m=s+o.quantifier.max}else{for(var l=0,c=o.quantifier.max-1;l<c&&!(i=g(a,!0));l++);m=s+"{"+o.quantifier.min+","+o.quantifier.max+"}"}}else if(null!=o.matches)for(var u=0;u<o.length&&!(i=g(o[u],t));u++);else{var d;if("["==o.charAt(0)){d=m,d+=o;for(var h=0;h<v;h++)d+=")";i=new RegExp("^("+d+")$").test(y)}else for(var p=0,f=o.length;p<f;p++)if("\\"!=o.charAt(p)){d=m,d=(d+=o.substr(0,p+1)).replace(/\|$/,"");for(h=0;h<v;h++)d+=")";if(i=new RegExp("^("+d+")$").test(y))break}m+=o}if(i)break}return t&&(m+=")",v--),i}null==u.regexTokens&&function(){var e,t,i=new d,n=[];for(u.regexTokens=[];e=u.tokenizer.exec(u.regex);)switch(t=e[0],t.charAt(0)){case"(":n.push(new d(!0));break;case")":var o=n.pop();0<n.length?n[n.length-1].matches.push(o):i.matches.push(o);break;case"{":case"+":case"*":var r=new d(!1,!0),a=(t=t.replace(/[{}]/g,"")).split(","),s=isNaN(a[0])?a[0]:parseInt(a[0]),l=1==a.length?s:isNaN(a[1])?a[1]:parseInt(a[1]);if(r.quantifier={min:s,max:l},0<n.length){var c=n[n.length-1].matches;if(!(e=c.pop()).isGroup)(o=new d(!0)).matches.push(e),e=o;c.push(e),c.push(r)}else{if(!(e=i.matches.pop()).isGroup)(o=new d(!0)).matches.push(e),e=o;i.matches.push(e),i.matches.push(r)}break;default:0<n.length?n[n.length-1].matches.push(t):i.matches.push(t)}0<i.matches.length&&u.regexTokens.push(i)}();var o=t.buffer.slice(),m="",r=!1,v=0;o.splice(i,0,e);for(var y=o.join(""),a=0;a<u.regexTokens.length;a++){var d;if(r=g(d=u.regexTokens[a],d.isGroup))break}return r},cardinality:1}}}}),b.fn.inputmask}(jQuery),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(window.jQuery)}(function(l){"use strict";var n=0;l.ajaxTransport("iframe",function(o){if(o.async){var r,a,t,s=o.initialIframeSrc||"javascript:false;";return{send:function(e,i){(r=l('<form style="display:none;"></form>')).attr("accept-charset",o.formAcceptCharset),t=/\?/.test(o.url)?"&":"?","DELETE"===o.type?(o.url=o.url+t+"_method=DELETE",o.type="POST"):"PUT"===o.type?(o.url=o.url+t+"_method=PUT",o.type="POST"):"PATCH"===o.type&&(o.url=o.url+t+"_method=PATCH",o.type="POST"),a=l('<iframe src="'+s+'" name="iframe-transport-'+(n+=1)+'"></iframe>').bind("load",function(){var n,t=l.isArray(o.paramName)?o.paramName:[o.paramName];a.unbind("load").bind("load",function(){var t;try{if(!(t=a.contents()).length||!t[0].firstChild)throw new Error}catch(e){t=void 0}i(200,"success",{iframe:t}),l('<iframe src="'+s+'"></iframe>').appendTo(r),window.setTimeout(function(){r.remove()},0)}),r.prop("target",a.prop("name")).prop("action",o.url).prop("method",o.type),o.formData&&l.each(o.formData,function(e,t){l('<input type="hidden"/>').prop("name",t.name).val(t.value).appendTo(r)}),o.fileInput&&o.fileInput.length&&"POST"===o.type&&(n=o.fileInput.clone(),o.fileInput.after(function(e){return n[e]}),o.paramName&&o.fileInput.each(function(e){l(this).prop("name",t[e]||o.paramName)}),r.append(o.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),o.fileInput.removeAttr("form")),r.submit(),n&&n.length&&o.fileInput.each(function(e,t){var i=l(n[e]);l(t).prop("name",i.prop("name")).attr("form",i.attr("form")),i.replaceWith(t)})}),r.append(a).appendTo(document.body)},abort:function(){a&&a.unbind("load").prop("src",s),r&&r.remove()}}}}),l.ajaxSetup({converters:{"iframe text":function(e){return e&&l(e[0].body).text()},"iframe json":function(e){return e&&l.parseJSON(l(e[0].body).text())},"iframe html":function(e){return e&&l(e[0].body).html()},"iframe xml":function(e){var t=e&&e[0];return t&&l.isXMLDoc(t)?t:l.parseXML(t.XMLDocument&&t.XMLDocument.xml||l(t.body).html())},"iframe script":function(e){return e&&l.globalEval(l(e[0].body).text())}}})}),function(){function t(e,t){return function(){return e.apply(t,arguments)}}var e;function i(e){this.el=e,this.dragleave=t(this.dragleave,this),this.dragenter=t(this.dragenter,this),this.supportsEventConstructors()&&(this.first=!1,this.second=!1,this.el.addEventListener("dragenter",this.dragenter,!1),this.el.addEventListener("dragleave",this.dragleave,!1))}i.prototype.dragenter=function(e){return this.first?this.second=!0:(this.first=!0,this.el.dispatchEvent(new CustomEvent("dragster:enter",{bubbles:!0,cancelable:!0,detail:{dataTransfer:e.dataTransfer}})))},i.prototype.dragleave=function(e){if(this.second?this.second=!1:this.first&&(this.first=!1),!this.first&&!this.second)return this.el.dispatchEvent(new CustomEvent("dragster:leave",{bubbles:!0,cancelable:!0,detail:{dataTransfer:e.dataTransfer}}))},i.prototype.removeListeners=function(){return this.el.removeEventListener("dragenter",this.dragenter,!1),this.el.removeEventListener("dragleave",this.dragleave,!1)},i.prototype.supportsEventConstructors=function(){try{new CustomEvent("z")}catch(e){return!1}return!0},i.prototype.reset=function(){return this.first=!1,this.second=!1},e=i,"undefined"==typeof module?window.Dragster=e:module.exports=e}.call(this),function(){var e;function t(e,t){var i,o;null==t&&(t=[]),i={script:null,ajaxQueue:!1,autoUpload:!1,classDragOver:"is-dragover",onUploadingFiles:function(e,t){},onSelectFiles:function(e,t){},onSuccessFile:function(e,t,i){},onComplete:function(e,t){},onFileError:function(e,t){},onFileFail:function(e,t){}},this.options=$.extend(i,t),this.files=[],$.each($(e),(o=this,function(e,t){var i,n;return n=(i=$(t)).find("input[type=file]"),i.data("pos",e),n.on("change",function(e){var t;if(t=$(e.currentTarget).prop("files"),o.options.onSelectFiles(t,i),o.files[i.data("pos")]=e.target.files,o.options.autoUpload)return o.submit(i,e.target.files)}),o.initDrag(i)}))}return t.prototype.initDrag=function(t){var i,n,e,o;if(this.isAdvancedUpload())return i=!1,t.on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}).on("dragover dragenter",(o=this,function(){t.addClass(o.options.classDragOver)})).on("dragleave dragend drop",(e=this,function(){t.removeClass(e.options.classDragOver)})).on("drop",(n=this,function(e){return i=e.originalEvent.dataTransfer.files,n.options.onSelectFiles(i,t),n.options.autoUpload?n.submit(t,i):n.files[t.data("pos")]=i}))},t.prototype.startUpload=function(e){var t;if(t=this.files[e.data("pos")])return this.submit(e,t)},t.prototype.submit=function(i,t){var e,n,o,r,a,s,l,c,u,d;if(i.hasClass("is-uploading"))return!1;for(i.addClass("is-uploading"),u=t.length,d=1,o=i.find("input[type=file]").attr("name"),this.options.onUploadingFiles(d,u),c=[],a=r=0,s=t.length;r<s;a=++r)n=t[a],(l=new FormData).append(o+"[]",n),l.append("position",a),e=this.options.ajaxQueue?$.ajaxQueue:$.ajax,c.push(e({url:this.options.script,type:"POST",data:l,processData:!1,contentType:!1,cache:!1,complete:function(e){return function(){return u+1<=++d?(e.options.onComplete(t,i),e.removeFiles(i),i.removeClass("is-uploading")):e.options.onUploadingFiles(d,u)}}(this),success:function(t){return function(e){t.options.onSuccessFile(n,e,i)}}(this),fail:function(t){return function(e){t.options.onFileFail(e,i)}}(this),error:function(t){return function(e){t.options.onFileError(e,i)}}(this)}));return c},t.prototype.removeFiles=function(e){return this.files[e.data("pos")]=null},t.prototype.isAdvancedUpload=function(){var e;return("draggable"in(e=document.createElement("div"))||"ondragstart"in e&&"ondrop"in e)&&"FormData"in window&&"FileReader"in window},t.prototype.isFormData=function(){return"FormData"in window},t.prototype.isFileReader=function(){return"FileReader"in window},t.prototype.isDraggable=function(){var e;return"draggable"in(e=document.createElement("div"))||"ondragstart"in e&&"ondrop"in e},e=t,"undefined"==typeof module?window.Dropzone=e:module.exports=e,e}.call(this),window="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},document=window.document||{},function(e,t){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):e(t.jQuery)}(function(_){"use strict";var n=0,a={},s={},A=window.emojione,o=[];function r(e){A?e():o.push(e)}var E,x,l,S="data:image/gif;base64,R0lGODlhAQABAJH/AP///wAAAMDAwAAAACH5BAEAAAIALAAAAAABAAEAAAICVAEAOw==",c=[].slice,T="emojionearea",D=0,k="&#8203;";function R(i,e,n){var o=!0,t=1;if(e){e=e.toLowerCase();do{var r=1==t?"@"+e:e;a[i.id][r]&&a[i.id][r].length&&_.each(a[i.id][r],function(e,t){return o=!1!==t.apply(i,n||[])})}while(o&&t--)}return o}function O(i,n,o,r){r=r||function(e,t){return _(t.currentTarget)},_.each(o,function(e,t){e=_.isArray(o)?t:e,(s[i.id][t]||(s[i.id][t]=[])).push([n,e,r])})}function u(e,t,i){var n,o=A.imageType;n="svg"==o?A.imagePathSVG:A.imagePathPNG;var r="";i&&(r=i.substr(1,i.length-2).replace(/_/g," ").replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}));var a="";return t.uc_base&&4<D?(a=t.uc_base,t=t.uc_output.toUpperCase()):a=t,e=e.replace("{name}",i||"").replace("{friendlyName}",r).replace("{img}",n+(D<2?a.toUpperCase():a)+"."+o).replace("{uni}",t),e=i?e.replace("{alt}",A.shortnameToUnicode(i)):e.replace("{alt}",A.convert(t))}function N(e,i,n){return e.replace(/:?\+?[\w_\-]+:?/g,function(e){e=":"+e.replace(/:$/,"").replace(/^:/,"")+":";var t=A.emojioneList[e];return t?4<D?u(i,t,e):(3<D&&(t=t.unicode),u(i,t[t.length-1],e)):n?"":e})}function F(e){var t,i;if(window.getSelection){if((t=window.getSelection()).getRangeAt&&t.rangeCount){(i=t.getRangeAt(0)).deleteContents();var n=document.createElement("div");n.innerHTML=e;for(var o,r,a=document.createDocumentFragment();o=n.firstChild;)r=a.appendChild(o);i.insertNode(a),r&&((i=i.cloneRange()).setStartAfter(r),i.collapse(!0),t.removeAllRanges(),t.addRange(i))}}else document.selection&&"Control"!=document.selection.type&&document.selection.createRange().pasteHTML(e)}function d(){return window.emojioneVersion||"3.1.2"}function M(e){return"object"==typeof e}function h(e){var t;return e.cacheBustParam?(t=e.cacheBustParam,M(e.jsEscapeMap)?"?v=1.2.4"===t?"2.0.0":"?v=2.0.1"===t?"2.1.0":"?v=2.1.1"===t?"2.1.1":"?v=2.1.2"===t?"2.1.2":"?v=2.1.3"===t?"2.1.3":"?v=2.1.4"===t?"2.1.4":"2.2.7":"1.5.2"):e.emojiVersion}function p(e){switch(e){case"1.5.2":return 0;case"2.0.0":return 1;case"2.1.0":case"2.1.1":return 2;case"2.1.2":return 3;case"2.1.3":case"2.1.4":case"2.2.7":return 4;case"3.0.1":case"3.0.2":case"3.0.3":case"3.0":return 5;case"3.1.0":case"3.1.1":case"3.1.2":case"3.1":default:return 6}}function i(){if(_.fn.emojioneArea&&_.fn.emojioneArea.defaults)return _.fn.emojioneArea.defaults;var e={attributes:{dir:"ltr",spellcheck:!1,autocomplete:"off",autocorrect:"off",autocapitalize:"off"},search:!0,placeholder:null,emojiPlaceholder:":smiley:",searchPlaceholder:"SEARCH",container:null,hideSource:!0,shortnames:!0,sprite:!0,pickerPosition:"top",filtersPosition:"top",searchPosition:"top",hidePickerOnBlur:!0,buttonTitle:"Use the TAB key to insert emoji faster",tones:!0,tonesStyle:"bullet",inline:null,saveEmojisAs:"unicode",shortcuts:!0,autocomplete:!0,autocompleteTones:!1,standalone:!1,useInternalCDN:!0,imageType:"png",recentEmojis:!0,textcomplete:{maxCount:15,placement:null}},t=p(A?h(A):d());return e.filters=4<t?{tones:{title:"Diversity",emoji:"open_hands raised_hands palms_up_together clap pray thumbsup thumbsdown punch fist left_facing_fist right_facing_fist fingers_crossed v metal love_you_gesture ok_hand point_left point_right point_up_2 point_down point_up raised_hand raised_back_of_hand hand_splayed vulcan wave call_me muscle middle_finger writing_hand selfie nail_care ear nose baby boy girl man woman blond-haired_woman blond-haired_man older_man older_woman man_with_chinese_cap woman_wearing_turban man_wearing_turban woman_police_officer man_police_officer woman_construction_worker man_construction_worker woman_guard man_guard woman_detective man_detective woman_health_worker man_health_worker woman_farmer man_farmer woman_cook man_cook woman_student man_student woman_singer man_singer woman_teacher man_teacher woman_factory_worker man_factory_worker woman_technologist man_technologist woman_office_worker man_office_worker woman_mechanic man_mechanic woman_scientist man_scientist woman_artist man_artist woman_firefighter man_firefighter woman_pilot man_pilot woman_astronaut man_astronaut woman_judge man_judge mrs_claus santa princess prince bride_with_veil man_in_tuxedo angel pregnant_woman breast_feeding woman_bowing man_bowing man_tipping_hand woman_tipping_hand man_gesturing_no woman_gesturing_no man_gesturing_ok woman_gesturing_ok man_raising_hand woman_raising_hand woman_facepalming man_facepalming woman_shrugging man_shrugging man_pouting woman_pouting man_frowning woman_frowning man_getting_haircut woman_getting_haircut man_getting_face_massage woman_getting_face_massage man_in_business_suit_levitating dancer man_dancing woman_walking man_walking woman_running man_running adult child older_adult bearded_person woman_with_headscarf woman_mage man_mage woman_fairy man_fairy woman_vampire man_vampire mermaid merman woman_elf man_elf snowboarder woman_lifting_weights man_lifting_weights woman_cartwheeling man_cartwheeling woman_bouncing_ball man_bouncing_ball woman_playing_handball man_playing_handball woman_golfing man_golfing woman_surfing man_surfing woman_swimming man_swimming woman_playing_water_polo man_playing_water_polo woman_rowing_boat man_rowing_boat horse_racing woman_biking man_biking woman_mountain_biking man_mountain_biking woman_juggling man_juggling woman_in_steamy_room man_in_steamy_room woman_climbing man_climbing woman_in_lotus_position man_in_lotus_position bath person_in_bed"},recent:{icon:"clock3",title:"Recent",emoji:""},smileys_people:{icon:"yum",title:"Smileys & People",emoji:"grinning smiley smile grin laughing sweat_smile joy rofl relaxed blush innocent slight_smile upside_down wink relieved crazy_face star_struck heart_eyes kissing_heart kissing kissing_smiling_eyes kissing_closed_eyes yum stuck_out_tongue_winking_eye stuck_out_tongue_closed_eyes stuck_out_tongue money_mouth hugging nerd sunglasses cowboy smirk unamused disappointed pensive worried face_with_raised_eyebrow face_with_monocle confused slight_frown frowning2 persevere confounded tired_face weary triumph angry rage face_with_symbols_over_mouth no_mouth neutral_face expressionless hushed frowning anguished open_mouth astonished dizzy_face exploding_head flushed scream fearful cold_sweat cry disappointed_relieved drooling_face sob sweat sleepy sleeping rolling_eyes thinking shushing_face face_with_hand_over_mouth lying_face grimacing zipper_mouth face_vomiting nauseated_face sneezing_face mask thermometer_face head_bandage smiling_imp imp japanese_ogre japanese_goblin poop ghost skull skull_crossbones alien space_invader robot jack_o_lantern clown smiley_cat smile_cat joy_cat heart_eyes_cat smirk_cat kissing_cat scream_cat crying_cat_face pouting_cat open_hands raised_hands palms_up_together clap pray handshake thumbsup thumbsdown punch fist left_facing_fist right_facing_fist fingers_crossed v metal love_you_gesture ok_hand point_left point_right point_up_2 point_down point_up raised_hand raised_back_of_hand hand_splayed vulcan wave call_me muscle middle_finger writing_hand selfie nail_care ring lipstick kiss lips tongue ear nose footprints eye eyes speaking_head bust_in_silhouette busts_in_silhouette baby boy girl man woman blond-haired_woman blond_haired_man older_man older_woman man_with_chinese_cap woman_wearing_turban man_wearing_turban woman_police_officer police_officer woman_construction_worker construction_worker woman_guard guard woman_detective detective woman_health_worker man_health_worker woman_farmer man_farmer woman_cook man_cook woman_student man_student woman_singer man_singer woman_teacher man_teacher woman_factory_worker man_factory_worker woman_technologist man_technologist woman_office_worker man_office_worker woman_mechanic man_mechanic woman_scientist man_scientist woman_artist man_artist woman_firefighter man_firefighter woman_pilot man_pilot woman_astronaut man_astronaut woman_judge man_judge mrs_claus santa princess prince bride_with_veil man_in_tuxedo angel pregnant_woman breast_feeding woman_bowing man_bowing woman_tipping_hand man_tipping_hand woman_gesturing_no man_gesturing_no woman_gesturing_ok man_gesturing_ok woman_raising_hand man_raising_hand woman_facepalming man_facepalming woman_shrugging man_shrugging woman_pouting man_pouting woman_frowning man_frowning woman_getting_haircut man_getting_haircut woman_getting_face_massage man_getting_face_massage man_in_business_suit_levitating dancer man_dancing women_with_bunny_ears_partying men_with_bunny_ears_partying woman_walking man_walking woman_running man_running couple two_women_holding_hands two_men_holding_hands couple_with_heart couple_ww couple_mm couplekiss kiss_ww kiss_mm family family_mwg family_mwgb family_mwbb family_mwgg family_wwb family_wwg family_wwgb family_wwbb family_wwgg family_mmb family_mmg family_mmgb family_mmbb family_mmgg family_woman_boy family_woman_girl family_woman_girl_boy family_woman_boy_boy family_woman_girl_girl family_man_boy family_man_girl family_man_girl_boy family_man_boy_boy family_man_girl_girl bearded_person woman_with_headscarf woman_mage man_mage woman_fairy man_fairy woman_vampire man_vampire mermaid merman woman_elf man_elf woman_genie man_genie woman_zombie man_zombie womans_clothes shirt jeans necktie dress bikini kimono high_heel sandal boot mans_shoe athletic_shoe womans_hat tophat mortar_board crown helmet_with_cross school_satchel pouch purse handbag briefcase eyeglasses dark_sunglasses closed_umbrella umbrella2 brain billed_cap scarf gloves coat socks "},animals_nature:{icon:"hamster",title:"Animals & Nature",emoji:"dog cat mouse hamster rabbit fox bear panda_face koala tiger lion_face cow pig pig_nose frog monkey_face see_no_evil hear_no_evil speak_no_evil monkey chicken penguin bird baby_chick hatching_chick hatched_chick duck eagle owl bat wolf boar horse unicorn bee bug butterfly snail shell beetle ant spider spider_web turtle snake lizard scorpion crab squid octopus shrimp tropical_fish fish blowfish dolphin shark whale whale2 crocodile leopard tiger2 water_buffalo ox cow2 deer dromedary_camel camel elephant rhino gorilla racehorse pig2 goat ram sheep dog2 poodle cat2 rooster turkey dove rabbit2 mouse2 rat chipmunk dragon giraffe zebra hedgehog sauropod t_rex cricket dragon_face feet cactus christmas_tree evergreen_tree deciduous_tree palm_tree seedling herb shamrock four_leaf_clover bamboo tanabata_tree leaves fallen_leaf maple_leaf mushroom ear_of_rice bouquet tulip rose wilted_rose sunflower blossom cherry_blossom hibiscus earth_americas earth_africa earth_asia full_moon waning_gibbous_moon last_quarter_moon waning_crescent_moon new_moon waxing_crescent_moon first_quarter_moon waxing_gibbous_moon new_moon_with_face full_moon_with_face sun_with_face first_quarter_moon_with_face last_quarter_moon_with_face crescent_moon dizzy star star2 sparkles zap fire boom comet sunny white_sun_small_cloud partly_sunny white_sun_cloud white_sun_rain_cloud rainbow cloud cloud_rain thunder_cloud_rain cloud_lightning cloud_snow snowman2 snowman snowflake wind_blowing_face dash cloud_tornado fog ocean droplet sweat_drops umbrella "},food_drink:{icon:"pizza",title:"Food & Drink",emoji:"green_apple apple pear tangerine lemon banana watermelon grapes strawberry melon cherries peach pineapple kiwi avocado tomato eggplant cucumber carrot corn hot_pepper potato sweet_potato chestnut peanuts honey_pot croissant bread french_bread cheese egg cooking bacon pancakes fried_shrimp poultry_leg meat_on_bone pizza hotdog hamburger fries stuffed_flatbread taco burrito salad shallow_pan_of_food spaghetti ramen stew fish_cake sushi bento curry rice_ball rice rice_cracker oden dango shaved_ice ice_cream icecream cake birthday custard lollipop candy chocolate_bar popcorn doughnut cookie milk baby_bottle coffee tea sake beer beers champagne_glass wine_glass tumbler_glass cocktail tropical_drink champagne spoon fork_and_knife fork_knife_plate dumpling fortune_cookie takeout_box chopsticks bowl_with_spoon cup_with_straw coconut broccoli pie pretzel cut_of_meat sandwich canned_food"},activity:{icon:"basketball",title:"Activity",emoji:"soccer basketball football baseball tennis volleyball rugby_football 8ball ping_pong badminton goal hockey field_hockey cricket_game golf bow_and_arrow fishing_pole_and_fish boxing_glove martial_arts_uniform ice_skate ski skier snowboarder woman_lifting_weights man_lifting_weights person_fencing women_wrestling men_wrestling woman_cartwheeling man_cartwheeling woman_bouncing_ball man_bouncing_ball woman_playing_handball man_playing_handball woman_golfing man_golfing woman_surfing man_surfing woman_swimming man_swimming woman_playing_water_polo man_playing_water_polo woman_rowing_boat man_rowing_boat horse_racing woman_biking man_biking woman_mountain_biking man_mountain_biking woman_in_steamy_room man_in_steamy_room woman_climbing man_climbing woman_in_lotus_position man_in_lotus_position running_shirt_with_sash medal military_medal first_place second_place third_place trophy rosette reminder_ribbon ticket tickets circus_tent woman_juggling man_juggling performing_arts art clapper microphone headphones musical_score musical_keyboard drum saxophone trumpet guitar violin game_die dart bowling video_game slot_machine sled curling_stone "},travel_places:{icon:"rocket",title:"Travel & Places",emoji:"red_car taxi blue_car bus trolleybus race_car police_car ambulance fire_engine minibus truck articulated_lorry tractor scooter bike motor_scooter motorcycle rotating_light oncoming_police_car oncoming_bus oncoming_automobile oncoming_taxi aerial_tramway mountain_cableway suspension_railway railway_car train mountain_railway monorail bullettrain_side bullettrain_front light_rail steam_locomotive train2 metro tram station helicopter airplane_small airplane airplane_departure airplane_arriving rocket satellite_orbital seat canoe sailboat motorboat speedboat cruise_ship ferry ship anchor construction fuelpump busstop vertical_traffic_light traffic_light map moyai statue_of_liberty fountain tokyo_tower european_castle japanese_castle stadium ferris_wheel roller_coaster carousel_horse beach_umbrella beach island mountain mountain_snow mount_fuji volcano desert camping tent railway_track motorway construction_site factory house house_with_garden homes house_abandoned office department_store post_office european_post_office hospital bank hotel convenience_store school love_hotel wedding classical_building church mosque synagogue kaaba shinto_shrine japan rice_scene park sunrise sunrise_over_mountains stars sparkler fireworks city_sunset city_dusk cityscape night_with_stars milky_way bridge_at_night foggy flying_saucer"},objects:{icon:"bulb",title:"Objects",emoji:"watch iphone calling computer keyboard desktop printer mouse_three_button trackball joystick compression minidisc floppy_disk cd dvd vhs camera camera_with_flash video_camera movie_camera projector film_frames telephone_receiver telephone pager fax tv radio microphone2 level_slider control_knobs stopwatch timer alarm_clock clock hourglass hourglass_flowing_sand satellite battery electric_plug bulb flashlight candle wastebasket oil money_with_wings dollar yen euro pound moneybag credit_card gem scales wrench hammer hammer_pick tools pick nut_and_bolt gear chains gun bomb knife dagger crossed_swords shield smoking coffin urn amphora crystal_ball prayer_beads barber alembic telescope microscope hole pill syringe thermometer toilet potable_water shower bathtub bath bellhop key key2 door couch bed sleeping_accommodation frame_photo shopping_bags shopping_cart gift balloon flags ribbon confetti_ball tada dolls izakaya_lantern wind_chime envelope envelope_with_arrow incoming_envelope e-mail love_letter inbox_tray outbox_tray package label mailbox_closed mailbox mailbox_with_mail mailbox_with_no_mail postbox postal_horn scroll page_with_curl page_facing_up bookmark_tabs bar_chart chart_with_upwards_trend chart_with_downwards_trend notepad_spiral calendar_spiral calendar date card_index card_box ballot_box file_cabinet clipboard file_folder open_file_folder dividers newspaper2 newspaper notebook notebook_with_decorative_cover ledger closed_book green_book blue_book orange_book books book bookmark link paperclip paperclips triangular_ruler straight_ruler pushpin round_pushpin scissors pen_ballpoint pen_fountain black_nib paintbrush crayon pencil pencil2 mag mag_right lock_with_ink_pen closed_lock_with_key lock unlock"},symbols:{icon:"heartpulse",title:"Symbols",emoji:"heart orange_heart yellow_heart green_heart blue_heart purple_heart black_heart broken_heart heart_exclamation two_hearts revolving_hearts heartbeat heartpulse sparkling_heart cupid gift_heart heart_decoration peace cross star_and_crescent om_symbol wheel_of_dharma star_of_david six_pointed_star menorah yin_yang orthodox_cross place_of_worship ophiuchus aries taurus gemini cancer leo virgo libra scorpius sagittarius capricorn aquarius pisces id atom accept radioactive biohazard mobile_phone_off vibration_mode u6709 u7121 u7533 u55b6 u6708 eight_pointed_black_star vs white_flower ideograph_advantage secret congratulations u5408 u6e80 u5272 u7981 a b ab cl o2 sos x o octagonal_sign no_entry name_badge no_entry_sign 100 anger hotsprings no_pedestrians do_not_litter no_bicycles non-potable_water underage no_mobile_phones no_smoking exclamation grey_exclamation question grey_question bangbang interrobang low_brightness high_brightness part_alternation_mark warning children_crossing trident fleur-de-lis beginner recycle white_check_mark u6307 chart sparkle eight_spoked_asterisk negative_squared_cross_mark globe_with_meridians diamond_shape_with_a_dot_inside m cyclone zzz atm wc wheelchair parking u7a7a sa passport_control customs baggage_claim left_luggage mens womens baby_symbol restroom put_litter_in_its_place cinema signal_strength koko symbols information_source abc abcd capital_abcd ng ok up cool new free zero one two three four five six seven eight nine keycap_ten 1234 hash asterisk arrow_forward pause_button play_pause stop_button record_button eject track_next track_previous fast_forward rewind arrow_double_up arrow_double_down arrow_backward arrow_up_small arrow_down_small arrow_right arrow_left arrow_up arrow_down arrow_upper_right arrow_lower_right arrow_lower_left arrow_upper_left arrow_up_down left_right_arrow arrow_right_hook leftwards_arrow_with_hook arrow_heading_up arrow_heading_down twisted_rightwards_arrows repeat repeat_one arrows_counterclockwise arrows_clockwise musical_note notes heavy_plus_sign heavy_minus_sign heavy_division_sign heavy_multiplication_x heavy_dollar_sign currency_exchange tm copyright registered wavy_dash curly_loop loop end back on top soon heavy_check_mark ballot_box_with_check radio_button white_circle black_circle red_circle blue_circle small_red_triangle small_red_triangle_down small_orange_diamond small_blue_diamond large_orange_diamond large_blue_diamond white_square_button black_square_button black_small_square white_small_square black_medium_small_square white_medium_small_square black_medium_square white_medium_square black_large_square white_large_square speaker mute sound loud_sound bell no_bell mega loudspeaker speech_left eye_in_speech_bubble speech_balloon thought_balloon anger_right spades clubs hearts diamonds black_joker flower_playing_cards mahjong clock1 clock2 clock3 clock4 clock5 clock6 clock7 clock8 clock9 clock10 clock11 clock12 clock130 clock230 clock330 clock430 clock530 clock630 clock730 clock830 clock930 clock1030 clock1130 clock1230"},flags:{icon:"flag_gb",title:"Flags",emoji:"flag_white flag_black checkered_flag triangular_flag_on_post rainbow_flag flag_af flag_ax flag_al flag_dz flag_as flag_ad flag_ao flag_ai flag_aq flag_ag flag_ar flag_am flag_aw flag_au flag_at flag_az flag_bs flag_bh flag_bd flag_bb flag_by flag_be flag_bz flag_bj flag_bm flag_bt flag_bo flag_ba flag_bw flag_br flag_io flag_vg flag_bn flag_bg flag_bf flag_bi flag_kh flag_cm flag_ca flag_ic flag_cv flag_bq flag_ky flag_cf flag_td flag_cl flag_cn flag_cx flag_cc flag_co flag_km flag_cg flag_cd flag_ck flag_cr flag_ci flag_hr flag_cu flag_cw flag_cy flag_cz flag_dk flag_dj flag_dm flag_do flag_ec flag_eg flag_sv flag_gq flag_er flag_ee flag_et flag_eu flag_fk flag_fo flag_fj flag_fi flag_fr flag_gf flag_pf flag_tf flag_ga flag_gm flag_ge flag_de flag_gh flag_gi flag_gr flag_gl flag_gd flag_gp flag_gu flag_gt flag_gg flag_gn flag_gw flag_gy flag_ht flag_hn flag_hk flag_hu flag_is flag_in flag_id flag_ir flag_iq flag_ie flag_im flag_il flag_it flag_jm flag_jp crossed_flags flag_je flag_jo flag_kz flag_ke flag_ki flag_xk flag_kw flag_kg flag_la flag_lv flag_lb flag_ls flag_lr flag_ly flag_li flag_lt flag_lu flag_mo flag_mk flag_mg flag_mw flag_my flag_mv flag_ml flag_mt flag_mh flag_mq flag_mr flag_mu flag_yt flag_mx flag_fm flag_md flag_mc flag_mn flag_me flag_ms flag_ma flag_mz flag_mm flag_na flag_nr flag_np flag_nl flag_nc flag_nz flag_ni flag_ne flag_ng flag_nu flag_nf flag_kp flag_mp flag_no flag_om flag_pk flag_pw flag_ps flag_pa flag_pg flag_py flag_pe flag_ph flag_pn flag_pl flag_pt flag_pr flag_qa flag_re flag_ro flag_ru flag_rw flag_ws flag_sm flag_st flag_sa flag_sn flag_rs flag_sc flag_sl flag_sg flag_sx flag_sk flag_si flag_gs flag_sb flag_so flag_za flag_kr flag_ss flag_es flag_lk flag_bl flag_sh flag_kn flag_lc flag_pm flag_vc flag_sd flag_sr flag_sz flag_se flag_ch flag_sy flag_tw flag_tj flag_tz flag_th flag_tl flag_tg flag_tk flag_to flag_tt flag_tn flag_tr flag_tm flag_tc flag_tv flag_vi flag_ug flag_ua flag_ae flag_gb flag_us flag_uy flag_uz flag_vu flag_va flag_ve flag_vn flag_wf flag_eh flag_ye flag_zm flag_zw flag_ac flag_ta flag_bv flag_hm flag_sj flag_um flag_ea flag_cp flag_dg flag_mf united_nations england scotland wales"}}:{tones:{title:"Diversity",emoji:"santa runner surfer swimmer lifter ear nose point_up_2 point_down point_left point_right punch wave ok_hand thumbsup thumbsdown clap open_hands boy girl man woman cop bride_with_veil person_with_blond_hair man_with_gua_pi_mao man_with_turban older_man grandma baby construction_worker princess angel information_desk_person guardsman dancer nail_care massage haircut muscle spy hand_splayed middle_finger vulcan no_good ok_woman bow raising_hand raised_hands person_frowning person_with_pouting_face pray rowboat bicyclist mountain_bicyclist walking bath metal point_up basketball_player fist raised_hand v writing_hand"},recent:{icon:"clock3",title:"Recent",emoji:""},smileys_people:{icon:"yum",title:"Smileys & People",emoji:"grinning grimacing grin joy smiley smile sweat_smile laughing innocent wink blush slight_smile upside_down relaxed yum relieved heart_eyes kissing_heart kissing kissing_smiling_eyes kissing_closed_eyes stuck_out_tongue_winking_eye stuck_out_tongue_closed_eyes stuck_out_tongue money_mouth nerd sunglasses hugging smirk no_mouth neutral_face expressionless unamused rolling_eyes thinking flushed disappointed worried angry rage pensive confused slight_frown frowning2 persevere confounded tired_face weary triumph open_mouth scream fearful cold_sweat hushed frowning anguished cry disappointed_relieved sleepy sweat sob dizzy_face astonished zipper_mouth mask thermometer_face head_bandage sleeping zzz poop smiling_imp imp japanese_ogre japanese_goblin skull ghost alien robot smiley_cat smile_cat joy_cat heart_eyes_cat smirk_cat kissing_cat scream_cat crying_cat_face pouting_cat raised_hands clap wave thumbsup thumbsdown punch fist v ok_hand raised_hand open_hands muscle pray point_up point_up_2 point_down point_left point_right middle_finger hand_splayed metal vulcan writing_hand nail_care lips tongue ear nose eye eyes bust_in_silhouette busts_in_silhouette speaking_head baby boy girl man woman person_with_blond_hair older_man older_woman man_with_gua_pi_mao man_with_turban cop construction_worker guardsman spy santa angel princess bride_with_veil walking runner dancer dancers couple two_men_holding_hands two_women_holding_hands bow information_desk_person no_good ok_woman raising_hand person_with_pouting_face person_frowning haircut massage couple_with_heart couple_ww couple_mm couplekiss kiss_ww kiss_mm family family_mwg family_mwgb family_mwbb family_mwgg family_wwb family_wwg family_wwgb family_wwbb family_wwgg family_mmb family_mmg family_mmgb family_mmbb family_mmgg womans_clothes shirt jeans necktie dress bikini kimono lipstick kiss footprints high_heel sandal boot mans_shoe athletic_shoe womans_hat tophat helmet_with_cross mortar_board crown school_satchel pouch purse handbag briefcase eyeglasses dark_sunglasses ring closed_umbrella"},animals_nature:{icon:"hamster",title:"Animals & Nature",emoji:"dog cat mouse hamster rabbit bear panda_face koala tiger lion_face cow pig pig_nose frog octopus monkey_face see_no_evil hear_no_evil speak_no_evil monkey chicken penguin bird baby_chick hatching_chick hatched_chick wolf boar horse unicorn bee bug snail beetle ant spider scorpion crab snake turtle tropical_fish fish blowfish dolphin whale whale2 crocodile leopard tiger2 water_buffalo ox cow2 dromedary_camel camel elephant goat ram sheep racehorse pig2 rat mouse2 rooster turkey dove dog2 poodle cat2 rabbit2 chipmunk feet dragon dragon_face cactus christmas_tree evergreen_tree deciduous_tree palm_tree seedling herb shamrock four_leaf_clover bamboo tanabata_tree leaves fallen_leaf maple_leaf ear_of_rice hibiscus sunflower rose tulip blossom cherry_blossom bouquet mushroom chestnut jack_o_lantern shell spider_web earth_americas earth_africa earth_asia full_moon waning_gibbous_moon last_quarter_moon waning_crescent_moon new_moon waxing_crescent_moon first_quarter_moon waxing_gibbous_moon new_moon_with_face full_moon_with_face first_quarter_moon_with_face last_quarter_moon_with_face sun_with_face crescent_moon star star2 dizzy sparkles comet sunny white_sun_small_cloud partly_sunny white_sun_cloud white_sun_rain_cloud cloud cloud_rain thunder_cloud_rain cloud_lightning zap fire boom snowflake cloud_snow snowman2 snowman wind_blowing_face dash cloud_tornado fog umbrella2 umbrella droplet sweat_drops ocean"},food_drink:{icon:"pizza",title:"Food & Drink",emoji:"green_apple apple pear tangerine lemon banana watermelon grapes strawberry melon cherries peach pineapple tomato eggplant hot_pepper corn sweet_potato honey_pot bread cheese poultry_leg meat_on_bone fried_shrimp egg hamburger fries hotdog pizza spaghetti taco burrito ramen stew fish_cake sushi bento curry rice_ball rice rice_cracker oden dango shaved_ice ice_cream icecream cake birthday custard candy lollipop chocolate_bar popcorn doughnut cookie beer beers wine_glass cocktail tropical_drink champagne sake tea coffee baby_bottle fork_and_knife fork_knife_plate"},activity:{icon:"basketball",title:"Activity",emoji:"soccer basketball football baseball tennis volleyball rugby_football 8ball golf golfer ping_pong badminton hockey field_hockey cricket ski skier snowboarder ice_skate bow_and_arrow fishing_pole_and_fish rowboat swimmer surfer bath basketball_player lifter bicyclist mountain_bicyclist horse_racing levitate trophy running_shirt_with_sash medal military_medal reminder_ribbon rosette ticket tickets performing_arts art circus_tent microphone headphones musical_score musical_keyboard saxophone trumpet guitar violin clapper video_game space_invader dart game_die slot_machine bowling"},travel_places:{icon:"rocket",title:"Travel & Places",emoji:"red_car taxi blue_car bus trolleybus race_car police_car ambulance fire_engine minibus truck articulated_lorry tractor motorcycle bike rotating_light oncoming_police_car oncoming_bus oncoming_automobile oncoming_taxi aerial_tramway mountain_cableway suspension_railway railway_car train monorail bullettrain_side bullettrain_front light_rail mountain_railway steam_locomotive train2 metro tram station helicopter airplane_small airplane airplane_departure airplane_arriving sailboat motorboat speedboat ferry cruise_ship rocket satellite_orbital seat anchor construction fuelpump busstop vertical_traffic_light traffic_light checkered_flag ship ferris_wheel roller_coaster carousel_horse construction_site foggy tokyo_tower factory fountain rice_scene mountain mountain_snow mount_fuji volcano japan camping tent park motorway railway_track sunrise sunrise_over_mountains desert beach island city_sunset city_dusk cityscape night_with_stars bridge_at_night milky_way stars sparkler fireworks rainbow homes european_castle japanese_castle stadium statue_of_liberty house house_with_garden house_abandoned office department_store post_office european_post_office hospital bank hotel convenience_store school love_hotel wedding classical_building church mosque synagogue kaaba shinto_shrine"},objects:{icon:"bulb",title:"Objects",emoji:"watch iphone calling computer keyboard desktop printer mouse_three_button trackball joystick compression minidisc floppy_disk cd dvd vhs camera camera_with_flash video_camera movie_camera projector film_frames telephone_receiver telephone pager fax tv radio microphone2 level_slider control_knobs stopwatch timer alarm_clock clock hourglass_flowing_sand hourglass satellite battery electric_plug bulb flashlight candle wastebasket oil money_with_wings dollar yen euro pound moneybag credit_card gem scales wrench hammer hammer_pick tools pick nut_and_bolt gear chains gun bomb knife dagger crossed_swords shield smoking skull_crossbones coffin urn amphora crystal_ball prayer_beads barber alembic telescope microscope hole pill syringe thermometer label bookmark toilet shower bathtub key key2 couch sleeping_accommodation bed door bellhop frame_photo map beach_umbrella moyai shopping_bags balloon flags ribbon gift confetti_ball tada dolls wind_chime crossed_flags izakaya_lantern envelope envelope_with_arrow incoming_envelope e-mail love_letter postbox mailbox_closed mailbox mailbox_with_mail mailbox_with_no_mail package postal_horn inbox_tray outbox_tray scroll page_with_curl bookmark_tabs bar_chart chart_with_upwards_trend chart_with_downwards_trend page_facing_up date calendar calendar_spiral card_index card_box ballot_box file_cabinet clipboard notepad_spiral file_folder open_file_folder dividers newspaper2 newspaper notebook closed_book green_book blue_book orange_book notebook_with_decorative_cover ledger books book link paperclip paperclips scissors triangular_ruler straight_ruler pushpin round_pushpin triangular_flag_on_post flag_white flag_black closed_lock_with_key lock unlock lock_with_ink_pen pen_ballpoint pen_fountain black_nib pencil pencil2 crayon paintbrush mag mag_right"},symbols:{icon:"heartpulse",title:"Symbols",emoji:"heart yellow_heart green_heart blue_heart purple_heart broken_heart heart_exclamation two_hearts revolving_hearts heartbeat heartpulse sparkling_heart cupid gift_heart heart_decoration peace cross star_and_crescent om_symbol wheel_of_dharma star_of_david six_pointed_star menorah yin_yang orthodox_cross place_of_worship ophiuchus aries taurus gemini cancer leo virgo libra scorpius sagittarius capricorn aquarius pisces id atom u7a7a u5272 radioactive biohazard mobile_phone_off vibration_mode u6709 u7121 u7533 u55b6 u6708 eight_pointed_black_star vs accept white_flower ideograph_advantage secret congratulations u5408 u6e80 u7981 a b ab cl o2 sos no_entry name_badge no_entry_sign x o anger hotsprings no_pedestrians do_not_litter no_bicycles non-potable_water underage no_mobile_phones exclamation grey_exclamation question grey_question bangbang interrobang 100 low_brightness high_brightness trident fleur-de-lis part_alternation_mark warning children_crossing beginner recycle u6307 chart sparkle eight_spoked_asterisk negative_squared_cross_mark white_check_mark diamond_shape_with_a_dot_inside cyclone loop globe_with_meridians m atm sa passport_control customs baggage_claim left_luggage wheelchair no_smoking wc parking potable_water mens womens baby_symbol restroom put_litter_in_its_place cinema signal_strength koko ng ok up cool new free zero one two three four five six seven eight nine ten 1234 arrow_forward pause_button play_pause stop_button record_button track_next track_previous fast_forward rewind twisted_rightwards_arrows repeat repeat_one arrow_backward arrow_up_small arrow_down_small arrow_double_up arrow_double_down arrow_right arrow_left arrow_up arrow_down arrow_upper_right arrow_lower_right arrow_lower_left arrow_upper_left arrow_up_down left_right_arrow arrows_counterclockwise arrow_right_hook leftwards_arrow_with_hook arrow_heading_up arrow_heading_down hash asterisk information_source abc abcd capital_abcd symbols musical_note notes wavy_dash curly_loop heavy_check_mark arrows_clockwise heavy_plus_sign heavy_minus_sign heavy_division_sign heavy_multiplication_x heavy_dollar_sign currency_exchange copyright registered tm end back on top soon ballot_box_with_check radio_button white_circle black_circle red_circle large_blue_circle small_orange_diamond small_blue_diamond large_orange_diamond large_blue_diamond small_red_triangle black_small_square white_small_square black_large_square white_large_square small_red_triangle_down black_medium_square white_medium_square black_medium_small_square white_medium_small_square black_square_button white_square_button speaker sound loud_sound mute mega loudspeaker bell no_bell black_joker mahjong spades clubs hearts diamonds flower_playing_cards thought_balloon anger_right speech_balloon clock1 clock2 clock3 clock4 clock5 clock6 clock7 clock8 clock9 clock10 clock11 clock12 clock130 clock230 clock330 clock430 clock530 clock630 clock730 clock830 clock930 clock1030 clock1130 clock1230 eye_in_speech_bubble"},flags:{icon:"flag_gb",title:"Flags",emoji:"ac af al dz ad ao ai ag ar am aw au at az bs bh bd bb by be bz bj bm bt bo ba bw br bn bg bf bi cv kh cm ca ky cf td flag_cl cn co km cg flag_cd cr hr cu cy cz dk dj dm do ec eg sv gq er ee et fk fo fj fi fr pf ga gm ge de gh gi gr gl gd gu gt gn gw gy ht hn hk hu is in flag_id ir iq ie il it ci jm jp je jo kz ke ki xk kw kg la lv lb ls lr ly li lt lu mo mk mg mw my mv ml mt mh mr mu mx fm md mc mn me ms ma mz mm na nr np nl nc nz ni ne flag_ng nu kp no om pk pw ps pa pg py pe ph pl pt pr qa ro ru rw sh kn lc vc ws sm st flag_sa sn rs sc sl sg sk si sb so za kr es lk sd sr sz se ch sy tw tj tz th tl tg to tt tn tr flag_tm flag_tm ug ua ae gb us vi uy uz vu va ve vn wf eh ye zm zw re ax ta io bq cx cc gg im yt nf pn bl pm gs tk bv hm sj um ic ea cp dg as aq vg ck cw eu gf tf gp mq mp sx ss tc "}},e}function P(e){var t=i();if(e&&e.filters){var n=t.filters;_.each(e.filters,function(i,e){M(e)&&!_.isEmptyObject(e)?_.each(e,function(e,t){n[i][e]=t}):delete n[i]}),e.filters=n}return _.extend({},t,e)}function f(e,i){return e.replace(l,function(e){var t=A[0===D?"jsecapeMap":"jsEscapeMap"];return void 0!==e&&e in t?u(i,t[e],A.toShort(e)):e})}function I(e,t){return e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/`/g,"&#x60;").replace(/(?:\r\n|\r|\n)/g,"\n").replace(/(\n+)/g,"<div>$1</div>").replace(/\n/g,"<br/>").replace(/<br\/><\/div>/g,"</div>"),t.shortnames&&(e=A.shortnameToUnicode(e)),f(e,t.emojiTemplate).replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/  /g,"&nbsp;&nbsp;")}function L(e,t){switch(e=e.replace(/&#10;/g,"\n").replace(/&#09;/g,"\t").replace(/<img[^>]*alt="([^"]+)"[^>]*>/gi,"$1").replace(/\n|\r/g,"").replace(/<br[^>]*>/gi,"\n").replace(/(?:<(?:div|p|ol|ul|li|pre|code|object)[^>]*>)+/gi,"<div>").replace(/(?:<\/(?:div|p|ol|ul|li|pre|code|object)>)+/gi,"</div>").replace(/\n<div><\/div>/gi,"\n").replace(/<div><\/div>\n/gi,"\n").replace(/(?:<div>)+<\/div>/gi,"\n").replace(/([^\n])<\/div><div>/gi,"$1\n").replace(/(?:<\/div>)+/gi,"</div>").replace(/([^\n])<\/div>([^\n])/gi,"$1\n$2").replace(/<\/div>/gi,"").replace(/([^\n])<div>/gi,"$1\n").replace(/\n<div>/gi,"\n").replace(/<div>\n/gi,"\n\n").replace(/<(?:[^>]+)?>/g,"").replace(new RegExp(k,"g"),"").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x60;/g,"`").replace(/&#60;/g,"<").replace(/&#62;/g,">").replace(/&amp;/g,"&"),t.saveEmojisAs){case"image":e=f(e,t.emojiTemplate);break;case"shortname":e=A.toShort(e)}return e}function G(){var e=this.editor[0].offsetWidth-this.editor[0].clientWidth,t=parseInt(this.button.css("marginRight"));t!==e&&(this.button.css({marginRight:e}),this.floatingPicker&&this.picker.css({right:parseInt(this.picker.css("right"))-t+e}))}function $(){if(!this.sprite&&this.lasyEmoji[0]&&this.lasyEmoji.eq(0).is(".lazy-emoji")){var i=this.picker.offset().top,n=i+this.picker.height()+20;this.lasyEmoji.each(function(){var e=_(this),t=e.offset().top;if(i<t&&t<n&&e.attr("src",e.data("src")).removeClass("lazy-emoji"),n<t)return!1}),this.lasyEmoji=this.lasyEmoji.filter(".lazy-emoji")}}function B(e,t){return(t?"":".")+T+(e?"-"+e:"")}function j(e){var i=_("<div/>",M(e)?e:{class:B(e,!0)});return _.each(c.call(arguments).slice(1),function(e,t){_.isFunction(t)&&(t=t.call(i)),t&&_(t).appendTo(i)}),i}function W(){return localStorage.getItem("recent_emojis")||""}function H(e,t){var i=W();if(!e.recent||e.recent!==i||t){if(i.length){var n,o,r=e.scrollArea.is(".skinnable");r||(n=e.scrollArea.scrollTop(),t&&e.recentCategory.show(),o=e.recentCategory.is(":visible")?e.recentCategory.height():0);var a=N(i,e.emojiBtnTemplate,!0).split("|").join("");if(e.recentCategory.children(".emojibtn").remove(),_(a).insertAfter(e.recentCategory.children(".emojionearea-category-title")),e.recentCategory.children(".emojibtn").on("click",function(){e.trigger("emojibtn.click",_(this))}),e.recentFilter.show(),!r){e.recentCategory.show();var s=e.recentCategory.height();o!==s&&e.scrollArea.scrollTop(n+s-o)}}else e.recentFilter.hasClass("active")&&e.recentFilter.removeClass("active").next().addClass("active"),e.recentCategory.hide(),e.recentFilter.hide();e.recent=i}}function g(l,t,r){l.options=r=P(r),l.sprite=r.sprite&&D<3,l.inline=null===r.inline?t.is("INPUT"):r.inline,l.shortnames=r.shortnames,l.saveEmojisAs=r.saveEmojisAs,l.standalone=r.standalone,l.emojiTemplate='<img alt="{alt}" class="emojione'+(l.sprite?'-{uni}" src="'+S+'"/>':'emoji" src="{img}"/>'),l.emojiTemplateAlt=l.sprite?'<i class="emojione-{uni}"/>':'<img class="emojioneemoji" src="{img}"/>',l.emojiBtnTemplate='<i class="emojibtn" role="button" data-name="{name}" title="{friendlyName}">'+l.emojiTemplateAlt+"</i>",l.recentEmojis=r.recentEmojis&&function(){try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),!0}catch(e){return!1}}();var e=r.pickerPosition;l.floatingPicker="top"===e||"bottom"===e,((l.source=t).is(":disabled")||t.is(".disabled"))&&l.disable();var n,i,a,s,c,o,u,d,h,p,f=t.is("TEXTAREA")||t.is("INPUT")?"val":"text",g=j("tones",r.tones?function(){this.addClass(B("tones-"+r.tonesStyle,!0));for(var e=0;e<=5;e++)this.append(_("<i/>",{class:"btn-tone btn-tone-"+e+(e?"":" active"),"data-skin":e,role:"button"}))}:null),m=j({class:T+(l.standalone?" "+T+"-standalone ":" ")+(t.attr("class")||""),role:"application"},n=l.editor=j("editor").attr({contenteditable:!l.standalone,placeholder:r.placeholder||t.data("placeholder")||t.attr("placeholder")||"",tabindex:0}),i=l.button=j("button",j("button-open"),j("button-close")).attr("title",r.buttonTitle),a=l.picker=j("picker",j("wrapper",s=j("filters"),r.search?o=j("search-panel",j("search",r.search?function(){l.search=_("<input/>",{placeholder:r.searchPlaceholder||"",type:"text",class:"search"}),this.append(l.search)}:null),g):null,p=j("scroll-area",r.tones&&!r.search?j("tones-panel",g):null,u=j("emojis-list")))).addClass(B("picker-position-"+r.pickerPosition,!0)).addClass(B("filters-position-"+r.filtersPosition,!0)).addClass(B("search-position-"+r.searchPosition,!0)).addClass("hidden"));r.search&&o.addClass(B("with-search",!0)),l.searchSel=null,n.data(t.data()),_.each(r.attributes,function(e,t){n.attr(e,t)});var v=j("category-block").attr({"data-tone":0}).prependTo(u);if(_.each(r.filters,function(e,t){var i=0;if("recent"!==e||l.recentEmojis){if("tones"!==e)_("<i/>",{class:B("filter",!0)+" "+B("filter-"+e,!0),"data-filter":e,title:t.title}).wrapInner(N(t.icon,l.emojiTemplateAlt)).appendTo(s);else{if(!r.tones)return;i=5}do{var n,o=t.emoji.replace(/[\s,;]+/g,"|");n=0===i?j("category").attr({name:e,"data-tone":i}).appendTo(v):j("category-block").attr({name:e,"data-tone":i}).appendTo(u),0<i&&(n.hide(),o=o.split("|").join("_tone"+i+"|")+"_tone"+i),"recent"===e&&(o=W()),o=N(o,l.sprite?'<i class="emojibtn" role="button" data-name="{name}" title="{friendlyName}"><i class="emojione-{uni}"></i></i>':'<i class="emojibtn" role="button" data-name="{name}" title="{friendlyName}"><img class="emojioneemoji lazy-emoji" data-src="{img}"/></i>',!0).split("|").join(""),n.html(o),_('<div class="emojionearea-category-title"/>').text(t.title).prependTo(n)}while(0<--i)}}),r.filters=null,l.sprite||(l.lasyEmoji=u.find(".lazy-emoji")),(c=s.find(B("filter"))).eq(0).addClass("active"),h=u.find(B("category-block")),d=u.find(B("category")),l.recentFilter=c.filter('[data-filter="recent"]'),l.recentCategory=d.filter("[name=recent]"),l.scrollArea=p,r.container?_(r.container).wrapInner(m):m.insertAfter(t),r.hideSource&&t.hide(),l.setText(t[f]()),t[f](l.getText()),G.apply(l),l.standalone&&!l.getText().length){var y=_(t).data("emoji-placeholder")||r.emojiPlaceholder;l.setText(y),n.addClass("has-placeholder")}O(l,u.find(".emojibtn"),{click:"emojibtn.click"}),O(l,window,{resize:"!resize"}),O(l,g.children(),{click:"tone.click"}),O(l,[a,i],{mousedown:"!mousedown"},n),O(l,i,{click:"button.click"}),O(l,n,{paste:"!paste"},n),O(l,n,["focus","blur"],function(){return!l.stayFocused&&n}),O(l,a,{mousedown:"picker.mousedown",mouseup:"picker.mouseup",click:"picker.click",keyup:"picker.keyup",keydown:"picker.keydown",keypress:"picker.keypress"}),O(l,n,["mousedown","mouseup","click","keyup","keydown","keypress"]),O(l,a.find(".emojionearea-filter"),{click:"filter.click"}),O(l,t,{change:"source.change"}),r.search&&O(l,l.search,{keyup:"search.keypress",focus:"search.focus",blur:"search.blur"});var b=!1;if(p.on("scroll",function(){if(!b&&($.call(l),p.is(":not(.skinnable)"))){var i=d.eq(0),n=p.offset().top;d.each(function(e,t){if(10<=_(t).offset().top-n)return!1;i=_(t)});var e=c.filter('[data-filter="'+i.attr("name")+'"]');e[0]&&!e.is(".active")&&(c.removeClass("active"),e.addClass("active"))}}),l.on("@filter.click",function(e){var t=e.is(".active");if(p.is(".skinnable")){if(t)return;g.children().eq(0).click()}b=!0,t||(c.filter(".active").removeClass("active"),e.addClass("active"));var i=d.filter('[name="'+e.data("filter")+'"]').offset().top,n=p.scrollTop(),o=p.offset().top;p.stop().animate({scrollTop:i+n-o-2},200,"swing",function(){$.call(l),b=!1})}).on("@picker.show",function(){l.recentEmojis&&H(l),$.call(l)}).on("@tone.click",function(e){g.children().removeClass("active");var t=e.addClass("active").data("skin");t?(p.addClass("skinnable"),h.hide().filter("[data-tone="+t+"]").show(),c.removeClass("active")):(p.removeClass("skinnable"),h.hide().filter("[data-tone=0]").show(),c.eq(0).click()),$.call(l),r.search&&l.trigger("search.keypress")}).on("@button.click",function(e){e.is(".active")?l.hidePicker():(l.showPicker(),l.searchSel=null)}).on("@!paste",function(a,e){function t(e){var t="caret-"+(new Date).getTime(),i=I(e,l);F(i),F('<i id="'+t+'"></i>'),a.scrollTop(s);var n=_("#"+t),o=n.offset().top-a.offset().top,r=a.height();(r<=s+o||o<s)&&a.scrollTop(s+o-2*r/3),n.remove(),l.stayFocused=!1,G.apply(l),R(l,"paste",[a,e,i])}if(e.originalEvent.clipboardData){var i=e.originalEvent.clipboardData.getData("text/plain");return t(i),e.preventDefault?e.preventDefault():e.stop(),e.returnValue=!1,e.stopPropagation(),!1}l.stayFocused=!0,F("<span>"+k+"</span>");var n=E(a[0]),s=a.scrollTop(),o=_("<div/>",{contenteditable:!0}).css({position:"fixed",left:"-999px",width:"1px",height:"1px",top:"20px",overflow:"hidden"}).appendTo(_("BODY")).focus();window.setTimeout(function(){a.focus(),x(a[0],n);var e=L(o.html().replace(/\r\n|\n|\r/g,"<br>"),l);o.remove(),t(e)},200)}).on("@emojibtn.click",function(e){n.removeClass("has-placeholder"),null!==l.searchSel&&(n.focus(),x(n[0],l.searchSel),l.searchSel=null),l.standalone?(n.html(N(e.data("name"),l.emojiTemplate)),l.trigger("blur")):(E(n[0]),F(N(e.data("name"),l.emojiTemplate))),l.recentEmojis&&function(e,t){var i=W().split("|"),n=i.indexOf(t);-1!==n&&i.splice(n,1),i.unshift(t),9<i.length&&i.pop(),localStorage.setItem("recent_emojis",i.join("|")),H(e)}(l,e.data("name")),l.trigger("search.keypress")}).on("@!resize @keyup @emojibtn.click",G).on("@!mousedown",function(e,t){return _(t.target).hasClass("search")?(l.stayFocused=!0,null===l.searchSel&&(l.searchSel=E(e[0]))):(m.is(".focused")||e.trigger("focus"),t.preventDefault()),!1}).on("@change",function(){var e=l.editor.html().replace(/<\/?(?:div|span|p)[^>]*>/gi,"");e.length&&!/^<br[^>]*>$/i.test(e)||l.editor.html(l.content=""),t[f](l.getText())}).on("@source.change",function(){l.setText(t[f]()),R("change")}).on("@focus",function(){m.addClass("focused")}).on("@blur",function(){m.removeClass("focused"),r.hidePickerOnBlur&&l.hidePicker();var e=l.editor.html();l.content!==e?(l.content=e,R(l,"change",[l.editor]),t.trigger("blur").trigger("change")):t.trigger("blur"),r.search&&(l.search.val(""),l.trigger("search.keypress",!0))}),r.search&&l.on("@search.focus",function(){l.stayFocused=!0,l.search.addClass("focused")}).on("@search.keypress",function(e){var n=a.find(".emojionearea-filter"),i=r.tones?g.find("i.active").data("skin"):0,o=l.search.val().replace(/ /g,"_").replace(/"/g,'\\"');o&&o.length?(l.recentFilter.hasClass("active")&&l.recentFilter.removeClass("active").next().addClass("active"),l.recentCategory.hide(),l.recentFilter.hide(),h.each(function(){function e(e,t){var i=e.find('.emojibtn[data-name*="'+o+'"]');0===i.length?(e.data("tone")===t&&e.hide(),n.filter('[data-filter="'+e.attr("name")+'"]').hide()):(e.find('.emojibtn:not([data-name*="'+o+'"])').hide(),i.show(),e.data("tone")===t&&e.show(),n.filter('[data-filter="'+e.attr("name")+'"]').show())}var t=_(this);0===t.data("tone")?d.filter(':not([name="recent"])').each(function(){e(_(this),0)}):e(t,i)}),b?$.call(l):p.trigger("scroll")):(H(l,!0),h.filter('[data-tone="'+g.find("i.active").data("skin")+'"]:not([name="recent"])').show(),_(".emojibtn",h).show(),n.show(),$.call(l))}).on("@search.blur",function(){l.stayFocused=!1,l.search.removeClass("focused"),l.trigger("blur")}),r.shortcuts&&l.on("@keydown",function(e,t){t.ctrlKey||(9==t.which?(t.preventDefault(),i.click()):27==t.which&&(t.preventDefault(),i.is(".active")&&l.hidePicker()))}),M(r.events)&&!_.isEmptyObject(r.events)&&_.each(r.events,function(e,t){l.on(e.replace(/_/g,"."),t)}),r.autocomplete){var w=function(){var e={maxCount:r.textcomplete.maxCount,placement:r.textcomplete.placement};r.shortcuts&&(e.onKeydown=function(e,t){if(!e.ctrlKey&&13==e.which)return t.KEY_ENTER});var i=_.map(A.emojioneList,function(e,t){return r.autocompleteTones?t:/_tone[12345]/.test(t)?null:t});i.sort(),n.textcomplete([{id:T,match:/\B(:[\-+\w]*)$/,search:function(t,e){e(_.map(i,function(e){return 0===e.indexOf(t)?e:null}))},template:function(e){return N(e,l.emojiTemplate)+" "+e.replace(/:/g,"")},replace:function(e){return N(e,l.emojiTemplate)},cache:!0,index:1}],e),r.textcomplete.placement&&"static"==_(n.data("textComplete").option.appendTo).css("position")&&_(n.data("textComplete").option.appendTo).css("position","relative")},C=function(){if(l.disabled){var e=function(){l.off("enabled",e),w()};l.on("enabled",e)}else w()};_.fn.textcomplete?C():_.ajax({url:"https://cdn.rawgit.com/yuku-t/jquery-textcomplete/v1.3.4/dist/jquery.textcomplete.js",dataType:"script",cache:!0,success:C})}l.inline&&(m.addClass(B("inline",!0)),l.on("@keydown",function(e,t){13==t.which&&t.preventDefault()})),/firefox/i.test(navigator.userAgent)&&document.execCommand("enableObjectResizing",!1,!1),l.isReady=!0,l.trigger("onLoad",n),l.trigger("ready",n)}window.getSelection&&document.createRange?(E=function(e){var t=window.getSelection&&window.getSelection();if(t&&0<t.rangeCount)return t.getRangeAt(0)},x=function(e,t){var i=document.createRange();i.setStart(t.startContainer,t.startOffset),i.setEnd(t.endContainer,t.endOffset),(t=window.getSelection()).removeAllRanges(),t.addRange(i)}):document.selection&&document.body.createTextRange&&(E=function(e){return document.selection.createRange()},x=function(e,t){var i=document.body.createTextRange();i.moveToElementText(e),i.setStart(t.startContanier,t.startOffset),i.setEnd(t.endContainer,t.endOffset),i.select()});var m={defaultBase:"https://cdnjs.cloudflare.com/ajax/libs/emojione/",defaultBase3:"https://cdn.jsdelivr.net/",base:null,isLoading:!1};function v(t){var e,i=d();t=P(t),m.isLoading||(!A||p(h(A))<2?(m.isLoading=!0,e=5<p(i)?m.defaultBase3+"npm/emojione@"+i:4<p(i)?m.defaultBase3+"emojione/"+i:m.defaultBase+"/"+i,_.ajax({url:e+"/lib/js/emojione.min.js",dataType:"script",cache:!0,success:function(){var e;for(A=window.emojione,i=h(A),e=4<(D=p(i))?(m.base=m.defaultBase3+"emojione/assets/"+i,m.base+"/sprites/emojione-sprite-"+A.emojiSize+".css"):(m.base=m.defaultBase+i+"/assets",m.base+"/sprites/emojione.sprites.css"),t.sprite&&(document.createStyleSheet?document.createStyleSheet(e):_("<link/>",{rel:"stylesheet",href:e}).appendTo("head"));o.length;)o.shift().call();m.isLoading=!1}})):(i=h(A),D=p(i),m.base=4<D?m.defaultBase3+"emojione/assets/"+i:m.defaultBase+i+"/assets"));r(function(){var e="";t.useInternalCDN&&(4<D&&(e=A.emojiSize+"/"),A.imagePathPNG=m.base+"/png/"+e,A.imagePathSVG=m.base+"/svg/"+e,A.imagePathSVGSprites=m.base+"/sprites/emojione.sprites.svg",A.imageType=t.imageType),4<p(i)?(l=A.regUnicode,A.imageType=t.imageType||"png"):l=new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|("+A.unicodeRegexp+")","gi")})}function t(e,t){var i=this;v(t),a[i.id=++n]={},s[i.id]={},r(function(){g(i,e,t)})}t.prototype.on=function(e,i){if(e&&_.isFunction(i)){var n=this;_.each(e.toLowerCase().split(" "),function(e,t){!function(n,o){o=o.replace(/^@/,"");var e=n.id;s[e][o]&&(_.each(s[e][o],function(e,i){_.each(_.isArray(i[0])?i[0]:[i[0]],function(e,t){_(t).on(i[1],function(){var e=c.call(arguments),t=_.isFunction(i[2])?i[2].apply(n,[o].concat(e)):i[2];t&&R(n,o,[t].concat(e))})})}),s[e][o]=null)}(n,t),(a[n.id][t]||(a[n.id][t]=[])).push(i)})}return this},t.prototype.off=function(e,n){if(e){var o=this.id;_.each(e.toLowerCase().replace(/_/g,".").split(" "),function(e,i){a[o][i]&&!/^@/.test(i)&&(n?_.each(a[o][i],function(e,t){t===n&&a[o][i].splice(e,1)}):a[o][i]=[])})}return this},t.prototype.trigger=function(){var e=c.call(arguments),t=[this].concat(e.slice(0,1));return t.push(e.slice(1)),R.apply(this,t)},t.prototype.setFocus=function(){var e=this;return r(function(){e.editor.focus()}),e},t.prototype.setText=function(e){var t=this;return r(function(){t.editor.html(I(e,t)),t.content=t.editor.html(),R(t,"change",[t.editor]),G.apply(t)}),t},t.prototype.getText=function(){return L(this.editor.html(),this)},t.prototype.showPicker=function(){var e=this;return e._sh_timer&&window.clearTimeout(e._sh_timer),e.picker.removeClass("hidden"),e._sh_timer=window.setTimeout(function(){e.button.addClass("active")},50),R(e,"picker.show",[e.picker]),e},t.prototype.hidePicker=function(){var e=this;return e._sh_timer&&window.clearTimeout(e._sh_timer),e.button.removeClass("active"),e._sh_timer=window.setTimeout(function(){e.picker.addClass("hidden")},500),R(e,"picker.hide",[e.picker]),e},t.prototype.enable=function(){function e(){t.disabled=!1,t.editor.prop("contenteditable",!0),t.button.show();var e=t[t.standalone?"button":"editor"];e.parent().removeClass("emojionearea-disable"),R(t,"enabled",[e])}var t=this;return t.isReady?e():t.on("ready",e),t},t.prototype.disable=function(){var t=this;t.disabled=!0;function e(){t.editor.prop("contenteditable",!1),t.hidePicker(),t.button.hide();var e=t[t.standalone?"button":"editor"];e.parent().addClass("emojionearea-disable"),R(t,"disabled",[e])}return t.isReady?e():t.on("ready",e),t},_.fn.emojioneArea=function(e){return this.each(function(){return this.emojioneArea||_.data(this,"emojioneArea",this.emojioneArea=new t(_(this),e)),this.emojioneArea})},_.fn.emojioneArea.defaults=i(),_.fn.emojioneAreaText=function(e){e=P(e);var t=this,i={shortnames:!e||void 0===e.shortnames||e.shortnames,emojiTemplate:'<img alt="{alt}" class="emojione'+(e&&e.sprite&&D<3?'-{uni}" src="'+S:'emoji" src="{img}')+'"/>'};return v(e),r(function(){t.each(function(){var e=_(this);return e.hasClass("emojionearea-text")||e.addClass("emojionearea-text").html(I(e.is("TEXTAREA")||e.is("INPUT")?e.val():e.text(),i)),e})}),this}},window),function(u,d){var h,e="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),p=/^([\-+])=\s*(\d+\.?\d*)/,t=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],f=u.Color=function(e,t,i,n){return new u.Color.fn.parse(e,t,i,n)},g={rgba:{cache:"_rgba",props:{red:{idx:0,type:"byte",empty:!0},green:{idx:1,type:"byte",empty:!0},blue:{idx:2,type:"byte",empty:!0},alpha:{idx:3,type:"percent",def:1}}},hsla:{cache:"_hsla",props:{hue:{idx:0,type:"degrees",empty:!0},saturation:{idx:1,type:"percent",empty:!0},lightness:{idx:2,type:"percent",empty:!0}}}},m={byte:{floor:!0,min:0,max:255},percent:{min:0,max:1},degrees:{mod:360,floor:!0}},s=g.rgba.props,a=f.support={},v=u.each;function y(e,t,i){var n=m[t.type]||{};return(t.empty||i)&&null==e?null:t.def&&null==e?t.def:null==(e=n.floor?~~e:parseFloat(e))||isNaN(e)?t.def:n.mod?(e%=n.mod)<0?n.mod+e:e:n.min>e?n.min:n.max<e?n.max:e}function l(s){var l=f(),c=l._rgba=[];return s=s.toLowerCase(),v(t,function(e,t){var i,n=t.re.exec(s),o=n&&t.parse(n),r=t.space||"rgba",a=g[r].cache;if(o)return i=l[r](o),l[a]=i[a],c=l._rgba=i._rgba,!1}),0!==c.length?(0===Math.max.apply(Math,c)&&u.extend(c,h.transparent),l):(s=h[s])?s:void 0}function c(e,t,i){return 6*(i=(i+1)%1)<1?e+6*(t-e)*i:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e}g.hsla.props.alpha=s.alpha,f.fn=f.prototype={constructor:f,parse:function(o,e,t,i){if(o===d)return this._rgba=[null,null,null,null],this;(o instanceof u||o.nodeType)&&(o=o instanceof u?o.css(e):u(o).css(e),e=d);var r=this,n=u.type(o),a=this._rgba=[];return e!==d&&(o=[o,e,t,i],n="array"),"string"===n?this.parse(l(o)||h._default):"array"===n?(v(s,function(e,t){a[t.idx]=y(o[t.idx],t)}),this):"object"===n?(v(g,o instanceof f?function(e,t){o[t.cache]&&(r[t.cache]=o[t.cache].slice())}:function(e,n){v(n.props,function(e,t){var i=n.cache;if(!r[i]&&n.to){if(null==o[e]||"alpha"===e)return;r[i]=n.to(r._rgba)}r[i][t.idx]=y(o[e],t,!0)})}),this):void 0},is:function(e){var o=f(e),r=!0,a=this;return v(g,function(e,t){var i,n=o[t.cache];return n&&(i=a[t.cache]||t.to&&t.to(a._rgba)||[],v(t.props,function(e,t){if(null!=n[t.idx])return r=n[t.idx]===i[t.idx]})),r}),r},_space:function(){var i=[],n=this;return v(g,function(e,t){n[t.cache]&&i.push(e)}),i.pop()},transition:function(e,a){var s=f(e),t=s._space(),i=g[t],l=this[i.cache]||i.to(this._rgba),c=l.slice();return s=s[i.cache],v(i.props,function(e,t){var i=t.idx,n=l[i],o=s[i],r=m[t.type]||{};null!==o&&(null===n?c[i]=o:(r.mod&&(o-n>r.mod/2?n+=r.mod:n-o>r.mod/2&&(n-=r.mod)),c[t.idx]=y((o-n)*a+n,t)))}),this[t](c)},blend:function(e){if(1===this._rgba[3])return this;var t=this._rgba.slice(),i=t.pop(),n=f(e)._rgba;return f(u.map(t,function(e,t){return(1-i)*n[t]+i*e}))},toRgbaString:function(){var e="rgba(",t=u.map(this._rgba,function(e,t){return null==e?2<t?1:0:e});return 1===t[3]&&(t.pop(),e="rgb("),e+t.join(",")+")"},toHslaString:function(){var e="hsla(",t=u.map(this.hsla(),function(e,t){return null==e&&(e=2<t?1:0),t&&t<3&&(e=Math.round(100*e)+"%"),e});return 1===t[3]&&(t.pop(),e="hsl("),e+t.join(",")+")"},toHexString:function(e){var t=this._rgba.slice(),i=t.pop();return e&&t.push(~~(255*i)),"#"+u.map(t,function(e,t){return 1===(e=(e||0).toString(16)).length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}},f.fn.parse.prototype=f.fn,g.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,n=e[0]/255,o=e[1]/255,r=e[2]/255,a=e[3],s=Math.max(n,o,r),l=Math.min(n,o,r),c=s-l,u=s+l,d=.5*u;return t=l===s?0:n===s?60*(o-r)/c+360:o===s?60*(r-n)/c+120:60*(n-o)/c+240,i=0==d||1==d?d:d<=.5?c/u:c/(2-u),[Math.round(t)%360,i,d,null==a?1:a]},g.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],n=e[2],o=e[3],r=n<=.5?n*(1+i):n+i-n*i,a=2*n-r;return[Math.round(255*c(a,r,t+1/3)),Math.round(255*c(a,r,t)),Math.round(255*c(a,r,t-1/3)),o]},v(g,function(l,e){var i=e.props,a=e.cache,s=e.to,c=e.from;f.fn[l]=function(e){if(s&&!this[a]&&(this[a]=s(this._rgba)),e===d)return this[a].slice();var t,n=u.type(e),o="array"===n||"object"===n?e:arguments,r=this[a].slice();return v(i,function(e,t){var i=o["object"===n?e:t.idx];null==i&&(i=r[t.idx]),r[t.idx]=y(i,t)}),c?((t=f(c(r)))[a]=r,t):f(r)},v(i,function(a,s){f.fn[a]||(f.fn[a]=function(e){var t,i=u.type(e),n="alpha"===a?this._hsla?"hsla":"rgba":l,o=this[n](),r=o[s.idx];return"undefined"===i?r:("function"===i&&(e=e.call(this,r),i=u.type(e)),null==e&&s.empty?this:("string"===i&&(t=p.exec(e))&&(e=r+parseFloat(t[2])*("+"===t[1]?1:-1)),o[s.idx]=e,this[n](o)))})})}),v(e,function(e,r){u.cssHooks[r]={set:function(e,t){var i,n,o;if("string"!==u.type(t)||(i=l(t))){if(t=f(i||t),!a.rgba&&1!==t._rgba[3]){for(o="backgroundColor"===r?e.parentNode:e;(""===(n=u.curCSS(o,"backgroundColor"))||"transparent"===n)&&(o=o.parentNode)&&o.style;);t=t.blend(n&&"transparent"!==n?n:"_default")}t=t.toRgbaString()}e.style[r]=t}},u.fx.step[r]=function(e){e.colorInit||(e.start=f(e.elem,r),e.end=f(e.end),e.colorInit=!0),u.cssHooks[r].set(e.elem,e.start.transition(e.end,e.pos))}}),u(function(){var e=document.createElement("div").style;e.cssText="background-color:rgba(1,1,1,.5)",a.rgba=-1<e.backgroundColor.indexOf("rgba")}),h=u.Color.names={aqua:"#00ffff",azure:"#f0ffff",beige:"#f5f5dc",black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightcyan:"#e0ffff",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightyellow:"#ffffe0",lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(Ie){Ie.Jcrop=function(e,t){var a,b=Ie.extend({},Ie.Jcrop.defaults),i=navigator.userAgent.toLowerCase(),n=/msie/.test(i),o=/msie [1-6]\./.test(i);function g(e){return Math.round(e)+"px"}function m(e){return b.baseClass+"-"+e}function s(e){var t=Ie(e).offset();return[t.left,t.top]}function r(e){return[e.pageX-a[0],e.pageY-a[1]]}function l(e){"object"!=typeof e&&(e={}),b=Ie.extend(b,e),Ie.each(["onChange","onSelect","onRelease","onDblClick"],function(e,t){"function"!=typeof b[t]&&(b[t]=function(){})})}function c(e,t,i){if(a=s(x),we.setCursor("move"===e?e:e+"-resize"),"move"===e)return we.activateHandlers(function(e){var t=e;return Te.watchKeys(),function(e){Z.moveOffset([e[0]-t[0],e[1]-t[1]]),t=e,be.update()}}(t),h,i);var n=Z.getFixed(),o=u(e),r=Z.getCorner(u(o));Z.setPressed(Z.getCorner(o)),Z.setCurrent(r),we.activateHandlers(function(t,i){return function(e){if(b.aspectRatio)switch(t){case"e":case"w":e[1]=i.y+1;break;case"n":case"s":e[0]=i.x+1}else switch(t){case"e":case"w":e[1]=i.y2;break;case"n":case"s":e[0]=i.x2}Z.setCurrent(e),be.update()}}(e,n),h,i)}function u(e){switch(e){case"n":return"sw";case"s":case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function v(t){return function(e){return b.disabled||"move"===t&&!b.allowMove||(a=s(x),$=!0,c(t,r(e)),e.stopPropagation(),e.preventDefault()),!1}}function d(e,t,i){var n=e.width(),o=e.height();t<n&&0<t&&(o=(n=t)/e.width()*e.height()),i<o&&0<i&&(n=(o=i)/e.height()*e.width()),L=e.width()/n,G=e.height()/o,e.width(n).height(o)}function y(e){return{x:e.x*L,y:e.y*G,x2:e.x2*L,y2:e.y2*G,w:e.w*L,h:e.h*G}}function h(e){var t=Z.getFixed();t.w>b.minSelect[0]&&t.h>b.minSelect[1]?(be.enableHandles(),be.done()):be.release(),we.setCursor(b.allowSelect?"crosshair":"default")}function p(e){if(b.disabled)return!1;if(!b.allowSelect)return!1;$=!0,a=s(x),be.disableHandles(),we.setCursor("crosshair");var t=r(e);return Z.setPressed(t),be.update(),we.activateHandlers(f,h,"touch"===e.type.substring(0,5)),Te.watchKeys(),e.stopPropagation(),e.preventDefault(),!1}function f(e){Z.setCurrent(e),be.update()}function w(){var e=Ie("<div></div>").addClass(m("tracker"));return n&&e.css({opacity:0,backgroundColor:"white"}),e}"object"!=typeof e&&(e=Ie(e)[0]),"object"!=typeof t&&(t={}),l(t);var C={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},_=Ie(e),A=!0;if("IMG"==e.tagName){if(0!=_[0].width&&0!=_[0].height)_.width(_[0].width),_.height(_[0].height);else{var E=new Image;E.src=_[0].src,_.width(E.width),_.height(E.height)}var x=_.clone().removeAttr("id").css(C).show();x.width(_.width()),x.height(_.height()),_.after(x).hide()}else x=_.css(C).show(),A=!1,null===b.shade&&(b.shade=!0);d(x,b.boxWidth,b.boxHeight);var S=x.width(),T=x.height(),D=Ie("<div />").width(S).height(T).addClass(m("holder")).css({position:"relative",backgroundColor:b.bgColor}).insertAfter(_).append(x);b.addClass&&D.addClass(b.addClass);var k=Ie("<div />"),R=Ie("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),O=Ie("<div />").width("100%").height("100%").css("zIndex",320),N=Ie("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var e=Z.getFixed();b.onDblClick.call(Pe,e)}).insertBefore(x).append(R,O);A&&(k=Ie("<img />").attr("src",x.attr("src")).css(C).width(S).height(T),R.append(k)),o&&N.css({overflowY:"hidden"});var F,M,P,I,L,G,$,B,j=b.boundary,W=w().width(S+2*j).height(T+2*j).css({position:"absolute",top:g(-j),left:g(-j),zIndex:290}).mousedown(p),H=b.bgColor,z=b.bgOpacity;a=s(x);var V={createDragger:function(t){return function(e){return b.disabled||"move"===t&&!b.allowMove||(a=s(x),$=!0,c(t,r(V.cfilter(e)),!0),e.stopPropagation(),e.preventDefault()),!1}},newSelection:function(e){return p(V.cfilter(e))},cfilter:function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e},isSupported:U,support:!0===b.touchSupport||!1===b.touchSupport?b.touchSupport:U()};function U(){var e,t={},i=["touchstart","touchmove","touchend"],n=document.createElement("div");try{for(e=0;e<i.length;e++){var o=i[e],r=(o="on"+o)in n;r||(n.setAttribute(o,"return;"),r="function"==typeof n[o]),t[i[e]]=r}return t.touchstart&&t.touchend&&t.touchmove}catch(e){return!1}}var Y,q,Q,K,X,J,Z=(J=X=K=Q=0,{flipCoords:ie,setPressed:function(e){e=te(e),X=Q=e[0],J=K=e[1]},setCurrent:function(e){e=te(e),Y=e[0]-X,q=e[1]-J,X=e[0],J=e[1]},getOffset:function(){return[Y,q]},moveOffset:function(e){var t=e[0],i=e[1];Q+t<0&&(t-=t+Q),K+i<0&&(i-=i+K),T<J+i&&(i+=T-(J+i)),S<X+t&&(t+=S-(X+t)),Q+=t,X+=t,K+=i,J+=i},getCorner:function(e){var t=ee();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}},getFixed:ee});function ee(){if(!b.aspectRatio)return function(){var e,t=X-Q,i=J-K;F&&Math.abs(t)>F&&(X=0<t?Q+F:Q-F);M&&Math.abs(i)>M&&(J=0<i?K+M:K-M);I/G&&Math.abs(i)<I/G&&(J=0<i?K+I/G:K-I/G);P/L&&Math.abs(t)<P/L&&(X=0<t?Q+P/L:Q-P/L);Q<0&&(X-=Q,Q-=Q);K<0&&(J-=K,K-=K);X<0&&(Q-=X,X-=X);J<0&&(K-=J,J-=J);S<X&&(Q-=e=X-S,X-=e);T<J&&(K-=e=J-T,J-=e);S<Q&&(J-=e=Q-T,K-=e);T<K&&(J-=e=K-T,K-=e);return ne(ie(Q,K,X,J))}();var e,t,i,n,o=b.aspectRatio,r=b.minSize[0]/L,a=b.maxSize[0]/L,s=b.maxSize[1]/G,l=X-Q,c=J-K,u=Math.abs(l),d=Math.abs(c);return 0===a&&(a=10*S),0===s&&(s=10*T),u/d<o?(t=J,i=d*o,(e=l<0?Q-i:i+Q)<0?(e=0,n=Math.abs((e-Q)/o),t=c<0?K-n:n+K):S<e&&(e=S,n=Math.abs((e-Q)/o),t=c<0?K-n:n+K)):(e=X,n=u/o,(t=c<0?K-n:K+n)<0?(t=0,i=Math.abs((t-K)*o),e=l<0?Q-i:i+Q):T<t&&(t=T,i=Math.abs(t-K)*o,e=l<0?Q-i:i+Q)),Q<e?(e-Q<r?e=Q+r:a<e-Q&&(e=Q+a),t=K<t?K+(e-Q)/o:K-(e-Q)/o):e<Q&&(Q-e<r?e=Q-r:a<Q-e&&(e=Q-a),t=K<t?K+(Q-e)/o:K-(Q-e)/o),e<0?(Q-=e,e=0):S<e&&(Q-=e-S,e=S),t<0?(K-=t,t=0):T<t&&(K-=t-T,t=T),ne(ie(Q,K,e,t))}function te(e){return e[0]<0&&(e[0]=0),e[1]<0&&(e[1]=0),e[0]>S&&(e[0]=S),e[1]>T&&(e[1]=T),[Math.round(e[0]),Math.round(e[1])]}function ie(e,t,i,n){var o=e,r=i,a=t,s=n;return i<e&&(o=i,r=e),n<t&&(a=n,s=t),[o,a,r,s]}function ne(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}var oe,re,ae,se=(oe=!1,re=Ie("<div />").css({position:"absolute",zIndex:240,opacity:0}),ae={top:ue(),left:ue().height(T),right:ue().height(T),bottom:ue()},{update:le,updateRaw:ce,getShades:ge,setBgColor:he,enable:de,disable:pe,resize:function(e,t){ae.left.css({height:g(t)}),ae.right.css({height:g(t)})},refresh:function(){b.shade?de():pe(),be.isAwake()&&fe(b.bgOpacity)},opacity:fe});function le(){return ce(Z.getFixed())}function ce(e){ae.top.css({left:g(e.x),width:g(e.w),height:g(e.y)}),ae.bottom.css({top:g(e.y2),left:g(e.x),width:g(e.w),height:g(T-e.y2)}),ae.right.css({left:g(e.x2),width:g(S-e.x2)}),ae.left.css({width:g(e.x)})}function ue(){return Ie("<div />").css({position:"absolute",backgroundColor:b.shadeColor||b.bgColor}).appendTo(re)}function de(){oe||(oe=!0,re.insertBefore(x),le(),be.setBgOpacity(1,0,1),k.hide(),he(b.shadeColor||b.bgColor,1),be.isAwake()?fe(b.bgOpacity,1):fe(1,1))}function he(e,t){Fe(ge(),e,t)}function pe(){oe&&(re.remove(),k.show(),oe=!1,be.isAwake()?be.setBgOpacity(b.bgOpacity,1,1):(be.setBgOpacity(1,1,1),be.disableHandles()),Fe(D,0,1))}function fe(e,t){oe&&(b.bgFade&&!t?re.animate({opacity:1-e},{queue:!1,duration:b.fadeTime}):re.css({opacity:1-e}))}function ge(){return re.children()}var me,ve,ye,be=function(){var n,r=370,a={},s={},i={},e=!1;function l(e,t){var i=Ie("<div />").mousedown(v(e)).css({cursor:e+"-resize",position:"absolute",zIndex:t}).addClass("ord-"+e);return V.support&&i.bind("touchstart.jcrop",V.createDragger(e)),O.append(i),i}function t(){var e=Z.getFixed();Z.setPressed([e.x,e.y]),Z.setCurrent([e.x2,e.y2]),o()}function o(e){if(n)return c(e)}function c(e){var t=Z.getFixed();!function(e,t){N.width(Math.round(e)).height(Math.round(t))}(t.w,t.h),function(e,t){b.shade||k.css({top:g(-t),left:g(-e)}),N.css({top:g(t),left:g(e)})}(t.x,t.y),b.shade&&se.updateRaw(t),n||function(){N.show(),b.shade?se.opacity(z):u(z,!0);n=!0}(),e?b.onSelect.call(Pe,y(t)):b.onChange.call(Pe,y(t))}function u(e,t,i){(n||t)&&(b.bgFade&&!i?x.animate({opacity:e},{queue:!1,duration:b.fadeTime}):x.css("opacity",e))}function d(){if(e=!0,b.allowResize)return O.show(),!0}function h(){e=!1,O.hide()}function p(e){e?(B=!0,h()):(B=!1,d())}b.dragEdges&&Ie.isArray(b.createDragbars)&&function(e){var t;for(t=0;t<e.length;t++)i[e[t]]=l(e[t],r++).addClass("jcrop-dragbar")}(b.createDragbars),Ie.isArray(b.createHandles)&&function(e){var t,i,n,o;for(t=0;t<e.length;t++)s[e[t]]=(i=e[t],o=void 0,n=b.handleSize,o=l(i,r++).css({opacity:b.handleOpacity}).addClass(m("handle")),n&&o.width(n).height(n),o)}(b.createHandles),b.drawBorders&&Ie.isArray(b.createBorders)&&function(e){var t,i,n,o;for(i=0;i<e.length;i++){switch(e[i]){case"n":t="hline";break;case"s":t="hline bottom";break;case"e":t="vline right";break;case"w":t="vline"}a[e[i]]=(n=t,void 0,o=Ie("<div />").css({position:"absolute",opacity:b.borderOpacity}).addClass(m(n)),R.append(o),o)}}(b.createBorders),Ie(document).bind("touchstart.jcrop-ios",function(e){Ie(e.currentTarget).hasClass("jcrop-tracker")&&e.stopPropagation()});var f=w().mousedown(v("move")).css({cursor:"move",position:"absolute",zIndex:360});return V.support&&f.bind("touchstart.jcrop",V.createDragger("move")),R.append(f),h(),{updateVisible:o,update:c,release:function(){h(),N.hide(),b.shade?se.opacity(1):u(1),n=!1,b.onRelease.call(Pe)},refresh:t,isAwake:function(){return n},setCursor:function(e){f.css("cursor",e)},enableHandles:d,enableOnly:function(){e=!0},showHandles:function(){e&&O.show()},disableHandles:h,animMode:p,setBgOpacity:u,done:function(){p(!1),t()}}}(),we=(me=function(){},ve=function(){},(ye=b.trackDocument)||W.mousemove(Ce).mouseup(_e).mouseout(_e),x.before(W),{activateHandlers:function(e,t,i){return $=!0,me=e,ve=t,function(e){W.css({zIndex:450}),e?Ie(document).bind("touchmove.jcrop",Ae).bind("touchend.jcrop",Ee):ye&&Ie(document).bind("mousemove.jcrop",Ce).bind("mouseup.jcrop",_e)}(i),!1},setCursor:function(e){W.css("cursor",e)}});function Ce(e){return me(r(e)),!1}function _e(e){return e.preventDefault(),e.stopPropagation(),$&&($=!1,ve(r(e)),be.isAwake()&&b.onSelect.call(Pe,y(Z.getFixed())),W.css({zIndex:290}),Ie(document).unbind(".jcrop"),me=function(){},ve=function(){}),!1}function Ae(e){return me(r(V.cfilter(e))),!1}function Ee(e){return _e(V.cfilter(e))}var xe,Se,Te=(xe=Ie('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),Se=Ie("<div />").css({position:"absolute",overflow:"hidden"}).append(xe),b.keySupport&&(xe.keydown(function(e){if(e.ctrlKey||e.metaKey)return!0;var t=!!e.shiftKey?10:1;switch(e.keyCode){case 37:De(e,-t,0);break;case 39:De(e,t,0);break;case 38:De(e,0,-t);break;case 40:De(e,0,t);break;case 27:b.allowSelect&&be.release();break;case 9:return!0}return!1}).blur(function(e){xe.hide()}),o||!b.fixedSupport?(xe.css({position:"absolute",left:"-20px"}),Se.append(xe).insertBefore(x)):xe.insertBefore(x),xe.hide()),{watchKeys:function(){b.keySupport}});function De(e,t,i){b.allowMove&&(Z.moveOffset([t,i]),be.updateVisible(!0)),e.preventDefault(),e.stopPropagation()}function ke(e){Re([e[0]/L,e[1]/G,e[2]/L,e[3]/G]),b.onSelect.call(Pe,y(Z.getFixed())),be.enableHandles()}function Re(e){Z.setPressed([e[0],e[1]]),Z.setCurrent([e[2],e[3]]),be.update()}function Oe(){b.disabled=!0,be.disableHandles(),be.setCursor("default"),we.setCursor("default")}function Ne(){b.disabled=!1,Me()}function Fe(e,t,i){var n=t||b.bgColor;b.bgFade&&Ie.fx.step.hasOwnProperty("backgroundColor")&&b.fadeTime&&!i?e.animate({backgroundColor:n},{queue:!1,duration:b.fadeTime}):e.css("backgroundColor",n)}function Me(e){b.allowResize?e?be.enableOnly():be.enableHandles():be.disableHandles(),we.setCursor(b.allowSelect?"crosshair":"default"),be.setCursor(b.allowMove?"move":"default"),b.hasOwnProperty("trueSize")&&(L=b.trueSize[0]/S,G=b.trueSize[1]/T),b.hasOwnProperty("setSelect")&&(ke(b.setSelect),be.done(),delete b.setSelect),se.refresh(),b.bgColor!=H&&(Fe(b.shade?se.getShades():D,b.shade&&b.shadeColor||b.bgColor),H=b.bgColor),z!=b.bgOpacity&&(z=b.bgOpacity,b.shade?se.refresh():be.setBgOpacity(z)),F=b.maxSize[0]||0,M=b.maxSize[1]||0,P=b.minSize[0]||0,I=b.minSize[1]||0,b.hasOwnProperty("outerImage")&&(x.attr("src",b.outerImage),delete b.outerImage),be.refresh()}V.support&&W.bind("touchstart.jcrop",V.newSelection),O.hide(),Me(!0);var Pe={setImage:function(o,r){be.release(),Oe();var a=new Image;a.onload=function(){var e=a.width,t=a.height,i=b.boxWidth,n=b.boxHeight;x.width(e).height(t),x.attr("src",o),k.attr("src",o),d(x,i,n),S=x.width(),T=x.height(),k.width(S).height(T),W.width(S+2*j).height(T+2*j),D.width(S).height(T),se.resize(S,T),Ne(),"function"==typeof r&&r.call(Pe)},a.src=o},animateTo:function(e,t){var i=e[0]/L,n=e[1]/G,o=e[2]/L,r=e[3]/G;if(!B){var a=Z.flipCoords(i,n,o,r),s=Z.getFixed(),l=[s.x,s.y,s.x2,s.y2],c=l,u=b.animationDelay,d=a[0]-l[0],h=a[1]-l[1],p=a[2]-l[2],f=a[3]-l[3],g=0,m=b.swingSpeed;i=c[0],n=c[1],o=c[2],r=c[3],be.animMode(!0);var v=function(){g+=(100-g)/m,c[0]=Math.round(i+g/100*d),c[1]=Math.round(n+g/100*h),c[2]=Math.round(o+g/100*p),c[3]=Math.round(r+g/100*f),99.8<=g&&(g=100),g<100?(Re(c),y()):(be.done(),be.animMode(!1),"function"==typeof t&&t.call(Pe))};y()}function y(){window.setTimeout(v,u)}},setSelect:ke,setOptions:function(e){l(e),Me()},tellSelect:function(){return y(Z.getFixed())},tellScaled:function(){return Z.getFixed()},setClass:function(e){D.removeClass().addClass(m("holder")).addClass(e)},disable:Oe,enable:Ne,cancel:function(){be.done(),we.activateHandlers(null,null)},release:be.release,destroy:function(){D.remove(),_.show(),_.css("visibility","visible"),Ie(e).removeData("Jcrop")},focus:Te.watchKeys,getBounds:function(){return[S*L,T*G]},getWidgetSize:function(){return[S,T]},getScaleFactor:function(){return[L,G]},getOptions:function(){return b},ui:{holder:D,selection:N}};return n&&D.bind("selectstart",function(){return!1}),_.data("Jcrop",Pe),Pe},Ie.fn.Jcrop=function(e,t){var i;return this.each(function(){if(Ie(this).data("Jcrop")){if("api"===e)return Ie(this).data("Jcrop");Ie(this).data("Jcrop").setOptions(e)}else"IMG"==this.tagName?Ie.Jcrop.Loader(this,function(){Ie(this).css({display:"block",visibility:"hidden"}),i=Ie.Jcrop(this,e),Ie.isFunction(t)&&t.call(i)}):(Ie(this).css({display:"block",visibility:"hidden"}),i=Ie.Jcrop(this,e),Ie.isFunction(t)&&t.call(i))}),this},Ie.Jcrop.Loader=function(e,t,i){var n=Ie(e),o=n[0];n.bind("load.jcloader",function e(){o.complete?(n.unbind(".jcloader"),Ie.isFunction(t)&&t.call(o)):window.setTimeout(e,50)}).bind("error.jcloader",function(e){n.unbind(".jcloader"),Ie.isFunction(i)&&i.call(o)}),o.complete&&Ie.isFunction(t)&&(n.unbind(".jcloader"),t.call(o))},Ie.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}}(jQuery),function(e,t){"function"==typeof define&&define.amd?define(["jquery"],t):t(e.jQuery)}(this,function(d){"use strict";d.extendext=function(){var e,t,i,n,o,r,a=arguments[0]||{},s=1,l=arguments.length,c=!1,u="default";for("boolean"==typeof a&&(c=a,a=arguments[s++]||{}),"string"==typeof a&&(u=d([a.toLowerCase(),"default"]).filter(["default","concat","replace","extend"])[0],a=arguments[s++]||{}),"object"==typeof a||d.isFunction(a)||(a={}),s===l&&(a=this,s--);s<l;s++)if(null!==(e=arguments[s]))if(d.isArray(e)&&"default"!==u)switch(r=a&&d.isArray(a)?a:[],u){case"concat":a=r.concat(d.extend(c,[],e));break;case"replace":a=d.extend(c,[],e);break;case"extend":e.forEach(function(e,t){if("object"==typeof e){var i=d.isArray(e)?[]:{};r[t]=d.extendext(c,u,r[t]||i,e)}else-1===r.indexOf(e)&&r.push(e)}),a=r}else for(t in e)i=a[t],a!==(n=e[t])&&(c&&n&&(d.isPlainObject(n)||(o=d.isArray(n)))?(r=o?(o=!1,i&&d.isArray(i)?i:[]):i&&d.isPlainObject(i)?i:{},a[t]=d.extendext(c,u,r,n)):void 0!==n&&(a[t]=n));return a}}),function(){"use strict";var l,c={version:"1.0.3",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0};c.encodeHTMLSource=function(e){var t={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=e?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(e){return e?e.toString().replace(i,function(e){return t[e]||e}):""}},l=function(){return this||(0,eval)("this")}(),"undefined"!=typeof module&&module.exports?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):l.doT=c;var u={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},d=/$^/;function h(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}c.template=function(e,t,i){var n,o,r=(t=t||c.templateSettings).append?u.append:u.split,a=0,s=t.use||t.define?function n(o,e,r){return("string"==typeof e?e:e.toString()).replace(o.define||d,function(e,n,t,i){return 0===n.indexOf("def.")&&(n=n.substring(4)),n in r||(":"===t?(o.defineParams&&i.replace(o.defineParams,function(e,t,i){r[n]={arg:t,text:i}}),n in r||(r[n]=i)):new Function("def","def['"+n+"']="+i)(r)),""}).replace(o.use||d,function(e,t){o.useParams&&(t=t.replace(o.useParams,function(e,t,i,n){if(r[i]&&r[i].arg&&n){var o=(i+":"+n).replace(/'|\\/g,"_");return r.__exp=r.__exp||{},r.__exp[o]=r[i].text.replace(new RegExp("(^|[^\\w$])"+r[i].arg+"([^\\w$])","g"),"$1"+n+"$2"),t+"def.__exp['"+o+"']"}}));var i=new Function("def","return "+t)(r);return i?n(o,i,r):i})}(t,e,i||{}):e;s=("var out='"+(t.strip?s.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):s).replace(/'|\\/g,"\\$&").replace(t.interpolate||d,function(e,t){return r.start+h(t)+r.end}).replace(t.encode||d,function(e,t){return n=!0,r.startencode+h(t)+r.end}).replace(t.conditional||d,function(e,t,i){return t?i?"';}else if("+h(i)+"){out+='":"';}else{out+='":i?"';if("+h(i)+"){out+='":"';}out+='"}).replace(t.iterate||d,function(e,t,i,n){return t?(a+=1,o=n||"i"+a,t=h(t),"';var arr"+a+"="+t+";if(arr"+a+"){var "+i+","+o+"=-1,l"+a+"=arr"+a+".length-1;while("+o+"<l"+a+"){"+i+"=arr"+a+"["+o+"+=1];out+='"):"';} } out+='"}).replace(t.evaluate||d,function(e,t){return"';"+h(t)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),n&&(t.selfcontained||!l||l._encodeHTML||(l._encodeHTML=c.encodeHTMLSource(t.doNotSkipEncoded)),s="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+c.encodeHTMLSource.toString()+"("+(t.doNotSkipEncoded||"")+"));"+s);try{return new Function(t.varname,s)}catch(e){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+s),e}},c.compile=function(e,t){return c.template(e,null,t)}}(),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.agGrid=t():e.agGrid=t()}(this,function(){return Ocg={},Pcg.m=Ncg=[function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),n=(o.prototype.setupComponents=function(){var t=this;this.contextParams.components&&this.contextParams.components.forEach(function(e){return t.addComponent(e)})},o.prototype.addComponent=function(e){var t=e.componentName.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase().toUpperCase();this.componentsMappedByName[t]=e.theClass},o.prototype.createComponent=function(e,t){var i=e.nodeName;if(this.componentsMappedByName&&this.componentsMappedByName[i]){var n=new this.componentsMappedByName[i];return this.wireBean(n,t),n}return null},o.prototype.wireBean=function(e,t){if(!e)throw Error("Can't wire to bean since it is null");this.wireBeans([e],t)},o.prototype.wireBeans=function(e,t){this.autoWireBeans(e),this.methodWireBeans(e),this.preConstruct(e),a.Utils.exists(t)&&e.forEach(t),this.postConstruct(e)},o.prototype.createBeans=function(){var r=this;this.contextParams.beans.forEach(this.createBeanEntry.bind(this)),this.contextParams.overrideBeans&&this.contextParams.overrideBeans.forEach(this.createBeanEntry.bind(this)),a.Utils.iterateObject(this.beans,function(e,t){var i;t.bean.__agBeanMetaData&&t.bean.__agBeanMetaData.autowireMethods&&t.bean.__agBeanMetaData.autowireMethods.agConstructor&&(i=t.bean.__agBeanMetaData.autowireMethods.agConstructor);var n=r.getBeansForParameters(i,t.bean.name),o=function(e,t){var i=[null].concat(t);return new(e.bind.apply(e,i))}(t.bean,n);t.beanInstance=o,r.logger.log("bean "+r.getBeanName(o)+" created")})},o.prototype.createBeanEntry=function(e){var t=e.__agBeanMetaData;if(!t){var i=void 0;return i=e.prototype.constructor?e.prototype.constructor.name:""+e,void console.error("context item "+i+" is not a bean")}var n={bean:e,beanInstance:null,beanName:t.beanName};this.beans[t.beanName]=n},o.prototype.autoWireBeans=function(e){var t=this;e.forEach(function(e){return t.autoWireBean(e)})},o.prototype.methodWireBeans=function(e){var t=this;e.forEach(function(e){if(!e)throw Error("Can't wire to bean since it is null");return t.methodWireBean(e)})},o.prototype.autoWireBean=function(n){for(var o=this,r=n,e=function(){var e=r.constructor;if(e.__agBeanMetaData&&e.__agBeanMetaData.agClassAttributes){var t=e.__agBeanMetaData.agClassAttributes;if(!t)return{value:void 0};var i=a.getBeanName(e);t.forEach(function(e){var t=o.lookupBeanInstance(i,e.beanName,e.optional);n[e.attributeName]=t})}r=Object.getPrototypeOf(r)?Object.getPrototypeOf(r):null},a=this;null!=r;){var t=e();if("object"==typeof t)return t.value}},o.prototype.getBeanName=function(e){if(e.__agBeanMetaData&&e.__agBeanMetaData.beanName)return e.__agBeanMetaData.beanName;var t=e.toString();return t.substring(9,t.indexOf("("))},o.prototype.methodWireBean=function(o){var e,r=this;o.constructor.__agBeanMetaData&&o.constructor.__agBeanMetaData.autowireMethods&&(e=o.constructor.__agBeanMetaData.autowireMethods),a.Utils.iterateObject(e,function(e,t){if("agConstructor"!==e){var i=r.getBeanName(o.constructor),n=r.getBeansForParameters(t,i);o[e].apply(o,n)}})},o.prototype.getBeansForParameters=function(e,n){var o=this,r=[];return e&&a.Utils.iterateObject(e,function(e,t){var i=o.lookupBeanInstance(n,t);r[Number(e)]=i}),r},o.prototype.lookupBeanInstance=function(e,t,i){if(void 0===i&&(i=!1),"context"===t)return this;if(this.contextParams.seed&&this.contextParams.seed.hasOwnProperty(t))return this.contextParams.seed[t];var n=this.beans[t];return n?n.beanInstance:(i||console.error("ag-Grid: unable to find bean reference "+t+" while initialising "+e),null)},o.prototype.postConstruct=function(e){e.forEach(function(t){t.constructor.__agBeanMetaData&&t.constructor.__agBeanMetaData.postConstructMethods&&t.constructor.__agBeanMetaData&&t.constructor.__agBeanMetaData.postConstructMethods.forEach(function(e){return t[e]()})})},o.prototype.preConstruct=function(e){e.forEach(function(t){t.constructor.__agBeanMetaData&&t.constructor.__agBeanMetaData.preConstructMethods&&t.constructor.__agBeanMetaData.preConstructMethods.forEach(function(e){return t[e]()})})},o.prototype.getBean=function(e){return this.lookupBeanInstance("getBean",e,!0)},o.prototype.destroy=function(){this.destroyed||(this.logger.log(">> Shutting down ag-Application Context"),a.Utils.iterateObject(this.beans,function(e,t){var i=t.beanInstance;i.constructor.__agBeanMetaData&&i.constructor.__agBeanMetaData.preDestroyMethods&&i.constructor.__agBeanMetaData.preDestroyMethods.forEach(function(e){return i[e]()})}),this.destroyed=!0,this.logger.log(">> ag-Application Context shut down - component is dead"))},o);function o(e,t){if(this.beans={},this.componentsMappedByName={},this.destroyed=!1,e&&e.beans){this.contextParams=e,this.logger=t,this.logger.log(">> creating ag-Application Context"),this.setupComponents(),this.createBeans();var i=a.Utils.mapObject(this.beans,function(e){return e.beanInstance});this.wireBeans(i),this.logger.log(">> ag-Application Context ready - component is alive")}}function r(e,t,i,n,o,r){if(null!==t)if("number"!=typeof r){var a=s(e.constructor);a.agClassAttributes||(a.agClassAttributes=[]),a.agClassAttributes.push({attributeName:o,beanName:t,optional:i})}else console.error("ag-Grid: Autowired should be on an attribute");else console.error("ag-Grid: Autowired name should not be null")}function s(e){return e.hasOwnProperty("__agBeanMetaData")||(e.__agBeanMetaData={}),e.__agBeanMetaData}t.Context=n,t.PreConstruct=function(e,t,i){var n=s(e.constructor);n.postConstructMethods||(n.preConstructMethods=[]),n.preConstructMethods.push(t)},t.PostConstruct=function(e,t,i){var n=s(e.constructor);n.postConstructMethods||(n.postConstructMethods=[]),n.postConstructMethods.push(t)},t.PreDestroy=function(e,t,i){var n=s(e.constructor);n.preDestroyMethods||(n.preDestroyMethods=[]),n.preDestroyMethods.push(t)},t.Bean=function(t){return function(e){s(e).beanName=t}},t.Autowired=function(n){return function(e,t,i){r(e,n,!1,e,t,null)}},t.Optional=function(n){return function(e,t,i){r(e,n,!0,e,t,null)}},t.Qualifier=function(a){return function(e,t,i){var n,o="function"==typeof e?e:e.constructor;if("number"==typeof i){var r=void 0;r=t?(n=s(o),t):(n=s(o),"agConstructor"),n.autowireMethods||(n.autowireMethods={}),n.autowireMethods[r]||(n.autowireMethods[r]={}),n.autowireMethods[r][i]=a}}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=t(9),n=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,a=/([^\s,]+)/g,i="__ag_Grid_Stop_Propagation",s=(l.prototype.print=function(e){var t=(new Date).getTime()-this.timestamp;console.log(e+" = "+t),this.timestamp=(new Date).getTime()},l);function l(){this.timestamp=(new Date).getTime()}r.Timer=s;var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},u=/[&<>"']/g,d=(h.doOnce=function(e,t){this.doOnceFlags[t]||(e(),this.doOnceFlags[t]=!0)},h.areEventsNear=function(e,t,i){if(0===i)return!1;var n=Math.abs(e.clientX-t.clientX),o=Math.abs(e.clientY-t.clientY);return Math.max(n,o)<=i},h.shallowCompare=function(e,t){if(this.missing(e)&&this.missing(t))return!0;if(this.missing(e)||this.missing(t))return!1;if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0},h.getNameOfClass=function(e){var t=e.toString(),i=/function (.{1,})\(/.exec(t);return i&&1<i.length?i[1]:""},h.values=function(e){var i=[];return this.iterateObject(e,function(e,t){i.push(t)}),i},h.getValueUsingField=function(e,t,i){if(t&&e){if(i){for(var n=t.split("."),o=e,r=0;r<n.length;r++)if(o=o[n[r]],this.missing(o))return null;return o}return e[t]}},h.getScrollLeft=function(e,t){var i=e.scrollLeft;return t&&(i=Math.abs(i),(this.isBrowserSafari()||this.isBrowserChrome())&&(i=e.scrollWidth-e.clientWidth-i)),i},h.cleanNumber=function(e){return"string"==typeof e&&(e=parseInt(e)),e="number"==typeof e?Math.floor(e):null},h.setScrollLeft=function(e,t,i){i&&((this.isBrowserSafari()||this.isBrowserChrome())&&(t=e.scrollWidth-e.clientWidth-t),this.isBrowserFirefox()&&(t*=-1)),e.scrollLeft=t},h.iterateNamedNodeMap=function(e,t){if(e)for(var i=0;i<e.length;i++){var n=e[i];t(n.name,n.value)}},h.iterateObject=function(e,i){if(!this.missing(e))if(Array.isArray(e))e.forEach(function(e,t){i(t+"",e)});else for(var t=Object.keys(e),n=0;n<t.length;n++){var o=t[n],r=e[o];i(o,r)}},h.cloneObject=function(e){for(var t={},i=Object.keys(e),n=0;n<i.length;n++){var o=i[n],r=e[o];t[o]=r}return t},h.map=function(e,t){for(var i=[],n=0;n<e.length;n++){var o=t(e[n]);i.push(o)}return i},h.mapObject=function(e,i){var n=[];return h.iterateObject(e,function(e,t){n.push(i(t))}),n},h.forEach=function(e,t){if(e)for(var i=0;i<e.length;i++)t(e[i],i)},h.filter=function(e,t){var i=[];return e.forEach(function(e){t(e)&&i.push(e)}),i},h.getAllKeysInObjects=function(e){var t={};return e.forEach(function(e){e&&Object.keys(e).forEach(function(e){return t[e]=null})}),Object.keys(t)},h.mergeDeep=function(n,e){this.exists(e)&&this.iterateObject(e,function(e,t){var i=n[e];i!==t&&("object"==typeof i&&"object"==typeof t?h.mergeDeep(i,t):n[e]=t)})},h.assign=function(i){for(var t=this,e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach(function(e){t.exists(e)&&t.iterateObject(e,function(e,t){i[e]=t})}),i},h.parseYyyyMmDdToDate=function(e,t){try{if(!e)return null;if(-1===e.indexOf(t))return null;var i=e.split(t);return 3!=i.length?null:new Date(Number(i[0]),Number(i[1])-1,Number(i[2]))}catch(e){return null}},h.serializeDateToYyyyMmDd=function(e,t){return e?e.getFullYear()+t+h.pad(e.getMonth()+1,2)+t+h.pad(e.getDate(),2):null},h.pad=function(e,t){for(var i=e+"";i.length<t;)i="0"+i;return i},h.pushAll=function(t,e){this.missing(e)||this.missing(t)||e.forEach(function(e){return t.push(e)})},h.createArrayOfNumbers=function(e,t){for(var i=[],n=e;n<=t;n++)i.push(n);return i},h.getFunctionParameters=function(e){var t=e.toString().replace(n,""),i=t.slice(t.indexOf("(")+1,t.indexOf(")")).match(a);return null===i?[]:i},h.find=function(e,t,i){if(null==e)return null;if(!Array.isArray(e)){var n=this.values(e);return this.find(n,t,i)}for(var o,r=e,a=0;a<r.length;a++){var s=r[a];if("string"==typeof t){if(s[t]===i){o=s;break}}else if(t(s)){o=s;break}}return o},h.toStrings=function(e){return this.map(e,function(e){return null!=e&&e.toString?e.toString():null})},h.iterateArray=function(e,t){for(var i=0;i<e.length;i++)t(e[i],i)},h.isNode=function(e){return"function"==typeof Node?e instanceof Node:e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},h.isElement=function(e){return"function"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName},h.isNodeOrElement=function(e){return this.isNode(e)||this.isElement(e)},h.copyNodeList=function(e){for(var t=e?e.length:0,i=[],n=0;n<t;n++)i.push(e[n]);return i},h.isEventFromPrintableCharacter=function(e){var t=String.fromCharCode(e.charCode);if(this.isKeyPressed(e,o.Constants.KEY_NEW_LINE))return!1;if(r._.exists(e.key)){var i=1===e.key.length,n=h.isNumpadDelWithNumlockOnForEdgeOrIe(e);return i||n}return 0<=h.PRINTABLE_CHARACTERS.indexOf(t)},h.addChangeListener=function(e,t){e.addEventListener("changed",t),e.addEventListener("paste",t),e.addEventListener("input",t),e.addEventListener("keydown",t),e.addEventListener("keyup",t)},h.makeNull=function(e){return null==e||""===e?null:e},h.missing=function(e){return!this.exists(e)},h.missingOrEmpty=function(e){return this.missing(e)||0===e.length},h.missingOrEmptyObject=function(e){return this.missing(e)||0===Object.keys(e).length},h.exists=function(e){return null!=e&&""!==e},h.firstExistingValue=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0;i<e.length;i++){var n=e[i];if(r._.exists(n))return n}return null},h.anyExists=function(e){if(e)for(var t=0;t<e.length;t++)if(this.exists(e[t]))return!0;return!1},h.existsAndNotEmpty=function(e){return this.exists(e)&&0<e.length},h.removeAllChildren=function(e){if(e)for(;e.hasChildNodes();)e.removeChild(e.lastChild)},h.removeElement=function(e,t){this.removeFromParent(e.querySelector(t))},h.removeFromParent=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},h.isVisible=function(e){return null!==e.offsetParent},h.loadTemplate=function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild},h.appendHtml=function(e,t){e.lastChild?e.insertAdjacentHTML("afterbegin",t):e.innerHTML=t},h.addOrRemoveCssClass=function(e,t,i){i?this.addCssClass(e,t):this.removeCssClass(e,t)},h.callIfPresent=function(e){e&&e()},h.addCssClass=function(t,e){var i=this;if(e&&0!==e.length)if(0<=e.indexOf(" "))e.split(" ").forEach(function(e){return i.addCssClass(t,e)});else if(t.classList)t.classList.contains(e)||t.classList.add(e);else if(t.className&&0<t.className.length){var n=t.className.split(" ");n.indexOf(e)<0&&(n.push(e),t.className=n.join(" "))}else t.className=e},h.containsClass=function(e,t){if(e.classList)return e.classList.contains(t);if(e.className){var i=e.className===t,n=0<=e.className.indexOf(" "+t+" "),o=0===e.className.indexOf(t+" "),r=e.className.lastIndexOf(" "+t)===e.className.length-t.length-1;return i||n||o||r}return!1},h.getElementAttribute=function(e,t){return e.attributes&&e.attributes[t]?e.attributes[t].value:null},h.offsetHeight=function(e){return e&&e.clientHeight?e.clientHeight:0},h.offsetWidth=function(e){return e&&e.clientWidth?e.clientWidth:0},h.sortNumberArray=function(e){e.sort(function(e,t){return e-t})},h.removeCssClass=function(e,t){if(e.classList)e.classList.contains(t)&&e.classList.remove(t);else if(e.className&&0<e.className.length){var i=e.className.split(" ");if(0<=i.indexOf(t)){for(;0<=i.indexOf(t);)i.splice(i.indexOf(t),1);e.className=i.join(" ")}}},h.removeRepeatsFromArray=function(e,t){if(e)for(var i=e.length-2;0<=i;i--){var n=e[i]===t,o=e[i+1]===t;n&&o&&e.splice(i+1,1)}},h.removeFromArray=function(e,t){0<=e.indexOf(t)&&e.splice(e.indexOf(t),1)},h.removeAllFromArray=function(t,e){e.forEach(function(e){0<=t.indexOf(e)&&t.splice(t.indexOf(e),1)})},h.insertIntoArray=function(e,t,i){e.splice(i,0,t)},h.insertArrayIntoArray=function(e,t,i){if(!this.missing(e)&&!this.missing(t))for(var n=t.length-1;0<=n;n--){var o=t[n];this.insertIntoArray(e,o,i)}},h.moveInArray=function(t,e,i){var n=this;e.forEach(function(e){n.removeFromArray(t,e)}),e.slice().reverse().forEach(function(e){n.insertIntoArray(t,e,i)})},h.defaultComparator=function(t,i,e){void 0===e&&(e=!1);var n=null==t,o=null==i;if(t&&t.toNumber&&(t=t.toNumber()),i&&i.toNumber&&(i=i.toNumber()),n&&o)return 0;if(n)return-1;if(o)return 1;if("string"==typeof t){if(!e)return r(t,i);try{return t.localeCompare(i)}catch(e){return r(t,i)}}return t<i?-1:i<t?1:0;function r(e,t){return t<e?1:e<t?-1:0}},h.compareArrays=function(e,t){if(this.missing(e)&&this.missing(t))return!0;if(this.missing(e)||this.missing(t))return!1;if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0},h.ensureDomOrder=function(e,t,i){i&&i.nextSibling===t||(i?i.nextSibling?e.insertBefore(t,i.nextSibling):e.appendChild(t):e.firstChild&&e.insertBefore(t,e.firstChild))},h.insertWithDomOrder=function(e,t,i){i?i.nextSibling?e.insertBefore(t,i.nextSibling):e.appendChild(t):e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)},h.insertTemplateWithDomOrder=function(e,t,i){return i?(i.insertAdjacentHTML("afterend",t),i.nextSibling):(e.firstChild?e.insertAdjacentHTML("afterbegin",t):e.innerHTML=t,e.firstChild)},h.every=function(e,t){if(!e||0===e.length)return!0;for(var i=0;i<e.length;i++)if(!t(e[i]))return!1;return!0},h.toStringOrNull=function(e){return this.exists(e)&&e.toString?e.toString():null},h.formatWidth=function(e){return"number"==typeof e?e+"px":e},h.formatNumberTwoDecimalPlacesAndCommas=function(e){return"number"!=typeof e?"":(Math.round(100*e)/100).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},h.formatNumberCommas=function(e){return"number"!=typeof e?"":e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},h.prependDC=function(e,t){this.exists(e.firstChild)?e.insertBefore(t,e.firstChild):e.appendChild(t)},h.createIcon=function(e,t,i){var n=this.createIconNoSpan(e,t,i);if(-1<n.className.indexOf("ag-icon"))return n;var o=document.createElement("span");return o.appendChild(n),o},h.createIconNoSpan=function(e,t,i){var n;if(i&&i.getColDef().icons&&(n=i.getColDef().icons[e]),!n&&t.getIcons()&&(n=t.getIcons()[e]),n){var o=void 0;if("function"==typeof n)o=n();else{if("string"!=typeof n)throw"icon from grid options needs to be a string or a function";o=n}if("string"==typeof o)return this.loadTemplate(o);if(this.isNodeOrElement(o))return o;throw"iconRenderer should return back a string or a dom object"}var r=document.createElement("span"),a=this.iconNameClassMap[e];if(!a)throw new Error(e+" did not find class");return r.setAttribute("class","ag-icon ag-icon-"+a),r},h.addStylesToElement=function(i,n){var o=this;n&&Object.keys(n).forEach(function(e){var t=o.hyphenToCamelCase(e);i.style[t]=n[e]})},h.isHorizontalScrollShowing=function(e){return e.clientWidth<e.scrollWidth},h.isVerticalScrollShowing=function(e){return e.clientHeight<e.scrollHeight},h.getMaxDivHeight=function(){if(!document.body)return-1;var e=1e6,t=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,i=this.loadTemplate("<div/>");for(document.body.appendChild(i);;){var n=2*e;if(i.style.height=n+"px",t<n||i.clientHeight!==n)break;e=n}return document.body.removeChild(i),e},h.getScrollbarWidth=function(){var e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var i=document.createElement("div");i.style.width="100%",e.appendChild(i);var n=i.offsetWidth;return e.parentNode.removeChild(e),t-n},h.isKeyPressed=function(e,t){return(e.which||e.keyCode)===t},h.setVisible=function(e,t){this.addOrRemoveCssClass(e,"ag-hidden",!t)},h.setHidden=function(e,t){this.addOrRemoveCssClass(e,"ag-visibility-hidden",t)},h.isBrowserIE=function(){return void 0===this.isIE&&(this.isIE=!!document.documentMode),this.isIE},h.isBrowserEdge=function(){return void 0===this.isEdge&&(this.isEdge=!this.isBrowserIE()&&!!window.StyleMedia),this.isEdge},h.isBrowserSafari=function(){if(void 0===this.isSafari){var e=window;this.isSafari=0<Object.prototype.toString.call(e.HTMLElement).indexOf("Constructor")||"[object SafariRemoteNotification]"===(!e.safari||e.safari.pushNotification).toString()}return this.isSafari},h.isBrowserChrome=function(){if(void 0===this.isChrome){var e=window;this.isChrome=!!e.chrome&&!!e.chrome.webstore}return this.isChrome},h.isBrowserFirefox=function(){if(void 0===this.isFirefox){var e=window;this.isFirefox=void 0!==e.InstallTrigger}return this.isFirefox},h.isUserAgentIPad=function(){return void 0===this.isIPad&&(this.isIPad=null!=navigator.userAgent.match(/iPad|iPhone/i)),this.isIPad},h.getTarget=function(e){var t=e;return t.target||t.srcElement},h.isElementInEventPath=function(e,t){return!(!t||!e)&&0<=r._.getEventPath(t).indexOf(e)},h.createEventPath=function(e){for(var t=[],i=r._.getTarget(e);i;)t.push(i),i=i.parentElement;return t},h.addAgGridEventPath=function(e){e.__agGridEventPath=this.getEventPath(e)},h.getEventPath=function(e){var t=e;return e.deepPath?e.deepPath():t.path?t.path:t.composedPath?t.composedPath():t.__agGridEventPath?t.__agGridEventPath:this.createEventPath(e)},h.forEachSnapshotFirst=function(e,t){e&&e.slice(0).forEach(t)},h.getBodyWidth=function(){return document.body?document.body.clientWidth:window.innerHeight?window.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:-1},h.getBodyHeight=function(){return document.body?document.body.clientHeight:window.innerHeight?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:-1},h.setCheckboxState=function(e,t){"boolean"==typeof t?(e.checked=t,e.indeterminate=!1):e.indeterminate=!0},h.traverseNodesWithKey=function(e,n){var o=[];!function i(e){e.forEach(function(e){if(e.group||e.hasChildren()){o.push(e.key);var t=o.join("|");n(e,t),i(e.childrenAfterGroup),o.pop()}})}(e)},h.camelCaseToHyphen=function(e){return null==e?null:e.replace(/([A-Z])/g,function(e){return"-"+e[0].toLowerCase()})},h.hyphenToCamelCase=function(e){return null==e?null:e.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})},h.cssStyleObjectToMarkup=function(e){var n=this;if(!e)return"";var o=[];return this.iterateObject(e,function(e,t){var i=n.camelCaseToHyphen(e);o.push(i+": "+t+";")}),o.join(" ")},h.isNumeric=function(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)},h.escape=function(e){return null!=e&&e.replace?e.replace(u,function(e){return c[e]}):e},h.normalizeWheel=function(e){var t=0,i=0,n=0,o=0;return"detail"in e&&(i=e.detail),"wheelDelta"in e&&(i=-e.wheelDelta/120),"wheelDeltaY"in e&&(i=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=i,i=0),n=10*t,o=10*i,"deltaY"in e&&(o=e.deltaY),"deltaX"in e&&(n=e.deltaX),(n||o)&&e.deltaMode&&(1==e.deltaMode?(n*=40,o*=40):(n*=800,o*=800)),n&&!t&&(t=n<1?-1:1),o&&!i&&(i=o<1?-1:1),{spinX:t,spinY:i,pixelX:n,pixelY:o}},h.debounce=function(n,o,r){var a;return void 0===r&&(r=!1),function(){var e=this,t=arguments,i=r&&!a;clearTimeout(a),a=setTimeout(function(){a=null,r||n.apply(e,t)},o),i&&n.apply(e,t)}},h.stopPropagationForAgGrid=function(e){e[i]=!0},h.isStopPropagationForAgGrid=function(e){return!0===e[i]},h.executeInAWhile=function(e){this.executeAfter(e,400)},h.executeNextVMTurn=function(e){this.executeAfter(e,0)},h.executeAfter=function(e,t){0<e.length&&setTimeout(function(){e.forEach(function(e){return e()})},t)},h.referenceCompare=function(e,t){return null==e&&null==t||(null!=e||!t)&&(!e||null!=t)&&e===t},h.get=function(e,t,i){if(null==e)return i;if(-1<t.indexOf(".")){var n=t.split(".");return null!=(o=e[n[0]])?h.get(o,n.slice(1,n.length).join("."),i):i}var o;return null!=(o=e[t])?o:i},h.addSafePassiveEventListener=function(e,t,i){e.addEventListener(t,i,-1<h.passiveEvents.indexOf(t)?{passive:!0}:void 0)},h.camelCaseToHumanText=function(e){return null==e?null:e.replace(/([A-Z])([A-Z])([a-z])|([a-z])([A-Z])/g,"$1$4 $2$3$5").replace("."," ").split(" ").map(function(e){return e.substring(0,1).toUpperCase()+(1<e.length?e.substring(1,e.length):"")}).join(" ")},h.message=function(e){var t=document.createElement("div");t.innerHTML=e;var i=document.querySelector("#__ag__message");i||(i=this.loadTemplate('<div id="__ag__message" style="display: inline-block; position: absolute; top: 0px; left: 0px; color: white; background-color: black; z-index: 20; padding: 2px; border: 1px solid darkred; height: 200px; overflow-y: auto;"></div>'),document.body&&document.body.appendChild(i)),i.appendChild(t)},h.sortRowNodesByOrder=function(e,a){e&&e.sort(function(e,t){var i=a[e.id],n=a[t.id],o=void 0!==i,r=void 0!==n;return o&&r?i-n:o||r?o?1:-1:e.id>t.id?1:-1})},h.fuzzyCheckStrings=function(e,i,t){var n=this,o={},r=e.filter(function(t){return!i.some(function(e){return e===t})});return 0<r.length&&r.forEach(function(e){return o[e]=n.fuzzySuggestions(e,i,t)}),o},h.fuzzySuggestions=function(o,e,t){var i=t.slice(0);return i.sort(function(e,t){var i=r._.string_similarity(e.toLowerCase(),o.toLowerCase()),n=r._.string_similarity(t.toLowerCase(),o.toLowerCase());return n<i?-1:i===n?0:1}),i},h.get_bigrams=function(e){var t,i,n,o,r;for(o=e.toLowerCase(),t=i=0,n=(r=new Array(o.length-1)).length;i<=n;t=i+=1)r[t]=o.slice(t,t+2);return r},h.isNumpadDelWithNumlockOnForEdgeOrIe=function(e){return!(!h.isBrowserEdge()&&!h.isBrowserIE())&&e.key===h.NUMPAD_DEL_NUMLOCK_ON_KEY&&e.charCode===h.NUMPAD_DEL_NUMLOCK_ON_CHARCODE},h.PRINTABLE_CHARACTERS="qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM1234567890!\"¬£$%^&*()_+-=[];'#,./\\|<>?:@~{}",h.NUMPAD_DEL_NUMLOCK_ON_KEY="Del",h.NUMPAD_DEL_NUMLOCK_ON_CHARCODE=46,h.doOnceFlags={},h.iconNameClassMap={columnMovePin:"pin",columnMoveAdd:"plus",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"expanded",groupExpanded:"contracted",checkboxChecked:"checkbox-checked",checkboxUnchecked:"checkbox-unchecked",checkboxIndeterminate:"checkbox-indeterminate",checkboxCheckedReadOnly:"checkbox-checked-readonly",checkboxUncheckedReadOnly:"checkbox-unchecked-readonly",checkboxIndeterminateReadOnly:"checkbox-indeterminate-readonly",groupLoading:"loading",menu:"menu",filter:"filter",columns:"columns",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"},h.passiveEvents=["touchstart","touchend","touchmove","touchcancel"],h.string_similarity=function(e,t){var i,n,o,r,a,s,l,c,u;if(0<e.length&&0<t.length){for(s=h.get_bigrams(e),l=h.get_bigrams(t),c=s.length+l.length,n=i=0,r=s.length;n<r;n++)for(u=s[n],o=0,a=l.length;o<a;o++)u===l[o]&&i++;if(0<i)return 2*i/c}return 0},h);function h(){}r.Utils=d;var p,f,g=(m.prototype.next=function(){var e=this.nextValue;return this.nextValue+=this.step,e},m.prototype.peek=function(){return this.nextValue},m.prototype.skip=function(e){this.nextValue+=e},m);function m(e,t){void 0===e&&(e=0),void 0===t&&(t=1),this.nextValue=e,this.step=t}r.NumberSequence=g,r._=d,(f=p=r.PromiseStatus||(r.PromiseStatus={}))[f.IN_PROGRESS=0]="IN_PROGRESS",f[f.RESOLVED=1]="RESOLVED";var v=(y.all=function(e){return new y(function(i){var n=[],o=e.length;e.forEach(function(e,t){e.then(function(e){o--,n[t]=e,0==o&&i(n)}),n.push(null)})})},y.resolve=function(t){return new y(function(e){return e(t)})},y.external=function(){var t;return{promise:new y(function(e){t=e}),resolve:function(e){t(e)}}},y.prototype.then=function(e){this.status===p.IN_PROGRESS?this.listOfWaiters.push(e):e(this.resolution)},y.prototype.firstOneOnly=function(e){this.status===p.IN_PROGRESS?0===this.listOfWaiters.length&&this.listOfWaiters.push(e):e(this.resolution)},y.prototype.map=function(i){var e=this;return new y(function(t){e.then(function(e){t(i(e))})})},y.prototype.resolveNow=function(e,t){return this.status==p.IN_PROGRESS?e:t(this.resolution)},y.prototype.onDone=function(t){this.status=p.RESOLVED,this.resolution=t,this.listOfWaiters.forEach(function(e){return e(t)})},y.prototype.onReject=function(e){console.warn("TBI")},y);function y(e){this.status=p.IN_PROGRESS,this.resolution=null,this.listOfWaiters=[],e(this.onDone.bind(this),this.onReject.bind(this))}r.Promise=v},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(i,n){return function(e,t){n(e,t,i)}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(3),s=i(9),l=i(62),c=i(6),u=i(0),d=i(7),h=i(4),p=i(1),f=i(41),g=i(90),m=i(106),v=i(25),y=i(79);function b(e){return!0===e||"true"===e}var w,C=((w=_).prototype.agWire=function(e,t){this.gridOptions.api=e,this.gridOptions.columnApi=t,this.checkForDeprecated()},_.prototype.destroy=function(){this.gridOptions.api=null,this.gridOptions.columnApi=null},_.prototype.init=function(){!0!==this.gridOptions.suppressPropertyNamesCheck&&(this.checkGridOptionsProperties(),this.checkColumnDefProperties());var e=this.useAsyncEvents();this.eventService.addGlobalListener(this.globalEventHandler.bind(this),e),this.isGroupSelectsChildren()&&this.isSuppressParentsInRowNodes()&&console.warn("ag-Grid: groupSelectsChildren does not work wth suppressParentsInRowNodes, this selection method needs the part in rowNode to work"),this.isGroupSelectsChildren()&&(this.isRowSelectionMulti()||console.warn("ag-Grid: rowSelection must be 'multiple' for groupSelectsChildren to make sense"),this.isRowModelServerSide()&&console.warn("ag-Grid: group selects children is NOT support for Server Side Row Model. This is because the rows are lazy loaded, so selecting a group is not possible asthe grid has no way of knowing what the children are.")),this.isGroupRemoveSingleChildren()&&this.isGroupHideOpenParents()&&console.warn("ag-Grid: groupRemoveSingleChildren and groupHideOpenParents do not work with each other, you need to pick one. And don't ask us how to us these together on our support forum either you will get the same answer!")},_.prototype.checkColumnDefProperties=function(){var n=this;null!=this.gridOptions.columnDefs&&this.gridOptions.columnDefs.forEach(function(e){var t=Object.getOwnPropertyNames(e),i=m.ColDefUtil.ALL_PROPERTIES;n.checkProperties(t,i,i,"colDef","https://www.ag-grid.com/javascript-grid-column-properties/")})},_.prototype.checkGridOptionsProperties=function(){var e=Object.getOwnPropertyNames(this.gridOptions),t=g.PropertyKeys.ALL_PROPERTIES;Object.keys(v.Events).forEach(function(e){return t.push(l.ComponentUtil.getCallbackForEvent(v.Events[e]))});var i=t.concat("api","columnApi");this.checkProperties(e,i,t,"gridOptions","https://www.ag-grid.com/javascript-grid-properties/")},_.prototype.checkProperties=function(e,t,i,n,o){var r=p.Utils.fuzzyCheckStrings(e,t,i),a=Object.keys(r);a.forEach(function(e){var t=r[e];console.warn("ag-grid: invalid "+n+" property '"+e+"' did you mean any of these: "+t.slice(0,8).join(","))}),0<a.length&&console.warn("ag-grid: to see all the valid "+n+" properties please check: "+o)},_.prototype.getDomData=function(e,t){var i=e[this.domDataKey];return i?i[t]:void 0},_.prototype.setDomData=function(e,t,i){var n=e[this.domDataKey];p.Utils.missing(n)&&(n={},e[this.domDataKey]=n),n[t]=i},_.prototype.isEnterprise=function(){return this.enterprise},_.prototype.isRowSelection=function(){return"single"===this.gridOptions.rowSelection||"multiple"===this.gridOptions.rowSelection},_.prototype.isRowDeselection=function(){return b(this.gridOptions.rowDeselection)},_.prototype.isRowSelectionMulti=function(){return"multiple"===this.gridOptions.rowSelection},_.prototype.isRowMultiSelectWithClick=function(){return b(this.gridOptions.rowMultiSelectWithClick)},_.prototype.getContext=function(){return this.gridOptions.context},_.prototype.isPivotMode=function(){return b(this.gridOptions.pivotMode)},_.prototype.isPivotTotals=function(){return b(this.gridOptions.pivotTotals)},_.prototype.getPivotColumnGroupTotals=function(){return this.gridOptions.pivotColumnGroupTotals},_.prototype.getPivotRowTotals=function(){return this.gridOptions.pivotRowTotals},_.prototype.isRowModelInfinite=function(){return this.gridOptions.rowModelType===s.Constants.ROW_MODEL_TYPE_INFINITE},_.prototype.isRowModelViewport=function(){return this.gridOptions.rowModelType===s.Constants.ROW_MODEL_TYPE_VIEWPORT},_.prototype.isRowModelServerSide=function(){return this.gridOptions.rowModelType===s.Constants.ROW_MODEL_TYPE_SERVER_SIDE},_.prototype.isRowModelDefault=function(){return p.Utils.missing(this.gridOptions.rowModelType)||this.gridOptions.rowModelType===s.Constants.ROW_MODEL_TYPE_CLIENT_SIDE||this.gridOptions.rowModelType===s.Constants.DEPRECATED_ROW_MODEL_TYPE_NORMAL},_.prototype.isFullRowEdit=function(){return"fullRow"===this.gridOptions.editType},_.prototype.isSuppressFocusAfterRefresh=function(){return b(this.gridOptions.suppressFocusAfterRefresh)},_.prototype.isShowToolPanel=function(){return b(this.gridOptions.showToolPanel)},_.prototype.isToolPanelSuppressValues=function(){return b(this.gridOptions.toolPanelSuppressValues)},_.prototype.isToolPanelSuppressPivots=function(){return b(this.gridOptions.toolPanelSuppressPivots)||this.isTreeData()},_.prototype.isToolPanelSuppressRowGroups=function(){return b(this.gridOptions.toolPanelSuppressRowGroups)||this.isTreeData()},_.prototype.isToolPanelSuppressSideButtons=function(){return b(this.gridOptions.toolPanelSuppressSideButtons)},_.prototype.isToolPanelSuppressPivotMode=function(){return b(this.gridOptions.toolPanelSuppressPivotMode)||this.isTreeData()},_.prototype.isContractColumnSelection=function(){return b(this.gridOptions.contractColumnSelection)},_.prototype.isToolPanelSuppressColumnFilter=function(){return b(this.gridOptions.toolPanelSuppressColumnFilter)},_.prototype.isToolPanelSuppressColumnSelectAll=function(){return b(this.gridOptions.toolPanelSuppressColumnSelectAll)},_.prototype.isToolPanelSuppressColumnExpandAll=function(){return b(this.gridOptions.toolPanelSuppressColumnExpandAll)},_.prototype.isSuppressTouch=function(){return b(this.gridOptions.suppressTouch)},_.prototype.isSuppressRowTransform=function(){return b(this.gridOptions.suppressRowTransform)},_.prototype.useAsyncEvents=function(){return!b(this.gridOptions.suppressAsyncEvents)},_.prototype.isEnableCellChangeFlash=function(){return b(this.gridOptions.enableCellChangeFlash)},_.prototype.isGroupSelectsChildren=function(){var e=b(this.gridOptions.groupSelectsChildren);return e&&this.isTreeData()?(console.warn("ag-Grid: groupSelectsChildren does not work with tree data"),!1):e},_.prototype.isSuppressRowHoverHighlight=function(){return b(this.gridOptions.suppressRowHoverHighlight)},_.prototype.isGroupSelectsFiltered=function(){return b(this.gridOptions.groupSelectsFiltered)},_.prototype.isGroupHideOpenParents=function(){return b(this.gridOptions.groupHideOpenParents)},_.prototype.isGroupMultiAutoColumn=function(){return b(this.gridOptions.groupMultiAutoColumn)||b(this.gridOptions.groupHideOpenParents)},_.prototype.isGroupRemoveSingleChildren=function(){return b(this.gridOptions.groupRemoveSingleChildren)},_.prototype.isGroupRemoveLowestSingleChildren=function(){return b(this.gridOptions.groupRemoveLowestSingleChildren)},_.prototype.isGroupIncludeFooter=function(){return b(this.gridOptions.groupIncludeFooter)},_.prototype.isGroupIncludeTotalFooter=function(){return b(this.gridOptions.groupIncludeTotalFooter)},_.prototype.isGroupSuppressBlankHeader=function(){return b(this.gridOptions.groupSuppressBlankHeader)},_.prototype.isSuppressRowClickSelection=function(){return b(this.gridOptions.suppressRowClickSelection)},_.prototype.isSuppressCellSelection=function(){return b(this.gridOptions.suppressCellSelection)},_.prototype.isSuppressMultiSort=function(){return b(this.gridOptions.suppressMultiSort)},_.prototype.isMultiSortKeyCtrl=function(){return"ctrl"===this.gridOptions.multiSortKey},_.prototype.isGroupSuppressAutoColumn=function(){return b(this.gridOptions.groupSuppressAutoColumn)},_.prototype.isSuppressDragLeaveHidesColumns=function(){return b(this.gridOptions.suppressDragLeaveHidesColumns)},_.prototype.isSuppressScrollOnNewData=function(){return b(this.gridOptions.suppressScrollOnNewData)},_.prototype.isRowDragManaged=function(){return b(this.gridOptions.rowDragManaged)},_.prototype.isSuppressRowDrag=function(){return b(this.gridOptions.suppressRowDrag)},_.prototype.isGridAutoHeight=function(){return b(this.gridOptions.gridAutoHeight)},_.prototype.isSuppressHorizontalScroll=function(){return b(this.gridOptions.suppressHorizontalScroll)},_.prototype.isSuppressLoadingOverlay=function(){return b(this.gridOptions.suppressLoadingOverlay)},_.prototype.isSuppressNoRowsOverlay=function(){return b(this.gridOptions.suppressNoRowsOverlay)},_.prototype.isSuppressFieldDotNotation=function(){return b(this.gridOptions.suppressFieldDotNotation)},_.prototype.getPinnedTopRowData=function(){return this.gridOptions.pinnedTopRowData},_.prototype.getPinnedBottomRowData=function(){return this.gridOptions.pinnedBottomRowData},_.prototype.isFunctionsPassive=function(){return b(this.gridOptions.functionsPassive)},_.prototype.isSuppressTabbing=function(){return b(this.gridOptions.suppressTabbing)},_.prototype.isSuppressChangeDetection=function(){return b(this.gridOptions.suppressChangeDetection)},_.prototype.isSuppressAnimationFrame=function(){return b(this.gridOptions.suppressAnimationFrame)},_.prototype.getQuickFilterText=function(){return this.gridOptions.quickFilterText},_.prototype.isCacheQuickFilter=function(){return b(this.gridOptions.cacheQuickFilter)},_.prototype.isUnSortIcon=function(){return b(this.gridOptions.unSortIcon)},_.prototype.isSuppressMenuHide=function(){return b(this.gridOptions.suppressMenuHide)},_.prototype.isEnterMovesDownAfterEdit=function(){return b(this.gridOptions.enterMovesDownAfterEdit)},_.prototype.isEnterMovesDown=function(){return b(this.gridOptions.enterMovesDown)},_.prototype.getRowStyle=function(){return this.gridOptions.rowStyle},_.prototype.getRowClass=function(){return this.gridOptions.rowClass},_.prototype.getRowStyleFunc=function(){return this.gridOptions.getRowStyle},_.prototype.getRowClassFunc=function(){return this.gridOptions.getRowClass},_.prototype.rowClassRules=function(){return this.gridOptions.rowClassRules},_.prototype.getPopupParent=function(){return this.gridOptions.popupParent},_.prototype.getPostProcessPopupFunc=function(){return this.gridOptions.postProcessPopup},_.prototype.getDoesDataFlowerFunc=function(){return this.gridOptions.doesDataFlower},_.prototype.getPaginationNumberFormatterFunc=function(){return this.gridOptions.paginationNumberFormatter},_.prototype.getChildCountFunc=function(){return this.gridOptions.getChildCount},_.prototype.getDefaultGroupSortComparator=function(){return this.gridOptions.defaultGroupSortComparator},_.prototype.getIsFullWidthCellFunc=function(){return this.gridOptions.isFullWidthCell},_.prototype.getFullWidthCellRendererParams=function(){return this.gridOptions.fullWidthCellRendererParams},_.prototype.isEmbedFullWidthRows=function(){return b(this.gridOptions.embedFullWidthRows)},_.prototype.getBusinessKeyForNodeFunc=function(){return this.gridOptions.getBusinessKeyForNode},_.prototype.getApi=function(){return this.gridOptions.api},_.prototype.getColumnApi=function(){return this.gridOptions.columnApi},_.prototype.isDeltaRowDataMode=function(){return b(this.gridOptions.deltaRowDataMode)},_.prototype.isEnsureDomOrder=function(){return b(this.gridOptions.ensureDomOrder)},_.prototype.isEnableColResize=function(){return b(this.gridOptions.enableColResize)},_.prototype.isSingleClickEdit=function(){return b(this.gridOptions.singleClickEdit)},_.prototype.isSuppressClickEdit=function(){return b(this.gridOptions.suppressClickEdit)},_.prototype.isStopEditingWhenGridLosesFocus=function(){return b(this.gridOptions.stopEditingWhenGridLosesFocus)},_.prototype.getGroupDefaultExpanded=function(){return this.gridOptions.groupDefaultExpanded},_.prototype.getMaxConcurrentDatasourceRequests=function(){return this.gridOptions.maxConcurrentDatasourceRequests},_.prototype.getMaxBlocksInCache=function(){return this.gridOptions.maxBlocksInCache},_.prototype.getCacheOverflowSize=function(){return this.gridOptions.cacheOverflowSize},_.prototype.getPaginationPageSize=function(){return this.gridOptions.paginationPageSize},_.prototype.getCacheBlockSize=function(){return this.gridOptions.cacheBlockSize},_.prototype.getInfiniteInitialRowCount=function(){return this.gridOptions.infiniteInitialRowCount},_.prototype.isPurgeClosedRowNodes=function(){return b(this.gridOptions.purgeClosedRowNodes)},_.prototype.isSuppressPaginationPanel=function(){return b(this.gridOptions.suppressPaginationPanel)},_.prototype.getRowData=function(){return this.gridOptions.rowData},_.prototype.isGroupUseEntireRow=function(){return b(this.gridOptions.groupUseEntireRow)},_.prototype.isEnableRtl=function(){return b(this.gridOptions.enableRtl)},_.prototype.getAutoGroupColumnDef=function(){return this.gridOptions.autoGroupColumnDef},_.prototype.isGroupSuppressRow=function(){return b(this.gridOptions.groupSuppressRow)},_.prototype.getRowGroupPanelShow=function(){return this.gridOptions.rowGroupPanelShow},_.prototype.getPivotPanelShow=function(){return this.gridOptions.pivotPanelShow},_.prototype.isAngularCompileRows=function(){return b(this.gridOptions.angularCompileRows)},_.prototype.isAngularCompileFilters=function(){return b(this.gridOptions.angularCompileFilters)},_.prototype.isAngularCompileHeaders=function(){return b(this.gridOptions.angularCompileHeaders)},_.prototype.isDebug=function(){return b(this.gridOptions.debug)},_.prototype.getColumnDefs=function(){return this.gridOptions.columnDefs},_.prototype.getColumnTypes=function(){return this.gridOptions.columnTypes},_.prototype.getDatasource=function(){return this.gridOptions.datasource},_.prototype.getViewportDatasource=function(){return this.gridOptions.viewportDatasource},_.prototype.getServerSideDatasource=function(){return this.gridOptions.serverSideDatasource},_.prototype.isEnableSorting=function(){return b(this.gridOptions.enableSorting)||b(this.gridOptions.enableServerSideSorting)},_.prototype.isAccentedSort=function(){return b(this.gridOptions.accentedSort)},_.prototype.isEnableCellExpressions=function(){return b(this.gridOptions.enableCellExpressions)},_.prototype.isEnableGroupEdit=function(){return b(this.gridOptions.enableGroupEdit)},_.prototype.isSuppressMiddleClickScrolls=function(){return b(this.gridOptions.suppressMiddleClickScrolls)},_.prototype.isSuppressPreventDefaultOnMouseWheel=function(){return b(this.gridOptions.suppressPreventDefaultOnMouseWheel)},_.prototype.isSuppressColumnVirtualisation=function(){return b(this.gridOptions.suppressColumnVirtualisation)},_.prototype.isSuppressContextMenu=function(){return b(this.gridOptions.suppressContextMenu)},_.prototype.isAllowContextMenuWithControlKey=function(){return b(this.gridOptions.allowContextMenuWithControlKey)},_.prototype.isSuppressCopyRowsToClipboard=function(){return b(this.gridOptions.suppressCopyRowsToClipboard)},_.prototype.isSuppressClipboardPaste=function(){return b(this.gridOptions.suppressClipboardPaste)},_.prototype.isEnableFilter=function(){return b(this.gridOptions.enableFilter)||b(this.gridOptions.enableServerSideFilter)},_.prototype.isPagination=function(){return b(this.gridOptions.pagination)},_.prototype.isSuppressEnterpriseResetOnNewColumns=function(){return b(this.gridOptions.suppressEnterpriseResetOnNewColumns)},_.prototype.getProcessDataFromClipboardFunc=function(){return this.gridOptions.processDataFromClipboard},_.prototype.getBatchUpdateWaitMillis=function(){return p.Utils.exists(this.gridOptions.batchUpdateWaitMillis)?this.gridOptions.batchUpdateWaitMillis:s.Constants.BATCH_WAIT_MILLIS},_.prototype.isEnableServerSideFilter=function(){return this.gridOptions.enableServerSideFilter},_.prototype.isEnableServerSideSorting=function(){return b(this.gridOptions.enableServerSideSorting)},_.prototype.isSuppressMovableColumns=function(){return b(this.gridOptions.suppressMovableColumns)},_.prototype.isAnimateRows=function(){return!this.isEnsureDomOrder()&&b(this.gridOptions.animateRows)},_.prototype.isSuppressColumnMoveAnimation=function(){return b(this.gridOptions.suppressColumnMoveAnimation)},_.prototype.isSuppressAggFuncInHeader=function(){return b(this.gridOptions.suppressAggFuncInHeader)},_.prototype.isSuppressAggAtRootLevel=function(){return b(this.gridOptions.suppressAggAtRootLevel)},_.prototype.isEnableRangeSelection=function(){return b(this.gridOptions.enableRangeSelection)},_.prototype.isSuppressMultiRangeSelection=function(){return b(this.gridOptions.suppressMultiRangeSelection)},_.prototype.isPaginationAutoPageSize=function(){return b(this.gridOptions.paginationAutoPageSize)},_.prototype.isRememberGroupStateWhenNewData=function(){return b(this.gridOptions.rememberGroupStateWhenNewData)},_.prototype.getIcons=function(){return this.gridOptions.icons},_.prototype.getAggFuncs=function(){return this.gridOptions.aggFuncs},_.prototype.getSortingOrder=function(){return this.gridOptions.sortingOrder},_.prototype.getAlignedGrids=function(){return this.gridOptions.alignedGrids},_.prototype.isMasterDetail=function(){var e=this,t=b(this.gridOptions.masterDetail);return p.Utils.doOnce(function(){t&&!e.enterprise&&console.warn("ag-grid: Master Detail is an Enterprise feature of ag-Grid.")},"MasterDetailEnterpriseCheck"),t&&this.enterprise},_.prototype.getIsRowMasterFunc=function(){return this.gridOptions.isRowMaster},_.prototype.getIsRowSelectableFunc=function(){return this.gridOptions.isRowSelectable},_.prototype.getGroupRowRendererParams=function(){return this.gridOptions.groupRowRendererParams},_.prototype.getOverlayLoadingTemplate=function(){return this.gridOptions.overlayLoadingTemplate},_.prototype.getOverlayNoRowsTemplate=function(){return this.gridOptions.overlayNoRowsTemplate},_.prototype.isSuppressAutoSize=function(){return b(this.gridOptions.suppressAutoSize)},_.prototype.isSuppressParentsInRowNodes=function(){return b(this.gridOptions.suppressParentsInRowNodes)},_.prototype.isEnableStatusBar=function(){return b(this.gridOptions.enableStatusBar)},_.prototype.isAlwaysShowStatusBar=function(){return b(this.gridOptions.alwaysShowStatusBar)},_.prototype.isFunctionsReadOnly=function(){return b(this.gridOptions.functionsReadOnly)},_.prototype.isFloatingFilter=function(){return this.gridOptions.floatingFilter},_.prototype.isEnableOldSetFilterModel=function(){return b(this.gridOptions.enableOldSetFilterModel)},_.prototype.getDefaultColDef=function(){return this.gridOptions.defaultColDef},_.prototype.getDefaultColGroupDef=function(){return this.gridOptions.defaultColGroupDef},_.prototype.getDefaultExportParams=function(){return this.gridOptions.defaultExportParams},_.prototype.isSuppressCsvExport=function(){return b(this.gridOptions.suppressCsvExport)},_.prototype.isSuppressExcelExport=function(){return b(this.gridOptions.suppressExcelExport)},_.prototype.isSuppressMakeColumnVisibleAfterUnGroup=function(){return b(this.gridOptions.suppressMakeColumnVisibleAfterUnGroup)},_.prototype.getNodeChildDetailsFunc=function(){return this.gridOptions.getNodeChildDetails},_.prototype.getDataPathFunc=function(){return this.gridOptions.getDataPath},_.prototype.getGroupRowAggNodesFunc=function(){return this.gridOptions.groupRowAggNodes},_.prototype.getContextMenuItemsFunc=function(){return this.gridOptions.getContextMenuItems},_.prototype.getMainMenuItemsFunc=function(){return this.gridOptions.getMainMenuItems},_.prototype.getRowNodeIdFunc=function(){return this.gridOptions.getRowNodeId},_.prototype.getNavigateToNextCellFunc=function(){return this.gridOptions.navigateToNextCell},_.prototype.getTabToNextCellFunc=function(){return this.gridOptions.tabToNextCell},_.prototype.isTreeData=function(){return b(this.gridOptions.treeData)},_.prototype.isValueCache=function(){return b(this.gridOptions.valueCache)},_.prototype.isValueCacheNeverExpires=function(){return b(this.gridOptions.valueCacheNeverExpires)},_.prototype.isAggregateOnlyChangedColumns=function(){return b(this.gridOptions.aggregateOnlyChangedColumns)},_.prototype.getProcessSecondaryColDefFunc=function(){return this.gridOptions.processSecondaryColDef},_.prototype.getProcessSecondaryColGroupDefFunc=function(){return this.gridOptions.processSecondaryColGroupDef},_.prototype.getSendToClipboardFunc=function(){return this.gridOptions.sendToClipboard},_.prototype.getProcessRowPostCreateFunc=function(){return this.gridOptions.processRowPostCreate},_.prototype.getProcessCellForClipboardFunc=function(){return this.gridOptions.processCellForClipboard},_.prototype.getProcessHeaderForClipboardFunc=function(){return this.gridOptions.processHeaderForClipboard},_.prototype.getProcessCellFromClipboardFunc=function(){return this.gridOptions.processCellFromClipboard},_.prototype.getViewportRowModelPageSize=function(){return function(e,t){return 0<e?e:t}(this.gridOptions.viewportRowModelPageSize,5)},_.prototype.getViewportRowModelBufferSize=function(){return function(e,t){return 0<=e?e:t}(this.gridOptions.viewportRowModelBufferSize,5)},_.prototype.getPostSortFunc=function(){return this.gridOptions.postSort},_.prototype.getClipboardDeliminator=function(){return p.Utils.exists(this.gridOptions.clipboardDeliminator)?this.gridOptions.clipboardDeliminator:"\t"},_.prototype.setProperty=function(e,t){var i=this.gridOptions,n=i[e];if(n!==t){var o={type:e,currentValue:i[e]=t,previousValue:n};this.propertyEventService.dispatchEvent(o)}},_.prototype.addEventListener=function(e,t){w.checkEventDeprecation(e),this.propertyEventService.addEventListener(e,t)},_.checkEventDeprecation=function(e){e===v.Events.DEPRECATED_EVENT_GRID_SIZE_CHANGED&&console.warn("ag-Grid: Since ag-Grid v18 event "+v.Events.DEPRECATED_EVENT_GRID_SIZE_CHANGED+" no longer exists."),"floatingRowDataChanged"===e&&console.warn("ag-Grid: floatingRowDataChanged is now called pinnedRowDataChanged")},_.prototype.removeEventListener=function(e,t){this.propertyEventService.removeEventListener(e,t)},_.prototype.getAutoSizePadding=function(){return 0<this.gridOptions.autoSizePadding?this.gridOptions.autoSizePadding:20},_.prototype.getHeaderHeight=function(){return"number"==typeof this.gridOptions.headerHeight?this.gridOptions.headerHeight:this.specialForNewMaterial(25,"headerHeight")},_.prototype.getFloatingFiltersHeight=function(){return"number"==typeof this.gridOptions.floatingFiltersHeight?this.gridOptions.floatingFiltersHeight:this.specialForNewMaterial(25,"headerHeight")},_.prototype.getGroupHeaderHeight=function(){return"number"==typeof this.gridOptions.groupHeaderHeight?this.gridOptions.groupHeaderHeight:this.getHeaderHeight()},_.prototype.getPivotHeaderHeight=function(){return"number"==typeof this.gridOptions.pivotHeaderHeight?this.gridOptions.pivotHeaderHeight:this.getHeaderHeight()},_.prototype.getPivotGroupHeaderHeight=function(){return"number"==typeof this.gridOptions.pivotGroupHeaderHeight?this.gridOptions.pivotGroupHeaderHeight:this.getGroupHeaderHeight()},_.prototype.isExternalFilterPresent=function(){return"function"==typeof this.gridOptions.isExternalFilterPresent&&this.gridOptions.isExternalFilterPresent()},_.prototype.doesExternalFilterPass=function(e){return"function"==typeof this.gridOptions.doesExternalFilterPass&&this.gridOptions.doesExternalFilterPass(e)},_.prototype.getDocument=function(){var e;return p.Utils.exists(this.gridOptions.getDocument)&&(e=this.gridOptions.getDocument()),p.Utils.exists(e)?e:document},_.prototype.getLayoutInterval=function(){return"number"==typeof this.gridOptions.layoutInterval?this.gridOptions.layoutInterval:s.Constants.LAYOUT_INTERVAL},_.prototype.getMinColWidth=function(){return this.gridOptions.minColWidth>w.MIN_COL_WIDTH?this.gridOptions.minColWidth:w.MIN_COL_WIDTH},_.prototype.getMaxColWidth=function(){return this.gridOptions.maxColWidth>w.MIN_COL_WIDTH?this.gridOptions.maxColWidth:null},_.prototype.getColWidth=function(){return"number"!=typeof this.gridOptions.colWidth||this.gridOptions.colWidth<w.MIN_COL_WIDTH?200:this.gridOptions.colWidth},_.prototype.getRowBuffer=function(){return"number"==typeof this.gridOptions.rowBuffer?(this.gridOptions.rowBuffer<0&&console.warn("ag-Grid: rowBuffer should not be negative"),this.gridOptions.rowBuffer):s.Constants.ROW_BUFFER_SIZE},_.prototype.getScrollbarWidth=function(){var e=this.gridOptions.scrollbarWidth;return("number"!=typeof e||e<0)&&(e=p.Utils.getScrollbarWidth()),e},_.prototype.checkForDeprecated=function(){var e=this.gridOptions;e.suppressUnSort&&console.warn("ag-grid: as of v1.12.4 suppressUnSort is not used. Please use sortingOrder instead."),e.suppressDescSort&&console.warn("ag-grid: as of v1.12.4 suppressDescSort is not used. Please use sortingOrder instead."),e.groupAggFields&&console.warn("ag-grid: as of v3 groupAggFields is not used. Please add appropriate agg fields to your columns."),e.groupHidePivotColumns&&console.warn("ag-grid: as of v3 groupHidePivotColumns is not used as pivot columns are now called rowGroup columns. Please refer to the documentation"),e.groupKeys&&console.warn("ag-grid: as of v3 groupKeys is not used. You need to set rowGroupIndex on the columns to group. Please refer to the documentation"),"boolean"==typeof e.groupDefaultExpanded&&console.warn("ag-grid: groupDefaultExpanded can no longer be boolean. for groupDefaultExpanded=true, use groupDefaultExpanded=9999 instead, to expand all the groups"),(e.onRowDeselected||e.rowDeselected)&&console.warn("ag-grid: since version 3.4 event rowDeselected no longer exists, please check the docs"),e.rowsAlreadyGrouped&&console.warn("ag-grid: since version 3.4 rowsAlreadyGrouped no longer exists, please use getNodeChildDetails() instead"),e.groupAggFunction&&console.warn("ag-grid: since version 4.3.x groupAggFunction is now called groupRowAggNodes"),e.checkboxSelection&&console.warn("ag-grid: since version 8.0.x checkboxSelection is not supported as a grid option. If you want this on all columns, use defaultColDef instead and set it there"),e.paginationInitialRowCount&&console.warn("ag-grid: since version 9.0.x paginationInitialRowCount is now called infiniteInitialRowCount"),e.infinitePageSize&&console.warn("ag-grid: since version 9.0.x infinitePageSize is now called cacheBlockSize"),e.infiniteBlockSize&&console.warn("ag-grid: since version 10.0.x infiniteBlockSize is now called cacheBlockSize"),e.maxPagesInCache&&console.warn("ag-grid: since version 10.0.x maxPagesInCache is now called maxBlocksInCache"),e.paginationOverflowSize&&console.warn("ag-grid: since version 10.0.x paginationOverflowSize is now called cacheOverflowSize"),e.forPrint&&console.warn('ag-grid: since version 10.1.x, use property domLayout="forPrint" instead of forPrint=true'),e.suppressMenuFilterPanel&&console.warn("ag-grid: since version 11.0.x, use property colDef.menuTabs=['generalMenuTab','columnsMenuTab'] instead of suppressMenuFilterPanel=true"),e.suppressMenuMainPanel&&console.warn("ag-grid: since version 11.0.x, use property colDef.menuTabs=['filterMenuTab','columnsMenuTab'] instead of suppressMenuMainPanel=true"),e.suppressMenuColumnPanel&&console.warn("ag-grid: since version 11.0.x, use property colDef.menuTabs=['generalMenuTab','filterMenuTab'] instead of suppressMenuColumnPanel=true"),e.suppressUseColIdForGroups&&console.warn("ag-grid: since version 11.0.x, this is not in use anymore. You should be able to remove it from your definition"),e.groupColumnDef&&console.warn("ag-grid: since version 11.0.x, groupColumnDef has been renamed, this property is now called autoGroupColumnDef. Please change your configuration accordingly"),e.slaveGrids&&console.warn("ag-grid: since version 12.x, slaveGrids has been renamed, this property is now called alignedGrids. Please change your configuration accordingly"),e.floatingTopRowData&&console.warn("ag-grid: since version 12.x, floatingTopRowData is now called pinnedTopRowData"),e.floatingBottomRowData&&console.warn("ag-grid: since version 12.x, floatingBottomRowData is now called pinnedBottomRowData"),e.paginationStartPage&&console.warn("ag-grid: since version 12.x, paginationStartPage is gone, please call api.paginationGoToPage("+e.paginationStartPage+") instead."),e.getHeaderCellTemplate&&console.warn("ag-grid: since version 15.x, getHeaderCellTemplate is gone, please check the header documentation on how to set header templates."),e.headerCellTemplate&&console.warn("ag-grid: since version 15.x, headerCellTemplate is gone, please check the header documentation on how to set header templates."),e.headerCellRenderer&&console.warn("ag-grid: since version 15.x, headerCellRenderer is gone, please check the header documentation on how to set header templates."),e.angularCompileHeaders&&console.warn("ag-grid: since version 15.x, angularCompileHeaders is gone, please see the getting started for Angular 1 docs to see how to do headers in Angular 1.x."),"forPrint"===e.domLayout&&console.warn("ag-grid: since version 18.x, forPrint is no longer supported, as same can be achieved using autoHeight (and set the grid width accordingly). please use autoHeight instead."),"autoHeight"===e.domLayout&&(console.warn("ag-grid: since version 18.x, domLayout is gone, instead if doing auto-height, set gridAutoHeight=true."),e.gridAutoHeight=!0),e.pivotTotals&&(console.warn("ag-grid: since version 18.x, pivotTotals has been removed, instead if using pivotTotals, set pivotColumnGroupTotals='before'|'after'."),e.pivotColumnGroupTotals="before"),"inMemory"===e.rowModelType&&(console.warn("ag-grid: since version 18.x, The In Memory Row Model has been renamed to the Client Side Row Model, set rowModelType='clientSide' instead."),e.rowModelType="clientSide"),"enterprise"===e.rowModelType&&(console.warn("ag-grid: since version 18.x, The Enterprise Row Model has been renamed to the Server Side Row Model, set rowModelType='serverSide' instead."),e.rowModelType="serverSide")},_.prototype.getLocaleTextFunc=function(){if(this.gridOptions.localeTextFunc)return this.gridOptions.localeTextFunc;var n=this;return function(e,t){var i=n.gridOptions.localeText;return i&&i[e]?i[e]:t}},_.prototype.globalEventHandler=function(e,t){var i=l.ComponentUtil.getCallbackForEvent(e);"function"==typeof this.gridOptions[i]&&this.gridOptions[i](t)},_.prototype.getRowHeightAsNumber=function(){var e=this.gridOptions.rowHeight;return p.Utils.missing(e)?this.getDefaultRowHeight():this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:(console.warn("ag-Grid row height must be a number if not using standard row model"),this.getDefaultRowHeight())},_.prototype.getRowHeightForNode=function(e){if("function"==typeof this.gridOptions.getRowHeight){var t={node:e,data:e.data,api:this.gridOptions.api,context:this.gridOptions.context};return this.gridOptions.getRowHeight(t)}if(e.detail&&this.isMasterDetail())return this.isNumeric(this.gridOptions.detailRowHeight)?this.gridOptions.detailRowHeight:300;var i=this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:this.getDefaultRowHeight();if(this.columnController.isAutoRowHeightActive()){var n=this.autoHeightCalculator.getPreferredHeightForRow(e);return i<n?n:i}return i},_.prototype.isDynamicRowHeight=function(){return"function"==typeof this.gridOptions.getRowHeight},_.prototype.getVirtualItemHeight=function(){return this.specialForNewMaterial(20,"virtualItemHeight")},_.prototype.isNumeric=function(e){return!isNaN(e)&&"number"==typeof e},_.prototype.specialForNewMaterial=function(e,t){var i=this.environment.getTheme();return 0===i.indexOf("ag-theme")?this.environment.getSassVariable(i,t):e},_.prototype.getDefaultRowHeight=function(){return this.specialForNewMaterial(25,"rowHeight")},_.MIN_COL_WIDTH=10,_.PROP_HEADER_HEIGHT="headerHeight",_.PROP_GROUP_REMOVE_SINGLE_CHILDREN="groupRemoveSingleChildren",_.PROP_GROUP_REMOVE_LOWEST_SINGLE_CHILDREN="groupRemoveLowestSingleChildren",_.PROP_PIVOT_HEADER_HEIGHT="pivotHeaderHeight",_.PROP_SUPPRESS_CLIPBOARD_PASTE="suppressClipboardPaste",_.PROP_GROUP_HEADER_HEIGHT="groupHeaderHeight",_.PROP_PIVOT_GROUP_HEADER_HEIGHT="pivotGroupHeaderHeight",_.PROP_FLOATING_FILTERS_HEIGHT="floatingFiltersHeight",_.PROP_SUPPRESS_ROW_DRAG="suppressRowDrag",_.PROP_POPUP_PARENT="popupParent",_.PROP_GRID_AUTO_HEIGHT="gridAutoHeight",n([u.Autowired("gridOptions"),o("design:type",Object)],_.prototype,"gridOptions",void 0),n([u.Autowired("columnController"),o("design:type",h.ColumnController)],_.prototype,"columnController",void 0),n([u.Autowired("eventService"),o("design:type",a.EventService)],_.prototype,"eventService",void 0),n([u.Autowired("enterprise"),o("design:type",Boolean)],_.prototype,"enterprise",void 0),n([u.Autowired("frameworkFactory"),o("design:type",Object)],_.prototype,"frameworkFactory",void 0),n([u.Autowired("gridApi"),o("design:type",c.GridApi)],_.prototype,"gridApi",void 0),n([u.Autowired("columnApi"),o("design:type",d.ColumnApi)],_.prototype,"columnApi",void 0),n([u.Autowired("environment"),o("design:type",f.Environment)],_.prototype,"environment",void 0),n([u.Autowired("autoHeightCalculator"),o("design:type",y.AutoHeightCalculator)],_.prototype,"autoHeightCalculator",void 0),n([r(0,u.Qualifier("gridApi")),r(1,u.Qualifier("columnApi")),o("design:type",Function),o("design:paramtypes",[c.GridApi,d.ColumnApi]),o("design:returntype",void 0)],_.prototype,"agWire",null),n([u.PreDestroy,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],_.prototype,"destroy",null),n([u.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],_.prototype,"init",null),_=w=n([u.Bean("gridOptionsWrapper")],_));function _(){this.propertyEventService=new a.EventService,this.domDataKey="__AG_"+Math.random().toString()}t.GridOptionsWrapper=C},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(i,n){return function(e,t){n(e,t,i)}};Object.defineProperty(t,"__esModule",{value:!0});var s,a=i(12),l=i(1),c=i(0),u=i(0),d=i(2),h=((s=p).prototype.setBeans=function(e,t,i){if(void 0===i&&(i=null),this.logger=e.create("EventService"),i){var n=t.useAsyncEvents();this.addGlobalListener(i,n)}},p.prototype.getListenerList=function(e,t){var i=t?this.allAsyncListeners:this.allSyncListeners,n=i[e];return n||(n=[],i[e]=n),n},p.prototype.addEventListener=function(e,t,i){void 0===i&&(i=!1);var n=this.getListenerList(e,i);n.indexOf(t)<0&&n.push(t)},p.prototype.addModalPriorityEventListener=function(e,t,i){void 0===i&&(i=!1),this.addEventListener(e+s.PRIORITY,t,i)},p.prototype.addGlobalListener=function(e,t){void 0===t&&(t=!1),t?this.globalAsyncListeners.push(e):this.globalSyncListeners.push(e)},p.prototype.removeEventListener=function(e,t,i){void 0===i&&(i=!1);var n=this.getListenerList(e,i);l.Utils.removeFromArray(n,t)},p.prototype.removeGlobalListener=function(e,t){void 0===t&&(t=!1),t?l.Utils.removeFromArray(this.globalAsyncListeners,e):l.Utils.removeFromArray(this.globalSyncListeners,e)},p.prototype.dispatchEvent=function(e){this.dispatchToListeners(e,!0),this.dispatchToListeners(e,!1)},p.prototype.dispatchToListeners=function(t,i){var n=this,e=i?this.globalAsyncListeners:this.globalSyncListeners,o=t.type,r=this.getListenerList(o+s.PRIORITY,i);l.Utils.forEachSnapshotFirst(r,function(e){i?n.dispatchAsync(function(){return e(t)}):e(t)});var a=this.getListenerList(o,i);l.Utils.forEachSnapshotFirst(a,function(e){i?n.dispatchAsync(function(){return e(t)}):e(t)}),l.Utils.forEachSnapshotFirst(e,function(e){i?n.dispatchAsync(function(){return e(o,t)}):e(o,t)})},p.prototype.dispatchAsync=function(e){this.asyncFunctionsQueue.push(e),this.scheduled||(setTimeout(this.flushAsyncQueue.bind(this),0),this.scheduled=!0)},p.prototype.flushAsyncQueue=function(){this.scheduled=!1;var e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach(function(e){return e()})},p.PRIORITY="-P1",n([r(0,u.Qualifier("loggerFactory")),r(1,u.Qualifier("gridOptionsWrapper")),r(2,u.Qualifier("globalEventListener")),o("design:type",Function),o("design:paramtypes",[a.LoggerFactory,d.GridOptionsWrapper,Function]),o("design:returntype",void 0)],p.prototype,"setBeans",null),p=s=n([c.Bean("eventService")],p));function p(){this.allSyncListeners={},this.allAsyncListeners={},this.globalSyncListeners=[],this.globalAsyncListeners=[],this.asyncFunctionsQueue=[],this.scheduled=!1}t.EventService=h},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(i,n){return function(e,t){n(e,t,i)}};Object.defineProperty(t,"__esModule",{value:!0});var g=i(1),a=i(26),l=i(10),s=i(2),c=i(19),u=i(38),d=i(48),h=i(39),p=i(3),f=i(31),m=i(12),v=i(5),y=i(32),b=i(83),w=i(0),C=i(53),_=i(104),A=i(33),E=i(6),x=i(7),S=(T.prototype.init=function(){var e=this.gridOptionsWrapper.isPivotMode();this.suppressColumnVirtualisation=this.gridOptionsWrapper.isSuppressColumnVirtualisation(),this.isPivotSettingAllowed(e)&&(this.pivotMode=e),this.usingTreeData=this.gridOptionsWrapper.isTreeData()},T.prototype.isAutoRowHeightActive=function(){return this.autoRowHeightColumns&&0<this.autoRowHeightColumns.length},T.prototype.getAllAutoRowHeightCols=function(){return this.autoRowHeightColumns},T.prototype.setVirtualViewportLeftAndRight=function(){this.gridOptionsWrapper.isEnableRtl()?(this.viewportLeft=this.bodyWidth-this.scrollPosition-this.scrollWidth,this.viewportRight=this.bodyWidth-this.scrollPosition):(this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition)},T.prototype.getDisplayedColumnsStartingAt=function(e){for(var t=e,i=[];g.Utils.exists(t);)i.push(t),t=this.getDisplayedColAfter(t);return i},T.prototype.checkDisplayedVirtualColumns=function(){if(g.Utils.exists(this.displayedCenterColumns)){var e=this.allDisplayedVirtualColumns.map(function(e){return e.getId()}).join("#");if(this.updateVirtualSets(),e!==this.allDisplayedVirtualColumns.map(function(e){return e.getId()}).join("#")){var t={type:v.Events.EVENT_VIRTUAL_COLUMNS_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(t)}}},T.prototype.setVirtualViewportPosition=function(e,t){e===this.scrollWidth&&t===this.scrollPosition&&!this.bodyWidthDirty||(this.scrollWidth=e,this.scrollPosition=t,this.bodyWidthDirty=!0,this.setVirtualViewportLeftAndRight(),this.ready&&this.checkDisplayedVirtualColumns())},T.prototype.isPivotMode=function(){return this.pivotMode},T.prototype.isPivotSettingAllowed=function(e){return!e||!this.gridOptionsWrapper.isTreeData()||(console.warn("ag-Grid: Pivot mode not available in conjunction Tree Data i.e. 'gridOptions.treeData: true'"),!1)},T.prototype.setPivotMode=function(e,t){if(void 0===t&&(t="api"),e!==this.pivotMode&&this.isPivotSettingAllowed(this.pivotMode)){this.pivotMode=e,this.updateDisplayedColumns(t);var i={type:v.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(i)}},T.prototype.getSecondaryPivotColumn=function(n,e){if(!this.secondaryColumnsPresent)return null;var o=this.getPrimaryColumn(e),r=null;return this.secondaryColumns.forEach(function(e){var t=e.getColDef().pivotKeys,i=e.getColDef().pivotValueColumn;g.Utils.compareArrays(t,n)&&i===o&&(r=e)}),r},T.prototype.setBeans=function(e){this.logger=e.create("ColumnController")},T.prototype.setFirstRightAndLastLeftPinned=function(t){var i,n;n=this.gridOptionsWrapper.isEnableRtl()?(i=this.displayedLeftColumns?this.displayedLeftColumns[0]:null,this.displayedRightColumns?this.displayedRightColumns[this.displayedRightColumns.length-1]:null):(i=this.displayedLeftColumns?this.displayedLeftColumns[this.displayedLeftColumns.length-1]:null,this.displayedRightColumns?this.displayedRightColumns[0]:null),this.gridColumns.forEach(function(e){e.setLastLeftPinned(e===i,t),e.setFirstRightPinned(e===n,t)})},T.prototype.autoSizeColumns=function(e,n){var o=this;void 0===n&&(n="api");for(var r=[],a=-1;0!==a;)a=0,this.actionOnGridColumns(e,function(e){if(!(0<=r.indexOf(e))){var t=o.autoWidthCalculator.getPreferredWidthForColumn(e);if(0<t){var i=o.normaliseColumnWidth(e,t);e.setActualWidth(i,n),r.push(e),a++}return!0}},n);if(0<r.length){var t={type:v.Events.EVENT_COLUMN_RESIZED,columns:r,column:1===r.length?r[0]:null,finished:!0,api:this.gridApi,columnApi:this.columnApi,source:"autosizeColumns"};this.eventService.dispatchEvent(t)}},T.prototype.autoSizeColumn=function(e,t){void 0===t&&(t="api"),this.autoSizeColumns([e],t)},T.prototype.autoSizeAllColumns=function(e){void 0===e&&(e="api");var t=this.getAllDisplayedColumns();this.autoSizeColumns(t,e)},T.prototype.getColumnsFromTree=function(e){var o=[];return function e(t){for(var i=0;i<t.length;i++){var n=t[i];n instanceof l.Column?o.push(n):n instanceof y.OriginalColumnGroup&&e(n.getChildren())}}(e),o},T.prototype.getAllDisplayedColumnGroups=function(){return this.displayedLeftColumnTree&&this.displayedRightColumnTree&&this.displayedCentreColumnTree?this.displayedLeftColumnTree.concat(this.displayedCentreColumnTree).concat(this.displayedRightColumnTree):null},T.prototype.getPrimaryColumnTree=function(){return this.primaryBalancedTree},T.prototype.getHeaderRowCount=function(){return this.gridHeaderRowCount},T.prototype.getLeftDisplayedColumnGroups=function(){return this.displayedLeftColumnTree},T.prototype.getRightDisplayedColumnGroups=function(){return this.displayedRightColumnTree},T.prototype.getCenterDisplayedColumnGroups=function(){return this.displayedCentreColumnTree},T.prototype.getDisplayedColumnGroups=function(e){switch(e){case l.Column.PINNED_LEFT:return this.getLeftDisplayedColumnGroups();case l.Column.PINNED_RIGHT:return this.getRightDisplayedColumnGroups();default:return this.getCenterDisplayedColumnGroups()}},T.prototype.isColumnDisplayed=function(e){return 0<=this.getAllDisplayedColumns().indexOf(e)},T.prototype.getAllDisplayedColumns=function(){return this.allDisplayedColumns},T.prototype.getAllDisplayedVirtualColumns=function(){return this.allDisplayedVirtualColumns},T.prototype.getDisplayedLeftColumnsForRow=function(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedLeftColumns):this.displayedLeftColumns},T.prototype.getDisplayedRightColumnsForRow=function(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedRightColumns):this.displayedRightColumns},T.prototype.getDisplayedColumnsForRow=function(s,l,c,u){for(var d,h=[],p=null,e=function(e){var t,i=l[e],n=i.getColSpan(s),o=[i];if(1<n){for(var r=n-1,a=1;a<=r;a++)o.push(l[e+a]);e+=r}c?(t=!1,o.forEach(function(e){c(e)&&(t=!0)})):t=!0,t&&(0===h.length&&p&&u&&u(i)&&h.push(p),h.push(i)),p=i,d=e},t=0;t<l.length;t++)e(t),t=d;return h},T.prototype.getAllDisplayedCenterVirtualColumnsForRow=function(e){var t=this;if(!this.colSpanActive)return this.allDisplayedCenterVirtualColumns;var i=this.suppressColumnVirtualisation?null:this.isColumnInViewport.bind(this);return this.getDisplayedColumnsForRow(e,this.displayedCenterColumns,i,function(e){return e.getLeft()>t.viewportLeft})},T.prototype.isColumnInViewport=function(e){var t=e.getLeft(),i=e.getLeft()+e.getActualWidth(),n=t<this.viewportLeft&&i<this.viewportLeft,o=t>this.viewportRight&&i>this.viewportRight;return!n&&!o},T.prototype.getPinnedLeftContainerWidth=function(){return this.getWidthOfColsInList(this.displayedLeftColumns)},T.prototype.getPinnedRightContainerWidth=function(){return this.getWidthOfColsInList(this.displayedRightColumns)},T.prototype.updatePrimaryColumnList=function(e,i,n,o,t,r){var a=this;if(void 0===r&&(r="api"),!g.Utils.missingOrEmpty(e)){var s=!1;if(e.forEach(function(e){var t=a.getPrimaryColumn(e);if(t){if(n){if(0<=i.indexOf(t))return;i.push(t)}else{if(i.indexOf(t)<0)return;g.Utils.removeFromArray(i,t)}o(t),s=!0}}),s){this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(r);var l={type:t,columns:i,column:1===i.length?i[0]:null,api:this.gridApi,columnApi:this.columnApi,source:r};this.eventService.dispatchEvent(l)}}},T.prototype.setRowGroupColumns=function(e,t){void 0===t&&(t="api"),this.autoGroupsNeedBuilding=!0,this.setPrimaryColumnList(e,this.rowGroupColumns,v.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,this.setRowGroupActive.bind(this),t)},T.prototype.setRowGroupActive=function(e,t,i){e!==t.isRowGroupActive()&&(t.setRowGroupActive(e,i),e||this.gridOptionsWrapper.isSuppressMakeColumnVisibleAfterUnGroup()||t.setVisible(!0,i))},T.prototype.addRowGroupColumn=function(e,t){void 0===t&&(t="api"),this.addRowGroupColumns([e],t)},T.prototype.addRowGroupColumns=function(e,t){void 0===t&&(t="api"),this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!0,this.setRowGroupActive.bind(this,!0),v.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,t)},T.prototype.removeRowGroupColumns=function(e,t){void 0===t&&(t="api"),this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!1,this.setRowGroupActive.bind(this,!1),v.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,t)},T.prototype.removeRowGroupColumn=function(e,t){void 0===t&&(t="api"),this.removeRowGroupColumns([e],t)},T.prototype.addPivotColumns=function(e,t){void 0===t&&(t="api"),this.updatePrimaryColumnList(e,this.pivotColumns,!0,function(e){return e.setPivotActive(!0,t)},v.Events.EVENT_COLUMN_PIVOT_CHANGED,t)},T.prototype.setPivotColumns=function(e,i){void 0===i&&(i="api"),this.setPrimaryColumnList(e,this.pivotColumns,v.Events.EVENT_COLUMN_PIVOT_CHANGED,function(e,t){t.setPivotActive(e,i)},i)},T.prototype.addPivotColumn=function(e,t){void 0===t&&(t="api"),this.addPivotColumns([e],t)},T.prototype.removePivotColumns=function(e,t){void 0===t&&(t="api"),this.updatePrimaryColumnList(e,this.pivotColumns,!1,function(e){return e.setPivotActive(!1,t)},v.Events.EVENT_COLUMN_PIVOT_CHANGED,t)},T.prototype.removePivotColumn=function(e,t){void 0===t&&(t="api"),this.removePivotColumns([e],t)},T.prototype.setPrimaryColumnList=function(e,i,t,n,o){var r=this;i.length=0,g.Utils.exists(e)&&e.forEach(function(e){var t=r.getPrimaryColumn(e);i.push(t)}),this.primaryColumns.forEach(function(e){var t=0<=i.indexOf(e);n(t,e)}),this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(o);var a={type:t,columns:i,column:1===i.length?i[0]:null,api:this.gridApi,columnApi:this.columnApi,source:o};this.eventService.dispatchEvent(a)},T.prototype.setValueColumns=function(e,t){void 0===t&&(t="api"),this.setPrimaryColumnList(e,this.valueColumns,v.Events.EVENT_COLUMN_VALUE_CHANGED,this.setValueActive.bind(this),t)},T.prototype.setValueActive=function(e,t,i){if(e!==t.isValueActive()&&(t.setValueActive(e,i),e&&!t.getAggFunc())){var n=this.aggFuncService.getDefaultAggFunc(t);t.setAggFunc(n)}},T.prototype.addValueColumns=function(e,t){void 0===t&&(t="api"),this.updatePrimaryColumnList(e,this.valueColumns,!0,this.setValueActive.bind(this,!0),v.Events.EVENT_COLUMN_VALUE_CHANGED,t)},T.prototype.addValueColumn=function(e,t){void 0===t&&(t="api"),this.addValueColumns([e],t)},T.prototype.removeValueColumn=function(e,t){void 0===t&&(t="api"),this.removeValueColumns([e],t)},T.prototype.removeValueColumns=function(e,t){void 0===t&&(t="api"),this.updatePrimaryColumnList(e,this.valueColumns,!1,this.setValueActive.bind(this,!1),v.Events.EVENT_COLUMN_VALUE_CHANGED,t)},T.prototype.normaliseColumnWidth=function(e,t){return t<e.getMinWidth()&&(t=e.getMinWidth()),e.isGreaterThanMax(t)&&(t=e.getMaxWidth()),t},T.prototype.getPrimaryOrGridColumn=function(e){var t=this.getPrimaryColumn(e);return t||this.getGridColumn(e)},T.prototype.setColumnWidth=function(e,t,i,n,o){void 0===o&&(o="api");var r=this.getPrimaryOrGridColumn(e);if(r){var a=[];if(a.push({width:t,ratios:[1],columns:[r]}),i){var s=this.getDisplayedColAfter(r);if(!s)return;var l=r.getActualWidth()-t,c=s.getActualWidth()+l;a.push({width:c,ratios:[1],columns:[s]})}this.resizeColumnSets(a,n,o)}},T.prototype.checkMinAndMaxWidthsForSet=function(e){var t=e.columns,i=e.width,n=0,o=0,r=!0;return t.forEach(function(e){n+=e.getMinWidth(),0<e.getMaxWidth()?o+=e.getMaxWidth():r=!1}),n<=i&&(!r||i<=o)},T.prototype.resizeColumnSets=function(e,t,i){if(g.Utils.every(e,this.checkMinAndMaxWidthsForSet.bind(this))){var o=[],r=[];e.forEach(function(e){var l=e.width,t=e.columns,c=e.ratios,u={},d={};t.forEach(function(e){return r.push(e)});for(var h=!0,i=0,n=function(){if(1e3<++i)return console.error("ag-Grid: infinite loop in resizeColumnSets"),"break";h=!1;var n=[],o=[],r=0,a=l;t.forEach(function(e,t){if(d[e.getId()])a-=u[e.getId()];else{n.push(e);var i=c[t];r+=i,o.push(i)}});var s=1/r;n.forEach(function(e,t){var i;t===n.length-1?i=a:(i=Math.round(c[t]*l*s),a-=i),i<e.getMinWidth()?(i=e.getMinWidth(),d[e.getId()]=!0,h=!0):0<e.getMaxWidth()&&i>e.getMaxWidth()&&(i=e.getMaxWidth(),d[e.getId()]=!0,h=!0),u[e.getId()]=i})};h&&"break"!==n(););t.forEach(function(e){var t=u[e.getId()];e.getActualWidth()!==t&&(e.setActualWidth(t),o.push(e))})});var n=0<o.length;if(n&&(this.setLeftValues(i),this.updateBodyWidths(),this.checkDisplayedVirtualColumns()),n||t){var a={type:v.Events.EVENT_COLUMN_RESIZED,columns:r,column:1===r.length?r[0]:null,finished:t,api:this.gridApi,columnApi:this.columnApi,source:i};this.eventService.dispatchEvent(a)}}},T.prototype.setColumnAggFunc=function(e,t,i){void 0===i&&(i="api"),e.setAggFunc(t);var n={type:v.Events.EVENT_COLUMN_VALUE_CHANGED,columns:[e],column:e,api:this.gridApi,columnApi:this.columnApi,source:i};this.eventService.dispatchEvent(n)},T.prototype.moveRowGroupColumn=function(e,t,i){void 0===i&&(i="api");var n=this.rowGroupColumns[e];this.rowGroupColumns.splice(e,1),this.rowGroupColumns.splice(t,0,n);var o={type:v.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,columns:this.rowGroupColumns,column:1===this.rowGroupColumns.length?this.rowGroupColumns[0]:null,api:this.gridApi,columnApi:this.columnApi,source:i};this.eventService.dispatchEvent(o)},T.prototype.moveColumns=function(e,t,i){if(void 0===i&&(i="api"),this.columnAnimationService.start(),t>this.gridColumns.length-e.length)return console.warn("ag-Grid: tried to insert columns in invalid location, toIndex = "+t),void console.warn("ag-Grid: remember that you should not count the moving columns when calculating the new index");var n=this.getGridColumns(e);if(this.doesMovePassRules(n,t)){g.Utils.moveInArray(this.gridColumns,n,t),this.updateDisplayedColumns(i);var o={type:v.Events.EVENT_COLUMN_MOVED,columns:n,column:1===n.length?n[0]:null,toIndex:t,api:this.gridApi,columnApi:this.columnApi,source:i};this.eventService.dispatchEvent(o),this.columnAnimationService.finish()}},T.prototype.doesMovePassRules=function(e,t){var i=this.gridColumns.slice();return g.Utils.moveInArray(i,e,t),!!this.doesMovePassMarryChildren(i)&&!!this.doesMovePassLockedPositions(i)},T.prototype.doesMovePassLockedPositions=function(e){var t=!1,i=!0;return e.forEach(function(e){e.isLockPosition()?t&&(i=!1):t=!0}),i},T.prototype.doesMovePassMarryChildren=function(o){var r=!0;return this.columnUtils.depthFirstOriginalTreeSearch(this.gridBalancedTree,function(e){if(e instanceof y.OriginalColumnGroup){var t=e;if(t.getColGroupDef()&&t.getColGroupDef().marryChildren){var i=[];t.getLeafColumns().forEach(function(e){var t=o.indexOf(e);i.push(t)});var n=Math.max.apply(Math,i)-Math.min.apply(Math,i);t.getLeafColumns().length-1<n&&(r=!1)}}}),r},T.prototype.moveColumn=function(e,t,i){void 0===i&&(i="api"),this.moveColumns([e],t,i)},T.prototype.moveColumnByIndex=function(e,t,i){void 0===i&&(i="api");var n=this.gridColumns[e];this.moveColumn(n,t,i)},T.prototype.getBodyContainerWidth=function(){return this.bodyWidth},T.prototype.getContainerWidth=function(e){switch(e){case l.Column.PINNED_LEFT:return this.leftWidth;case l.Column.PINNED_RIGHT:return this.rightWidth;default:return this.bodyWidth}},T.prototype.updateBodyWidths=function(){var e=this.getWidthOfColsInList(this.displayedCenterColumns),t=this.getWidthOfColsInList(this.displayedLeftColumns),i=this.getWidthOfColsInList(this.displayedRightColumns);if(this.bodyWidthDirty=this.bodyWidth!==e,this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==i){this.bodyWidth=e,this.leftWidth=t,this.rightWidth=i;var n={type:v.Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(n)}},T.prototype.getValueColumns=function(){return this.valueColumns?this.valueColumns:[]},T.prototype.getPivotColumns=function(){return this.pivotColumns?this.pivotColumns:[]},T.prototype.isPivotActive=function(){return this.pivotColumns&&0<this.pivotColumns.length&&this.pivotMode},T.prototype.getRowGroupColumns=function(){return this.rowGroupColumns?this.rowGroupColumns:[]},T.prototype.getDisplayedCenterColumns=function(){return this.displayedCenterColumns},T.prototype.getDisplayedLeftColumns=function(){return this.displayedLeftColumns},T.prototype.getDisplayedRightColumns=function(){return this.displayedRightColumns},T.prototype.getDisplayedColumns=function(e){switch(e){case l.Column.PINNED_LEFT:return this.getDisplayedLeftColumns();case l.Column.PINNED_RIGHT:return this.getDisplayedRightColumns();default:return this.getDisplayedCenterColumns()}},T.prototype.getAllPrimaryColumns=function(){return this.primaryColumns},T.prototype.getAllColumnsForQuickFilter=function(){return this.columnsForQuickFilter},T.prototype.getAllGridColumns=function(){return this.gridColumns},T.prototype.isEmpty=function(){return g.Utils.missingOrEmpty(this.gridColumns)},T.prototype.isRowGroupEmpty=function(){return g.Utils.missingOrEmpty(this.rowGroupColumns)},T.prototype.setColumnVisible=function(e,t,i){void 0===i&&(i="api"),this.setColumnsVisible([e],t,i)},T.prototype.setColumnsVisible=function(e,t,i){var n=this;void 0===i&&(i="api"),this.columnAnimationService.start(),this.actionOnGridColumns(e,function(e){return e.isVisible()!==t&&(e.setVisible(t,i),!0)},i,function(){return{type:v.Events.EVENT_COLUMN_VISIBLE,visible:t,column:null,columns:null,api:n.gridApi,columnApi:n.columnApi,source:i}}),this.columnAnimationService.finish()},T.prototype.setColumnPinned=function(e,t,i){void 0===i&&(i="api"),this.setColumnsPinned([e],t,i)},T.prototype.setColumnsPinned=function(e,t,i){var n,o=this;void 0===i&&(i="api"),this.columnAnimationService.start(),n=!0===t||t===l.Column.PINNED_LEFT?l.Column.PINNED_LEFT:t===l.Column.PINNED_RIGHT?l.Column.PINNED_RIGHT:null,this.actionOnGridColumns(e,function(e){return e.getPinned()!==n&&(e.setPinned(n),!0)},i,function(){return{type:v.Events.EVENT_COLUMN_PINNED,pinned:n,column:null,columns:null,api:o.gridApi,columnApi:o.columnApi,source:i}}),this.columnAnimationService.finish()},T.prototype.actionOnGridColumns=function(e,i,t,n){var o=this;if(!g.Utils.missingOrEmpty(e)){var r=[];if(e.forEach(function(e){var t=o.getGridColumn(e);t&&!1!==i(t)&&r.push(t)}),0!==r.length&&(this.updateDisplayedColumns(t),g.Utils.exists(n))){var a=n();a.columns=r,a.column=1===r.length?r[0]:null,this.eventService.dispatchEvent(a)}}},T.prototype.getDisplayedColBefore=function(e){var t=this.getAllDisplayedColumns(),i=t.indexOf(e);return 0<i?t[i-1]:null},T.prototype.getDisplayedColAfter=function(e){var t=this.getAllDisplayedColumns(),i=t.indexOf(e);return i<t.length-1?t[i+1]:null},T.prototype.getDisplayedGroupAfter=function(e){for(var t=e.getDisplayedLeafColumns()[0],i=e.getOriginalColumnGroup().getLevel();;){if(!(t=this.getDisplayedColAfter(t)))return null;for(var n=t.getParent();n.getOriginalColumnGroup().getLevel()!==i;)n=n.getParent();if(n!==e)return n}},T.prototype.isPinningLeft=function(){return 0<this.displayedLeftColumns.length},T.prototype.isPinningRight=function(){return 0<this.displayedRightColumns.length},T.prototype.getPrimaryAndSecondaryAndAutoColumns=function(){var t=this.primaryColumns?this.primaryColumns.slice(0):[];return g.Utils.exists(this.groupAutoColumns)&&this.groupAutoColumns.forEach(function(e){return t.push(e)}),this.secondaryColumnsPresent&&this.secondaryColumns.forEach(function(e){return t.push(e)}),t},T.prototype.createStateItemFromColumn=function(e){var t=e.isRowGroupActive()?this.rowGroupColumns.indexOf(e):null,i=e.isPivotActive()?this.pivotColumns.indexOf(e):null,n=e.isValueActive()?e.getAggFunc():null;return{colId:e.getColId(),hide:!e.isVisible(),aggFunc:n,width:e.getActualWidth(),pivotIndex:i,pinned:e.getPinned(),rowGroupIndex:t}},T.prototype.getColumnState=function(){if(g.Utils.missing(this.primaryColumns))return[];var e=this.primaryColumns.map(this.createStateItemFromColumn.bind(this));return this.pivotMode||this.orderColumnStateList(e),e},T.prototype.orderColumnStateList=function(e){var i=this.gridColumns.map(function(e){return e.getColId()});e.sort(function(e,t){return i.indexOf(e.colId)-i.indexOf(t.colId)})},T.prototype.resetColumnState=function(e){void 0===e&&(e="api");var t=this.getColumnsFromTree(this.primaryBalancedTree),i=[];t&&t.forEach(function(e){i.push({colId:e.getColId(),aggFunc:e.getColDef().aggFunc,hide:e.getColDef().hide,pinned:e.getColDef().pinned,rowGroupIndex:e.getColDef().rowGroupIndex,pivotIndex:e.getColDef().pivotIndex,width:e.getColDef().width})}),this.setColumnState(i,e)},T.prototype.setColumnState=function(e,i){var n=this;if(void 0===i&&(i="api"),g.Utils.missingOrEmpty(this.primaryColumns))return!1;this.autoGroupsNeedBuilding=!0;var o=this.primaryColumns.slice();this.rowGroupColumns=[],this.valueColumns=[],this.pivotColumns=[];var r=!0,a={},s={};if(e&&e.forEach(function(e){var t=n.getPrimaryColumn(e.colId);t?(n.syncColumnWithStateItem(t,e,a,s,i),g.Utils.removeFromArray(o,t)):(console.warn("ag-grid: column "+e.colId+" not found"),r=!1)}),o.forEach(this.syncColumnWithNoState.bind(this)),this.rowGroupColumns.sort(this.sortColumnListUsingIndexes.bind(this,a)),this.pivotColumns.sort(this.sortColumnListUsingIndexes.bind(this,s)),this.updateGridColumns(),e){var l=e.map(function(e){return e.colId});this.gridColumns.sort(function(e,t){return l.indexOf(e.getId())-l.indexOf(t.getId())})}this.updateDisplayedColumns(i);var t={type:v.Events.EVENT_COLUMN_EVERYTHING_CHANGED,api:this.gridApi,columnApi:this.columnApi,source:i};return this.eventService.dispatchEvent(t),r},T.prototype.sortColumnListUsingIndexes=function(e,t,i){return e[t.getId()]-e[i.getId()]},T.prototype.syncColumnWithNoState=function(e,t){e.setVisible(!1,t),e.setAggFunc(null),e.setPinned(null),e.setRowGroupActive(!1,t),e.setPivotActive(!1,t),e.setValueActive(!1,t)},T.prototype.syncColumnWithStateItem=function(e,t,i,n,o){e.setVisible(!t.hide,o),e.setPinned(t.pinned),t.width>=this.gridOptionsWrapper.getMinColWidth()&&e.setActualWidth(t.width,o),"string"==typeof t.aggFunc?(e.setAggFunc(t.aggFunc),e.setValueActive(!0,o),this.valueColumns.push(e)):(g.Utils.exists(t.aggFunc)&&console.warn("ag-Grid: stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it isintended for the column state to be stored and retrieved as simple JSON."),e.setAggFunc(null),e.setValueActive(!1,o)),"number"==typeof t.rowGroupIndex?(this.rowGroupColumns.push(e),e.setRowGroupActive(!0,o),i[e.getId()]=t.rowGroupIndex):e.setRowGroupActive(!1,o),"number"==typeof t.pivotIndex?(this.pivotColumns.push(e),e.setPivotActive(!0,o),n[e.getId()]=t.pivotIndex):e.setPivotActive(!1,o)},T.prototype.getGridColumns=function(e){return this.getColumns(e,this.getGridColumn.bind(this))},T.prototype.getColumns=function(e,i){var n=[];return e&&e.forEach(function(e){var t=i(e);t&&n.push(t)}),n},T.prototype.getColumnWithValidation=function(e){var t=this.getPrimaryColumn(e);return t||console.warn("ag-Grid: could not find column "+t),t},T.prototype.getPrimaryColumn=function(e){return this.getColumn(e,this.primaryColumns)},T.prototype.getGridColumn=function(e){return this.getColumn(e,this.gridColumns)},T.prototype.getColumn=function(e,t){if(!e)return null;for(var i=0;i<t.length;i++)if(this.columnsMatch(t[i],e))return t[i];return this.getAutoColumn(e)},T.prototype.getAutoColumn=function(t){var i=this;return!g.Utils.exists(this.groupAutoColumns)||g.Utils.missing(this.groupAutoColumns)?null:g.Utils.find(this.groupAutoColumns,function(e){return i.columnsMatch(e,t)})},T.prototype.columnsMatch=function(e,t){var i=e===t,n=e.getColDef()===t,o=e.getColId()==t;return i||n||o},T.prototype.getDisplayNameForColumn=function(e,t,i){void 0===i&&(i=!1);var n=this.getHeaderName(e.getColDef(),e,null,null,t);return i?this.wrapHeaderNameWithAggFunc(e,n):n},T.prototype.getDisplayNameForOriginalColumnGroup=function(e,t,i){var n=t.getColGroupDef();return n?this.getHeaderName(n,null,e,t,i):null},T.prototype.getDisplayNameForColumnGroup=function(e,t){return this.getDisplayNameForOriginalColumnGroup(e,e.getOriginalColumnGroup(),t)},T.prototype.getHeaderName=function(e,t,i,n,o){var r=e.headerValueGetter;if(r){var a={colDef:e,column:t,columnGroup:i,originalColumnGroup:n,location:o,api:this.gridOptionsWrapper.getApi(),context:this.gridOptionsWrapper.getContext()};return"function"==typeof r?r(a):"string"==typeof r?this.expressionService.evaluate(r,a):(console.warn("ag-grid: headerValueGetter must be a function or a string"),"")}return null!=e.headerName?e.headerName:e.field?g.Utils.camelCaseToHumanText(e.field):""},T.prototype.wrapHeaderNameWithAggFunc=function(e,t){if(this.gridOptionsWrapper.isSuppressAggFuncInHeader())return t;var i,n=e.getColDef().pivotValueColumn,o=null;if(g.Utils.exists(n))o=n.getAggFunc(),i=!0;else{var r=e.isValueActive(),a=this.pivotMode||!this.isRowGroupEmpty();i=!(!r||!a||(o=e.getAggFunc(),0))}if(i){var s="string"==typeof o?o:"func";return this.gridOptionsWrapper.getLocaleTextFunc()(s,s)+"("+t+")"}return t},T.prototype.getColumnGroup=function(i,n){if(!i)return null;if(i instanceof a.ColumnGroup)return i;var e=this.getAllDisplayedColumnGroups(),o="number"==typeof n,r=null;return this.columnUtils.depthFirstAllColumnTreeSearch(e,function(e){if(e instanceof a.ColumnGroup){var t=e;(o?i===t.getGroupId()&&n===t.getInstanceId():i===t.getGroupId())&&(r=t)}}),r},T.prototype.setColumnDefs=function(e,t){void 0===t&&(t="api"),this.valueCache.expire(),this.autoGroupsNeedBuilding=!0;var i=this.balancedColumnTreeBuilder.createBalancedColumnGroups(e,!0);this.primaryBalancedTree=i.balancedTree,this.primaryHeaderRowCount=i.treeDept+1,this.primaryColumns=this.getColumnsFromTree(this.primaryBalancedTree),this.autoRowHeightColumns=this.primaryColumns.filter(function(e){return e.getColDef().autoHeight}),this.extractRowGroupColumns(t),this.extractPivotColumns(t),this.createValueColumns(t),this.updateGridColumns(),this.updateDisplayedColumns(t),this.checkDisplayedVirtualColumns(),this.ready=!0;var n={type:v.Events.EVENT_COLUMN_EVERYTHING_CHANGED,api:this.gridApi,columnApi:this.columnApi,source:t};this.eventService.dispatchEvent(n);var o={type:v.Events.EVENT_NEW_COLUMNS_LOADED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(o)},T.prototype.isReady=function(){return this.ready},T.prototype.extractRowGroupColumns=function(t){var i=this;this.rowGroupColumns.forEach(function(e){return e.setRowGroupActive(!1,t)}),this.rowGroupColumns=[],this.primaryColumns.forEach(function(e){"number"==typeof e.getColDef().rowGroupIndex&&(i.rowGroupColumns.push(e),e.setRowGroupActive(!0,t))}),this.rowGroupColumns.sort(function(e,t){return e.getColDef().rowGroupIndex-t.getColDef().rowGroupIndex}),this.primaryColumns.forEach(function(e){if(e.getColDef().rowGroup){if(0<=i.rowGroupColumns.indexOf(e))return;i.rowGroupColumns.push(e),e.setRowGroupActive(!0,t)}})},T.prototype.extractPivotColumns=function(t){var i=this;this.pivotColumns.forEach(function(e){return e.setPivotActive(!1,t)}),this.pivotColumns=[],this.primaryColumns.forEach(function(e){"number"==typeof e.getColDef().pivotIndex&&(i.pivotColumns.push(e),e.setPivotActive(!0,t))}),this.pivotColumns.sort(function(e,t){return e.getColDef().pivotIndex-t.getColDef().pivotIndex}),this.primaryColumns.forEach(function(e){if(e.getColDef().pivot){if(0<=i.pivotColumns.indexOf(e))return;i.pivotColumns.push(e),e.setPivotActive(!0,t)}})},T.prototype.resetColumnGroupState=function(e){void 0===e&&(e="api");var i=[];this.columnUtils.depthFirstOriginalTreeSearch(this.primaryBalancedTree,function(e){if(e instanceof y.OriginalColumnGroup){var t={groupId:e.getGroupId(),open:e.getColGroupDef().openByDefault};i.push(t)}}),this.setColumnGroupState(i,e)},T.prototype.getColumnGroupState=function(){var i=[];return this.columnUtils.depthFirstOriginalTreeSearch(this.gridBalancedTree,function(e){if(e instanceof y.OriginalColumnGroup){var t=e;i.push({groupId:t.getGroupId(),open:t.isExpanded()})}}),i},T.prototype.setColumnGroupState=function(e,t){var o=this;void 0===t&&(t="api"),this.columnAnimationService.start();var r=[];e.forEach(function(e){var t=e.groupId,i=e.open,n=o.getOriginalColumnGroup(t);n&&n.isExpanded()!==i&&(o.logger.log("columnGroupOpened("+n.getGroupId()+","+i+")"),n.setExpanded(i),r.push(n))}),this.updateGroupsAndDisplayedColumns(t),r.forEach(function(e){var t={type:v.Events.EVENT_COLUMN_GROUP_OPENED,columnGroup:e,api:o.gridApi,columnApi:o.columnApi};o.eventService.dispatchEvent(t)}),this.columnAnimationService.finish()},T.prototype.setColumnGroupOpened=function(e,t,i){var n;void 0===i&&(i="api"),n=e instanceof y.OriginalColumnGroup?e.getId():e,this.setColumnGroupState([{groupId:n,open:t}],i)},T.prototype.getOriginalColumnGroup=function(i){if(i instanceof y.OriginalColumnGroup)return i;"string"!=typeof i&&console.error("ag-Grid: group key must be a string");var n=null;return this.columnUtils.depthFirstOriginalTreeSearch(this.gridBalancedTree,function(e){if(e instanceof y.OriginalColumnGroup){var t=e;t.getId()===i&&(n=t)}}),n},T.prototype.calculateColumnsForDisplay=function(){var n=this;return this.pivotMode&&!this.secondaryColumnsPresent?g.Utils.filter(this.gridColumns,function(e){var t=n.groupAutoColumns&&0<=n.groupAutoColumns.indexOf(e),i=n.valueColumns&&0<=n.valueColumns.indexOf(e);return t||i}):g.Utils.filter(this.gridColumns,function(e){return n.groupAutoColumns&&0<=n.groupAutoColumns.indexOf(e)||e.isVisible()})},T.prototype.checkColSpanActiveInCols=function(e){var t=!1;return e.forEach(function(e){g.Utils.exists(e.getColDef().colSpan)&&(t=!0)}),t},T.prototype.calculateColumnsForGroupDisplay=function(){var i=this;function e(e){var t=e.getColDef();t&&g.Utils.exists(t.showRowGroup)&&i.groupDisplayColumns.push(e)}this.groupDisplayColumns=[],this.gridColumns.forEach(e),this.groupAutoColumns&&this.groupAutoColumns.forEach(e)},T.prototype.getGroupDisplayColumns=function(){return this.groupDisplayColumns},T.prototype.updateDisplayedColumns=function(e){var t=this.calculateColumnsForDisplay();this.buildDisplayedTrees(t),this.calculateColumnsForGroupDisplay(),this.updateGroupsAndDisplayedColumns(e),this.setFirstRightAndLastLeftPinned(e)},T.prototype.isSecondaryColumnsPresent=function(){return this.secondaryColumnsPresent},T.prototype.setSecondaryColumns=function(e,t){void 0===t&&(t="api");var i=e&&0<e.length;if(i||this.secondaryColumnsPresent){if(i){this.processSecondaryColumnDefinitions(e);var n=this.balancedColumnTreeBuilder.createBalancedColumnGroups(e,!1);this.secondaryBalancedTree=n.balancedTree,this.secondaryHeaderRowCount=n.treeDept+1,this.secondaryColumns=this.getColumnsFromTree(this.secondaryBalancedTree),this.secondaryColumnsPresent=!0}else this.secondaryBalancedTree=null,this.secondaryHeaderRowCount=-1,this.secondaryColumns=null,this.secondaryColumnsPresent=!1;this.updateGridColumns(),this.updateDisplayedColumns(t)}},T.prototype.processSecondaryColumnDefinitions=function(e){var r=this.gridOptionsWrapper.getProcessSecondaryColDefFunc(),a=this.gridOptionsWrapper.getProcessSecondaryColGroupDefFunc();(r||a)&&!function o(e){e.forEach(function(e){var t=g.Utils.exists(e.children);if(t){var i=e;a&&a(i),o(i.children)}else{var n=e;r&&r(n)}})}(e)},T.prototype.updateGridColumns=function(){this.gridColsArePrimary&&(this.lastPrimaryOrder=this.gridColumns),this.secondaryColumns?(this.gridBalancedTree=this.secondaryBalancedTree.slice(),this.gridHeaderRowCount=this.secondaryHeaderRowCount,this.gridColumns=this.secondaryColumns.slice(),this.gridColsArePrimary=!1):(this.gridBalancedTree=this.primaryBalancedTree.slice(),this.gridHeaderRowCount=this.primaryHeaderRowCount,this.gridColumns=this.primaryColumns.slice(),this.gridColsArePrimary=!0,this.orderGridColsLikeLastPrimary()),this.putFixedColumnsFirst(),this.addAutoGroupToGridColumns(),this.setupQuickFilterColumns(),this.clearDisplayedColumns(),this.colSpanActive=this.checkColSpanActiveInCols(this.gridColumns);var e={type:v.Events.EVENT_GRID_COLUMNS_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(e)},T.prototype.orderGridColsLikeLastPrimary=function(){var i=this;if(!g.Utils.missing(this.lastPrimaryOrder)){var t=!1;this.gridColumns.forEach(function(e){i.lastPrimaryOrder.indexOf(e)<0&&(t=!0)}),t||this.gridColumns.sort(function(e,t){return i.lastPrimaryOrder.indexOf(e)-i.lastPrimaryOrder.indexOf(t)})}},T.prototype.isPrimaryColumnGroupsPresent=function(){return 1<this.primaryHeaderRowCount},T.prototype.setupQuickFilterColumns=function(){this.groupAutoColumns?this.columnsForQuickFilter=this.primaryColumns.concat(this.groupAutoColumns):this.columnsForQuickFilter=this.primaryColumns},T.prototype.putFixedColumnsFirst=function(){var e=this.gridColumns.filter(function(e){return e.isLockPosition()}),t=this.gridColumns.filter(function(e){return!e.isLockPosition()});this.gridColumns=e.concat(t)},T.prototype.addAutoGroupToGridColumns=function(){if(this.createGroupAutoColumnsIfNeeded(),!g.Utils.missing(this.groupAutoColumns)){this.gridColumns=this.groupAutoColumns.concat(this.gridColumns);var e=this.balancedColumnTreeBuilder.createForAutoGroups(this.groupAutoColumns,this.gridBalancedTree);this.gridBalancedTree=e.concat(this.gridBalancedTree)}},T.prototype.clearDisplayedColumns=function(){this.displayedLeftColumnTree=[],this.displayedRightColumnTree=[],this.displayedCentreColumnTree=[],this.displayedLeftHeaderRows={},this.displayedRightHeaderRows={},this.displayedCentreHeaderRows={},this.displayedLeftColumns=[],this.displayedRightColumns=[],this.displayedCenterColumns=[],this.allDisplayedColumns=[],this.allDisplayedVirtualColumns=[]},T.prototype.updateGroupsAndDisplayedColumns=function(e){this.updateOpenClosedVisibilityInColumnGroups(),this.updateDisplayedColumnsFromTrees(e),this.updateVirtualSets(),this.updateBodyWidths();var t={type:v.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(t)},T.prototype.updateDisplayedColumnsFromTrees=function(e){this.addToDisplayedColumns(this.displayedLeftColumnTree,this.displayedLeftColumns),this.addToDisplayedColumns(this.displayedCentreColumnTree,this.displayedCenterColumns),this.addToDisplayedColumns(this.displayedRightColumnTree,this.displayedRightColumns),this.setupAllDisplayedColumns(),this.setLeftValues(e)},T.prototype.setupAllDisplayedColumns=function(){this.gridOptionsWrapper.isEnableRtl()?this.allDisplayedColumns=this.displayedRightColumns.concat(this.displayedCenterColumns).concat(this.displayedLeftColumns):this.allDisplayedColumns=this.displayedLeftColumns.concat(this.displayedCenterColumns).concat(this.displayedRightColumns)},T.prototype.setLeftValues=function(e){this.setLeftValuesOfColumns(e),this.setLeftValuesOfGroups()},T.prototype.setLeftValuesOfColumns=function(n){var o=this,r=this.primaryColumns.slice(0),a=this.gridOptionsWrapper.isEnableRtl();[this.displayedLeftColumns,this.displayedRightColumns,this.displayedCenterColumns].forEach(function(e){if(a){var t=o.getWidthOfColsInList(e);e.forEach(function(e){t-=e.getActualWidth(),e.setLeft(t,n)})}else{var i=0;e.forEach(function(e){e.setLeft(i,n),i+=e.getActualWidth()})}g.Utils.removeAllFromArray(r,e)}),r.forEach(function(e){e.setLeft(null,n)})},T.prototype.setLeftValuesOfGroups=function(){[this.displayedLeftColumnTree,this.displayedRightColumnTree,this.displayedCentreColumnTree].forEach(function(e){e.forEach(function(e){e instanceof a.ColumnGroup&&e.checkLeft()})})},T.prototype.addToDisplayedColumns=function(e,t){t.length=0,this.columnUtils.depthFirstDisplayedColumnTreeSearch(e,function(e){e instanceof l.Column&&t.push(e)})},T.prototype.updateDisplayedCenterVirtualColumns=function(){this.suppressColumnVirtualisation?this.allDisplayedCenterVirtualColumns=this.displayedCenterColumns:this.allDisplayedCenterVirtualColumns=this.filterOutColumnsWithinViewport(),this.allDisplayedVirtualColumns=this.allDisplayedCenterVirtualColumns.concat(this.displayedLeftColumns).concat(this.displayedRightColumns);var t={};return this.allDisplayedVirtualColumns.forEach(function(e){t[e.getId()]=!0}),t},T.prototype.getVirtualHeaderGroupRow=function(e,t){var i;switch(e){case l.Column.PINNED_LEFT:i=this.displayedLeftHeaderRows[t];break;case l.Column.PINNED_RIGHT:i=this.displayedRightHeaderRows[t];break;default:i=this.displayedCentreHeaderRows[t]}return g.Utils.missing(i)&&(i=[]),i},T.prototype.updateDisplayedVirtualGroups=function(a){function s(e,t,i){for(var n=!1,o=0;o<e.length;o++){var r=e[o];(r instanceof l.Column?!0===a[r.getId()]:s(r.getDisplayedChildren(),t,i+1))&&(n=!0,t[i]||(t[i]=[]),t[i].push(r))}return n}this.displayedLeftHeaderRows={},this.displayedRightHeaderRows={},this.displayedCentreHeaderRows={},s(this.displayedLeftColumnTree,this.displayedLeftHeaderRows,0),s(this.displayedRightColumnTree,this.displayedRightHeaderRows,0),s(this.displayedCentreColumnTree,this.displayedCentreHeaderRows,0)},T.prototype.updateVirtualSets=function(){var e=this.updateDisplayedCenterVirtualColumns();this.updateDisplayedVirtualGroups(e)},T.prototype.filterOutColumnsWithinViewport=function(){return g.Utils.filter(this.displayedCenterColumns,this.isColumnInViewport.bind(this))},T.prototype.sizeColumnsToFit=function(e,t){var i=this;void 0===t&&(t="api");var n=this.getAllDisplayedColumns();if(!(e<=0||0===n.length)){for(var o=g.Utils.filter(n,function(e){return!0===e.getColDef().suppressSizeToFit}),r=g.Utils.filter(n,function(e){return!0!==e.getColDef().suppressSizeToFit}),a=r.slice(0),s=!1;!s;){s=!0;var l=e-this.getWidthOfColsInList(o);if(l<=0)r.forEach(function(e){e.setMinimum(t)});else for(var c=l/this.getWidthOfColsInList(r),u=l,d=r.length-1;0<=d;d--){var h=r[d],p=Math.round(h.getActualWidth()*c);p<h.getMinWidth()?(h.setMinimum(t),f(h),s=!1):h.isGreaterThanMax(p)?(h.setActualWidth(h.getMaxWidth(),t),f(h),s=!1):0===d?h.setActualWidth(u,t):h.setActualWidth(p,t),u-=p}}this.setLeftValues(t),this.updateBodyWidths(),a.forEach(function(e){var t={type:v.Events.EVENT_COLUMN_RESIZED,column:e,columns:[e],finished:!0,api:i.gridApi,columnApi:i.columnApi,source:"sizeColumnsToFit"};i.eventService.dispatchEvent(t)})}function f(e){g.Utils.removeFromArray(r,e),o.push(e)}},T.prototype.buildDisplayedTrees=function(e){var t=g.Utils.filter(e,function(e){return"left"===e.getPinned()}),i=g.Utils.filter(e,function(e){return"right"===e.getPinned()}),n=g.Utils.filter(e,function(e){return"left"!==e.getPinned()&&"right"!==e.getPinned()}),o=new b.GroupInstanceIdCreator;this.displayedLeftColumnTree=this.displayedGroupCreator.createDisplayedGroups(t,this.gridBalancedTree,o,this.displayedLeftColumnTree),this.displayedRightColumnTree=this.displayedGroupCreator.createDisplayedGroups(i,this.gridBalancedTree,o,this.displayedRightColumnTree),this.displayedCentreColumnTree=this.displayedGroupCreator.createDisplayedGroups(n,this.gridBalancedTree,o,this.displayedCentreColumnTree)},T.prototype.updateOpenClosedVisibilityInColumnGroups=function(){var e=this.getAllDisplayedColumnGroups();this.columnUtils.depthFirstAllColumnTreeSearch(e,function(e){e instanceof a.ColumnGroup&&e.calculateDisplayedColumns()})},T.prototype.getGroupAutoColumns=function(){return this.groupAutoColumns},T.prototype.createGroupAutoColumnsIfNeeded=function(){if(this.autoGroupsNeedBuilding){this.autoGroupsNeedBuilding=!1;var e=(0<this.rowGroupColumns.length||this.usingTreeData)&&!this.gridOptionsWrapper.isGroupSuppressAutoColumn()&&!this.gridOptionsWrapper.isGroupUseEntireRow()&&!this.gridOptionsWrapper.isGroupSuppressRow();this.groupAutoColumns=e?this.autoGroupColService.createAutoGroupColumns(this.rowGroupColumns):null}},T.prototype.createValueColumns=function(t){this.valueColumns.forEach(function(e){return e.setValueActive(!1,t)}),this.valueColumns=[];for(var e=0;e<this.primaryColumns.length;e++){var i=this.primaryColumns[e];i.getColDef().aggFunc&&(i.setAggFunc(i.getColDef().aggFunc),this.valueColumns.push(i),i.setValueActive(!0,t))}},T.prototype.getWidthOfColsInList=function(e){for(var t=0,i=0;i<e.length;i++)t+=e[i].getActualWidth();return t},T.prototype.getGridBalancedTree=function(){return this.gridBalancedTree},n([w.Autowired("gridOptionsWrapper"),o("design:type",s.GridOptionsWrapper)],T.prototype,"gridOptionsWrapper",void 0),n([w.Autowired("expressionService"),o("design:type",c.ExpressionService)],T.prototype,"expressionService",void 0),n([w.Autowired("balancedColumnTreeBuilder"),o("design:type",u.BalancedColumnTreeBuilder)],T.prototype,"balancedColumnTreeBuilder",void 0),n([w.Autowired("displayedGroupCreator"),o("design:type",d.DisplayedGroupCreator)],T.prototype,"displayedGroupCreator",void 0),n([w.Autowired("autoWidthCalculator"),o("design:type",h.AutoWidthCalculator)],T.prototype,"autoWidthCalculator",void 0),n([w.Autowired("eventService"),o("design:type",p.EventService)],T.prototype,"eventService",void 0),n([w.Autowired("columnUtils"),o("design:type",f.ColumnUtils)],T.prototype,"columnUtils",void 0),n([w.Autowired("context"),o("design:type",w.Context)],T.prototype,"context",void 0),n([w.Autowired("columnAnimationService"),o("design:type",C.ColumnAnimationService)],T.prototype,"columnAnimationService",void 0),n([w.Autowired("autoGroupColService"),o("design:type",_.AutoGroupColService)],T.prototype,"autoGroupColService",void 0),n([w.Optional("aggFuncService"),o("design:type",Object)],T.prototype,"aggFuncService",void 0),n([w.Optional("valueCache"),o("design:type",A.ValueCache)],T.prototype,"valueCache",void 0),n([w.Autowired("columnApi"),o("design:type",x.ColumnApi)],T.prototype,"columnApi",void 0),n([w.Autowired("gridApi"),o("design:type",E.GridApi)],T.prototype,"gridApi",void 0),n([w.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],T.prototype,"init",null),n([r(0,w.Qualifier("loggerFactory")),o("design:type",Function),o("design:paramtypes",[m.LoggerFactory]),o("design:returntype",void 0)],T.prototype,"setBeans",null),T=n([w.Bean("columnController")],T));function T(){this.primaryHeaderRowCount=0,this.secondaryHeaderRowCount=0,this.secondaryColumnsPresent=!1,this.gridHeaderRowCount=0,this.displayedLeftColumns=[],this.displayedRightColumns=[],this.displayedCenterColumns=[],this.allDisplayedColumns=[],this.allDisplayedVirtualColumns=[],this.allDisplayedCenterVirtualColumns=[],this.rowGroupColumns=[],this.valueColumns=[],this.pivotColumns=[],this.ready=!1,this.autoGroupsNeedBuilding=!1,this.pivotMode=!1,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.bodyWidthDirty=!0}t.ColumnController=S},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(25);t.Events=n.Events},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(47),a=i(20),s=i(18),l=i(4),c=i(17),u=i(2),d=i(16),h=i(3),p=i(9),f=i(0),g=i(42),m=i(24),v=i(22),y=i(23),b=i(1),w=i(55),C=i(54),_=i(29),A=i(105),E=i(33),x=i(58),S=i(30),T=i(37),D=(k.prototype.registerGridComp=function(e){this.gridPanel=e},k.prototype.registerHeaderRootComp=function(e){this.headerRootComp=e},k.prototype.init=function(){switch(this.rowModel.getType()){case p.Constants.ROW_MODEL_TYPE_CLIENT_SIDE:this.clientSideRowModel=this.rowModel;break;case p.Constants.ROW_MODEL_TYPE_INFINITE:this.infinitePageRowModel=this.rowModel;break;case p.Constants.ROW_MODEL_TYPE_SERVER_SIDE:this.serverSideRowModel=this.rowModel}},k.prototype.__getAlignedGridService=function(){return this.alignedGridsService},k.prototype.addDetailGridInfo=function(e,t){this.detailGridInfoMap[e]=t},k.prototype.removeDetailGridInfo=function(e){this.detailGridInfoMap[e]=void 0},k.prototype.getDetailGridInfo=function(e){return this.detailGridInfoMap[e]},k.prototype.forEachDetailGridInfo=function(i){var n=0;b.Utils.iterateObject(this.detailGridInfoMap,function(e,t){b.Utils.exists(t)&&(i(t,n),n++)})},k.prototype.getDataAsCsv=function(e){return this.csvCreator.getDataAsCsv(e)},k.prototype.exportDataAsCsv=function(e){this.csvCreator.exportDataAsCsv(e)},k.prototype.getDataAsExcel=function(e){return this.excelCreator||console.warn("ag-Grid: Excel export is only available in ag-Grid Enterprise"),this.excelCreator.getDataAsExcelXml(e)},k.prototype.exportDataAsExcel=function(e){this.excelCreator||console.warn("ag-Grid: Excel export is only available in ag-Grid Enterprise"),this.excelCreator.exportDataAsExcel(e)},k.prototype.setEnterpriseDatasource=function(e){console.warn("ag-grid: since version 18.x, api.setEnterpriseDatasource() should be replaced with api.setServerSideDatasource()"),this.setServerSideDatasource(e)},k.prototype.setServerSideDatasource=function(e){this.gridOptionsWrapper.isRowModelServerSide()?this.rowModel.setDatasource(e):console.warn("ag-Grid: you can only use an enterprise datasource when gridOptions.rowModelType is '"+p.Constants.ROW_MODEL_TYPE_SERVER_SIDE+"'")},k.prototype.setDatasource=function(e){this.gridOptionsWrapper.isRowModelInfinite()?this.rowModel.setDatasource(e):console.warn("ag-Grid: you can only use a datasource when gridOptions.rowModelType is '"+p.Constants.ROW_MODEL_TYPE_INFINITE+"'")},k.prototype.setViewportDatasource=function(e){this.gridOptionsWrapper.isRowModelViewport()?this.rowModel.setViewportDatasource(e):console.warn("ag-Grid: you can only use a viewport datasource when gridOptions.rowModelType is '"+p.Constants.ROW_MODEL_TYPE_VIEWPORT+"'")},k.prototype.setRowData=function(e){if(this.gridOptionsWrapper.isRowModelDefault())if(this.gridOptionsWrapper.isDeltaRowDataMode()){var t=this.immutableService.createTransactionForRowData(e),i=t[0],n=t[1];this.clientSideRowModel.updateRowData(i,n)}else this.selectionController.reset(),this.clientSideRowModel.setRowData(e);else console.log("cannot call setRowData unless using normal row model")},k.prototype.setFloatingTopRowData=function(e){console.warn("ag-Grid: since v12, api.setFloatingTopRowData() is now api.setPinnedTopRowData()"),this.setPinnedTopRowData(e)},k.prototype.setFloatingBottomRowData=function(e){console.warn("ag-Grid: since v12, api.setFloatingBottomRowData() is now api.setPinnedBottomRowData()"),this.setPinnedBottomRowData(e)},k.prototype.getFloatingTopRowCount=function(){return console.warn("ag-Grid: since v12, api.getFloatingTopRowCount() is now api.getPinnedTopRowCount()"),this.getPinnedTopRowCount()},k.prototype.getFloatingBottomRowCount=function(){return console.warn("ag-Grid: since v12, api.getFloatingBottomRowCount() is now api.getPinnedBottomRowCount()"),this.getPinnedBottomRowCount()},k.prototype.getFloatingTopRow=function(e){return console.warn("ag-Grid: since v12, api.getFloatingTopRow() is now api.getPinnedTopRow()"),this.getPinnedTopRow(e)},k.prototype.getFloatingBottomRow=function(e){return console.warn("ag-Grid: since v12, api.getFloatingBottomRow() is now api.getPinnedBottomRow()"),this.getPinnedBottomRow(e)},k.prototype.setPinnedTopRowData=function(e){this.pinnedRowModel.setPinnedTopRowData(e)},k.prototype.setPinnedBottomRowData=function(e){this.pinnedRowModel.setPinnedBottomRowData(e)},k.prototype.getPinnedTopRowCount=function(){return this.pinnedRowModel.getPinnedTopRowCount()},k.prototype.getPinnedBottomRowCount=function(){return this.pinnedRowModel.getPinnedBottomRowCount()},k.prototype.getPinnedTopRow=function(e){return this.pinnedRowModel.getPinnedTopRow(e)},k.prototype.getPinnedBottomRow=function(e){return this.pinnedRowModel.getPinnedBottomRow(e)},k.prototype.setColumnDefs=function(e,t){void 0===t&&(t="api"),this.columnController.setColumnDefs(e,t)},k.prototype.expireValueCache=function(){this.valueCache.expire()},k.prototype.getVerticalPixelRange=function(){return this.gridPanel.getVScrollPosition()},k.prototype.refreshToolPanel=function(){this.toolPanelComp&&this.toolPanelComp.refresh()},k.prototype.refreshCells=function(e){void 0===e&&(e={}),Array.isArray(e)?console.warn("since ag-Grid v11.1, refreshCells() now takes parameters, please see the documentation."):this.rowRenderer.refreshCells(e)},k.prototype.flashCells=function(e){void 0===e&&(e={}),this.rowRenderer.flashCells(e)},k.prototype.redrawRows=function(e){void 0===e&&(e={}),e&&e.rowNodes?this.rowRenderer.redrawRows(e.rowNodes):this.rowRenderer.redrawAfterModelUpdate()},k.prototype.timeFullRedraw=function(a){void 0===a&&(a=1);var s=0,l=0,c=0,e=this;!function n(){var o=(new Date).getTime();e.rowRenderer.redrawAfterModelUpdate();var r=(new Date).getTime();setTimeout(function(){var e=(new Date).getTime(),t=r-o,i=e-r;console.log("duration:  processing = "+t+"ms, reflow = "+i+"ms"),l+=t,c+=i,++s<a?setTimeout(n,1e3):(console.log("tests complete. iteration count = "+s),console.log("average processing = "+l/s+"ms"),console.log("average reflow = "+c/s+"ms"))},0)}()},k.prototype.refreshView=function(){console.warn("ag-Grid: since v11.1, refreshView() is deprecated, please call refreshCells() or redrawRows() instead"),this.redrawRows()},k.prototype.refreshRows=function(e){console.warn("since ag-Grid v11.1, refreshRows() is deprecated, please use refreshCells({rowNodes: rows}) or redrawRows({rowNodes: rows}) instead"),this.refreshCells({rowNodes:e})},k.prototype.rowDataChanged=function(e){console.log("ag-Grid: rowDataChanged is deprecated, either call refreshView() to refresh everything, or call rowNode.setRowData(newData) to set value on a particular node"),this.redrawRows()},k.prototype.softRefreshView=function(){console.error("ag-Grid: since v16, softRefreshView() is no longer supported. Please check the documentation on how to refresh.")},k.prototype.refreshGroupRows=function(){console.warn("ag-Grid: since v11.1, refreshGroupRows() is no longer supported, call refreshCells() instead. Because refreshCells() now does dirty checking, it will only refresh cells that have changed, so it should not be necessary to only refresh the group rows."),this.refreshCells()},k.prototype.setFunctionsReadOnly=function(e){this.gridOptionsWrapper.setProperty("functionsReadOnly",e)},k.prototype.refreshHeader=function(){this.headerRootComp.refreshHeader(),this.gridPanel.setBodyAndHeaderHeights()},k.prototype.isAnyFilterPresent=function(){return this.filterManager.isAnyFilterPresent()},k.prototype.isAdvancedFilterPresent=function(){return this.filterManager.isAdvancedFilterPresent()},k.prototype.isQuickFilterPresent=function(){return this.filterManager.isQuickFilterPresent()},k.prototype.getModel=function(){return this.rowModel},k.prototype.onGroupExpandedOrCollapsed=function(e){b.Utils.missing(this.clientSideRowModel)&&console.log("ag-Grid: cannot call onGroupExpandedOrCollapsed unless using normal row model"),b.Utils.exists(e)&&console.log("ag-Grid: api.onGroupExpandedOrCollapsed - refreshFromIndex parameter is no longer used, the grid will refresh all rows"),this.clientSideRowModel.refreshModel({step:p.Constants.STEP_MAP})},k.prototype.refreshInMemoryRowModel=function(e){console.warn("ag-grid: since version 18.x, api.refreshInMemoryRowModel() should be replaced with api.refreshClientSideRowModel()"),this.refreshClientSideRowModel(e)},k.prototype.refreshClientSideRowModel=function(e){b.Utils.missing(this.clientSideRowModel)&&console.log("cannot call refreshClientSideRowModel unless using normal row model");var t=p.Constants.STEP_EVERYTHING,i={group:p.Constants.STEP_EVERYTHING,filter:p.Constants.STEP_FILTER,map:p.Constants.STEP_MAP,aggregate:p.Constants.STEP_AGGREGATE,sort:p.Constants.STEP_SORT,pivot:p.Constants.STEP_PIVOT};if(b.Utils.exists(e)&&(t=i[e]),b.Utils.missing(t))console.error("ag-Grid: invalid step "+e+", available steps are "+Object.keys(i).join(", "));else{var n={step:t,keepRenderedRows:!0,animate:!0,keepEditingRows:!0};this.clientSideRowModel.refreshModel(n)}},k.prototype.isAnimationFrameQueueEmpty=function(){return this.animationFrameService.isQueueEmpty()},k.prototype.getRowNode=function(e){return this.rowModel.getRowNode(e)},k.prototype.expandAll=function(){b.Utils.missing(this.clientSideRowModel)?console.warn("ag-Grid: cannot call expandAll unless using normal row model"):this.clientSideRowModel.expandOrCollapseAll(!0)},k.prototype.collapseAll=function(){b.Utils.missing(this.clientSideRowModel)?console.warn("ag-Grid: cannot call collapseAll unless using normal row model"):this.clientSideRowModel.expandOrCollapseAll(!1)},k.prototype.addVirtualRowListener=function(e,t,i){"string"!=typeof e&&console.log("ag-Grid: addVirtualRowListener is deprecated, please use addRenderedRowListener."),this.addRenderedRowListener(e,t,i)},k.prototype.addRenderedRowListener=function(e,t,i){"virtualRowSelected"===e&&console.log("ag-Grid: event virtualRowSelected is deprecated, to register for individual row selection events, add a listener directly to the row node."),this.rowRenderer.addRenderedRowListener(e,t,i)},k.prototype.setQuickFilter=function(e){this.filterManager.setQuickFilter(e)},k.prototype.selectIndex=function(e,t,i){console.log("ag-Grid: do not use api for selection, call node.setSelected(value) instead"),i&&console.log("ag-Grid: suppressEvents is no longer supported, stop listening for the event if you no longer want it"),this.selectionController.selectIndex(e,t)},k.prototype.deselectIndex=function(e,t){void 0===t&&(t=!1),console.log("ag-Grid: do not use api for selection, call node.setSelected(value) instead"),t&&console.log("ag-Grid: suppressEvents is no longer supported, stop listening for the event if you no longer want it"),this.selectionController.deselectIndex(e)},k.prototype.selectNode=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1),console.log("ag-Grid: API for selection is deprecated, call node.setSelected(value) instead"),i&&console.log("ag-Grid: suppressEvents is no longer supported, stop listening for the event if you no longer want it"),e.setSelectedParams({newValue:!0,clearSelection:!t})},k.prototype.deselectNode=function(e,t){void 0===t&&(t=!1),console.log("ag-Grid: API for selection is deprecated, call node.setSelected(value) instead"),t&&console.log("ag-Grid: suppressEvents is no longer supported, stop listening for the event if you no longer want it"),e.setSelectedParams({newValue:!1})},k.prototype.selectAll=function(){this.selectionController.selectAllRowNodes()},k.prototype.deselectAll=function(){this.selectionController.deselectAllRowNodes()},k.prototype.selectAllFiltered=function(){this.selectionController.selectAllRowNodes(!0)},k.prototype.deselectAllFiltered=function(){this.selectionController.deselectAllRowNodes(!0)},k.prototype.recomputeAggregates=function(){b.Utils.missing(this.clientSideRowModel)&&console.warn("cannot call recomputeAggregates unless using normal row model"),console.warn("recomputeAggregates is deprecated, please call api.refreshClientSideRowModel('aggregate') instead"),this.clientSideRowModel.refreshModel({step:p.Constants.STEP_AGGREGATE})},k.prototype.sizeColumnsToFit=function(){this.gridPanel.sizeColumnsToFit()},k.prototype.showLoadingOverlay=function(){this.gridPanel.showLoadingOverlay()},k.prototype.showNoRowsOverlay=function(){this.gridPanel.showNoRowsOverlay()},k.prototype.hideOverlay=function(){this.gridPanel.hideOverlay()},k.prototype.isNodeSelected=function(e){return console.log("ag-Grid: no need to call api.isNodeSelected(), just call node.isSelected() instead"),e.isSelected()},k.prototype.getSelectedNodesById=function(){return console.error("ag-Grid: since version 3.4, getSelectedNodesById no longer exists, use getSelectedNodes() instead"),null},k.prototype.getSelectedNodes=function(){return this.selectionController.getSelectedNodes()},k.prototype.getSelectedRows=function(){return this.selectionController.getSelectedRows()},k.prototype.getBestCostNodeSelection=function(){return this.selectionController.getBestCostNodeSelection()},k.prototype.getRenderedNodes=function(){return this.rowRenderer.getRenderedNodes()},k.prototype.ensureColIndexVisible=function(e){console.warn("ag-Grid: ensureColIndexVisible(index) no longer supported, use ensureColumnVisible(colKey) instead.")},k.prototype.ensureColumnVisible=function(e){this.gridPanel.ensureColumnVisible(e)},k.prototype.ensureIndexVisible=function(e,t){this.gridPanel.ensureIndexVisible(e,t)},k.prototype.ensureNodeVisible=function(e,t){this.gridCore.ensureNodeVisible(e,t)},k.prototype.forEachLeafNode=function(e){b.Utils.missing(this.clientSideRowModel)&&console.log("cannot call forEachNode unless using normal row model"),this.clientSideRowModel.forEachLeafNode(e)},k.prototype.forEachNode=function(e){this.rowModel.forEachNode(e)},k.prototype.forEachNodeAfterFilter=function(e){b.Utils.missing(this.clientSideRowModel)&&console.log("cannot call forEachNodeAfterFilter unless using normal row model"),this.clientSideRowModel.forEachNodeAfterFilter(e)},k.prototype.forEachNodeAfterFilterAndSort=function(e){b.Utils.missing(this.clientSideRowModel)&&console.log("cannot call forEachNodeAfterFilterAndSort unless using normal row model"),this.clientSideRowModel.forEachNodeAfterFilterAndSort(e)},k.prototype.getFilterApiForColDef=function(e){return console.warn("ag-grid API method getFilterApiForColDef deprecated, use getFilterApi instead"),this.getFilterInstance(e)},k.prototype.getFilterInstance=function(e){var t=this.columnController.getPrimaryColumn(e);if(t)return this.filterManager.getFilterComponent(t).resolveNow(null,function(e){return e})},k.prototype.getFilterApi=function(e){return console.warn("ag-Grid: getFilterApi is deprecated, use getFilterInstance instead"),this.getFilterInstance(e)},k.prototype.destroyFilter=function(e){var t=this.columnController.getPrimaryColumn(e);if(t)return this.filterManager.destroyFilter(t,"filterDestroyed")},k.prototype.getColumnDef=function(e){var t=this.columnController.getPrimaryColumn(e);return t?t.getColDef():null},k.prototype.onFilterChanged=function(){this.filterManager.onFilterChanged()},k.prototype.onSortChanged=function(){this.sortController.onSortChanged()},k.prototype.setSortModel=function(e,t){void 0===t&&(t="api"),this.sortController.setSortModel(e,t)},k.prototype.getSortModel=function(){return this.sortController.getSortModel()},k.prototype.setFilterModel=function(e){this.filterManager.setFilterModel(e)},k.prototype.getFilterModel=function(){return this.filterManager.getFilterModel()},k.prototype.getFocusedCell=function(){return this.focusedCellController.getFocusedCell()},k.prototype.clearFocusedCell=function(){return this.focusedCellController.clearFocusedCell()},k.prototype.setFocusedCell=function(e,t,i){this.focusedCellController.setFocusedCell(e,t,i,!0)},k.prototype.setSuppressRowDrag=function(e){this.gridOptionsWrapper.setProperty(u.GridOptionsWrapper.PROP_SUPPRESS_ROW_DRAG,e)},k.prototype.setHeaderHeight=function(e){this.gridOptionsWrapper.setProperty(u.GridOptionsWrapper.PROP_HEADER_HEIGHT,e),this.doLayout()},k.prototype.setGridAutoHeight=function(e){this.gridOptionsWrapper.setProperty(u.GridOptionsWrapper.PROP_GRID_AUTO_HEIGHT,e)},k.prototype.getPreferredWidth=function(){return this.gridCore.getPreferredWidth()},k.prototype.setGroupHeaderHeight=function(e){this.gridOptionsWrapper.setProperty(u.GridOptionsWrapper.PROP_GROUP_HEADER_HEIGHT,e),this.doLayout()},k.prototype.setFloatingFiltersHeight=function(e){this.gridOptionsWrapper.setProperty(u.GridOptionsWrapper.PROP_FLOATING_FILTERS_HEIGHT,e),this.doLayout()},k.prototype.setPivotGroupHeaderHeight=function(e){this.gridOptionsWrapper.setProperty(u.GridOptionsWrapper.PROP_PIVOT_GROUP_HEADER_HEIGHT,e),this.doLayout()},k.prototype.setPivotHeaderHeight=function(e){this.gridOptionsWrapper.setProperty(u.GridOptionsWrapper.PROP_PIVOT_HEADER_HEIGHT,e),this.doLayout()},k.prototype.showToolPanel=function(e){this.gridCore.showToolPanel(e)},k.prototype.setSuppressClipboardPaste=function(e){this.gridOptionsWrapper.setProperty(u.GridOptionsWrapper.PROP_SUPPRESS_CLIPBOARD_PASTE,e)},k.prototype.isToolPanelShowing=function(){return this.gridCore.isToolPanelShowing()},k.prototype.doLayout=function(){this.gridPanel.checkViewportAndScrolls()},k.prototype.resetRowHeights=function(){b.Utils.exists(this.clientSideRowModel)&&this.clientSideRowModel.resetRowHeights()},k.prototype.setGroupRemoveSingleChildren=function(e){this.gridOptionsWrapper.setProperty(u.GridOptionsWrapper.PROP_GROUP_REMOVE_SINGLE_CHILDREN,e)},k.prototype.setGroupRemoveLowestSingleChildren=function(e){this.gridOptionsWrapper.setProperty(u.GridOptionsWrapper.PROP_GROUP_REMOVE_LOWEST_SINGLE_CHILDREN,e)},k.prototype.onRowHeightChanged=function(){b.Utils.exists(this.clientSideRowModel)&&this.clientSideRowModel.onRowHeightChanged()},k.prototype.getValue=function(e,t){var i=this.columnController.getPrimaryColumn(e);return b.Utils.missing(i)&&(i=this.columnController.getGridColumn(e)),b.Utils.missing(i)?null:this.valueService.getValue(i,t)},k.prototype.addEventListener=function(e,t){var i=this.gridOptionsWrapper.useAsyncEvents();this.eventService.addEventListener(e,t,i)},k.prototype.addGlobalListener=function(e){var t=this.gridOptionsWrapper.useAsyncEvents();this.eventService.addGlobalListener(e,t)},k.prototype.removeEventListener=function(e,t){var i=this.gridOptionsWrapper.useAsyncEvents();this.eventService.removeEventListener(e,t,i)},k.prototype.removeGlobalListener=function(e){var t=this.gridOptionsWrapper.useAsyncEvents();this.eventService.removeGlobalListener(e,t)},k.prototype.dispatchEvent=function(e){this.eventService.dispatchEvent(e)},k.prototype.destroy=function(){this.context.destroy()},k.prototype.resetQuickFilter=function(){this.rowModel.forEachNode(function(e){return e.quickFilterAggregateText=null})},k.prototype.getRangeSelections=function(){return this.rangeController?this.rangeController.getCellRanges():(console.warn("ag-Grid: cell range selection is only available in ag-Grid Enterprise"),null)},k.prototype.camelCaseToHumanReadable=function(e){return b.Utils.camelCaseToHumanText(e)},k.prototype.addRangeSelection=function(e){this.rangeController||console.warn("ag-Grid: cell range selection is only available in ag-Grid Enterprise"),this.rangeController.addRange(e)},k.prototype.clearRangeSelection=function(){this.rangeController||console.warn("ag-Grid: cell range selection is only available in ag-Grid Enterprise"),this.rangeController.clearSelection()},k.prototype.copySelectedRowsToClipboard=function(e,t){this.clipboardService||console.warn("ag-Grid: clipboard is only available in ag-Grid Enterprise"),this.clipboardService.copySelectedRowsToClipboard(e,t)},k.prototype.copySelectedRangeToClipboard=function(e){this.clipboardService||console.warn("ag-Grid: clipboard is only available in ag-Grid Enterprise"),this.clipboardService.copySelectedRangeToClipboard(e)},k.prototype.copySelectedRangeDown=function(){this.clipboardService||console.warn("ag-Grid: clipboard is only available in ag-Grid Enterprise"),this.clipboardService.copyRangeDown()},k.prototype.showColumnMenuAfterButtonClick=function(e,t){var i=this.columnController.getPrimaryColumn(e);this.menuFactory.showMenuAfterButtonClick(i,t)},k.prototype.showColumnMenuAfterMouseClick=function(e,t){var i=this.columnController.getPrimaryColumn(e);this.menuFactory.showMenuAfterMouseEvent(i,t)},k.prototype.hidePopupMenu=function(){this.contextMenuFactory&&this.contextMenuFactory.hideActiveMenu(),this.menuFactory.hideActiveMenu()},k.prototype.setPopupParent=function(e){this.gridOptionsWrapper.setProperty(u.GridOptionsWrapper.PROP_POPUP_PARENT,e)},k.prototype.tabToNextCell=function(){return this.rowRenderer.tabToNextCell(!1)},k.prototype.tabToPreviousCell=function(){return this.rowRenderer.tabToNextCell(!0)},k.prototype.getCellRendererInstances=function(e){return void 0===e&&(e={}),this.rowRenderer.getCellRendererInstances(e)},k.prototype.getCellEditorInstances=function(e){return void 0===e&&(e={}),this.rowRenderer.getCellEditorInstances(e)},k.prototype.getEditingCells=function(){return this.rowRenderer.getEditingCells()},k.prototype.stopEditing=function(e){void 0===e&&(e=!1),this.rowRenderer.stopEditing(e)},k.prototype.startEditingCell=function(e){var t=this.columnController.getGridColumn(e.colKey);if(t){var i={rowIndex:e.rowIndex,floating:e.rowPinned,column:t},n=new y.GridCell(i);b.Utils.missing(e.rowPinned)&&this.gridPanel.ensureIndexVisible(e.rowIndex),this.rowRenderer.startEditingCell(n,e.keyPress,e.charPress)}else console.warn("ag-Grid: no column found for "+e.colKey)},k.prototype.addAggFunc=function(e,t){this.aggFuncService&&this.aggFuncService.addAggFunc(e,t)},k.prototype.addAggFuncs=function(e){this.aggFuncService&&this.aggFuncService.addAggFuncs(e)},k.prototype.clearAggFuncs=function(){this.aggFuncService&&this.aggFuncService.clear()},k.prototype.updateRowData=function(e){var t=null;return this.clientSideRowModel?t=this.clientSideRowModel.updateRowData(e):this.infinitePageRowModel?this.infinitePageRowModel.updateRowData(e):console.error("ag-Grid: updateRowData() only works with ClientSideRowModel and InfiniteRowModel."),this.gridOptionsWrapper.isSuppressChangeDetection()||this.rowRenderer.refreshCells(),t},k.prototype.batchUpdateRowData=function(e,t){this.clientSideRowModel?this.clientSideRowModel.batchUpdateRowData(e,t):console.error("ag-Grid: api.batchUpdateRowData() only works with ClientSideRowModel.")},k.prototype.insertItemsAtIndex=function(e,t,i){void 0===i&&(i=!1),console.warn("ag-Grid: insertItemsAtIndex() is deprecated, use updateRowData(transaction) instead."),this.updateRowData({add:t,addIndex:e,update:null,remove:null})},k.prototype.removeItems=function(e,t){void 0===t&&(t=!1),console.warn("ag-Grid: removeItems() is deprecated, use updateRowData(transaction) instead.");var i=e.map(function(e){return e.data});this.updateRowData({add:null,addIndex:null,update:null,remove:i})},k.prototype.addItems=function(e,t){void 0===t&&(t=!1),console.warn("ag-Grid: addItems() is deprecated, use updateRowData(transaction) instead."),this.updateRowData({add:e,addIndex:null,update:null,remove:null})},k.prototype.refreshVirtualPageCache=function(){console.warn("ag-Grid: refreshVirtualPageCache() is now called refreshInfiniteCache(), please call refreshInfiniteCache() instead"),this.refreshInfiniteCache()},k.prototype.refreshInfinitePageCache=function(){console.warn("ag-Grid: refreshInfinitePageCache() is now called refreshInfiniteCache(), please call refreshInfiniteCache() instead"),this.refreshInfiniteCache()},k.prototype.refreshInfiniteCache=function(){this.infinitePageRowModel?this.infinitePageRowModel.refreshCache():console.warn("ag-Grid: api.refreshInfiniteCache is only available when rowModelType='infinite'.")},k.prototype.purgeVirtualPageCache=function(){console.warn("ag-Grid: purgeVirtualPageCache() is now called purgeInfiniteCache(), please call purgeInfiniteCache() instead"),this.purgeInfinitePageCache()},k.prototype.purgeInfinitePageCache=function(){console.warn("ag-Grid: purgeInfinitePageCache() is now called purgeInfiniteCache(), please call purgeInfiniteCache() instead"),this.purgeInfiniteCache()},k.prototype.purgeInfiniteCache=function(){this.infinitePageRowModel?this.infinitePageRowModel.purgeCache():console.warn("ag-Grid: api.purgeInfiniteCache is only available when rowModelType='infinite'.")},k.prototype.purgeEnterpriseCache=function(e){console.warn("ag-grid: since version 18.x, api.purgeEnterpriseCache() should be replaced with api.purgeServerSideCache()"),this.purgeServerSideCache(e)},k.prototype.purgeServerSideCache=function(e){this.serverSideRowModel?this.serverSideRowModel.purgeCache(e):console.warn("ag-Grid: api.purgeServerSideCache is only available when rowModelType='enterprise'.")},k.prototype.getVirtualRowCount=function(){return console.warn("ag-Grid: getVirtualRowCount() is now called getInfiniteRowCount(), please call getInfiniteRowCount() instead"),this.getInfiniteRowCount()},k.prototype.getInfiniteRowCount=function(){if(this.infinitePageRowModel)return this.infinitePageRowModel.getVirtualRowCount();console.warn("ag-Grid: api.getVirtualRowCount is only available when rowModelType='virtual'.")},k.prototype.isMaxRowFound=function(){if(this.infinitePageRowModel)return this.infinitePageRowModel.isMaxRowFound();console.warn("ag-Grid: api.isMaxRowFound is only available when rowModelType='virtual'.")},k.prototype.setVirtualRowCount=function(e,t){console.warn("ag-Grid: setVirtualRowCount() is now called setInfiniteRowCount(), please call setInfiniteRowCount() instead"),this.setInfiniteRowCount(e,t)},k.prototype.setInfiniteRowCount=function(e,t){this.infinitePageRowModel?this.infinitePageRowModel.setVirtualRowCount(e,t):console.warn("ag-Grid: api.setVirtualRowCount is only available when rowModelType='virtual'.")},k.prototype.getVirtualPageState=function(){return console.warn("ag-Grid: getVirtualPageState() is now called getCacheBlockState(), please call getCacheBlockState() instead"),this.getCacheBlockState()},k.prototype.getInfinitePageState=function(){return console.warn("ag-Grid: getInfinitePageState() is now called getCacheBlockState(), please call getCacheBlockState() instead"),this.getCacheBlockState()},k.prototype.getCacheBlockState=function(){return this.infinitePageRowModel?this.infinitePageRowModel.getBlockState():this.serverSideRowModel?this.serverSideRowModel.getBlockState():void console.warn("ag-Grid: api.getCacheBlockState() is only available when rowModelType='infinite' or rowModelType='serverSide'.")},k.prototype.checkGridSize=function(){this.gridPanel.setBodyAndHeaderHeights()},k.prototype.getFirstRenderedRow=function(){return console.log("in ag-Grid v12, getFirstRenderedRow() was renamed to getFirstDisplayedRow()"),this.getFirstDisplayedRow()},k.prototype.getFirstDisplayedRow=function(){return this.rowRenderer.getFirstVirtualRenderedRow()},k.prototype.getLastRenderedRow=function(){return console.log("in ag-Grid v12, getLastRenderedRow() was renamed to getLastDisplayedRow()"),this.getLastDisplayedRow()},k.prototype.getLastDisplayedRow=function(){return this.rowRenderer.getLastVirtualRenderedRow()},k.prototype.getDisplayedRowAtIndex=function(e){return this.rowModel.getRow(e)},k.prototype.getDisplayedRowCount=function(){return this.rowModel.getRowCount()},k.prototype.paginationIsLastPageFound=function(){return this.paginationProxy.isLastPageFound()},k.prototype.paginationGetPageSize=function(){return this.paginationProxy.getPageSize()},k.prototype.paginationSetPageSize=function(e){this.gridOptionsWrapper.setProperty("paginationPageSize",e)},k.prototype.paginationGetCurrentPage=function(){return this.paginationProxy.getCurrentPage()},k.prototype.paginationGetTotalPages=function(){return this.paginationProxy.getTotalPages()},k.prototype.paginationGetRowCount=function(){return this.paginationProxy.getTotalRowCount()},k.prototype.paginationGoToNextPage=function(){this.paginationProxy.goToNextPage()},k.prototype.paginationGoToPreviousPage=function(){this.paginationProxy.goToPreviousPage()},k.prototype.paginationGoToFirstPage=function(){this.paginationProxy.goToFirstPage()},k.prototype.paginationGoToLastPage=function(){this.paginationProxy.goToLastPage()},k.prototype.paginationGoToPage=function(e){this.paginationProxy.goToPage(e)},n([f.Autowired("immutableService"),o("design:type",A.ImmutableService)],k.prototype,"immutableService",void 0),n([f.Autowired("csvCreator"),o("design:type",r.CsvCreator)],k.prototype,"csvCreator",void 0),n([f.Optional("excelCreator"),o("design:type",Object)],k.prototype,"excelCreator",void 0),n([f.Autowired("gridCore"),o("design:type",g.GridCore)],k.prototype,"gridCore",void 0),n([f.Autowired("rowRenderer"),o("design:type",a.RowRenderer)],k.prototype,"rowRenderer",void 0),n([f.Autowired("filterManager"),o("design:type",s.FilterManager)],k.prototype,"filterManager",void 0),n([f.Autowired("columnController"),o("design:type",l.ColumnController)],k.prototype,"columnController",void 0),n([f.Autowired("selectionController"),o("design:type",c.SelectionController)],k.prototype,"selectionController",void 0),n([f.Autowired("gridOptionsWrapper"),o("design:type",u.GridOptionsWrapper)],k.prototype,"gridOptionsWrapper",void 0),n([f.Autowired("valueService"),o("design:type",d.ValueService)],k.prototype,"valueService",void 0),n([f.Autowired("alignedGridsService"),o("design:type",x.AlignedGridsService)],k.prototype,"alignedGridsService",void 0),n([f.Autowired("eventService"),o("design:type",h.EventService)],k.prototype,"eventService",void 0),n([f.Autowired("pinnedRowModel"),o("design:type",S.PinnedRowModel)],k.prototype,"pinnedRowModel",void 0),n([f.Autowired("context"),o("design:type",f.Context)],k.prototype,"context",void 0),n([f.Autowired("rowModel"),o("design:type",Object)],k.prototype,"rowModel",void 0),n([f.Autowired("sortController"),o("design:type",m.SortController)],k.prototype,"sortController",void 0),n([f.Autowired("paginationProxy"),o("design:type",_.PaginationProxy)],k.prototype,"paginationProxy",void 0),n([f.Autowired("focusedCellController"),o("design:type",v.FocusedCellController)],k.prototype,"focusedCellController",void 0),n([f.Optional("rangeController"),o("design:type",Object)],k.prototype,"rangeController",void 0),n([f.Optional("clipboardService"),o("design:type",Object)],k.prototype,"clipboardService",void 0),n([f.Optional("aggFuncService"),o("design:type",Object)],k.prototype,"aggFuncService",void 0),n([f.Autowired("menuFactory"),o("design:type",Object)],k.prototype,"menuFactory",void 0),n([f.Optional("contextMenuFactory"),o("design:type",Object)],k.prototype,"contextMenuFactory",void 0),n([f.Autowired("cellRendererFactory"),o("design:type",w.CellRendererFactory)],k.prototype,"cellRendererFactory",void 0),n([f.Autowired("cellEditorFactory"),o("design:type",C.CellEditorFactory)],k.prototype,"cellEditorFactory",void 0),n([f.Autowired("valueCache"),o("design:type",E.ValueCache)],k.prototype,"valueCache",void 0),n([f.Optional("toolPanelComp"),o("design:type",Object)],k.prototype,"toolPanelComp",void 0),n([f.Autowired("animationFrameService"),o("design:type",T.AnimationFrameService)],k.prototype,"animationFrameService",void 0),n([f.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],k.prototype,"init",null),k=n([f.Bean("gridApi")],k));function k(){this.detailGridInfoMap={}}t.GridApi=D},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(4),a=i(0),s=(l.prototype.sizeColumnsToFit=function(e){this.columnController.sizeColumnsToFit(e,"api")},l.prototype.setColumnGroupOpened=function(e,t){this.columnController.setColumnGroupOpened(e,t,"api")},l.prototype.getColumnGroup=function(e,t){return this.columnController.getColumnGroup(e,t)},l.prototype.getOriginalColumnGroup=function(e){return this.columnController.getOriginalColumnGroup(e)},l.prototype.getDisplayNameForColumn=function(e,t){return this.columnController.getDisplayNameForColumn(e,t)},l.prototype.getDisplayNameForColumnGroup=function(e,t){return this.columnController.getDisplayNameForColumnGroup(e,t)},l.prototype.getColumn=function(e){return this.columnController.getPrimaryColumn(e)},l.prototype.setColumnState=function(e){return this.columnController.setColumnState(e,"api")},l.prototype.getColumnState=function(){return this.columnController.getColumnState()},l.prototype.resetColumnState=function(){this.columnController.resetColumnState("api")},l.prototype.getColumnGroupState=function(){return this.columnController.getColumnGroupState()},l.prototype.setColumnGroupState=function(e){this.columnController.setColumnGroupState(e,"api")},l.prototype.resetColumnGroupState=function(){this.columnController.resetColumnGroupState("api")},l.prototype.isPinning=function(){return this.columnController.isPinningLeft()||this.columnController.isPinningRight()},l.prototype.isPinningLeft=function(){return this.columnController.isPinningLeft()},l.prototype.isPinningRight=function(){return this.columnController.isPinningRight()},l.prototype.getDisplayedColAfter=function(e){return this.columnController.getDisplayedColAfter(e)},l.prototype.getDisplayedColBefore=function(e){return this.columnController.getDisplayedColBefore(e)},l.prototype.setColumnVisible=function(e,t){this.columnController.setColumnVisible(e,t,"api")},l.prototype.setColumnsVisible=function(e,t){this.columnController.setColumnsVisible(e,t,"api")},l.prototype.setColumnPinned=function(e,t){this.columnController.setColumnPinned(e,t,"api")},l.prototype.setColumnsPinned=function(e,t){this.columnController.setColumnsPinned(e,t,"api")},l.prototype.getAllColumns=function(){return this.columnController.getAllPrimaryColumns()},l.prototype.getAllGridColumns=function(){return this.columnController.getAllGridColumns()},l.prototype.getDisplayedLeftColumns=function(){return this.columnController.getDisplayedLeftColumns()},l.prototype.getDisplayedCenterColumns=function(){return this.columnController.getDisplayedCenterColumns()},l.prototype.getDisplayedRightColumns=function(){return this.columnController.getDisplayedRightColumns()},l.prototype.getAllDisplayedColumns=function(){return this.columnController.getAllDisplayedColumns()},l.prototype.getAllDisplayedVirtualColumns=function(){return this.columnController.getAllDisplayedVirtualColumns()},l.prototype.moveColumn=function(e,t){"number"==typeof e?(console.log("ag-Grid: you are using moveColumn(fromIndex, toIndex) - moveColumn takes a column key and a destination index, not two indexes, to move with indexes use moveColumnByIndex(from,to) instead"),this.columnController.moveColumnByIndex(e,t,"api")):this.columnController.moveColumn(e,t,"api")},l.prototype.moveColumnByIndex=function(e,t){this.columnController.moveColumnByIndex(e,t,"api")},l.prototype.moveColumns=function(e,t){this.columnController.moveColumns(e,t,"api")},l.prototype.moveRowGroupColumn=function(e,t){this.columnController.moveRowGroupColumn(e,t)},l.prototype.setColumnAggFunc=function(e,t){this.columnController.setColumnAggFunc(e,t)},l.prototype.setColumnWidth=function(e,t,i){void 0===i&&(i=!0),this.columnController.setColumnWidth(e,t,!1,i)},l.prototype.setPivotMode=function(e){this.columnController.setPivotMode(e)},l.prototype.isPivotMode=function(){return this.columnController.isPivotMode()},l.prototype.getSecondaryPivotColumn=function(e,t){return this.columnController.getSecondaryPivotColumn(e,t)},l.prototype.setValueColumns=function(e){this.columnController.setValueColumns(e,"api")},l.prototype.getValueColumns=function(){return this.columnController.getValueColumns()},l.prototype.removeValueColumn=function(e){this.columnController.removeValueColumn(e,"api")},l.prototype.removeValueColumns=function(e){this.columnController.removeValueColumns(e,"api")},l.prototype.addValueColumn=function(e){this.columnController.addValueColumn(e,"api")},l.prototype.addValueColumns=function(e){this.columnController.addValueColumns(e,"api")},l.prototype.setRowGroupColumns=function(e){this.columnController.setRowGroupColumns(e,"api")},l.prototype.removeRowGroupColumn=function(e){this.columnController.removeRowGroupColumn(e,"api")},l.prototype.removeRowGroupColumns=function(e){this.columnController.removeRowGroupColumns(e,"api")},l.prototype.addRowGroupColumn=function(e){this.columnController.addRowGroupColumn(e,"api")},l.prototype.addRowGroupColumns=function(e){this.columnController.addRowGroupColumns(e,"api")},l.prototype.getRowGroupColumns=function(){return this.columnController.getRowGroupColumns()},l.prototype.setPivotColumns=function(e){this.columnController.setPivotColumns(e,"api")},l.prototype.removePivotColumn=function(e){this.columnController.removePivotColumn(e,"api")},l.prototype.removePivotColumns=function(e){this.columnController.removePivotColumns(e,"api")},l.prototype.addPivotColumn=function(e){this.columnController.addPivotColumn(e,"api")},l.prototype.addPivotColumns=function(e){this.columnController.addPivotColumns(e,"api")},l.prototype.getPivotColumns=function(){return this.columnController.getPivotColumns()},l.prototype.getLeftDisplayedColumnGroups=function(){return this.columnController.getLeftDisplayedColumnGroups()},l.prototype.getCenterDisplayedColumnGroups=function(){return this.columnController.getCenterDisplayedColumnGroups()},l.prototype.getRightDisplayedColumnGroups=function(){return this.columnController.getRightDisplayedColumnGroups()},l.prototype.getAllDisplayedColumnGroups=function(){return this.columnController.getAllDisplayedColumnGroups()},l.prototype.autoSizeColumn=function(e){return this.columnController.autoSizeColumn(e,"api")},l.prototype.autoSizeColumns=function(e){return this.columnController.autoSizeColumns(e,"api")},l.prototype.autoSizeAllColumns=function(){this.columnController.autoSizeAllColumns("api")},l.prototype.setSecondaryColumns=function(e){this.columnController.setSecondaryColumns(e,"api")},l.prototype.columnGroupOpened=function(e,t){console.error("ag-Grid: columnGroupOpened no longer exists, use setColumnGroupOpened"),this.setColumnGroupOpened(e,t)},l.prototype.hideColumns=function(e,t){console.error("ag-Grid: hideColumns is deprecated, use setColumnsVisible"),this.columnController.setColumnsVisible(e,!t,"api")},l.prototype.hideColumn=function(e,t){console.error("ag-Grid: hideColumn is deprecated, use setColumnVisible"),this.columnController.setColumnVisible(e,!t,"api")},l.prototype.setState=function(e){return console.error("ag-Grid: setState is deprecated, use setColumnState"),this.setColumnState(e)},l.prototype.getState=function(){return console.error("ag-Grid: getState is deprecated, use getColumnState"),this.getColumnState()},l.prototype.resetState=function(){console.error("ag-Grid: resetState is deprecated, use resetColumnState"),this.resetColumnState()},l.prototype.getAggregationColumns=function(){return console.error("ag-Grid: getAggregationColumns is deprecated, use getValueColumns"),this.columnController.getValueColumns()},l.prototype.removeAggregationColumn=function(e){console.error("ag-Grid: removeAggregationColumn is deprecated, use removeValueColumn"),this.columnController.removeValueColumn(e,"api")},l.prototype.removeAggregationColumns=function(e){console.error("ag-Grid: removeAggregationColumns is deprecated, use removeValueColumns"),this.columnController.removeValueColumns(e,"api")},l.prototype.addAggregationColumn=function(e){console.error("ag-Grid: addAggregationColumn is deprecated, use addValueColumn"),this.columnController.addValueColumn(e,"api")},l.prototype.addAggregationColumns=function(e){console.error("ag-Grid: addAggregationColumns is deprecated, use addValueColumns"),this.columnController.addValueColumns(e,"api")},l.prototype.setColumnAggFunction=function(e,t){console.error("ag-Grid: setColumnAggFunction is deprecated, use setColumnAggFunc"),this.columnController.setColumnAggFunc(e,t,"api")},l.prototype.getDisplayNameForCol=function(e){return console.error("ag-Grid: getDisplayNameForCol is deprecated, use getDisplayNameForColumn"),this.getDisplayNameForColumn(e,null)},n([a.Autowired("columnController"),o("design:type",r.ColumnController)],l.prototype,"columnController",void 0),l=n([a.Bean("columnApi")],l));function l(){}t.ColumnApi=s},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r,c=i(1),a=i(13),s=new c.NumberSequence,l=(r=a.BeanStub,o(u,r),u.prototype.getCompId=function(){return this.compId},u.prototype.instantiate=function(e){this.instantiateRecurse(this.getGui(),e)},u.prototype.instantiateRecurse=function(n,o){var r=this;c.Utils.copyNodeList(n.childNodes).forEach(function(i){var e=o.createComponent(i,function(e){var t=r.getAttrLists(i);r.copyAttributesFromNode(t,e.getGui()),r.createChildAttributes(t,e),r.addEventListenersToComponent(t,e)});if(e)r.swapComponentForNode(e,n,i);else if(i.childNodes&&r.instantiateRecurse(i,o),i instanceof HTMLElement){var t=r.getAttrLists(i);r.addEventListenersToElement(t,i)}})},u.prototype.getAttrLists=function(e){var r={bindings:[],events:[],normal:[]};return c.Utils.iterateNamedNodeMap(e.attributes,function(e,t){var i=e.substr(0,1);if("("===i){var n=e.replace("(","").replace(")","");r.events.push({name:n,value:t})}else if("["===i){var o=e.replace("[","").replace("]","");r.bindings.push({name:o,value:t})}else r.normal.push({name:e,value:t})}),r},u.prototype.addEventListenersToElement=function(e,i){var n=this;this.addEventListenerCommon(e,function(e,t){n.addDestroyableEventListener(i,e,t)})},u.prototype.addEventListenersToComponent=function(e,i){var n=this;this.addEventListenerCommon(e,function(e,t){n.addDestroyableEventListener(i,e,t)})},u.prototype.addEventListenerCommon=function(e,a){var s=this,l=this.getAgComponentMetaData("methods");e.events.forEach(function(e){var t=e.value,i=c.Utils.find(l,"alias",t),n=c.Utils.exists(i)?i.methodName:t,o=s[n];if("function"==typeof o){var r=c.Utils.hyphenToCamelCase(e.name);a(r,o.bind(s))}else console.warn("ag-Grid: count not find callback "+t)})},u.prototype.createChildAttributes=function(e,t){var i=this,n={};e.normal.forEach(function(e){var t=c.Utils.hyphenToCamelCase(e.name);n[t]=e.value}),e.bindings.forEach(function(e){var t=c.Utils.hyphenToCamelCase(e.name);n[t]=i[e.value]}),t.props=n},u.prototype.copyAttributesFromNode=function(e,t){e.normal.forEach(function(e){t.setAttribute(e.name,e.value)})},u.prototype.swapComponentForNode=function(e,t,i){var n=e.getGui();t.replaceChild(n,i),t.insertBefore(document.createComment(i.nodeName),n),this.childComponents.push(e),this.swapInComponentForQuerySelectors(e,i)},u.prototype.swapInComponentForQuerySelectors=function(t,i){for(var e=Object.getPrototypeOf(this),n=this;null!=e;){var o=e.__agComponentMetaData,r=e.constructor.name;o&&o[r]&&o[r].querySelectors&&o[r].querySelectors.forEach(function(e){n[e.attributeName]===i&&(n[e.attributeName]=t)}),e=Object.getPrototypeOf(e)}},u.prototype.setTemplate=function(e){var t=c.Utils.loadTemplate(e);this.setTemplateFromElement(t)},u.prototype.setTemplateFromElement=function(e){this.eGui=e,(this.eGui.__agComponent=this).addAnnotatedEventListeners(),this.wireQuerySelectors()},u.prototype.wireQuerySelectors=function(){var o=this;if(this.eGui)for(var i=Object.getPrototypeOf(this),e=function(){var e=i.__agComponentMetaData,t=i.constructor.name;if(e&&e[t]&&e[t].querySelectors){var n=r;e[t].querySelectors.forEach(function(e){var t=o.eGui.querySelector(e.querySelector);if(t){var i=t.__agComponent;n[e.attributeName]=i||t}})}i=Object.getPrototypeOf(i)},r=this;null!=i;)e()},u.prototype.addAnnotatedEventListeners=function(){var i=this;if(this.removeAnnotatedEventListeners(),this.eGui){var e=this.getAgComponentMetaData("listenerMethods");c.Utils.missingOrEmpty(e)||(this.annotatedEventListeners||(this.annotatedEventListeners=[]),e.forEach(function(e){var t=i[e.methodName].bind(i);i.eGui.addEventListener(e.eventName,t),i.annotatedEventListeners.push({eventName:e.eventName,listener:t})}))}},u.prototype.getAgComponentMetaData=function(e){for(var t=[],i=Object.getPrototypeOf(this);null!=i;){var n=i.__agComponentMetaData,o=i.constructor.name;n&&n[o]&&n[o][e]&&(t=t.concat(n[o][e])),i=Object.getPrototypeOf(i)}return t},u.prototype.removeAnnotatedEventListeners=function(){var t=this;this.annotatedEventListeners&&this.eGui&&(this.annotatedEventListeners.forEach(function(e){t.eGui.removeEventListener(e.eventName,e.listener)}),this.annotatedEventListeners=null)},u.prototype.getGui=function(){return this.eGui},u.prototype.setGui=function(e){this.eGui=e},u.prototype.queryForHtmlElement=function(e){return this.eGui.querySelector(e)},u.prototype.queryForHtmlInputElement=function(e){return this.eGui.querySelector(e)},u.prototype.appendChild=function(e){if(c.Utils.isNodeOrElement(e))this.eGui.appendChild(e);else{var t=e;this.eGui.appendChild(t.getGui()),this.childComponents.push(t)}},u.prototype.addFeature=function(e,t){e.wireBean(t),t.destroy&&this.addDestroyFunc(t.destroy.bind(t))},u.prototype.isVisible=function(){return this.visible},u.prototype.setVisible=function(e){if(e!==this.visible){this.visible=e,c.Utils.addOrRemoveCssClass(this.eGui,"ag-hidden",!e);var t={type:u.EVENT_VISIBLE_CHANGED,visible:this.visible};this.dispatchEvent(t)}},u.prototype.addOrRemoveCssClass=function(e,t){c.Utils.addOrRemoveCssClass(this.eGui,e,t)},u.prototype.destroy=function(){r.prototype.destroy.call(this),this.childComponents.forEach(function(e){return e.destroy()}),this.childComponents.length=0,this.removeAnnotatedEventListeners()},u.prototype.addGuiEventListener=function(e,t){var i=this;this.getGui().addEventListener(e,t),this.addDestroyFunc(function(){return i.getGui().removeEventListener(e,t)})},u.prototype.addCssClass=function(e){c.Utils.addCssClass(this.getGui(),e)},u.prototype.removeCssClass=function(e){c.Utils.removeCssClass(this.getGui(),e)},u.prototype.getAttribute=function(e){var t=this.getGui();return t?t.getAttribute(e):null},u.prototype.getRefElement=function(e){return this.queryForHtmlElement('[ref="'+e+'"]')},u.EVENT_VISIBLE_CHANGED="visibleChanged",u);function u(e){var t=r.call(this)||this;return t.childComponents=[],t.annotatedEventListeners=[],t.visible=!0,t.compId=s.next(),e&&t.setTemplate(e),t}t.Component=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o.STEP_EVERYTHING=0,o.STEP_FILTER=1,o.STEP_SORT=2,o.STEP_MAP=3,o.STEP_AGGREGATE=4,o.STEP_PIVOT=5,o.ROW_BUFFER_SIZE=10,o.LAYOUT_INTERVAL=500,o.BATCH_WAIT_MILLIS=50,o.EXPORT_TYPE_DRAG_COPY="dragCopy",o.EXPORT_TYPE_CLIPBOARD="clipboard",o.EXPORT_TYPE_EXCEL="excel",o.EXPORT_TYPE_CSV="csv",o.KEY_BACKSPACE=8,o.KEY_TAB=9,o.KEY_NEW_LINE=10,o.KEY_ENTER=13,o.KEY_SHIFT=16,o.KEY_ESCAPE=27,o.KEY_SPACE=32,o.KEY_LEFT=37,o.KEY_UP=38,o.KEY_RIGHT=39,o.KEY_DOWN=40,o.KEY_DELETE=46,o.KEY_A=65,o.KEY_C=67,o.KEY_V=86,o.KEY_D=68,o.KEY_F2=113,o.KEY_PAGE_UP=33,o.KEY_PAGE_DOWN=34,o.KEY_PAGE_HOME=36,o.KEY_PAGE_END=35,o.ROW_MODEL_TYPE_INFINITE="infinite",o.ROW_MODEL_TYPE_VIEWPORT="viewport",o.ROW_MODEL_TYPE_CLIENT_SIDE="clientSide",o.ROW_MODEL_TYPE_SERVER_SIDE="serverSide",o.DEPRECATED_ROW_MODEL_TYPE_NORMAL="normal",o.ALWAYS="always",o.ONLY_WHEN_GROUPING="onlyWhenGrouping",o.PINNED_TOP="top",o.PINNED_BOTTOM="bottom",o);function o(){}t.Constants=n},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(3),a=i(1),s=i(0),l=i(2),c=i(31),u=i(7),d=i(6),h=(p.prototype.isLockPosition=function(){return this.lockPosition},p.prototype.isLockVisible=function(){return this.lockVisible},p.prototype.isLockPinned=function(){return this.lockPinned},p.prototype.setParent=function(e){this.parent=e},p.prototype.getParent=function(){return this.parent},p.prototype.initialise=function(){this.setPinned(this.colDef.pinned);var e=this.gridOptionsWrapper.getMinColWidth(),t=this.gridOptionsWrapper.getMaxColWidth();this.colDef.minWidth?this.minWidth=this.colDef.minWidth:this.minWidth=e,this.colDef.maxWidth?this.maxWidth=this.colDef.maxWidth:this.maxWidth=t,this.actualWidth=this.columnUtils.calculateColInitialWidth(this.colDef);var i=this.gridOptionsWrapper.isSuppressFieldDotNotation();this.fieldContainsDots=a.Utils.exists(this.colDef.field)&&0<=this.colDef.field.indexOf(".")&&!i,this.tooltipFieldContainsDots=a.Utils.exists(this.colDef.tooltipField)&&0<=this.colDef.tooltipField.indexOf(".")&&!i,this.validate()},p.prototype.isEmptyGroup=function(){return!1},p.prototype.isRowGroupDisplayed=function(e){if(a.Utils.missing(this.colDef)||a.Utils.missing(this.colDef.showRowGroup))return!1;var t=!0===this.colDef.showRowGroup,i=this.colDef.showRowGroup===e;return t||i},p.prototype.getUniqueId=function(){return this.getId()},p.prototype.isPrimary=function(){return this.primary},p.prototype.isFilterAllowed=function(){return this.primary&&!this.colDef.suppressFilter},p.prototype.isFieldContainsDots=function(){return this.fieldContainsDots},p.prototype.isTooltipFieldContainsDots=function(){return this.tooltipFieldContainsDots},p.prototype.validate=function(){var t=this.colDef;this.gridOptionsWrapper.isEnterprise()||["enableRowGroup","rowGroup","rowGroupIndex","enablePivot","pivot","pivotIndex","aggFunc"].forEach(function(e){a.Utils.exists(t[e])&&console.warn("ag-Grid: "+e+" is only valid in ag-Grid-Enterprise, your column definition should not have "+e)}),this.gridOptionsWrapper.isTreeData()&&["enableRowGroup","rowGroup","rowGroupIndex","enablePivot","pivot","pivotIndex"].forEach(function(e){a.Utils.exists(t[e])&&console.warn("ag-Grid: "+e+" is not possible when doing tree data, your column definition should not have "+e)}),a.Utils.exists(this.colDef.width)&&"number"!=typeof this.colDef.width&&console.warn("ag-Grid: colDef.width should be a number, not "+typeof this.colDef.width),a.Utils.get(this,"colDef.cellRendererParams.restrictToOneGroup",null)&&console.warn("ag-Grid: Since ag-grid 11.0.0 cellRendererParams.restrictToOneGroup is deprecated. You should use showRowGroup"),a.Utils.get(this,"colDef.cellRendererParams.keyMap",null)&&console.warn("ag-Grid: Since ag-grid 11.0.0 cellRendererParams.keyMap is deprecated. You should use colDef.keyCreator"),a.Utils.get(this,"colDef.cellRendererParams.keyMap",null)&&console.warn("ag-Grid: Since ag-grid 11.0.0 cellRendererParams.keyMap is deprecated. You should use colDef.keyCreator"),t.floatingCellRenderer&&(console.warn("ag-Grid: since v11, floatingCellRenderer is now pinnedRowCellRenderer"),this.colDef.pinnedRowCellRenderer=t.floatingCellRenderer),t.floatingRendererFramework&&(console.warn("ag-Grid: since v11, floatingRendererFramework is now pinnedRowCellRendererFramework"),this.colDef.pinnedRowCellRendererFramework=t.floatingRendererFramework),t.floatingRendererParams&&(console.warn("ag-Grid: since v11, floatingRendererParams is now pinnedRowCellRendererParams"),this.colDef.pinnedRowCellRendererParams=t.floatingRendererParams),t.floatingValueFormatter&&(console.warn("ag-Grid: since v11, floatingValueFormatter is now pinnedRowValueFormatter"),this.colDef.pinnedRowValueFormatter=t.floatingValueFormatter),t.cellFormatter&&(console.warn("ag-Grid: since v12, cellFormatter is now valueFormatter"),a.Utils.missing(this.colDef.valueFormatter)&&(this.colDef.valueFormatter=t.cellFormatter)),t.headerCellTemplate&&console.warn("ag-Grid: since v15, headerCellTemplate is gone, use header component instead."),t.headerCellRenderer&&console.warn("ag-Grid: since v15, headerCellRenderer is gone, use header component instead."),t.volatile&&console.warn("ag-Grid: since v16, colDef.volatile is gone, please check refresh docs on how to refresh specific cells.")},p.prototype.addEventListener=function(e,t){this.eventService.addEventListener(e,t)},p.prototype.removeEventListener=function(e,t){this.eventService.removeEventListener(e,t)},p.prototype.createIsColumnFuncParams=function(e){return{node:e,data:e.data,column:this,colDef:this.colDef,context:this.gridOptionsWrapper.getContext(),api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi()}},p.prototype.isSuppressNavigable=function(e){if("boolean"==typeof this.colDef.suppressNavigable)return this.colDef.suppressNavigable;if("function"!=typeof this.colDef.suppressNavigable)return!1;var t=this.createIsColumnFuncParams(e);return(0,this.colDef.suppressNavigable)(t)},p.prototype.isCellEditable=function(e){return!(e.group&&!this.gridOptionsWrapper.isEnableGroupEdit())&&this.isColumnFunc(e,this.colDef.editable)},p.prototype.isRowDrag=function(e){return this.isColumnFunc(e,this.colDef.rowDrag)},p.prototype.isCellCheckboxSelection=function(e){return this.isColumnFunc(e,this.colDef.checkboxSelection)},p.prototype.isSuppressPaste=function(e){return this.isColumnFunc(e,this.colDef?this.colDef.suppressPaste:null)},p.prototype.isResizable=function(){var e=this.gridOptionsWrapper.isEnableColResize(),t=this.colDef&&this.colDef.suppressResize;return e&&!t},p.prototype.isColumnFunc=function(e,t){return"boolean"==typeof t?t:"function"==typeof t&&t(this.createIsColumnFuncParams(e))},p.prototype.setMoving=function(e,t){void 0===t&&(t="api"),this.moving=e,this.eventService.dispatchEvent(this.createColumnEvent(p.EVENT_MOVING_CHANGED,t))},p.prototype.createColumnEvent=function(e,t){return{api:this.gridApi,columnApi:this.columnApi,type:e,column:this,columns:[this],source:t}},p.prototype.isMoving=function(){return this.moving},p.prototype.getSort=function(){return this.sort},p.prototype.setSort=function(e,t){void 0===t&&(t="api"),this.sort!==e&&(this.sort=e,this.eventService.dispatchEvent(this.createColumnEvent(p.EVENT_SORT_CHANGED,t)))},p.prototype.setMenuVisible=function(e,t){void 0===t&&(t="api"),this.menuVisible!==e&&(this.menuVisible=e,this.eventService.dispatchEvent(this.createColumnEvent(p.EVENT_MENU_VISIBLE_CHANGED,t)))},p.prototype.isMenuVisible=function(){return this.menuVisible},p.prototype.isSortAscending=function(){return this.sort===p.SORT_ASC},p.prototype.isSortDescending=function(){return this.sort===p.SORT_DESC},p.prototype.isSortNone=function(){return a.Utils.missing(this.sort)},p.prototype.isSorting=function(){return a.Utils.exists(this.sort)},p.prototype.getSortedAt=function(){return this.sortedAt},p.prototype.setSortedAt=function(e){this.sortedAt=e},p.prototype.setAggFunc=function(e){this.aggFunc=e},p.prototype.getAggFunc=function(){return this.aggFunc},p.prototype.getLeft=function(){return this.left},p.prototype.getOldLeft=function(){return this.oldLeft},p.prototype.getRight=function(){return this.left+this.actualWidth},p.prototype.setLeft=function(e,t){void 0===t&&(t="api"),this.oldLeft=this.left,this.left!==e&&(this.left=e,this.eventService.dispatchEvent(this.createColumnEvent(p.EVENT_LEFT_CHANGED,t)))},p.prototype.isFilterActive=function(){return this.filterActive},p.prototype.setFilterActive=function(e,t){void 0===t&&(t="api"),this.filterActive!==e&&(this.filterActive=e,this.eventService.dispatchEvent(this.createColumnEvent(p.EVENT_FILTER_ACTIVE_CHANGED,t))),this.eventService.dispatchEvent(this.createColumnEvent(p.EVENT_FILTER_CHANGED,t))},p.prototype.setPinned=function(e){this.pinned=!0===e||e===p.PINNED_LEFT?p.PINNED_LEFT:e===p.PINNED_RIGHT?p.PINNED_RIGHT:null},p.prototype.setFirstRightPinned=function(e,t){void 0===t&&(t="api"),this.firstRightPinned!==e&&(this.firstRightPinned=e,this.eventService.dispatchEvent(this.createColumnEvent(p.EVENT_FIRST_RIGHT_PINNED_CHANGED,t)))},p.prototype.setLastLeftPinned=function(e,t){void 0===t&&(t="api"),this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.eventService.dispatchEvent(this.createColumnEvent(p.EVENT_LAST_LEFT_PINNED_CHANGED,t)))},p.prototype.isFirstRightPinned=function(){return this.firstRightPinned},p.prototype.isLastLeftPinned=function(){return this.lastLeftPinned},p.prototype.isPinned=function(){return this.pinned===p.PINNED_LEFT||this.pinned===p.PINNED_RIGHT},p.prototype.isPinnedLeft=function(){return this.pinned===p.PINNED_LEFT},p.prototype.isPinnedRight=function(){return this.pinned===p.PINNED_RIGHT},p.prototype.getPinned=function(){return this.pinned},p.prototype.setVisible=function(e,t){void 0===t&&(t="api");var i=!0===e;this.visible!==i&&(this.visible=i,this.eventService.dispatchEvent(this.createColumnEvent(p.EVENT_VISIBLE_CHANGED,t)))},p.prototype.isVisible=function(){return this.visible},p.prototype.getColDef=function(){return this.colDef},p.prototype.getColumnGroupShow=function(){return this.colDef.columnGroupShow},p.prototype.getColId=function(){return this.colId},p.prototype.getId=function(){return this.getColId()},p.prototype.getDefinition=function(){return this.colDef},p.prototype.getActualWidth=function(){return this.actualWidth},p.prototype.createBaseColDefParams=function(e){return{node:e,data:e.data,colDef:this.colDef,column:this,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext()}},p.prototype.getColSpan=function(e){if(a.Utils.missing(this.colDef.colSpan))return 1;var t=this.createBaseColDefParams(e),i=this.colDef.colSpan(t);return 1<i?i:1},p.prototype.getRowSpan=function(e){if(a.Utils.missing(this.colDef.rowSpan))return 1;var t=this.createBaseColDefParams(e),i=this.colDef.rowSpan(t);return 1<i?i:1},p.prototype.setActualWidth=function(e,t){void 0===t&&(t="api"),this.actualWidth!==e&&(this.actualWidth=e,this.eventService.dispatchEvent(this.createColumnEvent(p.EVENT_WIDTH_CHANGED,t)))},p.prototype.isGreaterThanMax=function(e){return!!this.maxWidth&&e>this.maxWidth},p.prototype.getMinWidth=function(){return this.minWidth},p.prototype.getMaxWidth=function(){return this.maxWidth},p.prototype.setMinimum=function(e){void 0===e&&(e="api"),this.setActualWidth(this.minWidth,e)},p.prototype.setRowGroupActive=function(e,t){void 0===t&&(t="api"),this.rowGroupActive!==e&&(this.rowGroupActive=e,this.eventService.dispatchEvent(this.createColumnEvent(p.EVENT_ROW_GROUP_CHANGED,t)))},p.prototype.isRowGroupActive=function(){return this.rowGroupActive},p.prototype.setPivotActive=function(e,t){void 0===t&&(t="api"),this.pivotActive!==e&&(this.pivotActive=e,this.eventService.dispatchEvent(this.createColumnEvent(p.EVENT_PIVOT_CHANGED,t)))},p.prototype.isPivotActive=function(){return this.pivotActive},p.prototype.isAnyFunctionActive=function(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()},p.prototype.isAnyFunctionAllowed=function(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()},p.prototype.setValueActive=function(e,t){void 0===t&&(t="api"),this.aggregationActive!==e&&(this.aggregationActive=e,this.eventService.dispatchEvent(this.createColumnEvent(p.EVENT_VALUE_CHANGED,t)))},p.prototype.isValueActive=function(){return this.aggregationActive},p.prototype.isAllowPivot=function(){return!0===this.colDef.enablePivot},p.prototype.isAllowValue=function(){return!0===this.colDef.enableValue},p.prototype.isAllowRowGroup=function(){return!0===this.colDef.enableRowGroup},p.prototype.getMenuTabs=function(e){var t=this.getColDef().menuTabs;return null==t&&(t=e),t},p.EVENT_MOVING_CHANGED="movingChanged",p.EVENT_LEFT_CHANGED="leftChanged",p.EVENT_WIDTH_CHANGED="widthChanged",p.EVENT_LAST_LEFT_PINNED_CHANGED="lastLeftPinnedChanged",p.EVENT_FIRST_RIGHT_PINNED_CHANGED="firstRightPinnedChanged",p.EVENT_VISIBLE_CHANGED="visibleChanged",p.EVENT_FILTER_CHANGED="filterChanged",p.EVENT_FILTER_ACTIVE_CHANGED="filterActiveChanged",p.EVENT_SORT_CHANGED="sortChanged",p.EVENT_MENU_VISIBLE_CHANGED="menuVisibleChanged",p.EVENT_ROW_GROUP_CHANGED="columnRowGroupChanged",p.EVENT_PIVOT_CHANGED="columnPivotChanged",p.EVENT_VALUE_CHANGED="columnValueChanged",p.PINNED_RIGHT="right",p.PINNED_LEFT="left",p.SORT_ASC="asc",p.SORT_DESC="desc",n([s.Autowired("gridOptionsWrapper"),o("design:type",l.GridOptionsWrapper)],p.prototype,"gridOptionsWrapper",void 0),n([s.Autowired("columnUtils"),o("design:type",c.ColumnUtils)],p.prototype,"columnUtils",void 0),n([s.Autowired("frameworkFactory"),o("design:type",Object)],p.prototype,"frameworkFactory",void 0),n([s.Autowired("columnApi"),o("design:type",u.ColumnApi)],p.prototype,"columnApi",void 0),n([s.Autowired("gridApi"),o("design:type",d.GridApi)],p.prototype,"gridApi",void 0),n([s.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],p.prototype,"initialise",null),p);function p(e,t,i){this.moving=!1,this.menuVisible=!1,this.filterActive=!1,this.eventService=new r.EventService,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=e,this.visible=!e.hide,this.sort=e.sort,this.sortedAt=e.sortedAt,this.colId=t,this.primary=i,this.lockPosition=!0===e.lockPosition,this.lockPinned=!0===e.lockPinned,this.lockVisible=!0===e.lockVisible}t.Column=h},function(e,t,i){"use strict";function n(e,t,i,n){null!==e?"number"!=typeof n?o(t,"querySelectors",{attributeName:i,querySelector:e}):console.error("ag-Grid: QuerySelector should be on an attribute"):console.error("ag-Grid: QuerySelector selector should not be null")}function o(e,t,i){var n=function(e,t){e.__agComponentMetaData||(e.__agComponentMetaData={});e.__agComponentMetaData[t]||(e.__agComponentMetaData[t]={});return e.__agComponentMetaData[t]}(e,e.constructor.name);n[t]||(n[t]=[]),n[t].push(i)}Object.defineProperty(t,"__esModule",{value:!0}),t.QuerySelector=function(e){return n.bind(this,e)},t.RefSelector=function(e){return n.bind(this,"[ref="+e+"]")},t.Listener=function(e){return function(e,t,i){if(null===e)return void console.error("ag-Grid: EventListener eventName should not be null");o(t,"listenerMethods",{methodName:i,eventName:e})}.bind(this,e)},t.Method=function(e){return function(e,t,i){if(null===e)return void console.error("ag-Grid: EventListener eventName should not be null");o(t,"methods",{methodName:i,alias:e})}.bind(this,e)}},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(i,n){return function(e,t){n(e,t,i)}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(2),s=i(0),l=i(0),c=(u.prototype.setBeans=function(e){this.logging=e.isDebug()},u.prototype.create=function(e){return new d(e,this.isLogging.bind(this))},u.prototype.isLogging=function(){return this.logging},n([r(0,l.Qualifier("gridOptionsWrapper")),o("design:type",Function),o("design:paramtypes",[a.GridOptionsWrapper]),o("design:returntype",void 0)],u.prototype,"setBeans",null),u=n([s.Bean("loggerFactory")],u));function u(){}t.LoggerFactory=c;var d=(h.prototype.isLogging=function(){return this.isLoggingFunc()},h.prototype.log=function(e){this.isLoggingFunc()&&console.log("ag-Grid."+this.name+": "+e)},h);function h(e,t){this.name=e,this.isLoggingFunc=t}t.Logger=d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(3),o=i(2),r=i(1),a=(s.prototype.destroy=function(){this.destroyFunctions.forEach(function(e){return e()}),this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchEvent({type:s.EVENT_DESTROYED})},s.prototype.addEventListener=function(e,t){this.localEventService||(this.localEventService=new n.EventService),this.localEventService.addEventListener(e,t)},s.prototype.removeEventListener=function(e,t){this.localEventService&&this.localEventService.removeEventListener(e,t)},s.prototype.dispatchEventAsync=function(e){var t=this;setTimeout(function(){return t.dispatchEvent(e)},0)},s.prototype.dispatchEvent=function(e){this.localEventService&&this.localEventService.dispatchEvent(e)},s.prototype.addDestroyableEventListener=function(e,t,i){this.destroyed||(e instanceof HTMLElement?r._.addSafePassiveEventListener(e,t,i):(e instanceof Window||o.GridOptionsWrapper,e.addEventListener(t,i)),this.destroyFunctions.push(function(){e instanceof HTMLElement||e instanceof Window||o.GridOptionsWrapper,e.removeEventListener(t,i)}))},s.prototype.isAlive=function(){return!this.destroyed},s.prototype.addDestroyFunc=function(e){this.isAlive()?this.destroyFunctions.push(e):e()},s.EVENT_DESTROYED="destroyed",s);function s(){this.destroyFunctions=[],this.destroyed=!1}t.BeanStub=a},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(3),d=i(5),a=i(2),s=i(17),l=i(16),c=i(4),u=i(7),h=i(0),p=i(9),f=i(1),g=i(33),m=i(6),v=(y.prototype.setData=function(e){var t=this.data;this.data=e,this.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable();var i=this.createDataChangedEvent(e,t,!1);this.dispatchLocalEvent(i)},y.prototype.updateDataOnDetailNode=function(){this.detailNode&&(this.detailNode.data=this.data)},y.prototype.createDataChangedEvent=function(e,t,i){return{type:y.EVENT_DATA_CHANGED,node:this,oldData:t,newData:e,update:i}},y.prototype.createLocalRowEvent=function(e){return{type:e,node:this}},y.prototype.updateData=function(e){var t=this.data;this.data=e,this.updateDataOnDetailNode(),this.checkRowSelectable(),this.updateDataOnDetailNode();var i=this.createDataChangedEvent(e,t,!0);this.dispatchLocalEvent(i)},y.prototype.getRowIndexString=function(){return this.rowPinned===p.Constants.PINNED_TOP?"t-"+this.rowIndex:this.rowPinned===p.Constants.PINNED_BOTTOM?"b-"+this.rowIndex:this.rowIndex.toString()},y.prototype.createDaemonNode=function(){var e=new y;return this.context.wireBean(e),e.id=this.id,e.data=this.data,e.daemon=!0,e.selected=this.selected,e.level=this.level,e},y.prototype.setDataAndId=function(e,t){var i=f.Utils.exists(this.id)?this.createDaemonNode():null,n=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),this.selectionController.syncInRowNode(this,i),this.checkRowSelectable();var o=this.createDataChangedEvent(e,n,!1);this.dispatchLocalEvent(o)},y.prototype.checkRowSelectable=function(){var e=this.gridOptionsWrapper.getIsRowSelectableFunc(),t=e&&f.Utils.exists(this);this.setRowSelectable(!t||e(this))},y.prototype.setRowSelectable=function(e){this.selectable!==e&&(this.selectable=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(y.EVENT_SELECTABLE_CHANGED)))},y.prototype.setId=function(e){var t=this.gridOptionsWrapper.getRowNodeIdFunc();t?this.data?this.id=t(this.data):this.id=void 0:this.id=e},y.prototype.isPixelInRange=function(e){return e>=this.rowTop&&e<this.rowTop+this.rowHeight},y.prototype.clearRowTop=function(){this.oldRowTop=this.rowTop,this.setRowTop(null)},y.prototype.setFirstChild=function(e){this.firstChild!==e&&(this.firstChild=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(y.EVENT_FIRST_CHILD_CHANGED)))},y.prototype.setLastChild=function(e){this.lastChild!==e&&(this.lastChild=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(y.EVENT_LAST_CHILD_CHANGED)))},y.prototype.setChildIndex=function(e){this.childIndex!==e&&(this.childIndex=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(y.EVENT_CHILD_INDEX_CHANGED)))},y.prototype.setRowTop=function(e){this.rowTop!==e&&(this.rowTop=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(y.EVENT_TOP_CHANGED)))},y.prototype.setDragging=function(e){this.dragging!==e&&(this.dragging=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(y.EVENT_DRAGGING_CHANGED)))},y.prototype.setAllChildrenCount=function(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(y.EVENT_ALL_CHILDREN_COUNT_CHANGED)))},y.prototype.setRowHeight=function(e){this.rowHeight=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(y.EVENT_HEIGHT_CHANGED))},y.prototype.setRowIndex=function(e){this.rowIndex=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(y.EVENT_ROW_INDEX_CHANGED))},y.prototype.setUiLevel=function(e){this.uiLevel!==e&&(this.uiLevel=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(y.EVENT_UI_LEVEL_CHANGED)))},y.prototype.setExpanded=function(e){if(this.expanded!==e){this.expanded=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(y.EVENT_EXPANDED_CHANGED));var t=this.createGlobalRowEvent(d.Events.EVENT_ROW_GROUP_OPENED);this.mainEventService.dispatchEvent(t)}},y.prototype.createGlobalRowEvent=function(e){return{type:e,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned,context:this.gridOptionsWrapper.getContext(),api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi()}},y.prototype.dispatchLocalEvent=function(e){this.eventService&&this.eventService.dispatchEvent(e)},y.prototype.setDataValue=function(e,t){var i=this.columnController.getPrimaryColumn(e);this.valueService.setValue(this,i,t),this.dispatchCellChangedEvent(i,t)},y.prototype.setGroupValue=function(e,t){var i=this.columnController.getGridColumn(e);f.Utils.missing(this.groupData)&&(this.groupData={}),this.groupData[i.getColId()]=t,this.dispatchCellChangedEvent(i,t)},y.prototype.setAggData=function(e){var n=this,t=f.Utils.getAllKeysInObjects([this.aggData,e]);this.aggData=e,this.eventService&&t.forEach(function(e){var t=n.columnController.getGridColumn(e),i=n.aggData?n.aggData[e]:void 0;n.dispatchCellChangedEvent(t,i)})},y.prototype.hasChildren=function(){return this.group||this.childrenAfterGroup&&0<this.childrenAfterGroup.length},y.prototype.isEmptyFillerNode=function(){return this.group&&f.Utils.missingOrEmpty(this.childrenAfterGroup)},y.prototype.dispatchCellChangedEvent=function(e,t){var i={type:y.EVENT_CELL_CHANGED,node:this,column:e,newValue:t};this.dispatchLocalEvent(i)},y.prototype.resetQuickFilterAggregateText=function(){this.quickFilterAggregateText=null},y.prototype.isExpandable=function(){return this.hasChildren()||this.master},y.prototype.isSelected=function(){return this.footer?this.sibling.isSelected():this.selected},y.prototype.depthFirstSearch=function(t){this.childrenAfterGroup&&this.childrenAfterGroup.forEach(function(e){return e.depthFirstSearch(t)}),t(this)},y.prototype.calculateSelectedFromChildren=function(){var e,t=!1,i=!1,n=!1;if(this.childrenAfterGroup)for(var o=0;o<this.childrenAfterGroup.length;o++){var r=this.childrenAfterGroup[o];if(r.selectable)switch(r.isSelected()){case!0:t=!0;break;case!1:i=!0;break;default:n=!0}}e=n?void 0:!(!t||i)||!(!t&&i)&&void 0,this.selectThisNode(e)},y.prototype.calculateSelectedFromChildrenBubbleUp=function(){this.calculateSelectedFromChildren(),this.parent&&this.parent.calculateSelectedFromChildrenBubbleUp()},y.prototype.setSelectedInitialValue=function(e){this.selected=e},y.prototype.setSelected=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1),this.setSelectedParams({newValue:e,clearSelection:t,tailingNodeInSequence:i,rangeSelect:!1})},y.prototype.isRowPinned=function(){return this.rowPinned===p.Constants.PINNED_TOP||this.rowPinned===p.Constants.PINNED_BOTTOM},y.prototype.setSelectedParams=function(e){var t=this.gridOptionsWrapper.isGroupSelectsChildren(),i=!0===e.newValue,n=!0===e.clearSelection,o=!0===e.tailingNodeInSequence,r=!0===e.rangeSelect,a=t&&!0===e.groupSelectsFiltered;if(void 0===this.id)return console.warn("ag-Grid: cannot select node until id for node is known"),0;if(this.rowPinned)return console.log("ag-Grid: cannot select pinned rows"),0;if(this.footer)return this.sibling.setSelectedParams(e);if(r){var s=this.selectionController.getLastSelectedNode()!==this,l=this.gridOptionsWrapper.isRowSelectionMulti();if(s&&l)return this.doRowRangeSelection()}var c=0;if(a&&this.group||this.selectThisNode(i)&&c++,t&&this.group&&(c+=this.selectChildNodes(i,a)),!o){if(!i||!n&&this.gridOptionsWrapper.isRowSelectionMulti()||(c+=this.selectionController.clearOtherNodes(this)),0<c){a?this.calculatedSelectedForAllGroupNodes():t&&this.parent&&this.parent.calculateSelectedFromChildrenBubbleUp();var u={type:d.Events.EVENT_SELECTION_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.mainEventService.dispatchEvent(u)}i&&this.selectionController.setLastSelectedNode(this)}return c},y.prototype.doRowRangeSelection=function(){var t=0,i=this.gridOptionsWrapper.isGroupSelectsChildren(),e=this.selectionController.getLastSelectedNode();this.rowModel.getNodesInRangeForSelection(e,this).forEach(function(e){e.group&&i||e.selectThisNode(!0)&&t++}),i&&this.calculatedSelectedForAllGroupNodes();var n={type:d.Events.EVENT_SELECTION_CHANGED,api:this.gridApi,columnApi:this.columnApi};return this.mainEventService.dispatchEvent(n),t},y.prototype.isParentOfNode=function(e){for(var t=this.parent;t;){if(t===e)return!0;t=t.parent}return!1},y.prototype.calculatedSelectedForAllGroupNodes=function(){this.rowModel.getTopLevelNodes().forEach(function(e){e.group&&(e.depthFirstSearch(function(e){e.group&&e.calculateSelectedFromChildren()}),e.calculateSelectedFromChildren())})},y.prototype.selectThisNode=function(e){if(!this.selectable||this.selected===e)return!1;this.selected=e,this.eventService&&this.dispatchLocalEvent(this.createLocalRowEvent(y.EVENT_ROW_SELECTED));var t=this.createGlobalRowEvent(d.Events.EVENT_ROW_SELECTED);return this.mainEventService.dispatchEvent(t),!0},y.prototype.selectChildNodes=function(e,t){var i=t?this.childrenAfterFilter:this.childrenAfterGroup,n=0;if(!f.Utils.missing(i)){for(var o=0;o<i.length;o++)n+=i[o].setSelectedParams({newValue:e,clearSelection:!1,tailingNodeInSequence:!0,groupSelectsFiltered:t});return n}},y.prototype.addEventListener=function(e,t){this.eventService||(this.eventService=new r.EventService),this.eventService.addEventListener(e,t)},y.prototype.removeEventListener=function(e,t){this.eventService.removeEventListener(e,t)},y.prototype.onMouseEnter=function(){this.dispatchLocalEvent(this.createLocalRowEvent(y.EVENT_MOUSE_ENTER))},y.prototype.onMouseLeave=function(){this.dispatchLocalEvent(this.createLocalRowEvent(y.EVENT_MOUSE_LEAVE))},y.prototype.getFirstChildOfFirstChild=function(e){for(var t,i=this,n=!0,o=!1;n&&!o;){var r=i.parent;f.Utils.exists(r)&&i.firstChild?r.rowGroupColumn===e&&(o=!0,t=r):n=!1,i=r}return o?t:null},y.EVENT_ROW_SELECTED="rowSelected",y.EVENT_DATA_CHANGED="dataChanged",y.EVENT_CELL_CHANGED="cellChanged",y.EVENT_ALL_CHILDREN_COUNT_CHANGED="allChildrenCountChanged",y.EVENT_MOUSE_ENTER="mouseEnter",y.EVENT_MOUSE_LEAVE="mouseLeave",y.EVENT_HEIGHT_CHANGED="heightChanged",y.EVENT_TOP_CHANGED="topChanged",y.EVENT_FIRST_CHILD_CHANGED="firstChildChanged",y.EVENT_LAST_CHILD_CHANGED="lastChildChanged",y.EVENT_CHILD_INDEX_CHANGED="childIndexChanged",y.EVENT_ROW_INDEX_CHANGED="rowIndexChanged",y.EVENT_EXPANDED_CHANGED="expandedChanged",y.EVENT_SELECTABLE_CHANGED="selectableChanged",y.EVENT_UI_LEVEL_CHANGED="uiLevelChanged",y.EVENT_DRAGGING_CHANGED="draggingChanged",n([h.Autowired("eventService"),o("design:type",r.EventService)],y.prototype,"mainEventService",void 0),n([h.Autowired("gridOptionsWrapper"),o("design:type",a.GridOptionsWrapper)],y.prototype,"gridOptionsWrapper",void 0),n([h.Autowired("selectionController"),o("design:type",s.SelectionController)],y.prototype,"selectionController",void 0),n([h.Autowired("columnController"),o("design:type",c.ColumnController)],y.prototype,"columnController",void 0),n([h.Autowired("valueService"),o("design:type",l.ValueService)],y.prototype,"valueService",void 0),n([h.Autowired("rowModel"),o("design:type",Object)],y.prototype,"rowModel",void 0),n([h.Autowired("context"),o("design:type",h.Context)],y.prototype,"context",void 0),n([h.Autowired("valueCache"),o("design:type",g.ValueCache)],y.prototype,"valueCache",void 0),n([h.Autowired("columnApi"),o("design:type",u.ColumnApi)],y.prototype,"columnApi",void 0),n([h.Autowired("gridApi"),o("design:type",m.GridApi)],y.prototype,"gridApi",void 0),y);function y(){this.childrenMapped={},this.selectable=!0,this.selected=!1}t.RowNode=v},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(i,n){return function(e,t){n(e,t,i)}};Object.defineProperty(t,"__esModule",{value:!0});var a,s,l,c,u,d,h=i(12),p=i(0),f=i(1),g=i(2),m=i(40),v=i(4),y=i(41);(s=a=t.DragSourceType||(t.DragSourceType={}))[s.ToolPanel=0]="ToolPanel",s[s.HeaderCell=1]="HeaderCell",s[s.RowDrag=2]="RowDrag",(c=l=t.VDirection||(t.VDirection={}))[c.Up=0]="Up",c[c.Down=1]="Down",(d=u=t.HDirection||(t.HDirection={}))[d.Left=0]="Left",d[d.Right=1]="Right";var b,w=((b=C).prototype.init=function(){this.ePinnedIcon=f.Utils.createIcon("columnMovePin",this.gridOptionsWrapper,null),this.ePlusIcon=f.Utils.createIcon("columnMoveAdd",this.gridOptionsWrapper,null),this.eHiddenIcon=f.Utils.createIcon("columnMoveHide",this.gridOptionsWrapper,null),this.eMoveIcon=f.Utils.createIcon("columnMoveMove",this.gridOptionsWrapper,null),this.eLeftIcon=f.Utils.createIcon("columnMoveLeft",this.gridOptionsWrapper,null),this.eRightIcon=f.Utils.createIcon("columnMoveRight",this.gridOptionsWrapper,null),this.eGroupIcon=f.Utils.createIcon("columnMoveGroup",this.gridOptionsWrapper,null),this.eAggregateIcon=f.Utils.createIcon("columnMoveValue",this.gridOptionsWrapper,null),this.ePivotIcon=f.Utils.createIcon("columnMovePivot",this.gridOptionsWrapper,null),this.eDropNotAllowedIcon=f.Utils.createIcon("dropNotAllowed",this.gridOptionsWrapper,null)},C.prototype.setBeans=function(e){this.logger=e.create("OldToolPanelDragAndDropService")},C.prototype.getStringType=function(e){switch(e){case a.RowDrag:return"row";case a.HeaderCell:return"headerCell";case a.ToolPanel:return"toolPanel";default:return console.warn("ag-Grid: bug - unknown drag type "+e),null}},C.prototype.addDragSource=function(e,t){void 0===t&&(t=!1);var i={eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this)};this.dragSourceAndParamsList.push({params:i,dragSource:e}),this.dragService.addDragSource(i,t)},C.prototype.removeDragSource=function(t){var e=f.Utils.find(this.dragSourceAndParamsList,function(e){return e.dragSource===t});e&&(this.dragService.removeDragSource(e.params),f.Utils.removeFromArray(this.dragSourceAndParamsList,e))},C.prototype.destroy=function(){var t=this;this.dragSourceAndParamsList.forEach(function(e){t.dragService.removeDragSource(e.params)}),this.dragSourceAndParamsList.length=0},C.prototype.nudge=function(){this.dragging&&this.onDragging(this.eventLastTime,!0)},C.prototype.onDragStart=function(e,t){this.dragging=!0,this.dragSource=e,this.eventLastTime=t,this.dragItem=this.dragSource.dragItemCallback(),this.lastDropTarget=this.dragSource.dragSourceDropTarget,this.dragSource.dragStarted&&this.dragSource.dragStarted(),this.createGhost()},C.prototype.onDragStop=function(e){if(this.eventLastTime=null,this.dragging=!1,this.dragSource.dragStopped&&this.dragSource.dragStopped(),this.lastDropTarget&&this.lastDropTarget.onDragStop){var t=this.createDropTargetEvent(this.lastDropTarget,e,null,null,!1);this.lastDropTarget.onDragStop(t)}this.lastDropTarget=null,this.dragItem=null,this.removeGhost()},C.prototype.onDragging=function(e,t){var i=this.workOutHDirection(e),n=this.workOutVDirection(e);this.eventLastTime=e,this.positionGhost(e);var o=f.Utils.find(this.dropTargets,this.isMouseOnDropTarget.bind(this,e));if(o!==this.lastDropTarget)this.leaveLastTargetIfExists(e,i,n,t),this.enterDragTargetIfExists(o,e,i,n,t),this.lastDropTarget=o;else if(o){var r=this.createDropTargetEvent(o,e,i,n,t);o.onDragging(r)}},C.prototype.enterDragTargetIfExists=function(e,t,i,n,o){if(e){var r=this.createDropTargetEvent(e,t,i,n,o);e.onDragEnter(r),this.setGhostIcon(e.getIconName?e.getIconName():null)}},C.prototype.leaveLastTargetIfExists=function(e,t,i,n){if(this.lastDropTarget){var o=this.createDropTargetEvent(this.lastDropTarget,e,t,i,n);this.lastDropTarget.onDragLeave(o),this.setGhostIcon(null)}},C.prototype.getAllContainersFromDropTarget=function(e){var t=[e.getContainer()],i=e.getSecondaryContainers?e.getSecondaryContainers():null;return i&&(t=t.concat(i)),t},C.prototype.isMouseOnDropTarget=function(o,e){var t=this.getAllContainersFromDropTarget(e),r=!1;return t.forEach(function(e){if(e){var t=e.getBoundingClientRect();if(0!==t.width&&0!==t.height){var i=o.clientX>=t.left&&o.clientX<=t.right,n=o.clientY>=t.top&&o.clientY<=t.bottom;i&&n&&(r=!0)}}}),!!r&&e.isInterestedIn(this.dragSource.type)},C.prototype.addDropTarget=function(e){this.dropTargets.push(e)},C.prototype.workOutHDirection=function(e){return this.eventLastTime.clientX>e.clientX?u.Left:this.eventLastTime.clientX<e.clientX?u.Right:null},C.prototype.workOutVDirection=function(e){return this.eventLastTime.clientY>e.clientY?l.Up:this.eventLastTime.clientY<e.clientY?l.Down:null},C.prototype.createDropTargetEvent=function(e,t,i,n,o){var r=e.getContainer().getBoundingClientRect();return{event:t,x:t.clientX-r.left,y:t.clientY-r.top,vDirection:n,hDirection:i,dragSource:this.dragSource,fromNudge:o,dragItem:this.dragItem}},C.prototype.positionGhost=function(e){var t=this.eGhost.getBoundingClientRect().height,i=f.Utils.getBodyWidth()-2,n=f.Utils.getBodyHeight()-2,o=e.pageY-t/2,r=e.pageX-30,a=this.gridOptionsWrapper.getDocument(),s=window.pageYOffset||a.documentElement.scrollTop,l=window.pageXOffset||a.documentElement.scrollLeft;0<i&&r+this.eGhost.clientWidth>i+l&&(r=i+l-this.eGhost.clientWidth),r<0&&(r=0),0<n&&o+this.eGhost.clientHeight>n+s&&(o=n+s-this.eGhost.clientHeight),o<0&&(o=0),this.eGhost.style.left=r+"px",this.eGhost.style.top=o+"px"},C.prototype.removeGhost=function(){this.eGhost&&this.eGhostParent&&this.eGhostParent.removeChild(this.eGhost),this.eGhost=null},C.prototype.createGhost=function(){this.eGhost=f.Utils.loadTemplate(b.GHOST_TEMPLATE),f.Utils.addCssClass(this.eGhost,this.environment.getTheme()),this.eGhostIcon=this.eGhost.querySelector(".ag-dnd-ghost-icon"),this.setGhostIcon(null),this.eGhost.querySelector(".ag-dnd-ghost-label").innerHTML=this.dragSource.dragItemName,this.eGhost.style.height="25px",this.eGhost.style.top="20px",this.eGhost.style.left="20px";var e=this.gridOptionsWrapper.getDocument();this.eGhostParent=e.querySelector("body"),this.eGhostParent?this.eGhostParent.appendChild(this.eGhost):console.warn("ag-Grid: could not find document body, it is needed for dragging columns")},C.prototype.setGhostIcon=function(e,t){var i;switch(void 0===t&&(t=!1),f.Utils.removeAllChildren(this.eGhostIcon),e){case b.ICON_ADD:i=this.ePlusIcon;break;case b.ICON_PINNED:i=this.ePinnedIcon;break;case b.ICON_MOVE:i=this.eMoveIcon;break;case b.ICON_LEFT:i=this.eLeftIcon;break;case b.ICON_RIGHT:i=this.eRightIcon;break;case b.ICON_GROUP:i=this.eGroupIcon;break;case b.ICON_AGGREGATE:i=this.eAggregateIcon;break;case b.ICON_PIVOT:i=this.ePivotIcon;break;case b.ICON_NOT_ALLOWED:i=this.eDropNotAllowedIcon;break;default:i=this.eHiddenIcon}this.eGhostIcon.appendChild(i),f.Utils.addOrRemoveCssClass(this.eGhostIcon,"ag-shake-left-to-right",t)},C.ICON_PINNED="pinned",C.ICON_ADD="add",C.ICON_MOVE="move",C.ICON_LEFT="left",C.ICON_RIGHT="right",C.ICON_GROUP="group",C.ICON_AGGREGATE="aggregate",C.ICON_PIVOT="pivot",C.ICON_NOT_ALLOWED="notAllowed",C.GHOST_TEMPLATE='<div class="ag-dnd-ghost">  <span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>  <div class="ag-dnd-ghost-label">  </div></div>',n([p.Autowired("gridOptionsWrapper"),o("design:type",g.GridOptionsWrapper)],C.prototype,"gridOptionsWrapper",void 0),n([p.Autowired("dragService"),o("design:type",m.DragService)],C.prototype,"dragService",void 0),n([p.Autowired("environment"),o("design:type",y.Environment)],C.prototype,"environment",void 0),n([p.Autowired("columnController"),o("design:type",v.ColumnController)],C.prototype,"columnController",void 0),n([p.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],C.prototype,"init",null),n([r(0,p.Qualifier("loggerFactory")),o("design:type",Function),o("design:paramtypes",[h.LoggerFactory]),o("design:returntype",void 0)],C.prototype,"setBeans",null),n([p.PreDestroy,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],C.prototype,"destroy",null),C=b=n([p.Bean("dragAndDropService")],C));function C(){this.dragSourceAndParamsList=[],this.dropTargets=[]}t.DragAndDropService=w},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),a=i(19),s=i(4),l=i(0),h=i(1),p=i(5),c=i(3),u=i(33),d=(f.prototype.init=function(){this.cellExpressions=this.gridOptionsWrapper.isEnableCellExpressions(),this.initialised=!0},f.prototype.getValue=function(e,t,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),this.initialised||this.init();var o,r=e.getColDef(),a=r.field,s=e.getId(),l=t.data,c=t.groupData&&void 0!==t.groupData[s],u=!n&&t.aggData&&void 0!==t.aggData[s];if(o=i&&r.filterValueGetter?this.executeValueGetter(r.filterValueGetter,l,e,t):c?t.groupData[s]:u?t.aggData[s]:r.valueGetter?this.executeValueGetter(r.valueGetter,l,e,t):a&&l?h._.getValueUsingField(l,a,e.isFieldContainsDots()):void 0,this.cellExpressions&&"string"==typeof o&&0===o.indexOf("=")){var d=o.substring(1);o=this.executeValueGetter(d,l,e,t)}return o},f.prototype.setValue=function(e,t,i){var n=this.columnController.getPrimaryColumn(t);if(e&&n){var o=e.data;h._.missing(o)&&(e.data={});var r=n.getColDef(),a=r.field,s=r.newValueHandler,l=r.valueSetter;if(h._.missing(a)&&h._.missing(s)&&h._.missing(l))console.warn("ag-Grid: you need either field or valueSetter set on colDef for editing to work");else{var c,u={node:e,data:e.data,oldValue:this.getValue(n,e),newValue:i,colDef:n.getColDef(),column:n,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext()};if(u.newValue=i,void 0===(c=h._.exists(s)?s(u):h._.exists(l)?this.expressionService.evaluate(l,u):this.setValueUsingField(o,a,i,n.isFieldContainsDots()))&&(c=!0),c){e.resetQuickFilterAggregateText(),this.valueCache.onDataChanged(),u.newValue=this.getValue(n,e),"function"==typeof n.getColDef().onCellValueChanged&&setTimeout(function(){return n.getColDef().onCellValueChanged(u)},0);var d={type:p.Events.EVENT_CELL_VALUE_CHANGED,event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:u.column,api:u.api,colDef:u.colDef,columnApi:u.columnApi,context:u.context,data:e.data,node:e,oldValue:u.oldValue,newValue:u.newValue,value:u.newValue};this.eventService.dispatchEvent(d)}}}},f.prototype.setValueUsingField=function(e,t,i,n){if(n)for(var o=t.split("."),r=e;0<o.length&&r;){var a=o.shift();0===o.length?r[a]=i:r=r[a]}else e[t]=i;return!0},f.prototype.executeValueGetter=function(e,t,i,n){var o=i.getId(),r=this.valueCache.getValue(n,o);if(void 0!==r)return r;var a={data:t,node:n,column:i,colDef:i.getColDef(),api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext(),getValue:this.getValueCallback.bind(this,n)},s=this.expressionService.evaluate(e,a);return this.valueCache.setValue(n,o,s),s},f.prototype.getValueCallback=function(e,t){var i=this.columnController.getPrimaryColumn(t);return i?this.getValue(i,e):null},f.prototype.getKeyForNode=function(e,t){var i,n=this.getValue(e,t),o=e.getColDef().keyCreator;return"string"==typeof(i=o?o({value:n}):n)||null==i||"[object Object]"===(i=String(i))&&h._.doOnce(function(){console.warn("ag-Grid: a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se ag-Grid docs) or b) to toString() on the object to return a key")},"getKeyForNode - warn about [object,object]"),i},n([l.Autowired("gridOptionsWrapper"),o("design:type",r.GridOptionsWrapper)],f.prototype,"gridOptionsWrapper",void 0),n([l.Autowired("expressionService"),o("design:type",a.ExpressionService)],f.prototype,"expressionService",void 0),n([l.Autowired("columnController"),o("design:type",s.ColumnController)],f.prototype,"columnController",void 0),n([l.Autowired("eventService"),o("design:type",c.EventService)],f.prototype,"eventService",void 0),n([l.Autowired("valueCache"),o("design:type",u.ValueCache)],f.prototype,"valueCache",void 0),n([l.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],f.prototype,"init",null),f=n([l.Bean("valueService")],f));function f(){this.initialised=!1}t.ValueService=d},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(i,n){return function(e,t){n(e,t,i)}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),a=i(0),l=i(0),c=i(12),u=i(3),d=i(5),h=i(0),p=i(2),f=i(0),g=i(9),m=i(7),v=i(6),y=(b.prototype.setBeans=function(e){this.logger=e.create("SelectionController"),this.reset(),this.gridOptionsWrapper.isRowModelDefault()?this.eventService.addEventListener(d.Events.EVENT_ROW_DATA_CHANGED,this.reset.bind(this)):this.logger.log("dont know what to do here")},b.prototype.init=function(){this.groupSelectsChildren=this.gridOptionsWrapper.isGroupSelectsChildren(),this.eventService.addEventListener(d.Events.EVENT_ROW_SELECTED,this.onRowSelected.bind(this))},b.prototype.setLastSelectedNode=function(e){this.lastSelectedNode=e},b.prototype.getLastSelectedNode=function(){return this.lastSelectedNode},b.prototype.getSelectedNodes=function(){var i=[];return s.Utils.iterateObject(this.selectedNodes,function(e,t){t&&i.push(t)}),i},b.prototype.getSelectedRows=function(){var i=[];return s.Utils.iterateObject(this.selectedNodes,function(e,t){t&&t.data&&i.push(t.data)}),i},b.prototype.removeGroupsFromSelection=function(){var i=this;s.Utils.iterateObject(this.selectedNodes,function(e,t){t&&t.group&&(i.selectedNodes[t.id]=void 0)})},b.prototype.updateGroupsFromChildrenSelections=function(){this.rowModel.getType()!==g.Constants.ROW_MODEL_TYPE_CLIENT_SIDE&&console.warn("updateGroupsFromChildrenSelections not available when rowModel is not normal"),this.rowModel.getTopLevelNodes().forEach(function(e){e.depthFirstSearch(function(e){e.group&&e.calculateSelectedFromChildren()})})},b.prototype.getNodeForIdIfSelected=function(e){return this.selectedNodes[e]},b.prototype.clearOtherNodes=function(n){var o=this,r={},a=0;return s.Utils.iterateObject(this.selectedNodes,function(e,t){if(t&&t.id!==n.id){var i=o.selectedNodes[t.id];a+=i.setSelectedParams({newValue:!1,clearSelection:!1,tailingNodeInSequence:!0}),o.groupSelectsChildren&&t.parent&&(r[t.parent.id]=t.parent)}}),s.Utils.iterateObject(r,function(e,t){t.calculateSelectedFromChildren()}),a},b.prototype.onRowSelected=function(e){var t=e.node;this.groupSelectsChildren&&t.group||(t.isSelected()?this.selectedNodes[t.id]=t:this.selectedNodes[t.id]=void 0)},b.prototype.syncInRowNode=function(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)},b.prototype.syncInOldRowNode=function(e,t){s.Utils.exists(t)&&e.id!==t.id&&s.Utils.exists(this.selectedNodes[t.id])&&(this.selectedNodes[t.id]=t)},b.prototype.syncInNewRowNode=function(e){s.Utils.exists(this.selectedNodes[e.id])?(e.setSelectedInitialValue(!0),this.selectedNodes[e.id]=e):e.setSelectedInitialValue(!1)},b.prototype.reset=function(){this.logger.log("reset"),this.selectedNodes={},this.lastSelectedNode=null},b.prototype.getBestCostNodeSelection=function(){this.rowModel.getType()!==g.Constants.ROW_MODEL_TYPE_CLIENT_SIDE&&console.warn("getBestCostNodeSelection is only avilable when using normal row model");var e=this.rowModel.getTopLevelNodes();if(null!==e){var r=[];return function e(t){for(var i=0,n=t.length;i<n;i++){var o=t[i];o.isSelected()?r.push(o):o.group&&o.children&&e(o.children)}}(e),r}console.warn("selectAll not available doing rowModel=virtual")},b.prototype.setRowModel=function(e){this.rowModel=e},b.prototype.isEmpty=function(){var i=0;return s.Utils.iterateObject(this.selectedNodes,function(e,t){t&&i++}),0===i},b.prototype.deselectAllRowNodes=function(e){function i(e){return e.selectThisNode(!1)}void 0===e&&(e=!1);var t=this.rowModel.getType()===g.Constants.ROW_MODEL_TYPE_CLIENT_SIDE;if(e){if(!t)return void console.error("ag-Grid: selecting just filtered only works with In Memory Row Model");this.rowModel.forEachNodeAfterFilter(i)}else s.Utils.iterateObject(this.selectedNodes,function(e,t){t&&i(t)}),this.reset();t&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections();var n={type:d.Events.EVENT_SELECTION_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(n)},b.prototype.selectAllRowNodes=function(e){if(void 0===e&&(e=!1),this.rowModel.getType()!==g.Constants.ROW_MODEL_TYPE_CLIENT_SIDE)throw"selectAll only available with normal row model, ie not "+this.rowModel.getType();function t(e){return e.selectThisNode(!0)}var i=this.rowModel;e?i.forEachNodeAfterFilter(t):i.forEachNode(t),this.rowModel.getType()===g.Constants.ROW_MODEL_TYPE_CLIENT_SIDE&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections();var n={type:d.Events.EVENT_SELECTION_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(n)},b.prototype.selectNode=function(e,t){e.setSelectedParams({newValue:!0,clearSelection:!t})},b.prototype.deselectIndex=function(e){var t=this.rowModel.getRow(e);this.deselectNode(t)},b.prototype.deselectNode=function(e){e.setSelectedParams({newValue:!1,clearSelection:!1})},b.prototype.selectIndex=function(e,t){var i=this.rowModel.getRow(e);this.selectNode(i,t)},n([h.Autowired("eventService"),o("design:type",u.EventService)],b.prototype,"eventService",void 0),n([h.Autowired("rowModel"),o("design:type",Object)],b.prototype,"rowModel",void 0),n([h.Autowired("gridOptionsWrapper"),o("design:type",p.GridOptionsWrapper)],b.prototype,"gridOptionsWrapper",void 0),n([h.Autowired("columnApi"),o("design:type",m.ColumnApi)],b.prototype,"columnApi",void 0),n([h.Autowired("gridApi"),o("design:type",v.GridApi)],b.prototype,"gridApi",void 0),n([r(0,l.Qualifier("loggerFactory")),o("design:type",Function),o("design:paramtypes",[c.LoggerFactory]),o("design:returntype",void 0)],b.prototype,"setBeans",null),n([f.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],b.prototype,"init",null),b=n([a.Bean("selectionController")],b));function b(){}t.SelectionController=y},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r,l=i(1),a=i(2),s=i(35),c=i(16),u=i(4),d=i(7),h=i(0),p=i(3),f=i(5),g=i(6),m=i(27),v=((r=y).prototype.init=function(){this.eventService.addEventListener(f.Events.EVENT_ROW_DATA_CHANGED,this.onNewRowsLoaded.bind(this)),this.eventService.addEventListener(f.Events.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.quickFilter=this.parseQuickFilter(this.gridOptionsWrapper.getQuickFilterText()),this.setQuickFilterParts(),this.checkExternalFilter()},y.prototype.setQuickFilterParts=function(){this.quickFilter?this.quickFilterParts=this.quickFilter.split(" "):this.quickFilterParts=null},y.prototype.setFilterModel=function(n){var o=this,r=[];if(n){var a=Object.keys(n);l.Utils.iterateObject(this.allFilters,function(e,t){l.Utils.removeFromArray(a,e);var i=n[e];o.setModelOnFilterWrapper(t.filterPromise,i),r.push(t.filterPromise)}),l.Utils.iterateArray(a,function(e){var t=o.columnController.getPrimaryColumn(e);if(t){var i=o.getOrCreateFilterWrapper(t);o.setModelOnFilterWrapper(i.filterPromise,n[e]),r.push(i.filterPromise)}else console.warn("Warning ag-grid setFilterModel - no column found for colId "+e)})}else l.Utils.iterateObject(this.allFilters,function(e,t){o.setModelOnFilterWrapper(t.filterPromise,null),r.push(t.filterPromise)});l.Promise.all(r).then(function(e){o.onFilterChanged()})},y.prototype.setModelOnFilterWrapper=function(e,t){e.then(function(e){"function"==typeof e.setModel?e.setModel(t):console.warn("Warning ag-grid - filter missing setModel method, which is needed for setFilterModel")})},y.prototype.getFilterModel=function(){var o={};return l.Utils.iterateObject(this.allFilters,function(e,t){var i=t.filterPromise.resolveNow(null,function(e){return e});if(null==i)return null;if("function"==typeof i.getModel){var n=i.getModel();l.Utils.exists(n)&&(o[e]=n)}else console.warn("Warning ag-grid - filter API missing getModel method, which is needed for getFilterModel")}),o},y.prototype.isAdvancedFilterPresent=function(){return this.advancedFilterPresent},y.prototype.setAdvancedFilterPresent=function(){var i=!1;l.Utils.iterateObject(this.allFilters,function(e,t){t.filterPromise.resolveNow(!1,function(e){return e.isFilterActive()})&&(i=!0)}),this.advancedFilterPresent=i},y.prototype.updateFilterFlagInColumns=function(n){l.Utils.iterateObject(this.allFilters,function(e,t){var i=t.filterPromise.resolveNow(!1,function(e){return e.isFilterActive()});t.column.setFilterActive(i,n)})},y.prototype.isAnyFilterPresent=function(){return this.isQuickFilterPresent()||this.advancedFilterPresent||this.externalFilterPresent},y.prototype.doesFilterPass=function(e,t){for(var i=e.data,n=Object.keys(this.allFilters),o=0,r=n.length;o<r;o++){var a=n[o],s=this.allFilters[a];if(void 0!==s){var l=s.filterPromise.resolveNow(void 0,function(e){return e});if(void 0!==l&&l!==t&&l.isFilterActive()){l.doesFilterPass||console.error("Filter is missing method doesFilterPass");var c={node:e,data:i};if(!l.doesFilterPass(c))return!1}}}return!0},y.prototype.parseQuickFilter=function(e){return l.Utils.missing(e)||""===e?null:this.gridOptionsWrapper.isRowModelInfinite()?(console.warn("ag-grid: cannot do quick filtering when doing virtual paging"),null):e.toUpperCase()},y.prototype.setQuickFilter=function(e){var t=this.parseQuickFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setQuickFilterParts(),this.onFilterChanged())},y.prototype.checkExternalFilter=function(){this.externalFilterPresent=this.gridOptionsWrapper.isExternalFilterPresent()},y.prototype.onFilterChanged=function(){this.setAdvancedFilterPresent(),this.updateFilterFlagInColumns("filterChanged"),this.checkExternalFilter(),l.Utils.iterateObject(this.allFilters,function(e,t){t.filterPromise.then(function(e){e.onAnyFilterChanged&&e.onAnyFilterChanged()})});var e={type:f.Events.EVENT_FILTER_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(e)},y.prototype.isQuickFilterPresent=function(){return null!==this.quickFilter},y.prototype.doesRowPassOtherFilters=function(e,t){return this.doesRowPassFilter(t,e)},y.prototype.doesRowPassQuickFilterNoCache=function(i,n){var o=this,e=this.columnController.getAllColumnsForQuickFilter(),r=!1;return e.forEach(function(e){if(!r){var t=o.getQuickFilterTextForColumn(e,i);l.Utils.exists(t)&&0<=t.indexOf(n)&&(r=!0)}}),r},y.prototype.doesRowPassQuickFilterCache=function(e,t){return e.quickFilterAggregateText||this.aggregateRowForQuickFilter(e),0<=e.quickFilterAggregateText.indexOf(t)},y.prototype.doesRowPassQuickFilter=function(t){var i=this,n=!0,o=this.gridOptionsWrapper.isCacheQuickFilter();return this.quickFilterParts.forEach(function(e){(o?i.doesRowPassQuickFilterCache(t,e):i.doesRowPassQuickFilterNoCache(t,e))||(n=!1)}),n},y.prototype.doesRowPassFilter=function(e,t){return!(this.isQuickFilterPresent()&&!this.doesRowPassQuickFilter(e)||this.externalFilterPresent&&!this.gridOptionsWrapper.doesExternalFilterPass(e)||this.advancedFilterPresent&&!this.doesFilterPass(e,t))},y.prototype.getQuickFilterTextForColumn=function(e,t){var i,n=this.valueService.getValue(e,t,!0),o=e.getColDef();if(e.getColDef().getQuickFilterText){var r={value:n,node:t,data:t.data,column:e,colDef:o};i=e.getColDef().getQuickFilterText(r)}else i=n;return i&&""!==i?i.toString().toUpperCase():null},y.prototype.aggregateRowForQuickFilter=function(i){var n=this,o=[];this.columnController.getAllColumnsForQuickFilter().forEach(function(e){var t=n.getQuickFilterTextForColumn(e,i);l.Utils.exists(t)&&o.push(t)}),i.quickFilterAggregateText=o.join(r.QUICK_FILTER_SEPARATOR)},y.prototype.onNewRowsLoaded=function(e){l.Utils.iterateObject(this.allFilters,function(e,t){t.filterPromise.then(function(e){e.onNewRowsLoaded&&e.onNewRowsLoaded()})}),this.updateFilterFlagInColumns(e),this.setAdvancedFilterPresent()},y.prototype.createValueGetter=function(t){var i=this;return function(e){return i.valueService.getValue(t,e,!0)}},y.prototype.getFilterComponent=function(e){return this.getOrCreateFilterWrapper(e).filterPromise},y.prototype.getOrCreateFilterWrapper=function(e){var t=this.cachedFilter(e);return t||(t=this.createFilterWrapper(e),this.allFilters[e.getColId()]=t),t},y.prototype.cachedFilter=function(e){return this.allFilters[e.getColId()]},y.prototype.createFilterInstance=function(e,t){var i=this,n="agTextColumnFilter";this.gridOptionsWrapper.isEnterprise()&&(n="agSetColumnFilter");var o=l.Utils.cloneObject(e.getColDef()),r={type:f.Events.EVENT_FILTER_MODIFIED,api:this.gridApi,columnApi:this.columnApi},a=this.onFilterChanged.bind(this),s={column:e,colDef:o,rowModel:this.rowModel,filterChangedCallback:a,filterModifiedCallback:function(){return i.eventService.dispatchEvent(r)},valueGetter:this.createValueGetter(e),context:this.gridOptionsWrapper.getContext(),doesRowPassOtherFilter:null,$scope:t};return this.componentResolver.createAgGridComponent(o,s,"filter",{api:this.gridApi,columnApi:this.columnApi,column:e,colDef:o},n,!0,function(e,t){return l.Utils.assign(e,{doesRowPassOtherFilter:i.doesRowPassOtherFilters.bind(i,t)})})},y.prototype.createFilterWrapper=function(e){var t={column:e,filterPromise:null,scope:null,compiledElement:null,guiPromise:l.Promise.external()};return t.scope=this.gridOptionsWrapper.isAngularCompileFilters()?this.$scope.$new():null,t.filterPromise=this.createFilterInstance(e,t.scope),this.putIntoGui(t),t},y.prototype.putIntoGui=function(n){var o=this,r=document.createElement("div");r.className="ag-filter",n.filterPromise.then(function(e){var t=e.getGui();if(l.Utils.missing(t)&&console.warn("getGui method from filter returned "+t+", it should be a DOM element or an HTML template string."),"string"==typeof t&&(t=l.Utils.loadTemplate(t)),r.appendChild(t),n.scope){var i=o.$compile(r)(n.scope);n.compiledElement=i,setTimeout(function(){return n.scope.$apply()},0)}n.guiPromise.resolve(r)})},y.prototype.onNewColumnsLoaded=function(){this.destroy()},y.prototype.destroyFilter=function(e,t){void 0===t&&(t="api");var i=this.allFilters[e.getColId()];i&&(this.disposeFilterWrapper(i,t),this.onFilterChanged())},y.prototype.disposeFilterWrapper=function(t,i){var n=this;t.filterPromise.then(function(e){e.setModel(null),e.destroy&&e.destroy(),t.column.setFilterActive(!1,i),t.scope&&(t.compiledElement&&t.compiledElement.remove(),t.scope.$destroy()),delete n.allFilters[t.column.getColId()]})},y.prototype.destroy=function(){var i=this;l.Utils.iterateObject(this.allFilters,function(e,t){i.disposeFilterWrapper(t,"filterDestroyed")})},y.QUICK_FILTER_SEPARATOR="\n",n([h.Autowired("$compile"),o("design:type",Object)],y.prototype,"$compile",void 0),n([h.Autowired("$scope"),o("design:type",Object)],y.prototype,"$scope",void 0),n([h.Autowired("gridOptionsWrapper"),o("design:type",a.GridOptionsWrapper)],y.prototype,"gridOptionsWrapper",void 0),n([h.Autowired("gridCore"),o("design:type",Object)],y.prototype,"gridCore",void 0),n([h.Autowired("popupService"),o("design:type",s.PopupService)],y.prototype,"popupService",void 0),n([h.Autowired("valueService"),o("design:type",c.ValueService)],y.prototype,"valueService",void 0),n([h.Autowired("columnController"),o("design:type",u.ColumnController)],y.prototype,"columnController",void 0),n([h.Autowired("rowModel"),o("design:type",Object)],y.prototype,"rowModel",void 0),n([h.Autowired("eventService"),o("design:type",p.EventService)],y.prototype,"eventService",void 0),n([h.Autowired("enterprise"),o("design:type",Boolean)],y.prototype,"enterprise",void 0),n([h.Autowired("context"),o("design:type",h.Context)],y.prototype,"context",void 0),n([h.Autowired("columnApi"),o("design:type",d.ColumnApi)],y.prototype,"columnApi",void 0),n([h.Autowired("gridApi"),o("design:type",g.GridApi)],y.prototype,"gridApi",void 0),n([h.Autowired("componentResolver"),o("design:type",m.ComponentResolver)],y.prototype,"componentResolver",void 0),n([h.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],y.prototype,"init",null),n([h.PreDestroy,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],y.prototype,"destroy",null),y=r=n([h.Bean("filterManager")],y));function y(){this.allFilters={},this.quickFilter=null,this.quickFilterParts=null}t.FilterManager=v},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(i,n){return function(e,t){n(e,t,i)}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(12),s=i(0),l=i(0),c=(u.prototype.setBeans=function(e){this.logger=e.create("ExpressionService")},u.prototype.evaluate=function(e,t){if("function"==typeof e)return e(t);if("string"==typeof e){var i=e;return this.evaluateExpression(i,t)}console.error("ag-Grid: value should be either a string or a function",e)},u.prototype.evaluateExpression=function(t,e){try{return this.createExpressionFunction(t)(e.value,e.context,e.oldValue,e.newValue,e.value,e.node,e.data,e.colDef,e.rowIndex,e.api,e.columnApi,e.getValue,e.column,e.columnGroup)}catch(e){return console.log("Processing of the expression failed"),console.log("Expression = "+t),console.log("Exception = "+e),null}},u.prototype.createExpressionFunction=function(e){if(this.expressionToFunctionCache[e])return this.expressionToFunctionCache[e];var t=this.createFunctionBody(e),i=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, columnApi, getValue, column, columnGroup",t);return this.expressionToFunctionCache[e]=i},u.prototype.createFunctionBody=function(e){return 0<=e.indexOf("return")?e:"return "+e+";"},n([r(0,l.Qualifier("loggerFactory")),o("design:type",Function),o("design:paramtypes",[a.LoggerFactory]),o("design:returntype",void 0)],u.prototype,"setBeans",null),u=n([s.Bean("expressionService")],u));function u(){this.expressionToFunctionCache={}}t.ExpressionService=c},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=this&&this.__param||function(i,n){return function(e,t){n(e,t,i)}};Object.defineProperty(t,"__esModule",{value:!0});var l,c=i(1),u=i(2),d=i(19),h=i(49),p=i(16),f=i(3),g=i(50),m=i(5),v=i(9),y=i(34),b=i(0),w=i(42),C=i(7),_=i(4),A=i(12),E=i(22),x=i(82),S=i(23),T=i(13),D=i(29),k=i(6),R=i(30),O=i(28),N=i(37),F=i(57),M=(l=T.BeanStub,o(P,l),P.prototype.agWire=function(e){this.logger=e.create("RowRenderer")},P.prototype.registerGridComp=function(e){this.gridPanel=e,this.rowContainers=this.gridPanel.getRowContainers(),this.addDestroyableEventListener(this.eventService,m.Events.EVENT_PAGINATION_CHANGED,this.onPageLoaded.bind(this)),this.addDestroyableEventListener(this.eventService,m.Events.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addDestroyableEventListener(this.eventService,m.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addDestroyableEventListener(this.eventService,m.Events.EVENT_BODY_SCROLL,this.redrawAfterScroll.bind(this)),this.addDestroyableEventListener(this.eventService,m.Events.EVENT_BODY_HEIGHT_CHANGED,this.redrawAfterScroll.bind(this)),this.redrawAfterModelUpdate()},P.prototype.onPageLoaded=function(e){c.Utils.missing(e)&&(e={type:m.Events.EVENT_MODEL_UPDATED,api:this.gridApi,columnApi:this.columnApi,animate:!1,keepRenderedRows:!1,newData:!1,newPage:!1}),this.onModelUpdated(e)},P.prototype.getAllCellsForColumn=function(n){var o=[];function e(e,t){var i=t.getCellForCol(n);i&&o.push(i)}return c.Utils.iterateObject(this.rowCompsByIndex,e),c.Utils.iterateObject(this.floatingBottomRowComps,e),c.Utils.iterateObject(this.floatingTopRowComps,e),o},P.prototype.refreshFloatingRowComps=function(){this.refreshFloatingRows(this.floatingTopRowComps,this.pinnedRowModel.getPinnedTopRowData(),this.rowContainers.floatingTopPinnedLeft,this.rowContainers.floatingTopPinnedRight,this.rowContainers.floatingTop,this.rowContainers.floatingTopFullWidth),this.refreshFloatingRows(this.floatingBottomRowComps,this.pinnedRowModel.getPinnedBottomRowData(),this.rowContainers.floatingBottomPinnedLeft,this.rowContainers.floatingBottomPinnedRight,this.rowContainers.floatingBottom,this.rowContainers.floatingBottomFullWith)},P.prototype.refreshFloatingRows=function(i,e,n,o,r,a){var s=this;i.forEach(function(e){e.destroy()}),i.length=0,e&&e.forEach(function(e){var t=new g.RowComp(s.$scope,r,n,o,a,e,s.beans,!1,!1);t.init(),i.push(t)}),this.flushContainers(i)},P.prototype.onPinnedRowDataChanged=function(){this.redrawAfterModelUpdate()},P.prototype.onModelUpdated=function(e){var t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)},P.prototype.getRenderedIndexesForRowNodes=function(n){var o=[];return c.Utils.missing(n)||c.Utils.iterateObject(this.rowCompsByIndex,function(e,t){var i=t.getRowNode();0<=n.indexOf(i)&&o.push(e)}),o},P.prototype.redrawRows=function(e){if(e&&0!=e.length){var t=this.getRenderedIndexesForRowNodes(e);this.removeRowComps(t),this.redrawAfterModelUpdate({recycleRows:!0})}},P.prototype.getCellToRestoreFocusToAfterRefresh=function(e){var t=e.suppressKeepFocus?null:this.focusedCellController.getFocusCellToUseAfterRefresh();if(c.Utils.missing(t))return null;var i=document.activeElement,n=this.gridOptionsWrapper.getDomData(i,y.CellComp.DOM_DATA_KEY_CELL_COMP);return c.Utils.missing(n)?null:t},P.prototype.redrawAfterModelUpdate=function(e){void 0===e&&(e={}),this.getLockOnRefresh();var t=this.getCellToRestoreFocusToAfterRefresh(e);this.sizeContainerToPageHeight(),this.scrollToTopIfNewData(e);var i=e.recycleRows,n=e.animate&&this.gridOptionsWrapper.isAnimateRows(),o=this.binRowComps(i);this.redraw(o,n),e.onlyBody||this.refreshFloatingRowComps(),this.restoreFocusedCell(t),this.releaseLockOnRefresh()},P.prototype.scrollToTopIfNewData=function(e){var t=e.newData||e.newPage,i=this.gridOptionsWrapper.isSuppressScrollOnNewData();t&&!i&&this.gridPanel.scrollToTop()},P.prototype.sizeContainerToPageHeight=function(){var e=this.paginationProxy.getCurrentPageHeight();0===e&&(e=1),this.heightScaler.setModelHeight(e);var t=this.heightScaler.getUiContainerHeight();this.rowContainers.body.setHeight(t),this.rowContainers.fullWidth.setHeight(t),this.rowContainers.pinnedLeft.setHeight(t),this.rowContainers.pinnedRight.setHeight(t)},P.prototype.getLockOnRefresh=function(){if(this.refreshInProgress)throw new Error("ag-Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, eg instead of api.refreshView(), call setTimeout(function(){api.refreshView(),0}). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0},P.prototype.releaseLockOnRefresh=function(){this.refreshInProgress=!1},P.prototype.restoreFocusedCell=function(e){e&&this.focusedCellController.setFocusedCell(e.rowIndex,e.column,e.floating,!0)},P.prototype.stopEditing=function(i){void 0===i&&(i=!1),this.forEachRowComp(function(e,t){t.stopEditing(i)})},P.prototype.forEachCellComp=function(i){this.forEachRowComp(function(e,t){return t.forEachCellComp(i)})},P.prototype.forEachRowComp=function(e){c.Utils.iterateObject(this.rowCompsByIndex,e),c.Utils.iterateObject(this.floatingTopRowComps,e),c.Utils.iterateObject(this.floatingBottomRowComps,e)},P.prototype.addRenderedRowListener=function(e,t,i){var n=this.rowCompsByIndex[t];n&&n.addEventListener(e,i)},P.prototype.flashCells=function(e){void 0===e&&(e={}),this.forEachCellCompFiltered(e.rowNodes,e.columns,function(e){return e.flashCell()})},P.prototype.refreshCells=function(e){void 0===e&&(e={});var t={forceRefresh:e.force,newData:!1};this.forEachCellCompFiltered(e.rowNodes,e.columns,function(e){return e.refreshCell(t)})},P.prototype.getCellRendererInstances=function(e){var i=[];return this.forEachCellCompFiltered(e.rowNodes,e.columns,function(e){var t=e.getCellRenderer();t&&i.push(t)}),i},P.prototype.getCellEditorInstances=function(e){var i=[];return this.forEachCellCompFiltered(e.rowNodes,e.columns,function(e){var t=e.getCellEditor();t&&i.push(t)}),i},P.prototype.getEditingCells=function(){var i=[];return this.forEachCellComp(function(e){if(e.isEditing()){var t=e.getGridCell().getGridCellDef();i.push(t)}}),i},P.prototype.forEachCellCompFiltered=function(e,t,o){var r,a,i=this;function n(e){var t=e.getRowNode(),i=t.id,n=t.rowPinned;if(c.Utils.exists(r))if(n===v.Constants.PINNED_BOTTOM){if(!r.bottom[i])return}else if(n===v.Constants.PINNED_TOP){if(!r.top[i])return}else if(!r.normal[i])return;e.forEachCellComp(function(e){var t=e.getColumn().getId();a&&!a[t]||o(e)})}c.Utils.exists(e)&&(r={top:{},bottom:{},normal:{}},e.forEach(function(e){e.rowPinned===v.Constants.PINNED_TOP?r.top[e.id]=!0:e.rowPinned===v.Constants.PINNED_BOTTOM?r.bottom[e.id]=!0:r.normal[e.id]=!0})),c.Utils.exists(t)&&(a={},t.forEach(function(e){var t=i.columnController.getGridColumn(e);c.Utils.exists(t)&&(a[t.getId()]=!0)})),c.Utils.iterateObject(this.rowCompsByIndex,function(e,t){n(t)}),this.floatingTopRowComps&&this.floatingTopRowComps.forEach(n),this.floatingBottomRowComps&&this.floatingBottomRowComps.forEach(n)},P.prototype.destroy=function(){l.prototype.destroy.call(this);var e=Object.keys(this.rowCompsByIndex);this.removeRowComps(e)},P.prototype.binRowComps=function(e){var n,o=this,r={};return e?(n=[],c.Utils.iterateObject(this.rowCompsByIndex,function(e,t){var i=t.getRowNode();c.Utils.exists(i.id)?(r[i.id]=t,delete o.rowCompsByIndex[e]):n.push(e)})):n=Object.keys(this.rowCompsByIndex),this.removeRowComps(n),r},P.prototype.removeRowComps=function(e){var t=this;e.forEach(function(e){t.rowCompsByIndex[e].destroy(),delete t.rowCompsByIndex[e]})},P.prototype.redrawAfterScroll=function(){this.getLockOnRefresh(),this.redraw(null,!1,!0),this.releaseLockOnRefresh()},P.prototype.removeRowCompsNotToDraw=function(e){var t={};e.forEach(function(e){return t[e]=!0});var i=Object.keys(this.rowCompsByIndex),n=c.Utils.filter(i,function(e){return!t[e]});this.removeRowComps(n)},P.prototype.calculateIndexesToDraw=function(){var n=this,o=c.Utils.createArrayOfNumbers(this.firstRenderedRow,this.lastRenderedRow);return c.Utils.iterateObject(this.rowCompsByIndex,function(e,t){var i=Number(e);(i<n.firstRenderedRow||i>n.lastRenderedRow)&&n.keepRowBecauseEditing(t)&&o.push(i)}),o.sort(function(e,t){return e-t}),o},P.prototype.redraw=function(i,n,o){var r=this;void 0===n&&(n=!1),void 0===o&&(o=!1),this.heightScaler.update(),this.workOutFirstAndLastRowsToRender();var e=this.calculateIndexesToDraw();this.removeRowCompsNotToDraw(e);var a=[],s=[];e.forEach(function(e){var t=r.createOrUpdateRowComp(e,i,n,o);c.Utils.exists(t)&&(s.push(t),c.Utils.pushAll(a,t.getAndClearNextVMTurnFunctions()))}),this.flushContainers(s),c.Utils.executeNextVMTurn(a),o&&!this.gridOptionsWrapper.isSuppressAnimationFrame()?this.beans.taskQueue.addP2Task(this.destroyRowComps.bind(this,i,n)):this.destroyRowComps(i,n),this.checkAngularCompile()},P.prototype.flushContainers=function(e){c.Utils.iterateObject(this.rowContainers,function(e,t){t&&t.flushRowTemplates()}),e.forEach(function(e){return e.afterFlush()})},P.prototype.onDisplayedColumnsChanged=function(){var e=this.columnController.isPinningLeft(),t=this.columnController.isPinningRight();this.pinningLeft===e&&t===this.pinningRight||(this.pinningLeft=e,this.pinningRight=t,this.gridOptionsWrapper.isEmbedFullWidthRows()&&this.redrawFullWidthEmbeddedRows())},P.prototype.redrawFullWidthEmbeddedRows=function(){var n=[];c.Utils.iterateObject(this.rowCompsByIndex,function(e,t){if(t.isFullWidth()){var i=t.getRowNode().rowIndex;n.push(i.toString())}}),this.refreshFloatingRowComps(),this.removeRowComps(n),this.redrawAfterScroll()},P.prototype.createOrUpdateRowComp=function(e,t,i,n){var o,r=this.rowCompsByIndex[e];if(r||(o=this.paginationProxy.getRow(e),c.Utils.exists(o)&&c.Utils.exists(t)&&t[o.id]&&(r=t[o.id],t[o.id]=null)),r)r.ensureDomOrder();else{if(o=o||this.paginationProxy.getRow(e),!c.Utils.exists(o))return;r=this.createRowComp(o,i,n)}return this.rowCompsByIndex[e]=r},P.prototype.destroyRowComps=function(e,i){var n=[];c.Utils.iterateObject(e,function(e,t){t&&(t.destroy(i),c.Utils.pushAll(n,t.getAndClearDelayedDestroyFunctions()))}),c.Utils.executeInAWhile(n)},P.prototype.checkAngularCompile=function(){var e=this;this.gridOptionsWrapper.isAngularCompileRows()&&setTimeout(function(){e.$scope.$apply()},0)},P.prototype.workOutFirstAndLastRowsToRender=function(){var e,t;if(this.paginationProxy.isRowsToRender()){var i=this.paginationProxy.getPageFirstRow(),n=this.paginationProxy.getPageLastRow(),o=this.paginationProxy?this.paginationProxy.getPixelOffset():0,r=this.heightScaler.getOffset(),a=this.gridPanel.getVScrollPosition(),s=a.top+o+r,l=a.bottom+o+r,c=this.paginationProxy.getRowIndexAtPixel(s),u=this.paginationProxy.getRowIndexAtPixel(l),d=this.gridOptionsWrapper.getRowBuffer();(c-=d)<i&&(c=i),n<(u+=d)&&(u=n),e=c,t=u}else e=0,t=-1;var h=e!==this.firstRenderedRow,p=t!==this.lastRenderedRow;if(h||p){this.firstRenderedRow=e,this.lastRenderedRow=t;var f={type:m.Events.EVENT_VIEWPORT_CHANGED,firstRow:e,lastRow:t,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(f)}},P.prototype.getFirstVirtualRenderedRow=function(){return this.firstRenderedRow},P.prototype.getLastVirtualRenderedRow=function(){return this.lastRenderedRow},P.prototype.keepRowBecauseEditing=function(e){var t=e.getRowNode(),i=this.focusedCellController.isRowNodeFocused(t),n=e.isEditing();return!(!i&&!n||!this.paginationProxy.isRowPresent(t))},P.prototype.createRowComp=function(e,t,i){var n=i&&!this.gridOptionsWrapper.isSuppressAnimationFrame(),o=new g.RowComp(this.$scope,this.rowContainers.body,this.rowContainers.pinnedLeft,this.rowContainers.pinnedRight,this.rowContainers.fullWidth,e,this.beans,t,n);return o.init(),o},P.prototype.getRenderedNodes=function(){var t=this.rowCompsByIndex;return Object.keys(t).map(function(e){return t[e].getRowNode()})},P.prototype.navigateToNextCell=function(e,t,i,n){for(var o=i;(o=this.cellNavigationService.getNextCellToFocus(t,o),!c.Utils.missing(o))&&this.gridOptionsWrapper.isGroupUseEntireRow()&&this.paginationProxy.getRow(o.rowIndex).group;);if(n){var r=this.gridOptionsWrapper.getNavigateToNextCellFunc();if(c.Utils.exists(r)){var a=r({key:t,previousCellDef:i,nextCellDef:o?o.getGridCellDef():null,event:e});o=c.Utils.exists(a)?new S.GridCell(a):null}}if(o&&(this.ensureCellVisible(o),this.focusedCellController.setFocusedCell(o.rowIndex,o.column,o.floating,!0),this.rangeController)){var s=new S.GridCell({rowIndex:o.rowIndex,floating:o.floating,column:o.column});this.rangeController.setRangeToCell(s)}},P.prototype.ensureCellVisible=function(e){c.Utils.missing(e.floating)&&this.gridPanel.ensureIndexVisible(e.rowIndex),e.column.isPinned()||this.gridPanel.ensureColumnVisible(e.column),this.gridPanel.horizontallyScrollHeaderCenterAndFloatingCenter(),this.animationFrameService.flushAllFrames()},P.prototype.startEditingCell=function(e,t,i){var n=this.getComponentForCell(e);n&&n.startRowOrCellEdit(t,i)},P.prototype.getComponentForCell=function(e){var t;switch(e.floating){case v.Constants.PINNED_TOP:t=this.floatingTopRowComps[e.rowIndex];break;case v.Constants.PINNED_BOTTOM:t=this.floatingBottomRowComps[e.rowIndex];break;default:t=this.rowCompsByIndex[e.rowIndex]}return t?t.getRenderedCellForColumn(e.column):null},P.prototype.onTabKeyDown=function(e,t){var i=t.shiftKey;this.moveToCellAfter(e,i)&&t.preventDefault()},P.prototype.tabToNextCell=function(e){var t=this.focusedCellController.getFocusedCell();if(c.Utils.missing(t))return!1;var i=this.getComponentForCell(t);return!c.Utils.missing(i)&&this.moveToCellAfter(i,e)},P.prototype.moveToCellAfter=function(e,t){return e.isEditing()?this.gridOptionsWrapper.isFullRowEdit()?this.moveToNextEditingRow(e,t):this.moveToNextEditingCell(e,t):this.moveToNextCellNotEditing(e,t)},P.prototype.moveToNextEditingCell=function(e,t){var i=e.getGridCell();e.stopEditing();var n=this.findNextCellToFocusOn(i,t,!0),o=c.Utils.exists(n);return o&&(n.startEditingIfEnabled(null,null,!0),n.focusCell(!1)),o},P.prototype.moveToNextEditingRow=function(e,t){var i=e.getGridCell(),n=this.findNextCellToFocusOn(i,t,!0),o=c.Utils.exists(n);return o&&this.moveEditToNextCellOrRow(e,n),o},P.prototype.moveToNextCellNotEditing=function(e,t){var i=e.getGridCell(),n=this.findNextCellToFocusOn(i,t,!1),o=c.Utils.exists(n);return o&&n.focusCell(!0),o},P.prototype.moveEditToNextCellOrRow=function(e,t){var i=e.getGridCell(),n=t.getGridCell();if(i.rowIndex===n.rowIndex&&i.floating===n.floating)e.setFocusOutOnEditor(),t.setFocusInOnEditor();else{var o=e.getRenderedRow(),r=t.getRenderedRow();e.setFocusOutOnEditor(),o.stopEditing(),r.startRowEditing(),t.setFocusInOnEditor()}t.focusCell()},P.prototype.findNextCellToFocusOn=function(e,t,i){for(var n=e;;){n=this.cellNavigationService.getNextTabbedCell(n,t);var o=this.gridOptionsWrapper.getTabToNextCellFunc();if(c.Utils.exists(o)){var r=o({backwards:t,editing:i,previousCellDef:e.getGridCellDef(),nextCellDef:n?n.getGridCellDef():null});n=c.Utils.exists(r)?new S.GridCell(r):null}if(!n)return null;if(i){var a=this.paginationProxy.getRow(n.rowIndex);if(!n.column.isCellEditable(a))continue}c.Utils.missing(n.floating)&&this.gridPanel.ensureIndexVisible(n.rowIndex),n.column.isPinned()||this.gridPanel.ensureColumnVisible(n.column),this.gridPanel.horizontallyScrollHeaderCenterAndFloatingCenter(),this.animationFrameService.flushAllFrames();var s=this.getComponentForCell(n);if(!c.Utils.missing(s)&&!s.isSuppressNavigable()){if(this.rangeController){var l=new S.GridCell({rowIndex:n.rowIndex,floating:n.floating,column:n.column});this.rangeController.setRangeToCell(l)}return s}}},r([b.Autowired("paginationProxy"),a("design:type",D.PaginationProxy)],P.prototype,"paginationProxy",void 0),r([b.Autowired("columnController"),a("design:type",_.ColumnController)],P.prototype,"columnController",void 0),r([b.Autowired("gridOptionsWrapper"),a("design:type",u.GridOptionsWrapper)],P.prototype,"gridOptionsWrapper",void 0),r([b.Autowired("gridCore"),a("design:type",w.GridCore)],P.prototype,"gridCore",void 0),r([b.Autowired("$scope"),a("design:type",Object)],P.prototype,"$scope",void 0),r([b.Autowired("expressionService"),a("design:type",d.ExpressionService)],P.prototype,"expressionService",void 0),r([b.Autowired("templateService"),a("design:type",h.TemplateService)],P.prototype,"templateService",void 0),r([b.Autowired("valueService"),a("design:type",p.ValueService)],P.prototype,"valueService",void 0),r([b.Autowired("eventService"),a("design:type",f.EventService)],P.prototype,"eventService",void 0),r([b.Autowired("pinnedRowModel"),a("design:type",R.PinnedRowModel)],P.prototype,"pinnedRowModel",void 0),r([b.Autowired("context"),a("design:type",b.Context)],P.prototype,"context",void 0),r([b.Autowired("loggerFactory"),a("design:type",A.LoggerFactory)],P.prototype,"loggerFactory",void 0),r([b.Autowired("focusedCellController"),a("design:type",E.FocusedCellController)],P.prototype,"focusedCellController",void 0),r([b.Autowired("cellNavigationService"),a("design:type",x.CellNavigationService)],P.prototype,"cellNavigationService",void 0),r([b.Autowired("columnApi"),a("design:type",C.ColumnApi)],P.prototype,"columnApi",void 0),r([b.Autowired("gridApi"),a("design:type",k.GridApi)],P.prototype,"gridApi",void 0),r([b.Autowired("beans"),a("design:type",O.Beans)],P.prototype,"beans",void 0),r([b.Autowired("heightScaler"),a("design:type",F.HeightScaler)],P.prototype,"heightScaler",void 0),r([b.Autowired("animationFrameService"),a("design:type",N.AnimationFrameService)],P.prototype,"animationFrameService",void 0),r([b.Optional("rangeController"),a("design:type",Object)],P.prototype,"rangeController",void 0),r([s(0,b.Qualifier("loggerFactory")),a("design:type",Function),a("design:paramtypes",[A.LoggerFactory]),a("design:returntype",void 0)],P.prototype,"agWire",null),r([b.PreDestroy,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],P.prototype,"destroy",null),P=r([b.Bean("rowRenderer")],P));function P(){var e=null!==l&&l.apply(this,arguments)||this;return e.rowCompsByIndex={},e.floatingTopRowComps=[],e.floatingBottomRowComps=[],e.refreshInProgress=!1,e}t.RowRenderer=M},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r,a,s=i(0),u=i(91),l=i(2),d=i(122),c=i(18),h=i(27),p=i(1),f=i(124),g=i(6),m=i(7);(a=r=r||{})[a.AG_GRID=0]="AG_GRID",a[a.FRAMEWORK=1]="FRAMEWORK";var v,y=((v=b).prototype.newDateComponent=function(e){return this.componentResolver.createAgGridComponent(this.gridOptions,e,"dateComponent",{api:this.gridApi,columnApi:this.columnApi},"agDateInput")},b.prototype.newHeaderComponent=function(e){return this.componentResolver.createAgGridComponent(e.column.getColDef(),e,"headerComponent",{api:this.gridApi,columnApi:this.columnApi,column:e.column,colDef:e.column.getColDef()},"agColumnHeader")},b.prototype.newHeaderGroupComponent=function(e){return this.componentResolver.createAgGridComponent(e.columnGroup.getColGroupDef(),e,"headerGroupComponent",{api:this.gridApi,columnApi:this.columnApi},"agColumnGroupHeader")},b.prototype.newFloatingFilterWrapperComponent=function(e,t){var i,n=this,o=e.getColDef();if(o.suppressFilter)return this.newEmptyFloatingFilterWrapperComponent(e);o.filter?"string"==typeof o.filter&&-1<Object.keys(v.filterToFloatingFilterNames).indexOf(o.filter)&&(i=v.filterToFloatingFilterNames[o.filter]):i=this.gridOptionsWrapper.isEnterprise()?"agSetColumnFloatingFilter":"agTextColumnFloatingFilter";var r={column:e,colDef:o,api:this.gridApi,columnApi:this.columnApi},a=this.componentResolver.createAgGridComponent(o,t,"floatingFilterComponent",r,i,!1),s={column:e,floatingFilterComp:a,suppressFilterButton:this.componentResolver.mergeParams(o,"floatingFilterComponent",r,t).suppressFilterButton};if(!a){var l=this.getFilterComponentPrototype(o);if(l&&!l.component.prototype.getModelAsString)return this.newEmptyFloatingFilterWrapperComponent(e);var c=t.currentParentModel;t.currentParentModel=function(){return n.filterManager.getFilterComponent(e).resolveNow(null,function(e){return e.getModelAsString?e.getModelAsString(c()):null})},s.floatingFilterComp=p.Promise.resolve(this.componentResolver.createInternalAgGridComponent(u.ReadModelAsStringFloatingFilterComp,t))}return this.componentResolver.createInternalAgGridComponent(d.FloatingFilterWrapperComp,s)},b.prototype.newFullWidthGroupRowInnerCellRenderer=function(e){return this.componentResolver.createAgGridComponent(this.gridOptions,e,"groupRowInnerRenderer",e,null,!1)},b.prototype.newCellRenderer=function(e,t){return this.componentResolver.createAgGridComponent(e,t,"cellRenderer",t,null,!1)},b.prototype.newInnerCellRenderer=function(e,t){return this.componentResolver.createAgGridComponent(e,t,"innerRenderer",t,null)},b.prototype.newFullRowGroupRenderer=function(e){return this.componentResolver.createAgGridComponent(this.gridOptionsWrapper,e,"fullWidthCellRenderer",e,null)},b.prototype.newOverlayWrapperComponent=function(){return this.componentResolver.createInternalAgGridComponent(f.OverlayWrapperComponent,null)},b.prototype.newLoadingOverlayComponent=function(){return this.componentResolver.createAgGridComponent(this.gridOptions,null,"loadingOverlayComponent",{api:this.gridApi,columnApi:this.columnApi},"agLoadingOverlay")},b.prototype.newNoRowsOverlayComponent=function(){return this.componentResolver.createAgGridComponent(this.gridOptions,null,"noRowsOverlayComponent",{api:this.gridApi,columnApi:this.columnApi},"agNoRowsOverlay")},b.prototype.getFilterComponentPrototype=function(e){return this.componentResolver.getComponentToUse(e,"filter",{api:this.gridApi,columnApi:this.columnApi,colDef:e})},b.prototype.newEmptyFloatingFilterWrapperComponent=function(e){var t={column:e,floatingFilterComp:null};return this.componentResolver.createInternalAgGridComponent(d.EmptyFloatingFilterWrapperComp,t)},b.filterToFloatingFilterNames={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"},n([s.Autowired("componentResolver"),o("design:type",h.ComponentResolver)],b.prototype,"componentResolver",void 0),n([s.Autowired("gridOptions"),o("design:type",Object)],b.prototype,"gridOptions",void 0),n([s.Autowired("gridApi"),o("design:type",g.GridApi)],b.prototype,"gridApi",void 0),n([s.Autowired("columnApi"),o("design:type",m.ColumnApi)],b.prototype,"columnApi",void 0),n([s.Autowired("gridOptionsWrapper"),o("design:type",l.GridOptionsWrapper)],b.prototype,"gridOptionsWrapper",void 0),n([s.Autowired("filterManager"),o("design:type",c.FilterManager)],b.prototype,"filterManager",void 0),b=v=n([s.Bean("componentRecipes")],b));function b(){}t.ComponentRecipes=y},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(3),s=i(5),l=i(2),c=i(7),u=i(4),d=i(1),h=i(23),p=i(6),f=i(34),g=(m.prototype.init=function(){this.eventService.addEventListener(s.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.clearFocusedCell.bind(this)),this.eventService.addEventListener(s.Events.EVENT_COLUMN_EVERYTHING_CHANGED,this.clearFocusedCell.bind(this)),this.eventService.addEventListener(s.Events.EVENT_COLUMN_GROUP_OPENED,this.clearFocusedCell.bind(this)),this.eventService.addEventListener(s.Events.EVENT_COLUMN_MOVED,this.clearFocusedCell.bind(this)),this.eventService.addEventListener(s.Events.EVENT_COLUMN_PINNED,this.clearFocusedCell.bind(this)),this.eventService.addEventListener(s.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,this.clearFocusedCell.bind(this)),this.eventService.addEventListener(s.Events.EVENT_COLUMN_VISIBLE,this.clearFocusedCell.bind(this))},m.prototype.clearFocusedCell=function(){this.focusedCell=null,this.onCellFocused(!1)},m.prototype.getFocusedCell=function(){return this.focusedCell},m.prototype.getFocusCellToUseAfterRefresh=function(){return this.gridOptionsWrapper.isSuppressFocusAfterRefresh()?null:this.focusedCell&&this.getGridCellForDomElement(document.activeElement)?this.focusedCell:null},m.prototype.getGridCellForDomElement=function(e){for(var t=e;t;){var i=this.gridOptionsWrapper.getDomData(t,f.CellComp.DOM_DATA_KEY_CELL_COMP);if(i)return i.getGridCell();t=t.parentNode}return null},m.prototype.setFocusedCell=function(e,t,i,n){void 0===n&&(n=!1);var o=d.Utils.makeNull(this.columnController.getGridColumn(t));this.focusedCell=new h.GridCell({rowIndex:e,floating:d.Utils.makeNull(i),column:o}),this.onCellFocused(n)},m.prototype.isCellFocused=function(e){return!d.Utils.missing(this.focusedCell)&&this.focusedCell.column===e.column&&this.isRowFocused(e.rowIndex,e.floating)},m.prototype.isRowNodeFocused=function(e){return this.isRowFocused(e.rowIndex,e.rowPinned)},m.prototype.isAnyCellFocused=function(){return!!this.focusedCell},m.prototype.isRowFocused=function(e,t){if(d.Utils.missing(this.focusedCell))return!1;var i=d.Utils.makeNull(t);return this.focusedCell.rowIndex===e&&this.focusedCell.floating===i},m.prototype.onCellFocused=function(e){var t={type:s.Events.EVENT_CELL_FOCUSED,forceBrowserFocus:e,rowIndex:null,column:null,floating:null,api:this.gridApi,columnApi:this.columnApi,rowPinned:null};this.focusedCell&&(t.rowIndex=this.focusedCell.rowIndex,t.column=this.focusedCell.column,t.rowPinned=this.focusedCell.floating),this.eventService.dispatchEvent(t)},n([r.Autowired("eventService"),o("design:type",a.EventService)],m.prototype,"eventService",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",l.GridOptionsWrapper)],m.prototype,"gridOptionsWrapper",void 0),n([r.Autowired("columnController"),o("design:type",u.ColumnController)],m.prototype,"columnController",void 0),n([r.Autowired("columnApi"),o("design:type",c.ColumnApi)],m.prototype,"columnApi",void 0),n([r.Autowired("gridApi"),o("design:type",p.GridApi)],m.prototype,"gridApi",void 0),n([r.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],m.prototype,"init",null),m=n([r.Bean("focusedCellController")],m));function m(){}t.FocusedCellController=g},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),o=i(64),r=(a.prototype.getGridCellDef=function(){return{rowIndex:this.rowIndex,column:this.column,floating:this.floating}},a.prototype.getGridRow=function(){return new o.GridRow(this.rowIndex,this.floating)},a.prototype.toString=function(){return"rowIndex = "+this.rowIndex+", floating = "+this.floating+", column = "+(this.column?this.column.getId():null)},a.prototype.createId=function(){return this.rowIndex+"."+this.floating+"."+this.column.getId()},a.prototype.equals=function(e){var t=this.column===e.column,i=this.floating===e.floating,n=this.rowIndex===e.rowIndex;return t&&i&&n},a);function a(e){this.rowIndex=e.rowIndex,this.column=e.column,this.floating=n.Utils.makeNull(e.floating)}t.GridCell=r},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var a,r=i(10),s=i(0),l=i(2),c=i(7),u=i(4),d=i(3),h=i(5),p=i(0),f=i(1),g=i(6),m=((a=v).prototype.progressSort=function(e,t,i){void 0===i&&(i="api");var n=this.getNextSortDirection(e);this.setSortForColumn(e,n,t,i)},v.prototype.setSortForColumn=function(e,t,i,n){if(void 0===n&&(n="api"),t!==r.Column.SORT_ASC&&t!==r.Column.SORT_DESC&&(t=null),e.setSort(t,n),e.getSort()){var o=Number((new Date).valueOf());e.setSortedAt(o)}else e.setSortedAt(null);i&&!this.gridOptionsWrapper.isSuppressMultiSort()||this.clearSortBarThisColumn(e,n),this.dispatchSortChangedEvents()},v.prototype.onSortChanged=function(){this.dispatchSortChangedEvents()},v.prototype.dispatchSortChangedEvents=function(){var e={type:h.Events.EVENT_SORT_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(e)},v.prototype.clearSortBarThisColumn=function(t,i){this.columnController.getPrimaryAndSecondaryAndAutoColumns().forEach(function(e){e!==t&&e.setSort(null,i)})},v.prototype.getNextSortDirection=function(e){var t;if(t=e.getColDef().sortingOrder?e.getColDef().sortingOrder:this.gridOptionsWrapper.getSortingOrder()?this.gridOptionsWrapper.getSortingOrder():a.DEFAULT_SORTING_ORDER,Array.isArray(t)&&!(t.length<=0)){var i,n=t.indexOf(e.getSort()),o=n<0,r=n==t.length-1;return i=o||r?t[0]:t[n+1],a.DEFAULT_SORTING_ORDER.indexOf(i)<0?(console.warn("ag-grid: invalid sort type "+i),null):i}console.warn("ag-grid: sortingOrder must be an array with at least one element, currently it's "+t)},v.prototype.getSortModel=function(){var e=this.getColumnsWithSortingOrdered();return f.Utils.map(e,function(e){return{colId:e.getColId(),sort:e.getSort()}})},v.prototype.setSortModel=function(r,a){var s=this;if(void 0===a&&(a="api"),this.gridOptionsWrapper.isEnableSorting()){var l=r&&0<r.length;this.columnController.getPrimaryAndSecondaryAndAutoColumns().forEach(function(e){var t=null,i=-1;if(l&&!e.getColDef().suppressSorting)for(var n=0;n<r.length;n++){var o=r[n];"string"==typeof o.colId&&"string"==typeof e.getColId()&&s.compareColIds(o,e)&&(t=o.sort,i=n)}t?(e.setSort(t,a),e.setSortedAt(i)):(e.setSort(null,a),e.setSortedAt(null))}),this.dispatchSortChangedEvents()}else console.warn("ag-grid: You are setting the sort model on a grid that does not have sorting enabled")},v.prototype.compareColIds=function(e,t){return e.colId===t.getColId()},v.prototype.getColumnsWithSortingOrdered=function(){var e=this.columnController.getPrimaryAndSecondaryAndAutoColumns(),t=f.Utils.filter(e,function(e){return!!e.getSort()});return t.sort(function(e,t){return e.sortedAt-t.sortedAt}),t},v.prototype.getSortForRowController=function(){var e=this.getColumnsWithSortingOrdered();return f.Utils.map(e,function(e){return{inverter:e.getSort()===r.Column.SORT_ASC?1:-1,column:e}})},v.DEFAULT_SORTING_ORDER=[r.Column.SORT_ASC,r.Column.SORT_DESC,null],n([s.Autowired("gridOptionsWrapper"),o("design:type",l.GridOptionsWrapper)],v.prototype,"gridOptionsWrapper",void 0),n([s.Autowired("columnController"),o("design:type",u.ColumnController)],v.prototype,"columnController",void 0),n([s.Autowired("eventService"),o("design:type",d.EventService)],v.prototype,"eventService",void 0),n([s.Autowired("columnApi"),o("design:type",c.ColumnApi)],v.prototype,"columnApi",void 0),n([s.Autowired("gridApi"),o("design:type",g.GridApi)],v.prototype,"gridApi",void 0),v=a=n([p.Bean("sortController")],v));function v(){}t.SortController=m},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o.EVENT_COLUMN_EVERYTHING_CHANGED="columnEverythingChanged",o.EVENT_NEW_COLUMNS_LOADED="newColumnsLoaded",o.EVENT_COLUMN_PIVOT_MODE_CHANGED="columnPivotModeChanged",o.EVENT_COLUMN_ROW_GROUP_CHANGED="columnRowGroupChanged",o.EVENT_COLUMN_PIVOT_CHANGED="columnPivotChanged",o.EVENT_GRID_COLUMNS_CHANGED="gridColumnsChanged",o.EVENT_COLUMN_VALUE_CHANGED="columnValueChanged",o.EVENT_COLUMN_MOVED="columnMoved",o.EVENT_COLUMN_VISIBLE="columnVisible",o.EVENT_COLUMN_PINNED="columnPinned",o.EVENT_COLUMN_GROUP_OPENED="columnGroupOpened",o.EVENT_COLUMN_RESIZED="columnResized",o.EVENT_DISPLAYED_COLUMNS_CHANGED="displayedColumnsChanged",o.EVENT_VIRTUAL_COLUMNS_CHANGED="virtualColumnsChanged",o.EVENT_ROW_GROUP_OPENED="rowGroupOpened",o.EVENT_ROW_DATA_CHANGED="rowDataChanged",o.EVENT_ROW_DATA_UPDATED="rowDataUpdated",o.EVENT_PINNED_ROW_DATA_CHANGED="pinnedRowDataChanged",o.EVENT_RANGE_SELECTION_CHANGED="rangeSelectionChanged",o.EVENT_TOOL_PANEL_VISIBLE_CHANGED="toolPanelVisibleChanged",o.EVENT_MODEL_UPDATED="modelUpdated",o.EVENT_PASTE_START="pasteStart",o.EVENT_PASTE_END="pasteEnd",o.EVENT_CELL_CLICKED="cellClicked",o.EVENT_CELL_DOUBLE_CLICKED="cellDoubleClicked",o.EVENT_CELL_MOUSE_DOWN="cellMouseDown",o.EVENT_CELL_CONTEXT_MENU="cellContextMenu",o.EVENT_CELL_VALUE_CHANGED="cellValueChanged",o.EVENT_ROW_VALUE_CHANGED="rowValueChanged",o.EVENT_CELL_FOCUSED="cellFocused",o.EVENT_ROW_SELECTED="rowSelected",o.EVENT_SELECTION_CHANGED="selectionChanged",o.EVENT_CELL_MOUSE_OVER="cellMouseOver",o.EVENT_CELL_MOUSE_OUT="cellMouseOut",o.EVENT_FILTER_CHANGED="filterChanged",o.EVENT_FILTER_MODIFIED="filterModified",o.EVENT_SORT_CHANGED="sortChanged",o.EVENT_VIRTUAL_ROW_REMOVED="virtualRowRemoved",o.EVENT_ROW_CLICKED="rowClicked",o.EVENT_ROW_DOUBLE_CLICKED="rowDoubleClicked",o.EVENT_GRID_READY="gridReady",o.DEPRECATED_EVENT_GRID_SIZE_CHANGED="gridSizeChanged",o.EVENT_VIEWPORT_CHANGED="viewportChanged",o.EVENT_DRAG_STARTED="dragStarted",o.EVENT_DRAG_STOPPED="dragStopped",o.EVENT_ROW_EDITING_STARTED="rowEditingStarted",o.EVENT_ROW_EDITING_STOPPED="rowEditingStopped",o.EVENT_CELL_EDITING_STARTED="cellEditingStarted",o.EVENT_CELL_EDITING_STOPPED="cellEditingStopped",o.EVENT_BODY_SCROLL="bodyScroll",o.EVENT_ANIMATION_QUEUE_EMPTY="animationQueueEmpty",o.EVENT_HEIGHT_SCALE_CHANGED="heightScaleChanged",o.EVENT_PAGINATION_CHANGED="paginationChanged",o.EVENT_COMPONENT_STATE_CHANGED="componentStateChanged",o.EVENT_BODY_HEIGHT_CHANGED="bodyHeightChanged",o.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED="displayedColumnsWidthChanged",o.EVENT_SCROLL_VISIBILITY_CHANGED="scrollVisibilityChanged",o.EVENT_COLUMN_HOVER_CHANGED="columnHoverChanged",o.EVENT_FLASH_CELLS="flashCells",o.EVENT_ROW_DRAG_ENTER="rowDragEnter",o.EVENT_ROW_DRAG_MOVE="rowDragMove",o.EVENT_ROW_DRAG_LEAVE="rowDragLeave",o.EVENT_ROW_DRAG_END="rowDragEnd",o.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST="columnRowGroupChangeRequest",o.EVENT_COLUMN_PIVOT_CHANGE_REQUEST="columnPivotChangeRequest",o.EVENT_COLUMN_VALUE_CHANGE_REQUEST="columnValueChangeRequest",o.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST="columnAggFuncChangeRequest",o);function o(){}t.Events=n},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(10),a=i(3),s=i(0),l=i(2),c=i(7),u=i(6),d=(h.createUniqueId=function(e,t){return e+"_"+t},h.prototype.reset=function(){this.parent=null,this.children=null,this.displayedChildren=null},h.prototype.getParent=function(){return this.parent},h.prototype.setParent=function(e){this.parent=e},h.prototype.getUniqueId=function(){return h.createUniqueId(this.groupId,this.instanceId)},h.prototype.isEmptyGroup=function(){return 0===this.displayedChildren.length},h.prototype.isMoving=function(){var e=this.getOriginalColumnGroup().getLeafColumns();if(!e||0===e.length)return!1;var t=!0;return e.forEach(function(e){e.isMoving()||(t=!1)}),t},h.prototype.checkLeft=function(){if(this.displayedChildren.forEach(function(e){e instanceof h&&e.checkLeft()}),0<this.displayedChildren.length)if(this.gridOptionsWrapper.isEnableRtl()){var e=this.displayedChildren[this.displayedChildren.length-1].getLeft();this.setLeft(e)}else{var t=this.displayedChildren[0].getLeft();this.setLeft(t)}else this.setLeft(null)},h.prototype.getLeft=function(){return this.left},h.prototype.getOldLeft=function(){return this.oldLeft},h.prototype.setLeft=function(e){this.oldLeft=e,this.left!==e&&(this.left=e,this.localEventService.dispatchEvent(this.createAgEvent(h.EVENT_LEFT_CHANGED)))},h.prototype.createAgEvent=function(e){return{type:e}},h.prototype.addEventListener=function(e,t){this.localEventService.addEventListener(e,t)},h.prototype.removeEventListener=function(e,t){this.localEventService.removeEventListener(e,t)},h.prototype.getGroupId=function(){return this.groupId},h.prototype.getInstanceId=function(){return this.instanceId},h.prototype.isChildInThisGroupDeepSearch=function(t){var i=!1;return this.children.forEach(function(e){t===e&&(i=!0),e instanceof h&&e.isChildInThisGroupDeepSearch(t)&&(i=!0)}),i},h.prototype.getActualWidth=function(){var t=0;return this.displayedChildren&&this.displayedChildren.forEach(function(e){t+=e.getActualWidth()}),t},h.prototype.isResizable=function(){if(!this.displayedChildren)return!1;var t=!1;return this.displayedChildren.forEach(function(e){e.isResizable()&&(t=!0)}),t},h.prototype.getMinWidth=function(){var t=0;return this.displayedChildren.forEach(function(e){t+=e.getMinWidth()}),t},h.prototype.addChild=function(e){this.children||(this.children=[]),this.children.push(e)},h.prototype.getDisplayedChildren=function(){return this.displayedChildren},h.prototype.getLeafColumns=function(){var e=[];return this.addLeafColumns(e),e},h.prototype.getDisplayedLeafColumns=function(){var e=[];return this.addDisplayedLeafColumns(e),e},h.prototype.getDefinition=function(){return this.originalColumnGroup.getColGroupDef()},h.prototype.getColGroupDef=function(){return this.originalColumnGroup.getColGroupDef()},h.prototype.isPadding=function(){return this.originalColumnGroup.isPadding()},h.prototype.isExpandable=function(){return this.originalColumnGroup.isExpandable()},h.prototype.isExpanded=function(){return this.originalColumnGroup.isExpanded()},h.prototype.setExpanded=function(e){this.originalColumnGroup.setExpanded(e)},h.prototype.addDisplayedLeafColumns=function(t){this.displayedChildren.forEach(function(e){e instanceof r.Column?t.push(e):e instanceof h&&e.addDisplayedLeafColumns(t)})},h.prototype.addLeafColumns=function(t){this.children.forEach(function(e){e instanceof r.Column?t.push(e):e instanceof h&&e.addLeafColumns(t)})},h.prototype.getChildren=function(){return this.children},h.prototype.getColumnGroupShow=function(){return this.originalColumnGroup.getColumnGroupShow()},h.prototype.getOriginalColumnGroup=function(){return this.originalColumnGroup},h.prototype.calculateDisplayedColumns=function(){var t=this;this.displayedChildren=[],this.originalColumnGroup.isExpandable()?this.children.forEach(function(e){switch(e.getColumnGroupShow()){case h.HEADER_GROUP_SHOW_OPEN:t.originalColumnGroup.isExpanded()&&t.displayedChildren.push(e);break;case h.HEADER_GROUP_SHOW_CLOSED:t.originalColumnGroup.isExpanded()||t.displayedChildren.push(e);break;default:t.displayedChildren.push(e)}}):this.displayedChildren=this.children,this.localEventService.dispatchEvent(this.createAgEvent(h.EVENT_DISPLAYED_CHILDREN_CHANGED))},h.HEADER_GROUP_SHOW_OPEN="open",h.HEADER_GROUP_SHOW_CLOSED="closed",h.EVENT_LEFT_CHANGED="leftChanged",h.EVENT_DISPLAYED_CHILDREN_CHANGED="displayedChildrenChanged",n([s.Autowired("gridOptionsWrapper"),o("design:type",l.GridOptionsWrapper)],h.prototype,"gridOptionsWrapper",void 0),n([s.Autowired("columnApi"),o("design:type",c.ColumnApi)],h.prototype,"columnApi",void 0),n([s.Autowired("gridApi"),o("design:type",u.GridApi)],h.prototype,"gridApi",void 0),h);function h(e,t,i){this.displayedChildren=[],this.localEventService=new a.EventService,this.groupId=t,this.instanceId=i,this.originalColumnGroup=e}t.ColumnGroup=d},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var p,r,f,a,s=i(0),l=i(2),g=i(1),c=i(66),u=i(76),d=i(77);(r=p=t.ComponentType||(t.ComponentType={}))[r.AG_GRID=0]="AG_GRID",r[r.FRAMEWORK=1]="FRAMEWORK",(a=f=t.ComponentSource||(t.ComponentSource={}))[a.DEFAULT=0]="DEFAULT",a[a.REGISTERED_BY_NAME=1]="REGISTERED_BY_NAME",a[a.HARDCODED=2]="HARDCODED";var h=(m.prototype.getComponentToUse=function(e,t,i,n){var o,r,a=null,s=null,l=null,c=null;if(null!=e){var u=e[t];null!=u&&("string"==typeof u?a=u:this.agComponentUtils.doesImplementIComponent(u)?s=u:l=u),c=e[t+"Framework"],o=e[t+"Selector"]}if(s&&c||a&&c||l&&c)throw Error("ag-grid: you are trying to specify: "+t+" twice as a component.");if(c&&!this.frameworkComponentWrapper)throw Error("ag-grid: you are specifying a framework component but you are not using a framework version of ag-grid for : "+t);if(o&&(a||s||l||c))throw Error("ag-grid: you can't specify both, the selector and the component of ag-grid for : "+t);if(c)return{type:p.FRAMEWORK,component:c,source:f.HARDCODED,dynamicParams:null};if(s)return{type:p.AG_GRID,component:s,source:f.HARDCODED,dynamicParams:null};if(l)return this.agComponentUtils.adaptFunction(t,l,p.AG_GRID,f.HARDCODED);if(o){var d=o(i);if(null!=d){null==d.component&&(d.component=n);var h=this.resolveByName(t,d.component);return g._.assign(h,{dynamicParams:d.params})}}return null==(r=a||n)?null:this.resolveByName(t,r)},m.prototype.resolveByName=function(e,t){var i=null!=t?t:e,n=this.componentProvider.retrieve(i);return null==n?null:n.type==p.FRAMEWORK?{component:n.component,type:p.FRAMEWORK,source:f.REGISTERED_BY_NAME,dynamicParams:null}:this.agComponentUtils.doesImplementIComponent(n.component)?{component:n.component,type:p.AG_GRID,source:n.source==c.RegisteredComponentSource.REGISTERED?f.REGISTERED_BY_NAME:f.DEFAULT,dynamicParams:null}:this.agComponentUtils.adaptFunction(e,n.component,n.type,n.source==c.RegisteredComponentSource.REGISTERED?f.REGISTERED_BY_NAME:f.DEFAULT)},m.prototype.mergeParams=function(e,t,i,n,o){void 0===o&&(o=null);var r=e?e[t+"Params"]:null,a={};if(g._.mergeDeep(a,i),null!=r){var s=null;s="function"==typeof r?r(n):r,g._.mergeDeep(a,s)}return g._.mergeDeep(a,o),a.api||(a.api=this.gridOptions.api),a},m.prototype.createAgGridComponent=function(e,t,i,n,o,r,a){void 0===r&&(r=!0);var s=null==e?this.gridOptions:e,l=this.newAgGridComponent(s,i,n,o,r);if(!l)return null;var c=this.mergeParams(s,i,t,n,l[1]);c.agGridReact=this.context.getBean("agGridReact")?g._.cloneObject(this.context.getBean("agGridReact")):{},c.frameworkComponentWrapper=this.context.getBean("frameworkComponentWrapper")?this.context.getBean("frameworkComponentWrapper"):{};var u=this.initialiseComponent(l[0],c,a);return null==u?g.Promise.resolve(l[0]):u.map(function(e){return l[0]})},m.prototype.createInternalAgGridComponent=function(e,t,i){var n=new e;return this.initialiseComponent(n,t,i),n},m.prototype.newAgGridComponent=function(e,t,i,n,o){void 0===o&&(o=!0);var r=this.getComponentToUse(e,t,i,n);if(!r||!r.component)return o&&console.error("Error creating component "+t+"=>"+n),null;if(r.type===p.AG_GRID)return[new r.component,r.dynamicParams];var a=r.component,s=this.componentMetadataProvider.retrieve(t);return[this.frameworkComponentWrapper.wrap(a,s.mandatoryMethodList,s.optionalMethodList,n),r.dynamicParams]},m.prototype.initialiseComponent=function(e,t,i){return this.context.wireBean(e),null==i?e.init(t):e.init(i(t,e))},n([s.Autowired("gridOptions"),o("design:type",Object)],m.prototype,"gridOptions",void 0),n([s.Autowired("gridOptionsWrapper"),o("design:type",l.GridOptionsWrapper)],m.prototype,"gridOptionsWrapper",void 0),n([s.Autowired("context"),o("design:type",s.Context)],m.prototype,"context",void 0),n([s.Autowired("agComponentUtils"),o("design:type",u.AgComponentUtils)],m.prototype,"agComponentUtils",void 0),n([s.Autowired("componentMetadataProvider"),o("design:type",d.ComponentMetadataProvider)],m.prototype,"componentMetadataProvider",void 0),n([s.Autowired("componentProvider"),o("design:type",c.ComponentProvider)],m.prototype,"componentProvider",void 0),n([s.Optional("frameworkComponentWrapper"),o("design:type",Object)],m.prototype,"frameworkComponentWrapper",void 0),m=n([s.Bean("componentResolver")],m));function m(){}t.ComponentResolver=h},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(7),s=i(4),l=i(6),c=i(2),u=i(19),d=i(20),h=i(49),p=i(16),f=i(3),g=i(53),m=i(22),v=i(54),y=i(55),b=i(35),w=i(56),C=i(43),_=i(73),A=i(45),E=i(29),x=i(37),S=i(27),T=i(15),D=i(24),k=i(18),R=i(57),O=(N.prototype.registerGridComp=function(e){this.gridPanel=e},N.prototype.postConstruct=function(){this.doingMasterDetail=this.gridOptionsWrapper.isMasterDetail()},n([r.Autowired("paginationProxy"),o("design:type",E.PaginationProxy)],N.prototype,"paginationProxy",void 0),n([r.Autowired("context"),o("design:type",r.Context)],N.prototype,"context",void 0),n([r.Autowired("columnApi"),o("design:type",a.ColumnApi)],N.prototype,"columnApi",void 0),n([r.Autowired("gridApi"),o("design:type",l.GridApi)],N.prototype,"gridApi",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",c.GridOptionsWrapper)],N.prototype,"gridOptionsWrapper",void 0),n([r.Autowired("expressionService"),o("design:type",u.ExpressionService)],N.prototype,"expressionService",void 0),n([r.Autowired("rowRenderer"),o("design:type",d.RowRenderer)],N.prototype,"rowRenderer",void 0),n([r.Autowired("$compile"),o("design:type",Object)],N.prototype,"$compile",void 0),n([r.Autowired("templateService"),o("design:type",h.TemplateService)],N.prototype,"templateService",void 0),n([r.Autowired("valueService"),o("design:type",p.ValueService)],N.prototype,"valueService",void 0),n([r.Autowired("eventService"),o("design:type",f.EventService)],N.prototype,"eventService",void 0),n([r.Autowired("columnController"),o("design:type",s.ColumnController)],N.prototype,"columnController",void 0),n([r.Autowired("columnAnimationService"),o("design:type",g.ColumnAnimationService)],N.prototype,"columnAnimationService",void 0),n([r.Optional("rangeController"),o("design:type",Object)],N.prototype,"rangeController",void 0),n([r.Autowired("focusedCellController"),o("design:type",m.FocusedCellController)],N.prototype,"focusedCellController",void 0),n([r.Optional("contextMenuFactory"),o("design:type",Object)],N.prototype,"contextMenuFactory",void 0),n([r.Autowired("cellEditorFactory"),o("design:type",v.CellEditorFactory)],N.prototype,"cellEditorFactory",void 0),n([r.Autowired("cellRendererFactory"),o("design:type",y.CellRendererFactory)],N.prototype,"cellRendererFactory",void 0),n([r.Autowired("popupService"),o("design:type",b.PopupService)],N.prototype,"popupService",void 0),n([r.Autowired("cellRendererService"),o("design:type",w.CellRendererService)],N.prototype,"cellRendererService",void 0),n([r.Autowired("valueFormatterService"),o("design:type",C.ValueFormatterService)],N.prototype,"valueFormatterService",void 0),n([r.Autowired("stylingService"),o("design:type",_.StylingService)],N.prototype,"stylingService",void 0),n([r.Autowired("columnHoverService"),o("design:type",A.ColumnHoverService)],N.prototype,"columnHoverService",void 0),n([r.Autowired("enterprise"),o("design:type",Boolean)],N.prototype,"enterprise",void 0),n([r.Autowired("componentResolver"),o("design:type",S.ComponentResolver)],N.prototype,"componentResolver",void 0),n([r.Autowired("animationFrameService"),o("design:type",x.AnimationFrameService)],N.prototype,"taskQueue",void 0),n([r.Autowired("dragAndDropService"),o("design:type",T.DragAndDropService)],N.prototype,"dragAndDropService",void 0),n([r.Autowired("sortController"),o("design:type",D.SortController)],N.prototype,"sortController",void 0),n([r.Autowired("filterManager"),o("design:type",k.FilterManager)],N.prototype,"filterManager",void 0),n([r.Autowired("heightScaler"),o("design:type",R.HeightScaler)],N.prototype,"heightScaler",void 0),n([r.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],N.prototype,"postConstruct",null),N=n([r.Bean("beans")],N));function N(){}t.Beans=O},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(13),c=i(3),u=i(5),d=i(1),h=i(0),p=i(2),f=i(36),g=i(17),m=i(7),v=i(6),y=(s=l.BeanStub,o(b,s),b.prototype.registerGridComp=function(e){this.gridPanel=e,this.addDestroyableEventListener(this.eventService,u.Events.EVENT_BODY_HEIGHT_CHANGED,this.onBodyHeightChanged.bind(this)),this.addDestroyableEventListener(this.eventService,u.Events.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.checkPageSize()},b.prototype.notActive=function(){return!this.gridOptionsWrapper.isPaginationAutoPageSize()},b.prototype.onScrollVisibilityChanged=function(){this.checkPageSize()},b.prototype.onBodyHeightChanged=function(){this.checkPageSize()},b.prototype.checkPageSize=function(){if(!this.notActive()){var e=this.gridOptionsWrapper.getRowHeightAsNumber(),t=this.gridPanel.getBodyHeight();if(this.scrollVisibleService.isBodyHorizontalScrollShowing()&&(t-=this.gridOptionsWrapper.getScrollbarWidth()),0<t){var i=Math.floor(t/e);this.gridOptionsWrapper.setProperty("paginationPageSize",i)}}},r([h.Autowired("eventService"),a("design:type",c.EventService)],b.prototype,"eventService",void 0),r([h.Autowired("gridOptionsWrapper"),a("design:type",p.GridOptionsWrapper)],b.prototype,"gridOptionsWrapper",void 0),r([h.Autowired("scrollVisibleService"),a("design:type",f.ScrollVisibleService)],b.prototype,"scrollVisibleService",void 0),b=r([h.Bean("paginationAutoPageSizeService")],b));function b(){return null!==s&&s.apply(this,arguments)||this}t.PaginationAutoPageSizeService=y;var w,C=(w=l.BeanStub,o(_,w),_.prototype.postConstruct=function(){this.active=this.gridOptionsWrapper.isPagination(),this.addDestroyableEventListener(this.eventService,u.Events.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addDestroyableEventListener(this.gridOptionsWrapper,"paginationPageSize",this.onModelUpdated.bind(this)),this.onModelUpdated()},_.prototype.isLastRowFound=function(){return this.rowModel.isLastRowFound()},_.prototype.onModelUpdated=function(e){this.setIndexesAndBounds();var t={type:u.Events.EVENT_PAGINATION_CHANGED,animate:!!e&&e.animate,newData:!!e&&e.newData,newPage:!!e&&e.newPage,keepRenderedRows:!!e&&e.keepRenderedRows,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(t)},_.prototype.goToPage=function(e){if(this.active&&this.currentPage!==e){this.currentPage=e;var t={type:u.Events.EVENT_MODEL_UPDATED,animate:!1,keepRenderedRows:!1,newData:!1,newPage:!0,api:this.gridApi,columnApi:this.columnApi};this.onModelUpdated(t)}},_.prototype.getPixelOffset=function(){return this.pixelOffset},_.prototype.getRow=function(e){return this.rowModel.getRow(e)},_.prototype.getRowNode=function(e){return this.rowModel.getRowNode(e)},_.prototype.getRowIndexAtPixel=function(e){return this.rowModel.getRowIndexAtPixel(e)},_.prototype.getCurrentPageHeight=function(){return d._.missing(this.topRowBounds)||d._.missing(this.bottomRowBounds)?0:this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop},_.prototype.isRowPresent=function(e){return!!this.rowModel.isRowPresent(e)&&e.rowIndex>=this.topRowIndex&&e.rowIndex<=this.bottomRowIndex},_.prototype.isEmpty=function(){return this.rowModel.isEmpty()},_.prototype.isRowsToRender=function(){return this.rowModel.isRowsToRender()},_.prototype.getNodesInRangeForSelection=function(e,t){return this.rowModel.getNodesInRangeForSelection(e,t)},_.prototype.forEachNode=function(e){return this.rowModel.forEachNode(e)},_.prototype.getType=function(){return this.rowModel.getType()},_.prototype.getRowBounds=function(e){return this.rowModel.getRowBounds(e)},_.prototype.getPageFirstRow=function(){return this.pageSize*this.currentPage},_.prototype.getPageLastRow=function(){var e=this.pageSize*(this.currentPage+1)-1,t=this.rowModel.getPageLastRow();return e<t?e:t},_.prototype.getRowCount=function(){return this.rowModel.getRowCount()},_.prototype.goToPageWithIndex=function(e){if(this.active){var t=Math.floor(e/this.pageSize);this.goToPage(t)}},_.prototype.getTotalRowCount=function(){return this.rowModel.getPageLastRow()+1},_.prototype.isLastPageFound=function(){return this.rowModel.isLastRowFound()},_.prototype.getCurrentPage=function(){return this.currentPage},_.prototype.goToNextPage=function(){this.goToPage(this.currentPage+1)},_.prototype.goToPreviousPage=function(){this.goToPage(this.currentPage-1)},_.prototype.goToFirstPage=function(){this.goToPage(0)},_.prototype.goToLastPage=function(){var e=this.rowModel.getPageLastRow()+1,t=Math.floor(e/this.pageSize);this.goToPage(t)},_.prototype.getPageSize=function(){return this.pageSize},_.prototype.getTotalPages=function(){return this.totalPages},_.prototype.setPageSize=function(){this.pageSize=this.gridOptionsWrapper.getPaginationPageSize(),1<=this.pageSize||(this.pageSize=100)},_.prototype.setIndexesAndBounds=function(){if(this.active){this.setPageSize();var e=this.getTotalRowCount();this.totalPages=Math.floor((e-1)/this.pageSize)+1,this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!d._.isNumeric(this.currentPage)||this.currentPage<0)&&(this.currentPage=0),this.topRowIndex=this.pageSize*this.currentPage,this.bottomRowIndex=this.pageSize*(this.currentPage+1)-1;var t=this.rowModel.getPageLastRow();this.bottomRowIndex>t&&(this.bottomRowIndex=t)}else this.pageSize=this.rowModel.getPageLastRow()+1,this.totalPages=1,this.currentPage=0,this.topRowIndex=0,this.bottomRowIndex=this.rowModel.getPageLastRow();this.topRowBounds=this.rowModel.getRowBounds(this.topRowIndex),this.bottomRowBounds=this.rowModel.getRowBounds(this.bottomRowIndex),this.pixelOffset=d._.exists(this.topRowBounds)?this.topRowBounds.rowTop:0},r([h.Autowired("rowModel"),a("design:type",Object)],_.prototype,"rowModel",void 0),r([h.Autowired("eventService"),a("design:type",c.EventService)],_.prototype,"eventService",void 0),r([h.Autowired("gridOptionsWrapper"),a("design:type",p.GridOptionsWrapper)],_.prototype,"gridOptionsWrapper",void 0),r([h.Autowired("selectionController"),a("design:type",g.SelectionController)],_.prototype,"selectionController",void 0),r([h.Autowired("columnApi"),a("design:type",m.ColumnApi)],_.prototype,"columnApi",void 0),r([h.Autowired("gridApi"),a("design:type",v.GridApi)],_.prototype,"gridApi",void 0),r([h.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],_.prototype,"postConstruct",null),_=r([h.Bean("paginationProxy")],_));function _(){var e=null!==w&&w.apply(this,arguments)||this;return e.currentPage=0,e.topRowIndex=0,e.bottomRowIndex=0,e.pixelOffset=0,e}t.PaginationProxy=C},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),s=i(14),a=i(0),l=i(3),c=i(0),u=i(5),d=i(0),h=i(9),p=i(1),f=i(7),g=i(6),m=(v.prototype.init=function(){this.setPinnedTopRowData(this.gridOptionsWrapper.getPinnedTopRowData()),this.setPinnedBottomRowData(this.gridOptionsWrapper.getPinnedBottomRowData())},v.prototype.isEmpty=function(e){var t=e===h.Constants.PINNED_TOP?this.pinnedTopRows:this.pinnedBottomRows;return p.Utils.missingOrEmpty(t)},v.prototype.isRowsToRender=function(e){return!this.isEmpty(e)},v.prototype.getRowAtPixel=function(e,t){var i=t===h.Constants.PINNED_TOP?this.pinnedTopRows:this.pinnedBottomRows;if(p.Utils.missingOrEmpty(i))return 0;for(var n=0;n<i.length;n++){var o=i[n];if(e<=o.rowTop+o.rowHeight-1)return n}return i.length-1},v.prototype.setPinnedTopRowData=function(e){this.pinnedTopRows=this.createNodesFromData(e,!0);var t={type:u.Events.EVENT_PINNED_ROW_DATA_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(t)},v.prototype.setPinnedBottomRowData=function(e){this.pinnedBottomRows=this.createNodesFromData(e,!1);var t={type:u.Events.EVENT_PINNED_ROW_DATA_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(t)},v.prototype.createNodesFromData=function(e,n){var o=this,r=[];if(e){var a=0;e.forEach(function(e,t){var i=new s.RowNode;o.context.wireBean(i),i.data=e,i.rowPinned=n?h.Constants.PINNED_TOP:h.Constants.PINNED_BOTTOM,i.setRowTop(a),i.setRowHeight(o.gridOptionsWrapper.getRowHeightForNode(i)),i.setRowIndex(t),a+=i.rowHeight,r.push(i)})}return r},v.prototype.getPinnedTopRowData=function(){return this.pinnedTopRows},v.prototype.getPinnedBottomRowData=function(){return this.pinnedBottomRows},v.prototype.getPinnedTopTotalHeight=function(){return this.getTotalHeight(this.pinnedTopRows)},v.prototype.getPinnedTopRowCount=function(){return this.pinnedTopRows?this.pinnedTopRows.length:0},v.prototype.getPinnedBottomRowCount=function(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0},v.prototype.getPinnedTopRow=function(e){return this.pinnedTopRows[e]},v.prototype.getPinnedBottomRow=function(e){return this.pinnedBottomRows[e]},v.prototype.forEachPinnedTopRow=function(e){p.Utils.missingOrEmpty(this.pinnedTopRows)||this.pinnedTopRows.forEach(e)},v.prototype.forEachPinnedBottomRow=function(e){p.Utils.missingOrEmpty(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(e)},v.prototype.getPinnedBottomTotalHeight=function(){return this.getTotalHeight(this.pinnedBottomRows)},v.prototype.getTotalHeight=function(e){if(e&&0!==e.length){var t=e[e.length-1];return t.rowTop+t.rowHeight}return 0},n([c.Autowired("gridOptionsWrapper"),o("design:type",r.GridOptionsWrapper)],v.prototype,"gridOptionsWrapper",void 0),n([c.Autowired("eventService"),o("design:type",l.EventService)],v.prototype,"eventService",void 0),n([c.Autowired("context"),o("design:type",a.Context)],v.prototype,"context",void 0),n([c.Autowired("columnApi"),o("design:type",f.ColumnApi)],v.prototype,"columnApi",void 0),n([c.Autowired("gridApi"),o("design:type",g.GridApi)],v.prototype,"gridApi",void 0),n([d.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],v.prototype,"init",null),v=n([a.Bean("pinnedRowModel")],v));function v(){}t.PinnedRowModel=m},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),a=i(26),c=i(32),s=i(0),l=i(0),u=(d.prototype.calculateColInitialWidth=function(e){return e.width?e.width<this.gridOptionsWrapper.getMinColWidth()?this.gridOptionsWrapper.getMinColWidth():e.width:this.gridOptionsWrapper.getColWidth()},d.prototype.getOriginalPathForColumn=function(a,e){var s=[],l=!1;return function e(t,i){for(var n=0;n<t.length;n++){if(l)return;var o=t[n];if(o instanceof c.OriginalColumnGroup){var r=o;e(r.getChildren(),i+1),s[i]=o}else o===a&&(l=!0)}}(e,0),l?s:null},d.prototype.depthFirstOriginalTreeSearch=function(e,t){var i=this;e&&e.forEach(function(e){e instanceof c.OriginalColumnGroup&&i.depthFirstOriginalTreeSearch(e.getChildren(),t),t(e)})},d.prototype.depthFirstAllColumnTreeSearch=function(e,t){var i=this;e&&e.forEach(function(e){e instanceof a.ColumnGroup&&i.depthFirstAllColumnTreeSearch(e.getChildren(),t),t(e)})},d.prototype.depthFirstDisplayedColumnTreeSearch=function(e,t){var i=this;e&&e.forEach(function(e){e instanceof a.ColumnGroup&&i.depthFirstDisplayedColumnTreeSearch(e.getDisplayedChildren(),t),t(e)})},n([l.Autowired("gridOptionsWrapper"),o("design:type",r.GridOptionsWrapper)],d.prototype,"gridOptionsWrapper",void 0),d=n([s.Bean("columnUtils")],d));function d(){}t.ColumnUtils=u},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var c=i(26),r=i(10),a=i(3),s=i(0),l=i(7),u=i(6),d=(h.prototype.getLevel=function(){return this.level},h.prototype.isVisible=function(){return!!this.children&&this.children.some(function(e){return e.isVisible()})},h.prototype.isPadding=function(){return this.padding},h.prototype.setExpanded=function(e){this.expanded=e;var t={type:h.EVENT_EXPANDED_CHANGED};this.localEventService.dispatchEvent(t)},h.prototype.isExpandable=function(){return this.expandable},h.prototype.isExpanded=function(){return this.expanded},h.prototype.getGroupId=function(){return this.groupId},h.prototype.getId=function(){return this.getGroupId()},h.prototype.setChildren=function(e){this.children=e},h.prototype.getChildren=function(){return this.children},h.prototype.getColGroupDef=function(){return this.colGroupDef},h.prototype.getLeafColumns=function(){var e=[];return this.addLeafColumns(e),e},h.prototype.addLeafColumns=function(t){this.children&&this.children.forEach(function(e){e instanceof r.Column?t.push(e):e instanceof h&&e.addLeafColumns(t)})},h.prototype.getColumnGroupShow=function(){return this.padding?this.children[0].getColumnGroupShow():this.colGroupDef.columnGroupShow},h.prototype.setupExpandable=function(){var t=this;this.setExpandable(),this.getLeafColumns().forEach(function(e){return e.addEventListener(r.Column.EVENT_VISIBLE_CHANGED,t.onColumnVisibilityChanged.bind(t))})},h.prototype.setExpandable=function(){for(var e=!1,t=!1,i=!1,n=0,o=this.children.length;n<o;n++){var r=this.children[n];if(r.isVisible()){var a=r.getColumnGroupShow();a===c.ColumnGroup.HEADER_GROUP_SHOW_OPEN?i=e=!0:a===c.ColumnGroup.HEADER_GROUP_SHOW_CLOSED?i=t=!0:t=e=!0}}var s=e&&t&&i;if(this.expandable!==s){this.expandable=s;var l={type:h.EVENT_EXPANDABLE_CHANGED};this.localEventService.dispatchEvent(l)}},h.prototype.onColumnVisibilityChanged=function(){this.setExpandable()},h.prototype.addEventListener=function(e,t){this.localEventService.addEventListener(e,t)},h.prototype.removeEventListener=function(e,t){this.localEventService.removeEventListener(e,t)},h.EVENT_EXPANDED_CHANGED="expandedChanged",h.EVENT_EXPANDABLE_CHANGED="expandableChanged",n([s.Autowired("columnApi"),o("design:type",l.ColumnApi)],h.prototype,"columnApi",void 0),n([s.Autowired("gridApi"),o("design:type",u.GridApi)],h.prototype,"gridApi",void 0),h);function h(e,t,i,n){this.localEventService=new a.EventService,this.expandable=!1,this.colGroupDef=e,this.groupId=t,this.expanded=e&&!!e.openByDefault,this.padding=i,this.level=n}t.OriginalColumnGroup=d},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(2),s=(l.prototype.init=function(){this.active=this.gridOptionsWrapper.isValueCache(),this.neverExpires=this.gridOptionsWrapper.isValueCacheNeverExpires()},l.prototype.onDataChanged=function(){this.neverExpires||this.expire()},l.prototype.expire=function(){this.cacheVersion++},l.prototype.setValue=function(e,t,i){this.active&&(e.__cacheVersion!==this.cacheVersion&&(e.__cacheVersion=this.cacheVersion,e.__cacheData={}),e.__cacheData[t]=i)},l.prototype.getValue=function(e,t){return this.active&&e.__cacheVersion===this.cacheVersion&&void 0!==e.__cacheData[t]?e.__cacheData[t]:void 0},n([r.Autowired("gridOptionsWrapper"),o("design:type",a.GridOptionsWrapper)],l.prototype,"gridOptionsWrapper",void 0),n([r.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],l.prototype,"init",null),l=n([r.Bean("valueCache")],l));function l(){this.cacheVersion=0}t.ValueCache=s},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var s,p=i(1),r=i(10),a=i(14),l=i(9),c=i(5),u=i(23),d=i(8),h=i(65),f=i(121),g=(s=d.Component,o(m,s),m.prototype.getCreateTemplate=function(){var e=[],t=this.column,i=this.getCellWidth(),n=t.getLeft(),o=this.getInitialValueToRender(),r=p._.get(this.column,"colDef.template",null)?o:p._.escape(o);this.tooltip=this.getToolTip();var a,s,l=p._.escape(this.tooltip),c=p._.escape(t.getId()),u=this.preProcessStylesFromColDef(),d=this.getInitialCssClasses(),h=this.getStylesForRowSpanning();return this.usingWrapper&&(a='<span ref="eCellWrapper" class="ag-cell-wrapper"><span ref="eCellValue" class="ag-cell-value">',s="</span></span>"),e.push("<div"),e.push(' tabindex="-1"'),e.push(' role="gridcell"'),e.push(' comp-id="'+this.getCompId()+'" '),e.push(' col-id="'+c+'"'),e.push(' class="'+d.join(" ")+'"'),e.push(l?' title="'+l+'"':""),e.push(' style="width: '+i+"px; left: "+n+"px; "+u+" "+h+'" >'),e.push(a),e.push(r),e.push(s),e.push("</div>"),e.join("")},m.prototype.getStylesForRowSpanning=function(){return 1===this.rowSpan?"":"height: "+this.beans.gridOptionsWrapper.getRowHeightAsNumber()*this.rowSpan+"px; z-index: 1;"},m.prototype.afterAttached=function(){var e='[comp-id="'+this.getCompId()+'"]',t=this.eParentRow.querySelector(e);this.setGui(t),this.addDomData(),this.populateTemplate(),this.attachCellRenderer(),this.angular1Compile(),this.addDestroyableEventListener(this.beans.eventService,c.Events.EVENT_CELL_FOCUSED,this.onCellFocused.bind(this)),this.addDestroyableEventListener(this.beans.eventService,c.Events.EVENT_FLASH_CELLS,this.onFlashCells.bind(this)),this.addDestroyableEventListener(this.beans.eventService,c.Events.EVENT_COLUMN_HOVER_CHANGED,this.onColumnHover.bind(this)),this.addDestroyableEventListener(this.rowNode,a.RowNode.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,a.RowNode.EVENT_CELL_CHANGED,this.onCellChanged.bind(this)),this.addDestroyableEventListener(this.column,r.Column.EVENT_LEFT_CHANGED,this.onLeftChanged.bind(this)),this.addDestroyableEventListener(this.column,r.Column.EVENT_WIDTH_CHANGED,this.onWidthChanged.bind(this)),this.addDestroyableEventListener(this.column,r.Column.EVENT_FIRST_RIGHT_PINNED_CHANGED,this.onFirstRightPinnedChanged.bind(this)),this.addDestroyableEventListener(this.column,r.Column.EVENT_LAST_LEFT_PINNED_CHANGED,this.onLastLeftPinnedChanged.bind(this)),this.rangeSelectionEnabled&&this.addDestroyableEventListener(this.beans.eventService,c.Events.EVENT_RANGE_SELECTION_CHANGED,this.onRangeSelectionChanged.bind(this))},m.prototype.onColumnHover=function(){var e=this.beans.columnHoverService.isHovered(this.column);p._.addOrRemoveCssClass(this.getGui(),"ag-column-hover",e)},m.prototype.onCellChanged=function(e){e.column===this.column&&this.refreshCell({})},m.prototype.getCellLeft=function(){return(this.beans.gridOptionsWrapper.isEnableRtl()&&this.colsSpanning?this.colsSpanning[this.colsSpanning.length-1]:this.column).getLeft()},m.prototype.getCellWidth=function(){if(this.colsSpanning){var t=0;return this.colsSpanning.forEach(function(e){return t+=e.getActualWidth()}),t}return this.column.getActualWidth()},m.prototype.onFlashCells=function(e){var t=this.gridCell.createId();e.cells[t]&&this.animateCell("highlight")},m.prototype.setupColSpan=function(){p._.missing(this.column.getColDef().colSpan)||(this.addDestroyableEventListener(this.beans.eventService,c.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayColumnsChanged.bind(this)),this.addDestroyableEventListener(this.beans.eventService,c.Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onWidthChanged.bind(this)),this.colsSpanning=this.getColSpanningList())},m.prototype.getColSpanningList=function(){var e=this.column.getColSpan(this.rowNode),t=[];if(1===e)t.push(this.column);else for(var i=this.column,n=this.column.getPinned(),o=0;o<e&&(t.push(i),i=this.beans.columnController.getDisplayedColAfter(i),!p._.missing(i))&&n===i.getPinned();o++);return t},m.prototype.onDisplayColumnsChanged=function(){var e=this.getColSpanningList();p._.compareArrays(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())},m.prototype.getInitialCssClasses=function(){var e=["ag-cell","ag-cell-not-inline-editing"];return this.autoHeightCell||e.push("ag-cell-with-height"),this.beans.gridOptionsWrapper.isSuppressCellSelection()?e.push("ag-cell-no-focus"):e.push(this.cellFocused?"ag-cell-focus":"ag-cell-no-focus"),this.firstRightPinned&&e.push("ag-cell-first-right-pinned"),this.lastLeftPinned&&e.push("ag-cell-last-left-pinned"),this.beans.columnHoverService.isHovered(this.column)&&e.push("ag-column-hover"),p._.pushAll(e,this.preProcessClassesFromColDef()),p._.pushAll(e,this.preProcessCellClassRules()),p._.pushAll(e,this.getRangeClasses()),this.usingWrapper||e.push("ag-cell-value"),e},m.prototype.getInitialValueToRender=function(){if(this.usingCellRenderer)return"string"==typeof this.cellRendererGui?this.cellRendererGui:"";var e=this.column.getColDef();if(e.template)return e.template;if(e.templateUrl){var t=this.beans.templateService.getTemplate(e.templateUrl,this.refreshCell.bind(this,!0));return t||""}return this.getValueToUse()},m.prototype.getRenderedRow=function(){return this.rowComp},m.prototype.isSuppressNavigable=function(){return this.column.isSuppressNavigable(this.rowNode)},m.prototype.getCellRenderer=function(){return this.cellRenderer},m.prototype.getCellEditor=function(){return this.cellEditor},m.prototype.refreshCell=function(e){if(!this.editingCell){var t=e&&e.newData,i=e&&e.suppressFlash||this.column.getColDef().suppressCellFlash,n=e&&e.forceRefresh,o=this.value;this.getValueAndFormat();var r=!this.valuesAreEqual(o,this.value);(n||r)&&(!t&&!i&&this.attemptCellRendererRefresh()||this.replaceContentsAfterRefresh(),i||(this.beans.gridOptionsWrapper.isEnableCellChangeFlash()||this.column.getColDef().enableCellChangeFlash)&&this.flashCell(),this.postProcessStylesFromColDef(),this.postProcessClassesFromColDef()),this.refreshToolTip(),this.postProcessCellClassRules()}},m.prototype.flashCell=function(){this.animateCell("data-changed")},m.prototype.animateCell=function(e){var t="ag-cell-"+e,i="ag-cell-"+e+"-animation",n=this.getGui();p._.addCssClass(n,t),p._.removeCssClass(n,i),setTimeout(function(){p._.removeCssClass(n,t),p._.addCssClass(n,i),setTimeout(function(){p._.removeCssClass(n,i)},1e3)},500)},m.prototype.replaceContentsAfterRefresh=function(){p._.removeAllChildren(this.eParentOfValue),this.cellRenderer&&this.cellRenderer.destroy&&this.cellRenderer.destroy(),this.cellRenderer=null,this.cellRendererGui=null,this.putDataIntoCellAfterRefresh(),this.angular1Compile()},m.prototype.angular1Compile=function(){if(this.beans.gridOptionsWrapper.isAngularCompileRows()){var e=this.getGui(),t=this.beans.$compile(e)(this.scope);this.addDestroyFunc(function(){t.remove()})}},m.prototype.postProcessStylesFromColDef=function(){var e=this.processStylesFromColDef();e&&p._.addStylesToElement(this.getGui(),e)},m.prototype.preProcessStylesFromColDef=function(){var e=this.processStylesFromColDef();return p._.cssStyleObjectToMarkup(e)},m.prototype.processStylesFromColDef=function(){var e=this.column.getColDef();if(e.cellStyle){var t=void 0;if("function"==typeof e.cellStyle){var i={value:this.value,data:this.rowNode.data,node:this.rowNode,colDef:e,column:this.column,$scope:this.scope,context:this.beans.gridOptionsWrapper.getContext(),api:this.beans.gridOptionsWrapper.getApi()};t=(0,e.cellStyle)(i)}else t=e.cellStyle;return t}},m.prototype.postProcessClassesFromColDef=function(){var t=this;this.processClassesFromColDef(function(e){return p._.addCssClass(t.getGui(),e)})},m.prototype.preProcessClassesFromColDef=function(){var t=[];return this.processClassesFromColDef(function(e){return t.push(e)}),t},m.prototype.processClassesFromColDef=function(e){this.beans.stylingService.processStaticCellClasses(this.column.getColDef(),{value:this.value,data:this.rowNode.data,node:this.rowNode,colDef:this.column.getColDef(),rowIndex:this.rowNode.rowIndex,$scope:this.scope,api:this.beans.gridOptionsWrapper.getApi(),context:this.beans.gridOptionsWrapper.getContext()},e)},m.prototype.putDataIntoCellAfterRefresh=function(){var e=this.column.getColDef();if(e.template)this.eParentOfValue.innerHTML=e.template;else if(e.templateUrl){var t=this.beans.templateService.getTemplate(e.templateUrl,this.refreshCell.bind(this,!0));t&&(this.eParentOfValue.innerHTML=t)}else if(this.usingCellRenderer)this.attachCellRenderer();else{var i=this.getValueToUse();null!=i&&(this.eParentOfValue.innerText=i)}},m.prototype.attemptCellRendererRefresh=function(){if(p._.missing(this.cellRenderer)||p._.missing(this.cellRenderer.refresh))return!1;var e=this.createCellRendererParams(),t=this.cellRenderer.refresh(e);return!0===t||void 0===t},m.prototype.refreshToolTip=function(){var e=this.getToolTip();if(this.tooltip!==e)if(this.tooltip=e,p._.exists(e)){var t=p._.escape(this.tooltip);this.eParentOfValue.setAttribute("title",t)}else this.eParentOfValue.removeAttribute("title")},m.prototype.valuesAreEqual=function(e,t){var i=this.column.getColDef(),n=i?i.equals:null;return n?n(e,t):e===t},m.prototype.getToolTip=function(){var e=this.column.getColDef(),t=this.rowNode.data;return e.tooltipField&&p._.exists(t)?p._.getValueUsingField(t,e.tooltipField,this.column.isTooltipFieldContainsDots()):e.tooltip?e.tooltip({value:this.value,valueFormatted:this.valueFormatted,data:this.rowNode.data,node:this.rowNode,colDef:this.column.getColDef(),api:this.beans.gridOptionsWrapper.getApi(),$scope:this.scope,context:this.beans.gridOptionsWrapper.getContext(),rowIndex:this.gridCell.rowIndex}):null},m.prototype.processCellClassRules=function(e,t){this.beans.stylingService.processClassRules(this.column.getColDef().cellClassRules,{value:this.value,data:this.rowNode.data,node:this.rowNode,colDef:this.column.getColDef(),rowIndex:this.gridCell.rowIndex,api:this.beans.gridOptionsWrapper.getApi(),$scope:this.scope,context:this.beans.gridOptionsWrapper.getContext()},e,t)},m.prototype.postProcessCellClassRules=function(){var t=this;this.processCellClassRules(function(e){p._.addCssClass(t.getGui(),e)},function(e){p._.removeCssClass(t.getGui(),e)})},m.prototype.preProcessCellClassRules=function(){var t=[];return this.processCellClassRules(function(e){t.push(e)},function(e){}),t},m.prototype.setUsingWrapper=function(){var e=this.column.getColDef();if(this.rowNode.rowPinned)return this.usingWrapper=!1,this.includeSelectionComponent=!1,void(this.includeRowDraggingComponent=!1);var t="function"==typeof e.checkboxSelection,i="function"==typeof e.rowDrag;this.includeSelectionComponent=t||!0===e.checkboxSelection,this.includeRowDraggingComponent=i||!0===e.rowDrag,this.usingWrapper=this.includeRowDraggingComponent||this.includeSelectionComponent},m.prototype.chooseCellRenderer=function(){var e=this.column.getColDef();if(e.template||e.templateUrl)this.usingCellRenderer=!1;else{var t=this.createCellRendererParams(),i=this.beans.componentResolver.getComponentToUse(e,"cellRenderer",t,null);this.beans.componentResolver.getComponentToUse(e,"pinnedRowCellRenderer",t,null)&&this.rowNode.rowPinned?(this.cellRendererType="pinnedRowCellRenderer",this.usingCellRenderer=!0):i?(this.cellRendererType="cellRenderer",this.usingCellRenderer=!0):this.usingCellRenderer=!1}},m.prototype.createCellRendererInstance=function(){var e=this.createCellRendererParams();this.cellRendererVersion++;var t=this.afterCellRendererCreated.bind(this,this.cellRendererVersion);this.beans.componentResolver.createAgGridComponent(this.column.getColDef(),e,this.cellRendererType,e,null).then(t)},m.prototype.afterCellRendererCreated=function(e,t){e===this.cellRendererVersion?(this.cellRenderer=t,this.cellRendererGui=this.cellRenderer.getGui(),p._.missing(this.cellRendererGui)||this.editingCell||this.eParentOfValue.appendChild(this.cellRendererGui)):t.destroy&&t.destroy()},m.prototype.attachCellRenderer=function(){this.usingCellRenderer&&this.createCellRendererInstance()},m.prototype.createCellRendererParams=function(){var i=this;return{value:this.value,valueFormatted:this.valueFormatted,getValue:this.getValue.bind(this),setValue:function(e){i.beans.valueService.setValue(i.rowNode,i.column,e)},formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,colDef:this.column.getColDef(),column:this.column,$scope:this.scope,rowIndex:this.gridCell.rowIndex,api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),context:this.beans.gridOptionsWrapper.getContext(),refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.eParentOfValue,addRowCompListener:this.rowComp?this.rowComp.addEventListener.bind(this.rowComp):null,addRenderedRowListener:function(e,t){console.warn("ag-Grid: since ag-Grid .v11, params.addRenderedRowListener() is now params.addRowCompListener()"),i.rowComp&&i.rowComp.addEventListener(e,t)}}},m.prototype.formatValue=function(e){var t=this.beans.valueFormatterService.formatValue(this.column,this.rowNode,this.scope,e);return null!=t?t:e},m.prototype.getValueToUse=function(){return null!==this.valueFormatted&&void 0!==this.valueFormatted?this.valueFormatted:this.value},m.prototype.getValueAndFormat=function(){this.value=this.getValue(),this.valueFormatted=this.beans.valueFormatterService.formatValue(this.column,this.rowNode,this.scope,this.value)},m.prototype.getValue=function(){var e=this.rowNode.leafGroup&&this.beans.columnController.isPivotMode();return this.rowNode.group&&this.rowNode.expanded&&!this.rowNode.footer&&!e&&this.beans.gridOptionsWrapper.isGroupIncludeFooter()?this.beans.valueService.getValue(this.column,this.rowNode,!1,!0):this.beans.valueService.getValue(this.column,this.rowNode)},m.prototype.onMouseEvent=function(e,t){if(!p._.isStopPropagationForAgGrid(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t)}},m.prototype.dispatchCellContextMenuEvent=function(e){var t=this.column.getColDef(),i=this.createEvent(e,c.Events.EVENT_CELL_CONTEXT_MENU);this.beans.eventService.dispatchEvent(i),t.onCellContextMenu&&setTimeout(function(){return t.onCellContextMenu(i)},0)},m.prototype.createEvent=function(e,t){var i={node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),context:this.beans.gridOptionsWrapper.getContext(),api:this.beans.gridApi,columnApi:this.beans.columnApi,rowPinned:this.rowNode.rowPinned,event:e,type:t,rowIndex:this.rowNode.rowIndex};return this.scope&&(i.$scope=this.scope),i},m.prototype.onMouseOut=function(e){var t=this.createEvent(e,c.Events.EVENT_CELL_MOUSE_OUT);this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.clearMouseOver()},m.prototype.onMouseOver=function(e){var t=this.createEvent(e,c.Events.EVENT_CELL_MOUSE_OVER);this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.setMouseOver([this.column])},m.prototype.onCellDoubleClicked=function(e){var t=this.column.getColDef(),i=this.createEvent(e,c.Events.EVENT_CELL_DOUBLE_CLICKED);this.beans.eventService.dispatchEvent(i),"function"==typeof t.onCellDoubleClicked&&setTimeout(function(){return t.onCellDoubleClicked(i)},0),this.beans.gridOptionsWrapper.isSingleClickEdit()||this.beans.gridOptionsWrapper.isSuppressClickEdit()||this.startRowOrCellEdit()},m.prototype.startRowOrCellEdit=function(e,t){this.beans.gridOptionsWrapper.isFullRowEdit()?this.rowComp.startRowEditing(e,t,this):this.startEditingIfEnabled(e,t,!0)},m.prototype.isCellEditable=function(){return this.column.isCellEditable(this.rowNode)},m.prototype.startEditingIfEnabled=function(e,t,i){if(void 0===e&&(e=null),void 0===t&&(t=null),void 0===i&&(i=!1),this.isCellEditable()&&!this.editingCell){this.editingCell=!0,this.cellEditorVersion++;var n=this.afterCellEditorCreated.bind(this,this.cellEditorVersion),o=this.createCellEditorParams(e,t,i);this.beans.cellEditorFactory.createCellEditor(this.column.getColDef(),o).then(n),p._.missing(this.cellEditor)&&i&&this.focusCell(!0)}},m.prototype.afterCellEditorCreated=function(e,t){if(e===this.cellEditorVersion&&this.editingCell){if(t.isCancelBeforeStart&&t.isCancelBeforeStart())return t.destroy&&t.destroy(),void(this.editingCell=!1);if(!t.getGui)return console.warn("ag-Grid: cellEditor for column "+this.column.getId()+" is missing getGui() method"),t.render&&console.warn("ag-Grid: we found 'render' on the component, are you trying to set a React renderer but added it as colDef.cellEditor instead of colDef.cellEditorFmk?"),t.destroy&&t.destroy(),void(this.editingCell=!1);this.cellEditor=t,this.cellEditorInPopup=t.isPopup&&t.isPopup(),this.setInlineEditingClass(),this.cellEditorInPopup?this.addPopupCellEditor():this.addInCellEditor(),t.afterGuiAttached&&t.afterGuiAttached();var i=this.createEvent(null,c.Events.EVENT_CELL_EDITING_STARTED);this.beans.eventService.dispatchEvent(i)}else t.destroy&&t.destroy()},m.prototype.addInCellEditor=function(){p._.removeAllChildren(this.getGui()),this.getGui().appendChild(this.cellEditor.getGui()),this.angular1Compile()},m.prototype.addPopupCellEditor=function(){var e=this,t=this.cellEditor.getGui();this.hideEditorPopup=this.beans.popupService.addAsModalPopup(t,!0,function(){e.onPopupEditorClosed()}),this.beans.popupService.positionPopupOverComponent({column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),ePopup:t,keepWithinBounds:!0}),this.angular1Compile()},m.prototype.onPopupEditorClosed=function(){this.editingCell&&(this.stopRowOrCellEdit(),this.beans.focusedCellController.isCellFocused(this.gridCell)&&this.focusCell(!0))},m.prototype.setInlineEditingClass=function(){var e=this.editingCell&&!this.cellEditorInPopup,t=this.editingCell&&this.cellEditorInPopup;p._.addOrRemoveCssClass(this.getGui(),"ag-cell-inline-editing",e),p._.addOrRemoveCssClass(this.getGui(),"ag-cell-not-inline-editing",!e),p._.addOrRemoveCssClass(this.getGui(),"ag-cell-popup-editing",t),p._.addOrRemoveCssClass(this.getGui().parentNode,"ag-row-inline-editing",e),p._.addOrRemoveCssClass(this.getGui().parentNode,"ag-row-not-inline-editing",!e)},m.prototype.createCellEditorParams=function(e,t,i){return{value:this.getValue(),keyPress:e,charPress:t,column:this.column,rowIndex:this.gridCell.rowIndex,node:this.rowNode,api:this.beans.gridOptionsWrapper.getApi(),cellStartedEdit:i,columnApi:this.beans.gridOptionsWrapper.getColumnApi(),context:this.beans.gridOptionsWrapper.getContext(),$scope:this.scope,onKeyDown:this.onKeyDown.bind(this),stopEditing:this.stopEditingAndFocus.bind(this),eGridCell:this.getGui(),parseValue:this.parseValue.bind(this),formatValue:this.formatValue.bind(this)}},m.prototype.stopEditingAndFocus=function(e){void 0===e&&(e=!1),this.stopRowOrCellEdit(),this.focusCell(!0),e||this.navigateAfterEdit()},m.prototype.parseValue=function(e){var t={node:this.rowNode,data:this.rowNode.data,oldValue:this.value,newValue:e,colDef:this.column.getColDef(),column:this.column,api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),context:this.beans.gridOptionsWrapper.getContext()},i=this.column.getColDef().valueParser;return p._.exists(i)?this.beans.expressionService.evaluate(i,t):e},m.prototype.focusCell=function(e){void 0===e&&(e=!1),this.beans.focusedCellController.setFocusedCell(this.gridCell.rowIndex,this.column,this.rowNode.rowPinned,e)},m.prototype.setFocusInOnEditor=function(){this.editingCell&&(this.cellEditor&&this.cellEditor.focusIn?this.cellEditor.focusIn():this.focusCell(!0))},m.prototype.isEditing=function(){return this.editingCell},m.prototype.onKeyDown=function(e){var t=e.which||e.keyCode;if(!this.doesUserWantToCancelKeyboardEvent(e))switch(t){case l.Constants.KEY_ENTER:this.onEnterKeyDown();break;case l.Constants.KEY_F2:this.onF2KeyDown();break;case l.Constants.KEY_ESCAPE:this.onEscapeKeyDown();break;case l.Constants.KEY_TAB:this.onTabKeyDown(e);break;case l.Constants.KEY_BACKSPACE:case l.Constants.KEY_DELETE:this.onBackspaceOrDeleteKeyPressed(t);break;case l.Constants.KEY_DOWN:case l.Constants.KEY_UP:case l.Constants.KEY_RIGHT:case l.Constants.KEY_LEFT:this.onNavigationKeyPressed(e,t)}},m.prototype.doesUserWantToCancelKeyboardEvent=function(e){var t=this.column.getColDef().suppressKeyboardEvent;return!p._.missing(t)&&t({event:e,editing:this.editingCell,column:this.column,api:this.beans.gridOptionsWrapper.getApi(),node:this.rowNode,data:this.rowNode.data,colDef:this.column.getColDef(),context:this.beans.gridOptionsWrapper.getContext(),columnApi:this.beans.gridOptionsWrapper.getColumnApi()})},m.prototype.setFocusOutOnEditor=function(){this.editingCell&&this.cellEditor&&this.cellEditor.focusOut&&this.cellEditor.focusOut()},m.prototype.onNavigationKeyPressed=function(e,t){this.editingCell&&this.stopRowOrCellEdit(),e.shiftKey&&this.rangeSelectionEnabled?this.onShiftRangeSelect(t):this.beans.rowRenderer.navigateToNextCell(e,t,this.gridCell,!0),e.preventDefault()},m.prototype.onShiftRangeSelect=function(e){if(this.beans.rangeController.extendRangeInDirection(this.gridCell,e)){var t=this.beans.rangeController.getCellRanges();if(!p._.missing(t)&&1===t.length){var i=t[0].end;this.beans.rowRenderer.ensureCellVisible(i)}}},m.prototype.onTabKeyDown=function(e){this.beans.gridOptionsWrapper.isSuppressTabbing()||this.beans.rowRenderer.onTabKeyDown(this,e)},m.prototype.onBackspaceOrDeleteKeyPressed=function(e){this.editingCell||this.startRowOrCellEdit(e)},m.prototype.onEnterKeyDown=function(){this.editingCell||this.rowComp.isEditing()?this.stopEditingAndFocus():this.beans.gridOptionsWrapper.isEnterMovesDown()?this.beans.rowRenderer.navigateToNextCell(null,l.Constants.KEY_DOWN,this.gridCell,!1):this.startRowOrCellEdit(l.Constants.KEY_ENTER)},m.prototype.navigateAfterEdit=function(){this.beans.gridOptionsWrapper.isFullRowEdit()||this.beans.gridOptionsWrapper.isEnterMovesDownAfterEdit()&&this.beans.rowRenderer.navigateToNextCell(null,l.Constants.KEY_DOWN,this.gridCell,!1)},m.prototype.onF2KeyDown=function(){this.editingCell||this.startRowOrCellEdit(l.Constants.KEY_F2)},m.prototype.onEscapeKeyDown=function(){this.editingCell&&(this.stopRowOrCellEdit(!0),this.focusCell(!0))},m.prototype.onKeyPress=function(e){if(p._.getTarget(e)===this.getGui()&&!this.editingCell){var t=String.fromCharCode(e.charCode);" "===t?this.onSpaceKeyPressed(e):p._.isEventFromPrintableCharacter(e)&&(this.startRowOrCellEdit(null,t),e.preventDefault())}},m.prototype.onSpaceKeyPressed=function(e){if(!this.editingCell&&this.beans.gridOptionsWrapper.isRowSelection()){var t=this.rowNode.isSelected();this.rowNode.setSelected(!t)}e.preventDefault()},m.prototype.onMouseDown=function(e){if(this.focusCell(!1),this.beans.rangeController){var t=this.gridCell;if(e.shiftKey)this.beans.rangeController.extendRangeToCell(t);else if(!this.beans.rangeController.isCellInAnyRange(t)){var i=e.ctrlKey||e.metaKey;this.beans.rangeController.setRangeToCell(t,i)}}var n=this.createEvent(e,c.Events.EVENT_CELL_MOUSE_DOWN);this.beans.eventService.dispatchEvent(n)},m.prototype.isDoubleClickOnIPad=function(){if(!p._.isUserAgentIPad())return!1;var e=(new Date).getTime(),t=e-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=e,t},m.prototype.onCellClicked=function(e){if(this.isDoubleClickOnIPad())return this.onCellDoubleClicked(e),void e.preventDefault();var t=this.createEvent(e,c.Events.EVENT_CELL_CLICKED);this.beans.eventService.dispatchEvent(t);var i=this.column.getColDef();i.onCellClicked&&setTimeout(function(){return i.onCellClicked(t)},0),this.beans.gridOptionsWrapper.isSingleClickEdit()&&!this.beans.gridOptionsWrapper.isSuppressClickEdit()&&this.startRowOrCellEdit(),this.doIeFocusHack()},m.prototype.doIeFocusHack=function(){(p._.isBrowserIE()||p._.isBrowserEdge())&&(!p._.missing(document.activeElement)&&document.activeElement!==document.body||this.getGui().focus())},m.prototype.createGridCellVo=function(){var e={rowIndex:this.rowNode.rowIndex,floating:this.rowNode.rowPinned,column:this.column};this.gridCell=new u.GridCell(e)},m.prototype.getGridCell=function(){return this.gridCell},m.prototype.getParentRow=function(){return this.eParentRow},m.prototype.setParentRow=function(e){this.eParentRow=e},m.prototype.getColumn=function(){return this.column},m.prototype.detach=function(){this.eParentRow.removeChild(this.getGui())},m.prototype.destroy=function(){s.prototype.destroy.call(this),this.cellEditor&&this.cellEditor.destroy&&(this.cellEditor.destroy(),this.cellEditor=null),this.cellRenderer&&this.cellRenderer.destroy&&(this.cellRenderer.destroy(),this.cellRenderer=null)},m.prototype.onLeftChanged=function(){var e=this.getCellLeft();this.getGui().style.left=e+"px"},m.prototype.onWidthChanged=function(){var e=this.getCellWidth();this.getGui().style.width=e+"px"},m.prototype.getRangeClasses=function(){var e=[];return this.rangeSelectionEnabled&&(0!==this.rangeCount&&e.push("ag-cell-range-selected"),1===this.rangeCount&&e.push("ag-cell-range-selected-1"),2===this.rangeCount&&e.push("ag-cell-range-selected-2"),3===this.rangeCount&&e.push("ag-cell-range-selected-3"),4<=this.rangeCount&&e.push("ag-cell-range-selected-4")),e},m.prototype.onRowIndexChanged=function(){this.createGridCellVo(),this.onCellFocused(),this.onRangeSelectionChanged()},m.prototype.onRangeSelectionChanged=function(){if(this.beans.enterprise){var e=this.beans.rangeController.getCellRangeCount(this.gridCell),t=this.getGui();this.rangeCount!==e&&(p._.addOrRemoveCssClass(t,"ag-cell-range-selected",0!==e),p._.addOrRemoveCssClass(t,"ag-cell-range-selected-1",1===e),p._.addOrRemoveCssClass(t,"ag-cell-range-selected-2",2===e),p._.addOrRemoveCssClass(t,"ag-cell-range-selected-3",3===e),p._.addOrRemoveCssClass(t,"ag-cell-range-selected-4",4<=e),this.rangeCount=e)}},m.prototype.onFirstRightPinnedChanged=function(){var e=this.column.isFirstRightPinned();this.firstRightPinned!==e&&(this.firstRightPinned=e,p._.addOrRemoveCssClass(this.getGui(),"ag-cell-first-right-pinned",e))},m.prototype.onLastLeftPinnedChanged=function(){var e=this.column.isLastLeftPinned();this.lastLeftPinned!==e&&(this.lastLeftPinned=e,p._.addOrRemoveCssClass(this.getGui(),"ag-cell-last-left-pinned",e))},m.prototype.populateTemplate=function(){this.usingWrapper?(this.eParentOfValue=this.getRefElement("eCellValue"),this.eCellWrapper=this.getRefElement("eCellWrapper"),this.includeRowDraggingComponent&&this.addRowDragging(),this.includeSelectionComponent&&this.addSelectionCheckbox()):this.eParentOfValue=this.getGui()},m.prototype.addRowDragging=function(){if(this.beans.gridOptionsWrapper.isRowModelDefault())if(this.beans.gridOptionsWrapper.isPagination())p._.doOnce(function(){return console.warn("ag-Grid: row dragging is not possible when doing pagination")},"CellComp.addRowDragging");else{var e=new f.RowDragComp(this.rowNode,this.column,this.getValueToUse(),this.beans);this.addFeature(this.beans.context,e),this.eCellWrapper.insertBefore(e.getGui(),this.eParentOfValue)}else p._.doOnce(function(){return console.warn("ag-Grid: row dragging is only allowed in the In Memory Row Model")},"CellComp.addRowDragging")},m.prototype.addSelectionCheckbox=function(){var e=new h.CheckboxSelectionComponent;this.beans.context.wireBean(e);var t=this.column.getColDef().checkboxSelection;t="function"==typeof t?t:null,e.init({rowNode:this.rowNode,column:this.column,visibleFunc:t}),this.addDestroyFunc(function(){return e.destroy()}),this.eCellWrapper.insertBefore(e.getGui(),this.eParentOfValue)},m.prototype.addDomData=function(){var e=this,t=this.getGui();this.beans.gridOptionsWrapper.setDomData(t,m.DOM_DATA_KEY_CELL_COMP,this),this.addDestroyFunc(function(){return e.beans.gridOptionsWrapper.setDomData(t,m.DOM_DATA_KEY_CELL_COMP,null)})},m.prototype.onCellFocused=function(e){var t=this.beans.focusedCellController.isCellFocused(this.gridCell);t!==this.cellFocused&&(this.beans.gridOptionsWrapper.isSuppressCellSelection()||(p._.addOrRemoveCssClass(this.getGui(),"ag-cell-focus",t),p._.addOrRemoveCssClass(this.getGui(),"ag-cell-no-focus",!t)),this.cellFocused=t),t&&e&&e.forceBrowserFocus&&this.getGui().focus();var i=this.beans.gridOptionsWrapper.isFullRowEdit();t||i||!this.editingCell||this.stopRowOrCellEdit()},m.prototype.stopRowOrCellEdit=function(e){void 0===e&&(e=!1),this.beans.gridOptionsWrapper.isFullRowEdit()?this.rowComp.stopRowEditing(e):this.stopEditing(e)},m.prototype.stopEditing=function(e){if(void 0===e&&(e=!1),this.editingCell)if(this.cellEditor){var t,i=!1;if(e||this.cellEditor.isCancelAfterEnd&&this.cellEditor.isCancelAfterEnd()||(t=this.cellEditor.getValue(),i=!0),this.editingCell=!1,this.cellEditor.destroy&&this.cellEditor.destroy(),this.cellEditor=null,this.cellEditorInPopup)this.hideEditorPopup(),this.hideEditorPopup=null;else if(p._.removeAllChildren(this.getGui()),this.usingWrapper)this.getGui().appendChild(this.eCellWrapper);else if(this.cellRenderer){var n=this.cellRendererGui;n&&this.getGui().appendChild(n)}this.setInlineEditingClass(),i&&(this.rowNode.setDataValue(this.column,t),this.getValueAndFormat()),this.refreshCell({forceRefresh:!0,suppressFlash:!0});var o=this.createEvent(null,c.Events.EVENT_CELL_EDITING_STOPPED);this.beans.eventService.dispatchEvent(o)}else this.editingCell=!1},m.DOM_DATA_KEY_CELL_COMP="cellComp",m);function m(e,t,i,n,o,r){var a=s.call(this)||this;return a.editingCell=!1,a.cellEditorVersion=0,a.cellRendererVersion=0,a.scope=e,a.beans=t,a.column=i,a.rowNode=n,a.rowComp=o,a.autoHeightCell=r,a.createGridCellVo(),a.rangeSelectionEnabled=t.enterprise&&t.gridOptionsWrapper.isEnableRangeSelection(),a.cellFocused=a.beans.focusedCellController.isCellFocused(a.gridCell),a.firstRightPinned=a.column.isFirstRightPinned(),a.lastLeftPinned=a.column.isLastLeftPinned(),a.rangeSelectionEnabled&&(a.rangeCount=a.beans.rangeController.getCellRangeCount(a.gridCell)),a.getValueAndFormat(),a.setUsingWrapper(),a.chooseCellRenderer(),a.setupColSpan(),a.rowSpan=a.column.getRowSpan(a.rowNode),a}t.CellComp=g},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var p=i(1),f=i(9),r=i(0),a=i(42),s=i(2),l=i(41),c=(u.prototype.getPopupParent=function(){var e=this.gridOptionsWrapper.getPopupParent();return e||this.gridCore.getRootGui()},u.prototype.positionPopupForMenu=function(e){var t=e.eventSource.getBoundingClientRect(),i=this.getPopupParent().getBoundingClientRect(),n=t.top-i.top;n=this.keepYWithinBounds(e,n);var o,r=0<e.ePopup.clientWidth?e.ePopup.clientWidth:200,a=i.right-i.left-r;function s(){return t.right-i.left-2}function l(){return t.left-i.left-r}this.gridOptionsWrapper.isEnableRtl()?((o=l())<0&&(o=s()),a<o&&(o=0)):(a<(o=s())&&(o=l()),o<0&&(o=0)),e.ePopup.style.left=o+"px",e.ePopup.style.top=n+"px"},u.prototype.positionPopupUnderMouseEvent=function(e){var t=this.getPopupParent().getBoundingClientRect();this.positionPopup({ePopup:e.ePopup,x:e.mouseEvent.clientX-t.left,y:e.mouseEvent.clientY-t.top,keepWithinBounds:!0}),this.callPostProcessPopup(e.ePopup,null,e.mouseEvent,e.type,e.column,e.rowNode)},u.prototype.positionPopupUnderComponent=function(e){var t=e.eventSource.getBoundingClientRect(),i=this.getPopupParent().getBoundingClientRect();this.positionPopup({ePopup:e.ePopup,minWidth:e.minWidth,nudgeX:e.nudgeX,nudgeY:e.nudgeY,x:t.left-i.left,y:t.top-i.top+t.height,keepWithinBounds:e.keepWithinBounds}),this.callPostProcessPopup(e.ePopup,e.eventSource,null,e.type,e.column,e.rowNode)},u.prototype.callPostProcessPopup=function(e,t,i,n,o,r){var a=this.gridOptionsWrapper.getPostProcessPopupFunc();a&&a({column:o,rowNode:r,ePopup:e,type:n,eventSource:t,mouseEvent:i})},u.prototype.positionPopupOverComponent=function(e){var t=e.eventSource.getBoundingClientRect(),i=this.getPopupParent().getBoundingClientRect();this.positionPopup({ePopup:e.ePopup,minWidth:e.minWidth,nudgeX:e.nudgeX,nudgeY:e.nudgeY,x:t.left-i.left,y:t.top-i.top,keepWithinBounds:e.keepWithinBounds}),this.callPostProcessPopup(e.ePopup,e.eventSource,null,e.type,e.column,e.rowNode)},u.prototype.positionPopup=function(e){var t=e.x,i=e.y;e.nudgeX&&(t+=e.nudgeX),e.nudgeY&&(i+=e.nudgeY),e.keepWithinBounds&&(t=this.keepXWithinBounds(e,t),i=this.keepYWithinBounds(e,i)),e.ePopup.style.left=t+"px",e.ePopup.style.top=i+"px"},u.prototype.keepYWithinBounds=function(e,t){var i,n=this.getPopupParent().getBoundingClientRect();i=0<e.ePopup.clientHeight?e.ePopup.clientHeight:200;var o=n.bottom-n.top-i-5;return o<t?o:t<0?0:t},u.prototype.keepXWithinBounds=function(e,t){var i,n=this.getPopupParent().getBoundingClientRect();i=0<e.minWidth?e.minWidth:0<e.ePopup.clientWidth?e.ePopup.clientWidth:200;var o=n.right-n.left-i-5;return o<t?o:t<0?0:t},u.prototype.addAsModalPopup=function(i,e,n,o){var r=this,a=this.gridOptionsWrapper.getDocument();if(a){if(i.style.top="0px",i.style.left="0px",!p.Utils.isVisible(i)){var s=this.getPopupParent(),l=document.createElement("div");p.Utils.addCssClass(l,this.environment.getTheme()),l.appendChild(i),s.appendChild(l),this.activePopupElements.push(i);var c=!1,u=function(e){(e.which||e.keyCode)===f.Constants.KEY_ESCAPE&&t(null)},d=function(e){t(e)},h=function(e){t(null,e)},t=function(e,t){r.isEventFromCurrentPopup(e,t,i)||r.isEventSameChainAsOriginalEvent(o,e,t)||c||(c=!0,s.removeChild(l),p.Utils.removeFromArray(r.activePopupElements,i),a.removeEventListener("keydown",u),a.removeEventListener("click",d),a.removeEventListener("touchstart",h),a.removeEventListener("contextmenu",d),n&&n())};return setTimeout(function(){e&&a.addEventListener("keydown",u),a.addEventListener("click",d),a.addEventListener("touchstart",h),a.addEventListener("contextmenu",d)},0),t}}else console.warn("ag-grid: could not find the body of the document, document.body is empty")},u.prototype.isEventFromCurrentPopup=function(e,t,i){var n=e||t;if(n)for(var o=this.activePopupElements.indexOf(i);o<this.activePopupElements.length;o++){var r=this.activePopupElements[o];if(p.Utils.isElementInEventPath(r,n))return!0}return!1},u.prototype.isEventSameChainAsOriginalEvent=function(e,t,i){var n;if(t?n=t:i&&(n=i.touches[0]),n&&e){var o=Math.abs(e.screenX-t.screenX)<5,r=Math.abs(e.screenY-t.screenY)<5;if(o&&r)return!0}return!1},n([r.Autowired("gridCore"),o("design:type",a.GridCore)],u.prototype,"gridCore",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",s.GridOptionsWrapper)],u.prototype,"gridOptionsWrapper",void 0),n([r.Autowired("environment"),o("design:type",l.Environment)],u.prototype,"environment",void 0),u=n([r.Bean("popupService")],u));function u(){this.activePopupElements=[]}t.PopupService=c},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(3),s=i(5),l=i(4),c=i(7),u=i(6),d=i(2),h=(p.prototype.setScrollsVisible=function(e){if(this.bodyHorizontalScrollShowing!==e.bodyHorizontalScrollShowing||this.leftVerticalScrollShowing!==e.leftVerticalScrollShowing||this.rightVerticalScrollShowing!==e.rightVerticalScrollShowing){this.bodyHorizontalScrollShowing=e.bodyHorizontalScrollShowing,this.leftVerticalScrollShowing=e.leftVerticalScrollShowing,this.rightVerticalScrollShowing=e.rightVerticalScrollShowing;var t={type:s.Events.EVENT_SCROLL_VISIBILITY_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(t)}},p.prototype.isBodyHorizontalScrollShowing=function(){return this.bodyHorizontalScrollShowing},p.prototype.isLeftVerticalScrollShowing=function(){return this.leftVerticalScrollShowing},p.prototype.isRightVerticalScrollShowing=function(){return this.rightVerticalScrollShowing},n([r.Autowired("eventService"),o("design:type",a.EventService)],p.prototype,"eventService",void 0),n([r.Autowired("columnController"),o("design:type",l.ColumnController)],p.prototype,"columnController",void 0),n([r.Autowired("columnApi"),o("design:type",c.ColumnApi)],p.prototype,"columnApi",void 0),n([r.Autowired("gridApi"),o("design:type",u.GridApi)],p.prototype,"gridApi",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",d.GridOptionsWrapper)],p.prototype,"gridOptionsWrapper",void 0),p=n([r.Bean("scrollVisibleService")],p));function p(){}t.ScrollVisibleService=h},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(123),s=i(2),l=i(25),c=i(3),u=(d.prototype.registerGridComp=function(e){this.gridPanel=e},d.prototype.init=function(){this.useAnimationFrame=!this.gridOptionsWrapper.isSuppressAnimationFrame()},d.prototype.verifyAnimationFrameOn=function(e){!1===this.useAnimationFrame&&console.warn("ag-Grid: AnimationFrameService."+e+" called but animation frames are off")},d.prototype.addP1Task=function(e){this.verifyAnimationFrameOn("addP1Task"),this.p1Tasks.add(e),this.schedule()},d.prototype.addP2Task=function(e){this.verifyAnimationFrameOn("addP2Task"),this.p2Tasks.add(e),this.schedule()},d.prototype.executeFrame=function(e){this.verifyAnimationFrameOn("executeFrame");for(var t=(new Date).getTime(),i=(new Date).getTime()-t,n=!0,o=e<=0;o||i<e;){if(n)n=this.gridPanel.executeFrame();else if(this.p1Tasks.isEmpty()){if(this.p2Tasks.isEmpty())break;this.p2Tasks.remove()()}else this.p1Tasks.remove()();i=(new Date).getTime()-t}!n&&this.p1Tasks.isEmpty()&&this.p2Tasks.isEmpty()?this.stopTicking():this.requestFrame()},d.prototype.stopTicking=function(){this.ticking=!1;var e={type:l.Events.EVENT_ANIMATION_QUEUE_EMPTY,columnApi:this.gridOptionsWrapper.getColumnApi(),api:this.gridOptionsWrapper.getApi()};this.eventService.dispatchEvent(e)},d.prototype.flushAllFrames=function(){this.useAnimationFrame&&this.executeFrame(-1)},d.prototype.schedule=function(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))},d.prototype.requestFrame=function(){var e=this.executeFrame.bind(this,60);window.requestAnimationFrame?window.requestAnimationFrame(e):window.webkitRequestAnimationFrame?window.webkitRequestAnimationFrame(e):setTimeout(e,0)},d.prototype.isQueueEmpty=function(){return this.ticking},n([r.Autowired("gridOptionsWrapper"),o("design:type",s.GridOptionsWrapper)],d.prototype,"gridOptionsWrapper",void 0),n([r.Autowired("eventService"),o("design:type",c.EventService)],d.prototype,"eventService",void 0),n([r.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],d.prototype,"init",null),d=n([r.Bean("animationFrameService")],d));function d(){this.p1Tasks=new a.LinkedList,this.p2Tasks=new a.LinkedList,this.ticking=!1}t.AnimationFrameService=u},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(i,n){return function(e,t){n(e,t,i)}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(2),s=i(12),l=i(31),c=i(107),p=i(32),u=i(10),d=i(0),h=i(1),f=i(134),g=(m.prototype.setBeans=function(e){this.logger=e.create("BalancedColumnTreeBuilder")},m.prototype.createForAutoGroups=function(e,i){var n=this,o=[];return e.forEach(function(e){var t=n.createAutoGroupTreeItem(i,e);o.push(t)}),o},m.prototype.createAutoGroupTreeItem=function(e,t){for(var i=t,n=this.findDept(e)-1;0<=n;n--){var o=new p.OriginalColumnGroup(null,"FAKE_PATH_"+t.getId()+"}_"+n,!0,n);this.context.wireBean(o),o.setChildren([i]),i=o}return i},m.prototype.findDept=function(e){for(var t=0,i=e;i&&i[0]&&i[0]instanceof p.OriginalColumnGroup;)t++,i=i[0].getChildren();return t},m.prototype.createBalancedColumnGroups=function(e,t){var i=new c.ColumnKeyCreator,n=this.recursivelyCreateColumns(e,0,i,t),o=this.findMaxDept(n,0);this.logger.log("Number of levels for grouped columns is "+o);var r=this.balanceColumnTree(n,0,o,i);return this.columnUtils.depthFirstOriginalTreeSearch(r,function(e){e instanceof p.OriginalColumnGroup&&e.setupExpandable()}),{balancedTree:r,treeDept:o}},m.prototype.balanceColumnTree=function(e,l,c,u){var d=this,h=[];return e.forEach(function(e){if(e instanceof p.OriginalColumnGroup){var t=e,i=d.balanceColumnTree(t.getChildren(),l+1,c,u);t.setChildren(i),h.push(t)}else{for(var n=e,o=c-1;l<=o;o--){var r=u.getUniqueKey(null,null),a=d.createMergedColGroupDef(null),s=new p.OriginalColumnGroup(a,r,!0,l);d.context.wireBean(s),s.setChildren([n]),n=s}h.push(n)}}),h},m.prototype.findMaxDept=function(e,t){for(var i=t,n=0;n<e.length;n++){var o=e[n];if(o instanceof p.OriginalColumnGroup){var r=o,a=this.findMaxDept(r.getChildren(),t+1);i<a&&(i=a)}}return i},m.prototype.recursivelyCreateColumns=function(e,i,n,o){var r=this,a=[];return e&&e.forEach(function(e){var t;t=r.isColumnGroup(e)?r.createColumnGroup(n,o,e,i):r.createColumn(n,o,e),a.push(t)}),a},m.prototype.createColumnGroup=function(e,t,i,n){var o=this.createMergedColGroupDef(i),r=e.getUniqueKey(o.groupId,null),a=new p.OriginalColumnGroup(o,r,!1,n);this.context.wireBean(a);var s=this.recursivelyCreateColumns(o.children,n+1,e,t);return a.setChildren(s),a},m.prototype.createMergedColGroupDef=function(e){var t={};return h.Utils.assign(t,this.gridOptionsWrapper.getDefaultColGroupDef()),h.Utils.assign(t,e),this.checkForDeprecatedItems(t),t},m.prototype.createColumn=function(e,t,i){var n=this.mergeColDefs(i);this.checkForDeprecatedItems(n);var o=e.getUniqueKey(n.colId,n.field),r=new u.Column(n,o,t);return this.context.wireBean(r),r},m.prototype.mergeColDefs=function(e){var t={};return h.Utils.assign(t,this.gridOptionsWrapper.getDefaultColDef()),e.type&&this.assignColumnTypes(e,t),h.Utils.assign(t,e),t},m.prototype.assignColumnTypes=function(e,i){var t;if(e.type instanceof Array)e.type.some(function(e){return"string"!=typeof e})?console.warn("ag-grid: if colDef.type is supplied an array it should be of type 'string[]'"):t=e.type;else{if("string"!=typeof e.type)return void console.warn("ag-grid: colDef.type should be of type 'string' | 'string[]'");t=e.type.split(",")}var n=h.Utils.assign({},this.gridOptionsWrapper.getColumnTypes(),f.DefaultColumnTypes);t.forEach(function(e){var t=n[e.trim()];t?h.Utils.assign(i,t):console.warn("ag-grid: colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes")})},m.prototype.checkForDeprecatedItems=function(e){if(e){var t=e;void 0!==t.group&&console.warn("ag-grid: colDef.group is invalid, please check documentation on how to do grouping as it changed in version 3"),void 0!==t.headerGroup&&console.warn("ag-grid: colDef.headerGroup is invalid, please check documentation on how to do grouping as it changed in version 3"),void 0!==t.headerGroupShow&&console.warn("ag-grid: colDef.headerGroupShow is invalid, should be columnGroupShow, please check documentation on how to do grouping as it changed in version 3"),void 0!==t.suppressRowGroup&&console.warn("ag-grid: colDef.suppressRowGroup is deprecated, please use colDef.type instead"),void 0!==t.suppressAggregation&&console.warn("ag-grid: colDef.suppressAggregation is deprecated, please use colDef.type instead"),(t.suppressRowGroup||t.suppressAggregation)&&console.warn("ag-grid: colDef.suppressAggregation and colDef.suppressRowGroup are deprecated, use allowRowGroup, allowPivot and allowValue instead"),t.displayName&&(console.warn("ag-grid: Found displayName "+t.displayName+", please use headerName instead, displayName is deprecated."),t.headerName=t.displayName)}},m.prototype.isColumnGroup=function(e){return void 0!==e.children},n([d.Autowired("gridOptionsWrapper"),o("design:type",a.GridOptionsWrapper)],m.prototype,"gridOptionsWrapper",void 0),n([d.Autowired("columnUtils"),o("design:type",l.ColumnUtils)],m.prototype,"columnUtils",void 0),n([d.Autowired("context"),o("design:type",d.Context)],m.prototype,"context",void 0),n([r(0,d.Qualifier("loggerFactory")),o("design:type",Function),o("design:paramtypes",[s.LoggerFactory]),o("design:returntype",void 0)],m.prototype,"setBeans",null),m=n([d.Bean("balancedColumnTreeBuilder")],m));function m(){}t.BalancedColumnTreeBuilder=g},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(20),a=i(0),s=i(2),l=i(100),c=(u.prototype.registerGridComp=function(e){this.gridPanel=e},u.prototype.registerHeaderRootComp=function(e){this.headerRootComp=e},u.prototype.getPreferredWidthForColumn=function(e){var t=this.getHeaderCellForColumn(e);if(!t)return-1;var i=document.createElement("span");i.style.position="fixed";var n=this.gridPanel.getBodyContainer();n.appendChild(i),this.putRowCellsIntoDummyContainer(e,i),this.cloneItemIntoDummy(t,i);var o=i.offsetWidth;return n.removeChild(i),o+this.gridOptionsWrapper.getAutoSizePadding()},u.prototype.getHeaderCellForColumn=function(i){var n=null;return this.headerRootComp.forEachHeaderElement(function(e){if(e instanceof l.HeaderWrapperComp){var t=e;t.getColumn()===i&&(n=t)}}),n?n.getGui():null},u.prototype.putRowCellsIntoDummyContainer=function(e,t){var i=this;this.rowRenderer.getAllCellsForColumn(e).forEach(function(e){return i.cloneItemIntoDummy(e,t)})},u.prototype.cloneItemIntoDummy=function(e,t){var i=e.cloneNode(!0);i.style.width="",i.style.position="static",i.style.left="";var n=document.createElement("div");n.style.display="table-row",n.appendChild(i),t.appendChild(n)},n([a.Autowired("rowRenderer"),o("design:type",r.RowRenderer)],u.prototype,"rowRenderer",void 0),n([a.Autowired("gridOptionsWrapper"),o("design:type",s.GridOptionsWrapper)],u.prototype,"gridOptionsWrapper",void 0),u=n([a.Bean("autoWidthCalculator")],u));function u(){}t.AutoWidthCalculator=c},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(12),s=i(1),l=i(3),c=i(5),u=i(2),d=i(7),h=i(6),p=(f.prototype.init=function(){this.logger=this.loggerFactory.create("DragService")},f.prototype.destroy=function(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0},f.prototype.removeListener=function(e){var t=e.dragSource.eElement,i=e.mouseDownListener;if(t.removeEventListener("mousedown",i),e.touchEnabled){var n=e.touchStartListener;t.removeEventListener("touchstart",n,{passive:!0})}},f.prototype.removeDragSource=function(t){var e=s.Utils.find(this.dragSources,function(e){return e.dragSource===t});e&&(this.removeListener(e),s.Utils.removeFromArray(this.dragSources,e))},f.prototype.setNoSelectToBody=function(e){var t=this.gridOptionsWrapper.getDocument().querySelector("body");s.Utils.exists(t)&&s.Utils.addOrRemoveCssClass(t,"ag-body-no-select",e)},f.prototype.addDragSource=function(e,t){void 0===t&&(t=!1);var i=this.onMouseDown.bind(this,e);e.eElement.addEventListener("mousedown",i);var n=null,o=this.gridOptionsWrapper.isSuppressTouch();t&&!o&&(n=this.onTouchStart.bind(this,e),e.eElement.addEventListener("touchstart",n,{passive:!1})),this.dragSources.push({dragSource:e,mouseDownListener:i,touchStartListener:n,touchEnabled:t})},f.prototype.onTouchStart=function(e,t){var i=this;this.currentDragParams=e,this.dragging=!1;var n=t.touches[0];this.touchLastTime=n,this.touchStart=n,t.preventDefault(),e.eElement.addEventListener("touchmove",this.onTouchMoveListener,{passive:!0}),e.eElement.addEventListener("touchend",this.onTouchEndListener,{passive:!0}),e.eElement.addEventListener("touchcancel",this.onTouchEndListener,{passive:!0}),this.dragEndFunctions.push(function(){e.eElement.removeEventListener("touchmove",i.onTouchMoveListener,{passive:!0}),e.eElement.removeEventListener("touchend",i.onTouchEndListener,{passive:!0}),e.eElement.removeEventListener("touchcancel",i.onTouchEndListener,{passive:!0})}),0===e.dragStartPixels&&this.onCommonMove(n,this.touchStart)},f.prototype.onMouseDown=function(e,t){var i=this;if(!(e.skipMouseEvent&&e.skipMouseEvent(t)||t._alreadyProcessedByDragService||(t._alreadyProcessedByDragService=!0,0!==t.button))){this.currentDragParams=e,this.dragging=!1,this.mouseEventLastTime=t,this.mouseStartEvent=t;var n=this.gridOptionsWrapper.getDocument();n.addEventListener("mousemove",this.onMouseMoveListener),n.addEventListener("mouseup",this.onMouseUpListener),this.dragEndFunctions.push(function(){n.removeEventListener("mousemove",i.onMouseMoveListener),n.removeEventListener("mouseup",i.onMouseUpListener)}),0===e.dragStartPixels&&this.onMouseMove(t)}},f.prototype.isEventNearStartEvent=function(e,t){var i=s.Utils.exists(this.currentDragParams.dragStartPixels)?this.currentDragParams.dragStartPixels:4;return s.Utils.areEventsNear(e,t,i)},f.prototype.getFirstActiveTouch=function(e){for(var t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null},f.prototype.onCommonMove=function(e,t){if(!this.dragging){if(!this.dragging&&this.isEventNearStartEvent(e,t))return;this.dragging=!0;var i={type:c.Events.EVENT_DRAG_STARTED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(i),this.currentDragParams.onDragStart(t),this.setNoSelectToBody(!0)}this.currentDragParams.onDragging(e)},f.prototype.onTouchMove=function(e){var t=this.getFirstActiveTouch(e.touches);t&&this.onCommonMove(t,this.touchStart)},f.prototype.onMouseMove=function(e){this.onCommonMove(e,this.mouseStartEvent)},f.prototype.onTouchUp=function(e){var t=this.getFirstActiveTouch(e.changedTouches);t=t||this.touchLastTime,this.onUpCommon(t)},f.prototype.onMouseUp=function(e){this.onUpCommon(e)},f.prototype.onUpCommon=function(e){if(this.dragging){this.dragging=!1,this.currentDragParams.onDragStop(e);var t={type:c.Events.EVENT_DRAG_STOPPED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(t)}this.setNoSelectToBody(!1),this.mouseStartEvent=null,this.mouseEventLastTime=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach(function(e){return e()}),this.dragEndFunctions.length=0},n([r.Autowired("loggerFactory"),o("design:type",a.LoggerFactory)],f.prototype,"loggerFactory",void 0),n([r.Autowired("eventService"),o("design:type",l.EventService)],f.prototype,"eventService",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",u.GridOptionsWrapper)],f.prototype,"gridOptionsWrapper",void 0),n([r.Autowired("columnApi"),o("design:type",d.ColumnApi)],f.prototype,"columnApi",void 0),n([r.Autowired("gridApi"),o("design:type",h.GridApi)],f.prototype,"gridApi",void 0),n([r.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],f.prototype,"init",null),n([r.PreDestroy,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],f.prototype,"destroy",null),f=n([r.Bean("dragService")],f));function f(){this.onMouseUpListener=this.onMouseUp.bind(this),this.onMouseMoveListener=this.onMouseMove.bind(this),this.onTouchEndListener=this.onTouchUp.bind(this),this.onTouchMoveListener=this.onTouchMove.bind(this),this.dragEndFunctions=[],this.dragSources=[]}t.DragService=p},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=["fresh","dark","blue","bootstrap","material","balham-dark","balham"],s=a.concat(a.map(function(e){return"theme-"+e})),l=new RegExp("ag-("+s.join("|")+")"),c={"ag-theme-material":{headerHeight:56,virtualItemHeight:40,rowHeight:48},"ag-theme-classic":{headerHeight:25,virtualItemHeight:20,rowHeight:25},"ag-theme-balham":{headerHeight:32,virtualItemHeight:28,rowHeight:28}},u=(d.prototype.loadSassVariables=function(){},d.prototype.getSassVariable=function(e,t){return"ag-theme-material"==e?c["ag-theme-material"][t]:"ag-theme-balham"==e||"ag-theme-balham-dark"==e?c["ag-theme-balham"][t]:c["ag-theme-classic"][t]},d.prototype.getTheme=function(){for(var e,t=this.eGridDiv;t!=document.documentElement&&null==e&&(e=t.className.match(l),null!=(t=t.parentElement)););return e?e[0]:"ag-fresh"},n([r.Autowired("eGridDiv"),o("design:type",HTMLElement)],d.prototype,"eGridDiv",void 0),d=n([r.Bean("environment")],d));function d(){this.sassVariables={}}t.Environment=u},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l,c=i(2),u=i(7),d=i(4),h=i(20),p=i(18),f=i(3),g=i(78),m=i(12),v=i(35),y=i(1),b=i(0),w=i(22),C=i(8),_=i(6),A=i(11),E=(s=C.Component,o(x,s),(l=x).prototype.init=function(){var t=this;this.logger=this.loggerFactory.create("GridCore");var e=this.enterprise?l.TEMPLATE_ENTERPRISE:l.TEMPLATE_NORMAL;if(this.setTemplate(e),this.instantiate(this.context),this.enterprise&&(this.toolPanelComp.registerGridComp(this.gridPanel),this.statusBar.registerGridPanel(this.gridPanel)),this.gridOptionsWrapper.addEventListener(c.GridOptionsWrapper.PROP_GRID_AUTO_HEIGHT,this.addLayoutClass.bind(this)),this.addLayoutClass(),this.showToolPanel(this.gridOptionsWrapper.isShowToolPanel()),this.eGridDiv.appendChild(this.getGui()),this.addDestroyFunc(function(){t.eGridDiv.removeChild(t.getGui())}),this.$scope){var i=this.$scope.$watch(this.quickFilterOnScope,function(e){return t.filterManager.setQuickFilter(e)});this.addDestroyFunc(i)}this.addRtlSupport(),this.finished=!1,this.addDestroyFunc(function(){return t.finished=!0}),this.logger.log("ready")},x.prototype.addLayoutClass=function(){var e=this.gridOptionsWrapper.isGridAutoHeight();this.addOrRemoveCssClass("ag-layout-auto-height",e),this.addOrRemoveCssClass("ag-layout-normal",!e),this.addOrRemoveCssClass("ag-scrolls",!e)},x.prototype.getPreferredWidth=function(){return this.columnController.getBodyContainerWidth()+this.columnController.getPinnedLeftContainerWidth()+this.columnController.getPinnedRightContainerWidth()+(this.toolPanelComp?this.toolPanelComp.getPreferredWidth():0)},x.prototype.addRtlSupport=function(){var e=this.gridOptionsWrapper.isEnableRtl()?"ag-rtl":"ag-ltr";y.Utils.addCssClass(this.getGui(),e)},x.prototype.getRootGui=function(){return this.getGui()},x.prototype.showToolPanel=function(e){this.toolPanelComp?this.toolPanelComp.showToolPanel(e):e&&console.warn("ag-Grid: toolPanel is only available in ag-Grid Enterprise")},x.prototype.isToolPanelShowing=function(){return this.toolPanelComp.isToolPanelShowing()},x.prototype.destroy=function(){s.prototype.destroy.call(this),this.logger.log("Grid DOM removed")},x.prototype.ensureNodeVisible=function(e,t){if(void 0===t&&(t="top"),this.doingVirtualPaging)throw"Cannot use ensureNodeVisible when doing virtual paging, as we cannot check rows that are not in memory";for(var i=this.rowModel.getPageLastRow()+1,n="function"==typeof e,o=-1,r=0;r<i;r++){var a=this.rowModel.getRow(r);if(n){if(e(a)){o=r;break}}else if(e===a||e===a.data){o=r;break}}0<=o&&this.gridPanel.ensureIndexVisible(o,t)},x.TEMPLATE_NORMAL='<div class="ag-root-wrapper">\n            <div class="ag-root-wrapper-body">\n                <ag-grid-comp ref="gridPanel"></ag-grid-comp>\n            </div>\n            <ag-pagination></ag-pagination>\n        </div>',x.TEMPLATE_ENTERPRISE='<div class="ag-root-wrapper">\n            <ag-header-column-drop></ag-header-column-drop>\n            <div class="ag-root-wrapper-body">\n                <ag-grid-comp ref="gridPanel"></ag-grid-comp>\n                <ag-tool-panel ref="toolPanel"></ag-tool-panel>\n            </div>\n            <ag-status-bar ref="statusBar"></ag-status-bar>\n            <ag-pagination></ag-pagination>\n        </div>',r([b.Autowired("enterprise"),a("design:type",Boolean)],x.prototype,"enterprise",void 0),r([b.Autowired("gridOptions"),a("design:type",Object)],x.prototype,"gridOptions",void 0),r([b.Autowired("gridOptionsWrapper"),a("design:type",c.GridOptionsWrapper)],x.prototype,"gridOptionsWrapper",void 0),r([b.Autowired("rowModel"),a("design:type",Object)],x.prototype,"rowModel",void 0),r([b.Autowired("frameworkFactory"),a("design:type",Object)],x.prototype,"frameworkFactory",void 0),r([b.Autowired("columnController"),a("design:type",d.ColumnController)],x.prototype,"columnController",void 0),r([b.Autowired("rowRenderer"),a("design:type",h.RowRenderer)],x.prototype,"rowRenderer",void 0),r([b.Autowired("filterManager"),a("design:type",p.FilterManager)],x.prototype,"filterManager",void 0),r([b.Autowired("eventService"),a("design:type",f.EventService)],x.prototype,"eventService",void 0),r([b.Autowired("eGridDiv"),a("design:type",HTMLElement)],x.prototype,"eGridDiv",void 0),r([b.Autowired("$scope"),a("design:type",Object)],x.prototype,"$scope",void 0),r([b.Autowired("quickFilterOnScope"),a("design:type",String)],x.prototype,"quickFilterOnScope",void 0),r([b.Autowired("popupService"),a("design:type",v.PopupService)],x.prototype,"popupService",void 0),r([b.Autowired("focusedCellController"),a("design:type",w.FocusedCellController)],x.prototype,"focusedCellController",void 0),r([b.Autowired("context"),a("design:type",b.Context)],x.prototype,"context",void 0),r([b.Autowired("loggerFactory"),a("design:type",m.LoggerFactory)],x.prototype,"loggerFactory",void 0),r([b.Autowired("columnApi"),a("design:type",u.ColumnApi)],x.prototype,"columnApi",void 0),r([b.Autowired("gridApi"),a("design:type",_.GridApi)],x.prototype,"gridApi",void 0),r([b.Optional("rowGroupCompFactory"),a("design:type",Object)],x.prototype,"rowGroupCompFactory",void 0),r([b.Optional("pivotCompFactory"),a("design:type",Object)],x.prototype,"pivotCompFactory",void 0),r([A.RefSelector("statusBar"),a("design:type",Object)],x.prototype,"statusBar",void 0),r([A.RefSelector("gridPanel"),a("design:type",g.GridPanel)],x.prototype,"gridPanel",void 0),r([A.RefSelector("toolPanel"),a("design:type",Object)],x.prototype,"toolPanelComp",void 0),r([b.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],x.prototype,"init",null),r([b.PreDestroy,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],x.prototype,"destroy",null),x=l=r([b.Bean("gridCore"),a("design:paramtypes",[])],x));function x(){return s.call(this)||this}t.GridCore=E},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(2),s=i(19),l=(c.prototype.formatValue=function(e,t,i,n){var o,r=e.getColDef(),a=null;if(o=t&&t.rowPinned&&r.pinnedRowValueFormatter?r.pinnedRowValueFormatter:r.valueFormatter){var s={value:n,node:t,data:t?t.data:null,colDef:e.getColDef(),column:e,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext()};s.$scope=i,a=this.expressionService.evaluate(o,s)}else if(r.refData)return r.refData[n];return null==a&&Array.isArray(n)&&(a=n.join(", ")),a},n([r.Autowired("gridOptionsWrapper"),o("design:type",a.GridOptionsWrapper)],c.prototype,"gridOptionsWrapper",void 0),n([r.Autowired("expressionService"),o("design:type",s.ExpressionService)],c.prototype,"expressionService",void 0),c=n([r.Bean("valueFormatterService")],c));function c(){}t.ValueFormatterService=l},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r,a=i(0),s=i(0),l=i(1),c=i(2),u=i(34),d=((r=h).prototype.init=function(){this.stampDomElementWithGridInstance()},h.prototype.stampDomElementWithGridInstance=function(){this.eGridDiv[r.GRID_DOM_KEY]=this.gridInstanceId},h.prototype.getRenderedCellForEvent=function(e){for(var t=l.Utils.getTarget(e);t;){var i=this.gridOptionsWrapper.getDomData(t,u.CellComp.DOM_DATA_KEY_CELL_COMP);if(i)return i;t=t.parentElement}return null},h.prototype.isEventFromThisGrid=function(e){for(var t=l.Utils.getEventPath(e),i=0;i<t.length;i++){var n=t[i][r.GRID_DOM_KEY];if(l.Utils.exists(n))return n===this.gridInstanceId}return!1},h.prototype.getGridCellForEvent=function(e){var t=this.getRenderedCellForEvent(e);return t?t.getGridCell():null},h.gridInstanceSequence=new l.NumberSequence,h.GRID_DOM_KEY="__ag_grid_instance",n([s.Autowired("gridOptionsWrapper"),o("design:type",c.GridOptionsWrapper)],h.prototype,"gridOptionsWrapper",void 0),n([s.Autowired("eGridDiv"),o("design:type",HTMLElement)],h.prototype,"eGridDiv",void 0),n([a.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],h.prototype,"init",null),h=r=n([a.Bean("mouseEventService")],h));function h(){this.gridInstanceId=r.gridInstanceSequence.next()}t.MouseEventService=d},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(3),c=i(0),u=i(5),d=i(13),h=i(7),p=i(6),f=(s=d.BeanStub,o(g,s),g.prototype.setMouseOver=function(e){this.selectedColumns=e;var t={type:u.Events.EVENT_COLUMN_HOVER_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(t)},g.prototype.clearMouseOver=function(){this.selectedColumns=null;var e={type:u.Events.EVENT_COLUMN_HOVER_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(e)},g.prototype.isHovered=function(e){return this.selectedColumns&&0<=this.selectedColumns.indexOf(e)},r([c.Autowired("eventService"),a("design:type",l.EventService)],g.prototype,"eventService",void 0),r([c.Autowired("columnApi"),a("design:type",h.ColumnApi)],g.prototype,"columnApi",void 0),r([c.Autowired("gridApi"),a("design:type",p.GridApi)],g.prototype,"gridApi",void 0),g=r([c.Bean("columnHoverService")],g));function g(){return null!==s&&s.apply(this,arguments)||this}t.ColumnHoverService=f},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(3),n=i(1),o=(r.prototype.getActiveTouch=function(e){for(var t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null},r.prototype.addEventListener=function(e,t){this.eventService.addEventListener(e,t)},r.prototype.removeEventListener=function(e,t){this.eventService.removeEventListener(e,t)},r.prototype.onTouchStart=function(i){var n=this;if(!this.touching){this.touchStart=i.touches[0],this.touching=!0,this.moved=!1;var o=this.touchStart;setTimeout(function(){var e=n.touchStart===o;if(n.touching&&e&&!n.moved){n.moved=!0;var t={type:r.EVENT_LONG_TAP,touchStart:n.touchStart,touchEvent:i};n.eventService.dispatchEvent(t)}},500)}},r.prototype.onTouchMove=function(e){if(this.touching){var t=this.getActiveTouch(e.touches);t&&(n.Utils.areEventsNear(t,this.touchStart,4)||(this.moved=!0))}},r.prototype.onTouchEnd=function(e){if(this.touching){if(!this.moved){var t={type:r.EVENT_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(t),this.checkForDoubleTap(),this.preventMouseClick&&e.preventDefault()}this.touching=!1}},r.prototype.checkForDoubleTap=function(){var e=(new Date).getTime();if(0<this.lastTapTime){var t=e-this.lastTapTime;if(r.DOUBLE_TAP_MILLIS<t){var i={type:r.EVENT_DOUBLE_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(i),this.lastTapTime=null}else this.lastTapTime=e}else this.lastTapTime=e},r.prototype.destroy=function(){this.destroyFuncs.forEach(function(e){return e()})},r.EVENT_TAP="tap",r.EVENT_DOUBLE_TAP="doubleTap",r.EVENT_LONG_TAP="longTap",r.DOUBLE_TAP_MILLIS=500,r);function r(e,t){void 0===t&&(t=!1);var i=this;this.destroyFuncs=[],this.touching=!1,this.eventService=new a.EventService,this.eElement=e,this.preventMouseClick=t;var n=this.onTouchStart.bind(this),o=this.onTouchMove.bind(this),r=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",n,{passive:!0}),this.eElement.addEventListener("touchmove",o,{passive:!0}),this.eElement.addEventListener("touchend",r,{passive:!1}),this.destroyFuncs.push(function(){i.eElement.addEventListener("touchstart",n,{passive:!0}),i.eElement.addEventListener("touchmove",o,{passive:!0}),i.eElement.addEventListener("touchend",r,{passive:!1})})}t.TouchListener=o},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var l,s=i(0),c=i(63),u=i(84),d=i(4),h=i(16),p=i(2),f=i(9),g=i(1),m="\r\n",v=(l=c.BaseGridSerializingSession,o(y,l),y.prototype.prepare=function(e){},y.prototype.addCustomHeader=function(e){e&&(this.result+=e+m)},y.prototype.addCustomFooter=function(e){e&&(this.result+=e+m)},y.prototype.onNewHeaderGroupingRow=function(){return this.lineOpened&&(this.result+=m),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}},y.prototype.onNewHeaderGroupingRowColumn=function(e,t,i){0!=t&&(this.result+=this.columnSeparator),this.result+=e;for(var n=1;n<=i;n++)this.result+=this.columnSeparator+this.putInQuotes("",this.suppressQuotes);this.lineOpened=!0},y.prototype.onNewHeaderRow=function(){return this.lineOpened&&(this.result+=m),{onColumn:this.onNewHeaderRowColumn.bind(this)}},y.prototype.onNewHeaderRowColumn=function(e,t,i){0!=t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e),this.suppressQuotes),this.lineOpened=!0},y.prototype.onNewBodyRow=function(){return this.lineOpened&&(this.result+=m),{onColumn:this.onNewBodyRowColumn.bind(this)}},y.prototype.onNewBodyRowColumn=function(e,t,i){0!=t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractRowCellValue(e,t,f.Constants.EXPORT_TYPE_CSV,i),this.suppressQuotes),this.lineOpened=!0},y.prototype.putInQuotes=function(e,t){return t?e:null==e?'""':'"'+("string"==typeof e?e:"function"==typeof e.toString?e.toString():(console.warn("unknown value type during csv conversion"),"")).replace(/"/g,'""')+'"'},y.prototype.parse=function(){return this.result},y);function y(e,t,i,n,o,r,a){var s=l.call(this,e,t,i,n,o)||this;return s.suppressQuotes=r,s.columnSeparator=a,s.result="",s.lineOpened=!1,s}t.CsvSerializingSession=v;var b=(w.prototype.setBeans=function(e){this.beans=e},w.prototype.export=function(e){if(this.isExportSuppressed())return console.warn("ag-grid: Export canceled. Export is not allowed as per your configuration."),"";var t=this.getMergedParamsAndData(e),i=t.mergedParams,n=t.data,o=i&&i.fileName&&0!==i.fileName.length?i.fileName:this.getDefaultFileName();return-1===o.indexOf(".")&&(o=o+"."+this.getDefaultFileExtension()),this.beans.downloader.download(o,n,this.getMimeType()),n},w.prototype.getData=function(e){return this.getMergedParamsAndData(e).data},w.prototype.getMergedParamsAndData=function(e){var t=this.mergeDefaultParams(e);return{mergedParams:t,data:this.beans.gridSerializer.serialize(this.createSerializingSession(t),t)}},w.prototype.mergeDefaultParams=function(e){var t=this.beans.gridOptionsWrapper.getDefaultExportParams(),i={};return g._.assign(i,t),g._.assign(i,e),i},w);function w(){}t.BaseCreator=b;var C,_=(o(A,C=b),A.prototype.postConstruct=function(){this.setBeans({downloader:this.downloader,gridSerializer:this.gridSerializer,gridOptionsWrapper:this.gridOptionsWrapper})},A.prototype.exportDataAsCsv=function(e){return this.export(e)},A.prototype.getDataAsCsv=function(e){return this.getData(e)},A.prototype.getMimeType=function(){return"text/csv;charset=utf-8;"},A.prototype.getDefaultFileName=function(){return"export.csv"},A.prototype.getDefaultFileExtension=function(){return"csv"},A.prototype.createSerializingSession=function(e){return new v(this.columnController,this.valueService,this.gridOptionsWrapper,e?e.processCellCallback:null,e?e.processHeaderCallback:null,e&&e.suppressQuotes,e&&e.columnSeparator||",")},A.prototype.isExportSuppressed=function(){return this.gridOptionsWrapper.isSuppressCsvExport()},r([s.Autowired("columnController"),a("design:type",d.ColumnController)],A.prototype,"columnController",void 0),r([s.Autowired("valueService"),a("design:type",h.ValueService)],A.prototype,"valueService",void 0),r([s.Autowired("downloader"),a("design:type",u.Downloader)],A.prototype,"downloader",void 0),r([s.Autowired("gridSerializer"),a("design:type",c.GridSerializer)],A.prototype,"gridSerializer",void 0),r([s.Autowired("gridOptionsWrapper"),a("design:type",p.GridOptionsWrapper)],A.prototype,"gridOptionsWrapper",void 0),r([s.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],A.prototype,"postConstruct",null),A=r([s.Bean("csvCreator")],A));function A(){return null!==C&&C.apply(this,arguments)||this}t.CsvCreator=_},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(31),a=i(26),c=i(32),s=i(0),l=i(1),u=i(0),d=(h.prototype.createDisplayedGroups=function(e,a,s,t){var l,c,u=this,d=[],h=this.mapOldGroupsById(t);return e.forEach(function(e){for(var t=u.getOriginalPathForColumn(a,e),i=[],n=!c,o=0;o<t.length;o++)if(n||t[o]!==c[o]){var r=u.createColumnGroup(t[o],s,h);i[o]=r,0==o?d.push(r):i[o-1].addChild(r)}else i[o]=l[o];0===i.length?d.push(e):i[i.length-1].addChild(e),l=i,c=t}),this.setupParentsIntoColumns(d,null),d},h.prototype.createColumnGroup=function(e,t,i){var n=e.getGroupId(),o=t.getInstanceIdForKey(n),r=i[a.ColumnGroup.createUniqueId(n,o)];return r&&r.getOriginalColumnGroup()!==e&&(r=null),l.Utils.exists(r)?r.reset():(r=new a.ColumnGroup(e,n,o),this.context.wireBean(r)),r},h.prototype.mapOldGroupsById=function(e){var i={},n=function(e){e.forEach(function(e){if(e instanceof a.ColumnGroup){var t=e;i[e.getUniqueId()]=t,n(t.getChildren())}})};return e&&n(e),i},h.prototype.setupParentsIntoColumns=function(e,i){var n=this;e.forEach(function(e){if(e.setParent(i),e instanceof a.ColumnGroup){var t=e;n.setupParentsIntoColumns(t.getChildren(),t)}})},h.prototype.getOriginalPathForColumn=function(e,a){var s=[],l=!1;return function e(t,i){for(var n=0;n<t.length;n++){if(l)return;var o=t[n];if(o instanceof c.OriginalColumnGroup){var r=o;e(r.getChildren(),i+1),s[i]=o}else o===a&&(l=!0)}}(e,0),l?s:(console.log("could not get path"),null)},n([u.Autowired("columnUtils"),o("design:type",r.ColumnUtils)],h.prototype,"columnUtils",void 0),n([u.Autowired("context"),o("design:type",s.Context)],h.prototype,"context",void 0),h=n([s.Bean("displayedGroupCreator")],h));function h(){}t.DisplayedGroupCreator=d},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(0),s=(l.prototype.getTemplate=function(e,t){var i=this.templateCache[e];if(i)return i;var n=this.waitingCallbacks[e],o=this;if(!n){n=[],this.waitingCallbacks[e]=n;var r=new XMLHttpRequest;r.onload=function(){o.handleHttpResult(this,e)},r.open("GET",e),r.send()}return t&&n.push(t),null},l.prototype.handleHttpResult=function(e,t){if(200===e.status&&null!==e.response){this.templateCache[t]=e.response||e.responseText;for(var i=this.waitingCallbacks[t],n=0;n<i.length;n++)(0,i[n])();if(this.$scope){var o=this;setTimeout(function(){o.$scope.$apply()},0)}}else console.warn("Unable to get template error "+e.status+" - "+t)},n([a.Autowired("$scope"),o("design:type",Object)],l.prototype,"$scope",void 0),l=n([r.Bean("templateService")],l));function l(){this.templateCache={},this.waitingCallbacks={}}t.TemplateService=s},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,u=i(1),l=i(34),c=i(14),d=i(2),h=i(10),p=i(5),f=i(0),g=i(8),m=i(11),v=(s=g.Component,o(y,s),y.prototype.init=function(e){var t=u._.createIconNoSpan("groupLoading",this.gridOptionsWrapper,null);this.eLoadingIcon.appendChild(t);var i=this.gridOptionsWrapper.getLocaleTextFunc();this.eLoadingText.innerText=i("loadingOoo","Loading")},y.prototype.refresh=function(e){return!1},y.TEMPLATE='<div class="ag-stub-cell">\n            <span class="ag-loading-icon" ref="eLoadingIcon"></span>\n            <span class="ag-loading-text" ref="eLoadingText"></span>\n        </div>',r([f.Autowired("gridOptionsWrapper"),a("design:type",d.GridOptionsWrapper)],y.prototype,"gridOptionsWrapper",void 0),r([m.RefSelector("eLoadingIcon"),a("design:type",HTMLElement)],y.prototype,"eLoadingIcon",void 0),r([m.RefSelector("eLoadingText"),a("design:type",HTMLElement)],y.prototype,"eLoadingText",void 0),y);function y(){return s.call(this,y.TEMPLATE)||this}t.LoadingCellRenderer=v;var b,w=(b=g.Component,o(C,b),C.prototype.init=function(){var e=this;this.rowFocused=this.beans.focusedCellController.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.scope=this.createChildScopeOrNull(this.rowNode.data),this.setupRowContainers(),this.addListeners(),this.slideRowIn&&this.createSecondPassFuncs.push(function(){e.onTopChanged()}),this.fadeRowIn&&this.createSecondPassFuncs.push(function(){e.eAllRowContainers.forEach(function(e){return u._.removeCssClass(e,"ag-opacity-zero")})})},C.prototype.createTemplate=function(e,t){void 0===t&&(t=null);var i=[],n=this.rowNode.rowHeight,o=this.getInitialRowClasses(t).join(" "),r=u._.escape(this.rowNode.id),a=this.preProcessStylesFromGridOptions(),s=this.getRowBusinessKey(),l=u._.escape(s),c=this.getInitialRowTopStyle();return i.push("<div"),i.push(' role="row"'),i.push(' row-index="'+this.rowNode.getRowIndexString()+'"'),i.push(r?' row-id="'+r+'"':""),i.push(s?' row-business-key="'+l+'"':""),i.push(' comp-id="'+this.getCompId()+'"'),i.push(' class="'+o+'"'),i.push(' style="height: '+n+"px; "+c+" "+a+'">'),i.push(e),i.push("</div>"),i.join("")},C.prototype.getCellForCol=function(e){var t=this.cellComps[e.getColId()];return t?t.getGui():null},C.prototype.afterFlush=function(){this.initialised||(this.initialised=!0,this.executeProcessRowPostCreateFunc())},C.prototype.executeProcessRowPostCreateFunc=function(){var e=this.beans.gridOptionsWrapper.getProcessRowPostCreateFunc();e&&e({eRow:this.eBodyRow,ePinnedLeftRow:this.ePinnedLeftRow,ePinnedRightRow:this.ePinnedRightRow,node:this.rowNode,api:this.beans.gridOptionsWrapper.getApi(),rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),context:this.beans.gridOptionsWrapper.getContext()})},C.prototype.getInitialRowTopStyle=function(){var e=this.slideRowIn?this.roundRowTopToBounds(this.rowNode.oldRowTop):this.rowNode.rowTop,t=this.applyPaginationOffset(e),i=this.beans.heightScaler.getRealPixelPosition(t);return this.beans.gridOptionsWrapper.isSuppressRowTransform()?"top: "+i+"px; ":"transform: translateY("+i+"px); "},C.prototype.getRowBusinessKey=function(){if("function"==typeof this.beans.gridOptionsWrapper.getBusinessKeyForNodeFunc())return this.beans.gridOptionsWrapper.getBusinessKeyForNodeFunc()(this.rowNode)},C.prototype.lazyCreateCells=function(e,t){if(this.active){var i=this.createCells(e);t.innerHTML=i.template,this.callAfterRowAttachedOnCells(i.cellComps,t)}},C.prototype.createRowContainer=function(t,i,n){var o,r=this;o=this.useAnimationFrameForCreate?{cellComps:[],template:""}:this.createCells(i);var e=this.createTemplate(o.template);t.appendRowTemplate(e,function(){var e=t.getRowElement(r.getCompId());r.afterRowAttached(t,e),n(e),r.useAnimationFrameForCreate?r.beans.taskQueue.addP1Task(r.lazyCreateCells.bind(r,i,e)):r.callAfterRowAttachedOnCells(o.cellComps,e)})},C.prototype.createChildScopeOrNull=function(e){if(this.beans.gridOptionsWrapper.isAngularCompileRows()){var t=this.parentScope.$new();return t.data=e,t.rowNode=this.rowNode,t.context=this.beans.gridOptionsWrapper.getContext(),this.addDestroyFunc(function(){t.$destroy(),t.data=null,t.rowNode=null,t.context=null}),t}return null},C.prototype.setupRowContainers=function(){var e=this.beans.gridOptionsWrapper.getIsFullWidthCellFunc(),t=!!e&&e(this.rowNode),i=this.beans.doingMasterDetail&&this.rowNode.detail,n=this.rowNode.group&&this.beans.gridOptionsWrapper.isGroupUseEntireRow();this.rowNode.stub?this.createFullWidthRows(C.LOADING_CELL_RENDERER,C.LOADING_CELL_RENDERER_COMP_NAME):i?this.createFullWidthRows(C.DETAIL_CELL_RENDERER,C.DETAIL_CELL_RENDERER_COMP_NAME):t?this.createFullWidthRows(C.FULL_WIDTH_CELL_RENDERER,null):n?this.createFullWidthRows(C.GROUP_ROW_RENDERER,C.GROUP_ROW_RENDERER_COMP_NAME):this.setupNormalRowContainers()},C.prototype.setupNormalRowContainers=function(){var t=this,e=this.beans.columnController.getAllDisplayedCenterVirtualColumnsForRow(this.rowNode);this.createRowContainer(this.bodyContainerComp,e,function(e){return t.eBodyRow=e});var i=this.beans.columnController.getDisplayedLeftColumnsForRow(this.rowNode),n=this.beans.columnController.getDisplayedRightColumnsForRow(this.rowNode);this.createRowContainer(this.pinnedRightContainerComp,n,function(e){return t.ePinnedRightRow=e}),this.createRowContainer(this.pinnedLeftContainerComp,i,function(e){return t.ePinnedLeftRow=e})},C.prototype.createFullWidthRows=function(e,t){var i=this;this.fullWidthRow=!0,this.fullWidthRowEmbedded=this.beans.gridOptionsWrapper.isEmbedFullWidthRows(),this.fullWidthRowEmbedded?(this.createFullWidthRowContainer(this.bodyContainerComp,null,null,e,t,function(e){i.eFullWidthRowBody=e},function(e){i.fullWidthRowComponentBody=e}),this.createFullWidthRowContainer(this.pinnedLeftContainerComp,h.Column.PINNED_LEFT,"ag-cell-last-left-pinned",e,t,function(e){i.eFullWidthRowLeft=e},function(e){i.fullWidthRowComponentLeft=e}),this.createFullWidthRowContainer(this.pinnedRightContainerComp,h.Column.PINNED_RIGHT,"ag-cell-first-right-pinned",e,t,function(e){i.eFullWidthRowRight=e},function(e){i.fullWidthRowComponentRight=e})):this.createFullWidthRowContainer(this.fullWidthContainerComp,null,null,e,t,function(e){i.eFullWidthRow=e},function(e){i.fullWidthRowComponent=e})},C.prototype.setAnimateFlags=function(e){if(e){var t=u._.exists(this.rowNode.oldRowTop);this.slideRowIn=t,this.fadeRowIn=!t}else this.slideRowIn=!1,this.fadeRowIn=!1},C.prototype.isEditing=function(){return this.editingRow},C.prototype.stopRowEditing=function(e){this.stopEditing(e)},C.prototype.isFullWidth=function(){return this.fullWidthRow},C.prototype.addListeners=function(){this.addDestroyableEventListener(this.rowNode,c.RowNode.EVENT_HEIGHT_CHANGED,this.onRowHeightChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,c.RowNode.EVENT_ROW_SELECTED,this.onRowSelected.bind(this)),this.addDestroyableEventListener(this.rowNode,c.RowNode.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,c.RowNode.EVENT_TOP_CHANGED,this.onTopChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,c.RowNode.EVENT_EXPANDED_CHANGED,this.onExpandedChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,c.RowNode.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,c.RowNode.EVENT_CELL_CHANGED,this.onRowNodeCellChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,c.RowNode.EVENT_DRAGGING_CHANGED,this.onRowNodeDraggingChanged.bind(this));var e=this.beans.eventService;this.addDestroyableEventListener(e,p.Events.EVENT_HEIGHT_SCALE_CHANGED,this.onTopChanged.bind(this)),this.addDestroyableEventListener(e,p.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addDestroyableEventListener(e,p.Events.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addDestroyableEventListener(e,p.Events.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addDestroyableEventListener(e,p.Events.EVENT_CELL_FOCUSED,this.onCellFocusChanged.bind(this)),this.addDestroyableEventListener(e,p.Events.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addDestroyableEventListener(e,p.Events.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this))},C.prototype.onGridColumnsChanged=function(){var e=Object.keys(this.cellComps);this.removeRenderedCells(e)},C.prototype.onRowNodeDataChanged=function(t){this.forEachCellComp(function(e){return e.refreshCell({suppressFlash:!t.update,newData:!t.update})}),this.onRowSelected(),this.postProcessCss()},C.prototype.onRowNodeCellChanged=function(e){this.postProcessCss()},C.prototype.postProcessCss=function(){this.postProcessStylesFromGridOptions(),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()},C.prototype.onRowNodeDraggingChanged=function(){this.postProcessRowDragging()},C.prototype.postProcessRowDragging=function(){var t=this.rowNode.dragging;this.eAllRowContainers.forEach(function(e){return u._.addOrRemoveCssClass(e,"ag-row-dragging",t)})},C.prototype.onExpandedChanged=function(){if(this.rowNode.group&&!this.rowNode.footer){var t=this.rowNode.expanded;this.eAllRowContainers.forEach(function(e){return u._.addOrRemoveCssClass(e,"ag-row-group-expanded",t)}),this.eAllRowContainers.forEach(function(e){return u._.addOrRemoveCssClass(e,"ag-row-group-contracted",!t)})}},C.prototype.onDisplayedColumnsChanged=function(){this.fullWidthRow||this.refreshCells()},C.prototype.destroyFullWidthComponents=function(){this.fullWidthRowComponent&&(this.fullWidthRowComponent.destroy&&this.fullWidthRowComponent.destroy(),this.fullWidthRowComponent=null),this.fullWidthRowComponentBody&&(this.fullWidthRowComponentBody.destroy&&this.fullWidthRowComponentBody.destroy(),this.fullWidthRowComponent=null),this.fullWidthRowComponentLeft&&(this.fullWidthRowComponentLeft.destroy&&this.fullWidthRowComponentLeft.destroy(),this.fullWidthRowComponentLeft=null),this.fullWidthRowComponentRight&&(this.fullWidthRowComponentRight.destroy&&this.fullWidthRowComponentRight.destroy(),this.fullWidthRowComponent=null)},C.prototype.getContainerForCell=function(e){switch(e){case h.Column.PINNED_LEFT:return this.ePinnedLeftRow;case h.Column.PINNED_RIGHT:return this.ePinnedRightRow;default:return this.eBodyRow}},C.prototype.onVirtualColumnsChanged=function(){this.fullWidthRow||this.refreshCells()},C.prototype.onColumnResized=function(){this.fullWidthRow||this.refreshCells()},C.prototype.refreshCells=function(){if(this.beans.gridOptionsWrapper.isSuppressAnimationFrame())this.refreshCellsInAnimationFrame();else{if(this.columnRefreshPending)return;this.beans.taskQueue.addP1Task(this.refreshCellsInAnimationFrame.bind(this))}},C.prototype.refreshCellsInAnimationFrame=function(){if(this.active){this.columnRefreshPending=!1;var e=this.beans.columnController.getAllDisplayedCenterVirtualColumnsForRow(this.rowNode),t=this.beans.columnController.getDisplayedLeftColumnsForRow(this.rowNode),i=this.beans.columnController.getDisplayedRightColumnsForRow(this.rowNode);this.insertCellsIntoContainer(this.eBodyRow,e),this.insertCellsIntoContainer(this.ePinnedLeftRow,t),this.insertCellsIntoContainer(this.ePinnedRightRow,i);var n=Object.keys(this.cellComps);e.forEach(function(e){return u._.removeFromArray(n,e.getId())}),t.forEach(function(e){return u._.removeFromArray(n,e.getId())}),i.forEach(function(e){return u._.removeFromArray(n,e.getId())}),n=u._.filter(n,this.isCellEligibleToBeRemoved.bind(this)),this.removeRenderedCells(n)}},C.prototype.removeRenderedCells=function(e){var i=this;e.forEach(function(e){var t=i.cellComps[e];u._.missing(t)||(t.detach(),t.destroy(),i.cellComps[e]=null)})},C.prototype.isCellEligibleToBeRemoved=function(e){var t=this.beans.columnController.getAllDisplayedColumns(),i=this.cellComps[e];if(!i)return!0;if(this.isCellInWrongRow(i))return!0;var n=i.isEditing(),o=this.beans.focusedCellController.isCellFocused(i.getGridCell());if(n||o){var r=i.getColumn();return!(0<=t.indexOf(r))}return!0},C.prototype.ensureCellInCorrectContainer=function(e){var t=e.getGui(),i=e.getColumn().getPinned(),n=this.getContainerForCell(i),o=e.getParentRow();o!==n&&(o&&o.removeChild(t),n.appendChild(t),e.setParentRow(n))},C.prototype.isCellInWrongRow=function(e){var t=e.getColumn(),i=this.getContainerForCell(t.getPinned());return e.getParentRow()!==i},C.prototype.insertCellsIntoContainer=function(n,e){var o=this;if(n){var r=[],a=[];e.forEach(function(e){var t=e.getId(),i=o.cellComps[t];i?o.ensureCellInCorrectContainer(i):o.createNewCell(e,n,r,a)}),0<r.length&&(u._.appendHtml(n,r.join("")),this.callAfterRowAttachedOnCells(a,n))}},C.prototype.addDomData=function(e){var t=this.beans.gridOptionsWrapper;t.setDomData(e,C.DOM_DATA_KEY_RENDERED_ROW,this),this.addDestroyFunc(function(){t.setDomData(e,C.DOM_DATA_KEY_RENDERED_ROW,null)})},C.prototype.createNewCell=function(e,t,i,n){var o=new l.CellComp(this.scope,this.beans,e,this.rowNode,this,!1),r=o.getCreateTemplate();i.push(r),n.push(o),(this.cellComps[e.getId()]=o).setParentRow(t)},C.prototype.onMouseEvent=function(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t)}},C.prototype.createRowEvent=function(e,t){return{type:e,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,context:this.beans.gridOptionsWrapper.getContext(),api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),event:t}},C.prototype.createRowEventWithSource=function(e,t){var i=this.createRowEvent(e,t);return i.source=this,i},C.prototype.onRowDblClick=function(e){if(!u._.isStopPropagationForAgGrid(e)){var t=this.createRowEventWithSource(p.Events.EVENT_ROW_DOUBLE_CLICKED,e);this.beans.eventService.dispatchEvent(t)}},C.prototype.onRowClick=function(e){if(!u._.isStopPropagationForAgGrid(e)){var t=this.createRowEventWithSource(p.Events.EVENT_ROW_CLICKED,e);this.beans.eventService.dispatchEvent(t);var i=e.ctrlKey||e.metaKey,n=e.shiftKey;if(!this.rowNode.group&&!this.rowNode.rowPinned&&this.beans.gridOptionsWrapper.isRowSelection()&&!this.beans.gridOptionsWrapper.isSuppressRowClickSelection()){var o=this.beans.gridOptionsWrapper.isRowMultiSelectWithClick(),r=this.beans.gridOptionsWrapper.isRowDeselection();if(this.rowNode.isSelected())o?this.rowNode.setSelectedParams({newValue:!1}):i?r&&this.rowNode.setSelectedParams({newValue:!1}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!0});else{var a=!o&&!i;this.rowNode.setSelectedParams({newValue:!0,clearSelection:a,rangeSelect:n})}}}},C.prototype.createFullWidthRowContainer=function(t,n,e,o,r,a,s){var l=this,i=this.createTemplate("",e);t.appendRowTemplate(i,function(){var i=t.getRowElement(l.getCompId()),e=l.createFullWidthParams(i,n);l.beans.componentResolver.createAgGridComponent(null,e,o,e,r).then(function(e){if(l.isAlive()){var t=e.getGui();i.appendChild(t),s(e)}else e.destroy&&e.destroy()}),l.afterRowAttached(t,i),a(i),l.angular1Compile(i)})},C.prototype.angular1Compile=function(e){this.scope&&this.beans.$compile(e)(this.scope)},C.prototype.createFullWidthParams=function(e,t){return{fullWidth:!0,data:this.rowNode.data,node:this.rowNode,value:this.rowNode.key,$scope:this.scope,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),context:this.beans.gridOptionsWrapper.getContext(),eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this)}},C.prototype.getInitialRowClasses=function(e){var t=[];return u._.exists(e)&&t.push(e),t.push("ag-row"),t.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeRowIn&&t.push("ag-opacity-zero"),this.rowIsEven?t.push("ag-row-even"):t.push("ag-row-odd"),this.rowNode.isSelected()&&t.push("ag-row-selected"),this.rowNode.group?(t.push("ag-row-group"),t.push("ag-row-level-"+this.rowNode.level),this.rowNode.footer&&t.push("ag-row-footer")):this.rowNode.parent?t.push("ag-row-level-"+(this.rowNode.parent.level+1)):t.push("ag-row-level-0"),this.rowNode.stub&&t.push("ag-row-stub"),this.fullWidthRow&&t.push("ag-full-width-row"),this.rowNode.group&&!this.rowNode.footer&&t.push(this.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted"),this.rowNode.dragging&&t.push("ag-row-dragging"),u._.pushAll(t,this.processClassesFromGridOptions()),u._.pushAll(t,this.preProcessRowClassRules()),t},C.prototype.preProcessRowClassRules=function(){var t=[];return this.processRowClassRules(function(e){t.push(e)},function(e){}),t},C.prototype.processRowClassRules=function(e,t){this.beans.stylingService.processClassRules(this.beans.gridOptionsWrapper.rowClassRules(),{value:void 0,colDef:void 0,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsWrapper.getApi(),$scope:this.scope,context:this.beans.gridOptionsWrapper.getContext()},e,t)},C.prototype.stopEditing=function(t){if(void 0===t&&(t=!1),this.forEachCellComp(function(e){e.stopEditing(t)}),this.editingRow){if(!t){var e=this.createRowEvent(p.Events.EVENT_ROW_VALUE_CHANGED);this.beans.eventService.dispatchEvent(e)}this.setEditingRow(!1)}},C.prototype.setEditingRow=function(t){this.editingRow=t,this.eAllRowContainers.forEach(function(e){return u._.addOrRemoveCssClass(e,"ag-row-editing",t)});var e=t?this.createRowEvent(p.Events.EVENT_ROW_EDITING_STARTED):this.createRowEvent(p.Events.EVENT_ROW_EDITING_STOPPED);this.beans.eventService.dispatchEvent(e)},C.prototype.startRowEditing=function(i,n,o){void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),this.editingRow||(this.forEachCellComp(function(e){var t=e===o;t?e.startEditingIfEnabled(i,n,t):e.startEditingIfEnabled(null,null,t)}),this.setEditingRow(!0))},C.prototype.forEachCellComp=function(i){u._.iterateObject(this.cellComps,function(e,t){t&&i(t)})},C.prototype.postProcessClassesFromGridOptions=function(){var e=this,t=this.processClassesFromGridOptions();t&&t.forEach(function(t){e.eAllRowContainers.forEach(function(e){return u._.addCssClass(e,t)})})},C.prototype.postProcessRowClassRules=function(){var e=this;this.processRowClassRules(function(t){e.eAllRowContainers.forEach(function(e){return u._.addCssClass(e,t)})},function(t){e.eAllRowContainers.forEach(function(e){return u._.removeCssClass(e,t)})})},C.prototype.processClassesFromGridOptions=function(){function e(e){"string"==typeof e?t.push(e):Array.isArray(e)&&e.forEach(function(e){return t.push(e)})}var t=[],i=this.beans.gridOptionsWrapper.getRowClass();if(i){if("function"==typeof i)return void console.warn("ag-Grid: rowClass should not be a function, please use getRowClass instead");e(i)}var n=this.beans.gridOptionsWrapper.getRowClassFunc();return n&&e(n({node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,context:this.beans.gridOptionsWrapper.getContext(),api:this.beans.gridOptionsWrapper.getApi()})),t},C.prototype.preProcessStylesFromGridOptions=function(){var e=this.processStylesFromGridOptions();return u._.cssStyleObjectToMarkup(e)},C.prototype.postProcessStylesFromGridOptions=function(){var t=this.processStylesFromGridOptions();this.eAllRowContainers.forEach(function(e){return u._.addStylesToElement(e,t)})},C.prototype.processStylesFromGridOptions=function(){var e=this.beans.gridOptionsWrapper.getRowStyle();if(!e||"function"!=typeof e){var t,i=this.beans.gridOptionsWrapper.getRowStyleFunc();return i&&(t=i({data:this.rowNode.data,node:this.rowNode,api:this.beans.gridOptionsWrapper.getApi(),context:this.beans.gridOptionsWrapper.getContext(),$scope:this.scope})),u._.assign({},e,t)}console.log("ag-Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead")},C.prototype.createCells=function(e){var n=this,o=[],r=[];return e.forEach(function(e){var t=new l.CellComp(n.scope,n.beans,e,n.rowNode,n,!1),i=t.getCreateTemplate();o.push(i),r.push(t),n.cellComps[e.getId()]=t}),{template:o.join(""),cellComps:r}},C.prototype.onRowSelected=function(){var t=this.rowNode.isSelected();this.eAllRowContainers.forEach(function(e){return u._.addOrRemoveCssClass(e,"ag-row-selected",t)})},C.prototype.callAfterRowAttachedOnCells=function(e,t){var i=this;e.forEach(function(e){e.setParentRow(t),e.afterAttached(),i.editingRow&&e.startEditingIfEnabled()})},C.prototype.afterRowAttached=function(e,t){var i=this;this.addDomData(t),this.removeSecondPassFuncs.push(function(){e.removeRowElement(t)}),this.removeFirstPassFuncs.push(function(){if(u._.exists(i.rowNode.rowTop)){var e=i.roundRowTopToBounds(i.rowNode.rowTop);i.setRowTop(e)}else u._.addCssClass(t,"ag-opacity-zero")}),this.eAllRowContainers.push(t),this.useAnimationFrameForCreate?this.beans.taskQueue.addP1Task(this.addHoverFunctionality.bind(this,t)):this.addHoverFunctionality(t)},C.prototype.addHoverFunctionality=function(e){var t=this;this.active&&(this.addDestroyableEventListener(e,"mouseenter",function(){return t.rowNode.onMouseEnter()}),this.addDestroyableEventListener(e,"mouseleave",function(){return t.rowNode.onMouseLeave()}),this.addDestroyableEventListener(this.rowNode,c.RowNode.EVENT_MOUSE_ENTER,function(){t.beans.gridOptionsWrapper.isSuppressRowHoverHighlight()||u._.addCssClass(e,"ag-row-hover")}),this.addDestroyableEventListener(this.rowNode,c.RowNode.EVENT_MOUSE_LEAVE,function(){u._.removeCssClass(e,"ag-row-hover")}))},C.prototype.roundRowTopToBounds=function(e){var t=this.beans.gridPanel.getVScrollPosition(),i=this.applyPaginationOffset(t.top,!0)-100,n=this.applyPaginationOffset(t.bottom,!0)+100;return e<i?i:n<e?n:e},C.prototype.onRowHeightChanged=function(){if(u._.exists(this.rowNode.rowHeight)){var t=this.rowNode.rowHeight+"px";this.eAllRowContainers.forEach(function(e){return e.style.height=t})}},C.prototype.addEventListener=function(e,t){"renderedRowRemoved"!==e&&"rowRemoved"!==e||(e=p.Events.EVENT_VIRTUAL_ROW_REMOVED,console.warn("ag-Grid: Since version 11, event renderedRowRemoved is now called "+p.Events.EVENT_VIRTUAL_ROW_REMOVED)),b.prototype.addEventListener.call(this,e,t)},C.prototype.removeEventListener=function(e,t){"renderedRowRemoved"!==e&&"rowRemoved"!==e||(e=p.Events.EVENT_VIRTUAL_ROW_REMOVED,console.warn("ag-Grid: Since version 11, event renderedRowRemoved and rowRemoved is now called "+p.Events.EVENT_VIRTUAL_ROW_REMOVED)),b.prototype.removeEventListener.call(this,e,t)},C.prototype.destroy=function(e){void 0===e&&(e=!1),b.prototype.destroy.call(this),this.active=!1,this.destroyFullWidthComponents(),e?(this.removeFirstPassFuncs.forEach(function(e){return e()}),this.removeSecondPassFuncs.push(this.destroyContainingCells.bind(this))):(this.destroyContainingCells(),this.getAndClearDelayedDestroyFunctions().forEach(function(e){return e()}));var t=this.createRowEvent(p.Events.EVENT_VIRTUAL_ROW_REMOVED);this.dispatchEvent(t),this.beans.eventService.dispatchEvent(t)},C.prototype.destroyContainingCells=function(){this.forEachCellComp(function(e){return e.destroy()}),this.destroyFullWidthComponents()},C.prototype.getAndClearDelayedDestroyFunctions=function(){var e=this.removeSecondPassFuncs;return this.removeSecondPassFuncs=[],e},C.prototype.onCellFocusChanged=function(){var t=this.beans.focusedCellController.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.eAllRowContainers.forEach(function(e){return u._.addOrRemoveCssClass(e,"ag-row-focus",t)}),this.eAllRowContainers.forEach(function(e){return u._.addOrRemoveCssClass(e,"ag-row-no-focus",!t)}),this.rowFocused=t),!t&&this.editingRow&&this.stopEditing(!1)},C.prototype.onPaginationChanged=function(){var e=this.beans.paginationProxy.getCurrentPage();this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged())},C.prototype.onTopChanged=function(){this.setRowTop(this.rowNode.rowTop)},C.prototype.applyPaginationOffset=function(e,t){if(void 0===t&&(t=!1),this.rowNode.isRowPinned())return e;var i=this.beans.paginationProxy.getPixelOffset();return t?e+i:e-i},C.prototype.setRowTop=function(e){if(u._.exists(e)){var t=this.applyPaginationOffset(e),i=this.beans.heightScaler.getRealPixelPosition(t)+"px";this.beans.gridOptionsWrapper.isSuppressRowTransform()?this.eAllRowContainers.forEach(function(e){return e.style.top=i}):this.eAllRowContainers.forEach(function(e){return e.style.transform="translateY("+i+")"})}},C.prototype.getAndClearNextVMTurnFunctions=function(){var e=this.createSecondPassFuncs;return this.createSecondPassFuncs=[],e},C.prototype.getRowNode=function(){return this.rowNode},C.prototype.getRenderedCellForColumn=function(e){return this.cellComps[e.getColId()]},C.prototype.onRowIndexChanged=function(){this.onCellFocusChanged(),this.updateRowIndexes()},C.prototype.updateRowIndexes=function(){var t=this.rowNode.getRowIndexString(),i=this.rowNode.rowIndex%2==0,n=this.rowIsEven!==i;n&&(this.rowIsEven=i),this.eAllRowContainers.forEach(function(e){e.setAttribute("row-index",t),n&&(u._.addOrRemoveCssClass(e,"ag-row-even",i),u._.addOrRemoveCssClass(e,"ag-row-odd",!i))})},C.prototype.ensureDomOrder=function(){var e=this.getBodyRowElement();e&&this.bodyContainerComp.ensureDomOrder(e);var t=this.getPinnedLeftRowElement();t&&this.pinnedLeftContainerComp.ensureDomOrder(t);var i=this.getPinnedRightRowElement();i&&this.pinnedRightContainerComp.ensureDomOrder(i);var n=this.getFullWidthRowElement();n&&this.fullWidthContainerComp.ensureDomOrder(n)},C.prototype.getPinnedLeftRowElement=function(){return this.ePinnedLeftRow?this.ePinnedLeftRow:this.eFullWidthRowLeft},C.prototype.getPinnedRightRowElement=function(){return this.ePinnedRightRow?this.ePinnedRightRow:this.eFullWidthRowRight},C.prototype.getBodyRowElement=function(){return this.eBodyRow?this.eBodyRow:this.eFullWidthRowBody},C.prototype.getFullWidthRowElement=function(){return this.eFullWidthRow},C.DOM_DATA_KEY_RENDERED_ROW="renderedRow",C.FULL_WIDTH_CELL_RENDERER="fullWidthCellRenderer",C.GROUP_ROW_RENDERER="groupRowRenderer",C.GROUP_ROW_RENDERER_COMP_NAME="agGroupRowRenderer",C.LOADING_CELL_RENDERER="loadingCellRenderer",C.LOADING_CELL_RENDERER_COMP_NAME="agLoadingCellRenderer",C.DETAIL_CELL_RENDERER="detailCellRenderer",C.DETAIL_CELL_RENDERER_COMP_NAME="agDetailCellRenderer",C);function C(e,t,i,n,o,r,a,s,l){var c=b.call(this)||this;return c.eAllRowContainers=[],c.active=!0,c.columnRefreshPending=!1,c.cellComps={},c.createSecondPassFuncs=[],c.removeFirstPassFuncs=[],c.removeSecondPassFuncs=[],c.initialised=!1,c.parentScope=e,c.beans=a,c.bodyContainerComp=t,c.pinnedLeftContainerComp=i,c.pinnedRightContainerComp=n,c.fullWidthContainerComp=o,c.rowNode=r,c.rowIsEven=c.rowNode.rowIndex%2==0,c.paginationPage=c.beans.paginationProxy.getCurrentPage(),c.useAnimationFrameForCreate=l,c.setAnimateFlags(s),c}t.RowComp=w},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var c,s,l=i(8),u=i(11),d=i(0),h=i(2),p=i(1);(s=c=t.FilterConditionType||(t.FilterConditionType={}))[s.MAIN=0]="MAIN",s[s.CONDITION=1]="CONDITION";var f,g={loadingOoo:"Loading...",equals:"Equals",notEqual:"Not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"In range",lessThanOrEqual:"Less than or equals",greaterThanOrEqual:"Greater than or equals",filterOoo:"Filter...",contains:"Contains",notContains:"Not contains",startsWith:"Starts with",endsWith:"Ends with",searchOoo:"Search...",selectAll:"Select All",applyFilter:"Apply Filter",clearFilter:"Clear Filter"},m=(f=l.Component,o(v,f),v.prototype.init=function(e){this.filterParams=e,this.defaultFilter=this.filterParams.defaultOption,this.filterParams.filterOptions&&!this.defaultFilter&&this.filterParams.filterOptions.lastIndexOf(v.EQUALS)<0&&(this.defaultFilter=this.filterParams.filterOptions[0]),this.customInit(),this.filter=this.defaultFilter,this.filterCondition=this.defaultFilter,this.clearActive=!0===e.clearButton,this.applyActive=!0===e.applyButton||!0===e.apply,this.newRowsActionKeep="keep"===e.newRowsAction,this.setTemplate(this.generateTemplate()),p._.setVisible(this.eApplyButton,this.applyActive),this.applyActive&&this.addDestroyableEventListener(this.eApplyButton,"click",this.filterParams.filterChangedCallback),p._.setVisible(this.eClearButton,this.clearActive),this.clearActive&&this.addDestroyableEventListener(this.eClearButton,"click",this.onClearButton.bind(this));var t=this.applyActive||this.clearActive;p._.setVisible(this.eButtonsPanel,t),this.instantiate(this.context),this.initialiseFilterBodyUi(c.MAIN),this.refreshFilterBodyUi(c.MAIN)},v.prototype.onClearButton=function(){this.setModel(null),this.onFilterChanged()},v.prototype.floatingFilter=function(e){if(""!==e){var t=this.modelFromFloatingFilter(e);this.setModel(t)}else this.resetState();this.onFilterChanged()},v.prototype.onNewRowsLoaded=function(){this.newRowsActionKeep||this.resetState()},v.prototype.getModel=function(){return this.isFilterActive()?this.isFilterConditionActive(c.CONDITION)?{condition1:this.serialize(c.MAIN),condition2:this.serialize(c.CONDITION),operator:this.conditionValue}:this.serialize(c.MAIN):null},v.prototype.getNullableModel=function(){return this.isFilterConditionActive(c.CONDITION)?{condition1:this.serialize(c.MAIN),condition2:this.serialize(c.CONDITION),operator:this.conditionValue}:this.serialize(c.MAIN)},v.prototype.setModel=function(e){if(e)if(e.operator){var t=e;this.parse(t.condition1,c.MAIN),this.parse(t.condition2,c.CONDITION),this.conditionValue=t.operator}else this.resetState(),this.parse(e,c.MAIN);else this.resetState();this.redrawCondition(),this.refreshFilterBodyUi(c.MAIN),this.refreshFilterBodyUi(c.CONDITION)},v.prototype.doOnFilterChanged=function(e){void 0===e&&(e=!1),this.filterParams.filterModifiedCallback();var t=this.applyActive&&e,i=!this.applyActive||t;return i&&this.filterParams.filterChangedCallback(),this.refreshFilterBodyUi(c.MAIN),this.refreshFilterBodyUi(c.CONDITION),i},v.prototype.onFilterChanged=function(e){void 0===e&&(e=!1),this.doOnFilterChanged(e),this.redrawCondition(),this.refreshFilterBodyUi(c.MAIN),this.refreshFilterBodyUi(c.CONDITION)},v.prototype.redrawCondition=function(){var e=this,t=this.eFilterBodyWrapper.querySelector(".ag-filter-condition");if(!t&&this.isFilterActive()&&this.acceptsBooleanLogic()){this.eConditionWrapper=p._.loadTemplate(this.createConditionTemplate(c.CONDITION)),this.eFilterBodyWrapper.appendChild(this.eConditionWrapper),this.wireQuerySelectors();var i=this.refreshOperatorUi(),n=i.andButton,o=i.orButton;this.addDestroyableEventListener(n,"change",function(){e.conditionValue="AND",e.onFilterChanged()}),this.addDestroyableEventListener(o,"change",function(){e.conditionValue="OR",e.onFilterChanged()}),this.initialiseFilterBodyUi(c.CONDITION)}else t&&!this.isFilterActive()?(this.eFilterBodyWrapper.removeChild(this.eConditionWrapper),this.eConditionWrapper=null):(this.refreshFilterBodyUi(c.CONDITION),this.eConditionWrapper&&this.refreshOperatorUi())},v.prototype.refreshOperatorUi=function(){var e=this.eConditionWrapper.querySelector(".and"),t=this.eConditionWrapper.querySelector(".or");return this.conditionValue=null==this.conditionValue?"AND":this.conditionValue,e.checked="AND"===this.conditionValue,t.checked="OR"===this.conditionValue,{andButton:e,orButton:t}},v.prototype.onFloatingFilterChanged=function(e){var t=e;if(null==t)this.setModel(null);else if(this.isFilterConditionActive(c.CONDITION)){var i={condition1:t.model,condition2:this.serialize(c.CONDITION),operator:this.conditionValue};this.setModel(i)}else this.setModel(t?t.model:null);return this.doOnFilterChanged(!!t&&t.apply)},v.prototype.generateFilterHeader=function(e){return""},v.prototype.generateTemplate=function(){var e=this.translate.bind(this),t=this.createConditionBody(c.MAIN);return"<div>\n                    <div class='ag-filter-body-wrapper'>"+(this.acceptsBooleanLogic()?this.wrapCondition(t):t)+'</div>\n                    <div class="ag-filter-apply-panel" id="applyPanel">\n                        <button type="button" id="clearButton">'+e("clearFilter")+'</button>\n                        <button type="button" id="applyButton">'+e("applyFilter")+"</button>\n                    </div>\n                </div>"},v.prototype.acceptsBooleanLogic=function(){return!1},v.prototype.wrapCondition=function(e){return this.isFilterActive()?""+e+this.createConditionTemplate(c.CONDITION):e},v.prototype.createConditionTemplate=function(e){return'<div class="ag-filter-condition">\n            <input id="andId" type="radio" class="and" name="booleanLogic" value="AND" checked="checked" /><label style="display: inline" for="andId">AND</label>\n            <input id="orId" type="radio" class="or" name="booleanLogic" value="OR" /><label style="display: inline" for="orId">OR</label>\n            <div>'+this.createConditionBody(e)+"</div>\n        </div>"},v.prototype.createConditionBody=function(e){var t=this.bodyTemplate(e);return this.generateFilterHeader(e)+t},v.prototype.translate=function(e){return this.gridOptionsWrapper.getLocaleTextFunc()(e,g[e])},v.prototype.getDebounceMs=function(e){return e.applyButton&&e.debounceMs?(console.warn("ag-Grid: debounceMs is ignored when applyButton = true"),0):null!=e.debounceMs?e.debounceMs:500},v.EQUALS="equals",v.NOT_EQUAL="notEqual",v.LESS_THAN="lessThan",v.LESS_THAN_OR_EQUAL="lessThanOrEqual",v.GREATER_THAN="greaterThan",v.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",v.IN_RANGE="inRange",v.CONTAINS="contains",v.NOT_CONTAINS="notContains",v.STARTS_WITH="startsWith",v.ENDS_WITH="endsWith",r([u.QuerySelector("#applyPanel"),a("design:type",HTMLElement)],v.prototype,"eButtonsPanel",void 0),r([u.QuerySelector(".ag-filter-body-wrapper"),a("design:type",HTMLElement)],v.prototype,"eFilterBodyWrapper",void 0),r([u.QuerySelector("#applyButton"),a("design:type",HTMLElement)],v.prototype,"eApplyButton",void 0),r([u.QuerySelector("#clearButton"),a("design:type",HTMLElement)],v.prototype,"eClearButton",void 0),r([d.Autowired("context"),a("design:type",d.Context)],v.prototype,"context",void 0),r([d.Autowired("gridOptionsWrapper"),a("design:type",h.GridOptionsWrapper)],v.prototype,"gridOptionsWrapper",void 0),v);function v(){return null!==f&&f.apply(this,arguments)||this}t.BaseFilter=m;var y,b=(o(w,y=m),w.prototype.doesFilterPass=function(e){var t=this.individualFilterPasses(e,c.MAIN);if(null==this.eTypeConditionSelector)return t;var i=this.individualFilterPasses(e,c.CONDITION);return"AND"===this.conditionValue?t&&i:t||i},w.prototype.init=function(e){y.prototype.init.call(this,e),this.suppressAndOrCondition=e.suppressAndOrCondition},w.prototype.customInit=function(){this.defaultFilter||(this.defaultFilter=this.getDefaultType())},w.prototype.acceptsBooleanLogic=function(){return!0!==this.suppressAndOrCondition},w.prototype.generateFilterHeader=function(e){var t=this,i=this.getApplicableFilterTypes(),n=this.filterParams.filterOptions,o=(n||i).map(function(e){return'<option value="'+e+'">'+t.translate(e)+"</option>"}),r=1==o.length?"disabled":"",a=e==c.MAIN?"filterType":"filterConditionType";return o.length<=0?"":'<div>\n                <select class="ag-filter-select" id="'+a+'" '+r+">\n                    "+o.join("")+"\n                </select>\n            </div>"},w.prototype.initialiseFilterBodyUi=function(e){var t=this;e===c.MAIN?(this.setFilterType(this.filter,e),this.addDestroyableEventListener(this.eTypeSelector,"change",function(){return t.onFilterTypeChanged(e)})):(this.setFilterType(this.filterCondition,e),this.addDestroyableEventListener(this.eTypeConditionSelector,"change",function(){return t.onFilterTypeChanged(e)}))},w.prototype.onFilterTypeChanged=function(e){e===c.MAIN?this.filter=this.eTypeSelector.value:this.filterCondition=this.eTypeConditionSelector.value,this.refreshFilterBodyUi(e),this.isFilterActive()&&this.onFilterChanged()},w.prototype.isFilterActive=function(){var e=this.filterValues(c.MAIN);if(this.filter!==m.IN_RANGE)return null!=e;var t=e;return null!=t[0]&&null!=t[1]},w.prototype.setFilterType=function(e,t){if(t===c.MAIN){if(this.filter=e,!this.eTypeSelector)return;this.eTypeSelector.value=e}else{if(this.filterCondition=e,!this.eTypeConditionSelector)return;this.eTypeConditionSelector.value=e}},w.prototype.isFilterConditionActive=function(e){return null!=this.filterValues(e)},r([u.QuerySelector("#filterType"),a("design:type",HTMLSelectElement)],w.prototype,"eTypeSelector",void 0),r([u.QuerySelector("#filterConditionType"),a("design:type",HTMLSelectElement)],w.prototype,"eTypeConditionSelector",void 0),w);function w(){return null!==y&&y.apply(this,arguments)||this}t.ComparableBaseFilter=b;var C,_=(o(A,C=b),A.prototype.nullComparator=function(n){var o=this;return function(e,t){if(null==t){var i=o.translateNull(n);if(o.filter===m.EQUALS)return i?0:1;if(o.filter===m.GREATER_THAN)return i?1:-1;if(o.filter===m.GREATER_THAN_OR_EQUAL)return i?1:-1;if(o.filter===m.LESS_THAN_OR_EQUAL)return i?-1:1;if(o.filter===m.LESS_THAN)return i?-1:1;if(o.filter===m.NOT_EQUAL)return i?1:0}return o.comparator()(e,t)}},A.prototype.getDefaultType=function(){return m.EQUALS},A.prototype.translateNull=function(e){var t=-1<e.indexOf("greater")?"greaterThan":-1<e.indexOf("lessThan")?"lessThan":"equals";return this.filterParams.nullComparator&&this.filterParams.nullComparator[t]?this.filterParams.nullComparator[t]:A.DEFAULT_NULL_COMPARATOR[t]},A.prototype.individualFilterPasses=function(e,t){return this.doIndividualFilterPasses(e,t,t===c.MAIN?this.filter:this.filterCondition)},A.prototype.doIndividualFilterPasses=function(e,t,i){var n=this.filterParams.valueGetter(e.node),o=this.nullComparator(i),r=this.filterValues(t),a=Array.isArray(r)?r[0]:r;if(null==a)return t===c.MAIN||"AND"===this.conditionValue;var s=o(a,n);if(i===m.EQUALS)return 0===s;if(i===m.GREATER_THAN)return 0<s;if(i===m.GREATER_THAN_OR_EQUAL)return 0<=s;if(i===m.LESS_THAN_OR_EQUAL)return s<=0;if(i===m.LESS_THAN)return s<0;if(i===m.NOT_EQUAL)return 0!=s;var l=o(r[1],n);if(i===m.IN_RANGE)return this.filterParams.inRangeInclusive?0<=s&&l<=0:0<s&&l<0;throw new Error("Unexpected type of filter!: "+i)},A.DEFAULT_NULL_COMPARATOR={equals:!1,lessThan:!1,greaterThan:!1},A);function A(){return null!==C&&C.apply(this,arguments)||this}t.ScalarBaseFilter=_},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r,a=i(1),s=i(10),l=i(13),c=(r=l.BeanStub,o(u,r),u.prototype.setColsSpanning=function(e){this.colsSpanning=e,this.onLeftChanged()},u.prototype.getColumnOrGroup=function(){return this.beans.gridOptionsWrapper.isEnableRtl()&&this.colsSpanning?this.colsSpanning[this.colsSpanning.length-1]:this.columnOrGroup},u.prototype.init=function(){this.addDestroyableEventListener(this.columnOrGroup,s.Column.EVENT_LEFT_CHANGED,this.onLeftChanged.bind(this)),this.setLeftFirstTime()},u.prototype.setLeftFirstTime=function(){var e=this.beans.gridOptionsWrapper.isSuppressColumnMoveAnimation(),t=a.Utils.exists(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&t&&!e?this.animateInLeft():this.onLeftChanged()},u.prototype.animateInLeft=function(){var e=this,t=this.getColumnOrGroup().getLeft(),i=this.getColumnOrGroup().getOldLeft();this.setLeft(i),this.actualLeft=t,this.beans.columnAnimationService.executeNextVMTurn(function(){e.actualLeft===t&&e.setLeft(t)})},u.prototype.onLeftChanged=function(){this.actualLeft=this.getColumnOrGroup().getLeft(),this.setLeft(this.actualLeft)},u.prototype.setLeft=function(e){a.Utils.exists(e)&&(this.eCell.style.left=e+"px")},u);function u(e,t,i,n){var o=r.call(this)||this;return o.columnOrGroup=e,o.eCell=t,o.colsSpanning=n,o.beans=i,o}t.SetLeftFeature=c},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(2),s=(l.prototype.registerGridComp=function(e){this.gridPanel=e},l.prototype.isActive=function(){return this.active},l.prototype.start=function(){this.active||this.gridOptionsWrapper.isSuppressColumnMoveAnimation()||this.gridOptionsWrapper.isEnableRtl()||(this.ensureAnimationCssClassPresent(),this.active=!0)},l.prototype.finish=function(){this.active&&(this.flush(),this.active=!1)},l.prototype.executeNextVMTurn=function(e){this.active?this.executeNextFuncs.push(e):e()},l.prototype.executeLaterVMTurn=function(e){this.active?this.executeLaterFuncs.push(e):e()},l.prototype.ensureAnimationCssClassPresent=function(){var e=this;this.animationThreadCount++;var t=this.animationThreadCount;this.gridPanel.setColumnMovingCss(!0),this.executeLaterFuncs.push(function(){e.animationThreadCount===t&&e.gridPanel.setColumnMovingCss(!1)})},l.prototype.flush=function(){var e=this.executeNextFuncs;this.executeNextFuncs=[];var t=this.executeLaterFuncs;this.executeLaterFuncs=[],0===e.length&&0===t.length||(setTimeout(function(){return e.forEach(function(e){return e()})},0),setTimeout(function(){return t.forEach(function(e){return e()})},300))},n([r.Autowired("gridOptionsWrapper"),o("design:type",a.GridOptionsWrapper)],l.prototype,"gridOptionsWrapper",void 0),l=n([r.Bean("columnAnimationService")],l));function l(){this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.animationThreadCount=0}t.ColumnAnimationService=s},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(69),s=i(2),l=i(27),c=(u.prototype.init=function(){},u.prototype.addCellEditor=function(e,t){console.warn("ag-grid: since v13.3.1 this method is not supported anymore. If you want to register your own editor check the docs: https://www.ag-grid.com/javascript-grid-cell-editor/")},u.prototype.createCellEditor=function(e,i){var n=this;return this.componentResolver.createAgGridComponent(e,i,"cellEditor",{api:i.api,columnApi:i.columnApi,node:i.node,data:i.node.data,rowIndex:i.rowIndex,column:i.column,colDef:i.column.getColDef()},"agCellEditor").map(function(e){if(!e.isPopup||!e.isPopup())return e;n.gridOptionsWrapper.isFullRowEdit()&&console.warn("ag-Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");var t=new a.PopupEditorWrapper(e);return n.context.wireBean(t),t.init(i),t})},n([r.Autowired("context"),o("design:type",r.Context)],u.prototype,"context",void 0),n([r.Autowired("componentResolver"),o("design:type",l.ComponentResolver)],u.prototype,"componentResolver",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",s.GridOptionsWrapper)],u.prototype,"gridOptionsWrapper",void 0),n([r.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],u.prototype,"init",null),u=n([r.Bean("cellEditorFactory")],u));function u(){}t.CellEditorFactory=c},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r,a=i(0),s=i(1),l=i(2),c=i(3),u=i(19),d=i(70),h=i(71),p=i(72),f=((r=g).prototype.init=function(){this.cellRendererMap[r.ANIMATE_SLIDE]=d.AnimateSlideCellRenderer,this.cellRendererMap[r.ANIMATE_SHOW_CHANGE]=h.AnimateShowChangeCellRenderer,this.cellRendererMap[r.GROUP]=p.GroupCellRenderer},g.prototype.addCellRenderer=function(e,t){this.cellRendererMap[e]=t},g.prototype.getCellRenderer=function(e){var t=this.cellRendererMap[e];return s.Utils.missing(t)?(console.warn("ag-Grid: unable to find cellRenderer for key "+e),null):t},g.ANIMATE_SLIDE="animateSlide",g.ANIMATE_SHOW_CHANGE="animateShowChange",g.GROUP="group",n([a.Autowired("gridOptionsWrapper"),o("design:type",l.GridOptionsWrapper)],g.prototype,"gridOptionsWrapper",void 0),n([a.Autowired("expressionService"),o("design:type",u.ExpressionService)],g.prototype,"expressionService",void 0),n([a.Autowired("eventService"),o("design:type",c.EventService)],g.prototype,"eventService",void 0),n([a.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],g.prototype,"init",null),g=r=n([a.Bean("cellRendererFactory")],g));function g(){this.cellRendererMap={}}t.CellRendererFactory=f},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(21),l=i(27),c=i(1),s=i(2),u=(d.prototype.useCellRenderer=function(e,t,i){var n=this,o=this.componentRecipes.newCellRenderer(e,i);return null!=o?o.then(function(e){null==e?t.innerText=null!=i.valueFormatted?i.valueFormatted:i.value:n.bindToHtml(o,t)}):t.innerText=null!=i.valueFormatted?i.valueFormatted:i.value,o},d.prototype.useFilterCellRenderer=function(e,t,i){var n=this.componentRecipes.newCellRenderer(e.filterParams,i);if(null!=n)this.bindToHtml(n,t);else if(null==i.valueFormatted&&null==i.value){var o=this.gridOptionsWrapper.getLocaleTextFunc();t.innerText="("+o("blanks","Blanks")+")"}else t.innerText=null!=i.valueFormatted?i.valueFormatted:i.value;return n},d.prototype.useRichSelectCellRenderer=function(e,t,i){var n=this.componentRecipes.newCellRenderer(e.cellEditorParams,i);return null!=n?this.bindToHtml(n,t):t.innerText=null!=i.valueFormatted?i.valueFormatted:i.value,n},d.prototype.useInnerCellRenderer=function(e,t,i,n){var o=this,r=null,a=this.componentResolver.getComponentToUse(e,"innerRenderer",null);if(a&&null!=a.component&&a.source!=l.ComponentSource.DEFAULT)r=this.componentRecipes.newInnerCellRenderer(e,n);else{var s=this.componentResolver.getComponentToUse(t,"cellRenderer",null);r=s&&s.source!=l.ComponentSource.DEFAULT?this.componentRecipes.newCellRenderer(t,n):s&&s.source==l.ComponentSource.DEFAULT&&c._.get(t,"cellRendererParams.innerRenderer",null)?this.componentRecipes.newInnerCellRenderer(t.cellRendererParams,n):this.componentRecipes.newCellRenderer({},n)}return null!=r?r.then(function(e){null!=e?o.bindToHtml(r,i):i.innerText=null!=n.valueFormatted?n.valueFormatted:n.value}):i.innerText=null!=n.valueFormatted?n.valueFormatted:n.value,r},d.prototype.useFullWidthGroupRowInnerCellRenderer=function(e,t){var i=this.componentRecipes.newFullWidthGroupRowInnerCellRenderer(t);return null!=i?this.bindToHtml(i,e):e.innerText=null!=t.valueFormatted?t.valueFormatted:t.value,i},d.prototype.bindToHtml=function(e,i){return e.then(function(e){var t=e.getGui();null!=t&&("object"==typeof t?i.appendChild(t):i.innerHTML=t)}),e},n([r.Autowired("componentRecipes"),o("design:type",a.ComponentRecipes)],d.prototype,"componentRecipes",void 0),n([r.Autowired("componentResolver"),o("design:type",l.ComponentResolver)],d.prototype,"componentResolver",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",s.GridOptionsWrapper)],d.prototype,"gridOptionsWrapper",void 0),d=n([r.Bean("cellRendererService")],d));function d(){}t.CellRendererService=u},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(13),c=i(0),u=i(3),d=i(25),h=i(1),p=(s=l.BeanStub,o(f,s),f.prototype.postConstruct=function(){this.addDestroyableEventListener(this.eventService,d.Events.EVENT_BODY_HEIGHT_CHANGED,this.update.bind(this)),this.scrollBarWidth=h._.getScrollbarWidth(),this.maxDivHeight=h._.getMaxDivHeight()},f.prototype.registerGridComp=function(e){this.gridPanel=e},f.prototype.isScaling=function(){return this.scaling},f.prototype.getOffset=function(){return this.offset},f.prototype.update=function(){if(this.scaling){var e=this.gridPanel.getVScrollPosition().top,t=this.getUiBodyHeight();e===this.scrollY&&t===this.uiBodyHeight||(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}},f.prototype.calculateOffset=function(){this.uiContainerHeight=this.maxDivHeight,this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;var e=this.scrollY/this.maxScrollY;this.setOffset(e*this.pixelsToShave)},f.prototype.clearOffset=function(){this.uiContainerHeight=this.modelHeight,this.pixelsToShave=0,this.setOffset(0)},f.prototype.setOffset=function(e){var t="number"==typeof e?Math.floor(e):null;this.offset!==t&&(this.offset=t,this.eventService.dispatchEvent({type:d.Events.EVENT_HEIGHT_SCALE_CHANGED}))},f.prototype.setModelHeight=function(e){this.modelHeight=e,this.scaling=0<this.maxDivHeight&&e>this.maxDivHeight,this.scaling?this.calculateOffset():this.clearOffset()},f.prototype.getUiContainerHeight=function(){return this.uiContainerHeight},f.prototype.getRealPixelPosition=function(e){return e-this.offset},f.prototype.getUiBodyHeight=function(){var e=this.gridPanel.getVScrollPosition(),t=e.bottom-e.top;return this.gridPanel.isHorizontalScrollShowing()&&(t-=this.scrollBarWidth),t},f.prototype.getScrollPositionForPixel=function(e){if(this.pixelsToShave<=0)return e;var t=e/(this.modelHeight-this.getUiBodyHeight());return this.maxScrollY*t},r([c.Autowired("eventService"),a("design:type",u.EventService)],f.prototype,"eventService",void 0),r([c.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],f.prototype,"postConstruct",null),f=r([c.Bean("heightScaler")],f));function f(){var e=null!==s&&s.apply(this,arguments)||this;return e.scrollY=0,e.uiBodyHeight=0,e}t.HeightScaler=p},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(i,n){return function(e,t){n(e,t,i)}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(2),s=i(4),l=i(3),c=i(12),u=i(5),d=i(0),h=i(0),p=i(0),f=i(0),g=(m.prototype.setBeans=function(e){this.logger=e.create("AlignedGridsService")},m.prototype.registerGridComp=function(e){this.gridPanel=e},m.prototype.init=function(){this.eventService.addEventListener(u.Events.EVENT_COLUMN_MOVED,this.fireColumnEvent.bind(this)),this.eventService.addEventListener(u.Events.EVENT_COLUMN_VISIBLE,this.fireColumnEvent.bind(this)),this.eventService.addEventListener(u.Events.EVENT_COLUMN_PINNED,this.fireColumnEvent.bind(this)),this.eventService.addEventListener(u.Events.EVENT_COLUMN_GROUP_OPENED,this.fireColumnEvent.bind(this)),this.eventService.addEventListener(u.Events.EVENT_COLUMN_RESIZED,this.fireColumnEvent.bind(this)),this.eventService.addEventListener(u.Events.EVENT_BODY_SCROLL,this.fireScrollEvent.bind(this))},m.prototype.fireEvent=function(i){if(!this.consuming){var e=this.gridOptionsWrapper.getAlignedGrids();e&&e.forEach(function(e){if(e.api){var t=e.api.__getAlignedGridService();i(t)}})}},m.prototype.onEvent=function(e){this.consuming=!0,e(),this.consuming=!1},m.prototype.fireColumnEvent=function(t){this.fireEvent(function(e){e.onColumnEvent(t)})},m.prototype.fireScrollEvent=function(t){"horizontal"===t.direction&&this.fireEvent(function(e){e.onScrollEvent(t)})},m.prototype.onScrollEvent=function(e){var t=this;this.onEvent(function(){t.gridPanel.setHorizontalScrollPosition(e.left)})},m.prototype.getMasterColumns=function(e){var t=[];return e.columns?e.columns.forEach(function(e){t.push(e)}):e.column&&t.push(e.column),t},m.prototype.getColumnIds=function(e){var t=[];return e.columns?e.columns.forEach(function(e){t.push(e.getColId())}):e.columns&&t.push(e.column.getColId()),t},m.prototype.onColumnEvent=function(i){var n=this;this.onEvent(function(){switch(i.type){case u.Events.EVENT_COLUMN_MOVED:case u.Events.EVENT_COLUMN_VISIBLE:case u.Events.EVENT_COLUMN_PINNED:case u.Events.EVENT_COLUMN_RESIZED:var e=i;n.processColumnEvent(e);break;case u.Events.EVENT_COLUMN_GROUP_OPENED:var t=i;n.processGroupOpenedEvent(t);break;case u.Events.EVENT_COLUMN_PIVOT_CHANGED:console.warn("ag-Grid: pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.")}})},m.prototype.processGroupOpenedEvent=function(e){var t,i=e.columnGroup;if(i){var n=i.getGroupId();t=this.columnController.getOriginalColumnGroup(n)}i&&!t||(this.logger.log("onColumnEvent-> processing "+event+" expanded = "+i.isExpanded()),this.columnController.setColumnGroupOpened(t,i.isExpanded(),"alignedGridChanged"))},m.prototype.processColumnEvent=function(t){var e,i=this,n=t.column;if(n&&(e=this.columnController.getPrimaryColumn(n.getColId())),!n||e){var o=this.getColumnIds(t),r=this.getMasterColumns(t);switch(t.type){case u.Events.EVENT_COLUMN_MOVED:var a=t;this.logger.log("onColumnEvent-> processing "+t.type+" toIndex = "+a.toIndex),this.columnController.moveColumns(o,a.toIndex,"alignedGridChanged");break;case u.Events.EVENT_COLUMN_VISIBLE:var s=t;this.logger.log("onColumnEvent-> processing "+t.type+" visible = "+s.visible),this.columnController.setColumnsVisible(o,s.visible,"alignedGridChanged");break;case u.Events.EVENT_COLUMN_PINNED:var l=t;this.logger.log("onColumnEvent-> processing "+t.type+" pinned = "+l.pinned),this.columnController.setColumnsPinned(o,l.pinned,"alignedGridChanged");break;case u.Events.EVENT_COLUMN_RESIZED:var c=t;r.forEach(function(e){i.logger.log("onColumnEvent-> processing "+t.type+" actualWidth = "+e.getActualWidth()),i.columnController.setColumnWidth(e.getColId(),e.getActualWidth(),!1,c.finished,"alignedGridChanged")})}}},n([p.Autowired("gridOptionsWrapper"),o("design:type",a.GridOptionsWrapper)],m.prototype,"gridOptionsWrapper",void 0),n([p.Autowired("columnController"),o("design:type",s.ColumnController)],m.prototype,"columnController",void 0),n([p.Autowired("eventService"),o("design:type",l.EventService)],m.prototype,"eventService",void 0),n([r(0,h.Qualifier("loggerFactory")),o("design:type",Function),o("design:paramtypes",[c.LoggerFactory]),o("design:returntype",void 0)],m.prototype,"setBeans",null),n([f.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],m.prototype,"init",null),m=n([d.Bean("alignedGridsService")],m));function m(){this.consuming=!1}t.AlignedGridsService=g},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),a=i(0),s=i(40),l=(c.prototype.addResizeBar=function(e){var t=this,i={dragStartPixels:0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e)};return this.dragService.addDragSource(i,!0),function(){return t.dragService.removeDragSource(i)}},c.prototype.onDragStart=function(e,t){this.draggingStarted=!0,this.dragStartX=t.clientX,this.setResizeIcons();var i=t instanceof MouseEvent&&!0===t.shiftKey;e.onResizeStart(i)},c.prototype.setResizeIcons=function(){this.oldBodyCursor=this.eGridDiv.style.cursor,this.oldMsUserSelect=this.eGridDiv.style.msUserSelect,this.oldWebkitUserSelect=this.eGridDiv.style.webkitUserSelect,this.eGridDiv.style.cursor="col-resize",this.eGridDiv.style.msUserSelect="none",this.eGridDiv.style.webkitUserSelect="none"},c.prototype.onDragStop=function(e,t){e.onResizeEnd(this.resizeAmount),this.resetIcons()},c.prototype.resetIcons=function(){this.eGridDiv.style.cursor=this.oldBodyCursor,this.eGridDiv.style.msUserSelect=this.oldMsUserSelect,this.eGridDiv.style.webkitUserSelect=this.oldWebkitUserSelect},c.prototype.onDragging=function(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)},n([a.Autowired("gridOptionsWrapper"),o("design:type",r.GridOptionsWrapper)],c.prototype,"gridOptionsWrapper",void 0),n([a.Autowired("dragService"),o("design:type",s.DragService)],c.prototype,"dragService",void 0),n([a.Autowired("eGridDiv"),o("design:type",HTMLElement)],c.prototype,"eGridDiv",void 0),c=n([a.Bean("horizontalResizeService")],c));function c(){}t.HorizontalResizeService=l},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(8),c=i(11),u=i(1),d=i(0),h=i(2),p=(s=l.Component,o(f,s),f.prototype.preConstruct=function(){this.setTemplate(f.TEMPLATE)},f.prototype.postConstruct=function(){this.loadIcons(),this.updateIcons(),this.props.label&&(this.eLabel.innerText=this.props.label)},f.prototype.loadIcons=function(){u.Utils.removeAllChildren(this.eChecked),u.Utils.removeAllChildren(this.eUnchecked),u.Utils.removeAllChildren(this.eIndeterminate),this.readOnly?(this.eChecked.appendChild(u.Utils.createIconNoSpan("checkboxCheckedReadOnly",this.gridOptionsWrapper,null)),this.eUnchecked.appendChild(u.Utils.createIconNoSpan("checkboxUncheckedReadOnly",this.gridOptionsWrapper,null)),this.eIndeterminate.appendChild(u.Utils.createIconNoSpan("checkboxIndeterminateReadOnly",this.gridOptionsWrapper,null))):(this.eChecked.appendChild(u.Utils.createIconNoSpan("checkboxChecked",this.gridOptionsWrapper,null)),this.eUnchecked.appendChild(u.Utils.createIconNoSpan("checkboxUnchecked",this.gridOptionsWrapper,null)),this.eIndeterminate.appendChild(u.Utils.createIconNoSpan("checkboxIndeterminate",this.gridOptionsWrapper,null)))},f.prototype.onClick=function(e){u.Utils.addAgGridEventPath(e),this.readOnly||this.toggle()},f.prototype.getNextValue=function(){return void 0===this.selected||!this.selected},f.prototype.setPassive=function(e){this.passive=e},f.prototype.setReadOnly=function(e){this.readOnly=e,this.loadIcons()},f.prototype.isReadOnly=function(){return this.readOnly},f.prototype.isSelected=function(){return this.selected},f.prototype.toggle=function(){var e=this.getNextValue();if(this.passive){var t={type:f.EVENT_CHANGED,selected:e};this.dispatchEvent(t)}else this.setSelected(e)},f.prototype.setSelected=function(e){if(this.selected!==e){this.selected=!0===e||!1!==e&&void 0,this.updateIcons();var t={type:f.EVENT_CHANGED,selected:this.selected};this.dispatchEvent(t)}},f.prototype.updateIcons=function(){u.Utils.setVisible(this.eChecked,!0===this.selected),u.Utils.setVisible(this.eUnchecked,!1===this.selected),u.Utils.setVisible(this.eIndeterminate,void 0===this.selected)},f.EVENT_CHANGED="change",f.TEMPLATE='<span class="ag-checkbox" role="presentation">  <span class="ag-checkbox-checked" role="presentation"></span>  <span class="ag-checkbox-unchecked" role="presentation"></span>  <span class="ag-checkbox-indeterminate" role="presentation"></span>  <span class="ag-checkbox-label" role="presentation"></span></span>',r([d.Autowired("gridOptionsWrapper"),a("design:type",h.GridOptionsWrapper)],f.prototype,"gridOptionsWrapper",void 0),r([c.QuerySelector(".ag-checkbox-checked"),a("design:type",HTMLElement)],f.prototype,"eChecked",void 0),r([c.QuerySelector(".ag-checkbox-unchecked"),a("design:type",HTMLElement)],f.prototype,"eUnchecked",void 0),r([c.QuerySelector(".ag-checkbox-indeterminate"),a("design:type",HTMLElement)],f.prototype,"eIndeterminate",void 0),r([c.QuerySelector(".ag-checkbox-label"),a("design:type",HTMLElement)],f.prototype,"eLabel",void 0),r([d.PreConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],f.prototype,"preConstruct",null),r([d.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],f.prototype,"postConstruct",null),r([c.Listener("click"),a("design:type",Function),a("design:paramtypes",[MouseEvent]),a("design:returntype",void 0)],f.prototype,"onClick",null),f);function f(){var e=s.call(this)||this;return e.selected=!1,e.readOnly=!1,e.passive=!1,e}t.AgCheckbox=p},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r,a=i(1),s=i(14),l=i(13),c=(r=l.BeanStub,o(u,r),u.prototype.isAnyNodeOpen=function(e){var t=!1;return this.forEachNodeCallback(function(e){e.expanded&&(t=!0)},e),t},u.prototype.forEachNodeCallback=function(e,t){for(var i=this.startRow;i<this.endRow;i++)i<t&&e(this.getRowUsingLocalIndex(i),i)},u.prototype.forEachNode=function(t,i,e,n){this.forEachNodeCallback(function(e){t(e,i.next()),n&&e.childrenCache&&e.childrenCache.forEachNodeDeep(t,i)},e)},u.prototype.forEachNodeDeep=function(e,t,i){this.forEachNode(e,t,i,!0)},u.prototype.forEachNodeShallow=function(e,t,i){this.forEachNode(e,t,i,!1)},u.prototype.getVersion=function(){return this.version},u.prototype.getLastAccessed=function(){return this.lastAccessed},u.prototype.getRowUsingLocalIndex=function(e,t){void 0===t&&(t=!1),t||(this.lastAccessed=this.rowNodeCacheParams.lastAccessedSequence.next());var i=e-this.startRow;return this.rowNodes[i]},u.prototype.init=function(e){this.beans=e,this.createRowNodes()},u.prototype.getStartRow=function(){return this.startRow},u.prototype.getEndRow=function(){return this.endRow},u.prototype.getBlockNumber=function(){return this.blockNumber},u.prototype.setDirty=function(){this.version++,this.state=u.STATE_DIRTY},u.prototype.setDirtyAndPurge=function(){this.setDirty(),this.rowNodes.forEach(function(e){e.setData(null)})},u.prototype.getState=function(){return this.state},u.prototype.setRowNode=function(e,t){var i=e-this.startRow;this.rowNodes[i]=t},u.prototype.setBlankRowNode=function(e){var t=e-this.startRow,i=this.createBlankRowNode(e);return this.rowNodes[t]=i},u.prototype.setNewData=function(e,t){var i=this.setBlankRowNode(e);return this.setDataAndId(i,t,this.startRow+e),i},u.prototype.createBlankRowNode=function(e){var t=new s.RowNode;return this.beans.context.wireBean(t),t.setRowHeight(this.rowNodeCacheParams.rowHeight),t},u.prototype.createRowNodes=function(){this.rowNodes=[];for(var e=0;e<this.rowNodeCacheParams.blockSize;e++){var t=this.startRow+e,i=this.createBlankRowNode(t);this.rowNodes.push(i)}},u.prototype.load=function(){this.state=u.STATE_LOADING,this.loadFromDatasource()},u.prototype.pageLoadFailed=function(){this.state=u.STATE_FAILED;var e={type:u.EVENT_LOAD_COMPLETE,success:!1,page:this,lastRow:null};this.dispatchEvent(e)},u.prototype.populateWithRowData=function(n){var o=this,r=[];this.rowNodes.forEach(function(e,t){var i=n[t];e.stub&&r.push(e),o.setDataAndId(e,i,o.startRow+t)}),0<r.length&&this.beans.rowRenderer.redrawRows(r)},u.prototype.destroy=function(){r.prototype.destroy.call(this),this.rowNodes.forEach(function(e){e.childrenCache&&(e.childrenCache.destroy(),e.childrenCache=null),e.clearRowTop()})},u.prototype.pageLoaded=function(e,t,i){e===this.version&&(this.state=u.STATE_LOADED,this.populateWithRowData(t)),i=a.Utils.cleanNumber(i);var n={type:u.EVENT_LOAD_COMPLETE,success:!0,page:this,lastRow:i};this.dispatchEvent(n)},u.EVENT_LOAD_COMPLETE="loadComplete",u.STATE_DIRTY="dirty",u.STATE_LOADING="loading",u.STATE_LOADED="loaded",u.STATE_FAILED="failed",u);function u(e,t){var i=r.call(this)||this;return i.version=0,i.state=u.STATE_DIRTY,i.rowNodeCacheParams=t,i.blockNumber=e,i.startRow=e*t.blockSize,i.endRow=i.startRow+t.blockSize,i}t.RowNodeBlock=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(5),n=i(90),s=i(1),o=i(2),r=(l.getEventCallbacks=function(){return l.EVENT_CALLBACKS||(l.EVENT_CALLBACKS=[],l.EVENT_CALLBACKS_NO_PREFIX=[],l.EVENTS.forEach(function(e){l.EVENT_CALLBACKS.push(l.getCallbackForEvent(e)),l.EVENT_CALLBACKS_NO_PREFIX.push(e)})),l.EVENT_CALLBACKS},l.copyAttributesToGridOptions=function(e,i,t){void 0===t&&(t=!1),c(i),"object"!=typeof e&&(e={});var n=e;return l.ARRAY_PROPERTIES.concat(l.STRING_PROPERTIES).concat(l.OBJECT_PROPERTIES).concat(l.FUNCTION_PROPERTIES).forEach(function(e){void 0!==i[e]&&(n[e]=i[e])}),l.BOOLEAN_PROPERTIES.forEach(function(e){void 0!==i[e]&&(n[e]=l.toBoolean(i[e]))}),l.NUMBER_PROPERTIES.forEach(function(e){void 0!==i[e]&&(n[e]=l.toNumber(i[e]))}),l.getEventCallbacks().forEach(function(e){void 0!==i[e]&&(n[e]=i[e])}),t||l.EVENT_CALLBACKS_NO_PREFIX.forEach(function(e){var t=l.getCallbackForEvent(e);void 0===i[e]&&void 0===i[t]||o.GridOptionsWrapper.checkEventDeprecation(e)}),e},l.getCallbackForEvent=function(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substr(1)},l.processOnChange=function(t,e,i,n){if(t){c(t);var o=e;l.ARRAY_PROPERTIES.concat(l.OBJECT_PROPERTIES).concat(l.STRING_PROPERTIES).forEach(function(e){t[e]&&(o[e]=t[e].currentValue)}),l.BOOLEAN_PROPERTIES.forEach(function(e){t[e]&&(o[e]=l.toBoolean(t[e].currentValue))}),l.NUMBER_PROPERTIES.forEach(function(e){t[e]&&(o[e]=l.toNumber(t[e].currentValue))}),l.getEventCallbacks().forEach(function(e){t[e]&&(o[e]=t[e].currentValue)}),t.showToolPanel&&i.showToolPanel(l.toBoolean(t.showToolPanel.currentValue)),t.quickFilterText&&i.setQuickFilter(t.quickFilterText.currentValue),t.rowData&&i.setRowData(t.rowData.currentValue),t.pinnedTopRowData&&i.setPinnedTopRowData(t.pinnedTopRowData.currentValue),t.pinnedBottomRowData&&i.setPinnedBottomRowData(t.pinnedBottomRowData.currentValue),t.columnDefs&&i.setColumnDefs(t.columnDefs.currentValue,"gridOptionsChanged"),t.datasource&&i.setDatasource(t.datasource.currentValue),t.headerHeight&&i.setHeaderHeight(l.toNumber(t.headerHeight.currentValue)),t.paginationPageSize&&i.paginationSetPageSize(l.toNumber(t.paginationPageSize.currentValue)),t.pivotMode&&n.setPivotMode(l.toBoolean(t.pivotMode.currentValue)),t.groupRemoveSingleChildren&&i.setGroupRemoveSingleChildren(l.toBoolean(t.groupRemoveSingleChildren.currentValue)),t.suppressRowDrag&&i.setSuppressRowDrag(l.toBoolean(t.suppressRowDrag.currentValue)),t.gridAutoHeight&&i.setGridAutoHeight(l.toBoolean(t.gridAutoHeight.currentValue)),t.suppressClipboardPaste&&i.setSuppressClipboardPaste(l.toBoolean(t.suppressClipboardPaste.currentValue));var r={type:a.Events.EVENT_COMPONENT_STATE_CHANGED,api:e.api,columnApi:e.columnApi};s.Utils.iterateObject(t,function(e,t){r[e]=t}),i.dispatchEvent(r)}},l.toBoolean=function(e){return"boolean"==typeof e?e:"string"==typeof e&&("TRUE"===e.toUpperCase()||""==e)},l.toNumber=function(e){return"number"==typeof e?e:"string"==typeof e?Number(e):void 0},l.EVENTS=[],l.STRING_PROPERTIES=n.PropertyKeys.STRING_PROPERTIES,l.OBJECT_PROPERTIES=n.PropertyKeys.OBJECT_PROPERTIES,l.ARRAY_PROPERTIES=n.PropertyKeys.ARRAY_PROPERTIES,l.NUMBER_PROPERTIES=n.PropertyKeys.NUMBER_PROPERTIES,l.BOOLEAN_PROPERTIES=n.PropertyKeys.BOOLEAN_PROPERTIES,l.FUNCTION_PROPERTIES=n.PropertyKeys.FUNCTION_PROPERTIES,l.ALL_PROPERTIES=n.PropertyKeys.ALL_PROPERTIES,l);function l(){}function c(e){(e.rowDeselected||e.onRowDeselected)&&console.warn("ag-grid: as of v3.4 rowDeselected no longer exists. Please check the docs.")}t.ComponentUtil=r,s.Utils.iterateObject(a.Events,function(e,t){r.EVENTS.push(t)})},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(4),x=i(9),S=i(1),s=i(17),l=i(2),c=i(48),u=i(38),T=i(83),d=i(26),h=i(30),p=(f.prototype.extractHeaderValue=function(e){var t=this.getHeaderName(this.processHeaderCallback,e);return null==t&&(t=""),this.cellAndHeaderEscaper?this.cellAndHeaderEscaper(t):t},f.prototype.extractRowCellValue=function(e,t,i,n){var o,r=0<this.columnController.getRowGroupColumns().length;return o=n.group&&r&&0===t?this.createValueForGroupNode(n):this.valueService.getValue(e,n),null==(o=this.processCell(n,e,o,this.processCellCallback,i))&&(o=""),this.cellAndHeaderEscaper?this.cellAndHeaderEscaper(o):o},f.prototype.getHeaderName=function(e,t){return e?e({column:t,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext()}):this.columnController.getDisplayNameForColumn(t,"csv",!0)},f.prototype.createValueForGroupNode=function(e){for(var t=[e.key];e.parent;)e=e.parent,t.push(e.key);return t.reverse().join(" -> ")},f.prototype.processCell=function(e,t,i,n,o){return n?n({column:t,node:e,value:i,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext(),type:o}):i},f);function f(e,t,i,n,o,r){this.columnController=e,this.valueService=t,this.gridOptionsWrapper=i,this.processCellCallback=n,this.processHeaderCallback=o,this.cellAndHeaderEscaper=r}t.BaseGridSerializingSession=p;var g,m=(v.prototype.serialize=function(e,t){var o,r=t&&t.skipGroups,i=t&&t.skipHeader,n=t&&t.columnGroups,a=t&&t.skipFooters,s=t&&t.skipPinnedTop,l=t&&t.skipPinnedBottom,c=t&&t.customHeader,u=t&&t.customFooter,d=t&&t.allColumns,h=t&&t.onlySelected,p=t&&t.columnKeys,f=t&&t.onlySelectedAllPages,g=t&&t.shouldRowBeSkipped||function(){return!1},m=this.gridOptionsWrapper.getApi(),v=this.gridOptionsWrapper.getContext(),y=this.columnController.isPivotMode(),b=this.rowModel.getType()===x.Constants.ROW_MODEL_TYPE_CLIENT_SIDE,w=!b&&h;if(!(o=S.Utils.existsAndNotEmpty(p)?this.columnController.getGridColumns(p):d&&!y?this.columnController.getAllPrimaryColumns():this.columnController.getAllDisplayedColumns())||0===o.length)return"";if(e.prepare(o),c&&e.addCustomHeader(t.customHeader),n){var C=new T.GroupInstanceIdCreator,_=this.displayedGroupCreator.createDisplayedGroups(o,this.columnController.getGridBalancedTree(),C);this.recursivelyAddHeaderGroups(_,e)}if(!i){var A=e.onNewHeaderRow();o.forEach(function(e,t){A.onColumn(e,t,null)})}function E(i){if((!r||!i.group)&&(!a||!i.footer)&&(!h||i.isSelected())&&(!s||"top"!==i.rowPinned)&&(!l||"bottom"!==i.rowPinned)&&(-1!==i.level||i.leafGroup)&&!g({node:i,api:m,context:v})){var n=e.onNewBodyRow();o.forEach(function(e,t){n.onColumn(e,t,i)})}}return this.pinnedRowModel.forEachPinnedTopRow(E),y?this.rowModel.forEachPivotNode?this.rowModel.forEachPivotNode(E):this.rowModel.forEachNode(E):f||w?this.selectionController.getSelectedNodes().forEach(function(e){E(e)}):b?this.rowModel.forEachNodeAfterFilterAndSort(E):this.rowModel.forEachNode(E),this.pinnedRowModel.forEachPinnedBottomRow(E),u&&e.addCustomFooter(t.customFooter),e.parse()},v.prototype.recursivelyAddHeaderGroups=function(e,t){var i=[];e.forEach(function(e){var t=e;t.getChildren&&t.getChildren().forEach(function(e){return i.push(e)})}),0<e.length&&e[0]instanceof d.ColumnGroup&&this.doAddHeaderHeader(t,e),i&&0<i.length&&this.recursivelyAddHeaderGroups(i,t)},v.prototype.doAddHeaderHeader=function(e,t){var n=this,o=e.onNewHeaderGroupingRow(),r=0;t.forEach(function(e){var t=e,i=(t.getDefinition(),n.columnController.getDisplayNameForColumnGroup(t,"header"));o.onColumn(i,r++,t.getLeafColumns().length-1)})},n([r.Autowired("displayedGroupCreator"),o("design:type",c.DisplayedGroupCreator)],v.prototype,"displayedGroupCreator",void 0),n([r.Autowired("columnController"),o("design:type",a.ColumnController)],v.prototype,"columnController",void 0),n([r.Autowired("rowModel"),o("design:type",Object)],v.prototype,"rowModel",void 0),n([r.Autowired("pinnedRowModel"),o("design:type",h.PinnedRowModel)],v.prototype,"pinnedRowModel",void 0),n([r.Autowired("selectionController"),o("design:type",s.SelectionController)],v.prototype,"selectionController",void 0),n([r.Autowired("balancedColumnTreeBuilder"),o("design:type",u.BalancedColumnTreeBuilder)],v.prototype,"balancedColumnTreeBuilder",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",l.GridOptionsWrapper)],v.prototype,"gridOptionsWrapper",void 0),v=n([r.Bean("gridSerializer")],v));function v(){}t.GridSerializer=m,(g=t.RowType||(t.RowType={}))[g.HEADER_GROUPING=0]="HEADER_GROUPING",g[g.HEADER=1]="HEADER",g[g.BODY=2]="BODY"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(9),o=i(1),r=i(23),a=(s.prototype.isFloatingTop=function(){return this.floating===n.Constants.PINNED_TOP},s.prototype.isFloatingBottom=function(){return this.floating===n.Constants.PINNED_BOTTOM},s.prototype.isNotFloating=function(){return!this.isFloatingBottom()&&!this.isFloatingTop()},s.prototype.equals=function(e){return this.rowIndex===e.rowIndex&&this.floating===e.floating},s.prototype.toString=function(){return"rowIndex = "+this.rowIndex+", floating = "+this.floating},s.prototype.getGridCell=function(e){var t={rowIndex:this.rowIndex,floating:this.floating,column:e};return new r.GridCell(t)},s.prototype.before=function(e){var t=e.floating;switch(this.floating){case n.Constants.PINNED_TOP:if(t!==n.Constants.PINNED_TOP)return!0;break;case n.Constants.PINNED_BOTTOM:if(t!==n.Constants.PINNED_BOTTOM)return!1;break;default:if(o.Utils.exists(t))return t!==n.Constants.PINNED_TOP}return this.rowIndex<e.rowIndex},s);function s(e,t){this.rowIndex=e,this.floating=o.Utils.makeNull(t)}t.GridRow=a},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(8),c=i(14),u=i(1),d=i(0),h=i(2),p=i(5),f=i(3),g=i(6),m=i(7),v=(s=l.Component,o(y,s),y.prototype.createAndAddIcons=function(){this.eCheckedIcon=u.Utils.createIconNoSpan("checkboxChecked",this.gridOptionsWrapper,this.column),this.eUncheckedIcon=u.Utils.createIconNoSpan("checkboxUnchecked",this.gridOptionsWrapper,this.column),this.eIndeterminateIcon=u.Utils.createIconNoSpan("checkboxIndeterminate",this.gridOptionsWrapper,this.column);var e=this.getGui();e.appendChild(this.eCheckedIcon),e.appendChild(this.eUncheckedIcon),e.appendChild(this.eIndeterminateIcon)},y.prototype.onDataChanged=function(){this.onSelectionChanged()},y.prototype.onSelectableChanged=function(){this.showOrHideSelect()},y.prototype.onSelectionChanged=function(){var e=this.rowNode.isSelected();u.Utils.setVisible(this.eCheckedIcon,!0===e),u.Utils.setVisible(this.eUncheckedIcon,!1===e),u.Utils.setVisible(this.eIndeterminateIcon,"boolean"!=typeof e)},y.prototype.onCheckedClicked=function(){var e=this.gridOptionsWrapper.isGroupSelectsFiltered();return this.rowNode.setSelectedParams({newValue:!1,groupSelectsFiltered:e})},y.prototype.onUncheckedClicked=function(e){var t=this.gridOptionsWrapper.isGroupSelectsFiltered();return this.rowNode.setSelectedParams({newValue:!0,rangeSelect:e.shiftKey,groupSelectsFiltered:t})},y.prototype.onIndeterminateClicked=function(e){0===this.onUncheckedClicked(e)&&this.onCheckedClicked()},y.prototype.init=function(e){this.rowNode=e.rowNode,this.column=e.column,this.createAndAddIcons(),this.onSelectionChanged(),this.addGuiEventListener("click",function(e){return u.Utils.stopPropagationForAgGrid(e)}),this.addGuiEventListener("dblclick",function(e){return u.Utils.stopPropagationForAgGrid(e)}),this.addDestroyableEventListener(this.eCheckedIcon,"click",this.onCheckedClicked.bind(this)),this.addDestroyableEventListener(this.eUncheckedIcon,"click",this.onUncheckedClicked.bind(this)),this.addDestroyableEventListener(this.eIndeterminateIcon,"click",this.onIndeterminateClicked.bind(this)),this.addDestroyableEventListener(this.rowNode,c.RowNode.EVENT_ROW_SELECTED,this.onSelectionChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,c.RowNode.EVENT_DATA_CHANGED,this.onDataChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,c.RowNode.EVENT_SELECTABLE_CHANGED,this.onSelectableChanged.bind(this)),this.isRowSelectableFunc=this.gridOptionsWrapper.getIsRowSelectableFunc(),(this.isRowSelectableFunc||this.checkboxCallbackExists())&&(this.addDestroyableEventListener(this.eventService,p.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.showOrHideSelect.bind(this)),this.showOrHideSelect())},y.prototype.showOrHideSelect=function(){var e=this.rowNode.selectable;e&&this.checkboxCallbackExists()&&(e=this.column.isCellCheckboxSelection(this.rowNode)),this.setVisible(e)},y.prototype.checkboxCallbackExists=function(){var e=this.column?this.column.getColDef():null;return e&&"function"==typeof e.checkboxSelection},r([d.Autowired("gridOptionsWrapper"),a("design:type",h.GridOptionsWrapper)],y.prototype,"gridOptionsWrapper",void 0),r([d.Autowired("eventService"),a("design:type",f.EventService)],y.prototype,"eventService",void 0),r([d.Autowired("gridApi"),a("design:type",g.GridApi)],y.prototype,"gridApi",void 0),r([d.Autowired("columnApi"),a("design:type",m.ColumnApi)],y.prototype,"columnApi",void 0),y);function y(){return s.call(this,'<span class="ag-selection-checkbox"/>')||this}t.CheckboxSelectionComponent=v},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r,a,s=i(67),l=i(0),c=i(68),u=i(125),d=i(126),h=i(91),p=i(27),f=i(72),g=i(71),m=i(70),v=i(50),y=i(75),b=i(92),w=i(93),C=i(94),_=i(95),A=i(96),E=i(127),x=i(128),S=i(1);(a=r=t.RegisteredComponentSource||(t.RegisteredComponentSource={}))[a.DEFAULT=0]="DEFAULT",a[a.REGISTERED=1]="REGISTERED";var T=(D.prototype.init=function(){var t=this;null!=this.gridOptions.components&&Object.keys(this.gridOptions.components).forEach(function(e){t.registerComponent(e,t.gridOptions.components[e])}),null!=this.gridOptions.frameworkComponents&&Object.keys(this.gridOptions.frameworkComponents).forEach(function(e){t.registerFwComponent(e,t.gridOptions.frameworkComponents[e])})},D.prototype.registerDefaultComponent=function(e,t,i){void 0===i&&(i=!0);var n=this.translateIfDeprecated(e);this.agGridDefaults[n]?console.error("Trying to overwrite a default component. You should call registerComponent"):this.agGridDefaults[n]=t},D.prototype.registerComponent=function(e,t){var i=this.translateIfDeprecated(e);this.frameworkComponents[i]?console.error("Trying to register a component that you have already registered for frameworks: "+i):this.jsComponents[i]=t},D.prototype.registerFwComponent=function(e,t){var i=this.translateIfDeprecated(e);this.jsComponents[i]?console.error("Trying to register a component that you have already registered for plain javascript: "+i):this.frameworkComponents[i]=t},D.prototype.retrieve=function(e){var t=this.translateIfDeprecated(e);return this.frameworkComponents[t]?{type:p.ComponentType.FRAMEWORK,component:this.frameworkComponents[t],source:r.REGISTERED}:this.jsComponents[t]?{type:p.ComponentType.AG_GRID,component:this.jsComponents[t],source:r.REGISTERED}:this.agGridDefaults[t]?this.agGridDefaults[t]?{type:p.ComponentType.AG_GRID,component:this.agGridDefaults[t],source:r.DEFAULT}:null:(Object.keys(this.agGridDefaults).indexOf(t)<0&&console.warn("ag-grid: Looking for component ["+t+"] but it wasn't found."),null)},D.prototype.translateIfDeprecated=function(e){var t=this.agDeprecatedNames[e];return null!=t?(S._.doOnce(function(){console.warn("ag-grid. Since v15.0 component names have been renamed to be namespaced. You should rename "+t.propertyHolder+":"+e+" to "+t.propertyHolder+":"+t.newComponentName)},"DEPREACTE_COMPONENT_"+e),t.newComponentName):e},n([l.Autowired("gridOptions"),o("design:type",Object)],D.prototype,"gridOptions",void 0),n([l.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],D.prototype,"init",null),D=n([l.Bean("componentProvider")],D));function D(){this.agGridDefaults={agDateInput:c.DefaultDateComponent,agColumnHeader:u.HeaderComp,agColumnGroupHeader:d.HeaderGroupComp,agSetColumnFloatingFilter:h.SetFloatingFilterComp,agTextColumnFloatingFilter:h.TextFloatingFilterComp,agNumberColumnFloatingFilter:h.NumberFloatingFilterComp,agDateColumnFloatingFilter:h.DateFloatingFilterComp,agAnimateShowChangeCellRenderer:g.AnimateShowChangeCellRenderer,agAnimateSlideCellRenderer:m.AnimateSlideCellRenderer,agGroupCellRenderer:f.GroupCellRenderer,agGroupRowRenderer:f.GroupCellRenderer,agLoadingCellRenderer:v.LoadingCellRenderer,agCellEditor:s.TextCellEditor,agTextCellEditor:s.TextCellEditor,agSelectCellEditor:y.SelectCellEditor,agPopupTextCellEditor:b.PopupTextCellEditor,agPopupSelectCellEditor:w.PopupSelectCellEditor,agLargeTextCellEditor:C.LargeTextCellEditor,agTextColumnFilter:_.TextFilter,agNumberColumnFilter:A.NumberFilter,agDateColumnFilter:c.DateFilter,agLoadingOverlay:E.LoadingOverlayComponent,agNoRowsOverlay:x.NoRowsOverlayComponent},this.agDeprecatedNames={set:{newComponentName:"agSetColumnFilter",propertyHolder:"filter"},text:{newComponentName:"agTextColumnFilter",propertyHolder:"filter"},number:{newComponentName:"agNumberColumnFilter",propertyHolder:"filter"},date:{newComponentName:"agDateColumnFilter",propertyHolder:"filter"},group:{newComponentName:"agGroupCellRenderer",propertyHolder:"cellRenderer"},animateShowChange:{newComponentName:"agAnimateShowChangeCellRenderer",propertyHolder:"cellRenderer"},animateSlide:{newComponentName:"agAnimateSlideCellRenderer",propertyHolder:"cellRenderer"},select:{newComponentName:"agSelectCellEditor",propertyHolder:"cellEditor"},largeText:{newComponentName:"agLargeTextCellEditor",propertyHolder:"cellEditor"},popupSelect:{newComponentName:"agPopupSelectCellEditor",propertyHolder:"cellEditor"},popupText:{newComponentName:"agPopupTextCellEditor",propertyHolder:"cellEditor"},richSelect:{newComponentName:"agRichSelectCellEditor",propertyHolder:"cellEditor"},headerComponent:{newComponentName:"agColumnHeader",propertyHolder:"headerComponent"}},this.jsComponents={},this.frameworkComponents={}}t.ComponentProvider=T},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r,a=i(9),s=i(8),l=i(1),c=(r=s.Component,o(u,r),u.prototype.init=function(e){this.params=e;var t,i=this.getGui();e.cellStartedEdit?(this.focusAfterAttached=!0,e.keyPress===a.Constants.KEY_BACKSPACE||e.keyPress===a.Constants.KEY_DELETE?t="":e.charPress?t=e.charPress:(t=this.getStartValue(e),e.keyPress!==a.Constants.KEY_F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,t=this.getStartValue(e)),l.Utils.exists(t)&&(i.value=t),this.addDestroyableEventListener(i,"keydown",function(e){if(e.keyCode===a.Constants.KEY_LEFT||e.keyCode===a.Constants.KEY_RIGHT||e.keyCode===a.Constants.KEY_UP||e.keyCode===a.Constants.KEY_DOWN||e.keyCode===a.Constants.KEY_PAGE_DOWN||e.keyCode===a.Constants.KEY_PAGE_UP||e.keyCode===a.Constants.KEY_PAGE_HOME||e.keyCode===a.Constants.KEY_PAGE_END){e.stopPropagation();var t=e.keyCode===a.Constants.KEY_PAGE_UP,i=e.keyCode===a.Constants.KEY_PAGE_DOWN;(t||i)&&e.preventDefault()}})},u.prototype.afterGuiAttached=function(){if(this.focusAfterAttached){var e=this.getGui();if(e.focus(),this.highlightAllOnFocus)e.select();else{var t=e.value?e.value.length:0;0<t&&e.setSelectionRange(t,t)}}},u.prototype.focusIn=function(){var e=this.getGui();e.focus(),e.select()},u.prototype.getValue=function(){var e=this.getGui();return this.params.parseValue(e.value)},u.prototype.getStartValue=function(e){return e.useFormatter||e.column.getColDef().refData?e.formatValue(e.value):e.value},u.TEMPLATE='<input class="ag-cell-edit-input" type="text"/>',u);function u(){return r.call(this,u.TEMPLATE)||this}t.TextCellEditor=c},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(8),c=i(11),u=i(1),d=i(51),h=i(0),p=i(21),f=(s=d.ScalarBaseFilter,o(g,s),g.prototype.modelFromFloatingFilter=function(e){return{dateFrom:e,dateTo:this.getDateTo(),type:this.filter,filterType:"date"}},g.prototype.getApplicableFilterTypes=function(){return[d.BaseFilter.EQUALS,d.BaseFilter.GREATER_THAN,d.BaseFilter.LESS_THAN,d.BaseFilter.NOT_EQUAL,d.BaseFilter.IN_RANGE]},g.prototype.bodyTemplate=function(e){return'<div class="ag-filter-body">\n                    <div class="ag-filter-date-from" id="'+(e==d.FilterConditionType.MAIN?"filterDateFromPanel":"filterDateFromConditionPanel")+'">\n                    </div>\n                    <div class="ag-filter-date-to" id="'+(e==d.FilterConditionType.MAIN?"filterDateToPanel":"filterDateToConditionPanel")+'">\n                    </div>\n                </div>'},g.prototype.initialiseFilterBodyUi=function(e){s.prototype.initialiseFilterBodyUi.call(this,e),this.createComponents(e),e===d.FilterConditionType.MAIN?(this.setDateFrom_date(this.dateFrom,d.FilterConditionType.MAIN),this.setDateTo_date(this.dateTo,d.FilterConditionType.MAIN),this.setFilterType(this.filterCondition,d.FilterConditionType.MAIN)):(this.setDateFrom_date(this.dateFromCondition,d.FilterConditionType.CONDITION),this.setDateTo_date(this.dateToCondition,d.FilterConditionType.CONDITION),this.setFilterType(this.filterCondition,d.FilterConditionType.CONDITION))},g.prototype.createComponents=function(i){var n=this,e={onDateChanged:function(){n.onDateChanged(i)},filterParams:this.filterParams};this.componentRecipes.newDateComponent(e).then(function(e){i===d.FilterConditionType.MAIN?n.dateToComponent=e:n.dateToConditionComponent=e;var t=e.getGui();i===d.FilterConditionType.MAIN?(n.eDateToPanel.appendChild(t),n.dateToComponent.afterGuiAttached&&n.dateToComponent.afterGuiAttached()):(n.eDateToConditionPanel.appendChild(t),n.dateToConditionComponent.afterGuiAttached&&n.dateToConditionComponent.afterGuiAttached())}),this.componentRecipes.newDateComponent(e).then(function(e){i===d.FilterConditionType.MAIN?n.dateFromComponent=e:n.dateFromConditionComponent=e;var t=e.getGui();i===d.FilterConditionType.MAIN?(n.eDateFromPanel.appendChild(t),n.dateFromComponent.afterGuiAttached&&n.dateFromComponent.afterGuiAttached()):(n.eDateFromConditionPanel.appendChild(t),n.dateFromConditionComponent.afterGuiAttached&&n.dateFromConditionComponent.afterGuiAttached())})},g.prototype.onDateChanged=function(e){e===d.FilterConditionType.MAIN?(this.dateFrom=g.removeTimezone(this.dateFromComponent.getDate()),this.dateTo=g.removeTimezone(this.dateToComponent.getDate())):(this.dateFromCondition=g.removeTimezone(this.dateFromComponent.getDate()),this.dateToCondition=g.removeTimezone(this.dateToComponent.getDate())),this.onFilterChanged()},g.prototype.refreshFilterBodyUi=function(e){var t,i;if(i=e===d.FilterConditionType.MAIN?(t=this.eDateToPanel,this.filter):(t=this.eDateToConditionPanel,this.filterCondition),t){var n=i===d.BaseFilter.IN_RANGE;u.Utils.setVisible(t,n)}},g.prototype.comparator=function(){return this.filterParams.comparator?this.filterParams.comparator:this.defaultComparator.bind(this)},g.prototype.defaultComparator=function(e,t){return t<e?-1:e<t?1:null!=t?0:-1},g.prototype.serialize=function(e){var t=e===d.FilterConditionType.MAIN?this.dateToComponent:this.dateToConditionComponent,i=e===d.FilterConditionType.MAIN?this.dateFromComponent:this.dateFromConditionComponent,n=e===d.FilterConditionType.MAIN?this.filter:this.filterCondition;return{dateTo:u.Utils.serializeDateToYyyyMmDd(t.getDate(),"-"),dateFrom:u.Utils.serializeDateToYyyyMmDd(i.getDate(),"-"),type:n||this.defaultFilter,filterType:"date"}},g.prototype.filterValues=function(e){return e===d.FilterConditionType.MAIN?this.dateFromComponent?this.filter!==d.BaseFilter.IN_RANGE?this.dateFromComponent.getDate():[this.dateFromComponent.getDate(),this.dateToComponent.getDate()]:null:this.dateFromConditionComponent?this.filterCondition!==d.BaseFilter.IN_RANGE?this.dateFromConditionComponent.getDate():[this.dateFromConditionComponent.getDate(),this.dateToConditionComponent.getDate()]:null},g.prototype.getDateFrom=function(){return u.Utils.serializeDateToYyyyMmDd(this.dateFromComponent.getDate(),"-")},g.prototype.getDateTo=function(){return u.Utils.serializeDateToYyyyMmDd(this.dateToComponent.getDate(),"-")},g.prototype.getFilterType=function(){return this.filter},g.prototype.setDateFrom=function(e,t){var i=u.Utils.parseYyyyMmDdToDate(e,"-");this.setDateFrom_date(i,t)},g.prototype.setDateFrom_date=function(e,t){if(t===d.FilterConditionType.MAIN){if(this.dateFrom=e,!this.dateFromComponent)return;this.dateFromComponent.setDate(this.dateFrom)}else{if(this.dateFromCondition=e,!this.dateFromConditionComponent)return;this.dateFromConditionComponent.setDate(this.dateFromCondition)}},g.prototype.setDateTo=function(e,t){var i=u.Utils.parseYyyyMmDdToDate(e,"-");this.setDateTo_date(i,t)},g.prototype.setDateTo_date=function(e,t){if(t===d.FilterConditionType.MAIN){if(this.dateTo=e,!this.dateToComponent)return;this.dateToComponent.setDate(this.dateTo)}else{if(this.dateToCondition=e,!this.dateToConditionComponent)return;this.dateToConditionComponent.setDate(this.dateToCondition)}},g.prototype.resetState=function(){this.setDateFrom(null,d.FilterConditionType.MAIN),this.setDateTo(null,d.FilterConditionType.MAIN),this.setFilterType(this.defaultFilter,d.FilterConditionType.MAIN),this.setDateFrom(null,d.FilterConditionType.CONDITION),this.setDateTo(null,d.FilterConditionType.CONDITION),this.setFilterType(this.defaultFilter,d.FilterConditionType.MAIN)},g.prototype.parse=function(e,t){this.setDateFrom(e.dateFrom,t),this.setDateTo(e.dateTo,t),this.setFilterType(e.type,t)},g.prototype.setType=function(e,t){this.setFilterType(e,t)},g.removeTimezone=function(e){return e?new Date(e.getFullYear(),e.getMonth(),e.getDate()):null},r([h.Autowired("componentRecipes"),a("design:type",p.ComponentRecipes)],g.prototype,"componentRecipes",void 0),r([c.QuerySelector("#filterDateFromPanel"),a("design:type",HTMLElement)],g.prototype,"eDateFromPanel",void 0),r([c.QuerySelector("#filterDateFromConditionPanel"),a("design:type",HTMLElement)],g.prototype,"eDateFromConditionPanel",void 0),r([c.QuerySelector("#filterDateToPanel"),a("design:type",HTMLElement)],g.prototype,"eDateToPanel",void 0),r([c.QuerySelector("#filterDateToConditionPanel"),a("design:type",HTMLElement)],g.prototype,"eDateToConditionPanel",void 0),g);function g(){return null!==s&&s.apply(this,arguments)||this}t.DateFilter=f;var m,v=(m=l.Component,o(y,m),y.prototype.init=function(e){this.eDateInput=this.getGui(),(u.Utils.isBrowserChrome()||e.filterParams.browserDatePicker)&&(u.Utils.isBrowserIE()?console.warn("ag-grid: browserDatePicker is specified to true, but it is not supported in IE 11, reverting to plain text date picker"):this.eDateInput.type="date"),this.listener=e.onDateChanged,this.addGuiEventListener("input",this.listener)},y.prototype.getDate=function(){return u.Utils.parseYyyyMmDdToDate(this.eDateInput.value,"-")},y.prototype.setDate=function(e){this.eDateInput.value=u.Utils.serializeDateToYyyyMmDd(e,"-")},y);function y(){return m.call(this,'<input class="ag-filter-filter" type="text" placeholder="yyyy-mm-dd">')||this}t.DefaultDateComponent=v},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(8),c=i(0),u=i(2),d=(s=l.Component,o(h,s),h.prototype.onKeyDown=function(e){this.params.onKeyDown(e)},h.prototype.getGui=function(){return this.getGuiCalledOnChild||(this.appendChild(this.cellEditor.getGui()),this.getGuiCalledOnChild=!0),s.prototype.getGui.call(this)},h.prototype.init=function(e){var t=this;this.params=e,this.gridOptionsWrapper.setDomData(this.getGui(),h.DOM_KEY_POPUP_EDITOR_WRAPPER,!0),this.addDestroyFunc(function(){t.cellEditor.destroy&&t.cellEditor.destroy()}),this.addDestroyableEventListener(s.prototype.getGui.call(this),"keydown",this.onKeyDown.bind(this))},h.prototype.afterGuiAttached=function(){this.cellEditor.afterGuiAttached&&this.cellEditor.afterGuiAttached()},h.prototype.getValue=function(){return this.cellEditor.getValue()},h.prototype.isPopup=function(){return!0},h.prototype.isCancelBeforeStart=function(){if(this.cellEditor.isCancelBeforeStart)return this.cellEditor.isCancelBeforeStart()},h.prototype.isCancelAfterEnd=function(){if(this.cellEditor.isCancelAfterEnd)return this.cellEditor.isCancelAfterEnd()},h.prototype.focusIn=function(){this.cellEditor.focusIn&&this.cellEditor.focusIn()},h.prototype.focusOut=function(){this.cellEditor.focusOut&&this.cellEditor.focusOut()},h.DOM_KEY_POPUP_EDITOR_WRAPPER="popupEditorWrapper",r([c.Autowired("gridOptionsWrapper"),a("design:type",u.GridOptionsWrapper)],h.prototype,"gridOptionsWrapper",void 0),h);function h(e){var t=s.call(this,'<div class="ag-popup-editor" tabindex="-1"/>')||this;return t.getGuiCalledOnChild=!1,t.cellEditor=e,t}t.PopupEditorWrapper=d},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r,a=i(1),s=i(8),l=(r=s.Component,o(c,r),c.prototype.init=function(e){this.params=e,this.refresh(e)},c.prototype.addSlideAnimation=function(){var e=this;this.refreshCount++;var t=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious),this.ePrevious=a.Utils.loadTemplate('<span class="ag-value-slide-previous ag-value-slide-out"></span>'),this.ePrevious.innerHTML=this.eCurrent.innerHTML,this.getGui().insertBefore(this.ePrevious,this.eCurrent),setTimeout(function(){t===e.refreshCount&&a.Utils.addCssClass(e.ePrevious,"ag-value-slide-out-end")},50),setTimeout(function(){t===e.refreshCount&&(e.getGui().removeChild(e.ePrevious),e.ePrevious=null)},3e3)},c.prototype.refresh=function(e){var t=e.value;if(a.Utils.missing(t)&&(t=""),t!==this.lastValue)return this.addSlideAnimation(),this.lastValue=t,a.Utils.exists(e.valueFormatted)?this.eCurrent.innerHTML=e.valueFormatted:a.Utils.exists(e.value)?this.eCurrent.innerHTML=t:this.eCurrent.innerHTML="",!0},c.TEMPLATE='<span><span class="ag-value-slide-current"></span></span>',c);function c(){var e=r.call(this,c.TEMPLATE)||this;return e.refreshCount=0,e.eCurrent=e.queryForHtmlElement(".ag-value-slide-current"),e}t.AnimateSlideCellRenderer=l},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r,a=i(1),s=i(8),l=(r=s.Component,o(c,r),c.prototype.init=function(e){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(e)},c.prototype.showDelta=function(e,t){var i=Math.abs(t),n=e.formatValue(i),o=a.Utils.exists(n)?n:i,r=0<=t;this.eDelta.innerHTML=r?"&#65514;"+o:"&#65516;"+o,a.Utils.addOrRemoveCssClass(this.eDelta,"ag-value-change-delta-up",r),a.Utils.addOrRemoveCssClass(this.eDelta,"ag-value-change-delta-down",!r)},c.prototype.setTimerToRemoveDelta=function(){var e=this;this.refreshCount++;var t=this.refreshCount;setTimeout(function(){t===e.refreshCount&&e.hideDeltaValue()},2e3)},c.prototype.hideDeltaValue=function(){a.Utils.removeCssClass(this.eValue,"ag-value-change-value-highlight"),this.eDelta.innerHTML=""},c.prototype.refresh=function(e){var t=e.value;if(t!==this.lastValue){if(a.Utils.exists(e.valueFormatted)?this.eValue.innerHTML=e.valueFormatted:a.Utils.exists(e.value)?this.eValue.innerHTML=t:this.eValue.innerHTML="","number"==typeof t&&"number"==typeof this.lastValue){var i=t-this.lastValue;this.showDelta(e,i)}return this.lastValue&&a.Utils.addCssClass(this.eValue,"ag-value-change-value-highlight"),this.setTimerToRemoveDelta(),this.lastValue=t,!0}},c.TEMPLATE='<span><span class="ag-value-change-delta"></span><span class="ag-value-change-value"></span></span>',c);function c(){var e=r.call(this,c.TEMPLATE)||this;return e.refreshCount=0,e}t.AnimateShowChangeCellRenderer=l},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(2),c=i(19),u=i(3),d=i(9),h=i(1),p=i(0),f=i(8),g=i(14),m=i(56),v=i(43),y=i(65),b=i(4),w=i(10),C=i(11),_=i(44),A=(s=f.Component,o(E,s),E.prototype.init=function(e){this.params=e,this.gridOptionsWrapper.isGroupIncludeTotalFooter()&&this.assignBlankValueToGroupFooterCell(e);var t=this.isEmbeddedRowMismatch(),i=null==e.value;this.cellIsBlank=t||i,this.cellIsBlank||(this.setupDragOpenParents(),this.addExpandAndContract(),this.addCheckboxIfNeeded(),this.addValueElement(),this.setupIndent())},E.prototype.assignBlankValueToGroupFooterCell=function(e){e.value||-1!=e.node.level||(e.value="")},E.prototype.isEmbeddedRowMismatch=function(){if(this.params.fullWidth&&this.gridOptionsWrapper.isEmbedFullWidthRows()){var e=this.params.pinned===w.Column.PINNED_LEFT,t=this.params.pinned===w.Column.PINNED_RIGHT,i=!e&&!t;return this.gridOptionsWrapper.isEnableRtl()?this.columnController.isPinningLeft()?!t:!i:this.columnController.isPinningLeft()?!e:!i}return!1},E.prototype.setIndent=function(){if(!this.gridOptionsWrapper.isGroupHideOpenParents()){var e=this.params,t=e.node.uiLevel;0<=e.padding?this.setPaddingDeprecatedWay(t,e.padding):(this.indentClass&&this.removeCssClass(this.indentClass),this.indentClass="ag-row-group-indent-"+t,this.addCssClass(this.indentClass))}},E.prototype.setPaddingDeprecatedWay=function(e,t){h.Utils.doOnce(function(){return console.warn("ag-Grid: since v14.2, configuring padding for groupCellRenderer should be done with Sass variables and themes. Please see the ag-Grid documentation page for Themes, in particular the property $row-group-indent-size.")},"groupCellRenderer->doDeprecatedWay");var i=e*t;this.gridOptionsWrapper.isEnableRtl()?this.getGui().style.paddingRight=i+"px":this.getGui().style.paddingLeft=i+"px"},E.prototype.setupIndent=function(){var e=this.params.node;this.params.suppressPadding||(this.addDestroyableEventListener(e,g.RowNode.EVENT_UI_LEVEL_CHANGED,this.setIndent.bind(this)),this.setIndent())},E.prototype.addValueElement=function(){var e=this.params,t=this.displayedGroup;t.footer?this.createFooterCell():t.hasChildren()||h.Utils.get(e.colDef,"cellRendererParams.innerRenderer",null)||h.Utils.get(e.colDef,"cellRendererParams.innerRendererFramework",null)?(this.createGroupCell(),t.hasChildren()&&this.addChildCount()):this.createLeafCell()},E.prototype.createFooterCell=function(){var e,t=this.params.footerValueGetter;if(t){var i=h.Utils.cloneObject(this.params);i.value=this.params.value,"function"==typeof t?e=t(i):"string"==typeof t?e=this.expressionService.evaluate(t,i):console.warn("ag-Grid: footerValueGetter should be either a function or a string (expression)")}else e="Total "+this.params.value;this.eValue.innerHTML=e},E.prototype.createGroupCell=function(){var e,t=this,i=this.params,n=this.displayedGroup.rowGroupColumn,o=n||i.column,r=this.params.value,a=o?this.valueFormatterService.formatValue(o,i.node,i.scope,r):null;i.valueFormatted=a,(e=1==i.fullWidth?this.cellRendererService.useFullWidthGroupRowInnerCellRenderer(this.eValue,i):this.cellRendererService.useInnerCellRenderer(this.params.colDef.cellRendererParams,o.getColDef(),this.eValue,i))&&e.then(function(e){t.innerCellRenderer=e})},E.prototype.addChildCount=function(){this.params.suppressCount||(this.addDestroyableEventListener(this.displayedGroup,g.RowNode.EVENT_ALL_CHILDREN_COUNT_CHANGED,this.updateChildCount.bind(this)),this.updateChildCount())},E.prototype.updateChildCount=function(){var e=this.displayedGroup.allChildrenCount;this.eChildCount.innerHTML=0<=e?"("+e+")":""},E.prototype.createLeafCell=function(){h.Utils.exists(this.params.value)&&(this.eValue.innerHTML=this.params.valueFormatted?this.params.valueFormatted:this.params.value)},E.prototype.isUserWantsSelected=function(){var e=this.params.checkbox;return"function"==typeof e?e(this.params):!0===e},E.prototype.addCheckboxIfNeeded=function(){var e=this.displayedGroup;if(this.isUserWantsSelected()&&!e.footer&&!e.rowPinned&&!e.detail){var t=new y.CheckboxSelectionComponent;this.context.wireBean(t),t.init({rowNode:e,column:this.params.column}),this.eCheckbox.appendChild(t.getGui()),this.addDestroyFunc(function(){return t.destroy()})}},E.prototype.addExpandAndContract=function(){var e=this.params,t=e.eGridCell,i=h.Utils.createIconNoSpan("groupExpanded",this.gridOptionsWrapper,null),n=h.Utils.createIconNoSpan("groupContracted",this.gridOptionsWrapper,null);this.eExpanded.appendChild(i),this.eContracted.appendChild(n),this.addDestroyableEventListener(this.eExpanded,"click",this.onExpandClicked.bind(this)),this.addDestroyableEventListener(this.eContracted,"click",this.onExpandClicked.bind(this)),this.addDestroyableEventListener(t,"keydown",this.onKeyDown.bind(this)),this.addDestroyableEventListener(e.node,g.RowNode.EVENT_EXPANDED_CHANGED,this.showExpandAndContractIcons.bind(this)),this.showExpandAndContractIcons(),this.addDestroyableEventListener(this.displayedGroup,g.RowNode.EVENT_ALL_CHILDREN_COUNT_CHANGED,this.onAllChildrenCountChanged.bind(this)),this.gridOptionsWrapper.isEnableGroupEdit()||!this.isExpandable()||e.suppressDoubleClickExpand||this.addDestroyableEventListener(t,"dblclick",this.onCellDblClicked.bind(this))},E.prototype.onAllChildrenCountChanged=function(){this.showExpandAndContractIcons(),this.setIndent()},E.prototype.onKeyDown=function(e){if(h.Utils.isKeyPressed(e,d.Constants.KEY_ENTER)){if(this.params.column.isCellEditable(this.params.node))return;e.preventDefault(),this.onExpandOrContract()}},E.prototype.setupDragOpenParents=function(){var e=this.params.column,t=this.params.node;if(this.gridOptionsWrapper.isGroupHideOpenParents())if(t.hasChildren()){var i=t.rowGroupColumn;this.draggedFromHideOpenParents=!e.isRowGroupDisplayed(i.getId())}else this.draggedFromHideOpenParents=!0;else this.draggedFromHideOpenParents=!1;if(this.draggedFromHideOpenParents)for(var n=t.parent;!h.Utils.missing(n);){if(n.rowGroupColumn&&e.isRowGroupDisplayed(n.rowGroupColumn.getId())){this.displayedGroup=n;break}n=n.parent}h.Utils.missing(this.displayedGroup)&&(this.displayedGroup=t)},E.prototype.onExpandClicked=function(e){h.Utils.isStopPropagationForAgGrid(e)||(h.Utils.stopPropagationForAgGrid(e),this.onExpandOrContract())},E.prototype.onCellDblClicked=function(e){h.Utils.isStopPropagationForAgGrid(e)||h.Utils.isElementInEventPath(this.eExpanded,e)||h.Utils.isElementInEventPath(this.eContracted,e)||this.onExpandOrContract()},E.prototype.onExpandOrContract=function(){var e=this.displayedGroup;e.setExpanded(!e.expanded),this.gridOptionsWrapper.isGroupIncludeFooter()&&this.params.api.redrawRows({rowNodes:[e]})},E.prototype.isExpandable=function(){var e=this.params.node,t=this.columnController.isPivotMode()&&e.leafGroup;return this.draggedFromHideOpenParents||e.isExpandable()&&!e.footer&&!t},E.prototype.showExpandAndContractIcons=function(){var e=this.params.node;if(this.isExpandable()){var t=!!this.draggedFromHideOpenParents||e.expanded;h.Utils.setVisible(this.eContracted,!t),h.Utils.setVisible(this.eExpanded,t)}else h.Utils.setVisible(this.eExpanded,!1),h.Utils.setVisible(this.eContracted,!1);var i=this.displayedGroup,n=this.columnController.isPivotMode()&&i.leafGroup,o=!i.isExpandable(),r=i.footer||o||n;this.addOrRemoveCssClass("ag-row-group-leaf-indent",r)},E.prototype.destroy=function(){s.prototype.destroy.call(this),this.innerCellRenderer&&this.innerCellRenderer.destroy&&this.innerCellRenderer.destroy()},E.prototype.refresh=function(){return!1},E.TEMPLATE='<span><span class="ag-group-expanded" ref="eExpanded"></span><span class="ag-group-contracted" ref="eContracted"></span><span class="ag-group-checkbox" ref="eCheckbox"></span><span class="ag-group-value" ref="eValue"></span><span class="ag-group-child-count" ref="eChildCount"></span></span>',r([p.Autowired("gridOptionsWrapper"),a("design:type",l.GridOptionsWrapper)],E.prototype,"gridOptionsWrapper",void 0),r([p.Autowired("expressionService"),a("design:type",c.ExpressionService)],E.prototype,"expressionService",void 0),r([p.Autowired("eventService"),a("design:type",u.EventService)],E.prototype,"eventService",void 0),r([p.Autowired("cellRendererService"),a("design:type",m.CellRendererService)],E.prototype,"cellRendererService",void 0),r([p.Autowired("valueFormatterService"),a("design:type",v.ValueFormatterService)],E.prototype,"valueFormatterService",void 0),r([p.Autowired("context"),a("design:type",p.Context)],E.prototype,"context",void 0),r([p.Autowired("columnController"),a("design:type",b.ColumnController)],E.prototype,"columnController",void 0),r([p.Autowired("mouseEventService"),a("design:type",_.MouseEventService)],E.prototype,"mouseEventService",void 0),r([C.RefSelector("eExpanded"),a("design:type",HTMLElement)],E.prototype,"eExpanded",void 0),r([C.RefSelector("eContracted"),a("design:type",HTMLElement)],E.prototype,"eContracted",void 0),r([C.RefSelector("eCheckbox"),a("design:type",HTMLElement)],E.prototype,"eCheckbox",void 0),r([C.RefSelector("eValue"),a("design:type",HTMLElement)],E.prototype,"eValue",void 0),r([C.RefSelector("eChildCount"),a("design:type",HTMLElement)],E.prototype,"eChildCount",void 0),E);function E(){return s.call(this,E.TEMPLATE)||this}t.GroupCellRenderer=A},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(19),s=(l.prototype.processAllCellClasses=function(e,t,i,n){this.processClassRules(e.cellClassRules,t,i,n),this.processStaticCellClasses(e,t,i)},l.prototype.processClassRules=function(e,t,i,n){if("object"==typeof e&&null!==e)for(var o=Object.keys(e),r=0;r<o.length;r++){var a=o[r],s=e[a],l=void 0;"string"==typeof s?l=this.expressionService.evaluate(s,t):"function"==typeof s&&(l=s(t)),l?i(a):n&&n(a)}},l.prototype.processStaticCellClasses=function(e,t,i){if(e.cellClass){var n=void 0;"string"==typeof(n="function"==typeof e.cellClass?(0,e.cellClass)(t):e.cellClass)?i(n):Array.isArray(n)&&n.forEach(function(e){i(e)})}},n([r.Autowired("expressionService"),o("design:type",a.ExpressionService)],l.prototype,"expressionService",void 0),l=n([r.Bean("stylingService")],l));function l(){}t.StylingService=s},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(13),c=i(0),u=i(45),d=(s=l.BeanStub,o(h,s),h.prototype.addMouseHoverListeners=function(e){this.addDestroyableEventListener(e,"mouseout",this.onMouseOut.bind(this)),this.addDestroyableEventListener(e,"mouseover",this.onMouseOver.bind(this))},h.prototype.onMouseOut=function(){this.columnHoverService.clearMouseOver()},h.prototype.onMouseOver=function(){this.columnHoverService.setMouseOver(this.columns)},r([c.Autowired("columnHoverService"),a("design:type",u.ColumnHoverService)],h.prototype,"columnHoverService",void 0),h);function h(e,t){var i=s.call(this)||this;return i.columns=e,i.addMouseHoverListeners(t),i}t.HoverFeature=d},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(8),c=i(1),u=i(9),d=i(0),h=i(2),p=i(43),f=(s=l.Component,o(g,s),g.prototype.init=function(o){var r=this;this.focusAfterAttached=o.cellStartedEdit,c.Utils.missing(o.values)?console.log("ag-Grid: no values found for select cellEditor"):(o.values.forEach(function(e){var t=document.createElement("option");t.value=e;var i=r.valueFormatterService.formatValue(o.column,null,null,e),n=null!=i;t.text=n?i:e,o.value===e&&(t.selected=!0),r.eSelect.appendChild(t)}),this.gridOptionsWrapper.isFullRowEdit()||this.addDestroyableEventListener(this.eSelect,"change",function(){return o.stopEditing()}),this.addDestroyableEventListener(this.eSelect,"keydown",function(e){e.keyCode!==u.Constants.KEY_UP&&e.keyCode!==u.Constants.KEY_DOWN||e.stopPropagation()}),this.addDestroyableEventListener(this.eSelect,"mousedown",function(e){e.stopPropagation()}))},g.prototype.afterGuiAttached=function(){this.focusAfterAttached&&this.eSelect.focus()},g.prototype.focusIn=function(){this.eSelect.focus()},g.prototype.getValue=function(){return this.eSelect.value},r([d.Autowired("gridOptionsWrapper"),a("design:type",h.GridOptionsWrapper)],g.prototype,"gridOptionsWrapper",void 0),r([d.Autowired("valueFormatterService"),a("design:type",p.ValueFormatterService)],g.prototype,"valueFormatterService",void 0),g);function g(){var e=s.call(this,'<div class="ag-cell-edit-input"><select class="ag-cell-edit-input"/></div>')||this;return e.eSelect=e.getGui().querySelector("select"),e}t.SelectCellEditor=f},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(77),s=i(1),l=(c.prototype.adaptFunction=function(e,t,i,n){if(null==t)return{component:null,type:i,source:n,dynamicParams:null};var o=this.componentMetadataProvider.retrieve(e);return o&&o.functionAdapter?{type:i,component:o.functionAdapter(t),source:n,dynamicParams:null}:null},c.prototype.adaptCellRendererFunction=function(i){function e(){}return e.prototype.refresh=function(e){return!1},e.prototype.getGui=function(){var e=i(this.params),t=typeof e;return"string"==t||"number"==t||"boolean"==t?s._.loadTemplate("<span>"+e+"</span>"):e},e.prototype.init=function(e){this.params=e},e},c.prototype.doesImplementIComponent=function(e){return!!e&&e.prototype&&"getGui"in e.prototype},n([r.Autowired("componentMetadataProvider"),o("design:type",a.ComponentMetadataProvider)],c.prototype,"componentMetadataProvider",void 0),c=n([r.Bean("agComponentUtils")],c));function c(){}t.AgComponentUtils=l},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(76),s=(l.prototype.postConstruct=function(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:[]},headerComponent:{mandatoryMethodList:[],optionalMethodList:[]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached"]},floatingFilterWrapperComponent:{mandatoryMethodList:[],optionalMethodList:[]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","focusIn","focusOut","afterGuiAttached"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},pinnedRowCellRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowInnerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","afterGuiAttached"]},filterComponent:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","afterGuiAttached"]}}},l.prototype.retrieve=function(e){return this.componentMetaData[e]},n([r.Autowired("agComponentUtils"),o("design:type",a.AgComponentUtils)],l.prototype,"agComponentUtils",void 0),n([r.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],l.prototype,"postConstruct",null),l=n([r.Bean("componentMetadataProvider")],l));function l(){}t.ComponentMetadataProvider=s},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(1),c=i(129),u=i(2),d=i(4),h=i(7),p=i(20),f=i(0),g=i(3),m=i(5),v=i(40),y=i(9),b=i(17),w=i(47),C=i(44),_=i(22),A=i(36),E=i(130),x=i(29),S=i(69),T=i(58),D=i(30),k=i(6),R=i(37),O=i(50),N=i(97),F=i(16),M=i(46),P=i(21),I=i(15),L=i(131),G=i(57),$=i(8),B=i(79),j=i(53),W=i(39),H=i(28),z=i(11),V=i(80),U=(s=$.Component,o(Y,s),Y.prototype.getVScrollPosition=function(){return{top:this.eBodyViewport.scrollTop,bottom:this.eBodyViewport.scrollTop+this.eBodyViewport.offsetHeight}},Y.prototype.getHScrollPosition=function(){return{left:this.eBodyViewport.scrollLeft,right:this.eBodyViewport.scrollTop+this.eBodyViewport.offsetWidth}},Y.prototype.destroy=function(){s.prototype.destroy.call(this)},Y.prototype.onRowDataChanged=function(){this.showOrHideOverlay()},Y.prototype.showOrHideOverlay=function(){this.paginationProxy.isEmpty()&&!this.gridOptionsWrapper.isSuppressNoRowsOverlay()?this.showNoRowsOverlay():this.hideOverlay()},Y.prototype.onNewColumnsLoaded=function(){this.columnController.isReady()&&!this.paginationProxy.isEmpty()&&this.hideOverlay()},Y.prototype.init=function(){this.instantiate(this.context),this.scrollWidth=this.gridOptionsWrapper.getScrollbarWidth(),this.enableRtl=this.gridOptionsWrapper.isEnableRtl(),this.useAnimationFrame=!this.gridOptionsWrapper.isSuppressAnimationFrame(),this.scrollClipWidth=0<this.scrollWidth?this.scrollWidth:20,this.suppressScrollOnFloatingRow(),this.setupRowAnimationCssClass(),this.buildRowContainerComponents(),this.addEventListeners(),this.addDragListeners(),this.addScrollListener(),this.gridOptionsWrapper.isSuppressHorizontalScroll()&&(this.eBodyViewport.style.overflowX="hidden"),this.setupOverlay(),this.gridOptionsWrapper.isRowModelDefault()&&!this.gridOptionsWrapper.getRowData()&&this.showLoadingOverlay(),this.setPinnedContainersVisible(),this.setBodyAndHeaderHeights(),this.disableBrowserDragging(),this.addShortcutKeyListeners(),this.addMouseListeners(),this.addKeyboardEvents(),this.addBodyViewportListener(),this.addStopEditingWhenGridLosesFocus(),this.mockContextMenuForIPad(),this.addRowDragListener(),this.$scope&&this.addAngularApplyCheck(),this.onDisplayedColumnsWidthChanged(),this.gridApi.registerGridComp(this),this.alignedGridsService.registerGridComp(this),this.headerRootComp.registerGridComp(this),this.animationFrameService.registerGridComp(this),this.navigationService.registerGridComp(this),this.heightScaler.registerGridComp(this),this.autoHeightCalculator.registerGridComp(this),this.columnAnimationService.registerGridComp(this),this.autoWidthCalculator.registerGridComp(this),this.paginationAutoPageSizeService.registerGridComp(this),this.beans.registerGridComp(this),this.rowRenderer.registerGridComp(this),this.rangeController&&this.rangeController.registerGridComp(this);var e=c.observeResize(this.eBodyViewport,this.checkViewportAndScrolls.bind(this));this.addDestroyFunc(function(){return e()})},Y.prototype.setColumnMovingCss=function(e){this.addOrRemoveCssClass("ag-column-moving",e)},Y.prototype.setupOverlay=function(){this.overlayWrapper=this.componentRecipes.newOverlayWrapperComponent(),this.eOverlay=this.queryForHtmlElement('[ref="eOverlay"]'),this.overlayWrapper.hideOverlay(this.eOverlay)},Y.prototype.addRowDragListener=function(){var e=new L.RowDragFeature(this.eBody,this);this.context.wireBean(e),this.dragAndDropService.addDropTarget(e)},Y.prototype.addStopEditingWhenGridLosesFocus=function(){var r=this;this.gridOptionsWrapper.isStopEditingWhenGridLosesFocus()&&this.addDestroyableEventListener(this.eBody,"focusout",function(e){for(var t=!1,i=e.relatedTarget;l.Utils.exists(i)&&!t;){var n=!!r.gridOptionsWrapper.getDomData(i,S.PopupEditorWrapper.DOM_KEY_POPUP_EDITOR_WRAPPER),o=r.eBody==i;t=n||o,i=i.parentNode}t||r.rowRenderer.stopEditing()})},Y.prototype.addAngularApplyCheck=function(){function e(){i||(i=!0,setTimeout(function(){i=!1,t.$scope.$apply()},0))}var t=this,i=!1;this.addDestroyableEventListener(this.eventService,m.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addDestroyableEventListener(this.eventService,m.Events.EVENT_VIRTUAL_COLUMNS_CHANGED,e)},Y.prototype.disableBrowserDragging=function(){this.getGui().addEventListener("dragstart",function(e){if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1})},Y.prototype.addEventListeners=function(){this.addDestroyableEventListener(this.eventService,m.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addDestroyableEventListener(this.eventService,m.Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this)),this.addDestroyableEventListener(this.eventService,m.Events.EVENT_PINNED_ROW_DATA_CHANGED,this.setBodyAndHeaderHeights.bind(this)),this.addDestroyableEventListener(this.eventService,m.Events.EVENT_ROW_DATA_CHANGED,this.onRowDataChanged.bind(this)),this.addDestroyableEventListener(this.eventService,m.Events.EVENT_ROW_DATA_UPDATED,this.onRowDataChanged.bind(this)),this.addDestroyableEventListener(this.eventService,m.Events.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.addDestroyableEventListener(this.gridOptionsWrapper,u.GridOptionsWrapper.PROP_HEADER_HEIGHT,this.setBodyAndHeaderHeights.bind(this)),this.addDestroyableEventListener(this.gridOptionsWrapper,u.GridOptionsWrapper.PROP_PIVOT_HEADER_HEIGHT,this.setBodyAndHeaderHeights.bind(this)),this.addDestroyableEventListener(this.gridOptionsWrapper,u.GridOptionsWrapper.PROP_GROUP_HEADER_HEIGHT,this.setBodyAndHeaderHeights.bind(this)),this.addDestroyableEventListener(this.gridOptionsWrapper,u.GridOptionsWrapper.PROP_PIVOT_GROUP_HEADER_HEIGHT,this.setBodyAndHeaderHeights.bind(this)),this.addDestroyableEventListener(this.gridOptionsWrapper,u.GridOptionsWrapper.PROP_FLOATING_FILTERS_HEIGHT,this.setBodyAndHeaderHeights.bind(this))},Y.prototype.addDragListeners=function(){var i=this;this.gridOptionsWrapper.isEnableRangeSelection()&&!l.Utils.missing(this.rangeController)&&[this.eLeftContainer,this.eRightContainer,this.eBodyContainer,this.eTop,this.eBottom].forEach(function(e){var t={eElement:e,onDragStart:i.rangeController.onDragStart.bind(i.rangeController),onDragStop:i.rangeController.onDragStop.bind(i.rangeController),onDragging:i.rangeController.onDragging.bind(i.rangeController),skipMouseEvent:function(e){return e.shiftKey}};i.dragService.addDragSource(t),i.addDestroyFunc(function(){return i.dragService.removeDragSource(t)})})},Y.prototype.addMouseListeners=function(){var n=this;["click","mousedown","dblclick","contextmenu","mouseover","mouseout"].forEach(function(t){var i=n.processMouseEvent.bind(n,t);n.eAllCellContainers.forEach(function(e){return n.addDestroyableEventListener(e,t,i)})})},Y.prototype.addKeyboardEvents=function(){var n=this;["keydown","keypress"].forEach(function(t){var i=n.processKeyboardEvent.bind(n,t);n.eAllCellContainers.forEach(function(e){n.addDestroyableEventListener(e,t,i)})})},Y.prototype.addBodyViewportListener=function(){function e(e){var t=l.Utils.getTarget(e);t!==i.eBodyViewport&&t!==i.eLeftViewport&&t!==i.eRightViewport||(i.onContextMenu(e,null,null,null,null),i.preventDefaultOnContextMenu(e))}var i=this;this.addDestroyableEventListener(this.eBodyViewport,"contextmenu",e),this.addDestroyableEventListener(this.eRightViewport,"contextmenu",e),this.addDestroyableEventListener(this.eLeftViewport,"contextmenu",e)},Y.prototype.getBodyClientRect=function(){if(this.eBody)return this.eBody.getBoundingClientRect()},Y.prototype.getRowForEvent=function(e){for(var t=l.Utils.getTarget(e);t;){var i=this.gridOptionsWrapper.getDomData(t,O.RowComp.DOM_DATA_KEY_RENDERED_ROW);if(i)return i;t=t.parentElement}return null},Y.prototype.processKeyboardEvent=function(e,t){var i=this.mouseEventService.getRenderedCellForEvent(t);if(i)switch(e){case"keydown":this.navigationService.handlePageScrollingKey(t)||i.onKeyDown(t);break;case"keypress":i.onKeyPress(t)}},Y.prototype.scrollToTop=function(){this.eBodyViewport.scrollTop=0},Y.prototype.processMouseEvent=function(e,t){if(this.mouseEventService.isEventFromThisGrid(t)&&!l.Utils.isStopPropagationForAgGrid(t)){var i=this.getRowForEvent(t),n=this.mouseEventService.getRenderedCellForEvent(t);"contextmenu"===e?this.handleContextMenuMouseEvent(t,null,i,n):(n&&n.onMouseEvent(e,t),i&&i.onMouseEvent(e,t)),this.preventDefaultOnContextMenu(t)}},Y.prototype.mockContextMenuForIPad=function(){var n=this;l.Utils.isUserAgentIPad()&&this.eAllCellContainers.forEach(function(e){var t=new M.TouchListener(e);n.addDestroyableEventListener(t,M.TouchListener.EVENT_LONG_TAP,function(e){var t=n.getRowForEvent(e.touchEvent),i=n.mouseEventService.getRenderedCellForEvent(e.touchEvent);n.handleContextMenuMouseEvent(null,e.touchEvent,t,i)}),n.addDestroyFunc(function(){return t.destroy()})})},Y.prototype.handleContextMenuMouseEvent=function(e,t,i,n){var o=i?i.getRowNode():null,r=n?n.getColumn():null,a=null;if(r){var s=e||t;n.dispatchCellContextMenuEvent(s),a=this.valueService.getValue(r,o)}this.onContextMenu(e,t,o,r,a)},Y.prototype.onContextMenu=function(e,t,i,n,o){if((this.gridOptionsWrapper.isAllowContextMenuWithControlKey()||!e||!e.ctrlKey&&!e.metaKey)&&this.contextMenuFactory&&!this.gridOptionsWrapper.isSuppressContextMenu()){var r=e||t.touches[0];this.contextMenuFactory.showMenu(i,n,o,r),(e||t).preventDefault()}},Y.prototype.preventDefaultOnContextMenu=function(e){this.gridOptionsWrapper.isSuppressMiddleClickScrolls()&&2===e.which&&e.preventDefault()},Y.prototype.addShortcutKeyListeners=function(){var i=this;this.eAllCellContainers.forEach(function(e){e.addEventListener("keydown",function(e){var t=i.mouseEventService.getRenderedCellForEvent(e);if((!t||!t.isEditing())&&i.mouseEventService.isEventFromThisGrid(e)&&(e.ctrlKey||e.metaKey))switch(e.which){case y.Constants.KEY_A:return i.onCtrlAndA(e);case y.Constants.KEY_C:return i.onCtrlAndC(e);case y.Constants.KEY_V:return i.onCtrlAndV(e);case y.Constants.KEY_D:return i.onCtrlAndD(e)}})})},Y.prototype.onCtrlAndA=function(e){if(this.rangeController&&this.paginationProxy.isRowsToRender()){var t=void 0,i=void 0,n=void 0;i=this.pinnedRowModel.isEmpty(y.Constants.PINNED_TOP)?null:y.Constants.PINNED_TOP,t=this.pinnedRowModel.isEmpty(y.Constants.PINNED_BOTTOM)?(n=null,this.paginationProxy.getTotalRowCount()-1):(n=y.Constants.PINNED_BOTTOM,this.pinnedRowModel.getPinnedBottomRowData().length-1);var o=this.columnController.getAllDisplayedColumns();if(l.Utils.missingOrEmpty(o))return;this.rangeController.setRange({rowStart:0,floatingStart:i,rowEnd:t,floatingEnd:n,columnStart:o[0],columnEnd:o[o.length-1]})}return e.preventDefault(),!1},Y.prototype.onCtrlAndC=function(e){if(this.clipboardService){var t=this.focusedCellController.getFocusedCell();return this.clipboardService.copyToClipboard(),e.preventDefault(),t&&this.focusedCellController.setFocusedCell(t.rowIndex,t.column,t.floating,!0),!1}},Y.prototype.onCtrlAndV=function(e){if(this.enterprise&&!this.gridOptionsWrapper.isSuppressClipboardPaste())return this.clipboardService.pasteFromClipboard(),!1},Y.prototype.onCtrlAndD=function(e){if(this.enterprise)return this.clipboardService.copyRangeDown(),e.preventDefault(),!1},Y.prototype.ensureIndexVisible=function(e,t){if(!this.gridOptionsWrapper.isGridAutoHeight()){var i=this.paginationProxy.getTotalRowCount();if("number"!=typeof e||e<0||i<=e)console.warn("invalid row index for ensureIndexVisible: "+e);else{this.paginationProxy.goToPageWithIndex(e);var n=this.paginationProxy.getRow(e),o=this.paginationProxy.getPixelOffset(),r=n.rowTop-o,a=r+n.rowHeight,s=this.getVScrollPosition(),l=this.heightScaler.getOffset(),c=s.top+l,u=s.bottom+l;this.isHorizontalScrollShowing()&&(u-=this.scrollWidth);var d=u-c,h=null,p=this.heightScaler.getScrollPositionForPixel(r),f=this.heightScaler.getScrollPositionForPixel(a-d),g=(p+f)/2;r<g&&(g=r),"top"===t?h=p:"bottom"===t?h=f:"middle"===t?h=g:r<c?h=p:u<a&&(h=f),null!==h&&(this.eBodyViewport.scrollTop=h,this.rowRenderer.redrawAfterScroll())}}},Y.prototype.getCenterWidth=function(){return this.eBodyViewport.clientWidth},Y.prototype.isHorizontalScrollShowing=function(){return l.Utils.isHorizontalScrollShowing(this.eBodyViewport)},Y.prototype.isVerticalScrollShowing=function(){return l.Utils.isVerticalScrollShowing(this.eBodyViewport)},Y.prototype.checkViewportAndScrolls=function(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.setPinnedLeftWidth(),this.setPinnedRightWidth(),this.setBottomPaddingOnPinned(),this.hideVerticalScrollOnCenter(),this.hideFullWidthViewportScrollbars()},Y.prototype.updateScrollVisibleService=function(){var e={bodyHorizontalScrollShowing:!1,leftVerticalScrollShowing:!1,rightVerticalScrollShowing:!1};this.enableRtl&&this.columnController.isPinningLeft()&&(e.leftVerticalScrollShowing=l.Utils.isVerticalScrollShowing(this.eLeftViewport)),!this.enableRtl&&this.columnController.isPinningRight()&&(e.rightVerticalScrollShowing=l.Utils.isVerticalScrollShowing(this.eRightViewport)),e.bodyHorizontalScrollShowing=this.isHorizontalScrollShowing(),this.scrollVisibleService.setScrollsVisible(e)},Y.prototype.setBottomPaddingOnPinned=function(){this.scrollWidth<=0||(this.isHorizontalScrollShowing()?(this.eRightContainer.style.marginBottom=this.scrollWidth+"px",this.eLeftContainer.style.marginBottom=this.scrollWidth+"px"):(this.eRightContainer.style.marginBottom="",this.eLeftContainer.style.marginBottom=""))},Y.prototype.hideFullWidthViewportScrollbars=function(){var e=0<this.scrollClipWidth?this.scrollWidth+"px":"";this.eFullWidthViewportWrapper.style.paddingBottom=this.isHorizontalScrollShowing()?e:"";var t=this.isVerticalScrollShowing();this.enableRtl?(this.eFullWidthViewportWrapper.style.marginLeft=t?e:"",this.eFullWidthViewport.style.marginLeft=t?"-"+e:""):(this.eFullWidthViewportWrapper.style.width=t?"calc(100% - "+e+")":"",this.eFullWidthViewport.style.width=t?"calc(100% + "+e+")":"")},Y.prototype.ensureColumnVisible=function(e){var t=this.columnController.getGridColumn(e);if(t)if(t.isPinned())console.warn("calling ensureIndexVisible on a "+t.getPinned()+" pinned column doesn't make sense for column "+t.getColId());else if(this.columnController.isColumnDisplayed(t)){var i,n,o=t.getLeft(),r=o+t.getActualWidth(),a=this.eBodyViewport.clientWidth,s=this.getBodyViewportScrollLeft(),l=this.columnController.getBodyContainerWidth();n=this.enableRtl?(i=l-s-a,l-s):a+(i=s);var c=o<i,u=n<r,d=a<t.getActualWidth(),h=u;if(c||d)if(this.enableRtl){var p=l-a-o;this.setBodyViewportScrollLeft(p)}else this.setBodyViewportScrollLeft(o);else h&&(p=this.enableRtl?l-r:r-a,this.setBodyViewportScrollLeft(p));this.onHorizontalViewportChanged()}else console.warn("column is not currently visible")},Y.prototype.showLoadingOverlay=function(){this.overlayWrapper.showLoadingOverlay(this.eOverlay)},Y.prototype.showNoRowsOverlay=function(){this.overlayWrapper.showNoRowsOverlay(this.eOverlay)},Y.prototype.hideOverlay=function(){this.overlayWrapper.hideOverlay(this.eOverlay)},Y.prototype.getWidthForSizeColsToFit=function(){var e=this.eBody.clientWidth;return this.isVerticalScrollShowing()&&(e-=this.scrollWidth),e},Y.prototype.sizeColumnsToFit=function(e){var t=this,i=this.getWidthForSizeColsToFit();0<i?this.columnController.sizeColumnsToFit(i,"sizeColumnsToFit"):void 0===e?setTimeout(function(){t.sizeColumnsToFit(100)},0):100===e?setTimeout(function(){t.sizeColumnsToFit(500)},100):500===e?setTimeout(function(){t.sizeColumnsToFit(-1)},500):console.log("ag-Grid: tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")},Y.prototype.getBodyContainer=function(){return this.eBodyContainer},Y.prototype.getDropTargetBodyContainers=function(){return[this.eBodyViewport,this.eTopViewport,this.eBottomViewport]},Y.prototype.getDropTargetLeftContainers=function(){return[this.eLeftViewport,this.eLeftBottom,this.eLeftTop]},Y.prototype.getDropTargetRightContainers=function(){return[this.eRightViewport,this.eRightBottom,this.eRightTop]},Y.prototype.buildRowContainerComponents=function(){var i=this;this.eAllCellContainers=[this.eLeftContainer,this.eRightContainer,this.eBodyContainer,this.eTop,this.eBottom,this.eFullWidthContainer],this.rowContainerComponents={body:new E.RowContainerComponent({eContainer:this.eBodyContainer,eViewport:this.eBodyViewport}),fullWidth:new E.RowContainerComponent({eContainer:this.eFullWidthContainer,hideWhenNoChildren:!0,eViewport:this.eFullWidthViewport}),pinnedLeft:new E.RowContainerComponent({eContainer:this.eLeftContainer,eViewport:this.eLeftViewport}),pinnedRight:new E.RowContainerComponent({eContainer:this.eRightContainer,eViewport:this.eRightViewport}),floatingTop:new E.RowContainerComponent({eContainer:this.eTopContainer}),floatingTopPinnedLeft:new E.RowContainerComponent({eContainer:this.eLeftTop}),floatingTopPinnedRight:new E.RowContainerComponent({eContainer:this.eRightTop}),floatingTopFullWidth:new E.RowContainerComponent({eContainer:this.eTopFullWidthContainer,hideWhenNoChildren:!0}),floatingBottom:new E.RowContainerComponent({eContainer:this.eBottomContainer}),floatingBottomPinnedLeft:new E.RowContainerComponent({eContainer:this.eLeftBottom}),floatingBottomPinnedRight:new E.RowContainerComponent({eContainer:this.eRightBottom}),floatingBottomFullWith:new E.RowContainerComponent({eContainer:this.eBottomFullWidthContainer,hideWhenNoChildren:!0})},l.Utils.iterateObject(this.rowContainerComponents,function(e,t){t&&i.context.wireBean(t)})},Y.prototype.setupRowAnimationCssClass=function(){function e(){var e=t.gridOptionsWrapper.isAnimateRows()&&!t.heightScaler.isScaling();l.Utils.addOrRemoveCssClass(t.eBody,"ag-row-animation",e),l.Utils.addOrRemoveCssClass(t.eBody,"ag-row-no-animation",!e)}var t=this;e(),this.addDestroyableEventListener(this.eventService,m.Events.EVENT_HEIGHT_SCALE_CHANGED,e)},Y.prototype.suppressScrollOnFloatingRow=function(){var e=this;this.addDestroyableEventListener(this.eTopViewport,"scroll",function(){return e.eTopViewport.scrollLeft=0}),this.addDestroyableEventListener(this.eBottomViewport,"scroll",function(){return e.eTopViewport.scrollLeft=0})},Y.prototype.getRowContainers=function(){return this.rowContainerComponents},Y.prototype.onDisplayedColumnsChanged=function(){this.setPinnedContainersVisible(),this.setBodyAndHeaderHeights(),this.onHorizontalViewportChanged()},Y.prototype.onDisplayedColumnsWidthChanged=function(){this.setWidthsOfContainers(),this.onHorizontalViewportChanged(),this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()},Y.prototype.setWidthsOfContainers=function(){this.setCenterWidth(),this.setPinnedLeftWidth(),this.setPinnedRightWidth()},Y.prototype.setCenterWidth=function(){var e=this.columnController.getBodyContainerWidth()+"px";this.eBodyContainer.style.width=e,this.eBottomContainer.style.width=e,this.eTopContainer.style.width=e},Y.prototype.setPinnedLeftWidth=function(){var e,t,i=this.columnController.getPinnedLeftContainerWidth(),n=i+this.scrollWidth,o=i+this.scrollClipWidth;t=l.Utils.isVerticalScrollShowing(this.eLeftViewport)?this.enableRtl?e=n:(e=o,i):e=i,this.setElementWidth(this.eLeftViewportWrapper,t),this.setElementWidth(this.eLeftViewport,e),this.setElementWidth(this.eLeftContainer,i),this.setElementWidth(this.eLeftBottom,t),this.setElementWidth(this.eLeftTop,t)},Y.prototype.setPinnedRightWidth=function(){var e,t,i=this.columnController.getPinnedRightContainerWidth(),n=i+this.scrollWidth,o=i+this.scrollClipWidth;t=l.Utils.isVerticalScrollShowing(this.eRightViewport)?this.enableRtl?(e=o,i):e=n:e=i,this.setElementWidth(this.eRightViewportWrapper,t),this.setElementWidth(this.eRightViewport,e),this.setElementWidth(this.eRightContainer,i),this.setElementWidth(this.eRightBottom,t),this.setElementWidth(this.eRightTop,t)},Y.prototype.setElementWidth=function(e,t){e.style.width=t+"px",e.style.minWidth=t+"px"},Y.prototype.setPinnedContainersVisible=function(){var e=!1,t=this.columnController.isPinningLeft();t!==this.pinningLeft&&(this.pinningLeft=t,this.headerRootComp.setLeftVisible(t),l.Utils.setVisible(this.eLeftViewportWrapper,t),e=!0,t&&(this.eLeftViewport.scrollTop=this.eBodyViewport.scrollTop));var i=this.columnController.isPinningRight();i!==this.pinningRight&&(this.pinningRight=i,this.headerRootComp.setRightVisible(i),l.Utils.setVisible(this.eRightViewportWrapper,i),i&&(this.eRightViewport.scrollTop=this.eBodyViewport.scrollTop),e=!0),e&&(this.hideVerticalScrollOnCenter(),this.setPinnedLeftWidth(),this.setPinnedRightWidth())},Y.prototype.hideVerticalScrollOnCenter=function(){var e=this.enableRtl?this.columnController.isPinningLeft():this.columnController.isPinningRight(),t=l.Utils.isVerticalScrollShowing(this.eBodyViewport),i=e&&t?"-"+this.scrollClipWidth+"px":"";this.enableRtl?this.eBodyViewport.style.marginLeft=i:this.eBodyViewport.style.marginRight=i},Y.prototype.checkBodyHeight=function(){var e=this.eBody.clientHeight;if(this.bodyHeight!==e){this.bodyHeight=e;var t={type:m.Events.EVENT_BODY_HEIGHT_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(t)}},Y.prototype.setBodyAndHeaderHeights=function(){var e,t,i,n=this.columnController.getHeaderRowCount(),o=0;i=this.columnController.isPivotMode()?(o=0,t=this.gridOptionsWrapper.getPivotGroupHeaderHeight(),this.gridOptionsWrapper.getPivotHeaderHeight()):(this.gridOptionsWrapper.isFloatingFilter()&&n++,o=this.gridOptionsWrapper.isFloatingFilter()?1:0,t=this.gridOptionsWrapper.getGroupHeaderHeight(),this.gridOptionsWrapper.getHeaderHeight());var r=n-(1+o);e=o*this.gridOptionsWrapper.getFloatingFiltersHeight(),e+=r*t,e+=i,this.headerRootComp.setHeight(e);var a=this.pinnedRowModel.getPinnedTopTotalHeight(),s=this.pinnedRowModel.getPinnedBottomTotalHeight();this.eTop.style.minHeight=a+"px",this.eTop.style.height=a+"px",this.eBottom.style.minHeight=s+"px",this.eBottom.style.height=s+"px",this.checkBodyHeight()},Y.prototype.getBodyHeight=function(){return this.bodyHeight},Y.prototype.setHorizontalScrollPosition=function(e){this.eBodyViewport.scrollLeft=e,this.nextScrollLeft!==e&&(this.nextScrollLeft=e,this.doHorizontalScroll())},Y.prototype.setVerticalScrollPosition=function(e){this.eBodyViewport.scrollTop=e},Y.prototype.scrollHorizontally=function(e){var t=this.eBodyViewport.scrollLeft;return this.setHorizontalScrollPosition(t+e),this.eBodyViewport.scrollLeft-t},Y.prototype.scrollVertically=function(e){var t=this.eBodyViewport.scrollTop;return this.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t},Y.prototype.addScrollListener=function(){var e=this;this.addDestroyableEventListener(this.eBodyViewport,"scroll",function(){e.onBodyHorizontalScroll(),e.onAnyBodyScroll(e.eBodyViewport)}),this.addDestroyableEventListener(this.eRightViewport,"scroll",this.onAnyBodyScroll.bind(this,this.eRightViewport)),this.addDestroyableEventListener(this.eLeftViewport,"scroll",this.onAnyBodyScroll.bind(this,this.eLeftViewport)),this.addDestroyableEventListener(this.eFullWidthViewport,"scroll",this.onAnyBodyScroll.bind(this,this.eFullWidthViewport))},Y.prototype.onAnyBodyScroll=function(e){var t=(new Date).getTime(),i=t-this.lastVScrollTime;if(!(e!==this.lastVScrollElement&&i<500)){this.lastVScrollElement=e,this.lastVScrollTime=t;var n=e.scrollTop;this.useAnimationFrame?this.nextScrollTop!==n&&(this.nextScrollTop=n,this.animationFrameService.schedule()):n!==this.scrollTop&&(this.scrollTop=n,this.synchroniseVerticalScrollPositions(n),this.redrawRowsAfterScroll())}},Y.prototype.onBodyHorizontalScroll=function(){var e=this.eBodyViewport.scrollLeft;this.nextScrollLeft!==e&&(this.nextScrollLeft=e,this.useAnimationFrame?this.animationFrameService.schedule():this.doHorizontalScroll())},Y.prototype.doHorizontalScroll=function(){this.scrollLeft=this.nextScrollLeft;var e={type:m.Events.EVENT_BODY_SCROLL,api:this.gridApi,columnApi:this.columnApi,direction:"horizontal",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(e),this.horizontallyScrollHeaderCenterAndFloatingCenter(),this.onHorizontalViewportChanged()},Y.prototype.executeFrame=function(){return this.scrollLeft!==this.nextScrollLeft?(this.doHorizontalScroll(),!0):this.scrollTop!==this.nextScrollTop?(this.scrollTop=this.nextScrollTop,this.synchroniseVerticalScrollPositions(this.scrollTop),this.verticalRedrawNeeded=!0):!(!this.verticalRedrawNeeded||(this.redrawRowsAfterScroll(),this.verticalRedrawNeeded=!1))},Y.prototype.redrawRowsAfterScroll=function(){var e={type:m.Events.EVENT_BODY_SCROLL,direction:"vertical",api:this.gridApi,columnApi:this.columnApi,left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(e)},Y.prototype.onHorizontalViewportChanged=function(){var e=this.eBodyViewport.clientWidth,t=this.getBodyViewportScrollLeft();this.columnController.setVirtualViewportPosition(e,t)},Y.prototype.getBodyViewportScrollLeft=function(){return l.Utils.getScrollLeft(this.eBodyViewport,this.enableRtl)},Y.prototype.setBodyViewportScrollLeft=function(e){l.Utils.setScrollLeft(this.eBodyViewport,e,this.enableRtl)},Y.prototype.horizontallyScrollHeaderCenterAndFloatingCenter=function(){var e=this.getBodyViewportScrollLeft(),t=this.enableRtl?e:-e;this.headerRootComp.setHorizontalScroll(t),this.eBottomContainer.style.left=t+"px",this.eTopContainer.style.left=t+"px"},Y.prototype.synchroniseVerticalScrollPositions=function(e){this.lastVScrollElement!==this.eBodyViewport&&(this.eBodyViewport.scrollTop=e),this.lastVScrollElement!==this.eLeftViewport&&this.pinningLeft&&(this.eLeftViewport.scrollTop=e),this.lastVScrollElement!==this.eRightViewport&&this.pinningRight&&(this.eRightViewport.scrollTop=e),this.lastVScrollElement!==this.eFullWidthViewport&&(this.eFullWidthViewport.scrollTop=e),this.rowContainerComponents.body.setVerticalScrollPosition(e),this.rowContainerComponents.pinnedLeft.setVerticalScrollPosition(e),this.rowContainerComponents.pinnedRight.setVerticalScrollPosition(e),this.rowContainerComponents.fullWidth.setVerticalScrollPosition(e),this.redrawRowsAfterScroll()},Y.prototype.addScrollEventListener=function(e){this.eBodyViewport.addEventListener("scroll",e)},Y.prototype.removeScrollEventListener=function(e){this.eBodyViewport.removeEventListener("scroll",e)},r([f.Autowired("alignedGridsService"),a("design:type",T.AlignedGridsService)],Y.prototype,"alignedGridsService",void 0),r([f.Autowired("gridOptionsWrapper"),a("design:type",u.GridOptionsWrapper)],Y.prototype,"gridOptionsWrapper",void 0),r([f.Autowired("columnController"),a("design:type",d.ColumnController)],Y.prototype,"columnController",void 0),r([f.Autowired("rowRenderer"),a("design:type",p.RowRenderer)],Y.prototype,"rowRenderer",void 0),r([f.Autowired("pinnedRowModel"),a("design:type",D.PinnedRowModel)],Y.prototype,"pinnedRowModel",void 0),r([f.Autowired("eventService"),a("design:type",g.EventService)],Y.prototype,"eventService",void 0),r([f.Autowired("context"),a("design:type",f.Context)],Y.prototype,"context",void 0),r([f.Autowired("animationFrameService"),a("design:type",R.AnimationFrameService)],Y.prototype,"animationFrameService",void 0),r([f.Autowired("navigationService"),a("design:type",N.NavigationService)],Y.prototype,"navigationService",void 0),r([f.Autowired("autoHeightCalculator"),a("design:type",B.AutoHeightCalculator)],Y.prototype,"autoHeightCalculator",void 0),r([f.Autowired("columnAnimationService"),a("design:type",j.ColumnAnimationService)],Y.prototype,"columnAnimationService",void 0),r([f.Autowired("autoWidthCalculator"),a("design:type",W.AutoWidthCalculator)],Y.prototype,"autoWidthCalculator",void 0),r([f.Autowired("paginationAutoPageSizeService"),a("design:type",x.PaginationAutoPageSizeService)],Y.prototype,"paginationAutoPageSizeService",void 0),r([f.Autowired("beans"),a("design:type",H.Beans)],Y.prototype,"beans",void 0),r([f.Autowired("paginationProxy"),a("design:type",x.PaginationProxy)],Y.prototype,"paginationProxy",void 0),r([f.Autowired("columnApi"),a("design:type",h.ColumnApi)],Y.prototype,"columnApi",void 0),r([f.Autowired("gridApi"),a("design:type",k.GridApi)],Y.prototype,"gridApi",void 0),r([f.Autowired("dragService"),a("design:type",v.DragService)],Y.prototype,"dragService",void 0),r([f.Autowired("selectionController"),a("design:type",b.SelectionController)],Y.prototype,"selectionController",void 0),r([f.Autowired("csvCreator"),a("design:type",w.CsvCreator)],Y.prototype,"csvCreator",void 0),r([f.Autowired("mouseEventService"),a("design:type",C.MouseEventService)],Y.prototype,"mouseEventService",void 0),r([f.Autowired("focusedCellController"),a("design:type",_.FocusedCellController)],Y.prototype,"focusedCellController",void 0),r([f.Autowired("$scope"),a("design:type",Object)],Y.prototype,"$scope",void 0),r([f.Autowired("scrollVisibleService"),a("design:type",A.ScrollVisibleService)],Y.prototype,"scrollVisibleService",void 0),r([f.Autowired("frameworkFactory"),a("design:type",Object)],Y.prototype,"frameworkFactory",void 0),r([f.Autowired("valueService"),a("design:type",F.ValueService)],Y.prototype,"valueService",void 0),r([f.Autowired("componentRecipes"),a("design:type",P.ComponentRecipes)],Y.prototype,"componentRecipes",void 0),r([f.Autowired("dragAndDropService"),a("design:type",I.DragAndDropService)],Y.prototype,"dragAndDropService",void 0),r([f.Autowired("heightScaler"),a("design:type",G.HeightScaler)],Y.prototype,"heightScaler",void 0),r([f.Autowired("enterprise"),a("design:type",Boolean)],Y.prototype,"enterprise",void 0),r([f.Optional("rangeController"),a("design:type",Object)],Y.prototype,"rangeController",void 0),r([f.Optional("contextMenuFactory"),a("design:type",Object)],Y.prototype,"contextMenuFactory",void 0),r([f.Optional("clipboardService"),a("design:type",Object)],Y.prototype,"clipboardService",void 0),r([z.RefSelector("eBody"),a("design:type",HTMLElement)],Y.prototype,"eBody",void 0),r([z.RefSelector("eBodyViewport"),a("design:type",HTMLElement)],Y.prototype,"eBodyViewport",void 0),r([z.RefSelector("eBodyContainer"),a("design:type",HTMLElement)],Y.prototype,"eBodyContainer",void 0),r([z.RefSelector("eLeftContainer"),a("design:type",HTMLElement)],Y.prototype,"eLeftContainer",void 0),r([z.RefSelector("eRightContainer"),a("design:type",HTMLElement)],Y.prototype,"eRightContainer",void 0),r([z.RefSelector("eFullWidthViewportWrapper"),a("design:type",HTMLElement)],Y.prototype,"eFullWidthViewportWrapper",void 0),r([z.RefSelector("eFullWidthViewport"),a("design:type",HTMLElement)],Y.prototype,"eFullWidthViewport",void 0),r([z.RefSelector("eFullWidthContainer"),a("design:type",HTMLElement)],Y.prototype,"eFullWidthContainer",void 0),r([z.RefSelector("eLeftViewport"),a("design:type",HTMLElement)],Y.prototype,"eLeftViewport",void 0),r([z.RefSelector("eLeftViewportWrapper"),a("design:type",HTMLElement)],Y.prototype,"eLeftViewportWrapper",void 0),r([z.RefSelector("eRightViewport"),a("design:type",HTMLElement)],Y.prototype,"eRightViewport",void 0),r([z.RefSelector("eRightViewportWrapper"),a("design:type",HTMLElement)],Y.prototype,"eRightViewportWrapper",void 0),r([z.RefSelector("eTop"),a("design:type",HTMLElement)],Y.prototype,"eTop",void 0),r([z.RefSelector("eLeftTop"),a("design:type",HTMLElement)],Y.prototype,"eLeftTop",void 0),r([z.RefSelector("eRightTop"),a("design:type",HTMLElement)],Y.prototype,"eRightTop",void 0),r([z.RefSelector("eTopContainer"),a("design:type",HTMLElement)],Y.prototype,"eTopContainer",void 0),r([z.RefSelector("eTopViewport"),a("design:type",HTMLElement)],Y.prototype,"eTopViewport",void 0),r([z.RefSelector("eTopFullWidthContainer"),a("design:type",HTMLElement)],Y.prototype,"eTopFullWidthContainer",void 0),r([z.RefSelector("eBottom"),a("design:type",HTMLElement)],Y.prototype,"eBottom",void 0),r([z.RefSelector("eLeftBottom"),a("design:type",HTMLElement)],Y.prototype,"eLeftBottom",void 0),r([z.RefSelector("eRightBottom"),a("design:type",HTMLElement)],Y.prototype,"eRightBottom",void 0),r([z.RefSelector("eBottomContainer"),a("design:type",HTMLElement)],Y.prototype,"eBottomContainer",void 0),r([z.RefSelector("eBottomViewport"),a("design:type",HTMLElement)],Y.prototype,"eBottomViewport",void 0),r([z.RefSelector("eBottomFullWidthContainer"),a("design:type",HTMLElement)],Y.prototype,"eBottomFullWidthContainer",void 0),r([z.RefSelector("headerRoot"),a("design:type",V.HeaderRootComp)],Y.prototype,"headerRootComp",void 0),r([f.PreDestroy,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],Y.prototype,"destroy",null),r([f.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],Y.prototype,"init",null),Y);function Y(){var e=s.call(this,'<div class="ag-root ag-font-style" role="grid">\n        <ag-header-root ref="headerRoot"></ag-header-root>\n        <div class="ag-floating-top" ref="eTop" role="presentation">\n            <div class="ag-pinned-left-floating-top" ref="eLeftTop" role="presentation"></div>\n            <div class="ag-floating-top-viewport" ref="eTopViewport" role="presentation">\n                <div class="ag-floating-top-container" ref="eTopContainer" role="presentation"></div>\n            </div>\n            <div class="ag-pinned-right-floating-top" ref="eRightTop" role="presentation"></div>\n            <div class="ag-floating-top-full-width-container" ref="eTopFullWidthContainer" role="presentation"></div>\n        </div>\n        <div class="ag-body" ref="eBody" role="presentation">\n            <div class="ag-pinned-left-cols-viewport-wrapper" ref="eLeftViewportWrapper" role="presentation">\n                <div class="ag-pinned-left-cols-viewport" ref="eLeftViewport" role="presentation">\n                    <div class="ag-pinned-left-cols-container" ref="eLeftContainer" role="presentation"></div>\n                </div>\n            </div>\n            <div class="ag-body-viewport-wrapper" role="presentation">\n                <div class="ag-body-viewport" ref="eBodyViewport" role="presentation">\n                    <div class="ag-body-container" ref="eBodyContainer" role="presentation"></div>\n                </div>\n            </div>\n            <div class="ag-pinned-right-cols-viewport-wrapper" ref="eRightViewportWrapper" role="presentation">\n                <div class="ag-pinned-right-cols-viewport" ref="eRightViewport" role="presentation">\n                    <div class="ag-pinned-right-cols-container" ref="eRightContainer" role="presentation"></div>\n                </div>\n            </div>\n            <div class="ag-full-width-viewport-wrapper" ref="eFullWidthViewportWrapper" role="presentation">\n                <div class="ag-full-width-viewport" ref="eFullWidthViewport" role="presentation">\n                    <div class="ag-full-width-container" ref="eFullWidthContainer" role="presentation"></div>\n                </div>\n            </div>\n        </div>\n        <div class="ag-floating-bottom" ref="eBottom" role="presentation">\n            <div class="ag-pinned-left-floating-bottom" ref="eLeftBottom" role="presentation"></div>\n            <div class="ag-floating-bottom-viewport" ref="eBottomViewport" role="presentation">\n                <div class="ag-floating-bottom-container" ref="eBottomContainer" role="presentation"></div>\n            </div>\n            <div class="ag-pinned-right-floating-bottom" ref="eRightBottom" role="presentation"></div>\n            <div class="ag-floating-bottom-full-width-container" ref="eBottomFullWidthContainer" role="presentation"></div>\n        </div>\n        <div class="ag-overlay" ref="eOverlay"></div>\n    </div>')||this;return e.scrollLeft=-1,e.nextScrollLeft=-1,e.scrollTop=-1,e.nextScrollTop=-1,e.verticalRedrawNeeded=!1,e}t.GridPanel=U},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(28),c=i(34),s=i(4),u=i(1),l=(d.prototype.registerGridComp=function(e){this.gridPanel=e},d.prototype.getPreferredHeightForRow=function(i){var n=this;this.eDummyContainer||(this.eDummyContainer=document.createElement("div"),u._.addCssClass(this.eDummyContainer,"ag-row ag-row-no-focus"));var e=this.gridPanel.getBodyContainer();e.appendChild(this.eDummyContainer);var o=[],t=this.columnController.getAllAutoRowHeightCols();console.log(),t.forEach(function(e){var t=new c.CellComp(n.$scope,n.beans,e,i,null,!0);t.setParentRow(n.eDummyContainer),o.push(t)});var r=o.map(function(e){return e.getCreateTemplate()}).join(" ");this.eDummyContainer.innerHTML=r,o.forEach(function(e){return e.afterAttached()});for(var a=0,s=0;s<this.eDummyContainer.children.length;s++){var l=this.eDummyContainer.children[s];l.offsetHeight>a&&(a=l.offsetHeight)}return e.removeChild(this.eDummyContainer),o.forEach(function(e){e.detach(),e.destroy()}),u._.removeAllChildren(this.eDummyContainer),a},n([r.Autowired("beans"),o("design:type",a.Beans)],d.prototype,"beans",void 0),n([r.Autowired("$scope"),o("design:type",Object)],d.prototype,"$scope",void 0),n([r.Autowired("columnController"),o("design:type",s.ColumnController)],d.prototype,"columnController",void 0),d=n([r.Bean("autoHeightCalculator")],d));function d(){}t.AutoHeightCalculator=l},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(2),c=i(4),u=i(10),d=i(0),h=i(98),p=i(3),f=i(5),g=i(36),m=i(8),v=i(11),y=i(1),b=i(6),w=i(39),C=(s=m.Component,o(_,s),_.prototype.registerGridComp=function(e){this.gridPanel=e,this.centerContainer.registerGridComp(e),this.pinnedLeftContainer.registerGridComp(e),this.pinnedRightContainer.registerGridComp(e)},_.prototype.postConstruct=function(){var t=this;this.gridApi.registerHeaderRootComp(this),this.autoWidthCalculator.registerHeaderRootComp(this),this.centerContainer=new h.HeaderContainer(this.eHeaderContainer,this.eHeaderViewport,null),this.childContainers=[this.centerContainer],this.pinnedLeftContainer=new h.HeaderContainer(this.ePinnedLeftHeader,null,u.Column.PINNED_LEFT),this.pinnedRightContainer=new h.HeaderContainer(this.ePinnedRightHeader,null,u.Column.PINNED_RIGHT),this.childContainers.push(this.pinnedLeftContainer),this.childContainers.push(this.pinnedRightContainer),this.childContainers.forEach(function(e){return t.context.wireBean(e)}),this.eventService.addEventListener(f.Events.EVENT_COLUMN_VALUE_CHANGED,this.refreshHeader.bind(this)),this.eventService.addEventListener(f.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this)),this.addPreventHeaderScroll(),this.columnController.isReady()&&this.refreshHeader()},_.prototype.setHorizontalScroll=function(e){this.eHeaderContainer.style.left=e+"px"},_.prototype.forEachHeaderElement=function(t){this.childContainers.forEach(function(e){return e.forEachHeaderElement(t)})},_.prototype.destroy=function(){this.childContainers.forEach(function(e){return e.destroy()})},_.prototype.refreshHeader=function(){this.childContainers.forEach(function(e){return e.refresh()})},_.prototype.onPivotModeChanged=function(){var e=this.columnController.isPivotMode();y.Utils.addOrRemoveCssClass(this.getGui(),"ag-pivot-on",e),y.Utils.addOrRemoveCssClass(this.getGui(),"ag-pivot-off",!e)},_.prototype.setHeight=function(e){this.getGui().style.height=e+"px",this.getGui().style.minHeight=e+"px"},_.prototype.addPreventHeaderScroll=function(){var t=this;this.addDestroyableEventListener(this.eHeaderViewport,"scroll",function(){var e=t.eHeaderViewport.scrollLeft;0!==e&&(t.gridPanel.scrollHorizontally(e),t.eHeaderViewport.scrollLeft=0)})},_.prototype.setLeftVisible=function(e){y.Utils.setVisible(this.ePinnedLeftHeader,e)},_.prototype.setRightVisible=function(e){y.Utils.setVisible(this.ePinnedRightHeader,e)},_.TEMPLATE='<div class="ag-header" role="row">\n            <div class="ag-pinned-left-header" ref="ePinnedLeftHeader" role="presentation"></div>\n            <div class="ag-header-viewport" ref="eHeaderViewport" role="presentation">\n                <div class="ag-header-container" ref="eHeaderContainer" role="presentation"></div>\n            </div>\n            <div class="ag-pinned-right-header" ref="ePinnedRightHeader" role="presentation"></div>\n        </div>',r([v.RefSelector("ePinnedLeftHeader"),a("design:type",HTMLElement)],_.prototype,"ePinnedLeftHeader",void 0),r([v.RefSelector("ePinnedRightHeader"),a("design:type",HTMLElement)],_.prototype,"ePinnedRightHeader",void 0),r([v.RefSelector("eHeaderContainer"),a("design:type",HTMLElement)],_.prototype,"eHeaderContainer",void 0),r([v.RefSelector("eHeaderViewport"),a("design:type",HTMLElement)],_.prototype,"eHeaderViewport",void 0),r([d.Autowired("gridOptionsWrapper"),a("design:type",l.GridOptionsWrapper)],_.prototype,"gridOptionsWrapper",void 0),r([d.Autowired("columnController"),a("design:type",c.ColumnController)],_.prototype,"columnController",void 0),r([d.Autowired("context"),a("design:type",d.Context)],_.prototype,"context",void 0),r([d.Autowired("eventService"),a("design:type",p.EventService)],_.prototype,"eventService",void 0),r([d.Autowired("scrollVisibleService"),a("design:type",g.ScrollVisibleService)],_.prototype,"scrollVisibleService",void 0),r([d.Autowired("gridApi"),a("design:type",b.GridApi)],_.prototype,"gridApi",void 0),r([d.Autowired("autoWidthCalculator"),a("design:type",w.AutoWidthCalculator)],_.prototype,"autoWidthCalculator",void 0),r([d.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],_.prototype,"postConstruct",null),r([d.PreDestroy,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],_.prototype,"destroy",null),_);function _(){return s.call(this,_.TEMPLATE)||this}t.HeaderRootComp=C},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),n=(o.addHeaderClassesFromColDef=function(e,t,i,n,o){s.Utils.missing(e)||this.addColumnClassesFromCollDef(e.headerClass,e,t,i,n,o)},o.addToolPanelClassesFromColDef=function(e,t,i,n,o){s.Utils.missing(e)||this.addColumnClassesFromCollDef(e.toolPanelClass,e,t,i,n,o)},o.addColumnClassesFromCollDef=function(e,t,i,n,o,r){var a;s.Utils.missing(e)||("string"==typeof(a="function"==typeof e?e({colDef:t,column:o,columnGroup:r,context:n.getContext(),api:n.getApi()}):e)?s.Utils.addCssClass(i,a):Array.isArray(a)&&a.forEach(function(e){s.Utils.addCssClass(i,e)}))},o);function o(){}t.CssClassApplier=n},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(9),s=i(4),l=i(1),c=i(64),u=i(23),d=i(2),h=i(30),p=(f.prototype.getNextCellToFocus=function(e,t){for(var i=t,n=!1;!n;){switch(e){case a.Constants.KEY_UP:i=this.getCellAbove(i);break;case a.Constants.KEY_DOWN:i=this.getCellBelow(i);break;case a.Constants.KEY_RIGHT:i=this.gridOptionsWrapper.isEnableRtl()?this.getCellToLeft(i):this.getCellToRight(i);break;case a.Constants.KEY_LEFT:i=this.gridOptionsWrapper.isEnableRtl()?this.getCellToRight(i):this.getCellToLeft(i);break;default:console.log("ag-Grid: unknown key for navigation "+e),i=null}n=!i||this.isCellGoodToFocusOn(i)}return i},f.prototype.isCellGoodToFocusOn=function(e){var t,i=e.column;switch(e.floating){case a.Constants.PINNED_TOP:t=this.pinnedRowModel.getPinnedTopRow(e.rowIndex);break;case a.Constants.PINNED_BOTTOM:t=this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);break;default:t=this.rowModel.getRow(e.rowIndex)}return!i.isSuppressNavigable(t)},f.prototype.getCellToLeft=function(e){var t=this.columnController.getDisplayedColBefore(e.column);if(t){var i={rowIndex:e.rowIndex,column:t,floating:e.floating};return new u.GridCell(i)}return null},f.prototype.getCellToRight=function(e){var t=this.columnController.getDisplayedColAfter(e.column);if(t){var i={rowIndex:e.rowIndex,column:t,floating:e.floating};return new u.GridCell(i)}return null},f.prototype.getRowBelow=function(e){return this.isLastRowInContainer(e)?e.isFloatingBottom()?null:e.isNotFloating()?this.pinnedRowModel.isRowsToRender(a.Constants.PINNED_BOTTOM)?new c.GridRow(0,a.Constants.PINNED_BOTTOM):null:this.rowModel.isRowsToRender()?new c.GridRow(0,null):this.pinnedRowModel.isRowsToRender(a.Constants.PINNED_BOTTOM)?new c.GridRow(0,a.Constants.PINNED_BOTTOM):null:new c.GridRow(e.rowIndex+1,e.floating)},f.prototype.getCellBelow=function(e){var t=this.getRowBelow(e.getGridRow());if(t){var i={rowIndex:t.rowIndex,column:e.column,floating:t.floating};return new u.GridCell(i)}return null},f.prototype.isLastRowInContainer=function(e){return e.isFloatingTop()?this.pinnedRowModel.getPinnedTopRowData().length-1<=e.rowIndex:e.isFloatingBottom()?this.pinnedRowModel.getPinnedBottomRowData().length-1<=e.rowIndex:this.rowModel.getPageLastRow()<=e.rowIndex},f.prototype.getRowAbove=function(e){return 0===e.rowIndex?e.isFloatingTop()?null:e.isNotFloating()?this.pinnedRowModel.isRowsToRender(a.Constants.PINNED_TOP)?this.getLastFloatingTopRow():null:this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender(a.Constants.PINNED_TOP)?this.getLastFloatingTopRow():null:new c.GridRow(e.rowIndex-1,e.floating)},f.prototype.getCellAbove=function(e){var t=this.getRowAbove(e.getGridRow());if(t){var i={rowIndex:t.rowIndex,column:e.column,floating:t.floating};return new u.GridCell(i)}return null},f.prototype.getLastBodyCell=function(){var e=this.rowModel.getPageLastRow();return new c.GridRow(e,null)},f.prototype.getLastFloatingTopRow=function(){var e=this.pinnedRowModel.getPinnedTopRowData().length-1;return new c.GridRow(e,a.Constants.PINNED_TOP)},f.prototype.getNextTabbedCell=function(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)},f.prototype.getNextTabbedCellForwards=function(e){var t=this.columnController.getAllDisplayedColumns(),i=e.rowIndex,n=e.floating,o=this.columnController.getDisplayedColAfter(e.column);if(!o){o=t[0];var r=this.getRowBelow(e.getGridRow());if(l.Utils.missing(r))return;i=r.rowIndex,n=r.floating}var a={rowIndex:i,column:o,floating:n};return new u.GridCell(a)},f.prototype.getNextTabbedCellBackwards=function(e){var t=this.columnController.getAllDisplayedColumns(),i=e.rowIndex,n=e.floating,o=this.columnController.getDisplayedColBefore(e.column);if(!o){o=t[t.length-1];var r=this.getRowAbove(e.getGridRow());if(l.Utils.missing(r))return;i=r.rowIndex,n=r.floating}var a={rowIndex:i,column:o,floating:n};return new u.GridCell(a)},n([r.Autowired("columnController"),o("design:type",s.ColumnController)],f.prototype,"columnController",void 0),n([r.Autowired("rowModel"),o("design:type",Object)],f.prototype,"rowModel",void 0),n([r.Autowired("pinnedRowModel"),o("design:type",h.PinnedRowModel)],f.prototype,"pinnedRowModel",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",d.GridOptionsWrapper)],f.prototype,"gridOptionsWrapper",void 0),f=n([r.Bean("cellNavigationService")],f));function f(){}t.CellNavigationService=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o.prototype.getInstanceIdForKey=function(e){var t,i=this.existingIds[e];return t="number"!=typeof i?0:i+1,this.existingIds[e]=t},o);function o(){this.existingIds={}}t.GroupInstanceIdCreator=n},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=i(0),r=(a.prototype.download=function(e,t,i){var n=new Blob(["\ufeff",t],{type:i});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,e);else{var o=document.createElement("a");o.href=window.URL.createObjectURL(n),o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o)}},a=n([o.Bean("downloader")],a));function a(){}t.Downloader=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(2),d=i(17),h=i(7),p=i(4),f=i(20),g=i(80),m=i(18),v=i(16),y=i(3),b=i(78),w=i(6),C=i(38),_=i(48),A=i(19),E=i(49),x=i(35),S=i(12),T=i(31),D=i(39),k=i(59),R=i(0),O=i(47),N=i(42),F=i(108),M=i(15),P=i(40),I=i(24),L=i(22),G=i(44),$=i(82),B=i(1),j=i(109),W=i(111),H=i(113),z=i(54),n=i(5),o=i(114),r=i(116),V=i(55),U=i(56),Y=i(43),q=i(60),Q=i(117),K=i(36),X=i(84),J=i(118),Z=i(63),ee=i(73),te=i(45),ie=i(53),ne=i(112),oe=i(110),re=i(138),ae=i(104),se=i(29),le=i(105),a=i(9),ce=i(33),ue=i(139),de=i(58),he=i(30),pe=i(27),fe=i(21),ge=i(66),me=i(76),ve=i(77),ye=i(28),be=i(41),we=i(37),Ce=i(97),_e=i(57),Ae=i(86),Ee=i(79),xe=i(140),s=(Se.setEnterpriseBeans=function(e,t){this.enterpriseBeans=e,B.Utils.iterateObject(t,function(e,t){return Se.RowModelClasses[e]=t})},Se.setEnterpriseComponents=function(e){this.enterpriseComponents=e},Se.setFrameworkBeans=function(e){this.frameworkBeans=e},Se.prototype.setColumnsAndData=function(){var e=this.context.getBean("gridOptionsWrapper"),t=this.context.getBean("columnController"),i=this.context.getBean("rowModel"),n=e.getColumnDefs(),o=e.getRowData();B.Utils.missing(n)&&B.Utils.missing(o)||(B.Utils.exists(n)&&t.setColumnDefs(n,"gridInitializing"),B.Utils.exists(o)&&i.getType()===a.Constants.ROW_MODEL_TYPE_CLIENT_SIDE&&i.setRowData(o))},Se.prototype.dispatchGridReadyEvent=function(e){var t=this.context.getBean("eventService"),i={type:n.Events.EVENT_GRID_READY,api:e.api,columnApi:e.columnApi};t.dispatchEvent(i)},Se.prototype.getRowModelClass=function(e){var t=e.rowModelType;if(t="enterprise"===t?a.Constants.ROW_MODEL_TYPE_SERVER_SIDE:t,B.Utils.exists(t)){var i=Se.RowModelClasses[t];if(B.Utils.exists(i))return i;if("normal"===t)return console.warn("ag-Grid: normal rowModel deprecated. Should now be called client side row model instead."),r.ClientSideRowModel;console.error("ag-Grid: could not find matching row model for rowModelType "+t),t===a.Constants.ROW_MODEL_TYPE_VIEWPORT&&console.error("ag-Grid: rowModelType viewport is only available in ag-Grid Enterprise"),t===a.Constants.ROW_MODEL_TYPE_SERVER_SIDE&&console.error("ag-Grid: rowModelType server side is only available in ag-Grid Enterprise")}return r.ClientSideRowModel},Se.prototype.destroy=function(){this.context.destroy()},Se.RowModelClasses={infinite:o.InfiniteRowModel,clientSide:r.ClientSideRowModel},Se);function Se(e,t,i){e||console.error("ag-Grid: no div element provided to the grid"),t||console.error("ag-Grid: no gridOptions provided to the grid");var n=this.getRowModelClass(t),o=B.Utils.exists(Se.enterpriseBeans),r=i?i.frameworkFactory:null;B.Utils.missing(r)&&(r=new Q.BaseFrameworkFactory);var a=[];Se.enterpriseBeans&&(a=a.concat(Se.enterpriseBeans)),Se.frameworkBeans&&(a=a.concat(Se.frameworkBeans));var s={enterprise:o,gridOptions:t,eGridDiv:e,$scope:i?i.$scope:null,$compile:i?i.$compile:null,quickFilterOnScope:i?i.quickFilterOnScope:null,globalEventListener:i?i.globalEventListener:null,frameworkFactory:r};i&&i.seedBeanInstances&&B.Utils.assign(s,i.seedBeanInstances);var l=[{componentName:"AgCheckbox",theClass:q.AgCheckbox},{componentName:"AgGridComp",theClass:b.GridPanel},{componentName:"AgHeaderRoot",theClass:g.HeaderRootComp},{componentName:"AgPagination",theClass:xe.PaginationComp}];Se.enterpriseComponents&&(l=l.concat(Se.enterpriseComponents));var c={overrideBeans:a,seed:s,beans:[n,ye.Beans,se.PaginationAutoPageSizeService,w.GridApi,ge.ComponentProvider,me.AgComponentUtils,ve.ComponentMetadataProvider,ge.ComponentProvider,pe.ComponentResolver,fe.ComponentRecipes,_e.HeightScaler,Ee.AutoHeightCalculator,V.CellRendererFactory,k.HorizontalResizeService,he.PinnedRowModel,P.DragService,_.DisplayedGroupCreator,y.EventService,u.GridOptionsWrapper,d.SelectionController,m.FilterManager,p.ColumnController,se.PaginationProxy,f.RowRenderer,A.ExpressionService,C.BalancedColumnTreeBuilder,O.CsvCreator,X.Downloader,J.XmlFactory,Z.GridSerializer,E.TemplateService,Ce.NavigationService,x.PopupService,ce.ValueCache,v.ValueService,de.AlignedGridsService,S.LoggerFactory,T.ColumnUtils,D.AutoWidthCalculator,x.PopupService,N.GridCore,F.StandardMenuFactory,M.DragAndDropService,h.ColumnApi,L.FocusedCellController,G.MouseEventService,$.CellNavigationService,j.FilterStage,W.SortStage,H.FlattenStage,oe.FilterService,re.RowNodeFactory,z.CellEditorFactory,U.CellRendererService,Y.ValueFormatterService,ee.StylingService,K.ScrollVisibleService,te.ColumnHoverService,ie.ColumnAnimationService,ne.SortService,Ae.SelectableService,ae.AutoGroupColService,le.ImmutableService,ue.ChangeDetectionService,be.Environment,we.AnimationFrameService,I.SortController],components:l,debug:!!t.debug};this.context=new R.Context(c,new S.Logger("Context",function(){return c.debug})),this.setColumnsAndData(),this.dispatchGridReadyEvent(t),t.debug&&console.log("ag-Grid -> initialised successfully, enterprise = "+o)}t.Grid=s},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(1),s=i(2),l=(c.prototype.init=function(){this.groupSelectsChildren=this.gridOptionsWrapper.isGroupSelectsChildren(),this.isRowSelectableFunc=this.gridOptionsWrapper.getIsRowSelectableFunc()},c.prototype.updateSelectableAfterGrouping=function(e){this.isRowSelectableFunc&&this.recurseDown(e.childrenAfterGroup,function(e){return e.childrenAfterGroup})},c.prototype.updateSelectableAfterFiltering=function(e){this.isRowSelectableFunc&&this.recurseDown(e.childrenAfterGroup,function(e){return e.childrenAfterFilter})},c.prototype.recurseDown=function(e,n){var o=this;e.forEach(function(e){if(e.group){var t;if(e.hasChildren()&&o.recurseDown(n(e),n),o.groupSelectsChildren){var i=a._.find(n(e),"selectable",!0);t=a._.exists(i)}else t=o.isRowSelectableFunc(e);e.setRowSelectable(t)}})},n([r.Autowired("gridOptionsWrapper"),o("design:type",s.GridOptionsWrapper)],c.prototype,"gridOptionsWrapper",void 0),n([r.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],c.prototype,"init",null),c=n([r.Bean("selectableService")],c));function c(){}t.SelectableService=l},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r,u=i(1),a=i(13),s=i(61),l=(r=a.BeanStub,o(c,r),c.prototype.destroy=function(){var t=this;r.prototype.destroy.call(this),this.forEachBlockInOrder(function(e){return t.destroyBlock(e)})},c.prototype.init=function(){var e=this;this.active=!0,this.addDestroyFunc(function(){return e.active=!1})},c.prototype.isActive=function(){return this.active},c.prototype.getVirtualRowCount=function(){return this.virtualRowCount},c.prototype.hack_setVirtualRowCount=function(e){this.virtualRowCount=e},c.prototype.isMaxRowFound=function(){return this.maxRowFound},c.prototype.onPageLoaded=function(e){this.cacheParams.rowNodeBlockLoader.loadComplete(),this.checkBlockToLoad(),this.isActive()&&(this.logger.log("onPageLoaded: page = "+e.page.getBlockNumber()+", lastRow = "+e.lastRow),e.success&&this.checkVirtualRowCount(e.page,e.lastRow))},c.prototype.purgeBlocksIfNeeded=function(t){var i=this;if(!(u.Utils.missing(this.cacheParams.maxBlocksInCache)||this.blockCount<=this.cacheParams.maxBlocksInCache)){var n=[];this.forEachBlockInOrder(function(e){e!==t&&n.push(e)}),n.sort(function(e,t){return t.getLastAccessed()-e.getLastAccessed()});var e=this.cacheParams.maxBlocksInCache-1;n.splice(0,e),n.forEach(function(e){e.isAnyNodeOpen(i.virtualRowCount)||i.removeBlockFromCache(e)})}},c.prototype.postCreateBlock=function(e){e.addEventListener(s.RowNodeBlock.EVENT_LOAD_COMPLETE,this.onPageLoaded.bind(this)),this.setBlock(e.getBlockNumber(),e),this.purgeBlocksIfNeeded(e),this.checkBlockToLoad()},c.prototype.removeBlockFromCache=function(e){e&&this.destroyBlock(e)},c.prototype.checkBlockToLoad=function(){this.cacheParams.rowNodeBlockLoader.checkBlockToLoad()},c.prototype.checkVirtualRowCount=function(e,t){if("number"==typeof t&&0<=t)this.virtualRowCount=t,this.maxRowFound=!0,this.onCacheUpdated();else if(!this.maxRowFound){var i=(e.getBlockNumber()+1)*this.cacheParams.blockSize+this.cacheParams.overflowSize;this.virtualRowCount<i?(this.virtualRowCount=i,this.onCacheUpdated()):this.cacheParams.dynamicRowHeight&&this.onCacheUpdated()}},c.prototype.setVirtualRowCount=function(e,t){this.virtualRowCount=e,u.Utils.exists(t)&&(this.maxRowFound=t),this.maxRowFound||this.virtualRowCount%this.cacheParams.blockSize==0&&this.virtualRowCount++,this.onCacheUpdated()},c.prototype.forEachNodeDeep=function(t,i){var n=this;this.forEachBlockInOrder(function(e){e.forEachNodeDeep(t,i,n.virtualRowCount)})},c.prototype.forEachBlockInOrder=function(e){var t=this.getBlockIdsSorted();this.forEachBlockId(t,e)},c.prototype.forEachBlockInReverseOrder=function(e){var t=this.getBlockIdsSorted().reverse();this.forEachBlockId(t,e)},c.prototype.forEachBlockId=function(e,i){var n=this;e.forEach(function(e){var t=n.blocks[e];i(t,e)})},c.prototype.getBlockIdsSorted=function(){return Object.keys(this.blocks).map(function(e){return parseInt(e)}).sort(function(e,t){return e-t})},c.prototype.getBlock=function(e){return this.blocks[e]},c.prototype.setBlock=function(e,t){this.blocks[e]=t,this.blockCount++,this.cacheParams.rowNodeBlockLoader.addBlock(t)},c.prototype.destroyBlock=function(e){delete this.blocks[e.getBlockNumber()],e.destroy(),this.blockCount--,this.cacheParams.rowNodeBlockLoader.removeBlock(e)},c.prototype.onCacheUpdated=function(){if(this.isActive()){var e={type:c.EVENT_CACHE_UPDATED};this.dispatchEvent(e)}},c.prototype.purgeCache=function(){var t=this;this.forEachBlockInOrder(function(e){return t.removeBlockFromCache(e)}),this.onCacheUpdated()},c.prototype.getRowNodesInRange=function(i,n){var o=this,r=[],a=-1,s=!1,l=new u.NumberSequence;u.Utils.missing(i)&&(s=!0);var c=!1;return this.forEachBlockInOrder(function(e,t){c||(s&&a+1!==t?c=!0:(a=t,e.forEachNodeShallow(function(e){var t=e===i||e===n;(s||t)&&r.push(e),t&&(s=!s)},l,o.virtualRowCount)))}),c||s?[]:r},c.EVENT_CACHE_UPDATED="cacheUpdated",c);function c(e){var t=r.call(this)||this;return t.maxRowFound=!1,t.blocks={},t.blockCount=0,t.virtualRowCount=e.initialRowCount,t.cacheParams=e,t}t.RowNodeCache=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i(14),c=i(1),n=(s.prototype.postConstruct=function(){this.getNodeChildDetails=this.gridOptionsWrapper.getNodeChildDetailsFunc(),this.suppressParentsInRowNodes=this.gridOptionsWrapper.isSuppressParentsInRowNodes(),this.doesDataFlower=this.gridOptionsWrapper.getDoesDataFlowerFunc(),this.isRowMasterFunc=this.gridOptionsWrapper.getIsRowMasterFunc(),this.doingLegacyTreeData=c.Utils.exists(this.getNodeChildDetails),this.doingMasterDetail=this.gridOptionsWrapper.isMasterDetail()},s.prototype.getCopyOfNodesMap=function(){return c.Utils.cloneObject(this.allNodesMap)},s.prototype.getRowNode=function(e){return this.allNodesMap[e]},s.prototype.setRowData=function(e){if(this.rootNode.childrenAfterFilter=null,this.rootNode.childrenAfterGroup=null,this.rootNode.childrenAfterSort=null,this.rootNode.childrenMapped=null,this.nextId=0,this.allNodesMap={},!e)return this.rootNode.allLeafChildren=[],void(this.rootNode.childrenAfterGroup=[]);var t=this.recursiveFunction(e,null,s.TOP_LEVEL);this.doingLegacyTreeData?(this.rootNode.childrenAfterGroup=t,this.setLeafChildren(this.rootNode)):this.rootNode.allLeafChildren=t},s.prototype.updateRowData=function(e,t){var i=this;if(this.isLegacyTreeData())return null;var n=e.add,o=e.addIndex,r=e.remove,a=e.update,s={remove:[],update:[],add:[]};return c.Utils.exists(n)&&("number"==typeof o&&0<=o?n.reverse().forEach(function(e){var t=i.addRowNode(e,o);s.add.push(t)}):n.forEach(function(e){var t=i.addRowNode(e);s.add.push(t)})),c.Utils.exists(r)&&r.forEach(function(e){var t=i.updatedRowNode(e,!1);t&&s.remove.push(t)}),c.Utils.exists(a)&&a.forEach(function(e){var t=i.updatedRowNode(e,!0);t&&s.update.push(t)}),t&&c.Utils.sortRowNodesByOrder(this.rootNode.allLeafChildren,t),s},s.prototype.addRowNode=function(e,t){var i=this.createNode(e,null,s.TOP_LEVEL);return c.Utils.exists(t)?c.Utils.insertIntoArray(this.rootNode.allLeafChildren,i,t):this.rootNode.allLeafChildren.push(i),i},s.prototype.updatedRowNode=function(t,e){var i,n=this.gridOptionsWrapper.getRowNodeIdFunc();if(c.Utils.exists(n)){var o=n(t);if(!(i=this.allNodesMap[o]))return console.error("ag-Grid: could not find row id="+o+", data item was not found for this id"),null}else if(!(i=c.Utils.find(this.rootNode.allLeafChildren,function(e){return e.data===t})))return console.error("ag-Grid: could not find data item as object was not found",t),null;return e?i.updateData(t):(i.setSelected(!1),i.clearRowTop(),c.Utils.removeFromArray(this.rootNode.allLeafChildren,i),this.allNodesMap[i.id]=void 0),i},s.prototype.recursiveFunction=function(e,i,n){var o=this;if("string"!=typeof e){var r=[];return e.forEach(function(e){var t=o.createNode(e,i,n);r.push(t)}),r}console.warn("ag-Grid: rowData must be an array, however you passed in a string. If you are loading JSON, make sure you convert the JSON string to JavaScript objects first")},s.prototype.createNode=function(e,t,i){var n=new l.RowNode;this.context.wireBean(n);var o=this.gridOptionsWrapper.isTreeData(),r=!o&&c.Utils.exists(this.getNodeChildDetails)?this.getNodeChildDetails(e):null;if(r&&r.group)n.group=!0,n.childrenAfterGroup=this.recursiveFunction(r.children,n,i+1),n.expanded=!0===r.expanded,n.field=r.field,n.key=r.key,n.canFlower=n.master,this.setLeafChildren(n);else if(n.group=!1,o)n.master=!1,n.expanded=!1;else{this.doesDataFlower?n.master=this.doesDataFlower(e):this.doingMasterDetail?this.isRowMasterFunc?n.master=this.isRowMasterFunc(e):n.master=!0:n.master=!1;var a=this.columnController.getRowGroupColumns(),s=i+(a?a.length:0);n.expanded=!!n.master&&this.isExpanded(s)}return n.canFlower=n.master,t&&!this.suppressParentsInRowNodes&&(n.parent=t),n.level=i,n.setDataAndId(e,this.nextId.toString()),this.allNodesMap[n.id]=n,this.nextId++,n},s.prototype.isExpanded=function(e){var t=this.gridOptionsWrapper.getGroupDefaultExpanded();return-1===t||e<t},s.prototype.setLeafChildren=function(t){t.allLeafChildren=[],t.childrenAfterGroup&&t.childrenAfterGroup.forEach(function(e){e.group?e.allLeafChildren&&e.allLeafChildren.forEach(function(e){return t.allLeafChildren.push(e)}):t.allLeafChildren.push(e)})},s.prototype.insertItemsAtIndex=function(e,t){if(this.isLegacyTreeData())return null;var i=this.rootNode.allLeafChildren;if(!(e>i.length)){for(var n=[],o=t.length-1;0<=o;o--){var r=t[o],a=this.createNode(r,null,s.TOP_LEVEL);c.Utils.insertIntoArray(i,a,e),n.push(a)}return 0<n.length?n:null}console.warn("ag-Grid: invalid index "+e+", max index is "+i.length)},s.prototype.addItems=function(e){var t=this.rootNode.allLeafChildren;return this.insertItemsAtIndex(t.length,e)},s.prototype.isLegacyTreeData=function(){return!!c.Utils.exists(this.gridOptionsWrapper.getNodeChildDetailsFunc())&&(console.warn("ag-Grid: adding and removing rows is not supported when using nodeChildDetailsFunc, ie it is not supported for legacy tree data. Please see the docs on the new preferred way of providing tree data that works with delta updates."),!0)},s.TOP_LEVEL=0,s.ROOT_NODE_ID="ROOT_NODE_ID",s);function s(e,t,i,n,o){this.nextId=0,this.allNodesMap={},this.rootNode=e,this.gridOptionsWrapper=t,this.context=i,this.eventService=n,this.columnController=o,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=s.ROOT_NODE_ID,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterFilter=[],this.postConstruct()}t.ClientSideNodeManager=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o.prototype.setInactive=function(){this.active=!1},o.prototype.isActive=function(){return this.active},o.prototype.addParentNode=function(e,t){var i=this;this.validateActive();for(var n=e;n;)this.nodeIdsToBoolean[n.id]=!0,this.keepingColumns&&t&&(this.nodeIdsToColumns[n.id]||(this.nodeIdsToColumns[n.id]={}),t.forEach(function(e){return i.nodeIdsToColumns[n.id][e.getId()]=!0})),n=n.parent},o.prototype.isInPath=function(e){return this.validateActive(),this.nodeIdsToBoolean[e.id]},o.prototype.getValueColumnsForNode=function(e,t){if(this.validateActive(),!this.keepingColumns)return t;var i=this.nodeIdsToColumns[e.id];return t.filter(function(e){return i[e.getId()]})},o.prototype.getNotValueColumnsForNode=function(e,t){if(this.validateActive(),!this.keepingColumns)return null;var i=this.nodeIdsToColumns[e.id];return t.filter(function(e){return!i[e.getId()]})},o.prototype.validateActive=function(){if(!this.active)throw"ag-Grid: tried to work on an invalid changed path"},o);function o(e){this.active=!0,this.nodeIdsToBoolean={},this.nodeIdsToColumns={},this.keepingColumns=e}t.ChangedPath=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o.STRING_PROPERTIES=["sortingOrder","rowClass","rowSelection","overlayLoadingTemplate","overlayNoRowsTemplate","quickFilterText","rowModelType","editType","domLayout","clipboardDeliminator","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals"],o.OBJECT_PROPERTIES=["components","frameworkComponents","rowStyle","context","autoGroupColumnDef","groupColumnDef","localeText","icons","datasource","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultExportParams","columnTypes","rowClassRules","detailGridOptions","detailCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent"],o.ARRAY_PROPERTIES=["slaveGrids","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData"],o.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","colWidth","headerHeight","groupHeaderHeight","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","minColWidth","maxColWidth","viewportRowModelPageSize","viewportRowModelBufferSize","layoutInterval","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","scrollbarWidth","paginationStartPage","infiniteBlockSize","batchUpdateWaitMillis"],o.BOOLEAN_PROPERTIES=["toolPanelSuppressRowGroups","toolPanelSuppressValues","toolPanelSuppressPivots","toolPanelSuppressPivotMode","toolPanelSuppressSideButtons","toolPanelSuppressColumnFilter","toolPanelSuppressColumnSelectAll","toolPanelSuppressColumnExpandAll","suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellSelection","suppressHorizontalScroll","debug","enableColResize","enableCellExpressions","enableSorting","enableServerSideSorting","enableFilter","enableServerSideFilter","angularCompileRows","angularCompileFilters","angularCompileHeaders","groupSuppressAutoColumn","groupSelectsChildren","groupIncludeFooter","groupIncludeTotalFooter","groupUseEntireRow","groupSuppressRow","groupSuppressBlankHeader","forPrint","suppressMenuHide","rowDeselection","unSortIcon","suppressMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","suppressParentsInRowNodes","showToolPanel","suppressColumnMoveAnimation","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","pivotPanelShow","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","suppressMenuFilterPanel","suppressMenuMainPanel","suppressMenuColumnPanel","enableStatusBar","alwaysShowStatusBar","rememberGroupStateWhenNewData","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressUseColIdForGroups","suppressCopyRowsToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","suppressAggAtRootLevel","suppressFocusAfterRefresh","functionsPassive","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragManaged","suppressRowDrag","enableGroupEdit","embedFullWidthRows","suppressTabbing","suppressPaginationPanel","floatingFilter","groupHideOpenParents","groupMultiAutoColumn","pagination","stopEditingWhenGridLosesFocus","paginationAutoPageSize","suppressScrollOnNewData","purgeClosedRowNodes","cacheQuickFilter","deltaRowDataMode","ensureDomOrder","accentedSort","pivotTotals","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","treeData","masterDetail","suppressMultiRangeSelection","enterMovesDownAfterEdit","enterMovesDown","suppressPropertyNamesCheck","rowMultiSelectWithClick","contractColumnSelection","suppressEnterpriseResetOnNewColumns","enableOldSetFilterModel","suppressRowHoverHighlight","gridAutoHeight","suppressRowTransform","suppressClipboardPaste"],o.FUNCTION_PROPERTIES=["localeTextFunc","groupRowInnerRenderer","groupRowInnerRendererFramework","dateComponent","dateComponentFramework","groupRowRenderer","groupRowRendererFramework","isExternalFilterPresent","getRowHeight","doesExternalFilterPass","getRowClass","getRowStyle","getRowClassRules","traverseNode","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getNodeChildDetails","groupRowAggNodes","getRowNodeId","isFullWidthCell","fullWidthCellRenderer","fullWidthCellRendererFramework","doesDataFlower","processSecondaryColDef","processSecondaryColGroupDef","getBusinessKeyForNode","sendToClipboard","navigateToNextCell","tabToNextCell","getDetailRowData","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","loadingOverlayComponent","loadingOverlayComponentFramework","noRowsOverlayComponent","noRowsOverlayComponentFramework","detailCellRenderer","detailCellRendererFramework","onGridReady","defaultGroupSortComparator","isRowMaster","isRowSelectable","postSort","processHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard"],o.ALL_PROPERTIES=o.ARRAY_PROPERTIES.concat(o.OBJECT_PROPERTIES).concat(o.STRING_PROPERTIES).concat(o.NUMBER_PROPERTIES).concat(o.FUNCTION_PROPERTIES).concat(o.BOOLEAN_PROPERTIES),o);function o(){}t.PropertyKeys=n},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(0),c=i(68),u=i(11),d=i(1),h=i(21),p=i(8),f=i(9),g=(s=p.Component,o(m,s),m.prototype.init=function(e){this.onFloatingFilterChanged=e.onFloatingFilterChanged,this.currentParentModel=e.currentParentModel;var t=null!=e.debounceMs?e.debounceMs:500,i=d._.debounce(this.syncUpWithParentFilter.bind(this),t);this.addDestroyableEventListener(this.eColumnFloatingFilter,"input",i),this.addDestroyableEventListener(this.eColumnFloatingFilter,"keypress",i),this.addDestroyableEventListener(this.eColumnFloatingFilter,"keydown",i);var n=e.column.getDefinition();n.filterParams&&n.filterParams.filterOptions&&1===n.filterParams.filterOptions.length&&"inRange"===n.filterParams.filterOptions[0]&&(this.eColumnFloatingFilter.readOnly=!0)},m.prototype.onParentModelChanged=function(e,t){if(null!=t)return this.eColumnFloatingFilter.value=this.parseAsText(t.condition1)+" "+t.operator+" "+this.parseAsText(t.condition2),this.eColumnFloatingFilter.readOnly=!0,this.lastKnownModel=null,this.eColumnFloatingFilter.title=this.eColumnFloatingFilter.value,void(this.eColumnFloatingFilter.style.cursor="default");if(this.eColumnFloatingFilter.readOnly=!1,this.equalModels(this.lastKnownModel,e))this.lastKnownModel||e||(this.eColumnFloatingFilter.value="");else{this.lastKnownModel=e;var i=this.asFloatingFilterText(e);i!==this.eColumnFloatingFilter.value&&(this.eColumnFloatingFilter.value=i,this.eColumnFloatingFilter.title="")}},m.prototype.syncUpWithParentFilter=function(e){var t=this.asParentModel();this.equalModels(this.lastKnownModel,t)||(d._.isKeyPressed(e,f.Constants.KEY_ENTER)?this.onFloatingFilterChanged({model:t,apply:!0}):this.onFloatingFilterChanged({model:t,apply:!1}))&&(this.lastKnownModel=t)},m.prototype.equalModels=function(e,t){return!!d._.referenceCompare(e,t)||!(!e||!t)&&!Array.isArray(e)&&!Array.isArray(t)&&d._.referenceCompare(e.type,t.type)&&d._.referenceCompare(e.filter,t.filter)&&d._.referenceCompare(e.filterTo,t.filterTo)&&d._.referenceCompare(e.filterType,t.filterType)},r([u.RefSelector("eColumnFloatingFilter"),a("design:type",HTMLInputElement)],m.prototype,"eColumnFloatingFilter",void 0),m);function m(){var e=s.call(this,'<div><input  ref="eColumnFloatingFilter" class="ag-floating-filter-input"></div>')||this;return e.lastKnownModel=null,e}t.InputTextFloatingFilterComp=g;var v,y=(o(b,v=g),b.prototype.asFloatingFilterText=function(e){return e?e.filter:""},b.prototype.asParentModel=function(){return{type:this.currentParentModel().type,filter:this.eColumnFloatingFilter.value,filterType:"text"}},b.prototype.parseAsText=function(e){return this.asFloatingFilterText(e)},b);function b(){return null!==v&&v.apply(this,arguments)||this}t.TextFloatingFilterComp=y;var w,C=(w=p.Component,o(_,w),_.prototype.init=function(e){this.onFloatingFilterChanged=e.onFloatingFilterChanged,this.currentParentModel=e.currentParentModel;var t=null!=e.debounceMs?e.debounceMs:500,i={onDateChanged:d._.debounce(this.onDateChanged.bind(this),t),filterParams:e.column.getColDef().filterParams};this.dateComponentPromise=this.componentRecipes.newDateComponent(i);var n=d._.loadTemplate("<div></div>");this.dateComponentPromise.then(function(e){n.appendChild(e.getGui())}),this.setTemplateFromElement(n)},_.prototype.onDateChanged=function(){var e=this.currentParentModel(),t=this.asParentModel();this.equalModels(e,t)||(this.onFloatingFilterChanged({model:t,apply:!0}),this.lastKnownModel=t)},_.prototype.equalModels=function(e,t){return!!d._.referenceCompare(e,t)||!(!e||!t)&&!Array.isArray(e)&&!Array.isArray(t)&&d._.referenceCompare(e.type,t.type)&&d._.referenceCompare(e.dateFrom,t.dateFrom)&&d._.referenceCompare(e.dateTo,t.dateTo)&&d._.referenceCompare(e.filterType,t.filterType)},_.prototype.asParentModel=function(){var e=this.currentParentModel(),t=this.dateComponentPromise.resolveNow(null,function(e){return e.getDate()}),i=d._.serializeDateToYyyyMmDd(c.DateFilter.removeTimezone(t),"-");return{type:e.type,dateFrom:i,dateTo:e?e.dateTo:null,filterType:"date"}},_.prototype.onParentModelChanged=function(t){this.lastKnownModel=t,this.dateComponentPromise.then(function(e){t&&t.dateFrom?e.setDate(d._.parseYyyyMmDdToDate(t.dateFrom,"-")):e.setDate(null)})},r([l.Autowired("componentRecipes"),a("design:type",h.ComponentRecipes)],_.prototype,"componentRecipes",void 0),_);function _(){var e=null!==w&&w.apply(this,arguments)||this;return e.lastKnownModel=null,e}t.DateFloatingFilterComp=C;var A,E=(o(x,A=g),x.prototype.asFloatingFilterText=function(e){var t=this.currentParentModel();return null==e&&null==t?"":null==e&&null!=t&&"inRange"!==t.type?(this.eColumnFloatingFilter.readOnly=!1,""):null!=t&&"inRange"===t.type?(this.eColumnFloatingFilter.readOnly=!0,this.parseAsText(t)):(this.eColumnFloatingFilter.readOnly=!1,this.parseAsText(e))},x.prototype.parseAsText=function(e){if(e.type&&"inRange"===e.type){var t=this.asNumber(e.filter),i=this.asNumber(e.filterTo);return(t?t+"":"")+"-"+(i?i+"":"")}var n=this.asNumber(e.filter);return null!=n?n+"":""},x.prototype.asParentModel=function(){var e=this.currentParentModel(),t=this.asNumber(this.eColumnFloatingFilter.value),i=this.eColumnFloatingFilter.value,n=null;return n=null==t&&""===i?null:null==t?e.filter:t,{type:e.type,filter:n,filterTo:e?e.filterTo:null,filterType:"number"}},x.prototype.asNumber=function(e){if(null==e)return null;if(""===e)return null;var t=Number(e);return d._.isNumeric(t)?t:null},x);function x(){return null!==A&&A.apply(this,arguments)||this}t.NumberFloatingFilterComp=E;var S,T=(o(D,S=g),D.prototype.init=function(e){S.prototype.init.call(this,e),this.eColumnFloatingFilter.readOnly=!0},D.prototype.asFloatingFilterText=function(e){if(this.eColumnFloatingFilter.readOnly=!0,!e)return"";var t=e instanceof Array?e:e.values;if(0===t.length)return"";var i=10<t.length?t.slice(0,10).concat("..."):t;return"("+t.length+") "+i.join(",")},D.prototype.parseAsText=function(e){return this.asFloatingFilterText(e)},D.prototype.asParentModel=function(){return null==this.eColumnFloatingFilter.value||""===this.eColumnFloatingFilter.value?{values:[],filterType:"set"}:{values:this.eColumnFloatingFilter.value.split(","),filterType:"set"}},D.prototype.equalModels=function(e,t){return!1},D);function D(){return null!==S&&S.apply(this,arguments)||this}t.SetFloatingFilterComp=T;var k,R=(o(O,k=g),O.prototype.init=function(e){k.prototype.init.call(this,e),this.eColumnFloatingFilter.readOnly=!0},O.prototype.onParentModelChanged=function(e){this.eColumnFloatingFilter.value=this.asFloatingFilterText(this.currentParentModel())},O.prototype.asFloatingFilterText=function(e){return e},O.prototype.parseAsText=function(e){return e},O.prototype.asParentModel=function(){return null},O);function O(){return null!==k&&k.apply(this,arguments)||this}t.ReadModelAsStringFloatingFilterComp=R},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r,a=i(67),s=(r=a.TextCellEditor,o(l,r),l.prototype.isPopup=function(){return!0},l);function l(){return null!==r&&r.apply(this,arguments)||this}t.PopupTextCellEditor=s},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r,a=i(75),s=(r=a.SelectCellEditor,o(l,r),l.prototype.isPopup=function(){return!0},l);function l(){return null!==r&&r.apply(this,arguments)||this}t.PopupSelectCellEditor=s},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r,a=i(8),s=i(9),l=i(1),c=(r=a.Component,o(u,r),u.prototype.init=function(e){this.params=e,this.focusAfterAttached=e.cellStartedEdit,this.textarea=document.createElement("textarea"),this.textarea.maxLength=e.maxLength?e.maxLength:"200",this.textarea.cols=e.cols?e.cols:"60",this.textarea.rows=e.rows?e.rows:"10",l.Utils.exists(e.value)&&(this.textarea.value=e.value.toString()),this.getGui().querySelector(".ag-large-textarea").appendChild(this.textarea),this.addGuiEventListener("keydown",this.onKeyDown.bind(this))},u.prototype.onKeyDown=function(e){var t=e.which||e.keyCode;(t==s.Constants.KEY_LEFT||t==s.Constants.KEY_UP||t==s.Constants.KEY_RIGHT||t==s.Constants.KEY_DOWN||e.shiftKey&&t==s.Constants.KEY_ENTER)&&e.stopPropagation()},u.prototype.afterGuiAttached=function(){this.focusAfterAttached&&this.textarea.focus()},u.prototype.getValue=function(){return this.textarea.value},u.prototype.isPopup=function(){return!0},u.TEMPLATE='<div class="ag-large-text" tabindex="0"><div class="ag-large-textarea"></div></div>',u);function u(){return r.call(this,u.TEMPLATE)||this}t.LargeTextCellEditor=c},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(1),c=i(51),u=i(11),d=(s=c.ComparableBaseFilter,o(h,s),h.prototype.getDefaultType=function(){return c.BaseFilter.CONTAINS},h.prototype.customInit=function(){this.comparator=this.filterParams.textCustomComparator?this.filterParams.textCustomComparator:h.DEFAULT_COMPARATOR,this.formatter=this.filterParams.textFormatter?this.filterParams.textFormatter:1==this.filterParams.caseSensitive?h.DEFAULT_FORMATTER:h.DEFAULT_LOWERCASE_FORMATTER,s.prototype.customInit.call(this)},h.prototype.modelFromFloatingFilter=function(e){return{type:this.filter,filter:e,filterType:"text"}},h.prototype.getApplicableFilterTypes=function(){return[c.BaseFilter.EQUALS,c.BaseFilter.NOT_EQUAL,c.BaseFilter.STARTS_WITH,c.BaseFilter.ENDS_WITH,c.BaseFilter.CONTAINS,c.BaseFilter.NOT_CONTAINS]},h.prototype.bodyTemplate=function(e){var t=this.translate.bind(this);return'<div class="ag-filter-body">\n            <input class="ag-filter-filter" id='+(e==c.FilterConditionType.MAIN?"filterText":"filterConditionText")+' type="text" placeholder="'+t("filterOoo","Filter...")+'"/>\n        </div>'},h.prototype.initialiseFilterBodyUi=function(e){s.prototype.initialiseFilterBodyUi.call(this,e),this.addFilterChangedListener(e),this.setFilter(this.filterConditionText,c.FilterConditionType.CONDITION),this.setFilterType(this.filterCondition,c.FilterConditionType.CONDITION)},h.prototype.addFilterChangedListener=function(e){var t=this,i=e===c.FilterConditionType.MAIN?this.eFilterTextField:this.eFilterConditionTextField,n=this.getDebounceMs(this.filterParams),o=l.Utils.debounce(function(){return t.onFilterTextFieldChanged(e)},n);this.addDestroyableEventListener(i,"input",o)},h.prototype.refreshFilterBodyUi=function(e){this.eFilterConditionTextField&&this.addFilterChangedListener(c.FilterConditionType.CONDITION)},h.prototype.afterGuiAttached=function(){this.eFilterTextField.focus()},h.prototype.filterValues=function(e){return e===c.FilterConditionType.MAIN?this.filterText:this.filterConditionText},h.prototype.individualFilterPasses=function(e,t){var i=t==c.FilterConditionType.MAIN?this.filterText:this.filterConditionText,n=t==c.FilterConditionType.MAIN?this.filter:this.filterCondition;return i?this.checkIndividualFilter(e,n,i):t===c.FilterConditionType.MAIN||"AND"===this.conditionValue},h.prototype.checkIndividualFilter=function(e,t,i){var n=this.filterParams.valueGetter(e.node);if(!n)return t===c.BaseFilter.NOT_EQUAL||t===c.BaseFilter.NOT_CONTAINS;var o=this.formatter(n);return this.comparator(t,o,i)},h.prototype.onFilterTextFieldChanged=function(e){var t=e===c.FilterConditionType.MAIN?this.eFilterTextField.value:this.eFilterConditionTextField.value,i=e===c.FilterConditionType.MAIN?this.filterText:this.filterConditionText,n=l.Utils.makeNull(t);if(n&&""===n.trim()&&(n=null),i!==n){var o=n&&1!=this.filterParams.caseSensitive?n.toLowerCase():n,r=i&&1!=this.filterParams.caseSensitive?i.toLowerCase():i;e===c.FilterConditionType.MAIN?this.filterText=this.formatter(n):this.filterConditionText=this.formatter(n),r!==o&&this.onFilterChanged()}},h.prototype.setFilter=function(e,t){if(e=l.Utils.makeNull(e),t===c.FilterConditionType.MAIN)if(e){if(this.filterText=this.formatter(e),!this.eFilterTextField)return;this.eFilterTextField.value=e}else{if(this.filterText=null,!this.eFilterTextField)return;this.eFilterTextField.value=null}else if(e){if(this.filterConditionText=this.formatter(e),!this.eFilterConditionTextField)return;this.eFilterConditionTextField.value=e}else{if(this.filterConditionText=null,!this.eFilterConditionTextField)return;this.eFilterConditionTextField.value=null}},h.prototype.getFilter=function(){return this.filterText},h.prototype.resetState=function(){this.setFilter(null,c.FilterConditionType.MAIN),this.setFilterType(this.defaultFilter,c.FilterConditionType.MAIN),this.setFilter(null,c.FilterConditionType.CONDITION),this.setFilterType(this.defaultFilter,c.FilterConditionType.CONDITION)},h.prototype.serialize=function(e){var t=e===c.FilterConditionType.MAIN?this.filter:this.filterCondition,i=e===c.FilterConditionType.MAIN?this.filterText:this.filterConditionText;return{type:t||this.defaultFilter,filter:i,filterType:"text"}},h.prototype.parse=function(e,t){this.setFilterType(e.type,t),this.setFilter(e.filter,t)},h.prototype.setType=function(e,t){this.setFilterType(e,t)},h.DEFAULT_FORMATTER=function(e){return e},h.DEFAULT_LOWERCASE_FORMATTER=function(e){return null==e?null:e.toString().toLowerCase()},h.DEFAULT_COMPARATOR=function(e,t,i){switch(e){case h.CONTAINS:return 0<=t.indexOf(i);case h.NOT_CONTAINS:return-1===t.indexOf(i);case h.EQUALS:return t===i;case h.NOT_EQUAL:return t!=i;case h.STARTS_WITH:return 0===t.indexOf(i);case h.ENDS_WITH:var n=t.lastIndexOf(i);return 0<=n&&n===t.length-i.length;default:return console.warn("invalid filter type "+e),!1}},r([u.QuerySelector("#filterText"),a("design:type",HTMLInputElement)],h.prototype,"eFilterTextField",void 0),r([u.QuerySelector("#filterConditionText"),a("design:type",HTMLInputElement)],h.prototype,"eFilterConditionTextField",void 0),h);function h(){return null!==s&&s.apply(this,arguments)||this}t.TextFilter=d},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(1),c=i(11),u=i(51),d=(s=u.ScalarBaseFilter,o(h,s),h.prototype.modelFromFloatingFilter=function(e){return{type:this.filter,filter:Number(e),filterTo:this.filterNumberTo,filterType:"number"}},h.prototype.getApplicableFilterTypes=function(){return[u.BaseFilter.EQUALS,u.BaseFilter.NOT_EQUAL,u.BaseFilter.LESS_THAN,u.BaseFilter.LESS_THAN_OR_EQUAL,u.BaseFilter.GREATER_THAN,u.BaseFilter.GREATER_THAN_OR_EQUAL,u.BaseFilter.IN_RANGE]},h.prototype.bodyTemplate=function(e){var t=this.translate.bind(this),i=e==u.FilterConditionType.MAIN?"filterText":"filterConditionText",n=e==u.FilterConditionType.MAIN?"filterNumberToPanel":"filterNumberToPanelCondition",o=e==u.FilterConditionType.MAIN?"filterToText":"filterToConditionText";return'<div class="ag-filter-body">\n            <div>\n                <input class="ag-filter-filter" id="'+i+'" type="text" placeholder="'+t("filterOoo")+'"/>\n            </div>\n             <div class="ag-filter-number-to" id="'+n+'">\n                <input class="ag-filter-filter" id="'+o+'" type="text" placeholder="'+t("filterOoo")+'"/>\n            </div>\n        </div>'},h.prototype.initialiseFilterBodyUi=function(e){s.prototype.initialiseFilterBodyUi.call(this,e),e===u.FilterConditionType.MAIN?(this.eFilterTextField=this.queryForHtmlInputElement("#filterText"),this.addFilterChangedEventListeners(e,this.eFilterTextField,this.eFilterToTextField)):(this.eFilterTextConditionField=this.queryForHtmlInputElement("#filterConditionText"),this.addFilterChangedEventListeners(e,this.eFilterTextConditionField,this.eFilterToConditionText),this.setFilter(this.filterNumberCondition,u.FilterConditionType.CONDITION),this.setFilterTo(this.filterNumberConditionTo,u.FilterConditionType.CONDITION),this.setFilterType(this.filterCondition,u.FilterConditionType.CONDITION))},h.prototype.addFilterChangedEventListeners=function(e,t,i){var n=this,o=this.getDebounceMs(this.filterParams),r=l.Utils.debounce(function(){return n.onTextFieldsChanged(e,t,i)},o);this.addDestroyableEventListener(t,"input",r),this.addDestroyableEventListener(i,"input",r)},h.prototype.afterGuiAttached=function(){this.eFilterTextField.focus()},h.prototype.comparator=function(){return function(e,t){return e===t?0:e<t?1:t<e?-1:void 0}},h.prototype.onTextFieldsChanged=function(e,t,i){var n=this.stringToFloat(t.value),o=this.stringToFloat(i.value);e===u.FilterConditionType.MAIN?this.filterNumber===n&&this.filterNumberTo===o||(this.filterNumber=n,this.filterNumberTo=o,this.onFilterChanged()):this.filterNumberCondition===n&&this.filterNumberConditionTo===o||(this.filterNumberCondition=n,this.filterNumberConditionTo=o,this.onFilterChanged())},h.prototype.filterValues=function(e){return e===u.FilterConditionType.MAIN?this.filter!==u.BaseFilter.IN_RANGE?this.asNumber(this.filterNumber):[this.asNumber(this.filterNumber),this.asNumber(this.filterNumberTo)]:this.filterCondition!==u.BaseFilter.IN_RANGE?this.asNumber(this.filterNumberCondition):[this.asNumber(this.filterNumberCondition),this.asNumber(this.filterNumberConditionTo)]},h.prototype.asNumber=function(e){return l.Utils.isNumeric(e)?e:null},h.prototype.stringToFloat=function(e){var t=l.Utils.makeNull(e);return t&&""===t.trim()&&(t=null),null!=t?parseFloat(t):null},h.prototype.setFilter=function(e,t){if(null!==(e=l.Utils.makeNull(e))&&"number"!=typeof e&&(e=parseFloat(e)),t===u.FilterConditionType.MAIN){if(this.filterNumber=e,!this.eFilterTextField)return;this.eFilterTextField.value=e}else{if(this.filterNumberCondition=e,!this.eFilterTextConditionField)return;this.eFilterTextConditionField.value=e}},h.prototype.setFilterTo=function(e,t){if(null!==(e=l.Utils.makeNull(e))&&"number"!=typeof e&&(e=parseFloat(e)),t===u.FilterConditionType.MAIN){if(this.filterNumberTo=e,!this.eFilterToTextField)return;this.eFilterToTextField.value=e}else{if(this.filterNumberConditionTo=e,!this.eFilterToConditionText)return;this.eFilterToConditionText.value=e}},h.prototype.getFilter=function(e){return e===u.FilterConditionType.MAIN?this.filterNumber:this.filterNumberCondition},h.prototype.serialize=function(e){var t=e===u.FilterConditionType.MAIN?this.filter:this.filterCondition,i=e===u.FilterConditionType.MAIN?this.filterNumber:this.filterNumberCondition,n=e===u.FilterConditionType.MAIN?this.filterNumberTo:this.filterNumberConditionTo;return{type:t||this.defaultFilter,filter:i,filterTo:n,filterType:"number"}},h.prototype.parse=function(e,t){this.setFilterType(e.type,t),this.setFilter(e.filter,t),this.setFilterTo(e.filterTo,t)},h.prototype.refreshFilterBodyUi=function(e){var t=e===u.FilterConditionType.MAIN?this.filter:this.filterCondition,i=e===u.FilterConditionType.MAIN?this.eNumberToPanel:this.eNumberToConditionPanel;if(i){var n=t===h.IN_RANGE;l.Utils.setVisible(i,n)}},h.prototype.resetState=function(){this.setFilterType(this.defaultFilter,u.FilterConditionType.MAIN),this.setFilter(null,u.FilterConditionType.MAIN),this.setFilterTo(null,u.FilterConditionType.MAIN),this.setFilterType(this.defaultFilter,u.FilterConditionType.CONDITION),this.setFilter(null,u.FilterConditionType.CONDITION),this.setFilterTo(null,u.FilterConditionType.CONDITION)},h.prototype.setType=function(e,t){this.setFilterType(e,t)},h.LESS_THAN="lessThan",r([c.QuerySelector("#filterNumberToPanel"),a("design:type",HTMLElement)],h.prototype,"eNumberToPanel",void 0),r([c.QuerySelector("#filterNumberToPanelCondition"),a("design:type",HTMLElement)],h.prototype,"eNumberToConditionPanel",void 0),r([c.QuerySelector("#filterToText"),a("design:type",HTMLInputElement)],h.prototype,"eFilterToTextField",void 0),r([c.QuerySelector("#filterToConditionText"),a("design:type",HTMLInputElement)],h.prototype,"eFilterToConditionText",void 0),h);function h(){return null!==s&&s.apply(this,arguments)||this}t.NumberFilter=d},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(23),s=i(9),l=i(44),c=i(29),u=i(22),d=i(1),h=i(37),p=i(4),f=i(2),g=(m.prototype.init=function(){this.scrollWidth=this.gridOptionsWrapper.getScrollbarWidth()},m.prototype.registerGridComp=function(e){this.gridPanel=e},m.prototype.handlePageScrollingKey=function(e){var t=e.which||e.keyCode,i=e.altKey,n=e.ctrlKey,o=this.mouseEventService.getGridCellForEvent(e).getGridCellDef();if(!o)return!1;var r=!1;switch(t){case s.Constants.KEY_PAGE_HOME:case s.Constants.KEY_PAGE_END:n||i||(this.onHomeOrEndKey(t),r=!0);break;case s.Constants.KEY_LEFT:case s.Constants.KEY_RIGHT:n&&!i&&(this.onCtrlLeftOrRight(t,o),r=!0);break;case s.Constants.KEY_UP:case s.Constants.KEY_DOWN:n&&!i&&(this.onCtrlUpOrDown(t,o),r=!0);break;case s.Constants.KEY_PAGE_DOWN:n||i||(this.onPageDown(o),r=!0);break;case s.Constants.KEY_PAGE_UP:n||i||(this.onPageUp(o),r=!0)}return r&&e.preventDefault(),r},m.prototype.onPageDown=function(e){var t=this.gridPanel.getVScrollPosition(),i=t.bottom-t.top;this.gridPanel.isHorizontalScrollShowing()&&(i-=this.scrollWidth);var n=this.paginationProxy.getPixelOffset(),o=t.top+i,r=this.paginationProxy.getRowIndexAtPixel(o+n),a=this.paginationProxy.getRow(e.rowIndex).rowTop+i-n,s=this.paginationProxy.getRowIndexAtPixel(a+n),l=this.paginationProxy.getPageLastRow();l<s&&(s=l),l<r&&(r=l),this.navigateTo(r,"top",null,s,e.column)},m.prototype.onPageUp=function(e){var t=this.gridPanel.getVScrollPosition(),i=t.bottom-t.top;this.gridPanel.isHorizontalScrollShowing()&&(i-=this.scrollWidth);var n=this.paginationProxy.getPixelOffset(),o=t.top,r=this.paginationProxy.getRowIndexAtPixel(o+n),a=this.paginationProxy.getRow(e.rowIndex),s=a.rowTop+a.rowHeight-i-n,l=this.paginationProxy.getRowIndexAtPixel(s+n),c=this.paginationProxy.getPageFirstRow();l<c&&(l=c),r<c&&(r=c),this.navigateTo(r,"bottom",null,l,e.column)},m.prototype.navigateTo=function(e,t,i,n,o){if(d._.exists(i)&&this.gridPanel.ensureColumnVisible(i),d._.exists(e)&&this.gridPanel.ensureIndexVisible(e,t),this.animationFrameService.flushAllFrames(),this.focusedCellController.setFocusedCell(n,o,null,!0),this.rangeController){var r=new a.GridCell({rowIndex:n,floating:null,column:o});this.rangeController.setRangeToCell(r)}},m.prototype.onCtrlUpOrDown=function(e,t){var i=e===s.Constants.KEY_UP?0:this.paginationProxy.getPageLastRow();this.navigateTo(i,null,t.column,i,t.column)},m.prototype.onCtrlLeftOrRight=function(e,t){var i=e===s.Constants.KEY_LEFT,n=this.columnController.getAllDisplayedColumns(),o=i?n[0]:n[n.length-1];this.navigateTo(t.rowIndex,null,o,t.rowIndex,o)},m.prototype.onHomeOrEndKey=function(e){var t=e===s.Constants.KEY_PAGE_HOME,i=this.columnController.getAllDisplayedColumns(),n=t?i[0]:i[i.length-1],o=t?0:this.paginationProxy.getPageLastRow();this.navigateTo(o,null,n,o,n)},n([r.Autowired("mouseEventService"),o("design:type",l.MouseEventService)],m.prototype,"mouseEventService",void 0),n([r.Autowired("paginationProxy"),o("design:type",c.PaginationProxy)],m.prototype,"paginationProxy",void 0),n([r.Autowired("focusedCellController"),o("design:type",u.FocusedCellController)],m.prototype,"focusedCellController",void 0),n([r.Autowired("animationFrameService"),o("design:type",h.AnimationFrameService)],m.prototype,"animationFrameService",void 0),n([r.Optional("rangeController"),o("design:type",Object)],m.prototype,"rangeController",void 0),n([r.Autowired("columnController"),o("design:type",p.ColumnController)],m.prototype,"columnController",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",f.GridOptionsWrapper)],m.prototype,"gridOptionsWrapper",void 0),n([r.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],m.prototype,"init",null),m=n([r.Bean("navigationService")],m));function m(){}t.NavigationService=g},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),a=i(2),s=i(0),l=i(15),c=i(4),u=i(3),d=i(5),h=i(99),p=i(101),f=i(10),g=i(36),m=(v.prototype.registerGridComp=function(e){this.setupDragAndDrop(e)},v.prototype.forEachHeaderElement=function(t){this.headerRowComps.forEach(function(e){return e.forEachHeaderElement(t)})},v.prototype.init=function(){this.scrollWidth=this.gridOptionsWrapper.getScrollbarWidth(),this.eventService.addEventListener(d.Events.EVENT_COLUMN_VALUE_CHANGED,this.onColumnValueChanged.bind(this)),this.eventService.addEventListener(d.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onColumnRowGroupChanged.bind(this)),this.eventService.addEventListener(d.Events.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.eventService.addEventListener(d.Events.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.eventService.addEventListener(d.Events.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.eventService.addEventListener(d.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this))},v.prototype.onColumnRowGroupChanged=function(){this.onGridColumnsChanged()},v.prototype.onColumnValueChanged=function(){this.onGridColumnsChanged()},v.prototype.onColumnResized=function(){this.setWidthOfPinnedContainer()},v.prototype.onDisplayedColumnsChanged=function(){this.setWidthOfPinnedContainer()},v.prototype.onScrollVisibilityChanged=function(){this.setWidthOfPinnedContainer()},v.prototype.setWidthOfPinnedContainer=function(){var e=this.pinned===f.Column.PINNED_LEFT,t=this.pinned===f.Column.PINNED_RIGHT;if(e||t){var i=e?this.columnController.getPinnedLeftContainerWidth():this.columnController.getPinnedRightContainerWidth();(e?this.scrollVisibleService.isLeftVerticalScrollShowing():this.scrollVisibleService.isRightVerticalScrollShowing())&&(i+=this.scrollWidth),this.eContainer.style.width=i+"px"}},v.prototype.destroy=function(){this.removeHeaderRowComps()},v.prototype.onGridColumnsChanged=function(){this.removeHeaderRowComps(),this.createHeaderRowComps()},v.prototype.refresh=function(){this.onGridColumnsChanged()},v.prototype.setupDragAndDrop=function(e){var t=this.eViewport?this.eViewport:this.eContainer,i=new p.BodyDropTarget(this.pinned,t);this.context.wireBean(i),i.registerGridComp(e)},v.prototype.removeHeaderRowComps=function(){this.headerRowComps.forEach(function(e){e.destroy()}),this.headerRowComps.length=0,r.Utils.removeAllChildren(this.eContainer)},v.prototype.createHeaderRowComps=function(){for(var e=this.columnController.getHeaderRowCount(),t=0;t<e;t++){var i=t!==e-1?h.HeaderRowType.COLUMN_GROUP:h.HeaderRowType.COLUMN,n=new h.HeaderRowComp(t,i,this.pinned,this.dropTarget);this.context.wireBean(n),this.headerRowComps.push(n),this.eContainer.appendChild(n.getGui())}this.gridOptionsWrapper.isFloatingFilter()&&!this.columnController.isPivotMode()&&(n=new h.HeaderRowComp(e,h.HeaderRowType.FLOATING_FILTER,this.pinned,this.dropTarget),this.context.wireBean(n),this.headerRowComps.push(n),this.eContainer.appendChild(n.getGui()))},n([s.Autowired("gridOptionsWrapper"),o("design:type",a.GridOptionsWrapper)],v.prototype,"gridOptionsWrapper",void 0),n([s.Autowired("context"),o("design:type",s.Context)],v.prototype,"context",void 0),n([s.Autowired("$scope"),o("design:type",Object)],v.prototype,"$scope",void 0),n([s.Autowired("dragAndDropService"),o("design:type",l.DragAndDropService)],v.prototype,"dragAndDropService",void 0),n([s.Autowired("columnController"),o("design:type",c.ColumnController)],v.prototype,"columnController",void 0),n([s.Autowired("eventService"),o("design:type",u.EventService)],v.prototype,"eventService",void 0),n([s.Autowired("scrollVisibleService"),o("design:type",g.ScrollVisibleService)],v.prototype,"scrollVisibleService",void 0),n([s.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],v.prototype,"init",null),v);function v(e,t,i){this.headerRowComps=[],this.eContainer=e,this.pinned=i,this.eViewport=t}t.HeaderContainer=m},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var u,s,l=i(8),c=i(0),d=i(2),h=i(4),p=i(10),f=i(3),g=i(5),m=i(1),v=i(100),y=i(133),b=i(18),w=i(21),C=i(6);(s=u=t.HeaderRowType||(t.HeaderRowType={}))[s.COLUMN_GROUP=0]="COLUMN_GROUP",s[s.COLUMN=1]="COLUMN",s[s.FLOATING_FILTER=2]="FLOATING_FILTER";var _,A=(_=l.Component,o(E,_),E.prototype.forEachHeaderElement=function(t){var i=this;Object.keys(this.headerComps).forEach(function(e){t(i.headerComps[e])})},E.prototype.destroy=function(){var e=Object.keys(this.headerComps);this.removeAndDestroyChildComponents(e),_.prototype.destroy.call(this)},E.prototype.removeAndDestroyChildComponents=function(e){var i=this;e.forEach(function(e){var t=i.headerComps[e];i.getGui().removeChild(t.getGui()),t.destroy&&t.destroy(),delete i.headerComps[e]})},E.prototype.onRowHeightChanged=function(){var e,t,i=this.columnController.getHeaderRowCount(),n=[],o=0;t=this.columnController.isPivotMode()?(o=0,e=this.gridOptionsWrapper.getPivotGroupHeaderHeight(),this.gridOptionsWrapper.getPivotHeaderHeight()):(this.gridOptionsWrapper.isFloatingFilter()&&i++,o=this.gridOptionsWrapper.isFloatingFilter()?1:0,e=this.gridOptionsWrapper.getGroupHeaderHeight(),this.gridOptionsWrapper.getHeaderHeight());for(var r=i-(1+o),a=0;a<r;a++)n.push(e);for(n.push(t),a=0;a<o;a++)n.push(this.gridOptionsWrapper.getFloatingFiltersHeight());var s=0;for(a=0;a<this.dept;a++)s+=n[a];this.getGui().style.top=s+"px",this.getGui().style.height=n[this.dept]+"px"},E.prototype.init=function(){this.onRowHeightChanged(),this.onVirtualColumnsChanged(),this.setWidth(),this.addDestroyableEventListener(this.gridOptionsWrapper,d.GridOptionsWrapper.PROP_HEADER_HEIGHT,this.onRowHeightChanged.bind(this)),this.addDestroyableEventListener(this.gridOptionsWrapper,d.GridOptionsWrapper.PROP_PIVOT_HEADER_HEIGHT,this.onRowHeightChanged.bind(this)),this.addDestroyableEventListener(this.gridOptionsWrapper,d.GridOptionsWrapper.PROP_GROUP_HEADER_HEIGHT,this.onRowHeightChanged.bind(this)),this.addDestroyableEventListener(this.gridOptionsWrapper,d.GridOptionsWrapper.PROP_PIVOT_GROUP_HEADER_HEIGHT,this.onRowHeightChanged.bind(this)),this.addDestroyableEventListener(this.gridOptionsWrapper,d.GridOptionsWrapper.PROP_FLOATING_FILTERS_HEIGHT,this.onRowHeightChanged.bind(this)),this.addDestroyableEventListener(this.eventService,g.Events.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addDestroyableEventListener(this.eventService,g.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addDestroyableEventListener(this.eventService,g.Events.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addDestroyableEventListener(this.eventService,g.Events.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this))},E.prototype.onColumnResized=function(){this.setWidth()},E.prototype.setWidth=function(){var e=this.columnController.getContainerWidth(this.pinned)+"px";this.getGui().style.width=e},E.prototype.onGridColumnsChanged=function(){this.removeAndDestroyAllChildComponents()},E.prototype.removeAndDestroyAllChildComponents=function(){var e=Object.keys(this.headerComps);this.removeAndDestroyChildComponents(e)},E.prototype.onDisplayedColumnsChanged=function(){this.onVirtualColumnsChanged(),this.setWidth()},E.prototype.onVirtualColumnsChanged=function(){var a,s=this,l=Object.keys(this.headerComps),e=this.columnController.getVirtualHeaderGroupRow(this.pinned,this.type==u.FLOATING_FILTER?this.dept-1:this.dept),c=this.gridOptionsWrapper.isEnsureDomOrder();e.forEach(function(e){if(!e.isEmptyGroup()){var t,i,n=e.getUniqueId(),o=s.getGui(),r=0<=l.indexOf(n);r?(m.Utils.removeFromArray(l,n),i=(t=s.headerComps[n]).getGui(),c&&m.Utils.ensureDomOrder(o,i,a)):(t=s.createHeaderComp(e),i=(s.headerComps[n]=t).getGui(),c?m.Utils.insertWithDomOrder(o,i,a):o.appendChild(i)),a=i}}),this.removeAndDestroyChildComponents(l)},E.prototype.createHeaderComp=function(e){var t;switch(this.type){case u.COLUMN:t=new v.HeaderWrapperComp(e,this.dropTarget,this.pinned);break;case u.COLUMN_GROUP:t=new y.HeaderGroupWrapperComp(e,this.dropTarget,this.pinned);break;case u.FLOATING_FILTER:var i=e;t=this.createFloatingFilterWrapper(i)}return this.context.wireBean(t),t},E.prototype.createFloatingFilterWrapper=function(t){var i=this,e=this.createFloatingFilterParams(t),n=this.componentRecipes.newFloatingFilterWrapperComponent(t,e);if(this.addDestroyableEventListener(t,p.Column.EVENT_FILTER_CHANGED,function(){var e=i.filterManager.getFilterComponent(t);n.onParentModelChanged(e.resolveNow(null,function(e){return e.getModel()}))}),this.filterManager.cachedFilter(t)){var o=this.filterManager.getFilterComponent(t);n.onParentModelChanged(o.resolveNow(null,function(e){return e.getModel()}))}return n},E.prototype.createFloatingFilterParams=function(t){var o=this;return{api:this.gridApi,column:t,currentParentModel:function(){var e=o.filterManager.getFilterComponent(t).resolveNow(null,function(e){return e.getNullableModel?e.getNullableModel():e.getModel()});return null!=e.operator?e.condition1:e},onFloatingFilterChanged:function(i){var n,e=new m.Promise(function(e){n=e});return o.filterManager.getFilterComponent(t).then(function(e){if(e.onFloatingFilterChanged){var t=e.onFloatingFilterChanged(i);n(t)}else e.setModel(i),o.filterManager.onFilterChanged(),n(!0)}),e.resolveNow(!0,function(e){return e})},suppressFilterButton:!1}},r([c.Autowired("gridOptionsWrapper"),a("design:type",d.GridOptionsWrapper)],E.prototype,"gridOptionsWrapper",void 0),r([c.Autowired("gridApi"),a("design:type",C.GridApi)],E.prototype,"gridApi",void 0),r([c.Autowired("columnController"),a("design:type",h.ColumnController)],E.prototype,"columnController",void 0),r([c.Autowired("context"),a("design:type",c.Context)],E.prototype,"context",void 0),r([c.Autowired("eventService"),a("design:type",f.EventService)],E.prototype,"eventService",void 0),r([c.Autowired("filterManager"),a("design:type",b.FilterManager)],E.prototype,"filterManager",void 0),r([c.Autowired("componentRecipes"),a("design:type",w.ComponentRecipes)],E.prototype,"componentRecipes",void 0),r([c.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],E.prototype,"init",null),E);function E(e,t,i,n){var o=_.call(this,'<div class="ag-header-row" role="presentation"/>')||this;return o.headerComps={},o.dept=e,o.type=t,o.pinned=i,o.dropTarget=n,o}t.HeaderRowComp=A},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(8),c=i(0),u=i(10),d=i(1),h=i(15),p=i(7),f=i(4),g=i(59),m=i(2),v=i(81),y=i(52),b=i(6),w=i(24),C=i(3),_=i(21),A=i(60),E=i(11),x=i(132),S=i(5),T=i(45),D=i(28),k=i(74),R=i(46),O=(s=l.Component,o(N,s),N.prototype.getColumn=function(){return this.column},N.prototype.init=function(){this.instantiate(this.context);var e=this.columnController.getDisplayNameForColumn(this.column,"header",!0),t=this.gridOptionsWrapper.isEnableSorting()&&!this.column.getColDef().suppressSorting,i=this.menuFactory.isMenuEnabled(this.column)&&!this.column.getColDef().suppressMenu;this.appendHeaderComp(e,t,i),this.setupWidth(),this.setupMovingCss(),this.setupTooltip(),this.setupResize(),this.setupMenuClass(),this.setupSortableClass(t),this.addColumnHoverListener(),this.addFeature(this.context,new k.HoverFeature([this.column],this.getGui())),this.addDestroyableEventListener(this.column,u.Column.EVENT_FILTER_ACTIVE_CHANGED,this.onFilterChanged.bind(this)),this.onFilterChanged(),this.addFeature(this.context,new x.SelectAllFeature(this.cbSelectAll,this.column));var n=new y.SetLeftFeature(this.column,this.getGui(),this.beans);n.init(),this.addDestroyFunc(n.destroy.bind(n)),this.addAttributes(),v.CssClassApplier.addHeaderClassesFromColDef(this.column.getColDef(),this.getGui(),this.gridOptionsWrapper,this.column,null)},N.prototype.addColumnHoverListener=function(){this.addDestroyableEventListener(this.eventService,S.Events.EVENT_COLUMN_HOVER_CHANGED,this.onColumnHover.bind(this)),this.onColumnHover()},N.prototype.onColumnHover=function(){var e=this.columnHoverService.isHovered(this.column);d.Utils.addOrRemoveCssClass(this.getGui(),"ag-column-hover",e)},N.prototype.setupSortableClass=function(e){if(e){var t=this.getGui();d.Utils.addCssClass(t,"ag-header-cell-sortable")}},N.prototype.onFilterChanged=function(){var e=this.column.isFilterActive();d.Utils.addOrRemoveCssClass(this.getGui(),"ag-header-cell-filtered",e)},N.prototype.appendHeaderComp=function(e,t,i){var n=this,o={column:this.column,displayName:e,enableSorting:t,enableMenu:i,showColumnMenu:function(e){n.gridApi.showColumnMenuAfterButtonClick(n.column,e)},progressSort:function(e){n.sortController.progressSort(n.column,!!e,"uiColumnSorted")},setSort:function(e,t){n.sortController.setSortForColumn(n.column,e,!!t,"uiColumnSorted")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsWrapper.getContext()},r=this.afterHeaderCompCreated.bind(this,e);this.componentRecipes.newHeaderComponent(o).then(r)},N.prototype.afterHeaderCompCreated=function(e,t){this.appendChild(t),this.setupMove(t.getGui(),e),t.destroy&&this.addDestroyFunc(t.destroy.bind(t))},N.prototype.onColumnMovingChanged=function(){this.column.isMoving()?d.Utils.addCssClass(this.getGui(),"ag-header-cell-moving"):d.Utils.removeCssClass(this.getGui(),"ag-header-cell-moving")},N.prototype.setupMove=function(e,t){var i=this;if(!(this.gridOptionsWrapper.isSuppressMovableColumns()||this.column.getColDef().suppressMovable||this.column.isLockPosition())&&e){var n={type:h.DragSourceType.HeaderCell,eElement:e,dragItemCallback:function(){return i.createDragItem()},dragItemName:t,dragSourceDropTarget:this.dragSourceDropTarget,dragStarted:function(){return i.column.setMoving(!0,"uiColumnMoved")},dragStopped:function(){return i.column.setMoving(!1,"uiColumnMoved")}};this.dragAndDropService.addDragSource(n,!0),this.addDestroyFunc(function(){return i.dragAndDropService.removeDragSource(n)})}},N.prototype.createDragItem=function(){var e={};return e[this.column.getId()]=this.column.isVisible(),{columns:[this.column],visibleState:e}},N.prototype.setupResize=function(){var e=this,t=this.column.getColDef();if(this.eResize)if(this.column.isResizable()){var i=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(i),!this.gridOptionsWrapper.isSuppressAutoSize()&&!t.suppressAutoSize){this.addDestroyableEventListener(this.eResize,"dblclick",function(){e.columnController.autoSizeColumn(e.column,"uiColumnResized")});var n=new R.TouchListener(this.eResize);this.addDestroyableEventListener(n,R.TouchListener.EVENT_DOUBLE_TAP,function(){e.columnController.autoSizeColumn(e.column,"uiColumnResized")}),this.addDestroyFunc(n.destroy.bind(n))}}else d.Utils.removeFromParent(this.eResize)},N.prototype.onResizing=function(e,t){var i=this.normaliseResizeAmount(t),n=this.resizeStartWidth+i;this.columnController.setColumnWidth(this.column,n,this.resizeWithShiftKey,e,"uiColumnDragged")},N.prototype.onResizeStart=function(e){this.resizeStartWidth=this.column.getActualWidth(),this.resizeWithShiftKey=e},N.prototype.setupTooltip=function(){var e=this.column.getColDef();e.headerTooltip&&(this.getGui().title=e.headerTooltip)},N.prototype.setupMovingCss=function(){this.addDestroyableEventListener(this.column,u.Column.EVENT_MOVING_CHANGED,this.onColumnMovingChanged.bind(this)),this.onColumnMovingChanged()},N.prototype.addAttributes=function(){this.getGui().setAttribute("col-id",this.column.getColId())},N.prototype.setupWidth=function(){this.addDestroyableEventListener(this.column,u.Column.EVENT_WIDTH_CHANGED,this.onColumnWidthChanged.bind(this)),this.onColumnWidthChanged()},N.prototype.setupMenuClass=function(){this.addDestroyableEventListener(this.column,u.Column.EVENT_MENU_VISIBLE_CHANGED,this.onMenuVisible.bind(this)),this.onColumnWidthChanged()},N.prototype.onMenuVisible=function(){this.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())},N.prototype.onColumnWidthChanged=function(){this.getGui().style.width=this.column.getActualWidth()+"px"},N.prototype.normaliseResizeAmount=function(e){var t=e;return this.gridOptionsWrapper.isEnableRtl()?this.pinned!==u.Column.PINNED_LEFT&&(t*=-1):this.pinned===u.Column.PINNED_RIGHT&&(t*=-1),t},N.TEMPLATE='<div class="ag-header-cell" role="presentation" ><div ref="eResize" class="ag-header-cell-resize" role="presentation"></div><ag-checkbox ref="cbSelectAll" class="ag-header-select-all" role="presentation"></ag-checkbox></div>',r([c.Autowired("gridOptionsWrapper"),a("design:type",m.GridOptionsWrapper)],N.prototype,"gridOptionsWrapper",void 0),r([c.Autowired("dragAndDropService"),a("design:type",h.DragAndDropService)],N.prototype,"dragAndDropService",void 0),r([c.Autowired("columnController"),a("design:type",f.ColumnController)],N.prototype,"columnController",void 0),r([c.Autowired("horizontalResizeService"),a("design:type",g.HorizontalResizeService)],N.prototype,"horizontalResizeService",void 0),r([c.Autowired("context"),a("design:type",c.Context)],N.prototype,"context",void 0),r([c.Autowired("menuFactory"),a("design:type",Object)],N.prototype,"menuFactory",void 0),r([c.Autowired("gridApi"),a("design:type",b.GridApi)],N.prototype,"gridApi",void 0),r([c.Autowired("columnApi"),a("design:type",p.ColumnApi)],N.prototype,"columnApi",void 0),r([c.Autowired("sortController"),a("design:type",w.SortController)],N.prototype,"sortController",void 0),r([c.Autowired("eventService"),a("design:type",C.EventService)],N.prototype,"eventService",void 0),r([c.Autowired("componentRecipes"),a("design:type",_.ComponentRecipes)],N.prototype,"componentRecipes",void 0),r([c.Autowired("columnHoverService"),a("design:type",T.ColumnHoverService)],N.prototype,"columnHoverService",void 0),r([c.Autowired("beans"),a("design:type",D.Beans)],N.prototype,"beans",void 0),r([E.RefSelector("eResize"),a("design:type",HTMLElement)],N.prototype,"eResize",void 0),r([E.RefSelector("cbSelectAll"),a("design:type",A.AgCheckbox)],N.prototype,"cbSelectAll",void 0),r([c.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],N.prototype,"init",null),N);function N(e,t,i){var n=s.call(this,N.TEMPLATE)||this;return n.column=e,n.dragSourceDropTarget=t,n.pinned=i,n}t.HeaderWrapperComp=O},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r,a,s=i(15),l=i(0),c=i(102),u=i(10),d=i(103),h=i(4);(a=r=r||{})[a.ColumnMove=0]="ColumnMove",a[a.Pivot=1]="Pivot";var p=(f.prototype.registerGridComp=function(e){switch(this.gridPanel=e,this.moveColumnController.registerGridComp(e),this.pinned){case u.Column.PINNED_LEFT:this.eSecondaryContainers=this.gridPanel.getDropTargetLeftContainers();break;case u.Column.PINNED_RIGHT:this.eSecondaryContainers=this.gridPanel.getDropTargetRightContainers();break;default:this.eSecondaryContainers=this.gridPanel.getDropTargetBodyContainers()}},f.prototype.isInterestedIn=function(e){return e===s.DragSourceType.HeaderCell||e===s.DragSourceType.ToolPanel},f.prototype.getSecondaryContainers=function(){return this.eSecondaryContainers},f.prototype.getContainer=function(){return this.eContainer},f.prototype.init=function(){this.moveColumnController=new c.MoveColumnController(this.pinned,this.eContainer),this.context.wireBean(this.moveColumnController);var e=new d.BodyDropPivotTarget(this.pinned);this.context.wireBean(e),this.dropListeners[r.ColumnMove]=this.moveColumnController,this.dropListeners[r.Pivot]=e,this.dragAndDropService.addDropTarget(this)},f.prototype.getIconName=function(){return this.currentDropListener.getIconName()},f.prototype.getDropType=function(e){return this.columnController.isPivotMode()&&e.dragSource.type===s.DragSourceType.ToolPanel?r.Pivot:r.ColumnMove},f.prototype.onDragEnter=function(e){var t=this.getDropType(e);this.currentDropListener=this.dropListeners[t],this.currentDropListener.onDragEnter(e)},f.prototype.onDragLeave=function(e){this.currentDropListener.onDragLeave(e)},f.prototype.onDragging=function(e){this.currentDropListener.onDragging(e)},f.prototype.onDragStop=function(e){this.currentDropListener.onDragStop(e)},n([l.Autowired("context"),o("design:type",l.Context)],f.prototype,"context",void 0),n([l.Autowired("dragAndDropService"),o("design:type",s.DragAndDropService)],f.prototype,"dragAndDropService",void 0),n([l.Autowired("columnController"),o("design:type",h.ColumnController)],f.prototype,"columnController",void 0),n([l.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],f.prototype,"init",null),f);function f(e,t){this.dropListeners={},this.pinned=e,this.eContainer=t}t.BodyDropTarget=p},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(12),s=i(4),l=i(10),v=i(1),h=i(15),c=i(2),u=(d.prototype.registerGridComp=function(e){this.gridPanel=e},d.prototype.init=function(){this.logger=this.loggerFactory.create("MoveColumnController")},d.prototype.getIconName=function(){return this.pinned?h.DragAndDropService.ICON_PINNED:h.DragAndDropService.ICON_MOVE},d.prototype.onDragEnter=function(e){var t=e.dragItem.columns;if(e.dragSource.type===h.DragSourceType.ToolPanel)this.setColumnsVisible(t,!0,"uiColumnDragged");else{var i=e.dragItem.visibleState,n=t.filter(function(e){return i[e.getId()]});this.setColumnsVisible(n,!0,"uiColumnDragged")}this.setColumnsPinned(t,this.pinned,"uiColumnDragged"),this.onDragging(e,!0)},d.prototype.onDragLeave=function(e){if(!this.gridOptionsWrapper.isSuppressDragLeaveHidesColumns()&&!e.fromNudge){var t=e.dragSource.dragItemCallback().columns;this.setColumnsVisible(t,!1,"uiColumnDragged")}this.ensureIntervalCleared()},d.prototype.setColumnsVisible=function(e,t,i){if(void 0===i&&(i="api"),e){var n=e.filter(function(e){return!e.isLockVisible()});this.columnController.setColumnsVisible(n,t,i)}},d.prototype.setColumnsPinned=function(e,t,i){if(void 0===i&&(i="api"),e){var n=e.filter(function(e){return!e.isLockPinned()});this.columnController.setColumnsPinned(n,t,i)}},d.prototype.onDragStop=function(){this.ensureIntervalCleared()},d.prototype.normaliseX=function(e){return this.gridOptionsWrapper.isEnableRtl()&&(e=this.eContainer.clientWidth-e),this.centerContainer&&(e+=this.gridPanel.getBodyViewportScrollLeft()),e},d.prototype.checkCenterForScrolling=function(e){if(this.centerContainer){var t=this.gridPanel.getBodyViewportScrollLeft(),i=t+this.gridPanel.getCenterWidth();this.gridOptionsWrapper.isEnableRtl()?(this.needToMoveRight=e<t+50,this.needToMoveLeft=i-50<e):(this.needToMoveLeft=e<t+50,this.needToMoveRight=i-50<e),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}},d.prototype.onDragging=function(e,t){var i=this;if(void 0===t&&(t=!1),this.lastDraggingEvent=e,!v.Utils.missing(e.hDirection)){var n=this.normaliseX(e.x);t||this.checkCenterForScrolling(n);var o=this.normaliseDirection(e.hDirection),r=e.dragSource.type,a=e.dragSource.dragItemCallback().columns;a=a.filter(function(e){return!e.isLockPinned()||e.getPinned()==i.pinned}),this.attemptMoveColumns(r,a,o,n,t)}},d.prototype.normaliseDirection=function(e){if(!this.gridOptionsWrapper.isEnableRtl())return e;switch(e){case h.HDirection.Left:return h.HDirection.Right;case h.HDirection.Right:return h.HDirection.Left;default:console.error("ag-Grid: Unknown direction "+e)}},d.prototype.calculateOldIndex=function(e){var t=this.columnController.getAllGridColumns(),i=[];e.forEach(function(e){return i.push(t.indexOf(e))}),v.Utils.sortNumberArray(i);var n=i[0];return i[i.length-1]-n!=i.length-1?null:n},d.prototype.attemptMoveColumns=function(e,t,i,n,o){for(var r=i===h.HDirection.Left,a=i===h.HDirection.Right,s=this.calculateValidMoves(t,a,n),l=this.calculateOldIndex(t),c=0;c<s.length;c++){var u=s[c],d=null!==l&&!o;if(e==h.DragSourceType.HeaderCell&&(d=null!==l),d){if(r&&l<=u)continue;if(a&&u<=l)continue}if(this.columnController.doesMovePassRules(t,u))return void this.columnController.moveColumns(t,u,"uiColumnDragged")}},d.prototype.calculateValidMoves=function(t,e,i){function n(e){return t.indexOf(e)<0}var o,r=this.columnController.getDisplayedColumns(this.pinned),a=this.columnController.getAllGridColumns(),s=r.filter(function(e){return 0<=t.indexOf(e)}),l=r.filter(n),c=a.filter(n),u=0,d=i;if(e){var h=0;s.forEach(function(e){return h+=e.getActualWidth()}),d-=h}for(var p=0;p<l.length&&!((d-=l[p].getActualWidth())<0);p++)u++;if(e&&u++,0<u){var f=l[u-1];o=c.indexOf(f)+1}else o=0;for(var g=[o],m=a[o];v.Utils.exists(m)&&this.isColumnHidden(r,m);)o++,g.push(o),m=a[o];return g},d.prototype.isColumnHidden=function(e,t){return e.indexOf(t)<0},d.prototype.ensureIntervalStarted=function(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=setInterval(this.moveInterval.bind(this),100),this.needToMoveLeft?this.dragAndDropService.setGhostIcon(h.DragAndDropService.ICON_LEFT,!0):this.dragAndDropService.setGhostIcon(h.DragAndDropService.ICON_RIGHT,!0))},d.prototype.ensureIntervalCleared=function(){this.moveInterval&&(clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.dragAndDropService.setGhostIcon(h.DragAndDropService.ICON_MOVE))},d.prototype.moveInterval=function(){var e,t;if(this.intervalCount++,100<(e=10+5*this.intervalCount)&&(e=100),this.needToMoveLeft?t=this.gridPanel.scrollHorizontally(-e):this.needToMoveRight&&(t=this.gridPanel.scrollHorizontally(e)),0!==t)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;var i=this.lastDraggingEvent.dragItem.columns.filter(function(e){return!e.isLockPinned()});if(0<i.length&&(this.dragAndDropService.setGhostIcon(h.DragAndDropService.ICON_PINNED),7<this.failedMoveAttempts)){var n=this.needToMoveLeft?l.Column.PINNED_LEFT:l.Column.PINNED_RIGHT;this.setColumnsPinned(i,n,"uiColumnDragged"),this.dragAndDropService.nudge()}}},n([r.Autowired("loggerFactory"),o("design:type",a.LoggerFactory)],d.prototype,"loggerFactory",void 0),n([r.Autowired("columnController"),o("design:type",s.ColumnController)],d.prototype,"columnController",void 0),n([r.Autowired("dragAndDropService"),o("design:type",h.DragAndDropService)],d.prototype,"dragAndDropService",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",c.GridOptionsWrapper)],d.prototype,"gridOptionsWrapper",void 0),n([r.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],d.prototype,"init",null),d);function d(e,t){this.needToMoveLeft=!1,this.needToMoveRight=!1,this.pinned=e,this.eContainer=t,this.centerContainer=!v.Utils.exists(e)}t.MoveColumnController=u},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(15),a=i(4),s=i(0),l=i(2),c=(u.prototype.onDragEnter=function(e){var t=this;this.clearColumnsList(),this.gridOptionsWrapper.isFunctionsReadOnly()||e.dragItem.columns.forEach(function(e){e.isPrimary()&&(e.isAnyFunctionActive()||(e.isAllowValue()?t.columnsToAggregate.push(e):e.isAllowRowGroup()?t.columnsToGroup.push(e):e.isAllowRowGroup()&&t.columnsToPivot.push(e)))})},u.prototype.getIconName=function(){return 0<this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length?this.pinned?r.DragAndDropService.ICON_PINNED:r.DragAndDropService.ICON_MOVE:null},u.prototype.onDragLeave=function(e){this.clearColumnsList()},u.prototype.clearColumnsList=function(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0},u.prototype.onDragging=function(e){},u.prototype.onDragStop=function(e){0<this.columnsToAggregate.length&&this.columnController.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),0<this.columnsToGroup.length&&this.columnController.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),0<this.columnsToPivot.length&&this.columnController.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")},n([s.Autowired("columnController"),o("design:type",a.ColumnController)],u.prototype,"columnController",void 0),n([s.Autowired("gridOptionsWrapper"),o("design:type",l.GridOptionsWrapper)],u.prototype,"gridOptionsWrapper",void 0),u);function u(e){this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=e}t.BodyDropPivotTarget=c},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var a,r=i(0),s=i(10),l=i(2),c=i(1),u=i(4),d=i(38),h=((a=p).prototype.createAutoGroupColumns=function(e){var i=this,n=[],t=this.gridOptionsWrapper.isTreeData(),o=this.gridOptionsWrapper.isGroupMultiAutoColumn();return t&&o&&(console.log("ag-Grid: you cannot mix groupMultiAutoColumn with treeData, only one column can be used to display groups when doing tree data"),o=!1),o?e.forEach(function(e,t){n.push(i.createOneAutoGroupColumn(e,t))}):n.push(this.createOneAutoGroupColumn(null)),n},p.prototype.createOneAutoGroupColumn=function(e,t){var i,n=this.generateDefaultColDef(e);i=e?a.GROUP_AUTO_COLUMN_ID+"-"+e.getId():a.GROUP_AUTO_COLUMN_BUNDLE_ID;var o=this.gridOptionsWrapper.getAutoGroupColumnDef();c._.mergeDeep(n,o),(n=this.balancedColumnTreeBuilder.mergeColDefs(n)).colId=i,this.gridOptionsWrapper.isTreeData()||c._.missing(n.field)&&c._.missing(n.valueGetter)&&c._.missing(n.filterValueGetter)&&(n.suppressFilter=!0),0<t&&(n.headerCheckboxSelection=!1);var r=new s.Column(n,i,!0);return this.context.wireBean(r),r},p.prototype.generateDefaultColDef=function(e){var t={headerName:this.gridOptionsWrapper.getLocaleTextFunc()("group","Group"),cellRenderer:"agGroupCellRenderer"};if(e){var i=e.getColDef();c._.assign(t,{headerName:this.columnController.getDisplayNameForColumn(e,"header"),headerValueGetter:i.headerValueGetter}),i.cellRenderer&&c._.assign(t,{cellRendererParams:{innerRenderer:i.cellRenderer,innerRendererParams:i.cellRendererParams}}),t.showRowGroup=e.getColId()}else t.showRowGroup=!0;return t},p.GROUP_AUTO_COLUMN_ID="ag-Grid-AutoColumn",p.GROUP_AUTO_COLUMN_BUNDLE_ID=a.GROUP_AUTO_COLUMN_ID,n([r.Autowired("gridOptionsWrapper"),o("design:type",l.GridOptionsWrapper)],p.prototype,"gridOptionsWrapper",void 0),n([r.Autowired("context"),o("design:type",r.Context)],p.prototype,"context",void 0),n([r.Autowired("columnController"),o("design:type",u.ColumnController)],p.prototype,"columnController",void 0),n([r.Autowired("balancedColumnTreeBuilder"),o("design:type",d.BalancedColumnTreeBuilder)],p.prototype,"balancedColumnTreeBuilder",void 0),p=a=n([r.Bean("autoGroupColService")],p));function p(){}t.AutoGroupColService=h},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(9),l=i(1),s=i(2),c=(u.prototype.postConstruct=function(){this.rowModel.getType()===a.Constants.ROW_MODEL_TYPE_CLIENT_SIDE&&(this.clientSideRowModel=this.rowModel)},u.prototype.createTransactionForRowData=function(e){if(l._.missing(this.clientSideRowModel))console.error("ag-Grid: ImmutableService only works with ClientSideRowModel");else{var o=this.gridOptionsWrapper.getRowNodeIdFunc();if(!l._.missing(o)){var r={remove:[],update:[],add:[]},a=this.clientSideRowModel.getCopyOfNodesMap(),s={};return l._.exists(e)&&e.forEach(function(e,t){var i=o(e),n=a[i];s[i]=t,n?(n.data!==e&&r.update.push(e),a[i]=void 0):r.add.push(e)}),l._.iterateObject(a,function(e,t){t&&r.remove.push(t.data)}),[r,s]}console.error("ag-Grid: ImmutableService requires getRowNodeId() callback to be implemented, your row data need IDs!")}},n([r.Autowired("rowModel"),o("design:type",Object)],u.prototype,"rowModel",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",s.GridOptionsWrapper)],u.prototype,"gridOptionsWrapper",void 0),n([r.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],u.prototype,"postConstruct",null),u=n([r.Bean("immutableService")],u));function u(){}t.ImmutableService=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o.STRING_PROPERTIES=["headerName","columnGroupShow","headerClass","toolPanelClass","headerValueGetter","pivotKeys","groupId","colId","sort","field","type","tooltipField","headerTooltip","cellClass","showRowGroup","template","templateUrl","filter","aggFunc","cellRenderer","cellEditor","pinned"],o.OBJECT_PROPERTIES=["headerGroupComponent","headerGroupComponentFramework","headerGroupComponentParams","cellStyle","cellRendererParams","cellEditorFramework","cellEditorParams","pinnedRowCellRendererFramework","pinnedRowCellRendererParams","filterFramework","filterParams","pivotValueColumn","headerComponent","headerComponentFramework","headerComponentParams","floatingFilterComponent","floatingFilterComponentParams","floatingFilterComponentFramework","refData"],o.ARRAY_PROPERTIES=["children","sortingOrder","allowedAggFuncs","menuTabs","pivotTotalColumnIds","cellClassRules","icons"],o.NUMBER_PROPERTIES=["sortedAt","width","minWidth","maxWidth","rowGroupIndex","pivotIndex"],o.BOOLEAN_PROPERTIES=["suppressCellFlash","suppressToolPanel","openByDefault","marryChildren","hide","rowGroup","pivot","checkboxSelection","headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","suppressMenu","suppressSorting","suppressMovable","suppressFilter","lockPosition","lockVisible","lockPinned","unSortIcon","suppressSizeToFit","suppressResize","suppressAutoSize","enableRowGroup","enablePivot","enableValue","editable","suppressPaste","suppressNavigable","enableCellChangeFlash","rowDrag","autoHeight"],o.FUNCTION_PROPERTIES=["valueGetter","valueSetter","filterValueGetter","keyCreator","cellRenderer","cellRendererFramework","pinnedRowCellRenderer","valueFormatter","pinnedRowValueFormatter","valueParser","comparator","equals","pivotComparator","suppressKeyboardEvent","colSpan","rowSpan","getQuickFilterText","newValueHandler","onCellValueChanged","onCellClicked","onCellDoubleClicked","onCellContextMenu","tooltip","cellRendererSelector","cellEditorSelector"],o.ALL_PROPERTIES=o.ARRAY_PROPERTIES.concat(o.OBJECT_PROPERTIES).concat(o.STRING_PROPERTIES).concat(o.NUMBER_PROPERTIES).concat(o.FUNCTION_PROPERTIES).concat(o.BOOLEAN_PROPERTIES),o);function o(){}t.ColDefUtil=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(1),n=(r.prototype.getUniqueKey=function(e,t){e=o.Utils.toStringOrNull(e);for(var i=0;;){var n=void 0;if(e?(n=e,0!==i&&(n+="_"+i)):t?(n=t,0!==i&&(n+="_"+i)):n=""+i,this.existingKeys.indexOf(n)<0)return this.existingKeys.push(n),n;i++}},r);function r(){this.existingKeys=[]}t.ColumnKeyCreator=n},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(18),s=i(1),l=i(35),c=i(2),u=i(3),d=(h.prototype.hideActiveMenu=function(){this.hidePopup&&this.hidePopup()},h.prototype.showMenuAfterMouseEvent=function(t,i){var n=this;this.showPopup(t,function(e){n.popupService.positionPopupUnderMouseEvent({column:t,type:"columnMenu",mouseEvent:i,ePopup:e})})},h.prototype.showMenuAfterButtonClick=function(t,i){var n=this;this.showPopup(t,function(e){n.popupService.positionPopupUnderComponent({type:"columnMenu",eventSource:i,ePopup:e,keepWithinBounds:!0,column:t})})},h.prototype.showPopup=function(e,t){var i,n=this,o=this.filterManager.getOrCreateFilterWrapper(e),r=document.createElement("div");function a(e){"horizontal"===e.direction&&i()}s.Utils.addCssClass(r,"ag-menu"),o.guiPromise.promise.then(function(e){r.appendChild(e)}),this.eventService.addEventListener("bodyScroll",a),i=this.popupService.addAsModalPopup(r,!0,function(){n.eventService.removeEventListener("bodyScroll",a),e.setMenuVisible(!1,"contextMenu")}),t(r),o.filterPromise.then(function(e){if(e.afterGuiAttached){var t={hidePopup:i};e.afterGuiAttached(t)}}),this.hidePopup=i,e.setMenuVisible(!0,"contextMenu")},h.prototype.isMenuEnabled=function(e){return this.gridOptionsWrapper.isEnableFilter()&&e.isFilterAllowed()},n([r.Autowired("eventService"),o("design:type",u.EventService)],h.prototype,"eventService",void 0),n([r.Autowired("filterManager"),o("design:type",a.FilterManager)],h.prototype,"filterManager",void 0),n([r.Autowired("popupService"),o("design:type",l.PopupService)],h.prototype,"popupService",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",c.GridOptionsWrapper)],h.prototype,"gridOptionsWrapper",void 0),h=n([r.Bean("menuFactory")],h));function h(){}t.StandardMenuFactory=d},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(2),s=i(110),l=i(86),c=(u.prototype.execute=function(e){var t=e.rowNode;this.gridOptionsWrapper.isEnableServerSideFilter()?this.filterService.filter(t,!1):this.filterService.filterAccordingToColumnState(t),this.selectableService.updateSelectableAfterFiltering(t)},n([r.Autowired("gridOptionsWrapper"),o("design:type",a.GridOptionsWrapper)],u.prototype,"gridOptionsWrapper",void 0),n([r.Autowired("selectableService"),o("design:type",l.SelectableService)],u.prototype,"selectableService",void 0),n([r.Autowired("filterService"),o("design:type",s.FilterService)],u.prototype,"filterService",void 0),u=n([r.Bean("filterStage")],u));function u(){}t.FilterStage=c},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(18),s=i(2),l=(c.prototype.postConstruct=function(){this.doingTreeData=this.gridOptionsWrapper.isTreeData()},c.prototype.filterAccordingToColumnState=function(e){var t=this.filterManager.isAnyFilterPresent();this.filter(e,t)},c.prototype.filter=function(e,t){var n=this;e.hasChildren()?(e.childrenAfterGroup.forEach(function(e){return n.filter(e,t)}),e.childrenAfterFilter=t?e.childrenAfterGroup.filter(function(e){var t=e.childrenAfterFilter&&0<e.childrenAfterFilter.length,i=e.data&&n.filterManager.doesRowPassFilter(e);return t||i}):e.childrenAfterGroup,this.setAllChildrenCount(e)):(e.childrenAfterFilter=e.childrenAfterGroup,e.setAllChildrenCount(null))},c.prototype.setAllChildrenCountTreeData=function(e){var t=0;e.childrenAfterFilter.forEach(function(e){t++,t+=e.allChildrenCount}),e.setAllChildrenCount(t)},c.prototype.setAllChildrenCountGridGrouping=function(e){var t=0;e.childrenAfterFilter.forEach(function(e){e.group?t+=e.allChildrenCount:t++}),e.setAllChildrenCount(t)},c.prototype.setAllChildrenCount=function(e){this.doingTreeData?this.setAllChildrenCountTreeData(e):this.setAllChildrenCountGridGrouping(e)},n([r.Autowired("filterManager"),o("design:type",a.FilterManager)],c.prototype,"filterManager",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",s.GridOptionsWrapper)],c.prototype,"gridOptionsWrapper",void 0),n([r.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],c.prototype,"postConstruct",null),c=n([r.Bean("filterService")],c));function c(){}t.FilterService=l},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(2),s=i(112),l=(c.prototype.execute=function(e){this.gridOptionsWrapper.isEnableServerSideSorting()?this.sortService.sort(e.rowNode,null):this.sortService.sortAccordingToColumnsState(e.rowNode)},n([r.Autowired("gridOptionsWrapper"),o("design:type",a.GridOptionsWrapper)],c.prototype,"gridOptionsWrapper",void 0),n([r.Autowired("sortService"),o("design:type",s.SortService)],c.prototype,"sortService",void 0),c=n([r.Bean("sortStage")],c));function c(){}t.SortStage=l},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(24),h=i(1),s=i(16),l=i(2),c=i(4),u=(d.prototype.init=function(){this.postSortFunc=this.gridOptionsWrapper.getPostSortFunc()},d.prototype.sortAccordingToColumnsState=function(e){var t=this.sortController.getSortForRowController();this.sort(e,t)},d.prototype.sort=function(e,t){var i=this;if(e.childrenAfterSort=e.childrenAfterFilter.slice(0),this.pullDownDataForHideOpenParents(e,!0),h._.exists(t)&&0<t.length){var n=e.childrenAfterSort.map(function(e,t){return{currentPos:t,rowNode:e}});n.sort(this.compareRowNodes.bind(this,t)),e.childrenAfterSort=n.map(function(e){return e.rowNode})}this.updateChildIndexes(e),this.pullDownDataForHideOpenParents(e,!1),e.childrenAfterFilter.forEach(function(e){e.hasChildren()&&i.sort(e,t)}),this.postSortFunc&&this.postSortFunc(e.childrenAfterSort)},d.prototype.compareRowNodes=function(e,t,i){for(var n=t.rowNode,o=i.rowNode,r=0,a=e.length;r<a;r++){var s=e[r],l=-1===s.inverter,c=this.getValue(n,s.column),u=this.getValue(o,s.column),d=void 0;if(0!==(d=s.column.getColDef().comparator?s.column.getColDef().comparator(c,u,n,o,l):h._.defaultComparator(c,u,this.gridOptionsWrapper.isAccentedSort())))return d*s.inverter}return t.currentPos-i.currentPos},d.prototype.getValue=function(e,t){return this.valueService.getValue(t,e)},d.prototype.updateChildIndexes=function(o){h._.missing(o.childrenAfterSort)||o.childrenAfterSort.forEach(function(e,t){var i=0===t,n=t===o.childrenAfterSort.length-1;e.setFirstChild(i),e.setLastChild(n),e.setChildIndex(t)})},d.prototype.pullDownDataForHideOpenParents=function(e,a){var s=this;h._.missing(e.childrenAfterSort)||this.gridOptionsWrapper.isGroupHideOpenParents()&&e.childrenAfterSort.forEach(function(r){s.columnController.getGroupDisplayColumns().forEach(function(e){var t=e.getColDef().showRowGroup;if("string"==typeof t){var i=t,n=s.columnController.getPrimaryColumn(i);if(n!==r.rowGroupColumn)if(a)r.setGroupValue(e.getId(),null);else{var o=r.getFirstChildOfFirstChild(n);o&&r.setGroupValue(e.getId(),o.key)}}else console.error("ag-Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup")})})},n([r.Autowired("sortController"),o("design:type",a.SortController)],d.prototype,"sortController",void 0),n([r.Autowired("columnController"),o("design:type",c.ColumnController)],d.prototype,"columnController",void 0),n([r.Autowired("valueService"),o("design:type",s.ValueService)],d.prototype,"valueService",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",l.GridOptionsWrapper)],d.prototype,"gridOptionsWrapper",void 0),n([r.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],d.prototype,"init",null),d=n([r.Bean("sortService")],d));function d(){}t.SortService=u},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(14),C=i(1),s=i(2),l=i(17),c=i(3),u=i(4),d=(h.prototype.execute=function(e){var t=e.rowNode,i=[],n={value:0},o=this.columnController.isPivotMode(),r=o&&t.leafGroup,a=r?[t]:t.childrenAfterSort;return this.resetRowTops(t),this.recursivelyAddToRowsToDisplay(a,i,n,o,0),!r&&this.gridOptionsWrapper.isGroupIncludeTotalFooter()&&(this.ensureFooterNodeExists(t),this.addRowNodeToRowsToDisplay(t.sibling,i,n,0)),i},h.prototype.resetRowTops=function(e){if(e.clearRowTop(),e.hasChildren()){if(e.childrenAfterGroup)for(var t=0;t<e.childrenAfterGroup.length;t++)this.resetRowTops(e.childrenAfterGroup[t]);e.sibling&&e.sibling.clearRowTop()}},h.prototype.recursivelyAddToRowsToDisplay=function(e,t,i,n,o){if(!C.Utils.missingOrEmpty(e))for(var r=this.gridOptionsWrapper.isGroupSuppressRow(),a=this.gridOptionsWrapper.isGroupHideOpenParents(),s=this.gridOptionsWrapper.isGroupRemoveSingleChildren(),l=!s&&this.gridOptionsWrapper.isGroupRemoveLowestSingleChildren(),c=0;c<e.length;c++){var u=e[c],d=u.hasChildren(),h=r&&d,p=n&&!d,f=s&&d&&1===u.childrenAfterGroup.length,g=l&&d&&u.leafGroup&&1===u.childrenAfterGroup.length,m=n&&u.leafGroup,v=a&&u.expanded&&!m;if(p||h||v||f||g||this.addRowNodeToRowsToDisplay(u,t,i,o),!n||!u.leafGroup)if(d){var y=f||g;if(u.expanded||y){var b=y?o:o+1;this.recursivelyAddToRowsToDisplay(u.childrenAfterSort,t,i,n,b),this.gridOptionsWrapper.isGroupIncludeFooter()&&(this.ensureFooterNodeExists(u),this.addRowNodeToRowsToDisplay(u.sibling,t,i,o))}}else if(u.master&&u.expanded){var w=this.createDetailNode(u);this.addRowNodeToRowsToDisplay(w,t,i,o)}}},h.prototype.addRowNodeToRowsToDisplay=function(e,t,i,n){if(t.push(e),C.Utils.missing(e.rowHeight)){var o=this.gridOptionsWrapper.getRowHeightForNode(e);e.setRowHeight(o)}e.setUiLevel(n),e.setRowTop(i.value),e.setRowIndex(t.length-1),i.value+=e.rowHeight},h.prototype.ensureFooterNodeExists=function(t){if(!C.Utils.exists(t.sibling)){var i=new a.RowNode;this.context.wireBean(i),Object.keys(t).forEach(function(e){i[e]=t[e]}),i.footer=!0,i.rowTop=null,i.oldRowTop=null,C.Utils.exists(i.id)&&(i.id="rowGroupFooter_"+i.id),(i.sibling=t).sibling=i}},h.prototype.createDetailNode=function(e){if(C.Utils.exists(e.detailNode))return e.detailNode;var t=new a.RowNode;return this.context.wireBean(t),t.detail=!0,t.flower=t.detail,t.parent=e,C.Utils.exists(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1,e.detailNode=t,e.childFlower=e.detailNode,t},n([r.Autowired("gridOptionsWrapper"),o("design:type",s.GridOptionsWrapper)],h.prototype,"gridOptionsWrapper",void 0),n([r.Autowired("selectionController"),o("design:type",l.SelectionController)],h.prototype,"selectionController",void 0),n([r.Autowired("eventService"),o("design:type",c.EventService)],h.prototype,"eventService",void 0),n([r.Autowired("context"),o("design:type",r.Context)],h.prototype,"context",void 0),n([r.Autowired("columnController"),o("design:type",u.ColumnController)],h.prototype,"columnController",void 0),h=n([r.Bean("flattenStage")],h));function h(){}t.FlattenStage=d},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(1),c=i(2),u=i(0),d=i(3),h=i(17),p=i(5),f=i(24),g=i(18),m=i(9),v=i(136),y=i(13),b=i(87),w=i(115),C=i(6),_=i(7),A=(s=y.BeanStub,o(E,s),E.prototype.getRowBounds=function(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}},E.prototype.init=function(){var e=this;this.gridOptionsWrapper.isRowModelInfinite()&&(this.rowHeight=this.gridOptionsWrapper.getRowHeightAsNumber(),this.addEventListeners(),this.setDatasource(this.gridOptionsWrapper.getDatasource()),this.addDestroyFunc(function(){return e.destroyCache()}))},E.prototype.destroyDatasource=function(){this.datasource&&this.datasource.destroy&&this.datasource.destroy(),this.datasource=null},E.prototype.isLastRowFound=function(){return!!this.infiniteCache&&this.infiniteCache.isMaxRowFound()},E.prototype.addEventListeners=function(){this.addDestroyableEventListener(this.eventService,p.Events.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addDestroyableEventListener(this.eventService,p.Events.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addDestroyableEventListener(this.eventService,p.Events.EVENT_COLUMN_EVERYTHING_CHANGED,this.onColumnEverything.bind(this))},E.prototype.onFilterChanged=function(){this.gridOptionsWrapper.isEnableServerSideFilter()&&this.reset()},E.prototype.onSortChanged=function(){this.gridOptionsWrapper.isEnableServerSideSorting()&&this.reset()},E.prototype.onColumnEverything=function(){this.gridOptionsWrapper.isEnableServerSideSorting()&&this.reset()},E.prototype.destroy=function(){s.prototype.destroy.call(this)},E.prototype.getType=function(){return m.Constants.ROW_MODEL_TYPE_INFINITE},E.prototype.setDatasource=function(e){this.destroyDatasource(),(this.datasource=e)&&(this.checkForDeprecated(),this.reset())},E.prototype.checkForDeprecated=function(){var e=this.datasource;l.Utils.exists(e.maxConcurrentRequests)&&console.error("ag-Grid: since version 5.1.x, maxConcurrentRequests is replaced with grid property maxConcurrentDatasourceRequests"),l.Utils.exists(e.maxPagesInCache)&&console.error("ag-Grid: since version 5.1.x, maxPagesInCache is replaced with grid property maxPagesInPaginationCache"),l.Utils.exists(e.overflowSize)&&console.error("ag-Grid: since version 5.1.x, overflowSize is replaced with grid property paginationOverflowSize"),l.Utils.exists(e.blockSize)&&console.error("ag-Grid: since version 5.1.x, pageSize/blockSize is replaced with grid property infinitePageSize")},E.prototype.isEmpty=function(){return l.Utils.missing(this.infiniteCache)},E.prototype.isRowsToRender=function(){return l.Utils.exists(this.infiniteCache)},E.prototype.getNodesInRangeForSelection=function(e,t){return this.infiniteCache.getRowNodesInRange(e,t)},E.prototype.reset=function(){if(!l.Utils.missing(this.datasource)){l.Utils.exists(this.gridOptionsWrapper.getRowNodeIdFunc())||this.selectionController.reset(),this.resetCache();var e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}},E.prototype.createModelUpdatedEvent=function(){return{type:p.Events.EVENT_MODEL_UPDATED,api:this.gridApi,columnApi:this.columnApi,newPage:!1,newData:!1,keepRenderedRows:!1,animate:!1}},E.prototype.resetCache=function(){this.destroyCache();var e=this.gridOptionsWrapper.getMaxConcurrentDatasourceRequests();this.rowNodeBlockLoader=new w.RowNodeBlockLoader(e),this.context.wireBean(this.rowNodeBlockLoader);var t={datasource:this.datasource,filterModel:this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,maxConcurrentRequests:e,overflowSize:this.gridOptionsWrapper.getCacheOverflowSize(),initialRowCount:this.gridOptionsWrapper.getInfiniteInitialRowCount(),maxBlocksInCache:this.gridOptionsWrapper.getMaxBlocksInCache(),blockSize:this.gridOptionsWrapper.getCacheBlockSize(),rowHeight:this.gridOptionsWrapper.getRowHeightAsNumber(),lastAccessedSequence:new l.NumberSequence};1<=t.maxConcurrentRequests||(t.maxConcurrentRequests=2),1<=t.blockSize||(t.blockSize=100),1<=t.initialRowCount||(t.initialRowCount=0),1<=t.overflowSize||(t.overflowSize=1),this.infiniteCache=new v.InfiniteCache(t),this.context.wireBean(this.infiniteCache),this.infiniteCache.addEventListener(b.RowNodeCache.EVENT_CACHE_UPDATED,this.onCacheUpdated.bind(this))},E.prototype.destroyCache=function(){this.infiniteCache&&(this.infiniteCache.destroy(),this.infiniteCache=null),this.rowNodeBlockLoader&&(this.rowNodeBlockLoader.destroy(),this.rowNodeBlockLoader=null)},E.prototype.onCacheUpdated=function(){var e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)},E.prototype.getRow=function(e){return this.infiniteCache?this.infiniteCache.getRow(e):null},E.prototype.getRowNode=function(t){var i=null;return this.forEachNode(function(e){e.id===t&&(i=e)}),i},E.prototype.forEachNode=function(e){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(e,new l.NumberSequence)},E.prototype.getCurrentPageHeight=function(){return this.getRowCount()*this.rowHeight},E.prototype.getRowIndexAtPixel=function(e){if(0===this.rowHeight)return 0;var t=Math.floor(e/this.rowHeight);return t>this.getPageLastRow()?this.getPageLastRow():t},E.prototype.getPageFirstRow=function(){return 0},E.prototype.getPageLastRow=function(){return this.infiniteCache?this.infiniteCache.getVirtualRowCount()-1:0},E.prototype.getRowCount=function(){return this.infiniteCache?this.infiniteCache.getVirtualRowCount():0},E.prototype.updateRowData=function(e){l.Utils.exists(e.remove)||l.Utils.exists(e.update)?console.warn("ag-Grid: updateRowData for InfiniteRowModel does not support remove or update, only add"):l.Utils.missing(e.addIndex)?console.warn("ag-Grid: updateRowData for InfiniteRowModel requires add and addIndex to be set"):this.infiniteCache&&this.infiniteCache.insertItemsAtIndex(e.addIndex,e.add)},E.prototype.isRowPresent=function(e){return!1},E.prototype.refreshCache=function(){this.infiniteCache&&this.infiniteCache.refreshCache()},E.prototype.purgeCache=function(){this.infiniteCache&&this.infiniteCache.purgeCache()},E.prototype.getVirtualRowCount=function(){return this.infiniteCache?this.infiniteCache.getVirtualRowCount():null},E.prototype.isMaxRowFound=function(){if(this.infiniteCache)return this.infiniteCache.isMaxRowFound()},E.prototype.setVirtualRowCount=function(e,t){this.infiniteCache&&this.infiniteCache.setVirtualRowCount(e,t)},E.prototype.getBlockState=function(){return this.rowNodeBlockLoader?this.rowNodeBlockLoader.getBlockState():null},r([u.Autowired("gridOptionsWrapper"),a("design:type",c.GridOptionsWrapper)],E.prototype,"gridOptionsWrapper",void 0),r([u.Autowired("filterManager"),a("design:type",g.FilterManager)],E.prototype,"filterManager",void 0),r([u.Autowired("sortController"),a("design:type",f.SortController)],E.prototype,"sortController",void 0),r([u.Autowired("selectionController"),a("design:type",h.SelectionController)],E.prototype,"selectionController",void 0),r([u.Autowired("eventService"),a("design:type",d.EventService)],E.prototype,"eventService",void 0),r([u.Autowired("context"),a("design:type",u.Context)],E.prototype,"context",void 0),r([u.Autowired("gridApi"),a("design:type",C.GridApi)],E.prototype,"gridApi",void 0),r([u.Autowired("columnApi"),a("design:type",_.ColumnApi)],E.prototype,"columnApi",void 0),r([u.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],E.prototype,"init",null),r([u.PreDestroy,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],E.prototype,"destroyDatasource",null),r([u.PreDestroy,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],E.prototype,"destroy",null),E=r([u.Bean("rowModel")],E));function E(){return null!==s&&s.apply(this,arguments)||this}t.InfiniteRowModel=A},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(i,n){return function(e,t){n(e,t,i)}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(61),s=i(12),l=i(0),c=i(1),u=(d.prototype.setBeans=function(e){this.logger=e.create("RowNodeBlockLoader")},d.prototype.addBlock=function(e){this.blocks.push(e)},d.prototype.removeBlock=function(e){c._.removeFromArray(this.blocks,e)},d.prototype.destroy=function(){this.active=!1},d.prototype.loadComplete=function(){this.activeBlockLoadsCount--},d.prototype.checkBlockToLoad=function(){if(this.active)if(this.printCacheStatus(),this.activeBlockLoadsCount>=this.maxConcurrentRequests)this.logger.log("checkBlockToLoad: max loads exceeded");else{var t=null;this.blocks.forEach(function(e){e.getState()===a.RowNodeBlock.STATE_DIRTY&&(t=e)}),t?(t.load(),this.activeBlockLoadsCount++,this.logger.log("checkBlockToLoad: loading page "+t.getBlockNumber()),this.printCacheStatus()):this.logger.log("checkBlockToLoad: no pages to load")}},d.prototype.getBlockState=function(){var n={};return this.blocks.forEach(function(e){var t=e.getNodeIdPrefix(),i={blockNumber:e.getBlockNumber(),startRow:e.getStartRow(),endRow:e.getEndRow(),pageStatus:e.getState()};c._.exists(t)?n[t+e.getBlockNumber()]=i:n[e.getBlockNumber()]=i}),n},d.prototype.printCacheStatus=function(){this.logger.isLogging()&&this.logger.log("printCacheStatus: activePageLoadsCount = "+this.activeBlockLoadsCount+", blocks = "+JSON.stringify(this.getBlockState()))},n([r(0,l.Qualifier("loggerFactory")),o("design:type",Function),o("design:paramtypes",[s.LoggerFactory]),o("design:returntype",void 0)],d.prototype,"setBeans",null),d);function d(e){this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0,this.maxConcurrentRequests=e}t.RowNodeBlockLoader=u},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,r,a=i(1),l=i(9),c=i(2),u=i(7),d=i(4),h=i(18),p=i(14),f=i(3),g=i(5),m=i(0),v=i(17),y=i(88),b=i(89),w=i(16),C=i(33),_=i(6);(r=s=s||{})[r.Normal=0]="Normal",r[r.AfterFilter=1]="AfterFilter",r[r.AfterFilterAndSort=2]="AfterFilterAndSort",r[r.PivotNodes=3]="PivotNodes";var A=(E.prototype.init=function(){var e=this.refreshModel.bind(this,{step:l.Constants.STEP_EVERYTHING});this.eventService.addModalPriorityEventListener(g.Events.EVENT_COLUMN_EVERYTHING_CHANGED,e),this.eventService.addModalPriorityEventListener(g.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.eventService.addModalPriorityEventListener(g.Events.EVENT_COLUMN_VALUE_CHANGED,this.onValueChanged.bind(this)),this.eventService.addModalPriorityEventListener(g.Events.EVENT_COLUMN_PIVOT_CHANGED,this.refreshModel.bind(this,{step:l.Constants.STEP_PIVOT})),this.eventService.addModalPriorityEventListener(g.Events.EVENT_ROW_GROUP_OPENED,this.onRowGroupOpened.bind(this)),this.eventService.addModalPriorityEventListener(g.Events.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.eventService.addModalPriorityEventListener(g.Events.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.eventService.addModalPriorityEventListener(g.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,e);var t=this.refreshModel.bind(this,{step:l.Constants.STEP_MAP,keepRenderedRows:!0,animate:!0});this.gridOptionsWrapper.addEventListener(c.GridOptionsWrapper.PROP_GROUP_REMOVE_SINGLE_CHILDREN,t),this.gridOptionsWrapper.addEventListener(c.GridOptionsWrapper.PROP_GROUP_REMOVE_LOWEST_SINGLE_CHILDREN,t),this.rootNode=new p.RowNode,this.nodeManager=new y.ClientSideNodeManager(this.rootNode,this.gridOptionsWrapper,this.context,this.eventService,this.columnController),this.context.wireBean(this.rootNode)},E.prototype.ensureRowAtPixel=function(e,t){var i=this.getRowIndexAtPixel(t);return this.getRow(i)!==e&&(a.Utils.removeFromArray(this.rootNode.allLeafChildren,e),a.Utils.insertIntoArray(this.rootNode.allLeafChildren,e,i),this.refreshModel({step:l.Constants.STEP_EVERYTHING,keepRenderedRows:!0,animate:!0,keepEditingRows:!0}),!0)},E.prototype.isLastRowFound=function(){return!0},E.prototype.getRowCount=function(){return this.rowsToDisplay?this.rowsToDisplay.length:0},E.prototype.getRowBounds=function(e){if(a.Utils.missing(this.rowsToDisplay))return null;var t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null},E.prototype.onRowGroupOpened=function(){var e=this.gridOptionsWrapper.isAnimateRows();this.refreshModel({step:l.Constants.STEP_MAP,keepRenderedRows:!0,animate:e})},E.prototype.onFilterChanged=function(){var e=this.gridOptionsWrapper.isAnimateRows();this.refreshModel({step:l.Constants.STEP_FILTER,keepRenderedRows:!0,animate:e})},E.prototype.onSortChanged=function(){if(!this.gridOptionsWrapper.isEnableServerSideSorting()){var e=this.gridOptionsWrapper.isAnimateRows();this.refreshModel({step:l.Constants.STEP_SORT,keepRenderedRows:!0,animate:e,keepEditingRows:!0})}},E.prototype.getType=function(){return l.Constants.ROW_MODEL_TYPE_CLIENT_SIDE},E.prototype.onValueChanged=function(){this.columnController.isPivotActive()?this.refreshModel({step:l.Constants.STEP_PIVOT}):this.refreshModel({step:l.Constants.STEP_AGGREGATE})},E.prototype.createChangePath=function(e){var t=this.columnController.getValueColumns(),i=a.Utils.missingOrEmpty(t),n=a.Utils.missingOrEmpty(e),o=new b.ChangedPath(!1);return(i||n)&&o.setInactive(),o},E.prototype.refreshModel=function(e){var t=this,i=this.createChangePath(e.rowNodeTransactions);switch(e.step){case l.Constants.STEP_EVERYTHING:this.doRowGrouping(e.groupState,e.rowNodeTransactions,e.rowNodeOrder,i);case l.Constants.STEP_FILTER:this.doFilter();case l.Constants.STEP_PIVOT:this.doPivot(i);case l.Constants.STEP_AGGREGATE:this.doAggregate(i);case l.Constants.STEP_SORT:this.doSort();case l.Constants.STEP_MAP:this.doRowsToDisplay()}var n={type:g.Events.EVENT_MODEL_UPDATED,api:this.gridApi,columnApi:this.columnApi,animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1};this.eventService.dispatchEvent(n),this.$scope&&setTimeout(function(){t.$scope.$apply()},0)},E.prototype.isEmpty=function(){var e;return e=a.Utils.exists(this.gridOptionsWrapper.getNodeChildDetailsFunc())?a.Utils.missing(this.rootNode.childrenAfterGroup)||0===this.rootNode.childrenAfterGroup.length:a.Utils.missing(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length,a.Utils.missing(this.rootNode)||e||!this.columnController.isReady()},E.prototype.isRowsToRender=function(){return a.Utils.exists(this.rowsToDisplay)&&0<this.rowsToDisplay.length},E.prototype.getNodesInRangeForSelection=function(o,r){var a,s=!r,l=!1,c=[],u=this.gridOptionsWrapper.isGroupSelectsChildren();return this.forEachNodeAfterFilterAndSort(function(e){var t=s&&!l;if(s||e!==r&&e!==o||(s=!0),!e.group||!u){var i=s&&!l,n=e.isParentOfNode(a);(i||n)&&c.push(e)}t&&(e!==r&&e!==o||(l=!0,a=e===r?r:o))}),c},E.prototype.setDatasource=function(e){console.error("ag-Grid: should never call setDatasource on clientSideRowController")},E.prototype.getTopLevelNodes=function(){return this.rootNode?this.rootNode.childrenAfterGroup:null},E.prototype.getRootNode=function(){return this.rootNode},E.prototype.getRow=function(e){return this.rowsToDisplay[e]},E.prototype.isRowPresent=function(e){return 0<=this.rowsToDisplay.indexOf(e)},E.prototype.getVirtualRowCount=function(){return console.warn("ag-Grid: rowModel.getVirtualRowCount() is not longer a function, use rowModel.getRowCount() instead"),this.getPageLastRow()},E.prototype.getPageFirstRow=function(){return 0},E.prototype.getPageLastRow=function(){return this.rowsToDisplay?this.rowsToDisplay.length-1:0},E.prototype.getRowIndexAtPixel=function(e){if(this.isEmpty())return-1;var t=0,i=this.rowsToDisplay.length-1;if(e<=0)return 0;if(this.rowsToDisplay[this.rowsToDisplay.length-1].rowTop<=e)return this.rowsToDisplay.length-1;for(;;){var n=Math.floor((t+i)/2),o=this.rowsToDisplay[n];if(this.isRowInPixel(o,e))return n;o.rowTop<e?t=n+1:o.rowTop>e&&(i=n-1)}},E.prototype.isRowInPixel=function(e,t){var i=e.rowTop,n=e.rowTop+e.rowHeight;return i<=t&&t<n},E.prototype.getCurrentPageHeight=function(){if(this.rowsToDisplay&&0<this.rowsToDisplay.length){var e=this.rowsToDisplay[this.rowsToDisplay.length-1];return e.rowTop+e.rowHeight}return 0},E.prototype.forEachLeafNode=function(i){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach(function(e,t){return i(e,t)})},E.prototype.forEachNode=function(e){this.recursivelyWalkNodesAndCallback(this.rootNode.childrenAfterGroup,e,s.Normal,0)},E.prototype.forEachNodeAfterFilter=function(e){this.recursivelyWalkNodesAndCallback(this.rootNode.childrenAfterFilter,e,s.AfterFilter,0)},E.prototype.forEachNodeAfterFilterAndSort=function(e){this.recursivelyWalkNodesAndCallback(this.rootNode.childrenAfterSort,e,s.AfterFilterAndSort,0)},E.prototype.forEachPivotNode=function(e){this.recursivelyWalkNodesAndCallback([this.rootNode],e,s.PivotNodes,0)},E.prototype.recursivelyWalkNodesAndCallback=function(e,t,i,n){if(e)for(var o=0;o<e.length;o++){var r=e[o];if(t(r,n++),r.hasChildren()){var a=void 0;switch(i){case s.Normal:a=r.childrenAfterGroup;break;case s.AfterFilter:a=r.childrenAfterFilter;break;case s.AfterFilterAndSort:a=r.childrenAfterSort;break;case s.PivotNodes:a=r.leafGroup?null:r.childrenAfterSort}a&&(n=this.recursivelyWalkNodesAndCallback(a,t,i,n))}}return n},E.prototype.doAggregate=function(e){this.aggregationStage&&this.aggregationStage.execute({rowNode:this.rootNode,changedPath:e})},E.prototype.expandOrCollapseAll=function(n){var o=this.gridOptionsWrapper.isTreeData();this.rootNode&&!function i(e){e&&e.forEach(function(e){var t=o?a.Utils.exists(e.childrenAfterGroup):e.group;t&&(e.expanded=n,i(e.childrenAfterGroup))})}(this.rootNode.childrenAfterGroup),this.refreshModel({step:l.Constants.STEP_MAP})},E.prototype.doSort=function(){this.sortStage.execute({rowNode:this.rootNode})},E.prototype.doRowGrouping=function(e,t,i,n){var o=this;a.Utils.exists(this.gridOptionsWrapper.getNodeChildDetailsFunc())||(this.groupStage?(a.Utils.exists(t)?t.forEach(function(e){o.groupStage.execute({rowNode:o.rootNode,rowNodeTransaction:e,rowNodeOrder:i,changedPath:n})}):(this.selectionController.removeGroupsFromSelection(),this.groupStage.execute({rowNode:this.rootNode,changedPath:n}),this.restoreGroupState(e)),this.gridOptionsWrapper.isGroupSelectsChildren()&&this.selectionController.updateGroupsFromChildrenSelections()):this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren)},E.prototype.restoreGroupState=function(i){i&&a.Utils.traverseNodesWithKey(this.rootNode.childrenAfterGroup,function(e,t){"boolean"==typeof i[t]&&(e.expanded=i[t])})},E.prototype.doFilter=function(){this.filterStage.execute({rowNode:this.rootNode})},E.prototype.doPivot=function(e){this.pivotStage&&this.pivotStage.execute({rowNode:this.rootNode,changedPath:e})},E.prototype.getGroupState=function(){if(!this.rootNode.childrenAfterGroup||!this.gridOptionsWrapper.isRememberGroupStateWhenNewData())return null;var i={};return a.Utils.traverseNodesWithKey(this.rootNode.childrenAfterGroup,function(e,t){return i[t]=e.expanded}),i},E.prototype.getCopyOfNodesMap=function(){return this.nodeManager.getCopyOfNodesMap()},E.prototype.getRowNode=function(e){return this.nodeManager.getRowNode(e)},E.prototype.setRowData=function(e){var t=this.getGroupState();this.nodeManager.setRowData(e);var i={type:g.Events.EVENT_ROW_DATA_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(i),this.refreshModel({step:l.Constants.STEP_EVERYTHING,groupState:t,newData:!0})},E.prototype.batchUpdateRowData=function(e,t){var i=this;if(!this.rowDataTransactionBatch){this.rowDataTransactionBatch=[];var n=this.gridOptionsWrapper.getBatchUpdateWaitMillis();setTimeout(function(){i.executeBatchUpdateRowData(),i.rowDataTransactionBatch=null},n)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})},E.prototype.executeBatchUpdateRowData=function(){var i=this;this.valueCache.onDataChanged();var n=[],o=[];this.rowDataTransactionBatch.forEach(function(e){var t=i.nodeManager.updateRowData(e.rowDataTransaction,null);o.push(t),e.callback&&n.push(e.callback.bind(t))}),this.commonUpdateRowData(o),0<n.length&&setTimeout(function(){n.forEach(function(e){return e()})},0)},E.prototype.updateRowData=function(e,t){this.valueCache.onDataChanged();var i=this.nodeManager.updateRowData(e,t);return this.commonUpdateRowData([i],t),i},E.prototype.commonUpdateRowData=function(e,t){this.refreshModel({step:l.Constants.STEP_EVERYTHING,rowNodeTransactions:e,rowNodeOrder:t,keepRenderedRows:!0,animate:!0,keepEditingRows:!0});var i={type:g.Events.EVENT_ROW_DATA_UPDATED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(i)},E.prototype.doRowsToDisplay=function(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})},E.prototype.onRowHeightChanged=function(){this.refreshModel({step:l.Constants.STEP_MAP,keepRenderedRows:!0,keepEditingRows:!0})},E.prototype.resetRowHeights=function(){this.forEachNode(function(e){return e.setRowHeight(null)}),this.onRowHeightChanged()},n([m.Autowired("gridOptionsWrapper"),o("design:type",c.GridOptionsWrapper)],E.prototype,"gridOptionsWrapper",void 0),n([m.Autowired("columnController"),o("design:type",d.ColumnController)],E.prototype,"columnController",void 0),n([m.Autowired("filterManager"),o("design:type",h.FilterManager)],E.prototype,"filterManager",void 0),n([m.Autowired("$scope"),o("design:type",Object)],E.prototype,"$scope",void 0),n([m.Autowired("selectionController"),o("design:type",v.SelectionController)],E.prototype,"selectionController",void 0),n([m.Autowired("eventService"),o("design:type",f.EventService)],E.prototype,"eventService",void 0),n([m.Autowired("context"),o("design:type",m.Context)],E.prototype,"context",void 0),n([m.Autowired("valueService"),o("design:type",w.ValueService)],E.prototype,"valueService",void 0),n([m.Autowired("valueCache"),o("design:type",C.ValueCache)],E.prototype,"valueCache",void 0),n([m.Autowired("columnApi"),o("design:type",u.ColumnApi)],E.prototype,"columnApi",void 0),n([m.Autowired("gridApi"),o("design:type",_.GridApi)],E.prototype,"gridApi",void 0),n([m.Autowired("filterStage"),o("design:type",Object)],E.prototype,"filterStage",void 0),n([m.Autowired("sortStage"),o("design:type",Object)],E.prototype,"sortStage",void 0),n([m.Autowired("flattenStage"),o("design:type",Object)],E.prototype,"flattenStage",void 0),n([m.Optional("groupStage"),o("design:type",Object)],E.prototype,"groupStage",void 0),n([m.Optional("aggregationStage"),o("design:type",Object)],E.prototype,"aggregationStage",void 0),n([m.Optional("pivotStage"),o("design:type",Object)],E.prototype,"pivotStage",void 0),n([m.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],E.prototype,"init",null),E=n([m.Bean("rowModel")],E));function E(){}t.ClientSideRowModel=A},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o.prototype.dateComponent=function(e){return e.dateComponent},o.prototype.colDefFloatingCellRenderer=function(e){return e.pinnedRowCellRenderer},o.prototype.colDefCellRenderer=function(e){return e.cellRenderer},o.prototype.colDefCellEditor=function(e){return e.cellEditor},o.prototype.colDefFilter=function(e){return e.filter},o.prototype.gridOptionsFullWidthCellRenderer=function(e){return e.fullWidthCellRenderer},o.prototype.gridOptionsGroupRowRenderer=function(e){return e.groupRowRenderer},o.prototype.gridOptionsGroupRowInnerRenderer=function(e){return e.groupRowInnerRenderer},o.prototype.setTimeout=function(e,t){setTimeout(e,t)},o);function o(){}t.BaseFrameworkFactory=n},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=i(0),a="\r\n",r=(s.prototype.createXml=function(t,i){var n=this,o="";t.properties&&(t.properties.prefixedAttributes&&t.properties.prefixedAttributes.forEach(function(t){Object.keys(t.map).forEach(function(e){o+=n.returnAttributeIfPopulated(t.prefix+e,t.map[e],i)})}),t.properties.rawMap&&Object.keys(t.properties.rawMap).forEach(function(e){o+=n.returnAttributeIfPopulated(e,t.properties.rawMap[e],i)}));var r="<"+t.name+o;return t.children||null!=t.textNode?null!=t.textNode?r+">"+t.textNode+"</"+t.name+">"+a:(r+=">\r\n",t.children.forEach(function(e){r+=n.createXml(e,i)}),r+"</"+t.name+">"+a):r+"/>"+a},s.prototype.returnAttributeIfPopulated=function(e,t,i){if(!t)return"";var n=t;return"boolean"==typeof t&&i&&(n=i(t))," "+e+"="+(n='"'+n+'"')},s=n([o.Bean("xmlFactory")],s));function s(){}t.XmlFactory=r},function(e,Ze,et){"use strict";(function(e){Object.defineProperty(Ze,"__esModule",{value:!0});var t=void 0===e?{}:e;t.HTMLElement="undefined"==typeof HTMLElement?{}:HTMLElement,t.HTMLButtonElement="undefined"==typeof HTMLButtonElement?{}:HTMLButtonElement,t.HTMLSelectElement="undefined"==typeof HTMLSelectElement?{}:HTMLSelectElement,t.HTMLInputElement="undefined"==typeof HTMLInputElement?{}:HTMLInputElement,t.Node="undefined"==typeof Node?{}:Node,t.MouseEvent="undefined"==typeof MouseEvent?{}:MouseEvent;var i=et(38);Ze.BalancedColumnTreeBuilder=i.BalancedColumnTreeBuilder;var n=et(4);Ze.ColumnController=n.ColumnController;var o=et(107);Ze.ColumnKeyCreator=o.ColumnKeyCreator;var r=et(31);Ze.ColumnUtils=r.ColumnUtils;var a=et(48);Ze.DisplayedGroupCreator=a.DisplayedGroupCreator;var s=et(83);Ze.GroupInstanceIdCreator=s.GroupInstanceIdCreator;var l=et(62);Ze.ComponentUtil=l.ComponentUtil;var c=et(106);Ze.ColDefUtil=c.ColDefUtil;var u=et(66);Ze.ComponentProvider=u.ComponentProvider;var d=et(135);Ze.initialiseAgGridWithAngular1=d.initialiseAgGridWithAngular1;var h=et(141);Ze.initialiseAgGridWithWebComponents=h.initialiseAgGridWithWebComponents;var p=et(13);Ze.BeanStub=p.BeanStub;var f=et(0);Ze.Context=f.Context,Ze.Autowired=f.Autowired,Ze.PostConstruct=f.PostConstruct,Ze.PreConstruct=f.PreConstruct,Ze.Optional=f.Optional,Ze.Bean=f.Bean,Ze.Qualifier=f.Qualifier,Ze.PreDestroy=f.PreDestroy;var g=et(11);Ze.QuerySelector=g.QuerySelector,Ze.Listener=g.Listener,Ze.RefSelector=g.RefSelector;var m=et(15);Ze.DragAndDropService=m.DragAndDropService,Ze.DragSourceType=m.DragSourceType,Ze.HDirection=m.HDirection,Ze.VDirection=m.VDirection;var v=et(40);Ze.DragService=v.DragService;var y=et(10);Ze.Column=y.Column;var b=et(26);Ze.ColumnGroup=b.ColumnGroup;var w=et(23);Ze.GridCell=w.GridCell;var C=et(64);Ze.GridRow=C.GridRow;var _=et(32);Ze.OriginalColumnGroup=_.OriginalColumnGroup;var A=et(14);Ze.RowNode=A.RowNode;var E=et(51);Ze.BaseFilter=E.BaseFilter;var x=et(68);Ze.DateFilter=x.DateFilter;var S=et(18);Ze.FilterManager=S.FilterManager;var T=et(96);Ze.NumberFilter=T.NumberFilter;var D=et(95);Ze.TextFilter=D.TextFilter;var k=et(78);Ze.GridPanel=k.GridPanel;var R=et(36);Ze.ScrollVisibleService=R.ScrollVisibleService;var O=et(44);Ze.MouseEventService=O.MouseEventService;var N=et(103);Ze.BodyDropPivotTarget=N.BodyDropPivotTarget;var F=et(101);Ze.BodyDropTarget=F.BodyDropTarget;var M=et(81);Ze.CssClassApplier=M.CssClassApplier;var P=et(98);Ze.HeaderContainer=P.HeaderContainer;var I=et(80);Ze.HeaderRootComp=I.HeaderRootComp;var L=et(99);Ze.HeaderRowComp=L.HeaderRowComp;var G=et(59);Ze.HorizontalResizeService=G.HorizontalResizeService;var $=et(102);Ze.MoveColumnController=$.MoveColumnController;var B=et(108);Ze.StandardMenuFactory=B.StandardMenuFactory;var j=et(142);Ze.TabbedLayout=j.TabbedLayout;var W=et(143);Ze.VerticalStack=W.VerticalStack;var H=et(144);Ze.simpleHttpRequest=H.simpleHttpRequest;var z=et(94);Ze.LargeTextCellEditor=z.LargeTextCellEditor;var V=et(69);Ze.PopupEditorWrapper=V.PopupEditorWrapper;var U=et(93);Ze.PopupSelectCellEditor=U.PopupSelectCellEditor;var Y=et(92);Ze.PopupTextCellEditor=Y.PopupTextCellEditor;var q=et(75);Ze.SelectCellEditor=q.SelectCellEditor;var Q=et(67);Ze.TextCellEditor=Q.TextCellEditor;var K=et(71);Ze.AnimateShowChangeCellRenderer=K.AnimateShowChangeCellRenderer;var X=et(70);Ze.AnimateSlideCellRenderer=X.AnimateSlideCellRenderer;var J=et(72);Ze.GroupCellRenderer=J.GroupCellRenderer;var Z=et(52);Ze.SetLeftFeature=Z.SetLeftFeature;var ee=et(39);Ze.AutoWidthCalculator=ee.AutoWidthCalculator;var te=et(54);Ze.CellEditorFactory=te.CellEditorFactory;var ie=et(55);Ze.CellRendererFactory=ie.CellRendererFactory;var ne=et(56);Ze.CellRendererService=ne.CellRendererService;var oe=et(65);Ze.CheckboxSelectionComponent=oe.CheckboxSelectionComponent;var re=et(34);Ze.CellComp=re.CellComp;var ae=et(50);Ze.RowComp=ae.RowComp;var se=et(20);Ze.RowRenderer=se.RowRenderer;var le=et(43);Ze.ValueFormatterService=le.ValueFormatterService;var ce=et(109);Ze.FilterStage=ce.FilterStage;var ue=et(113);Ze.FlattenStage=ue.FlattenStage;var de=et(111);Ze.SortStage=de.SortStage;var he=et(30);Ze.PinnedRowModel=he.PinnedRowModel;var pe=et(116);Ze.ClientSideRowModel=pe.ClientSideRowModel;var fe=et(89);Ze.ChangedPath=fe.ChangedPath;var ge=et(88);Ze.ClientSideNodeManager=ge.ClientSideNodeManager;var me=et(114);Ze.InfiniteRowModel=me.InfiniteRowModel;var ve=et(61);Ze.RowNodeBlock=ve.RowNodeBlock;var ye=et(115);Ze.RowNodeBlockLoader=ye.RowNodeBlockLoader;var be=et(87);Ze.RowNodeCache=be.RowNodeCache;var we=et(73);Ze.StylingService=we.StylingService;var Ce=et(60);Ze.AgCheckbox=Ce.AgCheckbox;var _e=et(8);Ze.Component=_e.Component;var Ae=et(35);Ze.PopupService=Ae.PopupService;var Ee=et(46);Ze.TouchListener=Ee.TouchListener;var xe=et(117);Ze.BaseFrameworkFactory=xe.BaseFrameworkFactory;var Se=et(82);Ze.CellNavigationService=Se.CellNavigationService;var Te=et(58);Ze.AlignedGridsService=Te.AlignedGridsService;var De=et(9);Ze.Constants=De.Constants;var ke=et(47);Ze.CsvCreator=ke.CsvCreator,Ze.BaseCreator=ke.BaseCreator;var Re=et(84);Ze.Downloader=Re.Downloader;var Oe=et(85);Ze.Grid=Oe.Grid;var Ne=et(6);Ze.GridApi=Ne.GridApi;var Fe=et(25);Ze.Events=Fe.Events;var Me=et(22);Ze.FocusedCellController=Me.FocusedCellController;var Pe=et(145);Ze.defaultGroupComparator=Pe.defaultGroupComparator;var Ie=et(2);Ze.GridOptionsWrapper=Ie.GridOptionsWrapper;var Le=et(3);Ze.EventService=Le.EventService;var Ge=et(86);Ze.SelectableService=Ge.SelectableService;var $e=et(42);Ze.GridCore=$e.GridCore;var Be=et(12);Ze.Logger=Be.Logger;var je=et(17);Ze.SelectionController=je.SelectionController;var We=et(24);Ze.SortController=We.SortController;var He=et(49);Ze.TemplateService=He.TemplateService;var ze=et(1);Ze.Utils=ze.Utils,Ze.NumberSequence=ze.NumberSequence,Ze._=ze._,Ze.Promise=ze.Promise;var Ve=et(16);Ze.ValueService=Ve.ValueService;var Ue=et(19);Ze.ExpressionService=Ue.ExpressionService;var Ye=et(118);Ze.XmlFactory=Ye.XmlFactory;var qe=et(63);Ze.GridSerializer=qe.GridSerializer,Ze.BaseGridSerializingSession=qe.BaseGridSerializingSession,Ze.RowType=qe.RowType;var Qe=et(12);Ze.LoggerFactory=Qe.LoggerFactory;var Ke=et(7);Ze.ColumnApi=Ke.ColumnApi;var Xe=et(146);Ze.BaseComponentWrapper=Xe.BaseComponentWrapper;var Je=et(41);Ze.Environment=Je.Environment}).call(Ze,et(120))},function(JFi,KFi){var LFi;LFi=function(){return this}();try{LFi=LFi||Function("return this")()||eval("this")}catch(e){"object"==typeof window&&(LFi=window)}JFi.exports=LFi},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(8),c=i(0),u=i(14),d=i(15),h=i(25),p=i(1),f=i(13),g=(s=l.Component,o(m,s),m.prototype.postConstruct=function(){this.addDragSource(),this.checkCompatibility(),this.beans.gridOptionsWrapper.isRowDragManaged()?this.addFeature(this.beans.context,new C(this,this.beans,this.rowNode,this.column)):this.addFeature(this.beans.context,new y(this,this.beans,this.rowNode,this.column))},m.prototype.checkCompatibility=function(){var e=this.beans.gridOptionsWrapper.isRowDragManaged();this.beans.gridOptionsWrapper.isTreeData()&&e&&p._.doOnce(function(){return console.warn("ag-Grid: If using row drag with tree data, you cannot have rowDragManaged=true")},"RowDragComp.managedAndTreeData")},m.prototype.addDragSource=function(){var e=this,t={rowNode:this.rowNode},i={type:d.DragSourceType.RowDrag,eElement:this.getGui(),dragItemName:this.cellValue,dragItemCallback:function(){return t},dragStartPixels:0};this.beans.dragAndDropService.addDragSource(i,!0),this.addDestroyFunc(function(){return e.beans.dragAndDropService.removeDragSource(i)})},r([c.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],m.prototype,"postConstruct",null),m);function m(e,t,i,n){var o=s.call(this,'<span class="ag-row-drag"></span>')||this;return o.rowNode=e,o.column=t,o.cellValue=i,o.beans=n,o}t.RowDragComp=g;var v,y=(v=f.BeanStub,o(b,v),b.prototype.postConstruct=function(){this.addDestroyableEventListener(this.beans.gridOptionsWrapper,"suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.addDestroyableEventListener(this.rowNode,u.RowNode.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addDestroyableEventListener(this.rowNode,u.RowNode.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.workOutVisibility()},b.prototype.onSuppressRowDrag=function(){this.workOutVisibility()},b.prototype.workOutVisibility=function(){if(this.beans.gridOptionsWrapper.isSuppressRowDrag())this.parent.setVisible(!1);else{var e=this.column.isRowDrag(this.rowNode);this.parent.setVisible(e)}},r([c.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],b.prototype,"postConstruct",null),b);function b(e,t,i,n){var o=v.call(this)||this;return o.parent=e,o.beans=t,o.column=n,o.rowNode=i,o}var w,C=(w=f.BeanStub,o(_,w),_.prototype.postConstruct=function(){this.addDestroyableEventListener(this.beans.eventService,h.Events.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addDestroyableEventListener(this.beans.eventService,h.Events.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addDestroyableEventListener(this.beans.eventService,h.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onRowGroupChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,u.RowNode.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addDestroyableEventListener(this.rowNode,u.RowNode.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addDestroyableEventListener(this.beans.gridOptionsWrapper,"suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.updateSortActive(),this.updateFilterActive(),this.updateRowGroupActive(),this.workOutVisibility()},_.prototype.updateRowGroupActive=function(){var e=this.beans.columnController.getRowGroupColumns();this.rowGroupActive=!p._.missingOrEmpty(e)},_.prototype.onRowGroupChanged=function(){this.updateRowGroupActive(),this.workOutVisibility()},_.prototype.updateSortActive=function(){var e=this.beans.sortController.getSortModel();this.sortActive=!p._.missingOrEmpty(e)},_.prototype.onSortChanged=function(){this.updateSortActive(),this.workOutVisibility()},_.prototype.updateFilterActive=function(){this.filterActive=this.beans.filterManager.isAnyFilterPresent()},_.prototype.onFilterChanged=function(){this.updateFilterActive(),this.workOutVisibility()},_.prototype.onSuppressRowDrag=function(){this.workOutVisibility()},_.prototype.workOutVisibility=function(){var e=this.sortActive||this.filterActive||this.rowGroupActive,t=this.beans.gridOptionsWrapper.isSuppressRowDrag();if(e||t)this.parent.setVisible(!1);else{var i=this.column.isRowDrag(this.rowNode);this.parent.setVisible(i)}},r([c.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],_.prototype,"postConstruct",null),_);function _(e,t,i,n){var o=w.call(this)||this;return o.parent=e,o.beans=t,o.column=n,o.rowNode=i,o}},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(0),c=i(10),u=i(1),d=i(52),h=i(8),p=i(11),f=i(2),g=i(28),m=i(74),v=i(5),y=i(3),b=i(45),w=(s=h.Component,o(C,s),C.prototype.init=function(e){this.column=e.column;var t=u._.loadTemplate('<div class="ag-header-cell" aria-hidden="true"><div class="ag-floating-filter-body" aria-hidden="true"></div></div>');this.enrichBody(t),this.setTemplateFromElement(t),this.setupWidth(),this.addColumnHoverListener(),this.addFeature(this.context,new m.HoverFeature([this.column],this.getGui()));var i=new d.SetLeftFeature(this.column,this.getGui(),this.beans);i.init(),this.addDestroyFunc(i.destroy.bind(i))},C.prototype.addColumnHoverListener=function(){this.addDestroyableEventListener(this.eventService,v.Events.EVENT_COLUMN_HOVER_CHANGED,this.onColumnHover.bind(this)),this.onColumnHover()},C.prototype.onColumnHover=function(){var e=this.columnHoverService.isHovered(this.column);u._.addOrRemoveCssClass(this.getGui(),"ag-column-hover",e)},C.prototype.setupWidth=function(){this.addDestroyableEventListener(this.column,c.Column.EVENT_WIDTH_CHANGED,this.onColumnWidthChanged.bind(this)),this.onColumnWidthChanged()},C.prototype.onColumnWidthChanged=function(){this.getGui().style.width=this.column.getActualWidth()+"px"},r([l.Autowired("context"),a("design:type",l.Context)],C.prototype,"context",void 0),r([l.Autowired("columnHoverService"),a("design:type",b.ColumnHoverService)],C.prototype,"columnHoverService",void 0),r([l.Autowired("eventService"),a("design:type",y.EventService)],C.prototype,"eventService",void 0),r([l.Autowired("beans"),a("design:type",g.Beans)],C.prototype,"beans",void 0),C);function C(){return null!==s&&s.apply(this,arguments)||this}t.BaseFilterWrapperComp=w;var _,A=(o(E,_=w),E.prototype.init=function(e){this.floatingFilterCompPromise=e.floatingFilterComp,this.suppressFilterButton=e.suppressFilterButton,_.prototype.init.call(this,e),this.addEventListeners()},E.prototype.addEventListeners=function(){!this.suppressFilterButton&&this.eButtonShowMainFilter&&this.addDestroyableEventListener(this.eButtonShowMainFilter,"click",this.showParentFilter.bind(this))},E.prototype.enrichBody=function(o){var r=this;this.floatingFilterCompPromise.then(function(e){var t=o.querySelector(".ag-floating-filter-body"),i=e.getGui();if(r.suppressFilterButton)t.appendChild(i),u._.removeCssClass(t,"ag-floating-filter-body"),u._.addCssClass(t,"ag-floating-filter-full-body");else{t.appendChild(i),o.appendChild(u._.loadTemplate('<div class="ag-floating-filter-button" aria-hidden="true">\n                        <button type="button" ref="eButtonShowMainFilter"></button>\n                </div>'));var n=u._.createIconNoSpan("filter",r.gridOptionsWrapper,r.column);o.querySelector("button").appendChild(n)}e.afterGuiAttached&&e.afterGuiAttached(),r.wireQuerySelectors(),r.addEventListeners()})},E.prototype.onParentModelChanged=function(e){var t=void 0,i=null;i=e&&e.operator?(t=e).condition1:e,this.floatingFilterCompPromise.then(function(e){e.onParentModelChanged(i,t)})},E.prototype.showParentFilter=function(){this.menuFactory.showMenuAfterButtonClick(this.column,this.eButtonShowMainFilter,"filterMenuTab",["filterMenuTab"])},r([p.RefSelector("eButtonShowMainFilter"),a("design:type",HTMLInputElement)],E.prototype,"eButtonShowMainFilter",void 0),r([l.Autowired("menuFactory"),a("design:type",Object)],E.prototype,"menuFactory",void 0),r([l.Autowired("gridOptionsWrapper"),a("design:type",f.GridOptionsWrapper)],E.prototype,"gridOptionsWrapper",void 0),E);function E(){return null!==_&&_.apply(this,arguments)||this}t.FloatingFilterWrapperComp=A;var x,S=(o(T,x=w),T.prototype.enrichBody=function(e){},T.prototype.onParentModelChanged=function(e){},T);function T(){return null!==x&&x.apply(this,arguments)||this}t.EmptyFloatingFilterWrapperComp=S},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o.prototype.add=function(e){var t={item:e,next:null};this.last?this.last.next=t:this.first=t,this.last=t},o.prototype.remove=function(){var e=this.first;return e&&(this.first=e.next,this.first||(this.last=null)),e.item},o.prototype.isEmpty=function(){return!this.first},o);function o(){this.first=null,this.last=null}t.LinkedList=n},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(1),c=i(2),u=i(0),d=i(8),h=i(21),p=(s=d.Component,o(f,s),f.prototype.init=function(){},f.prototype.showLoadingOverlay=function(e){var i=this;this.setTemplate(f.LOADING_WRAPPER_OVERLAY_TEMPLATE),this.componentRecipes.newLoadingOverlayComponent().then(function(e){var t=i.getRefElement("loadingOverlayWrapper");l.Utils.removeAllChildren(t),t.appendChild(e.getGui())}),this.showOverlay(e,this.getGui())},f.prototype.showNoRowsOverlay=function(e){var i=this;this.setTemplate(f.NO_ROWS_WRAPPER_OVERLAY_TEMPLATE),this.componentRecipes.newNoRowsOverlayComponent().then(function(e){var t=i.getRefElement("noRowsOverlayWrapper");l.Utils.removeAllChildren(t),t.appendChild(e.getGui())}),this.showOverlay(e,this.getGui())},f.prototype.hideOverlay=function(e){l.Utils.removeAllChildren(e),l.Utils.setVisible(e,!1)},f.prototype.showOverlay=function(e,t){t?(l.Utils.removeAllChildren(e),l.Utils.setVisible(e,!0),e.appendChild(t)):(console.warn("ag-Grid: unknown overlay"),this.hideOverlay(e))},f.LOADING_WRAPPER_OVERLAY_TEMPLATE='<div class="ag-overlay-panel" role="presentation"><div class="ag-overlay-wrapper ag-overlay-loading-wrapper" ref="loadingOverlayWrapper">[OVERLAY_TEMPLATE]</div></div>',f.NO_ROWS_WRAPPER_OVERLAY_TEMPLATE='<div class="ag-overlay-panel" role="presentation"><div class="ag-overlay-wrapper ag-overlay-no-rows-wrapper" ref="noRowsOverlayWrapper">[OVERLAY_TEMPLATE]</div></div>',r([u.Autowired("gridOptionsWrapper"),a("design:type",c.GridOptionsWrapper)],f.prototype,"gridOptionsWrapper",void 0),r([u.Autowired("componentRecipes"),a("design:type",h.ComponentRecipes)],f.prototype,"componentRecipes",void 0),f);function f(){return s.call(this)||this}t.OverlayWrapperComponent=p},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(8),c=i(10),u=i(1),d=i(0),h=i(2),p=i(24),f=i(46),g=i(3),m=i(11),v=i(5),y=(s=l.Component,o(b,s),b.prototype.init=function(e){var t=u.Utils.firstExistingValue(e.template,b.TEMPLATE);this.setTemplate(t),this.params=e,this.setupTap(),this.setupIcons(e.column),this.setupMenu(),this.setupSort(),this.setupFilterIcon(),this.setupText(e.displayName)},b.prototype.setupText=function(e){this.eText&&(this.eText.innerHTML=e)},b.prototype.setupIcons=function(e){this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e),this.addInIcon("menu",this.eMenu,e),this.addInIcon("filter",this.eFilter,e)},b.prototype.addInIcon=function(e,t,i){if(null!=t){var n=u.Utils.createIconNoSpan(e,this.gridOptionsWrapper,i);t.appendChild(n)}},b.prototype.setupTap=function(){var t=this;if(!this.gridOptionsWrapper.isSuppressTouch()){var e=new f.TouchListener(this.getGui());this.params.enableMenu&&this.addDestroyableEventListener(e,f.TouchListener.EVENT_LONG_TAP,function(e){t.gridOptionsWrapper.getApi().showColumnMenuAfterMouseClick(t.params.column,e.touchStart)}),this.params.enableSorting&&this.addDestroyableEventListener(e,f.TouchListener.EVENT_TAP,function(){t.sortController.progressSort(t.params.column,!1,"uiColumnSorted")}),this.addDestroyFunc(function(){return e.destroy()})}},b.prototype.setupMenu=function(){var e=this;if(this.eMenu)if(!this.params.enableMenu||u.Utils.isUserAgentIPad())u.Utils.removeFromParent(this.eMenu);else{this.eMenu.addEventListener("click",function(){return e.showMenu(e.eMenu)}),this.gridOptionsWrapper.isSuppressMenuHide()||(this.eMenu.style.opacity="0",this.addGuiEventListener("mouseover",function(){e.eMenu.style.opacity="1"}),this.addGuiEventListener("mouseout",function(){e.eMenu.style.opacity="0"}));var t=this.eMenu.style;t.transition="opacity 0.2s, border 0.2s",t["-webkit-transition"]="opacity 0.2s, border 0.2s"}},b.prototype.showMenu=function(e){this.menuFactory.showMenuAfterButtonClick(this.params.column,e)},b.prototype.removeSortIcons=function(){u.Utils.removeFromParent(this.eSortAsc),u.Utils.removeFromParent(this.eSortDesc),u.Utils.removeFromParent(this.eSortNone),u.Utils.removeFromParent(this.eSortOrder)},b.prototype.setupSort=function(){var o=this;if(this.params.enableSorting){var r=this.gridOptionsWrapper.isMultiSortKeyCtrl();this.addDestroyableEventListener(this.params.column,c.Column.EVENT_MOVING_CHANGED,function(){o.lastMovingChanged=(new Date).getTime()}),this.eLabel&&this.addDestroyableEventListener(this.eLabel,"click",function(e){var t=o.params.column.isMoving(),i=(new Date).getTime()-o.lastMovingChanged<50;if(t||i)console.log("kipping sort cos of moving "+o.lastMovingChanged);else{var n=r?e.ctrlKey||e.metaKey:e.shiftKey;o.params.progressSort(n)}}),this.addDestroyableEventListener(this.params.column,c.Column.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.onSortChanged(),this.addDestroyableEventListener(this.eventService,v.Events.EVENT_SORT_CHANGED,this.setMultiSortOrder.bind(this)),this.setMultiSortOrder()}else this.removeSortIcons()},b.prototype.onSortChanged=function(){if(u.Utils.addOrRemoveCssClass(this.getGui(),"ag-header-cell-sorted-asc",this.params.column.isSortAscending()),u.Utils.addOrRemoveCssClass(this.getGui(),"ag-header-cell-sorted-desc",this.params.column.isSortDescending()),u.Utils.addOrRemoveCssClass(this.getGui(),"ag-header-cell-sorted-none",this.params.column.isSortNone()),this.eSortAsc&&u.Utils.addOrRemoveCssClass(this.eSortAsc,"ag-hidden",!this.params.column.isSortAscending()),this.eSortDesc&&u.Utils.addOrRemoveCssClass(this.eSortDesc,"ag-hidden",!this.params.column.isSortDescending()),this.eSortNone){var e=!this.params.column.getColDef().unSortIcon&&!this.gridOptionsWrapper.isUnSortIcon();u.Utils.addOrRemoveCssClass(this.eSortNone,"ag-hidden",e||!this.params.column.isSortNone())}},b.prototype.setMultiSortOrder=function(){if(this.eSortOrder){var e=this.params.column,t=this.sortController.getColumnsWithSortingOrdered(),i=t.indexOf(e),n=1<t.length,o=e.isSorting()&&n;u.Utils.setVisible(this.eSortOrder,o),this.eSortOrder.innerHTML=0<=i?(i+1).toString():""}},b.prototype.setupFilterIcon=function(){this.eFilter&&(this.addDestroyableEventListener(this.params.column,c.Column.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.onFilterChanged())},b.prototype.onFilterChanged=function(){var e=this.params.column.isFilterActive();u.Utils.addOrRemoveCssClass(this.eFilter,"ag-hidden",!e)},b.TEMPLATE='<div class="ag-cell-label-container" role="presentation">  <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>  <div ref="eLabel" class="ag-header-cell-label" role="presentation">    <span ref="eText" class="ag-header-cell-text" role="columnheader"></span>    <span ref="eFilter" class="ag-header-icon ag-filter-icon" aria-hidden="true"></span>    <span ref="eSortOrder" class="ag-header-icon ag-sort-order" aria-hidden="true"></span>    <span ref="eSortAsc" class="ag-header-icon ag-sort-ascending-icon" aria-hidden="true"></span>    <span ref="eSortDesc" class="ag-header-icon ag-sort-descending-icon" aria-hidden="true"></span>    <span ref="eSortNone" class="ag-header-icon ag-sort-none-icon" aria-hidden="true"></span>  </div></div>',r([d.Autowired("gridOptionsWrapper"),a("design:type",h.GridOptionsWrapper)],b.prototype,"gridOptionsWrapper",void 0),r([d.Autowired("sortController"),a("design:type",p.SortController)],b.prototype,"sortController",void 0),r([d.Autowired("menuFactory"),a("design:type",Object)],b.prototype,"menuFactory",void 0),r([d.Autowired("eventService"),a("design:type",g.EventService)],b.prototype,"eventService",void 0),r([m.RefSelector("eFilter"),a("design:type",HTMLElement)],b.prototype,"eFilter",void 0),r([m.RefSelector("eSortAsc"),a("design:type",HTMLElement)],b.prototype,"eSortAsc",void 0),r([m.RefSelector("eSortDesc"),a("design:type",HTMLElement)],b.prototype,"eSortDesc",void 0),r([m.RefSelector("eSortNone"),a("design:type",HTMLElement)],b.prototype,"eSortNone",void 0),r([m.RefSelector("eSortOrder"),a("design:type",HTMLElement)],b.prototype,"eSortOrder",void 0),r([m.RefSelector("eMenu"),a("design:type",HTMLElement)],b.prototype,"eMenu",void 0),r([m.RefSelector("eLabel"),a("design:type",HTMLElement)],b.prototype,"eLabel",void 0),r([m.RefSelector("eText"),a("design:type",HTMLElement)],b.prototype,"eText",void 0),b);function b(){var e=null!==s&&s.apply(this,arguments)||this;return e.lastMovingChanged=0,e}t.HeaderComp=y},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(8),c=i(1),u=i(4),d=i(2),h=i(0),p=i(46),f=i(11),g=i(32),m=(s=l.Component,o(v,s),v.prototype.init=function(e){this.params=e,this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()},v.prototype.setupExpandIcons=function(){var i=this;function e(e){if(!c.Utils.isStopPropagationForAgGrid(e)){var t=!i.params.columnGroup.isExpanded();i.columnController.setColumnGroupOpened(i.params.columnGroup.getOriginalColumnGroup(),t,"uiColumnExpanded")}}function t(e){c.Utils.stopPropagationForAgGrid(e)}this.addInIcon("columnGroupOpened","agOpened"),this.addInIcon("columnGroupClosed","agClosed"),this.addTouchAndClickListeners(this.eCloseIcon,e),this.addTouchAndClickListeners(this.eOpenIcon,e),this.addDestroyableEventListener(this.eCloseIcon,"dblclick",t),this.addDestroyableEventListener(this.eOpenIcon,"dblclick",t),this.addDestroyableEventListener(this.getGui(),"dblclick",e),this.updateIconVisibility();var n=this.params.columnGroup.getOriginalColumnGroup();this.addDestroyableEventListener(n,g.OriginalColumnGroup.EVENT_EXPANDED_CHANGED,this.updateIconVisibility.bind(this)),this.addDestroyableEventListener(n,g.OriginalColumnGroup.EVENT_EXPANDABLE_CHANGED,this.updateIconVisibility.bind(this))},v.prototype.addTouchAndClickListeners=function(e,t){var i=new p.TouchListener(this.eCloseIcon);this.addDestroyableEventListener(i,p.TouchListener.EVENT_TAP,t),this.addDestroyFunc(function(){return i.destroy()}),this.addDestroyableEventListener(e,"click",t)},v.prototype.updateIconVisibility=function(){if(this.params.columnGroup.isExpandable()){var e=this.params.columnGroup.isExpanded();c.Utils.setVisible(this.eOpenIcon,!e),c.Utils.setVisible(this.eCloseIcon,e)}else c.Utils.setVisible(this.eOpenIcon,!1),c.Utils.setVisible(this.eCloseIcon,!1)},v.prototype.addInIcon=function(e,t){var i=c.Utils.createIconNoSpan(e,this.gridOptionsWrapper,null);this.getRefElement(t).appendChild(i)},v.prototype.addGroupExpandIcon=function(){if(!this.params.columnGroup.isExpandable())return c.Utils.setVisible(this.eOpenIcon,!1),void c.Utils.setVisible(this.eCloseIcon,!1)},v.prototype.setupLabel=function(){this.params.displayName&&""!==this.params.displayName&&(this.getRefElement("agLabel").innerHTML=this.params.displayName)},v.TEMPLATE='<div class="ag-header-group-cell-label" ref="agContainer"><span ref="agLabel" class="ag-header-group-text"></span><span ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span><span ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span></div>',r([h.Autowired("columnController"),a("design:type",u.ColumnController)],v.prototype,"columnController",void 0),r([h.Autowired("gridOptionsWrapper"),a("design:type",d.GridOptionsWrapper)],v.prototype,"gridOptionsWrapper",void 0),r([f.RefSelector("agOpened"),a("design:type",HTMLElement)],v.prototype,"eOpenIcon",void 0),r([f.RefSelector("agClosed"),a("design:type",HTMLElement)],v.prototype,"eCloseIcon",void 0),v);function v(){return s.call(this,v.TEMPLATE)||this}t.HeaderGroupComp=m},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(2),c=i(0),u=i(8),d=(s=u.Component,o(h,s),h.prototype.init=function(e){var t=this.gridOptionsWrapper.getOverlayLoadingTemplate()?this.gridOptionsWrapper.getOverlayLoadingTemplate():h.DEFAULT_LOADING_OVERLAY_TEMPLATE,i=this.gridOptionsWrapper.getLocaleTextFunc(),n=t.replace("[LOADING...]",i("loadingOoo","Loading..."));this.setTemplate(n)},h.DEFAULT_LOADING_OVERLAY_TEMPLATE='<span class="ag-overlay-loading-center">[LOADING...]</span>',r([c.Autowired("gridOptionsWrapper"),a("design:type",l.GridOptionsWrapper)],h.prototype,"gridOptionsWrapper",void 0),h);function h(){return s.call(this)||this}t.LoadingOverlayComponent=d},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(2),c=i(0),u=i(8),d=(s=u.Component,o(h,s),h.prototype.init=function(e){var t=this.gridOptionsWrapper.getOverlayNoRowsTemplate()?this.gridOptionsWrapper.getOverlayNoRowsTemplate():h.DEFAULT_NO_ROWS_TEMPLATE,i=this.gridOptionsWrapper.getLocaleTextFunc(),n=t.replace("[NO_ROWS_TO_SHOW]",i("noRowsToShow","No Rows To Show"));this.setTemplate(n)},h.DEFAULT_NO_ROWS_TEMPLATE='<span class="ag-overlay-no-rows-center">[NO_ROWS_TO_SHOW]</span>',r([c.Autowired("gridOptionsWrapper"),a("design:type",l.GridOptionsWrapper)],h.prototype,"gridOptionsWrapper",void 0),h);function h(){return s.call(this)||this}t.NoRowsOverlayComponent=d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(window):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)},n="undefined"!=typeof MutationObserver,d=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||window},h=g(0,0,0,0);function p(e){return parseFloat(e)||0}function f(i,e,t){return[e,t].reduce(function(e,t){return e+p(i.getPropertyValue("border-"+t+"-width"))},0)}function o(e){var t=e.clientWidth,i=e.clientHeight;if(!t&&!i)return h;var n=d(e).getComputedStyle(e),o=function(e){for(var t={top:null,left:null,right:null,bottom:null},i=0,n=["top","right","bottom","left"];i<n.length;i+=1){var o=n[i],r=e.getPropertyValue("padding-"+o);t[o]=p(r)}return t}(n),r=o.left+o.right,a=o.top+o.bottom,s=p(n.width),l=p(n.height);"border-box"===n.boxSizing&&(Math.round(s+r)!==t&&(s-=f(n,"left","right")+r),Math.round(l+a)!==i&&(l-=f(n,"top","bottom")+a));var c=Math.round(s+r)-t,u=Math.round(l+a)-i;return 1!==Math.abs(c)&&(s-=c),1!==Math.abs(u)&&(l-=u),g(o.left,o.top,s,l)}function r(e){var t=e.x,i=e.y,n=e.width,o=e.height,r=window.DOMRectReadOnly?window.DOMRectReadOnly:Object,a=Object.create(r.prototype);return function(e,t){for(var i=0,n=Object.keys(t);i<n.length;i+=1){var o=n[i];Object.defineProperty(e,o,{value:t[o],enumerable:false,writable:false,configurable:true})}}(a,{x:t,y:i,width:n,height:o,top:i,right:t+n,bottom:o+i,left:t}),a}function g(e,t,i,n){return{x:e,y:t,width:i,height:n}}var a=(s.prototype.addObserver=function(e){-1==this.observers_.indexOf(e)&&this.observers_.push(e),this.connected_||this.connect_()},s.prototype.removeObserver=function(e){var t=this.observers_,i=t.indexOf(e);-1<i&&t.splice(i,1),!t.length&&this.connected_&&this.disconnect_()},s.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},s.prototype.updateObservers_=function(){var e=this.observers_.filter(function(e){return e.hasActive()});return e.forEach(function(e){return e.broadcastActive()}),0<e.length},s.prototype.connect_=function(){this.connected_||(window.addEventListener("resize",this.refresh),n?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},s.prototype.disconnect_=function(){this.connected_&&(window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},s.getInstance=function(){return this.instance_||(this.instance_=new s),this.instance_},s.instance_=null,s);function s(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.callback_=null,this.refresh=function(e,t){var i=!1,n=!1,o=0;function r(){i&&(i=!1,e()),n&&s()}function a(){l(r)}function s(){var e=Date.now();if(i){if(e-o<2)return;n=!0}else n=!(i=!0),setTimeout(a,t);o=e}return s}(this.refresh.bind(this),20)}var c=(u.prototype.isActive=function(){var e=function(e){return o(e)}(this.target);return(this.contentRect_=e).width!==this.broadcastWidth||e.height!==this.broadcastHeight},u.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},u);function u(e){this.target=e,this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=null,this.contentRect_=g(0,0,0,0)}var m=(v.prototype.observe=function(e){this.observation=new c(e),this.controller_.addObserver(this),this.controller_.refresh()},v.prototype.disconnect=function(){this.observation=null,this.controller_.removeObserver(this)},v.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_;this.callback_.call(e,{target:this.observation.target,contentRect:r(this.observation.broadcastRect())},e)}},v.prototype.hasActive=function(){return this.observation.isActive()},v);function v(e,t,i){if(this.observation=null,this.callback_=null,this.controller_=null,this.callbackCtx_=null,this.observation=null,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i}var y=(b.prototype.observe=function(e){this.observer_.observe(e)},b.prototype.disconnect=function(){this.observer_.disconnect()},b);function b(e){var t=a.getInstance(),i=new m(e,t,this);this.observer_=i}t.observeResize=function(e,r){if(window.ResizeObserver){var t=new window.ResizeObserver(function(e,t){for(var i=0,n=e;i<n.length;i++){var o=n[i];r(o)}});return t.observe(e),function(){t.disconnect()}}var i=new y(function(e){r(e)});return i.observe(e),function(){i.disconnect()}}},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),a=i(0),s=i(2),l=(c.prototype.setVerticalScrollPosition=function(e){this.scrollTop=e},c.prototype.postConstruct=function(){this.domOrder=this.gridOptionsWrapper.isEnsureDomOrder(),this.checkVisibility()},c.prototype.getRowElement=function(e){return this.eContainer.querySelector('[comp-id="'+e+'"]')},c.prototype.setHeight=function(e){this.eContainer.style.height=e+"px"},c.prototype.flushRowTemplates=function(){if(0!==this.rowTemplatesToAdd.length){var e=this.rowTemplatesToAdd.join("");r.Utils.appendHtml(this.eContainer,e),this.rowTemplatesToAdd.length=0}this.afterGuiAttachedCallbacks.forEach(function(e){return e()}),this.afterGuiAttachedCallbacks.length=0,this.lastPlacedElement=null},c.prototype.appendRowTemplate=function(e,t){this.domOrder?this.lastPlacedElement=r.Utils.insertTemplateWithDomOrder(this.eContainer,e,this.lastPlacedElement):this.rowTemplatesToAdd.push(e),this.afterGuiAttachedCallbacks.push(t),this.childCount++,this.checkVisibility()},c.prototype.ensureDomOrder=function(e){this.domOrder&&(r.Utils.ensureDomOrder(this.eContainer,e,this.lastPlacedElement),this.lastPlacedElement=e)},c.prototype.removeRowElement=function(e){this.eContainer.removeChild(e),this.childCount--,this.checkVisibility()},c.prototype.checkVisibility=function(){if(this.hideWhenNoChildren){var e=this.eViewport?this.eViewport:this.eContainer,t=0<this.childCount;this.visible!==t&&(this.visible=t,r.Utils.setVisible(e,t),t&&this.eViewport&&(this.eViewport.scrollTop=this.scrollTop))}},n([a.Autowired("gridOptionsWrapper"),o("design:type",s.GridOptionsWrapper)],c.prototype,"gridOptionsWrapper",void 0),n([a.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],c.prototype,"postConstruct",null),c);function c(e){this.childCount=0,this.rowTemplatesToAdd=[],this.afterGuiAttachedCallbacks=[],this.eContainer=e.eContainer,this.eViewport=e.eViewport,this.hideWhenNoChildren=e.hideWhenNoChildren}t.RowContainerComponent=l},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s=i(15),r=i(0),a=i(22),l=i(2),c=i(3),u=i(25),d=(h.prototype.postConstruct=function(){this.gridOptionsWrapper.isRowModelDefault()&&(this.clientSideRowModel=this.rowModel)},h.prototype.getContainer=function(){return this.eContainer},h.prototype.isInterestedIn=function(e){return e===s.DragSourceType.RowDrag},h.prototype.getIconName=function(){return s.DragAndDropService.ICON_MOVE},h.prototype.onDragEnter=function(e){this.dispatchEvent(u.Events.EVENT_ROW_DRAG_ENTER,e),this.dragAndDropService.setGhostIcon(s.DragAndDropService.ICON_MOVE),e.dragItem.rowNode.setDragging(!0),this.onEnterOrDragging(e)},h.prototype.onDragging=function(e){this.onEnterOrDragging(e)},h.prototype.onEnterOrDragging=function(e){this.dispatchEvent(u.Events.EVENT_ROW_DRAG_MOVE,e),this.lastDraggingEvent=e;var t=this.normaliseForScroll(e.y);this.gridOptionsWrapper.isRowDragManaged()&&this.doManagedDrag(e,t),this.checkCenterForScrolling(t)},h.prototype.doManagedDrag=function(e,t){var i=e.dragItem.rowNode;this.clientSideRowModel.ensureRowAtPixel(i,t)&&(this.focusedCellController.clearFocusedCell(),this.rangeController&&this.rangeController.clearSelection())},h.prototype.normaliseForScroll=function(e){return this.gridOptionsWrapper.isGridAutoHeight()?e:e+this.gridPanel.getVScrollPosition().top},h.prototype.checkCenterForScrolling=function(e){var t=this.gridPanel.getVScrollPosition();this.needToMoveUp=e<t.top+50,this.needToMoveDown=e>t.bottom-50,this.needToMoveUp||this.needToMoveDown?this.ensureIntervalStarted():this.ensureIntervalCleared()},h.prototype.ensureIntervalStarted=function(){this.movingIntervalId||(this.intervalCount=0,this.movingIntervalId=setInterval(this.moveInterval.bind(this),100))},h.prototype.ensureIntervalCleared=function(){this.moveInterval&&(clearInterval(this.movingIntervalId),this.movingIntervalId=null)},h.prototype.moveInterval=function(){var e,t;this.intervalCount++,100<(e=10+5*this.intervalCount)&&(e=100),this.needToMoveDown?t=this.gridPanel.scrollVertically(e):this.needToMoveUp&&(t=this.gridPanel.scrollVertically(-e)),0!==t&&this.onDragging(this.lastDraggingEvent)},h.prototype.dispatchEvent=function(e,t){var i,n=this.normaliseForScroll(t.y),o=-1,r=null;switch(n>this.rowModel.getCurrentPageHeight()||(o=this.rowModel.getRowIndexAtPixel(n),r=this.rowModel.getRow(o)),t.vDirection){case s.VDirection.Down:i="down";break;case s.VDirection.Up:i="up";break;default:i=null}var a={type:e,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),event:t.event,node:t.dragItem.rowNode,overIndex:o,overNode:r,y:n,vDirection:i};this.eventService.dispatchEvent(a)},h.prototype.onDragLeave=function(e){this.dispatchEvent(u.Events.EVENT_ROW_DRAG_LEAVE,e),this.stopDragging(e)},h.prototype.onDragStop=function(e){this.dispatchEvent(u.Events.EVENT_ROW_DRAG_END,e),this.stopDragging(e)},h.prototype.stopDragging=function(e){this.ensureIntervalCleared(),e.dragItem.rowNode.setDragging(!1)},n([r.Autowired("dragAndDropService"),o("design:type",s.DragAndDropService)],h.prototype,"dragAndDropService",void 0),n([r.Autowired("rowModel"),o("design:type",Object)],h.prototype,"rowModel",void 0),n([r.Autowired("focusedCellController"),o("design:type",a.FocusedCellController)],h.prototype,"focusedCellController",void 0),n([r.Autowired("gridOptionsWrapper"),o("design:type",l.GridOptionsWrapper)],h.prototype,"gridOptionsWrapper",void 0),n([r.Optional("rangeController"),o("design:type",Object)],h.prototype,"rangeController",void 0),n([r.Autowired("eventService"),o("design:type",c.EventService)],h.prototype,"eventService",void 0),n([r.PostConstruct,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],h.prototype,"postConstruct",null),h);function h(e,t){this.eContainer=e,this.gridPanel=t}t.RowDragFeature=d},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(60),c=i(13),u=i(0),d=i(7),h=i(6),p=i(5),f=i(3),g=i(9),m=i(17),v=i(2),y=(s=c.BeanStub,o(b,s),b.prototype.postConstruct=function(){this.showOrHideSelectAll(),this.addDestroyableEventListener(this.eventService,p.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.showOrHideSelectAll.bind(this)),this.addDestroyableEventListener(this.eventService,p.Events.EVENT_SELECTION_CHANGED,this.onSelectionChanged.bind(this)),this.addDestroyableEventListener(this.eventService,p.Events.EVENT_MODEL_UPDATED,this.onModelChanged.bind(this)),this.addDestroyableEventListener(this.cbSelectAll,l.AgCheckbox.EVENT_CHANGED,this.onCbSelectAll.bind(this))},b.prototype.showOrHideSelectAll=function(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setVisible(this.cbSelectAllVisible),this.cbSelectAllVisible&&(this.checkRightRowModelType(),this.updateStateOfCheckbox())},b.prototype.onModelChanged=function(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()},b.prototype.onSelectionChanged=function(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()},b.prototype.getNextCheckboxState=function(e){return(0!==e.selected||0!==e.notSelected)&&(0<e.selected&&0<e.notSelected?null:0<e.selected)},b.prototype.updateStateOfCheckbox=function(){if(!this.processingEventFromCheckbox){this.processingEventFromCheckbox=!0;var e=this.getSelectionCount(),t=this.getNextCheckboxState(e);this.cbSelectAll.setSelected(t),this.processingEventFromCheckbox=!1}},b.prototype.getSelectionCount=function(){function e(e){e.isSelected()?t++:e.selectable&&i++}var t=0,i=0;return this.filteredOnly?this.gridApi.forEachNodeAfterFilter(e):this.gridApi.forEachNode(e),{notSelected:i,selected:t}},b.prototype.checkRightRowModelType=function(){var e=this.rowModel.getType();e===g.Constants.ROW_MODEL_TYPE_CLIENT_SIDE||console.log("ag-Grid: selectAllCheckbox is only available if using normal row model, you are using "+e)},b.prototype.onCbSelectAll=function(){this.processingEventFromCheckbox||this.cbSelectAllVisible&&(this.cbSelectAll.isSelected()?this.selectionController.selectAllRowNodes(this.filteredOnly):this.selectionController.deselectAllRowNodes(this.filteredOnly))},b.prototype.isCheckboxSelection=function(){var e=this.column.getColDef().headerCheckboxSelection;return"function"==typeof e&&(e=e({column:this.column,colDef:this.column.getColDef(),columnApi:this.columnApi,api:this.gridApi})),!(!e||(this.gridOptionsWrapper.isRowModelServerSide()?(console.warn("headerCheckboxSelection is not supported for Server Side Row Model"),1):this.gridOptionsWrapper.isRowModelInfinite()?(console.warn("headerCheckboxSelection is not supported for Infinite Row Model"),1):this.gridOptionsWrapper.isRowModelViewport()&&(console.warn("headerCheckboxSelection is not supported for Viewport Row Model"),1)))},r([u.Autowired("gridApi"),a("design:type",h.GridApi)],b.prototype,"gridApi",void 0),r([u.Autowired("columnApi"),a("design:type",d.ColumnApi)],b.prototype,"columnApi",void 0),r([u.Autowired("eventService"),a("design:type",f.EventService)],b.prototype,"eventService",void 0),r([u.Autowired("rowModel"),a("design:type",Object)],b.prototype,"rowModel",void 0),r([u.Autowired("selectionController"),a("design:type",m.SelectionController)],b.prototype,"selectionController",void 0),r([u.Autowired("gridOptionsWrapper"),a("design:type",v.GridOptionsWrapper)],b.prototype,"gridOptionsWrapper",void 0),r([u.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],b.prototype,"postConstruct",null),b);function b(e,t){var i=s.call(this)||this;i.cbSelectAllVisible=!1,i.processingEventFromCheckbox=!1,i.cbSelectAll=e;var n=(i.column=t).getColDef();return i.filteredOnly=!!n&&!!n.headerCheckboxSelectionFilteredOnly,i}t.SelectAllFeature=y},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(8),c=i(10),u=i(1),d=i(26),h=i(7),p=i(4),f=i(2),g=i(59),m=i(0),v=i(81),y=i(15),b=i(52),w=i(6),C=i(21),_=i(28),A=i(74),E=(s=l.Component,o(x,s),x.prototype.postConstruct=function(){v.CssClassApplier.addHeaderClassesFromColDef(this.columnGroup.getColGroupDef(),this.getGui(),this.gridOptionsWrapper,null,this.columnGroup);var e=this.columnController.getDisplayNameForColumnGroup(this.columnGroup,"header");this.appendHeaderGroupComp(e),this.setupResize(),this.addClasses(),this.setupWidth(),this.addAttributes(),this.setupMovingCss(),this.setupTooltip(),this.addFeature(this.context,new A.HoverFeature(this.columnGroup.getOriginalColumnGroup().getLeafColumns(),this.getGui()));var t=new b.SetLeftFeature(this.columnGroup,this.getGui(),this.beans);t.init(),this.addDestroyFunc(t.destroy.bind(t))},x.prototype.setupMovingCss=function(){var t=this;this.columnGroup.getOriginalColumnGroup().getLeafColumns().forEach(function(e){t.addDestroyableEventListener(e,c.Column.EVENT_MOVING_CHANGED,t.onColumnMovingChanged.bind(t))}),this.onColumnMovingChanged()},x.prototype.setupTooltip=function(){var e=this.columnGroup.getColGroupDef();e&&e.headerTooltip&&(this.getGui().title=e.headerTooltip)},x.prototype.onColumnMovingChanged=function(){this.columnGroup.isMoving()?u.Utils.addCssClass(this.getGui(),"ag-header-cell-moving"):u.Utils.removeCssClass(this.getGui(),"ag-header-cell-moving")},x.prototype.addAttributes=function(){this.getGui().setAttribute("col-id",this.columnGroup.getUniqueId())},x.prototype.appendHeaderGroupComp=function(e){var t=this,i={displayName:e,columnGroup:this.columnGroup,setExpanded:function(e){t.columnController.setColumnGroupOpened(t.columnGroup.getOriginalColumnGroup(),e,"gridInitializing")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsWrapper.getContext()};if(!e){var n=this.columnGroup.getLeafColumns();e=n?n[0].getColDef().headerName:""}var o=this.afterHeaderCompCreated.bind(this,e);this.componentRecipes.newHeaderGroupComponent(i).then(o)},x.prototype.afterHeaderCompCreated=function(e,t){this.appendChild(t),this.setupMove(t.getGui(),e),t.destroy&&this.addDestroyFunc(t.destroy.bind(t))},x.prototype.addClasses=function(){this.columnGroup.isPadding()?this.addCssClass("ag-header-group-cell-no-group"):this.addCssClass("ag-header-group-cell-with-group")},x.prototype.setupMove=function(e,t){var i=this;if(e&&!this.isSuppressMoving()){var n=this.columnGroup.getOriginalColumnGroup().getLeafColumns();if(e){var o={type:y.DragSourceType.HeaderCell,eElement:e,dragItemName:t,dragItemCallback:this.getDragItemForGroup.bind(this),dragSourceDropTarget:this.dragSourceDropTarget,dragStarted:function(){return n.forEach(function(e){return e.setMoving(!0,"uiColumnDragged")})},dragStopped:function(){return n.forEach(function(e){return e.setMoving(!1,"uiColumnDragged")})}};this.dragAndDropService.addDragSource(o,!0),this.addDestroyFunc(function(){return i.dragAndDropService.removeDragSource(o)})}}},x.prototype.getDragItemForGroup=function(){var t=this.columnGroup.getOriginalColumnGroup().getLeafColumns(),i={};t.forEach(function(e){return i[e.getId()]=e.isVisible()});var n=[];return this.columnController.getAllDisplayedColumns().forEach(function(e){0<=t.indexOf(e)&&(n.push(e),u.Utils.removeFromArray(t,e))}),t.forEach(function(e){return n.push(e)}),{columns:n,visibleState:i}},x.prototype.isSuppressMoving=function(){var t=!1;return this.columnGroup.getLeafColumns().forEach(function(e){(e.getColDef().suppressMovable||e.isLockPosition())&&(t=!0)}),t||this.gridOptionsWrapper.isSuppressMovableColumns()},x.prototype.setupWidth=function(){this.addListenersToChildrenColumns(),this.addDestroyableEventListener(this.columnGroup,d.ColumnGroup.EVENT_DISPLAYED_CHILDREN_CHANGED,this.onDisplayedChildrenChanged.bind(this)),this.onWidthChanged(),this.addDestroyFunc(this.destroyListenersOnChildrenColumns.bind(this))},x.prototype.onDisplayedChildrenChanged=function(){this.addListenersToChildrenColumns(),this.onWidthChanged()},x.prototype.addListenersToChildrenColumns=function(){var t=this;this.destroyListenersOnChildrenColumns();var i=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(function(e){e.addEventListener(c.Column.EVENT_WIDTH_CHANGED,i),e.addEventListener(c.Column.EVENT_VISIBLE_CHANGED,i),t.childColumnsDestroyFuncs.push(function(){e.removeEventListener(c.Column.EVENT_WIDTH_CHANGED,i),e.removeEventListener(c.Column.EVENT_VISIBLE_CHANGED,i)})})},x.prototype.destroyListenersOnChildrenColumns=function(){this.childColumnsDestroyFuncs.forEach(function(e){return e()}),this.childColumnsDestroyFuncs=[]},x.prototype.onWidthChanged=function(){this.getGui().style.width=this.columnGroup.getActualWidth()+"px"},x.prototype.setupResize=function(){var i=this;if(this.eHeaderCellResize=this.getRefElement("agResize"),this.columnGroup.isResizable()){var e=this.horizontalResizeService.addResizeBar({eResizeBar:this.eHeaderCellResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});this.addDestroyFunc(e),this.gridOptionsWrapper.isSuppressAutoSize()||this.eHeaderCellResize.addEventListener("dblclick",function(e){var t=[];i.columnGroup.getDisplayedLeafColumns().forEach(function(e){e.getColDef().suppressAutoSize||t.push(e.getColId())}),0<t.length&&i.columnController.autoSizeColumns(t,"uiColumnResized")})}else u.Utils.removeFromParent(this.eHeaderCellResize)},x.prototype.onResizeStart=function(e){var t=this,i=this.columnGroup.getDisplayedLeafColumns();this.resizeCols=u.Utils.filter(i,function(e){return e.isResizable()}),this.resizeStartWidth=0,this.resizeCols.forEach(function(e){return t.resizeStartWidth+=e.getActualWidth()}),this.resizeRatios=[],this.resizeCols.forEach(function(e){return t.resizeRatios.push(e.getActualWidth()/t.resizeStartWidth)});var n=null;if(e&&(n=this.columnController.getDisplayedGroupAfter(this.columnGroup)),n){var o=n.getDisplayedLeafColumns();this.resizeTakeFromCols=u.Utils.filter(o,function(e){return e.isResizable()}),this.resizeTakeFromStartWidth=0,this.resizeTakeFromCols.forEach(function(e){return t.resizeTakeFromStartWidth+=e.getActualWidth()}),this.resizeTakeFromRatios=[],this.resizeTakeFromCols.forEach(function(e){return t.resizeTakeFromRatios.push(e.getActualWidth()/t.resizeTakeFromStartWidth)})}else this.resizeTakeFromCols=null,this.resizeTakeFromStartWidth=null,this.resizeTakeFromRatios=null},x.prototype.onResizing=function(e,t){var i=[],n=this.normaliseDragChange(t);i.push({columns:this.resizeCols,ratios:this.resizeRatios,width:this.resizeStartWidth+n}),this.resizeTakeFromCols&&i.push({columns:this.resizeTakeFromCols,ratios:this.resizeTakeFromRatios,width:this.resizeTakeFromStartWidth-n}),this.columnController.resizeColumnSets(i,e,"uiColumnDragged")},x.prototype.normaliseDragChange=function(e){var t=e;return this.gridOptionsWrapper.isEnableRtl()?this.pinned!==c.Column.PINNED_LEFT&&(t*=-1):this.pinned===c.Column.PINNED_RIGHT&&(t*=-1),t},x.TEMPLATE='<div class="ag-header-group-cell"><div ref="agResize" class="ag-header-cell-resize"></div></div>',r([m.Autowired("gridOptionsWrapper"),a("design:type",f.GridOptionsWrapper)],x.prototype,"gridOptionsWrapper",void 0),r([m.Autowired("columnController"),a("design:type",p.ColumnController)],x.prototype,"columnController",void 0),r([m.Autowired("horizontalResizeService"),a("design:type",g.HorizontalResizeService)],x.prototype,"horizontalResizeService",void 0),r([m.Autowired("dragAndDropService"),a("design:type",y.DragAndDropService)],x.prototype,"dragAndDropService",void 0),r([m.Autowired("context"),a("design:type",m.Context)],x.prototype,"context",void 0),r([m.Autowired("componentRecipes"),a("design:type",C.ComponentRecipes)],x.prototype,"componentRecipes",void 0),r([m.Autowired("gridApi"),a("design:type",w.GridApi)],x.prototype,"gridApi",void 0),r([m.Autowired("columnApi"),a("design:type",h.ColumnApi)],x.prototype,"columnApi",void 0),r([m.Autowired("beans"),a("design:type",_.Beans)],x.prototype,"beans",void 0),r([m.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],x.prototype,"postConstruct",null),x);function x(e,t,i){var n=s.call(this,x.TEMPLATE)||this;return n.childColumnsDestroyFuncs=[],n.columnGroup=e,n.dragSourceDropTarget=t,n.pinned=i,n}t.HeaderGroupWrapperComp=E},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultColumnTypes={numericColumn:{headerClass:"ag-numeric-header",cellClass:"ag-numeric-cell"}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(85);function n(e,t,i,n){var o,r,a=n.agGrid;if(r=a+".quickFilterText",o=t.$eval(a)){var s=e[0],l={$scope:t,$compile:i,quickFilterOnScope:r},c=new u.Grid(s,o,l);t.$on("$destroy",function(){c.destroy(),c=null})}else console.warn("WARNING - grid options for ag-Grid not found. Please ensure the attribute ag-grid points to a valid object on the scope")}t.initialiseAgGridWithAngular1=function(e){e.module("agGrid",[]).directive("agGrid",function(){return{restrict:"A",controller:["$element","$scope","$compile","$attrs",n],scope:!0}})}},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=this&&this.__param||function(i,n){return function(e,t){n(e,t,i)}};Object.defineProperty(t,"__esModule",{value:!0});var l,c=i(0),u=i(3),d=i(5),h=i(12),p=i(137),f=i(87),g=i(6),m=i(7),v=(l=f.RowNodeCache,o(y,l),y.prototype.setBeans=function(e){this.logger=e.create("InfiniteCache")},y.prototype.init=function(){l.prototype.init.call(this),this.getRow(0)},y.prototype.moveItemsDown=function(e,t,i){for(var n=e.getStartRow(),o=t+i,r=e.getEndRow()-1;n<=r;r--)if(!(r<o)){var a=r-i,s=this.getRow(a,!0);s?e.setRowNode(r,s):(e.setBlankRowNode(r),e.setDirty())}},y.prototype.insertItems=function(e,t,i){for(var n=e.getStartRow(),o=e.getEndRow(),r=[],a=0;a<i.length;a++){var s=t+a;if(n<=s&&s<o){var l=i[a],c=e.setNewData(s,l);r.push(c)}}return r},y.prototype.insertItemsAtIndex=function(t,i){var n=this,o=[];this.forEachBlockInReverseOrder(function(e){e.getEndRow()<=t||(n.moveItemsDown(e,t,i.length),n.insertItems(e,t,i).forEach(function(e){return o.push(e)}))}),this.isMaxRowFound()&&this.hack_setVirtualRowCount(this.getVirtualRowCount()+i.length),this.onCacheUpdated();var e={type:d.Events.EVENT_ROW_DATA_UPDATED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(e)},y.prototype.getRow=function(e,t){void 0===t&&(t=!1);var i=Math.floor(e/this.cacheParams.blockSize),n=this.getBlock(i);if(!n){if(t)return null;n=this.createBlock(i)}return n.getRow(e)},y.prototype.createBlock=function(e){var t=new p.InfiniteBlock(e,this.cacheParams);return this.context.wireBean(t),this.postCreateBlock(t),t},y.prototype.refreshCache=function(){this.forEachBlockInOrder(function(e){return e.setDirty()}),this.checkBlockToLoad()},r([c.Autowired("eventService"),a("design:type",u.EventService)],y.prototype,"eventService",void 0),r([c.Autowired("context"),a("design:type",c.Context)],y.prototype,"context",void 0),r([c.Autowired("columnApi"),a("design:type",m.ColumnApi)],y.prototype,"columnApi",void 0),r([c.Autowired("gridApi"),a("design:type",g.GridApi)],y.prototype,"gridApi",void 0),r([s(0,c.Qualifier("loggerFactory")),a("design:type",Function),a("design:paramtypes",[h.LoggerFactory]),a("design:returntype",void 0)],y.prototype,"setBeans",null),r([c.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],y.prototype,"init",null),y);function y(e){return l.call(this,e)||this}t.InfiniteCache=v},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(1),c=i(2),u=i(0),d=i(61),h=i(20),p=(s=d.RowNodeBlock,o(f,s),f.prototype.createBlankRowNode=function(e){var t=s.prototype.createBlankRowNode.call(this,e);return t.uiLevel=0,this.setIndexAndTopOnRowNode(t,e),t},f.prototype.setDataAndId=function(e,t,i){l.Utils.exists(t)?e.setDataAndId(t,i.toString()):e.setDataAndId(void 0,void 0)},f.prototype.setRowNode=function(e,t){s.prototype.setRowNode.call(this,e,t),this.setIndexAndTopOnRowNode(t,e)},f.prototype.init=function(){s.prototype.init.call(this,{context:this.context,rowRenderer:this.rowRenderer})},f.prototype.getNodeIdPrefix=function(){return null},f.prototype.getRow=function(e){return this.getRowUsingLocalIndex(e)},f.prototype.setIndexAndTopOnRowNode=function(e,t){e.setRowIndex(t),e.rowTop=this.cacheParams.rowHeight*t},f.prototype.loadFromDatasource=function(){var e=this,t={startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this),sortModel:this.cacheParams.sortModel,filterModel:this.cacheParams.filterModel,context:this.gridOptionsWrapper.getContext()};l.Utils.missing(this.cacheParams.datasource.getRows)?console.warn("ag-Grid: datasource is missing getRows method"):(1<l.Utils.getFunctionParameters(this.cacheParams.datasource.getRows).length&&(console.warn("ag-grid: It looks like your paging datasource is of the old type, taking more than one parameter."),console.warn("ag-grid: From ag-grid 1.9.0, now the getRows takes one parameter. See the documentation for details.")),setTimeout(function(){e.cacheParams.datasource.getRows(t)},0))},r([u.Autowired("gridOptionsWrapper"),a("design:type",c.GridOptionsWrapper)],f.prototype,"gridOptionsWrapper",void 0),r([u.Autowired("context"),a("design:type",u.Context)],f.prototype,"context",void 0),r([u.Autowired("rowRenderer"),a("design:type",h.RowRenderer)],f.prototype,"rowRenderer",void 0),r([u.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],f.prototype,"init",null),f);function f(e,t){var i=s.call(this,e,t)||this;return i.cacheParams=t,i}t.InfiniteBlock=p},function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(14),a=i(88),s=i(2),l=i(3),c=i(0),u=i(4),d=(h.prototype.create=function(e){var t=new r.RowNode,i=new a.ClientSideNodeManager(t,this.gridOptionsWrapper,this.context,this.eventService,this.columnController);return this.context.wireBean(t),i.setRowData(e),t},n([c.Autowired("gridOptionsWrapper"),o("design:type",s.GridOptionsWrapper)],h.prototype,"gridOptionsWrapper",void 0),n([c.Autowired("eventService"),o("design:type",l.EventService)],h.prototype,"eventService",void 0),n([c.Autowired("context"),o("design:type",c.Context)],h.prototype,"context",void 0),n([c.Autowired("columnController"),o("design:type",u.ColumnController)],h.prototype,"columnController",void 0),h=n([c.Bean("rowNodeFactory")],h));function h(){}t.RowNodeFactory=d},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(0),c=i(2),u=i(89),d=i(20),h=i(3),p=i(9),f=i(13),g=i(5),m=(s=f.BeanStub,o(v,s),v.prototype.init=function(){this.rowModel.getType()===p.Constants.ROW_MODEL_TYPE_CLIENT_SIDE&&(this.clientSideRowModel=this.rowModel),this.addDestroyableEventListener(this.eventService,g.Events.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged.bind(this))},v.prototype.onCellValueChanged=function(e){this.doChangeDetection(e.node,e.column)},v.prototype.doChangeDetection=function(e,t){if(!this.gridOptionsWrapper.isSuppressChangeDetection()){if(this.clientSideRowModel&&!e.isRowPinned()){var i=this.gridOptionsWrapper.isAggregateOnlyChangedColumns(),n=new u.ChangedPath(i);n.addParentNode(e.parent,[t]),this.clientSideRowModel.doAggregate(n)}this.rowRenderer.refreshCells()}},r([l.Autowired("gridOptionsWrapper"),a("design:type",c.GridOptionsWrapper)],v.prototype,"gridOptionsWrapper",void 0),r([l.Autowired("rowModel"),a("design:type",Object)],v.prototype,"rowModel",void 0),r([l.Autowired("rowRenderer"),a("design:type",d.RowRenderer)],v.prototype,"rowRenderer",void 0),r([l.Autowired("eventService"),a("design:type",h.EventService)],v.prototype,"eventService",void 0),r([l.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],v.prototype,"init",null),v=r([l.Bean("changeDetectionService")],v));function v(){return null!==s&&s.apply(this,arguments)||this}t.ChangeDetectionService=m},function(e,t,i){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(r<3?o(a):3<r?o(t,i,a):o(t,i))||a);return 3<r&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(8),c=i(0),u=i(2),d=i(11),h=i(1),p=i(3),f=i(5),g=i(20),m=i(29),v=(s=l.Component,o(y,s),y.prototype.postConstruct=function(){this.setTemplate(this.getTemplate()),this.gridOptionsWrapper.isPagination()&&!this.gridOptionsWrapper.isSuppressPaginationPanel()?(this.addDestroyableEventListener(this.eventService,f.Events.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addDestroyableEventListener(this.btFirst,"click",this.onBtFirst.bind(this)),this.addDestroyableEventListener(this.btLast,"click",this.onBtLast.bind(this)),this.addDestroyableEventListener(this.btNext,"click",this.onBtNext.bind(this)),this.addDestroyableEventListener(this.btPrevious,"click",this.onBtPrevious.bind(this)),this.onPaginationChanged()):this.setVisible(!1)},y.prototype.onPaginationChanged=function(){this.enableOrDisableButtons(),this.updateRowLabels(),this.setCurrentPageLabel(),this.setTotalLabels()},y.prototype.setCurrentPageLabel=function(){var e=0<this.paginationProxy.getTotalPages(),t=this.paginationProxy.getCurrentPage(),i=e?t+1:0;this.lbCurrent.innerHTML=this.formatNumber(i)},y.prototype.formatNumber=function(e){var t=this.gridOptionsWrapper.getPaginationNumberFormatterFunc();return t?t({value:e}):h._.formatNumberCommas(e)},y.prototype.getTemplate=function(){var e=this.gridOptionsWrapper.getLocaleTextFunc(),t=e("page","Page"),i=e("to","to"),n=e("of","of");return'<div class="ag-paging-panel ag-font-style">\n                <span ref="eSummaryPanel" class="ag-paging-row-summary-panel">\n                    <span ref="lbFirstRowOnPage"></span> '+i+' <span ref="lbLastRowOnPage"></span> '+n+' <span ref="lbRecordCount"></span>\n                </span>\n                <span class="ag-paging-page-summary-panel">\n                    <button type="button" class="ag-paging-button" ref="btFirst">'+e("first","First")+'</button>\n                    <button type="button" class="ag-paging-button" ref="btPrevious">'+e("previous","Previous")+"</button>\n                    "+t+' <span ref="lbCurrent"></span> '+n+' <span ref="lbTotal"></span>\n                    <button type="button" class="ag-paging-button" ref="btNext">'+e("next","Next")+'</button>\n                    <button type="button" class="ag-paging-button" ref="btLast">'+e("last","Last")+"</button>\n                </span>\n            </div>"},y.prototype.onBtNext=function(){this.paginationProxy.goToNextPage()},y.prototype.onBtPrevious=function(){this.paginationProxy.goToPreviousPage()},y.prototype.onBtFirst=function(){this.paginationProxy.goToFirstPage()},y.prototype.onBtLast=function(){this.paginationProxy.goToLastPage()},y.prototype.enableOrDisableButtons=function(){var e=this.paginationProxy.getCurrentPage(),t=this.paginationProxy.isLastPageFound(),i=this.paginationProxy.getTotalPages(),n=0===e;this.btPrevious.disabled=n,this.btFirst.disabled=n;var o=this.isZeroPagesToDisplay(),r=t&&e===i-1||o;this.btNext.disabled=r;var a=!t||o||e===i-1;this.btLast.disabled=a},y.prototype.updateRowLabels=function(){var e,t,i=this.paginationProxy.getCurrentPage(),n=this.paginationProxy.getPageSize(),o=this.paginationProxy.isLastPageFound(),r=this.paginationProxy.isLastPageFound()?this.paginationProxy.getTotalRowCount():null;this.isZeroPagesToDisplay()?t=e=0:(t=(e=n*i+1)+n-1,o&&r<t&&(t=r)),this.lbFirstRowOnPage.innerHTML=this.formatNumber(e),this.lbLastRowOnPage.innerHTML=this.formatNumber(t)},y.prototype.isZeroPagesToDisplay=function(){var e=this.paginationProxy.isLastPageFound(),t=this.paginationProxy.getTotalPages();return e&&0===t},y.prototype.setTotalLabels=function(){var e=this.paginationProxy.isLastPageFound(),t=this.paginationProxy.getTotalPages(),i=this.paginationProxy.isLastPageFound()?this.paginationProxy.getTotalRowCount():null;if(e)this.lbTotal.innerHTML=this.formatNumber(t),this.lbRecordCount.innerHTML=this.formatNumber(i);else{var n=this.gridOptionsWrapper.getLocaleTextFunc()("more","more");this.lbTotal.innerHTML=n,this.lbRecordCount.innerHTML=n}},r([c.Autowired("gridOptionsWrapper"),a("design:type",u.GridOptionsWrapper)],y.prototype,"gridOptionsWrapper",void 0),r([c.Autowired("eventService"),a("design:type",p.EventService)],y.prototype,"eventService",void 0),r([c.Autowired("paginationProxy"),a("design:type",m.PaginationProxy)],y.prototype,"paginationProxy",void 0),r([c.Autowired("rowRenderer"),a("design:type",g.RowRenderer)],y.prototype,"rowRenderer",void 0),r([d.RefSelector("btFirst"),a("design:type",HTMLButtonElement)],y.prototype,"btFirst",void 0),r([d.RefSelector("btPrevious"),a("design:type",HTMLButtonElement)],y.prototype,"btPrevious",void 0),r([d.RefSelector("btNext"),a("design:type",HTMLButtonElement)],y.prototype,"btNext",void 0),r([d.RefSelector("btLast"),a("design:type",HTMLButtonElement)],y.prototype,"btLast",void 0),r([d.RefSelector("lbRecordCount"),a("design:type",Object)],y.prototype,"lbRecordCount",void 0),r([d.RefSelector("lbFirstRowOnPage"),a("design:type",Object)],y.prototype,"lbFirstRowOnPage",void 0),r([d.RefSelector("lbLastRowOnPage"),a("design:type",Object)],y.prototype,"lbLastRowOnPage",void 0),r([d.RefSelector("eSummaryPanel"),a("design:type",Object)],y.prototype,"eSummaryPanel",void 0),r([d.RefSelector("lbCurrent"),a("design:type",Object)],y.prototype,"lbCurrent",void 0),r([d.RefSelector("lbTotal"),a("design:type",Object)],y.prototype,"lbTotal",void 0),r([c.PostConstruct,a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],y.prototype,"postConstruct",null),y);function y(){return s.call(this)||this}t.PaginationComp=v},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(62),o=i(85),r=!1;t.initialiseAgGridWithWebComponents=function(){if(console.warn("ag-grid: initialiseAgGridWithWebComponents is deprecated. Please use the ag-grid-webcomponent dependency instead. "),!r){r=!0,"undefined"!=typeof document&&document.registerElement||console.error("ag-Grid: unable to find document.registerElement() function, unable to initialise ag-Grid as a Web Component");var e=Object.create(HTMLElement.prototype);n.ComponentUtil.ALL_PROPERTIES.forEach(function(t){Object.defineProperty(e,t,{set:function(e){this.__agGridSetProperty(t,e)},get:function(){return this.__agGridGetProperty(t)},enumerable:!0,configurable:!0})});var t=e;t.__agGridSetProperty=function(e,t){this.__attributes||(this.__attributes={}),this.__attributes[e]=t;var i={};i[e]={currentValue:t},this.onChange(i)},t.onChange=function(e){this._initialised&&n.ComponentUtil.processOnChange(e,this._gridOptions,this.api,this.columnApi)},t.__agGridGetProperty=function(e){return this.__attributes||(this.__attributes={}),this.__attributes[e]},t.setGridOptions=function(e){var t=this.globalEventListener.bind(this);this._gridOptions=n.ComponentUtil.copyAttributesToGridOptions(e,this);var i={globalEventListener:t};this._agGrid=new o.Grid(this,this._gridOptions,i),this.api=e.api,this.columnApi=e.columnApi,this._initialised=!0},t.createdCallback=function(){for(var e=0;e<this.attributes.length;e++){var t=this.attributes[e];this.setPropertyFromAttribute(t)}},t.setPropertyFromAttribute=function(e){var t=function(e){{return"string"!=typeof e?e:e.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})}}(e.nodeName),i=e.nodeValue;0<=n.ComponentUtil.ALL_PROPERTIES.indexOf(t)&&(this[t]=i)},t.attachedCallback=function(e){},t.detachedCallback=function(e){},t.attributeChangedCallback=function(e){var t=this.attributes[e];this.setPropertyFromAttribute(t)},t.globalEventListener=function(e,t){var i=e.toLowerCase(),n=new Event(i);n.agGridDetails=t,this.dispatchEvent(n);var o="on"+i;"function"==typeof this[o]&&this[o](n)},document.registerElement("ag-grid",{prototype:e})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(1),n=(r.prototype.setAfterAttachedParams=function(e){this.afterAttachedParams=e},r.prototype.getMinWidth=function(){var i=document.createElement("span");i.style.position="fixed",this.eGui.appendChild(i);var n=0;return this.items.forEach(function(e){o.Utils.removeAllChildren(i);var t=e.tabbedItem.bodyPromise.resolveNow(null,function(e){return e.cloneNode(!0)});null!=t&&(i.appendChild(t),n<i.offsetWidth&&(n=i.offsetWidth))}),this.eGui.removeChild(i),n},r.prototype.showFirstItem=function(){0<this.items.length&&this.showItemWrapper(this.items[0])},r.prototype.addItem=function(e){var t=document.createElement("span");t.appendChild(e.title),o.Utils.addCssClass(t,"ag-tab"),this.eHeader.appendChild(t);var i={tabbedItem:e,eHeaderButton:t};this.items.push(i),t.addEventListener("click",this.showItemWrapper.bind(this,i))},r.prototype.showItem=function(t){var e=o.Utils.find(this.items,function(e){return e.tabbedItem===t});e&&this.showItemWrapper(e)},r.prototype.showItemWrapper=function(e){var t=this;this.params.onItemClicked&&this.params.onItemClicked({item:e.tabbedItem}),this.activeItem!==e?(o.Utils.removeAllChildren(this.eBody),e.tabbedItem.bodyPromise.then(function(e){t.eBody.appendChild(e)}),this.activeItem&&o.Utils.removeCssClass(this.activeItem.eHeaderButton,"ag-tab-selected"),o.Utils.addCssClass(e.eHeaderButton,"ag-tab-selected"),(this.activeItem=e).tabbedItem.afterAttachedCallback&&e.tabbedItem.afterAttachedCallback(this.afterAttachedParams)):o.Utils.callIfPresent(this.params.onActiveItemClicked)},r.prototype.getGui=function(){return this.eGui},r.TEMPLATE='<div><div ref="tabHeader" class="ag-tab-header"></div><div ref="tabBody" class="ag-tab-body"></div></div>',r);function r(e){var t=this;this.items=[],this.params=e,this.eGui=document.createElement("div"),this.eGui.innerHTML=r.TEMPLATE,this.eHeader=this.eGui.querySelector('[ref="tabHeader"]'),this.eBody=this.eGui.querySelector('[ref="tabBody"]'),o.Utils.addCssClass(this.eGui,e.cssClass),e.items&&e.items.forEach(function(e){return t.addItem(e)})}t.TabbedLayout=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o.prototype.addPanel=function(e,t){var i;i=e.isLayoutPanel?(this.childPanels.push(e),e.getGui()):e,t&&(i.style.height=t),this.eGui.appendChild(i)},o.prototype.getGui=function(){return this.eGui},o.prototype.doLayout=function(){for(var e=0;e<this.childPanels.length;e++)this.childPanels[e].doLayout()},o);function o(){this.isLayoutPanel=!0,this.childPanels=[],this.eGui=document.createElement("div"),this.eGui.style.height="100%"}t.VerticalStack=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1);t.simpleHttpRequest=function(e){return new n.Promise(function(t){var i=new XMLHttpRequest;i.open("GET",e.url),i.send(),i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){var e=JSON.parse(i.responseText);t(e)}}})}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i(1);t.defaultGroupComparator=function(e,t,i,n,o){void 0===o&&(o=!1),console.warn("ag-Grid: Since ag-grid 11.0.0 defaultGroupComparator is not necessary. You can remove this from your colDef");var r=l.Utils.exists(i)&&i.group,a=l.Utils.exists(n)&&n.group,s=!r&&!a;return r&&a?l.Utils.defaultComparator(i.key,n.key,o):s?l.Utils.defaultComparator(e,t,o):r?1:-1}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o.prototype.wrap=function(e,t,i,n){var o=this,r=this.createWrapper(e,n);return t.forEach(function(e){o.createMethod(r,e,!0)}),i&&i.forEach(function(e){o.createMethod(r,e,!1)}),r},o.prototype.createMethod=function(e,t,i){e.addMethod(t,this.createMethodProxy(e,t,i))},o.prototype.createMethodProxy=function(e,t,i){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(i&&console.warn("ag-Grid: Framework component is missing the method "+t+"()"),null)}},o);function o(){}t.BaseComponentWrapper=n}],Pcg.c=Ocg,Pcg.d=function(e,t,i){Pcg.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},Pcg.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return Pcg.d(t,"a",t),t},Pcg.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Pcg.p="",Pcg(Pcg.s=119);function Pcg(e){if(Ocg[e])return Ocg[e].exports;var t=Ocg[e]={i:e,l:!1,exports:{}};return Ncg[e].call(t.exports,t,t.exports,Pcg),t.l=!0,t.exports}var Ncg,Ocg}),function(){var t=function(e){var n={};return _.each(e,function(e,i){_.isPlainObject(e)?_.each(t(e),function(e,t){n[i+"."+t]=e}):n[i]=e}),n};$.i18n.load(t(window.I18n)),window.t=function(){return $.i18n._.apply($.i18n,Array.prototype.slice.call(arguments))}}(),AGN=window.AGN||(window.AGN={}),AGN.Initializers=window.AGN.Initializers||(window.AGN.Initializers={}),AGN.Lib=window.AGN.Lib||(window.AGN.Lib={}),AGN.Lib.WM=window.AGN.Lib.WM||(window.AGN.Lib.WM={}),AGN.Opt=window.AGN.Opt||(window.AGN.Opt={}),AGN.Opt.Fields=window.AGN.Opt.Fields||(window.AGN.Opt.Fields={}),AGN.Opt.Forms=window.AGN.Opt.Forms||(window.AGN.Opt.Forms={}),AGN.Opt.Controllers=window.AGN.Opt.Controllers||(window.AGN.Opt.Controllers={}),AGN.Opt.Templates=window.AGN.Opt.Templates||(window.AGN.Opt.Templates={}),AGN.Opt.TableCellRenderers=window.AGN.Opt.TableCellRenderers||(window.AGN.Opt.TableCellRenderers={}),AGN.Opt.Charts=window.AGN.Opt.Charts||(window.AGN.Opt.Charts={}),AGN.Opt.Validators=window.AGN.Opt.Validators||(window.AGN.Opt.Validators={}),AGN.url=function(e,t){return window.agnResolveRelativeUrl?(e&&"/"===e.charAt(0)&&(e=e.substring(1)),window.agnResolveRelativeUrl(e,t)):(console.error("window.agnResolveRelativeUrl is not defined"),e)},AGN.runAll=function(i){$.each(AGN.Initializers,function(e,t){t.call(t,i)}),AGN.Lib.DomInitializer.autorun(i)},ace.config.set("basePath",AGN.url("assets/js/vendor/ace_20.12.14")),ace.config.setDefaultValue("session","useWorker",!1),function(){var t=ace.require("ace/snippets").snippetManager;ace.require("ace/config");ace.config.loadModule("ace/snippets/html",function(e){e&&t.files&&((t.files.html=e).snippets=t.parseSnippetFile(e.snippetText),e.snippets.push({content:'[agnALTER column="${1}"]',name:"agn:ALTER",tabTrigger:"alt"},{content:'[agnBANNER banner="${1}" banner="${2}"]',name:"agn:BANNER",tabTrigger:"bnr"},{content:'[agnCALC column="${1}" op="${2}" value="${3}"]',name:"agn:CALC",tabTrigger:"clc"},{content:'[agnCUSTOMDATE offset="${1}" format="${2}"]',name:"agn:CUSTOMDATE",tabTrigger:"cusd"},{content:'[agnCUSTOMDATE_DE offset="${1}" format="${2}"]',name:"agn:CUSTOMDATE_DE",tabTrigger:"cust"},{content:"[agnCUSTOMERID]",name:"agn:CUSTOMERID",tabTrigger:"cst"},{content:"[agnDATE]",name:"agn:DATE",tabTrigger:"dte"},{content:'[agnDATEDB column="${1}" format="${2}"]',name:"agn:DATEDB",tabTrigger:"datb"},{content:'[agnDATEDB_DE column="${1}" format="${2}"]',name:"agn:DATEDB_DE",tabTrigger:"dadb"},{content:'[agnDAYS_UNTIL column="${1}"]',name:"agn:DAYS_UNTIL",tabTrigger:"daunt"},{content:'[agnDAYS_UNTILL column="${1}"]',name:"agn:DAYS_UNTILL",tabTrigger:"duti"},{content:'[agnDB column="${1}"]',name:"agn:DB",tabTrigger:"db"},{content:"[agnDBV]",name:"agn:DBV",tabTrigger:"dbv"},{content:"[agnEMAIL]",name:"agn:EMAIL",tabTrigger:"ema"},{content:'[agnFORM name="${1}"]',name:"agn:FORM",tabTrigger:"form"},{content:'[agnIMAGE name="${1}"]',name:"agn:IMAGE",tabTrigger:"img"},{content:'[agnIMGLINK name="${1}"]',name:"agn:IMGLINK",tabTrigger:"imgli"},{content:"[agnNULL]",name:"agn:NULL",tabTrigger:"nul"},{content:"[agnPROFILE]",name:"agn:PROFILE",tabTrigger:"prof"},{content:"[agnSUBSCRIBERCOUNT]",name:"agn:SUBSCRIBERCOUNT",tabTrigger:"subs"},{content:'[agnSWYN networks="${1}" title="${2}"]',name:"agn:SWYN",tabTrigger:"swy"},{content:'[agnTITLE type="${1:2}"]',name:"agn:TITLE",tabTrigger:"ti"},{content:'[agnTITLEFIRST type="${1:2}"]',name:"agn:TITLEFIRST",tabTrigger:"tifr"},{content:'[agnTITLEFULL type="${1:2}"]',name:"agn:TITLEFULL",tabTrigger:"tifu"},{content:'[agnTITLE_SHORT type="${1:2}"]',name:"agn:TITLE_SHORT",tabTrigger:"tish"},{content:"[agnUNSUBSCRIBE]",name:"agn:UNSUBSCRIBE",tabTrigger:"unsub"},{content:'[agnDYN name="${1}"/]',name:"agn:DYN",tabTrigger:"dyn"},{content:"BIRTHDAY",name:"birthday",tabTrigger:"h"},{content:"CREATION_DATE",name:"creation_date",tabTrigger:"h"},{content:"CUSTOMER_ID",name:"customer_id",tabTrigger:"h"},{content:"DATASOURCE_ID",name:"datasource_id",tabTrigger:"h"},{content:"EMAIL",name:"email",tabTrigger:"h"},{content:"FACEBOOK_STATUS",name:"facebook_status",tabTrigger:"h"},{content:"FIRSTNAME",name:"firstname",tabTrigger:"h"},{content:"FOURSQUARE_STATUS",name:"foursquare_status",tabTrigger:"h"},{content:"GENDER",name:"gender",tabTrigger:"h"},{content:"GOOGLE_STATUS",name:"google_status",tabTrigger:"h"},{content:"LASTNAME",name:"lastname",tabTrigger:"h"},{content:"MAILTYPE",name:"mailtype",tabTrigger:"h"},{content:"ML_FEHLDATEN",name:"ml_fehldaten",tabTrigger:"h"},{content:"TIMESTAMP",name:"timestamp",tabTrigger:"h"},{content:"TITLE",name:"title",tabTrigger:"h"},{content:"TWITTER_STATUS",name:"twitter_status",tabTrigger:"h"},{content:"XING_STATUS",name:"xing_status",tabTrigger:"h"},{content:"HTML-Version",name:"html-version",tabTrigger:"h"},{content:"Text",name:"text",tabTrigger:"h"}),t.register(e.snippets,e.scope))})}(),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){"use strict";if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,i=Object(this),n=i.length>>>0,o=arguments[1],r=0;r<n;r++)if(t=i[r],e.call(o,t,r,i))return t}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){"use strict";if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,i=Object(this),n=i.length>>>0,o=arguments[1],r=0;r<n;r++)if(t=i[r],e.call(o,t,r,i))return r;return-1},enumerable:!1,configurable:!1,writable:!1}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if(0==n)return!1;for(var o,r,a=0|t,s=Math.max(0<=a?a:n-Math.abs(a),0);s<n;){if((o=i[s])===(r=e)||"number"==typeof o&&"number"==typeof r&&isNaN(o)&&isNaN(r))return!0;s++}return!1}}),function(){var i=$.ui.dialog.prototype._allowInteraction;$.ui.dialog.prototype._allowInteraction=function(e){var t=$(e.target);return!(!t.closest(".cke_dialog").length&&!t.closest(".cke_panel_frame").length)||i.apply(this,arguments)}}(),Function.prototype.bind&&window.console&&"object"==typeof console.log&&["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(e){console[e]=this.bind(console[e],console)},Function.prototype.call),function(e,t){"object"==typeof exports?module.exports=t(e):"function"==typeof define&&define.amd?define([],t.bind(e,e)):t(e)}("undefined"!=typeof global?global:this,function(e){if(e.CSS&&e.CSS.escape)return e.CSS.escape;function t(e){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var t,i=String(e),n=i.length,o=-1,r="",a=i.charCodeAt(0);++o<n;)0!=(t=i.charCodeAt(o))?r+=1<=t&&t<=31||127==t||0==o&&48<=t&&t<=57||1==o&&48<=t&&t<=57&&45==a?"\\"+t.toString(16)+" ":(0!=o||1!=n||45!=t)&&(128<=t||45==t||95==t||48<=t&&t<=57||65<=t&&t<=90||97<=t&&t<=122)?i.charAt(o):"\\"+i.charAt(o):r+="";return r}return e.CSS||(e.CSS={}),e.CSS.escape=t}),function(t){t.fn.modal.Constructor.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(e){setTimeout(t.proxy(function(){27==e.which&&this.hide()},this),100)},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")}}(jQuery),function(e){e.fn.all?console.error("$.fn.all is already defined"):e.fn.extend({all:function(e){return this.filter(e).add(this.find(e))}}),e.fn.exists?console.error("$.fn.exists is already defined"):e.fn.extend({exists:function(){return 0<this.length}}),e.fn.json?console.error("$.fn.json is already defined"):e.fn.extend({json:function(){return JSON.parse(this.html())}})}(jQuery),function(t){t.fn.extend({ensureLoad:function(e){return this.each(function(){this.complete?e.call(this):t(this).load(e)})}})}(jQuery),$.extend(!0,$.inputmask.defaults.aliases,{datetime:{regex:{quartspre:new RegExp("0|1|3|4"),quartspost:new RegExp("00|15|30|45"),halfspre:new RegExp("0|3"),halfspost:new RegExp("00|30")},definitions:{q:{validator:function(e,t,i,n,o){var r=o.regex.quartspost.test(e);return!(!n&&!r)||(o.regex.quartspost.test(e[0]+"5")?{c:"5"}:{c:"0"})},cardinality:2,prevalidator:[{validator:function(e,t,i,n,o){o.regex.quartspre.test(e);if(!1,n)return!0;for(var r,a=parseInt(e+"0"),s=["00","15","30","45"],l=100,c=0;c<s.length;c++){var u=s[c];parsedNum=parseInt(u),Math.abs(parsedNum-a)<l&&(l=Math.abs(parsedNum-a),r=u)}return{caret:i+2,insert:[{pos:i,c:r[0]},{pos:i+1,c:r[1]}]}},cardinality:1}]},u:{validator:function(e,t,i,n,o){var r=o.regex.halfspost.test(e);return!(!n&&!r)||{c:"0"}},cardinality:2,prevalidator:[{validator:function(e,t,i,n,o){o.regex.halfspre.test(e);if(!1,n)return!0;for(var r,a=parseInt(e+"0"),s=["00","30"],l=100,c=0;c<s.length;c++){var u=s[c];parsedNum=parseInt(u),Math.abs(parsedNum-a)<l&&(l=Math.abs(parsedNum-a),r=u)}return{caret:i+2,insert:[{pos:i,c:r[0]},{pos:i+1,c:r[1]}]}},cardinality:1}]}}},"h:quarts t":{mask:"h:q t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"h:quarts":{mask:"h:q",placeholder:"hh:mm",alias:"datetime",hourFormat:"24"},"h:halfs t":{mask:"h:u t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"h:halfs":{mask:"h:u",placeholder:"hh:mm",alias:"datetime",hourFormat:"24"},"h:00 t":{mask:"h:00 t\\m",placeholder:"hh:00 xm",alias:"datetime",hourFormat:"12"},"h:00":{mask:"h:00",placeholder:"hh:00",alias:"datetime",hourFormat:"24"}}),$.fn.serializeObject=function(){var e={};return $.each(this.serializeArray(),function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},$.fn.serializeFormDataObject=function(){var i=this.serializeObject();return this.find("input[type=file]").each(function(){if(!$(this).is(":disabled")&&this.name){var e=this.files;if(0==e.length&&(e=[new File([],"",{type:"application/octet-stream"})]),i[this.name]){var t=i[this.name];$.isArray(t)?i[this.name]=t.concat(e):i[this.name]=[t].concat(e)}else 1<e.length?i[this.name]=e:i[this.name]=e[0]}}),i},function(e){e.fn.style?console.error("$.fn.style is already defined"):e.fn.extend({style:function(t,i,n){if(void 0===i)return this.css(t);e.isFunction(i)?this.each(function(){if(this.style){var e=i.call(this,this.style.getPropertyValue(t));this.style.setProperty(t,e,n)}}):this.each(function(){this.style&&this.style.setProperty(t,i,n)})}})}(jQuery),function(e){String.prototype.trim&&(e.trim=function(e){return null==e?"":(e+"").trim()})}(jQuery),$.widget("ui.dialog",$.extend({},$.ui.dialog.prototype,{_title:function(e){this.options.title||e.html("&#160;"),e.html(this.options.title)}})),_.templateSettings={evaluate:/\{\{(.+?)\}\}/g,interpolate:/\{\{=(.+?)\}\}/g,escape:/\{\{-(.+?)\}\}/g},jQuery.extend(jQuery.fn.pickadate.defaults,{monthsFull:t("date.monthsFull"),monthsShort:t("date.monthsShort"),weekdaysFull:t("date.weekdaysFull"),weekdaysShort:t("date.weekdaysShort"),labelMonthNext:t("date.nextMonth"),labelMonthPrev:t("date.prevMonth"),labelMonthSelect:t("date.selectMonth"),labelYearSelect:t("date.selectYear"),today:t("defaults.today"),clear:t("defaults.delete"),close:t("defaults.close"),firstDay:t("date.firstDayOfWeek"),format:t("date.format"),hiddenName:!0}),jQuery.extend(jQuery.fn.pickatime.defaults,{clear:t("defaults.delete"),format:t("time.format"),hiddenName:!0}),window.onpopstate=function(){window.location.reload()},jQuery.extend($.fn.select2.defaults,{formatNoMatches:function(e){return t("selects.noMatches",e)},formatInputTooShort:function(e,i){return t("selects.errors.inputTooShort",i)},formatInputTooLong:function(e,i){return t("selects.errors.inputTooLong",i)},formatSelectionTooBig:function(e){return t("selects.errors.selectionTooBig",e)},formatLoadMore:function(e){return t("selects.loadMore")},formatSearching:function(){return t("selects.loadMore")},formatAjaxError:function(){return t("selects.errors.ajax")},formatMatches:function(e){return 1<e?t("selects.matches",e):t("selects.matchesSing",e)}}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e}),String.prototype.includes||(String.prototype.includes=function(e,t){"use strict";return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),function(e,t){"function"==typeof define&&define.amd?define([],function(){return e.svg4everybody=t()}):"object"==typeof exports?module.exports=t():e.svg4everybody=t()}(this,function(){function p(e,t){if(t){var i=!e.getAttribute("viewBox")&&t.getAttribute("viewBox"),n=document.createDocumentFragment(),o=t.cloneNode(!0);for(i&&e.setAttribute("viewBox",i);o.childNodes.length;)n.appendChild(o.firstChild);e.appendChild(n)}}function f(e){e.onreadystatechange=function(){if(4===e.readyState){var t=document.createElement("x");t.innerHTML=e.responseText,e.s.splice(0).map(function(e){p(e[0],t.querySelector("#"+e[1].replace(/(\W)/g,"\\$1")))})}},e.onreadystatechange()}return function(e){e=e||{};var l=document.getElementsByTagName("use"),c="polyfill"in e?e.polyfill:/\bEdge\/12\b|\bTrident\/[567]\b|\bVersion\/7.0 Safari\b/.test(navigator.userAgent)||(navigator.userAgent.match(/AppleWebKit\/(\d+)/)||[])[1]<537,u=e.validate,d=window.requestAnimationFrame||setTimeout,h={};c&&function e(){for(var t;t=l[0];){var i=t.parentNode;if(i&&/svg/i.test(i.nodeName)){var n=t.getAttribute("xlink:href");if(c&&(!u||u(n,i,t))){var o=n.split("#"),r=o[0],a=o[1];if(i.removeChild(t),r.length){var s=h[r]=h[r]||new XMLHttpRequest;s.s||(s.s=[],s.open("GET",r),s.send()),s.s.push([i,a]),f(s)}else p(i,document.getElementById(a))}}}d(e,17)}()}}),AGN.Opt.Templates.modal='<div class="modal">   <div class="modal-dialog {{= modalClass }}">     <div class="modal-content">       <div class="modal-header">         <button type="button" class="close-icon close" data-dismiss="modal">           <i aria-hidden="true" class="icon icon-times-circle"></i>         </button>         <h4 class="modal-title">{{= title }}</h4>       </div>       <div class="modal-body">         {{= content }}       </div>     </div>   </div> </div>',AGN.Opt.Templates["modal-yes-no-cancel"]='<div class="modal">   <div class="modal-dialog {{= modalClass }}">     <div class="modal-content">       <div class="modal-header">         <button type="button" class="close-icon close" data-dismiss="modal">           <i aria-hidden="true" class="icon icon-times-circle"></i>         </button>         <h4 class="modal-title">{{= title }}</h4>       </div>       <div class="modal-body">         {{= content }}       </div>       <div class="modal-footer">         <div class="btn-group">           <button type="button" class="btn btn-default btn-large pull-left" data-confirm-negative="cancel" data-dismiss="modal">             <i class="icon icon-times"></i>             <span class="text">{{= t(\'defaults.cancel\') }}</span>           </button>           <button type="button" class="btn btn-default btn-large" data-confirm-negative="no" data-dismiss="modal">             <i class="icon icon-times"></i>             <span class="text">{{= t(\'defaults.no\') }}</span>           </button>           <button type="button" class="btn btn-primary btn-large" data-confirm-positive="yes" data-dismiss="modal">             <i class="icon icon-check"></i>             <span class="text">{{= t(\'defaults.yes\') }}</span>           </button>         </div>       </div>     </div>   </div> </div>',AGN.Opt.Templates.error='<div class="backdrop backdrop-error js-close-error" style="position: fixed; top: 0; left: 0; bottom: 0; right:0; z-index: 1100; background-color: rgba(0,0,0,0.5)">     <div class="notification notification-alert" style="position: fixed; top: 50%; left: 50%; width: 420px; margin: -80px 0 0 -210px; z-index: 1101;">         <div class="notification-header">             <p class="headline">                 <i class="icon icon-state-alert"></i>                 <span class="text">{{= headline }}</span>                 <i class="icon icon-times-circle close-icon js-close-error"></i>             </p>         </div>         <div class="notification-content">             <p>{{= text }}</p>             <button type="button" class="btn btn-regular btn-primary vspace-top-10" onclick="location.reload();">                 <i class="icon icon-repeat"></i>                 <span class="text">{{= reload }}</span>             </button>         </div>     </div> </div>',AGN.Opt.Templates["permission-denied"]='<div class="backdrop backdrop-error js-close-error" style="position: fixed; top: 0; left: 0; bottom: 0; right:0; z-index: 1100; background-color: rgba(0,0,0,0.5)">     <div class="notification notification-alert" style="position: fixed; top: 50%; left: 50%; width: 420px; margin: -80px 0 0 -210px; z-index: 1101;">         <div class="notification-header">             <p class="headline">                 <i class="icon icon-state-alert"></i>                 <span class="text">{{= title }}</span>                 <i class="icon icon-times-circle close-icon js-close-error"></i>             </p>         </div>         <div class="notification-content">             <p>{{= text }}</p>             <button type="button" class="btn btn-regular btn-primary vspace-top-10 vspace-bottom-10 js-close-error" style="float: right">                 <i class="icon icon-check"></i>                 <span class="text">{{= btn }}</span>             </button>         </div>     </div> </div>',AGN.Opt.Templates["autosave-restore"]='<div class="modal">   <div class="modal-dialog {{= modalClass }}">     <div class="modal-content">       <div class="modal-header">         <button type="button" class="close-icon close" data-dismiss="modal">           <i aria-hidden="true" class="icon icon-times-circle"></i>         </button>         <h4 class="modal-title">{{= title }}</h4>       </div>       <div class="modal-body">         {{= content }}       </div>       <div class="modal-footer">         <div class="btn-group">           <button type="button" class="btn btn-default btn-large js-confirm-negative" data-dismiss="modal">             <i class="icon icon-times"></i>             <span class="text">{{= negative }}</span>           </button>           <button type="button" class="btn btn-primary btn-large js-confirm-positive" data-dismiss="modal">             <i class="icon icon-check"></i>             <span class="text">{{= positive }}</span>           </button>         </div>       </div>     </div>   </div> </div>',AGN.Opt.Templates["tooltip-template"]='<div class="tooltip {{= tooltipStyle }}" role="tooltip">   <div class="tooltip-arrow {{= arrowStyle }}"></div>   <div class="tooltip-inner {{= innerStyle }}"></div> </div>',AGN.Opt.Templates["tooltip-message-with-title"]='<div class="helper-popup-header">{{= title }}</div> <div class="helper-popup-content">{{= content }}</div>',AGN.Opt.Templates["tooltip-message-just-content"]='<div class="helper-popup-content">{{= content }}</div>',AGN.Opt.Templates["table-controls-top"]='<div class="table-controls clearfix">   <div class="table-control pull-left">     <div class="well">{{= t(\'tables.range\', itemStart, itemEnd, itemTotal) }}</div>   </div>   <div class="table-control pull-left" id="filtersDescription"></div>   {{ if (pagination) { }}   <div class="table-control pull-right">     <ul class="pagination">       <li class="js-data-table-first-page {{= currentPage == 1 ? \'disabled\' : \'\'¬†}}">         <span><i class="icon icon-angle-double-left"></i> {{= t(\'tables.first\') }}</span>       </li>       <li class="js-data-table-prev-page {{= currentPage == 1 ? \'disabled\' : \'\'¬†}}">         <span><i class="icon icon-angle-left"></i> {{= t(\'tables.previous\') }}</span>       </li>       {{ _.each(pageSelects, function(page) { }}       <li class="{{=¬†page == currentPage ? \'active\' : \'js-data-table-page\' }}" data-page="{{= page - 1 }}">         <span>{{= page }}</span>       </li>       {{ }) }}       <li class="js-data-table-next-page {{= currentPage == totalPages ? \'disabled\' : \'\'¬†}}">         <span>{{= t(\'tables.next\') }} <i class="icon icon-angle-right"></i></span>       </li>       <li class="js-data-table-last-page {{= currentPage == totalPages ? \'disabled\' : \'\'¬†}}">         <span>{{= t(\'tables.last\') }} <i class="icon icon-angle-double-right"></i></span>       </li>     </ul>   </div>   {{ } }}  </div>',AGN.Opt.Templates["table-controls-bottom"]="<div class=\"table-controls clearfix\">   <div class=\"table-control pull-left\">     <div class=\"well\">{{= t('tables.range', itemStart, itemEnd, itemTotal) }}</div>   </div>   {{ if (pagination) { }}   <div class=\"table-control pull-right\">     <ul class=\"pagination\">       <li class=\"js-data-table-first-page {{= currentPage == 1 ? 'disabled' : ''¬†}}\">         <span><i class=\"icon icon-angle-double-left\"></i> {{= t('tables.first') }}</span>       </li>       <li class=\"js-data-table-prev-page {{= currentPage == 1 ? 'disabled' : ''¬†}}\">         <span><i class=\"icon icon-angle-left\"></i> {{= t('tables.previous') }}</span>       </li>       {{ _.each(pageSelects, function(page) { }}        <li class=\"{{=¬†page == currentPage ? 'active' : 'js-data-table-page' }}\" data-page=\"{{= page - 1 }}\">         <span>{{= page }}</span>       </li>       {{ }) }}       <li class=\"js-data-table-next-page {{= currentPage == totalPages ? 'disabled' : ''¬†}}\">         <span>{{= t('tables.next') }} <i class=\"icon icon-angle-right\"></i></span>       </li>       <li class=\"js-data-table-last-page {{= currentPage == totalPages ? 'disabled' : ''¬†}}\">         <span>{{= t('tables.last') }} <i class=\"icon icon-angle-double-right\"></i></span>       </li>     </ul>   </div>   {{ } }} </div>",window.agnTimeZoneId&&moment.tz.setDefault(window.agnTimeZoneId),function(e,t){"function"==typeof define&&define.amd?define(["jquery","dot/doT","jquery-extendext"],t):"object"==typeof module&&module.exports?module.exports=t(require("jquery"),require("dot/doT"),require("jquery-extendext")):t(e.jQuery,e.doT)}(this,function(g,i){"use strict";var h=function(e,t){(e[0].queryBuilder=this).$el=e,this.settings=g.extendext(!0,"replace",{},h.DEFAULTS,t),this.model=new n,this.status={id:null,generated_id:!1,group_id:0,rule_id:0,has_optgroup:!1,has_operator_optgroup:!1},this.filters=this.settings.filters,this.icons=this.settings.icons,this.operators=this.settings.operators,this.templates=this.settings.templates,this.plugins=this.settings.plugins,this.lang=null,void 0===h.regional.en&&m.error("Config",'"i18n/en.js" not loaded.'),this.lang=g.extendext(!0,"replace",{},h.regional.en,h.regional[this.settings.lang_code],this.settings.lang),!1===this.settings.allow_groups?this.settings.allow_groups=0:!0===this.settings.allow_groups&&(this.settings.allow_groups=-1),Object.keys(this.templates).forEach(function(e){this.templates[e]||(this.templates[e]=h.templates[e]),"string"==typeof this.templates[e]&&(this.templates[e]=i.template(this.templates[e]))},this),this.$el.attr("id")||(this.$el.attr("id","qb_"+Math.floor(99999*Math.random())),this.status.generated_id=!0),this.status.id=this.$el.attr("id"),this.$el.addClass("query-builder form-inline"),this.filters=this.checkFilters(this.filters),this.operators=this.checkOperators(this.operators),this.bindEvents(),this.initPlugins()};g.extend(h.prototype,{trigger:function(e){var t=new g.Event(this._tojQueryEvent(e),{builder:this});return this.$el.triggerHandler(t,Array.prototype.slice.call(arguments,1)),t},change:function(e,t){var i=new g.Event(this._tojQueryEvent(e,!0),{builder:this,value:t});return this.$el.triggerHandler(i,Array.prototype.slice.call(arguments,2)),i.value},on:function(e,t){return this.$el.on(this._tojQueryEvent(e),t),this},off:function(e,t){return this.$el.off(this._tojQueryEvent(e),t),this},once:function(e,t){return this.$el.one(this._tojQueryEvent(e),t),this},_tojQueryEvent:function(e,t){return e.split(" ").map(function(e){return e+".queryBuilder"+(t?".filter":"")}).join(" ")}}),h.types={string:"string",integer:"number",double:"number",date:"datetime",time:"datetime",datetime:"datetime",boolean:"boolean"},h.inputs=["text","number","textarea","radio","checkbox","select"],h.modifiable_options=["display_errors","allow_groups","allow_empty","default_condition","default_filter"],h.selectors={group_container:".rules-group-container",rule_container:".rule-container",filter_container:".rule-filter-container",operator_container:".rule-operator-container",value_container:".rule-value-container",error_container:".error-container",condition_container:".rules-group-header .group-conditions",rule_header:".rule-header",group_header:".rules-group-header",group_actions:".group-actions",rule_actions:".rule-actions",rules_list:".rules-group-body>.rules-list",group_condition:".rules-group-header [name$=_cond]",rule_filter:".rule-filter-container [name$=_filter]",rule_operator:".rule-operator-container [name$=_operator]",rule_value:".rule-value-container [name*=_value_]",add_rule:"[data-add=rule]",delete_rule:"[data-delete=rule]",add_group:"[data-add=group]",delete_group:"[data-delete=group]"},h.templates={},h.regional={},h.OPERATORS={equal:{type:"equal",nb_inputs:1,multiple:!1,apply_to:["string","number","datetime","boolean"]},not_equal:{type:"not_equal",nb_inputs:1,multiple:!1,apply_to:["string","number","datetime","boolean"]},in:{type:"in",nb_inputs:1,multiple:!0,apply_to:["string","number","datetime"]},not_in:{type:"not_in",nb_inputs:1,multiple:!0,apply_to:["string","number","datetime"]},less:{type:"less",nb_inputs:1,multiple:!1,apply_to:["number","datetime"]},less_or_equal:{type:"less_or_equal",nb_inputs:1,multiple:!1,apply_to:["number","datetime"]},greater:{type:"greater",nb_inputs:1,multiple:!1,apply_to:["number","datetime"]},greater_or_equal:{type:"greater_or_equal",nb_inputs:1,multiple:!1,apply_to:["number","datetime"]},between:{type:"between",nb_inputs:2,multiple:!1,apply_to:["number","datetime"]},not_between:{type:"not_between",nb_inputs:2,multiple:!1,apply_to:["number","datetime"]},begins_with:{type:"begins_with",nb_inputs:1,multiple:!1,apply_to:["string"]},not_begins_with:{type:"not_begins_with",nb_inputs:1,multiple:!1,apply_to:["string"]},contains:{type:"contains",nb_inputs:1,multiple:!1,apply_to:["string"]},not_contains:{type:"not_contains",nb_inputs:1,multiple:!1,apply_to:["string"]},ends_with:{type:"ends_with",nb_inputs:1,multiple:!1,apply_to:["string"]},not_ends_with:{type:"not_ends_with",nb_inputs:1,multiple:!1,apply_to:["string"]},is_empty:{type:"is_empty",nb_inputs:0,multiple:!1,apply_to:["string"]},is_not_empty:{type:"is_not_empty",nb_inputs:0,multiple:!1,apply_to:["string"]},is_null:{type:"is_null",nb_inputs:0,multiple:!1,apply_to:["string","number","datetime","boolean"]},is_not_null:{type:"is_not_null",nb_inputs:0,multiple:!1,apply_to:["string","number","datetime","boolean"]}},h.DEFAULTS={filters:[],plugins:[],sort_filters:!1,display_errors:!0,allow_groups:-1,allow_empty:!1,conditions:["AND","OR"],default_condition:"AND",inputs_separator:" , ",select_placeholder:"------",display_empty_filter:!0,default_filter:null,optgroups:{},default_rule_flags:{filter_readonly:!1,operator_readonly:!1,value_readonly:!1,no_delete:!1},default_group_flags:{condition_readonly:!1,no_add_rule:!1,no_add_group:!1,no_delete:!1},templates:{group:null,rule:null,filterSelect:null,operatorSelect:null,ruleValueSelect:null},lang_code:"en",lang:{},operators:["equal","not_equal","in","not_in","less","less_or_equal","greater","greater_or_equal","between","not_between","begins_with","not_begins_with","contains","not_contains","ends_with","not_ends_with","is_empty","is_not_empty","is_null","is_not_null"],icons:{add_group:"glyphicon glyphicon-plus-sign",add_rule:"glyphicon glyphicon-plus",remove_group:"glyphicon glyphicon-remove",remove_rule:"glyphicon glyphicon-remove",error:"glyphicon glyphicon-warning-sign"}},h.plugins={},h.defaults=function(e){if("object"!=typeof e)return"string"==typeof e?"object"==typeof h.DEFAULTS[e]?g.extend(!0,{},h.DEFAULTS[e]):h.DEFAULTS[e]:g.extend(!0,{},h.DEFAULTS);g.extendext(!0,"replace",h.DEFAULTS,e)},h.define=function(e,t,i){h.plugins[e]={fct:t,def:i||{}}},h.extend=function(e){g.extend(h.prototype,e)},h.prototype.initPlugins=function(){if(this.plugins){if(g.isArray(this.plugins)){var t={};this.plugins.forEach(function(e){t[e]=null}),this.plugins=t}Object.keys(this.plugins).forEach(function(e){e in h.plugins?(this.plugins[e]=g.extend(!0,{},h.plugins[e].def,this.plugins[e]||{}),h.plugins[e].fct.call(this,this.plugins[e])):m.error("Config",'Unable to find plugin "{0}"',e)},this)}},h.prototype.getPluginOptions=function(e,t){var i;if(this.plugins&&this.plugins[e]?i=this.plugins[e]:h.plugins[e]&&(i=h.plugins[e].def),i)return t?i[t]:i;m.error("Config",'Unable to find plugin "{0}"',e)},h.prototype.init=function(e){this.trigger("afterInit"),e?(this.setRules(e),delete this.settings.rules):this.setRoot(!0)},h.prototype.checkFilters=function(e){var t=[];if(e&&0!==e.length||m.error("Config","Missing filters list"),e.forEach(function(n,e){switch(n.id||m.error("Config","Missing filter {0} id",e),-1!=t.indexOf(n.id)&&m.error("Config",'Filter "{0}" already defined',n.id),t.push(n.id),n.type?h.types[n.type]||m.error("Config",'Invalid type "{0}"',n.type):n.type="string",n.input?"function"!=typeof n.input&&-1==h.inputs.indexOf(n.input)&&m.error("Config",'Invalid input "{0}"',n.input):n.input="number"===h.types[n.type]?"number":"text",n.operators&&n.operators.forEach(function(e){"string"!=typeof e&&m.error("Config","Filter operators must be global operators types (string)")}),n.field||(n.field=n.id),n.label||(n.label=n.field),n.optgroup?(this.status.has_optgroup=!0,this.settings.optgroups[n.optgroup]||(this.settings.optgroups[n.optgroup]=n.optgroup)):n.optgroup=null,n.input){case"radio":case"checkbox":(!n.values||n.values.length<1)&&m.error("Config",'Missing filter "{0}" values',n.id);break;case"select":var o=[];n.has_optgroup=!1,m.iterateOptions(n.values,function(e,t,i){o.push({value:e,label:t,optgroup:i||null}),i&&(n.has_optgroup=!0,this.settings.optgroups[i]||(this.settings.optgroups[i]=i))}.bind(this)),n.has_optgroup?n.values=m.groupSort(o,"optgroup"):n.values=o,n.placeholder&&(void 0===n.placeholder_value&&(n.placeholder_value=-1),n.values.forEach(function(e){e.value==n.placeholder_value&&m.error("Config",'Placeholder of filter "{0}" overlaps with one of its values',n.id)}))}},this),this.settings.sort_filters)if("function"==typeof this.settings.sort_filters)e.sort(this.settings.sort_filters);else{var i=this;e.sort(function(e,t){return i.translate(e.label).localeCompare(i.translate(t.label))})}return this.status.has_optgroup&&(e=m.groupSort(e,"optgroup")),e},h.prototype.checkOperators=function(i){var n=[];return i.forEach(function(e,t){"string"==typeof e?(h.OPERATORS[e]||m.error("Config",'Unknown operator "{0}"',e),i[t]=e=g.extendext(!0,"replace",{},h.OPERATORS[e])):(e.type||m.error("Config",'Missing "type" for operator {0}',t),h.OPERATORS[e.type]&&(i[t]=e=g.extendext(!0,"replace",{},h.OPERATORS[e.type],e)),void 0!==e.nb_inputs&&void 0!==e.apply_to||m.error("Config",'Missing "nb_inputs" and/or "apply_to" for operator "{0}"',e.type)),-1!=n.indexOf(e.type)&&m.error("Config",'Operator "{0}" already defined',e.type),n.push(e.type),e.optgroup?(this.status.has_operator_optgroup=!0,this.settings.optgroups[e.optgroup]||(this.settings.optgroups[e.optgroup]=e.optgroup)):e.optgroup=null},this),this.status.has_operator_optgroup&&(i=m.groupSort(i,"optgroup")),i},h.prototype.bindEvents=function(){var r=this,t=h.selectors;this.$el.on("change.queryBuilder",t.group_condition,function(){if(g(this).is(":checked")){var e=g(this).closest(t.group_container);r.getModel(e).condition=g(this).val()}}),this.$el.on("change.queryBuilder",t.rule_filter,function(){var e=g(this).closest(t.rule_container);r.getModel(e).filter=r.getFilterById(g(this).val())}),this.$el.on("change.queryBuilder",t.rule_operator,function(){var e=g(this).closest(t.rule_container);r.getModel(e).operator=r.getOperatorByType(g(this).val())}),this.$el.on("click.queryBuilder",t.add_rule,function(){var e=g(this).closest(t.group_container);r.addRule(r.getModel(e))}),this.$el.on("click.queryBuilder",t.delete_rule,function(){var e=g(this).closest(t.rule_container);r.deleteRule(r.getModel(e))}),0!==this.settings.allow_groups&&(this.$el.on("click.queryBuilder",t.add_group,function(){var e=g(this).closest(t.group_container);r.addGroup(r.getModel(e))}),this.$el.on("click.queryBuilder",t.delete_group,function(){var e=g(this).closest(t.group_container);r.deleteGroup(r.getModel(e))})),this.model.on({drop:function(e,t){t.$el.remove(),r.refreshGroupsConditions()},add:function(e,t,i,n){0===n?i.$el.prependTo(t.$el.find(">"+h.selectors.rules_list)):i.$el.insertAfter(t.rules[n-1].$el),r.refreshGroupsConditions()},move:function(e,t,i,n){t.$el.detach(),0===n?t.$el.prependTo(i.$el.find(">"+h.selectors.rules_list)):t.$el.insertAfter(i.rules[n-1].$el),r.refreshGroupsConditions()},update:function(e,t,i,n,o){if(t instanceof a)switch(i){case"error":r.updateError(t);break;case"flags":r.applyRuleFlags(t);break;case"filter":r.updateRuleFilter(t,o);break;case"operator":r.updateRuleOperator(t,o);break;case"value":r.updateRuleValue(t,o)}else switch(i){case"error":r.updateError(t);break;case"flags":r.applyGroupFlags(t);break;case"condition":r.updateGroupCondition(t,o)}}})},h.prototype.setRoot=function(e,t,i){e=void 0===e||!0===e;var n=this.nextGroupId(),o=g(this.getGroupTemplate(n,1));return this.$el.append(o),this.model.root=new l(null,o),this.model.root.model=this.model,this.model.root.data=t,this.model.root.flags=g.extend({},this.settings.default_group_flags,i),this.model.root.condition=this.settings.default_condition,this.trigger("afterAddGroup",this.model.root),e&&this.addRule(this.model.root),this.model.root},h.prototype.addGroup=function(e,t,i,n){t=void 0===t||!0===t;var o=e.level+1;if(this.trigger("beforeAddGroup",e,t,o).isDefaultPrevented())return null;var r=this.nextGroupId(),a=g(this.getGroupTemplate(r,o)),s=e.addGroup(a);return s.data=i,s.flags=g.extend({},this.settings.default_group_flags,n),s.condition=this.settings.default_condition,this.trigger("afterAddGroup",s),this.trigger("rulesChanged"),t&&this.addRule(s),s},h.prototype.deleteGroup=function(e){if(e.isRoot())return!1;if(this.trigger("beforeDeleteGroup",e).isDefaultPrevented())return!1;var t=!0;return e.each("reverse",function(e){t&=this.deleteRule(e)},function(e){t&=this.deleteGroup(e)},this),t&&(e.drop(),this.trigger("afterDeleteGroup"),this.trigger("rulesChanged")),t},h.prototype.updateGroupCondition=function(t,e){t.$el.find(">"+h.selectors.group_condition).each(function(){var e=g(this);e.prop("checked",e.val()===t.condition),e.parent().toggleClass("active",e.val()===t.condition)}),this.trigger("afterUpdateGroupCondition",t,e),this.trigger("rulesChanged")},h.prototype.refreshGroupsConditions=function(){!function t(e){e.flags&&(!e.flags||e.flags.condition_readonly)||e.$el.find(">"+h.selectors.group_condition).prop("disabled",e.rules.length<=1).parent().toggleClass("disabled",e.rules.length<=1),e.each(null,function(e){t(e)},this)}(this.model.root)},h.prototype.addRule=function(e,t,i){if(this.trigger("beforeAddRule",e).isDefaultPrevented())return null;var n=this.nextRuleId(),o=g(this.getRuleTemplate(n)),r=e.addRule(o);return r.data=t,r.flags=g.extend({},this.settings.default_rule_flags,i),this.trigger("afterAddRule",r),this.trigger("rulesChanged"),this.createRuleFilters(r),!this.settings.default_filter&&this.settings.display_empty_filter||(r.filter=this.change("getDefaultFilter",this.getFilterById(this.settings.default_filter||this.filters[0].id),r)),r},h.prototype.deleteRule=function(e){return!e.flags.no_delete&&(!this.trigger("beforeDeleteRule",e).isDefaultPrevented()&&(e.drop(),this.trigger("afterDeleteRule"),this.trigger("rulesChanged"),!0))},h.prototype.createRuleFilters=function(e){var t=this.change("getRuleFilters",this.filters,e),i=g(this.getRuleFilterSelect(e,t));e.$el.find(h.selectors.filter_container).html(i),this.trigger("afterCreateRuleFilters",e),this.applyRuleFlags(e)},h.prototype.createRuleOperators=function(e){var t=e.$el.find(h.selectors.operator_container).empty();if(e.filter){var i=this.getOperators(e.filter),n=g(this.getRuleOperatorSelect(e,i));t.html(n),e.filter.default_operator?e.__.operator=this.getOperatorByType(e.filter.default_operator):e.__.operator=i[0],e.$el.find(h.selectors.rule_operator).val(e.operator.type),this.trigger("afterCreateRuleOperators",e,i),this.applyRuleFlags(e)}},h.prototype.createRuleInput=function(e){var t=e.$el.find(h.selectors.value_container).empty();if(e.__.value=void 0,e.filter&&e.operator&&0!==e.operator.nb_inputs){for(var i=this,n=g(),o=e.filter,r=0;r<e.operator.nb_inputs;r++){var a=g(this.getRuleInput(e,r));0<r&&t.append(this.settings.inputs_separator),t.append(a),n=n.add(a)}t.css("display",""),n.on("change "+(o.input_event||""),function(){e._updating_input||(e._updating_value=!0,e.value=i.getRuleInputValue(e),e._updating_value=!1)}),o.plugin&&n[o.plugin](o.plugin_config||{}),this.trigger("afterCreateRuleInput",e),void 0!==o.default_value?e.value=o.default_value:(e._updating_value=!0,e.value=i.getRuleInputValue(e),e._updating_value=!1),this.applyRuleFlags(e)}},h.prototype.updateRuleFilter=function(e,t){this.createRuleOperators(e),this.createRuleInput(e),e.$el.find(h.selectors.rule_filter).val(e.filter?e.filter.id:"-1"),t&&e.filter&&t.id!==e.filter.id&&(e.data=void 0),this.trigger("afterUpdateRuleFilter",e,t),this.trigger("rulesChanged")},h.prototype.updateRuleOperator=function(e,t){var i=e.$el.find(h.selectors.value_container);e.operator&&0!==e.operator.nb_inputs?(i.css("display",""),!i.is(":empty")&&t&&e.operator.nb_inputs===t.nb_inputs&&e.operator.optgroup===t.optgroup||this.createRuleInput(e)):(i.hide(),e.__.value=void 0),e.operator&&(e.$el.find(h.selectors.rule_operator).val(e.operator.type),e.__.value=this.getRuleInputValue(e)),this.trigger("afterUpdateRuleOperator",e,t),this.trigger("rulesChanged")},h.prototype.updateRuleValue=function(e,t){e._updating_value||this.setRuleInputValue(e,e.value),this.trigger("afterUpdateRuleValue",e,t),this.trigger("rulesChanged")},h.prototype.applyRuleFlags=function(e){var t=e.flags,i=h.selectors;e.$el.find(i.rule_filter).prop("disabled",t.filter_readonly),e.$el.find(i.rule_operator).prop("disabled",t.operator_readonly),e.$el.find(i.rule_value).prop("disabled",t.value_readonly),t.no_delete&&e.$el.find(i.delete_rule).remove(),this.trigger("afterApplyRuleFlags",e)},h.prototype.applyGroupFlags=function(e){var t=e.flags,i=h.selectors;e.$el.find(">"+i.group_condition).prop("disabled",t.condition_readonly).parent().toggleClass("readonly",t.condition_readonly),t.no_add_rule&&e.$el.find(i.add_rule).remove(),t.no_add_group&&e.$el.find(i.add_group).remove(),t.no_delete&&e.$el.find(i.delete_group).remove(),this.trigger("afterApplyGroupFlags",e)},h.prototype.clearErrors=function(e){(e=e||this.model.root)&&(e.error=null,e instanceof l&&e.each(function(e){e.error=null},function(e){this.clearErrors(e)},this))},h.prototype.updateError=function(e){if(this.settings.display_errors)if(null===e.error)e.$el.removeClass("has-error");else{var t=this.translate("errors",e.error[0]);t=m.fmt(t,e.error.slice(1)),t=this.change("displayError",t,e.error,e),e.$el.addClass("has-error").find(h.selectors.error_container).eq(0).attr("title",t)}},h.prototype.triggerValidationError=function(e,t,i){g.isArray(t)||(t=[t]),this.trigger("validationError",e,t,i).isDefaultPrevented()||(e.error=t)},h.prototype.destroy=function(){this.trigger("beforeDestroy"),this.status.generated_id&&this.$el.removeAttr("id"),this.clear(),this.model=null,this.$el.off(".queryBuilder").removeClass("query-builder").removeData("queryBuilder"),delete this.$el[0].queryBuilder},h.prototype.reset=function(){this.trigger("beforeReset").isDefaultPrevented()||(this.status.group_id=1,this.status.rule_id=0,this.model.root.empty(),this.model.root.data=void 0,this.model.root.flags=g.extend({},this.settings.default_group_flags),this.model.root.condition=this.settings.default_condition,this.addRule(this.model.root),this.trigger("afterReset"),this.trigger("rulesChanged"))},h.prototype.clear=function(){this.trigger("beforeClear").isDefaultPrevented()||(this.status.group_id=0,this.status.rule_id=0,this.model.root&&(this.model.root.drop(),this.model.root=null),this.trigger("afterClear"),this.trigger("rulesChanged"))},h.prototype.setOptions=function(e){g.each(e,function(e,t){-1!==h.modifiable_options.indexOf(e)&&(this.settings[e]=t)}.bind(this))},h.prototype.getModel=function(e){return e?e instanceof o?e:g(e).data("queryBuilderModel"):this.model.root},h.prototype.validate=function(r){r=g.extend({skip_empty:!1},r),this.clearErrors();var a=this,e=function i(e){var n=0,o=0;return e.each(function(e){if(e.filter||!r.skip_empty){if(!e.filter)return a.triggerValidationError(e,"no_filter",null),void o++;if(!e.operator)return a.triggerValidationError(e,"no_operator",null),void o++;if(0!==e.operator.nb_inputs){var t=a.validateValue(e,e.value);if(!0!==t)return a.triggerValidationError(e,t,e.value),void o++}n++}},function(e){var t=i(e);!0===t?n++:!1===t&&o++}),!(0<o)&&(0===n&&!e.isRoot()&&r.skip_empty?null:!!(0!==n||a.settings.allow_empty&&e.isRoot())||(a.triggerValidationError(e,"empty_group",null),!1))}(this.model.root);return this.change("validate",e)},h.prototype.getRules=function(r){r=g.extend({get_flags:!1,allow_invalid:!1,skip_empty:!1},r);var e=this.validate(r);if(!e&&!r.allow_invalid)return null;var a=this,t=function i(e){var o={condition:e.condition,rules:[]};if(e.data&&(o.data=g.extendext(!0,"replace",{},e.data)),r.get_flags){var t=a.getGroupFlags(e.flags,"all"===r.get_flags);g.isEmptyObject(t)||(o.flags=t)}return e.each(function(e){if(e.filter||!r.skip_empty){var t=null;e.operator&&0===e.operator.nb_inputs||(t=e.value);var i={id:e.filter?e.filter.id:null,field:e.filter?e.filter.field:null,type:e.filter?e.filter.type:null,input:e.filter?e.filter.input:null,operator:e.operator?e.operator.type:null,value:t};if((e.filter&&e.filter.data||e.data)&&(i.data=g.extendext(!0,"replace",{},e.filter.data,e.data)),r.get_flags){var n=a.getRuleFlags(e.flags,"all"===r.get_flags);g.isEmptyObject(n)||(i.flags=n)}o.rules.push(a.change("ruleToJson",i,e))}},function(e){var t=i(e);0===t.rules.length&&r.skip_empty||o.rules.push(t)},this),a.change("groupToJson",o,e)}(this.model.root);return t.valid=e,this.change("getRules",t)},h.prototype.setRules=function(e,o){o=g.extend({allow_invalid:!1},o),g.isArray(e)&&(e={condition:this.settings.default_condition,rules:e}),e&&e.rules&&(0!==e.rules.length||this.settings.allow_empty)||m.error("RulesParse","Incorrect data object passed"),this.clear(),this.setRoot(!1,e.data,this.parseGroupFlags(e)),e=this.change("setRules",e,o);var r=this;!function i(e,n){null!==n&&(void 0===e.condition?e.condition=r.settings.default_condition:-1==r.settings.conditions.indexOf(e.condition)&&(m.error(!o.allow_invalid,"UndefinedCondition",'Invalid condition "{0}"',e.condition),e.condition=r.settings.default_condition),n.condition=e.condition,e.rules.forEach(function(e){var t;if(void 0!==e.rules)if(-1!==r.settings.allow_groups&&r.settings.allow_groups<n.level)m.error(!o.allow_invalid,"RulesParse","No more than {0} groups are allowed",r.settings.allow_groups),r.reset();else{if(null===(t=r.addGroup(n,!1,e.data,r.parseGroupFlags(e))))return;i(e,t)}else{if(e.empty||(void 0===e.id&&(m.error(!o.allow_invalid,"RulesParse","Missing rule field id"),e.empty=!0),void 0===e.operator&&(e.operator="equal")),null===(t=r.addRule(n,e.data,r.parseRuleFlags(e))))return;e.empty||(t.filter=r.getFilterById(e.id,!o.allow_invalid)),t.filter&&(t.operator=r.getOperatorByType(e.operator,!o.allow_invalid),t.operator||(t.operator=r.getOperators(t.filter)[0])),t.operator&&0!==t.operator.nb_inputs&&(void 0!==e.value?t.value=e.value:void 0!==t.filter.default_value&&(t.value=t.filter.default_value)),r.change("jsonToRule",t,e)!=t&&m.error("RulesParse","Plugin tried to change rule reference")}}),r.change("jsonToGroup",n,e)!=n&&m.error("RulesParse","Plugin tried to change group reference"))}(e,this.model.root),this.trigger("afterSetRules")},h.prototype.validateValue=function(e,t){var i=e.filter.validation||{},n=!0;return n=i.callback?i.callback.call(this,t,e):this._validateValue(e,t),this.change("validateValue",n,t,e)},h.prototype._validateValue=function(e,t){var i,n,o=e.filter,r=e.operator,a=o.validation||{},s=!0;1===e.operator.nb_inputs&&(t=[t]);for(var l=0;l<r.nb_inputs;l++){if(!r.multiple&&g.isArray(t[l])&&1<t[l].length){s=["operator_not_multiple",r.type,this.translate("operators",r.type)];break}switch(o.input){case"radio":if(void 0!==t[l]&&0!==t[l].length)break;a.allow_empty_value||(s=["radio_empty"]);break;case"checkbox":if(void 0!==t[l]&&0!==t[l].length)break;a.allow_empty_value||(s=["checkbox_empty"]);break;case"select":if(void 0===t[l]||0===t[l].length||o.placeholder&&t[l]==o.placeholder_value){a.allow_empty_value||(s=["select_empty"]);break}break;default:n=g.isArray(t[l])?t[l]:[t[l]];for(var c=0;c<n.length;c++){switch(h.types[o.type]){case"string":if(void 0===n[c]||0===n[c].length){a.allow_empty_value||(s=["string_empty"]);break}if(void 0!==a.min&&n[c].length<parseInt(a.min)){s=[this.getValidationMessage(a,"min","string_exceed_min_length"),a.min];break}if(void 0!==a.max&&n[c].length>parseInt(a.max)){s=[this.getValidationMessage(a,"max","string_exceed_max_length"),a.max];break}if(!a.format||("string"==typeof a.format&&(a.format=new RegExp(a.format)),a.format.test(n[c])))break;s=[this.getValidationMessage(a,"format","string_invalid_format"),a.format];break;case"number":if(void 0===n[c]||0===n[c].length){a.allow_empty_value||(s=["number_nan"]);break}if(isNaN(n[c])){s=["number_nan"];break}if("integer"==o.type){if(parseInt(n[c])!=n[c]){s=["number_not_integer"];break}}else if(parseFloat(n[c])!=n[c]){s=["number_not_double"];break}if(void 0!==a.min&&n[c]<parseFloat(a.min)){s=[this.getValidationMessage(a,"min","number_exceed_min"),a.min];break}if(void 0!==a.max&&n[c]>parseFloat(a.max)){s=[this.getValidationMessage(a,"max","number_exceed_max"),a.max];break}if(void 0!==a.step&&"any"!==a.step){var u=(n[c]/a.step).toPrecision(14);if(parseInt(u)!=u){s=[this.getValidationMessage(a,"step","number_wrong_step"),a.step];break}}break;case"datetime":if(void 0===n[c]||0===n[c].length){a.allow_empty_value||(s=["datetime_empty"]);break}if(a.format){"moment"in window||m.error("MissingLibrary","MomentJS is required for Date/Time validation. Get it here http://momentjs.com");var d=moment(n[c],a.format);if(!d.isValid()){s=[this.getValidationMessage(a,"format","datetime_invalid"),a.format];break}if(a.min&&d<moment(a.min,a.format)){s=[this.getValidationMessage(a,"min","datetime_exceed_min"),a.min];break}if(a.max&&d>moment(a.max,a.format)){s=[this.getValidationMessage(a,"max","datetime_exceed_max"),a.max];break}}break;case"boolean":if(void 0===n[c]||0===n[c].length){a.allow_empty_value||(s=["boolean_not_valid"]);break}if("true"!==(i=(""+n[c]).trim().toLowerCase())&&"false"!==i&&"1"!==i&&"0"!==i&&1!==n[c]&&0!==n[c]){s=["boolean_not_valid"];break}}if(!0!==s)break}}if(!0!==s)break}if(("between"===e.operator.type||"not_between"===e.operator.type)&&2===t.length)switch(h.types[o.type]){case"number":t[0]>t[1]&&(s=["number_between_invalid",t[0],t[1]]);break;case"datetime":a.format&&("moment"in window||m.error("MissingLibrary","MomentJS is required for Date/Time validation. Get it here http://momentjs.com"),moment(t[0],a.format).isAfter(moment(t[1],a.format))&&(s=["datetime_between_invalid",t[0],t[1]]))}return s},h.prototype.nextGroupId=function(){return this.status.id+"_group_"+this.status.group_id++},h.prototype.nextRuleId=function(){return this.status.id+"_rule_"+this.status.rule_id++},h.prototype.getOperators=function(i){"string"==typeof i&&(i=this.getFilterById(i));for(var e=[],t=0,n=this.operators.length;t<n;t++){if(i.operators){if(-1==i.operators.indexOf(this.operators[t].type))continue}else if(-1==this.operators[t].apply_to.indexOf(h.types[i.type]))continue;e.push(this.operators[t])}return i.operators&&e.sort(function(e,t){return i.operators.indexOf(e.type)-i.operators.indexOf(t.type)}),this.change("getOperators",e,i)},h.prototype.getFilterById=function(e,t){if("-1"==e)return null;for(var i=0,n=this.filters.length;i<n;i++)if(this.filters[i].id==e)return this.filters[i];return m.error(!1!==t,"UndefinedFilter",'Undefined filter "{0}"',e),null},h.prototype.getOperatorByType=function(e,t){if("-1"==e)return null;for(var i=0,n=this.operators.length;i<n;i++)if(this.operators[i].type==e)return this.operators[i];return m.error(!1!==t,"UndefinedOperator",'Undefined operator "{0}"',e),null},h.prototype.getRuleInputValue=function(e){var t=e.filter,i=e.operator,n=[];if(t.valueGetter)n=t.valueGetter.call(this,e);else{for(var o=e.$el.find(h.selectors.value_container),r=0;r<i.nb_inputs;r++){var a,s=m.escapeElementId(e.id+"_value_"+r);switch(t.input){case"radio":n.push(o.find("[name="+s+"]:checked").val());break;case"checkbox":a=[],o.find("[name="+s+"]:checked").each(function(){a.push(g(this).val())}),n.push(a);break;case"select":t.multiple?(a=[],o.find("[name="+s+"] option:selected").each(function(){a.push(g(this).val())}),n.push(a)):n.push(o.find("[name="+s+"] option:selected").val());break;default:n.push(o.find("[name="+s+"]").val())}}n=n.map(function(e){return i.multiple&&t.value_separator&&"string"==typeof e&&(e=e.split(t.value_separator)),g.isArray(e)?e.map(function(e){return m.changeType(e,t.type)}):m.changeType(e,t.type)}),1===i.nb_inputs&&(n=n[0]),t.valueParser&&(n=t.valueParser.call(this,e,n))}return this.change("getRuleValue",n,e)},h.prototype.setRuleInputValue=function(e,t){var i=e.filter,n=e.operator;if(i&&n){if(e._updating_input=!0,i.valueSetter)i.valueSetter.call(this,e,t);else{var o=e.$el.find(h.selectors.value_container);1==n.nb_inputs&&(t=[t]);for(var r=0;r<n.nb_inputs;r++){var a=m.escapeElementId(e.id+"_value_"+r);switch(i.input){case"radio":o.find("[name="+a+'][value="'+t[r]+'"]').prop("checked",!0).trigger("change");break;case"checkbox":g.isArray(t[r])||(t[r]=[t[r]]),t[r].forEach(function(e){o.find("[name="+a+'][value="'+e+'"]').prop("checked",!0).trigger("change")});break;default:n.multiple&&i.value_separator&&g.isArray(t[r])&&(t[r]=t[r].join(i.value_separator)),o.find("[name="+a+"]").val(t[r]).trigger("change")}}}e._updating_input=!1}},h.prototype.parseRuleFlags=function(e){var t=g.extend({},this.settings.default_rule_flags);return e.readonly&&g.extend(t,{filter_readonly:!0,operator_readonly:!0,value_readonly:!0,no_delete:!0}),e.flags&&g.extend(t,e.flags),this.change("parseRuleFlags",t,e)},h.prototype.getRuleFlags=function(i,e){if(e)return g.extend({},i);var n={};return g.each(this.settings.default_rule_flags,function(e,t){i[e]!==t&&(n[e]=i[e])}),n},h.prototype.parseGroupFlags=function(e){var t=g.extend({},this.settings.default_group_flags);return e.readonly&&g.extend(t,{condition_readonly:!0,no_add_rule:!0,no_add_group:!0,no_delete:!0}),e.flags&&g.extend(t,e.flags),this.change("parseGroupFlags",t,e)},h.prototype.getGroupFlags=function(i,e){if(e)return g.extend({},i);var n={};return g.each(this.settings.default_group_flags,function(e,t){i[e]!==t&&(n[e]=i[e])}),n},h.prototype.translate=function(e,t){var i;return t||(t=e,e=void 0),i="object"==typeof t?t[this.settings.lang_code]||t.en:(e?this.lang[e]:this.lang)[t]||t,this.change("translate",i,t,e)},h.prototype.getValidationMessage=function(e,t,i){return e.messages&&e.messages[t]||i},h.templates.group='<div id="{{= it.group_id }}" class="rules-group-container">   <div class="rules-group-header">     <div class="btn-group pull-right group-actions">       <button type="button" class="btn btn-xs btn-success" data-add="rule">         <i class="{{= it.icons.add_rule }}"></i> {{= it.translate("add_rule") }}       </button>       {{? it.settings.allow_groups===-1 || it.settings.allow_groups>=it.level }}         <button type="button" class="btn btn-xs btn-success" data-add="group">           <i class="{{= it.icons.add_group }}"></i> {{= it.translate("add_group") }}         </button>       {{?}}       {{? it.level>1 }}         <button type="button" class="btn btn-xs btn-danger" data-delete="group">           <i class="{{= it.icons.remove_group }}"></i> {{= it.translate("delete_group") }}         </button>       {{?}}     </div>     <div class="btn-group group-conditions">       {{~ it.conditions: condition }}         <label class="btn btn-xs btn-primary">           <input type="radio" name="{{= it.group_id }}_cond" value="{{= condition }}"> {{= it.translate("conditions", condition) }}         </label>       {{~}}     </div>     {{? it.settings.display_errors }}       <div class="error-container"><i class="{{= it.icons.error }}"></i></div>     {{?}}   </div>   <div class=rules-group-body>     <div class=rules-list></div>   </div> </div>',h.templates.rule='<div id="{{= it.rule_id }}" class="rule-container">   <div class="rule-header">     <div class="btn-group pull-right rule-actions">       <button type="button" class="btn btn-xs btn-danger" data-delete="rule">         <i class="{{= it.icons.remove_rule }}"></i> {{= it.translate("delete_rule") }}       </button>     </div>   </div>   {{? it.settings.display_errors }}     <div class="error-container"><i class="{{= it.icons.error }}"></i></div>   {{?}}   <div class="rule-filter-container"></div>   <div class="rule-operator-container"></div>   <div class="rule-value-container"></div> </div>',h.templates.filterSelect='{{ var optgroup = null; }} <select class="form-control" name="{{= it.rule.id }}_filter">   {{? it.settings.display_empty_filter }}     <option value="-1">{{= it.settings.select_placeholder }}</option>   {{?}}   {{~ it.filters: filter }}     {{? optgroup !== filter.optgroup }}       {{? optgroup !== null }}</optgroup>{{?}}       {{? (optgroup = filter.optgroup) !== null }}         <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">       {{?}}     {{?}}     <option value="{{= filter.id }}" {{? filter.icon}}data-icon="{{= filter.icon}}"{{?}}>{{= it.translate(filter.label) }}</option>   {{~}}   {{? optgroup !== null }}</optgroup>{{?}} </select>',h.templates.operatorSelect='{{? it.operators.length === 1 }} <span> {{= it.translate("operators", it.operators[0].type) }} </span> {{?}} {{ var optgroup = null; }} <select class="form-control {{? it.operators.length === 1 }}hide{{?}}" name="{{= it.rule.id }}_operator">   {{~ it.operators: operator }}     {{? optgroup !== operator.optgroup }}       {{? optgroup !== null }}</optgroup>{{?}}       {{? (optgroup = operator.optgroup) !== null }}         <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">       {{?}}     {{?}}     <option value="{{= operator.type }}" {{? operator.icon}}data-icon="{{= operator.icon}}"{{?}}>{{= it.translate("operators", operator.type) }}</option>   {{~}}   {{? optgroup !== null }}</optgroup>{{?}} </select>',h.templates.ruleValueSelect='{{ var optgroup = null; }} <select class="form-control" name="{{= it.name }}" {{? it.rule.filter.multiple }}multiple{{?}}>   {{? it.rule.filter.placeholder }}     <option value="{{= it.rule.filter.placeholder_value }}" disabled selected>{{= it.rule.filter.placeholder }}</option>   {{?}}   {{~ it.rule.filter.values: entry }}     {{? optgroup !== entry.optgroup }}       {{? optgroup !== null }}</optgroup>{{?}}       {{? (optgroup = entry.optgroup) !== null }}         <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">       {{?}}     {{?}}     <option value="{{= entry.value }}">{{= entry.label }}</option>   {{~}}   {{? optgroup !== null }}</optgroup>{{?}} </select>',h.prototype.getGroupTemplate=function(e,t){var i=this.templates.group({builder:this,group_id:e,level:t,conditions:this.settings.conditions,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getGroupTemplate",i,t)},h.prototype.getRuleTemplate=function(e){var t=this.templates.rule({builder:this,rule_id:e,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleTemplate",t)},h.prototype.getRuleFilterSelect=function(e,t){var i=this.templates.filterSelect({builder:this,rule:e,filters:t,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleFilterSelect",i,e,t)},h.prototype.getRuleOperatorSelect=function(e,t){var i=this.templates.operatorSelect({builder:this,rule:e,operators:t,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleOperatorSelect",i,e,t)},h.prototype.getRuleValueSelect=function(e,t){var i=this.templates.ruleValueSelect({builder:this,name:e,rule:t,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleValueSelect",i,e,t)},h.prototype.getRuleInput=function(e,t){var i=e.filter,n=e.filter.validation||{},o=e.id+"_value_"+t,r=i.vertical?" class=block":"",a="";if("function"==typeof i.input)a=i.input.call(this,e,o);else switch(i.input){case"radio":case"checkbox":m.iterateOptions(i.values,function(e,t){a+="<label"+r+'><input type="'+i.input+'" name="'+o+'" value="'+e+'"> '+t+"</label> "});break;case"select":a=this.getRuleValueSelect(o,e);break;case"textarea":a+='<textarea class="form-control" name="'+o+'"',i.size&&(a+=' cols="'+i.size+'"'),i.rows&&(a+=' rows="'+i.rows+'"'),void 0!==n.min&&(a+=' minlength="'+n.min+'"'),void 0!==n.max&&(a+=' maxlength="'+n.max+'"'),i.placeholder&&(a+=' placeholder="'+i.placeholder+'"'),a+="></textarea>";break;case"number":a+='<input class="form-control" type="number" name="'+o+'"',void 0!==n.step&&(a+=' step="'+n.step+'"'),void 0!==n.min&&(a+=' min="'+n.min+'"'),void 0!==n.max&&(a+=' max="'+n.max+'"'),i.placeholder&&(a+=' placeholder="'+i.placeholder+'"'),i.size&&(a+=' size="'+i.size+'"'),a+=">";break;default:a+='<input class="form-control" type="text" name="'+o+'"',i.placeholder&&(a+=' placeholder="'+i.placeholder+'"'),"string"===i.type&&void 0!==n.min&&(a+=' minlength="'+n.min+'"'),"string"===i.type&&void 0!==n.max&&(a+=' maxlength="'+n.max+'"'),i.size&&(a+=' size="'+i.size+'"'),a+=">"}return this.change("getRuleInput",a,e,o)};var m={};function n(){this.root=null,this.$=g(this)}(h.utils=m).iterateOptions=function(e,i){e&&(g.isArray(e)?e.forEach(function(e){g.isPlainObject(e)?"value"in e?i(e.value,e.label||e.value,e.optgroup):g.each(e,function(e,t){return i(e,t),!1}):i(e,e)}):g.each(e,function(e,t){i(e,t)}))},m.fmt=function(e,i){return Array.isArray(i)||(i=Array.prototype.slice.call(arguments,1)),e.replace(/{([0-9]+)}/g,function(e,t){return i[parseInt(t)]})},m.error=function(){var e=0,t="boolean"!=typeof arguments[e]||arguments[e++],i=arguments[e++],n=arguments[e++],o=Array.isArray(arguments[e])?arguments[e]:Array.prototype.slice.call(arguments,e);if(t){var r=new Error(m.fmt(n,o));throw r.name=i+"Error",r.args=o,r}console.error(i+"Error: "+m.fmt(n,o))},m.changeType=function(e,t){if(""!==e&&void 0!==e)switch(t){case"integer":return"string"!=typeof e||/^-?\d+$/.test(e)?parseInt(e):e;case"double":return"string"!=typeof e||/^-?\d+\.?\d*$/.test(e)?parseFloat(e):e;case"boolean":return"string"!=typeof e||/^(0|1|true|false){1}$/i.test(e)?!0===e||1===e||"true"===e.toLowerCase()||"1"===e:e;default:return e}},m.escapeString=function(e){return"string"!=typeof e?e:e.replace(/[\0\n\r\b\\\'\"]/g,function(e){switch(e){case"\0":return"\\0";case"\n":return"\\n";case"\r":return"\\r";case"\b":return"\\b";default:return"\\"+e}}).replace(/\t/g,"\\t").replace(/\x1a/g,"\\Z")},m.escapeRegExp=function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},m.escapeElementId=function(e){return e?e.replace(/(\\)?([:.\[\],])/g,function(e,t,i){return t?e:"\\"+i}):e},m.groupSort=function(e,i){var n=[],o=[];return e.forEach(function(e){var t;e[i]?-1==(t=n.lastIndexOf(e[i]))?t=n.length:t++:t=n.length,n.splice(t,0,e[i]),o.splice(t,0,e)}),o},m.defineModelProperties=function(e,t){t.forEach(function(i){Object.defineProperty(e.prototype,i,{enumerable:!0,get:function(){return this.__[i]},set:function(e){var t=null!==this.__[i]&&"object"==typeof this.__[i]?g.extend({},this.__[i]):this.__[i];this.__[i]=e,null!==this.model&&this.model.trigger("update",this,i,e,t)}})})},g.extend(n.prototype,{trigger:function(e){var t=new g.Event(e);return this.$.triggerHandler(t,Array.prototype.slice.call(arguments,1)),t},on:function(){return this.$.on.apply(this.$,Array.prototype.slice.call(arguments)),this},off:function(){return this.$.off.apply(this.$,Array.prototype.slice.call(arguments)),this},once:function(){return this.$.one.apply(this.$,Array.prototype.slice.call(arguments)),this}});var o=function(e,t){if(!(this instanceof o))return new o(e,t);Object.defineProperty(this,"__",{value:{}}),t.data("queryBuilderModel",this),this.__.level=1,this.__.error=null,this.__.flags={},this.__.data=void 0,this.$el=t,this.id=t[0].id,this.model=null,this.parent=e};m.defineModelProperties(o,["level","error","data","flags"]),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){return this.__.parent},set:function(e){this.__.parent=e,this.level=null===e?1:e.level+1,this.model=null===e?null:e.model}}),o.prototype.isRoot=function(){return 1===this.level},o.prototype.getPos=function(){return this.isRoot()?-1:this.parent.getNodePos(this)},o.prototype.drop=function(){var e=this.model;this.parent&&this.parent.removeNode(this),this.$el.removeData("queryBuilderModel"),null!==e&&e.trigger("drop",this)},o.prototype.moveAfter=function(e){this.isRoot()||this.move(e.parent,e.getPos()+1)},o.prototype.moveAtBegin=function(e){this.isRoot()||(void 0===e&&(e=this.parent),this.move(e,0))},o.prototype.moveAtEnd=function(e){this.isRoot()||(void 0===e&&(e=this.parent),this.move(e,0===e.length()?0:e.length()-1))},o.prototype.move=function(e,t){this.isRoot()||("number"==typeof e&&(t=e,e=this.parent),this.parent.removeNode(this),e.insertNode(this,t,!1),null!==this.model&&this.model.trigger("move",this,e,t))};var l=function(e,t){if(!(this instanceof l))return new l(e,t);o.call(this,e,t),this.rules=[],this.__.condition=null};l.prototype=Object.create(o.prototype),l.prototype.constructor=l,m.defineModelProperties(l,["condition"]),l.prototype.empty=function(){this.each("reverse",function(e){e.drop()},function(e){e.drop()})},l.prototype.drop=function(){this.empty(),o.prototype.drop.call(this)},l.prototype.length=function(){return this.rules.length},l.prototype.insertNode=function(e,t,i){return void 0===t&&(t=this.length()),this.rules.splice(t,0,e),e.parent=this,i&&null!==this.model&&this.model.trigger("add",this,e,t),e},l.prototype.addGroup=function(e,t){return this.insertNode(new l(this,e),t,!0)},l.prototype.addRule=function(e,t){return this.insertNode(new a(this,e),t,!0)},l.prototype.removeNode=function(e){var t=this.getNodePos(e);-1!==t&&(e.parent=null,this.rules.splice(t,1))},l.prototype.getNodePos=function(e){return this.rules.indexOf(e)},l.prototype.each=function(e,t,i,n){"boolean"!=typeof e&&"string"!=typeof e&&(n=i,i=t,t=e,e=!1),n=void 0===n?null:n;for(var o=e?this.rules.length-1:0,r=e?0:this.rules.length-1,a=e?-1:1,s=!1;(e?r<=o:o<=r)&&(this.rules[o]instanceof l?i&&(s=!1===i.call(n,this.rules[o])):t&&(s=!1===t.call(n,this.rules[o])),!s);o+=a);return!s},l.prototype.contains=function(t,e){return-1!==this.getNodePos(t)||!!e&&!this.each(function(){return!0},function(e){return!e.contains(t,!0)})};var a=function(e,t){if(!(this instanceof a))return new a(e,t);o.call(this,e,t),this._updating_value=!1,this._updating_input=!1,this.__.filter=null,this.__.operator=null,this.__.value=void 0};function c(e,t,i){var n,o,r=h.selectors;(n=t.closest(r.rule_container)).length&&(o="moveAfter"),o||(n=t.closest(r.group_header)).length&&(n=t.closest(r.group_container),o="moveAtBegin"),o||(n=t.closest(r.group_container)).length&&(o="moveAtEnd"),o&&(e[o](i.getModel(n)),i&&e instanceof a&&i.setRuleInputValue(e,e.value))}function r(e){var t=e.match(/(question_mark|numbered|named)(?:\((.)\))?/);return t=t||[null,"question_mark",void 0]}return a.prototype=Object.create(o.prototype),a.prototype.constructor=a,m.defineModelProperties(a,["filter","operator","value"]),a.prototype.isRoot=function(){return!1},h.Group=l,h.Rule=a,g.fn.queryBuilder=function(e){0===this.length&&m.error("Config","No target defined"),1<this.length&&m.error("Config","Unable to initialize on multiple target");var t=this.data("queryBuilder"),i="object"==typeof e&&e||{};if(!t&&"destroy"==e)return this;if(!t){var n=new h(this,i);this.data("queryBuilder",n),n.init(i.rules)}return"string"==typeof e?t[e].apply(t,Array.prototype.slice.call(arguments,1)):this},g.fn.queryBuilder.constructor=h,g.fn.queryBuilder.defaults=h.defaults,g.fn.queryBuilder.extend=h.extend,g.fn.queryBuilder.define=h.define,g.fn.queryBuilder.regional=h.regional,h.define("bt-checkbox",function(c){"glyphicons"==c.font&&this.$el.addClass("bt-checkbox-glyphicons"),this.on("getRuleInput.filter",function(o,e,r){var a=e.filter;if(("radio"===a.input||"checkbox"===a.input)&&!a.plugin){o.value="",a.colors||(a.colors={}),a.color&&(a.colors._def_=a.color);var s=a.vertical?' style="display:block"':"",l=0;m.iterateOptions(a.values,function(e,t){var i=a.colors[e]||a.colors._def_||c.color,n=r+"_"+l++;o.value+="<div"+s+' class="'+a.input+" "+a.input+"-"+i+'">   <input type="'+a.input+'" name="'+r+'" id="'+n+'" value="'+e+'">   <label for="'+n+'">'+t+"</label> </div>"})}})},{font:"glyphicons",color:"default"}),h.define("bt-selectpicker",function(i){g.fn.selectpicker&&g.fn.selectpicker.Constructor||m.error("MissingLibrary",'Bootstrap Select is required to use "bt-selectpicker" plugin. Get it here: http://silviomoreto.github.io/bootstrap-select');var n=h.selectors;this.on("afterCreateRuleFilters",function(e,t){t.$el.find(n.rule_filter).removeClass("form-control").selectpicker(i)}),this.on("afterCreateRuleOperators",function(e,t){t.$el.find(n.rule_operator).removeClass("form-control").selectpicker(i)}),this.on("afterUpdateRuleFilter",function(e,t){t.$el.find(n.rule_filter).selectpicker("render")}),this.on("afterUpdateRuleOperator",function(e,t){t.$el.find(n.rule_operator).selectpicker("render")}),this.on("beforeDeleteRule",function(e,t){t.$el.find(n.rule_filter).selectpicker("destroy"),t.$el.find(n.rule_operator).selectpicker("destroy")})},{container:"body",style:"btn-inverse btn-xs",width:"auto",showIcon:!1}),h.define("bt-tooltip-errors",function(n){g.fn.tooltip&&g.fn.tooltip.Constructor&&g.fn.tooltip.Constructor.prototype.fixTitle||m.error("MissingLibrary",'Bootstrap Tooltip is required to use "bt-tooltip-errors" plugin. Get it here: http://getbootstrap.com');var o=this;this.on("getRuleTemplate.filter getGroupTemplate.filter",function(e){var t=g(e.value);t.find(h.selectors.error_container).attr("data-toggle","tooltip"),e.value=t.prop("outerHTML")}),this.model.on("update",function(e,t,i){"error"==i&&o.settings.display_errors&&t.$el.find(h.selectors.error_container).eq(0).tooltip(n).tooltip("hide").tooltip("fixTitle")})},{placement:"right"}),h.extend({setFilters:function(e,t){var i=this;void 0===t&&(t=e,e=!1),t=this.checkFilters(t);var n=(t=this.change("setFilters",t)).map(function(e){return e.id});if(e||function e(t){t.each(function(e){e.filter&&-1===n.indexOf(e.filter.id)&&m.error("ChangeFilter",'A rule is using filter "{0}"',e.filter.id)},e)}(this.model.root),this.filters=t,function e(t){t.each(!0,function(e){e.filter&&-1===n.indexOf(e.filter.id)?(e.drop(),i.trigger("rulesChanged")):(i.createRuleFilters(e),e.$el.find(h.selectors.rule_filter).val(e.filter?e.filter.id:"-1"),i.trigger("afterUpdateRuleFilter",e))},e)}(this.model.root),this.settings.plugins&&(this.settings.plugins["unique-filter"]&&this.updateDisabledFilters(),this.settings.plugins["bt-selectpicker"]&&this.$el.find(h.selectors.rule_filter).selectpicker("render")),this.settings.default_filter)try{this.getFilterById(this.settings.default_filter)}catch(e){this.settings.default_filter=null}this.trigger("afterSetFilters",t)},addFilter:function(e,i){void 0===i||"#end"==i?i=this.filters.length:"#start"==i&&(i=0),g.isArray(e)||(e=[e]);var t=g.extend(!0,[],this.filters);parseInt(i)==i?Array.prototype.splice.apply(t,[i,0].concat(e)):this.filters.some(function(e,t){if(e.id==i)return i=t+1,!0})?Array.prototype.splice.apply(t,[i,0].concat(e)):Array.prototype.push.apply(t,e),this.setFilters(t)},removeFilter:function(t,e){var i=g.extend(!0,[],this.filters);"string"==typeof t&&(t=[t]),i=i.filter(function(e){return-1===t.indexOf(e.id)}),this.setFilters(e,i)}}),h.define("chosen-selectpicker",function(i){g.fn.chosen||m.error("MissingLibrary",'chosen is required to use "chosen-selectpicker" plugin. Get it here: https://github.com/harvesthq/chosen'),this.settings.plugins["bt-selectpicker"]&&m.error("Conflict","bt-selectpicker is already selected as the dropdown plugin. Please remove chosen-selectpicker from the plugin list");var n=h.selectors;this.on("afterCreateRuleFilters",function(e,t){t.$el.find(n.rule_filter).removeClass("form-control").chosen(i)}),this.on("afterCreateRuleOperators",function(e,t){t.$el.find(n.rule_operator).removeClass("form-control").chosen(i)}),this.on("afterUpdateRuleFilter",function(e,t){t.$el.find(n.rule_filter).trigger("chosen:updated")}),this.on("afterUpdateRuleOperator",function(e,t){t.$el.find(n.rule_operator).trigger("chosen:updated")}),this.on("beforeDeleteRule",function(e,t){t.$el.find(n.rule_filter).chosen("destroy"),t.$el.find(n.rule_operator).chosen("destroy")})}),h.define("filter-description",function(o){"inline"===o.mode?this.on("afterUpdateRuleFilter afterUpdateRuleOperator",function(e,t){var i=t.$el.find("p.filter-description"),n=e.builder.getFilterDescription(t.filter,t);n?(0===i.length?(i=g('<p class="filter-description"></p>')).appendTo(t.$el):i.css("display",""),i.html('<i class="'+o.icon+'"></i> '+n)):i.hide()}):"popover"===o.mode?(g.fn.popover&&g.fn.popover.Constructor&&g.fn.popover.Constructor.prototype.fixTitle||m.error("MissingLibrary",'Bootstrap Popover is required to use "filter-description" plugin. Get it here: http://getbootstrap.com'),this.on("afterUpdateRuleFilter afterUpdateRuleOperator",function(e,t){var i=t.$el.find("button.filter-description"),n=e.builder.getFilterDescription(t.filter,t);n?(0===i.length?((i=g('<button type="button" class="btn btn-xs btn-info filter-description" data-toggle="popover"><i class="'+o.icon+'"></i></button>')).prependTo(t.$el.find(h.selectors.rule_actions)),i.popover({placement:"left",container:"body",html:!0}),i.on("mouseout",function(){i.popover("hide")})):i.css("display",""),i.data("bs.popover").options.content=n,i.attr("aria-describedby")&&i.popover("show")):(i.hide(),i.data("bs.popover")&&i.popover("hide"))})):"bootbox"===o.mode&&("bootbox"in window||m.error("MissingLibrary",'Bootbox is required to use "filter-description" plugin. Get it here: http://bootboxjs.com'),this.on("afterUpdateRuleFilter afterUpdateRuleOperator",function(e,t){var i=t.$el.find("button.filter-description"),n=e.builder.getFilterDescription(t.filter,t);n?(0===i.length?((i=g('<button type="button" class="btn btn-xs btn-info filter-description" data-toggle="bootbox"><i class="'+o.icon+'"></i></button>')).prependTo(t.$el.find(h.selectors.rule_actions)),i.on("click",function(){bootbox.alert(i.data("description"))})):i.css("display",""),i.data("description",n)):i.hide()}))},{icon:"glyphicon glyphicon-info-sign",mode:"popover"}),h.extend({getFilterDescription:function(e,t){return e?"function"==typeof e.description?e.description.call(this,t):e.description:void 0}}),h.define("invert",function(i){var n=this,o=h.selectors;this.on("afterInit",function(){n.$el.on("click.queryBuilder","[data-invert=group]",function(){var e=g(this).closest(o.group_container);n.invert(n.getModel(e),i)}),i.display_rules_button&&i.invert_rules&&n.$el.on("click.queryBuilder","[data-invert=rule]",function(){var e=g(this).closest(o.rule_container);n.invert(n.getModel(e),i)})}),i.disable_template||(this.on("getGroupTemplate.filter",function(e){var t=g(e.value);t.find(o.condition_container).after('<button type="button" class="btn btn-xs btn-default" data-invert="group"><i class="'+i.icon+'"></i> '+n.translate("invert")+"</button>"),e.value=t.prop("outerHTML")}),i.display_rules_button&&i.invert_rules&&this.on("getRuleTemplate.filter",function(e){var t=g(e.value);t.find(o.rule_actions).prepend('<button type="button" class="btn btn-xs btn-default" data-invert="rule"><i class="'+i.icon+'"></i> '+n.translate("invert")+"</button>"),e.value=t.prop("outerHTML")}))},{icon:"glyphicon glyphicon-random",recursive:!0,invert_rules:!0,display_rules_button:!1,silent_fail:!1,disable_template:!1}),h.defaults({operatorOpposites:{equal:"not_equal",not_equal:"equal",in:"not_in",not_in:"in",less:"greater_or_equal",less_or_equal:"greater",greater:"less_or_equal",greater_or_equal:"less",between:"not_between",not_between:"between",begins_with:"not_begins_with",not_begins_with:"begins_with",contains:"not_contains",not_contains:"contains",ends_with:"not_ends_with",not_ends_with:"ends_with",is_empty:"is_not_empty",is_not_empty:"is_empty",is_null:"is_not_null",is_not_null:"is_null"},conditionOpposites:{AND:"OR",OR:"AND"}}),h.extend({invert:function(e,t){if(!(e instanceof o)){if(!this.model.root)return;t=e,e=this.model.root}if("object"!=typeof t&&(t={}),void 0===t.recursive&&(t.recursive=!0),void 0===t.invert_rules&&(t.invert_rules=!0),void 0===t.silent_fail&&(t.silent_fail=!1),void 0===t.trigger&&(t.trigger=!0),e instanceof l){if(this.settings.conditionOpposites[e.condition]?e.condition=this.settings.conditionOpposites[e.condition]:t.silent_fail||m.error("InvertCondition",'Unknown inverse of condition "{0}"',e.condition),t.recursive){var i=g.extend({},t,{trigger:!1});e.each(function(e){t.invert_rules&&this.invert(e,i)},function(e){this.invert(e,i)},this)}}else if(e instanceof a&&e.operator&&!e.filter.no_invert)if(this.settings.operatorOpposites[e.operator.type]){var n=this.settings.operatorOpposites[e.operator.type];e.filter.operators&&-1==e.filter.operators.indexOf(n)||(e.operator=this.getOperatorByType(n))}else t.silent_fail||m.error("InvertOperator",'Unknown inverse of operator "{0}"',e.operator.type);t.trigger&&(this.trigger("afterInvert",e,t),this.trigger("rulesChanged"))}}),h.defaults({mongoOperators:{equal:function(e){return e[0]},not_equal:function(e){return{$ne:e[0]}},in:function(e){return{$in:e}},not_in:function(e){return{$nin:e}},less:function(e){return{$lt:e[0]}},less_or_equal:function(e){return{$lte:e[0]}},greater:function(e){return{$gt:e[0]}},greater_or_equal:function(e){return{$gte:e[0]}},between:function(e){return{$gte:e[0],$lte:e[1]}},not_between:function(e){return{$lt:e[0],$gt:e[1]}},begins_with:function(e){return{$regex:"^"+m.escapeRegExp(e[0])}},not_begins_with:function(e){return{$regex:"^(?!"+m.escapeRegExp(e[0])+")"}},contains:function(e){return{$regex:m.escapeRegExp(e[0])}},not_contains:function(e){return{$regex:"^((?!"+m.escapeRegExp(e[0])+").)*$",$options:"s"}},ends_with:function(e){return{$regex:m.escapeRegExp(e[0])+"$"}},not_ends_with:function(e){return{$regex:"(?<!"+m.escapeRegExp(e[0])+")$"}},is_empty:function(e){return""},is_not_empty:function(e){return{$ne:""}},is_null:function(e){return null},is_not_null:function(e){return{$ne:null}}},mongoRuleOperators:{$eq:function(e){return{val:e,op:null===e?"is_null":""===e?"is_empty":"equal"}},$ne:function(e){return{val:e=e.$ne,op:null===e?"is_not_null":""===e?"is_not_empty":"not_equal"}},$regex:function(e){return"^(?!"==(e=e.$regex).slice(0,4)&&")"==e.slice(-1)?{val:e.slice(4,-1),op:"not_begins_with"}:"^((?!"==e.slice(0,5)&&").)*$"==e.slice(-5)?{val:e.slice(5,-5),op:"not_contains"}:"(?<!"==e.slice(0,4)&&")$"==e.slice(-2)?{val:e.slice(4,-2),op:"not_ends_with"}:"$"==e.slice(-1)?{val:e.slice(0,-1),op:"ends_with"}:"^"==e.slice(0,1)?{val:e.slice(1),op:"begins_with"}:{val:e,op:"contains"}},between:function(e){return{val:[e.$gte,e.$lte],op:"between"}},not_between:function(e){return{val:[e.$lt,e.$gt],op:"not_between"}},$in:function(e){return{val:e.$in,op:"in"}},$nin:function(e){return{val:e.$nin,op:"not_in"}},$lt:function(e){return{val:e.$lt,op:"less"}},$lte:function(e){return{val:e.$lte,op:"less_or_equal"}},$gt:function(e){return{val:e.$gt,op:"greater"}},$gte:function(e){return{val:e.$gte,op:"greater_or_equal"}}}}),h.extend({getMongo:function(e){if(!(e=void 0===e?this.getRules():e))return null;var a=this;return function o(e){if(e.condition||(e.condition=a.settings.default_condition),-1===["AND","OR"].indexOf(e.condition.toUpperCase())&&m.error("UndefinedMongoCondition",'Unable to build MongoDB query with condition "{0}"',e.condition),!e.rules)return{};var r=[];e.rules.forEach(function(e){if(e.rules&&0<e.rules.length)r.push(o(e));else{var t=a.settings.mongoOperators[e.operator],i=a.getOperatorByType(e.operator);void 0===t&&m.error("UndefinedMongoOperator",'Unknown MongoDB operation for operator "{0}"',e.operator),0!==i.nb_inputs&&(e.value instanceof Array||(e.value=[e.value]));var n={};n[a.change("getMongoDBField",e.field,e)]=t.call(a,e.value),r.push(a.change("ruleToMongo",n,e,e.value,t))}});var t={};return t["$"+e.condition.toLowerCase()]=r,a.change("groupToMongo",t,e)}(e)},getRulesFromMongo:function(e){if(null==e)return null;var d=this;if("rules"in(e=d.change("parseMongoNode",e))&&"condition"in e)return e;if("id"in e&&"operator"in e&&"value"in e)return{condition:this.settings.default_condition,rules:[e]};var t=d.getMongoCondition(e);return t||m.error("MongoParse","Invalid MongoDB query format"),function c(e,t){var i=e[t],u=[];return i.forEach(function(e){if("rules"in(e=d.change("parseMongoNode",e))&&"condition"in e)u.push(e);else if("id"in e&&"operator"in e&&"value"in e)u.push(e);else{var t=d.getMongoCondition(e);if(t)u.push(c(e,t));else{var i=Object.keys(e)[0],n=e[i],o=d.getMongoOperator(n);void 0===o&&m.error("MongoParse","Invalid MongoDB query format");var r=d.settings.mongoRuleOperators[o];void 0===r&&m.error("UndefinedMongoOperator",'JSON Rule operation unknown for operator "{0}"',o);var a=r.call(d,n),s=d.getMongoDBFieldID(i,n),l=d.change("mongoToRule",{id:s,field:i,operator:a.op,value:a.val},e);u.push(l)}}}),d.change("mongoToGroup",{condition:t.replace("$","").toUpperCase(),rules:u},e)}(e,t)},setRulesFromMongo:function(e){this.setRules(this.getRulesFromMongo(e))},getMongoDBFieldID:function(t,e){var i=this.filters.filter(function(e){return e.field===t});return 1===i.length?i[0].id:this.change("getMongoDBFieldID",t,e)},getMongoOperator:function(e){if(null===e||"object"!=typeof e)return"$eq";if(void 0!==e.$gte&&void 0!==e.$lte)return"between";if(void 0!==e.$lt&&void 0!==e.$gt)return"not_between";var t=Object.keys(e).filter(function(e){return!!this.settings.mongoRuleOperators[e]}.bind(this));return 1===t.length?t[0]:void 0},getMongoCondition:function(e){for(var t=Object.keys(e),i=0,n=t.length;i<n;i++)if("$or"===t[i].toLowerCase()||"$and"===t[i].toLowerCase())return t[i]}}),h.define("not-group",function(i){var n=this;this.on("afterInit",function(){n.$el.on("click.queryBuilder","[data-not=group]",function(){var e=g(this).closest(h.selectors.group_container),t=n.getModel(e);t.not=!t.not}),n.model.on("update",function(e,t,i){t instanceof l&&"not"===i&&n.updateGroupNot(t)})}),this.on("afterAddGroup",function(e,t){t.__.not=!1}),i.disable_template||this.on("getGroupTemplate.filter",function(e){var t=g(e.value);t.find(h.selectors.condition_container).prepend('<button type="button" class="btn btn-xs btn-default" data-not="group"><i class="'+i.icon_unchecked+'"></i> '+n.translate("NOT")+"</button>"),e.value=t.prop("outerHTML")}),this.on("groupToJson.filter",function(e,t){e.value.not=t.not}),this.on("jsonToGroup.filter",function(e,t){e.value.not=!!t.not}),this.on("groupToSQL.filter",function(e,t){t.not&&(e.value="NOT ( "+e.value+" )")}),this.on("parseSQLNode.filter",function(e){e.value.name&&"NOT"==e.value.name.toUpperCase()&&(e.value=e.value.arguments.value[0],-1===["AND","OR"].indexOf(e.value.operation.toUpperCase())&&(e.value=new SQLParser.nodes.Op(n.settings.default_condition,e.value,null)),e.value.not=!0)}),this.on("sqlGroupsDistinct.filter",function(e,t,i,n){i.not&&0<n&&(e.value=!0)}),this.on("sqlToGroup.filter",function(e,t){e.value.not=!!t.not}),this.on("groupToMongo.filter",function(e,t){var i="$"+t.condition.toLowerCase();t.not&&e.value[i]&&(e.value={$nor:[e.value]})}),this.on("parseMongoNode.filter",function(e){var t=Object.keys(e.value);"$nor"==t[0]&&(e.value=e.value[t[0]][0],e.value.not=!0)}),this.on("mongoToGroup.filter",function(e,t){e.value.not=!!t.not})},{icon_unchecked:"glyphicon glyphicon-unchecked",icon_checked:"glyphicon glyphicon-check",disable_template:!1}),m.defineModelProperties(l,["not"]),h.selectors.group_not=h.selectors.group_header+" [data-not=group]",h.extend({updateGroupNot:function(e){var t=this.plugins["not-group"];e.$el.find(">"+h.selectors.group_not).toggleClass("active",e.not).find("i").attr("class",e.not?t.icon_checked:t.icon_unchecked),this.trigger("afterUpdateGroupNot",e),this.trigger("rulesChanged")}}),h.define("sortable",function(n){var o,r,a,s;"interact"in window||m.error("MissingLibrary",'interact.js is required to use "sortable" plugin. Get it here: http://interactjs.io'),void 0!==n.default_no_sortable&&(m.error(!1,"Config",'Sortable plugin : "default_no_sortable" options is deprecated, use standard "default_rule_flags" and "default_group_flags" instead'),this.settings.default_rule_flags.no_sortable=this.settings.default_group_flags.no_sortable=n.default_no_sortable),interact.dynamicDrop(!0),interact.pointerMoveTolerance(10),this.on("afterAddRule afterAddGroup",function(e,t){if(t!=o){var i=e.builder;n.inherit_no_sortable&&t.parent&&t.parent.flags.no_sortable&&(t.flags.no_sortable=!0),n.inherit_no_drop&&t.parent&&t.parent.flags.no_drop&&(t.flags.no_drop=!0),t.flags.no_sortable||interact(t.$el[0]).draggable({allowFrom:h.selectors.drag_handle,onstart:function(e){s=!1,a=i.getModel(e.target),r=a.$el.clone().appendTo(a.$el.parent()).width(a.$el.outerWidth()).addClass("dragging");var t=g('<div class="rule-placeholder">&nbsp;</div>').height(a.$el.outerHeight());o=a.parent.addRule(t,a.getPos()),a.$el.hide()},onmove:function(e){r[0].style.top=e.clientY-15+"px",r[0].style.left=e.clientX-15+"px"},onend:function(e){e.dropzone&&(c(a,g(e.relatedTarget),i),s=!0),r.remove(),r=void 0,o.drop(),o=void 0,a.$el.css("display",""),i.trigger("afterMove",a),i.trigger("rulesChanged")}}),t.flags.no_drop||(interact(t.$el[0]).dropzone({accept:h.selectors.rule_and_group_containers,ondragenter:function(e){c(o,g(e.target),i)},ondrop:function(e){s||c(a,g(e.target),i)}}),t instanceof l&&interact(t.$el.find(h.selectors.group_header)[0]).dropzone({accept:h.selectors.rule_and_group_containers,ondragenter:function(e){c(o,g(e.target),i)},ondrop:function(e){s||c(a,g(e.target),i)}}))}}),this.on("beforeDeleteRule beforeDeleteGroup",function(e,t){e.isDefaultPrevented()||(interact(t.$el[0]).unset(),t instanceof l&&interact(t.$el.find(h.selectors.group_header)[0]).unset())}),this.on("afterApplyRuleFlags afterApplyGroupFlags",function(e,t){t.flags.no_sortable&&t.$el.find(".drag-handle").remove()}),n.disable_template||(this.on("getGroupTemplate.filter",function(e,t){if(1<t){var i=g(e.value);i.find(h.selectors.condition_container).after('<div class="drag-handle"><i class="'+n.icon+'"></i></div>'),e.value=i.prop("outerHTML")}}),this.on("getRuleTemplate.filter",function(e){var t=g(e.value);t.find(h.selectors.rule_header).after('<div class="drag-handle"><i class="'+n.icon+'"></i></div>'),e.value=t.prop("outerHTML")}))},{inherit_no_sortable:!0,inherit_no_drop:!0,icon:"glyphicon glyphicon-sort",disable_template:!1}),h.selectors.rule_and_group_containers=h.selectors.rule_container+", "+h.selectors.group_container,h.selectors.drag_handle=".drag-handle",h.defaults({default_rule_flags:{no_sortable:!1,no_drop:!1},default_group_flags:{no_sortable:!1,no_drop:!1}}),h.define("sql-support",function(e){},{boolean_as_integer:!0}),h.defaults({sqlOperators:{equal:{op:"= ?"},not_equal:{op:"!= ?"},in:{op:"IN(?)",sep:", "},not_in:{op:"NOT IN(?)",sep:", "},less:{op:"< ?"},less_or_equal:{op:"<= ?"},greater:{op:"> ?"},greater_or_equal:{op:">= ?"},between:{op:"BETWEEN ?",sep:" AND "},not_between:{op:"NOT BETWEEN ?",sep:" AND "},begins_with:{op:"LIKE(?)",mod:"{0}%"},not_begins_with:{op:"NOT LIKE(?)",mod:"{0}%"},contains:{op:"LIKE(?)",mod:"%{0}%"},not_contains:{op:"NOT LIKE(?)",mod:"%{0}%"},ends_with:{op:"LIKE(?)",mod:"%{0}"},not_ends_with:{op:"NOT LIKE(?)",mod:"%{0}"},is_empty:{op:"= ''"},is_not_empty:{op:"!= ''"},is_null:{op:"IS NULL"},is_not_null:{op:"IS NOT NULL"}},sqlRuleOperator:{"=":function(e){return{val:e,op:""===e?"is_empty":"equal"}},"!=":function(e){return{val:e,op:""===e?"is_not_empty":"not_equal"}},LIKE:function(e){return"%"==e.slice(0,1)&&"%"==e.slice(-1)?{val:e.slice(1,-1),op:"contains"}:"%"==e.slice(0,1)?{val:e.slice(1),op:"ends_with"}:"%"==e.slice(-1)?{val:e.slice(0,-1),op:"begins_with"}:void m.error("SQLParse",'Invalid value for LIKE operator "{0}"',e)},"NOT LIKE":function(e){return"%"==e.slice(0,1)&&"%"==e.slice(-1)?{val:e.slice(1,-1),op:"not_contains"}:"%"==e.slice(0,1)?{val:e.slice(1),op:"not_ends_with"}:"%"==e.slice(-1)?{val:e.slice(0,-1),op:"not_begins_with"}:void m.error("SQLParse",'Invalid value for NOT LIKE operator "{0}"',e)},IN:function(e){return{val:e,op:"in"}},"NOT IN":function(e){return{val:e,op:"not_in"}},"<":function(e){return{val:e,op:"less"}},"<=":function(e){return{val:e,op:"less_or_equal"}},">":function(e){return{val:e,op:"greater"}},">=":function(e){return{val:e,op:"greater_or_equal"}},BETWEEN:function(e){return{val:e,op:"between"}},"NOT BETWEEN":function(e){return{val:e,op:"not_between"}},IS:function(e){return null!==e&&m.error("SQLParse","Invalid value for IS operator"),{val:null,op:"is_null"}},"IS NOT":function(e){return null!==e&&m.error("SQLParse","Invalid value for IS operator"),{val:null,op:"is_not_null"}}},sqlStatements:{question_mark:function(){var i=[];return{add:function(e,t){return i.push(t),"?"},run:function(){return i}}},numbered:function(i){(!i||1<i.length)&&(i="$");var n=0,o=[];return{add:function(e,t){return o.push(t),i+ ++n},run:function(){return o}}},named:function(n){(!n||1<n.length)&&(n=":");var o={},r={};return{add:function(e,t){o[e.field]||(o[e.field]=1);var i=e.field+"_"+o[e.field]++;return r[i]=t,n+i},run:function(){return r}}}},sqlRuleStatement:{question_mark:function(t){var i=0;return{parse:function(e){return"?"==e?t[i++]:e},esc:function(e){return e.replace(/\?/g,"'?'")}}},numbered:function(t,i){(!i||1<i.length)&&(i="$");var n=new RegExp("^\\"+i+"[0-9]+$"),o=new RegExp("\\"+i+"([0-9]+)","g");return{parse:function(e){return n.test(e)?t[e.slice(1)-1]:e},esc:function(e){return e.replace(o,"'"+("$"==i?"$$":i)+"$1'")}}},named:function(t,i){(!i||1<i.length)&&(i=":");var n=new RegExp("^\\"+i),o=new RegExp("\\"+i+"("+Object.keys(t).join("|")+")","g");return{parse:function(e){return n.test(e)?t[e.slice(1)]:e},esc:function(e){return e.replace(o,"'"+("$"==i?"$$":i)+"$1'")}}}}}),h.extend({getSQL:function(l,c,e){if(!(e=void 0===e?this.getRules():e))return null;c=c?"\n":" ";var u=this.getPluginOptions("sql-support","boolean_as_integer");if(!0===l&&(l="question_mark"),"string"==typeof l){var t=r(l);l=this.settings.sqlStatements[t[1]](t[2])}var d=this,i=function a(e){if(e.condition||(e.condition=d.settings.default_condition),-1===["AND","OR"].indexOf(e.condition.toUpperCase())&&m.error("UndefinedSQLCondition",'Unable to build SQL query with condition "{0}"',e.condition),!e.rules)return"";var s=[];e.rules.forEach(function(i){if(i.rules&&0<i.rules.length)s.push("("+c+a(i)+c+")"+c);else{var n=d.settings.sqlOperators[i.operator],e=d.getOperatorByType(i.operator),o="";void 0===n&&m.error("UndefinedSQLOperator",'Unknown SQL operation for operator "{0}"',i.operator),0!==e.nb_inputs&&(i.value instanceof Array||(i.value=[i.value]),i.value.forEach(function(e,t){0<t&&(o+=n.sep),"boolean"==i.type&&u?e=e?1:0:l||"integer"===i.type||"double"===i.type||"boolean"===i.type||(e=m.escapeString(e)),n.mod&&(e=m.fmt(n.mod,e)),l?o+=l.add(i,e):("string"==typeof e&&(e="'"+e+"'"),o+=e)}));var t=function(e){return n.op.replace("?",function(){return e})},r=d.change("getSQLField",i.field,i)+" "+t(o);s.push(d.change("ruleToSQL",r,i,o,t))}});var t=s.join(" "+e.condition+c);return d.change("groupToSQL",t,e)}(e);return l?{sql:i,params:l.run()}:{sql:i}},getRulesFromSQL:function(e,h){"SQLParser"in window||m.error("MissingLibrary","SQLParser is required to parse SQL queries. Get it here https://github.com/mistic100/sql-parser");var p=this;if("string"==typeof e&&(e={sql:e}),!0===h&&(h="question_mark"),"string"==typeof h){var t=r(h);h=this.settings.sqlRuleStatement[t[1]](e.params,t[2])}h&&(e.sql=h.esc(e.sql)),0!==e.sql.toUpperCase().indexOf("SELECT")&&(e.sql="SELECT * FROM table WHERE "+e.sql);var i=SQLParser.parse(e.sql);i.where||m.error("SQLParse","No WHERE clause found");var n=p.change("parseSQLNode",i.where.conditions);if("rules"in n&&"condition"in n)return n;if("id"in n&&"operator"in n&&"value"in n)return{condition:this.settings.default_condition,rules:[n]};var o=p.change("sqlToGroup",{condition:this.settings.default_condition,rules:[]},n),f=o;return function e(t,i){if(null!==t)if("rules"in(t=p.change("parseSQLNode",t))&&"condition"in t)f.rules.push(t);else if("id"in t&&"operator"in t&&"value"in t)f.rules.push(t);else if("left"in t&&"right"in t&&"operation"in t||m.error("SQLParse","Unable to parse WHERE clause"),-1!==["AND","OR"].indexOf(t.operation.toUpperCase())){if(p.change("sqlGroupsDistinct",0<i&&f.condition!=t.operation.toUpperCase(),f,t,i)){var n=p.change("sqlToGroup",{condition:p.settings.default_condition,rules:[]},t);f.rules.push(n),f=n}f.condition=t.operation.toUpperCase(),i++;var o=f;e(t.left,i),f=o,e(t.right,i)}else{var r;g.isPlainObject(t.right.value)&&m.error("SQLParse","Value format not supported for {0}.",t.left.value),r=g.isArray(t.right.value)?t.right.value.map(function(e){return e.value}):t.right.value,h&&(r=g.isArray(r)?r.map(h.parse):h.parse(r));var a=t.operation.toUpperCase();"<>"==a&&(a="!=");var s=p.settings.sqlRuleOperator[a];void 0===s&&m.error("UndefinedSQLOperator",'Invalid SQL operation "{0}".',t.operation);var l,c=s.call(this,r,t.operation);"values"in t.left?l=t.left.values.join("."):"value"in t.left?l=t.left.value:m.error("SQLParse","Cannot find field name in {0}",JSON.stringify(t.left));var u=p.getSQLFieldID(l,r),d=p.change("sqlToRule",{id:u,field:l,operator:c.op,value:c.val},t);f.rules.push(d)}}(n,0),o},setRulesFromSQL:function(e,t){this.setRules(this.getRulesFromSQL(e,t))},getSQLFieldID:function(t,e){var i=this.filters.filter(function(e){return e.field.toLowerCase()===t.toLowerCase()});return 1===i.length?i[0].id:this.change("getSQLFieldID",t,e)}}),h.define("unique-filter",function(){this.status.used_filters={},this.on("afterUpdateRuleFilter",this.updateDisabledFilters),this.on("afterDeleteRule",this.updateDisabledFilters),this.on("afterCreateRuleFilters",this.applyDisabledFilters),this.on("afterReset",this.clearDisabledFilters),this.on("afterClear",this.clearDisabledFilters),this.on("getDefaultFilter.filter",function(t,i){var n=t.builder;n.updateDisabledFilters(),t.value.id in n.status.used_filters&&(n.filters.some(function(e){if(!(e.id in n.status.used_filters)||0<n.status.used_filters[e.id].length&&-1===n.status.used_filters[e.id].indexOf(i.parent))return t.value=e,!0})||(m.error(!1,"UniqueFilter","No more non-unique filters available"),t.value=void 0))})}),h.extend({updateDisabledFilters:function(e){var i=e?e.builder:this;i.status.used_filters={},i.model&&(function t(e){e.each(function(e){e.filter&&e.filter.unique&&(i.status.used_filters[e.filter.id]||(i.status.used_filters[e.filter.id]=[]),"group"==e.filter.unique&&i.status.used_filters[e.filter.id].push(e.parent))},function(e){t(e)})}(i.model.root),i.applyDisabledFilters(e))},clearDisabledFilters:function(e){var t=e?e.builder:this;t.status.used_filters={},t.applyDisabledFilters(e)},applyDisabledFilters:function(e){var i=e?e.builder:this;i.$el.find(h.selectors.filter_container+" option").prop("disabled",!1),g.each(i.status.used_filters,function(t,e){0===e.length?i.$el.find(h.selectors.filter_container+' option[value="'+t+'"]:not(:selected)').prop("disabled",!0):e.forEach(function(e){e.each(function(e){e.$el.find(h.selectors.filter_container+' option[value="'+t+'"]:not(:selected)').prop("disabled",!0)})})}),i.settings.plugins&&i.settings.plugins["bt-selectpicker"]&&i.$el.find(h.selectors.rule_filter).selectpicker("render")}}),h.regional.en={__locale:"English (en)",__author:'Damien "Mistic" Sorel, http://www.strangeplanet.fr',add_rule:t("querybuilder.common.add_rule"),add_group:t("querybuilder.common.add_group"),delete_rule:t("querybuilder.common.delete_rule"),delete_group:t("querybuilder.common.delete_group"),conditions:{AND:t("querybuilder.conditions.AND"),OR:t("querybuilder.conditions.OR")},operators:{equal:t("querybuilder.operators.equal"),not_equal:t("querybuilder.operators.not_equal"),in:t("querybuilder.operators.in"),not_in:t("querybuilder.operators.not_in"),less:t("querybuilder.operators.less"),less_or_equal:t("querybuilder.operators.less_or_equal"),greater:t("querybuilder.operators.greater"),greater_or_equal:t("querybuilder.operators.greater_or_equal"),between:t("querybuilder.operators.between"),not_between:t("querybuilder.operators.not_between"),begins_with:t("querybuilder.operators.begins_with"),not_begins_with:t("querybuilder.operators.not_begins_with"),contains:t("querybuilder.operators.contains"),not_contains:t("querybuilder.operators.not_contains"),ends_with:t("querybuilder.operators.ends_with"),not_ends_with:t("querybuilder.operators.not_ends_with"),is_empty:t("querybuilder.operators.is_empty"),is_not_empty:t("querybuilder.operators.is_not_empty"),is_null:t("querybuilder.operators.is_null"),is_not_null:t("querybuilder.operators.is_not_null"),before:t("target.operator.before"),after:t("target.operator.after"),like:"Like",not_like:"Not like"},errors:{no_filter:t("querybuilder.errors.no_filter"),empty_group:t("querybuilder.errors.empty_group"),radio_empty:t("querybuilder.errors.radio_empty"),checkbox_empty:t("querybuilder.errors.checkbox_empty"),select_empty:t("querybuilder.errors.select_empty"),string_empty:t("querybuilder.errors.string_empty"),string_exceed_min_length:t("querybuilder.errors.string_exceed_min_length"),string_exceed_max_length:t("querybuilder.errors.string_exceed_max_length"),string_invalid_format:t("querybuilder.errors.string_invalid_format"),number_nan:t("querybuilder.errors.number_nan"),number_not_integer:t("querybuilder.errors.number_not_integer"),number_not_double:t("querybuilder.errors.number_not_double"),number_exceed_min:t("querybuilder.errors.number_exceed_min"),number_exceed_max:t("querybuilder.errors.number_exceed_max"),number_wrong_step:t("querybuilder.errors.number_wrong_step"),number_between_invalid:"Invalid values, {0} is greater than {1}",datetime_empty:t("querybuilder.errors.datetime_empty"),datetime_invalid:t("querybuilder.errors.datetime_invalid"),datetime_exceed_min:t("querybuilder.errors.datetime_exceed_min"),datetime_exceed_max:t("querybuilder.errors.datetime_exceed_max"),datetime_between_invalid:"Invalid values, {0} is greater than {1}",boolean_not_valid:t("querybuilder.errors.boolean_not_valid"),operator_not_multiple:t("querybuilder.errors.operator_not_multiple")},invert:t("querybuilder.common.invert"),NOT:"NOT"},h.defaults({lang_code:"en"}),h}),function(){var n;(n=function(e,n,t){var o=this;n=_.bind(n,this),t=t&&t.exists()?t.first():$(document),_.each(e,function(e,i){t.on(i,e,function(e,t){o.event=e,o.trigger=i,o.el=$(this),o.data=t,n(),$(o.event.target).is("a")&&o.event.preventDefault()})})}).new=function(e,t,i){new n(e,t,i)},n.translate=function(e){var i={};return _.each(e,function(e,t){e=e.split(/,\s?/),e=_.map(e,function(e){return'[data-action="'+e+'"]'}).join(", "),i[t]=e}),i},AGN.Lib.Action=n}(),AGN.Lib.AutoSave={initialize:function(e,i,n,o,r){!function(e,i,n){var o=AGN.Lib.Storage.get("autosave#"+e);if(o){var r=i?i(o.values,o.timestamp):o.values;if(r){var a=AGN.Lib.Template.text("autosave-restore",{modalClass:"",title:t("autosave.confirm.title"),content:t("autosave.confirm.question",new Date(o.timestamp)),negative:t("autosave.discard"),positive:t("autosave.restore")});AGN.Lib.Confirm.create(a).done(function(){n(!0===r?o.values:r,o.timestamp),AGN.Lib.Messages(t("autosave.success.title"),t("autosave.success.message"),"success")}).fail(function(){AGN.Lib.Storage.delete("autosave#"+e)})}}}(e,n,o),function(t,i,e){function n(){var e=i();return e&&AGN.Lib.Storage.set("autosave#"+t,{timestamp:(new Date).getTime(),values:e}),!1!==e}if(0<e)var o=setInterval(function(){n()||clearInterval(o)},1e3*e);var r=function(){n()||$(document).unbind("ajax:unauthorized",r)};$(document).on("ajax:unauthorized",r)}(e,i,r)}},function(){function f(e){var t=e.parent().width(),i=0;return e.children("li").each(function(){i+=$(this).outerWidth(!0)}),i<=t}AGN.Lib.Breadcrumbs={truncate:function(e){$.each(e.find(".breadcrumbs.js-ellipsis"),function(e,t){var i=$(t),n=i.children("li");if(i.find("*").removeClass("breadcrumb-element-small"),n.removeClass("abbreviated"),n.css({"min-width":"","max-width":""}),n.show(),!f(i)&&(i.find("*").addClass("breadcrumb-element-small"),!f(i))){var l=[],c=i.parent().width();$.each(n,function(e,t){var i=$(t);if(i.hasClass("js-ellipsis")){var n=i.html();i.html("&hellip;");var o=i.outerWidth(!0);i.html(n);var r=i.outerWidth(!0),a=o<r?o:r;i.addClass("abbreviated");var s=i.outerWidth(!0);i.removeClass("abbreviated"),l.unshift({$item:i,width:r,minimumWidth:a+1,minimumWidthAbbreviated:a+(s-r)+1})}else c-=i.outerWidth(!0)});for(var o=l.length-1,r=0;r<=o;r++){var a=l[r],s=a.$item;if(a.width=s.outerWidth(!0),a.width>c){var u;if(r==o)u=a.minimumWidth;else{s.addClass("abbreviated"),u=a.minimumWidthAbbreviated;for(var d=r+1;d<=o;d++)l[d].$item.hide()}if(c<u&&0<r){s.hide();var h=l[r-1],p=h.$item;p.addClass("abbreviated"),p.outerWidth(!0)-h.width>c&&p.css("max-width",h.width+c)}else s.css("max-width",c);break}c-=a.width}}})}}}(),function(){var r;(r=function(e,t){this.$modal=e,this.deferred=t||$.Deferred()}).get=function(e){return r.getWrapper(e).data("_confirm")},r.create=function(e,t){var i,n=AGN.Lib.Modal.create(e);return i=new r(n,t),n.data("_confirm",i),i.promise()},r.createFromTemplate=function(e,t,i){var n,o=AGN.Lib.Modal.createFromTemplate(e,t);return n=new r(o,i),o.data("_confirm",n),n.promise()},r.request=function(e){var n=$.Deferred();return(_.isString(e)?$.get(e):e).done(function(e){var t=$(e).all(".modal");if(1===t.length){var i=new r(t,n);t.data("_confirm",i),AGN.Lib.Modal.create(t)}else AGN.Lib.Page.render(e),n.reject()}).fail(function(){n.reject()}),n.promise()},r.getWrapper=function(e){var t;return 0==(t=$(e.data("confirm-target"))).length&&(t=e.closest(".modal")),t},r.prototype.promise=function(){return this.deferred.promise()},r.prototype.positive=function(e){this.deferred.resolve(e),this.$modal.modal("hide"),this.$modal.remove()},r.prototype.negative=function(e){this.deferred.reject(e),this.$modal.modal("hide"),this.$modal.remove()},AGN.Lib.Confirm=r}(),function(){var e;(e=function(e){(e=_.bind(e,this))()}).prototype.addAction=function(e,t){AGN.Lib.Action.new(AGN.Lib.Action.translate(e),t)},e.prototype.addInitializer=function(e,t){AGN.Initializers[e]=t},e.prototype.addDomInitializer=function(e,t){AGN.Lib.DomInitializer.new(e,t)},e.prototype.runInitializer=function(e){AGN.Initializers[e]()},e.new=function(e,t){AGN.Opt.Controllers[e]=t},e.init=function(e){(e=e||$(document)).all("[data-controller]").each(function(){var e=$(this),t=AGN.Opt.Controllers[e.data("controller")];t&&(new AGN.Lib.Controller(t),AGN.Opt.Controllers[e.data("controller")]=void 0)})},AGN.Lib.Controller=e}(),function(){var o={get:function(e){var t,i=e.data("provider"),n=e.data("provider-src");switch(i){case"opt":t=o.opt(n);break;case"remote":t=o.remote(n)}return t},opt:function(e){var t=$.Deferred();return AGN.Opt[e]?setTimeout(function(){t.resolve(AGN.Opt[e])},100):setTimeout(function(){t.reject()},100),t},remote:function(e){return $.get(e)}};AGN.Lib.DataProvider=o}(),function(){var y;y={MONTH_NAMES:["January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],DAY_NAMES:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat"],LZ:function(e){return(e<0||9<e?"":"0")+e},compareDates:function(e,t,i,n){var o=y.parseFormat(e,t),r=y.parseFormat(i,n);return 0==o||0==r?-1:r<o?1:0},format:function(e,t){t+="";var i="",n=0,o="",r="",a=e.getYear()+"",s=e.getMonth()+1,l=e.getDate(),c=e.getDay(),u=e.getHours(),d=e.getMinutes(),h=e.getSeconds(),p=new Object;for(a.length<4&&(a=""+(a-0+1900)),p.y=""+a,p.yyyy=a,p.yy=a.substring(2,4),p.M=s,p.MM=y.LZ(s),p.MMM=y.MONTH_NAMES[s-1],p.NNN=y.MONTH_NAMES[s+11],p.d=l,p.dd=y.LZ(l),p.E=y.DAY_NAMES[c+7],p.EE=y.DAY_NAMES[c],p.H=u,p.HH=y.LZ(u),p.h=0==u?12:12<u?u-12:u,p.hh=y.LZ(p.h),p.K=11<u?u-12:u,p.k=u+1,p.KK=y.LZ(p.K),p.kk=y.LZ(p.k),p.a=11<u?"PM":"AM",p.m=d,p.mm=y.LZ(d),p.s=h,p.ss=y.LZ(h);n<t.length;){for(o=t.charAt(n),r="";t.charAt(n)==o&&n<t.length;)r+=t.charAt(n++);null!=p[r]?i+=p[r]:i+=r}return i},_isInteger:function(e){for(var t=0;t<e.length;t++)if(-1=="1234567890".indexOf(e.charAt(t)))return!1;return!0},_getInt:function(e,t,i,n){for(var o=n;i<=o;o--){var r=e.substring(t,t+o);if(r.length<i)return null;if(y._isInteger(r))return r}return null},parseFormat:function(e,t){e+="",t+="";for(var i,n=0,o=0,r="",a="",s=new Date,l=s.getYear(),c=s.getMonth()+1,u=1,d=s.getHours(),h=s.getMinutes(),p=s.getSeconds(),f="";o<t.length;){for(r=t.charAt(o),a="";t.charAt(o)==r&&o<t.length;)a+=t.charAt(o++);if("yyyy"==a||"yy"==a||"y"==a){if("yyyy"==a&&(i=4),4,"yy"==a&&(i=2),2,"y"==a&&(i=2),4,null==(l=y._getInt(e,n,i,4)))return 0;n+=l.length,2==l.length&&(l=70<l?l-0+1900:l-0+2e3)}else if("MMM"==a||"NNN"==a){for(var g=c=0;g<y.MONTH_NAMES.length;g++){var m=y.MONTH_NAMES[g];if(e.substring(n,n+m.length).toLowerCase()==m.toLowerCase()&&("MMM"==a||"NNN"==a&&11<g)){12<(c=g+1)&&(c-=12),n+=m.length;break}}if(c<1||12<c)return 0}else if("EE"==a||"E"==a)for(g=0;g<y.DAY_NAMES.length;g++){var v=y.DAY_NAMES[g];if(e.substring(n,n+v.length).toLowerCase()==v.toLowerCase()){n+=v.length;break}}else if("MM"==a||"M"==a){if(null==(c=y._getInt(e,n,a.length,2))||c<1||12<c)return 0;n+=c.length}else if("dd"==a||"d"==a){if(null==(u=y._getInt(e,n,a.length,2))||u<1||31<u)return 0;n+=u.length}else if("hh"==a||"h"==a){if(null==(d=y._getInt(e,n,a.length,2))||d<1||12<d)return 0;n+=d.length}else if("HH"==a||"H"==a){if(null==(d=y._getInt(e,n,a.length,2))||d<0||23<d)return 0;n+=d.length}else if("KK"==a||"K"==a){if(null==(d=y._getInt(e,n,a.length,2))||d<0||11<d)return 0;n+=d.length}else if("kk"==a||"k"==a){if(null==(d=y._getInt(e,n,a.length,2))||d<1||24<d)return 0;n+=d.length,d--}else if("mm"==a||"m"==a){if(null==(h=y._getInt(e,n,a.length,2))||h<0||59<h)return 0;n+=h.length}else if("ss"==a||"s"==a){if(null==(p=y._getInt(e,n,a.length,2))||p<0||59<p)return 0;n+=p.length}else if("a"==a){if("am"==e.substring(n,n+2).toLowerCase())f="AM";else{if("pm"!=e.substring(n,n+2).toLowerCase())return 0;f="PM"}n+=2}else{if(e.substring(n,n+a.length)!=a)return 0;n+=a.length}}if(n!=e.length)return 0;if(2==c)if(l%4==0&&l%100!=0||l%400==0){if(29<u)return 0}else if(28<u)return 0;return(4==c||6==c||9==c||11==c)&&30<u?0:(d<12&&"PM"==f?d=d-0+12:11<d&&"AM"==f&&(d-=12),new Date(l,c-1,u,d,h,p))},parse:function(e,t){if(t)return y.parseFormat(e,t);for(var i=2==arguments.length&&t,n=new Array("y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d"),o=new Array("M/d/y","M-d-y","M.d.y","MMM-d","M/d","M-d"),r=new Array("d/M/y","d-M-y","d.M.y","d-MMM","d/M","d-M"),a=[n,i?r:o,i?o:r],s=null,l=0;l<a.length;l++)for(var c=a[l],u=0;u<c.length;u++)if(0!=(s=y.parseFormat(e,c[u])))return new Date(s);return null},toArray:function(e,t){return e&&e.getMonth?[e.getFullYear(),e.getMonth(),e.getDate()]:t}},AGN.Lib.DateFormat=y}(),function(){var o='script[type="application/json"]',r="config:",a={};function s(e,t){if((this.el=e).is(o))this.config=e.json();else{var i=e.find("script#"+CSS.escape(r+t));if(i.exists()){var n=i.attr("type");n&&"application/json"!==n?console.error("Unexpected config script type: `"+n+"`"):this.config=i.json()}}}function l(e,t,i){var n=a["key#"+e];n&&!1===n.call(new s(t,e),t,i)&&(a["key#"+e]=void 0)}s.prototype.addAction=function(e,t){AGN.Lib.Action.new(AGN.Lib.Action.translate(e),t,this.el)},AGN.Lib.DomInitializer={autorun:function(t){var e=t;(e=e||$(document)).all("[data-initializer]").each(function(){var e=$(this);l(e.data("initializer"),e,t)})},run:l,try:function(e,t){if(a["key#"+e]){var i=t,n=(i=i||$(document)).all('[data-initializer="'+CSS.escape(e)+'"]');n.exists()&&l(e,n,t)}},new:function(e,t){$.isFunction(t)?a["key#"+e]=t:console.error("Handler must be a function")}}}(),function(){var t,i,n,o,r;(t=function(e){var t,i,n,o,r=this;if(this.el=$(e),o=!!this.el.attr("readonly"),this.isFullHeight=!!this.el.data("full-height-editor"),this.height=15*parseInt(this.el.attr("rows")||15),t=this.el.attr("id")+"Editor",1===(i=$("#"+t)).length){n=t;var a=i.data("full-height-editor");i.css("height",a?"100%":this.height+"px")}else n=_.uniqueId("Editor"),(i=$('<div id="'+n+'" class="form-control"></div>')).css("height",this.isFullHeight?"100%":this.height+"px"),i.insertAfter(this.el);this.el.hide(),this.editor=ace.edit(n),this.editor.setReadOnly(o),this.editor.getSession().setValue(this.el.val()),this.editor.getSession().on("change",function(e){r.el.val(r.editor.getSession().getValue()),r.el.trigger("editor:change")}),this.langTools=ace.require("ace/ext/language_tools"),this.decorate(),this.el.hasClass("js-editor-validate")&&this.editor.getSession().setUseWorker(!0),this.el.hasClass("js-editor-wrap")&&this.editor.getSession().setUseWrapMode(!0),r.el.trigger("editor:create")}).get=function(e){var t=e.data("_editor");return t||(e.hasClass("js-editor")?t=new i(e):e.hasClass("js-editor-text")?t=new n(e):e.hasClass("js-editor-eql")?t=new o(e):e.hasClass("js-editor-css")&&(t=new r(e)),e.data("_editor",t),t)},t.all=function(){return _.map($(".js-editor, .js-editor-text, .js-editor-eql, .js-editor-css"),function(e){return t.get($(e))})},t.prototype.decorate=function(){this.editor.setTheme("ace/theme/chrome"),this.editor.session.setUseWrapMode(!0),this.editor.session.setWrapLimitRange(null,null),this.editor.setBehavioursEnabled(!0),this.editor.setShowPrintMargin(!1),this.editor.session.setUseSoftTabs(!0),this.editor.getSession().setUseWorker(!1),this.editor.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,minLines:20})},t.prototype.resize=function(){this.editor.resize()},t.prototype.val=function(e){if(void 0===e)return this.editor.getSession().getValue();this.editor.getSession().setValue(e)},(i=function(e){t.apply(this,e)}).prototype=Object.create(t.prototype),(i.prototype.constructor=i).prototype.decorate=function(){t.prototype.decorate.call(this),this.editor.getSession().setMode("ace/mode/html")},(n=function(e){t.apply(this,e)}).prototype=Object.create(t.prototype),(n.prototype.constructor=n).prototype.decorate=function(){this.editor.setTheme("ace/theme/chrome"),this.editor.session.setUseWrapMode(!1),this.editor.session.setWrapLimitRange(null,null),this.editor.setBehavioursEnabled(!0),this.editor.setShowPrintMargin(!1),this.editor.session.setUseSoftTabs(!0),this.editor.getSession().setUseWorker(!1),this.editor.setOptions({enableBasicAutocompletion:!1,enableSnippets:!1,enableLiveAutocompletion:!1,minLines:20}),this.editor.getSession().setMode("ace/mode/text")},(o=function(e){t.apply(this,e)}).prototype=Object.create(t.prototype),(o.prototype.constructor=o).prototype.decorate=function(){this.editor.setTheme("ace/theme/chrome"),this.editor.session.setUseWrapMode(!1),this.editor.session.setWrapLimitRange(null,null),this.editor.setBehavioursEnabled(!0),this.editor.setShowPrintMargin(!1),this.editor.session.setUseSoftTabs(!0),this.editor.getSession().setUseWorker(!1),this.langTools.setCompleters([this.langTools.keyWordCompleter,this.langTools.snippetCompleter]),this.editor.setOptions({enableBasicAutocompletion:!0,enableSnippets:!1,enableLiveAutocompletion:!0,minLines:20}),ace.config.loadModule("ace/ext/eql_constructions_tokens"),ace.config.loadModule("ace/ext/eql_constructions_basic"),ace.config.loadModule("ace/ext/eql_constructions_extended"),this.editor.getSession().setMode("ace/mode/eql")},(r=function(e){t.apply(this,e)}).prototype=Object.create(t.prototype),(r.prototype.constructor=r).prototype.decorate=function(){t.prototype.decorate.call(this),this.editor.getSession().setMode("ace/mode/css")},AGN.Lib.Editor=t,AGN.Lib.EditorHtml=i,AGN.Lib.EditorText=n,AGN.Lib.EditorEql=o,AGN.Lib.EditorCss=r}(),function(){var e;e=function(e){var t,i,n=$(e),o=n.find("[data-equalizer-watch]:visible"),r=n.data("equalizer"),a=parseInt(n.data("equalizer-min"))||0,s=parseInt(n.data("equalizer-max"))||1e4;0!=o.length&&(1==o.length&&"min"==r&&(s=a),o.css({height:"",overflow:"","overflow-y":""}),t=_.map(o,function(e){return $(e).outerHeight(!1)}),(i="min"==r?Math.min.apply(null,t):Math.max.apply(null,t))<a&&(i=a),s<i&&(i=s),o.css({height:i,overflow:"hidden","overflow-y":"auto"}))},AGN.Lib.Equalizer=e}(),function(){var n,e,i,o,r,a,s,l,c,u;(n=function(e){this.el=e}).create=function(e){var t=e.data("field");return new(AGN.Opt.Fields[t]||n)(e)},n.prototype.valid=function(){return!0},n.prototype.errors=function(){return[]},AGN.Lib.Field=n,(((e=function(e){n.apply(this,[e]);var t=this.el.find("[data-field-validator]");this.$target=t,this.validatorName=t.data("field-validator");var i=t.data("validator-options");this.options=i?AGN.Lib.Helpers.objFromString(i):null}).prototype=Object.create(n.prototype)).constructor=e).prototype.valid=function(){var e=AGN.Lib.Validator.get(this.validatorName);return e&&this.$target.exists()?e.valid(this.$target,this.options):(console.debug("Validator `"+this.validatorName+"` doesn't exist"),!0)},e.prototype.errors=function(){var e=AGN.Lib.Validator.get(this.validatorName);return e&&this.$target.exists()?e.errors(this.$target,this.options):(console.debug("Validator `"+this.validatorName+"` doesn't exist"),[])},AGN.Lib.CustomField=e,AGN.Opt.Fields.validator=e,(((i=function(e){n.apply(this,[e]);var t=this;this.$source=this.el.find(".js-double-select-trigger"),this.$target=this.el.find(".js-double-select-target"),this.$source.on("change",function(){t.$target.val([]),t.update()}),AGN.Lib.DataProvider.get(e).done(function(e){t.options=e,t.update()})}).prototype=Object.create(n.prototype)).constructor=i).prototype.update=function(){var e=this.$source.find("option:selected").val(),t=this.$target.find("option:selected").val(),i='{{ _.forEach(opts, function(name, value) { }}<option value="{{- value }}" {{- ( value == valueSelected ) ? "selected" : "" }}>{{- name }}</option>{{ }); }}';i=_.template(i)({opts:this.options[e],valueSelected:t}),this.$target.html(i),AGN.runAll(this.el)},AGN.Lib.DoubleSelectField=i,AGN.Opt.Fields["double-select"]=i,(((o=function(e){n.apply(this,[e]);var t=this;this.$source=this.el.find("[data-field-vis]"),this.$source.on("change",function(){t.update()}),t.update()}).prototype=Object.create(n.prototype)).constructor=o).prototype._updateSelects=function(){var t=this;_.each(this.$source.filter("select"),function(e){t._toggleFields($(e).find(":selected"))})},o.prototype._updateDefaults=function(){var t=this;_.each(this.el.find("[data-field-vis-default]"),function(e){t._toggleFields($(e))})},o.prototype._updateCheckboxes=function(){var t=this;_.each(this.$source.filter(":checked"),function(e){t._toggleFields($(e))})},o.prototype._toggleFields=function(t){var e,i;t.is(":disabled")||(e=t.data("field-vis-hide"),i=t.data("field-vis-show"),_.each(this.el.find(e),function(e){(t=$(e)).all(":input").each(function(){var e=$(this);e.prop("disabled")||(e.data("field-disabled",!0),e.prop("disabled",!0))}),t.hide(),t.data("select2")&&(t.select2("container").hide(),t.select2("enable",!1)),t.is("option")&&(t.prop("disabled",!0),AGN.Initializers.Select(t.parents("select")))}),_.each(this.el.find(i),function(e){(t=$(e)).all(":input").each(function(){var e=$(this);e.data("field-disabled")&&(e.prop("disabled",!1),e.removeData("field-disabled"))}),t.show(),t.data("select2")&&(t.select2("container").show(),t.select2("enable",!0)),t.is("option")&&(t.prop("disabled",!1),AGN.Initializers.Select(t.parents("select")))}))},o.prototype.update=function(){this._updateDefaults(),this._updateSelects(),this._updateCheckboxes()},AGN.Lib.ToggleVisField=o,AGN.Opt.Fields["toggle-vis"]=o,(((u=function(e){n.apply(this,[e]),this.$target=this.el.find("[data-field-required]")}).prototype=Object.create(n.prototype)).constructor=u).prototype.valid=function(){return!this.$target.exists()||$.trim(this.$target.val())},u.prototype.errors=function(){var e=[];return this.valid()||e.push({field:this.$target,msg:t("fields.required.errors.missing")}),e},AGN.Lib.RequiredField=u,AGN.Opt.Fields.required=u,(((r=function(e){n.apply(this,[e]);var t=this;this.$strength=this.el.find(".js-password-strength"),this.$strengthIndicator=this.el.find(".js-password-strength-indicator"),this.$match=this.el.find(".js-password-match"),this.$matchIndicator=this.el.find(".js-password-match-indicator"),this.$strength.on("keyup",function(){t.updateStrength(),t.updateMatch()}),this.$match.on("keyup",function(){t.updateMatch()})}).prototype=Object.create(n.prototype)).constructor=r).prototype.match=function(){return this.$strength.val()==this.$match.val()},r.prototype.safe=function(){var t=this,i=this.$strength.val();return 0==i.length||!(i.length<8)&&_.every(["[a-z]","[A-Z]","[0-9]","[^a-zA-Z0-9]"],function(e){return t.passesCheck(i,e)})},r.prototype.passesCheck=function(e,t){return!!e.match(t)},r.prototype.valid=function(){return 0==this.$match.length||this.match()&&this.safe()},r.prototype.errors=function(){var e=[];return this.valid()||(this.match()||e.push({field:this.$match,msg:t("fields.password.errors.notMatching")}),this.safe()||e.push({field:this.$strength,msg:t("fields.password.errors.unsafe")})),e},r.prototype.resetStrength=function(){AGN.Lib.Form.get(this.el).cleanErrors(this.$strengthIndicator.parents(".form-group")),this.$strengthIndicator.addClass("hidden"),this.$strengthIndicator.removeClass("state-alert"),this.$strengthIndicator.removeClass("state-success"),this.$strengthIndicator.html("")},r.prototype.resetMatch=function(){AGN.Lib.Form.get(this.el).cleanErrors(this.$matchIndicator.parents(".form-group")),this.$matchIndicator.addClass("hidden"),this.$matchIndicator.removeClass("state-success"),this.$matchIndicator.removeClass("state-alert"),this.$matchIndicator.html("")},r.prototype.updateStrength=function(){this.resetStrength(),0!=this.$strength.val().length&&(this.$strengthIndicator.removeClass("hidden"),this.safe()?(this.$strengthIndicator.addClass("state-success"),this.$strengthIndicator.html(t("fields.password.successHtml",t("fields.password.safe")))):(this.$strengthIndicator.addClass("state-alert"),this.$strengthIndicator.html(t("fields.password.unsuccessHtml",t("fields.password.unsafe")))))},r.prototype.updateMatch=function(){this.resetMatch(),0!=this.$match.val().length&&(this.$matchIndicator.removeClass("hidden"),this.match()?(this.$matchIndicator.addClass("state-success"),this.$matchIndicator.html(t("fields.password.successHtml",t("fields.password.matches")))):(this.$matchIndicator.addClass("state-alert"),this.$matchIndicator.html(t("fields.password.unsuccessHtml",t("fields.password.matchesNot")))))},AGN.Lib.PasswordField=r,AGN.Opt.Fields.password=r,(((a=function(e){n.apply(this,[e]),this.$source=this.el.find("[data-field-split]"),this.targets=this.$source.data("field-split").split(/,\s?/),this.rule=new RegExp(this.$source.data("field-split-rule"))}).prototype=Object.create(n.prototype)).constructor=a).prototype.valid=function(){var i,n=AGN.Lib.Form.get(this.el);return i=this.$source.val().split(this.rule),_.each(this.targets,function(e,t){n.setValueOnce(e,i[t])}),!0},AGN.Lib.ValueSplitField=a,AGN.Opt.Fields.split=a,(((s=function(e){var t=this;n.apply(this,[e]),this.$filters=this.el.find("[data-field-filter]"),this.$filters.on("change",function(){t.update()}),t.position(),t.update()}).prototype=Object.create(n.prototype)).constructor=s).prototype.position=function(){var e;e=$(this.el.data("filter-target")),this.el.detach(),this.el.appendTo(e),e.parents("table").hide(),e.parents("table").show()},s.prototype.isEnabled=function(){return this.$filters.get().some(function(e){var t=$(e);if(t.is("input")){var i=t.attr("type");if("text"==i||"number"==i||"password"==i)return!!t.val()}return!!t.serialize()})},s.prototype.isDisabled=function(){return!this.isEnabled()},s.prototype.update=function(){this.isEnabled()?this.el.addClass("filter-active"):this.el.removeClass("filter-active")},AGN.Lib.FilterField=s,AGN.Opt.Fields.filter=s,(((l=function(e){var t=this;n.apply(this,[e]),this.$filterMin=this.el.find("[data-filter-date-min]"),this.$filterMax=this.el.find("[data-filter-date-max]"),this.$filters=this.el.find("[data-filter-date-min],[data-filter-date-max]"),this.$filterMin.on("change",function(){t.$filterMax.data("pickadate").set("min",t.$filterMin.val())}),this.$filterMax.on("change",function(){t.$filterMin.data("pickadate").set("max",t.$filterMax.val())}),this.$filters.on("change",function(){t.update()}),t.position(),t.update()}).prototype=Object.create(s.prototype)).constructor=l).prototype.isEnabled=function(){return _.some(this.$filters,function(e){return""!=$(e).val()})},AGN.Lib.DateFilterField=l,AGN.Opt.Fields["date-filter"]=l,(((c=function(e){var t=this;n.apply(this,[e]),this.$source=this.el.find("[data-field-date-split]"),this.$source.on("change",function(){t.update()})}).prototype=Object.create(n.prototype)).constructor=c).prototype.update=function(){var i=null,e=this.$source.val();e&&(i=new Date(parseInt(e))),this.el.find("[data-date-split-target]").each(function(){var e=$(this),t=e.attr("data-date-split-target");if(i&&t)switch(t.toUpperCase()){case"MILLISECONDS":e.val(i.getMilliseconds());break;case"SECONDS":e.val(i.getSeconds());break;case"MINUTES":e.val(i.getMinutes());break;case"HOURS":e.val(i.getHours());break;case"DAY":e.val(i.getDate());break;case"MONTH":e.val(i.getMonth()+1);break;case"YEAR":e.val(i.getFullYear());break;default:e.val(i.toJSON())}else e.val("")})},AGN.Lib.DateSplitField=c,AGN.Opt.Fields["date-split"]=c}(),function(){var a,t,i=AGN.Lib.Field;function s(e,t){var i=e,n=e.data("_editor"),o=e.data("emojioneArea"),r=!0;n?(n=n.editor).container&&(r=!1,i=$(n.container)):o?o.editor&&(r=!1,i=o.editor.parent()):i.is("select")&&(r=!1),r&&i.after('<span class="icon icon-state-alert form-control-feedback js-form-error-ind"></span>'),i.after('<div class="form-control-feedback-message js-form-error-msg">'+t+"</div>")}(t=function(e){this.group=e,this.$controls=$()}).prototype._collect=function(e){var t=$("[data-controls-group]");return"*"===e?t:e?t.filter(function(){return e===$(this).attr("data-controls-group")}):$()},t.prototype.collect=function(){this.group&&(this.$controls=this._collect(this.group).filter(function(){var e=$(this);return!e.prop("disabled")&&!e.hasClass("disabled")}))},t.prototype.setDisabled=function(e){!1===e?(this.$controls.removeClass("disabled"),this.$controls.prop("disabled",!1)):(this.$controls.addClass("disabled"),this.$controls.prop("disabled",!0))},(a=function(e){this.$form=e,this.form=e[0],this._abort=null,this._data={},this._dataNextRequest={},this.fields=[],this.validatorName=null,this.validatorOptions=null,this.url=e.attr("action"),this.urlNextRequest=null,this.method=e.attr("method"),this.isMultipart="multipart/form-data"==(e.attr("enctype")||"").toLowerCase(),this.isCustomLoader=e.is("[data-custom-loader]"),this.controlsToDisable=new t(e.attr("data-disable-controls")),e.is("[data-custom-loader]")?this.isCustomLoader="false"!==e.attr("data-custom-loader"):this.isCustomLoader=!1,this.initFields(),this.initValidator()}).get=function(e){var t,i,n;return(n=(t=a.getWrapper(e)).data("_form"))||(i=t.data("form"),n=new(AGN.Opt.Forms[i]||AGN.Lib.Form)(t),t.data("_form",n)),n},a.getWrapper=function(e){var t;return 0==(t=$(e.data("form-target"))).length&&(t=e.closest("form")),t},a.prototype.valid=function(){var e=_.every(this.fields,function(e){return e.valid()});if(this.validatorName){var t=AGN.Lib.Validator.get(this.validatorName);if(t)return t.valid(this,this.validatorOptions,e)}return e},a.prototype.validate=function(){return!!this.valid()||(this.handleErrors(),!1)},a.prototype.get$=function(){return this.$form},a.prototype.getAction=function(){if(this.urlNextRequest){var e=this.urlNextRequest;return this.urlNextRequest=null,e}return this.url},a.prototype.setActionOnce=function(e){this.urlNextRequest=e},a.prototype.errors=function(){var t=[];if(_.each(this.fields,function(e){t=t.concat(e.errors())}),this.validatorName){var e=AGN.Lib.Validator.get(this.validatorName);e&&(t=t.concat(e.errors(this,this.validatorOptions)))}return t},a.prototype.setValue=function(e,t){var i=this.form[e];"object"==typeof i?($(i).val([t]),$(i).trigger("change")):void 0===t?delete this._data[e]:this._data[e]=t},a.prototype.setValueOnce=function(e,t){void 0===t?delete this._dataNextRequest[e]:this._dataNextRequest[e]=t},a.prototype.getValue=function(e){var t=this.form[e];return"object"==typeof t?t.value:this._data[e]},a.prototype.data=function(){if(this.isMultipart){var n=new FormData,i=this.$form.serializeFormDataObject();return $.each(this._data,function(e,t){i.hasOwnProperty(e)||(i[e]=t)}),$.each(this._dataNextRequest,function(e,t){i[e]=t}),$.each(i,function(i,e){$.isArray(e)?$.each(e,function(e,t){n.append(i,t)}):n.append(i,e)}),n}return _.merge({},this._data,this.$form.serializeObject(),this._dataNextRequest)},a.prototype.params=function(){return $.param(this.data(),!0)},a.prototype.jqxhr=function(){var e,i=this,t=$.ajaxSettings.xhr(),o=$.Deferred();this.$form.trigger("form:submit");var n={url:this.getAction(),method:this.method,loader:this.loader(),xhr:function(){return t}};if(this.isMultipart?(n.data=this.data(),n.enctype="multipart/form-data",n.processData=!1,n.contentType=!1):n.data=this.params(),this.isCustomLoader){function r(e){var t=!0;e.lengthComputable&&(t=(e.loaded/e.total*100).toFixed(1)),i.$form.trigger("form:progress",{loaded:e.loaded,total:e.total,progress:t})}"upload"in t?n.xhr=function(){return t.upload.onprogress=r,t}:n.xhrFields={onprogress:r}}return"function"==typeof t.abort&&(this._abort=function(){t.abort()}),e=$.ajax(n),this._dataNextRequest={},this.setLoaderShown(!0),o.always(function(){i.setLoaderShown(!1)}),e.done(function(i){var e,t,n=$(i);1==(e=n.filter('[data-form="polling"]').add(n.find('[data-form="polling"]'))).length?((t=a.get(e).jqhxr()).done(function(){o.resolve.apply(this,arguments);var e=$("body"),t=$("<div></div>");t.html(i),t.find('script[data-message][type="text/html"]').appendTo(e),t.find('script[data-message][type="text/javascript"]').each(function(){try{eval.call(window,$(this).html())}catch(e){}}),t.remove()}),t.fail(function(){o.reject.apply(this,arguments)})):o.resolve(i)}),e.fail(function(){o.reject.apply(this,arguments)}),o.promise()},a.prototype._submit=function(){var e,t=this;return this.setLoaderShown(!0),(e=this.jqxhr()).done(function(e){t.setLoaderShown(!1),t.updateHtml(e),t.$form.trigger("submitted",e)}),e},a.prototype._submitStatic=function(){var o,e=this.data();o=$('<form method="'+this.method+'" action="'+this.getAction()+'"></form>'),_.each(e,function(e,t){if(_.isArray(e)){var i=$('<select multiple name="'+t+'"></select>');_.each(e,function(e){var t=$('<option selected="selected"></option>');t.val(e),t.appendTo(i)}),i.appendTo(o)}else{var n=$('<input type="hidden" name="'+t+'"/>');n.val(e),n.appendTo(o)}}),o.appendTo($("body")),o.submit(),o.remove(),this._dataNextRequest={}},a.prototype._submitAction=function(e){return this.setValue("previousAction",this.getValue("actionList")),this.setValueOnce("action",e),this.submit()},a.prototype._submitEvent=function(){var e=$.Event("submission");this.$form.trigger(e),e.isDefaultPrevented()||(this.$form.trigger("submitted"),this._dataNextRequest={})},a.prototype._submitConfirm=function(e){this.setValue("previousAction",this.getValue("actionList")),this.setValueOnce("action",e);var t=this.jqxhr(),i=this;return t.done(function(e){i.$form.trigger("submitted",e)}),t},a.prototype.submit=function(e){var t=Array.prototype.slice.call(arguments,1);if(!this.valid())return this.handleErrors(),!1;switch(this.cleanErrors(),e){case"static":return this._submitStatic(t);case"confirm":return this._submitConfirm(t);case"action":return this._submitAction(t);case"event":return this._submitEvent(t);default:return this._submit()}},a.prototype.revertAction=function(){},a.prototype.reset=function(){this.$form.trigger("reset")},a.prototype.abort=function(){this.$form.trigger("form:abort"),this._abort&&(this._abort(),this._abort=null)},a.prototype.bulkUpdate=function(e,t){e?this.$form.find('[name^="'+e+'"]').prop("checked",t):this.$form.find(".js-bulk-ids").prop("checked",t)},a.prototype.handleMessages=function(e){var t,i=$(e);t=i.filter("script[data-message]").add(i.find("script[data-message]")),_.each(t,function(e){$("body").append(e)})},a.prototype.initFields=function(e){var t=this;e=e||this.$form,t.fields.length=0,_.each(e.find("[data-field]"),function(e){t.fields.push(i.create($(e)))})},a.prototype.initValidator=function(){this.validatorName=this.$form.data("validator");var e=this.$form.data("validator-options");this.validatorOptions=e?AGN.Lib.Helpers.objFromString(e):null},a.prototype.updateHtml=function(e){var t,i=$(e);t=this.$form.attr("id")?$(e).filter("#"+this.$form.attr("id")).add(i.find("#"+this.$form.attr("id"))):this.$form.attr("name")?$(e).filter('[name="'+this.$form.attr("name")+'"]').add(i.find('[name="'+this.$form.attr("name")+'"]')):$(e).filter("form").add(i.find("form")),this.$form.html(t.html()),this.handleMessages(e),this.initFields(),this.initValidator(),AGN.Lib.Controller.init(this.$form),AGN.runAll(this.$form)},a.prototype.loader=function(){var e=this;return{show:function(){e.controlsToDisable.collect(),e.controlsToDisable.setDisabled(!0),e.setLoaderShown(!0)},hide:function(){e.controlsToDisable.setDisabled(!1),e.setLoaderShown(!1)}}},a.prototype.setLoaderShown=function(e){this.isCustomLoader?e?this.$form.trigger("form:loadershow"):this.$form.trigger("form:loaderhide"):e?AGN.Lib.Loader.show():AGN.Lib.Loader.hide()},a.prototype.cleanErrors=function(e){e=e||this.$form.find(".js-form-error"),_.each(e,function(e){var t=$(e);t.removeClass("has-alert has-feedback js-form-error"),t.find(".js-form-error-ind").remove(),t.find(".js-form-error-msg").remove()})},a.prototype.handleErrors=function(){var i=[];this.cleanErrors(),_.each(this.errors(),function(e){var t=e.field;t&&0<t.length&&(t.parents(".form-group").addClass("has-alert has-feedback js-form-error"),s(t,e.msg),i.push(t.offset().top))});var e=this.$form.closest(".modal");if(e.exists()||(e=$(document)),!e.find(".popover.support-popover").exists()){var t=this.$form.offset().top,n=_.sortBy(i)[0]-t-25;e.scrollTop(n)}},a.prototype.cleanFieldError=function(e){this.form[e]&&this.cleanFieldError$($(this.form[e]))},a.prototype.cleanFieldError$=function(e){var t=e.closest(".js-form-error");t.removeClass("has-alert has-feedback js-form-error"),t.find(".js-form-error-ind").remove(),t.find(".js-form-error-msg").remove()},a.prototype.showFieldError=function(e,t,i){this.form[e]&&this.showFieldError$($(this.form[e]),t,i)},a.prototype.showFieldError$=function(e,t,i){var n=e.parents(".form-group");if(n.addClass("has-alert has-feedback js-form-error"),n.find(".js-form-error-ind").remove(),n.find(".js-form-error-msg").remove(),s(e,t),!0!==i){var o=this.$form.closest("[data-sizing=scroll], .modal").first();if(o.exists()){var r=$(".has-alert").first();o.animate({scrollTop:r.offset().top-o.offset().top+o.scrollTop()})}else(o=$(document)).scrollTop(e.offset().top-25)}},AGN.Lib.Form=a}(),function(){var e;(e=function(e){this.$el=e}).prototype.update=function(e){this.config=e,this.draw()},e.prototype.template=function(){var e=this.config;return _.template('<div class="grid-stage center-block" style="width: {{= viewWidth}} px; height: {{= viewHeight }}px;"><svg class="grid-view center-block" viewBox="0 0 {{= viewWidth }} {{= viewHeight }}" style="width: {{= viewWidth }}px; height: {{= viewHeight }}px"><g class="grid-columns"></g></svg></div>')({viewWidth:e.templateWidth,viewHeight:100})},e.prototype.data=function(){var t=[],i=this.config;return _.times(i.columnNum,function(e){t.push({type:"gutter",width:i.gutter/2,offset:_.reduce(t,function(e,t){return e+t.width},0)}),t.push({type:"col",width:i.columnWidth,offset:_.reduce(t,function(e,t){return e+t.width},0)}),t.push({type:"gutter",width:i.gutter/2,offset:_.reduce(t,function(e,t){return e+t.width},0)})}),t},e.prototype.draw=function(){this.$el.html(this.template()),d3.select(this.$el.find(".grid-columns")[0]).selectAll("g").data(this.data()).enter().append("g").attr("transform",function(e,t){return"translate("+e.offset+",0)"}).append("rect").attr("class",function(e){return"grid-view-"+e.type}).attr("width",function(e){return e.width}).attr("height",100)},AGN.Lib.GridView=e}(),function(){var e;(e=function(e){this.$el=e}).prototype.update=function(e){this.config=e,this.draw()},e.prototype.template=function(){var e=this.config;return _.template('<div class="grid-stage center-block" style="width: {{= viewWidth }}"px"; height: {{= viewHeight }}px;"><svg class="column-view center-block" viewBox="0 0 {{= viewWidth }} {{= viewHeight }}" style="width: {{= viewWidth }}px; height: {{= viewHeight }}px"><g class="grid-columns"></g></svg></div>')({viewWidth:e.templateWidth,viewHeight:35*e.columnNum-5})},e.prototype.data=function(){var i=this.config,n=[];return _.times(i.columnNum,function(e){var t=[];t.push({type:"gutter",width:i.gutter/2,offset:0}),t.push({type:"col",width:(e+1)*i.columnWidth+e*i.gutter,offset:_.reduce(t,function(e,t){return e+t.width},0)}),t.push({type:"gutter",width:i.gutter/2,offset:_.reduce(t,function(e,t){return e+t.width},0)}),_.times(i.columnNum-(e+1),function(e){t.push({type:"gutter",width:i.gutter/2,offset:_.reduce(t,function(e,t){return e+t.width},0)}),t.push({type:"empty-col",width:i.columnWidth,offset:_.reduce(t,function(e,t){return e+t.width},0)}),t.push({type:"gutter",width:i.gutter/2,offset:_.reduce(t,function(e,t){return e+t.width},0)})}),n.push(t)}),n},e.prototype.draw=function(){var e,i=this.config;this.$el.html(this.template()),(e=d3.select(this.$el.find(".grid-columns")[0]).selectAll(".row").data(this.data()).enter().append("g").attr("class","row").attr("transform",function(e,t){return"translate(0,"+35*t+")"})).selectAll(".col").data(function(e){return e}).enter().append("g").attr("class","col").attr("transform",function(e){return"translate("+e.offset+",0)"}).append("rect").attr("class",function(e){return"column-view-"+e.type}).attr("width",function(e){return e.width}).attr("height",30),e.append("text").attr("class","column-view-text").attr("x",i.gutter/2+10).attr("y",20).text(function(e,t){return _.template("{{= width }}px / {{= perc }}%")({width:e[1].width,perc:Math.floor(100*(t+1)/i.columnNum)})})},AGN.Lib.GridColumnView=e}(),function(){var i,a='<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content popover-scrollable"></div></div>';(i=function(e){var t=AGN.url(e.data("help")),i=this;this.el=e,$.get(t).done(function(e){i.config=$(e),i.popoverInteractive(),i.show()})}).show=function(e){var t;(t=e.data("_help"))?t.show():(t=new i(e),e.data("_help",t))},i.prototype.show=function(){this.el.popover("show")},i.prototype.getConfig=function(e){return this.config.find(e).text().replace("<![CDATA[","").replace("]]>","")},i.prototype.popover=function(){this.config&&(this.el.popover("destroy"),AGN.Lib.Popover.new(this.el,{template:a,title:this.getConfig("title"),content:this.getConfig("content"),html:!0,trigger:this.el.data("trigger")||"focus"}))},i.prototype.popoverInteractive=function(){if(this.config){this.el.popover("destroy");var e=AGN.Lib.Popover.new(this.el,{template:a,title:this.getConfig("title"),content:this.getConfig("content"),html:!0,trigger:"manual"}),t=this.el,n=e.tip();n.attr("tabindex",0),n.css("outline","none");function i(){r=setTimeout(function(){e.hide()},100)}function o(){clearTimeout(r)}var r=null;n.focusout(i),t.focusout(i),n.focusin(o),t.focusin(o),t.on("shown.bs.popover",function(){var e=n.children(".popover-content"),t=e.css("min-width"),i=e.outerWidth();e.css("min-width","100%"),e.css("min-width",e.outerWidth()),i>e.outerWidth()&&e.css("min-width",t||"0px")})}},AGN.Lib.Help=i}(),function(){AGN.Lib.Helpers={paramsFromUrl:function(e){var t,i={};if(!e)return i;if(-1==(t=e.indexOf("?")))return i;for(var n=e.substring(t+1).split("&"),o=0;o<n.length;o++){var r=n[o].split("=");i[r[0]]=r[1]}return i},objFromString:function(optsAsString){var optsArray,optsSplitRegex=/,\s*(?=(?:[^'\\]*(?:\\.|'(?:[^'\\]*\\.)*[^'\\]*'))*[^']*$)/m,tupleSplitRegex=/:\s*(?=(?:[^'\\]*(?:\\.|'(?:[^'\\]*\\.)*[^'\\]*'))*[^']*$)/m,floatRegex=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,arrayRegex=/^\s?\[.*?\]$/i;return opts={},""===optsAsString||void 0===optsAsString||(optsArray=optsAsString.split(optsSplitRegex),_.forEach(optsArray,function(opt){var tup=opt.split(tupleSplitRegex),name,value;tup=_.filter(tup),name=tup[0].replace(/^'([^]*?)'$/m,"$1"),name=name.replace(/\\/,""),value=tup[1],void 0===value&&(value=""),value="true"==value||"false"!=value&&(floatRegex.test(value)?parseFloat(value):arrayRegex.test(value)?(value=value.replace(/\[|\]/g,""),value=value.split(/\s+/),_.map(value,function(v){return/^\'(.*?)\'$/.test(v)?v.replace(/^\'(.*?)\'$/g,"$1"):eval(v)})):(value=value.replace(/^'(.*?)'$/m,"$1"),value.replace(/\\/,""))),opts[name]=value})),opts},disableCSSAnimations:function(){$("body").append('<style class="disable-animation">* { -webkit-transition: none !important; -o-transition: none !important; transition: none !important; }</style>')},enableCSSAnimations:function(){window.setTimeout(function(){$(".disable-animation").remove()},10)},clearFormField:function(e){var t=$("<form></form>"),i=$("<div></div>");i.insertAfter(e),t.append(e),t.get(0).reset(),e.insertBefore(i),i.remove()},formatBytes:function(e,t){if(0==e)return"0 Bytes";if(1==e)return"1 Byte";if(-1==e)return"-1 Byte";e=Math.abs(e);if(t&&t.toLowerCase()&&"iec"==t.toLowerCase())var i=Math.pow(2,10),n=["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];else i=Math.pow(10,3),n=["Bytes","kB","MB","GB","TB","PB","EB","ZB","YB"];var o=Math.floor(Math.log(e)/Math.log(i)),r=e/Math.pow(i,o);return e<0&&(r*=-1),99.995<=r||0==o?r.toFixed(0)+" "+n[o]:r.toFixed(2)+" "+n[o]},pad:function(e,t,i){i=i||"0";var n=e+"";return n.length<t?new Array(t-n.length+1).join(i)+n:n},caching:function(e,t){var i,n=!1;return 1<arguments.length&&(e=_.bind.apply(null,Array.prototype.slice.call(arguments))),function(){return n||(n=!0,i=e()),i}}}}(),function(){var i;(i=function(e){var t,i=this;i.el=e,i.url=e.data("load"),i.interval=parseInt(e.data("load-interval")),i.target=e.data("load-target"),i.interval&&(t=function(){i.load()},i._interval=window.setInterval(t,i.interval)),i.el.removeAttr("data-load")}).load=function(e){var t;(t=e.data("_load"))?t.load():e.is(":hidden")||((t=new i(e)).load(),e.data("_load",t))},i.prototype.stop=function(){window.clearInterval(this._interval)},i.prototype.load=function(){var e,n=this;n.loading||(n.loading=!0,(e=$.get(n.url)).always(function(){n.interval&&(n.loading=!1)}),e.fail(function(){n.stop()}),e.done(function(e){var t,i=$(e);0!=i.all("[data-load-stop]").length&&n.stop(),t=n.target?"body"==n.target?/<body[^>]*>((.|[\n\r])*)<\/body>/im.exec(e)[1]:i.all(n.target):e,n.el.html(t),AGN.Lib.Controller.init(n.el),AGN.runAll(n.el)}))},AGN.Lib.Load=i}(),function(){var e,t={},i=0,n=!1;t.show=function(){window.clearTimeout(e),n?n=!1:(i+=1,$(".loader").show())},t.hide=function(){(i-=1)<=0&&(e=window.setTimeout(function(){$(".loader").hide()},5),i=0)},t.prevent=function(){n=!0},AGN.Lib.Loader=t}(),function(){var e,t=AGN.Lib.Form;(((e=function(e){t.apply(this,[e]),AGN.Lib.Loader.show(),this.submit()}).prototype=Object.create(t.prototype)).constructor=e).prototype.jqxhr=function(){var e=this,t=$.Deferred();return this.$form.trigger("form:submit"),window.setTimeout(function(){$.ajax({url:e.url,method:e.method,data:e.params(),loader:e.loader()}).done(function(e){t.resolve.apply(this,arguments)})},parseInt(this.$form.data("polling-interval"))),t.promise()},e.prototype.submit=function(){var e,t=this;return(e=this.jqxhr()).done(function(e){t.updateHtml(e)}),e},e.prototype.updateHtml=function(e){var t,i=$(e);1==(t=i.filter('[data-form="loading"]').add(i.find('[data-form="loading"]'))).length?(this.$form.html(t.html()),AGN.runAll(this.$form),this.submit()):(AGN.Lib.Loader.hide(),AGN.Lib.Page.render(e))},AGN.Lib.LoadingForm=e,AGN.Opt.Forms.loading=e}(),function(){var e;e={init:function(){"open"==(AGN.Lib.Storage.get("menu_state")||"open")?this.openDirectly():this.closeDirectly(),this.updateInits()},isOpen:function(){return $("body").hasClass("menu-is-active")},openDirectly:function(){AGN.Lib.Helpers.disableCSSAnimations(),this.open(),AGN.Lib.Helpers.enableCSSAnimations()},closeDirectly:function(){AGN.Lib.Helpers.disableCSSAnimations(),this.close(),AGN.Lib.Helpers.enableCSSAnimations()},close:function(){AGN.Lib.Storage.set("menu_state","close"),$("body").removeClass("menu-is-active"),this.updateInits()},open:function(){AGN.Lib.Storage.set("menu_state","open"),$("body").addClass("menu-is-active"),this.updateInits()},updateInits:function(){window.setTimeout(function(){AGN.Initializers.Truncate(),AGN.Initializers.Scrollable(),AGN.Initializers.DropdownExpand()},600)}},AGN.Lib.Menu=e}(),function(){function n(o,r,e,t,i){var n,a;null===i&&(i=!0),a={success:3e3,warning:3e3}[(e=e||"info")||"info"]||0,_.each($(".notification"),function(e){var t,i,n=$(e);t=n.data("message-head"),i=n.data("message-content"),o===t&&r===i&&n.remove()}),(n=toastr[e](o,r,{timeOut:a,extendedTimeOut:a,onCloseClick:t,newestOnTop:i})).data("message-head",o),n.data("message-content",r)}function o(t,e,i){e.forEach(function(e){n(t,e,i)})}AGN.Lib.Messages=n,AGN.Lib.JsonMessages=function(e,i){i&&_.each($(".notification"),function(e){e.remove()}),e&&(e.success&&o(t("defaults.success"),e.success,"success"),e.warning&&o(t("defaults.warning"),e.warning,"warning"),e.alert&&o(t("defaults.error"),e.alert,"alert"),e.fields&&$.each(e.fields,function(e,i){i&&o(t("defaults.error"),i,"alert")}))}}(),function(){var o={};AGN.Lib.Messaging={send:function(e){var t="key#"+e,i=o[t],n=Array.prototype.slice.call(arguments,1);i&&(o[t]=i.filter(function(e){return!1!==e.apply(this,n)}))},subscribe:function(e,t){var i="key#"+e;$.isFunction(t)?(o[i]||(o[i]=[]),o[i].push(t)):console.error("Callback must be a function")},unsubscribe:function(e,t){if(arguments.length){var i="key#"+e;o[i]=1<arguments.length?o[i].filter(function(e){return e!==t}):[]}}}}(),function(){var i;(i=function(){}).create=function(e,t){var i=null,n=null,o=(n=e instanceof $?e:$(e)).filter(".modal"),r=n.filter("script");return o&&((i=$(o[0])).data("_modal",t),r.each(function(){$(this).appendTo(i)}),i=i.modal(),AGN.Lib.Controller.init(i),AGN.runAll(i)),i},i.createFromTemplate=function(e,t){return t=AGN.Opt.Templates[t]||AGN.Opt.Templates.modal,i.create(_.template(t)(e),e)},i.get=function(e){return i.getWrapper(e).data("_modal")},i.getWrapper=function(e){return e.closest(".modal")},AGN.Lib.Modal=i}(),function(){var Confirm=AGN.Lib.Confirm,Page={};function renderMessages($resp){$resp.all('script[data-message][type="text/html"]').appendTo($(document.body)),$resp.all('script[data-message][type="text/javascript"]').each(function(){try{eval($(this).html())}catch(e){console.debug(e)}})}function getValidMethod(e){if(e)switch(e=e.toUpperCase()){case"CONNECT":case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"POST":case"PUT":return e}return"GET"}Page.render=function(e,t){if(/<\s*\/\s*body\s*>/i.test(e)){var i=(new DOMParser).parseFromString(e,"text/html");if(!1!==t&&i.head){var n=$(i.head).data("origin-uri");n&&(t=n)}t&&window.history.pushState({},"",t);var o=$(document).scrollTop();setTimeout(function(){AGN.Lib.Controller.init(),AGN.runAll(),$(document).scrollTop(o)},100),document.body=i.body,document.title=i.title;var r=$(document.body);r.find("script").each(function(e,t){var i=$(t);if(i.attr("src")){var n=$("<script><\/script>");$.each(t.attributes,function(){this.specified&&n.attr(this.name,this.value)});try{n.appendTo(r)}catch(e){console.debug(e)}}else if("text/javascript"==i.attr("type"))try{eval.call(window,i.html())}catch(e){console.debug(e)}})}else{var a=$(e),s=a.filter(".modal");if(s.exists()){var l=$.Deferred();return renderMessages(a),a.appendTo($(document.body)),Confirm.create(a),l.resolve(Confirm.get(a)),l.promise()}if((s=a.all("script[data-load]")).exists())return Page.reload(s.data("load"),!0).done(function(){renderMessages(a)});renderMessages(a)}},Page.reload=function(i,e,t){if(e){i=i||window.location.href;var n=$.Deferred();return $.ajax(i,{method:getValidMethod(t)}).done(function(e){var t=Page.render(e,i);t?t.done(n.resolve).fail(n.reject):n.resolve()}).fail(function(){n.reject()}),n.promise()}return i&&i!=window.location.href?window.location.assign(i):window.location.reload(!0),null},AGN.Lib.Page=Page}(),function(){var e,n=AGN.Lib.Page,t=AGN.Lib.Form;(((e=function(e){t.apply(this,[e])}).prototype=Object.create(t.prototype)).constructor=e).prototype.jqhxr=function(){var i=this,n=$.Deferred();return this.$form.trigger("form:submit"),window.setTimeout(function(){$.ajax({url:i.url,method:i.method,data:i.params(),loader:i.loader()}).done(function(e){var t=$(e).all('[data-form="polling"]');1==t.length?(i.$form.data("polling-interval",t.data("polling-interval")),i.jqhxr().done(function(){n.resolve.apply(this,arguments)})):n.resolve.apply(this,arguments)})},parseInt(this.$form.data("polling-interval"))),n.promise()},e.prototype.submit=function(){var e,t=this;return AGN.Lib.Loader.show(),(e=this.jqxhr()).done(function(e){AGN.Lib.Loader.hide(),t.updateHtml(e)}),e},e.prototype.updateHtml=function(e){var t,i=$(e);"page"==this.$form.data("render")?n.render(e):(t=this.$form.attr("id")?i.all("#"+this.$form.attr("id")):this.$form.attr("name")?i.all('[name="'+this.$form.attr("name")+'"]'):i.all("form"),setTimeout(function(){AGN.Lib.Controller.init(),AGN.runAll()},100),this.handleMessages(e),this.$form.replaceWith(t))},AGN.Lib.PollingForm=e,AGN.Opt.Forms.polling=e}(),function(){function n(e,t){var i=$(e),n=$(t),o=$(window).scrollTop(),r=$(window).outerHeight(),a=n.outerHeight(),s=n.offset().top-o,l=s+a;return i.outerHeight()<=s?"top":s<r-l?"bottom":"top"}var e={};e.new=function(e,t){if(1!==e.length)return!1;e.popover($.extend({container:"body",placement:n},t));var i=e.data("bs.popover");return t&&t.enableAgnRunAll&&e.on("shown.bs.popover",function(){var e=i.tip();AGN.Lib.Controller.init(e),AGN.runAll(e)}),i},e.get=function(e){if(1!==e.length)return null;var t=e.data("bs.popover");return t||e.closest("div.popover").data("bs.popover")},e.remove=function(e){return 1===e.length&&(e.popover("destroy"),!0)},e.validate=function(){$(".popover").each(function(){var e=$(this).data("bs.popover");e&&e.validate()})},AGN.Lib.Popover=e}(),function(){var e,t=AGN.Lib.Form,a=AGN.Lib.Page;((e=function(e){t.apply(this,[e]),this.resourceSelector=e.data("resource-selector")}).prototype=Object.create(t.prototype)).getResourceSelector=function(){if(this.resourceSelectorNextRequest){var e=this.resourceSelectorNextRequest;return this.resourceSelectorNextRequest=null,e}return this.resourceSelector},e.prototype.setResourceSelectorOnce=function(e){this.resourceSelectorNextRequest=e},e.prototype.updateHtml=function(e){var t=this.getResourceSelector();if(t){var i=$(e),n=$(t),o=i.all(t);if(1==n.length&&1==o.length){var r=!1;n[0]!=this.$form[0]&&!$.contains(n[0],this.$form[0])||(r=!0),n.html(o.html()),this.handleMessages(i),r&&(this.initFields(),this.initValidator()),AGN.Lib.Controller.init(n),AGN.runAll(n)}else a.render(e)}else a.render(e)},AGN.Lib.ResourceForm=e,AGN.Opt.Forms.resource=e}(),function(){function t(e,t){this.src=e,this.promises={},this.cache=$.extend({},t)}t.prototype.retrieve=function(i){var e=this.promises,n=this.cache,t=e[i];if(t&&"pending"==t.state())return t;var o=$.Deferred();if(t=o.promise(),n[i])o.resolve(n[i]);else if(this.src){var r=$.ajax(this.src,{type:"POST",data:{mailingId:i}});e[i]=t,r.always(function(){delete e[i]}),r.done(function(e){if(e&&e.mailingId==i){var t=e.links||[];n[i]=t,o.resolve(t,i)}else o.reject(i)}),r.fail(function(){o.reject(i)})}else o.reject(i);return t};var l="DATE",i="INTEGER",n="DOUBLE",o="NUMBER",c="MAILING",u="MAILING_LINKS",d="INTERVAL_MAILING";function h(e){switch(e){case i:case n:case o:return!0;default:return!1}}function p(e,t,i,n){var o=t.value,r=S(E("primaryOperator",n),"form-control","1",n),a=function(e,t){switch(t){case l:return e.dateOperators;case c:case u:return e.mailingOperators;case d:return e.intervalMailingOperators;default:return h(t)?e.numericOperators:e.stringOperators}}(e,i);$.each(R(a),function(e,t){D(r,o,t.id,t.value)}),function(e,t){var i=$(t);$(e).parent().html(i),i.is("select")&&s(i)}(t,r)}function r(e){return $('select[name="'+e+'"] option')}function a(e){return function(e){return $.map(e.toArray(),function(e){var t=$(e);return{id:t.val(),value:t.text()}})}(r(e))}function f(e,t,i){var n=null==t.value?"":t.value,o=S(E("primaryValue",i),"form-control","1",null);D(o,n,"null","null"),D(o,n,"not null","not null"),T([o],$(t.parentNode))}function g(e,t,i){var n=e.modSecondaryOperators,o=null==t.value?"":t.value,r=A("secondaryOperator",i),a=null==r?"":r.value,s=A("secondaryValue",i),l=null==s?"":s.value,c=k(E("primaryValue",i),o,"form-control"),u=S(E("secondaryOperator",i),"form-control","1",null);$.each(R(n),function(e,t){D(u,a,t.id,t.value)});var d=k(E("secondaryValue",i),l,"form-control");T([c,u,d],$(t.parentNode))}function m(e,t,i){var n=null==t.value?"":t.value;T([k(E("primaryValue",i),n,"form-control")],$(t.parentNode))}function v(e,t,i){var n=e.mailTypes,o=null==t.value?"":t.value,r=S(E("primaryValue",i),"form-control","1",null);$.each(R(n),function(e,t){D(r,o,t.id,t.value)}),T([r],$(t.parentNode))}function y(e,t,i){var n=e.genders,o=null==t.value?"":t.value,r=S(E("primaryValue",i),"form-control","1",null);$.each(R(n),function(e,t){D(r,o,t.id,t.value)}),T([r],$(t.parentNode))}function b(e,t,i){var n=e.dateFormats,o=null==t.value?"":t.value,r=A("dateFormat",i),a=null==r?"":r.value,s=k(E("primaryValue",i),o,"form-control"),l=S(E("dateFormat",i),"form-control","1",null);$.each(R(n),function(e,t){D(l,a,t.id,t.value)}),T([s,l],$(t.parentNode))}function w(e,t,i){var n=e.intervalMailings,o=null==t.value?"":t.value,r=S(E("primaryValue",i),"form-control js-select","1",null);$.each(R(n),function(e,t){D(r,o,t.id,t.value)}),T([r],$(t.parentNode))}function C(e,t,i){var n=e.allMailings,o=null==t.value?"":t.value,r=S(E("primaryValue",i),"form-control js-select","1",null);$.each(R(n),function(e,t){D(r,o,t.id,t.value)}),T([r],$(t.parentNode))}function _(e,t,i){var n=e.allMailings,o=null==t.value?"":t.value,r=A("secondaryValue",i),a=(null==r||r.value,S(E("primaryValue",i),"form-control js-select","1",i));a.setAttribute("data-action","resetMailingUrls"+(null==i?"New":"")),$.each(R(n),function(e,t){D(a,o,t.id,t.value)}),o=a.value;var s=S(E("secondaryValue",i),"form-control js-select js-option-popovers","1",i);s.setAttribute("data-action","updateMailingLinkId"+(null==i?"New":"")),x(e,o,s,e.mailingLinksSelectionsCache[i]&&e.mailingLinksSelectionsCache[i][o]),T([a,s],$(t.parentNode))}function A(e,t){return document.getElementsByName(E(e,t))[0]}function E(e,t){return e+(null!=t?"["+t+"]":"New")}function x(e,t,n,o){e.mailingLinks.retrieve(t).done(function(e){if(0!=e.length){var t=null;$.each(e,function(e){0!=e&&this.id!=o||(t=this.id)});var i=$(n);$.each(e,function(){i.append($("<option/>",{value:this.id,text:this.value,selected:t==this.id}))}),i.data("select2")&&i.select2("val",t)}})}function S(e,t,i,n){var o=document.createElement("select");return o.setAttribute("name",e),o.setAttribute("class",t),o.setAttribute("size",i),o.setAttribute("data-action",e.replace(/\[\d+\]/,"")),null!=n&&o.setAttribute("data-ruleid",n),o}function T(e,i){if(0<e.length){var n="col-sm-"+Math.round(12/e.length);(i=i.parent()).empty(),$.each(e,function(){var e=$(this),t=$("<div>").addClass(n);t.append(e),i.append(t),e.is("select")&&s(e)})}}function s(e){"Select"in AGN.Initializers&&AGN.Initializers.Select(e.parent())}function D(e,t,i,n){var o=$("<option/>",{value:i,text:n,selected:0==t.localeCompare(i)});return o.appendTo($(e)),o}function k(e,t,i){var n=document.createElement("input");return n.setAttribute("type","text"),n.setAttribute("name",e),n.setAttribute("value",t),n.setAttribute("class",i),n}function R(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(e[i]);return t}AGN.Lib.RuleService={changedColumn:function(e,t){var i=A("columnAndType",e);if(i){var n=i.options[i.selectedIndex],o=n.value.toUpperCase(),r=n.getAttribute("data-extra").toUpperCase(),a=A("primaryOperator",e),s=A("primaryValue",e);a.value==t.OPERATOR_IS?f(t,s,e):a.value==t.OPERATOR_MOD&&h(r)?g(t,s,e):r==l?b(t,s,e):r==d?w(t,s,e):r==c?C(t,s,e):r==u?_(t,s,e):"MAILTYPE"==o?v(t,s,e):"GENDER"==o?y(t,s,e):m(t,s,e),p(t,a,r,e)}},resetPrimaryOperators:p,resetMailingUrls:function(e,t){var i=A("primaryValue",t),n=i.value,o=S(E("secondaryValue",t),"form-control js-select js-option-popovers","1",t);o.setAttribute("data-action","updateMailingLinkId"+(null==t?"New":"")),x(e,n,o,e.mailingLinksSelectionsCache[t]&&e.mailingLinksSelectionsCache[t][n]);var r=$(i),a=r.clone();a.val(r.val()),a.css({display:"block"}),T([a,o],$(i.parentNode))},updateMailingLinksCache:function(e,t,i){var n=A("primaryValue",t).value,o=e.mailingLinksSelectionsCache[t];o||(o={},e.mailingLinksSelectionsCache[t]=o),o[n]=i},switchTo:{operators:{mod:g,is:f},types:{string:m,mail:v,gender:y,date:b,mailing:C,mailingLinks:_,intervalMailing:w}},configure:function(e){var i={};return $('select[name="all_mailings_urls_config"] optgroup').each(function(){var e=$(this),t=e.find("option");i[e.attr("label")]=t.map(function(){var e=$(this);return{id:e.val(),value:e.text()}})}),$.extend(e,{mailingLinks:new t(e&&e.URL_GET_MAILING_LINKS,i),mailingLinksSelectionsCache:{},allColumns:r("all_columns_config"),intervalMailings:a("interval_mailings_config"),modSecondaryOperators:a("mod_secondary_operators_config"),allMailings:a("all_mailings_config"),dateOperators:a("date_operators_config"),mailingOperators:a("mailing_operators_config"),intervalMailingOperators:a("interval_mailing_operators_config"),numericOperators:a("numeric_operators_config"),stringOperators:a("string_operators_config"),mailTypes:a("mail_types_config"),genders:a("genders_config"),dateFormats:a("date_formats_config")})}}}(),function(){var e,t=AGN.Lib.Form;((e=function(e){t.apply(this,[e])}).prototype=Object.create(t.prototype)).updateHtml=function(e){var t=$(e).find("[data-form-content]"),i=this.$form.find("[data-form-content]");i.html(t.html()),this.handleMessages(e),this.initFields(i),AGN.Lib.Controller.init(i),AGN.runAll(i),i.trigger("scrollTo",i)},AGN.Lib.SearchForm=e,AGN.Opt.Forms.search=e}(),function(){var n;(n=function(e){this.$select=e,this.select=e[0],this.api=function(){args=Array.prototype.slice.call(arguments,0),e.select2.apply(e,args)}}).get=function(e){var t,i;return(i=(t=e).data("_select"))||(i=new n(t),t.data("_select",i)),i},n.prototype.map=function(){var i=this;return _.reduce(i.values(),function(e,t){return e[t]=i.$select.find("option[value='"+t+"']").html(),e},{})},n.prototype.values=function(){return _.map(this.$select.find("option"),function(e){return $(e).val()})},n.prototype.clear=function(){this.api("val","")},n.prototype.selectValue=function(e){this.api("val",e)},n.prototype.getFirstValue=function(){return this.$select.find("option:first").val()},n.prototype.selectFirstValue=function(){this.api("val",this.getFirstValue())},n.prototype.selectValueOrSelectFirst=function(e){var t=this.values();_.isArray(e)||(e=[e]),_.every(e,function(e){return-1!=t.indexOf(e+"")})&&0!=e.length?this.selectValue(e):this.selectFirstValue()},n.prototype.resetOptions=function(){this.$select.html("")},n.prototype.setOptions=function(e){var t;t=_.reduce(e,function(e,t){return e+='<option value="'+t.id+'">'+t.text+"</option>"},""),this.$select.html(t)},n.prototype.addFormattedOption=function(e){this.$select.append(e)},n.prototype.getSelectedValue=function(){var e=this.$select.val();return e||""},AGN.Lib.Select=n}(),function(){var e,t=AGN.Lib.Form;((e=function(e){t.apply(this,[e])}).prototype=Object.create(t.prototype)).jqxhr=function(){return this.form.submit()},e.prototype.submit=function(){var n=this,e=_.merge({},this._data,this._dataNextRequest);return this.valid()?(this.$form.trigger("form:submit"),_.each(e,function(e,t){var i=$('<input type="hidden" name="'+t+'"/>');i.val(e),i.appendTo(n.$form)}),this._dataNextRequest={},this.$form.submit(),$.Deferred().promise()):(this.handleErrors(),!1)},AGN.Lib.StaticForm=e,AGN.Opt.Forms.static=e}(),function(){var d,o,r,e,t,i,n,a,s;s=function(t){function i(e,t,i){var n,o;o=i?((n=new Date).setTime(n.getTime()+24*i*60*60*1e3),"; expires="+n.toGMTString()):"",document.cookie=e+"="+t+o+"; path=/"}function n(e){e=JSON.stringify(e),"session"==t?window.name=e:i("localStorage",e,365)}function o(){var e="session"==t?window.name:function(e){var t,i,n=e+"=",o=document.cookie.split(";");for(t=0;t<o.length;t++){for(i=o[t];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(n))return i.substring(n.length,i.length)}return null}("localStorage");return e?JSON.parse(e):{}}var r=o();return{length:0,clear:function(){r={},this.length=0,"session"==t?window.name="":i("localStorage","",365)},getItem:function(e,t){if(!0!==t)return void 0===r[e]?null:r[e];var i=o();return void 0===i[e]?null:i[e]},key:function(e){var t=0;for(var i in r){if(t==e)return i;t++}return null},removeItem:function(e){delete r[e],this.length--,n(r)},setItem:function(e,t){r[e]=t+"",this.length++,n(r)}}};try{a=window.localStorage?window.localStorage:new s("local")}catch(e){a=new s("local")}function l(e){var t=""|e.data("stored-field"),i=e.attr("name");if(null!=i){var n=void 0;"checkbox"==e.attr("type")?n=e.prop("checked"):(e.is("input")||e.is("select"))&&(n=e.val()),null!=n&&o(h(i,t),n)}}function c(e){var t=""|e.data("stored-field"),i=!1,n=e.attr("name");if(null!=n){var o=e.attr("type")||e.prop("type"),r=d(h(n,t));if(void 0===r)return!1;if("radio"==o){if(e.val()!==r&&1==e.prop("checked"))return e.prop("checked",!1),!0;if(e.val()==r&&0==e.prop("checked"))return e.prop("checked",!0),!0}else if("checkbox"==o)e.prop("checked")!==r&&(e.prop("checked",r),i=!0);else if("select-one"==o){var a=!1;e.find("option").each(function(){if($(this).val()==r)return!(a=!0)}),a&&e.val()!==r&&(e.val(r).change(),i=!0)}else if("select-multiple"==o){var s=[],l=e.value();e.find("option").each(function(){var i=$(this);$.each(r,function(e,t){i.val()==t&&s.push(t)})}),s.sort(),l.sort();var c=!0;s.length!=l.length&&(c=!1);for(var u=0;u<s.length;++u)s[u]!==l[u]&&(c=!1);c||(e.val(s).change(),i=!0)}else"textarea"!=o&&"text"!=o||e.val()!==r&&(e.val(r),i=!0)}return i}function h(e,t){var i="stored_field_";if(e&&(i+=e),t)return i=i+"_"+t}d=function(e){var t=a.getItem(e);return t?JSON.parse(t):void 0},o=function(e,t){t=JSON.stringify(t),a.setItem(e,t)},r=function(e){a.removeItem(e)},e=function(i){var n=i.length;_.each(a,function(e,t){t.substring(0,n)==i&&r(t)})},t=function(t){var i;try{i=window.localStorage?a.getItem(t):a.getItem(t,!0)}catch(e){i=a.getItem(t,!0)}return i?JSON.parse(i):void 0},i=function(e){e.each(function(){$(this).is("[data-stored-field]")&&$(this).is("input")||$(this).is("select")?l($(this)):$(this).find("[data-stored-field]").each(function(){l($(this))})})},n=function(e){var t=!1;return e.each(function(){$(this).is("[data-stored-field]")&&($(this).is("input")||$(this).is("select"))?c($(this))&&(t=!0):$(this).find("[data-stored-field]").each(function(){c($(this))&&(t=!0)})}),t},AGN.Lib.Storage={get:d,set:o,delete:r,deleteByNamespace:e,getFromRealStorage:t,saveChosenFields:i,restoreChosenFields:n}}(),function(){var e,r,s,l,c=AGN.Lib.Storage;e=function(e){var t=e.data("toggle-tab"),i=l(e,t),n=c.get("toggle_tab"+i)||{},o=$(t);void 0!==o.data("tab-show")&&(n.hidden=!1,o.data("tab-show",void 0)),void 0!==o.data("tab-hide")&&(n.hidden=!0,o.data("tab-hide",void 0)),(!1===n.hidden||!0!==n.hidden&&o.is(":visible"))&&r(e)},r=function(e){var t=e.parents("ul").find("[data-toggle-tab]").not(e),i=e.data("toggle-tab"),n=l(e,i),o=$(i),r=e.find(".tab-toggle"),a=$(e.data("extends-tab"));_.each(t,function(e){s($(e))}),e.parent().addClass("active"),r.removeClass("icon-angle-down").addClass("icon-angle-up"),o.removeClass("hidden"),a.removeClass("hidden"),o.trigger("tile:show"),c.set("toggle_tab"+n,{hidden:!1}),AGN.Initializers.Load(o)},s=function(e){var t=e.data("toggle-tab"),i=l(e,t),n=e.find(".tab-toggle");e.parent().removeClass("active"),n.removeClass("icon-angle-up").addClass("icon-angle-down"),$(t).addClass("hidden"),$(t).trigger("tile:hide"),c.set("toggle_tab"+i,{hidden:!0})},toggle=function(e){var t=e.data("toggle-tab");$(t).is(":visible")?s(e):r(e)},l=function(e,t){var i=e.data("tab-group");return i?"/"+i:t},AGN.Lib.Tab={init:e,show:r,hide:s,toggle:toggle}}(),function(){var t;(t=function(e,t,i,n){var o=this;this.$el=e,this.$el.html('<div class="pagination-top"></div><div class="ag-theme-bootstrap" style="height: calc(100% - 106px); width: 100%"></div><div class="pagination-bottom"></div>'),this.$el.data("_table",o),this.$paginationTop=this.$el.find(".pagination-top"),this.$paginationBottom=this.$el.find(".pagination-bottom"),_.each(t,function(e){e.cellRenderer&&(e.cellRenderer=AGN.Opt.TableCellRenderers[e.cellRenderer])}),this.gridOptions=_.merge({columnDefs:t,enableSorting:!0,enableFilter:!0,enableColResize:!0,pagination:!0,paginationPageSize:100,rowSelection:"multiple",onCellClicked:function(e){"select"!=e.colDef.cellAction?"goTo"!=e.colDef.cellAction||e.data.show&&(window.location.href=e.data.show):e.node.setSelected(!e.node.isSelected())},suppressRowClickSelection:!0,headerHeight:41,rowHeight:34,suppressPaginationPanel:!0,onPaginationChanged:function(){o.renderPagination()},defaultColDef:{headerComponentParams:{template:'<div class="ag-cell-label-container" role="presentation">  <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button"></span>  <div ref="eLabel" class="ag-header-cell-label" role="presentation">    <span ref="eSortAsc" class="ag-header-icon ag-sort-ascending-icon" ></span>    <span ref="eSortDesc" class="ag-header-icon ag-sort-descending-icon" ></span>    <span ref="eText" class="ag-header-cell-text" role="columnheader"></span>    <span ref="eFilter" class="ag-header-icon ag-filter-icon"></span>    <span ref="eSortOrder" class="ag-header-icon ag-sort-order" ></span>    <span ref="eSortNone" class="ag-header-icon ag-sort-none-icon" ></span>  </div></div>'},filterParams:{clearButton:!0}},columnTypes:{numberColumn:{width:83,filter:"agNumberColumnFilter",comparator:AGN.Lib.TableNumberComparator},dateColumn:{filter:AGN.Lib.TableDateFilter},setColumn:{filter:AGN.Lib.TableSetFilter}},icons:{menu:'<i class="icon icon-filter"/>',filter:'<i class="icon icon-filter"/>',columns:'<i class="icon icon-handshake-o"/>',sortAscending:'<i class="icon icon-sort-asc"/>',sortDescending:'<i class="icon icon-sort-desc"/>',checkboxChecked:'<i class="icon icon-check-square-o"/>',checkboxUnchecked:'<i class="icon icon-square-o"/>',checkboxIndeterminate:'<i class="icon icon-square-o"/>',checkboxCheckedReadOnly:'<i class="icon icon-check-square-o"/>',checkboxUncheckedReadOnly:'<i class="icon icon-square-o"/>',checkboxIndeterminateReadOnly:'<i class="icon icon-square-o"/>'},localeText:window.I18n.tables},n||{}),this.grid=new agGrid.Grid(this.$el.find(".ag-theme-bootstrap").get(0),this.gridOptions),this.api=this.gridOptions.api,this.api.setRowData(i),this.api.sizeColumnsToFit()}).prototype.renderPagination=function(){var t,i,n,e,o=this.api,r=AGN.Lib.Template.prepare("table-controls-top");paginationBottomTemplate=AGN.Lib.Template.prepare("table-controls-bottom"),o&&(t=o.paginationGetCurrentPage()+1,i=o.paginationGetTotalPages(),n=[t],_.times(5,function(e){0<t-(e+1)&&n.unshift(t-(e+1)),t+(e+1)<=i&&n.push(t+(e+1))}),e={pagination:this.gridOptions.pagination,currentPage:t,totalPages:i,itemStart:o.paginationGetPageSize()*(t-1)+1,itemEnd:t==i?o.paginationGetRowCount():o.paginationGetPageSize()*t,itemTotal:o.paginationGetRowCount(),pageSelects:n},this.$paginationTop.html(r(e)),this.$paginationBottom.html(paginationBottomTemplate(e)),this.api.redrawRows())},t.prototype.redraw=function(){this.api.sizeColumnsToFit()},t.get=function(e){return t.getWrapper(e).data("_table")},t.getWrapper=function(e){var t;return 0==(t=$(e.data("table-body"))).length&&(t=e.closest(".js-data-table-body")),t},AGN.Lib.Table=t}(),function(){var t=AGN.Opt.Templates;function i(e){if(e in t)return _.template(t[e]);throw new Error("There's no template `"+e+"` registered")}function n(e,t){return i(e)(t)}AGN.Lib.Template={prepare:i,text:n,dom:function(e,t){return $(n(e,t))}}}(),function(){var e,t,i,n,o,r=AGN.Lib.Storage;e=function(e){var t=e.data("toggle-tile"),i=r.get("toggle_tile"+t);i&&(i.hidden?o(e):n(e))},t=function(e){$(e.data("toggle-tile")).hasClass("hidden")?n(e):o(e)},n=function(e){var t=e.find(".icon"),i=e.data("toggle-tile"),n=$(i);n.removeClass("hidden"),t.addClass("icon-angle-up"),t.removeClass("icon-angle-down"),r.set("toggle_tile"+i,{hidden:!1}),AGN.Initializers.Load(n)},i=function(e){return e.closest(".tile").find("[data-toggle-tile]")},o=function(e){var t=e.find(".icon"),i=e.data("toggle-tile");$(i).addClass("hidden"),t.addClass("icon-angle-down"),t.removeClass("icon-angle-up"),r.set("toggle_tile"+i,{hidden:!0})},AGN.Lib.Tile={toggle:t,init:e,show:n,hide:o,trigger:i}}(),function(){var i,n,o,r={},a=AGN.Lib.Template,s=AGN.Lib.Helpers,l=(i=a.prepare("tooltip-message-with-title"),n=a.prepare("tooltip-message-just-content"),function(e,t){return e?i({title:e,content:t}):n({content:t})}),c=(o=a.prepare("tooltip-template"),function(e,t,i){return o({tooltipStyle:e,arrowStyle:t,innerStyle:i})});function u(e,t){return{title:e,container:"body",template:c(t)}}function d(e,t,i){return{title:l(e,t),container:"body",html:!0,placement:"auto top",template:c(i,"helper-popup-arrow","helper-popup")}}r.options=function(e){var t={};if(e.is("[data-tooltip]")){var i=e.data("tooltip"),n=e.data("tooltip-src");n&&(i=a.text(n,{element:e})),t=u(i,e.data("tooltip-style"))}else e.is("[data-tooltip-help]")&&(t=d(e.data("tooltip-help"),e.data("tooltip-help-text"),e.data("tooltip-style")));return $.extend(t,s.objFromString(e.data("tooltip-options")))},r.create=function(e,t){r.remove(e),e.bsTooltip(t),e.on({"dragstart.tooltip":function(){e.bsTooltip("hide"),e.bsTooltip("disable")},"dragstop.tooltip":function(){e.bsTooltip("enable")}})},r.remove=function(e){e.bsTooltip("hide"),e.bsTooltip("destroy"),e.off("dragstart.tooltip dragstop.tooltip")},r.setEnabled=function(e,t){t||void 0===t?e.bsTooltip("enable"):(e.bsTooltip("hide"),e.bsTooltip("disable"))},r.createTip=function(e,t,i){r.create(e,u(t,i))},r.createHelpTip=function(e,t,i,n){r.create(e,d(t,i,n))},AGN.Lib.Tooltip=r}(),AGN.Lib.Truncate={run:function(e,t){var i,n;i=e.width(),n=_.reduce(e.children().not(t),function(e,t){return e+$(t).outerWidth(!0)},0),n=i<(n=5<.05*(n+=$(t).outerWidth(!0)-$(t).outerWidth())?1.05*n:n+5)?i:n,e.children(t).css({"max-width":i-n+"px",overflow:"hidden"})}},function(){var n;(n=function(e){return $.extend(this,e)}).exists=function(e){return AGN.Opt.Validators.hasOwnProperty(e)},n.get=function(e){return n.exists(e)?AGN.Opt.Validators[e]:null},n.new=function(e,t){n.exists(e)&&console.debug("Validator with name `"+e+"` was overridden");var i=new n(t);return AGN.Opt.Validators[e]=i},n.prototype.valid=function(){return!0},n.prototype.errors=function(){return[]},AGN.Lib.Validator=n}(),function(){var e,t,i;e=function(){var e=$("[data-view]:checked"),t=AGN.Lib.Storage.get("view_"+e.data("view"));t?$('[data-view][value="'+t.view+'"]').prop("checked",!0):t={view:e.val()},i(t.view)},t=function(e){var t=e.val();i(t),AGN.Lib.Storage.set("view_"+e.data("view"),{view:t})},i=function(i){_.each($("[data-view-"+i+"]"),function(e){var t=$(e);t.attr("class",t.data("view-"+i))}),$(window).trigger("resize"),AGN.Initializers.Load()},AGN.Lib.View={init:e,trigger:t}}(),function(){var i=AGN.Lib.Storage,n={get:function(e){var t="web-storage#"+$.trim(e);try{return i.get(t)}catch(e){console.error(e)}return null},set:function(e,t){i.set("web-storage#"+$.trim(e),t)},extend:function(e,t){var i=n.get(e);return i=null!=i?$.extend(i,t):t,n.set(e,i),i}};AGN.Lib.WebStorage=n}(),jsPlumbUtil={isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isString:function(e){return"string"==typeof e},isBoolean:function(e){return"boolean"==typeof e},isObject:function(e){return"[object Object]"===Object.prototype.toString.call(e)},isDate:function(e){return"[object Date]"===Object.prototype.toString.call(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)},clone:function(e){if(this.isString(e))return new String(e);if(this.isBoolean(e))return new Boolean(e);if(this.isDate(e))return new Date(e.getTime());if(this.isFunction(e))return e;if(this.isArray(e)){for(var t=[],i=0;i<e.length;i++)t.push(this.clone(e[i]));return t}if(this.isObject(e)){t={};for(var i in e)t[i]=this.clone(e[i]);return t}return e},merge:function(e,t){var i=this.clone(e);for(var n in t)if(null==i[n]||this.isString(t[n])||this.isBoolean(t[n]))i[n]=t[n];else if(this.isArray(t[n])&&this.isArray(i[n])){var o=[];o.push.apply(o,i[n]),o.push.apply(o,t[n]),i[n]=o}else if(this.isObject(i[n])&&this.isObject(t[n]))for(var r in t[n])i[n][r]=t[n][r];return i},convertStyle:function(e,t){if("transparent"===e)return e;function i(e){return function(e){return 1==e.length?"0"+e:e}(Number(e).toString(16))}var n=e,o=/(rgb[a]?\()(.*)(\))/;if(e.match(o)){var r=e.match(o)[2].split(",");n="#"+i(r[0])+i(r[1])+i(r[2]),t||4!=r.length||(n+=i(r[3]))}return n},gradient:function(e,t){return e=jsPlumbUtil.isArray(e)?e:[e.x,e.y],((t=jsPlumbUtil.isArray(t)?t:[t.x,t.y])[1]-e[1])/(t[0]-e[0])},normal:function(e,t){return-1/jsPlumbUtil.gradient(e,t)},lineLength:function(e,t){return e=jsPlumbUtil.isArray(e)?e:[e.x,e.y],t=jsPlumbUtil.isArray(t)?t:[t.x,t.y],Math.sqrt(Math.pow(t[1]-e[1],2)+Math.pow(t[0]-e[0],2))},segment:function(e,t){return e=jsPlumbUtil.isArray(e)?e:[e.x,e.y],(t=jsPlumbUtil.isArray(t)?t:[t.x,t.y])[0]>e[0]?t[1]>e[1]?2:1:t[1]>e[1]?3:4},intersects:function(e,t){var i=e.x,n=e.x+e.w,o=e.y,r=e.y+e.h,a=t.x,s=t.x+t.w,l=t.y,c=t.y+t.h;return i<=a&&a<=n&&o<=l&&l<=r||i<=s&&s<=n&&o<=l&&l<=r||i<=a&&a<=n&&o<=c&&c<=r||i<=s&&a<=n&&o<=c&&c<=r||a<=i&&i<=s&&l<=o&&o<=c||a<=n&&n<=s&&l<=o&&o<=c||a<=i&&i<=s&&l<=r&&r<=c||a<=n&&i<=s&&l<=r&&r<=c},segmentMultipliers:[null,[1,-1],[1,1],[-1,1],[-1,-1]],inverseSegmentMultipliers:[null,[-1,-1],[-1,1],[1,1],[1,-1]],pointOnLine:function(e,t,i){var n=jsPlumbUtil.gradient(e,t),o=jsPlumbUtil.segment(e,t),r=0<i?jsPlumbUtil.segmentMultipliers[o]:jsPlumbUtil.inverseSegmentMultipliers[o],a=Math.atan(n),s=Math.abs(i*Math.sin(a))*r[1],l=Math.abs(i*Math.cos(a))*r[0];return{x:e.x+l,y:e.y+s}},perpendicularLineTo:function(e,t,i){var n=jsPlumbUtil.gradient(e,t),o=Math.atan(-1/n),r=i/2*Math.sin(o),a=i/2*Math.cos(o);return[{x:t.x+a,y:t.y+r},{x:t.x-a,y:t.y-r}]},findWithFunction:function(e,t){if(e)for(var i=0;i<e.length;i++)if(t(e[i]))return i;return-1},indexOf:function(e,t){return jsPlumbUtil.findWithFunction(e,function(e){return e==t})},removeWithFunction:function(e,t){var i=jsPlumbUtil.findWithFunction(e,t);return-1<i&&e.splice(i,1),-1!=i},remove:function(e,t){var i=jsPlumbUtil.indexOf(e,t);return-1<i&&e.splice(i,1),-1!=i},addWithFunction:function(e,t,i){-1==jsPlumbUtil.findWithFunction(e,i)&&e.push(t)},addToList:function(e,t,i){var n=e[t];return null==n&&(n=[],e[t]=n),n.push(i),n},EventGenerator:function(){var o={},r=this,a=["ready"];this.bind=function(e,t){return jsPlumbUtil.addToList(o,e,t),r},this.fire=function(t,e,i){if(o[t])for(var n=0;n<o[t].length;n++)if(-1!=jsPlumbUtil.findWithFunction(a,function(e){return e===t}))o[t][n](e,i);else try{o[t][n](e,i)}catch(e){jsPlumbUtil.log("jsPlumb: fire failed for event "+t+" : "+e)}return r},this.unbind=function(e){return e?delete o[e]:o={},r},this.getListener=function(e){return o[e]}},logEnabled:!0,log:function(){if(jsPlumbUtil.logEnabled&&"undefined"!=typeof console)try{var e=arguments[arguments.length-1];console.log(e)}catch(e){}},group:function(e){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.group(e)},groupEnd:function(e){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.groupEnd(e)},time:function(e){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.time(e)},timeEnd:function(e){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.timeEnd(e)}},function(){function t(u){var d={},i=[],h={},p={};this.register=function(e){var a=jsPlumb.CurrentLibrary;e=a.getElementObject(e);var s=u.getId(e),t=a.getDOMElement(e),l=a.getOffset(e);d[s]||(d[s]=e,i.push(e),h[s]={});var c=function(e,t){if(e)for(var i=0;i<e.childNodes.length;i++)if(3!=e.childNodes[i].nodeType){var n=a.getElementObject(e.childNodes[i]),o=u.getId(n,null,!0);if(o&&p[o]&&0<p[o]){var r=a.getOffset(n);h[s][o]={id:o,offset:{left:r.left-l.left,top:r.top-l.top}}}c(e.childNodes[i])}};c(t)},this.updateOffsets=function(e){var t=jsPlumb.CurrentLibrary,i=t.getElementObject(e),n=u.getId(i),o=h[n],r=t.getOffset(i);if(o)for(var a in o){var s=t.getElementObject(a),l=t.getOffset(s);h[n][a]={id:a,offset:{left:l.left-r.left,top:l.top-r.top}}}},this.endpointAdded=function(e){var t=jsPlumb.CurrentLibrary,i=document.body,n=u.getId(e),o=t.getDOMElement(e).parentNode;for(p[n]=p[n]?p[n]+1:1;o!=i;){var r=u.getId(o,null,!0);if(r&&d[r]){var a=t.getElementObject(o),s=t.getOffset(a);if(null==h[r][n]){var l=jsPlumb.CurrentLibrary.getOffset(e);h[r][n]={id:n,offset:{left:l.left-s.left,top:l.top-s.top}}}break}o=o.parentNode}},this.endpointDeleted=function(e){if(p[e.elementId]&&(p[e.elementId]--,p[e.elementId]<=0))for(var t in h)delete h[t][e.elementId]},this.getElementsForDraggable=function(e){return h[e]},this.reset=function(){d={},i=[],h={},p={}}}var i=!!document.createElement("canvas").getContext,n=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),o=function(){if(null==o.vml){var e=document.body.appendChild(document.createElement("div"));e.innerHTML='<v:shape id="vml_flag1" adj="1" />';var t=e.firstChild;t.style.behavior="url(#default#VML)",o.vml=!t||"object"==typeof t.adj,e.parentNode.removeChild(e)}return o.vml};window.console||(window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}}),window.jsPlumbAdapter={headless:!1,appendToRoot:function(e){document.body.appendChild(e)},getRenderModes:function(){return["canvas","svg","vml"]},isRenderModeAvailable:function(e){return{canvas:i,svg:n,vml:o()}[e]},getDragManager:function(e){return new t(e)},setRenderMode:function(e){var t;if(e){e=e.toLowerCase();var i=this.isRenderModeAvailable("canvas"),n=this.isRenderModeAvailable("svg"),o=this.isRenderModeAvailable("vml");"svg"===e?n?t="svg":i?t="canvas":o&&(t="vml"):"canvas"===e&&i?t="canvas":o&&(t="vml")}return t}}}(),function(){function Fe(e,t){return Xe.CurrentLibrary.getAttribute(qe(e),t)}function Me(e,t,i){Xe.CurrentLibrary.setAttribute(qe(e),t,i)}function Pe(e,t){var i=Xe.CurrentLibrary.getOffset(qe(e));if(null==t)return i;var n=t.getZoom();return{left:i.left/n,top:i.top/n}}function Ie(e){return Xe.CurrentLibrary.getSize(qe(e))}function Le(){return""+(new Date).getTime()}function Ge(e){var a=this,t=arguments,n=!1,i=e.parameters||{},o=a.idPrefix+(new Date).getTime(),r=null,s=null;a._jsPlumb=e._jsPlumb,a.getId=function(){return o},a.tooltip=e.tooltip,a.hoverClass=e.hoverClass||a._jsPlumb.Defaults.HoverClass||Xe.Defaults.HoverClass,jsPlumbUtil.EventGenerator.apply(this),this.clone=function(){var e=new Object;return a.constructor.apply(e,t),e},this.getParameter=function(e){return i[e]},this.getParameters=function(){return i},this.setParameter=function(e,t){i[e]=t},this.setParameters=function(e){i=e},this.overlayPlacements=[];var l=e.beforeDetach;this.isDetachAllowed=function(e){var t=a._jsPlumb.checkCondition("beforeDetach",e);if(l)try{t=l(e)}catch(e){Qe("jsPlumb: beforeDetach callback failed",e)}return t};var c=e.beforeDrop;function u(){if(r&&s){var e={};Xe.extend(e,r),Xe.extend(e,s),delete a.hoverPaintStyle,e.gradient&&r.fillStyle&&delete e.gradient,s=e}}this.isDropAllowed=function(e,t,i,n,o){var r=a._jsPlumb.checkCondition("beforeDrop",{sourceId:e,targetId:t,scope:i,connection:n,dropEndpoint:o});if(c)try{r=c({sourceId:e,targetId:t,scope:i,connection:n,dropEndpoint:o})}catch(e){Qe("jsPlumb: beforeDrop callback failed",e)}return r},this.setPaintStyle=function(e,t){r=e,a.paintStyleInUse=r,u(),t||a.repaint()},this.getPaintStyle=function(){return r},this.setHoverPaintStyle=function(e,t){s=e,u(),t||a.repaint()},this.getHoverPaintStyle=function(){return s},this.setHover=function(e,t,i){a._jsPlumb.currentlyDragging||a._jsPlumb.isHoverSuspended()||(n=e,null!=a.hoverClass&&null!=a.canvas&&(e?p.addClass(a.canvas,a.hoverClass):p.removeClass(a.canvas,a.hoverClass)),null!=s&&(a.paintStyleInUse=e?s:r,i=i||Le(),a.repaint({timestamp:i,recalc:!1})),a.getAttachedElements&&!t&&m(e,Le(),a))},this.isHover=function(){return n};var d=null;function h(e,t,i){var n=g[i]||i;p.bind(e,i,function(e){t.fire(n,t,e)})}this.setZIndex=function(e){d=e},this.getZIndex=function(){return d};var p=Xe.CurrentLibrary,f=["click","dblclick","mouseenter","mouseout","mousemove","mousedown","mouseup","contextmenu"],g={mouseout:"mouseexit"};this.attachListeners=function(e,t){for(var i=0;i<f.length;i++)h(e,t,f[i])};var m=function(e,t,i){var n=a.getAttachedElements();if(n)for(var o=0;o<n.length;o++)i&&i==n[o]||n[o].setHover(e,!0,t)};function v(e){return null==e?null:e.split(" ")}function y(e){if(a.getDefaultType){for(var t=a.getTypeDescriptor(),i=jsPlumbUtil.merge({},a.getDefaultType()),n=0;n<b.length;n++)i=jsPlumbUtil.merge(i,a._jsPlumb.getType(b[n],t));a.applyType(i),e||a.repaint()}}this.reattachListenersForElement=function(e){if(1<arguments.length){for(var t=0;t<f.length;t++)i=e,n=f[t],p.unbind(i,n);for(t=1;t<arguments.length;t++)a.attachListeners(e,arguments[t])}var i,n};var b=[];a.setType=function(e,t){b=v(e)||[],y(t)},a.getType=function(){return b},a.hasType=function(e){return-1!=jsPlumbUtil.indexOf(b,e)},a.addType=function(e,t){var i=v(e),n=!1;if(null!=i){for(var o=0;o<i.length;o++)a.hasType(i[o])||(b.push(i[o]),n=!0);n&&y(t)}},a.removeType=function(e,t){var i,n,o=v(e),r=!1;if(null!=o){for(var a=0;a<o.length;a++)i=o[a],void 0,r=-1!=(n=jsPlumbUtil.indexOf(b,i))&&(b.splice(n,1),!0)||r;r&&y(t)}},a.toggleType=function(e,t){var i=v(e);if(null!=i){for(var n=0;n<i.length;n++){var o=jsPlumbUtil.indexOf(b,i[n]);-1!=o?b.splice(o,1):b.push(i[n])}y(t)}},this.applyType=function(e){if(a.setPaintStyle(e.paintStyle),a.setHoverPaintStyle(e.hoverPaintStyle),e.parameters)for(var t in e.parameters)a.setParameter(t,e.parameters[t])}}function $e(e){Ge.apply(this,arguments);var r=this;function i(e){var t=null;if(Ve(e)){var i=e[0],n=Xe.extend({component:r,_jsPlumb:r._jsPlumb},e[1]);if(3==e.length&&Xe.extend(n,e[2]),t=new(Xe.Overlays[r._jsPlumb.getRenderMode()][i])(n),n.events)for(var o in n.events)t.bind(o,n.events[o])}else t=e.constructor==String?new(Xe.Overlays[r._jsPlumb.getRenderMode()][e])({component:r,_jsPlumb:r._jsPlumb}):e;r.overlays.push(t)}this.overlays=[];var t=function(e){var t,i=r.defaultOverlayKeys||[],n=e.overlays;n=n||[];for(var o=0;o<i.length;o++)n.unshift.apply(n,(t=i[o],r._jsPlumb.Defaults[t]||Xe.Defaults[t]||[]));return n}(e);if(t)for(var n=0;n<t.length;n++)i(t[n]);function o(e){for(var t=-1,i=0;i<r.overlays.length;i++)if(e===r.overlays[i].id){t=i;break}return t}function a(e){var t={cssClass:e.cssClass,labelStyle:this.labelStyle,id:s,component:r,_jsPlumb:r._jsPlumb},i=Xe.extend(t,e);return new(Xe.Overlays[r._jsPlumb.getRenderMode()].Label)(i)}this.addOverlay=function(e,t){i(e),t||r.repaint()},this.getOverlay=function(e){var t=o(e);return 0<=t?r.overlays[t]:null},this.getOverlays=function(){return r.overlays},this.hideOverlay=function(e){var t=r.getOverlay(e);t&&t.hide()},this.hideOverlays=function(){for(var e=0;e<r.overlays.length;e++)r.overlays[e].hide()},this.showOverlay=function(e){var t=r.getOverlay(e);t&&t.show()},this.showOverlays=function(){for(var e=0;e<r.overlays.length;e++)r.overlays[e].show()},this.removeAllOverlays=function(){for(var e=0;e<r.overlays.length;e++)r.overlays[e].cleanup&&r.overlays[e].cleanup();r.overlays.splice(0,r.overlays.length),r.repaint()},this.removeOverlay=function(e){var t=o(e);if(-1!=t){var i=r.overlays[t];i.cleanup&&i.cleanup(),r.overlays.splice(t,1)}},this.removeOverlays=function(){for(var e=0;e<arguments.length;e++)r.removeOverlay(arguments[e])};var s="__label";if(e.label){var l=e.labelLocation||r.defaultLabelLocation||.5,c=e.labelStyle||r._jsPlumb.Defaults.LabelStyle||Xe.Defaults.LabelStyle;this.overlays.push(a({label:e.label,location:l,labelStyle:c}))}this.setLabel=function(e){var t=r.getOverlay(s);if(t)e.constructor==String||e.constructor==Function?t.setLabel(e):(e.label&&t.setLabel(e.label),e.location&&t.setLocation(e.location));else{var i=e.constructor==String||e.constructor==Function?{label:e}:e;t=a(i),this.overlays.push(t)}r._jsPlumb.isSuspendDrawing()||r.repaint()},this.getLabel=function(){var e=r.getOverlay(s);return null!=e?e.getLabel():null},this.getLabelOverlay=function(){return r.getOverlay(s)};var u=this.applyType;this.applyType=function(e){if(u(e),r.removeAllOverlays(),e.overlays)for(var t=0;t<e.overlays.length;t++)r.addOverlay(e.overlays[t],!0)}}function Be(e,i,n){e.bind("click",function(e,t){i.fire("click",i,t)}),e.bind("dblclick",function(e,t){i.fire("dblclick",i,t)}),e.bind("contextmenu",function(e,t){i.fire("contextmenu",i,t)}),e.bind("mouseenter",function(e,t){i.isHover()||(n(!0),i.fire("mouseenter",i,t))}),e.bind("mouseexit",function(e,t){i.isHover()&&(n(!1),i.fire("mouseexit",i,t))})}function i(e){this.Defaults={Anchor:"BottomCenter",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",ConnectorZIndex:null,Container:null,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:8,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},e&&Xe.extend(this.Defaults,e),this.logEnabled=this.Defaults.LogEnabled;var i={},n={};this.registerConnectionType=function(e,t){i[e]=Xe.extend({},t)},this.registerConnectionTypes=function(e){for(var t in e)i[t]=Xe.extend({},e[t])},this.registerEndpointType=function(e,t){n[e]=Xe.extend({},t)},this.registerEndpointTypes=function(e){for(var t in e)n[t]=Xe.extend({},e[t])},this.getType=function(e,t){return"connection"===t?i[e]:n[e]},jsPlumbUtil.EventGenerator.apply(this);var R=this,r=function(){var e=Ke+1;return Ke++,e}(),o=R.bind,t={},a=1;for(var s in this.setZoom=function(e,t){a=e,t&&R.repaintEverything()},this.getZoom=function(){return a},this.Defaults)t[s]=this.Defaults[s];function O(e,t,i){var n=e[t];return null==n&&(n=[],e[t]=n),n.push(i),n}function N(e,t){R.Defaults.Container?Xe.CurrentLibrary.appendElement(e,R.Defaults.Container):t?Xe.CurrentLibrary.appendElement(e,t):jsPlumbAdapter.appendToRoot(e)}function l(){return""+w++}function p(e){return e._nodes?e._nodes:e}function F(e,t,i){if(!jsPlumbAdapter.headless&&!fe){var n=Fe(e,"id"),o=R.dragManager.getElementsForDraggable(n);if(null==i&&(i=Le()),R.anchorManager.redraw(n,t,i),o)for(var r in o)R.anchorManager.redraw(o[r].id,t,i,o[r].offset)}}function c(e,t){var i=null;if(Ve(e)){i=[];for(var n=0;n<e.length;n++){var o=qe(e[n]),r=Fe(o,"id");i.push(t(o,r))}}else{i=t(o=qe(e),r=Fe(o,"id"))}return i}function u(e){return z[e]}function d(t,e,i){if(!jsPlumbAdapter.headless){var n=null!=e&&e,o=Xe.CurrentLibrary;if(n&&o.isDragSupported(t)&&!o.isAlreadyDraggable(t)){var r=i||R.Defaults.DragOptions||Xe.Defaults.DragOptions;r=Xe.extend({},r);var a=o.dragEvents.drag,s=o.dragEvents.stop,l=o.dragEvents.start;r[l]=X(r[l],function(){R.setHoverSuspended(!0)}),r[a]=X(r[a],function(){var e=o.getUIPosition(arguments,R.getZoom());F(t,e),function(e,t){Xe.CurrentLibrary.addClass(qe(e),t)}(t,"jsPlumb_dragged")}),r[s]=X(r[s],function(){var e=o.getUIPosition(arguments,R.getZoom());F(t,e),function(e,t){Xe.CurrentLibrary.removeClass(qe(e),t)}(t,"jsPlumb_dragged"),R.setHoverSuspended(!1)});var c=K(t);b[c]=!0;n=b[c];r.disabled=null!=n&&!n,o.initDraggable(t,r,!1),R.dragManager.register(t)}}}function M(e){var t=R.Defaults.ConnectionType||R.getDefaultConnectionType(),i=R.Defaults.EndpointType||Ne,n=Xe.CurrentLibrary.getParent;e.container?e.parent=e.container:e.sourceEndpoint?e.parent=e.sourceEndpoint.parent:e.source.constructor==i?e.parent=e.source.parent:e.parent=n(e.source),e._jsPlumb=R;var o=new t(e);return o.id="con_"+l(),C("click","click",o),C("dblclick","dblclick",o),C("contextmenu","contextmenu",o),o}function P(e,t,i){if(t=t||{},e.suspendedEndpoint||O(W,e.scope,e),!t.doNotFireConnectionEvent&&!1!==t.fireEvent){var n={connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]};R.fire("jsPlumbConnection",n,i),R.fire("connection",n,i)}R.anchorManager.newConnection(e),F(e.source)}function I(e){if(e.container)return e.container;var t=Xe.CurrentLibrary.getTagName(e.source),i=Xe.CurrentLibrary.getParent(e.source);return t&&"td"===t.toLowerCase()?Xe.CurrentLibrary.getParent(i):i}function L(e){var t=R.Defaults.EndpointType||Ne;e.parent=I(e),e._jsPlumb=R;var i=new t(e);return i.id="ep_"+l(),C("click","endpointClick",i),C("dblclick","endpointDblClick",i),C("contextmenu","contextmenu",i),jsPlumbAdapter.headless||R.dragManager.endpointAdded(e.source),i}function h(e,t,i){var n=H[e];if(n&&n.length)for(var o=0;o<n.length;o++){for(var r=0;r<n[o].connections.length;r++){if(t(n[o].connections[r]))return}i&&i(n[o])}}function G(e,t){null!=e&&null!=e.parentNode&&e.parentNode.removeChild(e)}function $(e,t){for(var i=0;i<e.length;i++)G(e[i])}function f(e,i,n){i="block"===i;var t=null;n&&(t=i?function(e){e.setVisible(!0,!0,!0)}:function(e){e.setVisible(!1,!0,!0)});var o=Fe(e,"id");h(o,function(e){if(i&&n){var t=e.sourceId===o?1:0;e.endpoints[t].isVisible()&&e.setVisible(!0)}else e.setVisible(i)},t)}function g(e,t){var i=null;t&&(i=function(e){var t=e.isVisible();e.setVisible(!t)}),h(e,function(e){var t=e.isVisible();e.setVisible(!t)},i)}function B(e){var t,i=e.timestamp,n=e.recalc,o=e.offset,r=e.elId;return fe&&!i&&(i=ge),!n&&i&&i===y[r]||(n||!o?null!=(t=qe(r))&&(Y[r]=Ie(t),V[r]=Pe(t,R),y[r]=i):(V[r]=o,null!=Y[r]||null!=(t=qe(r))&&(Y[r]=Ie(t))),V[r]&&!V[r].right&&(V[r].right=V[r].left+Y[r][0],V[r].bottom=V[r].top+Y[r][1],V[r].width=Y[r][0],V[r].height=Y[r][1],V[r].centerx=V[r].left+V[r].width/2,V[r].centery=V[r].top+V[r].height/2)),V[r]}function j(e){var t=V[e];return{o:t=t||B({elId:e}),s:Y[e]}}this.bind=function(e,t){"ready"===e&&v?t():o.apply(R,[e,t])},R.importDefaults=function(e){for(var t in e)R.Defaults[t]=e[t]},R.restoreDefaults=function(){R.Defaults=Xe.extend({},t)};var m=null,v=!1,W={},H={},z={},V={},y={},U={},b={},Y=[],q=this.Defaults.Scope,Q=null,w=1,C=function(e,i,n){n.bind(e,function(e,t){R.fire(i,n,t)})},K=function(e,t,i){var n=qe(e),o=Fe(n,"id");return o&&"undefined"!=o||(2==arguments.length&&null!=t?o=t:1!=arguments.length&&(3!=arguments.length||i)||(o="jsPlumb_"+r+"_"+l()),i||Me(n,"id",o)),o},X=function(t,i,n){return t=t||function(){},i=i||function(){},function(){var e=null;try{e=i.apply(this,arguments)}catch(e){Qe(R,"jsPlumb function failed : "+e)}if(null==n||e!==n)try{t.apply(this,arguments)}catch(e){Qe(R,"wrapped function failed : "+e)}return e}};function J(e,t,i){var n=R.Defaults.ConnectionType||R.getDefaultConnectionType(),o=e.constructor==n?{connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]}:e;t&&(R.fire("jsPlumbConnectionDetached",o,i),R.fire("connectionDetached",o,i)),R.anchorManager.connectionDetached(o)}function _(e,t,i){return function(){return function(e,t,i,n){for(var o=0;o<e.length;o++)e[o][t].apply(e[o],i);return n(e)}(e,t,arguments,i)}}function A(e,t){return function(){return function(e,t,i){for(var n=[],o=0;o<e.length;o++)n.push([e[o][t].apply(e[o],i),e[o]]);return n}(e,t,arguments)}}function E(e,t){var i=[];if(e)if("string"==typeof e){if("*"===e)return e;i.push(e)}else if(t)i=e;else for(var n=0;n<e.length;n++)i.push(K(qe(e[n])));return i}function x(e,t,i){return"*"===e||(0<e.length?-1!=We(e,t):!i)}function S(e,t){return{setHover:_(e,"setHover",t),removeAllOverlays:_(e,"removeAllOverlays",t),setLabel:_(e,"setLabel",t),addOverlay:_(e,"addOverlay",t),removeOverlay:_(e,"removeOverlay",t),removeOverlays:_(e,"removeOverlays",t),showOverlay:_(e,"showOverlay",t),hideOverlay:_(e,"hideOverlay",t),showOverlays:_(e,"showOverlays",t),hideOverlays:_(e,"hideOverlays",t),setPaintStyle:_(e,"setPaintStyle",t),setHoverPaintStyle:_(e,"setHoverPaintStyle",t),setParameter:_(e,"setParameter",t),setParameters:_(e,"setParameters",t),setVisible:_(e,"setVisible",t),setZIndex:_(e,"setZIndex",t),repaint:_(e,"repaint",t),addType:_(e,"addType",t),toggleType:_(e,"toggleType",t),removeType:_(e,"removeType",t),getLabel:A(e,"getLabel"),getOverlay:A(e,"getOverlay"),isHover:A(e,"isHover"),getParameter:A(e,"getParameter"),getParameters:A(e,"getParameters"),getPaintStyle:A(e,"getPaintStyle"),getHoverPaintStyle:A(e,"getHoverPaintStyle"),isVisible:A(e,"isVisible"),getZIndex:A(e,"getZIndex"),hasType:A(e,"hasType"),getType:A(e,"getType"),length:e.length,each:function(i,n){return function(e){for(var t=0;t<i.length;t++)e(i[t]);return n(i)}}(e,t),get:function(t){return function(e){return t[e]}}(e)}}this.connectorClass="_jsPlumb_connector",this.endpointClass="_jsPlumb_endpoint",this.overlayClass="_jsPlumb_overlay",this.Anchors={},this.Connectors={canvas:{},svg:{},vml:{}},this.Endpoints={canvas:{},svg:{},vml:{}},this.Overlays={canvas:{},svg:{},vml:{}},this.addClass=function(e,t){return Xe.CurrentLibrary.addClass(e,t)},this.removeClass=function(e,t){return Xe.CurrentLibrary.removeClass(e,t)},this.hasClass=function(e,t){return Xe.CurrentLibrary.hasClass(e,t)},this.addEndpoint=function(e,t,i){i=i||{};var n=Xe.extend({},i);Xe.extend(n,t),n.endpoint=n.endpoint||R.Defaults.Endpoint||Xe.Defaults.Endpoint,n.paintStyle=n.paintStyle||R.Defaults.EndpointStyle||Xe.Defaults.EndpointStyle;for(var o=[],r=(e=p(e)).length&&e.constructor!=String?e:[e],a=0;a<r.length;a++){var s=qe(r[a]),l=K(s);n.source=s,B({elId:l,timestamp:ge});var c=L(n);n.parentAnchor&&(c.parentAnchor=n.parentAnchor),O(H,l,c);var u=V[l],d=Y[l],h={anchorLoc:c.anchor.compute({xy:[u.left,u.top],wh:d,element:c,timestamp:ge}),timestamp:ge};fe&&(h.recalc=!1),c.paint(h),o.push(c)}return 1==o.length?o[0]:o},this.addEndpoints=function(e,t,i){for(var n=[],o=0;o<t.length;o++){var r=R.addEndpoint(e,t[o],i);Ve(r)?Array.prototype.push.apply(n,r):n.push(r)}return n},this.animate=function(e,t,i){var n=qe(e),o=Fe(e,"id");i=i||{};var r=Xe.CurrentLibrary.dragEvents.step,a=Xe.CurrentLibrary.dragEvents.complete;i[r]=X(i[r],function(){R.repaint(o)}),i[a]=X(i[a],function(){R.repaint(o)}),Xe.CurrentLibrary.animate(n,t,i)},this.checkCondition=function(t,e){var i=R.getListener(t),n=!0;if(i&&0<i.length)try{for(var o=0;o<i.length;o++)n=n&&i[o](e)}catch(e){Qe(R,"cannot check condition ["+t+"]"+e)}return n},this.checkASyncCondition=function(t,e,i,n){var o=R.getListener(t);if(o&&0<o.length)try{o[0](e,i,n)}catch(e){Qe(R,"cannot asynchronously check condition ["+t+"]"+e)}},this.connect=function(e,t){var i,n=function(e,t){var i=Xe.extend({sourceIsNew:!0,targetIsNew:!0},e);if(t&&Xe.extend(i,t),i.source&&i.source.endpoint&&(i.sourceEndpoint=i.source),i.source&&i.target.endpoint&&(i.targetEndpoint=i.target),e.uuids&&(i.sourceEndpoint=u(e.uuids[0]),i.targetEndpoint=u(e.uuids[1])),i.sourceEndpoint&&i.sourceEndpoint.isFull())Qe(R,"could not add connection; source endpoint is full");else{if(!i.targetEndpoint||!i.targetEndpoint.isFull()){if(i.sourceEndpoint&&(i.sourceIsNew=!1),i.targetEndpoint&&(i.targetIsNew=!1),!i.type&&i.sourceEndpoint&&(i.type=i.sourceEndpoint.connectionType),i.sourceEndpoint&&i.sourceEndpoint.connectorOverlays){i.overlays=i.overlays||[];for(var n=0;n<i.sourceEndpoint.connectorOverlays.length;n++)i.overlays.push(i.sourceEndpoint.connectorOverlays[n])}if(i.tooltip=e.tooltip,!i.tooltip&&i.sourceEndpoint&&i.sourceEndpoint.connectorTooltip&&(i.tooltip=i.sourceEndpoint.connectorTooltip),i.target&&!i.target.endpoint&&!i.targetEndpoint&&!i.newConnection){var o=K(i.target),r=te[o],a=ie[o];if(r){if(!de[o])return;var s=null!=a?a:R.addEndpoint(i.target,r);ne[o]&&(ie[o]=s),(i.targetEndpoint=s)._makeTargetCreator=!0,i.targetIsNew=!0}}if(i.source&&!i.source.endpoint&&!i.sourceEndpoint&&!i.newConnection){o=K(i.source),r=re[o],a=ae[o];if(r){if(!le[o])return;s=null!=a?a:R.addEndpoint(i.source,r);se[o]&&(ae[o]=s),i.sourceEndpoint=s,i.sourceIsNew=!0}}return i}Qe(R,"could not add connection; target endpoint is full")}}(e,t);return n&&(null==n.deleteEndpointsOnDetach&&(n.deleteEndpointsOnDetach=!0),i=M(n),P(i,n)),i},this.deleteEndpoint=function(e){var t="string"==typeof e?z[e]:e;if(t){var i=t.getUuid();for(var n in i&&(z[i]=null),t.detachAll(),t.endpoint.cleanup&&t.endpoint.cleanup(),$(t.endpoint.getDisplayElements()),R.anchorManager.deleteEndpoint(t),H){var o=H[n];if(o){for(var r=[],a=0;a<o.length;a++)o[a]!=t&&r.push(o[a]);H[n]=r}}jsPlumbAdapter.headless||R.dragManager.endpointDeleted(t)}},this.deleteEveryEndpoint=function(){for(var e in R.setSuspendDrawing(!0),H){var t=H[e];if(t&&t.length)for(var i=0;i<t.length;i++)R.deleteEndpoint(t[i])}H={},z={},R.setSuspendDrawing(!1,!0)},this.detach=function(){if(0!=arguments.length){var e=R.Defaults.ConnectionType||R.getDefaultConnectionType(),t=arguments[0].constructor==e,i=2==arguments.length&&t?arguments[1]||{}:arguments[0],n=!1!==i.fireEvent,o=i.forceDetach,r=t?arguments[0]:i.connection;if(r)(o||r.isDetachAllowed(r)&&r.endpoints[0].isDetachAllowed(r)&&r.endpoints[1].isDetachAllowed(r))&&(o||R.checkCondition("beforeDetach",r))&&r.endpoints[0].detach(r,!1,!0,n);else{var a=Xe.extend({},i);if(a.uuids)u(a.uuids[0]).detachFrom(u(a.uuids[1]),n);else if(a.sourceEndpoint&&a.targetEndpoint)a.sourceEndpoint.detachFrom(a.targetEndpoint);else{var s=K(a.source),l=K(a.target);h(s,function(e){(e.sourceId==s&&e.targetId==l||e.targetId==s&&e.sourceId==l)&&R.checkCondition("beforeDetach",e)&&e.endpoints[0].detach(e,!1,!0,n)})}}}},this.detachAllConnections=function(e,t){t=t||{},e=qe(e);var i=Fe(e,"id"),n=H[i];if(n&&n.length)for(var o=0;o<n.length;o++)n[o].detachAll(t.fireEvent)},this.detachEveryConnection=function(e){for(var t in e=e||{},H){var i=H[t];if(i&&i.length)for(var n=0;n<i.length;n++)i[n].detachAll(e.fireEvent)}W={}},this.draggable=function(e,t){if("object"==typeof e&&e.length)for(var i=0;i<e.length;i++){(n=qe(e[i]))&&d(n,!0,t)}else if(e._nodes)for(i=0;i<e._nodes.length;i++){(n=qe(e._nodes[i]))&&d(n,!0,t)}else{var n;(n=qe(e))&&d(n,!0,t)}},this.extend=function(e,t){return Xe.CurrentLibrary.extend(e,t)},this.getDefaultEndpointType=function(){return Ne},this.getDefaultConnectionType=function(){return Oe},this.getConnections=function(e,n){e?e.constructor==String&&(e={scope:e}):e={};function t(e,t){if(!n&&1<o.length){var i=s[e];null==i&&(i=[],s[e]=i),i.push(t)}else s.push(t)}var i=e.scope||R.getDefaultScope(),o=E(i,!0),r=E(e.source),a=E(e.target),s=!n&&1<o.length?{}:[];for(var l in W)if(x(o,l))for(var c=0;c<W[l].length;c++){var u=W[l][c];x(r,u.sourceId)&&x(a,u.targetId)&&t(l,u)}return s};var T=function(t){var e=S(t,T);return Xe.CurrentLibrary.extend(e,{setDetachable:_(t,"setDetachable",T),setReattach:_(t,"setReattach",T),setConnector:_(t,"setConnector",T),detach:function(){for(var e=0;e<t.length;e++)R.detach(t[e])},isDetachable:A(t,"isDetachable"),isReattach:A(t,"isReattach")})},D=function(t){var e=S(t,D);return Xe.CurrentLibrary.extend(e,{setEnabled:_(t,"setEnabled",D),isEnabled:A(t,"isEnabled"),detachAll:function(){for(var e=0;e<t.length;e++)t[e].detachAll()},delete:function(){for(var e=0;e<t.length;e++)R.deleteEndpoint(t[e])}})};this.select=function(e){(e=e||{}).scope=e.scope||"*";var t=R.getConnections(e,!0);return T(t)},this.selectEndpoints=function(e){(e=e||{}).scope=e.scope||"*";var t=!e.element&&!e.source&&!e.target,i=t?"*":E(e.element),n=t?"*":E(e.source),o=t?"*":E(e.target),r=E(e.scope,!0),a=[];for(var s in H){var l=x(i,s,!0),c=x(n,s,!0),u="*"!=n,d=x(o,s,!0),h="*"!=o;if(l||c||d)e:for(var p=0;p<H[s].length;p++){var f=H[s][p];if(x(r,f.scope,!0)){var g=u&&0<n.length&&!f.isSource,m=h&&0<o.length&&!f.isTarget;if(g||m)continue e;a.push(f)}}}return D(a)},this.getAllConnections=function(){return W},this.getDefaultScope=function(){return q},this.getEndpoint=u,this.getEndpoints=function(e){return H[K(e)]},this.getId=K,this.getOffset=function(e){V[e];return B({elId:e})},this.getSelector=function(e){return Xe.CurrentLibrary.getSelector(e)},this.getSize=function(e){return Y[e]||B({elId:e}),Y[e]},this.appendElement=N;var k=!1;function Z(e){return function(){return jsPlumbAdapter.isRenderModeAvailable(e)}}function ee(e,t){e.paintStyle=e.paintStyle||R.Defaults.EndpointStyles[t]||R.Defaults.EndpointStyle||Xe.Defaults.EndpointStyles[t]||Xe.Defaults.EndpointStyle,e.hoverPaintStyle=e.hoverPaintStyle||R.Defaults.EndpointHoverStyles[t]||R.Defaults.EndpointHoverStyle||Xe.Defaults.EndpointHoverStyles[t]||Xe.Defaults.EndpointHoverStyle,e.anchor=e.anchor||R.Defaults.Anchors[t]||R.Defaults.Anchor||Xe.Defaults.Anchors[t]||Xe.Defaults.Anchor,e.endpoint=e.endpoint||R.Defaults.Endpoints[t]||R.Defaults.Endpoint||Xe.Defaults.Endpoints[t]||Xe.Defaults.Endpoint}this.isHoverSuspended=function(){return k},this.setHoverSuspended=function(e){k=e},this.isCanvasAvailable=Z("canvas"),this.isSVGAvailable=Z("svg"),this.isVMLAvailable=Z("vml"),this.hide=function(e,t){f(e,"none",t)},this.idstamp=l,this.init=function(){if(!v){R.setRenderMode(R.Defaults.RenderMode);function e(a){Xe.CurrentLibrary.bind(document,a,function(e){if(!R.currentlyDragging&&Q==Xe.CANVAS){for(var t in W)for(var i=W[t],n=0;n<i.length;n++){if(i[n].connector[a](e))return}for(var o in H){var r=H[o];for(n=0;n<r.length;n++)if(r[n].endpoint[a](e))return}}})}e("click"),e("dblclick"),e("mousemove"),e("mousedown"),e("mouseup"),e("contextmenu"),v=!0,R.fire("ready")}},this.log=m,this.jsPlumbUIComponent=Ge,this.makeAnchor=function(){if(0==arguments.length)return null;var e=arguments[0],t=arguments[1],i=null;if(e.compute&&e.getOrientation)return e;if("string"==typeof e)i=Xe.Anchors[arguments[0]]({elementId:t,jsPlumbInstance:R});else if(Ve(e))if(Ve(e[0])||Ue(e[0]))if(2==e.length&&Ue(e[0])&&Ye(e[1])){var n=Xe.extend({elementId:t,jsPlumbInstance:R},e[1]);i=Xe.Anchors[e[0]](n)}else i=new _e(e,null,t);else{var o={x:e[0],y:e[1],orientation:4<=e.length?[e[2],e[3]]:[0,0],offsets:6==e.length?[e[4],e[5]]:[0,0],elementId:t};(i=new Ce(o)).clone=function(){return new Ce(o)}}return i.id||(i.id="anchor_"+l()),i},this.makeAnchors=function(e,t,i){for(var n=[],o=0;o<e.length;o++)"string"==typeof e[o]?n.push(Xe.Anchors[e[o]]({elementId:t,jsPlumbInstance:i})):Ve(e[o])&&n.push(R.makeAnchor(e[o],t,i));return n},this.makeDynamicAnchor=function(e,t){return new _e(e,t)};var te={},ie={},ne={},oe={};this.makeTarget=function(e,t,i){var m=Xe.extend({_jsPlumb:R},i);Xe.extend(m,t),ee(m,1);var v=Xe.CurrentLibrary,n=m.scope||R.Defaults.Scope,y=!(!1===m.deleteEndpointsOnDetach),o=m.maxConnections||-1,b=m.onMaxConnections;_doOne=function(f){var g=K(f);te[g]=m,ne[g]=m.uniqueEndpoint,oe[g]=o,de[g]=!0,proxyComponent=new Ge(m);var e=Xe.extend({},m.dropOptions||{}),t=v.dragEvents.drop;e.scope=e.scope||n,e[t]=X(e[t],function(){var e=Xe.CurrentLibrary.getDropEvent(arguments),t=R.select({target:g}).length;R.currentlyDragging=!1;var i=qe(v.getDragObject(arguments)),n=Fe(i,"dragId"),o=Fe(i,"originalScope"),r=U[n],a=r.endpoints[0];m.endpoint&&Xe.extend({},m.endpoint);if(!de[g]||0<oe[g]&&t>=oe[g])return b&&b({element:f,connection:r},e),!1;a.anchor.locked=!1,o&&v.setDragScope(i,o);var s=proxyComponent.isDropAllowed(r.sourceId,K(f),r.scope,r,null);if(r.endpointsToDeleteOnDetach&&(a===r.endpointsToDeleteOnDetach[0]?r.endpointsToDeleteOnDetach[0]=null:a===r.endpointsToDeleteOnDetach[1]&&(r.endpointsToDeleteOnDetach[1]=null)),r.suspendedEndpoint&&(r.targetId=r.suspendedEndpoint.elementId,r.target=v.getElementObject(r.suspendedEndpoint.elementId),r.endpoints[1]=r.suspendedEndpoint),s){a.detach(r,!1,!0,!1);var l=ie[g]||R.addEndpoint(f,m);if(m.uniqueEndpoint&&(ie[g]=l),l._makeTargetCreator=!0,null!=l.anchor.positionFinder){var c=v.getUIPosition(arguments,R.getZoom()),u=Pe(f,R),d=Ie(f),h=l.anchor.positionFinder(c,u,d,l.anchor.constructorParams);l.anchor.x=h[0],l.anchor.y=h[1]}var p=R.connect({source:a,target:l,scope:o,previousConnection:r,container:r.parent,deleteEndpointsOnDetach:y,doNotFireConnectionEvent:a.endpointWillMoveAfterConnection});r.endpoints[1]._makeTargetCreator&&r.endpoints[1].connections.length<2&&R.deleteEndpoint(r.endpoints[1]),y&&(p.endpointsToDeleteOnDetach=[a,l]),p.repaint()}else r.suspendedEndpoint&&(r.isReattach()?(r.setHover(!1),r.floatingAnchorIndex=null,r.suspendedEndpoint.addConnection(r),R.repaint(a.elementId)):a.detach(r,!1,!0,!0,e))}),v.initDroppable(f,e,!0)};for(var r=(e=p(e)).length&&e.constructor!=String?e:[e],a=0;a<r.length;a++)_doOne(qe(r[a]));return R},this.unmakeTarget=function(e,t){e=Xe.CurrentLibrary.getElementObject(e);var i=K(e);return t||(delete te[i],delete ne[i],delete oe[i],delete de[i]),R},this.makeTargets=function(e,t,i){for(var n=0;n<e.length;n++)R.makeTarget(e[n],t,i)};var re={},ae={},se={},le={},ce={},ue={},de={};function he(e,t,i,n){var o="source"==e?le:de;if(Ue(t))o[t]=n?!o[t]:i;else if(t.length){t=p(t);for(var r=0;r<t.length;r++){var a=_el=Xe.CurrentLibrary.getElementObject(t[r]);o[a=K(_el)]=n?!o[a]:i}}return R}this.makeSource=function(e,y,t){var b=Xe.extend({},t);Xe.extend(b,y),ee(b,0);function i(h){var p=K(h),e=b.parent,f=null!=e?R.getId(w.getElementObject(e)):p;re[f]=b,se[f]=b.uniqueEndpoint,le[f]=!0;var t=w.dragEvents.stop,i=w.dragEvents.drag,g=Xe.extend({},b.dragOptions||{}),n=g.drag,r=g.stop,m=null,v=!1;function o(e){if(le[f]){var t=R.select({source:f}).length;if(0<=ue[f]&&t>=ue[f])return _&&_({element:h,maxConnections:C},e),!1;if(y.filter)if(!1===y.filter(w.getOriginalEvent(e),h))return;var i=B({elId:p}),n=((e.pageX||e.page.x)-i.left)/i.width,o=((e.pageY||e.page.y)-i.top)/i.height,r=n,a=o;if(b.parent){var s=w.getElementObject(b.parent),l=K(s);i=B({elId:l}),r=((e.pageX||e.page.x)-i.left)/i.width,a=((e.pageY||e.page.y)-i.top)/i.height}var c={};if(Xe.extend(c,b),c.isSource=!0,c.anchor=[n,o,0,0],c.parentAnchor=[r,a,0,0],c.dragOptions=g,b.parent){var u=c.container||R.Defaults.Container||Xe.Defaults.Container;c.container=u||Xe.CurrentLibrary.getParent(b.parent)}m=R.addEndpoint(p,c),v=!0,m.endpointWillMoveAfterConnection=null!=b.parent,m.endpointWillMoveTo=b.parent?w.getElementObject(b.parent):null;function d(){v&&R.deleteEndpoint(m)}R.registerListener(m.canvas,"mouseup",d),R.registerListener(h,"mouseup",d),w.trigger(m.canvas,"mousedown",e)}}ue[f]=C,g.scope=g.scope||b.scope,g[i]=X(g[i],function(){n&&n.apply(this,arguments),v=!1}),g[t]=X(g[t],function(){if(r&&r.apply(this,arguments),R.currentlyDragging=!1,0==m.connections.length)R.deleteEndpoint(m);else{w.unbind(m.canvas,"mousedown");var e=b.anchor||R.Defaults.Anchor,t=(m.anchor,m.connections[0]);if(m.anchor=R.makeAnchor(e,p,R),b.parent){var i=w.getElementObject(b.parent);if(i){var n=m.elementId,o=b.container||R.Defaults.Container||Xe.Defaults.Container;m.setElement(i,o),m.endpointWillMoveAfterConnection=!1,R.anchorManager.rehomeEndpoint(n,i),t.previousConnection=null,He(W[t.scope],function(e){return e.id===t.id}),R.anchorManager.connectionDetached({sourceId:t.sourceId,targetId:t.targetId,connection:t}),P(t)}}m.repaint(),R.repaint(m.elementId),R.repaint(t.targetId)}}),R.registerListener(h,"mousedown",o),ce[p]=o}for(var w=Xe.CurrentLibrary,C=b.maxConnections||-1,_=b.onMaxConnections,n=(e=p(e)).length&&e.constructor!=String?e:[e],o=0;o<n.length;o++)i(qe(n[o]));return R},this.unmakeSource=function(e,t){e=Xe.CurrentLibrary.getElementObject(e);var i=K(e),n=ce[i];return n&&R.unregisterListener(e,"mousedown",n),t||(delete re[i],delete se[i],delete le[i],delete ce[i],delete ue[i]),R},this.unmakeEverySource=function(){for(var e in le)R.unmakeSource(e,!0);re={},se={},le={},ce={}},this.unmakeEveryTarget=function(){for(var e in de)R.unmakeTarget(e,!0);return te={},ne={},oe={},de={},R},this.makeSources=function(e,t,i){for(var n=0;n<e.length;n++)R.makeSource(e[n],t,i);return R},this.setSourceEnabled=function(e,t){return he("source",e,t)},this.toggleSourceEnabled=function(e){return he("source",e,null,!0),R.isSourceEnabled(e)},this.isSource=function(e){return e=Xe.CurrentLibrary.getElementObject(e),null!=le[K(e)]},this.isSourceEnabled=function(e){return e=Xe.CurrentLibrary.getElementObject(e),!0===le[K(e)]},this.setTargetEnabled=function(e,t){return he("target",e,t)},this.toggleTargetEnabled=function(e){return he("target",e,null,!0)},this.isTarget=function(e){return e=Xe.CurrentLibrary.getElementObject(e),null!=de[K(e)]},this.isTargetEnabled=function(e){return e=Xe.CurrentLibrary.getElementObject(e),!0===de[K(e)]},this.ready=function(e){R.bind("ready",e)},this.repaint=function(e,t,i){if("object"==typeof e)for(var n=0;n<e.length;n++)F(qe(e[n]),t,i);else F(qe(e),t,i);return R},this.repaintEverything=function(){for(var e in H)F(qe(e));return R},this.removeAllEndpoints=function(e){var t=Fe(e,"id"),i=H[t];if(i)for(var n=0;n<i.length;n++)R.deleteEndpoint(i[n]);return H[t]=[],R};var pe={};this.registerListener=function(e,t,i){Xe.CurrentLibrary.bind(e,t,i),O(pe,t,{el:e,event:t,listener:i})},this.unregisterListener=function(e,t,i){Xe.CurrentLibrary.unbind(e,t,i),He(pe,function(e){return e.type==t&&e.listener==i})},this.reset=function(){R.deleteEveryEndpoint(),R.unbind(),te={},ie={},ne={},oe={},re={},ae={},se={},ue={},function(){for(var e in pe)for(var t=0;t<pe[e].length;t++){var i=pe[e][t];Xe.CurrentLibrary.unbind(i.el,i.event,i.listener)}pe={}}(),R.anchorManager.reset(),jsPlumbAdapter.headless||R.dragManager.reset()},this.setDefaultScope=function(e){return q=e,R},this.setDraggable=function(e,i){return c(e,function(e,t){b[t]=i,Xe.CurrentLibrary.isDragSupported(e)&&Xe.CurrentLibrary.setDraggable(e,i)})},this.setId=function(o,r,e){var t=o.constructor==String?o:R.getId(o),i=R.getConnections({source:t,scope:"*"},!0),n=R.getConnections({target:t,scope:"*"},!0);r=""+r,e||(o=Xe.CurrentLibrary.getElementObject(t),Xe.CurrentLibrary.setAttribute(o,"id",r)),o=Xe.CurrentLibrary.getElementObject(r),H[r]=H[t]||[];for(var a=0;a<H[r].length;a++)H[r][a].elementId=r,H[r][a].element=o,H[r][a].anchor.elementId=r;delete H[t],R.anchorManager.changeId(t,r);function s(e,t,i){for(var n=0;n<e.length;n++)e[n].endpoints[t].elementId=r,e[n].endpoints[t].element=o,e[n][i+"Id"]=r,e[n][i]=o}s(i,0,"source"),s(n,1,"target")},this.setIdChanged=function(e,t){R.setId(e,t,!0)};var fe=!(this.setDebugLog=function(e){m=e}),ge=null;function me(e,t){var i=null,n=e;if("svg"===t.tagName.toLowerCase()&&t.parentNode?i=t.parentNode:t.offsetParent&&(i=t.offsetParent),null!=i){var o="body"===i.tagName.toLowerCase()?{left:0,top:0}:Pe(i,R),r="body"===i.tagName.toLowerCase()?{left:0,top:0}:{left:i.scrollLeft,top:i.scrollTop};n[0]=e[0]-o.left+r.left,n[1]=e[1]-o.top+r.top}return n}function ve(e){var i=e.reference,t=e.referenceCanvas,o=Ie(qe(t)),n=null,r=null;this.x=0,this.y=0,this.isFloating=!0,this.compute=function(e){var t=e.xy,i=e.element,n=[t[0]+o[0]/2,t[1]+o[1]/2];return n=me(n,i.canvas),r=n},this.getOrientation=function(e){if(n)return n;var t=i.getOrientation(e);return[0*Math.abs(t[0])*-1,0*Math.abs(t[1])*-1]},this.over=function(e){n=e.getOrientation()},this.out=function(){n=null},this.getCurrentLocation=function(){return r}}function ye(e,t,i,n){if(e===t)return{orientation:ke,a:["top","top"]};var o=Math.atan2(n.centery-i.centery,n.centerx-i.centerx),r=Math.atan2(i.centery-n.centery,i.centerx-n.centerx),a=i.left<=n.left&&i.right>=n.left||i.left<=n.right&&i.right>=n.right||i.left<=n.left&&i.right>=n.right||n.left<=i.left&&n.right>=i.right,s=i.top<=n.top&&i.bottom>=n.top||i.top<=n.bottom&&i.bottom>=n.bottom||i.top<=n.top&&i.bottom>=n.bottom||n.top<=i.top&&n.bottom>=i.bottom;if(a||s)return a?{orientation:Se,a:i.top<n.top?["bottom","top"]:["top","bottom"],theta:o,theta2:r}:{orientation:Te,a:i.left<n.left?["right","left"]:["left","right"],theta:o,theta2:r};var l=null;return n.left>i.left&&n.top>i.top?l=["right","top"]:n.left>i.left&&i.top>n.top?l=["top","left"]:n.left<i.left&&n.top<i.top?l=["top","right"]:n.left<i.left&&n.top>i.top&&(l=["left","top"]),{orientation:De,a:l,theta:o,theta2:r}}function be(i){return function(e,t){return!1===(i?e[0][0]<t[0][0]||e[0][1]>t[0][1]:e[0][0]>t[0][0]||e[0][1]>t[0][1])?-1:1}}function we(p,e){function t(e,t,i,n,o,r,a){if(0<n.length){function s(e,t){var i=me([t[0],t[1]],e.canvas);Ee[e.id]=[i[0],i[1],t[2],t[3]],xe[e.id]=a}for(var l=function(e,t,i,n,o,r,a){for(var s=[],l=t[o?0:1]/(n.length+1),c=0;c<n.length;c++){var u=(c+1)*l,d=r*t[o?1:0];a&&(u=t[o?0:1]-u);var h=o?u:d,p=i[0]+h,f=h/t[0],g=o?d:u,m=i[1]+g,v=g/t[1];s.push([p,m,f,v,n[c][1],n[c][2]])}return s}(0,t,i,function(e,t){return e.sort(t)}(n,Re[e]),o,r,"right"===e||"top"===e),c=0;c<l.length;c++){var u=l[c][4],d=u.endpoints[0].elementId===p,h=u.endpoints[1].elementId===p;d?s(u.endpoints[0],l[c]):h&&s(u.endpoints[1],l[c])}}}var i=Y[p],n=V[p];t("bottom",i,[n.left,n.top],e.bottom,!0,1,[0,1]),t("top",i,[n.left,n.top],e.top,!0,0,[0,-1]),t("left",i,[n.left,n.top],e.left,!1,0,[-1,0]),t("right",i,[n.left,n.top],e.right,!1,1,[1,0])}this.setSuspendDrawing=function(e,t){ge=(fe=e)?(new Date).getTime():null,t&&R.repaintEverything()},this.isSuspendDrawing=function(){return fe},this.CANVAS="canvas",this.SVG="svg",this.VML="vml",this.setRenderMode=function(e){return Q=jsPlumbAdapter.setRenderMode(e)},this.getRenderMode=function(){return Q},this.show=function(e,t){return f(e,"block",t),R},this.sizeCanvas=function(e,t,i,n,o){return e&&(e.style.height=o+"px",e.height=o,e.style.width=n+"px",e.width=n,e.style.left=t+"px",e.style.top=i+"px"),R},this.getTestHarness=function(){return{endpointsByElement:H,endpointCount:function(e){var t=H[e];return t?t.length:0},connectionCount:function(e){var t=W[e=e||q];return t?t.length:0},getId:K,makeAnchor:self.makeAnchor,makeDynamicAnchor:self.makeDynamicAnchor}},this.toggle=g,this.toggleVisible=g,this.toggleDraggable=function(e){return c(e,function(e,t){var i=null!=b[t]&&b[t];return i=!i,b[t]=i,Xe.CurrentLibrary.setDraggable(e,i),i})},this.wrap=X,this.addListener=this.bind;var Ce=function(e){var r=this;this.x=e.x||0,this.y=e.y||0,this.elementId=e.elementId;var t=e.orientation||[0,0],a=null;this.offsets=e.offsets||[0,0],r.timestamp=null,this.compute=function(e){var t=e.xy,i=e.wh,n=e.element,o=e.timestamp;return o&&o===r.timestamp||(a=[t[0]+r.x*i[0]+r.offsets[0],t[1]+r.y*i[1]+r.offsets[1]],a=me(a,n.canvas),r.timestamp=o),a},this.getOrientation=function(e){return t},this.equals=function(e){if(!e)return!1;var t=e.getOrientation(),i=this.getOrientation();return this.x==e.x&&this.y==e.y&&this.offsets[0]==e.offsets[0]&&this.offsets[1]==e.offsets[1]&&i[0]==t[0]&&i[1]==t[1]},this.getCurrentLocation=function(){return a}},_e=function(e,t,i){this.isSelective=!0,this.isDynamic=!0;function n(e){return e.constructor==Ce?e:R.makeAnchor(e,i,R)}for(var r=[],o=0;o<e.length;o++)r[o]=n(e[o]);this.addAnchor=function(e){r.push(n(e))},this.getAnchors=function(){return r},this.locked=!1;var a=0<r.length?r[0]:null,s=(r.length,this),l=t||function(e,t,i,n,o){for(var r,a,s,l,c,u,d,h,p,f=i[0]+n[0]/2,g=i[1]+n[1]/2,m=-1,v=1/0,y=0;y<o.length;y++){var b=(r=o[y],a=f,s=g,c=t,void 0,u=(l=e)[0]+r.x*c[0],d=l[1]+r.y*c[1],h=l[0]+c[0]/2,p=l[1]+c[1]/2,Math.sqrt(Math.pow(a-u,2)+Math.pow(s-d,2))+Math.sqrt(Math.pow(h-u,2)+Math.pow(p-d,2)));b<v&&(m=y+0,v=b)}return o[m]};this.compute=function(e){var t=e.xy,i=e.wh,n=(e.timestamp,e.txy),o=e.twh;return s.locked||null==n||null==o||(e.timestamp=null,a=l(t,i,n,o,r),s.x=a.x,s.y=a.y),a.compute(e)},this.getCurrentLocation=function(){return null!=a?a.getCurrentLocation():null},this.getOrientation=function(e){return null!=a?a.getOrientation(e):[0,0]},this.over=function(e){null!=a&&a.over(e)},this.out=function(){null!=a&&a.out()}},Ae={},Ee={},xe={},Se="horizontal",Te="vertical",De="diagonal",ke="identity",Re={top:function(e,t){return e[0]>t[0]?1:-1},right:be(!0),bottom:be(!0),left:function(e,t){var i=e[0][0]<0?-Math.PI-e[0][0]:Math.PI-e[0][0];return(t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0])<i?1:e[0][1]>t[0][1]?1:-1}};R.anchorManager=new function(){var S={},T={},d=this,D={};this.reset=function(){S={},T={},D={}},this.newConnection=function(e){function t(e,t,i,n,o){r==a&&i.isContinuous&&(Xe.CurrentLibrary.removeElement(s[1].canvas),l=!1),O(T,n,[o,t,i.constructor==_e])}var r=e.sourceId,a=e.targetId,s=e.endpoints,l=!0;t(0,s[0],s[0].anchor,a,e),l&&t(0,s[1],s[1].anchor,r,e)},this.connectionDetached=function(e){function t(e,t,i,n,o){i.constructor==ve||He(T[n],function(e){return e[0].id==o.id})}var i=e.connection||e,n=i.sourceId,o=i.targetId,r=i.endpoints;t(0,r[1],r[1].anchor,n,i),t(0,r[0],r[0].anchor,o,i);function a(e,t){if(e){function i(e){return e[4]==t}He(e.top,i),He(e.left,i),He(e.bottom,i),He(e.right,i)}}var s=i.sourceId,l=i.targetId,c=i.endpoints[0].id,u=i.endpoints[1].id;a(D[s],c),a(D[l],u),d.redraw(s),d.redraw(l)},this.add=function(e,t){O(S,t,e)},this.changeId=function(e,t){T[t]=T[e],S[t]=S[e],delete T[e],delete S[e]},this.getConnectionsFor=function(e){return T[e]||[]},this.getEndpointsFor=function(e){return S[e]||[]},this.deleteEndpoint=function(t){He(S[t.elementId],function(e){return e.id==t.id})},this.clearFor=function(e){delete S[e],S[e]=[]};function k(e,t,i,n,o,r,a,s,l,c,u,d){var h=-1,p=n.endpoints[a],f=p.id,g=[[t,i],n,o,r,f],m=e[l],v=p._continuousAnchorEdge?e[p._continuousAnchorEdge]:null;if(v){var y=je(v,function(e){return e[4]==f});if(-1!=y){v.splice(y,1);for(var b=0;b<v.length;b++)ze(u,v[b][1],function(e){return e.id==v[b][1].id}),ze(d,v[b][1].endpoints[a],function(e){return e.id==v[b][1].endpoints[a].id})}}for(b=0;b<m.length;b++)1==a&&m[b][3]===r&&-1==h&&(h=b),ze(u,m[b][1],function(e){return e.id==m[b][1].id}),ze(d,m[b][1].endpoints[a],function(e){return e.id==m[b][1].endpoints[a].id});var w=s?-1!=h?h:0:m.length;m.splice(w,0,g),p._continuousAnchorEdge=l}this.redraw=function(t,e,i,n){if(!fe){var o=S[t]||[],r=T[t]||[],a=[],s=[],l=[];i=i||Le(),n=n||{left:0,top:0},e=e&&{left:e.left+n.left,top:e.top+n.top},B({elId:t,offset:e,recalc:!1,timestamp:i});for(var c=V[t],u=Y[t],d={},h=0;h<r.length;h++){var p=r[h][0],f=p.sourceId,g=p.targetId,m=p.endpoints[0].anchor.isContinuous,v=p.endpoints[1].anchor.isContinuous;if(m||v){var y=f+"_"+g,b=d[y],w=p.sourceId==t?1:0;m&&!D[f]&&(D[f]={top:[],right:[],bottom:[],left:[]}),v&&!D[g]&&(D[g]={top:[],right:[],bottom:[],left:[]}),t!=g&&B({elId:g,timestamp:i}),t!=f&&B({elId:f,timestamp:i});var C=j(g),_=j(f);g==f&&(m||v)?k(D[f],-Math.PI/2,0,p,!1,g,0,!1,"top",0,a,s):(b||(b=ye(f,g,_.o,C.o),d[y]=b),m&&k(D[f],b.theta,0,p,!1,g,0,!1,b.a[0],0,a,s),v&&k(D[g],b.theta2,-1,p,!0,f,1,!0,b.a[1],0,a,s)),m&&ze(l,f,function(e){return e===f}),v&&ze(l,g,function(e){return e===g}),ze(a,p,function(e){return e.id==p.id}),(m&&0==w||v&&1==w)&&ze(s,p.endpoints[w],function(e){return e.id==p.endpoints[w].id})}}for(h=0;h<o.length;h++)0==o[h].connections.length&&o[h].anchor.isContinuous&&(D[t]||(D[t]={top:[],right:[],bottom:[],left:[]}),k(D[t],-Math.PI/2,0,{endpoints:[o[h],o[h]],paint:function(){}},!1,t,0,!1,"top",0,a,s),ze(l,t,function(e){return e===t}));for(h=0;h<l.length;h++)we(l[h],D[l[h]]);for(h=0;h<o.length;h++)o[h].paint({timestamp:i,offset:c,dimensions:u});for(h=0;h<s.length;h++)s[h].paint({timestamp:i,offset:c,dimensions:u});for(h=0;h<r.length;h++){var A=r[h][1];if(A.anchor.constructor==_e){A.paint({elementWithPrecedence:t}),ze(a,r[h][0],function(e){return e.id==r[h][0].id});for(var E=0;E<A.connections.length;E++)A.connections[E]!==r[h][0]&&ze(a,A.connections[E],function(e){return e.id==A.connections[E].id})}else A.anchor.constructor==Ce&&ze(a,r[h][0],function(e){return e.id==r[h][0].id})}var x=U[t];x&&x.paint({timestamp:i,recalc:!1,elId:t});for(h=0;h<a.length;h++)a[h].paint({elId:t,timestamp:i,recalc:!1})}},this.rehomeEndpoint=function(e,t){var i=S[e]||[],n=R.getId(t);if(n!==e){for(var o=0;o<i.length;o++)d.add(i[o],n);i.splice(0,i.length)}}},R.continuousAnchorFactory={get:function(e){var t=Ae[e.elementId];return t||(t={type:"Continuous",compute:function(e){return Ee[e.element.id]||[0,0]},getCurrentLocation:function(e){return Ee[e.id]||[0,0]},getOrientation:function(e){return xe[e.id]||[0,0]},isDynamic:!0,isContinuous:!0},Ae[e.elementId]=t),t}},jsPlumbAdapter.headless||(R.dragManager=jsPlumbAdapter.getDragManager(R)),R.recalculateOffsets=R.dragManager.updateOffsets;var Oe=function(o){var r,i,m=this,v=!0;m.idPrefix="_jsplumb_c_",m.defaultLabelLocation=.5,m.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.parent=o.parent,$e.apply(this,arguments),this.isVisible=function(){return v},this.setVisible=function(e){m[(v=e)?"showOverlays":"hideOverlays"](),m.connector&&m.connector.canvas&&(m.connector.canvas.style.display=e?"block":"none"),m.repaint()},this.getTypeDescriptor=function(){return"connection"},this.getDefaultType=function(){return{parameters:{},scope:null,detachable:m._jsPlumb.Defaults.ConnectionsDetachable,rettach:m._jsPlumb.Defaults.ReattachConnections,paintStyle:m._jsPlumb.Defaults.PaintStyle||Xe.Defaults.PaintStyle,connector:m._jsPlumb.Defaults.Connector||Xe.Defaults.Connector,hoverPaintStyle:m._jsPlumb.Defaults.HoverPaintStyle||Xe.Defaults.HoverPaintStyle,overlays:m._jsPlumb.Defaults.ConnectorOverlays||Xe.Defaults.ConnectorOverlays}};var t=this.applyType;this.applyType=function(e){t(e),null!=e.detachable&&m.setDetachable(e.detachable),null!=e.reattach&&m.setReattach(e.reattach),e.scope&&(m.scope=e.scope),m.setConnector(e.connector)},i=m.setHover,m.setHover=function(e){var t=R.ConnectorZIndex||Xe.Defaults.ConnectorZIndex;t&&m.connector.setZIndex(t+(e?1:0)),m.connector.setHover.apply(m.connector,arguments),i.apply(m,arguments)},r=function(e){m.setHover(e,!1)},this.setConnector=function(e,t){null!=m.connector&&$(m.connector.getDisplayElements(),m.parent);var i={_jsPlumb:m._jsPlumb,parent:o.parent,cssClass:o.cssClass,container:o.container,tooltip:m.tooltip};Ue(e)?this.connector=new Xe.Connectors[Q][e](i):Ve(e)&&(1==e.length?this.connector=new Xe.Connectors[Q][e[0]](i):this.connector=new Xe.Connectors[Q][e[0]](Xe.extend(e[1],i))),m.canvas=m.connector.canvas,Be(m.connector,m,r);var n=R.ConnectorZIndex||Xe.Defaults.ConnectorZIndex;n&&m.connector.setZIndex(n),t||m.repaint()},this.source=qe(o.source),this.target=qe(o.target),o.sourceEndpoint&&(this.source=o.sourceEndpoint.endpointWillMoveTo||o.sourceEndpoint.getElement()),o.targetEndpoint&&(this.target=o.targetEndpoint.getElement()),m.previousConnection=o.previousConnection,this.sourceId=Fe(this.source,"id"),this.targetId=Fe(this.target,"id"),this.scope=o.scope,this.endpoints=[],this.endpointStyles=[];function p(e,t){return e?R.makeAnchor(e,t,R):null}function e(e,t,i,n,o,r,a){var s;if(e)(m.endpoints[t]=e).addConnection(m);else{i.endpoints||(i.endpoints=[null,null]);var l=i.endpoints[t]||i.endpoint||R.Defaults.Endpoints[t]||Xe.Defaults.Endpoints[t]||R.Defaults.Endpoint||Xe.Defaults.Endpoint;i.endpointStyles||(i.endpointStyles=[null,null]),i.endpointHoverStyles||(i.endpointHoverStyles=[null,null]);var c=i.endpointStyles[t]||i.endpointStyle||R.Defaults.EndpointStyles[t]||Xe.Defaults.EndpointStyles[t]||R.Defaults.EndpointStyle||Xe.Defaults.EndpointStyle;null==c.fillStyle&&null!=r&&(c.fillStyle=r.strokeStyle),null==c.outlineColor&&null!=r&&(c.outlineColor=r.outlineColor),null==c.outlineWidth&&null!=r&&(c.outlineWidth=r.outlineWidth);var u=i.endpointHoverStyles[t]||i.endpointHoverStyle||R.Defaults.EndpointHoverStyles[t]||Xe.Defaults.EndpointHoverStyles[t]||R.Defaults.EndpointHoverStyle||Xe.Defaults.EndpointHoverStyle;null!=a&&(null==u&&(u={}),null==u.fillStyle&&(u.fillStyle=a.strokeStyle));var d=i.anchors?i.anchors[t]:i.anchor?i.anchor:p(R.Defaults.Anchors[t],o)||p(Xe.Defaults.Anchors[t],o)||p(R.Defaults.Anchor,o)||p(Xe.Defaults.Anchor,o),h=i.uuids?i.uuids[t]:null;s=L({paintStyle:c,hoverPaintStyle:u,endpoint:l,connections:[m],uuid:h,anchor:d,source:n,scope:i.scope,container:i.container,reattach:i.reattach||R.Defaults.ReattachConnections,detachable:i.detachable||R.Defaults.ConnectionsDetachable}),m.endpoints[t]=s,!1===i.drawEndpoints&&s.setVisible(!1,!0,!0)}return s}var n=e(o.sourceEndpoint,0,o,m.source,m.sourceId,o.paintStyle,o.hoverPaintStyle);n&&O(H,this.sourceId,n);var a=e(o.targetEndpoint,1,o,m.target,m.targetId,o.paintStyle,o.hoverPaintStyle);a&&O(H,this.targetId,a),this.scope||(this.scope=this.endpoints[0].scope),m.endpointsToDeleteOnDetach=[null,null],o.deleteEndpointsOnDetach&&(o.sourceIsNew&&(m.endpointsToDeleteOnDetach[0]=m.endpoints[0]),o.targetIsNew&&(m.endpointsToDeleteOnDetach[1]=m.endpoints[1])),m.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||o.connector||R.Defaults.Connector||Xe.Defaults.Connector,!0),this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||o.paintStyle||R.Defaults.PaintStyle||Xe.Defaults.PaintStyle,!0),this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||o.hoverPaintStyle||R.Defaults.HoverPaintStyle||Xe.Defaults.HoverPaintStyle,!0),this.paintStyleInUse=this.getPaintStyle(),B({elId:this.sourceId,timestamp:ge}),B({elId:this.targetId,timestamp:ge});var s=V[this.sourceId],l=Y[this.sourceId],c=V[this.targetId],u=Y[this.targetId],d=ge||Le(),h=this.endpoints[0].anchor.compute({xy:[s.left,s.top],wh:l,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[c.left,c.top],twh:u,tElement:this.endpoints[1],timestamp:d});this.endpoints[0].paint({anchorLoc:h,timestamp:d}),h=this.endpoints[1].anchor.compute({xy:[c.left,c.top],wh:u,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[s.left,s.top],twh:l,tElement:this.endpoints[0],timestamp:d}),this.endpoints[1].paint({anchorLoc:h,timestamp:d});var f=R.Defaults.ConnectionsDetachable;!1===o.detachable&&(f=!1),!1===m.endpoints[0].connectionsDetachable&&(f=!1),!1===m.endpoints[1].connectionsDetachable&&(f=!1),this.isDetachable=function(){return!0===f},this.setDetachable=function(e){f=!0===e};var g=o.reattach||m.endpoints[0].reattachConnections||m.endpoints[1].reattachConnections||R.Defaults.ReattachConnections;this.isReattach=function(){return!0===g},this.setReattach=function(e){g=!0===e};var y=o.cost||m.endpoints[0].getConnectionCost();m.getCost=function(){return y};var b=!(!(m.setCost=function(e){y=e})===o.bidirectional);null==o.bidirectional&&(b=m.endpoints[0].areConnectionsBidirectional()),m.isBidirectional=function(){return b};var w=Xe.extend({},this.endpoints[0].getParameters());Xe.extend(w,this.endpoints[1].getParameters()),Xe.extend(w,m.getParameters()),m.setParameters(w),this.getAttachedElements=function(){return m.endpoints},this.moveParent=function(e){var t=Xe.CurrentLibrary,i=t.getParent(m.connector.canvas);m.connector.bgCanvas&&(t.removeElement(m.connector.bgCanvas,i),t.appendElement(m.connector.bgCanvas,e)),t.removeElement(m.connector.canvas,i),t.appendElement(m.connector.canvas,e);for(var n=0;n<m.overlays.length;n++)m.overlays[n].isAppendedAtTopLevel&&(t.removeElement(m.overlays[n].canvas,i),t.appendElement(m.overlays[n].canvas,e),m.overlays[n].reattachListeners&&m.overlays[n].reattachListeners(m.connector));m.connector.reattachListeners&&m.connector.reattachListeners()};var C=null;this.paint=function(e){if(v){var t=(e=e||{}).elId,i=e.ui,n=e.recalc,o=e.timestamp,r=this.targetId;this.sourceId;if(null==o||o!=C){for(var a=B({elId:t,offset:i,recalc:n,timestamp:o}),s=B({elId:r,timestamp:o}),l=this.endpoints[0],c=this.endpoints[1],u=l.anchor.getCurrentLocation(l),d=c.anchor.getCurrentLocation(c),h=0,p=0;p<m.overlays.length;p++){(g=m.overlays[p]).isVisible()&&(h=Math.max(h,g.computeMaxSize()))}var f=this.connector.compute(u,d,this.endpoints[0],this.endpoints[1],this.endpoints[0].anchor,this.endpoints[1].anchor,m.paintStyleInUse.lineWidth,h,a,s);m.connector.paint(f,m.paintStyleInUse);for(p=0;p<m.overlays.length;p++){var g;(g=m.overlays[p]).isVisible&&(m.overlayPlacements[p]=g.draw(m.connector,m.paintStyleInUse,f))}}C=o}},this.repaint=function(e){var t=!(!1===(e=e||{}).recalc);this.paint({elId:this.sourceId,recalc:t,timestamp:e.timestamp})};var _=o.type||m.endpoints[0].connectionType||m.endpoints[1].connectionType;_&&m.addType(_)},Ne=function(l){var m=this;m.idPrefix="_jsplumb_e_",m.defaultLabelLocation=[.5,.5],m.defaultOverlayKeys=["Overlays","EndpointOverlays"],this.parent=l.parent,$e.apply(this,arguments),l=l||{},this.getTypeDescriptor=function(){return"endpoint"},this.getDefaultType=function(){return{parameters:{},scope:null,maxConnections:m._jsPlumb.Defaults.MaxConnections,paintStyle:m._jsPlumb.Defaults.EndpointStyle||Xe.Defaults.EndpointStyle,endpoint:m._jsPlumb.Defaults.Endpoint||Xe.Defaults.Endpoint,hoverPaintStyle:m._jsPlumb.Defaults.EndpointHoverStyle||Xe.Defaults.EndpointHoverStyle,overlays:m._jsPlumb.Defaults.EndpointOverlays||Xe.Defaults.EndpointOverlays,connectorStyle:l.connectorStyle,connectorHoverStyle:l.connectorHoverStyle,connectorClass:l.connectorClass,connectorHoverClass:l.connectorHoverClass,connectorOverlays:l.connectorOverlays,connector:l.connector,connectorTooltip:l.connectorTooltip}};var t=this.applyType;this.applyType=function(e){t(e),null!=e.maxConnections&&(h=e.maxConnections),e.scope&&(m.scope=e.scope),m.connectorStyle=e.connectorStyle,m.connectorHoverStyle=e.connectorHoverStyle,m.connectorOverlays=e.connectorOverlays,m.connector=e.connector,m.connectorTooltip=e.connectorTooltip,m.connectionType=e.connectionType,m.connectorClass=e.connectorClass,m.connectorHoverClass=e.connectorHoverClass};var r=!0,i=!(!1===l.enabled);this.isVisible=function(){return r},this.setVisible=function(e,t,i){if(r=e,m.canvas&&(m.canvas.style.display=e?"block":"none"),m[e?"showOverlays":"hideOverlays"](),!t)for(var n=0;n<m.connections.length;n++)if(m.connections[n].setVisible(e),!i){var o=m===m.connections[n].endpoints[0]?1:0;1==m.connections[n].endpoints[o].connections.length&&m.connections[n].endpoints[o].setVisible(e,!0,!0)}},this.isEnabled=function(){return i},this.setEnabled=function(e){i=e};var u=l.source,e=l.uuid,c=null,d=null;e&&(z[e]=m);var v=Fe(u,"id");this.elementId=v,this.element=u;var n=l.connectionCost;this.getConnectionCost=function(){return n};var o=!(this.setConnectionCost=function(e){n=e})!==l.connectionsBidirectional;this.areConnectionsBidirectional=function(){return o},this.setConnectionsBidirectional=function(e){o=e},m.anchor=l.anchor?R.makeAnchor(l.anchor,v,R):l.anchors?R.makeAnchor(l.anchors,v,R):R.makeAnchor(R.Defaults.Anchor||"TopCenter",v,R),l._transient||R.anchorManager.add(m,v);var y=null;this.setEndpoint=function(e){var t={_jsPlumb:m._jsPlumb,parent:l.parent,container:l.container,tooltip:l.tooltip,connectorTooltip:l.connectorTooltip,endpoint:m};y=Ue(e)?new Xe.Endpoints[Q][e](t):Ve(e)?(t=Xe.extend(e[1],t),new Xe.Endpoints[Q][e[0]](t)):e.clone();var i=Xe.extend({},t);y.clone=function(){var e=new Object;return y.constructor.apply(e,[i]),e},m.endpoint=y,m.type=m.endpoint.type},this.setEndpoint(l.endpoint||R.Defaults.Endpoint||Xe.Defaults.Endpoint||"Dot");var a=m.setHover;m.setHover=function(){m.endpoint.setHover.apply(m.endpoint,arguments),a.apply(m,arguments)};Be(m.endpoint,m,function(e){0<m.connections.length?m.connections[0].setHover(e,!1):m.setHover(e)}),this.setPaintStyle(l.paintStyle||l.style||R.Defaults.EndpointStyle||Xe.Defaults.EndpointStyle,!0),this.setHoverPaintStyle(l.hoverPaintStyle||R.Defaults.EndpointHoverStyle||Xe.Defaults.EndpointHoverStyle,!0),this.paintStyleInUse=this.getPaintStyle();var s=this.getPaintStyle();this.connectorStyle=l.connectorStyle,this.connectorHoverStyle=l.connectorHoverStyle,this.connectorOverlays=l.connectorOverlays,this.connector=l.connector,this.connectorTooltip=l.connectorTooltip,this.connectorClass=l.connectorClass,this.connectorHoverClass=l.connectorHoverClass,this.isSource=l.isSource||!1,this.isTarget=l.isTarget||!1;var h=l.maxConnections||R.Defaults.MaxConnections;this.getAttachedElements=function(){return m.connections},this.canvas=this.endpoint.canvas,this.connections=l.connections||[],this.scope=l.scope||q,this.connectionType=l.connectionType,this.timestamp=null,m.reattachConnections=l.reattach||R.Defaults.ReattachConnections,m.connectionsDetachable=R.Defaults.ConnectionsDetachable,!1!==l.connectionsDetachable&&!1!==l.detachable||(m.connectionsDetachable=!1);var p=l.dragAllowedWhenFull||!0;l.onMaxConnections&&m.bind("maxConnections",l.onMaxConnections),this.computeAnchor=function(e){return m.anchor.compute(e)},this.addConnection=function(e){m.connections.push(e)},this.detach=function(t,e,i,n,o){var r=je(m.connections,function(e){return e.id==t.id}),a=!1;if(n=!1!==n,0<=r&&(i||t._forceDetach||t.isDetachable()||t.isDetachAllowed(t))){var s=t.endpoints[0]==m?t.endpoints[1]:t.endpoints[0];if(i||t._forceDetach||m.isDetachAllowed(t)){if(m.connections.splice(r,1),!e&&(s.detach(t,!0,i),t.endpointsToDeleteOnDetach))for(var l=0;l<t.endpointsToDeleteOnDetach.length;l++){var c=t.endpointsToDeleteOnDetach[l];c&&0==c.connections.length&&R.deleteEndpoint(c)}$(t.connector.getDisplayElements(),t.parent),He(W[t.scope],function(e){return e.id==t.id}),a=!0,J(t,!e&&n,o)}}return a},this.detachAll=function(e,t){for(;0<m.connections.length;)m.detach(m.connections[0],!1,!0,e,t)},this.detachFrom=function(e,t,i){for(var n=[],o=0;o<m.connections.length;o++)m.connections[o].endpoints[1]!=e&&m.connections[o].endpoints[0]!=e||n.push(m.connections[o]);for(o=0;o<n.length;o++)m.detach(n[o],!1,!0,t,i)&&n[o].setHover(!1,!1)},this.detachFromConnection=function(t){var e=je(m.connections,function(e){return e.id==t.id});0<=e&&m.connections.splice(e,1)},this.getElement=function(){return u},this.setElement=function(e,t){var i=K(e);He(H[m.elementId],function(e){return e.id==m.id}),u=qe(e),v=K(u),m.elementId=v;var n=I({source:i,container:t}),o=_.getParent(m.canvas);_.removeElement(m.canvas,o),_.appendElement(m.canvas,n);for(var r=0;r<m.connections.length;r++)m.connections[r].moveParent(n),m.connections[r].sourceId=v,m.connections[r].source=u;O(H,i,m)},this.getUuid=function(){return e},this.makeInPlaceCopy=function(){var e=m.anchor.getCurrentLocation(m),t=m.anchor.getOrientation(m);return L({anchor:{compute:function(){return[e[0],e[1]]},getCurrentLocation:function(){return[e[0],e[1]]},getOrientation:function(){return t}},source:u,paintStyle:this.getPaintStyle(),endpoint:y,_transient:!0,scope:m.scope})},this.isConnectedTo=function(e){var t=!1;if(e)for(var i=0;i<m.connections.length;i++)if(m.connections[i].endpoints[1]==e){t=!0;break}return t},this.isFloating=function(){return null!=c},this.connectorSelector=function(){var e=m.connections[0];return m.isTarget&&e?e:m.connections.length<h||-1==h?null:e},this.isFull=function(){return!(m.isFloating()||h<1||m.connections.length<h)},this.setDragAllowedWhenFull=function(e){p=e},this.setStyle=m.setPaintStyle,this.equals=function(e){return this.anchor.equals(e.anchor)};if(this.paint=function(e){var t=(e=e||{}).timestamp,i=!(!1===e.recalc);if(!t||m.timestamp!==t){B({elId:v,timestamp:t,recalc:i});var n=e.offset||V[v];if(n){var o=e.anchorPoint,r=e.connectorPaintStyle;if(null==o){var a=e.dimensions||Y[v];null!=n&&null!=a||(B({elId:v,timestamp:t}),n=V[v],a=Y[v]);var s={xy:[n.left,n.top],wh:a,element:m,timestamp:t};if(i&&m.anchor.isDynamic&&0<m.connections.length){var l=function(e){var t=0;if(null!=e)for(var i=0;i<m.connections.length;i++)if(m.connections[i].sourceId==e||m.connections[i].targetId==e){t=i;break}return m.connections[t]}(e.elementWithPrecedence),c=l.endpoints[0]==m?1:0,u=0==c?l.sourceId:l.targetId,d=V[u],h=Y[u];s.txy=[d.left,d.top],s.twh=h,s.tElement=l.endpoints[c]}o=m.anchor.compute(s)}var p=y.compute(o,m.anchor.getOrientation(m),m.paintStyleInUse,r||m.paintStyleInUse);y.paint(p,m.paintStyleInUse,m.anchor),m.timestamp=t;for(var f=0;f<m.overlays.length;f++){var g=m.overlays[f];g.isVisible&&(m.overlayPlacements[f]=g.draw(m.endpoint,m.paintStyleInUse,p))}}}},this.repaint=this.paint,this.removeConnection=this.detach,Xe.CurrentLibrary.isDragSupported(u)){var f={id:null,element:null},g=null,b=!1,w=null,C=function(i){var n=!1;return{drag:function(){if(n)return!(n=!1);var e=Xe.CurrentLibrary.getUIPosition(arguments,R.getZoom()),t=i.element;t&&(Xe.CurrentLibrary.setOffset(t,e),F(qe(t),e))},stopDrag:function(){n=!0}}}(f),_=Xe.CurrentLibrary,A=l.dragOptions||{},E=Xe.extend({},_.defaultDragOptions),x=_.dragEvents.start,S=_.dragEvents.stop,T=_.dragEvents.drag;(A=Xe.extend(E,A)).scope=A.scope||m.scope,A[x]=X(A[x],function(){g=m.connectorSelector();var e=!0;if(m.isEnabled()||(e=!1),null!=g||l.isSource||(e=!1),l.isSource&&m.isFull()&&!p&&(e=!1),null==g||g.isDetachable()||(e=!1),!1===e)return Xe.CurrentLibrary.stopDrag&&Xe.CurrentLibrary.stopDrag(),C.stopDrag(),!1;g&&!m.isFull()&&l.isSource&&(g=null),B({elId:v}),(d=m.makeInPlaceCopy()).referenceEndpoint=m,d.paint(),function(e,t){var i=document.createElement("div");i.style.position="absolute";var n=qe(i);N(i,t);var o=K(n);B({elId:o}),e.id=o,e.element=n}(f,m.parent);var t=qe(d.canvas),i=Pe(t,R),n=me([i.left,i.top],d.canvas);if(Xe.CurrentLibrary.setOffset(f.element,{left:n[0],top:n[1]}),m.parentAnchor&&(m.anchor=R.makeAnchor(m.parentAnchor,m.elementId,R)),Me(qe(m.canvas),"dragId",f.id),Me(qe(m.canvas),"elId",v),l.proxy&&m.setPaintStyle(l.proxy.paintStyle),c=function(e,t,i,n,o){var r=new ve({reference:t,referenceCanvas:n});return L({paintStyle:e,endpoint:i,anchor:r,source:o,scope:"__floating"})}(m.getPaintStyle(),m.anchor,y,m.canvas,f.element),null==g)m.anchor.locked=!0,m.setHover(!1,!1),g=M({sourceEndpoint:m,targetEndpoint:c,source:m.endpointWillMoveTo||qe(u),target:f.element,anchors:[m.anchor,c.anchor],paintStyle:l.connectorStyle,hoverPaintStyle:l.connectorHoverStyle,connector:l.connector,overlays:l.connectorOverlays,type:m.connectionType,cssClass:m.connectorClass,hoverClass:m.connectorHoverClass});else{b=!0,g.setHover(!1),k(qe(d.canvas),!1,!0);var o=g.endpoints[0].id==m.id?0:1;g.floatingAnchorIndex=o,m.detachFromConnection(g);var r=qe(m.canvas),a=Xe.CurrentLibrary.getDragScope(r);Me(r,"originalScope",a);var s=Xe.CurrentLibrary.getDropScope(r);Xe.CurrentLibrary.setDragScope(r,s),0==o?(w=[g.source,g.sourceId,D,a],g.source=f.element,g.sourceId=f.id):(w=[g.target,g.targetId,D,a],g.target=f.element,g.targetId=f.id),g.endpoints[0==o?1:0].anchor.locked=!0,g.suspendedEndpoint=g.endpoints[o],g.suspendedEndpoint.setHover(!1),c.referenceEndpoint=g.suspendedEndpoint,g.endpoints[o]=c,function(e){R.fire("connectionDrag",e)}(g)}U[f.id]=g,c.addConnection(g),O(H,f.id,c),R.currentlyDragging=!0}),A[T]=X(A[T],C.drag),A[S]=X(A[S],function(){var e=_.getDropEvent(arguments);R.currentlyDragging=!1,He(H[f.id],function(e){return e.id==c.id}),$([f.element[0],c.canvas]),G(d.canvas),R.anchorManager.clearFor(f.id);var t=null==g.floatingAnchorIndex?1:g.floatingAnchorIndex;g.endpoints[0==t?1:0].anchor.locked=!1,m.setPaintStyle(s),g.endpoints[t]==c&&(b&&g.suspendedEndpoint?(0==t?(g.source=w[0],g.sourceId=w[1]):(g.target=w[0],g.targetId=w[1]),Xe.CurrentLibrary.setDragScope(w[2],w[3]),g.endpoints[t]=g.suspendedEndpoint,(g.isReattach()||g._forceReattach||g._forceDetach||!g.endpoints[0==t?1:0].detach(g,!1,!1,!0,e))&&(g.setHover(!1),g.floatingAnchorIndex=null,g.suspendedEndpoint.addConnection(g),R.repaint(w[1])),g._forceDetach=null,g._forceReattach=null):($(g.connector.getDisplayElements(),m.parent),m.detachFromConnection(g))),m.anchor.locked=!1,m.paint({recalc:!1}),function(e){R.fire("connectionDragStop",e)}(g),d=g=null,delete H[c.elementId],c.anchor=null,c=null,R.currentlyDragging=!1});var D=qe(m.canvas);Xe.CurrentLibrary.initDraggable(D,A,!0)}var k=function(e,t,i,c){if((l.isTarget||t)&&Xe.CurrentLibrary.isDropSupported(u)){var n=l.dropOptions||R.Defaults.DropOptions||Xe.Defaults.DropOptions;(n=Xe.extend({},n)).scope=n.scope||m.scope;var o=Xe.CurrentLibrary.dragEvents.drop,r=Xe.CurrentLibrary.dragEvents.over,a=Xe.CurrentLibrary.dragEvents.out;n[o]=X(n[o],function(){var o=Xe.CurrentLibrary.getDropEvent(arguments),e=qe(Xe.CurrentLibrary.getDragObject(arguments)),t=Fe(e,"dragId"),i=(Fe(e,"elId"),Fe(e,"originalScope")),r=U[t];if(r.suspendedEndpoint&&(r.suspendedEndpoint.id==m.id||m.referenceEndpoint&&r.suspendedEndpoint.id==m.referenceEndpoint.id))r._forceReattach=!0;else if(null!=r){var a=null==r.floatingAnchorIndex?1:r.floatingAnchorIndex;i&&Xe.CurrentLibrary.setDragScope(e,i);var n=null==c||c.isEnabled();if(m.isFull()&&m.fire("maxConnections",{endpoint:m,connection:r,maxConnections:h},o),!m.isFull()&&(0!=a||m.isSource)&&(1!=a||m.isTarget)&&n){var s=!0;r.suspendedEndpoint&&r.suspendedEndpoint.id!=m.id&&(0==a?(r.source=r.suspendedEndpoint.element,r.sourceId=r.suspendedEndpoint.elementId):(r.target=r.suspendedEndpoint.element,r.targetId=r.suspendedEndpoint.elementId),r.isDetachAllowed(r)&&r.endpoints[a].isDetachAllowed(r)&&r.suspendedEndpoint.isDetachAllowed(r)&&R.checkCondition("beforeDetach",r)||(s=!1)),0==a?(r.source=m.element,r.sourceId=m.elementId):(r.target=m.element,r.targetId=m.elementId);function l(){r.floatingAnchorIndex=null}(s=s&&m.isDropAllowed(r.sourceId,r.targetId,r.scope,r,m))?function(){r.endpoints[a].detachFromConnection(r),r.suspendedEndpoint&&r.suspendedEndpoint.detachFromConnection(r),(r.endpoints[a]=m).addConnection(r);var e=m.getParameters();for(var t in e)r.setParameter(t,e[t]);if(r.suspendedEndpoint){var i=r.suspendedEndpoint.getElement(),n=r.suspendedEndpoint.elementId;J({source:0==a?i:r.source,target:1==a?i:r.target,sourceId:0==a?n:r.sourceId,targetId:1==a?n:r.targetId,sourceEndpoint:0==a?r.suspendedEndpoint:r.endpoints[0],targetEndpoint:1==a?r.suspendedEndpoint:r.endpoints[1],connection:r},!0,o)}else e.draggable&&Xe.CurrentLibrary.initDraggable(m.element,A,!0);P(r,null,o),l()}():(r.suspendedEndpoint&&(r.endpoints[a]=r.suspendedEndpoint,r.setHover(!1),r._forceDetach=!0,0==a?(r.source=r.suspendedEndpoint.element,r.sourceId=r.suspendedEndpoint.elementId):(r.target=r.suspendedEndpoint.element,r.targetId=r.suspendedEndpoint.elementId),r.suspendedEndpoint.addConnection(r),r.endpoints[0].repaint(),r.repaint(),R.repaint(r.source.elementId),r._forceDetach=!1),l())}R.currentlyDragging=!1,delete U[t],r.suspendedEndpoint=null}}),n[r]=X(n[r],function(){var e=Xe.CurrentLibrary.getDragObject(arguments),t=Fe(qe(e),"dragId"),i=U[t];if(null!=i){var n=null==i.floatingAnchorIndex?1:i.floatingAnchorIndex;(m.isTarget&&0!=i.floatingAnchorIndex||i.suspendedEndpoint&&m.referenceEndpoint&&m.referenceEndpoint.id==i.suspendedEndpoint.id)&&i.endpoints[n].anchor.over(m.anchor)}}),n[a]=X(n[a],function(){var e=Xe.CurrentLibrary.getDragObject(arguments),t=Fe(qe(e),"dragId"),i=U[t];if(null!=i){var n=null==i.floatingAnchorIndex?1:i.floatingAnchorIndex;(m.isTarget&&0!=i.floatingAnchorIndex||i.suspendedEndpoint&&m.referenceEndpoint&&m.referenceEndpoint.id==i.suspendedEndpoint.id)&&i.endpoints[n].anchor.out()}}),Xe.CurrentLibrary.initDroppable(e,n,!0,i)}};return k(qe(m.canvas),!0,!(l._transient||m.anchor.isFloating),m),l.type&&m.addType(l.type),m}}var je=jsPlumbUtil.findWithFunction,We=jsPlumbUtil.indexOf,He=jsPlumbUtil.removeWithFunction,ze=(jsPlumbUtil.remove,jsPlumbUtil.addWithFunction),Ve=(jsPlumbUtil.addToList,jsPlumbUtil.isArray),Ue=jsPlumbUtil.isString,Ye=jsPlumbUtil.isObject,qe=function(e){return Xe.CurrentLibrary.getElementObject(e)},Qe=jsPlumbUtil.log,Ke=(jsPlumbUtil.group,jsPlumbUtil.groupEnd,jsPlumbUtil.time,jsPlumbUtil.timeEnd,0),Xe=new i;"undefined"!=typeof window&&(window.jsPlumb=Xe),Xe.getInstance=function(e){var t=new i(e);return t.init(),t},"function"==typeof define&&define.amd&&define.amd.jsPlumb&&define("jsplumb",[],function(){return Xe});function e(i,n,o,r,a,s){return function(e){var t=(e=e||{}).jsPlumbInstance.makeAnchor([i,n,o,r,0,0],e.elementId,e.jsPlumbInstance);return t.type=a,s&&s(t,e),t}}Xe.Anchors.TopCenter=e(.5,0,0,-1,"TopCenter"),Xe.Anchors.BottomCenter=e(.5,1,0,1,"BottomCenter"),Xe.Anchors.LeftMiddle=e(0,.5,-1,0,"LeftMiddle"),Xe.Anchors.RightMiddle=e(1,.5,1,0,"RightMiddle"),Xe.Anchors.Center=e(.5,.5,0,0,"Center"),Xe.Anchors.TopRight=e(1,0,0,-1,"TopRight"),Xe.Anchors.BottomRight=e(1,1,0,1,"BottomRight"),Xe.Anchors.TopLeft=e(0,0,0,-1,"TopLeft"),Xe.Anchors.BottomLeft=e(0,1,0,1,"BottomLeft"),Xe.Defaults.DynamicAnchors=function(e){return e.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],e.elementId,e.jsPlumbInstance)},Xe.Anchors.AutoDefault=function(e){var t=e.jsPlumbInstance.makeDynamicAnchor(Xe.Defaults.DynamicAnchors(e));return t.type="AutoDefault",t},Xe.Anchors.Assign=e(0,0,0,0,"Assign",function(e,t){var i=t.position||"Fixed";e.positionFinder=i.constructor==String?t.jsPlumbInstance.AnchorPositionFinders[i]:i,e.constructorParams=t}),Xe.Anchors.Continuous=function(e){return e.jsPlumbInstance.continuousAnchorFactory.get(e)},Xe.AnchorPositionFinders={Fixed:function(e,t,i,n){return[(e.left-t.left)/i[0],(e.top-t.top)/i[1]]},Grid:function(e,t,i,n){var o=e.left-t.left,r=e.top-t.top,a=i[0]/n.grid[0],s=i[1]/n.grid[1],l=Math.floor(o/a),c=Math.floor(r/s);return[(l*a+a/2)/i[0],(c*s+s/2)/i[1]]}},Xe.Anchors.Perimeter=function(e){var u=(e=e||{}).anchorCount||60,t=e.shape;if(!t)throw new Error("no shape supplied to Perimeter Anchor type");function i(){for(var e=2*Math.PI/u,t=0,i=[],n=0;n<u;n++){var o=.5+.5*Math.sin(t),r=.5+.5*Math.cos(t);i.push([o,r,0,0]),t+=e}return i}function a(e){function t(e,t,i,n,o){for(var r=(i-e)/(l=u*o),a=(n-t)/l,s=0;s<l;s++)c.push([e+r*s,t+a*s,0,0])}for(var l=u/e.length,c=[],i=0;i<e.length;i++)t.apply(null,e[i]);return c}function n(e){for(var t=[],i=0;i<e.length;i++)t.push([e[i][0],e[i][1],e[i][2],e[i][3],1/e.length]);return a(t)}function o(){return n([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])}var r={circle:i,ellipse:i,diamond:function(){return n([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},rectangle:o,square:o,triangle:function(){return n([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},path:function(e){for(var t=e.points,i=[],n=0,o=0;o<t.length-1;o++){var r=Math.sqrt(Math.pow(t[o][2]-t[o][0])+Math.pow(t[o][3]-t[o][1]));n+=r,i.push([t[o][0],t[o][1],t[o+1][0],t[o+1][1],r])}for(o=0;o<i.length;o++)i[o][4]=i[o][4]/n;return a(i)}};if(!r[t])throw new Error("Shape ["+t+"] is unknown by Perimeter Anchor type");var s=r[t](e);e.rotation&&(s=function(e,t){for(var i=[],n=t/180*Math.PI,o=0;o<e.length;o++){var r=e[o][0]-.5,a=e[o][1]-.5;i.push([r*Math.cos(n)-a*Math.sin(n)+.5,r*Math.sin(n)+a*Math.cos(n)+.5,e[o][2],e[o][3]])}return i}(s,e.rotation));var l=e.jsPlumbInstance.makeDynamicAnchor(s);return l.type="Perimeter",l}}(),function(){jsPlumb.DOMElementComponent=function(e){jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.mousemove=this.dblclick=this.click=this.mousedown=this.mouseup=function(e){}},jsPlumb.Connectors.Straight=function(){this.type="Straight";var g,m,v,y,b,w,C,_,A,r=this,E=null;this.compute=function(e,t,i,n,o,r,a,s){var l=Math.abs(e[0]-t[0]),c=Math.abs(e[1]-t[1]),u=.45*l,d=.45*c;l*=1.9,c*=1.9;var h=Math.min(e[0],t[0])-u,p=Math.min(e[1],t[1])-d,f=Math.max(2*a,s);return l<f&&(l=f,h=e[0]+(t[0]-e[0])/2-f/2,u=(l-Math.abs(e[0]-t[0]))/2),c<f&&(c=f,p=e[1]+(t[1]-e[1])/2-f/2,d=(c-Math.abs(e[1]-t[1]))/2),b=e[0]<t[0]?u:l-u,w=e[1]<t[1]?d:c-d,C=e[0]<t[0]?l-u:u,_=e[1]<t[1]?c-d:d,E=[h,p,l,c,b,w,C,_],v=C-b,y=_-w,g=jsPlumbUtil.gradient({x:b,y:w},{x:C,y:_}),m=-1/g,-1*(g*b-w),Math.atan(g),Math.atan(m),A=Math.sqrt(v*v+y*y),E},this.pointOnPath=function(e,t){if(0!=e||t){if(1!=e||t){var i=t?0<e?e:A+e:e*A;return jsPlumbUtil.pointOnLine({x:b,y:w},{x:C,y:_},i)}return{x:C,y:_}}return{x:b,y:w}},this.gradientAtPoint=function(e){return g},this.pointAlongPathFrom=function(e,t,i){var n=r.pointOnPath(e,i),o=1==e?{x:b+10*(C-b),y:w+10*(w-_)}:t<=0?{x:b,y:w}:{x:C,y:_};return t<=0&&1<Math.abs(t)&&(t*=-1),jsPlumbUtil.pointOnLine(n,o,t)}},jsPlumb.Connectors.Bezier=function(e){var A=this;e=e||{},this.majorAnchor=e.curviness||150,this.minorAnchor=10;var E,x,S,T,D,k,R,O,N,F;this.type="Bezier",this._findControlPoint=function(e,t,i,n,o,r,a){var s=r.getOrientation(n),l=a.getOrientation(o),c=s[0]!=l[0]||s[1]==l[1],u=[],d=A.majorAnchor,h=A.minorAnchor;return c?(0==l[0]?u.push(i[0]<t[0]?e[0]+h:e[0]-h):u.push(e[0]+d*l[0]),0==l[1]?u.push(i[1]<t[1]?e[1]+h:e[1]-h):u.push(e[1]+d*s[1])):(0==s[0]?u.push(t[0]<i[0]?e[0]+h:e[0]-h):u.push(e[0]-d*s[0]),0==s[1]?u.push(t[1]<i[1]?e[1]+h:e[1]-h):u.push(e[1]+d*l[1])),u},this.compute=function(e,t,i,n,o,r,a,s){a=Math.max(s,a||0),N=Math.abs(e[0]-t[0])+a,F=Math.abs(e[1]-t[1])+a,R=Math.min(e[0],t[0])-a/2,O=Math.min(e[1],t[1])-a/2,D=e[0]<t[0]?N-a/2:a/2,k=e[1]<t[1]?F-a/2:a/2,S=e[0]<t[0]?a/2:N-a/2,T=e[1]<t[1]?a/2:F-a/2,E=A._findControlPoint([D,k],e,t,i,n,o,r),x=A._findControlPoint([S,T],t,e,n,i,r,o);var l=Math.min(D,S),c=Math.min(E[0],x[0]),u=Math.min(l,c),d=Math.max(D,S),h=Math.max(E[0],x[0]),p=Math.max(d,h);if(N<p&&(N=p),u<0){R+=u;var f=Math.abs(u);N+=f,E[0]+=f,D+=f,S+=f,x[0]+=f}var g=Math.min(k,T),m=Math.min(E[1],x[1]),v=Math.min(g,m),y=Math.max(k,T),b=Math.max(E[1],x[1]),w=Math.max(y,b);if(F<w&&(F=w),v<0){O+=v;var C=Math.abs(v);F+=C,E[1]+=C,k+=C,T+=C,x[1]+=C}if(s&&N<s){var _=(s-N)/2;N=s,R-=_,D+=_,S+=_,E[0]=E[0]+_,x[0]=x[0]+_}if(s&&F<s){_=(s-F)/2;F=s,O-=_,k+=_,T+=_,E[1]=E[1]+_,x[1]=x[1]+_}return[R,O,N,F,D,k,S,T,E[0],E[1],x[0],x[1]]};function o(){return[{x:D,y:k},{x:E[0],y:E[1]},{x:x[0],y:x[1]},{x:S,y:T}]}function r(e,t,i){return i&&(t=jsBezier.locationAlongCurveFrom(e,0<t?0:1,t)),t}this.pointOnPath=function(e,t){var i=o();return e=r(i,e,t),jsBezier.pointOnCurve(i,e)},this.gradientAtPoint=function(e,t){var i=o();return e=r(i,e,t),jsBezier.gradientAtPoint(i,e)},this.pointAlongPathFrom=function(e,t,i){var n=o();return e=r(n,e,i),jsBezier.pointAlongCurveFrom(n,e,t)}},jsPlumb.Connectors.Flowchart=function(e){this.type="Flowchart";function H(e,t,i,n,o,r){var a=0==X.length?i:X[X.length-1][0],s=0==X.length?n:X[X.length-1][1],l=e==a?1/0:0,c=Math.abs(e==a?t-s:e-a);X.push([e,t,a,s,l,c]),J+=c,ie=Math.max(ie,e),ne=Math.max(ne,t),oe=Math.min(oe,e),re=Math.min(re,t)}function l(e,t){t&&(e=0<e?e/J:(J+e)/J);for(var i=Z.length-1,n=1,o=0;o<Z.length;o++)if(Z[o][1]>=e){n=(e-Z[i=o][0])/ee[o];break}return{segment:X[i],proportion:n,index:i}}var z,V,U=this,t=(e=e||{}).stub||e.minStubLength||30,Y=jsPlumbUtil.isArray(t)?t[0]:t,q=jsPlumbUtil.isArray(t)?t[1]:t,Q=e.gap||0,K=e.midpoint||.5,X=[],J=0,Z=[],ee=[],te=[],ie=-1/0,ne=-1/0,oe=1/0,re=1/0;e.grid;this.compute=function(e,t,i,n,o,r,a,s,l,c){X=[],Z=[],ee=[],ie=ne=-1/(J=0),oe=re=1/0,U.lineWidth=a,z=t[0]<e[0],V=t[1]<e[1];var u=a||1,d=u/2+(Y+q),h=u/2+(q+Y),p=u/2+(Y+q),f=u/2+(q+Y),g=o.orientation||o.getOrientation(i),m=r.orientation||r.getOrientation(n),v=z?t[0]:e[0],y=V?t[1]:e[1],b=Math.abs(t[0]-e[0])+d+h,w=Math.abs(t[1]-e[1])+p+f;if(0==g[0]&&0==g[1]||0==m[0]&&0==m[1]){var C=w<b?0:1,_=[1,0][C];m=[],(g=[])[C]=e[C]>t[C]?-1:1,m[C]=e[C]>t[C]?1:-1,g[_]=0,m[_]=0}var A=z?b-h+Q*g[0]:d+Q*g[0],E=V?w-f+Q*g[1]:p+Q*g[1],x=z?d+Q*m[0]:b-h+Q*m[0],S=V?p+Q*m[1]:w-f+Q*m[1],T=A+g[0]*Y,D=E+g[1]*Y,k=x+m[0]*q,R=S+m[1]*q,O=Math.abs(A-x)>Y+q,N=Math.abs(E-S)>Y+q,F=T+(k-T)*K,M=D+(R-D)*K,P=g[0]*m[0]+g[1]*m[1],I=-1==P,L=1==P;te=[v-=d,y-=p,b,w,A,E,x,S];var G=0==g[0]?"y":"x",$=I?"opposite":L?"orthogonal":"perpendicular",B=jsPlumbUtil.segment([A,E],[x,S]);-1==g["x"==G?0:1]&&(B={x:[null,4,3,2,1],y:[null,2,1,4,3]}[G][B]),H(T,D,A,E);var j={oppositex:function(){if(i.elementId!=n.elementId)return!O||1!=B&&2!=B?[[T,M],[k,M]]:[[F,E],[F,S]];var e=D+(1-o.y)*l.height+Math.max(Y,q);return[[T,e],[k,e]]},orthogonalx:function(){return 1==B||2==B?[[k,D]]:[[T,R]]},perpendicularx:function(){var e=(S+E)/2;return 1==B&&1==m[1]||2==B&&-1==m[1]?Math.abs(x-A)>Math.max(Y,q)?[[k,D]]:[[T,D],[T,e],[k,e]]:3==B&&-1==m[1]||4==B&&1==m[1]?[[T,e],[k,e]]:3==B&&1==m[1]||4==B&&-1==m[1]?[[T,R]]:1==B&&-1==m[1]||2==B&&1==m[1]?Math.abs(x-A)>Math.max(Y,q)?[[F,D],[F,R]]:[[T,R]]:void 0},oppositey:function(){if(i.elementId!=n.elementId)return!N||2!=B&&3!=B?[[F,D],[F,R]]:[[A,M],[x,M]];var e=T+(1-o.x)*l.width+Math.max(Y,q);return[[e,D],[e,R]]},orthogonaly:function(){return 2==B||3==B?[[T,R]]:[[k,D]]},perpendiculary:function(){var e=(x+A)/2;return 2==B&&-1==m[0]||3==B&&1==m[0]?Math.abs(x-A)>Math.max(Y,q)?[[T,R]]:[[T,M],[k,M]]:1==B&&-1==m[0]||4==B&&1==m[0]?[[e=(x+A)/2,D],[e,R]]:1==B&&1==m[0]||4==B&&-1==m[0]?[[k,D]]:2==B&&1==m[0]||3==B&&-1==m[0]?Math.abs(S-E)>Math.max(Y,q)?[[T,M],[k,M]]:[[k,D]]:void 0}}[$+G]();if(j)for(var W=0;W<j.length;W++)H(j[W][0],j[W][1],A,E);return H(k,R,A,E),H(x,S,A,E),function(){te.push(X.length);for(var e=0;e<X.length;e++)te.push(X[e][0]),te.push(X[e][1])}(),function(){for(var e=0,t=0;t<X.length;t++)ee[t]=X[t][5]/J,Z[t]=[e,e+=X[t][5]/J]}(),ne>te[3]&&(te[3]=ne+2*a),ie>te[2]&&(te[2]=ie+2*a),te},this.pointOnPath=function(e,t){return U.pointAlongPathFrom(e,0,t)},this.gradientAtPoint=function(e,t){return X[l(e,t).index][4]},this.pointAlongPathFrom=function(e,t,i){var n=l(e,i),o=n.segment,r=n.proportion,a=X[n.index][5],s=X[n.index][4];return{x:s==1/0?o[2]:o[2]>o[0]?o[0]+(1-r)*a-t:o[2]+r*a+t,y:0==s?o[3]:o[3]>o[1]?o[1]+(1-r)*a-t:o[3]+r*a+t,segmentInfo:n}}},jsPlumb.Endpoints.Dot=function(e){this.type="Dot";var r=this;e=e||{},this.radius=e.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this.compute=function(e,t,i,n){var o=i.radius||r.radius;return[e[0]-o,e[1]-o,2*o,2*o,o]}},jsPlumb.Endpoints.Rectangle=function(e){this.type="Rectangle";var a=this;e=e||{},this.width=e.width||20,this.height=e.height||20,this.compute=function(e,t,i,n){var o=i.width||a.width,r=i.height||a.height;return[e[0]-o/2,e[1]-r/2,o,r]}};function c(e){jsPlumb.DOMElementComponent.apply(this,arguments);var t=[];this.getDisplayElements=function(){return t},this.appendDisplayElement=function(e){t.push(e)}}jsPlumb.Endpoints.Image=function(e){this.type="Image",c.apply(this,arguments);var o=this,n=!1,r=!1,a=e.width,s=e.height,i=null,t=e.endpoint;this.img=new Image,o.ready=!1,this.img.onload=function(){o.ready=!0,a=a||o.img.width,s=s||o.img.height,i&&i(o)},t.setImage=function(e,t){e.constructor==String||e.src;i=t,o.img.src=e,null!=o.canvas&&o.canvas.setAttribute("src",e)},t.setImage(e.src||e.url,e.onload),this.compute=function(e,t,i,n){return o.anchorPoint=e,o.ready?[e[0]-a/2,e[1]-s/2,a,s]:[0,0,0,0]},o.canvas=document.createElement("img"),n=!1,o.canvas.style.margin=0,o.canvas.style.padding=0,o.canvas.style.outline=0,o.canvas.style.position="absolute";var l=e.cssClass?" "+e.cssClass:"";o.canvas.className=jsPlumb.endpointClass+l,a&&o.canvas.setAttribute("width",a),s&&o.canvas.setAttribute("height",s),jsPlumb.appendElement(o.canvas,e.parent),o.attachListeners(o.canvas,o),o.cleanup=function(){r=!0};this.paint=function(e,t,i){o.ready?function(){if(!r){n||(o.canvas.setAttribute("src",o.img.src),o.appendDisplayElement(o.canvas),n=!0);var e=o.anchorPoint[0]-a/2,t=o.anchorPoint[1]-s/2;jsPlumb.sizeCanvas(o.canvas,e,t,a,s)}}():window.setTimeout(function(){o.paint(e,t,i)},200)}},jsPlumb.Endpoints.Blank=function(e){var n=this;this.type="Blank",c.apply(this,arguments),this.compute=function(e,t,i,n){return[e[0],e[1],10,0]},n.canvas=document.createElement("div"),n.canvas.style.display="block",n.canvas.style.width="1px",n.canvas.style.height="1px",n.canvas.style.background="transparent",n.canvas.style.position="absolute",n.canvas.className=n._jsPlumb.endpointClass,jsPlumb.appendElement(n.canvas,e.parent),this.paint=function(e,t,i){jsPlumb.sizeCanvas(n.canvas,e[0],e[1],e[2],e[3])}},jsPlumb.Endpoints.Triangle=function(e){this.type="Triangle",(e=e||{}).width=e.width||55,e.height=e.height||55,this.width=e.width,this.height=e.height,this.compute=function(e,t,i,n){var o=i.width||self.width,r=i.height||self.height;return[e[0]-o/2,e[1]-r/2,o,r]}};function a(e){var t=!0,i=this;this.isAppendedAtTopLevel=!0,this.component=e.component,this.loc=null==e.location?.5:e.location,this.endpointLoc=null==e.endpointLocation?[.5,.5]:e.endpointLocation,this.setVisible=function(e){t=e,i.component.repaint()},this.isVisible=function(){return t},this.hide=function(){i.setVisible(!1)},this.show=function(){i.setVisible(!0)},this.incrementLocation=function(e){i.loc+=e,i.component.repaint()},this.setLocation=function(e){i.loc=e,i.component.repaint()},this.getLocation=function(){return i.loc}}jsPlumb.Overlays.Arrow=function(e){this.type="Arrow",a.apply(this,arguments),this.isAppendedAtTopLevel=!1,e=e||{};var y=this;this.length=e.length||20,this.width=e.width||20,this.id=e.id;var b=(e.direction||1)<0?-1:1,w=e.paintStyle||{lineWidth:1},C=e.foldback||.623;this.computeMaxSize=function(){return 1.5*y.width},this.cleanup=function(){},this.draw=function(e,t,i){var n,o,r,a,s;if(e.pointAlongPathFrom){if(jsPlumbUtil.isString(y.loc)||1<y.loc||y.loc<0){var l=parseInt(y.loc);n=e.pointAlongPathFrom(l,b*y.length/2,!0),o=e.pointOnPath(l,!0),r=jsPlumbUtil.pointOnLine(n,o,y.length)}else if(1==y.loc){if(n=e.pointOnPath(y.loc),o=e.pointAlongPathFrom(y.loc,-1),r=jsPlumbUtil.pointOnLine(n,o,y.length),-1==b){var c=r;r=n,n=c}}else if(0==y.loc){if(r=e.pointOnPath(y.loc),o=e.pointAlongPathFrom(y.loc,1),n=jsPlumbUtil.pointOnLine(r,o,y.length),-1==b){c=r;r=n,n=c}}else n=e.pointAlongPathFrom(y.loc,b*y.length/2),o=e.pointOnPath(y.loc),r=jsPlumbUtil.pointOnLine(n,o,y.length);a=jsPlumbUtil.perpendicularLineTo(n,r,y.width),s=jsPlumbUtil.pointOnLine(n,r,C*y.length);var u=Math.min(n.x,a[0].x,a[1].x),d=Math.max(n.x,a[0].x,a[1].x),h=Math.min(n.y,a[0].y,a[1].y),p=Math.max(n.y,a[0].y,a[1].y),f={hxy:n,tail:a,cxy:s},g=w.strokeStyle||t.strokeStyle,m=w.fillStyle||t.strokeStyle,v=w.lineWidth||t.lineWidth;return y.paint(e,f,v,g,m,i),[u,d,h,p]}return[0,0,0,0]}},jsPlumb.Overlays.PlainArrow=function(e){e=e||{};var t=jsPlumb.extend(e,{foldback:1});jsPlumb.Overlays.Arrow.call(this,t),this.type="PlainArrow"},jsPlumb.Overlays.Diamond=function(e){var t=(e=e||{}).length||40,i=jsPlumb.extend(e,{length:t/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,i),this.type="Diamond"};function t(t){jsPlumb.DOMElementComponent.apply(this,arguments),a.apply(this,arguments);var n,l=this,o=!1;function c(e){return null==i&&(i=l.getDimensions()),i}t=t||{},this.id=t.id,this.getElement=function(){return null==n&&function(){n=t.create(t.component),(n=jsPlumb.CurrentLibrary.getDOMElement(n)).style.position="absolute";var e=t._jsPlumb.overlayClass+" "+(l.cssClass?l.cssClass:t.cssClass?t.cssClass:"");n.className=e,jsPlumb.appendElement(n,t.component.parent),t._jsPlumb.getId(n),l.attachListeners(n,l),l.canvas=n}(),n},this.getDimensions=function(){return jsPlumb.CurrentLibrary.getSize(jsPlumb.CurrentLibrary.getElementObject(l.getElement()))};var i=null;this.clearCachedDimensions=function(){i=null},this.computeMaxSize=function(){var e=c();return Math.max(e[0],e[1])};var r=l.setVisible;l.setVisible=function(e){r(e),n.style.display=e?"block":"none"},this.cleanup=function(){null!=n&&jsPlumb.CurrentLibrary.removeElement(n)},this.paint=function(e,t,i){o||(l.getElement(),e.appendDisplayElement(n),l.attachListeners(n,e),o=!0),n.style.left=i[0]+t.minx+"px",n.style.top=i[1]+t.miny+"px"},this.draw=function(e,t,i){var n=c();if(null==n||2!=n.length)return[0,0,0,0];var o={x:0,y:0};if(e.pointOnPath){var r=l.loc,a=!1;(jsPlumbUtil.isString(l.loc)||l.loc<0||1<l.loc)&&(r=parseInt(l.loc),a=!0),o=e.pointOnPath(r,a)}else{var s=l.loc.constructor==Array?l.loc:l.endpointLoc;o={x:s[0]*i[2],y:s[1]*i[3]}}return minx=o.x-n[0]/2,miny=o.y-n[1]/2,l.paint(e,{minx:minx,miny:miny,td:n,cxy:o},i),[minx,minx+n[0],miny,miny+n[1]]},this.reattachListeners=function(e){n&&l.reattachListenersForElement(n,l,e)}}jsPlumb.Overlays.Custom=function(e){this.type="Custom",t.apply(this,arguments)},jsPlumb.Overlays.Label=function(e){this.labelStyle=e.labelStyle||jsPlumb.Defaults.LabelStyle,this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null,e.create=function(){return document.createElement("div")},jsPlumb.Overlays.Custom.apply(this,arguments),this.type="Label";var t=e.label||"",i=this,n=null;this.setLabel=function(e){t=e,n=null,i.clearCachedDimensions(),o(),i.component.repaint()};var o=function(){if("function"==typeof t){var e=t(i);i.getElement().innerHTML=e.replace(/\r\n/g,"<br/>")}else null==n&&(n=t,i.getElement().innerHTML=n.replace(/\r\n/g,"<br/>"))};this.getLabel=function(){return t};var r=this.getDimensions;this.getDimensions=function(){return o(),r()}}}(),jsPlumb.Connectors.StateMachine=function(e){var k,R,O,N,F=null,M=[],P=e.curviness||10,I=e.margin||5,L=e.proximityLimit||80,G=e.orientation&&"clockwise"==e.orientation,$=e.loopbackRadius||25,B=!1,j=!1!==e.showLoopback;function a(){return[{x:O,y:N},{x:M[0],y:M[1]},{x:M[0]+1,y:M[1]+1},{x:k,y:R}]}function s(e,t,i){return i&&(t=jsBezier.locationAlongCurveFrom(e,0<t?0:1,t)),t}this.type="StateMachine",e=e||{},this.compute=function(e,t,i,n,o,r,a,s){var l=Math.abs(e[0]-t[0]),c=Math.abs(e[1]-t[1]),u=.45*l,d=.45*c;l*=1.9,c*=1.9,a=a||1;var h=Math.min(e[0],t[0])-u,p=Math.min(e[1],t[1])-d;if(j&&i.elementId==n.elementId){B=!0;var f=e[0],g=e[0],m=e[1]-I,v=e[1]-I,y=m-$;F=[h=f-$-a-$,p=y-$-a-$,l=2*a+4*$,c=2*a+4*$,f-h,y-p,$,G,f-h,m-p,g-h,v-p]}else{B=!1,k=e[0]<t[0]?u:l-u,R=e[1]<t[1]?d:c-d,O=e[0]<t[0]?l-u:u,N=e[1]<t[1]?c-d:d,0==e[2]&&(k-=I),1==e[2]&&(k+=I),0==e[3]&&(R-=I),1==e[3]&&(R+=I),0==t[2]&&(O-=I),1==t[2]&&(O+=I),0==t[3]&&(N-=I),1==t[3]&&(N+=I);var b=(k+O)/2,w=(R+N)/2,C=-1*b/w,_=Math.atan(C),A=(C==1/0||C==-1/0||Math.abs(P/2*Math.sin(_)),C==1/0||C==-1/0||Math.abs(P/2*Math.cos(_)),function(e,t,i,n){return e<=i&&n<=t?1:e<=i&&t<=n?2:i<=e&&t<=n?3:4}(k,R,O,N)),E=Math.sqrt(Math.pow(O-k,2)+Math.pow(N-R,2));M=function(e,t,i,n,o,r,a,s,l){return s<=l?[e,t]:1==i?n[3]<=0&&1<=o[3]?[e+(n[2]<.5?-1*r:r),t]:1<=n[2]&&o[2]<=0?[e,t+(n[3]<.5?-1*a:a)]:[e+-1*r,t+-1*a]:2==i?1<=n[3]&&o[3]<=0?[e+(n[2]<.5?-1*r:r),t]:1<=n[2]&&o[2]<=0?[e,t+(n[3]<.5?-1*a:a)]:[e+1*r,t+-1*a]:3==i?1<=n[3]&&o[3]<=0?[e+(n[2]<.5?-1*r:r),t]:n[2]<=0&&1<=o[2]?[e,t+(n[3]<.5?-1*a:a)]:[e+-1*r,t+-1*a]:4==i?n[3]<=0&&1<=o[3]?[e+(n[2]<.5?-1*r:r),t]:n[2]<=0&&1<=o[2]?[e,t+(n[3]<.5?-1*a:a)]:[e+1*r,t+-1*a]:void 0}(b,w,A,e,t,P,P,E,L);var x=Math.max(3*Math.abs(M[0]-k),3*Math.abs(M[0]-O),Math.abs(O-k),2*a,s),S=Math.max(3*Math.abs(M[1]-R),3*Math.abs(M[1]-N),Math.abs(N-R),2*a,s);if(l<x){var T=x-l;h-=T/2,k+=T/2,O+=T/2,l=x,M[0]+=T/2}if(c<S){var D=S-c;p-=D/2,R+=D/2,N+=D/2,c=S,M[1]+=D/2}F=[h,p,l,c,k,R,O,N,M[0],M[1]]}return F},this.pointOnPath=function(e,t){if(B){t&&(e/=2*Math.PI*$),0<e&&e<1&&(e=1-e);var i=2*e*Math.PI+Math.PI/2;return{x:F[4]+F[6]*Math.cos(i),y:F[5]+F[6]*Math.sin(i)}}var n=a();return e=s(n,e,t),jsBezier.pointOnCurve(n,e)},this.gradientAtPoint=function(e,t){if(B)return t&&(e/=2*Math.PI*$),Math.atan(2*e*Math.PI);var i=a();return e=s(i,e,t),jsBezier.gradientAtPoint(i,e)},this.pointAlongPathFrom=function(e,t,i){if(B){i&&(e/=2*Math.PI*$),0<e&&e<1&&(e=1-e);var n=t/(2*Math.PI*F[6])*2*Math.PI,o=2*e*Math.PI-n+Math.PI/2;return{x:F[4]+F[6]*Math.cos(o),y:F[5]+F[6]*Math.sin(o)}}var r=a();return e=s(r,e,i),jsBezier.pointAlongCurveFrom(r,e,t)}},jsPlumb.Connectors.canvas.StateMachine=function(e){var n=this;e=e||{},jsPlumb.Connectors.StateMachine.apply(this,arguments),jsPlumb.CanvasConnector.apply(this,arguments),this._paint=function(e){if(10==e.length)n.ctx.beginPath(),n.ctx.moveTo(e[4],e[5]),n.ctx.bezierCurveTo(e[8],e[9],e[8],e[9],e[6],e[7]),n.ctx.stroke();else{n.ctx.save(),n.ctx.beginPath();var t=2*Math.PI,i=e[7];n.ctx.arc(e[4],e[5],e[6],0,t,i),n.ctx.stroke(),n.ctx.closePath(),n.ctx.restore()}},this.createGradient=function(e,t){return t.createLinearGradient(e[4],e[5],e[6],e[7])}},jsPlumb.Connectors.svg.StateMachine=function(){jsPlumb.Connectors.StateMachine.apply(this,arguments),jsPlumb.SvgConnector.apply(this,arguments),this.getPath=function(e){return 10==e.length?"M "+e[4]+" "+e[5]+" C "+e[8]+" "+e[9]+" "+e[8]+" "+e[9]+" "+e[6]+" "+e[7]:"M"+(e[8]+4)+" "+e[9]+" A "+e[6]+" "+e[6]+" 0 1,0 "+(e[8]-4)+" "+e[9]}},jsPlumb.Connectors.vml.StateMachine=function(){jsPlumb.Connectors.StateMachine.apply(this,arguments),jsPlumb.VmlConnector.apply(this,arguments);var n=jsPlumb.vml.convertValue;this.getPath=function(e){if(10==e.length)return"m"+n(e[4])+","+n(e[5])+" c"+n(e[8])+","+n(e[9])+","+n(e[8])+","+n(e[9])+","+n(e[6])+","+n(e[7])+" e";var t=n(e[8]-e[6]),i=n(e[9]-2*e[6]);return"ar "+t+","+i+","+(t+n(2*e[6]))+","+(i+n(2*e[6]))+","+n(e[8])+","+n(e[9])+","+n(e[8])+","+n(e[9])+" e"}},function(){var d={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},e=null;if(document.createStyleSheet&&document.namespaces){var t=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"];e=document.createStyleSheet();for(var i=0;i<t.length;i++)e.addRule(t[i],"behavior:url(#default#VML);position:absolute;");document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};function p(e,t){for(var i in t)e[i]=t[i]}function h(e,t,i,n){"transparent"===t?n.setOpacity(i,"0.0"):n.setOpacity(i,"1.0")}function f(e,t,i,n){var o={};if(t.strokeStyle){o.stroked="true";var r=jsPlumbUtil.convertStyle(t.strokeStyle,!0);o.strokecolor=r,h(0,r,"stroke",i),o.strokeweight=t.lineWidth+"px"}else o.stroked="false";if(t.fillStyle){o.filled="true";var a=jsPlumbUtil.convertStyle(t.fillStyle,!0);o.fillcolor=a,h(0,a,"fill",i)}else o.filled="false";if(t.dashstyle)null==i.strokeNode?i.strokeNode=g("stroke",[0,0,0,0],{dashstyle:t.dashstyle},e,n):i.strokeNode.dashstyle=t.dashstyle;else if(t["stroke-dasharray"]&&t.lineWidth){for(var s=-1==t["stroke-dasharray"].indexOf(",")?" ":",",l=t["stroke-dasharray"].split(s),c="",u=0;u<l.length;u++)c+=Math.floor(l[u]/t.lineWidth)+s;null==i.strokeNode?i.strokeNode=g("stroke",[0,0,0,0],{dashstyle:c},e,n):i.strokeNode.dashstyle=c}p(e,o)}function n(){var n=this;jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.opacityNodes={stroke:null,fill:null},this.initOpacityNodes=function(e){n.opacityNodes.stroke=g("stroke",[0,0,1,1],{opacity:"0.0"},e,n._jsPlumb),n.opacityNodes.fill=g("fill",[0,0,1,1],{opacity:"0.0"},e,n._jsPlumb)},this.setOpacity=function(e,t){var i=n.opacityNodes[e];i&&(i.opacity=""+t)};var i=[];this.getDisplayElements=function(){return i},this.appendDisplayElement=function(e,t){t||n.canvas.parentNode.appendChild(e),i.push(e)}}var g=function(e,t,i,n,o,r){i=i||{};var a=document.createElement("jsplumb:"+e);return r?o.appendElement(a,n):jsPlumb.CurrentLibrary.appendElement(a,n),a.className=(i.class?i.class+" ":"")+"jsplumb_vml",m(a,t),p(a,i),a},m=function(e,t,i){e.style.left=t[0]+"px",e.style.top=t[1]+"px",e.style.width=t[2]+"px",e.style.height=t[3]+"px",e.style.position="absolute",i&&(e.style.zIndex=i)},v=jsPlumb.vml.convertValue=function(e){return Math.floor(1e3*e)},o=jsPlumb.VmlConnector=function(l){var c=this;c.strokeNode=null,c.canvas=null,n.apply(this,arguments);var u=c._jsPlumb.connectorClass+(l.cssClass?" "+l.cssClass:"");this.paint=function(e,t,i){if(null!=t){var n={path:c.getPath(e)};if(t.outlineColor){var o=t.outlineWidth||1,r=t.lineWidth+2*o,a={strokeStyle:jsPlumbUtil.convertStyle(t.outlineColor),lineWidth:r};for(var s in d)a[s]=t[s];null==c.bgCanvas?(n.class=u,n.coordsize=1e3*e[2]+","+1e3*e[3],c.bgCanvas=g("shape",e,n,l.parent,c._jsPlumb,!0),m(c.bgCanvas,e,c.getZIndex()),c.appendDisplayElement(c.bgCanvas,!0),c.attachListeners(c.bgCanvas,c),c.initOpacityNodes(c.bgCanvas,["stroke"])):(n.coordsize=1e3*e[2]+","+1e3*e[3],m(c.bgCanvas,e,c.getZIndex()),p(c.bgCanvas,n)),f(c.bgCanvas,a,c)}null==c.canvas?(n.class=u,n.coordsize=1e3*e[2]+","+1e3*e[3],c.tooltip&&(n.label=c.tooltip),c.canvas=g("shape",e,n,l.parent,c._jsPlumb,!0),c.appendDisplayElement(c.canvas,!0),c.attachListeners(c.canvas,c),c.initOpacityNodes(c.canvas,["stroke"])):(n.coordsize=1e3*e[2]+","+1e3*e[3],m(c.canvas,e,c.getZIndex()),p(c.canvas,n)),f(c.canvas,t,c,c._jsPlumb)}},this.reattachListeners=function(){c.canvas&&c.reattachListenersForElement(c.canvas,c)}},r=window.VmlEndpoint=function(e){n.apply(this,arguments);var o=null,r=this;r.canvas=document.createElement("div"),r.canvas.style.position="absolute";var a=r._jsPlumb.endpointClass+(e.cssClass?" "+e.cssClass:"");e._jsPlumb.appendElement(r.canvas,e.parent),r.tooltip&&r.canvas.setAttribute("label",r.tooltip),this.paint=function(e,t,i){var n={};jsPlumb.sizeCanvas(r.canvas,e[0],e[1],e[2],e[3]),null==o?(n.class=a,o=r.getVml([0,0,e[2],e[3]],n,i,r.canvas,r._jsPlumb),r.attachListeners(o,r),r.appendDisplayElement(o,!0),r.appendDisplayElement(r.canvas,!0),r.initOpacityNodes(o,["fill"])):(m(o,[0,0,e[2],e[3]]),p(o,n)),f(o,t,r)},this.reattachListeners=function(){o&&r.reattachListenersForElement(o,r)}};jsPlumb.Connectors.vml.Bezier=function(){jsPlumb.Connectors.Bezier.apply(this,arguments),o.apply(this,arguments),this.getPath=function(e){return"m"+v(e[4])+","+v(e[5])+" c"+v(e[8])+","+v(e[9])+","+v(e[10])+","+v(e[11])+","+v(e[6])+","+v(e[7])+" e"}},jsPlumb.Connectors.vml.Straight=function(){jsPlumb.Connectors.Straight.apply(this,arguments),o.apply(this,arguments),this.getPath=function(e){return"m"+v(e[4])+","+v(e[5])+" l"+v(e[6])+","+v(e[7])+" e"}},jsPlumb.Connectors.vml.Flowchart=function(){jsPlumb.Connectors.Flowchart.apply(this,arguments),o.apply(this,arguments),this.getPath=function(e){for(var t="m "+v(e[4])+","+v(e[5])+" l",i=0;i<e[8];i++)t=t+" "+v(e[9+2*i])+","+v(e[10+2*i]);return t=t+" "+v(e[6])+","+v(e[7])+" e"}},jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),r.apply(this,arguments),this.getVml=function(e,t,i,n,o){return g("oval",e,t,n,o)}},jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),r.apply(this,arguments),this.getVml=function(e,t,i,n,o){return g("rect",e,t,n,o)}},jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.vml.Custom=jsPlumb.Overlays.Custom;function a(e,t){e.apply(this,t),n.apply(this,t);var h=this;h.canvas=null,h.isAppendedAtTopLevel=!0,this.paint=function(e,t,i,n,o,r){var a={};n&&(a.stroked="true",a.strokecolor=jsPlumbUtil.convertStyle(n,!0)),i&&(a.strokeweight=i+"px"),o&&(a.filled="true",a.fillcolor=o);var s=Math.min(t.hxy.x,t.tail[0].x,t.tail[1].x,t.cxy.x),l=Math.min(t.hxy.y,t.tail[0].y,t.tail[1].y,t.cxy.y),c=Math.max(t.hxy.x,t.tail[0].x,t.tail[1].x,t.cxy.x),u=Math.max(t.hxy.y,t.tail[0].y,t.tail[1].y,t.cxy.y),d=[s,l,Math.abs(c-s),Math.abs(u-l)];a.path=function(e){return"m "+v(e.hxy.x)+","+v(e.hxy.y)+" l "+v(e.tail[0].x)+","+v(e.tail[0].y)+" "+v(e.cxy.x)+","+v(e.cxy.y)+" "+v(e.tail[1].x)+","+v(e.tail[1].y)+" x e"}(t),a.coordsize=1e3*r[2]+","+1e3*r[3],d[0]=r[0],d[1]=r[1],d[2]=r[2],d[3]=r[3],null==h.canvas?(h.canvas=g("shape",d,a,e.canvas.parentNode,e._jsPlumb,!0),e.appendDisplayElement(h.canvas,!0),h.attachListeners(h.canvas,e),h.attachListeners(h.canvas,h)):(m(h.canvas,d),p(h.canvas,a))},this.reattachListeners=function(){h.canvas&&h.reattachListenersForElement(h.canvas,h)},this.cleanup=function(){null!=h.canvas&&jsPlumb.CurrentLibrary.removeElement(h.canvas)}}jsPlumb.Overlays.vml.Arrow=function(){a.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumb.Overlays.vml.PlainArrow=function(){a.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumb.Overlays.vml.Diamond=function(){a.apply(this,[jsPlumb.Overlays.Diamond,arguments])}}(),function(){function u(e,t){for(var i in t)e.setAttribute(i,""+t[i])}function h(e,t){var i=document.createElementNS(n,e);return(t=t||{}).version="1.1",t.xmlns=o,u(i,t),i}function l(e){return"position:absolute;left:"+e[0]+"px;top:"+e[1]+"px"}function p(e){for(var t=0;t<e.childNodes.length;t++)e.childNodes[t].tagName!=g&&e.childNodes[t].tagName!=m||e.removeChild(e.childNodes[t])}function s(e,t,i,n,o){if(i.gradient?function(e,t,i,n,o){var r="jsplumb_gradient_"+o._jsPlumb.idstamp();if(p(e),i.gradient.offset){a=h(m,{id:r});e.appendChild(a)}else{var a=h(g,{id:r,gradientUnits:"userSpaceOnUse"});e.appendChild(a)}for(var s=0;s<i.gradient.stops.length;s++){var l=s;l=8==n.length?n[4]<n[6]?s:i.gradient.stops.length-1-s:n[4]<n[6]?i.gradient.stops.length-1-s:s;var c=jsPlumbUtil.convertStyle(i.gradient.stops[l][1],!0),u=h("stop",{offset:Math.floor(100*i.gradient.stops[s][0])+"%","stop-color":c});a.appendChild(u)}var d=i.strokeStyle?"stroke":"fill";t.setAttribute("style",d+":url(#"+r+")")}(e,t,i,n,o):(p(e),t.setAttribute("style","")),t.setAttribute("fill",i.fillStyle?jsPlumbUtil.convertStyle(i.fillStyle,!0):"none"),t.setAttribute("stroke",i.strokeStyle?jsPlumbUtil.convertStyle(i.strokeStyle,!0):"none"),i.lineWidth&&t.setAttribute("stroke-width",i.lineWidth),i[f]&&i.lineWidth&&!i[d]){var r=-1==i[f].indexOf(",")?" ":",",a=i[f].split(r),s="";a.forEach(function(e){s+=Math.floor(e*i.lineWidth)+r}),t.setAttribute(d,s)}else i[d]&&t.setAttribute(d,i[d]);for(var l in c)i[l]&&t.setAttribute(c[l],i[l])}function i(e,t,i){for(var n=i.split(" "),o=e.className.baseVal.split(" "),r=0;r<n.length;r++)if(t)-1==o.indexOf(n[r])&&o.push(n[r]);else{var a=o.indexOf(n[r]);-1!=a&&o.splice(a,1)}e.className.baseVal=o.join(" ")}var c={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},d="stroke-dasharray",f="dashstyle",g="linearGradient",m="radialGradient",n="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml";jsPlumbUtil.svg={addClass:function(e,t){i(e,!0,t)},removeClass:function(e,t){i(e,!1,t)},node:h,attr:u,pos:l};function t(a){var s=this,e=a.pointerEventsSpec||"all";jsPlumb.jsPlumbUIComponent.apply(this,a.originalArgs),s.canvas=null,s.path=null,s.svg=null;var t=a.cssClass+" "+(a.originalArgs[0].cssClass||""),i={style:"",width:0,height:0,"pointer-events":e,position:"absolute"};s.tooltip&&(i.title=s.tooltip),s.svg=h("svg",i),a.useDivWrapper?(s.canvas=document.createElement("div"),s.canvas.style.position="absolute",jsPlumb.sizeCanvas(s.canvas,0,0,1,1),s.canvas.className=t,s.tooltip&&s.canvas.setAttribute("title",s.tooltip)):(u(s.svg,{class:t}),s.canvas=s.svg),a._jsPlumb.appendElement(s.canvas,a.originalArgs[0].parent),a.useDivWrapper&&s.canvas.appendChild(s.svg);var n=[s.canvas];this.getDisplayElements=function(){return n},this.appendDisplayElement=function(e){n.push(e)},this.paint=function(e,t,i){if(null!=t){var n=e[0],o=e[1];a.useDivWrapper&&(jsPlumb.sizeCanvas(s.canvas,e[0],e[1],e[2],e[3]),o=n=0);var r=l([n,o,e[2],e[3]]);s.getZIndex()&&(r+=";z-index:"+s.getZIndex()+";"),u(s.svg,{style:r,width:e[2],height:e[3]}),s._paint.apply(this,arguments)}}}var r=jsPlumb.SvgConnector=function(e){var a=this;t.apply(this,[{cssClass:e._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",tooltip:e.tooltip,_jsPlumb:e._jsPlumb}]),this._paint=function(e,t){var i={d:a.getPath(e)},n=null;if(i["pointer-events"]="all",t.outlineColor){var o=t.outlineWidth||1,r=t.lineWidth+2*o;(n=jsPlumb.CurrentLibrary.extend({},t)).strokeStyle=jsPlumbUtil.convertStyle(t.outlineColor),n.lineWidth=r,null==a.bgPath?(a.bgPath=h("path",i),a.svg.appendChild(a.bgPath),a.attachListeners(a.bgPath,a)):u(a.bgPath,i),s(a.svg,a.bgPath,n,e,a)}null==a.path?(a.path=h("path",i),a.svg.appendChild(a.path),a.attachListeners(a.path,a)):u(a.path,i),s(a.svg,a.path,t,e,a)},this.reattachListeners=function(){a.bgPath&&a.reattachListenersForElement(a.bgPath,a),a.path&&a.reattachListenersForElement(a.path,a)}};jsPlumb.Connectors.svg.Bezier=function(e){jsPlumb.Connectors.Bezier.apply(this,arguments),r.apply(this,arguments),this.getPath=function(e){var t="M "+e[4]+" "+e[5];return t+=" C "+e[8]+" "+e[9]+" "+e[10]+" "+e[11]+" "+e[6]+" "+e[7]}},jsPlumb.Connectors.svg.Straight=function(e){jsPlumb.Connectors.Straight.apply(this,arguments),r.apply(this,arguments),this.getPath=function(e){return"M "+e[4]+" "+e[5]+" L "+e[6]+" "+e[7]}},jsPlumb.Connectors.svg.Flowchart=function(){var h=this;jsPlumb.Connectors.Flowchart.apply(this,arguments),r.apply(this,arguments),this.getPath=function(e){for(var t="M "+e[4]+","+e[5],i=e[4],n=e[5],o=0;o<e[8];o++){var r=e[9+2*o],a=e[10+2*o],s=e[9+2*(o+1)],l=e[10+2*(o+1)],c=r!=i&&a==n?s<r?1:-1:0,u=r==i&&a!=n?l<a?1:-1:0,d=h.lineWidth/2;t=(t=(t=t+" L "+r+" "+a)+" L "+(r+c*d)+" "+(a+u*d))+" M "+(i=r)+" "+(n=a)}return t=t+" L "+e[6]+","+e[7]}};var e=window.SvgEndpoint=function(e){var n=this;t.apply(this,[{cssClass:e._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:e._jsPlumb}]),this._paint=function(e,t){var i=jsPlumb.extend({},t);i.outlineColor&&(i.strokeWidth=i.outlineWidth,i.strokeStyle=jsPlumbUtil.convertStyle(i.outlineColor,!0)),null==n.node&&(n.node=n.makeNode(e,i),n.svg.appendChild(n.node),n.attachListeners(n.node,n)),s(n.svg,n.node,i,e,n),l(n.node)},this.reattachListeners=function(){n.node&&n.reattachListenersForElement(n.node,n)}};jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),e.apply(this,arguments),this.makeNode=function(e,t){return h("circle",{cx:e[2]/2,cy:e[3]/2,r:e[2]/2})}},jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),e.apply(this,arguments),this.makeNode=function(e,t){return h("rect",{width:e[2],height:e[3]})}},jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.svg.Custom=jsPlumb.Overlays.Custom;function a(e,a){e.apply(this,a),jsPlumb.jsPlumbUIComponent.apply(this,a),this.isAppendedAtTopLevel=!1;var s=this,l=null;this.paint=function(e,t,i,n,o){null==l&&(l=h("path",{"pointer-events":"all"}),e.svg.appendChild(l),s.attachListeners(l,e),s.attachListeners(l,s));var r=a&&1==a.length&&a[0].cssClass||"";u(l,{d:c(t),class:r,stroke:n||null,fill:o||null})};var c=function(e){return"M"+e.hxy.x+","+e.hxy.y+" L"+e.tail[0].x+","+e.tail[0].y+" L"+e.cxy.x+","+e.cxy.y+" L"+e.tail[1].x+","+e.tail[1].y+" L"+e.hxy.x+","+e.hxy.y};this.reattachListeners=function(){l&&s.reattachListenersForElement(l,s)},this.cleanup=function(){null!=l&&jsPlumb.CurrentLibrary.removeElement(l)}}jsPlumb.Overlays.svg.Arrow=function(){a.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumb.Overlays.svg.PlainArrow=function(){a.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumb.Overlays.svg.Diamond=function(){a.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumb.Overlays.svg.GuideLines=function(){var r,a,s=null,l=this;jsPlumb.Overlays.GuideLines.apply(this,arguments),this.paint=function(e,t,i,n,o){null==s&&(s=h("path"),e.svg.appendChild(s),l.attachListeners(s,e),l.attachListeners(s,l),r=h("path"),e.svg.appendChild(r),l.attachListeners(r,e),l.attachListeners(r,l),a=h("path"),e.svg.appendChild(a),l.attachListeners(a,e),l.attachListeners(a,l)),u(s,{d:c(t[0],t[1]),stroke:"red",fill:null}),u(r,{d:c(t[2][0],t[2][1]),stroke:"blue",fill:null}),u(a,{d:c(t[3][0],t[3][1]),stroke:"green",fill:null})};var c=function(e,t){return"M "+e.x+","+e.y+" L"+t.x+","+t.y}}}(),function(){function c(e){return jsPlumb.CurrentLibrary.getOffset(d(e))}function u(e){return jsPlumb.CurrentLibrary.getPageXY(e)}function i(){var l=this;function r(e,t){return null!=e&&function(e,t){return jsPlumb.CurrentLibrary.hasClass(d(e),t)}(e,t)}l.overlayPlacements=[],jsPlumb.jsPlumbUIComponent.apply(this,arguments),jsPlumbUtil.EventGenerator.apply(this,arguments);var a=!(this._over=function(e){var t=c(d(l.canvas)),i=u(e),n=i[0]-t.left,o=i[1]-t.top;if(0<n&&0<o&&n<l.canvas.width&&o<l.canvas.height){for(var r=0;r<l.overlayPlacements.length;r++){var a=l.overlayPlacements[r];if(a&&a[0]<=n&&a[1]>=n&&a[2]<=o&&a[3]>=o)return!0}var s=l.canvas.getContext("2d").getImageData(parseInt(n),parseInt(o),1,1);return 0!=s.data[0]||0!=s.data[1]||0!=s.data[2]||0!=s.data[3]}return!1}),t=!1,i=!1;this.mousemove=function(e){u(e);var t=function(e){return jsPlumb.CurrentLibrary.getClientXY(e)}(e),i=document.elementFromPoint(t[0],t[1]),n=r(i,"_jsPlumb_overlay"),o=r(i,"_jsPlumb_endpoint")||r(i,"_jsPlumb_connector");if(!a&&o&&l._over(e))return a=!0,l.fire("mouseenter",l,e),!0;!a||l._over(e)&&o||n||(a=!1,l.fire("mouseexit",l,e)),l.fire("mousemove",l,e)},this.click=function(e){a&&l._over(e)&&!i&&l.fire("click",l,e),i=!1},this.dblclick=function(e){a&&l._over(e)&&!i&&l.fire("dblclick",l,e),i=!1},this.mousedown=function(e){l._over(e)&&!t&&(t=!0,c(d(l.canvas)),l.fire("mousedown",l,e))},this.mouseup=function(e){t=!1,l.fire("mouseup",l,e)},this.contextmenu=function(e){a&&l._over(e)&&!i&&l.fire("contextmenu",l,e),i=!1}}function n(e){var t=document.createElement("canvas");return e._jsPlumb.appendElement(t,e.parent),t.style.position="absolute",e.class&&(t.className=e.class),e._jsPlumb.getId(t,e.uuid),e.tooltip&&t.setAttribute("title",e.tooltip),t}function o(e){i.apply(this,arguments);var t=[];this.getDisplayElements=function(){return t},this.appendDisplayElement=function(e){t.push(e)}}function t(e){var r=this;o.apply(this,arguments);var t={class:r._jsPlumb.endpointClass+" "+(e.cssClass||""),_jsPlumb:r._jsPlumb,parent:e.parent,tooltip:r.tooltip};r.canvas=n(t),r.ctx=r.canvas.getContext("2d"),r.appendDisplayElement(r.canvas),this.paint=function(e,t,i){if(jsPlumb.sizeCanvas(r.canvas,e[0],e[1],e[2],e[3]),null!=t.outlineColor){var n=t.outlineWidth||1,o=t.lineWidth+2*n;t.outlineColor}r._paint.apply(this,arguments)}}var d=function(e){return jsPlumb.CurrentLibrary.getElementObject(e)},e=jsPlumb.CanvasConnector=function(e){o.apply(this,arguments);function r(e,t){if(a.ctx.save(),jsPlumb.extend(a.ctx,t),t.gradient){for(var i=a.createGradient(e,a.ctx),n=0;n<t.gradient.stops.length;n++)i.addColorStop(t.gradient.stops[n][0],t.gradient.stops[n][1]);a.ctx.strokeStyle=i}a._paint(e,t),a.ctx.restore()}var a=this,t=a._jsPlumb.connectorClass+" "+(e.cssClass||"");a.canvas=n({class:t,_jsPlumb:a._jsPlumb,parent:e.parent,tooltip:e.tooltip}),a.ctx=a.canvas.getContext("2d"),a.appendDisplayElement(a.canvas),a.paint=function(e,t){if(null!=t){if(jsPlumb.sizeCanvas(a.canvas,e[0],e[1],e[2],e[3]),a.getZIndex()&&(a.canvas.style.zIndex=a.getZIndex()),null!=t.outlineColor){var i=t.outlineWidth||1,n=t.lineWidth+2*i,o={strokeStyle:t.outlineColor,lineWidth:n};r(e,o)}r(e,t)}}};jsPlumb.Endpoints.canvas.Dot=function(e){jsPlumb.Endpoints.Dot.apply(this,arguments),t.apply(this,arguments);function u(t){try{return parseInt(t)}catch(e){if("%"==t.substring(t.length-1))return parseInt(t.substring(0,t-1))}}var d=this;this._paint=function(e,t,i){if(null!=t){var n=d.canvas.getContext("2d"),o=i.getOrientation(d);if(jsPlumb.extend(n,t),t.gradient){for(var r=function(e){var t=d.defaultOffset,i=d.defaultInnerRadius;return e.offset&&(t=u(e.offset)),e.innerRadius&&(i=u(e.innerRadius)),[t,i]}(t.gradient),a=1==o[1]?-1*r[0]:r[0],s=1==o[0]?-1*r[0]:r[0],l=n.createRadialGradient(e[4],e[4],e[4],e[4]+s,e[4]+a,r[1]),c=0;c<t.gradient.stops.length;c++)l.addColorStop(t.gradient.stops[c][0],t.gradient.stops[c][1]);n.fillStyle=l}n.beginPath(),n.arc(e[4],e[4],e[4],0,2*Math.PI,!0),n.closePath(),(t.fillStyle||t.gradient)&&n.fill(),t.strokeStyle&&n.stroke()}}},jsPlumb.Endpoints.canvas.Rectangle=function(e){var d=this;jsPlumb.Endpoints.Rectangle.apply(this,arguments),t.apply(this,arguments),this._paint=function(e,t,i){var n=d.canvas.getContext("2d"),o=i.getOrientation(d);if(jsPlumb.extend(n,t),t.gradient){for(var r=1==o[1]?e[3]:0==o[1]?e[3]/2:0,a=-1==o[1]?e[3]:0==o[1]?e[3]/2:0,s=1==o[0]?e[2]:0==o[0]?e[2]/2:0,l=-1==o[0]?e[2]:0==o[0]?e[2]/2:0,c=n.createLinearGradient(s,r,l,a),u=0;u<t.gradient.stops.length;u++)c.addColorStop(t.gradient.stops[u][0],t.gradient.stops[u][1]);n.fillStyle=c}n.beginPath(),n.rect(0,0,e[2],e[3]),n.closePath(),(t.fillStyle||t.gradient)&&n.fill(),t.strokeStyle&&n.stroke()}},jsPlumb.Endpoints.canvas.Triangle=function(e){var u=this;jsPlumb.Endpoints.Triangle.apply(this,arguments),t.apply(this,arguments),this._paint=function(e,t,i){var n=e[2],o=e[3],r=(e[0],e[1],u.canvas.getContext("2d")),a=0,s=0,l=0,c=i.getOrientation(u);1==c[0]&&(a=n,s=o,l=180),-1==c[1]&&(a=n,l=90),1==c[1]&&(s=o,l=-90),r.fillStyle=t.fillStyle,r.translate(a,s),r.rotate(l*Math.PI/180),r.beginPath(),r.moveTo(0,0),r.lineTo(n/2,o/2),r.lineTo(0,o),r.closePath(),(t.fillStyle||t.gradient)&&r.fill(),t.strokeStyle&&r.stroke()}},jsPlumb.Endpoints.canvas.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.canvas.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Connectors.canvas.Bezier=function(){var n=this;jsPlumb.Connectors.Bezier.apply(this,arguments),e.apply(this,arguments),this._paint=function(e,t){n.ctx.beginPath(),n.ctx.moveTo(e[4],e[5]),n.ctx.bezierCurveTo(e[8],e[9],e[10],e[11],e[6],e[7]),n.ctx.stroke()},this.createGradient=function(e,t,i){return n.ctx.createLinearGradient(e[6],e[7],e[4],e[5])}},jsPlumb.Connectors.canvas.Straight=function(){var m=this,v=[null,[1,-1],[1,1],[-1,1],[-1,-1]];jsPlumb.Connectors.Straight.apply(this,arguments),e.apply(this,arguments),this._paint=function(e,t){if(m.ctx.beginPath(),t.dashstyle&&2==t.dashstyle.split(" ").length){var i=t.dashstyle.split(" ");2!=i.length&&(i=[2,2]);for(var n=[i[0]*t.lineWidth,i[1]*t.lineWidth],o=(e[6]-e[4])/(e[7]-e[5]),r=jsPlumbUtil.segment([e[4],e[5]],[e[6],e[7]]),a=v[r],s=Math.atan(o),l=Math.sqrt(Math.pow(e[6]-e[4],2)+Math.pow(e[7]-e[5],2)),c=Math.floor(l/(n[0]+n[1])),u=[e[4],e[5]],d=0;d<c;d++){m.ctx.moveTo(u[0],u[1]);var h=u[0]+Math.abs(Math.sin(s)*n[0])*a[0],p=u[1]+Math.abs(Math.cos(s)*n[0])*a[1],f=u[0]+Math.abs(Math.sin(s)*(n[0]+n[1]))*a[0],g=u[1]+Math.abs(Math.cos(s)*(n[0]+n[1]))*a[1];m.ctx.lineTo(h,p),u=[f,g]}m.ctx.moveTo(u[0],u[1]),m.ctx.lineTo(e[6],e[7])}else m.ctx.moveTo(e[4],e[5]),m.ctx.lineTo(e[6],e[7]);m.ctx.stroke()},this.createGradient=function(e,t){return t.createLinearGradient(e[4],e[5],e[6],e[7])}},jsPlumb.Connectors.canvas.Flowchart=function(){var n=this;jsPlumb.Connectors.Flowchart.apply(this,arguments),e.apply(this,arguments),this._paint=function(e,t){n.ctx.beginPath(),n.ctx.moveTo(e[4],e[5]);for(var i=0;i<e[8];i++)n.ctx.lineTo(e[9+2*i],e[10+2*i]);n.ctx.lineTo(e[6],e[7]),n.ctx.stroke()},this.createGradient=function(e,t){return t.createLinearGradient(e[4],e[5],e[6],e[7])}},jsPlumb.Overlays.canvas.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.canvas.Custom=jsPlumb.Overlays.Custom;function r(e,t){e.apply(this,t),function(){jsPlumb.jsPlumbUIComponent.apply(this,arguments)}.apply(this,t),this.paint=function(e,t,i,n,o){var r=e.ctx;r.lineWidth=i,r.beginPath(),r.moveTo(t.hxy.x,t.hxy.y),r.lineTo(t.tail[0].x,t.tail[0].y),r.lineTo(t.cxy.x,t.cxy.y),r.lineTo(t.tail[1].x,t.tail[1].y),r.lineTo(t.hxy.x,t.hxy.y),r.closePath(),n&&(r.strokeStyle=n,r.stroke()),o&&(r.fillStyle=o,r.fill())}}jsPlumb.Overlays.canvas.Arrow=function(){r.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumb.Overlays.canvas.PlainArrow=function(){r.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumb.Overlays.canvas.Diamond=function(){r.apply(this,[jsPlumb.Overlays.Diamond,arguments])}}(),function(i){jsPlumb.CurrentLibrary={addClass:function(e,t){e=jsPlumb.CurrentLibrary.getElementObject(e);try{e[0].className.constructor==SVGAnimatedString&&jsPlumbUtil.svg.addClass(e[0],t)}catch(e){}e.addClass(t)},animate:function(e,t,i){e.animate(t,i)},appendElement:function(e,t){jsPlumb.CurrentLibrary.getElementObject(t).append(e)},ajax:function(e){(e=e||{}).type=e.type||"get",i.ajax(e)},bind:function(e,t,i){(e=jsPlumb.CurrentLibrary.getElementObject(e)).bind(t,i)},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},extend:function(e,t){return i.extend(e,t)},getAttribute:function(e,t){return e.attr(t)},getClientXY:function(e){return[e.clientX,e.clientY]},getDragObject:function(e){return e[1].draggable},getDragScope:function(e){return e.draggable("option","scope")},getDropEvent:function(e){return e[0]},getDropScope:function(e){return e.droppable("option","scope")},getDOMElement:function(e){return"string"==typeof e?document.getElementById(e):e.context||null!=e.length?e[0]:e},getElementObject:function(e){return i("string"==typeof e?"#"+e:e)},getOffset:function(e){return e.offset()},getOriginalEvent:function(e){return e.originalEvent},getPageXY:function(e){return[e.pageX,e.pageY]},getParent:function(e){return jsPlumb.CurrentLibrary.getElementObject(e).parent()},getScrollLeft:function(e){return e.scrollLeft()},getScrollTop:function(e){return e.scrollTop()},getSelector:function(e){return i(e)},getSize:function(e){return[e.outerWidth(),e.outerHeight()]},getTagName:function(e){var t=jsPlumb.CurrentLibrary.getElementObject(e);return 0<t.length?t[0].tagName:null},getUIPosition:function(e,t){if(t=t||1,1==e.length)ret={left:e[0].pageX,top:e[0].pageY};else{var i=e[1],n=i.offset;ret=n||i.absolutePosition,i.position.left/=t,i.position.top/=t}return{left:ret.left/t,top:ret.top/t}},hasClass:function(e,t){return e.hasClass(t)},initDraggable:function(e,t,i){(t=t||{}).helper=null,i&&(t.scope=t.scope||jsPlumb.Defaults.Scope),e.draggable(t)},initDroppable:function(e,t){t.scope=t.scope||jsPlumb.Defaults.Scope,e.droppable(t)},isAlreadyDraggable:function(e){return(e=jsPlumb.CurrentLibrary.getElementObject(e)).hasClass("ui-draggable")},isDragSupported:function(e,t){return e.draggable},isDropSupported:function(e,t){return e.droppable},removeClass:function(e,t){e=jsPlumb.CurrentLibrary.getElementObject(e);try{e[0].className.constructor==SVGAnimatedString&&jsPlumbUtil.svg.removeClass(e[0],t)}catch(e){}e.removeClass(t)},removeElement:function(e,t){jsPlumb.CurrentLibrary.getElementObject(e).remove()},setAttribute:function(e,t,i){e.attr(t,i)},setDraggable:function(e,t){e.draggable("option","disabled",!t)},setDragScope:function(e,t){e.draggable("option","scope",t)},setOffset:function(e,t){jsPlumb.CurrentLibrary.getElementObject(e).offset(t)},trigger:function(e,t,i){jQuery._data(jsPlumb.CurrentLibrary.getElementObject(e)[0],"handle")(i)},unbind:function(e,t,i){(e=jsPlumb.CurrentLibrary.getElementObject(e)).unbind(t,i)}},i(document).ready(jsPlumb.init)}(jQuery),function(){void 0===Math.sgn&&(Math.sgn=function(e){return 0==e?0:0<e?1:-1});function n(e,t){for(var i=[],n=t.length-1,o=2*n-1,r=[],a=[],s=[],l=[],c=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],u=0;u<=n;u++)r[u]=h(t[u],e);for(u=0;u<=n-1;u++)a[u]=h(t[u+1],t[u]),a[u]=g(a[u],3);for(u=0;u<=n-1;u++)for(var d=0;d<=n;d++)s[u]||(s[u]=[]),s[u][d]=p(a[u],r[d]);for(u=0;u<=o;u++)l[u]||(l[u]=[]),l[u].y=0,l[u].x=parseFloat(u)/o;for(o=n-1,r=0;r<=n+o;r++)for(u=Math.max(0,r-o),a=Math.min(r,n);u<=a;u++)j=r-u,l[u+j].y=l[u+j].y+s[j][u]*c[j][u];for(n=t.length-1,l=v(l,2*n-1,i,0),o=h(e,t[0]),s=f(o),u=c=0;u<l;u++)o=h(e,y(t,n,i[u],null,null)),(o=f(o))<s&&(s=o,c=i[u]);return o=h(e,t[n]),(o=f(o))<s&&(s=o,c=1),{location:c,distance:s}}function s(e,t){for(var i=function(t){if(!(r=c[t])){function e(e){return function(){return e}}function i(){return function(e){return e}}function n(){return function(e){return 1-e}}function o(n){return function(e){for(var t=1,i=0;i<n.length;i++)t*=n[i](e);return t}}var r;(r=[]).push(new function(){return function(e){return Math.pow(e,t)}});for(var a=1;a<t;a++){for(var s=[new e(t)],l=0;l<t-a;l++)s.push(new i);for(l=0;l<a;l++)s.push(new n);r.push(new o(s))}r.push(new function(){return function(e){return Math.pow(1-e,t)}}),c[t]=r}return r}(e.length-1),n=0,o=0,r=0;r<e.length;r++)n+=e[r].x*i[r](t),o+=e[r].y*i[r](t);return{x:n,y:o}}function o(e,t,i){for(var n=s(e,t),o=0,r=0<i?1:-1,a=null;o<Math.abs(i);)a=s(e,t+=.005*r),o+=Math.sqrt(Math.pow(a.x-n.x,2)+Math.pow(a.y-n.y,2)),n=a;return{point:a,location:t}}function r(e,t){var i=s(e,t),n=s(e.slice(0,e.length-1),t),o=n.y-i.y;return i=n.x-i.x,0==o?1/0:Math.atan(o/i)}var h=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},p=function(e,t){return e.x*t.x+e.y*t.y},f=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},g=function(e,t){return{x:e.x*t,y:e.y*t}},m=Math.pow(2,-65),v=function(e,t,i,n){var o,r,a=[],s=[],l=[],c=[],u=0;r=Math.sgn(e[0].y);for(var d=1;d<=t;d++)(o=Math.sgn(e[d].y))!=r&&u++,r=o;switch(u){case 0:return 0;case 1:if(64<=n)return i[0]=(e[0].x+e[t].x)/2,1;var h;u=e[0].y-e[t].y;for(r=e[t].x-e[0].x,d=e[0].x*e[t].y-e[t].x*e[0].y,o=max_distance_below=0,h=1;h<t;h++){var p=u*e[h].x+r*e[h].y+d;o<p?o=p:p<max_distance_below&&(max_distance_below=p)}if(o=1/(0*(h=r)-1*u)*(1*(d-o)-0*h),u=1/(0*(h=r)-1*u)*(1*(r=d-max_distance_below)-0*h),r=Math.min(o,u),Math.max(o,u)-r<m)return l=e[t].x-e[0].x,c=e[t].y-e[0].y,i[0]=0+1*(l*(e[0].y-0)-c*(e[0].x-0))*(1/(0*l-1*c)),1}for(y(e,t,.5,a,s),e=v(a,t,l,n+1),t=v(s,t,c,n+1),n=0;n<e;n++)i[n]=l[n];for(n=0;n<t;n++)i[n+e]=c[n];return e+t},y=function(e,t,i,n,o){for(var r=[[]],a=0;a<=t;a++)r[0][a]=e[a];for(e=1;e<=t;e++)for(a=0;a<=t-e;a++)r[e]||(r[e]=[]),r[e][a]||(r[e][a]={}),r[e][a].x=(1-i)*r[e-1][a].x+i*r[e-1][a+1].x,r[e][a].y=(1-i)*r[e-1][a].y+i*r[e-1][a+1].y;if(null!=n)for(a=0;a<=t;a++)n[a]=r[a][0];if(null!=o)for(a=0;a<=t;a++)o[a]=r[t-a][a];return r[t][0]},c={};window.jsBezier={distanceFromCurve:n,gradientAtPoint:r,gradientAtPointAlongCurveFrom:function(e,t,i){return 1<(t=o(e,t,i)).location&&(t.location=1),t.location<0&&(t.location=0),r(e,t.location)},nearestPointOnCurve:function(e,t){var i=n(e,t);return{point:y(t,t.length-1,i.location,null,null),location:i.location}},pointOnCurve:s,pointAlongCurveFrom:function(e,t,i){return o(e,t,i).point},perpendicularToCurveAt:function(e,t,i,n){return t=o(e,t,null==n?0:n),e=r(e,t.location),n=Math.atan(-1/e),e=i/2*Math.sin(n),i=i/2*Math.cos(n),[{x:t.point.x+i,y:t.point.y+e},{x:t.point.x-i,y:t.point.y-e}]},locationAlongCurveFrom:function(e,t,i){return o(e,t,i).location}}}(),function(){var r=AGN.Lib.DateFormat,a={toDateTime:function(e,t,i){var n=null;return e&&e.getMonth&&(n=new Date(e),t&&0!==t&&n.setHours(t),i&&0!==i&&n.setMinutes(i)),n},getDateTimeValue:function(e,t,i){var n=a.toDateTime(e,t,i);return null!=n?n.getTime():null},getDateTimeStr:function(e,t,i,n){if(!e||!e.getMonth())return"";t=t||e.getHours(),i=i||e.getMinutes();var o=a.toDateTime(e,t,i);return o?r.format(o,n):""},getDateStr:function(e,t){return a.getDateTimeStr(e,null,null,t)}};AGN.Lib.WM.DateTimeUtils=a}(),AGN.Lib.WM.MailingEditorBase=function(e,m,r){this.MAILING_TYPE_ACTIONBASED=1,this.MAILING_TYPE_DATEBASED=2,this.MAILING_TYPE_FOLLOWUP=3,this.PARAM_MAILING_LIST=1,this.PARAM_TARGET_GROUPS=2,this.PARAM_ARCHIVE=3,this.PARAM_LIST_SPLIT=4,this.PARAM_PLANNED_DATE=5,this.PARAM_SEND_DATE=6,this.node={},this.mailingsStatus="all",this.defaultMailingsSort=e.defaultMailingsSort,this.defaultMailingsOrder=e.defaultMailingsOrder,this.mailingsSort=this.defaultMailingsSort,this.mailingsOrder=this.defaultMailingsOrder,this.formNameJId="form[name='"+e.form+"']",this.containerId=e.container,this.mailingType=e.mailingType,this.mailingTypesForLoading=e.mailingTypesForLoading,this.statusName=e.mailingStatus,this.selectName=e.selectName,this.selectNameJId="select[name="+e.selectName+"]",this.mailingId=0,this.showCreateEditLinks=e.showCreateEditLinks,this.dropDownEl=null,this.campaignManager=m,e.dropDownEl&&(this.dropDownEl=e.dropDownEl),this.isChangeDecisionOptions=e.isEnableTrackingVeto&&e.isFollowUpBaseMailing,this.followUpContainer=e.followUpContainer,this.advertisingAdditionalOptions=e.advertisingAdditionalOptions,this.advertisingUrl=e.advertisingUrl,this.nodesChain=[],this.mailingData={},this.configuredMailingData=null;var v=this,f=m.getEditorsHelper();this.fillEditorBase=function(e){this.node=e,this.mailingsStatus=$(this.formNameJId).find("input[checked=checked]").val()||"all",this.mailingsSort=this.defaultMailingsSort,this.mailingsOrder=this.defaultMailingsOrder,this.cleanOptions(),this.hideSendSettings(),this.changeDecisionOptionsSet($(this.containerId),this.isChangeDecisionOptions)},this.cleanOptions=function(){this.setDefaultSortOptions(),jQuery(this.containerId+" #"+this.statusName+"_all").attr("checked","checked"),this.activateInputs(),this.setSelectMailingOptions(this.node.data[this.selectName]),this.getMailingsByWorkStatus(this.mailingsStatus,this.mailingsSort,this.mailingsOrder,this.node.data.mailingId)},this.setDefaultSortOptions=function(){this.mailingsSort=this.defaultMailingsSort,this.mailingsOrder=this.defaultMailingsOrder,jQuery(this.containerId+" .arrowUp").hide(),jQuery(this.containerId+" .arrowDown").hide(),jQuery(this.containerId+" #shortname_sort").attr("press",1),jQuery(this.containerId+" #change_date_sort").attr("press",2),this.mailingType==this.MAILING_TYPE_ACTIONBASED||this.mailingType==this.MAILING_TYPE_DATEBASED?jQuery(this.containerId+" #shortname_sort .arrowUp").show():jQuery(this.containerId+" #change_date_sort .arrowDown").show()},this.onMailingsStatusChange=function(e){this.setSelectMailingOptions(0),this.getMailingsByWorkStatus(e,this.mailingsSort,this.mailingsOrder),this.changeDecisionOptionsSet($(this.containerId),this.isChangeDecisionOptions)},this.onMailingSelectChange=function(e){this.setSelectMailingOptions(e),this.changeDecisionOptionsSet($(this.containerId),this.isChangeDecisionOptions)},this.changeDecisionOptionsSet=function(e,t){if(t){var i=this.mailingId,n=$(e.find(this.followUpContainer)),o=this.advertisingAdditionalOptions,r=this.advertisingUrl;jQuery.ajax({action:"POST",url:r,data:{mailingId:i},success:function(e){if($(n.find(".advertisingOption")).remove(),e.isAdvertisingContentType){var t=AGN.Lib.Template.text("followupAdvertisingOptions",{items:o});n.append(t)}}})}},this.onMailingSortClick=function(e,t){jQuery(this.containerId+" .arrowUp").hide(),jQuery(this.containerId+" .arrowDown").hide();var i=jQuery(this.containerId+" .sort"),n=this.containerId+" #"+e+"_sort",o=jQuery(n),r=jQuery(n+" .arrowUp"),a=jQuery(n+" .arrowDown"),s=o.attr("press"),l=jQuery(this.formNameJId+" "+this.selectNameJId).val();if(s)switch(s){case"1":o.attr("press",2),a.show(),this.mailingsOrder="DESC";break;case"2":o.attr("press",1),r.show(),this.mailingsOrder="ASC"}else i.attr("press",2),o.attr("press",2),r.show(),this.mailingsOrder="ASC";this.getMailingsByWorkStatus(this.mailingsStatus,t,this.mailingsOrder,l)},this.setMailingId=function(e){this.mailingId=e,this.dropDownEl&&(0<this.mailingId?this.dropDownEl.show():this.dropDownEl.hide())},this.setSelectMailingOptions=function(e){this.setMailingId(e),this.showCreateEditLinks&&this.setMailingLinks(e)},this.setMailingLinks=function(e){var i="";i="0"!=e?'<span style="font-weight: bold;">'+t("workflow.mailing.tip")+': &nbsp;</span><a href="#" data-action="mailing-editor-edit">'+t("workflow.mailing.edit_mailing_link")+"</a> ":'<a href="#" class="setting-mailing-left" data-action="mailing-editor-new"> '+t("workflow.mailing.new")+"</a>";var n=jQuery(this.containerId+" #mailing_create_edit_link");n.html(""),n.append(i)},this.showSecurityQuestion=function(){if(this.setSecurityQuestion(),this.setIsUsedInCMAttr(),this.isSentMailing(this.mailingIsSent)||this.mailingIsUsedInCM){var e=this.getSelectedMailingOption();return $(this.containerId+"-security-dialog").dialog({title:'<span class="dialog-fat-title">'+e.html()+"</span>",dialogClass:"no-close",open:function(e,t){},width:650,modal:!0,resizable:!1}),!1}return!0},this.isSentMailing=function(e){return"mailing.status.sent"==e||"mailing.status.scheduled"==e||"mailing.status.norecipients"==e},this.cancelSecurityDialog=function(){jQuery(this.containerId+"-security-dialog").dialog("close")},this.getMailingsByWorkStatus=function(i,n,o,r){var a=this,s=$(this.formNameJId+" "+this.selectNameJId);s.attr("readonly","readonly"),jQuery.ajax({type:"POST",url:"workflow.do;jsessionid="+m.getSessionId(),data:{method:"getMailingsByWorkStatus",mailingTypes:this.mailingTypesForLoading.join(","),status:i,sort:n,order:o},success:function(e){s.empty(),s.append($("<option></option>",{value:0,text:t("workflow.defaults.no_mailing")})),e.forEach(function(e){var t=$("<option></option>",{value:e.MAILING_ID,text:e.SHORTNAME,selected:r==e.MAILING_ID});a.isSentMailing(e.WORK_STATUS)&&t.css("color","#808080"),t.attr({status:e.WORK_STATUS,senddate:e.SENDDATE}),t.data({status:e.WORK_STATUS,"send-date":e.SENDDATE,"dependent-campaigns":e.USEDINWORKFLOWS||""}),s.append(t)}),s.removeAttr("readonly"),a.mailingsStatus=i,a.mailingsSort=n,a.mailingsOrder=o,s.val(a.mailingId),f.initSelectWithValueOrChooseFirst(s,a.mailingId)}})},this.disableInputs=function(){jQuery(this.containerId+" [name='"+this.statusName+"']").attr("disabled","disabled")},this.activateInputs=function(){jQuery(this.containerId+" [name='"+this.statusName+"']").removeAttr("disabled")},this.setNodeFields=function(){var e=this.getSelectedMailingOption();this.setNodeFilled(e),this.setNodeIconTitle(e)},this.setNodeFilled=function(e){this.node.filled=!1,0<parseInt(this.mailingId,10)&&(this.node.filled=!0)},this.setNodeIconTitle=function(e){this.node.iconTitle="",0<parseInt(this.mailingId,10)&&(this.node.iconTitle=e.html())},this.setSecurityQuestion=function(){var e=this.getSelectedMailingOption();this.mailingIsSent="",0<parseInt(this.mailingId,10)&&(this.mailingIsSent=e.data("status"))},this.setIsUsedInCMAttr=function(){var e=this.getSelectedMailingOption(),t=e.data("dependent-campaigns"),i=e.val();if(this.mailingIsUsedInCM=!1,0<parseInt(this.mailingId,10)&&i==this.mailingId&&t){var n=this.campaignManager.workflowId||0,o=t.split(",");0<o.length&&(this.mailingIsUsedInCM=!(0<n)||o.indexOf(n.toString())<0)}},this.getSelectedMailingOption=function(){return jQuery(this.formNameJId+" "+this.selectNameJId+" option[value="+this.mailingId+"]")},this.getSelectedDecisionOption=function(){var e="decisionCriterion",t=jQuery(this.formNameJId+" select[name='"+e+"']").val();return jQuery(this.formNameJId+" select[name='"+e+"'] option[value="+t+"]")},this.createNewMailing=function(e){o({iconId:this.node.id,successCallback:i,forwardName:e,mailingEditorBase:this})};var i=function(e,i,n){if(e.hasMailingList){var o=[];o.push("mailingType="+n.mailingType),n.mailingType==n.MAILING_TYPE_FOLLOWUP&&(o.push("workflowFollowUpParentMailing="+n.node.data.baseMailingId),o.push("workflowFollowUpDecisionCriterion="+n.node.data.decisionCriterion)),f.processForward(i,n.formNameJId+" "+n.selectNameJId,[],r,o.join(";"))}else jQuery(n.containerId+" .editor-error-messages").html(t("error.workflow.notAddedMailingList")),jQuery(n.containerId+" .editor-error-messages").css("display","block")};this.processCopyAndEditMailingForward=function(e,t,i,n){jQuery("#forwardTargetItemId").val(e);var o=[];this.mailingType==this.MAILING_TYPE_FOLLOWUP&&(o.push("workflowFollowUpParentMailing="+this.node.data.baseMailingId),o.push("workflowFollowUpDecisionCriterion="+this.node.data.decisionCriterion)),0<o.length?f.processForward(t,i+" "+n,[],r,o.join(";")):f.processForward(t,i+" "+n,[],r)},this.editMailing=function(e){this.processCopyAndEditMailingForward(this.mailingId,e,this.formNameJId,this.selectNameJId)},this.copyMailing=function(e){this.processCopyAndEditMailingForward(this.mailingId,e,this.formNameJId,this.selectNameJId)},this.trySupplementNodes=function(e){var t=m.getIncomingChainsForIcon();if(0<t.length){var i=t[0];this.configuredMailingData=s(i),this.nodesChain=i,this.mailingData=e,n(this)}},this.checkDifferentMailingLists=function(e,o,r){var a=this;l(e,function(e){var t=m.getIncomingChainsForIcon()[0];a.configuredMailingData=s(t),a.nodesChain=t,a.mailingData=e;var i=0;t.forEach(function(e){e.type==AGN.Lib.WM.NodeFactory.NODE_TYPE_MAILING&&i++});var n=a.configuredMailingData.mailinglistId;1<i&&0!=n&&n!=e.mailinglistId?r(e):o(e)})};var s=function(e){for(var t={parameterValue:0,campaignId:0,mailinglistId:0,targets:[],date:null},i=e.length-1;0<=i;i--){var n=e[i].data;switch(e[i].type){case AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER:t.parameterValue=n.value;break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE:t.campaignId=n.campaignId;break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT:if(0==t.mailinglistId&&(t.mailinglistId=n.mailinglistId),null!==n.targets)for(var o=0;o<n.targets.length;o++)S(t.targets,n.targets[o])||t.targets.push(parseInt(n.targets[o]));break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_START:n.date?(t.date=E(n.date),t.date.setHours(n.hour),t.date.setMinutes(n.minute)):t.date=null;break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_DEADLINE:n.deadlineType==constants.deadlineTypeFixedDeadline?n.date?(t.date=E(n.date),t.date.setHours(n.hour),t.date.setMinutes(n.minute)):t.date=null:n.deadlineType==constants.deadlineTypeDelay&&null!=t.date&&(n.timeUnit==constants.deadlineTimeUnitMinute?t.date.setMinutes(t.date.getMinutes()+parseInt(n.delayValue)):n.timeUnit==constants.deadlineTimeUnitHour?t.date.setHours(t.date.getHours()+parseInt(n.delayValue)):n.timeUnit==constants.deadlineTimeUnitDay&&(t.date.setDate(t.date.getDate()+parseInt(n.delayValue)),!n.useTime&&"true"!=n.useTime||(t.date.setMinutes(t.date.getMinutes()+parseInt(n.minute)),t.date.setHours(t.date.getHours()+parseInt(n.hour)))))}}return t},n=function(){0<a(v,!0).length?h(v):v.supplementNewOrUpdateExistingNodes()},a=function(e,t){var i=e.configuredMailingData,n=e.mailingData,o=[],r=[],a=[];0==n.mailinglistId?a.push(e.PARAM_MAILING_LIST):0==i.mailinglistId?o.push(e.PARAM_MAILING_LIST):i.mailinglistId!=n.mailinglistId&&(t?r.push(e.PARAM_MAILING_LIST):o.push(e.PARAM_MAILING_LIST));var s=i.targets,l=n.targetGroupIds;null==l||0==l.length?a.push(e.PARAM_TARGET_GROUPS):null==s||0==s.length?o.push(e.PARAM_TARGET_GROUPS):x(i,n)||(t?r.push(e.PARAM_TARGET_GROUPS):o.push(e.PARAM_TARGET_GROUPS));var c=e.getParameterValue(n.splitBase,n.splitPart);null==c?a.push(e.PARAM_LIST_SPLIT):0==i.parameterValue?o.push(e.PARAM_LIST_SPLIT):i.parameterValue!=c&&(t?r.push(e.PARAM_LIST_SPLIT):o.push(e.PARAM_LIST_SPLIT)),0==n.campaignId?a.push(e.PARAM_ARCHIVE):0==i.campaignId?o.push(e.PARAM_ARCHIVE):i.campaignId!=n.campaignId&&(t?r.push(e.PARAM_ARCHIVE):o.push(e.PARAM_ARCHIVE));var u=i.date,d=A(n),h=_(n);return null==d&&null==h?a.push(e.PARAM_PLANNED_DATE):null==u?null!=d?o.push(e.PARAM_PLANNED_DATE):o.push(e.PARAM_SEND_DATE):(E(d)>E(u)?t?r.push(e.PARAM_PLANNED_DATE):o.push(e.PARAM_PLANNED_DATE):d&&E(d)<E(u)&&a.push(e.PARAM_PLANNED_DATE),u<h?t?r.push(e.PARAM_SEND_DATE):o.push(e.PARAM_SEND_DATE):h&&h<u&&a.push(e.PARAM_SEND_DATE)),p(e,a),t?r:o},p=function(e,t){for(var i=e.configuredMailingData,n=e.mailingData,o=0;o<t.length;o++)switch(t[o]){case e.PARAM_MAILING_LIST:n.mailinglistId=i.mailinglistId;break;case e.PARAM_TARGET_GROUPS:n.targetGroupIds=i.targets;break;case e.PARAM_ARCHIVE:n.campaignId=i.campaignId;break;case e.PARAM_LIST_SPLIT:n.splitBase="",n.splitPart="";break;case e.PARAM_PLANNED_DATE:var r=E(i.date);n.planDate=r?r.getTime():0;break;case e.PARAM_SEND_DATE:n.sendDate=E(i.date),i.date&&(n.sendHour=i.date.getHours(),n.sendMinute=i.date.getMinutes())}},l=function(e,t){jQuery.ajax({type:"POST",url:"workflow.do;jsessionid="+m.getSessionId(),data:{method:"getMailingContent",mailingId:e},success:function(e){t(e)}})},o=function(e){var t=e.iconId||f.curEditingNode.id,i=e.successCallback,n=e.forwardName,o=m.getIconsForSubmission(),s={},l={};o.forEach(function(n){(s[n.id]=n).connections&&n.connections.forEach(function(e){var t=n.id,i=e.targetIconId;l[i]||(l[i]={}),l[i][t]=!0})}),i({hasMailingList:function(e){for(var t=Object.keys(l[e]||{}),i={};0<t.length;){var n=t;t=[];for(var o=0;o<n.length;o++){var r=n[o],a=s[r];if(a.type===AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT)return 0<a.mailinglistId;i[r]=!0,Object.keys(l[r]||{}).forEach(function(e){i[e]||t.push(e)})}}return!1}(t)},n,e.mailingEditorBase)};this.closeTransferDialog=function(){jQuery(this.containerId+"-transfer-dialog").dialog("close")},this.transferMailingData=function(){var i=a(v,!0),n=[],o=v;jQuery(this.containerId+"-transfer-dialog input[name^=transfer]").each(function(){var e=jQuery(this);if(!e[0].checked){var t=null;switch(e.attr("name")){case"transferPlanedFor":t=o.PARAM_PLANNED_DATE;break;case"transferMailingList":t=o.PARAM_MAILING_LIST;break;case"transferTargetGroups":t=o.PARAM_TARGET_GROUPS;break;case"transferArchive":t=o.PARAM_ARCHIVE;break;case"transferListSplit":t=o.PARAM_LIST_SPLIT;break;case"transferDeliveryTime":t=o.PARAM_SEND_DATE}t&&S(i,t)&&n.push(t)}}),p(v,n),v.supplementNewOrUpdateExistingNodes(),this.closeTransferDialog()},this.transferRequiredMailingData=function(){var e=a(this,!0);p(this,e),this.supplementNewOrUpdateExistingNodes(),this.closeTransferDialog()},this.supplementNewOrUpdateExistingNodes=function(){var e=u(f.curEditingNode.usedAnchors,!1);1<this.nodesChain.length&&(e=d(f.curEditingNode,this.nodesChain[1]));for(var t=[AGN.Lib.WM.NodeFactory.NODE_TYPE_MAILING,AGN.Lib.WM.NodeFactory.NODE_TYPE_ACTION_BASED_MAILING,AGN.Lib.WM.NodeFactory.NODE_TYPE_DATE_BASED_MAILING,AGN.Lib.WM.NodeFactory.NODE_TYPE_FOLLOWUP_MAILING],i=0,n=1;n<this.nodesChain.length;n++)if(0<=t.indexOf(this.nodesChain[n].type)){i=n;break}var o=a(this,!1);0<i?this.supplementNodesBetweenMailings(o,i,e):this.supplementNodesBeforeMailing(o,e)},this.supplementNodesBetweenMailings=function(i,e,t){var n=v,o={x:f.curEditingNode.x,y:f.curEditingNode.y},r=[],a=n.mailingData;if(S(i,this.PARAM_LIST_SPLIT)){var s=AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER,l=0<e?e:n.nodesChain.length,c=[];this.updateExistingOrAddNewNodeForThanOneValue(s,l,o,t,c,r,function(e){e.data.value=n.getParameterValue(a.splitBase,a.splitPart)})}S(i,this.PARAM_ARCHIVE)&&(s=AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE,l=0<e?e:n.nodesChain.length,c=[AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER],this.updateExistingOrAddNewNodeForThanOneValue(s,l,o,t,c,r,function(e){e.data.campaignId=a.campaignId})),(S(i,this.PARAM_MAILING_LIST)||S(i,this.PARAM_TARGET_GROUPS))&&(s=AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT,l=0<e?e:n.nodesChain.length,c=[AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER,AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE],this.updateExistingOrAddNewNodeForThanOneValue(s,l,o,t,c,r,function(e){S(i,n.PARAM_MAILING_LIST)&&(e.data.mailinglistId=a.mailinglistId,e.isDependent=!0),S(i,n.PARAM_TARGET_GROUPS)&&(e.data.targets=a.targetGroupIds,e.data.targetsOption="ONE_TARGET_REQUIRED")})),(S(i,this.PARAM_PLANNED_DATE)||S(i,this.PARAM_SEND_DATE))&&(s=AGN.Lib.WM.NodeFactory.NODE_TYPE_DEADLINE,l=0<e?e:n.nodesChain.length,c=[AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER,AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE,AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT],this.updateExistingOrAddNewNodeForThanOneValue(s,l,o,t,c,r,function(e){if(S(i,n.PARAM_PLANNED_DATE)){e.data.date=A(n.mailingData);var t=n.configuredMailingData.date;t&&(e.data.date.setHours(t.getHours()),e.data.date.setMinutes(t.getMinutes()))}else S(i,n.PARAM_SEND_DATE)&&(e.data.date=_(n.mailingData));e.data.deadlineType=constants.deadlineTypeFixedDeadline,e.data.hour=e.data.date.getHours(),e.data.minute=e.data.date.getMinutes()}));var u=m.getCMNodes().getNodeIdPrefix();if(0<r.length){var d=m.getCurrentState();m.setCurrentState(m.STATE_AUTOMATICALLY_CREATING_CONNECTION);for(var h=0;h<r.length;h++)g(r[h].newNode,r[h].nextNodeId),g(m.getCMNodes().getNodeById(u+r[h].prevNodeId),r[h].newNode.id),b(r[h].newNode);m.setCurrentState(d)}},this.supplementNodesBeforeMailing=function(n,e){var o=v,t=C(this.nodesChain,n);if(this.nodesChain.length-1<t.length)for(var i=1;i<this.nodesChain.length;i++)m.deleteNode(m.getCMNodes().getNodeIdPrefix()+this.nodesChain[i].id,!0,!0);for(var r={x:f.curEditingNode.x,y:f.curEditingNode.y},a={nextNode:f.curEditingNode},s=!1,l=[],c=0;c<t.length;c++)switch(s=!1,t[c]){case AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER:for(var u=0;u<this.nodesChain.length;u++)if(this.nodesChain[u].type==AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER){s=!0;break}(S(n,this.PARAM_LIST_SPLIT)||s)&&(d=this.updateExistingOrAddNewNode(a,r,e,AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER,function(e,t){t&&(e.data=t.data),S(n,o.PARAM_LIST_SPLIT)&&(e.data.value=o.getParameterValue(o.mailingData.splitBase,o.mailingData.splitPart),b(e))}))&&l.push(d);break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE:for(u=0;u<this.nodesChain.length;u++)if(this.nodesChain[u].type==AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE){s=!0;break}(S(n,this.PARAM_ARCHIVE)||s)&&(d=this.updateExistingOrAddNewNode(a,r,e,AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE,function(e,t){t&&(e.data=t.data),S(n,o.PARAM_ARCHIVE)&&(e.data.campaignId=o.mailingData.campaignId,b(e))}))&&l.push(d);break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT:for(u=0;u<this.nodesChain.length;u++)if(this.nodesChain[u].type==AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT){s=!0;break}(S(n,this.PARAM_MAILING_LIST)||S(n,this.PARAM_TARGET_GROUPS)||s)&&(d=this.updateExistingOrAddNewNode(a,r,e,AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT,function(e,t){t&&(e.data=t.data),S(n,o.PARAM_MAILING_LIST)&&(e.data.mailinglistId=o.mailingData.mailinglistId,b(e)),S(n,o.PARAM_TARGET_GROUPS)&&(e.data.targets=o.mailingData.targetGroupIds,e.data.targetsOption="ONE_TARGET_REQUIRED",b(e))}))&&l.push(d);break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_START:for(u=0;u<this.nodesChain.length;u++)if(this.nodesChain[u].type==AGN.Lib.WM.NodeFactory.NODE_TYPE_START){s=!0;break}(0==m.getCMNodes().getNodesByType(AGN.Lib.WM.NodeFactory.NODE_TYPE_START).length&&this.mailingData.mailingType!=this.MAILING_TYPE_ACTIONBASED&&this.mailingData.mailingType!=this.MAILING_TYPE_DATEBASED&&(S(n,this.PARAM_PLANNED_DATE)||S(n,this.PARAM_SEND_DATE))||s)&&(d=this.updateExistingOrAddNewNode(a,r,e,AGN.Lib.WM.NodeFactory.NODE_TYPE_START,function(e,t){if(t&&(e.filled=t.filled,e.data=t.data),S(n,o.PARAM_PLANNED_DATE)){e.data.date=A(o.mailingData);var i=o.configuredMailingData.date;i&&(e.data.hour=i.getHours(),e.data.minute=i.getMinutes()),b(e)}else S(n,o.PARAM_SEND_DATE)&&(e.data.date=_(o.mailingData),e.data.hour=e.data.date.getHours(),e.data.minute=e.data.date.getMinutes(),b(e))}))&&l.push(d);break;default:for(u=0;u<this.nodesChain.length;u++)if(this.nodesChain[u].type==t[c]){s=!0;break}var d;s&&(d=this.updateExistingOrAddNewNode(a,r,e,t[c],function(e,t){t&&(e.data=t.data,b(e))}))&&l.push(d)}if(0<l.length){var h=m.getCurrentState();for(m.setCurrentState(m.STATE_AUTOMATICALLY_CREATING_CONNECTION),u=0;u<l.length;u++){g(l[u].node,l[u].nextNode.id);var p=!1;switch(l[u].node.type){case AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER:0!=l[u].node.data.value&&(p=!0);break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE:0<l[u].node.data.campaignId&&(p=!0);break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT:(0<l[u].node.data.mailinglistId||0<l[u].node.data.targets.length)&&(p=!0);break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_START:null!=l[u].node.data.date&&(p=!0)}p?b(l[u].node):m.updateNode(l[u].node)}m.setCurrentState(h)}},this.updateExistingOrAddNewNode=function(e,t,i,n,o){for(var r=!1,a=!1,s=m.getCMNodes().getNodeIdPrefix(),l=0;l<this.nodesChain.length;l++)if(this.nodesChain[l].type==n){if(m.getCMNodes().getNodeById(s+this.nodesChain[l].id))return o(this.nodesChain[l],!1),r=!0,e.nextNode=this.nodesChain[l],null;a=this.nodesChain[l]}if(!r){var c=y(n,t,i,!0);o(c,a||!1);var u={nextNode:e.nextNode,node:c};e.nextNode=c}return u},this.updateExistingOrAddNewNodeForThanOneValue=function(e,t,i,n,o,r,a){for(var s=v,l=m.getCMNodes().getNodeIdPrefix(),c=!1,u=1;u<t;u++)if(s.nodesChain[u].type==e){a(s.nodesChain[u]),b(s.nodesChain[u]),c=!0;break}if(!c){var d=y(e,i,n,!0);for(a(d),u=1;u<t;u++)if(-1==o.indexOf(s.nodesChain[u].type)||u==t-1)if(0==r.length){r.push({newNode:d,nextNodeId:s.nodesChain[u-1].id,prevNodeId:s.nodesChain[u].id});for(var h=m.getNodeOutgoingConnections(s.nodesChain[u]),p=0,f=h.length;p<f;p++)h[p].target==l+s.nodesChain[u-1].id&&m.deleteConnectionByIdsOfElements(h[p],!0)}else{var g=r[r.length-1];r.push({newNode:d,nextNodeId:g.newNode.id,prevNodeId:g.prevNodeId}),g.prevNodeId=d.id}}},this.closeOneMailinglistWarningDialog=function(){jQuery(this.containerId+"-oneMailinglistWarning-dialog").dialog("close")},this.acceptOneMailinglistPerCampaign=function(){this.closeOneMailinglistWarningDialog(),f.mailingSpecificSaveAfterMailinglistCheckModal(v)},this.validateEditor=function(e){var i=jQuery(this.containerId+" .editor-error-messages");i.html(""),i.css("display","none");var n=!1;if(jQuery(this.containerId+" .delivery-settings").length){var o=jQuery(this.containerId+" [name='maxRecipients']").val();parseInt(o)!=o?(i.html(t("error.workflow.wrongMaxRecipientsFormat")),n=!0):parseInt(o)<0?(i.html(t("error.workflow.maxRecipientsLessThanZero")),n=!0):1e9<parseInt(o)&&(i.html(t("error.workflow.maxRecipientsTooBig")),n=!0)}jQuery(this.formNameJId+" "+this.selectNameJId).val()<=0&&(""!=i.html()&&i.html(i.html()+"<br>"),i.html(i.html()+t("error.workflow.noMailing")),n=!0),n?i.css("display","block"):e?e():f.saveCurrentEditor()},this.toggleSendSettings=function(e){"none"==jQuery("#sendSettings_"+e).css("display")?(jQuery("#sendSettingsToggle_"+e).removeClass("toggle_closed"),jQuery("#sendSettingsToggle_"+e).addClass("toggle_open")):(jQuery("#sendSettingsToggle_"+e).removeClass("toggle_open"),jQuery("#sendSettingsToggle_"+e).addClass("toggle_closed")),jQuery("#sendSettings_"+e).toggle("blind",200)},this.hideSendSettings=function(){jQuery(".wm-mailing-send-settings-link").removeClass("toggle_open"),jQuery(".wm-mailing-send-settings-link").addClass("toggle_closed"),jQuery(".wm-mailing-send-settings").css("display","none")},this.getParameterValue=function(e,t){if(4<e.length){for(var i=0;i<e.length/2;i++)if(i+1==t)return e.substring(2*i,2*(i+1))}else for(i=0;i<e.length/2;i++)if(e.substring(2*i,2*(i+1))==t)return e.substring(2*i,2*(i+1));return null};var y=function(e,t,i,n){for(var o=null;t=c(t,i),!1===(o=m.getCMNodes().addNode(e,t.x,t.y))&&n;);return o},c=function(e,t){return t==m.getCMNodes().LEFT?e.x--:t==m.getCMNodes().RIGHT?e.x++:t==m.getCMNodes().TOP?e.y--:t==m.getCMNodes().BOTTOM&&e.y++,e},g=function(e,t){var i=m.getCMNodes().getNodeIdPrefix();e&&(m.connectNodes(i+e.id,i+t,!0),m.justifyNodeElement(e))},b=function(e){var t=f.curEditingNode;f.curEditingNode=e,f.curEditor=f.editors[e.type],f.curEditor.fillEditor(e),f.saveCurrentEditor(),f.curEditingNode=t},u=function(e,t){var i=m.getCMNodes().TOP,n=m.getCMNodes().LEFT;return t&&(i=m.getCMNodes().BOTTOM,n=m.getCMNodes().RIGHT),-1==e.indexOf(n)?n:-1==e.indexOf(i)?i:n},d=function(e,t){var i=t.x-e.x,n=t.y-e.y;return 0<i&&0<=n&&n<=i||0<i&&n<0&&n<=i?m.getCMNodes().RIGHT:i<=0&&n<=0&&i<=n||i<0&&0<n&&i<=n?m.getCMNodes().LEFT:0<=i&&0<n&&i<n||i<0&&0<n&&i<n?m.getCMNodes().BOTTOM:0<=i&&n<0&&n<i||i<0&&n<0&&n<i?m.getCMNodes().TOP:void 0},h=function(i){jQuery(i.containerId+"-transfer-dialog").dialog({title:'<span class="dialog-fat-title">'+t("workflow.defaults.title")+"</span>",dialogClass:"no-close",open:function(e,t){w(i)},width:350,modal:!0,resizable:!1})};this.initOneMailinglistWarningDialog=function(e){jQuery(e.containerId+"-oneMailinglistWarning-dialog").dialog({title:'<span class="dialog-fat-title">'+e.getSelectedMailingOption().html()+"</span>",dialogClass:"no-close",width:350,modal:!0,resizable:!1})};var w=function(t){jQuery(t.containerId+"-transfer-dialog input[name^=transfer]").each(function(){jQuery(this).parent().parent().hide()});for(var e=a(t,!0),i=!1,n=0;n<e.length;n++)switch(e[n]){case t.PARAM_MAILING_LIST:jQuery(t.containerId+"-transferMailingList").parent().parent().show(),i=!0;break;case t.PARAM_TARGET_GROUPS:jQuery(t.containerId+"-transferTargetGroups").parent().parent().show(),i=!0;break;case t.PARAM_ARCHIVE:jQuery(t.containerId+"-transferArchive").parent().parent().show(),i=!0;break;case t.PARAM_LIST_SPLIT:jQuery(t.containerId+"-transferListSplit").parent().parent().show(),i=!0;break;case t.PARAM_PLANNED_DATE:jQuery(t.containerId+"-transferPlanedFor").parent().parent().show(),i=!0;break;case t.PARAM_SEND_DATE:jQuery(t.containerId+"-transferDeliveryTime").parent().parent().show(),i=!0}1==i&&jQuery(t.containerId+"-transferAllSettings").parent().parent().show(),jQuery(t.containerId+"-transferAllSettings").unbind().click(function(){var e=jQuery(this).prop("checked");jQuery(t.containerId+"-transferArchive").prop("checked",e),jQuery(t.containerId+"-transferMailingList").prop("checked",e),jQuery(t.containerId+"-transferPlanedFor").prop("checked",e),jQuery(t.containerId+"-transferDeliveryTime").prop("checked",e),jQuery(t.containerId+"-transferListSplit").prop("checked",e),jQuery(t.containerId+"-transferTargetGroups").prop("checked",e)})},C=function(e,t){for(var i=v,n=[],o=[],r=1;r<e.length;r++){var a=e[r].type;switch(n.push(a),a){case AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER:case AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE:case AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT:case AGN.Lib.WM.NodeFactory.NODE_TYPE_START:break;default:o.push(a)}}return(S(n,AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER)||S(t,i.PARAM_LIST_SPLIT))&&o.push(AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER),(S(n,AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE)||S(t,i.PARAM_ARCHIVE))&&o.push(AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE),(S(n,AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT)||S(t,i.PARAM_MAILING_LIST)||S(t,i.PARAM_TARGET_GROUPS))&&o.push(AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT),(S(n,AGN.Lib.WM.NodeFactory.NODE_TYPE_START)||S(t,i.PARAM_PLANNED_DATE)||S(t,i.PARAM_SEND_DATE))&&o.push(AGN.Lib.WM.NodeFactory.NODE_TYPE_START),o},_=function(e){return function(e){return null!=e.sendDate&&null!=e.sendDate&&null!=e.sendHour&&null!=e.sendMinute}(e)?new Date(e.sendDate+"T"+e.sendHour+":"+e.sendMinute+":00"):null},A=function(e){return function(e){return 0<e.planDate}(e)?new Date(e.planDate):null},E=function(e){return null==e?null:new Date(e.getFullYear(),e.getMonth(),e.getDate())},x=function(e,t){var i=e.targets,n=t.targetGroupIds;if(null==i&&null==n)return!0;if(i.length!=n.length)return!1;for(var o=0;o<n.length;o++)if(!S(i,n[o]))return!1;return!0},S=function(e,t){return-1!=e.indexOf(t)}},AGN.Lib.WM.MailingEditorBaseNew=function(e,m,r){this.MAILING_TYPE_ACTIONBASED=1,this.MAILING_TYPE_DATEBASED=2,this.MAILING_TYPE_FOLLOWUP=3,this.PARAM_MAILING_LIST=1,this.PARAM_TARGET_GROUPS=2,this.PARAM_ARCHIVE=3,this.PARAM_LIST_SPLIT=4,this.PARAM_PLANNED_DATE=5,this.PARAM_SEND_DATE=6,this.node={},this.mailingsStatus="all",this.defaultMailingsSort=e.defaultMailingsSort,this.defaultMailingsOrder=e.defaultMailingsOrder,this.mailingsSort=this.defaultMailingsSort,this.mailingsOrder=this.defaultMailingsOrder,this.formNameJId="form[name='"+e.form+"']",this.containerId=e.container,this.mailingType=e.mailingType,this.mailingTypesForLoading=e.mailingTypesForLoading,this.statusName=e.mailingStatus,this.selectName=e.selectName,this.selectNameJId="select[name="+e.selectName+"]",this.mailingId=0,this.showCreateEditLinks=e.showCreateEditLinks,this.dropDownEl=null,this.campaignManager=m,e.dropDownEl&&(this.dropDownEl=e.dropDownEl),this.isChangeDecisionOptions=e.isEnableTrackingVeto&&e.isFollowUpBaseMailing,this.followUpContainer=e.followUpContainer,this.advertisingAdditionalOptions=e.advertisingAdditionalOptions,this.advertisingUrl=e.advertisingUrl,this.nodesChain=[],this.mailingData={},this.configuredMailingData=null;var v=this,f=m.getEditorsHelper();this.fillEditorBase=function(e){this.node=e,this.mailingsStatus=$(this.formNameJId).find("input[checked=checked]").val()||"all",this.mailingsSort=this.defaultMailingsSort,this.mailingsOrder=this.defaultMailingsOrder,this.cleanOptions(),this.hideSendSettings(),this.changeDecisionOptionsSet($(this.containerId),this.isChangeDecisionOptions)},this.cleanOptions=function(){this.setDefaultSortOptions(),jQuery(this.containerId+" #"+this.statusName+"_all").attr("checked","checked"),this.activateInputs(),this.setSelectMailingOptions(this.node.data[this.selectName]),this.getMailingsByWorkStatus(this.mailingsStatus,this.mailingsSort,this.mailingsOrder,this.node.data.mailingId)},this.setDefaultSortOptions=function(){this.mailingsSort=this.defaultMailingsSort,this.mailingsOrder=this.defaultMailingsOrder,jQuery(this.containerId+" .arrowUp").hide(),jQuery(this.containerId+" .arrowDown").hide(),jQuery(this.containerId+" #shortname_sort").attr("press",1),jQuery(this.containerId+" #change_date_sort").attr("press",2),this.mailingType==this.MAILING_TYPE_ACTIONBASED||this.mailingType==this.MAILING_TYPE_DATEBASED?jQuery(this.containerId+" #shortname_sort .arrowUp").show():jQuery(this.containerId+" #change_date_sort .arrowDown").show()},this.onMailingsStatusChange=function(e){this.setSelectMailingOptions(0),this.getMailingsByWorkStatus(e,this.mailingsSort,this.mailingsOrder),this.changeDecisionOptionsSet($(this.containerId),this.isChangeDecisionOptions)},this.onMailingSelectChange=function(e){this.setSelectMailingOptions(e),this.changeDecisionOptionsSet($(this.containerId),this.isChangeDecisionOptions)},this.changeDecisionOptionsSet=function(e,t){if(t){var i=this.mailingId,n=$(e.find(this.followUpContainer)),o=this.advertisingAdditionalOptions,r=this.advertisingUrl;jQuery.ajax({action:"POST",url:r,data:{mailingId:i},success:function(e){if($(n.find(".advertisingOption")).remove(),e.isAdvertisingContentType){var t=AGN.Lib.Template.text("followupAdvertisingOptions",{items:o});n.append(t)}}})}},this.onMailingSortClick=function(e,t){jQuery(this.containerId+" .arrowUp").hide(),jQuery(this.containerId+" .arrowDown").hide();var i=jQuery(this.containerId+" .sort"),n=this.containerId+" #"+e+"_sort",o=jQuery(n),r=jQuery(n+" .arrowUp"),a=jQuery(n+" .arrowDown"),s=o.attr("press"),l=jQuery(this.formNameJId+" "+this.selectNameJId).val();if(s)switch(s){case"1":o.attr("press",2),a.show(),this.mailingsOrder="DESC";break;case"2":o.attr("press",1),r.show(),this.mailingsOrder="ASC"}else i.attr("press",2),o.attr("press",2),r.show(),this.mailingsOrder="ASC";this.getMailingsByWorkStatus(this.mailingsStatus,t,this.mailingsOrder,l)},this.setMailingId=function(e){this.mailingId=e,this.dropDownEl&&(0<this.mailingId?this.dropDownEl.show():this.dropDownEl.hide())},this.setSelectMailingOptions=function(e){this.setMailingId(e),this.showCreateEditLinks&&this.setMailingLinks(e)},this.setMailingLinks=function(e){var i="";i="0"!=e?'<span style="font-weight: bold;">'+t("workflow.mailing.tip")+': &nbsp;</span><a href="#" data-action="mailing-editor-edit">'+t("workflow.mailing.edit_mailing_link")+"</a> ":'<a href="#" class="setting-mailing-left" data-action="mailing-editor-new"> '+t("workflow.mailing.new")+"</a>";var n=jQuery(this.containerId+" #mailing_create_edit_link");n.html(""),n.append(i)},this.showSecurityQuestion=function(){if(this.setSecurityQuestion(),this.setIsUsedInCMAttr(),this.isSentMailing(this.mailingIsSent)||this.mailingIsUsedInCM){var e=this.getSelectedMailingOption();return $(this.containerId+"-security-dialog").dialog({title:'<span class="dialog-fat-title">'+e.html()+"</span>",dialogClass:"no-close",open:function(e,t){},width:650,modal:!0,resizable:!1}),!1}return!0},this.isSentMailing=function(e){return"mailing.status.sent"==e||"mailing.status.scheduled"==e||"mailing.status.norecipients"==e},this.cancelSecurityDialog=function(){jQuery(this.containerId+"-security-dialog").dialog("close")},this.getMailingsByWorkStatus=function(i,n,o,r){var a=this,s=$(this.formNameJId+" "+this.selectNameJId);s.attr("readonly","readonly"),jQuery.ajax({type:"POST",url:AGN.url("/workflow/getMailingsByWorkStatus.action"),data:{mailingTypes:this.mailingTypesForLoading.join(","),status:i,sort:n,order:o},success:function(e){s.empty(),s.append($("<option></option>",{value:0,text:t("workflow.defaults.no_mailing")})),e.forEach(function(e){var t=$("<option></option>",{value:e.MAILING_ID,text:e.SHORTNAME,selected:r==e.MAILING_ID});a.isSentMailing(e.WORK_STATUS)&&t.css("color","#808080"),t.attr({status:e.WORK_STATUS,senddate:e.SENDDATE}),t.data({status:e.WORK_STATUS,"send-date":e.SENDDATE,"dependent-campaigns":e.USEDINWORKFLOWS||""}),s.append(t)}),s.removeAttr("readonly"),a.mailingsStatus=i,a.mailingsSort=n,a.mailingsOrder=o,s.val(a.mailingId),f.initSelectWithValueOrChooseFirst(s,a.mailingId)}})},this.disableInputs=function(){jQuery(this.containerId+" [name='"+this.statusName+"']").attr("disabled","disabled")},this.activateInputs=function(){jQuery(this.containerId+" [name='"+this.statusName+"']").removeAttr("disabled")},this.setNodeFields=function(){var e=this.getSelectedMailingOption();this.setNodeFilled(e),this.setNodeIconTitle(e)},this.setNodeFilled=function(e){this.node.filled=!1,0<parseInt(this.mailingId,10)&&(this.node.filled=!0)},this.setNodeIconTitle=function(e){this.node.iconTitle="",0<parseInt(this.mailingId,10)&&(this.node.iconTitle=e.html())},this.setSecurityQuestion=function(){var e=this.getSelectedMailingOption();this.mailingIsSent="",0<parseInt(this.mailingId,10)&&(this.mailingIsSent=e.data("status"))},this.setIsUsedInCMAttr=function(){var e=this.getSelectedMailingOption(),t=e.data("dependent-campaigns"),i=e.val();if(this.mailingIsUsedInCM=!1,0<parseInt(this.mailingId,10)&&i==this.mailingId&&t){var n=this.campaignManager.workflowId||0,o=t.split(",");0<o.length&&(this.mailingIsUsedInCM=!(0<n)||o.indexOf(n.toString())<0)}},this.getSelectedMailingOption=function(){return jQuery(this.formNameJId+" "+this.selectNameJId+" option[value="+this.mailingId+"]")},this.getSelectedDecisionOption=function(){var e="decisionCriterion",t=jQuery(this.formNameJId+" select[name='"+e+"']").val();return jQuery(this.formNameJId+" select[name='"+e+"'] option[value="+t+"]")},this.createNewMailing=function(e){o({iconId:this.node.id,successCallback:i,forwardName:e,mailingEditorBase:this})};var i=function(e,i,n){if(e.hasMailingList){var o=[];o.push("mailingType="+n.mailingType),n.mailingType==n.MAILING_TYPE_FOLLOWUP&&(o.push("workflowFollowUpParentMailing="+n.node.data.baseMailingId),o.push("workflowFollowUpDecisionCriterion="+n.node.data.decisionCriterion)),f.processForward(i,n.formNameJId+" "+n.selectNameJId,[],r,o.join(";"))}else jQuery(n.containerId+" .editor-error-messages").html(t("error.workflow.notAddedMailingList")),jQuery(n.containerId+" .editor-error-messages").css("display","block")};this.processCopyAndEditMailingForward=function(e,t,i,n){jQuery("#forwardTargetItemId").val(e);var o=[];this.mailingType==this.MAILING_TYPE_FOLLOWUP&&(o.push("workflowFollowUpParentMailing="+this.node.data.baseMailingId),o.push("workflowFollowUpDecisionCriterion="+this.node.data.decisionCriterion)),0<o.length?f.processForward(t,i+" "+n,[],r,o.join(";")):f.processForward(t,i+" "+n,[],r)},this.editMailing=function(e){this.processCopyAndEditMailingForward(this.mailingId,e,this.formNameJId,this.selectNameJId)},this.copyMailing=function(e){this.processCopyAndEditMailingForward(this.mailingId,e,this.formNameJId,this.selectNameJId)},this.trySupplementNodes=function(e){var t=m.getIncomingChainsForIcon();if(0<t.length){var i=t[0];this.configuredMailingData=s(i),this.nodesChain=i,this.mailingData=e,n(this)}},this.checkDifferentMailingLists=function(e,o,r){var a=this;l(e,function(e){var t=m.getIncomingChainsForIcon()[0];a.configuredMailingData=s(t),a.nodesChain=t,a.mailingData=e;var i=0;t.forEach(function(e){e.type==AGN.Lib.WM.NodeFactory.NODE_TYPE_MAILING&&i++});var n=a.configuredMailingData.mailinglistId;1<i&&0!=n&&n!=e.mailinglistId?r(e):o(e)})};var s=function(e){for(var t={parameterValue:0,campaignId:0,mailinglistId:0,targets:[],date:null},i=e.length-1;0<=i;i--){var n=e[i].data;switch(e[i].type){case AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER:t.parameterValue=n.value;break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE:t.campaignId=n.campaignId;break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT:if(0==t.mailinglistId&&(t.mailinglistId=n.mailinglistId),null!==n.targets)for(var o=0;o<n.targets.length;o++)S(t.targets,n.targets[o])||t.targets.push(parseInt(n.targets[o]));break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_START:n.date?(t.date=E(n.date),t.date.setHours(n.hour),t.date.setMinutes(n.minute)):t.date=null;break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_DEADLINE:n.deadlineType==constants.deadlineTypeFixedDeadline?n.date?(t.date=E(n.date),t.date.setHours(n.hour),t.date.setMinutes(n.minute)):t.date=null:n.deadlineType==constants.deadlineTypeDelay&&null!=t.date&&(n.timeUnit==constants.deadlineTimeUnitMinute?t.date.setMinutes(t.date.getMinutes()+parseInt(n.delayValue)):n.timeUnit==constants.deadlineTimeUnitHour?t.date.setHours(t.date.getHours()+parseInt(n.delayValue)):n.timeUnit==constants.deadlineTimeUnitDay&&(t.date.setDate(t.date.getDate()+parseInt(n.delayValue)),!n.useTime&&"true"!=n.useTime||(t.date.setMinutes(t.date.getMinutes()+parseInt(n.minute)),t.date.setHours(t.date.getHours()+parseInt(n.hour)))))}}return t},n=function(){0<a(v,!0).length?h(v):v.supplementNewOrUpdateExistingNodes()},a=function(e,t){var i=e.configuredMailingData,n=e.mailingData,o=[],r=[],a=[];0==n.mailinglistId?a.push(e.PARAM_MAILING_LIST):0==i.mailinglistId?o.push(e.PARAM_MAILING_LIST):i.mailinglistId!=n.mailinglistId&&(t?r.push(e.PARAM_MAILING_LIST):o.push(e.PARAM_MAILING_LIST));var s=i.targets,l=n.targetGroupIds;null==l||0==l.length?a.push(e.PARAM_TARGET_GROUPS):null==s||0==s.length?o.push(e.PARAM_TARGET_GROUPS):x(i,n)||(t?r.push(e.PARAM_TARGET_GROUPS):o.push(e.PARAM_TARGET_GROUPS));var c=e.getParameterValue(n.splitBase,n.splitPart);null==c?a.push(e.PARAM_LIST_SPLIT):0==i.parameterValue?o.push(e.PARAM_LIST_SPLIT):i.parameterValue!=c&&(t?r.push(e.PARAM_LIST_SPLIT):o.push(e.PARAM_LIST_SPLIT)),0==n.campaignId?a.push(e.PARAM_ARCHIVE):0==i.campaignId?o.push(e.PARAM_ARCHIVE):i.campaignId!=n.campaignId&&(t?r.push(e.PARAM_ARCHIVE):o.push(e.PARAM_ARCHIVE));var u=i.date,d=A(n),h=_(n);return null==d&&null==h?a.push(e.PARAM_PLANNED_DATE):null==u?null!=d?o.push(e.PARAM_PLANNED_DATE):o.push(e.PARAM_SEND_DATE):(E(d)>E(u)?t?r.push(e.PARAM_PLANNED_DATE):o.push(e.PARAM_PLANNED_DATE):d&&E(d)<E(u)&&a.push(e.PARAM_PLANNED_DATE),u<h?t?r.push(e.PARAM_SEND_DATE):o.push(e.PARAM_SEND_DATE):h&&h<u&&a.push(e.PARAM_SEND_DATE)),p(e,a),t?r:o},p=function(e,t){for(var i=e.configuredMailingData,n=e.mailingData,o=0;o<t.length;o++)switch(t[o]){case e.PARAM_MAILING_LIST:n.mailinglistId=i.mailinglistId;break;case e.PARAM_TARGET_GROUPS:n.targetGroupIds=i.targets;break;case e.PARAM_ARCHIVE:n.campaignId=i.campaignId;break;case e.PARAM_LIST_SPLIT:n.splitBase="",n.splitPart="";break;case e.PARAM_PLANNED_DATE:var r=E(i.date);n.planDate=r?r.getTime():0;break;case e.PARAM_SEND_DATE:n.sendDate=E(i.date),i.date&&(n.sendHour=i.date.getHours(),n.sendMinute=i.date.getMinutes())}},l=function(e,t){jQuery.ajax({type:"POST",url:AGN.url("/workflow/getMailingContent.action"),data:{mailingId:e},success:function(e){t(e)}})},o=function(e){var t=e.iconId||f.curEditingNode.id,i=e.successCallback,n=e.forwardName,o=m.getIconsForSubmission(),s={},l={};o.forEach(function(n){(s[n.id]=n).connections&&n.connections.forEach(function(e){var t=n.id,i=e.targetIconId;l[i]||(l[i]={}),l[i][t]=!0})}),i({hasMailingList:function(e){for(var t=Object.keys(l[e]||{}),i={};0<t.length;){var n=t;t=[];for(var o=0;o<n.length;o++){var r=n[o],a=s[r];if(a.type===AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT)return 0<a.mailinglistId;i[r]=!0,Object.keys(l[r]||{}).forEach(function(e){i[e]||t.push(e)})}}return!1}(t)},n,e.mailingEditorBase)};this.closeTransferDialog=function(){jQuery(this.containerId+"-transfer-dialog").dialog("close")},this.transferMailingData=function(){var i=a(v,!0),n=[],o=v;jQuery(this.containerId+"-transfer-dialog input[name^=transfer]").each(function(){var e=jQuery(this);if(!e[0].checked){var t=null;switch(e.attr("name")){case"transferPlanedFor":t=o.PARAM_PLANNED_DATE;break;case"transferMailingList":t=o.PARAM_MAILING_LIST;break;case"transferTargetGroups":t=o.PARAM_TARGET_GROUPS;break;case"transferArchive":t=o.PARAM_ARCHIVE;break;case"transferListSplit":t=o.PARAM_LIST_SPLIT;break;case"transferDeliveryTime":t=o.PARAM_SEND_DATE}t&&S(i,t)&&n.push(t)}}),p(v,n),v.supplementNewOrUpdateExistingNodes(),this.closeTransferDialog()},this.transferRequiredMailingData=function(){var e=a(this,!0);p(this,e),this.supplementNewOrUpdateExistingNodes(),this.closeTransferDialog()},this.supplementNewOrUpdateExistingNodes=function(){var e=u(f.curEditingNode.usedAnchors,!1);1<this.nodesChain.length&&(e=d(f.curEditingNode,this.nodesChain[1]));for(var t=[AGN.Lib.WM.NodeFactory.NODE_TYPE_MAILING,AGN.Lib.WM.NodeFactory.NODE_TYPE_ACTION_BASED_MAILING,AGN.Lib.WM.NodeFactory.NODE_TYPE_DATE_BASED_MAILING,AGN.Lib.WM.NodeFactory.NODE_TYPE_FOLLOWUP_MAILING],i=0,n=1;n<this.nodesChain.length;n++)if(0<=t.indexOf(this.nodesChain[n].type)){i=n;break}var o=a(this,!1);0<i?this.supplementNodesBetweenMailings(o,i,e):this.supplementNodesBeforeMailing(o,e)},this.supplementNodesBetweenMailings=function(i,e,t){var n=v,o={x:f.curEditingNode.x,y:f.curEditingNode.y},r=[],a=n.mailingData;if(S(i,this.PARAM_LIST_SPLIT)){var s=AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER,l=0<e?e:n.nodesChain.length,c=[];this.updateExistingOrAddNewNodeForThanOneValue(s,l,o,t,c,r,function(e){e.data.value=n.getParameterValue(a.splitBase,a.splitPart)})}S(i,this.PARAM_ARCHIVE)&&(s=AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE,l=0<e?e:n.nodesChain.length,c=[AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER],this.updateExistingOrAddNewNodeForThanOneValue(s,l,o,t,c,r,function(e){e.data.campaignId=a.campaignId})),(S(i,this.PARAM_MAILING_LIST)||S(i,this.PARAM_TARGET_GROUPS))&&(s=AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT,l=0<e?e:n.nodesChain.length,c=[AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER,AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE],this.updateExistingOrAddNewNodeForThanOneValue(s,l,o,t,c,r,function(e){S(i,n.PARAM_MAILING_LIST)&&(e.data.mailinglistId=a.mailinglistId,e.isDependent=!0),S(i,n.PARAM_TARGET_GROUPS)&&(e.data.targets=a.targetGroupIds,e.data.targetsOption="ONE_TARGET_REQUIRED")})),(S(i,this.PARAM_PLANNED_DATE)||S(i,this.PARAM_SEND_DATE))&&(s=AGN.Lib.WM.NodeFactory.NODE_TYPE_DEADLINE,l=0<e?e:n.nodesChain.length,c=[AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER,AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE,AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT],this.updateExistingOrAddNewNodeForThanOneValue(s,l,o,t,c,r,function(e){if(S(i,n.PARAM_PLANNED_DATE)){e.data.date=A(n.mailingData);var t=n.configuredMailingData.date;t&&(e.data.date.setHours(t.getHours()),e.data.date.setMinutes(t.getMinutes()))}else S(i,n.PARAM_SEND_DATE)&&(e.data.date=_(n.mailingData));e.data.deadlineType=constants.deadlineTypeFixedDeadline,e.data.hour=e.data.date.getHours(),e.data.minute=e.data.date.getMinutes()}));var u=m.getCMNodes().getNodeIdPrefix();if(0<r.length){var d=m.getCurrentState();m.setCurrentState(m.STATE_AUTOMATICALLY_CREATING_CONNECTION);for(var h=0;h<r.length;h++)g(r[h].newNode,r[h].nextNodeId),g(m.getCMNodes().getNodeById(u+r[h].prevNodeId),r[h].newNode.id),b(r[h].newNode);m.setCurrentState(d)}},this.supplementNodesBeforeMailing=function(n,e){var o=v,t=C(this.nodesChain,n);if(this.nodesChain.length-1<t.length)for(var i=1;i<this.nodesChain.length;i++)m.deleteNode(m.getCMNodes().getNodeIdPrefix()+this.nodesChain[i].id,!0,!0);for(var r={x:f.curEditingNode.x,y:f.curEditingNode.y},a={nextNode:f.curEditingNode},s=!1,l=[],c=0;c<t.length;c++)switch(s=!1,t[c]){case AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER:for(var u=0;u<this.nodesChain.length;u++)if(this.nodesChain[u].type==AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER){s=!0;break}(S(n,this.PARAM_LIST_SPLIT)||s)&&(d=this.updateExistingOrAddNewNode(a,r,e,AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER,function(e,t){t&&(e.data=t.data),S(n,o.PARAM_LIST_SPLIT)&&(e.data.value=o.getParameterValue(o.mailingData.splitBase,o.mailingData.splitPart),b(e))}))&&l.push(d);break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE:for(u=0;u<this.nodesChain.length;u++)if(this.nodesChain[u].type==AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE){s=!0;break}(S(n,this.PARAM_ARCHIVE)||s)&&(d=this.updateExistingOrAddNewNode(a,r,e,AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE,function(e,t){t&&(e.data=t.data),S(n,o.PARAM_ARCHIVE)&&(e.data.campaignId=o.mailingData.campaignId,b(e))}))&&l.push(d);break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT:for(u=0;u<this.nodesChain.length;u++)if(this.nodesChain[u].type==AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT){s=!0;break}(S(n,this.PARAM_MAILING_LIST)||S(n,this.PARAM_TARGET_GROUPS)||s)&&(d=this.updateExistingOrAddNewNode(a,r,e,AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT,function(e,t){t&&(e.data=t.data),S(n,o.PARAM_MAILING_LIST)&&(e.data.mailinglistId=o.mailingData.mailinglistId,b(e)),S(n,o.PARAM_TARGET_GROUPS)&&(e.data.targets=o.mailingData.targetGroupIds,e.data.targetsOption="ONE_TARGET_REQUIRED",b(e))}))&&l.push(d);break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_START:for(u=0;u<this.nodesChain.length;u++)if(this.nodesChain[u].type==AGN.Lib.WM.NodeFactory.NODE_TYPE_START){s=!0;break}(0==m.getCMNodes().getNodesByType(AGN.Lib.WM.NodeFactory.NODE_TYPE_START).length&&this.mailingData.mailingType!=this.MAILING_TYPE_ACTIONBASED&&this.mailingData.mailingType!=this.MAILING_TYPE_DATEBASED&&(S(n,this.PARAM_PLANNED_DATE)||S(n,this.PARAM_SEND_DATE))||s)&&(d=this.updateExistingOrAddNewNode(a,r,e,AGN.Lib.WM.NodeFactory.NODE_TYPE_START,function(e,t){if(t&&(e.filled=t.filled,e.data=t.data),S(n,o.PARAM_PLANNED_DATE)){e.data.date=A(o.mailingData);var i=o.configuredMailingData.date;i&&(e.data.hour=i.getHours(),e.data.minute=i.getMinutes()),b(e)}else S(n,o.PARAM_SEND_DATE)&&(e.data.date=_(o.mailingData),e.data.hour=e.data.date.getHours(),e.data.minute=e.data.date.getMinutes(),b(e))}))&&l.push(d);break;default:for(u=0;u<this.nodesChain.length;u++)if(this.nodesChain[u].type==t[c]){s=!0;break}var d;s&&(d=this.updateExistingOrAddNewNode(a,r,e,t[c],function(e,t){t&&(e.data=t.data,b(e))}))&&l.push(d)}if(0<l.length){var h=m.getCurrentState();for(m.setCurrentState(m.STATE_AUTOMATICALLY_CREATING_CONNECTION),u=0;u<l.length;u++){g(l[u].node,l[u].nextNode.id);var p=!1;switch(l[u].node.type){case AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER:0!=l[u].node.data.value&&(p=!0);break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE:0<l[u].node.data.campaignId&&(p=!0);break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT:(0<l[u].node.data.mailinglistId||0<l[u].node.data.targets.length)&&(p=!0);break;case AGN.Lib.WM.NodeFactory.NODE_TYPE_START:null!=l[u].node.data.date&&(p=!0)}p?b(l[u].node):m.updateNode(l[u].node)}m.setCurrentState(h)}},this.updateExistingOrAddNewNode=function(e,t,i,n,o){for(var r=!1,a=!1,s=m.getCMNodes().getNodeIdPrefix(),l=0;l<this.nodesChain.length;l++)if(this.nodesChain[l].type==n){if(m.getCMNodes().getNodeById(s+this.nodesChain[l].id))return o(this.nodesChain[l],!1),r=!0,e.nextNode=this.nodesChain[l],null;a=this.nodesChain[l]}if(!r){var c=y(n,t,i,!0);o(c,a||!1);var u={nextNode:e.nextNode,node:c};e.nextNode=c}return u},this.updateExistingOrAddNewNodeForThanOneValue=function(e,t,i,n,o,r,a){for(var s=v,l=m.getCMNodes().getNodeIdPrefix(),c=!1,u=1;u<t;u++)if(s.nodesChain[u].type==e){a(s.nodesChain[u]),b(s.nodesChain[u]),c=!0;break}if(!c){var d=y(e,i,n,!0);for(a(d),u=1;u<t;u++)if(-1==o.indexOf(s.nodesChain[u].type)||u==t-1)if(0==r.length){r.push({newNode:d,nextNodeId:s.nodesChain[u-1].id,prevNodeId:s.nodesChain[u].id});for(var h=m.getNodeOutgoingConnections(s.nodesChain[u]),p=0,f=h.length;p<f;p++)h[p].target==l+s.nodesChain[u-1].id&&m.deleteConnectionByIdsOfElements(h[p],!0)}else{var g=r[r.length-1];r.push({newNode:d,nextNodeId:g.newNode.id,prevNodeId:g.prevNodeId}),g.prevNodeId=d.id}}},this.closeOneMailinglistWarningDialog=function(){jQuery(this.containerId+"-oneMailinglistWarning-dialog").dialog("close")},this.acceptOneMailinglistPerCampaign=function(){this.closeOneMailinglistWarningDialog(),f.mailingSpecificSaveAfterMailinglistCheckModal(v)},this.validateEditor=function(e){var i=jQuery(this.containerId+" .editor-error-messages");i.html(""),i.css("display","none");var n=!1;if(jQuery(this.containerId+" .delivery-settings").length){var o=jQuery(this.containerId+" [name='maxRecipients']").val();parseInt(o)!=o?(i.html(t("error.workflow.wrongMaxRecipientsFormat")),n=!0):parseInt(o)<0?(i.html(t("error.workflow.maxRecipientsLessThanZero")),n=!0):1e9<parseInt(o)&&(i.html(t("error.workflow.maxRecipientsTooBig")),n=!0)}jQuery(this.formNameJId+" "+this.selectNameJId).val()<=0&&(""!=i.html()&&i.html(i.html()+"<br>"),i.html(i.html()+t("error.workflow.noMailing")),n=!0),n?i.css("display","block"):e?e():f.saveCurrentEditor()},this.toggleSendSettings=function(e){"none"==jQuery("#sendSettings_"+e).css("display")?(jQuery("#sendSettingsToggle_"+e).removeClass("toggle_closed"),jQuery("#sendSettingsToggle_"+e).addClass("toggle_open")):(jQuery("#sendSettingsToggle_"+e).removeClass("toggle_open"),jQuery("#sendSettingsToggle_"+e).addClass("toggle_closed")),jQuery("#sendSettings_"+e).toggle("blind",200)},this.hideSendSettings=function(){jQuery(".wm-mailing-send-settings-link").removeClass("toggle_open"),jQuery(".wm-mailing-send-settings-link").addClass("toggle_closed"),jQuery(".wm-mailing-send-settings").css("display","none")},this.getParameterValue=function(e,t){if(4<e.length){for(var i=0;i<e.length/2;i++)if(i+1==t)return e.substring(2*i,2*(i+1))}else for(i=0;i<e.length/2;i++)if(e.substring(2*i,2*(i+1))==t)return e.substring(2*i,2*(i+1));return null};var y=function(e,t,i,n){for(var o=null;t=c(t,i),!1===(o=m.getCMNodes().addNode(e,t.x,t.y))&&n;);return o},c=function(e,t){return t==m.getCMNodes().LEFT?e.x--:t==m.getCMNodes().RIGHT?e.x++:t==m.getCMNodes().TOP?e.y--:t==m.getCMNodes().BOTTOM&&e.y++,e},g=function(e,t){var i=m.getCMNodes().getNodeIdPrefix();e&&(m.connectNodes(i+e.id,i+t,!0),m.justifyNodeElement(e))},b=function(e){var t=f.curEditingNode;f.curEditingNode=e,f.curEditor=f.editors[e.type],f.curEditor.fillEditor(e),f.saveCurrentEditor(),f.curEditingNode=t},u=function(e,t){var i=m.getCMNodes().TOP,n=m.getCMNodes().LEFT;return t&&(i=m.getCMNodes().BOTTOM,n=m.getCMNodes().RIGHT),-1==e.indexOf(n)?n:-1==e.indexOf(i)?i:n},d=function(e,t){var i=t.x-e.x,n=t.y-e.y;return 0<i&&0<=n&&n<=i||0<i&&n<0&&n<=i?m.getCMNodes().RIGHT:i<=0&&n<=0&&i<=n||i<0&&0<n&&i<=n?m.getCMNodes().LEFT:0<=i&&0<n&&i<n||i<0&&0<n&&i<n?m.getCMNodes().BOTTOM:0<=i&&n<0&&n<i||i<0&&n<0&&n<i?m.getCMNodes().TOP:void 0},h=function(i){jQuery(i.containerId+"-transfer-dialog").dialog({title:'<span class="dialog-fat-title">'+t("workflow.defaults.title")+"</span>",dialogClass:"no-close",open:function(e,t){w(i)},width:350,modal:!0,resizable:!1})};this.initOneMailinglistWarningDialog=function(e){jQuery(e.containerId+"-oneMailinglistWarning-dialog").dialog({title:'<span class="dialog-fat-title">'+e.getSelectedMailingOption().html()+"</span>",dialogClass:"no-close",width:350,modal:!0,resizable:!1})};var w=function(t){jQuery(t.containerId+"-transfer-dialog input[name^=transfer]").each(function(){jQuery(this).parent().parent().hide()});for(var e=a(t,!0),i=!1,n=0;n<e.length;n++)switch(e[n]){case t.PARAM_MAILING_LIST:jQuery(t.containerId+"-transferMailingList").parent().parent().show(),i=!0;break;case t.PARAM_TARGET_GROUPS:jQuery(t.containerId+"-transferTargetGroups").parent().parent().show(),i=!0;break;case t.PARAM_ARCHIVE:jQuery(t.containerId+"-transferArchive").parent().parent().show(),i=!0;break;case t.PARAM_LIST_SPLIT:jQuery(t.containerId+"-transferListSplit").parent().parent().show(),i=!0;break;case t.PARAM_PLANNED_DATE:jQuery(t.containerId+"-transferPlanedFor").parent().parent().show(),i=!0;break;case t.PARAM_SEND_DATE:jQuery(t.containerId+"-transferDeliveryTime").parent().parent().show(),i=!0}1==i&&jQuery(t.containerId+"-transferAllSettings").parent().parent().show(),jQuery(t.containerId+"-transferAllSettings").unbind().click(function(){var e=jQuery(this).prop("checked");jQuery(t.containerId+"-transferArchive").prop("checked",e),jQuery(t.containerId+"-transferMailingList").prop("checked",e),jQuery(t.containerId+"-transferPlanedFor").prop("checked",e),jQuery(t.containerId+"-transferDeliveryTime").prop("checked",e),jQuery(t.containerId+"-transferListSplit").prop("checked",e),jQuery(t.containerId+"-transferTargetGroups").prop("checked",e)})},C=function(e,t){for(var i=v,n=[],o=[],r=1;r<e.length;r++){var a=e[r].type;switch(n.push(a),a){case AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER:case AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE:case AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT:case AGN.Lib.WM.NodeFactory.NODE_TYPE_START:break;default:o.push(a)}}return(S(n,AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER)||S(t,i.PARAM_LIST_SPLIT))&&o.push(AGN.Lib.WM.NodeFactory.NODE_TYPE_PARAMETER),(S(n,AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE)||S(t,i.PARAM_ARCHIVE))&&o.push(AGN.Lib.WM.NodeFactory.NODE_TYPE_ARCHIVE),(S(n,AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT)||S(t,i.PARAM_MAILING_LIST)||S(t,i.PARAM_TARGET_GROUPS))&&o.push(AGN.Lib.WM.NodeFactory.NODE_TYPE_RECIPIENT),(S(n,AGN.Lib.WM.NodeFactory.NODE_TYPE_START)||S(t,i.PARAM_PLANNED_DATE)||S(t,i.PARAM_SEND_DATE))&&o.push(AGN.Lib.WM.NodeFactory.NODE_TYPE_START),o},_=function(e){return function(e){return null!=e.sendDate&&null!=e.sendDate&&null!=e.sendHour&&null!=e.sendMinute}(e)?new Date(e.sendDate+"T"+e.sendHour+":"+e.sendMinute+":00"):null},A=function(e){return function(e){return 0<e.planDate}(e)?new Date(e.planDate):null},E=function(e){return null==e?null:new Date(e.getFullYear(),e.getMonth(),e.getDate())},x=function(e,t){var i=e.targets,n=t.targetGroupIds;if(null==i&&null==n)return!0;if(i.length!=n.length)return!1;for(var o=0;o<n.length;o++)if(!S(i,n[o]))return!1;return!0},S=function(e,t){return-1!=e.indexOf(t)}},AGN.Lib.WM.MailingSelectorBaseNew=function(e,i,n,o,r,a){this.formNameJId="form[name='"+e+"']",this.container=i,this.pageContextSessionId=n,this.selectNameJId="select[name="+o+"]",this.defaultSortField="date",this.mailingId=0,this.noMailingOption=r,this.editorsHelper=a,this.cleanOptions=function(e){null==e&&(e=0),jQuery(this.container+" .sort").prop("press",e),this.onMailingSortClick(this.defaultSortField)},this.onMailingSelectChange=function(e){},this.onMailingSortClick=function(e){jQuery(this.container+" .arrowUp").hide(),jQuery(this.container+" .arrowDown").hide();var t=jQuery(this.container+" .sort"),i=this.container+" #"+e+"_sort",n=jQuery(i),o=jQuery(i+" .arrowUp"),r=jQuery(i+" .arrowDown"),a=parseInt(n.prop("press")),s="asc";switch(t.prop("press",0),a){case 0:n.prop("press",1),o.show(),s="asc";break;case 1:n.attr("press",2),r.show(),s="desc";break;case 2:n.prop("press",1),o.show(),s="asc"}this.getAllMailingSorted(e,s)},this.setMailingId=function(e){this.mailingId=e},this.getAllMailingSorted=function(e,i){var n=this,o=jQuery(this.formNameJId+" "+this.selectNameJId),r=o.val();null!=r&&(n.mailingId=r),o.attr("readonly","readonly"),jQuery.ajax({type:"POST",url:AGN.url("/workflow/getAllMailingSorted.action"),data:{sortField:e,sortDirection:i},success:function(e){o.html(""),n.noMailingOption&&o.append('<option value="0">'+t("workflow.defaults.no_mailing")+"</option>");for(var i=0;i<e.length;i++)o.append("<option  value='"+e[i].mailingID+"'>"+e[i].shortname+"</option>");o.removeAttr("readonly"),0==n.mailingId&&0==n.noMailingOption&&0<e.length?o.val(e[0].mailingID):o.val(n.mailingId),a.initSelectWithValueOrChooseFirst(o,o.val())}})},this.getSelectedMailingOption=function(){return jQuery(this.formNameJId+" "+this.selectNameJId+" option[value="+this.mailingId+"]")}},AGN.Lib.WM.MailingSelectorBase=function(e,i,n,o,r,a){this.formNameJId="form[name='"+e+"']",this.container=i,this.pageContextSessionId=n,this.selectNameJId="select[name="+o+"]",this.defaultSortField="date",this.mailingId=0,this.noMailingOption=r,this.editorsHelper=a,this.cleanOptions=function(e){null==e&&(e=0),jQuery(this.container+" .sort").prop("press",e),this.onMailingSortClick(this.defaultSortField)},this.onMailingSelectChange=function(e){},this.onMailingSortClick=function(e){jQuery(this.container+" .arrowUp").hide(),jQuery(this.container+" .arrowDown").hide();var t=jQuery(this.container+" .sort"),i=this.container+" #"+e+"_sort",n=jQuery(i),o=jQuery(i+" .arrowUp"),r=jQuery(i+" .arrowDown"),a=parseInt(n.prop("press")),s="asc";switch(t.prop("press",0),a){case 0:n.prop("press",1),o.show(),s="asc";break;case 1:n.attr("press",2),r.show(),s="desc";break;case 2:n.prop("press",1),o.show(),s="asc"}this.getAllMailingSorted(e,s)},this.setMailingId=function(e){this.mailingId=e},this.getAllMailingSorted=function(e,i){var n=this,o=jQuery(this.formNameJId+" "+this.selectNameJId),r=o.val();null!=r&&(n.mailingId=r),o.attr("readonly","readonly"),jQuery.ajax({type:"POST",url:"workflow.do;jsessionid="+this.pageContextSessionId,data:{method:"getAllMailingSorted",sortField:e,sortDirection:i},success:function(e){o.html(""),n.noMailingOption&&o.append('<option value="0">'+t("workflow.defaults.no_mailing")+"</option>");for(var i=0;i<e.length;i++)o.append("<option  value='"+e[i].mailingID+"'>"+e[i].shortname+"</option>");o.removeAttr("readonly"),0==n.mailingId&&0==n.noMailingOption&&0<e.length?o.val(e[0].mailingID):o.val(n.mailingId),a.initSelectWithValueOrChooseFirst(o,o.val())}})},this.getSelectedMailingOption=function(){return jQuery(this.formNameJId+" "+this.selectNameJId+" option[value="+this.mailingId+"]")}},function(){var se=AGN.Lib.Helpers;function le(e){this.rules=e}le.prototype.isConstraint=function(e){return _.isBoolean(e)||_.isFunction(e)},le.prototype.evaluate=function(e,t,i,n){return!0===e||!1===e?e:$.isFunction(e)?e(t,i,n):void 0},le.prototype.getRulesToCheck=function(e,t){return[{from:e.type,to:[t.type,"*"]},{from:"*",to:[t.type,"*"]}]},le.prototype.getRelevantConstraints=function(e,t){var o=this.isConstraint,i=this.getRulesToCheck(e,t),r=this.rules,a=[];return i.forEach(function(t){var i=!0;if(_.has(r,t.from)){var n=r[t.from];o(n)?(a.push(n),i=!1):t.to.forEach(function(e){_.has(r[t.from],e)&&(n=r[t.from][e],o(n)&&(a.push(n),i=!1))})}i&&"*"!=t.from&&a.push(!1)}),a},le.prototype.check=function(e,t,i){for(var n=this.getRelevantConstraints(e,t),o=!1,r=0;r<n.length;r++){if(!this.evaluate(n[r],e,t,i))return!1;o=!0}return o};AGN.Lib.WM.CampaignManager=function(e){var m=AGN.Lib.WM.NodeFactory;this.IS_ACTION_BASED=!1,this.IS_DATE_BASED=!1,this.STATE_WAITING=0,this.STATE_DRAGGING_STAGE_WAIT_MOUSE=1,this.STATE_DRAGGING_STAGE=2,this.STATE_SELECTING_NODES=3,this.STATE_CREATING_NODE=4,this.STATE_CREATING_CONNECTION=5,this.STATE_SPACE_RESTORED=6,this.STATE_EXPANDING_ICONS_SET=7,this.STATE_AUTOMATICALLY_CREATING_CONNECTION=8,this.Z_INDEX_VIEW_PORT=10,this.Z_INDEX_ICON_PANEL=50,this.Z_INDEX_DRAGGABLE_BUTTON=60,this.Z_INDEX_ICON_NODE=10,this.Z_INDEX_CONNECT_RAPID_BUTTON=20,this.Z_INDEX_JSPLUMB_DRAG_OPTIONS=25,this.Z_INDEX_NAVIGATOR_GLOBE=30,this.Z_INDEX_NAVIGATOR_ARROWS=31,this.Z_INDEX_CONTEXT_MENU=40,this.CONNECTION_CONSTRAINTS={"*":{deadline:function(e,t,i){return!t.connections.incoming.some(function(e){return e.source in i&&"import"==i[e.source].type})},mailing:function(e,t){return 0==t.connections.incoming.length},datebased_mailing:function(e,t){return 0==t.connections.incoming.length}},start:{recipient:!0,form:!0,import:!0,export:!0},stop:!1,decision:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0},parameter:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0},deadline:{decision:!0,parameter:!0,report:!0,recipient:!0,archive:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0,import:!0,export:!0},report:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,archive:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0,import:!0,export:!0},recipient:{decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0,import:!0,export:!0},actionbased_mailing:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,import:!0,export:!0},datebased_mailing:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,import:!0,export:!0},followup_mailing:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,import:!0,export:!0},mailing:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,import:!0,export:!0},archive:{decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0,import:!0,export:!0},form:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0,import:!0,export:!0},import:{deadline:function(e){return 0==e.connections.outgoing.length}},export:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0,import:!0,export:!0,archive:!0,form:!0}};var v=this;this.workflowId=e.workflowId,this.pageContextSessionId=e.pageContextSessionId,this.isActivated=e.isActivated,this.isPdf=e.isPdfGenerating;var i="viewPort",y=jQuery("#"+i),b=y.get(0).clientWidth,w=y.get(0).clientHeight,n="editorCanvas",o=b,r=w,u=jQuery('<div id="'+n+'"></div>').appendTo("#"+i).css({position:"absolute",left:0,top:0,width:o,height:r}),d=0,h=0,C=e.editorPositionLeft,_=e.editorPositionTop,a=e.localeDateNTimePattern,p=!1,f=!1,s=e.noContextMenu,l=jQuery('<div id="bounder"></div>').appendTo("#"+n).css({position:"absolute"}),c=jQuery('<div id="navigatorBody"></div>').insertAfter("#"+i),g=e.campaignManagerSettings,A=e.restoreSpaceFields,E=e.campaignManagerScale,x=e.allUsedEntity,S=new AGN.Lib.WM.CampaignManagerNodes({nodesContainerDOMId:"bounder",localeDateNTimePattern:a,campaignManagerScale:E,campaignManager:v,nodeFactory:m,allUsedEntity:x}),T=new AGN.Lib.WM.EditorsHelper(v,m,g),D=new AGN.Lib.WM.AutoLayout(g),k=new AGN.Lib.WM.ChainProcessor({campaignManager:v,pageContextSessionId:this.pageContextSessionId,editorsHelper:T,nodeFactory:m}),R=this.STATE_WAITING,O=[],N=E.getCurrentScaleSliderPosition(),F=!1,M="",P=[],I=null,L=null,G=null,B=!1,j=null,W=new AGN.Lib.WM.CommentControls(v,e);updateBoundNodesVariables=function(){var e=S.normalizeNodes();e.collapsedX&&(C-=e.collapsedX*E.getScaledGridSize()),e.collapsedY&&(_-=e.collapsedY*E.getScaledGridSize()),C<0&&(C=0);var t,i,n,o=S.getNodes();for(var r in o)S.updateNodeView(o[r],E,x.allMailings);var a=!1,s=!1,l=!1;for(r in o)n=parseInt(o[r].elementJQ.find("div.icon-extra-info").css("top")),t=parseInt(o[r].element.style.left)+parseInt(o[r].element.style.width),i=parseInt(o[r].element.style.top)+parseInt(o[r].element.style.height),(!1===a||a<t)&&(a=t),(!1===s||s<n)&&(s=n),(!1===l||l<i)&&(l=i);_<0&&(_=s||0),p=a,f=l},updateBoundNodesDOM=function(){l.css({left:C,top:_,width:p+E.getScaledGridSize(),height:f+E.getScaledGridSize()})},updateEditorCanvas=function(){updateBoundNodesVariables();var e=0,t=0,i=parseInt(u.css("left")),n=parseInt(u.css("top"));(C=parseInt(C)+i)<=0&&(e+=-C,d+=-C,C=0),(_=parseInt(_)+n)<=0&&(t+=-_,h+=-_,_=0),u.css({left:0,top:0,width:b+d,height:w+h}),y.scrollLeft(y.scrollLeft()+e),y.scrollTop(y.scrollTop()+t);var o=0;0<C-y.scrollLeft()?(o=y.scrollLeft(),C-=y.scrollLeft()):y.scrollLeft()-C>E.getScaledGridSize()&&(o=C,C=0),d-=o;var r=0;0<_-y.scrollTop()?(r=y.scrollTop(),_-=y.scrollTop()):y.scrollTop()-_>E.getScaledGridSize()&&(r=_,_=0),h-=r;var a,s,l=y.scrollLeft(),c=y.scrollTop();u.css({width:b+d,height:w+h}),y.scrollLeft(l-o),y.scrollTop(c-r),a=y.scrollLeft()+b<p?b+d-p:b+d-y.scrollLeft()-b,d-=a,s=y.scrollTop()+w<f?w+h-f:w+h-y.scrollTop()-w,h-=s,u.css({width:b+d,height:w+h}),updateBoundNodesDOM()},resetJsPlumber=function(){F?F.reset():(F=jsPlumb.getInstance()).bind("beforeDrop",function(e){if(!v.checkActivation())return v.connectIntermediateNodes(e.sourceId,e.targetId)}),F.bind("ready",function(){var e=[[.5,.6,0,1],[.5,.4,0,-1],[.6,.5,1,0],[.4,.5,-1,0]];F.setRenderMode(g.renderMode),F.importDefaults({Anchors:[e,e],DragOptions:{cursor:"pointer",zIndex:v.Z_INDEX_JSPLUMB_DRAG_OPTIONS},Endpoints:["Blank","Blank"],Connector:["Flowchart",{stub:5,gap:0,midpoint:.5}],PaintStyle:{strokeStyle:g.lineColor,lineWidth:E.getLineWidth()},ConnectionOverlays:[["PlainArrow",{width:E.getArrowWidth(),length:E.getArrowLength(),location:.52,id:"arrow"}]]}),F.draggable(jQuery(S.getIconNodesSelector()),getJSPlumbDraggableProperties()),S.resetUsedAnchors();for(var t=0;t<O.length;t++){var i=F.connect(O[t]);processJSPlumbConnection(i)}F.bind("jsPlumbConnection",function(e){v.connectNodes(e.sourceId,e.targetId,!1)||resetJsPlumber(),v.getCurrentState()!=v.STATE_AUTOMATICALLY_CREATING_CONNECTION&&updateEditorCanvas(),updateNodeAdditionalViewElements(),v.getCurrentState()!=v.STATE_AUTOMATICALLY_CREATING_CONNECTION&&updateEditorCanvas()})})},processJSPlumbConnection=function(e){for(var t={},i=0;i<e.endpoints.length;i++){var n=e.endpoints[i];t.hasOwnProperty(n.elementId)||(t[n.elementId]=[]),.5==n.anchor.x&&.6==n.anchor.y?-1==jQuery.inArray(S.BOTTOM,t[n.elementId])&&t[n.elementId].push(S.BOTTOM):.5==n.anchor.x&&.4==n.anchor.y?-1==jQuery.inArray(S.TOP,t[n.elementId])&&t[n.elementId].push(S.TOP):.6==n.anchor.x&&.5==n.anchor.y?-1==jQuery.inArray(S.RIGHT,t[n.elementId])&&t[n.elementId].push(S.RIGHT):.4==n.anchor.x&&.5==n.anchor.y&&-1==jQuery.inArray(S.LEFT,t[n.elementId])&&t[n.elementId].push(S.LEFT)}var o=S.getNodes();for(var i in o)t.hasOwnProperty(o[i].elementJQ.attr("id"))&&(o[i].usedAnchors=o[i].usedAnchors.concat(t[o[i].elementJQ.attr("id")]),jQuery.unique(o[i].usedAnchors))},rearrangeStage=function(){jQuery("#connectRapidButton").width(g.rapidButtonSize*E.getCurrentScale()),jQuery("#connectRapidButton").height(g.rapidButtonSize*E.getCurrentScale()),updateEditorCanvas(),resetJsPlumber(),updateNodeAdditionalViewElements()},updateNodeAdditionalViewElements=function(){var e=S.getNodes();for(var t in e)S.updateNodeAdditionalViewElements(e[t],E)},connectSelectedNodes=function(){var e=v.needSaveSnapshot;v.needSaveSnapshot=!1,v.saveSnapshot();var t=AGN.Lib.WM.CampaignManagerSelection.getSelected(),i=null,n=!1,o=t.slice(0);return o.sort(function(e,t){var i=S.getNodeById(e),n=S.getNodeById(t);return i.x<n.x?-1:i.x>n.x?1:i.y<n.y?-1:i.y>n.y?1:0}),jQuery.each(o,function(e,t){null!=i&&(v.connectNodes(i,t,!0),n=!0),i=t}),AGN.Lib.WM.CampaignManagerSelection.prevSelected=null,v.needSaveSnapshot=e,n},getCanvasOffsetX=function(){return jQuery("#toolbarLeft").offset().left+jQuery("#toolbarLeft").width()-y.scrollLeft()},getCanvasOffsetY=function(){return jQuery("#toolbarTop").offset().top+jQuery("#toolbarTop").height()-y.scrollTop()},justifyNodeElement=function(t){F.draggable(t.element,getJSPlumbDraggableProperties()),W.addCommentEllipsis(t),jQuery(t.elementJQ).click(function(e){if(R==v.STATE_WAITING||v.STATE_SPACE_RESTORED){var t=jQuery(this);t.hasClass("preventClickAfterDrop")?t.removeClass("preventClickAfterDrop"):AGN.Lib.WM.CampaignManagerSelection.handleClick(e,jQuery(this))}}).mouseover(V).mouseout(U).mousemove(Q).dblclick(function(e){!1!==t.data.editable?v.editNode(t,!0):"function"==typeof G&&G()})},getJSPlumbDraggableProperties=function(){var r,a,s=!1,l=!1;return{distance:jQuery.browser.msie&&jQuery.browser.version<9?5:10,start:function(e,t){var i=!1;r=AGN.Lib.WM.CampaignManagerSelection.getSelected(),j=a;for(var n=0;n<r.length;n++)if(r[n]==t.helper.attr("id")){i=!0;break}for(i||(AGN.Lib.WM.CampaignManagerSelection.clear(),AGN.Lib.WM.CampaignManagerSelection.select(t.helper)),r=AGN.Lib.WM.CampaignManagerSelection.getSelected(),a=[],n=0;n<r.length;n++){var o=document.getElementById(r[n]);a[n]={DOMElement:o,left:parseInt(o.style.left),top:parseInt(o.style.top)}}},drag:function(e,t){W.hidePopover(!0);for(var i=t.position.left-t.originalPosition.left,n=t.position.top-t.originalPosition.top,o=0;o<a.length;o++)t.helper.get(0)!=a[o].DOMElement&&(a[o].DOMElement.style.left=a[o].left+i+"px",a[o].DOMElement.style.top=a[o].top+n+"px");if(1<AGN.Lib.WM.CampaignManagerSelection.selected.length){function r(){try{F.repaint(AGN.Lib.WM.CampaignManagerSelection.selected)}finally{if(l){var e=l;l=!1,s=setTimeout(e,50)}else s=!1}}l=r,s||(l=!1,s=setTimeout(r,50))}},stop:function(e,t){j=null;for(var i=!1,n=0;n<a.length;n++)if(a[n].x=E.pxToCoordinate(parseInt(a[n].DOMElement.style.left)),a[n].y=E.pxToCoordinate(parseInt(a[n].DOMElement.style.top)),!S.isEmptyCell(a[n].x,a[n].y,a)){i=!0;break}if(!i)for(v.saveSnapshot(),n=0;n<a.length;n++){var o=S.getNodes()[jQuery(a[n].DOMElement).data("index")];S.updateNode(o.id,{x:a[n].x,y:a[n].y})}rearrangeStage(),t.helper.addClass("preventClickAfterDrop")}}};function H(){var s,l;return{distance:10,start:function(e,t){s=e.pageX,l=e.pageY,ee(),R=v.STATE_SELECTING_NODES},stop:function(e,t){var i=e.pageX,n=e.pageY;if(i<s){var o=s;s=i,i=o}n<l&&(o=l,l=n,n=o);var r=E.getScaledGridSize()/2,a=S.getNodesFromRegion(E.pxToCoordinate(s-r-getCanvasOffsetX()-C),E.pxToCoordinate(l-r-getCanvasOffsetY()-_),E.pxToCoordinate(i-r-getCanvasOffsetX()-C),E.pxToCoordinate(n-r-getCanvasOffsetY()-_),0);for(Z in AGN.Lib.WM.CampaignManagerSelection.validateMultiselection(e),a)AGN.Lib.WM.CampaignManagerSelection.select(jQuery(a[Z].element));R=v.STATE_WAITING,z=e.originalEvent.originalEvent}}}var z=void 0,V=function(){if(R==v.STATE_WAITING){var e=$(this),t=S.getNodeById(e.attr("id"));Y(e,t),W.showCommentPopover(t)}},U=function(){R==v.STATE_WAITING&&(q(),W.hideCommentPopover())},Y=function(e,t){F.unmakeEverySource(),jQuery(e).append(jQuery("#connectRapidButton")),jQuery("#connectRapidButton").offset({top:jQuery(e).offset().top,left:jQuery(e).offset().left+jQuery(e).width()-jQuery("#connectRapidButton").width()}),jQuery("#connectRapidButton").css("visibility","visible"),F.makeSource(jQuery("#connectRapidButton"),{parent:jQuery(e),dragOptions:{start:function(e,t){ee(),R=v.STATE_CREATING_CONNECTION},stop:function(e,t){R=v.STATE_WAITING,q()}}}),F.makeTarget(jQuery(S.getIconNodesSelector()),{dropOptions:{hoverClass:"hover"}})},q=function(){F.unmakeEverySource(),F.unmakeEveryTarget(),jQuery("#connectRapidButton").css("visibility","hidden")},Q=function(){R==v.STATE_WAITING&&jQuery(this).attr("id")!=jQuery("#connectRapidButton").parent().attr("id")&&(jQuery(this).append(jQuery("#connectRapidButton")),jQuery("#connectRapidButton").css("visibility","visible"))};this.needSaveSnapshot=!0,this.extendAllUsedEntities=function(e){$.extend(!0,x,e)},this.noSnapshot=function(e){var t=v.needSaveSnapshot;try{v.needSaveSnapshot=!1,e()}finally{v.needSaveSnapshot=t}},this.getBoundNodesDOM=function(){return{left:l.css("left"),top:l.css("top"),width:l.css("width"),height:l.css("height")}},this.getCurrentState=function(){return R},this.setCurrentState=function(e){R=e},this.isConnectionAllowed=function(e,t){if(!e||!t||e==t)return!1;var i=new le(v.CONNECTION_CONSTRAINTS),n=S.getNodesMap(),o=n[e],r=n[t],a={node:o,type:o.type,connections:{}},s={node:r,type:r.type,connections:{}};return Object.defineProperty(a.connections,"incoming",{get:se.caching(v.getNodeIncomingConnections,v,o)}),Object.defineProperty(a.connections,"outgoing",{get:se.caching(v.getNodeOutgoingConnections,v,o)}),Object.defineProperty(s.connections,"incoming",{get:se.caching(v.getNodeIncomingConnections,v,r)}),Object.defineProperty(s.connections,"outgoing",{get:se.caching(v.getNodeOutgoingConnections,v,r)}),a.type!=m.NODE_TYPE_STOP||this.nodeHasIncomingConnections(a.node)||(a.type=m.NODE_TYPE_START),s.type!=m.NODE_TYPE_START||this.nodeHasOutgoingConnections(s.node)||(s.type=m.NODE_TYPE_STOP),i.check(a,s,n)?(o.type==m.NODE_TYPE_STOP&&(o.type=m.NODE_TYPE_START),r.type==m.NODE_TYPE_START&&(r.type=m.NODE_TYPE_STOP),!0):("function"==typeof L&&L(),!1)},this.connectNodes=function(e,t,i){for(var n=!1,o=0;o<O.length;o++){var r=O[o];if(r.source==e&&r.target==t||r.source==t&&r.target==e){n=!0;break}}if(!n&&v.isConnectionAllowed(e,t)){var a={source:e,target:t};v.needSaveSnapshot&&this.saveSnapshot(),O.push(a),i&&processJSPlumbConnection(F.connect(a)),k.updateParameterValueAfterDecision()}},this.connectIntermediateNodes=function(e,t){if(B){var i=E.pxToCoordinate(E.getScaledNodeSize()),n=S.getNodeById(e),o=S.getNodeById(t),r=Math.abs(o.x-n.x),a=Math.abs(o.y-n.y),s={x1:0,y1:0,x2:0,y2:0};a<=r?(s.x1=Math.min(n.x,o.x)+i,s.y1=Math.min(n.y,o.y),s.x2=Math.max(n.x,o.x),s.y2=Math.max(n.y,o.y)+i):(s.x1=Math.min(n.x,o.x),s.y1=Math.min(n.y,o.y)+i,s.x2=Math.max(n.x,o.x)+i,s.y2=Math.max(n.y,o.y));var l=S.getNodesFromRegion(s.x1,s.y1,s.x2,s.y2,0);l[n.id]=n,l[o.id]=o;var c=[];for(var u in l)c.push(l[u]);c.sort(function(e,t){return a<=r&&n.x<=o.x?e.x-t.x:a<=r&&n.x>o.x?t.x-e.x:r<=a&&n.y<=o.y?e.y-t.y:r<=a&&n.y>o.y?t.y-e.y:void 0});var d=v.getConnectionNotAllowedCallback();2<c.length&&v.setConnectionNotAllowedCallback(function(){});var h=null;return jQuery.each(c,function(e,t){null!=h&&v.connectNodes(S.getNodeIdPrefix()+h.id,S.getNodeIdPrefix()+t.id,!0),h=t}),v.setConnectionNotAllowedCallback(d),!1}return v.isConnectionAllowed(e,t)},this.deleteSelectedNode=function(){var i=!0,e=AGN.Lib.WM.CampaignManagerSelection.getSelected();jQuery.each(e,function(e,t){null!=S.getNodeById(t)&&(i&&(v.saveSnapshot(),i=!1),v.deleteNode(t,!1,!0))}),AGN.Lib.WM.CampaignManagerSelection.clear(),rearrangeStage(),v.restoreCampaignActionsType(),k.updateParameterValueAfterDecision(),this.callWorkflowManagerStateChangedCallback()},this.deleteNode=function(e,t,i){if(1!=i||!v.checkActivation()){$("#invisible").append($("#connectRapidButton"));var n=S.getNodesMap(),o=[e];if(n[e])switch(n[e].type){case m.NODE_TYPE_DEADLINE:v.getIncomingConnectionsById(e).forEach(function(e){var t=n[e.source];t&&t.type==m.NODE_TYPE_IMPORT&&o.push(t.element.id)});break;case m.NODE_TYPE_IMPORT:v.getOutgoingConnectionsById(e).forEach(function(e){var t=n[e.target];t&&t.type==m.NODE_TYPE_DEADLINE&&o.push(t.element.id)})}O=O.filter(function(e){return o.indexOf(e.source)<0&&o.indexOf(e.target)<0}),o.forEach(function(e){S.deleteNode(e)}),!0===t&&rearrangeStage()}},this.deleteConnection=function(e){if(!v.checkActivation()){var t=e.source.attr("id"),i=e.target.attr("id"),n=S.getNodeById(t),o=S.getNodeById(i);n.type==m.NODE_TYPE_IMPORT&&o.type==m.NODE_TYPE_DEADLINE||(this.saveSnapshot(),O=O.filter(function(e){return!(e.source==t&&e.target==i||e.source==i&&e.target==t)}),rearrangeStage(),k.updateParameterValueAfterDecision())}},this.deleteConnectionByHtmlElement=function(e){for(var t=F.getConnections(),i=0;i<t.length;i++)if(t[i].canvas==e){v.deleteConnection(t[i]);break}},this.deleteConnectionByIdsOfElements=function(e,t){for(var i=[],n=0;n<O.length;n++)O[n].source==e.source&&O[n].target==e.target||O[n].source==e.target&&O[n].target==e.source||i.push(O[n]);O=i,1==t&&rearrangeStage()},this.getConnectionsFromSelected=function(e){var i=[];return jQuery.each(e,function(e,t){jQuery.each(v.getIncomingConnectionsById(t),function(e,t){-1==jQuery.inArray(t,i)&&i.push(t)}),jQuery.each(v.getOutgoingConnectionsById(t),function(e,t){-1==jQuery.inArray(t,i)&&i.push(t)})}),i},this.getNodesFromSelected=function(e){return jQuery.map(e,function(e){return S.getNodeById(e)})},this.deleteConnections=function(e){jQuery.each(e,function(e,t){v.deleteConnectionByIdsOfElements(t,!1)}),rearrangeStage()},this.deleteAllNodes=function(e){var t=S.getNodes();for(var i in t)this.deleteNode(t[i].elementJQ.attr("id"),e,!0)},this.getSessionId=function(){return this.pageContextSessionId},this.getEditorsHelper=function(){return T},this.setCampaignActionsType=function(e){"actionbased_mailing"==e.type&&(v.IS_ACTION_BASED=!0),"datebased_mailing"==e.type&&(v.IS_DATE_BASED=!0)},this.restoreCampaignActionsType=function(){var e=S.getNodes();for(var t in v.IS_ACTION_BASED=!1,v.IS_DATE_BASED=!1,e)v.setCampaignActionsType(e[t]);v.restoreStopsTitles()},this.isNormalCampaignActionsType=function(){return!v.IS_ACTION_BASED&&!v.IS_DATE_BASED},this.restoreStopsTitles=function(){var e=S.getNodes(),i=v.isNormalCampaignActionsType()?t("workflow.stop.automatic_end"):t("workflow.stop.open_end");for(var n in e){var o=e[n];if(o.data.endType==constants.endTypeAutomatic){o.elementJQ.find(".icon-extra-info").remove(),o.elementJQ.append("<div class='icon-extra-info'>"+i+"</div>");var r=90*E.getCurrentScale(),a=S.getIconExtraInfoPosition(o,E),s=a.top,l=a.left;o.elementJQ.find("div.icon-extra-info").css("font-size",r+"%"),o.elementJQ.find("div.icon-extra-info").css("top",s+"px"),o.elementJQ.find("div.icon-extra-info").css("left",l+"px")}}},this.getIncomingConnectionsById=function(e){for(var t=[],i=0;i<O.length;i++)O[i].target==e&&t.push(O[i]);return t},this.getNodeIncomingConnections=function(e){return v.getIncomingConnectionsById(e.elementJQ.attr("id"))},this.getOutgoingConnectionsById=function(e){for(var t=[],i=0;i<O.length;i++)O[i].source==e&&t.push(O[i]);return t},this.getNodeOutgoingConnections=function(e){return v.getOutgoingConnectionsById(e.elementJQ.attr("id"))},this.clearLabelConnection=function(e){for(var t=v.getNodeOutgoingConnections(e),i=0;i<t.length;i++)for(var n=F.getConnections(),o=0;o<n.length;o++)if(n[o].source[0].id==t[i].source&&n[o].target[0].id==t[i].target){var r=n[o].getOverlay("label");null!=r&&(jQuery("#"+r.canvas.id).remove(),n[o].removeOverlay("label"));break}},this.updateLabelConnection=function(e){if(e.data.decisionType==constants.decisionTypeDecision||e.data.decisionType==constants.decisionTypeAutoOptimization){v.clearLabelConnection(e);var i=v.getNodeOutgoingConnections(e);if(e.data.decisionType==constants.decisionTypeDecision&&2==i.length){var n=t("workflow.defaults.yes"),o=t("workflow.defaults.no");null!=e.statisticsList&&(n+=": <span class='node-stats'>"+e.statisticsList[0]+"</span>",o+=": <span class='node-stats'>"+e.statisticsList[1]+"</span>");var r=v.getConnectionObject(i[0]);if(null==r)return;var a=v.getConnectionObject(i[1]),s=S.getNodeById(i[0].target),l=S.getNodeById(i[1].target),c=s.x-l.x,u=s.y-l.y,d=Math.abs(c)<Math.abs(u)?"top":"right",h=Math.abs(c)<Math.abs(u)?"bottom":"left";e.y>=s.y&&e.y>=l.y?s.y<l.y?(v.setLabelToConnection(r,n,d),v.setLabelToConnection(a,o,h)):s.y>l.y?(v.setLabelToConnection(r,o,h),v.setLabelToConnection(a,n,d)):s.x<l.x?(v.setLabelToConnection(r,n,d),v.setLabelToConnection(a,o,h)):(v.setLabelToConnection(r,o,h),v.setLabelToConnection(a,n,d)):e.y<s.y&&e.y<l.y?s.x<l.x?(v.setLabelToConnection(r,o,h),v.setLabelToConnection(a,n,d)):(v.setLabelToConnection(r,n,d),v.setLabelToConnection(a,o,h)):s.y<l.y?(v.setLabelToConnection(r,n,d),v.setLabelToConnection(a,o,h)):(v.setLabelToConnection(r,o,h),v.setLabelToConnection(a,n,d));var p=jQuery("._jsPlumb_overlay");0!=p.size()&&p.css("font-size",E.getLabelFontSize())}}},this.getConnectionObject=function(e){for(var t=F.getConnections(),i=0;i<t.length;i++)if(t[i].source[0].id==e.source&&t[i].target[0].id==e.target)return t[i];return null},this.setLabelToConnection=function(e,t,i){if(null!=e){e.setLabel({id:"label",label:t,location:.65,cssClass:"connection-label"});var n=jQuery(e.getOverlay("label").canvas),o=6+n.width()/2,r=4+n.height()/2;"bottom"==i&&(r=-r),"right"==i&&(o=-o),jQuery(e.getOverlay("label").canvas).css({"margin-top":r+"px","margin-left":o+"px"})}},this.nodeHasIncomingConnections=function(e){var t=e.elementJQ.attr("id");return O.some(function(e){return e.target==t})},this.nodeHasOutgoingConnections=function(e){var t=e.elementJQ.attr("id");return O.some(function(e){return e.source==t})},this.editNode=function(e,t){null==e&&(e=S.getNodeById(AGN.Lib.WM.CampaignManagerSelection.getSelected()[0])),e.isExpandable&&(e.filled||K(e))?e.data.created||!e.data.copyContent||K(e)?X(e,e.data.created):v.expandNodeUseOriginal(e.data.copyContent,T.curEditingNode.id):(AGN.Lib.WM.CampaignManagerSelection.clear(),T.showEditDialog(e,v.checkActivation()))};var K=function(e){return e.isExpandable&&"ownWorkflow"!=e.type},X=function(e,t){new AGN.Lib.WM.IconsSetLoader(v).loadIconsSetAJAX(e,t),e.data.created=!0};this.expandNodeUseOriginal=function(e,t){var i=S.getNodes()[t];X(i,!e)},this.isNewNode=function(e){return-1!=(e.id+"").indexOf("new")},this.updateNode=function(e){S.updateNodeView(e,E)},this.restoreWorkflow=function(e){var t=v.restoreNodes(e);return v.restoreConnections(e),v.relayout(),t},this.restoreNodes=function(e){var i=[];return e.forEach(function(e){var t=S.restoreNode(e);i.push(t),justifyNodeElement(t)}),i},this.restoreConnections=function(e){var n=S.getNodes();v.noSnapshot(function(){e.forEach(function(e){if(e.connections){var i=e.id;e.connections.forEach(function(e){var t=e.targetIconId;n[i]&&n[t]&&v.restoreConnection(i,t)})}})})},this.restoreConnection=function(e,t){var i=S.getNodeIdPrefix();this.connectNodes(i+e,i+t,!1)},this.relayout=function(){rearrangeStage(),R=v.STATE_WAITING},this.getCMNodes=function(){return S},this.isNodesFilled=function(){var e=S.getNodes();for(var t in e)if(!e[t].filled)return!1;return!0},this.justifyNodeElement=function(e){justifyNodeElement(e)},this.saveSnapshot=function(){P.length==g.MAX_UNDO_HISTORY&&P.shift(),P.push({icons:v.getIconsForSubmission(),workflowBound:v.getBoundNodesDOM()}),"function"==typeof I&&I(!0)},this.undo=function(){0<P.length&&v.noSnapshot(function(){var e=P.pop();v.deleteAllNodes(!1),C=parseInt(e.workflowBound.left),_=parseInt(e.workflowBound.top),p=parseInt(e.workflowBound.width),f=parseInt(e.workflowBound.height),updateBoundNodesDOM(),v.restoreWorkflow(e.icons),I(0<P.length)})},this.canUndo=function(){return 0<P.length},this.getUndoHistoryDataForSubmission=function(){return JSON.stringify(P)},this.setUndoHistoryDataForSubmission=function(e){I(0<P.length)},this.setHistoryStackChangedCallback=function(e){I=e},this.setConnectionNotAllowedCallback=function(e){L=e},this.getConnectionNotAllowedCallback=function(){return L},this.setEditingNotAllowedCallback=function(e){G=e},this.setEditorCanvasWidth=function(e){o=e},this.setEditorCanvasHeight=function(e){r=e},this.setViewPortWidth=function(e){b=e},this.setViewPortHeight=function(e){w=e},this.updateWorkflowForPdf=function(){y.css({overflow:"inherit",float:"none",border:"none",sceneHeight:"100%",width:"100%","min-height":y.css("height"),height:"100%"}),c.remove();var e=l.height(),t=l.width();if(800<e||1360<t){var i=1;i=t/e<1.7?800/e:1360/t,v.setScale(i),v.relayout()}v.resetScrolling()},this.resetScrolling=function(){l.css({position:"relative",top:"0",left:"0",margin:$("div.icon-extra-info").css("top")+" 15px"}),u.css({position:"initial",height:"100%","min-height":u.css("height")})},this.omitKeys=function(e,t){var i={};for(key in e)-1==t.indexOf(key)&&(i[key]=e[key]);return i},this.getIconsForSubmission=function(e){var i=[],n=S.getNodes(),o={},t=Object.keys(n);if(!0===e){var r=0;t.forEach(function(e){var t=parseInt(e,10);r<t&&(r=t)}),t.forEach(function(e){var t=parseInt(e,10);0<t?o[e]=t:(r++,o[e]=r)})}else t.forEach(function(e){o[e]=e});t.forEach(function(e){var t=v.omitKeys(m.prepareNodeForSubmission(n[e]),["isExpandable"]);t.id=o[e],i.push(t)});var a={};return O.forEach(function(e){var t=o[v.extractIdFromConnectionEnd(e.source)],i=o[v.extractIdFromConnectionEnd(e.target)];t in a?a[t].push(i):a[t]=[i]}),i.forEach(function(e){var t=a[e.id];e.connections=t?$.map(t,function(e){return{targetIconId:e}}):[]}),i},this.getIconsForSubmissionJson=function(){return JSON.stringify(this.getIconsForSubmission(!0))},this.getLeftPosition=function(){return l.offset().left-y.offset().left},this.getTopPosition=function(){return l.offset().top-y.offset().top},this.extractIdFromConnectionEnd=function(e){return e.substring(e.indexOf(S.getNodeIdPrefix())+S.getNodeIdPrefix().length,e.length)},this.updateParameterValueAfterDecision=function(){k.updateParameterValueAfterDecision()},this.getIncomingChainsForIcon=function(){var i=v.getCMNodes().getNodeIdPrefix(),n=v.getCMNodes(),o=[];return k.getIncomingChainsForIcon().forEach(function(e){var t=[];e.forEach(function(e){t.push(n.getNodeById(i+e.id))}),o.push(t)}),o},this.setWorkflowManagerStateChangedCallback=function(e){M=e},this.callWorkflowManagerStateChangedCallback=function(){"function"==typeof M&&M()},this.getCampaignManagerNodes=function(){return S},this.getNodesFactory=function(){return m},this.getMailingNames=function(){for(var e="",t=v.getCMNodes().getNodesByTypeList([m.NODE_TYPE_MAILING,m.NODE_TYPE_ACTION_BASED_MAILING,m.NODE_TYPE_DATE_BASED_MAILING,m.NODE_TYPE_FOLLOWUP_MAILING]),i=0;i<t.length;i++)e=e+t[i].iconTitle+"<br/>";return e},this.showError=function(e){AGN.Lib.Messages(t("workflow.defaults.error"),e,"alert")},this.checkWorkflowBeforeSave=function(){var e=v.checkActivation(),t=v.checkUsingActivatedWorkflow(),i=v.checkPartOfActivatedWorkflow();return e||t||i},this.checkActivation=function(){var e=$("input[name='__STRUTS_CHECKBOX_workflow.statusString']").val();return!(!this.isActivated||"STATUS_ACTIVE"!=e&&"STATUS_TESTING"!=e)&&(v.showError(t("error.workflow.saveActivatedWorkflow")),!0)},this.checkUsingActivatedWorkflow=function(){var e=$("input[name='usingActivatedWorkflow']").val();if(""==e)return!1;var i=$("input[name='usingActivatedWorkflowName']").val();return v.showError(t("error.workflow."+e).replace("%s",i)),!0},this.checkPartOfActivatedWorkflow=function(){var e=$("input[name='partOfActivatedWorkflow']").val();if(""==e)return!1;var i=$("input[name='partOfActivatedWorkflowName']").val();return v.showError(t("error.workflow."+e).replace("%s",i)),!0},this.checkMailingTypesConvertingRequired=function(){for(var e=this.getIconsForSubmission(!1),t="UNKNOWN",i={},n=0;n<e.length;n++){var o=e[n];if(o.type==m.NODE_TYPE_START&&o.filled){var r="UNKNOWN";switch(o.startType){case constants.startTypeDate:r="DATE";break;case constants.startTypeEvent:switch(o.event){case constants.startEventDate:r="RULE";break;case constants.startEventReaction:r="REACTION"}}if(t!=r){if("UNKNOWN"!=t)return!1;t=r}}switch(o.type){case m.NODE_TYPE_MAILING:case m.NODE_TYPE_FOLLOWUP_MAILING:i.DATE=!0;break;case m.NODE_TYPE_ACTION_BASED_MAILING:i.REACTION=!0;break;case m.NODE_TYPE_DATE_BASED_MAILING:i.RULE=!0}}if("UNKNOWN"!=t)if(1==(i=Object.keys(i)).length){if(t!=i[0])return!0}else if(1<i.length)return!0;return!1},this.setScale=function(e){E.setExternalScale(e)},this.getCommentControls=function(){return W},this.getDraggedElements=function(){return j},c.css({right:20,bottom:20}).append('<div id="navigatorArrowTop"></div>').append('<div id="navigatorArrowRight"></div>').append('<div id="navigatorArrowBottom"></div>').append('<div id="navigatorArrowLeft"></div>'),jQuery("#navigatorArrowTop").click(function(){u.animate({top:g.navigatorStep},"fast",function(){rearrangeStage()})}),jQuery("#navigatorArrowRight").click(function(){var e=y.scrollLeft();u.css({width:o+d+g.navigatorStep}),y.scrollLeft(e),u.animate({left:-g.navigatorStep},"fast",function(){rearrangeStage()})}),jQuery("#navigatorArrowBottom").click(function(){var e=y.scrollTop();u.css({height:r+h+g.navigatorStep}),y.scrollTop(e),u.animate({top:-g.navigatorStep},"fast",function(){rearrangeStage()})}),jQuery("#navigatorArrowLeft").click(function(){u.animate({left:g.navigatorStep},"fast",function(){rearrangeStage()})});for(var J="",Z=0;Z<A.length;Z++)J&&(J+=", "),J+="#"+A[Z];var ee=function(){jQuery(J).filter(":focus").blur()};jQuery(J).focus(function(){R=v.STATE_SPACE_RESTORED}).blur(function(){R=v.STATE_WAITING}),jQuery("#slider").slider({value:N,step:g.zoomStep,change:function(){E.setCurrentScaleSliderPosition(jQuery(this).slider("value")),rearrangeStage()}}),document.onselectstart=function(){return!1},rearrangeStage(),$(".draggableButton").css({zIndex:v.Z_INDEX_DRAGGABLE_BUTTON}).draggable({revert:!0,revertDuration:0,start:function(e,t){ee(),R=v.STATE_CREATING_NODE,t.helper.css({zIndex:v.Z_INDEX_DRAGGABLE_BUTTON+1}),t.helper.parent().css({zIndex:v.Z_INDEX_ICON_PANEL+1})},stop:function(e,t){if(!v.checkActivation()){t.helper.css({zIndex:v.Z_INDEX_DRAGGABLE_BUTTON}),t.helper.parent().css({zIndex:v.Z_INDEX_ICON_PANEL});var i=y.offset(),n=t.helper.attr("type"),o=1;switch(n){case m.NODE_TYPE_OWN_WORKFLOW:case m.NODE_TYPE_SC_BIRTHDAY:case m.NODE_TYPE_SC_DOI:case m.NODE_TYPE_SC_ABTEST:o=4}var r=t.helper.width()/2,a=t.helper.height()/2;if(t.offset.left+r>=i.left&&t.offset.top+a>=i.top&&t.offset.left+r<=i.left+b&&t.offset.top+a<=i.top+w){var s,l;if(v.saveSnapshot(),S.count()){var c=t.offset.left-r/o-getCanvasOffsetX(),u=t.offset.top-a/o-getCanvasOffsetY(),d=Math.round((c-C)/E.getScaledGridSize()),h=Math.round((u-_)/E.getScaledGridSize());n==m.NODE_TYPE_IMPORT?l=S.addNodeSequence([n,m.NODE_TYPE_DEADLINE],d,h):s=S.addNode(n,d,h)}else n==m.NODE_TYPE_IMPORT?l=S.addNodeSequence([n,m.NODE_TYPE_DEADLINE],0,0):s=S.addNode(n,0,0),C=t.offset.left-r/o-getCanvasOffsetX(),_=t.offset.top-a/o-getCanvasOffsetY();if(l)l.forEach(function(e){justifyNodeElement(e)}),l.reduce(function(e,t){return v.connectNodes(e.element.id,t.element.id,!0),t});else if(s)switch(n){case m.NODE_TYPE_OWN_WORKFLOW:case m.NODE_TYPE_SC_BIRTHDAY:case m.NODE_TYPE_SC_DOI:case m.NODE_TYPE_SC_ABTEST:S.normalizeNodes(),v.editNode(s,!0);break;case m.NODE_TYPE_ACTION_BASED_MAILING:case m.NODE_TYPE_DATE_BASED_MAILING:var p=v.getCMNodes().getNodesByType(m.NODE_TYPE_DEADLINE);if(0<p.length)for(var f=0;f<p.length;f++){var g=p[f];g.filled&&(g.data.deadlineType=constants.deadlineTypeDelay,v.updateNode(g))}justifyNodeElement(s);break;default:justifyNodeElement(s)}(l||s)&&rearrangeStage(),v.callWorkflowManagerStateChangedCallback()}R=v.STATE_WAITING}}}).dblclick(function(e){var t,n=$(this).attr("type");function i(e,t){if(n==m.NODE_TYPE_IMPORT)return S.addNodeSequence([n,m.NODE_TYPE_DEADLINE],e,t);var i=S.addNode(n,e,t);if(i){switch(n){case m.NODE_TYPE_OWN_WORKFLOW:case m.NODE_TYPE_SC_BIRTHDAY:case m.NODE_TYPE_SC_DOI:case m.NODE_TYPE_SC_ABTEST:v.editNode(i,!0)}return[i]}return!1}if(v.saveSnapshot(),S.count())for(var o=E.pxToCoordinate(E.getScaledNodeSize()),r=0;r<=f;r+=o){for(var a=0;a<=p&&!(t=i(a,r));a+=o);if(t)break}else t=i(0,0),C=p/2,_=f/2;t&&(t.forEach(function(e){justifyNodeElement(e)}),t.reduce(function(e,t){return v.connectNodes(e.element.id,t.element.id,!0),t}),rearrangeStage(),$(t[0].elementJQ).click()),v.callWorkflowManagerStateChangedCallback()}),$(document).keydown(function(e){e.keyCode==g.dragStageKeyCode?e.target&&!$(e.target).is("input, textarea")&&R!=v.STATE_SPACE_RESTORED&&(R==v.STATE_WAITING&&($("#editorCanvas").selectable("destroy"),$(S.getIconNodesSelector()).draggable("disable"),R=v.STATE_DRAGGING_STAGE_WAIT_MOUSE),e.preventDefault(),e.stopPropagation()):e.keyCode==g.multiConnectionKeyCode&&(B=!0)}),$(document).keyup(function(e){e.keyCode==g.dragStageKeyCode?e.target&&!$(e.target).is("input, textarea")&&(R!=v.STATE_DRAGGING_STAGE_WAIT_MOUSE&&R!=v.STATE_DRAGGING_STAGE||($("#editorCanvas").selectable(H()),$(S.getIconNodesSelector()).draggable("enable"),e.stopPropagation(),R=v.STATE_WAITING)):e.keyCode==g.multiConnectionKeyCode?B=!1:g.deleteKeyCode==e.keyCode&&v.deleteSelectedNode()});var te=!1,ie=!1,ne=!1,oe=!1,re=!1,ae=!1;y.mousedown(function(e){R==v.STATE_DRAGGING_STAGE_WAIT_MOUSE&&(te=e.pageX,ie=e.pageY,R=v.STATE_DRAGGING_STAGE,ne=parseInt(u.css("width")),oe=parseInt(u.css("height")),re=parseInt(u.css("left")),ae=parseInt(u.css("top")),e.preventDefault(),e.stopPropagation())}),jQuery(document).mousemove(function(e){R==v.STATE_DRAGGING_STAGE&&(u.css({left:re+e.pageX-te,top:ae+e.pageY-ie,width:ne-e.pageX+te,height:oe-e.pageY+ie}),e.preventDefault(),e.stopPropagation())}),jQuery(document).mouseup(function(e){R==v.STATE_DRAGGING_STAGE&&(R=v.STATE_DRAGGING_STAGE_WAIT_MOUSE,updateNodeAdditionalViewElements(),updateEditorCanvas(),resetJsPlumber(),e.preventDefault(),e.stopPropagation())}),jQuery(document).click(function(e){R!=v.STATE_WAITING&&R!=v.STATE_SPACE_RESTORED||(!jQuery.browser.msie&&1==e.which||jQuery.browser.msie)&&(null!=z&&function(e,t){return e===t||e.screenX==t.screenX&&e.screenY==t.screenY}(z,e.originalEvent)||AGN.Lib.WM.CampaignManagerSelection.clear(),z=void 0)}),AGN.Lib.WM.CampaignManagerToolbar.init({deleteSelected:function(){v.deleteSelectedNode()},connectSelected:function(){return connectSelectedNodes()},undoSelected:function(){v.undo()},zoomMinSelected:function(){var e=jQuery("#slider"),t=e.slider("option","min");if(t<e.slider("option","value")){var i=e.slider("option","value")-e.slider("option","step");e.slider("option","value",i<t?t:i)}},zoomMiddleSelected:function(){var e=jQuery("#slider");e.slider("option","value",Math.round(e.slider("option","max")/2))},zoomMaxSelected:function(){var e=jQuery("#slider"),t=e.slider("option","max");if(e.slider("option","value")<t){var i=e.slider("option","value")+e.slider("option","step");e.slider("option","value",t<i?t:i)}},doAutoLayout:function(){D.layoutWorkflow(S.getNodes(),O),_=C=15,rearrangeStage()}}),AGN.Lib.WM.CampaignManagerSelection.init({nodeSelector:S.getIconNodesSelector(),onSelectionChanged:function(){var e=this.getSelected();e&&e.length?(AGN.Lib.WM.CampaignManagerToolbar.setDeletionAvailable(!0),AGN.Lib.WM.CampaignManagerToolbar.arrowMode&&null!=this.prevSelected&&v.connectNodes(this.prevSelected,this.lastSelected,!0)):AGN.Lib.WM.CampaignManagerToolbar.setDeletionAvailable(!1)}}),s||AGN.Lib.WM.CampaignManagerContextMenu.init({nodeSelector:S.getIconNodesSelector(),campaignManager:v,campaignManagerSelection:AGN.Lib.WM.CampaignManagerSelection}),u.selectable(H())}}(),AGN.Lib.WM.AutoLayout=function(b){var w=Math.round(1.5*b.nodeSize/b.gridSize),C=Math.round(1.8*b.nodeSize/b.gridSize);this.layoutWorkflow=function(e,t){var i=[],n=1,o=0,r=S(e,t);if(0<r.length)for(var a=0;a<r.length;a++){var s=[],l=[];for(l.push(r[a]);0<l.length;){for(var c=0-Math.round((l.length-1)*C/2),u=[],d=0;d<l.length;d++){var h=l[d];if(-1==i.indexOf(h.id)){h.x=n,h.y=c+d*C,h.y<o&&(o=h.y);var p=x(e,h,t);u=u.concat(p),i.push(h.id)}}s=l,l=[],jQuery.each(u,function(e,t){-1===jQuery.inArray(t,l)&&l.push(t)});var f=Math.abs(s.length-l.length);if(n+=1<f?w+Math.round(b.nodeSize/b.gridSize*.5*f):w,A(s)&&A(l)){var g=E(s);for(d=0;d<g.length;d++){var m=x(e,g[d],t);for((l=_(l,m)).push(g[d]),i=_(i,[g[d].id]),k=0;k<s.length;k++){var v=s[k];v.y>g[d].y&&(v.y-=C)}}}}}for(d in e){var y=e[d];-1==i.indexOf(y.id)&&(y.y=0,y.x=n,n+=w),y.y+=1-o}};var _=function(e,i){var n=[];return jQuery.each(e,function(e,t){-1===jQuery.inArray(t,i)&&n.push(t)}),n},A=function(e){for(var t=0;t<e.length;t++){var i=e[t];if(o(i))return!0}return!1},o=function(e){return"mailing"==e.type||"actionbased_mailing"==e.type||"datebased_mailing"==e.type||"followup_mailing"==e.type},E=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];o(n)&&t.push(n)}return t},x=function(e,n,t){for(var i=[],o=0;o<t.length;o++){var r=t[o];if(n.element.id==r.source){for(var a in e){var s=e[a];s.element.id==r.target&&i.push(s)}"decision"==n.type&&i.sort(function(e,t){if(n.y>=e.y&&n.y>=t.y){var i=e.y-t.y;return 0==i?e.x-t.x:i}return e.y-t.y})}}return i},S=function(e,t){var i=[];for(var n in e){for(var o=e[n],r=!1,a=!1,s=0;s<t.length;s++){var l=t[s];o.element.id==l.source?a=!0:o.element.id==l.target&&(r=!0)}a&&!r&&i.push(o)}return i}},AGN.Lib.WM.ChainProcessor=function(e){function t(e){a=e}function i(e){var t={};return e.forEach(function(e){t[e.id]=e}),t}function n(e){var o={};return e.forEach(function(n){n.connections&&n.connections.forEach(function(e){var t=n.id,i=e.targetIconId;o[i]||(o[i]={}),o[i][t]=!0})}),o}this.STATE_IDLE=1,this.STATE_PROCESSING_CHAIN=2,this.STATE_TIMER_WAITING=3;var p=this,r=e.campaignManager,o=e.editorsHelper,f=e.nodeFactory,a=this.STATE_IDLE;this.updateParameterValueAfterDecision=function(){if(r.getCurrentState()==r.STATE_WAITING){t(p.STATE_PROCESSING_CHAIN);var o=r.getCMNodes().getNodeIdPrefix(),e=r.getIconsForSubmission(),u=i(e),d=function(e){var o={};return e.forEach(function(n){n.connections&&n.connections.forEach(function(e){var t=n.id,i=e.targetIconId;o[t]||(o[t]={}),o[t][i]=!0})}),o}(e),h=n(e);e.filter(function(e){return e.type==f.NODE_TYPE_DECISION}).forEach(function(e){if(e.decisionType==constants.decisionTypeAutoOptimization){var t=function(e,t,i){for(var n=i?d:h,o=Object.keys(n[e]||{}),r={};0<o.length;){var a=o;o=[];for(var s=0;s<a.length;s++){var l=a[s],c=u[l];if(c.type===t)return c;r[l]=!0,Object.keys(n[l]||{}).forEach(function(e){r[e]||o.push(e)})}}return!1}(e.id,f.NODE_TYPE_PARAMETER,!0);if(t&&!1===t.editable){var i=r.getCMNodes().getNodeById(o+t.id),n=function(e){for(var t=p.getIncomingChainsForIcon(e),i={},n=[],o=0;o<t.length;o++){var r,a=t[o];a[1]&&a[1].type==f.NODE_TYPE_MAILING&&a[2]&&a[2].type==f.NODE_TYPE_PARAMETER&&(i[(r=a[3]&&a[3].type==f.NODE_TYPE_PARAMETER?a[3]:a[2]).id]||(i[r.id]=!0,n.push(r)))}var s=0;if(0<n.length){for(var l=0;l<n.length;l++){var c=n[l];if(!c.filled)return null;s+=parseInt(c.value,10)}return Math.max(0,100-s)}return null}(e.id);null==n?(i.data.value=0,i.filled=!1):(i.data.value=n,i.filled=!0),r.updateNode(i)}}}),t(p.STATE_IDLE)}else a==p.STATE_IDLE&&(setTimeout(p.updateParameterValueAfterDecision,100),t(p.STATE_TIMER_WAITING))},this.getIncomingChainsForIcon=function(e){var t=r.getIconsForSubmission(),a=i(t),s=n(t);return function t(e,i){var n=[],o=a[e];if(o&&!i[e]){var r=Object.keys(s[e]||{});0<r.length?(i[e]=!0,r.forEach(function(e){t(e,i).forEach(function(e){e.unshift(o),n.push(e)})}),i[e]=!1):n.push([o])}return n}(e||o.curEditingNode.id,{})}},function(){function n(e,t){this.manager=e,this.commentPopover=null,this.timeoutId=void 0,this.isPdf=e.isPdf,this.commentCounter=1,this.workflowURL=t.workflowURL,this.componentURL=t.componentURL}var o=AGN.Lib.Popover,r=["mailing","actionbased_mailing","datebased_mailing","followup_mailing"];n.popoverOptions=function(e,t){return{trigger:"manual",html:!0,template:'<div class="popover popover-wide" role="tooltip" ><div class="arrow"></div><div class="popover-content" style="width: auto; height: auto; max-width: 300px; max-height: 350px; overflow: auto;"></div></div>',content:function(){return e.generatePopoverContent(t)}}},n.prototype.generatePopoverContent=function(e){var t="",i=0;if(r.includes(e.type)){var n=0<(i=e.data.mailingId)?this.getMailingThumbnail(this.manager.pageContextSessionId,i):"";""!=n&&(t="<img src='"+n.src+"' style='width: 100%; height: 100%;'/>")}var o=e.data.iconComment;return null!=o&&""!=o.trim()&&(t+="<div>"+o+"</div>"),t},n.prototype.getMailingThumbnail=function(e,t){var i=this,n="";return jQuery.ajax({type:"POST",url:i.workflowURL,async:!1,data:{method:"getMailingThumbnail",mailingId:t},success:function(e){0<e&&((n=new Image).src=i.componentURL.replace("{component-id}",e))}}),n},n.prototype.showCommentPopover=function(e){var t=e.data.iconComment,i=e.data.mailingId||0;if(null!=t&&""!=t.trim()||!(i<=0)){var n=$(e.elementJQ),o=this.manager.getDraggedElements();if(o)for(var r=0;r<o.length;r++)if(o[r].DOMElement==n[0])return;this.updateComments(e),this.showPopover()}},n.prototype.hideCommentPopover=function(){this.hidePopover(!1)},n.prototype.updateComments=function(e){this.commentPopover&&this.commentPopover.destroy();var t=this;this.commentPopover=o.new(e.elementJQ,n.popoverOptions(t,e));var i=this.commentPopover.tip();i.on("mouseenter",function(){t.showPopover(e)}),i.on("mouseleave",function(){t.hidePopover(!0)})},n.prototype.stopHiding=function(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0)},n.prototype.showPopover=function(){this.stopHiding(),this.commentPopover.show()},n.prototype.hidePopover=function(e){if(this.stopHiding(),!0===e)this.commentPopover&&this.commentPopover.hide();else{var t=this;this.timeoutId=setTimeout(function(){t.hidePopover(!0)},200)}},n.prototype.showCommentEditDialog=function(){var e=this.manager.getCampaignManagerNodes().getNodeById(AGN.Lib.WM.CampaignManagerSelection.getSelected()[0]);this.manager.checkActivation()||this.manager.getEditorsHelper().showIconCommentDialog(e)},n.prototype.addCommentEllipsis=function(e){var t=e.data.iconComment;this.isPdf?null!=t&&""!=t.trim()&&this.showCommentFootnote(e.elementJQ,t):null!=t&&""!=t.trim()?e.elementJQ.addClass("icon-commented"):e.elementJQ.removeClass("icon-commented")},n.prototype.showCommentFootnote=function(e,t){var i="icon-footnote-"+this.commentCounter;$("#footnotes-container table#comment-footnotes-list").append('<tr id="'+i+'"><td>'+this.commentCounter+". "+t+"</td></tr>"),e.append('<a aria-describedby="footnote-label" href="#'+i+"\"><span class='icon-footnote-number badge badge-info'>"+this.commentCounter+"</span>"),this.commentCounter++},AGN.Lib.WM.CommentControls=n}(),function(){function n(e,t){this.manager=e,this.commentPopover=null,this.timeoutId=void 0,this.isPdf=e.isPdf,this.commentCounter=1,this.componentURL=t.componentURL}var o=AGN.Lib.Popover,r=["mailing","actionbased_mailing","datebased_mailing","followup_mailing"];n.popoverOptions=function(e,t){return{trigger:"manual",html:!0,template:'<div class="popover popover-wide" role="tooltip" ><div class="arrow"></div><div class="popover-content" style="width: auto; height: auto; max-width: 300px; max-height: 350px; overflow: auto;"></div></div>',content:function(){return e.generatePopoverContent(t)}}},n.prototype.generatePopoverContent=function(e){var t="",i=0;if(r.includes(e.type)){var n=0<(i=e.data.mailingId)?this.getMailingThumbnail(i):"";""!=n&&(t="<img src='"+n.src+"' style='width: 100%; height: 100%;'/>")}var o=e.data.iconComment;return null!=o&&""!=o.trim()&&(t+="<div>"+o+"</div>"),t},n.prototype.getMailingThumbnail=_.memoize(function(e){var t=this,i="";return jQuery.ajax({type:"POST",url:AGN.url("/workflow/getMailingThumbnail.action"),async:!1,data:{mailingId:e},success:function(e){0<e&&((i=new Image).src=t.componentURL.replace("{component-id}",e))}}),i}),n.prototype.showCommentPopover=function(e){var t=e.data.iconComment,i=e.data.mailingId||0;if(null!=t&&""!=t.trim()||!(i<=0)){var n=$(e.elementJQ),o=this.manager.getDraggedElements();if(o)for(var r=0;r<o.length;r++)if(o[r].DOMElement==n[0])return;this.updateComments(e),this.showPopover()}},n.prototype.hideCommentPopover=function(){this.hidePopover(!1)},n.prototype.updateComments=function(e){this.commentPopover&&this.commentPopover.destroy();var t=this;this.commentPopover=o.new(e.elementJQ,n.popoverOptions(t,e));var i=this.commentPopover.tip();i.on("mouseenter",function(){t.showPopover(e)}),i.on("mouseleave",function(){t.hidePopover(!0)})},n.prototype.stopHiding=function(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0)},n.prototype.showPopover=function(){this.stopHiding(),this.commentPopover.show()},n.prototype.hidePopover=function(e){if(this.stopHiding(),!0===e)this.commentPopover&&this.commentPopover.hide();else{var t=this;this.timeoutId=setTimeout(function(){t.hidePopover(!0)},200)}},n.prototype.showCommentEditDialog=function(){var e=this.manager.getCampaignManagerNodes().getNodeById(AGN.Lib.WM.CampaignManagerSelection.getSelected()[0]);this.manager.checkActivation()||this.manager.getEditorsHelper().showIconCommentDialog(e)},n.prototype.addCommentEllipsis=function(e){var t=e.data.iconComment;this.isPdf?null!=t&&""!=t.trim()&&this.showCommentFootnote(e.elementJQ,t):null!=t&&""!=t.trim()?e.elementJQ.addClass("icon-commented"):e.elementJQ.removeClass("icon-commented")},n.prototype.showCommentFootnote=function(e,t){var i="icon-footnote-"+this.commentCounter;$("#footnotes-container table#comment-footnotes-list").append('<tr id="'+i+'"><td>'+this.commentCounter+". "+t+"</td></tr>"),e.append('<a aria-describedby="footnote-label" href="#'+i+"\"><span class='icon-footnote-number badge badge-info'>"+this.commentCounter+"</span>"),this.commentCounter++},AGN.Lib.WM.CommentControlsNew=n}(),function(){var e={nodeSelector:"",init:function(e){this.nodeSelector=e.nodeSelector;var s=e.campaignManager,l=e.campaignManagerSelection;jQuery.contextMenu({selector:this.nodeSelector,build:function(e,i){var n=i.currentTarget.id;l.isSelected(n)||(l.clear(),l.select(jQuery("#"+n)));var o={};if(1<l.selected.length){o.connect={name:t("workflow.connect"),icon:"connect",callback:function(e,t){if(2==l.selected.length)s.connectIntermediateNodes(l.selected);else{var i=null;jQuery.each(l.selected,function(e,t){null!=i&&s.connectNodes(i,t,!0),i=t})}}};var r=s.getConnectionsFromSelected(l.selected);0<r.length&&(o.disconnect={name:t("workflow.disconnect"),icon:"disconnect",callback:function(e,t){s.deleteConnections(r)}})}if(1==l.selected.length){var a=s.getNodesFromSelected(l.selected)[0];o.edit={name:t("workflow.defaults.edit"),icon:"edit",disabled:!1===a.data.editable,callback:function(e,t){s.editNode(void 0,!0)}}}return o.delete={name:t("workflow.defaults.delete"),icon:"delete",callback:function(e,t){s.deleteSelectedNode()}},o.iconComment={name:t("workflow.defaults.comment"),icon:"comment",callback:function(e,t){s.getCommentControls().showCommentEditDialog()}},{callback:function(e,t){},items:o}}}),jQuery.contextMenu({selector:"._jsPlumb_connector",build:function(e,i){var n={};if(1<l.selected.length){var o=s.getConnectionsFromSelected(l.selected);0<o.length&&(n.disconnect={name:t("workflow.disconnect"),icon:"disconnect",callback:function(e,t){s.deleteConnections(o)}})}return n.delete={name:t("workflow.defaults.delete"),icon:"delete",callback:function(e,t){s.deleteConnectionByHtmlElement(t.$trigger[0])}},{callback:function(e,t){},items:n}}})}};AGN.Lib.WM.CampaignManagerContextMenu=e}(),AGN.Lib.WM.EditorsHelper=function(a,s,l){this.editors=[],this.curEditor,this.curEditingNode,this.showEditDialog=function(n,o){"start"==n.type&&!n.filled&&a.nodeHasIncomingConnections(n)&&(n.type="stop"),"stop"!=n.type||n.filled||a.nodeHasIncomingConnections(n)||(n.type="start"),this.curEditingNode=n,this.curEditor=this.editors[n.type],this.curEditor.fillEditor(n);var r=this;this.getEditorPanel(n.type).dialog({open:function(e,t){var i=r.getEditorPanel(n.type).parent().find(".ui-dialog-title");i.empty(),i.append('<span class="dialog-title-image">'+r.curEditor.getTitle()+"</span>"),i.find(".dialog-title-image").css("background-image","url(' "+l.imagePath+s.getSmallImageForNode(n)+"')"),n.type==s.NODE_TYPE_RECIPIENT&&(1==n.isDependent?r.getEditorPanel(n.type).parent().find(".recipient-editor-select").prop("disabled",!0):r.getEditorPanel(n.type).parent().find(".recipient-editor-select").prop("disabled",!1)),jQuery(e.target).find(".js-datepicker").each(function(e,t){var i=jQuery(t).pickadate("picker");i.set("select",i.get("select"))}),o&&function(e){var t=$(e.target);t.find(".disable-for-active").each(function(e,t){$(t).attr("disabled",!0)}),t.find(".hide-for-active").each(function(e,t){$(t).hide()}),t.find(":input:enabled[type!='hidden']").not(":button, .select2, .js-select, .js-datepicker").each(function(e,t){"radio"==$(t).prop("type")||"checkbox"==$(t).prop("type")?$(t).attr("disabled",!0):$(t).attr("readonly",!0)}),t.find(":input:enabled.select2, :input:enabled.js-select, .select2-container").not(".disabled, :disabled").each(function(e,t){"text"==$(t).prop("type")||$(t).is("input, select")?$(t).attr("disabled",!0):$(t).select2("disable")}),t.find(".js-datepicker").each(function(e,t){$(t).attr("disabled",!0)})}(e)},close:function(e,t){null!=r.curEditor.closeEditor&&r.curEditor.closeEditor()},width:650,height:"auto",minHeight:"auto",modal:!0,resizable:!1})},this.showIconCommentDialog=function(e){this.curEditingNode=e,this.curEditor=this.editors["icon-comment"],this.curEditor.fillEditor(e);var i=this;this.getEditorPanel("icon-comment").dialog({open:function(e,t){i.getEditorPanel("icon-comment").parent().find(".ui-dialog-titlebar").hide()},width:300,height:"auto",minHeight:"auto",modal:!0,resizable:!1,fluid:!0,position:{my:"left top",at:"left bottom",of:e.element}})},this.saveIconComment=function(e){var t=this.curEditingNode,i={iconComment:e};jQuery.extend(t.data,i),a.getCommentControls().addCommentEllipsis(t)},this.saveCurrentEditor=function(t,i){var n=this,o=this.curEditor.saveEditor();if(t||this.cancelEditor(),this.isNodeIsMailing(this.curEditingNode)){var r=o.mailingId;i&&i.checkDifferentMailingLists(r,function(e){n.mailingSpecificSave(t,e,o,i)},function(e){n.curEditor.storedMailingContent=e,n.curEditor.storedMailingId=r,n.curEditor.storedLeaveOpen=t,n.curEditor.storedEditorData=o,i.initOneMailinglistWarningDialog(i)})}else"ownWorkflow"!=this.curEditingNode.type&&"scBirthday"!=this.curEditingNode.type&&"scDOI"!=this.curEditingNode.type&&"scABTest"!=this.curEditingNode.type&&a.saveSnapshot(),jQuery.extend(this.curEditingNode.data,o),this.curEditingNode.filled||this.isNodeIsMailing(this.curEditingNode)||(this.curEditingNode.filled=!0),this.curEditingNode.filled&&"function"==typeof this.curEditor.isSetFilledAllowed&&!this.curEditor.isSetFilledAllowed()&&(this.curEditingNode.filled=!1),a.updateNode(this.curEditingNode),a.updateParameterValueAfterDecision(),a.callWorkflowManagerStateChangedCallback()},this.isNodeIsMailing=function(e){return"mailing"==e.type||"actionbased_mailing"==e.type||"datebased_mailing"==e.type||"followup_mailing"==e.type},this.mailingSpecificSave=function(e,t,i,n){a.saveSnapshot(),jQuery.extend(this.curEditingNode.data,i),this.curEditingNode.data.iconTitle=this.curEditingNode.iconTitle,this.curEditingNode.filled&&"function"==typeof this.curEditor.isSetFilledAllowed&&!this.curEditor.isSetFilledAllowed()&&(this.curEditingNode.filled=!1),a.updateNode(this.curEditingNode),this.isNodeIsMailing(this.curEditingNode)&&n.trySupplementNodes(t),a.updateParameterValueAfterDecision(),a.callWorkflowManagerStateChangedCallback()},this.mailingSpecificSaveAfterMailinglistCheckModal=function(e){this.curEditor.storedMailingContent.mailinglistId=e.configuredMailingData.mailinglistId,this.mailingSpecificSave(this.curEditor.storedLeaveOpen,this.curEditor.storedMailingContent,this.curEditor.storedEditorData,e)},this.cancelEditor=function(){this.getEditorPanel(this.curEditingNode.type).dialog("instance")&&this.getEditorPanel(this.curEditingNode.type).dialog("close")},this.getEditorPanel=function(e){return jQuery("#"+("stop"==e?"start":e)+"-editor")},this.formToObject=function(e){var t=jQuery('form[name="'+e+'"]').serializeArray(),n={};return jQuery.each(t,function(){if(-1!=this.name.indexOf("[")){var e=this.name.substring(0,this.name.indexOf("["));null==n[e]&&(n[e]=[]);var t=this.name.substring(this.name.indexOf("[")+1,this.name.indexOf("]"));if(null==n[e][t]&&(n[e][t]={}),-1!=this.name.indexOf(".")){var i=this.name.substring(this.name.indexOf(".")+1);n[e][t][i]=this.value}else n[e][t]=this.value}else n[this.name]=this.value||""}),jQuery('form[name="'+e+'"] [type="checkbox"]').each(function(){jQuery(this).prop("checked")||(n[this.name]=!1)}),n},this.fillFormFromObject=function(e,t,i,n){if("string"==typeof t)this.fillFormFromObjectItem(e,i,i,t||n);else for(var o in t){var r=t[o];!r&&n&&n[o]&&(r=n[o]),this.fillFormFromObjectItem(e,i,o,r)}},this.fillFormFromObjectItem=function(e,t,i,n){if("[object Array]"===Object.prototype.toString.call(n))for(var o=0;o<n.length;o++)this.fillFormFromObject(e,n[o],i+"["+o+"].");else{var r=jQuery('form[name="'+e+'"] [name="'+t+i+'"]');switch(r.attr("type")){case"checkbox":r.prop("checked",Boolean(n));break;case"radio":r.filter('[value="'+n+'"]').prop("checked",!0);break;default:switch(r.prop("tagName")){case"SELECT":r.val(n),this.initSelectWithValueOrChooseFirst(r,n);break;default:r.val(n)}}}},this.processForward=function(e,t,i,n,o){$("#forwardName").val(e),$("#forwardParams").val("nodeId="+a.extractIdFromConnectionEnd(this.curEditingNode.elementJQ.attr("id"))+";elementId="+encodeURIComponent(t)+(o?";"+o:"")),this.curEditor.safeToSave&&this.saveCurrentEditor(),n(!1)},this.getFirstOptionValue=function(e){return AGN.Lib.Select.get(e).getFirstValue()},this.resetSelect=function(e){AGN.Lib.Select.get(e).clear()},this.initSelectWithFirstValue=function(e){AGN.Lib.Select.get(e).selectFirstValue()},this.initSelectWithValueOrChooseFirst=function(e,t){AGN.Lib.Select.get(e).selectValueOrSelectFirst(t)},this.deleteNode=function(e){a.deleteNode(a.getCMNodes().getNodeIdPrefix()+e,!1,!1)},this.openNode=function(e,t){a.editNode(e,t)}},AGN.Lib.WM.IconsSetLoader=function(l){this.loadIconsSetAJAX=function(n,o){var e,t="ownWorkflow"!==n.type,r={x:0,y:0,icons:[]},a=this;(e=t&&!o?{method:"getSampleWorkflowContent",type:n.type}:{method:"getWorkflowContent",workflowId:n.data.ownWorkflowId}).isWithContent=n.data.copyContent;var s=l.getCMNodes();$.ajax({type:"POST",url:"workflow.do;jsessionid="+l.getSessionId(),data:e,async:!1}).done(function(i){$.ajax({type:"POST",url:"workflow.do;jsessionid="+l.getSessionId(),data:{method:"getAllMailingSorted",sortField:"shortname",sortDirection:"asc"},async:!1}).always(function(e){var t={};e.forEach(function(e){t[e.mailingID]=e.shortname}),l.extendAllUsedEntities({allMailings:t}),r.icons=i,n.data.copyContent=!0,1<l.getCampaignManagerNodes().count()&&a.removeStartAndEndIcons(r),o||a.generateNewIDs(r.icons),a.expand(n,r),s.openNodeIcon()})})},this.generateNewIDs=function(e){var t={};e.forEach(function(e){t[e.id]=l.getCMNodes().generateId()}),e.forEach(function(e){e.id=t[e.id],e.connections?e.connections=e.connections.map(function(e){return{targetIconId:t[e.targetIconId]}}):e.connections=[]})},this.removeStartAndEndIcons=function(e){var t=e.icons,i={};t.forEach(function(e){"start"!==e.type&&"stop"!==e.type||(i[e.id]=!0)}),t=t.filter(function(e){return!i[e.id]&&(e.connections?e.connections=e.connections.filter(function(e){return!i[e.targetIconId]}):e.connections=[],!0)});var n=1e5,o=1e5;t.forEach(function(e){n=Math.min(n,e.x),o=Math.min(o,e.y)}),(0<n||0<o)&&t.forEach(function(e){e.x-=n,e.y-=o}),e.icons=t},this.expand=function(t,e){var i=e.icons,n=l.getCurrentState();l.setCurrentState(l.STATE_EXPANDING_ICONS_SET);var o=l.needSaveSnapshot;l.needSaveSnapshot=!1,e.x=t.x,e.y=t.y,l.deleteNode(t.elementJQ.attr("id"),!1,!1),i.forEach(function(e){e.x+=t.x,e.y+=t.y}),r(e),l.restoreWorkflow(i),l.callWorkflowManagerStateChangedCallback(),l.needSaveSnapshot=o,i.forEach(function(e){e.x-=t.x,e.y-=t.y}),l.setCurrentState(n)};var r=function(e){var t=c(e.icons),i=l.getCMNodes().getNodesFromRegion(e.x,e.y,e.x+t.maxX,e.y+t.maxY,1);if(!$.isEmptyObject(i))for(var n in i)if(i.hasOwnProperty(n)){var o=i[n],r=0,a=0;if(o.y<e.y){var s=e.y-o.y-3;a=0===Math.abs(s)?-1:s}else r=t.maxX-e.x,a=t.maxY-e.y;o.x=o.x+r,o.y=o.y+a}},c=function(e){var t=0,i=0;return e.forEach(function(e){e.x>t&&(t=e.x),e.y>i&&(i=e.y)}),{maxX:t,maxY:i}}},AGN.Lib.WM.IconsSetLoaderNew=function(l){this.loadIconsSetAJAXNew=function(n,o){var e,t,i="ownWorkflow"!==n.type,r={x:0,y:0,icons:[]},a=this;e=i&&!o?(t=!0,{type:n.type}):(t=!1,{workflowId:n.data.ownWorkflowId,isWithContent:n.data.copyContent});var s=l.getCMNodes();$.ajax({type:"POST",url:t?AGN.url("/workflow/getSampleWorkflowContent.action"):AGN.url("/workflow/getWorkflowContent.action"),data:e,async:!1}).done(function(i){$.ajax({type:"POST",url:AGN.url("/workflow/getAllMailingSorted.action"),data:{sortField:"shortname",sortDirection:"asc"},async:!1}).always(function(e){var t={};e.forEach(function(e){t[e.mailingID]=e.shortname}),l.extendAllUsedEntities({allMailings:t}),r.icons=i,n.data.copyContent=!0,1<l.getCampaignManagerNodes().count()&&a.removeStartAndEndIcons(r),o||a.generateNewIDs(r.icons),a.expand(n,r),s.openNodeIcon()})})},this.generateNewIDs=function(e){var t={};e.forEach(function(e){t[e.id]=l.getCMNodes().generateId()}),e.forEach(function(e){e.id=t[e.id],e.connections?e.connections=e.connections.map(function(e){return{targetIconId:t[e.targetIconId]}}):e.connections=[]})},this.removeStartAndEndIcons=function(e){var t=e.icons,i={};t.forEach(function(e){"start"!==e.type&&"stop"!==e.type||(i[e.id]=!0)}),t=t.filter(function(e){return!i[e.id]&&(e.connections?e.connections=e.connections.filter(function(e){return!i[e.targetIconId]}):e.connections=[],!0)});var n=1e5,o=1e5;t.forEach(function(e){n=Math.min(n,e.x),o=Math.min(o,e.y)}),(0<n||0<o)&&t.forEach(function(e){e.x-=n,e.y-=o}),e.icons=t},this.expand=function(t,e){var i=e.icons,n=l.getCurrentState();l.setCurrentState(l.STATE_EXPANDING_ICONS_SET);var o=l.needSaveSnapshot;l.needSaveSnapshot=!1,e.x=t.x,e.y=t.y,l.deleteNode(t.elementJQ.attr("id"),!1,!1),i.forEach(function(e){e.x+=t.x,e.y+=t.y}),r(e),l.restoreWorkflow(i),l.callWorkflowManagerStateChangedCallback(),l.needSaveSnapshot=o,i.forEach(function(e){e.x-=t.x,e.y-=t.y}),l.setCurrentState(n)};var r=function(e){var t=c(e.icons),i=l.getCMNodes().getNodesFromRegion(e.x,e.y,e.x+t.maxX,e.y+t.maxY,1);if(!$.isEmptyObject(i))for(var n in i)if(i.hasOwnProperty(n)){var o=i[n],r=0,a=0;if(o.y<e.y){var s=e.y-o.y-3;a=0===Math.abs(s)?-1:s}else r=t.maxX-e.x,a=t.maxY-e.y;o.x=o.x+r,o.y=o.y+a}},c=function(e){var t=0,i=0;return e.forEach(function(e){e.x>t&&(t=e.x),e.y>i&&(i=e.y)}),{maxX:t,maxY:i}}},function(){var se=AGN.Lib.Helpers;function le(e){this.rules=e}le.prototype.isConstraint=function(e){return _.isBoolean(e)||_.isFunction(e)},le.prototype.evaluate=function(e,t,i,n){return!0===e||!1===e?e:$.isFunction(e)?e(t,i,n):void 0},le.prototype.getRulesToCheck=function(e,t){return[{from:e.type,to:[t.type,"*"]},{from:"*",to:[t.type,"*"]}]},le.prototype.getRelevantConstraints=function(e,t){var o=this.isConstraint,i=this.getRulesToCheck(e,t),r=this.rules,a=[];return i.forEach(function(t){var i=!0;if(_.has(r,t.from)){var n=r[t.from];o(n)?(a.push(n),i=!1):t.to.forEach(function(e){_.has(r[t.from],e)&&(n=r[t.from][e],o(n)&&(a.push(n),i=!1))})}i&&"*"!=t.from&&a.push(!1)}),a},le.prototype.check=function(e,t,i){for(var n=this.getRelevantConstraints(e,t),o=!1,r=0;r<n.length;r++){if(!this.evaluate(n[r],e,t,i))return!1;o=!0}return o};AGN.Lib.WM.CampaignManagerNew=function(e){var m=AGN.Lib.WM.NodeFactory;this.IS_ACTION_BASED=!1,this.IS_DATE_BASED=!1,this.STATE_WAITING=0,this.STATE_DRAGGING_STAGE_WAIT_MOUSE=1,this.STATE_DRAGGING_STAGE=2,this.STATE_SELECTING_NODES=3,this.STATE_CREATING_NODE=4,this.STATE_CREATING_CONNECTION=5,this.STATE_SPACE_RESTORED=6,this.STATE_EXPANDING_ICONS_SET=7,this.STATE_AUTOMATICALLY_CREATING_CONNECTION=8,this.Z_INDEX_VIEW_PORT=10,this.Z_INDEX_ICON_PANEL=50,this.Z_INDEX_DRAGGABLE_BUTTON=60,this.Z_INDEX_ICON_NODE=10,this.Z_INDEX_CONNECT_RAPID_BUTTON=20,this.Z_INDEX_JSPLUMB_DRAG_OPTIONS=25,this.Z_INDEX_NAVIGATOR_GLOBE=30,this.Z_INDEX_NAVIGATOR_ARROWS=31,this.Z_INDEX_CONTEXT_MENU=40,this.CONNECTION_CONSTRAINTS={"*":{deadline:function(e,t,i){return!t.connections.incoming.some(function(e){return e.source in i&&"import"==i[e.source].type})},mailing:function(e,t){return 0==t.connections.incoming.length},datebased_mailing:function(e,t){return 0==t.connections.incoming.length}},start:{recipient:!0,form:!0,import:!0,export:!0},stop:!1,decision:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0},parameter:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0},deadline:{decision:!0,parameter:!0,report:!0,recipient:!0,archive:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0,import:!0,export:!0},report:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,archive:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0,import:!0,export:!0},recipient:{decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0,import:!0,export:!0},actionbased_mailing:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,import:!0,export:!0},datebased_mailing:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,import:!0,export:!0},followup_mailing:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,import:!0,export:!0},mailing:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,import:!0,export:!0},archive:{decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0,import:!0,export:!0},form:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,form:!0,archive:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0,import:!0,export:!0},import:{deadline:function(e){return 0==e.connections.outgoing.length}},export:{stop:!0,decision:!0,parameter:!0,deadline:!0,report:!0,recipient:!0,actionbased_mailing:!0,datebased_mailing:!0,followup_mailing:!0,mailing:!0,import:!0,export:!0,archive:!0,form:!0}};var v=this;this.workflowId=e.workflowId,this.pageContextSessionId=e.pageContextSessionId,this.isActivated=e.isActivated,this.isPdf=e.isPdfGenerating;var i="viewPort",y=jQuery("#"+i),b=y.get(0).clientWidth,w=y.get(0).clientHeight,n="editorCanvas",o=b,r=w,u=jQuery('<div id="'+n+'"></div>').appendTo("#"+i).css({position:"absolute",left:0,top:0,width:o,height:r}),d=0,h=0,C=e.editorPositionLeft,_=e.editorPositionTop,a=e.localeDateNTimePattern,p=!1,f=!1,s=e.noContextMenu,l=jQuery('<div id="bounder"></div>').appendTo("#"+n).css({position:"absolute"}),c=jQuery('<div id="navigatorBody"></div>').insertAfter("#"+i),g=e.campaignManagerSettings,A=e.restoreSpaceFields,E=e.campaignManagerScale,x=e.allUsedEntity,S=new AGN.Lib.WM.CampaignManagerNodes({nodesContainerDOMId:"bounder",localeDateNTimePattern:a,campaignManagerScale:E,campaignManager:v,nodeFactory:m,allUsedEntity:x}),T=new AGN.Lib.WM.EditorsHelper(v,m,g),D=new AGN.Lib.WM.AutoLayout(g),k=new AGN.Lib.WM.ChainProcessor({campaignManager:v,pageContextSessionId:this.pageContextSessionId,editorsHelper:T,nodeFactory:m}),R=this.STATE_WAITING,O=[],N=E.getCurrentScaleSliderPosition(),F=!1,M="",P=[],I=null,L=null,G=null,B=!1,j=null,W=new AGN.Lib.WM.CommentControlsNew(v,e);updateBoundNodesVariables=function(){var e=S.normalizeNodes();e.collapsedX&&(C-=e.collapsedX*E.getScaledGridSize()),e.collapsedY&&(_-=e.collapsedY*E.getScaledGridSize()),C<0&&(C=0);var t,i,n,o=S.getNodes();for(var r in o)S.updateNodeView(o[r],E,x.allMailings);var a=!1,s=!1,l=!1;for(r in o)n=parseInt(o[r].elementJQ.find("div.icon-extra-info").css("top")),t=parseInt(o[r].element.style.left)+parseInt(o[r].element.style.width),i=parseInt(o[r].element.style.top)+parseInt(o[r].element.style.height),(!1===a||a<t)&&(a=t),(!1===s||s<n)&&(s=n),(!1===l||l<i)&&(l=i);_<0&&(_=s||0),p=a,f=l},updateBoundNodesDOM=function(){l.css({left:C,top:_,width:p+E.getScaledGridSize(),height:f+E.getScaledGridSize()})},updateEditorCanvas=function(){updateBoundNodesVariables();var e=0,t=0,i=parseInt(u.css("left")),n=parseInt(u.css("top"));(C=parseInt(C)+i)<=0&&(e+=-C,d+=-C,C=0),(_=parseInt(_)+n)<=0&&(t+=-_,h+=-_,_=0),u.css({left:0,top:0,width:b+d,height:w+h}),y.scrollLeft(y.scrollLeft()+e),y.scrollTop(y.scrollTop()+t);var o=0;0<C-y.scrollLeft()?(o=y.scrollLeft(),C-=y.scrollLeft()):y.scrollLeft()-C>E.getScaledGridSize()&&(o=C,C=0),d-=o;var r=0;0<_-y.scrollTop()?(r=y.scrollTop(),_-=y.scrollTop()):y.scrollTop()-_>E.getScaledGridSize()&&(r=_,_=0),h-=r;var a,s,l=y.scrollLeft(),c=y.scrollTop();u.css({width:b+d,height:w+h}),y.scrollLeft(l-o),y.scrollTop(c-r),a=y.scrollLeft()+b<p?b+d-p:b+d-y.scrollLeft()-b,d-=a,s=y.scrollTop()+w<f?w+h-f:w+h-y.scrollTop()-w,h-=s,u.css({width:b+d,height:w+h}),updateBoundNodesDOM()},resetJsPlumber=function(){F?F.reset():(F=jsPlumb.getInstance()).bind("beforeDrop",function(e){if(!v.checkActivation())return v.connectIntermediateNodes(e.sourceId,e.targetId)}),F.bind("ready",function(){var e=[[.5,.6,0,1],[.5,.4,0,-1],[.6,.5,1,0],[.4,.5,-1,0]];F.setRenderMode(g.renderMode),F.importDefaults({Anchors:[e,e],DragOptions:{cursor:"pointer",zIndex:v.Z_INDEX_JSPLUMB_DRAG_OPTIONS},Endpoints:["Blank","Blank"],Connector:["Flowchart",{stub:5,gap:0,midpoint:.5}],PaintStyle:{strokeStyle:g.lineColor,lineWidth:E.getLineWidth()},ConnectionOverlays:[["PlainArrow",{width:E.getArrowWidth(),length:E.getArrowLength(),location:.52,id:"arrow"}]]}),F.draggable(jQuery(S.getIconNodesSelector()),getJSPlumbDraggableProperties()),S.resetUsedAnchors();for(var t=0;t<O.length;t++){var i=F.connect(O[t]);processJSPlumbConnection(i)}F.bind("jsPlumbConnection",function(e){v.connectNodes(e.sourceId,e.targetId,!1)||resetJsPlumber(),v.getCurrentState()!=v.STATE_AUTOMATICALLY_CREATING_CONNECTION&&updateEditorCanvas(),updateNodeAdditionalViewElements(),v.getCurrentState()!=v.STATE_AUTOMATICALLY_CREATING_CONNECTION&&updateEditorCanvas()})})},processJSPlumbConnection=function(e){for(var t={},i=0;i<e.endpoints.length;i++){var n=e.endpoints[i];t.hasOwnProperty(n.elementId)||(t[n.elementId]=[]),.5==n.anchor.x&&.6==n.anchor.y?-1==jQuery.inArray(S.BOTTOM,t[n.elementId])&&t[n.elementId].push(S.BOTTOM):.5==n.anchor.x&&.4==n.anchor.y?-1==jQuery.inArray(S.TOP,t[n.elementId])&&t[n.elementId].push(S.TOP):.6==n.anchor.x&&.5==n.anchor.y?-1==jQuery.inArray(S.RIGHT,t[n.elementId])&&t[n.elementId].push(S.RIGHT):.4==n.anchor.x&&.5==n.anchor.y&&-1==jQuery.inArray(S.LEFT,t[n.elementId])&&t[n.elementId].push(S.LEFT)}var o=S.getNodes();for(var i in o)t.hasOwnProperty(o[i].elementJQ.attr("id"))&&(o[i].usedAnchors=o[i].usedAnchors.concat(t[o[i].elementJQ.attr("id")]),jQuery.unique(o[i].usedAnchors))},rearrangeStage=function(){jQuery("#connectRapidButton").width(g.rapidButtonSize*E.getCurrentScale()),jQuery("#connectRapidButton").height(g.rapidButtonSize*E.getCurrentScale()),updateEditorCanvas(),resetJsPlumber(),updateNodeAdditionalViewElements()},updateNodeAdditionalViewElements=function(){var e=S.getNodes();for(var t in e)S.updateNodeAdditionalViewElements(e[t],E)},connectSelectedNodes=function(){var e=v.needSaveSnapshot;v.needSaveSnapshot=!1,v.saveSnapshot();var t=AGN.Lib.WM.CampaignManagerSelection.getSelected(),i=null,n=!1,o=t.slice(0);return o.sort(function(e,t){var i=S.getNodeById(e),n=S.getNodeById(t);return i.x<n.x?-1:i.x>n.x?1:i.y<n.y?-1:i.y>n.y?1:0}),jQuery.each(o,function(e,t){null!=i&&(v.connectNodes(i,t,!0),n=!0),i=t}),AGN.Lib.WM.CampaignManagerSelection.prevSelected=null,v.needSaveSnapshot=e,n},getCanvasOffsetX=function(){return jQuery("#toolbarLeft").offset().left+jQuery("#toolbarLeft").width()-y.scrollLeft()},getCanvasOffsetY=function(){return jQuery("#toolbarTop").offset().top+jQuery("#toolbarTop").height()-y.scrollTop()},justifyNodeElement=function(t){F.draggable(t.element,getJSPlumbDraggableProperties()),W.addCommentEllipsis(t),jQuery(t.elementJQ).click(function(e){if(R==v.STATE_WAITING||v.STATE_SPACE_RESTORED){var t=jQuery(this);t.hasClass("preventClickAfterDrop")?t.removeClass("preventClickAfterDrop"):AGN.Lib.WM.CampaignManagerSelection.handleClick(e,jQuery(this))}}).mouseover(V).mouseout(U).mousemove(Q).dblclick(function(e){!1!==t.data.editable?v.editNode(t,!0):"function"==typeof G&&G()})},getJSPlumbDraggableProperties=function(){var r,a,s=!1,l=!1;return{distance:jQuery.browser.msie&&jQuery.browser.version<9?5:10,start:function(e,t){var i=!1;r=AGN.Lib.WM.CampaignManagerSelection.getSelected(),j=a;for(var n=0;n<r.length;n++)if(r[n]==t.helper.attr("id")){i=!0;break}for(i||(AGN.Lib.WM.CampaignManagerSelection.clear(),AGN.Lib.WM.CampaignManagerSelection.select(t.helper)),r=AGN.Lib.WM.CampaignManagerSelection.getSelected(),a=[],n=0;n<r.length;n++){var o=document.getElementById(r[n]);a[n]={DOMElement:o,left:parseInt(o.style.left),top:parseInt(o.style.top)}}},drag:function(e,t){W.hidePopover(!0);for(var i=t.position.left-t.originalPosition.left,n=t.position.top-t.originalPosition.top,o=0;o<a.length;o++)t.helper.get(0)!=a[o].DOMElement&&(a[o].DOMElement.style.left=a[o].left+i+"px",a[o].DOMElement.style.top=a[o].top+n+"px");if(1<AGN.Lib.WM.CampaignManagerSelection.selected.length){function r(){try{F.repaint(AGN.Lib.WM.CampaignManagerSelection.selected)}finally{if(l){var e=l;l=!1,s=setTimeout(e,50)}else s=!1}}l=r,s||(l=!1,s=setTimeout(r,50))}},stop:function(e,t){j=null;for(var i=!1,n=0;n<a.length;n++)if(a[n].x=E.pxToCoordinate(parseInt(a[n].DOMElement.style.left)),a[n].y=E.pxToCoordinate(parseInt(a[n].DOMElement.style.top)),!S.isEmptyCell(a[n].x,a[n].y,a)){i=!0;break}if(!i)for(v.saveSnapshot(),n=0;n<a.length;n++){var o=S.getNodes()[jQuery(a[n].DOMElement).data("index")];S.updateNode(o.id,{x:a[n].x,y:a[n].y})}rearrangeStage(),t.helper.addClass("preventClickAfterDrop")}}};function H(){var s,l;return{distance:10,start:function(e,t){s=e.pageX,l=e.pageY,ee(),R=v.STATE_SELECTING_NODES},stop:function(e,t){var i=e.pageX,n=e.pageY;if(i<s){var o=s;s=i,i=o}n<l&&(o=l,l=n,n=o);var r=E.getScaledGridSize()/2,a=S.getNodesFromRegion(E.pxToCoordinate(s-r-getCanvasOffsetX()-C),E.pxToCoordinate(l-r-getCanvasOffsetY()-_),E.pxToCoordinate(i-r-getCanvasOffsetX()-C),E.pxToCoordinate(n-r-getCanvasOffsetY()-_),0);for(Z in AGN.Lib.WM.CampaignManagerSelection.validateMultiselection(e),a)AGN.Lib.WM.CampaignManagerSelection.select(jQuery(a[Z].element));R=v.STATE_WAITING,z=e.originalEvent.originalEvent}}}var z=void 0,V=function(){if(R==v.STATE_WAITING){var e=$(this),t=S.getNodeById(e.attr("id"));Y(e,t),W.showCommentPopover(t)}},U=function(){R==v.STATE_WAITING&&(q(),W.hideCommentPopover())},Y=function(e,t){F.unmakeEverySource(),jQuery(e).append(jQuery("#connectRapidButton")),jQuery("#connectRapidButton").offset({top:jQuery(e).offset().top,left:jQuery(e).offset().left+jQuery(e).width()-jQuery("#connectRapidButton").width()}),jQuery("#connectRapidButton").css("visibility","visible"),F.makeSource(jQuery("#connectRapidButton"),{parent:jQuery(e),dragOptions:{start:function(e,t){ee(),R=v.STATE_CREATING_CONNECTION},stop:function(e,t){R=v.STATE_WAITING,q()}}}),F.makeTarget(jQuery(S.getIconNodesSelector()),{dropOptions:{hoverClass:"hover"}})},q=function(){F.unmakeEverySource(),F.unmakeEveryTarget(),jQuery("#connectRapidButton").css("visibility","hidden")},Q=function(){R==v.STATE_WAITING&&jQuery(this).attr("id")!=jQuery("#connectRapidButton").parent().attr("id")&&(jQuery(this).append(jQuery("#connectRapidButton")),jQuery("#connectRapidButton").css("visibility","visible"))};this.needSaveSnapshot=!0,this.extendAllUsedEntities=function(e){$.extend(!0,x,e)},this.noSnapshot=function(e){var t=v.needSaveSnapshot;try{v.needSaveSnapshot=!1,e()}finally{v.needSaveSnapshot=t}},this.getBoundNodesDOM=function(){return{left:l.css("left"),top:l.css("top"),width:l.css("width"),height:l.css("height")}},this.getCurrentState=function(){return R},this.setCurrentState=function(e){R=e},this.isConnectionAllowed=function(e,t){if(!e||!t||e==t)return!1;var i=new le(v.CONNECTION_CONSTRAINTS),n=S.getNodesMap(),o=n[e],r=n[t],a={node:o,type:o.type,connections:{}},s={node:r,type:r.type,connections:{}};return Object.defineProperty(a.connections,"incoming",{get:se.caching(v.getNodeIncomingConnections,v,o)}),Object.defineProperty(a.connections,"outgoing",{get:se.caching(v.getNodeOutgoingConnections,v,o)}),Object.defineProperty(s.connections,"incoming",{get:se.caching(v.getNodeIncomingConnections,v,r)}),Object.defineProperty(s.connections,"outgoing",{get:se.caching(v.getNodeOutgoingConnections,v,r)}),a.type!=m.NODE_TYPE_STOP||this.nodeHasIncomingConnections(a.node)||(a.type=m.NODE_TYPE_START),s.type!=m.NODE_TYPE_START||this.nodeHasOutgoingConnections(s.node)||(s.type=m.NODE_TYPE_STOP),i.check(a,s,n)?(o.type==m.NODE_TYPE_STOP&&(o.type=m.NODE_TYPE_START),r.type==m.NODE_TYPE_START&&(r.type=m.NODE_TYPE_STOP),!0):("function"==typeof L&&L(),!1)},this.connectNodes=function(e,t,i){for(var n=!1,o=0;o<O.length;o++){var r=O[o];if(r.source==e&&r.target==t||r.source==t&&r.target==e){n=!0;break}}if(!n&&v.isConnectionAllowed(e,t)){var a={source:e,target:t};v.needSaveSnapshot&&this.saveSnapshot(),O.push(a),i&&processJSPlumbConnection(F.connect(a)),k.updateParameterValueAfterDecision()}},this.connectIntermediateNodes=function(e,t){if(B){var i=E.pxToCoordinate(E.getScaledNodeSize()),n=S.getNodeById(e),o=S.getNodeById(t),r=Math.abs(o.x-n.x),a=Math.abs(o.y-n.y),s={x1:0,y1:0,x2:0,y2:0};a<=r?(s.x1=Math.min(n.x,o.x)+i,s.y1=Math.min(n.y,o.y),s.x2=Math.max(n.x,o.x),s.y2=Math.max(n.y,o.y)+i):(s.x1=Math.min(n.x,o.x),s.y1=Math.min(n.y,o.y)+i,s.x2=Math.max(n.x,o.x)+i,s.y2=Math.max(n.y,o.y));var l=S.getNodesFromRegion(s.x1,s.y1,s.x2,s.y2,0);l[n.id]=n,l[o.id]=o;var c=[];for(var u in l)c.push(l[u]);c.sort(function(e,t){return a<=r&&n.x<=o.x?e.x-t.x:a<=r&&n.x>o.x?t.x-e.x:r<=a&&n.y<=o.y?e.y-t.y:r<=a&&n.y>o.y?t.y-e.y:void 0});var d=v.getConnectionNotAllowedCallback();2<c.length&&v.setConnectionNotAllowedCallback(function(){});var h=null;return jQuery.each(c,function(e,t){null!=h&&v.connectNodes(S.getNodeIdPrefix()+h.id,S.getNodeIdPrefix()+t.id,!0),h=t}),v.setConnectionNotAllowedCallback(d),!1}return v.isConnectionAllowed(e,t)},this.deleteSelectedNode=function(){var i=!0,e=AGN.Lib.WM.CampaignManagerSelection.getSelected();jQuery.each(e,function(e,t){null!=S.getNodeById(t)&&(i&&(v.saveSnapshot(),i=!1),v.deleteNode(t,!1,!0))}),AGN.Lib.WM.CampaignManagerSelection.clear(),rearrangeStage(),v.restoreCampaignActionsType(),k.updateParameterValueAfterDecision(),this.callWorkflowManagerStateChangedCallback()},this.deleteNode=function(e,t,i){if(1!=i||!v.checkActivation()){$("#invisible").append($("#connectRapidButton"));var n=S.getNodesMap(),o=[e];if(n[e])switch(n[e].type){case m.NODE_TYPE_DEADLINE:v.getIncomingConnectionsById(e).forEach(function(e){var t=n[e.source];t&&t.type==m.NODE_TYPE_IMPORT&&o.push(t.element.id)});break;case m.NODE_TYPE_IMPORT:v.getOutgoingConnectionsById(e).forEach(function(e){var t=n[e.target];t&&t.type==m.NODE_TYPE_DEADLINE&&o.push(t.element.id)})}O=O.filter(function(e){return o.indexOf(e.source)<0&&o.indexOf(e.target)<0}),o.forEach(function(e){S.deleteNode(e)}),!0===t&&rearrangeStage()}},this.deleteConnection=function(e){if(!v.checkActivation()){var t=e.source.attr("id"),i=e.target.attr("id"),n=S.getNodeById(t),o=S.getNodeById(i);n.type==m.NODE_TYPE_IMPORT&&o.type==m.NODE_TYPE_DEADLINE||(this.saveSnapshot(),O=O.filter(function(e){return!(e.source==t&&e.target==i||e.source==i&&e.target==t)}),rearrangeStage(),k.updateParameterValueAfterDecision())}},this.deleteConnectionByHtmlElement=function(e){for(var t=F.getConnections(),i=0;i<t.length;i++)if(t[i].canvas==e){v.deleteConnection(t[i]);break}},this.deleteConnectionByIdsOfElements=function(e,t){for(var i=[],n=0;n<O.length;n++)O[n].source==e.source&&O[n].target==e.target||O[n].source==e.target&&O[n].target==e.source||i.push(O[n]);O=i,1==t&&rearrangeStage()},this.getConnectionsFromSelected=function(e){var i=[];return jQuery.each(e,function(e,t){jQuery.each(v.getIncomingConnectionsById(t),function(e,t){-1==jQuery.inArray(t,i)&&i.push(t)}),jQuery.each(v.getOutgoingConnectionsById(t),function(e,t){-1==jQuery.inArray(t,i)&&i.push(t)})}),i},this.getNodesFromSelected=function(e){return jQuery.map(e,function(e){return S.getNodeById(e)})},this.deleteConnections=function(e){jQuery.each(e,function(e,t){v.deleteConnectionByIdsOfElements(t,!1)}),rearrangeStage()},this.deleteAllNodes=function(e){var t=S.getNodes();for(var i in t)this.deleteNode(t[i].elementJQ.attr("id"),e,!0)},this.getSessionId=function(){return this.pageContextSessionId},this.getEditorsHelper=function(){return T},this.setCampaignActionsType=function(e){"actionbased_mailing"==e.type&&(v.IS_ACTION_BASED=!0),"datebased_mailing"==e.type&&(v.IS_DATE_BASED=!0)},this.restoreCampaignActionsType=function(){var e=S.getNodes();for(var t in v.IS_ACTION_BASED=!1,v.IS_DATE_BASED=!1,e)v.setCampaignActionsType(e[t]);v.restoreStopsTitles()},this.isNormalCampaignActionsType=function(){return!v.IS_ACTION_BASED&&!v.IS_DATE_BASED},this.restoreStopsTitles=function(){var e=S.getNodes(),i=v.isNormalCampaignActionsType()?t("workflow.stop.automatic_end"):t("workflow.stop.open_end");for(var n in e){var o=e[n];if(o.data.endType==constants.endTypeAutomatic){o.elementJQ.find(".icon-extra-info").remove(),o.elementJQ.append("<div class='icon-extra-info'>"+i+"</div>");var r=90*E.getCurrentScale(),a=S.getIconExtraInfoPosition(o,E),s=a.top,l=a.left;o.elementJQ.find("div.icon-extra-info").css("font-size",r+"%"),o.elementJQ.find("div.icon-extra-info").css("top",s+"px"),o.elementJQ.find("div.icon-extra-info").css("left",l+"px")}}},this.getIncomingConnectionsById=function(e){for(var t=[],i=0;i<O.length;i++)O[i].target==e&&t.push(O[i]);return t},this.getNodeIncomingConnections=function(e){return v.getIncomingConnectionsById(e.elementJQ.attr("id"))},this.getOutgoingConnectionsById=function(e){for(var t=[],i=0;i<O.length;i++)O[i].source==e&&t.push(O[i]);return t},this.getNodeOutgoingConnections=function(e){return v.getOutgoingConnectionsById(e.elementJQ.attr("id"))},this.clearLabelConnection=function(e){for(var t=v.getNodeOutgoingConnections(e),i=0;i<t.length;i++)for(var n=F.getConnections(),o=0;o<n.length;o++)if(n[o].source[0].id==t[i].source&&n[o].target[0].id==t[i].target){var r=n[o].getOverlay("label");null!=r&&(jQuery("#"+r.canvas.id).remove(),n[o].removeOverlay("label"));break}},this.updateLabelConnection=function(e){if(e.data.decisionType==constants.decisionTypeDecision||e.data.decisionType==constants.decisionTypeAutoOptimization){v.clearLabelConnection(e);var i=v.getNodeOutgoingConnections(e);if(e.data.decisionType==constants.decisionTypeDecision&&2==i.length){var n=t("workflow.defaults.yes"),o=t("workflow.defaults.no");null!=e.statisticsList&&(n+=": <span class='node-stats'>"+e.statisticsList[0]+"</span>",o+=": <span class='node-stats'>"+e.statisticsList[1]+"</span>");var r=v.getConnectionObject(i[0]);if(null==r)return;var a=v.getConnectionObject(i[1]),s=S.getNodeById(i[0].target),l=S.getNodeById(i[1].target),c=s.x-l.x,u=s.y-l.y,d=Math.abs(c)<Math.abs(u)?"top":"right",h=Math.abs(c)<Math.abs(u)?"bottom":"left";e.y>=s.y&&e.y>=l.y?s.y<l.y?(v.setLabelToConnection(r,n,d),v.setLabelToConnection(a,o,h)):s.y>l.y?(v.setLabelToConnection(r,o,h),v.setLabelToConnection(a,n,d)):s.x<l.x?(v.setLabelToConnection(r,n,d),v.setLabelToConnection(a,o,h)):(v.setLabelToConnection(r,o,h),v.setLabelToConnection(a,n,d)):e.y<s.y&&e.y<l.y?s.x<l.x?(v.setLabelToConnection(r,o,h),v.setLabelToConnection(a,n,d)):(v.setLabelToConnection(r,n,d),v.setLabelToConnection(a,o,h)):s.y<l.y?(v.setLabelToConnection(r,n,d),v.setLabelToConnection(a,o,h)):(v.setLabelToConnection(r,o,h),v.setLabelToConnection(a,n,d));var p=jQuery("._jsPlumb_overlay");0!=p.size()&&p.css("font-size",E.getLabelFontSize())}}},this.getConnectionObject=function(e){for(var t=F.getConnections(),i=0;i<t.length;i++)if(t[i].source[0].id==e.source&&t[i].target[0].id==e.target)return t[i];return null},this.setLabelToConnection=function(e,t,i){if(null!=e){e.setLabel({id:"label",label:t,location:.65,cssClass:"connection-label"});var n=jQuery(e.getOverlay("label").canvas),o=6+n.width()/2,r=4+n.height()/2;"bottom"==i&&(r=-r),"right"==i&&(o=-o),jQuery(e.getOverlay("label").canvas).css({"margin-top":r+"px","margin-left":o+"px"})}},this.nodeHasIncomingConnections=function(e){var t=e.elementJQ.attr("id");return O.some(function(e){return e.target==t})},this.nodeHasOutgoingConnections=function(e){var t=e.elementJQ.attr("id");return O.some(function(e){return e.source==t})},this.editNode=function(e,t){null==e&&(e=S.getNodeById(AGN.Lib.WM.CampaignManagerSelection.getSelected()[0])),e.isExpandable&&(e.filled||K(e))?e.data.created||!e.data.copyContent||K(e)?X(e,e.data.created):v.expandNodeUseOriginal(e.data.copyContent,T.curEditingNode.id):(AGN.Lib.WM.CampaignManagerSelection.clear(),T.showEditDialog(e,v.checkActivation()))};var K=function(e){return e.isExpandable&&"ownWorkflow"!=e.type},X=function(e,t){new AGN.Lib.WM.IconsSetLoaderNew(v).loadIconsSetAJAXNew(e,t),e.data.created=!0};this.expandNodeUseOriginal=function(e,t){var i=S.getNodes()[t];X(i,!e)},this.isNewNode=function(e){return-1!=(e.id+"").indexOf("new")},this.updateNode=function(e){S.updateNodeView(e,E)},this.restoreWorkflow=function(e){var t=v.restoreNodes(e);return v.restoreConnections(e),v.relayout(),t},this.restoreNodes=function(e){var i=[];return e.forEach(function(e){var t=S.restoreNode(e);i.push(t),justifyNodeElement(t)}),i},this.restoreConnections=function(e){var n=S.getNodes();v.noSnapshot(function(){e.forEach(function(e){if(e.connections){var i=e.id;e.connections.forEach(function(e){var t=e.targetIconId;n[i]&&n[t]&&v.restoreConnection(i,t)})}})})},this.restoreConnection=function(e,t){var i=S.getNodeIdPrefix();this.connectNodes(i+e,i+t,!1)},this.relayout=function(){rearrangeStage(),R=v.STATE_WAITING},this.getCMNodes=function(){return S},this.isNodesFilled=function(){var e=S.getNodes();for(var t in e)if(!e[t].filled)return!1;return!0},this.justifyNodeElement=function(e){justifyNodeElement(e)},this.saveSnapshot=function(){P.length==g.MAX_UNDO_HISTORY&&P.shift(),P.push({icons:v.getIconsForSubmission(),workflowBound:v.getBoundNodesDOM()}),"function"==typeof I&&I(!0)},this.undo=function(){0<P.length&&v.noSnapshot(function(){var e=P.pop();v.deleteAllNodes(!1),C=parseInt(e.workflowBound.left),_=parseInt(e.workflowBound.top),p=parseInt(e.workflowBound.width),f=parseInt(e.workflowBound.height),updateBoundNodesDOM(),v.restoreWorkflow(e.icons),I(0<P.length)})},this.canUndo=function(){return 0<P.length},this.getUndoHistoryDataForSubmission=function(){return JSON.stringify(P)},this.setUndoHistoryDataForSubmission=function(e){I(0<P.length)},this.setHistoryStackChangedCallback=function(e){I=e},this.setConnectionNotAllowedCallback=function(e){L=e},this.getConnectionNotAllowedCallback=function(){return L},this.setEditingNotAllowedCallback=function(e){G=e},this.setEditorCanvasWidth=function(e){o=e},this.setEditorCanvasHeight=function(e){r=e},this.setViewPortWidth=function(e){b=e},this.setViewPortHeight=function(e){w=e},this.updateWorkflowForPdf=function(){y.css({overflow:"inherit",float:"none",border:"none",sceneHeight:"100%",width:"100%","min-height":y.css("height"),height:"100%"}),c.remove();var e=l.height(),t=l.width();if(800<e||1360<t){var i=1;i=t/e<1.7?800/e:1360/t,v.setScale(i),v.relayout()}v.resetScrolling()},this.resetScrolling=function(){l.css({position:"relative",top:"0",left:"0",margin:$("div.icon-extra-info").css("top")+" 15px"}),u.css({position:"initial",height:"100%","min-height":u.css("height")})},this.omitKeys=function(e,t){var i={};for(key in e)-1==t.indexOf(key)&&(i[key]=e[key]);return i},this.getIconsForSubmission=function(e){var i=[],n=S.getNodes(),o={},t=Object.keys(n);if(!0===e){var r=0;t.forEach(function(e){var t=parseInt(e,10);r<t&&(r=t)}),t.forEach(function(e){var t=parseInt(e,10);0<t?o[e]=t:(r++,o[e]=r)})}else t.forEach(function(e){o[e]=e});t.forEach(function(e){var t=v.omitKeys(m.prepareNodeForSubmission(n[e]),["isExpandable"]);t.id=o[e],i.push(t)});var a={};return O.forEach(function(e){var t=o[v.extractIdFromConnectionEnd(e.source)],i=o[v.extractIdFromConnectionEnd(e.target)];t in a?a[t].push(i):a[t]=[i]}),i.forEach(function(e){var t=a[e.id];e.connections=t?$.map(t,function(e){return{targetIconId:e}}):[]}),i},this.getIconsForSubmissionJson=function(){return JSON.stringify(this.getIconsForSubmission(!0))},this.getLeftPosition=function(){return l.offset().left-y.offset().left},this.getTopPosition=function(){return l.offset().top-y.offset().top},this.extractIdFromConnectionEnd=function(e){return e.substring(e.indexOf(S.getNodeIdPrefix())+S.getNodeIdPrefix().length,e.length)},this.updateParameterValueAfterDecision=function(){k.updateParameterValueAfterDecision()},this.getIncomingChainsForIcon=function(){var i=v.getCMNodes().getNodeIdPrefix(),n=v.getCMNodes(),o=[];return k.getIncomingChainsForIcon().forEach(function(e){var t=[];e.forEach(function(e){t.push(n.getNodeById(i+e.id))}),o.push(t)}),o},this.setWorkflowManagerStateChangedCallback=function(e){M=e},this.callWorkflowManagerStateChangedCallback=function(){"function"==typeof M&&M()},this.getCampaignManagerNodes=function(){return S},this.getNodesFactory=function(){return m},this.getMailingNames=function(){for(var e="",t=v.getCMNodes().getNodesByTypeList([m.NODE_TYPE_MAILING,m.NODE_TYPE_ACTION_BASED_MAILING,m.NODE_TYPE_DATE_BASED_MAILING,m.NODE_TYPE_FOLLOWUP_MAILING]),i=0;i<t.length;i++)e=e+t[i].iconTitle+"<br/>";return e},this.showError=function(e){AGN.Lib.Messages(t("workflow.defaults.error"),e,"alert")},this.checkWorkflowBeforeSave=function(){var e=v.checkActivation(),t=v.checkUsingActivatedWorkflow(),i=v.checkPartOfActivatedWorkflow();return e||t||i},this.checkActivation=function(){var e=$("input[name='__STRUTS_CHECKBOX_workflow.statusString']").val();return!(!this.isActivated||"STATUS_ACTIVE"!=e&&"STATUS_TESTING"!=e)&&(v.showError(t("error.workflow.saveActivatedWorkflow")),!0)},this.checkUsingActivatedWorkflow=function(){var e=$("input[name='usingActivatedWorkflow']").val();if(""==e)return!1;var i=$("input[name='usingActivatedWorkflowName']").val();return v.showError(t("error.workflow."+e).replace("%s",i)),!0},this.checkPartOfActivatedWorkflow=function(){var e=$("input[name='partOfActivatedWorkflow']").val();if(""==e)return!1;var i=$("input[name='partOfActivatedWorkflowName']").val();return v.showError(t("error.workflow."+e).replace("%s",i)),!0},this.checkMailingTypesConvertingRequired=function(){for(var e=this.getIconsForSubmission(!1),t="UNKNOWN",i={},n=0;n<e.length;n++){var o=e[n];if(o.type==m.NODE_TYPE_START&&o.filled){var r="UNKNOWN";switch(o.startType){case constants.startTypeDate:r="DATE";break;case constants.startTypeEvent:switch(o.event){case constants.startEventDate:r="RULE";break;case constants.startEventReaction:r="REACTION"}}if(t!=r){if("UNKNOWN"!=t)return!1;t=r}}switch(o.type){case m.NODE_TYPE_MAILING:case m.NODE_TYPE_FOLLOWUP_MAILING:i.DATE=!0;break;case m.NODE_TYPE_ACTION_BASED_MAILING:i.REACTION=!0;break;case m.NODE_TYPE_DATE_BASED_MAILING:i.RULE=!0}}if("UNKNOWN"!=t)if(1==(i=Object.keys(i)).length){if(t!=i[0])return!0}else if(1<i.length)return!0;return!1},this.setScale=function(e){E.setExternalScale(e)},this.getCommentControls=function(){return W},this.getDraggedElements=function(){return j},c.css({right:20,bottom:20}).append('<div id="navigatorArrowTop"></div>').append('<div id="navigatorArrowRight"></div>').append('<div id="navigatorArrowBottom"></div>').append('<div id="navigatorArrowLeft"></div>'),jQuery("#navigatorArrowTop").click(function(){u.animate({top:g.navigatorStep},"fast",function(){rearrangeStage()})}),jQuery("#navigatorArrowRight").click(function(){var e=y.scrollLeft();u.css({width:o+d+g.navigatorStep}),y.scrollLeft(e),u.animate({left:-g.navigatorStep},"fast",function(){rearrangeStage()})}),jQuery("#navigatorArrowBottom").click(function(){var e=y.scrollTop();u.css({height:r+h+g.navigatorStep}),y.scrollTop(e),u.animate({top:-g.navigatorStep},"fast",function(){rearrangeStage()})}),jQuery("#navigatorArrowLeft").click(function(){u.animate({left:g.navigatorStep},"fast",function(){rearrangeStage()})});for(var J="",Z=0;Z<A.length;Z++)J&&(J+=", "),J+="#"+A[Z];var ee=function(){jQuery(J).filter(":focus").blur()};jQuery(J).focus(function(){R=v.STATE_SPACE_RESTORED}).blur(function(){R=v.STATE_WAITING}),jQuery("#slider").slider({value:N,step:g.zoomStep,change:function(){E.setCurrentScaleSliderPosition(jQuery(this).slider("value")),rearrangeStage()}}),document.onselectstart=function(){return!1},rearrangeStage(),$(".draggableButton").css({zIndex:v.Z_INDEX_DRAGGABLE_BUTTON}).draggable({revert:!0,revertDuration:0,start:function(e,t){ee(),R=v.STATE_CREATING_NODE,t.helper.css({zIndex:v.Z_INDEX_DRAGGABLE_BUTTON+1}),t.helper.parent().css({zIndex:v.Z_INDEX_ICON_PANEL+1})},stop:function(e,t){if(!v.checkActivation()){t.helper.css({zIndex:v.Z_INDEX_DRAGGABLE_BUTTON}),t.helper.parent().css({zIndex:v.Z_INDEX_ICON_PANEL});var i=y.offset(),n=t.helper.attr("type"),o=1;switch(n){case m.NODE_TYPE_OWN_WORKFLOW:case m.NODE_TYPE_SC_BIRTHDAY:case m.NODE_TYPE_SC_DOI:case m.NODE_TYPE_SC_ABTEST:o=4}var r=t.helper.width()/2,a=t.helper.height()/2;if(t.offset.left+r>=i.left&&t.offset.top+a>=i.top&&t.offset.left+r<=i.left+b&&t.offset.top+a<=i.top+w){var s,l;if(v.saveSnapshot(),S.count()){var c=t.offset.left-r/o-getCanvasOffsetX(),u=t.offset.top-a/o-getCanvasOffsetY(),d=Math.round((c-C)/E.getScaledGridSize()),h=Math.round((u-_)/E.getScaledGridSize());n==m.NODE_TYPE_IMPORT?l=S.addNodeSequence([n,m.NODE_TYPE_DEADLINE],d,h):s=S.addNode(n,d,h)}else n==m.NODE_TYPE_IMPORT?l=S.addNodeSequence([n,m.NODE_TYPE_DEADLINE],0,0):s=S.addNode(n,0,0),C=t.offset.left-r/o-getCanvasOffsetX(),_=t.offset.top-a/o-getCanvasOffsetY();if(l)l.forEach(function(e){justifyNodeElement(e)}),l.reduce(function(e,t){return v.connectNodes(e.element.id,t.element.id,!0),t});else if(s)switch(n){case m.NODE_TYPE_OWN_WORKFLOW:case m.NODE_TYPE_SC_BIRTHDAY:case m.NODE_TYPE_SC_DOI:case m.NODE_TYPE_SC_ABTEST:S.normalizeNodes(),v.editNode(s,!0);break;case m.NODE_TYPE_ACTION_BASED_MAILING:case m.NODE_TYPE_DATE_BASED_MAILING:var p=v.getCMNodes().getNodesByType(m.NODE_TYPE_DEADLINE);if(0<p.length)for(var f=0;f<p.length;f++){var g=p[f];g.filled&&(g.data.deadlineType=constants.deadlineTypeDelay,v.updateNode(g))}justifyNodeElement(s);break;default:justifyNodeElement(s)}(l||s)&&rearrangeStage(),v.callWorkflowManagerStateChangedCallback()}R=v.STATE_WAITING}}}).dblclick(function(e){var t,n=$(this).attr("type");function i(e,t){if(n==m.NODE_TYPE_IMPORT)return S.addNodeSequence([n,m.NODE_TYPE_DEADLINE],e,t);var i=S.addNode(n,e,t);if(i){switch(n){case m.NODE_TYPE_OWN_WORKFLOW:case m.NODE_TYPE_SC_BIRTHDAY:case m.NODE_TYPE_SC_DOI:case m.NODE_TYPE_SC_ABTEST:v.editNode(i,!0)}return[i]}return!1}if(v.saveSnapshot(),S.count())for(var o=E.pxToCoordinate(E.getScaledNodeSize()),r=0;r<=f;r+=o){for(var a=0;a<=p&&!(t=i(a,r));a+=o);if(t)break}else t=i(0,0),C=p/2,_=f/2;t&&(t.forEach(function(e){justifyNodeElement(e)}),t.reduce(function(e,t){return v.connectNodes(e.element.id,t.element.id,!0),t}),rearrangeStage(),$(t[0].elementJQ).click()),v.callWorkflowManagerStateChangedCallback()}),$(document).keydown(function(e){e.keyCode==g.dragStageKeyCode?e.target&&!$(e.target).is("input, textarea")&&R!=v.STATE_SPACE_RESTORED&&(R==v.STATE_WAITING&&($("#editorCanvas").selectable("destroy"),$(S.getIconNodesSelector()).draggable("disable"),R=v.STATE_DRAGGING_STAGE_WAIT_MOUSE),e.preventDefault(),e.stopPropagation()):e.keyCode==g.multiConnectionKeyCode&&(B=!0)}),$(document).keyup(function(e){e.keyCode==g.dragStageKeyCode?e.target&&!$(e.target).is("input, textarea")&&(R!=v.STATE_DRAGGING_STAGE_WAIT_MOUSE&&R!=v.STATE_DRAGGING_STAGE||($("#editorCanvas").selectable(H()),$(S.getIconNodesSelector()).draggable("enable"),e.stopPropagation(),R=v.STATE_WAITING)):e.keyCode==g.multiConnectionKeyCode?B=!1:g.deleteKeyCode==e.keyCode&&v.deleteSelectedNode()});var te=!1,ie=!1,ne=!1,oe=!1,re=!1,ae=!1;y.mousedown(function(e){R==v.STATE_DRAGGING_STAGE_WAIT_MOUSE&&(te=e.pageX,ie=e.pageY,R=v.STATE_DRAGGING_STAGE,ne=parseInt(u.css("width")),oe=parseInt(u.css("height")),re=parseInt(u.css("left")),ae=parseInt(u.css("top")),e.preventDefault(),e.stopPropagation())}),jQuery(document).mousemove(function(e){R==v.STATE_DRAGGING_STAGE&&(u.css({left:re+e.pageX-te,top:ae+e.pageY-ie,width:ne-e.pageX+te,height:oe-e.pageY+ie}),e.preventDefault(),e.stopPropagation())}),jQuery(document).mouseup(function(e){R==v.STATE_DRAGGING_STAGE&&(R=v.STATE_DRAGGING_STAGE_WAIT_MOUSE,updateNodeAdditionalViewElements(),updateEditorCanvas(),resetJsPlumber(),e.preventDefault(),e.stopPropagation())}),jQuery(document).click(function(e){R!=v.STATE_WAITING&&R!=v.STATE_SPACE_RESTORED||(!jQuery.browser.msie&&1==e.which||jQuery.browser.msie)&&(null!=z&&function(e,t){return e===t||e.screenX==t.screenX&&e.screenY==t.screenY}(z,e.originalEvent)||AGN.Lib.WM.CampaignManagerSelection.clear(),z=void 0)}),AGN.Lib.WM.CampaignManagerToolbar.init({deleteSelected:function(){v.deleteSelectedNode()},connectSelected:function(){return connectSelectedNodes()},undoSelected:function(){v.undo()},zoomMinSelected:function(){var e=jQuery("#slider"),t=e.slider("option","min");if(t<e.slider("option","value")){var i=e.slider("option","value")-e.slider("option","step");e.slider("option","value",i<t?t:i)}},zoomMiddleSelected:function(){var e=jQuery("#slider");e.slider("option","value",Math.round(e.slider("option","max")/2))},zoomMaxSelected:function(){var e=jQuery("#slider"),t=e.slider("option","max");if(e.slider("option","value")<t){var i=e.slider("option","value")+e.slider("option","step");e.slider("option","value",t<i?t:i)}},doAutoLayout:function(){D.layoutWorkflow(S.getNodes(),O),_=C=15,rearrangeStage()}}),AGN.Lib.WM.CampaignManagerSelection.init({nodeSelector:S.getIconNodesSelector(),onSelectionChanged:function(){var e=this.getSelected();e&&e.length?(AGN.Lib.WM.CampaignManagerToolbar.setDeletionAvailable(!0),AGN.Lib.WM.CampaignManagerToolbar.arrowMode&&null!=this.prevSelected&&v.connectNodes(this.prevSelected,this.lastSelected,!0)):AGN.Lib.WM.CampaignManagerToolbar.setDeletionAvailable(!1)}}),s||AGN.Lib.WM.CampaignManagerContextMenu.init({nodeSelector:S.getIconNodesSelector(),campaignManager:v,campaignManagerSelection:AGN.Lib.WM.CampaignManagerSelection}),u.selectable(H())}}(),function(){var o=AGN.Lib.WM.DateTimeUtils,e={NODE_TYPE_START:"start",NODE_TYPE_STOP:"stop",NODE_TYPE_DECISION:"decision",NODE_TYPE_DEADLINE:"deadline",NODE_TYPE_PARAMETER:"parameter",NODE_TYPE_REPORT:"report",NODE_TYPE_RECIPIENT:"recipient",NODE_TYPE_ARCHIVE:"archive",NODE_TYPE_FORM:"form",NODE_TYPE_MAILING:"mailing",NODE_TYPE_OWN_WORKFLOW:"ownWorkflow",NODE_TYPE_SC_BIRTHDAY:"scBirthday",NODE_TYPE_SC_DOI:"scDOI",NODE_TYPE_SC_ABTEST:"scABTest",NODE_TYPE_ACTION_BASED_MAILING:"actionbased_mailing",NODE_TYPE_DATE_BASED_MAILING:"datebased_mailing",NODE_TYPE_FOLLOWUP_MAILING:"followup_mailing",NODE_TYPE_IMPORT:"import",NODE_TYPE_EXPORT:"export",NODE_TYPE_START_ID:0,NODE_TYPE_STOP_ID:1,NODE_TYPE_DECISION_ID:2,NODE_TYPE_DEADLINE_ID:3,NODE_TYPE_PARAMETER_ID:4,NODE_TYPE_REPORT_ID:5,NODE_TYPE_RECIPIENT_ID:6,NODE_TYPE_ARCHIVE_ID:7,NODE_TYPE_FORM_ID:8,NODE_TYPE_MAILING_ID:9,NODE_TYPE_OWN_WORKFLOW_ID:10,NODE_TYPE_SC_BIRTHDAY_ID:11,NODE_TYPE_SC_DOI_ID:12,NODE_TYPE_SC_ABTEST_ID:13,NODE_TYPE_ACTION_BASED_MAILING_ID:14,NODE_TYPE_DATE_BASED_MAILING_ID:15,NODE_TYPE_FOLLOWUP_MAILING_ID:16,NODE_TYPE_IMPORT_ID:17,NODE_TYPE_EXPORT_ID:18,reactionRegistry:[],createNode:function(e,t,i,n,o,r){var a={id:o,x:t,y:i,type:e,data:{},filled:!1,element:n,elementJQ:jQuery(n),usedAnchors:[],isExpandable:!1,iconTitle:"",editable:!0};switch(r.setCampaignActionsType(a),a.type){case"scABTest":case"scBirthday":case"scDOI":a.filled=!0,a.isExpandable=!0,a.data={copyContent:!0,created:!1};break;case"ownWorkflow":a.isExpandable=!0,a.data={ownWorkflowId:0,copyContent:!0,created:!1};break;case"start":a.data={startType:null,date:null,hour:0,minute:0,sendReminder:!1,remindAdminId:0,remindAtOnce:!1,scheduleReminder:!1,remindSpecificDate:!1,remindDate:new Date,remindHour:0,remindMinute:0,event:null,reaction:null,mailingId:0,profileField:"",useRules:!1,rules:[],executeOnce:!0,comment:"",recipients:"",adminTimezone:""};break;case"stop":a.data={endType:null,date:null,hour:0,minute:0,sendReminder:!1,remindAdminId:0,remindAtOnce:!1,scheduleReminder:!1,remindSpecificDate:!1,remindDate:new Date,remindHour:0,remindMinute:0,event:null,reaction:null,mailingId:0,profileField:"",useRules:!1,rules:[],executeOnce:!0,comment:"",recipients:"",adminTimezone:""};break;case"decision":a.data={decisionType:null,decisionCriteria:null,reaction:null,mailingId:0,linkId:0,profileField:"",aoDecisionCriteria:null,threshold:"",decisionDate:new Date,rules:[],includeVetoed:!0};break;case"deadline":a.data={deadlineType:null,date:new Date,timeUnit:null,delayValue:0,hour:0,minute:0,useTime:!1};break;case"parameter":a.data={value:0};break;case"report":a.data={reports:[]};break;case"recipient":a.isDependent=!1,a.data={mailinglistId:0,targets:[],targetsOption:null};break;case"archive":a.data={campaignId:0,archived:!1};break;case"form":a.data={userFormId:0,formType:"form"};break;case"optin_form":a.data={userFormId:0,formType:"optin_form"},a.type="form";break;case"fullview":a.data={userFormId:0,formType:"fullview"},a.type="form";break;case"optout_form":a.data={userFormId:0,formType:"optout_form"},a.type="form";break;case"mailing":a.data={mailingId:0,skipEmptyBlocks:!0,doubleCheck:!0};break;case"actionbased_mailing":case"datebased_mailing":a.data={mailingId:0};break;case"followup_mailing":a.data={baseMailingId:0,mailingId:0,decisionCriterion:"OPENED"};break;case"import":case"export":a.data={importexportId:0,errorTolerant:!1}}return a},createNodeFromData:function(e,t,i){var n={id:e.id,x:e.x,y:e.y,type:e.type,data:{},filled:e.filled,element:t,elementJQ:jQuery(t),isExpandable:!1,usedAnchors:[],iconTitle:e.iconTitle};i.setCampaignActionsType(n);for(var o=Object.keys(e),r=0;r<o.length;r++){var a=o[r];if("x"!=a&&"y"!=a&&"type"!=a&&"filled"!=a)if("date"==a||"remindDate"==a||"decisionDate"==a){if(e[a])if(-1!=e[a].toString().indexOf("-")){var s=e[a].toString().split("-");n.data[a]=new Date(s[0],s[1]-1,s[2])}else n.data[a]=new Date(e[a])}else n.data[a]=e[a]}return"ownWorkflow"!=n.type&&"scBirthday"!=n.type&&"scDOI"!=n.type&&"scABTest"!=n.type||(n.isExpandable=!0),n},prepareNodeForSubmission:function(e){var t={x:e.x,y:e.y,type:e.type,filled:e.filled,iconTitle:e.iconTitle};if(e.data)for(var i=Object.keys(e.data),n=0;n<i.length;n++)t[i[n]]=e.data[i[n]];return e.value&&(t.value=e.value),e.mailinglistId&&(t.mailinglistId=e.mailinglistId),t.date=o.getDateTimeValue(t.date,t.hour,t.minute),t.remindDate=o.getDateTimeValue(t.remindDate,t.remindHour,t.remindMinute),t.decisionDate=o.getDateTimeValue(t.decisionDate),t.id=e.id,t},getFixedType:function(e){return"stop"==e?"start":e},getImage:function(e){return"icon_"+this.getFixedType(e)+"_l.png"},getEmptyImage:function(e){return"icon_"+this.getFixedType(e)+"_g.png"},getSmallImage:function(e){return"icon_"+this.getFixedType(e)+"_s.png"},getImageForNode:function(e){return"form"==e.type?this.getImage(e.data.formType):this.getImage(e.type)},getEmptyImageForNode:function(e){return"form"==e.type?this.getEmptyImage(e.data.formType):this.getEmptyImage(e.type)},getSmallImageForNode:function(e){return"form"==e.type?this.getSmallImage(e.data.formType):this.getSmallImage(e.type)},getReactionImage:function(e){return this.reactionRegistry[e].image},getReactionName:function(e){return this.reactionRegistry[e].name}};AGN.Lib.WM.NodeFactory=e}(),function(){var U=AGN.Lib.WM.DateTimeUtils;AGN.Lib.WM.CampaignManagerNodes=function(e){this.LEFT="left",this.TOP="top",this.RIGHT="right",this.BOTTOM="bottom";var B=this,l={},r=0,j=e.campaignManager,n=e.campaignManagerScale,W=e.nodeFactory,c=n.pxToCoordinate(n.getScaledNodeSize())-1,H=e.allUsedEntity;this.openNodeId=null,this.openNodeValue=null,this.nodesContainerDOMId=e.nodesContainerDOMId,this.localeDateNTimePattern=e.localeDateNTimePattern,this.MAX_NUMBER_OF_TARGETS_FOR_DISPLAY=2,this.MAX_NUMBER_OF_REPORTS_FOR_DISPLAY=2,this.REACTION_OPENED="OPENED",this.REACTION_NOT_OPENED="NOT_OPENED",this.REACTION_CLICKED="CLICKED",this.REACTION_NOT_CLICKED="NOT_CLICKED",this.REACTION_BOUGHT="BOUGHT",this.REACTION_NOT_BOUGHT="NOT_BOUGHT",this.TITLE_ELLIPSIS_LENGTH=14;this.getIconExtraInfoPosition=function(e,t){var i,n=0;if((e.type==W.NODE_TYPE_START||e.type==W.NODE_TYPE_STOP)&&e.data.startType==constants.startTypeEvent&&e.data.event==constants.startEventReaction){if(-1==e.usedAnchors.indexOf(B.BOTTOM)&&-1==e.usedAnchors.indexOf(B.TOP))return{top:i=t.getScaledNodeSize(),left:n=0};if(-1==e.usedAnchors.indexOf(B.LEFT)&&-1==e.usedAnchors.indexOf(B.RIGHT))return{top:i=.3*t.getScaledNodeSize(),left:n=-1*t.getScaledNodeSize()}}return n=-1==e.usedAnchors.indexOf(B.BOTTOM)?(i=t.getScaledNodeSize(),0):-1==e.usedAnchors.indexOf(B.LEFT)?(i=.3*t.getScaledNodeSize(),-1*t.getScaledNodeSize()):-1==e.usedAnchors.indexOf(B.RIGHT)?(i=.3*t.getScaledNodeSize(),t.getScaledNodeSize()):(i=-1==e.usedAnchors.indexOf(B.TOP)?-.4*t.getScaledNodeSize():t.getScaledNodeSize(),0),{top:i,left:n}},this.isEmptyCell=function(e,t,i){return this.isEmptyArea(e,t,1,1,i)},this.isEmptyArea=function(e,t,i,n,o){var r=B.getNodesFromRegion(e,t,e+Math.abs(i)*c,t+Math.abs(n)*c,0);if(0==Object.keys(r).length&&0==o.length)return!0;var a=0;return _.each(r,function(e){for(var t=0;t<o.length;t++)if(o[t].DOMElement.id==e.element.id){a++;break}}),Object.keys(r).length==a},this.count=function(){return Object.keys(l).length},this.createNodeElement=function(e,t){var i=this.getNodeIdPrefix()+t,n=W.getEmptyImage(e),o=jQuery('<div class="iconNode" id="'+i+'"><img class="node-image" src="'+campaignManagerSettings.imagePath+n+'"></div>').appendTo("#"+this.nodesContainerDOMId).get(0);return jQuery(o).data("index",t).disableSelection().find("img").disableSelection(),o},this.addNode=function(e,t,i){if(this.isEmptyCell(t,i,[])){var n=this.generateId(),o=this.createNodeElement(e,n);return l[n]=W.createNode(e,t,i,o,n,j),l[n]}return!1},this.addNodeSequence=function(e,r,a){function s(e){return 1<e?2*e-1:e}return!!(0<e.length&&this.isEmptyArea(r,a,s(e.length),1,[]))&&e.map(function(e,t){var i=B.generateId(),n=B.createNodeElement(e,i),o=(s(t+1)-1)*c;return l[i]=W.createNode(e,r+o,a,n,i,j)})},this.generateId=function(){return++r},this.restoreNode=function(e){if(-1==(e.id+"").indexOf("new"))r<e.id&&(r=e.id+1);else{var t=e.id.split("-"),i=parseInt(t[t.length-1]);r<i&&(r=i)}var n=e.id,o=this.createNodeElement(e.type,n);return l[n]=W.createNodeFromData(e,o,j),l[n]},this.normalizeNodes=function(){B.addIndexOffset(-1,-1);var e=!1,t=!1;for(var i in l)(!1===e||e>l[i].x)&&(e=l[i].x),(!1===t||t>l[i].y)&&(t=l[i].y);return(e||t)&&B.addIndexOffset(-e,-t),B.addIndexOffset(1,1),{collapsedX:-e,collapsedY:-t}},this.getNodes=function(){return l},this.updateNode=function(e,t){jQuery.extend(l[e],t)},this.getIconNodesSelector=function(){return".iconNode"},this.getNodeIdPrefix=function(){return"campaignManagerNode-"},this.getNewNodeIdPrefix=function(){return"new-"},this.deleteNode=function(e){for(i in l)if(l[i].element.id==e){jQuery(l[i].element).remove(),delete l[i];break}},this.getNodesMap=function(){var t={};return _.each(l,function(e){t[e.element.id]=e}),t},this.getNodeById=function(e){for(var t in l)if(l[t].element.id===e)return l[t];return null},this.addIndexOffset=function(e,t){for(i in l)this.updateNode(i,{x:l[i].x+e,y:l[i].y+t})},this.getNodesFromRegion=function(e,t,n,o,r){var a={};for(i in l)(l[i].x>=e&&l[i].x<=n&&l[i].y>=t&&l[i].y<=o||l[i].x+c+r>=e&&l[i].x+c+r<=n&&l[i].y>=t&&l[i].y<=o||l[i].x>=e&&l[i].x<=n&&l[i].y+c+r>=t&&l[i].y+c+r<=o||l[i].x+c+r>=e&&l[i].x+c+r<=n&&l[i].y+c+r>=t&&l[i].y+c+r<=o)&&(a[i]=l[i]);return a},this.updateNodeView=function(e,t){e.element.style.top=t.coordinateToPx(e.y)+"px",e.element.style.left=t.coordinateToPx(e.x)+"px",e.element.style.width=t.getScaledNodeSize()+"px",e.element.style.height=t.getScaledNodeSize()+"px",e.filled?this.setActiveImage(e):this.setNotActiveImage(e),B.updateNodeAdditionalViewElements(e,t)},this.setActiveImage=function(e){e.elementJQ.find(".node-image").attr("src",campaignManagerSettings.imagePath+W.getImageForNode(e))},this.setNotActiveImage=function(e){e.elementJQ.find(".node-image").attr("src",campaignManagerSettings.imagePath+W.getEmptyImageForNode(e))},this.updateNodeAdditionalViewElements=function(e,o){if(e.filled||e.type==W.NODE_TYPE_MAILING||e.type==W.NODE_TYPE_ACTION_BASED_MAILING||e.type==W.NODE_TYPE_DATE_BASED_MAILING||e.type==W.NODE_TYPE_FOLLOWUP_MAILING||e.type==W.NODE_TYPE_IMPORT&&(e.type!=W.NODE_TYPE_IMPORT||0!=e.data.importexportId)||e.type==W.NODE_TYPE_EXPORT&&(e.type!=W.NODE_TYPE_EXPORT||0!=e.data.importexportId)){var i=90*o.getCurrentScale(),n=(d=B.getIconExtraInfoPosition(e,o)).top,r=d.left;if(e.elementJQ.find(".icon-extra-info").each(function(){jQuery(this).remove()}),_.each(e.elementJQ.find(".icon-footnote-number"),function(e){var t=$(e),i=110*o.getCurrentScale(),n=5.2*o.getCurrentScale();t.css("font-size",i+"%"),t.css("padding","0 "+n+"px")}),e.type==W.NODE_TYPE_START||e.type==W.NODE_TYPE_STOP){var a=U.getDateTimeStr(e.data.date,e.data.hour,e.data.minute,this.localeDateNTimePattern);if(e.type==W.NODE_TYPE_START&&e.data.startType==constants.startTypeDate){var s=t("workflow.start.start_date");e.elementJQ.append("<div class='icon-extra-info'>"+s+":<br>"+a+"</div>")}else if(e.type==W.NODE_TYPE_STOP&&e.data.endType==constants.endTypeDate)s=t("workflow.stop.end_date"),e.elementJQ.append("<div class='icon-extra-info'>"+s+":<br>"+a+"</div>");else if(e.data.startType==constants.startTypeEvent&&e.data.event==constants.startEventReaction){var l=e.type==W.NODE_TYPE_START?t("workflow.start.start_event"):t("workflow.stop.end_event"),c=W.getReactionName(e.data.reaction);e.elementJQ.append("<div class='icon-extra-info'>"+l+":<br>"+c+"<br>("+a+")</div>");var u=W.getReactionImage(e.data.reaction);e.elementJQ.append("<img class='icon-extra-info' title='"+c+"'/>"),e.elementJQ.find("img.icon-extra-info").attr("src",campaignManagerSettings.imagePath+u);e.elementJQ.find("img.icon-extra-info").css("height","60%"),e.elementJQ.find("img.icon-extra-info").css("width","60%");var d=function(e,t,i){return{top:0,left:t.getScaledNodeSize()-t.getScaledNodeSize()*i/100}}(e.usedAnchors,o,60);e.elementJQ.find("img.icon-extra-info").css("top",d.top+"px"),e.elementJQ.find("img.icon-extra-info").css("left",d.left+"px")}else if(e.data.startType==constants.startTypeEvent&&e.data.event==constants.startEventDate){var h=e.data.dateProfileField+" "+constants.operators[e.data.dateFieldOperator]+" "+(null==e.data.dateFieldValue?"":e.data.dateFieldValue),p=t("workflow.start.start_event");e.elementJQ.append("<div class='icon-extra-info'>"+p+":<br>"+h+"<br>("+a+")</div>")}else if(e.data.endType==constants.endTypeAutomatic){var f=j.isNormalCampaignActionsType()?t("workflow.stop.automatic_end"):t("workflow.stop.open_end");e.elementJQ.append("<div class='icon-extra-info'>"+f+"</div>")}}else if(e.type===W.NODE_TYPE_DEADLINE){if(e.data.deadlineType===constants.deadlineTypeFixedDeadline){var g=U.getDateTimeStr(e.data.date,e.data.hour,e.data.minute,this.localeDateNTimePattern);e.elementJQ.append("<div class='icon-extra-info'>"+t("workflow.deadline.title")+":<br>"+g+"</div>")}else if(e.data.deadlineType===constants.deadlineTypeDelay){var m=t("workflow.defaults.delay")+": <br>"+e.data.delayValue+" ";if(1<e.data.delayValue)switch(e.data.timeUnit){case constants.deadlineTimeUnitMinute:m+=t("workflow.deadline.minutes");break;case constants.deadlineTimeUnitHour:m+=t("workflow.defaults.hours");break;case constants.deadlineTimeUnitDay:m+=t("workflow.defaults.days");break;case constants.deadlineTimeUnitWeek:m+=t("workflow.defaults.weeks");break;case constants.deadlineTimeUnitMonth:m+=t("workflow.defaults.months")}else switch(e.data.timeUnit){case constants.deadlineTimeUnitMinute:m+=t("workflow.deadline.minute");break;case constants.deadlineTimeUnitHour:m+=t("workflow.defaults.hour");break;case constants.deadlineTimeUnitDay:m+=t("workflow.defaults.day");break;case constants.deadlineTimeUnitWeek:m+=t("workflow.defaults.week");break;case constants.deadlineTimeUnitMonth:m+=t("workflow.defaults.month")}e.elementJQ.append("<div class='icon-extra-info'>"+m+"</div>")}}else if(e.type==W.NODE_TYPE_PARAMETER)e.elementJQ.append("<div class='icon-extra-info icon-extra-info-center'>"+e.data.value+"</div>"),n=.36*o.getScaledNodeSize(),e.elementJQ.find("div.icon-extra-info-center").css("top",n+"px"),e.elementJQ.find("div.icon-extra-info-center").css("left","0px"),null!=e.statisticsList&&(e.elementJQ.append("<div class='icon-extra-info stat-value'><span class='node-stats'>"+e.statisticsList[0]+"</span></div>"),e.elementJQ.find("div.stat-value").css("top",d.top+"px"),e.elementJQ.find("div.stat-value").css("left",d.left+"px"));else if(e.type==W.NODE_TYPE_DECISION){var v="";if(e.data.decisionType==constants.decisionTypeAutoOptimization){switch(v=t("workflow.mailing.autooptimization")+", ",e.data.aoDecisionCriteria){case constants.decisionAOCriteriaClickRate:v+=t("workflow.defaults.ckickrate");break;case constants.decisionAOCriteriaOpenrate:v+=t("workflow.opening_rate");break;default:v+=t("workflow.statistic.revenue")}if(e.data.threshold&&""!=e.data.threshold&&(v+=": "+e.data.threshold),e.data.decisionDate){var y=U.getDateTimeStr(e.data.decisionDate,null,null,this.localeDateNTimePattern);v+=", "+t("workflow.defaults.date")+": "+y}}else if(v=t("workflow.decision")+", ",e.data.decisionCriteria==constants.decisionReaction){c=W.getReactionName(e.data.reaction);v+=t("workflow.reaction.title")+": "+c+", "+t("workflow.defaults.mailing")+": "+H.allMailings[e.data.mailingId]}else{for(var b={0:"",1:"("},w={0:"",1:")"},C="",A=0,E=e.data.rules.length;A<E;A++)0!=C.length&&(C+=" "+constants.chainOperatorOptions[e.data.rules[A].chainOperator]+" "),C+=b[e.data.rules[A].parenthesisOpened],C+=e.data.profileField+" ",C+=constants.operatorsMap[e.data.rules[A].primaryOperator]+" ","GENDER"==e.data.profileField?C+=constants.genderOptions[e.data.rules[A].primaryValue]:C+=e.data.rules[A].primaryValue,C+=w[e.data.rules[A].parenthesisClosed];v+=t("workflow.start.rule")+": "+C}e.elementJQ.append("<div class='icon-extra-info'>"+v+"</div>")}else if(e.type==W.NODE_TYPE_RECIPIENT){var x=t("workflow.mailinglist.short")+": "+H.allMailinglists[e.data.mailinglistId];if(e.data.targets&&0<e.data.targets.length)for(x+="<br>"+t("workflow.target.short")+": ",A=0;A<e.data.targets.length;A++){if(x+=H.allTargets[e.data.targets[A]],A==B.MAX_NUMBER_OF_TARGETS_FOR_DISPLAY-1&&e.data.targets.length>B.MAX_NUMBER_OF_TARGETS_FOR_DISPLAY){x+=", ...";break}if(A<e.data.targets.length-1)switch(String(e.data.targetsOption)){case"ALL_TARGETS_REQUIRED":x+=" ‚à© ";break;case"NOT_IN_TARGETS":x+=" ‚â† ";break;case"ONE_TARGET_REQUIRED":x+=" ‚à™ ";break;default:x+=", "}}if(e.elementJQ.append("<div class='icon-extra-info'>"+x+"</div>"),0==r&&n<1){e.elementJQ.find("div.icon-extra-info").css("font-size",i+"%");var S=-1*e.elementJQ.find("div.icon-extra-info").height();S<n&&(n=S)}}else if(e.type==W.NODE_TYPE_REPORT){var T="";for(A=0;A<e.data.reports.length;A++){if(T+=H.allReports[e.data.reports[A]],A==B.MAX_NUMBER_OF_REPORTS_FOR_DISPLAY-1&&e.data.reports.length>B.MAX_NUMBER_OF_REPORTS_FOR_DISPLAY){T+=", ...";break}A<e.data.reports.length-1&&(T+=",<br>")}e.elementJQ.append("<div class='icon-extra-info'>"+t("workflow.defaults.report")+":<br>"+T+"</div>")}else if(e.type==W.NODE_TYPE_ARCHIVE)e.elementJQ.append("<div class='icon-extra-info'>"+H.allCampaigns[e.data.campaignId]+"</div>");else if(e.type==W.NODE_TYPE_FORM)e.elementJQ.append("<div class='icon-extra-info'>"+H.allUserForms[e.data.userFormId]+"</div>");else if(e.type==W.NODE_TYPE_MAILING||e.type==W.NODE_TYPE_ACTION_BASED_MAILING||e.type==W.NODE_TYPE_DATE_BASED_MAILING){x="";e.iconTitle?x=e.iconTitle:e.filled&&0<e.data.mailingId&&(x=H.allMailings[e.data.mailingId]),e.elementJQ.append("<div class='icon-extra-info'>"+x+"</div>")}else if(e.type==W.NODE_TYPE_FOLLOWUP_MAILING){x="";var D,k,R="";if(e.iconTitle){var O=e.iconTitle.split(":/");O.length&&(k=1<O.length?(D=O[0],O[1]):O[0])}else e.filled&&0<e.data.mailingId&&(D=H.allMailings[e.data.baseMailingId]||"?",k=H.allMailings[e.data.mailingId]||"?");if(k)if(D){var N=D,F=k;N.length>B.TITLE_ELLIPSIS_LENGTH&&(N=N.substring(0,B.TITLE_ELLIPSIS_LENGTH)+"..."),F.length>B.TITLE_ELLIPSIS_LENGTH&&(F=F.substring(0,B.TITLE_ELLIPSIS_LENGTH)+"...");var M=function(e){switch(String(e)){case B.REACTION_OPENED:return t("workflow.reaction.opened");case B.REACTION_NOT_OPENED:return t("workflow.reaction.not_opened");case B.REACTION_CLICKED:return t("workflow.reaction.clicked");case B.REACTION_NOT_CLICKED:return t("workflow.reaction.not_clicked");case B.REACTION_BOUGHT:return t("workflow.reaction.bought");case B.REACTION_NOT_BOUGHT:return t("workflow.reaction.NotBought")}return""}(e.data.decisionCriterion);x=N+" ("+M+") "+F,R=D+" ("+M+") "+k}else x=k;e.elementJQ.append("<div class='icon-extra-info'>"+x+"</div>"),R&&e.elementJQ.on({mouseover:function(){e.elementJQ.find(".icon-extra-info").html(R)},mouseleave:function(){e.elementJQ.find(".icon-extra-info").html(x)}})}else e.type==W.NODE_TYPE_IMPORT?e.elementJQ.append("<div class='icon-extra-info'>"+H.allAutoImports[e.data.importexportId]+"</div>"):e.type==W.NODE_TYPE_EXPORT&&e.elementJQ.append("<div class='icon-extra-info'>"+H.allAutoExports[e.data.importexportId]+"</div>");if((G=e.elementJQ.find("div.icon-extra-info")).css("font-size",i+"%"),e.type!=W.NODE_TYPE_PARAMETER&&(G.css("left",r+"px"),n<0&&0==r?G.css("top",-G.height()+"px"):G.css("top",n+"px")),e.type!=W.NODE_TYPE_PARAMETER)var P=e.elementJQ.find("div.icon-extra-info"),I=P.html(),L=function(e,t){var i=!1;if(V(e)>t){for(var n=e,o=n.html().split("<br>"),r=0;r<o.length;r++){n.text("");for(var a=n.height(),s="",l="",c=o[r].split(" "),u=0;u<c.length;u++)0<u&&n.text(n.text()+" "),n.text(n.text()+c[u]),""!=s&&(s+=" "),s+=c[u],n.height()>a&&(a=n.height(),V(n)>t&&(i=!0,s=z(n,s,t)),""!=l&&(l+=" "),n.text(l+s),l=n.text(),s="");o[r]=n.text()}for(n.html(""),r=0;r<o.length;r++)n.html(n.html()+o[r]),r<o.length-1&&n.html(n.html()+"<br>")}return i}(P,o.getScaledNodeSize());if(L&&(P.mouseover(function(){jQuery("#icon-label-popup-holder").append("<div id='node-label-fulltext-popup'>"+I+"</div>"),jQuery("#node-label-fulltext-popup").offset({top:P.offset().top,left:P.offset().left+o.getScaledNodeSize()})}),P.mouseout(function(){jQuery("#node-label-fulltext-popup").remove()})),e.statisticsList&&e.type!=W.NODE_TYPE_PARAMETER&&e.type!=W.NODE_TYPE_DECISION)for(A=0;A<e.statisticsList.length;A++){var G;(G=e.elementJQ.find("div.icon-extra-info")).append("<br><span class='node-stats'>"+e.statisticsList[A]+"</span>"),n<0&&0==r&&G.css("top",-G.height()+"px")}j.updateLabelConnection(e)}};var z=function(e,t,i){for(var n=e.text(),o=B.TITLE_ELLIPSIS_LENGTH;0<o;o--){var r=t.substr(0,o)+"...";if(e.text(r),V(e)<=i)return e.text(n),r}return e.text(n),""},V=function(e){var t=e.html();e.html("<span class='span-bounder'>"+t+"</span>");var i=e.find(".span-bounder").width();return e.html(t),i};this.resetUsedAnchors=function(){for(var e in l)l[e].usedAnchors=[];return l},this.getNodesByTypeList=function(e){var t=[];for(var i in l)-1!=jQuery.inArray(l[i].type,e)&&t.push(l[i]);return t},this.getNodesByType=function(e){return B.getNodesByTypeList([e])},this.openNodeIcon=function(){if(null!=B.openNodeId&&0!=B.openNodeId){var e=j.getCMNodes().getNodeIdPrefix()+B.openNodeId,t=j.getCampaignManagerNodes().getNodeById(e);null!=t&&null!=B.openNodeValue&&(t.type==W.NODE_TYPE_MAILING||t.type==W.NODE_TYPE_ACTION_BASED_MAILING||t.type==W.NODE_TYPE_DATE_BASED_MAILING||t.type==W.NODE_TYPE_FOLLOWUP_MAILING?t.data.mailingId=B.openNodeValue:t.type==W.NODE_TYPE_RECIPIENT&&"0"!=B.openNodeValue&&-1==jQuery.inArray(B.openNodeValue,t.data.targets)?t.data.targets.push(B.openNodeValue):t.type==W.NODE_TYPE_ARCHIVE?t.data.campaignId=B.openNodeValue:t.type==W.NODE_TYPE_FORM?t.data.userFormId=B.openNodeValue:t.type==W.NODE_TYPE_REPORT&&"0"!=B.openNodeValue&&-1==jQuery.inArray(B.openNodeValue,t.data.reports)?t.data.reports.push(B.openNodeValue):t.type!=W.NODE_TYPE_IMPORT&&t.type!=W.NODE_TYPE_EXPORT||(t.data.importexportId=B.openNodeValue));var i=jQuery("#"+e);0<i.length&&(B.openNodeId=null,B.openNodeValue=null,i.dblclick())}},this.setOpenNode=function(e,t){this.openNodeId=e,this.openNodeValue=t}}}(),AGN.Lib.WM.CampaignManagerScale=function(e){var t=0,i=this,n=e.campaignManagerSettings,o=(n.defaultScale-n.minScale)/((n.maxScale-n.minScale)/100);this.getCurrentScale=function(){return 0==t?n.minScale+o*(n.maxScale-n.minScale)/100:t},this.setExternalScale=function(e){t=e},this.getScaledGridSize=function(){return n.gridSize*i.getCurrentScale()},this.getScaledNodeSize=function(){return n.nodeSize*i.getCurrentScale()},this.getCurrentScaleSliderPosition=function(){return o},this.setCurrentScaleSliderPosition=function(e){o=e},this.coordinateToPx=function(e){return Math.round(e*i.getScaledGridSize())},this.pxToCoordinate=function(e){return Math.round(e/i.getScaledGridSize())},this.pxToMaxCoordinate=function(e){return Math.ceil(e/i.getScaledGridSize())},this.getLineWidth=function(){return Math.round(n.lineWidth*i.getCurrentScale())},this.getArrowLength=function(){return Math.round(n.arrowSize*i.getCurrentScale())},this.getArrowWidth=function(){return Math.round(n.arrowSize*i.getCurrentScale())},this.getLabelFontSize=function(){return Math.round(n.labelFontSize*i.getCurrentScale())}},function(){var e={selected:[],prevSelected:null,lastSelected:null,onSelectionChanged:null,nodeSelector:"",init:function(e){this.nodeSelector=e.nodeSelector,this.onSelectionChanged=e.onSelectionChanged},handleClick:function(e,t){e.stopPropagation(),0<this.selected.length&&(this.prevSelected=this.selected[this.selected.length-1]),this.validateMultiselection(e),-1!=$.inArray(t.attr("id"),this.selected)?this.isMultiselection(e)&&this.unselect(t):this.select(t),this.onSelectionChanged()},isMultiselection:function(e){return e.shiftKey},validateMultiselection:function(e){this.isMultiselection(e)||this.clear()},select:function(e){this.selected.push(e.attr("id")),e.addClass("selected"),this.lastSelected=e.attr("id"),this.onSelectionChanged()},unselect:function(e){this.selected.splice($.inArray(e.attr("id"),this.selected),1),e.removeClass("selected"),this.onSelectionChanged()},isSelected:function(e){return-1!=$.inArray(e,this.selected)},clear:function(){this.selected=[],$(this.nodeSelector).removeClass("selected"),this.onSelectionChanged()},getSelected:function(){return this.selected}};AGN.Lib.WM.CampaignManagerSelection=e}(),campaignManagerSettings={renderMode:jsPlumb.CANVAS,gridSize:20,nodeSize:64,arrowSize:10,lineWidth:4,lineColor:"#2e83b1",minScale:.5,defaultScale:1,maxScale:1.5,rapidButtonSize:16,dragStageKeyCode:32,deleteKeyCode:46,multiConnectionKeyCode:16,navigatorStep:100,imagePath:"",MAX_UNDO_HISTORY:17,zoomStep:10,labelFontSize:12},AGN.Lib.WM.WorkflowManagerStatistics=function(n){this.showStatistics=function(e){jQuery.ajax({type:"POST",url:"workflow.do;jsessionid="+n.getSessionId(),data:{method:"loadStatistics",workflowId:e},success:function(e){for(var t in e)n.getCMNodes().getNodes()[t].statisticsList=e[t];n.relayout(),window.status="wmLoadFinished"}})},this.hideStatistics=function(){var e=n.getCMNodes().getNodes();for(var t in e){var i=e[t];null!=i.statisticsList&&delete i.statisticsList}n.relayout()},this.toggleStatistics=function(e){this.statisticsVisible?this.hideStatistics():this.showStatistics(e),this.statisticsVisible=!this.statisticsVisible}},AGN.Lib.WM.WorkflowManagerStatisticsNew=function(n){this.showStatistics=function(e){jQuery.ajax({type:"POST",url:AGN.url("/workflow/loadStatistics.action"),data:{workflowId:e},success:function(e){for(var t in e)n.getCMNodes().getNodes()[t].statisticsList=e[t];n.relayout(),window.status="wmLoadFinished"}})},this.hideStatistics=function(){var e=n.getCMNodes().getNodes();for(var t in e){var i=e[t];null!=i.statisticsList&&delete i.statisticsList}n.relayout()},this.toggleStatistics=function(e){this.statisticsVisible?this.hideStatistics():this.showStatistics(e),this.statisticsVisible=!this.statisticsVisible}},function(){function t(t,i,n){if($.isFunction(i)){var o=2<arguments.length;return function(){var e=i.apply(t,arguments);return o?n:e}}return i}var e={arrowMode:!1,deleteSelected:!1,connectSelected:!1,undoSelected:!1,zoomMinSelected:!1,zoomMiddleSelected:!1,zoomMaxSelected:!1,doAutoLayout:!1,init:function(e){$.extend(this,e),$("#arrowButton").click(t(this,this.arrowButtonClick)),$("#autoLayout, #autoLayoutItem").click(t(this,this.doAutoLayout)),$("#deleteButton, #deleteItem").click(t(this,this.deleteSelected)),$("#undoButton, #undoItem").click(t(this,this.undoSelected,!1)),$("#zoomMin, #zoomMinItem").click(t(this,this.zoomMinSelected,!1)),$("#zoomMiddle, #zoomMiddleItem").click(t(this,this.zoomMiddleSelected,!1)),$("#zoomMax, #zoomMaxItem").click(t(this,this.zoomMaxSelected,!1))},arrowButtonClick:function(){this.arrowMode?this.arrowMode=!1:this.connectSelected()||(this.arrowMode=!0),this.arrowMode?$("#arrowButton").addClass("button-selected"):$("#arrowButton").removeClass("button-selected")},setUndoAvailable:function(e){e?($("#undoButtonFake").css("visibility","hidden"),$("#undoButton").removeClass("backgroundImageNone")):($("#undoButtonFake").css("visibility","visible"),$("#undoButton").addClass("backgroundImageNone")),$("#undoItem").prop("disabled",!e)},setDeletionAvailable:function(e){$("#deleteButton, #deleteItem").prop("disabled",!e)}};AGN.Lib.WM.CampaignManagerToolbar=e}(),agGrid.BaseFilter.prototype.generateTemplate=function(){var e=this.translate.bind(this),t=this.createConditionBody(0);return"<div>\n                    <div class='ag-filter-body-wrapper'>"+(this.acceptsBooleanLogic()?this.wrapCondition(t):t)+'</div>\n                    <div class="ag-filter-apply-panel" id="applyPanel">\n                        <a href="#" id="clearButton">'+e("clearFilter")+'</a>\n                        <button type="button" id="applyButton">'+e("applyFilter")+"</button>\n                    </div>\n                </div>"},agGrid.BaseFilter.prototype.createConditionTemplate=function(e){return'<div class="ag-filter-condition">\n            <div class="ag-filter-condition-type radio"><label class="" for="andId"><input id="andId" type="radio" class="and" name="booleanLogic" value="AND" checked="checked" /> AND</label>\n            <label  class="" for="orId"><input id="orId" type="radio" class="or" name="booleanLogic" value="OR" /> OR</label></div>\n            <div>'+this.createConditionBody(e)+"</div>\n        </div>"},agGrid.TextFilter.prototype.bodyTemplate=function(e){return'<div class="ag-filter-body">\n            <input class="ag-filter-filter form-control" id='+(0==e?"filterText":"filterConditionText")+' type="text" placeholder="'+this.translate.bind(this)("filterOoo","Filter...")+'"/>\n        </div>'},agGrid.TextFilter.prototype.generateFilterHeader=function(e){var t=this,i=this.getApplicableFilterTypes(),n=this.filterParams.filterOptions,o=(n||i).map(function(e){return'<option value="'+e+'">'+t.translate(e)+"</option>"}),r=1==o.length?"disabled":"",a=0==e?"filterType":"filterConditionType";return o.length<=0?"":'<div>\n                <select class="ag-filter-select form-control" id="'+a+'" '+r+">\n                    "+o.join("")+"\n                </select>\n            </div>"},agGrid.NumberFilter.prototype.bodyTemplate=function(e){var t=this.translate.bind(this),i=0==e?"filterNumberToPanel":"filterNumberToPanelCondition",n=0==e?"filterToText":"filterToConditionText";return'<div class="ag-filter-body">\n            <div>\n                <input class="ag-filter-filter form-control" id="'+(0==e?"filterText":"filterConditionText")+'" type="text" placeholder="'+t("filterOoo")+'"/>\n            </div>\n             <div class="ag-filter-number-to" id="'+i+'">\n                <input class="ag-filter-filter form-control" id="'+n+'" type="text" placeholder="'+t("filterOoo")+'"/>\n            </div>\n        </div>'},agGrid.NumberFilter.prototype.generateFilterHeader=agGrid.TextFilter.prototype.generateFilterHeader,agGrid.TextFilter.prototype.createConditionTemplate=function(e){return'<div class="ag-filter-condition">\n            <div class="ag-filter-condition-type radio"><label class="" for="andId"><input id="andId" type="radio" class="and" name="booleanLogic" value="AND" checked="checked" /> AND</label>\n            <label  class="" for="orId"><input id="orId" type="radio" class="or" name="booleanLogic" value="OR" /> OR</label></div>\n            <div>'+this.createConditionBody(e)+"</div>\n        </div>"},function(){function e(){}e.prototype.init=function(e){this.eGui=document.createElement("div"),e.optionDateFormat?this.format=e.optionDateFormat:(this.format="DD.MM.YYYY",e.optionShowTime&&(e.optionShowSeconds?this.format+=" HH:mm:ss":this.format+=" HH:mm")),e.value&&(e.valueFormatted||(e.valueFormatted=moment(e.value).format(this.format)),this.eGui.innerHTML=e.valueFormatted)},e.prototype.getGui=function(){return this.eGui},e.prototype.refresh=function(e){return e.value?(e.valueFormatted=moment(e.value).format(this.format),this.eGui.innerHTML=e.valueFormatted):this.eGui.innerHTML="",!0},e.prototype.destroy=function(){},AGN.Opt.TableCellRenderers.DateCellRenderer=e}(),function(){function e(){}e.prototype.init=function(e){this.eGui=document.createElement("div"),this.eGui.innerHTML='<div class="ag-filter">  <div>    <div class="ag-filter-body-wrapper">      <div class="ag-filter-body">        <label class="">'+t("tables.from")+'</label>        <input class="ag-filter-filter form-control js-datepicker js-datepicker-right" id="filterBegin" type="text" placeholder="">      </div>      <div class="ag-filter-body">        <label class="">'+t("tables.till")+'</label>        <input class="ag-filter-filter form-control js-datepicker js-datepicker-right" id="filterEnd" type="text" placeholder="">      </div>    </div>    <div class="ag-filter-apply-panel" id="applyPanel">      <a href="#" id="clearFilter" class="">'+t("tables.clearFilter")+"</a>    </div>  </div></div>",this.filterBegin=$(this.eGui).find("#filterBegin"),this.filterEnd=$(this.eGui).find("#filterEnd"),this.beginDate=void 0,this.endDate=void 0,this.clearFilter=$(this.eGui).find("#clearFilter"),this.filterBegin.on("change",this.filterBeginChanged.bind(this)),this.filterEnd.on("change",this.filterEndChanged.bind(this)),this.clearFilter.on("click",this.filterClear.bind(this)),this.filterActive=!1,this.filterChangedCallback=e.filterChangedCallback,this.valueGetter=e.valueGetter},e.prototype.afterGuiAttached=function(){AGN.Initializers.PickADate($(this.eGui))},e.prototype.destroy=function(){this.filterBegin.off("change",this.filterBeginChanged.bind(this)),this.filterEnd.off("change",this.filterEndChanged.bind(this))},e.prototype.filterBeginChanged=function(){this.filterEnd.data("pickadate").set("min",this.filterBegin.val()),this.beginDate=this.filterBegin.data("pickadate").get("select").pick,this.filterActive=this.beginDate||this.endDate,this.filterChangedCallback()},e.prototype.filterEndChanged=function(){this.filterBegin.data("pickadate").set("max",this.filterEnd.val()),this.endDate=this.filterEnd.data("pickadate").get("select").pick,this.filterActive=this.beginDate||this.endDate,this.filterChangedCallback()},e.prototype.filterClear=function(){this.filterEnd.val(void 0),this.filterBegin.val(void 0),this.beginDate=void 0,this.endDate=void 0,this.filterEnd.data("pickadate").set("min",!1),this.filterBegin.data("pickadate").set("max",!1),this.filterActive=!1,this.filterChangedCallback()},e.prototype.getGui=function(){return this.eGui},e.prototype.doesFilterPass=function(e){var t=this.valueGetter(e.node);return!this.beginDate&&!this.endDate||!!t&&(this.beginDate&&this.endDate?t>=this.beginDate&&t<=this.endDate:this.beginDate?t>=this.beginDate:this.endDate?t<=this.endDate:void 0)},e.prototype.parseDate=function(e){if(e)return moment(e,t("date.format").toUpperCase()).valueOf()},e.prototype.isFilterActive=function(){return this.filterActive},e.prototype.getModel=function(){},e.prototype.setModel=function(){},AGN.Lib.TableDateFilter=e}(),function(){function e(){}var n=AGN.Lib.Table,o=AGN.Lib.Confirm,r=AGN.Lib.Page,t=AGN.Lib.Tooltip;function a(e){return e.valueFormatted?e.valueFormatted:e.value}e.prototype.init=function(i){i.eGridCell.classList.add("ag-cell-table-actions"),this.eGui=document.createElement("div"),this.eGui.innerHTML='<button type="button" class="btn btn-regular btn-alert"><i class="icon icon-trash-o"></i></button>',this.eButton=this.eGui.querySelector(".btn"),i.colDef["button-tooltip"]&&t.createTip($(this.eButton),i.colDef["button-tooltip"]);var e=a(i);e?this.eButton.setAttribute("href",e):this.eGui.style.visibility="hidden",this.eventListener=function(e){var t=this;return $.get(a(i)).done(function(e){1==$(e).all(".modal").length?o.create(e).done(function(){n.get($(t)).api.updateRowData({remove:[i.data]})}):r.render(e)}),e.preventDefault(),!1},this.eButton.addEventListener("click",this.eventListener)},e.prototype.getGui=function(){return this.eGui},e.prototype.refresh=function(e){var t=a(e);return this.eGui.style.visibility=t?"visible":"hidden",this.eButton.dataset.url=t,!0},e.prototype.destroy=function(){this.eButton.removeEventListener("click",this.eventListener)},AGN.Opt.TableCellRenderers.DeleteCellRenderer=e}(),AGN.Lib.TableNumberComparator=function(e,t,i,n,o){return e=parseFloat(e),t=parseFloat(t),isNaN(e)||isNaN(t)?isNaN(e)?isNaN(t)?0:o?-1:1:o?1:-1:e-t},function(){function e(){}AGN.Lib.Table;e.prototype.init=function(e){var t=this;this.eGui=document.createElement("div"),this.eGui.innerHTML='<label><input type="checkbox" name="" value="on"</label>',this.eInput=this.eGui.querySelector("input"),this.eInput.setAttribute("name",e.valueFormatted?e.valueFormatted:e.value),this.eventListener=function(){this!==t.eInput&&(t.eInput.checked=!t.eInput.checked)},this.eGui.addEventListener("click",this.eventListener)},e.prototype.getGui=function(){return this.eGui},e.prototype.refresh=function(e){return this.eInput.setAttribute("name",e.valueFormatted?e.valueFormatted:e.value),!0},e.prototype.destroy=function(){this.eGui.removeEventListener("click",this.eventListener)},AGN.Lib.SelectCellRenderer=e}(),function(){function e(){}AGN.Lib.Table;e.prototype.init=function(e){this.agParams=e,this.eGui=document.createElement("div"),this.eGui.innerHTML='<input type="checkbox" data-form-bulk="bulkID">'},e.prototype.getGui=function(){return this.eGui},e.prototype.destroy=function(){},AGN.Lib.SelectHeaderComponent=e}(),function(){function e(){}e.prototype.init=function(i){this.column=i.colDef.field,this.values=_.sortBy(_.uniq(_.map(i.rowModel.rowsToDisplay,function(e){return e.data[i.colDef.field]}))),this.eGui=document.createElement("div"),this.eGui.innerHTML='<div class="ag-filter">  <div>    <div class="ag-filter-body-wrapper">'+this.buildOptions()+'    </div>    <div class="ag-filter-apply-panel" id="applyPanel">      <a href="#" id="clearFilter" class="">'+t("tables.clearFilter")+"</a>    </div>  </div></div>",this.checkBoxes=$(this.eGui).find("input"),this.checkedBoxes=[],this.clearFilter=$(this.eGui).find("#clearFilter"),this.checkBoxes.on("change",this.checkBoxesChanged.bind(this)),this.clearFilter.on("click",this.filterClear.bind(this)),this.filterActive=!1,this.filterChangedCallback=i.filterChangedCallback,this.valueGetter=i.valueGetter},e.prototype.buildOptions=function(){return _.map(this.values,function(e){return'<div class="ag-filter-body">  <label class="">    <input class="" type="checkbox" value="'+e+'">    '+e+"  </label></div>"}).join("\n")},e.prototype.afterGuiAttached=function(){},e.prototype.destroy=function(){this.checkBoxes.off("change",this.checkBoxesChanged.bind(this)),this.clearFilter.off("click",this.filterClear.bind(this))},e.prototype.checkBoxesChanged=function(){this.valuesFiltered=_.map(_.filter(this.checkBoxes,{checked:!0}),function(e){return e.value}),this.filterActive=0!=this.valuesFiltered.length,this.filterChangedCallback()},e.prototype.filterClear=function(){this.checkBoxes.removeAttr("checked"),this.valuesFiltered=[],this.filterActive=!1,this.filterChangedCallback()},e.prototype.getGui=function(){return this.eGui},e.prototype.doesFilterPass=function(e){var t=this.valueGetter(e.node);return _.includes(this.valuesFiltered,t)},e.prototype.isFilterActive=function(){return this.filterActive},e.prototype.getModel=function(){},e.prototype.setModel=function(){},AGN.Lib.TableSetFilter=e}(),function(){function e(){}e.prototype.init=function(e){this.eGui=document.createElement("div");var i="";1===e.value.endTypeId?i=t("workflow.stop.automatic_end"):2===e.value.endTypeId&&(i=moment(e.value.dateLong).format(e.adminDateTimeFormat)),this.eGui.innerHTML=i},e.prototype.getGui=function(){return this.eGui},e.prototype.refresh=function(e){return!1},e.prototype.destroy=function(){},AGN.Opt.TableCellRenderers.WorkflowEndCellRenderer=e}(),function(){function e(){}e.prototype.init=function(e){if(this.eGui=document.createElement("div"),e.value){var i='  <i class="'+e.value.iconClass+"></i>\n              <strong>"+t("workflow.reaction"+e.value.name)+"</strong>";this.eGui.innerHTML=i}},e.prototype.getGui=function(){return this.eGui},e.prototype.refresh=function(e){return!1},e.prototype.destroy=function(){},AGN.Opt.TableCellRenderers.WorkflowReactionCellRenderer=e}(),function(){function e(){}e.prototype.init=function(e){this.eGui=document.createElement("div");var i="";i=1===e.value.startTypeId?' <span class="badge badge-campaigntype-actionbased">\n              <i class="icon icon-gear"></i>\n              <strong>'+t("workflow.start.action_based")+"</strong>\n         </span>":2===e.value.startTypeId?'<span class="badge badge-campaigntype-datebased">\n              <i class="icon icon-calendar-o"></i>\n              <strong>'+t("workflow.start.date_based")+"</strong>\n        </span>":moment(e.value.dateLong).format(e.adminDateTimeFormat),this.eGui.innerHTML=i},e.prototype.getGui=function(){return this.eGui},e.prototype.refresh=function(e){return!1},e.prototype.destroy=function(){},AGN.Opt.TableCellRenderers.WorkflowStartCellRenderer=e}(),function(){function e(){}e.prototype.init=function(e){if(this.eGui=document.createElement("div"),e.value){var i=e.value.name;this.eGui.innerHTML='<span class="status-badge campaign.status.'+i+'"></span> '+t("workflow.status."+i)}},e.prototype.getGui=function(){return this.eGui},e.prototype.refresh=function(e){return!1},e.prototype.destroy=function(){},AGN.Opt.TableCellRenderers.WorkflowStatusCellRenderer=e}(),function(){var t=AGN.Lib.Editor;AGN.Initializers.Ace=function(e){e=e||$(document),_.each(e.find(".js-editor, .js-editor-text, .js-editor-eql, .js-editor-css"),function(e){t.get($(e))})}}(),function(){function n(e,t,i){t.change(function(){o(e,t,i)})}function o(e,t,i){i?t.is(":checked")?e.removeClass("hidden"):e.addClass("hidden"):t.is(":checked")?e.addClass("hidden"):e.removeClass("hidden")}function r(e,t,i){for(var n=t.val(),o=!1,r=0;r<i.length;r++)if(i[r]==n){o=!0;break}o?e.removeClass("hidden"):e.addClass("hidden")}AGN.Initializers.CheckboxHider=function(e){e=e||$(document),_.each(e.find("[data-show-by-checkbox]"),function(e){var t=$(e),i=$(t.data("show-by-checkbox"));o(t,i,!0),n(t,i,!0)}),_.each(e.find("[data-hide-by-checkbox]"),function(e){var t=$(e),i=$(t.data("hide-by-checkbox"));o(t,i,!1),n(t,i,!1)}),_.each(e.find("[data-show-by-select]"),function(e){for(var t=$(e),i=$(t.data("show-by-select")),n=t.data("show-by-select-values").split(","),o=0;o<n.length;o++)n[o]=n[o].trim();r(t,i,n),function(e,t,i){t.change(function(){r(e,t,i)})}(t,i,n)})}}(),function(){var r=AGN.Lib.AutoSave;function a(e,t){var i=e.attr("id"),n=e.data("_editor");window.CKEDITOR&&CKEDITOR.instances[i]?CKEDITOR.instances[i].setData(t):n?n.val(t):e.val(t)}AGN.Initializers.AutoSave=function(e){e=e||$(document),_.each(e.find("[data-autosave-scope]"),function(e){var t=$(e),i=t.data("autosave-scope"),n=t.data("autosave-period"),o=t.all("[data-autosave]");if(0<o.length){r.initialize(i,function(){if(0<(o=o.filter(function(e,t){return document.contains(t)})).length){var i={};return _.each(o,function(e){var t=$(e);i["value#"+t.data("autosave")]=t.val()}),i}return!1},function(r){var e=$.map(o,function(e){var t=$(e),i="value#"+t.data("autosave");if(i in r){var n=t.val(),o=r[i];if(n!=o){if(!t.is("[data-autorestore]"))return{target:t,value:o};a(t,o)}return null}});return 0<e.length&&e},function(e){_.each(e,function(e){a(e.target,e.value)})},n)}})}}(),AGN.Lib.DomInitializer.new("autosubmit",function(e){setTimeout(function(){AGN.Lib.Form.get(e).submit()},100)}),AGN.Lib.DomInitializer.new("calendar-table",function(){var t=this.config;AGN.Lib.CalendarService.setUp(t),window.setInterval(AGN.Lib.CalendarService.checkProgress,500),AGN.Lib.CalendarService.getMonthMode()?AGN.Lib.CalendarService.generateMonthCalendar(AGN.Lib.CalendarService.getCurMonth(),AGN.Lib.CalendarService.getCurYear()):AGN.Lib.CalendarService.generateWeekCalendar(AGN.Lib.CalendarService.getCurMonth(),AGN.Lib.CalendarService.getCurYear(),AGN.Lib.CalendarService.getCurDay()),AGN.Lib.CalendarService.generateUnsentMailingsTable();var e=AGN.Lib.Action;e.new({click:"#dateTimePicker"},function(){this.event.stopPropagation()}),e.new({click:"#dateTimePickerButton"},function(){this.event.stopPropagation()}),e.new({click:".js-calendar-navigate-previous"},function(){return AGN.Lib.CalendarService.prevEntry(),this.event.preventDefault(),!1}),e.new({click:".js-calendar-navigate-next"},function(){return AGN.Lib.CalendarService.nextEntry(),this.event.preventDefault(),!1}),e.new({click:".js-calendar-navigate-today"},function(){return AGN.Lib.CalendarService.jumpToday(),this.event.preventDefault(),!1}),e.new({click:".js-calendar-view-month"},function(){return AGN.Lib.CalendarService.toggleDateSelectionMode("SELECT_MONTH"),this.event.preventDefault(),!1}),e.new({click:".js-calendar-view-week"},function(){return AGN.Lib.CalendarService.toggleDateSelectionMode("SELECT_WEEK"),this.event.preventDefault(),!1}),e.new({click:".js-calendar-list-unsent"},function(){return AGN.Lib.CalendarService.generateUnsentMailingsTable(),this.event.preventDefault(),!1}),e.new({click:".js-calendar-list-planned"},function(){return AGN.Lib.CalendarService.generatePlannedMailingsTable(),this.event.preventDefault(),!1}),e.new({click:"#comment-save-button"},function(){AGN.Lib.ReminderService.reminder.onSave()}),e.new({click:".calendar-comments-add"},function(){var e;return e=this.el.parents(".calendar-day-container").data("date"),AGN.Lib.CalendarService.showCommentDialog(AGN.Lib.ReminderService.getNewReminder(e,t)),!1}),e.new({click:".calendar-comments-toggle"},function(){var e;return e=this.el.parents(".calendar-day-container").data("date"),AGN.Lib.CalendarService.toggleComment(e),!1}),e.new({change:".js-calendar-toggle-all-comments"},function(){this.el.prop("checked")?$(".calendar-table").find(".calendar-comment").show():$(".calendar-table").find(".calendar-comment").hide(),AGN.Lib.CalendarService.adjustSidebarHeight()}),e.new({change:"#scheduleReminder"},function(){AGN.Lib.ReminderService.onScheduleChanged()}),e.new({change:"#isDeadline"},function(){AGN.Lib.ReminderService.onDeadlineChanged()}),e.new({change:"#month_list, #month_list_year, #weeks_list"},function(){AGN.Lib.CalendarService.showDate()}),e.new({change:"#weeks_list_year"},function(){AGN.Lib.CalendarService.createWeeksList(this.el[0])}),e.new({change:'#reminderDetails input[name="userType"]'},function(){var e=this.el[0];AGN.Lib.ReminderService.onUserTypeChanged(e.value)}),this.addAction({mouseover:"mailing-popup"},function(){var e=this.el,t=$("#popup-"+e.data("mailing-id"));if(t.exists()){var i,n=$(window).scrollTop(),o=t.outerHeight(),r=e.offset().top,a=r+e.outerHeight(),s=r-n-15,l=n+$(window).outerHeight()-a;o<=s||l<s?(i=r-15-o,t.addClass("top"),t.removeClass("bottom")):(i=a+15,t.addClass("bottom"),t.removeClass("top")),t.css({top:i,left:e.offset().left+e.outerWidth()/2-t.outerWidth()/2}),t.css("z-index","1500"),t.css("display","block")}}),this.addAction({mouseout:"mailing-popup"},function(){var e=this.el.data("mailing-id");$("#popup-"+e).css("display","none")})}),function(){var e;e=function(){var u,h,p,a,r,s,i,l,n,o,c,f,d,g,m,v,y,b,w,C,A,E=0,x=t("date.monthsFull"),S=new Date;S.setHours(0,0,0,0);var T=S.getMonth(),D=S.getFullYear(),k=S.getDate(),R=!0,O={},N="MONTH",F=[],e=0,M=!1,P=0;function I(){M=!0,P++}function L(){--P<=0&&(P=0,M=!1,$("#calendar-wait-notification").hide())}function G(e,t){O={};var i=new Date(t,e,1),n=U(e+1,t),o=i.getDay()-p;o<0&&(o=7+o);var r=Math.ceil((n+o)/7),a=new Date(t,e,1-o),s=new Date(t,e,1+7*r);i=new Date(a);for(var l=0;l<r;l++){var c="row-"+(l+1);$("#calendar-container").append('<tr id="'+c+'"><td class="calendar-week-number-cell">'+i.getWeek(p)+"</td></tr>");for(var u=0;u<7;u++){var d=i.getMonth()!=e;J(i,i.getDate(),"",!0,c,d),i.setDate(i.getDate()+1)}}$("#calendar-days").html(x[e]+" "+t),he(a,s),le(a,s),ue(a,s),de(a,s),oe(),_e(),re(),ve(e,t)}function B(e,t,i){O={};var n=new Date(t,e,i);n.getDay();n.setDate(i-n.getDay()-1+p);var o=new Date(n.getFullYear(),n.getMonth(),n.getDate());o.setDate(o.getDate()+1),a=o.getWeek(p),0==e&&1==i&&1!=o.getWeek(p)&&(o.setTime(o.getTime()+6048e5),n.setTime(n.getTime()+6048e5)),$("#calendar-container").append('<tr id="week-row"></tr>'),$("#week-row").append('<td class="calendar-week-number-cell">'+o.getWeek(p)+"</td>");for(var r=0;r<=6;r++)n.setDate(n.getDate()+1),J(n,AGN.Lib.DateFormat.format(n,u),"calendar-week-day-container",!1,"week-row",!1);$("#calendar-days").html(AGN.Lib.DateFormat.format(o,u)+" - "+AGN.Lib.DateFormat.format(n,u)),he(o,n),le(o,n),ue(o,n),de(o,n),oe(),re(),me(e,t,i)}function j(e,t){var i;e.draggable({stack:t,revert:"invalid",distance:20,start:function(){(i=$("#popup-"+e.prop("id"))).hide(),i.detach(),V()},stop:function(){$("#calendar-popup-holder").append(i)}})}function W(e){j(e,".calendar-mail-label")}function H(e){j(e,".calendar-comment")}function z(){$(".calendar-comments-toggle").css("visibility","hidden"),$(".calendar-day-container").has(".calendar-comment").each(function(){$(this).find(".calendar-comments-toggle").css("visibility","visible")}),re()}function V(){var e;document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&(e=window.getSelection())&&e.removeAllRanges&&e.removeAllRanges()}function U(e,t){return new Date(t,e,0).getDate()}function Y(e){var t="SELECT_MONTH"==e;if(t&&R||!t&&!R)R?ve(T,D):me(T,D,k);else if(q(),t){var i=new Date(D,T,k);i.setDate(i.getDate()+7),1==a&&D<i.getFullYear()&&(T=0,D++,k=1),G(T,D),!(R=!0)}else B(T,D,k),!(R=!1)}function q(){$("#calendar-container").empty(),$("#calendar-popup-holder").empty(),$(".calendar-mail-label").remove()}function Q(e){var t=e?-7:7;q();var i=new Date(D,T,k);i.setDate(i.getDate()+t),k=i.getDate(),T=i.getMonth(),D=i.getFullYear(),i.setDate(i.getDate()+t);var n=$("#month_list_year option"),o=Number(n[n.length-1].value),r=Number(n[0].value);i.getFullYear()<o&&fe(),i.getFullYear()>r&&pe(),B(T,D,k)}function K(){q(),--T<0&&(T=11,D--);var e=$("#month_list_year option"),t=Number(e[e.length-1].value);D<t&&fe(),G(T,D)}function X(){q(),11<++T&&(T=0,D++);var e=$("#month_list_year option");Number(e[0].value)<D&&pe(),G(T,D)}function J(e,t,i,n,o,r){var a="",s="";if(r)a="calendar-another-month-day";else{var l=new Date(e.getFullYear(),e.getMonth(),e.getDate());l.getTime()==S.getTime()&&(a="calendar-current-day"),0!=l.getDay()&&6!=l.getDay()||(a+=" calendar-weekend-day",s=" calendar-weekend-day-label")}var c=we(new Date(e.getFullYear(),e.getMonth(),e.getDate())),u="day-"+c;$("#"+o).append('<td id="'+u+'" data-date="'+c+'" class="calendar-day-container '+i+" "+a+'"></td>'),$("#"+u).append('<div class="calendar-day-label'+s+'" id="label-'+u+'"></div>'),$("#label-"+u).append(t),ee(u),n&&Z(u),O[u]=!n}function Z(e){$("#label-"+e).append('<button type="button" class="calendar-comments-toggle" title="'+t("calendar.title.show_hide_comment")+'"><i class="icon icon-comments"></i></button>'),$("#"+e+" .calendar-comments-toggle").css("visibility","hidden")}function ee(e){$("#label-"+e).append('<button type="button" class="calendar-comments-add" title="'+t("calendar.title.new_comment")+'"><i class="icon icon-plus"></i></button>'),$("#label-"+e+" .calendar-comments-add").css("visibility","hidden"),$("#"+e).mouseover(function(){$("#"+e).hasClass("calendar-another-month-day")||$("#label-"+e+" .calendar-comments-add").css("visibility","visible")}),$("#"+e).mouseout(function(){$("#label-"+e+" .calendar-comments-add").css("visibility","hidden")})}function te(e){var i="comment-"+e.id,n="day-"+e.getDateAsString(),o=e.text.replace(/\n/g,"<br>"),r=$("#"+n),a=$("#"+i);if(!a.exists()&&r.exists()){a=$('<div id="'+i+'" data-comment-id="'+e.id+'" class="calendar-mail-label calendar-comment"><span class="calendar-badge comment-badge"><span class="comment-text-content">'+o+"</span></span></div>"),O[n]||a.css("display","none"),r.append(a);var s=$("#calendar-popup-holder");s.append('<input type="hidden" id="deadline-'+i+'" name="'+i+'" value="'+e.isDeadline+'"/>'),s.append('<input type="hidden" id="notified-'+i+'" name="'+i+'" value="'+e.isNotified+'"/>'),s.append('<input type="hidden" id="emm-user-type-'+i+'" name="'+i+'" value="'+e.isEmmUserType+'"/>'),s.append('<input type="hidden" id="notify-admin-id-'+i+'" name="'+i+'" value="'+e.notifyAdminId+'"/>'),s.append('<input type="hidden" id="recipients-'+i+'" name="'+i+'" value="'+e.recipients+'"/>'),s.append('<input type="hidden" id="plannedSendDate-'+i+'" name="'+i+'" value="'+e.getPlannedSendDateAsString()+'"/>'),a.dblclick(function(){AGN.Lib.CalendarService.showCommentDialog(AGN.Lib.ReminderService.getReminder(i,e.currentAdminName))});var l=$('<button type="button" id="remove-'+i+'" class="calendar-comments-remove"><i class="icon icon-trash-o"></i></button>');a.find(".comment-badge").append(l),l.attr("title",t("calendar.title.delete_comment")),l.click(function(){return $("#deadline-"+i).remove(),$("#popup-"+i).remove(),a.remove(),se(i),z(),re(),!1}),a.mouseover(function(){l.css("display","block")}),a.mouseout(function(){l.css("display","none")}),H(a),function(a,e){$("#calendar-popup-holder").append('<div class="calendar-mail-popup" id="popup-comment-'+a+'"></div>'),$("#popup-comment-"+a).append('<div class="arrow"></div>'),$("#popup-comment-"+a).append('<div class="calendar-mail-popup-header">'+t("calendar.common.comment")+"</div>"),$("#popup-comment-"+a).append('<div class="calendar-mail-popup-content"><p class="comment-text-content">'+e+"</p></div>"),$("#popup-comment-"+a).css("display","none"),$("#popup-comment-"+a).css("word-wrap","break-word"),$("#comment-"+a).mouseover(function(){var e=$("#popup-comment-"+a),t=$(this),i=t.offset().top-$(window).scrollTop(),n=t.outerHeight(),o=e.outerHeight(),r=t.offset().top+n+15;o+15<i?(r=t.offset().top-o-15,e.addClass("top"),e.removeClass("bottom")):(e.addClass("bottom"),e.removeClass("top")),e.css({top:r,left:t.offset().left+t.outerWidth()/2-e.outerWidth()/2}),e.css("z-index","1500"),e.css("display","block")}),$("#comment-"+a).mouseout(function(){$("#popup-comment-"+a).css("display","none")})}(e.id,o)}}function ie(e,i,t){var n=e.data("date");if("true"!=i.attr("sent")){var o=i.data("time"),r=Ce(n,o);if(h<=r){if("true"==i.attr("planned")){var a=i.find("a");if(a.hasClass("calendar-mailing-status-planned-in-past")){var s="calendar-"+i.attr("workstatus").replace(/\./g,"-");a.addClass(s).removeClass("calendar-mailing-status-planned-in-past")}}var l=new Date(r);l.setHours(l.getHours()-3),l<h&&(o=null,i.data("time",null));var c=e.find(".calendar-mail-label"),u=!1;if(o&&$(c.get().reverse()).each(function(){var e=$(this),t=e.data("time");t&&t<o&&(e.after(i),u=!0)}),!u){var d=c.filter("[data-mailing-id]").last();d.length?(d.after(i),u=!0):e.append(i)}re(),function(e,t){$.ajax({type:"POST",url:f,data:{mailingId:e,date:t}})}(t,n)}}}function ne(e,t,i){var n=e.data("date");switch(t.data("status")){case r:return;case s:if(Ce(n,"00:00")<S)return}var o=e.find(".calendar-mail-label").filter("[data-push-id]").last();o.length?o.after(t):e.append(t),function(e,t){$.ajax({type:"POST",url:g,data:{pushId:e,date:t}})}(i,n)}function oe(){$(".calendar-day-container").droppable({hoverClass:"calendar-day-hover",drop:function(e,t){var i=$(this),n="UNKNOWN",o=t.draggable.data("comment-id");if(o?n="COMMENT":(o=t.draggable.data("mailing-id"))?n="MAILING":(o=t.draggable.data("push-id"))&&(n="PUSH"),"UNKNOWN"!=n)switch(t.draggable.css({top:"",left:""}),n){case"COMMENT":!function(e,t,i){var n=e.data("date");O["day-"+n]||$(".js-calendar-toggle-all-comments").prop("checked")||t.hide(),e.append(t),ae(AGN.Lib.ReminderService.getReminder("comment-"+i,l)),re(),z()}(i,t.draggable,o);break;case"MAILING":ie(i,t.draggable,o);break;case"PUSH":ne(i,t.draggable,o)}}})}function re(){var e=$("#calendar-table").height();$(".calendar-sidebar").css({"max-height":e+"px"})}function ae(t){$.ajax({type:"POST",url:y,data:{commentId:t.id,date:t.getDateAsString(),comment:t.text,deadline:t.isDeadline,sendNow:t.isSendNow,emmUserType:t.isEmmUserType,notifyAdminId:t.notifyAdminId,recipients:t.recipients,notified:t.isNotified,plannedSendDate:t.getPlannedSendDateAsString()},success:function(e){t.isSendNow=!1,0==t.id?(t.id=e.commentId,te(t),z()):function(e){var t="comment-"+e.id,i=$("#"+t);$("#deadline-"+t).val(e.isDeadline),$("#emm-user-type-"+t).val(e.isEmmUserType),$("#notify-admin-id-"+t).val(e.notifyAdminId),$("#recipients-"+t).val(e.recipients);var n=e.text.replace(/\n/g,"<br>");H(i),i.find(".comment-text-content").html(n),$("#popup-"+t+" .comment-text-content").html(n),$("#plannedSendDate-"+t).val(e.getPlannedSendDateAsString())}(t)}})}function se(e){$.ajax({type:"POST",url:b,data:{commentId:AGN.Lib.ReminderService.getReminderIdFromTag(e)}})}function le(e,t){e=we(e),t=we(t),I(),$.ajax({type:"GET",url:c,data:{startDate:e,endDate:t}}).success(function(e){$.each(e,function(e,t){!function(e){var t=$("#day-"+e.sendDate),i=$("#"+e.mailingId);if(t.exists()&&!i.exists()){var n,o=function(e){var t;t=e.sent&&"mailing.status.test"!=e.workstatus&&A?C.replace("{mailingId}",e.mailingId):w.replace("{mailingId}",e.mailingId);return t}(e);n=e.plannedInPast?"calendar-mailing-status-planned-in-past":"calendar-"+e.workstatus.replace(".","-");var r={sent:e.sent,planned:e.planned,mailingId:e.mailingId,statusClass:n,mailingLink:o,workstatus:e.workstatus,shortname:e.shortname,sendTime:e.sendTime};i=AGN.Lib.Template.dom("calendar-mail-link",r),t.append(i),r.subject=e.subject,r.mailsSent=e.mailsSent,r.previewImage=function(e){var t;t=e?AGN.url("/sc?compID="+e):AGN.url("/assets/core/images/facelift/no_preview.svg");return t}(e.preview_component),r.popupClass=e.preview_component?"":"calendar-mail-popup-preview-missing",r.emptyWorkstatus=!e.workstatus.trim(),r.openers=e.openers,r.clickers=e.clickers,r.workstatusIn=e.workstatusIn;var a=AGN.Lib.Template.dom("calendar-mail-popup",r);$("#calendar-popup-holder").append(a),AGN.Lib.CalendarService.addMailingDragging(i)}}(t)}),re()}).always(L)}function ce(e){switch(e.status){case r:return e.sendDate;case s:return e.startDate;default:return we(function(e){if(e){var t=e[0],i=e[1]-1,n=e[2];return new Date(t,i,n)}return null}(e.plannedFor))}}function ue(e,t){I(),$.ajax({type:"GET",url:d,data:{startDate:we(e),endDate:we(t)}}).done(function(e){var n=AGN.Lib.Template.prepare("calendar-planned-push-notification");$.each(e,function(e,t){var i=$(n(t));$("#day-"+ce(t)).append(i),W(i)}),re()}).always(L)}function de(e,t){I(),$.ajax({type:"POST",url:m,data:{startDate:we(e),endDate:we(t)},success:function(e){var n=AGN.Lib.Template.prepare("calendar-auto-optimization");$.each(e,function(e,t){var i=$(n({optimizationId:t.campaignID,shortname:t.shortname,action:function(e){return 0==e.workflowId?"optimize.do":"workflow.do"}(t),idParamName:function(e){return 0==e.workflowId?"optimizationID":"workflowId"}(t),idParamValue:function(e){return 0==e.workflowId?e.id:e.workflowId}(t),status:t.autoOptimizationStatus}));$("#day-"+t.sendDate).append(i)}),re()}}).always(L)}function he(e,t){$.ajax({type:"GET",url:v,data:{startDate:we(e),endDate:we(t)},success:function(e){$.each(e,function(e,t){!function(e){var t=_.cloneDeep(AGN.Lib.ReminderService.reminder),i=e.recipients.adminId;t.id=e.commentId,t.setDate(e.date),t.text=e.comment,t.notifyAdminId=i,t.isEmmUserType=0!=i,t.currentAdminName=e.adminName,t.isDeadline=e.deadline,t.isNotified=e.notified,t.setPlannedSendDate(e.plannedSendDates),t.recipients=e.recipients.value,AGN.Lib.CalendarService.addComment(t)}(t)}),AGN.Lib.CalendarService.checkHideCommentIconsVisibility(),_e(),re()}})}function pe(){for(var e=$("#month_list_year option"),t=$("#weeks_list_year option"),i=Number(e[e.length-1].value),n=0;n<e.length;n++){var o=Number(e[n].value)+1;e[n].text=o,e[n].value=o,t[n].text=o,t[n].value=o}e[e.length]=new Option(i,i),t[t.length]=new Option(i,i)}function fe(){var e=$("#month_list_year option"),t=$("#weeks_list_year option"),i=Number(e[e.length-1].value)-1;e[e.length]=new Option(i,i),t[t.length]=new Option(i,i)}function ge(e){var t=AGN.Lib.DateFormat.parseFormat(e,getDateFormat());T=t.getMonth(),D=t.getFullYear(),k=t.getDate(),q(),R?G(T,D):B(T,D,k)}function me(e,t,i){var n=new Date(t,e,i);n.setDate(i-n.getDay()-1+p);var o=new Date(n.getFullYear(),n.getMonth(),n.getDate());o.setDate(o.getDate()+1),0==e&&1==i&&1!=o.getWeek(p)&&o.setTime(o.getTime()+6048e5);var r=o.getWeek(p);if(1==r){var a=new Date(o.valueOf()+6048e5);o.getFullYear()!=a.getFullYear()&&(t=a.getFullYear())}$("#weeks_list_year")[0].selectedIndex=$("#weeks_list_year option[value = "+t+"]")[0].index,ye($("#weeks_list_year")[0]),$("#weeks_list")[0].selectedIndex=$("#weeks_list option[value = "+r+"]")[0].index,$("#weeks_list_year").select2({minimumResultsForSearch:-1}),$("#weeks_list").select2({minimumResultsForSearch:-1})}function ve(e,t){$("#month_list_year")[0].selectedIndex=$("#month_list_year option[value = "+t+"]")[0].index,$("#month_list")[0].selectedIndex=$("#month_list option[value = "+e+"]")[0].index,$("#month_list").select2({minimumResultsForSearch:-1}),$("#month_list_year").select2({minimumResultsForSearch:-1})}function ye(e){var t;F=[];var i=6048e5,n=e.options[e.selectedIndex].value,o=(new Date(n,11,31),new Date(n,0,1));o.setDate(1-o.getDay()-1+p),o.setDate(o.getDate()+1);var r=new Date(o.getFullYear(),o.getMonth(),o.getDate());for(r.setTime(o.getTime()+i-864e5),1!=o.getWeek(p)&&(o.setTime(o.getTime()+i),r.setTime(r.getTime()+i));(t=new Object).number=o.getWeek(p),t.firstDay=new Date(o.getFullYear(),o.getMonth(),o.getDate()),t.lastDay=new Date(r.getFullYear(),r.getMonth(),r.getDate()),F.push(t),o.setTime(o.getTime()+i),r.setTime(r.getTime()+i),1!=o.getWeek(p)&&o.getFullYear()==n;);for(var a in $("#weeks_list option").remove(),F)if(F.hasOwnProperty(a)){var s=document.createElement("option"),l=AGN.Lib.DateFormat.format(F[a].firstDay,u),c=AGN.Lib.DateFormat.format(F[a].lastDay,u);s.value=F[a].number,s.innerHTML=F[a].number+" : "+l+" - "+c,$("#weeks_list").append(s)}}function be(e,t){for(var i=e+"";i.length<t;)i="0"+i;return i}function we(e){return be(e.getDate(),2)+"-"+be(e.getMonth()+1,2)+"-"+e.getFullYear()}function Ce(e,t){var i=e.match(/^(\d\d)-(\d\d)-(\d{4})$/);if(i){var n=i[1],o=i[2]-1,r=i[3];if(t&&(i=t.match(/^(\d\d):(\d\d)$/))){var a=i[1],s=i[2];return new Date(r,o,n,a,s)}return new Date(r,o,n)}return null}function _e(){$(".js-calendar-toggle-all-comments").prop("checked")&&$(".calendar-table .calendar-comment").show()}function Ae(e){var t=encodeURI(e);if(-1!=t.indexOf("%")){var i=t.split("%").length-1;0==i&&i++,i+=t.length-3*i}else i=t.length;return i}this.getMonthMode=function(){return R},this.getDayWidth=function(){return E},this.getCurMonth=function(){return T},this.getCurYear=function(){return D},this.getCurDay=function(){return k},this.setDayWidth=function(e){E=e},this.setUp=function(e){u=e.localeDatePattern,h=new Date(e.currentServerTime),p=e.firstDayOfWeek,a=S.getWeek(p),r=e.pushStatusSent,s=e.pushStatusScheduled,l=e.adminName,i=e.secondsBeforeWaitMessage,n=e.urls.CALENDAR_UNSENT_MAILINGS,o=e.urls.CALENDAR_PLANNED_MAILINGS,c=e.urls.CALENDAR_MAILINGS_LIST,f=e.urls.CALENDAR_MAILINGS_MOVE,d=e.urls.CALENDAR_PUSHES_LIST,g=e.urls.CALENDAR_PUSHES_MOVE,m=e.urls.CALENDAR_AUTO_OPTIMIZATION,v=e.urls.CALENDAR_COMMENT_LIST,y=e.urls.CALENDAR_COMMENT_SAVE,b=e.urls.CALENDAR_COMMENT_REMOVE,w=e.urls.MAILING_VIEW,C=e.urls.MAILING_STATISTICS_VIEW,A=e.isStatisticsViewPermitted},this.toggleDateSelectionMode=function(e){"SELECT_MONTH"==e&&($("#linkSelectByMonth").toggleClass("active"),$("#linkSelectByWeek").toggleClass("active"),$("#dateSelectByMonth").css("display","inline"),$("#dateSelectByWeek").css("display","none"),Y(e),N="MONTH"),"SELECT_WEEK"==e&&($("#linkSelectByMonth").toggleClass("active"),$("#linkSelectByWeek").toggleClass("active"),$("#dateSelectByMonth").css("display","none"),$("#dateSelectByWeek").css("display","inline"),ye($("#weeks_list_year")[0]),Y(e),N="WEEK")},this.checkProgress=function(){M?i<=(e+=.5)&&$("#calendar-wait-notification").show():e=0},this.startProgress=I,this.stopProgress=L,this.generateMonthCalendar=G,this.generateWeekCalendar=B,this.addMailingDragging=W,this.addCommentDragging=H,this.checkHideCommentIconsVisibility=z,this.generateUnsentMailingsTable=function(){$.ajax({type:"GET",url:n,success:function(e){$(".calendar-sidebar-content").html(e),re(),AGN.Initializers.Tooltip($(".calendar-wrapper")),AGN.Initializers.Scrollable($(".calendar-wrapper"))}})},this.generatePlannedMailingsTable=function(){$.ajax({type:"GET",url:o,success:function(e){$(".calendar-sidebar-content").html(e),re(),AGN.Initializers.Tooltip($(".calendar-wrapper")),AGN.Initializers.Scrollable($(".calendar-wrapper"))}})},this.clearSelection=V,this.daysInMonth=U,this.changeCalendarMode=Y,this.removeCurrentCalendar=q,this.prevEntry=function(){R?K():Q(!0)},this.nextEntry=function(){R?X():Q(!1)},this.switchWeek=Q,this.prevMonth=K,this.nextMonth=X,this.addDayToCalendar=J,this.addCommentsShowButton=Z,this.addDayPopup=ee,this.toggleComment=function(e){O["day-"+e]?$("#day-"+e+" .calendar-comment").hide():$("#day-"+e+" .calendar-comment").show(),O["day-"+e]=!O["day-"+e],re()},this.validateComment=function(e){return""==e?($("#calendar-comment-error").html(t("calendar.error.empty_comment")),!1):!(1e3<Ae(e))||($("#calendar-comment-error").html(t("calendar.error.long_comment")),!1)},this.parseRecipients=function(e){if(e){for(var t=e.split(/[,; \t\n]+/),i=[],n=0;n<t.length;n++)t[n]&&i.push(t[n]);return i}return[]},this.validateEmails=function(e){if(!e||0==e.length)return $("#calendar-comment-error").html(t("calendar.error.empty_recipient_list")),!1;if(2e3<Ae(e.join(",")))return $("#calendar-comment-error").html(t("calendar.error.long_recipient_list")),!1;for(var i=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,n=0;n<e.length;n++)if(!i.test(e[n]))return $("#calendar-comment-error").html(t("calendar.error.invalid_email")+" "+e[n]),!1;return!0},this.showCommentDialog=function(e){AGN.Lib.Modal.create($("#calendar-dialog-modal-template").html()),AGN.Lib.ReminderService.fillCommentDialog(e),$("#calendar-comment-error").html(""),AGN.Lib.ReminderService.updateVisibility()},this.addComment=te,this.adjustSidebarHeight=re,this.saveCommentDB=ae,this.removeCommentDB=se,this.showDate=function(){var e;if("MONTH"==N){var t=$("#month_list option:selected").val(),i=$("#month_list_year option:selected").val(),n=new Date(i,t,1);strDate=AGN.Lib.DateFormat.format(n,getDateFormat()),e=$("#month_list_year option:selected").index()}if("WEEK"==N){var o=$("#weeks_list option:selected").val();for(var r in F)if(F.hasOwnProperty(r)&&F[r].number==o){strDate=AGN.Lib.DateFormat.format(F[r].firstDay,getDateFormat());break}e=$("#weeks_list_year option:selected").index()}0==e&&pe(),ge(strDate)},this.jumpToDate=ge,this.jumpToday=function(){ge(AGN.Lib.DateFormat.format(new Date,getDateFormat()))},this.createWeeksList=ye,this.setAllCommentsCheckState=_e},AGN.Lib.CalendarService=new e;var i={showDiv:function(e){$("div#calendar-dialog-modal div#"+e).css("display","block")},hideDiv:function(e){$("div#calendar-dialog-modal div#"+e).css("display","none")},updateVisibility:function(){this.onScheduleChanged(),this.onDeadlineChanged()},onDeadlineChanged:function(){return $("#isDeadline:checked").val()?($("#remindDate").prop("disabled",!1),$("#remindTime").prop("disabled",!1),$(".js-open-datepicker").prop("disabled",!1),$(".js-open-timepicker").prop("disabled",!1)):($("#remindDate").prop("disabled",!0),$("#remindTime").prop("disabled",!0),$(".js-open-datepicker").prop("disabled",!0),$(".js-open-timepicker").prop("disabled",!0)),!1},onUserTypeChanged:function(e){e==this.reminder.recipientEmm?($("#emmUsers").show(),$("#customRecipients").hide()):($("#customRecipients").show(),$("#emmUsers").hide())},onScheduleChanged:function(){return $("#scheduleReminder:checked").val()?($("#admin-for-notify").prop("disabled",!1),this.showDiv("reminderDetails")):($("#admin-for-notify").prop("disabled",!0),this.hideDiv("reminderDetails")),!1},reminder:{isDeadline:!1,isSendNow:!1,isEmmUserType:!0,recipientEmm:1,recipientCustom:2,defaultDate:{date:"",hours:8,minutes:0},plannedSendDate:{date:"",hours:8,minutes:0},getDateAsString:function(){return $.datepicker.formatDate("dd-mm-yy",this.defaultDate.date)},setDate:function(e){this.defaultDate.date=$.datepicker.parseDate("dd-mm-yy",e),this.plannedSendDate.date=$.datepicker.parseDate("dd-mm-yy",e),this.plannedSendDate.hours=this.defaultDate.hours,this.plannedSendDate.minutes=this.defaultDate.minutes},getPlannedSendDateAsString:function(){return $.datepicker.formatDate("dd-mm-yy",this.plannedSendDate.date)+(this.plannedSendDate.hours<10?" 0":" ")+this.plannedSendDate.hours.toString()+(this.plannedSendDate.minutes<10?":0":":")+this.plannedSendDate.minutes.toString()},setPlannedSendDate:function(e){var t=e.split(" ");this.plannedSendDate.date=$.datepicker.parseDate("dd-mm-yy",t[0]);var i=t[1].split(":");this.plannedSendDate.hours=parseInt(i[0]),this.plannedSendDate.minutes=parseInt(i[1])},getScheduleReminder:function(){return this.isDeadline||this.isSendNow},getRemindCalendarDate:function(){return this.defaultDate.date.toString()==this.plannedSendDate.date.toString()&&this.defaultDate.hours==this.plannedSendDate.hours&&this.defaultDate.minutes==this.plannedSendDate.minutes},onSave:function(){i.saveReminder(i.reminder)}},getNewReminder:function(e,i){return this.reminder.id=0,this.reminder.setDate(e),this.reminder.text="",this.reminder.isEmmUserType=!0,this.reminder.notifyAdminId=i.adminId,this.reminder.recipients="",this.reminder.currentAdminName=i.adminName,this.reminder.isDeadline=!1,this.reminder.isNotified=!1,this.reminder.title=t("calendar.common.new_comment"),this.reminder.recipientEmm=i.recipientEmm,this.reminder.recipientCustom=i.recipientCustom,this.reminder},getReminder:function(e,i){var n=$("#"+e+" .comment-text-content").html()+"";return this.reminder.id=this.getReminderIdFromTag(e),this.reminder.setDate(this.getDateFromTag($("#"+e).parent().attr("id"))),this.reminder.text=n.replace(/<br>/gi,"\n"),this.reminder.isEmmUserType="true"==$("#emm-user-type-"+e).val(),this.reminder.notifyAdminId=$("#notify-admin-id-"+e).val(),this.reminder.recipients=$("#recipients-"+e).val(),this.reminder.currentAdminName=i,this.reminder.isDeadline="true"==$("#deadline-"+e).val(),this.reminder.isNotified="true"==$("#notified-"+e).val(),this.reminder.setPlannedSendDate($("#plannedSendDate-"+e).val()),this.reminder.title=t("calendar.common.edit_comment"),this.reminder},fillCommentDialog:function(e){var t=$("#calendar-dialog-modal");t.find(".modal-title").html(e.title),t.find("#comment-text").val(e.text),t.find('#reminderDetails input[name="userType"][value='+(e.isEmmUserType?e.recipientEmm:e.recipientCustom)+"]").prop("checked",!0).trigger("change"),t.find("#admin-for-notify").val(e.notifyAdminId),AGN.Lib.Select.get(t.find("#admin-for-notify")).selectValueOrSelectFirst(e.notifyAdminId),t.find("#recipients-text").val(e.recipients),t.find("#isDeadline").prop("checked",e.isDeadline),t.find("#isSendNow").prop("checked",e.isSendNow),t.find("#scheduleReminder").prop("checked",e.getScheduleReminder()),t.find("#remindDate").pickadate("picker").set("select",e.plannedSendDate.date),t.find("#remindTime").val(e.plannedSendDate.hours+":"+e.plannedSendDate.minutes)},saveReminder:function(e){var t=$("#comment-text").val();if(AGN.Lib.CalendarService.validateComment(t)){var i=$("#isEmmUserType").prop("checked"),n=AGN.Lib.CalendarService.parseRecipients($("#recipients-text").val());if(i||AGN.Lib.CalendarService.validateEmails(n)){if($("#calendar-dialog-modal").modal("hide"),e.text=t,(e.isEmmUserType=i)?(e.notifyAdminId=$("#admin-for-notify").val(),e.recipients=""):(e.notifyAdminId=0,e.recipients=n.join(",")),e.isSendNow=$("#isSendNow").prop("checked"),e.isDeadline=$("#isDeadline").prop("checked"),$("#isDeadline").prop("checked")&&$("#scheduleReminder").prop("checked")){var o=$("#remindDate").pickadate("picker"),r=$("#remindTime");e.plannedSendDate.date=AGN.Lib.DateFormat.parseFormat(o.get("select","dd-mm-yyyy"),"dd-MM-yyyy"),e.plannedSendDate.hours=r.val().substring(0,2),e.plannedSendDate.minutes=r.val().substring(3,5)}else e.plannedSendDate.date=e.defaultDate.date,e.plannedSendDate.hours=e.defaultDate.hours,e.plannedSendDate.minutes=e.defaultDate.minutes;AGN.Lib.CalendarService.saveCommentDB(e)}}},getDateFromTag:function(e){return e.substr(e.indexOf("-")+1)},getReminderIdFromTag:function(e){return e.substr(e.indexOf("-")+1)}};AGN.Lib.ReminderService=i}(),AGN.Initializers.Colorpicker=function(e){_.each($(".js-colorpicker"),function(e){$(e).colorpicker({format:"hex",container:!0})})},function(){var v={URL:void 0,reactorChartData:{bindto:"#reactor-type-chart",data:{columns:[],type:"donut",order:null},color:{pattern:["#008F00","#92D050","#CCCDCD","#F43536"]},legend:{position:"right"}},rebuyChartData:{bindto:"#rebuy-rate-chart",data:{columns:[],type:"gauge"},color:{pattern:["#0071B9"]}},revenueChartData:{bindto:"#revenue-chart",data:{columns:[],type:"bar",labels:{show:!0,format:function(e,t,i,n){return e}},color:function(e,t){return e}},tooltip:{show:!1},axis:{rotated:!0,x:{show:!1},y:{show:!1,min:0,max:150}},legend:{show:!1},bar:{width:{ratio:.7}}},progressChartData:{bindto:"#progress-of-used-devices-chart",onrendered:function(){d3.selectAll("#progress-of-used-devices-chart").selectAll(".c3-axis.c3-axis-x").selectAll(".tick text").style("text-anchor","start")},data:{columns:[],groups:[["windows","mac","android","ios","other"]],types:{reactions:"spline"},axes:{reactions:"y2"},names:{},type:"bar",x:"date",xFormat:"%m/%d/%Y",order:null},axis:{x:{type:"timeseries",tick:{culling:!0,format:"%m/%d/%Y"}},y:{padding:{top:10},tick:{format:function(e){return e+" %"}}},y2:{show:!0,min:0}},bar:{width:{ratio:.5}},tooltip:{format:{value:function(e,t,i){return"reactions"===i?e:e+" %"}}},color:{pattern:["#0071B9","#4C9BCE","#99C6E3","#CCE3F1","#CCCDCD","#555555"]}},devicesChartData:{bindto:"#devices-reacted-on-chart",data:{columns:[],type:"donut",order:null,names:{}},legend:{position:"right"},color:{pattern:["#0071B9","#4C9BCE","#99C6E3","#CCE3F1","#CCCDCD"]}}},n={reactorChartData:{size:{width:400,height:350}},rebuyChartData:{size:{width:400,height:250}},revenueChartData:{size:{width:350,height:275}},progressChartData:{size:{width:860,height:350}},devicesChartData:{size:{width:400,height:350}}},o={reactorChartData:{size:{width:350,height:250}},rebuyChartData:{size:{width:250,height:200}},revenueChartData:{size:{width:300,height:250}},progressChartData:{size:{width:550,height:250}},devicesChartData:{size:{width:350,height:250}}},r=[],e=null,t=!1;function i(){var e={method:"getProgressOfUsedDevices"},t=$("input[name=progressOfUsedPeriod]:checked").val();"month"==t?e.byMonth=!0:"dates"==t&&(e.from=$("#progressOfUsedFrom").val(),e.till=$("#progressOfUsedTill").val()),$.ajax({type:"GET",url:AGN.Lib.RecipientStatsData.URL,data:e,success:function(e){!function(e){if(void 0===e||void 0===e.usedDevicesByPeriods||void 0===e.usedDevices)return;var t={windows:e.windowsTitle,mac:e.macTitle,android:e.androidTitle,ios:e.iosTitle,other:e.otherTitle,reactions:e.numberOfReactions},i=e.usedDevices,n=[],o=[];o.push({name:"windows",count:i.windows}),o.push({name:"mac",count:i.mac}),o.push({name:"android",count:i.android}),o.push({name:"ios",count:i.ios}),o.sort(function(e,t){return t.count-e.count});for(var r=0;r<o.length;r++)n.push([t[o[r].name],o[r].count]);n.push([e.otherTitle,i.other]),v.devicesChartData.data.columns=n,v.devicesChartData.data.names=t,y("devicesChart");for(var a=[],s=[],l=0;l<o.length;l++)s[o[l].name]=l,a.push([o[l].name]);a.push(["other"],["reactions"],["date"]);for(var c=0;c<e.usedDevicesByPeriods.length;c++){var u=e.usedDevicesByPeriods[c],d=u.windows,h=u.mac,p=u.android,f=u.ios,g=u.other,m=d+h+p+f+g;a[s.windows].push(b(d/m)),a[s.mac].push(b(h/m)),a[s.android].push(b(p/m)),a[s.ios].push(b(f/m)),a[4].push(b(g/m)),a[5].push(m),a[6].push(u.date)}v.progressChartData.data.columns=a,v.progressChartData.data.names=t,v.progressChartData.data.xFormat=e.dateFormat,v.progressChartData.axis.x.min=e.min,v.progressChartData.axis.x.max=e.max,v.progressChartData.axis.x.tick.format=e.dateFormat,y("progressChart")}(e),AGN.Initializers.Equalizer()}})}function y(e){var t=v[e+"Data"];if(null!=t){var i=(g()?n:o)[e+"Data"];$.extend(!0,t,i),$("#"+e).removeClass("hidden"),c3.generate(t),-1==r.indexOf(e)&&r.push(e)}}function b(e){return Math.round(1e3*e)/10}function g(){return 1600<=$(window).width()}function a(e,n){var o=n.closest(".l-stat-content").find("hr"),r=0,a=function(e){var i=0;return $.each(e,function(e,t){i++}),i}(e);$.each(e,function(e,t){if(n.find(".l-stat-name").text(e),n.find(".l-stat-val").text(t),++r<a){var i=n.clone();i.insertAfter(o),n=i,r<a-1&&(o=o.clone()).insertAfter(n)}})}AGN.Lib.RecipientStatsData=v,AGN.Lib.DomInitializer.new("company-insights",function(){this.config&&this.config.url&&(AGN.Lib.RecipientStatsData.URL=this.config.url,$.ajax({type:"GET",url:AGN.Lib.RecipientStatsData.URL,data:{method:"ajaxStatistic"},success:function(e){e&&(function(e,t){if(void 0!==e){var i=[],n=!1;for(var o in e)e.hasOwnProperty(o)&&(i.push([o,e[o]]),0<e[o]&&(n=!0));n?4==i.length?v.reactorChartData.color.pattern=["#008F00","#92D050","#CCCDCD","#F43536"]:v.reactorChartData.color.pattern=["#92D050","#CCCDCD","#F43536"]:(i=[[t,100]],v.reactorChartData.color.pattern=["#CCCDCD"]),v.reactorChartData.data.columns=i,y("reactorChart")}}(e.reactorType,e.notAvailable),function(e,t,i){void 0!==t&&(0<t?v.rebuyChartData.data.columns=[[e,b(t)]]:(v.rebuyChartData.gauge={},v.rebuyChartData.gauge.label={},v.rebuyChartData.gauge.label.format=function(e,t){return i},v.rebuyChartData.gauge.label.show=!1,v.rebuyChartData.data.columns=[[i,0]]),y("rebuyChart"))}(e.rebuyTitle,e.rebuyRate,e.notAvailable),function(e,o){if(void 0!==e){var i=["#0071B9","#4C9BCE","#99C6E3","#CCCDCD"],r=[],t=[""],n=[],a=[],s=0,l=0,c=!1;for(var u in e)if(e.hasOwnProperty(u)){var d=e[u];r.push(u),0<d?(c=!0,n.push(d),s+=d):n.push(0)}if(c){for(var h=g()?70:60,p=!1,f=0;f<n.length;f++)a[f]=Math.round(n[f]/s*100),l+=a[f],70<=a[f]&&(p=!0);for(100!=l&&(a[a.length-1]+=100-l),f=0;f<a.length;f++)t.push(25+(p?a[f]*h/100:a[f]));v.revenueChartData.data.labels.format=function(e,t,i,n){return a[i]+"% "+r[i]}}else{for(f=0;f<r.length;f++)t.push(50),a[f]=25;v.revenueChartData.data.labels.format=function(e,t,i,n){return o}}v.revenueChartData.data.columns=[t],v.revenueChartData.data.color=function(e,t){return null!=t.value?i[t.index]:e},y("revenueChart")}}(e.revenue,e.notAvailable),function(e){(function(e){var t=$("#favOpeningDays").find(".stat-fav-day");a(e,t)})(e.favoriteOpeningDays),function(e){var t=$("#favOpeningHours").find(".stat-fav-time");a(e,t)}(e.favoriteOpeningHours),function(e){$("#ctr-val").text(e.toString().replace(".",","))}(e.ctr),function(e){0!=e?$("#conversion-val").text(e.toString().replace(".",",")):($("#conversion-val").text("---"),$("#conversion-val").parent().find(".l-stat-sign").text(""))}(e.conversion),function(e){0!=e?$("#pi-val").text(e.toString().replace(",",".")):($("#pi-val").text("---"),$("#pi-val").parent().find(".l-stat-sign").text(""))}(e.pageImpressions),function(e){0!=e?$("#pi-visit-val").text(e.toString().replace(",",".")):($("#pi-visit-val").text("---"),$("#pi-visit-val").parent().find(".l-stat-sign").text(""))}(e.pageImpressionsPerVisit),function(e){0!=e?$("#pi-buy-val").text(e.toString().replace(",",".")):($("#pi-buy-val").text("---"),$("#pi-buy-val").parent().find(".l-stat-sign").text(""))}(e.pageImpressionsPerBuy)}(e),AGN.Initializers.Equalizer())}}),i(),$("input[type=radio][name=progressOfUsedPeriod]").change(function(){"dates"==this.value?$("#progressOfUsedDates").removeClass("hidden"):$("#progressOfUsedDates").addClass("hidden")}),$("#refreshProgressOfUsedDevices").click(function(){i()}),t=g(),$(window).resize(function(){null!=e&&clearTimeout(e),e=setTimeout(function(){var e=g();t!=e&&(t=e,r.forEach(function(e){y(e)}))},200)}))})}(),function(){var l;l={data:{chartsColors:["#0071b9","#009999","#92d050","#41641a","#ffc000"],statChartData:{columnTitles:[],c3data:{bindto:".js-stat-chart",data:{columns:[],type:"bar",labels:!0},axis:{x:{tick:{centered:!0,fit:!0,format:function(e){return l.data.statChartData.columnTitles[e]}}}},legend:{show:!1},tooltip:{format:{title:function(){return null},name:function(e,t,i,n){return l.data.statChartData.columnTitles[n]},value:function(e,t,i,n){return e}}},padding:{right:25}},build:function(e,t){this.columnTitles=e;var i=t.slice(0);return i.unshift("values"),this.c3data.data.columns=[i],this.c3data}},clickChartData:{c3data:{bindto:".js-click-chart",data:{rows:[],type:"donut"},size:{height:150},donut:{title:"",label:{show:!1},width:15},legend:{position:"right"},tooltip:{show:!1}},build:function(e,t,i){this.c3data.donut.title=e,this.c3data.data.rows=[t,i];for(var n={},o=0;o<t.length;o++)n[t[o]]=l.data.chartsColors[o];return this.c3data.data.colors=n,this.c3data}},viewChartData:{c3data:{bindto:".js-view-chart",data:{rows:[],type:"donut"},size:{height:150},donut:{title:"",label:{show:!1},width:15},legend:{position:"right"},tooltip:{show:!1}},build:function(e,t,i){this.c3data.donut.title=e,this.c3data.data.rows=[t,i];for(var n={},o=0;o<t.length;o++)n[t[o]]=l.data.chartsColors[o];return this.c3data.data.colors=n,this.c3data}}},updateCharts:function(e){jQuery.ajax({type:"POST",url:AGN.url("/dashboard/statistics.action"),data:{mailingId:e},success:function(e){var t,i,n;e=_.merge({common:[["no Data","0"]],clickers:[["no Data","0"]],clickersPercent:[0],openers:[["no Data","0"]],openersPercent:[0]},e),t=[],i=[];for(var o=0;o<e.common.length;o++){var r=parseInt(e.common[o][1]);t.push(e.common[o][0]),i.push(r)}c3.generate(l.data.statChartData.build(t,i)),t=[],i=[];for(o=n=0;o<e.clickers.length;o++){r=l.roundTo(100*e.clickers[o][1],1);t.push(e.clickers[o][0]),i.push(r),n+=r}if(!isNaN(n)&&0<n)for(o=0;o<i.length;o++)t[o]+=" "+l.roundTo(100*i[o]/n,1)+"%";var a=l.roundTo(100*e.clickersPercent[0],1)+"%*";c3.generate(l.data.clickChartData.build(a,t,i)),t=[],i=[];for(o=n=0;o<e.openers.length;o++){r=l.roundTo(100*e.openers[o][1],1);t.push(e.openers[o][0]),i.push(r),n+=r}if(!isNaN(n)&&0<n)for(o=0;o<i.length;o++)t[o]+=" "+l.roundTo(100*i[o]/n,1)+"%";var s=l.roundTo(100*e.openersPercent[0],1)+"%*";c3.generate(l.data.viewChartData.build(s,t,i)),AGN.Initializers.Equalizer()}})},roundTo:function(e,t){return 1*parseFloat(e).toFixed(t)}},AGN.Lib.DashboardStatisticsService=l}(),function(){var a=AGN.Lib.Helpers;AGN.Initializers.PickADate=function(e){e=e||$(document),_.each(e.find(".js-datepicker"),function(e){var t,i,n=$(e),o={editable:!0,max:new Date(9999,11,31),maxFor:void 0,minFor:void 0,klass:{holder:"datepicker__holder picker__holder"+(n.hasClass("js-datepicker-right")?" datepicker__holder-right":"")}};i=_.merge({},o,a.objFromString(n.data("datepicker-options"))),$(e).pickadate(i),(t=n.pickadate("picker")).on("open",function(){this.$node.parents(".input-group").find(".js-open-datepicker").addClass("is-active")}),t.on("close",function(){this.$node.parents(".input-group").find(".js-open-datepicker").removeClass("is-active")}),i.maxFor&&n.on("change",function(){var e=$(this).val()||i.min;e&&$(i.maxFor).pickadate("picker").set("max",e)}),i.minFor&&n.on("change",function(){var e=$(this).val()||i.max;e&&$(i.minFor).pickadate("picker").set("min",e)});var r=!0;n.on("change",function(){if(r){var e=$(this),t=e.pickadate("picker");try{r=!1,e.val()?t.set("select",e.val()):t.set("clear")}finally{r=!0}}})}),_.each(e.find(".js-timepicker"),function(e){var t,i,n=$(e),o={mask:"h:halfs",oncomplete:function(){n.trigger("timepicker:complete")},onincomplete:function(){n.trigger("timepicker:incomplete")}};i=(t=_.merge({},o,a.objFromString(n.data("timepicker-options")))).mask,delete t.mask,n.inputmask(i,t),n.attr("placeholder",n.data("_inputmask").opts.placeholder)})}}(),AGN.Initializers.Delegate=function(e){(e=e||$(document)).all("[data-delegate]").each(function(){var e=$(this),i=e.data("delegate"),t=e.data("delegate-events")||"click";e.on(t,function(e){var t=$(i);0<t.length&&t.trigger($.Event(e))})})},function(){var o=AGN.Lib.Helpers;AGN.Initializers.DisplayDimensions=function(e){_.each($("[data-display-dimensions]"),function(i){var e=$(i),t=o.objFromString(e.data("display-dimensions")).scope,n=e.parents(t).find("[data-dimensions]");e.ensureLoad(function(){var e=i.naturalWidth,t=i.naturalHeight;n.html(e+" x "+t+" px")})})}}(),AGN.Initializers.Dragster=function(e){$(".dropzone").each(function(){new Dragster(this)})},AGN.Initializers.DropdownExpand=function(e){_.each($("[data-dropdown-expand]"),function(e){var n,t,o=$(e),r=o.find(".dropdown-menu"),i=o.data("dropdown-expand"),a=$(i);o.removeClass("hidden"),r.html(""),n=a.parent().width(),t=a.children().filter(o).outerWidth(!0)+15,_.each(a.siblings(),function(e){var t=$(e);n-=t.outerWidth(!0)}),o.addClass("hidden"),_.reduce(a.children().not(o),function(e,t){var i=$(t);return i.removeClass("hidden"),e+=i.outerWidth(!0),n<=e&&(o.removeClass("hidden"),r.append(i.clone()),i.addClass("hidden")),e},t)})},AGN.Initializers.Dropzone=function(){Dropzone.autoDiscover=!1},AGN.Initializers.Emoji=function(e){(e=e||$(document)).all("[data-emoji]").each(function(){$(this).emojioneArea({placeholder:null})})},function(){var t=AGN.Lib.Equalizer;AGN.Initializers.Equalizer=function(e){window.setTimeout(function(){_.each($("[data-equalizer]"),function(e){t($(e))})},1)}}(),function(){var n=AGN.Lib.Form;AGN.Initializers.Form=function(e){(e=e||$(document)).find("form input[type=text], form input[type=password]").bind("keyup keypress",function(e){if(13===(e.keyCode||e.which))return e.preventDefault(),!1});var t=e.all("form[data-form-focus]").first();if(t.exists()){var i=t.find('[name="'+t.data("form-focus")+'"]');!i.exists()||i.is(":disabled")||i.is(":hidden")||i.trigger("focus")}_.each(e.find("form"),function(e){n.get($(e))})}}(),AGN.Initializers.IconsDefs=function(e){e=e||$(document),_.each(e.find("[data-icon]"),function(e){$icon=$(e);var t=AGN.url("assets/icons-defs.svg#"+$icon.data("icon"),!0);$icon.html('<svg viewBox="0 0 45 45"><use xlink:href="'+t+'"/></svg>')}),svg4everybody()},AGN.Initializers.Iframe=function(e){(e=e||$(document)).find("iframe:not(.js-fixed-iframe)").each(function(){var r=this,a=$(this);if(a.hasClass("js-simple-iframe")){var e,s,t=a.parent(),i=t.parent(),l=parseInt(a.data("max-width")),c=parseInt(a.data("height-extra"))||10,u=a.data("media-query"),d=!!window.sidebar;e=function(){var e,t,i=r.contentDocument?r.contentDocument:r.contentWindow.document,n=i.body,o=i.documentElement;t=u?l:Math.max(n.scrollWidth,n.offsetWidth,o.clientWidth,o.scrollWidth,o.offsetWidth),e=Math.max(n.scrollHeight,n.offsetHeight,o.clientHeight,o.scrollHeight,o.offsetHeight),e+=c,a.height(e),a.width(t),u&&d&&a.contents().find("body").css("overflow","hidden"),s(),$(window).off("viewportChanged",s),$(window).on("viewportChanged",s)},s=function(){i.width("auto"),a.width()>l&&l>i.width()?t.width(a.width()):t.width(Math.min(l,i.width())),u||(t.doubleScroll(),t.parent().doubleScroll(),$(".doubleScroll-scroll-wrapper").css("margin","0 auto"))},a.off("load"),a.on("load",e)}else a.on("load",function(){window.setTimeout(function(){a.iFrameResize({heightCalculationMethod:"grow",enablePublicMethods:!0})},50)})})},AGN.Initializers.ImageEditor=function(e){e=e||$(document),_.each(e.find("#editor-canvas"),function(e){var o=e.getContext("2d"),r=new Image;r.src=$("#editor-img").attr("src"),$("#editor-result").val(""),r.onload=function(){var e=r.width,t=r.height;o.canvas.width=e,o.canvas.height=t,o.drawImage(r,0,0,e,t),$("#l-editor-img-width").attr("value",e),$("#l-editor-img-height").attr("value",t),$("#l-editor-img-percent").attr("value",100);var i=e+$("#l-img-editor-tools").width()+10;$("#l-img-editor").css("min-width",i);var n=o.canvas.toDataURL();$("#editor-result").attr("value",n)}})},function(){var o=AGN.Lib.Helpers;AGN.Initializers.InputMask=function(e){e=e||$(document),_.each(e.find(".js-inputmask"),function(e){var t,i,n=$(e);i=(t=_.merge({},o.objFromString(n.data("inputmask-options")))).mask,delete t.mask,n.inputmask(i,t)})}}(),$.fn.queryBuilder.defaults({templates:{group:'<dl id="{{= it.group_id }}" class="rules-group-container">   <dt class="rules-group-header">     <div class="btn-group pull-right group-actions">       <button type="button" class="btn btn-xs btn-primary" data-add="rule">         <i class="{{= it.icons.add_rule }}"></i> {{= it.translate("add_rule") }}       </button>       {{? it.settings.allow_groups===-1 || it.settings.allow_groups>=it.level }}         <button type="button" class="btn btn-xs btn-primary" data-add="group">           <i class="{{= it.icons.add_group }}"></i> {{= it.translate("add_group") }}         </button>       {{?}}       {{? it.level>1 }}         <button type="button" class="btn btn-xs btn-alert" data-delete="group">           <i class="{{= it.icons.remove_group }}"></i> {{= it.translate("delete_group") }}         </button>       {{?}}     </div>     <div class="btn-group group-conditions">       {{~ it.conditions: condition }}         <label class="btn btn-xs btn-primary">           <input type="radio" name="{{= it.group_id }}_cond" value="{{= condition }}"> {{= it.translate("conditions", condition) }}         </label>       {{~}}     </div>     {{? it.settings.display_errors }}       <div class="error-container"><i class="{{= it.icons.error }}"></i></div>     {{?}}   </dt>   <dd class=rules-group-body>     <ul class=rules-list></ul>   </dd> </dl>'}}),$.fn.queryBuilder.defaults({templates:{rule:'<li id="{{= it.rule_id }}" class="rule-container">   <div class="rule-header clearfix">     <div class="btn-group pull-right rule-actions">       <button type="button" class="btn btn-regular btn-alert" data-delete="rule">         <i class="{{= it.icons.remove_rule }}"></i>       </button>     </div>   </div>   {{? it.settings.display_errors }}     <div class="error-container"><i class="{{= it.icons.error }}"></i></div>   {{?}}   <div class="rule-filter-container"></div>   <div class="rule-operator-container"></div>   <div class="rule-value-container"></div> </li>'}}),$.fn.queryBuilder.defaults({templates:{filterSelect:'{{ var optgroup = null; }} <select class="form-control js-select" name="{{= it.rule.id }}_filter">   {{? it.settings.display_empty_filter }}     <option value="-1">{{= it.settings.select_placeholder }}</option>   {{?}}   {{~ it.filters: filter }}     {{? optgroup !== filter.optgroup }}       {{? optgroup !== null }}</optgroup>{{?}}       {{? (optgroup = filter.optgroup) !== null }}         <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">       {{?}}     {{?}}     <option value="{{= filter.id }}">{{= it.translate(filter.label) }}</option>   {{~}}   {{? optgroup !== null }}</optgroup>{{?}} </select>'}}),$.fn.queryBuilder.defaults({templates:{ruleValueSelect:'{{ var optgroup = null; }} <select class="form-control js-select" name="{{= it.name }}" {{? it.rule.filter.multiple }}multiple{{?}}>   {{? it.rule.filter.placeholder }}     <option value="{{= it.rule.filter.placeholder_value }}" disabled selected>{{= it.rule.filter.placeholder }}</option>   {{?}}   {{~ it.rule.filter.values: entry }}     {{? optgroup !== entry.optgroup }}       {{? optgroup !== null }}</optgroup>{{?}}       {{? (optgroup = entry.optgroup) !== null }}         <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">       {{?}}     {{?}}     <option value="{{= entry.value }}">{{= entry.label }}</option>   {{~}}   {{? optgroup !== null }}</optgroup>{{?}} </select>'}}),$.fn.queryBuilder.defaults({icons:{add_group:"icon icon-plus-circle",add_rule:"icon icon-plus",remove_group:"icon icon-times",remove_rule:"icon icon-trash",error:"icon icon-exclamation-triangle"}}),function(){var t=AGN.Lib.Load;AGN.Initializers.Load=function(e){e=e||$(document),_.each(e.find("[data-load]"),function(e){window.setTimeout(function(){t.load($(e))},100)})}}(),AGN.Lib.DomInitializer.new("logon-complete",function(e){var t=AGN.Lib.Form.get(e),n={};this.config&&$.each(this.config,function(e,t){try{var i=AGN.Lib.Storage.get("web-storage#"+t);null!=i&&(n[t]=i)}catch(e){console.error(e)}}),t.setValue("webStorageJson",JSON.stringify(n)),t.submit()}),function(){function o(){localStorage.setItem("closedDate",new Date)}AGN.Lib.DomInitializer.new("logon-notification",function(e){var i=t("defaults.info"),n=t("logon.info.multiple_tabs");!function(e){var t=new Date,i=new Date(localStorage.getItem("closedDate"));return i.setDate(i.getDate()+parseInt(e)),0<t-i}(30)||AGN.Lib.Messages(i,n,"info",o,!1)})}(),AGN.Lib.DomInitializer.new("mailing-content-overview",function(e,t){if(!t){var i=AGN.Lib.Storage.get("mailings-content-dynNameID");if(i){var n=$("tr[data-dyn-name-id='"+i.dynNameID+"']");if(n.exists()){var o=n.position().top;setTimeout(function(){$("body").scrollTop(o)},1),AGN.Lib.Storage.set("mailings-content-dynNameID",{dynNameID:0})}}}var r=$("#myDatePicker");if(r.exists()){r.pickadate("picker").on({set:function(e){if("select"in e){var t=new Date(e.select);$("#startDay").val(t.getDate()),$("#startMonth").val(t.getMonth()+1),$("#startYear").val(t.getFullYear())}else $("#startDay").val(0),$("#startMonth").val(0),$("#startYear").val(0)}});var a=$("#myTimePicker");a.on("timepicker:complete",function(){var e=a.val();$("#startHour").val(e.substr(0,2)),$("#startMinute").val(e.substring(3,5))}),a.on("timepicker:incomplete",function(){$("#startHour").val(0),$("#startMinute").val(0)})}}),AGN.Lib.DomInitializer.new("mailing-content-view",function(e){AGN.Lib.Storage.set("mailings-content-dynNameID",{dynNameID:e.data("dyn-name-id")})}),AGN.Lib.Controller.new("mailing-followup-options",function(){var t="",i="",n=[],o="";this.addDomInitializer("mailing-followup-options",function(){var e=this.config;t=e.followUpContainer,i=e.mailingIdContainer,n=e.additionalOptions,o=e.advertisingUrl,changeFollowUpOptionsSet()}),getAdditionalAdvertisingOptions=function(){return AGN.Lib.Template.text("followupAdvertisingOptions",{items:n})},changeFollowUpOptionsSet=function(){var e=AGN.Lib.Select.get($(i)).getSelectedValue();jQuery.ajax({action:"POST",url:o,data:{mailingId:e},success:function(e){$(jQuery.find(t+" .advertisingOption")).remove(),e.isAdvertisingContentType&&$(jQuery.find(t)).append(getAdditionalAdvertisingOptions())}})},AGN.Lib.Action.new({change:i},function(){changeFollowUpOptionsSet()})}),AGN.Lib.DomInitializer.new("mailing-overview-table",function(e){e.removeClass("hidden")}),function(){function l(e,i,n,o,r,a){var s=o,l=e;function c(e,t){var i=e||"",n=t.select2("container").find(".select2-chosen");t.select2("val",i),n.text(i)}l.select2({openOnEnter:!0,minimumInputLength:1,initSelection:function(e,t){},id:function(e){return r?e.mailingID:s},formatResult:function(e){return'<div style="box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);"><div class="row"><div class="col-sm-6">'+t("fields.mailing.parameter")+'</div><div class="col-sm-6">'+e.name+'</div></div><div class="row"><div class="col-sm-6">'+t("fields.mailing.description")+'</div><div class="col-sm-6">'+e.description+'</div></div><div class="row"><div class="col-sm-6">'+t("fields.mailing.for_mailing")+'</div><div class="col-sm-6">'+e.mailingID+'</div></div><div class="row"><div class="col-sm-6">'+t("fields.mailing.change_date")+'</div><div class="col-sm-6  ">'+new Date(e.changeDate).toLocaleDateString()+"</div></div></div>"},formatSelection:function(e){if(r)return e.mailingID;AGN.Lib.Page.reload(a.replace("{mailing-info-id}",e.mailingInfoID),!0)},ajax:{url:i,data:function(e){var t={};return c(s=e,l),t[n]=e,t},results:function(e){var t=0;return e.forEach(function(e){e.id=t++}),{results:e}},cache:!0}}),l.on("select2-open",function(){!function(e,t){var i=e||"";t.select2("search",i)}(s,l)}),c(o,l)}AGN.Lib.DomInitializer.new("mailing-parameter-list-search-initializer",function(e){var t=AGN.Lib.Helpers.objFromString(e.data("config")),i=t.searchLink,n=t.viewLink,o=t.mailingSearchQuery,r=t.parameterSearchQuery,a=$("#parameter_search_field"),s=$("#mailing_search_field");new l(a,i,"parameterSearchQuery",r,!1,n),new l(s,i,"mailingSearchQuery",o,!0)})}(),AGN.Lib.DomInitializer.new("mediapool-image-pick",function(i){var e=i.find("#mediapool-image-pick-options"),n=i.find("#mediapool-browser-results"),o=i.find(".modal-body"),r=i.find("#mpFilterKeywords"),a=i.find("#mpFilterCategory"),s=i.find("#mpSortCriteria"),l=i.find("#mpIsAscendingSortOrder"),c=AGN.Lib.Template.prepare("mediapool-browser-results-template");function u(e){var t=e.data("image-id");return 0<t?d.images.find(function(e){return e.id===t})||{id:t}:null}var d=e.json(),h=null;d.images&&n.html(c({results:d.images,fullListSize:d.fullListSize})),this.addAction({click:"mpSearchImages",enterdown:"mpFilterKeywords"},function(){o.addClass("ui-modal-loading"),$.ajax({type:"POST",url:d.urls.MEDIAPOOL_VIEW,data:{categoryId:a.val(),keywords:r.val(),sortCriteria:s.val(),isAscendingSortOrder:l.val()}}).done(function(e){var t=e.fullListSize,i=e.partialList;n.html(c({results:i,fullListSize:t})),d.images=i,h=null}).fail(function(){n.html(c({results:[],fullListSize:0})),d.images=[],h=null}).always(function(){o.removeClass("ui-modal-loading")})}),this.addAction({dblclick:"mpSelectImage"},function(){var e=u(this.el);e&&AGN.Lib.Confirm.get(i).positive(e)}),this.addAction({click:"mpSelectImage"},function(){h&&h.removeClass("active"),(h=this.el).addClass("active")}),this.addAction({click:"mpAcceptImage"},function(){if(h){var e=u(h);e&&AGN.Lib.Confirm.get(i).positive(e)}else AGN.Lib.Messages(t("Error"),t("messages.error.nothing_selected"),"alert")})}),AGN.Initializers.Menu=function(e){e=e||$(document),AGN.Lib.Menu.init()},function(){var o={data:{chartsColors:["#26b98a"],statChartData:{columnTitles:[],c3data:{bindto:"#barchart-message-stats",data:{columns:[],type:"bar",labels:!0},axis:{x:{tick:{centered:!0,fit:!0,format:function(e){return o.data.statChartData.columnTitles[e]}}},y:{show:!1}},legend:{show:!1},tooltip:{format:{title:function(){return null},name:function(e,t,i,n){return o.data.statChartData.columnTitles[n]},value:function(e,t,i,n){return e}}},padding:{right:25,left:25}},build:function(e){return this.columnTitles.push(e.shift()),e.unshift("values"),this.c3data.data.columns=[e],this.c3data}}},updateChart:function(e){$.ajax({type:"GET",url:e,success:function(e){c3.generate(o.data.statChartData.build(e)),AGN.Initializers.Equalizer()}})}};AGN.Lib.MessageStatisticsService=o,AGN.Lib.DomInitializer.new("message-stat",function(e){var t=AGN.Lib.Helpers.objFromString(e.data("config"));t&&t.url&&o.updateChart(t.url)})}(),function(){function n(e,t){var i=e,n=t;i.get("value")&&n.set("min",i.get("select")),n.get("value")&&i.set("max",n.get("select")),i.on("set",function(e){e.select?n.set("min",i.get("select")):"clear"in e&&n.set("min",!1)}),n.on("set",function(e){e.select?i.set("max",n.get("select")):"clear"in e&&i.set("max",!1)})}AGN.Lib.DomInitializer.new("news-editor-period",function(e){!function(e){e=e||$(document);var i=[];_.each(e.find(".js-datepicker"),function(e){var t=$(e);t.hasClass("js-datepicker-period-start")&&(t.attr("datepicker-period-id")in i||(i[t.attr("datepicker-period-id")]={startEl:null,endEl:null}),i[t.attr("datepicker-period-id")].startEl=t),t.hasClass("js-datepicker-period-end")&&(t.attr("datepicker-period-id")in i||(i[t.attr("datepicker-period-id")]={startEl:null,endEl:null}),i[t.attr("datepicker-period-id")].endEl=t)});for(var t=0;t<i.length;t++)n(i[t].startEl.pickadate("picker"),i[t].endEl.pickadate("picker"))}(e)})}(),function(){var a={data:{chartsColors:["#0071b9","#009999","#92d050","#41641a","#ffc000"],browserChartData:{c3data:{bindto:"#notificationGlobalBrowserStat",data:{rows:[],type:"donut"},donut:{label:{show:!0}},legend:{position:"right"},tooltip:{show:!1}},build:function(e,t){this.c3data.data.rows=[e,t];for(var i={},n=0;n<e.length;n++)i[e[n]]=a.data.chartsColors[n];return this.c3data.data.colors=i,this.c3data}}},roundTo:function(e,t){return 1*parseFloat(e).toFixed(t)},updateChart:function(e){$.ajax({type:"POST",url:e,success:function(e){var t=[],i=[],n=0;for(key in e){var o=a.roundTo(100*e[key],1);t.push(key),i.push(o),n+=o}if(!isNaN(n)&&0<n)for(var r=0;r<i.length;r++)t[r]+=" "+a.roundTo(100*i[r]/n,1)+"%";c3.generate(a.data.browserChartData.build(t,i)),AGN.Initializers.Equalizer()}})}};AGN.Lib.GLobalNotificationBrowserStatService=a,AGN.Lib.DomInitializer.new("notification-global-browser-stat",function(e){var t=AGN.Lib.Helpers.objFromString(e.data("config"));t&&t.url&&AGN.Lib.GLobalNotificationBrowserStatService.updateChart(t.url)})}(),function(){var u={data:{chartColors:["#0071b9","#006600","#b30000"],globalProgressChartData:{columnTitles:[],c3data:{bindto:"#notificationGlobalProgressStat",data:{x:"x",columns:[]},axis:{x:{type:"category",tick:{centered:!0,fit:!1}}},padding:{right:25}},build:function(e,t,i,n){this.c3data.data.columns=[e,t,i,n];var o={};return o[t[0]]=u.data.chartColors[0],o[i[0]]=u.data.chartColors[1],o[n[0]]=u.data.chartColors[2],this.c3data.data.colors=o,this.c3data}}},updateChart:function(e){var n=["x"],o=[],r=[],a=[],t=$("#selectMode").val(),i=$("#selectMonth").val(),s=$("#selectYear").val(),l=$("#startDay").val(),c=$("#endDay").val();$.ajax({type:"POST",url:e,data:{dateMode:t,selectMonth:i,selectYear:s,startDay:l,endDay:c},success:function(e){for(objIndex in e){var t=e[objIndex];for(objKey in t){0==objIndex&&"time"!=objKey&&(0==o.length?o.push(objKey):0==r.length?r.push(objKey):0==a.length&&a.push(objKey));var i=t[objKey];"time"==objKey?n.push(i):objKey==o[0]?o.push(i):objKey==r[0]?r.push(i):objKey==a[0]&&a.push(i)}}c3.generate(u.data.globalProgressChartData.build(n,o,r,a)),AGN.Initializers.Equalizer()}})}};AGN.Lib.GLobalNotificationProgressStatService=u,AGN.Lib.DomInitializer.new("notification-global-progress-stat",function(e){var t=AGN.Lib.Helpers.objFromString(e.data("config"));t&&t.url&&AGN.Lib.GLobalNotificationProgressStatService.updateChart(t.url)})}(),function(){var o={data:{chartsColors:["#0071b9","#92D050","#41641A"],statusChartData:{columnTitles:[],c3data:{bindto:"#notificationGlobalStatusStat",data:{columns:[],type:"bar",labels:!0,color:function(e,t){return o.data.chartsColors[t.index]}},axis:{x:{tick:{centered:!0,fit:!0,format:function(e){return o.data.statusChartData.columnTitles[e]}}},y:{show:!1}},legend:{show:!1},tooltip:{format:{title:function(){return null},name:function(e,t,i,n){return o.data.statusChartData.columnTitles[n]},value:function(e,t,i,n){return e}}},padding:{right:25,left:25}},build:function(e,t){this.columnTitles=e;var i=t.slice(0);return i.unshift("values"),this.c3data.data.columns=[i],this.c3data}}},updateChart:function(e){$.ajax({type:"POST",url:e,success:function(e){var t=[],i=[];for(key in e)t.push(key),i.push(e[key]);c3.generate(o.data.statusChartData.build(t,i)),AGN.Initializers.Equalizer()}})}};AGN.Lib.GLobalNotificationStatusStatService=o,AGN.Lib.DomInitializer.new("notification-global-status-stat",function(e){var t=AGN.Lib.Helpers.objFromString(e.data("config"));t&&t.url&&AGN.Lib.GLobalNotificationStatusStatService.updateChart(t.url)})}(),AGN.Initializers.PushNotificationPreview=function(e){e=e||$(document),_.each(e.find(".push-notification-preview-button"),function(e){function i(e){e.prop("disabled",!0),e.parent().attr("data-tooltip",e.parent().attr("data-tooltip-if-disabled"))}var n=$(e),c=n.data("notification-form");"denied"==Notification.permission?i(n):n.click(function(){function t(){var e=$("#"+c),t=e.find("#pushTitle"),i=e.find("#pushContent"),n=e.find("#pushIcon"),o=e.find("#pushLink"),r=t?t.val():"",a=i?i.val():"",s=n?n.val():"",l=o?o.val():"";new Notification(r,{body:a,icon:s}).onclick=function(e){e.preventDefault(),window.open(l,"_blank")}}"granted"!=Notification.permission?Notification.requestPermission(function(e){"granted"==e?t():"denied"==e&&i(n)}):t()})})},function(){var a={data:{chartsColors:["#0071b9"],statChartData:{columnTitles:[],c3data:{bindto:"#barchart-notification-stats",data:{columns:[],type:"bar",labels:!0},axis:{x:{tick:{centered:!0,fit:!0,format:function(e){return a.data.statChartData.columnTitles[e]}}}},legend:{show:!1},tooltip:{format:{title:function(){return null},name:function(e,t,i,n){return a.data.statChartData.columnTitles[n]},value:function(e,t,i,n){return e}}},padding:{right:25}},build:function(e,t){this.columnTitles=e;var i=t.slice(0);return i.unshift("values"),this.c3data.data.columns=[i],this.c3data}},progressChartData:{c3data:{bindto:"#progresschart-notification-stats",data:{x:"x",columns:[]},axis:{x:{type:"category",tick:{fit:!1}}},zoom:{enabled:!0,rescale:!0},subchart:{show:!0},padding:{right:25}},build:function(e,t,i){return this.c3data.data.columns=[e,t,i],this.c3data}}},updateCharts:function(e,t){$.ajax({type:"POST",url:t,data:{pushID:e},success:function(e){!function(e){var t=[],i=[];for(var n in e)e.hasOwnProperty(n)&&(t.push(n),i.push(e[n]));c3.generate(a.data.statChartData.build(t,i))}(e.common),function(e){var t=["x"],i=[],n=[];for(objIndex in e){var o=e[objIndex];for(var r in o)o.hasOwnProperty(r)&&(0==objIndex&&"time"!=r&&(0==i.length?i.push(r):0==n.length&&n.push(r)),"time"==r?t.push(o[r]):i[0]==r?i.push(o[r]):n[0]==r&&n.push(o[r]))}c3.generate(a.data.progressChartData.build(t,i,n))}(e.viewsclicks),AGN.Initializers.Equalizer()}})}};AGN.Lib.NotificationStatService=a,AGN.Lib.DomInitializer.new("notification-stats",function(e){var t=AGN.Lib.Helpers.objFromString(e.data("config"));t&&t.pushId&&t.url&&AGN.Lib.NotificationStatService.updateCharts(t.pushId,t.url)})}(),AGN.Initializers.PollingForm=function(e){e=e||$(document),_.each(e.find('[data-form="polling"]'),function(e){var t=$(e);AGN.Lib.Form.get(t).submit()})},function(){var e=AGN.Lib.Popover;AGN.Initializers.Popover=function(){e.validate()}}(),function(){function r(e){var n=[];return e.forEach(function(e){var i=$("<option />");i.text(t("date.formats."+e)),i.val(e),n.push($("<div/>").append(i).html())}),n.join("")}function s(e){var t=["DD","MM","YYYY",".","-","_"];if(e)for(var i=0;i<t.length;i++)if(e.startsWith(t[i]))return t[i];return!1}AGN.Initializers.TargetGroupQueryBuilderExtend=function(){var l={};var e=$.fn.queryBuilder,i=e.constructor,n=i.prototype.init,o=i.prototype.validate;l=i.utils;var c=i.selectors;e.extend({init:function(e){return this.on("afterCreateRuleInput",function(e,t){var i=e.builder.optionsByType[t.filter.type];if(i){var n=i.postCreate;n&&"function"==typeof n&&n.call(e.builder,t,i)}}),this.on("afterUpdateRuleOperator",function(e,t){var i=e.builder.optionsByType[t.filter.type];if(i){var n=i.postOperatorUpdate;n&&"function"==typeof n&&n.call(e.builder,t,i)}}),e&&e.rules&&e.rules.length?this.initialRule=!1:(this.initialRule=!0,e.rules=[{initialRule:!0,empty:!0}]),n.call(this,e)},optionsByType:{date:{availableFormats:function(e){return e&&e.type&&("before"==e.type||"after"==e.type)?["YYYYMMDD"]:["DD.MM.YYYY","YYYYMMDD","DDMMYYYY","MMDD","DDMM","DD","MM","YYYY"]},input:function(e,i){return $('<div class="qb-input-label"><label class="checkbox-inline"><input name="today" type="checkbox"><span class="text">'+t("defaults.today")+'</span></label></div><div class="qb-input-element date-filter"><input class="form-control" type="text" id="date-filter"/></div><div class="qb-input-label" id="date-offset-label" style="display: none;"><div class="form-badge qb-input-inner">'+t("defaults.days")+'</div></div><div class="qb-input-label"><div class="qb-input-inner">'+t("date.formats.label")+'</div></div><div class="qb-input-element"><select class="form-control" id="date-format">'+r(i.availableFormats(i.operator))+'</select></div><div class="qb-input-label"><div class="qb-input-inner"><button type="button" class="icon icon-help" data-help="help_'+$("#helpLanguage").val()+'/targets/DateFormat.xml"></button></div></div>')},postCreate:function(t){var i=t.$el.find("input[name=today]"),n=t.$el.find("#date-offset-label"),o=t.$el.find("#date-filter"),r=t.$el.find("#date-format");i.on("change",function(){var e=i.prop("checked");n.toggle(e),o.off("change.offset keyup.offset"),t._updating_input||(t._updating_value=!0,e?o.val("+0"):o.val(function(e,t){return t.replace("DD",AGN.Lib.Helpers.pad(e.getDate(),2)).replace("MM",AGN.Lib.Helpers.pad(e.getMonth()+1,2)).replace("YYYY",AGN.Lib.Helpers.pad(e.getFullYear(),4))}(new Date,r.val())),t._updating_value=!1),e&&o.on("change.offset keyup.offset",function(e){var t=o.val();if(t){var i=parseInt(t);if(!isNaN(i)){var n=(i<0?"":"+")+i;n!=t&&o.val(n)}}else"change"===e.type&&o.val("+0")})})},postOperatorUpdate:function(e,t){var i=e.$el.find("#date-format");i.html(r(t.availableFormats(e.operator))),i.change(),i.trigger("change-date-format")},valueSetter:function(e,t){var i,n,o,r=t.slice(0),a=e.$el.find("input[name=today]"),s=e.$el.find("#date-offset-label"),l=e.$el.find("#date-format"),c=!1;n=(2<t.length?("today"===r.shift()&&(c=!0),o=r.shift(),i=r.shift()):"today"===(o=r.shift())&&(c=!0,o="+0"),r.shift()),s.toggle(c),function(e,t,i){i&&(t="sub"===i?"-"+Math.abs(t):"+"+Math.abs(t)),e.$el.find("#date-filter").val(t)}(e,o,i),l.val(n),a.prop("checked",c).change()},valueGetter:function(e){var t=[],i=e.$el.find("#date-filter").val(),n=e.$el.find("#date-format").val();return e.$el.find("input[name=today]").is(":checked")?(t.push("today"),t.push(i),function(e,t){-1===Math.sign(e)?t.push("sub"):t.push("add")}(i,t)):t.push(i),t.push(n),t},validate:function(e){if(2==e.length){var t=e[0],i=e[1];return t?"today"==t||!i||(!!function(e,t){if(!e)return!1;var i=function(e){var t=["DD","MM","YYYY"],i=[];for(;e;){var n=s(e);if(!n)return!1;var o=!1,r=!1;if(t.includes(n)&&(r=o=!0,i.length)){var a=i[i.length-1];a.isDigitFragment&&(a.isLenient=!1,r=!1)}i.push({lexeme:n,isDigitFragment:o,isLenient:r}),e=e.substring(n.length)}return!!i.length&&i}(t);if(i){for(var n=0;n<i.length;n++){var o=i[n];if(o.isDigitFragment)if(o.isLenient){var r=e.match("^\\d{1,"+o.lexeme.length+"}");if(!r)return!1;e=e.substring(r[0].length)}else{if(e.length<o.lexeme.length)return!1;if(!e.substr(0,o.lexeme.length).match(/^\d+$/))return!1;e=e.substring(o.lexeme.length)}else{if(!e.startsWith(o.lexeme))return!1;e=e.substring(o.lexeme.length)}}return!e}return!1}(t,i.toUpperCase())||["invalid_format"]):["empty_date"]}if(4==e.length){var n=e[1];if(!n||n!=parseInt(n))return["invalid_expression"]}return!0}}},clearInitialRuleSettings:function(){this.initialRule=!1,$(".initial-rule").removeClass("initial-rule")},validate:function(e){var t=this.model.root.rules;if(1===t.length&&t[0].$el.hasClass("initial-rule"))this.clearErrors();else{if(this.initialRule&&1===t.length)return this.clearErrors(),void t[0].$el.addClass("initial-rule");this.clearInitialRuleSettings(),o.call(this,e)}},getRuleInput:function(e,t){var i=e.filter,n=e.filter.validation||{},o=e.id+"_value_"+t,r=i.vertical?" class=block":"",a="";if("function"==typeof i.input)a=i.input.call(this,e,o);else if("function"==typeof e.operator.input)a=e.operator.input.call(this,e,o);else if(this.optionsByType[e.filter.type]&&"function"==typeof this.optionsByType[e.filter.type].input)a=this.optionsByType[e.filter.type].input.call(this,e,this.optionsByType[e.filter.type],o);else switch(i.input){case"radio":case"checkbox":l.iterateOptions(i.values,function(e,t){a+="<label"+r+'><input type="'+i.input+'" name="'+o+'" value="'+e+'"> '+t+"</label> "});break;case"select":a=this.getRuleValueSelect(o,e);break;case"textarea":a+='<textarea class="form-control" name="'+o+'"',i.size&&(a+=' cols="'+i.size+'"'),i.rows&&(a+=' rows="'+i.rows+'"'),void 0!==n.min&&(a+=' minlength="'+n.min+'"'),void 0!==n.max&&(a+=' maxlength="'+n.max+'"'),i.placeholder&&(a+=' placeholder="'+i.placeholder+'"'),a+="></textarea>";break;case"number":a+='<input class="form-control" type="number" name="'+o+'"',void 0!==n.step&&(a+=' step="'+n.step+'"'),void 0!==n.min&&(a+=' min="'+n.min+'"'),void 0!==n.max&&(a+=' max="'+n.max+'"'),i.placeholder&&(a+=' placeholder="'+i.placeholder+'"'),i.size&&(a+=' size="'+i.size+'"'),a+=">";break;default:a+='<input class="form-control" type="text" name="'+o+'"',i.placeholder&&(a+=' placeholder="'+i.placeholder+'"'),"string"===i.type&&void 0!==n.min&&(a+=' minlength="'+n.min+'"'),"string"===i.type&&void 0!==n.max&&(a+=' maxlength="'+n.max+'"'),i.size&&(a+=' size="'+i.size+'"'),a+=">"}return this.change("getRuleInput",a,e,o)},getRuleValueSelect:function(e,t){var i=this.templates.ruleValueSelect({builder:this,name:e,rule:t,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleValueSelect",i,e,t)},updateRuleOperator:function(e,t){var i=e.$el.find(c.value_container);e.operator&&0!==e.operator.nb_inputs?(i.css("display",""),!i.is(":empty")&&t&&"function"!=typeof t.input&&"function"!=typeof e.operator.input&&e.operator.nb_inputs===t.nb_inputs&&e.operator.optgroup===t.optgroup||this.createRuleInput(e)):(i.hide(),e.__.value=void 0),e.operator&&(e.$el.find(c.rule_operator).val(e.operator.type),e.__.value=this.getRuleInputValue(e)),this.trigger("afterUpdateRuleOperator",e,t),this.trigger("rulesChanged")},createRuleOperators:function(e){var t=e.$el.find(c.operator_container).empty();if(e.filter){var i=this.getOperators(e.filter);if(!e.filter.skipOperator){var n=$(this.getRuleOperatorSelect(e,i));t.html(n)}e.filter.default_operator?e.__.operator=this.getOperatorByType(e.filter.default_operator):e.__.operator=i[0],e.$el.find(c.rule_operator).val(e.operator.type),this.trigger("afterCreateRuleOperators",e,i),this.applyRuleFlags(e)}},createRuleInput:function(e){var t=e.$el.find(c.value_container).empty();if(e.__.value=void 0,e.filter&&e.operator&&0!==e.operator.nb_inputs){for(var i=this,n=$(),o=e.filter,r=0;r<e.operator.nb_inputs;r++){var a=$(this.getRuleInput(e,r));if(o.canBeNegated){var s=i.getNegateInput();t.prepend(s),n=n.add(s)}0<r&&t.append(this.settings.inputs_separator),t.append(a),"function"==typeof o.values&&o.values.call(this,a),n=n.add(a)}t.css("display",""),n.on("change "+(o.input_event||""),function(){e._updating_input||(e._updating_value=!0,e.negated=i.getNegateValue(e),e.value=i.getRuleInputValue(e),e._updating_value=!1)}),o.plugin&&n[o.plugin](o.plugin_config||{}),this.trigger("afterCreateRuleInput",e),void 0!==o.default_value?e.value=o.default_value:(e._updating_value=!0,e.negated=i.getNegateValue(e),e.value=i.getRuleInputValue(e),e._updating_value=!1),this.applyRuleFlags(e)}},setRuleInputValue:function(e,t){var i=e.filter,n=e.operator;if(i&&n){if(e._updating_input=!0,i.valueSetter)i.valueSetter.call(this,e,t);else if("function"==typeof e.operator.valueSetter)e.operator.valueSetter.call(this,e,t);else if(this.optionsByType[e.filter.type]&&"function"==typeof this.optionsByType[e.filter.type].valueSetter)this.optionsByType[e.filter.type].valueSetter.call(this,e,t);else{var o=e.$el.find(c.value_container);1===n.nb_inputs&&(t=[t]);for(var r=0;r<n.nb_inputs;r++){var a=l.escapeElementId(e.id+"_value_"+r);switch(i.input){case"radio":o.find("[name="+a+'][value="'+t[r]+'"]').prop("checked",!0).trigger("change");break;case"checkbox":$.isArray(t[r])||(t[r]=[t[r]]),t[r].forEach(function(e){o.find("[name="+a+'][value="'+e+'"]').prop("checked",!0).trigger("change")});break;default:n.multiple&&i.value_separator&&$.isArray(t[r])&&(t[r]=t[r].join(i.value_separator)),o.find("[name="+a+"]").val(t[r]).trigger("change")}}}this.setNegated(e),e._updating_input=!1}},getRuleInputValue:function(e){var t=e.filter,i=e.operator,n=[];if(t.valueGetter)n=t.valueGetter.call(this,e);else if("function"==typeof e.operator.valueGetter)n=e.operator.valueGetter.call(this,e);else if(this.optionsByType[e.filter.type]&&"function"==typeof this.optionsByType[e.filter.type].valueGetter)n=this.optionsByType[e.filter.type].valueGetter.call(this,e);else{for(var o=e.$el.find(c.value_container),r=0;r<i.nb_inputs;r++){var a,s=l.escapeElementId(e.id+"_value_"+r);switch(t.input){case"radio":n.push(o.find("[name="+s+"]:checked").val());break;case"checkbox":a=[],o.find("[name="+s+"]:checked").each(function(){a.push($(this).val())}),n.push(a);break;case"select":t.multiple?(a=[],o.find("[name="+s+"] option:selected").each(function(){a.push($(this).val())}),n.push(a)):n.push(o.find("[name="+s+"] option:selected").val());break;default:n.push(o.find("[name="+s+"]").val())}}n=n.map(function(e){return i.multiple&&t.value_separator&&"string"==typeof e&&(e=e.split(t.value_separator)),$.isArray(e)?e.map(function(e){return l.changeType(e,t.type)}):l.changeType(e,t.type)}),1===i.nb_inputs&&(n=n[0]),t.valueParser&&(n=t.valueParser.call(this,e,n))}return this.change("getRuleValue",n,e)},validateValue:function(e,t){var i=e.filter.validation||{},n=!0;return n=i.callback?i.callback.call(this,t,e):"function"==typeof e.operator.validate?e.operator.validate.call(this,t,e):this.optionsByType[e.filter.type]&&"function"==typeof this.optionsByType[e.filter.type].validate?this.optionsByType[e.filter.type].validate.call(this,t,e):this._validateValue(e,t),this.change("validateValue",n,t,e)},getRules:function(r){r=$.extend({get_flags:!1,allow_invalid:!1,skip_empty:!1},r);var e=this.validate(r);if(!e&&!r.allow_invalid)return null;var a=this,t=function i(e){var o={condition:e.condition,rules:[]};if(e.data&&(o.data=$.extendext(!0,"replace",{},e.data)),r.get_flags){var t=a.getGroupFlags(e.flags,"all"===r.get_flags);$.isEmptyObject(t)||(o.flags=t)}return e.each(function(e){if(e.filter||!r.skip_empty){var t=null;e.operator&&0===e.operator.nb_inputs||(t=e.value);var i={id:e.filter?e.filter.id:null,field:e.filter?e.filter.field:null,type:e.filter?e.filter.type:null,input:e.filter?e.filter.input:null,operator:e.operator?e.operator.type:null,value:t};if((e.filter&&e.filter.data||e.data)&&(i.data=$.extendext(!0,"replace",{},e.filter.data,e.data)),e.filter&&e.filter.canBeNegated&&(i.negated=e.negated),r.get_flags){var n=a.getRuleFlags(e.flags,"all"===r.get_flags);$.isEmptyObject(n)||(i.flags=n)}o.rules.push(a.change("ruleToJson",i,e))}},function(e){var t=i(e);0===t.rules.length&&r.skip_empty||o.rules.push(t)},this),a.change("groupToJson",o,e)}(this.model.root);return t.valid=e,this.change("getRules",t)},setRules:function(e,o){o=$.extend({allow_invalid:!1},o),$.isArray(e)&&(e={condition:this.settings.default_condition,rules:e}),e&&e.rules&&(0!==e.rules.length||this.settings.allow_empty)||l.error("RulesParse","Incorrect data object passed"),this.clear(),this.setRoot(!1,e.data,this.parseGroupFlags(e)),this.applyGroupFlags(this.model.root),e=this.change("setRules",e,o);var r=this;!function i(e,n){null!==n&&(void 0===e.condition?e.condition=r.settings.default_condition:-1==r.settings.conditions.indexOf(e.condition)&&(l.error(!o.allow_invalid,"UndefinedCondition",'Invalid condition "{0}"',e.condition),e.condition=r.settings.default_condition),n.condition=e.condition,e.rules.forEach(function(e){var t;if(void 0!==e.rules)if(-1!==r.settings.allow_groups&&r.settings.allow_groups<n.level)l.error(!o.allow_invalid,"RulesParse","No more than {0} groups are allowed",r.settings.allow_groups),r.reset();else{if(null===(t=r.addGroup(n,!1,e.data,r.parseGroupFlags(e))))return;r.applyGroupFlags(t),i(e,t)}else{if(e.empty||(void 0===e.id&&(l.error(!o.allow_invalid,"RulesParse","Missing rule field id"),e.empty=!0),void 0===e.operator&&(e.operator="equal")),null===(t=r.addRule(n,e.data,r.parseRuleFlags(e))))return;e.id&&(e.empty||(t.filter=r.getFilterById(e.id,!o.allow_invalid)),t.filter&&(t.operator=r.getOperatorByType(e.operator,!o.allow_invalid),t.operator||(t.operator=r.getOperators(t.filter)[0])),t.negated=e.negated,t.operator&&0!==t.operator.nb_inputs&&(void 0!==e.value?t.value=e.value:void 0!==t.filter.default_value&&(t.value=t.filter.default_value))),r.change("jsonToRule",t,e)!=t&&l.error("RulesParse","Plugin tried to change rule reference")}}),r.change("jsonToGroup",n,e)!=n&&l.error("RulesParse","Plugin tried to change group reference"))}(e,this.model.root),this.validate(),this.trigger("afterSetRules")},getNegateValue:function(e){var t,i=e.$el.find("select.negate");return 0!==i.length&&(t="true"===i.val()),t},getNegateInput:function(){var e='<div class="qb-input-negate"><select class="form-control negate"><option value="false">'+t("defaults.yes")+'</option><option value="true">'+t("defaults.no")+"</option></select></div>";return $(e)},setNegated:function(e){var t=e.$el.find("select.negate");0!==t.length&&t.val(""+e.negated)},displayError:function(e){if(this.settings.display_errors)if(null===e.error)e.$el.removeClass("has-error");else{var t=this.translate("errors",e.error[0]);t=this.constructor.utils.fmt(t,e.error.slice(1)),t=this.change("displayError",t,e.error,e),e.$el.addClass("has-error").find(this.constructor.selectors.error_container).eq(0).attr("data-tooltip",t),AGN.Initializers.Tooltip(e.$el)}}})}}(),function(){var r="---",a=.01,s="< 1",i={HIGH_PERFORMER:"#008F00",OPPORTUNITY:"#92D050",LEAD:"#CCCDCD",SLEEPER:"#F43536"},n=500,l=150,c="poor-dog",u="question-mark",d="rising-star",h="cash-cow";function p(i){var n=["data1"],o=[],r=0;return $.each(i.values,function(e,t){r<t&&(r=t),n.push(t),o.push(i.percentages[e])}),{values:n,percentages:o,maxValue:r}}function v(e,i){$(e.axes.x[0]).find(".tick text").attr("y",function(e,t){return parseInt(t||0)+i})}function f(n){var e=t("statistic.reactions"),i=t("statistic.impressions"),o=t("statistic.revenue"),r={};r[e]="#99c6e3",r[i]="#f43536",r[o]="#0071b9";var a=[],s=[e],l=[i],c=[o],u=!1,d=!1;$.each(n.values,function(e,t){a.push(e),s.push(t.reactions),l.push(t.impressions),c.push(t.revenues),0<t.impressions&&(u=!0),0<t.revenues&&(d=!0)});var h=[s],p={reactions:"area"};u&&(h.push(l),p.impressions="area"),d&&(h.push(c),p.revenues="bar");var f=n.mailingNames,g=a.length,m=3;g<60?m=5:g<100&&(m=4),c3.generate({bindto:"#reaction-progress-chart",onrendered:function(){v(this,10)},size:{height:200},data:{columns:h,types:p,color:function(e,t){return r[t.id?t.id:t]||e}},tooltip:{format:{title:function(e){var t=a[e],i=n.values[t].mailingIds;return i.length?f[i[0]]:t}}},bar:{width:10},point:{r:m},axis:{x:{type:"category",categories:a,height:40,tick:{multiline:!1,centered:!0,outer:!1,culling:!0}},y:{show:!1}}})}function g(e,t){var i=$(e),n=i.find(".l-kpi-value"),o=i.find(".l-kpi-sign");0<t?t<a?n.text(s):n.text(d3.round(t,2)):n.text(r),o.toggle(0<t)}AGN.Lib.DomInitializer.new("recipient-insights",function(){var o=this.config,e=this.config.insightsData;$.i18n.load(o.translations),function(n){n=p(n);var e=t("recipient.reaction.day"),i=t("date.weekdaysShort");c3.generate({bindto:"#reaction-weekday-chart",onrendered:function(){v(this,10)},size:{height:200},data:{type:"bar",columns:[n.values],labels:{format:{data1:function(e,t,i){return n.percentages[i]+"%"}}},color:function(e,t){return t.value===n.maxValue?"#0071b9":"#eaeaea"}},bar:{width:{ratio:.88}},legend:{show:!1},tooltip:{format:{name:function(){return e}}},axis:{x:{type:"category",categories:i,tick:{outer:!1}},y:{show:!1,padding:{top:20,bottom:20}}}})}(e.weekdayReactionRankData),function(n){n=p(n);c3.generate({bindto:"#reaction-hour-chart",onrendered:function(){v(this,10)},size:{height:200},data:{type:"bar",columns:[n.values],labels:{format:{data1:function(e,t,i){return n.percentages[i]+"%"}}},color:function(e,t){return t.value===n.maxValue?"#0071b9":"#eaeaea"},onmouseover:function(t){this.internal.mainText.style("visibility",function(e){return t.index===e.index?"visible":"hidden"})},onmouseout:function(t){this.internal.mainText.filter(function(e){return t.index===e.index}).style("visibility","hidden")}},bar:{width:{ratio:.7}},legend:{show:!1},tooltip:{show:!1},axis:{x:{type:"category",categories:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],tick:{multiline:!1,centered:!0,outer:!1}},y:{show:!1,padding:{top:20,bottom:20}}}})}(e.hourReactionRankData),function(e,i,n){function o(e){return"asc"===e.sorting?"icon icon-arrow-down":"desc"===e.sorting?"icon icon-arrow-up":"hidden"}var r=[{title:t("mailing.senddate"),criterion:"timestamp",sorting:!1},{title:t("statistic.revenue"),criterion:"revenue",sorting:!1},{title:t("Mailing"),criterion:"name",sorting:!1}],a=function(e){var t;if("de"===e){var i=d3.locale({decimal:",",thousands:".",grouping:[3],currency:[""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","M√§rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});t=i.numberFormat}else t=d3.format;return function(e){return[{text:e.date,classes:"l-revenue-date"},{text:t(",.2f")(e.revenue),classes:"l-revenue-value"},{text:e.name,mailingId:e.mailingId,classes:"l-revenue-name"}]}}(n),s=$.noop,l=d3.select("#mailings-revenue-rating-table").append("table"),c=l.append("thead").append("tr").selectAll("th").data(r).enter().append("th");c.append("span").on("click",function(e){s(e)}).attr("class","clickable unselectable").html(function(e){return e.title+"&nbsp;"});var u=c.append("i").attr("class",o);if(e.length){var d=l.append("tbody").selectAll("tr").data(e).enter().append("tr"),h=d.selectAll("td").data(a).enter().append("td").attr("class",function(e){return e.classes});h.filter(function(e){return!e.mailingId}).text(function(e){return e.text}),h.filter(function(e){return 0<e.mailingId}).append("a").attr("href",function(e){return i.replace("{mailing-id}",e.mailingId)}).attr("title",function(e){return e.text}).text(function(e){return e.text}),s=function(i){u.attr("class",function(e){return e.sorting=e===i&&("asc"===e.sorting?"desc":"asc"),o(e)});var n="desc"===i.sorting?d3.descending:d3.ascending;d.sort(function(e,t){return n(e[i.criterion],t[i.criterion])})}}else d=l.append("tbody").append("tr").append("td").attr("colspan",3).attr("class","l-revenue-unavailable").text(t("recipient.chart.not_available"))}(e.mailingsRevenueRatingData,o.mailingUriPattern,o.localeLanguage),f(e.reactionsInProgressData),function(e){var o=["#0071B9","#009BFF","#64C3FF","#00558A","#92D050"],r=[],a={},s={},l={};$.each(e,function(e,i){var n="data"+e;r.push([n,i.value]),a[n]=t(i.deviceClass),s[n]=i.percentage,l[n]=o[e]}),c3.generate({bindto:"#reaction-device-chart",size:{height:200},data:{columns:r,type:"donut",names:a,color:function(e,t){return l[t.id?t.id:t]||e}},donut:{label:{format:function(e,t,i){return s[i]+"%"}}},legend:{position:"right"},tooltip:{format:{value:function(e,t,i){return e+" ("+s[i]+"%)"}}}})}(e.reactionDeviceRankData),function(e){g("#reactionTypeKpi",e.percentage.percentage),$("#reactionGradeIcon").css("color",function(e){return i[e]||"inherit"}(e.grade))}(e.mailingReactionPercentageData),function(e){g("#revenueSumKpi",e.value),g("#revenueAvgKpi",e.average),$("#revenueIcon").addClass(function(e){return n<=e?h:l<=e?d:0<e?u:c}(e.value))}(e.customerRevenueData),function(e){0<e.clicks.percentage?g("#performanceClicksKpi",e.clicks.percentage):g("#performanceClicksKpi",0<e.clicks.value?.001:0);g("#performanceRevenueKpi",e.revenue)}(e.customerPerformanceData),function(e){g("#impressionsByClickKpi",e.perClick),g("#impressionsByVisitKpi",e.perVisit),g("#impressionsByBuyKpi",e.perBuy)}(e.pageImpressionsData),this.addAction({change:"selectReactionProgressPeriodType"},function(){$("#reactionProgressPeriodDates").toggleClass("hidden","CUSTOM"!==this.el.val())}),this.addAction({click:"selectReactionProgressPeriod"},function(){var e,i,n=$('input[name="reactionProgressPeriod"]:checked');switch(n.val()){case"YEAR":case"MONTH":e=n.data("min"),i=n.data("max");break;case"CUSTOM":e=$("#reactionProgressMinDate").val(),i=$("#reactionProgressMaxDate").val();break;default:return void console.error("Unexpected period type: `"+n.val()+"`")}e&&i?$.ajax(o.urls.reactionsInProgress,{type:"GET",data:{customerId:o.customerId,min:e,max:i}}).done(function(e){f(e)}):AGN.Lib.Messages(t("defaults.error"),t("defaults.error"),"alert")})})}(),AGN.Initializers.Scrollable=function(e){e=e||$(document),_.each(e.find(".js-scrollable"),function(e){var t=$(e);t.perfectScrollbar("destroy"),t.perfectScrollbar({wheelSpeed:5,scrollXMarginOffset:1})})},function(){var r=AGN.Lib.Popover,n=AGN.Lib.Page;AGN.Initializers.Select=function(e){e=e||$(document),_.each(e.all("select"),function(e){var i=$(e),t={placeholder:i.attr("placeholder"),minimumResultsForSearch:10};i.hasClass("js-select")||(t.minimumResultsForSearch=-1),i.prop("multiple")&&(t.minimumResultsForSearch=1,t.formatSelection=function(e){if(e.element&&1===e.element.length){var t=$(e.element).data("url");if(t)return $("<a></a>",{href:t,text:e.text,click:function(){n.reload(t)}})}return e.text}),i.data("select2")&&i.select2("destroy"),i.hasClass("js-option-popovers")&&(t.formatResult=function(e,t,i,n){var o='<span style="white-space: nowrap;">'+n(e.text)+"</span>";return r.new(t,{trigger:"hover",delay:{show:300,hide:100},html:!0,template:'<div class="popover popover-wide" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:o}),o},i.on("select2-close",function(){r.validate()})),i.select2(t),0<i.find("option[data-exclusive]").length&&i.on("select2-selecting",function(e){if(0<i.find("option[value='"+e.val+"'][data-exclusive]").length){var t=!1;i.find("option:selected:not([data-exclusive])").each(function(){t=!0,$(this).removeAttr("selected")}),t&&i.trigger("change")}else t=!1,i.find("option:selected[data-exclusive]").each(function(){t=!0,$(this).removeAttr("selected")}),t&&i.trigger("change")})})}}(),AGN.Lib.DomInitializer.new("session-timer",function(){var n,o=6e5,r=5e3,i=401,e=this.config,a=this.config.sessionInfoUrl,s=this.config.creationTime,l=this.config.lastAccessedTime,c=this.config.maxInactiveInterval,u=$("#session-time-layout"),d=$("#session-time-field"),h=$("#session-time-icon"),p="menu-item-logo icon icon-hourglass-end",f="icon icon-refresh icon-spin",g=!1,m=!0,v=!1;function y(){v=!0}function b(e){c=e.maxInactiveInterval,n=Date.now()+1e3*e.maxInactiveInterval,g=!1}function w(e){e.status===i&&(g=!0,h.attr("class",p),d.text(t("logon.session.expired")))}function C(){m=v=!1}e&&s&&l&&c&&(n=1e3*c+Date.now(),setInterval(function(){var e=Date.now(),i=e<n?n-e:0;m&&!(i<=o)||g||v||(u.show(),function(e){if(h.attr("class",p),0<e){var i=new Date(e),n="";n+=0<i.getMinutes()?d3.format("02")(i.getUTCMinutes())+":":"00:",n+=0<i.getSeconds()?d3.format("02")(i.getUTCSeconds()):"00",n+=" "+t("time.min")+" "+t("logon.session.remaining"),d.text(n)}}(i)),!v&&!g&&e<n+r&&n<e&&(h.attr("class",f),d.text(t("logon.session.checking"))),!g&&!v&&n+r<e&&$.ajax({url:a,global:!1,beforeSend:y,success:b,error:w,complete:C})},1e3)),$(document).ajaxComplete(function(e,t){!e.preventSessionTimer&&!g&&!v&&t.status!==i&&t.status<501&&(n=1e3*c+Date.now()),e.preventSessionTimer=!0})}),AGN.Initializers.Sizing=function(e){e=e||$(document);var u=$(window).height();_.each(e.find('[data-sizing="container"]'),function(e){var t,i,n,o,r,a=$(e),s=a.find('[data-sizing="top"]'),l=a.find('[data-sizing="bottom"]'),c=a.find('[data-sizing="scroll"]');t=a.offset().top,i=_.reduce(_.map(s,function(e){return $(e).outerHeight()}),function(e,t){return e+t})||0,n=_.reduce(_.map(l,function(e){return $(e).outerHeight()}),function(e,t){return e+t})||0,r=a.data("sizing-offset")||20,o=u-t-i-n-r,_.each(c,function(e){var t,i=$(e);t=i.data("sizing-offset")||0,i.css({height:o-t,"overflow-y":"auto"}),i.trigger("scrollTo")})})},function(){var o=AGN.Lib.Helpers;AGN.Initializers.Slider=function(e){e=e||$(document),_.each(e.find(".js-slider"),function(e){var t,i,n=$(e);t={handle:"round",min:0,max:101},i=_.merge({},t,o.objFromString(n.data("slider-options"))),n.slider(i)})}}(),AGN.Initializers.Sync=function(e){e=e||$(document),_.each(e.find("[data-sync]"),function(e){var t=$(e),i=$(t.data("sync")),n=t.data("_editor");n?n.val(i.val()):t.val(i.val())})},function(){var t=AGN.Lib.Tab;AGN.Initializers.TabToggle=function(e){e=e||$(document),_.each(e.find("[data-toggle-tab]"),function(e){t.init($(e))})}}(),AGN.Initializers.TableResponsiveWrap=function(e){(e=e||$(document)).find(".table-wrapper:not(.table-overflow-visible) table").wrap('<div class="table-responsive" />'),e.find(".table-wrapper.table-overflow-visible table").wrap('<div class="table-responsive" style="overflow: visible;" />')},function(){var i=AGN.Lib.Popover;AGN.Initializers.TableRowActions=function(e){(e=e||$(document)).find(".js-table").each(function(){_.each(this.rows,function(e){var t=$(e);!function(e){var i=e.find(".js-row-show");1===i.length&&(e.data("link",i.attr("href")),i.remove(),_.each(e.prop("cells"),function(e){var t=$(e);0===t.find("a,input,select,textarea,button").length&&(t.addClass("table-link"),0===t.contents().length?t.html('<a href="'+i.attr("href")+'">&nbsp;</a>'):t.contents().wrapAll('<a href="'+i.attr("href")+'"></a>'))}))}(t),function(r){var a=r.find(".js-row-popover");if(1===a.length){var s=!1,l=null;i.new(r,{trigger:"hover",delay:{show:300,hide:100},html:!0,content:function(){if(!1===s){s=$.Deferred();var e=a.children();if(0==e.length){var t=$("<div></div>");t.css({position:"fixed",visibility:"hidden"}),t.html(a.html()),e=t.children(),$(document.body).append(t),s.done(function(){e.detach(),t.remove()})}s.done(function(){l=e});var n=e.find("img").add(e.filter("img")).filter(function(){return this.complete?null:this});if(0<n.length){s.done(function(){var e=r.data("bs.popover");e&&(e.setContent(),r.is(":hover")&&r.popover("show"))});function i(){for(var e=!0,t=0;t<n.length;t++){var i=n[t];i&&(i.complete?($(i).off("load error"),n[t]=null):e=!1)}return e}for(var o=0;o<n.length;o++)$(n[o]).on("load error",function(){i()&&s.resolve()})}else s.resolve()}return l}})}}(t)})})}}(),function(){var a=AGN.Lib.Table;AGN.Initializers.Table=function(e){(e=e||$(document)).all(".js-data-table").each(function(){var e=$(this),t=e.find(".js-data-table-body"),i=e.data("table");if(t.exists()&&i){var n,o,r=$("script#"+CSS.escape(i));r.exists()&&(n=r.json(),o=t.data("web-storage")?_.merge(AGN.Lib.WebStorage.get(t.data("web-storage"))||{},n.options||{}):n.options||{},new a(t,n.columns,n.data,o))}})}}(),function(){var p={filter_readonly:!0,condition_readonly:!0,operator_readonly:!0,value_readonly:!0,no_delete:!0,no_add_rule:!0,no_add_group:!0};AGN.Initializers.TargetGroupQueryBuilder=function(i){i=i||$(document);var l=$("#jSessionId").val(),c="#targetgroup-querybuilder",r=navigator.userAgent.match("MSIE 10.0;"),a=$('[name="locked"]').val();function s(e){var t=JSON.stringify(e.getRules({allow_invalid:!0}));_.each(i.find("#queryBuilderRules"),function(e){$(e).val(t)})}function u(e,t){!r&&e.is("select")?AGN.Lib.Select.get(e).selectValueOrSelectFirst(t):e.val(t)}function d(i,e){var t=e||function(e){e.forEach(function(e){var t=$("<option>");t.text(e.shortname),t.val(e.mailingID),i.append(t)}),i.trigger("values-set")};return $.ajax({type:"POST",url:"workflow.do;jsessionid="+l,data:{method:"getAllMailingSorted",sortField:"date",sortDirection:"desc"},success:t})}function h(e,t){var i=null;return _.each(e.find(t),function(e){if(null===i){var t=$(e).val();i=JSON.parse(t)}}),i}_.each(i.find(c),function(e){var i=$(e),n=[{type:"equal",apply_to:["string","number","datetime"]},{type:"not_equal",apply_to:["string","number","datetime"]},{type:"less",apply_to:["string","number"]},{type:"less_or_equal",apply_to:["string","number"]},{type:"greater",apply_to:["string","number"]},{type:"greater_or_equal",apply_to:["string","number"]},{type:"like",nb_inputs:1,apply_to:["string"]},{type:"not_like",nb_inputs:1,apply_to:["string"]},{type:"contains",nb_inputs:1,apply_to:["string"]},{type:"not_contains",nb_inputs:1,apply_to:["string"]},{type:"begins_with",nb_inputs:1,apply_to:["string"]},{type:"not_begins_with",nb_inputs:1,apply_to:["string"]},{type:"mod",nb_inputs:1,apply_to:["number"],valueSelectors:["#first","#operator select","#second"],valueGetter:function(t){var i=[];return t.operator.valueSelectors.forEach(function(e){i.push(t.$el.find(e).val())}),i},valueSetter:function(i,n){i.operator.valueSelectors.forEach(function(e,t){i.$el.find(e).val(n[t])})},input:function(e){var t=this.operators.filter(function(e){return"mod"!==e.type&&e.apply_to.includes("number")});return"<div class='qb-input-element'><input class='form-control' id='first' type='number'/></div><div class='qb-input-element' id='operator'>"+this.getRuleOperatorSelect(e,t)+"</div><div class='qb-input-element'><input class='form-control' id='second' type='number'/></div>"},validate:function(e){return e.every(function(e){return e})||["string_empty"]}},{type:"is_empty",nb_inputs:0,apply_to:["string","number","datetime"]},{type:"is_not_empty",nb_inputs:0,apply_to:["string","number","datetime"]},{type:"before",nb_inputs:1,apply_to:["datetime"]},{type:"after",nb_inputs:1,apply_to:["datetime"]}],o=function(e,i){var n=h(e,i);if(null===n)n=[{id:"?",label:"?",type:"string"}];else{var o={};n=n.filter(function(e){return!o[e.id]&&(o[e.id]=!0)})}return function(e){function i(e){var t=$('<select class="form-control qb-input-element-select mailings js-select">');return t.attr("id",e.id),t}function n(e){return e.$el.find(".mailings :selected").val()}function o(n){var o={},r={};return $(c).on("values-set",n,function(e){if($.isEmptyObject(r))u($(e.target),-1);else{var t=$(e.target).attr("id"),i=r[t];u(i?i.$el.find(n):$(e.target),o[t]||-1)}}),function(e,t){var i=e.$el.find(n);o[e.id]=t,r[e.id]=e,u(i,t)}}var r=o("select.mailings"),a=o("select.auto-imports"),s={"finished auto-import":{type:"string",input_event:"values-setup-finished",input:function(e){var t=$('<select class="form-control qb-input-element-select auto-imports js-select">');return t.attr("id",e.id),t},values:function(e){(function(t,e){var i=e||function(e){e.forEach(function(e){t.append($("<option>",{text:e.shortname,value:e.autoImportId}))}),t.trigger("values-set")};return $.ajax({type:"POST",url:"autoimport.do;jsessionid="+l,data:{method:"listJson"},success:i})})(e).done(function(){e.trigger("values-setup-finished")})},valueSetter:a,valueGetter:function(e){return e.$el.find(".auto-imports :selected").val()},canBeNegated:!0,skipOperator:!0},"received mailing":{type:"string",input_event:"values-setup-finished",input:i,values:function(e){d(e).done(function(){e.trigger("values-setup-finished")})},valueSetter:r,valueGetter:n,canBeNegated:!0,skipOperator:!0},"opened mailing":{type:"string",input_event:"values-setup-finished",input:i,canBeNegated:!0,values:function(e){d(e).done(function(){e.trigger("values-setup-finished")})},valueSetter:r,valueGetter:n,skipOperator:!0},"clicked in mailing":{type:"string",input_event:"values-setup-finished",input:function(e){return $('<div class="qb-input-element"><select class="form-control js-select mailings" id="'+e.id+'" /></div><div class="qb-input-label"><div class="qb-input-inner">Links</div></div><div class="qb-input-element"><select class="form-control js-select links" id="'+e.id+'" /></div>')},values:function(o){var i=o.find(".mailings");i.change(function(e){!function(e,t){$.ajax({type:"POST",url:"workflow.do;jsessionid="+l,data:{method:"getMailingLinks",mailingId:e},success:t})}($(e.target).find(":selected").val(),function(e){var i=o.find(".links"),n=$('<option value="-1">'+t("querybuilder.common.anyLink")+"</option>");i.empty(),i.append(n),$.each(e,function(e,t){(n=$("<option/>")).text(t.url),n.val(t.id),i.append(n)}),i.trigger("link-values-set")})}),d(i,function(e){!function(e,i){e.forEach(function(e){var t=$("<option>");t.text(e.shortname),t.val(e.mailingID),i.append(t)})}(e,i),i.trigger("mailing-values-set")})},valueGetter:function(e){var t=[];return t[0]=e.$el.find("select.mailings").val(),t[1]=e.$el.find("select.links").val(),t},valueSetter:function(){var e="#tab-targetgroupQueryBuilderEditor",r={},a={};return $(e).on("mailing-values-set",function(e){var t,i=$(e.target),n=i.attr("id"),o=a[n];o?(u(t=o.$el.find(".mailings"),r[n][0]),t.trigger("change")):(u(i),i.trigger("change"))}),$(e).on("link-values-set",function(e){var t,i=$(e.target).attr("id"),n=a[i];n?u(t=n.$el.find(".links"),r[i][1]||-1):u(t=$(e.target)),t.trigger("values-setup-finished")}),function(e,t){r[e.id]=t,a[e.id]=e}}(),validation:{callback:function(e){return e.every(function(e){return e})||["string_empty"]}},canBeNegated:!0,skipOperator:!0},"revenue by mailing":{type:"string",input_event:"values-setup-finished",input:i,values:function(e){d(e).done(function(){e.trigger("values-setup-finished")})},valueSetter:r,valueGetter:n,canBeNegated:!0,skipOperator:!0}};e.forEach(function(e){var t=s[e.id];t&&$.extend(e,t)})}(n),n}(i,"#queryBuilderFilters");i.queryBuilder({filters:o,allow_empty:!0,operators:n,plugins:{sortable:{inherit_no_drop:!0,inherit_no_sortable:!0,icon:"icon icon-arrows-alt"}},rules:function(e,t,i){var n=h(e,t);"true"==i&&(n=function(e){e&&(e.flags=p,_.each(e.rules,function(e){e.flags=p}));return e}(n));return n}(i,"#queryBuilderRules",a)}),r||AGN.Initializers.Select(i),i.on("afterMove.queryBuilder rulesChanged.queryBuilder",function(e){s(e.builder)}),i.on("afterAddGroup.queryBuilder afterDeleteGroup.queryBuilder afterUpdateGroupCondition.queryBuilder",function(e){s(e.builder)}),i.on("afterAddRule.queryBuilder afterDeleteRule.queryBuilder afterUpdateRuleValue.queryBuilder afterUpdateRuleOperator.queryBuilder afterUpdateRuleFilter.queryBuilder",function(e){s(e.builder)}),i.on("afterSetRules.queryBuilder afterUpdateRuleFilter.queryBuilder afterCreateRuleFilters.queryBuilder afterAddRule.querybuilder",function(e){r||AGN.Initializers.Select($(this))}),i.on("link-values-set",function(e){r||AGN.Initializers.Select($(e.target))}),i.on("mailing-values-set values-set ",function(e){r||AGN.Initializers.Select($(e.target))}),i.on("change-date-format",function(e){r||AGN.Initializers.Select($(e.target))}),i.on("save-target-group.queryBuilder",function(e){var t=this.queryBuilder;t.clearInitialRuleSettings(),t.validate()})})}}(),AGN.Initializers.Template=function(e){e=e||$(document),_.each(e.find('script[type="text/x-mustache-template"]'),function(e){var t=$(e),i=t.attr("id");AGN.Opt.Templates[i]=t.html()})},function(){var t=AGN.Lib.Tile;AGN.Initializers.TileToggle=function(e){e=e||$(document),_.each(e.find("[data-toggle-tile]"),function(e){t.init($(e))})}}(),function(){var t=AGN.Lib.Tooltip;AGN.Initializers.Tooltip=function(e){e=e||$(document),$(".tooltip").remove(),e.find("[data-tooltip], [data-tooltip-help]").each(function(){var e=$(this);t.create(e,t.options(e))})}}(),function(){var i=AGN.Lib.Truncate.run,n=AGN.Lib.Breadcrumbs.truncate;AGN.Initializers.Truncate=function(e){e=e||$(document),setTimeout(function(){_.each(e.find(".l-header"),function(e){var t=$(e);i(t,".header-nav"),n(t.find(".header-nav"))})},50)}}(),AGN.Lib.DomInitializer.new("upload",function(n){var o,i,r,e=AGN.Lib.Template,t=AGN.Lib.Form,a=n.find("[data-upload-dropzone]").first(),s=(a.exists()?a:n).find("[data-upload]"),l=n.find("[data-upload-add]"),c=l.find("[data-upload-add-template]"),u=n.find("[data-upload-progress]"),d=u.find("[data-upload-progress-template]"),h=s.prop("name")||"",p=h.includes("[]"),f=!s.exists()||s.is("[multiple]"),g=[];if(s.exists()||a.exists()){E(),o=e.prepare(c.data("upload-add-template")),i=e.prepare(d.data("upload-progress-template")),s.prop("name",""),r=t.get(s.exists()?s:a),a.exists()?new Dropzone(a,{classDragOver:"drag-over",onSelectFiles:function(e){y(e)}}):s.on("change",function(){y(s.prop("files"))});var m=r.get$();m.on("form:loadershow",function(){d.html(i({currentProgress:!0})),u.removeClass("hidden")}),m.on("form:loaderhide",function(){u.addClass("hidden"),l.removeClass("hidden")}),m.on("form:submit",function(){l.addClass("hidden")}),m.on("form:abort",function(){g.length&&(l.removeClass("hidden"),w())}),m.on("form:progress",function(e,t){d.html(i({currentProgress:t.progress}))}),m.on("submitted",function(){A(),v()}),n.on("upload:reset",function(){A(),v()}),n.on("click","a[data-upload-reset], button[data-upload-reset]",function(){A(),v()})}function v(){p?g.forEach(function(e,t){r.setValueOnce(b(t+1),void 0)}):r.setValueOnce(h,void 0),g=[],E()}function y(e){if(e&&0<e.length){var t,i=!1;if(f)for(var n=0;n<e.length;n++)C(t=e[n],g.length)&&(g.push(t),_(t),i=!0);else C(t=e[0],0)&&(A(),v(),g=[t],_(t),i=!0);i&&(E(),w())}}function b(e){return h.replace("[]","["+e+"]")}function w(){p?g.forEach(function(e,t){r.setValueOnce(b(t+1),e)}):r.setValueOnce(h,g.slice(0))}function C(e,t){var i=$.Event("upload:add");return n.trigger(i,{file:e,index:t}),!i.isDefaultPrevented()}function _(e){var t=e.id?"":"hidden",i={file:e,count:g.length,filename:e.name,size:e.size,id:e.id?e.id:0,duplicationErrorHidden:t,preview:void 0};if(/^image/.test(e.type)){var n=new FileReader;n.onloadend=function(){i.preview=this.result,l.removeClass("hidden"),AGN.runAll($(o(i)).appendTo(c)),r.initFields()},n.readAsDataURL(e)}else i.preview=void 0,l.removeClass("hidden"),AGN.runAll($(o(i)).appendTo(c)),r.initFields()}function A(){l.addClass("hidden"),c.empty(),r.initFields()}function E(){n.data("upload-selection",g.slice(0))}}),function(){function n(e,t){var i=e,n=t;i.get("value")&&n.set("min",i.get("select")),n.get("value")&&i.set("max",n.get("select")),i.on("set",function(e){e.select?n.set("min",i.get("select")):"clear"in e&&n.set("min",!1)}),n.on("set",function(e){e.select?i.set("max",n.get("select")):"clear"in e&&i.set("max",!1)})}AGN.Lib.DomInitializer.new("user-activity-log-period",function(e){!function(e){e=e||$(document);var i=[];_.each(e.find(".js-datepicker"),function(e){var t=$(e);t.hasClass("js-datepicker-period-start")&&(t.attr("datepicker-period-id")in i||(i[t.attr("datepicker-period-id")]={startEl:null,endEl:null}),i[t.attr("datepicker-period-id")].startEl=t),t.hasClass("js-datepicker-period-end")&&(t.attr("datepicker-period-id")in i||(i[t.attr("datepicker-period-id")]={startEl:null,endEl:null}),i[t.attr("datepicker-period-id")].endEl=t)});for(var t=0;t<i.length;t++)n(i[t].startEl.pickadate("picker"),i[t].endEl.pickadate("picker"))}(e)})}(),function(){var t=AGN.Lib.View;AGN.Initializers.View=function(e){e=e||$(document),t.init()}}(),AGN.Lib.DomInitializer.new("web-storage-persist",function(){this.config&&$.each(this.config,function(e,t){var i="web-storage#"+$.trim(e),n=null;try{n=AGN.Lib.Storage.get(i)}catch(e){console.error(e)}null!=n?AGN.Lib.Storage.set(i,$.extend(n,t)):AGN.Lib.Storage.set(i,t)})}),function(){var i=AGN.Lib.Loader,a=AGN.Lib.Template,s=AGN.Lib.Page,n=function(e){!0!==e.loader&&void 0!==e.loader||(e.loader={show:function(){i.show()},hide:function(){i.hide()}})},o=function(e){var t=e.loader;if(t&&t.show)try{t.show()}catch(e){console.error(e)}},l=function(e){var t=e.loader;if(t&&t.hide)try{t.hide()}catch(e){console.error(e)}};$.ajaxPrefilter(function(e){n(e)}),$(document).ajaxSend(function(e,t,i){o(i)}),$(document).ajaxComplete(function(e,t,i){l(i)}),$(document).ajaxError(function(e,i,n){var o;if((l(n),0!=i.readyState&&0!=i.status)&&!(n.statusCode&&i.status in n.statusCode))if(401==i.status){var r=$.Event("ajax:unauthorized");$(document).trigger(r),!r.isDefaultPrevented()&&i.responseText&&s.render(i.responseText)}else if(403==i.status)o=a.text("permission-denied",{title:t("messages.permission.denied.title"),text:t("messages.permission.denied.text"),btn:t("defaults.ok")}),$("body").append(o);else{if(i.responseText)try{o=$(i.responseText).filter("#error-message")}catch(e){console.debug(e)}o&&o.exists()?$("body").append(o.html()):(o=a.text("error",{headline:t("messages.error.headline"),text:t("messages.error.text"),reload:t("messages.error.reload")}),$("body").append(o))}}),$(document).on("click","a[data-ajax], a.js-ajax",function(e){var t=$(this);e.preventDefault(),s.reload(t.attr("href"),!0,t.data("ajax"))}),$(document).on("click","[data-prevent-load]",function(){i.prevent()}),window.onbeforeunload=function(){i.show()}}(),$(document).on("click","[data-toggle-checkboxes]",function(e){var t=$(this),i=t.data("toggle-checkboxes"),n=t.closest(".tile-header").find("[data-toggle-tile]").data("toggle-tile");_.each($(n+" [type=checkbox]:enabled"),function(e){var t="on"==i;$(e).prop("checked",t)}),e.preventDefault()}),$(document).on("click","[data-toggle-checkboxes-all]",function(e){var i=$(this).data("toggle-checkboxes-all");_.each($(".checkboxes-content [type=checkbox]:enabled"),function(e){var t="on"==i;$(e).prop("checked",t)}),e.preventDefault()}),AGN.Lib.Action.new({click:"[data-clone]"},function(){var e,t,i=this.el.data("clone"),n=this.el.data("clone-target"),o=parseInt(this.el.data("clone-count"));o+=1,this.el.data("clone-count",o),e=AGN.Lib.Template.text(i,{count:o}),t=$(n).append(e),AGN.runAll(t)}),$(document).on("click","a[data-clone]",function(e){e.preventDefault()}),function(){var n=AGN.Lib.Form,o=AGN.Lib.Confirm,e=AGN.Lib.Action,i=AGN.Lib.Page;e.new({click:"[data-confirm], .js-confirm"},function(){$.get(this.el.attr("href")).done(function(e){var t=$(e);1==t.filter(".modal").add(t.find(".modal")).length?o.create(e).done(function(e){i.render(e)}):i.render(e)}),this.event.preventDefault()}),$(document).on("click","[data-confirm-positive], .js-confirm-positive",function(){var e=$(this),t=o.get(e),i=n.getWrapper(e);t&&(i.exists()?n.get(i).jqxhr().done(function(e){t.positive(e)}):t.positive(e.data("confirm-positive")))}),$(document).on("click","[data-confirm-negative], .js-confirm-negative",function(){var e=$(this),t=o.get(e);t&&t.negative(e.data("confirm-negative"))})}(),function(){var o=AGN.Lib.Table,r=AGN.Lib.WebStorage;$(document).on("click",".js-data-table-first-page",function(e){o.get($(this)).api.paginationGoToFirstPage()}),$(document).on("click",".js-data-table-prev-page",function(e){o.get($(this)).api.paginationGoToPreviousPage()}),$(document).on("click",".js-data-table-page",function(e){o.get($(this)).api.paginationGoToPage($(this).data("page"))}),$(document).on("click",".js-data-table-next-page",function(e){o.get($(this)).api.paginationGoToNextPage()}),$(document).on("click",".js-data-table-last-page",function(e){o.get($(this)).api.paginationGoToLastPage()}),$(document).on("click",".js-data-table-paginate",function(e){var t=$(this),i=t.data("page-size");o.get(t).api.paginationSetPageSize(i),t.closest(".dropdown-menu").trigger("click");var n=t.data("web-storage");n&&r.extend(n,{paginationPageSize:parseInt(i)})}),$(window).on("viewportChanged",function(e){$(document).all(".js-data-table-body").each(function(){AGN.Lib.Table.get($(this)).redraw()})})}(),$(document).ready(function(){window.AGN.Lib.Controller.init(),window.AGN.runAll()}),$(document).on("dragster:enter",function(e){var t=$(e.target);t.is("[data-upload-dropzone]")||t.addClass("drag-over")}),$(document).on("dragster:leave",function(e){var t=$(e.target);t.is("[data-upload-dropzone]")||t.removeClass("drag-over")}),$(document).on("click",".dropdown-menu *",function(e){$target=$(e.target),$target.hasClass("js-dropdown-open")&&(e.preventDropdownClose=!0),1==$target.parent(".js-dropdown-open").length&&(e.preventDropdownClose=!0),$target.is("button")||$target.is("a")||1!=$target.parent("a").length&&1!=$target.parent("button").length&&($target.hasClass("js-dropdown-close")||1!=$target.parent(".js-dropdown-close").length&&(e.preventDropdownClose=!0))}),$(document).on("click",".js-close-error",function(e){$(e.target).hasClass("js-close-error")&&$(this).closest(".backdrop").remove()}),function(){var e=AGN.Lib.Action,n=AGN.Lib.Form,o=AGN.Lib.Confirm,t=AGN.Lib.Helpers;e.new({click:"[data-form-change]"},function(){n.get(this.el).setValueOnce("numberOfRowsChanged",!0)}),e.new({click:"[data-form-bulk]"},function(){var e=this.el.data("form-bulk"),t=this.el.prop("checked");n.get(this.el).bulkUpdate(e,t)}),e.new({click:"a[data-form-set], button[data-form-set]",change:"select[data-form-set], input[data-form-set]"},function(){var e=t.objFromString(this.el.data("form-set")),i=n.get(this.el);_.forEach(e,function(e,t){i.setValueOnce(t,e)})}),e.new({click:"a[data-form-url], button[data-form-url]",change:"select[data-form-url], input[data-form-url]"},function(){n.get(this.el).setActionOnce(this.el.data("form-url"))}),e.new({click:"a[data-form-resource], button[data-form-resource]",change:"select[data-form-resource], input[data-form-resource]"},function(){var e=n.get(this.el);e instanceof AGN.Lib.ResourceForm&&e.setResourceSelectorOnce(this.el.data("form-resource"))}),e.new({click:"a[data-form-persist], button[data-form-persist]",change:"select[data-form-persist], input[data-form-persist]"},function(){var e=t.objFromString(this.el.data("form-persist")),i=n.get(this.el);_.forEach(e,function(e,t){i.setValue(t,e)})}),e.new({click:"a[data-form-reset], button[data-form-reset]"},function(){n.get(this.el).reset()}),e.new({click:"a[data-form-abort], button[data-form-abort]"},function(){n.get(this.el).abort()}),e.new({click:"[data-form-confirm]"},function(){var e=this.el.data("form-confirm"),i=n.get(this.el);i.submit("confirm",e).done(function(e){var t=$(e);1==t.filter(".modal").add(t.find(".modal")).length?o.create(e).done(function(e){i.updateHtml(e)}).fail(i.revertAction):i.updateHtml(e)})}),e.new({click:"a[data-form-action], button[data-form-action]",change:"select[data-form-action], input[data-form-action]"},function(){var e=this.el.data("form-action"),t=n.get(this.el);setTimeout(function(){t.submit("action",e)},5)}),e.new({click:"a[data-form-submit], button[data-form-submit]",change:"select[data-form-submit], input[data-form-submit]"},function(){var e=this;setTimeout(function(){n.get(e.el).submit()},5)}),e.new({click:"a[data-form-submit-static], button[data-form-submit-static]",change:"select[data-form-submit-static], input[data-form-submit-static]"},function(){var e=this;setTimeout(function(){n.get(e.el).submit("static")},5)}),e.new({click:"a[data-form-submit-event], button[data-form-submit-event]",change:"select[data-form-submit-event], input[data-form-submit-event]"},function(){var e=this;setTimeout(function(){n.get(e.el).submit("event")},5)}),e.new({submit:"[data-form]"},function(){var e=this;"static"!=this.el.data("form")&&(this.event.preventDefault(),setTimeout(function(){n.get(e.el).submit()},5))}),e.new({keydown:'input[type="text"], input[type="password"]'},function(){if(function(e){var t=e.keyCode||e.which;if(13===t)return!0;if(229===t&&e.originalEvent){var i=e.originalEvent.code;if("Enter"===i||"NumpadEnter"===i)return!0}return!1}(this.event)){var e=$.Event("enterdown");if(this.el.trigger(e),e.isDefaultPrevented())return;var t=this.el.parents("form");if(t.exists())if(t.is("[data-form]")){var i=n.get(t);t.is("[data-action]")?i.submit("event"):i.submit()}else t.submit()}})}(),function(){var t=AGN.Lib.Help;$(document).on("click","[data-help]",function(e){t.show($(this)),e.preventDefault()})}(),$(document).on("click","label",function(e){var t,i,n=$(this);t=$("#"+n.attr("for")),i=t.data("select2"),1==t.length&&i&&setTimeout(function(){i.opened()||i.open()},0)}),function(){var n=window.history;$(document).on("click",'a[href^="#"]',function(e){e.isDefaultPrevented()||(e.preventDefault(),function(e){if("#"===e)return;var t=window.location.href,i=t.indexOf("#");0<=i&&(t=t.substring(0,i));n.replaceState(n.state||{},document.title,t+e)}($(this).attr("href")))}),$(document).on("click","[data-one-time]",function(){var e=$(this);setTimeout(function(){e.attr("disabled","disabled"),e.is("a")&&e.removeAttr("href")},1)})}(),function(){var e=AGN.Lib.Action,t=AGN.Lib.Menu;e.new({click:".menu-close"},function(){t.close()}),e.new({click:".menu-open"},function(){t.open()}),e.new({click:".menu-open"},function(){t.open()}),$(document).on("click","main",function(){t.isOpen()&&t.close()}),$(document).on("")}(),function(){var e=AGN.Lib.Action,n=AGN.Lib.Messages;e.new({click:"[data-msg]"},function(){var e=this.el.data("msg"),t=this.el.data("msg-content"),i=this.el.data("msg-type");if("system"===this.el.data("msg-system")){if($(document).find(".notification-info").is(":visible"))return!1;n(e,t,i)}else n(e,t,i)}),$(document).on("click","a[data-msg]",function(e){e.preventDefault()})}(),function(){var e=AGN.Lib.Action,i=AGN.Lib.Modal,n=AGN.Lib.Helpers;e.new({click:"[data-modal]"},function(){var e=this.el.data("modal"),t=n.objFromString(this.el.data("modal-set"));i.createFromTemplate(t,e)}),$(document).on("hidden.bs.modal",".modal",function(){var e=$(this);e.trigger("modal:close"),setTimeout(function(){e.remove()},100)}),$.fn.modal.Constructor.prototype.enforceFocus=function(){var t=this;$(document).on("focusin.modal",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&$(e.target.parentNode).hasClass("cke_contents cke_reset")&&t.$element.focus()})}}(),AGN.Lib.Action.new({click:"[data-password]"},function(){var e=this.el.data("password"),t=this.el.data("password-toggle"),i=$(e);this.el.data("password-toggle",this.el.text()),this.el.text(t),"password"===i.prop("type")?i.prop("type","text"):i.prop("type","password"),this.event.preventDefault()}),$(document).on("click",".js-open-datepicker",function(e){$(this).parents(".input-group").find(".js-datepicker").pickadate("picker").open()}),$(document).on("click",".js-datepicker",function(e){var t=$(this);t.pickadate("picker").open(),t.focus()}),$(document).on("click",'[data-dismiss="popover"]',function(){var e=AGN.Lib.Popover.get($(this));e&&e.hide()}),function(){var e=AGN.Lib.Action;AGN.Lib.Modal,AGN.Lib.Helpers;e.new({click:"[data-popup]"},function(){var e=this.el.data("popup"),t=window.location.href,i=t.substring(0,t.lastIndexOf("/"));(!e||e.indexOf("://")<=0)&&(e=i+"/"+e),window.open(e,"help","width=800,height=600,left=0,top=0,scrollbars=yes")}),$(document).on("click","a[data-modal]",function(e){e.preventDefault()}),$(document).on("hidden.bs.modal",".modal",function(){var e=$(this);e.trigger("modal:close"),setTimeout(function(){e.remove()},100)})}(),function(){var e,t;e=function(){t&&clearTimeout(t),t=setTimeout(function(){AGN.Initializers.Equalizer(),AGN.Initializers.Truncate(),AGN.Initializers.Sizing(),AGN.Initializers.Scrollable(),AGN.Initializers.DropdownExpand(),_.each(AGN.Lib.Editor.all(),function(e){e.resize()}),$(window).trigger("viewportChanged")},500)},$(window).on("resize",e)}(),function(){var e=AGN.Lib.Action,a=AGN.Lib.Popover,s=AGN.Lib.Template,l=AGN.Lib.Helpers;e.new({click:"[data-support-type]"},function(){var e=this.el.data("support-type"),t={supportType:e,subject:"",subjectChangeable:!0},i=_.merge({},t,l.objFromString(this.el.data("support-options")));if("PROBLEM"==e||"FEATURE"==e){var n=$("#support-select-button");a.remove(n);var o=$('<div class="modal-backdrop in" style="opacity: 0.2;"></div>');o.appendTo("body");var r=a.new(n,{trigger:"manual",template:'<div class="popover bottom support-popover" style="width: 600px; margin-top: 16px;"><div class="popover-content popover-tile"></div></div>',html:!0,enableAgnRunAll:!0,content:s.text("support-popover-template",i)});r.show(),o.on("click",function(){r.hide()}),n.on("hidden.bs.popover",function(){o.remove()})}})}(),AGN.Lib.Action.new({"click change":"[data-sync-from]"},function(){var e=this.el.data("sync-from").split(/,\s?/),s=this.el.data("sync-to").split(/,\s?/);_.each(e,function(e,t){var i=$(e),n=$(s[t]),o=i.val(),r=n.attr("id"),a=n.data("_editor");window.CKEDITOR&&CKEDITOR.instances[r]?CKEDITOR.instances[r].setData(o):a?a.val(o):n.val(o)})}),$(document).on("click","a[data-sync-from]",function(e){e.preventDefault()}),function(){var o=AGN.Lib.Tile,r=AGN.Lib.Tab;$(document).on("click","[data-toggle-tab]",function(e){var t=$(this),i=o.trigger(t),n=t.data("toggle-tab-method")||"show";return o.show(i),r[n](t),e.preventDefault(),!1})}(),function(){var s=AGN.Lib.Form,o=AGN.Lib.Confirm,l=AGN.Lib.Helpers,c=AGN.Lib.Page;$(document).on("click",".js-table a, .js-table input, .js-table select, .js-table button, .js-table .js-checkable, .js-table .disabled",function(e){e.preventViewLoad=!0}),$(document).on("click",".js-table-sort",function(e){var t=$(this),i=t.children("a"),n=$(e.target),o=i.attr("href");if(n[0]==i[0]){if(s.getWrapper(t).exists()){var r=s.get(t),a=l.paramsFromUrl(o);_.each(a,function(e,t){r.setValue(t,e)}),r.submit()}else $.get(o).done(function(e){c.render(e,!1)});e.preventDefault()}}),$(document).on("click",".js-table-paginate",function(e){var t=$(this),i=t.attr("href"),n=s.get(t),o=l.paramsFromUrl(i);_.each(o,function(e,t){n.setValue(t,e)}),n.submit(),e.preventDefault();var r=t.closest(".tile");if(r.exists()){var a=r.offset().top;window.scrollY>a&&window.scrollTo(0,a-150)}else window.scrollTo(0,0)}),$(document).on("click",".js-row-delete",function(e){var i=$(this),t=i.is("button")?i.data("url"):i.attr("href"),n=s.get(i);t&&$.get(t).done(function(e){var t=$(e);1==t.filter(".modal").add(t.find(".modal")).length?o.create(e).done(function(e){i.closest("tr").remove(),n.updateHtml(e)}):n.updateHtml(e)}),e.preventDefault()}),$(document).on("click",".js-table tr",function(e){var t,i=$(this);e.preventViewLoad||void 0!==(t=i.data("link"))&&(window.location.href=t)}),$(document).on("click",'.js-checkable label, .js-checkable input[type="checkbox"], .js-checkable input[type="radio"]',function(e){e.stopPropagation()}),$(document).on("click",".js-checkable",function(e){var t,i;(t=$(this).find('input[type="checkbox"], input[type="radio"]')).length&&_.each(t,function(e){(i=$(e)).prop("disabled")||(i.prop("checked",!i.prop("checked")),i.trigger("change"))})}),$(document).on("click",".disabled",function(e){e.preventDefault()})}(),function(){var o=AGN.Lib.Tile;$(document).on("click","[data-toggle-tile]",function(e){o.toggle($(this)),e.preventDefault()}),$(document).on("click","[data-toggle-tile-all]",function(i){var n=$(this).data("toggle-tile-all");_.each($("[data-toggle-tile]"),function(e){var t=$(e);"expand"==n?o.show(t):o.hide(t),i.preventDefault()})})}(),$(document).on("change","[data-toggle-usability]",function(){var e=$(this).data("toggle-usability"),t=$(document).find(e);_.each(t,function(e){var t=$(e);t.prop("disabled")?t.prop("disabled",!1):t.prop("disabled",!0)})}),function(){var e=AGN.Lib.Action,t=AGN.Lib.View;e.new({change:"[data-view]"},function(){t.trigger(this.el),this.el.trigger("click.bs.dropdown.data-api")})}(),function(){var c=AGN.Lib.Form,t=AGN.Lib.Editor;$(document).on("tile:show",function(e){var t=$(e.target),i=t.find(".js-wysiwyg"),n=i.attr("id");if(1===i.length){var o=h(i),r=1==t.data("full-tags"),a=function(e,t){var i=t.data("browse-mailing-id");if(i)return i;var n=t.data("form-target"),o=n?$(n):t,r=c.get(o);(i=r.getValue("mailingID"))||(i=r.getValue("mailingId"));return i}(0,i),s=o?0:i.height(),l=o?i.parent().width():"100%";window.createEditorExt(n,l,s,a,r,o),o&&CKEDITOR.instances[n].on("instanceReady",function(n){return function(e){var t=n.parent().width(),i=n.parent().height();e.editor.resize(t,i),e.editor.resresize_enabledze=!1,$(window).on("resize."+d(n),u(n))}}(i))}}),$(document).on("tile:hide modal:close",function(e){$(e.target).find(".js-wysiwyg").each(function(){CKEDITOR.instances[$(this).attr("id")]&&CKEDITOR.instances[$(this).attr("id")].updateElement(),h($(this))&&$(window).off("resize."+d($(this))),t.get($(this)).val($(this).val()),window.removeEditor($(this).attr("id"))})}),$(document).on("form:submit",function(e){0<$(e.target).find(".js-wysiwyg").length&&window.removeAllEditors&&window.removeAllEditors()});var u=function(t){return function(){var e=t.parent();CKEDITOR.instances[t.attr("id")].resize(e.width(),e.height())}},d=function(e){return"ck-editor-"+e.attr("id")},h=function(e){return!!e.data("full-height-editor")}}(),AGN.Lib.Validator.new("length",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=e.val(),o=[];return n?0<=i.min&&n.length<i.min?o.push({field:e,msg:t("fields.errors.string_exceed_min_length",i.min)}):0<=i.max&&n.length>i.max&&o.push({field:e,msg:t("fields.errors.string_exceed_max_length",i.max)}):(0<i.min||!0===i.required)&&o.push({field:e,msg:t("fields.required.errors.missing")}),o}}),AGN.Lib.Validator.new("logon-new-password/form",{valid:function(){return!this.errors().length},errors:function(){var e=[],i=$("#password"),n=$("#password-repeat"),o=i.val();return $.trim(o)?o!=n.val()&&e.push({field:n,msg:t("fields.password.errors.notMatching")}):e.push({field:i,msg:t("fields.required.errors.missing")}),e}}),AGN.Lib.Validator.new("mailing-priorities/form",{valid:function(){return 0<$("#priorityCount").val()||(AGN.Lib.Messages(t("defaults.error"),t("error.mailing.invalidPriorityCount"),"alert"),!1)},errors:function(){return[]}}),AGN.Lib.Validator.new("max-length-validator",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=e.val(),o=[];return e.hasClass("js-wysiwyg")&&!n&&(n=$("#cke_"+e.attr("id")).find("iframe").contents().find("body").text()),n?n.length>i.max&&o.push({field:e,msg:t("fields.errors.contentLengthExceedsLimit",i.max)}):!0===i.required&&o.push({field:e,msg:t("fields.required.errors.missing")}),o}}),AGN.Lib.Validator.new("number",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=[],o=e.val();if(o){var r=!0===i.float?parseFloat(o):parseInt(o);isNaN(r)?n.push({field:e,msg:t("fields.errors.number_nan")}):r<i.min?n.push({field:e,msg:t("fields.errors.number_exceed_min",i.min)}):r>i.max?n.push({field:e,msg:t("fields.errors.number_exceed_max",i.max)}):!0===i.strict&&$.trim(o)!==r.toString()&&(!0===i.float?n.push({field:e,msg:t("fields.errors.number_not_double")}):n.push({field:e,msg:t("fields.errors.number_not_integer")}))}else!0===i.required&&n.push({field:e,msg:t("fields.required.errors.missing")});return n}}),AGN.Lib.Validator.new("phone-number",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=$.trim(e.val()),o=[];if(n){for(var r=0,a=!1,s=!1,l=0,c=0;c<n.length;c++){var u=n.charAt(c);if("0"<=u&&u<="9")l++,r=3;else if("."==u||"-"==u||"/"==u){if(3!=r&&6!=r){a=!0;break}r=4}else if("("==u){if(s){a=!0;break}r=5,s=!0}else if(")"==u){if(3!=r||!s){a=!0;break}s=!(r=6)}else if("+"==u){if(0!=r){a=!0;break}r=1}else if(!/\s/.test(u)){a=!0;break}}(a||s||l<3||20<l)&&o.push({field:e,msg:t("fields.errors.phone_number_invalid")})}else!0===i.required&&o.push({field:e,msg:t("fields.required.errors.missing")});return o}}),AGN.Lib.Validator.new("upload-file/form",{valid:function(e,i){var n=!0,o=$('[data-initializer="upload"]');return o.exists()&&o.data("upload-selection").length<1&&(AGN.Lib.Messages(t("defaults.error"),t("error.upload.file"),"alert"),n=!1),n&&!this.errors(e,i).length},errors:function(e,i){var n=[{field:$("#name"),maxLength:99},{field:$("#firstName"),maxLength:99},{field:$("#phone"),maxLength:99},{field:$("#email"),maxLength:99,regexpRules:[{regexp:/\S+@\S+\.\S{2,}/,message:t("error.upload.email")}]}],a=[];return n.forEach(function(e){var i=e.field,n=i.val();if(!n||n.length<3)a.push({field:i,msg:t("fields.required.errors.missing")});else if(e.maxLength&&n.length>e.maxLength)a.push({field:i,msg:t("fields.errors.contentLengthExceedsLimit",e.maxLength)});else if(e.regexpRules&&0<e.regexpRules.length)for(var o=0;o<e.regexpRules.length;++o){var r=e.regexpRules[o];if(!n.match(r.regexp))return void a.push({field:i,msg:r.message})}}),a}}),AGN.Lib.Controller.new("admin-enabling",function(){function e(e){return e?$("input:checkbox:not(:checked)[data-enabling="+e+"]"):$("input:checkbox:not(:checked)[data-enabling]")}this.addAction({click:"save-enabling"},function(){$("input[name*='enabledMailinglist']").remove(),e("mailinglist").each(function(){var e=$(this).data("mailinglist");$("<input>").attr({type:"hidden",name:"enabledMailinglist["+e+"]",value:"off"}).appendTo("#EnablingForm")}),$("#EnablingForm").submit()}),this.addAction({click:"toggle-checkboxes-on"},function(){e(this.el.data("enabling-scope")).each(function(){$(this).prop("checked",!0)})}),this.addAction({click:"toggle-checkboxes-off"},function(){(function(e){return e?$("input:checkbox:checked[data-enabling="+e+"]"):$("input:checkbox:checked[data-enabling]")})(this.el.data("enabling-scope")).each(function(){$(this).prop("checked",!1)})})}),AGN.Lib.Controller.new("allowed-profile-field-values",function(){var i=this;this.addInitializer("allowed-values",function(e){var t=(e=e||$(document)).find('[data-controller="allowed-profile-field-values"]');0!=t.length&&(i.container=t.find("table .js-allowed-value").first().parent())}),this.addAction({click:"addNewValue"},function(){var e=i.getRow(this.el),t=i.getField(e).val();e.remove(),i.appendRow(!1,t),i.appendRow(!0)}),this.addAction({click:"deleteValue"},function(){i.getRow(this.el).remove()}),this.appendRow=function(e,t){var i=AGN.Lib.Template.dom("allowed-value-new-row",{isLastRow:e});t&&this.getField(i).val(t),this.container.append(i)},this.getRow=function(e){return e.closest("tr.js-allowed-value")},this.getField=function(e){return e.find('input[name="allowedValues"]')}}),AGN.Lib.Controller.new("auto-import-export",function(){function r(){var e=$("#tile-importexport-schedule-time").find("select[name=dayOfTheWeek]"),n=[];return e.each(function(){var i={},e=$(this).parents("tr"),t=e.find(".hour-checkbox");i.weekDay=e.find("select[name=dayOfTheWeek]").val(),i.scheduledTime=[],e.find(".schedule-time-wrapper").each(function(){var e=$(this).find(".time-checkbox"),t={active:e.is(":checked")&&!e.is(":disabled"),time:$(this).find(".time-input").val()};i.scheduledTime.push(t)}),i.scheduledInterval={active:t.is(":checked")&&!t.is(":disabled"),interval:e.find("select.hour-select").val()},n.push(i)}),n}function n(){var e=r();$("input[name=intervalAsJson]").val(JSON.stringify(e))}function o(){var e=this.el,t=e.attr("disables"),i=e.is(":checked");e.parents(".schedule-settings-wrapper").find(t).prop("disabled",i)}function a(){for(var e,t=this.el,i=t.attr("disables"),n=t.is(":checked"),o=t.parents(".schedule-settings-wrapper"),r=t.parents("tr").find(".time-checkbox"),a=o.find(".hour-checkbox"),s=0;s<r.length;s++){var l=r[s],c=$(l);if(t[0]!==l&&c.is(":checked")){e=!0;break}}a.is(":disabled")&&e||!u.extended||o.find(i).prop("disabled",n)}function s(e){1!==e.find('[data-action="remove-day"]').length&&e.find('[data-action="add-another-day"]').parent().append(p.clone())}function l(e){e.find("select2-container").remove(),e.find("select").removeAttr("style"),e.find("select").removeAttr("tabindex"),e.find("select").removeAttr("title")}var u,c,d,h=$('<div class="input-group-addon"><a href="#" class="btn btn-regular btn-alert" data-action="remove-schedule"><i class="icon icon-trash-o"></i></a></div>'),p=$('<a href="#" class="btn btn-regular" data-action="remove-day"><i class="icon icon-trash-o"></i><span class="text">'+t("defaults.delete")+"</span></a>"),f=$('<div class="form-control-feedback-message js-form-error-msg">'+t("error.delay.60")+"</div>"),g={},i=!1,m=new A,v=new e,y=function(e,o){var r=e.find(".schedule-settings-wrapper");e.find("select[name=dayOfTheWeek]").val(o.weekDay),e.find(".hour-checkbox").prop("checked",o.scheduledInterval.active),e.find("select.hour-select").val(o.scheduledInterval.interval),o.scheduledTime.forEach(function(e,t){if(0===t){var i=r.find(".schedule-time-wrapper");1<o.scheduledTime.length&&i.find(".input-group").append(h.clone()),b(i,e),r.append(i)}else{var n=C();b(n,e),r.append(n)}})},b=function(e,t){e.find(".time-checkbox").prop("checked",t.active),e.find(".time-input").val(t.time)},w=function(e){var t={"hour-checkbox-toggle":o,"time-checkbox-toggle":a};for(var i in t)e.find("input[data-action="+i+"]").each(function(){t[i].call({el:$(this)})})},C=function(){var e=$(".schedule-time-wrapper.prime").clone();return l(e),e.removeClass("prime"),e};function e(){this.exportType="",this.mailingType=-1,this.oneTimeOption="",this.oneTimeOptionValues={checked:!1,disabled:!1}}function A(){}this.addInitializer("optionsChangeable",function(){$("#recipient-autoimport-csvdescription").length&&$('[data-action="options-availability"][value="ReferenceTable"]').prop("disabled",!1)}),this.addAction({click:"add-schedule"},function(){var e=this.el.parents(".schedule-time-wrapper"),i=d.clone(),n=e.parents("tr").find(".hour-checkbox");i.find("#hours").parent().append("<span>"+t("time.interval")+" "+t("time.60")+"</span>"),i.find(".input-group").append(h.clone()),0===e.find(".btn-alert").length&&e.find(".input-group").append(h.clone()),e.parent().append(i),o.call({el:n}),AGN.runAll(i)}),this.addAction({click:"time-checkbox-toggle"},a),this.addAction({click:"hour-checkbox-toggle"},o),this.addAction({click:"add-another-day"},function(){var e,t=this.el.parents("tbody").find("tr").first(),i=this.el.parents("tbody");1===i.find("tr").length&&(s(c),s(i)),e=c.clone(),t.parent().append(e),AGN.runAll(e),n()}),this.addAction({click:"remove-schedule"},function(){var e=this.el.parents(".schedule-time-wrapper"),t=e.parents("tr"),i=this.el.parents(".schedule-settings-wrapper");e.remove(),w(t),1===i.find(".schedule-time-wrapper").length&&i.find(".btn-alert").parent().remove(),n()}),this.addAction({change:"auto-import-export-validation"},function(){var e=r(),t=this.el,i=$(this.el).parents("tr"),n=this.el.find(".time-input"),o=i.find("select[name=dayOfTheWeek]").val();m.valid(e,o)?(t.removeClass("has-alert has-feedback js-form-error"),t.find(".js-form-error-msg").remove()):(t.addClass("has-alert has-feedback js-form-error"),n.after(f.clone())),$("input[name=intervalAsJson]").val(JSON.stringify(e))}),this.addAction({click:"remove-day"},function(){this.el.parents("tr").remove(),1===$("tbody").find("tr").length&&$("tbody").find('[data-action="remove-day"]').remove(),n()}),this.addAction({click:"check-ftp-server"},function(){return document.getElementById("action_method").value="checkConnectionStatus",document.getElementById("recipient-autoimport-form").submit(),!1}),this.addDomInitializer("auto-import-export-init",function(e){u=e.json();var t=JSON.parse($("input[name=intervalAsJson]").val()),i=$("tr.l-time-schedule-row");1<t.length&&i.find('[data-action="add-another-day"]').parent().append(p.clone()),(c=i.clone()).removeClass("l-time-schedule-row"),l(c),d=$(".schedule-time-wrapper").clone(),function(e){var i,n=$("#tile-importexport-schedule-time").find("tbody");e.forEach(function(e,t){0===t?(i=n.find("tr"),y(i,e)):(i=c.clone(),y(i,e),n.append(i)),w(i)}),AGN.runAll(n)}(t||[])}),this.addDomInitializer("mailing-options-attribute-resolver",function(e){v.config(e,this.config)}),this.addAction({change:"change-mailing-type"},function(){v.setProperlyFieldState($(this.el).val())}),this.addAction({change:"export-type-resolver"},function(){v.setExportType($(this.el).find("[type=radio]:checked").val()),v.setProperlyFieldState($("#exportMailing select").val())}),e.prototype.config=function(e,t){if(e&&t){this.element=e,this.exportType=t.exportType||"",this.mailingType=0<=t.mailingType?t.mailingType:-1,this.oneTimeOption=t.oneTimeOption||"";var i=$('input[name="'+this.oneTimeOption+'"]');this.oneTimeOptionValues={checked:i.is(":checked"),disabled:i.is(":disabled")},this.setOneTimeValue()}},e.prototype.setExportType=function(e){this.exportType=e||""},e.prototype.setMailingType=function(e){this.mailingType=e||-1},e.prototype.isAfterMailingDeliveryType=function(){return"Mailing"==this.exportType&&0==this.mailingType},e.prototype.setOneTimeValue=function(){var e=this.isAfterMailingDeliveryType()||this.oneTimeOptionValues.checked,t=this.isAfterMailingDeliveryType()||this.oneTimeOptionValues.disabled,i=$('input[name="'+this.oneTimeOption+'"]');i.prop("checked",e?"checked":""),i.prop("disabled",t?"checked":"")},e.prototype.setProperlyFieldState=function(e){this.setMailingType(e),this.setOneTimeValue()},A.prototype.prepareTimeBy=function(e){var t=[];return e.forEach(function(e){e.active&&t.push(parseInt(e.time.replace(":","")))}),t},A.prototype.valid=function(e,t){var i=[];return e.forEach(function(e){0===e.weekDay&&(i=e.scheduledTime),e.weekDay===t&&e.scheduledTime.forEach(function(e){i.push(e)})}),(i=this.prepareTimeBy(i)).every(this.hasCorrectInterval)},A.prototype.hasCorrectInterval=function(t,e,i){var n=!0;return i.splice(e,1),i.forEach(function(e){Math.abs(e-t)<100&&(n=!1)}),n},this.addDomInitializer("import-profile-mailing-lists",function(){var e=this.config;i=e.isAutoImportNew,g=e.profileMailinglists;var t=$('[name="'+e.profileIdPropertyName+'"]').val();E(t,i)}),this.addAction({change:"change-import-profile"},function(){var e=$(this.el).val();E(e,i)});var E=function(e,t){if(t){var i=g[e];$('input[type=checkbox][name^="mailinglist"]').prop("checked",!1),_.each(i,function(e){$('input[type=checkbox][name="mailinglist['+e+']"]').prop("checked",!0)})}}}),AGN.Lib.Controller.new("available-building-blocks",function(){var n,o,t;function i(){var e=$(t.form).find(".table-controls .well");e.first().html(e.last().html())}function r(){t&&t.setValue("changedBlockStatusJson",JSON.stringify(n,function(e,t){if(null!=t)return t}))}this.addDomInitializer("available-building-blocks",function(){n={},o={};var e=this.el;t=AGN.Lib.Form.get(e),this.config.changedBlockStatus&&(n=JSON.parse(this.config.changedBlockStatus))}),this.addDomInitializer("available-building-blocks-table",function(){var e=this.config.divContainerList;_.each(e,function(e){var t=e.id,i=e.active;t in o?t in n&&$("input:checkbox[data-block-id="+t+"]").prop("checked",!!n[t]):o[t]=i}),i()}),this.addAction({click:"update-changed-data"},function(){var e=this.el;i(),r(),t.setActionOnce(e.data("form-url")),t.setResourceSelectorOnce(e.data("form-resource")),t.submit()}),this.addAction({change:"change-activation"},function(){var e=this.el,t=e.data("block-id"),i=e.is(":checked");i==o[t]?t in n&&delete n[t]:n[t]=i}),this.addAction({change:"activate-all"},function(){var e=this.el,t=$("input:checkbox[data-block-id]");t.prop("checked",e.is(":checked")),t.change()}),this.updateTableControls=i,this.updateFormData=r}),AGN.Lib.Controller.new("birt-reports",function(){var t,n,r={},i=0,a=[],s=[];this.addDomInitializer("birt-reports",function(){r=this.config,n=r.constant.MAILING_ID,t=r.constant.AFTER_MAILING_TYPE_ID,a=r.filtered.FILTER_ARCHIVE,s=r.filtered.FILTER_MAILINGLIST,i=r.reportType}),AGN.Lib.Action.new({change:"input[type=radio][name=type]"},function(){var e=$(this.el).val();return e==t?_.each($(r.reportSettingsId).find("[data-toggle-tab]"),function(e){var t=$(e),i=t.data("toggle-tab");i.endsWith(n)?t.click():(t.parent("li").addClass("disabled"),AGN.Lib.Tab.hide($(i)))}):i==t&&_.each($(r.reportSettingsId).find("[data-toggle-tab]"),function(e){$(e).parent("li").removeClass("disabled")}),i=e,!1}),this.addDomInitializer("report-settings",function(){var e=this.el,t=this.config;new o(e,t)});var o=function(e,t){var i=this;this.container=e,this.config=t,this.settingsType=t.settingsType,this.select=AGN.Lib.Select.get(e.find(t.selectors.filterBlockId)),this.mailingSelect=AGN.Lib.Select.get(e.find(t.selectors.normalMailing)),i.init(t),e.find(t.selectors.mailingType).on("change click",function(e){i.handleMailingTypeChanges($(e.target))}),e.find(t.selectors.mailingFilter).on("change",function(e){i.handleMailingFilterChanges($(e.target))}),e.find(t.selectors.filterBlockId).on("change",function(e){i.handleMailingFilterValueChanges($(e.target))})};o.prototype.init=function(e){var t=e.data.mailingType,i=e.data.mailingFilter,n=e.data.predefineMailing,o=e.data.selectedMailings;this.updateAllComparisonDependentFields(t,i,n,o)},o.prototype.handleMailingTypeChanges=function(e){var t=this.getMailingFilterValue(),i=this.getMailingFilterValue();this.updateNormalMailingField(e.val(),t,i)},o.prototype.handleMailingFilterChanges=function(e){var t=this.getMailingType();this.updateAllComparisonDependentFields(t,e.val())},o.prototype.handleMailingFilterValueChanges=function(e){var t=this.getMailingFilter(),i=this.getMailingType();this.updateNormalMailingField(i,t,e.val())},o.prototype.updateAllComparisonDependentFields=function(e,t,i,n){var o=this;if(o.select.resetOptions(),0<t){var r=[];1==t?r=a:2==t&&(r=s),_.each(r,function(e){o.select.addFormattedOption('<option value="'+e.id+'">'+e.shortname+"</option>")}),o.select.selectValueOrSelectFirst(i),i=o.select.getSelectedValue()}o.updateNormalMailingField(e,t,i,n)},o.prototype.updateNormalMailingField=function(e,t,i,n){var o=this;o.mailingSelect.resetOptions(),(o.settingsType==r.constant.COMPARISON_SETTINGS&&2==e||o.settingsType==r.constant.MAILING_SETTINGS&&3==e)&&$.ajax({type:"POST",url:r.urls.FILTERED_MAILING_URL,data:{type:t,value:i||0,mailingType:r.constant.NORMAL_MAILING_TYPE}}).done(function(e){_.each(e,function(e){o.mailingSelect.addFormattedOption('<option value="'+e.id+'">'+e.shortname+"</option>")}),o.mailingSelect.selectValue(n||"")})},o.prototype.getMailingFilter=function(){var e=this.container.find(this.config.selectors.mailingFilter);return 0|parseInt(e.val())},o.prototype.getMailingFilterValue=function(){var e=this.select.getSelectedValue();return 0|parseInt(e)},o.prototype.getMailingType=function(){var e=this.container.find(this.config.selectors.mailingType+":checked");return 0|parseInt(e.val())}}),AGN.Lib.Controller.new("blacklist-list",function(){var o,e=AGN.Lib.Confirm;this.addDomInitializer("blacklist-list-init",function(){o=this.el}),this.addAction({click:"saveBlacklist"},function(){var e=this.el,t=AGN.Lib.Form.get(e),i=e.data("url"),n={email:o.find("#new-blacklist").val()};$.ajax(i,{type:"POST",data:n,success:function(e){AGN.Lib.Page.render(e),t.submit()}})}),this.addAction({click:"blacklist-delete"},function(){e.get(this.el).promise().done(function(e){AGN.Lib.Page.render(e),$("#blacklistListView").submit()})})}),AGN.Lib.Controller.new("company-tech-emails",function(){function e(){var e=o.find(r);1===e.length&&e.find(".btn-alert")&&e.find(".btn-alert").remove()}function t(e,t,i){var n=AGN.Lib.Template.text("email-input",{email:t});i?e.closest(r).after(n):e.append(n),_.each(o.find(r),function(e){var t=$(e);0===t.find(".btn-alert").length&&t.find(".input-group-btn").append(AGN.Lib.Template.text("remove-button",{}))})}function i(){$('input[name="'+n+'"]').val(function(){var i=[];return _.each(o.find(r+" input"),function(e){var t=e.value;""!==t.trim()&&i.push(t)}),i}().join(", "))}var o=this.el,r="",n="";this.addDomInitializer("company-emails-list",function(){o=this.el,n=o.data("target-field")||"",r=o.data("row-selector")||"",_.each(function(){var e=[""],t=$('input[name="'+n+'"]').val();return t&&(e=t.split(", ")),e}(),function(e){t(o,e,!1)}),e()}),this.addAction({click:"deleteContactEmail"},function(){this.el.closest(r).remove(),e(),i()}),this.addAction({click:"createContactEmail"},function(){t(this.el,"",!0),i()}),this.addAction({change:"inputValue"},function(){i()})}),AGN.Lib.Controller.new("custom-thumbnail-view",function(){function o(e,t,i){var n;(n=e.data("preview-name"))&&$(n).text(t),(n=e.data("preview-image"))&&(i?$(n).prop("src",i):$(n).each(function(){var e=$(this);e.prop("src",e.data("no-preview-src")||"")}))}this.addAction({change:"use-custom-thumbnail"},function(){$("#customThumbnailFile").prop("name",this.el.is(":checked")?"customThumbnailFile":"")}),this.addAction({change:"custom-thumbnail-image"},function(){var t=this.el,e=t.prop("files");if(e&&e.length){var i=e[0];if("image"==i.type||i.type.match("image/.*")){var n=new FileReader;n.onload=function(e){o(t,i.name,e.target.result)},n.readAsDataURL(i)}else AGN.Lib.Helpers.clearFormField(t),o(t,"","")}else o(t,"","")})}),AGN.Lib.Controller.new("dashboard",function(){var r,t,e=this;function i(e){jQuery.ajax({type:"POST",url:t.urls.STATISTICS,data:{mailingId:e},success:function(e){var t,i,n;e=_.merge({common:[["no Data","0"]],clickers:[["no Data","0"]],clickersPercent:[0],openers:[["no Data","0"]],openersPercent:[0]},e),t=[],i=[];for(var o=0;o<e.common.length;o++){var r=parseInt(e.common[o][1]);t.push(e.common[o][0]),i.push(r)}c3.generate(AGN.Lib.DashboardStatisticsService.data.statChartData.build(t,i)),t=[],i=[];for(o=n=0;o<e.clickers.length;o++){r=l(100*e.clickers[o][1],1);t.push(e.clickers[o][0]),i.push(r),n+=r}if(!isNaN(n)&&0<n)for(o=0;o<i.length;o++)t[o]+=" "+l(100*i[o]/n,1)+"%";var a=l(100*e.clickersPercent[0],1)+"%*";c3.generate(AGN.Lib.DashboardStatisticsService.data.clickChartData.build(a,t,i)),t=[],i=[];for(o=n=0;o<e.openers.length;o++){r=l(100*e.openers[o][1],1);t.push(e.openers[o][0]),i.push(r),n+=r}if(!isNaN(n)&&0<n)for(o=0;o<i.length;o++)t[o]+=" "+l(100*i[o]/n,1)+"%";var s=l(100*e.openersPercent[0],1)+"%*";c3.generate(AGN.Lib.DashboardStatisticsService.data.viewChartData.build(s,t,i)),AGN.Initializers.Equalizer()}})}function l(e,t){return 1*parseFloat(e).toFixed(t)}function n(){var e="MESSAGE",t=0;if(u("MESSAGE")<1){var i=!1;for(var n in r)if(r.hasOwnProperty(n)){var o=c(n);t<o&&(t=o,e=n,i=!0)}if(!i)for(n in r)r.hasOwnProperty(n)&&t<(o=u(n))&&(t=o,e=n)}AGN.Lib.Modal.createFromTemplate({openedNewsType:e},"modal-news"),$("#buttonNewsCounter").text(""),$(".l-news-menu-item").each(function(e){var t=c($(this).data("news-type"));0<t?$(this).find(".l-news-menu-counter").text(t):$(this).find(".l-news-menu-counter").html("&nbsp;"),$(this).hasClass("active")&&a($(this).data("news-type"))}),s()}function a(e){0<c(e)&&($("#newsCounter"+e).html("&nbsp;"),$.ajax({url:AGN.Lib.Helpers.objFromString($('[data-initializer="dashboard-news-counters"]').data("config")).newsDateUrl,data:{type:e}}),r[e].unreadCount=0,s())}function s(){var e=c("NEWS"),t=$("#buttonNewsCounter");return 0<e?(t.parent().removeClass("hidden"),t.parent().parent().css("padding-top","4px"),t.parent().parent().css("padding-bottom","4px"),t.text(e)):(t.parent().addClass("hidden"),t.parent().parent().css("padding-top","5px"),t.parent().parent().css("padding-bottom","5px"),t.text("")),e}function c(e){return null!=r&&null!=r[e]&&Number.isInteger(r[e].unreadCount)?r[e].unreadCount:0}function u(e){return null!=r&&null!=r[e]&&Number.isInteger(r[e].availableCount)?r[e].availableCount:0}this.addAction({click:"open-mailing-statistics"},function(){0<t.mailingId&&AGN.Lib.Page.reload(t.mailingStatisticsLinkPattern.replace("{mailing-id}",t.mailingId))}),this.addAction({change:"update-template-links"},function(){e.runInitializer("UpdateDashboardTemplateLinks")}),this.addDomInitializer("dashboard-statistics",function(){0<(t=this.config).mailingId&&i(t.mailingId)}),this.addAction({change:"statistics-select-mailing"},function(){return t.mailingId=this.el.val(),i(t.mailingId),!1}),this.addDomInitializer("dashboard-news-counters",function(e){var t=AGN.Lib.Helpers.objFromString(e.data("config"));$.ajax({url:t.newsCountersUrl}).done(function(e){null!=e.counters&&(r=e.counters,s(),c("MESSAGE")&&!$(".modal-news").exists()&&n())})}),this.addAction({click:"showNewsPopup"},function(){n()}),this.addAction({click:"chooseNewsType"},function(){a(this.el.parent().data("news-type"))}),Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},this.addInitializer("UpdateDashboardTemplateLinks",function(e){var t=(e=e||$(document)).find(".js-template-link"),n=$('[data-action="update-template-links"]').val();_.each(t,function(e){var t=$(e),i=t.attr("href");i=i.replace(/templateID=\d+/,"templateID="+n),t.attr("href",i)})}),this.addInitializer("EndlessScroll",function(e){var t=(e=e||$(document)).find(".js-endless-scroll");t.length<1||t.each(function(e){var t=1,i=$(this);i.endlessScroll({pagesToKeep:null,fireOnce:!0,fireDelay:1e3,loader:"",insertAfter:".js-endless-scroll .js-endless-scroll-content",ceaseFire:function(){return 0!==i.find(".message-list-item-last").length},callback:function(){var e;return AGN.Lib.Loader.prevent(),e=$.ajax({method:"GET",url:i.data("url"),data:{page:t+1}}),i.find(".js-endless-scroll-content").append('<div class="message-list-loader"><i class="icon icon-refresh icon-spin"></i></div>'),e.done(function(e){t+=1,i.find(".js-endless-scroll-content").append(e),i.find(".message-list-loader").remove(),AGN.Initializers.IconsDefs(i)}),e}})})})}),AGN.Lib.Controller.new("device-statistic",function(){var i,n,o,r;this.addDomInitializer("device-statistic-initializer",function(){var e=this.config,t=e.activeStatisticId;i=e.HTML_URL,n=e.htmlBlockSelector,o=e.exportBlockSelector,r=e.typeFieldName,_.each($('[data-action="switch-device-tab"]'),function(e){$(e).data("type")===t&&e.click()})}),this.addAction({click:"switch-device-tab"},function(){var e=$(this.el).data("type");$(n).find("iframe").attr("src",function(e){return i.replace("{stat-type}",e)}(e)),$(o).html(function(e){return AGN.Lib.Template.text("statistic-csv-view",{type:e})}(e)),$('[name="'+r+'"]').val(e)})}),AGN.Lib.Controller.new("emm-activeness",function(){function r(e){var t=$('[data-action="save"]'),i=0;for(var n in e)if(e.hasOwnProperty(n)){i++;break}0<i?t.removeClass("disabled"):t.addClass("disabled")}this.addAction({click:"save"},function(){var e=$(this.el),t=AGN.Lib.Form.get(e),i=e.closest("[data-controller]").data("_states")||{};for(var n in i)i.hasOwnProperty(n)&&t.setValueOnce("activeness["+n+"]",i[n]);t.submit()}),this.addAction({change:"toggle-active"},function(){var e=$(this.el),t=e.closest("[data-controller]"),i=t.data("_states")||{},n=e.data("item-id"),o=e.is(":checked");o==e.data("initial-state")?function(e,t){delete e[t],r(e)}(i,n):function(e,t,i){e[t]=i,r(e)}(i,n,o),t.data("_states",i)}),this.addAction({click:"back"},function(){history.back()})}),AGN.Lib.Controller.new("enlarged-content-editor-controller",function(){var i=AGN.Lib.Modal,t=AGN.Lib.Confirm;this.addDomInitializer("enlarged-content-editor-initializer",function(e){var t=i.get(e);t.content,r(t.editorType)}),this.addAction({click:"updateContent"},function(){var e=$(this.el);t.get(e).positive(n()),$("#enlarged_content_modal").modal("toggle")});var n=function(){return{content:e(),editorType:o()}},e=function(){var e=$("#tab-enlargedContent-wysiwyg"),t=$("#enlargedContentEditor");return e.is(":visible")?CKEDITOR.instances.enlargedContent.getData():t.is(":visible")?ace.edit("enlargedContentEditor").getValue():void 0},o=function(){return $("#tab-enlargedContent-wysiwyg").is(":visible")?"wysiwyg":$("#enlargedContentEditor").is(":visible")?"html":""},r=function(e){if(e&&""!==e){var t=$('[data-toggle-tab$="'+e+'"]');t&&t.click()}}}),AGN.Lib.Controller.new("grid-building-block-defaults",function(){var c,i=AGN.Lib.Confirm,o=AGN.Lib.Form,n=AGN.Lib.Page,u=AGN.Lib.Helpers;function d(e){var t=e.closest("[data-placeholder-id]");return t.exists()?parseInt(t.data("placeholder-id")):0}function r(t){i.request(c.urls.MEDIAPOOL_IMAGE_PICK).done(function(e){$("#content-"+t).val(e.id),u.clearFormField($("#file-"+t)),s(t,e.src,e.name,e.title)})}function s(e,t,i,n){var o=$("#preview-"+e),r=$("#file-name-"+e);o.attr("src")!==t&&o.attr("src",t||c.noPreviewImageLink),o.attr("title",n||""),r.text(i||"")}this.addDomInitializer("grid-building-block-defaults",function(){c=this.config});var a=_.throttle(function(e,t){var i=$("#preview-"+e);i.attr("src")!==t&&i.attr("src",t||c.noPreviewImageLink)},300);this.addAction({click:"delete"},function(){var e=$.post(c.urls.CONFIRM_DELETE);return i.request(e).done(function(e){!0===e.success?n.reload(c.urls.BACK,!0).done(function(){AGN.Lib.JsonMessages(e.popups)}):AGN.Lib.JsonMessages(e.popups)})}),this.addAction({click:"chooseImage"},function(){var e=d(this.el);0<e&&(!function(e){var t=$("#file-"+e);return!!t.exists()&&!!t.val()}(e)?r(e):$("#file-"+e).trigger("click"))}),this.addAction({click:"showMediapoolDialog"},function(){var e=d(this.el);0<e&&r(e)}),this.addAction({change:"chooseImageFile"},function(){var e=d(this.el);0<e&&function(e,t){var i=e.prop("files"),n=$("#content-"+t),o=$("#image-category-"+t).closest(".form-group");if(i&&i.length){var r=i[0];if("image"===r.type||r.type.match("image/.*")){var a=new FileReader;a.onload=function(e){o.removeClass("hidden"),s(t,e.target.result,r.name,r.name)},a.readAsDataURL(r)}else o.addClass("hidden"),u.clearFormField(e),s(t)}else o.addClass("hidden"),s(t);n.val("")}(this.el,e)}),this.addAction({click:"deleteImage"},function(){var e=d(this.el);0<e&&function(e){var t=$("#file-"+e),i=$("#file-name-"+e),n=$("#content-"+e),o=$("#preview-"+e);u.clearFormField(t),i.text(""),n.val(""),o.attr("src",c.noPreviewImageLink)}(e)}),this.addAction({change:"previewImageLink",keyup:"previewImageLink",mouseup:"previewImageLink"},function(){var e=d(this.el);0<e&&a(e,$.trim(this.el.val()))}),this.addAction({click:"chooseImageLink"},function(){var e=d(this.el);0<e&&$("#content-"+e).focus()}),this.addAction({click:"save"},function(){(function(){var i=$.Deferred(),a=[],e=$("#defaultsForm"),s=o.get(e),l=!0;if(e.find("input[type=file]").each(function(){var e=$(this),i=d(e),n=$("#image-category-"+i),o=e.prop("files");if(o&&o.length){var r=n.val();0<r?(a.push({placeholderId:i,image:o[0],categoryId:r}),s.cleanFieldError$(n)):(l=!1,s.showFieldError$(n,t("error.grid.noCategorySelected")))}else s.cleanFieldError$(n)}),l)if(a.length){var n=new FormData;a.forEach(function(e,t){n.append("images["+t+"].file",e.image),n.append("images["+t+"].title",e.image.name),n.append("images["+t+"].categoryId",e.categoryId)}),$.ajax(c.urls.MEDIAPOOL_IMAGE,{type:"POST",dataType:"json",accepts:["application/json"],enctype:"multipart/form-data",processData:!1,contentType:!1,data:n}).done(function(e){!0===e.success?(e.data.forEach(function(e,t){var i=a[t].placeholderId;$("#content-"+i).val(e),u.clearFormField($("#file-"+i))}),i.resolve()):(AGN.Lib.JsonMessages(e.popups),i.reject())}).fail(function(){i.reject()})}else i.resolve();else i.reject();return i.promise()})().done(function(){$("#defaultsForm").submit()})})}),AGN.Lib.Controller.new("grid-building-block",function(){var t,i=AGN.Lib.Confirm,n=AGN.Lib.Page;this.addDomInitializer("grid-building-block",function(){t=this.config}),this.addAction({click:"delete"},function(){var e=$.post(t.urls.CONFIRM_DELETE);return i.request(e).done(function(e){!0===e.success?n.reload(t.urls.BACK,!0).done(function(){AGN.Lib.JsonMessages(e.popups)}):AGN.Lib.JsonMessages(e.popups)})})}),AGN.Lib.Controller.new("grid-building-blocks-new",function(){var a,n=AGN.Lib.Confirm,o=AGN.Lib.Form,s={setSaveButtonEnabled:function(e){var t=$("#save-button");e?t.removeClass("disabled"):t.addClass("disabled")},getActivenessToggles:function(){return $("#containers").find("input.js-activeness-toggle")},getActivenessTogglesMap:function(){var t={};return s.getActivenessToggles().each(function(){var e=$(this);t[e.data("container-id")]=e}),t},getActivenessTogglesStateMap:function(){var t={};return s.getActivenessToggles().each(function(){var e=$(this);t[e.data("container-id")]=e.prop("checked")}),t},getBulkIds:function(){var t=[];return $("#containers").find(".js-bulk-ids:checked").each(function(){var e=parseInt($(this).val());0<e&&t.push(e)}),t.length?t:null},resetBulkIds:function(){$("#containers").find(".js-bulk-ids").prop("checked",!1)}};function r(){this.map={}}function l(o,r){var e={};r=arguments.length<2||!!r;for(var t=0;t<o.length;t++)e[o[t]]=r;return i(e).done(function(e){if(!0===e.success){for(var t=s.getActivenessTogglesMap(),i=0;i<o.length;i++){var n=o[i];t[n].prop("checked",r),a.activenessInitialStateMap[n]=r}a.activenessChangeMap.excludeAll(o),s.resetBulkIds(),s.setSaveButtonEnabled(0<a.activenessChangeMap.size())}})}function i(e){return $.post(a.urls.SET_ACTIVENESS,{activeness:e}).done(function(e){AGN.Lib.JsonMessages(e.popups)})}r.prototype.include=function(e,t){this.map[e]=t},r.prototype.exclude=function(e){delete this.map[e]},r.prototype.excludeAll=function(e){for(var t=0;t<e.length;t++)delete this.map[e[t]]},r.prototype.clear=function(){this.map={}},r.prototype.size=function(){return Object.keys(this.map).length},r.prototype.get=function(){return _.clone(this.map)},this.addDomInitializer("grid-building-blocks-new",function(){if(a=this.config,location.hash){var e=parseInt(location.hash.substr(1));if(0<e){var t=$("#containers"),i=t.find('[data-container-id="'+e+'"]').closest("tr");if(i.exists()){var n=i.position().top;t.scrollTop(n-10)}}}a.activenessChangeMap=new r,a.activenessInitialStateMap=s.getActivenessTogglesStateMap()}),this.addAction({click:"save"},function(){var t=o.get(this.el);i(a.activenessChangeMap.get()).done(function(e){!0===e.success&&(a.activenessChangeMap.clear(),a.activenessInitialStateMap=s.getActivenessTogglesStateMap(),s.setSaveButtonEnabled(!1),t.submit())})}),this.addAction({change:"toggle-activated"},function(){var e=$(this.el),t=e.data("container-id"),i=e.is(":checked");a.activenessInitialStateMap[t]==i?a.activenessChangeMap.exclude(t):a.activenessChangeMap.include(t,i),s.setSaveButtonEnabled(0<a.activenessChangeMap.size())}),this.addAction({click:"delete-building-block"},function(){var e=this.el.data("container-id"),t=o.get(this.el);0<e&&function(e){var t=$.post(a.urls.CONFIRM_DELETE.replace("{containerId}",e));return n.request(t).done(function(e){AGN.Lib.JsonMessages(e.popups)})}(e).done(function(e){!0===e.success&&t.submit()})}),this.addAction({click:"bulk-delete"},function(){var e=s.getBulkIds(),i=o.get(this.el);e?function(e){var t=$.ajax(a.urls.CONFIRM_BULK_DELETE,{method:"POST",traditional:!0,data:{bulkIds:e}});return n.request(t).done(function(e){AGN.Lib.JsonMessages(e.popups)})}(e).done(function(e){!0===e.success&&i.submit()}):AGN.Lib.Messages(t("Error"),t("messages.error.nothing_selected"),"alert")}),this.addAction({click:"bulk-activate"},function(){var e=s.getBulkIds(),i=o.get(this.el);e?l(e,!0).done(function(e){!0===e.success&&i.submit()}):AGN.Lib.Messages(t("Error"),t("messages.error.nothing_selected"),"alert")}),this.addAction({click:"bulk-deactivate"},function(){var e=s.getBulkIds(),i=o.get(this.el);e?l(e,!1).done(function(e){!0===e.success&&i.submit()}):AGN.Lib.Messages(t("Error"),t("messages.error.nothing_selected"),"alert")}),this.addAction({click:"back"},function(){history.back()})}),AGN.Lib.Controller.new("grid-edit-new",function(){var t=this,i=AGN.Lib.Form;this.addDomInitializer("grid-edit-new",function(){t.isGridInUse=this.config.isGridInUse,t.gridView=new AGN.Lib.GridView($("[data-grid-view]")),t.gridColumnView=new AGN.Lib.GridColumnView($("[data-column-view]")),t.updateViews()}),this.addAction({submission:"createTemplate"},function(){$("#templateCreationForm").submit()}),this.addAction({submission:"saveGrid"},function(){var e=$("#gridForm");i.get(e).submit()}),this.addAction({change:"updateColnum"},function(){t.validateRequiredNumber(this.el,1,12),$('[name="columnWidth"]').val(t.calculateColumnWidth()),t.updateViews()}),this.addAction({change:"updateTemplateWidth"},function(){t.validateRequiredNumber(this.el,50,2e3),$('[name="columnWidth"]').val(t.calculateColumnWidth()),t.updateViews()}),this.addAction({change:"updateColumnWidth"},function(){t.validateRequiredNumber(this.el,10,2e3),$('[name="templateWidth"]').val(t.calculateTemplateWidth()),t.updateViews()}),this.addAction({change:"updateGutterWidth"},function(){t.validateRequiredNumber(this.el,0,500),$('[name="columnWidth"]').val(t.calculateColumnWidth()),t.updateViews()}),this.addAction({click:"enableEditing"},function(){$(this.el).hide(),$('[name="gridName"]').prop("disabled",!1),t.isGridInUse||$.each(["columnNum","columnWidth","gutter","templateWidth"],function(e,t){var i=$('[name="'+t+'"]');i.prop("disabled",!1),i.attr("type","number")}),$("#createTemplateButton").addClass("hidden"),$("#saveAndCreateTemplateButton").removeClass("hidden"),$("#gridForm").attr("data-action","saveGrid")}),this.addAction({click:"back"},function(){window.history.back()}),this.validateRequiredNumber=function(e,t,i){var n=parseInt(e.val());(n!=e.val()||n<t)&&e.val(t),i<n&&e.val(i)},this.updateViews=function(){var e={columnNum:this.columnNum(),columnWidth:this.columnWidth(),gutter:this.gutterWidth(),templateWidth:this.templateWidth()};t.gridView.update(e),t.gridColumnView.update(e)},this.calculateColumnWidth=function(){return Math.floor(this.templateWidth()/this.columnNum()-this.gutterWidth())},this.calculateTemplateWidth=function(){return Math.ceil((this.columnWidth()+this.gutterWidth())*this.columnNum())},this.columnNum=function(){return parseInt($('[name="columnNum"]').val())},this.columnWidth=function(){return parseInt($('[name="columnWidth"]').val())},this.gutterWidth=function(){return parseInt($('[name="gutter"]').val())},this.templateWidth=function(){return parseInt($('[name="templateWidth"]').val())}}),AGN.Lib.Controller.new("grid-layout-view",function(){var l,r=AGN.Lib.Template,i=AGN.Lib.Tooltip,n=AGN.Lib.Popover,o=AGN.Lib.Modal,a=AGN.Lib.Confirm,s=AGN.Lib.Form,e=AGN.Lib.Action,c=AGN.Lib.Helpers,u=-1,d=1,h="Placeholder",p="Image",f={setShown:function(e,t){t?e.removeClass("hidden"):e.addClass("hidden")},setTooltip:function(e,t){e.data("tooltip",t),i.createTip(e,t)},removeTooltip:function(e){i.remove(e)},checkHoverState:function(e){e.is(":hover")&&e.trigger("mouseleave").trigger("mouseenter")},setLocked:function(e){$("#editor-progress").toggle(!!e),$("#disabled-save-button").toggle(!!e),$("#save-button").toggle(!e)},setTargetId:function(e){$("#visibleTargets").select2("val",e)},getAvailableTargetIds:function(){return $("#visibleTargets").children("option").get().map(function(e){return parseInt($(e).val())})},setAvailableTargetIds:function(e){var i=this.getAvailableTargetIds(),n=$("#visibleTargets");n.empty(),e.push({id:u,name:t("filter.reset")}),_.sortBy(e,function(e){return 0<e.id?i.indexOf(parseInt(e.id)):0==e.id?1e6:1000001}).forEach(function(e){$("<option></option>").val(e.id).text(e.name).appendTo(n)})},imagesAdjusted:function(i,e){var n=$.Deferred(),o=void 0,r=void 0;!0===e&&(o=i.outerWidth(),r=i.outerHeight());function t(){var e=i.outerWidth(),t=i.outerHeight();o===e&&r===t||(o=e,r=t,n.notify())}return i.imagesLoaded().progress(t).always(t),n.promise()},getHeightAccurate:function(e){return e[0].getBoundingClientRect().height},getResizeHandleDirection:function(e){return e.hasClass("ui-resizable-ne")?new C("ne"):e.hasClass("ui-resizable-se")?new C("se"):e.hasClass("ui-resizable-nw")?new C("nw"):e.hasClass("ui-resizable-sw")?new C("sw"):e.hasClass("ui-resizable-e")?new C("e"):e.hasClass("ui-resizable-w")?new C("w"):e.hasClass("ui-resizable-n")?new C("n"):e.hasClass("ui-resizable-s")?new C("s"):(console.error("Invalid resizing direction handle"),new C(""))}};function g(){var e=this;this.templateId=0,this.targetId=u,this.targets=new m,this.categories=new v,this.children=new y([]),this.imageUriPattern="{image-id}",this.watcher=new T,this.adjust=_.throttle(this.adjust,200),this.watcher.promise().progress(function(){e.adjust(!1)})}function m(e){var t={};e?(this.data=e.slice(),this.data.forEach(function(e){t[e.id]=e.name})):this.data=[],this.map=t}function v(e){var t={};e?(this.data=e.slice(),this.data.forEach(function(e){t[e.id]=e.name})):this.data=[],this.map=t}function y(e){e[0]instanceof b?this.children=e.slice():this.children=e.sort(function(e,t){return e.z===t.z?e.columns===t.columns?e.column-t.column:t.columns-e.columns:e.z-t.z}).map(function(e){return new b(e)})}function b(e){var t={id:0,name:"",targetId:0,row:0,column:0,rows:1,columns:1,z:0,isTocItem:!1,isRecycled:!1,interestGroup:"",container:{id:0,name:"",isToc:!1,isSortable:!1,markup:[],content:{},tocItemPlaceholderId:0},content:void 0};this.data=_.merge(t,e),void 0===this.data.content&&(this.data.content=_.clone(this.data.container.content)),this.capsule=new E(this)}function w(e){this.data=$.extend({id:0,name:"",isToc:!1,markup:[],content:{}},e)}function C(e){this.horizontal="",this.vertical="";for(var t=0;t<e.length;t++){var i=e.charAt(t).toLowerCase();switch(i){case"e":case"w":""===this.horizontal?this.horizontal=i:console.error("Ambiguous direction code: "+e);break;case"n":case"s":""===this.vertical?this.vertical=i:console.error("Ambiguous direction code: "+e);break;default:console.error("Unknown direction code: "+i)}}}function A(e,t){var i=e.get$();this.child=e,this.$child=i,this.grid=t}function E(e){var t=this,i=$.Deferred(),n=r.dom("div-sandbox");this.promise=i.promise(),this.watcher=new T,this.$capsule=n,this.$content=E.stub(),n.find("iframe").on("load",function(){var e=$(this).contents().get(0);$(e.head).append(E.style()),$(e.body).append(t.$content),t.watcher.bind(f.imagesAdjusted(t.$content)),i.resolveWith(t)}),n.appendTo("#children"),b.set(n,e),this.controls=new S(n)}function x(e){this.child=e}function S(e){var t=this,i=b.get(e);this.$capsule=e,this.factory=new x(i),this.timeoutId=null,this.state=d,this.update(),e.on("mouseenter",function(){t.show()}),e.on("mouseleave",function(){t.hide()})}function T(){this.deferred=$.Deferred(),this.callback=null}window.onbeforeunload=function(e){if($('[data-controller="grid-layout-view"]').exists()){var i=t("grid.layout.leaveQuestion");if(e=e||window.event,l&&l.isChanged())return e&&(e.returnValue=i),i}AGN.Lib.Loader.show()},this.addDomInitializer("grid-layout-view",function(e){(l=l||new g).setup(e.json())}),this.addDomInitializer("available-building-blocks-menu",function(e){var t=$("#div-containers-cache"),n={};t.children("[data-container-id]").each(function(){var e=new w($(this).json());n[e.getContainerId()]=e}),e.find("[data-building-block]").each(function(){var e=$(this),t=e.data("container-id"),i=n[t];i&&(b.set(e,i),e.draggable(w.draggableOptions()))}),t.remove()}),this.addAction({change:"visibleTargets"},function(){l.setTargetId(parseInt(this.el.val()))}),this.addAction({"select2-open":"visibleTargets"},function(){var e=this.el.select2("dropdown").find(".select2-results");e.css("overflow","hidden"),e.children(".select2-result").each(function(){var e=$(this);0<e.data("select2-data").id&&e.addClass("sortable")}),e.sortable({items:".select2-result.sortable",containment:"parent",tolerance:"pointer",distance:5,opacity:.4,cursor:"move",start:function(e,t){t.item.removeClass("select2-result-selectable")},stop:function(e,t){t.item.addClass("select2-result-selectable")},update:function(e,t){var i=t.item.data("select2-data"),n=t.item.prev(),o=t.item.next();if(n.length){var r=n.data("select2-data");$(r.element[0]).after($(i.element[0]))}else if(o.length){var a=o.data("select2-data");$(a.element[0]).before($(i.element[0]))}l.setLayeringByTargets(f.getAvailableTargetIds())}})}),this.addAction({"select2-close":"visibleTargets"},function(){this.el.select2("dropdown").find(".select2-results").sortable("destroy")}),this.addAction({change:"setTemplateReleased"},function(){$("#is-released").val(this.el.is(":checked")?"true":"false"),l.setChanged(!0)}),this.addAction({click:"toggleGutter"},function(){var e=R.get(this.el);e.setGuttered(!e.isGuttered()),l.setChanged(!0),l.adjust()}),this.addAction({click:"insertRow"},function(){l.addRowBefore(R.get(this.el))}),this.addAction({click:"addRow"},function(){l.addRow()}),this.addAction({click:"deleteRow"},function(){l.removeRow(R.get(this.el))}),this.addAction({click:"edit"},function(){var e=b.get(this.el);e&&l.editChild(e)}),this.addAction({click:"clone"},function(){var e=b.get(this.el);e&&l.cloneChild(e)}),this.addAction({click:"remove"},function(){var e=b.get(this.el);e&&l.removeChild(e)}),this.addAction({change:"previewImageSrc",keyup:"previewImageSrc",mouseup:"previewImageSrc"},function(){N.get(this.el).updateImageSrc(this.el)}),this.addAction({change:"chooseImageFile"},function(){N.get(this.el).updateImage(this.el)}),this.addAction({click:"chooseImage"},function(){var e=this.el.data("placeholder-id");N.get(this.el).chooseImage(e)}),this.addAction({click:"deleteImage"},function(){var e=this.el.data("placeholder-id");N.get(this.el).deleteImage(e)}),this.addAction({click:"showMediapoolDialog"},function(){var e=this.el.data("placeholder-id");N.get(this.el).showMediapoolDialog(e)}),this.addAction({submission:"saveChildContents"},function(){N.get(this.el).save(s.get(this.el))}),this.addAction({click:"submit"},function(){if(l.isTextVersionGenerationAllowed()){var e={modalClass:"",title:t("mailing.textVersion"),content:t("mailing.textVersionGenerationQuestion")};a.createFromTemplate(e,"modal-yes-no-cancel").always(function(e){"yes"!==e&&"no"!==e||l.save("yes"===e)})}else l.save(!1)}),e.new({"form:loadershow":"form"},function(){f.setLocked(!0)}),e.new({"form:loaderhide":"form"},function(){f.setLocked(!1)}),g.prototype.setup=function(e){e=$.extend({templateId:0,targetId:u,grid:{},children:[],imageUriPattern:"{image-id}",noPreviewImageLink:"#",isTextVersionGenerationAllowed:!1,targets:[],interestGroups:[],categories:[],translations:{},urls:{},actions:{}},e),$.i18n.load(e.translations),this.changesNotSaved=!1,this.templateId=e.templateId,this.targetId=e.targetId,this.imageUriPattern=e.imageUriPattern,this.noPreviewImageLink=e.noPreviewImageLink,this.textVersionGenerationAllowed=e.isTextVersionGenerationAllowed,this.noImageLink=e.noImageLink,this.targets=new m(e.targets),this.interestGroups=e.interestGroups,this.categories=new v(e.categories),this.children=new y(e.children),this.urls=e.urls,this.actions=e.actions,this.mailingId=e.mailingId;var t=this.children.active();this.grid=new k(e.grid,Math.max(1,t.calculateRowsCount())),t.rebuildStatic({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink}),t.adjustLayering(),this.updateAvailableTargets(),f.setTargetId(this.targetId),this.setTargetId(this.targetId),this.setupInteractions(),this.updateRecycleBin(),this.setupSessionTimer(),f.setLocked(!1)},g.prototype.setupInteractions=function(){var a=this;function i(t,i){a.children.active().matching(a.targetId).each(function(e){e!==t&&(e.setControlsEnabled(i),e.setResizable(i))})}this.children.recycled().each(function(e){e.setRows(1),e.setColumns(1)}),this.grid.setOnResizingStarted(function(e){i(e,!1)}),this.grid.setOnResizingStopped(function(e){i(e,!0),a.children.active().stick(e.getArea())});var e=null;this.grid.setOnAreaHovered(function(t){var i=a.children.active().matching(a.targetId);e=t?(i=i.select(function(e){return e.isInArea(t)}),e&&e.each(function(e){i.contains(e)||e.setHighlighted(!1)}),i.setHighlighted(!0),i):(i.setHighlighted(!1),null)}),this.grid.setOnDrop(function(e,i,n){var o=a.children.active(),r=!1;if(!o.contains(e)){if(r=!0,e.isToc()&&o.containsToc())return void AGN.Lib.Messages(t("defaults.error"),t("error.template.notUniqToc"),"warning");e instanceof w?(e=e.instantiate(),a.children.add(e)):e.isRecycled()&&(e.setRecycled(!1),a.updateRecycleBin()),a.targetId!==u&&e.setTargetId(a.targetId),o=a.children.active(),e.isToc()||e.rebuild({imageUriPattern:a.imageUriPattern,noImageLink:a.noImageLink})}e.setArea(n),o.active().stick(n),(e.isTocItem()||r&&e.isToc())&&o.matching(a.targetId).rebuildToc({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink}),e.adjustSize(a.grid),e.adjustCoordinates(a.grid),r?(e.setShown(!0),a.adjust(),a.watcher.bind(o.matching(a.targetId).pulse())):a.adjust(),a.updateAvailableTargets(),a.setChanged(!0)}),$("#children").on("dblclick","[data-building-block]",function(e){var t=$(e.target);if(!(t.is("button")||t.is(".ui-resizable-handle")||t.closest("button").exists())){var i=$(this),n=b.get(i);n&&l.editChild(n)}})},g.prototype.setupSessionTimer=function(){var e=this.urls.SESSION_REFRESH;this.sessionTimerId&&clearInterval(this.sessionTimerId),this.sessionTimerId=setInterval(function(){$.ajax(e,{type:"POST",loader:!1})},6e4)},g.prototype.updateAvailableTargets=function(){var e=this.children.active(),t=this.targets,i=e.collectTargetIds(),r=[];e.groups().forEach(function(e){var i={};e.sort(function(e,t){return e.getZ()-t.getZ()}).forEach(function(e,t){i[e.getTargetId()]=t}),r.push(i)}),i.sort(function(i,n){var o=0;return r.forEach(function(e){if(i in e&&n in e){var t=e[i]-e[n];t<0?o++:0<t&&o--}}),o}),f.setAvailableTargetIds(i.map(function(e){return{id:e,name:t.name(e)}})),i.indexOf(this.targetId)<0&&(this.targetId=u),f.setTargetId(this.targetId)},g.prototype.isTextVersionGenerationAllowed=function(){return this.textVersionGenerationAllowed},g.prototype.isChanged=function(){return this.changesNotSaved},g.prototype.setChanged=function(e){this.changesNotSaved=!!e},g.prototype.getGrid=function(){return this.grid},g.prototype.getTargetName=function(e){return this.targets.name(e)},g.prototype.setTargetId=function(e){var t=this.children.active();this.targetId=e,t.unmatching(this.targetId).setShown(!1),(t=t.matching(this.targetId)).rebuildToc({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink}),t.setShown(!0),this.adjust(),this.watcher.bind(t.pulse())},g.prototype.setLayeringByTargets=function(t){this.children.active().groups().forEach(function(e){1<e.length&&y.make(e).setLayeringByTargets(t)}),this.setChanged(!0)},g.prototype.setChildrenControlsEnabled=function(e){this.children.active().matching(this.targetId).setControlsEnabled(e)},g.prototype.updateToc=function(e){var t=this.children.active().matching(this.targetId);t.rebuildToc({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink})&&e&&(this.adjustSizes(t),this.adjustCoordinates(t))},g.prototype.adjustSizes=function(e){void 0===e&&(e=this.children.active().matching(this.targetId)),e.adjustSizes(this.grid),this.grid.adjustRows(e)},g.prototype.adjustCoordinates=function(e){void 0===e&&(e=this.children.active().matching(this.targetId)),this.grid.adjustSidebars(),e.adjustCoordinates(this.grid)},g.prototype.adjustLayering=function(e){var a=this;void 0===e&&(e=this.children.active().matching(this.targetId));var s=e.groupsMap();this.grid.each(function(e,r){e.each(function(e,t){var i=y.make(s[r+1+":"+(t+1)]);if(1<i.size()){var n=1,o=!1;1<i.calculateTocItemsCount()&&(o=!0),i.setBorderHighlighted(!0),e.setLayeringIndex(n),e.setOnLayeringRotate(function(){a.setChanged(!0),n=n%i.size()+1,i.rotateLayering(),this.setLayeringIndex(n),o&&a.updateToc(!0)})}else i.setBorderHighlighted(!1),e.setLayeringIndex(null),e.setOnLayeringRotate(null)})})},g.prototype.adjust=function(e){var t=this.children.active().matching(this.targetId);this.adjustSizes(t),this.adjustCoordinates(t),!1!==e&&this.adjustLayering(t)},g.prototype.addRowBefore=function(e,t){var o=this.grid.addRowBefore(e),i=this.children.active(),r=!1;i.each(function(e){var t=e.getRows(),i=e.getRow(),n=i+t-1;o<=i?e.setRow(i+1):i<o&&o<=n&&(r=!0,e.setRows(t+1))}),!1!==t&&(r?this.adjust():this.adjustCoordinates(i.matching(this.targetId))),this.setChanged(!0)},g.prototype.addRow=function(e){this.grid.addRow(),!1!==e&&this.grid.adjustSidebars(),this.setChanged(!0)},g.prototype.removeRow=function(e){var n=this.grid.removeRow(e),t=this.children.active(),o=!1,r=!1;t.each(function(e){var t=e.getRows(),i=e.getRow();i<=n&&n<=i+t-1?1<t?(e.setRows(t-1),r=!0):(e.setRecycled(!0),o=!0):n<i&&e.setRow(i-1)}),o?((t=this.children.active().matching(this.targetId)).rebuildToc({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink}),this.adjust(),this.watcher.bind(t.pulse()),this.updateAvailableTargets(),this.updateRecycleBin()):r?this.adjust():this.adjustCoordinates(),this.setChanged(!0)},g.prototype.removeChild=function(e){if(this.children.contains(e)){if(e.setRecycled(!0),e.isTocItem()){var t=this.children.active().matching(this.targetId);t.rebuildToc({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink}),this.watcher.bind(t.pulse())}this.adjust(),this.updateAvailableTargets(),this.updateRecycleBin(),this.setChanged(!0)}},g.prototype.cloneChild=function(e){var i=this,c=this.grid.getColumns(),t=this.children.active();function n(e,t){function i(e,i){var n=null,o=null;e.forEach(function(e){var t=e.getColumn(),i=t+e.getColumns()-1;n=Math.min(n||t,t),o=Math.max(o||i,i)});var t=0;return c<o+i&&(i+=t=c+1-n-i),e.forEach(function(e){var t=e.getColumn()+i;c<t?(e.setRow(e.getRow()+1),e.setColumn(t-c)):e.setColumn(t)}),t}for(var n=0;n<e.length&&0<t;n++){var o=e[n];0<o.length?t+=i(o,t):t--}}function o(e){var t=i.grid.getRow(e);t?i.addRowBefore(t,!1):i.addRow(!1)}var r,a,s,l,u,d,h,p,f,g=e.clone();a=t,l=g,u=(s=e).getRow(),d=s.getColumns(),h=s.getColumn()+d,p=function(e,o,r){var a=[],s={};e.each(function(e){var t=e.getColumn();if(o===e.getRow()&&r<=t){a.push(e);var i=e.getColumns();s[t]=Math.min(s[t]||t,t);for(var n=1;n<i;n++)s[t+n]=t}});for(var t=_.groupBy(a,function(e){for(var t=e.getColumn();s[t]&&s[t]!==t;)t=s[t];return t}),i=[],n=r;n<=c;n++)if(s[n]){var l=t[n];l&&i.push(l)}else i.push([]);return i}(a,u,h),d<=(f=c-h+1)?(r=0,p.forEach(function(e){0===e.length&&r++}),d<=r||o(u+1),n(p,d),l.setRow(u),l.setColumn(h)):(o(u+1),n(p,f+d),l.setRow(u+1),l.setColumn(1)),g.rebuild({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink}),g.setShown(!0),this.children.add(g),this.updateToc(!1),this.watcher.bind(this.children.active().matching(this.targetId).pulse()),this.adjust(),this.setChanged(!0)},g.prototype.editChild=function(e){var t={child:{name:e.getName(),containerName:e.getContainerName(),isToc:e.isToc(),isSortable:e.isSortable(),interestGroup:e.getInterestGroup(),targetId:e.getTargetId(),asTocItem:e.asTocItem(),placeholders:e.getPlaceholders()},targets:this.targets.list(),interestGroups:this.interestGroups.slice(),categories:this.categories.list(),imageUriPattern:this.imageUriPattern,noPreviewImageLink:this.noPreviewImageLink,noImageLink:this.noImageLink,urls:this.urls,mailingId:this.mailingId};e.isToc()&&(t.child.toc=this.children.active().matching(this.targetId).asTocItems(!1)),N.create(e,t)},g.prototype.saveChild=function(e,t,i,n,o,r){e.setName(t),e.setTargetId(i),e.setTocItem(n),e.setInterestGroup(o),e.setContent(r),e.isToc()?this.updateToc(!1):(e.rebuild({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink}),(e.isTocItem()||n)&&this.updateToc(!1)),e.isMatching(this.targetId)||(e.setShown(!1),this.watcher.bind(this.children.active().matching(this.targetId).pulse())),this.adjust(),this.setChanged(!0),this.updateAvailableTargets()},g.prototype.updateRecycleBin=function(){var e=$("#recyclebin-content"),t=$("#recyclebin-stub");this.children.sort(function(e,t){return e.isRecycled()===t.isRecycled()?0:e.isRecycled()?1:-1});var i=this.children.recycled().get();f.setShown(t,0===i.length);var n=r.dom("recyclebin-table",{children:i.map(function(e){return{name:e.getName()||e.getContainerName(),id:e.getId(),containerId:e.getContainerId()}})});e.html(n),n.find("[data-building-block]").each(function(e){var t=$(this);t.draggable(w.draggableOptions()),b.set(t,i[e])})},g.prototype.getGuttersAsString=function(){var t=[];return this.grid.each(function(e){t.push(e.isGuttered()?"1":"0")}),t.join("|")},g.prototype.getChildrenAsSubmittable=function(){var e=this.children.active().groups(),i=[],n=f.getAvailableTargetIds();return e.forEach(function(e){e=_.sortBy(e,function(e){return n.indexOf(e.getTargetId())});var t=0;e.forEach(function(e){e.setZ(t++),i.push(e.asSubmittable())})}),i},g.prototype.validateOverlaps=function(){for(var e=this.children.active().select(function(e){return 1<e.getRows()}).get(),t=0;t<e.length;t++)for(var i=e[t],n=i.getRow(),o=n+i.getRows()-1,r=t+1;r<e.length;r++){var a=e[r],s=a.getRow(),l=s+a.getRows()-1;if(n<s&&s<=o&&o<l||s<n&&n<=l&&l<o){var c=i.getColumn(),u=c+i.getColumns()-1,d=a.getColumn(),h=d+a.getColumns()-1;if(u<d||h<c)return!1}}return!0},g.prototype.save=function(e){if(this.validateOverlaps()){var i=$("#gridTemplateForm"),n=s.get(i);this.setChanged(!1),n.setValue("forceGenerateTextVersion",!0===e),n.setValue("rowGutters",this.getGuttersAsString()),n.setValue("childrenJson",JSON.stringify(this.getChildrenAsSubmittable())),n.submit("resource")}else AGN.Lib.Messages(t("defaults.error"),t("error.template.invalidVerticalSpanning"),"alert")},m.prototype.name=function(e){return this.map[e==u?0:e]},m.prototype.list=function(){return this.data.slice()},v.prototype.name=function(e){return this.map[e]},v.prototype.list=function(){return this.data.slice()},y.make=function(e){return new y(e||[])},y.prototype.get=function(){return this.children.slice()},y.prototype.size=function(){return this.children.length},y.prototype.each=function(e){this.children.forEach(e)},y.prototype.sort=function(e){this.children.sort(e)},y.prototype.contains=function(e){return 0<=this.children.indexOf(e)},y.prototype.containsToc=function(){for(var e=0;e<this.children.length;e++)if(this.children[e].isToc())return!0;return!1},y.prototype.matching=function(t){return this.select(function(e){return e.isMatching(t)})},y.prototype.unmatching=function(t){return this.select(function(e){return!e.isMatching(t)})},y.prototype.active=function(){return this.select(function(e){return!e.isRecycled()})},y.prototype.recycled=function(){return this.select(function(e){return e.isRecycled()})},y.prototype.select=function(e){return new y(this.children.filter(e))},y.prototype.add=function(e){e.setZ(this.active().calculateMaxZ()+1),this.children.push(e)},y.prototype.groupsMap=function(){var r={},e=_.groupBy(this.children,function(e){return e.getRow()});return $.each(e,function(n,e){var o={};e.forEach(function(e){var t=e.getColumns();if(1<t)for(var i=e.getColumn(),n=1;n<t;n++)o[i+n]=i}),e.forEach(function(e){for(var t=e.getColumn();o[t];)t=o[t];var i=n+":"+t;void 0===r[i]&&(r[i]=[]),r[i].push(e)})}),r},y.prototype.groups=function(){var i=[],e=this.groupsMap();return $.each(e,function(e,t){t.length&&i.push(t)}),i},y.prototype.collectTargetIds=function(){var t={};return this.each(function(e){t[e.getTargetId()]=!0}),Object.keys(t).sort()},y.prototype.calculateMaxZ=function(){return this.children.reduce(function(e,t){return Math.max(t.getZ(),e)},0)},y.prototype.calculateRowsCount=function(){return this.children.reduce(function(e,t){return Math.max(t.getRow()+t.getRows()-1,e)},0)},y.prototype.calculateTocItemsCount=function(){var t=0;return this.children.forEach(function(e){e.isTocItem()&&t++}),t},y.prototype.setShown=function(t){this.children.forEach(function(e){e.setShown(t)})},y.prototype.setBorderHighlighted=function(t){this.children.forEach(function(e){e.setBorderHighlighted(t)})},y.prototype.setHighlighted=function(t){this.children.forEach(function(e){e.setHighlighted(t)})},y.prototype.setControlsEnabled=function(t){this.children.forEach(function(e){e.setControlsEnabled(t),e.setResizable(t),e.checkHoverState()})},y.prototype.asTocItems=function(e){var t=this.children.slice().sort(function(e,t){return e.getRow()===t.getRow()?e.getColumn()===t.getColumn()?t.getZ()-e.getZ():e.getColumn()-t.getColumn():e.getRow()-t.getRow()}).map(function(e){return e.asTocItem()}).filter(function(e){return!!e});return e?t.filter(function(e){return e.isEnabled}):t},y.prototype.pulse=function(){var e=this.children.map(function(e){return e.pulse()});return $.when.apply(this,e)},y.prototype.rebuildStatic=function(t){this.each(function(e){e.isToc()||e.rebuild(t)})},y.prototype.rebuildToc=function(t){var i=this,n=!1;return this.each(function(e){e.isToc()&&(e.rebuild($.extend({},t,{toc:i.asTocItems(!0)})),n=!0)}),n},y.prototype.rotateLayering=function(){var e=this.children.slice().sort(function(e,t){return e.getZ()-t.getZ()}),i=e.map(function(e){return e.getZ()});e.forEach(function(e,t){e.setZ(i[(t+1)%i.length])})},y.prototype.setLayeringByTargets=function(t){var e=this.children.slice().sort(function(e,t){return t.getZ()-e.getZ()}),i=e.map(function(e){return e.getZ()});_.sortBy(e,function(e){return t.indexOf(e.getTargetId())}).forEach(function(e,t){e.setZ(i[t])})},y.prototype.stick=function(t){this.children.forEach(function(e){e.isInArea(t)&&e.setArea(t)})},y.prototype.adjustLayering=function(){var t=this.children.length;this.children.forEach(function(e){e.setZ(--t)})},y.prototype.adjustSizes=function(t){this.children.forEach(function(e){e.adjustSize(t)})},y.prototype.adjustCoordinates=function(t){this.children.forEach(function(e){e.adjustCoordinates(t)})},b.get=function(e){return e.data("agn:child")},b.set=function(e,t){e.data("agn:child",t)},b.render=function(e,i,n){var o="";return e.forEach(function(t){switch(t.type){case"Text":o+=t.value;break;case h:var e=i[t.id];if(t.markup)e&&(o+=b.render(t.markup,i,n));else switch(t.placeholderType){case"Label":case"Text":case"Link":o+=e||"";break;case"ImageLink":o+=e||n.noImageLink;break;case p:o+=0<parseInt(e)?n.imageUriPattern.replace("{image-id}",e):n.noImageLink;break;default:console.error("Unknown placeholder type: "+t.placeholderType)}break;case"TocArea":n.toc.forEach(function(e){o+=b.render(t.markup,i,$.extend({tocItem:e},n))});break;case"TocPlaceholder":switch(t.placeholderType){case"Id":o+="toc_"+n.tocItem.id;break;case"Name":o+=n.tocItem.name;break;default:console.error("Unknown TOC placeholder type: "+t.placeholderType)}break;default:console.error("Unknown span type: "+t.type)}}),o},b.collectPlaceholders=function(e,t,i,n,o){e.forEach(function(e){switch(e.type){case h:o&&!o.call(o,e)||void 0===n[e.id]&&(i.push({id:e.id,type:e.placeholderType,name:e.name,value:t[e.id]}),n[e.id]=!0);case"TocArea":e.markup&&b.collectPlaceholders(e.markup,t,i,n,o)}})},b.draggableOptions=function(){return{stack:"#children .div-container",revert:"invalid",distance:20,cursor:"move",opacity:.4,start:function(){l.setChildrenControlsEnabled(!1)},stop:function(){l.setChildrenControlsEnabled(!0)}}},b.resizableOptions=function(n){var o=!1;return{handles:"ne, se, sw, nw, w, n, e, s",autoHide:!0,create:function(){o=new A(n,l.getGrid())},start:function(e,t){!1===o&&(o=new A(n,l.getGrid()));var i=$(e.originalEvent.target);n.setControlsEnabled(!1),n.capsule.setResizingEnabled(!0),o.start(f.getResizeHandleDirection(i))},stop:function(e,t){o.stop(t.size.width,t.size.height),n.capsule.setResizingEnabled(!1),n.setControlsEnabled(!0),n.checkHoverState(),n.isTocItem()&&l.updateToc(!1),l.adjust(),l.setChanged(!0)},resize:function(e,t){o.resize(t.size.width,t.size.height)}}},b.prototype.asSubmittable=function(){return{id:this.data.id,containerId:this.data.container.id,name:this.data.name,targetId:this.data.targetId,interestGroup:this.data.container.isSortable&&this.data.interestGroup||"",row:this.data.row,column:this.data.column,rows:this.data.rows,columns:this.data.columns,content:$.extend({},this.data.content),isTocItem:this.data.isTocItem}},b.prototype.get$=function(){return this.capsule.get$()},b.prototype.getId=function(){return this.data.id},b.prototype.getName=function(){return this.data.name},b.prototype.getContainerName=function(){return this.data.container.name},b.prototype.setName=function(e){this.data.name=e||""},b.prototype.getContainerId=function(){return this.data.container.id},b.prototype.isRecycled=function(){return this.data.isRecycled},b.prototype.setRecycled=function(e){e?(this.setShown(!1),this.setRows(1),this.setColumns(1),this.capsule.recycle(),this.data.isRecycled=!0):this.data.isRecycled=!1},b.prototype.isInArea=function(e){return!this.isNotInArea(e)},b.prototype.isNotInArea=function(e){var t=e.column,i=t+e.columns-1,n=e.row,o=n+e.rows-1,r=this.data.column,a=r+this.data.columns-1,s=this.data.row,l=s+this.data.rows-1;return Math.max(r,a)<t||Math.min(r,a)>i||Math.max(s,l)<n||Math.min(s,l)>o},b.prototype.isMatching=function(e){return e===u||0===this.data.targetId||this.data.targetId===e},b.prototype.isToc=function(){return this.data.container.isToc},b.prototype.isTocItem=function(){return this.data.isTocItem},b.prototype.setTocItem=function(e){this.data.isTocItem=!!e},b.prototype.isSortable=function(){return this.data.container.isSortable},b.prototype.getInterestGroup=function(){return this.isSortable()&&this.data.interestGroup||""},b.prototype.setInterestGroup=function(e){this.isSortable()?this.data.interestGroup=e||"":this.data.interestGroup=""},b.prototype.getTargetId=function(){return this.data.targetId},b.prototype.setTargetId=function(e){this.data.targetId=0<=e?e:0,this.capsule.updateControls()},b.prototype.getRow=function(){return this.data.row},b.prototype.setRow=function(e){return this.data.row=e},b.prototype.getColumn=function(){return this.data.column},b.prototype.setColumn=function(e){this.data.column=e},b.prototype.getZ=function(){return this.capsule.getZ()},b.prototype.setZ=function(e){this.capsule.setZ(e)},b.prototype.getRows=function(){return this.data.rows},b.prototype.setRows=function(e){this.data.rows=e},b.prototype.getColumns=function(){return this.data.columns},b.prototype.setColumns=function(e){this.data.columns=e},b.prototype.getArea=function(){return k.area(this.data.row,this.data.column,this.data.rows,this.data.columns)},b.prototype.setArea=function(e){this.setRow(e.row),this.setColumn(e.column),this.setRows(e.rows),this.setColumns(e.columns)},b.prototype.getHeight=function(){return this.capsule.getHeight()},b.prototype.setShown=function(e){this.capsule.setShown(e),this.setDraggable(e),this.setResizable(e)},b.prototype.setBorderHighlighted=function(e){this.capsule.setBorderHighlighted(e)},b.prototype.setHighlighted=function(e){this.capsule.setHighlighted(e)},b.prototype.setSize=function(e,t){this.capsule.setSize(e,t)},b.prototype.setCoordinates=function(e){this.capsule.setCoordinates(e)},b.prototype.setControlsEnabled=function(e){this.capsule.setControlsEnabled(e)},b.prototype.checkHoverState=function(){f.checkHoverState(this.capsule.get$())},b.prototype.adjustSize=function(e,t){this.setSize(e.getWidthForSpans(this.getColumns()),t||"auto")},b.prototype.adjustHeight=function(e){this.capsule.adjustHeight(e)},b.prototype.adjustCoordinates=function(e){this.setCoordinates(e.getCoordinates(this.getRow(),this.getColumn()))},b.prototype.setDraggable=function(e){var t=this.capsule.get$();if(e)t.draggable(b.draggableOptions());else try{t.draggable("destroy")}catch(e){}},b.prototype.setResizable=function(e){var t=this.capsule.get$();if(e)t.resizable(b.resizableOptions(this));else try{t.resizable("destroy")}catch(e){}},b.prototype.getPlaceholders=function(t){var e=this.data.content,i=[],n=void 0;return t&&(n=function(e){return e.placeholderType===t}),b.collectPlaceholders(this.data.container.markup,e,i,{},n),i.sort(function(e,t){return e.name.localeCompare(t.name)}),i},b.prototype.setContent=function(e){$.extend(this.data.content,e)},b.prototype.asTocItem=function(){var t=this.data.container.tocItemPlaceholderId;if(0<t){var e=this.data.content,i=[];if(b.collectPlaceholders(this.data.container.markup,e,i,{},function(e){return e.id===t}),i.length){var n=i[0];return{id:this.data.id,name:e[n.id]||"",placeholderName:n.name,isEnabled:this.data.isTocItem}}}return null},b.prototype.rebuild=function(e){this.capsule.embrace(b.render(this.data.container.markup,this.data.content,e))},b.prototype.pulse=function(){return this.capsule.pulse()},b.prototype.clone=function(){var e=new b(this.data);return e.data.id=0,e},w.draggableOptions=function(){return{stack:"#children .div-container",revert:"invalid",distance:20,helper:"clone",appendTo:"body",containment:"window",zIndex:500,start:function(e,t){t.helper.width($(this).width()),l.setChildrenControlsEnabled(!1)},stop:function(e,t){t.helper.width("auto"),l.setChildrenControlsEnabled(!0)}}},w.prototype.getContainerId=function(){return this.data.id},w.prototype.getRows=function(){return 1},w.prototype.getColumns=function(){return 1},w.prototype.isToc=function(){return this.data.isToc},w.prototype.instantiate=function(){return new b({name:this.data.name,container:this.data})},C.prototype.isHorizontal=function(){return""!==this.horizontal},C.prototype.isVertical=function(){return""!==this.vertical},C.prototype.isEast=function(){return"e"===this.horizontal},C.prototype.isWest=function(){return"w"===this.horizontal},C.prototype.isNorth=function(){return"n"===this.vertical},C.prototype.isSouth=function(){return"s"===this.vertical},A.prototype.setupConstraints=function(){this.setConstraints(this.grid.getConstraints(this.child,this.direction))},A.prototype.setConstraints=function(e){this.$child.resizable({minWidth:e.minWidth,maxWidth:e.maxWidth,minHeight:e.minHeight,maxHeight:e.maxHeight})},A.prototype.getArea=function(e,t){return this.grid.getArea(this.child,this.direction,e,t)},A.prototype.start=function(e){this.direction=e,this.area={row:this.child.getRow(),column:this.child.getColumn(),rows:this.child.getRows(),columns:this.child.getColumns()},this.z=this.child.getZ(),this.setupConstraints(),this.grid.setAreaHovered(this.area),this.grid.startResizing(this.child),this.child.setZ(500)},A.prototype.resize=function(e,t){var i=this.getArea(e,t);i.row===this.area.row&&i.column===this.area.column&&i.rows===this.area.rows&&i.columns===this.area.columns||(this.area=i,this.grid.setAreaHovered(i))},A.prototype.stop=function(e,t){this.area=this.getArea(e,t),this.child.setZ(this.z),this.child.setRow(this.area.row),this.child.setColumn(this.area.column),this.child.setRows(this.area.rows),this.child.setColumns(this.area.columns),this.grid.setAreaHovered(null),this.grid.stopResizing(this.child),this.child.adjustSize(this.grid),this.child.adjustCoordinates(this.grid)},E.stub=function(){return $('<div class="div-container"></div>')},E.css=function(){return $("#template-styles").html()},E.style=function(){return $("<style/>",{html:this.css()})},E.prototype.get$=function(){return this.$capsule},E.prototype.updateControls=function(){this.controls.update()},E.prototype.setControlsEnabled=function(e){this.controls.setEnabled(e)},E.prototype.ready=function(e){return void 0!==e&&this.promise.done(e),"resolved"===this.promise.state()},E.prototype.pulse=function(){return this.watcher.promise()},E.prototype.embrace=function(e){var t=$(e).filter("*");if(this.ready()){this.$content.replaceWith(t),this.$content=t;var i=this.$capsule.outerWidth();0<i&&this.setSize(i,"auto"),this.watcher.bind(f.imagesAdjusted(t,!0))}else this.$content=t},E.prototype.recycle=function(){var t=this;this.setShown(!1),this.ready(function(){var e=E.stub();t.watcher.bind(!1),t.$content.replaceWith(e),t.$content=e})},E.prototype.getZ=function(){return this.$capsule.css("z-index")},E.prototype.setZ=function(e){this.$capsule.css("z-index",e)},E.prototype.setShown=function(e){f.setShown(this.$capsule,e)},E.prototype.setBorderHighlighted=function(e){e?this.$capsule.addClass("highlight-border"):this.$capsule.removeClass("highlight-border")},E.prototype.setHighlighted=function(e){e?this.$capsule.addClass("highlight-cont"):this.$capsule.removeClass("highlight-cont")},E.prototype.setCoordinates=function(e){this.$capsule.offset(e)},E.prototype.setSize=function(e,t){this.$content.outerWidth(e),this.$capsule.outerWidth(e),this.ready()?(this.$content.style("width",function(e){return e},"important"),this.$content.style("height","auto","important"),"auto"===t&&(t=this.$content.outerHeight()),this.$capsule.outerHeight(t)):"auto"===t?this.$capsule.outerHeight(80):this.$capsule.outerHeight(t)},E.prototype.adjustHeight=function(e){this.$capsule.outerHeight(e)},E.prototype.getHeight=function(){return this.ready()?f.getHeightAccurate(this.$content):80},E.prototype.setResizingEnabled=function(e){e?(this.$capsule.css("box-sizing","content-box"),this.$capsule.css("opacity",.4),this.$content.style("width","100%","important"),this.$content.style("height","100%","important")):(this.$capsule.css("box-sizing",""),this.$capsule.css("opacity",""))},x.prototype.getOptions=function(){return{targetName:l.getTargetName(this.child.getTargetId()),isToc:this.child.isToc()}},x.prototype.createControls=function(e){var t=r.dom(e,this.getOptions());return b.set(t.find("[data-action]"),this.child),AGN.runAll(t),t},x.prototype.createInlineControls=function(){return this.createControls("child-controls")},x.prototype.createPopoverControls=function(){return this.createControls("child-popover-controls")},S.popoverOptions=function(e){return{trigger:"manual",html:!0,template:'<div class="popover popover-wide" role="tooltip" style="margin-top: -5px;"><div class="popover-content"></div><div class="bottom-space"></div></div>',content:function(){return e.getPopoverContent()}}},S.prototype.stopHiding=function(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0)},S.prototype.popoverShow=function(){this.stopHiding(),this.popover.show(),this.state=2},S.prototype.popoverHide=function(e){if(this.stopHiding(),!0===e)this.popover.hide(),this.state=d;else{var t=this;this.timeoutId=setTimeout(function(){t.popoverHide(!0)},200)}},S.prototype.inlineShow=function(){this.$inlineControls.show(),this.state=3},S.prototype.inlineHide=function(){this.$inlineControls.hide(),this.state=d},S.prototype.show=function(){0!==this.state&&(this.$inlineControls.height()<this.$capsule.height()?(2===this.state&&this.popoverHide(!0),this.inlineShow()):(3===this.state&&this.inlineHide(),this.popoverShow()))},S.prototype.hide=function(e){switch(this.state){case 3:this.inlineHide();break;case 2:this.popoverHide(e)}},S.prototype.setEnabled=function(e){e?0===this.state&&(this.state=d):(this.hide(!0),this.state=0)},S.prototype.update=function(){this.$inlineControls&&this.$inlineControls.remove(),this.$inlineControls=this.factory.createInlineControls(),this.$capsule.append(this.$inlineControls),this.popover&&this.popover.destroy(),this.$popoverControls&&(this.$popoverControls=void 0),this.popover=n.new(this.$capsule,S.popoverOptions(this));var e=this.popover.tip(),t=this;e.on("mouseenter",function(){t.popoverShow()}),e.on("mouseleave",function(){t.popoverHide()}),3!==this.state&&2!==this.state||this.show()},S.prototype.getPopoverContent=function(){if(void 0===this.$popoverControls){this.$popoverControls=this.factory.createPopoverControls();var e=this.$popoverControls.find("[data-action]");b.set(e,this.child);var t=this;e.on("click",function(){t.popoverHide(!0)})}var i=this.$popoverControls.clone(!0);return AGN.runAll(i),i},S.prototype.remove=function(){this.state=0,this.stopHiding(),this.popover.destroy(),this.$popoverControls=void 0,this.$inlineControls.remove(),this.$inlineControls=void 0},T.prototype.promise=function(){return this.deferred.promise()},T.prototype.bind=function(e){var t=this;if(!1===e)t.callback=null;else{var i=t.callback=function(){t.callback===i&&t.deferred.notifyWith(this,arguments)};$.isArray(e)?e.forEach(function(e){e.progress(i)}):e.progress(i)}};var D={};function k(e,t){this.$template=$("#template"),this.columns=e.columns,this.rows=[],this.gap=e.gap,this.columnWidth=e.columnWidth,this.callbacks={},this.hoveredDroppable=null;for(var i=1;i<=t;i++){var n=this.createRow(e.gutters[i-1]);this.$template.append(n.get$()),this.rows.push(n)}this.adjustSidebars()}function R(e,i){this.$row=r.dom("droppables-row",{isGuttered:!1!==i}),this.$gutterButton=r.dom("toggle-gutter-button"),this.$removeButton=r.dom("remove-row-button"),this.$insertButton=r.dom("insert-row-button"),this.$row.data("agn:row",this),this.$gutterButton.data("agn:row",this),this.$removeButton.data("agn:row",this),this.$insertButton.data("agn:row",this),this.droppables=[],this.callbacks={};for(var n=1;n<=e;n++){var o=this.createDroppable();this.droppables.push(o),this.$row.append(o.get$())}this.$gutterButton.appendTo("#sidebar-gutters"),this.$removeButton.appendTo("#sidebar-actions"),this.$insertButton.appendTo("#sidebar-actions"),f.setTooltip(this.$gutterButton,!1===i?t("grid.gutter.show"):t("grid.gutter.hide")),f.setTooltip(this.$removeButton,t("grid.row.delete")),f.setTooltip(this.$insertButton,t("grid.row.add"))}function O(e){this.$droppable=r.dom("droppable"),this.$droppable.data("agn:droppable",this),this.$droppable.droppable(O.options(this)),this.row=e,this.callbacks={}}function N(e,t,i){var o=this;this.$modal=e,this.child=t,this.options=i;var r=t.getPlaceholders(p),n=[];r.forEach(function(e){var t=parseInt(e.value);0<t&&n.push(t)}),0<n.length&&$.ajax(this.options.urls.MEDIAPOOL_VIEW,{type:"POST",dataType:"json",traditional:!0,data:{elementIds:n}}).done(function(n){r.forEach(function(e){var t=parseInt(e.value);if(0<t){var i=n[t];$("#image-category-id-"+e.id).select2("val",i.categoryId),o.updateImagePreview(e.id,i.src,i.name,i.title)}})}),this.updateImageSrcPreview=_.throttle(this.updateImageSrcPreview,300)}D.make=function(t,e){D.adjustChildren(t,e),e.forEach(function(e){e.adjustHeight(t.getHeightForSpans(e.getRow(),e.getColumn(),e.getRows(),e.getColumns()))})},D.getChildrenProjections=function(n,e){var s=[];n.each(function(e){s.push({row:e,projections:[]})});var l=[];return e.forEach(function(e){for(var t=[],i={child:e,height:e.getHeight(),spans:t},n=e.getRow(),o=n+e.getRows()-1,r=n;r<=o;r++){var a={cascade:i,height:0,margin:0,adjusted:!1};t.push(a),s[r-1].projections.push(a)}l.push(i)}),$.each(s,function(e,t){var i=n.getRowMargin(t.row.isGuttered());$.each(t.projections,function(e,t){t.margin=i})}),$.each(l,function(e,t){D.adjustCascade(t)}),s},D.adjustCascade=function(e){for(var t=Math.max(e.height,10),i=0,n=e.spans,o=[],r=0;r<n.length;r++){var a=n[r];if(!1===a.adjusted&&(a.height=10,o.push(a)),(i+=a.height)+a.margin>=t){for(r+=1;r<n.length;r++)n[r].height=0;break}r+1<n.length&&(i+=a.margin)}var s=t-i;if(0<s&&o.length){var l=s/o.length;$.each(o,function(e,t){t.height+=l})}},D.adjustChildren=function(e,t){$.each(D.getChildrenProjections(e,t),function(e,t){var i=t.projections;if(i.length){var n=0,o=0;$.each(i,function(e,t){t.height>n&&(n=t.height,o=e)}),0===n&&(n=80),$.each(i,function(e,t){t.adjusted=!0,e!==o&&(t.height=n,D.adjustCascade(t.cascade))}),t.row.setHeight(n)}else t.row.setHeight(80)})},k.area=function(e,t,i,n){return{row:e,column:t,rows:i,columns:n}},k.prototype.createRow=function(e){var l=new R(this.columns,e),c=this;return l.setOnHoverChange(function(e,t,i,n){var o=c.rows.indexOf(l)+1;0<o?n?(c.setAreaHovered(k.area(o,i,t.getRows(),t.getColumns())),c.hoveredDroppable=e):c.hoveredDroppable===e&&c.setAreaHovered(!1):c.setAreaHovered(!1)}),l.setOnDrop(function(e,t,i){if(c.callbacks.onDrop){var n=c.rows.indexOf(l)+1;if(0<n){var o=e.getRows(),r=c.getRows()-n+1;r<o&&(o=r);var a=e.getColumns(),s=c.getColumns()-i+1;s<a&&(a=s),c.callbacks.onDrop.call(c,e,t,k.area(n,i,o,a))}}}),l},k.prototype.each=function(e){this.rows.forEach(e)},k.prototype.getRows=function(){return this.rows.length},k.prototype.getColumns=function(){return this.columns},k.prototype.getRow=function(e){return this.rows[e-1]||null},k.prototype.getDroppable=function(e,t){var i=this.getRow(e);return i?i.getDroppable(t):null},k.prototype.getRowMargin=function(e){return 2+(e?this.gap:0)},k.prototype.getCoordinates=function(e,t){return this.getDroppable(e,t).getCoordinates()},k.prototype.getConstraints=function(e,t){return $.extend(this.getWidthConstraints(e,t),this.getHeightConstraints(e,t))},k.prototype.getWidthConstraints=function(e,t){var i=e.getColumn(),n=e.getColumns(),o=this.getWidthForSpans(1);return{minWidth:o,maxWidth:t.isHorizontal()?t.isEast()?this.getWidthForSpans(this.getColumns()-i+1):this.getWidthForSpans(i+n-1):o}},k.prototype.getHeightConstraints=function(e,t){var i,n,o=e.getColumns(),r=e.getColumn(),a=r+o-1,s=e.getRows(),l=e.getRow(),c=l+s-1;return t.isVertical()?(t.isSouth()?(i=this.getMinHeightConstraint(l,r,1,o),c=this.getRows(),t.isHorizontal()&&(t.isEast()?a=this.getColumns():r=1)):(i=this.getMinHeightConstraint(c,r,1,o),l=1),n=this.getMaxHeightConstraint(l,r,c-l+1,a-r+1)):i=n=e.getHeight(),{minHeight:Math.min(i,e.getHeight()),maxHeight:n}},k.prototype.getWidthForSpans=function(e){return this.columnWidth*e+this.gap*(e-1)},k.prototype.getHeightForSpans=function(e,t,i,n,o){var r=this;function a(e){return r.rows[e-1].getDroppables().slice(t-1,t+n-1).reduce(o)}void 0===o&&(o=function(e,t){return e.getHeight()>t.getHeight()?e:t});var s=e,l=e+i-1;if(s===l)return a(s).getHeight();var c=a(s).get$(),u=a(l).get$();return u.position().top-c.position().top+u.outerHeight()},k.prototype.getMinHeightConstraint=function(e,t,i,n){return this.getHeightForSpans(e,t,i,n,function(e,t){return e.getHeight()<t.getHeight()?e:t})},k.prototype.getMaxHeightConstraint=function(e,t,i,n){return this.getHeightForSpans(e,t,i,n,function(e,t){return e.getHeight()>t.getHeight()?e:t})},k.prototype.getArea=function(e,t,i,n){var o,r,a,s,l,c,u=this;function d(e){var t=u.rows[e-1];return t?t.getDroppables().slice(o-1,o+r-1).reduce(function(e,t){return e.getHeight()>t.getHeight()?e:t}):null}function h(e){return e.get$().position().top}if(t.isHorizontal()?(r=Math.ceil(i/(this.columnWidth+this.gap)),o=t.isEast()?e.getColumn():e.getColumn()+e.getColumns()-r):(o=e.getColumn(),r=e.getColumns()),t.isVertical())if(s=1,t.isSouth())for(l=d(a=e.getRow());(c=d(a+s))&&n>h(c)-h(l);)s++;else for(c=d(a=e.getRow()+e.getRows()-1);(l=d(a-1))&&n>h(c)-h(l)+c.getHeight()-l.getHeight();)a--,s++;else a=e.getRow(),s=e.getRows();return k.area(a,o,s,r)},k.prototype.setAreaHovered=function(i){i?this.each(function(e,t){t>=i.row-1&&t<=i.row-1+i.rows-1?e.setHovered(!0,i.column,i.column+i.columns-1):e.setHovered(!1)}):this.each(function(e){e.setHovered(!1)}),this.callbacks.onAreaHovered&&this.callbacks.onAreaHovered.call(this,i)},k.prototype.startResizing=function(e){this.callbacks.onResizingStarted&&this.callbacks.onResizingStarted.call(this,e)},k.prototype.stopResizing=function(e){this.callbacks.onResizingStopped&&this.callbacks.onResizingStopped.call(this,e)},k.prototype.adjustRows=function(e){D.make(this,e.get())},k.prototype.getDroppables=function(){var o=[],t=this.gap;return this.each(function(e,i){var n=(e.isGuttered()?t:0)+2;e.each(function(e,t){o.push({droppable:e,row:i+1,column:t+1,marginBottom:n})})}),o},k.prototype.adjustSidebars=function(){var a=[];$.each(this.rows,function(e,t){var i=t.get$(),n=parseInt(i.css("marginTop")),o=i.position().top,r=i.outerHeight(!0);a[e]={top:o+n/2,middle:o+n+(r-n)/2}}),$.each(this.rows,function(e,t){var i=a[e],n=a[e+1];t.setRemoveButtonShown(!0),t.setInsertButtonShown(!0),t.setGutterButtonShown(!!n),n&&t.adjustGutterButton(n.top-15),0===e?(t.adjustInsertButton(0),t.adjustRemoveButton(n?(n.top-15)/2:i.middle)):(t.adjustInsertButton(i.top-15),t.adjustRemoveButton(i.middle-15))})},k.prototype.addRowBefore=function(e){var t=this.rows.indexOf(e);if(0<=t){var i=!0;0<t&&(i=this.rows[t-1].isGuttered());var n=this.createRow(i);this.rows[t].get$().before(n.get$()),this.rows.splice(t,0,n)}return t+1},k.prototype.addRow=function(){0<this.rows.length&&this.rows[this.rows.length-1].setGuttered(!0);var e=this.createRow(!0);return this.$template.append(e.get$()),this.rows.push(e),this.rows.length},k.prototype.removeRow=function(e){var t=this.rows.indexOf(e);return 0<=t&&(this.rows[t].remove(),this.rows.splice(t,1)),t+1},k.prototype.setOnDrop=function(e){this.callbacks.onDrop=e},k.prototype.setOnAreaHovered=function(e){this.callbacks.onAreaHovered=e},k.prototype.setOnResizingStarted=function(e){this.callbacks.onResizingStarted=e},k.prototype.setOnResizingStopped=function(e){this.callbacks.onResizingStopped=e},R.get=function(e){return e.data("agn:row")},R.prototype.createDroppable=function(){var e=new O(this),n=this;return e.setOnHoverChange(function(e,t){if(n.callbacks.onHoverChange){var i=n.droppables.indexOf(this)+1;0<i&&n.callbacks.onHoverChange.call(n,this,e,i,t)}}),e.setOnDrop(function(e){if(n.callbacks.onDrop){var t=n.droppables.indexOf(this)+1;0<t&&n.callbacks.onDrop.call(n,e,this,t)}}),e},R.prototype.get$=function(){return this.$row},R.prototype.each=function(e){this.droppables.forEach(e)},R.prototype.getDroppables=function(){return this.droppables.slice()},R.prototype.getDroppable=function(e){return this.droppables[e-1]||null},R.prototype.setHeight=function(t){t=0<t?Math.max(t,10):80,this.droppables.forEach(function(e){e.setHeight(t)})},R.prototype.isGuttered=function(){return this.$row.hasClass("guttered")},R.prototype.setGuttered=function(e){e?(this.$row.addClass("guttered"),f.setTooltip(this.$gutterButton,t("grid.gutter.hide"))):(this.$row.removeClass("guttered"),f.setTooltip(this.$gutterButton,t("grid.gutter.show")))},R.prototype.setHovered=function(n,o,r){void 0===o?this.droppables.forEach(function(e){e.setHovered(n)}):(void 0===r&&(r=o),this.droppables.forEach(function(e,t){var i=t+1;o<=i&&i<=r?e.setHovered(n):e.setHovered(!n)}))},R.prototype.remove=function(){this.droppables.forEach(function(e){e.remove()}),this.droppables=[],this.$row.remove(),f.removeTooltip(this.$gutterButton),this.$gutterButton.remove(),f.removeTooltip(this.$removeButton),this.$removeButton.remove(),f.removeTooltip(this.$insertButton),this.$insertButton.remove(),this.callbacks.onDrop=void 0},R.prototype.adjustGutterButton=function(e){this.$gutterButton.css("top",e)},R.prototype.setGutterButtonShown=function(e){f.setShown(this.$gutterButton,e)},R.prototype.adjustRemoveButton=function(e){this.$removeButton.css("top",e)},R.prototype.setRemoveButtonShown=function(e){f.setShown(this.$removeButton,e)},R.prototype.adjustInsertButton=function(e){this.$insertButton.css("top",e)},R.prototype.setInsertButtonShown=function(e){f.setShown(this.$insertButton,e)},R.prototype.setOnHoverChange=function(e){this.callbacks.onHoverChange=e},R.prototype.setOnDrop=function(e){this.callbacks.onDrop=e},O.get=function(e){return e.data("agn:droppable")},O.options=function(i){return{accept:"[data-building-block]",tolerance:"pointer",deactivate:function(){i.setHovered(!1),i.callbacks.onHoverChange&&i.callbacks.onHoverChange(!1)},drop:function(e,t){i.setHovered(!1),i.callbacks.onDrop&&i.callbacks.onDrop(b.get(t.draggable))},over:function(e,t){i.callbacks.onHoverChange?i.callbacks.onHoverChange(b.get(t.draggable),!0):i.setHovered(!0)},out:function(e,t){i.callbacks.onHoverChange?i.callbacks.onHoverChange(b.get(t.draggable),!1):i.setHovered(!1)}}},O.prototype.get$=function(){return this.$droppable},O.prototype.getCoordinates=function(){return this.$droppable.offset()},O.prototype.getRow=function(){return this.row},O.prototype.getHeight=function(){return f.getHeightAccurate(this.$droppable)},O.prototype.setHeight=function(e){this.$droppable.outerHeight(e)},O.prototype.setHovered=function(e){e?this.$droppable.addClass("container-hover-accept"):this.$droppable.removeClass("container-hover-accept")},O.prototype.setLayeringIndex=function(e){if(0<e)if(this.$rotationButton)this.$rotationButton.css("visibility",""),this.$rotationButton.find(".layer-number").text(e);else{var t=this;this.$rotationButton=r.dom("child-z-index-button",{index:e}),this.$rotationButton.on("click",function(){t.callbacks.onLayeringRotate&&t.callbacks.onLayeringRotate()}),this.$droppable.append(this.$rotationButton)}else this.$rotationButton&&this.$rotationButton.css("visibility","hidden")},O.prototype.remove=function(){this.$droppable.droppable("destroy"),this.$rotationButton&&(this.$rotationButton.remove(),this.$rotationButton=void 0),this.$droppable.remove(),this.callbacks.onDrop=void 0,this.callbacks.onHoverChange=void 0,this.callbacks.onLayeringRotate=void 0},O.prototype.setOnDrop=function(t){var i=this;this.callbacks.onDrop=function(e){t.call(i,e)}},O.prototype.setOnHoverChange=function(i){var n=this;this.callbacks.onHoverChange=function(e,t){i.call(n,e,t)}},O.prototype.setOnLayeringRotate=function(e){if(e){var t=this;this.callbacks.onLayeringRotate=function(){e.call(t)}}else this.callbacks.onLayeringRotate=void 0},N.get=function(e){var t=e.data("agn:child-dialog");return t||e.closest(".modal").data("agn:child-dialog")},N.create=function(e,t){var i=o.createFromTemplate(t,"div-editing-dialog");i.data("agn:child-dialog",new N(i,e,t))},N.prototype.updateImageSrc=function(e){var t=e.data("placeholder-id"),i=$.trim(e.val());this.updateImageSrcPreview(t,i)},N.prototype.updateImageSrcPreview=function(e,t){var i=$("#preview-"+e);i.attr("src")!==t&&i.attr("src",t||this.options.noPreviewImageLink)},N.prototype.updateImage=function(e){var t=e.data("placeholder-id"),i=e.prop("files"),n=$("#content-"+t);if(i&&i.length){var o=i[0];if("image"===o.type||o.type.match("image/.*")){var r=new FileReader,a=this;r.onload=function(e){a.updateImagePreview(t,e.target.result,o.name,o.name)},r.readAsDataURL(o)}else c.clearFormField(e),this.updateImagePreview(t)}else this.updateImagePreview(t);n.val("")},N.prototype.updateImagePreview=function(e,t,i,n){var o=$("#preview-"+e),r=$("#image-name-"+e);o.attr("src")!==t&&o.attr("src",t||this.options.noPreviewImageLink),o.attr("title",n||""),r.text(i||"")},N.prototype.chooseImage=function(e){var t=$("#file-"+e);t.val()?t.trigger("click"):this.showMediapoolDialog(e)},N.prototype.deleteImage=function(e){var t=$("#file-"+e),i=$("#image-name-"+e),n=$("#content-"+e),o=$("#preview-"+e);c.clearFormField(t),i.text(""),n.val(""),o.attr("src",this.options.noPreviewImageLink)},N.prototype.showMediapoolDialog=function(t){var i=this;a.request(this.options.urls.MEDIAPOOL_IMAGE_PICK).done(function(e){$("#content-"+t).val(e.id),$("#image-category-id-"+t).select2("val",e.categoryId),c.clearFormField($("#file-"+t)),i.updateImagePreview(t,e.src,e.name,e.title)})},N.prototype.validate=function(e){var t=this.validateImageCategories(e),i=this.validateImageFormats(e);return t&&i},N.prototype.validateImageCategories=function(r){var a=!0;return this.child.getPlaceholders(p).forEach(function(e){var i=e.id;if($("#image-category-id-"+i).val()<=0){var n=!!$("#file-"+i).val(),o=$("#content-"+i).val();(n||0<parseInt(o))&&(a=!1,r.showFieldError("image-category-id-"+i,t("error.grid.noCategorySelected")))}}),a},N.prototype.validateImageFormats=function(o){var r=!0;return this.child.getPlaceholders(p).forEach(function(e){var i=e.id,n=$("#file-"+i).val();n&&!function(e){var t=e.match(/[^.\\/]\.([^.\\/]+)$/);return!!t&&t[1].toUpperCase()in{GIF:1,JPG:1,JPEG:1,PNG:1}}(n)&&(r=!1,o.showFieldError("content-"+i,t("grid.divchild.format.error")))}),r},N.prototype.updateImagesCategories=function(){var e=$.Deferred(),n=[];if(this.child.getPlaceholders(p).forEach(function(e){var t=e.id,i=parseInt($("#content-"+t).val());0<i&&n.push({imageId:i,categoryId:$("#image-category-id-"+t).val()})}),n.length){var t={};n.forEach(function(e){t[e.imageId]=e.categoryId}),$.ajax(this.options.urls.MEDIAPOOL_SET_CATEGORIES,{type:"POST",dataType:"json",data:{categoryId:t}}).done(function(){e.resolve()}).fail(function(){e.reject()})}else e.resolve();return e.promise()},N.prototype.uploadImages=function(e){var t=$.Deferred(),n=[];if(this.child.getPlaceholders(p).forEach(function(e){var t=e.id,i=$("#file-"+t).prop("files");i&&i.length&&n.push({placeholderId:t,image:i[0],categoryId:$("#image-category-id-"+t).val()})}),n.length){var i=new FormData;n.forEach(function(e,t){i.append("images["+t+"].file",e.image),i.append("images["+t+"].title",e.image.name),i.append("images["+t+"].categoryId",e.categoryId)}),$.ajax(this.options.urls.MEDIAPOOL_IMAGE,{type:"POST",dataType:"json",accepts:["application/json"],enctype:"multipart/form-data",processData:!1,contentType:!1,data:i}).done(function(e){AGN.Lib.JsonMessages(e.popups),e.data&&e.data.forEach(function(e,t){if(0<e){var i=n[t].placeholderId;$("#content-"+i).val(e),c.clearFormField($("#file-"+i))}}),!0===e.success?t.resolve():t.reject()}).fail(function(){t.reject()})}else t.resolve();return t.promise()},N.prototype.save=function(e){var t=this;if((0===this.options.mailingId||function(e,t){var i=!1,n=[];return e.forEach(function(e){if(e.type===p)return!0;n.push($("#content-"+e.id).val())}),$.ajax({type:"POST",url:AGN.url("/layoutbuilder/template/validateHtml.action"),contentType:"application/json",async:!1,data:JSON.stringify({mailingId:t,htmlPlaceholders:n})}).done(function(e){AGN.Lib.JsonMessages(e.popups),i=e.success}),i}(this.child.getPlaceholders(),this.options.mailingId))&&this.validate(e)){var a=this.$modal,s=this.child,i=this.$modal.find(".modal-body"),n=$("#child-save-button");i.addClass("ui-modal-loading"),i.scrollTop(0),n.prop("disabled",!0),this.updateImagesCategories(e).then(function(){return t.uploadImages(e)}).always(function(){i.removeClass("ui-modal-loading"),n.prop("disabled",!1)}).done(function(){var i={},e=s.getPlaceholders();a.find(".js-wysiwyg").each(function(){var e=$(this),t=e.attr("id");CKEDITOR.instances[t]&&CKEDITOR.instances[t].updateElement(),AGN.Lib.Editor.get(e).val(e.val()),window.removeEditor(t)}),e.forEach(function(e){var t=e.id;i[t]=$("#content-"+t).val()});var t=$("#child-title").val(),n=parseInt($("#target-group-id").val()),o=$("#is-toc-enabled").is(":checked"),r=$("#is-interest-sortable").is(":checked")?$("#interest-group").val():"";a.modal("hide"),l.saveChild(s,t,n,o,r,i)})}}}),AGN.Lib.Controller.new("grid-overview",function(){var a;this.addDomInitializer("grid-overview",function(e){a=this.config,e.all(".card[data-grid-id]").each(function(){var e=$(this),t=a.grids[parseInt(e.data("grid-id"))],i=[],n=1e3/(165/90),o=1e3*t.columnWidth/t.templateWidth,r=1e3*t.gutter/t.templateWidth;e.find("svg").exists()||(e.find(".js-grid").append('<svg class="grid-preview" viewBox="0 0 1000 '+n+'"></svg>'),_.times(t.columnNum,function(e){i.push({type:"gutter",width:r/2}),i.push({type:"col",width:o}),i.push({type:"gutter",width:r/2})}),_.reduce(i,function(e,t){return(t.xPos=e)+t.width},0),d3.select(e.find("svg")[0]).selectAll("g").data(i).enter().append("g").attr("transform",function(e){return"translate("+e.xPos+",0)"}).append("rect").attr("class",function(e){return"grid-preview-"+e.type}).attr("width",function(e){return e.width}).attr("height",n))})}),this.addAction({click:"back"},function(){history.back()}),this.addAction({click:"pick"},function(){var e=a.grids[this.el.data("grid-id")];e&&$.ajax(e.viewLink,{method:"POST",data:{newTemplateName:a.newTemplateName}}).done(function(e){AGN.Lib.Page.render(e)})}),this.addAction({submission:"createNewGrid"},function(){var e=this.el,i=AGN.Lib.Form.get(e),n=e.find("#newGridName");$.ajax(a.urls.CHECK_NAME,{type:"POST",data:{name:n.val()}}).done(function(e){e.used?i.showFieldError("newGridName",t("fields.name.errors.name_in_use")):i.submit("static")})})}),AGN.Lib.Controller.new("grid-template",function(){var i,n,o=new a;function r(e,t){this.templateNameValidationUrl=t.templateNameValidationUrl,this.form=AGN.Lib.Form.get(e)}function a(){this.contentTypes={css:{inputSelector:'input[name="css"]',contentId:"#cssContents"},outerHtml:{inputSelector:'input[name="outerHtml"]',contentId:"#templateOuterHTML"},styles:{inputSelector:'input[name^="styles["]',getContentSelector:function(e){return'input[name="'+e+'"]'}}}}this.addDomInitializer("grid-template",function(){var e=this.config;n=this.el,i=new r(n,e)}),this.addAction({submission:"grid-template-validation"},function(){i.validateTemplateName(n.find("#newTemplateName"))}),this.addAction({click:"back"},function(){history.back()}),this.addAction({click:"delete"},function(){var e=this.el,i="";return i="A"==e.prop("tagName")?e.prop("href"):e.data("url"),$.get(i).done(function(e){var t=$(e);1==t.filter(".modal").add(t.find(".modal")).length?AGN.Lib.Confirm.create(e).done(function(e){AGN.Lib.Page.render(e,i)}):AGN.Lib.Page.render(e,i)}),this.event.preventDefault(),!1}),r.prototype.validateTemplateName=function(e){var i=e.val(),n=this.form,o=this.templateNameValidationUrl;""==i?n.showFieldError("newTemplateName",t("fields.required.errors.missing")):$.ajax({type:"POST",url:o,data:{newTemplateName:i}}).done(function(e){0==e.newTemplateName?n.showFieldError("templateName",t("fields.name.errors.name_in_use")):n.submit("static")})},this.addAction({click:"update-preview"},function(){var e=this.el;o.updateInputValue(e.data("target-form"),e.data("content-type"))}),a.updateFields=function(e,n,o){var t=$("form").not("#"+o.attr("id"));_.each(t.find(e),function(e){var t=$(e),i=t.val();o.find(n(t.attr("name"))).val(i)})},a.updateField=function(e,t,i){i.find(e).val(t)},a.prototype.updateInputValue=function(e,t){var i=this.contentTypes[t],n=$(e);if("styles"==t&&i&&n)a.updateFields(i.inputSelector,i.getContentSelector,n);else if(i&&n){var o=$(i.contentId).val();a.updateField(i.inputSelector,o,n)}n.submit()}}),AGN.Lib.Controller.new("header-info",function(){var n=0;this.addDomInitializer("mailing-params",function(){var e=this.config;n=e.maxIndex}),this.addAction({click:"add-mailing-parameter"},function(){var e=$("#mailingParamsTable tr:last"),t=AGN.Lib.Template.text("header-info-mailing-param-row-new",{key:++n});e.after(t);var i=e.find("#newMailingParameterBtn");i.after('<a href="#" class="btn btn-regular btn-alert" data-action="remove-mailing-parameter" id="removeMailingParameterBtn"> <i class="icon icon-trash-o"></i> </a>'),i.remove()}),this.addAction({click:"remove-mailing-parameter"},function(){this.el.closest("tr").remove()})}),AGN.Lib.Controller.new("image-editor",function(){var o,r,e=AGN.Lib.Confirm,t=AGN.Lib.Template,a=0,s=0,l=!1,i=!1;function n(e){o=e.x,r=e.y,a=e.w,s=e.h}function c(){var e=document.getElementById("editor-canvas").toDataURL();$("#editor-img").attr("src",e)}function u(){var e=document.getElementById("editor-canvas"),t=e.toDataURL(),i=$("#editor-result");i.val()!=t&&(i.val(t),i.prop("disabled",!1));var n=e.width+$("#l-img-editor-tools").width()+10;$("#l-img-editor").css("min-width",n)}function d(){var e=$("#editor-canvas").data("Jcrop");void 0!==e&&($("#editor-canvas").appendTo("#canvas-editor-area"),$("#editor-canvas").removeAttr("style"),e.destroy()),$("#editor-crop-btn").removeClass("btn-primary"),i=!1,s=a=0}this.addDomInitializer("img-editor-init",function(){i=l=!1,$("#editor-result").prop("disabled",!0)}),this.addAction({click:"editCategory"},function(){e.create(t.text("modal-element-category-select",{categoryId:$("#category-id").val()})).done(function(e){e&&e.categoryId&&$("#category-id").val(e.categoryId)})}),this.addAction({click:"cropImage"},function(){c(),i=i?(d(),u(),!1):($("#editor-canvas").Jcrop({onChange:n,onSelect:n,bgOpacity:1}),$("#editor-crop-btn").addClass("btn-primary"),!0)}),this.addAction({click:"saveCrop"},function(){c();var t=document.getElementById("editor-canvas"),i=t.getContext("2d"),n=new Image;n.src=$("#editor-img").attr("src"),1<a&&1<s&&(n.onload=function(){t.width=a,t.height=s,i.save(),i.drawImage(n,o,r,a,s,0,0,a,s),i.restore();var e=t.toDataURL();$("#editor-img").attr("src",e),$("#editor-canvas").css("width",a),$("#editor-canvas").css("height",s),$("#l-editor-img-width").attr("value",a),$("#l-editor-img-height").attr("value",s),u(),d()})}),this.addAction({click:"rotateImage"},function(){d(),c();var i=document.getElementById("editor-canvas"),n=i.getContext("2d"),e=i.toDataURL(),o=new Image;o.src=e,$("#editor-img").attr("src",e),o.onload=function(){var e=i.width,t=i.height;i.width=t,i.height=e,e=i.width,t=i.height,n.save(),n.translate(e,t/e),n.rotate(Math.PI/2),n.drawImage(o,0,0),n.restore(),u()}}),this.addAction({input:"changeSize"},function(){d();var r=document.getElementById("editor-canvas"),a=r.getContext("2d"),s=new Image;s.src=$("#editor-img").attr("src"),s.onload=function(){var e=$("#l-editor-img-width").val(),t=$("#l-editor-img-height").val(),i=s.width,n=s.height;if(l)if($("#l-editor-img-width").is(":focus")){var o=e/i;t=Math.round(o*n),$("#l-editor-img-height").attr("value",t)}else if($("#l-editor-img-height").is(":focus")){o=t/n;e=Math.round(o*i),$("#l-editor-img-width").attr("value",e)}r.width=e,r.height=t,a.save(),a.drawImage(s,0,0,e,t),a.restore(),u()}}),this.addAction({input:"pcChangeSize"},function(){d();var r=document.getElementById("editor-canvas"),a=r.getContext("2d"),s=new Image;s.src=$("#editor-img").attr("src"),s.onload=function(){var e=$("#l-editor-img-percent").val(),t=s.width,i=s.height,n=Math.round(t*(e/100)),o=Math.round(i*(e/100));$("#l-editor-img-height").attr("value",o),$("#l-editor-img-width").attr("value",n),r.width=n,r.height=o,a.save(),a.drawImage(s,0,0,n,o),a.restore(),u()}}),this.addAction({click:"blockSizes"},function(){l?(l=!1,$("#editor-lock-btn").removeClass("btn-primary")):(l=!0,$("#editor-lock-btn").addClass("btn-primary"))})}),AGN.Lib.Controller.new("import-profile",function(){this.addDomInitializer("new-recipients-action-select",function(){e(this.el.val()<=0)}),this.addAction({change:"new-recipients-action-select"},function(){e(this.el.val()<=0)});var e=function(e){$("#mailinglists").toggleClass("hidden",!e),$("#mailinglists-to-show").toggleClass("hidden",e)}}),AGN.Lib.Controller.new("logon-password-change",function(){this.addAction({click:"showPasswordChangeForm"},function(){$("#suggestion-view").addClass("hidden"),$("#submission-view").removeClass("hidden")})}),AGN.Lib.Controller.new("mailing-attachments",function(){var t,e,i,n=this;t=function(){$("#newAttachmentName").val(""),$("attachmentTargetID").prop("selectedIndex",0)},e=function(){var e=$("#newAttachment").val().match(/[^\\\/]+$/);$("#newAttachmentName").val(e)},i=function(){var e=$("#attachmentPdfFileID").find(":selected").attr("title");$("#newAttachmentName").val(e)},this.addAction({change:"use-pdf"},function(){n.runInitializer("AttachmentUsePdf")}),this.addAction({change:"update-filename"},function(){e()}),this.addAction({change:"update-pdf-filename"},function(){i(),t()}),this.addInitializer("AttachmentUsePdf",function(e){(e=e||$(document)).find('[data-action="use-pdf"]').prop("checked")?($("#attachmentPdfFileID").prop("disabled",!1),$("#newAttachment").prop("disabled",!0),i()):($("#attachmentPdfFileID").prop("disabled",!0),$("#newAttachment").prop("disabled",!1)),t()})}),AGN.Lib.Controller.new("mailing-content-controller",function(){var r,o,a,s,i=AGN.Lib.Confirm,l=AGN.Lib.Template;this.addDomInitializer("mailing-content-initializer",function(){s=$("#table_body"),o=l.prepare("mailing-content-table-entry-template"),a=this.config.saveUrl;var e=this.config.dynTagsMap,t=this.config.targetGroupList,i=this.config.interestGroupList,n=this.config.dynTagNames;r=new p(e,t,i,n),c()}),this.addAction({click:"createContentEditorModal"},function(){var e=r.getDynTagById(parseInt(this.el.data("dyn-name-id"))),t=r.isHtmlContentBlock(e.name);i.createFromTemplate({dynTag:e.clone(),targetGroups:_.cloneDeep(r.targetGroups),interestGroups:_.cloneDeep(r.interestGroups),saveUrl:_.cloneDeep(a),DynTagObject:f,isFullHtmlTags:"HTML-Version"==e.name,showHTMLEditor:t},"content-editor-template").done(function(e){r.setDynTag(e),u(e),n()})});var n=function(){$("#preview").submit()},c=function(){r.dynTags.forEach(function(e){s.append(d(e))})},u=function(e){var t=d(e);s.find('[data-dyn-name-id="'+e.id+'"]').replaceWith(t)},d=function(e){var t=e.contentBlocks.map(function(e){return h(e)},[]),i=e.contentBlocks.map(function(e){return 35<e.content.length?e.content.substring(0,35)+"...":e.content},[]);return o({id:e.id,name:e.name,targetGroups:t,contents:i})},h=function(e){var i=t("mailing.default.target_group_name");if(0<e.targetId){var n=r.getTargetGroupById(e.targetId),o=n.deleted?t("mailing.default.target_group_deleted"):n.id;i=n.targetName+" ("+o+")"}return i},p=function(e,i,n,o){this.dynTags=Object.entries(e).map(function(e){return new f(e[1])},[]),this.interestGroups=_.cloneDeep(n),this.interestGroups.unshift({column:"",shortname:t("mailing.default.interest_group_name")}),this.targetGroups=_.cloneDeep(i),this.targetGroups.unshift({id:0,targetName:t("mailing.default.target_group_name")}),this.targetGroupsMap=i.reduce(function(e,t){return e[t.id]=t,e},{}),this.dynTagNames=o,this.isHtmlContentBlock=function(e){return void 0!==o&&null!=o&&null!=o.length&&0<o.length&&o.includes(e)},this.getDynTagById=function(t){return this.dynTags.filter(function(e){return e.id===t})[0]},this.setDynTag=function(e){var t=this.getDynTagById(e.id),i=this.dynTags.indexOf(t);-1<i&&(this.dynTags[i]=e.clone())},this.getTargetGroupById=function(e){return this.targetGroupsMap[e]||{id:0,targetName:t("mailing.default.target_group_name")}}},f=function(e){this.id=e.id||0,this.name=void 0===e.dynName?e.name:e.dynName,this.mailingId=void 0===e.mailingID?e.mailingId:e.mailingID,this.interestGroup=this.interestGroup||"",this.interestGroup=void 0===e.interestValue?e.interestGroup:e.dynInterestGroup,e.contentBlocks?this.contentBlocks=e.contentBlocks.map(function(e){return new g(e)}):this.contentBlocks=Object.entries(e.dynContent).map(function(e){return new g(e[1])}),this.contentBlocks.__proto__.swap=function(e,t){var i=this[e];return this[e]=this[t],this[t]=i,this};var t={id:0,index:0,targetId:0,content:""};this.getContentBlockByTargetId=function(t){return this.contentBlocks.filter(function(e){return e.targetId===t})[0]},this.getContentBlockById=function(t){return this.contentBlocks.filter(function(e){return e.uniqueId===t})[0]},this.createNewContentBlock=function(){var e=new g(t);return e.index=this.contentBlocks.length,this.contentBlocks.push(e),n(this.contentBlocks),e},this.moveUpContentBlock=function(e){var t=this.getContentBlockById(e);1<t.index&&(this.contentBlocks.swap(t.index-1,t.index-2),n(this.contentBlocks))},this.moveDownContentBlock=function(e){var t=this.getContentBlockById(e);t.index<this.contentBlocks.length&&(this.contentBlocks.swap(t.index-1,t.index),n(this.contentBlocks))},this.setFirstContentBlock=function(e){var t=this.getContentBlockById(e);if(1<t.index){var i=this.contentBlocks.splice(t.index-1,1);this.contentBlocks=i.concat(this.contentBlocks),n(this.contentBlocks)}},this.setLastContentBlock=function(e){var t=this.getContentBlockById(e);if(t.index<this.contentBlocks.length){var i=this.contentBlocks.splice(t.index-1,1);this.contentBlocks=this.contentBlocks.concat(i),n(this.contentBlocks)}},this.changeTargetGroup=function(e,t){var i=this.getContentBlockById(e);return i.targetId=t,i},this.changeInterestGroup=function(e){this.interestGroup=e},this.changeContent=function(e,t){var i=this.getContentBlockById(e);return i.content=t||"",i},this.changeOrder=function(e){var t;this.contentBlocks=e.map((t=this,function(e){return t.getContentBlockById(parseInt(e))})),n(this.contentBlocks)},this.remove=function(e){var t=this.getContentBlockById(e),i=this.contentBlocks.indexOf(t);-1<i&&(this.contentBlocks.splice(i,1),n(this.contentBlocks))},this.clone=function(){return new f(this)};var n=function(e){e.forEach(function(e,t){e.index=t+1})}},g=function(e){void 0===g.uniqueIdCounter&&(g.uniqueIdCounter=0),this.uniqueId=++g.uniqueIdCounter,this.id=e.id,this.index=void 0===e.dynOrder?e.index:e.dynOrder,this.content=void 0===e.dynContent?e.content:e.dynContent,this.targetId=void 0===e.targetID?e.targetId:e.targetID}}),AGN.Lib.Controller.new("mailing-content-editor-controller",function(){var a,n,o,r,s,l,c,u,d,h,p,f=AGN.Lib.Modal,g=AGN.Lib.Confirm,m=AGN.Lib.Template,v=AGN.Lib.AutoSave,e=".mailingContentNamespace",y=".l-mailing-content-entry",b="content_entry_";this.addDomInitializer("mailing-content-editor-initializer",function(e){var t=f.get(e);if(a=t.dynTag,n=t.targetGroups,o=t.saveUrl,r=t.DynTagObject,s=t.showHTMLEditor,l=$("#content_area"),c=$("#ordered_area"),u=$("#target_groups"),d=$("#interest_groups"),h=$("#editable_area"),p=m.prepare("mailing-content-entry-template"),_(),C(),T(a),k(a.interestGroup),0<a.contentBlocks.length){var i=a.contentBlocks[0];G(i)}else B();D(),R();v.initialize("mailing-components/"+a.mailingId+"/"+a.id,function(){var t=Array(),e=a.contentBlocks;return Array.prototype.forEach.call(e,function(e){t.push({targetGroupId:e.targetId,content:e.content,uniqueId:e.uniqueId})}),t},null,function(e){var r;0<e.length&&(a.remove(F()),N().remove()),Array.prototype.forEach.call(e,function(e){var t=c.find(".l-stub"),i=a.createNewContentBlock();i.uniqueId=e.uniqueId,i.content=e.content,i.targetId=e.targetGroupId;var n=M(i.targetId),o=p({name:n.targetName,id:b+i.uniqueId});t.before(o),W(),r=i}),r&&(G(r),E(A()))},0)}),this.addAction({click:"selectContentEntry"},function(){var e=$(this.el),t=I(e),i=a.getContentBlockById(t);G(i)}),this.addAction({click:"deleteContentEntry"},function(){this.event.stopPropagation();var e=$(this.el).parent(),t=I(e),i=e.next(y);if(i=0<i.length?i:e.prev(y),a.remove(t),e.remove(),0<a.contentBlocks.length){var n=I(i),o=a.getContentBlockById(n);G(o)}else G(),j()}),this.addAction({click:"createEnlargedContentEditorModal"},function(){S();var i=F();if(i){var e=a.getContentBlockById(i);g.createFromTemplate({content:e.content,selectedContentBlock:i,editorType:A(),isFullHtmlTags:"HTML-Version"==a.name,showHTMLEditor:s},"enlarged-content-editor-template").done(function(e){var t=a.changeContent(i,e.content);x(t.content),E(e.editorType)})}}),this.addAction({click:"addDynContent"},function(){B()}),this.addAction({click:"saveDynTag"},function(){if(S(),w()){var i=$(this.el);$.ajax({type:"POST",url:o,dataType:"json",contentType:"application/json",data:JSON.stringify(a),success:function(e){var t=g.get(i);AGN.Lib.JsonMessages(e.popups,!0),e.success&&(t.positive(new r(e.data)),L())}})}});function i(e){u.val(e).trigger("change")}var w=function(){if(a.contentBlocks.map(function(e){return e.targetId}).filter(function(e,t,i){return-1<i.indexOf(e,t+1)},[]).length)return AGN.Lib.Messages(t("Error"),t("mailing.validation.target_group_duplicated"),"alert"),!1;var e=a.contentBlocks.filter(function(e){return 0===e.targetId},[]);return!(e.length!==a.contentBlocks.length&&e.length&&e[0].index<a.contentBlocks.length)||(AGN.Lib.Messages(t("Error"),t("mailing.validation.all_recipients_not_last"),"alert"),!1)},C=function(){$(document).off("keydown"+e),$(document).on("keydown"+e,function(e){switch(e.stopPropagation(),e.which){case 27:L();break;case 38:!function(){var e=N(),t=e.prev(y);0!==t.length&&(e.insertBefore(t),a.moveUpContentBlock(I(e)))}();break;case 40:!function(){var e=N(),t=e.next(y);0!==t.length&&(e.insertAfter(t),a.moveDownContentBlock(I(e)))}();break;default:return}})},_=function(){l.sortable({opacity:.4,delay:100,scroll:!0,scrollSensitivity:40,scrollSpeed:15,cursor:"move",items:y,helper:"clone",containment:c,appendTo:c,start:function(e,t){t.item.css("cursor","move")},stop:function(e,t){t.item.removeAttr("style");var i=$(e.target).sortable("toArray").map(function(e){return e.replace(b,"")});a.changeOrder(i)}})},A=function(){return $("#tab-content-wysiwyg").is(":visible")?"wysiwyg":$("#contentEditor").is(":visible")?"html":""},E=function(e){if(e&&""!==e){var t=$('[data-toggle-tab$="'+e+'"]');t&&t.click()}},x=function(t){var e=$("#tab-content-wysiwyg"),i=$("#contentEditor");if(e.is(":visible")){var n=CKEDITOR.instances.content;"ready"===n.status?n.setData(t):n.on("instanceReady",function(e){e.editor.setData(t)})}i.is(":visible")&&ace.edit("contentEditor").setValue(t)},S=function(){var e=F();if(0<e){var t,i=$("#tab-content-wysiwyg"),n=$("#contentEditor");if(i.is(":visible"))t=CKEDITOR.instances.content.getData();if(n.is(":visible"))t=ace.edit("contentEditor").getValue();void 0!==t&&a.changeContent(e,t)}},T=function(e){e.contentBlocks.forEach(function(e){var t=c.find(".l-stub"),i=M(e.targetId),n=p({name:i.targetName,id:b+e.uniqueId});t.before(n)})},D=function(){u.off("change"+e),u.on("change"+e,function(e){var t=parseInt($(e.target).val()),i=F();if(0<i){var n=a.changeTargetGroup(i,t);O(n)}})},k=function(e){d.val(e).trigger("change")},R=function(){d.off("change"+e),d.on("change"+e,function(e){var t=$(e.target).val();a.changeInterestGroup(t)})},O=function(e){var t=P(e.uniqueId);if(0<t.length){var i=M(e.targetId);t.find(".l-name").children().text(i.targetName)}},N=function(){return c.find(y+".selected")},F=function(){var e=N();if(0<e.length)return I(e)},M=function(t){return n.filter(function(e){return e.id===t})[0]},P=function(e,t){return(t=t||$(document)).find("#"+b+e)},I=function(e){return parseInt(e.attr("id").replace(b,""))},L=function(){$(".modal").modal("toggle")},G=function(e){S(),void 0!==e?(function(e){c.children().removeClass("selected"),P(e,c).addClass("selected")}(e.uniqueId),x(e.content),i(e.targetId)):(x(""),i(0))},B=function(){var e=c.find(".l-stub"),t=a.createNewContentBlock(),i=M(t.targetId),n=p({name:i.targetName,id:b+t.uniqueId});e.before(n),W(),G(t)},j=function(){h.is(":visible")&&h.hide()},W=function(){h.is(":hidden")&&h.show()}}),AGN.Lib.Controller.new("mailing-predelivery",function(){this.addAction({change:"adjustSpamProvider"},function(){var e;e="aol"==this.el.attr("name")?"aolonelinespam":this.el.attr("name")+"spam",this.el.prop("checked")?$('[name="'+e+'"]').prop("disabled",!1):($('[name="'+e+'"]').prop("disabled",!0),$('[name="'+e+'"]').prop("checked",!1))}),this.addAction({click:"toggleCheckboxesOn"},function(){this.el.parents(".list-group").find('input[type="checkbox"]').prop("checked",!0).trigger("change")}),this.addAction({click:"toggleCheckboxesOff"},function(){this.el.parents(".list-group").find('input[type="checkbox"]').prop("checked",!1).trigger("change")}),this.addInitializer("readjustSpamProviders",function(){_.each({aol:"aolonelinespam",yahoo:"yahoospam",gmailnew:"gmailnewspam",ol2003:"ol2003spam"},function(e,t){var i=$("[name="+t+"]");0!=i.length&&(i.prop("checked")?$('[name="'+e+'"]').prop("disabled",!1):($('[name="'+e+'"]').prop("disabled",!0),$('[name="'+e+'"]').prop("checked",!1)))})})}),AGN.Lib.Controller.new("mailing-preview",function(){this.addInitializer("MailingPreview",function(e){e=e||$(document),function(){var e=!1;$("[data-stored-field]").each(function(){"previewCustomerATID"!==$(this).attr("name")&&"previewCustomerEmail"!==$(this).attr("name")&&AGN.Lib.Storage.restoreChosenFields($(this))&&(e=!0)}),e?(AGN.Lib.Storage.restoreChosenFields($("[name='previewCustomerATID']")),AGN.Lib.Storage.restoreChosenFields($("[name='previewCustomerEmail']"))):1==$("#preview_customer_Email").prop("checked")?(AGN.Lib.Storage.restoreChosenFields($("[name='previewCustomerEmail']"))&&(e=!0),AGN.Lib.Storage.restoreChosenFields($("[name='previewCustomerATID']"))):1==$("#preview_customer_ATID").prop("checked")&&(AGN.Lib.Storage.restoreChosenFields($("[name='previewCustomerATID']"))&&(e=!0),AGN.Lib.Storage.restoreChosenFields($("[name='previewCustomerEmail']")));e&&$("#preview").submit()}(),$("[data-stored-field]").change(function(){AGN.Lib.Storage.saveChosenFields($(this))})})}),AGN.Lib.Controller.new("mailing-priorities",function(){var o,r,a,s,l,c,u,d,h,t=AGN.Lib.Template,p=AGN.Lib.Helpers,i=AGN.Lib.DateFormat,f=2,g=0;function m(e){var t=[];return a.children(".l-mailing-entry").each(function(){var e=$(this).data("id");0<e&&t.push(e)}),e?t.join(e):t}function n(e){var t=m(";"),i=r.val();if(null==u&&null==d||e)if(u=t,0<(d=i))o.prop("disabled",!0);else{var n=function(){var e=0;return a.children(".l-mailing-entry").each(function(){0<$(this).data("id")&&e++}),e}();r.val(n),o.prop("disabled",!n)}else o.prop("disabled",t==u&&i==d)}function v(e,t){return i.toArray(i.parse(e),t)}var y=function(e){var i=[],n=_.clone(e);return _.keys(c).forEach(function(e){c[e].forEach(function(e){if(e.mailingType==f&&!n.includes(e.id)){var t=_.clone(e);t.priority=0,n.push(t.id),i.push(t)}})}),i};function b(e){var t=function(e){var t=c[e]||[],i=(t=t.filter(function(e){return e.mailingType!=f||e.mailingType==f&&0<e.priority})).map(function(e){return e.id});return _.union(t,y(i),"id")}(e);$("#datebased-container, #normal-container, #ordered-area").find(".l-mailing-entry").remove(),function(e){e&&e.length&&e.forEach(function(e){!function(e){var t="normal-mailing-icon";e.mailingType==f&&(t="datebase-mailing-icon");e.iconClass=t}(e);var t=h(e),i=e.priority,n=e.mailingType;i?a.find(".l-stub").before(t):(n==f&&s.find(".l-stub").before(t),n==g&&l.find(".l-stub").before(t))})}(t),n(!0)}function w(e,t){t?e.parent().addClass("highlight"):e.parent().removeClass("highlight")}function C(e){var i=[!0],t=v(function(e){for(var t in e){if(c[e[t]].find(function(e){return e.mailingType==f}))return e[t]}return""}(e));return(t?e.filter(function(e){return e<t}):e).forEach(function(e){var t=v(e);t&&i.push(t)}),t&&i.push({from:t,to:function(e,t,i,n){var o=_.clone(e);return t&&(o[0]=e[0]+t),i&&(o[1]=e[1]+i),n&&(o[2]=e[2]+n),o}(t,50)}),i}function A(e){var t=$("#date-picker"),i=_.keys(e).sort();if(i.length){var n=C(i);t.pickadate(_.merge({editable:!0,disable:n,klass:{input:"picker__input js-datepicker",holder:"datepicker__holder picker__holder datepicker__holder-right"}},p.objFromString(t.data("datepicker-options"))));var o=t.pickadate("picker");o.get("select")||o.set("select",v(_.reduce(_.keys(c),function(e,t){return e<t?e:t})))}else t.pickadate({editable:!1});t.trigger("change")}this.addDomInitializer("mailing-priorities",function(){!function(e){o=$("#save-button"),r=$("#priorityCount"),a=$("#ordered-area"),s=$("#datebased-container"),l=$("#normal-container"),c=e.mailingsMap,h=t.prepare("draggable-mailing-entry")}(this.config);var e=$(".l-content-area");$(".priority-container").sortable({opacity:.4,connectWith:".priority-container",items:".l-mailing-entry",helper:"clone",containment:e,appendTo:e,update:function(){this.id===a.attr("id")&&(function(){var e=1;a.children(".l-mailing-entry").each(function(){$(this).find(".l-badge .badge").text(e++)})}(),n())},out:function(){w($(this),!1)},over:function(e,t){w($(e.target),!1),w($(this),!0)},start:function(){w($(this),!0)},stop:function(){w($(this),!1)},receive:function(e,t){var i=t.item.data("type");!function(e,t){var i=e===s.attr("id"),n=e===l.attr("id");return e===a.attr("id")||i&&t==f||n&&t==g}(e.target.id,i)&&t.sender.sortable("cancel")}}),A(c)}),this.addAction({click:"back"},function(){window.history.back()}),this.addAction({click:"save"},function(){var e=AGN.Lib.Form.get(this.el);e.setValueOnce("prioritizedIds",m()),e.submit()}),this.addAction({change:"priorityCount"},function(){n()}),this.addAction({change:"change-date"},function(){var e=this.el.pickadate("picker").get("select");e?b(function(e){return p.pad(e[0],4)+"-"+p.pad(parseInt(e[1])+1,2)+"-"+p.pad(e[2],2)}([e.year,e.month,e.date])):b()})}),AGN.Lib.Controller.new("mailing-send",function(){var o=AGN.Lib.Form,e=AGN.Lib.Modal,i=AGN.Lib.Confirm,n=AGN.Lib.Page,r=AGN.Lib.Template,a=AGN.Lib.Tooltip,s=function(){$("#test-send-controls-group").hide()},l=function(){$("#test-send-controls-group").show()};this.addAction({click:"configure-delivery-mailing-size-warning"},function(){var e=this.el;i.createFromTemplate({},"warning-mailing-size-modal").done(function(){e.prop("disabled",!0),n.reload(e.data("url"))})}),this.addAction({click:"configure-delivery-mailing-size-error"},function(){e.createFromTemplate({},"error-mailing-size-modal")}),this.addAction({click:"configure-delivery"},function(){this.el.prop("disabled",!0),n.reload(this.el.data("url"))}),this.addAction({click:"start-delivery"},function(){var e=this.el.data("action-value"),i=o.get(this.el);if(-1==$("#adminTargetGroupSelect").val()){var n=!0;if($('input[name="mailingTestRecipients"]').each(function(){var e=$(this).val();e&&e.trim()&&(n=!1)}),n)return void AGN.Lib.Messages(t("defaults.error"),t("error.enterEmailAddresses"),"alert")}s(),i.setValue("action",e),i.submit()}),this.addAction({click:"check-links"},function(){var e=this.el.data("action-value"),t=o.get(this.el);s(),t.setValue("action",e),t.submit()}),this.addAction({click:"recipients-row-remove"},function(){var e,t,i=this.el.closest("tr"),n=$('[name="statusmailRecipients"]');i.remove(),t=$('[name^="statusmailRecipient_"]'),e=_.map(t,function(e){return $(e).val()}),n.val(e.join(" ")),o.get(this.el).submit()}),this.addAction({click:"recipients-row-add",keydown:"recipients-row-field"},function(){if("keydown"!=this.event.type||13==this.event.keyCode){var e,t=$("#newStatusMail"),i=$('[name^="statusmailRecipient_"]'),n=$('[name="statusmailRecipients"]');(e=_.map(i,function(e){return $(e).val()})).push(t.val()),n.val(e.join(" ")),o.get(this.el).submit().done(function(){$("#newStatusMail").focus()})}}),this.addInitializer("statusmailRecipients",function(e){var t,i=$('[name="statusmailRecipients"]'),n=$("#statusEmailContainer");$(".js-recipients-row").remove(),""!=i.val()&&(t=(t=i.val()||"").split(" "),_.each(t,function(e){""!=e&&n.prepend(r.text("recipients-row",{email:e}))}))}),this.addDomInitializer("transmission-status",function(){this.config.isRunning?s():l()}),this.addAction({click:"add-test-recipient",enterdown:"new-test-recipient"},function(){this.event.preventDefault();var e=this.el.closest("tr"),t=this.el.is("input")?this.el:e.find("input"),i=r.dom("test-recipient-row",{value:t.val()||""});e.before(i),t.val(""),AGN.runAll(i),t.focus()}),this.addAction({enterdown:"edit-test-recipient"},function(){this.event.preventDefault()}),this.addAction({click:"remove-test-recipient"},function(){var e=this.el.closest("tr");a.remove(e.all("[data-tooltip]")),e.remove()}),this.addAction({change:"admin-target-group"},function(){var e=-1==this.el.val();$("#test-recipients-table").toggleClass("hidden",!e),$("#adminSendButton").toggleClass("hidden",e)}),this.addAction({change:"prioritization-toggle"},function(){var e=this.el,i=e.prop("checked");function n(){e.prop("checked",!i),AGN.Lib.Messages(t("defaults.error"),t("defaults.error"),"alert")}e.prop("disabled",!0),$.ajax({type:"POST",url:e.data("url"),data:{isPrioritizationDisallowed:e.is(":checked")}}).done(function(e){e&&e.success?AGN.Lib.Messages(t("defaults.success"),t("defaults.saved"),"success"):n()}).fail(n).always(function(){e.prop("disabled",!1)})}),this.addAction({change:"sendStatusOnErrorOnly-toggle"},function(){var e=this.el,i=e.prop("checked");function n(){e.prop("checked",!i),AGN.Lib.Messages(t("defaults.error"),t("defaults.error"),"alert")}e.prop("disabled",!0),$.ajax({type:"POST",url:e.data("url"),data:{statusmailOnErrorOnly:e.is(":checked")}}).done(function(e){e&&e.success?AGN.Lib.Messages(t("defaults.success"),t("defaults.saved"),"success"):n()}).fail(n).always(function(){e.prop("disabled",!1)})})}),AGN.Lib.Controller.new("mailing-styles",function(){function e(){var e=$("form#mailingGridForm"),o=$("form#mailingPreviewForm"),t=e.find('input[name^="styles."]');$.each(t,function(e,t){var i=$(t),n="styles["+i.attr("name").split(".")[1]+"]";o.find('input[name="'+n+'"]').val(i.val())}),o.submit()}this.addAction({submission:"updatePreview"},function(){e()}),this.addAction({click:"updateMailingPreview"},function(){e()}),this.addAction({click:"saveMailingStyles"},function(){$("form#mailingGridForm").submit()})}),AGN.Lib.Controller.new("mailing-view-base",function(){var n,o=AGN.Lib.Form,r=AGN.Lib.Tooltip,e=!1,a=[];function s(e){var t=e.closest(".tile");return t.exists()?t.position().top:e.position().top}function i(e){n.followUpAllowed&&l(n.TYPE_FOLLOWUP==e,"#followUpControls"),l(n.TYPE_INTERVAL==e,"#mailingIntervalContainer"),l(n.TYPE_DATEBASED==e,"#mailing-bcc-recipients"),l(!(n.TYPE_ACTIONBASED==e||n.TYPE_DATEBASED==e&&n.isWorkflowDriven),"#mailingTargets")}function l(e,t){var i=$(t);i&&(e?(i.removeClass("hidden"),i.show()):i.hide())}this.addDomInitializer("mailing-view-base",function(){n=this.config,0<this.config.scrollTop&&$("#gt-wrapper").animate({scrollTop:n.scrollTop},50),a=$("#targetGroupIds").val()||[],$("#targetModeCheck").closest(".form-group").toggle(1<a.length),i(n.mailingType)}),this.addAction({change:"selectTargetGroups"},function(){var e=this.el.val()||[],t=$("#targetModeCheck"),i=t.closest(".form-group");1<e.length&&a.length<=1&&t.prop("checked",!0),i.toggle(1<e.length),a=e}),this.addAction({click:"calculateRecipients"},function(){var i=$("#calculatedRecipientsBadge");n&&$.ajax(n.urls.MAILINGBASE,{type:"POST",traditional:!0,data:$.extend(function(e){var o={};return e.forEach(function(e){var t=$(e);if(t.exists()&&!t.prop("disabled")){var i=t.prop("name"),n=t.val();i&&(o[i]=n)}}),o}(["#settingsGeneralMailingList","#settingsTargetgroupsListSplit","#settingsTargetgroupsListSplitPart","#lightWeightMailingList","#assignTargetGroups","#targetGroupIds","#followUpType"]),{action:n.actions.ACTION_RECIPIENTS_CALCULATE,mailingID:n.mailingId,changeMailing:e,targetMode:$("#targetModeCheck").prop("checked")?n.TARGET_MODE_AND:n.TARGET_MODE_OR})}).always(function(e){e&&!0===e.success?i.text(e.count):(i.text("?"),AGN.Lib.Messages(t("defaults.error"),t("defaults.error"),"alert"))})}),this.addAction({change:"change-mailing-settings"},function(){e=!0}),this.addAction({click:"deleteMailingParameter"},function(){var e=o.get(this.el),t=s(this.el),i=this.el.closest("tr");r.remove(i.all("[data-tooltip]")),i.remove(),e.setValueOnce("scrollTop",Math.round(t)),e.submit()}),this.addAction({click:"createMailingParameter"},function(){var e=o.get(this.el),t=s(this.el);e.setValueOnce("addParameter",!0),e.setValueOnce("scrollTop",Math.round(t)),e.submit()}),this.addAction({change:"change-general-mailing-type"},function(){i(this.el.val())})}),AGN.Lib.Controller.new("mailinglist-list",function(){var o=null;this.addDomInitializer("mailinglist-list",function(){o=this.config}),this.addAction({click:"bulk-delete"},function(){var e=function(){var e=$(".js-data-table-body");if(e.exists()){var t=e.data("_table");if(t&&t.api)return t.api}return null}();if(e){var i=e.getSelectedRows();(function(e){var i=$.Deferred();if(e&&e.length){var n=$.ajax(o.urls.MAILINGLIST_BULK_DELETE,{method:"POST",traditional:!0,data:{bulkIds:e}}).fail(function(){i.reject()});AGN.Lib.Confirm.request(n).then(i.resolve,i.reject)}else i.reject(),AGN.Lib.Messages(t("Error"),t("messages.error.nothing_selected"),"alert");return i.promise()})(i.map(function(e){return e.id})).done(function(){e.updateRowData({remove:i})})}})}),AGN.Lib.Controller.new("mediapool-element-category-select",function(){var n=AGN.Lib.Confirm,i=AGN.Lib.Helpers,o=AGN.Lib.Select;this.addDomInitializer("mediapool-element-category-select",function(e){var t=i.objFromString(e.data("config"));t&&t.categoryId&&o.get($("#mediapool-file-category-id")).selectValueOrSelectFirst(t.categoryId)}),this.addAction({change:"selectCategory"},function(){var e=this.el.parents(".form-group");e.removeClass("has-alert has-feedback js-form-error"),e.find(".js-form-error-msg").addClass("hidden")}),this.addAction({click:"applyCategory"},function(){var e=$("#mediapool-file-category-id"),t=parseInt(e.val());if(0<t)n.get(this.el).positive({categoryId:t});else{var i=e.parents(".form-group");i.addClass("has-alert has-feedback js-form-error"),i.find(".js-form-error-msg").removeClass("hidden")}})}),AGN.Lib.Controller.new("mediapool-overview",function(){var i,n,o,r=AGN.Lib.Helpers,a=AGN.Lib.Template,s=AGN.Lib.Confirm,l=AGN.Lib.Form,c=AGN.Lib.Page;function u(e,t){e.all("input, textarea, select, button").prop("disabled",!t)}function d(e,t){$.ajax(i.urls.VERIFY_IMAGE_URL,{data:JSON.stringify({imageName:e}),contentType:"application/json",async:!1,type:"POST",success:t})}this.addDomInitializer("mediapool-overview",function(){n={},i=this.config,this.config.imagesList.forEach(function(e){n[e.id]=e})}),this.addAction({click:"replace-image"},function(){var e=this.el.data("image-id");if(o=n[e]){var t=$("#replacement-image");r.clearFormField(t),t.trigger("click")}}),this.addAction({change:"replacement-image"},function(){var e=this.el.prop("files");if(e&&e.length&&o){var t=new FileReader,i=e[0];t.onload=function(e){o&&function(e){var t=a.dom("modal-replace-image",e);t.find("form").data("selected-file",e.file),e.preview&&t.find("#replacement-preview").prop("src",e.preview),s.create(t)}({image:o,file:i,preview:e.target.result})},t.readAsDataURL(i)}}),this.addAction({"upload:add":"mediapool-upload-image"},function(){var t=this.data;d(t.file.name,function(e){t.file.id=e.data})}),this.addAction({submission:"submit-image-save"},function(){var e=this.el,t=l.get(e),i=t._dataNextRequest;this.event.preventDefault();var n=1,o=!0;for(key in i){var r=$("[name='images["+n+"].fileName']").val(),a=$("[id='overwrite-"+n+"']").is(":checked");d(r,function(e){e.data&&!a?(o=!1,$("[name='images["+n+"].id']").val(e.data),$("[id='duplication-error-"+n+"']").removeAttr("hidden")):a||$("[id='duplication-error-"+n+"']").hide()}),n++}o&&t.submit()}),this.addAction({submission:"submit-image-replace"},function(){var e=this.el,t=l.get(e),i=new FormData;$.each(t.data(),function(e,t){i.append(e,t)}),i.append("file",this.el.data("selected-file")),u(e,!1),$.ajax(t.getAction(),{type:"POST",dataType:"html",enctype:"multipart/form-data",processData:!1,contentType:!1,data:i}).always(function(){u(e,!0)}).done(function(e){c.render(e,!1)})}),this.addAction({click:"change-category-bulk"},function(){var i=this.el.data("form-url"),n=l.get(this.el),e=n.data();e&&e.bulkId&&e.bulkId.length?s.create(a.text("modal-element-category-select",{categoryId:null})).done(function(e){e&&e.categoryId&&(n.setActionOnce(i),n.setValueOnce("categoryId",e.categoryId),n.submit())}):AGN.Lib.Messages(t("Error"),t("messages.error.nothing_selected"),"alert")})}),function(){var s={data:{chartsColors:["#0071b9","#009999","#92d050","#41641a","#ffc000"],browserChartData:{c3data:{bindto:"#typeStatistics",data:{rows:[],type:"donut"},donut:{label:{show:!0}},legend:{position:"right"},tooltip:{show:!1}},build:function(e,t){this.c3data.data.rows=[e,t];for(var i={},n=0;n<e.length;n++)i[e[n]]=s.data.chartsColors[n];return this.c3data.data.colors=i,this.c3data}}},roundTo:function(e,t){return 1*parseFloat(e).toFixed(t)},updateChart:function(e){$.ajax({type:"GET",url:e,success:function(e){var t=[],i=[],n=0;for(var o in e){var r=s.roundTo(100*e[o],1);t.push(o),i.push(r),n+=r}if(!isNaN(n)&&0<n)for(var a=0;a<i.length;a++)t[a]+=" "+s.roundTo(100*i[a]/n,1)+"%";c3.generate(s.data.browserChartData.build(t,i)),AGN.Initializers.Equalizer()}})}},o={data:{chartsColors:["#0071b9","#92D050"],statusChartData:{columnTitles:[],c3data:{bindto:"#statusStatistics",data:{columns:[],type:"bar",labels:!0,color:function(e,t){return o.data.chartsColors[t.index]}},axis:{x:{tick:{centered:!0,fit:!0,format:function(e){return o.data.statusChartData.columnTitles[e]}}},y:{show:!1}},legend:{show:!1},tooltip:{format:{title:function(){return null},name:function(e,t,i,n){return o.data.statusChartData.columnTitles[n]},value:function(e,t,i,n){return e}}},padding:{right:25,left:25}},build:function(e,t){this.columnTitles=e;var i=t.slice(0);return i.unshift("values"),this.c3data.data.columns=[i],this.c3data}}},updateChart:function(e){$.ajax({type:"GET",url:e,success:function(e){var t=[],i=[];for(var n in e)t.push(n),i.push(e[n]);c3.generate(o.data.statusChartData.build(t,i)),AGN.Initializers.Equalizer()}})}},c={data:{chartColors:["#0071b9","#006600","#b30000"],globalProgressChartData:{columnTitles:[],c3data:{bindto:"#progressStatistics",data:{x:"x",columns:[]},axis:{x:{type:"category",tick:{centered:!0,fit:!1}}},padding:{right:25}},build:function(e,t,i,n){this.c3data.data.columns=[e,t,i,n];var o={};return o[t[0]]=c.data.chartColors[0],o[i[0]]=c.data.chartColors[1],o[n[0]]=c.data.chartColors[2],this.c3data.data.colors=o,this.c3data}}},updateChart:function(e,t){c.data.globalProgressChartData.c3data.bindto=t.bindto,$.ajax({type:t.requestType,url:e,data:{month:t.month,year:t.year,start:t.start,end:t.end},success:i})}};function i(e){var t=["x"],i=[],n=[],o=[];for(var r in e){var a=e[r];for(var s in a){0==r&&"time"!=s&&(0==i.length?i.push(s):0==n.length?n.push(s):0==o.length&&o.push(s));var l=a[s];"time"==s?t.push(l):s==i[0]?i.push(l):s==n[0]?n.push(l):s==o[0]&&o.push(l)}}c3.generate(c.data.globalProgressChartData.build(t,i,n,o)),AGN.Initializers.Equalizer()}function t(e,t,i,n){var o,r,a,s=$("#typeStatistics"),l=$("#statusStatistics"),c=$("#progressStatistics"),u=$("#dateSelectMode");e?s.show():s.hide(),t?l.show():l.hide(),i?c.show():c.hide(),i?u.show():u.hide(),n&&(o="week"===n,r="month"===n,a="period"===n),function(e,t,i){e&&($("#weekProgressStat").addClass("active"),$("#monthProgressStat").removeClass("active"),$("#periodProgressStat").removeClass("active"),$("#weekTab").show(),$("#monthTab").hide(),$("#periodTab").hide());t&&($("#weekProgressStat").removeClass("active"),$("#monthProgressStat").addClass("active"),$("#periodProgressStat").removeClass("active"),$("#weekTab").hide(),$("#monthTab").show(),$("#periodTab").hide());i&&($("#weekProgressStat").removeClass("active"),$("#monthProgressStat").removeClass("active"),$("#periodProgressStat").addClass("active"),$("#weekTab").hide(),$("#monthTab").hide(),$("#periodTab").show())}(o,r,a)}function n(e,t){var i=AGN.Lib.Helpers.objFromString(e.data("config"));i&&i.url&&t.updateChart(i.url)}function r(e,t,i){var n=$("#selectMonth").val(),o=$("#selectYear").val(),r=$("#startDay").val(),a=$("#endDay").val();i.month=n,i.year=o,i.start=r,i.end=a;var s=AGN.Lib.Helpers.objFromString(e.data("config"));s&&s.url&&t.updateChart(s.url,i)}AGN.Lib.Controller.new("messenger-global-statistics",function(){this.addDomInitializer("messenger-global-type-stat",function(e){n(e,s),t(!0,!1,!1)}),this.addDomInitializer("messenger-global-status-stat",function(e){n(e,o),t(!1,!0,!1)}),this.addDomInitializer("messenger-global-week-progress-stat",function(e){r(e,c,{bindto:"#weekProgressStatistics",requestType:"GET"}),t(!1,!1,!0,"week")}),this.addDomInitializer("messenger-global-month-progress-stat",function(e){r(e,c,{bindto:"#monthProgressStatistics",requestType:"POST"}),t(!1,!1,!0,"month")}),this.addDomInitializer("messenger-global-period-progress-stat",function(e){r(e,c,{bindto:"#periodProgressStatistics",requestType:"POST"}),t(!1,!1,!0,"period")}),this.addAction({change:"choose-stats"},function(){!function(e){var t=e.val();"STATUS"===t&&AGN.Lib.DomInitializer.try("messenger-global-status-stat"),"TYPE"===t&&AGN.Lib.DomInitializer.try("messenger-global-type-stat"),"PROGRESS"===t&&AGN.Lib.DomInitializer.try("messenger-global-week-progress-stat")}(this.el)}),this.addAction({change:"month-statistic"},function(){AGN.Lib.DomInitializer.try("messenger-global-month-progress-stat")}),this.addAction({change:"period-statistic"},function(){AGN.Lib.DomInitializer.try("messenger-global-period-progress-stat")}),this.addAction({click:"choose-week"},function(){AGN.Lib.DomInitializer.try("messenger-global-week-progress-stat")}),this.addAction({click:"choose-month"},function(){AGN.Lib.DomInitializer.try("messenger-global-month-progress-stat")}),this.addAction({click:"choose-period"},function(){AGN.Lib.DomInitializer.try("messenger-global-period-progress-stat")})})}(),AGN.Lib.Controller.new("messenger-message-stat",function(){this.addAction({change:"statistic-date-change"},function(){var e=$("#startDate").val(),t=$("#endDate").val();$("#startDate").pickadate("picker").set("max",t),$("#endDate").pickadate("picker").set("min",e),AGN.Lib.DomInitializer.try("message-stat")})}),AGN.Lib.Controller.new("messenger-settings",function(){var r=null;function i(e){null==e&&(e=$("#messageContent").val().length),$("#contentSize").text(t("fields.content.charactersEntered",e))}function a(e){return!!e&&("image"==e||e.startsWith("image/"))}this.addDomInitializer("messenger-settings",function(){i();var e=$("#messageContent"),t=e.data("emojioneArea");t?t.on("change input",_.throttle(function(){i(this.getText().length)},100)):e.on("change input",_.throttle(function(){i()},100)),r=this.config.attachment}),this.addAction({click:"preview"},function(){(function(){var t=$.Deferred();if($("#typeBinary").is(":checked")){var e=$("#file").prop("files");if(e&&e.length){var i=e[0];if(a(i.type)){var n=new FileReader;n.onload=function(e){AGN.Lib.Loader.hide(),t.resolve({type:"image"},e.target.result)},n.onerror=n.onabort=function(){AGN.Lib.Loader.hide()},AGN.Lib.Loader.show(),n.readAsDataURL(i)}else t.resolve({type:"custom",name:i.name,size:AGN.Lib.Helpers.formatBytes(i.size,"IEC"),ext:function(e){if(e){var t=e.lastIndexOf(".");if(0<=t){var i=e.substring(t+1,e.length);return 5<i.length?i.substr(0,3)+"‚Ä¶":i}}return""}(i.name).toUpperCase()})}else r&&0<r.size?a(r.mime)?t.resolve({type:"image"},r.attachmentLink):t.resolve({type:"custom",name:r.filename,size:AGN.Lib.Helpers.formatBytes(r.size,"IEC"),ext:(r.extension||"").toUpperCase()}):t.resolve(!1)}else if($("#typeUrl").is(":checked")){var o=$.trim($("#url").val());o?t.resolve({type:"image"},o):t.resolve(!1)}else t.resolve(!1);return t.promise()})().done(function(e,i){var n=$("#messageContent").val(),o=new Date,r=AGN.Lib.Helpers.pad(o.getHours(),2)+":"+AGN.Lib.Helpers.pad(o.getMinutes(),2);if(n&&$.trim(n)||e){var a=AGN.Lib.Modal.createFromTemplate({content:n,time:r,attachment:e},"preview-modal");e&&"image"==e.type&&i&&a.find("#attachment-image").prop("src",i)}else AGN.Lib.Messages(t("defaults.warning"),t("error.content.empty"),"warning")})})}),AGN.Lib.Controller.new("news-editor",function(){var o=AGN.Lib.Template,r=["de","en"],a=0;function i(e,t,i){if(""!=e){var n=o.dom("news-content-template-row",{lang:e,index:a,title:t,content:i});0==$("#news-content-editor > .l-news-content-block").length&&$("#news-content-editor").append('<div class="tile-separator"></div>'),n.appendTo("#news-content-editor"),AGN.runAll(n),l(),a++}}function n(){var e=c(),t=$("#news-content-editor > .l-news-content-block").last().find("input[name='index']").val();r.length==e.length?$("#add-news-"+t).hide():$("#add-news-"+t).show()}function s(){var e=$("#news-content-editor > .l-news-content-block");$("button[id^='add-news-']").hide();var t=$(e).first().find("input[name='index']").val();1==e.length?$("#delete-news-"+t).hide():$("#delete-news-"+t).show()}function l(){var e=function(){var i=[],n=c();return $.each(r,function(e,t){-1==$.inArray(t,n)&&i.push(t)}),i}();$("#news-content-editor > .l-news-content-block").find("select.news-language").each(function(){$("option",this).not(":selected").remove();var i=$(this);$.each(e,function(e,t){$(i).append($("<option>",{value:t,text:t}))})})}function c(){return $("#news-content-editor > .l-news-content-block").find("select.news-language").find("option:selected").map(function(){return $(this).val()}).toArray()}function u(){var i=c(),n="";return 0==i.length?n=r[0]:$.each(r,function(e,t){if(i.indexOf(t)<0)return n=t,!1}),n}this.addDomInitializer("news-editor-init",function(){var e=$('input[name="newsId"]').val(),t=$(".existent-news");t&&0<t.length&&0==e?$(t).each(function(){i($(this).find(".existent-news-language").val(),$(this).find(".existent-news-title").val(),$(this).find(".existent-news-content").val()),s(),n(),$(this).remove()}):0==e&&(i(u(),"",""),s(),n())}),this.addAction({click:"addNewsContent"},function(){i(u(),"",""),s(),n()}),this.addAction({click:"removeNewsContent"},function(){var e=$(this.el).closest(".l-news-content-block");$(e).remove(),s(),n(),l()}),this.addAction({change:"changeLanguage"},function(){l()})}),AGN.Lib.Controller.new("notification-global-stat",function(){function e(e,t){$("#month-progress-stat").hide(),$("#daterange-progress-stat").hide(),e&&$("#month-progress-stat").show(),t&&$("#daterange-progress-stat").show()}function t(e,t,i){$("#weekProgressStat").removeClass("active"),$("#monthProgressStat").removeClass("active"),$("#dateRangeProgressStat").removeClass("active"),e&&$("#weekProgressStat").addClass("active"),t&&$("#monthProgressStat").addClass("active"),i&&$("#dateRangeProgressStat").addClass("active")}function i(e,t,i){$("#notificationGlobalStatusStat").hide(),$("#notificationGlobalBrowserStat").hide(),$("#notificationGlobalProgressStat").hide(),e&&(AGN.Lib.DomInitializer.try("notification-global-progress-stat"),$("#notificationGlobalProgressStat").show(),$("#dateSelectMode").show(),$("#dateModeControls").show()),t&&(AGN.Lib.DomInitializer.try("notification-global-status-stat"),$("#notificationGlobalStatusStat").show(),$("#dateSelectMode").hide(),$("#dateModeControls").hide()),i&&(AGN.Lib.DomInitializer.try("notification-global-browser-stat"),$("#notificationGlobalBrowserStat").show(),$("#dateSelectMode").hide(),$("#dateModeControls").hide())}function n(){$("#notifications-container").hide(),!function(){if("active"==$("#dateRangeProgressStat").attr("class")){var e=$("#startDay").val(),t=$("#endDay").val();if(o(e)||o(t))return $("#notifications-container").show(),setTimeout(function(){$("#notifications-container").fadeOut("slow")},7e3),!1;if(new Date(e).getTime()>new Date(t).getTime())return $("#notifications-container").show(),setTimeout(function(){$("#notifications-container").fadeOut("slow")},7e3),!1}return!0}()||"active"!=$("#monthProgressStat").attr("class")&&"active"!=$("#dateRangeProgressStat").attr("class")||AGN.Lib.DomInitializer.try("notification-global-progress-stat")}function o(e){return void 0===e||""==e}this.addAction({change:"selectReportType"},function(){var e=$("#globalStatInfo");switch(this.el.val()){case"STATUS":i(!1,!0,!1),e.show();break;case"BROWSER":i(!1,!1,!0),e.hide();break;case"PROGRESS":i(!0,!1,!1),e.show()}}),this.addAction({click:"close"},function(){$("#notifications-container").fadeOut("slow")}),this.addAction({click:"refreshStat"},function(){n()}),this.addAction({change:"select-month"},function(){n()}),this.addAction({change:"select-year"},function(){n()}),this.addAction({click:"weekProgressStat"},function(){$("#selectMode").val("WEEK"),e(!1,!1),n(),t(!0,!1,!1)}),this.addAction({click:"monthProgressStat"},function(){$("#selectMode").val("MONTH"),e(!0,!1),$("#refreshStat").show(),t(!1,!0,!1),n()}),this.addAction({click:"dateRangeProgressStat"},function(){$("#selectMode").val("RANGE"),e(!1,!0),$("#refreshStat").show(),t(!1,!1,!0),n()}),this.addAction({change:"end-date-change"},function(){var e=$("#startDay").val(),t=$("#endDay").val();$("#startDay").pickadate("picker").set("max",t),$("#endDay").pickadate("picker").set("min",e),n()}),this.addAction({change:"start-date-change"},function(){var e=$("#startDay").val(),t=$("#endDay").val();$("#startDay").pickadate("picker").set("max",t),$("#endDay").pickadate("picker").set("min",e),n()})}),AGN.Lib.Controller.new("notification-schedule",function(){var t,n,o,i;function r(){var e=t.pickadate("get","select");return e&&new Date(e.obj)}function a(){var e=n.pickadate("picker"),t=r();if(e.off("set"),t){var i=u(t);l(t,i),s(i),c(o.val())}else l(!0,!1),s(null),c(null);e.on("set",d)}function e(){var e=r();e?l(e,u(e)):l(!0,!1)}function s(e){var t=n.pickadate("picker");e?t.set("select",e):t.clear()}function l(e,t){var i=n.pickadate("picker");i.set("min",e),i.set("max",t),i.set("select",i.get("select"))}function c(e){i.val(e)}function u(e){var t=new Date(e);return t.setDate(t.getDate()+28),t}function d(){n.removeClass("enableable"),i.removeClass("enableable"),n.pickadate("off","set"),i.unbind("change"),t.pickadate("off","set"),t.pickadate("picker").on("set",e),o.unbind("change"),o.on("change",e)}this.addDomInitializer("notification-schedule",function(e){t=e.find("#startDate"),n=e.find("#endDate"),o=e.find("#startTime"),i=e.find("#endTime"),t.pickadate("picker").on("set",a),o.on("change",a),n.pickadate("picker").on("set",d),i.on("change",d)})}),AGN.Lib.Controller.new("notification-settings",function(){this.addAction({"editor:create":"content","editor:change":"content"},function(){var e=this.el.val().length;$("#contentSize").text(t("fields.content.charactersEntered",e))})}),AGN.Lib.Controller.new("preview-header",function(){var e=this;this.addInitializer("set-preview-customer-options",function(){var e=$("#useCustomerEmail").prop("checked");$("#recipientEmail").prop("disabled",e),$("#buttonPreviewCustomerEmail").prop("disabled",e),$("#recipientId").prop("disabled",!e)}),this.addAction({change:"change-preview-customer-options"},function(){e.runInitializer("set-preview-customer-options")})}),AGN.Lib.Controller.new("profile-field-view",function(){var i=!1,n=!1,o=null;this.addDomInitializer("profile-field-view",function(e){var t=e.json();i=t.isHistorizationFeatureEnabled,n=t.isHistorizationEnabled,o=t.dependentWorkflowName,$.i18n.load(t.translations)}),this.addAction({change:"toggleHistorization"},function(){i&&n&&o&&(this.el.is(":checked")||AGN.Lib.Messages(t("defaults.warning"),t("warning.profilefield.inuse",o),"warning"))})}),AGN.Lib.Controller.new("recipient-list",function(){this.addDomInitializer("recipient-list",function(){$("#basicSearch").on("click",function(){$("input[name=advancedSearch]").val(!1)}),$("#advancedSearch").on("click",function(){$("input[name=advancedSearch]").val(!0)}),$("#add-rule-table").on("change",function(){$("#refresh-button").attr("data-form-set","advancedSearch:true, addTargetNode:true")});var e=$("#basicSearch").hasClass("tab active");$("#advancedSearch").hasClass("tab active")&&$("input[name=advancedSearch]").val(!0),e&&$("input[name=advancedSearch]").val(!1)}),this.addAction({change:"change-fields-to-search"},function(){"-1"==this.el.val()?($("#search_recipient_type").prop("disabled",!0),$("#search_recipient_state").prop("disabled",!0)):($("#search_recipient_type").prop("disabled",!1),$("#search_recipient_state").prop("disabled",!1));var e=$("#search_mailinglist").val();$("#search_mailinglist_advanced").select2("val",e),"-1"==e?($("#search_recipient_type_advanced").prop("disabled",!0),$("#search_recipient_state_advanced").prop("disabled",!0)):($("#search_recipient_type_advanced").prop("disabled",!1),$("#search_recipient_state_advanced").prop("disabled",!1))}),this.addAction({change:"change-target-group"},function(){var e=$("#search_targetgroup").val();$("#search_targetgroup_advanced").select2("val",e)}),this.addAction({change:"change-recipient-type"},function(){var e=$("#search_recipient_type").val();$("#search_recipient_type_advanced").select2("val",e)}),this.addAction({change:"change-user-status"},function(){var e=$("#search_recipient_state").val();$("#search_recipient_state_advanced").select2("val",e)}),this.addAction({change:"change-fields-to-search-advanced"},function(){"-1"==this.el.val()?($("#search_recipient_type_advanced").prop("disabled",!0),$("#search_recipient_state_advanced").prop("disabled",!0)):($("#search_recipient_type_advanced").prop("disabled",!1),$("#search_recipient_state_advanced").prop("disabled",!1));var e=$("#search_mailinglist_advanced").val();$("#search_mailinglist").select2("val",e),"-1"==e?($("#search_recipient_type").prop("disabled",!0),$("#search_recipient_state").prop("disabled",!0)):($("#search_recipient_type").prop("disabled",!1),$("#search_recipient_state").prop("disabled",!1))}),this.addAction({change:"change-target-group-advanced"},function(){var e=$("#search_targetgroup_advanced").val();$("#search_targetgroup").select2("val",e)}),this.addAction({change:"change-recipient-type-advanced"},function(){var e=$("#search_recipient_type_advanced").val();$("#search_recipient_type").select2("val",e)}),this.addAction({change:"change-user-status-advanced"},function(){var e=$("#search_recipient_state_advanced").val();$("#search_recipient_state").select2("val",e)}),this.addAction({click:"choose-advanced-search"},function(){($("#search_first_name").val().trim()||$("#search_name").val().trim()||$("#search_email").val().trim())&&$("#recipientForm").submit()}),this.addAction({click:"reset-search"},function(){$("#search_first_name").val(""),$("#search_name").val(""),$("#search_email").val(""),$("#search_mailinglist_advanced").select2("val",0),$("#search_targetgroup_advanced").select2("val",0),$("#search_recipient_type_advanced").select2("val",""),$("#search_recipient_state_advanced").select2("val",0),$("#search_mailinglist").select2("val",0),$("#search_targetgroup").select2("val",0),$("#search_recipient_type").select2("val",""),$("#search_recipient_state").select2("val",0),$('[name="columnAndTypeNew"]').val(""),$('[name="chainOperatorNew"]').val(""),$('[name="parenthesisOpenedNew"]').val(""),$('[name="primaryOperatorNew"]').val(""),$('[name="primaryValueNew"]').val(""),$('[name="parenthesisClosedNew"]').val(""),$('[name="dateFormatNew"]').val(""),$('[name="secondaryOperatorNew"]').val(""),$('[name="secondaryValueNew"]').val(""),$("#recipientForm").submit()})}),AGN.Lib.Controller.new("recipient-view",function(){var n,o="BLACKLISTED",r=AGN.Lib.Form,a=AGN.Lib.Confirm,s=AGN.Lib.Template;function l(e,t){this.url=e,this.running=!1,this.callback=$.isFunction(t)?t:$.noop,this.lastAddress=null,this.lastResult=null,this.scheduledCheck=null}this.addDomInitializer("recipient-view",function(e){var i=r.get(e);n=new l(this.config.urls.CHECK_ADDRESS,function(e){switch(e){case"OK":i.cleanFieldError("email");break;case"USED":i.showFieldError("email",t("error.inUse"),!0);break;case o:i.showFieldError("email",t("error.isBlacklisted"),!0)}}),$("#recipient-email").on("change input",_.debounce(function(){n.check($(this).val())},300))}),this.addAction({submission:"recipient-save"},function(){var i=r.get(this.el),e=$("#recipient-email").val();n&&e&&e.trim()?n.jqxhr(e.trim()).done(function(e){!0===e.isBlacklisted?a.create(s.text("email-confirmation-modal",{question:t("recipient.blacklisted.question")})).done(function(){!0===e.inUse?a.create(s.text("email-confirmation-modal",{question:t("recipient.duplicate.question")})).done(function(){i.submit()}):i.submit()}):!0===e.inUse?a.create(s.text("email-confirmation-modal",{question:t("recipient.duplicate.question")})).done(function(){i.submit()}):i.submit()}).fail(function(){i.submit()}):i.submit()}),l.prototype.jqxhr=function(e){return $.get(this.url,{email:e})},l.prototype.scheduleCheck=function(t){var i=this;if(i.scheduledCheck&&clearTimeout(i.scheduledCheck),i.running)i.scheduledCheck=setTimeout(function(){i.scheduleCheck(t)},300);else{i.running=!0,i.lastAddress=null,i.lastResult=null;try{i.jqxhr(t).always(function(){i.running=!1}).done(function(e){i.lastAddress=t,i.lastResult=!0===e.isBlacklisted?o:!0===e.inUse?"USED":"OK",i.report()})}catch(e){i.running=!1}}},l.prototype.check=function(e){(e=e?e.trim():"")?this.lastAddress==e?this.report():this.scheduleCheck(e):this.report("OK")},l.prototype.report=function(e){arguments.length?this.callback.call(null,e):this.lastAddress&&this.report(this.lastResult)}}),AGN.Lib.Controller.new("rules-add",function(){var i=this,n=AGN.Lib.RuleService;this.addInitializer("readConfigRulesAdd",function(e){var t=$('[data-initializer="rules-config"]').data("config");i.config=AGN.Lib.Helpers.objFromString(t),i.config=n.configure(i.config),$('select[data-action="updateMailingLinkIdNew"]').each(function(){var e=$(this);n.updateMailingLinksCache(i.config,e.data("ruleid"),e.val())})}),this.addInitializer("initStateRulesAdd",function(e){n.changedColumn(null,i.config)}),this.addAction({change:"columnAndTypeNew, primaryOperatorNew"},function(){var e=this.el.data("ruleid");n.changedColumn(e,i.config)}),this.addAction({change:"resetMailingUrlsNew"},function(){var e=this.el.data("ruleid");n.resetMailingUrls(i.config,e)}),this.addAction({change:"updateMailingLinkIdNew"},function(){var e=this.el.data("ruleid");n.updateMailingLinksCache(i.config,e,this.el.val())})}),AGN.Lib.Controller.new("rules-list",function(){var i=this,t=AGN.Lib.RuleService;this.addInitializer("readConfigRulesList",function(){var e=$('[data-initializer="rules-config"]').data("config");i.config=AGN.Lib.Helpers.objFromString(e),i.config=t.configure(i.config),$('select[data-action="updateMailingLinkId"]').each(function(){var e=$(this);t.updateMailingLinksCache(i.config,e.data("ruleid"),e.val())}),$("select[data-selected-column]").each(function(){var t=$(this);t.on("select2-opening",function(){if(!t.data("_loaded")){var e=i.config.allColumns.clone();e.filter('option[value="'+t.data("selected-column")+'"]').attr("selected",""),t.html(e),t.data("_loaded",!0)}})})}),this.addAction({change:"columnAndType, primaryOperator"},function(){var e=this.el.data("ruleid");t.changedColumn(e,i.config)}),this.addAction({change:"resetMailingUrls"},function(){var e=this.el.data("ruleid");t.resetMailingUrls(i.config,e)}),this.addAction({change:"updateMailingLinkId"},function(){var e=this.el.data("ruleid");t.updateMailingLinksCache(i.config,e,this.el.val())})}),AGN.Lib.Controller.new("support",function(){var e=AGN.Lib.Form,i=AGN.Lib.Popover,n=AGN.Lib.JsonMessages;function o(){var e=$("#support-mail-text").val(),i=0;e&&(i=e.length),$("#support-message-length").text(t("fields.content.charactersEntered",i))}this.addDomInitializer("support",function(){o(),$("#support-mail-text").on("change input",_.throttle(function(){o()},100))}),this.addAction({submission:"send-support-request"},function(){this.event.preventDefault(),e.get(this.el).submit()}),this.addAction({submitted:"send-support-request"},function(){if(this.data.success){var e=i.get(this.el);e&&e.hide()}n(this.data.popups)})}),AGN.Lib.Controller.new("template-css",function(){this.addAction({click:"updatePreview"},function(){var e=$("#layoutPreviewForm");e.find('input[name="css"]').val($("#cssContents").val()),e.submit()}),this.addAction({click:"saveLayoutCss"},function(){$("#gridTemplateForm").submit()})}),AGN.Lib.Controller.new("template-outer-html-edit",function(){this.addAction({click:"updatePreview"},function(){var e=$("#layoutPreviewForm");e.find('input[name="outerHTML"]').val($("#templateOuterHTML").val()),e.submit()}),this.addAction({click:"saveOuterHTML"},function(){$("#gridTemplateForm").submit()})}),AGN.Lib.Controller.new("template-styles",function(){function e(){var e=$("form#gridTemplateForm"),o=$("form#layoutPreviewForm"),t=e.find('input[name^="styles."]');$.each(t,function(e,t){var i=$(t),n=i.attr("name");o.find('input[name="'+n+'"]').val(i.val())}),o.submit()}this.addAction({submission:"updatePreview"},function(){e()}),this.addAction({click:"updateLayoutPreview"},function(){e()}),this.addAction({click:"saveLayoutStyles"},function(){$("form#gridTemplateForm").submit()})}),AGN.Lib.Controller.new("trackable-link-list",function(){var l;this.addAction({change:"elem-edited"},function(){l=this.el.attr("id")}),this.addAction({scrollTo:"scroll-to"},function(){var e,t,i,n;if(l)t=$(this.el).find("#"+l);else if(0<$(this.el).find('[data-sizing="scroll-top-target"]').length)(t=$(this.el).find('[data-sizing="scroll-top-target"]')).removeAttr("data-sizing");else if(0<location.href.indexOf("scrollToLinkId")){var o,r,a=document.createElement("a");a.href=location.href,o=a.search.substring(1,a.search.length).split("&");for(var s=0;s<o.length;s++)0<=o[s].indexOf("scrollToLinkId")&&(r=o[s].substring(o[s].indexOf("=")+1,o[s].length),t=$("#link-"+r))}t&&0<t.length&&0<(e=t.closest('[data-sizing="scroll"]')).length&&(i=e.find(":first-child").offset().top,n=t.offset().top,e.scrollTop(0),e.scrollTop(n-i))}),this.addAction({click:"delete-link"},function(){var e=this.el.data("link-id");$(this.el).closest('[data-action="elem-edited"]').trigger("change"),$("#linkPropertyTable").find("#linkProperty_"+e).remove()}),this.addAction({click:"delete-all-links"},function(){$("#linkPropertyTable").find("tbody tr").remove(),$(this.el).closest('[data-action="elem-edited"]').trigger("change")}),this.addAction({click:"add-default-extensions"},function(){var i,n,o,e=$("#linkPropertyTable").find("tr[data-link-id]");o=0!=e.length?Math.max.apply(Math,_.map(e,function(e){return parseInt($(e).data("link-id"))}))+1:$("#linkPropertyTable").find("tbody tr").length+1,_.each(AGN.Opt.DefaultExtensions,function(e,t){0!=(n=$("#linkPropertyTable").find('[data-link-name="'+t+'"]')).length?(i=AGN.Lib.Template.text("link-table-row",{count:n.data("link-id"),linkName:t,linkValue:e}),n.replaceWith(i)):(i=AGN.Lib.Template.text("link-table-row",{count:o,linkName:t,linkValue:e}),o+=1,$("#linkPropertyTable").find("tbody").append(i))}),$(this.el).closest('[data-action="elem-edited"]').trigger("change")}),this.addAction({click:"add-extension"},function(){var e,t,i=$("#linkPropertyTable").find("tr[data-link-id]");t=0!=i.length?Math.max.apply(Math,_.map(i,function(e){return parseInt($(e).data("link-id"))}))+1:$("#linkPropertyTable").find("tbody tr").length+1,e=AGN.Lib.Template.text("link-table-row",{count:t,linkName:"",linkValue:""}),$("#linkPropertyTable").find("tbody").append(e),$(this.el).closest('[data-action="elem-edited"]').trigger("change")})}),AGN.Lib.Controller.new("trackable-link",function(){var e=this;this.addAction({click:"link-details-delete-link"},function(){var e=this.el.data("link-id");$("#linkPropertyTable").find("#linkProperty_"+e).remove()}),this.addAction({click:"link-details-delete-all-links"},function(){$("#linkPropertyTable").find("tbody tr").remove()}),this.addAction({click:"link-details-add-extension"},function(){var e,t,i=$("#linkPropertyTable").find("tr[data-link-id]");t=0!=i.length?Math.max.apply(Math,_.map(i,function(e){return parseInt($(e).data("link-id"))}))+1:$("#linkPropertyTable").find("tbody tr").length+1,e=AGN.Lib.Template.text("link-table-row",{count:t,linkName:"",linkValue:""}),$("#linkPropertyTable").find("tbody").append(e)}),this.addAction({change:"link-details-trackable"},function(){e.runInitializer("trackableAction")}),this.addInitializer("trackableAction",function(e){0==$('[data-action="link-details-trackable"] :selected').val()?$("#linkAction").prop("disabled",!0):$("#linkAction").prop("disabled",!1)})}),AGN.Lib.Controller.new("workflow-list",function(){var n=null;function o(){var e=$(".js-data-table-body");if(e.exists()){var t=e.data("_table");if(t&&t.api)return t.api}return null}function r(e,i){var n=$.Deferred();if(e&&e.length){var o=$.ajax(i,{method:"POST",traditional:!0,data:{bulkIds:e}}).fail(function(){n.reject()});AGN.Lib.Confirm.request(o).then(n.resolve,n.reject)}else n.reject(),AGN.Lib.Messages(t("Error"),t("messages.error.nothing_selected"),"alert");return n.promise()}this.addDomInitializer("workflow-list",function(){n=this.config}),this.addAction({click:"bulk-delete"},function(){var e=o();if(e){var t=e.getSelectedRows();r(t.map(function(e){return e.id}),n.urls.WORKFLOW_BULK_DELETE).done(function(){e.updateRowData({remove:t})})}}),this.addAction({click:"bulk-deactivate"},function(){var e=o();if(e){var t=e.getSelectedRows(),i=e.getSelectedNodes();r(t.map(function(e){return e.id}),n.urls.WORKFLOW_BULK_DEACTIVATE).done(function(){i.forEach(function(e){e.setDataValue("status",{name:"inactive",messageKey:"default.status.inActive"})}),e.refreshClientSideRowModel("filter"),e.deselectAll()})}})}),AGN.Lib.Controller.new("workflow-view-new",function(){var r,d,a,s,c,u,i,n,o,e,l,h,p,f,g,m,v,y,b,w,C,A,E,x,S,T,D,k,R,O,N,F=AGN.Lib.Action,M=AGN.Lib.Template,P=AGN.Lib.Confirm,I=AGN.Lib.WM.NodeFactory,L="gender";function G(e){return{allMailinglists:e.allMailingLists,allMailings:e.allMailings,allTargets:e.allTargets,allReports:e.allReports,allUserForms:e.allUserForms,allAutoExports:e.allAutoExports,allAutoImports:e.allAutoImports,allCampaigns:e.allCampaigns}}function B(t){var i="";return Object.keys(t).forEach(function(e){i+="<option "+('value="'+e+'"')+">"+t[e]}),i}function j(e){var o="";return e.forEach(function(e){var t='value="'+e.id+'"',i=e.data;i&&Object.keys(i).forEach(function(e){t+=" data-"+e+'="'+i[e].replace('"',"&quot;")+'"'});var n=e.text.replace("<","&lt;").replace(">","&gt;");o+="<option "+t+">"+n+"</option>"}),o}function W(e){return AGN.Lib.Helpers.objFromString(e.data("config"))}function H(){}function z(){AGN.Lib.CampaignManagerService.resizeTimeoutId&&clearTimeout(AGN.Lib.CampaignManagerService.resizeTimeoutId),AGN.Lib.CampaignManagerService.resizeTimeoutId=setTimeout(function(){var e=0!=$("#modalCampaignEditorContainer").find($("#campaignEditorBody")).length,t=$("#viewPort"),i=$("#editorCanvas"),n=$("#toolbarLeft"),o=505,r=t[0].clientWidth,a=e?$("#modalCampaignEditorContainer").height()-$("#toolbarTop").height():t[0].clientHeight;if(i.width(r),i.height(a),d.setEditorCanvasWidth(r),d.setEditorCanvasHeight(a),d.setViewPortWidth(r),d.setViewPortHeight(a),e)o<a&&(n.height(a),i.height(a),t.height(a));else{var s=808+jQuery("#tile-campaignInformation").outerHeight(),l=jQuery("html").scrollTop(),c=jQuery("html").height();s<c+l&&(o+=c+l-s),n.height(o),i.height(o),t.height(o)}},100)}function V(e){function i(){var e=AGN.Lib.Form.get($("form#workflowForm"));e.setValueOnce("workflowSchema",d.getIconsForSubmissionJson()),e.setValueOnce("editorPositionLeft",d.getLeftPosition()),e.setValueOnce("editorPositionTop",d.getTopPosition()),e.setValueOnce("workflowUndoHistoryData",d.getUndoHistoryDataForSubmission()),e.submit("static")}e?function(){var e=$.Deferred();if($("#name").val().length<3)AGN.Lib.Messages(t("workflow.defaults.error"),t("error.workflow.shortName"),"alert"),e.reject();else{if(d.checkMailingTypesConvertingRequired())return P.create(M.text("mailing-types-replace-modal"));e.resolve()}return e.promise()}().done(i):i()}function U(e){var i=$("#workflow_active").is(":checked"),n=R===constants.statusActive&&!i,o=R!==constants.statusActive&&i;if(n||!d.checkWorkflowBeforeSave())if(o){$("input[name='status']").val(constants.statusActive);var r=d.getMailingNames();$("#activating-campaign-mailings").html(r),$("#activating-campaign-dialog").css("visibility","visible"),$("#activating-campaign-dialog").show(),$("#activating-campaign-activate-button").click(function(){return V(e),!1}),$("#activating-campaign-dialog").dialog({open:function(e,i){var n=$("#activating-campaign-dialog").parent().find(".ui-dialog-title");n.empty(),n.append('<span class="dialog-title-image">'+t("workflow.activating.title")+"</span>"),n.find(".dialog-title-image").css("padding-left","0px")},modal:!0,resizable:!1,width:650,minHeight:0,close:function(e,t){return!1}})}else n?($("input[name='workflow.statusString']").val(constants.statusInactive),$("#inactivating-campaign-dialog").css("visibility","visible"),$("#inactivating-campaign-dialog").show(),$("#inactivating-campaign-inactivate-button").click(function(){return V(e),$("#inactivating-campaign-dialog").dialog("close"),!1}),$("#inactivating-campaign-dialog").dialog({open:function(e,i){var n=$("#inactivating-campaign-dialog").parent().find(".ui-dialog-title");n.empty(),n.append('<span class="dialog-title-image">'+t("workflow.inactivating.title")+"</span>"),n.find(".dialog-title-image").css("padding-left","0px")},modal:!0,resizable:!1,width:650,minHeight:0,close:function(e,t){return!1}})):V(e)}this.addDomInitializer("workflow-view-constants",function(){(constants=constants||new H).setup(this.config)}),this.addDomInitializer("workflow-pdf-initialize",function(){var e,t,i=this.config,n=i.sessionId,o=i.locale;O=G(i),campaignManagerSettings.imagePath=i.imageUrl+"/campaignManager/",t=new AGN.Lib.WM.CampaignManagerScale({campaignManagerSettings:campaignManagerSettings}),AGN.Lib.CampaignManagerService={icons:i.icons,resizeTimeoutId:!1},d=new AGN.Lib.WM.CampaignManagerNew({campaignManagerScale:t,campaignManagerSettings:campaignManagerSettings,restoreSpaceFields:["name","workflow_description"],editorPositionLeft:i.editorPositionLeft,editorPositionTop:i.editorPositionTop,localeDateNTimePattern:i.localeDateNTimePattern,noContextMenu:i.noContextMenu,pageContextSessionId:n,allUsedEntity:O,isPdfGenerating:!0,workflowURL:constants.workflowURL,componentURL:constants.componentURL}),D=d.getEditorsHelper(),e=new AGN.Lib.WM.WorkflowManagerStatisticsNew(d),$.datepicker.setDefaults($.datepicker.regional[o]),d.restoreWorkflow(AGN.Lib.CampaignManagerService.icons),d.updateWorkflowForPdf(),i.showStatistics&&e.toggleStatistics(i.workflowId)}),this.addDomInitializer("campaign-manager-init",function(e){a=this.config,a.isActivated,R=a.workflowStatus,O=G(a),AGN.Lib.CampaignManagerService={icons:a.icons,resizeTimeoutId:!1},campaignManagerSettings.imagePath=a.imageUrl+"/campaignManager/";var t=new AGN.Lib.WM.CampaignManagerScale({campaignManagerSettings:campaignManagerSettings});d=new AGN.Lib.WM.CampaignManagerNew({workflowId:a.workflowId,isActivated:a.isActivated,restoreSpaceFields:["name","workflow_description"],editorPositionLeft:a.editorPositionLeft,editorPositionTop:a.editorPositionTop,localeDateNTimePattern:a.localeDateNTimePattern,pageContextSessionId:a.pageContextSessionId,campaignManagerScale:t,campaignManagerSettings:campaignManagerSettings,allUsedEntity:O,workflowURL:constants.workflowURL,componentURL:constants.componentURL}),D=d.getEditorsHelper(),r=new AGN.Lib.WM.WorkflowManagerStatisticsNew(d),jQuery.datepicker.setDefaults(jQuery.datepicker.regional[a.emmLocal]),a.newStatus===constants.statusActive&&d.setWorkflowManagerStateChangedCallback(function(){$("#workflow_active").prop("disabled",!d.isNodesFilled())});var i=AGN.Lib.CampaignManagerService.icons;for(var n in null!=i.length&&d.restoreWorkflow(i),d.setHistoryStackChangedCallback(function(e){AGN.Lib.WM.CampaignManagerToolbar.setUndoAvailable(e)}),d.setConnectionNotAllowedCallback(function(){workflowNotAllowedConnectionDialogHandler.showDialog()}),d.setEditingNotAllowedCallback(function(){workflowNotAllowedEditingDialogHandler.showDialog()}),d.setUndoHistoryDataForSubmission(a.workflowUndoHistoryData),jQuery("#legend-button-wrapper").bind({mouseover:function(){d.getCurrentState()==d.STATE_WAITING&&jQuery("#legend-dopdown").show()},mouseout:function(){jQuery("#legend-dopdown").hide()}}),I.reactionRegistry)if(I.reactionRegistry.hasOwnProperty(n)){var o="<div class='legend-dopdown-item'><img src='"+a.imageUrl+"/campaignManager/"+I.reactionRegistry[n].image+"'/></div><div class='legend-dopdown-item-name'>"+I.reactionRegistry[n].name+"</div>";jQuery("#legend-dopdown").append(o)}jQuery(window).resize(function(){z()})}),this.addDomInitializer("start-editor-initializer",function(e){var l=e.find("#start-editor-data").json();c=new AGN.Lib.WM.MailingSelectorBaseNew(l.form,l.container,l.sessionId,l.selectedName,l.noMailingOption,D);var i,n,o,r,a=l.profileFields,u=l.isBigData;D.editors.start={rulesNumber:0,isStartEditor:!1,timePattern:/^(\d{2}):(\d{2})$/,getTitle:function(){return this.isStartEditor?t("workflow.start.title"):t("workflow.stop.title")},getStartStopDate:function(e){e=e||D.formToObject("startForm");var t=$('form[name="startForm"]'),i=null;if(this.isStartEditor)switch(e.startType){case constants.startTypeDate:i=t.find("#startDate").pickadate("picker");break;case constants.startTypeEvent:i=t.find("#executionDate").pickadate("picker")}else e.endType==constants.endTypeDate&&(i=t.find("#startDate").pickadate("picker"));if(i){var n=i.get("select");if(n)return n.obj}return null},generateReminderComment:function(){var e=$("#workflowForm input[name='workflow.shortname']").val(),i=AGN.Lib.WM.DateTimeUtils.getDateStr(this.getStartStopDate(),l.localeDatePattern);return(this.isStartEditor?t("workflow.start.reminder_text"):t("workflow.stop.reminder_text")).replace(/:campaignName/g,e).replace(/:startDate/g,i).replace(/:endDate/g,i)},fillEditor:function(e){var i=e.data;this.isStartEditor="start"==e.type,this.updateEditorType(this.isStartEditor);var n=$("form[name='startForm']");if(n.submit(!1),n.find(".rule-row").each(function(){$(this).remove()}),n.find("#remindCalendarDateTitle").text(this.isStartEditor?t("workflow.start.start_date"):t("workflow.stop.end_date")),null!=i.rules){for(var o=0;o<i.rules.length;o++){var r=i.rules[o];this.createRuleRow(o,r)}this.rulesNumber=i.rules.length}n.get(0).reset(),i.adminTimezone=l.adminTimezone,i.sendReminder=i.scheduleReminder,D.fillFormFromObject("startForm",i,""),c.setMailingId(i.mailingId),c.cleanOptions(1);var a,s=new Date;n.find("#startDate").pickadate("picker").set("select",this.dateAsUTC(null!=i.date?i.date:s)),n.find("#executionDate").pickadate("picker").set("select",this.dateAsUTC(null!=i.date?i.date:s)),n.find("#remindDate").pickadate("picker").set("select",this.dateAsUTC(null!=i.remindDate?i.remindDate:s)),null!=i.date?(n.find("#startTime").val(this.formatTime(i.hour,i.minute)),n.find("#remindTime").val(this.formatTime(i.remindHour,i.remindMinute))):this.setCurrentTime(),this.updateChainFieldsVisibility(),this.updateVisibility(),this.updateOperatorsAvailability(),i.startType==constants.startTypeEvent&&i.event==constants.startEventReaction&&i.reaction==constants.reactionClickedLink&&0!=i.mailingId&&null!=i.mailingId&&this.onMailingSelectChange(i.mailingId,i.linkId),i.comment||n.find("#reminderComment").val(this.generateReminderComment()),a=""!=i.recipients?2:1,$("#start-editor input[name='userType'][value="+a+"]").prop("checked",!0).trigger("change"),$("#start-editor .editor-error-messages").css("display","none")},saveEditor:function(){var e,t=D.formToObject("startForm");t.date=this.getStartStopDate(t),null==t.date&&(t.date=new Date,t.date.setHours(0),t.date.setMinutes(0),t.date.setSeconds(0),t.date.setMilliseconds(0));var i=jQuery("form[name='startForm'] #startTime").val();(e=this.timePattern.exec(i))?(t.hour=e[1],t.minute=e[2]):(t.hour=0,t.minute=0),t.scheduleReminder=t.sendReminder;var n=jQuery("form[name='startForm'] #remindTime").val();return(e=this.timePattern.exec(n))?(t.remindHour=e[1],t.remindMinute=e[2]):(t.remindHour=0,t.remindMinute=0),"true"==jQuery("input[name='remindSpecificDate']:checked").val()?t.remindDate=jQuery("form[name='startForm'] #remindDate").pickadate("picker").get("select").obj:(t.remindDate=t.date,t.remindHour=0,t.remindMinute=0),null==t.rules&&(t.rules=[]),null!=t.linkId&&null!=t.linkId||(t.linkId=0),t.dateFieldOperator!=l.equelsOperatorCode&&(t.dateFieldOperator=l.equelsOperatorCode),2==t.userType?(t.remindAdminId=0,t.recipients=$.trim(t.recipients).toLowerCase().split(/[,;\s\n\r]+/).filter(function(e){return!!e}).join(", ")):t.recipients="",delete t.userType,t},validateEditorInternal:function(r){var a=this,s=!0,l=$("#start-editor .editor-error-messages"),c=$("form[name='startForm']"),e=this.isStartEditor?c.find("input[name='startType']:checked").val():c.find("input[name='endType']:checked").val();this.isStartEditor&&e==constants.startTypeEvent&&(function(){switch(c.find("select[name='event']").val()){case constants.startTypeDate:if(c.find("#executionDate").pickadate("picker").get("select").obj){var e=c.find("#startTime").val();a.timePattern.test(e)||(s=!1)}else s=!1;var i=c.find("#dateFieldValue");$.trim(i.val())||(s=!1,r&&(l.html(t("error.workflow.startDateOmitted")),l.css("display","block")));break;case constants.startEventReaction:switch(c.find("select[name='reaction']").val()){case constants.reactionClickedLink:var n=c.find("select[name='linkId']").val();parseInt(n,10)<=0&&(s=!1,r&&(l.html(t("error.workflow.noLinkSelected")),l.css("display","block")));case constants.reactionOpened:case constants.reactionClicked:var o=c.find("select[name='mailingId']").val();parseInt(o,10)<=0&&(s=!1);break;case constants.reactionChangeOfProfile:if(void 0!==u&&1==u)c.find("select[name='profileField']").val()||(s=!1);break;case constants.reactionWaitingForConfirm:case constants.reactionOptIn:case constants.reactionOptOut:break;default:s=!1}}}(),i()),(this.isStartEditor&&e==constants.startTypeDate||!this.isStartEditor&&e==constants.endTypeDate)&&i(),s&&c.find("#sendReminder").is(":checked")&&(2==c.find('input[name="userType"]:checked').val()&&($.trim(c.find('textarea[name="recipients"]').val()).split(/[,;\s\n\r]+/).filter(function(e){return!!e}).length||r&&(s=!1,l.html(t("error.workflow.emptyRecipientList")),l.css("display","block"))));return s;function i(){if(c.find("#startDate").pickadate("picker").get("select").obj){var e=c.find("#startTime").val();a.timePattern.test(e)||(s=!1)}else s=!1}},validateEditor:function(){this.validateEditorInternal(!0)&&D.saveCurrentEditor()},isSetFilledAllowed:function(){return this.validateEditorInternal(!1)},setCurrentTime:function(){var t=this;jQuery.ajax({type:"GET",url:AGN.url("/workflow/getCurrentAdminTime.action"),success:function(e){jQuery("form[name='startForm'] #startTime").val(t.formatTime(e.hour,e.minute)),jQuery("form[name='startForm'] #remindTime").val(t.formatTime(e.remindHour,e.remindMinute))}})},updateEditorType:function(e){$("#startStopType").empty(),e?($("#startStopType").append(AGN.Lib.Template.text("start-types")),jQuery("#eventReaction").html(t("workflow.start.reaction_based")),jQuery("#eventDate").html(t("workflow.start.date_based"))):($("#startStopType").append(AGN.Lib.Template.text("stop-types")),d.isNormalCampaignActionsType()?jQuery("#endTypeActiomaticLabel").html(t("workflow.stop.automatic_end")):jQuery("#endTypeActiomaticLabel").html(t("workflow.stop.open_end")))},onRulesChanged:function(){var o=0;$("form[name='startForm'] #profileFieldAddedRules tr").each(function(){var e=$(this),t=e.attr("id"),i=t.substring(5),n=$("#"+t);n.find(".rule-field").attr("name",function(e,t){return t?t.replace(i,o+""):""}),n.find(".delete-rule").attr("data-rule-index",function(e,t){return t==i?o:t}),e.attr("id","rule_"+o),o++}),this.updateChainFieldsVisibility()},updateChainFieldsVisibility:function(){0<this.rulesNumber?(jQuery('form[name="startForm"] [name="rules[0].chainOperator"]').css("visibility","hidden"),jQuery('form[name="startForm"] #newRule_chainOperator').css("visibility","visible")):jQuery("form[name='startForm'] #newRule_chainOperator").css("visibility","hidden")},updateOperatorsAvailability:function(){var e=$('form[name="startForm"] select[name="profileField"]').val(),t=a[e];$('form[name="startForm"] select.primary-operator').each(function(){var e=$(this);e.children("option").prop("disabled",function(){var e=$(this).data("types");return!("*"==e||!e)&&-1==e.split(/[\s,]+/).indexOf(t)}),AGN.Initializers.Select(e),null==e.val()&&D.initSelectWithFirstValue(e)})},addRule:function(){var e={chainOperator:jQuery("form[name='startForm'] #newRule_chainOperator").val(),parenthesisOpened:jQuery("form[name='startForm'] #newRule_parenthesisOpened").val(),primaryOperator:jQuery("form[name='startForm'] #newRule_primaryOperator").val(),primaryValue:jQuery("form[name='startForm'] #newRule_primaryValue").val(),parenthesisClosed:jQuery("form[name='startForm'] #newRule_parenthesisClosed").val()};this.createRuleRow(this.rulesNumber,e),D.fillFormFromObject("startForm",e,"rules["+this.rulesNumber+"]."),this.rulesNumber++,$("#newRule_primaryOperator").val()==constants.operatorIs&&$("#newRule_primaryValue").parents("td").replaceWith(this.createSimpleNewRuleValueField()),this.updateChainFieldsVisibility(),this.updateOperatorsAvailability(),$("form[name='startForm'] #profileFieldRuleAdd select").each(function(){D.initSelectWithFirstValue($(this))}),$("form[name='startForm'] #profileFieldRuleAdd input").each(function(){$(this).val("")})},removeRuleRow:function(e){jQuery("form[name='startForm'] #rule_"+e).remove(),this.rulesNumber--,this.onRulesChanged()},createRuleRow:function(e,i){var n=this.createSimpleRuleValueField(e),o=j(constants.operators);this.curProfileField==L?n=this.createGenderSelect():i.primaryOperator==constants.operatorIs&&(n=this.createIsOperatorSelect()),jQuery("form[name='startForm'] #profileFieldAddedRules").append('<tr class="rule-row" id="rule_'+e+'"><td><select name="rules['+e+'].chainOperator" class="rule-field"><option value="'+constants.chainOperatorAnd+'">'+t("workflow.defaults.and")+'</option><option value="'+constants.chainOperatorOr+'">'+t("workflow.defaults.or")+'</option></select></td><td><select name="rules['+e+'].parenthesisOpened" class="parentheses-opened rule-field"><option value="0">&nbsp</option><option value="1">(</option></select></td><td><select name="rules['+e+'].primaryOperator" class="primary-operator rule-field" data-action="start-rule-operator-change">'+o+"</select></td>"+n+'<td><select name="rules['+e+'].parenthesisClosed" class="parenthesis-closed rule-field"><option value="0">&nbsp</option><option value="1">)</option></select></td><td><a class="mailing_delete delete-rule btn btn-regular btn-alert" href="#" data-action="start-editor-rule-remove" data-rule-index="'+e+'"><i class="icon icon-minus-circle"></i></a></td></tr>'),this.addRuleProperties(jQuery("#rule_"+e+" .primary-value"),e),AGN.runAll($("form[name='startForm'] #profileFieldAddedRules"))},onStartTypeChanged:function(){var e=this.isStartEditor?jQuery("form[name='startForm'] input[name='startType']:checked").val():jQuery("form[name='startForm'] input[name='endType']:checked").val();this.isStartEditor&&e==constants.startTypeDate||!this.isStartEditor&&e==constants.endTypeDate?(this.toggleFormat(),this.hideDiv("startEventPanel"),this.showDiv("startDatePanel"),this.showDiv("startIconTime"),this.showDiv("startRemindAdmin")):this.isStartEditor&&e==constants.startTypeEvent?(this.hideDiv("startDatePanel"),this.showDiv("startEventPanel"),this.showDiv("startIconTime"),this.showDiv("startRemindAdmin"),this.onStartEventChanged()):(this.isStartEditor&&e==constants.startTypeOpen||!this.isStartEditor&&e==constants.endTypeAutomatic)&&(this.hideDiv("startDatePanel"),this.hideDiv("startEventPanel"),this.hideDiv("startIconTime"),this.hideDiv("startRemindAdmin"))},onStartEventChanged:function(){jQuery("#startEvent").val()==constants.startEventReaction?(this.toggleFormat(),this.hideDiv("dateStartPanel"),this.showDiv("reactionStartPanel"),this.onExecutionChanged(),this.onProfileFieldChanged()):jQuery("#startEvent").val()==constants.startEventDate&&(this.toggleFormat(),this.hideDiv("reactionStartPanel"),this.showDiv("dateStartPanel"),this.hideDiv("executionDateLabel"),this.showDiv("firstExecutionDateLabel"),jQuery("#startIconDateFormat").insertAfter("#startIconDateFieldOperator"),this.showDiv("startIconDateFormat"))},toggleFormat:function(){o=o||$("select#startEvent"),n=n||$("input#typeEvent"),i=i||$("input#startTime"),n.prop("checked"),r=o.val()==constants.startEventDate,n.prop("checked")&&r?i.inputmask("h:00"):i.inputmask("h:s")},onRuleModeChanged:function(){"false"==$("input[name='useRules']:checked").val()?this.hideDiv("profileFieldRules"):this.showDiv("profileFieldRules")},onProfileFieldChanged:function(){var e=$("form[name='startForm'] select[name='profileField']").val();"DATE"==a[e]?($("#startIconDateFormat").insertAfter("#reactionProfileField"),this.showDiv("startIconDateFormat")):this.hideDiv("startIconDateFormat"),this.updateOperatorsAvailability()},getRuleIndex:function(e){return e.attr("id").substring(5)},onRuleOperatorChanged:function(e){if(this.curProfileField!=L){var t=e.closest("tr"),i=t.attr("id")?this.getRuleIndex(t):null;if(e.val()==constants.operatorIs){var n=$(this.createIsOperatorSelect());t.find(".primary-value").parents("td").replaceWith(n),AGN.Initializers.Select(n)}else if(t.find(".primary-value").hasClass("null-select")){var o;o=null==i?this.createSimpleNewRuleValueField():this.createSimpleRuleValueField(i),t.find(".primary-value").parents("td").replaceWith(o)}null==i?this.addNewRuleProperties(t.find(".primary-value")):this.addRuleProperties(t.find(".primary-value"),i)}},createGenderSelect:function(){return'<td><select class="primary-value form-control">'+B(constants.genderOptions)+"</select></td>"},createIsOperatorSelect:function(){return'<td><select class="primary-value null-select form-control"><option value="NULL">NULL</option><option value="NOT_NULL">NOT NULL</option></select></td>'},createSimpleRuleValueField:function(e){return'<td><input name="rules['+e+'].primaryValue" type="text" class="primary-value rule-field form-control"/></td>'},createSimpleNewRuleValueField:function(){return'<td><input id="newRule_primaryValue" type="text" class="primary-value form-control"/></td>'},addRuleProperties:function(e,t){e.filter("select, input").attr("name","rules["+t+"].primaryValue").addClass("rule-field")},addNewRuleProperties:function(e){e.filter("select, input").attr("id","newRule_primaryValue")},onExecutionChanged:function(){"false"==$("input[name='executeOnce']:checked").val()?(this.hideDiv("executionDateLabel"),this.showDiv("firstExecutionDateLabel")):(this.hideDiv("firstExecutionDateLabel"),this.showDiv("executionDateLabel"))},onReactionChanged:function(){var e=$("form[name='startForm'] #startReaction").val();e==constants.reactionOpened||e==constants.reactionNotOpened||e==constants.reactionClicked||e==constants.reactionNotClicked||e==constants.reactionBought||e==constants.reactionNotBought||e==constants.reactionClickedLink?(this.hideDiv("reactionStartProfile"),this.showDiv("reactionStartMailing")):e==constants.reactionChangeOfProfile?(this.hideDiv("reactionStartMailing"),this.showDiv("reactionStartProfile")):(this.hideDiv("reactionStartMailing"),this.hideDiv("reactionStartProfile")),e==constants.reactionClickedLink?this.showDiv("reactionStartMailingLink"):this.hideDiv("reactionStartMailingLink")},onReminderChanged:function(){return $("input[name='sendReminder']:checked").val()?($('form[name="startForm"]').find("#reminderComment").val(this.generateReminderComment()),this.showDiv("reminderDetails")):this.hideDiv("reminderDetails"),!1},onScheduleReminderDateChanged:function(){return"true"==$("form[name='startForm'] input[name='remindSpecificDate']:checked").val()?this.showDiv("dateTimePicker"):this.hideDiv("dateTimePicker"),!1},onMailingSelectChange:function(e,t){var i=$("form[name='startForm'] select[name='linkId']"),n=parseInt(e,10);0<n?(i.attr("readonly","readonly"),$.ajax({type:"POST",url:AGN.url("/workflow/getMailingLinks.action"),data:{mailingId:n},success:function(e){i.empty(),$.each(e,function(e,t){i.append($("<option></option>",{value:t.id,text:t.url}))}),i.removeAttr("readonly"),null!=t&&null!=t?(i.val(t),D.initSelectWithValueOrChooseFirst(i,t)):D.initSelectWithFirstValue(i)}})):i.empty()},updateVisibility:function(){this.onStartTypeChanged(),this.onStartEventChanged(),this.onReactionChanged(),this.onRuleModeChanged(),this.onExecutionChanged(),this.onReminderChanged(),this.onScheduleReminderDateChanged()},hideDiv:function(e){jQuery("form[name='startForm'] #"+e).css("display","none")},showDiv:function(e){jQuery("form[name='startForm'] #"+e).css("display","")},dateAsUTC:function(e){return e?new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())):null},formatTime:function(e,t){var i=0,n=0;return 0<=(e=parseInt(e,10))&&(i=e),0<=(t=parseInt(t,10))&&(n=t),(i<10?"0"+i:i)+":"+(n<10?"0"+n:n)}},s=D.editors.start,D.editors.stop=D.editors.start}),this.addDomInitializer("decision-editor-initializer",function(e){var a,l=e.find("#decision-editor-data").json(),n=l.profileFields;u=new AGN.Lib.WM.MailingSelectorBaseNew(l.form,l.container,l.sessionId,l.selectName,l.noMailingOption,D),D.editors.decision={rulesNumber:0,rulePrefix:"decision_",prevProfileField:"",curProfileField:"",getTitle:function(){return t("workflow.decision")},fillEditor:function(e){a=0;var t=e.data;if(jQuery("form[name='decisionForm']").submit(!1),jQuery("form[name='decisionForm'] .rule-row").each(function(){jQuery(this).remove()}),this.curProfileField=t.profileField,null!=t.rules){for(var i=0;i<t.rules.length;i++){var n=t.rules[i];this.createRuleRow(i,n)}this.rulesNumber=t.rules.length}jQuery("form[name='decisionForm']").get(0).reset(),D.fillFormFromObject("decisionForm",t,""),u.setMailingId(t.mailingId),u.cleanOptions(1),null==t.decisionDate&&(t.decisionDate=new Date);var o=jQuery("form[name='decisionForm'] #decisionDate"),r=jQuery("form[name='decisionForm'] #decisionTime");this.checkPresentNodesByTypeList([I.NODE_TYPE_ACTION_BASED_MAILING,I.NODE_TYPE_DATE_BASED_MAILING])?(o.parent().parent().hide(),r.parent().parent().parent().parent().hide()):(o.parent().parent().show(),r.parent().parent().parent().parent().show(),o.pickadate("picker").set("select",this.dateAsUTC(t.decisionDate)),r.val(("0"+t.decisionDate.getHours()).slice(-2)+":"+("0"+t.decisionDate.getMinutes()).slice(-2))),this.updateChainFieldsVisibility(),this.updateVisibility(),this.updateDateFormatVisibility(),this.updateOperatorsAvailability(),t.decisionType==constants.decisionTypeDecision&&t.decisionCriteria==constants.decisionReaction&&t.reaction==constants.reactionClickedLink&&0!=t.mailingId&&null!=t.mailingId?this.onMailingSelectChange(t.mailingId,t.linkId):D.resetSelect(jQuery("form[name='decisionForm'] select[name='linkId']")),jQuery("#decision-editor .editor-error-messages").css("display","none")},saveEditor:function(){var e=D.formToObject("decisionForm");if(e.decisionCriteria==constants.decisionProfileField&&0!=a&&(e.mailingId=a),a=0,null==e.rules&&(e.rules=[]),e.threshold||(e.threshold=""),this.checkPresentNodesByTypeList([I.NODE_TYPE_ACTION_BASED_MAILING,I.NODE_TYPE_DATE_BASED_MAILING]))e.decisionDate=null;else{e.decisionDate=jQuery("form[name='decisionForm'] #decisionDate").pickadate("picker").get("select").obj;var t=jQuery("form[name='decisionForm'] #decisionTime").val();e.decisionDate.setHours(t.substring(0,2)),e.decisionDate.setMinutes(t.substring(3,5))}return e},validateEditor:function(){var e=jQuery("form[name='decisionForm'] input[name='decisionType']:checked").val(),i=jQuery("#decisionCriteria").val(),n=jQuery("form[name='decisionForm'] select[name='mailingId']").val(),o=jQuery("form[name='decisionForm'] select[name='linkId']").val(),r=jQuery("form[name='decisionForm'] select[name='reaction']").val(),a=jQuery("form[name='decisionForm'] input[name='threshold']").val();if(e==constants.decisionTypeDecision&&i==constants.decisionReaction&&0==n)jQuery("#decision-editor .editor-error-messages").html(t("error.workflow.noMailing")),jQuery("#decision-editor .editor-error-messages").css("display","block");else if(e!=constants.decisionTypeDecision||i!=constants.decisionReaction||r!=constants.reactionClickedLink||0!=o&&null!=o)if(e==constants.decisionTypeDecision&&i==constants.decisionProfileField&&0==l.isMailtrackingActive);else if(e==constants.decisionTypeAutoOptimization)if(a){var s=parseInt(a,10);s&&0<s?D.saveCurrentEditor():(jQuery("#decision-editor .editor-error-messages").html(t("error.workflow.noValidThreshold")),jQuery("#decision-editor .editor-error-messages").css("display","block"))}else D.saveCurrentEditor();else D.saveCurrentEditor();else jQuery("#decision-editor .editor-error-messages").html(t("error.workflow.noLinkSelected")),jQuery("#decision-editor .editor-error-messages").css("display","block")},onTypeChanged:function(){var e=jQuery("form[name='decisionForm'] input[name='decisionType']:checked").val();e==constants.decisionTypeDecision?(this.hideDecisionFormDiv("autoOptimizationPanel"),this.showDecisionFormDiv("decisionPanel")):e==constants.decisionTypeAutoOptimization&&(this.hideDecisionFormDiv("decisionPanel"),this.showDecisionFormDiv("autoOptimizationPanel")),this.updateVisibilityOfRuleMailingReceived()},onDecisionReactionChanged:function(){if(jQuery("form[name='decisionForm'] select[name='reaction']").val()==constants.reactionClickedLink){this.showDecisionFormDiv("reactionLinkPanel");var e=jQuery("form[name='decisionForm'] select[name='mailingId']").val();this.onMailingSelectChange(e,0)}else this.hideDecisionFormDiv("reactionLinkPanel")},onCriteriaChanged:function(){var e=jQuery("form[name='decisionForm'] select[name='decisionCriteria']").val();e==constants.decisionReaction?(this.hideDecisionFormDiv("decisionProfileFieldPanel"),this.showDecisionFormDiv("decisionReactionPanel")):e==constants.decisionProfileField&&(this.hideDecisionFormDiv("decisionReactionPanel"),this.showDecisionFormDiv("decisionProfileFieldPanel")),this.updateVisibilityOfRuleMailingReceived()},onMailingSelectChange:function(e,t){var i=$("form[name='decisionForm'] select[name='linkId']"),n=parseInt(e,10);0<n?(i.attr("readonly","readonly"),$.ajax({type:"POST",url:AGN.url("/workflow/getMailingLinks.action"),data:{mailingId:n},success:function(e){i.empty(),$.each(e,function(e,t){i.append($("<option></option>",{value:t.id,text:t.url}))}),i.removeAttr("readonly"),null!=t&&null!=t?(i.val(t),D.initSelectWithValueOrChooseFirst(i,t)):D.initSelectWithFirstValue(i)}})):i.empty()},onRuleOperatorChanged:function(e){if(this.curProfileField!=L){var t=e.closest("tr"),i=t.attr("id")?this.getRuleIndex(t):null;if(e.val()==constants.operatorIs){var n=$(this.createIsOperatorSelect());t.find(".primary-value").parents("td").replaceWith(n),AGN.Initializers.Select(n)}else if(t.find(".primary-value").hasClass("null-select")){var o;o=null==i?this.createSimpleNewRuleValueField():this.createSimpleRuleValueField(i),t.find(".primary-value").parents("td").replaceWith(o)}null==i?this.addNewRuleProperties(t.find(".primary-value")):this.addRuleProperties(t.find(".primary-value"),i)}},getRuleIndex:function(e){return e.attr("id").substring(14)},onProfileFieldChanged:function(){var e=jQuery("form[name='decisionForm'] select[name='profileField']").val();this.curProfileField=e;var t=this;e==L?(jQuery("#decisionProfileFieldRules .primary-value").each(function(){jQuery(this).parents("td").remove()}),jQuery("form[name='decisionForm'] .rule-row").each(function(){var e=t.getRuleIndex(jQuery(this));jQuery(this).find(".decision-rule-operator").parents("td").after(t.createGenderSelect()),t.addRuleProperties(jQuery(this).find(".primary-value"),e)}),jQuery("#decision_newRule_primaryOperator").parents("td").after(this.createGenderSelect()),this.addNewRuleProperties(jQuery("#decisionProfileFieldRuleAdd .primary-value"))):this.prevProfileField==L&&(jQuery("#decisionProfileFieldRules .primary-value").each(function(){jQuery(this).parents("td").remove()}),jQuery("form[name='decisionForm'] .rule-row").each(function(){var e=t.getRuleIndex(jQuery(this));jQuery(this).find(".decision-rule-operator").val()==constants.operatorIs?(jQuery(this).find(".primary-value").parents("td").remove(),jQuery(this).find("select").parents("td").after(t.createIsOperatorSelect()),t.addRuleProperties(jQuery(this).find(".primary-value"),e)):jQuery(this).find(".decision-rule-operator").parents("td").after(t.createSimpleRuleValueField(e))}),jQuery("#decision_newRule_primaryOperator").val()==constants.operatorIs?(jQuery("#decisionProfileFieldRuleAdd").find("select").parents("td").after(this.createIsOperatorSelect()),this.addNewRuleProperties(jQuery("#decisionProfileFieldRuleAdd .primaryValue"))):jQuery("#decision_newRule_primaryOperator").parents("td").after(this.createSimpleNewRuleValueField())),this.updateDateFormatVisibility(),this.updateOperatorsAvailability(),this.prevProfileField=e},updateDateFormatVisibility:function(){var e=jQuery("form[name='decisionForm'] select[name='profileField']").val();"DATE"==n[e]?this.showDecisionFormDiv("decisionDateFormat"):this.hideDecisionFormDiv("decisionDateFormat")},updateOperatorsAvailability:function(){var t=$('form[name="decisionForm"] select[name="profileField"]').val(),i=n[t];$('form[name="decisionForm"] select.decision-rule-operator').each(function(){var e=$(this);e.children("option").prop("disabled",function(){var e=$(this).data("types");return t==L?"="!=this.text&&"!="!=this.text:!("*"==e||!e)&&-1==e.split(/[\s,]+/).indexOf(i)}),AGN.Initializers.Select(e),null==e.val()&&D.initSelectWithFirstValue(e)})},onRulesChanged:function(){var o=0,r=this;$("form[name='decisionForm'] #decisionProfileFieldAddedRules .rule-row").each(function(){var e=$(this),t=e.attr("id"),i=r.getRuleIndex(e),n=$("#"+t);n.find(".rule-field").attr("name",function(e,t){return t?t.replace(i,o+""):""}),n.find(".delete-rule").attr("data-rule-index",function(e,t){return t==i?o:t}),e.attr("id","decision_rule_"+o),o++}),this.updateChainFieldsVisibility()},updateChainFieldsVisibility:function(){0<this.rulesNumber?(jQuery('form[name="decisionForm"] [name="rules[0].chainOperator"]').css("visibility","hidden"),jQuery('form[name="decisionForm"] #decision_newRule_chainOperator').css("visibility","visible")):jQuery("form[name='decisionForm'] #decision_newRule_chainOperator").css("visibility","hidden")},addRule:function(){var e={chainOperator:$("form[name='decisionForm'] #decision_newRule_chainOperator").val(),parenthesisOpened:$("form[name='decisionForm'] #decision_newRule_parenthesisOpened").val(),primaryOperator:$("form[name='decisionForm'] #decision_newRule_primaryOperator").val(),primaryValue:$("form[name='decisionForm'] #decision_newRule_primaryValue").val(),parenthesisClosed:$("form[name='decisionForm'] #decision_newRule_parenthesisClosed").val()};this.createRuleRow(this.rulesNumber,e),D.fillFormFromObject("decisionForm",e,"rules["+this.rulesNumber+"]."),this.rulesNumber++,$("#decision_newRule_primaryOperator").val()==constants.operatorIs&&$("#decision_newRule_primaryValue").parents("td").replaceWith(this.createSimpleNewRuleValueField()),this.updateChainFieldsVisibility(),this.updateOperatorsAvailability(),$("form[name='decisionForm'] #decisionProfileFieldRuleAdd select").each(function(){D.initSelectWithFirstValue($(this))}),$("form[name='decisionForm'] #decisionProfileFieldRuleAdd input").each(function(){$(this).val("")})},removeRuleRow:function(e){jQuery("form[name='decisionForm'] #decision_rule_"+e).remove(),this.rulesNumber--,this.onRulesChanged()},createRuleRow:function(e,i){var n=this.createSimpleRuleValueField(e),o=j(constants.operators);this.curProfileField==L?n=this.createGenderSelect():i.primaryOperator==constants.operatorIs&&(n=this.createIsOperatorSelect()),jQuery("form[name='decisionForm'] #decisionProfileFieldAddedRules").append('<tr class="rule-row" id="decision_rule_'+e+'"><td><select name="rules['+e+'].chainOperator" class="rule-field"><option value="'+constants.chainOperatorAnd+'">'+t("workflow.defaults.and")+'</option><option value="'+constants.chainOperatorOr+'">'+t("workflow.defaults.or")+'</option></select></td><td><select name="rules['+e+'].parenthesisOpened" class="parentheses-opened rule-field"><option value="0">&nbsp</option><option value="1">(</option></select></td><td><select name="rules['+e+'].primaryOperator" class="decision-rule-operator rule-field" data-action="decision-rule-operator-change">'+o+"</select></td>"+n+'<td><select name="rules['+e+'].parenthesisClosed" class="parenthesis-closed rule-field"><option value="0">&nbsp</option><option value="1">)</option></select></td><td><a class="mailing_delete delete-rule btn btn-regular btn-alert" href="#" data-action="decision-editor-rule-remove" data-rule-index="'+e+'"><i class="icon icon-minus-circle"></i></a></td></tr>'),this.addRuleProperties(jQuery("#decision_rule_"+e+" .primary-value"),e),AGN.runAll($("form[name='decisionForm'] #decisionProfileFieldAddedRules"))},createGenderSelect:function(){return'<td><select class="primary-value form-control">'+B(constants.genderOptions)+"</select></td>"},createIsOperatorSelect:function(){return'<td><select class="primary-value null-select form-control"><option value="NULL">NULL</option><option value="NOT_NULL">NOT NULL</option></select></td>'},createSimpleRuleValueField:function(e){return'<td><input name="rules['+e+'].primaryValue" type="text" class="primary-value rule-field form-control"/></td>'},createSimpleNewRuleValueField:function(){return'<td><input id="decision_newRule_primaryValue" type="text" class="primary-value form-control"/></td>'},addRuleProperties:function(e,t){e.filter("select, input").attr("name","rules["+t+"].primaryValue").addClass("rule-field")},addNewRuleProperties:function(e){e.filter("select, input").attr("id","decision_newRule_primaryValue")},updateVisibility:function(){this.onTypeChanged(),this.onDecisionReactionChanged(),this.onCriteriaChanged()},hideDecisionFormDiv:function(e){jQuery("form[name='decisionForm'] #"+e).css("display","none")},showDecisionFormDiv:function(e){jQuery("form[name='decisionForm'] #"+e).css("display","block")},updateVisibilityOfRuleMailingReceived:function(){var e=jQuery("form[name='decisionForm'] input[name='decisionType']:checked").val();if(e==constants.decisionTypeAutoOptimization)this.hideDecisionFormDiv("ruleMailingReceivedWrapper");else if(e==constants.decisionTypeDecision){var t=jQuery("form[name='decisionForm'] select[name='decisionCriteria']").val();if(t==constants.decisionReaction)this.hideDecisionFormDiv("ruleMailingReceivedWrapper");else if(t==constants.decisionProfileField){this.hideDecisionFormDiv("ruleMailingReceivedWrapper");var i=this.showDecisionFormDiv;d.getIncomingChainsForIcon().forEach(function(e){for(var t=e.length-1;0<=t;t--)e[t].type!=I.NODE_TYPE_MAILING&&e[t].type!=I.NODE_TYPE_ACTION_BASED_MAILING&&e[t].type!=I.NODE_TYPE_DATE_BASED_MAILING&&e[t].type!=I.NODE_TYPE_FOLLOWUP_MAILING||(a=e[t].data.mailingId,i("ruleMailingReceivedWrapper"))})}}},dateAsUTC:function(e){return e?new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())):null},checkPresentNodesByTypeList:function(e){var t=d.getCMNodes().getNodesByTypeList(e);return t&&0<t.length}},i=D.editors.decision}),this.addDomInitializer("recipient-editor-initializer",function(e){D.editors.recipient={formName:"recipientForm",safeToSave:!0,createNewTarget:function(){D.processForward(constants.forwardTargetGroupCreate,"#recipientTargetSelector",[],U)},editTarget:function(e){jQuery("#forwardTargetItemId").val(e),D.processForward(constants.forwardTargetGroupEdit,"#recipientTargetSelector",[],U)},getTitle:function(){return t("workflow.recipient")},fillEditor:function(e){var t=e.data,i=$("form[name='"+this.formName+"']");i.submit(!1),i.get(0).reset(),D.fillFormFromObject(this.formName,t,""),$("#recipientTargetSelect").select2("val",t.targets),$("#recipientTargetSelect").select2({formatSelection:function(e){return'<a href="#" class="btn-link-light" data-action="recipient-editor-target-edit" data-config="targetId: '+e.id+'">'+e.text+"</a>"}})},saveEditor:function(){var e=D.formToObject(this.formName);return e.targets=$("#recipientTargetSelect").val(),e}},n=D.editors.recipient}),this.addDomInitializer("parameter-editor-initializer",function(){D.editors.parameter={formName:"parameterForm",getTitle:function(){return t("workflow.parameter")},fillEditor:function(e){var t=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,t,"")},saveEditor:function(){return D.formToObject(this.formName)}}}),this.addDomInitializer("ownworkflow-copy-dialog-initializer",function(){o={workflowId:0,ownWorkflowCopyDialogResponse:function(e){return jQuery("#ownworkflow-use-original-dialog").dialog("close"),d.expandNodeUseOriginal(e,this.workflowId),!1},showDialog:function(e){this.workflowId=e,jQuery("#ownworkflow-use-original-dialog").dialog({title:t("workflow.ownWorkflow.copy_title"),dialogClass:"no-close",open:function(e,t){var i=jQuery("#ui-dialog-title-ownworkflow-use-original-dialog");i.css("padding-top",8),i.css("padding-bottom",8)},width:"auto",modal:!0,resizable:!1})}}}),this.addDomInitializer("ownworkflow-editor-initializer",function(){D.editors.ownWorkflow={formName:"ownWorkflowForm",node:null,getTitle:function(){return t("workflow.ownWorkflow.title")},fillEditor:function(e){var t=(this.node=e).data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,t,"")},saveEditor:function(){var e=D.formToObject(this.formName);return e.copyContent="true"==e.copyContent,e},saveWithCheck:function(){jQuery("#ownWorkflow-editor .editor-error-messages").css("display","none"),jQuery("#ownWorkflow-editor").css("display","none"),D.saveCurrentEditor(!0),D.openNode(this.node,!0),D.cancelEditor()},cancelEditor:function(){jQuery("#ownWorkflow-editor .editor-error-messages").css("display","none"),D.cancelEditor()},closeEditor:function(){D.deleteNode(this.node.id,!1,!1)}},e=D.editors.ownWorkflow}),this.addDomInitializer("mailing-editor-initializer",function(e){var i=e.find("#mailing-editor-data").json();h=new AGN.Lib.WM.MailingEditorBaseNew(i,d,U),D.editors.mailing={formName:"mailingForm",safeToSave:!0,getTitle:function(){return t("workflow.defaults.mailing")},fillEditor:function(e){var t=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,t,""),h.fillEditorBase(e),jQuery("#mailing-editor .editor-error-messages").css("display","none")},createNewMailing:function(){h.createNewMailing(constants.forwardMailingCreate)},editMailing:function(){h.editMailing(constants.forwardMailingEdit)},copyMailing:function(){h.copyMailing(constants.forwardMailingCopy)},saveEditor:function(){return h.setNodeFields(),h.disableInputs(),D.formToObject(this.formName)},saveWithCheckStatus:function(){h.showSecurityQuestion()&&D.saveCurrentEditor(!1,h)}},l=D.editors.mailing}),this.addDomInitializer("form-editor-initializer",function(e){D.editors.form={formName:"formsForm",safeToSave:!0,getTitle:function(){return t("forms")},createNewUserForm:function(){D.processForward(constants.forwardUserFormCreate,"#formsEditorUserFormId",[],U)},editForm:function(){var e=jQuery("form[name='"+this.formName+"'] select[name=userFormId]").val();jQuery("#forwardTargetItemId").val(e),D.processForward(constants.forwardUserFormEdit,"form[name='"+this.formName+"'] select[name=userFormId]",[],U)},fillEditor:function(e){var t=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,t,""),this.addLinks(),jQuery("#form-editor .editor-error-messages").css("display","none")},validateEditor:function(){0<jQuery("form[name='"+this.formName+"'] select[name=userFormId]").val()?D.saveCurrentEditor():(jQuery("#form-editor .editor-error-messages").html(t("error.workflow.noForm")),jQuery("#form-editor .editor-error-messages").css("display","block"))},onChange:function(){this.addLinks()},addLinks:function(){0<jQuery("form[name='"+this.formName+"'] select[name=userFormId]").val()?(jQuery("#form-editor #editFormLink").css("display","block"),jQuery("#form-editor #createFormLink").css("display","none")):(jQuery("#form-editor #createFormLink").css("display","block"),jQuery("#form-editor #editFormLink").css("display","none"))},saveEditor:function(){return D.formToObject(this.formName)},isSetFilledAllowed:function(){var e=!1;return 0<jQuery("#formsEditorUserFormId").val()&&(e=!0),e}},p=D.editors.form}),this.addDomInitializer("report-editor-initializer",function(e){D.editors.report={safeToSave:!0,getTitle:function(){return t("report")},createNewReport:function(){D.processForward(constants.forwardReportCreate,"#reportSelector",[],U)},editReport:function(e){jQuery("#forwardTargetItemId").val(e),D.processForward(constants.forwardReportEdit,"#reportSelector",[],U)},fillEditor:function(e){var t=e.data;D.initSelectWithFirstValue(jQuery("#reportSelect")),jQuery("#report-editor .editor-error-messages").css("display","none"),jQuery("#reportSelect").select2("val",t.reports),jQuery("#reportSelect").select2({formatSelection:function(e){return'<a href="#" class="btn-link-light" data-action="report-editor-change" data-config="reportId:'+e.id+'">'+e.text+"</a>"}})},validateEditor:function(){var e=$("#reportSelect").val();if(e&&0<e.length)D.saveCurrentEditor();else{var i=$("#report-editor").find(".editor-error-messages");i.html(t("workflow.report.error.no_report")),i.css("display","block")}},saveEditor:function(){return{reports:jQuery("#reportSelect").val()}},isSetFilledAllowed:function(){var e=!1,t=jQuery("#reportSelect").val();return t&&0<t.length&&(e=!0),e}},f=D.editors.report}),this.addDomInitializer("icon-comment-editor-initializer",function(e){D.editors["icon-comment"]={formName:"iconCommentForm",safeToSave:!0,fillEditor:function(e){var t=e.data;$("#iconComment").val(t.iconComment)},saveEditor:function(){var e=$("#iconComment").val();D.saveIconComment(e),this.cancelEditor()},cancelEditor:function(){return $("#icon-comment-editor").dialog("close"),!1}},N=D.editors["icon-comment"]}),this.addDomInitializer("export-editor-initializer",function(e){var n=e.find("#export-editor-data").json();D.editors.export={formName:"exportForm",safeToSave:!0,getTitle:function(){return t("auto_export")},createNewAutoExport:function(){D.processForward(constants.forwardAutoExportCreate,"form[name='"+this.formName+"'] select[name=importexportId]",[],U)},editAutoExport:function(){var e=jQuery("form[name='"+this.formName+"'] select[name=importexportId]").val();jQuery("#forwardTargetItemId").val(e),D.processForward(constants.forwardAutoExportEdit,"form[name='"+this.formName+"'] select[name=importexportId]",[],U)},fillEditor:function(e){var i=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,i,""),this.addLinks(),jQuery("#export-editor .editor-error-messages").css("display","none"),"true"==n.isDisabled&&(jQuery("#import-editor .editor-error-messages").html(t("error.workflow.autoExportPermission")),jQuery("#import-editor .editor-error-messages").css("display","block"))},validateEditor:function(){var i=$("#export-editor .editor-error-messages"),e=jQuery("form[name='"+this.formName+"'] select[name=importexportId]");0<e.val()?$.ajax({type:"POST",url:AGN.url("/workflow/validateDependency.action"),data:{workflowId:d.workflowId||0,type:2,entityId:e.val()}}).done(function(e){!0===e.valid?D.saveCurrentEditor():(i.html(t("error.workflow.autoExportInUse")),i.css("display","block"))}).fail(function(){i.html(t("Error")),i.css("display","block")}):(i.html(t("error.workflow.noExport")),i.css("display","block"))},onChange:function(){this.addLinks()},addLinks:function(){0<jQuery("form[name='"+this.formName+"'] select[name=importexportId]").val()?(jQuery("#export-editor #editAutoExportLink").css("display","block"),jQuery("#export-editor #createAutoExportLink").css("display","none")):(jQuery("#export-editor #createAutoExportLink").css("display","block"),jQuery("#export-editor #editAutoExportLink").css("display","none"))},saveEditor:function(){return D.formToObject(this.formName)},isSetFilledAllowed:function(){var e=$("form[name='"+this.formName+"'] select[name=importexportId]"),t=e.find(":selected");return!(0==e.val()||1!=t.data("is-available"))}},g=D.editors.export}),this.addDomInitializer("deadline-editor-initializer",function(e){D.editors.deadline={panelIds:["fixedDeadlinePanel","delayDeadlinePanel"],timeUnitIds:["deadlineTimeUnitMinute","deadlineTimeUnitHour","deadlineTimeUnitDay","deadlineTimeUnitWeek","deadlineTimeUnitMonth"],formName:"deadlineForm",getDefaultDelayData:function(e){var t={};return e===constants.deadlineTypeDelay&&this.isPrecededByImportIcon&&(t={timeUnit:constants.deadlineTimeUnitHour,delayValue:constants.defaultImportDelayLimit}),t},getTitle:function(){return t("workflow.deadline.title")},fillEditor:function(e){var t=e.data;$("#deadline-editor").find(".editor-error-messages").css("display","none"),this.isPrecededByImportIcon=this.checkPrecededByImportIcon(e);var i=$("form[name='"+this.formName+"']");i.submit(!1),$("form[name='"+this.formName+"'] #deadlineDate").pickadate("picker").set("select",this.dateAsUTC(t.date||new Date)),this.fillDelayData(i,t),$("form[name='"+this.formName+"'] #time").val(("0"+t.hour).slice(-2)+":"+("0"+t.minute).slice(-2))},fillDelayData:function(e,t){e.get(0).reset();var i=$("form[name='"+this.formName+"'] input[name='deadlineType']:checked").val(),n=this.getDefaultDelayData(i);D.fillFormFromObject(this.formName,t,"",n),this.updateVisibility();var o=t.delayValue||n.delayValue;D.initSelectWithValueOrChooseFirst($("form[name='"+this.formName+"'] select[name='delayValue']"),o)},saveEditor:function(){var e=D.formToObject(this.formName);e.date=$("form[name='"+this.formName+"'] #deadlineDate").pickadate("picker").get("select").obj;var t=$("form[name='"+this.formName+"'] #time").val();return e.hour=t.substring(0,2),e.minute=t.substring(3,5),e},updateVisibility:function(){var e=$("form[name='"+this.formName+"'] input[name='deadlineType']:checked").val();if(this.checkPresentNodesByTypeList([I.NODE_TYPE_ACTION_BASED_MAILING,I.NODE_TYPE_DATE_BASED_MAILING])?($("form[name='"+this.formName+"'] input#typeFixedDeadline").parent().parent().parent().hide(),$("form[name='"+this.formName+"'] input[value='"+constants.deadlineTypeDelay+"']").prop("checked",!0),e=constants.deadlineTypeDelay):$("form[name='"+this.formName+"'] input#typeFixedDeadline").parent().parent().parent().show(),e===constants.deadlineTypeDelay){switch(this.switchPanelsVisibility("delayDeadlinePanel"),this.switchTimeContainerVisibility(!1),$("form[name='"+this.formName+"'] select[name='timeUnit']").val()){case constants.deadlineTimeUnitMinute:this.switchTimeUnitsVisibility("deadlineTimeUnitMinute");break;case constants.deadlineTimeUnitHour:this.switchTimeUnitsVisibility("deadlineTimeUnitHour");break;case constants.deadlineTimeUnitDay:this.switchTimeUnitsVisibility("deadlineTimeUnitDay"),this.switchTimeContainerVisibility(!0),$("#deadlineTimeHelp").removeAttr("style");break;case constants.deadlineTimeUnitWeek:this.switchTimeUnitsVisibility("deadlineTimeUnitWeek");break;case constants.deadlineTimeUnitMonth:this.switchTimeUnitsVisibility("deadlineTimeUnitMonth")}$("form[name='"+this.formName+"'] input[name='useTime']").css("display","inline")}else e===constants.deadlineTypeFixedDeadline&&(this.switchPanelsVisibility("fixedDeadlinePanel"),this.switchTimeContainerVisibility(!0),this.hideDiv("deadlineTimeHelp"),$("form[name='"+this.formName+"'] input[name='useTime']").css("display","none"))},switchPanelsVisibility:function(t){var i=this;this.panelIds.forEach(function(e){e!==t&&i.hideDiv(e)}),this.showDiv(t)},switchTimeUnitsVisibility:function(t){var i=this;this.timeUnitIds.forEach(function(e){e!==t&&(i.hideDiv(e),$("#"+e+" select").removeAttr("name"))}),this.showDiv(t),$("#"+t+" select").attr("name","delayValue")},switchTimeContainerVisibility:function(e){e?this.showDiv("deadlineTimeContainer"):this.hideDiv("deadlineTimeContainer")},hideAllItems:function(e){var t=this;e.forEach(function(e){t.hideDiv(e)})},validateEditor:function(){var e=!0,i=constants.defaultImportDelayLimit;if(this.isPrecededByImportIcon&&$("form[name='"+this.formName+"'] input[name='deadlineType']:checked").val()===constants.deadlineTypeDelay){var n=$("form[name='"+this.formName+"'] select[name='timeUnit']").val();n===constants.deadlineTimeUnitMinute?e=!1:n===constants.deadlineTimeUnitHour&&$("#deadlineTimeUnitHour select").val()<i&&(e=!1)}if(e)D.saveCurrentEditor();else{var o=$("#deadline-editor").find(".editor-error-messages");o.html(t("error.workflow.deadlineIsTooShortForImport",i)),o.css("display","block")}},onTimeChanged:function(){var e=$("form[name='"+this.formName+"'] input[name='deadlineType']:checked").val(),t=$("form[name='"+this.formName+"'] select[name='timeUnit']").val();e==constants.deadlineTypeDelay&&t==constants.deadlineTimeUnitDay&&$("form[name='"+this.formName+"'] input[name='useTime']").prop("checked",!0)},hideDiv:function(e){$("form[name='"+this.formName+"'] #"+e).css("display","none")},showDiv:function(e){$("form[name='"+this.formName+"'] #"+e).css("display","block")},dateAsUTC:function(e){return e?new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())):null},checkPresentNodesByTypeList:function(e){var t=d.getCMNodes().getNodesByTypeList(e);return t&&0<t.length},checkPrecededByImportIcon:function(e){var i=d.getCMNodes();return d.getNodeIncomingConnections(e).some(function(e){var t=i.getNodeById(e.source);return t&&t.type==I.NODE_TYPE_IMPORT})}},m=D.editors.deadline}),this.addDomInitializer("import-editor-initializer",function(e){var n=e.find("#import-editor-data").json();D.editors.import={formName:"importForm",safeToSave:!0,getTitle:function(){return t("auto_import")},createNewAutoImport:function(){D.processForward(constants.forwardAutoImportCreate,"#importexportId",[],U)},editAutoImport:function(){var e=jQuery("form[name='"+this.formName+"'] select[name=importexportId]").val();jQuery("#forwardTargetItemId").val(e),D.processForward(constants.forwardAutoImportEdit,"form[name='"+this.formName+"'] select[name=importexportId]",[],U)},fillEditor:function(e){var i=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,i,""),this.addLinks(),jQuery("#import-editor .editor-error-messages").css("display","none"),"true"==n.isDisabled&&(jQuery("#import-editor .editor-error-messages").html(t("error.workflow.autoImportPermission")),jQuery("#import-editor .editor-error-messages").css("display","block"))},validateEditor:function(){var i=$("#import-editor .editor-error-messages"),e=jQuery("form[name='"+this.formName+"'] select[name=importexportId]");0<e.val()?$.ajax({type:"POST",url:AGN.url("/workflow/validateDependency.action"),data:{workflowId:d.workflowId||0,type:3,entityId:e.val()}}).done(function(e){!0===e.valid?D.saveCurrentEditor():(i.html(t("error.workflow.autoImportInUse")),i.css("display","block"))}).fail(function(){i.html(t("Error")),i.css("display","block")}):(i.html(t("error.workflow.noImport")),i.css("display","block"))},onChange:function(){this.addLinks()},addLinks:function(){0<jQuery("form[name='"+this.formName+"'] select[name=importexportId]").val()?(jQuery("#import-editor #editAutoImportLink").css("display","block"),jQuery("#import-editor #createAutoImportLink").css("display","none")):(jQuery("#import-editor #createAutoImportLink").css("display","block"),jQuery("#import-editor #editAutoImportLink").css("display","none"))},saveEditor:function(){return D.formToObject(this.formName)},isSetFilledAllowed:function(){var e=$("form[name='"+this.formName+"'] select[name=importexportId]"),t=e.find(":selected");return!(0==e.val()||1!=t.data("is-available"))}},v=D.editors.import}),this.addDomInitializer("archive-editor-initializer",function(e){D.editors.archive={formName:"archiveForm",safeToSave:!0,getTitle:function(){return t("workflow.mailing.archive")},createNewArchive:function(){D.processForward(constants.forwardArchiveCreate,"#settings_general_campaign",[],U)},fillEditor:function(e){var t=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,t,"")},saveEditor:function(){return D.formToObject(this.formName)}},y=D.editors.archive}),this.addDomInitializer("action-mailing-editor-initializer",function(e){var i=e.find("#action-mailing-editor-data").json();b=new AGN.Lib.WM.MailingEditorBaseNew(i,d,U),D.editors.actionbased_mailing={formName:"actionbasedMailingForm",safeToSave:!1,getTitle:function(){return t("workflow.mailing.action_based")},fillEditor:function(e){var t=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,t,""),b.fillEditorBase(e),jQuery("#actionbased_mailing-editor .editor-error-messages").css("display","none")},createNewMailing:function(){b.createNewMailing(constants.forwardMailingCreate)},editMailing:function(e){b.editMailing(constants.forwardMailingEdit)},saveEditor:function(){return b.setNodeFields(),b.disableInputs(),D.formToObject(this.formName)},saveWithCheckStatus:function(){b.showSecurityQuestion()&&D.saveCurrentEditor(!1,b)},copyMailing:function(){b.copyMailing(constants.forwardMailingCopy)}},w=D.editors.actionbased_mailing}),this.addDomInitializer("date-mailing-initializer",function(e){var i=e.find("#date-mailing-editor-data").json();A=new AGN.Lib.WM.MailingEditorBaseNew(i,d,U),D.editors.datebased_mailing={formName:"datebasedMailingForm",safeToSave:!1,getTitle:function(){return t("workflow.mailing.date_based")},fillEditor:function(e){var t=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,t,""),A.fillEditorBase(e),jQuery("#datebased_mailing-editor .editor-error-messages").css("display","none")},saveEditor:function(){return A.setNodeFields(),A.disableInputs(),D.formToObject(this.formName)},createNewMailing:function(){A.createNewMailing(constants.forwardMailingCreate)},editMailing:function(){A.editMailing(constants.forwardMailingEdit)},saveWithCheckStatus:function(){A.showSecurityQuestion()&&D.saveCurrentEditor(!1,A)},copyMailing:function(){A.copyMailing(constants.forwardMailingCopy)}},C=D.editors.datebased_mailing}),this.addDomInitializer("followup-mailing-editor-initializer",function(e){var i=e.find("#followup-mailing-base-data").json(),n=e.find("#followup-mailing-data").json();i.dropDownEl=jQuery("#followup-m-editor"),E=new AGN.Lib.WM.MailingEditorBaseNew(i,d,U),x=new AGN.Lib.WM.MailingEditorBaseNew(n,d,U),E.selectedFollowUpMailingId=0,E.mailingsInCampaign=[],E.findMailingIconsBefore=function(e){var t,i,n=d.getCMNodes().getNodes(),o=d.getNodeIncomingConnections(e);for("mailing"!==e.type&&"datebased_mailing"!==e.type&&"actionbased_mailing"!==e.type||this.mailingsInCampaign.push(e.data.mailingId),i=0;i<o.length;i++)t=_.findKey(n,function(e){return e.element.id===o[i].source}),this.findMailingIconsBefore(n[t])},E.getMailingsByWorkStatus=function(a,s,l,c){var u=this,d=jQuery(this.formNameJId+" "+this.selectNameJId);this.mailingsInCampaign=[],this.findMailingIconsBefore(this.node);var e=_.uniq(this.mailingsInCampaign).toString();d.attr("readonly","readonly"),jQuery.ajax({type:"POST",url:AGN.url("/workflow/getMailingsByWorkStatus.action"),data:{mailingTypes:this.mailingTypesForLoading.join(","),status:a,sort:s,order:l,mailingId:this.selectedFollowUpMailingId,parentMailingId:jQuery(this.formNameJId+" "+this.selectNameJId).val(),mailingStatus:"W",takeMailsForPeriod:!0,mailingsInCampaign:e},success:function(e){d.html(""),d.append('<option value="0">'+t("workflow.defaults.no_mailing")+"</option>");for(var i=0;i<e.length;i++){var n=e[i],o="",r="";"mailing.status.sent"!=n.WORK_STATUS&&"mailing.status.norecipients"!=n.WORK_STATUS||(o="style='color: #808080;'"),c==n.MAILING_ID&&(r="selected"),d.append("<option "+o+" value='"+n.MAILING_ID+"' status='"+n.WORK_STATUS+"' senddate='"+n.SENDDATE+"' "+r+">"+n.SHORTNAME+"</option>")}d.removeAttr("readonly"),u.mailingsStatus=a,u.mailingsSort=s,u.mailingsOrder=l,d.val(u.mailingId),D.initSelectWithValueOrChooseFirst(d,u.mailingId)}})},x.onMailingSelectChange=function(e){E.selectedFollowUpMailingId=e,this.setSelectMailingOptions(e)},D.editors.followup_mailing={formName:"followupMailingForm",safeToSave:!1,getTitle:function(){return t("workflow.mailing.followup")},fillEditor:function(e){x.fillEditorBase(e),E.fillEditorBase(e);var i=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,i,""),jQuery("#followup_mailing-editor .editor-error-messages").css("display","none"),"true"==n.disableFollowup&&(jQuery("#followup_mailing-editor .editor-error-messages").html(t("error.workflow.followupPermission")),jQuery("#followup_mailing-editor .editor-error-messages").css("display","block"),E.disableInputs())},createNewMailing:function(){E.node.data.baseMailingId=E.getSelectedMailingOption().val(),E.node.data.decisionCriterion=E.getSelectedDecisionOption().val(),x.createNewMailing(constants.forwardMailingCreate)},editMailing:function(){x.editMailing(constants.forwardMailingEdit)},copyMailing:function(){E.node.data.baseMailingId=E.getSelectedMailingOption().val(),E.node.data.decisionCriterion=E.getSelectedDecisionOption().val(),x.copyMailing(constants.forwardMailingCopy)},saveEditor:function(){return E.disableInputs(),x.disableInputs(),this.setNodeFields(),D.formToObject(this.formName)},saveWithCheckStatus:function(){x.showSecurityQuestion()&&D.saveCurrentEditor(!1,x)},validateEditor:function(e){var i=jQuery(E.formNameJId+" "+E.selectNameJId),n=jQuery(x.formNameJId+" "+x.selectNameJId);if(0<i.val()&&0<n.val())e?e():D.saveCurrentEditor();else{var o=$("#followup_mailing-editor").find(".editor-error-messages");o.html(t("error.workflow.noMailing")),o.css("display","block")}},setNodeFields:function(){this.setNodeFilled(E,x),this.setNodeIconTitle(E,x)},setNodeFilled:function(e,t){e.node.filled=0<parseInt(e.mailingId,10)&&0<parseInt(t.mailingId,10)},setNodeIconTitle:function(e,t){e.node.iconTitle="",0<parseInt(e.mailingId,10)?0<parseInt(t.mailingId,10)?e.node.iconTitle=e.getSelectedMailingOption().html()+":/"+t.getSelectedMailingOption().html():e.node.iconTitle=e.getSelectedMailingOption().html():e.node.iconTitle=" : "+t.getSelectedMailingOption().html()}},S=D.editors.followup_mailing}),this.addDomInitializer("copy-dialog-initializer",function(e){var i=e.find("#copy-editor-data-new").json();T={workflowId:{},workflowCopyDialogClose:function(){return jQuery("#workflow-copy-dialog-new").dialog("close"),!1},workflowCopyDialogResponse:function(e){return jQuery("#workflow-copy-dialog-new").dialog("close"),window.location=i.url+"?workflowId="+this.workflowId+"&isWithContent="+(e?"true":"false"),!1},showDialog:function(e){this.workflowId=e;var i=!0,n=d.getCMNodes().getNodes();for(var o in n){if(n.hasOwnProperty(o))if(n[o].filled){i=!1;break}}i?(jQuery("#workflow-copy-dialog-new div.form-group div.col-xs-12 div.well").html(t("workflow.copy.question")),jQuery("#workflowBtnWithContent").hide(),jQuery("#workflowBtnOnlyChain").hide(),jQuery("#workflowBtnCopy").show()):(jQuery("#workflow-copy-dialog-new div.form-group div.col-xs-12 div.well").html(t("workflow.copy.question_with_content")),jQuery("#workflowBtnCopy").hide(),jQuery("#workflowBtnWithContent").show(),jQuery("#workflowBtnOnlyChain").show()),jQuery("#workflow-copy-dialog-new").dialog({title:'<span class="dialog-fat-title">'+t("workflow.ownWorkflow.copy_title")+"</span>",dialogClass:"no-close",width:650,modal:!0,resizable:!1})}}}),this.addDomInitializer("save-before-pdf-initializer",function(){k={submitDialog:function(e){return e&&U(!0),jQuery("#workflow-save-before-pdf-dialog").dialog("close"),!1},showDialog:function(e,i){var n="";e?n=t("workflow.pdf.save_new_campaign"):i&&(n=t("workflow.pdf.save_modified_campaign")),jQuery("#workflow-save-before-pdf-dialog").find(".well").html(n),jQuery("#workflow-save-before-pdf-dialog").dialog({title:'<span class="dialog-fat-title">'+t("workflow.pdf.save_campaign")+"</span>",dialogClass:"no-close",width:650,modal:!0,resizable:!1})}}}),this.addDomInitializer("open-edit-icon-initializer",function(e){var t=e.json(),i=t.nodeId;if(i){var n=d.getCampaignManagerNodes();n.setOpenNode(i,t.elementValue),n.openNodeIcon()}}),this.addDomInitializer("testing-dialog-initializer",function(e){var i={},n=e.data("config"),o=AGN.Lib.Helpers.objFromString(n),r=function(){};i={showDialog:function(e){e instanceof Function&&(r=e),jQuery("#workflow-testing-dialog-new").dialog({title:'<span class="dialog-fat-title">'+t("workflow.single")+":&nbsp;"+o.shortname+"</span>",dialogClass:"no-close",width:650,modal:!0,resizable:!1})},closeDialog:function(){return $("#workflow-testing-dialog-new").dialog("close"),!1},acceptDialog:function(){$("#workflow-testing-dialog-new").dialog("close"),r(i)}},a.workflowTestingDialogHandler=i}),this.addAction({click:"workflowTestingDialogSubmitButton"},function(){a.workflowTestingDialogHandler.acceptDialog()}),this.addAction({click:"workflowTestingDialogCancelButton"},function(){a.workflowTestingDialogHandler.closeDialog()}),this.addAction({click:"workflowTestBtn"},function(){a.workflowTestingDialogHandler.showDialog(function(){var e=$("input#workflow_active"),t=e.prop("disabled");e.prop("disabled",!0),V(!0),e.prop("disabled",t)})}),this.addAction({click:"editor-save"},function(){return D.saveCurrentEditor(),!1}),this.addAction({click:"mailing-editor-save"},function(){return h.validateEditor(l.saveWithCheckStatus),!1}),this.addAction({click:"mailing-editor-base-no"},function(){return h.transferRequiredMailingData(),!1}),this.addAction({click:"mailing-editor-base-transfer-data"},function(){return h.transferMailingData(),!1}),this.addAction({click:"mailing-editor-base-close"},function(){return h.closeOneMailinglistWarningDialog(),!1}),this.addAction({click:"mailing-editor-base-accept"},function(){return h.acceptOneMailinglistPerCampaign(),!1}),this.addAction({click:"mailing-editor-base-sort-shortname"},function(){return h.onMailingSortClick("shortname","shortname",D),!1}),this.addAction({click:"mailing-editor-base-sort-data"},function(){var e=W(this.el);return h.onMailingSortClick("shortname",e.sortByDate,D),!1}),this.addAction({change:"mailing-editor-base-status-change"},function(){return h.onMailingsStatusChange(this.el.val()),!1}),this.addAction({change:"mailing-editor-base-select-change"},function(){return h.onMailingSelectChange(this.el.val()),!1}),this.addAction({click:"mailing-editor-base-secure-cancel"},function(){return h.cancelSecurityDialog(),!1}),this.addAction({click:"mailing-editor-copy"},function(){return D.curEditor.copyMailing(),!1}),this.addAction({click:"mailing-editor-new"},function(){return D.curEditor.createNewMailing(),!1}),this.addAction({click:"mailing-editor-edit"},function(){return D.curEditor.editMailing(),!1}),this.addAction({click:"mailing-editor-base-toggle-settings"},function(){var e=W(this.el);return h.toggleSendSettings(e.editorId),!1}),this.addAction({change:"form-editor-change"},function(){return p.onChange(),!1}),this.addAction({click:"form-editor-new"},function(){return p.createNewUserForm(),!1}),this.addAction({click:"form-editor-form-edit"},function(){return p.editForm(),!1}),this.addAction({click:"form-editor-save"},function(){return p.validateEditor(),!1}),this.addAction({click:"report-editor-change"},function(){var e=W(this.el);return f.editReport(e.reportId),!1}),this.addAction({click:"report-editor-new"},function(){return f.createNewReport(),!1}),this.addAction({click:"report-editor-save"},function(){return f.validateEditor(),!1}),this.addAction({change:"export-editor-change"},function(){return g.onChange(),!1}),this.addAction({click:"export-editor-new"},function(){return g.createNewAutoExport(),!1}),this.addAction({click:"export-editor-autoexport"},function(){return g.editAutoExport(),!1}),this.addAction({click:"export-editor-save"},function(){return g.validateEditor(),!1}),this.addAction({change:"deadline-editor-update"},function(){return m.updateVisibility(),!1}),this.addAction({change:"deadline-editor-time-change"},function(){return m.onTimeChanged(),!1}),this.addAction({click:"editor-cancel"},function(){return D.cancelEditor(),!1}),this.addAction({change:"import-editor-change"},function(){return v.onChange(),!1}),this.addAction({click:"import-editor-new"},function(){return v.createNewAutoImport(),!1}),this.addAction({click:"import-editor-update"},function(){return v.editAutoImport(),!1}),this.addAction({click:"import-editor-save"},function(){return v.validateEditor(),!1}),this.addAction({click:"icon-comment-editor-save"},function(){return N.saveEditor(),!1}),this.addAction({click:"icon-comment-editor-cancel"},function(){return N.cancelEditor(),!1}),this.addAction({click:"archive-editor-new"},function(){return y.createNewArchive(),!1}),this.addAction({click:"action-mailing-editor-save"},function(){return b.validateEditor(w.saveWithCheckStatus),!1}),this.addAction({click:"action-mailing-editor-base-sort-shortname"},function(){return b.onMailingSortClick("shortname","shortname",D),!1}),this.addAction({click:"action-mailing-editor-base-sort-data"},function(){var e=W(this.el);return b.onMailingSortClick("shortname",e.sortByDate,D),!1}),this.addAction({change:"action-mailing-editor-base-status-change"},function(){return b.onMailingsStatusChange(this.el.val()),!1}),this.addAction({change:"action-mailing-editor-base-select-change"},function(){return b.onMailingSelectChange(this.el.val()),!1}),this.addAction({click:"action-mailing-editor-base-no"},function(){return b.transferRequiredMailingData(),!1}),this.addAction({click:"action-mailing-editor-base-secure-cancel"},function(){return b.cancelSecurityDialog(),!1}),this.addAction({click:"action-mailing-editor-base-transfer-data"},function(){return b.transferMailingData(),!1}),this.addAction({click:"date-mailing-editor-base-sort-shortname"},function(){return A.onMailingSortClick("shortname","shortname",D),!1}),this.addAction({click:"date-mailing-editor-base-sort-data"},function(){var e=W(this.el);return A.onMailingSortClick("shortname",e.sortByDate,D),!1}),this.addAction({change:"date-mailing-editor-base-status-change"},function(){return A.onMailingsStatusChange(this.el.val()),!1}),this.addAction({change:"date-mailing-editor-base-select-change"},function(){return A.onMailingSelectChange(this.el.val()),!1}),this.addAction({click:"date-mailing-editor-base-no"},function(){return A.transferRequiredMailingData(),!1}),this.addAction({click:"date-mailing-editor-base-transfer-data"},function(){return A.transferMailingData(),!1}),this.addAction({click:"followup-mailing-editor-base-sort-shortname"},function(){return x.onMailingSortClick("shortname","shortname",D),!1}),this.addAction({click:"followup-mailing-editor-base-sort-data"},function(){var e=W(this.el);return x.onMailingSortClick("shortname",e.sortByDate,D),!1}),this.addAction({change:"followup-mailing-editor-base-status-change"},function(){return x.onMailingsStatusChange(this.el.val()),!1}),this.addAction({change:"followup-mailing-editor-base-select-change"},function(){return x.onMailingSelectChange(this.el.val()),!1}),this.addAction({click:"followup-base-mailing-editor-base-sort-shortname"},function(){return E.onMailingSortClick("shortname","shortname"),!1}),this.addAction({click:"followup-base-mailing-editor-base-sort-data"},function(){var e=W(this.el);return E.onMailingSortClick("shortname",e.sortByDate),!1}),this.addAction({change:"followup-base-mailing-editor-base-status-change"},function(){return E.onMailingsStatusChange(this.el.val()),!1}),this.addAction({change:"followup-base-mailing-editor-base-select-change"},function(){return E.onMailingSelectChange(this.el.val()),!1}),this.addAction({click:"followup-base-mailing-editor-base-no"},function(){return E.transferRequiredMailingData(),!1}),this.addAction({click:"followup-base-mailing-editor-base-transfer-data"},function(){return E.transferMailingData(),!1}),this.addAction({click:"save-before-pdf-btn-save"},function(){return k.submitDialog(!0),!1}),this.addAction({click:"save-before-pdf-btn-cancel"},function(){return k.submitDialog(!1),!1}),this.addAction({click:"workflowSaveBtn"},function(){U(!0)}),this.addAction({click:"workflowSaveBtnModal"},function(){U(!0)}),this.addAction({click:"campaignEditorEnlarge"},function(){$("#modalCampaignEditorContainer").append($("#campaignEditorBody")),z()}),F.new({click:"[data-close-campaign-editor-modal]"},function(){$("#pageCampaignEditorContainer").append($("#campaignEditorBody")),z()}),this.addAction({change:"workflow-view-change-status"},function(){$("#workflow_active").is(":checked")?$("#workflow-status").val(constants.statusActive):$("#workflow-status").val(constants.statusInactive)}),this.addAction({click:"workflowCopyBtn"},function(){T.showDialog(a.workflowId)}),this.addAction({click:"workflowStatsBtn"},function(){!function(e,i){"true"===a.isStatusOpen?workflownoStatisticsDialogHandler.showDialog():(r.toggleStatistics(e),function(e){var i=t("workflow.fade_in_statistics"),n=t("workflow.fade_out_statistics"),o=e.html();o=r.statisticsVisible?o.replace(i,n):o.replace(n,i);e.html(o)}(i))}(a.workflowId,this.el)}),this.addAction({change:"start-editor-execution-changed"},function(){s.onExecutionChanged()}),this.addAction({change:"start-editor-event-changed"},function(){s.onStartEventChanged()}),this.addAction({change:"start-editor-type-changed"},function(){s.onStartTypeChanged()}),this.addAction({change:"start-editor-rule-changed"},function(){s.onRuleModeChanged()}),this.addAction({change:"start-editor-reaction-changed"},function(){s.onReactionChanged()}),this.addAction({change:"start-editor-profile-field-changed"},function(){return s.onProfileFieldChanged(),!1}),this.addAction({click:"start-editor-add-rule"},function(){return s.addRule(),!1}),this.addAction({click:"start-editor-reminder-changed"},function(){s.onReminderChanged()}),this.addAction({click:"start-editor-schedule-reminder-date-changed"},function(){s.onScheduleReminderDateChanged()}),this.addAction({click:"start-editor-validate"},function(){return s.validateEditor(),!1}),this.addAction({click:"start-editor-mailing-sort-date"},function(){return c.onMailingSortClick("date"),!1}),this.addAction({change:"start-editor-mailing-select"},function(){return s.onMailingSelectChange(this.el.val()),!1}),this.addAction({click:"start-editor-mailing-sort-shortname"},function(){return c.onMailingSortClick("shortname"),!1}),this.addAction({click:"decision-editor-mailing-sort-shortname"},function(){return u.onMailingSortClick("shortname"),!1}),this.addAction({click:"decision-editor-mailing-sort-date"},function(){return u.onMailingSortClick("date"),!1}),this.addAction({change:"decision-editor-mailing-select"},function(){return i.onMailingSelectChange(this.el.val()),!1}),this.addAction({click:"start-editor-rule-remove"},function(){return s.removeRuleRow(this.el.data("rule-index")),!1}),this.addAction({change:"start-rule-operator-change"},function(){return s.onRuleOperatorChanged(this.el),!1}),this.addAction({change:"decision-rule-operator-change"},function(){return i.onRuleOperatorChanged(this.el),!1}),this.addAction({click:"decision-editor-rule-remove"},function(){return i.removeRuleRow(this.el.data("rule-index")),!1}),this.addAction({click:"decision-editor-rule-add"},function(){return i.addRule(),!1}),this.addAction({change:"decision-editor-type-change"},function(){i.onTypeChanged()}),this.addAction({change:"decision-editor-criteria-change"},function(){return i.onCriteriaChanged(),!1}),this.addAction({change:"decision-editor-reaction-change"},function(){return i.onDecisionReactionChanged(),!1}),this.addAction({click:"decision-editor-save"},function(){return i.validateEditor(),!1}),this.addAction({change:"decision-editor-profile-field-change"},function(){return i.onProfileFieldChanged(),!1}),this.addAction({click:"recipient-editor-create-new-target"},function(){return n.createNewTarget(),!1}),this.addAction({click:"recipient-editor-save"},function(){return D.saveCurrentEditor(),!1}),this.addAction({click:"recipient-editor-target-edit"},function(){var e=W(this.el);return n.editTarget(e.targetId),!1}),this.addAction({click:"parameter-editor-save"},function(){return D.saveCurrentEditor(),!1}),this.addAction({click:"ownworkflow-copy-dialog"},function(){var e=W(this.el);return o.ownWorkflowCopyDialogResponse(e.useOriginal),!1}),this.addAction({click:"ownworkflow-editor-cancel"},function(){return e.cancelEditor(),!1}),this.addAction({click:"ownworkflow-editor-save"},function(){return e.saveWithCheck(),!1}),this.addAction({click:"editor-save-current"},function(){return D.saveCurrentEditor(),!1}),this.addAction({click:"deadline-editor-save"},function(){return m.validateEditor(),!1}),this.addAction({click:"date-mailing-editor-save"},function(){return A.validateEditor(C.saveWithCheckStatus),!1}),this.addAction({click:"followup-mailing-editor-save"},function(){return S.validateEditor(S.saveWithCheckStatus),!1}),this.addAction({click:"copy-dialog-copy"},function(){return T.workflowCopyDialogResponse(!0),!1}),this.addAction({click:"copy-dialog-chain-copy"},function(){return T.workflowCopyDialogResponse(!1),!1}),this.addAction({click:"copy-dialog-cancel"},function(){return T.workflowCopyDialogClose(),!1}),this.addAction({click:"workflow-generate-pdf"},function(){return function(){var e=!0;0!==a.workflowId&&""!==a.shotrName&&(e=!1);var t=d.canUndo();e||t?k.showDialog(e,t):(window.location.href=a.pdfGenerationUrl+"?workflowId="+a.workflowId+"&showStatistics="+r.statisticsVisible,AGN.Lib.Loader.hide())}(),!1}),H.prototype.setup=function(e){this.startTypeOpen=e.startTypeOpen,this.startTypeDate=e.startTypeDate,this.startTypeEvent=e.startTypeEvent,this.startEventReaction=e.startEventReaction,this.startEventDate=e.startEventDate,this.endTypeAutomatic=e.endTypeAutomatic,this.endTypeDate=e.endTypeDate,this.deadlineTypeDelay=e.deadlineTypeDelay,this.deadlineTypeFixedDeadline=e.deadlineTypeFixedDeadline,this.deadlineTimeUnitMinute=e.deadlineTimeUnitMinute,this.deadlineTimeUnitHour=e.deadlineTimeUnitHour,this.deadlineTimeUnitDay=e.deadlineTimeUnitDay,this.deadlineTimeUnitWeek=e.deadlineTimeUnitWeek,this.deadlineTimeUnitMonth=e.deadlineTimeUnitMonth,this.reactionOpened=e.reactionOpened,this.reactionNotOpened=e.reactionNotOpened,this.reactionClicked=e.reactionClicked,this.reactionNotClicked=e.reactionNotClicked,this.reactionBought=e.reactionBought,this.reactionNotBought=e.reactionNotBought,this.reactionDownload=e.reactionDownload,this.reactionChangeOfProfile=e.reactionChangeOfProfile,this.reactionWaitingForConfirm=e.reactionWaitingForConfirm,this.reactionOptIn=e.reactionOptIn,this.reactionOptOut=e.reactionOptOut,this.reactionClickedLink=e.reactionClickedLink,this.reactionOpenedAndClicked=e.reactionOpenedAndClicked,this.reactionOpenedOrClicked=e.reactionOpenedOrClicked,this.reactionConfirmedOptIn=e.reactionConfirmedOptIn,constants.reactionRegistry(),this.decisionTypeDecision=e.decisionTypeDecision,this.decisionTypeAutoOptimization=e.decisionTypeAutoOptimization,this.decisionReaction=e.decisionReaction,this.decisionProfileField=e.decisionProfileField,this.decisionAOCriteriaClickRate=e.decisionAOCriteriaClickRate,this.decisionAOCriteriaOpenrate=e.decisionAOCriteriaOpenrate,this.decisionAOCriteriaTurnover=e.decisionAOCriteriaTurnover,this.chainOperatorAnd=e.chainOperatorAnd,this.chainOperatorOr=e.chainOperatorOr,this.operatorIs=e.operatorIs,this.forwardTargetGroupCreate=e.forwardTargetGroupCreate,this.forwardTargetGroupEdit=e.forwardTargetGroupEdit,this.forwardMailingCreate=e.forwardMailingCreate,this.forwardMailingEdit=e.forwardMailingEdit,this.forwardMailingCopy=e.forwardMailingCopy,this.forwardUserFormCreate=e.forwardUserFormCreate,this.forwardUserFormEdit=e.forwardUserFormEdit,this.forwardReportCreate=e.forwardReportCreate,this.forwardReportEdit=e.forwardReportEdit,this.forwardAutoExportCreate=e.forwardAutoExportCreate,this.forwardAutoExportEdit=e.forwardAutoExportEdit,this.forwardAutoImportCreate=e.forwardAutoImportCreate,this.forwardAutoImportEdit=e.forwardAutoImportEdit,this.forwardArchiveCreate=e.forwardArchiveCreate,this.genderOptions=e.genderOptions,this.chainOperatorOptions=e.chainOperatorOptions,this.operators=e.operators,this.operatorsMap=e.operatorsMap,this.statusActive=e.statusActive,this.statusInactive=e.statusInactive,this.defaultImportDelayLimit=e.defaultImportDelayLimit,this.workflowURL=e.workflowURL,this.componentURL=e.componentURL},H.prototype.reactionRegistry=function(){I.reactionRegistry[constants.reactionOpened]={image:"reaction_opened.png",name:t("workflow.reaction.opened")},I.reactionRegistry[constants.reactionNotOpened]={image:"reaction_notopened.png",name:t("workflow.reaction.not_opened")},I.reactionRegistry[constants.reactionClicked]={image:"reaction_clicked.png",name:t("workflow.reaction.clicked")},I.reactionRegistry[constants.reactionNotClicked]={image:"reaction_notclicked.png",name:t("workflow.reaction.not_clicked")},I.reactionRegistry[constants.reactionBought]={image:"reaction_bought.png",name:t("workflow.reaction.bought")},I.reactionRegistry[constants.reactionNotBought]={image:"reaction_notbought.png",name:t("workflow.reaction.not_bought")},I.reactionRegistry[constants.reactionChangeOfProfile]={image:"reaction_profilechange.png",name:t("workflow.reaction.change_of_profile")},I.reactionRegistry[constants.reactionWaitingForConfirm]={image:"reaction_wfc.png",name:t("workflow.reaction.waiting_for_confirm")},I.reactionRegistry[constants.reactionOptIn]={image:"reaction_optin.png",name:t("workflow.reaction.opt_in")},I.reactionRegistry[constants.reactionOptOut]={image:"reaction_optout.png",name:t("workflow.reaction.opt_out")},I.reactionRegistry[constants.reactionClickedLink]={image:"reaction_clicked.png",name:t("workflow.reaction.clicked_on_link")},I.reactionRegistry[constants.reactionOpenedAndClicked]={image:"reaction_profilechange.png",name:t("workflow.reaction.opened_and_clicked")},I.reactionRegistry[constants.reactionOpenedOrClicked]={image:"reaction_profilechange.png",name:t("workflow.reaction.opened_or_clicked")}}}),AGN.Lib.Controller.new("workflow-view",function(){var r,d,a,s,c,u,i,n,o,e,l,h,p,f,g,m,v,y,b,w,C,A,E,x,S,T,D,k,R,O,N,F=AGN.Lib.Action,M=AGN.Lib.Template,P=AGN.Lib.Confirm,I=AGN.Lib.WM.NodeFactory,L="gender";function G(e){return{allMailinglists:e.allMailingLists,allMailings:e.allMailings,allTargets:e.allTargets,allReports:e.allReports,allUserForms:e.allUserForms,allAutoExports:e.allAutoExports,allAutoImports:e.allAutoImports,allCampaigns:e.allCampaigns}}function B(t){var i="";return Object.keys(t).forEach(function(e){i+="<option "+('value="'+e+'"')+">"+t[e]}),i}function j(e){var o="";return e.forEach(function(e){var t='value="'+e.id+'"',i=e.data;i&&Object.keys(i).forEach(function(e){t+=" data-"+e+'="'+i[e].replace('"',"&quot;")+'"'});var n=e.text.replace("<","&lt;").replace(">","&gt;");o+="<option "+t+">"+n+"</option>"}),o}function W(e){return AGN.Lib.Helpers.objFromString(e.data("config"))}function H(){}function z(){AGN.Lib.CampaignManagerService.resizeTimeoutId&&clearTimeout(AGN.Lib.CampaignManagerService.resizeTimeoutId),AGN.Lib.CampaignManagerService.resizeTimeoutId=setTimeout(function(){var e=0!=$("#modalCampaignEditorContainer").find($("#campaignEditorBody")).length,t=$("#viewPort"),i=$("#editorCanvas"),n=$("#toolbarLeft"),o=505,r=t[0].clientWidth,a=e?$("#modalCampaignEditorContainer").height()-$("#toolbarTop").height():t[0].clientHeight;if(i.width(r),i.height(a),d.setEditorCanvasWidth(r),d.setEditorCanvasHeight(a),d.setViewPortWidth(r),d.setViewPortHeight(a),e)o<a&&(n.height(a),i.height(a),t.height(a));else{var s=808+jQuery("#tile-campaignInformation").outerHeight(),l=jQuery("html").scrollTop(),c=jQuery("html").height();s<c+l&&(o+=c+l-s),n.height(o),i.height(o),t.height(o)}},100)}function V(e){function i(){var e=AGN.Lib.Form.get($("form#workflowForm"));e.setValueOnce("schema",d.getIconsForSubmissionJson()),e.setValueOnce("editorPositionLeft",d.getLeftPosition()),e.setValueOnce("editorPositionTop",d.getTopPosition()),e.setValueOnce("workflowUndoHistoryData",d.getUndoHistoryDataForSubmission()),e.submit("static")}e?function(){var e=$.Deferred();if($("#name").val().length<3)AGN.Lib.Messages(t("workflow.defaults.error"),t("error.workflow.shortName"),"alert"),e.reject();else{if(d.checkMailingTypesConvertingRequired())return P.create(M.text("mailing-types-replace-modal"));e.resolve()}return e.promise()}().done(i):i()}function U(e){var i=$("#workflow_active").is(":checked"),n=R===constants.statusActive&&!i,o=R!==constants.statusActive&&i;if(n||!d.checkWorkflowBeforeSave())if(o){$("input[name='workflow.statusString']").val(constants.statusActive);var r=d.getMailingNames();$("#activating-campaign-mailings").html(r),$("#activating-campaign-dialog").css("visibility","visible"),$("#activating-campaign-dialog").show(),$("#activating-campaign-activate-button").click(function(){return V(e),!1}),$("#activating-campaign-dialog").dialog({open:function(e,i){var n=$("#activating-campaign-dialog").parent().find(".ui-dialog-title");n.empty(),n.append('<span class="dialog-title-image">'+t("workflow.activating.title")+"</span>"),n.find(".dialog-title-image").css("padding-left","0px")},modal:!0,resizable:!1,width:650,minHeight:0,close:function(e,t){return!1}})}else n?($("input[name='workflow.statusString']").val(constants.statusInactive),$("#inactivating-campaign-dialog").css("visibility","visible"),$("#inactivating-campaign-dialog").show(),$("#inactivating-campaign-inactivate-button").click(function(){return V(e),$("#inactivating-campaign-dialog").dialog("close"),!1}),$("#inactivating-campaign-dialog").dialog({open:function(e,i){var n=$("#inactivating-campaign-dialog").parent().find(".ui-dialog-title");n.empty(),n.append('<span class="dialog-title-image">'+t("workflow.inactivating.title")+"</span>"),n.find(".dialog-title-image").css("padding-left","0px")},modal:!0,resizable:!1,width:650,minHeight:0,close:function(e,t){return!1}})):V(e)}this.addDomInitializer("workflow-view-constants",function(){(constants=constants||new H).setup(this.config)}),this.addDomInitializer("workflow-pdf-initialize",function(){var e,t,i=this.config,n=i.sessionId,o=i.locale;O=G(i),campaignManagerSettings.imagePath=i.imageUrl+"/campaignManager/",t=new AGN.Lib.WM.CampaignManagerScale({campaignManagerSettings:campaignManagerSettings}),AGN.Lib.CampaignManagerService={icons:i.icons,resizeTimeoutId:!1},d=new AGN.Lib.WM.CampaignManager({campaignManagerScale:t,campaignManagerSettings:campaignManagerSettings,restoreSpaceFields:["name","workflow_description"],editorPositionLeft:i.editorPositionLeft,editorPositionTop:i.editorPositionTop,localeDateNTimePattern:i.localeDateNTimePattern,noContextMenu:i.noContextMenu,pageContextSessionId:n,allUsedEntity:O,isPdfGenerating:!0,workflowURL:constants.workflowURL,componentURL:constants.componentURL}),D=d.getEditorsHelper(),e=new AGN.Lib.WM.WorkflowManagerStatistics(d),$.datepicker.setDefaults($.datepicker.regional[o]),d.restoreWorkflow(AGN.Lib.CampaignManagerService.icons),d.updateWorkflowForPdf(),i.showStatistics&&e.toggleStatistics(i.workflowId)}),this.addDomInitializer("campaign-manager-init",function(e){a=this.config,a.isActivated,R=a.workflowStatus,a.workflowNewStatus,O=G(a),AGN.Lib.CampaignManagerService={icons:a.icons,resizeTimeoutId:!1},campaignManagerSettings.imagePath=a.imageUrl+"/campaignManager/";var t=new AGN.Lib.WM.CampaignManagerScale({campaignManagerSettings:campaignManagerSettings});d=new AGN.Lib.WM.CampaignManager({workflowId:a.workflowId,isActivated:a.isActivated,restoreSpaceFields:["name","workflow_description"],editorPositionLeft:a.editorPositionLeft,editorPositionTop:a.editorPositionTop,localeDateNTimePattern:a.localeDateNTimePattern,pageContextSessionId:a.pageContextSessionId,campaignManagerScale:t,campaignManagerSettings:campaignManagerSettings,allUsedEntity:O,workflowURL:constants.workflowURL,componentURL:constants.componentURL}),D=d.getEditorsHelper(),r=new AGN.Lib.WM.WorkflowManagerStatistics(d),jQuery.datepicker.setDefaults(jQuery.datepicker.regional[a.emmLocal]),a.newStatus===a.pageContextSessionId&&d.setWorkflowManagerStateChangedCallback(function(){$("#workflow_active").prop("disabled",!d.isNodesFilled())});var i=AGN.Lib.CampaignManagerService.icons;for(var n in null!=i.length&&d.restoreWorkflow(i),d.setHistoryStackChangedCallback(function(e){AGN.Lib.WM.CampaignManagerToolbar.setUndoAvailable(e)}),d.setConnectionNotAllowedCallback(function(){workflowNotAllowedConnectionDialogHandler.showDialog()}),d.setEditingNotAllowedCallback(function(){workflowNotAllowedEditingDialogHandler.showDialog()}),d.setUndoHistoryDataForSubmission(a.workflowUndoHistoryData),jQuery("#legend-button-wrapper").bind({mouseover:function(){d.getCurrentState()==d.STATE_WAITING&&jQuery("#legend-dopdown").show()},mouseout:function(){jQuery("#legend-dopdown").hide()}}),I.reactionRegistry)if(I.reactionRegistry.hasOwnProperty(n)){var o="<div class='legend-dopdown-item'><img src='"+a.imageUrl+"/campaignManager/"+I.reactionRegistry[n].image+"'/></div><div class='legend-dopdown-item-name'>"+I.reactionRegistry[n].name+"</div>";jQuery("#legend-dopdown").append(o)}jQuery(window).resize(function(){z()})}),this.addDomInitializer("start-editor-initializer",function(e){var l=e.find("#start-editor-data").json();c=new AGN.Lib.WM.MailingSelectorBase(l.form,l.container,l.sessionId,l.selectedName,l.noMailingOption,D);var i,n,o,r,a=l.profileFields,u=l.isBigData;D.editors.start={rulesNumber:0,isStartEditor:!1,timePattern:/^(\d{2}):(\d{2})$/,getTitle:function(){return this.isStartEditor?t("workflow.start.title"):t("workflow.stop.title")},getStartStopDate:function(e){e=e||D.formToObject("startForm");var t=$('form[name="startForm"]'),i=null;if(this.isStartEditor)switch(e.startType){case constants.startTypeDate:i=t.find("#startDate").pickadate("picker");break;case constants.startTypeEvent:i=t.find("#executionDate").pickadate("picker")}else e.endType==constants.endTypeDate&&(i=t.find("#startDate").pickadate("picker"));if(i){var n=i.get("select");if(n)return n.obj}return null},generateReminderComment:function(){var e=$("#workflowForm input[name='workflow.shortname']").val(),i=AGN.Lib.WM.DateTimeUtils.getDateStr(this.getStartStopDate(),l.localeDatePattern);return(this.isStartEditor?t("workflow.start.reminder_text"):t("workflow.stop.reminder_text")).replace(/:campaignName/g,e).replace(/:startDate/g,i).replace(/:endDate/g,i)},fillEditor:function(e){var i=e.data;this.isStartEditor="start"==e.type,this.updateEditorType(this.isStartEditor);var n=$("form[name='startForm']");if(n.submit(!1),n.find(".rule-row").each(function(){$(this).remove()}),n.find("#remindCalendarDateTitle").text(this.isStartEditor?t("workflow.start.start_date"):t("workflow.stop.end_date")),null!=i.rules){for(var o=0;o<i.rules.length;o++){var r=i.rules[o];this.createRuleRow(o,r)}this.rulesNumber=i.rules.length}n.get(0).reset(),i.adminTimezone=l.adminTimezone,i.sendReminder=i.scheduleReminder,D.fillFormFromObject("startForm",i,""),c.setMailingId(i.mailingId),c.cleanOptions(1);var a,s=new Date;n.find("#startDate").pickadate("picker").set("select",this.dateAsUTC(null!=i.date?i.date:s)),n.find("#executionDate").pickadate("picker").set("select",this.dateAsUTC(null!=i.date?i.date:s)),n.find("#remindDate").pickadate("picker").set("select",this.dateAsUTC(null!=i.remindDate?i.remindDate:s)),null!=i.date?(n.find("#startTime").val(this.formatTime(i.hour,i.minute)),n.find("#remindTime").val(this.formatTime(i.remindHour,i.remindMinute))):this.setCurrentTime(),this.updateChainFieldsVisibility(),this.updateVisibility(),this.updateOperatorsAvailability(),i.startType==constants.startTypeEvent&&i.event==constants.startEventReaction&&i.reaction==constants.reactionClickedLink&&0!=i.mailingId&&null!=i.mailingId&&this.onMailingSelectChange(i.mailingId,i.linkId),i.comment||n.find("#reminderComment").val(this.generateReminderComment()),a=""!=i.recipients?2:1,$("#start-editor input[name='userType'][value="+a+"]").prop("checked",!0).trigger("change"),$("#start-editor .editor-error-messages").css("display","none")},saveEditor:function(){var e,t=D.formToObject("startForm");t.date=this.getStartStopDate(t),null==t.date&&(t.date=new Date,t.date.setHours(0),t.date.setMinutes(0),t.date.setSeconds(0),t.date.setMilliseconds(0));var i=jQuery("form[name='startForm'] #startTime").val();(e=this.timePattern.exec(i))?(t.hour=e[1],t.minute=e[2]):(t.hour=0,t.minute=0),t.scheduleReminder=t.sendReminder;var n=jQuery("form[name='startForm'] #remindTime").val();return(e=this.timePattern.exec(n))?(t.remindHour=e[1],t.remindMinute=e[2]):(t.remindHour=0,t.remindMinute=0),"true"==jQuery("input[name='remindSpecificDate']:checked").val()?t.remindDate=jQuery("form[name='startForm'] #remindDate").pickadate("picker").get("select").obj:(t.remindDate=t.date,t.remindHour=0,t.remindMinute=0),null==t.rules&&(t.rules=[]),null!=t.linkId&&null!=t.linkId||(t.linkId=0),t.dateFieldOperator!=l.equelsOperatorCode&&(t.dateFieldOperator=l.equelsOperatorCode),2==t.userType?(t.remindAdminId=0,t.recipients=$.trim(t.recipients).toLowerCase().split(/[,;\s\n\r]+/).filter(function(e){return!!e}).join(", ")):t.recipients="",delete t.userType,t},validateEditorInternal:function(r){var a=this,s=!0,l=$("#start-editor .editor-error-messages"),c=$("form[name='startForm']"),e=this.isStartEditor?c.find("input[name='startType']:checked").val():c.find("input[name='endType']:checked").val();this.isStartEditor&&e==constants.startTypeEvent&&(function(){switch(c.find("select[name='event']").val()){case constants.startTypeDate:if(c.find("#executionDate").pickadate("picker").get("select").obj){var e=c.find("#startTime").val();a.timePattern.test(e)||(s=!1)}else s=!1;var i=c.find("#dateFieldValue");$.trim(i.val())||(s=!1,r&&(l.html(t("error.workflow.startDateOmitted")),l.css("display","block")));break;case constants.startEventReaction:switch(c.find("select[name='reaction']").val()){case constants.reactionClickedLink:var n=c.find("select[name='linkId']").val();parseInt(n,10)<=0&&(s=!1,r&&(l.html(t("error.workflow.noLinkSelected")),l.css("display","block")));case constants.reactionOpened:case constants.reactionClicked:var o=c.find("select[name='mailingId']").val();parseInt(o,10)<=0&&(s=!1);break;case constants.reactionChangeOfProfile:if(void 0!==u&&1==u)c.find("select[name='profileField']").val()||(s=!1);break;case constants.reactionWaitingForConfirm:case constants.reactionOptIn:case constants.reactionOptOut:break;default:s=!1}}}(),i()),(this.isStartEditor&&e==constants.startTypeDate||!this.isStartEditor&&e==constants.endTypeDate)&&i(),s&&c.find("#sendReminder").is(":checked")&&(2==c.find('input[name="userType"]:checked').val()&&($.trim(c.find('textarea[name="recipients"]').val()).split(/[,;\s\n\r]+/).filter(function(e){return!!e}).length||r&&(s=!1,l.html(t("error.workflow.emptyRecipientList")),l.css("display","block"))));return s;function i(){if(c.find("#startDate").pickadate("picker").get("select").obj){var e=c.find("#startTime").val();a.timePattern.test(e)||(s=!1)}else s=!1}},validateEditor:function(){this.validateEditorInternal(!0)&&D.saveCurrentEditor()},isSetFilledAllowed:function(){return this.validateEditorInternal(!1)},setCurrentTime:function(){var t=this;jQuery.ajax({type:"POST",url:constants.workflowURL,data:{method:"getCurrentAdminTime"},success:function(e){jQuery("form[name='startForm'] #startTime").val(t.formatTime(e.hour,e.minute)),jQuery("form[name='startForm'] #remindTime").val(t.formatTime(e.remindHour,e.remindMinute))}})},updateEditorType:function(e){$("#startStopType").empty(),e?($("#startStopType").append(AGN.Lib.Template.text("start-types")),jQuery("#eventReaction").html(t("workflow.start.reaction_based")),jQuery("#eventDate").html(t("workflow.start.date_based"))):($("#startStopType").append(AGN.Lib.Template.text("stop-types")),d.isNormalCampaignActionsType()?jQuery("#endTypeActiomaticLabel").html(t("workflow.stop.automatic_end")):jQuery("#endTypeActiomaticLabel").html(t("workflow.stop.open_end")))},onRulesChanged:function(){var o=0;$("form[name='startForm'] #profileFieldAddedRules tr").each(function(){var e=$(this),t=e.attr("id"),i=t.substring(5),n=$("#"+t);n.find(".rule-field").attr("name",function(e,t){return t?t.replace(i,o+""):""}),n.find(".delete-rule").attr("data-rule-index",function(e,t){return t==i?o:t}),e.attr("id","rule_"+o),o++}),this.updateChainFieldsVisibility()},updateChainFieldsVisibility:function(){0<this.rulesNumber?(jQuery('form[name="startForm"] [name="rules[0].chainOperator"]').css("visibility","hidden"),jQuery('form[name="startForm"] #newRule_chainOperator').css("visibility","visible")):jQuery("form[name='startForm'] #newRule_chainOperator").css("visibility","hidden")},updateOperatorsAvailability:function(){var e=$('form[name="startForm"] select[name="profileField"]').val(),t=a[e];$('form[name="startForm"] select.primary-operator').each(function(){var e=$(this);e.children("option").prop("disabled",function(){var e=$(this).data("types");return!("*"==e||!e)&&-1==e.split(/[\s,]+/).indexOf(t)}),AGN.Initializers.Select(e),null==e.val()&&D.initSelectWithFirstValue(e)})},addRule:function(){var e={chainOperator:jQuery("form[name='startForm'] #newRule_chainOperator").val(),parenthesisOpened:jQuery("form[name='startForm'] #newRule_parenthesisOpened").val(),primaryOperator:jQuery("form[name='startForm'] #newRule_primaryOperator").val(),primaryValue:jQuery("form[name='startForm'] #newRule_primaryValue").val(),parenthesisClosed:jQuery("form[name='startForm'] #newRule_parenthesisClosed").val()};this.createRuleRow(this.rulesNumber,e),D.fillFormFromObject("startForm",e,"rules["+this.rulesNumber+"]."),this.rulesNumber++,$("#newRule_primaryOperator").val()==constants.operatorIs&&$("#newRule_primaryValue").parents("td").replaceWith(this.createSimpleNewRuleValueField()),this.updateChainFieldsVisibility(),this.updateOperatorsAvailability(),$("form[name='startForm'] #profileFieldRuleAdd select").each(function(){D.initSelectWithFirstValue($(this))}),$("form[name='startForm'] #profileFieldRuleAdd input").each(function(){$(this).val("")})},removeRuleRow:function(e){jQuery("form[name='startForm'] #rule_"+e).remove(),this.rulesNumber--,this.onRulesChanged()},createRuleRow:function(e,i){var n=this.createSimpleRuleValueField(e),o=j(constants.operators);this.curProfileField==L?n=this.createGenderSelect():i.primaryOperator==constants.operatorIs&&(n=this.createIsOperatorSelect()),jQuery("form[name='startForm'] #profileFieldAddedRules").append('<tr class="rule-row" id="rule_'+e+'"><td><select name="rules['+e+'].chainOperator" class="rule-field"><option value="'+constants.chainOperatorAnd+'">'+t("workflow.defaults.and")+'</option><option value="'+constants.chainOperatorOr+'">'+t("workflow.defaults.or")+'</option></select></td><td><select name="rules['+e+'].parenthesisOpened" class="parentheses-opened rule-field"><option value="0">&nbsp</option><option value="1">(</option></select></td><td><select name="rules['+e+'].primaryOperator" class="primary-operator rule-field" data-action="start-rule-operator-change">'+o+"</select></td>"+n+'<td><select name="rules['+e+'].parenthesisClosed" class="parenthesis-closed rule-field"><option value="0">&nbsp</option><option value="1">)</option></select></td><td><a class="mailing_delete delete-rule btn btn-regular btn-alert" href="#" data-action="start-editor-rule-remove" data-rule-index="'+e+'"><i class="icon icon-minus-circle"></i></a></td></tr>'),this.addRuleProperties(jQuery("#rule_"+e+" .primary-value"),e),AGN.runAll($("form[name='startForm'] #profileFieldAddedRules"))},onStartTypeChanged:function(){var e=this.isStartEditor?jQuery("form[name='startForm'] input[name='startType']:checked").val():jQuery("form[name='startForm'] input[name='endType']:checked").val();this.isStartEditor&&e==constants.startTypeDate||!this.isStartEditor&&e==constants.endTypeDate?(this.toggleFormat(),this.hideDiv("startEventPanel"),this.showDiv("startDatePanel"),this.showDiv("startIconTime"),this.showDiv("startRemindAdmin")):this.isStartEditor&&e==constants.startTypeEvent?(this.hideDiv("startDatePanel"),this.showDiv("startEventPanel"),this.showDiv("startIconTime"),this.showDiv("startRemindAdmin"),this.onStartEventChanged()):(this.isStartEditor&&e==constants.startTypeOpen||!this.isStartEditor&&e==constants.endTypeAutomatic)&&(this.hideDiv("startDatePanel"),this.hideDiv("startEventPanel"),this.hideDiv("startIconTime"),this.hideDiv("startRemindAdmin"))},onStartEventChanged:function(){jQuery("#startEvent").val()==constants.startEventReaction?(this.toggleFormat(),this.hideDiv("dateStartPanel"),this.showDiv("reactionStartPanel"),this.onExecutionChanged(),this.onProfileFieldChanged()):jQuery("#startEvent").val()==constants.startEventDate&&(this.toggleFormat(),this.hideDiv("reactionStartPanel"),this.showDiv("dateStartPanel"),this.hideDiv("executionDateLabel"),this.showDiv("firstExecutionDateLabel"),jQuery("#startIconDateFormat").insertAfter("#startIconDateFieldOperator"),this.showDiv("startIconDateFormat"))},toggleFormat:function(){o=o||$("select#startEvent"),n=n||$("input#typeEvent"),i=i||$("input#startTime"),n.prop("checked"),r=o.val()==constants.startEventDate,n.prop("checked")&&r?i.inputmask("h:00"):i.inputmask("h:s")},onRuleModeChanged:function(){"false"==$("input[name='useRules']:checked").val()?this.hideDiv("profileFieldRules"):this.showDiv("profileFieldRules")},onProfileFieldChanged:function(){var e=$("form[name='startForm'] select[name='profileField']").val();"DATE"==a[e]?($("#startIconDateFormat").insertAfter("#reactionProfileField"),this.showDiv("startIconDateFormat")):this.hideDiv("startIconDateFormat"),this.updateOperatorsAvailability()},getRuleIndex:function(e){return e.attr("id").substring(5)},onRuleOperatorChanged:function(e){if(this.curProfileField!=L){var t=e.closest("tr"),i=t.attr("id")?this.getRuleIndex(t):null;if(e.val()==constants.operatorIs){var n=$(this.createIsOperatorSelect());t.find(".primary-value").parents("td").replaceWith(n),AGN.Initializers.Select(n)}else if(t.find(".primary-value").hasClass("null-select")){var o;o=null==i?this.createSimpleNewRuleValueField():this.createSimpleRuleValueField(i),t.find(".primary-value").parents("td").replaceWith(o)}null==i?this.addNewRuleProperties(t.find(".primary-value")):this.addRuleProperties(t.find(".primary-value"),i)}},createGenderSelect:function(){return'<td><select class="primary-value form-control">'+B(constants.genderOptions)+"</select></td>"},createIsOperatorSelect:function(){return'<td><select class="primary-value null-select form-control"><option value="NULL">NULL</option><option value="NOT_NULL">NOT NULL</option></select></td>'},createSimpleRuleValueField:function(e){return'<td><input name="rules['+e+'].primaryValue" type="text" class="primary-value rule-field form-control"/></td>'},createSimpleNewRuleValueField:function(){return'<td><input id="newRule_primaryValue" type="text" class="primary-value form-control"/></td>'},addRuleProperties:function(e,t){e.filter("select, input").attr("name","rules["+t+"].primaryValue").addClass("rule-field")},addNewRuleProperties:function(e){e.filter("select, input").attr("id","newRule_primaryValue")},onExecutionChanged:function(){"false"==$("input[name='executeOnce']:checked").val()?(this.hideDiv("executionDateLabel"),this.showDiv("firstExecutionDateLabel")):(this.hideDiv("firstExecutionDateLabel"),this.showDiv("executionDateLabel"))},onReactionChanged:function(){var e=$("form[name='startForm'] #startReaction").val();e==constants.reactionOpened||e==constants.reactionNotOpened||e==constants.reactionClicked||e==constants.reactionNotClicked||e==constants.reactionBought||e==constants.reactionNotBought||e==constants.reactionClickedLink?(this.hideDiv("reactionStartProfile"),this.showDiv("reactionStartMailing")):e==constants.reactionChangeOfProfile?(this.hideDiv("reactionStartMailing"),this.showDiv("reactionStartProfile")):(this.hideDiv("reactionStartMailing"),this.hideDiv("reactionStartProfile")),e==constants.reactionClickedLink?this.showDiv("reactionStartMailingLink"):this.hideDiv("reactionStartMailingLink")},onReminderChanged:function(){return $("input[name='sendReminder']:checked").val()?($('form[name="startForm"]').find("#reminderComment").val(this.generateReminderComment()),this.showDiv("reminderDetails")):this.hideDiv("reminderDetails"),!1},onScheduleReminderDateChanged:function(){return"true"==$("form[name='startForm'] input[name='remindSpecificDate']:checked").val()?this.showDiv("dateTimePicker"):this.hideDiv("dateTimePicker"),!1},onMailingSelectChange:function(e,t){var i=$("form[name='startForm'] select[name='linkId']"),n=parseInt(e,10);0<n?(i.attr("readonly","readonly"),$.ajax({type:"POST",url:constants.workflowURL,data:{method:"getMailingLinks",mailingId:n},success:function(e){i.empty(),$.each(e,function(e,t){i.append($("<option></option>",{value:t.id,text:t.url}))}),i.removeAttr("readonly"),null!=t&&null!=t?(i.val(t),D.initSelectWithValueOrChooseFirst(i,t)):D.initSelectWithFirstValue(i)}})):i.empty()},updateVisibility:function(){this.onStartTypeChanged(),this.onStartEventChanged(),this.onReactionChanged(),this.onRuleModeChanged(),this.onExecutionChanged(),this.onReminderChanged(),this.onScheduleReminderDateChanged()},hideDiv:function(e){jQuery("form[name='startForm'] #"+e).css("display","none")},showDiv:function(e){jQuery("form[name='startForm'] #"+e).css("display","")},dateAsUTC:function(e){return e?new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())):null},formatTime:function(e,t){var i=0,n=0;return 0<=(e=parseInt(e,10))&&(i=e),0<=(t=parseInt(t,10))&&(n=t),(i<10?"0"+i:i)+":"+(n<10?"0"+n:n)}},s=D.editors.start,D.editors.stop=D.editors.start}),this.addDomInitializer("decision-editor-initializer",function(e){var a,l=e.find("#decision-editor-data").json(),n=l.profileFields;u=new AGN.Lib.WM.MailingSelectorBase(l.form,l.container,l.sessionId,l.selectName,l.noMailingOption,D),D.editors.decision={rulesNumber:0,rulePrefix:"decision_",prevProfileField:"",curProfileField:"",getTitle:function(){return t("workflow.decision")},fillEditor:function(e){a=0;var t=e.data;if(jQuery("form[name='decisionForm']").submit(!1),jQuery("form[name='decisionForm'] .rule-row").each(function(){jQuery(this).remove()}),this.curProfileField=t.profileField,null!=t.rules){for(var i=0;i<t.rules.length;i++){var n=t.rules[i];this.createRuleRow(i,n)}this.rulesNumber=t.rules.length}jQuery("form[name='decisionForm']").get(0).reset(),D.fillFormFromObject("decisionForm",t,""),u.setMailingId(t.mailingId),u.cleanOptions(1),null==t.decisionDate&&(t.decisionDate=new Date);var o=jQuery("form[name='decisionForm'] #decisionDate"),r=jQuery("form[name='decisionForm'] #decisionTime");this.checkPresentNodesByTypeList([I.NODE_TYPE_ACTION_BASED_MAILING,I.NODE_TYPE_DATE_BASED_MAILING])?(o.parent().parent().hide(),r.parent().parent().parent().parent().hide()):(o.parent().parent().show(),r.parent().parent().parent().parent().show(),o.pickadate("picker").set("select",this.dateAsUTC(t.decisionDate)),r.val(("0"+t.decisionDate.getHours()).slice(-2)+":"+("0"+t.decisionDate.getMinutes()).slice(-2))),this.updateChainFieldsVisibility(),this.updateVisibility(),this.updateDateFormatVisibility(),this.updateOperatorsAvailability(),t.decisionType==constants.decisionTypeDecision&&t.decisionCriteria==constants.decisionReaction&&t.reaction==constants.reactionClickedLink&&0!=t.mailingId&&null!=t.mailingId?this.onMailingSelectChange(t.mailingId,t.linkId):D.resetSelect(jQuery("form[name='decisionForm'] select[name='linkId']")),jQuery("#decision-editor .editor-error-messages").css("display","none")},saveEditor:function(){var e=D.formToObject("decisionForm");if(e.decisionCriteria==constants.decisionProfileField&&0!=a&&(e.mailingId=a),a=0,null==e.rules&&(e.rules=[]),e.threshold||(e.threshold=""),this.checkPresentNodesByTypeList([I.NODE_TYPE_ACTION_BASED_MAILING,I.NODE_TYPE_DATE_BASED_MAILING]))e.decisionDate=null;else{e.decisionDate=jQuery("form[name='decisionForm'] #decisionDate").pickadate("picker").get("select").obj;var t=jQuery("form[name='decisionForm'] #decisionTime").val();e.decisionDate.setHours(t.substring(0,2)),e.decisionDate.setMinutes(t.substring(3,5))}return e},validateEditor:function(){var e=jQuery("form[name='decisionForm'] input[name='decisionType']:checked").val(),i=jQuery("#decisionCriteria").val(),n=jQuery("form[name='decisionForm'] select[name='mailingId']").val(),o=jQuery("form[name='decisionForm'] select[name='linkId']").val(),r=jQuery("form[name='decisionForm'] select[name='reaction']").val(),a=jQuery("form[name='decisionForm'] input[name='threshold']").val();if(e==constants.decisionTypeDecision&&i==constants.decisionReaction&&0==n)jQuery("#decision-editor .editor-error-messages").html(t("error.workflow.noMailing")),jQuery("#decision-editor .editor-error-messages").css("display","block");else if(e!=constants.decisionTypeDecision||i!=constants.decisionReaction||r!=constants.reactionClickedLink||0!=o&&null!=o)if(e==constants.decisionTypeDecision&&i==constants.decisionProfileField&&0==l.isMailtrackingActive);else if(e==constants.decisionTypeAutoOptimization)if(a){var s=parseInt(a,10);s&&0<s?D.saveCurrentEditor():(jQuery("#decision-editor .editor-error-messages").html(t("error.workflow.noValidThreshold")),jQuery("#decision-editor .editor-error-messages").css("display","block"))}else D.saveCurrentEditor();else D.saveCurrentEditor();else jQuery("#decision-editor .editor-error-messages").html(t("error.workflow.noLinkSelected")),jQuery("#decision-editor .editor-error-messages").css("display","block")},onTypeChanged:function(){var e=jQuery("form[name='decisionForm'] input[name='decisionType']:checked").val();e==constants.decisionTypeDecision?(this.hideDecisionFormDiv("autoOptimizationPanel"),this.showDecisionFormDiv("decisionPanel")):e==constants.decisionTypeAutoOptimization&&(this.hideDecisionFormDiv("decisionPanel"),this.showDecisionFormDiv("autoOptimizationPanel")),this.updateVisibilityOfRuleMailingReceived()},onDecisionReactionChanged:function(){if(jQuery("form[name='decisionForm'] select[name='reaction']").val()==constants.reactionClickedLink){this.showDecisionFormDiv("reactionLinkPanel");var e=jQuery("form[name='decisionForm'] select[name='mailingId']").val();this.onMailingSelectChange(e,0)}else this.hideDecisionFormDiv("reactionLinkPanel")},onCriteriaChanged:function(){var e=jQuery("form[name='decisionForm'] select[name='decisionCriteria']").val();e==constants.decisionReaction?(this.hideDecisionFormDiv("decisionProfileFieldPanel"),this.showDecisionFormDiv("decisionReactionPanel")):e==constants.decisionProfileField&&(this.hideDecisionFormDiv("decisionReactionPanel"),this.showDecisionFormDiv("decisionProfileFieldPanel")),this.updateVisibilityOfRuleMailingReceived()},onMailingSelectChange:function(e,t){var i=$("form[name='decisionForm'] select[name='linkId']"),n=parseInt(e,10);0<n?(i.attr("readonly","readonly"),$.ajax({type:"POST",url:constants.workflowURL,data:{method:"getMailingLinks",mailingId:n},success:function(e){i.empty(),$.each(e,function(e,t){i.append($("<option></option>",{value:t.id,text:t.url}))}),i.removeAttr("readonly"),null!=t&&null!=t?(i.val(t),D.initSelectWithValueOrChooseFirst(i,t)):D.initSelectWithFirstValue(i)}})):i.empty()},onRuleOperatorChanged:function(e){if(this.curProfileField!=L){var t=e.closest("tr"),i=t.attr("id")?this.getRuleIndex(t):null;if(e.val()==constants.operatorIs){var n=$(this.createIsOperatorSelect());t.find(".primary-value").parents("td").replaceWith(n),AGN.Initializers.Select(n)}else if(t.find(".primary-value").hasClass("null-select")){var o;o=null==i?this.createSimpleNewRuleValueField():this.createSimpleRuleValueField(i),t.find(".primary-value").parents("td").replaceWith(o)}null==i?this.addNewRuleProperties(t.find(".primary-value")):this.addRuleProperties(t.find(".primary-value"),i)}},getRuleIndex:function(e){return e.attr("id").substring(14)},onProfileFieldChanged:function(){var e=jQuery("form[name='decisionForm'] select[name='profileField']").val();this.curProfileField=e;var t=this;e==L?(jQuery("#decisionProfileFieldRules .primary-value").each(function(){jQuery(this).parents("td").remove()}),jQuery("form[name='decisionForm'] .rule-row").each(function(){var e=t.getRuleIndex(jQuery(this));jQuery(this).find(".decision-rule-operator").parents("td").after(t.createGenderSelect()),t.addRuleProperties(jQuery(this).find(".primary-value"),e)}),jQuery("#decision_newRule_primaryOperator").parents("td").after(this.createGenderSelect()),this.addNewRuleProperties(jQuery("#decisionProfileFieldRuleAdd .primary-value"))):this.prevProfileField==L&&(jQuery("#decisionProfileFieldRules .primary-value").each(function(){jQuery(this).parents("td").remove()}),jQuery("form[name='decisionForm'] .rule-row").each(function(){var e=t.getRuleIndex(jQuery(this));jQuery(this).find(".decision-rule-operator").val()==constants.operatorIs?(jQuery(this).find(".primary-value").parents("td").remove(),jQuery(this).find("select").parents("td").after(t.createIsOperatorSelect()),t.addRuleProperties(jQuery(this).find(".primary-value"),e)):jQuery(this).find(".decision-rule-operator").parents("td").after(t.createSimpleRuleValueField(e))}),jQuery("#decision_newRule_primaryOperator").val()==constants.operatorIs?(jQuery("#decisionProfileFieldRuleAdd").find("select").parents("td").after(this.createIsOperatorSelect()),this.addNewRuleProperties(jQuery("#decisionProfileFieldRuleAdd .primaryValue"))):jQuery("#decision_newRule_primaryOperator").parents("td").after(this.createSimpleNewRuleValueField())),this.updateDateFormatVisibility(),this.updateOperatorsAvailability(),this.prevProfileField=e},updateDateFormatVisibility:function(){var e=jQuery("form[name='decisionForm'] select[name='profileField']").val();"DATE"==n[e]?this.showDecisionFormDiv("decisionDateFormat"):this.hideDecisionFormDiv("decisionDateFormat")},updateOperatorsAvailability:function(){var t=$('form[name="decisionForm"] select[name="profileField"]').val(),i=n[t];$('form[name="decisionForm"] select.decision-rule-operator').each(function(){var e=$(this);e.children("option").prop("disabled",function(){var e=$(this).data("types");return t==L?"="!=this.text&&"!="!=this.text:!("*"==e||!e)&&-1==e.split(/[\s,]+/).indexOf(i)}),AGN.Initializers.Select(e),null==e.val()&&D.initSelectWithFirstValue(e)})},onRulesChanged:function(){var o=0,r=this;$("form[name='decisionForm'] #decisionProfileFieldAddedRules .rule-row").each(function(){var e=$(this),t=e.attr("id"),i=r.getRuleIndex(e),n=$("#"+t);n.find(".rule-field").attr("name",function(e,t){return t?t.replace(i,o+""):""}),n.find(".delete-rule").attr("data-rule-index",function(e,t){return t==i?o:t}),e.attr("id","decision_rule_"+o),o++}),this.updateChainFieldsVisibility()},updateChainFieldsVisibility:function(){0<this.rulesNumber?(jQuery('form[name="decisionForm"] [name="rules[0].chainOperator"]').css("visibility","hidden"),jQuery('form[name="decisionForm"] #decision_newRule_chainOperator').css("visibility","visible")):jQuery("form[name='decisionForm'] #decision_newRule_chainOperator").css("visibility","hidden")},addRule:function(){var e={chainOperator:$("form[name='decisionForm'] #decision_newRule_chainOperator").val(),parenthesisOpened:$("form[name='decisionForm'] #decision_newRule_parenthesisOpened").val(),primaryOperator:$("form[name='decisionForm'] #decision_newRule_primaryOperator").val(),primaryValue:$("form[name='decisionForm'] #decision_newRule_primaryValue").val(),parenthesisClosed:$("form[name='decisionForm'] #decision_newRule_parenthesisClosed").val()};this.createRuleRow(this.rulesNumber,e),D.fillFormFromObject("decisionForm",e,"rules["+this.rulesNumber+"]."),this.rulesNumber++,$("#decision_newRule_primaryOperator").val()==constants.operatorIs&&$("#decision_newRule_primaryValue").parents("td").replaceWith(this.createSimpleNewRuleValueField()),this.updateChainFieldsVisibility(),this.updateOperatorsAvailability(),$("form[name='decisionForm'] #decisionProfileFieldRuleAdd select").each(function(){D.initSelectWithFirstValue($(this))}),$("form[name='decisionForm'] #decisionProfileFieldRuleAdd input").each(function(){$(this).val("")})},removeRuleRow:function(e){jQuery("form[name='decisionForm'] #decision_rule_"+e).remove(),this.rulesNumber--,this.onRulesChanged()},createRuleRow:function(e,i){var n=this.createSimpleRuleValueField(e),o=j(constants.operators);this.curProfileField==L?n=this.createGenderSelect():i.primaryOperator==constants.operatorIs&&(n=this.createIsOperatorSelect()),jQuery("form[name='decisionForm'] #decisionProfileFieldAddedRules").append('<tr class="rule-row" id="decision_rule_'+e+'"><td><select name="rules['+e+'].chainOperator" class="rule-field"><option value="'+constants.chainOperatorAnd+'">'+t("workflow.defaults.and")+'</option><option value="'+constants.chainOperatorOr+'">'+t("workflow.defaults.or")+'</option></select></td><td><select name="rules['+e+'].parenthesisOpened" class="parentheses-opened rule-field"><option value="0">&nbsp</option><option value="1">(</option></select></td><td><select name="rules['+e+'].primaryOperator" class="decision-rule-operator rule-field" data-action="decision-rule-operator-change">'+o+"</select></td>"+n+'<td><select name="rules['+e+'].parenthesisClosed" class="parenthesis-closed rule-field"><option value="0">&nbsp</option><option value="1">)</option></select></td><td><a class="mailing_delete delete-rule btn btn-regular btn-alert" href="#" data-action="decision-editor-rule-remove" data-rule-index="'+e+'"><i class="icon icon-minus-circle"></i></a></td></tr>'),this.addRuleProperties(jQuery("#decision_rule_"+e+" .primary-value"),e),AGN.runAll($("form[name='decisionForm'] #decisionProfileFieldAddedRules"))},createGenderSelect:function(){return'<td><select class="primary-value form-control">'+B(constants.genderOptions)+"</select></td>"},createIsOperatorSelect:function(){return'<td><select class="primary-value null-select form-control"><option value="NULL">NULL</option><option value="NOT_NULL">NOT NULL</option></select></td>'},createSimpleRuleValueField:function(e){return'<td><input name="rules['+e+'].primaryValue" type="text" class="primary-value rule-field form-control"/></td>'},createSimpleNewRuleValueField:function(){return'<td><input id="decision_newRule_primaryValue" type="text" class="primary-value form-control"/></td>'},addRuleProperties:function(e,t){e.filter("select, input").attr("name","rules["+t+"].primaryValue").addClass("rule-field")},addNewRuleProperties:function(e){e.filter("select, input").attr("id","decision_newRule_primaryValue")},updateVisibility:function(){this.onTypeChanged(),this.onDecisionReactionChanged(),this.onCriteriaChanged()},hideDecisionFormDiv:function(e){jQuery("form[name='decisionForm'] #"+e).css("display","none")},showDecisionFormDiv:function(e){jQuery("form[name='decisionForm'] #"+e).css("display","block")},updateVisibilityOfRuleMailingReceived:function(){var e=jQuery("form[name='decisionForm'] input[name='decisionType']:checked").val();if(e==constants.decisionTypeAutoOptimization)this.hideDecisionFormDiv("ruleMailingReceivedWrapper");else if(e==constants.decisionTypeDecision){var t=jQuery("form[name='decisionForm'] select[name='decisionCriteria']").val();if(t==constants.decisionReaction)this.hideDecisionFormDiv("ruleMailingReceivedWrapper");else if(t==constants.decisionProfileField){this.hideDecisionFormDiv("ruleMailingReceivedWrapper");var i=this.showDecisionFormDiv;d.getIncomingChainsForIcon().forEach(function(e){for(var t=e.length-1;0<=t;t--)e[t].type!=I.NODE_TYPE_MAILING&&e[t].type!=I.NODE_TYPE_ACTION_BASED_MAILING&&e[t].type!=I.NODE_TYPE_DATE_BASED_MAILING&&e[t].type!=I.NODE_TYPE_FOLLOWUP_MAILING||(a=e[t].data.mailingId,i("ruleMailingReceivedWrapper"))})}}},dateAsUTC:function(e){return e?new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())):null},checkPresentNodesByTypeList:function(e){var t=d.getCMNodes().getNodesByTypeList(e);return t&&0<t.length}},i=D.editors.decision}),this.addDomInitializer("recipient-editor-initializer",function(e){D.editors.recipient={formName:"recipientForm",safeToSave:!0,createNewTarget:function(){D.processForward(constants.forwardTargetGroupCreate,"#recipientTargetSelector",[],U)},editTarget:function(e){jQuery("#forwardTargetItemId").val(e),D.processForward(constants.forwardTargetGroupEdit,"#recipientTargetSelector",[],U)},getTitle:function(){return t("workflow.recipient")},fillEditor:function(e){var t=e.data,i=$("form[name='"+this.formName+"']");i.submit(!1),i.get(0).reset(),D.fillFormFromObject(this.formName,t,""),$("#recipientTargetSelect").select2("val",t.targets),$("#recipientTargetSelect").select2({formatSelection:function(e){return'<a href="#" class="btn-link-light" data-action="recipient-editor-target-edit" data-config="targetId: '+e.id+'">'+e.text+"</a>"}})},saveEditor:function(){var e=D.formToObject(this.formName);return e.targets=$("#recipientTargetSelect").val(),e}},n=D.editors.recipient}),this.addDomInitializer("parameter-editor-initializer",function(){D.editors.parameter={formName:"parameterForm",getTitle:function(){return t("workflow.parameter")},fillEditor:function(e){var t=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,t,"")},saveEditor:function(){return D.formToObject(this.formName)}}}),this.addDomInitializer("ownworkflow-copy-dialog-initializer",function(){o={workflowId:0,ownWorkflowCopyDialogResponse:function(e){return jQuery("#ownworkflow-use-original-dialog").dialog("close"),d.expandNodeUseOriginal(e,this.workflowId),!1},showDialog:function(e){this.workflowId=e,jQuery("#ownworkflow-use-original-dialog").dialog({title:t("workflow.ownWorkflow.copy_title"),dialogClass:"no-close",open:function(e,t){var i=jQuery("#ui-dialog-title-ownworkflow-use-original-dialog");i.css("padding-top",8),i.css("padding-bottom",8)},width:"auto",modal:!0,resizable:!1})}}}),this.addDomInitializer("ownworkflow-editor-initializer",function(){D.editors.ownWorkflow={formName:"ownWorkflowForm",node:null,getTitle:function(){return t("workflow.ownWorkflow.title")},fillEditor:function(e){var t=(this.node=e).data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,t,"")},saveEditor:function(){var e=D.formToObject(this.formName);return e.copyContent="true"==e.copyContent,e},saveWithCheck:function(){jQuery("#ownWorkflow-editor .editor-error-messages").css("display","none"),jQuery("#ownWorkflow-editor").css("display","none"),D.saveCurrentEditor(!0),D.openNode(this.node,!0),D.cancelEditor()},cancelEditor:function(){jQuery("#ownWorkflow-editor .editor-error-messages").css("display","none"),D.cancelEditor()},closeEditor:function(){D.deleteNode(this.node.id,!1,!1)}},e=D.editors.ownWorkflow}),this.addDomInitializer("mailing-editor-initializer",function(e){var i=e.find("#mailing-editor-data").json();h=new AGN.Lib.WM.MailingEditorBase(i,d,U),D.editors.mailing={formName:"mailingForm",safeToSave:!0,getTitle:function(){return t("workflow.defaults.mailing")},fillEditor:function(e){var t=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,t,""),h.fillEditorBase(e),jQuery("#mailing-editor .editor-error-messages").css("display","none")},createNewMailing:function(){h.createNewMailing(constants.forwardMailingCreate)},editMailing:function(){h.editMailing(constants.forwardMailingEdit)},copyMailing:function(){h.copyMailing(constants.forwardMailingCopy)},saveEditor:function(){return h.setNodeFields(),h.disableInputs(),D.formToObject(this.formName)},saveWithCheckStatus:function(){h.showSecurityQuestion()&&D.saveCurrentEditor(!1,h)}},l=D.editors.mailing}),this.addDomInitializer("form-editor-initializer",function(e){D.editors.form={formName:"formsForm",safeToSave:!0,getTitle:function(){return t("forms")},createNewUserForm:function(){D.processForward(constants.forwardUserFormCreate,"#formsEditorUserFormId",[],U)},editForm:function(){var e=jQuery("form[name='"+this.formName+"'] select[name=userFormId]").val();jQuery("#forwardTargetItemId").val(e),D.processForward(constants.forwardUserFormEdit,"form[name='"+this.formName+"'] select[name=userFormId]",[],U)},fillEditor:function(e){var t=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,t,""),this.addLinks(),jQuery("#form-editor .editor-error-messages").css("display","none")},validateEditor:function(){0<jQuery("form[name='"+this.formName+"'] select[name=userFormId]").val()?D.saveCurrentEditor():(jQuery("#form-editor .editor-error-messages").html(t("error.workflow.noForm")),jQuery("#form-editor .editor-error-messages").css("display","block"))},onChange:function(){this.addLinks()},addLinks:function(){0<jQuery("form[name='"+this.formName+"'] select[name=userFormId]").val()?(jQuery("#form-editor #editFormLink").css("display","block"),jQuery("#form-editor #createFormLink").css("display","none")):(jQuery("#form-editor #createFormLink").css("display","block"),jQuery("#form-editor #editFormLink").css("display","none"))},saveEditor:function(){return D.formToObject(this.formName)},isSetFilledAllowed:function(){var e=!1;return 0<jQuery("#formsEditorUserFormId").val()&&(e=!0),e}},p=D.editors.form}),this.addDomInitializer("report-editor-initializer",function(e){D.editors.report={safeToSave:!0,getTitle:function(){return t("report")},createNewReport:function(){D.processForward(constants.forwardReportCreate,"#reportSelector",[],U)},editReport:function(e){jQuery("#forwardTargetItemId").val(e),D.processForward(constants.forwardReportEdit,"#reportSelector",[],U)},fillEditor:function(e){var t=e.data;D.initSelectWithFirstValue(jQuery("#reportSelect")),jQuery("#report-editor .editor-error-messages").css("display","none"),jQuery("#reportSelect").select2("val",t.reports),jQuery("#reportSelect").select2({formatSelection:function(e){return'<a href="#" class="btn-link-light" data-action="report-editor-change" data-config="reportId:'+e.id+'">'+e.text+"</a>"}})},validateEditor:function(){var e=$("#reportSelect").val();if(e&&0<e.length)D.saveCurrentEditor();else{var i=$("#report-editor").find(".editor-error-messages");i.html(t("workflow.report.error.no_report")),i.css("display","block")}},saveEditor:function(){return{reports:jQuery("#reportSelect").val()}},isSetFilledAllowed:function(){var e=!1,t=jQuery("#reportSelect").val();return t&&0<t.length&&(e=!0),e}},f=D.editors.report}),this.addDomInitializer("icon-comment-editor-initializer",function(e){D.editors["icon-comment"]={formName:"iconCommentForm",safeToSave:!0,fillEditor:function(e){var t=e.data;$("#iconComment").val(t.iconComment)},saveEditor:function(){var e=$("#iconComment").val();D.saveIconComment(e),this.cancelEditor()},cancelEditor:function(){return $("#icon-comment-editor").dialog("close"),!1}},N=D.editors["icon-comment"]}),this.addDomInitializer("export-editor-initializer",function(e){var n=e.find("#export-editor-data").json();D.editors.export={formName:"exportForm",safeToSave:!0,getTitle:function(){return t("auto_export")},createNewAutoExport:function(){D.processForward(constants.forwardAutoExportCreate,"form[name='"+this.formName+"'] select[name=importexportId]",[],U)},editAutoExport:function(){var e=jQuery("form[name='"+this.formName+"'] select[name=importexportId]").val();jQuery("#forwardTargetItemId").val(e),D.processForward(constants.forwardAutoExportEdit,"form[name='"+this.formName+"'] select[name=importexportId]",[],U)},fillEditor:function(e){var i=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,i,""),this.addLinks(),jQuery("#export-editor .editor-error-messages").css("display","none"),"true"==n.isDisabled&&(jQuery("#import-editor .editor-error-messages").html(t("error.workflow.autoExportPermission")),jQuery("#import-editor .editor-error-messages").css("display","block"))},validateEditor:function(){var i=$("#export-editor .editor-error-messages"),e=jQuery("form[name='"+this.formName+"'] select[name=importexportId]");0<e.val()?$.ajax({type:"POST",url:constants.workflowURL,data:{method:"validateDependency",workflowId:d.workflowId||0,type:2,entityId:e.val()}}).done(function(e){!0===e.valid?D.saveCurrentEditor():(i.html(t("error.workflow.autoExportInUse")),i.css("display","block"))}).fail(function(){i.html(t("Error")),i.css("display","block")}):(i.html(t("error.workflow.noExport")),i.css("display","block"))},onChange:function(){this.addLinks()},addLinks:function(){0<jQuery("form[name='"+this.formName+"'] select[name=importexportId]").val()?(jQuery("#export-editor #editAutoExportLink").css("display","block"),jQuery("#export-editor #createAutoExportLink").css("display","none")):(jQuery("#export-editor #createAutoExportLink").css("display","block"),jQuery("#export-editor #editAutoExportLink").css("display","none"))},saveEditor:function(){return D.formToObject(this.formName)},isSetFilledAllowed:function(){var e=$("form[name='"+this.formName+"'] select[name=importexportId]"),t=e.find(":selected");return!(0==e.val()||1!=t.data("is-available"))}},g=D.editors.export}),this.addDomInitializer("deadline-editor-initializer",function(e){D.editors.deadline={panelIds:["fixedDeadlinePanel","delayDeadlinePanel"],timeUnitIds:["deadlineTimeUnitMinute","deadlineTimeUnitHour","deadlineTimeUnitDay","deadlineTimeUnitWeek","deadlineTimeUnitMonth"],formName:"deadlineForm",getDefaultDelayData:function(e){var t={};return e===constants.deadlineTypeDelay&&this.isPrecededByImportIcon&&(t={timeUnit:constants.deadlineTimeUnitHour,delayValue:constants.defaultImportDelayLimit}),t},getTitle:function(){return t("workflow.deadline.title")},fillEditor:function(e){var t=e.data;$("#deadline-editor").find(".editor-error-messages").css("display","none"),this.isPrecededByImportIcon=this.checkPrecededByImportIcon(e);var i=$("form[name='"+this.formName+"']");i.submit(!1),$("form[name='"+this.formName+"'] #deadlineDate").pickadate("picker").set("select",this.dateAsUTC(t.date||new Date)),this.fillDelayData(i,t),$("form[name='"+this.formName+"'] #time").val(("0"+t.hour).slice(-2)+":"+("0"+t.minute).slice(-2))},fillDelayData:function(e,t){e.get(0).reset();var i=$("form[name='"+this.formName+"'] input[name='deadlineType']:checked").val(),n=this.getDefaultDelayData(i);D.fillFormFromObject(this.formName,t,"",n),this.updateVisibility();var o=t.delayValue||n.delayValue;D.initSelectWithValueOrChooseFirst($("form[name='"+this.formName+"'] select[name='delayValue']"),o)},saveEditor:function(){var e=D.formToObject(this.formName);e.date=$("form[name='"+this.formName+"'] #deadlineDate").pickadate("picker").get("select").obj;var t=$("form[name='"+this.formName+"'] #time").val();return e.hour=t.substring(0,2),e.minute=t.substring(3,5),e},updateVisibility:function(){var e=$("form[name='"+this.formName+"'] input[name='deadlineType']:checked").val();if(this.checkPresentNodesByTypeList([I.NODE_TYPE_ACTION_BASED_MAILING,I.NODE_TYPE_DATE_BASED_MAILING])?($("form[name='"+this.formName+"'] input#typeFixedDeadline").parent().parent().parent().hide(),$("form[name='"+this.formName+"'] input[value='"+constants.deadlineTypeDelay+"']").prop("checked",!0),e=constants.deadlineTypeDelay):$("form[name='"+this.formName+"'] input#typeFixedDeadline").parent().parent().parent().show(),e===constants.deadlineTypeDelay){switch(this.switchPanelsVisibility("delayDeadlinePanel"),this.switchTimeContainerVisibility(!1),$("form[name='"+this.formName+"'] select[name='timeUnit']").val()){case constants.deadlineTimeUnitMinute:this.switchTimeUnitsVisibility("deadlineTimeUnitMinute");break;case constants.deadlineTimeUnitHour:this.switchTimeUnitsVisibility("deadlineTimeUnitHour");break;case constants.deadlineTimeUnitDay:this.switchTimeUnitsVisibility("deadlineTimeUnitDay"),this.switchTimeContainerVisibility(!0),$("#deadlineTimeHelp").removeAttr("style");break;case constants.deadlineTimeUnitWeek:this.switchTimeUnitsVisibility("deadlineTimeUnitWeek");break;case constants.deadlineTimeUnitMonth:this.switchTimeUnitsVisibility("deadlineTimeUnitMonth")}$("form[name='"+this.formName+"'] input[name='useTime']").css("display","inline")}else e===constants.deadlineTypeFixedDeadline&&(this.switchPanelsVisibility("fixedDeadlinePanel"),this.switchTimeContainerVisibility(!0),this.hideDiv("deadlineTimeHelp"),$("form[name='"+this.formName+"'] input[name='useTime']").css("display","none"))},switchPanelsVisibility:function(t){var i=this;this.panelIds.forEach(function(e){e!==t&&i.hideDiv(e)}),this.showDiv(t)},switchTimeUnitsVisibility:function(t){var i=this;this.timeUnitIds.forEach(function(e){e!==t&&(i.hideDiv(e),$("#"+e+" select").removeAttr("name"))}),this.showDiv(t),$("#"+t+" select").attr("name","delayValue")},switchTimeContainerVisibility:function(e){e?this.showDiv("deadlineTimeContainer"):this.hideDiv("deadlineTimeContainer")},hideAllItems:function(e){var t=this;e.forEach(function(e){t.hideDiv(e)})},validateEditor:function(){var e=!0,i=constants.defaultImportDelayLimit;if(this.isPrecededByImportIcon&&$("form[name='"+this.formName+"'] input[name='deadlineType']:checked").val()===constants.deadlineTypeDelay){var n=$("form[name='"+this.formName+"'] select[name='timeUnit']").val();n===constants.deadlineTimeUnitMinute?e=!1:n===constants.deadlineTimeUnitHour&&$("#deadlineTimeUnitHour select").val()<i&&(e=!1)}if(e)D.saveCurrentEditor();else{var o=$("#deadline-editor").find(".editor-error-messages");o.html(t("error.workflow.deadlineIsTooShortForImport",i)),o.css("display","block")}},onTimeChanged:function(){var e=$("form[name='"+this.formName+"'] input[name='deadlineType']:checked").val(),t=$("form[name='"+this.formName+"'] select[name='timeUnit']").val();e==constants.deadlineTypeDelay&&t==constants.deadlineTimeUnitDay&&$("form[name='"+this.formName+"'] input[name='useTime']").prop("checked",!0)},hideDiv:function(e){$("form[name='"+this.formName+"'] #"+e).css("display","none")},showDiv:function(e){$("form[name='"+this.formName+"'] #"+e).css("display","block")},dateAsUTC:function(e){return e?new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())):null},checkPresentNodesByTypeList:function(e){var t=d.getCMNodes().getNodesByTypeList(e);return t&&0<t.length},checkPrecededByImportIcon:function(e){var i=d.getCMNodes();return d.getNodeIncomingConnections(e).some(function(e){var t=i.getNodeById(e.source);return t&&t.type==I.NODE_TYPE_IMPORT})}},m=D.editors.deadline}),this.addDomInitializer("import-editor-initializer",function(e){var n=e.find("#import-editor-data").json();D.editors.import={formName:"importForm",safeToSave:!0,getTitle:function(){return t("auto_import")},createNewAutoImport:function(){D.processForward(constants.forwardAutoImportCreate,"#importexportId",[],U)},editAutoImport:function(){var e=jQuery("form[name='"+this.formName+"'] select[name=importexportId]").val();jQuery("#forwardTargetItemId").val(e),D.processForward(constants.forwardAutoImportEdit,"form[name='"+this.formName+"'] select[name=importexportId]",[],U)},fillEditor:function(e){var i=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,i,""),this.addLinks(),jQuery("#import-editor .editor-error-messages").css("display","none"),"true"==n.isDisabled&&(jQuery("#import-editor .editor-error-messages").html(t("error.workflow.autoImportPermission")),jQuery("#import-editor .editor-error-messages").css("display","block"))},validateEditor:function(){var i=$("#import-editor .editor-error-messages"),e=jQuery("form[name='"+this.formName+"'] select[name=importexportId]");0<e.val()?$.ajax({type:"POST",url:constants.workflowURL,data:{method:"validateDependency",workflowId:d.workflowId||0,type:3,entityId:e.val()}}).done(function(e){!0===e.valid?D.saveCurrentEditor():(i.html(t("error.workflow.autoImportInUse")),i.css("display","block"))}).fail(function(){i.html(t("Error")),i.css("display","block")}):(i.html(t("error.workflow.noImport")),i.css("display","block"))},onChange:function(){this.addLinks()},addLinks:function(){0<jQuery("form[name='"+this.formName+"'] select[name=importexportId]").val()?(jQuery("#import-editor #editAutoImportLink").css("display","block"),jQuery("#import-editor #createAutoImportLink").css("display","none")):(jQuery("#import-editor #createAutoImportLink").css("display","block"),jQuery("#import-editor #editAutoImportLink").css("display","none"))},saveEditor:function(){return D.formToObject(this.formName)},isSetFilledAllowed:function(){var e=$("form[name='"+this.formName+"'] select[name=importexportId]"),t=e.find(":selected");return!(0==e.val()||1!=t.data("is-available"))}},v=D.editors.import}),this.addDomInitializer("archive-editor-initializer",function(e){D.editors.archive={formName:"archiveForm",safeToSave:!0,getTitle:function(){return t("workflow.mailing.archive")},createNewArchive:function(){D.processForward(constants.forwardArchiveCreate,"#settings_general_campaign",[],U)},fillEditor:function(e){var t=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,t,"")},saveEditor:function(){return D.formToObject(this.formName)}},y=D.editors.archive}),this.addDomInitializer("action-mailing-editor-initializer",function(e){var i=e.find("#action-mailing-editor-data").json();b=new AGN.Lib.WM.MailingEditorBase(i,d,U),D.editors.actionbased_mailing={formName:"actionbasedMailingForm",safeToSave:!1,getTitle:function(){return t("workflow.mailing.action_based")},fillEditor:function(e){var t=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,t,""),b.fillEditorBase(e),jQuery("#actionbased_mailing-editor .editor-error-messages").css("display","none")},createNewMailing:function(){b.createNewMailing(constants.forwardMailingCreate)},editMailing:function(e){b.editMailing(constants.forwardMailingEdit)},saveEditor:function(){return b.setNodeFields(),b.disableInputs(),D.formToObject(this.formName)},saveWithCheckStatus:function(){b.showSecurityQuestion()&&D.saveCurrentEditor(!1,b)},copyMailing:function(){b.copyMailing(constants.forwardMailingCopy)}},w=D.editors.actionbased_mailing}),this.addDomInitializer("date-mailing-initializer",function(e){var i=e.find("#date-mailing-editor-data").json();A=new AGN.Lib.WM.MailingEditorBase(i,d,U),D.editors.datebased_mailing={formName:"datebasedMailingForm",safeToSave:!1,getTitle:function(){return t("workflow.mailing.date_based")},fillEditor:function(e){var t=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,t,""),A.fillEditorBase(e),jQuery("#datebased_mailing-editor .editor-error-messages").css("display","none")},saveEditor:function(){return A.setNodeFields(),A.disableInputs(),D.formToObject(this.formName)},createNewMailing:function(){A.createNewMailing(constants.forwardMailingCreate)},editMailing:function(){A.editMailing(constants.forwardMailingEdit)},saveWithCheckStatus:function(){A.showSecurityQuestion()&&D.saveCurrentEditor(!1,A)},copyMailing:function(){A.copyMailing(constants.forwardMailingCopy)}},C=D.editors.datebased_mailing}),this.addDomInitializer("followup-mailing-editor-initializer",function(e){var i=e.find("#followup-mailing-base-data").json(),n=e.find("#followup-mailing-data").json();i.dropDownEl=jQuery("#followup-m-editor"),E=new AGN.Lib.WM.MailingEditorBase(i,d,U),x=new AGN.Lib.WM.MailingEditorBase(n,d,U),E.selectedFollowUpMailingId=0,E.mailingsInCampaign=[],E.findMailingIconsBefore=function(e){var t,i,n=d.getCMNodes().getNodes(),o=d.getNodeIncomingConnections(e);for("mailing"!==e.type&&"datebased_mailing"!==e.type&&"actionbased_mailing"!==e.type||this.mailingsInCampaign.push(e.data.mailingId),i=0;i<o.length;i++)t=_.findKey(n,function(e){return e.element.id===o[i].source}),this.findMailingIconsBefore(n[t])},E.getMailingsByWorkStatus=function(a,s,l,c){var u=this,d=jQuery(this.formNameJId+" "+this.selectNameJId);this.mailingsInCampaign=[],this.findMailingIconsBefore(this.node);var e=_.uniq(this.mailingsInCampaign).toString();d.attr("readonly","readonly"),jQuery.ajax({type:"POST",url:constants.workflowURL,data:{method:"getMailingsByWorkStatus",mailingTypes:this.mailingTypesForLoading.join(","),status:a,sort:s,order:l,mailingId:this.selectedFollowUpMailingId,parentMailingId:jQuery(this.formNameJId+" "+this.selectNameJId).val(),mailingStatus:"W",takeMailsForPeriod:!0,mailingsInCampaign:e},success:function(e){d.html(""),d.append('<option value="0">'+t("workflow.defaults.no_mailing")+"</option>");for(var i=0;i<e.length;i++){var n=e[i],o="",r="";"mailing.status.sent"!=n.WORK_STATUS&&"mailing.status.norecipients"!=n.WORK_STATUS||(o="style='color: #808080;'"),c==n.MAILING_ID&&(r="selected"),d.append("<option "+o+" value='"+n.MAILING_ID+"' status='"+n.WORK_STATUS+"' senddate='"+n.SENDDATE+"' "+r+">"+n.SHORTNAME+"</option>")}d.removeAttr("readonly"),u.mailingsStatus=a,u.mailingsSort=s,u.mailingsOrder=l,d.val(u.mailingId),D.initSelectWithValueOrChooseFirst(d,u.mailingId)}})},x.onMailingSelectChange=function(e){E.selectedFollowUpMailingId=e,this.setSelectMailingOptions(e)},D.editors.followup_mailing={formName:"followupMailingForm",safeToSave:!1,getTitle:function(){return t("workflow.mailing.followup")},fillEditor:function(e){x.fillEditorBase(e),E.fillEditorBase(e);var i=e.data;jQuery("form[name='"+this.formName+"']").submit(!1),jQuery("form[name='"+this.formName+"']").get(0).reset(),D.fillFormFromObject(this.formName,i,""),jQuery("#followup_mailing-editor .editor-error-messages").css("display","none"),"true"==n.disableFollowup&&(jQuery("#followup_mailing-editor .editor-error-messages").html(t("error.workflow.followupPermission")),jQuery("#followup_mailing-editor .editor-error-messages").css("display","block"),E.disableInputs())},createNewMailing:function(){E.node.data.baseMailingId=E.getSelectedMailingOption().val(),E.node.data.decisionCriterion=E.getSelectedDecisionOption().val(),x.createNewMailing(constants.forwardMailingCreate)},editMailing:function(){x.editMailing(constants.forwardMailingEdit)},copyMailing:function(){E.node.data.baseMailingId=E.getSelectedMailingOption().val(),E.node.data.decisionCriterion=E.getSelectedDecisionOption().val(),x.copyMailing(constants.forwardMailingCopy)},saveEditor:function(){return E.disableInputs(),x.disableInputs(),this.setNodeFields(),D.formToObject(this.formName)},saveWithCheckStatus:function(){x.showSecurityQuestion()&&D.saveCurrentEditor(!1,x)},validateEditor:function(e){var i=jQuery(E.formNameJId+" "+E.selectNameJId),n=jQuery(x.formNameJId+" "+x.selectNameJId);if(0<i.val()&&0<n.val())e?e():D.saveCurrentEditor();else{var o=$("#followup_mailing-editor").find(".editor-error-messages");o.html(t("error.workflow.noMailing")),o.css("display","block")}},setNodeFields:function(){this.setNodeFilled(E,x),this.setNodeIconTitle(E,x)},setNodeFilled:function(e,t){e.node.filled=0<parseInt(e.mailingId,10)&&0<parseInt(t.mailingId,10)},setNodeIconTitle:function(e,t){e.node.iconTitle="",0<parseInt(e.mailingId,10)?0<parseInt(t.mailingId,10)?e.node.iconTitle=e.getSelectedMailingOption().html()+":/"+t.getSelectedMailingOption().html():e.node.iconTitle=e.getSelectedMailingOption().html():e.node.iconTitle=" : "+t.getSelectedMailingOption().html()}},S=D.editors.followup_mailing}),this.addDomInitializer("copy-dialog-initializer",function(e){var i=e.find("#copy-editor-data").json();T={workflowId:{},workflowCopyDialogClose:function(){return jQuery("#workflow-copy-dialog").dialog("close"),!1},workflowCopyDialogResponse:function(e){return jQuery("#workflow-copy-dialog").dialog("close"),window.location=i.url+"&workflowId="+this.workflowId+"&isWithContent="+(e?"true":"false"),!1},showDialog:function(e){this.workflowId=e;var i=!0,n=d.getCMNodes().getNodes();for(var o in n){if(n.hasOwnProperty(o))if(n[o].filled){i=!1;break}}i?(jQuery("#workflow-copy-dialog div.form-group div.col-xs-12 div.well").html(t("workflow.copy.question")),jQuery("#workflowBtnWithContent").hide(),jQuery("#workflowBtnOnlyChain").hide(),jQuery("#workflowBtnCopy").show()):(jQuery("#workflow-copy-dialog div.form-group div.col-xs-12 div.well").html(t("workflow.copy.question_with_content")),jQuery("#workflowBtnCopy").hide(),jQuery("#workflowBtnWithContent").show(),jQuery("#workflowBtnOnlyChain").show()),jQuery("#workflow-copy-dialog").dialog({title:'<span class="dialog-fat-title">'+t("workflow.ownWorkflow.copy_title")+"</span>",dialogClass:"no-close",width:650,modal:!0,resizable:!1})}}}),this.addDomInitializer("save-before-pdf-initializer",function(){k={submitDialog:function(e){return e&&U(!0),jQuery("#workflow-save-before-pdf-dialog").dialog("close"),!1},showDialog:function(e,i){var n="";e?n=t("workflow.pdf.save_new_campaign"):i&&(n=t("workflow.pdf.save_modified_campaign")),jQuery("#workflow-save-before-pdf-dialog").find(".well").html(n),jQuery("#workflow-save-before-pdf-dialog").dialog({title:'<span class="dialog-fat-title">'+t("workflow.pdf.save_campaign")+"</span>",dialogClass:"no-close",width:650,modal:!0,resizable:!1})}}}),this.addDomInitializer("open-edit-icon-initializer",function(e){var t=e.json(),i=t.nodeId;if(i){var n=d.getCampaignManagerNodes();n.setOpenNode(i,t.elementValue),n.openNodeIcon()}}),this.addDomInitializer("testing-dialog-initializer",function(e){var i={},n=e.data("config"),o=AGN.Lib.Helpers.objFromString(n),r=function(){};i={showDialog:function(e){e instanceof Function&&(r=e),jQuery("#workflow-testing-dialog").dialog({title:'<span class="dialog-fat-title">'+t("workflow.single")+":&nbsp;"+o.shortname+"</span>",dialogClass:"no-close",width:650,modal:!0,resizable:!1})},closeDialog:function(){return $("#workflow-testing-dialog").dialog("close"),!1},acceptDialog:function(){$("#workflow-testing-dialog").dialog("close"),r(i)}},a.workflowTestingDialogHandler=i}),this.addAction({click:"workflowTestingDialogSubmitButton"},function(){a.workflowTestingDialogHandler.acceptDialog()}),this.addAction({click:"workflowTestingDialogCancelButton"},function(){a.workflowTestingDialogHandler.closeDialog()}),this.addAction({click:"workflowTestBtn"},function(){a.workflowTestingDialogHandler.showDialog(function(){var e=$("input#workflow_active"),t=e.prop("disabled");e.prop("disabled",!0),V(!0),e.prop("disabled",t)})}),this.addAction({click:"editor-save"},function(){return D.saveCurrentEditor(),!1}),this.addAction({click:"mailing-editor-save"},function(){return h.validateEditor(l.saveWithCheckStatus),!1}),this.addAction({click:"mailing-editor-base-no"},function(){return h.transferRequiredMailingData(),!1}),this.addAction({click:"mailing-editor-base-transfer-data"},function(){return h.transferMailingData(),!1}),this.addAction({click:"mailing-editor-base-close"},function(){return h.closeOneMailinglistWarningDialog(),!1}),this.addAction({click:"mailing-editor-base-accept"},function(){return h.acceptOneMailinglistPerCampaign(),!1}),this.addAction({click:"mailing-editor-base-sort-shortname"},function(){return h.onMailingSortClick("shortname","shortname",D),!1}),this.addAction({click:"mailing-editor-base-sort-data"},function(){var e=W(this.el);return h.onMailingSortClick("shortname",e.sortByDate,D),!1}),this.addAction({change:"mailing-editor-base-status-change"},function(){return h.onMailingsStatusChange(this.el.val()),!1}),this.addAction({change:"mailing-editor-base-select-change"},function(){return h.onMailingSelectChange(this.el.val()),!1}),this.addAction({click:"mailing-editor-base-secure-cancel"},function(){return h.cancelSecurityDialog(),!1}),this.addAction({click:"mailing-editor-copy"},function(){return D.curEditor.copyMailing(),!1}),this.addAction({click:"mailing-editor-new"},function(){return D.curEditor.createNewMailing(),!1}),this.addAction({click:"mailing-editor-edit"},function(){return D.curEditor.editMailing(),!1}),this.addAction({click:"mailing-editor-base-toggle-settings"},function(){var e=W(this.el);return h.toggleSendSettings(e.editorId),!1}),this.addAction({change:"form-editor-change"},function(){return p.onChange(),!1}),this.addAction({click:"form-editor-new"},function(){return p.createNewUserForm(),!1}),this.addAction({click:"form-editor-form-edit"},function(){return p.editForm(),!1}),this.addAction({click:"form-editor-save"},function(){return p.validateEditor(),!1}),this.addAction({click:"report-editor-change"},function(){var e=W(this.el);return f.editReport(e.reportId),!1}),this.addAction({click:"report-editor-new"},function(){return f.createNewReport(),!1}),this.addAction({click:"report-editor-save"},function(){return f.validateEditor(),!1}),this.addAction({change:"export-editor-change"},function(){return g.onChange(),!1}),this.addAction({click:"export-editor-new"},function(){return g.createNewAutoExport(),!1}),this.addAction({click:"export-editor-autoexport"},function(){return g.editAutoExport(),!1}),this.addAction({click:"export-editor-save"},function(){return g.validateEditor(),!1}),this.addAction({change:"deadline-editor-update"},function(){return m.updateVisibility(),!1}),this.addAction({change:"deadline-editor-time-change"},function(){return m.onTimeChanged(),!1}),this.addAction({click:"editor-cancel"},function(){return D.cancelEditor(),!1}),this.addAction({change:"import-editor-change"},function(){return v.onChange(),!1}),this.addAction({click:"import-editor-new"},function(){return v.createNewAutoImport(),!1}),this.addAction({click:"import-editor-update"},function(){return v.editAutoImport(),!1}),this.addAction({click:"import-editor-save"},function(){return v.validateEditor(),!1}),this.addAction({click:"icon-comment-editor-save"},function(){return N.saveEditor(),!1}),this.addAction({click:"icon-comment-editor-cancel"},function(){return N.cancelEditor(),!1}),this.addAction({click:"archive-editor-new"},function(){return y.createNewArchive(),!1}),this.addAction({click:"action-mailing-editor-save"},function(){return b.validateEditor(w.saveWithCheckStatus),!1}),this.addAction({click:"action-mailing-editor-base-sort-shortname"},function(){return b.onMailingSortClick("shortname","shortname",D),!1}),this.addAction({click:"action-mailing-editor-base-sort-data"},function(){var e=W(this.el);return b.onMailingSortClick("shortname",e.sortByDate,D),!1}),this.addAction({change:"action-mailing-editor-base-status-change"},function(){return b.onMailingsStatusChange(this.el.val()),!1}),this.addAction({change:"action-mailing-editor-base-select-change"},function(){return b.onMailingSelectChange(this.el.val()),!1}),this.addAction({click:"action-mailing-editor-base-no"},function(){return b.transferRequiredMailingData(),!1}),this.addAction({click:"action-mailing-editor-base-secure-cancel"},function(){return b.cancelSecurityDialog(),!1}),this.addAction({click:"action-mailing-editor-base-transfer-data"},function(){return b.transferMailingData(),!1}),this.addAction({click:"date-mailing-editor-base-sort-shortname"},function(){return A.onMailingSortClick("shortname","shortname",D),!1}),this.addAction({click:"date-mailing-editor-base-sort-data"},function(){var e=W(this.el);return A.onMailingSortClick("shortname",e.sortByDate,D),!1}),this.addAction({change:"date-mailing-editor-base-status-change"},function(){return A.onMailingsStatusChange(this.el.val()),!1}),this.addAction({change:"date-mailing-editor-base-select-change"},function(){return A.onMailingSelectChange(this.el.val()),!1}),this.addAction({click:"date-mailing-editor-base-no"},function(){return A.transferRequiredMailingData(),!1}),this.addAction({click:"date-mailing-editor-base-transfer-data"},function(){return A.transferMailingData(),!1}),this.addAction({click:"followup-mailing-editor-base-sort-shortname"},function(){return x.onMailingSortClick("shortname","shortname",D),!1}),this.addAction({click:"followup-mailing-editor-base-sort-data"},function(){var e=W(this.el);return x.onMailingSortClick("shortname",e.sortByDate,D),!1}),this.addAction({change:"followup-mailing-editor-base-status-change"},function(){return x.onMailingsStatusChange(this.el.val()),!1}),this.addAction({change:"followup-mailing-editor-base-select-change"},function(){return x.onMailingSelectChange(this.el.val()),!1}),this.addAction({click:"followup-base-mailing-editor-base-sort-shortname"},function(){return E.onMailingSortClick("shortname","shortname"),!1}),this.addAction({click:"followup-base-mailing-editor-base-sort-data"},function(){var e=W(this.el);return E.onMailingSortClick("shortname",e.sortByDate),!1}),this.addAction({change:"followup-base-mailing-editor-base-status-change"},function(){return E.onMailingsStatusChange(this.el.val()),!1}),this.addAction({change:"followup-base-mailing-editor-base-select-change"},function(){return E.onMailingSelectChange(this.el.val()),!1}),this.addAction({click:"followup-base-mailing-editor-base-no"},function(){return E.transferRequiredMailingData(),!1}),this.addAction({click:"followup-base-mailing-editor-base-transfer-data"},function(){return E.transferMailingData(),!1}),this.addAction({click:"save-before-pdf-btn-save"},function(){return k.submitDialog(!0),!1}),this.addAction({click:"save-before-pdf-btn-cancel"},function(){return k.submitDialog(!1),!1}),this.addAction({click:"workflowSaveBtn"},function(){U(!0)}),this.addAction({click:"workflowSaveBtnModal"},function(){U(!0)}),this.addAction({click:"campaignEditorEnlarge"},function(){$("#modalCampaignEditorContainer").append($("#campaignEditorBody")),z()}),F.new({click:"[data-close-campaign-editor-modal]"},function(){$("#pageCampaignEditorContainer").append($("#campaignEditorBody")),z()}),this.addAction({change:"workflow-view-change-status"},function(){$("#workflow_active").is(":checked")?$("#workflow-status").val(constants.statusActive):$("#workflow-status").val(constants.statusInactive)}),this.addAction({click:"workflowCopyBtn"},function(){T.showDialog(a.workflowId)}),this.addAction({click:"workflowStatsBtn"},function(){!function(e,i){"true"===a.isStatusOpen?workflownoStatisticsDialogHandler.showDialog():(r.toggleStatistics(e),function(e){var i=t("workflow.fade_in_statistics"),n=t("workflow.fade_out_statistics"),o=e.html();o=r.statisticsVisible?o.replace(i,n):o.replace(n,i);e.html(o)}(i))}(a.workflowId,this.el)}),this.addAction({change:"start-editor-execution-changed"},function(){s.onExecutionChanged()}),this.addAction({change:"start-editor-event-changed"},function(){s.onStartEventChanged()}),this.addAction({change:"start-editor-type-changed"},function(){s.onStartTypeChanged()}),this.addAction({change:"start-editor-rule-changed"},function(){s.onRuleModeChanged()}),this.addAction({change:"start-editor-reaction-changed"},function(){s.onReactionChanged()}),this.addAction({change:"start-editor-profile-field-changed"},function(){return s.onProfileFieldChanged(),!1}),this.addAction({click:"start-editor-add-rule"},function(){return s.addRule(),!1}),this.addAction({click:"start-editor-reminder-changed"},function(){s.onReminderChanged()}),this.addAction({click:"start-editor-schedule-reminder-date-changed"},function(){s.onScheduleReminderDateChanged()}),this.addAction({click:"start-editor-validate"},function(){return s.validateEditor(),!1}),this.addAction({click:"start-editor-mailing-sort-date"},function(){return c.onMailingSortClick("date"),!1}),this.addAction({change:"start-editor-mailing-select"},function(){return s.onMailingSelectChange(this.el.val()),!1}),this.addAction({click:"start-editor-mailing-sort-shortname"},function(){return c.onMailingSortClick("shortname"),!1}),this.addAction({click:"decision-editor-mailing-sort-shortname"},function(){return u.onMailingSortClick("shortname"),!1}),this.addAction({click:"decision-editor-mailing-sort-date"},function(){return u.onMailingSortClick("date"),!1}),this.addAction({change:"decision-editor-mailing-select"},function(){return i.onMailingSelectChange(this.el.val()),!1}),this.addAction({click:"start-editor-rule-remove"},function(){return s.removeRuleRow(this.el.data("rule-index")),!1}),this.addAction({change:"start-rule-operator-change"},function(){return s.onRuleOperatorChanged(this.el),!1}),this.addAction({change:"decision-rule-operator-change"},function(){return i.onRuleOperatorChanged(this.el),!1}),this.addAction({click:"decision-editor-rule-remove"},function(){return i.removeRuleRow(this.el.data("rule-index")),!1}),this.addAction({click:"decision-editor-rule-add"},function(){return i.addRule(),!1}),this.addAction({change:"decision-editor-type-change"},function(){i.onTypeChanged()}),this.addAction({change:"decision-editor-criteria-change"},function(){return i.onCriteriaChanged(),!1}),this.addAction({change:"decision-editor-reaction-change"},function(){return i.onDecisionReactionChanged(),!1}),this.addAction({click:"decision-editor-save"},function(){return i.validateEditor(),!1}),this.addAction({change:"decision-editor-profile-field-change"},function(){return i.onProfileFieldChanged(),!1}),this.addAction({click:"recipient-editor-create-new-target"},function(){return n.createNewTarget(),!1}),this.addAction({click:"recipient-editor-save"},function(){return D.saveCurrentEditor(),!1}),this.addAction({click:"recipient-editor-target-edit"},function(){var e=W(this.el);return n.editTarget(e.targetId),!1}),this.addAction({click:"parameter-editor-save"},function(){return D.saveCurrentEditor(),!1}),this.addAction({click:"ownworkflow-copy-dialog"},function(){var e=W(this.el);return o.ownWorkflowCopyDialogResponse(e.useOriginal),!1}),this.addAction({click:"ownworkflow-editor-cancel"},function(){return e.cancelEditor(),!1}),this.addAction({click:"ownworkflow-editor-save"},function(){return e.saveWithCheck(),!1}),this.addAction({click:"editor-save-current"},function(){return D.saveCurrentEditor(),!1}),this.addAction({click:"deadline-editor-save"},function(){return m.validateEditor(),!1}),this.addAction({click:"date-mailing-editor-save"},function(){return A.validateEditor(C.saveWithCheckStatus),!1}),this.addAction({click:"followup-mailing-editor-save"},function(){return S.validateEditor(S.saveWithCheckStatus),!1}),this.addAction({click:"copy-dialog-copy"},function(){return T.workflowCopyDialogResponse(!0),!1}),this.addAction({click:"copy-dialog-chain-copy"},function(){return T.workflowCopyDialogResponse(!1),!1}),this.addAction({click:"copy-dialog-cancel"},function(){return T.workflowCopyDialogClose(),!1}),this.addAction({click:"workflow-generate-pdf"},function(){return function(){var e=!0;0!==a.workflowId&&""!==a.shotrName&&(e=!1);var t=d.canUndo();e||t?k.showDialog(e,t):(window.location.href=a.pdfGenerationUrl+"&workflowId="+a.workflowId+"&showStatistics="+r.statisticsVisible,AGN.Lib.Loader.hide())}(),!1}),H.prototype.setup=function(e){this.startTypeOpen=e.startTypeOpen,this.startTypeDate=e.startTypeDate,this.startTypeEvent=e.startTypeEvent,this.startEventReaction=e.startEventReaction,this.startEventDate=e.startEventDate,this.endTypeAutomatic=e.endTypeAutomatic,this.endTypeDate=e.endTypeDate,this.deadlineTypeDelay=e.deadlineTypeDelay,this.deadlineTypeFixedDeadline=e.deadlineTypeFixedDeadline,this.deadlineTimeUnitMinute=e.deadlineTimeUnitMinute,this.deadlineTimeUnitHour=e.deadlineTimeUnitHour,this.deadlineTimeUnitDay=e.deadlineTimeUnitDay,this.deadlineTimeUnitWeek=e.deadlineTimeUnitWeek,this.deadlineTimeUnitMonth=e.deadlineTimeUnitMonth,this.reactionOpened=e.reactionOpened,this.reactionNotOpened=e.reactionNotOpened,this.reactionClicked=e.reactionClicked,this.reactionNotClicked=e.reactionNotClicked,this.reactionBought=e.reactionBought,this.reactionNotBought=e.reactionNotBought,this.reactionDownload=e.reactionDownload,this.reactionChangeOfProfile=e.reactionChangeOfProfile,this.reactionWaitingForConfirm=e.reactionWaitingForConfirm,this.reactionOptIn=e.reactionOptIn,this.reactionOptOut=e.reactionOptOut,this.reactionClickedLink=e.reactionClickedLink,this.reactionOpenedAndClicked=e.reactionOpenedAndClicked,this.reactionOpenedOrClicked=e.reactionOpenedOrClicked,this.reactionConfirmedOptIn=e.reactionConfirmedOptIn,constants.reactionRegistry(),this.decisionTypeDecision=e.decisionTypeDecision,this.decisionTypeAutoOptimization=e.decisionTypeAutoOptimization,this.decisionReaction=e.decisionReaction,this.decisionProfileField=e.decisionProfileField,this.decisionAOCriteriaClickRate=e.decisionAOCriteriaClickRate,this.decisionAOCriteriaOpenrate=e.decisionAOCriteriaOpenrate,this.decisionAOCriteriaTurnover=e.decisionAOCriteriaTurnover,this.chainOperatorAnd=e.chainOperatorAnd,this.chainOperatorOr=e.chainOperatorOr,this.operatorIs=e.operatorIs,this.forwardTargetGroupCreate=e.forwardTargetGroupCreate,this.forwardTargetGroupEdit=e.forwardTargetGroupEdit,this.forwardMailingCreate=e.forwardMailingCreate,this.forwardMailingEdit=e.forwardMailingEdit,this.forwardMailingCopy=e.forwardMailingCopy,this.forwardUserFormCreate=e.forwardUserFormCreate,this.forwardUserFormEdit=e.forwardUserFormEdit,this.forwardReportCreate=e.forwardReportCreate,this.forwardReportEdit=e.forwardReportEdit,this.forwardAutoExportCreate=e.forwardAutoExportCreate,this.forwardAutoExportEdit=e.forwardAutoExportEdit,this.forwardAutoImportCreate=e.forwardAutoImportCreate,this.forwardAutoImportEdit=e.forwardAutoImportEdit,this.forwardArchiveCreate=e.forwardArchiveCreate,this.genderOptions=e.genderOptions,this.chainOperatorOptions=e.chainOperatorOptions,this.operators=e.operators,this.operatorsMap=e.operatorsMap,this.statusActive=e.statusActive,this.statusInactive=e.statusInactive,this.defaultImportDelayLimit=e.defaultImportDelayLimit,this.workflowURL=e.workflowURL,this.componentURL=e.componentURL},H.prototype.reactionRegistry=function(){I.reactionRegistry[constants.reactionOpened]={image:"reaction_opened.png",name:t("workflow.reaction.opened")},I.reactionRegistry[constants.reactionNotOpened]={image:"reaction_notopened.png",name:t("workflow.reaction.not_opened")},I.reactionRegistry[constants.reactionClicked]={image:"reaction_clicked.png",name:t("workflow.reaction.clicked")},I.reactionRegistry[constants.reactionNotClicked]={image:"reaction_notclicked.png",name:t("workflow.reaction.not_clicked")},I.reactionRegistry[constants.reactionBought]={image:"reaction_bought.png",name:t("workflow.reaction.bought")},I.reactionRegistry[constants.reactionNotBought]={image:"reaction_notbought.png",name:t("workflow.reaction.not_bought")},I.reactionRegistry[constants.reactionChangeOfProfile]={image:"reaction_profilechange.png",name:t("workflow.reaction.change_of_profile")},I.reactionRegistry[constants.reactionWaitingForConfirm]={image:"reaction_wfc.png",name:t("workflow.reaction.waiting_for_confirm")},I.reactionRegistry[constants.reactionOptIn]={image:"reaction_optin.png",name:t("workflow.reaction.opt_in")},I.reactionRegistry[constants.reactionOptOut]={image:"reaction_optout.png",name:t("workflow.reaction.opt_out")},I.reactionRegistry[constants.reactionClickedLink]={image:"reaction_clicked.png",name:t("workflow.reaction.clicked_on_link")},I.reactionRegistry[constants.reactionOpenedAndClicked]={image:"reaction_profilechange.png",name:t("workflow.reaction.opened_and_clicked")},I.reactionRegistry[constants.reactionOpenedOrClicked]={image:"reaction_profilechange.png",name:t("workflow.reaction.opened_or_clicked")}}}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).interact=e()}}(function(){return function r(a,s,l){function c(i,e){if(!s[i]){if(!a[i]){var t="function"==typeof require&&require;if(!e&&t)return t(i,!0);if(u)return u(i,!0);var n=new Error("Cannot find module '"+i+"'");throw n.code="MODULE_NOT_FOUND",n}var o=s[i]={exports:{}};a[i][0].call(o.exports,function(e){var t=a[i][1][e];return c(t||e)},o,o.exports,r,a,s,l)}return s[i].exports}for(var u="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(t,e,i){"use strict";"undefined"==typeof window?e.exports=function(e){return t("./src/utils/window").init(e),t("./src/index")}:e.exports=t("./src/index")},{"./src/index":19,"./src/utils/window":52}],2:[function(e,t,i){"use strict";var n=e("./utils/extend.js");function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];if(e.immediatePropagationStopped)break;n(e)}}var r=(a.prototype.fire=function(e){var t=void 0,i="on"+e.type,n=this.global;(t=this[e.type])&&o(e,t),this[i]&&this[i](e),!e.propagationStopped&&n&&(t=n[e.type])&&o(e,t)},a.prototype.on=function(e,t){this[e]?this[e].push(t):this[e]=[t]},a.prototype.off=function(e,t){var i=this[e],n=i?i.indexOf(t):-1;-1!==n&&i.splice(n,1),(i&&0===i.length||!t)&&(this[e]=void 0)},a);function a(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.options=n({},e||{})}t.exports=r},{"./utils/extend.js":41}],3:[function(e,t,i){"use strict";var v=e("./utils/extend"),y=e("./utils/getOriginXY"),b=e("./defaultOptions"),w=e("./utils/Signals").new(),n=(C.prototype.getSwipe=function(){var e=this.interaction;if(e.prevEvent.speed<600||150<this.timeStamp-e.prevEvent.timeStamp)return null;var t=180*Math.atan2(e.prevEvent.velocityY,e.prevEvent.velocityX)/Math.PI;t<0&&(t+=360);var i=112.5<=t&&t<247.5,n=202.5<=t&&t<337.5;return{up:n,down:!n&&22.5<=t&&t<157.5,left:i,right:!i&&(292.5<=t||t<67.5),angle:t,speed:e.prevEvent.speed,velocity:{x:e.prevEvent.velocityX,y:e.prevEvent.velocityY}}},C.prototype.preventDefault=function(){},C.prototype.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},C.prototype.stopPropagation=function(){this.propagationStopped=!0},C);function C(e,t,i,n,o,r){var a=6<arguments.length&&void 0!==arguments[6]&&arguments[6];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,C);var s=e.target,l=(s&&s.options||b).deltaSource,c=y(s,o,i),u="start"===n,d="end"===n,h=u?e.startCoords:e.curCoords,p=e.prevEvent;o=o||e.element;var f=v({},h.page),g=v({},h.client);f.x-=c.x,f.y-=c.y,g.x-=c.x,g.y-=c.y,this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.button=t.button,this.buttons=t.buttons,this.target=o,this.currentTarget=o,this.relatedTarget=r||null,this.preEnd=a,this.type=i+(n||""),this.interaction=e,this.interactable=s,this.t0=u?e.downTimes[e.downTimes.length-1]:p.t0;var m={interaction:e,event:t,action:i,phase:n,element:o,related:r,page:f,client:g,coords:h,starting:u,ending:d,deltaSource:l,iEvent:this};w.fire("set-xy",m),d?(this.pageX=p.pageX,this.pageY=p.pageY,this.clientX=p.clientX,this.clientY=p.clientY):(this.pageX=f.x,this.pageY=f.y,this.clientX=g.x,this.clientY=g.y),this.x0=e.startCoords.page.x-c.x,this.y0=e.startCoords.page.y-c.y,this.clientX0=e.startCoords.client.x-c.x,this.clientY0=e.startCoords.client.y-c.y,w.fire("set-delta",m),this.timeStamp=h.timeStamp,this.dt=e.pointerDelta.timeStamp,this.duration=this.timeStamp-this.t0,this.speed=e.pointerDelta[l].speed,this.velocityX=e.pointerDelta[l].vx,this.velocityY=e.pointerDelta[l].vy,this.swipe=d||"inertiastart"===n?this.getSwipe():null,w.fire("new",m)}w.on("set-delta",function(e){var t=e.iEvent,i=e.interaction,n=e.starting,o=e.deltaSource,r=n?t:i.prevEvent;"client"===o?(t.dx=t.clientX-r.clientX,t.dy=t.clientY-r.clientY):(t.dx=t.pageX-r.pageX,t.dy=t.pageY-r.pageY)}),n.signals=w,t.exports=n},{"./defaultOptions":18,"./utils/Signals":34,"./utils/extend":41,"./utils/getOriginXY":42}],4:[function(e,t,i){"use strict";var a=e("./utils/clone"),s=e("./utils/is"),o=e("./utils/events"),n=e("./utils/extend"),l=e("./actions/base"),r=e("./scope"),c=e("./Eventable"),u=e("./defaultOptions"),d=e("./utils/Signals").new(),h=e("./utils/domUtils"),p=h.getElementRect,f=h.nodeContains,g=h.trySelector,m=h.matchesSelector,v=e("./utils/window").getWindow,y=e("./utils/arr").contains,b=e("./utils/browser").wheelEvent;r.interactables=[];var w=(C.prototype.setOnEvents=function(e,t){var i="on"+e;return s.function(t.onstart)&&(this.events[i+"start"]=t.onstart),s.function(t.onmove)&&(this.events[i+"move"]=t.onmove),s.function(t.onend)&&(this.events[i+"end"]=t.onend),s.function(t.oninertiastart)&&(this.events[i+"inertiastart"]=t.oninertiastart),this},C.prototype.setPerAction=function(e,t){for(var i in t)i in u[e]&&(s.object(t[i])?(this.options[e][i]=a(this.options[e][i]||{}),n(this.options[e][i],t[i]),s.object(u.perAction[i])&&"enabled"in u.perAction[i]&&(this.options[e][i].enabled=!1!==t[i].enabled)):s.bool(t[i])&&s.object(u.perAction[i])?this.options[e][i].enabled=t[i]:void 0!==t[i]&&(this.options[e][i]=t[i]))},C.prototype.getRect=function(e){return e=e||this.target,s.string(this.target)&&!s.element(e)&&(e=this._context.querySelector(this.target)),p(e)},C.prototype.rectChecker=function(e){return s.function(e)?(this.getRect=e,this):null===e?(delete this.options.getRect,this):this.getRect},C.prototype._backCompatOption=function(e,t){if(g(t)||s.object(t)){this.options[e]=t;for(var i=0;i<l.names.length;i++){var n=l.names[i];this.options[n][e]=t}return this}return this.options[e]},C.prototype.origin=function(e){return this._backCompatOption("origin",e)},C.prototype.deltaSource=function(e){return"page"===e||"client"===e?(this.options.deltaSource=e,this):this.options.deltaSource},C.prototype.context=function(){return this._context},C.prototype.inContext=function(e){return this._context===e.ownerDocument||f(this._context,e)},C.prototype.fire=function(e){return this.events.fire(e),this},C.prototype._onOffMultiple=function(e,t,i,n){if(s.string(t)&&-1!==t.search(" ")&&(t=t.trim().split(/ +/)),s.array(t)){for(var o=0;o<t.length;o++){var r=t[o];this[e](r,i,n)}return!0}if(s.object(t)){for(var a in t)this[e](a,t[a],i);return!0}},C.prototype.on=function(e,t,i){return this._onOffMultiple("on",e,t,i)||("wheel"===e&&(e=b),y(C.eventTypes,e)?this.events.on(e,t):s.string(this.target)?o.addDelegate(this.target,this._context,e,t,i):o.add(this.target,e,t,i)),this},C.prototype.off=function(e,t,i){return this._onOffMultiple("off",e,t,i)||("wheel"===e&&(e=b),y(C.eventTypes,e)?this.events.off(e,t):s.string(this.target)?o.removeDelegate(this.target,this._context,e,t,i):o.remove(this.target,e,t,i)),this},C.prototype.set=function(e){s.object(e)||(e={}),this.options=a(u.base);var t=a(u.perAction);for(var i in l.methodDict){var n=l.methodDict[i];this.options[i]=a(u[i]),this.setPerAction(i,t),this[n](e[i])}for(var o=0;o<C.settingsMethods.length;o++){var r=C.settingsMethods[o];this.options[r]=u.base[r],r in e&&this[r](e[r])}return d.fire("set",{options:e,interactable:this}),this},C.prototype.unset=function(){if(o.remove(this.target,"all"),s.string(this.target))for(var e in o.delegatedEvents){var t=o.delegatedEvents[e];t.selectors[0]===this.target&&t.contexts[0]===this._context&&(t.selectors.splice(0,1),t.contexts.splice(0,1),t.listeners.splice(0,1),t.selectors.length||(t[e]=null)),o.remove(this._context,e,o.delegateListener),o.remove(this._context,e,o.delegateUseCapture,!0)}else o.remove(this,"all");d.fire("unset",{interactable:this}),r.interactables.splice(r.interactables.indexOf(this),1);for(var i=0;i<(r.interactions||[]).length;i++){var n=(r.interactions||[])[i];n.target===this&&n.interacting()&&!n._ending&&n.stop()}return r.interact},C);function C(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,C),t=t||{},this.target=e,this.events=new c,this._context=t.context||r.document,this._win=v(g(e)?this._context:e),this._doc=this._win.document,d.fire("new",{target:e,options:t,interactable:this,win:this._win}),r.addDocument(this._doc,this._win),r.interactables.push(this),this.set(t)}r.interactables.indexOfElement=function(e,t){t=t||r.document;for(var i=0;i<this.length;i++){var n=this[i];if(n.target===e&&n._context===t)return i}return-1},r.interactables.get=function(e,t,i){var n=this[this.indexOfElement(e,t&&t.context)];return n&&(s.string(e)||i||n.inContext(e))?n:null},r.interactables.forEachMatch=function(e,t){for(var i=0;i<this.length;i++){var n=this[i],o=void 0;if((s.string(n.target)?s.element(e)&&m(e,n.target):e===n.target)&&n.inContext(e)&&(o=t(n)),void 0!==o)return o}},w.eventTypes=r.eventTypes=[],w.signals=d,w.settingsMethods=["deltaSource","origin","preventDefault","rectChecker"],t.exports=w},{"./Eventable":2,"./actions/base":6,"./defaultOptions":18,"./scope":33,"./utils/Signals":34,"./utils/arr":35,"./utils/browser":36,"./utils/clone":37,"./utils/domUtils":39,"./utils/events":40,"./utils/extend":41,"./utils/is":46,"./utils/window":52}],5:[function(e,t,i){"use strict";var v=e("./scope"),y=e("./utils"),a=e("./utils/events"),b=e("./utils/browser"),n=e("./utils/domObjects"),w=e("./utils/interactionFinder"),s=e("./utils/Signals").new(),o={},r=["pointerDown","pointerMove","pointerUp","updatePointer","removePointer"],C=0;v.interactions=[];var _=(l.prototype.pointerDown=function(e,t,i){var n=this.updatePointer(e,t,!0);s.fire("down",{pointer:e,event:t,eventTarget:i,pointerIndex:n,interaction:this})},l.prototype.start=function(e,t,i){this.interacting()||!this.pointerIsDown||this.pointerIds.length<("gesture"===e.name?2:1)||(-1===v.interactions.indexOf(this)&&v.interactions.push(this),y.copyAction(this.prepared,e),this.target=t,this.element=i,s.fire("action-start",{interaction:this,event:this.downEvent}))},l.prototype.pointerMove=function(e,t,i){this.simulation||(this.updatePointer(e),y.setCoords(this.curCoords,this.pointers));var n=this.curCoords.page.x===this.prevCoords.page.x&&this.curCoords.page.y===this.prevCoords.page.y&&this.curCoords.client.x===this.prevCoords.client.x&&this.curCoords.client.y===this.prevCoords.client.y,o=void 0,r=void 0;this.pointerIsDown&&!this.pointerWasMoved&&(o=this.curCoords.client.x-this.startCoords.client.x,r=this.curCoords.client.y-this.startCoords.client.y,this.pointerWasMoved=y.hypot(o,r)>l.pointerMoveTolerance);var a={pointer:e,pointerIndex:this.getPointerIndex(e),event:t,eventTarget:i,dx:o,dy:r,duplicate:n,interaction:this,interactingBeforeMove:this.interacting()};n||y.setCoordDeltas(this.pointerDelta,this.prevCoords,this.curCoords),s.fire("move",a),n||(this.interacting()&&this.doMove(a),this.pointerWasMoved&&y.copyCoords(this.prevCoords,this.curCoords))},l.prototype.doMove=function(e){e=y.extend({pointer:this.pointers[0],event:this.prevEvent,eventTarget:this._eventTarget,interaction:this},e||{}),s.fire("before-action-move",e),this._dontFireMove||s.fire("action-move",e),this._dontFireMove=!1},l.prototype.pointerUp=function(e,t,i,n){var o=this.getPointerIndex(e);s.fire(/cancel$/i.test(t.type)?"cancel":"up",{pointer:e,pointerIndex:o,event:t,eventTarget:i,curEventTarget:n,interaction:this}),this.simulation||this.end(t),this.pointerIsDown=!1,this.removePointer(e,t)},l.prototype.end=function(e){this._ending=!0,e=e||this.prevEvent,this.interacting()&&s.fire("action-end",{event:e,interaction:this}),this.stop(),this._ending=!1},l.prototype.currentAction=function(){return this._interacting?this.prepared.name:null},l.prototype.interacting=function(){return this._interacting},l.prototype.stop=function(){s.fire("stop",{interaction:this}),this._interacting&&(s.fire("stop-active",{interaction:this}),s.fire("stop-"+this.prepared.name,{interaction:this})),this.target=this.element=null,this._interacting=!1,this.prepared.name=this.prevEvent=null},l.prototype.getPointerIndex=function(e){return"mouse"===this.pointerType||"pen"===this.pointerType?0:this.pointerIds.indexOf(y.getPointerId(e))},l.prototype.updatePointer=function(e,t,i){var n=2<arguments.length&&void 0!==i?i:t&&/(down|start)$/i.test(t.type),o=y.getPointerId(e),r=this.getPointerIndex(e);return-1===r&&(r=this.pointerIds.length,this.pointerIds[r]=o),n&&s.fire("update-pointer-down",{pointer:e,event:t,down:n,pointerId:o,pointerIndex:r,interaction:this}),this.pointers[r]=e,r},l.prototype.removePointer=function(e,t){var i=this.getPointerIndex(e);-1!==i&&(s.fire("remove-pointer",{pointer:e,event:t,pointerIndex:i,interaction:this}),this.pointers.splice(i,1),this.pointerIds.splice(i,1),this.downTargets.splice(i,1),this.downTimes.splice(i,1))},l.prototype._updateEventTargets=function(e,t){this._eventTarget=e,this._curEventTarget=t},l);function l(e){var t=e.pointerType;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),this.target=null,this.element=null,this.prepared={name:null,axis:null,edges:null},this.pointers=[],this.pointerIds=[],this.downTargets=[],this.downTimes=[],this.prevCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},this.curCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},this.startCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},this.pointerDelta={page:{x:0,y:0,vx:0,vy:0,speed:0},client:{x:0,y:0,vx:0,vy:0,speed:0},timeStamp:0},this.downEvent=null,this.downPointer={},this._eventTarget=null,this._curEventTarget=null,this.prevEvent=null,this.pointerIsDown=!1,this.pointerWasMoved=!1,this._interacting=!1,this._ending=!1,this.pointerType=t,s.fire("new",this),v.interactions.push(this)}for(var c=0;c<r.length;c++){var u=r[c];o[u]=d(u)}function d(m){return function(e){var t=y.getPointerType(e),i=y.getEventTargets(e),n=i[0],o=i[1],r=[];if(b.supportsTouch&&/touch/.test(e.type)){C=(new Date).getTime();for(var a=0;a<e.changedTouches.length;a++){var s=e.changedTouches[a],l=w.search(s,e.type,n);r.push([s,l||new _({pointerType:t})])}}else{var c=!1;if(!b.supportsPointerEvent&&/mouse/.test(e.type)){for(var u=0;u<v.interactions.length&&!c;u++)c="mouse"!==v.interactions[u].pointerType&&v.interactions[u].pointerIsDown;c=c||(new Date).getTime()-C<500||0===e.timeStamp}if(!c){var d=w.search(e,e.type,n);d=d||new _({pointerType:t}),r.push([e,d])}}for(var h=0;h<r.length;h++){var p=r[h],f=p[0],g=p[1];g._updateEventTargets(n,o),g[m](f,e,n,o)}}}function h(e){for(var t=0;t<v.interactions.length;t++){var i=v.interactions[t];i.end(e),s.fire("endall",{event:e,interaction:i})}}var p={},f=b.pEventTypes;function g(e,t){var i=e.doc,n=0===t.indexOf("add")?a.add:a.remove;for(var o in v.delegatedEvents)n(i,o,a.delegateListener),n(i,o,a.delegateUseCapture,!0);for(var r in p)n(i,r,p[r],b.isIOS?{passive:!1}:void 0)}n.PointerEvent?(p[f.down]=o.pointerDown,p[f.move]=o.pointerMove,p[f.up]=o.pointerUp,p[f.cancel]=o.pointerUp):(p.mousedown=o.pointerDown,p.mousemove=o.pointerMove,p.mouseup=o.pointerUp,p.touchstart=o.pointerDown,p.touchmove=o.pointerMove,p.touchend=o.pointerUp,p.touchcancel=o.pointerUp),p.blur=h,s.on("update-pointer-down",function(e){var t=e.interaction,i=e.pointer,n=e.pointerId,o=e.pointerIndex,r=e.event,a=e.eventTarget,s=e.down;t.pointerIds[o]=n,t.pointers[o]=i,s&&(t.pointerIsDown=!0),t.interacting()||(y.setCoords(t.startCoords,t.pointers),y.copyCoords(t.curCoords,t.startCoords),y.copyCoords(t.prevCoords,t.startCoords),t.downEvent=r,t.downTimes[o]=t.curCoords.timeStamp,t.downTargets[o]=a||r&&y.getEventTargets(r)[0],t.pointerWasMoved=!1,y.pointerExtend(t.downPointer,i))}),v.signals.on("add-document",g),v.signals.on("remove-document",g),_.pointerMoveTolerance=1,_.doOnInteractions=d,_.endAll=h,_.signals=s,_.docEvents=p,v.endAllInteractions=h,t.exports=_},{"./scope":33,"./utils":44,"./utils/Signals":34,"./utils/browser":36,"./utils/domObjects":38,"./utils/events":40,"./utils/interactionFinder":45}],6:[function(e,t,i){"use strict";var n=e("../Interaction"),a=e("../InteractEvent"),o={firePrepared:r,names:[],methodDict:{}};function r(e,t,i,n){var o=e.prepared.name,r=new a(e,t,o,i,e.element,null,n);e.target.fire(r),e.prevEvent=r}n.signals.on("action-start",function(e){var t=e.interaction,i=e.event;t._interacting=!0,r(t,i,"start")}),n.signals.on("action-move",function(e){var t=e.interaction;if(r(t,e.event,"move",e.preEnd),!t.interacting())return!1}),n.signals.on("action-end",function(e){r(e.interaction,e.event,"end")}),t.exports=o},{"../InteractEvent":3,"../Interaction":5}],7:[function(e,t,i){"use strict";var n=e("./base"),o=e("../utils"),r=e("../InteractEvent"),a=e("../Interactable"),s=e("../Interaction"),l=e("../defaultOptions"),c={defaults:{enabled:!1,mouseButtons:null,origin:null,snap:null,restrict:null,inertia:null,autoScroll:null,startAxis:"xy",lockAxis:"xy"},checker:function(e,t,i){var n=i.options.drag;return n.enabled?{name:"drag",axis:"start"===n.lockAxis?n.startAxis:n.lockAxis}:null},getCursor:function(){return"move"}};s.signals.on("before-action-move",function(e){var t=e.interaction;if("drag"===t.prepared.name){var i=t.prepared.axis;"x"===i?(t.curCoords.page.y=t.startCoords.page.y,t.curCoords.client.y=t.startCoords.client.y,t.pointerDelta.page.speed=Math.abs(t.pointerDelta.page.vx),t.pointerDelta.client.speed=Math.abs(t.pointerDelta.client.vx),t.pointerDelta.client.vy=0,t.pointerDelta.page.vy=0):"y"===i&&(t.curCoords.page.x=t.startCoords.page.x,t.curCoords.client.x=t.startCoords.client.x,t.pointerDelta.page.speed=Math.abs(t.pointerDelta.page.vy),t.pointerDelta.client.speed=Math.abs(t.pointerDelta.client.vy),t.pointerDelta.client.vx=0,t.pointerDelta.page.vx=0)}}),r.signals.on("new",function(e){var t=e.iEvent,i=e.interaction;if("dragmove"===t.type){var n=i.prepared.axis;"x"===n?(t.pageY=i.startCoords.page.y,t.clientY=i.startCoords.client.y,t.dy=0):"y"===n&&(t.pageX=i.startCoords.page.x,t.clientX=i.startCoords.client.x,t.dx=0)}}),a.prototype.draggable=function(e){return o.is.object(e)?(this.options.drag.enabled=!1!==e.enabled,this.setPerAction("drag",e),this.setOnEvents("drag",e),/^(xy|x|y|start)$/.test(e.lockAxis)&&(this.options.drag.lockAxis=e.lockAxis),/^(xy|x|y)$/.test(e.startAxis)&&(this.options.drag.startAxis=e.startAxis),this):o.is.bool(e)?((this.options.drag.enabled=e)||(this.ondragstart=this.ondragstart=this.ondragend=null),this):this.options.drag},n.drag=c,n.names.push("drag"),o.merge(a.eventTypes,["dragstart","dragmove","draginertiastart","draginertiaresume","dragend"]),n.methodDict.drag="draggable",l.drag=c.defaults,t.exports=c},{"../InteractEvent":3,"../Interactable":4,"../Interaction":5,"../defaultOptions":18,"../utils":44,"./base":6}],8:[function(e,t,i){"use strict";var n=e("./base"),g=e("../utils"),u=e("../scope"),o=e("../interact"),r=e("../InteractEvent"),a=e("../Interactable"),s=e("../Interaction"),l=e("../defaultOptions"),c={defaults:{enabled:!1,accept:null,overlap:"pointer"}},d=!1;function h(e,t){for(var i=void 0,n=0;n<e.dropzones.length;n++){var o=e.dropzones[n],r=e.elements[n];r!==i&&(t.target=r,o.fire(t)),i=r}}function p(e,t){var i=function(e,t){for(var i=[],n=[],o=0;o<u.interactables.length;o++){var r=u.interactables[o];if(r.options.drop.enabled){var a=r.options.drop.accept;if(!(g.is.element(a)&&a!==t||g.is.string(a)&&!g.matchesSelector(t,a)))for(var s=g.is.string(r.target)?r._context.querySelectorAll(r.target):[r.target],l=0;l<s.length;l++){var c=s[l];c!==t&&(i.push(r),n.push(c))}}}return{elements:n,dropzones:i}}(0,t);e.dropzones=i.dropzones,e.elements=i.elements,e.rects=[];for(var n=0;n<e.dropzones.length;n++)e.rects[n]=e.dropzones[n].getRect(e.elements[n])}function f(e,t,i){var n={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null},o={dragEvent:i,interaction:e,target:e.dropElement,dropzone:e.dropTarget,relatedTarget:i.target,draggable:i.interactable,timeStamp:i.timeStamp};return e.dropElement!==e.prevDropElement&&(e.prevDropTarget&&(n.leave=g.extend({type:"dragleave"},o),i.dragLeave=n.leave.target=e.prevDropElement,i.prevDropzone=n.leave.dropzone=e.prevDropTarget),e.dropTarget&&(n.enter={dragEvent:i,interaction:e,target:e.dropElement,dropzone:e.dropTarget,relatedTarget:i.target,draggable:i.interactable,timeStamp:i.timeStamp,type:"dragenter"},i.dragEnter=e.dropElement,i.dropzone=e.dropTarget)),"dragend"===i.type&&e.dropTarget&&(n.drop=g.extend({type:"drop"},o),i.dropzone=e.dropTarget,i.relatedTarget=e.dropElement),"dragstart"===i.type&&(n.activate=g.extend({type:"dropactivate"},o),n.activate.target=null,n.activate.dropzone=null),"dragend"===i.type&&(n.deactivate=g.extend({type:"dropdeactivate"},o),n.deactivate.target=null,n.deactivate.dropzone=null),"dragmove"===i.type&&e.dropTarget&&(n.move=g.extend({dragmove:i,type:"dropmove"},o),i.dropzone=e.dropTarget),n}function m(e,t){var i=e.activeDrops,n=e.prevDropTarget,o=e.dropTarget,r=e.dropElement;t.leave&&n.fire(t.leave),t.move&&o.fire(t.move),t.enter&&o.fire(t.enter),t.drop&&o.fire(t.drop),t.deactivate&&h(i,t.deactivate),e.prevDropTarget=o,e.prevDropElement=r}s.signals.on("action-start",function(e){var t=e.interaction,i=e.event;if("drag"===t.prepared.name){t.activeDrops.dropzones=[],t.activeDrops.elements=[],t.activeDrops.rects=[],t.dropEvents=null,t.dynamicDrop||p(t.activeDrops,t.element);var n=f(t,i,t.prevEvent);n.activate&&h(t.activeDrops,n.activate)}}),r.signals.on("new",function(e){var t=e.interaction,i=e.iEvent,n=e.event;if("dragmove"===i.type||"dragend"===i.type){var o=i,r=function(e,t,i){var n=e.interaction,o=[];d&&p(n.activeDrops,i);for(var r=0;r<n.activeDrops.dropzones.length;r++){var a=n.activeDrops.dropzones[r],s=n.activeDrops.elements[r],l=n.activeDrops.rects[r];o.push(a.dropCheck(e,t,n.target,i,s,l)?s:null)}var c=g.indexOfDeepestElement(o);return{dropzone:n.activeDrops.dropzones[c]||null,element:n.activeDrops.elements[c]||null}}(o,n,t.element);t.dropTarget=r.dropzone,t.dropElement=r.element,t.dropEvents=f(t,n,o)}}),s.signals.on("action-move",function(e){var t=e.interaction;"drag"===t.prepared.name&&m(t,t.dropEvents)}),s.signals.on("action-end",function(e){var t=e.interaction;"drag"===t.prepared.name&&m(t,t.dropEvents)}),s.signals.on("stop-drag",function(e){var t=e.interaction;t.activeDrops={dropzones:null,elements:null,rects:null},t.dropEvents=null}),a.prototype.dropzone=function(e){return g.is.object(e)?(this.options.drop.enabled=!1!==e.enabled,g.is.function(e.ondrop)&&(this.events.ondrop=e.ondrop),g.is.function(e.ondropactivate)&&(this.events.ondropactivate=e.ondropactivate),g.is.function(e.ondropdeactivate)&&(this.events.ondropdeactivate=e.ondropdeactivate),g.is.function(e.ondragenter)&&(this.events.ondragenter=e.ondragenter),g.is.function(e.ondragleave)&&(this.events.ondragleave=e.ondragleave),g.is.function(e.ondropmove)&&(this.events.ondropmove=e.ondropmove),/^(pointer|center)$/.test(e.overlap)?this.options.drop.overlap=e.overlap:g.is.number(e.overlap)&&(this.options.drop.overlap=Math.max(Math.min(1,e.overlap),0)),"accept"in e&&(this.options.drop.accept=e.accept),"checker"in e&&(this.options.drop.checker=e.checker),this):g.is.bool(e)?((this.options.drop.enabled=e)||(this.ondragenter=this.ondragleave=this.ondrop=this.ondropactivate=this.ondropdeactivate=null),this):this.options.drop},a.prototype.dropCheck=function(e,t,i,n,o,r){var a=!1;if(!(r=r||this.getRect(o)))return!!this.options.drop.checker&&this.options.drop.checker(e,t,a,this,o,i,n);var s=this.options.drop.overlap;if("pointer"===s){var l=g.getOriginXY(i,n,"drag"),c=g.getPageXY(e);c.x+=l.x,c.y+=l.y;var u=c.x>r.left&&c.x<r.right,d=c.y>r.top&&c.y<r.bottom;a=u&&d}var h=i.getRect(n);if(h&&"center"===s){var p=h.left+h.width/2,f=h.top+h.height/2;a=p>=r.left&&p<=r.right&&f>=r.top&&f<=r.bottom}h&&g.is.number(s)&&(a=s<=Math.max(0,Math.min(r.right,h.right)-Math.max(r.left,h.left))*Math.max(0,Math.min(r.bottom,h.bottom)-Math.max(r.top,h.top))/(h.width*h.height));return this.options.drop.checker&&(a=this.options.drop.checker(e,t,a,this,o,i,n)),a},a.signals.on("unset",function(e){e.interactable.dropzone(!1)}),a.settingsMethods.push("dropChecker"),s.signals.on("new",function(e){e.dropTarget=null,e.dropElement=null,e.prevDropTarget=null,e.prevDropElement=null,e.dropEvents=null,e.activeDrops={dropzones:[],elements:[],rects:[]}}),s.signals.on("stop",function(e){var t=e.interaction;t.dropTarget=t.dropElement=t.prevDropTarget=t.prevDropElement=null}),o.dynamicDrop=function(e){return g.is.bool(e)?(d=e,o):d},g.merge(a.eventTypes,["dragenter","dragleave","dropactivate","dropdeactivate","dropmove","drop"]),n.methodDict.drop="dropzone",l.drop=c.defaults,t.exports=c},{"../InteractEvent":3,"../Interactable":4,"../Interaction":5,"../defaultOptions":18,"../interact":21,"../scope":33,"../utils":44,"./base":6}],9:[function(e,t,i){"use strict";var n=e("./base"),c=e("../utils"),u=e("../InteractEvent"),o=e("../Interactable"),r=e("../Interaction"),a=e("../defaultOptions"),s={defaults:{enabled:!1,origin:null,restrict:null},checker:function(e,t,i,n,o){return 2<=o.pointerIds.length?{name:"gesture"}:null},getCursor:function(){return""}};u.signals.on("new",function(e){var t=e.iEvent,i=e.interaction;"gesturestart"===t.type&&(t.ds=0,i.gesture.startDistance=i.gesture.prevDistance=t.distance,i.gesture.startAngle=i.gesture.prevAngle=t.angle,i.gesture.scale=1)}),u.signals.on("new",function(e){var t=e.iEvent,i=e.interaction;"gesturemove"===t.type&&(t.ds=t.scale-i.gesture.scale,i.target.fire(t),i.gesture.prevAngle=t.angle,i.gesture.prevDistance=t.distance,t.scale===1/0||null===t.scale||void 0===t.scale||isNaN(t.scale)||(i.gesture.scale=t.scale))}),o.prototype.gesturable=function(e){return c.is.object(e)?(this.options.gesture.enabled=!1!==e.enabled,this.setPerAction("gesture",e),this.setOnEvents("gesture",e),this):c.is.bool(e)?((this.options.gesture.enabled=e)||(this.ongesturestart=this.ongesturestart=this.ongestureend=null),this):this.options.gesture},u.signals.on("set-delta",function(e){var t=e.interaction,i=e.iEvent,n=e.action,o=e.event,r=e.starting,a=e.ending,s=e.deltaSource;if("gesture"===n){var l=t.pointers;i.touches=[l[0],l[1]],r?(i.distance=c.touchDistance(l,s),i.box=c.touchBBox(l),i.scale=1,i.ds=0,i.angle=c.touchAngle(l,void 0,s),i.da=0):a||o instanceof u?(i.distance=t.prevEvent.distance,i.box=t.prevEvent.box,i.scale=t.prevEvent.scale,i.ds=i.scale-1,i.angle=t.prevEvent.angle,i.da=i.angle-t.gesture.startAngle):(i.distance=c.touchDistance(l,s),i.box=c.touchBBox(l),i.scale=i.distance/t.gesture.startDistance,i.angle=c.touchAngle(l,t.gesture.prevAngle,s),i.ds=i.scale-t.gesture.prevScale,i.da=i.angle-t.gesture.prevAngle)}}),r.signals.on("new",function(e){e.gesture={start:{x:0,y:0},startDistance:0,prevDistance:0,distance:0,scale:1,startAngle:0,prevAngle:0}}),n.gesture=s,n.names.push("gesture"),c.merge(o.eventTypes,["gesturestart","gesturemove","gestureend"]),n.methodDict.gesture="gesturable",a.gesture=s.defaults,t.exports=s},{"../InteractEvent":3,"../Interactable":4,"../Interaction":5,"../defaultOptions":18,"../utils":44,"./base":6}],10:[function(e,t,i){"use strict";var n=e("./base"),b=e("../utils"),o=e("../utils/browser"),r=e("../InteractEvent"),a=e("../Interactable"),s=e("../Interaction"),l=e("../defaultOptions"),p=o.supportsTouch||o.supportsPointerEvent?20:10,c={defaults:{enabled:!1,mouseButtons:null,origin:null,snap:null,restrict:null,inertia:null,autoScroll:null,square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},checker:function(e,t,i,n,o,r){if(!r)return null;var a=b.extend({},o.curCoords.page),s=i.options;if(s.resize.enabled){var l=s.resize,c={left:!1,right:!1,top:!1,bottom:!1};if(b.is.object(l.edges)){for(var u in c)c[u]=f(u,l.edges[u],a,o._eventTarget,n,r,l.margin||p);if(c.left=c.left&&!c.right,c.top=c.top&&!c.bottom,c.left||c.right||c.top||c.bottom)return{name:"resize",edges:c}}else{var d="y"!==s.resize.axis&&a.x>r.right-p,h="x"!==s.resize.axis&&a.y>r.bottom-p;if(d||h)return{name:"resize",axes:(d?"x":"")+(h?"y":"")}}}return null},cursors:o.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"},getCursor:function(e){if(e.axis)return c.cursors[e.name+e.axis];if(e.edges){for(var t="",i=["top","bottom","left","right"],n=0;n<4;n++)e.edges[i[n]]&&(t+=i[n]);return c.cursors[t]}}};function f(e,t,i,n,o,r,a){if(!t)return!1;if(!0===t){var s=b.is.number(r.width)?r.width:r.right-r.left,l=b.is.number(r.height)?r.height:r.bottom-r.top;if(s<0&&("left"===e?e="right":"right"===e&&(e="left")),l<0&&("top"===e?e="bottom":"bottom"===e&&(e="top")),"left"===e)return i.x<(0<=s?r.left:r.right)+a;if("top"===e)return i.y<(0<=l?r.top:r.bottom)+a;if("right"===e)return i.x>(0<=s?r.right:r.left)-a;if("bottom"===e)return i.y>(0<=l?r.bottom:r.top)-a}return!!b.is.element(n)&&(b.is.element(t)?t===n:b.matchesUpTo(n,t,o))}r.signals.on("new",function(e){var t=e.iEvent,i=e.interaction;if("resizestart"===t.type&&i.prepared.edges){var n=i.target.getRect(i.element),o=i.target.options.resize;if(o.square||o.preserveAspectRatio){var r=b.extend({},i.prepared.edges);r.top=r.top||r.left&&!r.bottom,r.left=r.left||r.top&&!r.right,r.bottom=r.bottom||r.right&&!r.top,r.right=r.right||r.bottom&&!r.left,i.prepared._linkedEdges=r}else i.prepared._linkedEdges=null;o.preserveAspectRatio&&(i.resizeStartAspectRatio=n.width/n.height),i.resizeRects={start:n,current:b.extend({},n),inverted:b.extend({},n),previous:b.extend({},n),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},t.rect=i.resizeRects.inverted,t.deltaRect=i.resizeRects.delta}}),r.signals.on("new",function(e){var t=e.iEvent,i=e.phase,n=e.interaction;if("move"===i&&n.prepared.edges){var o=n.target.options.resize,r=o.invert,a="reposition"===r||"negate"===r,s=n.prepared.edges,l=n.resizeRects.start,c=n.resizeRects.current,u=n.resizeRects.inverted,d=n.resizeRects.delta,h=b.extend(n.resizeRects.previous,u),p=s,f=t.dx,g=t.dy;if(o.preserveAspectRatio||o.square){var m=o.preserveAspectRatio?n.resizeStartAspectRatio:1;s=n.prepared._linkedEdges,p.left&&p.bottom||p.right&&p.top?g=-f/m:p.left||p.right?g=f/m:(p.top||p.bottom)&&(f=g*m)}if(s.top&&(c.top+=g),s.bottom&&(c.bottom+=g),s.left&&(c.left+=f),s.right&&(c.right+=f),a){if(b.extend(u,c),"reposition"===r){var v=void 0;u.top>u.bottom&&(v=u.top,u.top=u.bottom,u.bottom=v),u.left>u.right&&(v=u.left,u.left=u.right,u.right=v)}}else u.top=Math.min(c.top,l.bottom),u.bottom=Math.max(c.bottom,l.top),u.left=Math.min(c.left,l.right),u.right=Math.max(c.right,l.left);for(var y in u.width=u.right-u.left,u.height=u.bottom-u.top,u)d[y]=u[y]-h[y];t.edges=n.prepared.edges,t.rect=u,t.deltaRect=d}}),a.prototype.resizable=function(e){return b.is.object(e)?(this.options.resize.enabled=!1!==e.enabled,this.setPerAction("resize",e),this.setOnEvents("resize",e),/^x$|^y$|^xy$/.test(e.axis)?this.options.resize.axis=e.axis:null===e.axis&&(this.options.resize.axis=l.resize.axis),b.is.bool(e.preserveAspectRatio)?this.options.resize.preserveAspectRatio=e.preserveAspectRatio:b.is.bool(e.square)&&(this.options.resize.square=e.square),this):b.is.bool(e)?((this.options.resize.enabled=e)||(this.onresizestart=this.onresizestart=this.onresizeend=null),this):this.options.resize},s.signals.on("new",function(e){e.resizeAxes="xy"}),r.signals.on("set-delta",function(e){var t=e.interaction,i=e.iEvent;"resize"===e.action&&t.resizeAxes&&(t.target.options.resize.square?("y"===t.resizeAxes?i.dx=i.dy:i.dy=i.dx,i.axes="xy"):(i.axes=t.resizeAxes,"x"===t.resizeAxes?i.dy=0:"y"===t.resizeAxes&&(i.dx=0)))}),n.resize=c,n.names.push("resize"),b.merge(a.eventTypes,["resizestart","resizemove","resizeinertiastart","resizeinertiaresume","resizeend"]),n.methodDict.resize="resizable",l.resize=c.defaults,t.exports=c},{"../InteractEvent":3,"../Interactable":4,"../Interaction":5,"../defaultOptions":18,"../utils":44,"../utils/browser":36,"./base":6}],11:[function(e,t,i){"use strict";var r=e("./utils/raf"),u=e("./utils/window").getWindow,d=e("./utils/is"),h=e("./utils/domUtils"),n=e("./Interaction"),o=e("./defaultOptions"),p={defaults:{enabled:!1,container:null,margin:60,speed:300},interaction:null,i:null,x:0,y:0,isScrolling:!1,prevTime:0,start:function(e){p.isScrolling=!0,r.cancel(p.i),p.interaction=e,p.prevTime=(new Date).getTime(),p.i=r.request(p.scroll)},stop:function(){p.isScrolling=!1,r.cancel(p.i)},scroll:function(){var e=p.interaction.target.options[p.interaction.prepared.name].autoScroll,t=e.container||u(p.interaction.element),i=(new Date).getTime(),n=(i-p.prevTime)/1e3,o=e.speed*n;1<=o&&(d.window(t)?t.scrollBy(p.x*o,p.y*o):t&&(t.scrollLeft+=p.x*o,t.scrollTop+=p.y*o),p.prevTime=i),p.isScrolling&&(r.cancel(p.i),p.i=r.request(p.scroll))},check:function(e,t){var i=e.options;return i[t].autoScroll&&i[t].autoScroll.enabled},onInteractionMove:function(e){var t=e.interaction,i=e.pointer;if(t.interacting()&&p.check(t.target,t.prepared.name))if(t.simulation)p.x=p.y=0;else{var n=void 0,o=void 0,r=void 0,a=void 0,s=t.target.options[t.prepared.name].autoScroll,l=s.container||u(t.element);if(d.window(l))a=i.clientX<p.margin,n=i.clientY<p.margin,o=i.clientX>l.innerWidth-p.margin,r=i.clientY>l.innerHeight-p.margin;else{var c=h.getElementClientRect(l);a=i.clientX<c.left+p.margin,n=i.clientY<c.top+p.margin,o=i.clientX>c.right-p.margin,r=i.clientY>c.bottom-p.margin}p.x=o?1:a?-1:0,p.y=r?1:n?-1:0,p.isScrolling||(p.margin=s.margin,p.speed=s.speed,p.start(t))}}};n.signals.on("stop-active",function(){p.stop()}),n.signals.on("action-move",p.onInteractionMove),o.perAction.autoScroll=p.defaults,t.exports=p},{"./Interaction":5,"./defaultOptions":18,"./utils/domUtils":39,"./utils/is":46,"./utils/raf":50,"./utils/window":52}],12:[function(e,t,i){"use strict";var n=e("../Interactable"),c=e("../actions/base"),o=e("../utils/is"),r=e("../utils/domUtils"),a=e("../utils").warnOnce;n.prototype.getAction=function(e,t,i,n){var o=this.defaultActionChecker(e,t,i,n);return this.options.actionChecker?this.options.actionChecker(e,t,o,this,n,i):o},n.prototype.ignoreFrom=a(function(e){return this._backCompatOption("ignoreFrom",e)},"Interactable.ignoreForm() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue})."),n.prototype.allowFrom=a(function(e){return this._backCompatOption("allowFrom",e)},"Interactable.allowForm() has been deprecated. Use Interactble.draggable({allowFrom: newValue})."),n.prototype.testIgnore=function(e,t,i){return!(!e||!o.element(i))&&(o.string(e)?r.matchesUpTo(i,e,t):!!o.element(e)&&r.nodeContains(e,i))},n.prototype.testAllow=function(e,t,i){return!e||!!o.element(i)&&(o.string(e)?r.matchesUpTo(i,e,t):!!o.element(e)&&r.nodeContains(e,i))},n.prototype.testIgnoreAllow=function(e,t,i){return!this.testIgnore(e.ignoreFrom,t,i)&&this.testAllow(e.allowFrom,t,i)},n.prototype.actionChecker=function(e){return o.function(e)?(this.options.actionChecker=e,this):null===e?(delete this.options.actionChecker,this):this.options.actionChecker},n.prototype.styleCursor=function(e){return o.bool(e)?(this.options.styleCursor=e,this):null===e?(delete this.options.styleCursor,this):this.options.styleCursor},n.prototype.defaultActionChecker=function(e,t,i,n){for(var o=this.getRect(n),r=t.buttons||{0:1,1:4,3:8,4:16}[t.button],a=null,s=0;s<c.names.length;s++){var l=c.names[s];if((!i.pointerIsDown||!/mouse|pointer/.test(i.pointerType)||0!=(r&this.options[l].mouseButtons))&&(a=c[l].checker(e,t,this,n,i,o)))return a}}},{"../Interactable":4,"../actions/base":6,"../utils":44,"../utils/domUtils":39,"../utils/is":46}],13:[function(e,t,i){"use strict";var n=e("../interact"),o=e("../Interactable"),r=e("../Interaction"),a=e("../actions/base"),s=e("../defaultOptions"),h=e("../scope"),c=e("../utils"),l=e("../utils/Signals").new();e("./InteractableMethods");var p={signals:l,withinInteractionLimit:m,maxInteractions:1/0,defaults:{perAction:{manualStart:!1,max:1/0,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}},setActionDefaults:function(e){c.extend(e.defaults,p.defaults.perAction)},validateAction:d};function d(e,t,i,n){return c.is.object(e)&&t.testIgnoreAllow(t.options[e.name],i,n)&&t.options[e.name].enabled&&m(t,i,e)?e:null}function u(e,t,i,n,o,r){for(var a=0,s=n.length;a<s;a++){var l=n[a],c=o[a],u=d(l.getAction(t,i,e,c),l,c,r);if(u)return{action:u,target:l,element:c}}return{}}function f(e,t,i,n){var o=[],r=[],a=n;function s(e){o.push(e),r.push(a)}for(;c.is.element(a);){o=[],r=[],h.interactables.forEachMatch(a,s);var l=u(e,t,i,o,r,n);if(l.action&&!l.target.options[l.action.name].manualStart)return l;a=c.parentNode(a)}return{}}function g(e,t){var i=t.action,n=t.target,o=t.element;if(i=i||{},e.target&&e.target.options.styleCursor&&(e.target._doc.documentElement.style.cursor=""),e.target=n,e.element=o,c.copyAction(e.prepared,i),n&&n.options.styleCursor){var r=i?a[i.name].getCursor(i):"";e.target._doc.documentElement.style.cursor=r}l.fire("prepared",{interaction:e})}function m(e,t,i){var n=e.options,o=n[i.name].max,r=n[i.name].maxPerElement,a=0,s=0,l=0;if(o&&r&&p.maxInteractions){for(var c=0;c<h.interactions.length;c++){var u=h.interactions[c],d=u.prepared.name;if(u.interacting()){if(++a>=p.maxInteractions)return!1;if(u.target===e){if(o<=(s+=d===i.name|0))return!1;if(u.element===t&&(l++,d!==i.name||r<=l))return!1}}}return 0<p.maxInteractions}}r.signals.on("down",function(e){var t=e.interaction,i=e.pointer,n=e.event,o=e.eventTarget;t.interacting()||g(t,f(t,i,n,o))}),r.signals.on("move",function(e){var t=e.interaction,i=e.pointer,n=e.event,o=e.eventTarget;"mouse"!==t.pointerType||t.pointerIsDown||t.interacting()||g(t,f(t,i,n,o))}),r.signals.on("move",function(e){var t=e.interaction,i=e.event;if(t.pointerIsDown&&!t.interacting()&&t.pointerWasMoved&&t.prepared.name){l.fire("before-start",e);var n=t.target;t.prepared.name&&n&&(n.options[t.prepared.name].manualStart||!m(n,t.element,t.prepared)?t.stop(i):t.start(t.prepared,n,t.element))}}),r.signals.on("stop",function(e){var t=e.interaction.target;t&&t.options.styleCursor&&(t._doc.documentElement.style.cursor="")}),n.maxInteractions=function(e){return c.is.number(e)?(p.maxInteractions=e,n):p.maxInteractions},o.settingsMethods.push("styleCursor"),o.settingsMethods.push("actionChecker"),o.settingsMethods.push("ignoreFrom"),o.settingsMethods.push("allowFrom"),s.base.actionChecker=null,s.base.styleCursor=!0,c.extend(s.perAction,p.defaults.perAction),t.exports=p},{"../Interactable":4,"../Interaction":5,"../actions/base":6,"../defaultOptions":18,"../interact":21,"../scope":33,"../utils":44,"../utils/Signals":34,"./InteractableMethods":12}],14:[function(e,t,i){"use strict";var p=e("./base"),f=e("../scope"),g=e("../utils/is"),m=e("../utils/domUtils").parentNode;p.setActionDefaults(e("../actions/drag")),p.signals.on("before-start",function(e){var n=e.interaction,o=e.eventTarget,t=e.dx,i=e.dy;if("drag"===n.prepared.name){var r=Math.abs(t),a=Math.abs(i),s=n.target.options.drag,l=s.startAxis,c=a<r?"x":r<a?"y":"xy";if(n.prepared.axis="start"===s.lockAxis?c[0]:s.lockAxis,"xy"!=c&&"xy"!==l&&l!==c){n.prepared.name=null;for(var u=o,d=function(e){if(e!==n.target){var t=n.target.options.drag;if(!t.manualStart&&e.testIgnoreAllow(t,u,o)){var i=e.getAction(n.downPointer,n.downEvent,n,u);if(i&&"drag"===i.name&&function(e,t){if(!t)return!1;var i=t.options.drag.startAxis;return"xy"===e||"xy"===i||i===e}(c,e)&&p.validateAction(i,e,u,o))return e}}};g.element(u);){var h=f.interactables.forEachMatch(u,d);if(h){n.prepared.name="drag",n.target=h,n.element=u;break}u=m(u)}}}})},{"../actions/drag":7,"../scope":33,"../utils/domUtils":39,"../utils/is":46,"./base":13}],15:[function(e,t,i){"use strict";e("./base").setActionDefaults(e("../actions/gesture"))},{"../actions/gesture":9,"./base":13}],16:[function(e,t,i){"use strict";var n=e("./base"),o=e("../Interaction");function r(e){var t=e.prepared&&e.prepared.name;if(!t)return null;var i=e.target.options;return i[t].hold||i[t].delay}n.defaults.perAction.hold=0,n.defaults.perAction.delay=0,o.signals.on("new",function(e){e.autoStartHoldTimer=null}),n.signals.on("prepared",function(e){var t=e.interaction,i=r(t);0<i&&(t.autoStartHoldTimer=setTimeout(function(){t.start(t.prepared,t.target,t.element)},i))}),o.signals.on("move",function(e){var t=e.interaction,i=e.duplicate;t.pointerWasMoved&&!i&&clearTimeout(t.autoStartHoldTimer)}),n.signals.on("before-start",function(e){var t=e.interaction;0<r(t)&&(t.prepared.name=null)}),t.exports={getHoldDuration:r}},{"../Interaction":5,"./base":13}],17:[function(e,t,i){"use strict";e("./base").setActionDefaults(e("../actions/resize"))},{"../actions/resize":10,"./base":13}],18:[function(e,t,i){"use strict";t.exports={base:{accept:null,preventDefault:"auto",deltaSource:"page"},perAction:{origin:{x:0,y:0},inertia:{enabled:!1,resistance:10,minSpeed:100,endSpeed:10,allowResume:!0,smoothEndDuration:300}}}},{}],19:[function(e,t,i){"use strict";e("./inertia"),e("./modifiers/snap"),e("./modifiers/restrict"),e("./pointerEvents/base"),e("./pointerEvents/holdRepeat"),e("./pointerEvents/interactableTargets"),e("./autoStart/hold"),e("./actions/gesture"),e("./actions/resize"),e("./actions/drag"),e("./actions/drop"),e("./modifiers/snapSize"),e("./modifiers/restrictEdges"),e("./modifiers/restrictSize"),e("./autoStart/gesture"),e("./autoStart/resize"),e("./autoStart/drag"),e("./interactablePreventDefault.js"),e("./autoScroll"),t.exports=e("./interact")},{"./actions/drag":7,"./actions/drop":8,"./actions/gesture":9,"./actions/resize":10,"./autoScroll":11,"./autoStart/drag":14,"./autoStart/gesture":15,"./autoStart/hold":16,"./autoStart/resize":17,"./inertia":20,"./interact":21,"./interactablePreventDefault.js":22,"./modifiers/restrict":24,"./modifiers/restrictEdges":25,"./modifiers/restrictSize":26,"./modifiers/snap":27,"./modifiers/snapSize":28,"./pointerEvents/base":30,"./pointerEvents/holdRepeat":31,"./pointerEvents/interactableTargets":32}],20:[function(e,t,i){"use strict";var m=e("./InteractEvent"),c=e("./Interaction"),v=e("./modifiers/base"),y=e("./utils"),b=e("./utils/raf");function r(e){var t=e.inertiaStatus;if(t.active){var i=t.upCoords.page,n=t.upCoords.client;y.setCoords(e.curCoords,[{pageX:i.x+t.sx,pageY:i.y+t.sy,clientX:n.x+t.sx,clientY:n.y+t.sy}])}}c.signals.on("new",function(e){e.inertiaStatus={active:!1,smoothEnd:!1,allowResume:!1,startEvent:null,upCoords:{},xe:0,ye:0,sx:0,sy:0,t0:0,vx0:0,vys:0,duration:0,lambda_v0:0,one_ve_v0:0,i:null},e.boundInertiaFrame=function(){return function(){r(this),y.setCoordDeltas(this.pointerDelta,this.prevCoords,this.curCoords);var e=this.inertiaStatus,t=this.target.options[this.prepared.name].inertia.resistance,i=(new Date).getTime()/1e3-e.t0;if(i<e.te){var n=1-(Math.exp(-t*i)-e.lambda_v0)/e.one_ve_v0;if(e.modifiedXe===e.xe&&e.modifiedYe===e.ye)e.sx=e.xe*n,e.sy=e.ye*n;else{var o=y.getQuadraticCurvePoint(0,0,e.xe,e.ye,e.modifiedXe,e.modifiedYe,n);e.sx=o.x,e.sy=o.y}this.doMove(),e.i=b.request(this.boundInertiaFrame)}else e.sx=e.modifiedXe,e.sy=e.modifiedYe,this.doMove(),this.end(e.startEvent),e.active=!1,this.simulation=null;y.copyCoords(this.prevCoords,this.curCoords)}.apply(e)},e.boundSmoothEndFrame=function(){return function(){r(this);var e=this.inertiaStatus,t=(new Date).getTime()-e.t0,i=this.target.options[this.prepared.name].inertia.smoothEndDuration;t<i?(e.sx=y.easeOutQuad(t,0,e.xe,i),e.sy=y.easeOutQuad(t,0,e.ye,i),this.pointerMove(e.startEvent,e.startEvent),e.i=b.request(this.boundSmoothEndFrame)):(e.sx=e.xe,e.sy=e.ye,this.pointerMove(e.startEvent,e.startEvent),this.end(e.startEvent),e.smoothEnd=e.active=!1,this.simulation=null)}.apply(e)}}),c.signals.on("down",function(e){var t=e.interaction,i=e.event,n=e.pointer,o=e.eventTarget,r=t.inertiaStatus;if(r.active)for(var a=o;y.is.element(a);){if(a===t.element){b.cancel(r.i),r.active=!1,t.simulation=null,t.updatePointer(n),y.setCoords(t.curCoords,t.pointers);var s={interaction:t};c.signals.fire("before-action-move",s),c.signals.fire("action-resume",s);var l=new m(t,i,t.prepared.name,"inertiaresume",t.element);t.target.fire(l),t.prevEvent=l,v.resetStatuses(t.modifierStatuses),y.copyCoords(t.prevCoords,t.curCoords);break}a=y.parentNode(a)}}),c.signals.on("up",function(e){var t=e.interaction,i=e.event,n=t.inertiaStatus;if(t.interacting()&&!n.active){var o=t.target,r=o&&o.options,a=r&&t.prepared.name&&r[t.prepared.name].inertia,s=(new Date).getTime(),l={},c=y.extend({},t.curCoords.page),u=t.pointerDelta.client.speed,d=!1,h=void 0,p=a&&a.enabled&&"gesture"!==t.prepared.name&&i!==n.startEvent,f=p&&s-t.curCoords.timeStamp<50&&u>a.minSpeed&&u>a.endSpeed,g={interaction:t,pageCoords:c,statuses:l,preEnd:!0,requireEndOnly:!0};p&&!f&&(v.resetStatuses(l),(h=v.setAll(g)).shouldMove&&h.locked&&(d=!0)),(f||d)&&(y.copyCoords(n.upCoords,t.curCoords),t.pointers[0]=n.startEvent=new m(t,i,t.prepared.name,"inertiastart",t.element),n.t0=s,n.active=!0,n.allowResume=a.allowResume,t.simulation=n,o.fire(n.startEvent),f?(n.vx0=t.pointerDelta.client.vx,n.vy0=t.pointerDelta.client.vy,n.v0=u,function(e,t){var i=e.target.options[e.prepared.name].inertia,n=i.resistance,o=-Math.log(i.endSpeed/t.v0)/n;t.x0=e.prevEvent.pageX,t.y0=e.prevEvent.pageY,t.t0=t.startEvent.timeStamp/1e3,t.sx=t.sy=0,t.modifiedXe=t.xe=(t.vx0-o)/n,t.modifiedYe=t.ye=(t.vy0-o)/n,t.te=o,t.lambda_v0=n/t.v0,t.one_ve_v0=1-i.endSpeed/t.v0}(t,n),y.extend(c,t.curCoords.page),c.x+=n.xe,c.y+=n.ye,v.resetStatuses(l),h=v.setAll(g),n.modifiedXe+=h.dx,n.modifiedYe+=h.dy,n.i=b.request(t.boundInertiaFrame)):(n.smoothEnd=!0,n.xe=h.dx,n.ye=h.dy,n.sx=n.sy=0,n.i=b.request(t.boundSmoothEndFrame)))}}),c.signals.on("stop-active",function(e){var t=e.interaction,i=t.inertiaStatus;i.active&&(b.cancel(i.i),i.active=!1,t.simulation=null)})},{"./InteractEvent":3,"./Interaction":5,"./modifiers/base":23,"./utils":44,"./utils/raf":50}],21:[function(e,t,i){"use strict";var n=e("./utils/browser"),s=e("./utils/events"),l=e("./utils"),c=e("./scope"),u=e("./Interactable"),o=e("./Interaction"),d={};function h(e,t){var i=c.interactables.get(e,t);return i||((i=new u(e,t)).events.global=d),i}h.isSet=function(e,t){return-1!==c.interactables.indexOfElement(e,t&&t.context)},h.on=function(e,t,i){if(l.is.string(e)&&-1!==e.search(" ")&&(e=e.trim().split(/ +/)),l.is.array(e)){for(var n=0;n<e.length;n++){var o;o=e[n],h.on(o,t,i)}return h}if(l.is.object(e)){for(var r in e)h.on(r,e[r],t);return h}return l.contains(u.eventTypes,e)?d[e]?d[e].push(t):d[e]=[t]:s.add(c.document,e,t,{options:i}),h},h.off=function(e,t,i){if(l.is.string(e)&&-1!==e.search(" ")&&(e=e.trim().split(/ +/)),l.is.array(e)){for(var n=0;n<e.length;n++){var o;o=e[n],h.off(o,t,i)}return h}if(l.is.object(e)){for(var r in e)h.off(r,e[r],t);return h}if(l.contains(u.eventTypes,e)){var a=void 0;e in d&&-1!==(a=d[e].indexOf(t))&&d[e].splice(a,1)}else s.remove(c.document,e,t,i);return h},h.debug=function(){return c},h.getPointerAverage=l.pointerAverage,h.getTouchBBox=l.touchBBox,h.getTouchDistance=l.touchDistance,h.getTouchAngle=l.touchAngle,h.getElementRect=l.getElementRect,h.getElementClientRect=l.getElementClientRect,h.matchesSelector=l.matchesSelector,h.closest=l.closest,h.supportsTouch=function(){return n.supportsTouch},h.supportsPointerEvent=function(){return n.supportsPointerEvent},h.stop=function(e){for(var t=c.interactions.length-1;0<=t;t--)c.interactions[t].stop(e);return h},h.pointerMoveTolerance=function(e){return l.is.number(e)?(o.pointerMoveTolerance=e,h):o.pointerMoveTolerance},h.addDocument=c.addDocument,h.removeDocument=c.removeDocument,c.interact=h,t.exports=h},{"./Interactable":4,"./Interaction":5,"./scope":33,"./utils":44,"./utils/browser":36,"./utils/events":40}],22:[function(e,t,i){"use strict";var n=e("./Interactable"),o=e("./Interaction"),r=e("./scope"),a=e("./utils/is"),s=e("./utils/events"),l=e("./utils/browser"),c=e("./utils/domUtils"),u=c.nodeContains,d=c.matchesSelector;function h(e){var t=e.interaction,i=e.event;t.target&&t.target.checkAndPreventDefault(i)}n.prototype.preventDefault=function(e){return/^(always|never|auto)$/.test(e)?(this.options.preventDefault=e,this):a.bool(e)?(this.options.preventDefault=e?"always":"never",this):this.options.preventDefault},n.prototype.checkAndPreventDefault=function(e){var t=this.options.preventDefault;"never"!==t&&("always"!==t&&(s.supportsPassive&&/^touch(start|move)$/.test(e.type)&&!l.isIOS||/^(mouse|pointer|touch)*(down|start)/i.test(e.type)||a.element(e.target)&&d(e.target,"input,select,textarea,[contenteditable=true],[contenteditable=true] *"))||e.preventDefault())};for(var p=["down","move","up","cancel"],f=0;f<p.length;f++){var g=p[f];o.signals.on(g,h)}o.docEvents.dragstart=function(e){for(var t=0;t<r.interactions.length;t++){var i=r.interactions[t];if(i.element&&(i.element===e.target||u(i.element,e.target)))return void i.target.checkAndPreventDefault(e)}}},{"./Interactable":4,"./Interaction":5,"./scope":33,"./utils/browser":36,"./utils/domUtils":39,"./utils/events":40,"./utils/is":46}],23:[function(e,t,i){"use strict";var n=e("../InteractEvent"),o=e("../Interaction"),u=e("../utils/extend"),d={names:[],setOffsets:function(e){var t=e.interaction,i=e.pageCoords,n=t.target,o=t.element,r=t.startOffset,a=n.getRect(o);a?(r.left=i.x-a.left,r.top=i.y-a.top,r.right=a.right-i.x,r.bottom=a.bottom-i.y,"width"in a||(a.width=a.right-a.left),"height"in a||(a.height=a.bottom-a.top)):r.left=r.top=r.right=r.bottom=0,e.rect=a,e.interactable=n,e.element=o;for(var s=0;s<d.names.length;s++){var l=d.names[s];e.options=n.options[t.prepared.name][l],e.options&&(t.modifierOffsets[l]=d[l].setOffset(e))}},setAll:function(e){var t=e.interaction,i=e.statuses,n=e.preEnd,o=e.requireEndOnly,r={dx:0,dy:0,changed:!1,locked:!1,shouldMove:!0};e.modifiedCoords=u({},e.pageCoords);for(var a=0;a<d.names.length;a++){var s=d.names[a],l=d[s],c=t.target.options[t.prepared.name][s];h(c,n,o)&&(e.status=e.status=i[s],e.options=c,e.offset=e.interaction.modifierOffsets[s],l.set(e),e.status.locked&&(e.modifiedCoords.x+=e.status.dx,e.modifiedCoords.y+=e.status.dy,r.dx+=e.status.dx,r.dy+=e.status.dy,r.locked=!0))}return r.shouldMove=!e.status||!r.locked||e.status.changed,r},resetStatuses:function(e){for(var t=0;t<d.names.length;t++){var i=d.names[t],n=e[i]||{};n.dx=n.dy=0,n.modifiedX=n.modifiedY=NaN,n.locked=!1,n.changed=!0,e[i]=n}return e},start:function(e,t){var i=e.interaction,n={interaction:i,pageCoords:("action-resume"===t?i.curCoords:i.startCoords).page,startOffset:i.startOffset,statuses:i.modifierStatuses,preEnd:!1,requireEndOnly:!1};d.setOffsets(n),d.resetStatuses(n.statuses),n.pageCoords=u({},i.startCoords.page),i.modifierResult=d.setAll(n)},beforeMove:function(e){var t=e.interaction,i=e.preEnd,n=e.interactingBeforeMove,o=d.setAll({interaction:t,preEnd:i,pageCoords:t.curCoords.page,statuses:t.modifierStatuses,requireEndOnly:!1});!o.shouldMove&&n&&(t._dontFireMove=!0),t.modifierResult=o},end:function(e){for(var t=e.interaction,i=e.event,n=0;n<d.names.length;n++){var o=d.names[n];if(h(t.target.options[t.prepared.name][o],!0,!0)){t.doMove({event:i,preEnd:!0});break}}},setXY:function(e){for(var t=e.iEvent,i=e.interaction,n=u({},e),o=0;o<d.names.length;o++){var r=d.names[o];if(n.options=i.target.options[i.prepared.name][r],n.options){var a=d[r];n.status=i.modifierStatuses[r],t[r]=a.modifyCoords(n)}}}};function h(e,t,i){return e&&e.enabled&&(t||!e.endOnly)&&(!i||e.endOnly)}o.signals.on("new",function(e){e.startOffset={left:0,right:0,top:0,bottom:0},e.modifierOffsets={},e.modifierStatuses=d.resetStatuses({}),e.modifierResult=null}),o.signals.on("action-start",d.start),o.signals.on("action-resume",d.start),o.signals.on("before-action-move",d.beforeMove),o.signals.on("action-end",d.end),n.signals.on("set-xy",d.setXY),t.exports=d},{"../InteractEvent":3,"../Interaction":5,"../utils/extend":41}],24:[function(e,t,i){"use strict";var n=e("./base"),d=e("../utils"),o=e("../defaultOptions"),r={defaults:{enabled:!1,endOnly:!1,restriction:null,elementRect:null},setOffset:function(e){var t=e.rect,i=e.startOffset,n=e.options,o=n&&n.elementRect,r={};return t&&o?(r.left=i.left-t.width*o.left,r.top=i.top-t.height*o.top,r.right=i.right-t.width*(1-o.right),r.bottom=i.bottom-t.height*(1-o.bottom)):r.left=r.top=r.right=r.bottom=0,r},set:function(e){var t=e.modifiedCoords,i=e.interaction,n=e.status,o=e.options;if(!o)return n;var r=n.useStatusXY?{x:n.x,y:n.y}:d.extend({},t),a=h(o.restriction,i,r);if(!a)return n;n.dx=0,n.dy=0,n.locked=!1;var s=a,l=r.x,c=r.y,u=i.modifierOffsets.restrict;c="x"in a&&"y"in a?(l=Math.max(Math.min(s.x+s.width-u.right,r.x),s.x+u.left),Math.max(Math.min(s.y+s.height-u.bottom,r.y),s.y+u.top)):(l=Math.max(Math.min(s.right-u.right,r.x),s.left+u.left),Math.max(Math.min(s.bottom-u.bottom,r.y),s.top+u.top)),n.dx=l-r.x,n.dy=c-r.y,n.changed=n.modifiedX!==l||n.modifiedY!==c,n.locked=!(!n.dx&&!n.dy),n.modifiedX=l,n.modifiedY=c},modifyCoords:function(e){var t=e.page,i=e.client,n=e.status,o=e.phase,r=e.options,a=r&&r.elementRect;if(r&&r.enabled&&("start"!==o||!a||!n.locked)&&n.locked)return t.x+=n.dx,t.y+=n.dy,i.x+=n.dx,i.y+=n.dy,{dx:n.dx,dy:n.dy}},getRestrictionRect:h};function h(e,t,i){return d.is.function(e)?d.resolveRectLike(e,t.target,t.element,[i.x,i.y,t]):d.resolveRectLike(e,t.target,t.element)}n.restrict=r,n.names.push("restrict"),o.perAction.restrict=r.defaults,t.exports=r},{"../defaultOptions":18,"../utils":44,"./base":23}],25:[function(e,t,i){"use strict";var n=e("./base"),h=e("../utils"),p=e("../utils/rect"),o=e("../defaultOptions"),r=e("../actions/resize"),f=e("./restrict").getRestrictionRect,g={top:1/0,left:1/0,bottom:-1/0,right:-1/0},m={top:-1/0,left:-1/0,bottom:1/0,right:1/0},a={defaults:{enabled:!1,endOnly:!1,min:null,max:null,offset:null},setOffset:function(e){var t=e.interaction,i=e.startOffset,n=e.options;if(!n)return h.extend({},i);var o=f(n.offset,t,t.startCoords.page);return o?{top:i.top+o.y,left:i.left+o.x,bottom:i.bottom+o.y,right:i.right+o.x}:i},set:function(e){var t=e.modifiedCoords,i=e.interaction,n=e.status,o=e.offset,r=e.options,a=i.prepared.linkedEdges||i.prepared.edges;if(i.interacting()&&a){var s=n.useStatusXY?{x:n.x,y:n.y}:h.extend({},t),l=p.xywhToTlbr(f(r.inner,i,s))||g,c=p.xywhToTlbr(f(r.outer,i,s))||m,u=s.x,d=s.y;n.dx=0,n.dy=0,n.locked=!1,a.top?d=Math.min(Math.max(c.top+o.top,s.y),l.top+o.top):a.bottom&&(d=Math.max(Math.min(c.bottom-o.bottom,s.y),l.bottom-o.bottom)),a.left?u=Math.min(Math.max(c.left+o.left,s.x),l.left+o.left):a.right&&(u=Math.max(Math.min(c.right-o.right,s.x),l.right-o.right)),n.dx=u-s.x,n.dy=d-s.y,n.changed=n.modifiedX!==u||n.modifiedY!==d,n.locked=!(!n.dx&&!n.dy),n.modifiedX=u,n.modifiedY=d}},modifyCoords:function(e){var t=e.page,i=e.client,n=e.status,o=e.phase,r=e.options;if(r&&r.enabled&&("start"!==o||!n.locked)&&n.locked)return t.x+=n.dx,t.y+=n.dy,i.x+=n.dx,i.y+=n.dy,{dx:n.dx,dy:n.dy}},noInner:g,noOuter:m,getRestrictionRect:f};n.restrictEdges=a,n.names.push("restrictEdges"),o.perAction.restrictEdges=a.defaults,r.defaults.restrictEdges=a.defaults,t.exports=a},{"../actions/resize":10,"../defaultOptions":18,"../utils":44,"../utils/rect":51,"./base":23,"./restrict":24}],26:[function(e,t,i){"use strict";var n=e("./base"),s=e("./restrictEdges"),l=e("../utils"),c=e("../utils/rect"),o=e("../defaultOptions"),r=e("../actions/resize"),u={width:-1/0,height:-1/0},d={width:1/0,height:1/0},a={defaults:{enabled:!1,endOnly:!1,min:null,max:null},setOffset:function(e){return e.interaction.startOffset},set:function(e){var t=e.interaction,i=e.options,n=t.prepared.linkedEdges||t.prepared.edges;if(t.interacting()&&n){var o=c.xywhToTlbr(t.resizeRects.inverted),r=c.tlbrToXywh(s.getRestrictionRect(i.min,t))||u,a=c.tlbrToXywh(s.getRestrictionRect(i.max,t))||d;e.options={enabled:i.enabled,endOnly:i.endOnly,inner:l.extend({},s.noInner),outer:l.extend({},s.noOuter)},n.top?(e.options.inner.top=o.bottom-r.height,e.options.outer.top=o.bottom-a.height):n.bottom&&(e.options.inner.bottom=o.top+r.height,e.options.outer.bottom=o.top+a.height),n.left?(e.options.inner.left=o.right-r.width,e.options.outer.left=o.right-a.width):n.right&&(e.options.inner.right=o.left+r.width,e.options.outer.right=o.left+a.width),s.set(e)}},modifyCoords:s.modifyCoords};n.restrictSize=a,n.names.push("restrictSize"),o.perAction.restrictSize=a.defaults,r.defaults.restrictSize=a.defaults,t.exports=a},{"../actions/resize":10,"../defaultOptions":18,"../utils":44,"../utils/rect":51,"./base":23,"./restrictEdges":25}],27:[function(e,t,i){"use strict";var n=e("./base"),o=e("../interact"),T=e("../utils"),r=e("../defaultOptions"),a={defaults:{enabled:!1,endOnly:!1,range:1/0,targets:null,offsets:null,relativePoints:null},setOffset:function(e){var t=e.interaction,i=e.interactable,n=e.element,o=e.rect,r=e.startOffset,a=e.options,s=[],l=T.rectToXY(T.resolveRectLike(a.origin))||T.getOriginXY(i,n,t.prepared.name),c=void 0;if("startCoords"===(a=a||i.options[t.prepared.name].snap||{}).offset)c={x:t.startCoords.page.x-l.x,y:t.startCoords.page.y-l.y};else{var u=T.resolveRectLike(a.offset,i,n,[t]);c=T.rectToXY(u)||{x:0,y:0}}if(o&&a.relativePoints&&a.relativePoints.length)for(var d=0;d<a.relativePoints.length;d++){var h=a.relativePoints[d],p=h.x,f=h.y;s.push({x:r.left-o.width*p+c.x,y:r.top-o.height*f+c.y})}else s.push(c);return s},set:function(e){var t=e.interaction,i=e.modifiedCoords,n=e.status,o=e.options,r=e.offset,a=[],s=void 0,l=void 0,c=void 0;if(n.useStatusXY)l={x:n.x,y:n.y};else{var u=T.getOriginXY(t.target,t.element,t.prepared.name);(l=T.extend({},i)).x-=u.x,l.y-=u.y}n.realX=l.x,n.realY=l.y;for(var d=o.targets&&o.targets.length,h=0;h<r.length;h++)for(var p=r[h],f=p.x,g=p.y,m=l.x-f,v=l.y-g,y=0;y<(o.targets||[]).length;y++){var b=(o.targets||[])[y];(s=T.is.function(b)?b(m,v,t):b)&&a.push({x:T.is.number(s.x)?s.x+f:m,y:T.is.number(s.y)?s.y+g:v,range:T.is.number(s.range)?s.range:o.range})}var w={target:null,inRange:!1,distance:0,range:0,dx:0,dy:0};for(c=0,d=a.length;c<d;c++){var C=(s=a[c]).range,_=s.x-l.x,A=s.y-l.y,E=T.hypot(_,A),x=E<=C;C===1/0&&w.inRange&&w.range!==1/0&&(x=!1),w.target&&!(x?w.inRange&&C!==1/0?E/C<w.distance/w.range:C===1/0&&w.range!==1/0||E<w.distance:!w.inRange&&E<w.distance)||(w.target=s,w.distance=E,w.range=C,w.inRange=x,w.dx=_,w.dy=A,n.range=C)}var S=void 0;w.target?(S=n.modifiedX!==w.target.x||n.modifiedY!==w.target.y,n.modifiedX=w.target.x,n.modifiedY=w.target.y):(S=!0,n.modifiedX=NaN,n.modifiedY=NaN),n.dx=w.dx,n.dy=w.dy,n.changed=S||w.inRange&&!n.locked,n.locked=w.inRange},modifyCoords:function(e){var t=e.page,i=e.client,n=e.status,o=e.phase,r=e.options,a=r&&r.relativePoints;if(r&&r.enabled&&("start"!==o||!a||!a.length))return n.locked&&(t.x+=n.dx,t.y+=n.dy,i.x+=n.dx,i.y+=n.dy),{range:n.range,locked:n.locked,x:n.modifiedX,y:n.modifiedY,realX:n.realX,realY:n.realY,dx:n.dx,dy:n.dy}}};o.createSnapGrid=function(s){return function(e,t){var i=s.limits||{left:-1/0,right:1/0,top:-1/0,bottom:1/0},n=0,o=0;T.is.object(s.offset)&&(n=s.offset.x,o=s.offset.y);var r=Math.round((e-n)/s.x),a=Math.round((t-o)/s.y);return{x:Math.max(i.left,Math.min(i.right,r*s.x+n)),y:Math.max(i.top,Math.min(i.bottom,a*s.y+o)),range:s.range}}},n.snap=a,n.names.push("snap"),r.perAction.snap=a.defaults,t.exports=a},{"../defaultOptions":18,"../interact":21,"../utils":44,"./base":23}],28:[function(e,t,i){"use strict";var n=e("./base"),d=e("./snap"),o=e("../defaultOptions"),r=e("../actions/resize"),h=e("../utils/"),a={defaults:{enabled:!1,endOnly:!1,range:1/0,targets:null,offsets:null},setOffset:function(e){var t=e.interaction,i=e.options,n=t.prepared.edges;if(n){e.options={relativePoints:[{x:n.left?0:1,y:n.top?0:1}],origin:{x:0,y:0},offset:"self",range:i.range};var o=d.setOffset(e);return e.options=i,o}},set:function(e){var t=e.interaction,i=e.options,n=e.offset,o=e.modifiedCoords,r=h.extend({},o),a=r.x-n[0].x,s=r.y-n[0].y;e.options=h.extend({},i),e.options.targets=[];for(var l=0;l<(i.targets||[]).length;l++){var c=(i.targets||[])[l],u=void 0;(u=h.is.function(c)?c(a,s,t):c)&&("width"in u&&"height"in u&&(u.x=u.width,u.y=u.height),e.options.targets.push(u))}d.set(e)},modifyCoords:function(e){var t=e.options;e.options=h.extend({},t),e.options.enabled=t.enabled,e.options.relativePoints=[null],d.modifyCoords(e)}};n.snapSize=a,n.names.push("snapSize"),o.perAction.snapSize=a.defaults,r.defaults.snapSize=a.defaults,t.exports=a},{"../actions/resize":10,"../defaultOptions":18,"../utils/":44,"./base":23,"./snap":27}],29:[function(e,t,i){"use strict";var s=e("../utils/pointerUtils");function l(e,t,i,n,o){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),s.pointerExtend(this,i),i!==t&&s.pointerExtend(this,t),this.interaction=o,this.timeStamp=(new Date).getTime(),this.originalEvent=i,this.type=e,this.pointerId=s.getPointerId(t),this.pointerType=s.getPointerType(t),this.target=n,this.currentTarget=null,"tap"===e){var r=o.getPointerIndex(t);this.dt=this.timeStamp-o.downTimes[r];var a=this.timeStamp-o.tapTime;this.double=!!(o.prevTap&&"doubletap"!==o.prevTap.type&&o.prevTap.target===this.target&&a<500)}else"doubletap"===e&&(this.dt=t.timeStamp-o.tapTime)}t.exports=(l.prototype.subtractOrigin=function(e){var t=e.x,i=e.y;return this.pageX-=t,this.pageY-=i,this.clientX-=t,this.clientY-=i,this},l.prototype.addOrigin=function(e){var t=e.x,i=e.y;return this.pageX+=t,this.pageY+=i,this.clientX+=t,this.clientY+=i,this},l.prototype.preventDefault=function(){this.originalEvent.preventDefault()},l.prototype.stopPropagation=function(){this.propagationStopped=!0},l.prototype.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},l)},{"../utils/pointerUtils":49}],30:[function(e,t,i){"use strict";var v=e("./PointerEvent"),n=e("../Interaction"),y=e("../utils"),o=e("../defaultOptions"),b=e("../utils/Signals").new(),r=["down","up","cancel"],a=["down","up","cancel"],s={PointerEvent:v,fire:w,collectEventTargets:C,signals:b,defaults:{holdDuration:600,ignoreFrom:null,allowFrom:null,origin:{x:0,y:0}},types:["down","move","up","cancel","tap","doubletap","hold"]};function w(e){for(var t=e.interaction,i=e.pointer,n=e.event,o=e.eventTarget,r=e.type,a=void 0===r?e.pointerEvent.type:r,s=e.targets,l=void 0===s?C(e):s,c=e.pointerEvent,u=void 0===c?new v(a,i,n,o,t):c,d={interaction:t,pointer:i,event:n,eventTarget:o,targets:l,type:a,pointerEvent:u},h=0;h<l.length;h++){var p=l[h];for(var f in p.props||{})u[f]=p.props[f];var g=y.getOriginXY(p.eventable,p.element);if(u.subtractOrigin(g),u.eventable=p.eventable,u.currentTarget=p.element,p.eventable.fire(u),u.addOrigin(g),u.immediatePropagationStopped||u.propagationStopped&&h+1<l.length&&l[h+1].element!==u.currentTarget)break}if(b.fire("fired",d),"tap"===a){var m=u.double?w({interaction:t,pointer:i,event:n,eventTarget:o,type:"doubletap"}):u;t.prevTap=m,t.tapTime=m.timeStamp}return u}function C(e){var t=e.interaction,i=e.pointer,n=e.event,o=e.eventTarget,r=e.type,a=t.getPointerIndex(i);if("tap"===r&&(t.pointerWasMoved||!t.downTargets[a]||t.downTargets[a]!==o))return[];for(var s=y.getPath(o),l={interaction:t,pointer:i,event:n,eventTarget:o,type:r,path:s,targets:[],element:null},c=0;c<s.length;c++){var u=s[c];l.element=u,b.fire("collect-targets",l)}return"hold"===r&&(l.targets=l.targets.filter(function(e){return e.eventable.options.holdDuration===t.holdTimers[a].duration})),l.targets}n.signals.on("update-pointer-down",function(e){var t=e.interaction,i=e.pointerIndex;t.holdTimers[i]={duration:1/0,timeout:null}}),n.signals.on("remove-pointer",function(e){var t=e.interaction,i=e.pointerIndex;t.holdTimers.splice(i,1)}),n.signals.on("move",function(e){var t=e.interaction,i=e.pointer,n=e.event,o=e.eventTarget,r=e.duplicateMove,a=t.getPointerIndex(i);r||t.pointerIsDown&&!t.pointerWasMoved||(t.pointerIsDown&&clearTimeout(t.holdTimers[a].timeout),w({interaction:t,pointer:i,event:n,eventTarget:o,type:"move"}))}),n.signals.on("down",function(e){for(var t=e.interaction,i=e.pointer,n=e.event,o=e.eventTarget,r=e.pointerIndex,a=t.holdTimers[r],s=y.getPath(o),l={interaction:t,pointer:i,event:n,eventTarget:o,type:"hold",targets:[],path:s,element:null},c=0;c<s.length;c++){var u=s[c];l.element=u,b.fire("collect-targets",l)}if(l.targets.length){for(var d=1/0,h=0;h<l.targets.length;h++){var p=l.targets[h].eventable.options.holdDuration;p<d&&(d=p)}a.duration=d,a.timeout=setTimeout(function(){w({interaction:t,eventTarget:o,pointer:i,event:n,type:"hold"})},d)}}),n.signals.on("up",function(e){var t=e.interaction,i=e.pointer,n=e.event,o=e.eventTarget;t.pointerWasMoved||w({interaction:t,eventTarget:o,pointer:i,event:n,type:"tap"})});for(var l=["up","cancel"],c=0;c<l.length;c++){var u=l[c];n.signals.on(u,function(e){var t=e.interaction,i=e.pointerIndex;t.holdTimers[i]&&clearTimeout(t.holdTimers[i].timeout)})}function d(o){return function(e){var t=e.interaction,i=e.pointer,n=e.event;w({interaction:t,eventTarget:e.eventTarget,pointer:i,event:n,type:o})}}for(var h=0;h<r.length;h++)n.signals.on(r[h],d(a[h]));n.signals.on("new",function(e){e.prevTap=null,e.tapTime=0,e.holdTimers=[]}),o.pointerEvents=s.defaults,t.exports=s},{"../Interaction":5,"../defaultOptions":18,"../utils":44,"../utils/Signals":34,"./PointerEvent":29}],31:[function(e,t,i){"use strict";var a=e("./base"),n=e("../Interaction");a.signals.on("new",l),a.signals.on("fired",c);for(var o=["move","up","cancel","endall"],r=0;r<o.length;r++){var s=o[r];n.signals.on(s,u)}function l(e){var t=e.pointerEvent;"hold"===t.type&&(t.count=(t.count||0)+1)}function c(e){var t=e.interaction,i=e.pointerEvent,n=e.eventTarget,o=e.targets;if("hold"===i.type&&o.length){var r=o[0].eventable.options.holdRepeatInterval;r<=0||(t.holdIntervalHandle=setTimeout(function(){a.fire({interaction:t,eventTarget:n,type:"hold",pointer:i,event:i})},r))}}function u(e){var t=e.interaction;t.holdIntervalHandle&&(clearInterval(t.holdIntervalHandle),t.holdIntervalHandle=null)}a.defaults.holdRepeatInterval=0,a.types.push("holdrepeat"),t.exports={onNew:l,onFired:c,endHoldRepeat:u}},{"../Interaction":5,"./base":30}],32:[function(e,t,i){"use strict";var n=e("./base"),o=e("../Interactable"),s=e("../utils/is"),l=e("../scope"),r=e("../utils/extend"),a=e("../utils/arr").merge;n.signals.on("collect-targets",function(e){var n=e.targets,o=e.element,r=e.type,a=e.eventTarget;l.interactables.forEachMatch(o,function(e){var t=e.events,i=t.options;t[r]&&s.element(o)&&e.testIgnoreAllow(i,o,a)&&n.push({element:o,eventable:t,props:{interactable:e}})})}),o.signals.on("new",function(e){var t=e.interactable;t.events.getRect=function(e){return t.getRect(e)}}),o.signals.on("set",function(e){var t=e.interactable,i=e.options;r(t.events.options,n.defaults),r(t.events.options,i)}),a(o.eventTypes,n.types),o.prototype.pointerEvents=function(e){return r(this.events.options,e),this};var c=o.prototype._backCompatOption;o.prototype._backCompatOption=function(e,t){var i=c.call(this,e,t);return i===this&&(this.events.options[e]=t),i},o.settingsMethods.push("pointerEvents")},{"../Interactable":4,"../scope":33,"../utils/arr":35,"../utils/extend":41,"../utils/is":46,"./base":30}],33:[function(e,t,i){"use strict";var n=e("./utils"),o=e("./utils/events"),r=e("./utils/Signals").new(),a=e("./utils/window").getWindow,s={signals:r,events:o,utils:n,document:e("./utils/domObjects").document,documents:[],addDocument:function(e,t){if(n.contains(s.documents,e))return!1;t=t||a(e),s.documents.push(e),o.documents.push(e),e!==s.document&&o.add(t,"unload",s.onWindowUnload),r.fire("add-document",{doc:e,win:t})},removeDocument:function(e,t){var i=s.documents.indexOf(e);t=t||a(e),o.remove(t,"unload",s.onWindowUnload),s.documents.splice(i,1),o.documents.splice(i,1),r.fire("remove-document",{win:t,doc:e})},onWindowUnload:function(){s.removeDocument(this.document,this)}};t.exports=s},{"./utils":44,"./utils/Signals":34,"./utils/domObjects":38,"./utils/events":40,"./utils/window":52}],34:[function(e,t,i){"use strict";var n=(o.prototype.on=function(e,t){this.listeners[e]?this.listeners[e].push(t):this.listeners[e]=[t]},o.prototype.off=function(e,t){if(this.listeners[e]){var i=this.listeners[e].indexOf(t);-1!==i&&this.listeners[e].splice(i,1)}},o.prototype.fire=function(e,t){var i=this.listeners[e];if(i)for(var n=0;n<i.length;n++)if(!1===(0,i[n])(t,e))return},o);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.listeners={}}n.new=function(){return new n},t.exports=n},{}],35:[function(e,t,i){"use strict";t.exports={contains:function(e,t){return-1!==e.indexOf(t)},merge:function(e,t){for(var i=0;i<t.length;i++){var n=t[i];e.push(n)}return e}}},{}],36:[function(e,t,i){"use strict";var n=e("./window").window,o=e("./is"),r=e("./domObjects"),a=r.Element,s=n.navigator,l={supportsTouch:!!("ontouchstart"in n||o.function(n.DocumentTouch)&&r.document instanceof n.DocumentTouch),supportsPointerEvent:!!r.PointerEvent,isIOS:/iP(hone|od|ad)/.test(s.platform),isIOS7:/iP(hone|od|ad)/.test(s.platform)&&/OS 7[^\d]/.test(s.appVersion),isIe9:/MSIE 9/.test(s.userAgent),prefixedMatchesSelector:"matches"in a.prototype?"matches":"webkitMatchesSelector"in a.prototype?"webkitMatchesSelector":"mozMatchesSelector"in a.prototype?"mozMatchesSelector":"oMatchesSelector"in a.prototype?"oMatchesSelector":"msMatchesSelector",pEventTypes:r.PointerEvent?r.PointerEvent===n.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"}:null,wheelEvent:"onmousewheel"in r.document?"mousewheel":"wheel"};l.isOperaMobile="Opera"===s.appName&&l.supportsTouch&&s.userAgent.match("Presto"),t.exports=l},{"./domObjects":38,"./is":46,"./window":52}],37:[function(e,t,i){"use strict";var o=e("./is");t.exports=function e(t){var i={};for(var n in t)o.plainObject(t[n])?i[n]=e(t[n]):i[n]=t[n];return i}},{"./is":46}],38:[function(e,t,i){"use strict";var n={},o=e("./window").window;function r(){}n.document=o.document,n.DocumentFragment=o.DocumentFragment||r,n.SVGElement=o.SVGElement||r,n.SVGSVGElement=o.SVGSVGElement||r,n.SVGElementInstance=o.SVGElementInstance||r,n.Element=o.Element||r,n.HTMLElement=o.HTMLElement||n.Element,n.Event=o.Event,n.Touch=o.Touch||r,n.PointerEvent=o.PointerEvent||o.MSPointerEvent,t.exports=n},{"./window":52}],39:[function(e,t,i){"use strict";var n=e("./window"),o=e("./browser"),r=e("./is"),d=e("./domObjects"),a={nodeContains:function(e,t){for(;t;){if(t===e)return!0;t=t.parentNode}return!1},closest:function(e,t){for(;r.element(e);){if(a.matchesSelector(e,t))return e;e=a.parentNode(e)}return null},parentNode:function(e){var t=e.parentNode;if(r.docFrag(t)){for(;(t=t.host)&&r.docFrag(t););return t}return t},matchesSelector:function(e,t){return n.window!==n.realWindow&&(t=t.replace(/\/deep\//g," ")),e[o.prefixedMatchesSelector](t)},indexOfDeepestElement:function(e){var t=[],i=[],n=void 0,o=e[0],r=o?0:-1,a=void 0,s=void 0,l=void 0,c=void 0;for(l=1;l<e.length;l++)if((n=e[l])&&n!==o)if(o){if(n.parentNode!==n.ownerDocument)if(o.parentNode!==n.ownerDocument){if(!t.length)for(a=o;a.parentNode&&a.parentNode!==a.ownerDocument;)t.unshift(a),a=a.parentNode;if(o instanceof d.HTMLElement&&n instanceof d.SVGElement&&!(n instanceof d.SVGSVGElement)){if(n===o.parentNode)continue;a=n.ownerSVGElement}else a=n;for(i=[];a.parentNode!==a.ownerDocument;)i.unshift(a),a=a.parentNode;for(c=0;i[c]&&i[c]===t[c];)c++;var u=[i[c-1],i[c],t[c]];for(s=u[0].lastChild;s;){if(s===u[1]){o=n,r=l,t=[];break}if(s===u[2])break;s=s.previousSibling}}else o=n,r=l}else o=n,r=l;return r},matchesUpTo:function(e,t,i){for(;r.element(e);){if(a.matchesSelector(e,t))return!0;if((e=a.parentNode(e))===i)return a.matchesSelector(e,t)}return!1},getActualElement:function(e){return e instanceof d.SVGElementInstance?e.correspondingUseElement:e},getScrollXY:function(e){return{x:(e=e||n.window).scrollX||e.document.documentElement.scrollLeft,y:e.scrollY||e.document.documentElement.scrollTop}},getElementClientRect:function(e){var t=e instanceof d.SVGElement?e.getBoundingClientRect():e.getClientRects()[0];return t&&{left:t.left,right:t.right,top:t.top,bottom:t.bottom,width:t.width||t.right-t.left,height:t.height||t.bottom-t.top}},getElementRect:function(e){var t=a.getElementClientRect(e);if(!o.isIOS7&&t){var i=a.getScrollXY(n.getWindow(e));t.left+=i.x,t.right+=i.x,t.top+=i.y,t.bottom+=i.y}return t},getPath:function(e){for(var t=[];e;)t.push(e),e=a.parentNode(e);return t},trySelector:function(e){return!!r.string(e)&&(d.document.querySelector(e),!0)}};t.exports=a},{"./browser":36,"./domObjects":38,"./is":46,"./window":52}],40:[function(e,t,i){"use strict";var n,m=e("./is"),v=e("./domUtils"),y=e("./pointerUtils"),b=e("./pointerExtend"),o=e("./window").window,s=e("./arr").contains,u=[],d=[],w={},h=[],p=(n=!1,o.document.createElement("div").addEventListener("test",null,{get capture(){n=!0}}),n);function f(e,t,i,n){var o=E(n),r=u.indexOf(e),a=d[r];a||(a={events:{},typeCount:0},r=u.push(e)-1,d.push(a)),a.events[t]||(a.events[t]=[],a.typeCount++),s(a.events[t],i)||(e.addEventListener(t,i,p?o:!!o.capture),a.events[t].push(i))}function g(e,t,i,n){var o=E(n),r=u.indexOf(e),a=d[r];if(a&&a.events)if("all"!==t){if(a.events[t]){var s=a.events[t].length;if("all"===i){for(var l=0;l<s;l++)g(e,t,a.events[t][l],o);return}for(var c=0;c<s;c++)if(a.events[t][c]===i){e.removeEventListener("on"+t,i,p?o:!!o.capture),a.events[t].splice(c,1);break}a.events[t]&&0===a.events[t].length&&(a.events[t]=null,a.typeCount--)}a.typeCount||(d.splice(r,1),u.splice(r,1))}else for(t in a.events)a.events.hasOwnProperty(t)&&g(e,t,"all")}function C(e,t){var i=E(t),n={},o=w[e.type],r=y.getEventTargets(e)[0],a=r;for(b(n,e),n.originalEvent=e,n.preventDefault=A;m.element(a);){for(var s=0;s<o.selectors.length;s++){var l=o.selectors[s],c=o.contexts[s];if(v.matchesSelector(a,l)&&v.nodeContains(c,r)&&v.nodeContains(c,a)){var u=o.listeners[s];n.currentTarget=a;for(var d=0;d<u.length;d++){var h=u[d],p=h[0],f=h[1],g=h[2];f===!!i.capture&&g===i.passive&&p(n)}}}a=v.parentNode(a)}}function _(e){return C.call(this,e,!0)}function A(){this.originalEvent.preventDefault()}function E(e){return m.object(e)?e:{capture:e}}t.exports={add:f,remove:g,addDelegate:function(e,t,i,n,o){var r=E(o);if(!w[i]){w[i]={selectors:[],contexts:[],listeners:[]};for(var a=0;a<h.length;a++){var s=h[a];f(s,i,C),f(s,i,_,!0)}}var l=w[i],c=void 0;for(c=l.selectors.length-1;0<=c&&(l.selectors[c]!==e||l.contexts[c]!==t);c--);-1===c&&(c=l.selectors.length,l.selectors.push(e),l.contexts.push(t),l.listeners.push([])),l.listeners[c].push([n,!!r.capture,r.passive])},removeDelegate:function(e,t,i,n,o){var r=E(o),a=w[i],s=!1,l=void 0;if(a)for(l=a.selectors.length-1;0<=l;l--)if(a.selectors[l]===e&&a.contexts[l]===t){for(var c=a.listeners[l],u=c.length-1;0<=u;u--){var d=c[u],h=d[0],p=d[1],f=d[2];if(h===n&&p===!!r.capture&&f===r.passive){c.splice(u,1),c.length||(a.selectors.splice(l,1),a.contexts.splice(l,1),a.listeners.splice(l,1),g(t,i,C),g(t,i,_,!0),a.selectors.length||(w[i]=null)),s=!0;break}}if(s)break}},delegateListener:C,delegateUseCapture:_,delegatedEvents:w,documents:h,supportsOptions:p,_elements:u,_targets:d}},{"./arr":35,"./domUtils":39,"./is":46,"./pointerExtend":48,"./pointerUtils":49,"./window":52}],41:[function(e,t,i){"use strict";t.exports=function(e,t){for(var i in t)e[i]=t[i];return e}},{}],42:[function(e,t,i){"use strict";var n=e("./rect"),a=n.resolveRectLike,s=n.rectToXY;t.exports=function(e,t,i){var n=e.options[i],o=n&&n.origin||e.options.origin,r=a(o,e,t,[e&&t]);return s(r)||{x:0,y:0}}},{"./rect":51}],43:[function(e,t,i){"use strict";t.exports=function(e,t){return Math.sqrt(e*e+t*t)}},{}],44:[function(e,t,i){"use strict";var n=e("./extend"),o=e("./window"),s={warnOnce:function(e,t){var i=!1;return function(){return i||(o.window.console.warn(t),i=!0),e.apply(this,arguments)}},_getQBezierValue:function(e,t,i,n){var o=1-e;return o*o*t+2*o*e*i+e*e*n},getQuadraticCurvePoint:function(e,t,i,n,o,r,a){return{x:s._getQBezierValue(a,e,i,o),y:s._getQBezierValue(a,t,n,r)}},easeOutQuad:function(e,t,i,n){return-i*(e/=n)*(e-2)+t},copyAction:function(e,t){return e.name=t.name,e.axis=t.axis,e.edges=t.edges,e},is:e("./is"),extend:n,hypot:e("./hypot"),getOriginXY:e("./getOriginXY")};n(s,e("./arr")),n(s,e("./domUtils")),n(s,e("./pointerUtils")),n(s,e("./rect")),t.exports=s},{"./arr":35,"./domUtils":39,"./extend":41,"./getOriginXY":42,"./hypot":43,"./is":46,"./pointerUtils":49,"./rect":51,"./window":52}],45:[function(e,t,i){"use strict";var c=e("../scope"),u=e("./index"),l={methodOrder:["simulationResume","mouseOrPen","hasPointer","idle"],search:function(e,t,i){for(var n=u.getPointerType(e),o={pointer:e,pointerId:u.getPointerId(e),pointerType:n,eventType:t,eventTarget:i},r=0;r<l.methodOrder.length;r++){var a;a=l.methodOrder[r];var s=l[a](o);if(s)return s}},simulationResume:function(e){var t=e.pointerType,i=e.eventType,n=e.eventTarget;if(!/down|start/i.test(i))return null;for(var o=0;o<c.interactions.length;o++){var r=c.interactions[o],a=n;if(r.simulation&&r.simulation.allowResume&&r.pointerType===t)for(;a;){if(a===r.element)return r;a=u.parentNode(a)}}return null},mouseOrPen:function(e){var t=e.pointerId,i=e.pointerType,n=e.eventType;if("mouse"!==i&&"pen"!==i)return null;for(var o=void 0,r=0;r<c.interactions.length;r++){var a=c.interactions[r];if(a.pointerType===i){if(a.simulation&&!u.contains(a.pointerIds,t))continue;if(a.interacting())return a;o=o||a}}if(o)return o;for(var s=0;s<c.interactions.length;s++){var l=c.interactions[s];if(!(l.pointerType!==i||/down/i.test(n)&&l.simulation))return l}return null},hasPointer:function(e){for(var t=e.pointerId,i=0;i<c.interactions.length;i++){var n=c.interactions[i];if(u.contains(n.pointerIds,t))return n}},idle:function(e){for(var t=e.pointerType,i=0;i<c.interactions.length;i++){var n=c.interactions[i];if(1===n.pointerIds.length){var o=n.target;if(o&&!o.options.gesture.enabled)continue}else if(2<=n.pointerIds.length)continue;if(!n.interacting()&&t===n.pointerType)return n}return null}};t.exports=l},{"../scope":33,"./index":44}],46:[function(e,t,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=e("./window"),r=e("./isWindow"),a={array:function(){},window:function(e){return e===o.window||r(e)},docFrag:function(e){return a.object(e)&&11===e.nodeType},object:function(e){return!!e&&"object"===(void 0===e?"undefined":n(e))},function:function(e){return"function"==typeof e},number:function(e){return"number"==typeof e},bool:function(e){return"boolean"==typeof e},string:function(e){return"string"==typeof e},element:function(e){if(!e||"object"!==(void 0===e?"undefined":n(e)))return!1;var t=o.getWindow(e)||o.window;return/object|function/.test(n(t.Element))?e instanceof t.Element:1===e.nodeType&&"string"==typeof e.nodeName},plainObject:function(e){return a.object(e)&&"Object"===e.constructor.name}};a.array=function(e){return a.object(e)&&void 0!==e.length&&a.function(e.splice)},t.exports=a},{"./isWindow":47,"./window":52}],47:[function(e,t,i){"use strict";t.exports=function(e){return!(!e||!e.Window)&&e instanceof e.Window}},{}],48:[function(e,a,t){"use strict";function i(e,t){for(var i in t){var n=a.exports.prefixedPropREs,o=!1;for(var r in n)if(0===i.indexOf(r)&&n[r].test(i)){o=!0;break}o||"function"==typeof t[i]||(e[i]=t[i])}return e}i.prefixedPropREs={webkit:/(Movement[XY]|Radius[XY]|RotationAngle|Force)$/},a.exports=i},{}],49:[function(e,t,i){"use strict";var s=e("./hypot"),n=e("./browser"),o=e("./domObjects"),r=e("./domUtils"),a=e("./domObjects"),l=e("./is"),c={copyCoords:function(e,t){e.page=e.page||{},e.page.x=t.page.x,e.page.y=t.page.y,e.client=e.client||{},e.client.x=t.client.x,e.client.y=t.client.y,e.timeStamp=t.timeStamp},setCoordDeltas:function(e,t,i){e.page.x=i.page.x-t.page.x,e.page.y=i.page.y-t.page.y,e.client.x=i.client.x-t.client.x,e.client.y=i.client.y-t.client.y,e.timeStamp=i.timeStamp-t.timeStamp;var n=Math.max(e.timeStamp/1e3,.001);e.page.speed=s(e.page.x,e.page.y)/n,e.page.vx=e.page.x/n,e.page.vy=e.page.y/n,e.client.speed=s(e.client.x,e.page.y)/n,e.client.vx=e.client.x/n,e.client.vy=e.client.y/n},isNativePointer:function(e){return e instanceof o.Event||e instanceof o.Touch},getXY:function(e,t,i){return(i=i||{}).x=t[(e=e||"page")+"X"],i.y=t[e+"Y"],i},getPageXY:function(e,t){return t=t||{},n.isOperaMobile&&c.isNativePointer(e)?(c.getXY("screen",e,t),t.x+=window.scrollX,t.y+=window.scrollY):c.getXY("page",e,t),t},getClientXY:function(e,t){return t=t||{},n.isOperaMobile&&c.isNativePointer(e)?c.getXY("screen",e,t):c.getXY("client",e,t),t},getPointerId:function(e){return l.number(e.pointerId)?e.pointerId:e.identifier},setCoords:function(e,t,i){var n=1<t.length?c.pointerAverage(t):t[0],o={};c.getPageXY(n,o),e.page.x=o.x,e.page.y=o.y,c.getClientXY(n,o),e.client.x=o.x,e.client.y=o.y,e.timeStamp=l.number(i)?i:(new Date).getTime()},pointerExtend:e("./pointerExtend"),getTouchPair:function(e){var t=[];return l.array(e)?(t[0]=e[0],t[1]=e[1]):"touchend"===e.type?1===e.touches.length?(t[0]=e.touches[0],t[1]=e.changedTouches[0]):0===e.touches.length&&(t[0]=e.changedTouches[0],t[1]=e.changedTouches[1]):(t[0]=e.touches[0],t[1]=e.touches[1]),t},pointerAverage:function(e){for(var t={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0},i=0;i<e.length;i++){var n=e[i];for(var o in t)t[o]+=n[o]}for(var r in t)t[r]/=e.length;return t},touchBBox:function(e){if(e.length||e.touches&&1<e.touches.length){var t=c.getTouchPair(e),i=Math.min(t[0].pageX,t[1].pageX),n=Math.min(t[0].pageY,t[1].pageY);return{x:i,y:n,left:i,top:n,width:Math.max(t[0].pageX,t[1].pageX)-i,height:Math.max(t[0].pageY,t[1].pageY)-n}}},touchDistance:function(e,t){var i=t+"X",n=t+"Y",o=c.getTouchPair(e),r=o[0][i]-o[1][i],a=o[0][n]-o[1][n];return s(r,a)},touchAngle:function(e,t,i){var n=i+"X",o=i+"Y",r=c.getTouchPair(e),a=r[1][n]-r[0][n],s=r[1][o]-r[0][o];return 180*Math.atan2(s,a)/Math.PI},getPointerType:function(e){return l.string(e.pointerType)?e.pointerType:l.number(e.pointerType)?[void 0,void 0,"touch","pen","mouse"][e.pointerType]:/touch/.test(e.type)||e instanceof a.Touch?"touch":"mouse"},getEventTargets:function(e){var t=l.function(e.composedPath)?e.composedPath():e.path;return[r.getActualElement(t?t[0]:e.target),r.getActualElement(e.currentTarget)]}};t.exports=c},{"./browser":36,"./domObjects":38,"./domUtils":39,"./hypot":43,"./is":46,"./pointerExtend":48}],50:[function(e,t,i){"use strict";for(var n=e("./window").window,o=["ms","moz","webkit","o"],r=0,a=void 0,s=void 0,l=0;l<o.length&&!n.requestAnimationFrame;l++)a=n[o[l]+"RequestAnimationFrame"],s=n[o[l]+"CancelAnimationFrame"]||n[o[l]+"CancelRequestAnimationFrame"];a=a||function(e){var t=(new Date).getTime(),i=Math.max(0,16-(t-r)),n=setTimeout(function(){e(t+i)},i);return r=t+i,n},s=s||function(e){clearTimeout(e)},t.exports={request:a,cancel:s}},{"./window":52}],51:[function(e,t,i){"use strict";var n=e("./extend"),o=e("./is"),r=e("./domUtils"),a=r.closest,s=r.parentNode,l=r.getElementRect,c={getStringOptionResult:function(e,t,i){return o.string(e)?e="parent"===e?s(i):"self"===e?t.getRect(i):a(i,e):null},resolveRectLike:function(e,t,i,n){return e=c.getStringOptionResult(e,t,i)||e,o.function(e)&&(e=e.apply(null,n)),o.element(e)&&(e=l(e)),e},rectToXY:function(e){return e&&{x:"x"in e?e.x:e.left,y:"y"in e?e.y:e.top}},xywhToTlbr:function(e){return!e||"left"in e&&"top"in e||((e=n({},e)).left=e.x||0,e.top=e.y||0,e.right=e.right||e.left+e.width,e.bottom=e.bottom||e.top+e.height),e},tlbrToXywh:function(e){return!e||"x"in e&&"y"in e||((e=n({},e)).x=e.left||0,e.top=e.top||0,e.width=e.width||e.right-e.x,e.height=e.height||e.bottom-e.y),e}};t.exports=c},{"./domUtils":39,"./extend":41,"./is":46}],52:[function(e,t,i){"use strict";var n=t.exports,o=e("./isWindow");function r(e){var t=(n.realWindow=e).document.createTextNode("");t.ownerDocument!==e.document&&"function"==typeof e.wrap&&e.wrap(t)===t&&(e=e.wrap(e)),n.window=e}"undefined"==typeof window?(n.window=void 0,n.realWindow=void 0):r(window),n.getWindow=function(e){if(o(e))return e;var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||n.window},n.init=r},{"./isWindow":47}]},{},[1])(1)});