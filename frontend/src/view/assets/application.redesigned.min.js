/* ==========================================================================
   Emm JS - nightly build 25-03-2024
   ========================================================================== */

/* License
   ========================================================================== */

/**
 * EMM License to be added
 *
 **/



/* Libraries
   ========================================================================== */

/**
 * jQuery JavaScript Library v3.5.1
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * (c) 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Licensed under MIT (http://jquery.org/license)
 *
 * http://jquery.com
 **/

/**
 * Lo-Dash 4.17.21 (Custom Build)
 *
 * Build: `lodash -o ./dist/lodash.compat.js`
 *
 * Based on Underscore.js 1.8.3
 * Licensed under MIT (http://underscorejs.org/LICENSE)
 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 *
 * (c) 2012-2013 The Dojo Foundation http://dojofoundation.org/
 * Licensed under MIT (http://lodash.com/license)
 *
 * https://lodash.com/
 **/

 /**
 * D3.js 3.5.5
 *
 * Licensed under MIT (https://github.com/mbostock/d3/blob/master/LICENSE)
 * (c) 2010-2015, Michael Bostock
 *
 * http://d3js.org/
 **/

  /**
 * C3.js 0.4.10
 *
 * Licensed under MIT (https://github.com/masayuki0812/c3/blob/master/LICENSE)
 * (c) 2013 Masayuki Tanaka
 *
 * http://c3js.org/
 **/

/**
 * jQuery Plugins
 *
 * jquery-i18n v1.1.1
 * Licensed under MIT
 * (c) 2010 Dave Perrett
 * https://github.com/recurser/jquery-i18n
 *
 * jquery-migrate v3.3.2
 * Licensed under MIT
 * (c) 2005, 2013 jQuery Foundation, Inc. and other contributors
 * https://github.com/jquery/jquery-migrate
 *
 * jquery-select2 v3.5.2
 * Licensed under Apache License, Version 2.0 & GNU General Public License version 2
 * (c) 2012 Igor Vaynberg
 * https://ivaynberg.github.io/select2/
 *
 * jquery-mousewheel v3.1.9
 * Licensed under MIT
 * (c) 2013 Brandon Aaron
 * http://brandon.aaron.sh
 *
 * jquery-perfect-scrollbar v0.5.7
 * Licensed under MIT
 * (c) 2012, 2014 Hyunje Alex Jun and other contributors
 * https://noraesae.github.io/perfect-scrollbar/
 *
 * jquery DoubleScroll v0.4
 * Dual licensed under the MIT and GPL licenses
 * (c) Pawel Suwala, Antoine Vianey
 * https://github.com/avianey/jqDoubleScroll
 *
 * jquery Endless Scroll
 * Dual licensed under the MIT and GPL licenses
 * (c) 2008-2012 Fred Wu
 * https://github.com/fredwu/jquery-endless-scroll
 *
 * jQuery File Upload Plugin
 * Licensed under the MIT license
 * (c) 2010, Sebastian Tschan
 * https://github.com/blueimp/jQuery-File-Upload
 **/

/**
 * Bootstrap Components v3.4.1
 *
 * dropdown.js
 * modal.js
 * popover.js
 * tooltip.js
 *
 * (c) 2011-2019 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 *
 * http://getbootstrap.com/
 **/

/**
 * Bootstrap Extensions
 *
 * bootstrap-slider v4.8.1
 * Licensed under MIT
 * (c) 2015 Kyle Kemp, Rohit Kalkur, and contributors
 *
 * bootstrap-colorpicker v2.5.2
 * Licensed under Apache License v2.0
 * (c) 2012 Stefan Petre
 *
 **/

/**
 * jQuery UI v1.13.1
 *
 * core.js, widget.js, mouse.js, position.js, accordion.js, autocomplete.js, button.js, datepicker.js, dialog.js, draggable.js, droppable.js, effect.js, effect-blind.js, effect-bounce.js, effect-clip.js, effect-drop.js, effect-explode.js, effect-fade.js, effect-fold.js, effect-highlight.js, effect-puff.js, effect-pulsate.js, effect-scale.js, effect-shake.js, effect-size.js, effect-slide.js, effect-transfer.js, menu.js, progressbar.js, resizable.js, selectable.js, selectmenu.js, slider.js, sortable.js, spinner.js, tabs.js, tooltip.js
 *
 * (c) 2014 jQuery Foundation and other contributors
 * Licensed under MIT
 *
 * http://jqueryui.com
 **/

/**
 * Pickadate v3.5.6
 *
 * date.js
 * time.js
 * legacy.js
 *
 * (c) 2014 Amsul, http://amsul.ca
 * Licensed under https://github.com/amsul/pickadate.js/blob/3.5.6/LICENSE.md
 *
 * https://amsul.github.io/pickadate.js
 **/

/**
 * Ace Editor
 *
 * Distributed under the BSD license:

 * Copyright (c) 2010, Ajax.org B.V.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *     * Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in the
 *       documentation and/or other materials provided with the distribution.
 *     * Neither the name of Ajax.org B.V. nor the
 *       names of its contributors may be used to endorse or promote products
 *       derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * http://ace.c9.io/
 **/

/**
 * iFrame Resizer v4.3.2
 *
 * (c) 2014 David J. Bradshaw - dave@bradshaw.net
 * Licensed under MIT
 *
 * https://davidjbradshaw.github.io/iframe-resizer/
 **/

/**
 * Toastr (modified version)
 *
 * (c) 2012-2014 John Papa and Hans Fj√§llemark
 * Licensed under MIT
 *
 * https://github.com/CodeSeven/toastr
 **/

/**
 * EmojiOne Area v v3.4.1
 *
 * EmojiOneArea is released under the MIT license.
 *
 * Copyright (c) 2015-2017 Andrey Izman <izmanw@gmail.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

(function(e,t){"use strict";if(typeof module==="object"&&typeof module.exports==="object"){module.exports=e.document?t(e,true):function(e){if(!e.document){throw new Error("jQuery requires a window with a document")}return t(e)}}else{t(e)}})(typeof window!=="undefined"?window:this,function(x,P){"use strict";var t=[];var F=Object.getPrototypeOf;var a=t.slice;var G=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)};var $=t.push;var H=t.indexOf;var B={};var V=B.toString;var j=B.hasOwnProperty;var z=j.toString;var W=z.call(Object);var g={};var m=function e(t){return typeof t==="function"&&typeof t.nodeType!=="number"&&typeof t.item!=="function"};var v=function e(t){return t!=null&&t===t.window};var S=x.document;var U={type:true,src:true,nonce:true,noModule:true};function Y(e,t,i){i=i||S;var n,r,o=i.createElement("script");o.text=e;if(t){for(n in U){r=t[n]||t.getAttribute&&t.getAttribute(n);if(r){o.setAttribute(n,r)}}}i.head.appendChild(o).parentNode.removeChild(o)}function y(e){if(e==null){return e+""}return typeof e==="object"||typeof e==="function"?B[V.call(e)]||"object":typeof e}var q="3.5.1",A=function(e,t){return new A.fn.init(e,t)};A.fn=A.prototype={jquery:q,constructor:A,length:0,toArray:function(){return a.call(this)},get:function(e){if(e==null){return a.call(this)}return e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=A.merge(this.constructor(),e);t.prevObject=this;return t},each:function(e){return A.each(this,e)},map:function(i){return this.pushStack(A.map(this,function(e,t){return i.call(e,t,e)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(A.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(A.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:$,sort:t.sort,splice:t.splice};A.extend=A.fn.extend=function(){var e,t,i,n,r,o,s=arguments[0]||{},a=1,l=arguments.length,c=false;if(typeof s==="boolean"){c=s;s=arguments[a]||{};a++}if(typeof s!=="object"&&!m(s)){s={}}if(a===l){s=this;a--}for(;a<l;a++){if((e=arguments[a])!=null){for(t in e){n=e[t];if(t==="__proto__"||s===n){continue}if(c&&n&&(A.isPlainObject(n)||(r=Array.isArray(n)))){i=s[t];if(r&&!Array.isArray(i)){o=[]}else if(!r&&!A.isPlainObject(i)){o={}}else{o=i}r=false;s[t]=A.extend(c,o,n)}else if(n!==undefined){s[t]=n}}}}return s};A.extend({expando:"jQuery"+(q+Math.random()).replace(/\D/g,""),isReady:true,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,i;if(!e||V.call(e)!=="[object Object]"){return false}t=F(e);if(!t){return true}i=j.call(t,"constructor")&&t.constructor;return typeof i==="function"&&z.call(i)===W},isEmptyObject:function(e){var t;for(t in e){return false}return true},globalEval:function(e,t,i){Y(e,{nonce:t&&t.nonce},i)},each:function(e,t){var i,n=0;if(K(e)){i=e.length;for(;n<i;n++){if(t.call(e[n],n,e[n])===false){break}}}else{for(n in e){if(t.call(e[n],n,e[n])===false){break}}}return e},makeArray:function(e,t){var i=t||[];if(e!=null){if(K(Object(e))){A.merge(i,typeof e==="string"?[e]:e)}else{$.call(i,e)}}return i},inArray:function(e,t,i){return t==null?-1:H.call(t,e,i)},merge:function(e,t){var i=+t.length,n=0,r=e.length;for(;n<i;n++){e[r++]=t[n]}e.length=r;return e},grep:function(e,t,i){var n,r=[],o=0,s=e.length,a=!i;for(;o<s;o++){n=!t(e[o],o);if(n!==a){r.push(e[o])}}return r},map:function(e,t,i){var n,r,o=0,s=[];if(K(e)){n=e.length;for(;o<n;o++){r=t(e[o],o,i);if(r!=null){s.push(r)}}}else{for(o in e){r=t(e[o],o,i);if(r!=null){s.push(r)}}}return G(s)},guid:1,support:g});if(typeof Symbol==="function"){A.fn[Symbol.iterator]=t[Symbol.iterator]}A.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){B["[object "+t+"]"]=t.toLowerCase()});function K(e){var t=!!e&&"length"in e&&e.length,i=y(e);if(m(e)||v(e)){return false}return i==="array"||t===0||typeof t==="number"&&t>0&&t-1 in e}var e=function(P){var e,f,_,o,F,p,G,$,w,l,c,C,x,r,S,g,s,a,m,A="sizzle"+1*new Date,u=P.document,E=0,H=0,B=n(),V=n(),j=n(),v=n(),z=function(e,t){if(e===t){c=true}return 0},W={}.hasOwnProperty,t=[],U=t.pop,Y=t.push,T=t.push,q=t.slice,y=function(e,t){var i=0,n=e.length;for(;i<n;i++){if(e[i]===t){return i}}return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|"+"ismap|loop|multiple|open|readonly|required|scoped",d="[\\x20\\t\\r\\n\\f]",i="(?:\\\\[\\da-fA-F]{1,6}"+d+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",X="\\["+d+"*("+i+")(?:"+d+"*([*^$|!~]?=)"+d+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+i+"))|)"+d+"*\\]",Z=":("+i+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+X+")*)|"+".*"+")\\)|)",Q=new RegExp(d+"+","g"),b=new RegExp("^"+d+"+|((?:^|[^\\\\])(?:\\\\.)*)"+d+"+$","g"),J=new RegExp("^"+d+"*,"+d+"*"),ee=new RegExp("^"+d+"*([>+~]|"+d+")"+d+"*"),te=new RegExp(d+"|>"),ie=new RegExp(Z),ne=new RegExp("^"+i+"$"),h={ID:new RegExp("^#("+i+")"),CLASS:new RegExp("^\\.("+i+")"),TAG:new RegExp("^("+i+"|[*])"),ATTR:new RegExp("^"+X),PSEUDO:new RegExp("^"+Z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+d+"*(even|odd|(([+-]|)(\\d*)n|)"+d+"*(?:([+-]|)"+d+"*(\\d+)|))"+d+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+d+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+d+"*((?:-\\d)?\\d*)"+d+"*\\)|)(?=[^-]|$)","i")},re=/HTML$/i,oe=/^(?:input|select|textarea|button)$/i,se=/^h\d$/i,D=/^[^{]+\{\s*\[native \w/,ae=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,le=/[+~]/,R=new RegExp("\\\\[\\da-fA-F]{1,6}"+d+"?|\\\\([^\\r\\n\\f])","g"),M=function(e,t){var i="0x"+e.slice(1)-65536;return t?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,i&1023|56320)},ce=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ue=function(e,t){if(t){if(e==="\0"){return""}return e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" "}return"\\"+e},de=function(){C()},he=_e(function(e){return e.disabled===true&&e.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"});try{T.apply(t=q.call(u.childNodes),u.childNodes);t[u.childNodes.length].nodeType}catch(e){T={apply:t.length?function(e,t){Y.apply(e,q.call(t))}:function(e,t){var i=e.length,n=0;while(e[i++]=t[n++]){}e.length=i-1}}}function k(t,e,i,n){var r,o,s,a,l,c,u,d=e&&e.ownerDocument,h=e?e.nodeType:9;i=i||[];if(typeof t!=="string"||!t||h!==1&&h!==9&&h!==11){return i}if(!n){C(e);e=e||x;if(S){if(h!==11&&(l=ae.exec(t))){if(r=l[1]){if(h===9){if(s=e.getElementById(r)){if(s.id===r){i.push(s);return i}}else{return i}}else{if(d&&(s=d.getElementById(r))&&m(e,s)&&s.id===r){i.push(s);return i}}}else if(l[2]){T.apply(i,e.getElementsByTagName(t));return i}else if((r=l[3])&&f.getElementsByClassName&&e.getElementsByClassName){T.apply(i,e.getElementsByClassName(r));return i}}if(f.qsa&&!v[t+" "]&&(!g||!g.test(t))&&(h!==1||e.nodeName.toLowerCase()!=="object")){u=t;d=e;if(h===1&&(te.test(t)||ee.test(t))){d=le.test(t)&&ye(e.parentNode)||e;if(d!==e||!f.scope){if(a=e.getAttribute("id")){a=a.replace(ce,ue)}else{e.setAttribute("id",a=A)}}c=p(t);o=c.length;while(o--){c[o]=(a?"#"+a:":scope")+" "+L(c[o])}u=c.join(",")}try{T.apply(i,d.querySelectorAll(u));return i}catch(e){v(t,true)}finally{if(a===A){e.removeAttribute("id")}}}}}return $(t.replace(b,"$1"),e,i,n)}function n(){var i=[];function n(e,t){if(i.push(e+" ")>_.cacheLength){delete n[i.shift()]}return n[e+" "]=t}return n}function O(e){e[A]=true;return e}function N(e){var t=x.createElement("fieldset");try{return!!e(t)}catch(e){return false}finally{if(t.parentNode){t.parentNode.removeChild(t)}t=null}}function fe(e,t){var i=e.split("|"),n=i.length;while(n--){_.attrHandle[i[n]]=t}}function pe(e,t){var i=t&&e,n=i&&e.nodeType===1&&t.nodeType===1&&e.sourceIndex-t.sourceIndex;if(n){return n}if(i){while(i=i.nextSibling){if(i===t){return-1}}}return e?1:-1}function ge(i){return function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type===i}}function me(i){return function(e){var t=e.nodeName.toLowerCase();return(t==="input"||t==="button")&&e.type===i}}function ve(t){return function(e){if("form"in e){if(e.parentNode&&e.disabled===false){if("label"in e){if("label"in e.parentNode){return e.parentNode.disabled===t}else{return e.disabled===t}}return e.isDisabled===t||e.isDisabled!==!t&&he(e)===t}return e.disabled===t}else if("label"in e){return e.disabled===t}return false}}function I(s){return O(function(o){o=+o;return O(function(e,t){var i,n=s([],e.length,o),r=n.length;while(r--){if(e[i=n[r]]){e[i]=!(t[i]=e[i])}}})})}function ye(e){return e&&typeof e.getElementsByTagName!=="undefined"&&e}f=k.support={};F=k.isXML=function(e){var t=e.namespaceURI,i=(e.ownerDocument||e).documentElement;return!re.test(t||i&&i.nodeName||"HTML")};C=k.setDocument=function(e){var t,i,n=e?e.ownerDocument||e:u;if(n==x||n.nodeType!==9||!n.documentElement){return x}x=n;r=x.documentElement;S=!F(x);if(u!=x&&(i=x.defaultView)&&i.top!==i){if(i.addEventListener){i.addEventListener("unload",de,false)}else if(i.attachEvent){i.attachEvent("onunload",de)}}f.scope=N(function(e){r.appendChild(e).appendChild(x.createElement("div"));return typeof e.querySelectorAll!=="undefined"&&!e.querySelectorAll(":scope fieldset div").length});f.attributes=N(function(e){e.className="i";return!e.getAttribute("className")});f.getElementsByTagName=N(function(e){e.appendChild(x.createComment(""));return!e.getElementsByTagName("*").length});f.getElementsByClassName=D.test(x.getElementsByClassName);f.getById=N(function(e){r.appendChild(e).id=A;return!x.getElementsByName||!x.getElementsByName(A).length});if(f.getById){_.filter["ID"]=function(e){var t=e.replace(R,M);return function(e){return e.getAttribute("id")===t}};_.find["ID"]=function(e,t){if(typeof t.getElementById!=="undefined"&&S){var i=t.getElementById(e);return i?[i]:[]}}}else{_.filter["ID"]=function(e){var i=e.replace(R,M);return function(e){var t=typeof e.getAttributeNode!=="undefined"&&e.getAttributeNode("id");return t&&t.value===i}};_.find["ID"]=function(e,t){if(typeof t.getElementById!=="undefined"&&S){var i,n,r,o=t.getElementById(e);if(o){i=o.getAttributeNode("id");if(i&&i.value===e){return[o]}r=t.getElementsByName(e);n=0;while(o=r[n++]){i=o.getAttributeNode("id");if(i&&i.value===e){return[o]}}}return[]}}}_.find["TAG"]=f.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!=="undefined"){return t.getElementsByTagName(e)}else if(f.qsa){return t.querySelectorAll(e)}}:function(e,t){var i,n=[],r=0,o=t.getElementsByTagName(e);if(e==="*"){while(i=o[r++]){if(i.nodeType===1){n.push(i)}}return n}return o};_.find["CLASS"]=f.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!=="undefined"&&S){return t.getElementsByClassName(e)}};s=[];g=[];if(f.qsa=D.test(x.querySelectorAll)){N(function(e){var t;r.appendChild(e).innerHTML="<a id='"+A+"'></a>"+"<select id='"+A+"-\r\\' msallowcapture=''>"+"<option selected=''></option></select>";if(e.querySelectorAll("[msallowcapture^='']").length){g.push("[*^$]="+d+"*(?:''|\"\")")}if(!e.querySelectorAll("[selected]").length){g.push("\\["+d+"*(?:value|"+K+")")}if(!e.querySelectorAll("[id~="+A+"-]").length){g.push("~=")}t=x.createElement("input");t.setAttribute("name","");e.appendChild(t);if(!e.querySelectorAll("[name='']").length){g.push("\\["+d+"*name"+d+"*="+d+"*(?:''|\"\")")}if(!e.querySelectorAll(":checked").length){g.push(":checked")}if(!e.querySelectorAll("a#"+A+"+*").length){g.push(".#.+[+~]")}e.querySelectorAll("\\\f");g.push("[\\r\\n\\f]")});N(function(e){e.innerHTML="<a href='' disabled='disabled'></a>"+"<select disabled='disabled'><option/></select>";var t=x.createElement("input");t.setAttribute("type","hidden");e.appendChild(t).setAttribute("name","D");if(e.querySelectorAll("[name=d]").length){g.push("name"+d+"*[*^$|!~]?=")}if(e.querySelectorAll(":enabled").length!==2){g.push(":enabled",":disabled")}r.appendChild(e).disabled=true;if(e.querySelectorAll(":disabled").length!==2){g.push(":enabled",":disabled")}e.querySelectorAll("*,:x");g.push(",.*:")})}if(f.matchesSelector=D.test(a=r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.oMatchesSelector||r.msMatchesSelector)){N(function(e){f.disconnectedMatch=a.call(e,"*");a.call(e,"[s!='']:x");s.push("!=",Z)})}g=g.length&&new RegExp(g.join("|"));s=s.length&&new RegExp(s.join("|"));t=D.test(r.compareDocumentPosition);m=t||D.test(r.contains)?function(e,t){var i=e.nodeType===9?e.documentElement:e,n=t&&t.parentNode;return e===n||!!(n&&n.nodeType===1&&(i.contains?i.contains(n):e.compareDocumentPosition&&e.compareDocumentPosition(n)&16))}:function(e,t){if(t){while(t=t.parentNode){if(t===e){return true}}}return false};z=t?function(e,t){if(e===t){c=true;return 0}var i=!e.compareDocumentPosition-!t.compareDocumentPosition;if(i){return i}i=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1;if(i&1||!f.sortDetached&&t.compareDocumentPosition(e)===i){if(e==x||e.ownerDocument==u&&m(u,e)){return-1}if(t==x||t.ownerDocument==u&&m(u,t)){return 1}return l?y(l,e)-y(l,t):0}return i&4?-1:1}:function(e,t){if(e===t){c=true;return 0}var i,n=0,r=e.parentNode,o=t.parentNode,s=[e],a=[t];if(!r||!o){return e==x?-1:t==x?1:r?-1:o?1:l?y(l,e)-y(l,t):0}else if(r===o){return pe(e,t)}i=e;while(i=i.parentNode){s.unshift(i)}i=t;while(i=i.parentNode){a.unshift(i)}while(s[n]===a[n]){n++}return n?pe(s[n],a[n]):s[n]==u?-1:a[n]==u?1:0};return x};k.matches=function(e,t){return k(e,null,null,t)};k.matchesSelector=function(e,t){C(e);if(f.matchesSelector&&S&&!v[t+" "]&&(!s||!s.test(t))&&(!g||!g.test(t))){try{var i=a.call(e,t);if(i||f.disconnectedMatch||e.document&&e.document.nodeType!==11){return i}}catch(e){v(t,true)}}return k(t,x,null,[e]).length>0};k.contains=function(e,t){if((e.ownerDocument||e)!=x){C(e)}return m(e,t)};k.attr=function(e,t){if((e.ownerDocument||e)!=x){C(e)}var i=_.attrHandle[t.toLowerCase()],n=i&&W.call(_.attrHandle,t.toLowerCase())?i(e,t,!S):undefined;return n!==undefined?n:f.attributes||!S?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null};k.escape=function(e){return(e+"").replace(ce,ue)};k.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};k.uniqueSort=function(e){var t,i=[],n=0,r=0;c=!f.detectDuplicates;l=!f.sortStable&&e.slice(0);e.sort(z);if(c){while(t=e[r++]){if(t===e[r]){n=i.push(r)}}while(n--){e.splice(i[n],1)}}l=null;return e};o=k.getText=function(e){var t,i="",n=0,r=e.nodeType;if(!r){while(t=e[n++]){i+=o(t)}}else if(r===1||r===9||r===11){if(typeof e.textContent==="string"){return e.textContent}else{for(e=e.firstChild;e;e=e.nextSibling){i+=o(e)}}}else if(r===3||r===4){return e.nodeValue}return i};_=k.selectors={cacheLength:50,createPseudo:O,match:h,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[1]=e[1].replace(R,M);e[3]=(e[3]||e[4]||e[5]||"").replace(R,M);if(e[2]==="~="){e[3]=" "+e[3]+" "}return e.slice(0,4)},CHILD:function(e){e[1]=e[1].toLowerCase();if(e[1].slice(0,3)==="nth"){if(!e[3]){k.error(e[0])}e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd"));e[5]=+(e[7]+e[8]||e[3]==="odd")}else if(e[3]){k.error(e[0])}return e},PSEUDO:function(e){var t,i=!e[6]&&e[2];if(h["CHILD"].test(e[0])){return null}if(e[3]){e[2]=e[4]||e[5]||""}else if(i&&ie.test(i)&&(t=p(i,true))&&(t=i.indexOf(")",i.length-t)-i.length)){e[0]=e[0].slice(0,t);e[2]=i.slice(0,t)}return e.slice(0,3)}},filter:{TAG:function(e){var t=e.replace(R,M).toLowerCase();return e==="*"?function(){return true}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=B[e+" "];return t||(t=new RegExp("(^|"+d+")"+e+"("+d+"|$)"))&&B(e,function(e){return t.test(typeof e.className==="string"&&e.className||typeof e.getAttribute!=="undefined"&&e.getAttribute("class")||"")})},ATTR:function(i,n,r){return function(e){var t=k.attr(e,i);if(t==null){return n==="!="}if(!n){return true}t+="";return n==="="?t===r:n==="!="?t!==r:n==="^="?r&&t.indexOf(r)===0:n==="*="?r&&t.indexOf(r)>-1:n==="$="?r&&t.slice(-r.length)===r:n==="~="?(" "+t.replace(Q," ")+" ").indexOf(r)>-1:n==="|="?t===r||t.slice(0,r.length+1)===r+"-":false}},CHILD:function(p,e,t,g,m){var v=p.slice(0,3)!=="nth",y=p.slice(-4)!=="last",b=e==="of-type";return g===1&&m===0?function(e){return!!e.parentNode}:function(e,t,i){var n,r,o,s,a,l,c=v!==y?"nextSibling":"previousSibling",u=e.parentNode,d=b&&e.nodeName.toLowerCase(),h=!i&&!b,f=false;if(u){if(v){while(c){s=e;while(s=s[c]){if(b?s.nodeName.toLowerCase()===d:s.nodeType===1){return false}}l=c=p==="only"&&!l&&"nextSibling"}return true}l=[y?u.firstChild:u.lastChild];if(y&&h){s=u;o=s[A]||(s[A]={});r=o[s.uniqueID]||(o[s.uniqueID]={});n=r[p]||[];a=n[0]===E&&n[1];f=a&&n[2];s=a&&u.childNodes[a];while(s=++a&&s&&s[c]||(f=a=0)||l.pop()){if(s.nodeType===1&&++f&&s===e){r[p]=[E,a,f];break}}}else{if(h){s=e;o=s[A]||(s[A]={});r=o[s.uniqueID]||(o[s.uniqueID]={});n=r[p]||[];a=n[0]===E&&n[1];f=a}if(f===false){while(s=++a&&s&&s[c]||(f=a=0)||l.pop()){if((b?s.nodeName.toLowerCase()===d:s.nodeType===1)&&++f){if(h){o=s[A]||(s[A]={});r=o[s.uniqueID]||(o[s.uniqueID]={});r[p]=[E,f]}if(s===e){break}}}}}f-=m;return f===g||f%g===0&&f/g>=0}}},PSEUDO:function(e,o){var t,s=_.pseudos[e]||_.setFilters[e.toLowerCase()]||k.error("unsupported pseudo: "+e);if(s[A]){return s(o)}if(s.length>1){t=[e,e,"",o];return _.setFilters.hasOwnProperty(e.toLowerCase())?O(function(e,t){var i,n=s(e,o),r=n.length;while(r--){i=y(e,n[r]);e[i]=!(t[i]=n[r])}}):function(e){return s(e,0,t)}}return s}},pseudos:{not:O(function(e){var n=[],r=[],a=G(e.replace(b,"$1"));return a[A]?O(function(e,t,i,n){var r,o=a(e,null,n,[]),s=e.length;while(s--){if(r=o[s]){e[s]=!(t[s]=r)}}}):function(e,t,i){n[0]=e;a(n,null,i,r);n[0]=null;return!r.pop()}}),has:O(function(t){return function(e){return k(t,e).length>0}}),contains:O(function(t){t=t.replace(R,M);return function(e){return(e.textContent||o(e)).indexOf(t)>-1}}),lang:O(function(i){if(!ne.test(i||"")){k.error("unsupported lang: "+i)}i=i.replace(R,M).toLowerCase();return function(e){var t;do{if(t=S?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang")){t=t.toLowerCase();return t===i||t.indexOf(i+"-")===0}}while((e=e.parentNode)&&e.nodeType===1);return false}}),target:function(e){var t=P.location&&P.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===r},focus:function(e){return e===x.activeElement&&(!x.hasFocus||x.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ve(false),disabled:ve(true),checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){if(e.parentNode){e.parentNode.selectedIndex}return e.selected===true},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling){if(e.nodeType<6){return false}}return true},parent:function(e){return!_.pseudos["empty"](e)},header:function(e){return se.test(e.nodeName)},input:function(e){return oe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()==="text")},first:I(function(){return[0]}),last:I(function(e,t){return[t-1]}),eq:I(function(e,t,i){return[i<0?i+t:i]}),even:I(function(e,t){var i=0;for(;i<t;i+=2){e.push(i)}return e}),odd:I(function(e,t){var i=1;for(;i<t;i+=2){e.push(i)}return e}),lt:I(function(e,t,i){var n=i<0?i+t:i>t?t:i;for(;--n>=0;){e.push(n)}return e}),gt:I(function(e,t,i){var n=i<0?i+t:i;for(;++n<t;){e.push(n)}return e})}};_.pseudos["nth"]=_.pseudos["eq"];for(e in{radio:true,checkbox:true,file:true,password:true,image:true}){_.pseudos[e]=ge(e)}for(e in{submit:true,reset:true}){_.pseudos[e]=me(e)}function be(){}be.prototype=_.filters=_.pseudos;_.setFilters=new be;p=k.tokenize=function(e,t){var i,n,r,o,s,a,l,c=V[e+" "];if(c){return t?0:c.slice(0)}s=e;a=[];l=_.preFilter;while(s){if(!i||(n=J.exec(s))){if(n){s=s.slice(n[0].length)||s}a.push(r=[])}i=false;if(n=ee.exec(s)){i=n.shift();r.push({value:i,type:n[0].replace(b," ")});s=s.slice(i.length)}for(o in _.filter){if((n=h[o].exec(s))&&(!l[o]||(n=l[o](n)))){i=n.shift();r.push({value:i,type:o,matches:n});s=s.slice(i.length)}}if(!i){break}}return t?s.length:s?k.error(e):V(e,a).slice(0)};function L(e){var t=0,i=e.length,n="";for(;t<i;t++){n+=e[t].value}return n}function _e(a,e,t){var l=e.dir,c=e.next,u=c||l,d=t&&u==="parentNode",h=H++;return e.first?function(e,t,i){while(e=e[l]){if(e.nodeType===1||d){return a(e,t,i)}}return false}:function(e,t,i){var n,r,o,s=[E,h];if(i){while(e=e[l]){if(e.nodeType===1||d){if(a(e,t,i)){return true}}}}else{while(e=e[l]){if(e.nodeType===1||d){o=e[A]||(e[A]={});r=o[e.uniqueID]||(o[e.uniqueID]={});if(c&&c===e.nodeName.toLowerCase()){e=e[l]||e}else if((n=r[u])&&n[0]===E&&n[1]===h){return s[2]=n[2]}else{r[u]=s;if(s[2]=a(e,t,i)){return true}}}}}return false}}function we(r){return r.length>1?function(e,t,i){var n=r.length;while(n--){if(!r[n](e,t,i)){return false}}return true}:r[0]}function Ce(e,t,i){var n=0,r=t.length;for(;n<r;n++){k(e,t[n],i)}return i}function xe(e,t,i,n,r){var o,s=[],a=0,l=e.length,c=t!=null;for(;a<l;a++){if(o=e[a]){if(!i||i(o,n,r)){s.push(o);if(c){t.push(a)}}}}return s}function Se(f,p,g,m,v,e){if(m&&!m[A]){m=Se(m)}if(v&&!v[A]){v=Se(v,e)}return O(function(e,t,i,n){var r,o,s,a=[],l=[],c=t.length,u=e||Ce(p||"*",i.nodeType?[i]:i,[]),d=f&&(e||!p)?xe(u,a,f,i,n):u,h=g?v||(e?f:c||m)?[]:t:d;if(g){g(d,h,i,n)}if(m){r=xe(h,l);m(r,[],i,n);o=r.length;while(o--){if(s=r[o]){h[l[o]]=!(d[l[o]]=s)}}}if(e){if(v||f){if(v){r=[];o=h.length;while(o--){if(s=h[o]){r.push(d[o]=s)}}v(null,h=[],r,n)}o=h.length;while(o--){if((s=h[o])&&(r=v?y(e,s):a[o])>-1){e[r]=!(t[r]=s)}}}}else{h=xe(h===t?h.splice(c,h.length):h);if(v){v(null,t,h,n)}else{T.apply(t,h)}}})}function Ae(e){var r,t,i,n=e.length,o=_.relative[e[0].type],s=o||_.relative[" "],a=o?1:0,l=_e(function(e){return e===r},s,true),c=_e(function(e){return y(r,e)>-1},s,true),u=[function(e,t,i){var n=!o&&(i||t!==w)||((r=t).nodeType?l(e,t,i):c(e,t,i));r=null;return n}];for(;a<n;a++){if(t=_.relative[e[a].type]){u=[_e(we(u),t)]}else{t=_.filter[e[a].type].apply(null,e[a].matches);if(t[A]){i=++a;for(;i<n;i++){if(_.relative[e[i].type]){break}}return Se(a>1&&we(u),a>1&&L(e.slice(0,a-1).concat({value:e[a-2].type===" "?"*":""})).replace(b,"$1"),t,a<i&&Ae(e.slice(a,i)),i<n&&Ae(e=e.slice(i)),i<n&&L(e))}u.push(t)}}return we(u)}function Ee(m,v){var y=v.length>0,b=m.length>0,e=function(e,t,i,n,r){var o,s,a,l=0,c="0",u=e&&[],d=[],h=w,f=e||b&&_.find["TAG"]("*",r),p=E+=h==null?1:Math.random()||.1,g=f.length;if(r){w=t==x||t||r}for(;c!==g&&(o=f[c])!=null;c++){if(b&&o){s=0;if(!t&&o.ownerDocument!=x){C(o);i=!S}while(a=m[s++]){if(a(o,t||x,i)){n.push(o);break}}if(r){E=p}}if(y){if(o=!a&&o){l--}if(e){u.push(o)}}}l+=c;if(y&&c!==l){s=0;while(a=v[s++]){a(u,d,t,i)}if(e){if(l>0){while(c--){if(!(u[c]||d[c])){d[c]=U.call(n)}}}d=xe(d)}T.apply(n,d);if(r&&!e&&d.length>0&&l+v.length>1){k.uniqueSort(n)}}if(r){E=p;w=h}return u};return y?O(e):e}G=k.compile=function(e,t){var i,n=[],r=[],o=j[e+" "];if(!o){if(!t){t=p(e)}i=t.length;while(i--){o=Ae(t[i]);if(o[A]){n.push(o)}else{r.push(o)}}o=j(e,Ee(r,n));o.selector=e}return o};$=k.select=function(e,t,i,n){var r,o,s,a,l,c=typeof e==="function"&&e,u=!n&&p(e=c.selector||e);i=i||[];if(u.length===1){o=u[0]=u[0].slice(0);if(o.length>2&&(s=o[0]).type==="ID"&&t.nodeType===9&&S&&_.relative[o[1].type]){t=(_.find["ID"](s.matches[0].replace(R,M),t)||[])[0];if(!t){return i}else if(c){t=t.parentNode}e=e.slice(o.shift().value.length)}r=h["needsContext"].test(e)?0:o.length;while(r--){s=o[r];if(_.relative[a=s.type]){break}if(l=_.find[a]){if(n=l(s.matches[0].replace(R,M),le.test(o[0].type)&&ye(t.parentNode)||t)){o.splice(r,1);e=n.length&&L(o);if(!e){T.apply(i,n);return i}break}}}}(c||G(e,u))(n,t,!S,i,!t||le.test(e)&&ye(t.parentNode)||t);return i};f.sortStable=A.split("").sort(z).join("")===A;f.detectDuplicates=!!c;C();f.sortDetached=N(function(e){return e.compareDocumentPosition(x.createElement("fieldset"))&1});if(!N(function(e){e.innerHTML="<a href='#'></a>";return e.firstChild.getAttribute("href")==="#"})){fe("type|href|height|width",function(e,t,i){if(!i){return e.getAttribute(t,t.toLowerCase()==="type"?1:2)}})}if(!f.attributes||!N(function(e){e.innerHTML="<input/>";e.firstChild.setAttribute("value","");return e.firstChild.getAttribute("value")===""})){fe("value",function(e,t,i){if(!i&&e.nodeName.toLowerCase()==="input"){return e.defaultValue}})}if(!N(function(e){return e.getAttribute("disabled")==null})){fe(K,function(e,t,i){var n;if(!i){return e[t]===true?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}})}return k}(x);A.find=e;A.expr=e.selectors;A.expr[":"]=A.expr.pseudos;A.uniqueSort=A.unique=e.uniqueSort;A.text=e.getText;A.isXMLDoc=e.isXML;A.contains=e.contains;A.escapeSelector=e.escape;var n=function(e,t,i){var n=[],r=i!==undefined;while((e=e[t])&&e.nodeType!==9){if(e.nodeType===1){if(r&&A(e).is(i)){break}n.push(e)}}return n};var X=function(e,t){var i=[];for(;e;e=e.nextSibling){if(e.nodeType===1&&e!==t){i.push(e)}}return i};var Z=A.expr.match.needsContext;function c(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var Q=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function J(e,i,n){if(m(i)){return A.grep(e,function(e,t){return!!i.call(e,t,e)!==n})}if(i.nodeType){return A.grep(e,function(e){return e===i!==n})}if(typeof i!=="string"){return A.grep(e,function(e){return H.call(i,e)>-1!==n})}return A.filter(i,e,n)}A.filter=function(e,t,i){var n=t[0];if(i){e=":not("+e+")"}if(t.length===1&&n.nodeType===1){return A.find.matchesSelector(n,e)?[n]:[]}return A.find.matches(e,A.grep(t,function(e){return e.nodeType===1}))};A.fn.extend({find:function(e){var t,i,n=this.length,r=this;if(typeof e!=="string"){return this.pushStack(A(e).filter(function(){for(t=0;t<n;t++){if(A.contains(r[t],this)){return true}}}))}i=this.pushStack([]);for(t=0;t<n;t++){A.find(e,r[t],i)}return n>1?A.uniqueSort(i):i},filter:function(e){return this.pushStack(J(this,e||[],false))},not:function(e){return this.pushStack(J(this,e||[],true))},is:function(e){return!!J(this,typeof e==="string"&&Z.test(e)?A(e):e||[],false).length}});var ee,te=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,ie=A.fn.init=function(e,t,i){var n,r;if(!e){return this}i=i||ee;if(typeof e==="string"){if(e[0]==="<"&&e[e.length-1]===">"&&e.length>=3){n=[null,e,null]}else{n=te.exec(e)}if(n&&(n[1]||!t)){if(n[1]){t=t instanceof A?t[0]:t;A.merge(this,A.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:S,true));if(Q.test(n[1])&&A.isPlainObject(t)){for(n in t){if(m(this[n])){this[n](t[n])}else{this.attr(n,t[n])}}}return this}else{r=S.getElementById(n[2]);if(r){this[0]=r;this.length=1}return this}}else if(!t||t.jquery){return(t||i).find(e)}else{return this.constructor(t).find(e)}}else if(e.nodeType){this[0]=e;this.length=1;return this}else if(m(e)){return i.ready!==undefined?i.ready(e):e(A)}return A.makeArray(e,this)};ie.prototype=A.fn;ee=A(S);var ne=/^(?:parents|prev(?:Until|All))/,re={children:true,contents:true,next:true,prev:true};A.fn.extend({has:function(e){var t=A(e,this),i=t.length;return this.filter(function(){var e=0;for(;e<i;e++){if(A.contains(this,t[e])){return true}}})},closest:function(e,t){var i,n=0,r=this.length,o=[],s=typeof e!=="string"&&A(e);if(!Z.test(e)){for(;n<r;n++){for(i=this[n];i&&i!==t;i=i.parentNode){if(i.nodeType<11&&(s?s.index(i)>-1:i.nodeType===1&&A.find.matchesSelector(i,e))){o.push(i);break}}}}return this.pushStack(o.length>1?A.uniqueSort(o):o)},index:function(e){if(!e){return this[0]&&this[0].parentNode?this.first().prevAll().length:-1}if(typeof e==="string"){return H.call(A(e),this[0])}return H.call(this,e.jquery?e[0]:e)},add:function(e,t){return this.pushStack(A.uniqueSort(A.merge(this.get(),A(e,t))))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}});function oe(e,t){while((e=e[t])&&e.nodeType!==1){}return e}A.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return n(e,"parentNode")},parentsUntil:function(e,t,i){return n(e,"parentNode",i)},next:function(e){return oe(e,"nextSibling")},prev:function(e){return oe(e,"previousSibling")},nextAll:function(e){return n(e,"nextSibling")},prevAll:function(e){return n(e,"previousSibling")},nextUntil:function(e,t,i){return n(e,"nextSibling",i)},prevUntil:function(e,t,i){return n(e,"previousSibling",i)},siblings:function(e){return X((e.parentNode||{}).firstChild,e)},children:function(e){return X(e.firstChild)},contents:function(e){if(e.contentDocument!=null&&F(e.contentDocument)){return e.contentDocument}if(c(e,"template")){e=e.content||e}return A.merge([],e.childNodes)}},function(n,r){A.fn[n]=function(e,t){var i=A.map(this,r,e);if(n.slice(-5)!=="Until"){t=e}if(t&&typeof t==="string"){i=A.filter(t,i)}if(this.length>1){if(!re[n]){A.uniqueSort(i)}if(ne.test(n)){i.reverse()}}return this.pushStack(i)}});var E=/[^\x20\t\r\n\f]+/g;function se(e){var i={};A.each(e.match(E)||[],function(e,t){i[t]=true});return i}A.Callbacks=function(n){n=typeof n==="string"?se(n):A.extend({},n);var i,e,t,r,o=[],s=[],a=-1,l=function(){r=r||n.once;t=i=true;for(;s.length;a=-1){e=s.shift();while(++a<o.length){if(o[a].apply(e[0],e[1])===false&&n.stopOnFalse){a=o.length;e=false}}}if(!n.memory){e=false}i=false;if(r){if(e){o=[]}else{o=""}}},c={add:function(){if(o){if(e&&!i){a=o.length-1;s.push(e)}(function i(e){A.each(e,function(e,t){if(m(t)){if(!n.unique||!c.has(t)){o.push(t)}}else if(t&&t.length&&y(t)!=="string"){i(t)}})})(arguments);if(e&&!i){l()}}return this},remove:function(){A.each(arguments,function(e,t){var i;while((i=A.inArray(t,o,i))>-1){o.splice(i,1);if(i<=a){a--}}});return this},has:function(e){return e?A.inArray(e,o)>-1:o.length>0},empty:function(){if(o){o=[]}return this},disable:function(){r=s=[];o=e="";return this},disabled:function(){return!o},lock:function(){r=s=[];if(!e&&!i){o=e=""}return this},locked:function(){return!!r},fireWith:function(e,t){if(!r){t=t||[];t=[e,t.slice?t.slice():t];s.push(t);if(!i){l()}}return this},fire:function(){c.fireWith(this,arguments);return this},fired:function(){return!!t}};return c};function u(e){return e}function ae(e){throw e}function le(e,t,i,n){var r;try{if(e&&m(r=e.promise)){r.call(e).done(t).fail(i)}else if(e&&m(r=e.then)){r.call(e,t,i)}else{t.apply(undefined,[e].slice(n))}}catch(e){i.apply(undefined,[e])}}A.extend({Deferred:function(e){var o=[["notify","progress",A.Callbacks("memory"),A.Callbacks("memory"),2],["resolve","done",A.Callbacks("once memory"),A.Callbacks("once memory"),0,"resolved"],["reject","fail",A.Callbacks("once memory"),A.Callbacks("once memory"),1,"rejected"]],r="pending",s={state:function(){return r},always:function(){a.done(arguments).fail(arguments);return this},catch:function(e){return s.then(null,e)},pipe:function(){var r=arguments;return A.Deferred(function(n){A.each(o,function(e,t){var i=m(r[t[4]])&&r[t[4]];a[t[1]](function(){var e=i&&i.apply(this,arguments);if(e&&m(e.promise)){e.promise().progress(n.notify).done(n.resolve).fail(n.reject)}else{n[t[0]+"With"](this,i?[e]:arguments)}})});r=null}).promise()},then:function(t,i,n){var l=0;function c(r,o,s,a){return function(){var i=this,n=arguments,e=function(){var e,t;if(r<l){return}e=s.apply(i,n);if(e===o.promise()){throw new TypeError("Thenable self-resolution")}t=e&&(typeof e==="object"||typeof e==="function")&&e.then;if(m(t)){if(a){t.call(e,c(l,o,u,a),c(l,o,ae,a))}else{l++;t.call(e,c(l,o,u,a),c(l,o,ae,a),c(l,o,u,o.notifyWith))}}else{if(s!==u){i=undefined;n=[e]}(a||o.resolveWith)(i,n)}},t=a?e:function(){try{e()}catch(e){if(A.Deferred.exceptionHook){A.Deferred.exceptionHook(e,t.stackTrace)}if(r+1>=l){if(s!==ae){i=undefined;n=[e]}o.rejectWith(i,n)}}};if(r){t()}else{if(A.Deferred.getStackHook){t.stackTrace=A.Deferred.getStackHook()}x.setTimeout(t)}}}return A.Deferred(function(e){o[0][3].add(c(0,e,m(n)?n:u,e.notifyWith));o[1][3].add(c(0,e,m(t)?t:u));o[2][3].add(c(0,e,m(i)?i:ae))}).promise()},promise:function(e){return e!=null?A.extend(e,s):s}},a={};A.each(o,function(e,t){var i=t[2],n=t[5];s[t[1]]=i.add;if(n){i.add(function(){r=n},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock)}i.add(t[3].fire);a[t[0]]=function(){a[t[0]+"With"](this===a?undefined:this,arguments);return this};a[t[0]+"With"]=i.fireWith});s.promise(a);if(e){e.call(a,a)}return a},when:function(e){var i=arguments.length,t=i,n=Array(t),r=a.call(arguments),o=A.Deferred(),s=function(t){return function(e){n[t]=this;r[t]=arguments.length>1?a.call(arguments):e;if(!--i){o.resolveWith(n,r)}}};if(i<=1){le(e,o.done(s(t)).resolve,o.reject,!i);if(o.state()==="pending"||m(r[t]&&r[t].then)){return o.then()}}while(t--){le(r[t],s(t),o.reject)}return o.promise()}});var ce=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;A.Deferred.exceptionHook=function(e,t){if(x.console&&x.console.warn&&e&&ce.test(e.name)){x.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)}};A.readyException=function(e){x.setTimeout(function(){throw e})};var ue=A.Deferred();A.fn.ready=function(e){ue.then(e).catch(function(e){A.readyException(e)});return this};A.extend({isReady:false,readyWait:1,ready:function(e){if(e===true?--A.readyWait:A.isReady){return}A.isReady=true;if(e!==true&&--A.readyWait>0){return}ue.resolveWith(S,[A])}});A.ready.then=ue.then;function de(){S.removeEventListener("DOMContentLoaded",de);x.removeEventListener("load",de);A.ready()}if(S.readyState==="complete"||S.readyState!=="loading"&&!S.documentElement.doScroll){x.setTimeout(A.ready)}else{S.addEventListener("DOMContentLoaded",de);x.addEventListener("load",de)}var d=function(e,t,i,n,r,o,s){var a=0,l=e.length,c=i==null;if(y(i)==="object"){r=true;for(a in i){d(e,t,a,i[a],true,o,s)}}else if(n!==undefined){r=true;if(!m(n)){s=true}if(c){if(s){t.call(e,n);t=null}else{c=t;t=function(e,t,i){return c.call(A(e),i)}}}if(t){for(;a<l;a++){t(e[a],i,s?n:n.call(e[a],a,t(e[a],i)))}}}if(r){return e}if(c){return t.call(e)}return l?t(e[0],i):o};var he=/^-ms-/,fe=/-([a-z])/g;function pe(e,t){return t.toUpperCase()}function h(e){return e.replace(he,"ms-").replace(fe,pe)}var b=function(e){return e.nodeType===1||e.nodeType===9||!+e.nodeType};function i(){this.expando=A.expando+i.uid++}i.uid=1;i.prototype={cache:function(e){var t=e[this.expando];if(!t){t={};if(b(e)){if(e.nodeType){e[this.expando]=t}else{Object.defineProperty(e,this.expando,{value:t,configurable:true})}}}return t},set:function(e,t,i){var n,r=this.cache(e);if(typeof t==="string"){r[h(t)]=i}else{for(n in t){r[h(n)]=t[n]}}return r},get:function(e,t){return t===undefined?this.cache(e):e[this.expando]&&e[this.expando][h(t)]},access:function(e,t,i){if(t===undefined||t&&typeof t==="string"&&i===undefined){return this.get(e,t)}this.set(e,t,i);return i!==undefined?i:t},remove:function(e,t){var i,n=e[this.expando];if(n===undefined){return}if(t!==undefined){if(Array.isArray(t)){t=t.map(h)}else{t=h(t);t=t in n?[t]:t.match(E)||[]}i=t.length;while(i--){delete n[t[i]]}}if(t===undefined||A.isEmptyObject(n)){if(e.nodeType){e[this.expando]=undefined}else{delete e[this.expando]}}},hasData:function(e){var t=e[this.expando];return t!==undefined&&!A.isEmptyObject(t)}};var _=new i;var f=new i;var ge=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,me=/[A-Z]/g;function ve(e){if(e==="true"){return true}if(e==="false"){return false}if(e==="null"){return null}if(e===+e+""){return+e}if(ge.test(e)){return JSON.parse(e)}return e}function ye(e,t,i){var n;if(i===undefined&&e.nodeType===1){n="data-"+t.replace(me,"-$&").toLowerCase();i=e.getAttribute(n);if(typeof i==="string"){try{i=ve(i)}catch(e){}f.set(e,t,i)}else{i=undefined}}return i}A.extend({hasData:function(e){return f.hasData(e)||_.hasData(e)},data:function(e,t,i){return f.access(e,t,i)},removeData:function(e,t){f.remove(e,t)},_data:function(e,t,i){return _.access(e,t,i)},_removeData:function(e,t){_.remove(e,t)}});A.fn.extend({data:function(i,e){var t,n,r,o=this[0],s=o&&o.attributes;if(i===undefined){if(this.length){r=f.get(o);if(o.nodeType===1&&!_.get(o,"hasDataAttrs")){t=s.length;while(t--){if(s[t]){n=s[t].name;if(n.indexOf("data-")===0){n=h(n.slice(5));ye(o,n,r[n])}}}_.set(o,"hasDataAttrs",true)}}return r}if(typeof i==="object"){return this.each(function(){f.set(this,i)})}return d(this,function(e){var t;if(o&&e===undefined){t=f.get(o,i);if(t!==undefined){return t}t=ye(o,i);if(t!==undefined){return t}return}this.each(function(){f.set(this,i,e)})},null,e,arguments.length>1,null,true)},removeData:function(e){return this.each(function(){f.remove(this,e)})}});A.extend({queue:function(e,t,i){var n;if(e){t=(t||"fx")+"queue";n=_.get(e,t);if(i){if(!n||Array.isArray(i)){n=_.access(e,t,A.makeArray(i))}else{n.push(i)}}return n||[]}},dequeue:function(e,t){t=t||"fx";var i=A.queue(e,t),n=i.length,r=i.shift(),o=A._queueHooks(e,t),s=function(){A.dequeue(e,t)};if(r==="inprogress"){r=i.shift();n--}if(r){if(t==="fx"){i.unshift("inprogress")}delete o.stop;r.call(e,s,o)}if(!n&&o){o.empty.fire()}},_queueHooks:function(e,t){var i=t+"queueHooks";return _.get(e,i)||_.access(e,i,{empty:A.Callbacks("once memory").add(function(){_.remove(e,[t+"queue",i])})})}});A.fn.extend({queue:function(t,i){var e=2;if(typeof t!=="string"){i=t;t="fx";e--}if(arguments.length<e){return A.queue(this[0],t)}return i===undefined?this:this.each(function(){var e=A.queue(this,t,i);A._queueHooks(this,t);if(t==="fx"&&e[0]!=="inprogress"){A.dequeue(this,t)}})},dequeue:function(e){return this.each(function(){A.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,r=A.Deferred(),o=this,s=this.length,a=function(){if(!--n){r.resolveWith(o,[o])}};if(typeof e!=="string"){t=e;e=undefined}e=e||"fx";while(s--){i=_.get(o[s],e+"queueHooks");if(i&&i.empty){n++;i.empty.add(a)}}a();return r.promise(t)}});var be=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;var p=new RegExp("^(?:([+-])=|)("+be+")([a-z%]*)$","i");var w=["Top","Right","Bottom","Left"];var C=S.documentElement;var T=function(e){return A.contains(e.ownerDocument,e)},_e={composed:true};if(C.getRootNode){T=function(e){return A.contains(e.ownerDocument,e)||e.getRootNode(_e)===e.ownerDocument}}var we=function(e,t){e=t||e;return e.style.display==="none"||e.style.display===""&&T(e)&&A.css(e,"display")==="none"};function Ce(e,t,i,n){var r,o,s=20,a=n?function(){return n.cur()}:function(){return A.css(e,t,"")},l=a(),c=i&&i[3]||(A.cssNumber[t]?"":"px"),u=e.nodeType&&(A.cssNumber[t]||c!=="px"&&+l)&&p.exec(A.css(e,t));if(u&&u[3]!==c){l=l/2;c=c||u[3];u=+l||1;while(s--){A.style(e,t,u+c);if((1-o)*(1-(o=a()/l||.5))<=0){s=0}u=u/o}u=u*2;A.style(e,t,u+c);i=i||[]}if(i){u=+u||+l||0;r=i[1]?u+(i[1]+1)*i[2]:+i[2];if(n){n.unit=c;n.start=u;n.end=r}}return r}var xe={};function Se(e){var t,i=e.ownerDocument,n=e.nodeName,r=xe[n];if(r){return r}t=i.body.appendChild(i.createElement(n));r=A.css(t,"display");t.parentNode.removeChild(t);if(r==="none"){r="block"}xe[n]=r;return r}function D(e,t){var i,n,r=[],o=0,s=e.length;for(;o<s;o++){n=e[o];if(!n.style){continue}i=n.style.display;if(t){if(i==="none"){r[o]=_.get(n,"display")||null;if(!r[o]){n.style.display=""}}if(n.style.display===""&&we(n)){r[o]=Se(n)}}else{if(i!=="none"){r[o]="none";_.set(n,"display",i)}}}for(o=0;o<s;o++){if(r[o]!=null){e[o].style.display=r[o]}}return e}A.fn.extend({show:function(){return D(this,true)},hide:function(){return D(this)},toggle:function(e){if(typeof e==="boolean"){return e?this.show():this.hide()}return this.each(function(){if(we(this)){A(this).show()}else{A(this).hide()}})}});var r=/^(?:checkbox|radio)$/i;var Ae=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i;var Ee=/^$|^module$|\/(?:java|ecma)script/i;(function(){var e=S.createDocumentFragment(),t=e.appendChild(S.createElement("div")),i=S.createElement("input");i.setAttribute("type","radio");i.setAttribute("checked","checked");i.setAttribute("name","t");t.appendChild(i);g.checkClone=t.cloneNode(true).cloneNode(true).lastChild.checked;t.innerHTML="<textarea>x</textarea>";g.noCloneChecked=!!t.cloneNode(true).lastChild.defaultValue;t.innerHTML="<option></option>";g.option=!!t.lastChild})();var R={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};R.tbody=R.tfoot=R.colgroup=R.caption=R.thead;R.th=R.td;if(!g.option){R.optgroup=R.option=[1,"<select multiple='multiple'>","</select>"]}function M(e,t){var i;if(typeof e.getElementsByTagName!=="undefined"){i=e.getElementsByTagName(t||"*")}else if(typeof e.querySelectorAll!=="undefined"){i=e.querySelectorAll(t||"*")}else{i=[]}if(t===undefined||t&&c(e,t)){return A.merge([e],i)}return i}function Te(e,t){var i=0,n=e.length;for(;i<n;i++){_.set(e[i],"globalEval",!t||_.get(t[i],"globalEval"))}}var De=/<|&#?\w+;/;function Re(e,t,i,n,r){var o,s,a,l,c,u,d=t.createDocumentFragment(),h=[],f=0,p=e.length;for(;f<p;f++){o=e[f];if(o||o===0){if(y(o)==="object"){A.merge(h,o.nodeType?[o]:o)}else if(!De.test(o)){h.push(t.createTextNode(o))}else{s=s||d.appendChild(t.createElement("div"));a=(Ae.exec(o)||["",""])[1].toLowerCase();l=R[a]||R._default;s.innerHTML=l[1]+A.htmlPrefilter(o)+l[2];u=l[0];while(u--){s=s.lastChild}A.merge(h,s.childNodes);s=d.firstChild;s.textContent=""}}}d.textContent="";f=0;while(o=h[f++]){if(n&&A.inArray(o,n)>-1){if(r){r.push(o)}continue}c=T(o);s=M(d.appendChild(o),"script");if(c){Te(s)}if(i){u=0;while(o=s[u++]){if(Ee.test(o.type||"")){i.push(o)}}}}return d}var Me=/^key/,ke=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Oe=/^([^.]*)(?:\.(.+)|)/;function s(){return true}function l(){return false}function Ne(e,t){return e===Ie()===(t==="focus")}function Ie(){try{return S.activeElement}catch(e){}}function Le(e,t,i,n,r,o){var s,a;if(typeof t==="object"){if(typeof i!=="string"){n=n||i;i=undefined}for(a in t){Le(e,a,i,n,t[a],o)}return e}if(n==null&&r==null){r=i;n=i=undefined}else if(r==null){if(typeof i==="string"){r=n;n=undefined}else{r=n;n=i;i=undefined}}if(r===false){r=l}else if(!r){return e}if(o===1){s=r;r=function(e){A().off(e);return s.apply(this,arguments)};r.guid=s.guid||(s.guid=A.guid++)}return e.each(function(){A.event.add(this,t,r,n,i)})}A.event={global:{},add:function(t,e,i,n,r){var o,s,a,l,c,u,d,h,f,p,g,m=_.get(t);if(!b(t)){return}if(i.handler){o=i;i=o.handler;r=o.selector}if(r){A.find.matchesSelector(C,r)}if(!i.guid){i.guid=A.guid++}if(!(l=m.events)){l=m.events=Object.create(null)}if(!(s=m.handle)){s=m.handle=function(e){return typeof A!=="undefined"&&A.event.triggered!==e.type?A.event.dispatch.apply(t,arguments):undefined}}e=(e||"").match(E)||[""];c=e.length;while(c--){a=Oe.exec(e[c])||[];f=g=a[1];p=(a[2]||"").split(".").sort();if(!f){continue}d=A.event.special[f]||{};f=(r?d.delegateType:d.bindType)||f;d=A.event.special[f]||{};u=A.extend({type:f,origType:g,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&A.expr.match.needsContext.test(r),namespace:p.join(".")},o);if(!(h=l[f])){h=l[f]=[];h.delegateCount=0;if(!d.setup||d.setup.call(t,n,p,s)===false){if(t.addEventListener){t.addEventListener(f,s)}}}if(d.add){d.add.call(t,u);if(!u.handler.guid){u.handler.guid=i.guid}}if(r){h.splice(h.delegateCount++,0,u)}else{h.push(u)}A.event.global[f]=true}},remove:function(e,t,i,n,r){var o,s,a,l,c,u,d,h,f,p,g,m=_.hasData(e)&&_.get(e);if(!m||!(l=m.events)){return}t=(t||"").match(E)||[""];c=t.length;while(c--){a=Oe.exec(t[c])||[];f=g=a[1];p=(a[2]||"").split(".").sort();if(!f){for(f in l){A.event.remove(e,f+t[c],i,n,true)}continue}d=A.event.special[f]||{};f=(n?d.delegateType:d.bindType)||f;h=l[f]||[];a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)");s=o=h.length;while(o--){u=h[o];if((r||g===u.origType)&&(!i||i.guid===u.guid)&&(!a||a.test(u.namespace))&&(!n||n===u.selector||n==="**"&&u.selector)){h.splice(o,1);if(u.selector){h.delegateCount--}if(d.remove){d.remove.call(e,u)}}}if(s&&!h.length){if(!d.teardown||d.teardown.call(e,p,m.handle)===false){A.removeEvent(e,f,m.handle)}delete l[f]}}if(A.isEmptyObject(l)){_.remove(e,"handle events")}},dispatch:function(e){var t,i,n,r,o,s,a=new Array(arguments.length),l=A.event.fix(e),c=(_.get(this,"events")||Object.create(null))[l.type]||[],u=A.event.special[l.type]||{};a[0]=l;for(t=1;t<arguments.length;t++){a[t]=arguments[t]}l.delegateTarget=this;if(u.preDispatch&&u.preDispatch.call(this,l)===false){return}s=A.event.handlers.call(this,l,c);t=0;while((r=s[t++])&&!l.isPropagationStopped()){l.currentTarget=r.elem;i=0;while((o=r.handlers[i++])&&!l.isImmediatePropagationStopped()){if(!l.rnamespace||o.namespace===false||l.rnamespace.test(o.namespace)){l.handleObj=o;l.data=o.data;n=((A.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,a);if(n!==undefined){if((l.result=n)===false){l.preventDefault();l.stopPropagation()}}}}}if(u.postDispatch){u.postDispatch.call(this,l)}return l.result},handlers:function(e,t){var i,n,r,o,s,a=[],l=t.delegateCount,c=e.target;if(l&&c.nodeType&&!(e.type==="click"&&e.button>=1)){for(;c!==this;c=c.parentNode||this){if(c.nodeType===1&&!(e.type==="click"&&c.disabled===true)){o=[];s={};for(i=0;i<l;i++){n=t[i];r=n.selector+" ";if(s[r]===undefined){s[r]=n.needsContext?A(r,this).index(c)>-1:A.find(r,this,null,[c]).length}if(s[r]){o.push(n)}}if(o.length){a.push({elem:c,handlers:o})}}}}c=this;if(l<t.length){a.push({elem:c,handlers:t.slice(l)})}return a},addProp:function(t,e){Object.defineProperty(A.Event.prototype,t,{enumerable:true,configurable:true,get:m(e)?function(){if(this.originalEvent){return e(this.originalEvent)}}:function(){if(this.originalEvent){return this.originalEvent[t]}},set:function(e){Object.defineProperty(this,t,{enumerable:true,configurable:true,writable:true,value:e})}})},fix:function(e){return e[A.expando]?e:new A.Event(e)},special:{load:{noBubble:true},click:{setup:function(e){var t=this||e;if(r.test(t.type)&&t.click&&c(t,"input")){Pe(t,"click",s)}return false},trigger:function(e){var t=this||e;if(r.test(t.type)&&t.click&&c(t,"input")){Pe(t,"click")}return true},_default:function(e){var t=e.target;return r.test(t.type)&&t.click&&c(t,"input")&&_.get(t,"click")||c(t,"a")}},beforeunload:{postDispatch:function(e){if(e.result!==undefined&&e.originalEvent){e.originalEvent.returnValue=e.result}}}}};function Pe(e,r,o){if(!o){if(_.get(e,r)===undefined){A.event.add(e,r,s)}return}_.set(e,r,false);A.event.add(e,r,{namespace:false,handler:function(e){var t,i,n=_.get(this,r);if(e.isTrigger&1&&this[r]){if(!n.length){n=a.call(arguments);_.set(this,r,n);t=o(this,r);this[r]();i=_.get(this,r);if(n!==i||t){_.set(this,r,false)}else{i={}}if(n!==i){e.stopImmediatePropagation();e.preventDefault();return i.value}}else if((A.event.special[r]||{}).delegateType){e.stopPropagation()}}else if(n.length){_.set(this,r,{value:A.event.trigger(A.extend(n[0],A.Event.prototype),n.slice(1),this)});e.stopImmediatePropagation()}}})}A.removeEvent=function(e,t,i){if(e.removeEventListener){e.removeEventListener(t,i)}};A.Event=function(e,t){if(!(this instanceof A.Event)){return new A.Event(e,t)}if(e&&e.type){this.originalEvent=e;this.type=e.type;this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===undefined&&e.returnValue===false?s:l;this.target=e.target&&e.target.nodeType===3?e.target.parentNode:e.target;this.currentTarget=e.currentTarget;this.relatedTarget=e.relatedTarget}else{this.type=e}if(t){A.extend(this,t)}this.timeStamp=e&&e.timeStamp||Date.now();this[A.expando]=true};A.Event.prototype={constructor:A.Event,isDefaultPrevented:l,isPropagationStopped:l,isImmediatePropagationStopped:l,isSimulated:false,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=s;if(e&&!this.isSimulated){e.preventDefault()}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=s;if(e&&!this.isSimulated){e.stopPropagation()}},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=s;if(e&&!this.isSimulated){e.stopImmediatePropagation()}this.stopPropagation()}};A.each({altKey:true,bubbles:true,cancelable:true,changedTouches:true,ctrlKey:true,detail:true,eventPhase:true,metaKey:true,pageX:true,pageY:true,shiftKey:true,view:true,char:true,code:true,charCode:true,key:true,keyCode:true,button:true,buttons:true,clientX:true,clientY:true,offsetX:true,offsetY:true,pointerId:true,pointerType:true,screenX:true,screenY:true,targetTouches:true,toElement:true,touches:true,which:function(e){var t=e.button;if(e.which==null&&Me.test(e.type)){return e.charCode!=null?e.charCode:e.keyCode}if(!e.which&&t!==undefined&&ke.test(e.type)){if(t&1){return 1}if(t&2){return 3}if(t&4){return 2}return 0}return e.which}},A.event.addProp);A.each({focus:"focusin",blur:"focusout"},function(e,t){A.event.special[e]={setup:function(){Pe(this,e,Ne);return false},trigger:function(){Pe(this,e);return true},delegateType:t}});A.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,o){A.event.special[e]={delegateType:o,bindType:o,handle:function(e){var t,i=this,n=e.relatedTarget,r=e.handleObj;if(!n||n!==i&&!A.contains(i,n)){e.type=r.origType;t=r.handler.apply(this,arguments);e.type=o}return t}}});A.fn.extend({on:function(e,t,i,n){return Le(this,e,t,i,n)},one:function(e,t,i,n){return Le(this,e,t,i,n,1)},off:function(e,t,i){var n,r;if(e&&e.preventDefault&&e.handleObj){n=e.handleObj;A(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler);return this}if(typeof e==="object"){for(r in e){this.off(r,t,e[r])}return this}if(t===false||typeof t==="function"){i=t;t=undefined}if(i===false){i=l}return this.each(function(){A.event.remove(this,e,i,t)})}});var Fe=/<script|<style|<link/i,Ge=/checked\s*(?:[^=]|=\s*.checked.)/i,$e=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function He(e,t){if(c(e,"table")&&c(t.nodeType!==11?t:t.firstChild,"tr")){return A(e).children("tbody")[0]||e}return e}function Be(e){e.type=(e.getAttribute("type")!==null)+"/"+e.type;return e}function Ve(e){if((e.type||"").slice(0,5)==="true/"){e.type=e.type.slice(5)}else{e.removeAttribute("type")}return e}function je(e,t){var i,n,r,o,s,a,l;if(t.nodeType!==1){return}if(_.hasData(e)){o=_.get(e);l=o.events;if(l){_.remove(t,"handle events");for(r in l){for(i=0,n=l[r].length;i<n;i++){A.event.add(t,r,l[r][i])}}}}if(f.hasData(e)){s=f.access(e);a=A.extend({},s);f.set(t,a)}}function ze(e,t){var i=t.nodeName.toLowerCase();if(i==="input"&&r.test(e.type)){t.checked=e.checked}else if(i==="input"||i==="textarea"){t.defaultValue=e.defaultValue}}function k(i,n,r,o){n=G(n);var e,t,s,a,l,c,u=0,d=i.length,h=d-1,f=n[0],p=m(f);if(p||d>1&&typeof f==="string"&&!g.checkClone&&Ge.test(f)){return i.each(function(e){var t=i.eq(e);if(p){n[0]=f.call(this,e,t.html())}k(t,n,r,o)})}if(d){e=Re(n,i[0].ownerDocument,false,i,o);t=e.firstChild;if(e.childNodes.length===1){e=t}if(t||o){s=A.map(M(e,"script"),Be);a=s.length;for(;u<d;u++){l=e;if(u!==h){l=A.clone(l,true,true);if(a){A.merge(s,M(l,"script"))}}r.call(i[u],l,u)}if(a){c=s[s.length-1].ownerDocument;A.map(s,Ve);for(u=0;u<a;u++){l=s[u];if(Ee.test(l.type||"")&&!_.access(l,"globalEval")&&A.contains(c,l)){if(l.src&&(l.type||"").toLowerCase()!=="module"){if(A._evalUrl&&!l.noModule){A._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},c)}}else{Y(l.textContent.replace($e,""),l,c)}}}}}}return i}function We(e,t,i){var n,r=t?A.filter(t,e):e,o=0;for(;(n=r[o])!=null;o++){if(!i&&n.nodeType===1){A.cleanData(M(n))}if(n.parentNode){if(i&&T(n)){Te(M(n,"script"))}n.parentNode.removeChild(n)}}return e}A.extend({htmlPrefilter:function(e){return e},clone:function(e,t,i){var n,r,o,s,a=e.cloneNode(true),l=T(e);if(!g.noCloneChecked&&(e.nodeType===1||e.nodeType===11)&&!A.isXMLDoc(e)){s=M(a);o=M(e);for(n=0,r=o.length;n<r;n++){ze(o[n],s[n])}}if(t){if(i){o=o||M(e);s=s||M(a);for(n=0,r=o.length;n<r;n++){je(o[n],s[n])}}else{je(e,a)}}s=M(a,"script");if(s.length>0){Te(s,!l&&M(e,"script"))}return a},cleanData:function(e){var t,i,n,r=A.event.special,o=0;for(;(i=e[o])!==undefined;o++){if(b(i)){if(t=i[_.expando]){if(t.events){for(n in t.events){if(r[n]){A.event.remove(i,n)}else{A.removeEvent(i,n,t.handle)}}}i[_.expando]=undefined}if(i[f.expando]){i[f.expando]=undefined}}}}});A.fn.extend({detach:function(e){return We(this,e,true)},remove:function(e){return We(this,e)},text:function(e){return d(this,function(e){return e===undefined?A.text(this):this.empty().each(function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){this.textContent=e}})},null,e,arguments.length)},append:function(){return k(this,arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=He(this,e);t.appendChild(e)}})},prepend:function(){return k(this,arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=He(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return k(this,arguments,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this)}})},after:function(){return k(this,arguments,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this.nextSibling)}})},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){if(e.nodeType===1){A.cleanData(M(e,false));e.textContent=""}}return this},clone:function(e,t){e=e==null?false:e;t=t==null?e:t;return this.map(function(){return A.clone(this,e,t)})},html:function(e){return d(this,function(e){var t=this[0]||{},i=0,n=this.length;if(e===undefined&&t.nodeType===1){return t.innerHTML}if(typeof e==="string"&&!Fe.test(e)&&!R[(Ae.exec(e)||["",""])[1].toLowerCase()]){e=A.htmlPrefilter(e);try{for(;i<n;i++){t=this[i]||{};if(t.nodeType===1){A.cleanData(M(t,false));t.innerHTML=e}}t=0}catch(e){}}if(t){this.empty().append(e)}},null,e,arguments.length)},replaceWith:function(){var i=[];return k(this,arguments,function(e){var t=this.parentNode;if(A.inArray(this,i)<0){A.cleanData(M(this));if(t){t.replaceChild(e,this)}}},i)}});A.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,s){A.fn[e]=function(e){var t,i=[],n=A(e),r=n.length-1,o=0;for(;o<=r;o++){t=o===r?this:this.clone(true);A(n[o])[s](t);$.apply(i,t.get())}return this.pushStack(i)}});var Ue=new RegExp("^("+be+")(?!px)[a-z%]+$","i");var Ye=function(e){var t=e.ownerDocument.defaultView;if(!t||!t.opener){t=x}return t.getComputedStyle(e)};var qe=function(e,t,i){var n,r,o={};for(r in t){o[r]=e.style[r];e.style[r]=t[r]}n=i.call(e);for(r in t){e.style[r]=o[r]}return n};var Ke=new RegExp(w.join("|"),"i");(function(){function e(){if(!c){return}l.style.cssText="position:absolute;left:-11111px;width:60px;"+"margin-top:1px;padding:0;border:0";c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;"+"margin:auto;border:1px;padding:1px;"+"width:60%;top:1%";C.appendChild(l).appendChild(c);var e=x.getComputedStyle(c);i=e.top!=="1%";a=t(e.marginLeft)===12;c.style.right="60%";o=t(e.right)===36;n=t(e.width)===36;c.style.position="absolute";r=t(c.offsetWidth/3)===12;C.removeChild(l);c=null}function t(e){return Math.round(parseFloat(e))}var i,n,r,o,s,a,l=S.createElement("div"),c=S.createElement("div");if(!c.style){return}c.style.backgroundClip="content-box";c.cloneNode(true).style.backgroundClip="";g.clearCloneStyle=c.style.backgroundClip==="content-box";A.extend(g,{boxSizingReliable:function(){e();return n},pixelBoxStyles:function(){e();return o},pixelPosition:function(){e();return i},reliableMarginLeft:function(){e();return a},scrollboxSize:function(){e();return r},reliableTrDimensions:function(){var e,t,i,n;if(s==null){e=S.createElement("table");t=S.createElement("tr");i=S.createElement("div");e.style.cssText="position:absolute;left:-11111px";t.style.height="1px";i.style.height="9px";C.appendChild(e).appendChild(t).appendChild(i);n=x.getComputedStyle(t);s=parseInt(n.height)>3;C.removeChild(e)}return s}})})();function Xe(e,t,i){var n,r,o,s,a=e.style;i=i||Ye(e);if(i){s=i.getPropertyValue(t)||i[t];if(s===""&&!T(e)){s=A.style(e,t)}if(!g.pixelBoxStyles()&&Ue.test(s)&&Ke.test(t)){n=a.width;r=a.minWidth;o=a.maxWidth;a.minWidth=a.maxWidth=a.width=s;s=i.width;a.width=n;a.minWidth=r;a.maxWidth=o}}return s!==undefined?s+"":s}function Ze(e,t){return{get:function(){if(e()){delete this.get;return}return(this.get=t).apply(this,arguments)}}}var Qe=["Webkit","Moz","ms"],Je=S.createElement("div").style,et={};function tt(e){var t=e[0].toUpperCase()+e.slice(1),i=Qe.length;while(i--){e=Qe[i]+t;if(e in Je){return e}}}function it(e){var t=A.cssProps[e]||et[e];if(t){return t}if(e in Je){return e}return et[e]=tt(e)||e}var nt=/^(none|table(?!-c[ea]).+)/,rt=/^--/,ot={position:"absolute",visibility:"hidden",display:"block"},st={letterSpacing:"0",fontWeight:"400"};function at(e,t,i){var n=p.exec(t);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):t}function lt(e,t,i,n,r,o){var s=t==="width"?1:0,a=0,l=0;if(i===(n?"border":"content")){return 0}for(;s<4;s+=2){if(i==="margin"){l+=A.css(e,i+w[s],true,r)}if(!n){l+=A.css(e,"padding"+w[s],true,r);if(i!=="padding"){l+=A.css(e,"border"+w[s]+"Width",true,r)}else{a+=A.css(e,"border"+w[s]+"Width",true,r)}}else{if(i==="content"){l-=A.css(e,"padding"+w[s],true,r)}if(i!=="margin"){l-=A.css(e,"border"+w[s]+"Width",true,r)}}}if(!n&&o>=0){l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-l-a-.5))||0}return l}function ct(e,t,i){var n=Ye(e),r=!g.boxSizingReliable()||i,o=r&&A.css(e,"boxSizing",false,n)==="border-box",s=o,a=Xe(e,t,n),l="offset"+t[0].toUpperCase()+t.slice(1);if(Ue.test(a)){if(!i){return a}a="auto"}if((!g.boxSizingReliable()&&o||!g.reliableTrDimensions()&&c(e,"tr")||a==="auto"||!parseFloat(a)&&A.css(e,"display",false,n)==="inline")&&e.getClientRects().length){o=A.css(e,"boxSizing",false,n)==="border-box";s=l in e;if(s){a=e[l]}}a=parseFloat(a)||0;return a+lt(e,t,i||(o?"border":"content"),s,n,a)+"px"}A.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=Xe(e,"opacity");return i===""?"1":i}}}},cssNumber:{animationIterationCount:true,columnCount:true,fillOpacity:true,flexGrow:true,flexShrink:true,fontWeight:true,gridArea:true,gridColumn:true,gridColumnEnd:true,gridColumnStart:true,gridRow:true,gridRowEnd:true,gridRowStart:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{},style:function(e,t,i,n){if(!e||e.nodeType===3||e.nodeType===8||!e.style){return}var r,o,s,a=h(t),l=rt.test(t),c=e.style;if(!l){t=it(a)}s=A.cssHooks[t]||A.cssHooks[a];if(i!==undefined){o=typeof i;if(o==="string"&&(r=p.exec(i))&&r[1]){i=Ce(e,t,r);o="number"}if(i==null||i!==i){return}if(o==="number"&&!l){i+=r&&r[3]||(A.cssNumber[a]?"":"px")}if(!g.clearCloneStyle&&i===""&&t.indexOf("background")===0){c[t]="inherit"}if(!s||!("set"in s)||(i=s.set(e,i,n))!==undefined){if(l){c.setProperty(t,i)}else{c[t]=i}}}else{if(s&&"get"in s&&(r=s.get(e,false,n))!==undefined){return r}return c[t]}},css:function(e,t,i,n){var r,o,s,a=h(t),l=rt.test(t);if(!l){t=it(a)}s=A.cssHooks[t]||A.cssHooks[a];if(s&&"get"in s){r=s.get(e,true,i)}if(r===undefined){r=Xe(e,t,n)}if(r==="normal"&&t in st){r=st[t]}if(i===""||i){o=parseFloat(r);return i===true||isFinite(o)?o||0:r}return r}});A.each(["height","width"],function(e,c){A.cssHooks[c]={get:function(e,t,i){if(t){return nt.test(A.css(e,"display"))&&(!e.getClientRects().length||!e.getBoundingClientRect().width)?qe(e,ot,function(){return ct(e,c,i)}):ct(e,c,i)}},set:function(e,t,i){var n,r=Ye(e),o=!g.scrollboxSize()&&r.position==="absolute",s=o||i,a=s&&A.css(e,"boxSizing",false,r)==="border-box",l=i?lt(e,c,i,a,r):0;if(a&&o){l-=Math.ceil(e["offset"+c[0].toUpperCase()+c.slice(1)]-parseFloat(r[c])-lt(e,c,"border",false,r)-.5)}if(l&&(n=p.exec(t))&&(n[3]||"px")!=="px"){e.style[c]=t;t=A.css(e,c)}return at(e,t,l)}}});A.cssHooks.marginLeft=Ze(g.reliableMarginLeft,function(e,t){if(t){return(parseFloat(Xe(e,"marginLeft"))||e.getBoundingClientRect().left-qe(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}});A.each({margin:"",padding:"",border:"Width"},function(r,o){A.cssHooks[r+o]={expand:function(e){var t=0,i={},n=typeof e==="string"?e.split(" "):[e];for(;t<4;t++){i[r+w[t]+o]=n[t]||n[t-2]||n[0]}return i}};if(r!=="margin"){A.cssHooks[r+o].set=at}});A.fn.extend({css:function(e,t){return d(this,function(e,t,i){var n,r,o={},s=0;if(Array.isArray(t)){n=Ye(e);r=t.length;for(;s<r;s++){o[t[s]]=A.css(e,t[s],false,n)}return o}return i!==undefined?A.style(e,t,i):A.css(e,t)},e,t,arguments.length>1)}});function o(e,t,i,n,r){return new o.prototype.init(e,t,i,n,r)}A.Tween=o;o.prototype={constructor:o,init:function(e,t,i,n,r,o){this.elem=e;this.prop=i;this.easing=r||A.easing._default;this.options=t;this.start=this.now=this.cur();this.end=n;this.unit=o||(A.cssNumber[i]?"":"px")},cur:function(){var e=o.propHooks[this.prop];return e&&e.get?e.get(this):o.propHooks._default.get(this)},run:function(e){var t,i=o.propHooks[this.prop];if(this.options.duration){this.pos=t=A.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration)}else{this.pos=t=e}this.now=(this.end-this.start)*t+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(i&&i.set){i.set(this)}else{o.propHooks._default.set(this)}return this}};o.prototype.init.prototype=o.prototype;o.propHooks={_default:{get:function(e){var t;if(e.elem.nodeType!==1||e.elem[e.prop]!=null&&e.elem.style[e.prop]==null){return e.elem[e.prop]}t=A.css(e.elem,e.prop,"");return!t||t==="auto"?0:t},set:function(e){if(A.fx.step[e.prop]){A.fx.step[e.prop](e)}else if(e.elem.nodeType===1&&(A.cssHooks[e.prop]||e.elem.style[it(e.prop)]!=null)){A.style(e.elem,e.prop,e.now+e.unit)}else{e.elem[e.prop]=e.now}}}};o.propHooks.scrollTop=o.propHooks.scrollLeft={set:function(e){if(e.elem.nodeType&&e.elem.parentNode){e.elem[e.prop]=e.now}}};A.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"};A.fx=o.prototype.init;A.fx.step={};var O,ut,dt=/^(?:toggle|show|hide)$/,ht=/queueHooks$/;function ft(){if(ut){if(S.hidden===false&&x.requestAnimationFrame){x.requestAnimationFrame(ft)}else{x.setTimeout(ft,A.fx.interval)}A.fx.tick()}}function pt(){x.setTimeout(function(){O=undefined});return O=Date.now()}function gt(e,t){var i,n=0,r={height:e};t=t?1:0;for(;n<4;n+=2-t){i=w[n];r["margin"+i]=r["padding"+i]=e}if(t){r.opacity=r.width=e}return r}function mt(e,t,i){var n,r=(N.tweeners[t]||[]).concat(N.tweeners["*"]),o=0,s=r.length;for(;o<s;o++){if(n=r[o].call(i,t,e)){return n}}}function vt(e,t,i){var n,r,o,s,a,l,c,u,d="width"in t||"height"in t,h=this,f={},p=e.style,g=e.nodeType&&we(e),m=_.get(e,"fxshow");if(!i.queue){s=A._queueHooks(e,"fx");if(s.unqueued==null){s.unqueued=0;a=s.empty.fire;s.empty.fire=function(){if(!s.unqueued){a()}}}s.unqueued++;h.always(function(){h.always(function(){s.unqueued--;if(!A.queue(e,"fx").length){s.empty.fire()}})})}for(n in t){r=t[n];if(dt.test(r)){delete t[n];o=o||r==="toggle";if(r===(g?"hide":"show")){if(r==="show"&&m&&m[n]!==undefined){g=true}else{continue}}f[n]=m&&m[n]||A.style(e,n)}}l=!A.isEmptyObject(t);if(!l&&A.isEmptyObject(f)){return}if(d&&e.nodeType===1){i.overflow=[p.overflow,p.overflowX,p.overflowY];c=m&&m.display;if(c==null){c=_.get(e,"display")}u=A.css(e,"display");if(u==="none"){if(c){u=c}else{D([e],true);c=e.style.display||c;u=A.css(e,"display");D([e])}}if(u==="inline"||u==="inline-block"&&c!=null){if(A.css(e,"float")==="none"){if(!l){h.done(function(){p.display=c});if(c==null){u=p.display;c=u==="none"?"":u}}p.display="inline-block"}}}if(i.overflow){p.overflow="hidden";h.always(function(){p.overflow=i.overflow[0];p.overflowX=i.overflow[1];p.overflowY=i.overflow[2]})}l=false;for(n in f){if(!l){if(m){if("hidden"in m){g=m.hidden}}else{m=_.access(e,"fxshow",{display:c})}if(o){m.hidden=!g}if(g){D([e],true)}h.done(function(){if(!g){D([e])}_.remove(e,"fxshow");for(n in f){A.style(e,n,f[n])}})}l=mt(g?m[n]:0,n,h);if(!(n in m)){m[n]=l.start;if(g){l.end=l.start;l.start=0}}}}function yt(e,t){var i,n,r,o,s;for(i in e){n=h(i);r=t[n];o=e[i];if(Array.isArray(o)){r=o[1];o=e[i]=o[0]}if(i!==n){e[n]=o;delete e[i]}s=A.cssHooks[n];if(s&&"expand"in s){o=s.expand(o);delete e[n];for(i in o){if(!(i in e)){e[i]=o[i];t[i]=r}}}else{t[n]=r}}}function N(s,e,t){var i,a,n=0,r=N.prefilters.length,l=A.Deferred().always(function(){delete o.elem}),o=function(){if(a){return false}var e=O||pt(),t=Math.max(0,c.startTime+c.duration-e),i=t/c.duration||0,n=1-i,r=0,o=c.tweens.length;for(;r<o;r++){c.tweens[r].run(n)}l.notifyWith(s,[c,n,t]);if(n<1&&o){return t}if(!o){l.notifyWith(s,[c,1,0])}l.resolveWith(s,[c]);return false},c=l.promise({elem:s,props:A.extend({},e),opts:A.extend(true,{specialEasing:{},easing:A.easing._default},t),originalProperties:e,originalOptions:t,startTime:O||pt(),duration:t.duration,tweens:[],createTween:function(e,t){var i=A.Tween(s,c.opts,e,t,c.opts.specialEasing[e]||c.opts.easing);c.tweens.push(i);return i},stop:function(e){var t=0,i=e?c.tweens.length:0;if(a){return this}a=true;for(;t<i;t++){c.tweens[t].run(1)}if(e){l.notifyWith(s,[c,1,0]);l.resolveWith(s,[c,e])}else{l.rejectWith(s,[c,e])}return this}}),u=c.props;yt(u,c.opts.specialEasing);for(;n<r;n++){i=N.prefilters[n].call(c,s,u,c.opts);if(i){if(m(i.stop)){A._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)}return i}}A.map(u,mt,c);if(m(c.opts.start)){c.opts.start.call(s,c)}c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always);A.fx.timer(A.extend(o,{elem:s,anim:c,queue:c.opts.queue}));return c}A.Animation=A.extend(N,{tweeners:{"*":[function(e,t){var i=this.createTween(e,t);Ce(i.elem,e,p.exec(t),i);return i}]},tweener:function(e,t){if(m(e)){t=e;e=["*"]}else{e=e.match(E)}var i,n=0,r=e.length;for(;n<r;n++){i=e[n];N.tweeners[i]=N.tweeners[i]||[];N.tweeners[i].unshift(t)}},prefilters:[vt],prefilter:function(e,t){if(t){N.prefilters.unshift(e)}else{N.prefilters.push(e)}}});A.speed=function(e,t,i){var n=e&&typeof e==="object"?A.extend({},e):{complete:i||!i&&t||m(e)&&e,duration:e,easing:i&&t||t&&!m(t)&&t};if(A.fx.off){n.duration=0}else{if(typeof n.duration!=="number"){if(n.duration in A.fx.speeds){n.duration=A.fx.speeds[n.duration]}else{n.duration=A.fx.speeds._default}}}if(n.queue==null||n.queue===true){n.queue="fx"}n.old=n.complete;n.complete=function(){if(m(n.old)){n.old.call(this)}if(n.queue){A.dequeue(this,n.queue)}};return n};A.fn.extend({fadeTo:function(e,t,i,n){return this.filter(we).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(t,e,i,n){var r=A.isEmptyObject(t),o=A.speed(e,i,n),s=function(){var e=N(this,A.extend({},t),o);if(r||_.get(this,"finish")){e.stop(true)}};s.finish=s;return r||o.queue===false?this.each(s):this.queue(o.queue,s)},stop:function(r,e,o){var s=function(e){var t=e.stop;delete e.stop;t(o)};if(typeof r!=="string"){o=e;e=r;r=undefined}if(e){this.queue(r||"fx",[])}return this.each(function(){var e=true,t=r!=null&&r+"queueHooks",i=A.timers,n=_.get(this);if(t){if(n[t]&&n[t].stop){s(n[t])}}else{for(t in n){if(n[t]&&n[t].stop&&ht.test(t)){s(n[t])}}}for(t=i.length;t--;){if(i[t].elem===this&&(r==null||i[t].queue===r)){i[t].anim.stop(o);e=false;i.splice(t,1)}}if(e||!o){A.dequeue(this,r)}})},finish:function(s){if(s!==false){s=s||"fx"}return this.each(function(){var e,t=_.get(this),i=t[s+"queue"],n=t[s+"queueHooks"],r=A.timers,o=i?i.length:0;t.finish=true;A.queue(this,s,[]);if(n&&n.stop){n.stop.call(this,true)}for(e=r.length;e--;){if(r[e].elem===this&&r[e].queue===s){r[e].anim.stop(true);r.splice(e,1)}}for(e=0;e<o;e++){if(i[e]&&i[e].finish){i[e].finish.call(this)}}delete t.finish})}});A.each(["toggle","show","hide"],function(e,n){var r=A.fn[n];A.fn[n]=function(e,t,i){return e==null||typeof e==="boolean"?r.apply(this,arguments):this.animate(gt(n,true),e,t,i)}});A.each({slideDown:gt("show"),slideUp:gt("hide"),slideToggle:gt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,n){A.fn[e]=function(e,t,i){return this.animate(n,e,t,i)}});A.timers=[];A.fx.tick=function(){var e,t=0,i=A.timers;O=Date.now();for(;t<i.length;t++){e=i[t];if(!e()&&i[t]===e){i.splice(t--,1)}}if(!i.length){A.fx.stop()}O=undefined};A.fx.timer=function(e){A.timers.push(e);A.fx.start()};A.fx.interval=13;A.fx.start=function(){if(ut){return}ut=true;ft()};A.fx.stop=function(){ut=null};A.fx.speeds={slow:600,fast:200,_default:400};A.fn.delay=function(n,e){n=A.fx?A.fx.speeds[n]||n:n;e=e||"fx";return this.queue(e,function(e,t){var i=x.setTimeout(e,n);t.stop=function(){x.clearTimeout(i)}})};(function(){var e=S.createElement("input"),t=S.createElement("select"),i=t.appendChild(S.createElement("option"));e.type="checkbox";g.checkOn=e.value!=="";g.optSelected=i.selected;e=S.createElement("input");e.value="t";e.type="radio";g.radioValue=e.value==="t"})();var bt,_t=A.expr.attrHandle;A.fn.extend({attr:function(e,t){return d(this,A.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){A.removeAttr(this,e)})}});A.extend({attr:function(e,t,i){var n,r,o=e.nodeType;if(o===3||o===8||o===2){return}if(typeof e.getAttribute==="undefined"){return A.prop(e,t,i)}if(o!==1||!A.isXMLDoc(e)){r=A.attrHooks[t.toLowerCase()]||(A.expr.match.bool.test(t)?bt:undefined)}if(i!==undefined){if(i===null){A.removeAttr(e,t);return}if(r&&"set"in r&&(n=r.set(e,i,t))!==undefined){return n}e.setAttribute(t,i+"");return i}if(r&&"get"in r&&(n=r.get(e,t))!==null){return n}n=A.find.attr(e,t);return n==null?undefined:n},attrHooks:{type:{set:function(e,t){if(!g.radioValue&&t==="radio"&&c(e,"input")){var i=e.value;e.setAttribute("type",t);if(i){e.value=i}return t}}}},removeAttr:function(e,t){var i,n=0,r=t&&t.match(E);if(r&&e.nodeType===1){while(i=r[n++]){e.removeAttribute(i)}}}});bt={set:function(e,t,i){if(t===false){A.removeAttr(e,i)}else{e.setAttribute(i,i)}return i}};A.each(A.expr.match.bool.source.match(/\w+/g),function(e,t){var s=_t[t]||A.find.attr;_t[t]=function(e,t,i){var n,r,o=t.toLowerCase();if(!i){r=_t[o];_t[o]=n;n=s(e,t,i)!=null?o:null;_t[o]=r}return n}});var wt=/^(?:input|select|textarea|button)$/i,Ct=/^(?:a|area)$/i;A.fn.extend({prop:function(e,t){return d(this,A.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[A.propFix[e]||e]})}});A.extend({prop:function(e,t,i){var n,r,o=e.nodeType;if(o===3||o===8||o===2){return}if(o!==1||!A.isXMLDoc(e)){t=A.propFix[t]||t;r=A.propHooks[t]}if(i!==undefined){if(r&&"set"in r&&(n=r.set(e,i,t))!==undefined){return n}return e[t]=i}if(r&&"get"in r&&(n=r.get(e,t))!==null){return n}return e[t]},propHooks:{tabIndex:{get:function(e){var t=A.find.attr(e,"tabindex");if(t){return parseInt(t,10)}if(wt.test(e.nodeName)||Ct.test(e.nodeName)&&e.href){return 0}return-1}}},propFix:{for:"htmlFor",class:"className"}});if(!g.optSelected){A.propHooks.selected={get:function(e){var t=e.parentNode;if(t&&t.parentNode){t.parentNode.selectedIndex}return null},set:function(e){var t=e.parentNode;if(t){t.selectedIndex;if(t.parentNode){t.parentNode.selectedIndex}}}}}A.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){A.propFix[this.toLowerCase()]=this});function I(e){var t=e.match(E)||[];return t.join(" ")}function L(e){return e.getAttribute&&e.getAttribute("class")||""}function xt(e){if(Array.isArray(e)){return e}if(typeof e==="string"){return e.match(E)||[]}return[]}A.fn.extend({addClass:function(t){var e,i,n,r,o,s,a,l=0;if(m(t)){return this.each(function(e){A(this).addClass(t.call(this,e,L(this)))})}e=xt(t);if(e.length){while(i=this[l++]){r=L(i);n=i.nodeType===1&&" "+I(r)+" ";if(n){s=0;while(o=e[s++]){if(n.indexOf(" "+o+" ")<0){n+=o+" "}}a=I(n);if(r!==a){i.setAttribute("class",a)}}}}return this},removeClass:function(t){var e,i,n,r,o,s,a,l=0;if(m(t)){return this.each(function(e){A(this).removeClass(t.call(this,e,L(this)))})}if(!arguments.length){return this.attr("class","")}e=xt(t);if(e.length){while(i=this[l++]){r=L(i);n=i.nodeType===1&&" "+I(r)+" ";if(n){s=0;while(o=e[s++]){while(n.indexOf(" "+o+" ")>-1){n=n.replace(" "+o+" "," ")}}a=I(n);if(r!==a){i.setAttribute("class",a)}}}}return this},toggleClass:function(r,t){var o=typeof r,s=o==="string"||Array.isArray(r);if(typeof t==="boolean"&&s){return t?this.addClass(r):this.removeClass(r)}if(m(r)){return this.each(function(e){A(this).toggleClass(r.call(this,e,L(this),t),t)})}return this.each(function(){var e,t,i,n;if(s){t=0;i=A(this);n=xt(r);while(e=n[t++]){if(i.hasClass(e)){i.removeClass(e)}else{i.addClass(e)}}}else if(r===undefined||o==="boolean"){e=L(this);if(e){_.set(this,"__className__",e)}if(this.setAttribute){this.setAttribute("class",e||r===false?"":_.get(this,"__className__")||"")}}})},hasClass:function(e){var t,i,n=0;t=" "+e+" ";while(i=this[n++]){if(i.nodeType===1&&(" "+I(L(i))+" ").indexOf(t)>-1){return true}}return false}});var St=/\r/g;A.fn.extend({val:function(i){var n,e,r,t=this[0];if(!arguments.length){if(t){n=A.valHooks[t.type]||A.valHooks[t.nodeName.toLowerCase()];if(n&&"get"in n&&(e=n.get(t,"value"))!==undefined){return e}e=t.value;if(typeof e==="string"){return e.replace(St,"")}return e==null?"":e}return}r=m(i);return this.each(function(e){var t;if(this.nodeType!==1){return}if(r){t=i.call(this,e,A(this).val())}else{t=i}if(t==null){t=""}else if(typeof t==="number"){t+=""}else if(Array.isArray(t)){t=A.map(t,function(e){return e==null?"":e+""})}n=A.valHooks[this.type]||A.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,t,"value")===undefined){this.value=t}})}});A.extend({valHooks:{option:{get:function(e){var t=A.find.attr(e,"value");return t!=null?t:I(A.text(e))}},select:{get:function(e){var t,i,n,r=e.options,o=e.selectedIndex,s=e.type==="select-one",a=s?null:[],l=s?o+1:r.length;if(o<0){n=l}else{n=s?o:0}for(;n<l;n++){i=r[n];if((i.selected||n===o)&&!i.disabled&&(!i.parentNode.disabled||!c(i.parentNode,"optgroup"))){t=A(i).val();if(s){return t}a.push(t)}}return a},set:function(e,t){var i,n,r=e.options,o=A.makeArray(t),s=r.length;while(s--){n=r[s];if(n.selected=A.inArray(A.valHooks.option.get(n),o)>-1){i=true}}if(!i){e.selectedIndex=-1}return o}}}});A.each(["radio","checkbox"],function(){A.valHooks[this]={set:function(e,t){if(Array.isArray(t)){return e.checked=A.inArray(A(e).val(),t)>-1}}};if(!g.checkOn){A.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value}}});g.focusin="onfocusin"in x;var At=/^(?:focusinfocus|focusoutblur)$/,Et=function(e){e.stopPropagation()};A.extend(A.event,{trigger:function(e,t,i,n){var r,o,s,a,l,c,u,d,h=[i||S],f=j.call(e,"type")?e.type:e,p=j.call(e,"namespace")?e.namespace.split("."):[];o=d=s=i=i||S;if(i.nodeType===3||i.nodeType===8){return}if(At.test(f+A.event.triggered)){return}if(f.indexOf(".")>-1){p=f.split(".");f=p.shift();p.sort()}l=f.indexOf(":")<0&&"on"+f;e=e[A.expando]?e:new A.Event(f,typeof e==="object"&&e);e.isTrigger=n?2:3;e.namespace=p.join(".");e.rnamespace=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;e.result=undefined;if(!e.target){e.target=i}t=t==null?[e]:A.makeArray(t,[e]);u=A.event.special[f]||{};if(!n&&u.trigger&&u.trigger.apply(i,t)===false){return}if(!n&&!u.noBubble&&!v(i)){a=u.delegateType||f;if(!At.test(a+f)){o=o.parentNode}for(;o;o=o.parentNode){h.push(o);s=o}if(s===(i.ownerDocument||S)){h.push(s.defaultView||s.parentWindow||x)}}r=0;while((o=h[r++])&&!e.isPropagationStopped()){d=o;e.type=r>1?a:u.bindType||f;c=(_.get(o,"events")||Object.create(null))[e.type]&&_.get(o,"handle");if(c){c.apply(o,t)}c=l&&o[l];if(c&&c.apply&&b(o)){e.result=c.apply(o,t);if(e.result===false){e.preventDefault()}}}e.type=f;if(!n&&!e.isDefaultPrevented()){if((!u._default||u._default.apply(h.pop(),t)===false)&&b(i)){if(l&&m(i[f])&&!v(i)){s=i[l];if(s){i[l]=null}A.event.triggered=f;if(e.isPropagationStopped()){d.addEventListener(f,Et)}i[f]();if(e.isPropagationStopped()){d.removeEventListener(f,Et)}A.event.triggered=undefined;if(s){i[l]=s}}}}return e.result},simulate:function(e,t,i){var n=A.extend(new A.Event,i,{type:e,isSimulated:true});A.event.trigger(n,null,t)}});A.fn.extend({trigger:function(e,t){return this.each(function(){A.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i){return A.event.trigger(e,t,i,true)}}});if(!g.focusin){A.each({focus:"focusin",blur:"focusout"},function(i,n){var r=function(e){A.event.simulate(n,e.target,A.event.fix(e))};A.event.special[n]={setup:function(){var e=this.ownerDocument||this.document||this,t=_.access(e,n);if(!t){e.addEventListener(i,r,true)}_.access(e,n,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=_.access(e,n)-1;if(!t){e.removeEventListener(i,r,true);_.remove(e,n)}else{_.access(e,n,t)}}}})}var Tt=x.location;var Dt={guid:Date.now()};var Rt=/\?/;A.parseXML=function(e){var t;if(!e||typeof e!=="string"){return null}try{t=(new x.DOMParser).parseFromString(e,"text/xml")}catch(e){t=undefined}if(!t||t.getElementsByTagName("parsererror").length){A.error("Invalid XML: "+e)}return t};var Mt=/\[\]$/,kt=/\r?\n/g,Ot=/^(?:submit|button|image|reset|file)$/i,Nt=/^(?:input|select|textarea|keygen)/i;function It(i,e,n,r){var t;if(Array.isArray(e)){A.each(e,function(e,t){if(n||Mt.test(i)){r(i,t)}else{It(i+"["+(typeof t==="object"&&t!=null?e:"")+"]",t,n,r)}})}else if(!n&&y(e)==="object"){for(t in e){It(i+"["+t+"]",e[t],n,r)}}else{r(i,e)}}A.param=function(e,t){var i,n=[],r=function(e,t){var i=m(t)?t():t;n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(i==null?"":i)};if(e==null){return""}if(Array.isArray(e)||e.jquery&&!A.isPlainObject(e)){A.each(e,function(){r(this.name,this.value)})}else{for(i in e){It(i,e[i],t,r)}}return n.join("&")};A.fn.extend({serialize:function(){return A.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=A.prop(this,"elements");return e?A.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!A(this).is(":disabled")&&Nt.test(this.nodeName)&&!Ot.test(e)&&(this.checked||!r.test(e))}).map(function(e,t){var i=A(this).val();if(i==null){return null}if(Array.isArray(i)){return A.map(i,function(e){return{name:t.name,value:e.replace(kt,"\r\n")}})}return{name:t.name,value:i.replace(kt,"\r\n")}}).get()}});var Lt=/%20/g,Pt=/#.*$/,Ft=/([?&])_=[^&]*/,Gt=/^(.*?):[ \t]*([^\r\n]*)$/gm,$t=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ht=/^(?:GET|HEAD)$/,Bt=/^\/\//,Vt={},jt={},zt="*/".concat("*"),Wt=S.createElement("a");Wt.href=Tt.href;function Ut(o){return function(e,t){if(typeof e!=="string"){t=e;e="*"}var i,n=0,r=e.toLowerCase().match(E)||[];if(m(t)){while(i=r[n++]){if(i[0]==="+"){i=i.slice(1)||"*";(o[i]=o[i]||[]).unshift(t)}else{(o[i]=o[i]||[]).push(t)}}}}}function Yt(t,r,o,s){var a={},l=t===jt;function c(e){var n;a[e]=true;A.each(t[e]||[],function(e,t){var i=t(r,o,s);if(typeof i==="string"&&!l&&!a[i]){r.dataTypes.unshift(i);c(i);return false}else if(l){return!(n=i)}});return n}return c(r.dataTypes[0])||!a["*"]&&c("*")}function qt(e,t){var i,n,r=A.ajaxSettings.flatOptions||{};for(i in t){if(t[i]!==undefined){(r[i]?e:n||(n={}))[i]=t[i]}}if(n){A.extend(true,e,n)}return e}function Kt(e,t,i){var n,r,o,s,a=e.contents,l=e.dataTypes;while(l[0]==="*"){l.shift();if(n===undefined){n=e.mimeType||t.getResponseHeader("Content-Type")}}if(n){for(r in a){if(a[r]&&a[r].test(n)){l.unshift(r);break}}}if(l[0]in i){o=l[0]}else{for(r in i){if(!l[0]||e.converters[r+" "+l[0]]){o=r;break}if(!s){s=r}}o=o||s}if(o){if(o!==l[0]){l.unshift(o)}return i[o]}}function Xt(e,t,i,n){var r,o,s,a,l,c={},u=e.dataTypes.slice();if(u[1]){for(s in e.converters){c[s.toLowerCase()]=e.converters[s]}}o=u.shift();while(o){if(e.responseFields[o]){i[e.responseFields[o]]=t}if(!l&&n&&e.dataFilter){t=e.dataFilter(t,e.dataType)}l=o;o=u.shift();if(o){if(o==="*"){o=l}else if(l!=="*"&&l!==o){s=c[l+" "+o]||c["* "+o];if(!s){for(r in c){a=r.split(" ");if(a[1]===o){s=c[l+" "+a[0]]||c["* "+a[0]];if(s){if(s===true){s=c[r]}else if(c[r]!==true){o=a[0];u.unshift(a[1])}break}}}}if(s!==true){if(s&&e.throws){t=s(t)}else{try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+l+" to "+o}}}}}}}return{state:"success",data:t}}A.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Tt.href,type:"GET",isLocal:$t.test(Tt.protocol),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":zt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":JSON.parse,"text xml":A.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(e,t){return t?qt(qt(e,A.ajaxSettings),t):qt(A.ajaxSettings,e)},ajaxPrefilter:Ut(Vt),ajaxTransport:Ut(jt),ajax:function(e,t){if(typeof e==="object"){t=e;e=undefined}t=t||{};var u,d,h,i,f,n,p,g,r,o,m=A.ajaxSetup({},t),v=m.context||m,y=m.context&&(v.nodeType||v.jquery)?A(v):A.event,b=A.Deferred(),_=A.Callbacks("once memory"),w=m.statusCode||{},s={},a={},l="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(p){if(!i){i={};while(t=Gt.exec(h)){i[t[1].toLowerCase()+" "]=(i[t[1].toLowerCase()+" "]||[]).concat(t[2])}}t=i[e.toLowerCase()+" "]}return t==null?null:t.join(", ")},getAllResponseHeaders:function(){return p?h:null},setRequestHeader:function(e,t){if(p==null){e=a[e.toLowerCase()]=a[e.toLowerCase()]||e;s[e]=t}return this},overrideMimeType:function(e){if(p==null){m.mimeType=e}return this},statusCode:function(e){var t;if(e){if(p){C.always(e[C.status])}else{for(t in e){w[t]=[w[t],e[t]]}}}return this},abort:function(e){var t=e||l;if(u){u.abort(t)}c(0,t);return this}};b.promise(C);m.url=((e||m.url||Tt.href)+"").replace(Bt,Tt.protocol+"//");m.type=t.method||t.type||m.method||m.type;m.dataTypes=(m.dataType||"*").toLowerCase().match(E)||[""];if(m.crossDomain==null){n=S.createElement("a");try{n.href=m.url;n.href=n.href;m.crossDomain=Wt.protocol+"//"+Wt.host!==n.protocol+"//"+n.host}catch(e){m.crossDomain=true}}if(m.data&&m.processData&&typeof m.data!=="string"){m.data=A.param(m.data,m.traditional)}Yt(Vt,m,t,C);if(p){return C}g=A.event&&m.global;if(g&&A.active++===0){A.event.trigger("ajaxStart")}m.type=m.type.toUpperCase();m.hasContent=!Ht.test(m.type);d=m.url.replace(Pt,"");if(!m.hasContent){o=m.url.slice(d.length);if(m.data&&(m.processData||typeof m.data==="string")){d+=(Rt.test(d)?"&":"?")+m.data;delete m.data}if(m.cache===false){d=d.replace(Ft,"$1");o=(Rt.test(d)?"&":"?")+"_="+Dt.guid+++o}m.url=d+o}else if(m.data&&m.processData&&(m.contentType||"").indexOf("application/x-www-form-urlencoded")===0){m.data=m.data.replace(Lt,"+")}if(m.ifModified){if(A.lastModified[d]){C.setRequestHeader("If-Modified-Since",A.lastModified[d])}if(A.etag[d]){C.setRequestHeader("If-None-Match",A.etag[d])}}if(m.data&&m.hasContent&&m.contentType!==false||t.contentType){C.setRequestHeader("Content-Type",m.contentType)}C.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+(m.dataTypes[0]!=="*"?", "+zt+"; q=0.01":""):m.accepts["*"]);for(r in m.headers){C.setRequestHeader(r,m.headers[r])}if(m.beforeSend&&(m.beforeSend.call(v,C,m)===false||p)){return C.abort()}l="abort";_.add(m.complete);C.done(m.success);C.fail(m.error);u=Yt(jt,m,t,C);if(!u){c(-1,"No Transport")}else{C.readyState=1;if(g){y.trigger("ajaxSend",[C,m])}if(p){return C}if(m.async&&m.timeout>0){f=x.setTimeout(function(){C.abort("timeout")},m.timeout)}try{p=false;u.send(s,c)}catch(e){if(p){throw e}c(-1,e)}}function c(e,t,i,n){var r,o,s,a,l,c=t;if(p){return}p=true;if(f){x.clearTimeout(f)}u=undefined;h=n||"";C.readyState=e>0?4:0;r=e>=200&&e<300||e===304;if(i){a=Kt(m,C,i)}if(!r&&A.inArray("script",m.dataTypes)>-1){m.converters["text script"]=function(){}}a=Xt(m,a,C,r);if(r){if(m.ifModified){l=C.getResponseHeader("Last-Modified");if(l){A.lastModified[d]=l}l=C.getResponseHeader("etag");if(l){A.etag[d]=l}}if(e===204||m.type==="HEAD"){c="nocontent"}else if(e===304){c="notmodified"}else{c=a.state;o=a.data;s=a.error;r=!s}}else{s=c;if(e||!c){c="error";if(e<0){e=0}}}C.status=e;C.statusText=(t||c)+"";if(r){b.resolveWith(v,[o,c,C])}else{b.rejectWith(v,[C,c,s])}C.statusCode(w);w=undefined;if(g){y.trigger(r?"ajaxSuccess":"ajaxError",[C,m,r?o:s])}_.fireWith(v,[C,c]);if(g){y.trigger("ajaxComplete",[C,m]);if(!--A.active){A.event.trigger("ajaxStop")}}}return C},getJSON:function(e,t,i){return A.get(e,t,i,"json")},getScript:function(e,t){return A.get(e,undefined,t,"script")}});A.each(["get","post"],function(e,r){A[r]=function(e,t,i,n){if(m(t)){n=n||i;i=t;t=undefined}return A.ajax(A.extend({url:e,type:r,dataType:n,data:t,success:i},A.isPlainObject(e)&&e))}});A.ajaxPrefilter(function(e){var t;for(t in e.headers){if(t.toLowerCase()==="content-type"){e.contentType=e.headers[t]||""}}});A._evalUrl=function(e,t,i){return A.ajax({url:e,type:"GET",dataType:"script",cache:true,async:false,global:false,converters:{"text script":function(){}},dataFilter:function(e){A.globalEval(e,t,i)}})};A.fn.extend({wrapAll:function(e){var t;if(this[0]){if(m(e)){e=e.call(this[0])}t=A(e,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){t.insertBefore(this[0])}t.map(function(){var e=this;while(e.firstElementChild){e=e.firstElementChild}return e}).append(this)}return this},wrapInner:function(i){if(m(i)){return this.each(function(e){A(this).wrapInner(i.call(this,e))})}return this.each(function(){var e=A(this),t=e.contents();if(t.length){t.wrapAll(i)}else{e.append(i)}})},wrap:function(t){var i=m(t);return this.each(function(e){A(this).wrapAll(i?t.call(this,e):t)})},unwrap:function(e){this.parent(e).not("body").each(function(){A(this).replaceWith(this.childNodes)});return this}});A.expr.pseudos.hidden=function(e){return!A.expr.pseudos.visible(e)};A.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)};A.ajaxSettings.xhr=function(){try{return new x.XMLHttpRequest}catch(e){}};var Zt={0:200,1223:204},Qt=A.ajaxSettings.xhr();g.cors=!!Qt&&"withCredentials"in Qt;g.ajax=Qt=!!Qt;A.ajaxTransport(function(r){var o,s;if(g.cors||Qt&&!r.crossDomain){return{send:function(e,t){var i,n=r.xhr();n.open(r.type,r.url,r.async,r.username,r.password);if(r.xhrFields){for(i in r.xhrFields){n[i]=r.xhrFields[i]}}if(r.mimeType&&n.overrideMimeType){n.overrideMimeType(r.mimeType)}if(!r.crossDomain&&!e["X-Requested-With"]){e["X-Requested-With"]="XMLHttpRequest"}for(i in e){n.setRequestHeader(i,e[i])}o=function(e){return function(){if(o){o=s=n.onload=n.onerror=n.onabort=n.ontimeout=n.onreadystatechange=null;if(e==="abort"){n.abort()}else if(e==="error"){if(typeof n.status!=="number"){t(0,"error")}else{t(n.status,n.statusText)}}else{t(Zt[n.status]||n.status,n.statusText,(n.responseType||"text")!=="text"||typeof n.responseText!=="string"?{binary:n.response}:{text:n.responseText},n.getAllResponseHeaders())}}}};n.onload=o();s=n.onerror=n.ontimeout=o("error");if(n.onabort!==undefined){n.onabort=s}else{n.onreadystatechange=function(){if(n.readyState===4){x.setTimeout(function(){if(o){s()}})}}}o=o("abort");try{n.send(r.hasContent&&r.data||null)}catch(e){if(o){throw e}}},abort:function(){if(o){o()}}}}});A.ajaxPrefilter(function(e){if(e.crossDomain){e.contents.script=false}});A.ajaxSetup({accepts:{script:"text/javascript, application/javascript, "+"application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){A.globalEval(e);return e}}});A.ajaxPrefilter("script",function(e){if(e.cache===undefined){e.cache=false}if(e.crossDomain){e.type="GET"}});A.ajaxTransport("script",function(i){if(i.crossDomain||i.scriptAttrs){var n,r;return{send:function(e,t){n=A("<script>").attr(i.scriptAttrs||{}).prop({charset:i.scriptCharset,src:i.url}).on("load error",r=function(e){n.remove();r=null;if(e){t(e.type==="error"?404:200,e.type)}});S.head.appendChild(n[0])},abort:function(){if(r){r()}}}}});var Jt=[],ei=/(=)\?(?=&|$)|\?\?/;A.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Jt.pop()||A.expando+"_"+Dt.guid++;this[e]=true;return e}});A.ajaxPrefilter("json jsonp",function(e,t,i){var n,r,o,s=e.jsonp!==false&&(ei.test(e.url)?"url":typeof e.data==="string"&&(e.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&ei.test(e.data)&&"data");if(s||e.dataTypes[0]==="jsonp"){n=e.jsonpCallback=m(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback;if(s){e[s]=e[s].replace(ei,"$1"+n)}else if(e.jsonp!==false){e.url+=(Rt.test(e.url)?"&":"?")+e.jsonp+"="+n}e.converters["script json"]=function(){if(!o){A.error(n+" was not called")}return o[0]};e.dataTypes[0]="json";r=x[n];x[n]=function(){o=arguments};i.always(function(){if(r===undefined){A(x).removeProp(n)}else{x[n]=r}if(e[n]){e.jsonpCallback=t.jsonpCallback;Jt.push(n)}if(o&&m(r)){r(o[0])}o=r=undefined});return"script"}});g.createHTMLDocument=function(){var e=S.implementation.createHTMLDocument("").body;e.innerHTML="<form></form><form></form>";return e.childNodes.length===2}();A.parseHTML=function(e,t,i){if(typeof e!=="string"){return[]}if(typeof t==="boolean"){i=t;t=false}var n,r,o;if(!t){if(g.createHTMLDocument){t=S.implementation.createHTMLDocument("");n=t.createElement("base");n.href=S.location.href;t.head.appendChild(n)}else{t=S}}r=Q.exec(e);o=!i&&[];if(r){return[t.createElement(r[1])]}r=Re([e],t,o);if(o&&o.length){A(o).remove()}return A.merge([],r.childNodes)};A.fn.load=function(e,t,i){var n,r,o,s=this,a=e.indexOf(" ");if(a>-1){n=I(e.slice(a));e=e.slice(0,a)}if(m(t)){i=t;t=undefined}else if(t&&typeof t==="object"){r="POST"}if(s.length>0){A.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done(function(e){o=arguments;s.html(n?A("<div>").append(A.parseHTML(e)).find(n):e)}).always(i&&function(e,t){s.each(function(){i.apply(this,o||[e.responseText,t,e])})})}return this};A.expr.pseudos.animated=function(t){return A.grep(A.timers,function(e){return t===e.elem}).length};A.offset={setOffset:function(e,t,i){var n,r,o,s,a,l,c,u=A.css(e,"position"),d=A(e),h={};if(u==="static"){e.style.position="relative"}a=d.offset();o=A.css(e,"top");l=A.css(e,"left");c=(u==="absolute"||u==="fixed")&&(o+l).indexOf("auto")>-1;if(c){n=d.position();s=n.top;r=n.left}else{s=parseFloat(o)||0;r=parseFloat(l)||0}if(m(t)){t=t.call(e,i,A.extend({},a))}if(t.top!=null){h.top=t.top-a.top+s}if(t.left!=null){h.left=t.left-a.left+r}if("using"in t){t.using.call(e,h)}else{if(typeof h.top==="number"){h.top+="px"}if(typeof h.left==="number"){h.left+="px"}d.css(h)}}};A.fn.extend({offset:function(t){if(arguments.length){return t===undefined?this:this.each(function(e){A.offset.setOffset(this,t,e)})}var e,i,n=this[0];if(!n){return}if(!n.getClientRects().length){return{top:0,left:0}}e=n.getBoundingClientRect();i=n.ownerDocument.defaultView;return{top:e.top+i.pageYOffset,left:e.left+i.pageXOffset}},position:function(){if(!this[0]){return}var e,t,i,n=this[0],r={top:0,left:0};if(A.css(n,"position")==="fixed"){t=n.getBoundingClientRect()}else{t=this.offset();i=n.ownerDocument;e=n.offsetParent||i.documentElement;while(e&&(e===i.body||e===i.documentElement)&&A.css(e,"position")==="static"){e=e.parentNode}if(e&&e!==n&&e.nodeType===1){r=A(e).offset();r.top+=A.css(e,"borderTopWidth",true);r.left+=A.css(e,"borderLeftWidth",true)}}return{top:t.top-r.top-A.css(n,"marginTop",true),left:t.left-r.left-A.css(n,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&A.css(e,"position")==="static"){e=e.offsetParent}return e||C})}});A.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,r){var o="pageYOffset"===r;A.fn[t]=function(e){return d(this,function(e,t,i){var n;if(v(e)){n=e}else if(e.nodeType===9){n=e.defaultView}if(i===undefined){return n?n[r]:e[t]}if(n){n.scrollTo(!o?i:n.pageXOffset,o?i:n.pageYOffset)}else{e[t]=i}},t,e,arguments.length)}});A.each(["top","left"],function(e,i){A.cssHooks[i]=Ze(g.pixelPosition,function(e,t){if(t){t=Xe(e,i);return Ue.test(t)?A(e).position()[i]+"px":t}})});A.each({Height:"height",Width:"width"},function(s,a){A.each({padding:"inner"+s,content:a,"":"outer"+s},function(n,o){A.fn[o]=function(e,t){var i=arguments.length&&(n||typeof e!=="boolean"),r=n||(e===true||t===true?"margin":"border");return d(this,function(e,t,i){var n;if(v(e)){return o.indexOf("outer")===0?e["inner"+s]:e.document.documentElement["client"+s]}if(e.nodeType===9){n=e.documentElement;return Math.max(e.body["scroll"+s],n["scroll"+s],e.body["offset"+s],n["offset"+s],n["client"+s])}return i===undefined?A.css(e,t,r):A.style(e,t,i,r)},a,i?e:undefined,i)}})});A.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){A.fn[t]=function(e){return this.on(t,e)}});A.fn.extend({bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}});A.each(("blur focus focusin focusout resize scroll click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup contextmenu").split(" "),function(e,i){A.fn[i]=function(e,t){return arguments.length>0?this.on(i,null,e,t):this.trigger(i)}});var ti=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;A.proxy=function(e,t){var i,n,r;if(typeof t==="string"){i=e[t];t=e;e=i}if(!m(e)){return undefined}n=a.call(arguments,2);r=function(){return e.apply(t||this,n.concat(a.call(arguments)))};r.guid=e.guid=e.guid||A.guid++;return r};A.holdReady=function(e){if(e){A.readyWait++}else{A.ready(true)}};A.isArray=Array.isArray;A.parseJSON=JSON.parse;A.nodeName=c;A.isFunction=m;A.isWindow=v;A.camelCase=h;A.type=y;A.now=Date.now;A.isNumeric=function(e){var t=A.type(e);return(t==="number"||t==="string")&&!isNaN(e-parseFloat(e))};A.trim=function(e){return e==null?"":(e+"").replace(ti,"")};if(typeof define==="function"&&define.amd){define("jquery",[],function(){return A})}var ii=x.jQuery,ni=x.$;A.noConflict=function(e){if(x.$===A){x.$=ni}if(e&&x.jQuery===A){x.jQuery=ii}return A};if(typeof P==="undefined"){x.jQuery=x.$=A}return A});(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(te){"use strict";te.ui=te.ui||{};var L=te.ui.version="1.13.1";var i=0;var s=Array.prototype.hasOwnProperty;var a=Array.prototype.slice;te.cleanData=function(r){return function(e){var t,i,n;for(n=0;(i=e[n])!=null;n++){t=te._data(i,"events");if(t&&t.remove){te(i).triggerHandler("remove")}}r(e)}}(te.cleanData);te.widget=function(e,i,t){var n,r,o;var s={};var a=e.split(".")[0];e=e.split(".")[1];var l=a+"-"+e;if(!t){t=i;i=te.Widget}if(Array.isArray(t)){t=te.extend.apply(null,[{}].concat(t))}te.expr.pseudos[l.toLowerCase()]=function(e){return!!te.data(e,l)};te[a]=te[a]||{};n=te[a][e];r=te[a][e]=function(e,t){if(!this||!this._createWidget){return new r(e,t)}if(arguments.length){this._createWidget(e,t)}};te.extend(r,n,{version:t.version,_proto:te.extend({},t),_childConstructors:[]});o=new i;o.options=te.widget.extend({},o.options);te.each(t,function(t,o){if(typeof o!=="function"){s[t]=o;return}s[t]=function(){function n(){return i.prototype[t].apply(this,arguments)}function r(e){return i.prototype[t].apply(this,e)}return function(){var e=this._super;var t=this._superApply;var i;this._super=n;this._superApply=r;i=o.apply(this,arguments);this._super=e;this._superApply=t;return i}}()});r.prototype=te.widget.extend(o,{widgetEventPrefix:n?o.widgetEventPrefix||e:e},s,{constructor:r,namespace:a,widgetName:e,widgetFullName:l});if(n){te.each(n._childConstructors,function(e,t){var i=t.prototype;te.widget(i.namespace+"."+i.widgetName,r,t._proto)});delete n._childConstructors}else{i._childConstructors.push(r)}te.widget.bridge(e,r);return r};te.widget.extend=function(e){var t=a.call(arguments,1);var i=0;var n=t.length;var r;var o;for(;i<n;i++){for(r in t[i]){o=t[i][r];if(s.call(t[i],r)&&o!==undefined){if(te.isPlainObject(o)){e[r]=te.isPlainObject(e[r])?te.widget.extend({},e[r],o):te.widget.extend({},o)}else{e[r]=o}}}}return e};te.widget.bridge=function(o,t){var s=t.prototype.widgetFullName||o;te.fn[o]=function(i){var e=typeof i==="string";var n=a.call(arguments,1);var r=this;if(e){if(!this.length&&i==="instance"){r=undefined}else{this.each(function(){var e;var t=te.data(this,s);if(i==="instance"){r=t;return false}if(!t){return te.error("cannot call methods on "+o+" prior to initialization; "+"attempted to call method '"+i+"'")}if(typeof t[i]!=="function"||i.charAt(0)==="_"){return te.error("no such method '"+i+"' for "+o+" widget instance")}e=t[i].apply(t,n);if(e!==t&&e!==undefined){r=e&&e.jquery?r.pushStack(e.get()):e;return false}})}}else{if(n.length){i=te.widget.extend.apply(null,[i].concat(n))}this.each(function(){var e=te.data(this,s);if(e){e.option(i||{});if(e._init){e._init()}}else{te.data(this,s,new t(i,this))}})}return r}};te.Widget=function(){};te.Widget._childConstructors=[];te.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:false,create:null},_createWidget:function(e,t){t=te(t||this.defaultElement||this)[0];this.element=te(t);this.uuid=i++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=te();this.hoverable=te();this.focusable=te();this.classesElementLookup={};if(t!==this){te.data(t,this.widgetFullName,this);this._on(true,this.element,{remove:function(e){if(e.target===t){this.destroy()}}});this.document=te(t.style?t.ownerDocument:t.document||t);this.window=te(this.document[0].defaultView||this.document[0].parentWindow)}this.options=te.widget.extend({},this.options,this._getCreateOptions(),e);this._create();if(this.options.disabled){this._setOptionDisabled(this.options.disabled)}this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:te.noop,_create:te.noop,_init:te.noop,destroy:function(){var i=this;this._destroy();te.each(this.classesElementLookup,function(e,t){i._removeClass(t,e)});this.element.off(this.eventNamespace).removeData(this.widgetFullName);this.widget().off(this.eventNamespace).removeAttr("aria-disabled");this.bindings.off(this.eventNamespace)},_destroy:te.noop,widget:function(){return this.element},option:function(e,t){var i=e;var n;var r;var o;if(arguments.length===0){return te.widget.extend({},this.options)}if(typeof e==="string"){i={};n=e.split(".");e=n.shift();if(n.length){r=i[e]=te.widget.extend({},this.options[e]);for(o=0;o<n.length-1;o++){r[n[o]]=r[n[o]]||{};r=r[n[o]]}e=n.pop();if(arguments.length===1){return r[e]===undefined?null:r[e]}r[e]=t}else{if(arguments.length===1){return this.options[e]===undefined?null:this.options[e]}i[e]=t}}this._setOptions(i);return this},_setOptions:function(e){var t;for(t in e){this._setOption(t,e[t])}return this},_setOption:function(e,t){if(e==="classes"){this._setOptionClasses(t)}this.options[e]=t;if(e==="disabled"){this._setOptionDisabled(t)}return this},_setOptionClasses:function(e){var t,i,n;for(t in e){n=this.classesElementLookup[t];if(e[t]===this.options.classes[t]||!n||!n.length){continue}i=te(n.get());this._removeClass(n,t);i.addClass(this._classes({element:i,keys:t,classes:e,add:true}))}},_setOptionDisabled:function(e){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!e);if(e){this._removeClass(this.hoverable,null,"ui-state-hover");this._removeClass(this.focusable,null,"ui-state-focus")}},enable:function(){return this._setOptions({disabled:false})},disable:function(){return this._setOptions({disabled:true})},_classes:function(r){var o=[];var s=this;r=te.extend({element:this.element,classes:this.options.classes||{}},r);function a(){var n=[];r.element.each(function(e,t){var i=te.map(s.classesElementLookup,function(e){return e}).some(function(e){return e.is(t)});if(!i){n.push(t)}});s._on(te(n),{remove:"_untrackClassesElement"})}function e(e,t){var i,n;for(n=0;n<e.length;n++){i=s.classesElementLookup[e[n]]||te();if(r.add){a();i=te(te.uniqueSort(i.get().concat(r.element.get())))}else{i=te(i.not(r.element).get())}s.classesElementLookup[e[n]]=i;o.push(e[n]);if(t&&r.classes[e[n]]){o.push(r.classes[e[n]])}}}if(r.keys){e(r.keys.match(/\S+/g)||[],true)}if(r.extra){e(r.extra.match(/\S+/g)||[])}return o.join(" ")},_untrackClassesElement:function(i){var n=this;te.each(n.classesElementLookup,function(e,t){if(te.inArray(i.target,t)!==-1){n.classesElementLookup[e]=te(t.not(i.target).get())}});this._off(te(i.target))},_removeClass:function(e,t,i){return this._toggleClass(e,t,i,false)},_addClass:function(e,t,i){return this._toggleClass(e,t,i,true)},_toggleClass:function(e,t,i,n){n=typeof n==="boolean"?n:i;var r=typeof e==="string"||e===null,o={extra:r?t:i,keys:r?e:t,element:r?this.element:e,add:n};o.element.toggleClass(this._classes(o),n);return this},_on:function(s,a,e){var l;var c=this;if(typeof s!=="boolean"){e=a;a=s;s=false}if(!e){e=a;a=this.element;l=this.widget()}else{a=l=te(a);this.bindings=this.bindings.add(a)}te.each(e,function(e,t){function i(){if(!s&&(c.options.disabled===true||te(this).hasClass("ui-state-disabled"))){return}return(typeof t==="string"?c[t]:t).apply(c,arguments)}if(typeof t!=="string"){i.guid=t.guid=t.guid||i.guid||te.guid++}var n=e.match(/^([\w:-]*)\s*(.*)$/);var r=n[1]+c.eventNamespace;var o=n[2];if(o){l.on(r,o,i)}else{a.on(r,i)}})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;e.off(t);this.bindings=te(this.bindings.not(e).get());this.focusable=te(this.focusable.not(e).get());this.hoverable=te(this.hoverable.not(e).get())},_delay:function(e,t){function i(){return(typeof e==="string"?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e);this._on(e,{mouseenter:function(e){this._addClass(te(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(te(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e);this._on(e,{focusin:function(e){this._addClass(te(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(te(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,t,i){var n,r;var o=this.options[e];i=i||{};t=te.Event(t);t.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase();t.target=this.element[0];r=t.originalEvent;if(r){for(n in r){if(!(n in t)){t[n]=r[n]}}}this.element.trigger(t,i);return!(typeof o==="function"&&o.apply(this.element[0],[t].concat(i))===false||t.isDefaultPrevented())}};te.each({show:"fadeIn",hide:"fadeOut"},function(o,s){te.Widget.prototype["_"+o]=function(t,e,i){if(typeof e==="string"){e={effect:e}}var n;var r=!e?o:e===true||typeof e==="number"?s:e.effect||s;e=e||{};if(typeof e==="number"){e={duration:e}}else if(e===true){e={}}n=!te.isEmptyObject(e);e.complete=i;if(e.delay){t.delay(e.delay)}if(n&&te.effects&&te.effects.effect[r]){t[o](e)}else if(r!==o&&t[r]){t[r](e.duration,e.easing,i)}else{t.queue(function(e){te(this)[o]();if(i){i.call(t[0])}e()})}}});var P=te.widget;(function(){var r,C=Math.max,x=Math.abs,n=/left|center|right/,o=/top|center|bottom/,s=/[\+\-]\d+(\.[\d]+)?%?/,a=/^\w+/,l=/%$/,t=te.fn.position;function S(e,t,i){return[parseFloat(e[0])*(l.test(e[0])?t/100:1),parseFloat(e[1])*(l.test(e[1])?i/100:1)]}function A(e,t){return parseInt(te.css(e,t),10)||0}function c(e){return e!=null&&e===e.window}function i(e){var t=e[0];if(t.nodeType===9){return{width:e.width(),height:e.height(),offset:{top:0,left:0}}}if(c(t)){return{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}}if(t.preventDefault){return{width:0,height:0,offset:{top:t.pageY,left:t.pageX}}}return{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}te.position={scrollbarWidth:function(){if(r!==undefined){return r}var e,t,i=te("<div style="+"'display:block;position:absolute;width:200px;height:200px;overflow:hidden;'>"+"<div style='height:300px;width:auto;'></div></div>"),n=i.children()[0];te("body").append(i);e=n.offsetWidth;i.css("overflow","scroll");t=n.offsetWidth;if(e===t){t=i[0].clientWidth}i.remove();return r=e-t},getScrollInfo:function(e){var t=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),i=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),n=t==="scroll"||t==="auto"&&e.width<e.element[0].scrollWidth,r=i==="scroll"||i==="auto"&&e.height<e.element[0].scrollHeight;return{width:r?te.position.scrollbarWidth():0,height:n?te.position.scrollbarWidth():0}},getWithinInfo:function(e){var t=te(e||window),i=c(t[0]),n=!!t[0]&&t[0].nodeType===9,r=!i&&!n;return{element:t,isWindow:i,isDocument:n,offset:r?te(e).offset():{left:0,top:0},scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop(),width:t.outerWidth(),height:t.outerHeight()}}};te.fn.position=function(d){if(!d||!d.of){return t.apply(this,arguments)}d=te.extend({},d);var h,f,p,g,m,e,v=typeof d.of==="string"?te(document).find(d.of):te(d.of),y=te.position.getWithinInfo(d.within),b=te.position.getScrollInfo(y),_=(d.collision||"flip").split(" "),w={};e=i(v);if(v[0].preventDefault){d.at="left top"}f=e.width;p=e.height;g=e.offset;m=te.extend({},g);te.each(["my","at"],function(){var e=(d[this]||"").split(" "),t,i;if(e.length===1){e=n.test(e[0])?e.concat(["center"]):o.test(e[0])?["center"].concat(e):["center","center"]}e[0]=n.test(e[0])?e[0]:"center";e[1]=o.test(e[1])?e[1]:"center";t=s.exec(e[0]);i=s.exec(e[1]);w[this]=[t?t[0]:0,i?i[0]:0];d[this]=[a.exec(e[0])[0],a.exec(e[1])[0]]});if(_.length===1){_[1]=_[0]}if(d.at[0]==="right"){m.left+=f}else if(d.at[0]==="center"){m.left+=f/2}if(d.at[1]==="bottom"){m.top+=p}else if(d.at[1]==="center"){m.top+=p/2}h=S(w.at,f,p);m.left+=h[0];m.top+=h[1];return this.each(function(){var i,e,s=te(this),a=s.outerWidth(),l=s.outerHeight(),t=A(this,"marginLeft"),n=A(this,"marginTop"),r=a+t+A(this,"marginRight")+b.width,o=l+n+A(this,"marginBottom")+b.height,c=te.extend({},m),u=S(w.my,s.outerWidth(),s.outerHeight());if(d.my[0]==="right"){c.left-=a}else if(d.my[0]==="center"){c.left-=a/2}if(d.my[1]==="bottom"){c.top-=l}else if(d.my[1]==="center"){c.top-=l/2}c.left+=u[0];c.top+=u[1];i={marginLeft:t,marginTop:n};te.each(["left","top"],function(e,t){if(te.ui.position[_[e]]){te.ui.position[_[e]][t](c,{targetWidth:f,targetHeight:p,elemWidth:a,elemHeight:l,collisionPosition:i,collisionWidth:r,collisionHeight:o,offset:[h[0]+u[0],h[1]+u[1]],my:d.my,at:d.at,within:y,elem:s})}});if(d.using){e=function(e){var t=g.left-c.left,i=t+f-a,n=g.top-c.top,r=n+p-l,o={target:{element:v,left:g.left,top:g.top,width:f,height:p},element:{element:s,left:c.left,top:c.top,width:a,height:l},horizontal:i<0?"left":t>0?"right":"center",vertical:r<0?"top":n>0?"bottom":"middle"};if(f<a&&x(t+i)<f){o.horizontal="center"}if(p<l&&x(n+r)<p){o.vertical="middle"}if(C(x(t),x(i))>C(x(n),x(r))){o.important="horizontal"}else{o.important="vertical"}d.using.call(this,e,o)}}s.offset(te.extend(c,{using:e}))})};te.ui.position={fit:{left:function(e,t){var i=t.within,n=i.isWindow?i.scrollLeft:i.offset.left,r=i.width,o=e.left-t.collisionPosition.marginLeft,s=n-o,a=o+t.collisionWidth-r-n,l;if(t.collisionWidth>r){if(s>0&&a<=0){l=e.left+s+t.collisionWidth-r-n;e.left+=s-l}else if(a>0&&s<=0){e.left=n}else{if(s>a){e.left=n+r-t.collisionWidth}else{e.left=n}}}else if(s>0){e.left+=s}else if(a>0){e.left-=a}else{e.left=C(e.left-o,e.left)}},top:function(e,t){var i=t.within,n=i.isWindow?i.scrollTop:i.offset.top,r=t.within.height,o=e.top-t.collisionPosition.marginTop,s=n-o,a=o+t.collisionHeight-r-n,l;if(t.collisionHeight>r){if(s>0&&a<=0){l=e.top+s+t.collisionHeight-r-n;e.top+=s-l}else if(a>0&&s<=0){e.top=n}else{if(s>a){e.top=n+r-t.collisionHeight}else{e.top=n}}}else if(s>0){e.top+=s}else if(a>0){e.top-=a}else{e.top=C(e.top-o,e.top)}}},flip:{left:function(e,t){var i=t.within,n=i.offset.left+i.scrollLeft,r=i.width,o=i.isWindow?i.scrollLeft:i.offset.left,s=e.left-t.collisionPosition.marginLeft,a=s-o,l=s+t.collisionWidth-r-o,c=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,u=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,d=-2*t.offset[0],h,f;if(a<0){h=e.left+c+u+d+t.collisionWidth-r-n;if(h<0||h<x(a)){e.left+=c+u+d}}else if(l>0){f=e.left-t.collisionPosition.marginLeft+c+u+d-o;if(f>0||x(f)<l){e.left+=c+u+d}}},top:function(e,t){var i=t.within,n=i.offset.top+i.scrollTop,r=i.height,o=i.isWindow?i.scrollTop:i.offset.top,s=e.top-t.collisionPosition.marginTop,a=s-o,l=s+t.collisionHeight-r-o,c=t.my[1]==="top",u=c?-t.elemHeight:t.my[1]==="bottom"?t.elemHeight:0,d=t.at[1]==="top"?t.targetHeight:t.at[1]==="bottom"?-t.targetHeight:0,h=-2*t.offset[1],f,p;if(a<0){p=e.top+u+d+h+t.collisionHeight-r-n;if(p<0||p<x(a)){e.top+=u+d+h}}else if(l>0){f=e.top-t.collisionPosition.marginTop+u+d+h-o;if(f>0||x(f)<l){e.top+=u+d+h}}}},flipfit:{left:function(){te.ui.position.flip.left.apply(this,arguments);te.ui.position.fit.left.apply(this,arguments)},top:function(){te.ui.position.flip.top.apply(this,arguments);te.ui.position.fit.top.apply(this,arguments)}}}})();var F=te.ui.position;var G=te.extend(te.expr.pseudos,{data:te.expr.createPseudo?te.expr.createPseudo(function(t){return function(e){return!!te.data(e,t)}}):function(e,t,i){return!!te.data(e,i[3])}});var $=te.fn.extend({disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}});var u=te;var e="backgroundColor borderBottomColor borderLeftColor borderRightColor "+"borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",n={},t=n.toString,d=/^([\-+])=\s*(\d+\.?\d*)/,r=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1]*2.55,e[2]*2.55,e[3]*2.55,e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})?/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),e[4]?(parseInt(e[4],16)/255).toFixed(2):1]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])?/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),e[4]?(parseInt(e[4]+e[4],16)/255).toFixed(2):1]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],h=u.Color=function(e,t,i,n){return new u.Color.fn.parse(e,t,i,n)},f={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},p={byte:{floor:true,max:255},percent:{max:1},degrees:{mod:360,floor:true}},l=h.support={},o=u("<p>")[0],c,g=u.each;o.style.cssText="background-color:rgba(1,1,1,.5)";l.rgba=o.style.backgroundColor.indexOf("rgba")>-1;g(f,function(e,t){t.cache="_"+e;t.props.alpha={idx:3,type:"percent",def:1}});u.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});function m(e){if(e==null){return e+""}return typeof e==="object"?n[t.call(e)]||"object":typeof e}function v(e,t,i){var n=p[t.type]||{};if(e==null){return i||!t.def?null:t.def}e=n.floor?~~e:parseFloat(e);if(isNaN(e)){return t.def}if(n.mod){return(e+n.mod)%n.mod}return Math.min(n.max,Math.max(0,e))}function y(s){var a=h(),l=a._rgba=[];s=s.toLowerCase();g(r,function(e,t){var i,n=t.re.exec(s),r=n&&t.parse(n),o=t.space||"rgba";if(r){i=a[o](r);a[f[o].cache]=i[f[o].cache];l=a._rgba=i._rgba;return false}});if(l.length){if(l.join()==="0,0,0,0"){u.extend(l,c.transparent)}return a}return c[s]}h.fn=u.extend(h.prototype,{parse:function(r,e,t,i){if(r===undefined){this._rgba=[null,null,null,null];return this}if(r.jquery||r.nodeType){r=u(r).css(e);e=undefined}var o=this,n=m(r),s=this._rgba=[];if(e!==undefined){r=[r,e,t,i];n="array"}if(n==="string"){return this.parse(y(r)||c._default)}if(n==="array"){g(f.rgba.props,function(e,t){s[t.idx]=v(r[t.idx],t)});return this}if(n==="object"){if(r instanceof h){g(f,function(e,t){if(r[t.cache]){o[t.cache]=r[t.cache].slice()}})}else{g(f,function(e,i){var n=i.cache;g(i.props,function(e,t){if(!o[n]&&i.to){if(e==="alpha"||r[e]==null){return}o[n]=i.to(o._rgba)}o[n][t.idx]=v(r[e],t,true)});if(o[n]&&u.inArray(null,o[n].slice(0,3))<0){if(o[n][3]==null){o[n][3]=1}if(i.from){o._rgba=i.from(o[n])}}})}return this}},is:function(e){var r=h(e),o=true,s=this;g(f,function(e,t){var i,n=r[t.cache];if(n){i=s[t.cache]||t.to&&t.to(s._rgba)||[];g(t.props,function(e,t){if(n[t.idx]!=null){o=n[t.idx]===i[t.idx];return o}})}return o});return o},_space:function(){var i=[],n=this;g(f,function(e,t){if(n[t.cache]){i.push(e)}});return i.pop()},transition:function(e,s){var a=h(e),t=a._space(),i=f[t],n=this.alpha()===0?h("transparent"):this,l=n[i.cache]||i.to(n._rgba),c=l.slice();a=a[i.cache];g(i.props,function(e,t){var i=t.idx,n=l[i],r=a[i],o=p[t.type]||{};if(r===null){return}if(n===null){c[i]=r}else{if(o.mod){if(r-n>o.mod/2){n+=o.mod}else if(n-r>o.mod/2){n-=o.mod}}c[i]=v((r-n)*s+n,t)}});return this[t](c)},blend:function(e){if(this._rgba[3]===1){return this}var t=this._rgba.slice(),i=t.pop(),n=h(e)._rgba;return h(u.map(t,function(e,t){return(1-i)*n[t]+i*e}))},toRgbaString:function(){var e="rgba(",t=u.map(this._rgba,function(e,t){if(e!=null){return e}return t>2?1:0});if(t[3]===1){t.pop();e="rgb("}return e+t.join()+")"},toHslaString:function(){var e="hsla(",t=u.map(this.hsla(),function(e,t){if(e==null){e=t>2?1:0}if(t&&t<3){e=Math.round(e*100)+"%"}return e});if(t[3]===1){t.pop();e="hsl("}return e+t.join()+")"},toHexString:function(e){var t=this._rgba.slice(),i=t.pop();if(e){t.push(~~(i*255))}return"#"+u.map(t,function(e){e=(e||0).toString(16);return e.length===1?"0"+e:e}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}});h.fn.parse.prototype=h.fn;function b(e,t,i){i=(i+1)%1;if(i*6<1){return e+(t-e)*i*6}if(i*2<1){return t}if(i*3<2){return e+(t-e)*(2/3-i)*6}return e}f.hsla.to=function(e){if(e[0]==null||e[1]==null||e[2]==null){return[null,null,null,e[3]]}var t=e[0]/255,i=e[1]/255,n=e[2]/255,r=e[3],o=Math.max(t,i,n),s=Math.min(t,i,n),a=o-s,l=o+s,c=l*.5,u,d;if(s===o){u=0}else if(t===o){u=60*(i-n)/a+360}else if(i===o){u=60*(n-t)/a+120}else{u=60*(t-i)/a+240}if(a===0){d=0}else if(c<=.5){d=a/l}else{d=a/(2-l)}return[Math.round(u)%360,d,c,r==null?1:r]};f.hsla.from=function(e){if(e[0]==null||e[1]==null||e[2]==null){return[null,null,null,e[3]]}var t=e[0]/360,i=e[1],n=e[2],r=e[3],o=n<=.5?n*(1+i):n+i-n*i,s=2*n-o;return[Math.round(b(s,o,t+1/3)*255),Math.round(b(s,o,t)*255),Math.round(b(s,o,t-1/3)*255),r]};g(f,function(l,e){var i=e.props,s=e.cache,a=e.to,c=e.from;h.fn[l]=function(e){if(a&&!this[s]){this[s]=a(this._rgba)}if(e===undefined){return this[s].slice()}var t,n=m(e),r=n==="array"||n==="object"?e:arguments,o=this[s].slice();g(i,function(e,t){var i=r[n==="object"?e:t.idx];if(i==null){i=o[t.idx]}o[t.idx]=v(i,t)});if(c){t=h(c(o));t[s]=o;return t}else{return h(o)}};g(i,function(s,a){if(h.fn[s]){return}h.fn[s]=function(e){var t,i,n,r,o=m(e);if(s==="alpha"){r=this._hsla?"hsla":"rgba"}else{r=l}t=this[r]();i=t[a.idx];if(o==="undefined"){return i}if(o==="function"){e=e.call(this,i);o=m(e)}if(e==null&&a.empty){return this}if(o==="string"){n=d.exec(e);if(n){e=i+parseFloat(n[2])*(n[1]==="+"?1:-1)}}t[a.idx]=e;return this[r](t)}})});h.hook=function(e){var t=e.split(" ");g(t,function(e,o){u.cssHooks[o]={set:function(e,t){var i,n,r="";if(t!=="transparent"&&(m(t)!=="string"||(i=y(t)))){t=h(i||t);if(!l.rgba&&t._rgba[3]!==1){n=o==="backgroundColor"?e.parentNode:e;while((r===""||r==="transparent")&&n&&n.style){try{r=u.css(n,"backgroundColor");n=n.parentNode}catch(e){}}t=t.blend(r&&r!=="transparent"?r:"_default")}t=t.toRgbaString()}try{e.style[o]=t}catch(e){}}};u.fx.step[o]=function(e){if(!e.colorInit){e.start=h(e.elem,o);e.end=h(e.end);e.colorInit=true}u.cssHooks[o].set(e.elem,e.start.transition(e.end,e.pos))}})};h.hook(e);u.cssHooks.borderColor={expand:function(i){var n={};g(["Top","Right","Bottom","Left"],function(e,t){n["border"+t+"Color"]=i});return n}};c=u.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"};var _="ui-effects-",w="ui-effects-style",C="ui-effects-animated";te.effects={effect:{}};(function(){var s=["add","remove","toggle"],o={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};te.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,t){te.fx.step[t]=function(e){if(e.end!=="none"&&!e.setAttr||e.pos===1&&!e.setAttr){u.style(e.elem,t,e.end);e.setAttr=true}}});function a(e){return e.replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()})}function l(e){var t,i,n=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,r={};if(n&&n.length&&n[0]&&n[n[0]]){i=n.length;while(i--){t=n[i];if(typeof n[t]==="string"){r[a(t)]=n[t]}}}else{for(t in n){if(typeof n[t]==="string"){r[t]=n[t]}}}return r}function c(e,t){var i={},n,r;for(n in t){r=t[n];if(e[n]!==r){if(!o[n]){if(te.fx.step[n]||!isNaN(parseFloat(r))){i[n]=r}}}}return i}if(!te.fn.addBack){te.fn.addBack=function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}te.effects.animateClass=function(r,e,t,i){var o=te.speed(e,t,i);return this.queue(function(){var i=te(this),e=i.attr("class")||"",t,n=o.children?i.find("*").addBack():i;n=n.map(function(){var e=te(this);return{el:e,start:l(this)}});t=function(){te.each(s,function(e,t){if(r[t]){i[t+"Class"](r[t])}})};t();n=n.map(function(){this.end=l(this.el[0]);this.diff=c(this.start,this.end);return this});i.attr("class",e);n=n.map(function(){var e=this,t=te.Deferred(),i=te.extend({},o,{queue:false,complete:function(){t.resolve(e)}});this.el.animate(this.diff,i);return t.promise()});te.when.apply(te,n.get()).done(function(){t();te.each(arguments,function(){var t=this.el;te.each(this.diff,function(e){t.css(e,"")})});o.complete.call(i[0])})})};te.fn.extend({addClass:function(r){return function(e,t,i,n){return t?te.effects.animateClass.call(this,{add:e},t,i,n):r.apply(this,arguments)}}(te.fn.addClass),removeClass:function(r){return function(e,t,i,n){return arguments.length>1?te.effects.animateClass.call(this,{remove:e},t,i,n):r.apply(this,arguments)}}(te.fn.removeClass),toggleClass:function(o){return function(e,t,i,n,r){if(typeof t==="boolean"||t===undefined){if(!i){return o.apply(this,arguments)}else{return te.effects.animateClass.call(this,t?{add:e}:{remove:e},i,n,r)}}else{return te.effects.animateClass.call(this,{toggle:e},t,i,n)}}}(te.fn.toggleClass),switchClass:function(e,t,i,n,r){return te.effects.animateClass.call(this,{add:t,remove:e},i,n,r)}})})();(function(){if(te.expr&&te.expr.pseudos&&te.expr.pseudos.animated){te.expr.pseudos.animated=function(t){return function(e){return!!te(e).data(C)||t(e)}}(te.expr.pseudos.animated)}if(te.uiBackCompat!==false){te.extend(te.effects,{save:function(e,t){var i=0,n=t.length;for(;i<n;i++){if(t[i]!==null){e.data(_+t[i],e[0].style[t[i]])}}},restore:function(e,t){var i,n=0,r=t.length;for(;n<r;n++){if(t[n]!==null){i=e.data(_+t[n]);e.css(t[n],i)}}},setMode:function(e,t){if(t==="toggle"){t=e.is(":hidden")?"show":"hide"}return t},createWrapper:function(i){if(i.parent().is(".ui-effects-wrapper")){return i.parent()}var n={width:i.outerWidth(true),height:i.outerHeight(true),float:i.css("float")},e=te("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),t={width:i.width(),height:i.height()},r=document.activeElement;try{r.id}catch(e){r=document.body}i.wrap(e);if(i[0]===r||te.contains(i[0],r)){te(r).trigger("focus")}e=i.parent();if(i.css("position")==="static"){e.css({position:"relative"});i.css({position:"relative"})}else{te.extend(n,{position:i.css("position"),zIndex:i.css("z-index")});te.each(["top","left","bottom","right"],function(e,t){n[t]=i.css(t);if(isNaN(parseInt(n[t],10))){n[t]="auto"}});i.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}i.css(t);return e.css(n).show()},removeWrapper:function(e){var t=document.activeElement;if(e.parent().is(".ui-effects-wrapper")){e.parent().replaceWith(e);if(e[0]===t||te.contains(e[0],t)){te(t).trigger("focus")}}return e}})}te.extend(te.effects,{version:"1.13.1",define:function(e,t,i){if(!i){i=t;t="effect"}te.effects.effect[e]=i;te.effects.effect[e].mode=t;return i},scaledDimensions:function(e,t,i){if(t===0){return{height:0,width:0,outerHeight:0,outerWidth:0}}var n=i!=="horizontal"?(t||100)/100:1,r=i!=="vertical"?(t||100)/100:1;return{height:e.height()*r,width:e.width()*n,outerHeight:e.outerHeight()*r,outerWidth:e.outerWidth()*n}},clipToBox:function(e){return{width:e.clip.right-e.clip.left,height:e.clip.bottom-e.clip.top,left:e.clip.left,top:e.clip.top}},unshift:function(e,t,i){var n=e.queue();if(t>1){n.splice.apply(n,[1,0].concat(n.splice(t,i)))}e.dequeue()},saveStyle:function(e){e.data(w,e[0].style.cssText)},restoreStyle:function(e){e[0].style.cssText=e.data(w)||"";e.removeData(w)},mode:function(e,t){var i=e.is(":hidden");if(t==="toggle"){t=i?"show":"hide"}if(i?t==="hide":t==="show"){t="none"}return t},getBaseline:function(e,t){var i,n;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=e[1]/t.width}return{x:n,y:i}},createPlaceholder:function(e){var t,i=e.css("position"),n=e.position();e.css({marginTop:e.css("marginTop"),marginBottom:e.css("marginBottom"),marginLeft:e.css("marginLeft"),marginRight:e.css("marginRight")}).outerWidth(e.outerWidth()).outerHeight(e.outerHeight());if(/^(static|relative)/.test(i)){i="absolute";t=te("<"+e[0].nodeName+">").insertAfter(e).css({display:/^(inline|ruby)/.test(e.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:e.css("marginTop"),marginBottom:e.css("marginBottom"),marginLeft:e.css("marginLeft"),marginRight:e.css("marginRight"),float:e.css("float")}).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).addClass("ui-effects-placeholder");e.data(_+"placeholder",t)}e.css({position:i,left:n.left,top:n.top});return t},removePlaceholder:function(e){var t=_+"placeholder",i=e.data(t);if(i){i.remove();e.removeData(t)}},cleanUp:function(e){te.effects.restoreStyle(e);te.effects.removePlaceholder(e)},setTransition:function(n,e,r,o){o=o||{};te.each(e,function(e,t){var i=n.cssUnit(t);if(i[0]>0){o[t]=i[0]*r+i[1]}});return o}});function u(e,t,i,n){if(te.isPlainObject(e)){t=e;e=e.effect}e={effect:e};if(t==null){t={}}if(typeof t==="function"){n=t;i=null;t={}}if(typeof t==="number"||te.fx.speeds[t]){n=i;i=t;t={}}if(typeof i==="function"){n=i;i=null}if(t){te.extend(e,t)}i=i||t.duration;e.duration=te.fx.off?0:typeof i==="number"?i:i in te.fx.speeds?te.fx.speeds[i]:te.fx.speeds._default;e.complete=n||t.complete;return e}function n(e){if(!e||typeof e==="number"||te.fx.speeds[e]){return true}if(typeof e==="string"&&!te.effects.effect[e]){return true}if(typeof e==="function"){return true}if(typeof e==="object"&&!e.effect){return true}return false}te.fn.extend({effect:function(){var r=u.apply(this,arguments),o=te.effects.effect[r.effect],s=o.mode,e=r.queue,t=e||"fx",a=r.complete,l=r.mode,c=[],i=function(e){var t=te(this),i=te.effects.mode(t,l)||s;t.data(C,true);c.push(i);if(s&&(i==="show"||i===s&&i==="hide")){t.show()}if(!s||i!=="none"){te.effects.saveStyle(t)}if(typeof e==="function"){e()}};if(te.fx.off||!o){if(l){return this[l](r.duration,a)}else{return this.each(function(){if(a){a.call(this)}})}}function n(e){var t=te(this);function i(){t.removeData(C);te.effects.cleanUp(t);if(r.mode==="hide"){t.hide()}n()}function n(){if(typeof a==="function"){a.call(t[0])}if(typeof e==="function"){e()}}r.mode=c.shift();if(te.uiBackCompat!==false&&!s){if(t.is(":hidden")?l==="hide":l==="show"){t[l]();n()}else{o.call(t[0],r,n)}}else{if(r.mode==="none"){t[l]();n()}else{o.call(t[0],r,i)}}}return e===false?this.each(i).each(n):this.queue(t,i).queue(t,n)},show:function(i){return function(e){if(n(e)){return i.apply(this,arguments)}else{var t=u.apply(this,arguments);t.mode="show";return this.effect.call(this,t)}}}(te.fn.show),hide:function(i){return function(e){if(n(e)){return i.apply(this,arguments)}else{var t=u.apply(this,arguments);t.mode="hide";return this.effect.call(this,t)}}}(te.fn.hide),toggle:function(i){return function(e){if(n(e)||typeof e==="boolean"){return i.apply(this,arguments)}else{var t=u.apply(this,arguments);t.mode="toggle";return this.effect.call(this,t)}}}(te.fn.toggle),cssUnit:function(e){var i=this.css(e),n=[];te.each(["em","px","%","pt"],function(e,t){if(i.indexOf(t)>0){n=[parseFloat(i),t]}});return n},cssClip:function(e){if(e){return this.css("clip","rect("+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px)")}return t(this.css("clip"),this)},transfer:function(e,t){var i=te(this),n=te(e.to),r=n.css("position")==="fixed",o=te("body"),s=r?o.scrollTop():0,a=r?o.scrollLeft():0,l=n.offset(),c={top:l.top-s,left:l.left-a,height:n.innerHeight(),width:n.innerWidth()},u=i.offset(),d=te("<div class='ui-effects-transfer'></div>");d.appendTo("body").addClass(e.className).css({top:u.top-s,left:u.left-a,height:i.innerHeight(),width:i.innerWidth(),position:r?"fixed":"absolute"}).animate(c,e.duration,e.easing,function(){d.remove();if(typeof t==="function"){t()}})}});function t(e,t){var i=t.outerWidth(),n=t.outerHeight(),r=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/,o=r.exec(e)||["",0,i,n,0];return{top:parseFloat(o[1])||0,right:o[2]==="auto"?i:parseFloat(o[2]),bottom:o[3]==="auto"?n:parseFloat(o[3]),left:parseFloat(o[4])||0}}te.fx.step.clip=function(e){if(!e.clipInit){e.start=te(e.elem).cssClip();if(typeof e.end==="string"){e.end=t(e.end,e.elem)}e.clipInit=true}te(e.elem).cssClip({top:e.pos*(e.end.top-e.start.top)+e.start.top,right:e.pos*(e.end.right-e.start.right)+e.start.right,bottom:e.pos*(e.end.bottom-e.start.bottom)+e.start.bottom,left:e.pos*(e.end.left-e.start.left)+e.start.left})}})();(function(){var i={};te.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,e){i[e]=function(e){return Math.pow(e,t+2)}});te.extend(i,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return e===0||e===1?e:-Math.pow(2,8*(e-1))*Math.sin(((e-1)*80-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){var t,i=4;while(e<((t=Math.pow(2,--i))-1)/11){}return 1/Math.pow(4,3-i)-7.5625*Math.pow((t*3-2)/22-e,2)}});te.each(i,function(e,t){te.easing["easeIn"+e]=t;te.easing["easeOut"+e]=function(e){return 1-t(1-e)};te.easing["easeInOut"+e]=function(e){return e<.5?t(e*2)/2:1-t(e*-2+2)/2}})})();var x=te.effects;var H=te.effects.define("blind","hide",function(e,t){var i={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},n=te(this),r=e.direction||"up",o=n.cssClip(),s={clip:te.extend({},o)},a=te.effects.createPlaceholder(n);s.clip[i[r][0]]=s.clip[i[r][1]];if(e.mode==="show"){n.cssClip(s.clip);if(a){a.css(te.effects.clipToBox(s))}s.clip=o}if(a){a.animate(te.effects.clipToBox(s),e.duration,e.easing)}n.animate(s,{queue:false,duration:e.duration,easing:e.easing,complete:t})});var B=te.effects.define("bounce",function(e,t){var i,n,r,o=te(this),s=e.mode,a=s==="hide",l=s==="show",c=e.direction||"up",u=e.distance,d=e.times||5,h=d*2+(l||a?1:0),f=e.duration/h,p=e.easing,g=c==="up"||c==="down"?"top":"left",m=c==="up"||c==="left",v=0,y=o.queue().length;te.effects.createPlaceholder(o);r=o.css(g);if(!u){u=o[g==="top"?"outerHeight":"outerWidth"]()/3}if(l){n={opacity:1};n[g]=r;o.css("opacity",0).css(g,m?-u*2:u*2).animate(n,f,p)}if(a){u=u/Math.pow(2,d-1)}n={};n[g]=r;for(;v<d;v++){i={};i[g]=(m?"-=":"+=")+u;o.animate(i,f,p).animate(n,f,p);u=a?u*2:u/2}if(a){i={opacity:0};i[g]=(m?"-=":"+=")+u;o.animate(i,f,p)}o.queue(t);te.effects.unshift(o,y,h+1)});var V=te.effects.define("clip","hide",function(e,t){var i,n={},r=te(this),o=e.direction||"vertical",s=o==="both",a=s||o==="horizontal",l=s||o==="vertical";i=r.cssClip();n.clip={top:l?(i.bottom-i.top)/2:i.top,right:a?(i.right-i.left)/2:i.right,bottom:l?(i.bottom-i.top)/2:i.bottom,left:a?(i.right-i.left)/2:i.left};te.effects.createPlaceholder(r);if(e.mode==="show"){r.cssClip(n.clip);n.clip=i}r.animate(n,{queue:false,duration:e.duration,easing:e.easing,complete:t})});var j=te.effects.define("drop","hide",function(e,t){var i,n=te(this),r=e.mode,o=r==="show",s=e.direction||"left",a=s==="up"||s==="down"?"top":"left",l=s==="up"||s==="left"?"-=":"+=",c=l==="+="?"-=":"+=",u={opacity:0};te.effects.createPlaceholder(n);i=e.distance||n[a==="top"?"outerHeight":"outerWidth"](true)/2;u[a]=l+i;if(o){n.css(u);u[a]=c+i;u.opacity=1}n.animate(u,{queue:false,duration:e.duration,easing:e.easing,complete:t})});var z=te.effects.define("explode","hide",function(e,t){var i,n,r,o,s,a,l=e.pieces?Math.round(Math.sqrt(e.pieces)):3,c=l,u=te(this),d=e.mode,h=d==="show",f=u.show().css("visibility","hidden").offset(),p=Math.ceil(u.outerWidth()/c),g=Math.ceil(u.outerHeight()/l),m=[];function v(){m.push(this);if(m.length===l*c){y()}}for(i=0;i<l;i++){o=f.top+i*g;a=i-(l-1)/2;for(n=0;n<c;n++){r=f.left+n*p;s=n-(c-1)/2;u.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-n*p,top:-i*g}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:p,height:g,left:r+(h?s*p:0),top:o+(h?a*g:0),opacity:h?0:1}).animate({left:r+(h?0:s*p),top:o+(h?0:a*g),opacity:h?1:0},e.duration||500,e.easing,v)}}function y(){u.css({visibility:"visible"});te(m).remove();t()}});var W=te.effects.define("fade","toggle",function(e,t){var i=e.mode==="show";te(this).css("opacity",i?0:1).animate({opacity:i?1:0},{queue:false,duration:e.duration,easing:e.easing,complete:t})});var U=te.effects.define("fold","hide",function(t,e){var i=te(this),n=t.mode,r=n==="show",o=n==="hide",s=t.size||15,a=/([0-9]+)%/.exec(s),l=!!t.horizFirst,c=l?["right","bottom"]:["bottom","right"],u=t.duration/2,d=te.effects.createPlaceholder(i),h=i.cssClip(),f={clip:te.extend({},h)},p={clip:te.extend({},h)},g=[h[c[0]],h[c[1]]],m=i.queue().length;if(a){s=parseInt(a[1],10)/100*g[o?0:1]}f.clip[c[0]]=s;p.clip[c[0]]=s;p.clip[c[1]]=0;if(r){i.cssClip(p.clip);if(d){d.css(te.effects.clipToBox(p))}p.clip=h}i.queue(function(e){if(d){d.animate(te.effects.clipToBox(f),u,t.easing).animate(te.effects.clipToBox(p),u,t.easing)}e()}).animate(f,u,t.easing).animate(p,u,t.easing).queue(e);te.effects.unshift(i,m,4)});var Y=te.effects.define("highlight","show",function(e,t){var i=te(this),n={backgroundColor:i.css("backgroundColor")};if(e.mode==="hide"){n.opacity=0}te.effects.saveStyle(i);i.css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(n,{queue:false,duration:e.duration,easing:e.easing,complete:t})});var q=te.effects.define("size",function(r,t){var e,o,i,n=te(this),s=["fontSize"],a=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],l=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],c=r.mode,u=c!=="effect",d=r.scale||"both",h=r.origin||["middle","center"],f=n.css("position"),p=n.position(),g=te.effects.scaledDimensions(n),m=r.from||g,v=r.to||te.effects.scaledDimensions(n,0);te.effects.createPlaceholder(n);if(c==="show"){i=m;m=v;v=i}o={from:{y:m.height/g.height,x:m.width/g.width},to:{y:v.height/g.height,x:v.width/g.width}};if(d==="box"||d==="both"){if(o.from.y!==o.to.y){m=te.effects.setTransition(n,a,o.from.y,m);v=te.effects.setTransition(n,a,o.to.y,v)}if(o.from.x!==o.to.x){m=te.effects.setTransition(n,l,o.from.x,m);v=te.effects.setTransition(n,l,o.to.x,v)}}if(d==="content"||d==="both"){if(o.from.y!==o.to.y){m=te.effects.setTransition(n,s,o.from.y,m);v=te.effects.setTransition(n,s,o.to.y,v)}}if(h){e=te.effects.getBaseline(h,g);m.top=(g.outerHeight-m.outerHeight)*e.y+p.top;m.left=(g.outerWidth-m.outerWidth)*e.x+p.left;v.top=(g.outerHeight-v.outerHeight)*e.y+p.top;v.left=(g.outerWidth-v.outerWidth)*e.x+p.left}delete m.outerHeight;delete m.outerWidth;n.css(m);if(d==="content"||d==="both"){a=a.concat(["marginTop","marginBottom"]).concat(s);l=l.concat(["marginLeft","marginRight"]);n.find("*[width]").each(function(){var e=te(this),t=te.effects.scaledDimensions(e),i={height:t.height*o.from.y,width:t.width*o.from.x,outerHeight:t.outerHeight*o.from.y,outerWidth:t.outerWidth*o.from.x},n={height:t.height*o.to.y,width:t.width*o.to.x,outerHeight:t.height*o.to.y,outerWidth:t.width*o.to.x};if(o.from.y!==o.to.y){i=te.effects.setTransition(e,a,o.from.y,i);n=te.effects.setTransition(e,a,o.to.y,n)}if(o.from.x!==o.to.x){i=te.effects.setTransition(e,l,o.from.x,i);n=te.effects.setTransition(e,l,o.to.x,n)}if(u){te.effects.saveStyle(e)}e.css(i);e.animate(n,r.duration,r.easing,function(){if(u){te.effects.restoreStyle(e)}})})}n.animate(v,{queue:false,duration:r.duration,easing:r.easing,complete:function(){var e=n.offset();if(v.opacity===0){n.css("opacity",m.opacity)}if(!u){n.css("position",f==="static"?"relative":f).offset(e);te.effects.saveStyle(n)}t()}})});var K=te.effects.define("scale",function(e,t){var i=te(this),n=e.mode,r=parseInt(e.percent,10)||(parseInt(e.percent,10)===0?0:n!=="effect"?0:100),o=te.extend(true,{from:te.effects.scaledDimensions(i),to:te.effects.scaledDimensions(i,r,e.direction||"both"),origin:e.origin||["middle","center"]},e);if(e.fade){o.from.opacity=1;o.to.opacity=0}te.effects.effect.size.call(this,o,t)});var X=te.effects.define("puff","hide",function(e,t){var i=te.extend(true,{},e,{fade:true,percent:parseInt(e.percent,10)||150});te.effects.effect.scale.call(this,i,t)});var Z=te.effects.define("pulsate","show",function(e,t){var i=te(this),n=e.mode,r=n==="show",o=n==="hide",s=r||o,a=(e.times||5)*2+(s?1:0),l=e.duration/a,c=0,u=1,d=i.queue().length;if(r||!i.is(":visible")){i.css("opacity",0).show();c=1}for(;u<a;u++){i.animate({opacity:c},l,e.easing);c=1-c}i.animate({opacity:c},l,e.easing);i.queue(t);te.effects.unshift(i,d,a+1)});var Q=te.effects.define("shake",function(e,t){var i=1,n=te(this),r=e.direction||"left",o=e.distance||20,s=e.times||3,a=s*2+1,l=Math.round(e.duration/a),c=r==="up"||r==="down"?"top":"left",u=r==="up"||r==="left",d={},h={},f={},p=n.queue().length;te.effects.createPlaceholder(n);d[c]=(u?"-=":"+=")+o;h[c]=(u?"+=":"-=")+o*2;f[c]=(u?"-=":"+=")+o*2;n.animate(d,l,e.easing);for(;i<s;i++){n.animate(h,l,e.easing).animate(f,l,e.easing)}n.animate(h,l,e.easing).animate(d,l/2,e.easing).queue(t);te.effects.unshift(n,p,a+1)});var J=te.effects.define("slide","show",function(e,t){var i,n,r=te(this),o={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},s=e.mode,a=e.direction||"left",l=a==="up"||a==="down"?"top":"left",c=a==="up"||a==="left",u=e.distance||r[l==="top"?"outerHeight":"outerWidth"](true),d={};te.effects.createPlaceholder(r);i=r.cssClip();n=r.position()[l];d[l]=(c?-1:1)*u+n;d.clip=r.cssClip();d.clip[o[a][1]]=d.clip[o[a][0]];if(s==="show"){r.cssClip(d.clip);r.css(l,d[l]);d.clip=i;d[l]=n}r.animate(d,{queue:false,duration:e.duration,easing:e.easing,complete:t})});var x;if(te.uiBackCompat!==false){x=te.effects.define("transfer",function(e,t){te(this).transfer(e,t)})}var ee=x;te.ui.focusable=function(e,t){var i,n,r,o,s,a=e.nodeName.toLowerCase();if("area"===a){i=e.parentNode;n=i.name;if(!e.href||!n||i.nodeName.toLowerCase()!=="map"){return false}r=te("img[usemap='#"+n+"']");return r.length>0&&r.is(":visible")}if(/^(input|select|textarea|button|object)$/.test(a)){o=!e.disabled;if(o){s=te(e).closest("fieldset")[0];if(s){o=!s.disabled}}}else if("a"===a){o=e.href||t}else{o=t}return o&&te(e).is(":visible")&&S(te(e))};function S(e){var t=e.css("visibility");while(t==="inherit"){e=e.parent();t=e.css("visibility")}return t==="visible"}te.extend(te.expr.pseudos,{focusable:function(e){return te.ui.focusable(e,te.attr(e,"tabindex")!=null)}});var ie=te.ui.focusable;var ne=te.fn._form=function(){return typeof this[0].form==="string"?this.closest("form"):te(this[0].form)};var re=te.ui.formResetMixin={_formResetHandler:function(){var t=te(this);setTimeout(function(){var e=t.data("ui-form-reset-instances");te.each(e,function(){this.refresh()})})},_bindFormResetHandler:function(){this.form=this.element._form();if(!this.form.length){return}var e=this.form.data("ui-form-reset-instances")||[];if(!e.length){this.form.on("reset.ui-form-reset",this._formResetHandler)}e.push(this);this.form.data("ui-form-reset-instances",e)},_unbindFormResetHandler:function(){if(!this.form.length){return}var e=this.form.data("ui-form-reset-instances");e.splice(te.inArray(this,e),1);if(e.length){this.form.data("ui-form-reset-instances",e)}else{this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}};if(!te.expr.pseudos){te.expr.pseudos=te.expr[":"]}if(!te.uniqueSort){te.uniqueSort=te.unique}if(!te.escapeSelector){var A=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;var E=function(e,t){if(t){if(e==="\0"){return""}return e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" "}return"\\"+e};te.escapeSelector=function(e){return(e+"").replace(A,E)}}if(!te.fn.even||!te.fn.odd){te.fn.extend({even:function(){return this.filter(function(e){return e%2===0})},odd:function(){return this.filter(function(e){return e%2===1})}})}var oe=te.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38};var se=te.fn.labels=function(){var e,t,i,n,r;if(!this.length){return this.pushStack([])}if(this[0].labels&&this[0].labels.length){return this.pushStack(this[0].labels)}n=this.eq(0).parents("label");i=this.attr("id");if(i){e=this.eq(0).parents().last();r=e.add(e.length?e.siblings():this.siblings());t="label[for='"+te.escapeSelector(i)+"']";n=n.add(r.find(t).addBack(t))}return this.pushStack(n)};var ae=te.fn.scrollParent=function(e){var t=this.css("position"),i=t==="absolute",n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,r=this.parents().filter(function(){var e=te(this);if(i&&e.css("position")==="static"){return false}return n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return t==="fixed"||!r.length?te(this[0].ownerDocument||document):r};var le=te.extend(te.expr.pseudos,{tabbable:function(e){var t=te.attr(e,"tabindex"),i=t!=null;return(!i||t>=0)&&te.ui.focusable(e,i)}});var ce=te.fn.extend({uniqueId:function(){var e=0;return function(){return this.each(function(){if(!this.id){this.id="ui-id-"+ ++e}})}}(),removeUniqueId:function(){return this.each(function(){if(/^ui-id-\d+$/.test(this.id)){te(this).removeAttr("id")}})}});var ue=te.widget("ui.accordion",{version:"1.13.1",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:false,event:"click",header:function(e){return e.find("> li > :first-child").add(e.find("> :not(li)").even())},heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var e=this.options;this.prevShow=this.prevHide=te();this._addClass("ui-accordion","ui-widget ui-helper-reset");this.element.attr("role","tablist");if(!e.collapsible&&(e.active===false||e.active==null)){e.active=0}this._processPanels();if(e.active<0){e.active+=this.headers.length}this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:!this.active.length?te():this.active.next()}},_createIcons:function(){var e,t,i=this.options.icons;if(i){e=te("<span>");this._addClass(e,"ui-accordion-header-icon","ui-icon "+i.header);e.prependTo(this.headers);t=this.active.children(".ui-accordion-header-icon");this._removeClass(t,i.header)._addClass(t,null,i.activeHeader)._addClass(this.headers,"ui-accordion-icons")}},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons");this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeAttr("role");this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId();this._destroyIcons();e=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId();if(this.options.heightStyle!=="content"){e.css("height","")}},_setOption:function(e,t){if(e==="active"){this._activate(t);return}if(e==="event"){if(this.options.event){this._off(this.headers,this.options.event)}this._setupEvents(t)}this._super(e,t);if(e==="collapsible"&&!t&&this.options.active===false){this._activate(0)}if(e==="icons"){this._destroyIcons();if(t){this._createIcons()}}},_setOptionDisabled:function(e){this._super(e);this.element.attr("aria-disabled",e);this._toggleClass(null,"ui-state-disabled",!!e);this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!e)},_keydown:function(e){if(e.altKey||e.ctrlKey){return}var t=te.ui.keyCode,i=this.headers.length,n=this.headers.index(e.target),r=false;switch(e.keyCode){case t.RIGHT:case t.DOWN:r=this.headers[(n+1)%i];break;case t.LEFT:case t.UP:r=this.headers[(n-1+i)%i];break;case t.SPACE:case t.ENTER:this._eventHandler(e);break;case t.HOME:r=this.headers[0];break;case t.END:r=this.headers[i-1];break}if(r){te(e.target).attr("tabIndex",-1);te(r).attr("tabIndex",0);te(r).trigger("focus");e.preventDefault()}},_panelKeyDown:function(e){if(e.keyCode===te.ui.keyCode.UP&&e.ctrlKey){te(e.currentTarget).prev().trigger("focus")}},refresh:function(){var e=this.options;this._processPanels();if(e.active===false&&e.collapsible===true||!this.headers.length){e.active=false;this.active=te()}else if(e.active===false){this._activate(0)}else if(this.active.length&&!te.contains(this.element[0],this.active[0])){if(this.headers.length===this.headers.find(".ui-state-disabled").length){e.active=false;this.active=te()}else{this._activate(Math.max(0,e.active-1))}}else{e.active=this.headers.index(this.active)}this._destroyIcons();this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;if(typeof this.options.header==="function"){this.headers=this.options.header(this.element)}else{this.headers=this.element.find(this.options.header)}this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default");this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide();this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content");if(t){this._off(e.not(this.headers));this._off(t.not(this.panels))}},_refresh:function(){var i,e=this.options,t=e.heightStyle,n=this.element.parent();this.active=this._findActive(e.active);this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed");this._addClass(this.active.next(),"ui-accordion-content-active");this.active.next().show();this.headers.attr("role","tab").each(function(){var e=te(this),t=e.uniqueId().attr("id"),i=e.next(),n=i.uniqueId().attr("id");e.attr("aria-controls",n);i.attr("aria-labelledby",t)}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide();if(!this.active.length){this.headers.eq(0).attr("tabIndex",0)}else{this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"})}this._createIcons();this._setupEvents(e.event);if(t==="fill"){i=n.height();this.element.siblings(":visible").each(function(){var e=te(this),t=e.css("position");if(t==="absolute"||t==="fixed"){return}i-=e.outerHeight(true)});this.headers.each(function(){i-=te(this).outerHeight(true)});this.headers.next().each(function(){te(this).height(Math.max(0,i-te(this).innerHeight()+te(this).height()))}).css("overflow","auto")}else if(t==="auto"){i=0;this.headers.next().each(function(){var e=te(this).is(":visible");if(!e){te(this).show()}i=Math.max(i,te(this).css("height","").height());if(!e){te(this).hide()}}).height(i)}},_activate:function(e){var t=this._findActive(e)[0];if(t===this.active[0]){return}t=t||this.active[0];this._eventHandler({target:t,currentTarget:t,preventDefault:te.noop})},_findActive:function(e){return typeof e==="number"?this.headers.eq(e):te()},_setupEvents:function(e){var i={keydown:"_keydown"};if(e){te.each(e.split(" "),function(e,t){i[t]="_eventHandler"})}this._off(this.headers.add(this.headers.next()));this._on(this.headers,i);this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._hoverable(this.headers);this._focusable(this.headers)},_eventHandler:function(e){var t,i,n=this.options,r=this.active,o=te(e.currentTarget),s=o[0]===r[0],a=s&&n.collapsible,l=a?te():o.next(),c=r.next(),u={oldHeader:r,oldPanel:c,newHeader:a?te():o,newPanel:l};e.preventDefault();if(s&&!n.collapsible||this._trigger("beforeActivate",e,u)===false){return}n.active=a?false:this.headers.index(o);this.active=s?te():o;this._toggle(u);this._removeClass(r,"ui-accordion-header-active","ui-state-active");if(n.icons){t=r.children(".ui-accordion-header-icon");this._removeClass(t,null,n.icons.activeHeader)._addClass(t,null,n.icons.header)}if(!s){this._removeClass(o,"ui-accordion-header-collapsed")._addClass(o,"ui-accordion-header-active","ui-state-active");if(n.icons){i=o.children(".ui-accordion-header-icon");this._removeClass(i,null,n.icons.header)._addClass(i,null,n.icons.activeHeader)}this._addClass(o.next(),"ui-accordion-content-active")}},_toggle:function(e){var t=e.newPanel,i=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(true,true);this.prevShow=t;this.prevHide=i;if(this.options.animate){this._animate(t,i,e)}else{i.hide();t.show();this._toggleComplete(e)}i.attr({"aria-hidden":"true"});i.prev().attr({"aria-selected":"false","aria-expanded":"false"});if(t.length&&i.length){i.prev().attr({tabIndex:-1,"aria-expanded":"false"})}else if(t.length){this.headers.filter(function(){return parseInt(te(this).attr("tabIndex"),10)===0}).attr("tabIndex",-1)}t.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(e,i,t){var n,r,o,s=this,a=0,l=e.css("box-sizing"),c=e.length&&(!i.length||e.index()<i.index()),u=this.options.animate||{},d=c&&u.down||u,h=function(){s._toggleComplete(t)};if(typeof d==="number"){o=d}if(typeof d==="string"){r=d}r=r||d.easing||u.easing;o=o||d.duration||u.duration;if(!i.length){return e.animate(this.showProps,o,r,h)}if(!e.length){return i.animate(this.hideProps,o,r,h)}n=e.show().outerHeight();i.animate(this.hideProps,{duration:o,easing:r,step:function(e,t){t.now=Math.round(e)}});e.hide().animate(this.showProps,{duration:o,easing:r,complete:h,step:function(e,t){t.now=Math.round(e);if(t.prop!=="height"){if(l==="content-box"){a+=t.now}}else if(s.options.heightStyle!=="content"){t.now=Math.round(n-i.outerHeight()-a);a=0}}})},_toggleComplete:function(e){var t=e.oldPanel,i=t.prev();this._removeClass(t,"ui-accordion-content-active");this._removeClass(i,"ui-accordion-header-active")._addClass(i,"ui-accordion-header-collapsed");if(t.length){t.parent()[0].className=t.parent()[0].className}this._trigger("activate",null,e)}});var de=te.ui.safeActiveElement=function(t){var i;try{i=t.activeElement}catch(e){i=t.body}if(!i){i=t.body}if(!i.nodeName){i=t.body}return i};var he=te.widget("ui.menu",{version:"1.13.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=false;this.lastMousePosition={x:null,y:null};this.element.uniqueId().attr({role:this.options.role,tabIndex:0});this._addClass("ui-menu","ui-widget ui-widget-content");this._on({"mousedown .ui-menu-item":function(e){e.preventDefault();this._activateItem(e)},"click .ui-menu-item":function(e){var t=te(e.target);var i=te(te.ui.safeActiveElement(this.document[0]));if(!this.mouseHandled&&t.not(".ui-state-disabled").length){this.select(e);if(!e.isPropagationStopped()){this.mouseHandled=true}if(t.has(".ui-menu").length){this.expand(e)}else if(!this.element.is(":focus")&&i.closest(".ui-menu").length){this.element.trigger("focus",[true]);if(this.active&&this.active.parents(".ui-menu").length===1){clearTimeout(this.timer)}}}},"mouseenter .ui-menu-item":"_activateItem","mousemove .ui-menu-item":"_activateItem",mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this._menuItems().first();if(!t){this.focus(e,i)}},blur:function(t){this._delay(function(){var e=!te.contains(this.element[0],te.ui.safeActiveElement(this.document[0]));if(e){this.collapseAll(t)}})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(e){if(this._closeOnDocumentClick(e)){this.collapseAll(e,true)}this.mouseHandled=false}})},_activateItem:function(e){if(this.previousFilter){return}if(e.clientX===this.lastMousePosition.x&&e.clientY===this.lastMousePosition.y){return}this.lastMousePosition={x:e.clientX,y:e.clientY};var t=te(e.target).closest(".ui-menu-item"),i=te(e.currentTarget);if(t[0]!==i[0]){return}if(i.is(".ui-state-active")){return}this._removeClass(i.siblings().children(".ui-state-active"),null,"ui-state-active");this.focus(e,i)},_destroy:function(){var e=this.element.find(".ui-menu-item").removeAttr("role aria-disabled"),t=e.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled "+"tabIndex").removeUniqueId().show();t.children().each(function(){var e=te(this);if(e.data("ui-menu-submenu-caret")){e.remove()}})},_keydown:function(e){var t,i,n,r,o=true;switch(e.keyCode){case te.ui.keyCode.PAGE_UP:this.previousPage(e);break;case te.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case te.ui.keyCode.HOME:this._move("first","first",e);break;case te.ui.keyCode.END:this._move("last","last",e);break;case te.ui.keyCode.UP:this.previous(e);break;case te.ui.keyCode.DOWN:this.next(e);break;case te.ui.keyCode.LEFT:this.collapse(e);break;case te.ui.keyCode.RIGHT:if(this.active&&!this.active.is(".ui-state-disabled")){this.expand(e)}break;case te.ui.keyCode.ENTER:case te.ui.keyCode.SPACE:this._activate(e);break;case te.ui.keyCode.ESCAPE:this.collapse(e);break;default:o=false;i=this.previousFilter||"";r=false;n=e.keyCode>=96&&e.keyCode<=105?(e.keyCode-96).toString():String.fromCharCode(e.keyCode);clearTimeout(this.filterTimer);if(n===i){r=true}else{n=i+n}t=this._filterMenuItems(n);t=r&&t.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):t;if(!t.length){n=String.fromCharCode(e.keyCode);t=this._filterMenuItems(n)}if(t.length){this.focus(e,t);this.previousFilter=n;this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)}else{delete this.previousFilter}}if(o){e.preventDefault()}},_activate:function(e){if(this.active&&!this.active.is(".ui-state-disabled")){if(this.active.children("[aria-haspopup='true']").length){this.expand(e)}else{this.select(e)}}},refresh:function(){var e,t,i,n,r,o=this,s=this.options.icons.submenu,a=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length);i=a.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=te(this),t=e.prev(),i=te("<span>").data("ui-menu-submenu-caret",true);o._addClass(i,"ui-menu-icon","ui-icon "+s);t.attr("aria-haspopup","true").prepend(i);e.attr("aria-labelledby",t.attr("id"))});this._addClass(i,"ui-menu","ui-widget ui-widget-content ui-front");e=a.add(this.element);t=e.find(this.options.items);t.not(".ui-menu-item").each(function(){var e=te(this);if(o._isDivider(e)){o._addClass(e,"ui-menu-divider","ui-widget-content")}});n=t.not(".ui-menu-item, .ui-menu-divider");r=n.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()});this._addClass(n,"ui-menu-item")._addClass(r,"ui-menu-item-wrapper");t.filter(".ui-state-disabled").attr("aria-disabled","true");if(this.active&&!te.contains(this.element[0],this.active[0])){this.blur()}},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){if(e==="icons"){var i=this.element.find(".ui-menu-icon");this._removeClass(i,null,this.options.icons.submenu)._addClass(i,null,t.submenu)}this._super(e,t)},_setOptionDisabled:function(e){this._super(e);this.element.attr("aria-disabled",String(e));this._toggleClass(null,"ui-state-disabled",!!e)},focus:function(e,t){var i,n,r;this.blur(e,e&&e.type==="focus");this._scrollIntoView(t);this.active=t.first();n=this.active.children(".ui-menu-item-wrapper");this._addClass(n,null,"ui-state-active");if(this.options.role){this.element.attr("aria-activedescendant",n.attr("id"))}r=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper");this._addClass(r,null,"ui-state-active");if(e&&e.type==="keydown"){this._close()}else{this.timer=this._delay(function(){this._close()},this.delay)}i=t.children(".ui-menu");if(i.length&&e&&/^mouse/.test(e.type)){this._startOpening(i)}this.activeMenu=t.parent();this._trigger("focus",e,{item:t})},_scrollIntoView:function(e){var t,i,n,r,o,s;if(this._hasScroll()){t=parseFloat(te.css(this.activeMenu[0],"borderTopWidth"))||0;i=parseFloat(te.css(this.activeMenu[0],"paddingTop"))||0;n=e.offset().top-this.activeMenu.offset().top-t-i;r=this.activeMenu.scrollTop();o=this.activeMenu.height();s=e.outerHeight();if(n<0){this.activeMenu.scrollTop(r+n)}else if(n+s>o){this.activeMenu.scrollTop(r+n-o+s)}}},blur:function(e,t){if(!t){clearTimeout(this.timer)}if(!this.active){return}this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active");this._trigger("blur",e,{item:this.active});this.active=null},_startOpening:function(e){clearTimeout(this.timer);if(e.attr("aria-hidden")!=="true"){return}this.timer=this._delay(function(){this._close();this._open(e)},this.delay)},_open:function(e){var t=te.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true");e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(t)},collapseAll:function(t,i){clearTimeout(this.timer);this.timer=this._delay(function(){var e=i?this.element:te(t&&t.target).closest(this.element.find(".ui-menu"));if(!e.length){e=this.element}this._close(e);this.blur(t);this._removeClass(e.find(".ui-state-active"),null,"ui-state-active");this.activeMenu=e},i?0:this.delay)},_close:function(e){if(!e){e=this.active?this.active.parent():this.element}e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(e){return!te(e.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);if(t&&t.length){this._close();this.focus(e,t)}},expand:function(e){var t=this.active&&this._menuItems(this.active.children(".ui-menu")).first();if(t&&t.length){this._open(t.parent());this._delay(function(){this.focus(e,t)})}},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_menuItems:function(e){return(e||this.element).find(this.options.items).filter(".ui-menu-item")},_move:function(e,t,i){var n;if(this.active){if(e==="first"||e==="last"){n=this.active[e==="first"?"prevAll":"nextAll"](".ui-menu-item").last()}else{n=this.active[e+"All"](".ui-menu-item").first()}}if(!n||!n.length||!this.active){n=this._menuItems(this.activeMenu)[t]()}this.focus(i,n)},nextPage:function(e){var t,i,n;if(!this.active){this.next(e);return}if(this.isLastItem()){return}if(this._hasScroll()){i=this.active.offset().top;n=this.element.innerHeight();if(te.fn.jquery.indexOf("3.2.")===0){n+=this.element[0].offsetHeight-this.element.outerHeight()}this.active.nextAll(".ui-menu-item").each(function(){t=te(this);return t.offset().top-i-n<0});this.focus(e,t)}else{this.focus(e,this._menuItems(this.activeMenu)[!this.active?"first":"last"]())}},previousPage:function(e){var t,i,n;if(!this.active){this.next(e);return}if(this.isFirstItem()){return}if(this._hasScroll()){i=this.active.offset().top;n=this.element.innerHeight();if(te.fn.jquery.indexOf("3.2.")===0){n+=this.element[0].offsetHeight-this.element.outerHeight()}this.active.prevAll(".ui-menu-item").each(function(){t=te(this);return t.offset().top-i+n>0});this.focus(e,t)}else{this.focus(e,this._menuItems(this.activeMenu).first())}},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||te(e.target).closest(".ui-menu-item");var t={item:this.active};if(!this.active.has(".ui-menu").length){this.collapseAll(e,true)}this._trigger("select",e,t)},_filterMenuItems:function(e){var t=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),i=new RegExp("^"+t,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return i.test(String.prototype.trim.call(te(this).children(".ui-menu-item-wrapper").text()))})}});te.widget("ui.autocomplete",{version:"1.13.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,liveRegionTimer:null,_create:function(){var i,n,r,e=this.element[0].nodeName.toLowerCase(),t=e==="textarea",o=e==="input";this.isMultiLine=t||!o&&this._isContentEditable(this.element);this.valueMethod=this.element[t||o?"val":"text"];this.isNewMenu=true;this._addClass("ui-autocomplete-input");this.element.attr("autocomplete","off");this._on(this.element,{keydown:function(e){if(this.element.prop("readOnly")){i=true;r=true;n=true;return}i=false;r=false;n=false;var t=te.ui.keyCode;switch(e.keyCode){case t.PAGE_UP:i=true;this._move("previousPage",e);break;case t.PAGE_DOWN:i=true;this._move("nextPage",e);break;case t.UP:i=true;this._keyEvent("previous",e);break;case t.DOWN:i=true;this._keyEvent("next",e);break;case t.ENTER:if(this.menu.active){i=true;e.preventDefault();this.menu.select(e)}break;case t.TAB:if(this.menu.active){this.menu.select(e)}break;case t.ESCAPE:if(this.menu.element.is(":visible")){if(!this.isMultiLine){this._value(this.term)}this.close(e);e.preventDefault()}break;default:n=true;this._searchTimeout(e);break}},keypress:function(e){if(i){i=false;if(!this.isMultiLine||this.menu.element.is(":visible")){e.preventDefault()}return}if(n){return}var t=te.ui.keyCode;switch(e.keyCode){case t.PAGE_UP:this._move("previousPage",e);break;case t.PAGE_DOWN:this._move("nextPage",e);break;case t.UP:this._keyEvent("previous",e);break;case t.DOWN:this._keyEvent("next",e);break}},input:function(e){if(r){r=false;e.preventDefault();return}this._searchTimeout(e)},focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(e){clearTimeout(this.searching);this.close(e);this._change(e)}});this._initSource();this.menu=te("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().attr({unselectable:"on"}).menu("instance");this._addClass(this.menu.element,"ui-autocomplete","ui-front");this._on(this.menu.element,{mousedown:function(e){e.preventDefault()},menufocus:function(e,t){var i,n;if(this.isNewMenu){this.isNewMenu=false;if(e.originalEvent&&/^mouse/.test(e.originalEvent.type)){this.menu.blur();this.document.one("mousemove",function(){te(e.target).trigger(e.originalEvent)});return}}n=t.item.data("ui-autocomplete-item");if(false!==this._trigger("focus",e,{item:n})){if(e.originalEvent&&/^key/.test(e.originalEvent.type)){this._value(n.value)}}i=t.item.attr("aria-label")||n.value;if(i&&String.prototype.trim.call(i).length){clearTimeout(this.liveRegionTimer);this.liveRegionTimer=this._delay(function(){this.liveRegion.html(te("<div>").text(i))},100)}},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),n=this.previous;if(this.element[0]!==te.ui.safeActiveElement(this.document[0])){this.element.trigger("focus");this.previous=n;this._delay(function(){this.previous=n;this.selectedItem=i})}if(false!==this._trigger("select",e,{item:i})){this._value(i.value)}this.term=this._value();this.close(e);this.selectedItem=i}});this.liveRegion=te("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body);this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible");this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t);if(e==="source"){this._initSource()}if(e==="appendTo"){this.menu.element.appendTo(this._appendTo())}if(e==="disabled"&&t&&this.xhr){this.xhr.abort()}},_isEventTargetInWidget:function(e){var t=this.menu.element[0];return e.target===this.element[0]||e.target===t||te.contains(t,e.target)},_closeOnClickOutside:function(e){if(!this._isEventTargetInWidget(e)){this.close()}},_appendTo:function(){var e=this.options.appendTo;if(e){e=e.jquery||e.nodeType?te(e):this.document.find(e).eq(0)}if(!e||!e[0]){e=this.element.closest(".ui-front, dialog")}if(!e.length){e=this.document[0].body}return e},_initSource:function(){var i,n,r=this;if(Array.isArray(this.options.source)){i=this.options.source;this.source=function(e,t){t(te.ui.autocomplete.filter(i,e.term))}}else if(typeof this.options.source==="string"){n=this.options.source;this.source=function(e,t){if(r.xhr){r.xhr.abort()}r.xhr=te.ajax({url:n,data:e,dataType:"json",success:function(e){t(e)},error:function(){t([])}})}}else{this.source=this.options.source}},_searchTimeout:function(n){clearTimeout(this.searching);this.searching=this._delay(function(){var e=this.term===this._value(),t=this.menu.element.is(":visible"),i=n.altKey||n.ctrlKey||n.metaKey||n.shiftKey;if(!e||e&&!t&&!i){this.selectedItem=null;this.search(null,n)}},this.options.delay)},search:function(e,t){e=e!=null?e:this._value();this.term=this._value();if(e.length<this.options.minLength){return this.close(t)}if(this._trigger("search",t)===false){return}return this._search(e)},_search:function(e){this.pending++;this._addClass("ui-autocomplete-loading");this.cancelSearch=false;this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return function(e){if(t===this.requestIndex){this.__response(e)}this.pending--;if(!this.pending){this._removeClass("ui-autocomplete-loading")}}.bind(this)},__response:function(e){if(e){e=this._normalize(e)}this._trigger("response",null,{content:e});if(!this.options.disabled&&e&&e.length&&!this.cancelSearch){this._suggest(e);this._trigger("open")}else{this._close()}},close:function(e){this.cancelSearch=true;this._close(e)},_close:function(e){this._off(this.document,"mousedown");if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.blur();this.isNewMenu=true;this._trigger("close",e)}},_change:function(e){if(this.previous!==this._value()){this._trigger("change",e,{item:this.selectedItem})}},_normalize:function(e){if(e.length&&e[0].label&&e[0].value){return e}return te.map(e,function(e){if(typeof e==="string"){return{label:e,value:e}}return te.extend({},e,{label:e.label||e.value,value:e.value||e.label})})},_suggest:function(e){var t=this.menu.element.empty();this._renderMenu(t,e);this.isNewMenu=true;this.menu.refresh();t.show();this._resizeMenu();t.position(te.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next()}this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(i,e){var n=this;te.each(e,function(e,t){n._renderItemData(i,t)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(e,t){return te("<li>").append(te("<div>").text(t.label)).appendTo(e)},_move:function(e,t){if(!this.menu.element.is(":visible")){this.search(null,t);return}if(this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)){if(!this.isMultiLine){this._value(this.term)}this.menu.blur();return}this.menu[e](t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(e,t);t.preventDefault()}},_isContentEditable:function(e){if(!e.length){return false}var t=e.prop("contentEditable");if(t==="inherit"){return this._isContentEditable(e.parent())}return t==="true"}});te.extend(te.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,t){var i=new RegExp(te.ui.autocomplete.escapeRegex(t),"i");return te.grep(e,function(e){return i.test(e.label||e.value||e)})}});te.widget("ui.autocomplete",te.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments);if(this.options.disabled||this.cancelSearch){return}if(e&&e.length){t=this.options.messages.results(e.length)}else{t=this.options.messages.noResults}clearTimeout(this.liveRegionTimer);this.liveRegionTimer=this._delay(function(){this.liveRegion.html(te("<div>").text(t))},100)}});var fe=te.ui.autocomplete;var T=/ui-corner-([a-z]){2,6}/g;var pe=te.widget("ui.controlgroup",{version:"1.13.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:true,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar");this.refresh()},_destroy:function(){this._callChildMethod("destroy");this.childWidgets.removeData("ui-controlgroup-data");this.element.removeAttr("role");if(this.options.items.controlgroupLabel){this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()}},_initWidgets:function(){var s=this,a=[];te.each(this.options.items,function(r,e){var t;var o={};if(!e){return}if(r==="controlgroupLabel"){t=s.element.find(e);t.each(function(){var e=te(this);if(e.children(".ui-controlgroup-label-contents").length){return}e.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")});s._addClass(t,null,"ui-widget ui-widget-content ui-state-default");a=a.concat(t.get());return}if(!te.fn[r]){return}if(s["_"+r+"Options"]){o=s["_"+r+"Options"]("middle")}else{o={classes:{}}}s.element.find(e).each(function(){var e=te(this);var t=e[r]("instance");var i=te.widget.extend({},o);if(r==="button"&&e.parent(".ui-spinner").length){return}if(!t){t=e[r]()[r]("instance")}if(t){i.classes=s._resolveClassesValues(i.classes,t)}e[r](i);var n=e[r]("widget");te.data(n[0],"ui-controlgroup-data",t?t:e[r]("instance"));a.push(n[0])})});this.childWidgets=te(te.uniqueSort(a));this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(i){this.childWidgets.each(function(){var e=te(this),t=e.data("ui-controlgroup-data");if(t&&t[i]){t[i]()}})},_updateCornerClass:function(e,t){var i="ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all";var n=this._buildSimpleOptions(t,"label").classes.label;this._removeClass(e,null,i);this._addClass(e,null,n)},_buildSimpleOptions:function(e,t){var i=this.options.direction==="vertical";var n={classes:{}};n.classes[t]={middle:"",first:"ui-corner-"+(i?"top":"left"),last:"ui-corner-"+(i?"bottom":"right"),only:"ui-corner-all"}[e];return n},_spinnerOptions:function(e){var t=this._buildSimpleOptions(e,"ui-spinner");t.classes["ui-spinner-up"]="";t.classes["ui-spinner-down"]="";return t},_buttonOptions:function(e){return this._buildSimpleOptions(e,"ui-button")},_checkboxradioOptions:function(e){return this._buildSimpleOptions(e,"ui-checkboxradio-label")},_selectmenuOptions:function(e){var t=this.options.direction==="vertical";return{width:t?"auto":false,classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(t?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(t?"top":"left")},last:{"ui-selectmenu-button-open":t?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(t?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[e]}},_resolveClassesValues:function(i,n){var r={};te.each(i,function(e){var t=n.options.classes[e]||"";t=String.prototype.trim.call(t.replace(T,""));r[e]=(t+" "+i[e]).replace(/\s+/g," ")});return r},_setOption:function(e,t){if(e==="direction"){this._removeClass("ui-controlgroup-"+this.options.direction)}this._super(e,t);if(e==="disabled"){this._callChildMethod(t?"disable":"enable");return}this.refresh()},refresh:function(){var r,o=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction);if(this.options.direction==="horizontal"){this._addClass(null,"ui-helper-clearfix")}this._initWidgets();r=this.childWidgets;if(this.options.onlyVisible){r=r.filter(":visible")}if(r.length){te.each(["first","last"],function(e,t){var i=r[t]().data("ui-controlgroup-data");if(i&&o["_"+i.widgetName+"Options"]){var n=o["_"+i.widgetName+"Options"](r.length===1?"only":t);n.classes=o._resolveClassesValues(n.classes,i);i.element[i.widgetName](n)}else{o._updateCornerClass(r[t](),t)}});this._callChildMethod("refresh")}}});te.widget("ui.checkboxradio",[te.ui.formResetMixin,{version:"1.13.1",options:{disabled:null,label:null,icon:true,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var e,t;var i=this;var n=this._super()||{};this._readType();t=this.element.labels();this.label=te(t[t.length-1]);if(!this.label.length){te.error("No label found for checkboxradio widget")}this.originalLabel="";this.label.contents().not(this.element[0]).each(function(){i.originalLabel+=this.nodeType===3?te(this).text():this.outerHTML});if(this.originalLabel){n.label=this.originalLabel}e=this.element[0].disabled;if(e!=null){n.disabled=e}return n},_create:function(){var e=this.element[0].checked;this._bindFormResetHandler();if(this.options.disabled==null){this.options.disabled=this.element[0].disabled}this._setOption("disabled",this.options.disabled);this._addClass("ui-checkboxradio","ui-helper-hidden-accessible");this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget");if(this.type==="radio"){this._addClass(this.label,"ui-checkboxradio-radio-label")}if(this.options.label&&this.options.label!==this.originalLabel){this._updateLabel()}else if(this.originalLabel){this.options.label=this.originalLabel}this._enhance();if(e){this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active")}this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var e=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type;if(e!=="input"||!/radio|checkbox/.test(this.type)){te.error("Can't create checkboxradio on element.nodeName="+e+" and element.type="+this.type)}},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var e;var t=this.element[0].name;var i="input[name='"+te.escapeSelector(t)+"']";if(!t){return te([])}if(this.form.length){e=te(this.form[0].elements).filter(i)}else{e=te(i).filter(function(){return te(this)._form().length===0})}return e.not(this.element)},_toggleClasses:function(){var e=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",e);if(this.options.icon&&this.type==="checkbox"){this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",e)._toggleClass(this.icon,null,"ui-icon-blank",!e)}if(this.type==="radio"){this._getRadioGroup().each(function(){var e=te(this).checkboxradio("instance");if(e){e._removeClass(e.label,"ui-checkboxradio-checked","ui-state-active")}})}},_destroy:function(){this._unbindFormResetHandler();if(this.icon){this.icon.remove();this.iconSpace.remove()}},_setOption:function(e,t){if(e==="label"&&!t){return}this._super(e,t);if(e==="disabled"){this._toggleClass(this.label,null,"ui-state-disabled",t);this.element[0].disabled=t;return}this.refresh()},_updateIcon:function(e){var t="ui-icon ui-icon-background ";if(this.options.icon){if(!this.icon){this.icon=te("<span>");this.iconSpace=te("<span> </span>");this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")}if(this.type==="checkbox"){t+=e?"ui-icon-check ui-state-checked":"ui-icon-blank";this._removeClass(this.icon,null,e?"ui-icon-blank":"ui-icon-check")}else{t+="ui-icon-blank"}this._addClass(this.icon,"ui-checkboxradio-icon",t);if(!e){this._removeClass(this.icon,null,"ui-icon-check ui-state-checked")}this.icon.prependTo(this.label).after(this.iconSpace)}else if(this.icon!==undefined){this.icon.remove();this.iconSpace.remove();delete this.icon}},_updateLabel:function(){var e=this.label.contents().not(this.element[0]);if(this.icon){e=e.not(this.icon[0])}if(this.iconSpace){e=e.not(this.iconSpace[0])}e.remove();this.label.append(this.options.label)},refresh:function(){var e=this.element[0].checked,t=this.element[0].disabled;this._updateIcon(e);this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",e);if(this.options.label!==null){this._updateLabel()}if(t!==this.options.disabled){this._setOptions({disabled:t})}}}]);var ge=te.ui.checkboxradio;te.widget("ui.button",{version:"1.13.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:true},_getCreateOptions:function(){var e,t=this._super()||{};this.isInput=this.element.is("input");e=this.element[0].disabled;if(e!=null){t.disabled=e}this.originalLabel=this.isInput?this.element.val():this.element.html();if(this.originalLabel){t.label=this.originalLabel}return t},_create:function(){if(!this.option.showLabel&!this.options.icon){this.options.showLabel=true}if(this.options.disabled==null){this.options.disabled=this.element[0].disabled||false}this.hasTitle=!!this.element.attr("title");if(this.options.label&&this.options.label!==this.originalLabel){if(this.isInput){this.element.val(this.options.label)}else{this.element.html(this.options.label)}}this._addClass("ui-button","ui-widget");this._setOption("disabled",this.options.disabled);this._enhance();if(this.element.is("a")){this._on({keyup:function(e){if(e.keyCode===te.ui.keyCode.SPACE){e.preventDefault();if(this.element[0].click){this.element[0].click()}else{this.element.trigger("click")}}}})}},_enhance:function(){if(!this.element.is("button")){this.element.attr("role","button")}if(this.options.icon){this._updateIcon("icon",this.options.icon);this._updateTooltip()}},_updateTooltip:function(){this.title=this.element.attr("title");if(!this.options.showLabel&&!this.title){this.element.attr("title",this.options.label)}},_updateIcon:function(e,t){var i=e!=="iconPosition",n=i?this.options.iconPosition:t,r=n==="top"||n==="bottom";if(!this.icon){this.icon=te("<span>");this._addClass(this.icon,"ui-button-icon","ui-icon");if(!this.options.showLabel){this._addClass("ui-button-icon-only")}}else if(i){this._removeClass(this.icon,null,this.options.icon)}if(i){this._addClass(this.icon,null,t)}this._attachIcon(n);if(r){this._addClass(this.icon,null,"ui-widget-icon-block");if(this.iconSpace){this.iconSpace.remove()}}else{if(!this.iconSpace){this.iconSpace=te("<span> </span>");this._addClass(this.iconSpace,"ui-button-icon-space")}this._removeClass(this.icon,null,"ui-wiget-icon-block");this._attachIconSpace(n)}},_destroy:function(){this.element.removeAttr("role");if(this.icon){this.icon.remove()}if(this.iconSpace){this.iconSpace.remove()}if(!this.hasTitle){this.element.removeAttr("title")}},_attachIconSpace:function(e){this.icon[/^(?:end|bottom)/.test(e)?"before":"after"](this.iconSpace)},_attachIcon:function(e){this.element[/^(?:end|bottom)/.test(e)?"append":"prepend"](this.icon)},_setOptions:function(e){var t=e.showLabel===undefined?this.options.showLabel:e.showLabel,i=e.icon===undefined?this.options.icon:e.icon;if(!t&&!i){e.showLabel=true}this._super(e)},_setOption:function(e,t){if(e==="icon"){if(t){this._updateIcon(e,t)}else if(this.icon){this.icon.remove();if(this.iconSpace){this.iconSpace.remove()}}}if(e==="iconPosition"){this._updateIcon(e,t)}if(e==="showLabel"){this._toggleClass("ui-button-icon-only",null,!t);this._updateTooltip()}if(e==="label"){if(this.isInput){this.element.val(t)}else{this.element.html(t);if(this.icon){this._attachIcon(this.options.iconPosition);this._attachIconSpace(this.options.iconPosition)}}}this._super(e,t);if(e==="disabled"){this._toggleClass(null,"ui-state-disabled",t);this.element[0].disabled=t;if(t){this.element.trigger("blur")}}},refresh:function(){var e=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");if(e!==this.options.disabled){this._setOptions({disabled:e})}this._updateTooltip()}});if(te.uiBackCompat!==false){te.widget("ui.button",te.ui.button,{options:{text:true,icons:{primary:null,secondary:null}},_create:function(){if(this.options.showLabel&&!this.options.text){this.options.showLabel=this.options.text}if(!this.options.showLabel&&this.options.text){this.options.text=this.options.showLabel}if(!this.options.icon&&(this.options.icons.primary||this.options.icons.secondary)){if(this.options.icons.primary){this.options.icon=this.options.icons.primary}else{this.options.icon=this.options.icons.secondary;this.options.iconPosition="end"}}else if(this.options.icon){this.options.icons.primary=this.options.icon}this._super()},_setOption:function(e,t){if(e==="text"){this._super("showLabel",t);return}if(e==="showLabel"){this.options.text=t}if(e==="icon"){this.options.icons.primary=t}if(e==="icons"){if(t.primary){this._super("icon",t.primary);this._super("iconPosition","beginning")}else if(t.secondary){this._super("icon",t.secondary);this._super("iconPosition","end")}}this._superApply(arguments)}});te.fn.button=function(n){return function(r){var e=typeof r==="string";var o=Array.prototype.slice.call(arguments,1);var s=this;if(e){if(!this.length&&r==="instance"){s=undefined}else{this.each(function(){var e;var t=te(this).attr("type");var i=t!=="checkbox"&&t!=="radio"?"button":"checkboxradio";var n=te.data(this,"ui-"+i);if(r==="instance"){s=n;return false}if(!n){return te.error("cannot call methods on button"+" prior to initialization; "+"attempted to call method '"+r+"'")}if(typeof n[r]!=="function"||r.charAt(0)==="_"){return te.error("no such method '"+r+"' for button"+" widget instance")}e=n[r].apply(n,o);if(e!==n&&e!==undefined){s=e&&e.jquery?s.pushStack(e.get()):e;return false}})}}else{if(o.length){r=te.widget.extend.apply(null,[r].concat(o))}this.each(function(){var e=te(this).attr("type");var t=e!=="checkbox"&&e!=="radio"?"button":"checkboxradio";var i=te.data(this,"ui-"+t);if(i){i.option(r||{});if(i._init){i._init()}}else{if(t==="button"){n.call(te(this),r);return}te(this).checkboxradio(te.extend({icon:false},r))}})}return s}}(te.fn.button);te.fn.buttonset=function(){if(!te.ui.controlgroup){te.error("Controlgroup widget missing")}if(arguments[0]==="option"&&arguments[1]==="items"&&arguments[2]){return this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]])}if(arguments[0]==="option"&&arguments[1]==="items"){return this.controlgroup.apply(this,[arguments[0],"items.button"])}if(typeof arguments[0]==="object"&&arguments[0].items){arguments[0].items={button:arguments[0].items}}return this.controlgroup.apply(this,arguments)}}var me=te.ui.button;te.extend(te.ui,{datepicker:{version:"1.13.1"}});var D;function ve(e){var t,i;while(e.length&&e[0]!==document){t=e.css("position");if(t==="absolute"||t==="relative"||t==="fixed"){i=parseInt(e.css("zIndex"),10);if(!isNaN(i)&&i!==0){return i}}e=e.parent()}return 0}function R(){this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:"",selectMonthLabel:"Select month",selectYearLabel:"Select year"};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,onUpdateDatepicker:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};te.extend(this._defaults,this.regional[""]);this.regional.en=te.extend(true,{},this.regional[""]);this.regional["en-US"]=te.extend(true,{},this.regional.en);this.dpDiv=M(te("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}te.extend(R.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){O(this._defaults,e||{});return this},_attachDatepicker:function(e,t){var i,n,r;i=e.nodeName.toLowerCase();n=i==="div"||i==="span";if(!e.id){this.uuid+=1;e.id="dp"+this.uuid}r=this._newInst(te(e),n);r.settings=te.extend({},t||{});if(i==="input"){this._connectDatepicker(e,r)}else if(n){this._inlineDatepicker(e,r)}},_newInst:function(e,t){var i=e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:i,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:!t?this.dpDiv:M(te("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}},_connectDatepicker:function(e,t){var i=te(e);t.append=te([]);t.trigger=te([]);if(i.hasClass(this.markerClassName)){return}this._attachments(i,t);i.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp);this._autoSize(t);te.data(e,"datepicker",t);if(t.settings.disabled){this._disableDatepicker(e)}},_attachments:function(e,t){var i,n,r,o=this._get(t,"appendText"),s=this._get(t,"isRTL");if(t.append){t.append.remove()}if(o){t.append=te("<span>").addClass(this._appendClass).text(o);e[s?"before":"after"](t.append)}e.off("focus",this._showDatepicker);if(t.trigger){t.trigger.remove()}i=this._get(t,"showOn");if(i==="focus"||i==="both"){e.on("focus",this._showDatepicker)}if(i==="button"||i==="both"){n=this._get(t,"buttonText");r=this._get(t,"buttonImage");if(this._get(t,"buttonImageOnly")){t.trigger=te("<img>").addClass(this._triggerClass).attr({src:r,alt:n,title:n})}else{t.trigger=te("<button type='button'>").addClass(this._triggerClass);if(r){t.trigger.html(te("<img>").attr({src:r,alt:n,title:n}))}else{t.trigger.text(n)}}e[s?"before":"after"](t.trigger);t.trigger.on("click",function(){if(te.datepicker._datepickerShowing&&te.datepicker._lastInput===e[0]){te.datepicker._hideDatepicker()}else if(te.datepicker._datepickerShowing&&te.datepicker._lastInput!==e[0]){te.datepicker._hideDatepicker();te.datepicker._showDatepicker(e[0])}else{te.datepicker._showDatepicker(e[0])}return false})}},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,n,r,o=new Date(2009,12-1,20),s=this._get(e,"dateFormat");if(s.match(/[DM]/)){t=function(e){i=0;n=0;for(r=0;r<e.length;r++){if(e[r].length>i){i=e[r].length;n=r}}return n};o.setMonth(t(this._get(e,s.match(/MM/)?"monthNames":"monthNamesShort")));o.setDate(t(this._get(e,s.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())}e.input.attr("size",this._formatDate(e,o).length)}},_inlineDatepicker:function(e,t){var i=te(e);if(i.hasClass(this.markerClassName)){return}i.addClass(this.markerClassName).append(t.dpDiv);te.data(e,"datepicker",t);this._setDate(t,this._getDefaultDate(t),true);this._updateDatepicker(t);this._updateAlternate(t);if(t.settings.disabled){this._disableDatepicker(e)}t.dpDiv.css("display","block")},_dialogDatepicker:function(e,t,i,n,r){var o,s,a,l,c,u=this._dialogInst;if(!u){this.uuid+=1;o="dp"+this.uuid;this._dialogInput=te("<input type='text' id='"+o+"' style='position: absolute; top: -100px; width: 0px;'/>");this._dialogInput.on("keydown",this._doKeyDown);te("body").append(this._dialogInput);u=this._dialogInst=this._newInst(this._dialogInput,false);u.settings={};te.data(this._dialogInput[0],"datepicker",u)}O(u.settings,n||{});t=t&&t.constructor===Date?this._formatDate(u,t):t;this._dialogInput.val(t);this._pos=r?r.length?r:[r.pageX,r.pageY]:null;if(!this._pos){s=document.documentElement.clientWidth;a=document.documentElement.clientHeight;l=document.documentElement.scrollLeft||document.body.scrollLeft;c=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[s/2-100+l,a/2-150+c]}this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");u.settings.onSelect=i;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if(te.blockUI){te.blockUI(this.dpDiv)}te.data(this._dialogInput[0],"datepicker",u);return this},_destroyDatepicker:function(e){var t,i=te(e),n=te.data(e,"datepicker");if(!i.hasClass(this.markerClassName)){return}t=e.nodeName.toLowerCase();te.removeData(e,"datepicker");if(t==="input"){n.append.remove();n.trigger.remove();i.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)}else if(t==="div"||t==="span"){i.removeClass(this.markerClassName).empty()}if(D===n){D=null;this._curInst=null}},_enableDatepicker:function(t){var e,i,n=te(t),r=te.data(t,"datepicker");if(!n.hasClass(this.markerClassName)){return}e=t.nodeName.toLowerCase();if(e==="input"){t.disabled=false;r.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else if(e==="div"||e==="span"){i=n.children("."+this._inlineClass);i.children().removeClass("ui-state-disabled");i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",false)}this._disabledInputs=te.map(this._disabledInputs,function(e){return e===t?null:e})},_disableDatepicker:function(t){var e,i,n=te(t),r=te.data(t,"datepicker");if(!n.hasClass(this.markerClassName)){return}e=t.nodeName.toLowerCase();if(e==="input"){t.disabled=true;r.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else if(e==="div"||e==="span"){i=n.children("."+this._inlineClass);i.children().addClass("ui-state-disabled");i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",true)}this._disabledInputs=te.map(this._disabledInputs,function(e){return e===t?null:e});this._disabledInputs[this._disabledInputs.length]=t},_isDisabledDatepicker:function(e){if(!e){return false}for(var t=0;t<this._disabledInputs.length;t++){if(this._disabledInputs[t]===e){return true}}return false},_getInst:function(e){try{return te.data(e,"datepicker")}catch(e){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,i){var n,r,o,s,a=this._getInst(e);if(arguments.length===2&&typeof t==="string"){return t==="defaults"?te.extend({},te.datepicker._defaults):a?t==="all"?te.extend({},a.settings):this._get(a,t):null}n=t||{};if(typeof t==="string"){n={};n[t]=i}if(a){if(this._curInst===a){this._hideDatepicker()}r=this._getDateDatepicker(e,true);o=this._getMinMaxDate(a,"min");s=this._getMinMaxDate(a,"max");O(a.settings,n);if(o!==null&&n.dateFormat!==undefined&&n.minDate===undefined){a.settings.minDate=this._formatDate(a,o)}if(s!==null&&n.dateFormat!==undefined&&n.maxDate===undefined){a.settings.maxDate=this._formatDate(a,s)}if("disabled"in n){if(n.disabled){this._disableDatepicker(e)}else{this._enableDatepicker(e)}}this._attachments(te(e),a);this._autoSize(a);this._setDate(a,r);this._updateAlternate(a);this._updateDatepicker(a)}},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);if(t){this._updateDatepicker(t)}},_setDateDatepicker:function(e,t){var i=this._getInst(e);if(i){this._setDate(i,t);this._updateDatepicker(i);this._updateAlternate(i)}},_getDateDatepicker:function(e,t){var i=this._getInst(e);if(i&&!i.inline){this._setDateFromField(i,t)}return i?this._getDate(i):null},_doKeyDown:function(e){var t,i,n,r=te.datepicker._getInst(e.target),o=true,s=r.dpDiv.is(".ui-datepicker-rtl");r._keyEvent=true;if(te.datepicker._datepickerShowing){switch(e.keyCode){case 9:te.datepicker._hideDatepicker();o=false;break;case 13:n=te("td."+te.datepicker._dayOverClass+":not(."+te.datepicker._currentClass+")",r.dpDiv);if(n[0]){te.datepicker._selectDay(e.target,r.selectedMonth,r.selectedYear,n[0])}t=te.datepicker._get(r,"onSelect");if(t){i=te.datepicker._formatDate(r);t.apply(r.input?r.input[0]:null,[i,r])}else{te.datepicker._hideDatepicker()}return false;case 27:te.datepicker._hideDatepicker();break;case 33:te.datepicker._adjustDate(e.target,e.ctrlKey?-te.datepicker._get(r,"stepBigMonths"):-te.datepicker._get(r,"stepMonths"),"M");break;case 34:te.datepicker._adjustDate(e.target,e.ctrlKey?+te.datepicker._get(r,"stepBigMonths"):+te.datepicker._get(r,"stepMonths"),"M");break;case 35:if(e.ctrlKey||e.metaKey){te.datepicker._clearDate(e.target)}o=e.ctrlKey||e.metaKey;break;case 36:if(e.ctrlKey||e.metaKey){te.datepicker._gotoToday(e.target)}o=e.ctrlKey||e.metaKey;break;case 37:if(e.ctrlKey||e.metaKey){te.datepicker._adjustDate(e.target,s?+1:-1,"D")}o=e.ctrlKey||e.metaKey;if(e.originalEvent.altKey){te.datepicker._adjustDate(e.target,e.ctrlKey?-te.datepicker._get(r,"stepBigMonths"):-te.datepicker._get(r,"stepMonths"),"M")}break;case 38:if(e.ctrlKey||e.metaKey){te.datepicker._adjustDate(e.target,-7,"D")}o=e.ctrlKey||e.metaKey;break;case 39:if(e.ctrlKey||e.metaKey){te.datepicker._adjustDate(e.target,s?-1:+1,"D")}o=e.ctrlKey||e.metaKey;if(e.originalEvent.altKey){te.datepicker._adjustDate(e.target,e.ctrlKey?+te.datepicker._get(r,"stepBigMonths"):+te.datepicker._get(r,"stepMonths"),"M")}break;case 40:if(e.ctrlKey||e.metaKey){te.datepicker._adjustDate(e.target,+7,"D")}o=e.ctrlKey||e.metaKey;break;default:o=false}}else if(e.keyCode===36&&e.ctrlKey){te.datepicker._showDatepicker(this)}else{o=false}if(o){e.preventDefault();e.stopPropagation()}},_doKeyPress:function(e){var t,i,n=te.datepicker._getInst(e.target);if(te.datepicker._get(n,"constrainInput")){t=te.datepicker._possibleChars(te.datepicker._get(n,"dateFormat"));i=String.fromCharCode(e.charCode==null?e.keyCode:e.charCode);return e.ctrlKey||e.metaKey||(i<" "||!t||t.indexOf(i)>-1)}},_doKeyUp:function(e){var t,i=te.datepicker._getInst(e.target);if(i.input.val()!==i.lastVal){try{t=te.datepicker.parseDate(te.datepicker._get(i,"dateFormat"),i.input?i.input.val():null,te.datepicker._getFormatConfig(i));if(t){te.datepicker._setDateFromField(i);te.datepicker._updateAlternate(i);te.datepicker._updateDatepicker(i)}}catch(e){}}return true},_showDatepicker:function(e){e=e.target||e;if(e.nodeName.toLowerCase()!=="input"){e=te("input",e.parentNode)[0]}if(te.datepicker._isDisabledDatepicker(e)||te.datepicker._lastInput===e){return}var t,i,n,r,o,s,a;t=te.datepicker._getInst(e);if(te.datepicker._curInst&&te.datepicker._curInst!==t){te.datepicker._curInst.dpDiv.stop(true,true);if(t&&te.datepicker._datepickerShowing){te.datepicker._hideDatepicker(te.datepicker._curInst.input[0])}}i=te.datepicker._get(t,"beforeShow");n=i?i.apply(e,[e,t]):{};if(n===false){return}O(t.settings,n);t.lastVal=null;te.datepicker._lastInput=e;te.datepicker._setDateFromField(t);if(te.datepicker._inDialog){e.value=""}if(!te.datepicker._pos){te.datepicker._pos=te.datepicker._findPos(e);te.datepicker._pos[1]+=e.offsetHeight}r=false;te(e).parents().each(function(){r|=te(this).css("position")==="fixed";return!r});o={left:te.datepicker._pos[0],top:te.datepicker._pos[1]};te.datepicker._pos=null;t.dpDiv.empty();t.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});te.datepicker._updateDatepicker(t);o=te.datepicker._checkOffset(t,o,r);t.dpDiv.css({position:te.datepicker._inDialog&&te.blockUI?"static":r?"fixed":"absolute",display:"none",left:o.left+"px",top:o.top+"px"});if(!t.inline){s=te.datepicker._get(t,"showAnim");a=te.datepicker._get(t,"duration");t.dpDiv.css("z-index",ve(te(e))+1);te.datepicker._datepickerShowing=true;if(te.effects&&te.effects.effect[s]){t.dpDiv.show(s,te.datepicker._get(t,"showOptions"),a)}else{t.dpDiv[s||"show"](s?a:null)}if(te.datepicker._shouldFocusInput(t)){t.input.trigger("focus")}te.datepicker._curInst=t}},_updateDatepicker:function(e){this.maxRows=4;D=e;e.dpDiv.empty().append(this._generateHTML(e));this._attachHandlers(e);var t,i=this._getNumberOfMonths(e),n=i[1],r=17,o=e.dpDiv.find("."+this._dayOverClass+" a"),s=te.datepicker._get(e,"onUpdateDatepicker");if(o.length>0){k.apply(o.get(0))}e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(n>1){e.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",r*n+"em")}e.dpDiv[(i[0]!==1||i[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi");e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(e===te.datepicker._curInst&&te.datepicker._datepickerShowing&&te.datepicker._shouldFocusInput(e)){e.input.trigger("focus")}if(e.yearshtml){t=e.yearshtml;setTimeout(function(){if(t===e.yearshtml&&e.yearshtml){e.dpDiv.find("select.ui-datepicker-year").first().replaceWith(e.yearshtml)}t=e.yearshtml=null},0)}if(s){s.apply(e.input?e.input[0]:null,[e])}},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(e,t,i){var n=e.dpDiv.outerWidth(),r=e.dpDiv.outerHeight(),o=e.input?e.input.outerWidth():0,s=e.input?e.input.outerHeight():0,a=document.documentElement.clientWidth+(i?0:te(document).scrollLeft()),l=document.documentElement.clientHeight+(i?0:te(document).scrollTop());t.left-=this._get(e,"isRTL")?n-o:0;t.left-=i&&t.left===e.input.offset().left?te(document).scrollLeft():0;t.top-=i&&t.top===e.input.offset().top+s?te(document).scrollTop():0;t.left-=Math.min(t.left,t.left+n>a&&a>n?Math.abs(t.left+n-a):0);t.top-=Math.min(t.top,t.top+r>l&&l>r?Math.abs(r+s):0);return t},_findPos:function(e){var t,i=this._getInst(e),n=this._get(i,"isRTL");while(e&&(e.type==="hidden"||e.nodeType!==1||te.expr.pseudos.hidden(e))){e=e[n?"previousSibling":"nextSibling"]}t=te(e).offset();return[t.left,t.top]},_hideDatepicker:function(e){var t,i,n,r,o=this._curInst;if(!o||e&&o!==te.data(e,"datepicker")){return}if(this._datepickerShowing){t=this._get(o,"showAnim");i=this._get(o,"duration");n=function(){te.datepicker._tidyDialog(o)};if(te.effects&&(te.effects.effect[t]||te.effects[t])){o.dpDiv.hide(t,te.datepicker._get(o,"showOptions"),i,n)}else{o.dpDiv[t==="slideDown"?"slideUp":t==="fadeIn"?"fadeOut":"hide"](t?i:null,n)}if(!t){n()}this._datepickerShowing=false;r=this._get(o,"onClose");if(r){r.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o])}this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if(te.blockUI){te.unblockUI();te("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(!te.datepicker._curInst){return}var t=te(e.target),i=te.datepicker._getInst(t[0]);if(t[0].id!==te.datepicker._mainDivId&&t.parents("#"+te.datepicker._mainDivId).length===0&&!t.hasClass(te.datepicker.markerClassName)&&!t.closest("."+te.datepicker._triggerClass).length&&te.datepicker._datepickerShowing&&!(te.datepicker._inDialog&&te.blockUI)||t.hasClass(te.datepicker.markerClassName)&&te.datepicker._curInst!==i){te.datepicker._hideDatepicker()}},_adjustDate:function(e,t,i){var n=te(e),r=this._getInst(n[0]);if(this._isDisabledDatepicker(n[0])){return}this._adjustInstDate(r,t,i);this._updateDatepicker(r)},_gotoToday:function(e){var t,i=te(e),n=this._getInst(i[0]);if(this._get(n,"gotoCurrent")&&n.currentDay){n.selectedDay=n.currentDay;n.drawMonth=n.selectedMonth=n.currentMonth;n.drawYear=n.selectedYear=n.currentYear}else{t=new Date;n.selectedDay=t.getDate();n.drawMonth=n.selectedMonth=t.getMonth();n.drawYear=n.selectedYear=t.getFullYear()}this._notifyChange(n);this._adjustDate(i)},_selectMonthYear:function(e,t,i){var n=te(e),r=this._getInst(n[0]);r["selected"+(i==="M"?"Month":"Year")]=r["draw"+(i==="M"?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10);this._notifyChange(r);this._adjustDate(n)},_selectDay:function(e,t,i,n){var r,o=te(e);if(te(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])){return}r=this._getInst(o[0]);r.selectedDay=r.currentDay=parseInt(te("a",n).attr("data-date"));r.selectedMonth=r.currentMonth=t;r.selectedYear=r.currentYear=i;this._selectDate(e,this._formatDate(r,r.currentDay,r.currentMonth,r.currentYear))},_clearDate:function(e){var t=te(e);this._selectDate(t,"")},_selectDate:function(e,t){var i,n=te(e),r=this._getInst(n[0]);t=t!=null?t:this._formatDate(r);if(r.input){r.input.val(t)}this._updateAlternate(r);i=this._get(r,"onSelect");if(i){i.apply(r.input?r.input[0]:null,[t,r])}else if(r.input){r.input.trigger("change")}if(r.inline){this._updateDatepicker(r)}else{this._hideDatepicker();this._lastInput=r.input[0];if(typeof r.input[0]!=="object"){r.input.trigger("focus")}this._lastInput=null}},_updateAlternate:function(e){var t,i,n,r=this._get(e,"altField");if(r){t=this._get(e,"altFormat")||this._get(e,"dateFormat");i=this._getDate(e);n=this.formatDate(t,i,this._getFormatConfig(e));te(document).find(r).val(n)}},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());i.setDate(i.getDate()+4-(i.getDay()||7));t=i.getTime();i.setMonth(0);i.setDate(1);return Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(i,s,e){if(i==null||s==null){throw"Invalid arguments"}s=typeof s==="object"?s.toString():s+"";if(s===""){return null}var n,t,r,a=0,o=(e?e.shortYearCutoff:null)||this._defaults.shortYearCutoff,l=typeof o!=="string"?o:(new Date).getFullYear()%100+parseInt(o,10),c=(e?e.dayNamesShort:null)||this._defaults.dayNamesShort,u=(e?e.dayNames:null)||this._defaults.dayNames,d=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort,h=(e?e.monthNames:null)||this._defaults.monthNames,f=-1,p=-1,g=-1,m=-1,v=false,y,b=function(e){var t=n+1<i.length&&i.charAt(n+1)===e;if(t){n++}return t},_=function(e){var t=b(e),i=e==="@"?14:e==="!"?20:e==="y"&&t?4:e==="o"?3:2,n=e==="y"?i:1,r=new RegExp("^\\d{"+n+","+i+"}"),o=s.substring(a).match(r);if(!o){throw"Missing number at position "+a}a+=o[0].length;return parseInt(o[0],10)},w=function(e,t,i){var n=-1,r=te.map(b(e)?i:t,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});te.each(r,function(e,t){var i=t[1];if(s.substr(a,i.length).toLowerCase()===i.toLowerCase()){n=t[0];a+=i.length;return false}});if(n!==-1){return n+1}else{throw"Unknown name at position "+a}},C=function(){if(s.charAt(a)!==i.charAt(n)){throw"Unexpected literal at position "+a}a++};for(n=0;n<i.length;n++){if(v){if(i.charAt(n)==="'"&&!b("'")){v=false}else{C()}}else{switch(i.charAt(n)){case"d":g=_("d");break;case"D":w("D",c,u);break;case"o":m=_("o");break;case"m":p=_("m");break;case"M":p=w("M",d,h);break;case"y":f=_("y");break;case"@":y=new Date(_("@"));f=y.getFullYear();p=y.getMonth()+1;g=y.getDate();break;case"!":y=new Date((_("!")-this._ticksTo1970)/1e4);f=y.getFullYear();p=y.getMonth()+1;g=y.getDate();break;case"'":if(b("'")){C()}else{v=true}break;default:C()}}}if(a<s.length){r=s.substr(a);if(!/^\s+/.test(r)){throw"Extra/unparsed characters found in date: "+r}}if(f===-1){f=(new Date).getFullYear()}else if(f<100){f+=(new Date).getFullYear()-(new Date).getFullYear()%100+(f<=l?0:-100)}if(m>-1){p=1;g=m;do{t=this._getDaysInMonth(f,p-1);if(g<=t){break}p++;g-=t}while(true)}y=this._daylightSavingAdjust(new Date(f,p-1,g));if(y.getFullYear()!==f||y.getMonth()+1!==p||y.getDate()!==g){throw"Invalid date"}return y},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*1e7,formatDate:function(i,e,t){if(!e){return""}var n,r=(t?t.dayNamesShort:null)||this._defaults.dayNamesShort,o=(t?t.dayNames:null)||this._defaults.dayNames,s=(t?t.monthNamesShort:null)||this._defaults.monthNamesShort,a=(t?t.monthNames:null)||this._defaults.monthNames,l=function(e){var t=n+1<i.length&&i.charAt(n+1)===e;if(t){n++}return t},c=function(e,t,i){var n=""+t;if(l(e)){while(n.length<i){n="0"+n}}return n},u=function(e,t,i,n){return l(e)?n[t]:i[t]},d="",h=false;if(e){for(n=0;n<i.length;n++){if(h){if(i.charAt(n)==="'"&&!l("'")){h=false}else{d+=i.charAt(n)}}else{switch(i.charAt(n)){case"d":d+=c("d",e.getDate(),2);break;case"D":d+=u("D",e.getDay(),r,o);break;case"o":d+=c("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=c("m",e.getMonth()+1,2);break;case"M":d+=u("M",e.getMonth(),s,a);break;case"y":d+=l("y")?e.getFullYear():(e.getFullYear()%100<10?"0":"")+e.getFullYear()%100;break;case"@":d+=e.getTime();break;case"!":d+=e.getTime()*1e4+this._ticksTo1970;break;case"'":if(l("'")){d+="'"}else{h=true}break;default:d+=i.charAt(n)}}}}return d},_possibleChars:function(i){var n,e="",t=false,r=function(e){var t=n+1<i.length&&i.charAt(n+1)===e;if(t){n++}return t};for(n=0;n<i.length;n++){if(t){if(i.charAt(n)==="'"&&!r("'")){t=false}else{e+=i.charAt(n)}}else{switch(i.charAt(n)){case"d":case"m":case"y":case"@":e+="0123456789";break;case"D":case"M":return null;case"'":if(r("'")){e+="'"}else{t=true}break;default:e+=i.charAt(n)}}}return e},_get:function(e,t){return e.settings[t]!==undefined?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()===e.lastVal){return}var i=this._get(e,"dateFormat"),n=e.lastVal=e.input?e.input.val():null,r=this._getDefaultDate(e),o=r,s=this._getFormatConfig(e);try{o=this.parseDate(i,n,s)||r}catch(e){n=t?"":n}e.selectedDay=o.getDate();e.drawMonth=e.selectedMonth=o.getMonth();e.drawYear=e.selectedYear=o.getFullYear();e.currentDay=n?o.getDate():0;e.currentMonth=n?o.getMonth():0;e.currentYear=n?o.getFullYear():0;this._adjustInstDate(e)},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(a,e,t){var i=function(e){var t=new Date;t.setDate(t.getDate()+e);return t},n=function(e){try{return te.datepicker.parseDate(te.datepicker._get(a,"dateFormat"),e,te.datepicker._getFormatConfig(a))}catch(e){}var t=(e.toLowerCase().match(/^c/)?te.datepicker._getDate(a):null)||new Date,i=t.getFullYear(),n=t.getMonth(),r=t.getDate(),o=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,s=o.exec(e);while(s){switch(s[2]||"d"){case"d":case"D":r+=parseInt(s[1],10);break;case"w":case"W":r+=parseInt(s[1],10)*7;break;case"m":case"M":n+=parseInt(s[1],10);r=Math.min(r,te.datepicker._getDaysInMonth(i,n));break;case"y":case"Y":i+=parseInt(s[1],10);r=Math.min(r,te.datepicker._getDaysInMonth(i,n));break}s=o.exec(e)}return new Date(i,n,r)},r=e==null||e===""?t:typeof e==="string"?n(e):typeof e==="number"?isNaN(e)?t:i(e):new Date(e.getTime());r=r&&r.toString()==="Invalid Date"?t:r;if(r){r.setHours(0);r.setMinutes(0);r.setSeconds(0);r.setMilliseconds(0)}return this._daylightSavingAdjust(r)},_daylightSavingAdjust:function(e){if(!e){return null}e.setHours(e.getHours()>12?e.getHours()+2:0);return e},_setDate:function(e,t,i){var n=!t,r=e.selectedMonth,o=e.selectedYear,s=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=s.getDate();e.drawMonth=e.selectedMonth=e.currentMonth=s.getMonth();e.drawYear=e.selectedYear=e.currentYear=s.getFullYear();if((r!==e.selectedMonth||o!==e.selectedYear)&&!i){this._notifyChange(e)}this._adjustInstDate(e);if(e.input){e.input.val(n?"":this._formatDate(e))}},_getDate:function(e){var t=!e.currentYear||e.input&&e.input.val()===""?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(e){var t=this._get(e,"stepMonths"),i="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){te.datepicker._adjustDate(i,-t,"M")},next:function(){te.datepicker._adjustDate(i,+t,"M")},hide:function(){te.datepicker._hideDatepicker()},today:function(){te.datepicker._gotoToday(i)},selectDay:function(){te.datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false},selectMonth:function(){te.datepicker._selectMonthYear(i,this,"M");return false},selectYear:function(){te.datepicker._selectMonthYear(i,this,"Y");return false}};te(this).on(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,n,r,o,s,a,l,c,u,d,P,F,G,$,h,f,H,p,g,m,v,y,b,_,w,C,x,B,V,j,S,z,A,W,U,E,T,D,Y=new Date,q=this._daylightSavingAdjust(new Date(Y.getFullYear(),Y.getMonth(),Y.getDate())),R=this._get(e,"isRTL"),K=this._get(e,"showButtonPanel"),X=this._get(e,"hideIfNoPrevNext"),Z=this._get(e,"navigationAsDateFormat"),M=this._getNumberOfMonths(e),Q=this._get(e,"showCurrentAtPos"),J=this._get(e,"stepMonths"),ee=M[0]!==1||M[1]!==1,k=this._daylightSavingAdjust(!e.currentDay?new Date(9999,9,9):new Date(e.currentYear,e.currentMonth,e.currentDay)),O=this._getMinMaxDate(e,"min"),N=this._getMinMaxDate(e,"max"),I=e.drawMonth-Q,L=e.drawYear;if(I<0){I+=12;L--}if(N){t=this._daylightSavingAdjust(new Date(N.getFullYear(),N.getMonth()-M[0]*M[1]+1,N.getDate()));t=O&&t<O?O:t;while(this._daylightSavingAdjust(new Date(L,I,1))>t){I--;if(I<0){I=11;L--}}}e.drawMonth=I;e.drawYear=L;i=this._get(e,"prevText");i=!Z?i:this.formatDate(i,this._daylightSavingAdjust(new Date(L,I-J,1)),this._getFormatConfig(e));if(this._canAdjustMonth(e,-1,L,I)){n=te("<a>").attr({class:"ui-datepicker-prev ui-corner-all","data-handler":"prev","data-event":"click",title:i}).append(te("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(R?"e":"w")).text(i))[0].outerHTML}else if(X){n=""}else{n=te("<a>").attr({class:"ui-datepicker-prev ui-corner-all ui-state-disabled",title:i}).append(te("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(R?"e":"w")).text(i))[0].outerHTML}r=this._get(e,"nextText");r=!Z?r:this.formatDate(r,this._daylightSavingAdjust(new Date(L,I+J,1)),this._getFormatConfig(e));if(this._canAdjustMonth(e,+1,L,I)){o=te("<a>").attr({class:"ui-datepicker-next ui-corner-all","data-handler":"next","data-event":"click",title:r}).append(te("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(R?"w":"e")).text(r))[0].outerHTML}else if(X){o=""}else{o=te("<a>").attr({class:"ui-datepicker-next ui-corner-all ui-state-disabled",title:r}).append(te("<span>").attr("class","ui-icon ui-icon-circle-triangle-"+(R?"w":"e")).text(r))[0].outerHTML}s=this._get(e,"currentText");a=this._get(e,"gotoCurrent")&&e.currentDay?k:q;s=!Z?s:this.formatDate(s,a,this._getFormatConfig(e));l="";if(!e.inline){l=te("<button>").attr({type:"button",class:"ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all","data-handler":"hide","data-event":"click"}).text(this._get(e,"closeText"))[0].outerHTML}c="";if(K){c=te("<div class='ui-datepicker-buttonpane ui-widget-content'>").append(R?l:"").append(this._isInRange(e,a)?te("<button>").attr({type:"button",class:"ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all","data-handler":"today","data-event":"click"}).text(s):"").append(R?"":l)[0].outerHTML}u=parseInt(this._get(e,"firstDay"),10);u=isNaN(u)?0:u;d=this._get(e,"showWeek");P=this._get(e,"dayNames");F=this._get(e,"dayNamesMin");G=this._get(e,"monthNames");$=this._get(e,"monthNamesShort");h=this._get(e,"beforeShowDay");f=this._get(e,"showOtherMonths");H=this._get(e,"selectOtherMonths");p=this._getDefaultDate(e);g="";for(v=0;v<M[0];v++){y="";this.maxRows=4;for(b=0;b<M[1];b++){_=this._daylightSavingAdjust(new Date(L,I,e.selectedDay));w=" ui-corner-all";C="";if(ee){C+="<div class='ui-datepicker-group";if(M[1]>1){switch(b){case 0:C+=" ui-datepicker-group-first";w=" ui-corner-"+(R?"right":"left");break;case M[1]-1:C+=" ui-datepicker-group-last";w=" ui-corner-"+(R?"left":"right");break;default:C+=" ui-datepicker-group-middle";w="";break}}C+="'>"}C+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+w+"'>"+(/all|left/.test(w)&&v===0?R?o:n:"")+(/all|right/.test(w)&&v===0?R?n:o:"")+this._generateMonthYearHeader(e,I,L,O,N,v>0||b>0,G,$)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>";x=d?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"";for(m=0;m<7;m++){B=(m+u)%7;x+="<th scope='col'"+((m+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+P[B]+"'>"+F[B]+"</span></th>"}C+=x+"</tr></thead><tbody>";V=this._getDaysInMonth(L,I);if(L===e.selectedYear&&I===e.selectedMonth){e.selectedDay=Math.min(e.selectedDay,V)}j=(this._getFirstDayOfMonth(L,I)-u+7)%7;S=Math.ceil((j+V)/7);z=ee?this.maxRows>S?this.maxRows:S:S;this.maxRows=z;A=this._daylightSavingAdjust(new Date(L,I,1-j));for(W=0;W<z;W++){C+="<tr>";U=!d?"":"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(A)+"</td>";for(m=0;m<7;m++){E=h?h.apply(e.input?e.input[0]:null,[A]):[true,""];T=A.getMonth()!==I;D=T&&!H||!E[0]||O&&A<O||N&&A>N;U+="<td class='"+((m+u+6)%7>=5?" ui-datepicker-week-end":"")+(T?" ui-datepicker-other-month":"")+(A.getTime()===_.getTime()&&I===e.selectedMonth&&e._keyEvent||p.getTime()===A.getTime()&&p.getTime()===_.getTime()?" "+this._dayOverClass:"")+(D?" "+this._unselectableClass+" ui-state-disabled":"")+(T&&!f?"":" "+E[1]+(A.getTime()===k.getTime()?" "+this._currentClass:"")+(A.getTime()===q.getTime()?" ui-datepicker-today":""))+"'"+((!T||f)&&E[2]?" title='"+E[2].replace(/'/g,"&#39;")+"'":"")+(D?"":" data-handler='selectDay' data-event='click' data-month='"+A.getMonth()+"' data-year='"+A.getFullYear()+"'")+">"+(T&&!f?"&#xa0;":D?"<span class='ui-state-default'>"+A.getDate()+"</span>":"<a class='ui-state-default"+(A.getTime()===q.getTime()?" ui-state-highlight":"")+(A.getTime()===k.getTime()?" ui-state-active":"")+(T?" ui-priority-secondary":"")+"' href='#' aria-current='"+(A.getTime()===k.getTime()?"true":"false")+"' data-date='"+A.getDate()+"'>"+A.getDate()+"</a>")+"</td>";A.setDate(A.getDate()+1);A=this._daylightSavingAdjust(A)}C+=U+"</tr>"}I++;if(I>11){I=0;L++}C+="</tbody></table>"+(ee?"</div>"+(M[0]>0&&b===M[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"");y+=C}g+=y}g+=c;e._keyEvent=false;return g},_generateMonthYearHeader:function(e,t,i,n,r,o,s,a){var l,c,u,d,h,f,p,g,m=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b=this._get(e,"selectMonthLabel"),_=this._get(e,"selectYearLabel"),w="<div class='ui-datepicker-title'>",C="";if(o||!m){C+="<span class='ui-datepicker-month'>"+s[t]+"</span>"}else{l=n&&n.getFullYear()===i;c=r&&r.getFullYear()===i;C+="<select class='ui-datepicker-month' aria-label='"+b+"' data-handler='selectMonth' data-event='change'>";for(u=0;u<12;u++){if((!l||u>=n.getMonth())&&(!c||u<=r.getMonth())){C+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+a[u]+"</option>"}}C+="</select>"}if(!y){w+=C+(o||!(m&&v)?"&#xa0;":"")}if(!e.yearshtml){e.yearshtml="";if(o||!v){w+="<span class='ui-datepicker-year'>"+i+"</span>"}else{d=this._get(e,"yearRange").split(":");h=(new Date).getFullYear();f=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t};p=f(d[0]);g=Math.max(p,f(d[1]||""));p=n?Math.max(p,n.getFullYear()):p;g=r?Math.min(g,r.getFullYear()):g;e.yearshtml+="<select class='ui-datepicker-year' aria-label='"+_+"' data-handler='selectYear' data-event='change'>";for(;p<=g;p++){e.yearshtml+="<option value='"+p+"'"+(p===i?" selected='selected'":"")+">"+p+"</option>"}e.yearshtml+="</select>";w+=e.yearshtml;e.yearshtml=null}}w+=this._get(e,"yearSuffix");if(y){w+=(o||!(m&&v)?"&#xa0;":"")+C}w+="</div>";return w},_adjustInstDate:function(e,t,i){var n=e.selectedYear+(i==="Y"?t:0),r=e.selectedMonth+(i==="M"?t:0),o=Math.min(e.selectedDay,this._getDaysInMonth(n,r))+(i==="D"?t:0),s=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(n,r,o)));e.selectedDay=s.getDate();e.drawMonth=e.selectedMonth=s.getMonth();e.drawYear=e.selectedYear=s.getFullYear();if(i==="M"||i==="Y"){this._notifyChange(e)}},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),n=this._getMinMaxDate(e,"max"),r=i&&t<i?i:t;return n&&r>n?n:r},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");if(t){t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])}},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return t==null?[1,1]:typeof t==="number"?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,n){var r=this._getNumberOfMonths(e),o=this._daylightSavingAdjust(new Date(i,n+(t<0?t:r[0]*r[1]),1));if(t<0){o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth()))}return this._isInRange(e,o)},_isInRange:function(e,t){var i,n,r=this._getMinMaxDate(e,"min"),o=this._getMinMaxDate(e,"max"),s=null,a=null,l=this._get(e,"yearRange");if(l){i=l.split(":");n=(new Date).getFullYear();s=parseInt(i[0],10);a=parseInt(i[1],10);if(i[0].match(/[+\-].*/)){s+=n}if(i[1].match(/[+\-].*/)){a+=n}}return(!r||t.getTime()>=r.getTime())&&(!o||t.getTime()<=o.getTime())&&(!s||t.getFullYear()>=s)&&(!a||t.getFullYear()<=a)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");t=typeof t!=="string"?t:(new Date).getFullYear()%100+parseInt(t,10);return{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,n){if(!t){e.currentDay=e.selectedDay;e.currentMonth=e.selectedMonth;e.currentYear=e.selectedYear}var r=t?typeof t==="object"?t:this._daylightSavingAdjust(new Date(n,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),r,this._getFormatConfig(e))}});function M(e){var t="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.on("mouseout",t,function(){te(this).removeClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){te(this).removeClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){te(this).removeClass("ui-datepicker-next-hover")}}).on("mouseover",t,k)}function k(){if(!te.datepicker._isDisabledDatepicker(D.inline?D.dpDiv.parent()[0]:D.input[0])){te(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");te(this).addClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){te(this).addClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){te(this).addClass("ui-datepicker-next-hover")}}}function O(e,t){te.extend(e,t);for(var i in t){if(t[i]==null){e[i]=t[i]}}return e}te.fn.datepicker=function(e){if(!this.length){return this}if(!te.datepicker.initialized){te(document).on("mousedown",te.datepicker._checkExternalClick);te.datepicker.initialized=true}if(te("#"+te.datepicker._mainDivId).length===0){te("body").append(te.datepicker.dpDiv)}var t=Array.prototype.slice.call(arguments,1);if(typeof e==="string"&&(e==="isDisabled"||e==="getDate"||e==="widget")){return te.datepicker["_"+e+"Datepicker"].apply(te.datepicker,[this[0]].concat(t))}if(e==="option"&&arguments.length===2&&typeof arguments[1]==="string"){return te.datepicker["_"+e+"Datepicker"].apply(te.datepicker,[this[0]].concat(t))}return this.each(function(){if(typeof e==="string"){te.datepicker["_"+e+"Datepicker"].apply(te.datepicker,[this].concat(t))}else{te.datepicker._attachDatepicker(this,e)}})};te.datepicker=new R;te.datepicker.initialized=false;te.datepicker.uuid=(new Date).getTime();te.datepicker.version="1.13.1";var ye=te.datepicker;var be=te.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var N=false;te(document).on("mouseup",function(){N=false});var _e=te.widget("ui.mouse",{version:"1.13.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.on("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).on("click."+this.widgetName,function(e){if(true===te.data(e.target,t.widgetName+".preventClickEvent")){te.removeData(e.target,t.widgetName+".preventClickEvent");e.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.off("."+this.widgetName);if(this._mouseMoveDelegate){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)}},_mouseDown:function(e){if(N){return}this._mouseMoved=false;if(this._mouseStarted){this._mouseUp(e)}this._mouseDownEvent=e;var t=this,i=e.which===1,n=typeof this.options.cancel==="string"&&e.target.nodeName?te(e.target).closest(this.options.cancel).length:false;if(!i||n||!this._mouseCapture(e)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){t.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)){this._mouseStarted=this._mouseStart(e)!==false;if(!this._mouseStarted){e.preventDefault();return true}}if(true===te.data(e.target,this.widgetName+".preventClickEvent")){te.removeData(e.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(e){return t._mouseMove(e)};this._mouseUpDelegate=function(e){return t._mouseUp(e)};this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate);e.preventDefault();N=true;return true},_mouseMove:function(e){if(this._mouseMoved){if(te.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button){return this._mouseUp(e)}else if(!e.which){if(e.originalEvent.altKey||e.originalEvent.ctrlKey||e.originalEvent.metaKey||e.originalEvent.shiftKey){this.ignoreMissingWhich=true}else if(!this.ignoreMissingWhich){return this._mouseUp(e)}}}if(e.which||e.button){this._mouseMoved=true}if(this._mouseStarted){this._mouseDrag(e);return e.preventDefault()}if(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)){this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==false;if(this._mouseStarted){this._mouseDrag(e)}else{this._mouseUp(e)}}return!this._mouseStarted},_mouseUp:function(e){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(e.target===this._mouseDownEvent.target){te.data(e.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(e)}if(this._mouseDelayTimer){clearTimeout(this._mouseDelayTimer);delete this._mouseDelayTimer}this.ignoreMissingWhich=false;N=false;e.preventDefault()},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}});var we=te.ui.plugin={add:function(e,t,i){var n,r=te.ui[e].prototype;for(n in i){r.plugins[n]=r.plugins[n]||[];r.plugins[n].push([t,i[n]])}},call:function(e,t,i,n){var r,o=e.plugins[t];if(!o){return}if(!n&&(!e.element[0].parentNode||e.element[0].parentNode.nodeType===11)){return}for(r=0;r<o.length;r++){if(e.options[o[r][0]]){o[r][1].apply(e.element,i)}}}};var Ce=te.ui.safeBlur=function(e){if(e&&e.nodeName.toLowerCase()!=="body"){te(e).trigger("blur")}};te.widget("ui.draggable",te.ui.mouse,{version:"1.13.1",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false,drag:null,start:null,stop:null},_create:function(){if(this.options.helper==="original"){this._setPositionRelative()}if(this.options.addClasses){this._addClass("ui-draggable")}this._setHandleClassName();this._mouseInit()},_setOption:function(e,t){this._super(e,t);if(e==="handle"){this._removeHandleClassName();this._setHandleClassName()}},_destroy:function(){if((this.helper||this.element).is(".ui-draggable-dragging")){this.destroyOnClear=true;return}this._removeHandleClassName();this._mouseDestroy()},_mouseCapture:function(e){var t=this.options;if(this.helper||t.disabled||te(e.target).closest(".ui-resizable-handle").length>0){return false}this.handle=this._getHandle(e);if(!this.handle){return false}this._blurActiveElement(e);this._blockFrames(t.iframeFix===true?"iframe":t.iframeFix);return true},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=te(this);return te("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks}},_blurActiveElement:function(e){var t=te.ui.safeActiveElement(this.document[0]),i=te(e.target);if(i.closest(t).length){return}te.ui.safeBlur(t)},_mouseStart:function(e){var t=this.options;this.helper=this._createHelper(e);this._addClass(this.helper,"ui-draggable-dragging");this._cacheHelperProportions();if(te.ui.ddmanager){te.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent(true);this.offsetParent=this.helper.offsetParent();this.hasFixedAncestor=this.helper.parents().filter(function(){return te(this).css("position")==="fixed"}).length>0;this.positionAbs=this.element.offset();this._refreshOffsets(e);this.originalPosition=this.position=this._generatePosition(e,false);this.originalPageX=e.pageX;this.originalPageY=e.pageY;if(t.cursorAt){this._adjustOffsetFromHelper(t.cursorAt)}this._setContainment();if(this._trigger("start",e)===false){this._clear();return false}this._cacheHelperProportions();if(te.ui.ddmanager&&!t.dropBehaviour){te.ui.ddmanager.prepareOffsets(this,e)}this._mouseDrag(e,true);if(te.ui.ddmanager){te.ui.ddmanager.dragStart(this,e)}return true},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:false,parent:this._getParentOffset(),relative:this._getRelativeOffset()};this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(e,t){if(this.hasFixedAncestor){this.offset.parent=this._getParentOffset()}this.position=this._generatePosition(e,true);this.positionAbs=this._convertPositionTo("absolute");if(!t){var i=this._uiHash();if(this._trigger("drag",e,i)===false){this._mouseUp(new te.Event("mouseup",e));return false}this.position=i.position}this.helper[0].style.left=this.position.left+"px";this.helper[0].style.top=this.position.top+"px";if(te.ui.ddmanager){te.ui.ddmanager.drag(this,e)}return false},_mouseStop:function(e){var t=this,i=false;if(te.ui.ddmanager&&!this.options.dropBehaviour){i=te.ui.ddmanager.drop(this,e)}if(this.dropped){i=this.dropped;this.dropped=false}if(this.options.revert==="invalid"&&!i||this.options.revert==="valid"&&i||this.options.revert===true||typeof this.options.revert==="function"&&this.options.revert.call(this.element,i)){te(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(t._trigger("stop",e)!==false){t._clear()}})}else{if(this._trigger("stop",e)!==false){this._clear()}}return false},_mouseUp:function(e){this._unblockFrames();if(te.ui.ddmanager){te.ui.ddmanager.dragStop(this,e)}if(this.handleElement.is(e.target)){this.element.trigger("focus")}return te.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp(new te.Event("mouseup",{target:this.element[0]}))}else{this._clear()}return this},_getHandle:function(e){return this.options.handle?!!te(e.target).closest(this.element.find(this.options.handle)).length:true},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element;this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(e){var t=this.options,i=typeof t.helper==="function",n=i?te(t.helper.apply(this.element[0],[e])):t.helper==="clone"?this.element.clone().removeAttr("id"):this.element;if(!n.parents("body").length){n.appendTo(t.appendTo==="parent"?this.element[0].parentNode:t.appendTo)}if(i&&n[0]===this.element[0]){this._setPositionRelative()}if(n[0]!==this.element[0]&&!/(fixed|absolute)/.test(n.css("position"))){n.css("position","absolute")}return n},_setPositionRelative:function(){if(!/^(?:r|a|f)/.test(this.element.css("position"))){this.element[0].style.position="relative"}},_adjustOffsetFromHelper:function(e){if(typeof e==="string"){e=e.split(" ")}if(Array.isArray(e)){e={left:+e[0],top:+e[1]||0}}if("left"in e){this.offset.click.left=e.left+this.margins.left}if("right"in e){this.offset.click.left=this.helperProportions.width-e.right+this.margins.left}if("top"in e){this.offset.click.top=e.top+this.margins.top}if("bottom"in e){this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top}},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),t=this.document[0];if(this.cssPosition==="absolute"&&this.scrollParent[0]!==t&&te.contains(this.scrollParent[0],this.offsetParent[0])){e.left+=this.scrollParent.scrollLeft();e.top+=this.scrollParent.scrollTop()}if(this._isRootNode(this.offsetParent[0])){e={top:0,left:0}}return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition!=="relative"){return{top:0,left:0}}var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(!t?this.scrollParent.scrollTop():0),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(!t?this.scrollParent.scrollLeft():0)}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,i,n=this.options,r=this.document[0];this.relativeContainer=null;if(!n.containment){this.containment=null;return}if(n.containment==="window"){this.containment=[te(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,te(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,te(window).scrollLeft()+te(window).width()-this.helperProportions.width-this.margins.left,te(window).scrollTop()+(te(window).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(n.containment==="document"){this.containment=[0,0,te(r).width()-this.helperProportions.width-this.margins.left,(te(r).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(n.containment.constructor===Array){this.containment=n.containment;return}if(n.containment==="parent"){n.containment=this.helper[0].parentNode}t=te(n.containment);i=t[0];if(!i){return}e=/(scroll|auto)/.test(t.css("overflow"));this.containment=[(parseInt(t.css("borderLeftWidth"),10)||0)+(parseInt(t.css("paddingLeft"),10)||0),(parseInt(t.css("borderTopWidth"),10)||0)+(parseInt(t.css("paddingTop"),10)||0),(e?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(t.css("borderRightWidth"),10)||0)-(parseInt(t.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(t.css("borderBottomWidth"),10)||0)-(parseInt(t.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relativeContainer=t},_convertPositionTo:function(e,t){if(!t){t=this.position}var i=e==="absolute"?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-(this.cssPosition==="fixed"?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-(this.cssPosition==="fixed"?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,n,r,o,s=this.options,a=this._isRootNode(this.scrollParent[0]),l=e.pageX,c=e.pageY;if(!a||!this.offset.scroll){this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}}if(t){if(this.containment){if(this.relativeContainer){n=this.relativeContainer.offset();i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]}else{i=this.containment}if(e.pageX-this.offset.click.left<i[0]){l=i[0]+this.offset.click.left}if(e.pageY-this.offset.click.top<i[1]){c=i[1]+this.offset.click.top}if(e.pageX-this.offset.click.left>i[2]){l=i[2]+this.offset.click.left}if(e.pageY-this.offset.click.top>i[3]){c=i[3]+this.offset.click.top}}if(s.grid){r=s.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY;c=i?r-this.offset.click.top>=i[1]||r-this.offset.click.top>i[3]?r:r-this.offset.click.top>=i[1]?r-s.grid[1]:r+s.grid[1]:r;o=s.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX;l=i?o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-s.grid[0]:o+s.grid[0]:o}if(s.axis==="y"){l=this.originalPageX}if(s.axis==="x"){c=this.originalPageY}}return{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging");if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false;if(this.destroyOnClear){this.destroy()}},_trigger:function(e,t,i){i=i||this._uiHash();te.ui.plugin.call(this,e,[t,i,this],true);if(/^(drag|start|stop)/.test(e)){this.positionAbs=this._convertPositionTo("absolute");i.offset=this.positionAbs}return te.Widget.prototype._trigger.call(this,e,t,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});te.ui.plugin.add("draggable","connectToSortable",{start:function(t,e,i){var n=te.extend({},e,{item:i.element});i.sortables=[];te(i.options.connectToSortable).each(function(){var e=te(this).sortable("instance");if(e&&!e.options.disabled){i.sortables.push(e);e.refreshPositions();e._trigger("activate",t,n)}})},stop:function(t,e,i){var n=te.extend({},e,{item:i.element});i.cancelHelperRemoval=false;te.each(i.sortables,function(){var e=this;if(e.isOver){e.isOver=0;i.cancelHelperRemoval=true;e.cancelHelperRemoval=false;e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")};e._mouseStop(t);e.options.helper=e.options._helper}else{e.cancelHelperRemoval=true;e._trigger("deactivate",t,n)}})},drag:function(i,n,r){te.each(r.sortables,function(){var e=false,t=this;t.positionAbs=r.positionAbs;t.helperProportions=r.helperProportions;t.offset.click=r.offset.click;if(t._intersectsWith(t.containerCache)){e=true;te.each(r.sortables,function(){this.positionAbs=r.positionAbs;this.helperProportions=r.helperProportions;this.offset.click=r.offset.click;if(this!==t&&this._intersectsWith(this.containerCache)&&te.contains(t.element[0],this.element[0])){e=false}return e})}if(e){if(!t.isOver){t.isOver=1;r._parent=n.helper.parent();t.currentItem=n.helper.appendTo(t.element).data("ui-sortable-item",true);t.options._helper=t.options.helper;t.options.helper=function(){return n.helper[0]};i.target=t.currentItem[0];t._mouseCapture(i,true);t._mouseStart(i,true,true);t.offset.click.top=r.offset.click.top;t.offset.click.left=r.offset.click.left;t.offset.parent.left-=r.offset.parent.left-t.offset.parent.left;t.offset.parent.top-=r.offset.parent.top-t.offset.parent.top;r._trigger("toSortable",i);r.dropped=t.element;te.each(r.sortables,function(){this.refreshPositions()});r.currentItem=r.element;t.fromOutside=r}if(t.currentItem){t._mouseDrag(i);n.position=t.position}}else{if(t.isOver){t.isOver=0;t.cancelHelperRemoval=true;t.options._revert=t.options.revert;t.options.revert=false;t._trigger("out",i,t._uiHash(t));t._mouseStop(i,true);t.options.revert=t.options._revert;t.options.helper=t.options._helper;if(t.placeholder){t.placeholder.remove()}n.helper.appendTo(r._parent);r._refreshOffsets(i);n.position=r._generatePosition(i,true);r._trigger("fromSortable",i);r.dropped=false;te.each(r.sortables,function(){this.refreshPositions()})}}})}});te.ui.plugin.add("draggable","cursor",{start:function(e,t,i){var n=te("body"),r=i.options;if(n.css("cursor")){r._cursor=n.css("cursor")}n.css("cursor",r.cursor)},stop:function(e,t,i){var n=i.options;if(n._cursor){te("body").css("cursor",n._cursor)}}});te.ui.plugin.add("draggable","opacity",{start:function(e,t,i){var n=te(t.helper),r=i.options;if(n.css("opacity")){r._opacity=n.css("opacity")}n.css("opacity",r.opacity)},stop:function(e,t,i){var n=i.options;if(n._opacity){te(t.helper).css("opacity",n._opacity)}}});te.ui.plugin.add("draggable","scroll",{start:function(e,t,i){if(!i.scrollParentNotHidden){i.scrollParentNotHidden=i.helper.scrollParent(false)}if(i.scrollParentNotHidden[0]!==i.document[0]&&i.scrollParentNotHidden[0].tagName!=="HTML"){i.overflowOffset=i.scrollParentNotHidden.offset()}},drag:function(e,t,i){var n=i.options,r=false,o=i.scrollParentNotHidden[0],s=i.document[0];if(o!==s&&o.tagName!=="HTML"){if(!n.axis||n.axis!=="x"){if(i.overflowOffset.top+o.offsetHeight-e.pageY<n.scrollSensitivity){o.scrollTop=r=o.scrollTop+n.scrollSpeed}else if(e.pageY-i.overflowOffset.top<n.scrollSensitivity){o.scrollTop=r=o.scrollTop-n.scrollSpeed}}if(!n.axis||n.axis!=="y"){if(i.overflowOffset.left+o.offsetWidth-e.pageX<n.scrollSensitivity){o.scrollLeft=r=o.scrollLeft+n.scrollSpeed}else if(e.pageX-i.overflowOffset.left<n.scrollSensitivity){o.scrollLeft=r=o.scrollLeft-n.scrollSpeed}}}else{if(!n.axis||n.axis!=="x"){if(e.pageY-te(s).scrollTop()<n.scrollSensitivity){r=te(s).scrollTop(te(s).scrollTop()-n.scrollSpeed)}else if(te(window).height()-(e.pageY-te(s).scrollTop())<n.scrollSensitivity){r=te(s).scrollTop(te(s).scrollTop()+n.scrollSpeed)}}if(!n.axis||n.axis!=="y"){if(e.pageX-te(s).scrollLeft()<n.scrollSensitivity){r=te(s).scrollLeft(te(s).scrollLeft()-n.scrollSpeed)}else if(te(window).width()-(e.pageX-te(s).scrollLeft())<n.scrollSensitivity){r=te(s).scrollLeft(te(s).scrollLeft()+n.scrollSpeed)}}}if(r!==false&&te.ui.ddmanager&&!n.dropBehaviour){te.ui.ddmanager.prepareOffsets(i,e)}}});te.ui.plugin.add("draggable","snap",{start:function(e,t,i){var n=i.options;i.snapElements=[];te(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var e=te(this),t=e.offset();if(this!==i.element[0]){i.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:t.top,left:t.left})}})},drag:function(e,t,i){var n,r,o,s,a,l,c,u,d,h,f=i.options,p=f.snapTolerance,g=t.offset.left,m=g+i.helperProportions.width,v=t.offset.top,y=v+i.helperProportions.height;for(d=i.snapElements.length-1;d>=0;d--){a=i.snapElements[d].left-i.margins.left;l=a+i.snapElements[d].width;c=i.snapElements[d].top-i.margins.top;u=c+i.snapElements[d].height;if(m<a-p||g>l+p||y<c-p||v>u+p||!te.contains(i.snapElements[d].item.ownerDocument,i.snapElements[d].item)){if(i.snapElements[d].snapping){if(i.options.snap.release){i.options.snap.release.call(i.element,e,te.extend(i._uiHash(),{snapItem:i.snapElements[d].item}))}}i.snapElements[d].snapping=false;continue}if(f.snapMode!=="inner"){n=Math.abs(c-y)<=p;r=Math.abs(u-v)<=p;o=Math.abs(a-m)<=p;s=Math.abs(l-g)<=p;if(n){t.position.top=i._convertPositionTo("relative",{top:c-i.helperProportions.height,left:0}).top}if(r){t.position.top=i._convertPositionTo("relative",{top:u,left:0}).top}if(o){t.position.left=i._convertPositionTo("relative",{top:0,left:a-i.helperProportions.width}).left}if(s){t.position.left=i._convertPositionTo("relative",{top:0,left:l}).left}}h=n||r||o||s;if(f.snapMode!=="outer"){n=Math.abs(c-v)<=p;r=Math.abs(u-y)<=p;o=Math.abs(a-g)<=p;s=Math.abs(l-m)<=p;if(n){t.position.top=i._convertPositionTo("relative",{top:c,left:0}).top}if(r){t.position.top=i._convertPositionTo("relative",{top:u-i.helperProportions.height,left:0}).top}if(o){t.position.left=i._convertPositionTo("relative",{top:0,left:a}).left}if(s){t.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left}}if(!i.snapElements[d].snapping&&(n||r||o||s||h)){if(i.options.snap.snap){i.options.snap.snap.call(i.element,e,te.extend(i._uiHash(),{snapItem:i.snapElements[d].item}))}}i.snapElements[d].snapping=n||r||o||s||h}}});te.ui.plugin.add("draggable","stack",{start:function(e,t,i){var n,r=i.options,o=te.makeArray(te(r.stack)).sort(function(e,t){return(parseInt(te(e).css("zIndex"),10)||0)-(parseInt(te(t).css("zIndex"),10)||0)});if(!o.length){return}n=parseInt(te(o[0]).css("zIndex"),10)||0;te(o).each(function(e){te(this).css("zIndex",n+e)});this.css("zIndex",n+o.length)}});te.ui.plugin.add("draggable","zIndex",{start:function(e,t,i){var n=te(t.helper),r=i.options;if(n.css("zIndex")){r._zIndex=n.css("zIndex")}n.css("zIndex",r.zIndex)},stop:function(e,t,i){var n=i.options;if(n._zIndex){te(t.helper).css("zIndex",n._zIndex)}}});var xe=te.ui.draggable;te.widget("ui.resizable",te.ui.mouse,{version:"1.13.1",widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseFloat(e)||0},_isNumber:function(e){return!isNaN(parseFloat(e))},_hasScroll:function(e,t){if(te(e).css("overflow")==="hidden"){return false}var i=t&&t==="left"?"scrollLeft":"scrollTop",n=false;if(e[i]>0){return true}try{e[i]=1;n=e[i]>0;e[i]=0}catch(e){}return n},_create:function(){var e,t=this.options,i=this;this._addClass("ui-resizable");te.extend(this,{_aspectRatio:!!t.aspectRatio,aspectRatio:t.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:t.helper||t.ghost||t.animate?t.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)){this.element.wrap(te("<div class='ui-wrapper'></div>").css({overflow:"hidden",position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance"));this.elementIsWrapper=true;e={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")};this.element.css(e);this.originalElement.css("margin",0);this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css(e);this._proportionallyResize()}this._setupHandles();if(t.autoHide){te(this.element).on("mouseenter",function(){if(t.disabled){return}i._removeClass("ui-resizable-autohide");i._handles.show()}).on("mouseleave",function(){if(t.disabled){return}if(!i.resizing){i._addClass("ui-resizable-autohide");i._handles.hide()}})}this._mouseInit()},_destroy:function(){this._mouseDestroy();this._addedHandles.remove();var e,t=function(e){te(e).removeData("resizable").removeData("ui-resizable").off(".resizable")};if(this.elementIsWrapper){t(this.element);e=this.element;this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e);e.remove()}this.originalElement.css("resize",this.originalResizeStyle);t(this.originalElement);return this},_setOption:function(e,t){this._super(e,t);switch(e){case"handles":this._removeHandles();this._setupHandles();break;case"aspectRatio":this._aspectRatio=!!t;break;default:break}},_setupHandles:function(){var e=this.options,t,i,n,r,o,s=this;this.handles=e.handles||(!te(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});this._handles=te();this._addedHandles=te();if(this.handles.constructor===String){if(this.handles==="all"){this.handles="n,e,s,w,se,sw,ne,nw"}n=this.handles.split(",");this.handles={};for(i=0;i<n.length;i++){t=String.prototype.trim.call(n[i]);r="ui-resizable-"+t;o=te("<div>");this._addClass(o,"ui-resizable-handle "+r);o.css({zIndex:e.zIndex});this.handles[t]=".ui-resizable-"+t;if(!this.element.children(this.handles[t]).length){this.element.append(o);this._addedHandles=this._addedHandles.add(o)}}}this._renderAxis=function(e){var t,i,n,r;e=e||this.element;for(t in this.handles){if(this.handles[t].constructor===String){this.handles[t]=this.element.children(this.handles[t]).first().show()}else if(this.handles[t].jquery||this.handles[t].nodeType){this.handles[t]=te(this.handles[t]);this._on(this.handles[t],{mousedown:s._mouseDown})}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)){i=te(this.handles[t],this.element);r=/sw|ne|nw|se|n|s/.test(t)?i.outerHeight():i.outerWidth();n=["padding",/ne|nw|n/.test(t)?"Top":/se|sw|s/.test(t)?"Bottom":/^e$/.test(t)?"Right":"Left"].join("");e.css(n,r);this._proportionallyResize()}this._handles=this._handles.add(this.handles[t])}};this._renderAxis(this.element);this._handles=this._handles.add(this.element.find(".ui-resizable-handle"));this._handles.disableSelection();this._handles.on("mouseover",function(){if(!s.resizing){if(this.className){o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}s.axis=o&&o[1]?o[1]:"se"}});if(e.autoHide){this._handles.hide();this._addClass("ui-resizable-autohide")}},_removeHandles:function(){this._addedHandles.remove()},_mouseCapture:function(e){var t,i,n=false;for(t in this.handles){i=te(this.handles[t])[0];if(i===e.target||te.contains(i,e.target)){n=true}}return!this.options.disabled&&n},_mouseStart:function(e){var t,i,n,r=this.options,o=this.element;this.resizing=true;this._renderProxy();t=this._num(this.helper.css("left"));i=this._num(this.helper.css("top"));if(r.containment){t+=te(r.containment).scrollLeft()||0;i+=te(r.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:t,top:i};this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()};this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()};this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()};this.originalPosition={left:t,top:i};this.originalMousePosition={left:e.pageX,top:e.pageY};this.aspectRatio=typeof r.aspectRatio==="number"?r.aspectRatio:this.originalSize.width/this.originalSize.height||1;n=te(".ui-resizable-"+this.axis).css("cursor");te("body").css("cursor",n==="auto"?this.axis+"-resize":n);this._addClass("ui-resizable-resizing");this._propagate("start",e);return true},_mouseDrag:function(e){var t,i,n=this.originalMousePosition,r=this.axis,o=e.pageX-n.left||0,s=e.pageY-n.top||0,a=this._change[r];this._updatePrevProperties();if(!a){return false}t=a.apply(this,[e,o,s]);this._updateVirtualBoundaries(e.shiftKey);if(this._aspectRatio||e.shiftKey){t=this._updateRatio(t,e)}t=this._respectSize(t,e);this._updateCache(t);this._propagate("resize",e);i=this._applyChanges();if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}if(!te.isEmptyObject(i)){this._updatePrevProperties();this._trigger("resize",e,this.ui());this._applyChanges()}return false},_mouseStop:function(e){this.resizing=false;var t,i,n,r,o,s,a,l=this.options,c=this;if(this._helper){t=this._proportionallyResizeElements;i=t.length&&/textarea/i.test(t[0].nodeName);n=i&&this._hasScroll(t[0],"left")?0:c.sizeDiff.height;r=i?0:c.sizeDiff.width;o={width:c.helper.width()-r,height:c.helper.height()-n};s=parseFloat(c.element.css("left"))+(c.position.left-c.originalPosition.left)||null;a=parseFloat(c.element.css("top"))+(c.position.top-c.originalPosition.top)||null;if(!l.animate){this.element.css(te.extend(o,{top:a,left:s}))}c.helper.height(c.size.height);c.helper.width(c.size.width);if(this._helper&&!l.animate){this._proportionallyResize()}}te("body").css("cursor","auto");this._removeClass("ui-resizable-resizing");this._propagate("stop",e);if(this._helper){this.helper.remove()}return false},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left};this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};if(this.position.top!==this.prevPosition.top){e.top=this.position.top+"px"}if(this.position.left!==this.prevPosition.left){e.left=this.position.left+"px"}if(this.size.width!==this.prevSize.width){e.width=this.size.width+"px"}if(this.size.height!==this.prevSize.height){e.height=this.size.height+"px"}this.helper.css(e);return e},_updateVirtualBoundaries:function(e){var t,i,n,r,o,s=this.options;o={minWidth:this._isNumber(s.minWidth)?s.minWidth:0,maxWidth:this._isNumber(s.maxWidth)?s.maxWidth:Infinity,minHeight:this._isNumber(s.minHeight)?s.minHeight:0,maxHeight:this._isNumber(s.maxHeight)?s.maxHeight:Infinity};if(this._aspectRatio||e){t=o.minHeight*this.aspectRatio;n=o.minWidth/this.aspectRatio;i=o.maxHeight*this.aspectRatio;r=o.maxWidth/this.aspectRatio;if(t>o.minWidth){o.minWidth=t}if(n>o.minHeight){o.minHeight=n}if(i<o.maxWidth){o.maxWidth=i}if(r<o.maxHeight){o.maxHeight=r}}this._vBoundaries=o},_updateCache:function(e){this.offset=this.helper.offset();if(this._isNumber(e.left)){this.position.left=e.left}if(this._isNumber(e.top)){this.position.top=e.top}if(this._isNumber(e.height)){this.size.height=e.height}if(this._isNumber(e.width)){this.size.width=e.width}},_updateRatio:function(e){var t=this.position,i=this.size,n=this.axis;if(this._isNumber(e.height)){e.width=e.height*this.aspectRatio}else if(this._isNumber(e.width)){e.height=e.width/this.aspectRatio}if(n==="sw"){e.left=t.left+(i.width-e.width);e.top=null}if(n==="nw"){e.top=t.top+(i.height-e.height);e.left=t.left+(i.width-e.width)}return e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,n=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,r=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,o=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,s=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,a=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,c=/sw|nw|w/.test(i),u=/nw|ne|n/.test(i);if(o){e.width=t.minWidth}if(s){e.height=t.minHeight}if(n){e.width=t.maxWidth}if(r){e.height=t.maxHeight}if(o&&c){e.left=a-t.minWidth}if(n&&c){e.left=a-t.maxWidth}if(s&&u){e.top=l-t.minHeight}if(r&&u){e.top=l-t.maxHeight}if(!e.width&&!e.height&&!e.left&&e.top){e.top=null}else if(!e.width&&!e.height&&!e.top&&e.left){e.left=null}return e},_getPaddingPlusBorderDimensions:function(e){var t=0,i=[],n=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],r=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];for(;t<4;t++){i[t]=parseFloat(n[t])||0;i[t]+=parseFloat(r[t])||0}return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(!this._proportionallyResizeElements.length){return}var e,t=0,i=this.helper||this.element;for(;t<this._proportionallyResizeElements.length;t++){e=this._proportionallyResizeElements[t];if(!this.outerDimensions){this.outerDimensions=this._getPaddingPlusBorderDimensions(e)}e.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})}},_renderProxy:function(){var e=this.element,t=this.options;this.elementOffset=e.offset();if(this._helper){this.helper=this.helper||te("<div></div>").css({overflow:"hidden"});this._addClass(this.helper,this._helper);this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++t.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,n=this.originalPosition;return{left:n.left+t,width:i.width-t}},n:function(e,t,i){var n=this.originalSize,r=this.originalPosition;return{top:r.top+i,height:n.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(e,t,i){return te.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,t,i]))},sw:function(e,t,i){return te.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,t,i]))},ne:function(e,t,i){return te.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,t,i]))},nw:function(e,t,i){return te.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,t,i]))}},_propagate:function(e,t){te.ui.plugin.call(this,e,[t,this.ui()]);if(e!=="resize"){this._trigger(e,t,this.ui())}},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});te.ui.plugin.add("resizable","animate",{stop:function(t){var i=te(this).resizable("instance"),e=i.options,n=i._proportionallyResizeElements,r=n.length&&/textarea/i.test(n[0].nodeName),o=r&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,s=r?0:i.sizeDiff.width,a={width:i.size.width-s,height:i.size.height-o},l=parseFloat(i.element.css("left"))+(i.position.left-i.originalPosition.left)||null,c=parseFloat(i.element.css("top"))+(i.position.top-i.originalPosition.top)||null;i.element.animate(te.extend(a,c&&l?{top:c,left:l}:{}),{duration:e.animateDuration,easing:e.animateEasing,step:function(){var e={width:parseFloat(i.element.css("width")),height:parseFloat(i.element.css("height")),top:parseFloat(i.element.css("top")),left:parseFloat(i.element.css("left"))};if(n&&n.length){te(n[0]).css({width:e.width,height:e.height})}i._updateCache(e);i._propagate("resize",t)}})}});te.ui.plugin.add("resizable","containment",{start:function(){var i,n,e,t,r,o,s,a=te(this).resizable("instance"),l=a.options,c=a.element,u=l.containment,d=u instanceof te?u.get(0):/parent/.test(u)?c.parent().get(0):u;if(!d){return}a.containerElement=te(d);if(/document/.test(u)||u===document){a.containerOffset={left:0,top:0};a.containerPosition={left:0,top:0};a.parentData={element:te(document),left:0,top:0,width:te(document).width(),height:te(document).height()||document.body.parentNode.scrollHeight}}else{i=te(d);n=[];te(["Top","Right","Left","Bottom"]).each(function(e,t){n[e]=a._num(i.css("padding"+t))});a.containerOffset=i.offset();a.containerPosition=i.position();a.containerSize={height:i.innerHeight()-n[3],width:i.innerWidth()-n[1]};e=a.containerOffset;t=a.containerSize.height;r=a.containerSize.width;o=a._hasScroll(d,"left")?d.scrollWidth:r;s=a._hasScroll(d)?d.scrollHeight:t;a.parentData={element:d,left:e.left,top:e.top,width:o,height:s}}},resize:function(e){var t,i,n,r,o=te(this).resizable("instance"),s=o.options,a=o.containerOffset,l=o.position,c=o._aspectRatio||e.shiftKey,u={top:0,left:0},d=o.containerElement,h=true;if(d[0]!==document&&/static/.test(d.css("position"))){u=a}if(l.left<(o._helper?a.left:0)){o.size.width=o.size.width+(o._helper?o.position.left-a.left:o.position.left-u.left);if(c){o.size.height=o.size.width/o.aspectRatio;h=false}o.position.left=s.helper?a.left:0}if(l.top<(o._helper?a.top:0)){o.size.height=o.size.height+(o._helper?o.position.top-a.top:o.position.top);if(c){o.size.width=o.size.height*o.aspectRatio;h=false}o.position.top=o._helper?a.top:0}n=o.containerElement.get(0)===o.element.parent().get(0);r=/relative|absolute/.test(o.containerElement.css("position"));if(n&&r){o.offset.left=o.parentData.left+o.position.left;o.offset.top=o.parentData.top+o.position.top}else{o.offset.left=o.element.offset().left;o.offset.top=o.element.offset().top}t=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-u.left:o.offset.left-a.left));i=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-u.top:o.offset.top-a.top));if(t+o.size.width>=o.parentData.width){o.size.width=o.parentData.width-t;if(c){o.size.height=o.size.width/o.aspectRatio;h=false}}if(i+o.size.height>=o.parentData.height){o.size.height=o.parentData.height-i;if(c){o.size.width=o.size.height*o.aspectRatio;h=false}}if(!h){o.position.left=o.prevPosition.left;o.position.top=o.prevPosition.top;o.size.width=o.prevSize.width;o.size.height=o.prevSize.height}},stop:function(){var e=te(this).resizable("instance"),t=e.options,i=e.containerOffset,n=e.containerPosition,r=e.containerElement,o=te(e.helper),s=o.offset(),a=o.outerWidth()-e.sizeDiff.width,l=o.outerHeight()-e.sizeDiff.height;if(e._helper&&!t.animate&&/relative/.test(r.css("position"))){te(this).css({left:s.left-n.left-i.left,width:a,height:l})}if(e._helper&&!t.animate&&/static/.test(r.css("position"))){te(this).css({left:s.left-n.left-i.left,width:a,height:l})}}});te.ui.plugin.add("resizable","alsoResize",{start:function(){var e=te(this).resizable("instance"),t=e.options;te(t.alsoResize).each(function(){var e=te(this);e.data("ui-resizable-alsoresize",{width:parseFloat(e.width()),height:parseFloat(e.height()),left:parseFloat(e.css("left")),top:parseFloat(e.css("top"))})})},resize:function(e,i){var t=te(this).resizable("instance"),n=t.options,r=t.originalSize,o=t.originalPosition,s={height:t.size.height-r.height||0,width:t.size.width-r.width||0,top:t.position.top-o.top||0,left:t.position.left-o.left||0};te(n.alsoResize).each(function(){var e=te(this),n=te(this).data("ui-resizable-alsoresize"),r={},t=e.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];te.each(t,function(e,t){var i=(n[t]||0)+(s[t]||0);if(i&&i>=0){r[t]=i||null}});e.css(r)})},stop:function(){te(this).removeData("ui-resizable-alsoresize")}});te.ui.plugin.add("resizable","ghost",{start:function(){var e=te(this).resizable("instance"),t=e.size;e.ghost=e.originalElement.clone();e.ghost.css({opacity:.25,display:"block",position:"relative",height:t.height,width:t.width,margin:0,left:0,top:0});e._addClass(e.ghost,"ui-resizable-ghost");if(te.uiBackCompat!==false&&typeof e.options.ghost==="string"){e.ghost.addClass(this.options.ghost)}e.ghost.appendTo(e.helper)},resize:function(){var e=te(this).resizable("instance");if(e.ghost){e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})}},stop:function(){var e=te(this).resizable("instance");if(e.ghost&&e.helper){e.helper.get(0).removeChild(e.ghost.get(0))}}});te.ui.plugin.add("resizable","grid",{resize:function(){var e,t=te(this).resizable("instance"),i=t.options,n=t.size,r=t.originalSize,o=t.originalPosition,s=t.axis,a=typeof i.grid==="number"?[i.grid,i.grid]:i.grid,l=a[0]||1,c=a[1]||1,u=Math.round((n.width-r.width)/l)*l,d=Math.round((n.height-r.height)/c)*c,h=r.width+u,f=r.height+d,p=i.maxWidth&&i.maxWidth<h,g=i.maxHeight&&i.maxHeight<f,m=i.minWidth&&i.minWidth>h,v=i.minHeight&&i.minHeight>f;i.grid=a;if(m){h+=l}if(v){f+=c}if(p){h-=l}if(g){f-=c}if(/^(se|s|e)$/.test(s)){t.size.width=h;t.size.height=f}else if(/^(ne)$/.test(s)){t.size.width=h;t.size.height=f;t.position.top=o.top-d}else if(/^(sw)$/.test(s)){t.size.width=h;t.size.height=f;t.position.left=o.left-u}else{if(f-c<=0||h-l<=0){e=t._getPaddingPlusBorderDimensions(this)}if(f-c>0){t.size.height=f;t.position.top=o.top-d}else{f=c-e.height;t.size.height=f;t.position.top=o.top+r.height-f}if(h-l>0){t.size.width=h;t.position.left=o.left-u}else{h=l-e.width;t.size.width=h;t.position.left=o.left+r.width-h}}}});var Se=te.ui.resizable;te.widget("ui.dialog",{version:"1.13.1",options:{appendTo:"body",autoOpen:true,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:true,closeText:"Close",draggable:true,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var t=te(this).css(e).offset().top;if(t<0){te(this).css("top",e.top-t)}}},resizable:true,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},resizableRelatedOptions:{maxHeight:true,maxWidth:true,minHeight:true,minWidth:true},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.originalTitle=this.element.attr("title");if(this.options.title==null&&this.originalTitle!=null){this.options.title=this.originalTitle}if(this.options.disabled){this.options.disabled=false}this._createWrapper();this.element.show().removeAttr("title").appendTo(this.uiDialog);this._addClass("ui-dialog-content","ui-widget-content");this._createTitlebar();this._createButtonPane();if(this.options.draggable&&te.fn.draggable){this._makeDraggable()}if(this.options.resizable&&te.fn.resizable){this._makeResizable()}this._isOpen=false;this._trackFocus()},_init:function(){if(this.options.autoOpen){this.open()}},_appendTo:function(){var e=this.options.appendTo;if(e&&(e.jquery||e.nodeType)){return te(e)}return this.document.find(e||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._untrackInstance();this._destroyOverlay();this.element.removeUniqueId().css(this.originalCss).detach();this.uiDialog.remove();if(this.originalTitle){this.element.attr("title",this.originalTitle)}e=t.parent.children().eq(t.index);if(e.length&&e[0]!==this.element[0]){e.before(this.element)}else{t.parent.append(this.element)}},widget:function(){return this.uiDialog},disable:te.noop,enable:te.noop,close:function(e){var t=this;if(!this._isOpen||this._trigger("beforeClose",e)===false){return}this._isOpen=false;this._focusedElement=null;this._destroyOverlay();this._untrackInstance();if(!this.opener.filter(":focusable").trigger("focus").length){te.ui.safeBlur(te.ui.safeActiveElement(this.document[0]))}this._hide(this.uiDialog,this.options.hide,function(){t._trigger("close",e)})},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,t){var i=false,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+te(this).css("z-index")}).get(),r=Math.max.apply(null,n);if(r>=+this.uiDialog.css("z-index")){this.uiDialog.css("z-index",r+1);i=true}if(i&&!t){this._trigger("focus",e)}return i},open:function(){var e=this;if(this._isOpen){if(this._moveToTop()){this._focusTabbable()}return}this._isOpen=true;this.opener=te(te.ui.safeActiveElement(this.document[0]));this._size();this._position();this._createOverlay();this._moveToTop(null,true);if(this.overlay){this.overlay.css("z-index",this.uiDialog.css("z-index")-1)}this._show(this.uiDialog,this.options.show,function(){e._focusTabbable();e._trigger("focus")});this._makeFocusTarget();this._trigger("open")},_focusTabbable:function(){var e=this._focusedElement;if(!e){e=this.element.find("[autofocus]")}if(!e.length){e=this.element.find(":tabbable")}if(!e.length){e=this.uiDialogButtonPane.find(":tabbable")}if(!e.length){e=this.uiDialogTitlebarClose.filter(":tabbable")}if(!e.length){e=this.uiDialog}e.eq(0).trigger("focus")},_restoreTabbableFocus:function(){var e=te.ui.safeActiveElement(this.document[0]),t=this.uiDialog[0]===e||te.contains(this.uiDialog[0],e);if(!t){this._focusTabbable()}},_keepFocus:function(e){e.preventDefault();this._restoreTabbableFocus();this._delay(this._restoreTabbableFocus)},_createWrapper:function(){this.uiDialog=te("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo());this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front");this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===te.ui.keyCode.ESCAPE){e.preventDefault();this.close(e);return}if(e.keyCode!==te.ui.keyCode.TAB||e.isDefaultPrevented()){return}var t=this.uiDialog.find(":tabbable"),i=t.first(),n=t.last();if((e.target===n[0]||e.target===this.uiDialog[0])&&!e.shiftKey){this._delay(function(){i.trigger("focus")});e.preventDefault()}else if((e.target===i[0]||e.target===this.uiDialog[0])&&e.shiftKey){this._delay(function(){n.trigger("focus")});e.preventDefault()}},mousedown:function(e){if(this._moveToTop(e)){this._focusTabbable()}}});if(!this.element.find("[aria-describedby]").length){this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})}},_createTitlebar:function(){var e;this.uiDialogTitlebar=te("<div>");this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix");this._on(this.uiDialogTitlebar,{mousedown:function(e){if(!te(e.target).closest(".ui-dialog-titlebar-close")){this.uiDialog.trigger("focus")}}});this.uiDialogTitlebarClose=te("<button type='button'></button>").button({label:te("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:false}).appendTo(this.uiDialogTitlebar);this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close");this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault();this.close(e)}});e=te("<span>").uniqueId().prependTo(this.uiDialogTitlebar);this._addClass(e,"ui-dialog-title");this._title(e);this.uiDialogTitlebar.prependTo(this.uiDialog);this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(e){if(this.options.title){e.text(this.options.title)}else{e.html("&#160;")}},_createButtonPane:function(){this.uiDialogButtonPane=te("<div>");this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix");this.uiButtonSet=te("<div>").appendTo(this.uiDialogButtonPane);this._addClass(this.uiButtonSet,"ui-dialog-buttonset");this._createButtons()},_createButtons:function(){var r=this,e=this.options.buttons;this.uiDialogButtonPane.remove();this.uiButtonSet.empty();if(te.isEmptyObject(e)||Array.isArray(e)&&!e.length){this._removeClass(this.uiDialog,"ui-dialog-buttons");return}te.each(e,function(e,t){var i,n;t=typeof t==="function"?{click:t,text:e}:t;t=te.extend({type:"button"},t);i=t.click;n={icon:t.icon,iconPosition:t.iconPosition,showLabel:t.showLabel,icons:t.icons,text:t.text};delete t.click;delete t.icon;delete t.iconPosition;delete t.showLabel;delete t.icons;if(typeof t.text==="boolean"){delete t.text}te("<button></button>",t).button(n).appendTo(r.uiButtonSet).on("click",function(){i.apply(r.element[0],arguments)})});this._addClass(this.uiDialog,"ui-dialog-buttons");this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){var r=this,o=this.options;function s(e){return{position:e.position,offset:e.offset}}this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(e,t){r._addClass(te(this),"ui-dialog-dragging");r._blockFrames();r._trigger("dragStart",e,s(t))},drag:function(e,t){r._trigger("drag",e,s(t))},stop:function(e,t){var i=t.offset.left-r.document.scrollLeft(),n=t.offset.top-r.document.scrollTop();o.position={my:"left top",at:"left"+(i>=0?"+":"")+i+" "+"top"+(n>=0?"+":"")+n,of:r.window};r._removeClass(te(this),"ui-dialog-dragging");r._unblockFrames();r._trigger("dragStop",e,s(t))}})},_makeResizable:function(){var o=this,s=this.options,e=s.resizable,t=this.uiDialog.css("position"),i=typeof e==="string"?e:"n,e,s,w,se,sw,ne,nw";function a(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:i,start:function(e,t){o._addClass(te(this),"ui-dialog-resizing");o._blockFrames();o._trigger("resizeStart",e,a(t))},resize:function(e,t){o._trigger("resize",e,a(t))},stop:function(e,t){var i=o.uiDialog.offset(),n=i.left-o.document.scrollLeft(),r=i.top-o.document.scrollTop();s.height=o.uiDialog.height();s.width=o.uiDialog.width();s.position={my:"left top",at:"left"+(n>=0?"+":"")+n+" "+"top"+(r>=0?"+":"")+r,of:o.window};o._removeClass(te(this),"ui-dialog-resizing");o._unblockFrames();o._trigger("resizeStop",e,a(t))}}).css("position",t)},_trackFocus:function(){this._on(this.widget(),{focusin:function(e){this._makeFocusTarget();this._focusedElement=te(e.target)}})},_makeFocusTarget:function(){this._untrackInstance();this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),t=te.inArray(this,e);if(t!==-1){e.splice(t,1)}},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");if(!e){e=[];this.document.data("ui-dialog-instances",e)}return e},_minHeight:function(){var e=this.options;return e.height==="auto"?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");if(!e){this.uiDialog.show()}this.uiDialog.position(this.options.position);if(!e){this.uiDialog.hide()}},_setOptions:function(e){var i=this,n=false,r={};te.each(e,function(e,t){i._setOption(e,t);if(e in i.sizeRelatedOptions){n=true}if(e in i.resizableRelatedOptions){r[e]=t}});if(n){this._size();this._position()}if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option",r)}},_setOption:function(e,t){var i,n,r=this.uiDialog;if(e==="disabled"){return}this._super(e,t);if(e==="appendTo"){this.uiDialog.appendTo(this._appendTo())}if(e==="buttons"){this._createButtons()}if(e==="closeText"){this.uiDialogTitlebarClose.button({label:te("<a>").text(""+this.options.closeText).html()})}if(e==="draggable"){i=r.is(":data(ui-draggable)");if(i&&!t){r.draggable("destroy")}if(!i&&t){this._makeDraggable()}}if(e==="position"){this._position()}if(e==="resizable"){n=r.is(":data(ui-resizable)");if(n&&!t){r.resizable("destroy")}if(n&&typeof t==="string"){r.resizable("option","handles",t)}if(!n&&t!==false){this._makeResizable()}}if(e==="title"){this._title(this.uiDialogTitlebar.find(".ui-dialog-title"))}},_size:function(){var e,t,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0});if(n.minWidth>n.width){n.width=n.minWidth}e=this.uiDialog.css({height:"auto",width:n.width}).outerHeight();t=Math.max(0,n.minHeight-e);i=typeof n.maxHeight==="number"?Math.max(0,n.maxHeight-e):"none";if(n.height==="auto"){this.element.css({minHeight:t,maxHeight:i,height:"auto"})}else{this.element.height(Math.max(0,n.height-e))}if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight())}},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=te(this);return te("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks}},_allowInteraction:function(e){if(te(e.target).closest(".ui-dialog").length){return true}return!!te(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(!this.options.modal){return}var i=te.fn.jquery.substring(0,4);var n=true;this._delay(function(){n=false});if(!this.document.data("ui-dialog-overlays")){this.document.on("focusin.ui-dialog",function(e){if(n){return}var t=this._trackingInstances()[0];if(!t._allowInteraction(e)){e.preventDefault();t._focusTabbable();if(i==="3.4."||i==="3.5."){t._delay(t._restoreTabbableFocus)}}}.bind(this))}this.overlay=te("<div>").appendTo(this._appendTo());this._addClass(this.overlay,null,"ui-widget-overlay ui-front");this._on(this.overlay,{mousedown:"_keepFocus"});this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)},_destroyOverlay:function(){if(!this.options.modal){return}if(this.overlay){var e=this.document.data("ui-dialog-overlays")-1;if(!e){this.document.off("focusin.ui-dialog");this.document.removeData("ui-dialog-overlays")}else{this.document.data("ui-dialog-overlays",e)}this.overlay.remove();this.overlay=null}}});if(te.uiBackCompat!==false){te.widget("ui.dialog",te.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super();this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(e,t){if(e==="dialogClass"){this.uiDialog.removeClass(this.options.dialogClass).addClass(t)}this._superApply(arguments)}})}var Ae=te.ui.dialog;te.widget("ui.droppable",{version:"1.13.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:true,greedy:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,t=this.options,i=t.accept;this.isover=false;this.isout=true;this.accept=typeof i==="function"?i:function(e){return e.is(i)};this.proportions=function(){if(arguments.length){e=arguments[0]}else{return e?e:e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}}};this._addToManager(t.scope);if(t.addClasses){this._addClass("ui-droppable")}},_addToManager:function(e){te.ui.ddmanager.droppables[e]=te.ui.ddmanager.droppables[e]||[];te.ui.ddmanager.droppables[e].push(this)},_splice:function(e){var t=0;for(;t<e.length;t++){if(e[t]===this){e.splice(t,1)}}},_destroy:function(){var e=te.ui.ddmanager.droppables[this.options.scope];this._splice(e)},_setOption:function(e,t){if(e==="accept"){this.accept=typeof t==="function"?t:function(e){return e.is(t)}}else if(e==="scope"){var i=te.ui.ddmanager.droppables[this.options.scope];this._splice(i);this._addToManager(t)}this._super(e,t)},_activate:function(e){var t=te.ui.ddmanager.current;this._addActiveClass();if(t){this._trigger("activate",e,this.ui(t))}},_deactivate:function(e){var t=te.ui.ddmanager.current;this._removeActiveClass();if(t){this._trigger("deactivate",e,this.ui(t))}},_over:function(e){var t=te.ui.ddmanager.current;if(!t||(t.currentItem||t.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],t.currentItem||t.element)){this._addHoverClass();this._trigger("over",e,this.ui(t))}},_out:function(e){var t=te.ui.ddmanager.current;if(!t||(t.currentItem||t.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],t.currentItem||t.element)){this._removeHoverClass();this._trigger("out",e,this.ui(t))}},_drop:function(t,e){var i=e||te.ui.ddmanager.current,n=false;if(!i||(i.currentItem||i.element)[0]===this.element[0]){return false}this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var e=te(this).droppable("instance");if(e.options.greedy&&!e.options.disabled&&e.options.scope===i.options.scope&&e.accept.call(e.element[0],i.currentItem||i.element)&&te.ui.intersect(i,te.extend(e,{offset:e.element.offset()}),e.options.tolerance,t)){n=true;return false}});if(n){return false}if(this.accept.call(this.element[0],i.currentItem||i.element)){this._removeActiveClass();this._removeHoverClass();this._trigger("drop",t,this.ui(i));return this.element}return false},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});te.ui.intersect=function(){function h(e,t,i){return e>=t&&e<t+i}return function(e,t,i,n){if(!t.offset){return false}var r=(e.positionAbs||e.position.absolute).left+e.margins.left,o=(e.positionAbs||e.position.absolute).top+e.margins.top,s=r+e.helperProportions.width,a=o+e.helperProportions.height,l=t.offset.left,c=t.offset.top,u=l+t.proportions().width,d=c+t.proportions().height;switch(i){case"fit":return l<=r&&s<=u&&c<=o&&a<=d;case"intersect":return l<r+e.helperProportions.width/2&&s-e.helperProportions.width/2<u&&c<o+e.helperProportions.height/2&&a-e.helperProportions.height/2<d;case"pointer":return h(n.pageY,c,t.proportions().height)&&h(n.pageX,l,t.proportions().width);case"touch":return(o>=c&&o<=d||a>=c&&a<=d||o<c&&a>d)&&(r>=l&&r<=u||s>=l&&s<=u||r<l&&s>u);default:return false}}}();te.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,t){var i,n,r=te.ui.ddmanager.droppables[e.options.scope]||[],o=t?t.type:null,s=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();e:for(i=0;i<r.length;i++){if(r[i].options.disabled||e&&!r[i].accept.call(r[i].element[0],e.currentItem||e.element)){continue}for(n=0;n<s.length;n++){if(s[n]===r[i].element[0]){r[i].proportions().height=0;continue e}}r[i].visible=r[i].element.css("display")!=="none";if(!r[i].visible){continue}if(o==="mousedown"){r[i]._activate.call(r[i],t)}r[i].offset=r[i].element.offset();r[i].proportions({width:r[i].element[0].offsetWidth,height:r[i].element[0].offsetHeight})}},drop:function(e,t){var i=false;te.each((te.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&te.ui.intersect(e,this,this.options.tolerance,t)){i=this._drop.call(this,t)||i}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)){this.isout=true;this.isover=false;this._deactivate.call(this,t)}});return i},dragStart:function(e,t){e.element.parentsUntil("body").on("scroll.droppable",function(){if(!e.options.refreshPositions){te.ui.ddmanager.prepareOffsets(e,t)}})},drag:function(o,s){if(o.options.refreshPositions){te.ui.ddmanager.prepareOffsets(o,s)}te.each(te.ui.ddmanager.droppables[o.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var e,t,i,n=te.ui.intersect(o,this,this.options.tolerance,s),r=!n&&this.isover?"isout":n&&!this.isover?"isover":null;if(!r){return}if(this.options.greedy){t=this.options.scope;i=this.element.parents(":data(ui-droppable)").filter(function(){return te(this).droppable("instance").options.scope===t});if(i.length){e=te(i[0]).droppable("instance");e.greedyChild=r==="isover"}}if(e&&r==="isover"){e.isover=false;e.isout=true;e._out.call(e,s)}this[r]=true;this[r==="isout"?"isover":"isout"]=false;this[r==="isover"?"_over":"_out"].call(this,s);if(e&&r==="isout"){e.isout=false;e.isover=true;e._over.call(e,s)}})},dragStop:function(e,t){e.element.parentsUntil("body").off("scroll.droppable");if(!e.options.refreshPositions){te.ui.ddmanager.prepareOffsets(e,t)}}};if(te.uiBackCompat!==false){te.widget("ui.droppable",te.ui.droppable,{options:{hoverClass:false,activeClass:false},_addActiveClass:function(){this._super();if(this.options.activeClass){this.element.addClass(this.options.activeClass)}},_removeActiveClass:function(){this._super();if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}},_addHoverClass:function(){this._super();if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}},_removeHoverClass:function(){this._super();if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}}})}var Ee=te.ui.droppable;var Te=te.widget("ui.progressbar",{version:"1.13.1",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue();this.element.attr({role:"progressbar","aria-valuemin":this.min});this._addClass("ui-progressbar","ui-widget ui-widget-content");this.valueDiv=te("<div>").appendTo(this.element);this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header");this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow");this.valueDiv.remove()},value:function(e){if(e===undefined){return this.options.value}this.options.value=this._constrainedValue(e);this._refreshValue()},_constrainedValue:function(e){if(e===undefined){e=this.options.value}this.indeterminate=e===false;if(typeof e!=="number"){e=0}return this.indeterminate?false:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value;this._super(e);this.options.value=this._constrainedValue(t);this._refreshValue()},_setOption:function(e,t){if(e==="max"){t=Math.max(this.min,t)}this._super(e,t)},_setOptionDisabled:function(e){this._super(e);this.element.attr("aria-disabled",e);this._toggleClass(null,"ui-state-disabled",!!e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,t=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).width(t.toFixed(0)+"%");this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,e===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate);if(this.indeterminate){this.element.removeAttr("aria-valuenow");if(!this.overlayDiv){this.overlayDiv=te("<div>").appendTo(this.valueDiv);this._addClass(this.overlayDiv,"ui-progressbar-overlay")}}else{this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e});if(this.overlayDiv){this.overlayDiv.remove();this.overlayDiv=null}}if(this.oldValue!==e){this.oldValue=e;this._trigger("change")}if(e===this.options.max){this._trigger("complete")}}});var De=te.widget("ui.selectable",te.ui.mouse,{version:"1.13.1",options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var r=this;this._addClass("ui-selectable");this.dragged=false;this.refresh=function(){r.elementPos=te(r.element[0]).offset();r.selectees=te(r.options.filter,r.element[0]);r._addClass(r.selectees,"ui-selectee");r.selectees.each(function(){var e=te(this),t=e.offset(),i=this.getBoundingClientRect(),n={left:t.left-r.elementPos.left,top:t.top-r.elementPos.top};te.data(this,"selectable-item",{element:this,$element:e,left:n.left,top:n.top,right:n.left+i.width,bottom:n.top+i.height,startselected:false,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})};this.refresh();this._mouseInit();this.helper=te("<div>");this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item");this._mouseDestroy()},_mouseStart:function(i){var n=this,e=this.options;this.opos=[i.pageX,i.pageY];this.elementPos=te(this.element[0]).offset();if(this.options.disabled){return}this.selectees=te(e.filter,this.element[0]);this._trigger("start",i);te(e.appendTo).append(this.helper);this.helper.css({left:i.pageX,top:i.pageY,width:0,height:0});if(e.autoRefresh){this.refresh()}this.selectees.filter(".ui-selected").each(function(){var e=te.data(this,"selectable-item");e.startselected=true;if(!i.metaKey&&!i.ctrlKey){n._removeClass(e.$element,"ui-selected");e.selected=false;n._addClass(e.$element,"ui-unselecting");e.unselecting=true;n._trigger("unselecting",i,{unselecting:e.element})}});te(i.target).parents().addBack().each(function(){var e,t=te.data(this,"selectable-item");if(t){e=!i.metaKey&&!i.ctrlKey||!t.$element.hasClass("ui-selected");n._removeClass(t.$element,e?"ui-unselecting":"ui-selected")._addClass(t.$element,e?"ui-selecting":"ui-unselecting");t.unselecting=!e;t.selecting=e;t.selected=e;if(e){n._trigger("selecting",i,{selecting:t.element})}else{n._trigger("unselecting",i,{unselecting:t.element})}return false}})},_mouseDrag:function(n){this.dragged=true;if(this.options.disabled){return}var e,r=this,o=this.options,s=this.opos[0],a=this.opos[1],l=n.pageX,c=n.pageY;if(s>l){e=l;l=s;s=e}if(a>c){e=c;c=a;a=e}this.helper.css({left:s,top:a,width:l-s,height:c-a});this.selectees.each(function(){var e=te.data(this,"selectable-item"),t=false,i={};if(!e||e.element===r.element[0]){return}i.left=e.left+r.elementPos.left;i.right=e.right+r.elementPos.left;i.top=e.top+r.elementPos.top;i.bottom=e.bottom+r.elementPos.top;if(o.tolerance==="touch"){t=!(i.left>l||i.right<s||i.top>c||i.bottom<a)}else if(o.tolerance==="fit"){t=i.left>s&&i.right<l&&i.top>a&&i.bottom<c}if(t){if(e.selected){r._removeClass(e.$element,"ui-selected");e.selected=false}if(e.unselecting){r._removeClass(e.$element,"ui-unselecting");e.unselecting=false}if(!e.selecting){r._addClass(e.$element,"ui-selecting");e.selecting=true;r._trigger("selecting",n,{selecting:e.element})}}else{if(e.selecting){if((n.metaKey||n.ctrlKey)&&e.startselected){r._removeClass(e.$element,"ui-selecting");e.selecting=false;r._addClass(e.$element,"ui-selected");e.selected=true}else{r._removeClass(e.$element,"ui-selecting");e.selecting=false;if(e.startselected){r._addClass(e.$element,"ui-unselecting");e.unselecting=true}r._trigger("unselecting",n,{unselecting:e.element})}}if(e.selected){if(!n.metaKey&&!n.ctrlKey&&!e.startselected){r._removeClass(e.$element,"ui-selected");e.selected=false;r._addClass(e.$element,"ui-unselecting");e.unselecting=true;r._trigger("unselecting",n,{unselecting:e.element})}}}});return false},_mouseStop:function(t){var i=this;this.dragged=false;te(".ui-unselecting",this.element[0]).each(function(){var e=te.data(this,"selectable-item");i._removeClass(e.$element,"ui-unselecting");e.unselecting=false;e.startselected=false;i._trigger("unselected",t,{unselected:e.element})});te(".ui-selecting",this.element[0]).each(function(){var e=te.data(this,"selectable-item");i._removeClass(e.$element,"ui-selecting")._addClass(e.$element,"ui-selected");e.selecting=false;e.selected=true;e.startselected=true;i._trigger("selected",t,{selected:e.element})});this._trigger("stop",t);this.helper.remove();return false}});var Re=te.widget("ui.selectmenu",[te.ui.formResetMixin,{version:"1.13.1",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:false,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"};this._drawButton();this._drawMenu();this._bindFormResetHandler();this._rendered=false;this.menuItems=te()},_drawButton:function(){var e,t=this,i=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button);this._on(this.labels,{click:function(e){this.button.trigger("focus");e.preventDefault()}});this.element.hide();this.button=te("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element);this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget");e=te("<span>").appendTo(this.button);this._addClass(e,"ui-selectmenu-icon","ui-icon "+this.options.icons.button);this.buttonItem=this._renderButtonItem(i).appendTo(this.button);if(this.options.width!==false){this._resizeButton()}this._on(this.button,this._buttonEvents);this.button.one("focusin",function(){if(!t._rendered){t._refreshMenu()}})},_drawMenu:function(){var n=this;this.menu=te("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu});this.menuWrap=te("<div>").append(this.menu);this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front");this.menuWrap.appendTo(this._appendTo());this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(e,t){e.preventDefault();n._setSelection();n._select(t.item.data("ui-selectmenu-item"),e)},focus:function(e,t){var i=t.item.data("ui-selectmenu-item");if(n.focusIndex!=null&&i.index!==n.focusIndex){n._trigger("focus",e,{item:i});if(!n.isOpen){n._select(i,e)}}n.focusIndex=i.index;n.button.attr("aria-activedescendant",n.menuItems.eq(i.index).attr("id"))}}).menu("instance");this.menuInstance._off(this.menu,"mouseleave");this.menuInstance._closeOnDocumentClick=function(){return false};this.menuInstance._isDivider=function(){return false}},refresh:function(){this._refreshMenu();this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{}));if(this.options.width===null){this._resizeButton()}},_refreshMenu:function(){var e,t=this.element.find("option");this.menu.empty();this._parseOptions(t);this._renderMenu(this.menu,this.items);this.menuInstance.refresh();this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper");this._rendered=true;if(!t.length){return}e=this._getSelectedItem();this.menuInstance.focus(null,e);this._setAria(e.data("ui-selectmenu-item"));this._setOption("disabled",this.element.prop("disabled"))},open:function(e){if(this.options.disabled){return}if(!this._rendered){this._refreshMenu()}else{this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active");this.menuInstance.focus(null,this._getSelectedItem())}if(!this.menuItems.length){return}this.isOpen=true;this._toggleAttr();this._resizeMenu();this._position();this._on(this.document,this._documentClick);this._trigger("open",e)},_position:function(){this.menuWrap.position(te.extend({of:this.button},this.options.position))},close:function(e){if(!this.isOpen){return}this.isOpen=false;this._toggleAttr();this.range=null;this._off(this.document);this._trigger("close",e)},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(e){var t=te("<span>");this._setText(t,e.label);this._addClass(t,"ui-selectmenu-text");return t},_renderMenu:function(n,e){var r=this,o="";te.each(e,function(e,t){var i;if(t.optgroup!==o){i=te("<li>",{text:t.optgroup});r._addClass(i,"ui-selectmenu-optgroup","ui-menu-divider"+(t.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""));i.appendTo(n);o=t.optgroup}r._renderItemData(n,t)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(e,t){var i=te("<li>"),n=te("<div>",{title:t.element.attr("title")});if(t.disabled){this._addClass(i,null,"ui-state-disabled")}this._setText(n,t.label);return i.append(n).appendTo(e)},_setText:function(e,t){if(t){e.text(t)}else{e.html("&#160;")}},_move:function(e,t){var i,n,r=".ui-menu-item";if(this.isOpen){i=this.menuItems.eq(this.focusIndex).parent("li")}else{i=this.menuItems.eq(this.element[0].selectedIndex).parent("li");r+=":not(.ui-state-disabled)"}if(e==="first"||e==="last"){n=i[e==="first"?"prevAll":"nextAll"](r).eq(-1)}else{n=i[e+"All"](r).eq(0)}if(n.length){this.menuInstance.focus(t,n)}},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_setSelection:function(){var e;if(!this.range){return}if(window.getSelection){e=window.getSelection();e.removeAllRanges();e.addRange(this.range)}else{this.range.select()}this.button.focus()},_documentClick:{mousedown:function(e){if(!this.isOpen){return}if(!te(e.target).closest(".ui-selectmenu-menu, #"+te.escapeSelector(this.ids.button)).length){this.close(e)}}},_buttonEvents:{mousedown:function(){var e;if(window.getSelection){e=window.getSelection();if(e.rangeCount){this.range=e.getRangeAt(0)}}else{this.range=document.selection.createRange()}},click:function(e){this._setSelection();this._toggle(e)},keydown:function(e){var t=true;switch(e.keyCode){case te.ui.keyCode.TAB:case te.ui.keyCode.ESCAPE:this.close(e);t=false;break;case te.ui.keyCode.ENTER:if(this.isOpen){this._selectFocusedItem(e)}break;case te.ui.keyCode.UP:if(e.altKey){this._toggle(e)}else{this._move("prev",e)}break;case te.ui.keyCode.DOWN:if(e.altKey){this._toggle(e)}else{this._move("next",e)}break;case te.ui.keyCode.SPACE:if(this.isOpen){this._selectFocusedItem(e)}else{this._toggle(e)}break;case te.ui.keyCode.LEFT:this._move("prev",e);break;case te.ui.keyCode.RIGHT:this._move("next",e);break;case te.ui.keyCode.HOME:case te.ui.keyCode.PAGE_UP:this._move("first",e);break;case te.ui.keyCode.END:case te.ui.keyCode.PAGE_DOWN:this._move("last",e);break;default:this.menu.trigger(e);t=false}if(t){e.preventDefault()}}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex).parent("li");if(!t.hasClass("ui-state-disabled")){this._select(t.data("ui-selectmenu-item"),e)}},_select:function(e,t){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index;this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(e));this._setAria(e);this._trigger("select",t,{item:e});if(e.index!==i){this._trigger("change",t,{item:e})}this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t});this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){if(e==="icons"){var i=this.button.find("span.ui-icon");this._removeClass(i,null,this.options.icons.button)._addClass(i,null,t.button)}this._super(e,t);if(e==="appendTo"){this.menuWrap.appendTo(this._appendTo())}if(e==="width"){this._resizeButton()}},_setOptionDisabled:function(e){this._super(e);this.menuInstance.option("disabled",e);this.button.attr("aria-disabled",e);this._toggleClass(this.button,null,"ui-state-disabled",e);this.element.prop("disabled",e);if(e){this.button.attr("tabindex",-1);this.close()}else{this.button.attr("tabindex",0)}},_appendTo:function(){var e=this.options.appendTo;if(e){e=e.jquery||e.nodeType?te(e):this.document.find(e).eq(0)}if(!e||!e[0]){e=this.element.closest(".ui-front, dialog")}if(!e.length){e=this.document[0].body}return e},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen);this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen);this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;if(e===false){this.button.css("width","");return}if(e===null){e=this.element.show().outerWidth();this.element.hide()}this.button.outerWidth(e)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var e=this._super();e.disabled=this.element.prop("disabled");return e},_parseOptions:function(e){var i=this,n=[];e.each(function(e,t){if(t.hidden){return}n.push(i._parseOption(te(t),e))});this.items=n},_parseOption:function(e,t){var i=e.parent("optgroup");return{element:e,index:t,value:e.val(),label:e.text(),optgroup:i.attr("label")||"",disabled:i.prop("disabled")||e.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler();this.menuWrap.remove();this.button.remove();this.element.show();this.element.removeUniqueId();this.labels.attr("for",this.ids.element)}}]);var Me=te.widget("ui.slider",te.ui.mouse,{version:"1.13.1",widgetEventPrefix:"slide",options:{animate:false,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this._calculateNewMax();this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content");this._refresh();this._animateOff=false},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var e,t,i=this.options,n=this.element.find(".ui-slider-handle"),r="<span tabindex='0'></span>",o=[];t=i.values&&i.values.length||1;if(n.length>t){n.slice(t).remove();n=n.slice(0,t)}for(e=n.length;e<t;e++){o.push(r)}this.handles=n.add(te(o.join("")).appendTo(this.element));this._addClass(this.handles,"ui-slider-handle","ui-state-default");this.handle=this.handles.eq(0);this.handles.each(function(e){te(this).data("ui-slider-handle-index",e).attr("tabIndex",0)})},_createRange:function(){var e=this.options;if(e.range){if(e.range===true){if(!e.values){e.values=[this._valueMin(),this._valueMin()]}else if(e.values.length&&e.values.length!==2){e.values=[e.values[0],e.values[0]]}else if(Array.isArray(e.values)){e.values=e.values.slice(0)}}if(!this.range||!this.range.length){this.range=te("<div>").appendTo(this.element);this._addClass(this.range,"ui-slider-range")}else{this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max");this.range.css({left:"",bottom:""})}if(e.range==="min"||e.range==="max"){this._addClass(this.range,"ui-slider-range-"+e.range)}}else{if(this.range){this.range.remove()}this.range=null}},_setupEvents:function(){this._off(this.handles);this._on(this.handles,this._handleEvents);this._hoverable(this.handles);this._focusable(this.handles)},_destroy:function(){this.handles.remove();if(this.range){this.range.remove()}this._mouseDestroy()},_mouseCapture:function(e){var t,i,n,r,o,s,a,l,c=this,u=this.options;if(u.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();t={x:e.pageX,y:e.pageY};i=this._normValueFromMouse(t);n=this._valueMax()-this._valueMin()+1;this.handles.each(function(e){var t=Math.abs(i-c.values(e));if(n>t||n===t&&(e===c._lastChangedValue||c.values(e)===u.min)){n=t;r=te(this);o=e}});s=this._start(e,o);if(s===false){return false}this._mouseSliding=true;this._handleIndex=o;this._addClass(r,null,"ui-state-active");r.trigger("focus");a=r.offset();l=!te(e.target).parents().addBack().is(".ui-slider-handle");this._clickOffset=l?{left:0,top:0}:{left:e.pageX-a.left-r.width()/2,top:e.pageY-a.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(e,o,i)}this._animateOff=true;return true},_mouseStart:function(){return true},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);this._slide(e,this._handleIndex,i);return false},_mouseStop:function(e){this._removeClass(this.handles,null,"ui-state-active");this._mouseSliding=false;this._stop(e,this._handleIndex);this._change(e,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,n,r,o;if(this.orientation==="horizontal"){t=this.elementSize.width;i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{t=this.elementSize.height;i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}n=i/t;if(n>1){n=1}if(n<0){n=0}if(this.orientation==="vertical"){n=1-n}r=this._valueMax()-this._valueMin();o=this._valueMin()+n*r;return this._trimAlignValue(o)},_uiHash:function(e,t,i){var n={handle:this.handles[e],handleIndex:e,value:t!==undefined?t:this.value()};if(this._hasMultipleValues()){n.value=t!==undefined?t:this.values(e);n.values=i||this.values()}return n},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(e,t){return this._trigger("start",e,this._uiHash(t))},_slide:function(e,t,i){var n,r,o=this.value(),s=this.values();if(this._hasMultipleValues()){r=this.values(t?0:1);o=this.values(t);if(this.options.values.length===2&&this.options.range===true){i=t===0?Math.min(r,i):Math.max(r,i)}s[t]=i}if(i===o){return}n=this._trigger("slide",e,this._uiHash(t,i,s));if(n===false){return}if(this._hasMultipleValues()){this.values(t,i)}else{this.value(i)}},_stop:function(e,t){this._trigger("stop",e,this._uiHash(t))},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){this._lastChangedValue=t;this._trigger("change",e,this._uiHash(t))}},value:function(e){if(arguments.length){this.options.value=this._trimAlignValue(e);this._refreshValue();this._change(null,0);return}return this._value()},values:function(e,t){var i,n,r;if(arguments.length>1){this.options.values[e]=this._trimAlignValue(t);this._refreshValue();this._change(null,e);return}if(arguments.length){if(Array.isArray(arguments[0])){i=this.options.values;n=arguments[0];for(r=0;r<i.length;r+=1){i[r]=this._trimAlignValue(n[r]);this._change(null,r)}this._refreshValue()}else{if(this._hasMultipleValues()){return this._values(e)}else{return this.value()}}}else{return this._values()}},_setOption:function(e,t){var i,n=0;if(e==="range"&&this.options.range===true){if(t==="min"){this.options.value=this._values(0);this.options.values=null}else if(t==="max"){this.options.value=this._values(this.options.values.length-1);this.options.values=null}}if(Array.isArray(this.options.values)){n=this.options.values.length}this._super(e,t);switch(e){case"orientation":this._detectOrientation();this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation);this._refreshValue();if(this.options.range){this._refreshRange(t)}this.handles.css(t==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(i=n-1;i>=0;i--){this._change(null,i)}this._animateOff=false;break;case"step":case"min":case"max":this._animateOff=true;this._calculateNewMax();this._refreshValue();this._animateOff=false;break;case"range":this._animateOff=true;this._refresh();this._animateOff=false;break}},_setOptionDisabled:function(e){this._super(e);this._toggleClass(null,"ui-state-disabled",!!e)},_value:function(){var e=this.options.value;e=this._trimAlignValue(e);return e},_values:function(e){var t,i,n;if(arguments.length){t=this.options.values[e];t=this._trimAlignValue(t);return t}else if(this._hasMultipleValues()){i=this.options.values.slice();for(n=0;n<i.length;n+=1){i[n]=this._trimAlignValue(i[n])}return i}else{return[]}},_trimAlignValue:function(e){if(e<=this._valueMin()){return this._valueMin()}if(e>=this._valueMax()){return this._valueMax()}var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,n=e-i;if(Math.abs(i)*2>=t){n+=i>0?t:-t}return parseFloat(n.toFixed(5))},_calculateNewMax:function(){var e=this.options.max,t=this._valueMin(),i=this.options.step,n=Math.round((e-t)/i)*i;e=n+t;if(e>this.options.max){e-=i}this.max=parseFloat(e.toFixed(this._precision()))},_precision:function(){var e=this._precisionOf(this.options.step);if(this.options.min!==null){e=Math.max(e,this._precisionOf(this.options.min))}return e},_precisionOf:function(e){var t=e.toString(),i=t.indexOf(".");return i===-1?0:t.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(e){if(e==="vertical"){this.range.css({width:"",left:""})}if(e==="horizontal"){this.range.css({height:"",bottom:""})}},_refreshValue:function(){var t,i,e,n,r,o=this.options.range,s=this.options,a=this,l=!this._animateOff?s.animate:false,c={};if(this._hasMultipleValues()){this.handles.each(function(e){i=(a.values(e)-a._valueMin())/(a._valueMax()-a._valueMin())*100;c[a.orientation==="horizontal"?"left":"bottom"]=i+"%";te(this).stop(1,1)[l?"animate":"css"](c,s.animate);if(a.options.range===true){if(a.orientation==="horizontal"){if(e===0){a.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},s.animate)}if(e===1){a.range[l?"animate":"css"]({width:i-t+"%"},{queue:false,duration:s.animate})}}else{if(e===0){a.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},s.animate)}if(e===1){a.range[l?"animate":"css"]({height:i-t+"%"},{queue:false,duration:s.animate})}}}t=i})}else{e=this.value();n=this._valueMin();r=this._valueMax();i=r!==n?(e-n)/(r-n)*100:0;c[this.orientation==="horizontal"?"left":"bottom"]=i+"%";this.handle.stop(1,1)[l?"animate":"css"](c,s.animate);if(o==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},s.animate)}if(o==="max"&&this.orientation==="horizontal"){this.range.stop(1,1)[l?"animate":"css"]({width:100-i+"%"},s.animate)}if(o==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},s.animate)}if(o==="max"&&this.orientation==="vertical"){this.range.stop(1,1)[l?"animate":"css"]({height:100-i+"%"},s.animate)}}},_handleEvents:{keydown:function(e){var t,i,n,r,o=te(e.target).data("ui-slider-handle-index");switch(e.keyCode){case te.ui.keyCode.HOME:case te.ui.keyCode.END:case te.ui.keyCode.PAGE_UP:case te.ui.keyCode.PAGE_DOWN:case te.ui.keyCode.UP:case te.ui.keyCode.RIGHT:case te.ui.keyCode.DOWN:case te.ui.keyCode.LEFT:e.preventDefault();if(!this._keySliding){this._keySliding=true;this._addClass(te(e.target),null,"ui-state-active");t=this._start(e,o);if(t===false){return}}break}r=this.options.step;if(this._hasMultipleValues()){i=n=this.values(o)}else{i=n=this.value()}switch(e.keyCode){case te.ui.keyCode.HOME:n=this._valueMin();break;case te.ui.keyCode.END:n=this._valueMax();break;case te.ui.keyCode.PAGE_UP:n=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/this.numPages);break;case te.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/this.numPages);break;case te.ui.keyCode.UP:case te.ui.keyCode.RIGHT:if(i===this._valueMax()){return}n=this._trimAlignValue(i+r);break;case te.ui.keyCode.DOWN:case te.ui.keyCode.LEFT:if(i===this._valueMin()){return}n=this._trimAlignValue(i-r);break}this._slide(e,o,n)},keyup:function(e){var t=te(e.target).data("ui-slider-handle-index");if(this._keySliding){this._keySliding=false;this._stop(e,t);this._change(e,t);this._removeClass(te(e.target),null,"ui-state-active")}}}});var ke=te.widget("ui.sortable",te.ui.mouse,{version:"1.13.1",widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&e<t+i},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={};this._addClass("ui-sortable");this.refresh();this.offset=this.element.offset();this._mouseInit();this._setHandleClassName();this.ready=true},_setOption:function(e,t){this._super(e,t);if(e==="handle"){this._setHandleClassName()}},_setHandleClassName:function(){var e=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle");te.each(this.items,function(){e._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--){this.items[e].item.removeData(this.widgetName+"-item")}return this},_mouseCapture:function(e,t){var i=null,n=false,r=this;if(this.reverting){return false}if(this.options.disabled||this.options.type==="static"){return false}this._refreshItems(e);te(e.target).parents().each(function(){if(te.data(this,r.widgetName+"-item")===r){i=te(this);return false}});if(te.data(e.target,r.widgetName+"-item")===r){i=te(e.target)}if(!i){return false}if(this.options.handle&&!t){te(this.options.handle,i).find("*").addBack().each(function(){if(this===e.target){n=true}});if(!n){return false}}this.currentItem=i;this._removeCurrentsFromItems();return true},_mouseStart:function(e,t,i){var n,r,o=this.options;this.currentContainer=this;this.refreshPositions();this.appendTo=te(o.appendTo!=="parent"?o.appendTo:this.currentItem.parent());this.helper=this._createHelper(e);this._cacheHelperProportions();this._cacheMargins();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};te.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");if(o.cursorAt){this._adjustOffsetFromHelper(o.cursorAt)}this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();this.scrollParent=this.placeholder.scrollParent();te.extend(this.offset,{parent:this._getParentOffset()});if(o.containment){this._setContainment()}if(o.cursor&&o.cursor!=="auto"){r=this.document.find("body");this.storedCursor=r.css("cursor");r.css("cursor",o.cursor);this.storedStylesheet=te("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(r)}if(o.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",o.zIndex)}if(o.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",o.opacity)}if(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",e,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions()}if(!i){for(n=this.containers.length-1;n>=0;n--){this.containers[n]._trigger("activate",e,this._uiHash(this))}}if(te.ui.ddmanager){te.ui.ddmanager.current=this}if(te.ui.ddmanager&&!o.dropBehaviour){te.ui.ddmanager.prepareOffsets(this,e)}this.dragging=true;this._addClass(this.helper,"ui-sortable-helper");if(!this.helper.parent().is(this.appendTo)){this.helper.detach().appendTo(this.appendTo);this.offset.parent=this._getParentOffset()}this.position=this.originalPosition=this._generatePosition(e);this.originalPageX=e.pageX;this.originalPageY=e.pageY;this.lastPositionAbs=this.positionAbs=this._convertPositionTo("absolute");this._mouseDrag(e);return true},_scroll:function(e){var t=this.options,i=false;if(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"){if(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<t.scrollSensitivity){this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop+t.scrollSpeed}else if(e.pageY-this.overflowOffset.top<t.scrollSensitivity){this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop-t.scrollSpeed}if(this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<t.scrollSensitivity){this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft+t.scrollSpeed}else if(e.pageX-this.overflowOffset.left<t.scrollSensitivity){this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft-t.scrollSpeed}}else{if(e.pageY-this.document.scrollTop()<t.scrollSensitivity){i=this.document.scrollTop(this.document.scrollTop()-t.scrollSpeed)}else if(this.window.height()-(e.pageY-this.document.scrollTop())<t.scrollSensitivity){i=this.document.scrollTop(this.document.scrollTop()+t.scrollSpeed)}if(e.pageX-this.document.scrollLeft()<t.scrollSensitivity){i=this.document.scrollLeft(this.document.scrollLeft()-t.scrollSpeed)}else if(this.window.width()-(e.pageX-this.document.scrollLeft())<t.scrollSensitivity){i=this.document.scrollLeft(this.document.scrollLeft()+t.scrollSpeed)}}return i},_mouseDrag:function(e){var t,i,n,r,o=this.options;this.position=this._generatePosition(e);this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px"}if(o.scroll){if(this._scroll(e)!==false){this._refreshItemPositions(true);if(te.ui.ddmanager&&!o.dropBehaviour){te.ui.ddmanager.prepareOffsets(this,e)}}}this.dragDirection={vertical:this._getDragVerticalDirection(),horizontal:this._getDragHorizontalDirection()};for(t=this.items.length-1;t>=0;t--){i=this.items[t];n=i.item[0];r=this._intersectsWithPointer(i);if(!r){continue}if(i.instance!==this.currentContainer){continue}if(n!==this.currentItem[0]&&this.placeholder[r===1?"next":"prev"]()[0]!==n&&!te.contains(this.placeholder[0],n)&&(this.options.type==="semi-dynamic"?!te.contains(this.element[0],n):true)){this.direction=r===1?"down":"up";if(this.options.tolerance==="pointer"||this._intersectsWithSides(i)){this._rearrange(e,i)}else{break}this._trigger("change",e,this._uiHash());break}}this._contactContainers(e);if(te.ui.ddmanager){te.ui.ddmanager.drag(this,e)}this._trigger("sort",e,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(e,t){if(!e){return}if(te.ui.ddmanager&&!this.options.dropBehaviour){te.ui.ddmanager.drop(this,e)}if(this.options.revert){var i=this,n=this.placeholder.offset(),r=this.options.axis,o={};if(!r||r==="x"){o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)}if(!r||r==="y"){o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)}this.reverting=true;te(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){i._clear(e)})}else{this._clear(e,t)}return false},cancel:function(){if(this.dragging){this._mouseUp(new te.Event("mouseup",{target:null}));if(this.options.helper==="original"){this.currentItem.css(this._storedCSS);this._removeClass(this.currentItem,"ui-sortable-helper")}else{this.currentItem.show()}for(var e=this.containers.length-1;e>=0;e--){this.containers[e]._trigger("deactivate",null,this._uiHash(this));if(this.containers[e].containerCache.over){this.containers[e]._trigger("out",null,this._uiHash(this));this.containers[e].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])}if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove()}te.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){te(this.domPosition.prev).after(this.currentItem)}else{te(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(t){var e=this._getItemsAsjQuery(t&&t.connected),i=[];t=t||{};te(e).each(function(){var e=(te(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);if(e){i.push((t.key||e[1]+"[]")+"="+(t.key&&t.expression?e[1]:e[2]))}});if(!i.length&&t.key){i.push(t.key+"=")}return i.join("&")},toArray:function(e){var t=this._getItemsAsjQuery(e&&e.connected),i=[];e=e||{};t.each(function(){i.push(te(e.item||this).attr(e.attribute||"id")||"")});return i},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,n=this.positionAbs.top,r=n+this.helperProportions.height,o=e.left,s=o+e.width,a=e.top,l=a+e.height,c=this.offset.click.top,u=this.offset.click.left,d=this.options.axis==="x"||n+c>a&&n+c<l,h=this.options.axis==="y"||t+u>o&&t+u<s,f=d&&h;if(this.options.tolerance==="pointer"||this.options.forcePointerForContainers||this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]){return f}else{return o<t+this.helperProportions.width/2&&i-this.helperProportions.width/2<s&&a<n+this.helperProportions.height/2&&r-this.helperProportions.height/2<l}},_intersectsWithPointer:function(e){var t,i,n=this.options.axis==="x"||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),r=this.options.axis==="y"||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),o=n&&r;if(!o){return false}t=this.dragDirection.vertical;i=this.dragDirection.horizontal;return this.floating?i==="right"||t==="down"?2:1:t&&(t==="down"?2:1)},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),n=this.dragDirection.vertical,r=this.dragDirection.horizontal;if(this.floating&&r){return r==="right"&&i||r==="left"&&!i}else{return n&&(n==="down"&&t||n==="up"&&!t)}},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return e!==0&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return e!==0&&(e>0?"right":"left")},refresh:function(e){this._refreshItems(e);this._setHandleClassName();this.refreshPositions();return this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(e){var t,i,n,r,o=[],s=[],a=this._connectWith();if(a&&e){for(t=a.length-1;t>=0;t--){n=te(a[t],this.document[0]);for(i=n.length-1;i>=0;i--){r=te.data(n[i],this.widgetFullName);if(r&&r!==this&&!r.options.disabled){s.push([typeof r.options.items==="function"?r.options.items.call(r.element):te(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r])}}}}s.push([typeof this.options.items==="function"?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):te(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);function l(){o.push(this)}for(t=s.length-1;t>=0;t--){s[t][0].each(l)}return te(o)},_removeCurrentsFromItems:function(){var i=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=te.grep(this.items,function(e){for(var t=0;t<i.length;t++){if(i[t]===e.item[0]){return false}}return true})},_refreshItems:function(e){this.items=[];this.containers=[this];var t,i,n,r,o,s,a,l,c=this.items,u=[[typeof this.options.items==="function"?this.options.items.call(this.element[0],e,{item:this.currentItem}):te(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready){for(t=d.length-1;t>=0;t--){n=te(d[t],this.document[0]);for(i=n.length-1;i>=0;i--){r=te.data(n[i],this.widgetFullName);if(r&&r!==this&&!r.options.disabled){u.push([typeof r.options.items==="function"?r.options.items.call(r.element[0],e,{item:this.currentItem}):te(r.options.items,r.element),r]);this.containers.push(r)}}}}for(t=u.length-1;t>=0;t--){o=u[t][1];s=u[t][0];for(i=0,l=s.length;i<l;i++){a=te(s[i]);a.data(this.widgetName+"-item",o);c.push({item:a,instance:o,width:0,height:0,left:0,top:0})}}},_refreshItemPositions:function(e){var t,i,n,r;for(t=this.items.length-1;t>=0;t--){i=this.items[t];if(this.currentContainer&&i.instance!==this.currentContainer&&i.item[0]!==this.currentItem[0]){continue}n=this.options.toleranceElement?te(this.options.toleranceElement,i.item):i.item;if(!e){i.width=n.outerWidth();i.height=n.outerHeight()}r=n.offset();i.left=r.left;i.top=r.top}},refreshPositions:function(e){this.floating=this.items.length?this.options.axis==="x"||this._isFloating(this.items[0].item):false;if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}this._refreshItemPositions(e);var t,i;if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(t=this.containers.length-1;t>=0;t--){i=this.containers[t].element.offset();this.containers[t].containerCache.left=i.left;this.containers[t].containerCache.top=i.top;this.containers[t].containerCache.width=this.containers[t].element.outerWidth();this.containers[t].containerCache.height=this.containers[t].element.outerHeight()}}return this},_createPlaceholder:function(i){i=i||this;var n,r,o=i.options;if(!o.placeholder||o.placeholder.constructor===String){n=o.placeholder;r=i.currentItem[0].nodeName.toLowerCase();o.placeholder={element:function(){var e=te("<"+r+">",i.document[0]);i._addClass(e,"ui-sortable-placeholder",n||i.currentItem[0].className)._removeClass(e,"ui-sortable-helper");if(r==="tbody"){i._createTrPlaceholder(i.currentItem.find("tr").eq(0),te("<tr>",i.document[0]).appendTo(e))}else if(r==="tr"){i._createTrPlaceholder(i.currentItem,e)}else if(r==="img"){e.attr("src",i.currentItem.attr("src"))}if(!n){e.css("visibility","hidden")}return e},update:function(e,t){if(n&&!o.forcePlaceholderSize){return}if(!t.height()||o.forcePlaceholderSize&&(r==="tbody"||r==="tr")){t.height(i.currentItem.innerHeight()-parseInt(i.currentItem.css("paddingTop")||0,10)-parseInt(i.currentItem.css("paddingBottom")||0,10))}if(!t.width()){t.width(i.currentItem.innerWidth()-parseInt(i.currentItem.css("paddingLeft")||0,10)-parseInt(i.currentItem.css("paddingRight")||0,10))}}}}i.placeholder=te(o.placeholder.element.call(i.element,i.currentItem));i.currentItem.after(i.placeholder);o.placeholder.update(i,i.placeholder)},_createTrPlaceholder:function(e,t){var i=this;e.children().each(function(){te("<td>&#160;</td>",i.document[0]).attr("colspan",te(this).attr("colspan")||1).appendTo(t)})},_contactContainers:function(e){var t,i,n,r,o,s,a,l,c,u,d=null,h=null;for(t=this.containers.length-1;t>=0;t--){if(te.contains(this.currentItem[0],this.containers[t].element[0])){continue}if(this._intersectsWith(this.containers[t].containerCache)){if(d&&te.contains(this.containers[t].element[0],d.element[0])){continue}d=this.containers[t];h=t}else{if(this.containers[t].containerCache.over){this.containers[t]._trigger("out",e,this._uiHash(this));this.containers[t].containerCache.over=0}}}if(!d){return}if(this.containers.length===1){if(!this.containers[h].containerCache.over){this.containers[h]._trigger("over",e,this._uiHash(this));this.containers[h].containerCache.over=1}}else{n=1e4;r=null;c=d.floating||this._isFloating(this.currentItem);o=c?"left":"top";s=c?"width":"height";u=c?"pageX":"pageY";for(i=this.items.length-1;i>=0;i--){if(!te.contains(this.containers[h].element[0],this.items[i].item[0])){continue}if(this.items[i].item[0]===this.currentItem[0]){continue}a=this.items[i].item.offset()[o];l=false;if(e[u]-a>this.items[i][s]/2){l=true}if(Math.abs(e[u]-a)<n){n=Math.abs(e[u]-a);r=this.items[i];this.direction=l?"up":"down"}}if(!r&&!this.options.dropOnEmpty){return}if(this.currentContainer===this.containers[h]){if(!this.currentContainer.containerCache.over){this.containers[h]._trigger("over",e,this._uiHash());this.currentContainer.containerCache.over=1}return}if(r){this._rearrange(e,r,null,true)}else{this._rearrange(e,null,this.containers[h].element,true)}this._trigger("change",e,this._uiHash());this.containers[h]._trigger("change",e,this._uiHash(this));this.currentContainer=this.containers[h];this.options.placeholder.update(this.currentContainer,this.placeholder);this.scrollParent=this.placeholder.scrollParent();if(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset()}this.containers[h]._trigger("over",e,this._uiHash(this));this.containers[h].containerCache.over=1}},_createHelper:function(e){var t=this.options,i=typeof t.helper==="function"?te(t.helper.apply(this.element[0],[e,this.currentItem])):t.helper==="clone"?this.currentItem.clone():this.currentItem;if(!i.parents("body").length){this.appendTo[0].appendChild(i[0])}if(i[0]===this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(!i[0].style.width||t.forceHelperSize){i.width(this.currentItem.width())}if(!i[0].style.height||t.forceHelperSize){i.height(this.currentItem.height())}return i},_adjustOffsetFromHelper:function(e){if(typeof e==="function"){e=e.call(this)}if(typeof e==="string"){e=e.split(" ")}if(Array.isArray(e)){e={left:+e[0],top:+e[1]||0}}if("left"in e){this.offset.click.left=e.left+this.margins.left}if("right"in e){this.offset.click.left=this.helperProportions.width-e.right+this.margins.left}if("top"in e){this.offset.click.top=e.top+this.margins.top}if("bottom"in e){this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==this.document[0]&&te.contains(this.scrollParent[0],this.offsetParent[0])){e.left+=this.scrollParent.scrollLeft();e.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&te.ui.ie){e={top:0,left:0}}return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,i,n=this.options;if(n.containment==="parent"){n.containment=this.helper[0].parentNode}if(n.containment==="document"||n.containment==="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,n.containment==="document"?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,(n.containment==="document"?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!/^(document|window|parent)$/.test(n.containment)){e=te(n.containment)[0];t=te(n.containment).offset();i=te(e).css("overflow")!=="hidden";this.containment=[t.left+(parseInt(te(e).css("borderLeftWidth"),10)||0)+(parseInt(te(e).css("paddingLeft"),10)||0)-this.margins.left,t.top+(parseInt(te(e).css("borderTopWidth"),10)||0)+(parseInt(te(e).css("paddingTop"),10)||0)-this.margins.top,t.left+(i?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(te(e).css("borderLeftWidth"),10)||0)-(parseInt(te(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,t.top+(i?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(te(e).css("borderTopWidth"),10)||0)-(parseInt(te(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(e,t){if(!t){t=this.position}var i=e==="absolute"?1:-1,n=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&te.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,r=/(html|body)/i.test(n[0].tagName);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():r?0:n.scrollTop())*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():r?0:n.scrollLeft())*i}},_generatePosition:function(e){var t,i,n=this.options,r=e.pageX,o=e.pageY,s=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&te.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,a=/(html|body)/i.test(s[0].tagName);if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}if(this.originalPosition){if(this.containment){if(e.pageX-this.offset.click.left<this.containment[0]){r=this.containment[0]+this.offset.click.left}if(e.pageY-this.offset.click.top<this.containment[1]){o=this.containment[1]+this.offset.click.top}if(e.pageX-this.offset.click.left>this.containment[2]){r=this.containment[2]+this.offset.click.left}if(e.pageY-this.offset.click.top>this.containment[3]){o=this.containment[3]+this.offset.click.top}}if(n.grid){t=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1];o=this.containment?t-this.offset.click.top>=this.containment[1]&&t-this.offset.click.top<=this.containment[3]?t:t-this.offset.click.top>=this.containment[1]?t-n.grid[1]:t+n.grid[1]:t;i=this.originalPageX+Math.round((r-this.originalPageX)/n.grid[0])*n.grid[0];r=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-n.grid[0]:i+n.grid[0]:i}}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():a?0:s.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():a?0:s.scrollLeft())}},_rearrange:function(e,t,i,n){if(i){i[0].appendChild(this.placeholder[0])}else{t.item[0].parentNode.insertBefore(this.placeholder[0],this.direction==="down"?t.item[0]:t.item[0].nextSibling)}this.counter=this.counter?++this.counter:1;var r=this.counter;this._delay(function(){if(r===this.counter){this.refreshPositions(!n)}})},_clear:function(e,t){this.reverting=false;var i,n=[];if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(i in this._storedCSS){if(this._storedCSS[i]==="auto"||this._storedCSS[i]==="static"){this._storedCSS[i]=""}}this.currentItem.css(this._storedCSS);this._removeClass(this.currentItem,"ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!t){n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!t){n.push(function(e){this._trigger("update",e,this._uiHash())})}if(this!==this.currentContainer){if(!t){n.push(function(e){this._trigger("remove",e,this._uiHash())});n.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer));n.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer))}}function r(t,i,n){return function(e){n._trigger(t,e,i._uiHash(i))}}for(i=this.containers.length-1;i>=0;i--){if(!t){n.push(r("deactivate",this,this.containers[i]))}if(this.containers[i].containerCache.over){n.push(r("out",this,this.containers[i]));this.containers[i].containerCache.over=0}}if(this.storedCursor){this.document.find("body").css("cursor",this.storedCursor);this.storedStylesheet.remove()}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex)}this.dragging=false;if(!t){this._trigger("beforeStop",e,this._uiHash())}this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(!this.cancelHelperRemoval){if(this.helper[0]!==this.currentItem[0]){this.helper.remove()}this.helper=null}if(!t){for(i=0;i<n.length;i++){n[i].call(this,e)}this._trigger("stop",e,this._uiHash())}this.fromOutside=false;return!this.cancelHelperRemoval},_trigger:function(){if(te.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel()}},_uiHash:function(e){var t=e||this;return{helper:t.helper,placeholder:t.placeholder||te([]),position:t.position,originalPosition:t.originalPosition,offset:t.positionAbs,item:t.currentItem,sender:e?e.element:null}}});function I(t){return function(){var e=this.element.val();t.apply(this,arguments);this._refresh();if(e!==this.element.val()){this._trigger("change")}}}te.widget("ui.spinner",{version:"1.13.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:true,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);this._setOption("min",this.options.min);this._setOption("step",this.options.step);if(this.value()!==""){this._value(this.element.val(),true)}this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var n=this._super();var r=this.element;te.each(["min","max","step"],function(e,t){var i=r.attr(t);if(i!=null&&i.length){n[t]=i}});return n},_events:{keydown:function(e){if(this._start(e)&&this._keydown(e)){e.preventDefault()}},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){if(this.cancelBlur){delete this.cancelBlur;return}this._stop();this._refresh();if(this.previous!==this.element.val()){this._trigger("change",e)}},mousewheel:function(e,t){var i=te.ui.safeActiveElement(this.document[0]);var n=this.element[0]===i;if(!n||!t){return}if(!this.spinning&&!this._start(e)){return false}this._spin((t>0?1:-1)*this.options.step,e);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){if(this.spinning){this._stop(e)}},100);e.preventDefault()},"mousedown .ui-spinner-button":function(e){var t;t=this.element[0]===te.ui.safeActiveElement(this.document[0])?this.previous:this.element.val();function i(){var e=this.element[0]===te.ui.safeActiveElement(this.document[0]);if(!e){this.element.trigger("focus");this.previous=t;this._delay(function(){this.previous=t})}}e.preventDefault();i.call(this);this.cancelBlur=true;this._delay(function(){delete this.cancelBlur;i.call(this)});if(this._start(e)===false){return}this._repeat(null,te(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){if(!te(e.currentTarget).hasClass("ui-state-active")){return}if(this._start(e)===false){return false}this._repeat(null,te(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance();this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content");this._addClass("ui-spinner-input");this.element.attr("role","spinbutton");this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",true).button({classes:{"ui-button":""}});this._removeClass(this.buttons,"ui-corner-all");this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up");this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down");this.buttons.first().button({icon:this.options.icons.up,showLabel:false});this.buttons.last().button({icon:this.options.icons.down,showLabel:false});if(this.buttons.height()>Math.ceil(this.uiSpinner.height()*.5)&&this.uiSpinner.height()>0){this.uiSpinner.height(this.uiSpinner.height())}},_keydown:function(e){var t=this.options,i=te.ui.keyCode;switch(e.keyCode){case i.UP:this._repeat(null,1,e);return true;case i.DOWN:this._repeat(null,-1,e);return true;case i.PAGE_UP:this._repeat(null,t.page,e);return true;case i.PAGE_DOWN:this._repeat(null,-t.page,e);return true}return false},_start:function(e){if(!this.spinning&&this._trigger("start",e)===false){return false}if(!this.counter){this.counter=1}this.spinning=true;return true},_repeat:function(e,t,i){e=e||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,t,i)},e);this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;if(!this.counter){this.counter=1}i=this._adjustValue(i+e*this._increment(this.counter));if(!this.spinning||this._trigger("spin",t,{value:i})!==false){this._value(i);this.counter++}},_increment:function(e){var t=this.options.incremental;if(t){return typeof t==="function"?t(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1)}return 1},_precision:function(){var e=this._precisionOf(this.options.step);if(this.options.min!==null){e=Math.max(e,this._precisionOf(this.options.min))}return e},_precisionOf:function(e){var t=e.toString(),i=t.indexOf(".");return i===-1?0:t.length-i-1},_adjustValue:function(e){var t,i,n=this.options;t=n.min!==null?n.min:0;i=e-t;i=Math.round(i/n.step)*n.step;e=t+i;e=parseFloat(e.toFixed(this._precision()));if(n.max!==null&&e>n.max){return n.max}if(n.min!==null&&e<n.min){return n.min}return e},_stop:function(e){if(!this.spinning){return}clearTimeout(this.timer);clearTimeout(this.mousewheelTimer);this.counter=0;this.spinning=false;this._trigger("stop",e)},_setOption:function(e,t){var i,n,r;if(e==="culture"||e==="numberFormat"){i=this._parse(this.element.val());this.options[e]=t;this.element.val(this._format(i));return}if(e==="max"||e==="min"||e==="step"){if(typeof t==="string"){t=this._parse(t)}}if(e==="icons"){n=this.buttons.first().find(".ui-icon");this._removeClass(n,null,this.options.icons.up);this._addClass(n,null,t.up);r=this.buttons.last().find(".ui-icon");this._removeClass(r,null,this.options.icons.down);this._addClass(r,null,t.down)}this._super(e,t)},_setOptionDisabled:function(e){this._super(e);this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!e);this.element.prop("disabled",!!e);this.buttons.button(e?"disable":"enable")},_setOptions:I(function(e){this._super(e)}),_parse:function(e){if(typeof e==="string"&&e!==""){e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e}return e===""||isNaN(e)?null:e},_format:function(e){if(e===""){return""}return window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();if(e===null){return false}return e===this._adjustValue(e)},_value:function(e,t){var i;if(e!==""){i=this._parse(e);if(i!==null){if(!t){i=this._adjustValue(i)}e=this._format(i)}}this.element.val(e);this._refresh()},_destroy:function(){this.element.prop("disabled",false).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow");this.uiSpinner.replaceWith(this.element)},stepUp:I(function(e){this._stepUp(e)}),_stepUp:function(e){if(this._start()){this._spin((e||1)*this.options.step);this._stop()}},stepDown:I(function(e){this._stepDown(e)}),_stepDown:function(e){if(this._start()){this._spin((e||1)*-this.options.step);this._stop()}},pageUp:I(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:I(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){if(!arguments.length){return this._parse(this.element.val())}I(this._value).call(this,e)},widget:function(){return this.uiSpinner}});if(te.uiBackCompat!==false){te.widget("ui.spinner",te.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}})}var Oe=te.ui.spinner;te.widget("ui.tabs",{version:"1.13.1",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:false,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var n=/#.*$/;return function(e){var t,i;t=e.href.replace(n,"");i=location.href.replace(n,"");try{t=decodeURIComponent(t)}catch(e){}try{i=decodeURIComponent(i)}catch(e){}return e.hash.length>1&&t===i}}(),_create:function(){var t=this,e=this.options;this.running=false;this._addClass("ui-tabs","ui-widget ui-widget-content");this._toggleClass("ui-tabs-collapsible",null,e.collapsible);this._processTabs();e.active=this._initialActive();if(Array.isArray(e.disabled)){e.disabled=te.uniqueSort(e.disabled.concat(te.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()}if(this.options.active!==false&&this.anchors.length){this.active=this._findActive(e.active)}else{this.active=te()}this._refresh();if(this.active.length){this.load(e.active)}},_initialActive:function(){var i=this.options.active,e=this.options.collapsible,n=location.hash.substring(1);if(i===null){if(n){this.tabs.each(function(e,t){if(te(t).attr("aria-controls")===n){i=e;return false}})}if(i===null){i=this.tabs.index(this.tabs.filter(".ui-tabs-active"))}if(i===null||i===-1){i=this.tabs.length?0:false}}if(i!==false){i=this.tabs.index(this.tabs.eq(i));if(i===-1){i=e?false:0}}if(!e&&i===false&&this.anchors.length){i=0}return i},_getCreateEventData:function(){return{tab:this.active,panel:!this.active.length?te():this._getPanelForTab(this.active)}},_tabKeydown:function(e){var t=te(te.ui.safeActiveElement(this.document[0])).closest("li"),i=this.tabs.index(t),n=true;if(this._handlePageNav(e)){return}switch(e.keyCode){case te.ui.keyCode.RIGHT:case te.ui.keyCode.DOWN:i++;break;case te.ui.keyCode.UP:case te.ui.keyCode.LEFT:n=false;i--;break;case te.ui.keyCode.END:i=this.anchors.length-1;break;case te.ui.keyCode.HOME:i=0;break;case te.ui.keyCode.SPACE:e.preventDefault();clearTimeout(this.activating);this._activate(i);return;case te.ui.keyCode.ENTER:e.preventDefault();clearTimeout(this.activating);this._activate(i===this.options.active?false:i);return;default:return}e.preventDefault();clearTimeout(this.activating);i=this._focusNextTab(i,n);if(!e.ctrlKey&&!e.metaKey){t.attr("aria-selected","false");this.tabs.eq(i).attr("aria-selected","true");this.activating=this._delay(function(){this.option("active",i)},this.delay)}},_panelKeydown:function(e){if(this._handlePageNav(e)){return}if(e.ctrlKey&&e.keyCode===te.ui.keyCode.UP){e.preventDefault();this.active.trigger("focus")}},_handlePageNav:function(e){if(e.altKey&&e.keyCode===te.ui.keyCode.PAGE_UP){this._activate(this._focusNextTab(this.options.active-1,false));return true}if(e.altKey&&e.keyCode===te.ui.keyCode.PAGE_DOWN){this._activate(this._focusNextTab(this.options.active+1,true));return true}},_findNextTab:function(e,t){var i=this.tabs.length-1;function n(){if(e>i){e=0}if(e<0){e=i}return e}while(te.inArray(n(),this.options.disabled)!==-1){e=t?e+1:e-1}return e},_focusNextTab:function(e,t){e=this._findNextTab(e,t);this.tabs.eq(e).trigger("focus");return e},_setOption:function(e,t){if(e==="active"){this._activate(t);return}this._super(e,t);if(e==="collapsible"){this._toggleClass("ui-tabs-collapsible",null,t);if(!t&&this.options.active===false){this._activate(0)}}if(e==="event"){this._setupEvents(t)}if(e==="heightStyle"){this._setupHeightStyle(t)}},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,t=this.tablist.children(":has(a[href])");e.disabled=te.map(t.filter(".ui-state-disabled"),function(e){return t.index(e)});this._processTabs();if(e.active===false||!this.anchors.length){e.active=false;this.active=te()}else if(this.active.length&&!te.contains(this.tablist[0],this.active[0])){if(this.tabs.length===e.disabled.length){e.active=false;this.active=te()}else{this._activate(this._findNextTab(Math.max(0,e.active-1),false))}}else{e.active=this.tabs.index(this.active)}this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"});if(!this.active.length){this.tabs.eq(0).attr("tabIndex",0)}else{this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0});this._addClass(this.active,"ui-tabs-active","ui-state-active");this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})}},_processTabs:function(){var l=this,e=this.tabs,t=this.anchors,i=this.panels;this.tablist=this._getList().attr("role","tablist");this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header");this.tablist.on("mousedown"+this.eventNamespace,"> li",function(e){if(te(this).is(".ui-state-disabled")){e.preventDefault()}}).on("focus"+this.eventNamespace,".ui-tabs-anchor",function(){if(te(this).closest("li").is(".ui-state-disabled")){this.blur()}});this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1});this._addClass(this.tabs,"ui-tabs-tab","ui-state-default");this.anchors=this.tabs.map(function(){return te("a",this)[0]}).attr({tabIndex:-1});this._addClass(this.anchors,"ui-tabs-anchor");this.panels=te();this.anchors.each(function(e,t){var i,n,r,o=te(t).uniqueId().attr("id"),s=te(t).closest("li"),a=s.attr("aria-controls");if(l._isLocal(t)){i=t.hash;r=i.substring(1);n=l.element.find(l._sanitizeSelector(i))}else{r=s.attr("aria-controls")||te({}).uniqueId()[0].id;i="#"+r;n=l.element.find(i);if(!n.length){n=l._createPanel(r);n.insertAfter(l.panels[e-1]||l.tablist)}n.attr("aria-live","polite")}if(n.length){l.panels=l.panels.add(n)}if(a){s.data("ui-tabs-aria-controls",a)}s.attr({"aria-controls":r,"aria-labelledby":o});n.attr("aria-labelledby",o)});this.panels.attr("role","tabpanel");this._addClass(this.panels,"ui-tabs-panel","ui-widget-content");if(e){this._off(e.not(this.tabs));this._off(t.not(this.anchors));this._off(i.not(this.panels))}},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(e){return te("<div>").attr("id",e).data("ui-tabs-destroy",true)},_setOptionDisabled:function(e){var t,i,n;if(Array.isArray(e)){if(!e.length){e=false}else if(e.length===this.anchors.length){e=true}}for(n=0;i=this.tabs[n];n++){t=te(i);if(e===true||te.inArray(n,e)!==-1){t.attr("aria-disabled","true");this._addClass(t,null,"ui-state-disabled")}else{t.removeAttr("aria-disabled");this._removeClass(t,null,"ui-state-disabled")}}this.options.disabled=e;this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,e===true)},_setupEvents:function(e){var i={};if(e){te.each(e.split(" "),function(e,t){i[t]="_eventHandler"})}this._off(this.anchors.add(this.tabs).add(this.panels));this._on(true,this.anchors,{click:function(e){e.preventDefault()}});this._on(this.anchors,i);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,t=this.element.parent();if(e==="fill"){i=t.height();i-=this.element.outerHeight()-this.element.height();this.element.siblings(":visible").each(function(){var e=te(this),t=e.css("position");if(t==="absolute"||t==="fixed"){return}i-=e.outerHeight(true)});this.element.children().not(this.panels).each(function(){i-=te(this).outerHeight(true)});this.panels.each(function(){te(this).height(Math.max(0,i-te(this).innerHeight()+te(this).height()))}).css("overflow","auto")}else if(e==="auto"){i=0;this.panels.each(function(){i=Math.max(i,te(this).height("").height())}).height(i)}},_eventHandler:function(e){var t=this.options,i=this.active,n=te(e.currentTarget),r=n.closest("li"),o=r[0]===i[0],s=o&&t.collapsible,a=s?te():this._getPanelForTab(r),l=!i.length?te():this._getPanelForTab(i),c={oldTab:i,oldPanel:l,newTab:s?te():r,newPanel:a};e.preventDefault();if(r.hasClass("ui-state-disabled")||r.hasClass("ui-tabs-loading")||this.running||o&&!t.collapsible||this._trigger("beforeActivate",e,c)===false){return}t.active=s?false:this.tabs.index(r);this.active=o?te():r;if(this.xhr){this.xhr.abort()}if(!l.length&&!a.length){te.error("jQuery UI Tabs: Mismatching fragment identifier.")}if(a.length){this.load(this.tabs.index(r),e)}this._toggle(e,c)},_toggle:function(e,t){var i=this,n=t.newPanel,r=t.oldPanel;this.running=true;function o(){i.running=false;i._trigger("activate",e,t)}function s(){i._addClass(t.newTab.closest("li"),"ui-tabs-active","ui-state-active");if(n.length&&i.options.show){i._show(n,i.options.show,o)}else{n.show();o()}}if(r.length&&this.options.hide){this._hide(r,this.options.hide,function(){i._removeClass(t.oldTab.closest("li"),"ui-tabs-active","ui-state-active");s()})}else{this._removeClass(t.oldTab.closest("li"),"ui-tabs-active","ui-state-active");r.hide();s()}r.attr("aria-hidden","true");t.oldTab.attr({"aria-selected":"false","aria-expanded":"false"});if(n.length&&r.length){t.oldTab.attr("tabIndex",-1)}else if(n.length){this.tabs.filter(function(){return te(this).attr("tabIndex")===0}).attr("tabIndex",-1)}n.attr("aria-hidden","false");t.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(e){var t,i=this._findActive(e);if(i[0]===this.active[0]){return}if(!i.length){i=this.active}t=i.find(".ui-tabs-anchor")[0];this._eventHandler({target:t,currentTarget:t,preventDefault:te.noop})},_findActive:function(e){return e===false?te():this.tabs.eq(e)},_getIndex:function(e){if(typeof e==="string"){e=this.anchors.index(this.anchors.filter("[href$='"+te.escapeSelector(e)+"']"))}return e},_destroy:function(){if(this.xhr){this.xhr.abort()}this.tablist.removeAttr("role").off(this.eventNamespace);this.anchors.removeAttr("role tabIndex").removeUniqueId();this.tabs.add(this.panels).each(function(){if(te.data(this,"ui-tabs-destroy")){te(this).remove()}else{te(this).removeAttr("role tabIndex "+"aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")}});this.tabs.each(function(){var e=te(this),t=e.data("ui-tabs-aria-controls");if(t){e.attr("aria-controls",t).removeData("ui-tabs-aria-controls")}else{e.removeAttr("aria-controls")}});this.panels.show();if(this.options.heightStyle!=="content"){this.panels.css("height","")}},enable:function(i){var e=this.options.disabled;if(e===false){return}if(i===undefined){e=false}else{i=this._getIndex(i);if(Array.isArray(e)){e=te.map(e,function(e){return e!==i?e:null})}else{e=te.map(this.tabs,function(e,t){return t!==i?t:null})}}this._setOptionDisabled(e)},disable:function(e){var t=this.options.disabled;if(t===true){return}if(e===undefined){t=true}else{e=this._getIndex(e);if(te.inArray(e,t)!==-1){return}if(Array.isArray(t)){t=te.merge([e],t).sort()}else{t=[e]}}this._setOptionDisabled(t)},load:function(e,n){e=this._getIndex(e);var r=this,i=this.tabs.eq(e),t=i.find(".ui-tabs-anchor"),o=this._getPanelForTab(i),s={tab:i,panel:o},a=function(e,t){if(t==="abort"){r.panels.stop(false,true)}r._removeClass(i,"ui-tabs-loading");o.removeAttr("aria-busy");if(e===r.xhr){delete r.xhr}};if(this._isLocal(t[0])){return}this.xhr=te.ajax(this._ajaxSettings(t,n,s));if(this.xhr&&this.xhr.statusText!=="canceled"){this._addClass(i,"ui-tabs-loading");o.attr("aria-busy","true");this.xhr.done(function(e,t,i){setTimeout(function(){o.html(e);r._trigger("load",n,s);a(i,t)},1)}).fail(function(e,t){setTimeout(function(){a(e,t)},1)})}},_ajaxSettings:function(e,i,n){var r=this;return{url:e.attr("href").replace(/#.*$/,""),beforeSend:function(e,t){return r._trigger("beforeLoad",i,te.extend({jqXHR:e,ajaxSettings:t},n))}}},_getPanelForTab:function(e){var t=te(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+t))}});if(te.uiBackCompat!==false){te.widget("ui.tabs",te.ui.tabs,{_processTabs:function(){this._superApply(arguments);this._addClass(this.tabs,"ui-tab")}})}var Ne=te.ui.tabs;te.widget("ui.tooltip",{version:"1.13.1",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var e=te(this).attr("title");return te("<a>").text(e).html()},hide:true,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:true,track:false,close:null,open:null},_addDescribedBy:function(e,t){var i=(e.attr("aria-describedby")||"").split(/\s+/);i.push(t);e.data("ui-tooltip-id",t).attr("aria-describedby",String.prototype.trim.call(i.join(" ")))},_removeDescribedBy:function(e){var t=e.data("ui-tooltip-id"),i=(e.attr("aria-describedby")||"").split(/\s+/),n=te.inArray(t,i);if(n!==-1){i.splice(n,1)}e.removeData("ui-tooltip-id");i=String.prototype.trim.call(i.join(" "));if(i){e.attr("aria-describedby",i)}else{e.removeAttr("aria-describedby")}},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={};this.parents={};this.liveRegion=te("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body);this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible");this.disabledTitles=te([])},_setOption:function(e,t){var i=this;this._super(e,t);if(e==="content"){te.each(this.tooltips,function(e,t){i._updateContent(t.element)})}},_setOptionDisabled:function(e){this[e?"_disable":"_enable"]()},_disable:function(){var n=this;te.each(this.tooltips,function(e,t){var i=te.Event("blur");i.target=i.currentTarget=t.element[0];n.close(i,true)});this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function(){var e=te(this);if(e.is("[title]")){return e.data("ui-tooltip-title",e.attr("title")).removeAttr("title")}}))},_enable:function(){this.disabledTitles.each(function(){var e=te(this);if(e.data("ui-tooltip-title")){e.attr("title",e.data("ui-tooltip-title"))}});this.disabledTitles=te([])},open:function(e){var i=this,t=te(e?e.target:this.element).closest(this.options.items);if(!t.length||t.data("ui-tooltip-id")){return}if(t.attr("title")){t.data("ui-tooltip-title",t.attr("title"))}t.data("ui-tooltip-open",true);if(e&&e.type==="mouseover"){t.parents().each(function(){var e=te(this),t;if(e.data("ui-tooltip-open")){t=te.Event("blur");t.target=t.currentTarget=this;i.close(t,true)}if(e.attr("title")){e.uniqueId();i.parents[this.id]={element:this,title:e.attr("title")};e.attr("title","")}})}this._registerCloseHandlers(e,t);this._updateContent(t,e)},_updateContent:function(t,i){var e,n=this.options.content,r=this,o=i?i.type:null;if(typeof n==="string"||n.nodeType||n.jquery){return this._open(i,t,n)}e=n.call(t[0],function(e){r._delay(function(){if(!t.data("ui-tooltip-open")){return}if(i){i.type=o}this._open(i,t,e)})});if(e){this._open(i,t,e)}},_open:function(e,t,i){var n,r,o,s,a=te.extend({},this.options.position);if(!i){return}n=this._find(t);if(n){n.tooltip.find(".ui-tooltip-content").html(i);return}if(t.is("[title]")){if(e&&e.type==="mouseover"){t.attr("title","")}else{t.removeAttr("title")}}n=this._tooltip(t);r=n.tooltip;this._addDescribedBy(t,r.attr("id"));r.find(".ui-tooltip-content").html(i);this.liveRegion.children().hide();s=te("<div>").html(r.find(".ui-tooltip-content").html());s.removeAttr("name").find("[name]").removeAttr("name");s.removeAttr("id").find("[id]").removeAttr("id");s.appendTo(this.liveRegion);function l(e){a.of=e;if(r.is(":hidden")){return}r.position(a)}if(this.options.track&&e&&/^mouse/.test(e.type)){this._on(this.document,{mousemove:l});l(e)}else{r.position(te.extend({of:t},this.options.position))}r.hide();this._show(r,this.options.show);if(this.options.track&&this.options.show&&this.options.show.delay){o=this.delayedShow=setInterval(function(){if(r.is(":visible")){l(a.of);clearInterval(o)}},13)}this._trigger("open",e,{tooltip:r})},_registerCloseHandlers:function(e,i){var t={keyup:function(e){if(e.keyCode===te.ui.keyCode.ESCAPE){var t=te.Event(e);t.currentTarget=i[0];this.close(t,true)}}};if(i[0]!==this.element[0]){t.remove=function(){var e=this._find(i);if(e){this._removeTooltip(e.tooltip)}}}if(!e||e.type==="mouseover"){t.mouseleave="close"}if(!e||e.type==="focusin"){t.focusout="close"}this._on(true,i,t)},close:function(e){var t,i=this,n=te(e?e.currentTarget:this.element),r=this._find(n);if(!r){n.removeData("ui-tooltip-open");return}t=r.tooltip;if(r.closing){return}clearInterval(this.delayedShow);if(n.data("ui-tooltip-title")&&!n.attr("title")){n.attr("title",n.data("ui-tooltip-title"))}this._removeDescribedBy(n);r.hiding=true;t.stop(true);this._hide(t,this.options.hide,function(){i._removeTooltip(te(this))});n.removeData("ui-tooltip-open");this._off(n,"mouseleave focusout keyup");if(n[0]!==this.element[0]){this._off(n,"remove")}this._off(this.document,"mousemove");if(e&&e.type==="mouseleave"){te.each(this.parents,function(e,t){te(t.element).attr("title",t.title);delete i.parents[e]})}r.closing=true;this._trigger("close",e,{tooltip:t});if(!r.hiding){r.closing=false}},_tooltip:function(e){var t=te("<div>").attr("role","tooltip"),i=te("<div>").appendTo(t),n=t.uniqueId().attr("id");this._addClass(i,"ui-tooltip-content");this._addClass(t,"ui-tooltip","ui-widget ui-widget-content");t.appendTo(this._appendTo(e));return this.tooltips[n]={element:e,tooltip:t}},_find:function(e){var t=e.data("ui-tooltip-id");return t?this.tooltips[t]:null},_removeTooltip:function(e){clearInterval(this.delayedShow);e.remove();delete this.tooltips[e.attr("id")]},_appendTo:function(e){var t=e.closest(".ui-front, dialog");if(!t.length){t=this.document[0].body}return t},_destroy:function(){var r=this;te.each(this.tooltips,function(e,t){var i=te.Event("blur"),n=t.element;i.target=i.currentTarget=n[0];r.close(i,true);te("#"+e).remove();if(n.data("ui-tooltip-title")){if(!n.attr("title")){n.attr("title",n.data("ui-tooltip-title"))}n.removeData("ui-tooltip-title")}});this.liveRegion.remove()}});if(te.uiBackCompat!==false){te.widget("ui.tooltip",te.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var e=this._superApply(arguments);if(this.options.tooltipClass){e.tooltip.addClass(this.options.tooltipClass)}return e}})}var Ie=te.ui.tooltip});(function(){var au;var Hu="4.17.21";var Bu=200;var Vu="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",lu="Expected a function",ju="Invalid `variable` option passed into `_.template`";var zu="__lodash_hash_undefined__";var Wu=500;var Uu="__lodash_placeholder__";var cu=1,Yu=2,uu=4;var du=1,qu=2;var hu=1,fu=2,Ku=4,pu=8,gu=16,mu=32,vu=64,yu=128,Xu=256,Zu=512;var Qu=30,Ju="...";var ed=800,td=16;var id=1,nd=2,rd=3;var bu=1/0,_u=9007199254740991,od=17976931348623157e292,sd=0/0;var wu=4294967295,ad=wu-1,ld=wu>>>1;var cd=[["ary",yu],["bind",hu],["bindKey",fu],["curry",pu],["curryRight",gu],["flip",Zu],["partial",mu],["partialRight",vu],["rearg",Xu]];var Cu="[object Arguments]",ud="[object Array]",dd="[object AsyncFunction]",hd="[object Boolean]",fd="[object Date]",pd="[object DOMException]",gd="[object Error]",md="[object Function]",vd="[object GeneratorFunction]",xu="[object Map]",yd="[object Number]",bd="[object Null]",Su="[object Object]",_d="[object Promise]",wd="[object Proxy]",Cd="[object RegExp]",Au="[object Set]",xd="[object String]",Sd="[object Symbol]",Ad="[object Undefined]",Ed="[object WeakMap]",Td="[object WeakSet]";var Dd="[object ArrayBuffer]",Eu="[object DataView]",Rd="[object Float32Array]",Md="[object Float64Array]",kd="[object Int8Array]",Od="[object Int16Array]",Nd="[object Int32Array]",Id="[object Uint8Array]",Ld="[object Uint8ClampedArray]",Pd="[object Uint16Array]",Fd="[object Uint32Array]";var Gd=/\b__p \+= '';/g,$d=/\b(__p \+=) '' \+/g,Hd=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var Bd=/&(?:amp|lt|gt|quot|#39);/g,Vd=/[&<>"']/g,jd=RegExp(Bd.source),zd=RegExp(Vd.source);var Wd=/<%-([\s\S]+?)%>/g,Ud=/<%([\s\S]+?)%>/g,Yd=/<%=([\s\S]+?)%>/g;var qd=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Kd=/^\w*$/,Xd=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var Zd=/[\\^$.*+?()[\]{}|]/g,Qd=RegExp(Zd.source);var Jd=/^\s+/;var n=/\s/;var eh=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,th=/\{\n\/\* \[wrapped with (.+)\] \*/,ih=/,? & /;var r=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var nh=/[()=,{}\[\]\/\s]/;var rh=/\\(\\)?/g;var oh=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var sh=/\w*$/;var ah=/^[-+]0x[0-9a-f]+$/i;var lh=/^0b[01]+$/i;var ch=/^\[object .+?Constructor\]$/;var uh=/^0o[0-7]+$/i;var dh=/^(?:0|[1-9]\d*)$/;var hh=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g;var fh=/($^)/;var ph=/['\n\r\u2028\u2029\\]/g;var o="\\ud800-\\udfff",s="\\u0300-\\u036f",a="\\ufe20-\\ufe2f",l="\\u20d0-\\u20ff",c=s+a+l,u="\\u2700-\\u27bf",d="a-z\\xdf-\\xf6\\xf8-\\xff",h="\\xac\\xb1\\xd7\\xf7",f="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",p="\\u2000-\\u206f",g=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",m="A-Z\\xc0-\\xd6\\xd8-\\xde",v="\\ufe0e\\ufe0f",y=h+f+p+g;var b="['‚Äô]",_="["+o+"]",w="["+y+"]",C="["+c+"]",x="\\d+",S="["+u+"]",A="["+d+"]",E="[^"+o+y+x+u+d+m+"]",T="\\ud83c[\\udffb-\\udfff]",D="(?:"+C+"|"+T+")",R="[^"+o+"]",M="(?:\\ud83c[\\udde6-\\uddff]){2}",k="[\\ud800-\\udbff][\\udc00-\\udfff]",e="["+m+"]",O="\\u200d";var N="(?:"+A+"|"+E+")",I="(?:"+e+"|"+E+")",L="(?:"+b+"(?:d|ll|m|re|s|t|ve))?",P="(?:"+b+"(?:D|LL|M|RE|S|T|VE))?",F=D+"?",G="["+v+"]?",$="(?:"+O+"(?:"+[R,M,k].join("|")+")"+G+F+")*",H="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",B="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",V=G+F+$,j="(?:"+[S,M,k].join("|")+")"+V,z="(?:"+[R+C+"?",C,M,k,_].join("|")+")";var gh=RegExp(b,"g");var mh=RegExp(C,"g");var W=RegExp(T+"(?="+T+")|"+z+V,"g");var U=RegExp([e+"?"+A+"+"+L+"(?="+[w,e,"$"].join("|")+")",I+"+"+P+"(?="+[w,e+N,"$"].join("|")+")",e+"?"+N+"+"+L,e+"+"+P,B,H,x,j].join("|"),"g");var Y=RegExp("["+O+o+c+v+"]");var q=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var vh=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"];var yh=-1;var Tu={};Tu[Rd]=Tu[Md]=Tu[kd]=Tu[Od]=Tu[Nd]=Tu[Id]=Tu[Ld]=Tu[Pd]=Tu[Fd]=true;Tu[Cu]=Tu[ud]=Tu[Dd]=Tu[hd]=Tu[Eu]=Tu[fd]=Tu[gd]=Tu[md]=Tu[xu]=Tu[yd]=Tu[Su]=Tu[Cd]=Tu[Au]=Tu[xd]=Tu[Ed]=false;var Du={};Du[Cu]=Du[ud]=Du[Dd]=Du[Eu]=Du[hd]=Du[fd]=Du[Rd]=Du[Md]=Du[kd]=Du[Od]=Du[Nd]=Du[xu]=Du[yd]=Du[Su]=Du[Cd]=Du[Au]=Du[xd]=Du[Sd]=Du[Id]=Du[Ld]=Du[Pd]=Du[Fd]=true;Du[gd]=Du[md]=Du[Ed]=false;var K={"√Ä":"A","√Å":"A","√Ç":"A","√É":"A","√Ñ":"A","√Ö":"A","√†":"a","√°":"a","√¢":"a","√£":"a","√§":"a","√•":"a","√á":"C","√ß":"c","√ê":"D","√∞":"d","√à":"E","√â":"E","√ä":"E","√ã":"E","√®":"e","√©":"e","√™":"e","√´":"e","√å":"I","√ç":"I","√é":"I","√è":"I","√¨":"i","√≠":"i","√Æ":"i","√Ø":"i","√ë":"N","√±":"n","√í":"O","√ì":"O","√î":"O","√ï":"O","√ñ":"O","√ò":"O","√≤":"o","√≥":"o","√¥":"o","√µ":"o","√∂":"o","√∏":"o","√ô":"U","√ö":"U","√õ":"U","√ú":"U","√π":"u","√∫":"u","√ª":"u","√º":"u","√ù":"Y","√Ω":"y","√ø":"y","√Ü":"Ae","√¶":"ae","√û":"Th","√æ":"th","√ü":"ss","ƒÄ":"A","ƒÇ":"A","ƒÑ":"A","ƒÅ":"a","ƒÉ":"a","ƒÖ":"a","ƒÜ":"C","ƒà":"C","ƒä":"C","ƒå":"C","ƒá":"c","ƒâ":"c","ƒã":"c","ƒç":"c","ƒé":"D","ƒê":"D","ƒè":"d","ƒë":"d","ƒí":"E","ƒî":"E","ƒñ":"E","ƒò":"E","ƒö":"E","ƒì":"e","ƒï":"e","ƒó":"e","ƒô":"e","ƒõ":"e","ƒú":"G","ƒû":"G","ƒ†":"G","ƒ¢":"G","ƒù":"g","ƒü":"g","ƒ°":"g","ƒ£":"g","ƒ§":"H","ƒ¶":"H","ƒ•":"h","ƒß":"h","ƒ®":"I","ƒ™":"I","ƒ¨":"I","ƒÆ":"I","ƒ∞":"I","ƒ©":"i","ƒ´":"i","ƒ≠":"i","ƒØ":"i","ƒ±":"i","ƒ¥":"J","ƒµ":"j","ƒ∂":"K","ƒ∑":"k","ƒ∏":"k","ƒπ":"L","ƒª":"L","ƒΩ":"L","ƒø":"L","≈Å":"L","ƒ∫":"l","ƒº":"l","ƒæ":"l","≈Ä":"l","≈Ç":"l","≈É":"N","≈Ö":"N","≈á":"N","≈ä":"N","≈Ñ":"n","≈Ü":"n","≈à":"n","≈ã":"n","≈å":"O","≈é":"O","≈ê":"O","≈ç":"o","≈è":"o","≈ë":"o","≈î":"R","≈ñ":"R","≈ò":"R","≈ï":"r","≈ó":"r","≈ô":"r","≈ö":"S","≈ú":"S","≈û":"S","≈†":"S","≈õ":"s","≈ù":"s","≈ü":"s","≈°":"s","≈¢":"T","≈§":"T","≈¶":"T","≈£":"t","≈•":"t","≈ß":"t","≈®":"U","≈™":"U","≈¨":"U","≈Æ":"U","≈∞":"U","≈≤":"U","≈©":"u","≈´":"u","≈≠":"u","≈Ø":"u","≈±":"u","≈≥":"u","≈¥":"W","≈µ":"w","≈∂":"Y","≈∑":"y","≈∏":"Y","≈π":"Z","≈ª":"Z","≈Ω":"Z","≈∫":"z","≈º":"z","≈æ":"z","ƒ≤":"IJ","ƒ≥":"ij","≈í":"Oe","≈ì":"oe","≈â":"'n","≈ø":"s"};var X={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};var Z={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};var Q={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};var bh=parseFloat,_h=parseInt;var J=typeof global=="object"&&global&&global.Object===Object&&global;var ee=typeof self=="object"&&self&&self.Object===Object&&self;var Ru=J||ee||Function("return this")();var te=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var t=te&&typeof module=="object"&&module&&!module.nodeType&&module;var wh=t&&t.exports===te;var ie=wh&&J.process;var i=function(){try{var e=t&&t.require&&t.require("util").types;if(e){return e}return ie&&ie.binding&&ie.binding("util")}catch(e){}}();var Ch=i&&i.isArrayBuffer,xh=i&&i.isDate,Sh=i&&i.isMap,Ah=i&&i.isRegExp,Eh=i&&i.isSet,Th=i&&i.isTypedArray;function Mu(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function Dh(e,t,i,n){var r=-1,o=e==null?0:e.length;while(++r<o){var s=e[r];t(n,s,i(s),e)}return n}function ku(e,t){var i=-1,n=e==null?0:e.length;while(++i<n){if(t(e[i],i,e)===false){break}}return e}function Rh(e,t){var i=e==null?0:e.length;while(i--){if(t(e[i],i,e)===false){break}}return e}function Mh(e,t){var i=-1,n=e==null?0:e.length;while(++i<n){if(!t(e[i],i,e)){return false}}return true}function Ou(e,t){var i=-1,n=e==null?0:e.length,r=0,o=[];while(++i<n){var s=e[i];if(t(s,i,e)){o[r++]=s}}return o}function kh(e,t){var i=e==null?0:e.length;return!!i&&Lu(e,t,0)>-1}function Oh(e,t,i){var n=-1,r=e==null?0:e.length;while(++n<r){if(i(t,e[n])){return true}}return false}function Nu(e,t){var i=-1,n=e==null?0:e.length,r=Array(n);while(++i<n){r[i]=t(e[i],i,e)}return r}function Iu(e,t){var i=-1,n=t.length,r=e.length;while(++i<n){e[r+i]=t[i]}return e}function Nh(e,t,i,n){var r=-1,o=e==null?0:e.length;if(n&&o){i=e[++r]}while(++r<o){i=t(i,e[r],r,e)}return i}function Ih(e,t,i,n){var r=e==null?0:e.length;if(n&&r){i=e[--r]}while(r--){i=t(i,e[r],r,e)}return i}function Lh(e,t){var i=-1,n=e==null?0:e.length;while(++i<n){if(t(e[i],i,e)){return true}}return false}var ne=Vh("length");function re(e){return e.split("")}function Ph(e){return e.match(r)||[]}function Fh(e,n,t){var r;t(e,function(e,t,i){if(n(e,t,i)){r=t;return false}});return r}function Gh(e,t,i,n){var r=e.length,o=i+(n?1:-1);while(n?o--:++o<r){if(t(e[o],o,e)){return o}}return-1}function Lu(e,t,i){return t===t?se(e,t,i):Gh(e,Hh,i)}function $h(e,t,i,n){var r=i-1,o=e.length;while(++r<o){if(n(e[r],t)){return r}}return-1}function Hh(e){return e!==e}function Bh(e,t){var i=e==null?0:e.length;return i?Wh(e,t)/i:sd}function Vh(t){return function(e){return e==null?au:e[t]}}function oe(t){return function(e){return t==null?au:t[e]}}function jh(e,n,r,o,t){t(e,function(e,t,i){r=o?(o=false,e):n(r,e,t,i)});return r}function zh(e,t){var i=e.length;e.sort(t);while(i--){e[i]=e[i].value}return e}function Wh(e,t){var i,n=-1,r=e.length;while(++n<r){var o=t(e[n]);if(o!==au){i=i===au?o:i+o}}return i}function Uh(e,t){var i=-1,n=Array(e);while(++i<e){n[i]=t(i)}return n}function Yh(t,e){return Nu(e,function(e){return[e,t[e]]})}function qh(e){return e?e.slice(0,pf(e)+1).replace(Jd,""):e}function Pu(t){return function(e){return t(e)}}function Kh(t,e){return Nu(e,function(e){return t[e]})}function Xh(e,t){return e.has(t)}function Zh(e,t){var i=-1,n=e.length;while(++i<n&&Lu(t,e[i],0)>-1){}return i}function Qh(e,t){var i=e.length;while(i--&&Lu(t,e[i],0)>-1){}return i}function Jh(e,t){var i=e.length,n=0;while(i--){if(e[i]===t){++n}}return n}var ef=oe(K);var tf=oe(X);function nf(e){return"\\"+Q[e]}function rf(e,t){return e==null?au:e[t]}function of(e){return Y.test(e)}function sf(e){return q.test(e)}function af(e){var t,i=[];while(!(t=e.next()).done){i.push(t.value)}return i}function lf(e){var i=-1,n=Array(e.size);e.forEach(function(e,t){n[++i]=[t,e]});return n}function cf(t,i){return function(e){return t(i(e))}}function Fu(e,t){var i=-1,n=e.length,r=0,o=[];while(++i<n){var s=e[i];if(s===t||s===Uu){e[i]=Uu;o[r++]=i}}return o}function uf(e){var t=-1,i=Array(e.size);e.forEach(function(e){i[++t]=e});return i}function df(e){var t=-1,i=Array(e.size);e.forEach(function(e){i[++t]=[e,e]});return i}function se(e,t,i){var n=i-1,r=e.length;while(++n<r){if(e[n]===t){return n}}return-1}function hf(e,t,i){var n=i+1;while(n--){if(e[n]===t){return n}}return n}function ff(e){return of(e)?ae(e):ne(e)}function Gu(e){return of(e)?le(e):re(e)}function pf(e){var t=e.length;while(t--&&n.test(e.charAt(t))){}return t}var gf=oe(Z);function ae(e){var t=W.lastIndex=0;while(W.test(e)){++t}return t}function le(e){return e.match(W)||[]}function mf(e){return e.match(U)||[]}var ce=function t(e){e=e==null?Ru:$u.defaults(Ru.Object(),e,$u.pick(Ru,vh));var A=e.Array,n=e.Date,G=e.Error,$=e.Function,H=e.Math,f=e.Object,B=e.RegExp,V=e.String,C=e.TypeError;var j=A.prototype,z=$.prototype,W=f.prototype;var U=e["__core-js_shared__"];var Y=z.toString;var x=W.hasOwnProperty;var q=0;var K=function(){var e=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var X=W.toString;var Z=Y.call(f);var Q=Ru._;var J=B("^"+Y.call(x).replace(Zd,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ee=wh?e.Buffer:au,te=e.Symbol,ie=e.Uint8Array,ne=ee?ee.allocUnsafe:au,re=cf(f.getPrototypeOf,f),oe=f.create,se=W.propertyIsEnumerable,ae=j.splice,le=te?te.isConcatSpreadable:au,ce=te?te.iterator:au,ue=te?te.toStringTag:au;var de=function(){try{var e=Jn(f,"defineProperty");e({},"",{});return e}catch(e){}}();var he=e.clearTimeout!==Ru.clearTimeout&&e.clearTimeout,fe=n&&n.now!==Ru.Date.now&&n.now,pe=e.setTimeout!==Ru.setTimeout&&e.setTimeout;var ge=H.ceil,me=H.floor,ve=f.getOwnPropertySymbols,ye=ee?ee.isBuffer:au,be=e.isFinite,_e=j.join,we=cf(f.keys,f),S=H.max,E=H.min,Ce=n.now,xe=e.parseInt,Se=H.random,Ae=j.reverse;var Ee=Jn(e,"DataView"),Te=Jn(e,"Map"),De=Jn(e,"Promise"),Re=Jn(e,"Set"),Me=Jn(e,"WeakMap"),ke=Jn(f,"create");var Oe=Me&&new Me;var Ne={};var Ie=Pr(Ee),Le=Pr(Te),Pe=Pr(De),Fe=Pr(Re),Ge=Pr(Me);var $e=te?te.prototype:au,He=$e?$e.valueOf:au,Be=$e?$e.toString:au;function m(e){if(h(e)&&!R(e)&&!(e instanceof y)){if(e instanceof v){return e}if(x.call(e,"__wrapped__")){return Gr(e)}}return new v(e)}var Ve=function(){function i(){}return function(e){if(!M(e)){return{}}if(oe){return oe(e)}i.prototype=e;var t=new i;i.prototype=au;return t}}();function je(){}function v(e,t){this.__wrapped__=e;this.__actions__=[];this.__chain__=!!t;this.__index__=0;this.__values__=au}m.templateSettings={escape:Wd,evaluate:Ud,interpolate:Yd,variable:"",imports:{_:m}};m.prototype=je.prototype;m.prototype.constructor=m;v.prototype=Ve(je.prototype);v.prototype.constructor=v;function y(e){this.__wrapped__=e;this.__actions__=[];this.__dir__=1;this.__filtered__=false;this.__iteratees__=[];this.__takeCount__=wu;this.__views__=[]}function ze(){var e=new y(this.__wrapped__);e.__actions__=w(this.__actions__);e.__dir__=this.__dir__;e.__filtered__=this.__filtered__;e.__iteratees__=w(this.__iteratees__);e.__takeCount__=this.__takeCount__;e.__views__=w(this.__views__);return e}function We(){if(this.__filtered__){var e=new y(this);e.__dir__=-1;e.__filtered__=true}else{e=this.clone();e.__dir__*=-1}return e}function Ue(){var e=this.__wrapped__.value(),t=this.__dir__,i=R(e),n=t<0,r=i?e.length:0,o=nr(0,r,this.__views__),s=o.start,a=o.end,l=a-s,c=n?a:s-1,u=this.__iteratees__,d=u.length,h=0,f=E(l,this.__takeCount__);if(!i||!n&&r==l&&f==l){return Ui(e,this.__actions__)}var p=[];e:while(l--&&h<f){c+=t;var g=-1,m=e[c];while(++g<d){var v=u[g],y=v.iteratee,b=v.type,_=y(m);if(b==nd){m=_}else if(!_){if(b==id){continue e}else{break e}}}p[h++]=m}return p}y.prototype=Ve(je.prototype);y.prototype.constructor=y;function Ye(e){var t=-1,i=e==null?0:e.length;this.clear();while(++t<i){var n=e[t];this.set(n[0],n[1])}}function qe(){this.__data__=ke?ke(null):{};this.size=0}function Ke(e){var t=this.has(e)&&delete this.__data__[e];this.size-=t?1:0;return t}function Xe(e){var t=this.__data__;if(ke){var i=t[e];return i===zu?au:i}return x.call(t,e)?t[e]:au}function Ze(e){var t=this.__data__;return ke?t[e]!==au:x.call(t,e)}function Qe(e,t){var i=this.__data__;this.size+=this.has(e)?0:1;i[e]=ke&&t===au?zu:t;return this}Ye.prototype.clear=qe;Ye.prototype["delete"]=Ke;Ye.prototype.get=Xe;Ye.prototype.has=Ze;Ye.prototype.set=Qe;function Je(e){var t=-1,i=e==null?0:e.length;this.clear();while(++t<i){var n=e[t];this.set(n[0],n[1])}}function et(){this.__data__=[];this.size=0}function tt(e){var t=this.__data__,i=At(t,e);if(i<0){return false}var n=t.length-1;if(i==n){t.pop()}else{ae.call(t,i,1)}--this.size;return true}function it(e){var t=this.__data__,i=At(t,e);return i<0?au:t[i][1]}function nt(e){return At(this.__data__,e)>-1}function rt(e,t){var i=this.__data__,n=At(i,e);if(n<0){++this.size;i.push([e,t])}else{i[n][1]=t}return this}Je.prototype.clear=et;Je.prototype["delete"]=tt;Je.prototype.get=it;Je.prototype.has=nt;Je.prototype.set=rt;function ot(e){var t=-1,i=e==null?0:e.length;this.clear();while(++t<i){var n=e[t];this.set(n[0],n[1])}}function st(){this.size=0;this.__data__={hash:new Ye,map:new(Te||Je),string:new Ye}}function at(e){var t=Zn(this,e)["delete"](e);this.size-=t?1:0;return t}function lt(e){return Zn(this,e).get(e)}function ct(e){return Zn(this,e).has(e)}function ut(e,t){var i=Zn(this,e),n=i.size;i.set(e,t);this.size+=i.size==n?0:1;return this}ot.prototype.clear=st;ot.prototype["delete"]=at;ot.prototype.get=lt;ot.prototype.has=ct;ot.prototype.set=ut;function dt(e){var t=-1,i=e==null?0:e.length;this.__data__=new ot;while(++t<i){this.add(e[t])}}function ht(e){this.__data__.set(e,zu);return this}function ft(e){return this.__data__.has(e)}dt.prototype.add=dt.prototype.push=ht;dt.prototype.has=ft;function b(e){var t=this.__data__=new Je(e);this.size=t.size}function pt(){this.__data__=new Je;this.size=0}function gt(e){var t=this.__data__,i=t["delete"](e);this.size=t.size;return i}function mt(e){return this.__data__.get(e)}function vt(e){return this.__data__.has(e)}function yt(e,t){var i=this.__data__;if(i instanceof Je){var n=i.__data__;if(!Te||n.length<Bu-1){n.push([e,t]);this.size=++i.size;return this}i=this.__data__=new ot(n)}i.set(e,t);this.size=i.size;return this}b.prototype.clear=pt;b.prototype["delete"]=gt;b.prototype.get=mt;b.prototype.has=vt;b.prototype.set=yt;function bt(e,t){var i=R(e),n=!i&&ua(e),r=!i&&!n&&fa(e),o=!i&&!n&&!r&&Fa(e),s=i||n||r||o,a=s?Uh(e.length,V):[],l=a.length;for(var c in e){if((t||x.call(e,c))&&!(s&&(c=="length"||r&&(c=="offset"||c=="parent")||o&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||dr(c,l)))){a.push(c)}}return a}function _t(e){var t=e.length;return t?e[Di(0,t-1)]:au}function wt(e,t){return Nr(w(e),kt(t,0,e.length))}function Ct(e){return Nr(w(e))}function xt(e,t,i){if(i!==au&&!d(e[t],i)||i===au&&!(t in e)){Rt(e,t,i)}}function St(e,t,i){var n=e[t];if(!(x.call(e,t)&&d(n,i))||i===au&&!(t in e)){Rt(e,t,i)}}function At(e,t){var i=e.length;while(i--){if(d(e[i][0],t)){return i}}return-1}function Et(e,n,r,o){Pt(e,function(e,t,i){n(o,e,r(e),i)});return o}function Tt(e,t){return e&&hn(t,L(t),e)}function Dt(e,t){return e&&hn(t,P(t),e)}function Rt(e,t,i){if(t=="__proto__"&&de){de(e,t,{configurable:true,enumerable:true,value:i,writable:true})}else{e[t]=i}}function Mt(e,t){var i=-1,n=t.length,r=A(n),o=e==null;while(++i<n){r[i]=o?au:ul(e,t[i])}return r}function kt(e,t,i){if(e===e){if(i!==au){e=e<=i?e:i}if(t!==au){e=e>=t?e:t}}return e}function _(i,n,r,e,t,o){var s,a=n&cu,l=n&Yu,c=n&uu;if(r){s=t?r(i,e,t,o):r(i)}if(s!==au){return s}if(!M(i)){return i}var u=R(i);if(u){s=sr(i);if(!a){return w(i,s)}}else{var d=T(i),h=d==md||d==vd;if(fa(i)){return tn(i,a)}if(d==Su||d==Cu||h&&!t){s=l||h?{}:ar(i);if(!a){return l?pn(i,Dt(s,i)):fn(i,Tt(s,i))}}else{if(!Du[d]){return t?i:{}}s=lr(i,d,a)}}o||(o=new b);var f=o.get(i);if(f){return f}o.set(i,s);if(La(i)){i.forEach(function(e){s.add(_(e,n,r,e,i,o))})}else if(Sa(i)){i.forEach(function(e,t){s.set(t,_(e,n,r,t,i,o))})}var p=c?l?Yn:Un:l?P:L;var g=u?au:p(i);ku(g||i,function(e,t){if(g){t=e;e=i[t]}St(s,t,_(e,n,r,t,i,o))});return s}function Ot(t){var i=L(t);return function(e){return Nt(e,t,i)}}function Nt(e,t,i){var n=i.length;if(e==null){return!n}e=f(e);while(n--){var r=i[n],o=t[r],s=e[r];if(s===au&&!(r in e)||!o(s)){return false}}return true}function It(e,t,i){if(typeof e!="function"){throw new C(lu)}return Rr(function(){e.apply(au,i)},t)}function Lt(e,t,i,n){var r=-1,o=kh,s=true,a=e.length,l=[],c=t.length;if(!a){return l}if(i){t=Nu(t,Pu(i))}if(n){o=Oh;s=false}else if(t.length>=Bu){o=Xh;s=false;t=new dt(t)}e:while(++r<a){var u=e[r],d=i==null?u:i(u);u=n||u!==0?u:0;if(s&&d===d){var h=c;while(h--){if(t[h]===d){continue e}}l.push(u)}else if(!o(t,d,n)){l.push(u)}}return l}var Pt=vn(s);var Ft=vn(zt,true);function Gt(e,n){var r=true;Pt(e,function(e,t,i){r=!!n(e,t,i);return r});return r}function $t(e,t,i){var n=-1,r=e.length;while(++n<r){var o=e[n],s=t(o);if(s!=null&&(a===au?s===s&&!k(s):i(s,a))){var a=s,l=o}}return l}function Ht(e,t,i,n){var r=e.length;i=O(i);if(i<0){i=-i>r?0:r+i}n=n===au||n>r?r:O(n);if(n<0){n+=r}n=i>n?0:Wa(n);while(i<n){e[i++]=t}return e}function Bt(e,n){var r=[];Pt(e,function(e,t,i){if(n(e,t,i)){r.push(e)}});return r}function l(e,t,i,n,r){var o=-1,s=e.length;i||(i=ur);r||(r=[]);while(++o<s){var a=e[o];if(t>0&&i(a)){if(t>1){l(a,t-1,i,n,r)}else{Iu(r,a)}}else if(!n){r[r.length]=a}}return r}var Vt=yn();var jt=yn(true);function s(e,t){return e&&Vt(e,t,L)}function zt(e,t){return e&&jt(e,t,L)}function Wt(t,e){return Ou(e,function(e){return wa(t[e])})}function Ut(e,t){t=Zi(t,e);var i=0,n=t.length;while(e!=null&&i<n){e=e[Lr(t[i++])]}return i&&i==n?e:au}function Yt(e,t,i){var n=t(e);return R(e)?n:Iu(n,i(e))}function r(e){if(e==null){return e===au?Ad:bd}return ue&&ue in f(e)?er(e):xr(e)}function qt(e,t){return e>t}function Kt(e,t){return e!=null&&x.call(e,t)}function Xt(e,t){return e!=null&&t in f(e)}function Zt(e,t,i){return e>=E(t,i)&&e<S(t,i)}function Qt(e,t,i){var n=i?Oh:kh,r=e[0].length,o=e.length,s=o,a=A(o),l=Infinity,c=[];while(s--){var u=e[s];if(s&&t){u=Nu(u,Pu(t))}l=E(u.length,l);a[s]=!i&&(t||r>=120&&u.length>=120)?new dt(s&&u):au}u=e[0];var d=-1,h=a[0];e:while(++d<r&&c.length<l){var f=u[d],p=t?t(f):f;f=i||f!==0?f:0;if(!(h?Xh(h,p):n(c,p,i))){s=o;while(--s){var g=a[s];if(!(g?Xh(g,p):n(e[s],p,i))){continue e}}if(h){h.push(p)}c.push(f)}}return c}function Jt(e,n,r,o){s(e,function(e,t,i){n(o,r(e),t,i)});return o}function ei(e,t,i){t=Zi(t,e);e=Ar(e,t);var n=e==null?e:e[Lr(o(t))];return n==null?au:Mu(n,e,i)}function ti(e){return h(e)&&r(e)==Cu}function ii(e){return h(e)&&r(e)==Dd}function ni(e){return h(e)&&r(e)==fd}function ri(e,t,i,n,r){if(e===t){return true}if(e==null||t==null||!h(e)&&!h(t)){return e!==e&&t!==t}return oi(e,t,i,n,ri,r)}function oi(e,t,i,n,r,o){var s=R(e),a=R(t),l=s?ud:T(e),c=a?ud:T(t);l=l==Cu?Su:l;c=c==Cu?Su:c;var u=l==Su,d=c==Su,h=l==c;if(h&&fa(e)){if(!fa(t)){return false}s=true;u=false}if(h&&!u){o||(o=new b);return s||Fa(e)?Vn(e,t,i,n,r,o):jn(e,t,l,i,n,r,o)}if(!(i&du)){var f=u&&x.call(e,"__wrapped__"),p=d&&x.call(t,"__wrapped__");if(f||p){var g=f?e.value():e,m=p?t.value():t;o||(o=new b);return r(g,m,i,n,o)}}if(!h){return false}o||(o=new b);return zn(e,t,i,n,r,o)}function si(e){return h(e)&&T(e)==xu}function ai(e,t,i,n){var r=i.length,o=r,s=!n;if(e==null){return!o}e=f(e);while(r--){var a=i[r];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e)){return false}}while(++r<o){a=i[r];var l=a[0],c=e[l],u=a[1];if(s&&a[2]){if(c===au&&!(l in e)){return false}}else{var d=new b;if(n){var h=n(c,u,l,e,t,d)}if(!(h===au?ri(u,c,du|qu,n,d):h)){return false}}}return true}function li(e){if(!M(e)||gr(e)){return false}var t=wa(e)?J:ch;return t.test(Pr(e))}function ci(e){return h(e)&&r(e)==Cd}function ui(e){return h(e)&&T(e)==Au}function di(e){return h(e)&&xa(e.length)&&!!Tu[r(e)]}function hi(e){if(typeof e=="function"){return e}if(e==null){return F}if(typeof e=="object"){return R(e)?yi(e[0],e[1]):vi(e)}return Ic(e)}function fi(e){if(!vr(e)){return we(e)}var t=[];for(var i in f(e)){if(x.call(e,i)&&i!="constructor"){t.push(i)}}return t}function pi(e){if(!M(e)){return Cr(e)}var t=vr(e),i=[];for(var n in e){if(!(n=="constructor"&&(t||!x.call(e,n)))){i.push(n)}}return i}function gi(e,t){return e<t}function mi(e,n){var r=-1,o=u(e)?A(e.length):[];Pt(e,function(e,t,i){o[++r]=n(e,t,i)});return o}function vi(t){var i=Qn(t);if(i.length==1&&i[0][2]){return br(i[0][0],i[0][1])}return function(e){return e===t||ai(e,t,i)}}function yi(i,n){if(hr(i)&&yr(n)){return br(Lr(i),n)}return function(e){var t=ul(e,i);return t===au&&t===n?hl(e,i):ri(n,t,du|qu)}}function bi(n,r,o,s,a){if(n===r){return}Vt(r,function(e,t){a||(a=new b);if(M(e)){_i(n,r,t,o,bi,s,a)}else{var i=s?s(Tr(n,t),e,t+"",n,r,a):au;if(i===au){i=e}xt(n,t,i)}},P)}function _i(e,t,i,n,r,o,s){var a=Tr(e,i),l=Tr(t,i),c=s.get(l);if(c){xt(e,i,c);return}var u=o?o(a,l,i+"",e,t,s):au;var d=u===au;if(d){var h=R(l),f=!h&&fa(l),p=!h&&!f&&Fa(l);u=l;if(h||f||p){if(R(a)){u=a}else if(g(a)){u=w(a)}else if(f){d=false;u=tn(l,true)}else if(p){d=false;u=an(l,true)}else{u=[]}}else if(Oa(l)||ua(l)){u=a;if(ua(a)){u=Ua(a)}else if(!M(a)||wa(a)){u=ar(l)}}else{d=false}}if(d){s.set(l,u);r(u,l,n,o,s);s["delete"](l)}xt(e,i,u)}function wi(e,t){var i=e.length;if(!i){return}t+=t<0?i:0;return dr(t,i)?e[t]:au}function Ci(e,r,i){if(r.length){r=Nu(r,function(t){if(R(t)){return function(e){return Ut(e,t.length===1?t[0]:t)}}return t})}else{r=[F]}var o=-1;r=Nu(r,Pu(c()));var t=mi(e,function(t,e,i){var n=Nu(r,function(e){return e(t)});return{criteria:n,index:++o,value:t}});return zh(t,function(e,t){return cn(e,t,i)})}function xi(i,e){return Si(i,e,function(e,t){return hl(i,t)})}function Si(e,t,i){var n=-1,r=t.length,o={};while(++n<r){var s=t[n],a=Ut(e,s);if(i(a,s)){Ni(o,Zi(s,e),a)}}return o}function Ai(t){return function(e){return Ut(e,t)}}function Ei(e,t,i,n){var r=n?$h:Lu,o=-1,s=t.length,a=e;if(e===t){t=w(t)}if(i){a=Nu(e,Pu(i))}while(++o<s){var l=0,c=t[o],u=i?i(c):c;while((l=r(a,u,l,n))>-1){if(a!==e){ae.call(a,l,1)}ae.call(e,l,1)}}return e}function Ti(e,t){var i=e?t.length:0,n=i-1;while(i--){var r=t[i];if(i==n||r!==o){var o=r;if(dr(r)){ae.call(e,r,1)}else{ji(e,r)}}}return e}function Di(e,t){return e+me(Se()*(t-e+1))}function Ri(e,t,i,n){var r=-1,o=S(ge((t-e)/(i||1)),0),s=A(o);while(o--){s[n?o:++r]=e;e+=i}return s}function Mi(e,t){var i="";if(!e||t<1||t>_u){return i}do{if(t%2){i+=e}t=me(t/2);if(t){e+=e}}while(t);return i}function i(e,t){return Mr(Sr(e,t,F),e+"")}function ki(e){return _t(Nl(e))}function Oi(e,t){var i=Nl(e);return Nr(i,kt(t,0,i.length))}function Ni(e,t,i,n){if(!M(e)){return e}t=Zi(t,e);var r=-1,o=t.length,s=o-1,a=e;while(a!=null&&++r<o){var l=Lr(t[r]),c=i;if(l==="__proto__"||l==="constructor"||l==="prototype"){return e}if(r!=s){var u=a[l];c=n?n(u,l,a):au;if(c===au){c=M(u)?u:dr(t[r+1])?[]:{}}}St(a,l,c);a=a[l]}return e}var Ii=!Oe?F:function(e,t){Oe.set(e,t);return e};var Li=!de?F:function(e,t){return de(e,"toString",{configurable:true,enumerable:false,value:yc(t),writable:true})};function Pi(e){return Nr(Nl(e))}function a(e,t,i){var n=-1,r=e.length;if(t<0){t=-t>r?0:r+t}i=i>r?r:i;if(i<0){i+=r}r=t>i?0:i-t>>>0;t>>>=0;var o=A(r);while(++n<r){o[n]=e[n+t]}return o}function Fi(e,n){var r;Pt(e,function(e,t,i){r=n(e,t,i);return!r});return!!r}function Gi(e,t,i){var n=0,r=e==null?n:e.length;if(typeof t=="number"&&t===t&&r<=ld){while(n<r){var o=n+r>>>1,s=e[o];if(s!==null&&!k(s)&&(i?s<=t:s<t)){n=o+1}else{r=o}}return r}return $i(e,t,F,i)}function $i(e,t,i,n){var r=0,o=e==null?0:e.length;if(o===0){return 0}t=i(t);var s=t!==t,a=t===null,l=k(t),c=t===au;while(r<o){var u=me((r+o)/2),d=i(e[u]),h=d!==au,f=d===null,p=d===d,g=k(d);if(s){var m=n||p}else if(c){m=p&&(n||h)}else if(a){m=p&&h&&(n||!f)}else if(l){m=p&&h&&!f&&(n||!g)}else if(f||g){m=false}else{m=n?d<=t:d<t}if(m){r=u+1}else{o=u}}return E(o,ad)}function Hi(e,t){var i=-1,n=e.length,r=0,o=[];while(++i<n){var s=e[i],a=t?t(s):s;if(!i||!d(a,l)){var l=a;o[r++]=s===0?0:s}}return o}function Bi(e){if(typeof e=="number"){return e}if(k(e)){return sd}return+e}function p(e){if(typeof e=="string"){return e}if(R(e)){return Nu(e,p)+""}if(k(e)){return Be?Be.call(e):""}var t=e+"";return t=="0"&&1/e==-bu?"-0":t}function Vi(e,t,i){var n=-1,r=kh,o=e.length,s=true,a=[],l=a;if(i){s=false;r=Oh}else if(o>=Bu){var c=t?null:Pn(e);if(c){return uf(c)}s=false;r=Xh;l=new dt}else{l=t?[]:a}e:while(++n<o){var u=e[n],d=t?t(u):u;u=i||u!==0?u:0;if(s&&d===d){var h=l.length;while(h--){if(l[h]===d){continue e}}if(t){l.push(d)}a.push(u)}else if(!r(l,d,i)){if(l!==a){l.push(d)}a.push(u)}}return a}function ji(e,t){t=Zi(t,e);e=Ar(e,t);return e==null||delete e[Lr(o(t))]}function zi(e,t,i,n){return Ni(e,t,i(Ut(e,t)),n)}function Wi(e,t,i,n){var r=e.length,o=n?r:-1;while((n?o--:++o<r)&&t(e[o],o,e)){}return i?a(e,n?0:o,n?o+1:r):a(e,n?o+1:0,n?r:o)}function Ui(e,t){var i=e;if(i instanceof y){i=i.value()}return Nh(t,function(e,t){return t.func.apply(t.thisArg,Iu([e],t.args))},i)}function Yi(e,t,i){var n=e.length;if(n<2){return n?Vi(e[0]):[]}var r=-1,o=A(n);while(++r<n){var s=e[r],a=-1;while(++a<n){if(a!=r){o[r]=Lt(o[r]||s,e[a],t,i)}}}return Vi(l(o,1),t,i)}function qi(e,t,i){var n=-1,r=e.length,o=t.length,s={};while(++n<r){var a=n<o?t[n]:au;i(s,e[n],a)}return s}function Ki(e){return g(e)?e:[]}function Xi(e){return typeof e=="function"?e:F}function Zi(e,t){if(R(e)){return e}return hr(e,t)?[e]:Ir(I(e))}var Qi=i;function Ji(e,t,i){var n=e.length;i=i===au?n:i;return!t&&i>=n?e:a(e,t,i)}var en=he||function(e){return Ru.clearTimeout(e)};function tn(e,t){if(t){return e.slice()}var i=e.length,n=ne?ne(i):new e.constructor(i);e.copy(n);return n}function nn(e){var t=new e.constructor(e.byteLength);new ie(t).set(new ie(e));return t}function rn(e,t){var i=t?nn(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}function on(e){var t=new e.constructor(e.source,sh.exec(e));t.lastIndex=e.lastIndex;return t}function sn(e){return He?f(He.call(e)):{}}function an(e,t){var i=t?nn(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}function ln(e,t){if(e!==t){var i=e!==au,n=e===null,r=e===e,o=k(e);var s=t!==au,a=t===null,l=t===t,c=k(t);if(!a&&!c&&!o&&e>t||o&&s&&l&&!a&&!c||n&&s&&l||!i&&l||!r){return 1}if(!n&&!o&&!c&&e<t||c&&i&&r&&!n&&!o||a&&i&&r||!s&&r||!l){return-1}}return 0}function cn(e,t,i){var n=-1,r=e.criteria,o=t.criteria,s=r.length,a=i.length;while(++n<s){var l=ln(r[n],o[n]);if(l){if(n>=a){return l}var c=i[n];return l*(c=="desc"?-1:1)}}return e.index-t.index}function un(e,t,i,n){var r=-1,o=e.length,s=i.length,a=-1,l=t.length,c=S(o-s,0),u=A(l+c),d=!n;while(++a<l){u[a]=t[a]}while(++r<s){if(d||r<o){u[i[r]]=e[r]}}while(c--){u[a++]=e[r++]}return u}function dn(e,t,i,n){var r=-1,o=e.length,s=-1,a=i.length,l=-1,c=t.length,u=S(o-a,0),d=A(u+c),h=!n;while(++r<u){d[r]=e[r]}var f=r;while(++l<c){d[f+l]=t[l]}while(++s<a){if(h||r<o){d[f+i[s]]=e[r++]}}return d}function w(e,t){var i=-1,n=e.length;t||(t=A(n));while(++i<n){t[i]=e[i]}return t}function hn(e,t,i,n){var r=!i;i||(i={});var o=-1,s=t.length;while(++o<s){var a=t[o];var l=n?n(i[a],e[a],a,i,e):au;if(l===au){l=e[a]}if(r){Rt(i,a,l)}else{St(i,a,l)}}return i}function fn(e,t){return hn(e,tr(e),t)}function pn(e,t){return hn(e,ir(e),t)}function gn(r,o){return function(e,t){var i=R(e)?Dh:Et,n=o?o():{};return i(e,r,c(t,2),n)}}function mn(a){return i(function(e,t){var i=-1,n=t.length,r=n>1?t[n-1]:au,o=n>2?t[2]:au;r=a.length>3&&typeof r=="function"?(n--,r):au;if(o&&D(t[0],t[1],o)){r=n<3?au:r;n=1}e=f(e);while(++i<n){var s=t[i];if(s){a(e,s,i,r)}}return e})}function vn(o,s){return function(e,t){if(e==null){return e}if(!u(e)){return o(e,t)}var i=e.length,n=s?i:-1,r=f(e);while(s?n--:++n<i){if(t(r[n],n,r)===false){break}}return e}}function yn(l){return function(e,t,i){var n=-1,r=f(e),o=i(e),s=o.length;while(s--){var a=o[l?s:++n];if(t(r[a],a,r)===false){break}}return e}}function bn(t,e,i){var n=e&hu,r=Cn(t);function o(){var e=this&&this!==Ru&&this instanceof o?r:t;return e.apply(n?i:this,arguments)}return o}function _n(r){return function(e){e=I(e);var t=of(e)?Gu(e):au;var i=t?t[0]:e.charAt(0);var n=t?Ji(t,1).join(""):e.slice(1);return i[r]()+n}}function wn(t){return function(e){return Nh(fc(Hl(e).replace(gh,"")),t,"")}}function Cn(n){return function(){var e=arguments;switch(e.length){case 0:return new n;case 1:return new n(e[0]);case 2:return new n(e[0],e[1]);case 3:return new n(e[0],e[1],e[2]);case 4:return new n(e[0],e[1],e[2],e[3]);case 5:return new n(e[0],e[1],e[2],e[3],e[4]);case 6:return new n(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new n(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var t=Ve(n.prototype),i=n.apply(t,e);return M(i)?i:t}}function xn(s,a,l){var c=Cn(s);function u(){var e=arguments.length,t=A(e),i=e,n=Xn(u);while(i--){t[i]=arguments[i]}var r=e<3&&t[0]!==n&&t[e-1]!==n?[]:Fu(t,n);e-=r.length;if(e<l){return In(s,a,En,u.placeholder,au,t,r,au,au,l-e)}var o=this&&this!==Ru&&this instanceof u?c:s;return Mu(o,this,t)}return u}function Sn(s){return function(e,t,i){var n=f(e);if(!u(e)){var r=c(t,3);e=L(e);t=function(e){return r(n[e],e,n)}}var o=s(e,t,i);return o>-1?n[r?e[o]:o]:au}}function An(l){return Wn(function(r){var o=r.length,e=o,t=v.prototype.thru;if(l){r.reverse()}while(e--){var i=r[e];if(typeof i!="function"){throw new C(lu)}if(t&&!s&&Kn(i)=="wrapper"){var s=new v([],true)}}e=s?e:o;while(++e<o){i=r[e];var n=Kn(i),a=n=="wrapper"?qn(i):au;if(a&&pr(a[0])&&a[1]==(yu|pu|mu|Xu)&&!a[4].length&&a[9]==1){s=s[Kn(a[0])].apply(s,a[3])}else{s=i.length==1&&pr(i)?s[n]():s.thru(i)}}return function(){var e=arguments,t=e[0];if(s&&e.length==1&&R(t)){return s.plant(t).value()}var i=0,n=o?r[i].apply(this,e):t;while(++i<o){n=r[i].call(this,n)}return n}})}function En(l,c,u,d,h,f,p,g,m,v){var y=c&yu,b=c&hu,_=c&fu,w=c&(pu|gu),C=c&Zu,x=_?au:Cn(l);function S(){var e=arguments.length,t=A(e),i=e;while(i--){t[i]=arguments[i]}if(w){var n=Xn(S),r=Jh(t,n)}if(d){t=un(t,d,h,w)}if(f){t=dn(t,f,p,w)}e-=r;if(w&&e<v){var o=Fu(t,n);return In(l,c,En,S.placeholder,u,t,o,g,m,v-e)}var s=b?u:this,a=_?s[l]:l;e=t.length;if(g){t=Er(t,g)}else if(C&&e>1){t.reverse()}if(y&&m<e){t.length=m}if(this&&this!==Ru&&this instanceof S){a=x||Cn(a)}return a.apply(s,t)}return S}function Tn(i,n){return function(e,t){return Jt(e,i,n(t),{})}}function Dn(n,r){return function(e,t){var i;if(e===au&&t===au){return r}if(e!==au){i=e}if(t!==au){if(i===au){return t}if(typeof e=="string"||typeof t=="string"){e=p(e);t=p(t)}else{e=Bi(e);t=Bi(t)}i=n(e,t)}return i}}function Rn(n){return Wn(function(e){e=Nu(e,Pu(c()));return i(function(t){var i=this;return n(e,function(e){return Mu(e,i,t)})})})}function Mn(e,t){t=t===au?" ":p(t);var i=t.length;if(i<2){return i?Mi(t,e):t}var n=Mi(t,ge(e/ff(t)));return of(t)?Ji(Gu(n),0,e).join(""):n.slice(0,e)}function kn(s,e,a,l){var c=e&hu,u=Cn(s);function d(){var e=-1,t=arguments.length,i=-1,n=l.length,r=A(n+t),o=this&&this!==Ru&&this instanceof d?u:s;while(++i<n){r[i]=l[i]}while(t--){r[i++]=arguments[++e]}return Mu(o,c?a:this,r)}return d}function On(n){return function(e,t,i){if(i&&typeof i!="number"&&D(e,t,i)){t=i=au}e=za(e);if(t===au){t=e;e=0}else{t=za(t)}i=i===au?e<t?1:-1:za(i);return Ri(e,t,i,n)}}function Nn(i){return function(e,t){if(!(typeof e=="string"&&typeof t=="string")){e=N(e);t=N(t)}return i(e,t)}}function In(e,t,i,n,r,o,s,a,l,c){var u=t&pu,d=u?s:au,h=u?au:s,f=u?o:au,p=u?au:o;t|=u?mu:vu;t&=~(u?vu:mu);if(!(t&Ku)){t&=~(hu|fu)}var g=[e,t,r,f,d,p,h,a,l,c];var m=i.apply(au,g);if(pr(e)){Dr(m,g)}m.placeholder=n;return kr(m,e,t)}function Ln(e){var r=H[e];return function(e,t){e=N(e);t=t==null?0:E(O(t),292);if(t&&be(e)){var i=(I(e)+"e").split("e"),n=r(i[0]+"e"+(+i[1]+t));i=(I(n)+"e").split("e");return+(i[0]+"e"+(+i[1]-t))}return r(e)}}var Pn=!(Re&&1/uf(new Re([,-0]))[1]==bu)?Rc:function(e){return new Re(e)};function Fn(i){return function(e){var t=T(e);if(t==xu){return lf(e)}if(t==Au){return df(e)}return Yh(e,i(e))}}function Gn(e,t,i,n,r,o,s,a){var l=t&fu;if(!l&&typeof e!="function"){throw new C(lu)}var c=n?n.length:0;if(!c){t&=~(mu|vu);n=r=au}s=s===au?s:S(O(s),0);a=a===au?a:O(a);c-=r?r.length:0;if(t&vu){var u=n,d=r;n=r=au}var h=l?au:qn(e);var f=[e,t,i,n,r,u,d,o,s,a];if(h){wr(f,h)}e=f[0];t=f[1];i=f[2];n=f[3];r=f[4];a=f[9]=f[9]===au?l?0:e.length:S(f[9]-c,0);if(!a&&t&(pu|gu)){t&=~(pu|gu)}if(!t||t==hu){var p=bn(e,t,i)}else if(t==pu||t==gu){p=xn(e,t,a)}else if((t==mu||t==(hu|mu))&&!r.length){p=kn(e,t,i,n)}else{p=En.apply(au,f)}var g=h?Ii:Dr;return kr(g(p,f),e,t)}function $n(e,t,i,n){if(e===au||d(e,W[i])&&!x.call(n,i)){return t}return e}function Hn(e,t,i,n,r,o){if(M(e)&&M(t)){o.set(t,e);bi(e,t,au,Hn,o);o["delete"](t)}return e}function Bn(e){return Oa(e)?au:e}function Vn(e,t,i,n,r,o){var s=i&du,a=e.length,l=t.length;if(a!=l&&!(s&&l>a)){return false}var c=o.get(e);var u=o.get(t);if(c&&u){return c==t&&u==e}var d=-1,h=true,f=i&qu?new dt:au;o.set(e,t);o.set(t,e);while(++d<a){var p=e[d],g=t[d];if(n){var m=s?n(g,p,d,t,e,o):n(p,g,d,e,t,o)}if(m!==au){if(m){continue}h=false;break}if(f){if(!Lh(t,function(e,t){if(!Xh(f,t)&&(p===e||r(p,e,i,n,o))){return f.push(t)}})){h=false;break}}else if(!(p===g||r(p,g,i,n,o))){h=false;break}}o["delete"](e);o["delete"](t);return h}function jn(e,t,i,n,r,o,s){switch(i){case Eu:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset){return false}e=e.buffer;t=t.buffer;case Dd:if(e.byteLength!=t.byteLength||!o(new ie(e),new ie(t))){return false}return true;case hd:case fd:case yd:return d(+e,+t);case gd:return e.name==t.name&&e.message==t.message;case Cd:case xd:return e==t+"";case xu:var a=lf;case Au:var l=n&du;a||(a=uf);if(e.size!=t.size&&!l){return false}var c=s.get(e);if(c){return c==t}n|=qu;s.set(e,t);var u=Vn(a(e),a(t),n,r,o,s);s["delete"](e);return u;case Sd:if(He){return He.call(e)==He.call(t)}}return false}function zn(e,t,i,n,r,o){var s=i&du,a=Un(e),l=a.length,c=Un(t),u=c.length;if(l!=u&&!s){return false}var d=l;while(d--){var h=a[d];if(!(s?h in t:x.call(t,h))){return false}}var f=o.get(e);var p=o.get(t);if(f&&p){return f==t&&p==e}var g=true;o.set(e,t);o.set(t,e);var m=s;while(++d<l){h=a[d];var v=e[h],y=t[h];if(n){var b=s?n(y,v,h,t,e,o):n(v,y,h,e,t,o)}if(!(b===au?v===y||r(v,y,i,n,o):b)){g=false;break}m||(m=h=="constructor")}if(g&&!m){var _=e.constructor,w=t.constructor;if(_!=w&&("constructor"in e&&"constructor"in t)&&!(typeof _=="function"&&_ instanceof _&&typeof w=="function"&&w instanceof w)){g=false}}o["delete"](e);o["delete"](t);return g}function Wn(e){return Mr(Sr(e,au,Qr),e+"")}function Un(e){return Yt(e,L,tr)}function Yn(e){return Yt(e,P,ir)}var qn=!Oe?Rc:function(e){return Oe.get(e)};function Kn(e){var t=e.name+"",i=Ne[t],n=x.call(Ne,t)?i.length:0;while(n--){var r=i[n],o=r.func;if(o==null||o==e){return r.name}}return t}function Xn(e){var t=x.call(m,"placeholder")?m:e;return t.placeholder}function c(){var e=m.iteratee||Cc;e=e===Cc?hi:e;return arguments.length?e(arguments[0],arguments[1]):e}function Zn(e,t){var i=e.__data__;return fr(t)?i[typeof t=="string"?"string":"hash"]:i.map}function Qn(e){var t=L(e),i=t.length;while(i--){var n=t[i],r=e[n];t[i]=[n,r,yr(r)]}return t}function Jn(e,t){var i=rf(e,t);return li(i)?i:au}function er(e){var t=x.call(e,ue),i=e[ue];try{e[ue]=au;var n=true}catch(e){}var r=X.call(e);if(n){if(t){e[ue]=i}else{delete e[ue]}}return r}var tr=!ve?Gc:function(t){if(t==null){return[]}t=f(t);return Ou(ve(t),function(e){return se.call(t,e)})};var ir=!ve?Gc:function(e){var t=[];while(e){Iu(t,tr(e));e=re(e)}return t};var T=r;if(Ee&&T(new Ee(new ArrayBuffer(1)))!=Eu||Te&&T(new Te)!=xu||De&&T(De.resolve())!=_d||Re&&T(new Re)!=Au||Me&&T(new Me)!=Ed){T=function(e){var t=r(e),i=t==Su?e.constructor:au,n=i?Pr(i):"";if(n){switch(n){case Ie:return Eu;case Le:return xu;case Pe:return _d;case Fe:return Au;case Ge:return Ed}}return t}}function nr(e,t,i){var n=-1,r=i.length;while(++n<r){var o=i[n],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=E(t,e+s);break;case"takeRight":e=S(e,t-s);break}}return{start:e,end:t}}function rr(e){var t=e.match(th);return t?t[1].split(ih):[]}function or(e,t,i){t=Zi(t,e);var n=-1,r=t.length,o=false;while(++n<r){var s=Lr(t[n]);if(!(o=e!=null&&i(e,s))){break}e=e[s]}if(o||++n!=r){return o}r=e==null?0:e.length;return!!r&&xa(r)&&dr(s,r)&&(R(e)||ua(e))}function sr(e){var t=e.length,i=new e.constructor(t);if(t&&typeof e[0]=="string"&&x.call(e,"index")){i.index=e.index;i.input=e.input}return i}function ar(e){return typeof e.constructor=="function"&&!vr(e)?Ve(re(e)):{}}function lr(e,t,i){var n=e.constructor;switch(t){case Dd:return nn(e);case hd:case fd:return new n(+e);case Eu:return rn(e,i);case Rd:case Md:case kd:case Od:case Nd:case Id:case Ld:case Pd:case Fd:return an(e,i);case xu:return new n;case yd:case xd:return new n(e);case Cd:return on(e);case Au:return new n;case Sd:return sn(e)}}function cr(e,t){var i=t.length;if(!i){return e}var n=i-1;t[n]=(i>1?"& ":"")+t[n];t=t.join(i>2?", ":" ");return e.replace(eh,"{\n/* [wrapped with "+t+"] */\n")}function ur(e){return R(e)||ua(e)||!!(le&&e&&e[le])}function dr(e,t){var i=typeof e;t=t==null?_u:t;return!!t&&(i=="number"||i!="symbol"&&dh.test(e))&&(e>-1&&e%1==0&&e<t)}function D(e,t,i){if(!M(i)){return false}var n=typeof t;if(n=="number"?u(i)&&dr(t,i.length):n=="string"&&t in i){return d(i[t],e)}return false}function hr(e,t){if(R(e)){return false}var i=typeof e;if(i=="number"||i=="symbol"||i=="boolean"||e==null||k(e)){return true}return Kd.test(e)||!qd.test(e)||t!=null&&e in f(t)}function fr(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function pr(e){var t=Kn(e),i=m[t];if(typeof i!="function"||!(t in y.prototype)){return false}if(e===i){return true}var n=qn(i);return!!n&&e===n[0]}function gr(e){return!!K&&K in e}var mr=U?wa:$c;function vr(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||W;return e===i}function yr(e){return e===e&&!M(e)}function br(t,i){return function(e){if(e==null){return false}return e[t]===i&&(i!==au||t in f(e))}}function _r(e){var t=zs(e,function(e){if(i.size===Wu){i.clear()}return e});var i=t.cache;return t}function wr(e,t){var i=e[1],n=t[1],r=i|n,o=r<(hu|fu|yu);var s=n==yu&&i==pu||n==yu&&i==Xu&&e[7].length<=t[8]||n==(yu|Xu)&&t[7].length<=t[8]&&i==pu;if(!(o||s)){return e}if(n&hu){e[2]=t[2];r|=i&hu?0:Ku}var a=t[3];if(a){var l=e[3];e[3]=l?un(l,a,t[4]):a;e[4]=l?Fu(e[3],Uu):t[4]}a=t[5];if(a){l=e[5];e[5]=l?dn(l,a,t[6]):a;e[6]=l?Fu(e[5],Uu):t[6]}a=t[7];if(a){e[7]=a}if(n&yu){e[8]=e[8]==null?t[8]:E(e[8],t[8])}if(e[9]==null){e[9]=t[9]}e[0]=t[0];e[1]=r;return e}function Cr(e){var t=[];if(e!=null){for(var i in f(e)){t.push(i)}}return t}function xr(e){return X.call(e)}function Sr(o,s,a){s=S(s===au?o.length-1:s,0);return function(){var e=arguments,t=-1,i=S(e.length-s,0),n=A(i);while(++t<i){n[t]=e[s+t]}t=-1;var r=A(s+1);while(++t<s){r[t]=e[t]}r[s]=a(n);return Mu(o,this,r)}}function Ar(e,t){return t.length<2?e:Ut(e,a(t,0,-1))}function Er(e,t){var i=e.length,n=E(t.length,i),r=w(e);while(n--){var o=t[n];e[n]=dr(o,i)?r[o]:au}return e}function Tr(e,t){if(t==="constructor"&&typeof e[t]==="function"){return}if(t=="__proto__"){return}return e[t]}var Dr=Or(Ii);var Rr=pe||function(e,t){return Ru.setTimeout(e,t)};var Mr=Or(Li);function kr(e,t,i){var n=t+"";return Mr(e,cr(n,Fr(rr(n),i)))}function Or(i){var n=0,r=0;return function(){var e=Ce(),t=td-(e-r);r=e;if(t>0){if(++n>=ed){return arguments[0]}}else{n=0}return i.apply(au,arguments)}}function Nr(e,t){var i=-1,n=e.length,r=n-1;t=t===au?n:t;while(++i<t){var o=Di(i,r),s=e[o];e[o]=e[i];e[i]=s}e.length=t;return e}var Ir=_r(function(e){var r=[];if(e.charCodeAt(0)===46){r.push("")}e.replace(Xd,function(e,t,i,n){r.push(i?n.replace(rh,"$1"):t||e)});return r});function Lr(e){if(typeof e=="string"||k(e)){return e}var t=e+"";return t=="0"&&1/e==-bu?"-0":t}function Pr(e){if(e!=null){try{return Y.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Fr(i,n){ku(cd,function(e){var t="_."+e[0];if(n&e[1]&&!kh(i,t)){i.push(t)}});return i.sort()}function Gr(e){if(e instanceof y){return e.clone()}var t=new v(e.__wrapped__,e.__chain__);t.__actions__=w(e.__actions__);t.__index__=e.__index__;t.__values__=e.__values__;return t}function $r(e,t,i){if(i?D(e,t,i):t===au){t=1}else{t=S(O(t),0)}var n=e==null?0:e.length;if(!n||t<1){return[]}var r=0,o=0,s=A(ge(n/t));while(r<n){s[o++]=a(e,r,r+=t)}return s}function Hr(e){var t=-1,i=e==null?0:e.length,n=0,r=[];while(++t<i){var o=e[t];if(o){r[n++]=o}}return r}function Br(){var e=arguments.length;if(!e){return[]}var t=A(e-1),i=arguments[0],n=e;while(n--){t[n-1]=arguments[n]}return Iu(R(i)?w(i):[i],l(t,1))}var Vr=i(function(e,t){return g(e)?Lt(e,l(t,1,g,true)):[]});var jr=i(function(e,t){var i=o(t);if(g(i)){i=au}return g(e)?Lt(e,l(t,1,g,true),c(i,2)):[]});var zr=i(function(e,t){var i=o(t);if(g(i)){i=au}return g(e)?Lt(e,l(t,1,g,true),au,i):[]});function Wr(e,t,i){var n=e==null?0:e.length;if(!n){return[]}t=i||t===au?1:O(t);return a(e,t<0?0:t,n)}function Ur(e,t,i){var n=e==null?0:e.length;if(!n){return[]}t=i||t===au?1:O(t);t=n-t;return a(e,0,t<0?0:t)}function Yr(e,t){return e&&e.length?Wi(e,c(t,3),true,true):[]}function qr(e,t){return e&&e.length?Wi(e,c(t,3),true):[]}function Kr(e,t,i,n){var r=e==null?0:e.length;if(!r){return[]}if(i&&typeof i!="number"&&D(e,t,i)){i=0;n=r}return Ht(e,t,i,n)}function Xr(e,t,i){var n=e==null?0:e.length;if(!n){return-1}var r=i==null?0:O(i);if(r<0){r=S(n+r,0)}return Gh(e,c(t,3),r)}function Zr(e,t,i){var n=e==null?0:e.length;if(!n){return-1}var r=n-1;if(i!==au){r=O(i);r=i<0?S(n+r,0):E(r,n-1)}return Gh(e,c(t,3),r,true)}function Qr(e){var t=e==null?0:e.length;return t?l(e,1):[]}function Jr(e){var t=e==null?0:e.length;return t?l(e,bu):[]}function eo(e,t){var i=e==null?0:e.length;if(!i){return[]}t=t===au?1:O(t);return l(e,t)}function to(e){var t=-1,i=e==null?0:e.length,n={};while(++t<i){var r=e[t];n[r[0]]=r[1]}return n}function io(e){return e&&e.length?e[0]:au}function no(e,t,i){var n=e==null?0:e.length;if(!n){return-1}var r=i==null?0:O(i);if(r<0){r=S(n+r,0)}return Lu(e,t,r)}function ro(e){var t=e==null?0:e.length;return t?a(e,0,-1):[]}var oo=i(function(e){var t=Nu(e,Ki);return t.length&&t[0]===e[0]?Qt(t):[]});var so=i(function(e){var t=o(e),i=Nu(e,Ki);if(t===o(i)){t=au}else{i.pop()}return i.length&&i[0]===e[0]?Qt(i,c(t,2)):[]});var ao=i(function(e){var t=o(e),i=Nu(e,Ki);t=typeof t=="function"?t:au;if(t){i.pop()}return i.length&&i[0]===e[0]?Qt(i,au,t):[]});function lo(e,t){return e==null?"":_e.call(e,t)}function o(e){var t=e==null?0:e.length;return t?e[t-1]:au}function co(e,t,i){var n=e==null?0:e.length;if(!n){return-1}var r=n;if(i!==au){r=O(i);r=r<0?S(n+r,0):E(r,n-1)}return t===t?hf(e,t,r):Gh(e,Hh,r,true)}function uo(e,t){return e&&e.length?wi(e,O(t)):au}var ho=i(fo);function fo(e,t){return e&&e.length&&t&&t.length?Ei(e,t):e}function po(e,t,i){return e&&e.length&&t&&t.length?Ei(e,t,c(i,2)):e}function go(e,t,i){return e&&e.length&&t&&t.length?Ei(e,t,au,i):e}var mo=Wn(function(e,t){var i=e==null?0:e.length,n=Mt(e,t);Ti(e,Nu(t,function(e){return dr(e,i)?+e:e}).sort(ln));return n});function vo(e,t){var i=[];if(!(e&&e.length)){return i}var n=-1,r=[],o=e.length;t=c(t,3);while(++n<o){var s=e[n];if(t(s,n,e)){i.push(s);r.push(n)}}Ti(e,r);return i}function yo(e){return e==null?e:Ae.call(e)}function bo(e,t,i){var n=e==null?0:e.length;if(!n){return[]}if(i&&typeof i!="number"&&D(e,t,i)){t=0;i=n}else{t=t==null?0:O(t);i=i===au?n:O(i)}return a(e,t,i)}function _o(e,t){return Gi(e,t)}function wo(e,t,i){return $i(e,t,c(i,2))}function Co(e,t){var i=e==null?0:e.length;if(i){var n=Gi(e,t);if(n<i&&d(e[n],t)){return n}}return-1}function xo(e,t){return Gi(e,t,true)}function So(e,t,i){return $i(e,t,c(i,2),true)}function Ao(e,t){var i=e==null?0:e.length;if(i){var n=Gi(e,t,true)-1;if(d(e[n],t)){return n}}return-1}function Eo(e){return e&&e.length?Hi(e):[]}function To(e,t){return e&&e.length?Hi(e,c(t,2)):[]}function Do(e){var t=e==null?0:e.length;return t?a(e,1,t):[]}function Ro(e,t,i){if(!(e&&e.length)){return[]}t=i||t===au?1:O(t);return a(e,0,t<0?0:t)}function Mo(e,t,i){var n=e==null?0:e.length;if(!n){return[]}t=i||t===au?1:O(t);t=n-t;return a(e,t<0?0:t,n)}function ko(e,t){return e&&e.length?Wi(e,c(t,3),false,true):[]}function Oo(e,t){return e&&e.length?Wi(e,c(t,3)):[]}var No=i(function(e){return Vi(l(e,1,g,true))});var Io=i(function(e){var t=o(e);if(g(t)){t=au}return Vi(l(e,1,g,true),c(t,2))});var Lo=i(function(e){var t=o(e);t=typeof t=="function"?t:au;return Vi(l(e,1,g,true),au,t)});function Po(e){return e&&e.length?Vi(e):[]}function Fo(e,t){return e&&e.length?Vi(e,c(t,2)):[]}function Go(e,t){t=typeof t=="function"?t:au;return e&&e.length?Vi(e,au,t):[]}function $o(t){if(!(t&&t.length)){return[]}var i=0;t=Ou(t,function(e){if(g(e)){i=S(e.length,i);return true}});return Uh(i,function(e){return Nu(t,Vh(e))})}function Ho(e,t){if(!(e&&e.length)){return[]}var i=$o(e);if(t==null){return i}return Nu(i,function(e){return Mu(t,au,e)})}var Bo=i(function(e,t){return g(e)?Lt(e,t):[]});var Vo=i(function(e){return Yi(Ou(e,g))});var jo=i(function(e){var t=o(e);if(g(t)){t=au}return Yi(Ou(e,g),c(t,2))});var zo=i(function(e){var t=o(e);t=typeof t=="function"?t:au;return Yi(Ou(e,g),au,t)});var Wo=i($o);function Uo(e,t){return qi(e||[],t||[],St)}function Yo(e,t){return qi(e||[],t||[],Ni)}var qo=i(function(e){var t=e.length,i=t>1?e[t-1]:au;i=typeof i=="function"?(e.pop(),i):au;return Ho(e,i)});function Ko(e){var t=m(e);t.__chain__=true;return t}function Xo(e,t){t(e);return e}function Zo(e,t){return t(e)}var Qo=Wn(function(t){var i=t.length,e=i?t[0]:0,n=this.__wrapped__,r=function(e){return Mt(e,t)};if(i>1||this.__actions__.length||!(n instanceof y)||!dr(e)){return this.thru(r)}n=n.slice(e,+e+(i?1:0));n.__actions__.push({func:Zo,args:[r],thisArg:au});return new v(n,this.__chain__).thru(function(e){if(i&&!e.length){e.push(au)}return e})});function Jo(){return Ko(this)}function es(){return new v(this.value(),this.__chain__)}function ts(){if(this.__values__===au){this.__values__=ja(this.value())}var e=this.__index__>=this.__values__.length,t=e?au:this.__values__[this.__index__++];return{done:e,value:t}}function is(){return this}function ns(e){var t,i=this;while(i instanceof je){var n=Gr(i);n.__index__=0;n.__values__=au;if(t){r.__wrapped__=n}else{t=n}var r=n;i=i.__wrapped__}r.__wrapped__=e;return t}function rs(){var e=this.__wrapped__;if(e instanceof y){var t=e;if(this.__actions__.length){t=new y(this)}t=t.reverse();t.__actions__.push({func:Zo,args:[yo],thisArg:au});return new v(t,this.__chain__)}return this.thru(yo)}function os(){return Ui(this.__wrapped__,this.__actions__)}var ss=gn(function(e,t,i){if(x.call(e,i)){++e[i]}else{Rt(e,i,1)}});function as(e,t,i){var n=R(e)?Mh:Gt;if(i&&D(e,t,i)){t=au}return n(e,c(t,3))}function ls(e,t){var i=R(e)?Ou:Bt;return i(e,c(t,3))}var cs=Sn(Xr);var us=Sn(Zr);function ds(e,t){return l(_s(e,t),1)}function hs(e,t){return l(_s(e,t),bu)}function fs(e,t,i){i=i===au?1:O(i);return l(_s(e,t),i)}function ps(e,t){var i=R(e)?ku:Pt;return i(e,c(t,3))}function gs(e,t){var i=R(e)?Rh:Ft;return i(e,c(t,3))}var ms=gn(function(e,t,i){if(x.call(e,i)){e[i].push(t)}else{Rt(e,i,[t])}});function vs(e,t,i,n){e=u(e)?e:Nl(e);i=i&&!n?O(i):0;var r=e.length;if(i<0){i=S(r+i,0)}return Pa(e)?i<=r&&e.indexOf(t,i)>-1:!!r&&Lu(e,t,i)>-1}var ys=i(function(e,t,i){var n=-1,r=typeof t=="function",o=u(e)?A(e.length):[];Pt(e,function(e){o[++n]=r?Mu(t,e,i):ei(e,t,i)});return o});var bs=gn(function(e,t,i){Rt(e,i,t)});function _s(e,t){var i=R(e)?Nu:mi;return i(e,c(t,3))}function ws(e,t,i,n){if(e==null){return[]}if(!R(t)){t=t==null?[]:[t]}i=n?au:i;if(!R(i)){i=i==null?[]:[i]}return Ci(e,t,i)}var Cs=gn(function(e,t,i){e[i?0:1].push(t)},function(){return[[],[]]});function xs(e,t,i){var n=R(e)?Nh:jh,r=arguments.length<3;return n(e,c(t,4),i,r,Pt)}function Ss(e,t,i){var n=R(e)?Ih:jh,r=arguments.length<3;return n(e,c(t,4),i,r,Ft)}function As(e,t){var i=R(e)?Ou:Bt;return i(e,Ws(c(t,3)))}function Es(e){var t=R(e)?_t:ki;return t(e)}function Ts(e,t,i){if(i?D(e,t,i):t===au){t=1}else{t=O(t)}var n=R(e)?wt:Oi;return n(e,t)}function Ds(e){var t=R(e)?Ct:Pi;return t(e)}function Rs(e){if(e==null){return 0}if(u(e)){return Pa(e)?ff(e):e.length}var t=T(e);if(t==xu||t==Au){return e.size}return fi(e).length}function Ms(e,t,i){var n=R(e)?Lh:Fi;if(i&&D(e,t,i)){t=au}return n(e,c(t,3))}var ks=i(function(e,t){if(e==null){return[]}var i=t.length;if(i>1&&D(e,t[0],t[1])){t=[]}else if(i>2&&D(t[0],t[1],t[2])){t=[t[0]]}return Ci(e,l(t,1),[])});var Os=fe||function(){return Ru.Date.now()};function Ns(e,t){if(typeof t!="function"){throw new C(lu)}e=O(e);return function(){if(--e<1){return t.apply(this,arguments)}}}function Is(e,t,i){t=i?au:t;t=e&&t==null?e.length:t;return Gn(e,yu,au,au,au,au,t)}function Ls(e,t){var i;if(typeof t!="function"){throw new C(lu)}e=O(e);return function(){if(--e>0){i=t.apply(this,arguments)}if(e<=1){t=au}return i}}var Ps=i(function(e,t,i){var n=hu;if(i.length){var r=Fu(i,Xn(Ps));n|=mu}return Gn(e,n,t,i,r)});var Fs=i(function(e,t,i){var n=hu|fu;if(i.length){var r=Fu(i,Xn(Fs));n|=mu}return Gn(t,n,e,i,r)});function Gs(e,t,i){t=i?au:t;var n=Gn(e,pu,au,au,au,au,au,t);n.placeholder=Gs.placeholder;return n}function $s(e,t,i){t=i?au:t;var n=Gn(e,gu,au,au,au,au,au,t);n.placeholder=$s.placeholder;return n}function Hs(n,r,e){var o,s,a,l,i,c,u=0,t=false,d=false,h=true;if(typeof n!="function"){throw new C(lu)}r=N(r)||0;if(M(e)){t=!!e.leading;d="maxWait"in e;a=d?S(N(e.maxWait)||0,r):a;h="trailing"in e?!!e.trailing:h}function f(e){var t=o,i=s;o=s=au;u=e;l=n.apply(i,t);return l}function p(e){u=e;i=Rr(v,r);return t?f(e):l}function g(e){var t=e-c,i=e-u,n=r-t;return d?E(n,a-i):n}function m(e){var t=e-c,i=e-u;return c===au||t>=r||t<0||d&&i>=a}function v(){var e=Os();if(m(e)){return y(e)}i=Rr(v,g(e))}function y(e){i=au;if(h&&o){return f(e)}o=s=au;return l}function b(){if(i!==au){en(i)}u=0;o=c=s=i=au}function _(){return i===au?l:y(Os())}function w(){var e=Os(),t=m(e);o=arguments;s=this;c=e;if(t){if(i===au){return p(c)}if(d){en(i);i=Rr(v,r);return f(c)}}if(i===au){i=Rr(v,r)}return l}w.cancel=b;w.flush=_;return w}var Bs=i(function(e,t){return It(e,1,t)});var Vs=i(function(e,t,i){return It(e,N(t)||0,i)});function js(e){return Gn(e,Zu)}function zs(r,o){if(typeof r!="function"||o!=null&&typeof o!="function"){throw new C(lu)}var s=function(){var e=arguments,t=o?o.apply(this,e):e[0],i=s.cache;if(i.has(t)){return i.get(t)}var n=r.apply(this,e);s.cache=i.set(t,n)||i;return n};s.cache=new(zs.Cache||ot);return s}zs.Cache=ot;function Ws(t){if(typeof t!="function"){throw new C(lu)}return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Us(e){return Ls(2,e)}var Ys=Qi(function(n,r){r=r.length==1&&R(r[0])?Nu(r[0],Pu(c())):Nu(l(r,1),Pu(c()));var o=r.length;return i(function(e){var t=-1,i=E(e.length,o);while(++t<i){e[t]=r[t].call(this,e[t])}return Mu(n,this,e)})});var qs=i(function(e,t){var i=Fu(t,Xn(qs));return Gn(e,mu,au,t,i)});var Ks=i(function(e,t){var i=Fu(t,Xn(Ks));return Gn(e,vu,au,t,i)});var Xs=Wn(function(e,t){return Gn(e,Xu,au,au,au,t)});function Zs(e,t){if(typeof e!="function"){throw new C(lu)}t=t===au?t:O(t);return i(e,t)}function Qs(n,r){if(typeof n!="function"){throw new C(lu)}r=r==null?0:S(O(r),0);return i(function(e){var t=e[r],i=Ji(e,0,r);if(t){Iu(i,t)}return Mu(n,this,i)})}function Js(e,t,i){var n=true,r=true;if(typeof e!="function"){throw new C(lu)}if(M(i)){n="leading"in i?!!i.leading:n;r="trailing"in i?!!i.trailing:r}return Hs(e,t,{leading:n,maxWait:t,trailing:r})}function ea(e){return Is(e,1)}function ta(e,t){return qs(Xi(t),e)}function ia(){if(!arguments.length){return[]}var e=arguments[0];return R(e)?e:[e]}function na(e){return _(e,uu)}function ra(e,t){t=typeof t=="function"?t:au;return _(e,uu,t)}function oa(e){return _(e,cu|uu)}function sa(e,t){t=typeof t=="function"?t:au;return _(e,cu|uu,t)}function aa(e,t){return t==null||Nt(e,t,L(t))}function d(e,t){return e===t||e!==e&&t!==t}var la=Nn(qt);var ca=Nn(function(e,t){return e>=t});var ua=ti(function(){return arguments}())?ti:function(e){return h(e)&&x.call(e,"callee")&&!se.call(e,"callee")};var R=A.isArray;var da=Ch?Pu(Ch):ii;function u(e){return e!=null&&xa(e.length)&&!wa(e)}function g(e){return h(e)&&u(e)}function ha(e){return e===true||e===false||h(e)&&r(e)==hd}var fa=ye||$c;var pa=xh?Pu(xh):ni;function ga(e){return h(e)&&e.nodeType===1&&!Oa(e)}function ma(e){if(e==null){return true}if(u(e)&&(R(e)||typeof e=="string"||typeof e.splice=="function"||fa(e)||Fa(e)||ua(e))){return!e.length}var t=T(e);if(t==xu||t==Au){return!e.size}if(vr(e)){return!fi(e).length}for(var i in e){if(x.call(e,i)){return false}}return true}function va(e,t){return ri(e,t)}function ya(e,t,i){i=typeof i=="function"?i:au;var n=i?i(e,t):au;return n===au?ri(e,t,au,i):!!n}function ba(e){if(!h(e)){return false}var t=r(e);return t==gd||t==pd||typeof e.message=="string"&&typeof e.name=="string"&&!Oa(e)}function _a(e){return typeof e=="number"&&be(e)}function wa(e){if(!M(e)){return false}var t=r(e);return t==md||t==vd||t==dd||t==wd}function Ca(e){return typeof e=="number"&&e==O(e)}function xa(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=_u}function M(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function h(e){return e!=null&&typeof e=="object"}var Sa=Sh?Pu(Sh):si;function Aa(e,t){return e===t||ai(e,t,Qn(t))}function Ea(e,t,i){i=typeof i=="function"?i:au;return ai(e,t,Qn(t),i)}function Ta(e){return ka(e)&&e!=+e}function Da(e){if(mr(e)){throw new G(Vu)}return li(e)}function Ra(e){return e===null}function Ma(e){return e==null}function ka(e){return typeof e=="number"||h(e)&&r(e)==yd}function Oa(e){if(!h(e)||r(e)!=Su){return false}var t=re(e);if(t===null){return true}var i=x.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&Y.call(i)==Z}var Na=Ah?Pu(Ah):ci;function Ia(e){return Ca(e)&&e>=-_u&&e<=_u}var La=Eh?Pu(Eh):ui;function Pa(e){return typeof e=="string"||!R(e)&&h(e)&&r(e)==xd}function k(e){return typeof e=="symbol"||h(e)&&r(e)==Sd}var Fa=Th?Pu(Th):di;function Ga(e){return e===au}function $a(e){return h(e)&&T(e)==Ed}function Ha(e){return h(e)&&r(e)==Td}var Ba=Nn(gi);var Va=Nn(function(e,t){return e<=t});function ja(e){if(!e){return[]}if(u(e)){return Pa(e)?Gu(e):w(e)}if(ce&&e[ce]){return af(e[ce]())}var t=T(e),i=t==xu?lf:t==Au?uf:Nl;return i(e)}function za(e){if(!e){return e===0?e:0}e=N(e);if(e===bu||e===-bu){var t=e<0?-1:1;return t*od}return e===e?e:0}function O(e){var t=za(e),i=t%1;return t===t?i?t-i:t:0}function Wa(e){return e?kt(O(e),0,wu):0}function N(e){if(typeof e=="number"){return e}if(k(e)){return sd}if(M(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=M(t)?t+"":t}if(typeof e!="string"){return e===0?e:+e}e=qh(e);var i=lh.test(e);return i||uh.test(e)?_h(e.slice(2),i?2:8):ah.test(e)?sd:+e}function Ua(e){return hn(e,P(e))}function Ya(e){return e?kt(O(e),-_u,_u):e===0?e:0}function I(e){return e==null?"":p(e)}var qa=mn(function(e,t){if(vr(t)||u(t)){hn(t,L(t),e);return}for(var i in t){if(x.call(t,i)){St(e,i,t[i])}}});var Ka=mn(function(e,t){hn(t,P(t),e)});var Xa=mn(function(e,t,i,n){hn(t,P(t),e,n)});var Za=mn(function(e,t,i,n){hn(t,L(t),e,n)});var Qa=Wn(Mt);function Ja(e,t){var i=Ve(e);return t==null?i:Tt(i,t)}var el=i(function(e,t){e=f(e);var i=-1;var n=t.length;var r=n>2?t[2]:au;if(r&&D(t[0],t[1],r)){n=1}while(++i<n){var o=t[i];var s=P(o);var a=-1;var l=s.length;while(++a<l){var c=s[a];var u=e[c];if(u===au||d(u,W[c])&&!x.call(e,c)){e[c]=o[c]}}}return e});var tl=i(function(e){e.push(au,Hn);return Mu(bl,au,e)});function il(e,t){return Fh(e,c(t,3),s)}function nl(e,t){return Fh(e,c(t,3),zt)}function rl(e,t){return e==null?e:Vt(e,c(t,3),P)}function ol(e,t){return e==null?e:jt(e,c(t,3),P)}function sl(e,t){return e&&s(e,c(t,3))}function al(e,t){return e&&zt(e,c(t,3))}function ll(e){return e==null?[]:Wt(e,L(e))}function cl(e){return e==null?[]:Wt(e,P(e))}function ul(e,t,i){var n=e==null?au:Ut(e,t);return n===au?i:n}function dl(e,t){return e!=null&&or(e,t,Kt)}function hl(e,t){return e!=null&&or(e,t,Xt)}var fl=Tn(function(e,t,i){if(t!=null&&typeof t.toString!="function"){t=X.call(t)}e[t]=i},yc(F));var pl=Tn(function(e,t,i){if(t!=null&&typeof t.toString!="function"){t=X.call(t)}if(x.call(e,t)){e[t].push(i)}else{e[t]=[i]}},c);var gl=i(ei);function L(e){return u(e)?bt(e):fi(e)}function P(e){return u(e)?bt(e,true):pi(e)}function ml(e,n){var r={};n=c(n,3);s(e,function(e,t,i){Rt(r,n(e,t,i),e)});return r}function vl(e,n){var r={};n=c(n,3);s(e,function(e,t,i){Rt(r,t,n(e,t,i))});return r}var yl=mn(function(e,t,i){bi(e,t,i)});var bl=mn(function(e,t,i,n){bi(e,t,i,n)});var _l=Wn(function(t,e){var i={};if(t==null){return i}var n=false;e=Nu(e,function(e){e=Zi(e,t);n||(n=e.length>1);return e});hn(t,Yn(t),i);if(n){i=_(i,cu|Yu|uu,Bn)}var r=e.length;while(r--){ji(i,e[r])}return i});function wl(e,t){return xl(e,Ws(c(t)))}var Cl=Wn(function(e,t){return e==null?{}:xi(e,t)});function xl(e,i){if(e==null){return{}}var t=Nu(Yn(e),function(e){return[e]});i=c(i);return Si(e,t,function(e,t){return i(e,t[0])})}function Sl(e,t,i){t=Zi(t,e);var n=-1,r=t.length;if(!r){r=1;e=au}while(++n<r){var o=e==null?au:e[Lr(t[n])];if(o===au){n=r;o=i}e=wa(o)?o.call(e):o}return e}function Al(e,t,i){return e==null?e:Ni(e,t,i)}function El(e,t,i,n){n=typeof n=="function"?n:au;return e==null?e:Ni(e,t,i,n)}var Tl=Fn(L);var Dl=Fn(P);function Rl(e,n,r){var t=R(e),i=t||fa(e)||Fa(e);n=c(n,4);if(r==null){var o=e&&e.constructor;if(i){r=t?new o:[]}else if(M(e)){r=wa(o)?Ve(re(e)):{}}else{r={}}}(i?ku:s)(e,function(e,t,i){return n(r,e,t,i)});return r}function Ml(e,t){return e==null?true:ji(e,t)}function kl(e,t,i){return e==null?e:zi(e,t,Xi(i))}function Ol(e,t,i,n){n=typeof n=="function"?n:au;return e==null?e:zi(e,t,Xi(i),n)}function Nl(e){return e==null?[]:Kh(e,L(e))}function Il(e){return e==null?[]:Kh(e,P(e))}function Ll(e,t,i){if(i===au){i=t;t=au}if(i!==au){i=N(i);i=i===i?i:0}if(t!==au){t=N(t);t=t===t?t:0}return kt(N(e),t,i)}function Pl(e,t,i){t=za(t);if(i===au){i=t;t=0}else{i=za(i)}e=N(e);return Zt(e,t,i)}function Fl(e,t,i){if(i&&typeof i!="boolean"&&D(e,t,i)){t=i=au}if(i===au){if(typeof t=="boolean"){i=t;t=au}else if(typeof e=="boolean"){i=e;e=au}}if(e===au&&t===au){e=0;t=1}else{e=za(e);if(t===au){t=e;e=0}else{t=za(t)}}if(e>t){var n=e;e=t;t=n}if(i||e%1||t%1){var r=Se();return E(e+r*(t-e+bh("1e-"+((r+"").length-1))),t)}return Di(e,t)}var Gl=wn(function(e,t,i){t=t.toLowerCase();return e+(i?$l(t):t)});function $l(e){return hc(I(e).toLowerCase())}function Hl(e){e=I(e);return e&&e.replace(hh,ef).replace(mh,"")}function Bl(e,t,i){e=I(e);t=p(t);var n=e.length;i=i===au?n:kt(O(i),0,n);var r=i;i-=t.length;return i>=0&&e.slice(i,r)==t}function Vl(e){e=I(e);return e&&zd.test(e)?e.replace(Vd,tf):e}function jl(e){e=I(e);return e&&Qd.test(e)?e.replace(Zd,"\\$&"):e}var zl=wn(function(e,t,i){return e+(i?"-":"")+t.toLowerCase()});var Wl=wn(function(e,t,i){return e+(i?" ":"")+t.toLowerCase()});var Ul=_n("toLowerCase");function Yl(e,t,i){e=I(e);t=O(t);var n=t?ff(e):0;if(!t||n>=t){return e}var r=(t-n)/2;return Mn(me(r),i)+e+Mn(ge(r),i)}function ql(e,t,i){e=I(e);t=O(t);var n=t?ff(e):0;return t&&n<t?e+Mn(t-n,i):e}function Kl(e,t,i){e=I(e);t=O(t);var n=t?ff(e):0;return t&&n<t?Mn(t-n,i)+e:e}function Xl(e,t,i){if(i||t==null){t=0}else if(t){t=+t}return xe(I(e).replace(Jd,""),t||0)}function Zl(e,t,i){if(i?D(e,t,i):t===au){t=1}else{t=O(t)}return Mi(I(e),t)}function Ql(){var e=arguments,t=I(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var Jl=wn(function(e,t,i){return e+(i?"_":"")+t.toLowerCase()});function ec(e,t,i){if(i&&typeof i!="number"&&D(e,t,i)){t=i=au}i=i===au?wu:i>>>0;if(!i){return[]}e=I(e);if(e&&(typeof t=="string"||t!=null&&!Na(t))){t=p(t);if(!t&&of(e)){return Ji(Gu(e),0,i)}}return e.split(t,i)}var tc=wn(function(e,t,i){return e+(i?" ":"")+hc(t)});function ic(e,t,i){e=I(e);i=i==null?0:kt(O(i),0,e.length);t=p(t);return e.slice(i,i+t.length)==t}function nc(s,e,t){var i=m.templateSettings;if(t&&D(s,e,t)){e=au}s=I(s);e=Xa({},e,i,$n);var n=Xa({},e.imports,i.imports,$n),r=L(n),o=Kh(n,r);var a,l,c=0,u=e.interpolate||fh,d="__p += '";var h=B((e.escape||fh).source+"|"+u.source+"|"+(u===Yd?oh:fh).source+"|"+(e.evaluate||fh).source+"|$","g");var f="//# sourceURL="+(x.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++yh+"]")+"\n";s.replace(h,function(e,t,i,n,r,o){i||(i=n);d+=s.slice(c,o).replace(ph,nf);if(t){a=true;d+="' +\n__e("+t+") +\n'"}if(r){l=true;d+="';\n"+r+";\n__p += '"}if(i){d+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"}c=o+e.length;return e});d+="';\n";var p=x.call(e,"variable")&&e.variable;if(!p){d="with (obj) {\n"+d+"\n}\n"}else if(nh.test(p)){throw new G(ju)}d=(l?d.replace(Gd,""):d).replace($d,"$1").replace(Hd,"$1;");d="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(l?", __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=pc(function(){return $(r,f+"return "+d).apply(au,o)});g.source=d;if(ba(g)){throw g}return g}function rc(e){return I(e).toLowerCase()}function oc(e){return I(e).toUpperCase()}function sc(e,t,i){e=I(e);if(e&&(i||t===au)){return qh(e)}if(!e||!(t=p(t))){return e}var n=Gu(e),r=Gu(t),o=Zh(n,r),s=Qh(n,r)+1;return Ji(n,o,s).join("")}function ac(e,t,i){e=I(e);if(e&&(i||t===au)){return e.slice(0,pf(e)+1)}if(!e||!(t=p(t))){return e}var n=Gu(e),r=Qh(n,Gu(t))+1;return Ji(n,0,r).join("")}function lc(e,t,i){e=I(e);if(e&&(i||t===au)){return e.replace(Jd,"")}if(!e||!(t=p(t))){return e}var n=Gu(e),r=Zh(n,Gu(t));return Ji(n,r).join("")}function cc(e,t){var i=Qu,n=Ju;if(M(t)){var r="separator"in t?t.separator:r;i="length"in t?O(t.length):i;n="omission"in t?p(t.omission):n}e=I(e);var o=e.length;if(of(e)){var s=Gu(e);o=s.length}if(i>=o){return e}var a=i-ff(n);if(a<1){return n}var l=s?Ji(s,0,a).join(""):e.slice(0,a);if(r===au){return l+n}if(s){a+=l.length-a}if(Na(r)){if(e.slice(a).search(r)){var c,u=l;if(!r.global){r=B(r.source,I(sh.exec(r))+"g")}r.lastIndex=0;while(c=r.exec(u)){var d=c.index}l=l.slice(0,d===au?a:d)}}else if(e.indexOf(p(r),a)!=a){var h=l.lastIndexOf(r);if(h>-1){l=l.slice(0,h)}}return l+n}function uc(e){e=I(e);return e&&jd.test(e)?e.replace(Bd,gf):e}var dc=wn(function(e,t,i){return e+(i?" ":"")+t.toUpperCase()});var hc=_n("toUpperCase");function fc(e,t,i){e=I(e);t=i?au:t;if(t===au){return sf(e)?mf(e):Ph(e)}return e.match(t)||[]}var pc=i(function(e,t){try{return Mu(e,au,t)}catch(e){return ba(e)?e:new G(e)}});var gc=Wn(function(t,e){ku(e,function(e){e=Lr(e);Rt(t,e,Ps(t[e],t))});return t});function mc(n){var r=n==null?0:n.length,t=c();n=!r?[]:Nu(n,function(e){if(typeof e[1]!="function"){throw new C(lu)}return[t(e[0]),e[1]]});return i(function(e){var t=-1;while(++t<r){var i=n[t];if(Mu(i[0],this,e)){return Mu(i[1],this,e)}}})}function vc(e){return Ot(_(e,cu))}function yc(e){return function(){return e}}function bc(e,t){return e==null||e!==e?t:e}var _c=An();var wc=An(true);function F(e){return e}function Cc(e){return hi(typeof e=="function"?e:_(e,cu))}function xc(e){return vi(_(e,cu))}function Sc(e,t){return yi(e,_(t,cu))}var Ac=i(function(t,i){return function(e){return ei(e,t,i)}});var Ec=i(function(t,i){return function(e){return ei(t,e,i)}});function Tc(r,t,e){var i=L(t),n=Wt(t,i);if(e==null&&!(M(t)&&(n.length||!i.length))){e=t;t=r;r=this;n=Wt(t,L(t))}var o=!(M(e)&&"chain"in e)||!!e.chain,s=wa(r);ku(n,function(e){var n=t[e];r[e]=n;if(s){r.prototype[e]=function(){var e=this.__chain__;if(o||e){var t=r(this.__wrapped__),i=t.__actions__=w(this.__actions__);i.push({func:n,args:arguments,thisArg:r});t.__chain__=e;return t}return n.apply(r,Iu([this.value()],arguments))}}});return r}function Dc(){if(Ru._===this){Ru._=Q}return this}function Rc(){}function Mc(t){t=O(t);return i(function(e){return wi(e,t)})}var kc=Rn(Nu);var Oc=Rn(Mh);var Nc=Rn(Lh);function Ic(e){return hr(e)?Vh(Lr(e)):Ai(e)}function Lc(t){return function(e){return t==null?au:Ut(t,e)}}var Pc=On();var Fc=On(true);function Gc(){return[]}function $c(){return false}function Hc(){return{}}function Bc(){return""}function Vc(){return true}function jc(e,t){e=O(e);if(e<1||e>_u){return[]}var i=wu,n=E(e,wu);t=c(t);e-=wu;var r=Uh(n,t);while(++i<e){t(i)}return r}function zc(e){if(R(e)){return Nu(e,Lr)}return k(e)?[e]:w(Ir(I(e)))}function Wc(e){var t=++q;return I(e)+t}var Uc=Dn(function(e,t){return e+t},0);var Yc=Ln("ceil");var qc=Dn(function(e,t){return e/t},1);var Kc=Ln("floor");function Xc(e){return e&&e.length?$t(e,F,qt):au}function Zc(e,t){return e&&e.length?$t(e,c(t,2),qt):au}function Qc(e){return Bh(e,F)}function Jc(e,t){return Bh(e,c(t,2))}function eu(e){return e&&e.length?$t(e,F,gi):au}function tu(e,t){return e&&e.length?$t(e,c(t,2),gi):au}var iu=Dn(function(e,t){return e*t},1);var nu=Ln("round");var ru=Dn(function(e,t){return e-t},0);function ou(e){return e&&e.length?Wh(e,F):0}function su(e,t){return e&&e.length?Wh(e,c(t,2)):0}m.after=Ns;m.ary=Is;m.assign=qa;m.assignIn=Ka;m.assignInWith=Xa;m.assignWith=Za;m.at=Qa;m.before=Ls;m.bind=Ps;m.bindAll=gc;m.bindKey=Fs;m.castArray=ia;m.chain=Ko;m.chunk=$r;m.compact=Hr;m.concat=Br;m.cond=mc;m.conforms=vc;m.constant=yc;m.countBy=ss;m.create=Ja;m.curry=Gs;m.curryRight=$s;m.debounce=Hs;m.defaults=el;m.defaultsDeep=tl;m.defer=Bs;m.delay=Vs;m.difference=Vr;m.differenceBy=jr;m.differenceWith=zr;m.drop=Wr;m.dropRight=Ur;m.dropRightWhile=Yr;m.dropWhile=qr;m.fill=Kr;m.filter=ls;m.flatMap=ds;m.flatMapDeep=hs;m.flatMapDepth=fs;m.flatten=Qr;m.flattenDeep=Jr;m.flattenDepth=eo;m.flip=js;m.flow=_c;m.flowRight=wc;m.fromPairs=to;m.functions=ll;m.functionsIn=cl;m.groupBy=ms;m.initial=ro;m.intersection=oo;m.intersectionBy=so;m.intersectionWith=ao;m.invert=fl;m.invertBy=pl;m.invokeMap=ys;m.iteratee=Cc;m.keyBy=bs;m.keys=L;m.keysIn=P;m.map=_s;m.mapKeys=ml;m.mapValues=vl;m.matches=xc;m.matchesProperty=Sc;m.memoize=zs;m.merge=yl;m.mergeWith=bl;m.method=Ac;m.methodOf=Ec;m.mixin=Tc;m.negate=Ws;m.nthArg=Mc;m.omit=_l;m.omitBy=wl;m.once=Us;m.orderBy=ws;m.over=kc;m.overArgs=Ys;m.overEvery=Oc;m.overSome=Nc;m.partial=qs;m.partialRight=Ks;m.partition=Cs;m.pick=Cl;m.pickBy=xl;m.property=Ic;m.propertyOf=Lc;m.pull=ho;m.pullAll=fo;m.pullAllBy=po;m.pullAllWith=go;m.pullAt=mo;m.range=Pc;m.rangeRight=Fc;m.rearg=Xs;m.reject=As;m.remove=vo;m.rest=Zs;m.reverse=yo;m.sampleSize=Ts;m.set=Al;m.setWith=El;m.shuffle=Ds;m.slice=bo;m.sortBy=ks;m.sortedUniq=Eo;m.sortedUniqBy=To;m.split=ec;m.spread=Qs;m.tail=Do;m.take=Ro;m.takeRight=Mo;m.takeRightWhile=ko;m.takeWhile=Oo;m.tap=Xo;m.throttle=Js;m.thru=Zo;m.toArray=ja;m.toPairs=Tl;m.toPairsIn=Dl;m.toPath=zc;m.toPlainObject=Ua;m.transform=Rl;m.unary=ea;m.union=No;m.unionBy=Io;m.unionWith=Lo;m.uniq=Po;m.uniqBy=Fo;m.uniqWith=Go;m.unset=Ml;m.unzip=$o;m.unzipWith=Ho;m.update=kl;m.updateWith=Ol;m.values=Nl;m.valuesIn=Il;m.without=Bo;m.words=fc;m.wrap=ta;m.xor=Vo;m.xorBy=jo;m.xorWith=zo;m.zip=Wo;m.zipObject=Uo;m.zipObjectDeep=Yo;m.zipWith=qo;m.entries=Tl;m.entriesIn=Dl;m.extend=Ka;m.extendWith=Xa;Tc(m,m);m.add=Uc;m.attempt=pc;m.camelCase=Gl;m.capitalize=$l;m.ceil=Yc;m.clamp=Ll;m.clone=na;m.cloneDeep=oa;m.cloneDeepWith=sa;m.cloneWith=ra;m.conformsTo=aa;m.deburr=Hl;m.defaultTo=bc;m.divide=qc;m.endsWith=Bl;m.eq=d;m.escape=Vl;m.escapeRegExp=jl;m.every=as;m.find=cs;m.findIndex=Xr;m.findKey=il;m.findLast=us;m.findLastIndex=Zr;m.findLastKey=nl;m.floor=Kc;m.forEach=ps;m.forEachRight=gs;m.forIn=rl;m.forInRight=ol;m.forOwn=sl;m.forOwnRight=al;m.get=ul;m.gt=la;m.gte=ca;m.has=dl;m.hasIn=hl;m.head=io;m.identity=F;m.includes=vs;m.indexOf=no;m.inRange=Pl;m.invoke=gl;m.isArguments=ua;m.isArray=R;m.isArrayBuffer=da;m.isArrayLike=u;m.isArrayLikeObject=g;m.isBoolean=ha;m.isBuffer=fa;m.isDate=pa;m.isElement=ga;m.isEmpty=ma;m.isEqual=va;m.isEqualWith=ya;m.isError=ba;m.isFinite=_a;m.isFunction=wa;m.isInteger=Ca;m.isLength=xa;m.isMap=Sa;m.isMatch=Aa;m.isMatchWith=Ea;m.isNaN=Ta;m.isNative=Da;m.isNil=Ma;m.isNull=Ra;m.isNumber=ka;m.isObject=M;m.isObjectLike=h;m.isPlainObject=Oa;m.isRegExp=Na;m.isSafeInteger=Ia;m.isSet=La;m.isString=Pa;m.isSymbol=k;m.isTypedArray=Fa;m.isUndefined=Ga;m.isWeakMap=$a;m.isWeakSet=Ha;m.join=lo;m.kebabCase=zl;m.last=o;m.lastIndexOf=co;m.lowerCase=Wl;m.lowerFirst=Ul;m.lt=Ba;m.lte=Va;m.max=Xc;m.maxBy=Zc;m.mean=Qc;m.meanBy=Jc;m.min=eu;m.minBy=tu;m.stubArray=Gc;m.stubFalse=$c;m.stubObject=Hc;m.stubString=Bc;m.stubTrue=Vc;m.multiply=iu;m.nth=uo;m.noConflict=Dc;m.noop=Rc;m.now=Os;m.pad=Yl;m.padEnd=ql;m.padStart=Kl;m.parseInt=Xl;m.random=Fl;m.reduce=xs;m.reduceRight=Ss;m.repeat=Zl;m.replace=Ql;m.result=Sl;m.round=nu;m.runInContext=t;m.sample=Es;m.size=Rs;m.snakeCase=Jl;m.some=Ms;m.sortedIndex=_o;m.sortedIndexBy=wo;m.sortedIndexOf=Co;m.sortedLastIndex=xo;m.sortedLastIndexBy=So;m.sortedLastIndexOf=Ao;m.startCase=tc;m.startsWith=ic;m.subtract=ru;m.sum=ou;m.sumBy=su;m.template=nc;m.times=jc;m.toFinite=za;m.toInteger=O;m.toLength=Wa;m.toLower=rc;m.toNumber=N;m.toSafeInteger=Ya;m.toString=I;m.toUpper=oc;m.trim=sc;m.trimEnd=ac;m.trimStart=lc;m.truncate=cc;m.unescape=uc;m.uniqueId=Wc;m.upperCase=dc;m.upperFirst=hc;m.each=ps;m.eachRight=gs;m.first=io;Tc(m,function(){var i={};s(m,function(e,t){if(!x.call(m.prototype,t)){i[t]=e}});return i}(),{chain:false});m.VERSION=Hu;ku(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){m[e].placeholder=m});ku(["drop","take"],function(i,n){y.prototype[i]=function(e){e=e===au?1:S(O(e),0);var t=this.__filtered__&&!n?new y(this):this.clone();if(t.__filtered__){t.__takeCount__=E(e,t.__takeCount__)}else{t.__views__.push({size:E(e,wu),type:i+(t.__dir__<0?"Right":"")})}return t};y.prototype[i+"Right"]=function(e){return this.reverse()[i](e).reverse()}});ku(["filter","map","takeWhile"],function(e,t){var i=t+1,n=i==id||i==rd;y.prototype[e]=function(e){var t=this.clone();t.__iteratees__.push({iteratee:c(e,3),type:i});t.__filtered__=t.__filtered__||n;return t}});ku(["head","last"],function(e,t){var i="take"+(t?"Right":"");y.prototype[e]=function(){return this[i](1).value()[0]}});ku(["initial","tail"],function(e,t){var i="drop"+(t?"":"Right");y.prototype[e]=function(){return this.__filtered__?new y(this):this[i](1)}});y.prototype.compact=function(){return this.filter(F)};y.prototype.find=function(e){return this.filter(e).head()};y.prototype.findLast=function(e){return this.reverse().find(e)};y.prototype.invokeMap=i(function(t,i){if(typeof t=="function"){return new y(this)}return this.map(function(e){return ei(e,t,i)})});y.prototype.reject=function(e){return this.filter(Ws(c(e)))};y.prototype.slice=function(e,t){e=O(e);var i=this;if(i.__filtered__&&(e>0||t<0)){return new y(i)}if(e<0){i=i.takeRight(-e)}else if(e){i=i.drop(e)}if(t!==au){t=O(t);i=t<0?i.dropRight(-t):i.take(t-e)}return i};y.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()};y.prototype.toArray=function(){return this.take(wu)};s(y.prototype,function(d,e){var h=/^(?:filter|find|map|reject)|While$/.test(e),f=/^(?:head|last)$/.test(e),p=m[f?"take"+(e=="last"?"Right":""):e],g=f||/^find/.test(e);if(!p){return}m.prototype[e]=function(){var e=this.__wrapped__,i=f?[1]:arguments,t=e instanceof y,n=i[0],r=t||R(e);var o=function(e){var t=p.apply(m,Iu([e],i));return f&&s?t[0]:t};if(r&&h&&typeof n=="function"&&n.length!=1){t=r=false}var s=this.__chain__,a=!!this.__actions__.length,l=g&&!s,c=t&&!a;if(!g&&r){e=c?e:new y(this);var u=d.apply(e,i);u.__actions__.push({func:Zo,args:[o],thisArg:au});return new v(u,s)}if(l&&c){return d.apply(this,i)}u=this.thru(o);return l?f?u.value()[0]:u.value():u}});ku(["pop","push","shift","sort","splice","unshift"],function(e){var i=j[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);m.prototype[e]=function(){var t=arguments;if(r&&!this.__chain__){var e=this.value();return i.apply(R(e)?e:[],t)}return this[n](function(e){return i.apply(R(e)?e:[],t)})}});s(y.prototype,function(e,t){var i=m[t];if(i){var n=i.name+"";if(!x.call(Ne,n)){Ne[n]=[]}Ne[n].push({name:t,func:i})}});Ne[En(au,fu).name]=[{name:"wrapper",func:au}];y.prototype.clone=ze;y.prototype.reverse=We;y.prototype.value=Ue;m.prototype.at=Qo;m.prototype.chain=Jo;m.prototype.commit=es;m.prototype.next=ts;m.prototype.plant=ns;m.prototype.reverse=rs;m.prototype.toJSON=m.prototype.valueOf=m.prototype.value=os;m.prototype.first=m.prototype.head;if(ce){m.prototype[ce]=is}return m};var $u=ce();if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){Ru._=$u;define(function(){return $u})}else if(t){(t.exports=$u)._=$u;te._=$u}else{Ru._=$u}}).call(this);(function(i){var t=Array.prototype.slice;var n={dict:null,load:function(e){if(this.dict!==null){i.extend(this.dict,e)}else{this.dict=e}},_:function(e){dict=this.dict;if(dict&&dict.hasOwnProperty(e)){e=dict[e]}args=t.call(arguments);args[0]=e;return this.printf.apply(this,args)},printf:function(e,n){if(arguments.length<2)return e;n=i.isArray(n)?n:t.call(arguments,1);return e.replace(/([^%]|^)%(?:(\d+)\$)?s/g,function(e,t,i){if(i){return t+n[parseInt(i)-1]}return t+n.shift()}).replace(/%%s/g,"%s")}};i.fn._t=function(e,t){return i(this).html(n._.apply(n,arguments))};i.i18n=n})(jQuery);(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports=="object"&&typeof module=="object"){module.exports=e(require("jquery"))}else{e(jQuery)}})(function(Ge,$e){"use strict";var n={beforeShow:e,move:e,change:e,show:e,hide:e,color:false,flat:false,showInput:false,allowEmpty:false,showButtons:true,clickoutFiresChange:true,showInitial:false,showPalette:false,showPaletteOnly:false,hideAfterPaletteSelect:false,togglePaletteOnly:false,showSelectionPalette:true,localStorageKey:false,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:false,className:"",containerClassName:"",replacerClassName:"",showAlpha:false,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:false,offset:null},He=[],Be=!!/msie/i.exec(window.navigator.userAgent),Ve=function(){function e(e,t){return!!~(""+e).indexOf(t)}var t=document.createElement("div");var i=t.style;i.cssText="background-color:rgba(0,0,0,.5)";return e(i.backgroundColor,"rgba")||e(i.backgroundColor,"hsla")}(),je=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),ze=function(){var e="";if(Be){for(var t=1;t<=6;t++){e+="<div class='sp-"+t+"'></div>"}}return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function We(e,t,i,n){var r=[];for(var o=0;o<e.length;o++){var s=e[o];if(s){var a=tinycolor(s);var l=a.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";l+=tinycolor.equals(t,s)?" sp-thumb-active":"";var c=a.toString(n.preferredFormat||"rgb");var u=Ve?"background-color:"+a.toRgbString():"filter:"+a.toFilter();r.push('<span title="'+c+'" data-color="'+a.toRgbString()+'" class="'+l+'"><span class="sp-thumb-inner" style="'+u+';"></span></span>')}else{var d="sp-clear-display";r.push(Ge("<div />").append(Ge('<span data-color="" style="background-color:transparent;" class="'+d+'"></span>').attr("title",n.noColorSelectedText)).html())}}return"<div class='sp-cf "+i+"'>"+r.join("")+"</div>"}function Ue(){for(var e=0;e<He.length;e++){if(He[e]){He[e].hide()}}}function Ye(e,t){var i=Ge.extend({},n,e);i.callbacks={move:r(i.move,t),change:r(i.change,t),show:r(i.show,t),hide:r(i.hide,t),beforeShow:r(i.beforeShow,t)};return i}function o(e,F){var c=Ye(F,e),n=c.flat,G=c.showSelectionPalette,i=c.localStorageKey,$=c.theme,r=c.callbacks,H=Ze(P,10),t=false,B=false,l=0,u=0,s=0,a=0,V=0,j=0,z=0,W=0,d=0,h=0,f=0,p=1,U=[],o=[],Y={},g=c.selectionPalette.slice(0),q=c.maxSelectionSize,K="sp-dragging",m=null;var v=e.ownerDocument,X=v.body,y=Ge(e),Z=false,b=Ge(ze,v).addClass($),Q=b.find(".sp-picker-container"),J=b.find(".sp-color"),ee=b.find(".sp-dragger"),te=b.find(".sp-hue"),ie=b.find(".sp-slider"),_=b.find(".sp-alpha-inner"),ne=b.find(".sp-alpha"),re=b.find(".sp-alpha-handle"),w=b.find(".sp-input"),oe=b.find(".sp-palette"),se=b.find(".sp-initial"),ae=b.find(".sp-cancel"),le=b.find(".sp-clear"),ce=b.find(".sp-choose"),ue=b.find(".sp-palette-toggle"),de=y.is("input"),he=de&&y.attr("type")==="color"&&Qe(),fe=de&&!n,C=fe?Ge(je).addClass($).addClass(c.className).addClass(c.replacerClassName):Ge([]),x=fe?C:y,S=C.find(".sp-preview-inner"),A=c.color||de&&y.val(),E=false,T=c.preferredFormat,pe=!c.showButtons||c.clickoutFiresChange,D=!A,R=c.allowEmpty&&!he;function ge(){if(c.showPaletteOnly){c.showPalette=true}ue.text(c.showPaletteOnly?c.togglePaletteMoreText:c.togglePaletteLessText);if(c.palette){U=c.palette.slice(0);o=Ge.isArray(U[0])?U:[U];Y={};for(var e=0;e<o.length;e++){for(var t=0;t<o[e].length;t++){var i=tinycolor(o[e][t]).toRgbString();Y[i]=true}}}b.toggleClass("sp-flat",n);b.toggleClass("sp-input-disabled",!c.showInput);b.toggleClass("sp-alpha-enabled",c.showAlpha);b.toggleClass("sp-clear-enabled",R);b.toggleClass("sp-buttons-disabled",!c.showButtons);b.toggleClass("sp-palette-buttons-disabled",!c.togglePaletteOnly);b.toggleClass("sp-palette-disabled",!c.showPalette);b.toggleClass("sp-palette-only",c.showPaletteOnly);b.toggleClass("sp-initial-disabled",!c.showInitial);b.addClass(c.className).addClass(c.containerClassName);P()}function me(){if(Be){b.find("*:not(input)").attr("unselectable","on")}ge();if(fe){y.after(C).hide()}if(!R){le.hide()}if(n){y.after(b).hide()}else{var e=c.appendTo==="parent"?y.parent():Ge(c.appendTo);if(e.length!==1){e=Ge("body")}e.append(b)}ve();x.on("click.spectrum touchstart.spectrum",function(e){if(!Z){Ae()}e.stopPropagation();if(!Ge(e.target).is("input")){e.preventDefault()}});if(y.is(":disabled")||c.disabled===true){Le()}b.click(Ke);w.change(Se);w.on("paste",function(){setTimeout(Se,1)});w.keydown(function(e){if(e.keyCode==13){Se()}});ae.text(c.cancelText);ae.on("click.spectrum",function(e){e.stopPropagation();e.preventDefault();Re();M()});le.attr("title",c.clearText);le.on("click.spectrum",function(e){e.stopPropagation();e.preventDefault();D=true;N();if(n){L(true)}});ce.text(c.chooseText);ce.on("click.spectrum",function(e){e.stopPropagation();e.preventDefault();if(Be&&w.is(":focus")){w.trigger("change")}if(Me()){L(true);M()}});ue.text(c.showPaletteOnly?c.togglePaletteMoreText:c.togglePaletteLessText);ue.on("click.spectrum",function(e){e.stopPropagation();e.preventDefault();c.showPaletteOnly=!c.showPaletteOnly;if(!c.showPaletteOnly&&!n){b.css("left","-="+(Q.outerWidth(true)+5))}ge()});Xe(ne,function(e,t,i){p=e/j;D=false;if(i.shiftKey){p=Math.round(p*10)/10}N()},Ce,xe);Xe(te,function(e,t){d=parseFloat(t/a);D=false;if(!c.showAlpha){p=1}N()},Ce,xe);Xe(J,function(e,t,i){if(!i.shiftKey){m=null}else if(!m){var n=h*l;var r=u-f*u;var o=Math.abs(e-n)>Math.abs(t-r);m=o?"x":"y"}var s=!m||m==="x";var a=!m||m==="y";if(s){h=parseFloat(e/l)}if(a){f=parseFloat((u-t)/u)}D=false;if(!c.showAlpha){p=1}N()},Ce,xe);if(!!A){k(A);I();T=c.preferredFormat||tinycolor(A).format;ye(A)}else{I()}if(n){Ee()}function t(e){if(e.data&&e.data.ignore){k(Ge(e.target).closest(".sp-thumb-el").data("color"));N()}else{k(Ge(e.target).closest(".sp-thumb-el").data("color"));N();if(c.hideAfterPaletteSelect){L(true);M()}else{L()}}return false}var i=Be?"mousedown.spectrum":"click.spectrum touchstart.spectrum";oe.on(i,".sp-thumb-el",t);se.on(i,".sp-thumb-el:nth-child(1)",{ignore:true},t)}function ve(){if(i&&window.localStorage){try{var e=window.localStorage[i].split(",#");if(e.length>1){delete window.localStorage[i];Ge.each(e,function(e,t){ye(t)})}}catch(e){}try{g=window.localStorage[i].split(";")}catch(e){}}}function ye(e){if(G){var t=tinycolor(e).toRgbString();if(!Y[t]&&Ge.inArray(t,g)===-1){g.push(t);while(g.length>q){g.shift()}}if(i&&window.localStorage){try{window.localStorage[i]=g.join(";")}catch(e){}}}}function be(){var e=[];if(c.showPalette){for(var t=0;t<g.length;t++){var i=tinycolor(g[t]).toRgbString();if(!Y[i]){e.push(g[t])}}}return e.reverse().slice(0,c.maxSelectionSize)}function _e(){var i=O();var e=Ge.map(o,function(e,t){return We(e,i,"sp-palette-row sp-palette-row-"+t,c)});ve();if(g){e.push(We(be(),i,"sp-palette-row sp-palette-row-selection",c))}oe.html(e.join(""))}function we(){if(c.showInitial){var e=E;var t=O();se.html(We([e,t],t,"sp-palette-row-initial",c))}}function Ce(){if(u<=0||l<=0||a<=0){P()}B=true;b.addClass(K);m=null;y.trigger("dragstart.spectrum",[O()])}function xe(){B=false;b.removeClass(K);y.trigger("dragstop.spectrum",[O()])}function Se(){var e=w.val();if((e===null||e==="")&&R){k(null);N();L()}else{var t=tinycolor(e);if(t.isValid()){k(t);N();L()}else{w.addClass("sp-validation-error")}}}function Ae(){if(t){M()}else{Ee()}}function Ee(){var e=Ge.Event("beforeShow.spectrum");if(t){P();return}y.trigger(e,[O()]);if(r.beforeShow(O())===false||e.isDefaultPrevented()){return}Ue();t=true;Ge(v).on("keydown.spectrum",Te);Ge(v).on("click.spectrum",De);Ge(window).on("resize.spectrum",H);C.addClass("sp-active");b.removeClass("sp-hidden");P();I();E=O();we();r.show(E);y.trigger("show.spectrum",[E])}function Te(e){if(e.keyCode===27){M()}}function De(e){if(e.button==2){return}if(B){return}if(pe){L(true)}else{Re()}M()}function M(){if(!t||n){return}t=false;Ge(v).off("keydown.spectrum",Te);Ge(v).off("click.spectrum",De);Ge(window).off("resize.spectrum",H);C.removeClass("sp-active");b.addClass("sp-hidden");r.hide(O());y.trigger("hide.spectrum",[O()])}function Re(){k(E,true);L(true)}function k(e,t){if(tinycolor.equals(e,O())){I();return}var i,n;if(!e&&R){D=true}else{D=false;i=tinycolor(e);n=i.toHsv();d=n.h%360/360;h=n.s;f=n.v;p=n.a}I();if(i&&i.isValid()&&!t){T=c.preferredFormat||i.getFormat()}}function O(e){e=e||{};if(R&&D){return null}return tinycolor.fromRatio({h:d,s:h,v:f,a:Math.round(p*1e3)/1e3},{format:e.format||T})}function Me(){return!w.hasClass("sp-validation-error")}function N(){I();r.move(O());y.trigger("move.spectrum",[O()])}function I(){w.removeClass("sp-validation-error");ke();var e=tinycolor.fromRatio({h:d,s:1,v:1});J.css("background-color",e.toHexString());var t=T;if(p<1&&!(p===0&&t==="name")){if(t==="hex"||t==="hex3"||t==="hex6"||t==="name"){t="rgb"}}var i=O({format:t}),n="";S.removeClass("sp-clear-display");S.css("background-color","transparent");if(!i&&R){S.addClass("sp-clear-display")}else{var r=i.toHexString(),o=i.toRgbString();if(Ve||i.alpha===1){S.css("background-color",o)}else{S.css("background-color","transparent");S.css("filter",i.toFilter())}if(c.showAlpha){var s=i.toRgb();s.a=0;var a=tinycolor(s).toRgbString();var l="linear-gradient(left, "+a+", "+r+")";if(Be){_.css("filter",tinycolor(a).toFilter({gradientType:1},r))}else{_.css("background","-webkit-"+l);_.css("background","-moz-"+l);_.css("background","-ms-"+l);_.css("background","linear-gradient(to right, "+a+", "+r+")")}}n=i.toString(t)}if(c.showInput){w.val(n)}if(c.showPalette){_e()}we()}function ke(){var e=h;var t=f;if(R&&D){re.hide();ie.hide();ee.hide()}else{re.show();ie.show();ee.show();var i=e*l;var n=u-t*u;i=Math.max(-s,Math.min(l-s,i-s));n=Math.max(-s,Math.min(u-s,n-s));ee.css({top:n+"px",left:i+"px"});var r=p*j;re.css({left:r-z/2+"px"});var o=d*a;ie.css({top:o-W+"px"})}}function L(e){var t=O(),i="",n=!tinycolor.equals(t,E);if(t){i=t.toString(T);ye(t)}if(de){y.val(i)}if(e&&n){r.change(t);y.trigger("change",[t])}}function P(){if(!t){return}l=J.width();u=J.height();s=ee.height();V=te.width();a=te.height();W=ie.height();j=ne.width();z=re.width();if(!n){b.css("position","absolute");if(c.offset){b.offset(c.offset)}else{b.offset(qe(b,x))}}ke();if(c.showPalette){_e()}y.trigger("reflow.spectrum")}function Oe(){y.show();x.off("click.spectrum touchstart.spectrum");b.remove();C.remove();He[Fe.id]=null}function Ne(e,t){if(e===$e){return Ge.extend({},c)}if(t===$e){return c[e]}c[e]=t;if(e==="preferredFormat"){T=c.preferredFormat}ge()}function Ie(){Z=false;y.attr("disabled",false);x.removeClass("sp-disabled")}function Le(){M();Z=true;y.attr("disabled",true);x.addClass("sp-disabled")}function Pe(e){c.offset=e;P()}me();var Fe={show:Ee,hide:M,toggle:Ae,reflow:P,option:Ne,enable:Ie,disable:Le,offset:Pe,set:function(e){k(e);L()},get:O,destroy:Oe,container:b};Fe.id=He.push(Fe)-1;return Fe}function qe(e,t){var i=0;var n=e.outerWidth();var r=e.outerHeight();var o=t.outerHeight();var s=e[0].ownerDocument;var a=s.documentElement;var l=a.clientWidth+Ge(s).scrollLeft();var c=a.clientHeight+Ge(s).scrollTop();var u=t.offset();var d=u.left;var h=u.top;h+=o;d-=Math.min(d,d+n>l&&l>n?Math.abs(d+n-l):0);h-=Math.min(h,h+r>c&&c>r?Math.abs(r+o-i):i);return{top:h,bottom:u.bottom,left:d,right:u.right,width:u.width,height:u.height}}function e(){}function Ke(e){e.stopPropagation()}function r(e,t){var i=Array.prototype.slice;var n=i.call(arguments,2);return function(){return e.apply(t,n.concat(i.call(arguments)))}}function Xe(s,a,i,e){a=a||function(){};i=i||function(){};e=e||function(){};var l=document;var c=false;var u={};var d=0;var h=0;var f="ontouchstart"in window;var n={};n["selectstart"]=p;n["dragstart"]=p;n["touchmove mousemove"]=r;n["touchend mouseup"]=g;function p(e){if(e.stopPropagation){e.stopPropagation()}if(e.preventDefault){e.preventDefault()}e.returnValue=false}function r(e){if(c){if(Be&&l.documentMode<9&&!e.button){return g()}var t=e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches[0];var i=t&&t.pageX||e.pageX;var n=t&&t.pageY||e.pageY;var r=Math.max(0,Math.min(i-u.left,h));var o=Math.max(0,Math.min(n-u.top,d));if(f){p(e)}a.apply(s,[r,o,e])}}function t(e){var t=e.which?e.which==3:e.button==2;if(!t&&!c){if(i.apply(s,arguments)!==false){c=true;d=Ge(s).height();h=Ge(s).width();u=Ge(s).offset();Ge(l).on(n);Ge(l.body).addClass("sp-dragging");r(e);p(e)}}}function g(){if(c){Ge(l).off(n);Ge(l.body).removeClass("sp-dragging");setTimeout(function(){e.apply(s,arguments)},0)}c=false}Ge(s).on("touchstart mousedown",t)}function Ze(n,r,o){var s;return function(){var e=this,t=arguments;var i=function(){s=null;n.apply(e,t)};if(o)clearTimeout(s);if(o||!s)s=setTimeout(i,r)}}function Qe(){return Ge.fn.spectrum.inputTypeColorSupport()}var s="spectrum.id";Ge.fn.spectrum=function(i,e){if(typeof i=="string"){var n=this;var r=Array.prototype.slice.call(arguments,1);this.each(function(){var e=He[Ge(this).data(s)];if(e){var t=e[i];if(!t){throw new Error("Spectrum: no such method: '"+i+"'")}if(i=="get"){n=e.get()}else if(i=="container"){n=e.container}else if(i=="option"){n=e.option.apply(e,r)}else if(i=="destroy"){e.destroy();Ge(this).removeData(s)}else{t.apply(e,r)}}});return n}return this.spectrum("destroy").each(function(){var e=Ge.extend({},Ge(this).data(),i);var t=o(this,e);Ge(this).data(s,t.id)})};Ge.fn.spectrum.load=true;Ge.fn.spectrum.loadOpts={};Ge.fn.spectrum.draggable=Xe;Ge.fn.spectrum.defaults=n;Ge.fn.spectrum.inputTypeColorSupport=function e(){if(typeof e._cachedResult==="undefined"){var t=Ge("<input type='color'/>")[0];e._cachedResult=t.type==="color"&&t.value!==""}return e._cachedResult};Ge.spectrum={};Ge.spectrum.localization={};Ge.spectrum.palettes={};Ge.fn.spectrum.processNativeColorInputs=function(){var e=Ge("input[type=color]");if(e.length&&!Qe()){e.spectrum({preferredFormat:"hex6"})}};(function(){var n=/^[\s,#]+/,r=/\s+$/,o=0,h=Math,s=h.round,c=h.min,u=h.max,e=h.random;var d=function(e,t){e=e?e:"";t=t||{};if(e instanceof d){return e}if(!(this instanceof d)){return new d(e,t)}var i=a(e);this._originalInput=e;this._r=i.r;this._g=i.g;this._b=i.b;this._a=i.a;this._roundA=s(1e3*this._a)/1e3;this._format=t.format||i.format;this._gradientType=t.gradientType;if(this._r<1){this._r=s(this._r)}if(this._g<1){this._g=s(this._g)}if(this._b<1){this._b=s(this._b)}this._ok=i.ok;this._tc_id=o++};d.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},setAlpha:function(e){this._a=R(e);this._roundA=s(1e3*this._a)/1e3;return this},toHsv:function(){var e=g(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=g(this._r,this._g,this._b);var t=s(e.h*360),i=s(e.s*100),n=s(e.v*100);return this._a==1?"hsv("+t+", "+i+"%, "+n+"%)":"hsva("+t+", "+i+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var e=f(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=f(this._r,this._g,this._b);var t=s(e.h*360),i=s(e.s*100),n=s(e.l*100);return this._a==1?"hsl("+t+", "+i+"%, "+n+"%)":"hsla("+t+", "+i+"%, "+n+"%, "+this._roundA+")"},toHex:function(e){return t(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(){return v(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:s(this._r),g:s(this._g),b:s(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+s(this._r)+", "+s(this._g)+", "+s(this._b)+")":"rgba("+s(this._r)+", "+s(this._g)+", "+s(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:s(M(this._r,255)*100)+"%",g:s(M(this._g,255)*100)+"%",b:s(M(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+s(M(this._r,255)*100)+"%, "+s(M(this._g,255)*100)+"%, "+s(M(this._b,255)*100)+"%)":"rgba("+s(M(this._r,255)*100)+"%, "+s(M(this._g,255)*100)+"%, "+s(M(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){if(this._a===0){return"transparent"}if(this._a<1){return false}return G[t(this._r,this._g,this._b,true)]||false},toFilter:function(e){var t="#"+v(this._r,this._g,this._b,this._a);var i=t;var n=this._gradientType?"GradientType = 1, ":"";if(e){var r=d(e);i=r.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+t+",endColorstr="+i+")"},toString:function(e){var t=!!e;e=e||this._format;var i=false;var n=this._a<1&&this._a>=0;var r=!t&&n&&(e==="hex"||e==="hex6"||e==="hex3"||e==="name");if(r){if(e==="name"&&this._a===0){return this.toName()}return this.toRgbString()}if(e==="rgb"){i=this.toRgbString()}if(e==="prgb"){i=this.toPercentageRgbString()}if(e==="hex"||e==="hex6"){i=this.toHexString()}if(e==="hex3"){i=this.toHexString(true)}if(e==="hex8"){i=this.toHex8String()}if(e==="name"){i=this.toName()}if(e==="hsl"){i=this.toHslString()}if(e==="hsv"){i=this.toHsvString()}return i||this.toHexString()},_applyModification:function(e,t){var i=e.apply(null,[this].concat([].slice.call(t)));this._r=i._r;this._g=i._g;this._b=i._b;this.setAlpha(i._a);return this},lighten:function(){return this._applyModification(_,arguments)},brighten:function(){return this._applyModification(w,arguments)},darken:function(){return this._applyModification(C,arguments)},desaturate:function(){return this._applyModification(i,arguments)},saturate:function(){return this._applyModification(y,arguments)},greyscale:function(){return this._applyModification(b,arguments)},spin:function(){return this._applyModification(x,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(P,arguments)},complement:function(){return this._applyCombination(S,arguments)},monochromatic:function(){return this._applyCombination(F,arguments)},splitcomplement:function(){return this._applyCombination(T,arguments)},triad:function(){return this._applyCombination(A,arguments)},tetrad:function(){return this._applyCombination(E,arguments)}};d.fromRatio=function(e,t){if(typeof e=="object"){var i={};for(var n in e){if(e.hasOwnProperty(n)){if(n==="a"){i[n]=e[n]}else{i[n]=I(e[n])}}}e=i}return d(e,t)};function a(e){var t={r:0,g:0,b:0};var i=1;var n=false;var r=false;if(typeof e=="string"){e=z(e)}if(typeof e=="object"){if(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b")){t=l(e.r,e.g,e.b);n=true;r=String(e.r).substr(-1)==="%"?"prgb":"rgb"}else if(e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")){e.s=I(e.s);e.v=I(e.v);t=m(e.h,e.s,e.v);n=true;r="hsv"}else if(e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")){e.s=I(e.s);e.l=I(e.l);t=p(e.h,e.s,e.l);n=true;r="hsl"}if(e.hasOwnProperty("a")){i=e.a}}i=R(i);return{ok:n,format:e.format||r,r:c(255,u(t.r,0)),g:c(255,u(t.g,0)),b:c(255,u(t.b,0)),a:i}}function l(e,t,i){return{r:M(e,255)*255,g:M(t,255)*255,b:M(i,255)*255}}function f(e,t,i){e=M(e,255);t=M(t,255);i=M(i,255);var n=u(e,t,i),r=c(e,t,i);var o,s,a=(n+r)/2;if(n==r){o=s=0}else{var l=n-r;s=a>.5?l/(2-n-r):l/(n+r);switch(n){case e:o=(t-i)/l+(t<i?6:0);break;case t:o=(i-e)/l+2;break;case i:o=(e-t)/l+4;break}o/=6}return{h:o,s:s,l:a}}function p(e,t,i){var n,r,o;e=M(e,360);t=M(t,100);i=M(i,100);function s(e,t,i){if(i<0)i+=1;if(i>1)i-=1;if(i<1/6)return e+(t-e)*6*i;if(i<1/2)return t;if(i<2/3)return e+(t-e)*(2/3-i)*6;return e}if(t===0){n=r=o=i}else{var a=i<.5?i*(1+t):i+t-i*t;var l=2*i-a;n=s(l,a,e+1/3);r=s(l,a,e);o=s(l,a,e-1/3)}return{r:n*255,g:r*255,b:o*255}}function g(e,t,i){e=M(e,255);t=M(t,255);i=M(i,255);var n=u(e,t,i),r=c(e,t,i);var o,s,a=n;var l=n-r;s=n===0?0:l/n;if(n==r){o=0}else{switch(n){case e:o=(t-i)/l+(t<i?6:0);break;case t:o=(i-e)/l+2;break;case i:o=(e-t)/l+4;break}o/=6}return{h:o,s:s,v:a}}function m(e,t,i){e=M(e,360)*6;t=M(t,100);i=M(i,100);var n=h.floor(e),r=e-n,o=i*(1-t),s=i*(1-r*t),a=i*(1-(1-r)*t),l=n%6,c=[i,s,o,o,a,i][l],u=[a,i,i,s,o,o][l],d=[o,o,a,i,i,s][l];return{r:c*255,g:u*255,b:d*255}}function t(e,t,i,n){var r=[N(s(e).toString(16)),N(s(t).toString(16)),N(s(i).toString(16))];if(n&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)){return r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0)}return r.join("")}function v(e,t,i,n){var r=[N(V(n)),N(s(e).toString(16)),N(s(t).toString(16)),N(s(i).toString(16))];return r.join("")}d.equals=function(e,t){if(!e||!t){return false}return d(e).toRgbString()==d(t).toRgbString()};d.random=function(){return d.fromRatio({r:e(),g:e(),b:e()})};function i(e,t){t=t===0?0:t||10;var i=d(e).toHsl();i.s-=t/100;i.s=k(i.s);return d(i)}function y(e,t){t=t===0?0:t||10;var i=d(e).toHsl();i.s+=t/100;i.s=k(i.s);return d(i)}function b(e){return d(e).desaturate(100)}function _(e,t){t=t===0?0:t||10;var i=d(e).toHsl();i.l+=t/100;i.l=k(i.l);return d(i)}function w(e,t){t=t===0?0:t||10;var i=d(e).toRgb();i.r=u(0,c(255,i.r-s(255*-(t/100))));i.g=u(0,c(255,i.g-s(255*-(t/100))));i.b=u(0,c(255,i.b-s(255*-(t/100))));return d(i)}function C(e,t){t=t===0?0:t||10;var i=d(e).toHsl();i.l-=t/100;i.l=k(i.l);return d(i)}function x(e,t){var i=d(e).toHsl();var n=(s(i.h)+t)%360;i.h=n<0?360+n:n;return d(i)}function S(e){var t=d(e).toHsl();t.h=(t.h+180)%360;return d(t)}function A(e){var t=d(e).toHsl();var i=t.h;return[d(e),d({h:(i+120)%360,s:t.s,l:t.l}),d({h:(i+240)%360,s:t.s,l:t.l})]}function E(e){var t=d(e).toHsl();var i=t.h;return[d(e),d({h:(i+90)%360,s:t.s,l:t.l}),d({h:(i+180)%360,s:t.s,l:t.l}),d({h:(i+270)%360,s:t.s,l:t.l})]}function T(e){var t=d(e).toHsl();var i=t.h;return[d(e),d({h:(i+72)%360,s:t.s,l:t.l}),d({h:(i+216)%360,s:t.s,l:t.l})]}function P(e,t,i){t=t||6;i=i||30;var n=d(e).toHsl();var r=360/i;var o=[d(e)];for(n.h=(n.h-(r*t>>1)+720)%360;--t;){n.h=(n.h+r)%360;o.push(d(n))}return o}function F(e,t){t=t||6;var i=d(e).toHsv();var n=i.h,r=i.s,o=i.v;var s=[];var a=1/t;while(t--){s.push(d({h:n,s:r,v:o}));o=(o+a)%1}return s}d.mix=function(e,t,i){i=i===0?0:i||50;var n=d(e).toRgb();var r=d(t).toRgb();var o=i/100;var s=o*2-1;var a=r.a-n.a;var l;if(s*a==-1){l=s}else{l=(s+a)/(1+s*a)}l=(l+1)/2;var c=1-l;var u={r:r.r*l+n.r*c,g:r.g*l+n.g*c,b:r.b*l+n.b*c,a:r.a*o+n.a*(1-o)};return d(u)};d.readability=function(e,t){var i=d(e);var n=d(t);var r=i.toRgb();var o=n.toRgb();var s=i.getBrightness();var a=n.getBrightness();var l=Math.max(r.r,o.r)-Math.min(r.r,o.r)+Math.max(r.g,o.g)-Math.min(r.g,o.g)+Math.max(r.b,o.b)-Math.min(r.b,o.b);return{brightness:Math.abs(s-a),color:l}};d.isReadable=function(e,t){var i=d.readability(e,t);return i.brightness>125&&i.color>500};d.mostReadable=function(e,t){var i=null;var n=0;var r=false;for(var o=0;o<t.length;o++){var s=d.readability(e,t[o]);var a=s.brightness>125&&s.color>500;var l=3*(s.brightness/125)+s.color/500;if(a&&!r||a&&r&&l>n||!a&&!r&&l>n){r=a;n=l;i=d(t[o])}}return i};var D=d.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};var G=d.hexNames=$(D);function $(e){var t={};for(var i in e){if(e.hasOwnProperty(i)){t[e[i]]=i}}return t}function R(e){e=parseFloat(e);if(isNaN(e)||e<0||e>1){e=1}return e}function M(e,t){if(H(e)){e="100%"}var i=B(e);e=c(t,u(0,parseFloat(e)));if(i){e=parseInt(e*t,10)/100}if(h.abs(e-t)<1e-6){return 1}return e%t/parseFloat(t)}function k(e){return c(1,u(0,e))}function O(e){return parseInt(e,16)}function H(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function B(e){return typeof e==="string"&&e.indexOf("%")!=-1}function N(e){return e.length==1?"0"+e:""+e}function I(e){if(e<=1){e=e*100+"%"}return e}function V(e){return Math.round(parseFloat(e)*255).toString(16)}function j(e){return O(e)/255}var L=function(){var e="[-\\+]?\\d+%?";var t="[-\\+]?\\d*\\.\\d+%?";var i="(?:"+t+")|(?:"+e+")";var n="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?";var r="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?";return{rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+r),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function z(e){e=e.replace(n,"").replace(r,"").toLowerCase();var t=false;if(D[e]){e=D[e];t=true}else if(e=="transparent"){return{r:0,g:0,b:0,a:0,format:"name"}}var i;if(i=L.rgb.exec(e)){return{r:i[1],g:i[2],b:i[3]}}if(i=L.rgba.exec(e)){return{r:i[1],g:i[2],b:i[3],a:i[4]}}if(i=L.hsl.exec(e)){return{h:i[1],s:i[2],l:i[3]}}if(i=L.hsla.exec(e)){return{h:i[1],s:i[2],l:i[3],a:i[4]}}if(i=L.hsv.exec(e)){return{h:i[1],s:i[2],v:i[3]}}if(i=L.hsva.exec(e)){return{h:i[1],s:i[2],v:i[3],a:i[4]}}if(i=L.hex8.exec(e)){return{a:j(i[1]),r:O(i[2]),g:O(i[3]),b:O(i[4]),format:t?"name":"hex8"}}if(i=L.hex6.exec(e)){return{r:O(i[1]),g:O(i[2]),b:O(i[3]),format:t?"name":"hex"}}if(i=L.hex3.exec(e)){return{r:O(i[1]+""+i[1]),g:O(i[2]+""+i[2]),b:O(i[3]+""+i[3]),format:t?"name":"hex"}}return false}window.tinycolor=d})();Ge(function(){if(Ge.fn.spectrum.load){Ge.fn.spectrum.processNativeColorInputs()}})});(function(i){if(typeof define==="function"&&define.amd){define(["jquery"],i)}else if(typeof module==="object"&&module.exports){module.exports=function(e,t){if(t===undefined){if(typeof window!=="undefined"){t=require("jquery")}else{t=require("jquery")(e)}}i(t);return t}}else{i(jQuery)}})(function(i){var e=function(){if(i&&i.fn&&i.fn.select2&&i.fn.select2.amd){var t=i.fn.select2.amd}var t;(function(){if(!t||!t.requirejs){if(!t){t={}}else{r=t}var e,r,u;(function(f){var o,s,p,g,m={},v={},y={},b={},i=Object.prototype.hasOwnProperty,n=[].slice,_=/\.js$/;function w(e,t){return i.call(e,t)}function a(e,t){var i,n,r,o,s,a,l,c,u,d,h,f,p=t&&t.split("/"),g=y.map,m=g&&g["*"]||{};if(e){e=e.split("/");s=e.length-1;if(y.nodeIdCompat&&_.test(e[s])){e[s]=e[s].replace(_,"")}if(e[0].charAt(0)==="."&&p){f=p.slice(0,p.length-1);e=f.concat(e)}for(u=0;u<e.length;u++){h=e[u];if(h==="."){e.splice(u,1);u-=1}else if(h===".."){if(u===0||u===1&&e[2]===".."||e[u-1]===".."){continue}else if(u>0){e.splice(u-1,2);u-=2}}}e=e.join("/")}if((p||m)&&g){i=e.split("/");for(u=i.length;u>0;u-=1){n=i.slice(0,u).join("/");if(p){for(d=p.length;d>0;d-=1){r=g[p.slice(0,d).join("/")];if(r){r=r[n];if(r){o=r;a=u;break}}}}if(o){break}if(!l&&m&&m[n]){l=m[n];c=u}}if(!o&&l){o=l;a=c}if(o){i.splice(0,a,o);e=i.join("/")}}return e}function C(t,i){return function(){var e=n.call(arguments,0);if(typeof e[0]!=="string"&&e.length===1){e.push(null)}return s.apply(f,e.concat([t,i]))}}function l(t){return function(e){return a(e,t)}}function x(t){return function(e){m[t]=e}}function S(e){if(w(v,e)){var t=v[e];delete v[e];b[e]=true;o.apply(f,t)}if(!w(m,e)&&!w(b,e)){throw new Error("No "+e)}return m[e]}function c(e){var t,i=e?e.indexOf("!"):-1;if(i>-1){t=e.substring(0,i);e=e.substring(i+1,e.length)}return[t,e]}function A(e){return e?c(e):[]}p=function(e,t){var i,n=c(e),r=n[0],o=t[1];e=n[1];if(r){r=a(r,o);i=S(r)}if(r){if(i&&i.normalize){e=i.normalize(e,l(o))}else{e=a(e,o)}}else{e=a(e,o);n=c(e);r=n[0];e=n[1];if(r){i=S(r)}}return{f:r?r+"!"+e:e,n:e,pr:r,p:i}};function t(e){return function(){return y&&y.config&&y.config[e]||{}}}g={require:function(e){return C(e)},exports:function(e){var t=m[e];if(typeof t!=="undefined"){return t}else{return m[e]={}}},module:function(e){return{id:e,uri:"",exports:m[e],config:t(e)}}};o=function(e,t,i,n){var r,o,s,a,l,c,u=[],d=typeof i,h;n=n||e;c=A(n);if(d==="undefined"||d==="function"){t=!t.length&&i.length?["require","exports","module"]:t;for(l=0;l<t.length;l+=1){a=p(t[l],c);o=a.f;if(o==="require"){u[l]=g.require(e)}else if(o==="exports"){u[l]=g.exports(e);h=true}else if(o==="module"){r=u[l]=g.module(e)}else if(w(m,o)||w(v,o)||w(b,o)){u[l]=S(o)}else if(a.p){a.p.load(a.n,C(n,true),x(o),{});u[l]=m[o]}else{throw new Error(e+" missing "+o)}}s=i?i.apply(m[e],u):undefined;if(e){if(r&&r.exports!==f&&r.exports!==m[e]){m[e]=r.exports}else if(s!==f||!h){m[e]=s}}}else if(e){m[e]=i}};e=r=s=function(e,t,i,n,r){if(typeof e==="string"){if(g[e]){return g[e](t)}return S(p(e,A(t)).f)}else if(!e.splice){y=e;if(y.deps){s(y.deps,y.callback)}if(!t){return}if(t.splice){e=t;t=i;i=null}else{e=f}}t=t||function(){};if(typeof i==="function"){i=n;n=r}if(n){o(f,e,t,i)}else{setTimeout(function(){o(f,e,t,i)},4)}return s};s.config=function(e){return s(e)};e._defined=m;u=function(e,t,i){if(typeof e!=="string"){throw new Error("See almond README: incorrect module build, no module name")}if(!t.splice){i=t;t=[]}if(!w(m,e)&&!w(v,e)){v[e]=[e,t,i]}};u.amd={jQuery:true}})();t.requirejs=e;t.require=r;t.define=u}})();t.define("almond",function(){});t.define("jquery",[],function(){var e=i||$;if(e==null&&console&&console.error){console.error("Select2: An instance of jQuery or a jQuery-compatible library was not "+"found. Make sure that you are including jQuery before Select2 on your "+"web page.")}return e});t.define("select2/utils",["jquery"],function(o){var r={};r.Extend=function(e,t){var i={}.hasOwnProperty;function n(){this.constructor=e}for(var r in t){if(i.call(t,r)){e[r]=t[r]}}n.prototype=t.prototype;e.prototype=new n;e.__super__=t.prototype;return e};function d(e){var t=e.prototype;var i=[];for(var n in t){var r=t[n];if(typeof r!=="function"){continue}if(n==="constructor"){continue}i.push(n)}return i}r.Decorate=function(n,r){var e=d(r);var t=d(n);function o(){var e=Array.prototype.unshift;var t=r.prototype.constructor.length;var i=n.prototype.constructor;if(t>0){e.call(arguments,n.prototype.constructor);i=r.prototype.constructor}i.apply(this,arguments)}r.displayName=n.displayName;function i(){this.constructor=o}o.prototype=new i;for(var s=0;s<t.length;s++){var a=t[s];o.prototype[a]=n.prototype[a]}var l=function(e){var t=function(){};if(e in o.prototype){t=o.prototype[e]}var i=r.prototype[e];return function(){var e=Array.prototype.unshift;e.call(arguments,t);return i.apply(this,arguments)}};for(var c=0;c<e.length;c++){var u=e[c];o.prototype[u]=l(u)}return o};var e=function(){this.listeners={}};e.prototype.on=function(e,t){this.listeners=this.listeners||{};if(e in this.listeners){this.listeners[e].push(t)}else{this.listeners[e]=[t]}};e.prototype.trigger=function(e){var t=Array.prototype.slice;var i=t.call(arguments,1);this.listeners=this.listeners||{};if(i==null){i=[]}if(i.length===0){i.push({})}i[0]._type=e;if(e in this.listeners){this.invoke(this.listeners[e],t.call(arguments,1))}if("*"in this.listeners){this.invoke(this.listeners["*"],arguments)}};e.prototype.invoke=function(e,t){for(var i=0,n=e.length;i<n;i++){e[i].apply(this,t)}};r.Observable=e;r.generateChars=function(e){var t="";for(var i=0;i<e;i++){var n=Math.floor(Math.random()*36);t+=n.toString(36)}return t};r.bind=function(e,t){return function(){e.apply(t,arguments)}};r._convertData=function(e){for(var t in e){var i=t.split("-");var n=e;if(i.length===1){continue}for(var r=0;r<i.length;r++){var o=i[r];o=o.substring(0,1).toLowerCase()+o.substring(1);if(!(o in n)){n[o]={}}if(r==i.length-1){n[o]=e[t]}n=n[o]}delete e[t]}return e};r.hasScroll=function(e,t){var i=o(t);var n=t.style.overflowX;var r=t.style.overflowY;if(n===r&&(r==="hidden"||r==="visible")){return false}if(n==="scroll"||r==="scroll"){return true}return i.innerHeight()<t.scrollHeight||i.innerWidth()<t.scrollWidth};r.escapeMarkup=function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};if(typeof e!=="string"){return e}return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})};r.__cache={};var i=0;r.GetUniqueElementId=function(e){var t=e.getAttribute("data-select2-id");if(t!=null){return t}if(e.id){t="select2-data-"+e.id}else{t="select2-data-"+(++i).toString()+"-"+r.generateChars(4)}e.setAttribute("data-select2-id",t);return t};r.StoreData=function(e,t,i){var n=r.GetUniqueElementId(e);if(!r.__cache[n]){r.__cache[n]={}}r.__cache[n][t]=i};r.GetData=function(e,t){var i=r.GetUniqueElementId(e);if(t){if(r.__cache[i]){if(r.__cache[i][t]!=null){return r.__cache[i][t]}return o(e).data(t)}return o(e).data(t)}else{return r.__cache[i]}};r.RemoveData=function(e){var t=r.GetUniqueElementId(e);if(r.__cache[t]!=null){delete r.__cache[t]}e.removeAttribute("data-select2-id")};r.copyNonInternalCssClasses=function(e,t){var i;var n=e.getAttribute("class").trim().split(/\s+/);n=n.filter(function(e){return e.indexOf("select2-")===0});var r=t.getAttribute("class").trim().split(/\s+/);r=r.filter(function(e){return e.indexOf("select2-")!==0});var o=n.concat(r);e.setAttribute("class",o.join(" "))};return r});t.define("select2/results",["jquery","./utils"],function(f,p){function n(e,t,i){this.$element=e;this.data=i;this.options=t;n.__super__.constructor.call(this)}p.Extend(n,p.Observable);n.prototype.render=function(){var e=f('<ul class="select2-results__options" role="listbox"></ul>');if(this.options.get("multiple")){e.attr("aria-multiselectable","true")}this.$results=e;return e};n.prototype.clear=function(){this.$results.empty()};n.prototype.displayMessage=function(e){var t=this.options.get("escapeMarkup");this.clear();this.hideLoading();var i=f('<li role="alert" aria-live="assertive"'+' class="select2-results__option"></li>');var n=this.options.get("translations").get(e.message);i.append(t(n(e.args)));i[0].className+=" select2-results__message";this.$results.append(i)};n.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()};n.prototype.append=function(e){this.hideLoading();var t=[];if(e.results==null||e.results.length===0){if(this.$results.children().length===0){this.trigger("results:message",{message:"noResults"})}return}e.results=this.sort(e.results);for(var i=0;i<e.results.length;i++){var n=e.results[i];var r=this.option(n);t.push(r)}this.$results.append(t)};n.prototype.position=function(e,t){var i=t.find(".select2-results");i.append(e)};n.prototype.sort=function(e){var t=this.options.get("sorter");return t(e)};n.prototype.highlightFirstItem=function(){var e=this.$results.find(".select2-results__option--selectable");var t=e.filter(".select2-results__option--selected");if(t.length>0){t.first().trigger("mouseenter")}else{e.first().trigger("mouseenter")}this.ensureHighlightVisible()};n.prototype.setClasses=function(){var i=this;this.data.current(function(e){var n=e.map(function(e){return e.id.toString()});var t=i.$results.find(".select2-results__option--selectable");t.each(function(){var e=f(this);var t=p.GetData(this,"data");var i=""+t.id;if(t.element!=null&&t.element.selected||t.element==null&&n.indexOf(i)>-1){this.classList.add("select2-results__option--selected");e.attr("aria-selected","true")}else{this.classList.remove("select2-results__option--selected");e.attr("aria-selected","false")}})})};n.prototype.showLoading=function(e){this.hideLoading();var t=this.options.get("translations").get("searching");var i={disabled:true,loading:true,text:t(e)};var n=this.option(i);n.className+=" loading-results";this.$results.prepend(n)};n.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()};n.prototype.option=function(e){var t=document.createElement("li");t.classList.add("select2-results__option");t.classList.add("select2-results__option--selectable");var i={role:"option"};var n=window.Element.prototype.matches||window.Element.prototype.msMatchesSelector||window.Element.prototype.webkitMatchesSelector;if(e.element!=null&&n.call(e.element,":disabled")||e.element==null&&e.disabled){i["aria-disabled"]="true";t.classList.remove("select2-results__option--selectable");t.classList.add("select2-results__option--disabled")}if(e.id==null){t.classList.remove("select2-results__option--selectable")}if(e._resultId!=null){t.id=e._resultId}if(e.title){t.title=e.title}if(e.children){i.role="group";i["aria-label"]=e.text;t.classList.remove("select2-results__option--selectable");t.classList.add("select2-results__option--group")}for(var r in i){var o=i[r];t.setAttribute(r,o)}if(e.children){var s=f(t);var a=document.createElement("strong");a.className="select2-results__group";this.template(e,a);var l=[];for(var c=0;c<e.children.length;c++){var u=e.children[c];var d=this.option(u);l.push(d)}var h=f("<ul></ul>",{class:"select2-results__options select2-results__options--nested",role:"none"});h.append(l);s.append(a);s.append(h)}else{this.template(e,t)}p.StoreData(t,"data",e);return t};n.prototype.bind=function(t,e){var l=this;var i=t.id+"-results";this.$results.attr("id",i);t.on("results:all",function(e){l.clear();l.append(e.data);if(t.isOpen()){l.setClasses();l.highlightFirstItem()}});t.on("results:append",function(e){l.append(e.data);if(t.isOpen()){l.setClasses()}});t.on("query",function(e){l.hideMessages();l.showLoading(e)});t.on("select",function(){if(!t.isOpen()){return}l.setClasses();if(l.options.get("scrollAfterSelect")){l.highlightFirstItem()}});t.on("unselect",function(){if(!t.isOpen()){return}l.setClasses();if(l.options.get("scrollAfterSelect")){l.highlightFirstItem()}});t.on("open",function(){l.$results.attr("aria-expanded","true");l.$results.attr("aria-hidden","false");l.setClasses();l.ensureHighlightVisible()});t.on("close",function(){l.$results.attr("aria-expanded","false");l.$results.attr("aria-hidden","true");l.$results.removeAttr("aria-activedescendant")});t.on("results:toggle",function(){var e=l.getHighlightedResults();if(e.length===0){return}e.trigger("mouseup")});t.on("results:select",function(){var e=l.getHighlightedResults();if(e.length===0){return}var t=p.GetData(e[0],"data");if(e.hasClass("select2-results__option--selected")){l.trigger("close",{})}else{l.trigger("select",{data:t})}});t.on("results:previous",function(){var e=l.getHighlightedResults();var t=l.$results.find(".select2-results__option--selectable");var i=t.index(e);if(i<=0){return}var n=i-1;if(e.length===0){n=0}var r=t.eq(n);r.trigger("mouseenter");var o=l.$results.offset().top;var s=r.offset().top;var a=l.$results.scrollTop()+(s-o);if(n===0){l.$results.scrollTop(0)}else if(s-o<0){l.$results.scrollTop(a)}});t.on("results:next",function(){var e=l.getHighlightedResults();var t=l.$results.find(".select2-results__option--selectable");var i=t.index(e);var n=i+1;if(n>=t.length){return}var r=t.eq(n);r.trigger("mouseenter");var o=l.$results.offset().top+l.$results.outerHeight(false);var s=r.offset().top+r.outerHeight(false);var a=l.$results.scrollTop()+s-o;if(n===0){l.$results.scrollTop(0)}else if(s>o){l.$results.scrollTop(a)}});t.on("results:focus",function(e){e.element[0].classList.add("select2-results__option--highlighted");e.element[0].setAttribute("aria-selected","true")});t.on("results:message",function(e){l.displayMessage(e)});if(f.fn.mousewheel){this.$results.on("mousewheel",function(e){var t=l.$results.scrollTop();var i=l.$results.get(0).scrollHeight-t+e.deltaY;var n=e.deltaY>0&&t-e.deltaY<=0;var r=e.deltaY<0&&i<=l.$results.height();if(n){l.$results.scrollTop(0);e.preventDefault();e.stopPropagation()}else if(r){l.$results.scrollTop(l.$results.get(0).scrollHeight-l.$results.height());e.preventDefault();e.stopPropagation()}})}this.$results.on("mouseup",".select2-results__option--selectable",function(e){var t=f(this);var i=p.GetData(this,"data");if(t.hasClass("select2-results__option--selected")){if(l.options.get("multiple")){l.trigger("unselect",{originalEvent:e,data:i})}else{l.trigger("close",{})}return}l.trigger("select",{originalEvent:e,data:i})});this.$results.on("mouseenter",".select2-results__option--selectable",function(e){var t=p.GetData(this,"data");l.getHighlightedResults().removeClass("select2-results__option--highlighted").attr("aria-selected","false");l.trigger("results:focus",{data:t,element:f(this)})})};n.prototype.getHighlightedResults=function(){var e=this.$results.find(".select2-results__option--highlighted");return e};n.prototype.destroy=function(){this.$results.remove()};n.prototype.ensureHighlightVisible=function(){var e=this.getHighlightedResults();if(e.length===0){return}var t=this.$results.find(".select2-results__option--selectable");var i=t.index(e);var n=this.$results.offset().top;var r=e.offset().top;var o=this.$results.scrollTop()+(r-n);var s=r-n;o-=e.outerHeight(false)*2;if(i<=2){this.$results.scrollTop(0)}else if(s>this.$results.outerHeight()||s<0){this.$results.scrollTop(o)}};n.prototype.template=function(e,t){var i=this.options.get("templateResult");var n=this.options.get("escapeMarkup");var r=i(e,t);if(r==null){t.style.display="none"}else if(typeof r==="string"){t.innerHTML=n(r)}else{f(t).append(r)}};return n});t.define("select2/keys",[],function(){var e={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};return e});t.define("select2/selection/base",["jquery","../utils","../keys"],function(r,o,s){function i(e,t){this.$element=e;this.options=t;i.__super__.constructor.call(this)}o.Extend(i,o.Observable);i.prototype.render=function(){var e=r('<span class="select2-selection" role="combobox" '+' aria-haspopup="true" aria-expanded="false">'+"</span>");this._tabindex=0;if(o.GetData(this.$element[0],"old-tabindex")!=null){this._tabindex=o.GetData(this.$element[0],"old-tabindex")}else if(this.$element.attr("tabindex")!=null){this._tabindex=this.$element.attr("tabindex")}e.attr("title",this.$element.attr("title"));e.attr("tabindex",this._tabindex);e.attr("aria-disabled","false");this.$selection=e;return e};i.prototype.bind=function(e,t){var i=this;var n=e.id+"-results";this.container=e;this.$selection.on("focus",function(e){i.trigger("focus",e)});this.$selection.on("blur",function(e){i._handleBlur(e)});this.$selection.on("keydown",function(e){i.trigger("keypress",e);if(e.which===s.SPACE){e.preventDefault()}});e.on("results:focus",function(e){i.$selection.attr("aria-activedescendant",e.data._resultId)});e.on("selection:update",function(e){i.update(e.data)});e.on("open",function(){i.$selection.attr("aria-expanded","true");i.$selection.attr("aria-owns",n);i._attachCloseHandler(e)});e.on("close",function(){i.$selection.attr("aria-expanded","false");i.$selection.removeAttr("aria-activedescendant");i.$selection.removeAttr("aria-owns");i.$selection.trigger("focus");i._detachCloseHandler(e)});e.on("enable",function(){i.$selection.attr("tabindex",i._tabindex);i.$selection.attr("aria-disabled","false")});e.on("disable",function(){i.$selection.attr("tabindex","-1");i.$selection.attr("aria-disabled","true")})};i.prototype._handleBlur=function(e){var t=this;window.setTimeout(function(){if(document.activeElement==t.$selection[0]||r.contains(t.$selection[0],document.activeElement)){return}t.trigger("blur",e)},1)};i.prototype._attachCloseHandler=function(e){r(document.body).on("mousedown.select2."+e.id,function(e){var t=r(e.target);var i=t.closest(".select2");var n=r(".select2.select2-container--open");n.each(function(){if(this==i[0]){return}var e=o.GetData(this,"element");e.select2("close")})})};i.prototype._detachCloseHandler=function(e){r(document.body).off("mousedown.select2."+e.id)};i.prototype.position=function(e,t){var i=t.find(".selection");i.append(e)};i.prototype.destroy=function(){this._detachCloseHandler(this.container)};i.prototype.update=function(e){throw new Error("The `update` method must be defined in child classes.")};i.prototype.isEnabled=function(){return!this.isDisabled()};i.prototype.isDisabled=function(){return this.options.get("disabled")};return i});t.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(e,t,i,n){function r(){r.__super__.constructor.apply(this,arguments)}i.Extend(r,t);r.prototype.render=function(){var e=r.__super__.render.call(this);e[0].classList.add("select2-selection--single");e.html('<span class="select2-selection__rendered"></span>'+'<span class="select2-selection__arrow" role="presentation">'+'<b role="presentation"></b>'+"</span>");return e};r.prototype.bind=function(t,e){var i=this;r.__super__.bind.apply(this,arguments);var n=t.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",n).attr("role","textbox").attr("aria-readonly","true");this.$selection.attr("aria-labelledby",n);this.$selection.attr("aria-controls",n);this.$selection.on("mousedown",function(e){if(e.which!==1){return}i.trigger("toggle",{originalEvent:e})});this.$selection.on("focus",function(e){});this.$selection.on("blur",function(e){});t.on("focus",function(e){if(!t.isOpen()){i.$selection.trigger("focus")}})};r.prototype.clear=function(){var e=this.$selection.find(".select2-selection__rendered");e.empty();e.removeAttr("title")};r.prototype.display=function(e,t){var i=this.options.get("templateSelection");var n=this.options.get("escapeMarkup");return n(i(e,t))};r.prototype.selectionContainer=function(){return e("<span></span>")};r.prototype.update=function(e){if(e.length===0){this.clear();return}var t=e[0];var i=this.$selection.find(".select2-selection__rendered");var n=this.display(t,i);i.empty().append(n);var r=t.title||t.text;if(r){i.attr("title",r)}else{i.removeAttr("title")}};return r});t.define("select2/selection/multiple",["jquery","./base","../utils"],function(o,e,h){function n(e,t){n.__super__.constructor.apply(this,arguments)}h.Extend(n,e);n.prototype.render=function(){var e=n.__super__.render.call(this);e[0].classList.add("select2-selection--multiple");e.html('<ul class="select2-selection__rendered"></ul>');return e};n.prototype.bind=function(e,t){var r=this;n.__super__.bind.apply(this,arguments);var i=e.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",i);this.$selection.on("click",function(e){r.trigger("toggle",{originalEvent:e})});this.$selection.on("click",".select2-selection__choice__remove",function(e){if(r.isDisabled()){return}var t=o(this);var i=t.parent();var n=h.GetData(i[0],"data");r.trigger("unselect",{originalEvent:e,data:n})});this.$selection.on("keydown",".select2-selection__choice__remove",function(e){if(r.isDisabled()){return}e.stopPropagation()})};n.prototype.clear=function(){var e=this.$selection.find(".select2-selection__rendered");e.empty();e.removeAttr("title")};n.prototype.display=function(e,t){var i=this.options.get("templateSelection");var n=this.options.get("escapeMarkup");return n(i(e,t))};n.prototype.selectionContainer=function(){var e=o('<li class="select2-selection__choice">'+'<button type="button" class="select2-selection__choice__remove" '+'tabindex="-1">'+'<span aria-hidden="true">&times;</span>'+"</button>"+'<span class="select2-selection__choice__display"></span>'+"</li>");return e};n.prototype.update=function(e){this.clear();if(e.length===0){return}var t=[];var i=this.$selection.find(".select2-selection__rendered").attr("id")+"-choice-";for(var n=0;n<e.length;n++){var r=e[n];var o=this.selectionContainer();var s=this.display(r,o);var a=i+h.generateChars(4)+"-";if(r.id){a+=r.id}else{a+=h.generateChars(4)}o.find(".select2-selection__choice__display").append(s).attr("id",a);var l=r.title||r.text;if(l){o.attr("title",l)}var c=this.options.get("translations").get("removeItem");var u=o.find(".select2-selection__choice__remove");u.attr("title",c());u.attr("aria-label",c());u.attr("aria-describedby",a);h.StoreData(o[0],"data",r);t.push(o)}var d=this.$selection.find(".select2-selection__rendered");d.append(t)};return n});t.define("select2/selection/placeholder",[],function(){function e(e,t,i){this.placeholder=this.normalizePlaceholder(i.get("placeholder"));e.call(this,t,i)}e.prototype.normalizePlaceholder=function(e,t){if(typeof t==="string"){t={id:"",text:t}}return t};e.prototype.createPlaceholder=function(e,t){var i=this.selectionContainer();i.html(this.display(t));i[0].classList.add("select2-selection__placeholder");i[0].classList.remove("select2-selection__choice");var n=t.title||t.text||i.text();this.$selection.find(".select2-selection__rendered").attr("title",n);return i};e.prototype.update=function(e,t){var i=t.length==1&&t[0].id!=this.placeholder.id;var n=t.length>1;if(n||i){return e.call(this,t)}this.clear();var r=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(r)};return e});t.define("select2/selection/allowClear",["jquery","../keys","../utils"],function(o,n,a){function e(){}e.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i);if(this.placeholder==null){if(this.options.get("debug")&&window.console&&console.error){console.error("Select2: The `allowClear` option should be used in combination "+"with the `placeholder` option.")}}this.$selection.on("mousedown",".select2-selection__clear",function(e){n._handleClear(e)});t.on("keypress",function(e){n._handleKeyboardClear(e,t)})};e.prototype._handleClear=function(e,t){if(this.isDisabled()){return}var i=this.$selection.find(".select2-selection__clear");if(i.length===0){return}t.stopPropagation();var n=a.GetData(i[0],"data");var r=this.$element.val();this.$element.val(this.placeholder.id);var o={data:n};this.trigger("clear",o);if(o.prevented){this.$element.val(r);return}for(var s=0;s<n.length;s++){o={data:n[s]};this.trigger("unselect",o);if(o.prevented){this.$element.val(r);return}}this.$element.trigger("input").trigger("change");this.trigger("toggle",{})};e.prototype._handleKeyboardClear=function(e,t,i){if(i.isOpen()){return}if(t.which==n.DELETE||t.which==n.BACKSPACE){this._handleClear(t)}};e.prototype.update=function(e,t){e.call(this,t);this.$selection.find(".select2-selection__clear").remove();this.$selection[0].classList.remove("select2-selection--clearable");if(this.$selection.find(".select2-selection__placeholder").length>0||t.length===0){return}var i=this.$selection.find(".select2-selection__rendered").attr("id");var n=this.options.get("translations").get("removeAllItems");var r=o('<button type="button" class="select2-selection__clear" tabindex="-1">'+'<span aria-hidden="true">&times;</span>'+"</button>");r.attr("title",n());r.attr("aria-label",n());r.attr("aria-describedby",i);a.StoreData(r[0],"data",t);this.$selection.prepend(r);this.$selection[0].classList.add("select2-selection--clearable")};return e});t.define("select2/selection/search",["jquery","../utils","../keys"],function(r,l,c){function e(e,t,i){e.call(this,t,i)}e.prototype.render=function(e){var t=this.options.get("translations").get("search");var i=r('<span class="select2-search select2-search--inline">'+'<textarea class="select2-search__field"'+' type="search" tabindex="-1"'+' autocorrect="off" autocapitalize="none"'+' spellcheck="false" role="searchbox" aria-autocomplete="list" >'+"</textarea>"+"</span>");this.$searchContainer=i;this.$search=i.find("textarea");this.$search.prop("autocomplete",this.options.get("autocomplete"));this.$search.attr("aria-label",t());var n=e.call(this);this._transferTabIndex();n.append(this.$searchContainer);return n};e.prototype.bind=function(e,t,i){var r=this;var n=t.id+"-results";var o=t.id+"-container";e.call(this,t,i);r.$search.attr("aria-describedby",o);t.on("open",function(){r.$search.attr("aria-controls",n);r.$search.trigger("focus")});t.on("close",function(){r.$search.val("");r.resizeSearch();r.$search.removeAttr("aria-controls");r.$search.removeAttr("aria-activedescendant");r.$search.trigger("focus")});t.on("enable",function(){r.$search.prop("disabled",false);r._transferTabIndex()});t.on("disable",function(){r.$search.prop("disabled",true)});t.on("focus",function(e){r.$search.trigger("focus")});t.on("results:focus",function(e){if(e.data._resultId){r.$search.attr("aria-activedescendant",e.data._resultId)}else{r.$search.removeAttr("aria-activedescendant")}});this.$selection.on("focusin",".select2-search--inline",function(e){r.trigger("focus",e)});this.$selection.on("focusout",".select2-search--inline",function(e){r._handleBlur(e)});this.$selection.on("keydown",".select2-search--inline",function(e){e.stopPropagation();r.trigger("keypress",e);r._keyUpPrevented=e.isDefaultPrevented();var t=e.which;if(t===c.BACKSPACE&&r.$search.val()===""){var i=r.$selection.find(".select2-selection__choice").last();if(i.length>0){var n=l.GetData(i[0],"data");r.searchRemoveChoice(n);e.preventDefault()}}});this.$selection.on("click",".select2-search--inline",function(e){if(r.$search.val()){e.stopPropagation()}});var s=document.documentMode;var a=s&&s<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(e){if(a){r.$selection.off("input.search input.searchcheck");return}r.$selection.off("keyup.search")});this.$selection.on("keyup.search input.search",".select2-search--inline",function(e){if(a&&e.type==="input"){r.$selection.off("input.search input.searchcheck");return}var t=e.which;if(t==c.SHIFT||t==c.CTRL||t==c.ALT){return}if(t==c.TAB){return}r.handleSearch(e)})};e.prototype._transferTabIndex=function(e){this.$search.attr("tabindex",this.$selection.attr("tabindex"));this.$selection.attr("tabindex","-1")};e.prototype.createPlaceholder=function(e,t){this.$search.attr("placeholder",t.text)};e.prototype.update=function(e,t){var i=this.$search[0]==document.activeElement;this.$search.attr("placeholder","");e.call(this,t);this.resizeSearch();if(i){this.$search.trigger("focus")}};e.prototype.handleSearch=function(){this.resizeSearch();if(!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=false};e.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t});this.$search.val(t.text);this.handleSearch()};e.prototype.resizeSearch=function(){this.$search.css("width","25px");var e="100%";if(this.$search.attr("placeholder")===""){var t=this.$search.val().length+1;e=t*.75+"em"}this.$search.css("width",e)};return e});t.define("select2/selection/selectionCss",["../utils"],function(n){function e(){}e.prototype.render=function(e){var t=e.call(this);var i=this.options.get("selectionCssClass")||"";if(i.indexOf(":all:")!==-1){i=i.replace(":all:","");n.copyNonInternalCssClasses(t[0],this.$element[0])}t.addClass(i);return t};return e});t.define("select2/selection/eventRelay",["jquery"],function(s){function e(){}e.prototype.bind=function(e,t,i){var n=this;var r=["open","opening","close","closing","select","selecting","unselect","unselecting","clear","clearing"];var o=["opening","closing","selecting","unselecting","clearing"];e.call(this,t,i);t.on("*",function(e,t){if(r.indexOf(e)===-1){return}t=t||{};var i=s.Event("select2:"+e,{params:t});n.$element.trigger(i);if(o.indexOf(e)===-1){return}t.prevented=i.isDefaultPrevented()})};return e});t.define("select2/translation",["jquery","require"],function(t,i){function n(e){this.dict=e||{}}n.prototype.all=function(){return this.dict};n.prototype.get=function(e){return this.dict[e]};n.prototype.extend=function(e){this.dict=t.extend({},e.all(),this.dict)};n._cache={};n.loadPath=function(e){if(!(e in n._cache)){var t=i(e);n._cache[e]=t}return new n(n._cache[e])};return n});t.define("select2/diacritics",[],function(){var e={"‚í∂":"A","Ôº°":"A","√Ä":"A","√Å":"A","√Ç":"A","·∫¶":"A","·∫§":"A","·∫™":"A","·∫®":"A","√É":"A","ƒÄ":"A","ƒÇ":"A","·∫∞":"A","·∫Æ":"A","·∫¥":"A","·∫≤":"A","»¶":"A","«†":"A","√Ñ":"A","«û":"A","·∫¢":"A","√Ö":"A","«∫":"A","«ç":"A","»Ä":"A","»Ç":"A","·∫†":"A","·∫¨":"A","·∫∂":"A","·∏Ä":"A","ƒÑ":"A","»∫":"A","‚±Ø":"A","Íú≤":"AA","√Ü":"AE","«º":"AE","«¢":"AE","Íú¥":"AO","Íú∂":"AU","Íú∏":"AV","Íú∫":"AV","Íúº":"AY","‚í∑":"B","Ôº¢":"B","·∏Ç":"B","·∏Ñ":"B","·∏Ü":"B","…É":"B","∆Ç":"B","∆Å":"B","‚í∏":"C","Ôº£":"C","ƒÜ":"C","ƒà":"C","ƒä":"C","ƒå":"C","√á":"C","·∏à":"C","∆á":"C","»ª":"C","Íúæ":"C","‚íπ":"D","Ôº§":"D","·∏ä":"D","ƒé":"D","·∏å":"D","·∏ê":"D","·∏í":"D","·∏é":"D","ƒê":"D","∆ã":"D","∆ä":"D","∆â":"D","Íùπ":"D","«±":"DZ","«Ñ":"DZ","«≤":"Dz","«Ö":"Dz","‚í∫":"E","Ôº•":"E","√à":"E","√â":"E","√ä":"E","·ªÄ":"E","·∫æ":"E","·ªÑ":"E","·ªÇ":"E","·∫º":"E","ƒí":"E","·∏î":"E","·∏ñ":"E","ƒî":"E","ƒñ":"E","√ã":"E","·∫∫":"E","ƒö":"E","»Ñ":"E","»Ü":"E","·∫∏":"E","·ªÜ":"E","»®":"E","·∏ú":"E","ƒò":"E","·∏ò":"E","·∏ö":"E","∆ê":"E","∆é":"E","‚íª":"F","Ôº¶":"F","·∏û":"F","∆ë":"F","Íùª":"F","‚íº":"G","Ôºß":"G","«¥":"G","ƒú":"G","·∏†":"G","ƒû":"G","ƒ†":"G","«¶":"G","ƒ¢":"G","«§":"G","∆ì":"G","Íû†":"G","ÍùΩ":"G","Íùæ":"G","‚íΩ":"H","Ôº®":"H","ƒ§":"H","·∏¢":"H","·∏¶":"H","»û":"H","·∏§":"H","·∏®":"H","·∏™":"H","ƒ¶":"H","‚±ß":"H","‚±µ":"H","Íûç":"H","‚íæ":"I","Ôº©":"I","√å":"I","√ç":"I","√é":"I","ƒ®":"I","ƒ™":"I","ƒ¨":"I","ƒ∞":"I","√è":"I","·∏Æ":"I","·ªà":"I","«è":"I","»à":"I","»ä":"I","·ªä":"I","ƒÆ":"I","·∏¨":"I","∆ó":"I","‚íø":"J","Ôº™":"J","ƒ¥":"J","…à":"J","‚ìÄ":"K","Ôº´":"K","·∏∞":"K","«®":"K","·∏≤":"K","ƒ∂":"K","·∏¥":"K","∆ò":"K","‚±©":"K","ÍùÄ":"K","ÍùÇ":"K","ÍùÑ":"K","Íû¢":"K","‚ìÅ":"L","Ôº¨":"L","ƒø":"L","ƒπ":"L","ƒΩ":"L","·∏∂":"L","·∏∏":"L","ƒª":"L","·∏º":"L","·∏∫":"L","≈Å":"L","»Ω":"L","‚±¢":"L","‚±†":"L","Íùà":"L","ÍùÜ":"L","ÍûÄ":"L","«á":"LJ","«à":"Lj","‚ìÇ":"M","Ôº≠":"M","·∏æ":"M","·πÄ":"M","·πÇ":"M","‚±Æ":"M","∆ú":"M","‚ìÉ":"N","ÔºÆ":"N","«∏":"N","≈É":"N","√ë":"N","·πÑ":"N","≈á":"N","·πÜ":"N","≈Ö":"N","·πä":"N","·πà":"N","»†":"N","∆ù":"N","Íûê":"N","Íû§":"N","«ä":"NJ","«ã":"Nj","‚ìÑ":"O","ÔºØ":"O","√í":"O","√ì":"O","√î":"O","·ªí":"O","·ªê":"O","·ªñ":"O","·ªî":"O","√ï":"O","·πå":"O","»¨":"O","·πé":"O","≈å":"O","·πê":"O","·πí":"O","≈é":"O","»Æ":"O","»∞":"O","√ñ":"O","»™":"O","·ªé":"O","≈ê":"O","«ë":"O","»å":"O","»é":"O","∆†":"O","·ªú":"O","·ªö":"O","·ª†":"O","·ªû":"O","·ª¢":"O","·ªå":"O","·ªò":"O","«™":"O","«¨":"O","√ò":"O","«æ":"O","∆Ü":"O","∆ü":"O","Íùä":"O","Íùå":"O","≈í":"OE","∆¢":"OI","Íùé":"OO","»¢":"OU","‚ìÖ":"P","Ôº∞":"P","·πî":"P","·πñ":"P","∆§":"P","‚±£":"P","Íùê":"P","Íùí":"P","Íùî":"P","‚ìÜ":"Q","Ôº±":"Q","Íùñ":"Q","Íùò":"Q","…ä":"Q","‚ìá":"R","Ôº≤":"R","≈î":"R","·πò":"R","≈ò":"R","»ê":"R","»í":"R","·πö":"R","·πú":"R","≈ñ":"R","·πû":"R","…å":"R","‚±§":"R","Íùö":"R","Íû¶":"R","ÍûÇ":"R","‚ìà":"S","Ôº≥":"S","·∫û":"S","≈ö":"S","·π§":"S","≈ú":"S","·π†":"S","≈†":"S","·π¶":"S","·π¢":"S","·π®":"S","»ò":"S","≈û":"S","‚±æ":"S","Íû®":"S","ÍûÑ":"S","‚ìâ":"T","Ôº¥":"T","·π™":"T","≈§":"T","·π¨":"T","»ö":"T","≈¢":"T","·π∞":"T","·πÆ":"T","≈¶":"T","∆¨":"T","∆Æ":"T","»æ":"T","ÍûÜ":"T","Íú®":"TZ","‚ìä":"U","Ôºµ":"U","√ô":"U","√ö":"U","√õ":"U","≈®":"U","·π∏":"U","≈™":"U","·π∫":"U","≈¨":"U","√ú":"U","«õ":"U","«ó":"U","«ï":"U","«ô":"U","·ª¶":"U","≈Æ":"U","≈∞":"U","«ì":"U","»î":"U","»ñ":"U","∆Ø":"U","·ª™":"U","·ª®":"U","·ªÆ":"U","·ª¨":"U","·ª∞":"U","·ª§":"U","·π≤":"U","≈≤":"U","·π∂":"U","·π¥":"U","…Ñ":"U","‚ìã":"V","Ôº∂":"V","·πº":"V","·πæ":"V","∆≤":"V","Íùû":"V","…Ö":"V","Íù†":"VY","‚ìå":"W","Ôº∑":"W","·∫Ä":"W","·∫Ç":"W","≈¥":"W","·∫Ü":"W","·∫Ñ":"W","·∫à":"W","‚±≤":"W","‚ìç":"X","Ôº∏":"X","·∫ä":"X","·∫å":"X","‚ìé":"Y","Ôºπ":"Y","·ª≤":"Y","√ù":"Y","≈∂":"Y","·ª∏":"Y","»≤":"Y","·∫é":"Y","≈∏":"Y","·ª∂":"Y","·ª¥":"Y","∆≥":"Y","…é":"Y","·ªæ":"Y","‚ìè":"Z","Ôº∫":"Z","≈π":"Z","·∫ê":"Z","≈ª":"Z","≈Ω":"Z","·∫í":"Z","·∫î":"Z","∆µ":"Z","»§":"Z","‚±ø":"Z","‚±´":"Z","Íù¢":"Z","‚ìê":"a","ÔΩÅ":"a","·∫ö":"a","√†":"a","√°":"a","√¢":"a","·∫ß":"a","·∫•":"a","·∫´":"a","·∫©":"a","√£":"a","ƒÅ":"a","ƒÉ":"a","·∫±":"a","·∫Ø":"a","·∫µ":"a","·∫≥":"a","»ß":"a","«°":"a","√§":"a","«ü":"a","·∫£":"a","√•":"a","«ª":"a","«é":"a","»Å":"a","»É":"a","·∫°":"a","·∫≠":"a","·∫∑":"a","·∏Å":"a","ƒÖ":"a","‚±•":"a","…ê":"a","Íú≥":"aa","√¶":"ae","«Ω":"ae","«£":"ae","Íúµ":"ao","Íú∑":"au","Íúπ":"av","Íúª":"av","ÍúΩ":"ay","‚ìë":"b","ÔΩÇ":"b","·∏É":"b","·∏Ö":"b","·∏á":"b","∆Ä":"b","∆É":"b","…ì":"b","‚ìí":"c","ÔΩÉ":"c","ƒá":"c","ƒâ":"c","ƒã":"c","ƒç":"c","√ß":"c","·∏â":"c","∆à":"c","»º":"c","Íúø":"c","‚ÜÑ":"c","‚ìì":"d","ÔΩÑ":"d","·∏ã":"d","ƒè":"d","·∏ç":"d","·∏ë":"d","·∏ì":"d","·∏è":"d","ƒë":"d","∆å":"d","…ñ":"d","…ó":"d","Íù∫":"d","«≥":"dz","«Ü":"dz","‚ìî":"e","ÔΩÖ":"e","√®":"e","√©":"e","√™":"e","·ªÅ":"e","·∫ø":"e","·ªÖ":"e","·ªÉ":"e","·∫Ω":"e","ƒì":"e","·∏ï":"e","·∏ó":"e","ƒï":"e","ƒó":"e","√´":"e","·∫ª":"e","ƒõ":"e","»Ö":"e","»á":"e","·∫π":"e","·ªá":"e","»©":"e","·∏ù":"e","ƒô":"e","·∏ô":"e","·∏õ":"e","…á":"e","…õ":"e","«ù":"e","‚ìï":"f","ÔΩÜ":"f","·∏ü":"f","∆í":"f","Íùº":"f","‚ìñ":"g","ÔΩá":"g","«µ":"g","ƒù":"g","·∏°":"g","ƒü":"g","ƒ°":"g","«ß":"g","ƒ£":"g","«•":"g","…†":"g","Íû°":"g","·µπ":"g","Íùø":"g","‚ìó":"h","ÔΩà":"h","ƒ•":"h","·∏£":"h","·∏ß":"h","»ü":"h","·∏•":"h","·∏©":"h","·∏´":"h","·∫ñ":"h","ƒß":"h","‚±®":"h","‚±∂":"h","…•":"h","∆ï":"hv","‚ìò":"i","ÔΩâ":"i","√¨":"i","√≠":"i","√Æ":"i","ƒ©":"i","ƒ´":"i","ƒ≠":"i","√Ø":"i","·∏Ø":"i","·ªâ":"i","«ê":"i","»â":"i","»ã":"i","·ªã":"i","ƒØ":"i","·∏≠":"i","…®":"i","ƒ±":"i","‚ìô":"j","ÔΩä":"j","ƒµ":"j","«∞":"j","…â":"j","‚ìö":"k","ÔΩã":"k","·∏±":"k","«©":"k","·∏≥":"k","ƒ∑":"k","·∏µ":"k","∆ô":"k","‚±™":"k","ÍùÅ":"k","ÍùÉ":"k","ÍùÖ":"k","Íû£":"k","‚ìõ":"l","ÔΩå":"l","≈Ä":"l","ƒ∫":"l","ƒæ":"l","·∏∑":"l","·∏π":"l","ƒº":"l","·∏Ω":"l","·∏ª":"l","≈ø":"l","≈Ç":"l","∆ö":"l","…´":"l","‚±°":"l","Íùâ":"l","ÍûÅ":"l","Íùá":"l","«â":"lj","‚ìú":"m","ÔΩç":"m","·∏ø":"m","·πÅ":"m","·πÉ":"m","…±":"m","…Ø":"m","‚ìù":"n","ÔΩé":"n","«π":"n","≈Ñ":"n","√±":"n","·πÖ":"n","≈à":"n","·πá":"n","≈Ü":"n","·πã":"n","·πâ":"n","∆û":"n","…≤":"n","≈â":"n","Íûë":"n","Íû•":"n","«å":"nj","‚ìû":"o","ÔΩè":"o","√≤":"o","√≥":"o","√¥":"o","·ªì":"o","·ªë":"o","·ªó":"o","·ªï":"o","√µ":"o","·πç":"o","»≠":"o","·πè":"o","≈ç":"o","·πë":"o","·πì":"o","≈è":"o","»Ø":"o","»±":"o","√∂":"o","»´":"o","·ªè":"o","≈ë":"o","«í":"o","»ç":"o","»è":"o","∆°":"o","·ªù":"o","·ªõ":"o","·ª°":"o","·ªü":"o","·ª£":"o","·ªç":"o","·ªô":"o","«´":"o","«≠":"o","√∏":"o","«ø":"o","…î":"o","Íùã":"o","Íùç":"o","…µ":"o","≈ì":"oe","∆£":"oi","»£":"ou","Íùè":"oo","‚ìü":"p","ÔΩê":"p","·πï":"p","·πó":"p","∆•":"p","·µΩ":"p","Íùë":"p","Íùì":"p","Íùï":"p","‚ì†":"q","ÔΩë":"q","…ã":"q","Íùó":"q","Íùô":"q","‚ì°":"r","ÔΩí":"r","≈ï":"r","·πô":"r","≈ô":"r","»ë":"r","»ì":"r","·πõ":"r","·πù":"r","≈ó":"r","·πü":"r","…ç":"r","…Ω":"r","Íùõ":"r","Íûß":"r","ÍûÉ":"r","‚ì¢":"s","ÔΩì":"s","√ü":"s","≈õ":"s","·π•":"s","≈ù":"s","·π°":"s","≈°":"s","·πß":"s","·π£":"s","·π©":"s","»ô":"s","≈ü":"s","»ø":"s","Íû©":"s","ÍûÖ":"s","·∫õ":"s","‚ì£":"t","ÔΩî":"t","·π´":"t","·∫ó":"t","≈•":"t","·π≠":"t","»õ":"t","≈£":"t","·π±":"t","·πØ":"t","≈ß":"t","∆≠":"t"," à":"t","‚±¶":"t","Íûá":"t","Íú©":"tz","‚ì§":"u","ÔΩï":"u","√π":"u","√∫":"u","√ª":"u","≈©":"u","·ππ":"u","≈´":"u","·πª":"u","≈≠":"u","√º":"u","«ú":"u","«ò":"u","«ñ":"u","«ö":"u","·ªß":"u","≈Ø":"u","≈±":"u","«î":"u","»ï":"u","»ó":"u","∆∞":"u","·ª´":"u","·ª©":"u","·ªØ":"u","·ª≠":"u","·ª±":"u","·ª•":"u","·π≥":"u","≈≥":"u","·π∑":"u","·πµ":"u"," â":"u","‚ì•":"v","ÔΩñ":"v","·πΩ":"v","·πø":"v"," ã":"v","Íùü":"v"," å":"v","Íù°":"vy","‚ì¶":"w","ÔΩó":"w","·∫Å":"w","·∫É":"w","≈µ":"w","·∫á":"w","·∫Ö":"w","·∫ò":"w","·∫â":"w","‚±≥":"w","‚ìß":"x","ÔΩò":"x","·∫ã":"x","·∫ç":"x","‚ì®":"y","ÔΩô":"y","·ª≥":"y","√Ω":"y","≈∑":"y","·ªπ":"y","»≥":"y","·∫è":"y","√ø":"y","·ª∑":"y","·∫ô":"y","·ªµ":"y","∆¥":"y","…è":"y","·ªø":"y","‚ì©":"z","ÔΩö":"z","≈∫":"z","·∫ë":"z","≈º":"z","≈æ":"z","·∫ì":"z","·∫ï":"z","∆∂":"z","»•":"z","…Ä":"z","‚±¨":"z","Íù£":"z","ŒÜ":"Œë","Œà":"Œï","Œâ":"Œó","Œä":"Œô","Œ™":"Œô","Œå":"Œü","Œé":"Œ•","Œ´":"Œ•","Œè":"Œ©","Œ¨":"Œ±","Œ≠":"Œµ","ŒÆ":"Œ∑","ŒØ":"Œπ","œä":"Œπ","Œê":"Œπ","œå":"Œø","œç":"œÖ","œã":"œÖ","Œ∞":"œÖ","œé":"œâ","œÇ":"œÉ","‚Äô":"'"};return e});t.define("select2/data/base",["../utils"],function(n){function i(e,t){i.__super__.constructor.call(this)}n.Extend(i,n.Observable);i.prototype.current=function(e){throw new Error("The `current` method must be defined in child classes.")};i.prototype.query=function(e,t){throw new Error("The `query` method must be defined in child classes.")};i.prototype.bind=function(e,t){};i.prototype.destroy=function(){};i.prototype.generateResultId=function(e,t){var i=e.id+"-result-";i+=n.generateChars(4);if(t.id!=null){i+="-"+t.id.toString()}else{i+="-"+n.generateChars(4)}return i};return i});t.define("select2/data/select",["./base","../utils","jquery"],function(e,l,c){function i(e,t){this.$element=e;this.options=t;i.__super__.constructor.call(this)}l.Extend(i,e);i.prototype.current=function(e){var t=this;var i=Array.prototype.map.call(this.$element[0].querySelectorAll(":checked"),function(e){return t.item(c(e))});e(i)};i.prototype.select=function(r){var o=this;r.selected=true;if(r.element!=null&&r.element.tagName.toLowerCase()==="option"){r.element.selected=true;this.$element.trigger("input").trigger("change");return}if(this.$element.prop("multiple")){this.current(function(e){var t=[];r=[r];r.push.apply(r,e);for(var i=0;i<r.length;i++){var n=r[i].id;if(t.indexOf(n)===-1){t.push(n)}}o.$element.val(t);o.$element.trigger("input").trigger("change")})}else{var e=r.id;this.$element.val(e);this.$element.trigger("input").trigger("change")}};i.prototype.unselect=function(r){var o=this;if(!this.$element.prop("multiple")){return}r.selected=false;if(r.element!=null&&r.element.tagName.toLowerCase()==="option"){r.element.selected=false;this.$element.trigger("input").trigger("change");return}this.current(function(e){var t=[];for(var i=0;i<e.length;i++){var n=e[i].id;if(n!==r.id&&t.indexOf(n)===-1){t.push(n)}}o.$element.val(t);o.$element.trigger("input").trigger("change")})};i.prototype.bind=function(e,t){var i=this;this.container=e;e.on("select",function(e){i.select(e.data)});e.on("unselect",function(e){i.unselect(e.data)})};i.prototype.destroy=function(){this.$element.find("*").each(function(){l.RemoveData(this)})};i.prototype.query=function(n,e){var r=[];var o=this;var t=this.$element.children();t.each(function(){if(this.tagName.toLowerCase()!=="option"&&this.tagName.toLowerCase()!=="optgroup"){return}var e=c(this);var t=o.item(e);var i=o.matches(n,t);if(i!==null){r.push(i)}});e({results:r})};i.prototype.addOptions=function(e){this.$element.append(e)};i.prototype.option=function(e){var t;if(e.children){t=document.createElement("optgroup");t.label=e.text}else{t=document.createElement("option");if(t.textContent!==undefined){t.textContent=e.text}else{t.innerText=e.text}}if(e.id!==undefined){t.value=e.id}if(e.disabled){t.disabled=true}if(e.selected){t.selected=true}if(e.title){t.title=e.title}var i=this._normalizeItem(e);i.element=t;l.StoreData(t,"data",i);return c(t)};i.prototype.item=function(e){var t={};t=l.GetData(e[0],"data");if(t!=null){return t}var i=e[0];if(i.tagName.toLowerCase()==="option"){t={id:e.val(),text:e.text(),disabled:e.prop("disabled"),selected:e.prop("selected"),title:e.prop("title")}}else if(i.tagName.toLowerCase()==="optgroup"){t={text:e.prop("label"),children:[],title:e.prop("title")};var n=e.children("option");var r=[];for(var o=0;o<n.length;o++){var s=c(n[o]);var a=this.item(s);r.push(a)}t.children=r}t=this._normalizeItem(t);t.element=e[0];l.StoreData(e[0],"data",t);return t};i.prototype._normalizeItem=function(e){if(e!==Object(e)){e={id:e,text:e}}e=c.extend({},{text:""},e);var t={selected:false,disabled:false};if(e.id!=null){e.id=e.id.toString()}if(e.text!=null){e.text=e.text.toString()}if(e._resultId==null&&e.id&&this.container!=null){e._resultId=this.generateResultId(this.container,e)}return c.extend({},t,e)};i.prototype.matches=function(e,t){var i=this.options.get("matcher");return i(e,t)};return i});t.define("select2/data/array",["./select","../utils","jquery"],function(e,t,p){function n(e,t){this._dataToConvert=t.get("data")||[];n.__super__.constructor.call(this,e,t)}t.Extend(n,e);n.prototype.bind=function(e,t){n.__super__.bind.call(this,e,t);this.addOptions(this.convertToOptions(this._dataToConvert))};n.prototype.select=function(i){var e=this.$element.find("option").filter(function(e,t){return t.value==i.id.toString()});if(e.length===0){e=this.option(i);this.addOptions(e)}n.__super__.select.call(this,i)};n.prototype.convertToOptions=function(e){var t=this;var i=this.$element.find("option");var n=i.map(function(){return t.item(p(this)).id}).get();var r=[];function o(e){return function(){return p(this).val()==e.id}}for(var s=0;s<e.length;s++){var a=this._normalizeItem(e[s]);if(n.indexOf(a.id)>=0){var l=i.filter(o(a));var c=this.item(l);var u=p.extend(true,{},a,c);var d=this.option(u);l.replaceWith(d);continue}var h=this.option(a);if(a.children){var f=this.convertToOptions(a.children);h.append(f)}r.push(h)}return r};return n});t.define("select2/data/ajax",["./array","../utils","jquery"],function(e,t,s){function i(e,t){this.ajaxOptions=this._applyDefaults(t.get("ajax"));if(this.ajaxOptions.processResults!=null){this.processResults=this.ajaxOptions.processResults}i.__super__.constructor.call(this,e,t)}t.Extend(i,e);i.prototype._applyDefaults=function(e){var t={data:function(e){return s.extend({},e,{q:e.term})},transport:function(e,t,i){var n=s.ajax(e);n.then(t);n.fail(i);return n}};return s.extend({},t,e,true)};i.prototype.processResults=function(e){return e};i.prototype.query=function(i,n){var e=[];var r=this;if(this._request!=null){if(typeof this._request.abort==="function"){this._request.abort()}this._request=null}var t=s.extend({type:"GET"},this.ajaxOptions);if(typeof t.url==="function"){t.url=t.url.call(this.$element,i)}if(typeof t.data==="function"){t.data=t.data.call(this.$element,i)}function o(){var e=t.transport(t,function(e){var t=r.processResults(e,i);if(r.options.get("debug")&&window.console&&console.error){if(!t||!t.results||!Array.isArray(t.results)){console.error("Select2: The AJAX results did not return an array in the "+"`results` key of the response.")}}n(t)},function(){if("status"in e&&(e.status===0||e.status==="0")){return}r.trigger("results:message",{message:"errorLoading"})});r._request=e}if(this.ajaxOptions.delay&&i.term!=null){if(this._queryTimeout){window.clearTimeout(this._queryTimeout)}this._queryTimeout=window.setTimeout(o,this.ajaxOptions.delay)}else{o()}};return i});t.define("select2/data/tags",["jquery"],function(i){function e(e,t,i){var n=i.get("tags");var r=i.get("createTag");if(r!==undefined){this.createTag=r}var o=i.get("insertTag");if(o!==undefined){this.insertTag=o}e.call(this,t,i);if(Array.isArray(n)){for(var s=0;s<n.length;s++){var a=n[s];var l=this._normalizeItem(a);var c=this.option(l);this.$element.append(c)}}}e.prototype.query=function(e,d,h){var f=this;this._removeOldTags();if(d.term==null||d.page!=null){e.call(this,d,h);return}function p(e,t){var i=e.results;for(var n=0;n<i.length;n++){var r=i[n];var o=r.children!=null&&!p({results:r.children},true);var s=(r.text||"").toUpperCase();var a=(d.term||"").toUpperCase();var l=s===a;if(l||o){if(t){return false}e.data=i;h(e);return}}if(t){return true}var c=f.createTag(d);if(c!=null){var u=f.option(c);u.attr("data-select2-tag","true");f.addOptions([u]);f.insertTag(i,c)}e.results=i;h(e)}e.call(this,d,p)};e.prototype.createTag=function(e,t){if(t.term==null){return null}var i=t.term.trim();if(i===""){return null}return{id:i,text:i}};e.prototype.insertTag=function(e,t,i){t.unshift(i)};e.prototype._removeOldTags=function(e){var t=this.$element.find("option[data-select2-tag]");t.each(function(){if(this.selected){return}i(this).remove()})};return e});t.define("select2/data/tokenizer",["jquery"],function(h){function e(e,t,i){var n=i.get("tokenizer");if(n!==undefined){this.tokenizer=n}e.call(this,t,i)}e.prototype.bind=function(e,t,i){e.call(this,t,i);this.$search=t.dropdown.$search||t.selection.$search||i.find(".select2-search__field")};e.prototype.query=function(e,t,i){var r=this;function n(e){var t=r._normalizeItem(e);var i=r.$element.find("option").filter(function(){return h(this).val()===t.id});if(!i.length){var n=r.option(t);n.attr("data-select2-tag",true);r._removeOldTags();r.addOptions([n])}o(t)}function o(e){r.trigger("select",{data:e})}t.term=t.term||"";var s=this.tokenizer(t,this.options,n);if(s.term!==t.term){if(this.$search.length){this.$search.val(s.term);this.$search.trigger("focus")}t.term=s.term}e.call(this,t,i)};e.prototype.tokenizer=function(e,t,i,n){var r=i.get("tokenSeparators")||[];var o=t.term;var s=0;var a=this.createTag||function(e){return{id:e.term,text:e.term}};while(s<o.length){var l=o[s];if(r.indexOf(l)===-1){s++;continue}var c=o.substr(0,s);var u=h.extend({},t,{term:c});var d=a(u);if(d==null){s++;continue}n(d);o=o.substr(s+1)||"";s=0}return{term:o}};return e});t.define("select2/data/minimumInputLength",[],function(){function e(e,t,i){this.minimumInputLength=i.get("minimumInputLength");e.call(this,t,i)}e.prototype.query=function(e,t,i){t.term=t.term||"";if(t.term.length<this.minimumInputLength){this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}});return}e.call(this,t,i)};return e});t.define("select2/data/maximumInputLength",[],function(){function e(e,t,i){this.maximumInputLength=i.get("maximumInputLength");e.call(this,t,i)}e.prototype.query=function(e,t,i){t.term=t.term||"";if(this.maximumInputLength>0&&t.term.length>this.maximumInputLength){this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}});return}e.call(this,t,i)};return e});t.define("select2/data/maximumSelectionLength",[],function(){function e(e,t,i){this.maximumSelectionLength=i.get("maximumSelectionLength");e.call(this,t,i)}e.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i);t.on("select",function(){n._checkIfMaximumSelected()})};e.prototype.query=function(e,t,i){var n=this;this._checkIfMaximumSelected(function(){e.call(n,t,i)})};e.prototype._checkIfMaximumSelected=function(e,i){var n=this;this.current(function(e){var t=e!=null?e.length:0;if(n.maximumSelectionLength>0&&t>=n.maximumSelectionLength){n.trigger("results:message",{message:"maximumSelected",args:{maximum:n.maximumSelectionLength}});return}if(i){i()}})};return e});t.define("select2/dropdown",["jquery","./utils"],function(t,e){function i(e,t){this.$element=e;this.options=t;i.__super__.constructor.call(this)}e.Extend(i,e.Observable);i.prototype.render=function(){var e=t('<span class="select2-dropdown">'+'<span class="select2-results"></span>'+"</span>");e.attr("dir",this.options.get("dir"));this.$dropdown=e;return e};i.prototype.bind=function(){};i.prototype.position=function(e,t){};i.prototype.destroy=function(){this.$dropdown.remove()};return i});t.define("select2/dropdown/search",["jquery"],function(o){function e(){}e.prototype.render=function(e){var t=e.call(this);var i=this.options.get("translations").get("search");var n=o('<span class="select2-search select2-search--dropdown">'+'<input class="select2-search__field" type="search" tabindex="-1"'+' autocorrect="off" autocapitalize="none"'+' spellcheck="false" role="searchbox" aria-autocomplete="list" />'+"</span>");this.$searchContainer=n;this.$search=n.find("input");this.$search.prop("autocomplete",this.options.get("autocomplete"));this.$search.attr("aria-label",i());t.prepend(n);return t};e.prototype.bind=function(e,t,i){var n=this;var r=t.id+"-results";e.call(this,t,i);this.$search.on("keydown",function(e){n.trigger("keypress",e);n._keyUpPrevented=e.isDefaultPrevented()});this.$search.on("input",function(e){o(this).off("keyup")});this.$search.on("keyup input",function(e){n.handleSearch(e)});t.on("open",function(){n.$search.attr("tabindex",0);n.$search.attr("aria-controls",r);n.$search.trigger("focus");window.setTimeout(function(){n.$search.trigger("focus")},0)});t.on("close",function(){n.$search.attr("tabindex",-1);n.$search.removeAttr("aria-controls");n.$search.removeAttr("aria-activedescendant");n.$search.val("");n.$search.trigger("blur")});t.on("focus",function(){if(!t.isOpen()){n.$search.trigger("focus")}});t.on("results:all",function(e){if(e.query.term==null||e.query.term===""){var t=n.showSearch(e);if(t){n.$searchContainer[0].classList.remove("select2-search--hide")}else{n.$searchContainer[0].classList.add("select2-search--hide")}}});t.on("results:focus",function(e){if(e.data._resultId){n.$search.attr("aria-activedescendant",e.data._resultId)}else{n.$search.removeAttr("aria-activedescendant")}})};e.prototype.handleSearch=function(e){if(!this._keyUpPrevented){var t=this.$search.val();this.trigger("query",{term:t})}this._keyUpPrevented=false};e.prototype.showSearch=function(e,t){return true};return e});t.define("select2/dropdown/hidePlaceholder",[],function(){function e(e,t,i,n){this.placeholder=this.normalizePlaceholder(i.get("placeholder"));e.call(this,t,i,n)}e.prototype.append=function(e,t){t.results=this.removePlaceholder(t.results);e.call(this,t)};e.prototype.normalizePlaceholder=function(e,t){if(typeof t==="string"){t={id:"",text:t}}return t};e.prototype.removePlaceholder=function(e,t){var i=t.slice(0);for(var n=t.length-1;n>=0;n--){var r=t[n];if(this.placeholder.id===r.id){i.splice(n,1)}}return i};return e});t.define("select2/dropdown/infiniteScroll",["jquery"],function(n){function e(e,t,i,n){this.lastParams={};e.call(this,t,i,n);this.$loadingMore=this.createLoadingMore();this.loading=false}e.prototype.append=function(e,t){this.$loadingMore.remove();this.loading=false;e.call(this,t);if(this.showLoadingMore(t)){this.$results.append(this.$loadingMore);this.loadMoreIfNeeded()}};e.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i);t.on("query",function(e){n.lastParams=e;n.loading=true});t.on("query:append",function(e){n.lastParams=e;n.loading=true});this.$results.on("scroll",this.loadMoreIfNeeded.bind(this))};e.prototype.loadMoreIfNeeded=function(){var e=n.contains(document.documentElement,this.$loadingMore[0]);if(this.loading||!e){return}var t=this.$results.offset().top+this.$results.outerHeight(false);var i=this.$loadingMore.offset().top+this.$loadingMore.outerHeight(false);if(t+50>=i){this.loadMore()}};e.prototype.loadMore=function(){this.loading=true;var e=n.extend({},{page:1},this.lastParams);e.page++;this.trigger("query:append",e)};e.prototype.showLoadingMore=function(e,t){return t.pagination&&t.pagination.more};e.prototype.createLoadingMore=function(){var e=n("<li "+'class="select2-results__option select2-results__option--load-more"'+'role="option" aria-disabled="true"></li>');var t=this.options.get("translations").get("loadingMore");e.html(t(this.lastParams));return e};return e});t.define("select2/dropdown/attachBody",["jquery","../utils"],function(f,a){function e(e,t,i){this.$dropdownParent=f(i.get("dropdownParent")||document.body);e.call(this,t,i)}e.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i);t.on("open",function(){n._showDropdown();n._attachPositioningHandler(t);n._bindContainerResultHandlers(t)});t.on("close",function(){n._hideDropdown();n._detachPositioningHandler(t)});this.$dropdownContainer.on("mousedown",function(e){e.stopPropagation()})};e.prototype.destroy=function(e){e.call(this);this.$dropdownContainer.remove()};e.prototype.position=function(e,t,i){t.attr("class",i.attr("class"));t[0].classList.remove("select2");t[0].classList.add("select2-container--open");t.css({position:"absolute",top:-999999});this.$container=i};e.prototype.render=function(e){var t=f("<span></span>");var i=e.call(this);t.append(i);this.$dropdownContainer=t;return t};e.prototype._hideDropdown=function(e){this.$dropdownContainer.detach()};e.prototype._bindContainerResultHandlers=function(e,t){if(this._containerResultsHandlersBound){return}var i=this;t.on("results:all",function(){i._positionDropdown();i._resizeDropdown()});t.on("results:append",function(){i._positionDropdown();i._resizeDropdown()});t.on("results:message",function(){i._positionDropdown();i._resizeDropdown()});t.on("select",function(){i._positionDropdown();i._resizeDropdown()});t.on("unselect",function(){i._positionDropdown();i._resizeDropdown()});this._containerResultsHandlersBound=true};e.prototype._attachPositioningHandler=function(e,t){var i=this;var n="scroll.select2."+t.id;var r="resize.select2."+t.id;var o="orientationchange.select2."+t.id;var s=this.$container.parents().filter(a.hasScroll);s.each(function(){a.StoreData(this,"select2-scroll-position",{x:f(this).scrollLeft(),y:f(this).scrollTop()})});s.on(n,function(e){var t=a.GetData(this,"select2-scroll-position");f(this).scrollTop(t.y)});f(window).on(n+" "+r+" "+o,function(e){i._positionDropdown();i._resizeDropdown()})};e.prototype._detachPositioningHandler=function(e,t){var i="scroll.select2."+t.id;var n="resize.select2."+t.id;var r="orientationchange.select2."+t.id;var o=this.$container.parents().filter(a.hasScroll);o.off(i);f(window).off(i+" "+n+" "+r)};e.prototype._positionDropdown=function(){var e=f(window);var t=this.$dropdown[0].classList.contains("select2-dropdown--above");var i=this.$dropdown[0].classList.contains("select2-dropdown--below");var n=null;var r=this.$container.offset();r.bottom=r.top+this.$container.outerHeight(false);var o={height:this.$container.outerHeight(false)};o.top=r.top;o.bottom=r.top+o.height;var s={height:this.$dropdown.outerHeight(false)};var a={top:e.scrollTop(),bottom:e.scrollTop()+e.height()};var l=a.top<r.top-s.height;var c=a.bottom>r.bottom+s.height;var u={left:r.left,top:o.bottom};var d=this.$dropdownParent;if(d.css("position")==="static"){d=d.offsetParent()}var h={top:0,left:0};if(f.contains(document.body,d[0])||d[0].isConnected){h=d.offset()}u.top-=h.top;u.left-=h.left;if(!t&&!i){n="below"}if(!c&&l&&!t){n="above"}else if(!l&&c&&t){n="below"}if(n=="above"||t&&n!=="below"){u.top=o.top-h.top-s.height}if(n!=null){this.$dropdown[0].classList.remove("select2-dropdown--below");this.$dropdown[0].classList.remove("select2-dropdown--above");this.$dropdown[0].classList.add("select2-dropdown--"+n);this.$container[0].classList.remove("select2-container--below");this.$container[0].classList.remove("select2-container--above");this.$container[0].classList.add("select2-container--"+n)}this.$dropdownContainer.css(u)};e.prototype._resizeDropdown=function(){var e={width:this.$container.outerWidth(false)+"px"};if(this.options.get("dropdownAutoWidth")){e.minWidth=e.width;e.position="relative";e.width="auto"}this.$dropdown.css(e)};e.prototype._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent);this._positionDropdown();this._resizeDropdown()};return e});t.define("select2/dropdown/minimumResultsForSearch",[],function(){function r(e){var t=0;for(var i=0;i<e.length;i++){var n=e[i];if(n.children){t+=r(n.children)}else{t++}}return t}function e(e,t,i,n){this.minimumResultsForSearch=i.get("minimumResultsForSearch");if(this.minimumResultsForSearch<0){this.minimumResultsForSearch=Infinity}e.call(this,t,i,n)}e.prototype.showSearch=function(e,t){if(r(t.data.results)<this.minimumResultsForSearch){return false}return e.call(this,t)};return e});t.define("select2/dropdown/selectOnClose",["../utils"],function(o){function e(){}e.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i);t.on("close",function(e){n._handleSelectOnClose(e)})};e.prototype._handleSelectOnClose=function(e,t){if(t&&t.originalSelect2Event!=null){var i=t.originalSelect2Event;if(i._type==="select"||i._type==="unselect"){return}}var n=this.getHighlightedResults();if(n.length<1){return}var r=o.GetData(n[0],"data");if(r.element!=null&&r.element.selected||r.element==null&&r.selected){return}this.trigger("select",{data:r})};return e});t.define("select2/dropdown/closeOnSelect",[],function(){function e(){}e.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i);t.on("select",function(e){n._selectTriggered(e)});t.on("unselect",function(e){n._selectTriggered(e)})};e.prototype._selectTriggered=function(e,t){var i=t.originalEvent;if(i&&(i.ctrlKey||i.metaKey)){return}this.trigger("close",{originalEvent:i,originalSelect2Event:t})};return e});t.define("select2/dropdown/dropdownCss",["../utils"],function(n){function e(){}e.prototype.render=function(e){var t=e.call(this);var i=this.options.get("dropdownCssClass")||"";if(i.indexOf(":all:")!==-1){i=i.replace(":all:","");n.copyNonInternalCssClasses(t[0],this.$element[0])}t.addClass(i);return t};return e});t.define("select2/dropdown/tagsSearchHighlight",["../utils"],function(o){function e(){}e.prototype.highlightFirstItem=function(e){var t=this.$results.find(".select2-results__option--selectable"+":not(.select2-results__option--selected)");if(t.length>0){var i=t.first();var n=o.GetData(i[0],"data");var r=n.element;if(r&&r.getAttribute){if(r.getAttribute("data-select2-tag")==="true"){i.trigger("mouseenter");return}}}e.call(this)};return e});t.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum;var i="Please delete "+t+" character";if(t!=1){i+="s"}return i},inputTooShort:function(e){var t=e.minimum-e.input.length;var i="Please enter "+t+" or more characters";return i},loadingMore:function(){return"Loading more results‚Ä¶"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";if(e.maximum!=1){t+="s"}return t},noResults:function(){return"No results found"},searching:function(){return"Searching‚Ä¶"},removeAllItems:function(){return"Remove all items"},removeItem:function(){return"Remove item"},search:function(){return"Search"}}});t.define("select2/defaults",["jquery","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/selectionCss","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./dropdown/dropdownCss","./dropdown/tagsSearchHighlight","./i18n/en"],function(u,o,s,a,l,c,d,h,f,p,g,i,m,v,y,b,_,w,C,x,S,A,E,T,D,R,M,k,O,N,e){function t(){this.reset()}t.prototype.apply=function(e){e=u.extend(true,{},this.defaults,e);if(e.dataAdapter==null){if(e.ajax!=null){e.dataAdapter=y}else if(e.data!=null){e.dataAdapter=v}else{e.dataAdapter=m}if(e.minimumInputLength>0){e.dataAdapter=p.Decorate(e.dataAdapter,w)}if(e.maximumInputLength>0){e.dataAdapter=p.Decorate(e.dataAdapter,C)}if(e.maximumSelectionLength>0){e.dataAdapter=p.Decorate(e.dataAdapter,x)}if(e.tags){e.dataAdapter=p.Decorate(e.dataAdapter,b)}if(e.tokenSeparators!=null||e.tokenizer!=null){e.dataAdapter=p.Decorate(e.dataAdapter,_)}}if(e.resultsAdapter==null){e.resultsAdapter=o;if(e.ajax!=null){e.resultsAdapter=p.Decorate(e.resultsAdapter,T)}if(e.placeholder!=null){e.resultsAdapter=p.Decorate(e.resultsAdapter,E)}if(e.selectOnClose){e.resultsAdapter=p.Decorate(e.resultsAdapter,M)}if(e.tags){e.resultsAdapter=p.Decorate(e.resultsAdapter,N)}}if(e.dropdownAdapter==null){if(e.multiple){e.dropdownAdapter=S}else{var t=p.Decorate(S,A);e.dropdownAdapter=t}if(e.minimumResultsForSearch!==0){e.dropdownAdapter=p.Decorate(e.dropdownAdapter,R)}if(e.closeOnSelect){e.dropdownAdapter=p.Decorate(e.dropdownAdapter,k)}if(e.dropdownCssClass!=null){e.dropdownAdapter=p.Decorate(e.dropdownAdapter,O)}e.dropdownAdapter=p.Decorate(e.dropdownAdapter,D)}if(e.selectionAdapter==null){if(e.multiple){e.selectionAdapter=a}else{e.selectionAdapter=s}if(e.placeholder!=null){e.selectionAdapter=p.Decorate(e.selectionAdapter,l)}if(e.allowClear){e.selectionAdapter=p.Decorate(e.selectionAdapter,c)}if(e.multiple){e.selectionAdapter=p.Decorate(e.selectionAdapter,d)}if(e.selectionCssClass!=null){e.selectionAdapter=p.Decorate(e.selectionAdapter,h)}e.selectionAdapter=p.Decorate(e.selectionAdapter,f)}e.language=this._resolveLanguage(e.language);e.language.push("en");var i=[];for(var n=0;n<e.language.length;n++){var r=e.language[n];if(i.indexOf(r)===-1){i.push(r)}}e.language=i;e.translations=this._processTranslations(e.language,e.debug);return e};t.prototype.reset=function(){function l(e){function t(e){return i[e]||e}return e.replace(/[^\u0000-\u007E]/g,t)}function c(e,t){if(e.term==null||e.term.trim()===""){return t}if(t.children&&t.children.length>0){var i=u.extend(true,{},t);for(var n=t.children.length-1;n>=0;n--){var r=t.children[n];var o=c(e,r);if(o==null){i.children.splice(n,1)}}if(i.children.length>0){return i}return c(e,i)}var s=l(t.text).toUpperCase();var a=l(e.term).toUpperCase();if(s.indexOf(a)>-1){return t}return null}this.defaults={amdLanguageBase:"./i18n/",autocomplete:"off",closeOnSelect:true,debug:false,dropdownAutoWidth:false,escapeMarkup:p.escapeMarkup,language:{},matcher:c,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:false,scrollAfterSelect:false,sorter:function(e){return e},templateResult:function(e){return e.text},templateSelection:function(e){return e.text},theme:"default",width:"resolve"}};t.prototype.applyFromElement=function(e,t){var i=e.language;var n=this.defaults.language;var r=t.prop("lang");var o=t.closest("[lang]").prop("lang");var s=Array.prototype.concat.call(this._resolveLanguage(r),this._resolveLanguage(i),this._resolveLanguage(n),this._resolveLanguage(o));e.language=s;return e};t.prototype._resolveLanguage=function(e){if(!e){return[]}if(u.isEmptyObject(e)){return[]}if(u.isPlainObject(e)){return[e]}var t;if(!Array.isArray(e)){t=[e]}else{t=e}var i=[];for(var n=0;n<t.length;n++){i.push(t[n]);if(typeof t[n]==="string"&&t[n].indexOf("-")>0){var r=t[n].split("-");var o=r[0];i.push(o)}}return i};t.prototype._processTranslations=function(e,t){var i=new g;for(var n=0;n<e.length;n++){var r=new g;var o=e[n];if(typeof o==="string"){try{r=g.loadPath(o)}catch(e){try{o=this.defaults.amdLanguageBase+o;r=g.loadPath(o)}catch(e){if(t&&window.console&&console.warn){console.warn('Select2: The language file for "'+o+'" could '+"not be automatically loaded. A fallback will be used instead.")}}}}else if(u.isPlainObject(o)){r=new g(o)}else{r=o}i.extend(r)}return i};t.prototype.set=function(e,t){var i=u.camelCase(e);var n={};n[i]=t;var r=p._convertData(n);u.extend(true,this.defaults,r)};var n=new t;return n});t.define("select2/options",["jquery","./defaults","./utils"],function(h,i,f){function e(e,t){this.options=e;if(t!=null){this.fromElement(t)}if(t!=null){this.options=i.applyFromElement(this.options,t)}this.options=i.apply(this.options)}e.prototype.fromElement=function(e){var t=["select2"];if(this.options.multiple==null){this.options.multiple=e.prop("multiple")}if(this.options.disabled==null){this.options.disabled=e.prop("disabled")}if(this.options.autocomplete==null&&e.prop("autocomplete")){this.options.autocomplete=e.prop("autocomplete")}if(this.options.dir==null){if(e.prop("dir")){this.options.dir=e.prop("dir")}else if(e.closest("[dir]").prop("dir")){this.options.dir=e.closest("[dir]").prop("dir")}else{this.options.dir="ltr"}}e.prop("disabled",this.options.disabled);e.prop("multiple",this.options.multiple);if(f.GetData(e[0],"select2Tags")){if(this.options.debug&&window.console&&console.warn){console.warn("Select2: The `data-select2-tags` attribute has been changed to "+'use the `data-data` and `data-tags="true"` attributes and will be '+"removed in future versions of Select2.")}f.StoreData(e[0],"data",f.GetData(e[0],"select2Tags"));f.StoreData(e[0],"tags",true)}if(f.GetData(e[0],"ajaxUrl")){if(this.options.debug&&window.console&&console.warn){console.warn("Select2: The `data-ajax-url` attribute has been changed to "+"`data-ajax--url` and support for the old attribute will be removed"+" in future versions of Select2.")}e.attr("ajax--url",f.GetData(e[0],"ajaxUrl"));f.StoreData(e[0],"ajax-Url",f.GetData(e[0],"ajaxUrl"))}var i={};function n(e,t){return t.toUpperCase()}for(var r=0;r<e[0].attributes.length;r++){var o=e[0].attributes[r].name;var s="data-";if(o.substr(0,s.length)==s){var a=o.substring(s.length);var l=f.GetData(e[0],a);var c=a.replace(/-([a-z])/g,n);i[c]=l}}if(h.fn.jquery&&h.fn.jquery.substr(0,2)=="1."&&e[0].dataset){i=h.extend(true,{},e[0].dataset,i)}var u=h.extend(true,{},f.GetData(e[0]),i);u=f._convertData(u);for(var d in u){if(t.indexOf(d)>-1){continue}if(h.isPlainObject(this.options[d])){h.extend(this.options[d],u[d])}else{this.options[d]=u[d]}}return this};e.prototype.get=function(e){return this.options[e]};e.prototype.set=function(e,t){this.options[e]=t};return e});t.define("select2/core",["jquery","./options","./utils","./keys"],function(t,c,u,n){var d=function(e,t){if(u.GetData(e[0],"select2")!=null){u.GetData(e[0],"select2").destroy()}this.$element=e;this.id=this._generateId(e);t=t||{};this.options=new c(t,e);d.__super__.constructor.call(this);var i=e.attr("tabindex")||0;u.StoreData(e[0],"old-tabindex",i);e.attr("tabindex","-1");var n=this.options.get("dataAdapter");this.dataAdapter=new n(e,this.options);var r=this.render();this._placeContainer(r);var o=this.options.get("selectionAdapter");this.selection=new o(e,this.options);this.$selection=this.selection.render();this.selection.position(this.$selection,r);var s=this.options.get("dropdownAdapter");this.dropdown=new s(e,this.options);this.$dropdown=this.dropdown.render();this.dropdown.position(this.$dropdown,r);var a=this.options.get("resultsAdapter");this.results=new a(e,this.options,this.dataAdapter);this.$results=this.results.render();this.results.position(this.$results,this.$dropdown);var l=this;this._bindAdapters();this._registerDomEvents();this._registerDataEvents();this._registerSelectionEvents();this._registerDropdownEvents();this._registerResultsEvents();this._registerEvents();this.dataAdapter.current(function(e){l.trigger("selection:update",{data:e})});e[0].classList.add("select2-hidden-accessible");e.attr("aria-hidden","true");this._syncAttributes();u.StoreData(e[0],"select2",this);e.data("select2",this)};u.Extend(d,u.Observable);d.prototype._generateId=function(e){var t="";if(e.attr("id")!=null){t=e.attr("id")}else if(e.attr("name")!=null){t=e.attr("name")+"-"+u.generateChars(2)}else{t=u.generateChars(4)}t=t.replace(/(:|\.|\[|\]|,)/g,"");t="select2-"+t;return t};d.prototype._placeContainer=function(e){e.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));if(t!=null){e.css("width",t)}};d.prototype._resolveWidth=function(e,t){var i=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if(t=="resolve"){var n=this._resolveWidth(e,"style");if(n!=null){return n}return this._resolveWidth(e,"element")}if(t=="element"){var r=e.outerWidth(false);if(r<=0){return"auto"}return r+"px"}if(t=="style"){var o=e.attr("style");if(typeof o!=="string"){return null}var s=o.split(";");for(var a=0,l=s.length;a<l;a=a+1){var c=s[a].replace(/\s/g,"");var u=c.match(i);if(u!==null&&u.length>=1){return u[1]}}return null}if(t=="computedstyle"){var d=window.getComputedStyle(e[0]);return d.width}return t};d.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container);this.selection.bind(this,this.$container);this.dropdown.bind(this,this.$container);this.results.bind(this,this.$container)};d.prototype._registerDomEvents=function(){var t=this;this.$element.on("change.select2",function(){t.dataAdapter.current(function(e){t.trigger("selection:update",{data:e})})});this.$element.on("focus.select2",function(e){t.trigger("focus",e)});this._syncA=u.bind(this._syncAttributes,this);this._syncS=u.bind(this._syncSubtree,this);this._observer=new window.MutationObserver(function(e){t._syncA();t._syncS(e)});this._observer.observe(this.$element[0],{attributes:true,childList:true,subtree:false})};d.prototype._registerDataEvents=function(){var i=this;this.dataAdapter.on("*",function(e,t){i.trigger(e,t)})};d.prototype._registerSelectionEvents=function(){var i=this;var n=["toggle","focus"];this.selection.on("toggle",function(){i.toggleDropdown()});this.selection.on("focus",function(e){i.focus(e)});this.selection.on("*",function(e,t){if(n.indexOf(e)!==-1){return}i.trigger(e,t)})};d.prototype._registerDropdownEvents=function(){var i=this;this.dropdown.on("*",function(e,t){i.trigger(e,t)})};d.prototype._registerResultsEvents=function(){var i=this;this.results.on("*",function(e,t){i.trigger(e,t)})};d.prototype._registerEvents=function(){var i=this;this.on("open",function(){i.$container[0].classList.add("select2-container--open")});this.on("close",function(){i.$container[0].classList.remove("select2-container--open")});this.on("enable",function(){i.$container[0].classList.remove("select2-container--disabled")});this.on("disable",function(){i.$container[0].classList.add("select2-container--disabled")});this.on("blur",function(){i.$container[0].classList.remove("select2-container--focus")});this.on("query",function(t){if(!i.isOpen()){i.trigger("open",{})}this.dataAdapter.query(t,function(e){i.trigger("results:all",{data:e,query:t})})});this.on("query:append",function(t){this.dataAdapter.query(t,function(e){i.trigger("results:append",{data:e,query:t})})});this.on("keypress",function(e){var t=e.which;if(i.isOpen()){if(t===n.ESC||t===n.UP&&e.altKey){i.close(e);e.preventDefault()}else if(t===n.ENTER||t===n.TAB){i.trigger("results:select",{});e.preventDefault()}else if(t===n.SPACE&&e.ctrlKey){i.trigger("results:toggle",{});e.preventDefault()}else if(t===n.UP){i.trigger("results:previous",{});e.preventDefault()}else if(t===n.DOWN){i.trigger("results:next",{});e.preventDefault()}}else{if(t===n.ENTER||t===n.SPACE||t===n.DOWN&&e.altKey){i.open();e.preventDefault()}}})};d.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled"));if(this.isDisabled()){if(this.isOpen()){this.close()}this.trigger("disable",{})}else{this.trigger("enable",{})}};d.prototype._isChangeMutation=function(e){var t=this;if(e.addedNodes&&e.addedNodes.length>0){for(var i=0;i<e.addedNodes.length;i++){var n=e.addedNodes[i];if(n.selected){return true}}}else if(e.removedNodes&&e.removedNodes.length>0){return true}else if(Array.isArray(e)){return e.some(function(e){return t._isChangeMutation(e)})}return false};d.prototype._syncSubtree=function(e){var t=this._isChangeMutation(e);var i=this;if(t){this.dataAdapter.current(function(e){i.trigger("selection:update",{data:e})})}};d.prototype.trigger=function(e,t){var i=d.__super__.trigger;var n={open:"opening",close:"closing",select:"selecting",unselect:"unselecting",clear:"clearing"};if(t===undefined){t={}}if(e in n){var r=n[e];var o={prevented:false,name:e,args:t};i.call(this,r,o);if(o.prevented){t.prevented=true;return}}i.call(this,e,t)};d.prototype.toggleDropdown=function(){if(this.isDisabled()){return}if(this.isOpen()){this.close()}else{this.open()}};d.prototype.open=function(){if(this.isOpen()){return}if(this.isDisabled()){return}this.trigger("query",{})};d.prototype.close=function(e){if(!this.isOpen()){return}this.trigger("close",{originalEvent:e})};d.prototype.isEnabled=function(){return!this.isDisabled()};d.prototype.isDisabled=function(){return this.options.get("disabled")};d.prototype.isOpen=function(){return this.$container[0].classList.contains("select2-container--open")};d.prototype.hasFocus=function(){return this.$container[0].classList.contains("select2-container--focus")};d.prototype.focus=function(e){if(this.hasFocus()){return}this.$container[0].classList.add("select2-container--focus");this.trigger("focus",{})};d.prototype.enable=function(e){if(this.options.get("debug")&&window.console&&console.warn){console.warn('Select2: The `select2("enable")` method has been deprecated and will'+' be removed in later Select2 versions. Use $element.prop("disabled")'+" instead.")}if(e==null||e.length===0){e=[true]}var t=!e[0];this.$element.prop("disabled",t)};d.prototype.data=function(){if(this.options.get("debug")&&arguments.length>0&&window.console&&console.warn){console.warn('Select2: Data can no longer be set using `select2("data")`. You '+"should consider setting the value instead using `$element.val()`.")}var t=[];this.dataAdapter.current(function(e){t=e});return t};d.prototype.val=function(e){if(this.options.get("debug")&&window.console&&console.warn){console.warn('Select2: The `select2("val")` method has been deprecated and will be'+" removed in later Select2 versions. Use $element.val() instead.")}if(e==null||e.length===0){return this.$element.val()}var t=e[0];if(Array.isArray(t)){t=t.map(function(e){return e.toString()})}this.$element.val(t).trigger("input").trigger("change")};d.prototype.destroy=function(){u.RemoveData(this.$container[0]);this.$container.remove();this._observer.disconnect();this._observer=null;this._syncA=null;this._syncS=null;this.$element.off(".select2");this.$element.attr("tabindex",u.GetData(this.$element[0],"old-tabindex"));this.$element[0].classList.remove("select2-hidden-accessible");this.$element.attr("aria-hidden","false");u.RemoveData(this.$element[0]);this.$element.removeData("select2");this.dataAdapter.destroy();this.selection.destroy();this.dropdown.destroy();this.results.destroy();this.dataAdapter=null;this.selection=null;this.dropdown=null;this.results=null};d.prototype.render=function(){var e=t('<span class="select2 select2-container">'+'<span class="selection"></span>'+'<span class="dropdown-wrapper" aria-hidden="true"></span>'+"</span>");e.attr("dir",this.options.get("dir"));this.$container=e;this.$container[0].classList.add("select2-container--"+this.options.get("theme"));u.StoreData(e[0],"element",this.$element);return e};return d});t.define("jquery-mousewheel",["jquery"],function(e){return e});t.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults","./select2/utils"],function(r,e,o,t,s){if(r.fn.select2==null){var a=["open","close","destroy"];r.fn.select2=function(i){i=i||{};if(typeof i==="object"){this.each(function(){var e=r.extend(true,{},i);var t=new o(r(this),e)});return this}else if(typeof i==="string"){var t;var n=Array.prototype.slice.call(arguments,1);this.each(function(){var e=s.GetData(this,"select2");if(e==null&&window.console&&console.error){console.error("The select2('"+i+"') method was called on an "+"element that is not using Select2.")}t=e[i].apply(e,n)});if(a.indexOf(i)>-1){return this}return t}else{throw new Error("Invalid arguments for Select2: "+i)}}}if(r.fn.select2.defaults==null){r.fn.select2.defaults=t}return o});return{define:t.define,require:t.require}}();var t=e.require("jquery.select2");i.fn.select2.amd=e;return t});(function(f){f.fn.select2ToTree=function(e){var o=f.extend({},e);if(o.treeData){t(o.treeData,this)}o._templateResult=o.templateResult;o.templateResult=function(e,t){var i=e.text;if(typeof o._templateResult==="function"){i=o._templateResult(e,t)}var n=f("<span class='item-label'></span>").append(i);if(e.element){var r=e.element;t.setAttribute("data-val",r.value);if(r.className)t.className+=" "+r.className;if(r.getAttribute("data-pup")){t.setAttribute("data-pup",r.getAttribute("data-pup"))}if(f(t).hasClass("non-leaf")){return f.merge(f('<span class="expand-collapse" onmouseup="expColMouseupHandler(event);"></span>'),n)}}return n};window.expColMouseupHandler=function(e){i(e.target||e.srcElement);e.stopPropagation?e.stopPropagation():e.cancelBubble=true;e.preventDefault?e.preventDefault():e.returnValue=false};var n=this.select2(o);n.on("select2:open",function(e){var t=n.data("select2");t.$dropdown.addClass("s2-to-tree");t.$dropdown.removeClass("searching-result");var i=t.$dropdown.find(".select2-search__field").add(t.$container.find(".select2-search__field"));i.off("input",r);i.on("input",r)});function r(e){var t=n.data("select2");if(f(this).val().trim().length>0){t.$dropdown.addClass("searching-result")}else{t.$dropdown.removeClass("searching-result")}}return n};function t(c,u){function d(e,t){var i=e;for(var n=0;n<t.length;n++){var r=t[n];if(i[r]){i=i[r];continue}return"MISSING"}return i}function h(e,t,i){var n;if(c.labelFld&&c.labelFld.split(".").length>1){n=c.labelFld.split(".")}var r;if(c.valFld&&c.valFld.split(".").length>1){r=c.valFld.split(".")}for(var o=0;o<e.length;o++){var s=e[o]||{};var a=f("<option></option>");if(n){a.text(d(s,n))}else{a.text(s[c.labelFld||"text"])}if(r){a.val(d(s,r))}else{a.val(s[c.valFld||"id"])}if(s[c.selFld||"selected"]&&String(s[c.selFld||"selected"])==="true"){a.prop("selected",s[c.selFld||"selected"])}if(a.val()===""){a.prop("disabled",true);a.val(p())}a.addClass("l"+t);if(i)a.attr("data-pup",i);u.append(a);var l=s[c.incFld||"inc"];if(l&&l.length>0){a.addClass("non-leaf");h(l,t+1,a.val())}}}h(c.dataArr,1,"");if(c.dftVal)u.val(c.dftVal)}var e=1;function p(){return"autoUniqueVal_"+e++}function i(e){f(e.parentNode).toggleClass("opened");a(e.parentNode)}function a(e){var t=e;var i=f(e).parent(".select2-results__options");var n=true;do{var r=(f(t).attr("data-pup")||"").replace(/'/g,"\\'");t=null;if(r){var o=i.find(".select2-results__option[data-val='"+r+"']");if(o.length>0){if(!o.eq(0).hasClass("opened")){f(e).removeClass("showme");n=false;break}t=o[0]}}}while(t);if(n)f(e).addClass("showme");var s=(f(e).attr("data-val")||"").replace(/'/g,"\\'");i.find(".select2-results__option[data-pup='"+s+"']").each(function(){a(this)})}})(jQuery);var EndlessScroll;EndlessScroll=function(){var n;e.name="EndlessScroll";n={bottomPixels:50,fireOnce:true,fireDelay:150,loader:"Loading...",content:"",insertAfter:"div:last",intervalFrequency:250,resetCounter:function(){return false},callback:function(){return true},ceaseFire:function(){return false}};function e(e,t){var i=this;this.options=$.extend({},n,t);this.firing=true;this.fired=false;this.fireSequence=0;this.didScroll=false;this.isScrollable=true;this.target=e;this.targetId="";this.content="";this.innerWrap=$(".endless_scroll_inner_wrap",this.target);if(this.options.data){this.options.content=this.options.data}$(e).scroll(function(){i.didScroll=true;i.target=e;return i.targetId=$(i.target).attr("id")})}e.prototype.run=function(){var e=this;return setInterval(function(){if(e.shouldTryFiring()){e.didScroll=false;if(e.ceaseFireWhenNecessary()){return}if(e.shouldBeFiring()){e.resetFireSequenceWhenNecessary();e.acknowledgeFiring();e.insertLoader();if(e.hasContent()){e.showContent();e.fireCallback();e.delayFireingWhenNecessary()}return e.removeLoader()}}},this.options.intervalFrequency)};e.prototype.shouldTryFiring=function(){return this.didScroll&&this.firing===true};e.prototype.ceaseFireWhenNecessary=function(){if(this.options.ceaseFire.apply(this.target,[this.fireSequence])){this.firing=false;return true}else{return false}};e.prototype.wrapContainer=function(){if(this.innerWrap.length===0){return this.innerWrap=$(this.target).wrapInner('<div class="endless_scroll_inner_wrap" />').find(".endless_scroll_inner_wrap")}};e.prototype.isScrollableOrNot=function(){if(this.target===document||this.target===window){return this.isScrollable=$(document).height()-$(window).height()<=$(window).scrollTop()+this.options.bottomPixels}else{this.wrapContainer();return this.isScrollable=this.innerWrap.length>0&&this.innerWrap.height()-$(this.target).height()<=$(this.target).scrollTop()+this.options.bottomPixels}};e.prototype.shouldBeFiring=function(){this.isScrollableOrNot();return this.isScrollable&&(this.options.fireOnce===false||this.options.fireOnce===true&&this.fired!==true)};e.prototype.resetFireSequenceWhenNecessary=function(){if(this.options.resetCounter.apply(this.target)===true){return this.fireSequence=0}};e.prototype.acknowledgeFiring=function(){this.fired=true;return this.fireSequence++};e.prototype.insertLoader=function(){return $(this.options.insertAfter).after('<div class="endless_scroll_loader_'+this.targetId+' endless_scroll_loader">'+this.options.loader+"</div>")};e.prototype.removeLoader=function(){return $(".endless_scroll_loader_"+this.targetId).fadeOut(function(){return $(this).remove()})};e.prototype.hasContent=function(){if(typeof this.options.content==="function"){this.content=this.options.content.apply(this.target,[this.fireSequence])}else{this.content=this.options.content}return this.content!==false};e.prototype.showContent=function(){$(this.options.insertAfter).after('<div id="endless_scroll_content">'+this.content+"</div>");return $("#endless_scroll_content").hide().fadeIn(250,function(){return $(this).removeAttr("id")})};e.prototype.fireCallback=function(){return this.options.callback.apply(this.target,[this.fireSequence])};e.prototype.delayFireingWhenNecessary=function(){var e=this;if(this.options.fireDelay>0){$("body").after('<div id="endless_scroll_marker"></div>');return $("#endless_scroll_marker").fadeTo(this.options.fireDelay,1,function(){$("#endless_scroll_marker").remove();return e.fired=false})}else{return this.fired=false}};return e}();(function(e){return e.fn.endlessScroll=function(e){return new EndlessScroll(this,e).run()}})(jQuery);(function(c){var n=[];var e="dirty";var i="clean";var u="dirtyInitialValue";var l="isDirty";var r=function(t){var i;n.forEach(function(e){if(e.id===t){i=e}});return i};const o=function(t){n=n.filter(function(e){return e!==t});t.isDirty=false};var t=function(t){t.form.on("submit",function(){t.submitting=true});if(t.options.preventLeaving){c(window).on("beforeunload",function(e){if(t.isDirty&&!t.submitting){e.preventDefault();return t.options.leavingMessage}})}};var s=function(t){t.form.find("input, select, textarea").on("change.dirty click.dirty keyup.dirty keydown.dirty blur.dirty",function(e){t.checkValues(e)});t.form.on("dirty",function(){t.options.onDirty()});t.form.on("clean",function(){t.options.onClean()})};var a=function(e){e.form.find("input, select, textarea").off("change.dirty click.dirty keyup.dirty keydown.dirty blur.dirty");e.form.off("dirty");e.form.off("clean")};var d=function(e,t){this.form=e;this.isDirty=false;this.options=t;this.history=[i,i];this.id=c(e).attr("id");n.push(this)};d.prototype={init:function(){this.saveInitialValues();this.setEvents()},statuses:{dirty:e,clean:i,dataInitialValue:u,dataIsDirty:l},isRadioOrCheckbox:function(e){return c(e).is(":radio, :checkbox")},isFileInput:function(e){return c(e).is(":file")},saveInitialValues:function(){var o=this;this.form.find("input, select, textarea").each(function(e,t){var i=o.isRadioOrCheckbox(t);var n=o.isFileInput(t);if(i){var r=c(t).is(":checked")?"checked":"unchecked";c(t).data(u,r)}else if(n){c(t).data(u,JSON.stringify(t.files))}else{c(t).data(u,c(t).val()||"")}})},refreshEvents:function(){var e=this;a(e);s(e)},showDirtyFields:function(){var e=this;return e.form.find("input, select, textarea").filter(function(e,t){return c(t).data(l)})},setEvents:function(){var e=this;t(e);s(e)},isFieldDirty:function(e){var t=e.data(u);if(t==null){t=""}var i=e.val();if(i==null){i=""}var n=/^(true|false)$/i;var r=n.test(t)&&n.test(i);if(r){var o=new RegExp("^"+t+"$","i");return!o.test(i)}return i!==t},isFileInputDirty:function(e){var t=e.data(u);var i=e[0];var n=JSON.stringify(i.files);return n!==t},isCheckboxDirty:function(e){var t=e.data(u);var i=e.is(":checked")?"checked":"unchecked";return t!==i},checkValues:function(e){var s=this;var a=false;this.form.find("input, select, textarea").each(function(e,t){var i=s.isRadioOrCheckbox(t);var n=s.isFileInput(t);var r=c(t);var o;if(i){o=s.isCheckboxDirty(r)}else if(n){o=s.isFileInputDirty(r)}else{o=s.isFieldDirty(r)}r.data(l,o);a|=o});if(a){s.setDirty()}else{s.setClean()}},setDirty:function(){this.isDirty=true;this.history[0]=this.history[1];this.history[1]=e;if(this.options.fireEventsOnEachChange||this.wasJustClean()){this.form.trigger("dirty")}},setClean:function(){this.isDirty=false;this.history[0]=this.history[1];this.history[1]=i;if(this.options.fireEventsOnEachChange||this.wasJustDirty()){this.form.trigger("clean")}},wasJustDirty:function(){return this.history[0]===e},wasJustClean:function(){return this.history[0]===i},setAsClean:function(){this.saveInitialValues();this.setClean()},setAsDirty:function(){this.saveInitialValues();this.setDirty()},resetForm:function(){var l=this;this.form.find("input, select, textarea").each(function(e,t){var i=c(t);var n=l.isRadioOrCheckbox(t);var r=l.isFileInput(t);if(n){var o=i.data(u);var s=o==="checked";i.prop("checked",s)}if(r){t.value="";c(t).data(u,JSON.stringify(t.files))}else{var a=i.data(u);i.val(a)}});this.checkValues()}};c.fn.dirty=function(n){if(typeof n==="string"){var e=r(c(this).attr("id"));if(!e){return null}if(/^(isDirty|isClean|refreshEvents|resetForm|setAsClean|setAsDirty|showDirtyFields|destroy)$/i.test(n)){var t=n.toLowerCase();switch(t){case"isclean":return!e.isDirty;case"isdirty":return e.isDirty;case"refreshevents":return e.refreshEvents();case"resetform":return e.resetForm();case"setasclean":return e.setAsClean();case"setasdirty":return e.setAsDirty();case"showdirtyfields":return e.showDirtyFields();case"destroy":return o(e)}}else{return e[n].apply(e,Array.prototype.slice.call(arguments,1))}}else{return this.each(function(e,t){n=c.extend({},c.fn.dirty.defaults,n);var i=new d(c(t),n);i.init()})}};c.fn.dirty.singleton=r;c.fn.dirty.defaults={preventLeaving:false,leavingMessage:"There are unsaved changes on this page which will be discarded if you continue.",onDirty:c.noop,onClean:c.noop,fireEventsOnEachChange:false};c.fn.dirty.extend=function(e){c.extend(d.prototype,e)};c.fn.dirty.constructor=d;c.fn.dirty.prototype=d.prototype})(jQuery);!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).bootstrap=t()}(this,function(){"use strict";const y="transitionend",b=t=>{let i=t.getAttribute("data-bs-target");if(!i||"#"===i){let e=t.getAttribute("href");if(!e||!e.includes("#")&&!e.startsWith("."))return null;e.includes("#")&&!e.startsWith("#")&&(e=`#${e.split("#")[1]}`),i=e&&"#"!==e?e.trim():null}return i},_=e=>{const t=b(e);return t&&document.querySelector(t)?t:null},o=e=>{const t=b(e);return t?document.querySelector(t):null},w=e=>{e.dispatchEvent(new Event(y))},a=e=>!(!e||"object"!=typeof e)&&(void 0!==e.jquery&&(e=e[0]),void 0!==e.nodeType),r=e=>a(e)?e.jquery?e[0]:e:"string"==typeof e&&e.length>0?document.querySelector(e):null,n=e=>{if(!a(e)||0===e.getClientRects().length)return!1;const t="visible"===getComputedStyle(e).getPropertyValue("visibility"),i=e.closest("details:not([open])");if(!i)return t;if(i!==e){const t=e.closest("summary");if(t&&t.parentNode!==i)return!1;if(null===t)return!1}return t},s=e=>!e||e.nodeType!==Node.ELEMENT_NODE||!!e.classList.contains("disabled")||(void 0!==e.disabled?e.disabled:e.hasAttribute("disabled")&&"false"!==e.getAttribute("disabled")),C=t=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof t.getRootNode){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?C(t.parentNode):null},x=()=>{},S=e=>{e.offsetHeight},A=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,E=[],l=()=>"rtl"===document.documentElement.dir,e=n=>{var e;e=()=>{const i=A();if(i){const e=n.NAME,t=i.fn[e];i.fn[e]=n.jQueryInterface,i.fn[e].Constructor=n,i.fn[e].noConflict=()=>(i.fn[e]=t,n.jQueryInterface)}},"loading"===document.readyState?(E.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of E)e()}),E.push(e)):e()},c=e=>{"function"==typeof e&&e()},T=(t,i,e=!0)=>{if(!e)return void c(t);const n=(e=>{if(!e)return 0;let{transitionDuration:t,transitionDelay:i}=window.getComputedStyle(e);const n=Number.parseFloat(t),r=Number.parseFloat(i);return n||r?(t=t.split(",")[0],i=i.split(",")[0],1e3*(Number.parseFloat(t)+Number.parseFloat(i))):0})(i)+5;let r=!1;const o=({target:e})=>{e===i&&(r=!0,i.removeEventListener(y,o),c(t))};i.addEventListener(y,o),setTimeout(()=>{r||w(i)},n)},$=(e,t,i,n)=>{const r=e.length;let o=e.indexOf(t);return-1===o?!i&&n?e[r-1]:e[0]:(o+=i?1:-1,n&&(o=(o+r)%r),e[Math.max(0,Math.min(o,r-1))])},H=/[^.]*(?=\..*)\.|.*/,B=/\..*/,V=/::\d+$/,j={};let z=1;const W={mouseenter:"mouseover",mouseleave:"mouseout"},U=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Y(e,t){return t&&`${t}::${z++}`||e.uidEvent||z++}function q(e){const t=Y(e);return e.uidEvent=t,j[t]=j[t]||{},j[t]}function K(e,t,i=null){return Object.values(e).find(e=>e.callable===t&&e.delegationSelector===i)}function X(e,t,i){const n="string"==typeof t,r=n?i:t||i;let o=ee(e);return U.has(o)||(o=e),[n,r,o]}function Z(e,t,i,n,r){if("string"!=typeof t||!e)return;let[o,s,a]=X(t,i,n);if(t in W){const e=t=>function(e){if(!e.relatedTarget||e.relatedTarget!==e.delegateTarget&&!e.delegateTarget.contains(e.relatedTarget))return t.call(this,e)};s=e(s)}const l=q(e),c=l[a]||(l[a]={}),u=K(c,s,o?i:null);if(u)return void(u.oneOff=u.oneOff&&r);const d=Y(s,t.replace(H,"")),h=o?function(o,s,a){return function i(n){const r=o.querySelectorAll(s);for(let{target:t}=n;t&&t!==this;t=t.parentNode)for(const e of r)if(e===t)return te(n,{delegateTarget:t}),i.oneOff&&f.off(o,n.type,s,a),a.apply(t,[n])}}(e,i,s):function(i,n){return function e(t){return te(t,{delegateTarget:i}),e.oneOff&&f.off(i,t.type,n),n.apply(i,[t])}}(e,s);h.delegationSelector=o?i:null,h.callable=s,h.oneOff=r,h.uidEvent=d,c[d]=h,e.addEventListener(a,h,o)}function Q(e,t,i,n,r){const o=K(t[i],n,r);o&&(e.removeEventListener(i,o,Boolean(r)),delete t[i][o.uidEvent])}function J(t,i,n,r){const o=i[n]||{};for(const e of Object.keys(o))if(e.includes(r)){const r=o[e];Q(t,i,n,r.callable,r.delegationSelector)}}function ee(e){return e=e.replace(B,""),W[e]||e}const f={on(e,t,i,n){Z(e,t,i,n,!1)},one(e,t,i,n){Z(e,t,i,n,!0)},off(e,t,i,n){if("string"!=typeof t||!e)return;const[r,o,s]=X(t,i,n),a=s!==t,l=q(e),c=l[s]||{},u=t.startsWith(".");if(void 0===o){if(u)for(const i of Object.keys(l))J(e,l,i,t.slice(1));for(const i of Object.keys(c)){const n=i.replace(V,"");if(!a||t.includes(n)){const t=c[i];Q(e,l,s,t.callable,t.delegationSelector)}}}else{if(!Object.keys(c).length)return;Q(e,l,s,o,r?i:null)}},trigger(e,t,i){if("string"!=typeof t||!e)return null;const n=A();let r=null,o=!0,s=!0,a=!1;t!==ee(t)&&n&&(r=n.Event(t,i),n(e).trigger(r),o=!r.isPropagationStopped(),s=!r.isImmediatePropagationStopped(),a=r.isDefaultPrevented());let l=new Event(t,{bubbles:o,cancelable:!0});return l=te(l,i),a&&l.preventDefault(),s&&e.dispatchEvent(l),l.defaultPrevented&&r&&r.preventDefault(),l}};function te(i,n){for(const[e,t]of Object.entries(n||{}))try{i[e]=t}catch(n){Object.defineProperty(i,e,{configurable:!0,get:()=>t})}return i}const u=new Map,ie={set(e,t,i){u.has(e)||u.set(e,new Map);const n=u.get(e);n.has(t)||0===n.size?n.set(t,i):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(n.keys())[0]}.`)},get:(e,t)=>u.has(e)&&u.get(e).get(t)||null,remove(e,t){if(!u.has(e))return;const i=u.get(e);i.delete(t),0===i.size&&u.delete(e)}};function ne(t){if("true"===t)return!0;if("false"===t)return!1;if(t===Number(t).toString())return Number(t);if(""===t||"null"===t)return null;if("string"!=typeof t)return t;try{return JSON.parse(decodeURIComponent(t))}catch(e){return t}}function re(e){return e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const d={setDataAttribute(e,t,i){e.setAttribute(`data-bs-${re(t)}`,i)},removeDataAttribute(e,t){e.removeAttribute(`data-bs-${re(t)}`)},getDataAttributes(i){if(!i)return{};const n={},e=Object.keys(i.dataset).filter(e=>e.startsWith("bs")&&!e.startsWith("bsConfig"));for(const t of e){let e=t.replace(/^bs/,"");e=e.charAt(0).toLowerCase()+e.slice(1,e.length),n[e]=ne(i.dataset[t])}return n},getDataAttribute:(e,t)=>ne(e.getAttribute(`data-bs-${re(t)}`))};class oe{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const i=a(t)?d.getDataAttribute(t,"config"):{};return{...this.constructor.Default,..."object"==typeof i?i:{},...a(t)?d.getDataAttributes(t):{},..."object"==typeof e?e:{}}}_typeCheckConfig(r,o=this.constructor.DefaultType){for(const n of Object.keys(o)){const e=o[n],t=r[n],i=a(t)?"element":null==(s=t)?`${s}`:Object.prototype.toString.call(s).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(e).test(i))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${i}" but expected type "${e}".`)}var s}}class t extends oe{constructor(e,t){super(),(e=r(e))&&(this._element=e,this._config=this._getConfig(t),ie.set(this._element,this.constructor.DATA_KEY,this))}dispose(){ie.remove(this._element,this.constructor.DATA_KEY),f.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,i=!0){T(e,t,i)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return ie.get(r(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,"object"==typeof t?t:null)}static get VERSION(){return"5.2.3"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const se=(i,n="hide")=>{const e=`click.dismiss${i.EVENT_KEY}`,r=i.NAME;f.on(document,e,`[data-bs-dismiss="${r}"]`,function(e){if(["A","AREA"].includes(this.tagName)&&e.preventDefault(),s(this))return;const t=o(this)||this.closest(`.${r}`);i.getOrCreateInstance(t)[n]()})};class ae extends t{static get NAME(){return"alert"}close(){if(f.trigger(this._element,"close.bs.alert").defaultPrevented)return;this._element.classList.remove("show");const e=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,e)}_destroyElement(){this._element.remove(),f.trigger(this._element,"closed.bs.alert"),this.dispose()}static jQueryInterface(t){return this.each(function(){const e=ae.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}})}}se(ae,"close"),e(ae);const le='[data-bs-toggle="button"]';class ce extends t{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(t){return this.each(function(){const e=ce.getOrCreateInstance(this);"toggle"===t&&e[t]()})}}f.on(document,"click.bs.button.data-api",le,e=>{e.preventDefault();const t=e.target.closest(le);ce.getOrCreateInstance(t).toggle()}),e(ce);const h={find:(e,t=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(t,e)),findOne:(e,t=document.documentElement)=>Element.prototype.querySelector.call(t,e),children:(e,t)=>[].concat(...e.children).filter(e=>e.matches(t)),parents(e,t){const i=[];let n=e.parentNode.closest(t);for(;n;)i.push(n),n=n.parentNode.closest(t);return i},prev(e,t){let i=e.previousElementSibling;for(;i;){if(i.matches(t))return[i];i=i.previousElementSibling}return[]},next(e,t){let i=e.nextElementSibling;for(;i;){if(i.matches(t))return[i];i=i.nextElementSibling}return[]},focusableChildren(e){const t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(e=>`${e}:not([tabindex^="-"])`).join(",");return this.find(t,e).filter(e=>!s(e)&&n(e))}},ve={endCallback:null,leftCallback:null,rightCallback:null},ye={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class be extends oe{constructor(e,t){super(),this._element=e,e&&be.isSupported()&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return ve}static get DefaultType(){return ye}static get NAME(){return"swipe"}dispose(){f.off(this._element,".bs.swipe")}_start(e){this._supportPointerEvents?this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX):this._deltaX=e.touches[0].clientX}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),c(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=40)return;const t=e/this._deltaX;this._deltaX=0,t&&c(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(f.on(this._element,"pointerdown.bs.swipe",e=>this._start(e)),f.on(this._element,"pointerup.bs.swipe",e=>this._end(e)),this._element.classList.add("pointer-event")):(f.on(this._element,"touchstart.bs.swipe",e=>this._start(e)),f.on(this._element,"touchmove.bs.swipe",e=>this._move(e)),f.on(this._element,"touchend.bs.swipe",e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&("pen"===e.pointerType||"touch"===e.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const _e="next",p="prev",i="left",we="right",Ce="slid.bs.carousel",xe="carousel",Se="active",Ae={ArrowLeft:we,ArrowRight:i},Ee={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Te={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class De extends t{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=h.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===xe&&this.cycle()}static get Default(){return Ee}static get DefaultType(){return Te}static get NAME(){return"carousel"}next(){this._slide(_e)}nextWhenVisible(){!document.hidden&&n(this._element)&&this.next()}prev(){this._slide(p)}pause(){this._isSliding&&w(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?f.one(this._element,Ce,()=>this.cycle()):this.cycle())}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding)return void f.one(this._element,Ce,()=>this.to(e));const i=this._getItemIndex(this._getActive());if(i===e)return;const n=e>i?_e:p;this._slide(n,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&f.on(this._element,"keydown.bs.carousel",e=>this._keydown(e)),"hover"===this._config.pause&&(f.on(this._element,"mouseenter.bs.carousel",()=>this.pause()),f.on(this._element,"mouseleave.bs.carousel",()=>this._maybeEnableCycle())),this._config.touch&&be.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const e of h.find(".carousel-item img",this._element))f.on(e,"dragstart.bs.carousel",e=>e.preventDefault());const e={leftCallback:()=>this._slide(this._directionToOrder(i)),rightCallback:()=>this._slide(this._directionToOrder(we)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new be(this._element,e)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=Ae[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=h.findOne(".active",this._indicatorsElement);t.classList.remove(Se),t.removeAttribute("aria-current");const i=h.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);i&&(i.classList.add(Se),i.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(t,e=null){if(this._isSliding)return;const i=this._getActive(),n=t===_e,r=e||$(this._getItems(),i,n,this._config.wrap);if(r===i)return;const o=this._getItemIndex(r),s=e=>f.trigger(this._element,e,{relatedTarget:r,direction:this._orderToDirection(t),from:this._getItemIndex(i),to:o});if(s("slide.bs.carousel").defaultPrevented)return;if(!i||!r)return;const a=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(o),this._activeElement=r;const l=n?"carousel-item-start":"carousel-item-end",c=n?"carousel-item-next":"carousel-item-prev";r.classList.add(c),S(r),i.classList.add(l),r.classList.add(l),this._queueCallback(()=>{r.classList.remove(l,c),r.classList.add(Se),i.classList.remove(Se,c,l),this._isSliding=!1,s(Ce)},i,this._isAnimated()),a&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return h.findOne(".active.carousel-item",this._element)}_getItems(){return h.find(".carousel-item",this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return l()?e===i?p:_e:e===i?_e:p}_orderToDirection(e){return l()?e===p?i:we:e===p?we:i}static jQueryInterface(t){return this.each(function(){const e=De.getOrCreateInstance(this,t);if("number"!=typeof t){if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}else e.to(t)})}}f.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",function(e){const t=o(this);if(!t||!t.classList.contains(xe))return;e.preventDefault();const i=De.getOrCreateInstance(t),n=this.getAttribute("data-bs-slide-to");return n?(i.to(n),void i._maybeEnableCycle()):"next"===d.getDataAttribute(this,"slide")?(i.next(),void i._maybeEnableCycle()):(i.prev(),void i._maybeEnableCycle())}),f.on(window,"load.bs.carousel.data-api",()=>{const t=h.find('[data-bs-ride="carousel"]');for(const e of t)De.getOrCreateInstance(e)}),e(De);const Re="show",Me="collapse",ke="collapsing",Oe='[data-bs-toggle="collapse"]',Ne={parent:null,toggle:!0},Ie={parent:"(null|element)",toggle:"boolean"};class Le extends t{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const i=h.find(Oe);for(const e of i){const t=_(e),i=h.find(t).filter(e=>e===this._element);null!==t&&i.length&&this._triggerArray.push(e)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Ne}static get DefaultType(){return Ie}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(e=>e!==this._element).map(e=>Le.getOrCreateInstance(e,{toggle:!1}))),e.length&&e[0]._isTransitioning)return;if(f.trigger(this._element,"show.bs.collapse").defaultPrevented)return;for(const t of e)t.hide();const t=this._getDimension();this._element.classList.remove(Me),this._element.classList.add(ke),this._element.style[t]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=`scroll${t[0].toUpperCase()+t.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(ke),this._element.classList.add(Me,Re),this._element.style[t]="",f.trigger(this._element,"shown.bs.collapse")},this._element,!0),this._element.style[t]=`${this._element[i]}px`}hide(){if(this._isTransitioning||!this._isShown())return;if(f.trigger(this._element,"hide.bs.collapse").defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,S(this._element),this._element.classList.add(ke),this._element.classList.remove(Me,Re);for(const t of this._triggerArray){const e=o(t);e&&!this._isShown(e)&&this._addAriaAndCollapsedClass([t],!1)}this._isTransitioning=!0,this._element.style[t]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(ke),this._element.classList.add(Me),f.trigger(this._element,"hidden.bs.collapse")},this._element,!0)}_isShown(e=this._element){return e.classList.contains(Re)}_configAfterMerge(e){return e.toggle=Boolean(e.toggle),e.parent=r(e.parent),e}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const t=this._getFirstLevelChildren(Oe);for(const e of t){const t=o(e);t&&this._addAriaAndCollapsedClass([e],this._isShown(t))}}_getFirstLevelChildren(e){const t=h.find(":scope .collapse .collapse",this._config.parent);return h.find(e,this._config.parent).filter(e=>!t.includes(e))}_addAriaAndCollapsedClass(t,i){if(t.length)for(const e of t)e.classList.toggle("collapsed",!i),e.setAttribute("aria-expanded",i)}static jQueryInterface(t){const i={};return"string"==typeof t&&/show|hide/.test(t)&&(i.toggle=!1),this.each(function(){const e=Le.getOrCreateInstance(this,i);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}}f.on(document,"click.bs.collapse.data-api",Oe,function(e){("A"===e.target.tagName||e.delegateTarget&&"A"===e.delegateTarget.tagName)&&e.preventDefault();const t=_(this),i=h.find(t);for(const e of i)Le.getOrCreateInstance(e,{toggle:!1}).toggle()}),e(Le);var ue="top",de="bottom",he="right",fe="left",Pe="auto",R=[ue,de,he,fe],pe="start",D="end",Fe="clippingParents",Ge="viewport",M="popper",$e="reference",He=R.reduce(function(e,t){return e.concat([t+"-"+pe,t+"-"+D])},[]),Be=[].concat(R,[Pe]).reduce(function(e,t){return e.concat([t,t+"-"+pe,t+"-"+D])},[]),Ve="beforeRead",je="read",ze="afterRead",We="beforeMain",Ue="main",Ye="afterMain",qe="beforeWrite",Ke="write",Xe="afterWrite",Ze=[Ve,je,ze,We,Ue,Ye,qe,Ke,Xe];function k(e){return e?(e.nodeName||"").toLowerCase():null}function O(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function N(e){return e instanceof O(e).Element||e instanceof Element}function I(e){return e instanceof O(e).HTMLElement||e instanceof HTMLElement}function Qe(e){return"undefined"!=typeof ShadowRoot&&(e instanceof O(e).ShadowRoot||e instanceof ShadowRoot)}const Je={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var r=e.state;Object.keys(r.elements).forEach(function(e){var t=r.styles[e]||{},i=r.attributes[e]||{},n=r.elements[e];I(n)&&k(n)&&(Object.assign(n.style,t),Object.keys(i).forEach(function(e){var t=i[e];!1===t?n.removeAttribute(e):n.setAttribute(e,!0===t?"":t)}))})},effect:function(e){var r=e.state,o={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(r.elements.popper.style,o.popper),r.styles=o,r.elements.arrow&&Object.assign(r.elements.arrow.style,o.arrow),function(){Object.keys(r.elements).forEach(function(e){var t=r.elements[e],i=r.attributes[e]||{},n=Object.keys(r.styles.hasOwnProperty(e)?r.styles[e]:o[e]).reduce(function(e,t){return e[t]="",e},{});I(t)&&k(t)&&(Object.assign(t.style,n),Object.keys(i).forEach(function(e){t.removeAttribute(e)}))})}},requires:["computeStyles"]};function ge(e){return e.split("-")[0]}var me=Math.max,et=Math.min,L=Math.round;function tt(){var e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function it(){return!/^((?!chrome|android).)*safari/i.test(tt())}function P(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1);var n=e.getBoundingClientRect(),r=1,o=1;t&&I(e)&&(r=e.offsetWidth>0&&L(n.width)/e.offsetWidth||1,o=e.offsetHeight>0&&L(n.height)/e.offsetHeight||1);var s=(N(e)?O(e):window).visualViewport,a=!it()&&i,l=(n.left+(a&&s?s.offsetLeft:0))/r,c=(n.top+(a&&s?s.offsetTop:0))/o,u=n.width/r,d=n.height/o;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l,x:l,y:c}}function nt(e){var t=P(e),i=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:n}}function rt(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&Qe(i)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function F(e){return O(e).getComputedStyle(e)}function ot(e){return["table","td","th"].indexOf(k(e))>=0}function G(e){return((N(e)?e.ownerDocument:e.document)||window.document).documentElement}function st(e){return"html"===k(e)?e:e.assignedSlot||e.parentNode||(Qe(e)?e.host:null)||G(e)}function at(e){return I(e)&&"fixed"!==F(e).position?e.offsetParent:null}function lt(e){for(var t=O(e),i=at(e);i&&ot(i)&&"static"===F(i).position;)i=at(i);return i&&("html"===k(i)||"body"===k(i)&&"static"===F(i).position)?t:i||function(e){var t=/firefox/i.test(tt());if(/Trident/i.test(tt())&&I(e)&&"fixed"===F(e).position)return null;var i=st(e);for(Qe(i)&&(i=i.host);I(i)&&["html","body"].indexOf(k(i))<0;){var n=F(i);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return i;i=i.parentNode}return null}(e)||t}function ct(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function ut(e,t,i){return me(e,et(t,i))}function dt(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function ht(i,e){return e.reduce(function(e,t){return e[t]=i,e},{})}const ft={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,i=e.state,n=e.name,r=e.options,o=i.elements.arrow,s=i.modifiersData.popperOffsets,a=ge(i.placement),l=ct(a),c=[fe,he].indexOf(a)>=0?"height":"width";if(o&&s){var u=function(e,t){return dt("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:ht(e,R))}(r.padding,i),d=nt(o),h="y"===l?ue:fe,f="y"===l?de:he,p=i.rects.reference[c]+i.rects.reference[l]-s[l]-i.rects.popper[c],g=s[l]-i.rects.reference[l],m=lt(o),v=m?"y"===l?m.clientHeight||0:m.clientWidth||0:0,y=p/2-g/2,b=u[h],_=v-d[c]-u[f],w=v/2-d[c]/2+y,C=ut(b,w,_),x=l;i.modifiersData[n]=((t={})[x]=C,t.centerOffset=C-w,t)}},effect:function(e){var t=e.state,i=e.options.element,n=void 0===i?"[data-popper-arrow]":i;null!=n&&("string"!=typeof n||(n=t.elements.popper.querySelector(n)))&&rt(t.elements.popper,n)&&(t.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function pt(e){return e.split("-")[1]}var gt={top:"auto",right:"auto",bottom:"auto",left:"auto"};function mt(e){var t,i=e.popper,n=e.popperRect,r=e.placement,o=e.variation,s=e.offsets,a=e.position,l=e.gpuAcceleration,c=e.adaptive,u=e.roundOffsets,d=e.isFixed,h=s.x,f=void 0===h?0:h,p=s.y,g=void 0===p?0:p,m="function"==typeof u?u({x:f,y:g}):{x:f,y:g};f=m.x,g=m.y;var v=s.hasOwnProperty("x"),y=s.hasOwnProperty("y"),b=fe,_=ue,w=window;if(c){var C=lt(i),x="clientHeight",S="clientWidth";C===O(i)&&"static"!==F(C=G(i)).position&&"absolute"===a&&(x="scrollHeight",S="scrollWidth"),(r===ue||(r===fe||r===he)&&o===D)&&(_=de,g-=(d&&C===w&&w.visualViewport?w.visualViewport.height:C[x])-n.height,g*=l?1:-1),r!==fe&&(r!==ue&&r!==de||o!==D)||(b=he,f-=(d&&C===w&&w.visualViewport?w.visualViewport.width:C[S])-n.width,f*=l?1:-1)}var A,E=Object.assign({position:a},c&&gt),T=!0===u?function(e){var t=e.x,i=e.y,n=window.devicePixelRatio||1;return{x:L(t*n)/n||0,y:L(i*n)/n||0}}({x:f,y:g}):{x:f,y:g};return f=T.x,g=T.y,l?Object.assign({},E,((A={})[_]=y?"0":"",A[b]=v?"0":"",A.transform=(w.devicePixelRatio||1)<=1?"translate("+f+"px, "+g+"px)":"translate3d("+f+"px, "+g+"px, 0)",A)):Object.assign({},E,((t={})[_]=y?g+"px":"",t[b]=v?f+"px":"",t.transform="",t))}const vt={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,i=e.options,n=i.gpuAcceleration,r=void 0===n||n,o=i.adaptive,s=void 0===o||o,a=i.roundOffsets,l=void 0===a||a,c={placement:ge(t.placement),variation:pt(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,mt(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:s,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,mt(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}};var yt={passive:!0};const bt={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,i=e.instance,n=e.options,r=n.scroll,o=void 0===r||r,s=n.resize,a=void 0===s||s,l=O(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&c.forEach(function(e){e.addEventListener("scroll",i.update,yt)}),a&&l.addEventListener("resize",i.update,yt),function(){o&&c.forEach(function(e){e.removeEventListener("scroll",i.update,yt)}),a&&l.removeEventListener("resize",i.update,yt)}},data:{}};var _t={left:"right",right:"left",bottom:"top",top:"bottom"};function wt(e){return e.replace(/left|right|bottom|top/g,function(e){return _t[e]})}var Ct={start:"end",end:"start"};function xt(e){return e.replace(/start|end/g,function(e){return Ct[e]})}function St(e){var t=O(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function At(e){return P(G(e)).left+St(e).scrollLeft}function Et(e){var t=F(e),i=t.overflow,n=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+r+n)}function Tt(e){return["html","body","#document"].indexOf(k(e))>=0?e.ownerDocument.body:I(e)&&Et(e)?e:Tt(st(e))}function Dt(e,t){var i;void 0===t&&(t=[]);var n=Tt(e),r=n===(null==(i=e.ownerDocument)?void 0:i.body),o=O(n),s=r?[o].concat(o.visualViewport||[],Et(n)?n:[]):n,a=t.concat(s);return r?a:a.concat(Dt(st(s)))}function Rt(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Mt(e,t,i){return t===Ge?Rt(function(e,t){var i=O(e),n=G(e),r=i.visualViewport,o=n.clientWidth,s=n.clientHeight,a=0,l=0;if(r){o=r.width,s=r.height;var c=it();(c||!c&&"fixed"===t)&&(a=r.offsetLeft,l=r.offsetTop)}return{width:o,height:s,x:a+At(e),y:l}}(e,i)):N(t)?function(e,t){var i=P(e,!1,"fixed"===t);return i.top=i.top+e.clientTop,i.left=i.left+e.clientLeft,i.bottom=i.top+e.clientHeight,i.right=i.left+e.clientWidth,i.width=e.clientWidth,i.height=e.clientHeight,i.x=i.left,i.y=i.top,i}(t,i):Rt(function(e){var t,i=G(e),n=St(e),r=null==(t=e.ownerDocument)?void 0:t.body,o=me(i.scrollWidth,i.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),s=me(i.scrollHeight,i.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-n.scrollLeft+At(e),l=-n.scrollTop;return"rtl"===F(r||i).direction&&(a+=me(i.clientWidth,r?r.clientWidth:0)-o),{width:o,height:s,x:a,y:l}}(G(e)))}function kt(e){var t,i=e.reference,n=e.element,r=e.placement,o=r?ge(r):null,s=r?pt(r):null,a=i.x+i.width/2-n.width/2,l=i.y+i.height/2-n.height/2;switch(o){case ue:t={x:a,y:i.y-n.height};break;case de:t={x:a,y:i.y+i.height};break;case he:t={x:i.x+i.width,y:l};break;case fe:t={x:i.x-n.width,y:l};break;default:t={x:i.x,y:i.y}}var c=o?ct(o):null;if(null!=c){var u="y"===c?"height":"width";switch(s){case pe:t[c]=t[c]-(i[u]/2-n[u]/2);break;case D:t[c]=t[c]+(i[u]/2-n[u]/2)}}return t}function Ot(e,t){void 0===t&&(t={});var i=t,n=i.placement,r=void 0===n?e.placement:n,o=i.strategy,s=void 0===o?e.strategy:o,a=i.boundary,l=void 0===a?Fe:a,c=i.rootBoundary,u=void 0===c?Ge:c,d=i.elementContext,h=void 0===d?M:d,f=i.altBoundary,p=void 0!==f&&f,g=i.padding,m=void 0===g?0:g,v=dt("number"!=typeof m?m:ht(m,R)),y=h===M?$e:M,b=e.rects.popper,_=e.elements[p?y:h],w=function(n,e,t,r){var i="clippingParents"===e?function(e){var t=Dt(st(e)),i=["absolute","fixed"].indexOf(F(e).position)>=0&&I(e)?lt(e):e;return N(i)?t.filter(function(e){return N(e)&&rt(e,i)&&"body"!==k(e)}):[]}(n):[].concat(e),o=[].concat(i,[t]),s=o[0],a=o.reduce(function(e,t){var i=Mt(n,t,r);return e.top=me(i.top,e.top),e.right=et(i.right,e.right),e.bottom=et(i.bottom,e.bottom),e.left=me(i.left,e.left),e},Mt(n,s,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}(N(_)?_:_.contextElement||G(e.elements.popper),l,u,s),C=P(e.elements.reference),x=kt({reference:C,element:b,strategy:"absolute",placement:r}),S=Rt(Object.assign({},b,x)),A=h===M?S:C,E={top:w.top-A.top+v.top,bottom:A.bottom-w.bottom+v.bottom,left:w.left-A.left+v.left,right:A.right-w.right+v.right},T=e.modifiersData.offset;if(h===M&&T){var D=T[r];Object.keys(E).forEach(function(e){var t=[he,de].indexOf(e)>=0?1:-1,i=[ue,de].indexOf(e)>=0?"y":"x";E[e]+=D[i]*t})}return E}function Nt(i,e){void 0===e&&(e={});var t=e,n=t.placement,r=t.boundary,o=t.rootBoundary,s=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,c=void 0===l?Be:l,u=pt(n),d=u?a?He:He.filter(function(e){return pt(e)===u}):R,h=d.filter(function(e){return c.indexOf(e)>=0});0===h.length&&(h=d);var f=h.reduce(function(e,t){return e[t]=Ot(i,{placement:t,boundary:r,rootBoundary:o,padding:s})[ge(t)],e},{});return Object.keys(f).sort(function(e,t){return f[e]-f[t]})}const It={name:"flip",enabled:!0,phase:"main",fn:function(e){var i=e.state,t=e.options,n=e.name;if(!i.modifiersData[n]._skip){for(var r=t.mainAxis,o=void 0===r||r,s=t.altAxis,a=void 0===s||s,l=t.fallbackPlacements,c=t.padding,u=t.boundary,d=t.rootBoundary,h=t.altBoundary,f=t.flipVariations,p=void 0===f||f,g=t.allowedAutoPlacements,m=i.options.placement,v=ge(m),y=l||(v!==m&&p?function(e){if(ge(e)===Pe)return[];var t=wt(e);return[xt(e),t,xt(t)]}(m):[wt(m)]),b=[m].concat(y).reduce(function(e,t){return e.concat(ge(t)===Pe?Nt(i,{placement:t,boundary:u,rootBoundary:d,padding:c,flipVariations:p,allowedAutoPlacements:g}):t)},[]),_=i.rects.reference,w=i.rects.popper,C=new Map,x=!0,S=b[0],A=0;A<b.length;A++){var E=b[A],T=ge(E),D=pt(E)===pe,R=[ue,de].indexOf(T)>=0,M=R?"width":"height",k=Ot(i,{placement:E,boundary:u,rootBoundary:d,altBoundary:h,padding:c}),O=R?D?he:fe:D?de:ue;_[M]>w[M]&&(O=wt(O));var N=wt(O),I=[];if(o&&I.push(k[T]<=0),a&&I.push(k[O]<=0,k[N]<=0),I.every(function(e){return e})){S=E,x=!1;break}C.set(E,I)}if(x)for(var P=function(i){var e=b.find(function(e){var t=C.get(e);if(t)return t.slice(0,i).every(function(e){return e})});if(e)return S=e,"break"},L=p?3:1;L>0&&"break"!==P(L);L--);i.placement!==S&&(i.modifiersData[n]._skip=!0,i.placement=S,i.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Lt(e,t,i){return void 0===i&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function Pt(t){return[ue,he,de,fe].some(function(e){return t[e]>=0})}const Ft={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,i=e.name,n=t.rects.reference,r=t.rects.popper,o=t.modifiersData.preventOverflow,s=Ot(t,{elementContext:"reference"}),a=Ot(t,{altBoundary:!0}),l=Lt(s,n),c=Lt(a,r,o),u=Pt(l),d=Pt(c);t.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}},Gt={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var i=e.state,t=e.options,n=e.name,r=t.offset,o=void 0===r?[0,0]:r,s=Be.reduce(function(e,t){return e[t]=function(e,t,i){var n=ge(e),r=[fe,ue].indexOf(n)>=0?-1:1,o="function"==typeof i?i(Object.assign({},t,{placement:e})):i,s=o[0],a=o[1];return s=s||0,a=(a||0)*r,[fe,he].indexOf(n)>=0?{x:a,y:s}:{x:s,y:a}}(t,i.rects,o),e},{}),a=s[i.placement],l=a.x,c=a.y;null!=i.modifiersData.popperOffsets&&(i.modifiersData.popperOffsets.x+=l,i.modifiersData.popperOffsets.y+=c),i.modifiersData[n]=s}},$t={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,i=e.name;t.modifiersData[i]=kt({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},Ht={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,P=e.name,n=i.mainAxis,F=void 0===n||n,r=i.altAxis,G=void 0!==r&&r,$=i.boundary,H=i.rootBoundary,B=i.altBoundary,V=i.padding,o=i.tether,s=void 0===o||o,a=i.tetherOffset,l=void 0===a?0:a,c=Ot(t,{boundary:$,rootBoundary:H,padding:V,altBoundary:B}),u=ge(t.placement),d=pt(t.placement),h=!d,f=ct(u),p="x"===f?"y":"x",g=t.modifiersData.popperOffsets,m=t.rects.reference,v=t.rects.popper,y="function"==typeof l?l(Object.assign({},t.rects,{placement:t.placement})):l,b="number"==typeof y?{mainAxis:y,altAxis:y}:Object.assign({mainAxis:0,altAxis:0},y),_=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,w={x:0,y:0};if(g){if(F){var C,x="y"===f?ue:fe,S="y"===f?de:he,A="y"===f?"height":"width",E=g[f],T=E+c[x],D=E-c[S],R=s?-v[A]/2:0,j=d===pe?m[A]:v[A],z=d===pe?-v[A]:-m[A],M=t.elements.arrow,W=s&&M?nt(M):{width:0,height:0},U=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Y=U[x],q=U[S],k=ut(0,m[A],W[A]),K=h?m[A]/2-R-k-Y-b.mainAxis:j-k-Y-b.mainAxis,X=h?-m[A]/2+R+k+q+b.mainAxis:z+k+q+b.mainAxis,O=t.elements.arrow&&lt(t.elements.arrow),Z=O?"y"===f?O.clientTop||0:O.clientLeft||0:0,Q=null!=(C=null==_?void 0:_[f])?C:0,J=E+X-Q,ee=ut(s?et(T,E+K-Q-Z):T,E,s?me(D,J):D);g[f]=ee,w[f]=ee-E}if(G){var te,ie="x"===f?ue:fe,ne="x"===f?de:he,N=g[p],I="y"===p?"height":"width",re=N+c[ie],oe=N-c[ne],L=-1!==[ue,fe].indexOf(u),se=null!=(te=null==_?void 0:_[p])?te:0,ae=L?re:N-m[I]-v[I]-se+b.altAxis,le=L?N+m[I]+v[I]-se-b.altAxis:oe,ce=s&&L?function(e,t,i){var n=ut(e,t,i);return n>i?i:n}(ae,N,le):ut(s?ae:re,N,s?le:oe);g[p]=ce,w[p]=ce-N}t.modifiersData[P]=w}},requiresIfExists:["offset"]};function Bt(e,t,i){void 0===i&&(i=!1);var n,r,o=I(t),s=I(t)&&function(e){var t=e.getBoundingClientRect(),i=L(t.width)/e.offsetWidth||1,n=L(t.height)/e.offsetHeight||1;return 1!==i||1!==n}(t),a=G(t),l=P(e,s,i),c={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(o||!o&&!i)&&(("body"!==k(t)||Et(a))&&(c=(n=t)!==O(n)&&I(n)?{scrollLeft:(r=n).scrollLeft,scrollTop:r.scrollTop}:St(n)),I(t)?((u=P(t,!0)).x+=t.clientLeft,u.y+=t.clientTop):a&&(u.x=At(a))),{x:l.left+c.scrollLeft-u.x,y:l.top+c.scrollTop-u.y,width:l.width,height:l.height}}function Vt(e){var i=new Map,n=new Set,t=[];function r(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach(function(e){if(!n.has(e)){var t=i.get(e);t&&r(t)}}),t.push(e)}return e.forEach(function(e){i.set(e.name,e)}),e.forEach(function(e){n.has(e.name)||r(e)}),t}var jt={placement:"bottom",modifiers:[],strategy:"absolute"};function zt(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some(function(e){return!(e&&"function"==typeof e.getBoundingClientRect)})}function Wt(e){void 0===e&&(e={});var t=e,i=t.defaultModifiers,h=void 0===i?[]:i,n=t.defaultOptions,f=void 0===n?jt:n;return function(o,s,t){void 0===t&&(t=f);var i,n,c={placement:"bottom",orderedModifiers:[],options:Object.assign({},jt,f),modifiersData:{},elements:{reference:o,popper:s},attributes:{},styles:{}},a=[],u=!1,d={state:c,setOptions:function(e){var t="function"==typeof e?e(c.options):e;l(),c.options=Object.assign({},f,c.options,t),c.scrollParents={reference:N(o)?Dt(o):o.contextElement?Dt(o.contextElement):[],popper:Dt(s)};var i,n,r=function(e){var i=Vt(e);return Ze.reduce(function(e,t){return e.concat(i.filter(function(e){return e.phase===t}))},[])}((i=[].concat(h,c.options.modifiers),n=i.reduce(function(e,t){var i=e[t.name];return e[t.name]=i?Object.assign({},i,t,{options:Object.assign({},i.options,t.options),data:Object.assign({},i.data,t.data)}):t,e},{}),Object.keys(n).map(function(e){return n[e]})));return c.orderedModifiers=r.filter(function(e){return e.enabled}),c.orderedModifiers.forEach(function(e){var t=e.name,i=e.options,n=void 0===i?{}:i,r=e.effect;if("function"==typeof r){var o=r({state:c,name:t,instance:d,options:n});a.push(o||function(){})}}),d.update()},forceUpdate:function(){if(!u){var e=c.elements,t=e.reference,i=e.popper;if(zt(t,i)){c.rects={reference:Bt(t,lt(i),"fixed"===c.options.strategy),popper:nt(i)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(e){return c.modifiersData[e.name]=Object.assign({},e.data)});for(var n=0;n<c.orderedModifiers.length;n++)if(!0!==c.reset){var r=c.orderedModifiers[n],o=r.fn,s=r.options,a=void 0===s?{}:s,l=r.name;"function"==typeof o&&(c=o({state:c,options:a,name:l,instance:d})||c)}else c.reset=!1,n=-1}}},update:(i=function(){return new Promise(function(e){d.forceUpdate(),e(c)})},function(){return n||(n=new Promise(function(e){Promise.resolve().then(function(){n=void 0,e(i())})})),n}),destroy:function(){l(),u=!0}};if(!zt(o,s))return d;function l(){a.forEach(function(e){return e()}),a=[]}return d.setOptions(t).then(function(e){!u&&t.onFirstUpdate&&t.onFirstUpdate(e)}),d}}var Ut=Wt(),Yt=Wt({defaultModifiers:[bt,$t,vt,Je]}),qt=Wt({defaultModifiers:[bt,$t,vt,Je,Gt,It,Ht,ft,Ft]});const Kt=Object.freeze(Object.defineProperty({__proto__:null,popperGenerator:Wt,detectOverflow:Ot,createPopperBase:Ut,createPopper:qt,createPopperLite:Yt,top:ue,bottom:de,right:he,left:fe,auto:Pe,basePlacements:R,start:pe,end:D,clippingParents:Fe,viewport:Ge,popper:M,reference:$e,variationPlacements:He,placements:Be,beforeRead:Ve,read:je,afterRead:ze,beforeMain:We,main:Ue,afterMain:Ye,beforeWrite:qe,write:Ke,afterWrite:Xe,modifierPhases:Ze,applyStyles:Je,arrow:ft,computeStyles:vt,eventListeners:bt,flip:It,hide:Ft,offset:Gt,popperOffsets:$t,preventOverflow:Ht},Symbol.toStringTag,{value:"Module"})),Xt="dropdown",Zt="ArrowUp",Qt="ArrowDown",Jt="click.bs.dropdown.data-api",ei="keydown.bs.dropdown.data-api",ti="show",g='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',ii=`${g}.show`,ni=".dropdown-menu",ri=l()?"top-end":"top-start",oi=l()?"top-start":"top-end",si=l()?"bottom-end":"bottom-start",ai=l()?"bottom-start":"bottom-end",li=l()?"left-start":"right-start",ci=l()?"right-start":"left-start",ui={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},di={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class m extends t{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=h.next(this._element,ni)[0]||h.prev(this._element,ni)[0]||h.findOne(ni,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return ui}static get DefaultType(){return di}static get NAME(){return Xt}toggle(){return this._isShown()?this.hide():this.show()}show(){if(s(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!f.trigger(this._element,"show.bs.dropdown",e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const e of[].concat(...document.body.children))f.on(e,"mouseover",x);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(ti),this._element.classList.add(ti),f.trigger(this._element,"shown.bs.dropdown",e)}}hide(){if(s(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!f.trigger(this._element,"hide.bs.dropdown",e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))f.off(e,"mouseover",x);this._popper&&this._popper.destroy(),this._menu.classList.remove(ti),this._element.classList.remove(ti),this._element.setAttribute("aria-expanded","false"),d.removeDataAttribute(this._menu,"popper"),f.trigger(this._element,"hidden.bs.dropdown",e)}}_getConfig(e){if("object"==typeof(e=super._getConfig(e)).reference&&!a(e.reference)&&"function"!=typeof e.reference.getBoundingClientRect)throw new TypeError(`${Xt.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(void 0===Kt)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let e=this._element;"parent"===this._config.reference?e=this._parent:a(this._config.reference)?e=r(this._config.reference):"object"==typeof this._config.reference&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=qt(e,this._menu,t)}_isShown(){return this._menu.classList.contains(ti)}_getPlacement(){const e=this._parent;if(e.classList.contains("dropend"))return li;if(e.classList.contains("dropstart"))return ci;if(e.classList.contains("dropup-center"))return"top";if(e.classList.contains("dropdown-center"))return"bottom";const t="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return e.classList.contains("dropup")?t?oi:ri:t?ai:si}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map(e=>Number.parseInt(e,10)):"function"==typeof t?e=>t(e,this._element):t}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(d.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,..."function"==typeof this._config.popperConfig?this._config.popperConfig(e):this._config.popperConfig}}_selectMenuItem({key:e,target:t}){const i=h.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(e=>n(e));i.length&&$(i,t,e===Qt,!i.includes(t)).focus()}static jQueryInterface(t){return this.each(function(){const e=m.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}static clearMenus(r){if(2===r.button||"keyup"===r.type&&"Tab"!==r.key)return;const o=h.find(ii);for(const n of o){const o=m.getInstance(n);if(!o||!1===o._config.autoClose)continue;const e=r.composedPath(),t=e.includes(o._menu);if(e.includes(o._element)||"inside"===o._config.autoClose&&!t||"outside"===o._config.autoClose&&t)continue;if(o._menu.contains(r.target)&&("keyup"===r.type&&"Tab"===r.key||/input|select|option|textarea|form/i.test(r.target.tagName)))continue;const i={relatedTarget:o._element};"click"===r.type&&(i.clickEvent=r),o._completeHide(i)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),i="Escape"===e.key,n=[Zt,Qt].includes(e.key);if(!n&&!i)return;if(t&&!i)return;e.preventDefault();const r=this.matches(g)?this:h.prev(this,g)[0]||h.next(this,g)[0]||h.findOne(g,e.delegateTarget.parentNode),o=m.getOrCreateInstance(r);if(n)return e.stopPropagation(),o.show(),void o._selectMenuItem(e);o._isShown()&&(e.stopPropagation(),o.hide(),r.focus())}}f.on(document,ei,g,m.dataApiKeydownHandler),f.on(document,ei,ni,m.dataApiKeydownHandler),f.on(document,Jt,m.clearMenus),f.on(document,"keyup.bs.dropdown.data-api",m.clearMenus),f.on(document,Jt,g,function(e){e.preventDefault(),m.getOrCreateInstance(this).toggle()}),e(m);const hi=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",fi=".sticky-top",pi="padding-right",gi="margin-right";class mi{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,pi,e=>e+t),this._setElementAttributes(hi,pi,e=>e+t),this._setElementAttributes(fi,gi,e=>e-t)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,pi),this._resetElementAttributes(hi,pi),this._resetElementAttributes(fi,gi)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,i,n){const r=this.getWidth();this._applyManipulationCallback(e,e=>{if(e!==this._element&&window.innerWidth>e.clientWidth+r)return;this._saveInitialAttribute(e,i);const t=window.getComputedStyle(e).getPropertyValue(i);e.style.setProperty(i,`${n(Number.parseFloat(t))}px`)})}_saveInitialAttribute(e,t){const i=e.style.getPropertyValue(t);i&&d.setDataAttribute(e,t,i)}_resetElementAttributes(e,i){this._applyManipulationCallback(e,e=>{const t=d.getDataAttribute(e,i);null!==t?(d.removeDataAttribute(e,i),e.style.setProperty(i,t)):e.style.removeProperty(i)})}_applyManipulationCallback(t,i){if(a(t))i(t);else for(const e of h.find(t,this._element))i(e)}}const vi="show",yi="mousedown.bs.backdrop",bi={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},_i={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class wi extends oe{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return bi}static get DefaultType(){return _i}static get NAME(){return"backdrop"}show(e){if(!this._config.isVisible)return void c(e);this._append();const t=this._getElement();this._config.isAnimated&&S(t),t.classList.add(vi),this._emulateAnimation(()=>{c(e)})}hide(e){this._config.isVisible?(this._getElement().classList.remove(vi),this._emulateAnimation(()=>{this.dispose(),c(e)})):c(e)}dispose(){this._isAppended&&(f.off(this._element,yi),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add("fade"),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=r(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),f.on(e,yi,()=>{c(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){T(e,this._getElement(),this._config.isAnimated)}}const Ci=".bs.focustrap",xi="backward",Si={autofocus:!0,trapElement:null},Ai={autofocus:"boolean",trapElement:"element"};class Ei extends oe{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Si}static get DefaultType(){return Ai}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),f.off(document,Ci),f.on(document,"focusin.bs.focustrap",e=>this._handleFocusin(e)),f.on(document,"keydown.tab.bs.focustrap",e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,f.off(document,Ci))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const i=h.focusableChildren(t);0===i.length?t.focus():this._lastTabNavDirection===xi?i[i.length-1].focus():i[0].focus()}_handleKeydown(e){"Tab"===e.key&&(this._lastTabNavDirection=e.shiftKey?xi:"forward")}}const Ti="hidden.bs.modal",Di="show.bs.modal",Ri="modal-open",Mi="show",ki="modal-static",Oi={backdrop:!0,focus:!0,keyboard:!0},Ni={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Ii extends t{constructor(e,t){super(e,t),this._dialog=h.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new mi,this._addEventListeners()}static get Default(){return Oi}static get DefaultType(){return Ni}static get NAME(){return"modal"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||f.trigger(this._element,Di,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Ri),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){this._isShown&&!this._isTransitioning&&(f.trigger(this._element,"hide.bs.modal").defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Mi),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){for(const e of[window,this._dialog])f.off(e,".bs.modal");this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new wi({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Ei({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=h.findOne(".modal-body",this._dialog);t&&(t.scrollTop=0),S(this._element),this._element.classList.add(Mi),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,f.trigger(this._element,"shown.bs.modal",{relatedTarget:e})},this._dialog,this._isAnimated())}_addEventListeners(){f.on(this._element,"keydown.dismiss.bs.modal",e=>{if("Escape"===e.key)return this._config.keyboard?(e.preventDefault(),void this.hide()):void this._triggerBackdropTransition()}),f.on(window,"resize.bs.modal",()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),f.on(this._element,"mousedown.dismiss.bs.modal",t=>{f.one(this._element,"click.dismiss.bs.modal",e=>{this._element===t.target&&this._element===e.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Ri),this._resetAdjustments(),this._scrollBar.reset(),f.trigger(this._element,Ti)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(f.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented)return;const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._element.style.overflowY;"hidden"===t||this._element.classList.contains(ki)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add(ki),this._queueCallback(()=>{this._element.classList.remove(ki),this._queueCallback(()=>{this._element.style.overflowY=t},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),i=t>0;if(i&&!e){const e=l()?"paddingLeft":"paddingRight";this._element.style[e]=`${t}px`}if(!i&&e){const e=l()?"paddingRight":"paddingLeft";this._element.style[e]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,i){return this.each(function(){const e=Ii.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](i)}})}}f.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',function(e){const t=o(this);["A","AREA"].includes(this.tagName)&&e.preventDefault(),f.one(t,Di,e=>{e.defaultPrevented||f.one(t,Ti,()=>{n(this)&&this.focus()})});const i=h.findOne(".modal.show");i&&Ii.getInstance(i).hide(),Ii.getOrCreateInstance(t).toggle(this)}),se(Ii),e(Ii);const Li="show",Pi="showing",Fi="hiding",Gi=".offcanvas.show",$i="hidePrevented.bs.offcanvas",Hi="hidden.bs.offcanvas",Bi={backdrop:!0,keyboard:!0,scroll:!1},Vi={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class v extends t{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Bi}static get DefaultType(){return Vi}static get NAME(){return"offcanvas"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||f.trigger(this._element,"show.bs.offcanvas",{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new mi).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Pi),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(Li),this._element.classList.remove(Pi),f.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:e})},this._element,!0))}hide(){this._isShown&&(f.trigger(this._element,"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Fi),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(Li,Fi),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new mi).reset(),f.trigger(this._element,Hi)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=Boolean(this._config.backdrop);return new wi({className:"offcanvas-backdrop",isVisible:e,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:e?()=>{"static"!==this._config.backdrop?this.hide():f.trigger(this._element,$i)}:null})}_initializeFocusTrap(){return new Ei({trapElement:this._element})}_addEventListeners(){f.on(this._element,"keydown.dismiss.bs.offcanvas",e=>{"Escape"===e.key&&(this._config.keyboard?this.hide():f.trigger(this._element,$i))})}static jQueryInterface(t){return this.each(function(){const e=v.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}})}}f.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',function(e){const t=o(this);if(["A","AREA"].includes(this.tagName)&&e.preventDefault(),s(this))return;f.one(t,Hi,()=>{n(this)&&this.focus()});const i=h.findOne(Gi);i&&i!==t&&v.getInstance(i).hide(),v.getOrCreateInstance(t).toggle(this)}),f.on(window,"load.bs.offcanvas.data-api",()=>{for(const e of h.find(Gi))v.getOrCreateInstance(e).show()}),f.on(window,"resize.bs.offcanvas",()=>{for(const e of h.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(e).position&&v.getOrCreateInstance(e).hide()}),se(v),e(v);const ji=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),zi=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,Wi=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,Ui=(e,t)=>{const i=e.nodeName.toLowerCase();return t.includes(i)?!ji.has(i)||Boolean(zi.test(e.nodeValue)||Wi.test(e.nodeValue)):t.filter(e=>e instanceof RegExp).some(e=>e.test(i))},Yi={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},qi={allowList:Yi,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Ki={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Xi={entry:"(string|element|function|null)",selector:"(string|element)"};class Zi extends oe{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return qi}static get DefaultType(){return Ki}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[t,i]of Object.entries(this._config.content))this._setContent(e,i,t);const t=e.children[0],i=this._resolvePossibleFunction(this._config.extraClass);return i&&t.classList.add(...i.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(i){for(const[e,t]of Object.entries(i))super._typeCheckConfig({selector:e,entry:t},Xi)}_setContent(e,t,i){const n=h.findOne(i,e);n&&((t=this._resolvePossibleFunction(t))?a(t)?this._putElementInTemplate(r(t),n):this._config.html?n.innerHTML=this._maybeSanitize(t):n.textContent=t:n.remove())}_maybeSanitize(e){return this._config.sanitize?function(e,t,i){if(!e.length)return e;if(i&&"function"==typeof i)return i(e);const n=(new window.DOMParser).parseFromString(e,"text/html"),r=[].concat(...n.body.querySelectorAll("*"));for(const e of r){const i=e.nodeName.toLowerCase();if(!Object.keys(t).includes(i)){e.remove();continue}const n=[].concat(...e.attributes),r=[].concat(t["*"]||[],t[i]||[]);for(const t of n)Ui(t,r)||e.removeAttribute(t.nodeName)}return n.body.innerHTML}(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return"function"==typeof e?e(this):e}_putElementInTemplate(e,t){if(this._config.html)return t.innerHTML="",void t.append(e);t.textContent=e.textContent}}const Qi=new Set(["sanitize","allowList","sanitizeFn"]),Ji="fade",en="show",tn=".modal",nn="hide.bs.modal",rn="hover",on="focus",sn={AUTO:"auto",TOP:"top",RIGHT:l()?"left":"right",BOTTOM:"bottom",LEFT:l()?"right":"left"},an={allowList:Yi,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,0],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},ln={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class cn extends t{constructor(e,t){if(void 0===Kt)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return an}static get DefaultType(){return ln}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),f.off(this._element.closest(tn),nn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const e=f.trigger(this._element,this.constructor.eventName("show")),t=(C(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!t)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:n}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(n.append(i),f.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(i),i.classList.add(en),"ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))f.on(e,"mouseover",x);this._queueCallback(()=>{f.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!f.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(en),"ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))f.off(e,"mouseover",x);this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),f.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Ji,en),t.classList.add(`bs-${this.constructor.NAME}-auto`);const i=(e=>{do{e+=Math.floor(1e6*Math.random())}while(document.getElementById(e));return e})(this.constructor.NAME).toString();return t.setAttribute("id",i),this._isAnimated()&&t.classList.add(Ji),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Zi({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ji)}_isShown(){return this.tip&&this.tip.classList.contains(en)}_createPopper(e){const t="function"==typeof this._config.placement?this._config.placement.call(this,e,this._element):this._config.placement,i=sn[t.toUpperCase()];return qt(this._element,e,this._getPopperConfig(i))}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map(e=>Number.parseInt(e,10)):"function"==typeof t?e=>t(e,this._element):t}_resolvePossibleFunction(e){return"function"==typeof e?e.call(this._element):e}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:e=>{this._getTipElement().setAttribute("data-popper-placement",e.state.placement)}}]};return{...t,..."function"==typeof this._config.popperConfig?this._config.popperConfig(t):this._config.popperConfig}}_setListeners(){const i=this._config.trigger.split(" ");for(const t of i)if("click"===t)f.on(this._element,this.constructor.eventName("click"),this._config.selector,e=>{this._initializeOnDelegatedTarget(e).toggle()});else if("manual"!==t){const i=t===rn?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),e=t===rn?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");f.on(this._element,i,this._config.selector,e=>{const t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusin"===e.type?on:rn]=!0,t._enter()}),f.on(this._element,e,this._config.selector,e=>{const t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusout"===e.type?on:rn]=t._element.contains(e.relatedTarget),t._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},f.on(this._element.closest(tn),nn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=d.getDataAttributes(this._element);for(const e of Object.keys(t))Qi.has(e)&&delete t[e];return e={...t,..."object"==typeof e&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=!1===e.container?document.body:r(e.container),"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),"number"==typeof e.title&&(e.title=e.title.toString()),"number"==typeof e.content&&(e.content=e.content.toString()),e}_getDelegateConfig(){const t={};for(const e in this._config)this.constructor.Default[e]!==this._config[e]&&(t[e]=this._config[e]);return t.selector=!1,t.trigger="manual",t}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each(function(){const e=cn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}}e(cn);const un={...cn.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},dn={...cn.DefaultType,content:"(null|string|element|function)"};class hn extends cn{static get Default(){return un}static get DefaultType(){return dn}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each(function(){const e=hn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}}e(hn);const fn="click.bs.scrollspy",pn="active",gn="[href]",mn={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},vn={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class yn extends t{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return mn}static get DefaultType(){return vn}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=r(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,"string"==typeof e.threshold&&(e.threshold=e.threshold.split(",").map(e=>Number.parseFloat(e))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(f.off(this._config.target,fn),f.on(this._config.target,fn,gn,i=>{const n=this._observableSections.get(i.target.hash);if(n){i.preventDefault();const e=this._rootElement||window,t=n.offsetTop-this._element.offsetTop;if(e.scrollTo)return void e.scrollTo({top:t,behavior:"smooth"});e.scrollTop=t}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(e=>this._observerCallback(e),e)}_observerCallback(t){const i=e=>this._targetLinks.get(`#${e.target.id}`),n=e=>{this._previousScrollData.visibleEntryTop=e.target.offsetTop,this._process(i(e))},r=(this._rootElement||document.documentElement).scrollTop,o=r>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=r;for(const e of t){if(!e.isIntersecting){this._activeTarget=null,this._clearActiveClass(i(e));continue}const t=e.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(o&&t){if(n(e),!r)return}else o||t||n(e)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const t=h.find(gn,this._config.target);for(const e of t){if(!e.hash||s(e))continue;const t=h.findOne(e.hash,this._element);n(t)&&(this._targetLinks.set(e.hash,e),this._observableSections.set(e.hash,t))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(pn),this._activateParents(e),f.trigger(this._element,"activate.bs.scrollspy",{relatedTarget:e}))}_activateParents(t){if(t.classList.contains("dropdown-item"))h.findOne(".dropdown-toggle",t.closest(".dropdown")).classList.add(pn);else for(const e of h.parents(t,".nav, .list-group"))for(const t of h.prev(e,".nav-link, .nav-item > .nav-link, .list-group-item"))t.classList.add(pn)}_clearActiveClass(e){e.classList.remove(pn);const t=h.find("[href].active",e);for(const e of t)e.classList.remove(pn)}static jQueryInterface(t){return this.each(function(){const e=yn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}})}}f.on(window,"load.bs.scrollspy.data-api",()=>{for(const e of h.find('[data-bs-spy="scroll"]'))yn.getOrCreateInstance(e)}),e(yn);const bn="ArrowLeft",_n="ArrowRight",wn="ArrowUp",Cn="ArrowDown",xn="active",Sn="fade",An="show",En='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Tn=`.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), ${En}`;class Dn extends t{constructor(e){super(e),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),f.on(this._element,"keydown.bs.tab",e=>this._keydown(e)))}static get NAME(){return"tab"}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),i=t?f.trigger(t,"hide.bs.tab",{relatedTarget:e}):null;f.trigger(e,"show.bs.tab",{relatedTarget:t}).defaultPrevented||i&&i.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){e&&(e.classList.add(xn),this._activate(o(e)),this._queueCallback(()=>{"tab"===e.getAttribute("role")?(e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),f.trigger(e,"shown.bs.tab",{relatedTarget:t})):e.classList.add(An)},e,e.classList.contains(Sn)))}_deactivate(e,t){e&&(e.classList.remove(xn),e.blur(),this._deactivate(o(e)),this._queueCallback(()=>{"tab"===e.getAttribute("role")?(e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),f.trigger(e,"hidden.bs.tab",{relatedTarget:t})):e.classList.remove(An)},e,e.classList.contains(Sn)))}_keydown(e){if(![bn,_n,wn,Cn].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=[_n,Cn].includes(e.key),i=$(this._getChildren().filter(e=>!s(e)),e.target,t,!0);i&&(i.focus({preventScroll:!0}),Dn.getOrCreateInstance(i).show())}_getChildren(){return h.find(Tn,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const e of t)this._setInitialAttributesOnChild(e)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),i=this._getOuterElement(e);e.setAttribute("aria-selected",t),i!==e&&this._setAttributeIfNotExists(i,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=o(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`#${e.id}`))}_toggleDropDown(e,n){const r=this._getOuterElement(e);if(!r.classList.contains("dropdown"))return;const t=(e,t)=>{const i=h.findOne(e,r);i&&i.classList.toggle(t,n)};t(".dropdown-toggle",xn),t(".dropdown-menu",An),r.setAttribute("aria-expanded",n)}_setAttributeIfNotExists(e,t,i){e.hasAttribute(t)||e.setAttribute(t,i)}_elemIsActive(e){return e.classList.contains(xn)}_getInnerElement(e){return e.matches(Tn)?e:h.findOne(Tn,e)}_getOuterElement(e){return e.closest(".nav-item, .list-group-item")||e}static jQueryInterface(t){return this.each(function(){const e=Dn.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}})}}f.on(document,"click.bs.tab",En,function(e){["A","AREA"].includes(this.tagName)&&e.preventDefault(),s(this)||Dn.getOrCreateInstance(this).show()}),f.on(window,"load.bs.tab",()=>{for(const e of h.find('.active[data-bs-toggle="tab"], .active[data-bs-toggle="pill"], .active[data-bs-toggle="list"]'))Dn.getOrCreateInstance(e)}),e(Dn);const Rn="hide",Mn="show",kn="showing",On={animation:"boolean",autohide:"boolean",delay:"number"},Nn={animation:!0,autohide:!0,delay:5e3};class In extends t{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Nn}static get DefaultType(){return On}static get NAME(){return"toast"}show(){f.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(Rn),S(this._element),this._element.classList.add(Mn,kn),this._queueCallback(()=>{this._element.classList.remove(kn),f.trigger(this._element,"shown.bs.toast"),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(f.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add(kn),this._queueCallback(()=>{this._element.classList.add(Rn),this._element.classList.remove(kn,Mn),f.trigger(this._element,"hidden.bs.toast")},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Mn),super.dispose()}isShown(){return this._element.classList.contains(Mn)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":this._hasMouseInteraction=t;break;case"focusin":case"focusout":this._hasKeyboardInteraction=t}if(t)return void this._clearTimeout();const i=e.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){f.on(this._element,"mouseover.bs.toast",e=>this._onInteraction(e,!0)),f.on(this._element,"mouseout.bs.toast",e=>this._onInteraction(e,!1)),f.on(this._element,"focusin.bs.toast",e=>this._onInteraction(e,!0)),f.on(this._element,"focusout.bs.toast",e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each(function(){const e=In.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](this)}})}}return se(In),e(In),{Alert:ae,Button:ce,Carousel:De,Collapse:Le,Dropdown:m,Modal:Ii,Offcanvas:v,Popover:hn,ScrollSpy:yn,Tab:Dn,Toast:In,Tooltip:cn}});!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Chart=t()}(this,function(){"use strict";var n=Object.freeze({__proto__:null,get Colors(){return Zo},get Decimation(){return es},get Filler(){return vs},get Legend(){return ws},get SubTitle(){return As},get Title(){return xs},get Tooltip(){return Gs}});function e(){}const G=(()=>{let e=0;return()=>e++})();function T(e){return null==e}function M(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function k(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function p(e){return("number"==typeof e||e instanceof Number)&&isFinite(+e)}function g(e,t){return p(e)?e:t}function O(e,t){return void 0===e?t:e}const $=(e,t)=>"string"==typeof e&&e.endsWith("%")?parseFloat(e)/100:+e/t,H=(e,t)=>"string"==typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function f(e,t,i){if(e&&"function"==typeof e.call)return e.apply(i,t)}function S(e,t,i,n){let r,o,s;if(M(e))if(o=e.length,n)for(r=o-1;r>=0;r--)t.call(i,e[r],r);else for(r=0;r<o;r++)t.call(i,e[r],r);else if(k(e))for(s=Object.keys(e),o=s.length,r=0;r<o;r++)t.call(i,e[s[r]],s[r])}function B(e,t){let i,n,r,o;if(!e||!t||e.length!==t.length)return!1;for(i=0,n=e.length;i<n;++i)if(r=e[i],o=t[i],r.datasetIndex!==o.datasetIndex||r.index!==o.index)return!1;return!0}function V(r){if(M(r))return r.map(V);if(k(r)){const e=Object.create(null),t=Object.keys(r),i=t.length;let n=0;for(;n<i;++n)e[t[n]]=V(r[t[n]]);return e}return r}function j(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function z(e,t,i,n){if(!j(e))return;const r=t[e],o=i[e];k(r)&&k(o)?W(r,o,n):t[e]=V(o)}function W(i,e,n){const t=M(e)?e:[e],r=t.length;if(!k(i))return i;const o=(n=n||{}).merger||z;let s;for(let e=0;e<r;++e){if(s=t[e],!k(s))continue;const M=Object.keys(s);for(let e=0,t=M.length;e<t;++e)o(M[e],i,s,n)}return i}function U(e,t){return W(e,t,{merger:o})}function o(e,t,i){if(!j(e))return;const n=t[e],r=i[e];k(n)&&k(r)?U(n,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=V(r))}const Y={"":e=>e,x:e=>e.x,y:e=>e.y};function q(e){const t=e.split("."),i=[];let n="";for(const e of t)n+=e,n.endsWith("\\")?n=n.slice(0,-1)+".":(i.push(n),n="");return i}function m(e,t){const i=Y[t]||(Y[t]=function(e){const i=q(e);return t=>{for(const e of i){if(""===e)break;t=t&&t[e]}return t}}(t));return i(e)}function K(e){return e.charAt(0).toUpperCase()+e.slice(1)}const X=e=>void 0!==e,l=e=>"function"==typeof e,Z=(t,i)=>{if(t.size!==i.size)return!1;for(const e of t)if(!i.has(e))return!1;return!0};function Q(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}const N=Math.PI,_=2*N,J=_+N,ee=Number.POSITIVE_INFINITY,te=N/180,I=N/2,ie=N/4,ne=2*N/3,c=Math.log10,v=Math.sign;function re(e,t,i){return Math.abs(e-t)<i}function oe(e){const t=Math.round(e);e=re(e,t,e/1e3)?t:e;const i=Math.pow(10,Math.floor(c(e))),n=e/i;return(n<=1?1:n<=2?2:n<=5?5:10)*i}function se(e){const t=[],i=Math.sqrt(e);let n;for(n=1;n<i;n++)e%n==0&&(t.push(n),t.push(e/n));return i===(0|i)&&t.push(i),t.sort((e,t)=>e-t).pop(),t}function ae(e){return!isNaN(parseFloat(e))&&isFinite(e)}function le(e,t){const i=Math.round(e);return i-t<=e&&i+t>=e}function ce(e,t,i){let n,r,o;for(n=0,r=e.length;n<r;n++)o=e[n][i],isNaN(o)||(t.min=Math.min(t.min,o),t.max=Math.max(t.max,o))}function L(e){return e*(N/180)}function ue(e){return e*(180/N)}function de(e){if(!p(e))return;let t=1,i=0;for(;Math.round(e*t)/t!==e;)t*=10,i++;return i}function he(e,t){const i=t.x-e.x,n=t.y-e.y,r=Math.sqrt(i*i+n*n);let o=Math.atan2(n,i);return o<-.5*N&&(o+=_),{angle:o,distance:r}}function fe(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function pe(e,t){return(e-t+J)%_-N}function y(e){return(e%_+_)%_}function ge(e,t,i,n){const r=y(e),o=y(t),s=y(i),a=y(o-r),l=y(s-r),c=y(r-o),u=y(r-s);return r===o||r===s||n&&o===s||a>l&&c<u}function b(e,t,i){return Math.max(t,Math.min(i,e))}function me(e){return b(e,-32768,32767)}function w(e,t,i,n=1e-6){return e>=Math.min(t,i)-n&&e<=Math.max(t,i)+n}function ve(t,i,e){e=e||(e=>t[e]<i);let n,r=t.length-1,o=0;for(;r-o>1;)n=o+r>>1,e(n)?o=n:r=n;return{lo:o,hi:r}}const C=(i,n,r,e)=>ve(i,r,e?e=>{const t=i[e][n];return t<r||t===r&&i[e+1][n]===r}:e=>i[e][n]<r),ye=(t,i,n)=>ve(t,n,e=>t[e][i]>=n);function be(e,t,i){let n=0,r=e.length;for(;n<r&&e[n]<t;)n++;for(;r>n&&e[r-1]>i;)r--;return n>0||r<e.length?e.slice(n,r):e}const _e=["push","pop","shift","splice","unshift"];function we(r,e){r._chartjs?r._chartjs.listeners.push(e):(Object.defineProperty(r,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),_e.forEach(e=>{const i="_onData"+K(e),n=r[e];Object.defineProperty(r,e,{configurable:!0,enumerable:!1,value(...t){const e=n.apply(this,t);return r._chartjs.listeners.forEach(e=>{"function"==typeof e[i]&&e[i](...t)}),e}})}))}function Ce(t,e){const i=t._chartjs;if(!i)return;const n=i.listeners,r=n.indexOf(e);-1!==r&&n.splice(r,1),n.length>0||(_e.forEach(e=>{delete t[e]}),delete t._chartjs)}function xe(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const Se="undefined"==typeof window?function(e){return e()}:window.requestAnimationFrame;function Ae(t,i){let n=[],r=!1;return function(...e){n=e,r||(r=!0,Se.call(window,()=>{r=!1,t.apply(i,n)}))}}function Ee(t,i){let n;return function(...e){return i?(clearTimeout(n),n=setTimeout(t,i,e)):t.apply(this,e),i}}const Te=e=>"start"===e?"left":"end"===e?"right":"center",E=(e,t,i)=>"start"===e?t:"end"===e?i:(t+i)/2,De=(e,t,i,n)=>e===(n?"left":"right")?i:"center"===e?(t+i)/2:t;function Re(a,l,c){const u=l.length;let d=0,h=u;if(a._sorted){const{iScale:e,_parsed:t}=a,i=e.axis,{min:n,max:r,minDefined:o,maxDefined:s}=e.getUserBounds();o&&(d=b(Math.min(C(t,e.axis,n).lo,c?u:C(l,i,e.getPixelForValue(n)).lo),0,u-1)),h=s?b(Math.max(C(t,e.axis,r,!0).hi+1,c?0:C(l,i,e.getPixelForValue(r),!0).hi+1),d,u)-d:u-d}return{start:d,count:h}}function Me(e){const{xScale:t,yScale:i,_scaleRanges:n}=e,r={xmin:t.min,xmax:t.max,ymin:i.min,ymax:i.max};if(!n)return e._scaleRanges=r,!0;const o=n.xmin!==t.min||n.xmax!==t.max||n.ymin!==i.min||n.ymax!==i.max;return Object.assign(n,r),o}class ke{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,i,n,e){const r=i.listeners[e],o=i.duration;r.forEach(e=>e({chart:t,initial:i.initial,numSteps:o,currentStep:Math.min(n-i.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=Se.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(s=Date.now()){let a=0;this._charts.forEach((e,t)=>{if(!e.running||!e.items.length)return;const i=e.items;let n,r=i.length-1,o=!1;for(;r>=0;--r)n=i[r],n._active?(n._total>e.duration&&(e.duration=n._total),n.tick(s),o=!0):(i[r]=i[i.length-1],i.pop());o&&(t.draw(),this._notify(t,e,s,"progress")),i.length||(e.running=!1,this._notify(t,e,s,"complete"),e.initial=!1),a+=i.length}),this._lastDate=s,0===a&&(this._running=!1)}_getAnims(e){const t=this._charts;let i=t.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,i)),i}listen(e,t,i){this._getAnims(e).listeners[t].push(i)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((e,t)=>Math.max(e,t._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const i=t.items;let n=i.length-1;for(;n>=0;--n)i[n].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var u=new ke;function Oe(e){return e+.5|0}const Ne=(e,t,i)=>Math.max(Math.min(e,i),t);function Ie(e){return Ne(Oe(2.55*e),0,255)}function Le(e){return Ne(Oe(255*e),0,255)}function s(e){return Ne(Oe(e/2.55)/100,0,1)}function Pe(e){return Ne(Oe(100*e),0,100)}const a={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Fe=[..."0123456789ABCDEF"],Ge=e=>Fe[15&e],$e=e=>Fe[(240&e)>>4]+Fe[15&e],He=e=>(240&e)>>4==(15&e);function Be(e){var t=(e=>He(e.r)&&He(e.g)&&He(e.b)&&He(e.a))(e)?Ge:$e;return e?"#"+t(e.r)+t(e.g)+t(e.b)+((e,t)=>e<255?t(e):"")(e.a,t):void 0}const Ve=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function je(i,e,n){const r=e*Math.min(n,1-n),t=(e,t=(e+i/30)%12)=>n-r*Math.max(Math.min(t-3,9-t,1),-1);return[t(0),t(8),t(4)]}function ze(i,n,r){const e=(e,t=(e+i/60)%6)=>r-r*n*Math.max(Math.min(t,4-t,1),0);return[e(5),e(3),e(1)]}function We(e,t,i){const n=je(e,1,.5);let r;for(t+i>1&&(r=1/(t+i),t*=r,i*=r),r=0;r<3;r++)n[r]*=1-t-i,n[r]+=t;return n}function Ue(e){const t=e.r/255,i=e.g/255,n=e.b/255,r=Math.max(t,i,n),o=Math.min(t,i,n),s=(r+o)/2;let a,l,c;return r!==o&&(c=r-o,l=s>.5?c/(2-r-o):c/(r+o),a=function(e,t,i,n,r){return e===r?(t-i)/n+(t<i?6:0):t===r?(i-e)/n+2:(e-t)/n+4}(t,i,n,c,r),a=60*a+.5),[0|a,l||0,s]}function Ye(e,t,i,n){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,i,n)).map(Le)}function qe(e,t,i){return Ye(je,e,t,i)}function Ke(e){return(e%360+360)%360}function Xe(e){const t=Ve.exec(e);let i,n=255;if(!t)return;t[5]!==i&&(n=t[6]?Ie(+t[5]):Le(+t[5]));const r=Ke(+t[2]),o=+t[3]/100,s=+t[4]/100;return i="hwb"===t[1]?function(e,t,i){return Ye(We,e,t,i)}(r,o,s):"hsv"===t[1]?function(e,t,i){return Ye(ze,e,t,i)}(r,o,s):qe(r,o,s),{r:i[0],g:i[1],b:i[2],a:n}}const Ze={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Qe={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Je;function et(e){Je||(Je=function(){const e={},t=Object.keys(Qe),i=Object.keys(Ze);let n,r,o,s,a;for(n=0;n<t.length;n++){for(s=a=t[n],r=0;r<i.length;r++)o=i[r],a=a.replace(o,Ze[o]);o=parseInt(Qe[s],16),e[a]=[o>>16&255,o>>8&255,255&o]}return e}(),Je.transparent=[0,0,0,0]);const t=Je[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}const tt=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const it=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,nt=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function rt(t,i,n){if(t){let e=Ue(t);e[i]=Math.max(0,Math.min(e[i]+e[i]*n,0===i?360:1)),e=qe(e),t.r=e[0],t.g=e[1],t.b=e[2]}}function ot(e,t){return e?Object.assign(t||{},e):e}function st(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Le(e[3]))):(t=ot(e,{r:0,g:0,b:0,a:1})).a=Le(t.a),t}function at(e){return"r"===e.charAt(0)?function(e){const t=tt.exec(e);let i,n,r,o=255;if(t){if(t[7]!==i){const e=+t[7];o=t[8]?Ie(e):Ne(255*e,0,255)}return i=+t[1],n=+t[3],r=+t[5],i=255&(t[2]?Ie(i):Ne(i,0,255)),n=255&(t[4]?Ie(n):Ne(n,0,255)),r=255&(t[6]?Ie(r):Ne(r,0,255)),{r:i,g:n,b:r,a:o}}}(e):Xe(e)}class lt{constructor(e){if(e instanceof lt)return e;const t=typeof e;let i;var n,r,o;"object"===t?i=st(e):"string"===t&&(o=(n=e).length,"#"===n[0]&&(4===o||5===o?r={r:255&17*a[n[1]],g:255&17*a[n[2]],b:255&17*a[n[3]],a:5===o?17*a[n[4]]:255}:7!==o&&9!==o||(r={r:a[n[1]]<<4|a[n[2]],g:a[n[3]]<<4|a[n[4]],b:a[n[5]]<<4|a[n[6]],a:9===o?a[n[7]]<<4|a[n[8]]:255})),i=r||et(e)||at(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=ot(this._rgb);return e&&(e.a=s(e.a)),e}set rgb(e){this._rgb=st(e)}rgbString(){return this._valid?(e=this._rgb)&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${s(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`):void 0;var e}hexString(){return this._valid?Be(this._rgb):void 0}hslString(){return this._valid?function(e){if(!e)return;const t=Ue(e),i=t[0],n=Pe(t[1]),r=Pe(t[2]);return e.a<255?`hsla(${i}, ${n}%, ${r}%, ${s(e.a)})`:`hsl(${i}, ${n}%, ${r}%)`}(this._rgb):void 0}mix(a,l){if(a){const e=this.rgb,t=a.rgb;let i;const n=l===i?.5:l,r=2*n-1,o=e.a-t.a,s=((r*o==-1?r:(r+o)/(1+r*o))+1)/2;i=1-s,e.r=255&s*e.r+i*t.r+.5,e.g=255&s*e.g+i*t.g+.5,e.b=255&s*e.b+i*t.b+.5,e.a=n*e.a+(1-n)*t.a,this.rgb=e}return this}interpolate(e,t){return e&&(this._rgb=function(e,t,i){const n=nt(s(e.r)),r=nt(s(e.g)),o=nt(s(e.b));return{r:Le(it(n+i*(nt(s(t.r))-n))),g:Le(it(r+i*(nt(s(t.g))-r))),b:Le(it(o+i*(nt(s(t.b))-o))),a:e.a+i*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}clone(){return new lt(this.rgb)}alpha(e){return this._rgb.a=Le(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=Oe(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return rt(this._rgb,2,e),this}darken(e){return rt(this._rgb,2,-e),this}saturate(e){return rt(this._rgb,1,e),this}desaturate(e){return rt(this._rgb,1,-e),this}rotate(e){return function(e,t){var i=Ue(e);i[0]=Ke(i[0]+t),i=qe(i),e.r=i[0],e.g=i[1],e.b=i[2]}(this._rgb,e),this}}function ct(t){if(t&&"object"==typeof t){const e=t.toString();return"[object CanvasPattern]"===e||"[object CanvasGradient]"===e}return!1}function ut(e){return ct(e)?e:new lt(e)}function dt(e){return ct(e)?e:new lt(e).saturate(.5).darken(.1).hexString()}const ht=["x","y","borderWidth","radius","tension"],ft=["color","borderColor","backgroundColor"];const pt=new Map;function gt(e,t,i){return function(e,t){t=t||{};const i=e+JSON.stringify(t);let n=pt.get(i);return n||(n=new Intl.NumberFormat(e,t),pt.set(i,n)),n}(t,i).format(e)}const mt={values:e=>M(e)?e:""+e,numeric(e,t,i){if(0===e)return"0";const n=this.chart.options.locale;let r,o=e;if(i.length>1){const t=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(t<1e-4||t>1e15)&&(r="scientific"),o=function(e,t){let i=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(i)>=1&&e!==Math.floor(e)&&(i=e-Math.floor(e));return i}(e,i)}const s=c(Math.abs(o)),a=isNaN(s)?1:Math.max(Math.min(-1*Math.floor(s),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),gt(e,n,l)},logarithmic(e,t,i){if(0===e)return"0";const n=i[t].significand||e/Math.pow(10,Math.floor(c(e)));return[1,2,3,5,10,15].includes(n)||t>.8*i.length?mt.numeric.call(this,e,t,i):""}};var vt={formatters:mt};const yt=Object.create(null),bt=Object.create(null);function _t(i,e){if(!e)return i;const n=e.split(".");for(let t=0,e=n.length;t<e;++t){const e=n[t];i=i[e]||(i[e]=Object.create(null))}return i}function wt(e,t,i){return"string"==typeof t?W(_t(e,t),i):W(_t(e,""),t)}class Ct{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>dt(t.backgroundColor),this.hoverBorderColor=(e,t)=>dt(t.borderColor),this.hoverColor=(e,t)=>dt(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return wt(this,e,t)}get(e){return _t(this,e)}describe(e,t){return wt(bt,e,t)}override(e,t){return wt(yt,e,t)}route(e,t,i,n){const r=_t(this,e),o=_t(this,i),s="_"+t;Object.defineProperties(r,{[s]:{value:r[t],writable:!0},[t]:{enumerable:!0,get(){const e=this[s],t=o[n];return k(e)?Object.assign({},t,e):O(e,t)},set(e){this[s]=e}}})}apply(e){e.forEach(e=>e(this))}}var D=new Ct({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),e.set("animations",{colors:{type:"color",properties:ft},numbers:{type:"number",properties:ht}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:vt.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e})}]);function xt(){return"undefined"!=typeof window&&"undefined"!=typeof document}function St(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function At(e,t,i){let n;return"string"==typeof e?(n=parseInt(e,10),-1!==e.indexOf("%")&&(n=n/100*t.parentNode[i])):n=e,n}const Et=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function Tt(e,t){return Et(e).getPropertyValue(t)}const Dt=["top","right","bottom","left"];function Rt(i,n,r){const o={};r=r?"-"+r:"";for(let t=0;t<4;t++){const e=Dt[t];o[e]=parseFloat(i[n+"-"+e+r])||0}return o.width=o.left+o.right,o.height=o.top+o.bottom,o}const Mt=(e,t,i)=>(e>0||t>0)&&(!i||!i.shadowRoot);function kt(e,t){if("native"in e)return e;const{canvas:i,currentDevicePixelRatio:n}=t,r=Et(i),o="border-box"===r.boxSizing,s=Rt(r,"padding"),a=Rt(r,"border","width"),{x:l,y:c,box:u}=function(e,t){const i=e.touches,n=i&&i.length?i[0]:e,{offsetX:r,offsetY:o}=n;let s,a,l=!1;if(Mt(r,o,e.target))s=r,a=o;else{const e=t.getBoundingClientRect();s=n.clientX-e.left,a=n.clientY-e.top,l=!0}return{x:s,y:a,box:l}}(e,i),d=s.left+(u&&a.left),h=s.top+(u&&a.top);let{width:f,height:p}=t;return o&&(f-=s.width+a.width,p-=s.height+a.height),{x:Math.round((l-d)/f*i.width/n),y:Math.round((c-h)/p*i.height/n)}}const Ot=e=>Math.round(10*e)/10;function Nt(e,t,i,n){const r=Et(e),o=Rt(r,"margin"),s=At(r.maxWidth,e,"clientWidth")||ee,a=At(r.maxHeight,e,"clientHeight")||ee,l=function(r,o,s){let a,l;if(void 0===o||void 0===s){const n=St(r);if(n){const r=n.getBoundingClientRect(),e=Et(n),t=Rt(e,"border","width"),i=Rt(e,"padding");o=r.width-i.width-t.width,s=r.height-i.height-t.height,a=At(e.maxWidth,n,"clientWidth"),l=At(e.maxHeight,n,"clientHeight")}else o=r.clientWidth,s=r.clientHeight}return{width:o,height:s,maxWidth:a||ee,maxHeight:l||ee}}(e,t,i);let{width:c,height:u}=l;if("content-box"===r.boxSizing){const e=Rt(r,"border","width"),t=Rt(r,"padding");c-=t.width+e.width,u-=t.height+e.height}c=Math.max(0,c-o.width),u=Math.max(0,n?c/n:u-o.height),c=Ot(Math.min(c,s,l.maxWidth)),u=Ot(Math.min(u,a,l.maxHeight)),c&&!u&&(u=Ot(c/2));return(void 0!==t||void 0!==i)&&n&&l.height&&u>l.height&&(u=l.height,c=Ot(Math.floor(u*n))),{width:c,height:u}}function It(e,t,i){const n=t||1,r=Math.floor(e.height*n),o=Math.floor(e.width*n);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const s=e.canvas;return s.style&&(i||!s.style.height&&!s.style.width)&&(s.style.height=`${e.height}px`,s.style.width=`${e.width}px`),(e.currentDevicePixelRatio!==n||s.height!==r||s.width!==o)&&(e.currentDevicePixelRatio=n,s.height=r,s.width=o,e.ctx.setTransform(n,0,0,n,0,0),!0)}const Lt=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(t){}return t}();function Pt(e,t){const i=Tt(e,t),n=i&&i.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function Ft(e){return!e||T(e.size)||T(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function Gt(e,t,i,n,r){let o=t[r];return o||(o=t[r]=e.measureText(r).width,i.push(r)),o>n&&(n=o),n}function $t(e,t,i,n){let r=(n=n||{}).data=n.data||{},o=n.garbageCollect=n.garbageCollect||[];n.font!==t&&(r=n.data={},o=n.garbageCollect=[],n.font=t),e.save(),e.font=t;let s=0;const a=i.length;let l,c,u,d,h;for(l=0;l<a;l++)if(d=i[l],null==d||M(d)){if(M(d))for(c=0,u=d.length;c<u;c++)h=d[c],null==h||M(h)||(s=Gt(e,r,o,s,h))}else s=Gt(e,r,o,s,d);e.restore();const f=o.length/2;if(f>i.length){for(l=0;l<f;l++)delete r[o[l]];o.splice(0,f)}return s}function Ht(e,t,i){const n=e.currentDevicePixelRatio,r=0!==i?Math.max(i/2,.5):0;return Math.round((t-r)*n)/n+r}function Bt(e,t){(t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore()}function Vt(e,t,i,n){jt(e,t,i,n,null)}function jt(e,t,i,n,r){let o,s,a,l,c,u,d,h;const f=t.pointStyle,p=t.rotation,g=t.radius;let m=(p||0)*te;if(f&&"object"==typeof f&&(o=f.toString(),"[object HTMLImageElement]"===o||"[object HTMLCanvasElement]"===o))return e.save(),e.translate(i,n),e.rotate(m),e.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),void e.restore();if(!(isNaN(g)||g<=0)){switch(e.beginPath(),f){default:r?e.ellipse(i,n,r/2,g,0,0,_):e.arc(i,n,g,0,_),e.closePath();break;case"triangle":u=r?r/2:g,e.moveTo(i+Math.sin(m)*u,n-Math.cos(m)*g),m+=ne,e.lineTo(i+Math.sin(m)*u,n-Math.cos(m)*g),m+=ne,e.lineTo(i+Math.sin(m)*u,n-Math.cos(m)*g),e.closePath();break;case"rectRounded":c=.516*g,l=g-c,s=Math.cos(m+ie)*l,d=Math.cos(m+ie)*(r?r/2-c:l),a=Math.sin(m+ie)*l,h=Math.sin(m+ie)*(r?r/2-c:l),e.arc(i-d,n-a,c,m-N,m-I),e.arc(i+h,n-s,c,m-I,m),e.arc(i+d,n+a,c,m,m+I),e.arc(i-h,n+s,c,m+I,m+N),e.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*g,u=r?r/2:l,e.rect(i-u,n-l,2*u,2*l);break}m+=ie;case"rectRot":d=Math.cos(m)*(r?r/2:g),s=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(r?r/2:g),e.moveTo(i-d,n-a),e.lineTo(i+h,n-s),e.lineTo(i+d,n+a),e.lineTo(i-h,n+s),e.closePath();break;case"crossRot":m+=ie;case"cross":d=Math.cos(m)*(r?r/2:g),s=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(r?r/2:g),e.moveTo(i-d,n-a),e.lineTo(i+d,n+a),e.moveTo(i+h,n-s),e.lineTo(i-h,n+s);break;case"star":d=Math.cos(m)*(r?r/2:g),s=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(r?r/2:g),e.moveTo(i-d,n-a),e.lineTo(i+d,n+a),e.moveTo(i+h,n-s),e.lineTo(i-h,n+s),m+=ie,d=Math.cos(m)*(r?r/2:g),s=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(r?r/2:g),e.moveTo(i-d,n-a),e.lineTo(i+d,n+a),e.moveTo(i+h,n-s),e.lineTo(i-h,n+s);break;case"line":s=r?r/2:Math.cos(m)*g,a=Math.sin(m)*g,e.moveTo(i-s,n-a),e.lineTo(i+s,n+a);break;case"dash":e.moveTo(i,n),e.lineTo(i+Math.cos(m)*(r?r/2:g),n+Math.sin(m)*g);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function d(e,t,i){return i=i||.5,!t||e&&e.x>t.left-i&&e.x<t.right+i&&e.y>t.top-i&&e.y<t.bottom+i}function zt(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Wt(e){e.restore()}function Ut(e,t,i,n,r){if(!t)return e.lineTo(i.x,i.y);if("middle"===r){const n=(t.x+i.x)/2;e.lineTo(n,t.y),e.lineTo(n,i.y)}else"after"===r!=!!n?e.lineTo(t.x,i.y):e.lineTo(i.x,t.y);e.lineTo(i.x,i.y)}function Yt(e,t,i,n){if(!t)return e.lineTo(i.x,i.y);e.bezierCurveTo(n?t.cp1x:t.cp2x,n?t.cp1y:t.cp2y,n?i.cp2x:i.cp1x,n?i.cp2y:i.cp1y,i.x,i.y)}function qt(s,a,l,c,u){if(u.strikethrough||u.underline){const e=s.measureText(c),t=a-e.actualBoundingBoxLeft,i=a+e.actualBoundingBoxRight,n=l-e.actualBoundingBoxAscent,r=l+e.actualBoundingBoxDescent,o=u.strikethrough?(n+r)/2:r;s.strokeStyle=s.fillStyle,s.beginPath(),s.lineWidth=u.decorationWidth||2,s.moveTo(t,o),s.lineTo(i,o),s.stroke()}}function Kt(e,t){const i=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=i}function Xt(e,t,i,n,r,o={}){const s=M(t)?t:[t],a=o.strokeWidth>0&&""!==o.strokeColor;let l,c;for(e.save(),e.font=r.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),T(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,o),l=0;l<s.length;++l)c=s[l],o.backdrop&&Kt(e,o.backdrop),a&&(o.strokeColor&&(e.strokeStyle=o.strokeColor),T(o.strokeWidth)||(e.lineWidth=o.strokeWidth),e.strokeText(c,i,n,o.maxWidth)),e.fillText(c,i,n,o.maxWidth),qt(e,i,n,c,o),n+=Number(r.lineHeight);e.restore()}function Zt(e,t){const{x:i,y:n,w:r,h:o,radius:s}=t;e.arc(i+s.topLeft,n+s.topLeft,s.topLeft,-I,N,!0),e.lineTo(i,n+o-s.bottomLeft),e.arc(i+s.bottomLeft,n+o-s.bottomLeft,s.bottomLeft,N,I,!0),e.lineTo(i+r-s.bottomRight,n+o),e.arc(i+r-s.bottomRight,n+o-s.bottomRight,s.bottomRight,I,0,!0),e.lineTo(i+r,n+s.topRight),e.arc(i+r-s.topRight,n+s.topRight,s.topRight,0,-I,!0),e.lineTo(i+s.topLeft,n)}function Qt(i,n=[""],e,t,r=()=>i[0]){const o=e||i;void 0===t&&(t=ci("_fallback",i));const s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:i,_rootScopes:o,_fallback:t,_getTarget:r,override:e=>Qt([e,...i],n,o,t)};return new Proxy(s,{deleteProperty:(e,t)=>(delete e[t],delete e._keys,delete i[0][t],!0),get:(e,t)=>ni(e,t,()=>function(t,i,n,r){let o;for(const e of i)if(o=ci(ti(e,t),n),void 0!==o)return ii(t,o)?ai(n,r,t,o):o}(t,n,i,e)),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(i[0]),has:(e,t)=>ui(e).includes(t),ownKeys:e=>ui(e),set(e,t,i){const n=e._storage||(e._storage=r());return e[t]=n[t]=i,delete e._keys,!0}})}function Jt(n,t,i,r){const e={_cacheable:!1,_proxy:n,_context:t,_subProxy:i,_stack:new Set,_descriptors:ei(n,r),setContext:e=>Jt(n,e,i,r),override:e=>Jt(n.override(e),t,i,r)};return new Proxy(e,{deleteProperty:(e,t)=>(delete e[t],delete n[t],!0),get:(e,t,i)=>ni(e,t,()=>function(e,t,i){const{_proxy:n,_context:r,_subProxy:o,_descriptors:s}=e;let a=n[t];l(a)&&s.isScriptable(t)&&(a=function(e,t,i,n){const{_proxy:r,_context:o,_subProxy:s,_stack:a}=i;if(a.has(e))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+e);a.add(e);let l=t(o,s||n);a.delete(e),ii(e,l)&&(l=ai(r._scopes,r,e,l));return l}(t,a,e,i));M(a)&&a.length&&(a=function(e,t,i,n){const{_proxy:r,_context:o,_subProxy:s,_descriptors:a}=i;if(void 0!==o.index&&n(e))return t[o.index%t.length];if(k(t[0])){const i=t,n=r._scopes.filter(e=>e!==i);t=[];for(const k of i){const i=ai(n,r,e,k);t.push(Jt(i,o,s&&s[e],a))}}return t}(t,a,e,s.isIndexable));ii(t,a)&&(a=Jt(a,r,o&&o[t],s));return a}(e,t,i)),getOwnPropertyDescriptor:(e,t)=>e._descriptors.allKeys?Reflect.has(n,t)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,t),getPrototypeOf:()=>Reflect.getPrototypeOf(n),has:(e,t)=>Reflect.has(n,t),ownKeys:()=>Reflect.ownKeys(n),set:(e,t,i)=>(n[t]=i,delete e[t],!0)})}function ei(e,t={scriptable:!0,indexable:!0}){const{_scriptable:i=t.scriptable,_indexable:n=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:i,indexable:n,isScriptable:l(i)?i:()=>i,isIndexable:l(n)?n:()=>n}}const ti=(e,t)=>e?e+K(t):t,ii=(e,t)=>k(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function ni(e,t,i){if(Object.prototype.hasOwnProperty.call(e,t))return e[t];const n=i();return e[t]=n,n}function ri(e,t,i){return l(e)?e(t,i):e}const oi=(e,t)=>!0===e?t:"string"==typeof e?m(t,e):void 0;function si(t,i,n,r,o){for(const e of i){const i=oi(n,e);if(i){t.add(i);const e=ri(i._fallback,n,o);if(void 0!==e&&e!==n&&e!==r)return e}else if(!1===i&&void 0!==r&&n!==r)return null}return!1}function ai(e,t,i,n){const r=t._rootScopes,o=ri(t._fallback,i,n),s=[...e,...r],a=new Set;a.add(n);let l=li(a,s,i,o||i,n);return null!==l&&((void 0===o||o===i||(l=li(a,s,o,l,n),null!==l))&&Qt(Array.from(a),[""],r,o,()=>function(e,t,i){const n=e._getTarget();t in n||(n[t]={});const r=n[t];if(M(r)&&k(i))return i;return r||{}}(t,i,n)))}function li(e,t,i,n,r){for(;i;)i=si(e,t,i,n,r);return i}function ci(t,i){for(const e of i){if(!e)continue;const i=e[t];if(void 0!==i)return i}}function ui(e){let t=e._keys;return t||(t=e._keys=function(t){const i=new Set;for(const e of t)for(const t of Object.keys(e).filter(e=>!e.startsWith("_")))i.add(t);return Array.from(i)}(e._scopes)),t}function di(e,t,i,n){const{iScale:r}=e,{key:o="r"}=this._parsing,s=new Array(n);let a,l,c,u;for(a=0,l=n;a<l;++a)c=a+i,u=t[c],s[a]={r:r.parse(m(u,o),c)};return s}const hi=Number.EPSILON||1e-14,fi=(e,t)=>t<e.length&&!e[t].skip&&e[t],pi=e=>"x"===e?"y":"x";function gi(e,t,i,n){const r=e.skip?t:e,o=t,s=i.skip?t:i,a=fe(o,r),l=fe(s,o);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const d=n*c,h=n*u;return{previous:{x:o.x-d*(s.x-r.x),y:o.y-d*(s.y-r.y)},next:{x:o.x+h*(s.x-r.x),y:o.y+h*(s.y-r.y)}}}function mi(e,t="x"){const i=pi(t),n=e.length,r=Array(n).fill(0),o=Array(n);let s,a,l,c=fi(e,0);for(s=0;s<n;++s)if(a=l,l=c,c=fi(e,s+1),l){if(c){const e=c[t]-l[t];r[s]=0!==e?(c[i]-l[i])/e:0}o[s]=a?c?v(r[s-1])!==v(r[s])?0:(r[s-1]+r[s])/2:r[s-1]:r[s]}!function(t,i,n){const r=t.length;let o,s,a,l,c,u=fi(t,0);for(let e=0;e<r-1;++e)c=u,u=fi(t,e+1),c&&u&&(re(i[e],0,hi)?n[e]=n[e+1]=0:(o=n[e]/i[e],s=n[e+1]/i[e],l=Math.pow(o,2)+Math.pow(s,2),l<=9||(a=3/Math.sqrt(l),n[e]=o*a*i[e],n[e+1]=s*a*i[e])))}(e,r,o),function(i,n,r="x"){const o=pi(r),s=i.length;let a,l,c,u=fi(i,0);for(let t=0;t<s;++t){if(l=c,c=u,u=fi(i,t+1),!c)continue;const s=c[r],e=c[o];l&&(a=(s-l[r])/3,c[`cp1${r}`]=s-a,c[`cp1${o}`]=e-a*n[t]),u&&(a=(u[r]-s)/3,c[`cp2${r}`]=s+a,c[`cp2${o}`]=e+a*n[t])}}(e,o,t)}function vi(e,t,i){return Math.max(Math.min(e,i),t)}function yi(t,i,e,n,r){let o,s,a,l;if(i.spanGaps&&(t=t.filter(e=>!e.skip)),"monotone"===i.cubicInterpolationMode)mi(t,r);else{let e=n?t[t.length-1]:t[0];for(o=0,s=t.length;o<s;++o)a=t[o],l=gi(e,a,t[Math.min(o+1,s-(n?0:1))%s],i.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,e=a}i.capBezierPoints&&function(e,t){let i,n,r,o,s,a=d(e[0],t);for(i=0,n=e.length;i<n;++i)s=o,o=a,a=i<n-1&&d(e[i+1],t),o&&(r=e[i],s&&(r.cp1x=vi(r.cp1x,t.left,t.right),r.cp1y=vi(r.cp1y,t.top,t.bottom)),a&&(r.cp2x=vi(r.cp2x,t.left,t.right),r.cp2y=vi(r.cp2y,t.top,t.bottom)))}(t,e)}const bi=e=>0===e||1===e,_i=(e,t,i)=>-Math.pow(2,10*(e-=1))*Math.sin((e-t)*_/i),wi=(e,t,i)=>Math.pow(2,-10*e)*Math.sin((e-t)*_/i)+1,Ci={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*I),easeOutSine:e=>Math.sin(e*I),easeInOutSine:e=>-.5*(Math.cos(N*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>bi(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>bi(e)?e:_i(e,.075,.3),easeOutElastic:e=>bi(e)?e:wi(e,.075,.3),easeInOutElastic(e){const t=.1125;return bi(e)?e:e<.5?.5*_i(2*e,t,.45):.5+.5*wi(2*e-1,t,.45)},easeInBack(e){const t=1.70158;return e*e*((t+1)*e-t)},easeOutBack(e){const t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-Ci.easeOutBounce(1-e),easeOutBounce(e){const t=7.5625,i=2.75;return e<1/i?t*e*e:e<2/i?t*(e-=1.5/i)*e+.75:e<2.5/i?t*(e-=2.25/i)*e+.9375:t*(e-=2.625/i)*e+.984375},easeInOutBounce:e=>e<.5?.5*Ci.easeInBounce(2*e):.5*Ci.easeOutBounce(2*e-1)+.5};function xi(e,t,i,n){return{x:e.x+i*(t.x-e.x),y:e.y+i*(t.y-e.y)}}function Si(e,t,i,n){return{x:e.x+i*(t.x-e.x),y:"middle"===n?i<.5?e.y:t.y:"after"===n?i<1?e.y:t.y:i>0?t.y:e.y}}function Ai(e,t,i,n){const r={x:e.cp2x,y:e.cp2y},o={x:t.cp1x,y:t.cp1y},s=xi(e,r,i),a=xi(r,o,i),l=xi(o,t,i),c=xi(s,a,i),u=xi(a,l,i);return xi(c,u,i)}const Ei=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Ti=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Di(e,t){const i=(""+e).match(Ei);if(!i||"normal"===i[1])return 1.2*t;switch(e=+i[2],i[3]){case"px":return e;case"%":e/=100}return t*e}const Ri=e=>+e||0;function Mi(t,i){const e={},n=k(i),r=n?Object.keys(i):i,o=k(t)?n?e=>O(t[e],t[i[e]]):e=>t[e]:()=>t;for(const t of r)e[t]=Ri(o(t));return e}function ki(e){return Mi(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Oi(e){return Mi(e,["topLeft","topRight","bottomLeft","bottomRight"])}function P(e){const t=ki(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function R(e,t){e=e||{},t=t||D.font;let i=O(e.size,t.size);"string"==typeof i&&(i=parseInt(i,10));let n=O(e.style,t.style);n&&!(""+n).match(Ti)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const r={family:O(e.family,t.family),lineHeight:Di(O(e.lineHeight,t.lineHeight),i),size:i,style:n,weight:O(e.weight,t.weight),string:""};return r.string=Ft(r),r}function Ni(e,t,i,n){let r,o,s,a=!0;for(r=0,o=e.length;r<o;++r)if(s=e[r],void 0!==s&&(void 0!==t&&"function"==typeof s&&(s=s(t),a=!1),void 0!==i&&M(s)&&(s=s[i%s.length],a=!1),void 0!==s))return n&&!a&&(n.cacheable=!1),s}function Ii(e,t,i){const{min:n,max:r}=e,o=H(t,(r-n)/2),s=(e,t)=>i&&0===e?0:e+t;return{min:s(n,-Math.abs(o)),max:s(r,o)}}function Li(e,t){return Object.assign(Object.create(e),t)}function Pi(e,t,i){return e?function(t,i){return{x:e=>t+t+i-e,setWidth(e){i=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}}(t,i):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function Fi(e,t){let i,n;"ltr"!==t&&"rtl"!==t||(i=e.canvas.style,n=[i.getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",t,"important"),e.prevTextDirection=n)}function Gi(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function $i(e){return"angle"===e?{between:ge,compare:pe,normalize:y}:{between:w,compare:(e,t)=>e-t,normalize:e=>e}}function Hi({start:e,end:t,count:i,loop:n,style:r}){return{start:e%i,end:t%i,loop:n&&(t-e+1)%i==0,style:r}}function Bi(e,i,t){if(!t)return[e];const{property:n,start:r,end:o}=t,s=i.length,{compare:a,between:l,normalize:c}=$i(n),{start:u,end:d,loop:h,style:f}=function(e,t,i){const{property:n,start:r,end:o}=i,{between:s,normalize:a}=$i(n),l=t.length;let c,u,{start:d,end:h,loop:f}=e;if(f){for(d+=l,h+=l,c=0,u=l;c<u&&s(a(t[d%l][n]),r,o);++c)d--,h--;d%=l,h%=l}return h<d&&(h+=l),{start:d,end:h,loop:f,style:e.style}}(e,i,t),p=[];let g,m,v,y=!1,b=null;const _=()=>y||l(r,v,g)&&0!==a(r,v),w=()=>!y||0===a(o,g)||l(o,v,g);for(let e=u,t=u;e<=d;++e)m=i[e%s],m.skip||(g=c(m[n]),g!==v&&(y=l(g,r,o),null===b&&_()&&(b=0===a(g,r)?e:t),null!==b&&w()&&(p.push(Hi({start:b,end:e,loop:h,count:s,style:f})),b=null),t=e,v=g));return null!==b&&p.push(Hi({start:b,end:d,loop:h,count:s,style:f})),p}function Vi(i,n){const r=[],o=i.segments;for(let t=0;t<o.length;t++){const e=Bi(o[t],i.points,n);e.length&&r.push(...e)}return r}function ji(e,t){const i=e.points,n=e.options.spanGaps,r=i.length;if(!r)return[];const o=!!e._loop,{start:s,end:a}=function(e,t,i,n){let r=0,o=t-1;if(i&&!n)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,i&&(o+=r);o>r&&e[o%t].skip;)o--;return o%=t,{start:r,end:o}}(i,r,o,n);if(!0===n)return zi(e,[{start:s,end:a,loop:o}],i,t);return zi(e,function(e,t,i,n){const r=e.length,o=[];let s,a=t,l=e[t];for(s=t+1;s<=i;++s){const i=e[s%r];i.skip||i.stop?l.skip||(n=!1,o.push({start:t%r,end:(s-1)%r,loop:n}),t=a=i.stop?s:null):(a=s,l.skip&&(t=s)),l=i}return null!==a&&o.push({start:t%r,end:a%r,loop:n}),o}(i,s,a<s?a+r:a,!!e._fullLoop&&0===s&&a===r-1),i,t)}function zi(e,t,i,n){return n&&n.setContext&&i?function(i,e,o,n){const r=i._chart.getContext(),t=Wi(i.options),{_datasetIndex:s,options:{spanGaps:a}}=i,l=o.length,c=[];let u=t,d=e[0].start,h=d;function f(e,t,i,n){const r=a?-1:1;if(e!==t){for(e+=l;o[e%l].skip;)e-=r;for(;o[t%l].skip;)t+=r;e%l!=t%l&&(c.push({start:e%l,end:t%l,loop:i,style:n}),u=n,d=t%l)}}for(const i of e){d=a?d:i.start;let e,t=o[d%l];for(h=d+1;h<=i.end;h++){const a=o[h%l];e=Wi(n.setContext(Li(r,{type:"segment",p0:t,p1:a,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:s}))),Ui(e,u)&&f(d,h-1,i.loop,u),t=a,u=e}d<h-1&&f(d,h-1,i.loop,u)}return c}(e,t,i,n):t}function Wi(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Ui(e,t){if(!t)return!1;const i=[],n=function(e,t){return ct(t)?(i.includes(t)||i.push(t),i.indexOf(t)):t};return JSON.stringify(e,n)!==JSON.stringify(t,n)}var Yi=Object.freeze({__proto__:null,HALF_PI:I,INFINITY:ee,PI:N,PITAU:J,QUARTER_PI:ie,RAD_PER_DEG:te,TAU:_,TWO_THIRDS_PI:ne,_addGrace:Ii,_alignPixel:Ht,_alignStartEnd:E,_angleBetween:ge,_angleDiff:pe,_arrayUnique:xe,_attachContext:Jt,_bezierCurveTo:Yt,_bezierInterpolation:Ai,_boundSegment:Bi,_boundSegments:Vi,_capitalize:K,_computeSegments:ji,_createResolver:Qt,_decimalPlaces:de,_deprecated:function(e,t,i,n){void 0!==t&&console.warn(e+': "'+i+'" is deprecated. Please use "'+n+'" instead')},_descriptors:ei,_elementsEqual:B,_factorize:se,_filterBetween:be,_getParentNode:St,_getStartAndCountOfVisiblePoints:Re,_int16Range:me,_isBetween:w,_isClickEvent:Q,_isDomSupported:xt,_isPointInArea:d,_limitValue:b,_longestText:$t,_lookup:ve,_lookupByKey:C,_measureText:Gt,_merger:z,_mergerIf:o,_normalizeAngle:y,_parseObjectDataRadialScale:di,_pointInLine:xi,_readValueToProps:Mi,_rlookupByKey:ye,_scaleRangesChanged:Me,_setMinAndMaxByKey:ce,_splitKey:q,_steppedInterpolation:Si,_steppedLineTo:Ut,_textX:De,_toLeftRightCenter:Te,_updateBezierControlPoints:yi,addRoundedRectPath:Zt,almostEquals:re,almostWhole:le,callback:f,clearCanvas:Bt,clipArea:zt,clone:V,color:ut,createContext:Li,debounce:Ee,defined:X,distanceBetweenPoints:fe,drawPoint:Vt,drawPointLegend:jt,each:S,easingEffects:Ci,finiteOrDefault:g,fontString:function(e,t,i){return t+" "+e+"px "+i},formatNumber:gt,getAngleFromPoint:he,getHoverColor:dt,getMaximumSize:Nt,getRelativePosition:kt,getRtlAdapter:Pi,getStyle:Tt,isArray:M,isFinite:p,isFunction:l,isNullOrUndef:T,isNumber:ae,isObject:k,isPatternOrGradient:ct,listenArrayEvents:we,log10:c,merge:W,mergeIf:U,niceNum:oe,noop:e,overrideTextDirection:Fi,readUsedSize:Pt,renderText:Xt,requestAnimFrame:Se,resolve:Ni,resolveObjectKey:m,restoreTextDirection:Gi,retinaScale:It,setsEqual:Z,sign:v,splineCurve:gi,splineCurveMonotone:mi,supportsEventListenerOptions:Lt,throttled:Ae,toDegrees:ue,toDimension:H,toFont:R,toFontString:Ft,toLineHeight:Di,toPadding:P,toPercentage:$,toRadians:L,toTRBL:ki,toTRBLCorners:Oi,uid:G,unclipArea:Wt,unlistenArrayEvents:Ce,valueOrDefault:O});function qi(e,t,i,n){const{controller:r,data:o,_sorted:s}=e,a=r._cachedMeta.iScale;if(a&&t===a.axis&&"r"!==t&&s&&o.length){const e=a._reversePixels?ye:C;if(!n)return e(o,t,i);if(r._sharedOptions){const n=o[0],r="function"==typeof n.getRange&&n.getRange(t);if(r){const n=e(o,t,i-r),s=e(o,t,i+r);return{lo:n.lo,hi:s.hi}}}}return{lo:0,hi:o.length-1}}function Ki(e,r,o,s,a){const l=e.getSortedVisibleDatasetMetas(),c=o[r];for(let e=0,t=l.length;e<t;++e){const{index:o,data:t}=l[e],{lo:i,hi:n}=qi(l[e],r,c,a);for(let e=i;e<=n;++e){const r=t[e];r.skip||s(r,o,e)}}}function Xi(n,r,e,o,s){const a=[];if(!s&&!n.isPointInArea(r))return a;return Ki(n,e,r,function(e,t,i){(s||d(e,n.chartArea,0))&&e.inRange(r.x,r.y,o)&&a.push({element:e,datasetIndex:t,index:i})},!0),a}function Zi(s,a,e,l,c,u){let d=[];const h=function(e){const r=-1!==e.indexOf("x"),o=-1!==e.indexOf("y");return function(e,t){const i=r?Math.abs(e.x-t.x):0,n=o?Math.abs(e.y-t.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(n,2))}}(e);let f=Number.POSITIVE_INFINITY;return Ki(s,e,a,function(e,t,i){const n=e.inRange(a.x,a.y,c);if(l&&!n)return;const r=e.getCenterPoint(c);if(!(!!u||s.isPointInArea(r))&&!n)return;const o=h(a,r);o<f?(d=[{element:e,datasetIndex:t,index:i}],f=o):o===f&&d.push({element:e,datasetIndex:t,index:i})}),d}function Qi(e,t,i,n,r,o){return o||e.isPointInArea(t)?"r"!==i||n?Zi(e,t,i,n,r,o):function(e,s,t,a){let l=[];return Ki(e,t,s,function(e,t,i){const{startAngle:n,endAngle:r}=e.getProps(["startAngle","endAngle"],a),{angle:o}=he(e,{x:s.x,y:s.y});ge(o,n,r)&&l.push({element:e,datasetIndex:t,index:i})}),l}(e,t,i,r):[]}function Ji(e,n,r,t,o){const s=[],a="x"===r?"inXRange":"inYRange";let l=!1;return Ki(e,r,n,(e,t,i)=>{e[a](n[r],o)&&(s.push({element:e,datasetIndex:t,index:i}),l=l||e.inRange(n.x,n.y,o))}),t&&!l?[]:s}var en={evaluateInteractionItems:Ki,modes:{index(e,t,i,n){const r=kt(t,e),o=i.axis||"x",s=i.includeInvisible||!1,a=i.intersect?Xi(e,r,o,n,s):Qi(e,r,o,!1,n,s),l=[];return a.length?(e.getSortedVisibleDatasetMetas().forEach(e=>{const t=a[0].index,i=e.data[t];i&&!i.skip&&l.push({element:i,datasetIndex:e.index,index:t})}),l):[]},dataset(e,t,i,n){const r=kt(t,e),o=i.axis||"xy",s=i.includeInvisible||!1;let a=i.intersect?Xi(e,r,o,n,s):Qi(e,r,o,!1,n,s);if(a.length>0){const t=a[0].datasetIndex,i=e.getDatasetMeta(t).data;a=[];for(let e=0;e<i.length;++e)a.push({element:i[e],datasetIndex:t,index:e})}return a},point:(e,t,i,n)=>Xi(e,kt(t,e),i.axis||"xy",n,i.includeInvisible||!1),nearest(e,t,i,n){const r=kt(t,e),o=i.axis||"xy",s=i.includeInvisible||!1;return Qi(e,r,o,i.intersect,n,s)},x:(e,t,i,n)=>Ji(e,kt(t,e),"x",i.intersect,n),y:(e,t,i,n)=>Ji(e,kt(t,e),"y",i.intersect,n)}};const tn=["left","top","right","bottom"];function nn(e,t){return e.filter(e=>e.pos===t)}function rn(e,t){return e.filter(e=>-1===tn.indexOf(e.pos)&&e.box.axis===t)}function on(e,r){return e.sort((e,t)=>{const i=r?t:e,n=r?e:t;return i.weight===n.weight?i.index-n.index:i.weight-n.weight})}function sn(i,n){const r=function(r){const o={};for(const n of r){const{stack:r,pos:e,stackWeight:t}=n;if(!r||!tn.includes(e))continue;const i=o[r]||(o[r]={count:0,placed:0,weight:0,size:0});i.count++,i.weight+=t}return o}(i),{vBoxMaxWidth:o,hBoxMaxHeight:s}=n;let a,l,c;for(a=0,l=i.length;a<l;++a){c=i[a];const{fullSize:l}=c.box,e=r[c.stack],t=e&&c.stackWeight/e.weight;c.horizontal?(c.width=t?t*o:l&&n.availableWidth,c.height=s):(c.width=o,c.height=t?t*s:l&&n.availableHeight)}return r}function an(e,t,i,n){return Math.max(e[i],t[i])+Math.max(e[n],t[n])}function ln(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function cn(e,t,i,n){const{pos:r,box:o}=i,s=e.maxPadding;if(!k(r)){i.size&&(e[r]-=i.size);const t=n[i.stack]||{size:0,count:1};t.size=Math.max(t.size,i.horizontal?o.height:o.width),i.size=t.size/t.count,e[r]+=i.size}o.getPadding&&ln(s,o.getPadding());const a=Math.max(0,t.outerWidth-an(s,e,"left","right")),l=Math.max(0,t.outerHeight-an(s,e,"top","bottom")),c=a!==e.w,u=l!==e.h;return e.w=a,e.h=l,i.horizontal?{same:c,other:u}:{same:u,other:c}}function un(e,i){const n=i.maxPadding;function t(e){const t={left:0,top:0,right:0,bottom:0};return e.forEach(e=>{t[e]=Math.max(i[e],n[e])}),t}return t(e?["left","right"]:["top","bottom"])}function dn(t,i,n,r){const o=[];let s,a,l,c,u,d;for(s=0,a=t.length,u=0;s<a;++s){l=t[s],c=l.box,c.update(l.width||i.w,l.height||i.h,un(l.horizontal,i));const{same:a,other:e}=cn(i,n,l,r);u|=a&&o.length,d=d||e,c.fullSize||o.push(l)}return u&&dn(o,i,n,r)||d}function hn(e,t,i,n,r){e.top=i,e.left=t,e.right=t+n,e.bottom=i+r,e.width=n,e.height=r}function fn(n,r,o,s){const a=o.padding;let{x:l,y:c}=r;for(const i of n){const n=i.box,e=s[i.stack]||{count:1,placed:0,weight:1},t=i.stackWeight/e.weight||1;if(i.horizontal){const s=r.w*t,l=e.size||n.height;X(e.start)&&(c=e.start),n.fullSize?hn(n,a.left,c,o.outerWidth-a.right-a.left,l):hn(n,r.left+e.placed,c,s,l),e.start=c,e.placed+=s,c=n.bottom}else{const s=r.h*t,c=e.size||n.width;X(e.start)&&(l=e.start),n.fullSize?hn(n,l,a.top,c,o.outerHeight-a.bottom-a.top):hn(n,l,r.top+e.placed,c,s),e.start=l,e.placed+=s,l=n.right}}r.x=l,r.y=c}var r={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){const i=e.boxes?e.boxes.indexOf(t):-1;-1!==i&&e.boxes.splice(i,1)},configure(e,t,i){t.fullSize=i.fullSize,t.position=i.position,t.weight=i.weight},update(i,e,t,n){if(!i)return;const r=P(i.options.layout.padding),o=Math.max(e-r.width,0),s=Math.max(t-r.height,0),a=function(e){const t=function(e){const t=[];let i,n,r,o,s,a;for(i=0,n=(e||[]).length;i<n;++i)r=e[i],{position:o,options:{stack:s,stackWeight:a=1}}=r,t.push({index:i,box:r,pos:o,horizontal:r.isHorizontal(),weight:r.weight,stack:s&&o+s,stackWeight:a});return t}(e),i=on(t.filter(e=>e.box.fullSize),!0),n=on(nn(t,"left"),!0),r=on(nn(t,"right")),o=on(nn(t,"top"),!0),s=on(nn(t,"bottom")),a=rn(t,"x"),l=rn(t,"y");return{fullSize:i,leftAndTop:n.concat(o),rightAndBottom:r.concat(l).concat(s).concat(a),chartArea:nn(t,"chartArea"),vertical:n.concat(r).concat(l),horizontal:o.concat(s).concat(a)}}(i.boxes),l=a.vertical,c=a.horizontal;S(i.boxes,e=>{"function"==typeof e.beforeLayout&&e.beforeLayout()});const u=l.reduce((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:t,padding:r,availableWidth:o,availableHeight:s,vBoxMaxWidth:o/2/u,hBoxMaxHeight:s/2}),h=Object.assign({},r);ln(h,P(n));const f=Object.assign({maxPadding:h,w:o,h:s,x:r.left,y:r.top},r),p=sn(l.concat(c),d);dn(a.fullSize,f,d,p),dn(l,f,d,p),dn(c,f,d,p)&&dn(l,f,d,p),function(i){const n=i.maxPadding;function e(e){const t=Math.max(n[e]-i[e],0);return i[e]+=t,t}i.y+=e("top"),i.x+=e("left"),e("right"),e("bottom")}(f),fn(a.leftAndTop,f,d,p),f.x+=f.w,f.y+=f.h,fn(a.rightAndBottom,f,d,p),i.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},S(a.chartArea,e=>{const t=e.box;Object.assign(t,i.chartArea),t.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class pn{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,i){}removeEventListener(e,t,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,i,n){return t=Math.max(0,t||e.width),i=i||e.height,{width:t,height:Math.max(0,n?Math.floor(t/n):i)}}isAttached(e){return!0}updateConfig(e){}}class gn extends pn{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const mn="$chartjs",vn={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},yn=e=>null===e||""===e;const bn=!!Lt&&{passive:!0};function _n(e,t,i){e.canvas.removeEventListener(t,i,bn)}function wn(t,i){for(const e of t)if(e===i||e.contains(i))return!0}function Cn(e,t,i){const n=e.canvas,r=new MutationObserver(e=>{let t=!1;for(const i of e)t=t||wn(i.addedNodes,n),t=t&&!wn(i.removedNodes,n);t&&i()});return r.observe(document,{childList:!0,subtree:!0}),r}function xn(e,t,i){const n=e.canvas,r=new MutationObserver(e=>{let t=!1;for(const i of e)t=t||wn(i.removedNodes,n),t=t&&!wn(i.addedNodes,n);t&&i()});return r.observe(document,{childList:!0,subtree:!0}),r}const Sn=new Map;let An=0;function En(){const i=window.devicePixelRatio;i!==An&&(An=i,Sn.forEach((e,t)=>{t.currentDevicePixelRatio!==i&&e()}))}function Tn(e,t,n){const i=e.canvas,r=i&&St(i);if(!r)return;const o=Ae((e,t)=>{const i=r.clientWidth;n(e,t),i<r.clientWidth&&n()},window),s=new ResizeObserver(e=>{const t=e[0],i=t.contentRect.width,n=t.contentRect.height;0===i&&0===n||o(i,n)});return s.observe(r),function(e,t){Sn.size||window.addEventListener("resize",En),Sn.set(e,t)}(e,o),s}function Dn(e,t,i){i&&i.disconnect(),"resize"===t&&function(e){Sn.delete(e),Sn.size||window.removeEventListener("resize",En)}(e)}function Rn(t,e,i){const n=t.canvas,r=Ae(e=>{null!==t.ctx&&i(function(e,t){const i=vn[e.type]||e.type,{x:n,y:r}=kt(e,t);return{type:i,chart:t,native:e,x:void 0!==n?n:null,y:void 0!==r?r:null}}(e,t))},t);return function(e,t,i){e.addEventListener(t,i,bn)}(n,e,r),r}class Mn extends pn{acquireContext(e,t){const i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(function(e,t){const i=e.style,n=e.getAttribute("height"),r=e.getAttribute("width");if(e[mn]={initial:{height:n,width:r,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",yn(r)){const t=Pt(e,"width");void 0!==t&&(e.width=t)}if(yn(n))if(""===e.style.height)e.height=e.width/(t||2);else{const t=Pt(e,"height");void 0!==t&&(e.height=t)}}(e,t),i):null}releaseContext(e){const i=e.canvas;if(!i[mn])return!1;const n=i[mn].initial;["height","width"].forEach(e=>{const t=n[e];T(t)?i.removeAttribute(e):i.setAttribute(e,t)});const t=n.style||{};return Object.keys(t).forEach(e=>{i.style[e]=t[e]}),i.width=i.width,delete i[mn],!0}addEventListener(e,t,i){this.removeEventListener(e,t);const n=e.$proxies||(e.$proxies={}),r={attach:Cn,detach:xn,resize:Tn}[t]||Rn;n[t]=r(e,t,i)}removeEventListener(e,t){const i=e.$proxies||(e.$proxies={}),n=i[t];if(!n)return;({attach:Dn,detach:Dn,resize:Dn}[t]||_n)(e,t,n),i[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,i,n){return Nt(e,t,i,n)}isAttached(e){const t=St(e);return!(!t||!t.isConnected)}}function kn(e){return!xt()||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?gn:Mn}var On=Object.freeze({__proto__:null,BasePlatform:pn,BasicPlatform:gn,DomPlatform:Mn,_detectPlatform:kn});const Nn="transparent",In={boolean:(e,t,i)=>i>.5?t:e,color(e,t,i){const n=ut(e||Nn),r=n.valid&&ut(t||Nn);return r&&r.valid?r.mix(n,i).hexString():t},number:(e,t,i)=>e+(t-e)*i};class Ln{constructor(e,t,i,n){const r=t[i];n=Ni([e.to,n,r,e.from]);const o=Ni([e.from,r,n]);this._active=!0,this._fn=e.fn||In[e.type||typeof o],this._easing=Ci[e.easing]||Ci.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=i,this._from=o,this._to=n,this._promises=void 0}active(){return this._active}update(n,r,o){if(this._active){this._notify(!1);const e=this._target[this._prop],t=o-this._start,i=this._duration-t;this._start=o,this._duration=Math.floor(Math.max(i,n.duration)),this._total+=t,this._loop=!!n.loop,this._to=Ni([n.to,r,e,n.from]),this._from=Ni([n.from,e,r])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,i=this._duration,n=this._prop,r=this._from,o=this._loop,s=this._to;let a;if(this._active=r!==s&&(o||t<i),!this._active)return this._target[n]=s,void this._notify(!0);t<0?this._target[n]=r:(a=t/i%2,a=o&&a>1?2-a:a,a=this._easing(Math.min(1,Math.max(0,a))),this._target[n]=this._fn(r,s,a))}wait(){const i=this._promises||(this._promises=[]);return new Promise((e,t)=>{i.push({res:e,rej:t})})}_notify(e){const t=e?"res":"rej",i=this._promises||[];for(let e=0;e<i.length;e++)i[e][t]()}}class Pn{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(n){if(!k(n))return;const r=Object.keys(D.animation),o=this._properties;Object.getOwnPropertyNames(n).forEach(t=>{const e=n[t];if(!k(e))return;const i={};for(const n of r)i[n]=e[n];(M(e.properties)&&e.properties||[t]).forEach(e=>{e!==t&&o.has(e)||o.set(e,i)})})}_animateOptions(e,t){const i=t.options,n=function(e,t){if(!t)return;let i=e.options;if(!i)return void(e.options=t);i.$shared&&(e.options=i=Object.assign({},i,{$shared:!1,$animations:{}}));return i}(e,i);if(!n)return[];const r=this._createAnimations(n,i);return i.$shared&&function(i,e){const n=[],r=Object.keys(e);for(let t=0;t<r.length;t++){const e=i[r[t]];e&&e.active()&&n.push(e.wait())}return Promise.all(n)}(e.options.$animations,i).then(()=>{e.options=i},()=>{}),r}_createAnimations(r,o){const s=this._properties,a=[],l=r.$animations||(r.$animations={}),c=Object.keys(o),u=Date.now();let d;for(d=c.length-1;d>=0;--d){const e=c[d];if("$"===e.charAt(0))continue;if("options"===e){a.push(...this._animateOptions(r,o));continue}const t=o[e];let i=l[e];const n=s.get(e);if(i){if(n&&i.active()){i.update(n,t,u);continue}i.cancel()}n&&n.duration?(l[e]=i=new Ln(n,r,e,t),a.push(i)):r[e]=t}return a}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const i=this._createAnimations(e,t);return i.length?(u.add(this._chart,i),!0):void 0}}function Fn(e,t){const i=e&&e.options||{},n=i.reverse,r=void 0===i.min?t:0,o=void 0===i.max?t:0;return{start:n?o:r,end:n?r:o}}function Gn(e,t){const i=[],n=e._getSortedDatasetMetas(t);let r,o;for(r=0,o=n.length;r<o;++r)i.push(n[r].index);return i}function $n(e,t,i,n={}){const r=e.keys,o="single"===n.mode;let s,a,l,c;if(null!==t){for(s=0,a=r.length;s<a;++s){if(l=+r[s],l===i){if(n.all)continue;break}c=e.values[l],p(c)&&(o||0===t||v(t)===v(c))&&(t+=c)}return t}}function Hn(e,t){const i=e&&e.options.stacked;return i||void 0===i&&void 0!==t.stack}function Bn(e,t,i){const n=e[t]||(e[t]={});return n[i]||(n[i]={})}function Vn(t,i,n,r){for(const e of i.getMatchingVisibleMetas(r).reverse()){const i=t[e.index];if(n&&i>0||!n&&i<0)return e.index}return null}function jn(e,t){const{chart:i,_cachedMeta:n}=e,r=i._stacks||(i._stacks={}),{iScale:o,vScale:s,index:a}=n,l=o.axis,c=s.axis,u=function(e,t,i){return`${e.id}.${t.id}.${i.stack||i.type}`}(o,s,n),d=t.length;let h;for(let e=0;e<d;++e){const i=t[e],{[l]:o,[c]:d}=i;h=(i._stacks||(i._stacks={}))[c]=Bn(r,u,o),h[a]=d,h._top=Vn(h,s,!0,n.type),h._bottom=Vn(h,s,!1,n.type);(h._visualValues||(h._visualValues={}))[a]=d}}function zn(e,t){const i=e.scales;return Object.keys(i).filter(e=>i[e].axis===t).shift()}function Wn(e,t){const i=e.controller.index,n=e.vScale&&e.vScale.axis;if(n){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[n]||void 0===t[n][i])return;delete t[n][i],void 0!==t[n]._visualValues&&void 0!==t[n]._visualValues[i]&&delete t[n]._visualValues[i]}}}const Un=e=>"reset"===e||"none"===e,Yn=(e,t)=>t?e:Object.assign({},e);class qn{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Hn(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Wn(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,i=this.getDataset(),n=(e,t,i,n)=>"x"===e?t:"r"===e?n:i,r=t.xAxisID=O(i.xAxisID,zn(e,"x")),o=t.yAxisID=O(i.yAxisID,zn(e,"y")),s=t.rAxisID=O(i.rAxisID,zn(e,"r")),a=t.indexAxis,l=t.iAxisID=n(a,r,o,s),c=t.vAxisID=n(a,o,r,s);t.xScale=this.getScaleForId(r),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(s),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Ce(this._data,this),e._stacked&&Wn(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),i=this._data;if(k(t))this._data=function(e){const t=Object.keys(e),i=new Array(t.length);let n,r,o;for(n=0,r=t.length;n<r;++n)o=t[n],i[n]={x:o,y:e[o]};return i}(t);else if(i!==t){if(i){Ce(i,this);const e=this._cachedMeta;Wn(e),e._parsed=[]}t&&Object.isExtensible(t)&&we(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,i=this.getDataset();let n=!1;this._dataCheck();const r=t._stacked;t._stacked=Hn(t.vScale,t),t.stack!==i.stack&&(n=!0,Wn(t),t.stack=i.stack),this._resyncElements(e),(n||r!==t._stacked)&&jn(this,t._parsed)}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),i=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:i,_data:n}=this,{iScale:r,_stacked:o}=i,s=r.axis;let a,l,c,u=0===e&&t===n.length||i._sorted,d=e>0&&i._parsed[e-1];if(!1===this._parsing)i._parsed=n,i._sorted=!0,c=n;else{c=M(n[e])?this.parseArrayData(i,n,e,t):k(n[e])?this.parseObjectData(i,n,e,t):this.parsePrimitiveData(i,n,e,t);const r=()=>null===l[s]||d&&l[s]<d[s];for(a=0;a<t;++a)i._parsed[a+e]=l=c[a],u&&(r()&&(u=!1),d=l);i._sorted=u}o&&jn(this,c)}parsePrimitiveData(e,t,i,n){const{iScale:r,vScale:o}=e,s=r.axis,a=o.axis,l=r.getLabels(),c=r===o,u=new Array(n);let d,h,f;for(d=0,h=n;d<h;++d)f=d+i,u[d]={[s]:c||r.parse(l[f],f),[a]:o.parse(t[f],f)};return u}parseArrayData(e,t,i,n){const{xScale:r,yScale:o}=e,s=new Array(n);let a,l,c,u;for(a=0,l=n;a<l;++a)c=a+i,u=t[c],s[a]={x:r.parse(u[0],c),y:o.parse(u[1],c)};return s}parseObjectData(e,t,i,n){const{xScale:r,yScale:o}=e,{xAxisKey:s="x",yAxisKey:a="y"}=this._parsing,l=new Array(n);let c,u,d,h;for(c=0,u=n;c<u;++c)d=c+i,h=t[d],l[c]={x:r.parse(m(h,s),d),y:o.parse(m(h,a),d)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,i){const n=this.chart,r=this._cachedMeta,o=t[e.axis];return $n({keys:Gn(n,!0),values:t._stacks[e.axis]._visualValues},o,r.index,{mode:i})}updateRangeFromParsed(e,t,i,n){const r=i[t.axis];let o=null===r?NaN:r;const s=n&&i._stacks[t.axis];n&&s&&(n.values=s,o=$n(n,r,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(t,e){const i=this._cachedMeta,n=i._parsed,r=i._sorted&&t===i.iScale,o=n.length,s=this._getOtherScale(t),a=((e,t,i)=>e&&!t.hidden&&t._stacked&&{keys:Gn(i,!0),values:null})(e,i,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:u}=function(e){const{min:t,max:i,minDefined:n,maxDefined:r}=e.getUserBounds();return{min:n?t:Number.NEGATIVE_INFINITY,max:r?i:Number.POSITIVE_INFINITY}}(s);let d,h;function f(){h=n[d];const e=h[s.axis];return!p(h[t.axis])||c>e||u<e}for(d=0;d<o&&(f()||(this.updateRangeFromParsed(l,t,h,a),!r));++d);if(r)for(d=o-1;d>=0;--d)if(!f()){this.updateRangeFromParsed(l,t,h,a);break}return l}getAllParsedValues(e){const t=this._cachedMeta._parsed,i=[];let n,r,o;for(n=0,r=t.length;n<r;++n)o=t[n][e.axis],p(o)&&i.push(o);return i}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,i=t.iScale,n=t.vScale,r=this.getParsed(e);return{label:i?""+i.getLabelForValue(r[i.axis]):"",value:n?""+n.getLabelForValue(r[n.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){let t,i,n,r;return k(e)?(t=e.top,i=e.right,n=e.bottom,r=e.left):t=i=n=r=e,{top:t,right:i,bottom:n,left:r,disabled:!1===e}}(O(this.options.clip,function(e,t,i){if(!1===i)return!1;const n=Fn(e,i),r=Fn(t,i);return{top:r.end,right:n.end,bottom:r.start,left:n.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,i=this._cachedMeta,n=i.data||[],r=t.chartArea,o=[],s=this._drawStart||0,a=this._drawCount||n.length-s,l=this.options.drawActiveElementsOnTop;let c;for(i.dataset&&i.dataset.draw(e,r,s,a),c=s;c<s+a;++c){const t=n[c];t.hidden||(t.active&&l?o.push(t):t.draw(e,r))}for(c=0;c<o.length;++c)o[c].draw(e,r)}getStyle(e,t){const i=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(e||0,i)}getContext(e,t,i){const n=this.getDataset();let r;if(e>=0&&e<this._cachedMeta.data.length){const t=this._cachedMeta.data[e];r=t.$context||(t.$context=function(e,t,i){return Li(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:i,index:t,mode:"default",type:"data"})}(this.getContext(),e,t)),r.parsed=this.getParsed(e),r.raw=n.data[e],r.index=r.dataIndex=e}else r=this.$context||(this.$context=function(e,t){return Li(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),r.dataset=n,r.index=r.datasetIndex=this.index;return r.active=!!t,r.mode=i,r}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",i){const n="active"===t,r=this._cachedDataOpts,o=e+"-"+t,s=r[o],a=this.enableOptionSharing&&X(i);if(s)return Yn(s,a);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,e),u=n?[`${e}Hover`,"hover",e,""]:[e,""],d=l.getOptionScopes(this.getDataset(),c),h=Object.keys(D.elements[e]),f=l.resolveNamedOptions(d,h,()=>this.getContext(i,n,t),u);return f.$shared&&(f.$shared=a,r[o]=Object.freeze(Yn(f,a))),f}_resolveAnimations(e,t,i){const n=this.chart,r=this._cachedDataOpts,o=`animation-${t}`,s=r[o];if(s)return s;let a;if(!1!==n.options.animation){const n=this.chart.config,r=n.datasetAnimationScopeKeys(this._type,t),o=n.getOptionScopes(this.getDataset(),r);a=n.createResolver(o,this.getContext(e,i,t))}const l=new Pn(n,a&&a.animations);return a&&a._cacheable&&(r[o]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||Un(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const i=this.resolveDataElementOptions(e,t),n=this._sharedOptions,r=this.getSharedOptions(i),o=this.includeOptions(t,r)||r!==n;return this.updateSharedOptions(r,t,i),{sharedOptions:r,includeOptions:o}}updateElement(e,t,i,n){Un(n)?Object.assign(e,i):this._resolveAnimations(t,n).update(e,i)}updateSharedOptions(e,t,i){e&&!Un(t)&&this._resolveAnimations(void 0,t).update(e,i)}_setStyle(e,t,i,n){e.active=n;const r=this.getStyle(t,n);this._resolveAnimations(t,i,n).update(e,{options:!n&&this.getSharedOptions(r)||r})}removeHoverStyle(e,t,i){this._setStyle(e,i,"active",!1)}setHoverStyle(e,t,i){this._setStyle(e,i,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,i=this._cachedMeta.data;for(const[e,t,i]of this._syncList)this[e](t,i);this._syncList=[];const n=i.length,r=t.length,o=Math.min(r,n);o&&this.parse(0,o),r>n?this._insertElements(n,r-n,e):r<n&&this._removeElements(r,n-r)}_insertElements(e,t,i=!0){const n=this._cachedMeta,r=n.data,o=e+t;let s;const a=e=>{for(e.length+=t,s=e.length-1;s>=o;s--)e[s]=e[s-t]};for(a(r),s=e;s<o;++s)r[s]=new this.dataElementType;this._parsing&&a(n._parsed),this.parse(e,t),i&&this.updateElements(r,e,t,"reset")}updateElements(e,t,i,n){}_removeElements(t,i){const n=this._cachedMeta;if(this._parsing){const e=n._parsed.splice(t,i);n._stacked&&Wn(n,e)}n.data.splice(t,i)}_sync(n){if(this._parsing)this._syncList.push(n);else{const[e,t,i]=n;this[e](t,i)}this.chart._dataChanges.push([this.index,...n])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const i=arguments.length-2;i&&this._sync(["_insertElements",e,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}class t{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}hasValue(){return ae(this.x)&&ae(this.y)}getProps(e,t){const i=this.$animations;if(!t||!i)return this;const n={};return e.forEach(e=>{n[e]=i[e]&&i[e].active()?i[e]._to:this[e]}),n}}function Kn(e,i){const t=e.options.ticks,n=function(e){const t=e.options.offset,i=e._tickSize(),n=e._length/i+(t?0:1),r=e._maxLength/i;return Math.floor(Math.min(n,r))}(e),r=Math.min(t.maxTicksLimit||n,n),o=t.major.enabled?function(e){const t=[];let i,n;for(i=0,n=e.length;i<n;i++)e[i].major&&t.push(i);return t}(i):[],s=o.length,a=o[0],l=o[s-1],c=[];if(s>r)return function(e,t,i,n){let r,o=0,s=i[0];for(n=Math.ceil(n),r=0;r<e.length;r++)r===s&&(t.push(e[r]),o++,s=i[o*n])}(i,c,o,s/r),c;const u=function(e,i,t){const n=function(e){const t=e.length;let i,n;if(t<2)return!1;for(n=e[0],i=1;i<t;++i)if(e[i]-e[i-1]!==n)return!1;return n}(e),r=i.length/t;if(!n)return Math.max(r,1);const o=se(n);for(let e=0,t=o.length-1;e<t;e++){const i=o[e];if(i>r)return i}return Math.max(r,1)}(o,i,r);if(s>0){let e,t;const n=s>1?Math.round((l-a)/(s-1)):null;for(Xn(i,c,u,T(n)?0:a-n,a),e=0,t=s-1;e<t;e++)Xn(i,c,u,o[e],o[e+1]);return Xn(i,c,u,l,T(n)?i.length:l+n),c}return Xn(i,c,u),c}function Xn(e,t,i,n,r){const o=O(n,0),s=Math.min(O(r,e.length),e.length);let a,l,c,u=0;for(i=Math.ceil(i),r&&(a=r-n,i=a/Math.floor(a/i)),c=o;c<0;)u++,c=Math.round(o+u*i);for(l=Math.max(o,0);l<s;l++)l===c&&(t.push(e[l]),u++,c=Math.round(o+u*i))}const Zn=(e,t,i)=>"top"===t||"left"===t?e[t]+i:e[t]-i,Qn=(e,t)=>Math.min(t||e,e);function Jn(e,t){const i=[],n=e.length/t,r=e.length;let o=0;for(;o<r;o+=n)i.push(e[Math.floor(o)]);return i}function er(e,t,i){const n=e.ticks.length,r=Math.min(t,n-1),o=e._startPixel,s=e._endPixel,a=1e-6;let l,c=e.getPixelForTick(r);if(!(i&&(l=1===n?Math.max(c-o,s-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(r-1))/2,c+=r<t?l:-l,c<o-a||c>s+a)))return c}function tr(e){return e.drawTicks?e.tickLength:0}function ir(e,t){if(!e.display)return 0;const i=R(e.font,t),n=P(e.padding);return(M(e.text)?e.text.length:1)*i.lineHeight+n.height}function nr(e,t,i){let n=Te(e);return(i&&"right"!==t||!i&&"right"===t)&&(n=(e=>"left"===e?"right":"right"===e?"left":e)(n)),n}class rr extends t{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:i,_suggestedMax:n}=this;return e=g(e,Number.POSITIVE_INFINITY),t=g(t,Number.NEGATIVE_INFINITY),i=g(i,Number.POSITIVE_INFINITY),n=g(n,Number.NEGATIVE_INFINITY),{min:g(e,i),max:g(t,n),minDefined:p(e),maxDefined:p(t)}}getMinMax(i){let n,{min:r,max:o,minDefined:s,maxDefined:a}=this.getUserBounds();if(s&&a)return{min:r,max:o};const l=this.getMatchingVisibleMetas();for(let e=0,t=l.length;e<t;++e)n=l[e].controller.getMinMax(this,i),s||(r=Math.min(r,n.min)),a||(o=Math.max(o,n.max));return r=a&&r>o?o:r,o=s&&r>o?r:o,{min:g(r,g(o,r)),max:g(o,g(r,o))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){f(this.options.beforeUpdate,[this])}update(e,t,i){const{beginAtZero:n,grace:r,ticks:o}=this.options,s=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Ii(this,r,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const a=s<this.ticks.length;this._convertTicksToLabels(a?Jn(this.ticks,s):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||"auto"===o.source)&&(this.ticks=Kn(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),a&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,t,i=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,i=!i),this._startPixel=e,this._endPixel=t,this._reversePixels=i,this._length=t-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){f(this.options.afterUpdate,[this])}beforeSetDimensions(){f(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){f(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),f(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){f(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let i,n,r;for(i=0,n=e.length;i<n;i++)r=e[i],r.label=f(t.callback,[r.value,i,e],this)}afterTickToLabelConversion(){f(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){f(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,i=Qn(this.ticks.length,e.ticks.maxTicksLimit),n=t.minRotation||0,r=t.maxRotation;let o,s,a,l=n;if(!this._isVisible()||!t.display||n>=r||i<=1||!this.isHorizontal())return void(this.labelRotation=n);const c=this._getLabelSizes(),u=c.widest.width,d=c.highest.height,h=b(this.chart.width-u,0,this.maxWidth);o=e.offset?this.maxWidth/i:h/(i-1),u+6>o&&(o=h/(i-(e.offset?.5:1)),s=this.maxHeight-tr(e.grid)-t.padding-ir(e.title,this.chart.options.font),a=Math.sqrt(u*u+d*d),l=ue(Math.min(Math.asin(b((c.highest.height+6)/o,-1,1)),Math.asin(b(s/a,-1,1))-Math.asin(b(d/a,-1,1)))),l=Math.max(n,Math.min(r,l))),this.labelRotation=l}afterCalculateLabelRotation(){f(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){f(this.options.beforeFit,[this])}fit(){const r={width:0,height:0},{chart:o,options:{ticks:s,title:a,grid:l}}=this,c=this._isVisible(),u=this.isHorizontal();if(c){const c=ir(a,o.options.font);if(u?(r.width=this.maxWidth,r.height=tr(l)+c):(r.height=this.maxHeight,r.width=tr(l)+c),s.display&&this.ticks.length){const{first:o,last:a,widest:l,highest:c}=this._getLabelSizes(),e=2*s.padding,t=L(this.labelRotation),i=Math.cos(t),n=Math.sin(t);if(u){const o=s.mirror?0:n*l.width+i*c.height;r.height=Math.min(this.maxHeight,r.height+o+e)}else{const o=s.mirror?0:i*l.width+n*c.height;r.width=Math.min(this.maxWidth,r.width+o+e)}this._calculatePadding(o,a,n,i)}}this._handleMargins(),u?(this.width=this._length=o.width-this._margins.left-this._margins.right,this.height=r.height):(this.width=r.width,this.height=this._length=o.height-this._margins.top-this._margins.bottom)}_calculatePadding(n,r,o,s){const{ticks:{align:a,padding:l},position:c}=this.options,u=0!==this.labelRotation,d="top"!==c&&"x"===this.axis;if(this.isHorizontal()){const c=this.getPixelForTick(0)-this.left,e=this.right-this.getPixelForTick(this.ticks.length-1);let t=0,i=0;u?d?(t=s*n.width,i=o*r.height):(t=o*n.height,i=s*r.width):"start"===a?i=r.width:"end"===a?t=n.width:"inner"!==a&&(t=n.width/2,i=r.width/2),this.paddingLeft=Math.max((t-c+l)*this.width/(this.width-c),0),this.paddingRight=Math.max((i-e+l)*this.width/(this.width-e),0)}else{let e=r.height/2,t=n.height/2;"start"===a?(e=0,t=n.height):"end"===a&&(e=r.height,t=0),this.paddingTop=e+l,this.paddingBottom=t+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){f(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){let t,i;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,i=e.length;t<i;t++)T(e[t].label)&&(e.splice(t,1),i--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let i=this._labelSizes;if(!i){const e=this.options.ticks.sampleSize;let t=this.ticks;e<t.length&&(t=Jn(t,e)),this._labelSizes=i=this._computeLabelSizes(t,t.length,this.options.ticks.maxTicksLimit)}return i}_computeLabelSizes(e,t,i){const{ctx:n,_longestTextCache:r}=this,o=[],s=[],a=Math.floor(t/Qn(t,i));let l,c,u,d,h,f,p,g,m,v,y,b=0,_=0;for(l=0;l<t;l+=a){if(d=e[l].label,h=this._resolveTickFontOptions(l),n.font=f=h.string,p=r[f]=r[f]||{data:{},gc:[]},g=h.lineHeight,m=v=0,T(d)||M(d)){if(M(d))for(c=0,u=d.length;c<u;++c)y=d[c],T(y)||M(y)||(m=Gt(n,p.data,p.gc,m,y),v+=g)}else m=Gt(n,p.data,p.gc,m,d),v=g;o.push(m),s.push(v),b=Math.max(m,b),_=Math.max(v,_)}!function(e,r){S(e,e=>{const t=e.gc,i=t.length/2;let n;if(i>r){for(n=0;n<i;++n)delete e.data[t[n]];t.splice(0,i)}})}(r,t);const w=o.indexOf(b),C=s.indexOf(_),x=e=>({width:o[e]||0,height:s[e]||0});return{first:x(0),last:x(t-1),widest:x(w),highest:x(C),widths:o,heights:s}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return me(this._alignToPixels?Ht(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(t){const i=this.ticks||[];if(t>=0&&t<i.length){const e=i[t];return e.$context||(e.$context=function(e,t,i){return Li(e,{tick:i,index:t,type:"tick"})}(this.getContext(),t,e))}return this.$context||(this.$context=Li(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const e=this.options.ticks,t=L(this.labelRotation),i=Math.abs(Math.cos(t)),n=Math.abs(Math.sin(t)),r=this._getLabelSizes(),o=e.autoSkipPadding||0,s=r?r.widest.width+o:0,a=r?r.highest.height+o:0;return this.isHorizontal()?a*i>s*n?s/i:a/n:a*n<s*i?a/i:s/n}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,i=this.chart,n=this.options,{grid:r,position:o,border:s}=n,a=r.offset,l=this.isHorizontal(),c=this.ticks.length+(a?1:0),u=tr(r),d=[],h=s.setContext(this.getContext()),f=h.display?h.width:0,p=f/2,g=function(e){return Ht(i,e,f)};let m,v,y,b,_,w,C,x,S,A,E,T;if("top"===o)m=g(this.bottom),w=this.bottom-u,x=m-p,A=g(e.top)+p,T=e.bottom;else if("bottom"===o)m=g(this.top),A=e.top,T=g(e.bottom)-p,w=m+p,x=this.top+u;else if("left"===o)m=g(this.right),_=this.right-u,C=m-p,S=g(e.left)+p,E=e.right;else if("right"===o)m=g(this.left),S=e.left,E=g(e.right)-p,_=m+p,C=this.left+u;else if("x"===t){if("center"===o)m=g((e.top+e.bottom)/2+.5);else if(k(o)){const e=Object.keys(o)[0],t=o[e];m=g(this.chart.scales[e].getPixelForValue(t))}A=e.top,T=e.bottom,w=m+p,x=w+u}else if("y"===t){if("center"===o)m=g((e.left+e.right)/2);else if(k(o)){const e=Object.keys(o)[0],t=o[e];m=g(this.chart.scales[e].getPixelForValue(t))}_=m-p,C=_-u,S=e.left,E=e.right}const D=O(n.ticks.maxTicksLimit,c),R=Math.max(1,Math.ceil(c/D));for(v=0;v<c;v+=R){const e=this.getContext(v),t=r.setContext(e),n=s.setContext(e),k=t.lineWidth,o=t.color,O=n.dash||[],c=n.dashOffset,u=t.tickWidth,h=t.tickColor,f=t.tickBorderDash||[],p=t.tickBorderDashOffset;y=er(this,v,a),void 0!==y&&(b=Ht(i,y,k),l?_=C=S=E=b:w=x=A=T=b,d.push({tx1:_,ty1:w,tx2:C,ty2:x,x1:S,y1:A,x2:E,y2:T,width:k,color:o,borderDash:O,borderDashOffset:c,tickWidth:u,tickColor:h,tickBorderDash:f,tickBorderDashOffset:p}))}return this._ticksLength=c,this._borderValue=m,d}_computeLabelItems(n){const r=this.axis,o=this.options,{position:s,ticks:t}=o,a=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:u,padding:e,mirror:d}=t,i=tr(o.grid),h=i+e,f=d?-e:h,p=-L(this.labelRotation),g=[];let m,v,y,b,_,w,C,x,S,A,E,T,D="middle";if("top"===s)w=this.bottom-f,C=this._getXAxisLabelAlignment();else if("bottom"===s)w=this.top+f,C=this._getXAxisLabelAlignment();else if("left"===s){const n=this._getYAxisLabelAlignment(i);C=n.textAlign,_=n.x}else if("right"===s){const n=this._getYAxisLabelAlignment(i);C=n.textAlign,_=n.x}else if("x"===r){if("center"===s)w=(n.top+n.bottom)/2+h;else if(k(s)){const n=Object.keys(s)[0],r=s[n];w=this.chart.scales[n].getPixelForValue(r)+h}C=this._getXAxisLabelAlignment()}else if("y"===r){if("center"===s)_=(n.left+n.right)/2-h;else if(k(s)){const n=Object.keys(s)[0],r=s[n];_=this.chart.scales[n].getPixelForValue(r)}C=this._getYAxisLabelAlignment(i).textAlign}"y"===r&&("start"===c?D="top":"end"===c&&(D="bottom"));const R=this._getLabelSizes();for(m=0,v=l.length;m<v;++m){y=l[m],b=y.label;const n=t.setContext(this.getContext(m));x=this.getPixelForTick(m)+t.labelOffset,S=this._resolveTickFontOptions(m),A=S.lineHeight,E=M(b)?b.length:1;const r=E/2,o=n.color,k=n.textStrokeColor,c=n.textStrokeWidth;let i,e=C;if(a?(_=x,"inner"===C&&(e=m===v-1?this.options.reverse?"left":"right":0===m?this.options.reverse?"right":"left":"center"),T="top"===s?"near"===u||0!==p?-E*A+A/2:"center"===u?-R.highest.height/2-r*A+A:-R.highest.height+A/2:"near"===u||0!==p?A/2:"center"===u?R.highest.height/2-r*A:R.highest.height-E*A,d&&(T*=-1),0===p||n.showLabelBackdrop||(_+=A/2*Math.sin(p))):(w=x,T=(1-E)*A/2),n.showLabelBackdrop){const r=P(n.backdropPadding),o=R.heights[m],s=R.widths[m];let e=T-r.top,t=0-r.left;switch(D){case"middle":e-=o/2;break;case"bottom":e-=o}switch(C){case"center":t-=s/2;break;case"right":t-=s}i={left:t,top:e,width:s+r.width,height:o+r.height,color:n.backdropColor}}g.push({label:b,font:S,textOffset:T,options:{rotation:p,color:o,strokeColor:k,strokeWidth:c,textAlign:e,textBaseline:D,translation:[_,w],backdrop:i}})}return g}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-L(this.labelRotation))return"top"===e?"left":"right";let i="center";return"start"===t.align?i="left":"end"===t.align?i="right":"inner"===t.align&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:i,mirror:n,padding:r}}=this.options,o=e+r,s=this._getLabelSizes().widest.width;let a,l;return"left"===t?n?(l=this.right+r,"near"===i?a="left":"center"===i?(a="center",l+=s/2):(a="right",l+=s)):(l=this.right-o,"near"===i?a="right":"center"===i?(a="center",l-=s/2):(a="left",l=this.left)):"right"===t?n?(l=this.left+r,"near"===i?a="right":"center"===i?(a="center",l-=s/2):(a="left",l-=s)):(l=this.left+o,"near"===i?a="left":"center"===i?(a="center",l+=s/2):(a="right",l=this.right)):a="right",{textAlign:a,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:i,top:n,width:r,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(i,n,r,o),e.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const i=this.ticks.findIndex(e=>e.value===t);if(i>=0){return e.setContext(this.getContext(i)).lineWidth}return 0}drawGrid(e){const t=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let r,o;const s=(e,t,i)=>{i.width&&i.color&&(n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.setLineDash(i.borderDash||[]),n.lineDashOffset=i.borderDashOffset,n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n.stroke(),n.restore())};if(t.display)for(r=0,o=i.length;r<o;++r){const e=i[r];t.drawOnChartArea&&s({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),t.drawTicks&&s({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:i,grid:n}}=this,r=i.setContext(this.getContext()),o=i.display?r.width:0;if(!o)return;const s=n.setContext(this.getContext(0)).lineWidth,a=this._borderValue;let l,c,u,d;this.isHorizontal()?(l=Ht(e,this.left,o)-o/2,c=Ht(e,this.right,s)+s/2,u=d=a):(u=Ht(e,this.top,o)-o/2,d=Ht(e,this.bottom,s)+s/2,l=c=a),t.save(),t.lineWidth=r.width,t.strokeStyle=r.color,t.beginPath(),t.moveTo(l,u),t.lineTo(c,d),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const t=this.ctx,i=this._computeLabelArea();i&&zt(t,i);const n=this.getLabelItems(e);for(const e of n){const i=e.options,n=e.font;Xt(t,e.label,0,e.textOffset,n,i)}i&&Wt(t)}drawTitle(){const{ctx:e,options:{position:t,title:i,reverse:n}}=this;if(!i.display)return;const r=R(i.font),o=P(i.padding),s=i.align;let a=r.lineHeight/2;"bottom"===t||"center"===t||k(t)?(a+=o.bottom,M(i.text)&&(a+=r.lineHeight*(i.text.length-1))):a+=o.top;const{titleX:l,titleY:c,maxWidth:u,rotation:d}=function(e,t,i,n){const{top:r,left:o,bottom:s,right:a,chart:l}=e,{chartArea:c,scales:u}=l;let d,h,f,p=0;const g=s-r,m=a-o;if(e.isHorizontal()){if(h=E(n,o,a),k(i)){const e=Object.keys(i)[0],n=i[e];f=u[e].getPixelForValue(n)+g-t}else f="center"===i?(c.bottom+c.top)/2+g-t:Zn(e,i,t);d=a-o}else{if(k(i)){const e=Object.keys(i)[0],n=i[e];h=u[e].getPixelForValue(n)-m+t}else h="center"===i?(c.left+c.right)/2-m+t:Zn(e,i,t);f=E(n,s,r),p="left"===i?-I:I}return{titleX:h,titleY:f,maxWidth:d,rotation:p}}(this,a,t,s);Xt(e,i.text,0,0,r,{color:i.color,maxWidth:u,rotation:d,textAlign:nr(s,t,n),textBaseline:"middle",translation:[l,c]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,i=O(e.grid&&e.grid.z,-1),n=O(e.border&&e.border.z,0);return this._isVisible()&&this.draw===rr.prototype.draw?[{z:i,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:t,draw:e=>{this.drawLabels(e)}}]:[{z:t,draw:e=>{this.draw(e)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",n=[];let r,o;for(r=0,o=t.length;r<o;++r){const o=t[r];o[i]!==this.id||e&&o.type!==e||n.push(o)}return n}_resolveTickFontOptions(e){return R(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class or{constructor(e,t,i){this.type=e,this.scope=t,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let i;(function(e){return"id"in e&&"defaults"in e})(t)&&(i=this.register(t));const n=this.items,r=e.id,o=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+e);return r in n||(n[r]=e,function(e,t,i){const n=W(Object.create(null),[i?D.get(i):{},D.get(t),e.defaults]);D.set(t,n),e.defaultRoutes&&function(a,l){Object.keys(l).forEach(e=>{const t=e.split("."),i=t.pop(),n=[a].concat(t).join("."),r=l[e].split("."),o=r.pop(),s=r.join(".");D.route(n,i,s,o)})}(t,e.defaultRoutes);e.descriptors&&D.describe(t,e.descriptors)}(e,o,i),this.override&&D.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,i=e.id,n=this.scope;i in t&&delete t[i],n&&i in D[n]&&(delete D[n][i],this.override&&delete yt[i])}}class sr{constructor(){this.controllers=new or(qn,"datasets",!0),this.elements=new or(t,"elements"),this.plugins=new or(Object,"plugins"),this.scales=new or(rr,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(i,e,n){[...e].forEach(e=>{const t=n||this._getRegistryForType(e);n||t.isForType(e)||t===this.plugins&&e.id?this._exec(i,t,e):S(e,e=>{const t=n||this._getRegistryForType(e);this._exec(i,t,e)})})}_exec(e,t,i){const n=K(e);f(i["before"+n],[],i),t[e](i),f(i["after"+n],[],i)}_getRegistryForType(i){for(let t=0;t<this._typedRegistries.length;t++){const e=this._typedRegistries[t];if(e.isForType(i))return e}return this.plugins}_get(e,t,i){const n=t.get(e);if(void 0===n)throw new Error('"'+e+'" is not a registered '+i+".");return n}}var h=new sr;class ar{constructor(){this._init=[]}notify(e,t,i,n){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const r=n?this._descriptors(e).filter(n):this._descriptors(e),o=this._notify(r,e,t,i);return"afterDestroy"===t&&(this._notify(r,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(t,i,n,r){r=r||{};for(const e of t){const t=e.plugin;if(!1===f(t[n],[i,r,e.options],t)&&r.cancelable)return!1}return!0}invalidate(){T(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const i=e&&e.config,n=O(i.options&&i.options.plugins,{}),r=function(e){const t={},i=[],n=Object.keys(h.plugins.items);for(let e=0;e<n.length;e++)i.push(h.getPlugin(n[e]));const r=e.plugins||[];for(let e=0;e<r.length;e++){const n=r[e];-1===i.indexOf(n)&&(i.push(n),t[n.id]=!0)}return{plugins:i,localIds:t}}(i);return!1!==n||t?function(i,{plugins:n,localIds:r},o,s){const a=[],l=i.getContext();for(const t of n){const n=t.id,e=lr(o[n],s);null!==e&&a.push({plugin:t,options:cr(i.config,{plugin:t,local:r[n]},e,l)})}return a}(e,r,n,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],i=this._cache,n=(e,i)=>e.filter(t=>!i.some(e=>t.plugin.id===e.plugin.id));this._notify(n(t,i),e,"stop"),this._notify(n(i,t),e,"start")}}function lr(e,t){return t||!1!==e?!0===e?{}:e:null}function cr(e,{plugin:t,local:i},n,r){const o=e.pluginScopeKeys(t),s=e.getOptionScopes(n,o);return i&&t.defaults&&s.push(t.defaults),e.createResolver(s,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function ur(e,t){const i=D.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||i.indexAxis||"x"}function dr(e){if("x"===e||"y"===e||"r"===e)return e}function hr(t,...i){if(dr(t))return t;for(const e of i){const i=e.axis||("top"===(n=e.position)||"bottom"===n?"x":"left"===n||"right"===n?"y":void 0)||t.length>1&&dr(t[0].toLowerCase());if(i)return i}var n;throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function fr(e,t,i){if(i[t+"AxisID"]===e)return{axis:t}}function pr(s,t){const o=yt[s.type]||{scales:{}},a=t.scales||{},l=ur(s.type,t),c=Object.create(null);return Object.keys(a).forEach(e=>{const t=a[e];if(!k(t))return console.error(`Invalid scale configuration for scale: ${e}`);if(t._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${e}`);const i=hr(e,t,function(t,i){if(i.data&&i.data.datasets){const e=i.data.datasets.filter(e=>e.xAxisID===t||e.yAxisID===t);if(e.length)return fr(t,"x",e[0])||fr(t,"y",e[0])}return{}}(e,s),D.scales[t.type]),n=function(e,t){return e===t?"_index_":"_value_"}(i,l),r=o.scales||{};c[e]=U(Object.create(null),[{axis:i},t,r[i],r[n]])}),s.data.datasets.forEach(n=>{const e=n.type||s.type,r=n.indexAxis||ur(e,t),o=(yt[e]||{}).scales||{};Object.keys(o).forEach(e=>{const t=function(e,t){let i=e;return"_index_"===e?i=t:"_value_"===e&&(i="x"===t?"y":"x"),i}(e,r),i=n[t+"AxisID"]||t;c[i]=c[i]||Object.create(null),U(c[i],[{axis:t},a[i],o[e]])})}),Object.keys(c).forEach(e=>{const t=c[e];U(t,[D.scales[t.type],D.scale])}),c}function gr(e){const t=e.options||(e.options={});t.plugins=O(t.plugins,{}),t.scales=pr(e,t)}function mr(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const vr=new Map,yr=new Set;function br(e,t){let i=vr.get(e);return i||(i=t(),vr.set(e,i),yr.add(i)),i}const _r=(e,t,i)=>{const n=m(t,i);void 0!==n&&e.add(n)};class wr{constructor(e){this._config=function(e){return(e=e||{}).data=mr(e.data),gr(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=mr(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),gr(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return br(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return br(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return br(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id;return br(`${this.type}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const i=this._scopeCache;let n=i.get(e);return n&&!t||(n=new Map,i.set(e,n)),n}getOptionScopes(t,e,i){const{options:n,type:r}=this,o=this._cachedScopes(t,i),s=o.get(e);if(s)return s;const a=new Set;e.forEach(e=>{t&&(a.add(t),e.forEach(e=>_r(a,t,e))),e.forEach(e=>_r(a,n,e)),e.forEach(e=>_r(a,yt[r]||{},e)),e.forEach(e=>_r(a,D,e)),e.forEach(e=>_r(a,bt,e))});const l=Array.from(a);return 0===l.length&&l.push(Object.create(null)),yr.has(e)&&o.set(e,l),l}chartOptionScopes(){const{options:e,type:t}=this;return[e,yt[t]||{},D.datasets[t]||{},{type:t},D,bt]}resolveNamedOptions(e,t,i,n=[""]){const r={$shared:!0},{resolver:o,subPrefixes:s}=Cr(this._resolverCache,e,n);let a=o;if(function(n,r){const{isScriptable:o,isIndexable:s}=ei(n);for(const i of r){const r=o(i),e=s(i),t=(e||r)&&n[i];if(r&&(l(t)||xr(t))||e&&M(t))return!0}return!1}(o,t)){r.$shared=!1;a=Jt(o,i=l(i)?i():i,this.createResolver(e,i,s))}for(const e of t)r[e]=a[e];return r}createResolver(e,t,i=[""],n){const{resolver:r}=Cr(this._resolverCache,e,i);return k(t)?Jt(r,t,void 0,n):r}}function Cr(e,t,i){let n=e.get(t);n||(n=new Map,e.set(t,n));const r=i.join();let o=n.get(r);if(!o){o={resolver:Qt(t,i),subPrefixes:i.filter(e=>!e.toLowerCase().includes("hover"))},n.set(r,o)}return o}const xr=i=>k(i)&&Object.getOwnPropertyNames(i).reduce((e,t)=>e||l(i[t]),!1);const Sr=["top","bottom","left","right","chartArea"];function Ar(e,t){return"top"===e||"bottom"===e||-1===Sr.indexOf(e)&&"x"===t}function Er(i,n){return function(e,t){return e[i]===t[i]?e[n]-t[n]:e[i]-t[i]}}function Tr(e){const t=e.chart,i=t.options.animation;t.notifyPlugins("afterRender"),f(i&&i.onComplete,[e],t)}function Dr(e){const t=e.chart,i=t.options.animation;f(i&&i.onProgress,[e],t)}function Rr(e){return xt()&&"string"==typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const Mr={},kr=e=>{const t=Rr(e);return Object.values(Mr).filter(e=>e.canvas===t).pop()};function Or(i,n,r){const o=Object.keys(i);for(const t of o){const o=+t;if(o>=n){const e=i[t];delete i[t],(r>0||o>n)&&(i[o+r]=e)}}}class i{static defaults=D;static instances=Mr;static overrides=yt;static registry=h;static version="4.3.0";static getChart=kr;static register(...e){h.add(...e),Nr()}static unregister(...e){h.remove(...e),Nr()}constructor(e,t){const i=this.config=new wr(t),n=Rr(e),r=kr(n);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const o=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||kn(n)),this.platform.updateConfig(i);const s=this.platform.acquireContext(n,o.aspectRatio),a=s&&s.canvas,l=a&&a.height,c=a&&a.width;this.id=G(),this.ctx=s,this.canvas=a,this.width=c,this.height=l,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new ar,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Ee(e=>this.update(e),o.resizeDelay||0),this._dataChanges=[],Mr[this.id]=this,s&&a?(u.listen(this,"complete",Tr),u.listen(this,"progress",Dr),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:i,height:n,_aspectRatio:r}=this;return T(e)?t&&r?r:n?i/n:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return h}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():It(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Bt(this.canvas,this.ctx),this}stop(){return u.stop(this),this}resize(e,t){u.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const i=this.options,n=this.canvas,r=i.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(n,e,t,r),s=i.devicePixelRatio||this.platform.getDevicePixelRatio(),a=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,It(this,s,!0)&&(this.notifyPlugins("resize",{size:o}),f(i.onResize,[this,o],this),this.attached&&this._doResize(a)&&this.render())}ensureScalesHaveIDs(){S(this.options.scales||{},(e,t)=>{e.id=t})}buildOrUpdateScales(){const s=this.options,o=s.scales,a=this.scales,l=Object.keys(a).reduce((e,t)=>(e[t]=!1,e),{});let e=[];o&&(e=e.concat(Object.keys(o).map(e=>{const t=o[e],i=hr(e,t),n="r"===i,r="x"===i;return{options:t,dposition:n?"chartArea":r?"bottom":"left",dtype:n?"radialLinear":r?"category":"linear"}}))),S(e,e=>{const t=e.options,i=t.id,n=hr(i,t),r=O(t.type,e.dtype);void 0!==t.position&&Ar(t.position,n)===Ar(e.dposition)||(t.position=e.dposition),l[i]=!0;let o=null;if(i in a&&a[i].type===r)o=a[i];else{o=new(h.getScale(r))({id:i,type:r,ctx:this.ctx,chart:this}),a[o.id]=o}o.init(t,s)}),S(l,(e,t)=>{e||delete a[t]}),S(a,e=>{r.configure(this,e,e.options),r.addBox(this,e)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,i=e.length;if(e.sort((e,t)=>e.index-t.index),i>t){for(let e=t;e<i;++e)this._destroyDatasetMeta(e);e.splice(t,i-t)}this._sortedMetasets=e.slice(0).sort(Er("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:i}}=this;e.length>i.length&&delete this._stacks,e.forEach((t,e)=>{0===i.filter(e=>e===t._dataset).length&&this._destroyDatasetMeta(e)})}buildOrUpdateControllers(){const n=[],r=this.data.datasets;let o,s;for(this._removeUnreferencedMetasets(),o=0,s=r.length;o<s;o++){const s=r[o];let t=this.getDatasetMeta(o);const i=s.type||this.config.type;if(t.type&&t.type!==i&&(this._destroyDatasetMeta(o),t=this.getDatasetMeta(o)),t.type=i,t.indexAxis=s.indexAxis||ur(i,this.options),t.order=s.order||0,t.index=o,t.label=""+s.label,t.visible=this.isDatasetVisible(o),t.controller)t.controller.updateIndex(o),t.controller.linkScales();else{const r=h.getController(i),{datasetElementType:s,dataElementType:e}=D.datasets[i];Object.assign(r,{dataElementType:h.getElement(e),datasetElementType:s&&h.getElement(s)}),t.controller=new r(this,o),n.push(t.controller)}}return this._updateMetasets(),n}_resetElements(){S(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const i=this.config;i.update();const n=this._options=i.createResolver(i.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let s=0;for(let e=0,t=this.data.datasets.length;e<t;e++){const{controller:i}=this.getDatasetMeta(e),n=!r&&-1===o.indexOf(i);i.buildOrUpdateElements(n),s=Math.max(+i.getMaxOverflow(),s)}s=this._minPadding=n.layout.autoPadding?s:0,this._updateLayout(s),r||S(o,e=>{e.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Er("z","_idx"));const{_active:t,_lastEvent:a}=this;a?this._eventHandler(a,!0):t.length&&this._updateHoverStyles(t,t,!0),this.render()}_updateScales(){S(this.scales,e=>{r.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),i=new Set(e.events);Z(t,i)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:n}=this,r=this._getUniformDataChanges()||[];for(const{method:e,start:t,count:i}of r){Or(n,t,"_removeElements"===e?-i:i)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,i=t=>new Set(e.filter(e=>e[0]===t).map((e,t)=>t+","+e.splice(1).join(","))),n=i(0);for(let e=1;e<t;e++)if(!Z(n,i(e)))return;return Array.from(n).map(e=>e.split(",")).map(e=>({method:e[1],start:+e[2],count:+e[3]}))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;r.update(this,this.width,this.height,e);const t=this.chartArea,i=t.width<=0||t.height<=0;this._layers=[],S(this.boxes,e=>{i&&"chartArea"===e.position||(e.configure&&e.configure(),this._layers.push(...e._layers()))},this),this._layers.forEach((e,t)=>{e._idx=t}),this.notifyPlugins("afterLayout")}_updateDatasets(i){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:i,cancelable:!0})){for(let e=0,t=this.data.datasets.length;e<t;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,t=this.data.datasets.length;e<t;++e)this._updateDataset(e,l(i)?i({datasetIndex:e}):i);this.notifyPlugins("afterDatasetsUpdate",{mode:i})}}_updateDataset(e,t){const i=this.getDatasetMeta(e),n={meta:i,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",n)&&(i.controller._update(t),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(u.has(this)?this.attached&&!u.running(this)&&u.start(this):(this.draw(),Tr({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:e,height:t}=this._resizeBeforeDraw;this._resize(e,t),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,i=[];let n,r;for(n=0,r=t.length;n<r;++n){const r=t[n];e&&!r.visible||i.push(r)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,i=e._clip,n=!i.disabled,r=function(e){const{xScale:t,yScale:i}=e;if(t&&i)return{left:t.left,right:t.right,top:i.top,bottom:i.bottom}}(e)||this.chartArea,o={meta:e,index:e.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",o)&&(n&&zt(t,{left:!1===i.left?0:r.left-i.left,right:!1===i.right?this.width:r.right+i.right,top:!1===i.top?0:r.top-i.top,bottom:!1===i.bottom?this.height:r.bottom+i.bottom}),e.controller.draw(),n&&Wt(t),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(e){return d(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,i,n){const r=en.modes[t];return"function"==typeof r?r(this,e,i,n):[]}getDatasetMeta(e){const t=this.data.datasets[e],i=this._metasets;let n=i.filter(e=>e&&e._dataset===t).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},i.push(n)),n}getContext(){return this.$context||(this.$context=Li(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const i=this.getDatasetMeta(e);return"boolean"==typeof i.hidden?!i.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(t,e,i){const n=i?"show":"hide",r=this.getDatasetMeta(t),o=r.controller._resolveAnimations(void 0,n);X(e)?(r.data[e].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),o.update(r,{visible:i}),this.update(e=>e.datasetIndex===t?n:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),u.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Bt(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Mr[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const i=this._listeners,n=this.platform,t=(e,t)=>{n.addEventListener(this,e,t),i[e]=t},r=(e,t,i)=>{e.offsetX=t,e.offsetY=i,this._eventHandler(e)};S(this.options.events,e=>t(e,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const i=this._responsiveListeners,n=this.platform,e=(e,t)=>{n.addEventListener(this,e,t),i[e]=t},t=(e,t)=>{i[e]&&(n.removeEventListener(this,e,t),delete i[e])},r=(e,t)=>{this.canvas&&this.resize(e,t)};let o;const s=()=>{t("attach",s),this.attached=!0,this.resize(),e("resize",r),e("detach",o)};o=()=>{this.attached=!1,t("resize",r),this._stop(),this._resize(0,0),e("attach",s)},n.isAttached(this.canvas)?s():o()}unbindEvents(){S(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},S(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,i){const n=i?"set":"remove";let r,o,s,a;for("dataset"===t&&(r=this.getDatasetMeta(e[0].datasetIndex),r.controller["_"+n+"DatasetHoverStyle"]()),s=0,a=e.length;s<a;++s){o=e[s];const t=o&&this.getDatasetMeta(o.datasetIndex).controller;t&&t[n+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],i=e.map(({datasetIndex:e,index:t})=>{const i=this.getDatasetMeta(e);if(!i)throw new Error("No dataset found at index "+e);return{datasetIndex:e,element:i.data[t],index:t}});!B(i,t)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,t))}notifyPlugins(e,t,i){return this._plugins.notify(this,e,t,i)}isPluginEnabled(t){return 1===this._plugins._cache.filter(e=>e.plugin.id===t).length}_updateHoverStyles(e,t,i){const n=this.options.hover,r=(e,i)=>e.filter(t=>!i.some(e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)),o=r(t,e),s=i?e:r(e,t);o.length&&this.updateHoverStyle(o,n.mode,!1),s.length&&n.mode&&this.updateHoverStyle(s,n.mode,!0)}_eventHandler(t,e){const i={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},n=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",i,n))return;const r=this._handleEvent(t,e,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,n),(r||i.changed)&&this.render(),this}_handleEvent(e,t,i){const{_active:n=[],options:r}=this,o=t,s=this._getActiveElements(e,n,i,o),a=Q(e),l=function(e,t,i,n){return i&&"mouseout"!==e.type?n?t:e:null}(e,this._lastEvent,i,a);i&&(this._lastEvent=null,f(r.onHover,[e,s,this],this),a&&f(r.onClick,[e,s,this],this));const c=!B(s,n);return(c||t)&&(this._active=s,this._updateHoverStyles(s,n,t)),this._lastEvent=l,c}_getActiveElements(e,t,i,n){if("mouseout"===e.type)return[];if(!i)return t;const r=this.options.hover;return this.getElementsAtEventForMode(e,r.mode,r,n)}}function Nr(){return S(i.instances,e=>e._plugins.invalidate())}function Ir(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Lr{static override(e){Object.assign(Lr.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Ir()}parse(){return Ir()}format(){return Ir()}add(){return Ir()}diff(){return Ir()}startOf(){return Ir()}endOf(){return Ir()}}var Pr={_date:Lr};function Fr(e){const t=e.iScale,i=function(r,e){if(!r._cache.$bar){const i=r.getMatchingVisibleMetas(e);let n=[];for(let e=0,t=i.length;e<t;e++)n=n.concat(i[e].controller.getAllParsedValues(r));r._cache.$bar=xe(n.sort((e,t)=>e-t))}return r._cache.$bar}(t,e.type);let n,r,o,s,a=t._length;const l=()=>{32767!==o&&-32768!==o&&(X(s)&&(a=Math.min(a,Math.abs(o-s)||a)),s=o)};for(n=0,r=i.length;n<r;++n)o=t.getPixelForValue(i[n]),l();for(s=void 0,n=0,r=t.ticks.length;n<r;++n)o=t.getPixelForTick(n),l();return a}function Gr(e,t,i,n){return M(e)?function(e,t,i,n){const r=i.parse(e[0],n),o=i.parse(e[1],n),s=Math.min(r,o),a=Math.max(r,o);let l=s,c=a;Math.abs(s)>Math.abs(a)&&(l=a,c=s),t[i.axis]=c,t._custom={barStart:l,barEnd:c,start:r,end:o,min:s,max:a}}(e,t,i,n):t[i.axis]=i.parse(e,n),t}function $r(e,t,i,n){const r=e.iScale,o=e.vScale,s=r.getLabels(),a=r===o,l=[];let c,u,d,h;for(c=i,u=i+n;c<u;++c)h=t[c],d={},d[r.axis]=a||r.parse(s[c],c),l.push(Gr(h,d,o,c));return l}function Hr(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function Br(e,t,i,n){let r=t.borderSkipped;const o={};if(!r)return void(e.borderSkipped=o);if(!0===r)return void(e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:s,end:a,reverse:l,top:c,bottom:u}=function(e){let t,i,n,r,o;return e.horizontal?(t=e.base>e.x,i="left",n="right"):(t=e.base<e.y,i="bottom",n="top"),t?(r="end",o="start"):(r="start",o="end"),{start:i,end:n,reverse:t,top:r,bottom:o}}(e);"middle"===r&&i&&(e.enableBorderRadius=!0,(i._top||0)===n?r=c:(i._bottom||0)===n?r=u:(o[Vr(u,s,a,l)]=!0,r=c)),o[Vr(r,s,a,l)]=!0,e.borderSkipped=o}function Vr(e,t,i,n){var r,o,s;return n?(s=i,e=jr(e=(r=e)===(o=t)?s:r===s?o:r,i,t)):e=jr(e,t,i),e}function jr(e,t,i){return"start"===e?t:"end"===e?i:e}function zr(e,{inflateAmount:t},i){e.inflateAmount="auto"===t?1===i?.33:0:t}class Wr extends qn{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(o){const e=o.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n,color:r}}=o.legend.options;return e.labels.map((e,t)=>{const i=o.getDatasetMeta(0).controller.getStyle(t);return{text:e,fillStyle:i.backgroundColor,strokeStyle:i.borderColor,fontColor:r,lineWidth:i.borderWidth,pointStyle:n,hidden:!o.getDataVisibility(t),index:t}})}return[]}},onClick(e,t,i){i.chart.toggleDataVisibility(t.index),i.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(n,r){const o=this.getDataset().data,s=this._cachedMeta;if(!1===this._parsing)s._parsed=o;else{let e,t,i=e=>+o[e];if(k(o[n])){const{key:n="value"}=this._parsing;i=e=>+m(o[e],n)}for(e=n,t=n+r;e<t;++e)s._parsed[e]=i(e)}}_getRotation(){return L(this.options.rotation-90)}_getCircumference(){return L(this.options.circumference)}_getRotationExtents(){let r=_,o=-_;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const e=this.chart.getDatasetMeta(n).controller,t=e._getRotation(),i=e._getCircumference();r=Math.min(r,t),o=Math.max(o,t+i)}return{rotation:r,circumference:o-r}}update(e){const t=this.chart,{chartArea:i}=t,n=this._cachedMeta,r=n.data,o=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,s=Math.max((Math.min(i.width,i.height)-o)/2,0),a=Math.min($(this.options.cutout,s),1),l=this._getRingWeight(this.index),{circumference:c,rotation:u}=this._getRotationExtents(),{ratioX:d,ratioY:h,offsetX:f,offsetY:p}=function(h,f,p){let g=1,m=1,v=0,y=0;if(f<_){const n=h,r=n+f,e=Math.cos(n),t=Math.sin(n),i=Math.cos(r),o=Math.sin(r),s=(e,t,i)=>ge(e,n,r,!0)?1:Math.max(t,t*p,i,i*p),a=(e,t,i)=>ge(e,n,r,!0)?-1:Math.min(t,t*p,i,i*p),l=s(0,e,i),c=s(I,t,o),u=a(N,e,i),d=a(N+I,t,o);g=(l-u)/2,m=(c-d)/2,v=-(l+u)/2,y=-(c+d)/2}return{ratioX:g,ratioY:m,offsetX:v,offsetY:y}}(u,c,a),g=(i.width-o)/d,m=(i.height-o)/h,v=Math.max(Math.min(g,m)/2,0),y=H(this.options.radius,v),b=(y-Math.max(y*a,0))/this._getVisibleDatasetWeightTotal();this.offsetX=f*y,this.offsetY=p*y,n.total=this.calculateTotal(),this.outerRadius=y-b*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-b*l,0),this.updateElements(r,0,r.length,e)}_circumference(e,t){const i=this.options,n=this._cachedMeta,r=this._getCircumference();return t&&i.animation.animateRotate||!this.chart.getDataVisibility(e)||null===n._parsed[e]||n.data[e].hidden?0:this.calculateCircumference(n._parsed[e]*r/_)}updateElements(e,t,i,n){const r="reset"===n,o=this.chart,s=o.chartArea,a=o.options.animation,l=(s.left+s.right)/2,c=(s.top+s.bottom)/2,u=r&&a.animateScale,d=u?0:this.innerRadius,h=u?0:this.outerRadius,{sharedOptions:f,includeOptions:p}=this._getSharedOptions(t,n);let g,m=this._getRotation();for(g=0;g<t;++g)m+=this._circumference(g,r);for(g=t;g<t+i;++g){const t=this._circumference(g,r),i=e[g],o={x:l+this.offsetX,y:c+this.offsetY,startAngle:m,endAngle:m+t,circumference:t,outerRadius:h,innerRadius:d};p&&(o.options=f||this.resolveDataElementOptions(g,i.active?"active":n)),m+=t,this.updateElement(i,g,o,n)}}calculateTotal(){const t=this._cachedMeta,i=t.data;let n,r=0;for(n=0;n<i.length;n++){const e=t._parsed[n];null===e||isNaN(e)||!this.chart.getDataVisibility(n)||i[n].hidden||(r+=Math.abs(e))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?_*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,n=i.data.labels||[],r=gt(t._parsed[e],i.options.locale);return{label:n[e]||"",value:r}}getMaxBorderWidth(e){let t=0;const i=this.chart;let n,r,o,s,a;if(!e)for(n=0,r=i.data.datasets.length;n<r;++n)if(i.isDatasetVisible(n)){o=i.getDatasetMeta(n),e=o.data,s=o.controller;break}if(!e)return 0;for(n=0,r=e.length;n<r;++n)a=s.resolveDataElementOptions(n),"inner"!==a.borderAlign&&(t=Math.max(t,a.borderWidth||0,a.hoverBorderWidth||0));return t}getMaxOffset(i){let n=0;for(let e=0,t=i.length;e<t;++e){const i=this.resolveDataElementOptions(e);n=Math.max(n,i.offset||0,i.hoverOffset||0)}return n}_getRingWeightOffset(t){let i=0;for(let e=0;e<t;++e)this.chart.isDatasetVisible(e)&&(i+=this._getRingWeight(e));return i}_getRingWeight(e){return Math.max(O(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class Ur extends qn{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(o){const e=o.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n,color:r}}=o.legend.options;return e.labels.map((e,t)=>{const i=o.getDatasetMeta(0).controller.getStyle(t);return{text:e,fillStyle:i.backgroundColor,strokeStyle:i.borderColor,fontColor:r,lineWidth:i.borderWidth,pointStyle:n,hidden:!o.getDataVisibility(t),index:t}})}return[]}},onClick(e,t,i){i.chart.toggleDataVisibility(t.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,n=i.data.labels||[],r=gt(t._parsed[e].r,i.options.locale);return{label:n[e]||"",value:r}}parseObjectData(e,t,i,n){return di.bind(this)(e,t,i,n)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((e,t)=>{const i=this.getParsed(t).r;!isNaN(i)&&this.chart.getDataVisibility(t)&&(i<n.min&&(n.min=i),i>n.max&&(n.max=i))}),n}_updateRadius(){const e=this.chart,t=e.chartArea,i=e.options,n=Math.min(t.right-t.left,t.bottom-t.top),r=Math.max(n/2,0),o=(r-Math.max(i.cutoutPercentage?r/100*i.cutoutPercentage:1,0))/e.getVisibleDatasetCount();this.outerRadius=r-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(r,o,e,s){const a="reset"===s,l=this.chart,c=l.options.animation,u=this._cachedMeta.rScale,d=u.xCenter,h=u.yCenter,f=u.getIndexAngle(0)-.5*N;let p,g=f;const m=360/this.countVisibleElements();for(p=0;p<o;++p)g+=this._computeAngle(p,s,m);for(p=o;p<o+e;p++){const o=r[p];let e=g,t=g+this._computeAngle(p,s,m),i=l.getDataVisibility(p)?u.getDistanceFromCenterForValue(this.getParsed(p).r):0;g=t,a&&(c.animateScale&&(i=0),c.animateRotate&&(e=t=f));const n={x:d,y:h,innerRadius:0,outerRadius:i,startAngle:e,endAngle:t,options:this.resolveDataElementOptions(p,o.active?"active":s)};this.updateElement(o,p,n,s)}}countVisibleElements(){const e=this._cachedMeta;let i=0;return e.data.forEach((e,t)=>{!isNaN(this.getParsed(t).r)&&this.chart.getDataVisibility(t)&&i++}),i}_computeAngle(e,t,i){return this.chart.getDataVisibility(e)?L(this.resolveDataElementOptions(e,t).angle||i):0}}var Yr=Object.freeze({__proto__:null,BarController:class extends qn{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,i,n){return $r(e,t,i,n)}parseArrayData(e,t,i,n){return $r(e,t,i,n)}parseObjectData(e,t,i,n){const{iScale:r,vScale:o}=e,{xAxisKey:s="x",yAxisKey:a="y"}=this._parsing,l="x"===r.axis?s:a,c="x"===o.axis?s:a,u=[];let d,h,f,p;for(d=i,h=i+n;d<h;++d)p=t[d],f={},f[r.axis]=r.parse(m(p,l),d),u.push(Gr(m(p,c),f,o,d));return u}updateRangeFromParsed(e,t,i,n){super.updateRangeFromParsed(e,t,i,n);const r=i._custom;r&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,r.min),e.max=Math.max(e.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:i,vScale:n}=t,r=this.getParsed(e),o=r._custom,s=Hr(o)?"["+o.start+", "+o.end+"]":""+n.getLabelForValue(r[n.axis]);return{label:""+i.getLabelForValue(r[i.axis]),value:s}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(o,s,a,l){const c="reset"===l,{index:u,_cachedMeta:{vScale:d}}=this,h=d.getBasePixel(),f=d.isHorizontal(),p=this._getRuler(),{sharedOptions:g,includeOptions:m}=this._getSharedOptions(s,l);for(let r=s;r<s+a;r++){const s=this.getParsed(r),a=c||T(s[d.axis])?{base:h,head:h}:this._calculateBarValuePixels(r),e=this._calculateBarIndexPixels(r,p),t=(s._stacks||{})[d.axis],i={horizontal:f,base:a.base,enableBorderRadius:!t||Hr(s._custom)||u===t._top||u===t._bottom,x:f?a.head:e.center,y:f?e.center:a.head,height:f?e.size:Math.abs(a.size),width:f?Math.abs(a.size):e.size};m&&(i.options=g||this.resolveDataElementOptions(r,o[r].active?"active":l));const n=i.options||o[r].options;Br(i,n,t,u),zr(i,n,p.ratio),this.updateElement(o[r],r,i,l)}}_getStacks(e,n){const{iScale:t}=this._cachedMeta,i=t.getMatchingVisibleMetas(this._type).filter(e=>e.controller.options.grouped),r=t.options.stacked,o=[],s=e=>{const t=e.controller.getParsed(n),i=t&&t[e.vScale.axis];if(T(i)||isNaN(i))return!0};for(const t of i)if((void 0===n||!s(t))&&((!1===r||-1===o.indexOf(t.stack)||void 0===r&&void 0===t.stack)&&o.push(t.stack),t.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,i){const n=this._getStacks(e,i),r=void 0!==t?n.indexOf(t):-1;return-1===r?n.length-1:r}_getRuler(){const e=this.options,t=this._cachedMeta,i=t.iScale,n=[];let r,o;for(r=0,o=t.data.length;r<o;++r)n.push(i.getPixelForValue(this.getParsed(r)[i.axis],r));const s=e.barThickness;return{min:s||Fr(t),pixels:n,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:e.grouped,ratio:s?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:i,index:n},options:{base:r,minBarLength:o}}=this,s=r||0,a=this.getParsed(e),l=a._custom,c=Hr(l);let u,d,h=a[t.axis],f=0,p=i?this.applyStack(t,a,i):h;p!==h&&(f=p-h,p=h),c&&(h=l.barStart,p=l.barEnd-l.barStart,0!==h&&v(h)!==v(l.barEnd)&&(f=0),f+=h);const g=T(r)||c?f:r;let m=t.getPixelForValue(g);if(u=this.chart.getDataVisibility(e)?t.getPixelForValue(f+p):m,d=u-m,Math.abs(d)<o){d=function(e,t,i){return 0!==e?v(e):(t.isHorizontal()?1:-1)*(t.min>=i?1:-1)}(d,t,s)*o,h===s&&(m-=d/2);const e=t.getPixelForDecimal(0),T=t.getPixelForDecimal(1),r=Math.min(e,T),l=Math.max(e,T);m=Math.max(Math.min(m,l),r),u=m+d,i&&!c&&(a._stacks[t.axis]._visualValues[n]=t.getValueForPixel(u)-t.getValueForPixel(m))}if(m===t.getPixelForValue(s)){const e=v(d)*t.getLineWidthForValue(s)/2;m+=e,d-=e}return{size:d,base:m,head:u,center:u+d/2}}_calculateBarIndexPixels(t,i){const n=i.scale,r=this.options,o=r.skipNull,s=O(r.maxBarThickness,1/0);let a,l;if(i.grouped){const n=o?this._getStackCount(t):i.stackCount,O="flex"===r.barThickness?function(e,t,i,n){const r=t.pixels,o=r[e];let s=e>0?r[e-1]:null,a=e<r.length-1?r[e+1]:null;const l=i.categoryPercentage;null===s&&(s=o-(null===a?t.end-t.start:a-o)),null===a&&(a=o+o-s);const c=o-(o-Math.min(s,a))/2*l;return{chunk:Math.abs(a-s)/2*l/n,ratio:i.barPercentage,start:c}}(t,i,r,n):function(e,t,i,n){const r=i.barThickness;let o,s;return T(r)?(o=t.min*i.categoryPercentage,s=i.barPercentage):(o=r*n,s=1),{chunk:o/n,ratio:s,start:t.pixels[e]-o/2}}(t,i,r,n),e=this._getStackIndex(this.index,this._cachedMeta.stack,o?t:void 0);a=O.start+O.chunk*e+O.chunk/2,l=Math.min(s,O.chunk*O.ratio)}else a=n.getPixelForValue(this.getParsed(t)[n.axis],t),l=Math.min(s,i.min*i.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,t=e.vScale,i=e.data,n=i.length;let r=0;for(;r<n;++r)null!==this.getParsed(r)[t.axis]&&i[r].draw(this._ctx)}},BubbleController:class extends qn{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,i,n){const r=super.parsePrimitiveData(e,t,i,n);for(let e=0;e<r.length;e++)r[e]._custom=this.resolveDataElementOptions(e+i).radius;return r}parseArrayData(e,t,i,n){const r=super.parseArrayData(e,t,i,n);for(let e=0;e<r.length;e++){const n=t[i+e];r[e]._custom=O(n[2],this.resolveDataElementOptions(e+i).radius)}return r}parseObjectData(e,t,i,n){const r=super.parseObjectData(e,t,i,n);for(let e=0;e<r.length;e++){const n=t[i+e];r[e]._custom=O(n&&n.r&&+n.r,this.resolveDataElementOptions(e+i).radius)}return r}getMaxOverflow(){const t=this._cachedMeta.data;let i=0;for(let e=t.length-1;e>=0;--e)i=Math.max(i,t[e].size(this.resolveDataElementOptions(e))/2);return i>0&&i}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart.data.labels||[],{xScale:n,yScale:r}=t,o=this.getParsed(e),s=n.getLabelForValue(o.x),a=r.getLabelForValue(o.y),l=o._custom;return{label:i[e]||"",value:"("+s+", "+a+(l?", "+l:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(r,o,s,a){const l="reset"===a,{iScale:c,vScale:u}=this._cachedMeta,{sharedOptions:d,includeOptions:h}=this._getSharedOptions(o,a),f=c.axis,p=u.axis;for(let n=o;n<o+s;n++){const o=r[n],s=!l&&this.getParsed(n),e={},t=e[f]=l?c.getPixelForDecimal(.5):c.getPixelForValue(s[f]),i=e[p]=l?u.getBasePixel():u.getPixelForValue(s[p]);e.skip=isNaN(t)||isNaN(i),h&&(e.options=d||this.resolveDataElementOptions(n,o.active?"active":a),l&&(e.options.radius=0)),this.updateElement(o,n,e,a)}}resolveDataElementOptions(e,t){const i=this.getParsed(e);let n=super.resolveDataElementOptions(e,t);n.$shared&&(n=Object.assign({},n,{$shared:!1}));const r=n.radius;return"active"!==t&&(n.radius=0),n.radius+=O(i&&i._custom,r),n}},DoughnutController:Wr,LineController:class extends qn{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:i,data:n=[],_dataset:r}=t,o=this.chart._animationsDisabled;let{start:s,count:a}=Re(t,n,o);this._drawStart=s,this._drawCount=a,Me(t)&&(s=0,a=n.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!r._decimated,i.points=n;const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(i,void 0,{animated:!o,options:l},e),this.updateElements(n,s,a,e)}updateElements(o,s,e,a){const l="reset"===a,{iScale:c,vScale:u,_stacked:d,_dataset:h}=this._cachedMeta,{sharedOptions:f,includeOptions:p}=this._getSharedOptions(s,a),g=c.axis,m=u.axis,{spanGaps:v,segment:y}=this.options,b=ae(v)?v:Number.POSITIVE_INFINITY,_=this.chart._animationsDisabled||l||"none"===a,w=s+e,C=o.length;let x=s>0&&this.getParsed(s-1);for(let r=0;r<C;++r){const v=o[r],C=_?v:{};if(r<s||r>=w){C.skip=!0;continue}const e=this.getParsed(r),t=T(e[m]),i=C[g]=c.getPixelForValue(e[g],r),n=C[m]=l||t?u.getBasePixel():u.getPixelForValue(d?this.applyStack(u,e,d):e[m],r);C.skip=isNaN(i)||isNaN(n)||t,C.stop=r>0&&Math.abs(e[g]-x[g])>b,y&&(C.parsed=e,C.raw=h.data[r]),p&&(C.options=f||this.resolveDataElementOptions(r,v.active?"active":a)),_||this.updateElement(v,r,C,a),x=e}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,i=t.options&&t.options.borderWidth||0,n=e.data||[];if(!n.length)return i;const r=n[0].size(this.resolveDataElementOptions(0)),o=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(i,r,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}},PieController:class extends Wr{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}},PolarAreaController:Ur,RadarController:class extends qn{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(e){const t=this._cachedMeta.vScale,i=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(i[t.axis])}}parseObjectData(e,t,i,n){return di.bind(this)(e,t,i,n)}update(t){const i=this._cachedMeta,n=i.dataset,r=i.data||[],o=i.iScale.getLabels();if(n.points=r,"resize"!==t){const i=this.resolveDatasetElementOptions(t);this.options.showLine||(i.borderWidth=0);const e={_loop:!0,_fullLoop:o.length===r.length,options:i};this.updateElement(n,void 0,e,t)}this.updateElements(r,0,r.length,t)}updateElements(o,s,a,l){const c=this._cachedMeta.rScale,u="reset"===l;for(let r=s;r<s+a;r++){const s=o[r],a=this.resolveDataElementOptions(r,s.active?"active":l),e=c.getPointPositionForValue(r,this.getParsed(r).r),t=u?c.xCenter:e.x,i=u?c.yCenter:e.y,n={x:t,y:i,angle:e.angle,skip:isNaN(t)||isNaN(i),options:a};this.updateElement(s,r,n,l)}}},ScatterController:class extends qn{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(e){const t=this._cachedMeta,i=this.chart.data.labels||[],{xScale:n,yScale:r}=t,o=this.getParsed(e),s=n.getLabelForValue(o.x),a=r.getLabelForValue(o.y);return{label:i[e]||"",value:"("+s+", "+a+")"}}update(t){const i=this._cachedMeta,{data:n=[]}=i,r=this.chart._animationsDisabled;let{start:o,count:s}=Re(i,n,r);if(this._drawStart=o,this._drawCount=s,Me(i)&&(o=0,s=n.length),this.options.showLine){const{dataset:o,_dataset:s}=i;o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!s._decimated,o.points=n;const e=this.resolveDatasetElementOptions(t);e.segment=this.options.segment,this.updateElement(o,void 0,{animated:!r,options:e},t)}this.updateElements(n,o,s,t)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(r,o,s,a){const l="reset"===a,{iScale:c,vScale:u,_stacked:d,_dataset:h}=this._cachedMeta,e=this.resolveDataElementOptions(o,a),f=this.getSharedOptions(e),p=this.includeOptions(a,f),g=c.axis,m=u.axis,{spanGaps:v,segment:y}=this.options,b=ae(v)?v:Number.POSITIVE_INFINITY,_=this.chart._animationsDisabled||l||"none"===a;let w=o>0&&this.getParsed(o-1);for(let n=o;n<o+s;++n){const o=r[n],s=this.getParsed(n),v=_?o:{},e=T(s[m]),t=v[g]=c.getPixelForValue(s[g],n),i=v[m]=l||e?u.getBasePixel():u.getPixelForValue(d?this.applyStack(u,s,d):s[m],n);v.skip=isNaN(t)||isNaN(i)||e,v.stop=n>0&&Math.abs(s[g]-w[g])>b,y&&(v.parsed=s,v.raw=h.data[n]),p&&(v.options=f||this.resolveDataElementOptions(n,o.active?"active":a)),_||this.updateElement(o,n,v,a),w=s}this.updateSharedOptions(f,a,e)}getMaxOverflow(){const e=this._cachedMeta,i=e.data||[];if(!this.options.showLine){let t=0;for(let e=i.length-1;e>=0;--e)t=Math.max(t,i[e].size(this.resolveDataElementOptions(e))/2);return t>0&&t}const t=e.dataset,n=t.options&&t.options.borderWidth||0;if(!i.length)return n;const r=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,r,o)/2}}});function qr(e,t,i,n){const r=Mi(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const o=(i-t)/2,s=Math.min(o,n*t/2),a=e=>{const t=(i-Math.min(o,e))*n/2;return b(e,0,Math.min(o,t))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:b(r.innerStart,0,s),innerEnd:b(r.innerEnd,0,s)}}function Kr(e,t,i,n){return{x:i+e*Math.cos(t),y:n+e*Math.sin(t)}}function Xr(e,t,i,n,r,o){const{x:s,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=t,d=Math.max(t.outerRadius+n+i-c,0),h=u>0?u+n+i+c:0;let f=0;const p=r-l;if(n){const e=((u>0?u-n:0)+(d>0?d-n:0))/2;f=(p-(0!==e?p*e/(e+n):p))/2}const g=(p-Math.max(.001,p*d-i/N)/d)/2,m=l+g+f,v=r-g-f,{outerStart:y,outerEnd:b,innerStart:_,innerEnd:w}=qr(t,h,d,v-m),C=d-y,x=d-b,S=m+y/C,A=v-b/x,E=h+_,T=h+w,D=m+_/E,R=v-w/T;if(e.beginPath(),o){const t=(S+A)/2;if(e.arc(s,a,d,S,t),e.arc(s,a,d,t,A),b>0){const t=Kr(x,A,s,a);e.arc(t.x,t.y,b,A,v+I)}const i=Kr(T,v,s,a);if(e.lineTo(i.x,i.y),w>0){const t=Kr(T,R,s,a);e.arc(t.x,t.y,w,v+I,R+Math.PI)}const n=(v-w/h+(m+_/h))/2;if(e.arc(s,a,h,v-w/h,n,!0),e.arc(s,a,h,n,m+_/h,!0),_>0){const t=Kr(E,D,s,a);e.arc(t.x,t.y,_,D+Math.PI,m-I)}const r=Kr(C,m,s,a);if(e.lineTo(r.x,r.y),y>0){const t=Kr(C,S,s,a);e.arc(t.x,t.y,y,m-I,S)}}else{e.moveTo(s,a);const t=Math.cos(S)*d+s,i=Math.sin(S)*d+a;e.lineTo(t,i);const n=Math.cos(A)*d+s,r=Math.sin(A)*d+a;e.lineTo(n,r)}e.closePath()}function Zr(t,e,i,n,r){const{fullCircles:o,startAngle:s,circumference:a,options:l}=e,{borderWidth:c,borderJoinStyle:u,borderDash:d,borderDashOffset:h}=l,f="inner"===l.borderAlign;if(!c)return;t.setLineDash(d||[]),t.lineDashOffset=h,f?(t.lineWidth=2*c,t.lineJoin=u||"round"):(t.lineWidth=c,t.lineJoin=u||"bevel");let p=e.endAngle;if(o){Xr(t,e,i,n,p,r);for(let e=0;e<o;++e)t.stroke();isNaN(a)||(p=s+(a%_||_))}f&&function(e,t,i){const{startAngle:n,pixelMargin:r,x:o,y:s,outerRadius:a,innerRadius:l}=t;let c=r/a;e.beginPath(),e.arc(o,s,a,n-c,i+c),l>r?(c=r/l,e.arc(o,s,l,i+c,n-c,!0)):e.arc(o,s,r,i+I,n-I),e.closePath(),e.clip()}(t,e,p),o||(Xr(t,e,i,n,p,r),t.stroke())}function Qr(e,t,i=t){e.lineCap=O(i.borderCapStyle,t.borderCapStyle),e.setLineDash(O(i.borderDash,t.borderDash)),e.lineDashOffset=O(i.borderDashOffset,t.borderDashOffset),e.lineJoin=O(i.borderJoinStyle,t.borderJoinStyle),e.lineWidth=O(i.borderWidth,t.borderWidth),e.strokeStyle=O(i.borderColor,t.borderColor)}function Jr(e,t,i){e.lineTo(i.x,i.y)}function eo(e,t,i={}){const n=e.length,{start:r=0,end:o=n-1}=i,{start:s,end:a}=t,l=Math.max(r,s),c=Math.min(o,a),u=r<s&&o<s||r>a&&o>a;return{count:n,start:l,loop:t.loop,ilen:c<l&&!u?n+c-l:c-l}}function to(e,t,i,n){const{points:r,options:o}=t,{count:s,start:a,loop:l,ilen:c}=eo(r,i,n),u=function(e){return e.stepped?Ut:e.tension||"monotone"===e.cubicInterpolationMode?Yt:Jr}(o);let d,h,f,{move:p=!0,reverse:g}=n||{};for(d=0;d<=c;++d)h=r[(a+(g?c-d:d))%s],h.skip||(p?(e.moveTo(h.x,h.y),p=!1):u(e,f,h,g,o.stepped),f=h);return l&&(h=r[(a+(g?c:0))%s],u(e,f,h,g,o.stepped)),!!l}function io(e,t,i,n){const r=t.points,{count:o,start:s,ilen:a}=eo(r,i,n),{move:l=!0,reverse:c}=n||{};let u,d,h,f,p,g,m=0,v=0;const y=e=>(s+(c?a-e:e))%o,b=()=>{f!==p&&(e.lineTo(m,p),e.lineTo(m,f),e.lineTo(m,g))};for(l&&(d=r[y(0)],e.moveTo(d.x,d.y)),u=0;u<=a;++u){if(d=r[y(u)],d.skip)continue;const t=d.x,i=d.y,n=0|t;n===h?(i<f?f=i:i>p&&(p=i),m=(v*m+t)/++v):(b(),e.lineTo(t,i),h=n,v=0,f=p=i),g=i}b()}function no(e){const t=e.options,i=t.borderDash&&t.borderDash.length;return!(e._decimated||e._loop||t.tension||"monotone"===t.cubicInterpolationMode||t.stepped||i)?io:to}const ro="function"==typeof Path2D;function oo(e,t,i,n){ro&&!t.options.segment?function(e,t,i,n){let r=t._path;r||(r=t._path=new Path2D,t.path(r,i,n)&&r.closePath()),Qr(e,t.options),e.stroke(r)}(e,t,i,n):function(t,i,n,r){const{segments:o,options:s}=i,a=no(i);for(const e of o)Qr(t,s,e.style),t.beginPath(),a(t,i,e,{start:n,end:n+r-1})&&t.closePath(),t.stroke()}(e,t,i,n)}class so extends t{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(t,i){const n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){const e=n.spanGaps?this._loop:this._fullLoop;yi(this._points,n,t,e,i),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=ji(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,i=e.length;return i&&t[e[i-1].end]}interpolate(r,o){const s=this.options,a=r[o],l=this.points,c=Vi(this,{property:o,start:a,end:a});if(!c.length)return;const u=[],d=function(e){return e.stepped?Si:e.tension||"monotone"===e.cubicInterpolationMode?Ai:xi}(s);let h,f;for(h=0,f=c.length;h<f;++h){const{start:f,end:e}=c[h],t=l[f],i=l[e];if(t===i){u.push(t);continue}const n=d(t,i,Math.abs((a-t[o])/(i[o]-t[o])),s.stepped);n[o]=r[o],u.push(n)}return 1===u.length?u[0]:u}pathSegment(e,t,i){return no(this)(e,this,t,i)}path(t,i,n){const r=this.segments,o=no(this);let s=this._loop;i=i||0,n=n||this.points.length-i;for(const e of r)s&=o(t,this,e,{start:i,end:i+n-1});return!!s}draw(e,t,i,n){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(e.save(),oo(e,this,i,n),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function ao(e,t,i,n){const r=e.options,{[i]:o}=e.getProps([i],n);return Math.abs(t-o)<r.radius+r.hitRadius}function lo(e,t){const{x:i,y:n,base:r,width:o,height:s}=e.getProps(["x","y","base","width","height"],t);let a,l,c,u,d;return e.horizontal?(d=s/2,a=Math.min(i,r),l=Math.max(i,r),c=n-d,u=n+d):(d=o/2,a=i-d,l=i+d,c=Math.min(n,r),u=Math.max(n,r)),{left:a,top:c,right:l,bottom:u}}function co(e,t,i,n){return e?0:b(t,i,n)}function uo(e){const t=lo(e),i=t.right-t.left,n=t.bottom-t.top,r=function(e,t,i){const n=e.options.borderWidth,r=e.borderSkipped,o=ki(n);return{t:co(r.top,o.top,0,i),r:co(r.right,o.right,0,t),b:co(r.bottom,o.bottom,0,i),l:co(r.left,o.left,0,t)}}(e,i/2,n/2),o=function(e,t,i){const{enableBorderRadius:n}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,o=Oi(r),s=Math.min(t,i),a=e.borderSkipped,l=n||k(r);return{topLeft:co(!l||a.top||a.left,o.topLeft,0,s),topRight:co(!l||a.top||a.right,o.topRight,0,s),bottomLeft:co(!l||a.bottom||a.left,o.bottomLeft,0,s),bottomRight:co(!l||a.bottom||a.right,o.bottomRight,0,s)}}(e,i/2,n/2);return{outer:{x:t.left,y:t.top,w:i,h:n,radius:o},inner:{x:t.left+r.l,y:t.top+r.t,w:i-r.l-r.r,h:n-r.t-r.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,o.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(r.b,r.r))}}}}function ho(e,t,i,n){const r=null===t,o=null===i,s=e&&!(r&&o)&&lo(e,n);return s&&(r||w(t,s.left,s.right))&&(o||w(i,s.top,s.bottom))}function fo(e,t){e.rect(t.x,t.y,t.w,t.h)}function po(e,t,i={}){const n=e.x!==i.x?-t:0,r=e.y!==i.y?-t:0,o=(e.x+e.w!==i.x+i.w?t:0)-n,s=(e.y+e.h!==i.y+i.h?t:0)-r;return{x:e.x+n,y:e.y+r,w:e.w+o,h:e.h+s,radius:e.radius}}var go=Object.freeze({__proto__:null,ArcElement:class extends t{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,i){const n=this.getProps(["x","y"],i),{angle:r,distance:o}=he(n,{x:e,y:t}),{startAngle:s,endAngle:a,innerRadius:l,outerRadius:c,circumference:u}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),d=(this.options.spacing+this.options.borderWidth)/2,h=O(u,a-s)>=_||ge(r,s,a),f=w(o,l+d,c+d);return h&&f}getCenterPoint(e){const{x:t,y:i,startAngle:n,endAngle:r,innerRadius:o,outerRadius:s}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:a,spacing:l}=this.options,c=(n+r)/2,u=(o+s+l+a)/2;return{x:t+Math.cos(c)*u,y:i+Math.sin(c)*u}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:i}=this,n=(t.offset||0)/4,r=(t.spacing||0)/2,o=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=i>_?Math.floor(i/_):0,0===i||this.innerRadius<0||this.outerRadius<0)return;e.save();const s=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(s)*n,Math.sin(s)*n);const a=n*(1-Math.sin(Math.min(N,i||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(t,e,i,n,r){const{fullCircles:o,startAngle:s,circumference:a}=e;let l=e.endAngle;if(o){Xr(t,e,i,n,l,r);for(let e=0;e<o;++e)t.fill();isNaN(a)||(l=s+(a%_||_))}Xr(t,e,i,n,l,r),t.fill()}(e,this,a,r,o),Zr(e,this,a,r,o),e.restore()}},BarElement:class extends t{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:i,backgroundColor:n}}=this,{inner:r,outer:o}=uo(this),s=(a=o.radius).topLeft||a.topRight||a.bottomLeft||a.bottomRight?Zt:fo;var a;e.save(),o.w===r.w&&o.h===r.h||(e.beginPath(),s(e,po(o,t,r)),e.clip(),s(e,po(r,-t,o)),e.fillStyle=i,e.fill("evenodd")),e.beginPath(),s(e,po(r,t)),e.fillStyle=n,e.fill(),e.restore()}inRange(e,t,i){return ho(this,e,t,i)}inXRange(e,t){return ho(this,e,null,t)}inYRange(e,t){return ho(this,null,e,t)}getCenterPoint(e){const{x:t,y:i,base:n,horizontal:r}=this.getProps(["x","y","base","horizontal"],e);return{x:r?(t+n)/2:t,y:r?i:(i+n)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}},LineElement:so,PointElement:class extends t{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,i){const n=this.options,{x:r,y:o}=this.getProps(["x","y"],i);return Math.pow(e-r,2)+Math.pow(t-o,2)<Math.pow(n.hitRadius+n.radius,2)}inXRange(e,t){return ao(this,e,"x",t)}inYRange(e,t){return ao(this,e,"y",t)}getCenterPoint(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}size(e){let t=(e=e||this.options||{}).radius||0;t=Math.max(t,t&&e.hoverRadius||0);return 2*(t+(t&&e.borderWidth||0))}draw(e,t){const i=this.options;this.skip||i.radius<.1||!d(this,t,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,Vt(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}});function mo(e,t,i,n){const r=e.indexOf(t);if(-1===r)return((e,t,i,n)=>("string"==typeof t?(i=e.push(t)-1,n.unshift({index:i,label:t})):isNaN(t)&&(i=null),i))(e,t,i,n);return r!==e.lastIndexOf(t)?i:r}function vo(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}function yo(e,t,{horizontal:i,minRotation:n}){const r=L(n),o=(i?Math.sin(r):Math.cos(r))||.001,s=.75*t*(""+e).length;return Math.min(t/o,s)}class bo extends rr{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return T(e)||("number"==typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:i,maxDefined:n}=this.getUserBounds();let{min:r,max:o}=this;const s=e=>r=i?r:e,a=e=>o=n?o:e;if(t){const t=v(r),i=v(o);t<0&&i<0?a(0):t>0&&i>0&&s(0)}if(r===o){let e=0===o?1:Math.abs(.05*o);a(o+e),t||s(r-e)}this.min=r,this.max=o}getTickLimit(){const e=this.options.ticks;let t,{maxTicksLimit:i,stepSize:n}=e;return n?(t=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,t>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${t} ticks. Limiting to 1000.`),t=1e3)):(t=this.computeTickLimit(),i=i||11),i&&(t=Math.min(i,t)),t}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let i=this.getTickLimit();i=Math.max(2,i);const n=function(e,t){const i=[],{bounds:n,step:r,min:o,max:s,precision:a,count:l,maxTicks:c,maxDigits:u,includeBounds:d}=e,h=r||1,f=c-1,{min:p,max:g}=t,m=!T(o),v=!T(s),y=!T(l),b=(g-p)/(u+1);let _,w,C,x,S=oe((g-p)/f/h)*h;if(S<1e-14&&!m&&!v)return[{value:p},{value:g}];x=Math.ceil(g/S)-Math.floor(p/S),x>f&&(S=oe(x*S/f/h)*h),T(a)||(_=Math.pow(10,a),S=Math.ceil(S*_)/_),"ticks"===n?(w=Math.floor(p/S)*S,C=Math.ceil(g/S)*S):(w=p,C=g),m&&v&&r&&le((s-o)/r,S/1e3)?(x=Math.round(Math.min((s-o)/S,c)),S=(s-o)/x,w=o,C=s):y?(w=m?o:w,C=v?s:C,x=l-1,S=(C-w)/x):(x=(C-w)/S,x=re(x,Math.round(x),S/1e3)?Math.round(x):Math.ceil(x));const A=Math.max(de(S),de(w));_=Math.pow(10,T(a)?A:a),w=Math.round(w*_)/_,C=Math.round(C*_)/_;let E=0;for(m&&(d&&w!==o?(i.push({value:o}),w<o&&E++,re(Math.round((w+E*S)*_)/_,o,yo(o,b,e))&&E++):w<o&&E++);E<x;++E){const e=Math.round((w+E*S)*_)/_;if(v&&e>s)break;i.push({value:e})}return v&&d&&C!==s?i.length&&re(i[i.length-1].value,s,yo(s,b,e))?i[i.length-1].value=s:i.push({value:s}):v&&C!==s||i.push({value:C}),i}({maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&ce(n,this,"value"),e.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}configure(){const t=this.ticks;let i=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const e=(n-i)/Math.max(t.length-1,1)/2;i-=e,n+=e}this._startValue=i,this._endValue=n,this._valueRange=n-i}getLabelForValue(e){return gt(e,this.chart.options.locale,this.options.ticks.format)}}class _o extends bo{static id="linear";static defaults={ticks:{callback:vt.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=p(e)?e:0,this.max=p(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,i=L(this.options.ticks.minRotation),n=(e?Math.sin(i):Math.cos(i))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,r.lineHeight/n))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const wo=e=>Math.floor(c(e)),Co=(e,t)=>Math.pow(10,wo(e)+t);function xo(e){return 1===e/Math.pow(10,wo(e))}function So(e,t,i){const n=Math.pow(10,i),r=Math.floor(e/n);return Math.ceil(t/n)-r}function Ao(e,{min:t,max:i}){t=g(e.min,t);const n=[],r=wo(t);let o=function(e,t){let i=wo(t-e);for(;So(e,t,i)>10;)i++;for(;So(e,t,i)<10;)i--;return Math.min(i,wo(e))}(t,i),s=o<0?Math.pow(10,Math.abs(o)):1;const a=Math.pow(10,o),l=r>o?Math.pow(10,r):0,c=Math.round((t-l)*s)/s,u=Math.floor((t-l)/a/10)*a*10;let d=Math.floor((c-u)/Math.pow(10,o)),h=g(e.min,Math.round((l+u+d*Math.pow(10,o))*s)/s);for(;h<i;)n.push({value:h,major:xo(h),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(o++,d=2,s=o>=0?1:s),h=Math.round((l+u+d*Math.pow(10,o))*s)/s;const f=g(e.max,h);return n.push({value:f,major:xo(f),significand:d}),n}class Eo extends rr{static id="logarithmic";static defaults={ticks:{callback:vt.formatters.logarithmic,major:{enabled:!0}}};constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const i=bo.prototype.parse.apply(this,[e,t]);if(0!==i)return p(i)&&i>0?i:null;this._zero=!0}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=p(e)?Math.max(0,e):null,this.max=p(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!p(this._userMin)&&(this.min=e===Co(this.min,0)?Co(this.min,-1):Co(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:i}=this.getUserBounds();let n=this.min,r=this.max;const e=e=>n=t?n:e,o=e=>r=i?r:e;n===r&&(n<=0?(e(1),o(10)):(e(Co(n,-1)),o(Co(r,1)))),n<=0&&e(Co(r,-1)),r<=0&&o(Co(n,1)),this.min=n,this.max=r}buildTicks(){const e=this.options,t=Ao({min:this._userMin,max:this._userMax},this);return"ticks"===e.bounds&&ce(t,this,"value"),e.reverse?(t.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),t}getLabelForValue(e){return void 0===e?"0":gt(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=c(e),this._valueRange=c(this.max)-c(e)}getPixelForValue(e){return void 0!==e&&0!==e||(e=this.min),null===e||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(c(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}function To(e){const t=e.ticks;if(t.display&&e.display){const e=P(t.backdropPadding);return O(t.font&&t.font.size,D.font.size)+e.height}return 0}function Do(e,t,i,n,r){return e===n||e===r?{start:t-i/2,end:t+i/2}:e<n||e>r?{start:t-i,end:t}:{start:t,end:t+i}}function Ro(s){const a={l:s.left+s._padding.left,r:s.right-s._padding.right,t:s.top+s._padding.top,b:s.bottom-s._padding.bottom},l=Object.assign({},a),c=[],u=[],d=s._pointLabels.length,h=s.options.pointLabels,f=h.centerPointLabels?N/d:0;for(let o=0;o<d;o++){const d=h.setContext(s.getPointLabelContext(o));u[o]=d.padding;const e=s.getPointPosition(o,s.drawingArea+u[o],f),t=R(d.font),i=(p=s.ctx,g=t,m=M(m=s._pointLabels[o])?m:[m],{w:$t(p,g.string,m),h:m.length*g.lineHeight});c[o]=i;const n=y(s.getIndexAngle(o)+f),r=Math.round(ue(n));Mo(l,a,n,Do(r,e.x,i.w,0,180),Do(r,e.y,i.h,90,270))}var p,g,m;s.setCenterPoint(a.l-l.l,l.r-a.r,a.t-l.t,l.b-a.b),s._pointLabelItems=function(t,i,n){const r=[],o=t._pointLabels.length,e=t.options,{centerPointLabels:s,display:a}=e.pointLabels,l={extra:To(e)/2,additionalAngle:s?N/o:0};let c;for(let e=0;e<o;e++){l.padding=n[e],l.size=i[e];const o=ko(t,e,l);r.push(o),"auto"===a&&(o.visible=Oo(o,c),o.visible&&(c=o))}return r}(s,c,u)}function Mo(e,t,i,n,r){const o=Math.abs(Math.sin(i)),s=Math.abs(Math.cos(i));let a=0,l=0;n.start<t.l?(a=(t.l-n.start)/o,e.l=Math.min(e.l,t.l-a)):n.end>t.r&&(a=(n.end-t.r)/o,e.r=Math.max(e.r,t.r+a)),r.start<t.t?(l=(t.t-r.start)/s,e.t=Math.min(e.t,t.t-l)):r.end>t.b&&(l=(r.end-t.b)/s,e.b=Math.max(e.b,t.b+l))}function ko(e,t,i){const n=e.drawingArea,{extra:r,additionalAngle:o,padding:s,size:a}=i,l=e.getPointPosition(t,n+r+s,o),c=Math.round(ue(y(l.angle+I))),u=function(e,t,i){90===i||270===i?e-=t/2:(i>270||i<90)&&(e-=t);return e}(l.y,a.h,c),d=function(e){if(0===e||180===e)return"center";if(e<180)return"left";return"right"}(c),h=function(e,t,i){"right"===i?e-=t:"center"===i&&(e-=t/2);return e}(l.x,a.w,d);return{visible:!0,x:l.x,y:u,textAlign:d,left:h,top:u,right:h+a.w,bottom:u+a.h}}function Oo(e,t){if(!t)return!0;const{left:i,top:n,right:r,bottom:o}=e;return!(d({x:i,y:n},t)||d({x:i,y:o},t)||d({x:r,y:n},t)||d({x:r,y:o},t))}function No(r,o,s){const{left:a,top:l,right:c,bottom:u}=s,{backdropColor:d}=o;if(!T(d)){const s=Oi(o.borderRadius),T=P(o.backdropPadding);r.fillStyle=d;const e=a-T.left,t=l-T.top,i=c-a+T.width,n=u-l+T.height;Object.values(s).some(e=>0!==e)?(r.beginPath(),Zt(r,{x:e,y:t,w:i,h:n,radius:s}),r.fill()):r.fillRect(e,t,i,n)}}function Io(i,n,e,r){const{ctx:o}=i;if(e)o.arc(i.xCenter,i.yCenter,n,0,_);else{let t=i.getPointPosition(0,n);o.moveTo(t.x,t.y);for(let e=1;e<r;e++)t=i.getPointPosition(e,n),o.lineTo(t.x,t.y)}}class Lo extends bo{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:vt.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:e=>e,padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=P(To(this.options)/2),t=this.width=this.maxWidth-e.width,i=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+i/2+e.top),this.drawingArea=Math.floor(Math.min(t,i)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=p(e)&&!isNaN(e)?e:0,this.max=p(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/To(this.options))}generateTickLabels(e){bo.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((e,t)=>{const i=f(this.options.pointLabels.callback,[e,t],this);return i||0===i?i:""}).filter((e,t)=>this.chart.getDataVisibility(t))}fit(){const e=this.options;e.display&&e.pointLabels.display?Ro(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,i,n){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((i-n)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,i,n))}getIndexAngle(e){return y(e*(_/(this._pointLabels.length||1))+L(this.options.startAngle||0))}getDistanceFromCenterForValue(e){if(T(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(T(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(t){const i=this._pointLabels||[];if(t>=0&&t<i.length){const e=i[t];return function(e,t,i){return Li(e,{label:i,index:t,type:"pointLabel"})}(this.getContext(),t,e)}}getPointPosition(e,t,i=0){const n=this.getIndexAngle(e)-I+i;return{x:Math.cos(n)*t+this.xCenter,y:Math.sin(n)*t+this.yCenter,angle:n}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:i,right:n,bottom:r}=this._pointLabelItems[e];return{left:t,top:i,right:n,bottom:r}}drawBackground(){const{backgroundColor:t,grid:{circular:i}}=this.options;if(t){const e=this.ctx;e.save(),e.beginPath(),Io(this,this.getDistanceFromCenterForValue(this._endValue),i,this._pointLabels.length),e.closePath(),e.fillStyle=t,e.fill(),e.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:i,grid:o,border:s}=t,a=this._pointLabels.length;let n,l,r;if(t.pointLabels.display&&function(s,a){const{ctx:l,options:{pointLabels:c}}=s;for(let o=a-1;o>=0;o--){const a=s._pointLabelItems[o];if(!a.visible)continue;const e=c.setContext(s.getPointLabelContext(o));No(l,e,a);const t=R(e.font),{x:i,y:n,textAlign:r}=a;Xt(l,s._pointLabels[o],i,n+t.lineHeight/2,t,{color:e.color,textAlign:r,textBaseline:"middle"})}}(this,a),o.display&&this.ticks.forEach((n,r)=>{if(0!==r){l=this.getDistanceFromCenterForValue(n.value);const e=this.getContext(r),t=o.setContext(e),i=s.setContext(e);!function(e,t,i,n,r){const o=e.ctx,s=t.circular,{color:a,lineWidth:l}=t;!s&&!n||!a||!l||i<0||(o.save(),o.strokeStyle=a,o.lineWidth=l,o.setLineDash(r.dash),o.lineDashOffset=r.dashOffset,o.beginPath(),Io(e,i,s,n),o.closePath(),o.stroke(),o.restore())}(this,t,l,a,i)}}),i.display){for(e.save(),n=a-1;n>=0;n--){const o=i.setContext(this.getPointLabelContext(n)),{color:s,lineWidth:a}=o;a&&s&&(e.lineWidth=a,e.strokeStyle=s,e.setLineDash(o.borderDash),e.lineDashOffset=o.borderDashOffset,l=this.getDistanceFromCenterForValue(t.ticks.reverse?this.min:this.max),r=this.getPointPosition(n,l),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(r.x,r.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const r=this.ctx,o=this.options,s=o.ticks;if(!s.display)return;const e=this.getIndexAngle(0);let a,l;r.save(),r.translate(this.xCenter,this.yCenter),r.rotate(e),r.textAlign="center",r.textBaseline="middle",this.ticks.forEach((e,t)=>{if(0===t&&!o.reverse)return;const i=s.setContext(this.getContext(t)),n=R(i.font);if(a=this.getDistanceFromCenterForValue(this.ticks[t].value),i.showLabelBackdrop){r.font=n.string,l=r.measureText(e.label).width,r.fillStyle=i.backdropColor;const o=P(i.backdropPadding);r.fillRect(-l/2-o.left,-a-n.size/2-o.top,l+o.width,n.size+o.height)}Xt(r,e.label,0,-a,n,{color:i.color})}),r.restore()}drawTitle(){}}const Po={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},x=Object.keys(Po);function Fo(e,t){return e-t}function Go(e,t){if(T(t))return null;const i=e._adapter,{parser:n,round:r,isoWeekday:o}=e._parseOpts;let s=t;return"function"==typeof n&&(s=n(s)),p(s)||(s="string"==typeof n?i.parse(s,n):i.parse(s)),null===s?null:(r&&(s="week"!==r||!ae(o)&&!0!==o?i.startOf(s,r):i.startOf(s,"isoWeek",o)),+s)}function $o(t,i,n,r){const o=x.length;for(let e=x.indexOf(t);e<o-1;++e){const t=Po[x[e]],o=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((n-i)/(o*t.size))<=r)return x[e]}return x[o-1]}function Ho(i,n,r){if(r){if(r.length){const{lo:e,hi:t}=ve(r,n);i[r[e]>=n?r[e]:r[t]]=!0}}else i[n]=!0}function Bo(e,t,i){const n=[],r={},o=t.length;let s,a;for(s=0;s<o;++s)a=t[s],r[a]=s,n.push({value:a,major:!1});return 0!==o&&i?function(e,t,i,n){const r=e._adapter,o=+r.startOf(t[0].value,n),s=t[t.length-1].value;let a,l;for(a=o;a<=s;a=+r.add(a,1,n))l=i[a],l>=0&&(t[l].major=!0);return t}(e,n,r,i):n}class Vo extends rr{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const i=e.time||(e.time={}),n=this._adapter=new Pr._date(e.adapters.date);n.init(t),U(i.displayFormats,n.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:Go(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,i=e.time.unit||"day";let{min:n,max:r,minDefined:o,maxDefined:s}=this.getUserBounds();function a(e){o||isNaN(e.min)||(n=Math.min(n,e.min)),s||isNaN(e.max)||(r=Math.max(r,e.max))}o&&s||(a(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||a(this.getMinMax(!1))),n=p(n)&&!isNaN(n)?n:+t.startOf(Date.now(),i),r=p(r)&&!isNaN(r)?r:+t.endOf(Date.now(),i)+1,this.min=Math.min(n,r-1),this.max=Math.max(n+1,r)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],i=e[e.length-1]),{min:t,max:i}}buildTicks(){const e=this.options,t=e.time,i=e.ticks,n="labels"===i.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const r=this.min,o=be(n,r,this.max);return this._unit=t.unit||(i.autoSkip?$o(t.minUnit,this.min,this.max,this._getLabelCapacity(r)):function(t,i,n,r,o){for(let e=x.length-1;e>=x.indexOf(n);e--){const n=x[e];if(Po[n].common&&t._adapter.diff(o,r,n)>=i-1)return n}return x[n?x.indexOf(n):0]}(this,o.length,t.minUnit,this.min,this.max)),this._majorUnit=i.major.enabled&&"year"!==this._unit?function(i){for(let e=x.indexOf(i)+1,t=x.length;e<t;++e)if(Po[x[e]].common)return x[e]}(this._unit):void 0,this.initOffsets(n),e.reverse&&o.reverse(),Bo(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t,i,n=0,r=0;this.options.offset&&e.length&&(t=this.getDecimalForValue(e[0]),n=1===e.length?1-t:(this.getDecimalForValue(e[1])-t)/2,i=this.getDecimalForValue(e[e.length-1]),r=1===e.length?i:(i-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;n=b(n,0,o),r=b(r,0,o),this._offsets={start:n,end:r,factor:1/(n+1+r)}}_generate(){const e=this._adapter,t=this.min,i=this.max,n=this.options,r=n.time,o=r.unit||$o(r.minUnit,t,i,this._getLabelCapacity(t)),s=O(n.ticks.stepSize,1),a="week"===o&&r.isoWeekday,l=ae(a)||!0===a,c={};let u,d,h=t;if(l&&(h=+e.startOf(h,"isoWeek",a)),h=+e.startOf(h,l?"day":o),e.diff(i,t,o)>1e5*s)throw new Error(t+" and "+i+" are too far apart with stepSize of "+s+" "+o);const f="data"===n.ticks.source&&this.getDataTimestamps();for(u=h,d=0;u<i;u=+e.add(u,s,o),d++)Ho(c,u,f);return u!==i&&"ticks"!==n.bounds&&1!==d||Ho(c,u,f),Object.keys(c).sort((e,t)=>e-t).map(e=>+e)}getLabelForValue(e){const t=this._adapter,i=this.options.time;return i.tooltipFormat?t.format(e,i.tooltipFormat):t.format(e,i.displayFormats.datetime)}format(e,t){const i=this.options.time.displayFormats,n=this._unit,r=t||i[n];return this._adapter.format(e,r)}_tickFormatFunction(e,t,i,n){const r=this.options,o=r.ticks.callback;if(o)return f(o,[e,t,i],this);const s=r.time.displayFormats,a=this._unit,l=this._majorUnit,c=a&&s[a],u=l&&s[l],d=i[t],h=l&&u&&d&&d.major;return this._adapter.format(e,n||(h?u:c))}generateTickLabels(e){let t,i,n;for(t=0,i=e.length;t<i;++t)n=e[t],n.label=this._tickFormatFunction(n.value,t,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,i=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+i)*t.factor)}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+i*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,i=this.ctx.measureText(e).width,n=L(this.isHorizontal()?t.maxRotation:t.minRotation),r=Math.cos(n),o=Math.sin(n),s=this._resolveTickFontOptions(0).size;return{w:i*r+s*o,h:i*o+s*r}}_getLabelCapacity(e){const t=this.options.time,i=t.displayFormats,n=i[t.unit]||i.millisecond,r=this._tickFormatFunction(e,0,Bo(this,[e],this._majorUnit),n),o=this._getLabelSize(r),s=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return s>0?s:1}getDataTimestamps(){let e,t,i=this._cache.data||[];if(i.length)return i;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(e=0,t=n.length;e<t;++e)i=i.concat(n[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(i)}getLabelTimestamps(){const e=this._cache.labels||[];let t,i;if(e.length)return e;const n=this.getLabels();for(t=0,i=n.length;t<i;++t)e.push(Go(this,n[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return xe(e.sort(Fo))}}function jo(e,t,i){let n,r,o,s,a=0,l=e.length-1;i?(t>=e[a].pos&&t<=e[l].pos&&({lo:a,hi:l}=C(e,"pos",t)),{pos:n,time:o}=e[a],{pos:r,time:s}=e[l]):(t>=e[a].time&&t<=e[l].time&&({lo:a,hi:l}=C(e,"time",t)),{time:n,pos:o}=e[a],{time:r,pos:s}=e[l]);const c=r-n;return c?o+(s-o)*(t-n)/c:o}var zo=Object.freeze({__proto__:null,CategoryScale:class extends rr{static id="category";static defaults={ticks:{callback:vo}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(i){const n=this._addedLabels;if(n.length){const i=this.getLabels();for(const{index:e,label:t}of n)i[e]===t&&i.splice(e,1);this._addedLabels=[]}super.init(i)}parse(e,t){if(T(e))return null;const i=this.getLabels();return((e,t)=>null===e?null:b(Math.round(e),0,t))(t=isFinite(t)&&i[t]===e?t:mo(i,e,O(t,e),this._addedLabels),i.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:i,max:n}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(i=0),t||(n=this.getLabels().length-1)),this.min=i,this.max=n}buildTicks(){const t=this.min,i=this.max,e=this.options.offset,n=[];let r=this.getLabels();r=0===t&&i===r.length-1?r:r.slice(t,i+1),this._valueRange=Math.max(r.length-(e?0:1),1),this._startValue=this.min-(e?.5:0);for(let e=t;e<=i;e++)n.push({value:e});return n}getLabelForValue(e){return vo.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!=typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}},LinearScale:_o,LogarithmicScale:Eo,RadialLinearScale:Lo,TimeScale:Vo,TimeSeriesScale:class extends Vo{static id="timeseries";static defaults=Vo.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=jo(t,this.min),this._tableRange=jo(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:i}=this,n=[],r=[];let o,s,a,l,c;for(o=0,s=e.length;o<s;++o)l=e[o],l>=t&&l<=i&&n.push(l);if(n.length<2)return[{time:t,pos:0},{time:i,pos:1}];for(o=0,s=n.length;o<s;++o)c=n[o+1],a=n[o-1],l=n[o],Math.round((c+a)/2)!==l&&r.push({time:l,pos:o/(s-1)});return r}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),i=this.getLabelTimestamps();return e=t.length&&i.length?this.normalize(t.concat(i)):t.length?t:i,e=this._cache.all=e,e}getDecimalForValue(e){return(jo(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return jo(this._table,i*this._tableRange+this._minPos,!0)}}});const Wo=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],Uo=Wo.map(e=>e.replace("rgb(","rgba(").replace(")",", 0.5)"));function Yo(e){return Wo[e%Wo.length]}function qo(e){return Uo[e%Uo.length]}function Ko(n){let r=0;return(e,t)=>{const i=n.getDatasetMeta(t).controller;i instanceof Wr?r=function(e,t){return e.backgroundColor=e.data.map(()=>Yo(t++)),t}(e,r):i instanceof Ur?r=function(e,t){return e.backgroundColor=e.data.map(()=>qo(t++)),t}(e,r):i&&(r=function(e,t){return e.borderColor=Yo(t),e.backgroundColor=qo(t),++t}(e,r))}}function Xo(e){let t;for(t in e)if(e[t].borderColor||e[t].backgroundColor)return!0;return!1}var Zo={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(e,t,i){if(!i.enabled)return;const{data:{datasets:n},options:r}=e.config,{elements:o}=r;if(!i.forceOverride&&(Xo(n)||(s=r)&&(s.borderColor||s.backgroundColor)||o&&Xo(o)))return;var s;const a=Ko(e);n.forEach(a)}};function Qo(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function Jo(e){e.data.datasets.forEach(e=>{Qo(e)})}var es={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(u,e,d)=>{if(!d.enabled)return void Jo(u);const h=u.width;u.data.datasets.forEach((e,t)=>{const{_data:i,indexAxis:n}=e,r=u.getDatasetMeta(t),o=i||e.data;if("y"===Ni([n,u.options.indexAxis]))return;if(!r.controller.supportsDecimation)return;const s=u.scales[r.xAxisID];if("linear"!==s.type&&"time"!==s.type)return;if(u.options.parsing)return;let{start:a,count:l}=function(e,t){const i=t.length;let n,r=0;const{iScale:o}=e,{min:s,max:a,minDefined:l,maxDefined:c}=o.getUserBounds();return l&&(r=b(C(t,o.axis,s).lo,0,i-1)),n=c?b(C(t,o.axis,a).hi+1,r,i)-r:i-r,{start:r,count:n}}(r,o);if(l<=(d.threshold||4*h))return void Qo(e);let c;switch(T(i)&&(e._data=o,delete e.data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(e){this._data=e}})),d.algorithm){case"lttb":c=function(c,u,d,e,t){const i=t.samples||e;if(i>=d)return c.slice(u,u+d);const h=[],f=(d-2)/(i-2);let p=0;const g=u+d-1;let m,v,y,b,_,w=u;for(h[p++]=c[w],m=0;m<i-2;m++){let e,t=0,i=0;const g=Math.floor((m+1)*f)+1+u,n=Math.min(Math.floor((m+2)*f)+1,d)+u,r=n-g;for(e=g;e<n;e++)t+=c[e].x,i+=c[e].y;t/=r,i/=r;const o=Math.floor(m*f)+1+u,s=Math.min(Math.floor((m+1)*f)+1,d)+u,{x:a,y:l}=c[w];for(y=b=-1,e=o;e<s;e++)b=.5*Math.abs((a-t)*(c[e].y-l)-(a-c[e].x)*(i-l)),b>y&&(y=b,v=c[e],_=e);h[p++]=v,w=_}return h[p++]=c[g],h}(o,a,l,h,d);break;case"min-max":c=function(e,t,i,n){let r,o,s,a,l,c,u,d,h,f,p=0,g=0;const m=[],v=t+i-1,y=e[t].x,b=e[v].x-y;for(r=t;r<t+i;++r){o=e[r],s=(o.x-y)/b*n,a=o.y;const t=0|s;if(t===l)a<h?(h=a,c=r):a>f&&(f=a,u=r),p=(g*p+o.x)/++g;else{const i=r-1;if(!T(c)&&!T(u)){const t=Math.min(c,u),T=Math.max(c,u);t!==d&&t!==i&&m.push({...e[t],x:p}),T!==d&&T!==i&&m.push({...e[T],x:p})}r>0&&i!==d&&m.push(e[i]),m.push(o),l=t,g=0,h=f=a,c=u=d=r}}return m}(o,a,l,h);break;default:throw new Error(`Unsupported decimation algorithm '${d.algorithm}'`)}e._decimated=c})},destroy(e){Jo(e)}};function ts(e,t,i,n){if(n)return;let r=t[e],o=i[e];return"angle"===e&&(r=y(r),o=y(o)),{property:e,start:r,end:o}}function is(e,t,i){for(;t>e;t--){const e=i[t];if(!isNaN(e.x)&&!isNaN(e.y))break}return t}function ns(e,t,i,n){return e&&t?n(e[i],t[i]):e?e[i]:t?t[i]:0}function rs(e,t){let i=[],n=!1;return M(e)?(n=!0,i=e):i=function(e,t){const{x:r=null,y:o=null}=e||{},s=t.points,a=[];return t.segments.forEach(({start:e,end:t})=>{t=is(e,t,s);const i=s[e],n=s[t];null!==o?(a.push({x:i.x,y:o}),a.push({x:n.x,y:o})):null!==r&&(a.push({x:r,y:i.y}),a.push({x:r,y:n.y}))}),a}(e,t),i.length?new so({points:i,options:{tension:0},_loop:n,_fullLoop:n}):null}function os(e){return e&&!1!==e.fill}function ss(e,t,i){let n=e[t].fill;const r=[t];let o;if(!i)return n;for(;!1!==n&&-1===r.indexOf(n);){if(!p(n))return n;if(o=e[n],!o)return!1;if(o.visible)return n;r.push(n),n=o.fill}return!1}function as(e,t,i){const n=function(e){const t=e.options,i=t.fill;let n=O(i&&i.target,i);void 0===n&&(n=!!t.backgroundColor);if(!1===n||null===n)return!1;if(!0===n)return"origin";return n}(e);if(k(n))return!isNaN(n.value)&&n;let r=parseFloat(n);return p(r)&&Math.floor(r)===r?function(e,t,i,n){"-"!==e&&"+"!==e||(i=t+i);if(i===t||i<0||i>=n)return!1;return i}(n[0],t,r,i):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function ls(o,s,a){const l=[];for(let r=0;r<a.length;r++){const e=a[r],{first:t,last:i,point:n}=cs(e,s,"x");if(!(!n||t&&i))if(t)l.unshift(n);else if(o.push(n),!i)break}o.push(...l)}function cs(e,i,n){const r=e.interpolate(i,n);if(!r)return{};const o=r[n],s=e.segments,a=e.points;let l=!1,c=!1;for(let t=0;t<s.length;t++){const i=s[t],r=a[i.start][n],e=a[i.end][n];if(w(o,r,e)){l=o===r,c=o===e;break}}return{first:l,last:c,point:r}}class us{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,i){const{x:n,y:r,radius:o}=this;return t=t||{start:0,end:_},e.arc(n,r,o,t.end,t.start,!0),!i.bounds}interpolate(e){const{x:t,y:i,radius:n}=this,r=e.angle;return{x:t+Math.cos(r)*n,y:i+Math.sin(r)*n,angle:r}}}function ds(e){const{chart:t,fill:i,line:n}=e;if(p(i))return function(e,t){const i=e.getDatasetMeta(t),n=i&&e.isDatasetVisible(t);return n?i.dataset:null}(t,i);if("stack"===i)return function(e){const{scale:t,index:i,line:n}=e,r=[],o=n.segments,s=n.points,a=function(e,i){const n=[],r=e.getMatchingVisibleMetas("line");for(let t=0;t<r.length;t++){const e=r[t];if(e.index===i)break;e.hidden||n.unshift(e.dataset)}return n}(t,i);a.push(rs({x:null,y:t.bottom},n));for(let e=0;e<o.length;e++){const t=o[e];for(let e=t.start;e<=t.end;e++)ls(r,s[e],a)}return new so({points:r,options:{}})}(e);if("shape"===i)return!0;const r=function(e){const t=e.scale||{};if(t.getPointPositionForValue)return function(e){const{scale:t,fill:i}=e,n=t.options,r=t.getLabels().length,o=n.reverse?t.max:t.min,s=function(e,t,i){let n;return n="start"===e?i:"end"===e?t.options.reverse?t.min:t.max:k(e)?e.value:t.getBaseValue(),n}(i,t,o),a=[];if(n.grid.circular){const e=t.getPointPositionForValue(0,o);return new us({x:e.x,y:e.y,radius:t.getDistanceFromCenterForValue(s)})}for(let e=0;e<r;++e)a.push(t.getPointPositionForValue(e,s));return a}(e);return function(e){const{scale:t={},fill:i}=e,n=function(e,t){let i=null;return"start"===e?i=t.bottom:"end"===e?i=t.top:k(e)?i=t.getPixelForValue(e.value):t.getBasePixel&&(i=t.getBasePixel()),i}(i,t);if(p(n)){const e=t.isHorizontal();return{x:e?n:null,y:e?null:n}}return null}(e)}(e);return r instanceof us?r:rs(r,n)}function hs(e,t,i){const n=ds(t),{line:r,scale:o,axis:s}=t,a=r.options,l=a.fill,c=a.backgroundColor,{above:u=c,below:d=c}=l||{};n&&r.points.length&&(zt(e,i),function(e,t){const{line:i,target:n,above:r,below:o,area:s,scale:a}=t,l=i._loop?"angle":t.axis;e.save(),"x"===l&&o!==r&&(fs(e,n,s.top),ps(e,{line:i,target:n,color:r,scale:a,property:l}),e.restore(),e.save(),fs(e,n,s.bottom));ps(e,{line:i,target:n,color:o,scale:a,property:l}),e.restore()}(e,{line:r,target:n,above:u,below:d,area:i,scale:o,axis:s}),Wt(e))}function fs(r,o,s){const{segments:a,points:l}=o;let c=!0,u=!1;r.beginPath();for(const n of a){const{start:a,end:e}=n,t=l[a],i=l[is(a,e,l)];c?(r.moveTo(t.x,t.y),c=!1):(r.lineTo(t.x,s),r.lineTo(t.x,t.y)),u=!!o.pathSegment(r,n,{move:u}),u?r.closePath():r.lineTo(i.x,s)}r.lineTo(o.first().x,s),r.closePath(),r.clip()}function ps(s,a){const{line:l,target:c,property:u,color:d,scale:h}=a,f=function(r,o,s){const a=r.segments,l=r.points,c=o.points,u=[];for(const r of a){let{start:e,end:t}=r;t=is(e,t,l);const i=ts(s,l[e],l[t],r.loop);if(!o.segments){u.push({source:r,target:i,start:l[e],end:l[t]});continue}const n=Vi(o,i);for(const o of n){const a=ts(s,c[o.start],c[o.end],o.loop),e=Bi(r,l,a);for(const r of e)u.push({source:r,target:o,start:{[s]:ns(i,a,"start",Math.max)},end:{[s]:ns(i,a,"end",Math.min)}})}}return u}(l,c,u);for(const{source:a,target:n,start:r,end:o}of f){const{style:{backgroundColor:f=d}={}}=a,e=!0!==c;s.save(),s.fillStyle=f,gs(s,h,e&&ts(u,r,o)),s.beginPath();const t=!!l.pathSegment(s,a);let i;if(e){t?s.closePath():ms(s,c,o,u);const a=!!c.pathSegment(s,n,{move:t,reverse:!0});i=t&&a,i||ms(s,c,r,u)}s.closePath(),s.fill(i?"evenodd":"nonzero"),s.restore()}}function gs(e,t,i){const{top:n,bottom:r}=t.chart.chartArea,{property:o,start:s,end:a}=i||{};"x"===o&&(e.beginPath(),e.rect(s,n,a-s,r-n),e.clip())}function ms(e,t,i,n){const r=t.interpolate(i,n);r&&e.lineTo(r.x,r.y)}var vs={id:"filler",afterDatasetsUpdate(e,t,i){const n=(e.data.datasets||[]).length,r=[];let o,s,a,l;for(s=0;s<n;++s)o=e.getDatasetMeta(s),a=o.dataset,l=null,a&&a.options&&a instanceof so&&(l={visible:e.isDatasetVisible(s),index:s,fill:as(a,s,n),chart:e,axis:o.controller.options.indexAxis,scale:o.vScale,line:a}),o.$filler=l,r.push(l);for(s=0;s<n;++s)l=r[s],l&&!1!==l.fill&&(l.fill=ss(r,s,i.propagate))},beforeDraw(t,e,i){const n="beforeDraw"===i.drawTime,r=t.getSortedVisibleDatasetMetas(),o=t.chartArea;for(let e=r.length-1;e>=0;--e){const i=r[e].$filler;i&&(i.line.updateControlPoints(o,i.axis),n&&i.fill&&hs(t.ctx,i,o))}},beforeDatasetsDraw(t,e,i){if("beforeDatasetsDraw"!==i.drawTime)return;const n=t.getSortedVisibleDatasetMetas();for(let e=n.length-1;e>=0;--e){const i=n[e].$filler;os(i)&&hs(t.ctx,i,t.chartArea)}},beforeDatasetDraw(e,t,i){const n=t.meta.$filler;os(n)&&"beforeDatasetDraw"===i.drawTime&&hs(e.ctx,n,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const ys=(e,t)=>{let{boxHeight:i=t,boxWidth:n=t}=e;return e.usePointStyle&&(i=Math.min(i,t),n=e.pointStyleWidth||Math.min(n,t)),{boxWidth:n,boxHeight:i,itemHeight:Math.max(t,i)}};class bs extends t{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,i){this.maxWidth=e,this.maxHeight=t,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const i=this.options.labels||{};let e=f(i.generateLabels,[this.chart],this)||[];i.filter&&(e=e.filter(e=>i.filter(e,this.chart.data))),i.sort&&(e=e.sort((e,t)=>i.sort(e,t,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:e,ctx:t}=this;if(!e.display)return void(this.width=this.height=0);const i=e.labels,n=R(i.font),r=n.size,o=this._computeTitleHeight(),{boxWidth:s,itemHeight:a}=ys(i,r);let l,c;t.font=n.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(o,r,s,a)+10):(c=this.maxHeight,l=this._fitCols(o,n,s,a)+10),this.width=Math.min(l,e.maxWidth||this.maxWidth),this.height=Math.min(c,e.maxHeight||this.maxHeight)}_fitRows(e,n,r,o){const{ctx:s,maxWidth:a,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.lineWidths=[0],d=o+l;let h=e;s.textAlign="left",s.textBaseline="middle";let f=-1,p=-d;return this.legendItems.forEach((e,t)=>{const i=r+n/2+s.measureText(e.text).width;(0===t||u[u.length-1]+i+2*l>a)&&(h+=d,u[u.length-(t>0?0:1)]=0,p+=d,f++),c[t]={left:0,top:p,row:f,width:i,height:o},u[u.length-1]+=i+l}),h}_fitCols(e,r,o,s){const{ctx:a,maxHeight:t,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.columnSizes=[],d=t-e;let h=l,f=0,p=0,g=0,m=0;return this.legendItems.forEach((e,t)=>{const{itemWidth:i,itemHeight:n}=function(e,t,i,n,r){const o=function(e,t,i,n){let r=e.text;r&&"string"!=typeof r&&(r=r.reduce((e,t)=>e.length>t.length?e:t));return t+i.size/2+n.measureText(r).width}(n,e,t,i),s=function(e,t,i){let n=e;"string"!=typeof t.text&&(n=_s(t,i));return n}(r,n,t.lineHeight);return{itemWidth:o,itemHeight:s}}(o,r,a,e,s);t>0&&p+n+2*l>d&&(h+=f+l,u.push({width:f,height:p}),g+=f+l,m++,f=p=0),c[t]={left:g,top:p,col:m,width:i,height:n},f=Math.max(f,i),p+=n+l}),h+=f,u.push({width:f,height:p}),h}adjustHitBoxes(){if(!this.options.display)return;const n=this._computeTitleHeight(),{legendHitBoxes:r,options:{align:o,labels:{padding:s},rtl:e}}=this,a=Pi(e,this.left,this.width);if(this.isHorizontal()){let t=0,i=E(o,this.left+s,this.right-this.lineWidths[t]);for(const e of r)t!==e.row&&(t=e.row,i=E(o,this.left+s,this.right-this.lineWidths[t])),e.top+=this.top+n+s,e.left=a.leftForLtr(a.x(i),e.width),i+=e.width+s}else{let t=0,i=E(o,this.top+n+s,this.bottom-this.columnSizes[t].height);for(const e of r)e.col!==t&&(t=e.col,i=E(o,this.top+n+s,this.bottom-this.columnSizes[t].height)),e.top=i,e.left+=this.left+s,e.left=a.leftForLtr(a.x(e.left),e.width),i+=e.height+s}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const e=this.ctx;zt(e,this),this._draw(),Wt(e)}}_draw(){const{options:a,columnSizes:l,lineWidths:c,ctx:u}=this,{align:d,labels:h}=a,f=D.color,p=Pi(a.rtl,this.left,this.width),g=R(h.font),{padding:m}=h,v=g.size,y=v/2;let b;this.drawTitle(),u.textAlign=p.textAlign("left"),u.textBaseline="middle",u.lineWidth=.5,u.font=g.string;const{boxWidth:_,boxHeight:w,itemHeight:C}=ys(h,v),x=this.isHorizontal(),S=this._computeTitleHeight();b=x?{x:E(d,this.left+m,this.right-c[0]),y:this.top+m+S,line:0}:{x:this.left+m,y:E(d,this.top+S+m,this.bottom-l[0].height),line:0},Fi(this.ctx,a.textDirection);const A=C+m;this.legendItems.forEach((e,t)=>{u.strokeStyle=e.fontColor,u.fillStyle=e.fontColor;const i=u.measureText(e.text).width,n=p.textAlign(e.textAlign||(e.textAlign=h.textAlign)),r=_+y+i;let o=b.x,s=b.y;p.setWidth(this.width),x?t>0&&o+r+m>this.right&&(s=b.y+=A,b.line++,o=b.x=E(d,this.left+m,this.right-c[b.line])):t>0&&s+A>this.bottom&&(o=b.x=o+l[b.line].width+m,b.line++,s=b.y=E(d,this.top+S+m,this.bottom-l[b.line].height));if(function(e,t,i){if(isNaN(_)||_<=0||isNaN(w)||w<0)return;u.save();const n=O(i.lineWidth,1);if(u.fillStyle=O(i.fillStyle,f),u.lineCap=O(i.lineCap,"butt"),u.lineDashOffset=O(i.lineDashOffset,0),u.lineJoin=O(i.lineJoin,"miter"),u.lineWidth=n,u.strokeStyle=O(i.strokeStyle,f),u.setLineDash(O(i.lineDash,[])),h.usePointStyle){const f={radius:w*Math.SQRT2/2,pointStyle:i.pointStyle,rotation:i.rotation,borderWidth:n},O=p.xPlus(e,_/2);jt(u,f,O,t+y,h.pointStyleWidth&&_)}else{const h=t+Math.max((v-w)/2,0),f=p.leftForLtr(e,_),O=Oi(i.borderRadius);u.beginPath(),Object.values(O).some(e=>0!==e)?Zt(u,{x:f,y:h,w:_,h:w,radius:O}):u.rect(f,h,_,w),u.fill(),0!==n&&u.stroke()}u.restore()}(p.x(o),s,e),o=De(n,o+_+y,x?o+r:this.right,a.rtl),function(e,t,i){Xt(u,i.text,e,t+C/2,g,{strikethrough:i.hidden,textAlign:p.textAlign(i.textAlign)})}(p.x(o),s,e),x)b.x+=r+m;else if("string"!=typeof e.text){const a=g.lineHeight;b.y+=_s(e,a)}else b.y+=A}),Gi(this.ctx,a.textDirection)}drawTitle(){const e=this.options,t=e.title,i=R(t.font),n=P(t.padding);if(!t.display)return;const r=Pi(e.rtl,this.left,this.width),o=this.ctx,s=t.position,a=i.size/2,l=n.top+a;let c,u=this.left,d=this.width;if(this.isHorizontal())d=Math.max(...this.lineWidths),c=this.top+l,u=E(e.align,u,this.right-d);else{const t=this.columnSizes.reduce((e,t)=>Math.max(e,t.height),0);c=l+E(e.align,this.top,this.bottom-t-e.labels.padding-this._computeTitleHeight())}const h=E(s,u,u+d);o.textAlign=r.textAlign(Te(s)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=i.string,Xt(o,t.text,h,c,i)}_computeTitleHeight(){const e=this.options.title,t=R(e.font),i=P(e.padding);return e.display?t.lineHeight+i.height:0}_getLegendItemAt(e,t){let i,n,r;if(w(e,this.left,this.right)&&w(t,this.top,this.bottom))for(r=this.legendHitBoxes,i=0;i<r.length;++i)if(n=r[i],w(e,n.left,n.left+n.width)&&w(t,n.top,n.top+n.height))return this.legendItems[i];return null}handleEvent(i){const n=this.options;if(!function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(i.type,n))return;const r=this._getLegendItemAt(i.x,i.y);if("mousemove"===i.type||"mouseout"===i.type){const e=this._hoveredItem,t=(s=r,null!==(o=e)&&null!==s&&o.datasetIndex===s.datasetIndex&&o.index===s.index);e&&!t&&f(n.onLeave,[i,e,this],this),this._hoveredItem=r,r&&!t&&f(n.onHover,[i,r,this],this)}else r&&f(n.onClick,[i,r,this],this);var o,s}}function _s(e,t){return t*(e.text?e.text.length+.5:0)}var ws={id:"legend",_element:bs,start(e,t,i){const n=e.legend=new bs({ctx:e.ctx,options:i,chart:e});r.configure(e,n,i),r.addBox(e,n)},stop(e){r.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,i){const n=e.legend;r.configure(e,n,i),n.options=i},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,i){const n=t.datasetIndex,r=i.chart;r.isDatasetVisible(n)?(r.hide(n),t.hidden=!0):(r.show(n),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const n=e.data.datasets,{labels:{usePointStyle:r,pointStyle:o,textAlign:s,color:a,useBorderRadius:l,borderRadius:c}}=e.legend.options;return e._getSortedDatasetMetas().map(e=>{const t=e.controller.getStyle(r?0:void 0),i=P(t.borderWidth);return{text:n[e.index].label,fillStyle:t.backgroundColor,fontColor:a,hidden:!e.visible,lineCap:t.borderCapStyle,lineDash:t.borderDash,lineDashOffset:t.borderDashOffset,lineJoin:t.borderJoinStyle,lineWidth:(i.width+i.height)/4,strokeStyle:t.borderColor,pointStyle:o||t.pointStyle,rotation:t.rotation,textAlign:s||t.textAlign,borderRadius:l&&(c||t.borderRadius),datasetIndex:e.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class Cs extends t{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const i=this.options;if(this.left=0,this.top=0,!i.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=e,this.height=this.bottom=t;const n=M(i.text)?i.text.length:1;this._padding=P(i.padding);const r=n*R(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){const{top:t,left:i,bottom:n,right:r,options:o}=this,s=o.align;let a,l,c,u=0;return this.isHorizontal()?(l=E(s,i,r),c=t+e,a=r-i):("left"===o.position?(l=i+e,c=E(s,n,t),u=-.5*N):(l=r-e,c=E(s,t,n),u=.5*N),a=n-t),{titleX:l,titleY:c,maxWidth:a,rotation:u}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const i=R(t.font),n=i.lineHeight/2+this._padding.top,{titleX:r,titleY:o,maxWidth:s,rotation:a}=this._drawArgs(n);Xt(e,t.text,0,0,i,{color:t.color,maxWidth:s,rotation:a,textAlign:Te(t.align),textBaseline:"middle",translation:[r,o]})}}var xs={id:"title",_element:Cs,start(e,t,i){!function(e,t){const i=new Cs({ctx:e.ctx,options:t,chart:e});r.configure(e,i,t),r.addBox(e,i),e.titleBlock=i}(e,i)},stop(e){const t=e.titleBlock;r.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,i){const n=e.titleBlock;r.configure(e,n,i),n.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Ss=new WeakMap;var As={id:"subtitle",start(e,t,i){const n=new Cs({ctx:e.ctx,options:i,chart:e});r.configure(e,n,i),r.addBox(e,n),Ss.set(e,n)},stop(e){r.removeBox(e,Ss.get(e)),Ss.delete(e)},beforeUpdate(e,t,i){const n=Ss.get(e);r.configure(e,n,i),n.options=i},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Es={average(e){if(!e.length)return!1;let t,i,n=0,r=0,o=0;for(t=0,i=e.length;t<i;++t){const i=e[t].element;if(i&&i.hasValue()){const e=i.tooltipPosition();n+=e.x,r+=e.y,++o}}return{x:n/o,y:r/o}},nearest(e,t){if(!e.length)return!1;let i,n,r,o=t.x,s=t.y,a=Number.POSITIVE_INFINITY;for(i=0,n=e.length;i<n;++i){const n=e[i].element;if(n&&n.hasValue()){const e=fe(t,n.getCenterPoint());e<a&&(a=e,r=n)}}if(r){const e=r.tooltipPosition();o=e.x,s=e.y}return{x:o,y:s}}};function A(e,t){return t&&(M(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Ts(e){return("string"==typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function Ds(e,t){const{element:i,datasetIndex:n,index:r}=t,o=e.getDatasetMeta(n).controller,{label:s,value:a}=o.getLabelAndValue(r);return{chart:e,label:s,parsed:o.getParsed(r),raw:e.data.datasets[n].data[r],formattedValue:a,dataset:o.getDataset(),dataIndex:r,datasetIndex:n,element:i}}function Rs(e,t){const i=e.chart.ctx,{body:n,footer:r,title:o}=e,{boxWidth:s,boxHeight:a}=t,l=R(t.bodyFont),c=R(t.titleFont),u=R(t.footerFont),d=o.length,h=r.length,f=n.length,p=P(t.padding);let g=p.height,m=0,v=n.reduce((e,t)=>e+t.before.length+t.lines.length+t.after.length,0);if(v+=e.beforeBody.length+e.afterBody.length,d&&(g+=d*c.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),v){g+=f*(t.displayColors?Math.max(a,l.lineHeight):l.lineHeight)+(v-f)*l.lineHeight+(v-1)*t.bodySpacing}h&&(g+=t.footerMarginTop+h*u.lineHeight+(h-1)*t.footerSpacing);let y=0;const b=function(e){m=Math.max(m,i.measureText(e).width+y)};return i.save(),i.font=c.string,S(e.title,b),i.font=l.string,S(e.beforeBody.concat(e.afterBody),b),y=t.displayColors?s+2+t.boxPadding:0,S(n,e=>{S(e.before,b),S(e.lines,b),S(e.after,b)}),y=0,i.font=u.string,S(e.footer,b),i.restore(),m+=p.width,{width:m,height:g}}function Ms(e,t,i,n){const{x:r,width:o}=i,{width:s,chartArea:{left:a,right:l}}=e;let c="center";return"center"===n?c=r<=(a+l)/2?"left":"right":r<=o/2?c="left":r>=s-o/2&&(c="right"),function(e,t,i,n){const{x:r,width:o}=n,s=i.caretSize+i.caretPadding;return"left"===e&&r+o+s>t.width||"right"===e&&r-o-s<0||void 0}(c,e,t,i)&&(c="center"),c}function ks(e,t,i){const n=i.yAlign||t.yAlign||function(e,t){const{y:i,height:n}=t;return i<n/2?"top":i>e.height-n/2?"bottom":"center"}(e,i);return{xAlign:i.xAlign||t.xAlign||Ms(e,t,i,n),yAlign:n}}function Os(e,t,i,n){const{caretSize:r,caretPadding:o,cornerRadius:s}=e,{xAlign:a,yAlign:l}=i,c=r+o,{topLeft:u,topRight:d,bottomLeft:h,bottomRight:f}=Oi(s);let p=function(e,t){let{x:i,width:n}=e;return"right"===t?i-=n:"center"===t&&(i-=n/2),i}(t,a);const g=function(e,t,i){let{y:n,height:r}=e;return"top"===t?n+=i:n-="bottom"===t?r+i:r/2,n}(t,l,c);return"center"===l?"left"===a?p+=c:"right"===a&&(p-=c):"left"===a?p-=Math.max(u,h)+r:"right"===a&&(p+=Math.max(d,f)+r),{x:b(p,0,n.width-t.width),y:b(g,0,n.height-t.height)}}function Ns(e,t,i){const n=P(i.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-n.right:e.x+n.left}function Is(e){return A([],Ts(e))}function Ls(e,t){const i=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return i?e.override(i):e}const Ps={beforeTitle:e,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,i=t?t.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return t[e.dataIndex]}return""},afterTitle:e,beforeBody:e,beforeLabel:e,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const i=e.formattedValue;return T(i)||(t+=i),t},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:e,afterBody:e,beforeFooter:e,footer:e,afterFooter:e};function F(e,t,i,n){const r=e[t].call(i,n);return void 0===r?Ps[t].call(i,n):r}class Fs extends t{static positioners=Es;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,i=this.options.setContext(this.getContext()),n=i.enabled&&t.options.animation&&i.animations,r=new Pn(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,i=this._tooltipItems,Li(e,{tooltip:t,tooltipItems:i,type:"tooltip"})));var e,t,i}getTitle(e,t){const{callbacks:i}=t,n=F(i,"beforeTitle",this,e),r=F(i,"title",this,e),o=F(i,"afterTitle",this,e);let s=[];return s=A(s,Ts(n)),s=A(s,Ts(r)),s=A(s,Ts(o)),s}getBeforeBody(e,t){return Is(F(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,r=[];return S(e,e=>{const t={before:[],lines:[],after:[]},i=Ls(n,e);A(t.before,Ts(F(i,"beforeLabel",this,e))),A(t.lines,F(i,"label",this,e)),A(t.after,Ts(F(i,"afterLabel",this,e))),r.push(t)}),r}getAfterBody(e,t){return Is(F(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:i}=t,n=F(i,"beforeFooter",this,e),r=F(i,"footer",this,e),o=F(i,"afterFooter",this,e);let s=[];return s=A(s,Ts(n)),s=A(s,Ts(r)),s=A(s,Ts(o)),s}_createItems(n){const e=this._active,r=this.chart.data,i=[],o=[],s=[];let t,a,l=[];for(t=0,a=e.length;t<a;++t)l.push(Ds(this.chart,e[t]));return n.filter&&(l=l.filter((e,t,i)=>n.filter(e,t,i,r))),n.itemSort&&(l=l.sort((e,t)=>n.itemSort(e,t,r))),S(l,e=>{const t=Ls(n.callbacks,e);i.push(F(t,"labelColor",this,e)),o.push(F(t,"labelPointStyle",this,e)),s.push(F(t,"labelTextColor",this,e))}),this.labelColors=i,this.labelPointStyles=o,this.labelTextColors=s,this.dataPoints=l,l}update(n,r){const o=this.options.setContext(this.getContext()),s=this._active;let a,l=[];if(s.length){const n=Es[o.position].call(this,s,this._eventPosition);l=this._createItems(o),this.title=this.getTitle(l,o),this.beforeBody=this.getBeforeBody(l,o),this.body=this.getBody(l,o),this.afterBody=this.getAfterBody(l,o),this.footer=this.getFooter(l,o);const r=this._size=Rs(this,o),e=Object.assign({},n,r),t=ks(this.chart,o,e),i=Os(o,e,t,this.chart);this.xAlign=t.xAlign,this.yAlign=t.yAlign,a={opacity:1,x:i.x,y:i.y,width:r.width,height:r.height,caretX:n.x,caretY:n.y}}else 0!==this.opacity&&(a={opacity:0});this._tooltipItems=l,this.$context=void 0,a&&this._resolveAnimations().update(this,a),n&&o.external&&o.external.call(this,{chart:this.chart,tooltip:this,replay:r})}drawCaret(e,t,i,n){const r=this.getCaretPosition(e,i,n);t.lineTo(r.x1,r.y1),t.lineTo(r.x2,r.y2),t.lineTo(r.x3,r.y3)}getCaretPosition(e,t,i){const{xAlign:n,yAlign:r}=this,{caretSize:o,cornerRadius:s}=i,{topLeft:a,topRight:l,bottomLeft:c,bottomRight:u}=Oi(s),{x:d,y:h}=e,{width:f,height:p}=t;let g,m,v,y,b,_;return"center"===r?(b=h+p/2,"left"===n?(g=d,m=g-o,y=b+o,_=b-o):(g=d+f,m=g+o,y=b-o,_=b+o),v=g):(m="left"===n?d+Math.max(a,c)+o:"right"===n?d+f-Math.max(l,u)-o:this.caretX,"top"===r?(y=h,b=y-o,g=m-o,v=m+o):(y=h+p,b=y+o,g=m+o,v=m-o),_=y),{x1:g,x2:m,x3:v,y1:y,y2:b,y3:_}}drawTitle(t,i,n){const r=this.title,o=r.length;let s,a,l;if(o){const e=Pi(n.rtl,this.x,this.width);for(t.x=Ns(this,n.titleAlign,n),i.textAlign=e.textAlign(n.titleAlign),i.textBaseline="middle",s=R(n.titleFont),a=n.titleSpacing,i.fillStyle=n.titleColor,i.font=s.string,l=0;l<o;++l)i.fillText(r[l],e.x(t.x),t.y+s.lineHeight/2),t.y+=s.lineHeight+a,l+1===o&&(t.y+=n.titleMarginBottom-a)}}_drawColorBox(e,t,i,n,r){const o=this.labelColors[i],s=this.labelPointStyles[i],{boxHeight:a,boxWidth:l}=r,c=R(r.bodyFont),u=Ns(this,"left",r),d=n.x(u),h=a<c.lineHeight?(c.lineHeight-a)/2:0,f=t.y+h;if(r.usePointStyle){const t={radius:Math.min(l,a)/2,pointStyle:s.pointStyle,rotation:s.rotation,borderWidth:1},i=n.leftForLtr(d,l)+l/2,k=f+a/2;e.strokeStyle=r.multiKeyBackground,e.fillStyle=r.multiKeyBackground,Vt(e,t,i,k),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,Vt(e,t,i,k)}else{e.lineWidth=k(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const t=n.leftForLtr(d,l),i=n.leftForLtr(n.xPlus(d,1),l-2),s=Oi(o.borderRadius);Object.values(s).some(e=>0!==e)?(e.beginPath(),e.fillStyle=r.multiKeyBackground,Zt(e,{x:t,y:f,w:l,h:a,radius:s}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),Zt(e,{x:i,y:f+1,w:l-2,h:a-2,radius:s}),e.fill()):(e.fillStyle=r.multiKeyBackground,e.fillRect(t,f,l,a),e.strokeRect(t,f,l,a),e.fillStyle=o.backgroundColor,e.fillRect(i,f+1,l-2,a-2))}e.fillStyle=this.labelTextColors[i]}drawBody(t,i,e){const{body:n}=this,{bodySpacing:r,bodyAlign:o,displayColors:s,boxHeight:a,boxWidth:l,boxPadding:c}=e,u=R(e.bodyFont);let d=u.lineHeight,h=0;const f=Pi(e.rtl,this.x,this.width),p=function(e){i.fillText(e,f.x(t.x+h),t.y+d/2),t.y+=d+r},g=f.textAlign(o);let m,v,y,b,_,w,C;for(i.textAlign=o,i.textBaseline="middle",i.font=u.string,t.x=Ns(this,g,e),i.fillStyle=e.bodyColor,S(this.beforeBody,p),h=s&&"right"!==g?"center"===o?l/2+c:l+2+c:0,b=0,w=n.length;b<w;++b){for(m=n[b],v=this.labelTextColors[b],i.fillStyle=v,S(m.before,p),y=m.lines,s&&y.length&&(this._drawColorBox(i,t,b,f,e),d=Math.max(u.lineHeight,a)),_=0,C=y.length;_<C;++_)p(y[_]),d=u.lineHeight;S(m.after,p)}h=0,d=u.lineHeight,S(this.afterBody,p),t.y-=r}drawFooter(t,i,n){const r=this.footer,o=r.length;let s,a;if(o){const e=Pi(n.rtl,this.x,this.width);for(t.x=Ns(this,n.footerAlign,n),t.y+=n.footerMarginTop,i.textAlign=e.textAlign(n.footerAlign),i.textBaseline="middle",s=R(n.footerFont),i.fillStyle=n.footerColor,i.font=s.string,a=0;a<o;++a)i.fillText(r[a],e.x(t.x),t.y+s.lineHeight/2),t.y+=s.lineHeight+n.footerSpacing}}drawBackground(e,t,i,n){const{xAlign:r,yAlign:o}=this,{x:s,y:a}=e,{width:l,height:c}=i,{topLeft:u,topRight:d,bottomLeft:h,bottomRight:f}=Oi(n.cornerRadius);t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.beginPath(),t.moveTo(s+u,a),"top"===o&&this.drawCaret(e,t,i,n),t.lineTo(s+l-d,a),t.quadraticCurveTo(s+l,a,s+l,a+d),"center"===o&&"right"===r&&this.drawCaret(e,t,i,n),t.lineTo(s+l,a+c-f),t.quadraticCurveTo(s+l,a+c,s+l-f,a+c),"bottom"===o&&this.drawCaret(e,t,i,n),t.lineTo(s+h,a+c),t.quadraticCurveTo(s,a+c,s,a+c-h),"center"===o&&"left"===r&&this.drawCaret(e,t,i,n),t.lineTo(s,a+u),t.quadraticCurveTo(s,a,s+u,a),t.closePath(),t.fill(),n.borderWidth>0&&t.stroke()}_updateAnimationTarget(r){const o=this.chart,s=this.$animations,a=s&&s.x,l=s&&s.y;if(a||l){const s=Es[r.position].call(this,this._active,this._eventPosition);if(!s)return;const e=this._size=Rs(this,r),t=Object.assign({},s,this._size),i=ks(o,r,t),n=Os(r,t,i,o);a._to===n.x&&l._to===n.y||(this.xAlign=i.xAlign,this.yAlign=i.yAlign,this.width=e.width,this.height=e.height,this.caretX=s.x,this.caretY=s.y,this._resolveAnimations().update(this,n))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(t);const n={width:this.width,height:this.height},r={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const o=P(t.padding),s=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&s&&(e.save(),e.globalAlpha=i,this.drawBackground(r,e,n,t),Fi(e,t.textDirection),r.y+=o.top,this.drawTitle(r,e,t),this.drawBody(r,e,t),this.drawFooter(r,e,t),Gi(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const i=this._active,n=e.map(({datasetIndex:e,index:t})=>{const i=this.chart.getDatasetMeta(e);if(!i)throw new Error("Cannot find a dataset at index "+e);return{datasetIndex:e,element:i.data[t],index:t}}),r=!B(i,n),o=this._positionChanged(n,t);(r||o)&&(this._active=n,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,i=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,r=this._active||[],o=this._getActiveElements(e,r,t,i),s=this._positionChanged(o,e),a=t||!B(o,r)||s;return a&&(this._active=o,(n.enabled||n.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),a}_getActiveElements(e,t,i,n){const r=this.options;if("mouseout"===e.type)return[];if(!n)return t;const o=this.chart.getElementsAtEventForMode(e,r.mode,r,i);return r.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:i,caretY:n,options:r}=this,o=Es[r.position].call(this,e,t);return!1!==o&&(i!==o.x||n!==o.y)}}var Gs={id:"tooltip",_element:Fs,positioners:Es,afterInit(e,t,i){i&&(e.tooltip=new Fs({chart:e,options:i}))},beforeUpdate(e,t,i){e.tooltip&&e.tooltip.initialize(i)},reset(e,t,i){e.tooltip&&e.tooltip.initialize(i)},afterDraw(t){const i=t.tooltip;if(i&&i._willRender()){const e={tooltip:i};if(!1===t.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0}))return;i.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",e)}},afterEvent(t,i){if(t.tooltip){const e=i.replay;t.tooltip.handleEvent(i.event,e,i.inChartArea)&&(i.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Ps},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};return i.register(Yr,zo,go,n),i.helpers={...Yi},i._adapters=Pr,i.Animation=Ln,i.Animations=Pn,i.animator=u,i.controllers=h.controllers.items,i.DatasetController=qn,i.Element=t,i.elements=go,i.Interaction=en,i.layouts=r,i.platforms=On,i.Scale=rr,i.Ticks=vt,Object.assign(i,Yr,zo,go,n,On),i.Chart=i,"undefined"!=typeof window&&(window.Chart=i),i});(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t(require("chart.js/helpers"),require("chart.js")):typeof define==="function"&&define.amd?define(["chart.js/helpers","chart.js"],t):(e=typeof globalThis!=="undefined"?globalThis:e||self,e.ChartDataLabels=t(e.Chart.helpers,e.Chart))})(this,function(b,l){"use strict";var t=function(){if(typeof window!=="undefined"){if(window.devicePixelRatio){return window.devicePixelRatio}var e=window.screen;if(e){return(e.deviceXDPI||1)/(e.logicalXDPI||1)}}return 1}();var h={toTextLines:function(e){var t=[];var i;e=[].concat(e);while(e.length){i=e.pop();if(typeof i==="string"){t.unshift.apply(t,i.split("\n"))}else if(Array.isArray(i)){e.push.apply(e,i)}else if(!b.isNullOrUndef(e)){t.unshift(""+i)}}return t},textSize:function(e,t,i){var n=[].concat(t);var r=n.length;var o=e.font;var s=0;var a;e.font=i.string;for(a=0;a<r;++a){s=Math.max(e.measureText(n[a]).width,s)}e.font=o;return{height:r*i.lineHeight,width:s}},bound:function(e,t,i){return Math.max(e,Math.min(t,i))},arrayDiff:function(e,t){var i=e.slice();var n=[];var r,o,s,a;for(r=0,s=t.length;r<s;++r){a=t[r];o=i.indexOf(a);if(o===-1){n.push([a,1])}else{i.splice(o,1)}}for(r=0,s=i.length;r<s;++r){n.push([i[r],-1])}return n},rasterize:function(e){return Math.round(e*t)/t}};function a(e,t){var i=t.x;var n=t.y;if(i===null){return{x:0,y:-1}}if(n===null){return{x:1,y:0}}var r=e.x-i;var o=e.y-n;var s=Math.sqrt(r*r+o*o);return{x:s?r/s:0,y:s?o/s:-1}}function s(e,t,i,n,r){switch(r){case"center":i=n=0;break;case"bottom":i=0;n=1;break;case"right":i=1;n=0;break;case"left":i=-1;n=0;break;case"top":i=0;n=-1;break;case"start":i=-i;n=-n;break;case"end":break;default:r*=Math.PI/180;i=Math.cos(r);n=Math.sin(r);break}return{x:e,y:t,vx:i,vy:n}}var r=0;var d=1;var f=2;var p=4;var g=8;function m(e,t,i){var n=r;if(e<i.left){n|=d}else if(e>i.right){n|=f}if(t<i.top){n|=g}else if(t>i.bottom){n|=p}return n}function c(e,t){var i=e.x0;var n=e.y0;var r=e.x1;var o=e.y1;var s=m(i,n,t);var a=m(r,o,t);var l,c,u;while(true){if(!(s|a)||s&a){break}l=s||a;if(l&g){c=i+(r-i)*(t.top-n)/(o-n);u=t.top}else if(l&p){c=i+(r-i)*(t.bottom-n)/(o-n);u=t.bottom}else if(l&f){u=n+(o-n)*(t.right-i)/(r-i);c=t.right}else if(l&d){u=n+(o-n)*(t.left-i)/(r-i);c=t.left}if(l===s){i=c;n=u;s=m(i,n,t)}else{r=c;o=u;a=m(r,o,t)}}return{x0:i,x1:r,y0:n,y1:o}}function u(e,t){var i=t.anchor;var n=e;var r,o;if(t.clamp){n=c(n,t.area)}if(i==="start"){r=n.x0;o=n.y0}else if(i==="end"){r=n.x1;o=n.y1}else{r=(n.x0+n.x1)/2;o=(n.y0+n.y1)/2}return s(r,o,e.vx,e.vy,t.align)}var i={arc:function(e,t){var i=(e.startAngle+e.endAngle)/2;var n=Math.cos(i);var r=Math.sin(i);var o=e.innerRadius;var s=e.outerRadius;return u({x0:e.x+n*o,y0:e.y+r*o,x1:e.x+n*s,y1:e.y+r*s,vx:n,vy:r},t)},point:function(e,t){var i=a(e,t.origin);var n=i.x*e.options.radius;var r=i.y*e.options.radius;return u({x0:e.x-n,y0:e.y-r,x1:e.x+n,y1:e.y+r,vx:i.x,vy:i.y},t)},bar:function(e,t){var i=a(e,t.origin);var n=e.x;var r=e.y;var o=0;var s=0;if(e.horizontal){n=Math.min(e.x,e.base);o=Math.abs(e.base-e.x)}else{r=Math.min(e.y,e.base);s=Math.abs(e.base-e.y)}return u({x0:n,y0:r+s,x1:n+o,y1:r,vx:i.x,vy:i.y},t)},fallback:function(e,t){var i=a(e,t.origin);return u({x0:e.x,y0:e.y,x1:e.x+(e.width||0),y1:e.y+(e.height||0),vx:i.x,vy:i.y},t)}};var v=h.rasterize;function y(e){var t=e.borderWidth||0;var i=e.padding;var n=e.size.height;var r=e.size.width;var o=-r/2;var s=-n/2;return{frame:{x:o-i.left-t,y:s-i.top-t,w:r+i.width+t*2,h:n+i.height+t*2},text:{x:o,y:s,w:r,h:n}}}function _(e,t){var i=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!i){return null}if(i.xCenter!==undefined&&i.yCenter!==undefined){return{x:i.xCenter,y:i.yCenter}}var n=i.getBasePixel();return e.horizontal?{x:n,y:null}:{x:null,y:n}}function w(e){if(e instanceof l.ArcElement){return i.arc}if(e instanceof l.PointElement){return i.point}if(e instanceof l.BarElement){return i.bar}return i.fallback}function C(e,t,i,n,r,o){var s=Math.PI/2;if(o){var a=Math.min(o,r/2,n/2);var l=t+a;var c=i+a;var u=t+n-a;var d=i+r-a;e.moveTo(t,c);if(l<u&&c<d){e.arc(l,c,a,-Math.PI,-s);e.arc(u,c,a,-s,0);e.arc(u,d,a,0,s);e.arc(l,d,a,s,Math.PI)}else if(l<u){e.moveTo(l,i);e.arc(u,c,a,-s,s);e.arc(l,c,a,s,Math.PI+s)}else if(c<d){e.arc(l,c,a,-Math.PI,0);e.arc(l,d,a,0,Math.PI)}else{e.arc(l,c,a,-Math.PI,Math.PI)}e.closePath();e.moveTo(t,i)}else{e.rect(t,i,n,r)}}function x(e,t,i){var n=i.backgroundColor;var r=i.borderColor;var o=i.borderWidth;if(!n&&(!r||!o)){return}e.beginPath();C(e,v(t.x)+o/2,v(t.y)+o/2,v(t.w)-o,v(t.h)-o,i.borderRadius);e.closePath();if(n){e.fillStyle=n;e.fill()}if(r&&o){e.strokeStyle=r;e.lineWidth=o;e.lineJoin="miter";e.stroke()}}function S(e,t,i){var n=i.lineHeight;var r=e.w;var o=e.x;var s=e.y+n/2;if(t==="center"){o+=r/2}else if(t==="end"||t==="right"){o+=r}return{h:n,w:r,x:o,y:s}}function A(e,t,i){var n=e.shadowBlur;var r=i.stroked;var o=v(i.x);var s=v(i.y);var a=v(i.w);if(r){e.strokeText(t,o,s,a)}if(i.filled){if(n&&r){e.shadowBlur=0}e.fillText(t,o,s,a);if(n&&r){e.shadowBlur=n}}}function E(e,t,i,n){var r=n.textAlign;var o=n.color;var s=!!o;var a=n.font;var l=t.length;var c=n.textStrokeColor;var u=n.textStrokeWidth;var d=c&&u;var h;if(!l||!s&&!d){return}i=S(i,r,a);e.font=a.string;e.textAlign=r;e.textBaseline="middle";e.shadowBlur=n.textShadowBlur;e.shadowColor=n.textShadowColor;if(s){e.fillStyle=o}if(d){e.lineJoin="round";e.lineWidth=u;e.strokeStyle=c}for(h=0,l=t.length;h<l;++h){A(e,t[h],{stroked:d,filled:s,w:i.w,x:i.x,y:i.y+i.h*h})}}var T=function(e,t,i,n){var r=this;r._config=e;r._index=n;r._model=null;r._rects=null;r._ctx=t;r._el=i};b.merge(T.prototype,{_modelize:function(e,t,i,n){var r=this;var o=r._index;var s=b.toFont(b.resolve([i.font,{}],n,o));var a=b.resolve([i.color,l.defaults.color],n,o);return{align:b.resolve([i.align,"center"],n,o),anchor:b.resolve([i.anchor,"center"],n,o),area:n.chart.chartArea,backgroundColor:b.resolve([i.backgroundColor,null],n,o),borderColor:b.resolve([i.borderColor,null],n,o),borderRadius:b.resolve([i.borderRadius,0],n,o),borderWidth:b.resolve([i.borderWidth,0],n,o),clamp:b.resolve([i.clamp,false],n,o),clip:b.resolve([i.clip,false],n,o),color:a,display:e,font:s,lines:t,offset:b.resolve([i.offset,4],n,o),opacity:b.resolve([i.opacity,1],n,o),origin:_(r._el,n),padding:b.toPadding(b.resolve([i.padding,4],n,o)),positioner:w(r._el),rotation:b.resolve([i.rotation,0],n,o)*(Math.PI/180),size:h.textSize(r._ctx,t,s),textAlign:b.resolve([i.textAlign,"start"],n,o),textShadowBlur:b.resolve([i.textShadowBlur,0],n,o),textShadowColor:b.resolve([i.textShadowColor,a],n,o),textStrokeColor:b.resolve([i.textStrokeColor,a],n,o),textStrokeWidth:b.resolve([i.textStrokeWidth,0],n,o)}},update:function(e){var t=this;var i=null;var n=null;var r=t._index;var o=t._config;var s,a,l;var c=b.resolve([o.display,true],e,r);if(c){s=e.dataset.data[r];a=b.valueOrDefault(b.callback(o.formatter,[s,e]),s);l=b.isNullOrUndef(a)?[]:h.toTextLines(a);if(l.length){i=t._modelize(c,l,o,e);n=y(i)}}t._model=i;t._rects=n},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(e,t){var i=this;var n=e.ctx;var r=i._model;var o=i._rects;var s;if(!this.visible()){return}n.save();if(r.clip){s=r.area;n.beginPath();n.rect(s.left,s.top,s.right-s.left,s.bottom-s.top);n.clip()}n.globalAlpha=h.bound(0,r.opacity,1);n.translate(v(t.x),v(t.y));n.rotate(r.rotation);x(n,o.frame,r);E(n,r.lines,o.text,r);n.restore()}});var D=Number.MIN_SAFE_INTEGER||-9007199254740991;var R=Number.MAX_SAFE_INTEGER||9007199254740991;function o(e,t,i){var n=Math.cos(i);var r=Math.sin(i);var o=t.x;var s=t.y;return{x:o+n*(e.x-o)-r*(e.y-s),y:s+r*(e.x-o)+n*(e.y-s)}}function M(e,t){var i=R;var n=D;var r=t.origin;var o,s,a,l,c;for(o=0;o<e.length;++o){s=e[o];a=s.x-r.x;l=s.y-r.y;c=t.vx*a+t.vy*l;i=Math.min(i,c);n=Math.max(n,c)}return{min:i,max:n}}function k(e,t){var i=t.x-e.x;var n=t.y-e.y;var r=Math.sqrt(i*i+n*n);return{vx:(t.x-e.x)/r,vy:(t.y-e.y)/r,origin:e,ln:r}}var O=function(){this._rotation=0;this._rect={x:0,y:0,w:0,h:0}};b.merge(O.prototype,{center:function(){var e=this._rect;return{x:e.x+e.w/2,y:e.y+e.h/2}},update:function(e,t,i){this._rotation=i;this._rect={x:t.x+e.x,y:t.y+e.y,w:t.w,h:t.h}},contains:function(e){var t=this;var i=1;var n=t._rect;e=o(e,t.center(),-t._rotation);return!(e.x<n.x-i||e.y<n.y-i||e.x>n.x+n.w+i*2||e.y>n.y+n.h+i*2)},intersects:function(e){var t=this._points();var i=e._points();var n=[k(t[0],t[1]),k(t[0],t[3])];var r,o,s;if(this._rotation!==e._rotation){n.push(k(i[0],i[1]),k(i[0],i[3]))}for(r=0;r<n.length;++r){o=M(t,n[r]);s=M(i,n[r]);if(o.max<s.min||s.max<o.min){return false}}return true},_points:function(){var e=this;var t=e._rect;var i=e._rotation;var n=e.center();return[o({x:t.x,y:t.y},n,i),o({x:t.x+t.w,y:t.y},n,i),o({x:t.x+t.w,y:t.y+t.h},n,i),o({x:t.x,y:t.y+t.h},n,i)]}});function N(e,t,i){var n=t.positioner(e,t);var r=n.vx;var o=n.vy;if(!r&&!o){return{x:n.x,y:n.y}}var s=i.w;var a=i.h;var l=t.rotation;var c=Math.abs(s/2*Math.cos(l))+Math.abs(a/2*Math.sin(l));var u=Math.abs(s/2*Math.sin(l))+Math.abs(a/2*Math.cos(l));var d=1/Math.max(Math.abs(r),Math.abs(o));c*=r*d;u*=o*d;c+=t.offset*r;u+=t.offset*o;return{x:n.x+c,y:n.y+u}}function G(e,t){var i,n,r,o;for(i=e.length-1;i>=0;--i){r=e[i].$layout;for(n=i-1;n>=0&&r._visible;--n){o=e[n].$layout;if(o._visible&&r._box.intersects(o._box)){t(r,o)}}}return e}function $(e){var t,i,n,r,o,s,a;for(t=0,i=e.length;t<i;++t){n=e[t];r=n.$layout;if(r._visible){a=new Proxy(n._el,{get:(e,t)=>e.getProps([t],true)[t]});o=n.geometry();s=N(a,n.model(),o);r._box.update(s,o,n.rotation())}}return G(e,function(e,t){var i=e._hidable;var n=t._hidable;if(i&&n||n){t._visible=false}else if(i){e._visible=false}})}var I={prepare:function(e){var t=[];var i,n,r,o,s;for(i=0,r=e.length;i<r;++i){for(n=0,o=e[i].length;n<o;++n){s=e[i][n];t.push(s);s.$layout={_box:new O,_hidable:false,_visible:true,_set:i,_idx:s._index}}}t.sort(function(e,t){var i=e.$layout;var n=t.$layout;return i._idx===n._idx?n._set-i._set:n._idx-i._idx});this.update(t);return t},update:function(e){var t=false;var i,n,r,o,s;for(i=0,n=e.length;i<n;++i){r=e[i];o=r.model();s=r.$layout;s._hidable=o&&o.display==="auto";s._visible=r.visible();t|=s._hidable}if(t){$(e)}},lookup:function(e,t){var i,n;for(i=e.length-1;i>=0;--i){n=e[i].$layout;if(n&&n._visible&&n._box.contains(t)){return e[i]}}return null},draw:function(e,t){var i,n,r,o,s,a;for(i=0,n=t.length;i<n;++i){r=t[i];o=r.$layout;if(o._visible){s=r.geometry();a=N(r._el,r.model(),s);o._box.update(a,s,r.rotation());r.draw(e,a)}}}};var e=function(e){if(b.isNullOrUndef(e)){return null}var t=e;var i,n,r;if(b.isObject(e)){if(!b.isNullOrUndef(e.label)){t=e.label}else if(!b.isNullOrUndef(e.r)){t=e.r}else{t="";i=Object.keys(e);for(r=0,n=i.length;r<n;++r){t+=(r!==0?", ":"")+i[r]+": "+e[i[r]]}}}return""+t};var n={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:false,clip:false,color:undefined,display:true,font:{family:undefined,lineHeight:1.2,size:undefined,style:undefined,weight:null},formatter:e,labels:undefined,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:undefined,textStrokeWidth:0,textShadowBlur:0,textShadowColor:undefined};var L="$datalabels";var P="$default";function H(e,t){var i=e.datalabels;var n={};var r=[];var o,s;if(i===false){return null}if(i===true){i={}}t=b.merge({},[t,i]);o=t.labels||{};s=Object.keys(o);delete t.labels;if(s.length){s.forEach(function(e){if(o[e]){r.push(b.merge({},[t,o[e],{_key:e}]))}})}else{r.push(t)}n=r.reduce(function(i,n){b.each(n.listeners||{},function(e,t){i[t]=i[t]||{};i[t][n._key||P]=e});delete n.listeners;return i},{});return{labels:r,listeners:n}}function F(e,t,i,n){if(!t){return}var r=i.$context;var o=i.$groups;var s;if(!t[o._set]){return}s=t[o._set][o._key];if(!s){return}if(b.callback(s,[r,n])===true){e[L]._dirty=true;i.update(r)}}function B(e,t,i,n,r){var o,s;if(!i&&!n){return}if(!i){o=true}else if(!n){s=true}else if(i!==n){s=o=true}if(s){F(e,t.leave,i,r)}if(o){F(e,t.enter,n,r)}}function V(e,t){var i=e[L];var n=i._listeners;var r,o;if(!n.enter&&!n.leave){return}if(t.type==="mousemove"){o=I.lookup(i._labels,t)}else if(t.type!=="mouseout"){return}r=i._hovered;i._hovered=o;B(e,n,r,o,t)}function j(e,t){var i=e[L];var n=i._listeners.click;var r=n&&I.lookup(i._labels,t);if(r){F(e,n,r,t)}}var z={id:"datalabels",defaults:n,beforeInit:function(e){e[L]={_actives:[]}},beforeUpdate:function(e){var t=e[L];t._listened=false;t._listeners={};t._datasets=[];t._labels=[]},afterDatasetUpdate:function(e,n,t){var i=n.index;var r=e[L];var o=r._datasets[i]=[];var s=e.isDatasetVisible(i);var a=e.data.datasets[i];var l=H(a,t);var c=n.meta.data||[];var u=e.ctx;var d,h,f,p,g,m,v,y;u.save();for(d=0,f=c.length;d<f;++d){v=c[d];v[L]=[];if(s&&v&&e.getDataVisibility(d)&&!v.skip){for(h=0,p=l.labels.length;h<p;++h){g=l.labels[h];m=g._key;y=new T(g,u,v,d);y.$groups={_set:i,_key:m||P};y.$context={active:false,chart:e,dataIndex:d,dataset:a,datasetIndex:i};y.update(y.$context);v[L].push(y);o.push(y)}}}u.restore();b.merge(r._listeners,l.listeners,{merger:function(e,t,i){t[e]=t[e]||{};t[e][n.index]=i[e];r._listened=true}})},afterUpdate:function(e){e[L]._labels=I.prepare(e[L]._datasets)},afterDatasetsDraw:function(e){I.draw(e,e[L]._labels)},beforeEvent:function(e,t){if(e[L]._listened){var i=t.event;switch(i.type){case"mousemove":case"mouseout":V(e,i);break;case"click":j(e,i);break}}},afterEvent:function(e){var t=e[L];var i=t._actives;var n=t._actives=e.getActiveElements();var r=h.arrayDiff(i,n);var o,s,a,l,c,u,d;for(o=0,s=r.length;o<s;++o){c=r[o];if(c[1]){d=c[0].element[L]||[];for(a=0,l=d.length;a<l;++a){u=d[a];u.$context.active=c[1]===1;u.update(u.$context)}}}if(t._dirty||r.length){I.update(t._labels);e.render()}delete t._dirty}};return z});!function(){var I={version:"3.5.5"};var g=[].slice,_=function(e){return g.call(e)};var L=this.document;function w(e){return e&&(e.ownerDocument||e.document||e).documentElement}function $(e){return e&&(e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView)}if(L){try{_(L.documentElement.childNodes)[0].nodeType}catch(e){_=function(e){var t=e.length,i=new Array(t);while(t--)i[t]=e[t];return i}}}if(!Date.now)Date.now=function(){return+new Date};if(L){try{L.createElement("DIV").style.setProperty("opacity",0,"")}catch(e){var x=this.Element.prototype,D=x.setAttribute,H=x.setAttributeNS,B=this.CSSStyleDeclaration.prototype,V=B.setProperty;x.setAttribute=function(e,t){D.call(this,e,t+"")};x.setAttributeNS=function(e,t,i){H.call(this,e,t,i+"")};B.setProperty=function(e,t,i){V.call(this,e,t+"",i)}}}I.ascending=j;function j(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}I.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN};I.min=function(e,t){var i=-1,n=e.length,r,o;if(arguments.length===1){while(++i<n)if((o=e[i])!=null&&o>=o){r=o;break}while(++i<n)if((o=e[i])!=null&&r>o)r=o}else{while(++i<n)if((o=t.call(e,e[i],i))!=null&&o>=o){r=o;break}while(++i<n)if((o=t.call(e,e[i],i))!=null&&r>o)r=o}return r};I.max=function(e,t){var i=-1,n=e.length,r,o;if(arguments.length===1){while(++i<n)if((o=e[i])!=null&&o>=o){r=o;break}while(++i<n)if((o=e[i])!=null&&o>r)r=o}else{while(++i<n)if((o=t.call(e,e[i],i))!=null&&o>=o){r=o;break}while(++i<n)if((o=t.call(e,e[i],i))!=null&&o>r)r=o}return r};I.extent=function(e,t){var i=-1,n=e.length,r,o,s;if(arguments.length===1){while(++i<n)if((o=e[i])!=null&&o>=o){r=s=o;break}while(++i<n)if((o=e[i])!=null){if(r>o)r=o;if(s<o)s=o}}else{while(++i<n)if((o=t.call(e,e[i],i))!=null&&o>=o){r=s=o;break}while(++i<n)if((o=t.call(e,e[i],i))!=null){if(r>o)r=o;if(s<o)s=o}}return[r,s]};function z(e){return e===null?NaN:+e}function c(e){return!isNaN(e)}I.sum=function(e,t){var i=0,n=e.length,r,o=-1;if(arguments.length===1){while(++o<n)if(c(r=+e[o]))i+=r}else{while(++o<n)if(c(r=+t.call(e,e[o],o)))i+=r}return i};I.mean=function(e,t){var i=0,n=e.length,r,o=-1,s=n;if(arguments.length===1){while(++o<n)if(c(r=z(e[o])))i+=r;else--s}else{while(++o<n)if(c(r=z(t.call(e,e[o],o))))i+=r;else--s}if(s)return i/s};I.quantile=function(e,t){var i=(e.length-1)*t+1,n=Math.floor(i),r=+e[n-1],o=i-n;return o?r+o*(e[n]-r):r};I.median=function(e,t){var i=[],n=e.length,r,o=-1;if(arguments.length===1){while(++o<n)if(c(r=z(e[o])))i.push(r)}else{while(++o<n)if(c(r=z(t.call(e,e[o],o))))i.push(r)}if(i.length)return I.quantile(i.sort(j),.5)};I.variance=function(e,t){var i=e.length,n=0,r,o,s=0,a=-1,l=0;if(arguments.length===1){while(++a<i){if(c(r=z(e[a]))){o=r-n;n+=o/++l;s+=o*(r-n)}}}else{while(++a<i){if(c(r=z(t.call(e,e[a],a)))){o=r-n;n+=o/++l;s+=o*(r-n)}}}if(l>1)return s/(l-1)};I.deviation=function(){var e=I.variance.apply(this,arguments);return e?Math.sqrt(e):e};function W(o){return{left:function(e,t,i,n){if(arguments.length<3)i=0;if(arguments.length<4)n=e.length;while(i<n){var r=i+n>>>1;if(o(e[r],t)<0)i=r+1;else n=r}return i},right:function(e,t,i,n){if(arguments.length<3)i=0;if(arguments.length<4)n=e.length;while(i<n){var r=i+n>>>1;if(o(e[r],t)>0)n=r;else i=r+1}return i}}}var q=W(j);I.bisectLeft=q.left;I.bisect=I.bisectRight=q.right;I.bisector=function(i){return W(i.length===1?function(e,t){return j(i(e),t)}:i)};I.shuffle=function(e,t,i){if((n=arguments.length)<3){i=e.length;if(n<2)t=0}var n=i-t,r,o;while(n){o=Math.random()*n--|0;r=e[n+t],e[n+t]=e[o+t],e[o+t]=r}return e};I.permute=function(e,t){var i=t.length,n=new Array(i);while(i--)n[i]=e[t[i]];return n};I.pairs=function(e){var t=0,i=e.length-1,n,r=e[0],o=new Array(i<0?0:i);while(t<i)o[t]=[n=r,r=e[++t]];return o};I.zip=function(){if(!(r=arguments.length))return[];for(var e=-1,t=I.min(arguments,K),i=new Array(t);++e<t;){for(var n=-1,r,o=i[e]=new Array(r);++n<r;){o[n]=arguments[n][e]}}return i};function K(e){return e.length}I.transpose=function(e){return I.zip.apply(I,e)};I.keys=function(e){var t=[];for(var i in e)t.push(i);return t};I.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t};I.entries=function(e){var t=[];for(var i in e)t.push({key:i,value:e[i]});return t};I.merge=function(e){var t=e.length,i,n=-1,r=0,o,s;while(++n<t)r+=e[n].length;o=new Array(r);while(--t>=0){s=e[t];i=s.length;while(--i>=0){o[--r]=s[i]}}return o};var N=Math.abs;I.range=function(e,t,i){if(arguments.length<3){i=1;if(arguments.length<2){t=e;e=0}}if((t-e)/i===Infinity)throw new Error("infinite range");var n=[],r=X(N(i)),o=-1,s;e*=r,t*=r,i*=r;if(i<0)while((s=e+i*++o)>t)n.push(s/r);else while((s=e+i*++o)<t)n.push(s/r);return n};function X(e){var t=1;while(e*t%1)t*=10;return t}function Z(e,t){for(var i in t){Object.defineProperty(e.prototype,i,{value:t[i],enumerable:false})}}I.map=function(e,t){var i=new y;if(e instanceof y){e.forEach(function(e,t){i.set(e,t)})}else if(Array.isArray(e)){var n=-1,r=e.length,o;if(arguments.length===1)while(++n<r)i.set(n,e[n]);else while(++n<r)i.set(t.call(e,o=e[n],n),o)}else{for(var s in e)i.set(s,e[s])}return i};function y(){this._=Object.create(null)}var Q="__proto__",J="\0";Z(y,{has:ie,get:function(e){return this._[ee(e)]},set:function(e,t){return this._[ee(e)]=t},remove:ne,keys:re,values:function(){var e=[];for(var t in this._)e.push(this._[t]);return e},entries:function(){var e=[];for(var t in this._)e.push({key:te(t),value:this._[t]});return e},size:oe,empty:se,forEach:function(e){for(var t in this._)e.call(this,te(t),this._[t])}});function ee(e){return(e+="")===Q||e[0]===J?J+e:e}function te(e){return(e+="")[0]===J?e.slice(1):e}function ie(e){return ee(e)in this._}function ne(e){return(e=ee(e))in this._&&delete this._[e]}function re(){var e=[];for(var t in this._)e.push(te(t));return e}function oe(){var e=0;for(var t in this._)++e;return e}function se(){for(var e in this._)return false;return true}I.nest=function(){var d={},h=[],t=[],f,p;function g(i,e,n){if(n>=h.length)return p?p.call(d,e):f?e.sort(f):e;var t=-1,r=e.length,o=h[n++],s,a,l,c=new y,u;while(++t<r){if(u=c.get(s=o(a=e[t]))){u.push(a)}else{c.set(s,[a])}}if(i){a=i();l=function(e,t){a.set(e,g(i,t,n))}}else{a={};l=function(e,t){a[e]=g(i,t,n)}}c.forEach(l);return a}function o(e,i){if(i>=h.length)return e;var n=[],r=t[i++];e.forEach(function(e,t){n.push({key:e,values:o(t,i)})});return r?n.sort(function(e,t){return r(e.key,t.key)}):n}d.map=function(e,t){return g(t,e,0)};d.entries=function(e){return o(g(I.map,e,0),0)};d.key=function(e){h.push(e);return d};d.sortKeys=function(e){t[h.length-1]=e;return d};d.sortValues=function(e){f=e;return d};d.rollup=function(e){p=e;return d};return d};I.set=function(e){var t=new ae;if(e)for(var i=0,n=e.length;i<n;++i)t.add(e[i]);return t};function ae(){this._=Object.create(null)}Z(ae,{has:ie,add:function(e){this._[ee(e+="")]=true;return e},remove:ne,values:re,size:oe,empty:se,forEach:function(e){for(var t in this._)e.call(this,te(t))}});I.behavior={};function P(e){return e}I.rebind=function(e,t){var i=1,n=arguments.length,r;while(++i<n)e[r=arguments[i]]=le(e,t,t[r]);return e};function le(t,i,n){return function(){var e=n.apply(i,arguments);return e===i?t:e}}function ce(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var i=0,n=ue.length;i<n;++i){var r=ue[i]+t;if(r in e)return r}}var ue=["webkit","ms","moz","Moz","o","O"];function u(){}I.dispatch=function(){var e=new de,t=-1,i=arguments.length;while(++t<i)e[arguments[t]]=he(e);return e};function de(){}de.prototype.on=function(e,t){var i=e.indexOf("."),n="";if(i>=0){n=e.slice(i+1);e=e.slice(0,i)}if(e)return arguments.length<2?this[e].on(n):this[e].on(n,t);if(arguments.length===2){if(t==null)for(e in this){if(this.hasOwnProperty(e))this[e].on(n,null)}return this}};function he(r){var o=[],s=new y;function e(){var e=o,t=-1,i=e.length,n;while(++t<i)if(n=e[t].on)n.apply(this,arguments);return r}e.on=function(e,t){var i=s.get(e),n;if(arguments.length<2)return i&&i.on;if(i){i.on=null;o=o.slice(0,n=o.indexOf(i)).concat(o.slice(n+1));s.remove(e)}if(t)o.push(s.set(e,{on:t}));return r};return e}I.event=null;function fe(){I.event.preventDefault()}function pe(){var e=I.event,t;while(t=e.sourceEvent)e=t;return e}function ge(r){var o=new de,e=0,t=arguments.length;while(++e<t)o[arguments[e]]=he(o);o.of=function(i,n){return function(e){try{var t=e.sourceEvent=I.event;e.target=r;I.event=e;o[e.type].apply(i,n)}finally{I.event=t}}};return o}I.requote=function(e){return e.replace(me,"\\$&")};var me=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;var ve={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)e[i]=t[i]};function ye(e){ve(e,i);return e}var be=function(e,t){return t.querySelector(e)},_e=function(e,t){return t.querySelectorAll(e)},we=function(e,t){var i=e.matches||e[ce(e,"matchesSelector")];we=function(e,t){return i.call(e,t)};return we(e,t)};if(typeof Sizzle==="function"){be=function(e,t){return Sizzle(e,t)[0]||null};_e=Sizzle;we=Sizzle.matchesSelector}I.selection=function(){return I.select(L.documentElement)};var i=I.selection.prototype=[];i.select=function(e){var t=[],i,n,r,o;e=Ce(e);for(var s=-1,a=this.length;++s<a;){t.push(i=[]);i.parentNode=(r=this[s]).parentNode;for(var l=-1,c=r.length;++l<c;){if(o=r[l]){i.push(n=e.call(o,o.__data__,l,s));if(n&&"__data__"in o)n.__data__=o.__data__}else{i.push(null)}}}return ye(t)};function Ce(e){return typeof e==="function"?e:function(){return be(e,this)}}i.selectAll=function(e){var t=[],i,n;e=xe(e);for(var r=-1,o=this.length;++r<o;){for(var s=this[r],a=-1,l=s.length;++a<l;){if(n=s[a]){t.push(i=_(e.call(n,n.__data__,a,r)));i.parentNode=n}}}return ye(t)};function xe(e){return typeof e==="function"?e:function(){return _e(e,this)}}var Se={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};I.ns={prefix:Se,qualify:function(e){var t=e.indexOf(":"),i=e;if(t>=0){i=e.slice(0,t);e=e.slice(t+1)}return Se.hasOwnProperty(i)?{space:Se[i],local:e}:e}};i.attr=function(e,t){if(arguments.length<2){if(typeof e==="string"){var i=this.node();e=I.ns.qualify(e);return e.local?i.getAttributeNS(e.space,e.local):i.getAttribute(e)}for(t in e)this.each(Ae(t,e[t]));return this}return this.each(Ae(e,t))};function Ae(t,i){t=I.ns.qualify(t);function e(){this.removeAttribute(t)}function n(){this.removeAttributeNS(t.space,t.local)}function r(){this.setAttribute(t,i)}function o(){this.setAttributeNS(t.space,t.local,i)}function s(){var e=i.apply(this,arguments);if(e==null)this.removeAttribute(t);else this.setAttribute(t,e)}function a(){var e=i.apply(this,arguments);if(e==null)this.removeAttributeNS(t.space,t.local);else this.setAttributeNS(t.space,t.local,e)}return i==null?t.local?n:e:typeof i==="function"?t.local?a:s:t.local?o:r}function Ee(e){return e.trim().replace(/\s+/g," ")}i.classed=function(e,t){if(arguments.length<2){if(typeof e==="string"){var i=this.node(),n=(e=De(e)).length,r=-1;if(t=i.classList){while(++r<n)if(!t.contains(e[r]))return false}else{t=i.getAttribute("class");while(++r<n)if(!Te(e[r]).test(t))return false}return true}for(t in e)this.each(Re(t,e[t]));return this}return this.each(Re(e,t))};function Te(e){return new RegExp("(?:^|\\s+)"+I.requote(e)+"(?:\\s+|$)","g")}function De(e){return(e+"").trim().split(/^|\s+/)}function Re(i,n){i=De(i).map(Me);var r=i.length;function e(){var e=-1;while(++e<r)i[e](this,n)}function t(){var e=-1,t=n.apply(this,arguments);while(++e<r)i[e](this,t)}return typeof n==="function"?t:e}function Me(n){var r=Te(n);return function(e,t){if(i=e.classList)return t?i.add(n):i.remove(n);var i=e.getAttribute("class")||"";if(t){r.lastIndex=0;if(!r.test(i))e.setAttribute("class",Ee(i+" "+n))}else{e.setAttribute("class",Ee(i.replace(r," ")))}}}i.style=function(e,t,i){var n=arguments.length;if(n<3){if(typeof e!=="string"){if(n<2)t="";for(i in e)this.each(ke(i,e[i],t));return this}if(n<2){var r=this.node();return $(r).getComputedStyle(r,null).getPropertyValue(e)}i=""}return this.each(ke(e,t,i))};function ke(t,i,n){function e(){this.style.removeProperty(t)}function r(){this.style.setProperty(t,i,n)}function o(){var e=i.apply(this,arguments);if(e==null)this.style.removeProperty(t);else this.style.setProperty(t,e,n)}return i==null?e:typeof i==="function"?o:r}i.property=function(e,t){if(arguments.length<2){if(typeof e==="string")return this.node()[e];for(t in e)this.each(Oe(t,e[t]));return this}return this.each(Oe(e,t))};function Oe(t,i){function e(){delete this[t]}function n(){this[t]=i}function r(){var e=i.apply(this,arguments);if(e==null)delete this[t];else this[t]=e}return i==null?e:typeof i==="function"?r:n}i.text=function(t){return arguments.length?this.each(typeof t==="function"?function(){var e=t.apply(this,arguments);this.textContent=e==null?"":e}:t==null?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent};i.html=function(t){return arguments.length?this.each(typeof t==="function"?function(){var e=t.apply(this,arguments);this.innerHTML=e==null?"":e}:t==null?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML};i.append=function(e){e=Ne(e);return this.select(function(){return this.appendChild(e.apply(this,arguments))})};function Ne(i){function e(){var e=this.ownerDocument,t=this.namespaceURI;return t?e.createElementNS(t,i):e.createElement(i)}function t(){return this.ownerDocument.createElementNS(i.space,i.local)}return typeof i==="function"?i:(i=I.ns.qualify(i)).local?t:e}i.insert=function(e,t){e=Ne(e);t=Ce(t);return this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)})};i.remove=function(){return this.each(Ie)};function Ie(){var e=this.parentNode;if(e)e.removeChild(this)}i.data=function(e,p){var t=-1,i=this.length,n,r;if(!arguments.length){e=new Array(i=(n=this[0]).length);while(++t<i){if(r=n[t]){e[t]=r.__data__}}return e}function o(e,t){var i,n=e.length,r=t.length,o=Math.min(n,r),s=new Array(r),a=new Array(r),l=new Array(n),c,u;if(p){var d=new y,h=new Array(n),f;for(i=-1;++i<n;){if(d.has(f=p.call(c=e[i],c.__data__,i))){l[i]=c}else{d.set(f,c)}h[i]=f}for(i=-1;++i<r;){if(!(c=d.get(f=p.call(t,u=t[i],i)))){a[i]=Le(u)}else if(c!==true){s[i]=c;c.__data__=u}d.set(f,true)}for(i=-1;++i<n;){if(d.get(h[i])!==true){l[i]=e[i]}}}else{for(i=-1;++i<o;){c=e[i];u=t[i];if(c){c.__data__=u;s[i]=c}else{a[i]=Le(u)}}for(;i<r;++i){a[i]=Le(t[i])}for(;i<n;++i){l[i]=e[i]}}a.update=s;a.parentNode=s.parentNode=l.parentNode=e.parentNode;g.push(a);m.push(s);v.push(l)}var g=Ge([]),m=ye([]),v=ye([]);if(typeof e==="function"){while(++t<i){o(n=this[t],e.call(n,n.parentNode.__data__,t))}}else{while(++t<i){o(n=this[t],e)}}m.enter=function(){return g};m.exit=function(){return v};return m};function Le(e){return{__data__:e}}i.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")};i.filter=function(e){var t=[],i,n,r;if(typeof e!=="function")e=Pe(e);for(var o=0,s=this.length;o<s;o++){t.push(i=[]);i.parentNode=(n=this[o]).parentNode;for(var a=0,l=n.length;a<l;a++){if((r=n[a])&&e.call(r,r.__data__,a,o)){i.push(r)}}}return ye(t)};function Pe(e){return function(){return we(this,e)}}i.order=function(){for(var e=-1,t=this.length;++e<t;){for(var i=this[e],n=i.length-1,r=i[n],o;--n>=0;){if(o=i[n]){if(r&&r!==o.nextSibling)r.parentNode.insertBefore(o,r);r=o}}}return this};i.sort=function(e){e=Fe.apply(this,arguments);for(var t=-1,i=this.length;++t<i;)this[t].sort(e);return this.order()};function Fe(i){if(!arguments.length)i=j;return function(e,t){return e&&t?i(e.__data__,t.__data__):!e-!t}}i.each=function(n){return l(this,function(e,t,i){n.call(e,e.__data__,t,i)})};function l(e,t){for(var i=0,n=e.length;i<n;i++){for(var r=e[i],o=0,s=r.length,a;o<s;o++){if(a=r[o])t(a,o,i)}}return e}i.call=function(e){var t=_(arguments);e.apply(t[0]=this,t);return this};i.empty=function(){return!this.node()};i.node=function(){for(var e=0,t=this.length;e<t;e++){for(var i=this[e],n=0,r=i.length;n<r;n++){var o=i[n];if(o)return o}}return null};i.size=function(){var e=0;l(this,function(){++e});return e};function Ge(e){ve(e,t);return e}var t=[];I.selection.enter=Ge;I.selection.enter.prototype=t;t.append=i.append;t.empty=i.empty;t.node=i.node;t.call=i.call;t.size=i.size;t.select=function(e){var t=[],i,n,r,o,s;for(var a=-1,l=this.length;++a<l;){r=(o=this[a]).update;t.push(i=[]);i.parentNode=o.parentNode;for(var c=-1,u=o.length;++c<u;){if(s=o[c]){i.push(r[c]=n=e.call(o.parentNode,s.__data__,c,a));n.__data__=s.__data__}else{i.push(null)}}}return ye(t)};t.insert=function(e,t){if(arguments.length<2)t=$e(this);return i.insert.call(this,e,t)};function $e(s){var a,l;return function(e,t,i){var n=s[i].update,r=n.length,o;if(i!=l)l=i,a=0;if(t>=a)a=t+1;while(!(o=n[a])&&++a<r);return o}}I.select=function(e){var t;if(typeof e==="string"){t=[be(e,L)];t.parentNode=L.documentElement}else{t=[e];t.parentNode=w(e)}return ye([t])};I.selectAll=function(e){var t;if(typeof e==="string"){t=_(_e(e,L));t.parentNode=L.documentElement}else{t=e;t.parentNode=null}return ye([t])};i.on=function(e,t,i){var n=arguments.length;if(n<3){if(typeof e!=="string"){if(n<2)t=false;for(i in e)this.each(He(i,e[i],t));return this}if(n<2)return(n=this.node()["__on"+e])&&n._;i=false}return this.each(He(e,t,i))};function He(r,t,i){var n="__on"+r,e=r.indexOf("."),o=Ve;if(e>0)r=r.slice(0,e);var s=Be.get(r);if(s)r=s,o=je;function a(){var e=this[n];if(e){this.removeEventListener(r,e,e.$);delete this[n]}}function l(){var e=o(t,_(arguments));a.call(this);this.addEventListener(r,this[n]=e,e.$=i);e._=t}function c(){var e=new RegExp("^__on([^.]+)"+I.requote(r)+"$"),t;for(var i in this){if(t=i.match(e)){var n=this[i];this.removeEventListener(t[1],n,n.$);delete this[i]}}}return e?t?l:a:t?u:c}var Be=I.map({mouseenter:"mouseover",mouseleave:"mouseout"});if(L){Be.forEach(function(e){if("on"+e in L)Be.remove(e)})}function Ve(i,n){return function(e){var t=I.event;I.event=e;n[0]=this.__data__;try{i.apply(this,n)}finally{I.event=t}}}function je(e,t){var n=Ve(e,t);return function(e){var t=this,i=e.relatedTarget;if(!i||i!==t&&!(i.compareDocumentPosition(t)&8)){n.call(t,e)}}}var ze,We=0;function Ue(e){var i=".dragsuppress-"+ ++We,n="click"+i,r=I.select($(e)).on("touchmove"+i,fe).on("dragstart"+i,fe).on("selectstart"+i,fe);if(ze==null){ze="onselectstart"in e?false:ce(e.style,"userSelect")}if(ze){var o=w(e).style,s=o[ze];o[ze]="none"}return function(e){r.on(i,null);if(ze)o[ze]=s;if(e){var t=function(){r.on(n,null)};r.on(n,function(){fe();t()},true);setTimeout(t,0)}}}I.mouse=function(e){return qe(e,pe())};var Ye=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function qe(e,t){if(t.changedTouches)t=t.changedTouches[0];var i=e.ownerSVGElement||e;if(i.createSVGPoint){var n=i.createSVGPoint();if(Ye<0){var r=$(e);if(r.scrollX||r.scrollY){i=I.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var o=i[0][0].getScreenCTM();Ye=!(o.f||o.e);i.remove()}}if(Ye)n.x=t.pageX,n.y=t.pageY;else n.x=t.clientX,n.y=t.clientY;n=n.matrixTransform(e.getScreenCTM().inverse());return[n.x,n.y]}var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}I.touch=function(e,t,i){if(arguments.length<3)i=t,t=pe().changedTouches;if(t)for(var n=0,r=t.length,o;n<r;++n){if((o=t[n]).identifier===i){return qe(e,o)}}};I.behavior.drag=function(){var y=ge(i,"drag","dragstart","dragend"),b=null,e=n(u,I.mouse,$,"mousemove","mouseup"),t=n(Ke,I.touch,P,"touchmove","touchend");function i(){this.on("mousedown.drag",e).on("touchstart.drag",t)}function n(f,p,g,m,v){return function(){var e=this,t=I.event.target,n=e.parentNode,r=y.of(e,arguments),o=0,s=f(),i=".drag"+(s==null?"":"-"+s),a,l=I.select(g(t)).on(m+i,d).on(v+i,h),c=Ue(t),u=p(n,s);if(b){a=b.apply(e,arguments);a=[a.x-u[0],a.y-u[1]]}else{a=[0,0]}r({type:"dragstart"});function d(){var e=p(n,s),t,i;if(!e)return;t=e[0]-u[0];i=e[1]-u[1];o|=t|i;u=e;r({type:"drag",x:e[0]+a[0],y:e[1]+a[1],dx:t,dy:i})}function h(){if(!p(n,s))return;l.on(m+i,null).on(v+i,null);c(o&&I.event.target===t);r({type:"dragend"})}}}i.origin=function(e){if(!arguments.length)return b;b=e;return i};return I.rebind(i,y,"on")};function Ke(){return I.event.changedTouches[0].identifier}I.touches=function(i,e){if(arguments.length<2)e=pe().touches;return e?_(e).map(function(e){var t=qe(i,e);t.identifier=e.identifier;return t}):[]};var F=1e-6,Xe=F*F,U=Math.PI,R=2*U,Ze=R-F,Y=U/2,S=U/180,A=180/U;function Qe(e){return e>0?1:e<0?-1:0}function Je(e,t,i){return(t[0]-e[0])*(i[1]-e[1])-(t[1]-e[1])*(i[0]-e[0])}function et(e){return e>1?0:e<-1?U:Math.acos(e)}function tt(e){return e>1?Y:e<-1?-Y:Math.asin(e)}function it(e){return((e=Math.exp(e))-1/e)/2}function nt(e){return((e=Math.exp(e))+1/e)/2}function rt(e){return((e=Math.exp(2*e))-1)/(e+1)}function ot(e){return(e=Math.sin(e/2))*e}var st=Math.SQRT2,at=2,lt=4;I.interpolateZoom=function(e,t){var r=e[0],o=e[1],s=e[2],i=t[0],n=t[1],a=t[2];var l=i-r,c=n-o,u=l*l+c*c,d=Math.sqrt(u),h=(a*a-s*s+lt*u)/(2*s*at*d),f=(a*a-s*s-lt*u)/(2*a*at*d),p=Math.log(Math.sqrt(h*h+1)-h),g=Math.log(Math.sqrt(f*f+1)-f),m=g-p,v=(m||Math.log(a/s))/st;function y(e){var t=e*v;if(m){var i=nt(p),n=s/(at*d)*(i*rt(st*t+p)-it(p));return[r+n*l,o+n*c,s*i/nt(st*t+p)]}return[r+e*l,o+e*c,s*Math.exp(st*t)]}y.duration=v*1e3;return y};I.behavior.zoom=function(){var _={x:0,y:0,k:1},t,l,i,c=[960,500],n=ct,r=250,o=0,a="mousedown.zoom",u="mousemove.zoom",d="mouseup.zoom",s,w="touchstart.zoom",C,x=ge(m,"zoomstart","zoom","zoomend"),h,f,p,g;if(!dt){dt="onwheel"in L?(ut=function(){return-I.event.deltaY*(I.event.deltaMode?120:1)},"wheel"):"onmousewheel"in L?(ut=function(){return I.event.wheelDelta},"mousewheel"):(ut=function(){return-I.event.detail},"MozMousePixelScroll")}function m(e){e.on(a,k).on(dt+".zoom",b).on("dblclick.zoom",N).on(w,O)}m.event=function(e){e.each(function(){var a=x.of(this,arguments),t=_;if(Sl){I.select(this).transition().each("start.zoom",function(){_=this.__chart__||{x:0,y:0,k:1};D(a)}).tween("zoom:zoom",function(){var n=c[0],e=c[1],r=l?l[0]:n/2,o=l?l[1]:e/2,s=I.interpolateZoom([(r-_.x)/_.k,(o-_.y)/_.k,n/_.k],[(r-t.x)/t.k,(o-t.y)/t.k,n/t.k]);return function(e){var t=s(e),i=n/t[2];this.__chart__=_={x:r-t[0]*i,y:o-t[1]*i,k:i};R(a)}}).each("interrupt.zoom",function(){M(a)}).each("end.zoom",function(){M(a)})}else{this.__chart__=_;D(a);R(a);M(a)}})};m.translate=function(e){if(!arguments.length)return[_.x,_.y];_={x:+e[0],y:+e[1],k:_.k};y();return m};m.scale=function(e){if(!arguments.length)return _.k;_={x:_.x,y:_.y,k:+e};y();return m};m.scaleExtent=function(e){if(!arguments.length)return n;n=e==null?ct:[+e[0],+e[1]];return m};m.center=function(e){if(!arguments.length)return i;i=e&&[+e[0],+e[1]];return m};m.size=function(e){if(!arguments.length)return c;c=e&&[+e[0],+e[1]];return m};m.duration=function(e){if(!arguments.length)return r;r=+e;return m};m.x=function(e){if(!arguments.length)return f;f=e;h=e.copy();_={x:0,y:0,k:1};return m};m.y=function(e){if(!arguments.length)return g;g=e;p=e.copy();_={x:0,y:0,k:1};return m};function S(e){return[(e[0]-_.x)/_.k,(e[1]-_.y)/_.k]}function v(e){return[e[0]*_.k+_.x,e[1]*_.k+_.y]}function A(e){_.k=Math.max(n[0],Math.min(n[1],e))}function E(e,t){t=v(t);_.x+=e[0]-t[0];_.y+=e[1]-t[1]}function T(e,t,i,n){e.__chart__={x:_.x,y:_.y,k:_.k};A(Math.pow(2,n));E(l=t,i);e=I.select(e);if(r>0)e=e.transition().duration(r);e.call(m.event)}function y(){if(f)f.domain(h.range().map(function(e){return(e-_.x)/_.k}).map(h.invert));if(g)g.domain(p.range().map(function(e){return(e-_.y)/_.k}).map(p.invert))}function D(e){if(!o++)e({type:"zoomstart"})}function R(e){y();e({type:"zoom",scale:_.k,translate:[_.x,_.y]})}function M(e){if(!--o)e({type:"zoomend"});l=null}function k(){var e=this,t=I.event.target,i=x.of(e,arguments),n=0,r=I.select($(e)).on(u,a).on(d,l),o=S(I.mouse(e)),s=Ue(e);_l.call(e);D(i);function a(){n=1;E(I.mouse(e),o);R(i)}function l(){r.on(u,null).on(d,null);s(n&&I.event.target===t);M(i)}}function O(){var u=this,c=x.of(u,arguments),d={},h=0,f,r=".zoom-"+I.event.changedTouches[0].identifier,p="touchmove"+r,g="touchend"+r,m=[],o=I.select(u),s=Ue(u);e();D(c);o.on(a,null).on(w,e);function v(){var e=I.touches(u);f=_.k;e.forEach(function(e){if(e.identifier in d)d[e.identifier]=S(e)});return e}function e(){var e=I.event.target;I.select(e).on(p,y).on(g,b);m.push(e);var t=I.event.changedTouches;for(var i=0,n=t.length;i<n;++i){d[t[i].identifier]=null}var r=v(),o=Date.now();if(r.length===1){if(o-C<500){var s=r[0];T(u,s,d[s.identifier],Math.floor(Math.log(_.k)/Math.LN2)+1);fe()}C=o}else if(r.length>1){var s=r[0],a=r[1],l=s[0]-a[0],c=s[1]-a[1];h=l*l+c*c}}function y(){var e=I.touches(u),t,i,n,r;_l.call(u);for(var o=0,s=e.length;o<s;++o,r=null){n=e[o];if(r=d[n.identifier]){if(i)break;t=n,i=r}}if(r){var a=(a=n[0]-t[0])*a+(a=n[1]-t[1])*a,l=h&&Math.sqrt(a/h);t=[(t[0]+n[0])/2,(t[1]+n[1])/2];i=[(i[0]+r[0])/2,(i[1]+r[1])/2];A(l*f)}C=null;E(t,i);R(c)}function b(){if(I.event.touches.length){var e=I.event.changedTouches;for(var t=0,i=e.length;t<i;++t){delete d[e[t].identifier]}for(var n in d){return void v()}}I.selectAll(m).on(r,null);o.on(a,k).on(w,O);s();M(c)}}function b(){var e=x.of(this,arguments);if(s)clearTimeout(s);else t=S(l=i||I.mouse(this)),_l.call(this),D(e);s=setTimeout(function(){s=null;M(e)},50);fe();A(Math.pow(2,ut()*.002)*_.k);E(l,t);R(e)}function N(){var e=I.mouse(this),t=Math.log(_.k)/Math.LN2;T(this,e,S(e),I.event.shiftKey?Math.ceil(t)-1:Math.floor(t)+1)}return I.rebind(m,x,"on")};var ct=[0,Infinity],ut,dt;I.color=ht;function ht(){}ht.prototype.toString=function(){return this.rgb()+""};I.hsl=d;function d(e,t,i){return this instanceof d?void(this.h=+e,this.s=+t,this.l=+i):arguments.length<2?e instanceof d?new d(e.h,e.s,e.l):kt(""+e,Ot,d):new d(e,t,i)}var ft=d.prototype=new ht;ft.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);return new d(this.h,this.s,this.l/e)};ft.darker=function(e){e=Math.pow(.7,arguments.length?e:1);return new d(this.h,this.s,e*this.l)};ft.rgb=function(){return pt(this.h,this.s,this.l)};function pt(e,t,i){var n,r;e=isNaN(e)?0:(e%=360)<0?e+360:e;t=isNaN(t)?0:t<0?0:t>1?1:t;i=i<0?0:i>1?1:i;r=i<=.5?i*(1+t):i+t-i*t;n=2*i-r;function o(e){if(e>360)e-=360;else if(e<0)e+=360;if(e<60)return n+(r-n)*e/60;if(e<180)return r;if(e<240)return n+(r-n)*(240-e)/60;return n}function s(e){return Math.round(o(e)*255)}return new a(s(e+120),s(e),s(e-120))}I.hcl=n;function n(e,t,i){return this instanceof n?void(this.h=+e,this.c=+t,this.l=+i):arguments.length<2?e instanceof n?new n(e.h,e.c,e.l):e instanceof s?xt(e.l,e.a,e.b):xt((e=Nt((e=I.rgb(e)).r,e.g,e.b)).l,e.a,e.b):new n(e,t,i)}var gt=n.prototype=new ht;gt.brighter=function(e){return new n(this.h,this.c,Math.min(100,this.l+vt*(arguments.length?e:1)))};gt.darker=function(e){return new n(this.h,this.c,Math.max(0,this.l-vt*(arguments.length?e:1)))};gt.rgb=function(){return mt(this.h,this.c,this.l).rgb()};function mt(e,t,i){if(isNaN(e))e=0;if(isNaN(t))t=0;return new s(i,Math.cos(e*=S)*t,Math.sin(e)*t)}I.lab=s;function s(e,t,i){return this instanceof s?void(this.l=+e,this.a=+t,this.b=+i):arguments.length<2?e instanceof s?new s(e.l,e.a,e.b):e instanceof n?mt(e.h,e.c,e.l):Nt((e=a(e)).r,e.g,e.b):new s(e,t,i)}var vt=18;var yt=.95047,bt=1,_t=1.08883;var wt=s.prototype=new ht;wt.brighter=function(e){return new s(Math.min(100,this.l+vt*(arguments.length?e:1)),this.a,this.b)};wt.darker=function(e){return new s(Math.max(0,this.l-vt*(arguments.length?e:1)),this.a,this.b)};wt.rgb=function(){return Ct(this.l,this.a,this.b)};function Ct(e,t,i){var n=(e+16)/116,r=n+t/500,o=n-i/200;r=St(r)*yt;n=St(n)*bt;o=St(o)*_t;return new a(Et(3.2404542*r-1.5371385*n-.4985314*o),Et(-.969266*r+1.8760108*n+.041556*o),Et(.0556434*r-.2040259*n+1.0572252*o))}function xt(e,t,i){return e>0?new n(Math.atan2(i,t)*A,Math.sqrt(t*t+i*i),e):new n(NaN,NaN,e)}function St(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function At(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function Et(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}I.rgb=a;function a(e,t,i){return this instanceof a?void(this.r=~~e,this.g=~~t,this.b=~~i):arguments.length<2?e instanceof a?new a(e.r,e.g,e.b):kt(""+e,a,pt):new a(e,t,i)}function Tt(e){return new a(e>>16,e>>8&255,e&255)}function Dt(e){return Tt(e)+""}var Rt=a.prototype=new ht;Rt.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,i=this.g,n=this.b,r=30;if(!t&&!i&&!n)return new a(r,r,r);if(t&&t<r)t=r;if(i&&i<r)i=r;if(n&&n<r)n=r;return new a(Math.min(255,t/e),Math.min(255,i/e),Math.min(255,n/e))};Rt.darker=function(e){e=Math.pow(.7,arguments.length?e:1);return new a(e*this.r,e*this.g,e*this.b)};Rt.hsl=function(){return Ot(this.r,this.g,this.b)};Rt.toString=function(){return"#"+Mt(this.r)+Mt(this.g)+Mt(this.b)};function Mt(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function kt(e,t,i){var n=0,r=0,o=0,s,a,l;s=/([a-z]+)\((.*)\)/i.exec(e);if(s){a=s[2].split(",");switch(s[1]){case"hsl":{return i(parseFloat(a[0]),parseFloat(a[1])/100,parseFloat(a[2])/100)}case"rgb":{return t(Lt(a[0]),Lt(a[1]),Lt(a[2]))}}}if(l=Pt.get(e.toLowerCase())){return t(l.r,l.g,l.b)}if(e!=null&&e.charAt(0)==="#"&&!isNaN(l=parseInt(e.slice(1),16))){if(e.length===4){n=(l&3840)>>4;n=n>>4|n;r=l&240;r=r>>4|r;o=l&15;o=o<<4|o}else if(e.length===7){n=(l&16711680)>>16;r=(l&65280)>>8;o=l&255}}return t(n,r,o)}function Ot(e,t,i){var n=Math.min(e/=255,t/=255,i/=255),r=Math.max(e,t,i),o=r-n,s,a,l=(r+n)/2;if(o){a=l<.5?o/(r+n):o/(2-r-n);if(e==r)s=(t-i)/o+(t<i?6:0);else if(t==r)s=(i-e)/o+2;else s=(e-t)/o+4;s*=60}else{s=NaN;a=l>0&&l<1?0:s}return new d(s,a,l)}function Nt(e,t,i){e=It(e);t=It(t);i=It(i);var n=At((.4124564*e+.3575761*t+.1804375*i)/yt),r=At((.2126729*e+.7151522*t+.072175*i)/bt),o=At((.0193339*e+.119192*t+.9503041*i)/_t);return s(116*r-16,500*(n-r),200*(r-o))}function It(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Lt(e){var t=parseFloat(e);return e.charAt(e.length-1)==="%"?Math.round(t*2.55):t}var Pt=I.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Pt.forEach(function(e,t){Pt.set(e,Tt(t))});function E(e){return typeof e==="function"?e:function(){return e}}I.functor=E;I.xhr=Ft(P);function Ft(n){return function(e,t,i){if(arguments.length===2&&typeof t==="function")i=t,t=null;return Gt(e,t,n,i)}}function Gt(r,o,i,e){var s={},a=I.dispatch("beforesend","progress","load","error"),l={},c=new XMLHttpRequest,u=null;if(this.XDomainRequest&&!("withCredentials"in c)&&/^(http(s)?:)?\/\//.test(r))c=new XDomainRequest;"onload"in c?c.onload=c.onerror=t:c.onreadystatechange=function(){c.readyState>3&&t()};function t(){var e=c.status,t;if(!e&&Ht(c)||e>=200&&e<300||e===304){try{t=i.call(s,c)}catch(e){a.error.call(s,e);return}a.load.call(s,t)}else{a.error.call(s,c)}}c.onprogress=function(e){var t=I.event;I.event=e;try{a.progress.call(s,c)}finally{I.event=t}};s.header=function(e,t){e=(e+"").toLowerCase();if(arguments.length<2)return l[e];if(t==null)delete l[e];else l[e]=t+"";return s};s.mimeType=function(e){if(!arguments.length)return o;o=e==null?null:e+"";return s};s.responseType=function(e){if(!arguments.length)return u;u=e;return s};s.response=function(e){i=e;return s};["get","post"].forEach(function(e){s[e]=function(){return s.send.apply(s,[e].concat(_(arguments)))}});s.send=function(e,t,i){if(arguments.length===2&&typeof t==="function")i=t,t=null;c.open(e,r,true);if(o!=null&&!("accept"in l))l["accept"]=o+",*/*";if(c.setRequestHeader)for(var n in l)c.setRequestHeader(n,l[n]);if(o!=null&&c.overrideMimeType)c.overrideMimeType(o);if(u!=null)c.responseType=u;if(i!=null)s.on("error",i).on("load",function(e){i(null,e)});a.beforesend.call(s,c);c.send(t==null?null:t);return s};s.abort=function(){c.abort();return s};I.rebind(s,a,"on");return e==null?s:s.get($t(e))}function $t(i){return i.length===1?function(e,t){i(e==null?t:null)}:i}function Ht(e){var t=e.responseType;return t&&t!=="text"?e.response:e.responseText}I.dsv=function(r,o){var t=new RegExp('["'+r+"\n]"),h=r.charCodeAt(0);function s(e,t,i){if(arguments.length<3)i=t,t=null;var n=Gt(e,o,t==null?a:l(t),i);n.row=function(e){return arguments.length?n.response((t=e)==null?a:l(e)):t};return n}function a(e){return s.parse(e.responseText)}function l(t){return function(e){return s.parse(e.responseText,t)}}s.parse=function(e,n){var r;return s.parseRows(e,function(e,t){if(r)return r(e,t-1);var i=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");r=n?function(e,t){return n(i(e),t)}:i})};s.parseRows=function(r,e){var o={},s={},t=[],a=r.length,l=0,i=0,n,c;function u(){if(l>=a)return s;if(c)return c=false,o;var e=l;if(r.charCodeAt(e)===34){var t=e;while(t++<a){if(r.charCodeAt(t)===34){if(r.charCodeAt(t+1)!==34)break;++t}}l=t+2;var i=r.charCodeAt(t+1);if(i===13){c=true;if(r.charCodeAt(t+2)===10)++l}else if(i===10){c=true}return r.slice(e+1,t).replace(/""/g,'"')}while(l<a){var i=r.charCodeAt(l++),n=1;if(i===10)c=true;else if(i===13){c=true;if(r.charCodeAt(l)===10)++l,++n}else if(i!==h)continue;return r.slice(e,l-n)}return r.slice(e)}while((n=u())!==s){var d=[];while(n!==o&&n!==s){d.push(n);n=u()}if(e&&(d=e(d,i++))==null)continue;t.push(d)}return t};s.format=function(e){if(Array.isArray(e[0]))return s.formatRows(e);var i=new ae,n=[];e.forEach(function(e){for(var t in e){if(!i.has(t)){n.push(i.add(t))}}});return[n.map(c).join(r)].concat(e.map(function(t){return n.map(function(e){return c(t[e])}).join(r)})).join("\n")};s.formatRows=function(e){return e.map(i).join("\n")};function i(e){return e.map(c).join(r)}function c(e){return t.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}return s};I.csv=I.dsv(",","text/csv");I.tsv=I.dsv(" ","text/tab-separated-values");var Bt,Vt,jt,zt,m,Wt=this[ce(this,"requestAnimationFrame")]||function(e){setTimeout(e,17)};I.timer=function(e,t,i){var n=arguments.length;if(n<2)t=0;if(n<3)i=Date.now();var r=i+t,o={c:e,t:r,f:false,n:null};if(Vt)Vt.n=o;else Bt=o;Vt=o;if(!jt){zt=clearTimeout(zt);jt=1;Wt(Ut)}};function Ut(){var e=Yt(),t=qt()-e;if(t>24){if(isFinite(t)){clearTimeout(zt);zt=setTimeout(Ut,t)}jt=0}else{jt=1;Wt(Ut)}}I.timer.flush=function(){Yt();qt()};function Yt(){var e=Date.now();m=Bt;while(m){if(e>=m.t)m.f=m.c(e-m.t);m=m.n}return e}function qt(){var e,t=Bt,i=Infinity;while(t){if(t.f){t=e?e.n=t.n:Bt=t.n}else{if(t.t<i)i=t.t;t=(e=t).n}}Vt=e;return i}function Kt(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)}I.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)};var Xt=["y","z","a","f","p","n","¬µ","m","","k","M","G","T","P","E","Z","Y"].map(Zt);I.formatPrefix=function(e,t){var i=0;if(e){if(e<0)e*=-1;if(t)e=I.round(e,Kt(e,t));i=1+Math.floor(1e-12+Math.log(e)/Math.LN10);i=Math.max(-24,Math.min(24,Math.floor((i-1)/3)*3))}return Xt[8+i/3]};function Zt(e,t){var i=Math.pow(10,N(8-t)*3);return{scale:t>8?function(e){return e/i}:function(e){return e*i},symbol:e}}function Qt(e){var S=e.decimal,a=e.thousands,l=e.grouping,n=e.currency,A=l&&a?function(e,t){var i=e.length,n=[],r=0,o=l[0],s=0;while(i>0&&o>0){if(s+o+1>t)o=Math.max(1,t-s);n.push(e.substring(i-=o,i+o));if((s+=o+1)>t)break;o=l[r=(r+1)%l.length]}return n.reverse().join(a)}:P;return function(e){var t=Jt.exec(e),u=t[1]||" ",d=t[2]||">",h=t[3]||"-",i=t[4]||"",f=t[5],p=+t[6],g=t[7],m=t[8],v=t[9],y=1,b="",_="",w=false,C=true;if(m)m=+m.substring(1);if(f||u==="0"&&d==="="){f=u="0";d="="}switch(v){case"n":g=true;v="g";break;case"%":y=100;_="%";v="f";break;case"p":y=100;_="%";v="r";break;case"b":case"o":case"x":case"X":if(i==="#")b="0"+v.toLowerCase();case"c":C=false;case"d":w=true;m=0;break;case"s":y=-1;v="r";break}if(i==="$")b=n[0],_=n[1];if(v=="r"&&!m)v="g";if(m!=null){if(v=="g")m=Math.max(1,Math.min(21,m));else if(v=="e"||v=="f")m=Math.max(0,Math.min(20,m))}v=ei.get(v)||ti;var x=f&&g;return function(e){var t=_;if(w&&e%1)return"";var i=e<0||e===0&&1/e<0?(e=-e,"-"):h==="-"?"":h;if(y<0){var n=I.formatPrefix(e,m);e=n.scale(e);t=n.symbol+_}else{e*=y}e=v(e,m);var r=e.lastIndexOf("."),o,s;if(r<0){var a=C?e.lastIndexOf("e"):-1;if(a<0)o=e,s="";else o=e.substring(0,a),s=e.substring(a)}else{o=e.substring(0,r);s=S+e.substring(r+1)}if(!f&&g)o=A(o,Infinity);var l=b.length+o.length+s.length+(x?0:i.length),c=l<p?new Array(l=p-l+1).join(u):"";if(x)o=A(c+o,c.length?p-s.length:Infinity);i+=b;e=o+s;return(d==="<"?i+e+c:d===">"?c+i+e:d==="^"?c.substring(0,l>>=1)+i+e+c.substring(l):i+(x?e:c+e))+t}}}var Jt=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i;var ei=I.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return(e=I.round(e,Kt(e,t))).toFixed(Math.max(0,Math.min(20,Kt(e*(1+1e-15),t))))}});function ti(e){return e+""}var M=I.time={},k=Date;function O(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}O.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){e.setUTCDate.apply(this._,arguments)},setDay:function(){e.setUTCDay.apply(this._,arguments)},setFullYear:function(){e.setUTCFullYear.apply(this._,arguments)},setHours:function(){e.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){e.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){e.setUTCMinutes.apply(this._,arguments)},setMonth:function(){e.setUTCMonth.apply(this._,arguments)},setSeconds:function(){e.setUTCSeconds.apply(this._,arguments)},setTime:function(){e.setTime.apply(this._,arguments)}};var e=Date.prototype;function ii(n,o,s){function e(e){var t=n(e),i=r(t,1);return e-t<i-e?t:i}function a(e){o(e=n(new k(e-1)),1);return e}function r(e,t){o(e=new k(+e),t);return e}function l(e,t,i){var n=a(e),r=[];if(i>1){while(n<t){if(!(s(n)%i))r.push(new Date(+n));o(n,1)}}else{while(n<t)r.push(new Date(+n)),o(n,1)}return r}function t(e,t,i){try{k=O;var n=new O;n._=e;return l(n,t,i)}finally{k=Date}}n.floor=n;n.round=e;n.ceil=a;n.offset=r;n.range=l;var i=n.utc=ni(n);i.floor=i;i.round=ni(e);i.ceil=ni(a);i.offset=ni(r);i.range=t;return n}function ni(n){return function(e,t){try{k=O;var i=new O;i._=e;return n(i,t)._}finally{k=Date}}}M.year=ii(function(e){e=M.day(e);e.setMonth(0,1);return e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()});M.years=M.year.range;M.years.utc=M.year.utc.range;M.day=ii(function(e){var t=new k(2e3,0);t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate());return t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1});M.days=M.day.range;M.days.utc=M.day.utc.range;M.dayOfYear=function(e){var t=M.year(e);return Math.floor((e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/864e5)};["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(e,i){i=7-i;var t=M[e]=ii(function(e){(e=M.day(e)).setDate(e.getDate()-(e.getDay()+i)%7);return e},function(e,t){e.setDate(e.getDate()+Math.floor(t)*7)},function(e){var t=M.year(e).getDay();return Math.floor((M.dayOfYear(e)+(t+i)%7)/7)-(t!==i)});M[e+"s"]=t.range;M[e+"s"].utc=t.utc.range;M[e+"OfYear"]=function(e){var t=M.year(e).getDay();return Math.floor((M.dayOfYear(e)+(t+i)%7)/7)}});M.week=M.sunday;M.weeks=M.sunday.range;M.weeks.utc=M.sunday.utc.range;M.weekOfYear=M.sundayOfYear;function ri(e){var t=e.dateTime,i=e.date,n=e.time,r=e.periods,o=e.days,s=e.shortDays,a=e.months,l=e.shortMonths;function c(a){var l=a.length;function e(e){var t=[],i=-1,n=0,r,o,s;while(++i<l){if(a.charCodeAt(i)===37){t.push(a.slice(n,i));if((o=oi[r=a.charAt(++i)])!=null)r=a.charAt(++i);if(s=_[r])r=s(e,o==null?r==="e"?" ":"0":o);t.push(r);n=i+1}}t.push(a.slice(n,i));return t.join("")}e.parse=function(e){var t={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},i=u(t,a,e,0);if(i!=e.length)return null;if("p"in t)t.H=t.H%12+t.p*12;var n=t.Z!=null&&k!==O,r=new(n?O:k);if("j"in t)r.setFullYear(t.y,0,t.j);else if("w"in t&&("W"in t||"U"in t)){r.setFullYear(t.y,0,1);r.setFullYear(t.y,0,"W"in t?(t.w+6)%7+t.W*7-(r.getDay()+5)%7:t.w+t.U*7-(r.getDay()+6)%7)}else r.setFullYear(t.y,t.m,t.d);r.setHours(t.H+(t.Z/100|0),t.M+t.Z%100,t.S,t.L);return n?r._:r};e.toString=function(){return a};return e}function u(e,t,i,n){var r,o,s,a=0,l=t.length,c=i.length;while(a<l){if(n>=c)return-1;r=t.charCodeAt(a++);if(r===37){s=t.charAt(a++);o=w[s in oi?t.charAt(a++):s];if(!o||(n=o(e,i,n))<0)return-1}else if(r!=i.charCodeAt(n++)){return-1}}return n}c.utc=function(e){var i=c(e);function t(e){try{k=O;var t=new k;t._=e;return i(t)}finally{k=Date}}t.parse=function(e){try{k=O;var t=i.parse(e);return t&&t._}finally{k=Date}};t.toString=i.toString;return t};c.multi=c.utc.multi=Ai;var d=I.map(),h=ai(o),f=li(o),p=ai(s),g=li(s),m=ai(a),v=li(a),y=ai(l),b=li(l);r.forEach(function(e,t){d.set(e.toLowerCase(),t)});var _={a:function(e){return s[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return a[e.getMonth()]},c:c(t),d:function(e,t){return G(e.getDate(),t,2)},e:function(e,t){return G(e.getDate(),t,2)},H:function(e,t){return G(e.getHours(),t,2)},I:function(e,t){return G(e.getHours()%12||12,t,2)},j:function(e,t){return G(1+M.dayOfYear(e),t,3)},L:function(e,t){return G(e.getMilliseconds(),t,3)},m:function(e,t){return G(e.getMonth()+1,t,2)},M:function(e,t){return G(e.getMinutes(),t,2)},p:function(e){return r[+(e.getHours()>=12)]},S:function(e,t){return G(e.getSeconds(),t,2)},U:function(e,t){return G(M.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return G(M.mondayOfYear(e),t,2)},x:c(i),X:c(n),y:function(e,t){return G(e.getFullYear()%100,t,2)},Y:function(e,t){return G(e.getFullYear()%1e4,t,4)},Z:xi,"%":function(){return"%"}};var w={a:C,A:x,b:S,B:A,c:E,d:vi,e:vi,H:bi,I:bi,j:yi,L:Ci,m:mi,M:_i,p:R,S:wi,U:ui,w:ci,W:di,x:T,X:D,y:fi,Y:hi,Z:pi,"%":Si};function C(e,t,i){p.lastIndex=0;var n=p.exec(t.slice(i));return n?(e.w=g.get(n[0].toLowerCase()),i+n[0].length):-1}function x(e,t,i){h.lastIndex=0;var n=h.exec(t.slice(i));return n?(e.w=f.get(n[0].toLowerCase()),i+n[0].length):-1}function S(e,t,i){y.lastIndex=0;var n=y.exec(t.slice(i));return n?(e.m=b.get(n[0].toLowerCase()),i+n[0].length):-1}function A(e,t,i){m.lastIndex=0;var n=m.exec(t.slice(i));return n?(e.m=v.get(n[0].toLowerCase()),i+n[0].length):-1}function E(e,t,i){return u(e,_.c.toString(),t,i)}function T(e,t,i){return u(e,_.x.toString(),t,i)}function D(e,t,i){return u(e,_.X.toString(),t,i)}function R(e,t,i){var n=d.get(t.slice(i,i+=2).toLowerCase());return n==null?-1:(e.p=n,i)}return c}var oi={"-":"",_:" ",0:"0"},r=/^\s*\d+/,si=/^%/;function G(e,t,i){var n=e<0?"-":"",r=(n?-e:e)+"",o=r.length;return n+(o<i?new Array(i-o+1).join(t)+r:r)}function ai(e){return new RegExp("^(?:"+e.map(I.requote).join("|")+")","i")}function li(e){var t=new y,i=-1,n=e.length;while(++i<n)t.set(e[i].toLowerCase(),i);return t}function ci(e,t,i){r.lastIndex=0;var n=r.exec(t.slice(i,i+1));return n?(e.w=+n[0],i+n[0].length):-1}function ui(e,t,i){r.lastIndex=0;var n=r.exec(t.slice(i));return n?(e.U=+n[0],i+n[0].length):-1}function di(e,t,i){r.lastIndex=0;var n=r.exec(t.slice(i));return n?(e.W=+n[0],i+n[0].length):-1}function hi(e,t,i){r.lastIndex=0;var n=r.exec(t.slice(i,i+4));return n?(e.y=+n[0],i+n[0].length):-1}function fi(e,t,i){r.lastIndex=0;var n=r.exec(t.slice(i,i+2));return n?(e.y=gi(+n[0]),i+n[0].length):-1}function pi(e,t,i){return/^[+-]\d{4}$/.test(t=t.slice(i,i+5))?(e.Z=-t,i+5):-1}function gi(e){return e+(e>68?1900:2e3)}function mi(e,t,i){r.lastIndex=0;var n=r.exec(t.slice(i,i+2));return n?(e.m=n[0]-1,i+n[0].length):-1}function vi(e,t,i){r.lastIndex=0;var n=r.exec(t.slice(i,i+2));return n?(e.d=+n[0],i+n[0].length):-1}function yi(e,t,i){r.lastIndex=0;var n=r.exec(t.slice(i,i+3));return n?(e.j=+n[0],i+n[0].length):-1}function bi(e,t,i){r.lastIndex=0;var n=r.exec(t.slice(i,i+2));return n?(e.H=+n[0],i+n[0].length):-1}function _i(e,t,i){r.lastIndex=0;var n=r.exec(t.slice(i,i+2));return n?(e.M=+n[0],i+n[0].length):-1}function wi(e,t,i){r.lastIndex=0;var n=r.exec(t.slice(i,i+2));return n?(e.S=+n[0],i+n[0].length):-1}function Ci(e,t,i){r.lastIndex=0;var n=r.exec(t.slice(i,i+3));return n?(e.L=+n[0],i+n[0].length):-1}function xi(e){var t=e.getTimezoneOffset(),i=t>0?"-":"+",n=N(t)/60|0,r=N(t)%60;return i+G(n,"0",2)+G(r,"0",2)}function Si(e,t,i){si.lastIndex=0;var n=si.exec(t.slice(i,i+1));return n?i+n[0].length:-1}function Ai(n){var e=n.length,t=-1;while(++t<e)n[t][0]=this(n[t][0]);return function(e){var t=0,i=n[t];while(!i[1](e))i=n[++t];return i[0](e)}}I.locale=function(e){return{numberFormat:Qt(e),timeFormat:ri(e)}};var Ei=I.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});I.format=Ei.numberFormat;I.geo={};function Ti(){}Ti.prototype={s:0,t:0,add:function(e){Ri(e,this.t,Di);Ri(Di.s,this.s,this);if(this.s)this.t+=Di.t;else this.s=Di.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var Di=new Ti;function Ri(e,t,i){var n=i.s=e+t,r=n-e,o=n-r;i.t=e-o+(t-r)}I.geo.stream=function(e,t){if(e&&ki.hasOwnProperty(e.type)){ki[e.type](e,t)}else{Mi(e,t)}};function Mi(e,t){if(e&&Oi.hasOwnProperty(e.type)){Oi[e.type](e,t)}}var ki={Feature:function(e,t){Mi(e.geometry,t)},FeatureCollection:function(e,t){var i=e.features,n=-1,r=i.length;while(++n<r)Mi(i[n].geometry,t)}};var Oi={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates;t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){var i=e.coordinates,n=-1,r=i.length;while(++n<r)e=i[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){Ni(e.coordinates,t,0)},MultiLineString:function(e,t){var i=e.coordinates,n=-1,r=i.length;while(++n<r)Ni(i[n],t,0)},Polygon:function(e,t){Ii(e.coordinates,t)},MultiPolygon:function(e,t){var i=e.coordinates,n=-1,r=i.length;while(++n<r)Ii(i[n],t)},GeometryCollection:function(e,t){var i=e.geometries,n=-1,r=i.length;while(++n<r)Mi(i[n],t)}};function Ni(e,t,i){var n=-1,r=e.length-i,o;t.lineStart();while(++n<r)o=e[n],t.point(o[0],o[1],o[2]);t.lineEnd()}function Ii(e,t){var i=-1,n=e.length;t.polygonStart();while(++i<n)Ni(e[i],t,1);t.polygonEnd()}I.geo.area=function(e){Li=0;I.geo.stream(e,C);return Li};var Li,Pi=new Ti;var C={sphere:function(){Li+=4*U},point:u,lineStart:u,lineEnd:u,polygonStart:function(){Pi.reset();C.lineStart=Fi},polygonEnd:function(){var e=2*Pi;Li+=e<0?4*U+e:e;C.lineStart=C.lineEnd=C.point=u}};function Fi(){var i,n,u,d,h;C.point=function(e,t){C.point=r;u=(i=e)*S,d=Math.cos(t=(n=t)*S/2+U/4),h=Math.sin(t)};function r(e,t){e*=S;t=t*S/2+U/4;var i=e-u,n=i>=0?1:-1,r=n*i,o=Math.cos(t),s=Math.sin(t),a=h*s,l=d*o+a*Math.cos(r),c=a*n*Math.sin(r);Pi.add(Math.atan2(c,l));u=e,d=o,h=s}C.lineEnd=function(){r(i,n)}}function Gi(e){var t=e[0],i=e[1],n=Math.cos(i);return[n*Math.cos(t),n*Math.sin(t),Math.sin(i)]}function $i(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Hi(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Bi(e,t){e[0]+=t[0];e[1]+=t[1];e[2]+=t[2]}function Vi(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function ji(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t;e[1]/=t;e[2]/=t}function zi(e){return[Math.atan2(e[1],e[0]),tt(e[2])]}function Wi(e,t){return N(e[0]-t[0])<F&&N(e[1]-t[1])<F}I.geo.bounds=function(){var d,h,f,p,g,n,r,m,o,l,c;var u={point:v,lineStart:e,lineEnd:t,polygonStart:function(){u.point=i;u.lineStart=a;u.lineEnd=y;o=0;C.polygonStart()},polygonEnd:function(){C.polygonEnd();u.point=v;u.lineStart=e;u.lineEnd=t;if(Pi<0)d=-(f=180),h=-(p=90);else if(o>F)p=90;else if(o<-F)h=-90;c[0]=d,c[1]=f}};function v(e,t){l.push(c=[d=e,f=e]);if(t<h)h=t;if(t>p)p=t}function s(e,t){var i=Gi([e*S,t*S]);if(m){var n=Hi(m,i),r=[n[1],-n[0],0],o=Hi(r,n);ji(o);o=zi(o);var s=e-g,a=s>0?1:-1,l=o[0]*A*a,c=N(s)>180;if(c^(a*g<l&&l<a*e)){var u=o[1]*A;if(u>p)p=u}else if(l=(l+360)%360-180,c^(a*g<l&&l<a*e)){var u=-o[1]*A;if(u<h)h=u}else{if(t<h)h=t;if(t>p)p=t}if(c){if(e<g){if(b(d,e)>b(d,f))f=e}else{if(b(e,f)>b(d,f))d=e}}else{if(f>=d){if(e<d)d=e;if(e>f)f=e}else{if(e>g){if(b(d,e)>b(d,f))f=e}else{if(b(e,f)>b(d,f))d=e}}}}else{v(e,t)}m=i,g=e}function e(){u.point=s}function t(){c[0]=d,c[1]=f;u.point=v;m=null}function i(e,t){if(m){var i=e-g;o+=N(i)>180?i+(i>0?360:-360):i}else n=e,r=t;C.point(e,t);s(e,t)}function a(){C.lineStart()}function y(){i(n,r);C.lineEnd();if(N(o)>F)d=-(f=180);c[0]=d,c[1]=f;m=null}function b(e,t){return(t-=e)<0?t+360:t}function _(e,t){return e[0]-t[0]}function w(e,t){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}return function(e){p=f=-(d=h=Infinity);l=[];I.geo.stream(e,u);var t=l.length;if(t){l.sort(_);for(var i=1,n=l[0],r,o=[n];i<t;++i){r=l[i];if(w(r[0],n)||w(r[1],n)){if(b(n[0],r[1])>b(n[0],n[1]))n[1]=r[1];if(b(r[0],n[1])>b(n[0],n[1]))n[0]=r[0]}else{o.push(n=r)}}var s=-Infinity,a;for(var t=o.length-1,i=0,n=o[t],r;i<=t;n=r,++i){r=o[i];if((a=b(n[1],r[0]))>s)s=a,d=r[0],f=n[1]}}l=c=null;return d===Infinity||h===Infinity?[[NaN,NaN],[NaN,NaN]]:[[d,h],[f,p]]}}();I.geo.centroid=function(e){Ui=Yi=qi=Ki=Xi=Zi=Qi=v=Ji=en=tn=0;I.geo.stream(e,h);var t=Ji,i=en,n=tn,r=t*t+i*i+n*n;if(r<Xe){t=Zi,i=Qi,n=v;if(Yi<F)t=qi,i=Ki,n=Xi;r=t*t+i*i+n*n;if(r<Xe)return[NaN,NaN]}return[Math.atan2(i,t)*A,tt(n/Math.sqrt(r))*A]};var Ui,Yi,qi,Ki,Xi,Zi,Qi,v,Ji,en,tn;var h={sphere:u,point:nn,lineStart:on,lineEnd:sn,polygonStart:function(){h.lineStart=an},polygonEnd:function(){h.lineStart=on}};function nn(e,t){e*=S;var i=Math.cos(t*=S);rn(i*Math.cos(e),i*Math.sin(e),Math.sin(t))}function rn(e,t,i){++Ui;qi+=(e-qi)/Ui;Ki+=(t-Ki)/Ui;Xi+=(i-Xi)/Ui}function on(){var a,l,c;h.point=function(e,t){e*=S;var i=Math.cos(t*=S);a=i*Math.cos(e);l=i*Math.sin(e);c=Math.sin(t);h.point=n;rn(a,l,c)};function n(e,t){e*=S;var i=Math.cos(t*=S),n=i*Math.cos(e),r=i*Math.sin(e),o=Math.sin(t),s=Math.atan2(Math.sqrt((s=l*o-c*r)*s+(s=c*n-a*o)*s+(s=a*r-l*n)*s),a*n+l*r+c*o);Yi+=s;Zi+=s*(a+(a=n));Qi+=s*(l+(l=r));v+=s*(c+(c=o));rn(a,l,c)}}function sn(){h.point=nn}function an(){var n,r,f,p,g;h.point=function(e,t){n=e,r=t;h.point=o;e*=S;var i=Math.cos(t*=S);f=i*Math.cos(e);p=i*Math.sin(e);g=Math.sin(t);rn(f,p,g)};h.lineEnd=function(){o(n,r);h.lineEnd=sn;h.point=nn};function o(e,t){e*=S;var i=Math.cos(t*=S),n=i*Math.cos(e),r=i*Math.sin(e),o=Math.sin(t),s=p*o-g*r,a=g*n-f*o,l=f*r-p*n,c=Math.sqrt(s*s+a*a+l*l),u=f*n+p*r+g*o,d=c&&-et(u)/c,h=Math.atan2(c,u);Ji+=d*s;en+=d*a;tn+=d*l;Yi+=h;Zi+=h*(f+(f=n));Qi+=h*(p+(p=r));v+=h*(g+(g=o));rn(f,p,g)}}function ln(i,n){function e(e,t){return e=i(e,t),n(e[0],e[1])}if(i.invert&&n.invert)e.invert=function(e,t){return e=n.invert(e,t),e&&i.invert(e[0],e[1])};return e}function cn(){return true}function un(e,t,i,n,a){var l=[],c=[];e.forEach(function(e){if((t=e.length-1)<=0)return;var t,i=e[0],n=e[t];if(Wi(i,n)){a.lineStart();for(var r=0;r<t;++r)a.point((i=e[r])[0],i[1]);a.lineEnd();return}var o=new hn(i,e,null,true),s=new hn(i,null,o,false);o.o=s;l.push(o);c.push(s);o=new hn(n,e,null,false);s=new hn(n,null,o,true);o.o=s;l.push(o);c.push(s)});c.sort(t);dn(l);dn(c);if(!l.length)return;for(var r=0,o=i,s=c.length;r<s;++r){c[r].e=o=!o}var u=l[0],d,h;while(1){var f=u,p=true;while(f.v)if((f=f.n)===u)return;d=f.z;a.lineStart();do{f.v=f.o.v=true;if(f.e){if(p){for(var r=0,s=d.length;r<s;++r)a.point((h=d[r])[0],h[1])}else{n(f.x,f.n.x,1,a)}f=f.n}else{if(p){d=f.p.z;for(var r=d.length-1;r>=0;--r)a.point((h=d[r])[0],h[1])}else{n(f.x,f.p.x,-1,a)}f=f.p}f=f.o;d=f.z;p=!p}while(!f.v);a.lineEnd()}}function dn(e){if(!(t=e.length))return;var t,i=0,n=e[0],r;while(++i<t){n.n=r=e[i];r.p=n;n=r}n.n=r=e[0];r.p=n}function hn(e,t,i,n){this.x=e;this.z=t;this.o=i;this.e=n;this.v=false;this.n=this.p=null}function fn(y,b,_,w){return function(n,s){var r=b(s),t=n.invert(w[0],w[1]);var i={point:o,lineStart:a,lineEnd:l,polygonStart:function(){i.point=g;i.lineStart=m;i.lineEnd=v;c=[];f=[]},polygonEnd:function(){i.point=o;i.lineStart=a;i.lineEnd=l;c=I.merge(c);var e=wn(t,f);if(c.length){if(!h)s.polygonStart(),h=true;un(c,mn,e,_,s)}else if(e){if(!h)s.polygonStart(),h=true;s.lineStart();_(null,null,1,s);s.lineEnd()}if(h)s.polygonEnd(),h=false;c=f=null},sphere:function(){s.polygonStart();s.lineStart();_(null,null,1,s);s.lineEnd();s.polygonEnd()}};function o(e,t){var i=n(e,t);if(y(e=i[0],t=i[1]))s.point(e,t)}function e(e,t){var i=n(e,t);r.point(i[0],i[1])}function a(){i.point=e;r.lineStart()}function l(){i.point=o;r.lineEnd()}var c;var u=gn(),d=b(u),h=false,f,p;function g(e,t){p.push([e,t]);var i=n(e,t);d.point(i[0],i[1])}function m(){d.lineStart();p=[]}function v(){g(p[0][0],p[0][1]);d.lineEnd();var e=d.clean(),t=u.buffer(),i,n=t.length;p.pop();f.push(p);p=null;if(!n)return;if(e&1){i=t[0];var n=i.length-1,r=-1,o;if(n>0){if(!h)s.polygonStart(),h=true;s.lineStart();while(++r<n)s.point((o=i[r])[0],o[1]);s.lineEnd()}return}if(n>1&&e&2)t.push(t.pop().concat(t.shift()));c.push(t.filter(pn))}return i}}function pn(e){return e.length>1}function gn(){var t=[],i;return{lineStart:function(){t.push(i=[])},point:function(e,t){i.push([e,t])},lineEnd:u,buffer:function(){var e=t;t=[];i=null;return e},rejoin:function(){if(t.length>1)t.push(t.pop().concat(t.shift()))}}}function mn(e,t){return((e=e.x)[0]<0?e[1]-Y-F:Y-e[1])-((t=t.x)[0]<0?t[1]-Y-F:Y-t[1])}var vn=fn(cn,yn,_n,[-U,-U/2]);function yn(r){var o=NaN,s=NaN,a=NaN,l;return{lineStart:function(){r.lineStart();l=1},point:function(e,t){var i=e>0?U:-U,n=N(e-o);if(N(n-U)<F){r.point(o,s=(s+t)/2>0?Y:-Y);r.point(a,s);r.lineEnd();r.lineStart();r.point(i,s);r.point(e,s);l=0}else if(a!==i&&n>=U){if(N(o-a)<F)o-=a*F;if(N(e-i)<F)e-=i*F;s=bn(o,s,e,t);r.point(a,s);r.lineEnd();r.lineStart();r.point(i,s);l=0}r.point(o=e,s=t);a=i},lineEnd:function(){r.lineEnd();o=s=NaN},clean:function(){return 2-l}}}function bn(e,t,i,n){var r,o,s=Math.sin(e-i);return N(s)>F?Math.atan((Math.sin(t)*(o=Math.cos(n))*Math.sin(i)-Math.sin(n)*(r=Math.cos(t))*Math.sin(e))/(r*o*s)):(t+n)/2}function _n(e,t,i,n){var r;if(e==null){r=i*Y;n.point(-U,r);n.point(0,r);n.point(U,r);n.point(U,0);n.point(U,-r);n.point(0,-r);n.point(-U,-r);n.point(-U,0);n.point(-U,r)}else if(N(e[0]-t[0])>F){var o=e[0]<t[0]?U:-U;r=i*o/2;n.point(-o,r);n.point(0,r);n.point(o,r)}else{n.point(t[0],t[1])}}function wn(e,t){var i=e[0],n=e[1],r=[Math.sin(i),-Math.cos(i),0],o=0,s=0;Pi.reset();for(var a=0,l=t.length;a<l;++a){var c=t[a],u=c.length;if(!u)continue;var d=c[0],h=d[0],f=d[1]/2+U/4,p=Math.sin(f),g=Math.cos(f),m=1;while(true){if(m===u)m=0;e=c[m];var v=e[0],y=e[1]/2+U/4,b=Math.sin(y),_=Math.cos(y),w=v-h,C=w>=0?1:-1,x=C*w,S=x>U,A=p*b;Pi.add(Math.atan2(A*C*Math.sin(x),g*_+A*Math.cos(x)));o+=S?w+C*R:w;if(S^h>=i^v>=i){var E=Hi(Gi(d),Gi(e));ji(E);var T=Hi(r,E);ji(T);var D=(S^w>=0?-1:1)*tt(T[2]);if(n>D||n===D&&(E[0]||E[1])){s+=S^w>=0?1:-1}}if(!m++)break;h=v,p=b,g=_,d=e}}return(o<-F||o<F&&Pi<0)^s&1}function Cn(r){var M=Math.cos(r),f=M>0,p=N(M)>F,e=rr(r,6*S);return fn(g,t,e,f?[0,-r]:[-U,r-U]);function g(e,t){return Math.cos(e)*Math.cos(t)>M}function t(a){var l,c,u,d,h;return{lineStart:function(){d=u=false;h=1},point:function(e,t){var i=[e,t],n,r=g(e,t),o=f?r?0:v(e,t):r?v(e+(e<0?U:-U),t):0;if(!l&&(d=u=r))a.lineStart();if(r!==u){n=m(l,i);if(Wi(l,n)||Wi(i,n)){i[0]+=F;i[1]+=F;r=g(i[0],i[1])}}if(r!==u){h=0;if(r){a.lineStart();n=m(i,l);a.point(n[0],n[1])}else{n=m(l,i);a.point(n[0],n[1]);a.lineEnd()}l=n}else if(p&&l&&f^r){var s;if(!(o&c)&&(s=m(i,l,true))){h=0;if(f){a.lineStart();a.point(s[0][0],s[0][1]);a.point(s[1][0],s[1][1]);a.lineEnd()}else{a.point(s[1][0],s[1][1]);a.lineEnd();a.lineStart();a.point(s[0][0],s[0][1])}}}if(r&&(!l||!Wi(l,i))){a.point(i[0],i[1])}l=i,u=r,c=o},lineEnd:function(){if(u)a.lineEnd();l=null},clean:function(){return h|(d&&u)<<1}}}function m(e,t,i){var n=Gi(e),r=Gi(t);var o=[1,0,0],s=Hi(n,r),a=$i(s,s),l=s[0],c=a-l*l;if(!c)return!i&&e;var u=M*a/c,d=-M*l/c,h=Hi(o,s),f=Vi(o,u),p=Vi(s,d);Bi(f,p);var g=h,m=$i(f,g),v=$i(g,g),y=m*m-v*($i(f,f)-1);if(y<0)return;var b=Math.sqrt(y),_=Vi(g,(-m-b)/v);Bi(_,f);_=zi(_);if(!i)return _;var w=e[0],C=t[0],x=e[1],S=t[1],A;if(C<w)A=w,w=C,C=A;var E=C-w,T=N(E-U)<F,D=T||E<F;if(!T&&S<x)A=x,x=S,S=A;if(D?T?x+S>0^_[1]<(N(_[0]-w)<F?x:S):x<=_[1]&&_[1]<=S:E>U^(w<=_[0]&&_[0]<=C)){var R=Vi(g,(-m+b)/v);Bi(R,f);return[_,zi(R)]}}function v(e,t){var i=f?r:U-r,n=0;if(e<-i)n|=1;else if(e>i)n|=2;if(t<-i)n|=4;else if(t>i)n|=8;return n}}function xn(h,f,p,g){return function(e){var t=e.a,i=e.b,n=t.x,r=t.y,o=i.x,s=i.y,a=0,l=1,c=o-n,u=s-r,d;d=h-n;if(!c&&d>0)return;d/=c;if(c<0){if(d<a)return;if(d<l)l=d}else if(c>0){if(d>l)return;if(d>a)a=d}d=p-n;if(!c&&d<0)return;d/=c;if(c<0){if(d>l)return;if(d>a)a=d}else if(c>0){if(d<a)return;if(d<l)l=d}d=f-r;if(!u&&d>0)return;d/=u;if(u<0){if(d<a)return;if(d<l)l=d}else if(u>0){if(d>l)return;if(d>a)a=d}d=g-r;if(!u&&d<0)return;d/=u;if(u<0){if(d>l)return;if(d>a)a=d}else if(u>0){if(d<a)return;if(d<l)l=d}if(a>0)e.a={x:n+a*c,y:r+a*u};if(l<1)e.b={x:n+l*c,y:r+l*u};return e}}var Sn=1e9;I.geo.clipExtent=function(){var t,i,n,r,o,s,a={stream:function(e){if(o)o.valid=false;o=s(e);o.valid=true;return o},extent:function(e){if(!arguments.length)return[[t,i],[n,r]];s=An(t=+e[0][0],i=+e[0][1],n=+e[1][0],r=+e[1][1]);if(o)o.valid=false,o=null;return a}};return a.extent([[0,0],[960,500]])};function An(x,S,A,E){return function(r){var n=r,e=gn(),o=xn(x,S,A,E),s,u,a;var t={point:i,lineStart:_,lineEnd:w,polygonStart:function(){r=e;s=[];u=[];b=true},polygonEnd:function(){r=n;s=I.merge(s);var e=l([x,E]),t=b&&e,i=s.length;if(t||i){r.polygonStart();if(t){r.lineStart();c(null,null,1,r);r.lineEnd()}if(i){un(s,D,e,c,r)}r.polygonEnd()}s=u=a=null}};function l(e){var t=0,i=u.length,n=e[1];for(var r=0;r<i;++r){for(var o=1,s=u[r],a=s.length,l=s[0],c;o<a;++o){c=s[o];if(l[1]<=n){if(c[1]>n&&Je(l,c,e)>0)++t}else{if(c[1]<=n&&Je(l,c,e)<0)--t}l=c}}return t!==0}function c(e,t,i,n){var r=0,o=0;if(e==null||(r=T(e,i))!==(o=T(t,i))||R(e,t)<0^i>0){do{n.point(r===0||r===3?x:A,r>1?E:S)}while((r=(r+i+4)%4)!==o)}else{n.point(t[0],t[1])}}function d(e,t){return x<=e&&e<=A&&S<=t&&t<=E}function i(e,t){if(d(e,t))r.point(e,t)}var h,f,p,g,m,v,y,b;function _(){t.point=C;if(u)u.push(a=[]);y=true;v=false;g=m=NaN}function w(){if(s){C(h,f);if(p&&v)e.rejoin();s.push(e.buffer())}t.point=i;if(v)r.lineEnd()}function C(e,t){e=Math.max(-Sn,Math.min(Sn,e));t=Math.max(-Sn,Math.min(Sn,t));var i=d(e,t);if(u)a.push([e,t]);if(y){h=e,f=t,p=i;y=false;if(i){r.lineStart();r.point(e,t)}}else{if(i&&v)r.point(e,t);else{var n={a:{x:g,y:m},b:{x:e,y:t}};if(o(n)){if(!v){r.lineStart();r.point(n.a.x,n.a.y)}r.point(n.b.x,n.b.y);if(!i)r.lineEnd();b=false}else if(i){r.lineStart();r.point(e,t);b=false}}}g=e,m=t,v=i}return t};function T(e,t){return N(e[0]-x)<F?t>0?0:3:N(e[0]-A)<F?t>0?2:1:N(e[1]-S)<F?t>0?1:0:t>0?3:2}function D(e,t){return R(e.x,t.x)}function R(e,t){var i=T(e,1),n=T(t,1);return i!==n?i-n:i===0?t[1]-e[1]:i===1?e[0]-t[0]:i===2?e[1]-t[1]:t[0]-e[0]}}function En(e){var t=0,i=U/3,n=Xn(e),r=n(t,i);r.parallels=function(e){if(!arguments.length)return[t/U*180,i/U*180];return n(t=e[0]*U/180,i=e[1]*U/180)};return r}function Tn(e,t){var i=Math.sin(e),n=(i+Math.sin(t))/2,r=1+i*(2*n-i),o=Math.sqrt(r)/n;function s(e,t){var i=Math.sqrt(r-2*n*Math.sin(t))/n;return[i*Math.sin(e*=n),o-i*Math.cos(e)]}s.invert=function(e,t){var i=o-t;return[Math.atan2(e,i)/n,tt((r-(e*e+i*i)*n*n)/(2*n))]};return s}(I.geo.conicEqualArea=function(){return En(Tn)}).raw=Tn;I.geo.albers=function(){return I.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)};I.geo.albersUsa=function(){var o=I.geo.albers();var s=I.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]);var a=I.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]);var n,r={point:function(e,t){n=[e,t]}},l,c,u;function d(e){var t=e[0],i=e[1];n=null;(l(t,i),n)||(c(t,i),n)||u(t,i);return n}d.invert=function(e){var t=o.scale(),i=o.translate(),n=(e[0]-i[0])/t,r=(e[1]-i[1])/t;return(r>=.12&&r<.234&&n>=-.425&&n<-.214?s:r>=.166&&r<.234&&n>=-.214&&n<-.115?a:o).invert(e)};d.stream=function(e){var i=o.stream(e),n=s.stream(e),r=a.stream(e);return{point:function(e,t){i.point(e,t);n.point(e,t);r.point(e,t)},sphere:function(){i.sphere();n.sphere();r.sphere()},lineStart:function(){i.lineStart();n.lineStart();r.lineStart()},lineEnd:function(){i.lineEnd();n.lineEnd();r.lineEnd()},polygonStart:function(){i.polygonStart();n.polygonStart();r.polygonStart()},polygonEnd:function(){i.polygonEnd();n.polygonEnd();r.polygonEnd()}}};d.precision=function(e){if(!arguments.length)return o.precision();o.precision(e);s.precision(e);a.precision(e);return d};d.scale=function(e){if(!arguments.length)return o.scale();o.scale(e);s.scale(e*.35);a.scale(e);return d.translate(o.translate())};d.translate=function(e){if(!arguments.length)return o.translate();var t=o.scale(),i=+e[0],n=+e[1];l=o.translate(e).clipExtent([[i-.455*t,n-.238*t],[i+.455*t,n+.238*t]]).stream(r).point;c=s.translate([i-.307*t,n+.201*t]).clipExtent([[i-.425*t+F,n+.12*t+F],[i-.214*t-F,n+.234*t-F]]).stream(r).point;u=a.translate([i-.205*t,n+.212*t]).clipExtent([[i-.214*t+F,n+.166*t+F],[i-.115*t-F,n+.234*t-F]]).stream(r).point;return d};return d.scale(1070)};var Dn,Rn,Mn={point:u,lineStart:u,lineEnd:u,polygonStart:function(){Rn=0;Mn.lineStart=kn},polygonEnd:function(){Mn.lineStart=Mn.lineEnd=Mn.point=u;Dn+=N(Rn/2)}};function kn(){var i,n,r,o;Mn.point=function(e,t){Mn.point=s;i=r=e,n=o=t};function s(e,t){Rn+=o*e-r*t;r=e,o=t}Mn.lineEnd=function(){s(i,n)}}var On,Nn,In,Ln;var Pn={point:Fn,lineStart:u,lineEnd:u,polygonStart:u,polygonEnd:u};function Fn(e,t){if(e<On)On=e;if(e>In)In=e;if(t<Nn)Nn=t;if(t>Ln)Ln=t}function Gn(){var i=$n(4.5),n=[];var r={point:e,lineStart:function(){r.point=t},lineEnd:s,polygonStart:function(){r.lineEnd=a},polygonEnd:function(){r.lineEnd=s;r.point=e},pointRadius:function(e){i=$n(e);return r},result:function(){if(n.length){var e=n.join("");n=[];return e}}};function e(e,t){n.push("M",e,",",t,i)}function t(e,t){n.push("M",e,",",t);r.point=o}function o(e,t){n.push("L",e,",",t)}function s(){r.point=e}function a(){n.push("Z")}return r}function $n(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}var f={point:Hn,lineStart:Bn,lineEnd:Vn,polygonStart:function(){f.lineStart=jn},polygonEnd:function(){f.point=Hn;f.lineStart=Bn;f.lineEnd=Vn}};function Hn(e,t){qi+=e;Ki+=t;++Xi}function Bn(){var o,s;f.point=function(e,t){f.point=i;Hn(o=e,s=t)};function i(e,t){var i=e-o,n=t-s,r=Math.sqrt(i*i+n*n);Zi+=r*(o+e)/2;Qi+=r*(s+t)/2;v+=r;Hn(o=e,s=t)}}function Vn(){f.point=Hn}function jn(){var i,n,o,s;f.point=function(e,t){f.point=r;Hn(i=o=e,n=s=t)};function r(e,t){var i=e-o,n=t-s,r=Math.sqrt(i*i+n*n);Zi+=r*(o+e)/2;Qi+=r*(s+t)/2;v+=r;r=s*e-o*t;Ji+=r*(o+e);en+=r*(s+t);tn+=r*3;Hn(o=e,s=t)}f.lineEnd=function(){r(i,n)}}function zn(i){var n=4.5;var r={point:e,lineStart:function(){r.point=t},lineEnd:s,polygonStart:function(){r.lineEnd=a},polygonEnd:function(){r.lineEnd=s;r.point=e},pointRadius:function(e){n=e;return r},result:u};function e(e,t){i.moveTo(e+n,t);i.arc(e,t,n,0,R)}function t(e,t){i.moveTo(e,t);r.point=o}function o(e,t){i.lineTo(e,t)}function s(){r.point=e}function a(){i.closePath()}return r}function Wn(R){var M=.5,k=Math.cos(30*S),C=16;function t(e){return(C?n:i)(e)}function i(i){return qn(i,function(e,t){e=R(e,t);i.point(e[0],e[1])})}function n(r){var i,n,o,s,a,l,c,u,d,h,f,p,g;var m={point:e,lineStart:t,lineEnd:y,polygonStart:function(){r.polygonStart();m.lineStart=b},polygonEnd:function(){r.polygonEnd();m.lineStart=t}};function e(e,t){e=R(e,t);r.point(e[0],e[1])}function t(){d=NaN;m.point=v;r.lineStart()}function v(e,t){var i=Gi([e,t]),n=R(e,t);O(d,h,u,f,p,g,d=n[0],h=n[1],u=e,f=i[0],p=i[1],g=i[2],C,r);r.point(d,h)}function y(){m.point=e;r.lineEnd()}function b(){t();m.point=_;m.lineEnd=w}function _(e,t){v(i=e,n=t),o=d,s=h,a=f,l=p,c=g;m.point=v}function w(){O(d,h,u,f,p,g,o,s,i,a,l,c,C,r);m.lineEnd=y;y()}return m}function O(e,t,i,n,r,o,s,a,l,c,u,d,h,f){var p=s-e,g=a-t,m=p*p+g*g;if(m>4*M&&h--){var v=n+c,y=r+u,b=o+d,_=Math.sqrt(v*v+y*y+b*b),w=Math.asin(b/=_),C=N(N(b)-1)<F||N(i-l)<F?(i+l)/2:Math.atan2(y,v),x=R(C,w),S=x[0],A=x[1],E=S-e,T=A-t,D=g*E-p*T;if(D*D/m>M||N((p*E+g*T)/m-.5)>.3||n*c+r*u+o*d<k){O(e,t,i,n,r,o,S,A,C,v/=_,y/=_,b,h,f);f.point(S,A);O(S,A,C,v,y,b,s,a,l,c,u,d,h,f)}}}t.precision=function(e){if(!arguments.length)return Math.sqrt(M);C=(M=e*e)>0&&16;return t};return t}I.geo.path=function(){var t=4.5,i,n,r,o,s;function a(e){if(e){if(typeof t==="function")o.pointRadius(+t.apply(this,arguments));if(!s||!s.valid)s=r(o);I.geo.stream(e,s)}return o.result()}a.area=function(e){Dn=0;I.geo.stream(e,r(Mn));return Dn};a.centroid=function(e){qi=Ki=Xi=Zi=Qi=v=Ji=en=tn=0;I.geo.stream(e,r(f));return tn?[Ji/tn,en/tn]:v?[Zi/v,Qi/v]:Xi?[qi/Xi,Ki/Xi]:[NaN,NaN]};a.bounds=function(e){In=Ln=-(On=Nn=Infinity);I.geo.stream(e,r(Pn));return[[On,Nn],[In,Ln]]};a.projection=function(e){if(!arguments.length)return i;r=(i=e)?e.stream||Un(e):P;return l()};a.context=function(e){if(!arguments.length)return n;o=(n=e)==null?new Gn:new zn(e);if(typeof t!=="function")o.pointRadius(t);return l()};a.pointRadius=function(e){if(!arguments.length)return t;t=typeof e==="function"?e:(o.pointRadius(+e),+e);return a};function l(){s=null;return a}return a.projection(I.geo.albersUsa()).context(null)};function Un(i){var t=Wn(function(e,t){return i([e*A,t*A])});return function(e){return Zn(t(e))}}I.geo.transform=function(n){return{stream:function(e){var t=new Yn(e);for(var i in n)t[i]=n[i];return t}}};function Yn(e){this.stream=e}Yn.prototype={point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function qn(e,t){return{point:t,sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}I.geo.projection=Kn;I.geo.projectionMutator=Xn;function Kn(e){return Xn(function(){return e})()}function Xn(e){var i,t,n,r=Wn(function(e,t){e=i(e,t);return[e[0]*o+f,p-e[1]*o]}),o=150,s=480,a=250,l=0,c=0,u=0,d=0,h=0,f,p,g=vn,m=P,v=null,y=null,b;function _(e){e=n(e[0]*S,e[1]*S);return[e[0]*o+f,p-e[1]*o]}function w(e){e=n.invert((e[0]-f)/o,(p-e[1])/o);return e&&[e[0]*A,e[1]*A]}_.stream=function(e){if(b)b.valid=false;b=Zn(g(t,r(m(e))));b.valid=true;return b};_.clipAngle=function(e){if(!arguments.length)return v;g=e==null?(v=e,vn):Cn((v=+e)*S);return x()};_.clipExtent=function(e){if(!arguments.length)return y;y=e;m=e?An(e[0][0],e[0][1],e[1][0],e[1][1]):P;return x()};_.scale=function(e){if(!arguments.length)return o;o=+e;return C()};_.translate=function(e){if(!arguments.length)return[s,a];s=+e[0];a=+e[1];return C()};_.center=function(e){if(!arguments.length)return[l*A,c*A];l=e[0]%360*S;c=e[1]%360*S;return C()};_.rotate=function(e){if(!arguments.length)return[u*A,d*A,h*A];u=e[0]%360*S;d=e[1]%360*S;h=e.length>2?e[2]%360*S:0;return C()};I.rebind(_,r,"precision");function C(){n=ln(t=er(u,d,h),i);var e=i(l,c);f=s-e[0]*o;p=a+e[1]*o;return x()}function x(){if(b)b.valid=false,b=null;return _}return function(){i=e.apply(this,arguments);_.invert=i.invert&&w;return C()}}function Zn(i){return qn(i,function(e,t){i.point(e*S,t*S)})}function Qn(e,t){return[e,t]}(I.geo.equirectangular=function(){return Kn(Qn)}).raw=Qn.invert=Qn;I.geo.rotation=function(t){t=er(t[0]%360*S,t[1]*S,t.length>2?t[2]*S:0);function e(e){e=t(e[0]*S,e[1]*S);return e[0]*=A,e[1]*=A,e}e.invert=function(e){e=t.invert(e[0]*S,e[1]*S);return e[0]*=A,e[1]*=A,e};return e};function Jn(e,t){return[e>U?e-R:e<-U?e+R:e,t]}Jn.invert=Qn;function er(e,t,i){return e?t||i?ln(ir(e),nr(t,i)):ir(e):t||i?nr(t,i):Jn}function tr(i){return function(e,t){return e+=i,[e>U?e-R:e<-U?e+R:e,t]}}function ir(e){var t=tr(e);t.invert=tr(-e);return t}function nr(e,t){var a=Math.cos(e),l=Math.sin(e),c=Math.cos(t),u=Math.sin(t);function i(e,t){var i=Math.cos(t),n=Math.cos(e)*i,r=Math.sin(e)*i,o=Math.sin(t),s=o*a+n*l;return[Math.atan2(r*c-s*u,n*a-o*l),tt(s*c+r*u)]}i.invert=function(e,t){var i=Math.cos(t),n=Math.cos(e)*i,r=Math.sin(e)*i,o=Math.sin(t),s=o*c-r*u;return[Math.atan2(r*c+o*u,n*a+s*l),tt(s*a-n*l)]};return i}I.geo.circle=function(){var t=[0,0],i,n=6,r;function o(){var e=typeof t==="function"?t.apply(this,arguments):t,i=er(-e[0]*S,-e[1]*S,0).invert,n=[];r(null,null,1,{point:function(e,t){n.push(e=i(e,t));e[0]*=A,e[1]*=A}});return{type:"Polygon",coordinates:[n]}}o.origin=function(e){if(!arguments.length)return t;t=e;return o};o.angle=function(e){if(!arguments.length)return i;r=rr((i=+e)*S,n*S);return o};o.precision=function(e){if(!arguments.length)return n;r=rr(i*S,(n=+e)*S);return o};return o.angle(90)};function rr(a,l){var c=Math.cos(a),u=Math.sin(a);return function(e,t,i,n){var r=i*l;if(e!=null){e=or(c,e);t=or(c,t);if(i>0?e<t:e>t)e+=i*R}else{e=a+i*R;t=a-.5*r}for(var o,s=e;i>0?s>t:s<t;s-=r){n.point((o=zi([c,-u*Math.cos(s),-u*Math.sin(s)]))[0],o[1])}}}function or(e,t){var i=Gi(t);i[0]-=e;ji(i);var n=et(-i[1]);return((-i[2]<0?-n:n)+2*Math.PI-F)%(2*Math.PI)}I.geo.distance=function(e,t){var i=(t[0]-e[0])*S,n=e[1]*S,r=t[1]*S,o=Math.sin(i),s=Math.cos(i),a=Math.sin(n),l=Math.cos(n),c=Math.sin(r),u=Math.cos(r),d;return Math.atan2(Math.sqrt((d=u*o)*d+(d=l*c-a*u*s)*d),a*c+l*u*s)};I.geo.graticule=function(){var t,i,n,r,o,s,a,l,c=10,u=c,d=90,h=360,f,p,g,m,v=2.5;function y(){return{type:"MultiLineString",coordinates:e()}}function e(){return I.range(Math.ceil(r/d)*d,n,d).map(g).concat(I.range(Math.ceil(l/h)*h,a,h).map(m)).concat(I.range(Math.ceil(i/c)*c,t,c).filter(function(e){return N(e%d)>F}).map(f)).concat(I.range(Math.ceil(s/u)*u,o,u).filter(function(e){return N(e%h)>F}).map(p))}y.lines=function(){return e().map(function(e){return{type:"LineString",coordinates:e}})};y.outline=function(){return{type:"Polygon",coordinates:[g(r).concat(m(a).slice(1),g(n).reverse().slice(1),m(l).reverse().slice(1))]}};y.extent=function(e){if(!arguments.length)return y.minorExtent();return y.majorExtent(e).minorExtent(e)};y.majorExtent=function(e){if(!arguments.length)return[[r,l],[n,a]];r=+e[0][0],n=+e[1][0];l=+e[0][1],a=+e[1][1];if(r>n)e=r,r=n,n=e;if(l>a)e=l,l=a,a=e;return y.precision(v)};y.minorExtent=function(e){if(!arguments.length)return[[i,s],[t,o]];i=+e[0][0],t=+e[1][0];s=+e[0][1],o=+e[1][1];if(i>t)e=i,i=t,t=e;if(s>o)e=s,s=o,o=e;return y.precision(v)};y.step=function(e){if(!arguments.length)return y.minorStep();return y.majorStep(e).minorStep(e)};y.majorStep=function(e){if(!arguments.length)return[d,h];d=+e[0],h=+e[1];return y};y.minorStep=function(e){if(!arguments.length)return[c,u];c=+e[0],u=+e[1];return y};y.precision=function(e){if(!arguments.length)return v;v=+e;f=sr(s,o,90);p=ar(i,t,v);g=sr(l,a,90);m=ar(r,n,v);return y};return y.majorExtent([[-180,-90+F],[180,90-F]]).minorExtent([[-180,-80-F],[180,80+F]])};function sr(e,t,i){var n=I.range(e,t-F,i).concat(t);return function(t){return n.map(function(e){return[t,e]})}}function ar(e,t,i){var n=I.range(e,t-F,i).concat(t);return function(t){return n.map(function(e){return[e,t]})}}function lr(e){return e.source}function cr(e){return e.target}I.geo.greatArc=function(){var t=lr,i,n=cr,r;function o(){return{type:"LineString",coordinates:[i||t.apply(this,arguments),r||n.apply(this,arguments)]}}o.distance=function(){return I.geo.distance(i||t.apply(this,arguments),r||n.apply(this,arguments))};o.source=function(e){if(!arguments.length)return t;t=e,i=typeof e==="function"?null:e;return o};o.target=function(e){if(!arguments.length)return n;n=e,r=typeof e==="function"?null:e;return o};o.precision=function(){return arguments.length?o:0};return o};I.geo.interpolate=function(e,t){return ur(e[0]*S,e[1]*S,t[0]*S,t[1]*S)};function ur(e,t,i,n){var r=Math.cos(t),s=Math.sin(t),o=Math.cos(n),a=Math.sin(n),l=r*Math.cos(e),c=r*Math.sin(e),u=o*Math.cos(i),d=o*Math.sin(i),h=2*Math.asin(Math.sqrt(ot(n-t)+r*o*ot(i-e))),f=1/Math.sin(h);var p=h?function(e){var t=Math.sin(e*=h)*f,i=Math.sin(h-e)*f,n=i*l+t*u,r=i*c+t*d,o=i*s+t*a;return[Math.atan2(r,n)*A,Math.atan2(o,Math.sqrt(n*n+r*r))*A]}:function(){return[e*A,t*A]};p.distance=h;return p}I.geo.length=function(e){dr=0;I.geo.stream(e,hr);return dr};var dr;var hr={sphere:u,point:u,lineStart:fr,lineEnd:u,polygonStart:u,polygonEnd:u};function fr(){var s,a,l;hr.point=function(e,t){s=e*S,a=Math.sin(t*=S),l=Math.cos(t);hr.point=i};hr.lineEnd=function(){hr.point=hr.lineEnd=u};function i(e,t){var i=Math.sin(t*=S),n=Math.cos(t),r=N((e*=S)-s),o=Math.cos(r);dr+=Math.atan2(Math.sqrt((r=n*Math.sin(r))*r+(r=l*i-a*n*o)*r),a*i+l*n*o);s=e,a=i,l=n}}function pr(o,s){function e(e,t){var i=Math.cos(e),n=Math.cos(t),r=o(i*n);return[r*n*Math.sin(e),r*Math.sin(t)]}e.invert=function(e,t){var i=Math.sqrt(e*e+t*t),n=s(i),r=Math.sin(n),o=Math.cos(n);return[Math.atan2(e*r,i*o),Math.asin(i&&t*r/i)]};return e}var gr=pr(function(e){return Math.sqrt(2/(1+e))},function(e){return 2*Math.asin(e/2)});(I.geo.azimuthalEqualArea=function(){return Kn(gr)}).raw=gr;var mr=pr(function(e){var t=Math.acos(e);return t&&t/Math.sin(t)},P);(I.geo.azimuthalEquidistant=function(){return Kn(mr)}).raw=mr;function vr(e,t){var i=Math.cos(e),n=function(e){return Math.tan(U/4+e/2)},r=e===t?Math.sin(e):Math.log(i/Math.cos(t))/Math.log(n(t)/n(e)),o=i*Math.pow(n(e),r)/r;if(!r)return _r;function s(e,t){if(o>0){if(t<-Y+F)t=-Y+F}else{if(t>Y-F)t=Y-F}var i=o/Math.pow(n(t),r);return[i*Math.sin(r*e),o-i*Math.cos(r*e)]}s.invert=function(e,t){var i=o-t,n=Qe(r)*Math.sqrt(e*e+i*i);return[Math.atan2(e,i)/r,2*Math.atan(Math.pow(o/n,1/r))-Y]};return s}(I.geo.conicConformal=function(){return En(vr)}).raw=vr;function yr(e,t){var i=Math.cos(e),n=e===t?Math.sin(e):(i-Math.cos(t))/(t-e),r=i/n+e;if(N(n)<F)return Qn;function o(e,t){var i=r-t;return[i*Math.sin(n*e),r-i*Math.cos(n*e)]}o.invert=function(e,t){var i=r-t;return[Math.atan2(e,i)/n,r-Qe(n)*Math.sqrt(e*e+i*i)]};return o}(I.geo.conicEquidistant=function(){return En(yr)}).raw=yr;var br=pr(function(e){return 1/e},Math.atan);(I.geo.gnomonic=function(){return Kn(br)}).raw=br;function _r(e,t){return[e,Math.log(Math.tan(U/4+t/2))]}_r.invert=function(e,t){return[e,2*Math.atan(Math.exp(t))-Y]};function wr(e){var r=Kn(e),o=r.scale,s=r.translate,a=r.clipExtent,l;r.scale=function(){var e=o.apply(r,arguments);return e===r?l?r.clipExtent(null):r:e};r.translate=function(){var e=s.apply(r,arguments);return e===r?l?r.clipExtent(null):r:e};r.clipExtent=function(e){var t=a.apply(r,arguments);if(t===r){if(l=e==null){var i=U*o(),n=s();a([[n[0]-i,n[1]-i],[n[0]+i,n[1]+i]])}}else if(l){t=null}return t};return r.clipExtent(null)}(I.geo.mercator=function(){return wr(_r)}).raw=_r;var Cr=pr(function(){return 1},Math.asin);(I.geo.orthographic=function(){return Kn(Cr)}).raw=Cr;var xr=pr(function(e){return 1/(1+e)},function(e){return 2*Math.atan(e)});(I.geo.stereographic=function(){return Kn(xr)}).raw=xr;function Sr(e,t){return[Math.log(Math.tan(U/4+t/2)),-e]}Sr.invert=function(e,t){return[-t,2*Math.atan(Math.exp(e))-Y]};(I.geo.transverseMercator=function(){var e=wr(Sr),t=e.center,i=e.rotate;e.center=function(e){return e?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])};e.rotate=function(e){return e?i([e[0],e[1],e.length>2?e[2]+90:90]):(e=i(),[e[0],e[1],e[2]-90])};return i([0,0,90])}).raw=Sr;I.geom={};function Ar(e){return e[0]}function Er(e){return e[1]}I.geom.hull=function(e){var h=Ar,f=Er;if(arguments.length)return t(e);function t(e){if(e.length<3)return[];var t=E(h),i=E(f),n,r=e.length,o=[],s=[];for(n=0;n<r;n++){o.push([+t.call(this,e[n],n),+i.call(this,e[n],n),n])}o.sort(Dr);for(n=0;n<r;n++)s.push([o[n][0],-o[n][1]]);var a=Tr(o),l=Tr(s);var c=l[0]===a[0],u=l[l.length-1]===a[a.length-1],d=[];for(n=a.length-1;n>=0;--n)d.push(e[o[a[n]][2]]);for(n=+c;n<l.length-u;++n)d.push(e[o[l[n]][2]]);return d}t.x=function(e){return arguments.length?(h=e,t):h};t.y=function(e){return arguments.length?(f=e,t):f};return t};function Tr(e){var t=e.length,i=[0,1],n=2;for(var r=2;r<t;r++){while(n>1&&Je(e[i[n-2]],e[i[n-1]],e[r])<=0)--n;i[n++]=r}return i.slice(0,n)}function Dr(e,t){return e[0]-t[0]||e[1]-t[1]}I.geom.polygon=function(e){ve(e,Rr);return e};var Rr=I.geom.polygon.prototype=[];Rr.area=function(){var e=-1,t=this.length,i,n=this[t-1],r=0;while(++e<t){i=n;n=this[e];r+=i[1]*n[0]-i[0]*n[1]}return r*.5};Rr.centroid=function(e){var t=-1,i=this.length,n=0,r=0,o,s=this[i-1],a;if(!arguments.length)e=-1/(6*this.area());while(++t<i){o=s;s=this[t];a=o[0]*s[1]-s[0]*o[1];n+=(o[0]+s[0])*a;r+=(o[1]+s[1])*a}return[n*e,r*e]};Rr.clip=function(e){var t,i=Or(e),n=-1,r=this.length-Or(this),o,s,a=this[r-1],l,c,u;while(++n<r){t=e.slice();e.length=0;l=this[n];c=t[(s=t.length-i)-1];o=-1;while(++o<s){u=t[o];if(Mr(u,a,l)){if(!Mr(c,a,l)){e.push(kr(c,u,a,l))}e.push(u)}else if(Mr(c,a,l)){e.push(kr(c,u,a,l))}c=u}if(i)e.push(e[0]);a=l}return e};function Mr(e,t,i){return(i[0]-t[0])*(e[1]-t[1])<(i[1]-t[1])*(e[0]-t[0])}function kr(e,t,i,n){var r=e[0],o=i[0],s=t[0]-r,a=n[0]-o,l=e[1],c=i[1],u=t[1]-l,d=n[1]-c,h=(a*(l-c)-d*(r-o))/(d*s-a*u);return[r+h*s,l+h*u]}function Or(e){var t=e[0],i=e[e.length-1];return!(t[0]-i[0]||t[1]-i[1])}var Nr,Ir,Lr,Pr=[],Fr,Gr,$r=[];function Hr(){ao(this);this.edge=this.site=this.circle=null}function Br(e){var t=Pr.pop()||new Hr;t.site=e;return t}function Vr(e){Qr(e);Lr.remove(e);Pr.push(e);ao(e)}function jr(e){var t=e.circle,i=t.x,n=t.cy,r={x:i,y:n},o=e.P,s=e.N,a=[e];Vr(e);var l=o;while(l.circle&&N(i-l.circle.x)<F&&N(n-l.circle.cy)<F){o=l.P;a.unshift(l);Vr(l);l=o}a.unshift(l);Qr(l);var c=s;while(c.circle&&N(i-c.circle.x)<F&&N(n-c.circle.cy)<F){s=c.N;a.push(c);Vr(c);c=s}a.push(c);Qr(c);var u=a.length,d;for(d=1;d<u;++d){c=a[d];l=a[d-1];ro(c.edge,l.site,c.site,r)}l=a[0];c=a[u-1];c.edge=io(l.site,c.site,null,r);Zr(l);Zr(c)}function zr(e){var t=e.x,i=e.y,n,r,o,s,a=Lr._;while(a){o=Wr(a,i)-t;if(o>F)a=a.L;else{s=t-Ur(a,i);if(s>F){if(!a.R){n=a;break}a=a.R}else{if(o>-F){n=a.P;r=a}else if(s>-F){n=a;r=a.N}else{n=r=a}break}}}var l=Br(e);Lr.insert(n,l);if(!n&&!r)return;if(n===r){Qr(n);r=Br(n.site);Lr.insert(l,r);l.edge=r.edge=io(n.site,l.site);Zr(n);Zr(r);return}if(!r){l.edge=io(n.site,l.site);return}Qr(n);Qr(r);var c=n.site,u=c.x,d=c.y,h=e.x-u,f=e.y-d,p=r.site,g=p.x-u,m=p.y-d,v=2*(h*m-f*g),y=h*h+f*f,b=g*g+m*m,_={x:(m*y-f*b)/v+u,y:(h*b-g*y)/v+d};ro(r.edge,c,p,_);l.edge=io(c,e,null,_);r.edge=io(e,p,null,_);Zr(n);Zr(r)}function Wr(e,t){var i=e.site,n=i.x,r=i.y,o=r-t;if(!o)return n;var s=e.P;if(!s)return-Infinity;i=s.site;var a=i.x,l=i.y,c=l-t;if(!c)return a;var u=a-n,d=1/o-1/c,h=u/c;if(d)return(-h+Math.sqrt(h*h-2*d*(u*u/(-2*c)-l+c/2+r-o/2)))/d+n;return(n+a)/2}function Ur(e,t){var i=e.N;if(i)return Wr(i,t);var n=e.site;return n.y===t?n.x:Infinity}function Yr(e){this.site=e;this.edges=[]}Yr.prototype.prepare=function(){var e=this.edges,t=e.length,i;while(t--){i=e[t].edge;if(!i.b||!i.a)e.splice(t,1)}e.sort(Kr);return e.length};function qr(e){var t=e[0][0],i=e[1][0],n=e[0][1],r=e[1][1],o,s,a,l,c=Ir,u=c.length,d,h,f,p,g,m;while(u--){d=c[u];if(!d||!d.prepare())continue;f=d.edges;p=f.length;h=0;while(h<p){m=f[h].end(),a=m.x,l=m.y;g=f[++h%p].start(),o=g.x,s=g.y;if(N(a-o)>F||N(l-s)>F){f.splice(h,0,new oo(no(d.site,m,N(a-t)<F&&r-l>F?{x:t,y:N(o-t)<F?s:r}:N(l-r)<F&&i-a>F?{x:N(s-r)<F?o:i,y:r}:N(a-i)<F&&l-n>F?{x:i,y:N(o-i)<F?s:n}:N(l-n)<F&&a-t>F?{x:N(s-n)<F?o:t,y:n}:null),d.site,null));++p}}}}function Kr(e,t){return t.angle-e.angle}function Xr(){ao(this);this.x=this.y=this.arc=this.site=this.cy=null}function Zr(e){var t=e.P,i=e.N;if(!t||!i)return;var n=t.site,r=e.site,o=i.site;if(n===o)return;var s=r.x,a=r.y,l=n.x-s,c=n.y-a,u=o.x-s,d=o.y-a;var h=2*(l*d-c*u);if(h>=-Xe)return;var f=l*l+c*c,p=u*u+d*d,g=(d*f-c*p)/h,m=(l*p-u*f)/h,d=m+a;var v=$r.pop()||new Xr;v.arc=e;v.site=r;v.x=g+s;v.y=d+Math.sqrt(g*g+m*m);v.cy=d;e.circle=v;var y=null,b=Gr._;while(b){if(v.y<b.y||v.y===b.y&&v.x<=b.x){if(b.L)b=b.L;else{y=b.P;break}}else{if(b.R)b=b.R;else{y=b;break}}}Gr.insert(y,v);if(!y)Fr=v}function Qr(e){var t=e.circle;if(t){if(!t.P)Fr=t.N;Gr.remove(t);$r.push(t);ao(t);e.circle=null}}function Jr(e){var t=Nr,i=xn(e[0][0],e[0][1],e[1][0],e[1][1]),n=t.length,r;while(n--){r=t[n];if(!eo(r,e)||!i(r)||N(r.a.x-r.b.x)<F&&N(r.a.y-r.b.y)<F){r.a=r.b=null;t.splice(n,1)}}}function eo(e,t){var i=e.b;if(i)return true;var n=e.a,r=t[0][0],o=t[1][0],s=t[0][1],a=t[1][1],l=e.l,c=e.r,u=l.x,d=l.y,h=c.x,f=c.y,p=(u+h)/2,g=(d+f)/2,m,v;if(f===d){if(p<r||p>=o)return;if(u>h){if(!n)n={x:p,y:s};else if(n.y>=a)return;i={x:p,y:a}}else{if(!n)n={x:p,y:a};else if(n.y<s)return;i={x:p,y:s}}}else{m=(u-h)/(f-d);v=g-m*p;if(m<-1||m>1){if(u>h){if(!n)n={x:(s-v)/m,y:s};else if(n.y>=a)return;i={x:(a-v)/m,y:a}}else{if(!n)n={x:(a-v)/m,y:a};else if(n.y<s)return;i={x:(s-v)/m,y:s}}}else{if(d<f){if(!n)n={x:r,y:m*r+v};else if(n.x>=o)return;i={x:o,y:m*o+v}}else{if(!n)n={x:o,y:m*o+v};else if(n.x<r)return;i={x:r,y:m*r+v}}}}e.a=n;e.b=i;return true}function to(e,t){this.l=e;this.r=t;this.a=this.b=null}function io(e,t,i,n){var r=new to(e,t);Nr.push(r);if(i)ro(r,e,t,i);if(n)ro(r,t,e,n);Ir[e.i].edges.push(new oo(r,e,t));Ir[t.i].edges.push(new oo(r,t,e));return r}function no(e,t,i){var n=new to(e,null);n.a=t;n.b=i;Nr.push(n);return n}function ro(e,t,i,n){if(!e.a&&!e.b){e.a=n;e.l=t;e.r=i}else if(e.l===i){e.b=n}else{e.a=n}}function oo(e,t,i){var n=e.a,r=e.b;this.edge=e;this.site=t;this.angle=i?Math.atan2(i.y-t.y,i.x-t.x):e.l===t?Math.atan2(r.x-n.x,n.y-r.y):Math.atan2(n.x-r.x,r.y-n.y)}oo.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};function so(){this._=null}function ao(e){e.U=e.C=e.L=e.R=e.P=e.N=null}so.prototype={insert:function(e,t){var i,n,r;if(e){t.P=e;t.N=e.N;if(e.N)e.N.P=t;e.N=t;if(e.R){e=e.R;while(e.L)e=e.L;e.L=t}else{e.R=t}i=e}else if(this._){e=uo(this._);t.P=null;t.N=e;e.P=e.L=t;i=e}else{t.P=t.N=null;this._=t;i=null}t.L=t.R=null;t.U=i;t.C=true;e=t;while(i&&i.C){n=i.U;if(i===n.L){r=n.R;if(r&&r.C){i.C=r.C=false;n.C=true;e=n}else{if(e===i.R){lo(this,i);e=i;i=e.U}i.C=false;n.C=true;co(this,n)}}else{r=n.L;if(r&&r.C){i.C=r.C=false;n.C=true;e=n}else{if(e===i.L){co(this,i);e=i;i=e.U}i.C=false;n.C=true;lo(this,n)}}i=e.U}this._.C=false},remove:function(e){if(e.N)e.N.P=e.P;if(e.P)e.P.N=e.N;e.N=e.P=null;var t=e.U,i,n=e.L,r=e.R,o,s;if(!n)o=r;else if(!r)o=n;else o=uo(r);if(t){if(t.L===e)t.L=o;else t.R=o}else{this._=o}if(n&&r){s=o.C;o.C=e.C;o.L=n;n.U=o;if(o!==r){t=o.U;o.U=e.U;e=o.R;t.L=e;o.R=r;r.U=o}else{o.U=t;t=o;e=o.R}}else{s=e.C;e=o}if(e)e.U=t;if(s)return;if(e&&e.C){e.C=false;return}do{if(e===this._)break;if(e===t.L){i=t.R;if(i.C){i.C=false;t.C=true;lo(this,t);i=t.R}if(i.L&&i.L.C||i.R&&i.R.C){if(!i.R||!i.R.C){i.L.C=false;i.C=true;co(this,i);i=t.R}i.C=t.C;t.C=i.R.C=false;lo(this,t);e=this._;break}}else{i=t.L;if(i.C){i.C=false;t.C=true;co(this,t);i=t.L}if(i.L&&i.L.C||i.R&&i.R.C){if(!i.L||!i.L.C){i.R.C=false;i.C=true;lo(this,i);i=t.L}i.C=t.C;t.C=i.L.C=false;co(this,t);e=this._;break}}i.C=true;e=t;t=t.U}while(!e.C);if(e)e.C=false}};function lo(e,t){var i=t,n=t.R,r=i.U;if(r){if(r.L===i)r.L=n;else r.R=n}else{e._=n}n.U=r;i.U=n;i.R=n.L;if(i.R)i.R.U=i;n.L=i}function co(e,t){var i=t,n=t.L,r=i.U;if(r){if(r.L===i)r.L=n;else r.R=n}else{e._=n}n.U=r;i.U=n;i.L=n.R;if(i.L)i.L.U=i;n.R=i}function uo(e){while(e.L)e=e.L;return e}function ho(e,t){var i=e.sort(fo).pop(),n,r,o;Nr=[];Ir=new Array(e.length);Lr=new so;Gr=new so;while(true){o=Fr;if(i&&(!o||i.y<o.y||i.y===o.y&&i.x<o.x)){if(i.x!==n||i.y!==r){Ir[i.i]=new Yr(i);zr(i);n=i.x,r=i.y}i=e.pop()}else if(o){jr(o.arc)}else{break}}if(t)Jr(t),qr(t);var s={cells:Ir,edges:Nr};Lr=Gr=Nr=Ir=null;return s}function fo(e,t){return t.y-e.y||t.x-e.x}I.geom.voronoi=function(e){var t=Ar,i=Er,n=t,r=i,d=po;if(e)return o(e);function o(o){var s=new Array(o.length),a=d[0][0],l=d[0][1],c=d[1][0],u=d[1][1];ho(h(o),d).cells.forEach(function(e,t){var i=e.edges,n=e.site,r=s[t]=i.length?i.map(function(e){var t=e.start();return[t.x,t.y]}):n.x>=a&&n.x<=c&&n.y>=l&&n.y<=u?[[a,u],[c,u],[c,l],[a,l]]:[];r.point=o[t]});return s}function h(e){return e.map(function(e,t){return{x:Math.round(n(e,t)/F)*F,y:Math.round(r(e,t)/F)*F,i:t}})}o.links=function(t){return ho(h(t)).edges.filter(function(e){return e.l&&e.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})};o.triangles=function(u){var d=[];ho(h(u)).cells.forEach(function(e,t){var i=e.site,n=e.edges.sort(Kr),r=-1,o=n.length,s,a,l=n[o-1].edge,c=l.l===i?l.r:l.l;while(++r<o){s=l;a=c;l=n[r].edge;c=l.l===i?l.r:l.l;if(t<a.i&&t<c.i&&go(i,a,c)<0){d.push([u[t],u[a.i],u[c.i]])}}});return d};o.x=function(e){return arguments.length?(n=E(t=e),o):t};o.y=function(e){return arguments.length?(r=E(i=e),o):i};o.clipExtent=function(e){if(!arguments.length)return d===po?null:d;d=e==null?po:e;return o};o.size=function(e){if(!arguments.length)return d===po?null:d&&d[1];return o.clipExtent(e&&[[0,0],e])};return o};var po=[[-1e6,-1e6],[1e6,1e6]];function go(e,t,i){return(e.x-i.x)*(t.y-e.y)-(e.x-t.x)*(i.y-e.y)}I.geom.delaunay=function(e){return I.geom.voronoi().triangles(e)};I.geom.quadtree=function(e,b,_,w,C){var x=Ar,S=Er,A;if(A=arguments.length){x=mo;S=vo;if(A===3){C=_;w=b;_=b=0}return t(e)}function t(e){var t,i=E(x),n=E(S),r,o,s,a,l,c,u,d;if(b!=null){l=b,c=_,u=w,d=C}else{u=d=-(l=c=Infinity);r=[],o=[];a=e.length;if(A)for(s=0;s<a;++s){t=e[s];if(t.x<l)l=t.x;if(t.y<c)c=t.y;if(t.x>u)u=t.x;if(t.y>d)d=t.y;r.push(t.x);o.push(t.y)}else for(s=0;s<a;++s){var h=+i(t=e[s],s),f=+n(t,s);if(h<l)l=h;if(f<c)c=f;if(h>u)u=h;if(f>d)d=f;r.push(h);o.push(f)}}var p=u-l,g=d-c;if(p>g)d=c+p;else u=l+g;function m(e,t,i,n,r,o,s,a){if(isNaN(i)||isNaN(n))return;if(e.leaf){var l=e.x,c=e.y;if(l!=null){if(N(l-i)+N(c-n)<.01){v(e,t,i,n,r,o,s,a)}else{var u=e.point;e.x=e.y=e.point=null;v(e,u,l,c,r,o,s,a);v(e,t,i,n,r,o,s,a)}}else{e.x=i,e.y=n,e.point=t}}else{v(e,t,i,n,r,o,s,a)}}function v(e,t,i,n,r,o,s,a){var l=(r+s)*.5,c=(o+a)*.5,u=i>=l,d=n>=c,h=d<<1|u;e.leaf=false;e=e.nodes[h]||(e.nodes[h]=yo());if(u)r=l;else s=l;if(d)o=c;else a=c;m(e,t,i,n,r,o,s,a)}var y=yo();y.add=function(e){m(y,e,+i(e,++s),+n(e,s),l,c,u,d)};y.visit=function(e){bo(e,y,l,c,u,d)};y.find=function(e){return _o(y,e[0],e[1],l,c,u,d)};s=-1;if(b==null){while(++s<a){m(y,e[s],r[s],o[s],l,c,u,d)}--s}else e.forEach(y.add);r=o=e=t=null;return y}t.x=function(e){return arguments.length?(x=e,t):x};t.y=function(e){return arguments.length?(S=e,t):S};t.extent=function(e){if(!arguments.length)return b==null?null:[[b,_],[w,C]];if(e==null)b=_=w=C=null;else b=+e[0][0],_=+e[0][1],w=+e[1][0],C=+e[1][1];return t};t.size=function(e){if(!arguments.length)return b==null?null:[w-b,C-_];if(e==null)b=_=w=C=null;else b=_=0,w=+e[0],C=+e[1];return t};return t};function mo(e){return e.x}function vo(e){return e.y}function yo(){return{leaf:true,nodes:[],point:null,x:null,y:null}}function bo(e,t,i,n,r,o){if(!e(t,i,n,r,o)){var s=(i+r)*.5,a=(n+o)*.5,l=t.nodes;if(l[0])bo(e,l[0],i,n,s,a);if(l[1])bo(e,l[1],s,n,r,a);if(l[2])bo(e,l[2],i,a,s,o);if(l[3])bo(e,l[3],s,a,r,o)}}function _o(e,y,b,_,w,C,x){var S=Infinity,A;(function e(t,i,n,r,o){if(i>C||n>x||r<_||o<w)return;if(s=t.point){var s,a=y-t.x,l=b-t.y,c=a*a+l*l;if(c<S){var u=Math.sqrt(S=c);_=y-u,w=b-u;C=y+u,x=b+u;A=s}}var d=t.nodes,h=(i+r)*.5,f=(n+o)*.5,p=y>=h,g=b>=f;for(var m=g<<1|p,v=m+4;m<v;++m){if(t=d[m&3])switch(m&3){case 0:e(t,i,n,h,f);break;case 1:e(t,h,n,r,f);break;case 2:e(t,i,f,h,o);break;case 3:e(t,h,f,r,o);break}}})(e,_,w,C,x);return A}I.interpolateRgb=wo;function wo(e,t){e=I.rgb(e);t=I.rgb(t);var i=e.r,n=e.g,r=e.b,o=t.r-i,s=t.g-n,a=t.b-r;return function(e){return"#"+Mt(Math.round(i+o*e))+Mt(Math.round(n+s*e))+Mt(Math.round(r+a*e))}}I.interpolateObject=Co;function Co(e,t){var i={},n={},r;for(r in e){if(r in t){i[r]=To(e[r],t[r])}else{n[r]=e[r]}}for(r in t){if(!(r in e)){n[r]=t[r]}}return function(e){for(r in i)n[r]=i[r](e);return n}}I.interpolateNumber=xo;function xo(t,i){t=+t,i=+i;return function(e){return t*(1-e)+i*e}}I.interpolateString=So;function So(e,n){var t=Ao.lastIndex=Eo.lastIndex=0,i,r,o,s=-1,a=[],l=[];e=e+"",n=n+"";while((i=Ao.exec(e))&&(r=Eo.exec(n))){if((o=r.index)>t){o=n.slice(t,o);if(a[s])a[s]+=o;else a[++s]=o}if((i=i[0])===(r=r[0])){if(a[s])a[s]+=r;else a[++s]=r}else{a[++s]=null;l.push({i:s,x:xo(i,r)})}t=Eo.lastIndex}if(t<n.length){o=n.slice(t);if(a[s])a[s]+=o;else a[++s]=o}return a.length<2?l[0]?(n=l[0].x,function(e){return n(e)+""}):function(){return n}:(n=l.length,function(e){for(var t=0,i;t<n;++t)a[(i=l[t]).i]=i.x(e);return a.join("")})}var Ao=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Eo=new RegExp(Ao.source,"g");I.interpolate=To;function To(e,t){var i=I.interpolators.length,n;while(--i>=0&&!(n=I.interpolators[i](e,t)));return n}I.interpolators=[function(e,t){var i=typeof t;return(i==="string"?Pt.has(t)||/^(#|rgb\(|hsl\()/.test(t)?wo:So:t instanceof ht?wo:Array.isArray(t)?Do:i==="object"&&isNaN(t)?Co:xo)(e,t)}];I.interpolateArray=Do;function Do(e,t){var i=[],n=[],r=e.length,o=t.length,s=Math.min(e.length,t.length),a;for(a=0;a<s;++a)i.push(To(e[a],t[a]));for(;a<r;++a)n[a]=e[a];for(;a<o;++a)n[a]=t[a];return function(e){for(a=0;a<s;++a)n[a]=i[a](e);return n}}var Ro=function(){return P};var Mo=I.map({linear:Ro,poly:Go,quad:function(){return Lo},cubic:function(){return Po},sin:function(){return $o},exp:function(){return Ho},circle:function(){return Bo},elastic:Vo,back:jo,bounce:function(){return zo}});var ko=I.map({in:P,out:No,"in-out":Io,"out-in":function(e){return Io(No(e))}});I.ease=function(e){var t=e.indexOf("-"),i=t>=0?e.slice(0,t):e,n=t>=0?e.slice(t+1):"in";i=Mo.get(i)||Ro;n=ko.get(n)||P;return Oo(n(i.apply(null,g.call(arguments,1))))};function Oo(t){return function(e){return e<=0?0:e>=1?1:t(e)}}function No(t){return function(e){return 1-t(1-e)}}function Io(t){return function(e){return.5*(e<.5?t(2*e):2-t(2-2*e))}}function Lo(e){return e*e}function Po(e){return e*e*e}function Fo(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,i=t*e;return 4*(e<.5?i:3*(e-t)+i-.75)}function Go(t){return function(e){return Math.pow(e,t)}}function $o(e){return 1-Math.cos(e*Y)}function Ho(e){return Math.pow(2,10*(e-1))}function Bo(e){return 1-Math.sqrt(1-e*e)}function Vo(t,i){var n;if(arguments.length<2)i=.45;if(arguments.length)n=i/R*Math.asin(1/t);else t=1,n=i/4;return function(e){return 1+t*Math.pow(2,-10*e)*Math.sin((e-n)*R/i)}}function jo(t){if(!t)t=1.70158;return function(e){return e*e*((t+1)*e-t)}}function zo(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}I.interpolateHcl=Wo;function Wo(e,t){e=I.hcl(e);t=I.hcl(t);var i=e.h,n=e.c,r=e.l,o=t.h-i,s=t.c-n,a=t.l-r;if(isNaN(s))s=0,n=isNaN(n)?t.c:n;if(isNaN(o))o=0,i=isNaN(i)?t.h:i;else if(o>180)o-=360;else if(o<-180)o+=360;return function(e){return mt(i+o*e,n+s*e,r+a*e)+""}}I.interpolateHsl=Uo;function Uo(e,t){e=I.hsl(e);t=I.hsl(t);var i=e.h,n=e.s,r=e.l,o=t.h-i,s=t.s-n,a=t.l-r;if(isNaN(s))s=0,n=isNaN(n)?t.s:n;if(isNaN(o))o=0,i=isNaN(i)?t.h:i;else if(o>180)o-=360;else if(o<-180)o+=360;return function(e){return pt(i+o*e,n+s*e,r+a*e)+""}}I.interpolateLab=Yo;function Yo(e,t){e=I.lab(e);t=I.lab(t);var i=e.l,n=e.a,r=e.b,o=t.l-i,s=t.a-n,a=t.b-r;return function(e){return Ct(i+o*e,n+s*e,r+a*e)+""}}I.interpolateRound=qo;function qo(t,i){i-=t;return function(e){return Math.round(t+i*e)}}I.transform=function(e){var i=L.createElementNS(I.ns.prefix.svg,"g");return(I.transform=function(e){if(e!=null){i.setAttribute("transform",e);var t=i.transform.baseVal.consolidate()}return new Ko(t?t.matrix:Jo)})(e)};function Ko(e){var t=[e.a,e.b],i=[e.c,e.d],n=Zo(t),r=Xo(t,i),o=Zo(Qo(i,t,-r))||0;if(t[0]*i[1]<i[0]*t[1]){t[0]*=-1;t[1]*=-1;n*=-1;r*=-1}this.rotate=(n?Math.atan2(t[1],t[0]):Math.atan2(-i[0],i[1]))*A;this.translate=[e.e,e.f];this.scale=[n,o];this.skew=o?Math.atan2(r,o)*A:0}Ko.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function Xo(e,t){return e[0]*t[0]+e[1]*t[1]}function Zo(e){var t=Math.sqrt(Xo(e,e));if(t){e[0]/=t;e[1]/=t}return t}function Qo(e,t,i){e[0]+=i*t[0];e[1]+=i*t[1];return e}var Jo={a:1,b:0,c:0,d:1,e:0,f:0};I.interpolateTransform=es;function es(e,t){var n=[],r=[],o,i=I.transform(e),s=I.transform(t),a=i.translate,l=s.translate,c=i.rotate,u=s.rotate,d=i.skew,h=s.skew,f=i.scale,p=s.scale;if(a[0]!=l[0]||a[1]!=l[1]){n.push("translate(",null,",",null,")");r.push({i:1,x:xo(a[0],l[0])},{i:3,x:xo(a[1],l[1])})}else if(l[0]||l[1]){n.push("translate("+l+")")}else{n.push("")}if(c!=u){if(c-u>180)u+=360;else if(u-c>180)c+=360;r.push({i:n.push(n.pop()+"rotate(",null,")")-2,x:xo(c,u)})}else if(u){n.push(n.pop()+"rotate("+u+")")}if(d!=h){r.push({i:n.push(n.pop()+"skewX(",null,")")-2,x:xo(d,h)})}else if(h){n.push(n.pop()+"skewX("+h+")")}if(f[0]!=p[0]||f[1]!=p[1]){o=n.push(n.pop()+"scale(",null,",",null,")");r.push({i:o-4,x:xo(f[0],p[0])},{i:o-2,x:xo(f[1],p[1])})}else if(p[0]!=1||p[1]!=1){n.push(n.pop()+"scale("+p+")")}o=r.length;return function(e){var t=-1,i;while(++t<o)n[(i=r[t]).i]=i.x(e);return n.join("")}}function ts(t,i){i=(i-=t=+t)||1/i;return function(e){return(e-t)/i}}function is(t,i){i=(i-=t=+t)||1/i;return function(e){return Math.max(0,Math.min(1,(e-t)/i))}}I.layout={};I.layout.bundle=function(){return function(e){var t=[],i=-1,n=e.length;while(++i<n)t.push(ns(e[i]));return t}};function ns(e){var t=e.source,i=e.target,n=os(t,i),r=[t];while(t!==n){t=t.parent;r.push(t)}var o=r.length;while(i!==n){r.splice(o,0,i);i=i.parent}return r}function rs(e){var t=[],i=e.parent;while(i!=null){t.push(e);e=i;i=i.parent}t.push(e);return t}function os(e,t){if(e===t)return e;var i=rs(e),n=rs(t),r=i.pop(),o=n.pop(),s=null;while(r===o){s=r;r=i.pop();o=n.pop()}return s}I.layout.chord=function(){var t={},m,v,y,b,_=0,w,C,x;function e(){var e={},i=[],t=I.range(b),n=[],r,o,s,a,l;m=[];v=[];r=0,a=-1;while(++a<b){o=0,l=-1;while(++l<b){o+=y[a][l]}i.push(o);n.push(I.range(b));r+=o}if(w){t.sort(function(e,t){return w(i[e],i[t])})}if(C){n.forEach(function(e,i){e.sort(function(e,t){return C(y[i][e],y[i][t])})})}r=(R-_*b)/r;o=0,a=-1;while(++a<b){s=o,l=-1;while(++l<b){var c=t[a],u=n[c][l],d=y[c][u],h=o,f=o+=d*r;e[c+"-"+u]={index:c,subindex:u,startAngle:h,endAngle:f,value:d}}v[c]={index:c,startAngle:s,endAngle:o,value:(o-s)/r};o+=_}a=-1;while(++a<b){l=a-1;while(++l<b){var p=e[a+"-"+l],g=e[l+"-"+a];if(p.value||g.value){m.push(p.value<g.value?{source:g,target:p}:{source:p,target:g})}}}if(x)S()}function S(){m.sort(function(e,t){return x((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}t.matrix=function(e){if(!arguments.length)return y;b=(y=e)&&y.length;m=v=null;return t};t.padding=function(e){if(!arguments.length)return _;_=e;m=v=null;return t};t.sortGroups=function(e){if(!arguments.length)return w;w=e;m=v=null;return t};t.sortSubgroups=function(e){if(!arguments.length)return C;C=e;m=null;return t};t.sortChords=function(e){if(!arguments.length)return x;x=e;if(m)S();return t};t.chords=function(){if(!m)e();return m};t.groups=function(){if(!v)e();return v};return t};I.layout.force=function(){var r={},d=I.dispatch("start","tick","end"),h=[1,1],e,f,p=.9,o=ds,s=hs,g=-30,u=fs,m=.1,v=.64,y=[],b=[],_,w,C;function x(c){return function(e,t,i,n){if(e.point!==c){var r=e.cx-c.x,o=e.cy-c.y,s=n-t,a=r*r+o*o;if(s*s/v<a){if(a<u){var l=e.charge/a;c.px-=r*l;c.py-=o*l}return true}if(e.point&&a&&a<u){var l=e.pointCharge/a;c.px-=r*l;c.py-=o*l}}return!e.charge}}r.tick=function(){if((f*=.99)<.005){d.end({type:"end",alpha:f=0});return true}var e=y.length,t=b.length,i,n,r,o,s,a,l,c,u;for(n=0;n<t;++n){r=b[n];o=r.source;s=r.target;c=s.x-o.x;u=s.y-o.y;if(a=c*c+u*u){a=f*w[n]*((a=Math.sqrt(a))-_[n])/a;c*=a;u*=a;s.x-=c*(l=o.weight/(s.weight+o.weight));s.y-=u*l;o.x+=c*(l=1-l);o.y+=u*l}}if(l=f*m){c=h[0]/2;u=h[1]/2;n=-1;if(l)while(++n<e){r=y[n];r.x+=(c-r.x)*l;r.y+=(u-r.y)*l}}if(g){us(i=I.geom.quadtree(y),f,C);n=-1;while(++n<e){if(!(r=y[n]).fixed){i.visit(x(r))}}}n=-1;while(++n<e){r=y[n];if(r.fixed){r.x=r.px;r.y=r.py}else{r.x-=(r.px-(r.px=r.x))*p;r.y-=(r.py-(r.py=r.y))*p}}d.tick({type:"tick",alpha:f})};r.nodes=function(e){if(!arguments.length)return y;y=e;return r};r.links=function(e){if(!arguments.length)return b;b=e;return r};r.size=function(e){if(!arguments.length)return h;h=e;return r};r.linkDistance=function(e){if(!arguments.length)return o;o=typeof e==="function"?e:+e;return r};r.distance=r.linkDistance;r.linkStrength=function(e){if(!arguments.length)return s;s=typeof e==="function"?e:+e;return r};r.friction=function(e){if(!arguments.length)return p;p=+e;return r};r.charge=function(e){if(!arguments.length)return g;g=typeof e==="function"?e:+e;return r};r.chargeDistance=function(e){if(!arguments.length)return Math.sqrt(u);u=e*e;return r};r.gravity=function(e){if(!arguments.length)return m;m=+e;return r};r.theta=function(e){if(!arguments.length)return Math.sqrt(v);v=e*e;return r};r.alpha=function(e){if(!arguments.length)return f;e=+e;if(f){if(e>0)f=e;else f=0}else if(e>0){d.start({type:"start",alpha:f=e});I.timer(r.tick)}return r};r.start=function(){var a,l=y.length,c=b.length,e=h[0],t=h[1],u,i;for(a=0;a<l;++a){(i=y[a]).index=a;i.weight=0}for(a=0;a<c;++a){i=b[a];if(typeof i.source=="number")i.source=y[i.source];if(typeof i.target=="number")i.target=y[i.target];++i.source.weight;++i.target.weight}for(a=0;a<l;++a){i=y[a];if(isNaN(i.x))i.x=n("x",e);if(isNaN(i.y))i.y=n("y",t);if(isNaN(i.px))i.px=i.x;if(isNaN(i.py))i.py=i.y}_=[];if(typeof o==="function")for(a=0;a<c;++a)_[a]=+o.call(this,b[a],a);else for(a=0;a<c;++a)_[a]=o;w=[];if(typeof s==="function")for(a=0;a<c;++a)w[a]=+s.call(this,b[a],a);else for(a=0;a<c;++a)w[a]=s;C=[];if(typeof g==="function")for(a=0;a<l;++a)C[a]=+g.call(this,y[a],a);else for(a=0;a<l;++a)C[a]=g;function n(e,t){if(!u){u=new Array(l);for(r=0;r<l;++r){u[r]=[]}for(r=0;r<c;++r){var i=b[r];u[i.source.index].push(i.target);u[i.target.index].push(i.source)}}var n=u[a],r=-1,o=n.length,s;while(++r<o)if(!isNaN(s=n[r][e]))return s;return Math.random()*t}return r.resume()};r.resume=function(){return r.alpha(.1)};r.stop=function(){return r.alpha(0)};r.drag=function(){if(!e)e=I.behavior.drag().origin(P).on("dragstart.force",ss).on("drag.force",t).on("dragend.force",as);if(!arguments.length)return e;this.on("mouseover.force",ls).on("mouseout.force",cs).call(e)};function t(e){e.px=I.event.x,e.py=I.event.y;r.resume()}return I.rebind(r,d,"on")};function ss(e){e.fixed|=2}function as(e){e.fixed&=~6}function ls(e){e.fixed|=4;e.px=e.x,e.py=e.y}function cs(e){e.fixed&=~4}function us(e,t,i){var n=0,r=0;e.charge=0;if(!e.leaf){var o=e.nodes,s=o.length,a=-1,l;while(++a<s){l=o[a];if(l==null)continue;us(l,t,i);e.charge+=l.charge;n+=l.charge*l.cx;r+=l.charge*l.cy}}if(e.point){if(!e.leaf){e.point.x+=Math.random()-.5;e.point.y+=Math.random()-.5}var c=t*i[e.point.index];e.charge+=e.pointCharge=c;n+=c*e.point.x;r+=c*e.point.y}e.cx=n/e.charge;e.cy=r/e.charge}var ds=20,hs=1,fs=Infinity;I.layout.hierarchy=function(){var a=ys,l=ms,c=vs;function u(e){var t=[e],i=[],n;e.depth=0;while((n=t.pop())!=null){i.push(n);if((o=l.call(u,n,n.depth))&&(r=o.length)){var r,o,s;while(--r>=0){t.push(s=o[r]);s.parent=n;s.depth=n.depth+1}if(c)n.value=0;n.children=o}else{if(c)n.value=+c.call(u,n,n.depth)||0;delete n.children}}b(e,function(e){var t,i;if(a&&(t=e.children))t.sort(a);if(c&&(i=e.parent))i.value+=e.value});return i}u.sort=function(e){if(!arguments.length)return a;a=e;return u};u.children=function(e){if(!arguments.length)return l;l=e;return u};u.value=function(e){if(!arguments.length)return c;c=e;return u};u.revalue=function(e){if(c){gs(e,function(e){if(e.children)e.value=0});b(e,function(e){var t;if(!e.children)e.value=+c.call(u,e,e.depth)||0;if(t=e.parent)t.value+=e.value})}return e};return u};function ps(e,t){I.rebind(e,t,"sort","children","value");e.nodes=e;e.links=bs;return e}function gs(e,t){var i=[e];while((e=i.pop())!=null){t(e);if((r=e.children)&&(n=r.length)){var n,r;while(--n>=0)i.push(r[n])}}}function b(e,t){var i=[e],n=[];while((e=i.pop())!=null){n.push(e);if((s=e.children)&&(o=s.length)){var r=-1,o,s;while(++r<o)i.push(s[r])}}while((e=n.pop())!=null){t(e)}}function ms(e){return e.children}function vs(e){return e.value}function ys(e,t){return t.value-e.value}function bs(e){return I.merge(e.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}I.layout.partition=function(){var n=I.layout.hierarchy(),r=[1,1];function c(e,t,i,n){var r=e.children;e.x=t;e.y=e.depth*n;e.dx=i;e.dy=n;if(r&&(s=r.length)){var o=-1,s,a,l;i=e.value?i/e.value:0;while(++o<s){c(a=r[o],t,l=a.value*i,n);t+=l}}}function o(e){var t=e.children,i=0;if(t&&(r=t.length)){var n=-1,r;while(++n<r)i=Math.max(i,o(t[n]))}return 1+i}function t(e,t){var i=n.call(this,e,t);c(i[0],0,r[0],r[1]/o(i[0]));return i}t.size=function(e){if(!arguments.length)return r;r=e;return t};return ps(t,n)};I.layout.pie=function(){var d=Number,h=_s,f=0,p=R,g=0;function m(i){var e=i.length,n=i.map(function(e,t){return+d.call(m,e,t)}),t=+(typeof f==="function"?f.apply(this,arguments):f),r=(typeof p==="function"?p.apply(this,arguments):p)-t,o=Math.min(Math.abs(r)/e,+(typeof g==="function"?g.apply(this,arguments):g)),s=o*(r<0?-1:1),a=(r-e*s)/I.sum(n),l=I.range(e),c=[],u;if(h!=null)l.sort(h===_s?function(e,t){return n[t]-n[e]}:function(e,t){return h(i[e],i[t])});l.forEach(function(e){c[e]={data:i[e],value:u=n[e],startAngle:t,endAngle:t+=u*a+s,padAngle:o}});return c}m.value=function(e){if(!arguments.length)return d;d=e;return m};m.sort=function(e){if(!arguments.length)return h;h=e;return m};m.startAngle=function(e){if(!arguments.length)return f;f=e;return m};m.endAngle=function(e){if(!arguments.length)return p;p=e;return m};m.padAngle=function(e){if(!arguments.length)return g;g=e;return m};return m};var _s={};I.layout.stack=function(){var d=P,h=Es,f=Ts,p=xs,g=ws,m=Cs;function v(e,t){if(!(a=e.length))return e;var i=e.map(function(e,t){return d.call(v,e,t)});var n=i.map(function(e){return e.map(function(e,t){return[g.call(v,e,t),m.call(v,e,t)]})});var r=h.call(v,n,t);i=I.permute(i,r);n=I.permute(n,r);var o=f.call(v,n,t);var s=i[0].length,a,l,c,u;for(c=0;c<s;++c){p.call(v,i[0][c],u=o[c],n[0][c][1]);for(l=1;l<a;++l){p.call(v,i[l][c],u+=n[l-1][c][1],n[l][c][1])}}return e}v.values=function(e){if(!arguments.length)return d;d=e;return v};v.order=function(e){if(!arguments.length)return h;h=typeof e==="function"?e:Ss.get(e)||Es;return v};v.offset=function(e){if(!arguments.length)return f;f=typeof e==="function"?e:As.get(e)||Ts;return v};v.x=function(e){if(!arguments.length)return g;g=e;return v};v.y=function(e){if(!arguments.length)return m;m=e;return v};v.out=function(e){if(!arguments.length)return p;p=e;return v};return v};function ws(e){return e.x}function Cs(e){return e.y}function xs(e,t,i){e.y0=t;e.y=i}var Ss=I.map({"inside-out":function(e){var t=e.length,i,n,r=e.map(Ds),o=e.map(Rs),s=I.range(t).sort(function(e,t){return r[e]-r[t]}),a=0,l=0,c=[],u=[];for(i=0;i<t;++i){n=s[i];if(a<l){a+=o[n];c.push(n)}else{l+=o[n];u.push(n)}}return u.reverse().concat(c)},reverse:function(e){return I.range(e.length).reverse()},default:Es});var As=I.map({silhouette:function(e){var t=e.length,i=e[0].length,n=[],r=0,o,s,a,l=[];for(s=0;s<i;++s){for(o=0,a=0;o<t;o++)a+=e[o][s][1];if(a>r)r=a;n.push(a)}for(s=0;s<i;++s){l[s]=(r-n[s])/2}return l},wiggle:function(e){var t=e.length,i=e[0],n=i.length,r,o,s,a,l,c,u,d,h,f=[];f[0]=d=h=0;for(o=1;o<n;++o){for(r=0,a=0;r<t;++r)a+=e[r][o][1];for(r=0,l=0,u=i[o][0]-i[o-1][0];r<t;++r){for(s=0,c=(e[r][o][1]-e[r][o-1][1])/(2*u);s<r;++s){c+=(e[s][o][1]-e[s][o-1][1])/u}l+=c*e[r][o][1]}f[o]=d-=a?l/a*u:0;if(d<h)h=d}for(o=0;o<n;++o)f[o]-=h;return f},expand:function(e){var t=e.length,i=e[0].length,n=1/t,r,o,s,a=[];for(o=0;o<i;++o){for(r=0,s=0;r<t;r++)s+=e[r][o][1];if(s)for(r=0;r<t;r++)e[r][o][1]/=s;else for(r=0;r<t;r++)e[r][o][1]=n}for(o=0;o<i;++o)a[o]=0;return a},zero:Ts});function Es(e){return I.range(e.length)}function Ts(e){var t=-1,i=e[0].length,n=[];while(++t<i)n[t]=0;return n}function Ds(e){var t=1,i=0,n=e[0][1],r,o=e.length;for(;t<o;++t){if((r=e[t][1])>n){i=t;n=r}}return i}function Rs(e){return e.reduce(Ms,0)}function Ms(e,t){return e+t[1]}I.layout.histogram=function(){var d=true,h=Number,f=Ns,p=ks;function i(e,t){var i=[],n=e.map(h,this),r=f.call(this,n,t),o=p.call(this,r,n,t),s,t=-1,a=n.length,l=o.length-1,c=d?1:1/a,u;while(++t<l){s=i[t]=[];s.dx=o[t+1]-(s.x=o[t]);s.y=0}if(l>0){t=-1;while(++t<a){u=n[t];if(u>=r[0]&&u<=r[1]){s=i[I.bisect(o,u,1,l)-1];s.y+=c;s.push(e[t])}}}return i}i.value=function(e){if(!arguments.length)return h;h=e;return i};i.range=function(e){if(!arguments.length)return f;f=E(e);return i};i.bins=function(t){if(!arguments.length)return p;p=typeof t==="number"?function(e){return Os(e,t)}:E(t);return i};i.frequency=function(e){if(!arguments.length)return d;d=!!e;return i};return i};function ks(e,t){return Os(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function Os(e,t){var i=-1,n=+e[0],r=(e[1]-n)/t,o=[];while(++i<=t)o[i]=r*i+n;return o}function Ns(e){return[I.min(e),I.max(e)]}I.layout.pack=function(){var l=I.layout.hierarchy().sort(Is),c=0,u=[1,1],d;function t(e,t){var i=l.call(this,e,t),n=i[0],r=u[0],o=u[1],s=d==null?Math.sqrt:typeof d==="function"?d:function(){return d};n.x=n.y=0;b(n,function(e){e.r=+s(e.value)});b(n,Gs);if(c){var a=c*(d?1:Math.max(2*n.r/r,2*n.r/o))/2;b(n,function(e){e.r+=a});b(n,Gs);b(n,function(e){e.r-=a})}Bs(n,r/2,o/2,d?1:1/Math.max(2*n.r/r,2*n.r/o));return i}t.size=function(e){if(!arguments.length)return u;u=e;return t};t.radius=function(e){if(!arguments.length)return d;d=e==null||typeof e==="function"?e:+e;return t};t.padding=function(e){if(!arguments.length)return c;c=+e;return t};return ps(t,l)};function Is(e,t){return e.value-t.value}function Ls(e,t){var i=e._pack_next;e._pack_next=t;t._pack_prev=e;t._pack_next=i;i._pack_prev=t}function Ps(e,t){e._pack_next=t;t._pack_prev=e}function Fs(e,t){var i=t.x-e.x,n=t.y-e.y,r=e.r+t.r;return.999*r*r>i*i+n*n}function Gs(e){if(!(t=e.children)||!(h=t.length))return;var t,i=Infinity,n=-Infinity,r=Infinity,o=-Infinity,s,a,l,c,u,d,h;function f(e){i=Math.min(e.x-e.r,i);n=Math.max(e.x+e.r,n);r=Math.min(e.y-e.r,r);o=Math.max(e.y+e.r,o)}t.forEach($s);s=t[0];s.x=-s.r;s.y=0;f(s);if(h>1){a=t[1];a.x=a.r;a.y=0;f(a);if(h>2){l=t[2];Vs(s,a,l);f(l);Ls(s,l);s._pack_prev=l;Ls(l,a);a=s._pack_next;for(c=3;c<h;c++){Vs(s,a,l=t[c]);var p=0,g=1,m=1;for(u=a._pack_next;u!==a;u=u._pack_next,g++){if(Fs(u,l)){p=1;break}}if(p==1){for(d=s._pack_prev;d!==u._pack_prev;d=d._pack_prev,m++){if(Fs(d,l)){break}}}if(p){if(g<m||g==m&&a.r<s.r)Ps(s,a=u);else Ps(s=d,a);c--}else{Ls(s,l);a=l;f(l)}}}}var v=(i+n)/2,y=(r+o)/2,b=0;for(c=0;c<h;c++){l=t[c];l.x-=v;l.y-=y;b=Math.max(b,l.r+Math.sqrt(l.x*l.x+l.y*l.y))}e.r=b;t.forEach(Hs)}function $s(e){e._pack_next=e._pack_prev=e}function Hs(e){delete e._pack_next;delete e._pack_prev}function Bs(e,t,i,n){var r=e.children;e.x=t+=n*e.x;e.y=i+=n*e.y;e.r*=n;if(r){var o=-1,s=r.length;while(++o<s)Bs(r[o],t,i,n)}}function Vs(e,t,i){var n=e.r+i.r,r=t.x-e.x,o=t.y-e.y;if(n&&(r||o)){var s=t.r+i.r,a=r*r+o*o;s*=s;n*=n;var l=.5+(n-s)/(2*a),c=Math.sqrt(Math.max(0,2*s*(n+a)-(n-=a)*n-s*s))/(2*a);i.x=e.x+l*r+c*o;i.y=e.y+l*o-c*r}else{i.x=e.x+n;i.y=e.y}}I.layout.tree=function(){var d=I.layout.hierarchy().sort(null).value(null),h=js,f=[1,1],p=null;function t(e,t){var i=d.call(this,e,t),n=i[0],r=g(n);b(r,m),r.parent.m=-r.z;gs(r,v);if(p)gs(n,y);else{var o=n,s=n,a=n;gs(n,function(e){if(e.x<o.x)o=e;if(e.x>s.x)s=e;if(e.depth>a.depth)a=e});var l=h(o,s)/2-o.x,c=f[0]/(s.x+h(s,o)/2+l),u=f[1]/(a.depth||1);gs(n,function(e){e.x=(e.x+l)*c;e.y=e.depth*u})}return i}function g(e){var t={A:null,children:[e]},i=[t],n;while((n=i.pop())!=null){for(var r=n.children,o,s=0,a=r.length;s<a;++s){i.push((r[s]=o={_:r[s],parent:n,children:(o=r[s].children)&&o.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:s}).a=o)}}return t.children[0]}function m(e){var t=e.children,i=e.parent.children,n=e.i?i[e.i-1]:null;if(t.length){Ys(e);var r=(t[0].z+t[t.length-1].z)/2;if(n){e.z=n.z+h(e._,n._);e.m=e.z-r}else{e.z=r}}else if(n){e.z=n.z+h(e._,n._)}e.parent.A=o(e,n,e.parent.A||i[0])}function v(e){e._.x=e.z+e.parent.m;e.m+=e.parent.m}function o(e,t,i){if(t){var n=e,r=e,o=t,s=n.parent.children[0],a=n.m,l=r.m,c=o.m,u=s.m,d;while(o=Ws(o),n=zs(n),o&&n){s=zs(s);r=Ws(r);r.a=e;d=o.z+c-n.z-a+h(o._,n._);if(d>0){Us(qs(o,e,i),e,d);a+=d;l+=d}c+=o.m;a+=n.m;u+=s.m;l+=r.m}if(o&&!Ws(r)){r.t=o;r.m+=c-l}if(n&&!zs(s)){s.t=n;s.m+=a-u;i=e}}return i}function y(e){e.x*=f[0];e.y=e.depth*f[1]}t.separation=function(e){if(!arguments.length)return h;h=e;return t};t.size=function(e){if(!arguments.length)return p?null:f;p=(f=e)==null?y:null;return t};t.nodeSize=function(e){if(!arguments.length)return p?f:null;p=(f=e)==null?null:y;return t};return ps(t,d)};function js(e,t){return e.parent==t.parent?1:2}function zs(e){var t=e.children;return t.length?t[0]:e.t}function Ws(e){var t=e.children,i;return(i=t.length)?t[i-1]:e.t}function Us(e,t,i){var n=i/(t.i-e.i);t.c-=n;t.s+=i;e.c+=n;t.z+=i;t.m+=i}function Ys(e){var t=0,i=0,n=e.children,r=n.length,o;while(--r>=0){o=n[r];o.z+=t;o.m+=t;t+=o.s+(i+=o.c)}}function qs(e,t,i){return e.a.parent===t.parent?e.a:i}I.layout.cluster=function(){var u=I.layout.hierarchy().sort(null).value(null),d=js,h=[1,1],f=false;function t(e,t){var i=u.call(this,e,t),n=i[0],r,o=0;b(n,function(e){var t=e.children;if(t&&t.length){e.x=Xs(t);e.y=Ks(t)}else{e.x=r?o+=d(e,r):0;e.y=0;r=e}});var s=Zs(n),a=Qs(n),l=s.x-d(s,a)/2,c=a.x+d(a,s)/2;b(n,f?function(e){e.x=(e.x-n.x)*h[0];e.y=(n.y-e.y)*h[1]}:function(e){e.x=(e.x-l)/(c-l)*h[0];e.y=(1-(n.y?e.y/n.y:1))*h[1]});return i}t.separation=function(e){if(!arguments.length)return d;d=e;return t};t.size=function(e){if(!arguments.length)return f?null:h;f=(h=e)==null;return t};t.nodeSize=function(e){if(!arguments.length)return f?h:null;f=(h=e)!=null;return t};return ps(t,u)};function Ks(e){return 1+I.max(e,function(e){return e.y})}function Xs(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function Zs(e){var t=e.children;return t&&t.length?Zs(t[0]):e}function Qs(e){var t=e.children,i;return t&&(i=t.length)?Qs(t[i-1]):e}I.layout.treemap=function(){var n=I.layout.hierarchy(),u=Math.round,r=[1,1],o=null,d=Js,s=false,a,h="squarify",l=.5*(1+Math.sqrt(5));function f(e,t){var i=-1,n=e.length,r,o;while(++i<n){o=(r=e[i]).value*(t<0?0:t);r.area=isNaN(o)||o<=0?0:o}}function p(e){var t=e.children;if(t&&t.length){var i=d(e),n=[],r=t.slice(),o,s=Infinity,a,l=h==="slice"?i.dx:h==="dice"?i.dy:h==="slice-dice"?e.depth&1?i.dy:i.dx:Math.min(i.dx,i.dy),c;f(r,i.dx*i.dy/e.value);n.area=0;while((c=r.length)>0){n.push(o=r[c-1]);n.area+=o.area;if(h!=="squarify"||(a=g(n,l))<=s){r.pop();s=a}else{n.area-=n.pop().area;m(n,l,i,false);l=Math.min(i.dx,i.dy);n.length=n.area=0;s=Infinity}}if(n.length){m(n,l,i,true);n.length=n.area=0}t.forEach(p)}}function c(e){var t=e.children;if(t&&t.length){var i=d(e),n=t.slice(),r,o=[];f(n,i.dx*i.dy/e.value);o.area=0;while(r=n.pop()){o.push(r);o.area+=r.area;if(r.z!=null){m(o,r.z?i.dx:i.dy,i,!n.length);o.length=o.area=0}}t.forEach(c)}}function g(e,t){var i=e.area,n,r=0,o=Infinity,s=-1,a=e.length;while(++s<a){if(!(n=e[s].area))continue;if(n<o)o=n;if(n>r)r=n}i*=i;t*=t;return i?Math.max(t*r*l/i,i/(t*o*l)):Infinity}function m(e,t,i,n){var r=-1,o=e.length,s=i.x,a=i.y,l=t?u(e.area/t):0,c;if(t==i.dx){if(n||l>i.dy)l=i.dy;while(++r<o){c=e[r];c.x=s;c.y=a;c.dy=l;s+=c.dx=Math.min(i.x+i.dx-s,l?u(c.area/l):0)}c.z=true;c.dx+=i.x+i.dx-s;i.y+=l;i.dy-=l}else{if(n||l>i.dx)l=i.dx;while(++r<o){c=e[r];c.x=s;c.y=a;c.dx=l;a+=c.dy=Math.min(i.y+i.dy-a,l?u(c.area/l):0)}c.z=false;c.dy+=i.y+i.dy-a;i.x+=l;i.dx-=l}}function v(e){var t=a||n(e),i=t[0];i.x=0;i.y=0;i.dx=r[0];i.dy=r[1];if(a)n.revalue(i);f([i],i.dx*i.dy/i.value);(a?c:p)(i);if(s)a=t;return t}v.size=function(e){if(!arguments.length)return r;r=e;return v};v.padding=function(i){if(!arguments.length)return o;function e(e){var t=i.call(v,e,e.depth);return t==null?Js(e):ea(e,typeof t==="number"?[t,t,t,t]:t)}function t(e){return ea(e,i)}var n;d=(o=i)==null?Js:(n=typeof i)==="function"?e:n==="number"?(i=[i,i,i,i],t):t;return v};v.round=function(e){if(!arguments.length)return u!=Number;u=e?Math.round:Number;return v};v.sticky=function(e){if(!arguments.length)return s;s=e;a=null;return v};v.ratio=function(e){if(!arguments.length)return l;l=e;return v};v.mode=function(e){if(!arguments.length)return h;h=e+"";return v};return ps(v,n)};function Js(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function ea(e,t){var i=e.x+t[3],n=e.y+t[0],r=e.dx-t[1]-t[3],o=e.dy-t[0]-t[2];if(r<0){i+=r/2;r=0}if(o<0){n+=o/2;o=0}return{x:i,y:n,dx:r,dy:o}}I.random={normal:function(n,r){var e=arguments.length;if(e<2)r=1;if(e<1)n=0;return function(){var e,t,i;do{e=Math.random()*2-1;t=Math.random()*2-1;i=e*e+t*t}while(!i||i>1);return n+r*e*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var e=I.random.normal.apply(I,arguments);return function(){return Math.exp(e())}},bates:function(e){var t=I.random.irwinHall(e);return function(){return t()/e}},irwinHall:function(i){return function(){for(var e=0,t=0;t<i;t++)e+=Math.random();return e}}};I.scale={};function ta(e){var t=e[0],i=e[e.length-1];return t<i?[t,i]:[i,t]}function ia(e){return e.rangeExtent?e.rangeExtent():ta(e.range())}function na(e,t,i,n){var r=i(e[0],e[1]),o=n(t[0],t[1]);return function(e){return o(r(e))}}function ra(e,t){var i=0,n=e.length-1,r=e[i],o=e[n],s;if(o<r){s=i,i=n,n=s;s=r,r=o,o=s}e[i]=t.floor(r);e[n]=t.ceil(o);return e}function oa(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:sa}var sa={floor:P,ceil:P};function aa(i,e,t,n){var r=[],o=[],s=0,a=Math.min(i.length,e.length)-1;if(i[a]<i[0]){i=i.slice().reverse();e=e.slice().reverse()}while(++s<=a){r.push(t(i[s-1],i[s]));o.push(n(e[s-1],e[s]))}return function(e){var t=I.bisect(i,e,1,a)-1;return o[t](r[t](e))}}I.scale.linear=function(){return la([0,1],[0,1],To,false)};function la(i,n,r,o){var s,a;function t(){var e=Math.min(i.length,n.length)>2?aa:na,t=o?is:ts;s=e(i,n,t,r);a=e(n,i,t,To);return l}function l(e){return s(e)}l.invert=function(e){return a(e)};l.domain=function(e){if(!arguments.length)return i;i=e.map(Number);return t()};l.range=function(e){if(!arguments.length)return n;n=e;return t()};l.rangeRound=function(e){return l.range(e).interpolate(qo)};l.clamp=function(e){if(!arguments.length)return o;o=e;return t()};l.interpolate=function(e){if(!arguments.length)return r;r=e;return t()};l.ticks=function(e){return ha(i,e)};l.tickFormat=function(e,t){return fa(i,e,t)};l.nice=function(e){ua(i,e);return t()};l.copy=function(){return la(i,n,r,o)};return t()}function ca(e,t){return I.rebind(e,t,"range","rangeRound","interpolate","clamp")}function ua(e,t){return ra(e,oa(da(e,t)[2]))}function da(e,t){if(t==null)t=10;var i=ta(e),n=i[1]-i[0],r=Math.pow(10,Math.floor(Math.log(n/t)/Math.LN10)),o=t/n*r;if(o<=.15)r*=10;else if(o<=.35)r*=5;else if(o<=.75)r*=2;i[0]=Math.ceil(i[0]/r)*r;i[1]=Math.floor(i[1]/r)*r+r*.5;i[2]=r;return i}function ha(e,t){return I.range.apply(I,da(e,t))}function fa(e,t,i){var n=da(e,t);if(i){var r=Jt.exec(i);r.shift();if(r[8]==="s"){var o=I.formatPrefix(Math.max(N(n[0]),N(n[1])));if(!r[7])r[7]="."+ga(o.scale(n[2]));r[8]="f";i=I.format(r.join(""));return function(e){return i(o.scale(e))+o.symbol}}if(!r[7])r[7]="."+ma(r[8],n);i=r.join("")}else{i=",."+ga(n[2])+"f"}return I.format(i)}var pa={s:1,g:1,p:1,r:1,e:1};function ga(e){return-Math.floor(Math.log(e)/Math.LN10+.01)}function ma(e,t){var i=ga(t[2]);return e in pa?Math.abs(i-ga(Math.max(N(t[0]),N(t[1]))))+ +(e!=="e"):i-(e==="%")*2}I.scale.log=function(){return va(I.scale.linear().domain([0,1]),10,true,[1,10])};function va(t,l,c,u){function d(e){return(c?Math.log(e<0?0:e):-Math.log(e>0?0:-e))/Math.log(l)}function h(e){return c?Math.pow(l,e):-Math.pow(l,-e)}function o(e){return t(d(e))}o.invert=function(e){return h(t.invert(e))};o.domain=function(e){if(!arguments.length)return u;c=e[0]>=0;t.domain((u=e.map(Number)).map(d));return o};o.base=function(e){if(!arguments.length)return l;l=+e;t.domain(u.map(d));return o};o.nice=function(){var e=ra(u.map(d),c?Math:ba);t.domain(e);u=e.map(h);return o};o.ticks=function(){var e=ta(u),t=[],i=e[0],n=e[1],r=Math.floor(d(i)),o=Math.ceil(d(n)),s=l%1?2:l;if(isFinite(o-r)){if(c){for(;r<o;r++)for(var a=1;a<s;a++)t.push(h(r)*a);t.push(h(r))}else{t.push(h(r));for(;r++<o;)for(var a=s-1;a>0;a--)t.push(h(r)*a)}for(r=0;t[r]<i;r++){}for(o=t.length;t[o-1]>n;o--){}t=t.slice(r,o)}return t};o.tickFormat=function(e,t){if(!arguments.length)return ya;if(arguments.length<2)t=ya;else if(typeof t!=="function")t=I.format(t);var i=Math.max(.1,e/o.ticks().length),n=c?(r=1e-12,Math.ceil):(r=-1e-12,Math.floor),r;return function(e){return e/h(n(d(e)+r))<=i?t(e):""}};o.copy=function(){return va(t.copy(),l,c,u)};return ca(o,t)}var ya=I.format(".0e"),ba={floor:function(e){return-Math.ceil(-e)},ceil:function(e){return-Math.floor(-e)}};I.scale.pow=function(){return _a(I.scale.linear(),1,[0,1])};function _a(t,i,n){var r=wa(i),o=wa(1/i);function s(e){return t(r(e))}s.invert=function(e){return o(t.invert(e))};s.domain=function(e){if(!arguments.length)return n;t.domain((n=e.map(Number)).map(r));return s};s.ticks=function(e){return ha(n,e)};s.tickFormat=function(e,t){return fa(n,e,t)};s.nice=function(e){return s.domain(ua(n,e))};s.exponent=function(e){if(!arguments.length)return i;r=wa(i=e);o=wa(1/i);t.domain(n.map(r));return s};s.copy=function(){return _a(t.copy(),i,n)};return ca(s,t)}function wa(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}I.scale.sqrt=function(){return I.scale.pow().exponent(.5)};I.scale.ordinal=function(){return Ca([],{t:"range",a:[[]]})};function Ca(a,l){var r,c,u;function d(e){return c[((r.get(e)||(l.t==="range"?r.set(e,a.push(e)):NaN))-1)%c.length]}function h(t,i){return I.range(a.length).map(function(e){return t+i*e})}d.domain=function(e){if(!arguments.length)return a;a=[];r=new y;var t=-1,i=e.length,n;while(++t<i)if(!r.has(n=e[t]))r.set(n,a.push(n));return d[l.t].apply(d,l.a)};d.range=function(e){if(!arguments.length)return c;c=e;u=0;l={t:"range",a:arguments};return d};d.rangePoints=function(e,t){if(arguments.length<2)t=0;var i=e[0],n=e[1],r=a.length<2?(i=(i+n)/2,0):(n-i)/(a.length-1+t);c=h(i+r*t/2,r);u=0;l={t:"rangePoints",a:arguments};return d};d.rangeRoundPoints=function(e,t){if(arguments.length<2)t=0;var i=e[0],n=e[1],r=a.length<2?(i=n=Math.round((i+n)/2),0):(n-i)/(a.length-1+t)|0;c=h(i+Math.round(r*t/2+(n-i-(a.length-1+t)*r)/2),r);u=0;l={t:"rangeRoundPoints",a:arguments};return d};d.rangeBands=function(e,t,i){if(arguments.length<2)t=0;if(arguments.length<3)i=t;var n=e[1]<e[0],r=e[n-0],o=e[1-n],s=(o-r)/(a.length-t+2*i);c=h(r+s*i,s);if(n)c.reverse();u=s*(1-t);l={t:"rangeBands",a:arguments};return d};d.rangeRoundBands=function(e,t,i){if(arguments.length<2)t=0;if(arguments.length<3)i=t;var n=e[1]<e[0],r=e[n-0],o=e[1-n],s=Math.floor((o-r)/(a.length-t+2*i));c=h(r+Math.round((o-r-(a.length-t)*s)/2),s);if(n)c.reverse();u=Math.round(s*(1-t));l={t:"rangeRoundBands",a:arguments};return d};d.rangeBand=function(){return u};d.rangeExtent=function(){return ta(l.a[0])};d.copy=function(){return Ca(a,l)};return d.domain(a)}I.scale.category10=function(){return I.scale.ordinal().range(xa)};I.scale.category20=function(){return I.scale.ordinal().range(Sa)};I.scale.category20b=function(){return I.scale.ordinal().range(Aa)};I.scale.category20c=function(){return I.scale.ordinal().range(Ea)};var xa=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Dt);var Sa=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Dt);var Aa=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Dt);var Ea=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Dt);I.scale.quantile=function(){return Ta([],[])};function Ta(i,n){var r;function t(){var e=0,t=n.length;r=[];while(++e<t)r[e-1]=I.quantile(i,e/t);return o}function o(e){if(!isNaN(e=+e))return n[I.bisect(r,e)]}o.domain=function(e){if(!arguments.length)return i;i=e.map(z).filter(c).sort(j);return t()};o.range=function(e){if(!arguments.length)return n;n=e;return t()};o.quantiles=function(){return r};o.invertExtent=function(e){e=n.indexOf(e);return e<0?[NaN,NaN]:[e>0?r[e-1]:i[0],e<r.length?r[e]:i[i.length-1]]};o.copy=function(){return Ta(i,n)};return t()}I.scale.quantize=function(){return Da(0,1,[0,1])};function Da(t,i,n){var r,o;function e(e){return n[Math.max(0,Math.min(o,Math.floor(r*(e-t))))]}function s(){r=n.length/(i-t);o=n.length-1;return e}e.domain=function(e){if(!arguments.length)return[t,i];t=+e[0];i=+e[e.length-1];return s()};e.range=function(e){if(!arguments.length)return n;n=e;return s()};e.invertExtent=function(e){e=n.indexOf(e);e=e<0?NaN:e/r+t;return[e,e+1/r]};e.copy=function(){return Da(t,i,n)};return s()}I.scale.threshold=function(){return Ra([.5],[0,1])};function Ra(t,i){function n(e){if(e<=e)return i[I.bisect(t,e)]}n.domain=function(e){if(!arguments.length)return t;t=e;return n};n.range=function(e){if(!arguments.length)return i;i=e;return n};n.invertExtent=function(e){e=i.indexOf(e);return[t[e-1],t[e]]};n.copy=function(){return Ra(t,i)};return n}I.scale.identity=function(){return Ma([0,1])};function Ma(i){function t(e){return+e}t.invert=t;t.domain=t.range=function(e){if(!arguments.length)return i;i=e.map(t);return t};t.ticks=function(e){return ha(i,e)};t.tickFormat=function(e,t){return fa(i,e,t)};t.copy=function(){return Ma(i)};return t}I.svg={};function ka(){return 0}I.svg.arc=function(){var G=Na,$=Ia,H=ka,B=Oa,V=La,j=Pa,z=Fa;function t(){var e=Math.max(0,+G.apply(this,arguments)),t=Math.max(0,+$.apply(this,arguments)),i=V.apply(this,arguments)-Y,n=j.apply(this,arguments)-Y,L=Math.abs(n-i),r=i>n?0:1;if(t<e)o=t,t=e,e=o;if(L>=Ze)return W(t,r)+(e?W(e,1-r):"")+"Z";var o,s,a,l,c=0,u=0,d,h,f,p,g,m,v,y,b=[];if(l=(+z.apply(this,arguments)||0)/2){a=B===Oa?Math.sqrt(e*e+t*t):+B.apply(this,arguments);if(!r)u*=-1;if(t)u=tt(a/t*Math.sin(l));if(e)c=tt(a/e*Math.sin(l))}if(t){d=t*Math.cos(i+u);h=t*Math.sin(i+u);f=t*Math.cos(n-u);p=t*Math.sin(n-u);var _=Math.abs(n-i-2*u)<=U?0:1;if(u&&Ga(d,h,f,p)===r^_){var w=(i+n)/2;d=t*Math.cos(w);h=t*Math.sin(w);f=p=null}}else{d=h=0}if(e){g=e*Math.cos(n-c);m=e*Math.sin(n-c);v=e*Math.cos(i+c);y=e*Math.sin(i+c);var C=Math.abs(i-n+2*c)<=U?0:1;if(c&&Ga(g,m,v,y)===1-r^C){var x=(i+n)/2;g=e*Math.cos(x);m=e*Math.sin(x);v=y=null}}else{g=m=0}if((o=Math.min(Math.abs(t-e)/2,+H.apply(this,arguments)))>.001){s=e<t^r?0:1;var S=v==null?[g,m]:f==null?[d,h]:kr([d,h],[v,y],[f,p],[g,m]),A=d-S[0],E=h-S[1],T=f-S[0],D=p-S[1],P=1/Math.sin(Math.acos((A*T+E*D)/(Math.sqrt(A*A+E*E)*Math.sqrt(T*T+D*D)))/2),F=Math.sqrt(S[0]*S[0]+S[1]*S[1]);if(f!=null){var R=Math.min(o,(t-F)/(P+1)),M=$a(v==null?[g,m]:[v,y],[d,h],t,R,r),k=$a([f,p],[g,m],t,R,r);if(o===R){b.push("M",M[0],"A",R,",",R," 0 0,",s," ",M[1],"A",t,",",t," 0 ",1-r^Ga(M[1][0],M[1][1],k[1][0],k[1][1]),",",r," ",k[1],"A",R,",",R," 0 0,",s," ",k[0])}else{b.push("M",M[0],"A",R,",",R," 0 1,",s," ",k[0])}}else{b.push("M",d,",",h)}if(v!=null){var O=Math.min(o,(e-F)/(P-1)),N=$a([d,h],[v,y],e,-O,r),I=$a([g,m],f==null?[d,h]:[f,p],e,-O,r);if(o===O){b.push("L",I[0],"A",O,",",O," 0 0,",s," ",I[1],"A",e,",",e," 0 ",r^Ga(I[1][0],I[1][1],N[1][0],N[1][1]),",",1-r," ",N[1],"A",O,",",O," 0 0,",s," ",N[0])}else{b.push("L",I[0],"A",O,",",O," 0 0,",s," ",N[0])}}else{b.push("L",g,",",m)}}else{b.push("M",d,",",h);if(f!=null)b.push("A",t,",",t," 0 ",_,",",r," ",f,",",p);b.push("L",g,",",m);if(v!=null)b.push("A",e,",",e," 0 ",C,",",1-r," ",v,",",y)}b.push("Z");return b.join("")}function W(e,t){return"M0,"+e+"A"+e+","+e+" 0 1,"+t+" 0,"+-e+"A"+e+","+e+" 0 1,"+t+" 0,"+e}t.innerRadius=function(e){if(!arguments.length)return G;G=E(e);return t};t.outerRadius=function(e){if(!arguments.length)return $;$=E(e);return t};t.cornerRadius=function(e){if(!arguments.length)return H;H=E(e);return t};t.padRadius=function(e){if(!arguments.length)return B;B=e==Oa?Oa:E(e);return t};t.startAngle=function(e){if(!arguments.length)return V;V=E(e);return t};t.endAngle=function(e){if(!arguments.length)return j;j=E(e);return t};t.padAngle=function(e){if(!arguments.length)return z;z=E(e);return t};t.centroid=function(){var e=(+G.apply(this,arguments)+ +$.apply(this,arguments))/2,t=(+V.apply(this,arguments)+ +j.apply(this,arguments))/2-Y;return[Math.cos(t)*e,Math.sin(t)*e]};return t};var Oa="auto";function Na(e){return e.innerRadius}function Ia(e){return e.outerRadius}function La(e){return e.startAngle}function Pa(e){return e.endAngle}function Fa(e){return e&&e.padAngle}function Ga(e,t,i,n){return(e-i)*t-(t-n)*e>0?0:1}function $a(e,t,i,n,r){var o=e[0]-t[0],s=e[1]-t[1],a=(r?n:-n)/Math.sqrt(o*o+s*s),l=a*s,c=-a*o,u=e[0]+l,d=e[1]+c,h=t[0]+l,f=t[1]+c,p=(u+h)/2,g=(d+f)/2,m=h-u,v=f-d,y=m*m+v*v,b=i-n,_=u*f-h*d,w=(v<0?-1:1)*Math.sqrt(b*b*y-_*_),C=(_*v-m*w)/y,x=(-_*m-v*w)/y,S=(_*v+m*w)/y,A=(-_*m+v*w)/y,E=C-p,T=x-g,D=S-p,R=A-g;if(E*E+T*T>D*D+R*R)C=S,x=A;return[[C-l,x-c],[C*i/b,x*i/b]]}function Ha(c){var u=Ar,d=Er,h=cn,f=T,t=f.key,p=.7;function i(e){var t=[],i=[],n=-1,r=e.length,o,s=E(u),a=E(d);function l(){t.push("M",f(c(i),p))}while(++n<r){if(h.call(this,o=e[n],n)){i.push([+s.call(this,o,n),+a.call(this,o,n)])}else if(i.length){l();i=[]}}if(i.length)l();return t.length?t.join(""):null}i.x=function(e){if(!arguments.length)return u;u=e;return i};i.y=function(e){if(!arguments.length)return d;d=e;return i};i.defined=function(e){if(!arguments.length)return h;h=e;return i};i.interpolate=function(e){if(!arguments.length)return t;if(typeof e==="function")t=f=e;else t=(f=Ba.get(e)||T).key;return i};i.tension=function(e){if(!arguments.length)return p;p=e;return i};return i}I.svg.line=function(){return Ha(P)};var Ba=I.map({linear:T,"linear-closed":Va,step:ja,"step-before":za,"step-after":Wa,basis:Za,"basis-open":Qa,"basis-closed":Ja,bundle:el,cardinal:qa,"cardinal-open":Ua,"cardinal-closed":Ya,monotone:ll});Ba.forEach(function(e,t){t.key=e;t.closed=/-closed$/.test(e)});function T(e){return e.join("L")}function Va(e){return T(e)+"Z"}function ja(e){var t=0,i=e.length,n=e[0],r=[n[0],",",n[1]];while(++t<i)r.push("H",(n[0]+(n=e[t])[0])/2,"V",n[1]);if(i>1)r.push("H",n[0]);return r.join("")}function za(e){var t=0,i=e.length,n=e[0],r=[n[0],",",n[1]];while(++t<i)r.push("V",(n=e[t])[1],"H",n[0]);return r.join("")}function Wa(e){var t=0,i=e.length,n=e[0],r=[n[0],",",n[1]];while(++t<i)r.push("H",(n=e[t])[0],"V",n[1]);return r.join("")}function Ua(e,t){return e.length<4?T(e):e[1]+Ka(e.slice(1,-1),Xa(e,t))}function Ya(e,t){return e.length<3?T(e):e[0]+Ka((e.push(e[0]),e),Xa([e[e.length-2]].concat(e,[e[1]]),t))}function qa(e,t){return e.length<3?T(e):e[0]+Ka(e,Xa(e,t))}function Ka(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2){return T(e)}var i=e.length!=t.length,n="",r=e[0],o=e[1],s=t[0],a=s,l=1;if(i){n+="Q"+(o[0]-s[0]*2/3)+","+(o[1]-s[1]*2/3)+","+o[0]+","+o[1];r=e[1];l=2}if(t.length>1){a=t[1];o=e[l];l++;n+="C"+(r[0]+s[0])+","+(r[1]+s[1])+","+(o[0]-a[0])+","+(o[1]-a[1])+","+o[0]+","+o[1];for(var c=2;c<t.length;c++,l++){o=e[l];a=t[c];n+="S"+(o[0]-a[0])+","+(o[1]-a[1])+","+o[0]+","+o[1]}}if(i){var u=e[l];n+="Q"+(o[0]+a[0]*2/3)+","+(o[1]+a[1]*2/3)+","+u[0]+","+u[1]}return n}function Xa(e,t){var i=[],n=(1-t)/2,r,o=e[0],s=e[1],a=1,l=e.length;while(++a<l){r=o;o=s;s=e[a];i.push([n*(s[0]-r[0]),n*(s[1]-r[1])])}return i}function Za(e){if(e.length<3)return T(e);var t=1,i=e.length,n=e[0],r=n[0],o=n[1],s=[r,r,r,(n=e[1])[0]],a=[o,o,o,n[1]],l=[r,",",o,"L",p(nl,s),",",p(nl,a)];e.push(e[i-1]);while(++t<=i){n=e[t];s.shift();s.push(n[0]);a.shift();a.push(n[1]);rl(l,s,a)}e.pop();l.push("L",n);return l.join("")}function Qa(e){if(e.length<4)return T(e);var t=[],i=-1,n=e.length,r,o=[0],s=[0];while(++i<3){r=e[i];o.push(r[0]);s.push(r[1])}t.push(p(nl,o)+","+p(nl,s));--i;while(++i<n){r=e[i];o.shift();o.push(r[0]);s.shift();s.push(r[1]);rl(t,o,s)}return t.join("")}function Ja(e){var t,i=-1,n=e.length,r=n+4,o,s=[],a=[];while(++i<4){o=e[i%n];s.push(o[0]);a.push(o[1])}t=[p(nl,s),",",p(nl,a)];--i;while(++i<r){o=e[i%n];s.shift();s.push(o[0]);a.shift();a.push(o[1]);rl(t,s,a)}return t.join("")}function el(e,t){var i=e.length-1;if(i){var n=e[0][0],r=e[0][1],o=e[i][0]-n,s=e[i][1]-r,a=-1,l,c;while(++a<=i){l=e[a];c=a/i;l[0]=t*l[0]+(1-t)*(n+c*o);l[1]=t*l[1]+(1-t)*(r+c*s)}}return Za(e)}function p(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}var tl=[0,2/3,1/3,0],il=[0,1/3,2/3,0],nl=[0,1/6,2/3,1/6];function rl(e,t,i){e.push("C",p(tl,t),",",p(tl,i),",",p(il,t),",",p(il,i),",",p(nl,t),",",p(nl,i))}function ol(e,t){return(t[1]-e[1])/(t[0]-e[0])}function sl(e){var t=0,i=e.length-1,n=[],r=e[0],o=e[1],s=n[0]=ol(r,o);while(++t<i){n[t]=(s+(s=ol(r=o,o=e[t+1])))/2}n[t]=s;return n}function al(e){var t=[],i,n,r,o,s=sl(e),a=-1,l=e.length-1;while(++a<l){i=ol(e[a],e[a+1]);if(N(i)<F){s[a]=s[a+1]=0}else{n=s[a]/i;r=s[a+1]/i;o=n*n+r*r;if(o>9){o=i*3/Math.sqrt(o);s[a]=o*n;s[a+1]=o*r}}}a=-1;while(++a<=l){o=(e[Math.min(l,a+1)][0]-e[Math.max(0,a-1)][0])/(6*(1+s[a]*s[a]));t.push([o||0,s[a]*o||0])}return t}function ll(e){return e.length<3?T(e):e[0]+Ka(e,al(e))}I.svg.line.radial=function(){var e=Ha(cl);e.radius=e.x,delete e.x;e.angle=e.y,delete e.y;return e};function cl(e){var t,i=-1,n=e.length,r,o;while(++i<n){t=e[i];r=t[0];o=t[1]-Y;t[0]=r*Math.cos(o);t[1]=r*Math.sin(o)}return e}function ul(p){var g=Ar,m=Ar,v=0,y=Er,b=cn,_=T,t=_.key,w=_,C="L",x=.7;function i(e){var t=[],i=[],n=[],r=-1,o=e.length,s,a=E(g),l=E(v),c=g===m?function(){return d}:E(m),u=v===y?function(){return h}:E(y),d,h;function f(){t.push("M",_(p(n),x),C,w(p(i.reverse()),x),"Z")}while(++r<o){if(b.call(this,s=e[r],r)){i.push([d=+a.call(this,s,r),h=+l.call(this,s,r)]);n.push([+c.call(this,s,r),+u.call(this,s,r)])}else if(i.length){f();i=[];n=[]}}if(i.length)f();return t.length?t.join(""):null}i.x=function(e){if(!arguments.length)return m;g=m=e;return i};i.x0=function(e){if(!arguments.length)return g;g=e;return i};i.x1=function(e){if(!arguments.length)return m;m=e;return i};i.y=function(e){if(!arguments.length)return y;v=y=e;return i};i.y0=function(e){if(!arguments.length)return v;v=e;return i};i.y1=function(e){if(!arguments.length)return y;y=e;return i};i.defined=function(e){if(!arguments.length)return b;b=e;return i};i.interpolate=function(e){if(!arguments.length)return t;if(typeof e==="function")t=_=e;else t=(_=Ba.get(e)||T).key;w=_.reverse||_;C=_.closed?"M":"L";return i};i.tension=function(e){if(!arguments.length)return x;x=e;return i};return i}za.reverse=Wa;Wa.reverse=za;I.svg.area=function(){return ul(P)};I.svg.area.radial=function(){var e=ul(cl);e.radius=e.x,delete e.x;e.innerRadius=e.x0,delete e.x0;e.outerRadius=e.x1,delete e.x1;e.angle=e.y,delete e.y;e.startAngle=e.y0,delete e.y0;e.endAngle=e.y1,delete e.y1;return e};I.svg.chord=function(){var r=lr,o=cr,l=dl,c=La,u=Pa;function t(e,t){var i=s(this,r,e,t),n=s(this,o,e,t);return"M"+i.p0+d(i.r,i.p1,i.a1-i.a0)+(a(i,n)?h(i.r,i.p1,i.r,i.p0):h(i.r,i.p1,n.r,n.p0)+d(n.r,n.p1,n.a1-n.a0)+h(n.r,n.p1,i.r,i.p0))+"Z"}function s(e,t,i,n){var r=t.call(e,i,n),o=l.call(e,r,n),s=c.call(e,r,n)-Y,a=u.call(e,r,n)-Y;return{r:o,a0:s,a1:a,p0:[o*Math.cos(s),o*Math.sin(s)],p1:[o*Math.cos(a),o*Math.sin(a)]}}function a(e,t){return e.a0==t.a0&&e.a1==t.a1}function d(e,t,i){return"A"+e+","+e+" 0 "+ +(i>U)+",1 "+t}function h(e,t,i,n){return"Q 0,0 "+n}t.radius=function(e){if(!arguments.length)return l;l=E(e);return t};t.source=function(e){if(!arguments.length)return r;r=E(e);return t};t.target=function(e){if(!arguments.length)return o;o=E(e);return t};t.startAngle=function(e){if(!arguments.length)return c;c=E(e);return t};t.endAngle=function(e){if(!arguments.length)return u;u=E(e);return t};return t};function dl(e){return e.radius}I.svg.diagonal=function(){var s=lr,a=cr,l=hl;function t(e,t){var i=s.call(this,e,t),n=a.call(this,e,t),r=(i.y+n.y)/2,o=[i,{x:i.x,y:r},{x:n.x,y:r},n];o=o.map(l);return"M"+o[0]+"C"+o[1]+" "+o[2]+" "+o[3]}t.source=function(e){if(!arguments.length)return s;s=E(e);return t};t.target=function(e){if(!arguments.length)return a;a=E(e);return t};t.projection=function(e){if(!arguments.length)return l;l=e;return t};return t};function hl(e){return[e.x,e.y]}I.svg.diagonal.radial=function(){var e=I.svg.diagonal(),t=hl,i=e.projection;e.projection=function(e){return arguments.length?i(fl(t=e)):t};return e};function fl(n){return function(){var e=n.apply(this,arguments),t=e[0],i=e[1]-Y;return[t*Math.cos(i),t*Math.sin(i)]}}I.svg.symbol=function(){var i=gl,n=pl;function t(e,t){return(vl.get(i.call(this,e,t))||ml)(n.call(this,e,t))}t.type=function(e){if(!arguments.length)return i;i=E(e);return t};t.size=function(e){if(!arguments.length)return n;n=E(e);return t};return t};function pl(){return 64}function gl(){return"circle"}function ml(e){var t=Math.sqrt(e/U);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}var vl=I.map({circle:ml,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*bl)),i=t*bl;return"M0,"+-t+"L"+i+",0"+" 0,"+t+" "+-i+",0"+"Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/yl),i=t*yl/2;return"M0,"+i+"L"+t+","+-i+" "+-t+","+-i+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/yl),i=t*yl/2;return"M0,"+-i+"L"+t+","+i+" "+-t+","+i+"Z"}});I.svg.symbolTypes=vl.keys();var yl=Math.sqrt(3),bl=Math.tan(30*S);i.transition=function(e){var t=Sl||++xl,i=Dl(e),n=[],r,o,s=Al||{time:Date.now(),ease:Fo,delay:0,duration:250};for(var a=-1,l=this.length;++a<l;){n.push(r=[]);for(var c=this[a],u=-1,d=c.length;++u<d;){if(o=c[u])Rl(o,u,i,t,s);r.push(o)}}return Cl(n,i,t)};i.interrupt=function(e){return this.each(e==null?_l:wl(Dl(e)))};var _l=wl(Dl());function wl(i){return function(){var e,t;if((e=this[i])&&(t=e[e.active])){if(--e.count)delete e[e.active];else delete this[i];e.active+=.5;t.event&&t.event.interrupt.call(this,this.__data__,t.index)}}}function Cl(e,t,i){ve(e,o);e.namespace=t;e.id=i;return e}var o=[],xl=0,Sl,Al;o.call=i.call;o.empty=i.empty;o.node=i.node;o.size=i.size;I.transition=function(e,t){return e&&e.transition?Sl?e.transition(t):e:I.selection().transition(e)};I.transition.prototype=o;o.select=function(e){var t=this.id,i=this.namespace,n=[],r,o,s;e=Ce(e);for(var a=-1,l=this.length;++a<l;){n.push(r=[]);for(var c=this[a],u=-1,d=c.length;++u<d;){if((s=c[u])&&(o=e.call(s,s.__data__,u,a))){if("__data__"in s)o.__data__=s.__data__;Rl(o,u,i,t,s[i][t]);r.push(o)}else{r.push(null)}}}return Cl(n,i,t)};o.selectAll=function(e){var t=this.id,i=this.namespace,n=[],r,o,s,a,l;e=xe(e);for(var c=-1,u=this.length;++c<u;){for(var d=this[c],h=-1,f=d.length;++h<f;){if(s=d[h]){l=s[i][t];o=e.call(s,s.__data__,h,c);n.push(r=[]);for(var p=-1,g=o.length;++p<g;){if(a=o[p])Rl(a,p,i,t,l);r.push(a)}}}}return Cl(n,i,t)};o.filter=function(e){var t=[],i,n,r;if(typeof e!=="function")e=Pe(e);for(var o=0,s=this.length;o<s;o++){t.push(i=[]);for(var n=this[o],a=0,l=n.length;a<l;a++){if((r=n[a])&&e.call(r,r.__data__,a,o)){i.push(r)}}}return Cl(t,this.namespace,this.id)};o.tween=function(t,i){var n=this.id,r=this.namespace;if(arguments.length<2)return this.node()[r][n].tween.get(t);return l(this,i==null?function(e){e[r][n].tween.remove(t)}:function(e){e[r][n].tween.set(t,i)})};function El(e,n,r,o){var s=e.id,a=e.namespace;return l(e,typeof r==="function"?function(e,t,i){e[a][s].tween.set(n,o(r.call(e,e.__data__,t,i)))}:(r=o(r),function(e){e[a][s].tween.set(n,r)}))}o.attr=function(e,t){if(arguments.length<2){for(t in e)this.attr(t,e[t]);return this}var n=e=="transform"?es:To,r=I.ns.qualify(e);function o(){this.removeAttribute(r)}function s(){this.removeAttributeNS(r.space,r.local)}function i(i){return i==null?o:(i+="",function(){var e=this.getAttribute(r),t;return e!==i&&(t=n(e,i),function(e){this.setAttribute(r,t(e))})})}function a(i){return i==null?s:(i+="",function(){var e=this.getAttributeNS(r.space,r.local),t;return e!==i&&(t=n(e,i),function(e){this.setAttributeNS(r.space,r.local,t(e))})})}return El(this,"attr."+e,t,r.local?a:i)};o.attrTween=function(e,n){var r=I.ns.qualify(e);function t(e,t){var i=n.call(this,e,t,this.getAttribute(r));return i&&function(e){this.setAttribute(r,i(e))}}function i(e,t){var i=n.call(this,e,t,this.getAttributeNS(r.space,r.local));return i&&function(e){this.setAttributeNS(r.space,r.local,i(e))}}return this.tween("attr."+e,r.local?i:t)};o.style=function(n,e,r){var t=arguments.length;if(t<3){if(typeof n!=="string"){if(t<2)e="";for(r in n)this.style(r,n[r],e);return this}r=""}function o(){this.style.removeProperty(n)}function i(i){return i==null?o:(i+="",function(){var e=$(this).getComputedStyle(this,null).getPropertyValue(n),t;return e!==i&&(t=To(e,i),function(e){this.style.setProperty(n,t(e),r)})})}return El(this,"style."+n,e,i)};o.styleTween=function(n,r,o){if(arguments.length<3)o="";function e(e,t){var i=r.call(this,e,t,$(this).getComputedStyle(this,null).getPropertyValue(n));return i&&function(e){this.style.setProperty(n,i(e),o)}}return this.tween("style."+n,e)};o.text=function(e){return El(this,"text",e,Tl)};function Tl(e){if(e==null)e="";return function(){this.textContent=e}}o.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var e;if(this[t].count<2&&(e=this.parentNode))e.removeChild(this)})};o.ease=function(t){var i=this.id,n=this.namespace;if(arguments.length<1)return this.node()[n][i].ease;if(typeof t!=="function")t=I.ease.apply(I,arguments);return l(this,function(e){e[n][i].ease=t})};o.delay=function(n){var r=this.id,o=this.namespace;if(arguments.length<1)return this.node()[o][r].delay;return l(this,typeof n==="function"?function(e,t,i){e[o][r].delay=+n.call(e,e.__data__,t,i)}:(n=+n,function(e){e[o][r].delay=n}))};o.duration=function(n){var r=this.id,o=this.namespace;if(arguments.length<1)return this.node()[o][r].duration;return l(this,typeof n==="function"?function(e,t,i){e[o][r].duration=Math.max(1,n.call(e,e.__data__,t,i))}:(n=Math.max(1,n),function(e){e[o][r].duration=n}))};o.each=function(n,i){var r=this.id,o=this.namespace;if(arguments.length<2){var e=Al,t=Sl;try{Sl=r;l(this,function(e,t,i){Al=e[o][r];n.call(e,e.__data__,t,i)})}finally{Al=e;Sl=t}}else{l(this,function(e){var t=e[o][r];(t.event||(t.event=I.dispatch("start","end","interrupt"))).on(n,i)})}return this};o.transition=function(){var e=this.id,t=++xl,i=this.namespace,n=[],r,o,s,a;for(var l=0,c=this.length;l<c;l++){n.push(r=[]);for(var o=this[l],u=0,d=o.length;u<d;u++){if(s=o[u]){a=s[i][e];Rl(s,u,i,t,{time:a.time,ease:a.ease,delay:a.delay+a.duration,duration:a.duration})}r.push(s)}}return Cl(n,i,t)};function Dl(e){return e==null?"__transition__":"__transition_"+e+"__"}function Rl(c,u,d,h,e){var f=c[d]||(c[d]={active:0,count:0}),p=f[h];if(!p){var g=e.time;p=f[h]={tween:new y,time:g,delay:e.delay,duration:e.duration,ease:e.ease,index:u};e=null;++f.count;I.timer(function(e){var t=p.delay,r,o,i=m,s=[];i.t=t+g;if(t<=e)return n(e-t);i.c=n;function n(e){if(f.active>h)return l();var t=f[f.active];if(t){--f.count;delete f[f.active];t.event&&t.event.interrupt.call(c,c.__data__,t.index)}f.active=h;p.event&&p.event.start.call(c,c.__data__,u);p.tween.forEach(function(e,t){if(t=t.call(c,c.__data__,u)){s.push(t)}});o=p.ease;r=p.duration;I.timer(function(){i.c=a(e||1)?cn:a;return 1},0,g)}function a(e){if(f.active!==h)return 1;var t=e/r,i=o(t),n=s.length;while(n>0){s[--n].call(c,i)}if(t>=1){p.event&&p.event.end.call(c,c.__data__,u);return l()}}function l(){if(--f.count)delete f[h];else delete c[d];return 1}},0,g)}}I.svg.axis=function(){var E=I.scale.linear(),T=Ml,D=6,R=6,M=3,k=[10],O=null,N;function i(e){e.each(function(){var e=I.select(this);var t=this.__chart__||E,i=this.__chart__=E.copy();var n=O==null?i.ticks?i.ticks.apply(i,k):i.domain():O,r=N==null?i.tickFormat?i.tickFormat.apply(i,k):P:N,o=e.selectAll(".tick").data(n,i),s=o.enter().insert("g",".domain").attr("class","tick").style("opacity",F),a=I.transition(o.exit()).style("opacity",F).remove(),l=I.transition(o.order()).style("opacity",1),c=Math.max(D,0)+M,u;var d=ia(i),h=e.selectAll(".domain").data([0]),f=(h.enter().append("path").attr("class","domain"),I.transition(h));s.append("line");s.append("text");var p=s.select("line"),g=l.select("line"),m=o.select("text").text(r),v=s.select("text"),y=l.select("text"),b=T==="top"||T==="left"?-1:1,_,w,C,x;if(T==="bottom"||T==="top"){u=Ol,_="x",C="y",w="x2",x="y2";m.attr("dy",b<0?"0em":".71em").style("text-anchor","middle");f.attr("d","M"+d[0]+","+b*R+"V0H"+d[1]+"V"+b*R)}else{u=Nl,_="y",C="x",w="y2",x="x2";m.attr("dy",".32em").style("text-anchor",b<0?"end":"start");f.attr("d","M"+b*R+","+d[0]+"H0V"+d[1]+"H"+b*R)}p.attr(x,b*D);v.attr(C,b*c);g.attr(w,0).attr(x,b*D);y.attr(_,0).attr(C,b*c);if(i.rangeBand){var S=i,A=S.rangeBand()/2;t=i=function(e){return S(e)+A}}else if(t.rangeBand){t=i}else{a.call(u,i,t)}s.call(u,t,i);l.call(u,i,i)})}i.scale=function(e){if(!arguments.length)return E;E=e;return i};i.orient=function(e){if(!arguments.length)return T;T=e in kl?e+"":Ml;return i};i.ticks=function(){if(!arguments.length)return k;k=arguments;return i};i.tickValues=function(e){if(!arguments.length)return O;O=e;return i};i.tickFormat=function(e){if(!arguments.length)return N;N=e;return i};i.tickSize=function(e){var t=arguments.length;if(!t)return D;D=+e;R=+arguments[t-1];return i};i.innerTickSize=function(e){if(!arguments.length)return D;D=+e;return i};i.outerTickSize=function(e){if(!arguments.length)return R;R=+e;return i};i.tickPadding=function(e){if(!arguments.length)return M;M=+e;return i};i.tickSubdivide=function(){return arguments.length&&i};return i};var Ml="bottom",kl={top:1,right:1,bottom:1,left:1};function Ol(e,i,n){e.attr("transform",function(e){var t=i(e);return"translate("+(isFinite(t)?t:n(e))+",0)"})}function Nl(e,i,n){e.attr("transform",function(e){var t=i(e);return"translate(0,"+(isFinite(t)?t:n(e))+")"})}I.svg.brush=function(){var _=ge(R,"brushstart","brush","brushend"),w=null,C=null,x=[0,0],S=[0,0],A,E,T=true,D=true,s=Ll[0];function R(e){e.each(function(){var e=I.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",a).on("touchstart.brush",a);var t=e.selectAll(".background").data([0]);t.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");e.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var i=e.selectAll(".resize").data(s,P);i.exit().remove();i.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return Il[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden");i.style("display",R.empty()?"none":null);var n=I.transition(e),r=I.transition(t),o;if(w){o=ia(w);r.attr("x",o[0]).attr("width",o[1]-o[0]);k(n)}if(C){o=ia(C);r.attr("y",o[0]).attr("height",o[1]-o[0]);O(n)}M(n)})}R.event=function(e){e.each(function(){var n=_.of(this,arguments),r={x:x,y:S,i:A,j:E},e=this.__chart__||r;this.__chart__=r;if(Sl){I.select(this).transition().each("start.brush",function(){A=e.i;E=e.j;x=e.x;S=e.y;n({type:"brushstart"})}).tween("brush:brush",function(){var t=Do(x,r.x),i=Do(S,r.y);A=E=null;return function(e){x=r.x=t(e);S=r.y=i(e);n({type:"brush",mode:"resize"})}}).each("end.brush",function(){A=r.i;E=r.j;n({type:"brush",mode:"resize"});n({type:"brushend"})})}else{n({type:"brushstart"});n({type:"brush",mode:"resize"});n({type:"brushend"})}})};function M(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+x[+/e$/.test(e)]+","+S[+/^s/.test(e)]+")"})}function k(e){e.select(".extent").attr("x",x[0]);e.selectAll(".extent,.n>rect,.s>rect").attr("width",x[1]-x[0])}function O(e){e.select(".extent").attr("y",S[0]);e.selectAll(".extent,.e>rect,.w>rect").attr("height",S[1]-S[0])}function a(){var i=this,e=I.select(I.event.target),n=_.of(i,arguments),r=I.select(i),t=e.datum(),o=!/^(n|s)$/.test(t)&&w,s=!/^(e|w)$/.test(t)&&C,d=e.classed("extent"),a=Ue(i),h,f=I.mouse(i),l;var c=I.select($(i)).on("keydown.brush",g).on("keyup.brush",m);if(I.event.changedTouches){c.on("touchmove.brush",v).on("touchend.brush",b)}else{c.on("mousemove.brush",v).on("mouseup.brush",b)}r.interrupt().selectAll("*").interrupt();if(d){f[0]=x[0]-f[0];f[1]=S[0]-f[1]}else if(t){var u=+/w$/.test(t),p=+/^n/.test(t);l=[x[1-u]-f[0],S[1-p]-f[1]];f[0]=x[u];f[1]=S[p]}else if(I.event.altKey)h=f.slice();r.style("pointer-events","none").selectAll(".resize").style("display",null);I.select("body").style("cursor",e.style("cursor"));n({type:"brushstart"});v();function g(){if(I.event.keyCode==32){if(!d){h=null;f[0]-=x[1];f[1]-=S[1];d=2}fe()}}function m(){if(I.event.keyCode==32&&d==2){f[0]+=x[1];f[1]+=S[1];d=0;fe()}}function v(){var e=I.mouse(i),t=false;if(l){e[0]+=l[0];e[1]+=l[1]}if(!d){if(I.event.altKey){if(!h)h=[(x[0]+x[1])/2,(S[0]+S[1])/2];f[0]=x[+(e[0]<h[0])];f[1]=S[+(e[1]<h[1])]}else h=null}if(o&&y(e,w,0)){k(r);t=true}if(s&&y(e,C,1)){O(r);t=true}if(t){M(r);n({type:"brush",mode:d?"move":"resize"})}}function y(e,t,i){var n=ia(t),r=n[0],o=n[1],s=f[i],a=i?S:x,l=a[1]-a[0],c,u;if(d){r-=s;o-=l+s}c=(i?D:T)?Math.max(r,Math.min(o,e[i])):e[i];if(d){u=(c+=s)+l}else{if(h)s=Math.max(r,Math.min(o,2*h[i]-c));if(s<c){u=c;c=s}else{u=s}}if(a[0]!=c||a[1]!=u){if(i)E=null;else A=null;a[0]=c;a[1]=u;return true}}function b(){v();r.style("pointer-events","all").selectAll(".resize").style("display",R.empty()?"none":null);I.select("body").style("cursor",null);c.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);a();n({type:"brushend"})}}R.x=function(e){if(!arguments.length)return w;w=e;s=Ll[!w<<1|!C];return R};R.y=function(e){if(!arguments.length)return C;C=e;s=Ll[!w<<1|!C];return R};R.clamp=function(e){if(!arguments.length)return w&&C?[T,D]:w?T:C?D:null;if(w&&C)T=!!e[0],D=!!e[1];else if(w)T=!!e;else if(C)D=!!e;return R};R.extent=function(e){var t,i,n,r,o;if(!arguments.length){if(w){if(A){t=A[0],i=A[1]}else{t=x[0],i=x[1];if(w.invert)t=w.invert(t),i=w.invert(i);if(i<t)o=t,t=i,i=o}}if(C){if(E){n=E[0],r=E[1]}else{n=S[0],r=S[1];if(C.invert)n=C.invert(n),r=C.invert(r);if(r<n)o=n,n=r,r=o}}return w&&C?[[t,n],[i,r]]:w?[t,i]:C&&[n,r]}if(w){t=e[0],i=e[1];if(C)t=t[0],i=i[0];A=[t,i];if(w.invert)t=w(t),i=w(i);if(i<t)o=t,t=i,i=o;if(t!=x[0]||i!=x[1])x=[t,i]}if(C){n=e[0],r=e[1];if(w)n=n[1],r=r[1];E=[n,r];if(C.invert)n=C(n),r=C(r);if(r<n)o=n,n=r,r=o;if(n!=S[0]||r!=S[1])S=[n,r]}return R};R.clear=function(){if(!R.empty()){x=[0,0],S=[0,0];A=E=null}return R};R.empty=function(){return!!w&&x[0]==x[1]||!!C&&S[0]==S[1]};return I.rebind(R,_,"on")};var Il={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};var Ll=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];var Pl=M.format=Ei.timeFormat;var Fl=Pl.utc;var Gl=Fl("%Y-%m-%dT%H:%M:%S.%LZ");Pl.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?$l:Gl;function $l(e){return e.toISOString()}$l.parse=function(e){var t=new Date(e);return isNaN(t)?null:t};$l.toString=Gl.toString;M.second=ii(function(e){return new k(Math.floor(e/1e3)*1e3)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*1e3)},function(e){return e.getSeconds()});M.seconds=M.second.range;M.seconds.utc=M.second.utc.range;M.minute=ii(function(e){return new k(Math.floor(e/6e4)*6e4)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*6e4)},function(e){return e.getMinutes()});M.minutes=M.minute.range;M.minutes.utc=M.minute.utc.range;M.hour=ii(function(e){var t=e.getTimezoneOffset()/60;return new k((Math.floor(e/36e5-t)+t)*36e5)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*36e5)},function(e){return e.getHours()});M.hours=M.hour.range;M.hours.utc=M.hour.utc.range;M.month=ii(function(e){e=M.day(e);e.setDate(1);return e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()});M.months=M.month.range;M.months.utc=M.month.utc.range;function Hl(t,o,e){function s(e){return t(e)}s.invert=function(e){return Bl(t.invert(e))};s.domain=function(e){if(!arguments.length)return t.domain().map(Bl);t.domain(e);return s};function a(e,t){var i=e[1]-e[0],n=i/t,r=I.bisect(Vl,n);return r==Vl.length?[o.year,da(e.map(function(e){return e/31536e6}),t)[2]]:!r?[Wl,da(e,t)[2]]:o[n/Vl[r-1]<Vl[r]/n?r-1:r]}s.nice=function(t,i){var e=s.domain(),n=ta(e),r=t==null?a(n,10):typeof t==="number"&&a(n,t);if(r)t=r[0],i=r[1];function o(e){return!isNaN(e)&&!t.range(e,Bl(+e+1),i).length}return s.domain(ra(e,i>1?{floor:function(e){while(o(e=t.floor(e)))e=Bl(e-1);return e},ceil:function(e){while(o(e=t.ceil(e)))e=Bl(+e+1);return e}}:t))};s.ticks=function(e,t){var i=ta(s.domain()),n=e==null?a(i,10):typeof e==="number"?a(i,e):!e.range&&[{range:e},t];if(n)e=n[0],t=n[1];return e.range(i[0],Bl(+i[1]+1),t<1?1:t)};s.tickFormat=function(){return e};s.copy=function(){return Hl(t.copy(),o,e)};return ca(s,t)}function Bl(e){return new Date(e)}var Vl=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6];var jl=[[M.second,1],[M.second,5],[M.second,15],[M.second,30],[M.minute,1],[M.minute,5],[M.minute,15],[M.minute,30],[M.hour,1],[M.hour,3],[M.hour,6],[M.hour,12],[M.day,1],[M.day,2],[M.week,1],[M.month,1],[M.month,3],[M.year,1]];var zl=Pl.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%a %d",function(e){return e.getDay()&&e.getDate()!=1}],["%b %d",function(e){return e.getDate()!=1}],["%B",function(e){return e.getMonth()}],["%Y",cn]]);var Wl={range:function(e,t,i){return I.range(Math.ceil(e/i)*i,+t,i).map(Bl)},floor:P,ceil:P};jl.year=M.year;M.scale=function(){return Hl(I.scale.linear(),jl,zl)};var Ul=jl.map(function(e){return[e[0].utc,e[1]]});var Yl=Fl.multi([[".%L",function(e){return e.getUTCMilliseconds()}],[":%S",function(e){return e.getUTCSeconds()}],["%I:%M",function(e){return e.getUTCMinutes()}],["%I %p",function(e){return e.getUTCHours()}],["%a %d",function(e){return e.getUTCDay()&&e.getUTCDate()!=1}],["%b %d",function(e){return e.getUTCDate()!=1}],["%B",function(e){return e.getUTCMonth()}],["%Y",cn]]);Ul.year=M.year.utc;M.scale.utc=function(){return Hl(I.scale.linear(),Ul,Yl)};I.text=Ft(function(e){return e.responseText});I.json=function(e,t){return Gt(e,"application/json",ql,t)};function ql(e){return JSON.parse(e.responseText)}I.html=function(e,t){return Gt(e,"text/html",Kl,t)};function Kl(e){var t=L.createRange();t.selectNode(L.body);return t.createContextualFragment(e.responseText)}I.xml=Ft(function(e){return e.responseXML});if(typeof define==="function"&&define.amd)define(I);else if(typeof module==="object"&&module.exports)module.exports=I;this.d3=I}();(function(u){"use strict";var e={version:"0.4.10"};var i,d,t;function n(e){this.owner=e}function r(e,t){if(Object.create){t.prototype=Object.create(e.prototype)}else{var i=function e(){};i.prototype=e.prototype;t.prototype=new i}t.prototype.constructor=t;return t}function o(e){var t=this.internal=new s(this);t.loadConfig(e);t.init();(function t(i,n,r){Object.keys(i).forEach(function(e){n[e]=i[e].bind(r);if(Object.keys(i[e]).length>0){t(i[e],n[e],r)}})})(i,this,this)}function s(e){var t=this;t.d3=u.d3?u.d3:typeof require!=="undefined"?require("d3"):undefined;t.api=e;t.config=t.getDefaultConfig();t.data={};t.cache={};t.axes={}}e.generate=function(e){return new o(e)};e.chart={fn:o.prototype,internal:{fn:s.prototype,axis:{fn:a.prototype}}};i=e.chart.fn;d=e.chart.internal.fn;t=e.chart.internal.axis.fn;d.init=function(){var e=this,t=e.config;e.initParams();if(t.data_url){e.convertUrlToData(t.data_url,t.data_mimeType,t.data_keys,e.initWithData)}else if(t.data_json){e.initWithData(e.convertJsonToData(t.data_json,t.data_keys))}else if(t.data_rows){e.initWithData(e.convertRowsToData(t.data_rows))}else if(t.data_columns){e.initWithData(e.convertColumnsToData(t.data_columns))}else{throw Error("url or json or rows or columns is required.")}};d.initParams=function(){var e=this,t=e.d3,i=e.config;e.clipId="c3-"+ +new Date+"-clip",e.clipIdForXAxis=e.clipId+"-xaxis",e.clipIdForYAxis=e.clipId+"-yaxis",e.clipIdForGrid=e.clipId+"-grid",e.clipIdForSubchart=e.clipId+"-subchart",e.clipPath=e.getClipPath(e.clipId),e.clipPathForXAxis=e.getClipPath(e.clipIdForXAxis),e.clipPathForYAxis=e.getClipPath(e.clipIdForYAxis);e.clipPathForGrid=e.getClipPath(e.clipIdForGrid),e.clipPathForSubchart=e.getClipPath(e.clipIdForSubchart),e.dragStart=null;e.dragging=false;e.flowing=false;e.cancelClick=false;e.mouseover=false;e.transiting=false;e.color=e.generateColor();e.levelColor=e.generateLevelColor();e.dataTimeFormat=i.data_xLocaltime?t.time.format:t.time.format.utc;e.axisTimeFormat=i.axis_x_localtime?t.time.format:t.time.format.utc;e.defaultAxisTimeFormat=e.axisTimeFormat.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%-m/%-d",function(e){return e.getDay()&&e.getDate()!==1}],["%-m/%-d",function(e){return e.getDate()!==1}],["%-m/%-d",function(e){return e.getMonth()}],["%Y/%-m/%-d",function(){return true}]]);e.hiddenTargetIds=[];e.hiddenLegendIds=[];e.focusedTargetIds=[];e.defocusedTargetIds=[];e.xOrient=i.axis_rotated?"left":"bottom";e.yOrient=i.axis_rotated?i.axis_y_inner?"top":"bottom":i.axis_y_inner?"right":"left";e.y2Orient=i.axis_rotated?i.axis_y2_inner?"bottom":"top":i.axis_y2_inner?"left":"right";e.subXOrient=i.axis_rotated?"left":"bottom";e.isLegendRight=i.legend_position==="right";e.isLegendInset=i.legend_position==="inset";e.isLegendTop=i.legend_inset_anchor==="top-left"||i.legend_inset_anchor==="top-right";e.isLegendLeft=i.legend_inset_anchor==="top-left"||i.legend_inset_anchor==="bottom-left";e.legendStep=0;e.legendItemWidth=0;e.legendItemHeight=0;e.currentMaxTickWidths={x:0,y:0,y2:0};e.rotated_padding_left=30;e.rotated_padding_right=i.axis_rotated&&!i.axis_x_show?0:30;e.rotated_padding_top=5;e.withoutFadeIn={};e.intervalForObserveInserted=undefined;e.axes.subx=t.selectAll([])};d.initChartElements=function(){if(this.initBar){this.initBar()}if(this.initLine){this.initLine()}if(this.initArc){this.initArc()}if(this.initGauge){this.initGauge()}if(this.initText){this.initText()}};d.initWithData=function(e){var t=this,i=t.d3,n=t.config;var r,o,s=true;t.axis=new a(t);if(t.initPie){t.initPie()}if(t.initBrush){t.initBrush()}if(t.initZoom){t.initZoom()}if(!n.bindto){t.selectChart=i.selectAll([])}else if(typeof n.bindto.node==="function"){t.selectChart=n.bindto}else{t.selectChart=i.select(n.bindto)}if(t.selectChart.empty()){t.selectChart=i.select(document.createElement("div")).style("opacity",0);t.observeInserted(t.selectChart);s=false}t.selectChart.html("").classed("c3",true);t.data.xs={};t.data.targets=t.convertDataToTargets(e);if(n.data_filter){t.data.targets=t.data.targets.filter(n.data_filter)}if(n.data_hide){t.addHiddenTargetIds(n.data_hide===true?t.mapToIds(t.data.targets):n.data_hide)}if(n.legend_hide){t.addHiddenLegendIds(n.legend_hide===true?t.mapToIds(t.data.targets):n.legend_hide)}if(t.hasType("gauge")){n.legend_show=false}t.updateSizes();t.updateScales();t.x.domain(i.extent(t.getXDomain(t.data.targets)));t.y.domain(t.getYDomain(t.data.targets,"y"));t.y2.domain(t.getYDomain(t.data.targets,"y2"));t.subX.domain(t.x.domain());t.subY.domain(t.y.domain());t.subY2.domain(t.y2.domain());t.orgXDomain=t.x.domain();if(t.brush){t.brush.scale(t.subX)}if(n.zoom_enabled){t.zoom.scale(t.x)}t.svg=t.selectChart.append("svg").style("overflow","hidden").on("mouseenter",function(){return n.onmouseover.call(t)}).on("mouseleave",function(){return n.onmouseout.call(t)});r=t.svg.append("defs");t.clipChart=t.appendClip(r,t.clipId);t.clipXAxis=t.appendClip(r,t.clipIdForXAxis);t.clipYAxis=t.appendClip(r,t.clipIdForYAxis);t.clipGrid=t.appendClip(r,t.clipIdForGrid);t.clipSubchart=t.appendClip(r,t.clipIdForSubchart);t.updateSvgSize();o=t.main=t.svg.append("g").attr("transform",t.getTranslate("main"));if(t.initSubchart){t.initSubchart()}if(t.initTooltip){t.initTooltip()}if(t.initLegend){t.initLegend()}o.append("text").attr("class",$.text+" "+$.empty).attr("text-anchor","middle").attr("dominant-baseline","middle");t.initRegion();t.initGrid();o.append("g").attr("clip-path",t.clipPath).attr("class",$.chart);if(n.grid_lines_front){t.initGridLines()}t.initEventRect();t.initChartElements();o.insert("rect",n.zoom_privileged?null:"g."+$.regions).attr("class",$.zoomRect).attr("width",t.width).attr("height",t.height).style("opacity",0).on("dblclick.zoom",null);if(n.axis_x_extent){t.brush.extent(t.getDefaultExtent())}t.axis.init();t.updateTargets(t.data.targets);if(s){t.updateDimension();t.config.oninit.call(t);t.redraw({withTransition:false,withTransform:true,withUpdateXDomain:true,withUpdateOrgXDomain:true,withTransitionForAxis:false})}if(u.onresize==null){u.onresize=t.generateResize()}if(u.onresize.add){u.onresize.add(function(){n.onresize.call(t)});u.onresize.add(function(){t.api.flush()});u.onresize.add(function(){n.onresized.call(t)})}t.api.element=t.selectChart.node()};d.smoothLines=function(e,t){var o=this;if(t==="grid"){e.each(function(){var e=o.d3.select(this),t=e.attr("x1"),i=e.attr("x2"),n=e.attr("y1"),r=e.attr("y2");e.attr({x1:Math.ceil(t),x2:Math.ceil(i),y1:Math.ceil(n),y2:Math.ceil(r)})})}};d.updateSizes=function(){var e=this,t=e.config;var i=e.legend?e.getLegendHeight():0,n=e.legend?e.getLegendWidth():0,r=e.isLegendRight||e.isLegendInset?0:i,o=e.hasArcType(),s=t.axis_rotated||o?0:e.getHorizontalAxisHeight("x"),a=t.subchart_show&&!o?t.subchart_size_height+s:0;e.currentWidth=e.getCurrentWidth();e.currentHeight=e.getCurrentHeight();e.margin=t.axis_rotated?{top:e.getHorizontalAxisHeight("y2")+e.getCurrentPaddingTop(),right:o?0:e.getCurrentPaddingRight(),bottom:e.getHorizontalAxisHeight("y")+r+e.getCurrentPaddingBottom(),left:a+(o?0:e.getCurrentPaddingLeft())}:{top:4+e.getCurrentPaddingTop(),right:o?0:e.getCurrentPaddingRight(),bottom:s+a+r+e.getCurrentPaddingBottom(),left:o?0:e.getCurrentPaddingLeft()};e.margin2=t.axis_rotated?{top:e.margin.top,right:NaN,bottom:20+r,left:e.rotated_padding_left}:{top:e.currentHeight-a-r,right:NaN,bottom:s+r,left:e.margin.left};e.margin3={top:0,right:NaN,bottom:0,left:0};if(e.updateSizeForLegend){e.updateSizeForLegend(i,n)}e.width=e.currentWidth-e.margin.left-e.margin.right;e.height=e.currentHeight-e.margin.top-e.margin.bottom;if(e.width<0){e.width=0}if(e.height<0){e.height=0}e.width2=t.axis_rotated?e.margin.left-e.rotated_padding_left-e.rotated_padding_right:e.width;e.height2=t.axis_rotated?e.height:e.currentHeight-e.margin2.top-e.margin2.bottom;if(e.width2<0){e.width2=0}if(e.height2<0){e.height2=0}e.arcWidth=e.width-(e.isLegendRight?n+10:0);e.arcHeight=e.height-(e.isLegendRight?0:10);if(e.hasType("gauge")){e.arcHeight+=e.height-e.getGaugeLabelHeight()}if(e.updateRadius){e.updateRadius()}if(e.isLegendRight&&o){e.margin3.left=e.arcWidth/2+e.radiusExpanded*1.1}};d.updateTargets=function(e){var t=this;t.updateTargetsForText(e);t.updateTargetsForBar(e);t.updateTargetsForLine(e);if(t.hasArcType()&&t.updateTargetsForArc){t.updateTargetsForArc(e)}if(t.updateTargetsForSubchart){t.updateTargetsForSubchart(e)}t.showTargets()};d.showTargets=function(){var t=this;t.svg.selectAll("."+$.target).filter(function(e){return t.isTargetToShow(e.id)}).transition().duration(t.config.transition_duration).style("opacity",1)};d.redraw=function(e,t){var i=this,n=i.main,a=i.d3,l=i.config;var r=i.getShapeIndices(i.isAreaType),o=i.getShapeIndices(i.isBarType),s=i.getShapeIndices(i.isLineType);var c,u,d,h,f,p,g,m,v,y,b,_,w;var P=i.hasArcType();var C,x,S,A,E;var T,D,F;var R,M;var k=i.filterTargetsToShow(i.data.targets),O,N;var G=i.xv.bind(i),I,L;e=e||{};c=H(e,"withY",true);u=H(e,"withSubchart",true);d=H(e,"withTransition",true);p=H(e,"withTransform",false);g=H(e,"withUpdateXDomain",false);m=H(e,"withUpdateOrgXDomain",false);v=H(e,"withTrimXDomain",true);w=H(e,"withUpdateXAxis",g);y=H(e,"withLegend",false);b=H(e,"withEventRect",true);_=H(e,"withDimension",true);h=H(e,"withTransitionForExit",d);f=H(e,"withTransitionForAxis",d);T=d?l.transition_duration:0;D=h?T:0;F=f?T:0;t=t||i.axis.generateTransitions(F);if(y&&l.legend_show){i.updateLegend(i.mapToIds(i.data.targets),e,t)}else if(_){i.updateDimension(true)}if(i.isCategorized()&&k.length===0){i.x.domain([0,i.axes.x.selectAll(".tick").size()])}if(k.length){i.updateXDomain(k,g,m,v);if(!l.axis_x_tick_values){O=i.axis.updateXAxisTickValues(k)}}else{i.xAxis.tickValues([]);i.subXAxis.tickValues([])}if(l.zoom_rescale&&!e.flow){N=i.x.orgDomain()}i.y.domain(i.getYDomain(k,"y",N));i.y2.domain(i.getYDomain(k,"y2",N));if(!l.axis_y_tick_values&&l.axis_y_tick_count){i.yAxis.tickValues(i.axis.generateTickValues(i.y.domain(),l.axis_y_tick_count))}if(!l.axis_y2_tick_values&&l.axis_y2_tick_count){i.y2Axis.tickValues(i.axis.generateTickValues(i.y2.domain(),l.axis_y2_tick_count))}i.axis.redraw(t,P);i.axis.updateLabels(d);if((g||w)&&k.length){if(l.axis_x_tick_culling&&O){i.svg.selectAll("."+$.axisX).each(function(){var e=a.select(this);var n=e.select("path.domain").node().getTotalLength()-(l.axis_x_tick_outer?12:0);var i=[];e.selectAll(".tick text").each(function(e){var t=O.indexOf(e);if(t>=0){i.push({e:this,index:t})}});i.sort(function(e,t){return e.index-t.index});if(!l.axis_x_tick_rotate){i.forEach(function(e){var t=e.e.getBoundingClientRect().width/2;var i=a.transform(a.select(e.e.parentNode).attr("transform"));a.select(e.e).style("text-anchor",function(){if(i.translate[0]<t){return"start"}if(i.translate[0]+t>n){return"end"}return"middle"})})}if(i.length>l.axis_x_tick_culling_max){if(l.axis_x_tick_culling_max>1){var t=l.axis_x_tick_culling_max;var r=Math.floor(i.length/t);while(i.length/r>=t+1){t--;r=Math.floor(i.length/t)}var o=Math.floor((i.length-r*(t-1)-1)/2);i.forEach(function(e,t){a.select(e.e).style("display",(t+r-o)%r?"none":"block")})}else{var s=Math.round(i.length/2);i.forEach(function(e,t){a.select(e.e).style("display",t==s?"block":"none")})}}else{i.forEach(function(e){a.select(e.e).style("display","block")})}})}else{i.svg.selectAll("."+$.axisX+" .tick text").style("display","block")}}C=i.generateDrawArea?i.generateDrawArea(r,false):undefined;x=i.generateDrawBar?i.generateDrawBar(o):undefined;S=i.generateDrawLine?i.generateDrawLine(s,false):undefined;A=i.generateXYForText(r,o,s,true);E=i.generateXYForText(r,o,s,false);if(c){i.subY.domain(i.getYDomain(k,"y"));i.subY2.domain(i.getYDomain(k,"y2"))}i.tooltip.style("display","none");i.updateXgridFocus();n.select("text."+$.text+"."+$.empty).attr("x",i.width/2).attr("y",i.height/2).text(l.data_empty_label_text).transition().style("opacity",k.length?0:1);i.updateGrid(T);i.updateRegion(T);i.updateBar(D);i.updateLine(D);i.updateArea(D);i.updateCircle();if(i.hasDataLabel()){i.updateText(D)}if(i.redrawArc){i.redrawArc(T,D,p)}if(i.redrawSubchart){i.redrawSubchart(u,t,T,D,r,o,s)}n.selectAll("."+$.selectedCircles).filter(i.isBarType.bind(i)).selectAll("circle").remove();if(l.interaction_enabled&&!e.flow&&b){i.redrawEventRect();if(i.updateZoom){i.updateZoom()}}i.updateCircleY();I=(i.config.axis_rotated?i.circleY:i.circleX).bind(i);L=(i.config.axis_rotated?i.circleX:i.circleY).bind(i);if(e.flow){M=i.generateFlow({targets:k,flow:e.flow,duration:e.flow.duration,drawBar:x,drawLine:S,drawArea:C,cx:I,cy:L,xv:G,xForText:A,yForText:E})}if((T||M)&&i.isTabVisible()){a.transition().duration(T).each(function(){var t=[];[i.redrawBar(x,true),i.redrawLine(S,true),i.redrawArea(C,true),i.redrawCircle(I,L,true),i.redrawText(A,E,e.flow,true),i.redrawRegion(true),i.redrawGrid(true)].forEach(function(e){e.forEach(function(e){t.push(e)})});R=i.generateWait();t.forEach(function(e){R.add(e)})}).call(R,function(){if(M){M()}if(l.onrendered){l.onrendered.call(i)}})}else{i.redrawBar(x);i.redrawLine(S);i.redrawArea(C);i.redrawCircle(I,L);i.redrawText(A,E,e.flow);i.redrawRegion();i.redrawGrid();if(l.onrendered){l.onrendered.call(i)}}i.mapToIds(i.data.targets).forEach(function(e){i.withoutFadeIn[e]=true})};d.updateAndRedraw=function(e){var t=this,i=t.config,n;e=e||{};e.withTransition=H(e,"withTransition",true);e.withTransform=H(e,"withTransform",false);e.withLegend=H(e,"withLegend",false);e.withUpdateXDomain=true;e.withUpdateOrgXDomain=true;e.withTransitionForExit=false;e.withTransitionForTransform=H(e,"withTransitionForTransform",e.withTransition);t.updateSizes();if(!(e.withLegend&&i.legend_show)){n=t.axis.generateTransitions(e.withTransitionForAxis?i.transition_duration:0);t.updateScales();t.updateSvgSize();t.transformAll(e.withTransitionForTransform,n)}t.redraw(e,n)};d.redrawWithoutRescale=function(){this.redraw({withY:false,withSubchart:false,withEventRect:false,withTransitionForAxis:false})};d.isTimeSeries=function(){return this.config.axis_x_type==="timeseries"};d.isCategorized=function(){return this.config.axis_x_type.indexOf("categor")>=0};d.isCustomX=function(){var e=this,t=e.config;return!e.isTimeSeries()&&(t.data_x||D(t.data_xs))};d.isTimeSeriesY=function(){return this.config.axis_y_type==="timeseries"};d.getTranslate=function(e){var t=this,i=t.config,n,r;if(e==="main"){n=f(t.margin.left);r=f(t.margin.top)}else if(e==="context"){n=f(t.margin2.left);r=f(t.margin2.top)}else if(e==="legend"){n=t.margin3.left;r=t.margin3.top}else if(e==="x"){n=0;r=i.axis_rotated?0:t.height}else if(e==="y"){n=0;r=i.axis_rotated?t.height:0}else if(e==="y2"){n=i.axis_rotated?0:t.width;r=i.axis_rotated?1:0}else if(e==="subx"){n=0;r=i.axis_rotated?0:t.height2}else if(e==="arc"){n=t.arcWidth/2;r=t.arcHeight/2}return"translate("+n+","+r+")"};d.initialOpacity=function(e){return e.value!==null&&this.withoutFadeIn[e.id]?1:0};d.initialOpacityForCircle=function(e){return e.value!==null&&this.withoutFadeIn[e.id]?this.opacityForCircle(e):0};d.opacityForCircle=function(e){var t=this.config.point_show?1:0;return T(e.value)?this.isScatterType(e)?.5:t:0};d.opacityForText=function(){return this.hasDataLabel()?1:0};d.xx=function(e){return e?this.x(e.x):null};d.xv=function(e){var t=this,i=e.value;if(t.isTimeSeries()){i=t.parseDate(e.value)}else if(t.isCategorized()&&typeof e.value==="string"){i=t.config.axis_x_categories.indexOf(e.value)}return Math.ceil(t.x(i))};d.yv=function(e){var t=this,i=e.axis&&e.axis==="y2"?t.y2:t.y;return Math.ceil(i(e.value))};d.subxx=function(e){return e?this.subX(e.x):null};d.transformMain=function(e,t){var i=this,n,r,o;if(t&&t.axisX){n=t.axisX}else{n=i.main.select("."+$.axisX);if(e){n=n.transition()}}if(t&&t.axisY){r=t.axisY}else{r=i.main.select("."+$.axisY);if(e){r=r.transition()}}if(t&&t.axisY2){o=t.axisY2}else{o=i.main.select("."+$.axisY2);if(e){o=o.transition()}}(e?i.main.transition():i.main).attr("transform",i.getTranslate("main"));n.attr("transform",i.getTranslate("x"));r.attr("transform",i.getTranslate("y"));o.attr("transform",i.getTranslate("y2"));i.main.select("."+$.chartArcs).attr("transform",i.getTranslate("arc"))};d.transformAll=function(e,t){var i=this;i.transformMain(e,t);if(i.config.subchart_show){i.transformContext(e,t)}if(i.legend){i.transformLegend(e)}};d.updateSvgSize=function(){var e=this,t=e.svg.select(".c3-brush .background");e.svg.attr("width",e.currentWidth).attr("height",e.currentHeight);e.svg.selectAll(["#"+e.clipId,"#"+e.clipIdForGrid]).select("rect").attr("width",e.width).attr("height",e.height);e.svg.select("#"+e.clipIdForXAxis).select("rect").attr("x",e.getXAxisClipX.bind(e)).attr("y",e.getXAxisClipY.bind(e)).attr("width",e.getXAxisClipWidth.bind(e)).attr("height",e.getXAxisClipHeight.bind(e));e.svg.select("#"+e.clipIdForYAxis).select("rect").attr("x",e.getYAxisClipX.bind(e)).attr("y",e.getYAxisClipY.bind(e)).attr("width",e.getYAxisClipWidth.bind(e)).attr("height",e.getYAxisClipHeight.bind(e));e.svg.select("#"+e.clipIdForSubchart).select("rect").attr("width",e.width).attr("height",t.size()?t.attr("height"):0);e.svg.select("."+$.zoomRect).attr("width",e.width).attr("height",e.height);e.selectChart.style("max-height",e.currentHeight+"px")};d.updateDimension=function(e){var t=this;if(!e){if(t.config.axis_rotated){t.axes.x.call(t.xAxis);t.axes.subx.call(t.subXAxis)}else{t.axes.y.call(t.yAxis);t.axes.y2.call(t.y2Axis)}}t.updateSizes();t.updateScales();t.updateSvgSize();t.transformAll(false)};d.observeInserted=function(t){var i=this,n;if(typeof MutationObserver==="undefined"){u.console.error("MutationObserver not defined.");return}n=new MutationObserver(function(e){e.forEach(function(e){if(e.type==="childList"&&e.previousSibling){n.disconnect();i.intervalForObserveInserted=u.setInterval(function(){if(t.node().parentNode){u.clearInterval(i.intervalForObserveInserted);i.updateDimension();i.config.oninit.call(i);i.redraw({withTransform:true,withUpdateXDomain:true,withUpdateOrgXDomain:true,withTransition:false,withTransitionForTransform:false,withLegend:true});t.transition().style("opacity",1)}},10)}})});n.observe(t.node(),{attributes:true,childList:true,characterData:true})};d.generateResize=function(){var t=[];function e(){t.forEach(function(e){e()})}e.add=function(e){t.push(e)};return e};d.endall=function(e,t){var i=0;e.each(function(){++i}).each("end",function(){if(!--i){t.apply(this,arguments)}})};d.generateWait=function(){var r=[],e=function(e,i){var n=setInterval(function(){var t=0;r.forEach(function(e){if(e.empty()){t+=1;return}try{e.transition()}catch(e){t+=1}});if(t===r.length){clearInterval(n);if(i){i()}}},10)};e.add=function(e){r.push(e)};return e};d.parseDate=function(e){var t=this,i;if(e instanceof Date){i=e}else if(typeof e==="string"){i=t.dataTimeFormat(t.config.data_xFormat).parse(e)}else if(typeof e==="number"||!isNaN(e)){i=new Date(+e)}if(!i||isNaN(+i)){u.console.error("Failed to parse x '"+e+"' to Date object")}return i};d.isTabVisible=function(){var e;if(typeof document.hidden!=="undefined"){e="hidden"}else if(typeof document.mozHidden!=="undefined"){e="mozHidden"}else if(typeof document.msHidden!=="undefined"){e="msHidden"}else if(typeof document.webkitHidden!=="undefined"){e="webkitHidden"}return document[e]?false:true};d.getDefaultConfig=function(){var t={bindto:"#chart",size_width:undefined,size_height:undefined,padding_left:undefined,padding_right:undefined,padding_top:undefined,padding_bottom:undefined,zoom_enabled:false,zoom_extent:undefined,zoom_privileged:false,zoom_rescale:false,zoom_onzoom:function(){},zoom_onzoomstart:function(){},zoom_onzoomend:function(){},interaction_enabled:true,onmouseover:function(){},onmouseout:function(){},onresize:function(){},onresized:function(){},oninit:function(){},onrendered:function(){},transition_duration:350,data_x:undefined,data_xs:{},data_xFormat:"%Y-%m-%d",data_xLocaltime:true,data_xSort:true,data_idConverter:function(e){return e},data_names:{},data_classes:{},data_groups:[],data_axes:{},data_type:undefined,data_types:{},data_labels:{},data_order:"desc",data_regions:{},data_color:undefined,data_colors:{},data_hide:false,data_filter:undefined,data_selection_enabled:false,data_selection_grouped:false,data_selection_isselectable:function(){return true},data_selection_multiple:true,data_selection_draggable:false,data_onclick:function(){},data_onmouseover:function(){},data_onmouseout:function(){},data_onselected:function(){},data_onunselected:function(){},data_url:undefined,data_json:undefined,data_rows:undefined,data_columns:undefined,data_mimeType:undefined,data_keys:undefined,data_empty_label_text:"",subchart_show:false,subchart_size_height:60,subchart_onbrush:function(){},color_pattern:[],color_threshold:{},legend_show:true,legend_hide:false,legend_position:"bottom",legend_inset_anchor:"top-left",legend_inset_x:10,legend_inset_y:0,legend_inset_step:undefined,legend_item_onclick:undefined,legend_item_onmouseover:undefined,legend_item_onmouseout:undefined,legend_equally:false,axis_rotated:false,axis_x_show:true,axis_x_type:"indexed",axis_x_localtime:true,axis_x_categories:[],axis_x_tick_centered:false,axis_x_tick_format:undefined,axis_x_tick_culling:{},axis_x_tick_culling_max:10,axis_x_tick_count:undefined,axis_x_tick_fit:true,axis_x_tick_values:null,axis_x_tick_rotate:0,axis_x_tick_outer:true,axis_x_tick_multiline:true,axis_x_tick_width:null,axis_x_max:undefined,axis_x_min:undefined,axis_x_padding:{},axis_x_height:undefined,axis_x_extent:undefined,axis_x_label:{},axis_y_show:true,axis_y_type:undefined,axis_y_max:undefined,axis_y_min:undefined,axis_y_inverted:false,axis_y_center:undefined,axis_y_inner:undefined,axis_y_label:{},axis_y_tick_format:undefined,axis_y_tick_outer:true,axis_y_tick_values:null,axis_y_tick_count:undefined,axis_y_tick_time_value:undefined,axis_y_tick_time_interval:undefined,axis_y_padding:{},axis_y_default:undefined,axis_y2_show:false,axis_y2_max:undefined,axis_y2_min:undefined,axis_y2_inverted:false,axis_y2_center:undefined,axis_y2_inner:undefined,axis_y2_label:{},axis_y2_tick_format:undefined,axis_y2_tick_outer:true,axis_y2_tick_values:null,axis_y2_tick_count:undefined,axis_y2_padding:{},axis_y2_default:undefined,grid_x_show:false,grid_x_type:"tick",grid_x_lines:[],grid_y_show:false,grid_y_lines:[],grid_y_ticks:10,grid_focus_show:true,grid_lines_front:true,point_show:true,point_r:2.5,point_focus_expand_enabled:true,point_focus_expand_r:undefined,point_select_r:undefined,line_connectNull:false,line_step_type:"step",bar_width:undefined,bar_width_ratio:.6,bar_width_max:undefined,bar_zerobased:true,area_zerobased:true,pie_label_show:true,pie_label_format:undefined,pie_label_threshold:.05,pie_expand:true,gauge_label_show:true,gauge_label_format:undefined,gauge_expand:true,gauge_min:0,gauge_max:100,gauge_units:undefined,gauge_width:undefined,donut_label_show:true,donut_label_format:undefined,donut_label_threshold:.05,donut_width:undefined,donut_expand:true,donut_title:"",regions:[],tooltip_show:true,tooltip_grouped:true,tooltip_format_title:undefined,tooltip_format_name:undefined,tooltip_format_value:undefined,tooltip_position:undefined,tooltip_contents:function(e,t,i,n){return this.getTooltipContent?this.getTooltipContent(e,t,i,n):""},tooltip_init_show:false,tooltip_init_x:0,tooltip_init_position:{top:"0px",left:"50px"}};Object.keys(this.additionalConfig).forEach(function(e){t[e]=this.additionalConfig[e]},this);return t};d.additionalConfig={};d.loadConfig=function(t){var i=this.config,n,r,o;function s(){var e=r.shift();if(e&&n&&typeof n==="object"&&e in n){n=n[e];return s()}else if(!e){return n}else{return undefined}}Object.keys(i).forEach(function(e){n=t;r=e.split("_");o=s();if(N(o)){i[e]=o}})};d.getScale=function(e,t,i){return(i?this.d3.time.scale():this.d3.scale.linear()).range([e,t])};d.getX=function(e,t,i,n){var r=this,o=r.getScale(e,t,r.isTimeSeries()),s=i?o.domain(i):o,a;if(r.isCategorized()){n=n||function(){return 0};o=function(e,t){var i=s(e)+n(e);return t?i:Math.ceil(i)}}else{o=function(e,t){var i=s(e);return t?i:Math.ceil(i)}}for(a in s){o[a]=s[a]}o.orgDomain=function(){return s.domain()};if(r.isCategorized()){o.domain=function(e){if(!arguments.length){e=this.orgDomain();return[e[0],e[1]+1]}s.domain(e);return o}}return o};d.getY=function(e,t,i){var n=this.getScale(e,t,this.isTimeSeriesY());if(i){n.domain(i)}return n};d.getYScale=function(e){return this.axis.getId(e)==="y2"?this.y2:this.y};d.getSubYScale=function(e){return this.axis.getId(e)==="y2"?this.subY2:this.subY};d.updateScales=function(){var t=this,e=t.config,i=!t.x;t.xMin=e.axis_rotated?1:0;t.xMax=e.axis_rotated?t.height:t.width;t.yMin=e.axis_rotated?0:t.height;t.yMax=e.axis_rotated?t.width:1;t.subXMin=t.xMin;t.subXMax=t.xMax;t.subYMin=e.axis_rotated?0:t.height2;t.subYMax=e.axis_rotated?t.width2:1;t.x=t.getX(t.xMin,t.xMax,i?undefined:t.x.orgDomain(),function(){return t.xAxis.tickOffset()});t.y=t.getY(t.yMin,t.yMax,i?e.axis_y_default:t.y.domain());t.y2=t.getY(t.yMin,t.yMax,i?e.axis_y2_default:t.y2.domain());t.subX=t.getX(t.xMin,t.xMax,t.orgXDomain,function(e){return e%1?0:t.subXAxis.tickOffset()});t.subY=t.getY(t.subYMin,t.subYMax,i?e.axis_y_default:t.subY.domain());t.subY2=t.getY(t.subYMin,t.subYMax,i?e.axis_y2_default:t.subY2.domain());t.xAxisTickFormat=t.axis.getXAxisTickFormat();t.xAxisTickValues=t.axis.getXAxisTickValues();t.yAxisTickValues=t.axis.getYAxisTickValues();t.y2AxisTickValues=t.axis.getY2AxisTickValues();t.xAxis=t.axis.getXAxis(t.x,t.xOrient,t.xAxisTickFormat,t.xAxisTickValues,e.axis_x_tick_outer);t.subXAxis=t.axis.getXAxis(t.subX,t.subXOrient,t.xAxisTickFormat,t.xAxisTickValues,e.axis_x_tick_outer);t.yAxis=t.axis.getYAxis(t.y,t.yOrient,e.axis_y_tick_format,t.yAxisTickValues,e.axis_y_tick_outer);t.y2Axis=t.axis.getYAxis(t.y2,t.y2Orient,e.axis_y2_tick_format,t.y2AxisTickValues,e.axis_y2_tick_outer);if(!i){if(t.brush){t.brush.scale(t.subX)}if(e.zoom_enabled){t.zoom.scale(t.x)}}if(t.updateArc){t.updateArc()}};d.getYDomainMin=function(e){var i=this,t=i.config,n=i.mapToIds(e),r=i.getValuesAsIdKeyed(e),o,s,a,l,c,u;if(t.data_groups.length>0){u=i.hasNegativeValueInTargets(e);for(o=0;o<t.data_groups.length;o++){l=t.data_groups[o].filter(function(e){return n.indexOf(e)>=0});if(l.length===0){continue}a=l[0];if(u&&r[a]){r[a].forEach(function(e,t){r[a][t]=e<0?e:0})}for(s=1;s<l.length;s++){c=l[s];if(!r[c]){continue}r[c].forEach(function(e,t){if(i.axis.getId(c)===i.axis.getId(a)&&r[a]&&!(u&&+e>0)){r[a][t]+=+e}})}}}return i.d3.min(Object.keys(r).map(function(e){return i.d3.min(r[e])}))};d.getYDomainMax=function(e){var i=this,t=i.config,n=i.mapToIds(e),r=i.getValuesAsIdKeyed(e),o,s,a,l,c,u;if(t.data_groups.length>0){u=i.hasPositiveValueInTargets(e);for(o=0;o<t.data_groups.length;o++){l=t.data_groups[o].filter(function(e){return n.indexOf(e)>=0});if(l.length===0){continue}a=l[0];if(u&&r[a]){r[a].forEach(function(e,t){r[a][t]=e>0?e:0})}for(s=1;s<l.length;s++){c=l[s];if(!r[c]){continue}r[c].forEach(function(e,t){if(i.axis.getId(c)===i.axis.getId(a)&&r[a]&&!(u&&+e<0)){r[a][t]+=+e}})}}}return i.d3.max(Object.keys(r).map(function(e){return i.d3.max(r[e])}))};d.getYDomain=function(e,t,i){var n=this,r=n.config,o=e.filter(function(e){return n.axis.getId(e.id)===t}),s=i?n.filterByXDomain(o,i):o,a=t==="y2"?r.axis_y2_min:r.axis_y_min,l=t==="y2"?r.axis_y2_max:r.axis_y_max,c=n.getYDomainMin(s),u=n.getYDomainMax(s),d,h,f,p,g,m=t==="y2"?r.axis_y2_center:r.axis_y_center,v,y,b,_,w,C,x=n.hasType("bar",s)&&r.bar_zerobased||n.hasType("area",s)&&r.area_zerobased,S=t==="y2"?r.axis_y2_inverted:r.axis_y_inverted,A=n.hasDataLabel()&&r.axis_rotated,E=n.hasDataLabel()&&!r.axis_rotated;c=T(a)?a:T(l)?c<l?c:l-10:c;u=T(l)?l:T(a)?a<u?u:a+10:u;if(s.length===0){return t==="y2"?n.y2.domain():n.y.domain()}if(isNaN(c)){c=0}if(isNaN(u)){u=c}if(c===u){c<0?u=0:c=0}w=c>=0&&u>=0;C=c<=0&&u<=0;if(T(a)&&w||T(l)&&C){x=false}if(x){if(w){c=0}if(C){u=0}}h=Math.abs(u-c);f=p=g=h*.1;if(typeof m!=="undefined"){v=Math.max(Math.abs(c),Math.abs(u));u=m+v;c=m-v}if(A){y=n.getDataLabelLength(c,u,"width");b=L(n.y.range());_=[y[0]/b,y[1]/b];p+=h*(_[1]/(1-_[0]-_[1]));g+=h*(_[0]/(1-_[0]-_[1]))}else if(E){y=n.getDataLabelLength(c,u,"height");p+=n.axis.convertPixelsToAxisPadding(y[1],h);g+=n.axis.convertPixelsToAxisPadding(y[0],h)}if(t==="y"&&D(r.axis_y_padding)){p=n.axis.getPadding(r.axis_y_padding,"top",p,h);g=n.axis.getPadding(r.axis_y_padding,"bottom",g,h)}if(t==="y2"&&D(r.axis_y2_padding)){p=n.axis.getPadding(r.axis_y2_padding,"top",p,h);g=n.axis.getPadding(r.axis_y2_padding,"bottom",g,h)}if(x){if(w){g=c}if(C){p=-u}}d=n.config.axis_rotated?[c,u]:[c-g,u+p];return S?d.reverse():d};d.getXDomainMin=function(e){var t=this,i=t.config;return N(i.axis_x_min)?t.isTimeSeries()?this.parseDate(i.axis_x_min):i.axis_x_min:t.d3.min(e,function(e){return t.d3.min(e.values,function(e){return e.x})})};d.getXDomainMax=function(e){var t=this,i=t.config;return N(i.axis_x_max)?t.isTimeSeries()?this.parseDate(i.axis_x_max):i.axis_x_max:t.d3.max(e,function(e){return t.d3.max(e.values,function(e){return e.x})})};d.getXDomainPadding=function(e){var t=this,i=t.config,n=e[1]-e[0],r,o,s,a;if(t.isCategorized()){o=0}else if(t.hasType("bar")){r=t.getMaxDataCount();o=r>1?n/(r-1)/2:.5}else{o=n*.01}if(typeof i.axis_x_padding==="object"&&D(i.axis_x_padding)){s=T(i.axis_x_padding.left)?i.axis_x_padding.left:o;a=T(i.axis_x_padding.right)?i.axis_x_padding.right:o}else if(typeof i.axis_x_padding==="number"){s=a=i.axis_x_padding}else{s=a=o}return{left:s,right:a}};d.getXDomain=function(e){var t=this,i=[t.getXDomainMin(e),t.getXDomainMax(e)],n=i[0],r=i[1],o=t.getXDomainPadding(i),s=0,a=0;if(n-r===0&&!t.isCategorized()){if(t.isTimeSeries()){n=new Date(n.getTime()*.5);r=new Date(r.getTime()*1.5)}else{n=n===0?1:n*.5;r=r===0?-1:r*1.5}}if(n||n===0){s=t.isTimeSeries()?new Date(n.getTime()-o.left):n-o.left}if(r||r===0){a=t.isTimeSeries()?new Date(r.getTime()+o.right):r+o.right}return[s,a]};d.updateXDomain=function(e,t,i,n,r){var o=this,s=o.config;if(i){o.x.domain(r?r:o.d3.extent(o.getXDomain(e)));o.orgXDomain=o.x.domain();if(s.zoom_enabled){o.zoom.scale(o.x).updateScaleExtent()}o.subX.domain(o.x.domain());if(o.brush){o.brush.scale(o.subX)}}if(t){o.x.domain(r?r:!o.brush||o.brush.empty()?o.orgXDomain:o.brush.extent());if(s.zoom_enabled){o.zoom.scale(o.x).updateScaleExtent()}}if(n){o.x.domain(o.trimXDomain(o.x.orgDomain()))}return o.x.domain()};d.trimXDomain=function(e){var t=this;if(e[0]<=t.orgXDomain[0]){e[1]=+e[1]+(t.orgXDomain[0]-e[0]);e[0]=t.orgXDomain[0]}if(t.orgXDomain[1]<=e[1]){e[0]=+e[0]-(e[1]-t.orgXDomain[1]);e[1]=t.orgXDomain[1]}return e};d.isX=function(e){var t=this,i=t.config;return i.data_x&&e===i.data_x||D(i.data_xs)&&g(i.data_xs,e)};d.isNotX=function(e){return!this.isX(e)};d.getXKey=function(e){var t=this,i=t.config;return i.data_x?i.data_x:D(i.data_xs)?i.data_xs[e]:null};d.getXValuesOfXKey=function(t,e){var i=this,n,r=e&&D(e)?i.mapToIds(e):[];r.forEach(function(e){if(i.getXKey(e)===t){n=i.data.xs[e]}});return n};d.getIndexByX=function(e){var t=this,i=t.filterByX(t.data.targets,e);return i.length?i[0].index:null};d.getXValue=function(e,t){var i=this;return e in i.data.xs&&i.data.xs[e]&&T(i.data.xs[e][t])?i.data.xs[e][t]:t};d.getOtherTargetXs=function(){var e=this,t=Object.keys(e.data.xs);return t.length?e.data.xs[t[0]]:null};d.getOtherTargetX=function(e){var t=this.getOtherTargetXs();return t&&e<t.length?t[e]:null};d.addXs=function(t){var i=this;Object.keys(t).forEach(function(e){i.config.data_xs[e]=t[e]})};d.hasMultipleX=function(t){return this.d3.set(Object.keys(t).map(function(e){return t[e]})).size()>1};d.isMultipleX=function(){return D(this.config.data_xs)||!this.config.data_xSort||this.hasType("scatter")};d.addName=function(e){var t=this,i;if(e){i=t.config.data_names[e.id];e.name=i?i:e.id}return e};d.getValueOnIndex=function(e,t){var i=e.filter(function(e){return e.index===t});return i.length?i[0]:null};d.updateTargetX=function(e,n){var r=this;e.forEach(function(i){i.values.forEach(function(e,t){e.x=r.generateTargetX(n[t],i.id,t)});r.data.xs[i.id]=n})};d.updateTargetXs=function(e,t){var i=this;e.forEach(function(e){if(t[e.id]){i.updateTargetX([e],t[e.id])}})};d.generateTargetX=function(e,t,i){var n=this,r;if(n.isTimeSeries()){r=e?n.parseDate(e):n.parseDate(n.getXValue(t,i))}else if(n.isCustomX()&&!n.isCategorized()){r=T(e)?+e:n.getXValue(t,i)}else{r=i}return r};d.cloneTarget=function(e){return{id:e.id,id_org:e.id_org,values:e.values.map(function(e){return{x:e.x,value:e.value,id:e.id}})}};d.updateXs=function(){var t=this;if(t.data.targets.length){t.xs=[];t.data.targets[0].values.forEach(function(e){t.xs[e.index]=e.x})}};d.getPrevX=function(e){var t=this.xs[e-1];return typeof t!=="undefined"?t:null};d.getNextX=function(e){var t=this.xs[e+1];return typeof t!=="undefined"?t:null};d.getMaxDataCount=function(){var e=this;return e.d3.max(e.data.targets,function(e){return e.values.length})};d.getMaxDataCountTarget=function(e){var t=e.length,i=0,n;if(t>1){e.forEach(function(e){if(e.values.length>i){n=e;i=e.values.length}})}else{n=t?e[0]:null}return n};d.getEdgeX=function(e){var t=this;return!e.length?[0,0]:[t.d3.min(e,function(e){return e.values[0].x}),t.d3.max(e,function(e){return e.values[e.values.length-1].x})]};d.mapToIds=function(e){return e.map(function(e){return e.id})};d.mapToTargetIds=function(e){var t=this;return e?l(e)?[e]:e:t.mapToIds(t.data.targets)};d.hasTarget=function(e,t){var i=this.mapToIds(e),n;for(n=0;n<i.length;n++){if(i[n]===t){return true}}return false};d.isTargetToShow=function(e){return this.hiddenTargetIds.indexOf(e)<0};d.isLegendToShow=function(e){return this.hiddenLegendIds.indexOf(e)<0};d.filterTargetsToShow=function(e){var t=this;return e.filter(function(e){return t.isTargetToShow(e.id)})};d.mapTargetsToUniqueXs=function(e){var t=this;var i=t.d3.set(t.d3.merge(e.map(function(e){return e.values.map(function(e){return+e.x})}))).values();return t.isTimeSeries()?i.map(function(e){return new Date(+e)}):i.map(function(e){return+e})};d.addHiddenTargetIds=function(e){this.hiddenTargetIds=this.hiddenTargetIds.concat(e)};d.removeHiddenTargetIds=function(t){this.hiddenTargetIds=this.hiddenTargetIds.filter(function(e){return t.indexOf(e)<0})};d.addHiddenLegendIds=function(e){this.hiddenLegendIds=this.hiddenLegendIds.concat(e)};d.removeHiddenLegendIds=function(t){this.hiddenLegendIds=this.hiddenLegendIds.filter(function(e){return t.indexOf(e)<0})};d.getValuesAsIdKeyed=function(e){var i={};e.forEach(function(t){i[t.id]=[];t.values.forEach(function(e){i[t.id].push(e.value)})});return i};d.checkValueInTargets=function(e,t){var i=Object.keys(e),n,r,o;for(n=0;n<i.length;n++){o=e[i[n]].values;for(r=0;r<o.length;r++){if(t(o[r].value)){return true}}}return false};d.hasNegativeValueInTargets=function(e){return this.checkValueInTargets(e,function(e){return e<0})};d.hasPositiveValueInTargets=function(e){return this.checkValueInTargets(e,function(e){return e>0})};d.isOrderDesc=function(){var e=this.config;return typeof e.data_order==="string"&&e.data_order.toLowerCase()==="desc"};d.isOrderAsc=function(){var e=this.config;return typeof e.data_order==="string"&&e.data_order.toLowerCase()==="asc"};d.orderTargets=function(e){var t=this,i=t.config,o=t.isOrderAsc(),n=t.isOrderDesc();if(o||n){e.sort(function(e,t){var i=function(e,t){return e+Math.abs(t.value)};var n=e.values.reduce(i,0),r=t.values.reduce(i,0);return o?r-n:n-r})}else if(h(i.data_order)){e.sort(i.data_order)}return e};d.filterByX=function(e,t){return this.d3.merge(e.map(function(e){return e.values})).filter(function(e){return e.x-t===0})};d.filterRemoveNull=function(e){return e.filter(function(e){return T(e.value)})};d.filterByXDomain=function(e,t){return e.map(function(e){return{id:e.id,id_org:e.id_org,values:e.values.filter(function(e){return t[0]<=e.x&&e.x<=t[1]})}})};d.hasDataLabel=function(){var e=this.config;if(typeof e.data_labels==="boolean"&&e.data_labels){return true}else if(typeof e.data_labels==="object"&&D(e.data_labels)){return true}return false};d.getDataLabelLength=function(e,t,i){var n=this,r=[0,0],o=1.3;n.selectChart.select("svg").selectAll(".dummy").data([e,t]).enter().append("text").text(function(e){return n.dataLabelFormat(e.id)(e)}).each(function(e,t){r[t]=this.getBoundingClientRect()[i]*o}).remove();return r};d.isNoneArc=function(e){return this.hasTarget(this.data.targets,e.id)},d.isArc=function(e){return"data"in e&&this.hasTarget(this.data.targets,e.data.id)};d.findSameXOfValues=function(e,t){var i,n=e[t].x,r=[];for(i=t-1;i>=0;i--){if(n!==e[i].x){break}r.push(e[i])}for(i=t;i<e.length;i++){if(n!==e[i].x){break}r.push(e[i])}return r};d.findClosestFromTargets=function(e,t){var i=this,n;n=e.map(function(e){return i.findClosest(e.values,t)});return i.findClosest(n,t)};d.findClosest=function(e,i){var n=this,r=100,o;e.filter(function(e){return e&&n.isBarType(e.id)}).forEach(function(e){var t=n.main.select("."+$.bars+n.getTargetSelectorSuffix(e.id)+" ."+$.bar+"-"+e.index).node();if(!o&&n.isWithinBar(t)){o=e}});e.filter(function(e){return e&&!n.isBarType(e.id)}).forEach(function(e){var t=n.dist(e,i);if(t<r){r=t;o=e}});return o};d.dist=function(e,t){var i=this,n=i.config,r=n.axis_rotated?1:0,o=n.axis_rotated?0:1,s=i.circleY(e,e.index),a=i.x(e.x);return Math.pow(a-t[r],2)+Math.pow(s-t[o],2)};d.convertValuesToStep=function(e){var t=[].concat(e),i;if(!this.isCategorized()){return e}for(i=e.length+1;0<i;i--){t[i]=t[i-1]}t[0]={x:t[0].x-1,value:t[0].value,id:t[0].id};t[e.length+1]={x:t[e.length].x+1,value:t[e.length].value,id:t[e.length].id};return t};d.updateDataAttributes=function(e,t){var i=this,n=i.config,r=n["data_"+e];if(typeof t==="undefined"){return r}Object.keys(t).forEach(function(e){r[e]=t[e]});i.redraw({withLegend:true});return r};d.convertUrlToData=function(e,t,n,r){var o=this,s=t?t:"csv";o.d3.xhr(e,function(e,t){var i;if(!t){throw new Error(e.responseURL+" "+e.status+" ("+e.statusText+")")}if(s==="json"){i=o.convertJsonToData(JSON.parse(t.response),n)}else if(s==="tsv"){i=o.convertTsvToData(t.response)}else{i=o.convertCsvToData(t.response)}r.call(o,i)})};d.convertXsvToData=function(e,t){var i=t.parseRows(e),n;if(i.length===1){n=[{}];i[0].forEach(function(e){n[0][e]=null})}else{n=t.parse(e)}return n};d.convertCsvToData=function(e){return this.convertXsvToData(e,this.d3.csv)};d.convertTsvToData=function(e){return this.convertXsvToData(e,this.d3.tsv)};d.convertJsonToData=function(t,e){var i=this,r=[],o,n;if(e){if(e.x){o=e.value.concat(e.x);i.config.data_x=e.x}else{o=e.value}r.push(o);t.forEach(function(i){var n=[];o.forEach(function(e){var t=S(i[e])?null:i[e];n.push(t)});r.push(n)});n=i.convertRowsToData(r)}else{Object.keys(t).forEach(function(e){r.push([e].concat(t[e]))});n=i.convertColumnsToData(r)}return n};d.convertRowsToData=function(e){var t=e[0],i={},n=[],r,o;for(r=1;r<e.length;r++){i={};for(o=0;o<e[r].length;o++){if(S(e[r][o])){throw new Error("Source data is missing a component at ("+r+","+o+")!")}i[t[o]]=e[r][o]}n.push(i)}return n};d.convertColumnsToData=function(e){var t=[],i,n,r;for(i=0;i<e.length;i++){r=e[i][0];for(n=1;n<e[i].length;n++){if(S(t[n-1])){t[n-1]={}}if(S(e[i][n])){throw new Error("Source data is missing a component at ("+i+","+n+")!")}t[n-1][r]=e[i][n]}}return t};d.convertDataToTargets=function(e,n){var l=this,c=l.config,t=l.d3.keys(e[0]).filter(l.isNotX,l),r=l.d3.keys(e[0]).filter(l.isX,l),i;t.forEach(function(i){var t=l.getXKey(i);if(l.isCustomX()||l.isTimeSeries()){if(r.indexOf(t)>=0){l.data.xs[i]=(n&&l.data.xs[i]?l.data.xs[i]:[]).concat(e.map(function(e){return e[t]}).filter(T).map(function(e,t){return l.generateTargetX(e,i,t)}))}else if(c.data_x){l.data.xs[i]=l.getOtherTargetXs()}else if(D(c.data_xs)){l.data.xs[i]=l.getXValuesOfXKey(t,l.data.targets)}}else{l.data.xs[i]=e.map(function(e,t){return t})}});t.forEach(function(e){if(!l.data.xs[e]){throw new Error('x is not defined for id = "'+e+'".')}});i=t.map(function(o,s){var a=c.data_idConverter(o);return{id:a,id_org:o,values:e.map(function(e,t){var i=l.getXKey(o),n=e[i],r=l.generateTargetX(n,o,t);if(l.isCustomX()&&l.isCategorized()&&s===0&&n){if(t===0){c.axis_x_categories=[]}c.axis_x_categories.push(n)}if(S(e[o])||l.data.xs[o].length<=t){r=undefined}return{x:r,value:e[o]!==null&&!isNaN(e[o])?+e[o]:null,id:a}}).filter(function(e){return N(e.x)})}});i.forEach(function(e){var t;if(c.data_xSort){e.values=e.values.sort(function(e,t){var i=e.x||e.x===0?e.x:Infinity,n=t.x||t.x===0?t.x:Infinity;return i-n})}t=0;e.values.forEach(function(e){e.index=t++});l.data.xs[e.id].sort(function(e,t){return e-t})});if(c.data_type){l.setTargetType(l.mapToIds(i).filter(function(e){return!(e in c.data_types)}),c.data_type)}i.forEach(function(e){l.addCache(e.id_org,e)});return i};d.load=function(i,n){var r=this;if(i){if(n.filter){i=i.filter(n.filter)}if(n.type||n.types){i.forEach(function(e){var t=n.types&&n.types[e.id]?n.types[e.id]:n.type;r.setTargetType(e.id,t)})}r.data.targets.forEach(function(e){for(var t=0;t<i.length;t++){if(e.id===i[t].id){e.values=i[t].values;i.splice(t,1);break}}});r.data.targets=r.data.targets.concat(i)}r.updateTargets(r.data.targets);r.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true,withLegend:true});if(n.done){n.done()}};d.loadFromArgs=function(t){var i=this;if(t.data){i.load(i.convertDataToTargets(t.data),t)}else if(t.url){i.convertUrlToData(t.url,t.mimeType,t.keys,function(e){i.load(i.convertDataToTargets(e),t)})}else if(t.json){i.load(i.convertDataToTargets(i.convertJsonToData(t.json,t.keys)),t)}else if(t.rows){i.load(i.convertDataToTargets(i.convertRowsToData(t.rows)),t)}else if(t.columns){i.load(i.convertDataToTargets(i.convertColumnsToData(t.columns)),t)}else{i.load(null,t)}};d.unload=function(e,t){var i=this;if(!t){t=function(){}}e=e.filter(function(e){return i.hasTarget(i.data.targets,e)});if(!e||e.length===0){t();return}i.svg.selectAll(e.map(function(e){return i.selectorTarget(e)})).transition().style("opacity",0).remove().call(i.endall,t);e.forEach(function(t){i.withoutFadeIn[t]=false;if(i.legend){i.legend.selectAll("."+$.legendItem+i.getTargetSelectorSuffix(t)).remove()}i.data.targets=i.data.targets.filter(function(e){return e.id!==t})})};d.categoryName=function(e){var t=this.config;return e<t.axis_x_categories.length?t.axis_x_categories[e]:e};d.initEventRect=function(){var e=this;e.main.select("."+$.chart).append("g").attr("class",$.eventRects).style("fill-opacity",0)};d.redrawEventRect=function(){var e=this,t=e.config,i,n,r=e.isMultipleX();var o=e.main.select("."+$.eventRects).style("cursor",t.zoom_enabled?t.axis_rotated?"ns-resize":"ew-resize":null).classed($.eventRectsMultiple,r).classed($.eventRectsSingle,!r);o.selectAll("."+$.eventRect).remove();e.eventRect=o.selectAll("."+$.eventRect);if(r){i=e.eventRect.data([0]);e.generateEventRectsForMultipleXs(i.enter());e.updateEventRect(i)}else{n=e.getMaxDataCountTarget(e.data.targets);o.datum(n?n.values:[]);e.eventRect=o.selectAll("."+$.eventRect);i=e.eventRect.data(function(e){return e});e.generateEventRectsForSingleX(i.enter());e.updateEventRect(i);i.exit().remove()}};d.updateEventRect=function(e){var r=this,n=r.config,t,i,o,s,a,l;e=e||r.eventRect.data(function(e){return e});if(r.isMultipleX()){t=0;i=0;o=r.width;s=r.height}else{if((r.isCustomX()||r.isTimeSeries())&&!r.isCategorized()){r.updateXs();a=function(e){var t=r.getPrevX(e.index),i=r.getNextX(e.index);if(t===null&&i===null){return n.axis_rotated?r.height:r.width}if(t===null){t=r.x.domain()[0]}if(i===null){i=r.x.domain()[1]}return Math.max(0,(r.x(i)-r.x(t))/2)};l=function(e){var t=r.getPrevX(e.index),i=r.getNextX(e.index),n=r.data.xs[e.id][e.index];if(t===null&&i===null){return 0}if(t===null){t=r.x.domain()[0]}return(r.x(n)+r.x(t))/2}}else{a=r.getEventRectWidth();l=function(e){return r.x(e.x)-a/2}}t=n.axis_rotated?0:l;i=n.axis_rotated?l:0;o=n.axis_rotated?r.width:a;s=n.axis_rotated?a:r.height}e.attr("class",r.classEvent.bind(r)).attr("x",t).attr("y",i).attr("width",o).attr("height",s)};d.generateEventRectsForSingleX=function(e){var r=this,o=r.d3,s=r.config;e.append("rect").attr("class",r.classEvent.bind(r)).style("cursor",s.data_selection_enabled&&s.data_selection_grouped?"pointer":null).on("mouseover",function(e){var t=e.index;if(r.dragging||r.flowing){return}if(r.hasArcType()){return}if(s.point_focus_expand_enabled){r.expandCircles(t,null,true)}r.expandBars(t,null,true);r.main.selectAll("."+$.shape+"-"+t).each(function(e){s.data_onmouseover.call(r.api,e)})}).on("mouseout",function(e){var t=e.index;if(!r.config){return}if(r.hasArcType()){return}r.hideXGridFocus();r.hideTooltip();r.unexpandCircles();r.unexpandBars();r.main.selectAll("."+$.shape+"-"+t).each(function(e){s.data_onmouseout.call(r.api,e)})}).on("mousemove",function(e){var t,i=e.index,n=r.svg.select("."+$.eventRect+"-"+i);if(r.dragging||r.flowing){return}if(r.hasArcType()){return}if(r.isStepType(e)&&r.config.line_step_type==="step-after"&&o.mouse(this)[0]<r.x(r.getXValue(e.id,i))){i-=1}t=r.filterTargetsToShow(r.data.targets).map(function(e){return r.addName(r.getValueOnIndex(e.values,i))});if(s.tooltip_grouped){r.showTooltip(t,this);r.showXGridFocus(t)}if(s.tooltip_grouped&&(!s.data_selection_enabled||s.data_selection_grouped)){return}r.main.selectAll("."+$.shape+"-"+i).each(function(){o.select(this).classed($.EXPANDED,true);if(s.data_selection_enabled){n.style("cursor",s.data_selection_grouped?"pointer":null)}if(!s.tooltip_grouped){r.hideXGridFocus();r.hideTooltip();if(!s.data_selection_grouped){r.unexpandCircles(i);r.unexpandBars(i)}}}).filter(function(e){return r.isWithinShape(this,e)}).each(function(e){if(s.data_selection_enabled&&(s.data_selection_grouped||s.data_selection_isselectable(e))){n.style("cursor","pointer")}if(!s.tooltip_grouped){r.showTooltip([e],this);r.showXGridFocus([e]);if(s.point_focus_expand_enabled){r.expandCircles(i,e.id,true)}r.expandBars(i,e.id,true)}})}).on("click",function(e){var t=e.index;if(r.hasArcType()||!r.toggleShape){return}if(r.cancelClick){r.cancelClick=false;return}if(r.isStepType(e)&&s.line_step_type==="step-after"&&o.mouse(this)[0]<r.x(r.getXValue(e.id,t))){t-=1}r.main.selectAll("."+$.shape+"-"+t).each(function(e){if(s.data_selection_grouped||r.isWithinShape(this,e)){r.toggleShape(this,e,t);r.config.data_onclick.call(r.api,e,this)}})}).call(s.data_selection_draggable&&r.drag?o.behavior.drag().origin(Object).on("drag",function(){r.drag(o.mouse(this))}).on("dragstart",function(){r.dragstart(o.mouse(this))}).on("dragend",function(){r.dragend()}):function(){})};d.generateEventRectsForMultipleXs=function(e){var o=this,s=o.d3,a=o.config;function l(){o.svg.select("."+$.eventRect).style("cursor",null);o.hideXGridFocus();o.hideTooltip();o.unexpandCircles();o.unexpandBars()}e.append("rect").attr("x",0).attr("y",0).attr("width",o.width).attr("height",o.height).attr("class",$.eventRect).on("mouseout",function(){if(!o.config){return}if(o.hasArcType()){return}l()}).on("mousemove",function(){var e=o.filterTargetsToShow(o.data.targets);var t,i,n,r;if(o.dragging){return}if(o.hasArcType(e)){return}t=s.mouse(this);i=o.findClosestFromTargets(e,t);if(o.mouseover&&(!i||i.id!==o.mouseover.id)){a.data_onmouseout.call(o.api,o.mouseover);o.mouseover=undefined}if(!i){l();return}if(o.isScatterType(i)||!a.tooltip_grouped){n=[i]}else{n=o.filterByX(e,i.x)}r=n.map(function(e){return o.addName(e)});o.showTooltip(r,this);if(a.point_focus_expand_enabled){o.expandCircles(i.index,i.id,true)}o.expandBars(i.index,i.id,true);o.showXGridFocus(r);if(o.isBarType(i.id)||o.dist(i,t)<100){o.svg.select("."+$.eventRect).style("cursor","pointer");if(!o.mouseover){a.data_onmouseover.call(o.api,i);o.mouseover=i}}}).on("click",function(){var e=o.filterTargetsToShow(o.data.targets);var t,i;if(o.hasArcType(e)){return}t=s.mouse(this);i=o.findClosestFromTargets(e,t);if(!i){return}if(o.isBarType(i.id)||o.dist(i,t)<100){o.main.selectAll("."+$.shapes+o.getTargetSelectorSuffix(i.id)).selectAll("."+$.shape+"-"+i.index).each(function(){if(a.data_selection_grouped||o.isWithinShape(this,i)){o.toggleShape(this,i,i.index);o.config.data_onclick.call(o.api,i,this)}})}}).call(a.data_selection_draggable&&o.drag?s.behavior.drag().origin(Object).on("drag",function(){o.drag(s.mouse(this))}).on("dragstart",function(){o.dragstart(s.mouse(this))}).on("dragend",function(){o.dragend()}):function(){})};d.dispatchEvent=function(e,t,i){var n=this,r="."+$.eventRect+(!n.isMultipleX()?"-"+t:""),o=n.main.select(r).node(),s=o.getBoundingClientRect(),a=s.left+(i?i[0]:0),l=s.top+(i?i[1]:0),c=document.createEvent("MouseEvents");c.initMouseEvent(e,true,true,u,0,a,l,a,l,false,false,false,false,0,null);o.dispatchEvent(c)};d.getCurrentWidth=function(){var e=this,t=e.config;return t.size_width?t.size_width:e.getParentWidth()};d.getCurrentHeight=function(){var e=this,t=e.config,i=t.size_height?t.size_height:e.getParentHeight();return i>0?i:320/(e.hasType("gauge")?2:1)};d.getCurrentPaddingTop=function(){var e=this.config;return T(e.padding_top)?e.padding_top:0};d.getCurrentPaddingBottom=function(){var e=this.config;return T(e.padding_bottom)?e.padding_bottom:0};d.getCurrentPaddingLeft=function(e){var t=this,i=t.config;if(T(i.padding_left)){return i.padding_left}else if(i.axis_rotated){return!i.axis_x_show?1:Math.max(c(t.getAxisWidthByAxisId("x",e)),40)}else if(!i.axis_y_show||i.axis_y_inner){return t.axis.getYAxisLabelPosition().isOuter?30:1}else{return c(t.getAxisWidthByAxisId("y",e))}};d.getCurrentPaddingRight=function(){var e=this,t=e.config,i=10,n=e.isLegendRight?e.getLegendWidth()+20:0;if(T(t.padding_right)){return t.padding_right+1}else if(t.axis_rotated){return i+n}else if(!t.axis_y2_show||t.axis_y2_inner){return 2+n+(e.axis.getY2AxisLabelPosition().isOuter?20:0)}else{return c(e.getAxisWidthByAxisId("y2"))+n}};d.getParentRectValue=function(t){var i=this.selectChart.node(),n;while(i&&i.tagName!=="BODY"){try{n=i.getBoundingClientRect()[t]}catch(e){if(t==="width"){n=i.offsetWidth}}if(n){break}i=i.parentNode}return n};d.getParentWidth=function(){return this.getParentRectValue("width")};d.getParentHeight=function(){var e=this.selectChart.style("height");return e.indexOf("px")>0?+e.replace("px",""):0};d.getSvgLeft=function(e){var t=this,i=t.config,n=i.axis_rotated||!i.axis_rotated&&!i.axis_y_inner,r=i.axis_rotated?$.axisX:$.axisY,o=t.main.select("."+r).node(),s=o&&n?o.getBoundingClientRect():{right:0},a=t.selectChart.node().getBoundingClientRect(),l=t.hasArcType(),c=s.right-a.left-(l?0:t.getCurrentPaddingLeft(e));return c>0?c:0};d.getAxisWidthByAxisId=function(e,t){var i=this,n=i.axis.getLabelPositionById(e);return i.axis.getMaxTickWidth(e,t)+(n.isInner?20:40)};d.getHorizontalAxisHeight=function(e){var t=this,i=t.config,n=30;if(e==="x"&&!i.axis_x_show){return 8}if(e==="x"&&i.axis_x_height){return i.axis_x_height}if(e==="y"&&!i.axis_y_show){return i.legend_show&&!t.isLegendRight&&!t.isLegendInset?10:1}if(e==="y2"&&!i.axis_y2_show){return t.rotated_padding_top}if(e==="x"&&!i.axis_rotated&&i.axis_x_tick_rotate){n=30+t.axis.getMaxTickWidth(e)*Math.cos(Math.PI*(90-i.axis_x_tick_rotate)/180)}return n+(t.axis.getLabelPositionById(e).isInner?0:10)+(e==="y2"?-10:0)};d.getEventRectWidth=function(){return Math.max(0,this.xAxis.tickInterval())};d.getShapeIndices=function(e){var t=this,i=t.config,n={},r=0,o,s;t.filterTargetsToShow(t.data.targets.filter(e,t)).forEach(function(e){for(o=0;o<i.data_groups.length;o++){if(i.data_groups[o].indexOf(e.id)<0){continue}for(s=0;s<i.data_groups[o].length;s++){if(i.data_groups[o][s]in n){n[e.id]=n[i.data_groups[o][s]];break}}}if(S(n[e.id])){n[e.id]=r++}});n.__max__=r-1;return n};d.getShapeX=function(i,n,r,e){var t=this,o=e?t.subX:t.x;return function(e){var t=e.id in r?r[e.id]:0;return e.x||e.x===0?o(e.x)-i*(n/2-t):0}};d.getShapeY=function(i){var n=this;return function(e){var t=i?n.getSubYScale(e.id):n.getYScale(e.id);return t(e.value)}};d.getShapeOffset=function(e,a,t){var l=this,c=l.orderTargets(l.filterTargetsToShow(l.data.targets.filter(e,l))),u=c.map(function(e){return e.id});return function(i,n){var r=t?l.getSubYScale(i.id):l.getYScale(i.id),o=r(0),s=o;c.forEach(function(e){var t=l.isStepType(i)?l.convertValuesToStep(e.values):e.values;if(e.id===i.id||a[e.id]!==a[i.id]){return}if(u.indexOf(e.id)<u.indexOf(i.id)){if(t[n].value*i.value>=0){s+=r(t[n].value)-o}}});return s}};d.isWithinShape=function(e,t){var i=this,n=i.d3.select(e),r;if(!i.isTargetToShow(t.id)){r=false}else if(e.nodeName==="circle"){r=i.isStepType(t)?i.isWithinStep(e,i.getYScale(t.id)(t.value)):i.isWithinCircle(e,i.pointSelectR(t)*1.5)}else if(e.nodeName==="path"){r=n.classed($.bar)?i.isWithinBar(e):true}return r};d.getInterpolate=function(e){var t=this;return t.isSplineType(e)?"cardinal":t.isStepType(e)?t.config.line_step_type:"linear"};d.initLine=function(){var e=this;e.main.select("."+$.chart).append("g").attr("class",$.chartLines)};d.updateTargetsForLine=function(e){var i=this,t=i.config,n,r,o=i.classChartLine.bind(i),s=i.classLines.bind(i),a=i.classAreas.bind(i),l=i.classCircles.bind(i),c=i.classFocus.bind(i);n=i.main.select("."+$.chartLines).selectAll("."+$.chartLine).data(e).attr("class",function(e){return o(e)+c(e)});r=n.enter().append("g").attr("class",o).style("opacity",0).style("pointer-events","none");r.append("g").attr("class",s);r.append("g").attr("class",a);r.append("g").attr("class",function(e){return i.generateClass($.selectedCircles,e.id)});r.append("g").attr("class",l).style("cursor",function(e){return t.data_selection_isselectable(e)?"pointer":null});e.forEach(function(t){i.main.selectAll("."+$.selectedCircles+i.getTargetSelectorSuffix(t.id)).selectAll("."+$.selectedCircle).each(function(e){e.value=t.values[e.index].value})})};d.updateLine=function(e){var t=this;t.mainLine=t.main.selectAll("."+$.lines).selectAll("."+$.line).data(t.lineData.bind(t));t.mainLine.enter().append("path").attr("class",t.classLine.bind(t)).style("stroke",t.color);t.mainLine.style("opacity",t.initialOpacity.bind(t)).style("shape-rendering",function(e){return t.isStepType(e)?"crispEdges":""}).attr("transform",null);t.mainLine.exit().transition().duration(e).style("opacity",0).remove()};d.redrawLine=function(e,t){return[(t?this.mainLine.transition():this.mainLine).attr("d",e).style("stroke",this.color).style("opacity",1)]};d.generateDrawLine=function(e,a){var l=this,c=l.config,u=l.d3.svg.line(),i=l.generateGetLinePoints(e,a),d=a?l.getSubYScale:l.getYScale,t=function(e){return(a?l.subxx:l.xx).call(l,e)},n=function(e,t){return c.data_groups.length>0?i(e,t)[0][1]:d.call(l,e.id)(e.value)};u=c.axis_rotated?u.x(n).y(t):u.x(t).y(n);if(!c.line_connectNull){u=u.defined(function(e){return e.value!=null})}return function(e){var t=c.line_connectNull?l.filterRemoveNull(e.values):e.values,i=a?l.x:l.subX,n=d.call(l,e.id),r=0,o=0,s;if(l.isLineType(e)){if(c.data_regions[e.id]){s=l.lineWithRegions(t,i,n,c.data_regions[e.id])}else{if(l.isStepType(e)){t=l.convertValuesToStep(t)}s=u.interpolate(l.getInterpolate(e))(t)}}else{if(t[0]){r=i(t[0].x);o=n(t[0].value)}s=c.axis_rotated?"M "+o+" "+r:"M "+r+" "+o}return s?s:"M 0 0"}};d.generateGetLinePoints=function(e,t){var s=this,a=s.config,i=e.__max__+1,l=s.getShapeX(0,i,e,!!t),c=s.getShapeY(!!t),u=s.getShapeOffset(s.isLineType,e,!!t),d=t?s.getSubYScale:s.getYScale;return function(e,t){var i=d.call(s,e.id)(0),n=u(e,t)||i,r=l(e),o=c(e);if(a.axis_rotated){if(0<e.value&&o<i||e.value<0&&i<o){o=i}}return[[r,o-(i-n)],[r,o-(i-n)],[r,o-(i-n)],[r,o-(i-n)]]}};d.lineWithRegions=function(e,c,u,t){var i=this,d=i.config,n=-1,r,o,s="M",a,l,h,f,p,g,m,v,y=i.isCategorized()?.5:0,b,_,w=[];function C(e,t){var i;for(i=0;i<t.length;i++){if(t[i].start<e&&e<=t[i].end){return true}}return false}if(N(t)){for(r=0;r<t.length;r++){w[r]={};if(S(t[r].start)){w[r].start=e[0].x}else{w[r].start=i.isTimeSeries()?i.parseDate(t[r].start):t[r].start}if(S(t[r].end)){w[r].end=e[e.length-1].x}else{w[r].end=i.isTimeSeries()?i.parseDate(t[r].end):t[r].end}}}b=d.axis_rotated?function(e){return u(e.value)}:function(e){return c(e.x)};_=d.axis_rotated?function(e){return c(e.x)}:function(e){return u(e.value)};function x(e){return"M"+e[0][0]+" "+e[0][1]+" "+e[1][0]+" "+e[1][1]}if(i.isTimeSeries()){a=function(e,t,i,n){var r=e.x.getTime(),o=t.x-e.x,s=new Date(r+o*i),a=new Date(r+o*(i+n)),l;if(d.axis_rotated){l=[[u(h(i)),c(s)],[u(h(i+n)),c(a)]]}else{l=[[c(s),u(h(i))],[c(a),u(h(i+n))]]}return x(l)}}else{a=function(e,t,i,n){var r;if(d.axis_rotated){r=[[u(h(i),true),c(l(i))],[u(h(i+n),true),c(l(i+n))]]}else{r=[[c(l(i),true),u(h(i))],[c(l(i+n),true),u(h(i+n))]]}return x(r)}}for(r=0;r<e.length;r++){if(S(w)||!C(e[r].x,w)){s+=" "+b(e[r])+" "+_(e[r])}else{l=i.getScale(e[r-1].x+y,e[r].x+y,i.isTimeSeries());h=i.getScale(e[r-1].value,e[r].value);f=c(e[r].x)-c(e[r-1].x);p=u(e[r].value)-u(e[r-1].value);g=Math.sqrt(Math.pow(f,2)+Math.pow(p,2));m=2/g;v=m*2;for(o=m;o<=1;o+=v){s+=a(e[r-1],e[r],o,m)}}n=e[r].x}return s};d.updateArea=function(e){var t=this,i=t.d3;t.mainArea=t.main.selectAll("."+$.areas).selectAll("."+$.area).data(t.lineData.bind(t));t.mainArea.enter().append("path").attr("class",t.classArea.bind(t)).style("fill",t.color).style("opacity",function(){t.orgAreaOpacity=+i.select(this).style("opacity");return 0});t.mainArea.style("opacity",t.orgAreaOpacity);t.mainArea.exit().transition().duration(e).style("opacity",0).remove()};d.redrawArea=function(e,t){return[(t?this.mainArea.transition():this.mainArea).attr("d",e).style("fill",this.color).style("opacity",this.orgAreaOpacity)]};d.generateDrawArea=function(e,t){var o=this,s=o.config,a=o.d3.svg.area(),i=o.generateGetAreaPoints(e,t),n=t?o.getSubYScale:o.getYScale,r=function(e){return(t?o.subxx:o.xx).call(o,e)},l=function(e,t){return s.data_groups.length>0?i(e,t)[0][1]:n.call(o,e.id)(o.getAreaBaseValue(e.id))},c=function(e,t){return s.data_groups.length>0?i(e,t)[1][1]:n.call(o,e.id)(e.value)};a=s.axis_rotated?a.x0(l).x1(c).y(r):a.x(r).y0(l).y1(c);if(!s.line_connectNull){a=a.defined(function(e){return e.value!==null})}return function(e){var t=s.line_connectNull?o.filterRemoveNull(e.values):e.values,i=0,n=0,r;if(o.isAreaType(e)){if(o.isStepType(e)){t=o.convertValuesToStep(t)}r=a.interpolate(o.getInterpolate(e))(t)}else{if(t[0]){i=o.x(t[0].x);n=o.getYScale(e.id)(t[0].value)}r=s.axis_rotated?"M "+n+" "+i:"M "+i+" "+n}return r?r:"M 0 0"}};d.getAreaBaseValue=function(){return 0};d.generateGetAreaPoints=function(e,t){var s=this,a=s.config,i=e.__max__+1,l=s.getShapeX(0,i,e,!!t),c=s.getShapeY(!!t),u=s.getShapeOffset(s.isAreaType,e,!!t),d=t?s.getSubYScale:s.getYScale;return function(e,t){var i=d.call(s,e.id)(0),n=u(e,t)||i,r=l(e),o=c(e);if(a.axis_rotated){if(0<e.value&&o<i||e.value<0&&i<o){o=i}}return[[r,n],[r,o-(i-n)],[r,o-(i-n)],[r,n]]}};d.updateCircle=function(){var e=this;e.mainCircle=e.main.selectAll("."+$.circles).selectAll("."+$.circle).data(e.lineOrScatterData.bind(e));e.mainCircle.enter().append("circle").attr("class",e.classCircle.bind(e)).attr("r",e.pointR.bind(e)).style("fill",e.color);e.mainCircle.style("opacity",e.initialOpacityForCircle.bind(e));e.mainCircle.exit().remove()};d.redrawCircle=function(e,t,i){var n=this.main.selectAll("."+$.selectedCircle);return[(i?this.mainCircle.transition():this.mainCircle).style("opacity",this.opacityForCircle.bind(this)).style("fill",this.color).attr("cx",e).attr("cy",t),(i?n.transition():n).attr("cx",e).attr("cy",t)]};d.circleX=function(e){return e.x||e.x===0?this.x(e.x):null};d.updateCircleY=function(){var t=this,e,i;if(t.config.data_groups.length>0){e=t.getShapeIndices(t.isLineType),i=t.generateGetLinePoints(e);t.circleY=function(e,t){return i(e,t)[0][1]}}else{t.circleY=function(e){return t.getYScale(e.id)(e.value)}}};d.getCircles=function(e,t){var i=this;return(t?i.main.selectAll("."+$.circles+i.getTargetSelectorSuffix(t)):i.main).selectAll("."+$.circle+(T(e)?"-"+e:""))};d.expandCircles=function(e,t,i){var n=this,r=n.pointExpandedR.bind(n);if(i){n.unexpandCircles()}n.getCircles(e,t).classed($.EXPANDED,true).attr("r",r)};d.unexpandCircles=function(e){var t=this,i=t.pointR.bind(t);t.getCircles(e).filter(function(){return t.d3.select(this).classed($.EXPANDED)}).classed($.EXPANDED,false).attr("r",i)};d.pointR=function(e){var t=this,i=t.config;return t.isStepType(e)?0:h(i.point_r)?i.point_r(e):i.point_r};d.pointExpandedR=function(e){var t=this,i=t.config;return i.point_focus_expand_enabled?i.point_focus_expand_r?i.point_focus_expand_r:t.pointR(e)*1.75:t.pointR(e)};d.pointSelectR=function(e){var t=this,i=t.config;return i.point_select_r?i.point_select_r:t.pointR(e)*4};d.isWithinCircle=function(e,t){var i=this.d3,n=i.mouse(e),r=i.select(e),o=+r.attr("cx"),s=+r.attr("cy");return Math.sqrt(Math.pow(o-n[0],2)+Math.pow(s-n[1],2))<t};d.isWithinStep=function(e,t){return Math.abs(t-this.d3.mouse(e)[1])<30};d.initBar=function(){var e=this;e.main.select("."+$.chart).append("g").attr("class",$.chartBars)};d.updateTargetsForBar=function(e){var t=this,i=t.config,n,r,o=t.classChartBar.bind(t),s=t.classBars.bind(t),a=t.classFocus.bind(t);n=t.main.select("."+$.chartBars).selectAll("."+$.chartBar).data(e).attr("class",function(e){return o(e)+a(e)});r=n.enter().append("g").attr("class",o).style("opacity",0).style("pointer-events","none");r.append("g").attr("class",s).style("cursor",function(e){return i.data_selection_isselectable(e)?"pointer":null})};d.updateBar=function(e){var t=this,i=t.barData.bind(t),n=t.classBar.bind(t),r=t.initialOpacity.bind(t),o=function(e){return t.color(e.id)};t.mainBar=t.main.selectAll("."+$.bars).selectAll("."+$.bar).data(i);t.mainBar.enter().append("path").attr("class",n).style("stroke",o).style("fill",o);t.mainBar.style("opacity",r);t.mainBar.exit().transition().duration(e).style("opacity",0).remove()};d.redrawBar=function(e,t){return[(t?this.mainBar.transition():this.mainBar).attr("d",e).style("fill",this.color).style("opacity",1)]};d.getBarW=function(e,t){var i=this,n=i.config,r=typeof n.bar_width==="number"?n.bar_width:t?e.tickInterval()*n.bar_width_ratio/t:0;return n.bar_width_max&&r>n.bar_width_max?n.bar_width_max:r};d.getBars=function(e,t){var i=this;return(t?i.main.selectAll("."+$.bars+i.getTargetSelectorSuffix(t)):i.main).selectAll("."+$.bar+(T(e)?"-"+e:""))};d.expandBars=function(e,t,i){var n=this;if(i){n.unexpandBars()}n.getBars(e,t).classed($.EXPANDED,true)};d.unexpandBars=function(e){var t=this;t.getBars(e).classed($.EXPANDED,false)};d.generateDrawBar=function(e,t){var i=this,s=i.config,a=i.generateGetBarPoints(e,t);return function(e,t){var i=a(e,t);var n=s.axis_rotated?1:0;var r=s.axis_rotated?0:1;var o="M "+i[0][n]+","+i[0][r]+" "+"L"+i[1][n]+","+i[1][r]+" "+"L"+i[2][n]+","+i[2][r]+" "+"L"+i[3][n]+","+i[3][r]+" "+"z";return o}};d.generateGetBarPoints=function(e,t){var s=this,i=t?s.subXAxis:s.xAxis,n=e.__max__+1,a=s.getBarW(i,n),l=s.getShapeX(a,n,e,!!t),c=s.getShapeY(!!t),u=s.getShapeOffset(s.isBarType,e,!!t),d=t?s.getSubYScale:s.getYScale;return function(e,t){var i=d.call(s,e.id)(0),n=u(e,t)||i,r=l(e),o=c(e);if(s.config.axis_rotated){if(0<e.value&&o<i||e.value<0&&i<o){o=i}}return[[r,n],[r,o-(i-n)],[r+a,o-(i-n)],[r+a,n]]}};d.isWithinBar=function(e){var t=this.d3.mouse(e),i=e.getBoundingClientRect(),n=e.pathSegList.getItem(0),r=e.pathSegList.getItem(1),o=Math.min(n.x,r.x),s=Math.min(n.y,r.y),a=i.width,l=i.height,c=2,u=o-c,d=o+a+c,h=s+l+c,f=s-c;return u<t[0]&&t[0]<d&&f<t[1]&&t[1]<h};d.initText=function(){var e=this;e.main.select("."+$.chart).append("g").attr("class",$.chartTexts);e.mainText=e.d3.selectAll([])};d.updateTargetsForText=function(e){var t=this,i,n,r=t.classChartText.bind(t),o=t.classTexts.bind(t),s=t.classFocus.bind(t);i=t.main.select("."+$.chartTexts).selectAll("."+$.chartText).data(e).attr("class",function(e){return r(e)+s(e)});n=i.enter().append("g").attr("class",r).style("opacity",0).style("pointer-events","none");n.append("g").attr("class",o)};d.updateText=function(e){var n=this,t=n.config,i=n.barOrLineData.bind(n),r=n.classText.bind(n);n.mainText=n.main.selectAll("."+$.texts).selectAll("."+$.text).data(i);n.mainText.enter().append("text").attr("class",r).attr("text-anchor",function(e){return t.axis_rotated?e.value<0?"end":"start":"middle"}).style("stroke","none").style("fill",function(e){return n.color(e)}).style("fill-opacity",0);n.mainText.text(function(e,t,i){return n.dataLabelFormat(e.id)(e.value,e.id,t,i)});n.mainText.exit().transition().duration(e).style("fill-opacity",0).remove()};d.redrawText=function(e,t,i,n){return[(n?this.mainText.transition():this.mainText).attr("x",e).attr("y",t).style("fill",this.color).style("fill-opacity",i?0:this.opacityForText.bind(this))]};d.getTextRect=function(e,t){var i=this.d3.select("body").append("div").classed("c3",true),n=i.append("svg").style("visibility","hidden").style("position","fixed").style("top",0).style("left",0),r;n.selectAll(".dummy").data([e]).enter().append("text").classed(t?t:"",true).text(e).each(function(){r=this.getBoundingClientRect()});i.remove();return r};d.generateXYForText=function(e,t,i,n){var r=this,o=r.generateGetAreaPoints(e,false),s=r.generateGetBarPoints(t,false),a=r.generateGetLinePoints(i,false),l=n?r.getXForText:r.getYForText;return function(e,t){var i=r.isAreaType(e)?o:r.isBarType(e)?s:a;return l.call(r,i(e,t),e,this)}};d.getXForText=function(e,t,i){var n=this,r=i.getBoundingClientRect(),o,s;if(n.config.axis_rotated){s=n.isBarType(t)?4:6;o=e[2][1]+s*(t.value<0?-1:1)}else{o=n.hasType("bar")?(e[2][0]+e[0][0])/2:e[0][0]}if(t.value===null){if(o>n.width){o=n.width-r.width}else if(o<0){o=4}}return o};d.getYForText=function(e,t,i){var n=this,r=i.getBoundingClientRect(),o;if(n.config.axis_rotated){o=(e[0][0]+e[2][0]+r.height*.6)/2}else{o=e[2][1];if(t.value<0){o+=r.height;if(n.isBarType(t)&&n.isSafari()){o-=3}else if(!n.isBarType(t)&&n.isChrome()){o+=3}}else{o+=n.isBarType(t)?-3:-6}}if(t.value===null&&!n.config.axis_rotated){if(o<r.height){o=r.height}else if(o>this.height){o=this.height-4}}return o};d.setTargetType=function(e,t){var i=this,n=i.config;i.mapToTargetIds(e).forEach(function(e){i.withoutFadeIn[e]=t===n.data_types[e];n.data_types[e]=t});if(!e){n.data_type=t}};d.hasType=function(i,e){var t=this,n=t.config.data_types,r=false;e=e||t.data.targets;if(e&&e.length){e.forEach(function(e){var t=n[e.id];if(t&&t.indexOf(i)>=0||!t&&i==="line"){r=true}})}else if(Object.keys(n).length){Object.keys(n).forEach(function(e){if(n[e]===i){r=true}})}else{r=t.config.data_type===i}return r};d.hasArcType=function(e){return this.hasType("pie",e)||this.hasType("donut",e)||this.hasType("gauge",e)};d.isLineType=function(e){var t=this.config,i=l(e)?e:e.id;return!t.data_types[i]||["line","spline","area","area-spline","step","area-step"].indexOf(t.data_types[i])>=0};d.isStepType=function(e){var t=l(e)?e:e.id;return["step","area-step"].indexOf(this.config.data_types[t])>=0};d.isSplineType=function(e){var t=l(e)?e:e.id;return["spline","area-spline"].indexOf(this.config.data_types[t])>=0};d.isAreaType=function(e){var t=l(e)?e:e.id;return["area","area-spline","area-step"].indexOf(this.config.data_types[t])>=0};d.isBarType=function(e){var t=l(e)?e:e.id;return this.config.data_types[t]==="bar"};d.isScatterType=function(e){var t=l(e)?e:e.id;return this.config.data_types[t]==="scatter"};d.isPieType=function(e){var t=l(e)?e:e.id;return this.config.data_types[t]==="pie"};d.isGaugeType=function(e){var t=l(e)?e:e.id;return this.config.data_types[t]==="gauge"};d.isDonutType=function(e){var t=l(e)?e:e.id;return this.config.data_types[t]==="donut"};d.isArcType=function(e){return this.isPieType(e)||this.isDonutType(e)||this.isGaugeType(e)};d.lineData=function(e){return this.isLineType(e)?[e]:[]};d.arcData=function(e){return this.isArcType(e.data)?[e]:[]};d.barData=function(e){return this.isBarType(e)?e.values:[]};d.lineOrScatterData=function(e){return this.isLineType(e)||this.isScatterType(e)?e.values:[]};d.barOrLineData=function(e){return this.isBarType(e)||this.isLineType(e)?e.values:[]};d.initGrid=function(){var e=this,t=e.config,i=e.d3;e.grid=e.main.append("g").attr("clip-path",e.clipPathForGrid).attr("class",$.grid);if(t.grid_x_show){e.grid.append("g").attr("class",$.xgrids)}if(t.grid_y_show){e.grid.append("g").attr("class",$.ygrids)}if(t.grid_focus_show){e.grid.append("g").attr("class",$.xgridFocus).append("line").attr("class",$.xgridFocus)}e.xgrid=i.selectAll([]);if(!t.grid_lines_front){e.initGridLines()}};d.initGridLines=function(){var e=this,t=e.d3;e.gridLines=e.main.append("g").attr("clip-path",e.clipPathForGrid).attr("class",$.grid+" "+$.gridLines);e.gridLines.append("g").attr("class",$.xgridLines);e.gridLines.append("g").attr("class",$.ygridLines);e.xgridLines=t.selectAll([])};d.updateXGrid=function(e){var t=this,i=t.config,n=t.d3,r=t.generateGridData(i.grid_x_type,t.x),o=t.isCategorized()?t.xAxis.tickOffset():0;t.xgridAttr=i.axis_rotated?{x1:0,x2:t.width,y1:function(e){return t.x(e)-o},y2:function(e){return t.x(e)-o}}:{x1:function(e){return t.x(e)+o},x2:function(e){return t.x(e)+o},y1:0,y2:t.height};t.xgrid=t.main.select("."+$.xgrids).selectAll("."+$.xgrid).data(r);t.xgrid.enter().append("line").attr("class",$.xgrid);if(!e){t.xgrid.attr(t.xgridAttr).style("opacity",function(){return+n.select(this).attr(i.axis_rotated?"y1":"x1")===(i.axis_rotated?t.height:0)?0:1})}t.xgrid.exit().remove()};d.updateYGrid=function(){var e=this,t=e.config,i=e.yAxis.tickValues()||e.y.ticks(t.grid_y_ticks);e.ygrid=e.main.select("."+$.ygrids).selectAll("."+$.ygrid).data(i);e.ygrid.enter().append("line").attr("class",$.ygrid);e.ygrid.attr("x1",t.axis_rotated?e.y:0).attr("x2",t.axis_rotated?e.y:e.width).attr("y1",t.axis_rotated?0:e.y).attr("y2",t.axis_rotated?e.height:e.y);e.ygrid.exit().remove();e.smoothLines(e.ygrid,"grid")};d.gridTextAnchor=function(e){return e.position?e.position:"end"};d.gridTextDx=function(e){return e.position==="start"?4:e.position==="middle"?0:-4};d.xGridTextX=function(e){return e.position==="start"?-this.height:e.position==="middle"?-this.height/2:0};d.yGridTextX=function(e){return e.position==="start"?0:e.position==="middle"?this.width/2:this.width};d.updateGrid=function(e){var t=this,i=t.main,n=t.config,r,o,s;t.grid.style("visibility",t.hasArcType()?"hidden":"visible");i.select("line."+$.xgridFocus).style("visibility","hidden");if(n.grid_x_show){t.updateXGrid()}t.xgridLines=i.select("."+$.xgridLines).selectAll("."+$.xgridLine).data(n.grid_x_lines);r=t.xgridLines.enter().append("g").attr("class",function(e){return $.xgridLine+(e["class"]?" "+e["class"]:"")});r.append("line").style("opacity",0);r.append("text").attr("text-anchor",t.gridTextAnchor).attr("transform",n.axis_rotated?"":"rotate(-90)").attr("dx",t.gridTextDx).attr("dy",-5).style("opacity",0);t.xgridLines.exit().transition().duration(e).style("opacity",0).remove();if(n.grid_y_show){t.updateYGrid()}t.ygridLines=i.select("."+$.ygridLines).selectAll("."+$.ygridLine).data(n.grid_y_lines);o=t.ygridLines.enter().append("g").attr("class",function(e){return $.ygridLine+(e["class"]?" "+e["class"]:"")});o.append("line").style("opacity",0);o.append("text").attr("text-anchor",t.gridTextAnchor).attr("transform",n.axis_rotated?"rotate(-90)":"").attr("dx",t.gridTextDx).attr("dy",-5).style("opacity",0);s=t.yv.bind(t);t.ygridLines.select("line").transition().duration(e).attr("x1",n.axis_rotated?s:0).attr("x2",n.axis_rotated?s:t.width).attr("y1",n.axis_rotated?0:s).attr("y2",n.axis_rotated?t.height:s).style("opacity",1);t.ygridLines.select("text").transition().duration(e).attr("x",n.axis_rotated?t.xGridTextX.bind(t):t.yGridTextX.bind(t)).attr("y",s).text(function(e){return e.text}).style("opacity",1);t.ygridLines.exit().transition().duration(e).style("opacity",0).remove()};d.redrawGrid=function(e){var t=this,i=t.config,n=t.xv.bind(t),r=t.xgridLines.select("line"),o=t.xgridLines.select("text");return[(e?r.transition():r).attr("x1",i.axis_rotated?0:n).attr("x2",i.axis_rotated?t.width:n).attr("y1",i.axis_rotated?n:0).attr("y2",i.axis_rotated?n:t.height).style("opacity",1),(e?o.transition():o).attr("x",i.axis_rotated?t.yGridTextX.bind(t):t.xGridTextX.bind(t)).attr("y",n).text(function(e){return e.text}).style("opacity",1)]};d.showXGridFocus=function(e){var t=this,i=t.config,n=e.filter(function(e){return e&&T(e.value)}),r=t.main.selectAll("line."+$.xgridFocus),o=t.xx.bind(t);if(!i.tooltip_show){return}if(t.hasType("scatter")||t.hasArcType()){return}r.style("visibility","visible").data([n[0]]).attr(i.axis_rotated?"y1":"x1",o).attr(i.axis_rotated?"y2":"x2",o);t.smoothLines(r,"grid")};d.hideXGridFocus=function(){this.main.select("line."+$.xgridFocus).style("visibility","hidden")};d.updateXgridFocus=function(){var e=this,t=e.config;e.main.select("line."+$.xgridFocus).attr("x1",t.axis_rotated?0:-10).attr("x2",t.axis_rotated?e.width:-10).attr("y1",t.axis_rotated?-10:0).attr("y2",t.axis_rotated?-10:e.height)};d.generateGridData=function(e,t){var i=this,n=[],r,o,s,a,l=i.main.select("."+$.axisX).selectAll(".tick").size();if(e==="year"){r=i.getXDomain();o=r[0].getFullYear();s=r[1].getFullYear();for(a=o;a<=s;a++){n.push(new Date(a+"-01-01 00:00:00"))}}else{n=t.ticks(10);if(n.length>l){n=n.filter(function(e){return(""+e).indexOf(".")<0})}}return n};d.getGridFilterToRemove=function(e){return e?function(t){var i=false;[].concat(e).forEach(function(e){if("value"in e&&t.value===e.value||"class"in e&&t["class"]===e["class"]){i=true}});return i}:function(){return true}};d.removeGridLines=function(e,t){var i=this,n=i.config,r=i.getGridFilterToRemove(e),o=function(e){return!r(e)},s=t?$.xgridLines:$.ygridLines,a=t?$.xgridLine:$.ygridLine;i.main.select("."+s).selectAll("."+a).filter(r).transition().duration(n.transition_duration).style("opacity",0).remove();if(t){n.grid_x_lines=n.grid_x_lines.filter(o)}else{n.grid_y_lines=n.grid_y_lines.filter(o)}};d.initTooltip=function(){var t=this,i=t.config,e;t.tooltip=t.selectChart.style("position","relative").append("div").attr("class",$.tooltipContainer).style("position","absolute").style("pointer-events","none").style("display","none");if(i.tooltip_init_show){if(t.isTimeSeries()&&l(i.tooltip_init_x)){i.tooltip_init_x=t.parseDate(i.tooltip_init_x);for(e=0;e<t.data.targets[0].values.length;e++){if(t.data.targets[0].values[e].x-i.tooltip_init_x===0){break}}i.tooltip_init_x=e}t.tooltip.html(i.tooltip_contents.call(t,t.data.targets.map(function(e){return t.addName(e.values[i.tooltip_init_x])}),t.axis.getXAxisTickFormat(),t.getYFormat(t.hasArcType()),t.color));t.tooltip.style("top",i.tooltip_init_position.top).style("left",i.tooltip_init_position.left).style("display","block")}};d.getTooltipContent=function(e,t,i,n){var r=this,o=r.config,s=o.tooltip_format_title||t,a=o.tooltip_format_name||function(e){return e},l=o.tooltip_format_value||i,c,u,d,h,f,p;for(u=0;u<e.length;u++){if(!(e[u]&&(e[u].value||e[u].value===0))){continue}if(!c){d=s?s(e[u].x):e[u].x;c="<table class='"+$.tooltip+"'>"+(d||d===0?"<tr><th colspan='2'>"+d+"</th></tr>":"")}h=l(e[u].value,e[u].ratio,e[u].id,e[u].index);if(h!==undefined){f=a(e[u].name,e[u].ratio,e[u].id,e[u].index);p=r.levelColor?r.levelColor(e[u].value):n(e[u].id);c+="<tr class='"+$.tooltipName+"-"+e[u].id+"'>";c+="<td class='name'><span style='background-color:"+p+"'></span>"+f+"</td>";c+="<td class='value'>"+h+"</td>";c+="</tr>"}}return c+"</table>"};d.tooltipPosition=function(e,t,i,n){var r=this,o=r.config,s=r.d3;var a,l,c,u,d;var h=r.hasArcType(),f=s.mouse(n);if(h){l=(r.width-(r.isLegendRight?r.getLegendWidth():0))/2+f[0];u=r.height/2+f[1]+20}else{a=r.getSvgLeft(true);if(o.axis_rotated){l=a+f[0]+100;c=l+t;d=r.currentWidth-r.getCurrentPaddingRight();u=r.x(e[0].x)+20}else{l=a+r.getCurrentPaddingLeft(true)+r.x(e[0].x)+20;c=l+t;d=a+r.currentWidth-r.getCurrentPaddingRight();u=f[1]+15}if(c>d){l-=c-d+20}if(u+i>r.currentHeight){u-=i+30}}if(u<0){u=0}return{top:u,left:l}};d.showTooltip=function(e,t){var i=this,n=i.config;var r,o,s;var a=i.hasArcType(),l=e.filter(function(e){return e&&T(e.value)}),c=n.tooltip_position||d.tooltipPosition;if(l.length===0||!n.tooltip_show){return}i.tooltip.html(n.tooltip_contents.call(i,e,i.axis.getXAxisTickFormat(),i.getYFormat(a),i.color)).style("display","block");r=i.tooltip.property("offsetWidth");o=i.tooltip.property("offsetHeight");s=c.call(this,l,r,o,t);i.tooltip.style("top",s.top+"px").style("left",s.left+"px")};d.hideTooltip=function(){this.tooltip.style("display","none")};d.initLegend=function(){var e=this;e.legendItemTextBox={};e.legendHasRendered=false;e.legend=e.svg.append("g").attr("transform",e.getTranslate("legend"));if(!e.config.legend_show){e.legend.style("visibility","hidden");e.hiddenLegendIds=e.mapToIds(e.data.targets);return}e.updateLegendWithDefaults()};d.updateLegendWithDefaults=function(){var e=this;e.updateLegend(e.mapToIds(e.data.targets),{withTransform:false,withTransitionForTransform:false,withTransition:false})};d.updateSizeForLegend=function(e,t){var i=this,n=i.config,r={top:i.isLegendTop?i.getCurrentPaddingTop()+n.legend_inset_y+5.5:i.currentHeight-e-i.getCurrentPaddingBottom()-n.legend_inset_y,left:i.isLegendLeft?i.getCurrentPaddingLeft()+n.legend_inset_x+.5:i.currentWidth-t-i.getCurrentPaddingRight()-n.legend_inset_x+.5};i.margin3={top:i.isLegendRight?0:i.isLegendInset?r.top:i.currentHeight-e,right:NaN,bottom:0,left:i.isLegendRight?i.currentWidth-t:i.isLegendInset?r.left:0}};d.transformLegend=function(e){var t=this;(e?t.legend.transition():t.legend).attr("transform",t.getTranslate("legend"))};d.updateLegendStep=function(e){this.legendStep=e};d.updateLegendItemWidth=function(e){this.legendItemWidth=e};d.updateLegendItemHeight=function(e){this.legendItemHeight=e};d.getLegendWidth=function(){var e=this;return e.config.legend_show?e.isLegendRight||e.isLegendInset?e.legendItemWidth*(e.legendStep+1):e.currentWidth:0};d.getLegendHeight=function(){var e=this,t=0;if(e.config.legend_show){if(e.isLegendRight){t=e.currentHeight}else{t=Math.max(20,e.legendItemHeight)*(e.legendStep+1)}}return t};d.opacityForLegend=function(e){return e.classed($.legendItemHidden)?null:1};d.opacityForUnfocusedLegend=function(e){return e.classed($.legendItemHidden)?null:.3};d.toggleFocusLegend=function(t,i){var n=this;t=n.mapToTargetIds(t);n.legend.selectAll("."+$.legendItem).filter(function(e){return t.indexOf(e)>=0}).classed($.legendItemFocused,i).transition().duration(100).style("opacity",function(){var e=i?n.opacityForLegend:n.opacityForUnfocusedLegend;return e.call(n,n.d3.select(this))})};d.revertLegend=function(){var e=this,t=e.d3;e.legend.selectAll("."+$.legendItem).classed($.legendItemFocused,false).transition().duration(100).style("opacity",function(){return e.opacityForLegend(t.select(this))})};d.showLegend=function(e){var t=this,i=t.config;if(!i.legend_show){i.legend_show=true;t.legend.style("visibility","visible");if(!t.legendHasRendered){t.updateLegendWithDefaults()}}t.removeHiddenLegendIds(e);t.legend.selectAll(t.selectorLegends(e)).style("visibility","visible").transition().style("opacity",function(){return t.opacityForLegend(t.d3.select(this))})};d.hideLegend=function(e){var t=this,i=t.config;if(i.legend_show&&p(e)){i.legend_show=false;t.legend.style("visibility","hidden")}t.addHiddenLegendIds(e);t.legend.selectAll(t.selectorLegends(e)).style("opacity",0).style("visibility","hidden")};d.clearLegendItemTextBoxCache=function(){this.legendItemTextBox={}};d.updateLegend=function(f,e,t){var p=this,g=p.config;var i,n,r,o,s,a;var m=4,v=10,y=0,b=0,_=10,w=15;var l,C=0,x={},S={},A={},E=[0],T={},D=0;var c,u;var d,h,R,M;e=e||{};c=H(e,"withTransition",true);u=H(e,"withTransitionForTransform",true);function k(e,t){if(!p.legendItemTextBox[t]){p.legendItemTextBox[t]=p.getTextRect(e.textContent,$.legendItem)}return p.legendItemTextBox[t]}function O(e,t,i){var n=i===0,r=i===f.length-1,o=k(e,t),s=o.width+w+(r&&!(p.isLegendRight||p.isLegendInset)?0:v),a=o.height+m,l=p.isLegendRight||p.isLegendInset?a:s,c=p.isLegendRight||p.isLegendInset?p.getLegendHeight():p.getLegendWidth(),u,d;function h(e,t){if(!t){u=(c-C-l)/2;if(u<_){u=(c-l)/2;C=0;D++}}T[e]=D;E[D]=p.isLegendInset?10:u;x[e]=C;C+=l}if(n){C=0;D=0;y=0;b=0}if(g.legend_show&&!p.isLegendToShow(t)){S[t]=A[t]=T[t]=x[t]=0;return}S[t]=s;A[t]=a;if(!y||s>=y){y=s}if(!b||a>=b){b=a}d=p.isLegendRight||p.isLegendInset?b:y;if(g.legend_equally){Object.keys(S).forEach(function(e){S[e]=y});Object.keys(A).forEach(function(e){A[e]=b});u=(c-d*f.length)/2;if(u<_){C=0;D=0;f.forEach(function(e){h(e)})}else{h(t,true)}}else{h(t)}}if(p.isLegendInset){D=g.legend_inset_step?g.legend_inset_step:f.length;p.updateLegendStep(D)}if(p.isLegendRight){i=function(e){return y*T[e]};o=function(e){return E[T[e]]+x[e]}}else if(p.isLegendInset){i=function(e){return y*T[e]+10};o=function(e){return E[T[e]]+x[e]}}else{i=function(e){return E[T[e]]+x[e]};o=function(e){return b*T[e]}}n=function(e,t){return i(e,t)+14};s=function(e,t){return o(e,t)+9};r=function(e,t){return i(e,t)};a=function(e,t){return o(e,t)-5};l=p.legend.selectAll("."+$.legendItem).data(f).enter().append("g").attr("class",function(e){return p.generateClass($.legendItem,e)}).style("visibility",function(e){return p.isLegendToShow(e)?"visible":"hidden"}).style("cursor","pointer").on("click",function(e){if(g.legend_item_onclick){g.legend_item_onclick.call(p,e)}else{if(p.d3.event.altKey){p.api.hide();p.api.show(e)}else{p.api.toggle(e);p.isTargetToShow(e)?p.api.focus(e):p.api.revert()}}}).on("mouseover",function(e){p.d3.select(this).classed($.legendItemFocused,true);if(!p.transiting&&p.isTargetToShow(e)){p.api.focus(e)}if(g.legend_item_onmouseover){g.legend_item_onmouseover.call(p,e)}}).on("mouseout",function(e){p.d3.select(this).classed($.legendItemFocused,false);p.api.revert();if(g.legend_item_onmouseout){g.legend_item_onmouseout.call(p,e)}});l.append("text").text(function(e){return N(g.data_names[e])?g.data_names[e]:e}).each(function(e,t){O(this,e,t)}).style("pointer-events","none").attr("x",p.isLegendRight||p.isLegendInset?n:-200).attr("y",p.isLegendRight||p.isLegendInset?-200:s);l.append("rect").attr("class",$.legendItemEvent).style("fill-opacity",0).attr("x",p.isLegendRight||p.isLegendInset?r:-200).attr("y",p.isLegendRight||p.isLegendInset?-200:a);l.append("rect").attr("class",$.legendItemTile).style("pointer-events","none").style("fill",p.color).attr("x",p.isLegendRight||p.isLegendInset?n:-200).attr("y",p.isLegendRight||p.isLegendInset?-200:o).attr("width",10).attr("height",10);M=p.legend.select("."+$.legendBackground+" rect");if(p.isLegendInset&&y>0&&M.size()===0){M=p.legend.insert("g","."+$.legendItem).attr("class",$.legendBackground).append("rect")}d=p.legend.selectAll("text").data(f).text(function(e){return N(g.data_names[e])?g.data_names[e]:e}).each(function(e,t){O(this,e,t)});(c?d.transition():d).attr("x",n).attr("y",s);h=p.legend.selectAll("rect."+$.legendItemEvent).data(f);(c?h.transition():h).attr("width",function(e){return S[e]}).attr("height",function(e){return A[e]}).attr("x",r).attr("y",a);R=p.legend.selectAll("rect."+$.legendItemTile).data(f);(c?R.transition():R).style("fill",p.color).attr("x",i).attr("y",o);if(M){(c?M.transition():M).attr("height",p.getLegendHeight()-12).attr("width",y*(D+1)+10)}p.legend.selectAll("."+$.legendItem).classed($.legendItemHidden,function(e){return!p.isTargetToShow(e)});p.updateLegendItemWidth(y);p.updateLegendItemHeight(b);p.updateLegendStep(D);p.updateSizes();p.updateScales();p.updateSvgSize();p.transformAll(u,t);p.legendHasRendered=true};function a(e){n.call(this,e)}r(n,a);a.prototype.init=function e(){var t=this.owner,i=t.config,n=t.main;t.axes.x=n.append("g").attr("class",$.axis+" "+$.axisX).attr("clip-path",t.clipPathForXAxis).attr("transform",t.getTranslate("x")).style("visibility",i.axis_x_show?"visible":"hidden");t.axes.x.append("text").attr("class",$.axisXLabel).attr("transform",i.axis_rotated?"rotate(-90)":"").style("text-anchor",this.textAnchorForXAxisLabel.bind(this));t.axes.y=n.append("g").attr("class",$.axis+" "+$.axisY).attr("clip-path",i.axis_y_inner?"":t.clipPathForYAxis).attr("transform",t.getTranslate("y")).style("visibility",i.axis_y_show?"visible":"hidden");t.axes.y.append("text").attr("class",$.axisYLabel).attr("transform",i.axis_rotated?"":"rotate(-90)").style("text-anchor",this.textAnchorForYAxisLabel.bind(this));t.axes.y2=n.append("g").attr("class",$.axis+" "+$.axisY2).attr("transform",t.getTranslate("y2")).style("visibility",i.axis_y2_show?"visible":"hidden");t.axes.y2.append("text").attr("class",$.axisY2Label).attr("transform",i.axis_rotated?"":"rotate(-90)").style("text-anchor",this.textAnchorForY2AxisLabel.bind(this))};a.prototype.getXAxis=function e(t,i,n,r,o,s,a){var l=this.owner,c=l.config,u={isCategory:l.isCategorized(),withOuterTick:o,tickMultiline:c.axis_x_tick_multiline,tickWidth:c.axis_x_tick_width,tickTextRotate:a?0:c.axis_x_tick_rotate,withoutTransition:s},d=v(l.d3,u).scale(t).orient(i);if(l.isTimeSeries()&&r){r=r.map(function(e){return l.parseDate(e)})}d.tickFormat(n).tickValues(r);if(l.isCategorized()){d.tickCentered(c.axis_x_tick_centered);if(p(c.axis_x_tick_culling)){c.axis_x_tick_culling=false}}return d};a.prototype.updateXAxisTickValues=function e(t,i){var n=this.owner,r=n.config,o;if(r.axis_x_tick_fit||r.axis_x_tick_count){o=this.generateTickValues(n.mapTargetsToUniqueXs(t),r.axis_x_tick_count,n.isTimeSeries())}if(i){i.tickValues(o)}else{n.xAxis.tickValues(o);n.subXAxis.tickValues(o)}return o};a.prototype.getYAxis=function e(t,i,n,r,o,s){var a={withOuterTick:o,withoutTransition:s},l=this.owner,c=l.d3,u=l.config,d=v(c,a).scale(t).orient(i).tickFormat(n);if(l.isTimeSeriesY()){d.ticks(c.time[u.axis_y_tick_time_value],u.axis_y_tick_time_interval)}else{d.tickValues(r)}return d};a.prototype.getId=function e(t){var i=this.owner.config;return t in i.data_axes?i.data_axes[t]:"y"};a.prototype.getXAxisTickFormat=function e(){var t=this.owner,i=t.config,n=t.isTimeSeries()?t.defaultAxisTimeFormat:t.isCategorized()?t.categoryName:function(e){return e<0?e.toFixed(0):e};if(i.axis_x_tick_format){if(h(i.axis_x_tick_format)){n=i.axis_x_tick_format}else if(t.isTimeSeries()){n=function(e){return e?t.axisTimeFormat(i.axis_x_tick_format)(e):""}}}return h(n)?function(e){return n.call(t,e)}:n};a.prototype.getTickValues=function e(t,i){return t?t:i?i.tickValues():undefined};a.prototype.getXAxisTickValues=function e(){return this.getTickValues(this.owner.config.axis_x_tick_values,this.owner.xAxis)};a.prototype.getYAxisTickValues=function e(){return this.getTickValues(this.owner.config.axis_y_tick_values,this.owner.yAxis)};a.prototype.getY2AxisTickValues=function e(){return this.getTickValues(this.owner.config.axis_y2_tick_values,this.owner.y2Axis)};a.prototype.getLabelOptionByAxisId=function e(t){var i=this.owner,n=i.config,r;if(t==="y"){r=n.axis_y_label}else if(t==="y2"){r=n.axis_y2_label}else if(t==="x"){r=n.axis_x_label}return r};a.prototype.getLabelText=function e(t){var i=this.getLabelOptionByAxisId(t);return l(i)?i:i?i.text:null};a.prototype.setLabelText=function e(t,i){var n=this.owner,r=n.config,o=this.getLabelOptionByAxisId(t);if(l(o)){if(t==="y"){r.axis_y_label=i}else if(t==="y2"){r.axis_y2_label=i}else if(t==="x"){r.axis_x_label=i}}else if(o){o.text=i}};a.prototype.getLabelPosition=function e(t,i){var n=this.getLabelOptionByAxisId(t),r=n&&typeof n==="object"&&n.position?n.position:i;return{isInner:r.indexOf("inner")>=0,isOuter:r.indexOf("outer")>=0,isLeft:r.indexOf("left")>=0,isCenter:r.indexOf("center")>=0,isRight:r.indexOf("right")>=0,isTop:r.indexOf("top")>=0,isMiddle:r.indexOf("middle")>=0,isBottom:r.indexOf("bottom")>=0}};a.prototype.getXAxisLabelPosition=function e(){return this.getLabelPosition("x",this.owner.config.axis_rotated?"inner-top":"inner-right")};a.prototype.getYAxisLabelPosition=function e(){return this.getLabelPosition("y",this.owner.config.axis_rotated?"inner-right":"inner-top")};a.prototype.getY2AxisLabelPosition=function e(){return this.getLabelPosition("y2",this.owner.config.axis_rotated?"inner-right":"inner-top")};a.prototype.getLabelPositionById=function e(t){return t==="y2"?this.getY2AxisLabelPosition():t==="y"?this.getYAxisLabelPosition():this.getXAxisLabelPosition()};a.prototype.textForXAxisLabel=function e(){return this.getLabelText("x")};a.prototype.textForYAxisLabel=function e(){return this.getLabelText("y")};a.prototype.textForY2AxisLabel=function e(){return this.getLabelText("y2")};a.prototype.xForAxisLabel=function e(t,i){var n=this.owner;if(t){return i.isLeft?0:i.isCenter?n.width/2:n.width}else{return i.isBottom?-n.height:i.isMiddle?-n.height/2:0}};a.prototype.dxForAxisLabel=function e(t,i){if(t){return i.isLeft?"0.5em":i.isRight?"-0.5em":"0"}else{return i.isTop?"-0.5em":i.isBottom?"0.5em":"0"}};a.prototype.textAnchorForAxisLabel=function e(t,i){if(t){return i.isLeft?"start":i.isCenter?"middle":"end"}else{return i.isBottom?"start":i.isMiddle?"middle":"end"}};a.prototype.xForXAxisLabel=function e(){return this.xForAxisLabel(!this.owner.config.axis_rotated,this.getXAxisLabelPosition())};a.prototype.xForYAxisLabel=function e(){return this.xForAxisLabel(this.owner.config.axis_rotated,this.getYAxisLabelPosition())};a.prototype.xForY2AxisLabel=function e(){return this.xForAxisLabel(this.owner.config.axis_rotated,this.getY2AxisLabelPosition())};a.prototype.dxForXAxisLabel=function e(){return this.dxForAxisLabel(!this.owner.config.axis_rotated,this.getXAxisLabelPosition())};a.prototype.dxForYAxisLabel=function e(){return this.dxForAxisLabel(this.owner.config.axis_rotated,this.getYAxisLabelPosition())};a.prototype.dxForY2AxisLabel=function e(){return this.dxForAxisLabel(this.owner.config.axis_rotated,this.getY2AxisLabelPosition())};a.prototype.dyForXAxisLabel=function e(){var t=this.owner,i=t.config,n=this.getXAxisLabelPosition();if(i.axis_rotated){return n.isInner?"1.2em":-25-this.getMaxTickWidth("x")}else{return n.isInner?"-0.5em":i.axis_x_height?i.axis_x_height-10:"3em"}};a.prototype.dyForYAxisLabel=function e(){var t=this.owner,i=this.getYAxisLabelPosition();if(t.config.axis_rotated){return i.isInner?"-0.5em":"3em"}else{return i.isInner?"1.2em":-10-(t.config.axis_y_inner?0:this.getMaxTickWidth("y")+10)}};a.prototype.dyForY2AxisLabel=function e(){var t=this.owner,i=this.getY2AxisLabelPosition();if(t.config.axis_rotated){return i.isInner?"1.2em":"-2.2em"}else{return i.isInner?"-0.5em":15+(t.config.axis_y2_inner?0:this.getMaxTickWidth("y2")+15)}};a.prototype.textAnchorForXAxisLabel=function e(){var t=this.owner;return this.textAnchorForAxisLabel(!t.config.axis_rotated,this.getXAxisLabelPosition())};a.prototype.textAnchorForYAxisLabel=function e(){var t=this.owner;return this.textAnchorForAxisLabel(t.config.axis_rotated,this.getYAxisLabelPosition())};a.prototype.textAnchorForY2AxisLabel=function e(){var t=this.owner;return this.textAnchorForAxisLabel(t.config.axis_rotated,this.getY2AxisLabelPosition())};a.prototype.getMaxTickWidth=function e(t,i){var n=this.owner,r=n.config,o=0,s,a,l,c,u;if(i&&n.currentMaxTickWidths[t]){return n.currentMaxTickWidths[t]}if(n.svg){s=n.filterTargetsToShow(n.data.targets);if(t==="y"){a=n.y.copy().domain(n.getYDomain(s,"y"));l=this.getYAxis(a,n.yOrient,r.axis_y_tick_format,n.yAxisTickValues,false,true)}else if(t==="y2"){a=n.y2.copy().domain(n.getYDomain(s,"y2"));l=this.getYAxis(a,n.y2Orient,r.axis_y2_tick_format,n.y2AxisTickValues,false,true)}else{a=n.x.copy().domain(n.getXDomain(s));l=this.getXAxis(a,n.xOrient,n.xAxisTickFormat,n.xAxisTickValues,false,true,true);this.updateXAxisTickValues(s,l)}c=n.d3.select("body").append("div").classed("c3",true);u=c.append("svg").style("visibility","hidden").style("position","fixed").style("top",0).style("left",0),u.append("g").call(l).each(function(){n.d3.select(this).selectAll("text").each(function(){var e=this.getBoundingClientRect();if(o<e.width){o=e.width}});c.remove()})}n.currentMaxTickWidths[t]=o<=0?n.currentMaxTickWidths[t]:o;return n.currentMaxTickWidths[t]};a.prototype.updateLabels=function e(t){var i=this.owner;var n=i.main.select("."+$.axisX+" ."+$.axisXLabel),r=i.main.select("."+$.axisY+" ."+$.axisYLabel),o=i.main.select("."+$.axisY2+" ."+$.axisY2Label);(t?n.transition():n).attr("x",this.xForXAxisLabel.bind(this)).attr("dx",this.dxForXAxisLabel.bind(this)).attr("dy",this.dyForXAxisLabel.bind(this)).text(this.textForXAxisLabel.bind(this));(t?r.transition():r).attr("x",this.xForYAxisLabel.bind(this)).attr("dx",this.dxForYAxisLabel.bind(this)).attr("dy",this.dyForYAxisLabel.bind(this)).text(this.textForYAxisLabel.bind(this));(t?o.transition():o).attr("x",this.xForY2AxisLabel.bind(this)).attr("dx",this.dxForY2AxisLabel.bind(this)).attr("dy",this.dyForY2AxisLabel.bind(this)).text(this.textForY2AxisLabel.bind(this))};a.prototype.getPadding=function e(t,i,n,r){if(!T(t[i])){return n}if(t.unit==="ratio"){return t[i]*r}return this.convertPixelsToAxisPadding(t[i],r)};a.prototype.convertPixelsToAxisPadding=function e(t,i){var n=this.owner,r=n.config.axis_rotated?n.width:n.height;return i*(t/r)};a.prototype.generateTickValues=function e(t,i,n){var r=t,o,s,a,l,c,u,d;if(i){o=h(i)?i():i;if(o===1){r=[t[0]]}else if(o===2){r=[t[0],t[t.length-1]]}else if(o>2){l=o-2;s=t[0];a=t[t.length-1];c=(a-s)/(l+1);r=[s];for(u=0;u<l;u++){d=+s+c*(u+1);r.push(n?new Date(d):d)}r.push(a)}}if(!n){r=r.sort(function(e,t){return e-t})}return r};a.prototype.generateTransitions=function e(t){var i=this.owner,n=i.axes;return{axisX:t?n.x.transition().duration(t):n.x,axisY:t?n.y.transition().duration(t):n.y,axisY2:t?n.y2.transition().duration(t):n.y2,axisSubX:t?n.subx.transition().duration(t):n.subx}};a.prototype.redraw=function e(t,i){var n=this.owner;n.axes.x.style("opacity",i?0:1);n.axes.y.style("opacity",i?0:1);n.axes.y2.style("opacity",i?0:1);n.axes.subx.style("opacity",i?0:1);t.axisX.call(n.xAxis);t.axisY.call(n.yAxis);t.axisY2.call(n.y2Axis);t.axisSubX.call(n.subXAxis)};d.getClipPath=function(e){var t=u.navigator.appVersion.toLowerCase().indexOf("msie 9.")>=0;return"url("+(t?"":document.URL.split("#")[0])+"#"+e+")"};d.appendClip=function(e,t){return e.append("clipPath").attr("id",t).append("rect")};d.getAxisClipX=function(e){var t=Math.max(30,this.margin.left);return e?-(1+t):-(t-1)};d.getAxisClipY=function(e){return e?-20:-this.margin.top};d.getXAxisClipX=function(){var e=this;return e.getAxisClipX(!e.config.axis_rotated)};d.getXAxisClipY=function(){var e=this;return e.getAxisClipY(!e.config.axis_rotated)};d.getYAxisClipX=function(){var e=this;return e.config.axis_y_inner?-1:e.getAxisClipX(e.config.axis_rotated)};d.getYAxisClipY=function(){var e=this;return e.getAxisClipY(e.config.axis_rotated)};d.getAxisClipWidth=function(e){var t=this,i=Math.max(30,t.margin.left),n=Math.max(30,t.margin.right);return e?t.width+2+i+n:t.margin.left+20};d.getAxisClipHeight=function(e){return(e?this.margin.bottom:this.margin.top+this.height)+20};d.getXAxisClipWidth=function(){var e=this;return e.getAxisClipWidth(!e.config.axis_rotated)};d.getXAxisClipHeight=function(){var e=this;return e.getAxisClipHeight(!e.config.axis_rotated)};d.getYAxisClipWidth=function(){var e=this;return e.getAxisClipWidth(e.config.axis_rotated)+(e.config.axis_y_inner?20:0)};d.getYAxisClipHeight=function(){var e=this;return e.getAxisClipHeight(e.config.axis_rotated)};d.initPie=function(){var e=this,t=e.d3,i=e.config;e.pie=t.layout.pie().value(function(e){return e.values.reduce(function(e,t){return e+t.value},0)});if(!i.data_order){e.pie.sort(null)}};d.updateRadius=function(){var e=this,t=e.config,i=t.gauge_width||t.donut_width;e.radiusExpanded=Math.min(e.arcWidth,e.arcHeight)/2;e.radius=e.radiusExpanded*.95;e.innerRadiusRatio=i?(e.radius-i)/e.radius:.6;e.innerRadius=e.hasType("donut")||e.hasType("gauge")?e.radius*e.innerRadiusRatio:0};d.updateArc=function(){var e=this;e.svgArc=e.getSvgArc();e.svgArcExpanded=e.getSvgArcExpanded();e.svgArcExpandedSub=e.getSvgArcExpanded(.98)};d.updateAngle=function(t){var e=this,i=e.config,n=false,r=0,o=i.gauge_min,s=i.gauge_max,a,l;e.pie(e.filterTargetsToShow(e.data.targets)).forEach(function(e){if(!n&&e.data.id===t.data.id){n=true;t=e;t.index=r}r++});if(isNaN(t.startAngle)){t.startAngle=0}if(isNaN(t.endAngle)){t.endAngle=t.startAngle}if(e.isGaugeType(t.data)){a=Math.PI/(s-o);l=t.value<o?0:t.value<s?t.value-o:s-o;t.startAngle=-1*(Math.PI/2);t.endAngle=t.startAngle+a*l}return n?t:null};d.getSvgArc=function(){var n=this,r=n.d3.svg.arc().outerRadius(n.radius).innerRadius(n.innerRadius),e=function(e,t){var i;if(t){return r(e)}i=n.updateAngle(e);return i?r(i):"M 0 0"};e.centroid=r.centroid;return e};d.getSvgArcExpanded=function(e){var i=this,n=i.d3.svg.arc().outerRadius(i.radiusExpanded*(e?e:1)).innerRadius(i.innerRadius);return function(e){var t=i.updateAngle(e);return t?n(t):"M 0 0"}};d.getArc=function(e,t,i){return i||this.isArcType(e.data)?this.svgArc(e,t):"M 0 0"};d.transformForArcLabel=function(e){var t=this,i=t.updateAngle(e),n,r,o,s,a,l="";if(i&&!t.hasType("gauge")){n=this.svgArc.centroid(i);r=isNaN(n[0])?0:n[0];o=isNaN(n[1])?0:n[1];s=Math.sqrt(r*r+o*o);a=t.radius&&s?(36/t.radius>.375?1.175-36/t.radius:.8)*t.radius/s:0;l="translate("+r*a+","+o*a+")"}return l};d.getArcRatio=function(e){var t=this,i=t.hasType("gauge")?Math.PI:Math.PI*2;return e?(e.endAngle-e.startAngle)/i:null};d.convertToArcData=function(e){return this.addName({id:e.data.id,value:e.value,ratio:this.getArcRatio(e),index:e.index})};d.textForArcLabel=function(e){var t=this,i,n,r,o,s;if(!t.shouldShowArcLabel()){return""}i=t.updateAngle(e);n=i?i.value:null;r=t.getArcRatio(i);o=e.data.id;if(!t.hasType("gauge")&&!t.meetsArcLabelThreshold(r)){return""}s=t.getArcLabelFormat();return s?s(n,r,o):t.defaultArcValueFormat(n,r)};d.expandArc=function(e){var t=this,i;if(t.transiting){i=u.setInterval(function(){if(!t.transiting){u.clearInterval(i);if(t.legend.selectAll(".c3-legend-item-focused").size()>0){t.expandArc(e)}}},10);return}e=t.mapToTargetIds(e);t.svg.selectAll(t.selectorTargets(e,"."+$.chartArc)).each(function(e){if(!t.shouldExpand(e.data.id)){return}t.d3.select(this).selectAll("path").transition().duration(50).attr("d",t.svgArcExpanded).transition().duration(100).attr("d",t.svgArcExpandedSub).each(function(e){if(t.isDonutType(e.data)){}})})};d.unexpandArc=function(e){var t=this;if(t.transiting){return}e=t.mapToTargetIds(e);t.svg.selectAll(t.selectorTargets(e,"."+$.chartArc)).selectAll("path").transition().duration(50).attr("d",t.svgArc);t.svg.selectAll("."+$.arc).style("opacity",1)};d.shouldExpand=function(e){var t=this,i=t.config;return t.isDonutType(e)&&i.donut_expand||t.isGaugeType(e)&&i.gauge_expand||t.isPieType(e)&&i.pie_expand};d.shouldShowArcLabel=function(){var e=this,t=e.config,i=true;if(e.hasType("donut")){i=t.donut_label_show}else if(e.hasType("pie")){i=t.pie_label_show}return i};d.meetsArcLabelThreshold=function(e){var t=this,i=t.config,n=t.hasType("donut")?i.donut_label_threshold:i.pie_label_threshold;return e>=n};d.getArcLabelFormat=function(){var e=this,t=e.config,i=t.pie_label_format;if(e.hasType("gauge")){i=t.gauge_label_format}else if(e.hasType("donut")){i=t.donut_label_format}return i};d.getArcTitle=function(){var e=this;return e.hasType("donut")?e.config.donut_title:""};d.updateTargetsForArc=function(e){var t=this,i=t.main,n,r,o=t.classChartArc.bind(t),s=t.classArcs.bind(t),a=t.classFocus.bind(t);n=i.select("."+$.chartArcs).selectAll("."+$.chartArc).data(t.pie(e)).attr("class",function(e){return o(e)+a(e.data)});r=n.enter().append("g").attr("class",o);r.append("g").attr("class",s);r.append("text").attr("dy",t.hasType("gauge")?"-.1em":".35em").style("opacity",0).style("text-anchor","middle").style("pointer-events","none")};d.initArc=function(){var e=this;e.arcs=e.main.select("."+$.chart).append("g").attr("class",$.chartArcs).attr("transform",e.getTranslate("arc"));e.arcs.append("text").attr("class",$.chartArcsTitle).style("text-anchor","middle").text(e.getArcTitle())};d.redrawArc=function(e,t,i){var r=this,o=r.d3,n=r.config,s=r.main,a;a=s.selectAll("."+$.arcs).selectAll("."+$.arc).data(r.arcData.bind(r));a.enter().append("path").attr("class",r.classArc.bind(r)).style("fill",function(e){return r.color(e.data)}).style("cursor",function(e){return n.interaction_enabled&&n.data_selection_isselectable(e)?"pointer":null}).style("opacity",0).each(function(e){if(r.isGaugeType(e.data)){e.startAngle=e.endAngle=-1*(Math.PI/2)}this._current=e});a.attr("transform",function(e){return!r.isGaugeType(e.data)&&i?"scale(0)":""}).style("opacity",function(e){return e===this._current?0:1}).on("mouseover",n.interaction_enabled?function(e){var t,i;if(r.transiting){return}t=r.updateAngle(e);i=r.convertToArcData(t);r.expandArc(t.data.id);r.api.focus(t.data.id);r.toggleFocusLegend(t.data.id,true);r.config.data_onmouseover(i,this)}:null).on("mousemove",n.interaction_enabled?function(e){var t=r.updateAngle(e),i=r.convertToArcData(t),n=[i];r.showTooltip(n,this)}:null).on("mouseout",n.interaction_enabled?function(e){var t,i;if(r.transiting){return}t=r.updateAngle(e);i=r.convertToArcData(t);r.unexpandArc(t.data.id);r.api.revert();r.revertLegend();r.hideTooltip();r.config.data_onmouseout(i,this)}:null).on("click",n.interaction_enabled?function(e,t){var i=r.updateAngle(e),n=r.convertToArcData(i);if(r.toggleShape){r.toggleShape(this,n,t)}r.config.data_onclick.call(r.api,n,this)}:null).each(function(){r.transiting=true}).transition().duration(e).attrTween("d",function(i){var e=r.updateAngle(i),n;if(!e){return function(){return"M 0 0"}}if(isNaN(this._current.startAngle)){this._current.startAngle=0}if(isNaN(this._current.endAngle)){this._current.endAngle=this._current.startAngle}n=o.interpolate(this._current,e);this._current=n(0);return function(e){var t=n(e);t.data=i.data;return r.getArc(t,true)}}).attr("transform",i?"scale(1)":"").style("fill",function(e){return r.levelColor?r.levelColor(e.data.values[0].value):r.color(e.data.id)}).style("opacity",1).call(r.endall,function(){r.transiting=false});a.exit().transition().duration(t).style("opacity",0).remove();s.selectAll("."+$.chartArc).select("text").style("opacity",0).attr("class",function(e){return r.isGaugeType(e.data)?$.gaugeValue:""}).text(r.textForArcLabel.bind(r)).attr("transform",r.transformForArcLabel.bind(r)).style("font-size",function(e){return r.isGaugeType(e.data)?Math.round(r.radius/5)+"px":""}).transition().duration(e).style("opacity",function(e){return r.isTargetToShow(e.data.id)&&r.isArcType(e.data)?1:0});s.select("."+$.chartArcsTitle).style("opacity",r.hasType("donut")||r.hasType("gauge")?1:0);if(r.hasType("gauge")){r.arcs.select("."+$.chartArcsBackground).attr("d",function(){var e={data:[{value:n.gauge_max}],startAngle:-1*(Math.PI/2),endAngle:Math.PI/2};return r.getArc(e,true,true)});r.arcs.select("."+$.chartArcsGaugeUnit).attr("dy",".75em").text(n.gauge_label_show?n.gauge_units:"");r.arcs.select("."+$.chartArcsGaugeMin).attr("dx",-1*(r.innerRadius+(r.radius-r.innerRadius)/2)+"px").attr("dy","1.2em").text(n.gauge_label_show?n.gauge_min:"");r.arcs.select("."+$.chartArcsGaugeMax).attr("dx",r.innerRadius+(r.radius-r.innerRadius)/2+"px").attr("dy","1.2em").text(n.gauge_label_show?n.gauge_max:"")}};d.initGauge=function(){var e=this.arcs;if(this.hasType("gauge")){e.append("path").attr("class",$.chartArcsBackground);e.append("text").attr("class",$.chartArcsGaugeUnit).style("text-anchor","middle").style("pointer-events","none");e.append("text").attr("class",$.chartArcsGaugeMin).style("text-anchor","middle").style("pointer-events","none");e.append("text").attr("class",$.chartArcsGaugeMax).style("text-anchor","middle").style("pointer-events","none")}};d.getGaugeLabelHeight=function(){return this.config.gauge_label_show?20:0};d.initRegion=function(){var e=this;e.region=e.main.append("g").attr("clip-path",e.clipPath).attr("class",$.regions)};d.updateRegion=function(e){var t=this,i=t.config;t.region.style("visibility",t.hasArcType()?"hidden":"visible");t.mainRegion=t.main.select("."+$.regions).selectAll("."+$.region).data(i.regions);t.mainRegion.enter().append("g").attr("class",t.classRegion.bind(t)).append("rect").style("fill-opacity",0);t.mainRegion.exit().transition().duration(e).style("opacity",0).remove()};d.redrawRegion=function(e){var t=this,i=t.mainRegion.selectAll("rect"),n=t.regionX.bind(t),r=t.regionY.bind(t),o=t.regionWidth.bind(t),s=t.regionHeight.bind(t);return[(e?i.transition():i).attr("x",n).attr("y",r).attr("width",o).attr("height",s).style("fill-opacity",function(e){return T(e.opacity)?e.opacity:.1})]};d.regionX=function(e){var t=this,i=t.config,n,r=e.axis==="y"?t.y:t.y2;if(e.axis==="y"||e.axis==="y2"){n=i.axis_rotated?"start"in e?r(e.start):0:0}else{n=i.axis_rotated?0:"start"in e?t.x(t.isTimeSeries()?t.parseDate(e.start):e.start):0}return n};d.regionY=function(e){var t=this,i=t.config,n,r=e.axis==="y"?t.y:t.y2;if(e.axis==="y"||e.axis==="y2"){n=i.axis_rotated?0:"end"in e?r(e.end):0}else{n=i.axis_rotated?"start"in e?t.x(t.isTimeSeries()?t.parseDate(e.start):e.start):0:0}return n};d.regionWidth=function(e){var t=this,i=t.config,n=t.regionX(e),r,o=e.axis==="y"?t.y:t.y2;if(e.axis==="y"||e.axis==="y2"){r=i.axis_rotated?"end"in e?o(e.end):t.width:t.width}else{r=i.axis_rotated?t.width:"end"in e?t.x(t.isTimeSeries()?t.parseDate(e.end):e.end):t.width}return r<n?0:r-n};d.regionHeight=function(e){var t=this,i=t.config,n=this.regionY(e),r,o=e.axis==="y"?t.y:t.y2;if(e.axis==="y"||e.axis==="y2"){r=i.axis_rotated?t.height:"start"in e?o(e.start):t.height}else{r=i.axis_rotated?"end"in e?t.x(t.isTimeSeries()?t.parseDate(e.end):e.end):t.height:t.height}return r<n?0:r-n};d.isRegionOnX=function(e){return!e.axis||e.axis==="x"};d.drag=function(e){var h=this,t=h.config,i=h.main,f=h.d3;var n,r,o,s,p,g,m,v;if(h.hasArcType()){return}if(!t.data_selection_enabled){return}if(t.zoom_enabled&&!h.zoom.altDomain){return}if(!t.data_selection_multiple){return}n=h.dragStart[0];r=h.dragStart[1];o=e[0];s=e[1];p=Math.min(n,o);g=Math.max(n,o);m=t.data_selection_grouped?h.margin.top:Math.min(r,s);v=t.data_selection_grouped?h.height:Math.max(r,s);i.select("."+$.dragarea).attr("x",p).attr("y",m).attr("width",g-p).attr("height",v-m);i.selectAll("."+$.shapes).selectAll("."+$.shape).filter(function(e){return t.data_selection_isselectable(e)}).each(function(e,t){var i=f.select(this),n=i.classed($.SELECTED),r=i.classed($.INCLUDED),o,s,a,l,c,u=false,d;if(i.classed($.circle)){o=i.attr("cx")*1;s=i.attr("cy")*1;c=h.togglePoint;u=p<o&&o<g&&m<s&&s<v}else if(i.classed($.bar)){d=y(this);o=d.x;s=d.y;a=d.width;l=d.height;c=h.togglePath;u=!(g<o||o+a<p)&&!(v<s||s+l<m)}else{return}if(u^r){i.classed($.INCLUDED,!r);i.classed($.SELECTED,!n);c.call(h,!n,i,e,t)}})};d.dragstart=function(e){var t=this,i=t.config;if(t.hasArcType()){return}if(!i.data_selection_enabled){return}t.dragStart=e;t.main.select("."+$.chart).append("rect").attr("class",$.dragarea).style("opacity",.1);t.dragging=true};d.dragend=function(){var e=this,t=e.config;if(e.hasArcType()){return}if(!t.data_selection_enabled){return}e.main.select("."+$.dragarea).transition().duration(100).style("opacity",0).remove();e.main.selectAll("."+$.shape).classed($.INCLUDED,false);e.dragging=false};d.selectPoint=function(e,t,i){var n=this,r=n.config,o=(r.axis_rotated?n.circleY:n.circleX).bind(n),s=(r.axis_rotated?n.circleX:n.circleY).bind(n),a=n.pointSelectR.bind(n);r.data_onselected.call(n.api,t,e.node());n.main.select("."+$.selectedCircles+n.getTargetSelectorSuffix(t.id)).selectAll("."+$.selectedCircle+"-"+i).data([t]).enter().append("circle").attr("class",function(){return n.generateClass($.selectedCircle,i)}).attr("cx",o).attr("cy",s).attr("stroke",function(){return n.color(t)}).attr("r",function(e){return n.pointSelectR(e)*1.4}).transition().duration(100).attr("r",a)};d.unselectPoint=function(e,t,i){var n=this;n.config.data_onunselected(t,e.node());n.main.select("."+$.selectedCircles+n.getTargetSelectorSuffix(t.id)).selectAll("."+$.selectedCircle+"-"+i).transition().duration(100).attr("r",0).remove()};d.togglePoint=function(e,t,i,n){e?this.selectPoint(t,i,n):this.unselectPoint(t,i,n)};d.selectPath=function(e,t){var i=this;i.config.data_onselected.call(i,t,e.node());e.transition().duration(100).style("fill",function(){return i.d3.rgb(i.color(t)).brighter(.75)})};d.unselectPath=function(e,t){var i=this;i.config.data_onunselected.call(i,t,e.node());e.transition().duration(100).style("fill",function(){return i.color(t)})};d.togglePath=function(e,t,i,n){e?this.selectPath(t,i,n):this.unselectPath(t,i,n)};d.getToggle=function(e,t){var i=this,n;if(e.nodeName==="circle"){if(i.isStepType(t)){n=function(){}}else{n=i.togglePoint}}else if(e.nodeName==="path"){n=i.togglePath}return n};d.toggleShape=function(e,t,i){var n=this,r=n.d3,o=n.config,s=r.select(e),a=s.classed($.SELECTED),l=n.getToggle(e,t).bind(n);if(o.data_selection_enabled&&o.data_selection_isselectable(t)){if(!o.data_selection_multiple){n.main.selectAll("."+$.shapes+(o.data_selection_grouped?n.getTargetSelectorSuffix(t.id):"")).selectAll("."+$.shape).each(function(e,t){var i=r.select(this);if(i.classed($.SELECTED)){l(false,i.classed($.SELECTED,false),e,t)}})}s.classed($.SELECTED,!a);l(!a,s,t,i)}};d.initBrush=function(){var t=this,e=t.d3;t.brush=e.svg.brush().on("brush",function(){t.redrawForBrush()});t.brush.update=function(){if(t.context){t.context.select("."+$.brush).call(this)}return this};t.brush.scale=function(e){return t.config.axis_rotated?this.y(e):this.x(e)}};d.initSubchart=function(){var e=this,t=e.config,i=e.context=e.svg.append("g").attr("transform",e.getTranslate("context"));i.style("visibility",t.subchart_show?"visible":"hidden");i.append("g").attr("clip-path",e.clipPathForSubchart).attr("class",$.chart);i.select("."+$.chart).append("g").attr("class",$.chartBars);i.select("."+$.chart).append("g").attr("class",$.chartLines);i.append("g").attr("clip-path",e.clipPath).attr("class",$.brush).call(e.brush);e.axes.subx=i.append("g").attr("class",$.axisX).attr("transform",e.getTranslate("subx")).attr("clip-path",t.axis_rotated?"":e.clipPathForXAxis)};d.updateTargetsForSubchart=function(e){var t=this,i=t.context,n=t.config,r,o,s,a,l=t.classChartBar.bind(t),c=t.classBars.bind(t),u=t.classChartLine.bind(t),d=t.classLines.bind(t),h=t.classAreas.bind(t);if(n.subchart_show){a=i.select("."+$.chartBars).selectAll("."+$.chartBar).data(e).attr("class",l);s=a.enter().append("g").style("opacity",0).attr("class",l);s.append("g").attr("class",c);o=i.select("."+$.chartLines).selectAll("."+$.chartLine).data(e).attr("class",u);r=o.enter().append("g").style("opacity",0).attr("class",u);r.append("g").attr("class",d);r.append("g").attr("class",h);i.selectAll("."+$.brush+" rect").attr(n.axis_rotated?"width":"height",n.axis_rotated?t.width2:t.height2)}};d.updateBarForSubchart=function(e){var t=this;t.contextBar=t.context.selectAll("."+$.bars).selectAll("."+$.bar).data(t.barData.bind(t));t.contextBar.enter().append("path").attr("class",t.classBar.bind(t)).style("stroke","none").style("fill",t.color);t.contextBar.style("opacity",t.initialOpacity.bind(t));t.contextBar.exit().transition().duration(e).style("opacity",0).remove()};d.redrawBarForSubchart=function(e,t,i){(t?this.contextBar.transition().duration(i):this.contextBar).attr("d",e).style("opacity",1)};d.updateLineForSubchart=function(e){var t=this;t.contextLine=t.context.selectAll("."+$.lines).selectAll("."+$.line).data(t.lineData.bind(t));t.contextLine.enter().append("path").attr("class",t.classLine.bind(t)).style("stroke",t.color);t.contextLine.style("opacity",t.initialOpacity.bind(t));t.contextLine.exit().transition().duration(e).style("opacity",0).remove()};d.redrawLineForSubchart=function(e,t,i){(t?this.contextLine.transition().duration(i):this.contextLine).attr("d",e).style("opacity",1)};d.updateAreaForSubchart=function(e){var t=this,i=t.d3;t.contextArea=t.context.selectAll("."+$.areas).selectAll("."+$.area).data(t.lineData.bind(t));t.contextArea.enter().append("path").attr("class",t.classArea.bind(t)).style("fill",t.color).style("opacity",function(){t.orgAreaOpacity=+i.select(this).style("opacity");return 0});t.contextArea.style("opacity",0);t.contextArea.exit().transition().duration(e).style("opacity",0).remove()};d.redrawAreaForSubchart=function(e,t,i){(t?this.contextArea.transition().duration(i):this.contextArea).attr("d",e).style("fill",this.color).style("opacity",this.orgAreaOpacity)};d.redrawSubchart=function(e,t,i,n,r,o,s){var a=this,l=a.d3,c=a.config,u,d,h;a.context.style("visibility",c.subchart_show?"visible":"hidden");if(c.subchart_show){if(l.event&&l.event.type==="zoom"){a.brush.extent(a.x.orgDomain()).update()}if(e){if(!a.brush.empty()){a.brush.extent(a.x.orgDomain()).update()}u=a.generateDrawArea(r,true);d=a.generateDrawBar(o,true);h=a.generateDrawLine(s,true);a.updateBarForSubchart(i);a.updateLineForSubchart(i);a.updateAreaForSubchart(i);a.redrawBarForSubchart(d,i,i);a.redrawLineForSubchart(h,i,i);a.redrawAreaForSubchart(u,i,i)}}};d.redrawForBrush=function(){var e=this,t=e.x;e.redraw({withTransition:false,withY:e.config.zoom_rescale,withSubchart:false,withUpdateXDomain:true,withDimension:false});e.config.subchart_onbrush.call(e.api,t.orgDomain())};d.transformContext=function(e,t){var i=this,n;if(t&&t.axisSubX){n=t.axisSubX}else{n=i.context.select("."+$.axisX);if(e){n=n.transition()}}i.context.attr("transform",i.getTranslate("context"));n.attr("transform",i.getTranslate("subx"))};d.getDefaultExtent=function(){var e=this,t=e.config,i=h(t.axis_x_extent)?t.axis_x_extent(e.getXDomain(e.data.targets)):t.axis_x_extent;if(e.isTimeSeries()){i=[e.parseDate(i[0]),e.parseDate(i[1])]}return i};d.initZoom=function(){var i=this,t=i.d3,n=i.config,r;i.zoom=t.behavior.zoom().on("zoomstart",function(){r=t.event.sourceEvent;i.zoom.altDomain=t.event.sourceEvent.altKey?i.x.orgDomain():null;n.zoom_onzoomstart.call(i.api,t.event.sourceEvent)}).on("zoom",function(){i.redrawForZoom.call(i)}).on("zoomend",function(){var e=t.event.sourceEvent;if(e&&r.clientX===e.clientX&&r.clientY===e.clientY){return}i.redrawEventRect();i.updateZoom();n.zoom_onzoomend.call(i.api,i.x.orgDomain())});i.zoom.scale=function(e){return n.axis_rotated?this.y(e):this.x(e)};i.zoom.orgScaleExtent=function(){var e=n.zoom_extent?n.zoom_extent:[1,10];return[e[0],Math.max(i.getMaxDataCount()/e[1],e[1])]};i.zoom.updateScaleExtent=function(){var e=L(i.x.orgDomain())/L(i.orgXDomain),t=this.orgScaleExtent();this.scaleExtent([t[0]*e,t[1]*e]);return this}};d.updateZoom=function(){var e=this,t=e.config.zoom_enabled?e.zoom:function(){};e.main.select("."+$.zoomRect).call(t).on("dblclick.zoom",null);e.main.selectAll("."+$.eventRect).call(t).on("dblclick.zoom",null)};d.redrawForZoom=function(){var e=this,t=e.d3,i=e.config,n=e.zoom,r=e.x;if(!i.zoom_enabled){return}if(e.filterTargetsToShow(e.data.targets).length===0){return}if(t.event.sourceEvent.type==="mousemove"&&n.altDomain){r.domain(n.altDomain);n.scale(r).updateScaleExtent();return}if(e.isCategorized()&&r.orgDomain()[0]===e.orgXDomain[0]){r.domain([e.orgXDomain[0]-1e-10,r.orgDomain()[1]])}e.redraw({withTransition:false,withY:i.zoom_rescale,withSubchart:false,withEventRect:false,withDimension:false});if(t.event.sourceEvent.type==="mousemove"){e.cancelClick=true}i.zoom_onzoom.call(e.api,r.orgDomain())};d.generateColor=function(){var e=this,t=e.config,i=e.d3,n=t.data_colors,r=D(t.color_pattern)?t.color_pattern:i.scale.category10().range(),o=t.data_color,s=[];return function(e){var t=e.id||e.data&&e.data.id||e,i;if(n[t]instanceof Function){i=n[t](e)}else if(n[t]){i=n[t]}else{if(s.indexOf(t)<0){s.push(t)}i=r[s.indexOf(t)%r.length];n[t]=i}return o instanceof Function?o(i,e):i}};d.generateLevelColor=function(){var e=this,t=e.config,r=t.color_pattern,i=t.color_threshold,o=i.unit==="value",s=i.values&&i.values.length?i.values:[],a=i.max||100;return D(t.color_threshold)?function(e){var t,i,n=r[r.length-1];for(t=0;t<s.length;t++){i=o?e:e*100/a;if(i<s[t]){n=r[t];break}}return n}:null};d.getYFormat=function(e){var r=this,o=e&&!r.hasType("gauge")?r.defaultArcValueFormat:r.yFormat,s=e&&!r.hasType("gauge")?r.defaultArcValueFormat:r.y2Format;return function(e,t,i){var n=r.axis.getId(i)==="y2"?s:o;return n.call(r,e,t)}};d.yFormat=function(e){var t=this,i=t.config,n=i.axis_y_tick_format?i.axis_y_tick_format:t.defaultValueFormat;return n(e)};d.y2Format=function(e){var t=this,i=t.config,n=i.axis_y2_tick_format?i.axis_y2_tick_format:t.defaultValueFormat;return n(e)};d.defaultValueFormat=function(e){return T(e)?+e:""};d.defaultArcValueFormat=function(e,t){return(t*100).toFixed(1)+"%"};d.dataLabelFormat=function(e){var t=this,i=t.config.data_labels,n,r=function(e){return T(e)?+e:""};if(typeof i.format==="function"){n=i.format}else if(typeof i.format==="object"){if(i.format[e]){n=i.format[e]===true?r:i.format[e]}else{n=function(){return""}}}else{n=r}return n};d.hasCaches=function(e){for(var t=0;t<e.length;t++){if(!(e[t]in this.cache)){return false}}return true};d.addCache=function(e,t){this.cache[e]=this.cloneTarget(t)};d.getCaches=function(e){var t=[],i;for(i=0;i<e.length;i++){if(e[i]in this.cache){t.push(this.cloneTarget(this.cache[e[i]]))}}return t};var $=d.CLASS={target:"c3-target",chart:"c3-chart",chartLine:"c3-chart-line",chartLines:"c3-chart-lines",chartBar:"c3-chart-bar",chartBars:"c3-chart-bars",chartText:"c3-chart-text",chartTexts:"c3-chart-texts",chartArc:"c3-chart-arc",chartArcs:"c3-chart-arcs",chartArcsTitle:"c3-chart-arcs-title",chartArcsBackground:"c3-chart-arcs-background",chartArcsGaugeUnit:"c3-chart-arcs-gauge-unit",chartArcsGaugeMax:"c3-chart-arcs-gauge-max",chartArcsGaugeMin:"c3-chart-arcs-gauge-min",selectedCircle:"c3-selected-circle",selectedCircles:"c3-selected-circles",eventRect:"c3-event-rect",eventRects:"c3-event-rects",eventRectsSingle:"c3-event-rects-single",eventRectsMultiple:"c3-event-rects-multiple",zoomRect:"c3-zoom-rect",brush:"c3-brush",focused:"c3-focused",defocused:"c3-defocused",region:"c3-region",regions:"c3-regions",tooltipContainer:"c3-tooltip-container",tooltip:"c3-tooltip",tooltipName:"c3-tooltip-name",shape:"c3-shape",shapes:"c3-shapes",line:"c3-line",lines:"c3-lines",bar:"c3-bar",bars:"c3-bars",circle:"c3-circle",circles:"c3-circles",arc:"c3-arc",arcs:"c3-arcs",area:"c3-area",areas:"c3-areas",empty:"c3-empty",text:"c3-text",texts:"c3-texts",gaugeValue:"c3-gauge-value",grid:"c3-grid",gridLines:"c3-grid-lines",xgrid:"c3-xgrid",xgrids:"c3-xgrids",xgridLine:"c3-xgrid-line",xgridLines:"c3-xgrid-lines",xgridFocus:"c3-xgrid-focus",ygrid:"c3-ygrid",ygrids:"c3-ygrids",ygridLine:"c3-ygrid-line",ygridLines:"c3-ygrid-lines",axis:"c3-axis",axisX:"c3-axis-x",axisXLabel:"c3-axis-x-label",axisY:"c3-axis-y",axisYLabel:"c3-axis-y-label",axisY2:"c3-axis-y2",axisY2Label:"c3-axis-y2-label",legendBackground:"c3-legend-background",legendItem:"c3-legend-item",legendItemEvent:"c3-legend-item-event",legendItemTile:"c3-legend-item-tile",legendItemHidden:"c3-legend-item-hidden",legendItemFocused:"c3-legend-item-focused",dragarea:"c3-dragarea",EXPANDED:"_expanded_",SELECTED:"_selected_",INCLUDED:"_included_"};d.generateClass=function(e,t){return" "+e+" "+e+this.getTargetSelectorSuffix(t)};d.classText=function(e){return this.generateClass($.text,e.index)};d.classTexts=function(e){return this.generateClass($.texts,e.id)};d.classShape=function(e){return this.generateClass($.shape,e.index)};d.classShapes=function(e){return this.generateClass($.shapes,e.id)};d.classLine=function(e){return this.classShape(e)+this.generateClass($.line,e.id)};d.classLines=function(e){return this.classShapes(e)+this.generateClass($.lines,e.id)};d.classCircle=function(e){return this.classShape(e)+this.generateClass($.circle,e.index)};d.classCircles=function(e){return this.classShapes(e)+this.generateClass($.circles,e.id)};d.classBar=function(e){return this.classShape(e)+this.generateClass($.bar,e.index)};d.classBars=function(e){return this.classShapes(e)+this.generateClass($.bars,e.id)};d.classArc=function(e){return this.classShape(e.data)+this.generateClass($.arc,e.data.id)};d.classArcs=function(e){return this.classShapes(e.data)+this.generateClass($.arcs,e.data.id)};d.classArea=function(e){return this.classShape(e)+this.generateClass($.area,e.id)};d.classAreas=function(e){return this.classShapes(e)+this.generateClass($.areas,e.id)};d.classRegion=function(e,t){return this.generateClass($.region,t)+" "+("class"in e?e["class"]:"")};d.classEvent=function(e){return this.generateClass($.eventRect,e.index)};d.classTarget=function(e){var t=this;var i=t.config.data_classes[e],n="";if(i){n=" "+$.target+"-"+i}return t.generateClass($.target,e)+n};d.classFocus=function(e){return this.classFocused(e)+this.classDefocused(e)};d.classFocused=function(e){return" "+(this.focusedTargetIds.indexOf(e.id)>=0?$.focused:"")};d.classDefocused=function(e){return" "+(this.defocusedTargetIds.indexOf(e.id)>=0?$.defocused:"")};d.classChartText=function(e){return $.chartText+this.classTarget(e.id)};d.classChartLine=function(e){return $.chartLine+this.classTarget(e.id)};d.classChartBar=function(e){return $.chartBar+this.classTarget(e.id)};d.classChartArc=function(e){return $.chartArc+this.classTarget(e.data.id)};d.getTargetSelectorSuffix=function(e){return e||e===0?("-"+e).replace(/[\s?!@#$%^&*()_=+,.<>'":;\[\]\/|~`{}\\]/g,"-"):""};d.selectorTarget=function(e,t){return(t||"")+"."+$.target+this.getTargetSelectorSuffix(e)};d.selectorTargets=function(e,t){var i=this;e=e||[];return e.length?e.map(function(e){return i.selectorTarget(e,t)}):null};d.selectorLegend=function(e){return"."+$.legendItem+this.getTargetSelectorSuffix(e)};d.selectorLegends=function(e){var t=this;return e&&e.length?e.map(function(e){return t.selectorLegend(e)}):null};var T=d.isValue=function(e){return e||e===0},h=d.isFunction=function(e){return typeof e==="function"},l=d.isString=function(e){return typeof e==="string"},S=d.isUndefined=function(e){return typeof e==="undefined"},N=d.isDefined=function(e){return typeof e!=="undefined"},c=d.ceil10=function(e){return Math.ceil(e/10)*10},f=d.asHalfPixel=function(e){return Math.ceil(e)+.5},L=d.diffDomain=function(e){return e[1]-e[0]},p=d.isEmpty=function(e){return!e||l(e)&&e.length===0||typeof e==="object"&&Object.keys(e).length===0},D=d.notEmpty=function(e){return Object.keys(e).length>0},H=d.getOption=function(e,t,i){return N(e[t])?e[t]:i},g=d.hasValue=function(t,i){var n=false;Object.keys(t).forEach(function(e){if(t[e]===i){n=true}});return n},y=d.getPathBox=function(e){var t=e.getBoundingClientRect(),i=[e.pathSegList.getItem(0),e.pathSegList.getItem(1)],n=i[0].x,r=Math.min(i[0].y,i[1].y);return{x:n,y:r,width:t.width,height:t.height}};i.focus=function(t){var e=this.internal,i;t=e.mapToTargetIds(t);i=e.svg.selectAll(e.selectorTargets(t.filter(e.isTargetToShow,e))),this.revert();this.defocus();i.classed($.focused,true).classed($.defocused,false);if(e.hasArcType()){e.expandArc(t)}e.toggleFocusLegend(t,true);e.focusedTargetIds=t;e.defocusedTargetIds=e.defocusedTargetIds.filter(function(e){return t.indexOf(e)<0})};i.defocus=function(t){var e=this.internal,i;t=e.mapToTargetIds(t);i=e.svg.selectAll(e.selectorTargets(t.filter(e.isTargetToShow,e))),i.classed($.focused,false).classed($.defocused,true);if(e.hasArcType()){e.unexpandArc(t)}e.toggleFocusLegend(t,false);e.focusedTargetIds=e.focusedTargetIds.filter(function(e){return t.indexOf(e)<0});e.defocusedTargetIds=t};i.revert=function(e){var t=this.internal,i;e=t.mapToTargetIds(e);i=t.svg.selectAll(t.selectorTargets(e));i.classed($.focused,false).classed($.defocused,false);if(t.hasArcType()){t.unexpandArc(e)}if(t.config.legend_show){t.showLegend(e.filter(t.isLegendToShow.bind(t)));t.legend.selectAll(t.selectorLegends(e)).filter(function(){return t.d3.select(this).classed($.legendItemFocused)}).classed($.legendItemFocused,false)}t.focusedTargetIds=[];t.defocusedTargetIds=[]};i.show=function(e,t){var i=this.internal,n;e=i.mapToTargetIds(e);t=t||{};i.removeHiddenTargetIds(e);n=i.svg.selectAll(i.selectorTargets(e));n.transition().style("opacity",1,"important").call(i.endall,function(){n.style("opacity",null).style("opacity",1)});if(t.withLegend){i.showLegend(e)}i.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true,withLegend:true})};i.hide=function(e,t){var i=this.internal,n;e=i.mapToTargetIds(e);t=t||{};i.addHiddenTargetIds(e);n=i.svg.selectAll(i.selectorTargets(e));n.transition().style("opacity",0,"important").call(i.endall,function(){n.style("opacity",null).style("opacity",0)});if(t.withLegend){i.hideLegend(e)}i.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true,withLegend:true})};i.toggle=function(e,t){var i=this,n=this.internal;n.mapToTargetIds(e).forEach(function(e){n.isTargetToShow(e)?i.hide(e,t):i.show(e,t)})};i.zoom=function(e){var t=this.internal;if(e){if(t.isTimeSeries()){e=e.map(function(e){return t.parseDate(e)})}t.brush.extent(e);t.redraw({withUpdateXDomain:true,withY:t.config.zoom_rescale});t.config.zoom_onzoom.call(this,t.x.orgDomain())}return t.brush.extent()};i.zoom.enable=function(e){var t=this.internal;t.config.zoom_enabled=e;t.updateAndRedraw()};i.unzoom=function(){var e=this.internal;e.brush.clear().update();e.redraw({withUpdateXDomain:true})};i.load=function(t){var e=this.internal,i=e.config;if(t.xs){e.addXs(t.xs)}if("classes"in t){Object.keys(t.classes).forEach(function(e){i.data_classes[e]=t.classes[e]})}if("categories"in t&&e.isCategorized()){i.axis_x_categories=t.categories}if("axes"in t){Object.keys(t.axes).forEach(function(e){i.data_axes[e]=t.axes[e]})}if("colors"in t){Object.keys(t.colors).forEach(function(e){i.data_colors[e]=t.colors[e]})}if("cacheIds"in t&&e.hasCaches(t.cacheIds)){e.load(e.getCaches(t.cacheIds),t.done);return}if("unload"in t){e.unload(e.mapToTargetIds(typeof t.unload==="boolean"&&t.unload?null:t.unload),function(){e.loadFromArgs(t)})}else{e.loadFromArgs(t)}};i.unload=function(e){var t=this.internal;e=e||{};if(e instanceof Array){e={ids:e}}else if(typeof e==="string"){e={ids:[e]}}t.unload(t.mapToTargetIds(e.ids),function(){t.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true,withLegend:true});if(e.done){e.done()}})};i.flow=function(e){var r=this.internal,o,t,s=[],i=r.getMaxDataCount(),n,a,l,c,u=0,d=0,h,f;if(e.json){t=r.convertJsonToData(e.json,e.keys)}else if(e.rows){t=r.convertRowsToData(e.rows)}else if(e.columns){t=r.convertColumnsToData(e.columns)}else{return}o=r.convertDataToTargets(t,true);r.data.targets.forEach(function(e){var t=false,i,n;for(i=0;i<o.length;i++){if(e.id===o[i].id){t=true;if(e.values[e.values.length-1]){d=e.values[e.values.length-1].index+1}u=o[i].values.length;for(n=0;n<u;n++){o[i].values[n].index=d+n;if(!r.isTimeSeries()){o[i].values[n].x=d+n}}e.values=e.values.concat(o[i].values);o.splice(i,1);break}}if(!t){s.push(e.id)}});r.data.targets.forEach(function(e){var t,i;for(t=0;t<s.length;t++){if(e.id===s[t]){d=e.values[e.values.length-1].index+1;for(i=0;i<u;i++){e.values.push({id:e.id,index:d+i,x:r.isTimeSeries()?r.getOtherTargetX(d+i):d+i,value:null})}}}});if(r.data.targets.length){o.forEach(function(e){var t,i=[];for(t=r.data.targets[0].values[0].index;t<d;t++){i.push({id:e.id,index:t,x:r.isTimeSeries()?r.getOtherTargetX(t):t,value:null})}e.values.forEach(function(e){e.index+=d;if(!r.isTimeSeries()){e.x+=d}});e.values=i.concat(e.values)})}r.data.targets=r.data.targets.concat(o);n=r.getMaxDataCount();l=r.data.targets[0];c=l.values[0];if(N(e.to)){u=0;f=r.isTimeSeries()?r.parseDate(e.to):e.to;l.values.forEach(function(e){if(e.x<f){u++}})}else if(N(e.length)){u=e.length}if(!i){if(r.isTimeSeries()){if(l.values.length>1){h=l.values[l.values.length-1].x-c.x}else{h=c.x-r.getXDomain(r.data.targets)[0]}}else{h=1}a=[c.x-h,c.x];r.updateXDomain(null,true,true,false,a)}else if(i===1){if(r.isTimeSeries()){h=(l.values[l.values.length-1].x-c.x)/2;a=[new Date(+c.x-h),new Date(+c.x+h)];r.updateXDomain(null,true,true,false,a)}}r.updateTargets(r.data.targets);r.redraw({flow:{index:c.index,length:u,duration:T(e.duration)?e.duration:r.config.transition_duration,done:e.done,orgDataCount:i},withLegend:true,withTransition:i>1,withTrimXDomain:false,withUpdateXAxis:true})};d.generateFlow=function(k){var O=this,N=O.config,I=O.d3;return function(){var e=k.targets,t=k.flow,r=k.drawBar,o=k.drawLine,s=k.drawArea,a=k.cx,l=k.cy,c=k.xv,u=k.xForText,d=k.yForText,i=k.duration;var n,h=1,f,p=t.index,g=t.length,m=O.getValueOnIndex(O.data.targets[0].values,p),v=O.getValueOnIndex(O.data.targets[0].values,p+g),y=O.x.domain(),b,_=t.duration||i,w=t.done||function(){},C=O.generateWait();var x=O.xgrid||I.selectAll([]),S=O.xgridLines||I.selectAll([]),A=O.mainRegion||I.selectAll([]),E=O.mainText||I.selectAll([]),T=O.mainBar||I.selectAll([]),D=O.mainLine||I.selectAll([]),R=O.mainArea||I.selectAll([]),M=O.mainCircle||I.selectAll([]);O.flowing=true;O.data.targets.forEach(function(e){e.values.splice(0,g)});b=O.updateXDomain(e,true,true);if(O.updateXGrid){O.updateXGrid(true)}if(!t.orgDataCount){if(O.data.targets[0].values.length!==1){n=O.x(y[0])-O.x(b[0])}else{if(O.isTimeSeries()){m=O.getValueOnIndex(O.data.targets[0].values,0);v=O.getValueOnIndex(O.data.targets[0].values,O.data.targets[0].values.length-1);n=O.x(m.x)-O.x(v.x)}else{n=L(b)/2}}}else if(t.orgDataCount===1||m.x===v.x){n=O.x(y[0])-O.x(b[0])}else{if(O.isTimeSeries()){n=O.x(y[0])-O.x(b[0])}else{n=O.x(m.x)-O.x(v.x)}}h=L(y)/L(b);f="translate("+n+",0) scale("+h+",1)";O.hideXGridFocus();O.hideTooltip();I.transition().ease("linear").duration(_).each(function(){C.add(O.axes.x.transition().call(O.xAxis));C.add(T.transition().attr("transform",f));C.add(D.transition().attr("transform",f));C.add(R.transition().attr("transform",f));C.add(M.transition().attr("transform",f));C.add(E.transition().attr("transform",f));C.add(A.filter(O.isRegionOnX).transition().attr("transform",f));C.add(x.transition().attr("transform",f));C.add(S.transition().attr("transform",f))}).call(C,function(){var e,t=[],i=[],n=[];if(g){for(e=0;e<g;e++){t.push("."+$.shape+"-"+(p+e));i.push("."+$.text+"-"+(p+e));n.push("."+$.eventRect+"-"+(p+e))}O.svg.selectAll("."+$.shapes).selectAll(t).remove();O.svg.selectAll("."+$.texts).selectAll(i).remove();O.svg.selectAll("."+$.eventRects).selectAll(n).remove();O.svg.select("."+$.xgrid).remove()}x.attr("transform",null).attr(O.xgridAttr);S.attr("transform",null);S.select("line").attr("x1",N.axis_rotated?0:c).attr("x2",N.axis_rotated?O.width:c);S.select("text").attr("x",N.axis_rotated?O.width:0).attr("y",c);T.attr("transform",null).attr("d",r);D.attr("transform",null).attr("d",o);R.attr("transform",null).attr("d",s);M.attr("transform",null).attr("cx",a).attr("cy",l);E.attr("transform",null).attr("x",u).attr("y",d).style("fill-opacity",O.opacityForText.bind(O));A.attr("transform",null);A.select("rect").filter(O.isRegionOnX).attr("x",O.regionX.bind(O)).attr("width",O.regionWidth.bind(O));if(N.interaction_enabled){O.redrawEventRect()}w();O.flowing=false})}};i.selected=function(e){var t=this.internal,i=t.d3;return i.merge(t.main.selectAll("."+$.shapes+t.getTargetSelectorSuffix(e)).selectAll("."+$.shape).filter(function(){return i.select(this).classed($.SELECTED)}).map(function(e){return e.map(function(e){var t=e.__data__;return t.data?t.data:t})}))};i.select=function(l,c,u){var d=this.internal,h=d.d3,f=d.config;if(!f.data_selection_enabled){return}d.main.selectAll("."+$.shapes).selectAll("."+$.shape).each(function(e,t){var i=h.select(this),n=e.data?e.data.id:e.id,r=d.getToggle(this,e).bind(d),o=f.data_selection_grouped||!l||l.indexOf(n)>=0,s=!c||c.indexOf(t)>=0,a=i.classed($.SELECTED);if(i.classed($.line)||i.classed($.area)){return}if(o&&s){if(f.data_selection_isselectable(e)&&!a){r(true,i.classed($.SELECTED,true),e,t)}}else if(N(u)&&u){if(a){r(false,i.classed($.SELECTED,false),e,t)}}})};i.unselect=function(l,c){var u=this.internal,d=u.d3,h=u.config;if(!h.data_selection_enabled){return}u.main.selectAll("."+$.shapes).selectAll("."+$.shape).each(function(e,t){var i=d.select(this),n=e.data?e.data.id:e.id,r=u.getToggle(this,e).bind(u),o=h.data_selection_grouped||!l||l.indexOf(n)>=0,s=!c||c.indexOf(t)>=0,a=i.classed($.SELECTED);if(i.classed($.line)||i.classed($.area)){return}if(o&&s){if(h.data_selection_isselectable(e)){if(a){r(false,i.classed($.SELECTED,false),e,t)}}}})};i.transform=function(e,t){var i=this.internal,n=["pie","donut"].indexOf(e)>=0?{withTransform:true}:null;i.transformTo(t,e,n)};d.transformTo=function(e,t,i){var n=this,r=!n.hasArcType(),o=i||{withTransitionForAxis:r};o.withTransitionForTransform=false;n.transiting=false;n.setTargetType(e,t);n.updateTargets(n.data.targets);n.updateAndRedraw(o)};i.groups=function(e){var t=this.internal,i=t.config;if(S(e)){return i.data_groups}i.data_groups=e;t.redraw();return i.data_groups};i.xgrids=function(e){var t=this.internal,i=t.config;if(!e){return i.grid_x_lines}i.grid_x_lines=e;t.redrawWithoutRescale();return i.grid_x_lines};i.xgrids.add=function(e){var t=this.internal;return this.xgrids(t.config.grid_x_lines.concat(e?e:[]))};i.xgrids.remove=function(e){var t=this.internal;t.removeGridLines(e,true)};i.ygrids=function(e){var t=this.internal,i=t.config;if(!e){return i.grid_y_lines}i.grid_y_lines=e;t.redrawWithoutRescale();return i.grid_y_lines};i.ygrids.add=function(e){var t=this.internal;return this.ygrids(t.config.grid_y_lines.concat(e?e:[]))};i.ygrids.remove=function(e){var t=this.internal;t.removeGridLines(e,false)};i.regions=function(e){var t=this.internal,i=t.config;if(!e){return i.regions}i.regions=e;t.redrawWithoutRescale();return i.regions};i.regions.add=function(e){var t=this.internal,i=t.config;if(!e){return i.regions}i.regions=i.regions.concat(e);t.redrawWithoutRescale();return i.regions};i.regions.remove=function(e){var t=this.internal,i=t.config,n,r,o;e=e||{};n=t.getOption(e,"duration",i.transition_duration);r=t.getOption(e,"classes",[$.region]);o=t.main.select("."+$.regions).selectAll(r.map(function(e){return"."+e}));(n?o.transition().duration(n):o).style("opacity",0).remove();i.regions=i.regions.filter(function(e){var t=false;if(!e["class"]){return true}e["class"].split(" ").forEach(function(e){if(r.indexOf(e)>=0){t=true}});return!t});return i.regions};i.data=function(t){var e=this.internal.data.targets;return typeof t==="undefined"?e:e.filter(function(e){return[].concat(t).indexOf(e.id)>=0})};i.data.shown=function(e){return this.internal.filterTargetsToShow(this.data(e))};i.data.values=function(e){var t,i=null;if(e){t=this.data(e);i=t[0]?t[0].values.map(function(e){return e.value}):null}return i};i.data.names=function(e){this.internal.clearLegendItemTextBoxCache();return this.internal.updateDataAttributes("names",e)};i.data.colors=function(e){return this.internal.updateDataAttributes("colors",e)};i.data.axes=function(e){return this.internal.updateDataAttributes("axes",e)};i.category=function(e,t){var i=this.internal,n=i.config;if(arguments.length>1){n.axis_x_categories[e]=t;i.redraw()}return n.axis_x_categories[e]};i.categories=function(e){var t=this.internal,i=t.config;if(!arguments.length){return i.axis_x_categories}i.axis_x_categories=e;t.redraw();return i.axis_x_categories};i.color=function(e){var t=this.internal;return t.color(e)};i.x=function(e){var t=this.internal;if(arguments.length){t.updateTargetX(t.data.targets,e);t.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true})}return t.data.xs};i.xs=function(e){var t=this.internal;if(arguments.length){t.updateTargetXs(t.data.targets,e);t.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true})}return t.data.xs};i.axis=function(){};i.axis.labels=function(t){var i=this.internal;if(arguments.length){Object.keys(t).forEach(function(e){i.axis.setLabelText(e,t[e])});i.axis.updateLabels()}};i.axis.max=function(e){var t=this.internal,i=t.config;if(arguments.length){if(typeof e==="object"){if(T(e.x)){i.axis_x_max=e.x}if(T(e.y)){i.axis_y_max=e.y}if(T(e.y2)){i.axis_y2_max=e.y2}}else{i.axis_y_max=i.axis_y2_max=e}t.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true})}else{return{x:i.axis_x_max,y:i.axis_y_max,y2:i.axis_y2_max}}};i.axis.min=function(e){var t=this.internal,i=t.config;if(arguments.length){if(typeof e==="object"){if(T(e.x)){i.axis_x_min=e.x}if(T(e.y)){i.axis_y_min=e.y}if(T(e.y2)){i.axis_y2_min=e.y2}}else{i.axis_y_min=i.axis_y2_min=e}t.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true})}else{return{x:i.axis_x_min,y:i.axis_y_min,y2:i.axis_y2_min}}};i.axis.range=function(e){if(arguments.length){if(N(e.max)){this.axis.max(e.max)}if(N(e.min)){this.axis.min(e.min)}}else{return{max:this.axis.max(),min:this.axis.min()}}};i.legend=function(){};i.legend.show=function(e){var t=this.internal;t.showLegend(t.mapToTargetIds(e));t.updateAndRedraw({withLegend:true})};i.legend.hide=function(e){var t=this.internal;t.hideLegend(t.mapToTargetIds(e));t.updateAndRedraw({withLegend:true})};i.resize=function(e){var t=this.internal,i=t.config;i.size_width=e?e.width:null;i.size_height=e?e.height:null;this.flush()};i.flush=function(){var e=this.internal;e.updateAndRedraw({withLegend:true,withTransition:false,withTransitionForTransform:false})};i.destroy=function(){var t=this.internal;u.clearInterval(t.intervalForObserveInserted);u.onresize=null;t.selectChart.classed("c3",false).html("");Object.keys(t).forEach(function(e){t[e]=null});return null};i.tooltip=function(){};i.tooltip.show=function(e){var t=this.internal,i,n;if(e.mouse){n=e.mouse}if(e.data){if(t.isMultipleX()){n=[t.x(e.data.x),t.getYScale(e.data.id)(e.data.value)];i=null}else{i=T(e.data.index)?e.data.index:t.getIndexByX(e.data.x)}}else if(typeof e.x!=="undefined"){i=t.getIndexByX(e.x)}else if(typeof e.index!=="undefined"){i=e.index}t.dispatchEvent("mouseover",i,n);t.dispatchEvent("mousemove",i,n)};i.tooltip.hide=function(){this.internal.dispatchEvent("mouseout",0)};var m;function v(I,L){var P=I.scale.linear(),F="bottom",G=6,$,H=3,B=null,i,r;var V=0,t=true,j;L=L||{};$=L.withOuterTick?6:0;function z(e,t){e.attr("transform",function(e){return"translate("+Math.ceil(t(e)+V)+", 0)"})}function W(e,t){e.attr("transform",function(e){return"translate(0,"+Math.ceil(t(e))+")"})}function U(e){var t=e[0],i=e[e.length-1];return t<i?[t,i]:[i,t]}function Y(e){var t,i,n=[];if(e.ticks){return e.ticks.apply(e,r)}i=e.domain();for(t=Math.ceil(i[0]);t<i[1];t++){n.push(t)}if(n.length>0&&n[0]>0){n.unshift(n[0]-(n[1]-n[0]))}return n}function q(){var e=P.copy(),t;if(L.isCategory){t=P.domain();e.domain([t[0],t[1]-1])}return e}function K(e){var t=i?i(e):e;return typeof t!=="undefined"?t:""}function X(e){if(m){return m}var o={h:11.5,w:5.5};e.select("text").text(K).each(function(e){var t=this.getBoundingClientRect(),i=K(e),n=t.height,r=i?t.width/i.length:undefined;if(n&&r){o.h=n;o.w=r}}).text("");m=o;return o}function Z(e){return L.withoutTransition?e:I.transition(e)}function Q(e){e.each(function(){var e=Q.g=I.select(this);var t=this.__chart__||P,l=this.__chart__=q();var c=B?B:Y(l),i=e.selectAll(".tick").data(c,l),n=i.enter().insert("g",".domain").attr("class","tick").style("opacity",1e-6),r=i.exit().remove(),o=Z(i).style("opacity",1),s,a,u;var d=P.rangeExtent?P.rangeExtent():U(P.range()),h=e.selectAll(".domain").data([0]),f=(h.enter().append("path").attr("class","domain"),Z(h));n.append("line");n.append("text");var p=n.select("line"),g=o.select("line"),m=n.select("text"),v=o.select("text");if(L.isCategory){V=Math.ceil((l(1)-l(0))/2);a=j?0:V;u=j?V:0}else{V=a=0}var y,b,_=X(e.select(".tick")),w=[];var C=Math.max(G,0)+H,x=F==="left"||F==="right";function S(e,n){var t=K(e),r,o,s,i=[];if(Object.prototype.toString.call(t)==="[object Array]"){return t}if(!n||n<=0){n=x?95:L.isCategory?Math.ceil(l(c[1])-l(c[0]))-12:110}function a(e,t){o=undefined;for(var i=1;i<t.length;i++){if(t.charAt(i)===" "){o=i}r=t.substr(0,i+1);s=_.w*r.length;if(n<s){return a(e.concat(t.substr(0,o?o:i)),t.slice(o?o+1:i))}}return e.concat(t)}return a(i,t+"")}function A(e,t){var i=_.h;if(t===0){if(F==="left"||F==="right"){i=-((w[e.index]-1)*(_.h/2)-3)}else{i=".71em"}}return i}function E(e){var t=P(e)+(j?0:V);return d[0]<t&&t<d[1]?G:0}y=i.select("text");b=y.selectAll("tspan").data(function(e,t){var i=L.tickMultiline?S(e,L.tickWidth):[].concat(K(e));w[t]=i.length;return i.map(function(e){return{index:t,splitted:e}})});b.enter().append("tspan");b.exit().remove();b.text(function(e){return e.splitted});var T=L.tickTextRotate;function D(e){if(!e){return"middle"}return e>0?"start":"end"}function R(e){if(!e){return""}return"rotate("+e+")"}function M(e){if(!e){return 0}return 8*Math.sin(Math.PI*(e/180))}function k(e){if(!e){return C}return 11.5-2.5*(e/15)*(e>0?1:-1)}switch(F){case"bottom":{s=z;p.attr("y2",G);m.attr("y",C);g.attr("x1",a).attr("x2",a).attr("y2",E);v.attr("x",0).attr("y",k(T)).style("text-anchor",D(T)).attr("transform",R(T));b.attr("x",0).attr("dy",A).attr("dx",M(T));f.attr("d","M"+d[0]+","+$+"V0H"+d[1]+"V"+$);break}case"top":{s=z;p.attr("y2",-G);m.attr("y",-C);g.attr("x2",0).attr("y2",-G);v.attr("x",0).attr("y",-C);y.style("text-anchor","middle");b.attr("x",0).attr("dy","0em");f.attr("d","M"+d[0]+","+-$+"V0H"+d[1]+"V"+-$);break}case"left":{s=W;p.attr("x2",-G);m.attr("x",-C);g.attr("x2",-G).attr("y1",u).attr("y2",u);v.attr("x",-C).attr("y",V);y.style("text-anchor","end");b.attr("x",-C).attr("dy",A);f.attr("d","M"+-$+","+d[0]+"H0V"+d[1]+"H"+-$);break}case"right":{s=W;p.attr("x2",G);m.attr("x",C);g.attr("x2",G).attr("y2",0);v.attr("x",C).attr("y",0);y.style("text-anchor","start");b.attr("x",C).attr("dy",A);f.attr("d","M"+$+","+d[0]+"H0V"+d[1]+"H"+$);break}}if(l.rangeBand){var O=l,N=O.rangeBand()/2;t=l=function(e){return O(e)+N}}else if(t.rangeBand){t=l}else{r.call(s,l)}n.call(s,t);o.call(s,l)})}Q.scale=function(e){if(!arguments.length){return P}P=e;return Q};Q.orient=function(e){if(!arguments.length){return F}F=e in{top:1,right:1,bottom:1,left:1}?e+"":"bottom";return Q};Q.tickFormat=function(e){if(!arguments.length){return i}i=e;return Q};Q.tickCentered=function(e){if(!arguments.length){return j}j=e;return Q};Q.tickOffset=function(){return V};Q.tickInterval=function(){var e,t;if(L.isCategory){e=V*2}else{t=Q.g.select("path.domain").node().getTotalLength()-$*2;e=t/Q.g.selectAll("line").size()}return e===Infinity?0:e};Q.ticks=function(){if(!arguments.length){return r}r=arguments;return Q};Q.tickCulling=function(e){if(!arguments.length){return t}t=e;return Q};Q.tickValues=function(e){if(typeof e==="function"){B=function(){return e(P.domain())}}else{if(!arguments.length){return B}B=e}return Q};return Q}d.isSafari=function(){var e=u.navigator.userAgent;return e.indexOf("Safari")>=0&&e.indexOf("Chrome")<0};d.isChrome=function(){var e=u.navigator.userAgent;return e.indexOf("Chrome")>=0};if(!Function.prototype.bind){Function.prototype.bind=function(e){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var t=Array.prototype.slice.call(arguments,1),i=this,n=function(){},r=function(){return i.apply(this instanceof n?this:e,t.concat(Array.prototype.slice.call(arguments)))};n.prototype=this.prototype;r.prototype=new n;return r}}if(typeof define==="function"&&define.amd){define("c3",["d3"],e)}else if("undefined"!==typeof exports&&"undefined"!==typeof module){module.exports=e}else{u.c3=e}})(window);(function(e){e(["jquery","lodash"],function(W,U){return function(){const I=10;const L=parseInt(W("html").css("--popup-width"));const P=parseInt(W("html").css("--popup-width-mobile"));var F;var t;var G=0;var n={alert:"alert",info:"info",success:"success",warning:"warning"};const $=[n.success,n.warning,n.alert,n.info];var e={clear:l,remove:c,alert:i,getContainer:H,info:r,options:{},subscribe:a,success:o,version:"2.0.3",warning:s,warning_permanent:s};return e;function i(e,t,i){return p({type:n.alert,title:e,message:t,options:i})}function r(e,t,i){return p({type:n.info,title:e,message:t,options:i})}function o(e,t,i){return p({type:n.success,title:e,message:t,options:i})}function s(e,t,i){return p({type:n.warning,title:e,message:t,options:i})}function a(e){t=e}function H(e,t){if(!e){e=j()}F=W("#"+e.containerId);if(F.length){return F}if(t){F=h(e)}return F}function l(e){var t=j();if(!F){H(t)}if(!d(e,t)){u(t)}}function c(e){var t=j();if(!F){H(t)}if(e&&W(":focus",e).length===0){z(e);return}if(F.children().length){F.remove()}}function u(e){var t=F.children();for(var i=t.length-1;i>=0;i--){d(W(t[i]),e)}}function d(e,t){if(e&&W(":focus",e).length===0){e[t.hideMethod]({duration:t.hideDuration,easing:t.hideEasing,complete:function(){z(e)}});return true}return false}function h(e){F=W("<div/>").attr("id",e.containerId).addClass(e.positionClass).attr("aria-live","polite").attr("role","alert");F.appendTo(W(e.target));return F}function f(){return{tapToDismiss:false,toastClass:"popup",containerId:"popups",debug:false,showMethod:"fadeIn",showDuration:300,showEasing:"swing",onShown:undefined,hideMethod:"fadeOut",hideDuration:1e3,hideEasing:"swing",onHidden:undefined,extendedTimeOut:1e3,onCloseClick:undefined,positionClass:"popups-bottom-right",timeOut:5e3,titleClass:"headline",messageClass:"popup-content",tabsClass:"popup-tabs",tabClass:"popup-tab",arrowClass:"arrow",leftArrowClass:"arrow-left",rightArrowClass:"arrow-right",headerClass:"popup-header",activeTabClass:"active",hasTabsClass:"has-tabs",hasCarouselClass:"has-carousel",expandedClass:"expanded",closeIcon:"icon icon-times-circle",target:"body",newestOnTop:false,useTabs:true,collapse:true}}function B(e){if(!t){return}t(e)}function V(){return this._template||(this._template=`
                <div class="{{= toastClass }} {{= toastClass }}-{{= type }}">
                  <div class="{{= headerClass }} {{= tabsClass }}"></div>
                  <div class="{{= tabClass }} {{= arrowClass }} {{= leftArrowClass }} {{= activeTabClass }}">
                    <i class="icon icon-{{= leftArrowClass }}"></i>
                  </div>
                  <div class="{{= tabClass }} {{= arrowClass }} {{= rightArrowClass }} {{= activeTabClass }}">
                    <i class="icon icon-{{= rightArrowClass }}"></i>
                  </div>
                  
                  <div class="{{= headerClass }}">
                    <div class="d-flex">
                     {{ if (collapse) { }}
                        <i class="icon icon-caret-left me-2"></i>
                     {{ } }}
                     <i class="icon icon-state-{{= type }} popup-header-icon me-1"></i>
                    </div>
                    <span class="popup-header-title">{{= title }}</span>
                    <i class="js-close close-icon {{= closeIcon }} ms-auto"></i>
                  </div>
                  <div class="{{= messageClass }}" style="display: none;">{{= message }}</div>
                </div>`)}function p(e){var t=j(),r=W.extend(t,e);if(typeof e.options!=="undefined"){r=W.extend(r,e.options)}F=H(r,true);if(F.is("[data-popups-options]")){const N=AGN.Lib.Helpers.objFromString(F.data("popups-options"));r=U.extend(r,N)}const i=W(`.popup-${r.type}`);if(r.useTabs&&i.is(":visible")){C(i);return i}G++;var n=U.template(V())(r),o=W(n);var s=null,a=o,l=a.find(".js-close"),c=a.find(`.${r.rightArrowClass}`),u=a.find(`.${r.leftArrowClass}`).hide(),d=0,h={toastId:G,state:"visible",startTime:new Date,options:r};if(r.message){a.find("."+r.messageClass).show()}a.data("type",r.type);p(a);a[r.showMethod]({duration:r.showDuration,easing:r.showEasing,complete:r.onShown});if(r.timeOut>0){s=setTimeout(M,r.timeOut)}a.hover(O,k);if(!r.onclick&&r.tapToDismiss){a.click(M)}if(l){l.click(function(e){if(e.stopPropagation){e.stopPropagation()}else if(e.cancelBubble!==undefined&&e.cancelBubble!==true){e.cancelBubble=true}if(r.onCloseClick){r.onCloseClick(e)}if(a.hasClass(r.hasTabsClass)){y()}else{M(true)}})}if(r.onclick){a.click(function(){r.onclick();M()})}B(h);if(r.debug&&console){console.log(h)}u.click(()=>m());c.click(()=>v());if(r.collapse){a.find(`.${r.headerClass}:not(.${r.tabsClass})`).click(()=>{a.toggleClass(r.expandedClass,R(a));b(a)})}else{a.addClass(r.expandedClass)}C(a);return a;function f(){const n=$.indexOf(r.type);return F.find(`.${r.toastClass}`).filter((e,t)=>{const i=$.indexOf(W(t).data("type"));return n<i}).first()}function p(e){if(r.newestOnTop||!F.find(`.${r.toastClass}`).length){F.prepend(e);return}const t=f();if(t.exists()){e.insertBefore(t);return}F.append(e)}function g(e,t){const i=e.find(`.${r.tabsClass}`);i.css("transform",`translateX(${t}px)`);setTimeout(()=>E(e),300)}function m(e){d=d-1;const t=d*-D(a);g(a,t);if(!e){c.show()}if(d===0){u.hide()}}function v(){d=d+1;const e=d*D(a);g(a,e*-1);u.show();if(a.find(`.${r.tabsClass}`).width()-e<=a.width()){c.hide()}}function y(){const e=T(a).filter(`.${r.activeTabClass}`);const t=e.next();const i=t.length?t:e.prev();e.remove();if(u.is(":visible")){m(true)}w(a,i)}function b(e){let t=T(e);e.toggleClass(r.hasTabsClass,t.length>1);e.toggleClass(r.hasCarouselClass,t.length>I);const i=D(e);e.find(`.${r.tabClass}`).each((e,t)=>W(t).css("width",`${i}px`));E(e)}function _(){const e=W(`
                    <div class="${r.tabClass}">
                      <i class="icon icon-state-${r.type}"></i>
                    </div>`);e.data("options",r);return e}function w(e,t){T(e).filter(`.${r.activeTabClass}`).removeClass(r.activeTabClass);t.addClass(r.activeTabClass);e.find(`.${r.messageClass}`).html(t.data("options").message);b(e)}function C(e){const t=_();e.find(`.${r.tabsClass}`).prepend(t);w(e,t);t.click(()=>w(e,t))}function x(e){e.style("border-right-width","0")}function S(e){e.style("border-right-width","1px")}function A(e,t){const o=e.offset().left;const s=e.offset().left+e.outerWidth();return t.filter((e,t)=>{const i=W(t);const n=i.offset().left;const r=i.offset().left+i.outerWidth();return n>=o-5&&r<=s+5})}function E(e){let t=T(e);t.each((e,t)=>S(W(t)));x(t.filter(`.${r.activeTabClass}`).prev());const i=A(e,t);if(e.find(`.${r.rightArrowClass}`).is(":visible")){x(i.last().prev())}if(e.find(`.${r.leftArrowClass}`).is(":visible")){x(i.first())}}function T(e){return e.find(`.${r.tabClass}:not(.${r.arrowClass})`)}function D(e){return!e.hasClass(r.expandedClass)||R(e)?L/I:e.width()/I}function R(e){return e.width()===P}function M(e){if((W(":focus",a).length||a.hasClass(r.expandedClass))&&!e){return}return a[r.hideMethod]({duration:r.hideDuration,easing:r.hideEasing,complete:function(){z(a);if(r.onHidden&&h.state!=="hidden"){r.onHidden()}h.state="hidden";h.endTime=new Date;B(h)}})}function k(){if(r.timeOut>0||r.extendedTimeOut>0){s=setTimeout(M,r.extendedTimeOut)}}function O(){clearTimeout(s);a.stop(true,true)[r.showMethod]({duration:r.showDuration,easing:r.showEasing})}}function j(){return W.extend({},f(),e.options)}function z(e){if(!F){F=H()}if(e.is(":visible")){return}e.remove();e=null;if(F.children().length===0){F.remove()}}}()})})(typeof define==="function"&&define.amd?define:function(e,t){if(typeof module!=="undefined"&&module.exports){module.exports=t(require("jquery","lodash"))}else{window["toastr"]=t(window["jQuery"],window["_"])}});(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):e.moment=t()})(this,function(){"use strict";var P;function c(){return P.apply(null,arguments)}function F(e){P=e}function s(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function G(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function $(e){if(Object.getOwnPropertyNames){return Object.getOwnPropertyNames(e).length===0}else{var t;for(t in e){if(e.hasOwnProperty(t)){return false}}return true}}function o(e){return e===void 0}function H(e){return typeof e==="number"||Object.prototype.toString.call(e)==="[object Number]"}function B(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function V(e,t){var i=[],n;for(n=0;n<e.length;++n){i.push(t(e[n],n))}return i}function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function j(e,t){for(var i in t){if(a(t,i)){e[i]=t[i]}}if(a(t,"toString")){e.toString=t.toString}if(a(t,"valueOf")){e.valueOf=t.valueOf}return e}function u(e,t,i,n){return Ji(e,t,i,n,true).utc()}function z(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],meridiem:null,rfc2822:false,weekdayMismatch:false}}function d(e){if(e._pf==null){e._pf=z()}return e._pf}var W;if(Array.prototype.some){W=Array.prototype.some}else{W=function(e){var t=Object(this);var i=t.length>>>0;for(var n=0;n<i;n++){if(n in t&&e.call(this,t[n],n,t)){return true}}return false}}function U(e){if(e._isValid==null){var t=d(e);var i=W.call(t.parsedDateParts,function(e){return e!=null});var n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&i);if(e._strict){n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined}if(Object.isFrozen==null||!Object.isFrozen(e)){e._isValid=n}else{return n}}return e._isValid}function Y(e){var t=u(NaN);if(e!=null){j(d(t),e)}else{d(t).userInvalidated=true}return t}var q=c.momentProperties=[];function K(e,t){var i,n,r;if(!o(t._isAMomentObject)){e._isAMomentObject=t._isAMomentObject}if(!o(t._i)){e._i=t._i}if(!o(t._f)){e._f=t._f}if(!o(t._l)){e._l=t._l}if(!o(t._strict)){e._strict=t._strict}if(!o(t._tzm)){e._tzm=t._tzm}if(!o(t._isUTC)){e._isUTC=t._isUTC}if(!o(t._offset)){e._offset=t._offset}if(!o(t._pf)){e._pf=d(t)}if(!o(t._locale)){e._locale=t._locale}if(q.length>0){for(i=0;i<q.length;i++){n=q[i];r=t[n];if(!o(r)){e[n]=r}}}return e}var X=false;function Z(e){K(this,e);this._d=new Date(e._d!=null?e._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN)}if(X===false){X=true;c.updateOffset(this);X=false}}function l(e){return e instanceof Z||e!=null&&e._isAMomentObject!=null}function v(e){if(e<0){return Math.ceil(e)||0}else{return Math.floor(e)}}function h(e){var t=+e,i=0;if(t!==0&&isFinite(t)){i=v(t)}return i}function Q(e,t,i){var n=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),o=0,s;for(s=0;s<n;s++){if(i&&e[s]!==t[s]||!i&&h(e[s])!==h(t[s])){o++}}return o+r}function J(e){if(c.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+e)}}function e(r,o){var s=true;return j(function(){if(c.deprecationHandler!=null){c.deprecationHandler(null,r)}if(s){var e=[];var t;for(var i=0;i<arguments.length;i++){t="";if(typeof arguments[i]==="object"){t+="\n["+i+"] ";for(var n in arguments[0]){t+=n+": "+arguments[0][n]+", "}t=t.slice(0,-2)}else{t=arguments[i]}e.push(t)}J(r+"\nArguments: "+Array.prototype.slice.call(e).join("")+"\n"+(new Error).stack);s=false}return o.apply(this,arguments)},o)}var ee={};function te(e,t){if(c.deprecationHandler!=null){c.deprecationHandler(e,t)}if(!ee[e]){J(t);ee[e]=true}}c.suppressDeprecationWarnings=false;c.deprecationHandler=null;function f(e){return e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function ie(e){var t,i;for(i in e){t=e[i];if(f(t)){this[i]=t}else{this["_"+i]=t}}this._config=e;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ne(e,t){var i=j({},e),n;for(n in t){if(a(t,n)){if(G(e[n])&&G(t[n])){i[n]={};j(i[n],e[n]);j(i[n],t[n])}else if(t[n]!=null){i[n]=t[n]}else{delete i[n]}}}for(n in e){if(a(e,n)&&!a(t,n)&&G(e[n])){i[n]=j({},i[n])}}return i}function re(e){if(e!=null){this.set(e)}}var oe;if(Object.keys){oe=Object.keys}else{oe=function(e){var t,i=[];for(t in e){if(a(e,t)){i.push(t)}}return i}}var se={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function ae(e,t,i){var n=this._calendar[e]||this._calendar["sameElse"];return f(n)?n.call(t,i):n}var le={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function ce(e){var t=this._longDateFormat[e],i=this._longDateFormat[e.toUpperCase()];if(t||!i){return t}this._longDateFormat[e]=i.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)});return this._longDateFormat[e]}var ue="Invalid date";function de(){return this._invalidDate}var he="%d";var fe=/\d{1,2}/;function pe(e){return this._ordinal.replace("%d",e)}var ge={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function me(e,t,i,n){var r=this._relativeTime[i];return f(r)?r(e,t,i,n):r.replace(/%d/i,e)}function ve(e,t){var i=this._relativeTime[e>0?"future":"past"];return f(i)?i(t):i.replace(/%s/i,t)}var ye={};function t(e,t){var i=e.toLowerCase();ye[i]=ye[i+"s"]=ye[t]=e}function p(e){return typeof e==="string"?ye[e]||ye[e.toLowerCase()]:undefined}function be(e){var t={},i,n;for(n in e){if(a(e,n)){i=p(n);if(i){t[i]=e[n]}}}return t}var _e={};function i(e,t){_e[e]=t}function we(e){var t=[];for(var i in e){t.push({unit:i,priority:_e[i]})}t.sort(function(e,t){return e.priority-t.priority});return t}function g(e,t,i){var n=""+Math.abs(e),r=t-n.length,o=e>=0;return(o?i?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+n}var Ce=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;var xe=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g;var Se={};var Ae={};function n(e,t,i,n){var r=n;if(typeof n==="string"){r=function(){return this[n]()}}if(e){Ae[e]=r}if(t){Ae[t[0]]=function(){return g(r.apply(this,arguments),t[1],t[2])}}if(i){Ae[i]=function(){return this.localeData().ordinal(r.apply(this,arguments),e)}}}function Ee(e){if(e.match(/\[[\s\S]/)){return e.replace(/^\[|\]$/g,"")}return e.replace(/\\/g,"")}function Te(n){var r=n.match(Ce),e,o;for(e=0,o=r.length;e<o;e++){if(Ae[r[e]]){r[e]=Ae[r[e]]}else{r[e]=Ee(r[e])}}return function(e){var t="",i;for(i=0;i<o;i++){t+=f(r[i])?r[i].call(e,n):r[i]}return t}}function De(e,t){if(!e.isValid()){return e.localeData().invalidDate()}t=Re(t,e.localeData());Se[t]=Se[t]||Te(t);return Se[t](e)}function Re(e,t){var i=5;function n(e){return t.longDateFormat(e)||e}xe.lastIndex=0;while(i>=0&&xe.test(e)){e=e.replace(xe,n);xe.lastIndex=0;i-=1}return e}var Me=/\d/;var r=/\d\d/;var ke=/\d{3}/;var Oe=/\d{4}/;var Ne=/[+-]?\d{6}/;var m=/\d\d?/;var Ie=/\d\d\d\d?/;var Le=/\d\d\d\d\d\d?/;var Pe=/\d{1,3}/;var Fe=/\d{1,4}/;var Ge=/[+-]?\d{1,6}/;var $e=/\d+/;var He=/[+-]?\d+/;var Be=/Z|[+-]\d\d:?\d\d/gi;var Ve=/Z|[+-]\d\d(?::?\d\d)?/gi;var je=/[+-]?\d+(\.\d{1,3})?/;var ze=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;var We={};function y(e,i,n){We[e]=f(i)?i:function(e,t){return e&&n?n:i}}function Ue(e,t){if(!a(We,e)){return new RegExp(Ye(e))}return We[e](t._strict,t._locale)}function Ye(e){return qe(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,n,r){return t||i||n||r}))}function qe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Ke={};function b(e,i){var t,n=i;if(typeof e==="string"){e=[e]}if(H(i)){n=function(e,t){t[i]=h(e)}}for(t=0;t<e.length;t++){Ke[e[t]]=n}}function Xe(e,r){b(e,function(e,t,i,n){i._w=i._w||{};r(e,i._w,i,n)})}function Ze(e,t,i){if(t!=null&&a(Ke,e)){Ke[e](t,i._a,i,e)}}var _=0;var w=1;var C=2;var x=3;var S=4;var A=5;var Qe=6;var Je=7;var et=8;n("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e});n(0,["YY",2],0,function(){return this.year()%100});n(0,["YYYY",4],0,"year");n(0,["YYYYY",5],0,"year");n(0,["YYYYYY",6,true],0,"year");t("year","y");i("year",1);y("Y",He);y("YY",m,r);y("YYYY",Fe,Oe);y("YYYYY",Ge,Ne);y("YYYYYY",Ge,Ne);b(["YYYYY","YYYYYY"],_);b("YYYY",function(e,t){t[_]=e.length===2?c.parseTwoDigitYear(e):h(e)});b("YY",function(e,t){t[_]=c.parseTwoDigitYear(e)});b("Y",function(e,t){t[_]=parseInt(e,10)});function tt(e){return it(e)?366:365}function it(e){return e%4===0&&e%100!==0||e%400===0}c.parseTwoDigitYear=function(e){return h(e)+(h(e)>68?1900:2e3)};var nt=ot("FullYear",true);function rt(){return it(this.year())}function ot(t,i){return function(e){if(e!=null){at(this,t,e);c.updateOffset(this,i);return this}else{return st(this,t)}}}function st(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function at(e,t,i){if(e.isValid()&&!isNaN(i)){if(t==="FullYear"&&it(e.year())&&e.month()===1&&e.date()===29){e._d["set"+(e._isUTC?"UTC":"")+t](i,e.month(),dt(i,e.month()))}else{e._d["set"+(e._isUTC?"UTC":"")+t](i)}}}function lt(e){e=p(e);if(f(this[e])){return this[e]()}return this}function ct(e,t){if(typeof e==="object"){e=be(e);var i=we(e);for(var n=0;n<i.length;n++){this[i[n].unit](e[i[n].unit])}}else{e=p(e);if(f(this[e])){return this[e](t)}}return this}function ut(e,t){return(e%t+t)%t}var E;if(Array.prototype.indexOf){E=Array.prototype.indexOf}else{E=function(e){var t;for(t=0;t<this.length;++t){if(this[t]===e){return t}}return-1}}function dt(e,t){if(isNaN(e)||isNaN(t)){return NaN}var i=ut(t,12);e+=(t-i)/12;return i===1?it(e)?29:28:31-i%7%2}n("M",["MM",2],"Mo",function(){return this.month()+1});n("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});n("MMMM",0,0,function(e){return this.localeData().months(this,e)});t("month","M");i("month",8);y("M",m);y("MM",m,r);y("MMM",function(e,t){return t.monthsShortRegex(e)});y("MMMM",function(e,t){return t.monthsRegex(e)});b(["M","MM"],function(e,t){t[w]=h(e)-1});b(["MMM","MMMM"],function(e,t,i,n){var r=i._locale.monthsParse(e,n,i._strict);if(r!=null){t[w]=r}else{d(i).invalidMonth=e}});var ht=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;var ft="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function pt(e,t){if(!e){return s(this._months)?this._months:this._months["standalone"]}return s(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||ht).test(t)?"format":"standalone"][e.month()]}var gt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function mt(e,t){if(!e){return s(this._monthsShort)?this._monthsShort:this._monthsShort["standalone"]}return s(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[ht.test(t)?"format":"standalone"][e.month()]}function vt(e,t,i){var n,r,o,s=e.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(n=0;n<12;++n){o=u([2e3,n]);this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase();this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase()}}if(i){if(t==="MMM"){r=E.call(this._shortMonthsParse,s);return r!==-1?r:null}else{r=E.call(this._longMonthsParse,s);return r!==-1?r:null}}else{if(t==="MMM"){r=E.call(this._shortMonthsParse,s);if(r!==-1){return r}r=E.call(this._longMonthsParse,s);return r!==-1?r:null}else{r=E.call(this._longMonthsParse,s);if(r!==-1){return r}r=E.call(this._shortMonthsParse,s);return r!==-1?r:null}}}function yt(e,t,i){var n,r,o;if(this._monthsParseExact){return vt.call(this,e,t,i)}if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(n=0;n<12;n++){r=u([2e3,n]);if(i&&!this._longMonthsParse[n]){this._longMonthsParse[n]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i");this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")}if(!i&&!this._monthsParse[n]){o="^"+this.months(r,"")+"|^"+this.monthsShort(r,"");this._monthsParse[n]=new RegExp(o.replace(".",""),"i")}if(i&&t==="MMMM"&&this._longMonthsParse[n].test(e)){return n}else if(i&&t==="MMM"&&this._shortMonthsParse[n].test(e)){return n}else if(!i&&this._monthsParse[n].test(e)){return n}}}function bt(e,t){var i;if(!e.isValid()){return e}if(typeof t==="string"){if(/^\d+$/.test(t)){t=h(t)}else{t=e.localeData().monthsParse(t);if(!H(t)){return e}}}i=Math.min(e.date(),dt(e.year(),t));e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,i);return e}function _t(e){if(e!=null){bt(this,e);c.updateOffset(this,true);return this}else{return st(this,"Month")}}function wt(){return dt(this.year(),this.month())}var Ct=ze;function xt(e){if(this._monthsParseExact){if(!a(this,"_monthsRegex")){Et.call(this)}if(e){return this._monthsShortStrictRegex}else{return this._monthsShortRegex}}else{if(!a(this,"_monthsShortRegex")){this._monthsShortRegex=Ct}return this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex}}var St=ze;function At(e){if(this._monthsParseExact){if(!a(this,"_monthsRegex")){Et.call(this)}if(e){return this._monthsStrictRegex}else{return this._monthsRegex}}else{if(!a(this,"_monthsRegex")){this._monthsRegex=St}return this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex}}function Et(){function e(e,t){return t.length-e.length}var t=[],i=[],n=[],r,o;for(r=0;r<12;r++){o=u([2e3,r]);t.push(this.monthsShort(o,""));i.push(this.months(o,""));n.push(this.months(o,""));n.push(this.monthsShort(o,""))}t.sort(e);i.sort(e);n.sort(e);for(r=0;r<12;r++){t[r]=qe(t[r]);i[r]=qe(i[r])}for(r=0;r<24;r++){n[r]=qe(n[r])}this._monthsRegex=new RegExp("^("+n.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function Tt(e,t,i,n,r,o,s){var a;if(e<100&&e>=0){a=new Date(e+400,t,i,n,r,o,s);if(isFinite(a.getFullYear())){a.setFullYear(e)}}else{a=new Date(e,t,i,n,r,o,s)}return a}function Dt(e){var t;if(e<100&&e>=0){var i=Array.prototype.slice.call(arguments);i[0]=e+400;t=new Date(Date.UTC.apply(null,i));if(isFinite(t.getUTCFullYear())){t.setUTCFullYear(e)}}else{t=new Date(Date.UTC.apply(null,arguments))}return t}function Rt(e,t,i){var n=7+t-i,r=(7+Dt(e,0,n).getUTCDay()-t)%7;return-r+n-1}function Mt(e,t,i,n,r){var o=(7+i-n)%7,s=Rt(e,n,r),a=1+7*(t-1)+o+s,l,c;if(a<=0){l=e-1;c=tt(l)+a}else if(a>tt(e)){l=e+1;c=a-tt(e)}else{l=e;c=a}return{year:l,dayOfYear:c}}function kt(e,t,i){var n=Rt(e.year(),t,i),r=Math.floor((e.dayOfYear()-n-1)/7)+1,o,s;if(r<1){s=e.year()-1;o=r+Ot(s,t,i)}else if(r>Ot(e.year(),t,i)){o=r-Ot(e.year(),t,i);s=e.year()+1}else{s=e.year();o=r}return{week:o,year:s}}function Ot(e,t,i){var n=Rt(e,t,i),r=Rt(e+1,t,i);return(tt(e)-n+r)/7}n("w",["ww",2],"wo","week");n("W",["WW",2],"Wo","isoWeek");t("week","w");t("isoWeek","W");i("week",5);i("isoWeek",5);y("w",m);y("ww",m,r);y("W",m);y("WW",m,r);Xe(["w","ww","W","WW"],function(e,t,i,n){t[n.substr(0,1)]=h(e)});function Nt(e){return kt(e,this._week.dow,this._week.doy).week}var It={dow:0,doy:6};function Lt(){return this._week.dow}function Pt(){return this._week.doy}function Ft(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Gt(e){var t=kt(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}n("d",0,"do","day");n("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});n("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});n("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});n("e",0,0,"weekday");n("E",0,0,"isoWeekday");t("day","d");t("weekday","e");t("isoWeekday","E");i("day",11);i("weekday",11);i("isoWeekday",11);y("d",m);y("e",m);y("E",m);y("dd",function(e,t){return t.weekdaysMinRegex(e)});y("ddd",function(e,t){return t.weekdaysShortRegex(e)});y("dddd",function(e,t){return t.weekdaysRegex(e)});Xe(["dd","ddd","dddd"],function(e,t,i,n){var r=i._locale.weekdaysParse(e,n,i._strict);if(r!=null){t.d=r}else{d(i).invalidWeekday=e}});Xe(["d","e","E"],function(e,t,i,n){t[n]=h(e)});function $t(e,t){if(typeof e!=="string"){return e}if(!isNaN(e)){return parseInt(e,10)}e=t.weekdaysParse(e);if(typeof e==="number"){return e}return null}function Ht(e,t){if(typeof e==="string"){return t.weekdaysParse(e)%7||7}return isNaN(e)?null:e}function Bt(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Vt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function jt(e,t){var i=s(this._weekdays)?this._weekdays:this._weekdays[e&&e!==true&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===true?Bt(i,this._week.dow):e?i[e.day()]:i}var zt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function Wt(e){return e===true?Bt(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}var Ut="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function Yt(e){return e===true?Bt(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function qt(e,t,i){var n,r,o,s=e.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(n=0;n<7;++n){o=u([2e3,1]).day(n);this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase();this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase();this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase()}}if(i){if(t==="dddd"){r=E.call(this._weekdaysParse,s);return r!==-1?r:null}else if(t==="ddd"){r=E.call(this._shortWeekdaysParse,s);return r!==-1?r:null}else{r=E.call(this._minWeekdaysParse,s);return r!==-1?r:null}}else{if(t==="dddd"){r=E.call(this._weekdaysParse,s);if(r!==-1){return r}r=E.call(this._shortWeekdaysParse,s);if(r!==-1){return r}r=E.call(this._minWeekdaysParse,s);return r!==-1?r:null}else if(t==="ddd"){r=E.call(this._shortWeekdaysParse,s);if(r!==-1){return r}r=E.call(this._weekdaysParse,s);if(r!==-1){return r}r=E.call(this._minWeekdaysParse,s);return r!==-1?r:null}else{r=E.call(this._minWeekdaysParse,s);if(r!==-1){return r}r=E.call(this._weekdaysParse,s);if(r!==-1){return r}r=E.call(this._shortWeekdaysParse,s);return r!==-1?r:null}}}function Kt(e,t,i){var n,r,o;if(this._weekdaysParseExact){return qt.call(this,e,t,i)}if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[]}for(n=0;n<7;n++){r=u([2e3,1]).day(n);if(i&&!this._fullWeekdaysParse[n]){this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i");this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i");this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")}if(!this._weekdaysParse[n]){o="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,"");this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")}if(i&&t==="dddd"&&this._fullWeekdaysParse[n].test(e)){return n}else if(i&&t==="ddd"&&this._shortWeekdaysParse[n].test(e)){return n}else if(i&&t==="dd"&&this._minWeekdaysParse[n].test(e)){return n}else if(!i&&this._weekdaysParse[n].test(e)){return n}}}function Xt(e){if(!this.isValid()){return e!=null?this:NaN}var t=this._isUTC?this._d.getUTCDay():this._d.getDay();if(e!=null){e=$t(e,this.localeData());return this.add(e-t,"d")}else{return t}}function Zt(e){if(!this.isValid()){return e!=null?this:NaN}var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Qt(e){if(!this.isValid()){return e!=null?this:NaN}if(e!=null){var t=Ht(e,this.localeData());return this.day(this.day()%7?t:t-7)}else{return this.day()||7}}var Jt=ze;function ei(e){if(this._weekdaysParseExact){if(!a(this,"_weekdaysRegex")){oi.call(this)}if(e){return this._weekdaysStrictRegex}else{return this._weekdaysRegex}}else{if(!a(this,"_weekdaysRegex")){this._weekdaysRegex=Jt}return this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex}}var ti=ze;function ii(e){if(this._weekdaysParseExact){if(!a(this,"_weekdaysRegex")){oi.call(this)}if(e){return this._weekdaysShortStrictRegex}else{return this._weekdaysShortRegex}}else{if(!a(this,"_weekdaysShortRegex")){this._weekdaysShortRegex=ti}return this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}}var ni=ze;function ri(e){if(this._weekdaysParseExact){if(!a(this,"_weekdaysRegex")){oi.call(this)}if(e){return this._weekdaysMinStrictRegex}else{return this._weekdaysMinRegex}}else{if(!a(this,"_weekdaysMinRegex")){this._weekdaysMinRegex=ni}return this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}}function oi(){function e(e,t){return t.length-e.length}var t=[],i=[],n=[],r=[],o,s,a,l,c;for(o=0;o<7;o++){s=u([2e3,1]).day(o);a=this.weekdaysMin(s,"");l=this.weekdaysShort(s,"");c=this.weekdays(s,"");t.push(a);i.push(l);n.push(c);r.push(a);r.push(l);r.push(c)}t.sort(e);i.sort(e);n.sort(e);r.sort(e);for(o=0;o<7;o++){i[o]=qe(i[o]);n[o]=qe(n[o]);r[o]=qe(r[o])}this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+i.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function si(){return this.hours()%12||12}function ai(){return this.hours()||24}n("H",["HH",2],0,"hour");n("h",["hh",2],0,si);n("k",["kk",2],0,ai);n("hmm",0,0,function(){return""+si.apply(this)+g(this.minutes(),2)});n("hmmss",0,0,function(){return""+si.apply(this)+g(this.minutes(),2)+g(this.seconds(),2)});n("Hmm",0,0,function(){return""+this.hours()+g(this.minutes(),2)});n("Hmmss",0,0,function(){return""+this.hours()+g(this.minutes(),2)+g(this.seconds(),2)});function li(e,t){n(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}li("a",true);li("A",false);t("hour","h");i("hour",13);function ci(e,t){return t._meridiemParse}y("a",ci);y("A",ci);y("H",m);y("h",m);y("k",m);y("HH",m,r);y("hh",m,r);y("kk",m,r);y("hmm",Ie);y("hmmss",Le);y("Hmm",Ie);y("Hmmss",Le);b(["H","HH"],x);b(["k","kk"],function(e,t,i){var n=h(e);t[x]=n===24?0:n});b(["a","A"],function(e,t,i){i._isPm=i._locale.isPM(e);i._meridiem=e});b(["h","hh"],function(e,t,i){t[x]=h(e);d(i).bigHour=true});b("hmm",function(e,t,i){var n=e.length-2;t[x]=h(e.substr(0,n));t[S]=h(e.substr(n));d(i).bigHour=true});b("hmmss",function(e,t,i){var n=e.length-4;var r=e.length-2;t[x]=h(e.substr(0,n));t[S]=h(e.substr(n,2));t[A]=h(e.substr(r));d(i).bigHour=true});b("Hmm",function(e,t,i){var n=e.length-2;t[x]=h(e.substr(0,n));t[S]=h(e.substr(n))});b("Hmmss",function(e,t,i){var n=e.length-4;var r=e.length-2;t[x]=h(e.substr(0,n));t[S]=h(e.substr(n,2));t[A]=h(e.substr(r))});function ui(e){return(e+"").toLowerCase().charAt(0)==="p"}var di=/[ap]\.?m?\.?/i;function hi(e,t,i){if(e>11){return i?"pm":"PM"}else{return i?"am":"AM"}}var fi=ot("Hours",true);var pi={calendar:se,longDateFormat:le,invalidDate:ue,ordinal:he,dayOfMonthOrdinalParse:fe,relativeTime:ge,months:ft,monthsShort:gt,week:It,weekdays:Vt,weekdaysMin:Ut,weekdaysShort:zt,meridiemParse:di};var T={};var gi={};var mi;function vi(e){return e?e.toLowerCase().replace("_","-"):e}function yi(e){var t=0,i,n,r,o;while(t<e.length){o=vi(e[t]).split("-");i=o.length;n=vi(e[t+1]);n=n?n.split("-"):null;while(i>0){r=bi(o.slice(0,i).join("-"));if(r){return r}if(n&&n.length>=i&&Q(o,n,true)>=i-1){break}i--}t++}return mi}function bi(e){var t=null;if(!T[e]&&typeof module!=="undefined"&&module&&module.exports){try{t=mi._abbr;var i=require;i("./locale/"+e);_i(t)}catch(e){}}return T[e]}function _i(e,t){var i;if(e){if(o(t)){i=xi(e)}else{i=wi(e,t)}if(i){mi=i}else{if(typeof console!=="undefined"&&console.warn){console.warn("Locale "+e+" not found. Did you forget to load it?")}}}return mi._abbr}function wi(e,t){if(t!==null){var i,n=pi;t.abbr=e;if(T[e]!=null){te("defineLocaleOverride","use moment.updateLocale(localeName, config) to change "+"an existing locale. moment.defineLocale(localeName, "+"config) should only be used for creating a new locale "+"See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");n=T[e]._config}else if(t.parentLocale!=null){if(T[t.parentLocale]!=null){n=T[t.parentLocale]._config}else{i=bi(t.parentLocale);if(i!=null){n=i._config}else{if(!gi[t.parentLocale]){gi[t.parentLocale]=[]}gi[t.parentLocale].push({name:e,config:t});return null}}}T[e]=new re(ne(n,t));if(gi[e]){gi[e].forEach(function(e){wi(e.name,e.config)})}_i(e);return T[e]}else{delete T[e];return null}}function Ci(e,t){if(t!=null){var i,n,r=pi;n=bi(e);if(n!=null){r=n._config}t=ne(r,t);i=new re(t);i.parentLocale=T[e];T[e]=i;_i(e)}else{if(T[e]!=null){if(T[e].parentLocale!=null){T[e]=T[e].parentLocale}else if(T[e]!=null){delete T[e]}}}return T[e]}function xi(e){var t;if(e&&e._locale&&e._locale._abbr){e=e._locale._abbr}if(!e){return mi}if(!s(e)){t=bi(e);if(t){return t}e=[e]}return yi(e)}function Si(){return oe(T)}function Ai(e){var t;var i=e._a;if(i&&d(e).overflow===-2){t=i[w]<0||i[w]>11?w:i[C]<1||i[C]>dt(i[_],i[w])?C:i[x]<0||i[x]>24||i[x]===24&&(i[S]!==0||i[A]!==0||i[Qe]!==0)?x:i[S]<0||i[S]>59?S:i[A]<0||i[A]>59?A:i[Qe]<0||i[Qe]>999?Qe:-1;if(d(e)._overflowDayOfYear&&(t<_||t>C)){t=C}if(d(e)._overflowWeeks&&t===-1){t=Je}if(d(e)._overflowWeekday&&t===-1){t=et}d(e).overflow=t}return e}function Ei(e,t,i){if(e!=null){return e}if(t!=null){return t}return i}function Ti(e){var t=new Date(c.now());if(e._useUTC){return[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]}return[t.getFullYear(),t.getMonth(),t.getDate()]}function Di(e){var t,i,n=[],r,o,s;if(e._d){return}r=Ti(e);if(e._w&&e._a[C]==null&&e._a[w]==null){Ri(e)}if(e._dayOfYear!=null){s=Ei(e._a[_],r[_]);if(e._dayOfYear>tt(s)||e._dayOfYear===0){d(e)._overflowDayOfYear=true}i=Dt(s,0,e._dayOfYear);e._a[w]=i.getUTCMonth();e._a[C]=i.getUTCDate()}for(t=0;t<3&&e._a[t]==null;++t){e._a[t]=n[t]=r[t]}for(;t<7;t++){e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t]}if(e._a[x]===24&&e._a[S]===0&&e._a[A]===0&&e._a[Qe]===0){e._nextDay=true;e._a[x]=0}e._d=(e._useUTC?Dt:Tt).apply(null,n);o=e._useUTC?e._d.getUTCDay():e._d.getDay();if(e._tzm!=null){e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm)}if(e._nextDay){e._a[x]=24}if(e._w&&typeof e._w.d!=="undefined"&&e._w.d!==o){d(e).weekdayMismatch=true}}function Ri(e){var t,i,n,r,o,s,a,l;t=e._w;if(t.GG!=null||t.W!=null||t.E!=null){o=1;s=4;i=Ei(t.GG,e._a[_],kt(D(),1,4).year);n=Ei(t.W,1);r=Ei(t.E,1);if(r<1||r>7){l=true}}else{o=e._locale._week.dow;s=e._locale._week.doy;var c=kt(D(),o,s);i=Ei(t.gg,e._a[_],c.year);n=Ei(t.w,c.week);if(t.d!=null){r=t.d;if(r<0||r>6){l=true}}else if(t.e!=null){r=t.e+o;if(t.e<0||t.e>6){l=true}}else{r=o}}if(n<1||n>Ot(i,o,s)){d(e)._overflowWeeks=true}else if(l!=null){d(e)._overflowWeekday=true}else{a=Mt(i,n,r,o,s);e._a[_]=a.year;e._dayOfYear=a.dayOfYear}}var Mi=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var ki=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var Oi=/Z|[+-]\d\d(?::?\d\d)?/;var Ni=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,false],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,false],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,false],["YYYYDDD",/\d{7}/]];var Ii=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]];var Li=/^\/?Date\((\-?\d+)/i;function Pi(e){var t,i,n=e._i,r=Mi.exec(n)||ki.exec(n),o,s,a,l;if(r){d(e).iso=true;for(t=0,i=Ni.length;t<i;t++){if(Ni[t][1].exec(r[1])){s=Ni[t][0];o=Ni[t][2]!==false;break}}if(s==null){e._isValid=false;return}if(r[3]){for(t=0,i=Ii.length;t<i;t++){if(Ii[t][1].exec(r[3])){a=(r[2]||" ")+Ii[t][0];break}}if(a==null){e._isValid=false;return}}if(!o&&a!=null){e._isValid=false;return}if(r[4]){if(Oi.exec(r[4])){l="Z"}else{e._isValid=false;return}}e._f=s+(a||"")+(l||"");Ui(e)}else{e._isValid=false}}var Fi=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function Gi(e,t,i,n,r,o){var s=[$i(e),gt.indexOf(t),parseInt(i,10),parseInt(n,10),parseInt(r,10)];if(o){s.push(parseInt(o,10))}return s}function $i(e){var t=parseInt(e,10);if(t<=49){return 2e3+t}else if(t<=999){return 1900+t}return t}function Hi(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Bi(e,t,i){if(e){var n=zt.indexOf(e),r=new Date(t[0],t[1],t[2]).getDay();if(n!==r){d(i).weekdayMismatch=true;i._isValid=false;return false}}return true}var Vi={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function ji(e,t,i){if(e){return Vi[e]}else if(t){return 0}else{var n=parseInt(i,10);var r=n%100,o=(n-r)/100;return o*60+r}}function zi(e){var t=Fi.exec(Hi(e._i));if(t){var i=Gi(t[4],t[3],t[2],t[5],t[6],t[7]);if(!Bi(t[1],i,e)){return}e._a=i;e._tzm=ji(t[8],t[9],t[10]);e._d=Dt.apply(null,e._a);e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm);d(e).rfc2822=true}else{e._isValid=false}}function Wi(e){var t=Li.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}Pi(e);if(e._isValid===false){delete e._isValid}else{return}zi(e);if(e._isValid===false){delete e._isValid}else{return}c.createFromInputFallback(e)}c.createFromInputFallback=e("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), "+"which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are "+"discouraged and will be removed in an upcoming major release. Please refer to "+"http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});c.ISO_8601=function(){};c.RFC_2822=function(){};function Ui(e){if(e._f===c.ISO_8601){Pi(e);return}if(e._f===c.RFC_2822){zi(e);return}e._a=[];d(e).empty=true;var t=""+e._i,i,n,r,o,s,a=t.length,l=0;r=Re(e._f,e._locale).match(Ce)||[];for(i=0;i<r.length;i++){o=r[i];n=(t.match(Ue(o,e))||[])[0];if(n){s=t.substr(0,t.indexOf(n));if(s.length>0){d(e).unusedInput.push(s)}t=t.slice(t.indexOf(n)+n.length);l+=n.length}if(Ae[o]){if(n){d(e).empty=false}else{d(e).unusedTokens.push(o)}Ze(o,n,e)}else if(e._strict&&!n){d(e).unusedTokens.push(o)}}d(e).charsLeftOver=a-l;if(t.length>0){d(e).unusedInput.push(t)}if(e._a[x]<=12&&d(e).bigHour===true&&e._a[x]>0){d(e).bigHour=undefined}d(e).parsedDateParts=e._a.slice(0);d(e).meridiem=e._meridiem;e._a[x]=Yi(e._locale,e._a[x],e._meridiem);Di(e);Ai(e)}function Yi(e,t,i){var n;if(i==null){return t}if(e.meridiemHour!=null){return e.meridiemHour(t,i)}else if(e.isPM!=null){n=e.isPM(i);if(n&&t<12){t+=12}if(!n&&t===12){t=0}return t}else{return t}}function qi(e){var t,i,n,r,o;if(e._f.length===0){d(e).invalidFormat=true;e._d=new Date(NaN);return}for(r=0;r<e._f.length;r++){o=0;t=K({},e);if(e._useUTC!=null){t._useUTC=e._useUTC}t._f=e._f[r];Ui(t);if(!U(t)){continue}o+=d(t).charsLeftOver;o+=d(t).unusedTokens.length*10;d(t).score=o;if(n==null||o<n){n=o;i=t}}j(e,i||t)}function Ki(e){if(e._d){return}var t=be(e._i);e._a=V([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)});Di(e)}function Xi(e){var t=new Z(Ai(Zi(e)));if(t._nextDay){t.add(1,"d");t._nextDay=undefined}return t}function Zi(e){var t=e._i,i=e._f;e._locale=e._locale||xi(e._l);if(t===null||i===undefined&&t===""){return Y({nullInput:true})}if(typeof t==="string"){e._i=t=e._locale.preparse(t)}if(l(t)){return new Z(Ai(t))}else if(B(t)){e._d=t}else if(s(i)){qi(e)}else if(i){Ui(e)}else{Qi(e)}if(!U(e)){e._d=null}return e}function Qi(e){var t=e._i;if(o(t)){e._d=new Date(c.now())}else if(B(t)){e._d=new Date(t.valueOf())}else if(typeof t==="string"){Wi(e)}else if(s(t)){e._a=V(t.slice(0),function(e){return parseInt(e,10)});Di(e)}else if(G(t)){Ki(e)}else if(H(t)){e._d=new Date(t)}else{c.createFromInputFallback(e)}}function Ji(e,t,i,n,r){var o={};if(i===true||i===false){n=i;i=undefined}if(G(e)&&$(e)||s(e)&&e.length===0){e=undefined}o._isAMomentObject=true;o._useUTC=o._isUTC=r;o._l=i;o._i=e;o._f=t;o._strict=n;return Xi(o)}function D(e,t,i,n){return Ji(e,t,i,n,false)}var en=e("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=D.apply(null,arguments);if(this.isValid()&&e.isValid()){return e<this?this:e}else{return Y()}});var tn=e("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=D.apply(null,arguments);if(this.isValid()&&e.isValid()){return e>this?this:e}else{return Y()}});function nn(e,t){var i,n;if(t.length===1&&s(t[0])){t=t[0]}if(!t.length){return D()}i=t[0];for(n=1;n<t.length;++n){if(!t[n].isValid()||t[n][e](i)){i=t[n]}}return i}function rn(){var e=[].slice.call(arguments,0);return nn("isBefore",e)}function on(){var e=[].slice.call(arguments,0);return nn("isAfter",e)}var sn=function(){return Date.now?Date.now():+new Date};var an=["year","quarter","month","week","day","hour","minute","second","millisecond"];function ln(e){for(var t in e){if(!(E.call(an,t)!==-1&&(e[t]==null||!isNaN(e[t])))){return false}}var i=false;for(var n=0;n<an.length;++n){if(e[an[n]]){if(i){return false}if(parseFloat(e[an[n]])!==h(e[an[n]])){i=true}}}return true}function cn(){return this._isValid}function un(){return R(NaN)}function dn(e){var t=be(e),i=t.year||0,n=t.quarter||0,r=t.month||0,o=t.week||t.isoWeek||0,s=t.day||0,a=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._isValid=ln(t);this._milliseconds=+u+c*1e3+l*6e4+a*1e3*60*60;this._days=+s+o*7;this._months=+r+n*3+i*12;this._data={};this._locale=xi();this._bubble()}function hn(e){return e instanceof dn}function fn(e){if(e<0){return Math.round(-1*e)*-1}else{return Math.round(e)}}function pn(e,i){n(e,0,0,function(){var e=this.utcOffset();var t="+";if(e<0){e=-e;t="-"}return t+g(~~(e/60),2)+i+g(~~e%60,2)})}pn("Z",":");pn("ZZ","");y("Z",Ve);y("ZZ",Ve);b(["Z","ZZ"],function(e,t,i){i._useUTC=true;i._tzm=mn(Ve,e)});var gn=/([\+\-]|\d\d)/gi;function mn(e,t){var i=(t||"").match(e);if(i===null){return null}var n=i[i.length-1]||[];var r=(n+"").match(gn)||["-",0,0];var o=+(r[1]*60)+h(r[2]);return o===0?0:r[0]==="+"?o:-o}function vn(e,t){var i,n;if(t._isUTC){i=t.clone();n=(l(e)||B(e)?e.valueOf():D(e).valueOf())-i.valueOf();i._d.setTime(i._d.valueOf()+n);c.updateOffset(i,false);return i}else{return D(e).local()}}function yn(e){return-Math.round(e._d.getTimezoneOffset()/15)*15}c.updateOffset=function(){};function bn(e,t,i){var n=this._offset||0,r;if(!this.isValid()){return e!=null?this:NaN}if(e!=null){if(typeof e==="string"){e=mn(Ve,e);if(e===null){return this}}else if(Math.abs(e)<16&&!i){e=e*60}if(!this._isUTC&&t){r=yn(this)}this._offset=e;this._isUTC=true;if(r!=null){this.add(r,"m")}if(n!==e){if(!t||this._changeInProgress){Pn(this,R(e-n,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;c.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?n:yn(this)}}function _n(e,t){if(e!=null){if(typeof e!=="string"){e=-e}this.utcOffset(e,t);return this}else{return-this.utcOffset()}}function wn(e){return this.utcOffset(0,e)}function Cn(e){if(this._isUTC){this.utcOffset(0,e);this._isUTC=false;if(e){this.subtract(yn(this),"m")}}return this}function xn(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true)}else if(typeof this._i==="string"){var e=mn(Be,this._i);if(e!=null){this.utcOffset(e)}else{this.utcOffset(0,true)}}return this}function Sn(e){if(!this.isValid()){return false}e=e?D(e).utcOffset():0;return(this.utcOffset()-e)%60===0}function An(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function En(){if(!o(this._isDSTShifted)){return this._isDSTShifted}var e={};K(e,this);e=Zi(e);if(e._a){var t=e._isUTC?u(e._a):D(e._a);this._isDSTShifted=this.isValid()&&Q(e._a,t.toArray())>0}else{this._isDSTShifted=false}return this._isDSTShifted}function Tn(){return this.isValid()?!this._isUTC:false}function Dn(){return this.isValid()?this._isUTC:false}function Rn(){return this.isValid()?this._isUTC&&this._offset===0:false}var Mn=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/;var kn=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function R(e,t){var i=e,n=null,r,o,s;if(hn(e)){i={ms:e._milliseconds,d:e._days,M:e._months}}else if(H(e)){i={};if(t){i[t]=e}else{i.milliseconds=e}}else if(!!(n=Mn.exec(e))){r=n[1]==="-"?-1:1;i={y:0,d:h(n[C])*r,h:h(n[x])*r,m:h(n[S])*r,s:h(n[A])*r,ms:h(fn(n[Qe]*1e3))*r}}else if(!!(n=kn.exec(e))){r=n[1]==="-"?-1:1;i={y:On(n[2],r),M:On(n[3],r),w:On(n[4],r),d:On(n[5],r),h:On(n[6],r),m:On(n[7],r),s:On(n[8],r)}}else if(i==null){i={}}else if(typeof i==="object"&&("from"in i||"to"in i)){s=In(D(i.from),D(i.to));i={};i.ms=s.milliseconds;i.M=s.months}o=new dn(i);if(hn(e)&&a(e,"_locale")){o._locale=e._locale}return o}R.fn=dn.prototype;R.invalid=un;function On(e,t){var i=e&&parseFloat(e.replace(",","."));return(isNaN(i)?0:i)*t}function Nn(e,t){var i={};i.months=t.month()-e.month()+(t.year()-e.year())*12;if(e.clone().add(i.months,"M").isAfter(t)){--i.months}i.milliseconds=+t-+e.clone().add(i.months,"M");return i}function In(e,t){var i;if(!(e.isValid()&&t.isValid())){return{milliseconds:0,months:0}}t=vn(t,e);if(e.isBefore(t)){i=Nn(e,t)}else{i=Nn(t,e);i.milliseconds=-i.milliseconds;i.months=-i.months}return i}function Ln(r,o){return function(e,t){var i,n;if(t!==null&&!isNaN(+t)){te(o,"moment()."+o+"(period, number) is deprecated. Please use moment()."+o+"(number, period). "+"See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");n=e;e=t;t=n}e=typeof e==="string"?+e:e;i=R(e,t);Pn(this,i,r);return this}}function Pn(e,t,i,n){var r=t._milliseconds,o=fn(t._days),s=fn(t._months);if(!e.isValid()){return}n=n==null?true:n;if(s){bt(e,st(e,"Month")+s*i)}if(o){at(e,"Date",st(e,"Date")+o*i)}if(r){e._d.setTime(e._d.valueOf()+r*i)}if(n){c.updateOffset(e,o||s)}}var Fn=Ln(1,"add");var Gn=Ln(-1,"subtract");function $n(e,t){var i=e.diff(t,"days",true);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"}function Hn(e,t){var i=e||D(),n=vn(i,this).startOf("day"),r=c.calendarFormat(this,n)||"sameElse";var o=t&&(f(t[r])?t[r].call(this,i):t[r]);return this.format(o||this.localeData().calendar(r,this,D(i)))}function Bn(){return new Z(this)}function Vn(e,t){var i=l(e)?e:D(e);if(!(this.isValid()&&i.isValid())){return false}t=p(t)||"millisecond";if(t==="millisecond"){return this.valueOf()>i.valueOf()}else{return i.valueOf()<this.clone().startOf(t).valueOf()}}function jn(e,t){var i=l(e)?e:D(e);if(!(this.isValid()&&i.isValid())){return false}t=p(t)||"millisecond";if(t==="millisecond"){return this.valueOf()<i.valueOf()}else{return this.clone().endOf(t).valueOf()<i.valueOf()}}function zn(e,t,i,n){var r=l(e)?e:D(e),o=l(t)?t:D(t);if(!(this.isValid()&&r.isValid()&&o.isValid())){return false}n=n||"()";return(n[0]==="("?this.isAfter(r,i):!this.isBefore(r,i))&&(n[1]===")"?this.isBefore(o,i):!this.isAfter(o,i))}function Wn(e,t){var i=l(e)?e:D(e),n;if(!(this.isValid()&&i.isValid())){return false}t=p(t)||"millisecond";if(t==="millisecond"){return this.valueOf()===i.valueOf()}else{n=i.valueOf();return this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()}}function Un(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Yn(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function qn(e,t,i){var n,r,o;if(!this.isValid()){return NaN}n=vn(e,this);if(!n.isValid()){return NaN}r=(n.utcOffset()-this.utcOffset())*6e4;t=p(t);switch(t){case"year":o=Kn(this,n)/12;break;case"month":o=Kn(this,n);break;case"quarter":o=Kn(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-r)/864e5;break;case"week":o=(this-n-r)/6048e5;break;default:o=this-n}return i?o:v(o)}function Kn(e,t){var i=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(i,"months"),r,o;if(t-n<0){r=e.clone().add(i-1,"months");o=(t-n)/(n-r)}else{r=e.clone().add(i+1,"months");o=(t-n)/(r-n)}return-(i+o)||0}c.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";c.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Xn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Zn(e){if(!this.isValid()){return null}var t=e!==true;var i=t?this.clone().utc():this;if(i.year()<0||i.year()>9999){return De(i,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ")}if(f(Date.prototype.toISOString)){if(t){return this.toDate().toISOString()}else{return new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",De(i,"Z"))}}return De(i,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Qn(){if(!this.isValid()){return"moment.invalid(/* "+this._i+" */)"}var e="moment";var t="";if(!this.isLocal()){e=this.utcOffset()===0?"moment.utc":"moment.parseZone";t="Z"}var i="["+e+'("]';var n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";var r="-MM-DD[T]HH:mm:ss.SSS";var o=t+'[")]';return this.format(i+n+r+o)}function Jn(e){if(!e){e=this.isUtc()?c.defaultFormatUtc:c.defaultFormat}var t=De(this,e);return this.localeData().postformat(t)}function er(e,t){if(this.isValid()&&(l(e)&&e.isValid()||D(e).isValid())){return R({to:this,from:e}).locale(this.locale()).humanize(!t)}else{return this.localeData().invalidDate()}}function tr(e){return this.from(D(),e)}function ir(e,t){if(this.isValid()&&(l(e)&&e.isValid()||D(e).isValid())){return R({from:this,to:e}).locale(this.locale()).humanize(!t)}else{return this.localeData().invalidDate()}}function nr(e){return this.to(D(),e)}function rr(e){var t;if(e===undefined){return this._locale._abbr}else{t=xi(e);if(t!=null){this._locale=t}return this}}var or=e("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){if(e===undefined){return this.localeData()}else{return this.locale(e)}});function sr(){return this._locale}var ar=1e3;var lr=60*ar;var cr=60*lr;var ur=(365*400+97)*24*cr;function dr(e,t){return(e%t+t)%t}function hr(e,t,i){if(e<100&&e>=0){return new Date(e+400,t,i)-ur}else{return new Date(e,t,i).valueOf()}}function fr(e,t,i){if(e<100&&e>=0){return Date.UTC(e+400,t,i)-ur}else{return Date.UTC(e,t,i)}}function pr(e){var t;e=p(e);if(e===undefined||e==="millisecond"||!this.isValid()){return this}var i=this._isUTC?fr:hr;switch(e){case"year":t=i(this.year(),0,1);break;case"quarter":t=i(this.year(),this.month()-this.month()%3,1);break;case"month":t=i(this.year(),this.month(),1);break;case"week":t=i(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=i(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf();t-=dr(t+(this._isUTC?0:this.utcOffset()*lr),cr);break;case"minute":t=this._d.valueOf();t-=dr(t,lr);break;case"second":t=this._d.valueOf();t-=dr(t,ar);break}this._d.setTime(t);c.updateOffset(this,true);return this}function gr(e){var t;e=p(e);if(e===undefined||e==="millisecond"||!this.isValid()){return this}var i=this._isUTC?fr:hr;switch(e){case"year":t=i(this.year()+1,0,1)-1;break;case"quarter":t=i(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=i(this.year(),this.month()+1,1)-1;break;case"week":t=i(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=i(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf();t+=cr-dr(t+(this._isUTC?0:this.utcOffset()*lr),cr)-1;break;case"minute":t=this._d.valueOf();t+=lr-dr(t,lr)-1;break;case"second":t=this._d.valueOf();t+=ar-dr(t,ar)-1;break}this._d.setTime(t);c.updateOffset(this,true);return this}function mr(){return this._d.valueOf()-(this._offset||0)*6e4}function vr(){return Math.floor(this.valueOf()/1e3)}function yr(){return new Date(this.valueOf())}function br(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function _r(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function wr(){return this.isValid()?this.toISOString():null}function Cr(){return U(this)}function xr(){return j({},d(this))}function Sr(){return d(this).overflow}function Ar(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}n(0,["gg",2],0,function(){return this.weekYear()%100});n(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Er(e,t){n(0,[e,e.length],0,t)}Er("gggg","weekYear");Er("ggggg","weekYear");Er("GGGG","isoWeekYear");Er("GGGGG","isoWeekYear");t("weekYear","gg");t("isoWeekYear","GG");i("weekYear",1);i("isoWeekYear",1);y("G",He);y("g",He);y("GG",m,r);y("gg",m,r);y("GGGG",Fe,Oe);y("gggg",Fe,Oe);y("GGGGG",Ge,Ne);y("ggggg",Ge,Ne);Xe(["gggg","ggggg","GGGG","GGGGG"],function(e,t,i,n){t[n.substr(0,2)]=h(e)});Xe(["gg","GG"],function(e,t,i,n){t[n]=c.parseTwoDigitYear(e)});function Tr(e){return kr.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Dr(e){return kr.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Rr(){return Ot(this.year(),1,4)}function Mr(){var e=this.localeData()._week;return Ot(this.year(),e.dow,e.doy)}function kr(e,t,i,n,r){var o;if(e==null){return kt(this,n,r).year}else{o=Ot(e,n,r);if(t>o){t=o}return Or.call(this,e,t,i,n,r)}}function Or(e,t,i,n,r){var o=Mt(e,t,i,n,r),s=Dt(o.year,0,o.dayOfYear);this.year(s.getUTCFullYear());this.month(s.getUTCMonth());this.date(s.getUTCDate());return this}n("Q",0,"Qo","quarter");t("quarter","Q");i("quarter",7);y("Q",Me);b("Q",function(e,t){t[w]=(h(e)-1)*3});function Nr(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}n("D",["DD",2],"Do","date");t("date","D");i("date",9);y("D",m);y("DD",m,r);y("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});b(["D","DD"],C);b("Do",function(e,t){t[C]=h(e.match(m)[0])});var Ir=ot("Date",true);n("DDD",["DDDD",3],"DDDo","dayOfYear");t("dayOfYear","DDD");i("dayOfYear",4);y("DDD",Pe);y("DDDD",ke);b(["DDD","DDDD"],function(e,t,i){i._dayOfYear=h(e)});function Lr(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}n("m",["mm",2],0,"minute");t("minute","m");i("minute",14);y("m",m);y("mm",m,r);b(["m","mm"],S);var Pr=ot("Minutes",false);n("s",["ss",2],0,"second");t("second","s");i("second",15);y("s",m);y("ss",m,r);b(["s","ss"],A);var Fr=ot("Seconds",false);n("S",0,0,function(){return~~(this.millisecond()/100)});n(0,["SS",2],0,function(){return~~(this.millisecond()/10)});n(0,["SSS",3],0,"millisecond");n(0,["SSSS",4],0,function(){return this.millisecond()*10});n(0,["SSSSS",5],0,function(){return this.millisecond()*100});n(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});n(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});n(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});n(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});t("millisecond","ms");i("millisecond",16);y("S",Pe,Me);y("SS",Pe,r);y("SSS",Pe,ke);var Gr;for(Gr="SSSS";Gr.length<=9;Gr+="S"){y(Gr,$e)}function $r(e,t){t[Qe]=h(("0."+e)*1e3)}for(Gr="S";Gr.length<=9;Gr+="S"){b(Gr,$r)}var Hr=ot("Milliseconds",false);n("z",0,0,"zoneAbbr");n("zz",0,0,"zoneName");function Br(){return this._isUTC?"UTC":""}function Vr(){return this._isUTC?"Coordinated Universal Time":""}var M=Z.prototype;M.add=Fn;M.calendar=Hn;M.clone=Bn;M.diff=qn;M.endOf=gr;M.format=Jn;M.from=er;M.fromNow=tr;M.to=ir;M.toNow=nr;M.get=lt;M.invalidAt=Sr;M.isAfter=Vn;M.isBefore=jn;M.isBetween=zn;M.isSame=Wn;M.isSameOrAfter=Un;M.isSameOrBefore=Yn;M.isValid=Cr;M.lang=or;M.locale=rr;M.localeData=sr;M.max=tn;M.min=en;M.parsingFlags=xr;M.set=ct;M.startOf=pr;M.subtract=Gn;M.toArray=br;M.toObject=_r;M.toDate=yr;M.toISOString=Zn;M.inspect=Qn;M.toJSON=wr;M.toString=Xn;M.unix=vr;M.valueOf=mr;M.creationData=Ar;M.year=nt;M.isLeapYear=rt;M.weekYear=Tr;M.isoWeekYear=Dr;M.quarter=M.quarters=Nr;M.month=_t;M.daysInMonth=wt;M.week=M.weeks=Ft;M.isoWeek=M.isoWeeks=Gt;M.weeksInYear=Mr;M.isoWeeksInYear=Rr;M.date=Ir;M.day=M.days=Xt;M.weekday=Zt;M.isoWeekday=Qt;M.dayOfYear=Lr;M.hour=M.hours=fi;M.minute=M.minutes=Pr;M.second=M.seconds=Fr;M.millisecond=M.milliseconds=Hr;M.utcOffset=bn;M.utc=wn;M.local=Cn;M.parseZone=xn;M.hasAlignedHourOffset=Sn;M.isDST=An;M.isLocal=Tn;M.isUtcOffset=Dn;M.isUtc=Rn;M.isUTC=Rn;M.zoneAbbr=Br;M.zoneName=Vr;M.dates=e("dates accessor is deprecated. Use date instead.",Ir);M.months=e("months accessor is deprecated. Use month instead",_t);M.years=e("years accessor is deprecated. Use year instead",nt);M.zone=e("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",_n);M.isDSTShifted=e("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",En);function jr(e){return D(e*1e3)}function zr(){return D.apply(null,arguments).parseZone()}function Wr(e){return e}var k=re.prototype;k.calendar=ae;k.longDateFormat=ce;k.invalidDate=de;k.ordinal=pe;k.preparse=Wr;k.postformat=Wr;k.relativeTime=me;k.pastFuture=ve;k.set=ie;k.months=pt;k.monthsShort=mt;k.monthsParse=yt;k.monthsRegex=At;k.monthsShortRegex=xt;k.week=Nt;k.firstDayOfYear=Pt;k.firstDayOfWeek=Lt;k.weekdays=jt;k.weekdaysMin=Yt;k.weekdaysShort=Wt;k.weekdaysParse=Kt;k.weekdaysRegex=ei;k.weekdaysShortRegex=ii;k.weekdaysMinRegex=ri;k.isPM=ui;k.meridiem=hi;function Ur(e,t,i,n){var r=xi();var o=u().set(n,t);return r[i](o,e)}function Yr(e,t,i){if(H(e)){t=e;e=undefined}e=e||"";if(t!=null){return Ur(e,t,i,"month")}var n;var r=[];for(n=0;n<12;n++){r[n]=Ur(e,n,i,"month")}return r}function qr(e,t,i,n){if(typeof e==="boolean"){if(H(t)){i=t;t=undefined}t=t||""}else{t=e;i=t;e=false;if(H(t)){i=t;t=undefined}t=t||""}var r=xi(),o=e?r._week.dow:0;if(i!=null){return Ur(t,(i+o)%7,n,"day")}var s;var a=[];for(s=0;s<7;s++){a[s]=Ur(t,(s+o)%7,n,"day")}return a}function Kr(e,t){return Yr(e,t,"months")}function Xr(e,t){return Yr(e,t,"monthsShort")}function Zr(e,t,i){return qr(e,t,i,"weekdays")}function Qr(e,t,i){return qr(e,t,i,"weekdaysShort")}function Jr(e,t,i){return qr(e,t,i,"weekdaysMin")}_i("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,i=h(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+i}});c.lang=e("moment.lang is deprecated. Use moment.locale instead.",_i);c.langData=e("moment.langData is deprecated. Use moment.localeData instead.",xi);var O=Math.abs;function eo(){var e=this._data;this._milliseconds=O(this._milliseconds);this._days=O(this._days);this._months=O(this._months);e.milliseconds=O(e.milliseconds);e.seconds=O(e.seconds);e.minutes=O(e.minutes);e.hours=O(e.hours);e.months=O(e.months);e.years=O(e.years);return this}function to(e,t,i,n){var r=R(t,i);e._milliseconds+=n*r._milliseconds;e._days+=n*r._days;e._months+=n*r._months;return e._bubble()}function io(e,t){return to(this,e,t,1)}function no(e,t){return to(this,e,t,-1)}function ro(e){if(e<0){return Math.floor(e)}else{return Math.ceil(e)}}function oo(){var e=this._milliseconds;var t=this._days;var i=this._months;var n=this._data;var r,o,s,a,l;if(!(e>=0&&t>=0&&i>=0||e<=0&&t<=0&&i<=0)){e+=ro(ao(i)+t)*864e5;t=0;i=0}n.milliseconds=e%1e3;r=v(e/1e3);n.seconds=r%60;o=v(r/60);n.minutes=o%60;s=v(o/60);n.hours=s%24;t+=v(s/24);l=v(so(t));i+=l;t-=ro(ao(l));a=v(i/12);i%=12;n.days=t;n.months=i;n.years=a;return this}function so(e){return e*4800/146097}function ao(e){return e*146097/4800}function lo(e){if(!this.isValid()){return NaN}var t;var i;var n=this._milliseconds;e=p(e);if(e==="month"||e==="quarter"||e==="year"){t=this._days+n/864e5;i=this._months+so(t);switch(e){case"month":return i;case"quarter":return i/3;case"year":return i/12}}else{t=this._days+Math.round(ao(this._months));switch(e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}}function co(){if(!this.isValid()){return NaN}return this._milliseconds+this._days*864e5+this._months%12*2592e6+h(this._months/12)*31536e6}function N(e){return function(){return this.as(e)}}var uo=N("ms");var ho=N("s");var fo=N("m");var po=N("h");var go=N("d");var mo=N("w");var vo=N("M");var yo=N("Q");var bo=N("y");function _o(){return R(this)}function wo(e){e=p(e);return this.isValid()?this[e+"s"]():NaN}function Co(e){return function(){return this.isValid()?this._data[e]:NaN}}var xo=Co("milliseconds");var So=Co("seconds");var Ao=Co("minutes");var Eo=Co("hours");var To=Co("days");var Do=Co("months");var Ro=Co("years");function Mo(){return v(this.days()/7)}var ko=Math.round;var I={ss:44,s:45,m:45,h:22,d:26,M:11};function Oo(e,t,i,n,r){return r.relativeTime(t||1,!!i,e,n)}function No(e,t,i){var n=R(e).abs();var r=ko(n.as("s"));var o=ko(n.as("m"));var s=ko(n.as("h"));var a=ko(n.as("d"));var l=ko(n.as("M"));var c=ko(n.as("y"));var u=r<=I.ss&&["s",r]||r<I.s&&["ss",r]||o<=1&&["m"]||o<I.m&&["mm",o]||s<=1&&["h"]||s<I.h&&["hh",s]||a<=1&&["d"]||a<I.d&&["dd",a]||l<=1&&["M"]||l<I.M&&["MM",l]||c<=1&&["y"]||["yy",c];u[2]=t;u[3]=+e>0;u[4]=i;return Oo.apply(null,u)}function Io(e){if(e===undefined){return ko}if(typeof e==="function"){ko=e;return true}return false}function Lo(e,t){if(I[e]===undefined){return false}if(t===undefined){return I[e]}I[e]=t;if(e==="s"){I.ss=t-1}return true}function Po(e){if(!this.isValid()){return this.localeData().invalidDate()}var t=this.localeData();var i=No(this,!e,t);if(e){i=t.pastFuture(+this,i)}return t.postformat(i)}var Fo=Math.abs;function Go(e){return(e>0)-(e<0)||+e}function $o(){if(!this.isValid()){return this.localeData().invalidDate()}var e=Fo(this._milliseconds)/1e3;var t=Fo(this._days);var i=Fo(this._months);var n,r,o;n=v(e/60);r=v(n/60);e%=60;n%=60;o=v(i/12);i%=12;var s=o;var a=i;var l=t;var c=r;var u=n;var d=e?e.toFixed(3).replace(/\.?0+$/,""):"";var h=this.asSeconds();if(!h){return"P0D"}var f=h<0?"-":"";var p=Go(this._months)!==Go(h)?"-":"";var g=Go(this._days)!==Go(h)?"-":"";var m=Go(this._milliseconds)!==Go(h)?"-":"";return f+"P"+(s?p+s+"Y":"")+(a?p+a+"M":"")+(l?g+l+"D":"")+(c||u||d?"T":"")+(c?m+c+"H":"")+(u?m+u+"M":"")+(d?m+d+"S":"")}var L=dn.prototype;L.isValid=cn;L.abs=eo;L.add=io;L.subtract=no;L.as=lo;L.asMilliseconds=uo;L.asSeconds=ho;L.asMinutes=fo;L.asHours=po;L.asDays=go;L.asWeeks=mo;L.asMonths=vo;L.asQuarters=yo;L.asYears=bo;L.valueOf=co;L._bubble=oo;L.clone=_o;L.get=wo;L.milliseconds=xo;L.seconds=So;L.minutes=Ao;L.hours=Eo;L.days=To;L.weeks=Mo;L.months=Do;L.years=Ro;L.humanize=Po;L.toISOString=$o;L.toString=$o;L.toJSON=$o;L.locale=rr;L.localeData=sr;L.toIsoString=e("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",$o);L.lang=or;n("X",0,0,"unix");n("x",0,0,"valueOf");y("x",He);y("X",je);b("X",function(e,t,i){i._d=new Date(parseFloat(e,10)*1e3)});b("x",function(e,t,i){i._d=new Date(h(e))});c.version="2.24.0";F(D);c.fn=M;c.min=rn;c.max=on;c.now=sn;c.utc=u;c.unix=jr;c.months=Kr;c.isDate=B;c.locale=_i;c.invalid=Y;c.duration=R;c.isMoment=l;c.weekdays=Zr;c.parseZone=zr;c.localeData=xi;c.isDuration=hn;c.monthsShort=Xr;c.weekdaysMin=Jr;c.defineLocale=wi;c.updateLocale=Ci;c.locales=Si;c.weekdaysShort=Qr;c.normalizeUnits=p;c.relativeTimeRounding=Io;c.relativeTimeThreshold=Lo;c.calendarFormat=$n;c.prototype=M;c.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};return c});(function(e,t){"use strict";if(typeof module==="object"&&module.exports){module.exports=t(require("moment"))}else if(typeof define==="function"&&define.amd){define(["moment"],t)}else{t(e.moment)}})(this,function(o){"use strict";var e="0.5.25",s={},a={},c={},l={},t;if(!o||typeof o.version!=="string"){M("Moment Timezone requires Moment.js. See https://momentjs.com/timezone/docs/#/use-it/browser/")}var i=o.version.split("."),n=+i[0],r=+i[1];if(n<2||n===2&&r<6){M("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+o.version+". See momentjs.com")}function u(e){if(e>96){return e-87}else if(e>64){return e-29}return e-48}function d(e){var t=0,i=e.split("."),n=i[0],r=i[1]||"",o=1,s,a=0,l=1;if(e.charCodeAt(0)===45){t=1;l=-1}for(t;t<n.length;t++){s=u(n.charCodeAt(t));a=60*a+s}for(t=0;t<r.length;t++){o=o/60;s=u(r.charCodeAt(t));a+=s*o}return a*l}function h(e){for(var t=0;t<e.length;t++){e[t]=d(e[t])}}function f(e,t){for(var i=0;i<t;i++){e[i]=Math.round((e[i-1]||0)+e[i]*6e4)}e[t-1]=Infinity}function p(e,t){var i=[],n;for(n=0;n<t.length;n++){i[n]=e[t[n]]}return i}function g(e){var t=e.split("|"),i=t[2].split(" "),n=t[3].split(""),r=t[4].split(" ");h(i);h(n);h(r);f(r,n.length);return{name:t[0],abbrs:p(t[1].split(" "),n),offsets:p(i,n),untils:r,population:t[5]|0}}function m(e){if(e){this._set(g(e))}}m.prototype={_set:function(e){this.name=e.name;this.abbrs=e.abbrs;this.untils=e.untils;this.offsets=e.offsets;this.population=e.population},_index:function(e){var t=+e,i=this.untils,n;for(n=0;n<i.length;n++){if(t<i[n]){return n}}},parse:function(e){var t=+e,i=this.offsets,n=this.untils,r=n.length-1,o,s,a,l;for(l=0;l<r;l++){o=i[l];s=i[l+1];a=i[l?l-1:l];if(o<s&&k.moveAmbiguousForward){o=s}else if(o>a&&k.moveInvalidForward){o=a}if(t<n[l]-o*6e4){return i[l]}}return i[r]},abbr:function(e){return this.abbrs[this._index(e)]},offset:function(e){M("zone.offset has been deprecated in favor of zone.utcOffset");return this.offsets[this._index(e)]},utcOffset:function(e){return this.offsets[this._index(e)]}};function v(e){var t=e.toTimeString();var i=t.match(/\([a-z ]+\)/i);if(i&&i[0]){i=i[0].match(/[A-Z]/g);i=i?i.join(""):undefined}else{i=t.match(/[A-Z]{3,5}/g);i=i?i[0]:undefined}if(i==="GMT"){i=undefined}this.at=+e;this.abbr=i;this.offset=e.getTimezoneOffset()}function y(e){this.zone=e;this.offsetScore=0;this.abbrScore=0}y.prototype.scoreOffsetAt=function(e){this.offsetScore+=Math.abs(this.zone.utcOffset(e.at)-e.offset);if(this.zone.abbr(e.at).replace(/[^A-Z]/g,"")!==e.abbr){this.abbrScore++}};function b(e,t){var i,n;while(n=((t.at-e.at)/12e4|0)*6e4){i=new v(new Date(e.at+n));if(i.offset===e.offset){e=i}else{t=i}}return e}function _(){var e=(new Date).getFullYear()-2,t=new v(new Date(e,0,1)),i=[t],n,r,o;for(o=1;o<48;o++){r=new v(new Date(e,o,1));if(r.offset!==t.offset){n=b(t,r);i.push(n);i.push(new v(new Date(n.at+6e4)))}t=r}for(o=0;o<4;o++){i.push(new v(new Date(e+o,0,1)));i.push(new v(new Date(e+o,6,1)))}return i}function w(e,t){if(e.offsetScore!==t.offsetScore){return e.offsetScore-t.offsetScore}if(e.abbrScore!==t.abbrScore){return e.abbrScore-t.abbrScore}return t.zone.population-e.zone.population}function C(e,t){var i,n;h(t);for(i=0;i<t.length;i++){n=t[i];l[n]=l[n]||{};l[n][e]=true}}function P(e){var t=e.length,i={},n=[],r,o,s;for(r=0;r<t;r++){s=l[e[r].offset]||{};for(o in s){if(s.hasOwnProperty(o)){i[o]=true}}}for(r in i){if(i.hasOwnProperty(r)){n.push(c[r])}}return n}function F(){try{var e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(e&&e.length>3){var t=c[x(e)];if(t){return t}M("Moment Timezone found "+e+" from the Intl api, but did not have that data loaded.")}}catch(e){}var i=_(),n=i.length,r=P(i),o=[],s,a,l;for(a=0;a<r.length;a++){s=new y(A(r[a]),n);for(l=0;l<n;l++){s.scoreOffsetAt(i[l])}o.push(s)}o.sort(w);return o.length>0?o[0].zone.name:undefined}function G(e){if(!t||e){t=F()}return t}function x(e){return(e||"").toLowerCase().replace(/\//g,"_")}function S(e){var t,i,n,r;if(typeof e==="string"){e=[e]}for(t=0;t<e.length;t++){n=e[t].split("|");i=n[0];r=x(i);s[r]=e[t];c[r]=i;C(r,n[2].split(" "))}}function A(e,t){e=x(e);var i=s[e];var n;if(i instanceof m){return i}if(typeof i==="string"){i=new m(i);s[e]=i;return i}if(a[e]&&t!==A&&(n=A(a[e],A))){i=s[e]=new m;i._set(n);i.name=c[e];return i}return null}function $(){var e,t=[];for(e in c){if(c.hasOwnProperty(e)&&(s[e]||s[a[e]])&&c[e]){t.push(c[e])}}return t.sort()}function E(e){var t,i,n,r;if(typeof e==="string"){e=[e]}for(t=0;t<e.length;t++){i=e[t].split("|");n=x(i[0]);r=x(i[1]);a[n]=r;c[n]=i[0];a[r]=n;c[r]=i[1]}}function T(e){S(e.zones);E(e.links);k.dataVersion=e.version}function D(e){if(!D.didShowError){D.didShowError=true;M("moment.tz.zoneExists('"+e+"') has been deprecated in favor of !moment.tz.zone('"+e+"')")}return!!A(e)}function R(e){var t=e._f==="X"||e._f==="x";return!!(e._a&&e._tzm===undefined&&!t)}function M(e){if(typeof console!=="undefined"&&typeof console.error==="function"){console.error(e)}}function k(e){var t=Array.prototype.slice.call(arguments,0,-1),i=arguments[arguments.length-1],n=A(i),r=o.utc.apply(null,t);if(n&&!o.isMoment(e)&&R(r)){r.add(n.parse(r),"minutes")}r.tz(i);return r}k.version=e;k.dataVersion="";k._zones=s;k._links=a;k._names=c;k.add=S;k.link=E;k.load=T;k.zone=A;k.zoneExists=D;k.guess=G;k.names=$;k.Zone=m;k.unpack=g;k.unpackBase60=d;k.needsOffset=R;k.moveInvalidForward=true;k.moveAmbiguousForward=false;var O=o.fn;o.tz=k;o.defaultZone=null;o.updateOffset=function(e,t){var i=o.defaultZone,n;if(e._z===undefined){if(i&&R(e)&&!e._isUTC){e._d=o.utc(e._a)._d;e.utc().add(i.parse(e),"minutes")}e._z=i}if(e._z){n=e._z.utcOffset(e);if(Math.abs(n)<16){n=n/60}if(e.utcOffset!==undefined){var r=e._z;e.utcOffset(-n,t);e._z=r}else{e.zone(n,t)}}};O.tz=function(e,t){if(e){if(typeof e!=="string"){throw new Error("Time zone name must be a string, got "+e+" ["+typeof e+"]")}this._z=A(e);if(this._z){o.updateOffset(this,t)}else{M("Moment Timezone has no data for "+e+". See http://momentjs.com/timezone/docs/#/data-loading/.")}return this}if(this._z){return this._z.name}};function N(e){return function(){if(this._z){return this._z.abbr(this)}return e.call(this)}}function I(e){return function(){this._z=null;return e.apply(this,arguments)}}function H(e){return function(){if(arguments.length>0)this._z=null;return e.apply(this,arguments)}}O.zoneName=N(O.zoneName);O.zoneAbbr=N(O.zoneAbbr);O.utc=I(O.utc);O.local=I(O.local);O.utcOffset=H(O.utcOffset);o.tz.setDefault=function(e){if(n<2||n===2&&r<9){M("Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js "+o.version+".")}o.defaultZone=e?A(e):null;return o};var L=o.momentProperties;if(Object.prototype.toString.call(L)==="[object Array]"){L.push("_z");L.push("_a")}else if(L){L._z=null}T({version:"2019a",zones:["Africa/Abidjan|GMT|0|0||48e5","Africa/Nairobi|EAT|-30|0||47e5","Africa/Algiers|CET|-10|0||26e5","Africa/Lagos|WAT|-10|0||17e6","Africa/Maputo|CAT|-20|0||26e5","Africa/Cairo|EET EEST|-20 -30|01010|1M2m0 gL0 e10 mn0|15e6","Africa/Casablanca|+00 +01|0 -10|01010101010101010101010101010101|1LHC0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 28M0 e00 2600 e00 28M0 e00 2600 gM0 2600 e00 28M0 e00|32e5","Europe/Paris|CET CEST|-10 -20|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|11e6","Africa/Johannesburg|SAST|-20|0||84e5","Africa/Khartoum|EAT CAT|-30 -20|01|1Usl0|51e5","Africa/Sao_Tome|GMT WAT|0 -10|010|1UQN0 2q00","Africa/Tripoli|EET|-20|0||11e5","Africa/Windhoek|CAT WAT|-20 -10|010101010|1LKo0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0|32e4","America/Adak|HST HDT|a0 90|01010101010101010101010|1Lzo0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|326","America/Anchorage|AKST AKDT|90 80|01010101010101010101010|1Lzn0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|30e4","America/Santo_Domingo|AST|40|0||29e5","America/Fortaleza|-03|30|0||34e5","America/Asuncion|-03 -04|30 40|01010101010101010101010|1LEP0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1ip0|28e5","America/Panama|EST|50|0||15e5","America/Mexico_City|CST CDT|60 50|01010101010101010101010|1LKw0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0|20e6","America/Managua|CST|60|0||22e5","America/La_Paz|-04|40|0||19e5","America/Lima|-05|50|0||11e6","America/Denver|MST MDT|70 60|01010101010101010101010|1Lzl0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|26e5","America/Campo_Grande|-03 -04|30 40|01010101010101010101010|1LqP0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1HB0 FX0 1HB0 FX0 1HB0 IL0 1HB0 FX0 1HB0 IL0 1EN0 FX0 1HB0|77e4","America/Cancun|CST CDT EST|60 50 50|0102|1LKw0 1lb0 Dd0|63e4","America/Caracas|-0430 -04|4u 40|01|1QMT0|29e5","America/Chicago|CST CDT|60 50|01010101010101010101010|1Lzk0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|92e5","America/Chihuahua|MST MDT|70 60|01010101010101010101010|1LKx0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0|81e4","America/Phoenix|MST|70|0||42e5","America/Los_Angeles|PST PDT|80 70|01010101010101010101010|1Lzm0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|15e6","America/New_York|EST EDT|50 40|01010101010101010101010|1Lzj0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e6","America/Fort_Nelson|PST PDT MST|80 70 70|0102|1Lzm0 1zb0 Op0|39e2","America/Halifax|AST ADT|40 30|01010101010101010101010|1Lzi0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|39e4","America/Godthab|-03 -02|30 20|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|17e3","America/Grand_Turk|EST EDT AST|50 40 40|0101210101010101010|1Lzj0 1zb0 Op0 1zb0 5Ip0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e2","America/Havana|CST CDT|50 40|01010101010101010101010|1Lzh0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0|21e5","America/Metlakatla|PST AKST AKDT|80 90 80|012121201212121212121|1PAa0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 uM0 jB0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|14e2","America/Miquelon|-03 -02|30 20|01010101010101010101010|1Lzh0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|61e2","America/Montevideo|-02 -03|20 30|0101|1Lzg0 1o10 11z0|17e5","America/Noronha|-02|20|0||30e2","America/Port-au-Prince|EST EDT|50 40|010101010101010101010|1Lzj0 1zb0 Op0 1zb0 3iN0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e5","Antarctica/Palmer|-03 -04|30 40|01010|1LSP0 Rd0 46n0 Ap0|40","America/Santiago|-03 -04|30 40|010101010101010101010|1LSP0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1zb0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0|62e5","America/Sao_Paulo|-02 -03|20 30|01010101010101010101010|1LqO0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1HB0 FX0 1HB0 FX0 1HB0 IL0 1HB0 FX0 1HB0 IL0 1EN0 FX0 1HB0|20e6","Atlantic/Azores|-01 +00|10 0|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|25e4","America/St_Johns|NST NDT|3u 2u|01010101010101010101010|1Lzhu 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|11e4","Antarctica/Casey|+08 +11|-80 -b0|010|1RWg0 3m10|10","Asia/Bangkok|+07|-70|0||15e6","Pacific/Port_Moresby|+10|-a0|0||25e4","Pacific/Guadalcanal|+11|-b0|0||11e4","Asia/Tashkent|+05|-50|0||23e5","Pacific/Auckland|NZDT NZST|-d0 -c0|01010101010101010101010|1LKe0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00|14e5","Asia/Baghdad|+03|-30|0||66e5","Antarctica/Troll|+00 +02|0 -20|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|40","Asia/Dhaka|+06|-60|0||16e6","Asia/Amman|EET EEST|-20 -30|01010101010101010101010|1LGK0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|25e5","Asia/Kamchatka|+12|-c0|0||18e4","Asia/Baku|+04 +05|-40 -50|01010|1LHA0 1o00 11A0 1o00|27e5","Asia/Barnaul|+07 +06|-70 -60|010|1N7v0 3rd0","Asia/Beirut|EET EEST|-20 -30|01010101010101010101010|1LHy0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0|22e5","Asia/Kuala_Lumpur|+08|-80|0||71e5","Asia/Kolkata|IST|-5u|0||15e6","Asia/Chita|+10 +08 +09|-a0 -80 -90|012|1N7s0 3re0|33e4","Asia/Ulaanbaatar|+08 +09|-80 -90|01010|1O8G0 1cJ0 1cP0 1cJ0|12e5","Asia/Shanghai|CST|-80|0||23e6","Asia/Colombo|+0530|-5u|0||22e5","Asia/Damascus|EET EEST|-20 -30|01010101010101010101010|1LGK0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0|26e5","Asia/Dili|+09|-90|0||19e4","Asia/Dubai|+04|-40|0||39e5","Asia/Famagusta|EET EEST +03|-20 -30 -30|0101012010101010101010|1LHB0 1o00 11A0 1o00 11A0 15U0 2Ks0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00","Asia/Gaza|EET EEST|-20 -30|01010101010101010101010|1LGK0 1nX0 1210 1nz0 1220 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0|18e5","Asia/Hong_Kong|HKT|-80|0||73e5","Asia/Hovd|+07 +08|-70 -80|01010|1O8H0 1cJ0 1cP0 1cJ0|81e3","Asia/Irkutsk|+09 +08|-90 -80|01|1N7t0|60e4","Europe/Istanbul|EET EEST +03|-20 -30 -30|0101012|1LI10 1nA0 11A0 1tA0 U00 15w0|13e6","Asia/Jakarta|WIB|-70|0||31e6","Asia/Jayapura|WIT|-90|0||26e4","Asia/Jerusalem|IST IDT|-20 -30|01010101010101010101010|1LGM0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0|81e4","Asia/Kabul|+0430|-4u|0||46e5","Asia/Karachi|PKT|-50|0||24e6","Asia/Kathmandu|+0545|-5J|0||12e5","Asia/Yakutsk|+10 +09|-a0 -90|01|1N7s0|28e4","Asia/Krasnoyarsk|+08 +07|-80 -70|01|1N7u0|10e5","Asia/Magadan|+12 +10 +11|-c0 -a0 -b0|012|1N7q0 3Cq0|95e3","Asia/Makassar|WITA|-80|0||15e5","Asia/Manila|PST|-80|0||24e6","Europe/Athens|EET EEST|-20 -30|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|35e5","Asia/Novosibirsk|+07 +06|-70 -60|010|1N7v0 4eN0|15e5","Asia/Omsk|+07 +06|-70 -60|01|1N7v0|12e5","Asia/Pyongyang|KST KST|-90 -8u|010|1P4D0 6BA0|29e5","Asia/Qyzylorda|+06 +05|-60 -50|01|1Xei0|73e4","Asia/Rangoon|+0630|-6u|0||48e5","Asia/Sakhalin|+11 +10|-b0 -a0|010|1N7r0 3rd0|58e4","Asia/Seoul|KST|-90|0||23e6","Asia/Srednekolymsk|+12 +11|-c0 -b0|01|1N7q0|35e2","Asia/Tehran|+0330 +0430|-3u -4u|01010101010101010101010|1LEku 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0|14e6","Asia/Tokyo|JST|-90|0||38e6","Asia/Tomsk|+07 +06|-70 -60|010|1N7v0 3Qp0|10e5","Asia/Vladivostok|+11 +10|-b0 -a0|01|1N7r0|60e4","Asia/Yekaterinburg|+06 +05|-60 -50|01|1N7w0|14e5","Europe/Lisbon|WET WEST|0 -10|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|27e5","Atlantic/Cape_Verde|-01|10|0||50e4","Australia/Sydney|AEDT AEST|-b0 -a0|01010101010101010101010|1LKg0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0|40e5","Australia/Adelaide|ACDT ACST|-au -9u|01010101010101010101010|1LKgu 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0|11e5","Australia/Brisbane|AEST|-a0|0||20e5","Australia/Darwin|ACST|-9u|0||12e4","Australia/Eucla|+0845|-8J|0||368","Australia/Lord_Howe|+11 +1030|-b0 -au|01010101010101010101010|1LKf0 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1fzu 1cMu|347","Australia/Perth|AWST|-80|0||18e5","Pacific/Easter|-05 -06|50 60|010101010101010101010|1LSP0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1zb0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0|30e2","Europe/Dublin|GMT IST|0 -10|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|12e5","Etc/GMT-1|+01|-10|0|","Pacific/Fakaofo|+13|-d0|0||483","Pacific/Kiritimati|+14|-e0|0||51e2","Etc/GMT-2|+02|-20|0|","Pacific/Tahiti|-10|a0|0||18e4","Pacific/Niue|-11|b0|0||12e2","Etc/GMT+12|-12|c0|0|","Pacific/Galapagos|-06|60|0||25e3","Etc/GMT+7|-07|70|0|","Pacific/Pitcairn|-08|80|0||56","Pacific/Gambier|-09|90|0||125","Etc/UTC|UTC|0|0|","Europe/Ulyanovsk|+04 +03|-40 -30|010|1N7y0 3rd0|13e5","Europe/London|GMT BST|0 -10|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|10e6","Europe/Chisinau|EET EEST|-20 -30|01010101010101010101010|1LHA0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00|67e4","Europe/Kaliningrad|+03 EET|-30 -20|01|1N7z0|44e4","Europe/Kirov|+04 +03|-40 -30|01|1N7y0|48e4","Europe/Moscow|MSK MSK|-40 -30|01|1N7y0|16e6","Europe/Saratov|+04 +03|-40 -30|010|1N7y0 5810","Europe/Simferopol|EET MSK MSK|-20 -40 -30|012|1LHA0 1nW0|33e4","Europe/Volgograd|+04 +03|-40 -30|010|1N7y0 9Jd0|10e5","Pacific/Honolulu|HST|a0|0||37e4","MET|MET MEST|-10 -20|01010101010101010101010|1LHB0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00","Pacific/Chatham|+1345 +1245|-dJ -cJ|01010101010101010101010|1LKe0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00|600","Pacific/Apia|+14 +13|-e0 -d0|01010101010101010101010|1LKe0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00|37e3","Pacific/Bougainville|+10 +11|-a0 -b0|01|1NwE0|18e4","Pacific/Fiji|+13 +12|-d0 -c0|01010101010101010101010|1Lfp0 1SN0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 s00 1VA0|88e4","Pacific/Guam|ChST|-a0|0||17e4","Pacific/Marquesas|-0930|9u|0||86e2","Pacific/Pago_Pago|SST|b0|0||37e2","Pacific/Norfolk|+1130 +11|-bu -b0|01|1PoCu|25e4","Pacific/Tongatapu|+13 +14|-d0 -e0|010|1S4d0 s00|75e3"],links:["Africa/Abidjan|Africa/Accra","Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Bissau","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Monrovia","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|America/Danmarkshavn","Africa/Abidjan|Atlantic/Reykjavik","Africa/Abidjan|Atlantic/St_Helena","Africa/Abidjan|Etc/GMT","Africa/Abidjan|Etc/GMT+0","Africa/Abidjan|Etc/GMT-0","Africa/Abidjan|Etc/GMT0","Africa/Abidjan|Etc/Greenwich","Africa/Abidjan|GMT","Africa/Abidjan|GMT+0","Africa/Abidjan|GMT-0","Africa/Abidjan|GMT0","Africa/Abidjan|Greenwich","Africa/Abidjan|Iceland","Africa/Algiers|Africa/Tunis","Africa/Cairo|Egypt","Africa/Casablanca|Africa/El_Aaiun","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Lagos|Africa/Bangui","Africa/Lagos|Africa/Brazzaville","Africa/Lagos|Africa/Douala","Africa/Lagos|Africa/Kinshasa","Africa/Lagos|Africa/Libreville","Africa/Lagos|Africa/Luanda","Africa/Lagos|Africa/Malabo","Africa/Lagos|Africa/Ndjamena","Africa/Lagos|Africa/Niamey","Africa/Lagos|Africa/Porto-Novo","Africa/Maputo|Africa/Blantyre","Africa/Maputo|Africa/Bujumbura","Africa/Maputo|Africa/Gaborone","Africa/Maputo|Africa/Harare","Africa/Maputo|Africa/Kigali","Africa/Maputo|Africa/Lubumbashi","Africa/Maputo|Africa/Lusaka","Africa/Nairobi|Africa/Addis_Ababa","Africa/Nairobi|Africa/Asmara","Africa/Nairobi|Africa/Asmera","Africa/Nairobi|Africa/Dar_es_Salaam","Africa/Nairobi|Africa/Djibouti","Africa/Nairobi|Africa/Juba","Africa/Nairobi|Africa/Kampala","Africa/Nairobi|Africa/Mogadishu","Africa/Nairobi|Indian/Antananarivo","Africa/Nairobi|Indian/Comoro","Africa/Nairobi|Indian/Mayotte","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|America/Juneau","America/Anchorage|America/Nome","America/Anchorage|America/Sitka","America/Anchorage|America/Yakutat","America/Anchorage|US/Alaska","America/Campo_Grande|America/Cuiaba","America/Chicago|America/Indiana/Knox","America/Chicago|America/Indiana/Tell_City","America/Chicago|America/Knox_IN","America/Chicago|America/Matamoros","America/Chicago|America/Menominee","America/Chicago|America/North_Dakota/Beulah","America/Chicago|America/North_Dakota/Center","America/Chicago|America/North_Dakota/New_Salem","America/Chicago|America/Rainy_River","America/Chicago|America/Rankin_Inlet","America/Chicago|America/Resolute","America/Chicago|America/Winnipeg","America/Chicago|CST6CDT","America/Chicago|Canada/Central","America/Chicago|US/Central","America/Chicago|US/Indiana-Starke","America/Chihuahua|America/Mazatlan","America/Chihuahua|Mexico/BajaSur","America/Denver|America/Boise","America/Denver|America/Cambridge_Bay","America/Denver|America/Edmonton","America/Denver|America/Inuvik","America/Denver|America/Ojinaga","America/Denver|America/Shiprock","America/Denver|America/Yellowknife","America/Denver|Canada/Mountain","America/Denver|MST7MDT","America/Denver|Navajo","America/Denver|US/Mountain","America/Fortaleza|America/Araguaina","America/Fortaleza|America/Argentina/Buenos_Aires","America/Fortaleza|America/Argentina/Catamarca","America/Fortaleza|America/Argentina/ComodRivadavia","America/Fortaleza|America/Argentina/Cordoba","America/Fortaleza|America/Argentina/Jujuy","America/Fortaleza|America/Argentina/La_Rioja","America/Fortaleza|America/Argentina/Mendoza","America/Fortaleza|America/Argentina/Rio_Gallegos","America/Fortaleza|America/Argentina/Salta","America/Fortaleza|America/Argentina/San_Juan","America/Fortaleza|America/Argentina/San_Luis","America/Fortaleza|America/Argentina/Tucuman","America/Fortaleza|America/Argentina/Ushuaia","America/Fortaleza|America/Bahia","America/Fortaleza|America/Belem","America/Fortaleza|America/Buenos_Aires","America/Fortaleza|America/Catamarca","America/Fortaleza|America/Cayenne","America/Fortaleza|America/Cordoba","America/Fortaleza|America/Jujuy","America/Fortaleza|America/Maceio","America/Fortaleza|America/Mendoza","America/Fortaleza|America/Paramaribo","America/Fortaleza|America/Recife","America/Fortaleza|America/Rosario","America/Fortaleza|America/Santarem","America/Fortaleza|Antarctica/Rothera","America/Fortaleza|Atlantic/Stanley","America/Fortaleza|Etc/GMT+3","America/Halifax|America/Glace_Bay","America/Halifax|America/Goose_Bay","America/Halifax|America/Moncton","America/Halifax|America/Thule","America/Halifax|Atlantic/Bermuda","America/Halifax|Canada/Atlantic","America/Havana|Cuba","America/La_Paz|America/Boa_Vista","America/La_Paz|America/Guyana","America/La_Paz|America/Manaus","America/La_Paz|America/Porto_Velho","America/La_Paz|Brazil/West","America/La_Paz|Etc/GMT+4","America/Lima|America/Bogota","America/Lima|America/Eirunepe","America/Lima|America/Guayaquil","America/Lima|America/Porto_Acre","America/Lima|America/Rio_Branco","America/Lima|Brazil/Acre","America/Lima|Etc/GMT+5","America/Los_Angeles|America/Dawson","America/Los_Angeles|America/Ensenada","America/Los_Angeles|America/Santa_Isabel","America/Los_Angeles|America/Tijuana","America/Los_Angeles|America/Vancouver","America/Los_Angeles|America/Whitehorse","America/Los_Angeles|Canada/Pacific","America/Los_Angeles|Canada/Yukon","America/Los_Angeles|Mexico/BajaNorte","America/Los_Angeles|PST8PDT","America/Los_Angeles|US/Pacific","America/Los_Angeles|US/Pacific-New","America/Managua|America/Belize","America/Managua|America/Costa_Rica","America/Managua|America/El_Salvador","America/Managua|America/Guatemala","America/Managua|America/Regina","America/Managua|America/Swift_Current","America/Managua|America/Tegucigalpa","America/Managua|Canada/Saskatchewan","America/Mexico_City|America/Bahia_Banderas","America/Mexico_City|America/Merida","America/Mexico_City|America/Monterrey","America/Mexico_City|Mexico/General","America/New_York|America/Detroit","America/New_York|America/Fort_Wayne","America/New_York|America/Indiana/Indianapolis","America/New_York|America/Indiana/Marengo","America/New_York|America/Indiana/Petersburg","America/New_York|America/Indiana/Vevay","America/New_York|America/Indiana/Vincennes","America/New_York|America/Indiana/Winamac","America/New_York|America/Indianapolis","America/New_York|America/Iqaluit","America/New_York|America/Kentucky/Louisville","America/New_York|America/Kentucky/Monticello","America/New_York|America/Louisville","America/New_York|America/Montreal","America/New_York|America/Nassau","America/New_York|America/Nipigon","America/New_York|America/Pangnirtung","America/New_York|America/Thunder_Bay","America/New_York|America/Toronto","America/New_York|Canada/Eastern","America/New_York|EST5EDT","America/New_York|US/East-Indiana","America/New_York|US/Eastern","America/New_York|US/Michigan","America/Noronha|Atlantic/South_Georgia","America/Noronha|Brazil/DeNoronha","America/Noronha|Etc/GMT+2","America/Panama|America/Atikokan","America/Panama|America/Cayman","America/Panama|America/Coral_Harbour","America/Panama|America/Jamaica","America/Panama|EST","America/Panama|Jamaica","America/Phoenix|America/Creston","America/Phoenix|America/Dawson_Creek","America/Phoenix|America/Hermosillo","America/Phoenix|MST","America/Phoenix|US/Arizona","America/Santiago|Chile/Continental","America/Santo_Domingo|America/Anguilla","America/Santo_Domingo|America/Antigua","America/Santo_Domingo|America/Aruba","America/Santo_Domingo|America/Barbados","America/Santo_Domingo|America/Blanc-Sablon","America/Santo_Domingo|America/Curacao","America/Santo_Domingo|America/Dominica","America/Santo_Domingo|America/Grenada","America/Santo_Domingo|America/Guadeloupe","America/Santo_Domingo|America/Kralendijk","America/Santo_Domingo|America/Lower_Princes","America/Santo_Domingo|America/Marigot","America/Santo_Domingo|America/Martinique","America/Santo_Domingo|America/Montserrat","America/Santo_Domingo|America/Port_of_Spain","America/Santo_Domingo|America/Puerto_Rico","America/Santo_Domingo|America/St_Barthelemy","America/Santo_Domingo|America/St_Kitts","America/Santo_Domingo|America/St_Lucia","America/Santo_Domingo|America/St_Thomas","America/Santo_Domingo|America/St_Vincent","America/Santo_Domingo|America/Tortola","America/Santo_Domingo|America/Virgin","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","Antarctica/Palmer|America/Punta_Arenas","Asia/Baghdad|Antarctica/Syowa","Asia/Baghdad|Asia/Aden","Asia/Baghdad|Asia/Bahrain","Asia/Baghdad|Asia/Kuwait","Asia/Baghdad|Asia/Qatar","Asia/Baghdad|Asia/Riyadh","Asia/Baghdad|Etc/GMT-3","Asia/Baghdad|Europe/Minsk","Asia/Bangkok|Antarctica/Davis","Asia/Bangkok|Asia/Ho_Chi_Minh","Asia/Bangkok|Asia/Novokuznetsk","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Saigon","Asia/Bangkok|Asia/Vientiane","Asia/Bangkok|Etc/GMT-7","Asia/Bangkok|Indian/Christmas","Asia/Dhaka|Antarctica/Vostok","Asia/Dhaka|Asia/Almaty","Asia/Dhaka|Asia/Bishkek","Asia/Dhaka|Asia/Dacca","Asia/Dhaka|Asia/Kashgar","Asia/Dhaka|Asia/Qostanay","Asia/Dhaka|Asia/Thimbu","Asia/Dhaka|Asia/Thimphu","Asia/Dhaka|Asia/Urumqi","Asia/Dhaka|Etc/GMT-6","Asia/Dhaka|Indian/Chagos","Asia/Dili|Etc/GMT-9","Asia/Dili|Pacific/Palau","Asia/Dubai|Asia/Muscat","Asia/Dubai|Asia/Tbilisi","Asia/Dubai|Asia/Yerevan","Asia/Dubai|Etc/GMT-4","Asia/Dubai|Europe/Samara","Asia/Dubai|Indian/Mahe","Asia/Dubai|Indian/Mauritius","Asia/Dubai|Indian/Reunion","Asia/Gaza|Asia/Hebron","Asia/Hong_Kong|Hongkong","Asia/Jakarta|Asia/Pontianak","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kamchatka|Asia/Anadyr","Asia/Kamchatka|Etc/GMT-12","Asia/Kamchatka|Kwajalein","Asia/Kamchatka|Pacific/Funafuti","Asia/Kamchatka|Pacific/Kwajalein","Asia/Kamchatka|Pacific/Majuro","Asia/Kamchatka|Pacific/Nauru","Asia/Kamchatka|Pacific/Tarawa","Asia/Kamchatka|Pacific/Wake","Asia/Kamchatka|Pacific/Wallis","Asia/Kathmandu|Asia/Katmandu","Asia/Kolkata|Asia/Calcutta","Asia/Kuala_Lumpur|Asia/Brunei","Asia/Kuala_Lumpur|Asia/Kuching","Asia/Kuala_Lumpur|Asia/Singapore","Asia/Kuala_Lumpur|Etc/GMT-8","Asia/Kuala_Lumpur|Singapore","Asia/Makassar|Asia/Ujung_Pandang","Asia/Rangoon|Asia/Yangon","Asia/Rangoon|Indian/Cocos","Asia/Seoul|ROK","Asia/Shanghai|Asia/Chongqing","Asia/Shanghai|Asia/Chungking","Asia/Shanghai|Asia/Harbin","Asia/Shanghai|Asia/Macao","Asia/Shanghai|Asia/Macau","Asia/Shanghai|Asia/Taipei","Asia/Shanghai|PRC","Asia/Shanghai|ROC","Asia/Tashkent|Antarctica/Mawson","Asia/Tashkent|Asia/Aqtau","Asia/Tashkent|Asia/Aqtobe","Asia/Tashkent|Asia/Ashgabat","Asia/Tashkent|Asia/Ashkhabad","Asia/Tashkent|Asia/Atyrau","Asia/Tashkent|Asia/Dushanbe","Asia/Tashkent|Asia/Oral","Asia/Tashkent|Asia/Samarkand","Asia/Tashkent|Etc/GMT-5","Asia/Tashkent|Indian/Kerguelen","Asia/Tashkent|Indian/Maldives","Asia/Tehran|Iran","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Choibalsan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Asia/Vladivostok|Asia/Ust-Nera","Asia/Yakutsk|Asia/Khandyga","Atlantic/Azores|America/Scoresbysund","Atlantic/Cape_Verde|Etc/GMT+1","Australia/Adelaide|Australia/Broken_Hill","Australia/Adelaide|Australia/South","Australia/Adelaide|Australia/Yancowinna","Australia/Brisbane|Australia/Lindeman","Australia/Brisbane|Australia/Queensland","Australia/Darwin|Australia/North","Australia/Lord_Howe|Australia/LHI","Australia/Perth|Australia/West","Australia/Sydney|Australia/ACT","Australia/Sydney|Australia/Canberra","Australia/Sydney|Australia/Currie","Australia/Sydney|Australia/Hobart","Australia/Sydney|Australia/Melbourne","Australia/Sydney|Australia/NSW","Australia/Sydney|Australia/Tasmania","Australia/Sydney|Australia/Victoria","Etc/UTC|Etc/UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UCT","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Athens|Asia/Nicosia","Europe/Athens|EET","Europe/Athens|Europe/Bucharest","Europe/Athens|Europe/Helsinki","Europe/Athens|Europe/Kiev","Europe/Athens|Europe/Mariehamn","Europe/Athens|Europe/Nicosia","Europe/Athens|Europe/Riga","Europe/Athens|Europe/Sofia","Europe/Athens|Europe/Tallinn","Europe/Athens|Europe/Uzhgorod","Europe/Athens|Europe/Vilnius","Europe/Athens|Europe/Zaporozhye","Europe/Chisinau|Europe/Tiraspol","Europe/Dublin|Eire","Europe/Istanbul|Asia/Istanbul","Europe/Istanbul|Turkey","Europe/Lisbon|Atlantic/Canary","Europe/Lisbon|Atlantic/Faeroe","Europe/Lisbon|Atlantic/Faroe","Europe/Lisbon|Atlantic/Madeira","Europe/Lisbon|Portugal","Europe/Lisbon|WET","Europe/London|Europe/Belfast","Europe/London|Europe/Guernsey","Europe/London|Europe/Isle_of_Man","Europe/London|Europe/Jersey","Europe/London|GB","Europe/London|GB-Eire","Europe/Moscow|W-SU","Europe/Paris|Africa/Ceuta","Europe/Paris|Arctic/Longyearbyen","Europe/Paris|Atlantic/Jan_Mayen","Europe/Paris|CET","Europe/Paris|Europe/Amsterdam","Europe/Paris|Europe/Andorra","Europe/Paris|Europe/Belgrade","Europe/Paris|Europe/Berlin","Europe/Paris|Europe/Bratislava","Europe/Paris|Europe/Brussels","Europe/Paris|Europe/Budapest","Europe/Paris|Europe/Busingen","Europe/Paris|Europe/Copenhagen","Europe/Paris|Europe/Gibraltar","Europe/Paris|Europe/Ljubljana","Europe/Paris|Europe/Luxembourg","Europe/Paris|Europe/Madrid","Europe/Paris|Europe/Malta","Europe/Paris|Europe/Monaco","Europe/Paris|Europe/Oslo","Europe/Paris|Europe/Podgorica","Europe/Paris|Europe/Prague","Europe/Paris|Europe/Rome","Europe/Paris|Europe/San_Marino","Europe/Paris|Europe/Sarajevo","Europe/Paris|Europe/Skopje","Europe/Paris|Europe/Stockholm","Europe/Paris|Europe/Tirane","Europe/Paris|Europe/Vaduz","Europe/Paris|Europe/Vatican","Europe/Paris|Europe/Vienna","Europe/Paris|Europe/Warsaw","Europe/Paris|Europe/Zagreb","Europe/Paris|Europe/Zurich","Europe/Paris|Poland","Europe/Ulyanovsk|Europe/Astrakhan","Pacific/Auckland|Antarctica/McMurdo","Pacific/Auckland|Antarctica/South_Pole","Pacific/Auckland|NZ","Pacific/Chatham|NZ-CHAT","Pacific/Easter|Chile/EasterIsland","Pacific/Fakaofo|Etc/GMT-13","Pacific/Fakaofo|Pacific/Enderbury","Pacific/Galapagos|Etc/GMT+6","Pacific/Gambier|Etc/GMT+9","Pacific/Guadalcanal|Antarctica/Macquarie","Pacific/Guadalcanal|Etc/GMT-11","Pacific/Guadalcanal|Pacific/Efate","Pacific/Guadalcanal|Pacific/Kosrae","Pacific/Guadalcanal|Pacific/Noumea","Pacific/Guadalcanal|Pacific/Pohnpei","Pacific/Guadalcanal|Pacific/Ponape","Pacific/Guam|Pacific/Saipan","Pacific/Honolulu|HST","Pacific/Honolulu|Pacific/Johnston","Pacific/Honolulu|US/Hawaii","Pacific/Kiritimati|Etc/GMT-14","Pacific/Niue|Etc/GMT+11","Pacific/Pago_Pago|Pacific/Midway","Pacific/Pago_Pago|Pacific/Samoa","Pacific/Pago_Pago|US/Samoa","Pacific/Pitcairn|Etc/GMT+8","Pacific/Port_Moresby|Antarctica/DumontDUrville","Pacific/Port_Moresby|Etc/GMT-10","Pacific/Port_Moresby|Pacific/Chuuk","Pacific/Port_Moresby|Pacific/Truk","Pacific/Port_Moresby|Pacific/Yap","Pacific/Tahiti|Etc/GMT+10","Pacific/Tahiti|Pacific/Rarotonga"]});return o});(function(e){if(typeof define=="function"&&define.amd)define("picker",["jquery"],e);else if(typeof exports=="object")module.exports=e(require("jquery"));else this.Picker=e(jQuery)})(function(b){var r=b(window);var _=b(document);var w=b(document.documentElement);var C=document.documentElement.style.transition!=null;function x(n,e,t,i){if(!n)return x;var r=false,a={id:n.id||"P"+Math.abs(~~(Math.random()*new Date))},l=t?b.extend(true,{},t.defaults,i):i||{},o=b.extend({},x.klasses(),l.klass),c=b(n),s=function(){return this.start()},u=s.prototype={constructor:s,$node:c,start:function(){if(a&&a.start)return u;a.methods={};a.start=true;a.open=false;a.type=n.type;n.autofocus=n==T();n.readOnly=!l.editable;n.id=n.id||a.id;if(n.type!="text"){n.type="text"}u.component=new t(u,l);u.$root=b('<div class="'+o.picker+'" id="'+n.id+'_root" />');f();u.$holder=b(d()).appendTo(u.$root);p();if(l.formatSubmit){g()}h();if(l.containerHidden)b(l.containerHidden).append(u._hidden);else c.after(u._hidden);if(l.container)b(l.container).append(u.$root);else c.after(u.$root);u.on({start:u.component.onStart,render:u.component.onRender,stop:u.component.onStop,open:u.component.onOpen,close:u.component.onClose,set:u.component.onSet}).on({start:l.onStart,render:l.onRender,stop:l.onStop,open:l.onOpen,close:l.onClose,set:l.onSet});r=S(u.$holder[0]);if(n.autofocus){u.open()}return u.trigger("start").trigger("render")},render:function(e){if(e){u.$holder=b(d());p();u.$root.html(u.$holder)}else u.$root.find("."+o.box).html(u.component.nodes(a.open));return u.trigger("render")},stop:function(){if(!a.start)return u;u.close();if(u._hidden){u._hidden.parentNode.removeChild(u._hidden)}u.$root.remove();c.removeClass(o.input).removeData(e);setTimeout(function(){c.off("."+a.id)},0);n.type=a.type;n.readOnly=false;u.trigger("stop");a.methods={};a.start=false;return u},open:function(e){if(a.open)return u;c.addClass(o.active);E(n,"expanded",true);setTimeout(function(){u.$root.addClass(o.opened);E(u.$root[0],"hidden",false)},0);if(e!==false){a.open=true;if(r){w.css("overflow","hidden").css("padding-right","+="+A())}m();_.on("click."+a.id+" focusin."+a.id,function(e){var t=e.target;if(t!=n&&t!=document&&e.which!=3){u.close(t===u.$holder[0])}}).on("keydown."+a.id,function(e){var t=e.keyCode,i=u.component.key[t],n=e.target;if(t==27){u.close(true)}else if(n==u.$holder[0]&&(i||t==13)){e.preventDefault();if(i){x._.trigger(u.component.key.go,u,[x._.trigger(i)])}else if(!u.$root.find("."+o.highlighted).hasClass(o.disabled)){u.set("select",u.component.item.highlight);if(l.closeOnSelect){u.close(true)}}}else if(b.contains(u.$root[0],n)&&t==13){e.preventDefault();n.click()}})}return u.trigger("open")},close:function(e){if(e){if(l.editable){n.focus()}else{u.$holder.off("focus.toOpen").focus();setTimeout(function(){u.$holder.on("focus.toOpen",v)},0)}}c.removeClass(o.active);E(n,"expanded",false);setTimeout(function(){u.$root.removeClass(o.opened+" "+o.focused);E(u.$root[0],"hidden",true)},0);if(!a.open)return u;a.open=false;if(r){w.css("overflow","").css("padding-right","-="+A())}_.off("."+a.id);return u.trigger("close")},clear:function(e){return u.set("clear",null,e)},set:function(e,t,i){var n,r,o=b.isPlainObject(e),s=o?e:{};i=o&&b.isPlainObject(t)?t:i||{};if(e){if(!o){s[e]=t}for(n in s){r=s[n];if(n in u.component.item){if(r===undefined)r=null;u.component.set(n,r,i)}if(n=="select"||n=="clear"){c.val(n=="clear"?"":u.get(n,l.format)).trigger("change")}}u.render()}return i.muted?u:u.trigger("set",s)},get:function(e,t){e=e||"value";if(a[e]!=null){return a[e]}if(e=="valueSubmit"){if(u._hidden){return u._hidden.value}e="value"}if(e=="value"){return n.value}if(e in u.component.item){if(typeof t=="string"){var i=u.component.get(e);return i?x._.trigger(u.component.formats.toString,u.component,[t,i]):""}return u.component.get(e)}},on:function(e,t,i){var n,r,o=b.isPlainObject(e),s=o?e:{};if(e){if(!o){s[e]=t}for(n in s){r=s[n];if(i){n="_"+n}a.methods[n]=a.methods[n]||[];a.methods[n].push(r)}}return u},off:function(){var e,t,i=arguments;for(e=0,namesCount=i.length;e<namesCount;e+=1){t=i[e];if(t in a.methods){delete a.methods[t]}}return u},trigger:function(e,i){var t=function(e){var t=a.methods[e];if(t){t.map(function(e){x._.trigger(e,u,[i])})}};t("_"+e);t(e);return u}};function d(){return x._.node("div",x._.node("div",x._.node("div",x._.node("div",u.component.nodes(a.open),o.box),o.wrap),o.frame),o.holder,'tabindex="-1"')}function h(){c.data(e,u).addClass(o.input).val(c.data("value")?u.get("select",l.format):n.value);if(!l.editable){c.on("focus."+a.id+" click."+a.id,function(e){e.preventDefault();u.open()}).on("keydown."+a.id,y)}E(n,{haspopup:true,expanded:false,readonly:false,owns:n.id+"_root"})}function f(){E(u.$root[0],"hidden",true)}function p(){u.$holder.on({keydown:y,"focus.toOpen":v,blur:function(){c.removeClass(o.target)},focusin:function(e){u.$root.removeClass(o.focused);e.stopPropagation()},"mousedown click":function(e){var t=e.target;if(t!=u.$holder[0]){e.stopPropagation();if(e.type=="mousedown"&&!b(t).is("input, select, textarea, button, option")){e.preventDefault();u.$holder[0].focus()}}}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var e=b(this),t=e.data(),i=e.hasClass(o.navDisabled)||e.hasClass(o.disabled),n=T();n=n&&(n.type||n.href);if(i||n&&!b.contains(u.$root[0],n)){u.$holder[0].focus()}if(!i&&t.nav){u.set("highlight",u.component.item.highlight,{nav:t.nav})}else if(!i&&"pick"in t){u.set("select",t.pick);if(l.closeOnSelect){u.close(true)}}else if(t.clear){u.clear();if(l.closeOnClear){u.close(true)}}else if(t.close){u.close(true)}})}function g(){var e;if(l.hiddenName===true){e=n.name;n.name=""}else{e=[typeof l.hiddenPrefix=="string"?l.hiddenPrefix:"",typeof l.hiddenSuffix=="string"?l.hiddenSuffix:"_submit"];e=e[0]+n.name+e[1]}u._hidden=b("<input "+"type=hidden "+'name="'+e+'"'+(c.data("value")||n.value?' value="'+u.get("select",l.formatSubmit)+'"':"")+">")[0];c.on("change."+a.id,function(){u._hidden.value=n.value?u.get("select",l.formatSubmit):""})}function m(){if(r&&C){u.$holder.find("."+o.frame).one("transitionend",function(){u.$holder[0].focus()})}else{u.$holder[0].focus()}}function v(e){e.stopPropagation();c.addClass(o.target);u.$root.addClass(o.focused);u.open()}function y(e){var t=e.keyCode,i=/^(8|46)$/.test(t);if(t==27){u.close(true);return false}if(t==32||i||!a.open&&u.component.key[t]){e.preventDefault();e.stopPropagation();if(i){u.clear().close()}else{u.open()}}}return new s}x.klasses=function(e){e=e||"picker";return{picker:e,opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",target:e+"__input--target",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}};function S(e){var t,i="position";if(e.currentStyle){t=e.currentStyle[i]}else if(window.getComputedStyle){t=getComputedStyle(e)[i]}return t=="fixed"}function A(){if(w.height()<=r.height()){return 0}var e=b('<div style="visibility:hidden;width:100px" />').appendTo("body");var t=e[0].offsetWidth;e.css("overflow","scroll");var i=b('<div style="width:100%" />').appendTo(e);var n=i[0].offsetWidth;e.remove();return t-n}x._={group:function(e){var t,i="",n=x._.trigger(e.min,e);for(;n<=x._.trigger(e.max,e,[n]);n+=e.i){t=x._.trigger(e.item,e,[n]);i+=x._.node(e.node,t[0],t[1],t[2])}return i},node:function(e,t,i,n){if(!t)return"";t=b.isArray(t)?t.join(""):t;i=i?' class="'+i+'"':"";n=n?" "+n:"";return"<"+e+i+n+">"+t+"</"+e+">"},lead:function(e){return(e<10?"0":"")+e},trigger:function(e,t,i){return typeof e=="function"?e.apply(t,i||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return{}.toString.call(e).indexOf("Date")>-1&&this.isInteger(e.getDate())},isInteger:function(e){return{}.toString.call(e).indexOf("Number")>-1&&e%1===0},ariaAttr:e};x.extend=function(n,r){b.fn[n]=function(t,e){var i=this.data(n);if(t=="picker"){return i}if(i&&typeof t=="string"){return x._.trigger(i[t],i,[e])}return this.each(function(){var e=b(this);if(!e.data(n)){new x(this,n,r,t)}})};b.fn[n].defaults=r.defaults};function E(e,t,i){if(b.isPlainObject(t)){for(var n in t){o(e,n,t[n])}}else{o(e,t,i)}}function o(e,t,i){e.setAttribute((t=="role"?"":"aria-")+t,i)}function e(e,t){if(!b.isPlainObject(e)){e={attribute:t}}t="";for(var i in e){var n=(i=="role"?"":"aria-")+i,r=e[i];t+=r==null?"":n+'="'+e[i]+'"'}return t}function T(){try{return document.activeElement}catch(e){}}return x});(function(e){if(typeof define=="function"&&define.amd)define(["picker","jquery"],e);else if(typeof exports=="object")module.exports=e(require("./picker.js"),require("jquery"));else e(Picker,jQuery)})(function(e,p){var g=7,m=6,v=e._;function t(t,i){var n=this,e=t.$node[0],r=e.value,o=t.$node.data("value"),s=o||r,a=o?i.formatSubmit:i.format,l=function(){return e.currentStyle?e.currentStyle.direction=="rtl":getComputedStyle(t.$root[0]).direction=="rtl"};n.settings=i;n.$node=t.$node;n.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"};n.item={};n.item.clear=null;n.item.disable=(i.disable||[]).slice(0);n.item.enable=-function(e){return e[0]===true?e.shift():-1}(n.item.disable);n.set("min",i.min).set("max",i.max).set("now");if(s){n.set("select",s,{format:a,defaultValue:true})}else{n.set("select",null).set("highlight",n.item.now)}n.key={40:7,38:-7,39:function(){return l()?-1:1},37:function(){return l()?1:-1},go:function(e){var t=n.item.highlight,i=new Date(t.year,t.month,t.date+e);n.set("highlight",i,{interval:e});this.render()}};t.on("render",function(){t.$root.find("."+i.klass.selectMonth).on("change",function(){var e=this.value;if(e){t.set("highlight",[t.get("view").year,e,t.get("highlight").date]);t.$root.find("."+i.klass.selectMonth).trigger("focus")}});t.$root.find("."+i.klass.selectYear).on("change",function(){var e=this.value;if(e){t.set("highlight",[e,t.get("view").month,t.get("highlight").date]);t.$root.find("."+i.klass.selectYear).trigger("focus")}})},1).on("open",function(){var e="";if(n.disabled(n.get("now"))){e=":not(."+i.klass.buttonToday+")"}t.$root.find("button"+e+", select").attr("disabled",false)},1).on("close",function(){t.$root.find("button, select").attr("disabled",true)},1)}t.prototype.set=function(t,i,n){var r=this,e=r.item;if(i===null){if(t=="clear")t="select";e[t]=i;return r}e[t=="enable"?"disable":t=="flip"?"enable":t]=r.queue[t].split(" ").map(function(e){i=r[e](t,i,n);return i}).pop();if(t=="select"){r.set("highlight",e.select,n)}else if(t=="highlight"){r.set("view",e.highlight,n)}else if(t.match(/^(flip|min|max|disable|enable)$/)){if(e.select&&r.disabled(e.select)){r.set("select",e.select,n)}if(e.highlight&&r.disabled(e.highlight)){r.set("highlight",e.highlight,n)}}return r};t.prototype.get=function(e){return this.item[e]};t.prototype.create=function(e,t,i){var n,r=this;t=t===undefined?e:t;if(t==-Infinity||t==Infinity){n=t}else if(p.isPlainObject(t)&&v.isInteger(t.pick)){t=t.obj}else if(p.isArray(t)){t=new Date(t[0],t[1],t[2]);t=v.isDate(t)?t:r.create().obj}else if(v.isInteger(t)||v.isDate(t)){t=r.normalize(new Date(t),i)}else{t=r.now(e,t,i)}return{year:n||t.getFullYear(),month:n||t.getMonth(),date:n||t.getDate(),day:n||t.getDay(),obj:n||t,pick:n||t.getTime()}};t.prototype.createRange=function(e,t){var i=this,n=function(e){if(e===true||p.isArray(e)||v.isDate(e)){return i.create(e)}return e};if(!v.isInteger(e)){e=n(e)}if(!v.isInteger(t)){t=n(t)}if(v.isInteger(e)&&p.isPlainObject(t)){e=[t.year,t.month,t.date+e]}else if(v.isInteger(t)&&p.isPlainObject(e)){t=[e.year,e.month,e.date+t]}return{from:n(e),to:n(t)}};t.prototype.withinRange=function(e,t){e=this.createRange(e.from,e.to);return t.pick>=e.from.pick&&t.pick<=e.to.pick};t.prototype.overlapRanges=function(e,t){var i=this;e=i.createRange(e.from,e.to);t=i.createRange(t.from,t.to);return i.withinRange(e,t.from)||i.withinRange(e,t.to)||i.withinRange(t,e.from)||i.withinRange(t,e.to)};t.prototype.now=function(e,t,i){t=new Date;if(i&&i.rel){t.setDate(t.getDate()+i.rel)}return this.normalize(t,i)};t.prototype.navigate=function(e,t,i){var n,r,o,s,a=p.isArray(t),l=p.isPlainObject(t),c=this.item.view;if(a||l){if(l){r=t.year;o=t.month;s=t.date}else{r=+t[0];o=+t[1];s=+t[2]}if(i&&i.nav&&c&&c.month!==o){r=c.year;o=c.month}n=new Date(r,o+(i&&i.nav?i.nav:0),1);r=n.getFullYear();o=n.getMonth();while(new Date(r,o,s).getMonth()!==o){s-=1}t=[r,o,s]}return t};t.prototype.normalize=function(e){e.setHours(0,0,0,0);return e};t.prototype.measure=function(e,t){var i=this;if(!t){t=e=="min"?-Infinity:Infinity}else if(typeof t=="string"){t=i.parse(e,t)}else if(v.isInteger(t)){t=i.now(e,t,{rel:t})}return t};t.prototype.viewset=function(e,t){return this.create([t.year,t.month,1])};t.prototype.validate=function(e,i,t){var n=this,r=i,o=t&&t.interval?t.interval:1,s=n.item.enable===-1,a,l,c=n.item.min,u=n.item.max,d,h,f=s&&n.item.disable.filter(function(e){if(p.isArray(e)){var t=n.create(e).pick;if(t<i.pick)a=true;else if(t>i.pick)l=true}return v.isInteger(e)}).length;if(!t||!t.nav&&!t.defaultValue)if(!s&&n.disabled(i)||s&&n.disabled(i)&&(f||a||l)||!s&&(i.pick<=c.pick||i.pick>=u.pick)){if(s&&!f&&(!l&&o>0||!a&&o<0)){o*=-1}while(n.disabled(i)){if(Math.abs(o)>1&&(i.month<r.month||i.month>r.month)){i=r;o=o>0?1:-1}if(i.pick<=c.pick){d=true;o=1;i=n.create([c.year,c.month,c.date+(i.pick===c.pick?0:-1)])}else if(i.pick>=u.pick){h=true;o=-1;i=n.create([u.year,u.month,u.date+(i.pick===u.pick?0:1)])}if(d&&h){break}i=n.create([i.year,i.month,i.date+o])}}return i};t.prototype.disabled=function(t){var i=this,e=i.item.disable.filter(function(e){if(v.isInteger(e)){return t.day===(i.settings.firstDay?e:e-1)%7}if(p.isArray(e)||v.isDate(e)){return t.pick===i.create(e).pick}if(p.isPlainObject(e)){return i.withinRange(e,t)}});e=e.length&&!e.filter(function(e){return p.isArray(e)&&e[3]=="inverted"||p.isPlainObject(e)&&e.inverted}).length;return i.item.enable===-1?!e:e||t.pick<i.item.min.pick||t.pick>i.item.max.pick};t.prototype.parse=function(e,n,t){var r=this,o={};if(!n||typeof n!="string"){return n}if(!(t&&t.format)){t=t||{};t.format=r.settings.format}r.formats.toArray(t.format).map(function(e){var t=r.formats[e],i=t?v.trigger(t,r,[n,o]):e.replace(/^!/,"").length;if(t){o[e]=n.substr(0,i)}n=n.substr(i)});return[o.yyyy||o.yy,+(o.mm||o.m)-1,o.dd||o.d]};t.prototype.formats=function(){function n(e,t,i){var n=e.match(/[^\x00-\x7F]+|\w+/)[0];if(!i.mm&&!i.m){i.m=t.indexOf(n)+1}return n.length}function i(e){return e.match(/\w+/)[0].length}return{d:function(e,t){return e?v.digits(e):t.date},dd:function(e,t){return e?2:v.lead(t.date)},ddd:function(e,t){return e?i(e):this.settings.weekdaysShort[t.day]},dddd:function(e,t){return e?i(e):this.settings.weekdaysFull[t.day]},m:function(e,t){return e?v.digits(e):t.month+1},mm:function(e,t){return e?2:v.lead(t.month+1)},mmm:function(e,t){var i=this.settings.monthsShort;return e?n(e,i,t):i[t.month]},mmmm:function(e,t){var i=this.settings.monthsFull;return e?n(e,i,t):i[t.month]},yy:function(e,t){return e?2:(""+t.year).slice(2)},yyyy:function(e,t){return e?4:t.year},toArray:function(e){return e.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(e,t){var i=this;return i.formats.toArray(e).map(function(e){return v.trigger(i.formats[e],i,[0,t])||e.replace(/^!/,"")}).join("")}}}();t.prototype.isDateExact=function(e,t){var i=this;if(v.isInteger(e)&&v.isInteger(t)||typeof e=="boolean"&&typeof t=="boolean"){return e===t}if((v.isDate(e)||p.isArray(e))&&(v.isDate(t)||p.isArray(t))){return i.create(e).pick===i.create(t).pick}if(p.isPlainObject(e)&&p.isPlainObject(t)){return i.isDateExact(e.from,t.from)&&i.isDateExact(e.to,t.to)}return false};t.prototype.isDateOverlap=function(e,t){var i=this,n=i.settings.firstDay?1:0;if(v.isInteger(e)&&(v.isDate(t)||p.isArray(t))){e=e%7+n;return e===i.create(t).day+1}if(v.isInteger(t)&&(v.isDate(e)||p.isArray(e))){t=t%7+n;return t===i.create(e).day+1}if(p.isPlainObject(e)&&p.isPlainObject(t)){return i.overlapRanges(e,t)}return false};t.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(t.enable==-1?1:-1)};t.prototype.deactivate=function(e,t){var n=this,r=n.item.disable.slice(0);if(t=="flip"){n.flipEnable()}else if(t===false){n.flipEnable(1);r=[]}else if(t===true){n.flipEnable(-1);r=[]}else{t.map(function(e){var t;for(var i=0;i<r.length;i+=1){if(n.isDateExact(e,r[i])){t=true;break}}if(!t){if(v.isInteger(e)||v.isDate(e)||p.isArray(e)||p.isPlainObject(e)&&e.from&&e.to){r.push(e)}}})}return r};t.prototype.activate=function(e,t){var o=this,s=o.item.disable,a=s.length;if(t=="flip"){o.flipEnable()}else if(t===true){o.flipEnable(1);s=[]}else if(t===false){o.flipEnable(-1);s=[]}else{t.map(function(e){var t,i,n,r;for(n=0;n<a;n+=1){i=s[n];if(o.isDateExact(i,e)){t=s[n]=null;r=true;break}else if(o.isDateOverlap(i,e)){if(p.isPlainObject(e)){e.inverted=true;t=e}else if(p.isArray(e)){t=e;if(!t[3])t.push("inverted")}else if(v.isDate(e)){t=[e.getFullYear(),e.getMonth(),e.getDate(),"inverted"]}break}}if(t)for(n=0;n<a;n+=1){if(o.isDateExact(s[n],e)){s[n]=null;break}}if(r)for(n=0;n<a;n+=1){if(o.isDateOverlap(s[n],e)){s[n]=null;break}}if(t){s.push(t)}})}return s.filter(function(e){return e!=null})};t.prototype.nodes=function(l){var c=this,u=c.settings,e=c.item,o=e.now,s=e.select,a=e.highlight,d=e.view,h=e.disable,f=e.min,p=e.max,t=function(t,i){if(u.firstDay){t.push(t.shift());i.push(i.shift())}return v.node("thead",v.node("tr",v.group({min:0,max:g-1,i:1,node:"th",item:function(e){return[t[e],u.klass.weekdays,'scope=col title="'+i[e]+'"']}})))}((u.showWeekdaysFull?u.weekdaysFull:u.weekdaysShort).slice(0),u.weekdaysFull.slice(0)),i=function(e){return v.node("div"," ",u.klass["nav"+(e?"Next":"Prev")]+(e&&d.year>=p.year&&d.month>=p.month||!e&&d.year<=f.year&&d.month<=f.month?" "+u.klass.navDisabled:""),"data-nav="+(e||-1)+" "+v.ariaAttr({role:"button",controls:c.$node[0].id+"_table"})+" "+'title="'+(e?u.labelMonthNext:u.labelMonthPrev)+'"')},n=function(){var t=u.showMonthsShort?u.monthsShort:u.monthsFull;if(u.selectMonths){return v.node("select",v.group({min:0,max:11,i:1,node:"option",item:function(e){return[t[e],0,"value="+e+(d.month==e?" selected":"")+(d.year==f.year&&e<f.month||d.year==p.year&&e>p.month?" disabled":"")]}}),u.klass.selectMonth,(l?"":"disabled")+" "+v.ariaAttr({controls:c.$node[0].id+"_table"})+" "+'title="'+u.labelMonthSelect+'"')}return v.node("div",t[d.month],u.klass.month)},r=function(){var t=d.year,e=u.selectYears===true?5:~~(u.selectYears/2);if(e){var i=f.year,n=p.year,r=t-e,o=t+e;if(i>r){o+=i-r;r=i}if(n<o){var s=r-i,a=o-n;r-=s>a?a:s;o=n}return v.node("select",v.group({min:r,max:o,i:1,node:"option",item:function(e){return[e,0,"value="+e+(t==e?" selected":"")]}}),u.klass.selectYear,(l?"":"disabled")+" "+v.ariaAttr({controls:c.$node[0].id+"_table"})+" "+'title="'+u.labelYearSelect+'"')}return v.node("div",t,u.klass.year)};return v.node("div",(u.selectYears?r()+n():n()+r())+i()+i(1),u.klass.header)+v.node("table",t+v.node("tbody",v.group({min:0,max:m-1,i:1,node:"tr",item:function(e){var t=u.firstDay&&c.create([d.year,d.month,1]).day===0?-7:0;return[v.group({min:g*e-d.day+t+1,max:function(){return this.min+g-1},i:1,node:"td",item:function(t){t=c.create([d.year,d.month,t+(u.firstDay?1:0)]);var i=s&&s.pick==t.pick,n=a&&a.pick==t.pick,r=h&&c.disabled(t)||t.pick<f.pick||t.pick>p.pick,e=v.trigger(c.formats.toString,c,[u.format,t]);return[v.node("div",t.date,function(e){e.push(d.month==t.month?u.klass.infocus:u.klass.outfocus);if(o.pick==t.pick){e.push(u.klass.now)}if(i){e.push(u.klass.selected)}if(n){e.push(u.klass.highlighted)}if(r){e.push(u.klass.disabled)}return e.join(" ")}([u.klass.day]),"data-pick="+t.pick+" "+v.ariaAttr({role:"gridcell",label:e,selected:i&&c.$node.val()===e?true:null,activedescendant:n?true:null,disabled:r?true:null})),"",v.ariaAttr({role:"presentation"})]}})]}})),u.klass.table,'id="'+c.$node[0].id+"_table"+'" '+v.ariaAttr({role:"grid",controls:c.$node[0].id,readonly:true}))+v.node("div",v.node("button",u.today,u.klass.buttonToday,"type=button data-pick="+o.pick+(l&&!c.disabled(o)?"":" disabled")+" "+v.ariaAttr({controls:c.$node[0].id}))+v.node("button",u.clear,u.klass.buttonClear,"type=button data-clear=1"+(l?"":" disabled")+" "+v.ariaAttr({controls:c.$node[0].id}))+v.node("button",u.close,u.klass.buttonClose,"type=button data-close=true "+(l?"":" disabled")+" "+v.ariaAttr({controls:c.$node[0].id})),u.klass.footer)};t.defaults=function(e){return{labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",close:"Close",closeOnSelect:true,closeOnClear:true,format:"d mmmm, yyyy",klass:{table:e+"table",header:e+"header",navPrev:e+"nav--prev",navNext:e+"nav--next",navDisabled:e+"nav--disabled",month:e+"month",year:e+"year",selectMonth:e+"select--month",selectYear:e+"select--year",weekdays:e+"weekday",day:e+"day",disabled:e+"day--disabled",selected:e+"day--selected",highlighted:e+"day--highlighted",now:e+"day--today",infocus:e+"day--infocus",outfocus:e+"day--outfocus",footer:e+"footer",buttonClear:e+"button--clear",buttonToday:e+"button--today",buttonClose:e+"button--close"}}}(e.klasses().picker+"__");e.extend("pickadate",t)});(function(e){if(typeof define=="function"&&define.amd)define(["picker","jquery"],e);else if(typeof exports=="object")module.exports=e(require("./picker.js"),require("jquery"));else e(Picker,jQuery)})(function(e,l){var r=24,u=60,i=12,o=r*u,h=e._;function t(r,o){var t=this,e=r.$node[0].value,i=r.$node.data("value"),n=i||e,s=i?o.formatSubmit:o.format;t.settings=o;t.$node=r.$node;t.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse create validate",view:"parse create validate",disable:"deactivate",enable:"activate"};t.item={};t.item.clear=null;t.item.interval=o.interval||30;t.item.disable=(o.disable||[]).slice(0);t.item.enable=-function(e){return e[0]===true?e.shift():-1}(t.item.disable);t.set("min",o.min).set("max",o.max).set("now");if(n){t.set("select",n,{format:s})}else{t.set("select",null).set("highlight",t.item.now)}t.key={40:1,38:-1,39:1,37:-1,go:function(e){t.set("highlight",t.item.highlight.pick+e*t.item.interval,{interval:e*t.item.interval});this.render()}};r.on("render",function(){var e=r.$root.children(),t=e.find("."+o.klass.viewset),n=function(t){return["webkit","moz","ms","o",""].map(function(e){return(e?"-"+e+"-":"")+t})},i=function(t,i){n("transform").map(function(e){t.css(e,i)});n("transition").map(function(e){t.css(e,i)})};if(t.length){i(e,"none");e[0].scrollTop=~~t.position().top-t[0].clientHeight*2;i(e,"")}},1).on("open",function(){r.$root.find("button").attr("disabled",false)},1).on("close",function(){r.$root.find("button").attr("disabled",true)},1)}t.prototype.set=function(t,i,n){var r=this,e=r.item;if(i===null){if(t=="clear")t="select";e[t]=i;return r}e[t=="enable"?"disable":t=="flip"?"enable":t]=r.queue[t].split(" ").map(function(e){i=r[e](t,i,n);return i}).pop();if(t=="select"){r.set("highlight",e.select,n)}else if(t=="highlight"){r.set("view",e.highlight,n)}else if(t=="interval"){r.set("min",e.min,n).set("max",e.max,n)}else if(t.match(/^(flip|min|max|disable|enable)$/)){if(e.select&&r.disabled(e.select)){r.set("select",i,n)}if(e.highlight&&r.disabled(e.highlight)){r.set("highlight",i,n)}if(t=="min"){r.set("max",e.max,n)}}return r};t.prototype.get=function(e){return this.item[e]};t.prototype.create=function(e,t,i){var n=this;t=t===undefined?e:t;if(h.isDate(t)){t=[t.getHours(),t.getMinutes()]}if(l.isPlainObject(t)&&h.isInteger(t.pick)){t=t.pick}else if(l.isArray(t)){t=+t[0]*u+ +t[1]}else if(!h.isInteger(t)){t=n.now(e,t,i)}if(e=="max"&&t<n.item.min.pick){t+=o}if(e!="min"&&e!="max"&&(t-n.item.min.pick)%n.item.interval!==0){t+=n.item.interval}t=n.normalize(e,t,i);return{hour:~~(r+t/u)%r,mins:(u+t%u)%u,time:(o+t)%o,pick:t%o}};t.prototype.createRange=function(e,t){var i=this,n=function(e){if(e===true||l.isArray(e)||h.isDate(e)){return i.create(e)}return e};if(!h.isInteger(e)){e=n(e)}if(!h.isInteger(t)){t=n(t)}if(h.isInteger(e)&&l.isPlainObject(t)){e=[t.hour,t.mins+e*i.settings.interval]}else if(h.isInteger(t)&&l.isPlainObject(e)){t=[e.hour,e.mins+t*i.settings.interval]}return{from:n(e),to:n(t)}};t.prototype.withinRange=function(e,t){e=this.createRange(e.from,e.to);return t.pick>=e.from.pick&&t.pick<=e.to.pick};t.prototype.overlapRanges=function(e,t){var i=this;e=i.createRange(e.from,e.to);t=i.createRange(t.from,t.to);return i.withinRange(e,t.from)||i.withinRange(e,t.to)||i.withinRange(t,e.from)||i.withinRange(t,e.to)};t.prototype.now=function(e,t){var i=this.item.interval,n=new Date,r=n.getHours()*u+n.getMinutes(),o=h.isInteger(t),s;r-=r%i;s=t<0&&i*t+r<=-i;r+=e=="min"&&s?0:i;if(o){r+=i*(s&&e!="max"?t+1:t)}return r};t.prototype.normalize=function(e,t){var i=this.item.interval,n=this.item.min&&this.item.min.pick||0;t-=e=="min"?0:(t-n)%i;return t};t.prototype.measure=function(e,t,i){var n=this;if(!t){t=e=="min"?[0,0]:[r-1,u-1]}if(typeof t=="string"){t=n.parse(e,t)}else if(t===true||h.isInteger(t)){t=n.now(e,t,i)}else if(l.isPlainObject(t)&&h.isInteger(t.pick)){t=n.normalize(e,t.pick,i)}return t};t.prototype.validate=function(e,t,i){var n=this,r=i&&i.interval?i.interval:n.item.interval;if(n.disabled(t)){t=n.shift(t,r)}t=n.scope(t);if(n.disabled(t)){t=n.shift(t,r*-1)}return t};t.prototype.disabled=function(t){var i=this,e=i.item.disable.filter(function(e){if(h.isInteger(e)){return t.hour==e}if(l.isArray(e)||h.isDate(e)){return t.pick==i.create(e).pick}if(l.isPlainObject(e)){return i.withinRange(e,t)}});e=e.length&&!e.filter(function(e){return l.isArray(e)&&e[2]=="inverted"||l.isPlainObject(e)&&e.inverted}).length;return i.item.enable===-1?!e:e||t.pick<i.item.min.pick||t.pick>i.item.max.pick};t.prototype.shift=function(e,t){var i=this,n=i.item.min.pick,r=i.item.max.pick;t=t||i.item.interval;while(i.disabled(e)){e=i.create(e.pick+=t);if(e.pick<=n||e.pick>=r){break}}return e};t.prototype.scope=function(e){var t=this.item.min.pick,i=this.item.max.pick;return this.create(e.pick>i?i:e.pick<t?t:e)};t.prototype.parse=function(e,r,t){var i,n,o,s,a,l=this,c={};if(!r||typeof r!="string"){return r}if(!(t&&t.format)){t=t||{};t.format=l.settings.format}l.formats.toArray(t.format).map(function(e){var t,i=l.formats[e],n=i?h.trigger(i,l,[r,c]):e.replace(/^!/,"").length;if(i){t=r.substr(0,n);c[e]=t.match(/^\d+$/)?+t:t}r=r.substr(n)});for(s in c){a=c[s];if(h.isInteger(a)){if(s.match(/^(h|hh)$/i)){i=a;if(s=="h"||s=="hh"){i%=12}}else if(s=="i"){n=a}}else if(s.match(/^a$/i)&&a.match(/^p/i)&&("h"in c||"hh"in c)){o=true}}return(o?i+12:i)*u+n};t.prototype.formats={h:function(e,t){return e?h.digits(e):t.hour%i||i},hh:function(e,t){return e?2:h.lead(t.hour%i||i)},H:function(e,t){return e?h.digits(e):""+t.hour%24},HH:function(e,t){return e?h.digits(e):h.lead(t.hour%24)},i:function(e,t){return e?2:h.lead(t.mins)},a:function(e,t){return e?4:o/2>t.time%o?"a.m.":"p.m."},A:function(e,t){return e?2:o/2>t.time%o?"AM":"PM"},toArray:function(e){return e.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(e,t){var i=this;return i.formats.toArray(e).map(function(e){return h.trigger(i.formats[e],i,[0,t])||e.replace(/^!/,"")}).join("")}};t.prototype.isTimeExact=function(e,t){var i=this;if(h.isInteger(e)&&h.isInteger(t)||typeof e=="boolean"&&typeof t=="boolean"){return e===t}if((h.isDate(e)||l.isArray(e))&&(h.isDate(t)||l.isArray(t))){return i.create(e).pick===i.create(t).pick}if(l.isPlainObject(e)&&l.isPlainObject(t)){return i.isTimeExact(e.from,t.from)&&i.isTimeExact(e.to,t.to)}return false};t.prototype.isTimeOverlap=function(e,t){var i=this;if(h.isInteger(e)&&(h.isDate(t)||l.isArray(t))){return e===i.create(t).hour}if(h.isInteger(t)&&(h.isDate(e)||l.isArray(e))){return t===i.create(e).hour}if(l.isPlainObject(e)&&l.isPlainObject(t)){return i.overlapRanges(e,t)}return false};t.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(t.enable==-1?1:-1)};t.prototype.deactivate=function(e,t){var n=this,r=n.item.disable.slice(0);if(t=="flip"){n.flipEnable()}else if(t===false){n.flipEnable(1);r=[]}else if(t===true){n.flipEnable(-1);r=[]}else{t.map(function(e){var t;for(var i=0;i<r.length;i+=1){if(n.isTimeExact(e,r[i])){t=true;break}}if(!t){if(h.isInteger(e)||h.isDate(e)||l.isArray(e)||l.isPlainObject(e)&&e.from&&e.to){r.push(e)}}})}return r};t.prototype.activate=function(e,t){var o=this,s=o.item.disable,a=s.length;if(t=="flip"){o.flipEnable()}else if(t===true){o.flipEnable(1);s=[]}else if(t===false){o.flipEnable(-1);s=[]}else{t.map(function(e){var t,i,n,r;for(n=0;n<a;n+=1){i=s[n];if(o.isTimeExact(i,e)){t=s[n]=null;r=true;break}else if(o.isTimeOverlap(i,e)){if(l.isPlainObject(e)){e.inverted=true;t=e}else if(l.isArray(e)){t=e;if(!t[2])t.push("inverted")}else if(h.isDate(e)){t=[e.getFullYear(),e.getMonth(),e.getDate(),"inverted"]}break}}if(t)for(n=0;n<a;n+=1){if(o.isTimeExact(s[n],e)){s[n]=null;break}}if(r)for(n=0;n<a;n+=1){if(o.isTimeOverlap(s[n],e)){s[n]=null;break}}if(t){s.push(t)}})}return s.filter(function(e){return e!=null})};t.prototype.i=function(e,t){return h.isInteger(t)&&t>0?t:this.item.interval};t.prototype.nodes=function(e){var s=this,a=s.settings,l=s.item.select,c=s.item.highlight,u=s.item.view,d=s.item.disable;return h.node("ul",h.group({min:s.item.min.pick,max:s.item.max.pick,i:s.item.interval,node:"li",item:function(e){e=s.create(e);var t=e.pick,i=l&&l.pick==t,n=c&&c.pick==t,r=d&&s.disabled(e),o=h.trigger(s.formats.toString,s,[a.format,e]);return[h.trigger(s.formats.toString,s,[h.trigger(a.formatLabel,s,[e])||a.format,e]),function(e){if(i){e.push(a.klass.selected)}if(n){e.push(a.klass.highlighted)}if(u&&u.pick==t){e.push(a.klass.viewset)}if(r){e.push(a.klass.disabled)}return e.join(" ")}([a.klass.listItem]),"data-pick="+e.pick+" "+h.ariaAttr({role:"option",label:o,selected:i&&s.$node.val()===o?true:null,activedescendant:n?true:null,disabled:r?true:null})]}})+h.node("li",h.node("button",a.clear,a.klass.buttonClear,"type=button data-clear=1"+(e?"":" disabled")+" "+h.ariaAttr({controls:s.$node[0].id})),"",h.ariaAttr({role:"presentation"})),a.klass.list,h.ariaAttr({role:"listbox",controls:s.$node[0].id}))};t.defaults=function(e){return{clear:"Clear",format:"h:i A",interval:30,closeOnSelect:true,closeOnClear:true,klass:{picker:e+" "+e+"--time",holder:e+"__holder",list:e+"__list",listItem:e+"__list-item",disabled:e+"__list-item--disabled",selected:e+"__list-item--selected",highlighted:e+"__list-item--highlighted",viewset:e+"__list-item--viewset",now:e+"__list-item--now",buttonClear:e+"__button--clear"}}}(e.klasses().picker);e.extend("pickatime",t)});if(![].map){Array.prototype.map=function(e,t){var i=this,n=i.length,r=new Array(n);for(var o=0;o<n;o++){if(o in i){r[o]=e.call(t,i[o],o,i)}}return r}}if(![].filter){Array.prototype.filter=function(e){if(this==null)throw new TypeError;var t=Object(this),i=t.length>>>0;if(typeof e!="function")throw new TypeError;var n=[],r=arguments[1];for(var o=0;o<i;o++){if(o in t){var s=t[o];if(e.call(r,s,o,t))n.push(s)}}return n}}if(![].indexOf){Array.prototype.indexOf=function(e){if(this==null)throw new TypeError;var t=Object(this),i=t.length>>>0;if(i===0)return-1;var n=0;if(arguments.length>1){n=Number(arguments[1]);if(n!=n){n=0}else if(n!==0&&n!=Infinity&&n!=-Infinity){n=(n>0||-1)*Math.floor(Math.abs(n))}}if(n>=i)return-1;var r=n>=0?n:Math.max(i-Math.abs(n),0);for(;r<i;r++){if(r in t&&t[r]===e)return r}return-1}}var nativeSplit=String.prototype.split,compliantExecNpcg=/()??/.exec("")[1]===undefined;String.prototype.split=function(e,t){var i=this;if(Object.prototype.toString.call(e)!=="[object RegExp]"){return nativeSplit.call(i,e,t)}var n=[],r=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),o=0,s,a,l,c;e=new RegExp(e.source,r+"g");i+="";if(!compliantExecNpcg){s=new RegExp("^"+e.source+"$(?!\\s)",r)}t=t===undefined?-1>>>0:t>>>0;while(a=e.exec(i)){l=a.index+a[0].length;if(l>o){n.push(i.slice(o,a.index));if(!compliantExecNpcg&&a.length>1){a[0].replace(s,function(){for(var e=1;e<arguments.length-2;e++){if(arguments[e]===undefined){a[e]=undefined}}})}if(a.length>1&&a.index<i.length){Array.prototype.push.apply(n,a.slice(1))}c=a[0].length;o=l;if(n.length>=t){break}}if(e.lastIndex===a.index){e.lastIndex++}}if(o===i.length){if(c||!e.test("")){n.push("")}}else{n.push(i.slice(o))}return n.length>t?n.slice(0,t):n};(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):(e=e||self,e.PerfectScrollbar=t())})(this,function(){"use strict";function m(e){return getComputedStyle(e)}function c(e,t){for(var i in t){var n=t[i];if(typeof n==="number"){n=n+"px"}e.style[i]=n}return e}function u(e){var t=document.createElement("div");t.className=e;return t}var i=typeof Element!=="undefined"&&(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);function n(e,t){if(!i){throw new Error("No element matching method supported")}return i.call(e,t)}function r(e){if(e.remove){e.remove()}else{if(e.parentNode){e.parentNode.removeChild(e)}}}function o(e,t){return Array.prototype.filter.call(e.children,function(e){return n(e,t)})}var y={main:"ps",rtl:"ps__rtl",element:{thumb:function(e){return"ps__thumb-"+e},rail:function(e){return"ps__rail-"+e},consuming:"ps__child--consume"},state:{focus:"ps--focus",clicking:"ps--clicking",active:function(e){return"ps--active-"+e},scrolling:function(e){return"ps--scrolling-"+e}}};var s={x:null,y:null};function b(e,t){var i=e.element.classList;var n=y.state.scrolling(t);if(i.contains(n)){clearTimeout(s[t])}else{i.add(n)}}function _(e,t){s[t]=setTimeout(function(){return e.isAlive&&e.element.classList.remove(y.state.scrolling(t))},e.settings.scrollingThreshold)}function h(e,t){b(e,t);_(e,t)}var a=function e(t){this.element=t;this.handlers={}};var e={isEmpty:{configurable:true}};a.prototype.bind=function e(t,i){if(typeof this.handlers[t]==="undefined"){this.handlers[t]=[]}this.handlers[t].push(i);this.element.addEventListener(t,i,false)};a.prototype.unbind=function e(t,i){var n=this;this.handlers[t]=this.handlers[t].filter(function(e){if(i&&e!==i){return true}n.element.removeEventListener(t,e,false);return false})};a.prototype.unbindAll=function e(){for(var t in this.handlers){this.unbind(t)}};e.isEmpty.get=function(){var t=this;return Object.keys(this.handlers).every(function(e){return t.handlers[e].length===0})};Object.defineProperties(a.prototype,e);var d=function e(){this.eventElements=[]};d.prototype.eventElement=function e(t){var i=this.eventElements.filter(function(e){return e.element===t})[0];if(!i){i=new a(t);this.eventElements.push(i)}return i};d.prototype.bind=function e(t,i,n){this.eventElement(t).bind(i,n)};d.prototype.unbind=function e(t,i,n){var r=this.eventElement(t);r.unbind(i,n);if(r.isEmpty){this.eventElements.splice(this.eventElements.indexOf(r),1)}};d.prototype.unbindAll=function e(){this.eventElements.forEach(function(e){return e.unbindAll()});this.eventElements=[]};d.prototype.once=function e(t,i,n){var r=this.eventElement(t);var o=function(e){r.unbind(i,o);n(e)};r.bind(i,o)};function f(e){if(typeof window.CustomEvent==="function"){return new CustomEvent(e)}else{var t=document.createEvent("CustomEvent");t.initCustomEvent(e,false,false,undefined);return t}}function l(e,t,i,n,r){if(n===void 0)n=true;if(r===void 0)r=false;var o;if(t==="top"){o=["contentHeight","containerHeight","scrollTop","y","up","down"]}else if(t==="left"){o=["contentWidth","containerWidth","scrollLeft","x","left","right"]}else{throw new Error("A proper axis should be provided")}p(e,i,o,n,r)}function p(e,t,i,n,r){var o=i[0];var s=i[1];var a=i[2];var l=i[3];var c=i[4];var u=i[5];if(n===void 0)n=true;if(r===void 0)r=false;var d=e.element;e.reach[l]=null;if(d[a]<1){e.reach[l]="start"}if(d[a]>e[o]-e[s]-1){e.reach[l]="end"}if(t){d.dispatchEvent(f("ps-scroll-"+l));if(t<0){d.dispatchEvent(f("ps-scroll-"+c))}else if(t>0){d.dispatchEvent(f("ps-scroll-"+u))}if(n){h(e,l)}}if(e.reach[l]&&(t||r)){d.dispatchEvent(f("ps-"+l+"-reach-"+e.reach[l]))}}function g(e){return parseInt(e,10)||0}function v(e){return n(e,"input,[contenteditable]")||n(e,"select,[contenteditable]")||n(e,"textarea,[contenteditable]")||n(e,"button,[contenteditable]")}function w(e){var t=m(e);return g(t.width)+g(t.paddingLeft)+g(t.paddingRight)+g(t.borderLeftWidth)+g(t.borderRightWidth)}var C={isWebKit:typeof document!=="undefined"&&"WebkitAppearance"in document.documentElement.style,supportsTouch:typeof window!=="undefined"&&("ontouchstart"in window||"maxTouchPoints"in window.navigator&&window.navigator.maxTouchPoints>0||window.DocumentTouch&&document instanceof window.DocumentTouch),supportsIePointer:typeof navigator!=="undefined"&&navigator.msMaxTouchPoints,isChrome:typeof navigator!=="undefined"&&/Chrome/i.test(navigator&&navigator.userAgent)};function x(e){var t=e.element;var i=Math.floor(t.scrollTop);var n=t.getBoundingClientRect();e.containerWidth=Math.round(n.width);e.containerHeight=Math.round(n.height);e.contentWidth=t.scrollWidth;e.contentHeight=t.scrollHeight;if(!t.contains(e.scrollbarXRail)){o(t,y.element.rail("x")).forEach(function(e){return r(e)});t.appendChild(e.scrollbarXRail)}if(!t.contains(e.scrollbarYRail)){o(t,y.element.rail("y")).forEach(function(e){return r(e)});t.appendChild(e.scrollbarYRail)}if(!e.settings.suppressScrollX&&e.containerWidth+e.settings.scrollXMarginOffset<e.contentWidth){e.scrollbarXActive=true;e.railXWidth=e.containerWidth-e.railXMarginWidth;e.railXRatio=e.containerWidth/e.railXWidth;e.scrollbarXWidth=S(e,g(e.railXWidth*e.containerWidth/e.contentWidth));e.scrollbarXLeft=g((e.negativeScrollAdjustment+t.scrollLeft)*(e.railXWidth-e.scrollbarXWidth)/(e.contentWidth-e.containerWidth))}else{e.scrollbarXActive=false}if(!e.settings.suppressScrollY&&e.containerHeight+e.settings.scrollYMarginOffset<e.contentHeight){e.scrollbarYActive=true;e.railYHeight=e.containerHeight-e.railYMarginHeight;e.railYRatio=e.containerHeight/e.railYHeight;e.scrollbarYHeight=S(e,g(e.railYHeight*e.containerHeight/e.contentHeight));e.scrollbarYTop=g(i*(e.railYHeight-e.scrollbarYHeight)/(e.contentHeight-e.containerHeight))}else{e.scrollbarYActive=false}if(e.scrollbarXLeft>=e.railXWidth-e.scrollbarXWidth){e.scrollbarXLeft=e.railXWidth-e.scrollbarXWidth}if(e.scrollbarYTop>=e.railYHeight-e.scrollbarYHeight){e.scrollbarYTop=e.railYHeight-e.scrollbarYHeight}A(t,e);if(e.scrollbarXActive){t.classList.add(y.state.active("x"))}else{t.classList.remove(y.state.active("x"));e.scrollbarXWidth=0;e.scrollbarXLeft=0;t.scrollLeft=e.isRtl===true?e.contentWidth:0}if(e.scrollbarYActive){t.classList.add(y.state.active("y"))}else{t.classList.remove(y.state.active("y"));e.scrollbarYHeight=0;e.scrollbarYTop=0;t.scrollTop=0}}function S(e,t){if(e.settings.minScrollbarLength){t=Math.max(t,e.settings.minScrollbarLength)}if(e.settings.maxScrollbarLength){t=Math.min(t,e.settings.maxScrollbarLength)}return t}function A(e,t){var i={width:t.railXWidth};var n=Math.floor(e.scrollTop);if(t.isRtl){i.left=t.negativeScrollAdjustment+e.scrollLeft+t.containerWidth-t.contentWidth}else{i.left=e.scrollLeft}if(t.isScrollbarXUsingBottom){i.bottom=t.scrollbarXBottom-n}else{i.top=t.scrollbarXTop+n}c(t.scrollbarXRail,i);var r={top:n,height:t.railYHeight};if(t.isScrollbarYUsingRight){if(t.isRtl){r.right=t.contentWidth-(t.negativeScrollAdjustment+e.scrollLeft)-t.scrollbarYRight-t.scrollbarYOuterWidth-9}else{r.right=t.scrollbarYRight-e.scrollLeft}}else{if(t.isRtl){r.left=t.negativeScrollAdjustment+e.scrollLeft+t.containerWidth*2-t.contentWidth-t.scrollbarYLeft-t.scrollbarYOuterWidth}else{r.left=t.scrollbarYLeft+e.scrollLeft}}c(t.scrollbarYRail,r);c(t.scrollbarX,{left:t.scrollbarXLeft,width:t.scrollbarXWidth-t.railBorderXWidth});c(t.scrollbarY,{top:t.scrollbarYTop,height:t.scrollbarYHeight-t.railBorderYWidth})}function t(n){var e=n.element;n.event.bind(n.scrollbarY,"mousedown",function(e){return e.stopPropagation()});n.event.bind(n.scrollbarYRail,"mousedown",function(e){var t=e.pageY-window.pageYOffset-n.scrollbarYRail.getBoundingClientRect().top;var i=t>n.scrollbarYTop?1:-1;n.element.scrollTop+=i*n.containerHeight;x(n);e.stopPropagation()});n.event.bind(n.scrollbarX,"mousedown",function(e){return e.stopPropagation()});n.event.bind(n.scrollbarXRail,"mousedown",function(e){var t=e.pageX-window.pageXOffset-n.scrollbarXRail.getBoundingClientRect().left;var i=t>n.scrollbarXLeft?1:-1;n.element.scrollLeft+=i*n.containerWidth;x(n);e.stopPropagation()})}function E(e){T(e,["containerWidth","contentWidth","pageX","railXWidth","scrollbarX","scrollbarXWidth","scrollLeft","x","scrollbarXRail"]);T(e,["containerHeight","contentHeight","pageY","railYHeight","scrollbarY","scrollbarYHeight","scrollTop","y","scrollbarYRail"])}function T(i,e){var n=e[0];var r=e[1];var o=e[2];var s=e[3];var t=e[4];var a=e[5];var l=e[6];var c=e[7];var u=e[8];var d=i.element;var h=null;var f=null;var p=null;function g(e){if(e.touches&&e.touches[0]){e[o]=e.touches[0].pageY}d[l]=h+p*(e[o]-f);b(i,c);x(i);e.stopPropagation();if(e.type.startsWith("touch")&&e.changedTouches.length>1){e.preventDefault()}}function m(){_(i,c);i[u].classList.remove(y.state.clicking);i.event.unbind(i.ownerDocument,"mousemove",g)}function v(e,t){h=d[l];if(t&&e.touches){e[o]=e.touches[0].pageY}f=e[o];p=(i[r]-i[n])/(i[s]-i[a]);if(!t){i.event.bind(i.ownerDocument,"mousemove",g);i.event.once(i.ownerDocument,"mouseup",m);e.preventDefault()}else{i.event.bind(i.ownerDocument,"touchmove",g)}i[u].classList.add(y.state.clicking);e.stopPropagation()}i.event.bind(i[t],"mousedown",function(e){v(e)});i.event.bind(i[t],"touchstart",function(e){v(e,true)})}function D(r){var o=r.element;var s=function(){return n(o,":hover")};var a=function(){return n(r.scrollbarX,":focus")||n(r.scrollbarY,":focus")};function l(e,t){var i=Math.floor(o.scrollTop);if(e===0){if(!r.scrollbarYActive){return false}if(i===0&&t>0||i>=r.contentHeight-r.containerHeight&&t<0){return!r.settings.wheelPropagation}}var n=o.scrollLeft;if(t===0){if(!r.scrollbarXActive){return false}if(n===0&&e<0||n>=r.contentWidth-r.containerWidth&&e>0){return!r.settings.wheelPropagation}}return true}r.event.bind(r.ownerDocument,"keydown",function(e){if(e.isDefaultPrevented&&e.isDefaultPrevented()||e.defaultPrevented){return}if(!s()&&!a()){return}var t=document.activeElement?document.activeElement:r.ownerDocument.activeElement;if(t){if(t.tagName==="IFRAME"){t=t.contentDocument.activeElement}else{while(t.shadowRoot){t=t.shadowRoot.activeElement}}if(v(t)){return}}var i=0;var n=0;switch(e.which){case 37:if(e.metaKey){i=-r.contentWidth}else if(e.altKey){i=-r.containerWidth}else{i=-30}break;case 38:if(e.metaKey){n=r.contentHeight}else if(e.altKey){n=r.containerHeight}else{n=30}break;case 39:if(e.metaKey){i=r.contentWidth}else if(e.altKey){i=r.containerWidth}else{i=30}break;case 40:if(e.metaKey){n=-r.contentHeight}else if(e.altKey){n=-r.containerHeight}else{n=-30}break;case 32:if(e.shiftKey){n=r.containerHeight}else{n=-r.containerHeight}break;case 33:n=r.containerHeight;break;case 34:n=-r.containerHeight;break;case 36:n=r.contentHeight;break;case 35:n=-r.contentHeight;break;default:return}if(r.settings.suppressScrollX&&i!==0){return}if(r.settings.suppressScrollY&&n!==0){return}o.scrollTop-=n;o.scrollLeft+=i;x(r);if(l(i,n)){e.preventDefault()}})}function R(l){var c=l.element;function o(e,t){var i=Math.floor(c.scrollTop);var n=c.scrollTop===0;var r=i+c.offsetHeight===c.scrollHeight;var o=c.scrollLeft===0;var s=c.scrollLeft+c.offsetWidth===c.scrollWidth;var a;if(Math.abs(t)>Math.abs(e)){a=n||r}else{a=o||s}return a?!l.settings.wheelPropagation:true}function s(e){var t=e.deltaX;var i=-1*e.deltaY;if(typeof t==="undefined"||typeof i==="undefined"){t=-1*e.wheelDeltaX/6;i=e.wheelDeltaY/6}if(e.deltaMode&&e.deltaMode===1){t*=10;i*=10}if(t!==t&&i!==i){t=0;i=e.wheelDelta}if(e.shiftKey){return[-i,-t]}return[t,i]}function a(e,t,i){if(!C.isWebKit&&c.querySelector("select:focus")){return true}if(!c.contains(e)){return false}var n=e;while(n&&n!==c){if(n.classList.contains(y.element.consuming)){return true}var r=m(n);if(i&&r.overflowY.match(/(scroll|auto)/)){var o=n.scrollHeight-n.clientHeight;if(o>0){if(n.scrollTop>0&&i<0||n.scrollTop<o&&i>0){return true}}}if(t&&r.overflowX.match(/(scroll|auto)/)){var s=n.scrollWidth-n.clientWidth;if(s>0){if(n.scrollLeft>0&&t<0||n.scrollLeft<s&&t>0){return true}}}n=n.parentNode}return false}function e(e){var t=s(e);var i=t[0];var n=t[1];if(a(e.target,i,n)){return}var r=false;if(!l.settings.useBothWheelAxes){c.scrollTop-=n*l.settings.wheelSpeed;c.scrollLeft+=i*l.settings.wheelSpeed}else if(l.scrollbarYActive&&!l.scrollbarXActive){if(n){c.scrollTop-=n*l.settings.wheelSpeed}else{c.scrollTop+=i*l.settings.wheelSpeed}r=true}else if(l.scrollbarXActive&&!l.scrollbarYActive){if(i){c.scrollLeft+=i*l.settings.wheelSpeed}else{c.scrollLeft-=n*l.settings.wheelSpeed}r=true}x(l);r=r||o(i,n);if(r&&!e.ctrlKey){e.stopPropagation();e.preventDefault()}}if(typeof window.onwheel!=="undefined"){l.event.bind(c,"wheel",e)}else if(typeof window.onmousewheel!=="undefined"){l.event.bind(c,"mousewheel",e)}}function M(s){if(!C.supportsTouch&&!C.supportsIePointer){return}var a=s.element;function l(e,t){var i=Math.floor(a.scrollTop);var n=a.scrollLeft;var r=Math.abs(e);var o=Math.abs(t);if(o>r){if(t<0&&i===s.contentHeight-s.containerHeight||t>0&&i===0){return window.scrollY===0&&t>0&&C.isChrome}}else if(r>o){if(e<0&&n===s.contentWidth-s.containerWidth||e>0&&n===0){return true}}return true}function c(e,t){a.scrollTop-=t;a.scrollLeft-=e;x(s)}var u={};var d=0;var h={};var i=null;function f(e){if(e.targetTouches){return e.targetTouches[0]}else{return e}}function p(e){if(e.pointerType&&e.pointerType==="pen"&&e.buttons===0){return false}if(e.targetTouches&&e.targetTouches.length===1){return true}if(e.pointerType&&e.pointerType!=="mouse"&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE){return true}return false}function e(e){if(!p(e)){return}var t=f(e);u.pageX=t.pageX;u.pageY=t.pageY;d=(new Date).getTime();if(i!==null){clearInterval(i)}}function g(e,t,i){if(!a.contains(e)){return false}var n=e;while(n&&n!==a){if(n.classList.contains(y.element.consuming)){return true}var r=m(n);if(i&&r.overflowY.match(/(scroll|auto)/)){var o=n.scrollHeight-n.clientHeight;if(o>0){if(n.scrollTop>0&&i<0||n.scrollTop<o&&i>0){return true}}}if(t&&r.overflowX.match(/(scroll|auto)/)){var s=n.scrollWidth-n.clientWidth;if(s>0){if(n.scrollLeft>0&&t<0||n.scrollLeft<s&&t>0){return true}}}n=n.parentNode}return false}function t(e){if(p(e)){var t=f(e);var i={pageX:t.pageX,pageY:t.pageY};var n=i.pageX-u.pageX;var r=i.pageY-u.pageY;if(g(e.target,n,r)){return}c(n,r);u=i;var o=(new Date).getTime();var s=o-d;if(s>0){h.x=n/s;h.y=r/s;d=o}if(l(n,r)){e.preventDefault()}}}function n(){if(s.settings.swipeEasing){clearInterval(i);i=setInterval(function(){if(s.isInitialized){clearInterval(i);return}if(!h.x&&!h.y){clearInterval(i);return}if(Math.abs(h.x)<.01&&Math.abs(h.y)<.01){clearInterval(i);return}if(!s.element){clearInterval(i);return}c(h.x*30,h.y*30);h.x*=.8;h.y*=.8},10)}}if(C.supportsTouch){s.event.bind(a,"touchstart",e);s.event.bind(a,"touchmove",t);s.event.bind(a,"touchend",n)}else if(C.supportsIePointer){if(window.PointerEvent){s.event.bind(a,"pointerdown",e);s.event.bind(a,"pointermove",t);s.event.bind(a,"pointerup",n)}else if(window.MSPointerEvent){s.event.bind(a,"MSPointerDown",e);s.event.bind(a,"MSPointerMove",t);s.event.bind(a,"MSPointerUp",n)}}}var k=function(){return{handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:false,suppressScrollY:false,swipeEasing:true,useBothWheelAxes:false,wheelPropagation:true,wheelSpeed:1}};var O={"click-rail":t,"drag-thumb":E,keyboard:D,wheel:R,touch:M};var N=function e(i,t){var n=this;if(t===void 0)t={};if(typeof i==="string"){i=document.querySelector(i)}if(!i||!i.nodeName){throw new Error("no element is specified to initialize PerfectScrollbar")}this.element=i;i.classList.add(y.main);this.settings=k();for(var r in t){this.settings[r]=t[r]}this.containerWidth=null;this.containerHeight=null;this.contentWidth=null;this.contentHeight=null;var o=function(){return i.classList.add(y.state.focus)};var s=function(){return i.classList.remove(y.state.focus)};this.isRtl=m(i).direction==="rtl";if(this.isRtl===true){i.classList.add(y.rtl)}this.isNegativeScroll=function(){var e=i.scrollLeft;var t=null;i.scrollLeft=-1;t=i.scrollLeft<0;i.scrollLeft=e;return t}();this.negativeScrollAdjustment=this.isNegativeScroll?i.scrollWidth-i.clientWidth:0;this.event=new d;this.ownerDocument=i.ownerDocument||document;this.scrollbarXRail=u(y.element.rail("x"));i.appendChild(this.scrollbarXRail);this.scrollbarX=u(y.element.thumb("x"));this.scrollbarXRail.appendChild(this.scrollbarX);this.scrollbarX.setAttribute("tabindex",0);this.event.bind(this.scrollbarX,"focus",o);this.event.bind(this.scrollbarX,"blur",s);this.scrollbarXActive=null;this.scrollbarXWidth=null;this.scrollbarXLeft=null;var a=m(this.scrollbarXRail);this.scrollbarXBottom=parseInt(a.bottom,10);if(isNaN(this.scrollbarXBottom)){this.isScrollbarXUsingBottom=false;this.scrollbarXTop=g(a.top)}else{this.isScrollbarXUsingBottom=true}this.railBorderXWidth=g(a.borderLeftWidth)+g(a.borderRightWidth);c(this.scrollbarXRail,{display:"block"});this.railXMarginWidth=g(a.marginLeft)+g(a.marginRight);c(this.scrollbarXRail,{display:""});this.railXWidth=null;this.railXRatio=null;this.scrollbarYRail=u(y.element.rail("y"));i.appendChild(this.scrollbarYRail);this.scrollbarY=u(y.element.thumb("y"));this.scrollbarYRail.appendChild(this.scrollbarY);this.scrollbarY.setAttribute("tabindex",0);this.event.bind(this.scrollbarY,"focus",o);this.event.bind(this.scrollbarY,"blur",s);this.scrollbarYActive=null;this.scrollbarYHeight=null;this.scrollbarYTop=null;var l=m(this.scrollbarYRail);this.scrollbarYRight=parseInt(l.right,10);if(isNaN(this.scrollbarYRight)){this.isScrollbarYUsingRight=false;this.scrollbarYLeft=g(l.left)}else{this.isScrollbarYUsingRight=true}this.scrollbarYOuterWidth=this.isRtl?w(this.scrollbarY):null;this.railBorderYWidth=g(l.borderTopWidth)+g(l.borderBottomWidth);c(this.scrollbarYRail,{display:"block"});this.railYMarginHeight=g(l.marginTop)+g(l.marginBottom);c(this.scrollbarYRail,{display:""});this.railYHeight=null;this.railYRatio=null;this.reach={x:i.scrollLeft<=0?"start":i.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:i.scrollTop<=0?"start":i.scrollTop>=this.contentHeight-this.containerHeight?"end":null};this.isAlive=true;this.settings.handlers.forEach(function(e){return O[e](n)});this.lastScrollTop=Math.floor(i.scrollTop);this.lastScrollLeft=i.scrollLeft;this.event.bind(this.element,"scroll",function(e){return n.onScroll(e)});x(this)};N.prototype.update=function e(){if(!this.isAlive){return}this.negativeScrollAdjustment=this.isNegativeScroll?this.element.scrollWidth-this.element.clientWidth:0;c(this.scrollbarXRail,{display:"block"});c(this.scrollbarYRail,{display:"block"});this.railXMarginWidth=g(m(this.scrollbarXRail).marginLeft)+g(m(this.scrollbarXRail).marginRight);this.railYMarginHeight=g(m(this.scrollbarYRail).marginTop)+g(m(this.scrollbarYRail).marginBottom);c(this.scrollbarXRail,{display:"none"});c(this.scrollbarYRail,{display:"none"});x(this);l(this,"top",0,false,true);l(this,"left",0,false,true);c(this.scrollbarXRail,{display:""});c(this.scrollbarYRail,{display:""})};N.prototype.onScroll=function e(t){if(!this.isAlive){return}x(this);l(this,"top",this.element.scrollTop-this.lastScrollTop);l(this,"left",this.element.scrollLeft-this.lastScrollLeft);this.lastScrollTop=Math.floor(this.element.scrollTop);this.lastScrollLeft=this.element.scrollLeft};N.prototype.destroy=function e(){if(!this.isAlive){return}this.event.unbindAll();r(this.scrollbarX);r(this.scrollbarY);r(this.scrollbarXRail);r(this.scrollbarYRail);this.removePsClasses();this.element=null;this.scrollbarX=null;this.scrollbarY=null;this.scrollbarXRail=null;this.scrollbarYRail=null;this.isAlive=false};N.prototype.removePsClasses=function e(){this.element.className=this.element.className.split(" ").filter(function(e){return!e.match(/^ps([-_].+|)$/)}).join(" ")};return N});(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports==="object"){module.exports=e}else{e(jQuery)}})(function(c){var e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],t="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],u=Array.prototype.slice,d,h;if(c.event.fixHooks){for(var i=e.length;i;){c.event.fixHooks[e[--i]]=c.event.mouseHooks}}var n=c.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener){for(var e=t.length;e;){this.addEventListener(t[--e],r,false)}}else{this.onmousewheel=r}c.data(this,"mousewheel-line-height",n.getLineHeight(this));c.data(this,"mousewheel-page-height",n.getPageHeight(this))},teardown:function(){if(this.removeEventListener){for(var e=t.length;e;){this.removeEventListener(t[--e],r,false)}}else{this.onmousewheel=null}},getLineHeight:function(e){return parseInt(c(e)["offsetParent"in c.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(e){return c(e).height()},settings:{adjustOldDeltas:true}};c.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}});function r(e){var t=e||window.event,i=u.call(arguments,1),n=0,r=0,o=0,s=0;e=c.event.fix(t);e.type="mousewheel";if("detail"in t){o=t.detail*-1}if("wheelDelta"in t){o=t.wheelDelta}if("wheelDeltaY"in t){o=t.wheelDeltaY}if("wheelDeltaX"in t){r=t.wheelDeltaX*-1}if("axis"in t&&t.axis===t.HORIZONTAL_AXIS){r=o*-1;o=0}n=o===0?r:o;if("deltaY"in t){o=t.deltaY*-1;n=o}if("deltaX"in t){r=t.deltaX;if(o===0){n=r*-1}}if(o===0&&r===0){return}if(t.deltaMode===1){var a=c.data(this,"mousewheel-line-height");n*=a;o*=a;r*=a}else if(t.deltaMode===2){var l=c.data(this,"mousewheel-page-height");n*=l;o*=l;r*=l}s=Math.max(Math.abs(o),Math.abs(r));if(!h||s<h){h=s;if(p(t,s)){h/=40}}if(p(t,s)){n/=40;r/=40;o/=40}n=Math[n>=1?"floor":"ceil"](n/h);r=Math[r>=1?"floor":"ceil"](r/h);o=Math[o>=1?"floor":"ceil"](o/h);e.deltaX=r;e.deltaY=o;e.deltaFactor=h;e.deltaMode=0;i.unshift(e,n,r,o);if(d){clearTimeout(d)}d=setTimeout(f,200);return(c.event.dispatch||c.event.handle).apply(this,i)}function f(){h=null}function p(e,t){return n.settings.adjustOldDeltas&&e.type==="mousewheel"&&t%120===0}});jQuery.fn.doubleScroll=function(e){var n={contentElement:undefined,scrollCss:{"overflow-x":"auto","overflow-y":"hidden"},contentCss:{"overflow-x":"auto","overflow-y":"hidden"},onlyIfScroll:true,resetOnWindowResize:false,timeToWaitForResize:30};$.extend(true,n,e);$.extend(n,{topScrollBarMarkup:'<div class="doubleScroll-scroll-wrapper" style="height: 20px;"><div class="doubleScroll-scroll" style="height: 20px;"></div></div>',topScrollBarWrapperSelector:".doubleScroll-scroll-wrapper",topScrollBarInnerSelector:".doubleScroll-scroll"});var r=function(e,t){if(t.onlyIfScroll&&e.get(0).scrollWidth<=e.width()){e.prev(t.topScrollBarWrapperSelector).remove();return}var i=e.prev(t.topScrollBarWrapperSelector);if(i.length==0){i=$(t.topScrollBarMarkup);e.before(i);i.css(t.scrollCss);e.css(t.contentCss);i.bind("scroll.doubleScroll",function(){e.scrollLeft(i.scrollLeft())});var n=function(){i.scrollLeft(e.scrollLeft())};e.bind("scroll.doubleScroll",n)}var r;if(t.contentElement!==undefined&&e.find(t.contentElement).length!==0){r=e.find(t.contentElement)}else{r=e.find(">:first-child")}$(t.topScrollBarInnerSelector,i).width(r.outerWidth());i.width(e.width());i.scrollLeft(e.scrollLeft())};return this.each(function(){var t=$(this);r(t,n);if(n.resetOnWindowResize){var e;var i=function(e){r(t,n)};$(window).bind("resize.doubleScroll",function(){clearTimeout(e);e=setTimeout(i,n.timeToWaitForResize)})}})};(function(v){if(typeof window==="undefined")return;var y=0,b=false,o=false,e="message",Y=e.length,R="[iFrameSizer]",M=R.length,k=null,n=window.requestAnimationFrame,x={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},O={},i=null,_={autoResize:true,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:true,inPageLinks:false,enablePublicMethods:true,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:false,maxHeight:Infinity,maxWidth:Infinity,minHeight:0,minWidth:0,mouseEvents:true,resizeFrom:"parent",scrolling:false,sizeHeight:true,sizeWidth:false,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",onClose:function(){return true},onClosed:function(){},onInit:function(){},onMessage:function(){P("onMessage function not defined")},onMouseEnter:function(){},onMouseLeave:function(){},onResized:function(){},onScroll:function(){return true}};function w(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function N(e,t,i){e.addEventListener(t,i,false)}function q(e,t,i){e.removeEventListener(t,i,false)}function h(){var e=["moz","webkit","o","ms"];var t;for(t=0;t<e.length&&!n;t+=1){n=window[e[t]+"RequestAnimationFrame"]}if(!n){I("setup","RequestAnimationFrame not supported")}else{n=n.bind(window)}}function f(e){var t="Host page: "+e;if(window.top!==window.self){t=window.parentIFrame&&window.parentIFrame.getId?window.parentIFrame.getId()+": "+e:"Nested host page: "+e}return t}function p(e){return R+"["+f(e)+"]"}function r(e){return O[e]?O[e].log:b}function I(e,t){s("log",e,t,r(e))}function L(e,t){s("info",e,t,r(e))}function P(e,t){s("warn",e,t,true)}function s(e,t,i,n){if(true===n&&"object"===typeof window.console){console[e](p(t),i)}}function g(t){function e(){function e(){j(T);H(D);w("onResized",T)}n("Height");n("Width");z(e,T,"init")}function i(){var e=E.substr(M).split(":");var t=e[1]?parseInt(e[1],10):0;var i=O[e[0]]&&O[e[0]].iframe;var n=getComputedStyle(i);return{iframe:i,id:e[0],height:t+r(n)+o(n),width:e[2],type:e[3]}}function r(e){if(e.boxSizing!=="border-box"){return 0}var t=e.paddingTop?parseInt(e.paddingTop,10):0;var i=e.paddingBottom?parseInt(e.paddingBottom,10):0;return t+i}function o(e){if(e.boxSizing!=="border-box"){return 0}var t=e.borderTopWidth?parseInt(e.borderTopWidth,10):0;var i=e.borderBottomWidth?parseInt(e.borderBottomWidth,10):0;return t+i}function n(e){var t=Number(O[D]["max"+e]),i=Number(O[D]["min"+e]),n=e.toLowerCase(),r=Number(T[n]);I(D,"Checking "+n+" is in range "+i+"-"+t);if(r<i){r=i;I(D,"Set "+n+" to min value")}if(r>t){r=t;I(D,"Set "+n+" to max value")}T[n]=""+r}function s(){function e(){function e(){var e=0,t=false;I(D,"Checking connection is from allowed list of origins: "+n);for(;e<n.length;e++){if(n[e]===i){t=true;break}}return t}function t(){var e=O[D]&&O[D].remoteHost;I(D,"Checking connection is from: "+e);return i===e}return n.constructor===Array?e():t()}var i=t.origin,n=O[D]&&O[D].checkOrigin;if(n&&""+i!=="null"&&!e()){throw new Error("Unexpected message received from: "+i+" for "+T.iframe.id+". Message was: "+t.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.")}return true}function a(){return R===(""+E).substr(0,M)&&E.substr(M).split(":")[0]in O}function l(){var e=T.type in{true:1,false:1,undefined:1};if(e){I(D,"Ignoring init message from meta parent page")}return e}function c(e){return E.substr(E.indexOf(":")+Y+e)}function u(e){I(D,"onMessage passed: {iframe: "+T.iframe.id+", message: "+e+"}");w("onMessage",{iframe:T.iframe,message:JSON.parse(e)});I(D,"--")}function d(){var e=document.body.getBoundingClientRect(),t=T.iframe.getBoundingClientRect();return JSON.stringify({iframeHeight:t.height,iframeWidth:t.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(t.top-e.top,10),offsetLeft:parseInt(t.left-e.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,documentHeight:document.documentElement.clientHeight,documentWidth:document.documentElement.clientWidth,windowHeight:window.innerHeight,windowWidth:window.innerWidth})}function h(e,t){function i(){W("Send Page Info","pageInfo:"+d(),e,t)}K(i,32,t)}function f(){function e(t,i){function n(){if(O[o]){h(O[o].iframe,o)}else{r()}}["scroll","resize"].forEach(function(e){I(o,t+e+" listener for sendPageInfo");i(window,e,n)})}function r(){e("Remove ",q)}function t(){e("Add ",N)}var o=D;t();if(O[o]){O[o].stopPageInfo=r}}function p(){if(O[D]&&O[D].stopPageInfo){O[D].stopPageInfo();delete O[D].stopPageInfo}}function g(){var e=true;if(null===T.iframe){P(D,"IFrame ("+T.id+") not found");e=false}return e}function m(e){var t=e.getBoundingClientRect();$(D);return{x:Math.floor(Number(t.left)+Number(k.x)),y:Math.floor(Number(t.top)+Number(k.y))}}function v(e){function t(){k=o;y();I(D,"--")}function i(){return{x:Number(T.width)+r.x,y:Number(T.height)+r.y}}function n(){if(window.parentIFrame){window.parentIFrame["scrollTo"+(e?"Offset":"")](o.x,o.y)}else{P(D,"Unable to scroll to requested position, window.parentIFrame not found")}}var r=e?m(T.iframe):{x:0,y:0},o=i();I(D,"Reposition requested from iFrame (offset x:"+r.x+" y:"+r.y+")");if(window.top!==window.self){n()}else{t()}}function y(){if(false!==w("onScroll",k)){H(D)}else{B()}}function b(e){function t(){var e=m(o);I(D,"Moving to in page link (#"+n+") at x: "+e.x+" y: "+e.y);k={x:e.x,y:e.y};y();I(D,"--")}function i(){if(window.parentIFrame){window.parentIFrame.moveToAnchor(n)}else{I(D,"In page link #"+n+" not found and window.parentIFrame not found")}}var n=e.split("#")[1]||"",r=decodeURIComponent(n),o=document.getElementById(r)||document.getElementsByName(r)[0];if(o){t()}else if(window.top!==window.self){i()}else{I(D,"In page link #"+n+" not found")}}function _(e){var t={};if(Number(T.width)===0&&Number(T.height)===0){var i=c(9).split(":");t={x:i[1],y:i[0]}}else{t={x:T.width,y:T.height}}w(e,{iframe:T.iframe,screenX:Number(t.x),screenY:Number(t.y),type:T.type})}function w(e,t){return F(D,e,t)}function C(){if(O[D]&&O[D].firstRun)A();switch(T.type){case"close":G(T.iframe);break;case"message":u(c(6));break;case"mouseenter":_("onMouseEnter");break;case"mouseleave":_("onMouseLeave");break;case"autoResize":O[D].autoResize=JSON.parse(c(9));break;case"scrollTo":v(false);break;case"scrollToOffset":v(true);break;case"pageInfo":h(O[D]&&O[D].iframe,D);f();break;case"pageInfoStop":p();break;case"inPageLink":b(c(9));break;case"reset":V(T);break;case"init":e();w("onInit",T.iframe);break;default:if(Number(T.width)===0&&Number(T.height)===0){P("Unsupported message received ("+T.type+"), this is likely due to the iframe containing a later "+"version of iframe-resizer than the parent page")}else{e()}}}function x(e){var t=true;if(!O[e]){t=false;P(T.type+" No settings for "+e+". Message was: "+E)}return t}function S(){for(var e in O){W("iFrame requested init",U(e),O[e].iframe,e)}}function A(){if(O[D]){O[D].firstRun=false}}var E=t.data,T={},D=null;if("[iFrameResizerChild]Ready"===E){S()}else if(a()){T=i();D=T.id;if(O[D]){O[D].loaded=true}if(!l()&&x(D)){I(D,"Received: "+E);if(g()&&s()){C()}}}else{L(D,"Ignored: "+E)}}function F(e,t,i){var n=null,r=null;if(O[e]){n=O[e][t];if("function"===typeof n){r=n(i)}else{throw new TypeError(t+" on iFrame["+e+"] is not a function")}}return r}function C(e){var t=e.id;delete O[t]}function G(e){var t=e.id;if(F(t,"onClose",t)===false){I(t,"Close iframe cancelled by onClose event");return}I(t,"Removing iFrame: "+t);try{if(e.parentNode){e.parentNode.removeChild(e)}}catch(e){P(e)}F(t,"onClosed",t);I(t,"--");C(e)}function $(e){if(null===k){k={x:window.pageXOffset!==v?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==v?window.pageYOffset:document.documentElement.scrollTop};I(e,"Get page position: "+k.x+","+k.y)}}function H(e){if(null!==k){window.scrollTo(k.x,k.y);I(e,"Set page position: "+k.x+","+k.y);B()}}function B(){k=null}function V(e){function t(){j(e);W("reset","reset",e.iframe,e.id)}I(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame"));$(e.id);z(t,e,"reset")}function j(t){function i(e){if(!t.id){I("undefined","messageData id not set");return}t.iframe.style[e]=t[e]+"px";I(t.id,"IFrame ("+r+") "+e+" set to "+t[e]+"px")}function n(e){if(!o&&"0"===t[e]){o=true;I(r,"Hidden iFrame detected, creating visibility listener");m()}}function e(e){i(e);n(e)}var r=t.iframe.id;if(O[r]){if(O[r].sizeHeight){e("height")}if(O[r].sizeWidth){e("width")}}}function z(e,t,i){if(i!==t.type&&n&&!window.jasmine){I(t.id,"Requesting animation frame");n(e)}else{e()}}function W(t,i,n,r,o){function e(){var e=O[r]&&O[r].targetOrigin;I(r,"["+t+"] Sending msg to iframe["+r+"] ("+i+") targetOrigin: "+e);n.contentWindow.postMessage(R+i,e)}function s(){P(r,"["+t+"] IFrame("+r+") not found")}function a(){if(n&&"contentWindow"in n&&null!==n.contentWindow){e()}else{s()}}function l(){function e(){if(O[r]&&!O[r].loaded&&!c){c=true;P(r,"IFrame has not responded within "+O[r].warningTimeout/1e3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ignored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning.")}}if(!!o&&O[r]&&!!O[r].warningTimeout){O[r].msgTimeout=setTimeout(e,O[r].warningTimeout)}}var c=false;r=r||n.id;if(O[r]){a();l()}}function U(e){return e+":"+O[e].bodyMarginV1+":"+O[e].sizeWidth+":"+O[e].log+":"+O[e].interval+":"+O[e].enablePublicMethods+":"+O[e].autoResize+":"+O[e].bodyMargin+":"+O[e].heightCalculationMethod+":"+O[e].bodyBackground+":"+O[e].bodyPadding+":"+O[e].tolerance+":"+O[e].inPageLinks+":"+O[e].resizeFrom+":"+O[e].widthCalculationMethod+":"+O[e].mouseEvents}function S(e){return typeof e==="number"}function a(r,t){function e(){function e(e){var t=O[m][e];if(Infinity!==t&&0!==t){r.style[e]=S(t)?t+"px":t;I(m,"Set "+e+" = "+r.style[e])}}function t(e){if(O[m]["min"+e]>O[m]["max"+e]){throw new Error("Value for min"+e+" can not be greater than max"+e)}}t("Height");t("Width");e("maxHeight");e("minHeight");e("maxWidth");e("minWidth")}function i(){var e=t&&t.id||_.id+y++;if(null!==document.getElementById(e)){e+=y++}return e}function n(e){if(""===e){r.id=e=i();b=(t||{}).log;I(e,"Added missing iframe ID: "+e+" ("+r.src+")")}return e}function o(){I(m,"IFrame scrolling "+(O[m]&&O[m].scrolling?"enabled":"disabled")+" for "+m);r.style.overflow=false===(O[m]&&O[m].scrolling)?"hidden":"auto";switch(O[m]&&O[m].scrolling){case"omit":break;case true:r.scrolling="yes";break;case false:r.scrolling="no";break;default:r.scrolling=O[m]?O[m].scrolling:"no"}}function s(){if("number"===typeof(O[m]&&O[m].bodyMargin)||"0"===(O[m]&&O[m].bodyMargin)){O[m].bodyMarginV1=O[m].bodyMargin;O[m].bodyMargin=""+O[m].bodyMargin+"px"}}function a(){var e=O[m]&&O[m].firstRun,t=O[m]&&O[m].heightCalculationMethod in x;if(!e&&t){V({iframe:r,height:0,width:0,type:"init"})}}function l(){if(O[m]){O[m].iframe.iFrameResizer={close:G.bind(null,O[m].iframe),removeListeners:C.bind(null,O[m].iframe),resize:W.bind(null,"Window resize","resize",O[m].iframe),moveToAnchor:function(e){W("Move to anchor","moveToAnchor:"+e,O[m].iframe,m)},sendMessage:function(e){e=JSON.stringify(e);W("Send Message","message:"+e,O[m].iframe,m)}}}}function c(e){function t(){W("iFrame.onload",e,r,v,true);a()}function i(e){if(!r.parentNode){return}var t=new e(function(e){e.forEach(function(e){var t=Array.prototype.slice.call(e.removedNodes);t.forEach(function(e){if(e===r){G(r)}})})});t.observe(r.parentNode,{childList:true})}var n=w();if(n){i(n)}N(r,"load",t);W("init",e,r,v,true)}function u(e){if("object"!==typeof e){throw new TypeError("Options is not an object")}}function d(e){for(var t in _){if(Object.prototype.hasOwnProperty.call(_,t)){O[m][t]=Object.prototype.hasOwnProperty.call(e,t)?e[t]:_[t]}}}function h(e){return""===e||null!==e.match(/^(about:blank|javascript:|file:\/\/)/)?"*":e}function f(e){var t=e.split("Callback");if(t.length===2){var i="on"+t[0].charAt(0).toUpperCase()+t[0].slice(1);this[i]=this[e];delete this[e];P(m,"Deprecated: '"+e+"' has been renamed '"+i+"'. The old method will be removed in the next major version.")}}function p(e){e=e||{};O[m]={firstRun:true,iframe:r,remoteHost:r.src&&r.src.split("/").slice(0,3).join("/")};u(e);Object.keys(e).forEach(f,e);d(e);if(O[m]){O[m].targetOrigin=true===O[m].checkOrigin?h(O[m].remoteHost):"*"}}function g(){return m in O&&"iFrameResizer"in r}var m=n(r.id);if(!g()){p(t);o();e();s();c(U(m));l()}else{P(m,"Ignored iFrame, already setup.")}}function l(e,t){if(null===i){i=setTimeout(function(){i=null;e()},t)}}var c={};function K(e,t,i){if(!c[i]){c[i]=setTimeout(function(){c[i]=null;e()},t)}}function m(){function t(){function t(t){function e(e){return"0px"===(O[t]&&O[t].iframe.style[e])}function i(e){return null!==e.offsetParent}if(O[t]&&i(O[t].iframe)&&(e("height")||e("width"))){W("Visibility change","resize",O[t].iframe,t)}}Object.keys(O).forEach(function(e){t(e)})}function n(e){I("window","Mutation observed: "+e[0].target+" "+e[0].type);l(t,16)}function e(){var e=document.querySelector("body"),t={attributes:true,attributeOldValue:false,characterData:true,characterDataOldValue:false,childList:true,subtree:true},i=new r(n);i.observe(e,t)}var r=w();if(r){e()}}function A(e){function t(){u("Window "+e,"resize")}I("window","Trigger event: "+e);l(t,16)}function t(){function e(){u("Tab Visable","resize")}if("hidden"!==document.visibilityState){I("document","Trigger event: Visiblity change");l(e,16)}}function u(t,i){function n(e){return O[e]&&"parent"===O[e].resizeFrom&&O[e].autoResize&&!O[e].firstRun}Object.keys(O).forEach(function(e){if(n(e)){W(t,i,O[e].iframe,e)}})}function E(){N(window,"message",g);N(window,"resize",function(){A("resize")});N(document,"visibilitychange",t);N(document,"-webkit-visibilitychange",t)}function d(){function n(e,t){function i(){if(!t.tagName){throw new TypeError("Object is not a valid DOM element")}else if("IFRAME"!==t.tagName.toUpperCase()){throw new TypeError("Expected <IFRAME> tag, found <"+t.tagName+">")}}if(t){i();a(t,e);o.push(t)}}function r(e){if(e&&e.enablePublicMethods){P("enablePublicMethods option has been removed, public methods are now always available in the iFrame")}}var o;h();E();return function e(t,i){o=[];r(t);switch(typeof i){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(i||"iframe"),n.bind(v,t));break;case"object":n(t,i);break;default:throw new TypeError("Unexpected data type ("+typeof i+")")}return o}}function T(e){if(!e.fn){L("","Unable to bind to jQuery, it is not fully loaded.")}else if(!e.fn.iFrameResize){e.fn.iFrameResize=function e(i){function t(e,t){a(t,i)}return this.filter("iframe").each(t).end()}}}if(window.jQuery){T(window.jQuery)}if(typeof define==="function"&&define.amd){define([],d)}else if(typeof module==="object"&&typeof module.exports==="object"){module.exports=d()}window.iFrameResize=window.iFrameResize||d()})();!function(de){function he(e){var t=document.createElement("input"),i="on"+e,n=i in t;return n||(t.setAttribute(i,"return;"),n="function"==typeof t[i]),t=null,n}function fe(e){var t="text"==e||"tel"==e||"password"==e;if(!t){var i=document.createElement("input");i.setAttribute("type",e),t="text"===i.type,i=null}return t}function s(e,t,i){var n=i.aliases[e];return n?(n.alias&&s(n.alias,void 0,i),de.extend(!0,i,n),de.extend(!0,i,t),!0):!1}function a(w,r){function o(e){function t(e,t,i,n){this.matches=[],this.isGroup=e||!1,this.isOptional=t||!1,this.isQuantifier=i||!1,this.isAlternator=n||!1,this.quantifier={min:1,max:1}}function i(e,t,i){var n=w.definitions[t],r=0==e.matches.length;if(i=void 0!=i?i:e.matches.length,n&&!d){n.placeholder=de.isFunction(n.placeholder)?n.placeholder.call(this,w):n.placeholder;for(var o=n.prevalidator,s=o?o.length:0,a=1;a<n.cardinality;a++){var l=s>=a?o[a-1]:[],c=l.validator,u=l.cardinality;e.matches.splice(i++,0,{fn:c?"string"==typeof c?new RegExp(c):new function(){this.test=c}:new RegExp("."),cardinality:u?u:1,optionality:e.isOptional,newBlockMarker:r,casing:n.casing,def:n.definitionSymbol||t,placeholder:n.placeholder,mask:t})}e.matches.splice(i++,0,{fn:n.validator?"string"==typeof n.validator?new RegExp(n.validator):new function(){this.test=n.validator}:new RegExp("."),cardinality:n.cardinality,optionality:e.isOptional,newBlockMarker:r,casing:n.casing,def:n.definitionSymbol||t,placeholder:n.placeholder,mask:t})}else e.matches.splice(i++,0,{fn:null,cardinality:0,optionality:e.isOptional,newBlockMarker:r,casing:null,def:t,placeholder:void 0,mask:t}),d=!1}for(var n,r,o,s,a,l,c=/(?:[?*+]|\{[0-9\+\*]+(?:,[0-9\+\*]*)?\})\??|[^.?*+^${[]()|\\]+|./g,d=!1,u=new t,h=[],f=[];n=c.exec(e);)switch(r=n[0],r.charAt(0)){case w.optionalmarker.end:case w.groupmarker.end:if(o=h.pop(),h.length>0){if(s=h[h.length-1],s.matches.push(o),s.isAlternator){a=h.pop();for(var p=0;p<a.matches.length;p++)a.matches[p].isGroup=!1;h.length>0?(s=h[h.length-1],s.matches.push(a)):u.matches.push(a)}}else u.matches.push(o);break;case w.optionalmarker.start:h.push(new t(!1,!0));break;case w.groupmarker.start:h.push(new t(!0));break;case w.quantifiermarker.start:var g=new t(!1,!1,!0);r=r.replace(/[{}]/g,"");var m=r.split(","),v=isNaN(m[0])?m[0]:parseInt(m[0]),y=1==m.length?v:isNaN(m[1])?m[1]:parseInt(m[1]);if(("*"==y||"+"==y)&&(v="*"==y?0:1),g.quantifier={min:v,max:y},h.length>0){var b=h[h.length-1].matches;if(n=b.pop(),!n.isGroup){var _=new t(!0);_.matches.push(n),n=_}b.push(n),b.push(g)}else{if(n=u.matches.pop(),!n.isGroup){var _=new t(!0);_.matches.push(n),n=_}u.matches.push(n),u.matches.push(g)}break;case w.escapeChar:d=!0;break;case w.alternatormarker:h.length>0?(s=h[h.length-1],l=s.matches.pop()):l=u.matches.pop(),l.isAlternator?h.push(l):(a=new t(!1,!1,!1,!0),a.matches.push(l),h.push(a));break;default:if(h.length>0){if(s=h[h.length-1],s.matches.length>0&&!s.isAlternator&&(l=s.matches[s.matches.length-1],l.isGroup&&(l.isGroup=!1,i(l,w.groupmarker.start,0),i(l,w.groupmarker.end))),i(s,r),s.isAlternator){a=h.pop();for(var p=0;p<a.matches.length;p++)a.matches[p].isGroup=!1;h.length>0?(s=h[h.length-1],s.matches.push(a)):u.matches.push(a)}}else u.matches.length>0&&(l=u.matches[u.matches.length-1],l.isGroup&&(l.isGroup=!1,i(l,w.groupmarker.start,0),i(l,w.groupmarker.end))),i(u,r)}return u.matches.length>0&&(l=u.matches[u.matches.length-1],l.isGroup&&(l.isGroup=!1,i(l,w.groupmarker.start,0),i(l,w.groupmarker.end)),f.push(u)),f}function e(e,t){if(void 0==e||""==e)return void 0;if(1==e.length&&0==w.greedy&&0!=w.repeat&&(w.placeholder=""),w.repeat>0||"*"==w.repeat||"+"==w.repeat){var i="*"==w.repeat?0:"+"==w.repeat?1:w.repeat;e=w.groupmarker.start+e+w.groupmarker.end+w.quantifiermarker.start+i+","+w.repeat+w.quantifiermarker.end}var n;return void 0==de.inputmask.masksCache[e]||r===!0?(n={mask:e,maskToken:o(e),validPositions:{},_buffer:void 0,buffer:void 0,tests:{},metadata:t},r!==!0&&(de.inputmask.masksCache[e]=n)):n=de.extend(!0,{},de.inputmask.masksCache[e]),n}function i(e){if(e=e.toString(),w.numericInput){e=e.split("").reverse();for(var t=0;t<e.length;t++)e[t]==w.optionalmarker.start?e[t]=w.optionalmarker.end:e[t]==w.optionalmarker.end?e[t]=w.optionalmarker.start:e[t]==w.groupmarker.start?e[t]=w.groupmarker.end:e[t]==w.groupmarker.end&&(e[t]=w.groupmarker.start);e=e.join("")}return e}var t=void 0;if(de.isFunction(w.mask)&&(w.mask=w.mask.call(this,w)),de.isArray(w.mask)){if(w.mask.length>1){w.keepStatic=void 0==w.keepStatic?!0:w.keepStatic;var n="(";return de.each(w.mask,function(e,t){n.length>1&&(n+=")|("),n+=i(void 0==t.mask||de.isFunction(t.mask)?t:t.mask)}),n+=")",e(n,w.mask)}w.mask=w.mask.pop()}return w.mask&&(t=void 0==w.mask.mask||de.isFunction(w.mask.mask)?e(i(w.mask),w.mask):e(i(w.mask.mask),w.mask)),t}function l(e,o,C){function P(e,t,i){t=t||0;var n,r,o,s=[],a=0;do{if(e===!0&&I().validPositions[a]){var l=I().validPositions[a];r=l.match,n=l.locator.slice(),s.push(i===!0?l.input:y(a,r))}else o=A(a,n,a-1),r=o.match,n=o.locator.slice(),s.push(y(a,r));a++}while((void 0==d||d>a-1)&&null!=r.fn||null==r.fn&&""!=r.def||t>=a);return s.pop(),s}function I(){return o}function x(e){var t=I();t.buffer=void 0,t.tests={},e!==!0&&(t._buffer=void 0,t.validPositions={},t.p=0)}function S(e,t){var i=I(),n=-1,r=i.validPositions;void 0==e&&(e=-1);var o=n,s=n;for(var a in r){var l=parseInt(a);r[l]&&(t||null!=r[l].match.fn)&&(e>=l&&(o=l),l>=e&&(s=l))}return n=-1!=o&&e-o>1||e>s?o:s}function b(e,t,i){if(C.insertMode&&void 0!=I().validPositions[e]&&void 0==i){var n,r=de.extend(!0,{},I().validPositions),o=S();for(n=e;o>=n;n++)delete I().validPositions[n];I().validPositions[e]=t;var s,a=!0,l=I().validPositions;for(n=s=e;o>=n;n++){var c=r[n];if(void 0!=c)for(var u=s,d=-1;u<v()&&(null==c.match.fn&&l[n]&&(l[n].match.optionalQuantifier===!0||l[n].match.optionality===!0)||null!=c.match.fn);){if(null==c.match.fn||!C.keepStatic&&l[n]&&(void 0!=l[n+1]&&_(n+1,l[n].locator.slice(),n).length>1||void 0!=l[n].alternation)?u++:u=D(s),$(u,c.match.def)){a=T(u,c.input,!0,!0)!==!1,s=u;break}if(a=null==c.match.fn,d==u)break;d=u}if(!a)break}if(!a)return I().validPositions=de.extend(!0,{},r),!1}else I().validPositions[e]=t;return!0}function F(e,t,i,n){var r,o=e;I().p=e,void 0!=I().validPositions[e]&&I().validPositions[e].input==C.radixPoint&&(t++,o++);for(r=o;t>r;r++)void 0!=I().validPositions[r]&&(i===!0||0!=C.canClearPosition(I(),r,S(),n,C))&&delete I().validPositions[r];for(x(!0),r=o+1;r<=S();){for(;void 0!=I().validPositions[o];)o++;var s=I().validPositions[o];o>r&&(r=o+1);var a=I().validPositions[r];void 0!=a&&void 0==s?($(o,a.match.def)&&T(o,a.input,!0)!==!1&&(delete I().validPositions[r],r++),o++):r++}var l=S(),c=v();for(l>=e&&void 0!=I().validPositions[l]&&I().validPositions[l].input==C.radixPoint&&delete I().validPositions[l],r=l+1;c>=r;r++)I().validPositions[r]&&delete I().validPositions[r];x(!0)}function A(e,t,i){var n=I().validPositions[e];if(void 0==n)for(var r=_(e,t,i),o=S(),s=I().validPositions[o]||_(0)[0],a=void 0!=s.alternation?s.locator[s.alternation].toString().split(","):[],l=0;l<r.length&&(n=r[l],!(n.match&&(C.greedy&&n.match.optionalQuantifier!==!0||(n.match.optionality===!1||n.match.newBlockMarker===!1)&&n.match.optionalQuantifier!==!0)&&(void 0==s.alternation||s.alternation!=n.alternation||void 0!=n.locator[s.alternation]&&B(n.locator[s.alternation].toString().split(","),a))));l++);return n}function G(e){return I().validPositions[e]?I().validPositions[e].match:_(e)[0].match}function $(e,t){for(var i=!1,n=_(e),r=0;r<n.length;r++)if(n[r].match&&n[r].match.def==t){i=!0;break}return i}function _(R,e,t,i){function M(A,E,e,t){function T(e,i,t){if(k>1e4)return alert("jquery.inputmask: There is probably an error in your mask definition or in the code. Create an issue on github with an example of the mask you are using. "+I().mask),!0;if(k==R&&void 0==e.matches)return O.push({match:e,locator:i.reverse()}),!0;if(void 0!=e.matches){if(e.isGroup&&t!==!0){if(e=T(A.matches[D+1],i))return!0}else if(e.isOptional){var n=e;if(e=M(e,E,i,t)){var r=O[O.length-1].match,o=0==de.inArray(r,n.matches);if(!o)return!0;N=!0,k=R}}else if(e.isAlternator){var s,a=e,l=[],c=O.slice(),u=i.length,d=E.length>0?E.shift():-1;if(-1==d||"string"==typeof d){var h=k,f=E.slice(),p=[];"string"==typeof d&&(p=d.split(","));for(var g=0;g<a.matches.length;g++){if(O=[],e=T(a.matches[g],[g].concat(i),t)||e,e!==!0&&void 0!=e&&p[p.length-1]<a.matches.length){var m=A.matches.indexOf(e)+1;A.matches.length>m&&(e=T(A.matches[m],[m].concat(i.slice(1,i.length)),t),e&&(p.push(m.toString()),de.each(O,function(e,t){t.alternation=i.length-1})))}s=O.slice(),k=h,O=[];for(var v=0;v<f.length;v++)E[v]=f[v];for(var y=0;y<s.length;y++){var b=s[y];b.alternation=b.alternation||u;for(var _=0;_<l.length;_++){var w=l[_];if(b.match.mask==w.match.mask&&("string"!=typeof d||-1!=de.inArray(b.locator[b.alternation].toString(),p))){s.splice(y,1),y--,w.locator[b.alternation]=w.locator[b.alternation]+","+b.locator[b.alternation],w.alternation=b.alternation;break}}}l=l.concat(s)}"string"==typeof d&&(l=de.map(l,function(e,t){if(isFinite(t)){var i,n=e.alternation,r=e.locator[n].toString().split(",");e.locator[n]=void 0,e.alternation=void 0;for(var o=0;o<r.length;o++)i=-1!=de.inArray(r[o],p),i&&(void 0!=e.locator[n]?(e.locator[n]+=",",e.locator[n]+=r[o]):e.locator[n]=parseInt(r[o]),e.alternation=n);if(void 0!=e.locator[n])return e}})),O=c.concat(l),k=R,N=O.length>0}else e=a.matches[d]?T(a.matches[d],[d].concat(i),t):!1;if(e)return!0}else if(e.isQuantifier&&t!==!0)for(var C=e,x=E.length>0&&t!==!0?E.shift():0;x<(isNaN(C.quantifier.max)?x+1:C.quantifier.max)&&R>=k;x++){var S=A.matches[de.inArray(C,A.matches)-1];if(e=T(S,[x].concat(i),!0)){var r=O[O.length-1].match;r.optionalQuantifier=x>C.quantifier.min-1;var o=0==de.inArray(r,S.matches);if(o){if(x>C.quantifier.min-1){N=!0,k=R;break}return!0}return!0}}else if(e=M(e,E,i,t))return!0}else k++}for(var D=E.length>0?E.shift():0;D<A.matches.length;D++)if(A.matches[D].isQuantifier!==!0){var i=T(A.matches[D],[D].concat(e),t);if(i&&k==R)return i;if(k>R)break}}var n=I().maskToken,k=e?t:0,r=e||[0],O=[],N=!1;if(i===!0&&I().tests[R])return I().tests[R];if(void 0==e){for(var o,s=R-1;void 0==(o=I().validPositions[s])&&s>-1&&(!I().tests[s]||void 0==(o=I().tests[s][0]));)s--;void 0!=o&&s>-1&&(k=s,r=o.locator.slice())}for(var a=r.shift();a<n.length;a++){var l=M(n[a],r,[a]);if(l&&k==R||k>R)break}return(0==O.length||N)&&O.push({match:{fn:null,cardinality:0,optionality:!0,casing:null,def:""},locator:[]}),I().tests[R]=de.extend(!0,[],O),I().tests[R]}function h(){return void 0==I()._buffer&&(I()._buffer=P(!1,1)),I()._buffer}function w(){return void 0==I().buffer&&(I().buffer=P(!0,S(),!0)),I().buffer}function E(e,t,i){if(i=i||w().slice(),e===!0)x(),e=0,t=i.length;else for(var n=e;t>n;n++)delete I().validPositions[n],delete I().tests[n];for(var n=e;t>n;n++)i[n]!=C.skipOptionalPartCharacter&&T(n,i[n],!0,!0)}function H(e,t){switch(t.casing){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e}function B(e,t){for(var i=C.greedy?t:t.slice(0,1),n=!1,r=0;r<e.length;r++)if(-1!=de.inArray(e[r],i)){n=!0;break}return n}function T(e,t,i,n){function r(u,d,h,f){var p=!1;return de.each(_(u),function(e,t){for(var i=t.match,n=d?1:0,r="",o=(w(),i.cardinality);o>n;o--)r+=V(u-(o-1));if(d&&(r+=d),p=null!=i.fn?i.fn.test(r,I(),u,h,C):d!=i.def&&d!=C.skipOptionalPartCharacter||""==i.def?!1:{c:i.def,pos:u},p!==!1){var s=void 0!=p.c?p.c:d;s=s==C.skipOptionalPartCharacter&&null===i.fn?i.def:s;var a=u,l=w();if(void 0!=p.remove&&(de.isArray(p.remove)||(p.remove=[p.remove]),de.each(p.remove.sort(function(e,t){return t-e}),function(e,t){F(t,t+1,!0)})),void 0!=p.insert&&(de.isArray(p.insert)||(p.insert=[p.insert]),de.each(p.insert.sort(function(e,t){return e-t}),function(e,t){T(t.pos,t.c,!0)})),p.refreshFromBuffer){var c=p.refreshFromBuffer;if(h=!0,E(c===!0?c:c.start,c.end,l),void 0==p.pos&&void 0==p.c)return p.pos=S(),!1;if(a=void 0!=p.pos?p.pos:u,a!=u)return p=de.extend(p,T(a,s,!0)),!1}else if(p!==!0&&void 0!=p.pos&&p.pos!=u&&(a=p.pos,E(u,a),a!=u))return p=de.extend(p,T(a,s,!0)),!1;return 1!=p&&void 0==p.pos&&void 0==p.c?!1:(e>0&&x(!0),b(a,de.extend({},t,{input:H(s,i)}),f)||(p=!1),!1)}}),p}function o(e,t,i,n){for(var r,o,s,a,l=de.extend(!0,{},I().validPositions),c=S();c>=0&&(a=I().validPositions[c],!a||void 0==a.alternation||(r=c,o=I().validPositions[r].alternation,A(r).locator[a.alternation]==a.locator[a.alternation]));c--);if(void 0!=o)for(var u in I().validPositions)if(a=I().validPositions[u],parseInt(u)>parseInt(r)&&void 0!=a.alternation){var d=I().validPositions[r].locator[o].toString().split(","),h=a.locator[o]||d[0];h.length>0&&(h=h.split(",")[0]);for(var f=0;f<d.length;f++)if(h<d[f]){for(var p,g,m=u-1;m>=0;m--)if(p=I().validPositions[m],void 0!=p){g=p.locator[o],p.locator[o]=parseInt(d[f]);break}if(h!=p.locator[o]){for(var v=[],y=u;y<S()+1;y++){var b=I().validPositions[y];b&&null!=b.match.fn&&v.push(b.input),delete I().validPositions[y],delete I().tests[y]}for(x(!0),C.keepStatic=!C.keepStatic,s=!0;v.length>0;){var _=v.shift();if(_!=C.skipOptionalPartCharacter&&!(s=T(S()+1,_,!1,!0)))break}if(p.alternation=o,p.locator[o]=g,s){var w=S(e)+1;s=T(e>w?w:e,t,i,n)}if(C.keepStatic=!C.keepStatic,s)return s;x(),I().validPositions=de.extend(!0,{},l)}}break}return!1}function s(e,t){for(var i=I().validPositions[t],n=i.locator,r=n.length,o=e;t>o;o++)if(!m(o)){var s=_(o),a=s[0],l=-1;de.each(s,function(e,t){for(var i=0;r>i;i++)t.locator[i]&&B(t.locator[i].toString().split(","),n[i].toString().split(","))&&i>l&&(l=i,a=t)}),b(o,de.extend({},a,{input:a.match.def}),!0)}}i=i===!0;for(var a=w(),l=e-1;l>-1&&!I().validPositions[l];l--);for(l++;e>l;l++)void 0==I().validPositions[l]&&((!m(l)||a[l]!=y(l))&&_(l).length>1||a[l]==C.radixPoint||"0"==a[l]&&de.inArray(C.radixPoint,a)<l)&&r(l,a[l],!0);var c=e,u=!1,d=de.extend(!0,{},I().validPositions);if(c<v()&&(u=r(c,t,i,n),(!i||n)&&u===!1)){var h=I().validPositions[c];if(!h||null!=h.match.fn||h.match.def!=t&&t!=C.skipOptionalPartCharacter){if((C.insertMode||void 0==I().validPositions[D(c)])&&!m(c))for(var f=c+1,p=D(c);p>=f;f++)if(u=r(f,t,i,n),u!==!1){s(c,f),c=f;break}}else u={caret:D(c)}}if(u===!1&&C.keepStatic&&O(a)&&(u=o(e,t,i,n)),u===!0&&(u={pos:c}),de.isFunction(C.postValidation)&&0!=u&&!i){x(!0);var g=C.postValidation(w(),C);if(!g)return x(!0),I().validPositions=de.extend(!0,{},d),!1}return u}function m(e){var t=G(e);if(null!=t.fn)return t.fn;if(!C.keepStatic&&void 0==I().validPositions[e]){for(var i=_(e),n=!0,r=0;r<i.length;r++)if(""!=i[r].match.def&&(void 0==i[r].alternation||i[r].locator[i[r].alternation].length>1)){n=!1;break}return n}return!1}function v(){var e;d=u.prop("maxLength"),-1==d&&(d=void 0);var t,i=S(),n=I().validPositions[i],r=void 0!=n?n.locator.slice():void 0;for(t=i+1;void 0==n||null!=n.match.fn||null==n.match.fn&&""!=n.match.def;t++)n=A(t,r,t-1),r=n.locator.slice();var o=G(t-1);return e=""!=o.def?t:t-1,void 0==d||d>e?e:d}function D(e){var t=v();if(e>=t)return t;for(var i=e;++i<t&&!m(i)&&(C.nojumps!==!0||C.nojumpsThreshold>i););return i}function R(e){var t=e;if(0>=t)return 0;for(;--t>0&&!m(t););return t}function V(e){return void 0==I().validPositions[e]?y(e):I().validPositions[e].input}function M(e,t,i,n,r){if(n&&de.isFunction(C.onBeforeWrite)){var o=C.onBeforeWrite.call(e,n,t,i,C);if(o){if(o.refreshFromBuffer){var s=o.refreshFromBuffer;E(s===!0?s:s.start,s.end,o.buffer),x(!0),t=w()}i=o.caret||i}}e._valueSet(t.join("")),void 0!=i&&k(e,i),r===!0&&(g=!0,de(e).trigger("input"))}function y(e,t){if(t=t||G(e),void 0!=t.placeholder)return t.placeholder;if(null==t.fn){if(!C.keepStatic&&void 0==I().validPositions[e]){for(var i=_(e),n=!0,r=0;r<i.length;r++)if(""!=i[r].match.def&&(null!==i[r].match.fn||void 0==i[r].alternation||i[r].locator[i[r].alternation].length>1)){n=!1;break}if(n)return C.placeholder.charAt(e%C.placeholder.length)}return t.def}return C.placeholder.charAt(e%C.placeholder.length)}function l(a,e,l,t){function c(){var e=!1,t=h().slice(d,D(d)).join("").indexOf(u);if(-1!=t&&!m(d)){e=!0;for(var i=h().slice(d,d+t),n=0;n<i.length;n++)if(" "!=i[n]){e=!1;break}}return e}var i=void 0!=t?t.slice():a._valueGet().split(""),u="",d=0;if(x(),I().p=D(-1),e&&a._valueSet(""),!l){var n=h().slice(0,D(-1)).join(""),r=i.join("").match(new RegExp("^"+j(n),"g"));r&&r.length>0&&(i.splice(0,r.length*n.length),d=D(d))}de.each(i,function(e,t){var i=de.Event("keypress");i.which=t.charCodeAt(0),u+=t;var n=S(void 0,!0),r=I().validPositions[n],o=A(n+1,r?r.locator.slice():void 0,n);if(!c()||l){var s=l?e:null==o.match.fn&&o.match.optionality&&n+1<I().p?n+1:I().p;f.call(a,i,!0,!1,l,s),d=s+1,u=""}else f.call(a,i,!0,!1,!0,n+1)}),e&&M(a,w(),de(a).is(":focus")?D(S(0)):void 0,de.Event("checkval"))}function j(e){return de.inputmask.escapeRegex(e)}function z(e){if(e.data("_inputmask")&&!e.hasClass("hasDatepicker")){var t=[],i=I().validPositions;for(var n in i)i[n].match&&null!=i[n].match.fn&&t.push(i[n].input);var r=(N?t.reverse():t).join(""),o=(N?w().slice().reverse():w()).join("");return de.isFunction(C.onUnMask)&&(r=C.onUnMask.call(e,o,r,C)||r),r}return e[0]._valueGet()}function c(e){if(N&&"number"==typeof e&&(!C.greedy||""!=C.placeholder)){var t=w().length;e=t-e}return e}function k(e,t,i){var n,r=e.jquery&&e.length>0?e[0]:e;if("number"!=typeof t)return r.setSelectionRange?(t=r.selectionStart,i=r.selectionEnd):window.getSelection?(n=window.getSelection().getRangeAt(0),(n.commonAncestorContainer.parentNode==r||n.commonAncestorContainer==r)&&(t=n.startOffset,i=n.endOffset)):document.selection&&document.selection.createRange&&(n=document.selection.createRange(),t=0-n.duplicate().moveStart("character",-1e5),i=t+n.text.length),{begin:c(t),end:c(i)};if(t=c(t),i=c(i),i="number"==typeof i?i:t,de(r).is(":visible")){var o=de(r).css("font-size").replace("px","")*i;if(r.scrollLeft=o>r.scrollWidth?o:0,ge||0!=C.insertMode||t!=i||i++,r.setSelectionRange)r.selectionStart=t,r.selectionEnd=i;else if(window.getSelection){if(n=document.createRange(),void 0==r.firstChild){var s=document.createTextNode("");r.appendChild(s)}n.setStart(r.firstChild,t<r._valueGet().length?t:r._valueGet().length),n.setEnd(r.firstChild,i<r._valueGet().length?i:r._valueGet().length),n.collapse(!0);var a=window.getSelection();a.removeAllRanges(),a.addRange(n)}else r.createTextRange&&(n=r.createTextRange(),n.collapse(!0),n.moveEnd("character",i),n.moveStart("character",t),n.select())}}function W(e){var t,i,n=w(),r=n.length,o=S(),s={},a=I().validPositions[o],l=void 0!=a?a.locator.slice():void 0;for(t=o+1;t<n.length;t++)i=A(t,l,t-1),l=i.locator.slice(),s[t]=de.extend(!0,{},i);var c=a&&void 0!=a.alternation?a.locator[a.alternation]:void 0;for(t=r-1;t>o&&(i=s[t],(i.match.optionality||i.match.optionalQuantifier||c&&(c!=s[t].locator[a.alternation]&&null!=i.match.fn||null==i.match.fn&&i.locator[a.alternation]&&B(i.locator[a.alternation].toString().split(","),c.split(","))&&""!=_(t)[0].def))&&n[t]==y(t,i.match));t--)r--;return e?{l:r,def:s[r]?s[r].match:void 0}:r}function U(e){for(var t=W(),i=e.length-1;i>t&&!m(i);i--);return e.splice(t,i+1-t),e}function O(e){if(de.isFunction(C.isComplete))return C.isComplete.call(u,e,C);if("*"==C.repeat)return void 0;{var t=!1,i=W(!0),n=R(i.l);S()}if(void 0==i.def||i.def.newBlockMarker||i.def.optionality||i.def.optionalQuantifier){t=!0;for(var r=0;n>=r;r++){var o=A(r).match;if(null!=o.fn&&void 0==I().validPositions[r]&&o.optionality!==!0&&o.optionalQuantifier!==!0||null==o.fn&&e[r]!=y(r,o)){t=!1;break}}}return t}function Y(e,t){return N?e-t>1||e-t==1&&C.insertMode:t-e>1||t-e==1&&C.insertMode}function q(e){var t=de._data(e).events,n=!1;de.each(t,function(e,t){de.each(t,function(e,t){if("inputmask"==t.namespace&&"setvalue"!=t.type){var i=t.handler;t.handler=function(e){if(!(this.disabled||this.readOnly&&!("keydown"==e.type&&e.ctrlKey&&67==e.keyCode||e.keyCode==de.inputmask.keyCode.TAB))){switch(e.type){case"input":if(g===!0||n===!0)return g=!1,e.preventDefault();break;case"keydown":p=!1,n=!1;break;case"keypress":if(p===!0)return e.preventDefault();p=!0;break;case"compositionstart":n=!0;break;case"compositionupdate":g=!0;break;case"compositionend":n=!1}return i.apply(this,arguments)}e.preventDefault()}}})})}function K(t){function e(e){if(void 0==de.valHooks[e]||1!=de.valHooks[e].inputmaskpatch){var s=de.valHooks[e]&&de.valHooks[e].get?de.valHooks[e].get:function(e){return e.value},o=de.valHooks[e]&&de.valHooks[e].set?de.valHooks[e].set:function(e,t){return e.value=t,e};de.valHooks[e]={get:function(e){var t=de(e);if(t.data("_inputmask")){if(t.data("_inputmask").opts.autoUnmask)return t.inputmask("unmaskedvalue");var i=s(e),n=t.data("_inputmask"),r=n.maskset,o=r._buffer;return o=o?o.join(""):"",i!=o?i:""}return s(e)},set:function(e,t){var i,n=de(e),r=n.data("_inputmask");return i=o(e,t),r&&n.triggerHandler("setvalue.inputmask"),i},inputmaskpatch:!0}}}function i(){var e=de(this),t=de(this).data("_inputmask");return t?t.opts.autoUnmask?e.inputmask("unmaskedvalue"):o.call(this)!=h().join("")?o.call(this):"":o.call(this)}function n(e){var t=de(this).data("_inputmask");s.call(this,e),t&&de(this).triggerHandler("setvalue.inputmask")}function r(e){de(e).bind("mouseenter.inputmask",function(e){var t=de(this),i=this,n=i._valueGet();""!=n&&n!=w().join("")&&t.triggerHandler("setvalue.inputmask")});var t=de._data(e).events,i=t.mouseover;if(i){for(var n=i[i.length-1],r=i.length-1;r>0;r--)i[r]=i[r-1];i[0]=n}}var o,s;if(!t._valueGet){var a;Object.getOwnPropertyDescriptor&&void 0==t.value?(o=function(){return this.textContent},s=function(e){this.textContent=e},Object.defineProperty(t,"value",{get:i,set:n})):((a=Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(t,"value"))&&a.configurable,document.__lookupGetter__&&t.__lookupGetter__("value")?(o=t.__lookupGetter__("value"),s=t.__lookupSetter__("value"),t.__defineGetter__("value",i),t.__defineSetter__("value",n)):(o=function(){return t.value},s=function(e){t.value=e},e(t.type),r(t))),t._valueGet=function(e){return N&&e!==!0?o.call(this).split("").reverse().join(""):o.call(this)},t._valueSet=function(e){s.call(this,N?e.split("").reverse().join(""):e)}}}function X(o,e,t,i){function n(){if(C.keepStatic){x(!0);var e,t=[],i=de.extend(!0,{},I().validPositions);for(e=S();e>=0;e--){var n=I().validPositions[e];if(n){if(void 0!=n.alternation&&n.locator[n.alternation]==A(e).locator[n.alternation])break;null!=n.match.fn&&t.push(n.input),delete I().validPositions[e]}}if(e>0)for(;t.length>0;){I().p=D(S());var r=de.Event("keypress");r.which=t.pop().charCodeAt(0),f.call(o,r,!0,!1,!1,I().p)}else I().validPositions=de.extend(!0,{},i)}}if((C.numericInput||N)&&(e==de.inputmask.keyCode.BACKSPACE?e=de.inputmask.keyCode.DELETE:e==de.inputmask.keyCode.DELETE&&(e=de.inputmask.keyCode.BACKSPACE),N)){var r=t.end;t.end=t.begin,t.begin=r}if(e==de.inputmask.keyCode.BACKSPACE&&(t.end-t.begin<1||0==C.insertMode)?t.begin=R(t.begin):e==de.inputmask.keyCode.DELETE&&t.begin==t.end&&(t.end=m(t.end)?t.end+1:D(t.end)+1),F(t.begin,t.end,!1,i),i!==!0){n();var s=S(t.begin);s<t.begin?(-1==s&&x(),I().p=D(s)):I().p=t.begin}}function Z(t){var i=this,e=de(i),n=t.keyCode,r=k(i);n==de.inputmask.keyCode.BACKSPACE||n==de.inputmask.keyCode.DELETE||pe&&127==n||t.ctrlKey&&88==n&&!he("cut")?(t.preventDefault(),88==n&&(s=w().join("")),X(i,n,r),M(i,w(),I().p,t,s!=w().join("")),i._valueGet()==h().join("")?e.trigger("cleared"):O(w())===!0&&e.trigger("complete"),C.showTooltip&&e.prop("title",I().mask)):n==de.inputmask.keyCode.END||n==de.inputmask.keyCode.PAGE_DOWN?setTimeout(function(){var e=D(S());C.insertMode||e!=v()||t.shiftKey||e--,k(i,t.shiftKey?r.begin:e,e)},0):n==de.inputmask.keyCode.HOME&&!t.shiftKey||n==de.inputmask.keyCode.PAGE_UP?k(i,0,t.shiftKey?r.begin:0):(C.undoOnEscape&&n==de.inputmask.keyCode.ESCAPE||90==n&&t.ctrlKey)&&t.altKey!==!0?(l(i,!0,!1,s.split("")),e.click()):n!=de.inputmask.keyCode.INSERT||t.shiftKey||t.ctrlKey?0!=C.insertMode||t.shiftKey||(n==de.inputmask.keyCode.RIGHT?setTimeout(function(){var e=k(i);k(i,e.begin)},0):n==de.inputmask.keyCode.LEFT&&setTimeout(function(){var e=k(i);k(i,N?e.begin+1:e.begin-1)},0)):(C.insertMode=!C.insertMode,k(i,C.insertMode||r.begin!=v()?r.begin:r.begin-1)),C.onKeyDown.call(this,t,w(),k(i).begin,C),oe=-1!=de.inArray(n,C.ignorables)}function f(e,t,i,n,r){var o=this,s=de(o),a=e.which||e.charCode||e.keyCode;if(!(t===!0||e.ctrlKey&&e.altKey)&&(e.ctrlKey||e.metaKey||oe))return!0;if(a){46==a&&0==e.shiftKey&&","==C.radixPoint&&(a=44);var l,c=t?{begin:r,end:r}:k(o),u=String.fromCharCode(a),d=Y(c.begin,c.end);d&&(I().undoPositions=de.extend(!0,{},I().validPositions),X(o,de.inputmask.keyCode.DELETE,c,!0),c.begin=I().p,C.insertMode||(C.insertMode=!C.insertMode,b(c.begin,n),C.insertMode=!C.insertMode),d=!C.multi),I().writeOutBuffer=!0;var h=N&&!d?c.end:c.begin,f=T(h,u,n);if(f!==!1){if(f!==!0&&(h=void 0!=f.pos?f.pos:h,u=void 0!=f.c?f.c:u),x(!0),void 0!=f.caret)l=f.caret;else{var p=I().validPositions;l=!C.keepStatic&&(void 0!=p[h+1]&&_(h+1,p[h].locator.slice(),h).length>1||void 0!=p[h].alternation)?h+1:D(h)}I().p=l}if(i!==!1){var g=this;if(setTimeout(function(){C.onKeyValidation.call(g,f,C)},0),I().writeOutBuffer&&f!==!1){var m=w();M(o,m,t?void 0:C.numericInput?R(l):l,e,t!==!0),t!==!0&&setTimeout(function(){O(m)===!0&&s.trigger("complete")},0)}else d&&(I().buffer=void 0,I().validPositions=I().undoPositions)}else d&&(I().buffer=void 0,I().validPositions=I().undoPositions);if(C.showTooltip&&s.prop("title",I().mask),t&&de.isFunction(C.onBeforeWrite)){var v=C.onBeforeWrite.call(this,e,w(),l,C);if(v&&v.refreshFromBuffer){var y=v.refreshFromBuffer;E(y===!0?y:y.start,y.end,v.buffer),x(!0),v.caret&&(I().p=v.caret)}}e.preventDefault()}}function Q(e){var t=this,i=de(t),n=t._valueGet(!0),r=k(t);if("propertychange"==e.type&&t._valueGet().length<=v())return!0;if("paste"==e.type){var o=n.substr(0,r.begin),s=n.substr(r.end,n.length);o==h().slice(0,r.begin).join("")&&(o=""),s==h().slice(r.end).join("")&&(s=""),window.clipboardData&&window.clipboardData.getData?n=o+window.clipboardData.getData("Text")+s:e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.getData&&(n=o+e.originalEvent.clipboardData.getData("text/plain")+s)}var a=n;if(de.isFunction(C.onBeforePaste)){if(a=C.onBeforePaste.call(t,n,C),a===!1)return e.preventDefault(),!1;a||(a=n)}return l(t,!0,!1,N?a.split("").reverse():a.split("")),i.click(),O(w())===!0&&i.trigger("complete"),!1}function J(e){var t=this;l(t,!0,!1),O(w())===!0&&de(t).trigger("complete"),e.preventDefault()}function ee(e){var t=this;s=w().join(""),(""==a||0!=e.originalEvent.data.indexOf(a))&&(re=k(t))}function te(e){var t=this,i=re||k(t);0==e.originalEvent.data.indexOf(a)&&(x(),i={begin:0,end:0});var n=e.originalEvent.data;k(t,i.begin,i.end);for(var r=0;r<n.length;r++){var o=de.Event("keypress");o.which=n.charCodeAt(r),p=!1,oe=!1,f.call(t,o)}setTimeout(function(){var e=I().p;M(t,w(),C.numericInput?R(e):e)},0),a=e.originalEvent.data}function ie(e){}function ne(e){if(u=de(e),u.data("_inputmask",{maskset:o,opts:C,isRTL:!1}),C.showTooltip&&u.prop("title",I().mask),("rtl"==e.dir||C.rightAlign)&&u.css("text-align","right"),"rtl"==e.dir||C.numericInput){e.dir="ltr",u.removeAttr("dir");var t=u.data("_inputmask");t.isRTL=!0,u.data("_inputmask",t),N=!0}u.unbind(".inputmask"),(u.is(":input")&&fe(u.attr("type"))||e.isContentEditable)&&(u.closest("form").bind("submit",function(e){s!=w().join("")&&u.change(),u[0]._valueGet&&u[0]._valueGet()==h().join("")&&u[0]._valueSet(""),C.removeMaskOnSubmit&&u.inputmask("remove")}).bind("reset",function(){setTimeout(function(){u.triggerHandler("setvalue.inputmask")},0)}),u.bind("mouseenter.inputmask",function(){var e=de(this),t=this;!e.is(":focus")&&C.showMaskOnHover&&t._valueGet()!=w().join("")&&M(t,w())}).bind("blur.inputmask",function(e){var t=de(this),i=this;if(t.data("_inputmask")){var n=i._valueGet(),r=w().slice();se=!0,s!=r.join("")&&setTimeout(function(){t.change(),s=r.join("")},0),""!=n&&(C.clearMaskOnLostFocus&&(n==h().join("")?r=[]:U(r)),O(r)===!1&&(t.trigger("incomplete"),C.clearIncomplete&&(x(),r=C.clearMaskOnLostFocus?[]:h().slice())),M(i,r,void 0,e))}}).bind("focus.inputmask",function(e){var t=(de(this),this),i=t._valueGet();C.showMaskOnFocus&&(!C.showMaskOnHover||C.showMaskOnHover&&""==i)&&t._valueGet()!=w().join("")&&M(t,w(),D(S())),s=w().join("")}).bind("mouseleave.inputmask",function(){var e=de(this),t=this;if(C.clearMaskOnLostFocus){var i=w().slice(),n=t._valueGet();e.is(":focus")||n==e.attr("placeholder")||""==n||(n==h().join("")?i=[]:U(i),M(t,i))}}).bind("click.inputmask",function(){var e=de(this),t=this;if(e.is(":focus")){var i=k(t);if(i.begin==i.end)if(C.radixFocus&&""!=C.radixPoint&&-1!=de.inArray(C.radixPoint,w())&&(se||w().join("")==h().join("")))k(t,de.inArray(C.radixPoint,w())),se=!1;else{var n=c(i.begin),r=D(S(n));r>n?k(t,m(n)?n:D(n)):k(t,r)}}}).bind("dblclick.inputmask",function(){var e=this;setTimeout(function(){k(e,0,D(S()))},0)}).bind(ve+".inputmask dragdrop.inputmask drop.inputmask",Q).bind("cut.inputmask",function(e){g=!0;var t=this,i=de(t),n=k(t);X(t,de.inputmask.keyCode.DELETE,n),M(t,w(),I().p,e,s!=w().join("")),t._valueGet()==h().join("")&&i.trigger("cleared"),C.showTooltip&&i.prop("title",I().mask)}).bind("complete.inputmask",C.oncomplete).bind("incomplete.inputmask",C.onincomplete).bind("cleared.inputmask",C.oncleared),u.bind("keydown.inputmask",Z).bind("keypress.inputmask",f),me||u.bind("compositionstart.inputmask",ee).bind("compositionupdate.inputmask",te).bind("compositionend.inputmask",ie),"paste"===ve&&u.bind("input.inputmask",J)),u.bind("setvalue.inputmask",function(){var e=this,t=e._valueGet();e._valueSet(de.isFunction(C.onBeforeMask)?C.onBeforeMask.call(e,t,C)||t:t),l(e,!0,!1),s=w().join(""),(C.clearMaskOnLostFocus||C.clearIncomplete)&&e._valueGet()==h().join("")&&e._valueSet("")}),K(e);var i=de.isFunction(C.onBeforeMask)?C.onBeforeMask.call(e,e._valueGet(),C)||e._valueGet():e._valueGet();l(e,!0,!1,i.split(""));var n=w().slice();s=n.join("");var r;try{r=document.activeElement}catch(e){}O(n)===!1&&C.clearIncomplete&&x(),C.clearMaskOnLostFocus&&(n.join("")==h().join("")?n=[]:U(n)),M(e,n),r===e&&k(e,D(S())),q(e)}var s,re,a,u,d,N=!1,p=!1,g=!1,oe=!1,se=!0;if(void 0!=e)switch(e.action){case"isComplete":return u=de(e.el),o=u.data("_inputmask").maskset,C=u.data("_inputmask").opts,O(e.buffer);case"unmaskedvalue":return u=e.$input,o=u.data("_inputmask").maskset,C=u.data("_inputmask").opts,N=e.$input.data("_inputmask").isRTL,z(e.$input);case"mask":s=w().join(""),ne(e.el);break;case"format":u=de({}),u.data("_inputmask",{maskset:o,opts:C,isRTL:C.numericInput}),C.numericInput&&(N=!0);var t=(de.isFunction(C.onBeforeMask)?C.onBeforeMask.call(u,e.value,C)||e.value:e.value).split("");return l(u,!1,!1,N?t.reverse():t),de.isFunction(C.onBeforeWrite)&&C.onBeforeWrite.call(this,void 0,w(),0,C),e.metadata?{value:N?w().slice().reverse().join(""):w().join(""),metadata:u.inputmask("getmetadata")}:N?w().slice().reverse().join(""):w().join("");case"isValid":u=de({}),u.data("_inputmask",{maskset:o,opts:C,isRTL:C.numericInput}),C.numericInput&&(N=!0);var t=e.value.split("");l(u,!1,!0,N?t.reverse():t);for(var i=w(),ae=W(),n=i.length-1;n>ae&&!m(n);n--);return i.splice(ae,n+1-ae),O(i)&&e.value==i.join("");case"getemptymask":return u=de(e.el),o=u.data("_inputmask").maskset,C=u.data("_inputmask").opts,h();case"remove":var r=e.el;u=de(r),o=u.data("_inputmask").maskset,C=u.data("_inputmask").opts,r._valueSet(z(u)),u.unbind(".inputmask"),u.removeData("_inputmask");var le;Object.getOwnPropertyDescriptor&&(le=Object.getOwnPropertyDescriptor(r,"value")),le&&le.get?r._valueGet&&Object.defineProperty(r,"value",{get:r._valueGet,set:r._valueSet}):document.__lookupGetter__&&r.__lookupGetter__("value")&&r._valueGet&&(r.__defineGetter__("value",r._valueGet),r.__defineSetter__("value",r._valueSet));try{delete r._valueGet,delete r._valueSet}catch(e){r._valueGet=void 0,r._valueSet=void 0}break;case"getmetadata":if(u=de(e.el),o=u.data("_inputmask").maskset,C=u.data("_inputmask").opts,de.isArray(o.metadata)){for(var ce,ue=S(),L=ue;L>=0;L--)if(I().validPositions[L]&&void 0!=I().validPositions[L].alternation){ce=I().validPositions[L].alternation;break}return void 0!=ce?o.metadata[I().validPositions[ue].locator[ce]]:o.metadata[0]}return o.metadata}}if(void 0===de.fn.inputmask){var e=navigator.userAgent,pe=null!==e.match(new RegExp("iphone","i")),ge=(null!==e.match(new RegExp("android.*safari.*","i")),null!==e.match(new RegExp("android.*chrome.*","i"))),me=null!==e.match(new RegExp("android.*firefox.*","i")),ve=(/Kindle/i.test(e)||/Silk/i.test(e)||/KFTT/i.test(e)||/KFOT/i.test(e)||/KFJWA/i.test(e)||/KFJWI/i.test(e)||/KFSOWI/i.test(e)||/KFTHWA/i.test(e)||/KFTHWI/i.test(e)||/KFAPWA/i.test(e)||/KFAPWI/i.test(e),he("paste")?"paste":he("input")?"input":"propertychange");de.inputmask={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},quantifiermarker:{start:"{",end:"}"},groupmarker:{start:"(",end:")"},alternatormarker:"|",escapeChar:"\\",mask:null,oncomplete:de.noop,onincomplete:de.noop,oncleared:de.noop,repeat:0,greedy:!0,autoUnmask:!1,removeMaskOnSubmit:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},alias:null,onKeyDown:de.noop,onBeforeMask:void 0,onBeforePaste:void 0,onBeforeWrite:void 0,onUnMask:void 0,showMaskOnFocus:!0,showMaskOnHover:!0,onKeyValidation:de.noop,skipOptionalPartCharacter:" ",showTooltip:!1,numericInput:!1,rightAlign:!1,undoOnEscape:!0,radixPoint:"",radixFocus:!1,nojumps:!1,nojumpsThreshold:0,keepStatic:void 0,definitions:{9:{validator:"[0-9]",cardinality:1,definitionSymbol:"*"},a:{validator:"[A-Za-z–ê-—è–Å—ë√Ä-√ø¬µ]",cardinality:1,definitionSymbol:"*"},"*":{validator:"[0-9A-Za-z–ê-—è–Å—ë√Ä-√ø¬µ]",cardinality:1}},ignorables:[8,9,13,19,27,33,34,35,36,37,38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123],isComplete:void 0,canClearPosition:de.noop,postValidation:void 0},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91},masksCache:{},escapeRegex:function(e){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^"];return e.replace(new RegExp("(\\"+t.join("|\\")+")","gim"),"\\$1")},format:function(e,t,i){var n=de.extend(!0,{},de.inputmask.defaults,t);return s(n.alias,t,n),l({action:"format",value:e,metadata:i},a(n,t&&void 0!==t.definitions),n)},isValid:function(e,t){var i=de.extend(!0,{},de.inputmask.defaults,t);return s(i.alias,t,i),l({action:"isValid",value:e},a(i,t&&void 0!==t.definitions),i)}},de.fn.inputmask=function(e,n){function r(e,t,i){var n=de(e);n.data("inputmask-alias")&&s(n.data("inputmask-alias"),de.extend(!0,{},t),t);for(var r in t){var o=n.data("inputmask-"+r.toLowerCase());void 0!=o&&(o="boolean"==typeof o?o:o.toString(),"mask"==r&&0==o.indexOf("[")?(t[r]=o.replace(/[\s[\]]/g,"").split("','"),t[r][0]=t[r][0].replace("'",""),t[r][t[r].length-1]=t[r][t[r].length-1].replace("'","")):t[r]=o,i&&(i[r]=t[r]))}return t}var t,o=de.extend(!0,{},de.inputmask.defaults,n);if("string"==typeof e)switch(e){case"mask":return s(o.alias,n,o),this.each(function(){return r(this,o),t=a(o,n&&void 0!==n.definitions),void 0==t?this:void l({action:"mask",el:this},t,o)});case"unmaskedvalue":var i=de(this);return i.data("_inputmask")?l({action:"unmaskedvalue",$input:i}):i.val();case"remove":return this.each(function(){var e=de(this);e.data("_inputmask")&&l({action:"remove",el:this})});case"getemptymask":return this.data("_inputmask")?l({action:"getemptymask",el:this}):"";case"hasMaskedValue":return this.data("_inputmask")?!this.data("_inputmask").opts.autoUnmask:!1;case"isComplete":return this.data("_inputmask")?l({action:"isComplete",buffer:this[0]._valueGet().split(""),el:this}):!0;case"getmetadata":return this.data("_inputmask")?l({action:"getmetadata",el:this}):void 0;default:return s(o.alias,n,o),s(e,n,o)||(o.mask=e),this.each(function(){return r(this,o),t=a(o,n&&void 0!==n.definitions),void 0==t?this:void l({action:"mask",el:this},t,o)})}else{if("object"==typeof e)return o=de.extend(!0,{},de.inputmask.defaults,e),s(o.alias,e,o),this.each(function(){return r(this,o),t=a(o,e&&void 0!==e.definitions),void 0==t?this:void l({action:"mask",el:this},t,o)});if(void 0==e)return this.each(function(){var e=de(this).attr("data-inputmask");if(e&&""!=e)try{e=e.replace(new RegExp("'","g"),'"');var t=de.parseJSON("{"+e+"}");de.extend(!0,t,n),o=de.extend(!0,{},de.inputmask.defaults,t),o=r(this,o),s(o.alias,t,o),o.alias=void 0,de(this).inputmask("mask",o)}catch(e){}if(de(this).attr("data-inputmask-mask")||de(this).attr("data-inputmask-alias")){o=de.extend(!0,{},de.inputmask.defaults,{});var i={};o=r(this,o,i),s(o.alias,i,o),o.alias=void 0,de(this).inputmask("mask",o)}})}}}return de.fn.inputmask}(jQuery),function(s){return s.extend(s.inputmask.defaults.definitions,{h:{validator:"[01][0-9]|2[0-3]",cardinality:2,prevalidator:[{validator:"[0-2]",cardinality:1}]},s:{validator:"[0-5][0-9]",cardinality:2,prevalidator:[{validator:"[0-5]",cardinality:1}]},d:{validator:"0[1-9]|[12][0-9]|3[01]",cardinality:2,prevalidator:[{validator:"[0-3]",cardinality:1}]},m:{validator:"0[1-9]|1[012]",cardinality:2,prevalidator:[{validator:"[01]",cardinality:1}]},y:{validator:"(19|20)\\d{2}",cardinality:4,prevalidator:[{validator:"[12]",cardinality:1},{validator:"(19|20)",cardinality:2},{validator:"(19|20)\\d",cardinality:3}]}}),s.extend(s.inputmask.defaults.aliases,{"dd/mm/yyyy":{mask:"1/2/y",placeholder:"dd/mm/yyyy",regex:{val1pre:new RegExp("[0-3]"),val1:new RegExp("0[1-9]|[12][0-9]|3[01]"),val2pre:function(e){var t=s.inputmask.escapeRegex.call(this,e);return new RegExp("((0[1-9]|[12][0-9]|3[01])"+t+"[01])")},val2:function(e){var t=s.inputmask.escapeRegex.call(this,e);return new RegExp("((0[1-9]|[12][0-9])"+t+"(0[1-9]|1[012]))|(30"+t+"(0[13-9]|1[012]))|(31"+t+"(0[13578]|1[02]))")}},leapday:"29/02/",separator:"/",yearrange:{minyear:1900,maxyear:2099},isInYearRange:function(e,t,i){if(isNaN(e))return!1;var n=parseInt(e.concat(t.toString().slice(e.length))),r=parseInt(e.concat(i.toString().slice(e.length)));return(isNaN(n)?!1:n>=t&&i>=n)||(isNaN(r)?!1:r>=t&&i>=r)},determinebaseyear:function(e,t,i){var n=(new Date).getFullYear();if(e>n)return e;if(n>t){for(var r=t.toString().slice(0,2),o=t.toString().slice(2,4);r+i>t;)r--;var s=r+o;return e>s?e:s}return n},onKeyDown:function(e,t,i,n){var r=s(this);if(e.ctrlKey&&e.keyCode==s.inputmask.keyCode.RIGHT){var o=new Date;r.val(o.getDate().toString()+(o.getMonth()+1).toString()+o.getFullYear().toString()),r.triggerHandler("setvalue.inputmask")}},getFrontValue:function(e,t,i){for(var n=0,r=0,o=0;o<e.length&&"2"!=e.charAt(o);o++){var s=i.definitions[e.charAt(o)];s?(n+=r,r=s.cardinality):r++}return t.join("").substr(n,r)},definitions:{1:{validator:function(e,t,i,n,r){var o=r.regex.val1.test(e);return n||o||e.charAt(1)!=r.separator&&-1=="-./".indexOf(e.charAt(1))||!(o=r.regex.val1.test("0"+e.charAt(0)))?o:(t.buffer[i-1]="0",{refreshFromBuffer:{start:i-1,end:i},pos:i,c:e.charAt(0)})},cardinality:2,prevalidator:[{validator:function(e,t,i,n,r){var o=e;isNaN(t.buffer[i+1])||(o+=t.buffer[i+1]);var s=1==o.length?r.regex.val1pre.test(o):r.regex.val1.test(o);if(!n&&!s){if(s=r.regex.val1.test(e+"0"))return t.buffer[i]=e,t.buffer[++i]="0",{pos:i,c:"0"};if(s=r.regex.val1.test("0"+e))return t.buffer[i]="0",i++,{pos:i}}return s},cardinality:1}]},2:{validator:function(e,t,i,n,r){var o=r.getFrontValue(t.mask,t.buffer,r);-1!=o.indexOf(r.placeholder[0])&&(o="01"+r.separator);var s=r.regex.val2(r.separator).test(o+e);if(!n&&!s&&(e.charAt(1)==r.separator||-1!="-./".indexOf(e.charAt(1)))&&(s=r.regex.val2(r.separator).test(o+"0"+e.charAt(0))))return t.buffer[i-1]="0",{refreshFromBuffer:{start:i-1,end:i},pos:i,c:e.charAt(0)};if(r.mask.indexOf("2")==r.mask.length-1&&s){var a=t.buffer.join("").substr(4,4)+e;if(a!=r.leapday)return!0;var l=parseInt(t.buffer.join("").substr(0,4),10);return l%4===0?l%100===0?l%400===0?!0:!1:!0:!1}return s},cardinality:2,prevalidator:[{validator:function(e,t,i,n,r){isNaN(t.buffer[i+1])||(e+=t.buffer[i+1]);var o=r.getFrontValue(t.mask,t.buffer,r);-1!=o.indexOf(r.placeholder[0])&&(o="01"+r.separator);var s=1==e.length?r.regex.val2pre(r.separator).test(o+e):r.regex.val2(r.separator).test(o+e);return n||s||!(s=r.regex.val2(r.separator).test(o+"0"+e))?s:(t.buffer[i]="0",i++,{pos:i})},cardinality:1}]},y:{validator:function(e,t,i,n,r){if(r.isInYearRange(e,r.yearrange.minyear,r.yearrange.maxyear)){var o=t.buffer.join("").substr(0,6);if(o!=r.leapday)return!0;var s=parseInt(e,10);return s%4===0?s%100===0?s%400===0?!0:!1:!0:!1}return!1},cardinality:4,prevalidator:[{validator:function(e,t,i,n,r){var o=r.isInYearRange(e,r.yearrange.minyear,r.yearrange.maxyear);if(!n&&!o){var s=r.determinebaseyear(r.yearrange.minyear,r.yearrange.maxyear,e+"0").toString().slice(0,1);if(o=r.isInYearRange(s+e,r.yearrange.minyear,r.yearrange.maxyear))return t.buffer[i++]=s.charAt(0),{pos:i};if(s=r.determinebaseyear(r.yearrange.minyear,r.yearrange.maxyear,e+"0").toString().slice(0,2),o=r.isInYearRange(s+e,r.yearrange.minyear,r.yearrange.maxyear))return t.buffer[i++]=s.charAt(0),t.buffer[i++]=s.charAt(1),{pos:i}}return o},cardinality:1},{validator:function(e,t,i,n,r){var o=r.isInYearRange(e,r.yearrange.minyear,r.yearrange.maxyear);if(!n&&!o){var s=r.determinebaseyear(r.yearrange.minyear,r.yearrange.maxyear,e).toString().slice(0,2);if(o=r.isInYearRange(e[0]+s[1]+e[1],r.yearrange.minyear,r.yearrange.maxyear))return t.buffer[i++]=s.charAt(1),{pos:i};if(s=r.determinebaseyear(r.yearrange.minyear,r.yearrange.maxyear,e).toString().slice(0,2),r.isInYearRange(s+e,r.yearrange.minyear,r.yearrange.maxyear)){var a=t.buffer.join("").substr(0,6);if(a!=r.leapday)o=!0;else{var l=parseInt(e,10);o=l%4===0?l%100===0?l%400===0?!0:!1:!0:!1}}else o=!1;if(o)return t.buffer[i-1]=s.charAt(0),t.buffer[i++]=s.charAt(1),t.buffer[i++]=e.charAt(0),{refreshFromBuffer:{start:i-3,end:i},pos:i}}return o},cardinality:2},{validator:function(e,t,i,n,r){return r.isInYearRange(e,r.yearrange.minyear,r.yearrange.maxyear)},cardinality:3}]}},insertMode:!1,autoUnmask:!1},"mm/dd/yyyy":{placeholder:"mm/dd/yyyy",alias:"dd/mm/yyyy",regex:{val2pre:function(e){var t=s.inputmask.escapeRegex.call(this,e);return new RegExp("((0[13-9]|1[012])"+t+"[0-3])|(02"+t+"[0-2])")},val2:function(e){var t=s.inputmask.escapeRegex.call(this,e);return new RegExp("((0[1-9]|1[012])"+t+"(0[1-9]|[12][0-9]))|((0[13-9]|1[012])"+t+"30)|((0[13578]|1[02])"+t+"31)")},val1pre:new RegExp("[01]"),val1:new RegExp("0[1-9]|1[012]")},leapday:"02/29/",onKeyDown:function(e,t,i,n){var r=s(this);if(e.ctrlKey&&e.keyCode==s.inputmask.keyCode.RIGHT){var o=new Date;r.val((o.getMonth()+1).toString()+o.getDate().toString()+o.getFullYear().toString()),r.triggerHandler("setvalue.inputmask")}}},"yyyy/mm/dd":{mask:"y/1/2",placeholder:"yyyy/mm/dd",alias:"mm/dd/yyyy",leapday:"/02/29",onKeyDown:function(e,t,i,n){var r=s(this);if(e.ctrlKey&&e.keyCode==s.inputmask.keyCode.RIGHT){var o=new Date;r.val(o.getFullYear().toString()+(o.getMonth()+1).toString()+o.getDate().toString()),r.triggerHandler("setvalue.inputmask")}}},"dd.mm.yyyy":{mask:"1.2.y",placeholder:"dd.mm.yyyy",leapday:"29.02.",separator:".",alias:"dd/mm/yyyy"},"dd-mm-yyyy":{mask:"1-2-y",placeholder:"dd-mm-yyyy",leapday:"29-02-",separator:"-",alias:"dd/mm/yyyy"},"mm.dd.yyyy":{mask:"1.2.y",placeholder:"mm.dd.yyyy",leapday:"02.29.",separator:".",alias:"mm/dd/yyyy"},"mm-dd-yyyy":{mask:"1-2-y",placeholder:"mm-dd-yyyy",leapday:"02-29-",separator:"-",alias:"mm/dd/yyyy"},"yyyy.mm.dd":{mask:"y.1.2",placeholder:"yyyy.mm.dd",leapday:".02.29",separator:".",alias:"yyyy/mm/dd"},"yyyy-mm-dd":{mask:"y-1-2",placeholder:"yyyy-mm-dd",leapday:"-02-29",separator:"-",alias:"yyyy/mm/dd"},datetime:{mask:"1/2/y h:s",placeholder:"dd/mm/yyyy hh:mm",alias:"dd/mm/yyyy",regex:{hrspre:new RegExp("[012]"),hrs24:new RegExp("2[0-4]|1[3-9]"),hrs:new RegExp("[01][0-9]|2[0-4]"),ampm:new RegExp("^[a|p|A|P][m|M]"),mspre:new RegExp("[0-5]"),ms:new RegExp("[0-5][0-9]")},timeseparator:":",hourFormat:"24",definitions:{h:{validator:function(e,t,i,n,r){if("24"==r.hourFormat&&24==parseInt(e,10))return t.buffer[i-1]="0",t.buffer[i]="0",{refreshFromBuffer:{start:i-1,end:i},c:"0"};var o=r.regex.hrs.test(e);if(!n&&!o&&(e.charAt(1)==r.timeseparator||-1!="-.:".indexOf(e.charAt(1)))&&(o=r.regex.hrs.test("0"+e.charAt(0))))return t.buffer[i-1]="0",t.buffer[i]=e.charAt(0),i++,{refreshFromBuffer:{start:i-2,end:i},pos:i,c:r.timeseparator};if(o&&"24"!==r.hourFormat&&r.regex.hrs24.test(e)){var s=parseInt(e,10);return 24==s?(t.buffer[i+5]="a",t.buffer[i+6]="m"):(t.buffer[i+5]="p",t.buffer[i+6]="m"),s-=12,10>s?(t.buffer[i]=s.toString(),t.buffer[i-1]="0"):(t.buffer[i]=s.toString().charAt(1),t.buffer[i-1]=s.toString().charAt(0)),{refreshFromBuffer:{start:i-1,end:i+6},c:t.buffer[i]}}return o},cardinality:2,prevalidator:[{validator:function(e,t,i,n,r){var o=r.regex.hrspre.test(e);return n||o||!(o=r.regex.hrs.test("0"+e))?o:(t.buffer[i]="0",i++,{pos:i})},cardinality:1}]},s:{validator:"[0-5][0-9]",cardinality:2,prevalidator:[{validator:function(e,t,i,n,r){var o=r.regex.mspre.test(e);return n||o||!(o=r.regex.ms.test("0"+e))?o:(t.buffer[i]="0",i++,{pos:i})},cardinality:1}]},t:{validator:function(e,t,i,n,r){return r.regex.ampm.test(e+"m")},casing:"lower",cardinality:1}},insertMode:!1,autoUnmask:!1},datetime12:{mask:"1/2/y h:s t\\m",placeholder:"dd/mm/yyyy hh:mm xm",alias:"datetime",hourFormat:"12"},"hh:mm t":{mask:"h:s t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"h:s t":{mask:"h:s t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"hh:mm:ss":{mask:"h:s:s",placeholder:"hh:mm:ss",alias:"datetime",autoUnmask:!1},"hh:mm":{mask:"h:s",placeholder:"hh:mm",alias:"datetime",autoUnmask:!1},date:{alias:"dd/mm/yyyy"},"mm/yyyy":{mask:"1/y",placeholder:"mm/yyyy",leapday:"donotuse",separator:"/",alias:"mm/dd/yyyy"}}),s.fn.inputmask}(jQuery),function(e){return e.extend(e.inputmask.defaults.definitions,{A:{validator:"[A-Za-z–ê-—è–Å—ë√Ä-√ø¬µ]",cardinality:1,casing:"upper"},"#":{validator:"[0-9A-Za-z–ê-—è–Å—ë√Ä-√ø¬µ]",cardinality:1,casing:"upper"}}),e.extend(e.inputmask.defaults.aliases,{url:{mask:"ir",placeholder:"",separator:"",defaultPrefix:"http://",regex:{urlpre1:new RegExp("[fh]"),urlpre2:new RegExp("(ft|ht)"),urlpre3:new RegExp("(ftp|htt)"),urlpre4:new RegExp("(ftp:|http|ftps)"),urlpre5:new RegExp("(ftp:/|ftps:|http:|https)"),urlpre6:new RegExp("(ftp://|ftps:/|http:/|https:)"),urlpre7:new RegExp("(ftp://|ftps://|http://|https:/)"),urlpre8:new RegExp("(ftp://|ftps://|http://|https://)")},definitions:{i:{validator:function(e,t,i,n,r){return!0},cardinality:8,prevalidator:function(){for(var e=[],t=8,i=0;t>i;i++)e[i]=function(){var l=i;return{validator:function(e,t,i,n,r){if(r.regex["urlpre"+(l+1)]){var o,s=e;l+1-e.length>0&&(s=t.buffer.join("").substring(0,l+1-e.length)+""+s);var a=r.regex["urlpre"+(l+1)].test(s);if(!n&&!a){for(i-=l,o=0;o<r.defaultPrefix.length;o++)t.buffer[i]=r.defaultPrefix[o],i++;for(o=0;o<s.length-1;o++)t.buffer[i]=s[o],i++;return{pos:i}}return a}return!1},cardinality:l}}();return e}()},r:{validator:".",cardinality:50}},insertMode:!1,autoUnmask:!1},ip:{mask:"i[i[i]].i[i[i]].i[i[i]].i[i[i]]",definitions:{i:{validator:function(e,t,i,n,r){return i-1>-1&&"."!=t.buffer[i-1]?(e=t.buffer[i-1]+e,e=i-2>-1&&"."!=t.buffer[i-2]?t.buffer[i-2]+e:"0"+e):e="00"+e,new RegExp("25[0-5]|2[0-4][0-9]|[01][0-9][0-9]").test(e)},cardinality:1}}},email:{mask:"*{1,64}[.*{1,64}][.*{1,64}][.*{1,64}]@*{1,64}[.*{2,64}][.*{2,6}][.*{1,2}]",greedy:!1,onBeforePaste:function(e,t){return e=e.toLowerCase(),e.replace("mailto:","")},definitions:{"*":{validator:"[0-9A-Za-z!#$%&'*+/=?^_`{|}~-]",cardinality:1,casing:"lower"}}}}),e.fn.inputmask}(jQuery),function(m){return m.extend(m.inputmask.defaults.aliases,{numeric:{mask:function(n){function e(e){for(var t="",i=0;i<e.length;i++)t+=n.definitions[e[i]]?"\\"+e[i]:e[i];return t}if(0!==n.repeat&&isNaN(n.integerDigits)&&(n.integerDigits=n.repeat),n.repeat=0,n.groupSeparator==n.radixPoint&&("."==n.radixPoint?n.groupSeparator=",":","==n.radixPoint?n.groupSeparator=".":n.groupSeparator="")," "===n.groupSeparator&&(n.skipOptionalPartCharacter=void 0),n.autoGroup=n.autoGroup&&""!=n.groupSeparator,n.autoGroup&&("string"==typeof n.groupSize&&isFinite(n.groupSize)&&(n.groupSize=parseInt(n.groupSize)),isFinite(n.integerDigits))){var t=Math.floor(n.integerDigits/n.groupSize),i=n.integerDigits%n.groupSize;n.integerDigits=parseInt(n.integerDigits)+(0==i?t-1:t)}n.placeholder.length>1&&(n.placeholder=n.placeholder.charAt(0)),n.radixFocus=n.radixFocus&&"0"==n.placeholder,n.definitions[";"]=n.definitions["~"];var r=e(n.prefix);return r+="[+]",r+="~{1,"+n.integerDigits+"}",void 0!=n.digits&&(isNaN(n.digits)||parseInt(n.digits)>0)&&(r+=n.digitsOptional?"["+(n.decimalProtect?":":n.radixPoint)+";{"+n.digits+"}]":(n.decimalProtect?":":n.radixPoint)+";{"+n.digits+"}"),""!=n.negationSymbol.back&&(r+="[-]"),r+=e(n.suffix),n.greedy=!1,r},placeholder:"",greedy:!1,digits:"*",digitsOptional:!0,groupSeparator:"",radixPoint:".",radixFocus:!0,groupSize:3,autoGroup:!1,allowPlus:!0,allowMinus:!0,negationSymbol:{front:"-",back:""},integerDigits:"+",prefix:"",suffix:"",rightAlign:!0,decimalProtect:!0,min:void 0,max:void 0,postFormat:function(e,t,i,n){var r=!1;e.length>=n.suffix.length&&e.join("").indexOf(n.suffix)==e.length-n.suffix.length&&(e.length=e.length-n.suffix.length,r=!0),t=t>=e.length?e.length-1:t<n.prefix.length?n.prefix.length:t;var o=!1,s=e[t];if(""==n.groupSeparator||-1!=m.inArray(n.radixPoint,e)&&t>=m.inArray(n.radixPoint,e)||new RegExp("["+m.inputmask.escapeRegex(n.negationSymbol.front)+"+]").test(s)){if(r)for(var a=0,l=n.suffix.length;l>a;a++)e.push(n.suffix.charAt(a));return{pos:t}}var c=e.slice();s==n.groupSeparator&&(c.splice(t--,1),s=c[t]),i?c[t]="?":c.splice(t,0,"?");var u=c.join(""),d=u;if(u.length>0&&n.autoGroup||i&&-1!=u.indexOf(n.groupSeparator)){var h=m.inputmask.escapeRegex(n.groupSeparator);o=0==u.indexOf(n.groupSeparator),u=u.replace(new RegExp(h,"g"),"");var f=u.split(n.radixPoint);if(u=""==n.radixPoint?u:f[0],u!=n.prefix+"?0"&&u.length>=n.groupSize+n.prefix.length)for(var p=new RegExp("([-+]?[\\d?]+)([\\d?]{"+n.groupSize+"})");p.test(u);)u=u.replace(p,"$1"+n.groupSeparator+"$2"),u=u.replace(n.groupSeparator+n.groupSeparator,n.groupSeparator);""!=n.radixPoint&&f.length>1&&(u+=n.radixPoint+f[1])}o=d!=u,e.length=u.length;for(var a=0,l=u.length;l>a;a++)e[a]=u.charAt(a);var g=m.inArray("?",e);if(i?e[g]=s:e.splice(g,1),!o&&r)for(var a=0,l=n.suffix.length;l>a;a++)e.push(n.suffix.charAt(a));return{pos:g,refreshFromBuffer:o,buffer:e}},onBeforeWrite:function(e,t,i,n){if(e&&"blur"==e.type){var r=t.join(""),o=r.replace(n.prefix,"");if(o=o.replace(n.suffix,""),o=o.replace(new RegExp(m.inputmask.escapeRegex(n.groupSeparator),"g"),""),","===n.radixPoint&&(o=o.replace(m.inputmask.escapeRegex(n.radixPoint),".")),isFinite(o)&&isFinite(n.min)&&parseFloat(o)<parseFloat(n.min))return m.extend(!0,{refreshFromBuffer:!0,buffer:(n.prefix+n.min).split("")},n.postFormat((n.prefix+n.min).split(""),0,!0,n));var s=""!=n.radixPoint?t.join("").split(n.radixPoint):[t.join("")],a=s[0].match(n.regex.integerPart(n)),l=2==s.length?s[1].match(n.regex.integerNPart(n)):void 0;!a||a[0]!=n.negationSymbol.front+"0"&&a[0]!=n.negationSymbol.front&&"+"!=a[0]||void 0!=l&&!l[0].match(/^0+$/)||t.splice(a.index,1);var c=m.inArray(n.radixPoint,t);if(-1!=c&&isFinite(n.digits)&&!n.digitsOptional){for(var u=1;u<=n.digits;u++)(void 0==t[c+u]||t[c+u]==n.placeholder.charAt(0))&&(t[c+u]="0");return{refreshFromBuffer:!0,buffer:t}}}if(n.autoGroup){var d=n.postFormat(t,i-1,!0,n);return d.caret=i<=n.prefix.length?d.pos:d.pos+1,d}},regex:{integerPart:function(e){return new RegExp("["+m.inputmask.escapeRegex(e.negationSymbol.front)+"+]?\\d+")},integerNPart:function(e){return new RegExp("[\\d"+m.inputmask.escapeRegex(e.groupSeparator)+"]+")}},signHandler:function(e,t,i,n,r){if(!n&&r.allowMinus&&"-"===e||r.allowPlus&&"+"===e){var o=t.buffer.join("").match(r.regex.integerPart(r));if(o&&o[0].length>0)return t.buffer[o.index]==("-"===e?"+":r.negationSymbol.front)?"-"==e?""!=r.negationSymbol.back?{pos:o.index,c:r.negationSymbol.front,remove:o.index,caret:i,insert:{pos:t.buffer.length-r.suffix.length-1,c:r.negationSymbol.back}}:{pos:o.index,c:r.negationSymbol.front,remove:o.index,caret:i}:""!=r.negationSymbol.back?{pos:o.index,c:"+",remove:[o.index,t.buffer.length-r.suffix.length-1],caret:i}:{pos:o.index,c:"+",remove:o.index,caret:i}:t.buffer[o.index]==("-"===e?r.negationSymbol.front:"+")?"-"==e&&""!=r.negationSymbol.back?{remove:[o.index,t.buffer.length-r.suffix.length-1],caret:i-1}:{remove:o.index,caret:i-1}:"-"==e?""!=r.negationSymbol.back?{pos:o.index,c:r.negationSymbol.front,caret:i+1,insert:{pos:t.buffer.length-r.suffix.length,c:r.negationSymbol.back}}:{pos:o.index,c:r.negationSymbol.front,caret:i+1}:{pos:o.index,c:e,caret:i+1}}return!1},radixHandler:function(e,t,i,n,r){if(!n&&e===r.radixPoint&&r.digits>0){var o=m.inArray(r.radixPoint,t.buffer),s=t.buffer.join("").match(r.regex.integerPart(r));if(-1!=o&&t.validPositions[o])return t.validPositions[o-1]?{caret:o+1}:{pos:s.index,c:s[0],caret:o+1};if(!s||"0"==s[0]&&s.index+1!=i)return t.buffer[s?s.index:i]="0",{pos:(s?s.index:i)+1}}return!1},leadingZeroHandler:function(e,t,i,n,r){var o=t.buffer.join("").match(r.regex.integerNPart(r)),s=m.inArray(r.radixPoint,t.buffer);if(o&&!n&&(-1==s||s>=i))if(0==o[0].indexOf("0")){i<r.prefix.length&&(i=o.index);var a=m.inArray(r.radixPoint,t._buffer),l=t._buffer&&t.buffer.slice(s).join("")==t._buffer.slice(a).join("")||0==parseInt(t.buffer.slice(s+1).join("")),c=t._buffer&&t.buffer.slice(o.index,s).join("")==t._buffer.slice(r.prefix.length,a).join("")||"0"==t.buffer.slice(o.index,s).join("");if(-1==s||l&&c)return t.buffer.splice(o.index,1),i=i>o.index?i-1:o.index,{pos:i,remove:o.index};if(o.index+1==i||"0"==e)return t.buffer.splice(o.index,1),i=o.index,{pos:i,remove:o.index}}else if("0"===e&&i<=o.index&&o[0]!=r.groupSeparator)return!1;return!0},postValidation:function(e,t){var i=!0,n=e.join(""),r=n.replace(t.prefix,"");return r=r.replace(t.suffix,""),r=r.replace(new RegExp(m.inputmask.escapeRegex(t.groupSeparator),"g"),""),","===t.radixPoint&&(r=r.replace(m.inputmask.escapeRegex(t.radixPoint),".")),r=r.replace(new RegExp("^"+m.inputmask.escapeRegex(t.negationSymbol.front)),"-"),r=r.replace(new RegExp(m.inputmask.escapeRegex(t.negationSymbol.back)+"$"),""),isFinite(r)&&isFinite(t.max)&&(i=parseFloat(r)<=parseFloat(t.max)),i},definitions:{"~":{validator:function(e,t,i,n,r){var o=r.signHandler(e,t,i,n,r);if(!o&&(o=r.radixHandler(e,t,i,n,r),!o&&(o=n?new RegExp("[0-9"+m.inputmask.escapeRegex(r.groupSeparator)+"]").test(e):new RegExp("[0-9]").test(e),o===!0&&(o=r.leadingZeroHandler(e,t,i,n,r),o===!0)))){var s=m.inArray(r.radixPoint,t.buffer);o=r.digitsOptional===!1&&i>s&&!n?{pos:i,remove:i}:{pos:i}}return o},cardinality:1,prevalidator:null},"+":{validator:function(e,t,i,n,r){var o=r.signHandler(e,t,i,n,r);return!o&&(n&&r.allowMinus&&e===r.negationSymbol.front||r.allowMinus&&"-"==e||r.allowPlus&&"+"==e)&&(o="-"==e?""!=r.negationSymbol.back?{pos:i,c:"-"===e?r.negationSymbol.front:"+",caret:i+1,insert:{pos:t.buffer.length,c:r.negationSymbol.back}}:{pos:i,c:"-"===e?r.negationSymbol.front:"+",caret:i+1}:!0),o},cardinality:1,prevalidator:null,placeholder:""},"-":{validator:function(e,t,i,n,r){var o=r.signHandler(e,t,i,n,r);return!o&&n&&r.allowMinus&&e===r.negationSymbol.back&&(o=!0),o},cardinality:1,prevalidator:null,placeholder:""},":":{validator:function(e,t,i,n,r){var o=r.signHandler(e,t,i,n,r);if(!o){var s="["+m.inputmask.escapeRegex(r.radixPoint)+"]";o=new RegExp(s).test(e),o&&t.validPositions[i]&&t.validPositions[i].match.placeholder==r.radixPoint&&(o={caret:i+1})}return o},cardinality:1,prevalidator:null,placeholder:function(e){return e.radixPoint}}},insertMode:!0,autoUnmask:!1,unmaskAsNumber:!1,onUnMask:function(e,t,i){var n=e.replace(i.prefix,"");return n=n.replace(i.suffix,""),n=n.replace(new RegExp(m.inputmask.escapeRegex(i.groupSeparator),"g"),""),i.unmaskAsNumber?(n=n.replace(m.inputmask.escapeRegex.call(this,i.radixPoint),"."),Number(n)):n},isComplete:function(e,t){var i=e.join(""),n=e.slice();if(t.postFormat(n,0,!0,t),n.join("")!=i)return!1;var r=i.replace(t.prefix,"");return r=r.replace(t.suffix,""),r=r.replace(new RegExp(m.inputmask.escapeRegex(t.groupSeparator),"g"),""),","===t.radixPoint&&(r=r.replace(m.inputmask.escapeRegex(t.radixPoint),".")),isFinite(r)},onBeforeMask:function(e,t){if(""!=t.radixPoint&&isFinite(e))e=e.toString().replace(".",t.radixPoint);else{var i=e.match(/,/g),n=e.match(/\./g);n&&i?n.length>i.length?(e=e.replace(/\./g,""),e=e.replace(",",t.radixPoint)):i.length>n.length?(e=e.replace(/,/g,""),e=e.replace(".",t.radixPoint)):e=e.indexOf(".")<e.indexOf(",")?e.replace(/\./g,""):e=e.replace(/,/g,""):e=e.replace(new RegExp(m.inputmask.escapeRegex(t.groupSeparator),"g"),"")}return 0==t.digits&&(-1!=e.indexOf(".")?e=e.substring(0,e.indexOf(".")):-1!=e.indexOf(",")&&(e=e.substring(0,e.indexOf(",")))),e},canClearPosition:function(e,t,i,n,r){var o=e.validPositions[t].input,s=o!=r.radixPoint&&isFinite(o)||t==i||o==r.groupSeparator||o==r.negationSymbol.front||o==r.negationSymbol.back;if(s&&isFinite(o)){var a;if(!n&&e.buffer){a=e.buffer.join("").substr(0,t).match(r.regex.integerNPart(r));var l=t+1,c=null==a||0==parseInt(a[0].replace(new RegExp(m.inputmask.escapeRegex(r.groupSeparator),"g"),""));if(c)for(;e.validPositions[l]&&(e.validPositions[l].input==r.groupSeparator||"0"==e.validPositions[l].input);)delete e.validPositions[l],l++}var u=[];for(var d in e.validPositions)u.push(e.validPositions[d].input);a=u.join("").match(r.regex.integerNPart(r));var h=m.inArray(r.radixPoint,e.buffer);if(a&&(-1==h||h>=t))if(0==a[0].indexOf("0"))s=a.index!=t||-1==h;else{var f=parseInt(a[0].replace(new RegExp(m.inputmask.escapeRegex(r.groupSeparator),"g"),""));-1!=h&&10>f&&"0"==r.placeholder.charAt(0)&&(e.validPositions[t].input="0",e.p=r.prefix.length+1,s=!1)}}return s}},currency:{prefix:"$ ",groupSeparator:",",alias:"numeric",placeholder:"0",autoGroup:!0,digits:2,digitsOptional:!1,clearMaskOnLostFocus:!1},decimal:{alias:"numeric"},integer:{alias:"numeric",digits:"0",radixPoint:""}}),m.fn.inputmask}(jQuery),function(e){return e.extend(e.inputmask.defaults.aliases,{phone:{url:"phone-codes/phone-codes.js",countrycode:"",mask:function(n){n.definitions["#"]=n.definitions[9];var t=[];return e.ajax({url:n.url,async:!1,dataType:"json",success:function(e){t=e},error:function(e,t,i){alert(i+" - "+n.url)}}),t=t.sort(function(e,t){return(e.mask||e)<(t.mask||t)?-1:1})},keepStatic:!1,nojumps:!0,nojumpsThreshold:1,onBeforeMask:function(e,t){var i=e.replace(/^0/g,"");return(i.indexOf(t.countrycode)>1||-1==i.indexOf(t.countrycode))&&(i="+"+t.countrycode+i),i}},phonebe:{alias:"phone",url:"phone-codes/phone-be.js",countrycode:"32",nojumpsThreshold:4}}),e.fn.inputmask}(jQuery),function(_){return _.extend(_.inputmask.defaults.aliases,{Regex:{mask:"r",greedy:!1,repeat:"*",regex:null,regexTokens:null,tokenizer:/\[\^?]?(?:[^\\\]]+|\\[\S\s]?)*]?|\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9][0-9]*|x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4}|c[A-Za-z]|[\S\s]?)|\((?:\?[:=!]?)?|(?:[?*+]|\{[0-9]+(?:,[0-9]*)?\})\??|[^.?*+^${[()|\\]+|./g,quantifierFilter:/[0-9]+[^,]/,isComplete:function(e,t){return new RegExp(t.regex).test(e.join(""))},definitions:{r:{validator:function(e,t,i,n,u){function d(e,t){this.matches=[],this.isGroup=e||!1,this.isQuantifier=t||!1,this.quantifier={min:1,max:1},this.repeaterPart=void 0}function r(){var e,t,i=new d,n=[];for(u.regexTokens=[];e=u.tokenizer.exec(u.regex);)switch(t=e[0],t.charAt(0)){case"(":n.push(new d(!0));break;case")":var r=n.pop();n.length>0?n[n.length-1].matches.push(r):i.matches.push(r);break;case"{":case"+":case"*":var o=new d(!1,!0);t=t.replace(/[{}]/g,"");var s=t.split(","),a=isNaN(s[0])?s[0]:parseInt(s[0]),l=1==s.length?a:isNaN(s[1])?s[1]:parseInt(s[1]);if(o.quantifier={min:a,max:l},n.length>0){var c=n[n.length-1].matches;if(e=c.pop(),!e.isGroup){var r=new d(!0);r.matches.push(e),e=r}c.push(e),c.push(o)}else{if(e=i.matches.pop(),!e.isGroup){var r=new d(!0);r.matches.push(e),e=r}i.matches.push(e),i.matches.push(o)}break;default:n.length>0?n[n.length-1].matches.push(t):i.matches.push(t)}i.matches.length>0&&u.regexTokens.push(i)}function m(e,t){var i=!1;t&&(v+="(",y++);for(var n=0;n<e.matches.length;n++){var r=e.matches[n];if(1==r.isGroup)i=m(r,!0);else if(1==r.isQuantifier){var o=_.inArray(r,e.matches),s=e.matches[o-1],a=v;if(isNaN(r.quantifier.max)){for(;r.repeaterPart&&r.repeaterPart!=v&&r.repeaterPart.length>v.length&&!(i=m(s,!0)););i=i||m(s,!0),i&&(r.repeaterPart=v),v=a+r.quantifier.max}else{for(var l=0,c=r.quantifier.max-1;c>l&&!(i=m(s,!0));l++);v=a+"{"+r.quantifier.min+","+r.quantifier.max+"}"}}else if(void 0!=r.matches)for(var u=0;u<r.length&&!(i=m(r[u],t));u++);else{var d;if("["==r.charAt(0)){d=v,d+=r;for(var h=0;y>h;h++)d+=")";var f=new RegExp("^("+d+")$");i=f.test(b)}else for(var p=0,g=r.length;g>p;p++)if("\\"!=r.charAt(p)){d=v,d+=r.substr(0,p+1),d=d.replace(/\|$/,"");for(var h=0;y>h;h++)d+=")";var f=new RegExp("^("+d+")$");if(i=f.test(b))break}v+=r}if(i)break}return t&&(v+=")",y--),i}null==u.regexTokens&&r();var o=t.buffer.slice(),v="",s=!1,y=0;o.splice(i,0,e);for(var b=o.join(""),a=0;a<u.regexTokens.length;a++){var d=u.regexTokens[a];if(s=m(d,d.isGroup))break}return s},cardinality:1}}}}),_.fn.inputmask}(jQuery);(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports==="object"){e(require("jquery"))}else{e(window.jQuery)}})(function(l){"use strict";var n=0;l.ajaxTransport("iframe",function(r){if(r.async){var o=r.initialIframeSrc||"javascript:false;",s,a,t;return{send:function(e,i){s=l('<form style="display:none;"></form>');s.attr("accept-charset",r.formAcceptCharset);t=/\?/.test(r.url)?"&":"?";if(r.type==="DELETE"){r.url=r.url+t+"_method=DELETE";r.type="POST"}else if(r.type==="PUT"){r.url=r.url+t+"_method=PUT";r.type="POST"}else if(r.type==="PATCH"){r.url=r.url+t+"_method=PATCH";r.type="POST"}n+=1;a=l('<iframe src="'+o+'" name="iframe-transport-'+n+'"></iframe>').bind("load",function(){var n,t=l.isArray(r.paramName)?r.paramName:[r.paramName];a.unbind("load").bind("load",function(){var t;try{t=a.contents();if(!t.length||!t[0].firstChild){throw new Error}}catch(e){t=undefined}i(200,"success",{iframe:t});l('<iframe src="'+o+'"></iframe>').appendTo(s);window.setTimeout(function(){s.remove()},0)});s.prop("target",a.prop("name")).prop("action",r.url).prop("method",r.type);if(r.formData){l.each(r.formData,function(e,t){l('<input type="hidden"/>').prop("name",t.name).val(t.value).appendTo(s)})}if(r.fileInput&&r.fileInput.length&&r.type==="POST"){n=r.fileInput.clone();r.fileInput.after(function(e){return n[e]});if(r.paramName){r.fileInput.each(function(e){l(this).prop("name",t[e]||r.paramName)})}s.append(r.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data");r.fileInput.removeAttr("form")}s.submit();if(n&&n.length){r.fileInput.each(function(e,t){var i=l(n[e]);l(t).prop("name",i.prop("name")).attr("form",i.attr("form"));i.replaceWith(t)})}});s.append(a).appendTo(document.body)},abort:function(){if(a){a.unbind("load").prop("src",o)}if(s){s.remove()}}}}});l.ajaxSetup({converters:{"iframe text":function(e){return e&&l(e[0].body).text()},"iframe json":function(e){return e&&l.parseJSON(l(e[0].body).text())},"iframe html":function(e){return e&&l(e[0].body).html()},"iframe xml":function(e){var t=e&&e[0];return t&&l.isXMLDoc(t)?t:l.parseXML(t.XMLDocument&&t.XMLDocument.xml||l(t.body).html())},"iframe script":function(e){return e&&l.globalEval(l(e[0].body).text())}}})});(function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e){this.el=e;this.dragleave=t(this.dragleave,this);this.dragenter=t(this.dragenter,this);if(this.supportsEventConstructors()){this.first=false;this.second=false;this.el.addEventListener("dragenter",this.dragenter,false);this.el.addEventListener("dragleave",this.dragleave,false)}}e.prototype.dragenter=function(e){if(this.first){return this.second=true}else{this.first=true;return this.el.dispatchEvent(new CustomEvent("dragster:enter",{bubbles:true,cancelable:true,detail:{dataTransfer:e.dataTransfer}}))}};e.prototype.dragleave=function(e){if(this.second){this.second=false}else if(this.first){this.first=false}if(!this.first&&!this.second){return this.el.dispatchEvent(new CustomEvent("dragster:leave",{bubbles:true,cancelable:true,detail:{dataTransfer:e.dataTransfer}}))}};e.prototype.removeListeners=function(){this.el.removeEventListener("dragenter",this.dragenter,false);return this.el.removeEventListener("dragleave",this.dragleave,false)};e.prototype.supportsEventConstructors=function(){try{new CustomEvent("z")}catch(e){return false}return true};e.prototype.reset=function(){this.first=false;return this.second=false};return e}();if(typeof module==="undefined"){window.Dragster=e}else{module.exports=e}}).call(this);(function(){var e;e=function(){function e(e,t){var i;if(t==null){t=[]}i={script:null,ajaxQueue:false,autoUpload:false,classDragOver:"is-dragover",onUploadingFiles:function(e,t){},onSelectFiles:function(e,t){},onSuccessFile:function(e,t,i){},onComplete:function(e,t){},onFileError:function(e,t){},onFileFail:function(e,t){}};this.options=$.extend(i,t);this.files=[];$.each($(e),function(r){return function(e,t){var i,n;i=$(t);n=i.find("input[type=file]");i.data("pos",e);n.on("change",function(e){var t;t=$(e.currentTarget).prop("files");r.options.onSelectFiles(t,i);r.files[i.data("pos")]=e.target.files;if(r.options.autoUpload){return r.submit(i,e.target.files)}});return r.initDrag(i)}}(this))}e.prototype.initDrag=function(i){var n;if(this.isAdvancedUpload()){n=false;return i.on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault();e.stopPropagation()}).on("dragover dragenter",function(e){return function(){i.addClass(e.options.classDragOver)}}(this)).on("dragleave dragend drop",function(e){return function(){i.removeClass(e.options.classDragOver)}}(this)).on("drop",function(t){return function(e){n=e.originalEvent.dataTransfer.files;t.options.onSelectFiles(n,i);if(t.options.autoUpload){return t.submit(i,n)}else{return t.files[i.data("pos")]=n}}}(this))}};e.prototype.startUpload=function(e){var t;t=this.files[e.data("pos")];if(t){return this.submit(e,t)}};e.prototype.submit=function(i,t){var e,n,r,o,s,a,l,c,u,d;if(i.hasClass("is-uploading")){return false}i.addClass("is-uploading");u=t.length;d=1;r=i.find("input[type=file]").attr("name");this.options.onUploadingFiles(d,u);c=[];for(s=o=0,a=t.length;o<a;s=++o){n=t[s];l=new FormData;l.append(r+"[]",n);l.append("position",s);e=this.options.ajaxQueue?$.ajaxQueue:$.ajax;c.push(e({url:this.options.script,type:"POST",data:l,processData:false,contentType:false,cache:false,complete:function(e){return function(){d++;if(d>=u+1){e.options.onComplete(t,i);e.removeFiles(i);return i.removeClass("is-uploading")}else{return e.options.onUploadingFiles(d,u)}}}(this),success:function(t){return function(e){t.options.onSuccessFile(n,e,i)}}(this),fail:function(t){return function(e){t.options.onFileFail(e,i)}}(this),error:function(t){return function(e){t.options.onFileError(e,i)}}(this)}))}return c};e.prototype.removeFiles=function(e){return this.files[e.data("pos")]=null};e.prototype.isAdvancedUpload=function(){var e;e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&"FormData"in window&&"FileReader"in window};e.prototype.isFormData=function(){return"FormData"in window};e.prototype.isFileReader=function(){return"FileReader"in window};e.prototype.isDraggable=function(){var e;e=document.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e};return e}();if(typeof module==="undefined"){window.Dropzone=e}else{module.exports=e}return e}).call(this);window=typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{};document=window.document||{};(function(e,t){if(typeof require==="function"&&typeof exports==="object"&&typeof module==="object"){e(require("jquery"))}else if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(t.jQuery)}})(function(C){"use strict";var g=0;var s={};var a={};var x=window.emojione;var n=[];function r(e){if(x){e()}else{n.push(e)}}var S="data:image/gif;base64,R0lGODlhAQABAJH/AP///wAAAMDAwAAAACH5BAEAAAIALAAAAAABAAEAAAICVAEAOw==";var o=[].slice;var A="emojionearea";var E=0;var T="&#8203;";function D(i,e,n){var r=true,t=1;if(e){e=e.toLowerCase();do{var o=t==1?"@"+e:e;if(s[i.id][o]&&s[i.id][o].length){C.each(s[i.id][o],function(e,t){return r=t.apply(i,n||[])!==false})}}while(r&&!!t--)}return r}function R(i,n,r,o){o=o||function(e,t){return C(t.currentTarget)};C.each(r,function(e,t){e=C.isArray(r)?t:e;(a[i.id][t]||(a[i.id][t]=[])).push([n,e,o])})}function l(e,t,i){var n=x.imageType,r;if(n=="svg"){r=x.imagePathSVG}else{r=x.imagePathPNG}var o="";if(i){o=i.substr(1,i.length-2).replace(/_/g," ").replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}var s="";if(t.uc_base&&E>4){s=t.uc_base;t=t.uc_output.toUpperCase()}else{s=t}e=e.replace("{name}",i||"").replace("{friendlyName}",o).replace("{img}",r+(E<2?s.toUpperCase():s)+"."+n).replace("{uni}",t);if(i){e=e.replace("{alt}",x.shortnameToUnicode(i))}else{e=e.replace("{alt}",x.convert(t))}return e}function M(e,i,n){return e.replace(/:?\+?[\w_\-]+:?/g,function(e){e=":"+e.replace(/:$/,"").replace(/^:/,"")+":";var t=x.emojioneList[e];if(t){if(E>4){return l(i,t,e)}else{if(E>3)t=t.unicode;return l(i,t[t.length-1],e)}}return n?"":e})}function k(e){var t,i;if(window.getSelection){t=window.getSelection();if(t.getRangeAt&&t.rangeCount){i=t.getRangeAt(0);i.deleteContents();var n=document.createElement("div");n.innerHTML=e;var r=document.createDocumentFragment(),o,s;while(o=n.firstChild){s=r.appendChild(o)}i.insertNode(r);if(s){i=i.cloneRange();i.setStartAfter(s);i.collapse(true);t.removeAllRanges();t.addRange(i)}}}else if(document.selection&&document.selection.type!="Control"){document.selection.createRange().pasteHTML(e)}}function c(){return window.emojioneVersion||"3.1.2"}function O(e){return typeof e==="object"}function u(e){var t;if(e.cacheBustParam){t=e.cacheBustParam;if(!O(e["jsEscapeMap"]))return"1.5.2";if(t==="?v=1.2.4")return"2.0.0";if(t==="?v=2.0.1")return"2.1.0";if(t==="?v=2.1.1")return"2.1.1";if(t==="?v=2.1.2")return"2.1.2";if(t==="?v=2.1.3")return"2.1.3";if(t==="?v=2.1.4")return"2.1.4";if(t==="?v=2.2.7")return"2.2.7";return"2.2.7"}else{return e.emojiVersion}}function d(e){switch(e){case"1.5.2":return 0;case"2.0.0":return 1;case"2.1.0":case"2.1.1":return 2;case"2.1.2":return 3;case"2.1.3":case"2.1.4":case"2.2.7":return 4;case"3.0.1":case"3.0.2":case"3.0.3":case"3.0":return 5;case"3.1.0":case"3.1.1":case"3.1.2":case"3.1":default:return 6}}function i(){if(C.fn.emojioneArea&&C.fn.emojioneArea.defaults){return C.fn.emojioneArea.defaults}var e={attributes:{dir:"ltr",spellcheck:false,autocomplete:"off",autocorrect:"off",autocapitalize:"off"},search:true,placeholder:null,emojiPlaceholder:":smiley:",searchPlaceholder:"SEARCH",container:null,hideSource:true,shortnames:true,sprite:true,pickerPosition:"top",filtersPosition:"top",searchPosition:"top",hidePickerOnBlur:true,buttonTitle:"Use the TAB key to insert emoji faster",tones:true,tonesStyle:"bullet",inline:null,saveEmojisAs:"unicode",shortcuts:true,autocomplete:true,autocompleteTones:false,standalone:false,useInternalCDN:true,imageType:"png",recentEmojis:true,textcomplete:{maxCount:15,placement:null}};var t=!x?d(c()):d(u(x));if(t>4){e.filters={tones:{title:"Diversity",emoji:"open_hands raised_hands palms_up_together clap pray thumbsup thumbsdown punch fist left_facing_fist right_facing_fist "+"fingers_crossed v metal love_you_gesture ok_hand point_left point_right point_up_2 point_down point_up raised_hand "+"raised_back_of_hand hand_splayed vulcan wave call_me muscle middle_finger writing_hand selfie nail_care ear "+"nose baby boy girl man woman blond-haired_woman blond-haired_man older_man older_woman "+"man_with_chinese_cap woman_wearing_turban man_wearing_turban woman_police_officer "+"man_police_officer woman_construction_worker man_construction_worker "+"woman_guard man_guard woman_detective man_detective woman_health_worker man_health_worker "+"woman_farmer man_farmer woman_cook man_cook woman_student man_student woman_singer man_singer woman_teacher "+"man_teacher woman_factory_worker man_factory_worker woman_technologist man_technologist woman_office_worker "+"man_office_worker woman_mechanic man_mechanic woman_scientist man_scientist woman_artist man_artist "+"woman_firefighter man_firefighter woman_pilot man_pilot woman_astronaut man_astronaut woman_judge "+"man_judge mrs_claus santa princess prince bride_with_veil man_in_tuxedo angel pregnant_woman "+"breast_feeding woman_bowing man_bowing man_tipping_hand woman_tipping_hand "+"man_gesturing_no woman_gesturing_no man_gesturing_ok woman_gesturing_ok "+"man_raising_hand woman_raising_hand woman_facepalming man_facepalming "+"woman_shrugging man_shrugging man_pouting woman_pouting "+"man_frowning woman_frowning man_getting_haircut woman_getting_haircut "+"man_getting_face_massage woman_getting_face_massage man_in_business_suit_levitating dancer man_dancing "+"woman_walking man_walking woman_running man_running adult child older_adult "+"bearded_person woman_with_headscarf woman_mage man_mage "+"woman_fairy man_fairy woman_vampire man_vampire mermaid merman woman_elf man_elf "+"snowboarder woman_lifting_weights man_lifting_weights woman_cartwheeling "+"man_cartwheeling woman_bouncing_ball man_bouncing_ball "+"woman_playing_handball man_playing_handball woman_golfing man_golfing "+"woman_surfing man_surfing woman_swimming man_swimming woman_playing_water_polo "+"man_playing_water_polo woman_rowing_boat man_rowing_boat "+"horse_racing woman_biking man_biking woman_mountain_biking "+"man_mountain_biking woman_juggling man_juggling "+"woman_in_steamy_room man_in_steamy_room woman_climbing "+"man_climbing woman_in_lotus_position man_in_lotus_position bath person_in_bed"},recent:{icon:"clock3",title:"Recent",emoji:""},smileys_people:{icon:"yum",title:"Smileys & People",emoji:"grinning smiley smile grin laughing sweat_smile joy rofl relaxed blush innocent slight_smile upside_down "+"wink relieved crazy_face star_struck heart_eyes kissing_heart kissing kissing_smiling_eyes kissing_closed_eyes yum "+"stuck_out_tongue_winking_eye stuck_out_tongue_closed_eyes stuck_out_tongue money_mouth hugging nerd sunglasses "+"cowboy smirk unamused disappointed pensive worried face_with_raised_eyebrow face_with_monocle confused slight_frown "+"frowning2 persevere confounded tired_face weary triumph angry rage face_with_symbols_over_mouth "+"no_mouth neutral_face expressionless hushed frowning anguished open_mouth astonished dizzy_face exploding_head flushed scream "+"fearful cold_sweat cry disappointed_relieved drooling_face sob sweat sleepy sleeping rolling_eyes thinking "+"shushing_face face_with_hand_over_mouth lying_face grimacing zipper_mouth face_vomiting nauseated_face sneezing_face mask thermometer_face "+"head_bandage smiling_imp imp japanese_ogre japanese_goblin poop ghost skull skull_crossbones alien space_invader "+"robot jack_o_lantern clown smiley_cat smile_cat joy_cat heart_eyes_cat smirk_cat kissing_cat scream_cat crying_cat_face "+"pouting_cat open_hands raised_hands palms_up_together clap pray handshake thumbsup thumbsdown punch fist left_facing_fist "+"right_facing_fist fingers_crossed v metal love_you_gesture ok_hand point_left point_right point_up_2 point_down point_up "+"raised_hand raised_back_of_hand hand_splayed vulcan wave call_me muscle middle_finger writing_hand selfie "+"nail_care ring lipstick kiss lips tongue ear nose footprints eye eyes speaking_head bust_in_silhouette "+"busts_in_silhouette baby boy girl man woman blond-haired_woman blond_haired_man older_man older_woman "+"man_with_chinese_cap woman_wearing_turban man_wearing_turban woman_police_officer police_officer "+"woman_construction_worker construction_worker woman_guard guard woman_detective detective woman_health_worker "+"man_health_worker woman_farmer man_farmer woman_cook man_cook woman_student man_student woman_singer man_singer "+"woman_teacher man_teacher woman_factory_worker man_factory_worker woman_technologist man_technologist "+"woman_office_worker man_office_worker woman_mechanic man_mechanic woman_scientist man_scientist woman_artist "+"man_artist woman_firefighter man_firefighter woman_pilot man_pilot woman_astronaut man_astronaut woman_judge "+"man_judge mrs_claus santa princess prince bride_with_veil man_in_tuxedo angel pregnant_woman breast_feeding woman_bowing "+"man_bowing woman_tipping_hand man_tipping_hand woman_gesturing_no man_gesturing_no woman_gesturing_ok "+"man_gesturing_ok woman_raising_hand man_raising_hand woman_facepalming man_facepalming woman_shrugging "+"man_shrugging woman_pouting man_pouting woman_frowning man_frowning woman_getting_haircut man_getting_haircut "+"woman_getting_face_massage man_getting_face_massage man_in_business_suit_levitating dancer man_dancing women_with_bunny_ears_partying "+"men_with_bunny_ears_partying woman_walking man_walking woman_running man_running couple two_women_holding_hands "+"two_men_holding_hands couple_with_heart couple_ww couple_mm couplekiss kiss_ww kiss_mm family family_mwg family_mwgb "+"family_mwbb family_mwgg family_wwb family_wwg family_wwgb family_wwbb family_wwgg family_mmb family_mmg family_mmgb "+"family_mmbb family_mmgg family_woman_boy family_woman_girl family_woman_girl_boy family_woman_boy_boy "+"family_woman_girl_girl family_man_boy family_man_girl family_man_girl_boy family_man_boy_boy family_man_girl_girl "+"bearded_person woman_with_headscarf woman_mage man_mage woman_fairy man_fairy woman_vampire man_vampire "+"mermaid merman woman_elf man_elf woman_genie man_genie woman_zombie man_zombie "+"womans_clothes shirt jeans necktie dress bikini kimono high_heel sandal boot mans_shoe athletic_shoe womans_hat "+"tophat mortar_board crown helmet_with_cross school_satchel pouch purse handbag briefcase eyeglasses dark_sunglasses "+"closed_umbrella umbrella2 brain billed_cap scarf gloves coat socks "},animals_nature:{icon:"hamster",title:"Animals & Nature",emoji:"dog cat mouse hamster rabbit fox bear panda_face koala tiger lion_face cow pig pig_nose frog monkey_face see_no_evil "+"hear_no_evil speak_no_evil monkey chicken penguin bird baby_chick hatching_chick hatched_chick duck eagle owl bat wolf boar "+"horse unicorn bee bug butterfly snail shell beetle ant spider spider_web turtle snake lizard scorpion crab squid octopus shrimp "+"tropical_fish fish blowfish dolphin shark whale whale2 crocodile leopard tiger2 water_buffalo ox cow2 deer dromedary_camel camel "+"elephant rhino gorilla racehorse pig2 goat ram sheep dog2 poodle cat2 rooster turkey dove rabbit2 mouse2 rat chipmunk dragon "+"giraffe zebra hedgehog sauropod t_rex cricket dragon_face feet cactus christmas_tree evergreen_tree deciduous_tree palm_tree seedling herb shamrock four_leaf_clover "+"bamboo tanabata_tree leaves fallen_leaf maple_leaf mushroom ear_of_rice bouquet tulip rose wilted_rose sunflower blossom "+"cherry_blossom hibiscus earth_americas earth_africa earth_asia full_moon waning_gibbous_moon last_quarter_moon "+"waning_crescent_moon new_moon waxing_crescent_moon first_quarter_moon waxing_gibbous_moon new_moon_with_face "+"full_moon_with_face sun_with_face first_quarter_moon_with_face last_quarter_moon_with_face crescent_moon dizzy star star2 "+"sparkles zap fire boom comet sunny white_sun_small_cloud partly_sunny white_sun_cloud white_sun_rain_cloud rainbow cloud "+"cloud_rain thunder_cloud_rain cloud_lightning cloud_snow snowman2 snowman snowflake wind_blowing_face dash cloud_tornado "+"fog ocean droplet sweat_drops umbrella "},food_drink:{icon:"pizza",title:"Food & Drink",emoji:"green_apple apple pear tangerine lemon banana watermelon grapes strawberry melon cherries peach pineapple kiwi "+"avocado tomato eggplant cucumber carrot corn hot_pepper potato sweet_potato chestnut peanuts honey_pot croissant "+"bread french_bread cheese egg cooking bacon pancakes fried_shrimp poultry_leg meat_on_bone pizza hotdog hamburger "+"fries stuffed_flatbread taco burrito salad shallow_pan_of_food spaghetti ramen stew fish_cake sushi bento curry "+"rice_ball rice rice_cracker oden dango shaved_ice ice_cream icecream cake birthday custard lollipop candy "+"chocolate_bar popcorn doughnut cookie milk baby_bottle coffee tea sake beer beers champagne_glass wine_glass "+"tumbler_glass cocktail tropical_drink champagne spoon fork_and_knife fork_knife_plate dumpling fortune_cookie "+"takeout_box chopsticks bowl_with_spoon cup_with_straw coconut broccoli pie pretzel cut_of_meat sandwich canned_food"},activity:{icon:"basketball",title:"Activity",emoji:"soccer basketball football baseball tennis volleyball rugby_football 8ball ping_pong badminton goal hockey field_hockey "+"cricket_game golf bow_and_arrow fishing_pole_and_fish boxing_glove martial_arts_uniform ice_skate ski skier snowboarder "+"woman_lifting_weights man_lifting_weights person_fencing women_wrestling men_wrestling woman_cartwheeling "+"man_cartwheeling woman_bouncing_ball man_bouncing_ball woman_playing_handball man_playing_handball woman_golfing "+"man_golfing woman_surfing man_surfing woman_swimming man_swimming woman_playing_water_polo "+"man_playing_water_polo woman_rowing_boat man_rowing_boat horse_racing woman_biking man_biking woman_mountain_biking man_mountain_biking "+"woman_in_steamy_room man_in_steamy_room woman_climbing man_climbing woman_in_lotus_position man_in_lotus_position "+"running_shirt_with_sash medal military_medal first_place second_place "+"third_place trophy rosette reminder_ribbon ticket tickets circus_tent woman_juggling man_juggling performing_arts art "+"clapper microphone headphones musical_score musical_keyboard drum saxophone trumpet guitar violin game_die dart bowling "+"video_game slot_machine sled curling_stone "},travel_places:{icon:"rocket",title:"Travel & Places",emoji:"red_car taxi blue_car bus trolleybus race_car police_car ambulance fire_engine minibus truck articulated_lorry tractor "+"scooter bike motor_scooter motorcycle rotating_light oncoming_police_car oncoming_bus oncoming_automobile oncoming_taxi "+"aerial_tramway mountain_cableway suspension_railway railway_car train mountain_railway monorail bullettrain_side "+"bullettrain_front light_rail steam_locomotive train2 metro tram station helicopter airplane_small airplane "+"airplane_departure airplane_arriving rocket satellite_orbital seat canoe sailboat motorboat speedboat cruise_ship "+"ferry ship anchor construction fuelpump busstop vertical_traffic_light traffic_light map moyai statue_of_liberty "+"fountain tokyo_tower european_castle japanese_castle stadium ferris_wheel roller_coaster carousel_horse beach_umbrella "+"beach island mountain mountain_snow mount_fuji volcano desert camping tent railway_track motorway construction_site "+"factory house house_with_garden homes house_abandoned office department_store post_office european_post_office hospital "+"bank hotel convenience_store school love_hotel wedding classical_building church mosque synagogue kaaba shinto_shrine "+"japan rice_scene park sunrise sunrise_over_mountains stars sparkler fireworks city_sunset city_dusk cityscape "+"night_with_stars milky_way bridge_at_night foggy flying_saucer"},objects:{icon:"bulb",title:"Objects",emoji:"watch iphone calling computer keyboard desktop printer mouse_three_button trackball joystick compression minidisc "+"floppy_disk cd dvd vhs camera camera_with_flash video_camera movie_camera projector film_frames telephone_receiver "+"telephone pager fax tv radio microphone2 level_slider control_knobs stopwatch timer alarm_clock clock hourglass "+"hourglass_flowing_sand satellite battery electric_plug bulb flashlight candle wastebasket oil money_with_wings "+"dollar yen euro pound moneybag credit_card gem scales wrench hammer hammer_pick tools pick nut_and_bolt gear "+"chains gun bomb knife dagger crossed_swords shield smoking coffin urn amphora crystal_ball prayer_beads barber "+"alembic telescope microscope hole pill syringe thermometer toilet potable_water shower bathtub bath bellhop key "+"key2 door couch bed sleeping_accommodation frame_photo shopping_bags shopping_cart gift balloon flags ribbon "+"confetti_ball tada dolls izakaya_lantern wind_chime envelope envelope_with_arrow incoming_envelope e-mail "+"love_letter inbox_tray outbox_tray package label mailbox_closed mailbox mailbox_with_mail mailbox_with_no_mail "+"postbox postal_horn scroll page_with_curl page_facing_up bookmark_tabs bar_chart chart_with_upwards_trend "+"chart_with_downwards_trend notepad_spiral calendar_spiral calendar date card_index card_box ballot_box "+"file_cabinet clipboard file_folder open_file_folder dividers newspaper2 newspaper notebook "+"notebook_with_decorative_cover ledger closed_book green_book blue_book orange_book books book bookmark link "+"paperclip paperclips triangular_ruler straight_ruler pushpin round_pushpin scissors pen_ballpoint pen_fountain "+"black_nib paintbrush crayon pencil pencil2 mag mag_right lock_with_ink_pen closed_lock_with_key lock unlock"},symbols:{icon:"heartpulse",title:"Symbols",emoji:"heart orange_heart yellow_heart green_heart blue_heart purple_heart black_heart broken_heart heart_exclamation two_hearts "+"revolving_hearts heartbeat heartpulse sparkling_heart cupid gift_heart heart_decoration peace cross star_and_crescent "+"om_symbol wheel_of_dharma star_of_david six_pointed_star menorah yin_yang orthodox_cross place_of_worship ophiuchus "+"aries taurus gemini cancer leo virgo libra scorpius sagittarius capricorn aquarius pisces id atom accept radioactive "+"biohazard mobile_phone_off vibration_mode u6709 u7121 u7533 u55b6 u6708 eight_pointed_black_star vs white_flower "+"ideograph_advantage secret congratulations u5408 u6e80 u5272 u7981 a b ab cl o2 sos x o octagonal_sign no_entry "+"name_badge no_entry_sign 100 anger hotsprings no_pedestrians do_not_litter no_bicycles non-potable_water underage "+"no_mobile_phones no_smoking exclamation grey_exclamation question grey_question bangbang interrobang low_brightness "+"high_brightness part_alternation_mark warning children_crossing trident fleur-de-lis beginner recycle "+"white_check_mark u6307 chart sparkle eight_spoked_asterisk negative_squared_cross_mark globe_with_meridians "+"diamond_shape_with_a_dot_inside m cyclone zzz atm wc wheelchair parking u7a7a sa passport_control customs "+"baggage_claim left_luggage mens womens baby_symbol restroom put_litter_in_its_place cinema signal_strength koko "+"symbols information_source abc abcd capital_abcd ng ok up cool new free zero one two three four five six seven "+"eight nine keycap_ten 1234 hash asterisk arrow_forward pause_button play_pause stop_button record_button eject "+"track_next track_previous fast_forward rewind arrow_double_up arrow_double_down arrow_backward arrow_up_small "+"arrow_down_small arrow_right arrow_left arrow_up arrow_down arrow_upper_right arrow_lower_right arrow_lower_left "+"arrow_upper_left arrow_up_down left_right_arrow arrow_right_hook leftwards_arrow_with_hook arrow_heading_up "+"arrow_heading_down twisted_rightwards_arrows repeat repeat_one arrows_counterclockwise arrows_clockwise "+"musical_note notes heavy_plus_sign heavy_minus_sign heavy_division_sign heavy_multiplication_x heavy_dollar_sign "+"currency_exchange tm copyright registered wavy_dash curly_loop loop end back on top soon heavy_check_mark "+"ballot_box_with_check radio_button white_circle black_circle red_circle blue_circle small_red_triangle "+"small_red_triangle_down small_orange_diamond small_blue_diamond large_orange_diamond large_blue_diamond "+"white_square_button black_square_button black_small_square white_small_square black_medium_small_square "+"white_medium_small_square black_medium_square white_medium_square black_large_square white_large_square speaker "+"mute sound loud_sound bell no_bell mega loudspeaker speech_left eye_in_speech_bubble speech_balloon thought_balloon "+"anger_right spades clubs hearts diamonds black_joker flower_playing_cards mahjong clock1 clock2 clock3 clock4 clock5 "+"clock6 clock7 clock8 clock9 clock10 clock11 clock12 clock130 clock230 clock330 clock430 clock530 clock630 "+"clock730 clock830 clock930 clock1030 clock1130 clock1230"},flags:{icon:"flag_gb",title:"Flags",emoji:"flag_white flag_black checkered_flag triangular_flag_on_post rainbow_flag flag_af flag_ax flag_al flag_dz flag_as "+"flag_ad flag_ao flag_ai flag_aq flag_ag flag_ar flag_am flag_aw flag_au flag_at flag_az flag_bs flag_bh flag_bd flag_bb "+"flag_by flag_be flag_bz flag_bj flag_bm flag_bt flag_bo flag_ba flag_bw flag_br flag_io flag_vg flag_bn flag_bg flag_bf "+"flag_bi flag_kh flag_cm flag_ca flag_ic flag_cv flag_bq flag_ky flag_cf flag_td flag_cl flag_cn flag_cx flag_cc flag_co "+"flag_km flag_cg flag_cd flag_ck flag_cr flag_ci flag_hr flag_cu flag_cw flag_cy flag_cz flag_dk flag_dj flag_dm flag_do "+"flag_ec flag_eg flag_sv flag_gq flag_er flag_ee flag_et flag_eu flag_fk flag_fo flag_fj flag_fi flag_fr flag_gf flag_pf "+"flag_tf flag_ga flag_gm flag_ge flag_de flag_gh flag_gi flag_gr flag_gl flag_gd flag_gp flag_gu flag_gt flag_gg flag_gn "+"flag_gw flag_gy flag_ht flag_hn flag_hk flag_hu flag_is flag_in flag_id flag_ir flag_iq flag_ie flag_im flag_il flag_it "+"flag_jm flag_jp crossed_flags flag_je flag_jo flag_kz flag_ke flag_ki flag_xk flag_kw flag_kg flag_la flag_lv flag_lb "+"flag_ls flag_lr flag_ly flag_li flag_lt flag_lu flag_mo flag_mk flag_mg flag_mw flag_my flag_mv flag_ml flag_mt flag_mh "+"flag_mq flag_mr flag_mu flag_yt flag_mx flag_fm flag_md flag_mc flag_mn flag_me flag_ms flag_ma flag_mz flag_mm flag_na "+"flag_nr flag_np flag_nl flag_nc flag_nz flag_ni flag_ne flag_ng flag_nu flag_nf flag_kp flag_mp flag_no flag_om flag_pk "+"flag_pw flag_ps flag_pa flag_pg flag_py flag_pe flag_ph flag_pn flag_pl flag_pt flag_pr flag_qa flag_re flag_ro flag_ru "+"flag_rw flag_ws flag_sm flag_st flag_sa flag_sn flag_rs flag_sc flag_sl flag_sg flag_sx flag_sk flag_si flag_gs flag_sb "+"flag_so flag_za flag_kr flag_ss flag_es flag_lk flag_bl flag_sh flag_kn flag_lc flag_pm flag_vc flag_sd flag_sr flag_sz "+"flag_se flag_ch flag_sy flag_tw flag_tj flag_tz flag_th flag_tl flag_tg flag_tk flag_to flag_tt flag_tn flag_tr flag_tm "+"flag_tc flag_tv flag_vi flag_ug flag_ua flag_ae flag_gb flag_us flag_uy flag_uz flag_vu flag_va flag_ve flag_vn flag_wf "+"flag_eh flag_ye flag_zm flag_zw flag_ac flag_ta flag_bv flag_hm flag_sj flag_um flag_ea flag_cp flag_dg flag_mf "+"united_nations england scotland wales"}}}else{e.filters={tones:{title:"Diversity",emoji:"santa runner surfer swimmer lifter ear nose point_up_2 point_down point_left point_right punch "+"wave ok_hand thumbsup thumbsdown clap open_hands boy girl man woman cop bride_with_veil person_with_blond_hair "+"man_with_gua_pi_mao man_with_turban older_man grandma baby construction_worker princess angel "+"information_desk_person guardsman dancer nail_care massage haircut muscle spy hand_splayed middle_finger "+"vulcan no_good ok_woman bow raising_hand raised_hands person_frowning person_with_pouting_face pray rowboat "+"bicyclist mountain_bicyclist walking bath metal point_up basketball_player fist raised_hand v writing_hand"},recent:{icon:"clock3",title:"Recent",emoji:""},smileys_people:{icon:"yum",title:"Smileys & People",emoji:"grinning grimacing grin joy smiley smile sweat_smile laughing innocent wink blush slight_smile "+"upside_down relaxed yum relieved heart_eyes kissing_heart kissing kissing_smiling_eyes "+"kissing_closed_eyes stuck_out_tongue_winking_eye stuck_out_tongue_closed_eyes stuck_out_tongue "+"money_mouth nerd sunglasses hugging smirk no_mouth neutral_face expressionless unamused rolling_eyes "+"thinking flushed disappointed worried angry rage pensive confused slight_frown frowning2 persevere "+"confounded tired_face weary triumph open_mouth scream fearful cold_sweat hushed frowning anguished "+"cry disappointed_relieved sleepy sweat sob dizzy_face astonished zipper_mouth mask thermometer_face "+"head_bandage sleeping zzz poop smiling_imp imp japanese_ogre japanese_goblin skull ghost alien robot "+"smiley_cat smile_cat joy_cat heart_eyes_cat smirk_cat kissing_cat scream_cat crying_cat_face "+"pouting_cat raised_hands clap wave thumbsup thumbsdown punch fist v ok_hand raised_hand open_hands "+"muscle pray point_up point_up_2 point_down point_left point_right middle_finger hand_splayed metal "+"vulcan writing_hand nail_care lips tongue ear nose eye eyes bust_in_silhouette busts_in_silhouette "+"speaking_head baby boy girl man woman person_with_blond_hair older_man older_woman man_with_gua_pi_mao "+"man_with_turban cop construction_worker guardsman spy santa angel princess bride_with_veil walking "+"runner dancer dancers couple two_men_holding_hands two_women_holding_hands bow information_desk_person "+"no_good ok_woman raising_hand person_with_pouting_face person_frowning haircut massage couple_with_heart "+"couple_ww couple_mm couplekiss kiss_ww kiss_mm family family_mwg family_mwgb family_mwbb family_mwgg "+"family_wwb family_wwg family_wwgb family_wwbb family_wwgg family_mmb family_mmg family_mmgb family_mmbb "+"family_mmgg womans_clothes shirt jeans necktie dress bikini kimono lipstick kiss footprints high_heel "+"sandal boot mans_shoe athletic_shoe womans_hat tophat helmet_with_cross mortar_board crown school_satchel "+"pouch purse handbag briefcase eyeglasses dark_sunglasses ring closed_umbrella"},animals_nature:{icon:"hamster",title:"Animals & Nature",emoji:"dog cat mouse hamster rabbit bear panda_face koala tiger lion_face cow pig pig_nose frog "+"octopus monkey_face see_no_evil hear_no_evil speak_no_evil monkey chicken penguin bird baby_chick "+"hatching_chick hatched_chick wolf boar horse unicorn bee bug snail beetle ant spider scorpion crab "+"snake turtle tropical_fish fish blowfish dolphin whale whale2 crocodile leopard tiger2 water_buffalo "+"ox cow2 dromedary_camel camel elephant goat ram sheep racehorse pig2 rat mouse2 rooster turkey dove "+"dog2 poodle cat2 rabbit2 chipmunk feet dragon dragon_face cactus christmas_tree evergreen_tree "+"deciduous_tree palm_tree seedling herb shamrock four_leaf_clover bamboo tanabata_tree leaves "+"fallen_leaf maple_leaf ear_of_rice hibiscus sunflower rose tulip blossom cherry_blossom bouquet "+"mushroom chestnut jack_o_lantern shell spider_web earth_americas earth_africa earth_asia full_moon "+"waning_gibbous_moon last_quarter_moon waning_crescent_moon new_moon waxing_crescent_moon "+"first_quarter_moon waxing_gibbous_moon new_moon_with_face full_moon_with_face first_quarter_moon_with_face "+"last_quarter_moon_with_face sun_with_face crescent_moon star star2 dizzy sparkles comet sunny "+"white_sun_small_cloud partly_sunny white_sun_cloud white_sun_rain_cloud cloud cloud_rain "+"thunder_cloud_rain cloud_lightning zap fire boom snowflake cloud_snow snowman2 snowman wind_blowing_face "+"dash cloud_tornado fog umbrella2 umbrella droplet sweat_drops ocean"},food_drink:{icon:"pizza",title:"Food & Drink",emoji:"green_apple apple pear tangerine lemon banana watermelon grapes strawberry melon cherries peach "+"pineapple tomato eggplant hot_pepper corn sweet_potato honey_pot bread cheese poultry_leg meat_on_bone "+"fried_shrimp egg hamburger fries hotdog pizza spaghetti taco burrito ramen stew fish_cake sushi bento "+"curry rice_ball rice rice_cracker oden dango shaved_ice ice_cream icecream cake birthday custard candy "+"lollipop chocolate_bar popcorn doughnut cookie beer beers wine_glass cocktail tropical_drink champagne "+"sake tea coffee baby_bottle fork_and_knife fork_knife_plate"},activity:{icon:"basketball",title:"Activity",emoji:"soccer basketball football baseball tennis volleyball rugby_football 8ball golf golfer ping_pong "+"badminton hockey field_hockey cricket ski skier snowboarder ice_skate bow_and_arrow fishing_pole_and_fish "+"rowboat swimmer surfer bath basketball_player lifter bicyclist mountain_bicyclist horse_racing levitate "+"trophy running_shirt_with_sash medal military_medal reminder_ribbon rosette ticket tickets performing_arts "+"art circus_tent microphone headphones musical_score musical_keyboard saxophone trumpet guitar violin "+"clapper video_game space_invader dart game_die slot_machine bowling"},travel_places:{icon:"rocket",title:"Travel & Places",emoji:"red_car taxi blue_car bus trolleybus race_car police_car ambulance fire_engine minibus truck "+"articulated_lorry tractor motorcycle bike rotating_light oncoming_police_car oncoming_bus "+"oncoming_automobile oncoming_taxi aerial_tramway mountain_cableway suspension_railway railway_car "+"train monorail bullettrain_side bullettrain_front light_rail mountain_railway steam_locomotive train2 "+"metro tram station helicopter airplane_small airplane airplane_departure airplane_arriving sailboat "+"motorboat speedboat ferry cruise_ship rocket satellite_orbital seat anchor construction fuelpump busstop "+"vertical_traffic_light traffic_light checkered_flag ship ferris_wheel roller_coaster carousel_horse "+"construction_site foggy tokyo_tower factory fountain rice_scene mountain mountain_snow mount_fuji volcano "+"japan camping tent park motorway railway_track sunrise sunrise_over_mountains desert beach island "+"city_sunset city_dusk cityscape night_with_stars bridge_at_night milky_way stars sparkler fireworks "+"rainbow homes european_castle japanese_castle stadium statue_of_liberty house house_with_garden "+"house_abandoned office department_store post_office european_post_office hospital bank hotel "+"convenience_store school love_hotel wedding classical_building church mosque synagogue kaaba shinto_shrine"},objects:{icon:"bulb",title:"Objects",emoji:"watch iphone calling computer keyboard desktop printer mouse_three_button trackball joystick "+"compression minidisc floppy_disk cd dvd vhs camera camera_with_flash video_camera movie_camera projector "+"film_frames telephone_receiver telephone pager fax tv radio microphone2 level_slider control_knobs "+"stopwatch timer alarm_clock clock hourglass_flowing_sand hourglass satellite battery electric_plug bulb "+"flashlight candle wastebasket oil money_with_wings dollar yen euro pound moneybag credit_card gem scales "+"wrench hammer hammer_pick tools pick nut_and_bolt gear chains gun bomb knife dagger crossed_swords shield "+"smoking skull_crossbones coffin urn amphora crystal_ball prayer_beads barber alembic telescope microscope "+"hole pill syringe thermometer label bookmark toilet shower bathtub key key2 couch sleeping_accommodation "+"bed door bellhop frame_photo map beach_umbrella moyai shopping_bags balloon flags ribbon gift confetti_ball "+"tada dolls wind_chime crossed_flags izakaya_lantern envelope envelope_with_arrow incoming_envelope e-mail "+"love_letter postbox mailbox_closed mailbox mailbox_with_mail mailbox_with_no_mail package postal_horn "+"inbox_tray outbox_tray scroll page_with_curl bookmark_tabs bar_chart chart_with_upwards_trend "+"chart_with_downwards_trend page_facing_up date calendar calendar_spiral card_index card_box ballot_box "+"file_cabinet clipboard notepad_spiral file_folder open_file_folder dividers newspaper2 newspaper notebook "+"closed_book green_book blue_book orange_book notebook_with_decorative_cover ledger books book link "+"paperclip paperclips scissors triangular_ruler straight_ruler pushpin round_pushpin triangular_flag_on_post "+"flag_white flag_black closed_lock_with_key lock unlock lock_with_ink_pen pen_ballpoint pen_fountain "+"black_nib pencil pencil2 crayon paintbrush mag mag_right"},symbols:{icon:"heartpulse",title:"Symbols",emoji:"heart yellow_heart green_heart blue_heart purple_heart broken_heart heart_exclamation two_hearts "+"revolving_hearts heartbeat heartpulse sparkling_heart cupid gift_heart heart_decoration peace cross "+"star_and_crescent om_symbol wheel_of_dharma star_of_david six_pointed_star menorah yin_yang orthodox_cross "+"place_of_worship ophiuchus aries taurus gemini cancer leo virgo libra scorpius sagittarius capricorn "+"aquarius pisces id atom u7a7a u5272 radioactive biohazard mobile_phone_off vibration_mode u6709 u7121 "+"u7533 u55b6 u6708 eight_pointed_black_star vs accept white_flower ideograph_advantage secret congratulations "+"u5408 u6e80 u7981 a b ab cl o2 sos no_entry name_badge no_entry_sign x o anger hotsprings no_pedestrians "+"do_not_litter no_bicycles non-potable_water underage no_mobile_phones exclamation grey_exclamation question "+"grey_question bangbang interrobang 100 low_brightness high_brightness trident fleur-de-lis part_alternation_mark "+"warning children_crossing beginner recycle u6307 chart sparkle eight_spoked_asterisk negative_squared_cross_mark "+"white_check_mark diamond_shape_with_a_dot_inside cyclone loop globe_with_meridians m atm sa passport_control "+"customs baggage_claim left_luggage wheelchair no_smoking wc parking potable_water mens womens baby_symbol "+"restroom put_litter_in_its_place cinema signal_strength koko ng ok up cool new free zero one two three four "+"five six seven eight nine ten 1234 arrow_forward pause_button play_pause stop_button record_button track_next "+"track_previous fast_forward rewind twisted_rightwards_arrows repeat repeat_one arrow_backward arrow_up_small "+"arrow_down_small arrow_double_up arrow_double_down arrow_right arrow_left arrow_up arrow_down arrow_upper_right "+"arrow_lower_right arrow_lower_left arrow_upper_left arrow_up_down left_right_arrow arrows_counterclockwise "+"arrow_right_hook leftwards_arrow_with_hook arrow_heading_up arrow_heading_down hash asterisk information_source "+"abc abcd capital_abcd symbols musical_note notes wavy_dash curly_loop heavy_check_mark arrows_clockwise "+"heavy_plus_sign heavy_minus_sign heavy_division_sign heavy_multiplication_x heavy_dollar_sign currency_exchange "+"copyright registered tm end back on top soon ballot_box_with_check radio_button white_circle black_circle "+"red_circle large_blue_circle small_orange_diamond small_blue_diamond large_orange_diamond large_blue_diamond "+"small_red_triangle black_small_square white_small_square black_large_square white_large_square small_red_triangle_down "+"black_medium_square white_medium_square black_medium_small_square white_medium_small_square black_square_button "+"white_square_button speaker sound loud_sound mute mega loudspeaker bell no_bell black_joker mahjong spades "+"clubs hearts diamonds flower_playing_cards thought_balloon anger_right speech_balloon clock1 clock2 clock3 "+"clock4 clock5 clock6 clock7 clock8 clock9 clock10 clock11 clock12 clock130 clock230 clock330 clock430 "+"clock530 clock630 clock730 clock830 clock930 clock1030 clock1130 clock1230 eye_in_speech_bubble"},flags:{icon:"flag_gb",title:"Flags",emoji:"ac af al dz ad ao ai ag ar am aw au at az bs bh bd bb by be bz bj bm bt bo ba bw br bn bg bf bi "+"cv kh cm ca ky cf td flag_cl cn co km cg flag_cd cr hr cu cy cz dk dj dm do ec eg sv gq er ee et fk fo "+"fj fi fr pf ga gm ge de gh gi gr gl gd gu gt gn gw gy ht hn hk hu is in flag_id ir iq ie il it ci jm jp "+"je jo kz ke ki xk kw kg la lv lb ls lr ly li lt lu mo mk mg mw my mv ml mt mh mr mu mx fm md mc mn me "+"ms ma mz mm na nr np nl nc nz ni ne flag_ng nu kp no om pk pw ps pa pg py pe ph pl pt pr qa ro ru rw "+"sh kn lc vc ws sm st flag_sa sn rs sc sl sg sk si sb so za kr es lk sd sr sz se ch sy tw tj tz th tl "+"tg to tt tn tr flag_tm flag_tm ug ua ae gb us vi uy uz vu va ve vn wf eh ye zm zw re ax ta io bq cx "+"cc gg im yt nf pn bl pm gs tk bv hm sj um ic ea cp dg as aq vg ck cw eu gf tf gp mq mp sx ss tc "}}}return e}function N(e){var t=i();if(e&&e["filters"]){var n=t.filters;C.each(e["filters"],function(i,e){if(!O(e)||C.isEmptyObject(e)){delete n[i];return}C.each(e,function(e,t){n[i][e]=t})});e["filters"]=n}return C.extend({},t,e)}var I,L;if(window.getSelection&&document.createRange){I=function(e){var t=window.getSelection&&window.getSelection();if(t&&t.rangeCount>0){return t.getRangeAt(0)}};L=function(e,t){var i=document.createRange();i.setStart(t.startContainer,t.startOffset);i.setEnd(t.endContainer,t.endOffset);t=window.getSelection();t.removeAllRanges();t.addRange(i)}}else if(document.selection&&document.body.createTextRange){I=function(e){return document.selection.createRange()};L=function(e,t){var i=document.body.createTextRange();i.moveToElementText(e);i.setStart(t.startContanier,t.startOffset);i.setEnd(t.endContainer,t.endOffset);i.select()}}var h;function f(e,i){return e.replace(h,function(e){var t=x[E===0?"jsecapeMap":"jsEscapeMap"];if(typeof e!=="undefined"&&e in t){return l(i,t[e],x.toShort(e))}return e})}function P(e,t){e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/`/g,"&#x60;").replace(/(?:\r\n|\r|\n)/g,"\n").replace(/(\n+)/g,"<div>$1</div>").replace(/\n/g,"<br/>").replace(/<br\/><\/div>/g,"</div>");if(t.shortnames){e=x.shortnameToUnicode(e)}return f(e,t.emojiTemplate).replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/  /g,"&nbsp;&nbsp;")}function F(e,t){e=e.replace(/&#10;/g,"\n").replace(/&#09;/g,"\t").replace(/<img[^>]*alt="([^"]+)"[^>]*>/gi,"$1").replace(/\n|\r/g,"").replace(/<br[^>]*>/gi,"\n").replace(/(?:<(?:div|p|ol|ul|li|pre|code|object)[^>]*>)+/gi,"<div>").replace(/(?:<\/(?:div|p|ol|ul|li|pre|code|object)>)+/gi,"</div>").replace(/\n<div><\/div>/gi,"\n").replace(/<div><\/div>\n/gi,"\n").replace(/(?:<div>)+<\/div>/gi,"\n").replace(/([^\n])<\/div><div>/gi,"$1\n").replace(/(?:<\/div>)+/gi,"</div>").replace(/([^\n])<\/div>([^\n])/gi,"$1\n$2").replace(/<\/div>/gi,"").replace(/([^\n])<div>/gi,"$1\n").replace(/\n<div>/gi,"\n").replace(/<div>\n/gi,"\n\n").replace(/<(?:[^>]+)?>/g,"").replace(new RegExp(T,"g"),"").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x60;/g,"`").replace(/&#60;/g,"<").replace(/&#62;/g,">").replace(/&amp;/g,"&");switch(t.saveEmojisAs){case"image":e=f(e,t.emojiTemplate);break;case"shortname":e=x.toShort(e)}return e}function G(){var e=this,t=e.editor[0].offsetWidth-e.editor[0].clientWidth,i=parseInt(e.button.css("marginRight"));if(i!==t){e.button.css({marginRight:t});if(e.floatingPicker){e.picker.css({right:parseInt(e.picker.css("right"))-i+t})}}}function $(){var e=this;if(!e.sprite&&e.lasyEmoji[0]&&e.lasyEmoji.eq(0).is(".lazy-emoji")){var i=e.picker.offset().top,n=i+e.picker.height()+20;e.lasyEmoji.each(function(){var e=C(this),t=e.offset().top;if(t>i&&t<n){e.attr("src",e.data("src")).removeClass("lazy-emoji")}if(t>n){return false}});e.lasyEmoji=e.lasyEmoji.filter(".lazy-emoji")}}function H(e,t){return(t?"":".")+A+(e?"-"+e:"")}function B(e){var i=C("<div/>",O(e)?e:{class:H(e,true)});C.each(o.call(arguments).slice(1),function(e,t){if(C.isFunction(t)){t=t.call(i)}if(t){C(t).appendTo(i)}});return i}function V(){return localStorage.getItem("recent_emojis")||""}function j(e,t){var i=V();if(!e.recent||e.recent!==i||t){if(i.length){var n=e.scrollArea.is(".skinnable"),r,o;if(!n){r=e.scrollArea.scrollTop();if(t){e.recentCategory.show()}o=e.recentCategory.is(":visible")?e.recentCategory.height():0}var s=M(i,e.emojiBtnTemplate,true).split("|").join("");e.recentCategory.children(".emojibtn").remove();C(s).insertAfter(e.recentCategory.children(".emojionearea-category-title"));e.recentCategory.children(".emojibtn").on("click",function(){e.trigger("emojibtn.click",C(this))});e.recentFilter.show();if(!n){e.recentCategory.show();var a=e.recentCategory.height();if(o!==a){e.scrollArea.scrollTop(r+a-o)}}}else{if(e.recentFilter.hasClass("active")){e.recentFilter.removeClass("active").next().addClass("active")}e.recentCategory.hide();e.recentFilter.hide()}e.recent=i}}function z(e,t){var i=V();var n=i.split("|");var r=n.indexOf(t);if(r!==-1){n.splice(r,1)}n.unshift(t);if(n.length>9){n.pop()}localStorage.setItem("recent_emojis",n.join("|"));j(e)}function W(){var e="test";try{localStorage.setItem(e,e);localStorage.removeItem(e);return true}catch(e){return false}}function m(l,t,s){l.options=s=N(s);l.sprite=s.sprite&&E<3;l.inline=s.inline===null?t.is("INPUT"):s.inline;l.shortnames=s.shortnames;l.saveEmojisAs=s.saveEmojisAs;l.standalone=s.standalone;l.emojiTemplate='<img alt="{alt}" class="emojione'+(l.sprite?'-{uni}" src="'+S+'"/>':'emoji" src="{img}"/>');l.emojiTemplateAlt=l.sprite?'<i class="emojione-{uni}"/>':'<img class="emojioneemoji" src="{img}"/>';l.emojiBtnTemplate='<i class="emojibtn" role="button" data-name="{name}" title="{friendlyName}">'+l.emojiTemplateAlt+"</i>";l.recentEmojis=s.recentEmojis&&W();var e=s.pickerPosition;l.floatingPicker=e==="top"||e==="bottom";l.source=t;if(t.is(":disabled")||t.is(".disabled")){l.disable()}var i=t.is("TEXTAREA")||t.is("INPUT")?"val":"text",n,r,a,o,c,u,d,h,f,p,g=B("tones",s.tones?function(){this.addClass(H("tones-"+s.tonesStyle,true));for(var e=0;e<=5;e++){this.append(C("<i/>",{class:"btn-tone btn-tone-"+e+(!e?" active":""),"data-skin":e,role:"button"}))}}:null),m=B({class:A+(l.standalone?" "+A+"-standalone ":" ")+(t.attr("class")||""),role:"application"},n=l.editor=B("editor").attr({contenteditable:l.standalone?false:true,placeholder:s.placeholder||t.data("placeholder")||t.attr("placeholder")||"",tabindex:0}),r=l.button=B("button",B("button-open"),B("button-close")).attr("title",s.buttonTitle),a=l.picker=B("picker",B("wrapper",o=B("filters"),s.search?u=B("search-panel",B("search",s.search?function(){l.search=C("<input/>",{placeholder:s.searchPlaceholder||"",type:"text",class:"search"});this.append(l.search)}:null),g):null,p=B("scroll-area",s.tones&&!s.search?B("tones-panel",g):null,d=B("emojis-list")))).addClass(H("picker-position-"+s.pickerPosition,true)).addClass(H("filters-position-"+s.filtersPosition,true)).addClass(H("search-position-"+s.searchPosition,true)).addClass("hidden"));if(s.search){u.addClass(H("with-search",true))}l.searchSel=null;n.data(t.data());C.each(s.attributes,function(e,t){n.attr(e,t)});var v=B("category-block").attr({"data-tone":0}).prependTo(d);C.each(s.filters,function(e,t){var i=0;if(e==="recent"&&!l.recentEmojis){return}if(e!=="tones"){C("<i/>",{class:H("filter",true)+" "+H("filter-"+e,true),"data-filter":e,title:t.title}).wrapInner(M(t.icon,l.emojiTemplateAlt)).appendTo(o)}else if(s.tones){i=5}else{return}do{var n,r=t.emoji.replace(/[\s,;]+/g,"|");if(i===0){n=B("category").attr({name:e,"data-tone":i}).appendTo(v)}else{n=B("category-block").attr({name:e,"data-tone":i}).appendTo(d)}if(i>0){n.hide();r=r.split("|").join("_tone"+i+"|")+"_tone"+i}if(e==="recent"){r=V()}r=M(r,l.sprite?'<i class="emojibtn" role="button" data-name="{name}" title="{friendlyName}"><i class="emojione-{uni}"></i></i>':'<i class="emojibtn" role="button" data-name="{name}" title="{friendlyName}"><img class="emojioneemoji lazy-emoji" data-src="{img}"/></i>',true).split("|").join("");n.html(r);C('<div class="emojionearea-category-title"/>').text(t.title).prependTo(n)}while(--i>0)});s.filters=null;if(!l.sprite){l.lasyEmoji=d.find(".lazy-emoji")}c=o.find(H("filter"));c.eq(0).addClass("active");f=d.find(H("category-block"));h=d.find(H("category"));l.recentFilter=c.filter('[data-filter="recent"]');l.recentCategory=h.filter("[name=recent]");l.scrollArea=p;if(s.container){C(s.container).wrapInner(m)}else{m.insertAfter(t)}if(s.hideSource){t.hide()}l.setText(t[i]());t[i](l.getText());G.apply(l);if(l.standalone&&!l.getText().length){var y=C(t).data("emoji-placeholder")||s.emojiPlaceholder;l.setText(y);n.addClass("has-placeholder")}R(l,d.find(".emojibtn"),{click:"emojibtn.click"});R(l,window,{resize:"!resize"});R(l,g.children(),{click:"tone.click"});R(l,[a,r],{mousedown:"!mousedown"},n);R(l,r,{click:"button.click"});R(l,n,{paste:"!paste"},n);R(l,n,["focus","blur"],function(){return l.stayFocused?false:n});R(l,a,{mousedown:"picker.mousedown",mouseup:"picker.mouseup",click:"picker.click",keyup:"picker.keyup",keydown:"picker.keydown",keypress:"picker.keypress"});R(l,n,["mousedown","mouseup","click","keyup","keydown","keypress"]);R(l,a.find(".emojionearea-filter"),{click:"filter.click"});R(l,t,{change:"source.change"});if(s.search){R(l,l.search,{keyup:"search.keypress",focus:"search.focus",blur:"search.blur"})}var b=false;p.on("scroll",function(){if(!b){$.call(l);if(p.is(":not(.skinnable)")){var i=h.eq(0),n=p.offset().top;h.each(function(e,t){if(C(t).offset().top-n>=10){return false}i=C(t)});var e=c.filter('[data-filter="'+i.attr("name")+'"]');if(e[0]&&!e.is(".active")){c.removeClass("active");e.addClass("active")}}}});l.on("@filter.click",function(e){var t=e.is(".active");if(p.is(".skinnable")){if(t)return;g.children().eq(0).click()}b=true;if(!t){c.filter(".active").removeClass("active");e.addClass("active")}var i=h.filter('[name="'+e.data("filter")+'"]').offset().top,n=p.scrollTop(),r=p.offset().top;p.stop().animate({scrollTop:i+n-r-2},200,"swing",function(){$.call(l);b=false})}).on("@picker.show",function(){if(l.recentEmojis){j(l)}$.call(l)}).on("@tone.click",function(e){g.children().removeClass("active");var t=e.addClass("active").data("skin");if(t){p.addClass("skinnable");f.hide().filter("[data-tone="+t+"]").show();c.removeClass("active")}else{p.removeClass("skinnable");f.hide().filter("[data-tone=0]").show();c.eq(0).click()}$.call(l);if(s.search){l.trigger("search.keypress")}}).on("@button.click",function(e){if(e.is(".active")){l.hidePicker()}else{l.showPicker();l.searchSel=null}}).on("@!paste",function(s,e){var t=function(e){var t="caret-"+(new Date).getTime();var i=P(e,l);k(i);k('<i id="'+t+'"></i>');s.scrollTop(a);var n=C("#"+t),r=n.offset().top-s.offset().top,o=s.height();if(a+r>=o||a>r){s.scrollTop(a+r-2*o/3)}n.remove();l.stayFocused=false;G.apply(l);D(l,"paste",[s,e,i])};if(e.originalEvent.clipboardData){var i=e.originalEvent.clipboardData.getData("text/plain");t(i);if(e.preventDefault){e.preventDefault()}else{e.stop()}e.returnValue=false;e.stopPropagation();return false}l.stayFocused=true;k("<span>"+T+"</span>");var n=I(s[0]),a=s.scrollTop(),r=C("<div/>",{contenteditable:true}).css({position:"fixed",left:"-999px",width:"1px",height:"1px",top:"20px",overflow:"hidden"}).appendTo(C("BODY")).focus();window.setTimeout(function(){s.focus();L(s[0],n);var e=F(r.html().replace(/\r\n|\n|\r/g,"<br>"),l);r.remove();t(e)},200)}).on("@emojibtn.click",function(e){n.removeClass("has-placeholder");if(l.searchSel!==null){n.focus();L(n[0],l.searchSel);l.searchSel=null}if(l.standalone){n.html(M(e.data("name"),l.emojiTemplate));l.trigger("blur")}else{I(n[0]);k(M(e.data("name"),l.emojiTemplate))}if(l.recentEmojis){z(l,e.data("name"))}l.trigger("search.keypress")}).on("@!resize @keyup @emojibtn.click",G).on("@!mousedown",function(e,t){if(C(t.target).hasClass("search")){l.stayFocused=true;if(l.searchSel===null){l.searchSel=I(e[0])}}else{if(!m.is(".focused")){e.trigger("focus")}t.preventDefault()}return false}).on("@change",function(){var e=l.editor.html().replace(/<\/?(?:div|span|p)[^>]*>/gi,"");if(!e.length||/^<br[^>]*>$/i.test(e)){l.editor.html(l.content="")}t[i](l.getText())}).on("@source.change",function(){l.setText(t[i]());D("change")}).on("@focus",function(){m.addClass("focused")}).on("@blur",function(){m.removeClass("focused");if(s.hidePickerOnBlur){l.hidePicker()}var e=l.editor.html();if(l.content!==e){l.content=e;D(l,"change",[l.editor]);t.trigger("blur").trigger("change")}else{t.trigger("blur")}if(s.search){l.search.val("");l.trigger("search.keypress",true)}});if(s.search){l.on("@search.focus",function(){l.stayFocused=true;l.search.addClass("focused")}).on("@search.keypress",function(e){var r=a.find(".emojionearea-filter");var i=s.tones?g.find("i.active").data("skin"):0;var o=l.search.val().replace(/ /g,"_").replace(/"/g,'\\"');if(o&&o.length){if(l.recentFilter.hasClass("active")){l.recentFilter.removeClass("active").next().addClass("active")}l.recentCategory.hide();l.recentFilter.hide();f.each(function(){var e=function(e,t){var i=e.find('.emojibtn[data-name*="'+o+'"]');if(i.length===0){if(e.data("tone")===t){e.hide()}r.filter('[data-filter="'+e.attr("name")+'"]').hide()}else{var n=e.find('.emojibtn:not([data-name*="'+o+'"])');n.hide();i.show();if(e.data("tone")===t){e.show()}r.filter('[data-filter="'+e.attr("name")+'"]').show()}};var t=C(this);if(t.data("tone")===0){h.filter(':not([name="recent"])').each(function(){e(C(this),0)})}else{e(t,i)}});if(!b){p.trigger("scroll")}else{$.call(l)}}else{j(l,true);f.filter('[data-tone="'+g.find("i.active").data("skin")+'"]:not([name="recent"])').show();C(".emojibtn",f).show();r.show();$.call(l)}}).on("@search.blur",function(){l.stayFocused=false;l.search.removeClass("focused");l.trigger("blur")})}if(s.shortcuts){l.on("@keydown",function(e,t){if(!t.ctrlKey){if(t.which==9){t.preventDefault();r.click()}else if(t.which==27){t.preventDefault();if(r.is(".active")){l.hidePicker()}}}})}if(O(s.events)&&!C.isEmptyObject(s.events)){C.each(s.events,function(e,t){l.on(e.replace(/_/g,"."),t)})}if(s.autocomplete){var _=function(){var e={maxCount:s.textcomplete.maxCount,placement:s.textcomplete.placement};if(s.shortcuts){e.onKeydown=function(e,t){if(!e.ctrlKey&&e.which==13){return t.KEY_ENTER}}}var i=C.map(x.emojioneList,function(e,t){return!s.autocompleteTones?/_tone[12345]/.test(t)?null:t:t});i.sort();n.textcomplete([{id:A,match:/\B(:[\-+\w]*)$/,search:function(t,e){e(C.map(i,function(e){return e.indexOf(t)===0?e:null}))},template:function(e){return M(e,l.emojiTemplate)+" "+e.replace(/:/g,"")},replace:function(e){return M(e,l.emojiTemplate)},cache:true,index:1}],e);if(s.textcomplete.placement){if(C(n.data("textComplete").option.appendTo).css("position")=="static"){C(n.data("textComplete").option.appendTo).css("position","relative")}}};var w=function(){if(l.disabled){var e=function(){l.off("enabled",e);_()};l.on("enabled",e)}else{_()}};if(C.fn.textcomplete){w()}else{C.ajax({url:"https://cdn.rawgit.com/yuku-t/jquery-textcomplete/v1.3.4/dist/jquery.textcomplete.js",dataType:"script",cache:true,success:w})}}if(l.inline){m.addClass(H("inline",true));l.on("@keydown",function(e,t){if(t.which==13){t.preventDefault()}})}if(/firefox/i.test(navigator.userAgent)){document.execCommand("enableObjectResizing",false,false)}l.isReady=true;l.trigger("onLoad",n);l.trigger("ready",n)}var p={defaultBase:"https://cdnjs.cloudflare.com/ajax/libs/emojione/",defaultBase3:"https://cdn.jsdelivr.net/",base:null,isLoading:false};function v(t){var i=c();t=N(t);if(!p.isLoading){if(!x||d(u(x))<2){p.isLoading=true;var e;if(d(i)>5){e=p.defaultBase3+"npm/emojione@"+i}else if(d(i)>4){e=p.defaultBase3+"emojione/"+i}else{e=p.defaultBase+"/"+i}C.ajax({url:e+"/lib/js/emojione.min.js",dataType:"script",cache:true,success:function(){x=window.emojione;i=u(x);E=d(i);var e;if(E>4){p.base=p.defaultBase3+"emojione/assets/"+i;e=p.base+"/sprites/emojione-sprite-"+x.emojiSize+".css"}else{p.base=p.defaultBase+i+"/assets";e=p.base+"/sprites/emojione.sprites.css"}if(t.sprite){if(document.createStyleSheet){document.createStyleSheet(e)}else{C("<link/>",{rel:"stylesheet",href:e}).appendTo("head")}}while(n.length){n.shift().call()}p.isLoading=false}})}else{i=u(x);E=d(i);if(E>4){p.base=p.defaultBase3+"emojione/assets/"+i}else{p.base=p.defaultBase+i+"/assets"}}}r(function(){var e="";if(t.useInternalCDN){if(E>4)e=x.emojiSize+"/";x.imagePathPNG=p.base+"/png/"+e;x.imagePathSVG=p.base+"/svg/"+e;x.imagePathSVGSprites=p.base+"/sprites/emojione.sprites.svg";x.imageType=t.imageType}if(d(i)>4){h=x.regUnicode;x.imageType=t.imageType||"png"}else{h=new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|("+x.unicodeRegexp+")","gi")}})}var t=function(e,t){var i=this;v(t);s[i.id=++g]={};a[i.id]={};r(function(){m(i,e,t)})};function y(n,r){r=r.replace(/^@/,"");var e=n.id;if(a[e][r]){C.each(a[e][r],function(e,i){C.each(C.isArray(i[0])?i[0]:[i[0]],function(e,t){C(t).on(i[1],function(){var e=o.call(arguments),t=C.isFunction(i[2])?i[2].apply(n,[r].concat(e)):i[2];if(t){D(n,r,[t].concat(e))}})})});a[e][r]=null}}t.prototype.on=function(e,i){if(e&&C.isFunction(i)){var n=this;C.each(e.toLowerCase().split(" "),function(e,t){y(n,t);(s[n.id][t]||(s[n.id][t]=[])).push(i)})}return this};t.prototype.off=function(e,n){if(e){var r=this.id;C.each(e.toLowerCase().replace(/_/g,".").split(" "),function(e,i){if(s[r][i]&&!/^@/.test(i)){if(n){C.each(s[r][i],function(e,t){if(t===n){s[r][i].splice(e,1)}})}else{s[r][i]=[]}}})}return this};t.prototype.trigger=function(){var e=o.call(arguments),t=[this].concat(e.slice(0,1));t.push(e.slice(1));return D.apply(this,t)};t.prototype.setFocus=function(){var e=this;r(function(){e.editor.focus()});return e};t.prototype.setText=function(e){var t=this;r(function(){t.editor.html(P(e,t));t.content=t.editor.html();D(t,"change",[t.editor]);G.apply(t)});return t};t.prototype.getText=function(){return F(this.editor.html(),this)};t.prototype.showPicker=function(){var e=this;if(e._sh_timer){window.clearTimeout(e._sh_timer)}e.picker.removeClass("hidden");e._sh_timer=window.setTimeout(function(){e.button.addClass("active")},50);D(e,"picker.show",[e.picker]);return e};t.prototype.hidePicker=function(){var e=this;if(e._sh_timer){window.clearTimeout(e._sh_timer)}e.button.removeClass("active");e._sh_timer=window.setTimeout(function(){e.picker.addClass("hidden")},500);D(e,"picker.hide",[e.picker]);return e};t.prototype.enable=function(){var t=this;var e=function(){t.disabled=false;t.editor.prop("contenteditable",true);t.button.show();var e=t[t.standalone?"button":"editor"];e.parent().removeClass("emojionearea-disable");D(t,"enabled",[e])};t.isReady?e():t.on("ready",e);return t};t.prototype.disable=function(){var t=this;t.disabled=true;var e=function(){t.editor.prop("contenteditable",false);t.hidePicker();t.button.hide();var e=t[t.standalone?"button":"editor"];e.parent().addClass("emojionearea-disable");D(t,"disabled",[e])};t.isReady?e():t.on("ready",e);return t};C.fn.emojioneArea=function(e){return this.each(function(){if(!!this.emojioneArea)return this.emojioneArea;C.data(this,"emojioneArea",this.emojioneArea=new t(C(this),e));return this.emojioneArea})};C.fn.emojioneArea.defaults=i();C.fn.emojioneAreaText=function(e){e=N(e);var t=this,i={shortnames:e&&typeof e.shortnames!=="undefined"?e.shortnames:true,emojiTemplate:'<img alt="{alt}" class="emojione'+(e&&e.sprite&&E<3?'-{uni}" src="'+S:'emoji" src="{img}')+'"/>'};v(e);r(function(){t.each(function(){var e=C(this);if(!e.hasClass("emojionearea-text")){e.addClass("emojionearea-text").html(P(e.is("TEXTAREA")||e.is("INPUT")?e.val():e.text(),i))}return e})});return this}},window);(function(u,d){var e="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),h=/^([\-+])=\s*(\d+\.?\d*)/,t=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],f=u.Color=function(e,t,i,n){return new u.Color.fn.parse(e,t,i,n)},p={rgba:{cache:"_rgba",props:{red:{idx:0,type:"byte",empty:true},green:{idx:1,type:"byte",empty:true},blue:{idx:2,type:"byte",empty:true},alpha:{idx:3,type:"percent",def:1}}},hsla:{cache:"_hsla",props:{hue:{idx:0,type:"degrees",empty:true},saturation:{idx:1,type:"percent",empty:true},lightness:{idx:2,type:"percent",empty:true}}}},g={byte:{floor:true,min:0,max:255},percent:{min:0,max:1},degrees:{mod:360,floor:true}},l=p.rgba.props,s=f.support={},m,v=u.each;p.hsla.props.alpha=l.alpha;function y(e,t,i){var n=g[t.type]||{},r=t.empty||i;if(r&&e==null){return null}if(t.def&&e==null){return t.def}if(n.floor){e=~~e}else{e=parseFloat(e)}if(e==null||isNaN(e)){return t.def}if(n.mod){e=e%n.mod;return e<0?n.mod+e:e}return n.min>e?n.min:n.max<e?n.max:e}function c(a){var l=f(),c=l._rgba=[];a=a.toLowerCase();v(t,function(e,t){var i=t.re.exec(a),n=i&&t.parse(i),r,o=t.space||"rgba",s=p[o].cache;if(n){r=l[o](n);l[s]=r[s];c=l._rgba=r._rgba;return false}});if(c.length!==0){if(Math.max.apply(Math,c)===0){u.extend(c,m.transparent)}return l}if(a=m[a]){return a}}f.fn=f.prototype={constructor:f,parse:function(r,e,t,i){if(r===d){this._rgba=[null,null,null,null];return this}if(r instanceof u||r.nodeType){r=r instanceof u?r.css(e):u(r).css(e);e=d}var o=this,n=u.type(r),s=this._rgba=[],a;if(e!==d){r=[r,e,t,i];n="array"}if(n==="string"){return this.parse(c(r)||m._default)}if(n==="array"){v(l,function(e,t){s[t.idx]=y(r[t.idx],t)});return this}if(n==="object"){if(r instanceof f){v(p,function(e,t){if(r[t.cache]){o[t.cache]=r[t.cache].slice()}})}else{v(p,function(e,n){v(n.props,function(e,t){var i=n.cache;if(!o[i]&&n.to){if(r[e]==null||e==="alpha"){return}o[i]=n.to(o._rgba)}o[i][t.idx]=y(r[e],t,true)})})}return this}},is:function(e){var r=f(e),o=true,s=this;v(p,function(e,t){var i=r[t.cache],n;if(i){n=s[t.cache]||t.to&&t.to(s._rgba)||[];v(t.props,function(e,t){if(i[t.idx]!=null){o=i[t.idx]===n[t.idx];return o}})}return o});return o},_space:function(){var i=[],n=this;v(p,function(e,t){if(n[t.cache]){i.push(e)}});return i.pop()},transition:function(e,s){var a=f(e),t=a._space(),i=p[t],l=this[i.cache]||i.to(this._rgba),c=l.slice();a=a[i.cache];v(i.props,function(e,t){var i=t.idx,n=l[i],r=a[i],o=g[t.type]||{};if(r===null){return}if(n===null){c[i]=r}else{if(o.mod){if(r-n>o.mod/2){n+=o.mod}else if(n-r>o.mod/2){n-=o.mod}}c[t.idx]=y((r-n)*s+n,t)}});return this[t](c)},blend:function(e){if(this._rgba[3]===1){return this}var t=this._rgba.slice(),i=t.pop(),n=f(e)._rgba;return f(u.map(t,function(e,t){return(1-i)*n[t]+i*e}))},toRgbaString:function(){var e="rgba(",t=u.map(this._rgba,function(e,t){return e==null?t>2?1:0:e});if(t[3]===1){t.pop();e="rgb("}return e+t.join(",")+")"},toHslaString:function(){var e="hsla(",t=u.map(this.hsla(),function(e,t){if(e==null){e=t>2?1:0}if(t&&t<3){e=Math.round(e*100)+"%"}return e});if(t[3]===1){t.pop();e="hsl("}return e+t.join(",")+")"},toHexString:function(e){var t=this._rgba.slice(),i=t.pop();if(e){t.push(~~(i*255))}return"#"+u.map(t,function(e,t){e=(e||0).toString(16);return e.length===1?"0"+e:e}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}};f.fn.parse.prototype=f.fn;function b(e,t,i){i=(i+1)%1;if(i*6<1){return e+(t-e)*6*i}if(i*2<1){return t}if(i*3<2){return e+(t-e)*(2/3-i)*6}return e}p.hsla.to=function(e){if(e[0]==null||e[1]==null||e[2]==null){return[null,null,null,e[3]]}var t=e[0]/255,i=e[1]/255,n=e[2]/255,r=e[3],o=Math.max(t,i,n),s=Math.min(t,i,n),a=o-s,l=o+s,c=l*.5,u,d;if(s===o){u=0}else if(t===o){u=60*(i-n)/a+360}else if(i===o){u=60*(n-t)/a+120}else{u=60*(t-i)/a+240}if(c===0||c===1){d=c}else if(c<=.5){d=a/l}else{d=a/(2-l)}return[Math.round(u)%360,d,c,r==null?1:r]};p.hsla.from=function(e){if(e[0]==null||e[1]==null||e[2]==null){return[null,null,null,e[3]]}var t=e[0]/360,i=e[1],n=e[2],r=e[3],o=n<=.5?n*(1+i):n+i-n*i,s=2*n-o,a,l,c;return[Math.round(b(s,o,t+1/3)*255),Math.round(b(s,o,t)*255),Math.round(b(s,o,t-1/3)*255),r]};v(p,function(l,e){var i=e.props,s=e.cache,a=e.to,c=e.from;f.fn[l]=function(e){if(a&&!this[s]){this[s]=a(this._rgba)}if(e===d){return this[s].slice()}var n=u.type(e),r=n==="array"||n==="object"?e:arguments,o=this[s].slice(),t;v(i,function(e,t){var i=r[n==="object"?e:t.idx];if(i==null){i=o[t.idx]}o[t.idx]=y(i,t)});if(c){t=f(c(o));t[s]=o;return t}else{return f(o)}};v(i,function(s,a){if(f.fn[s]){return}f.fn[s]=function(e){var t=u.type(e),i=s==="alpha"?this._hsla?"hsla":"rgba":l,n=this[i](),r=n[a.idx],o;if(t==="undefined"){return r}if(t==="function"){e=e.call(this,r);t=u.type(e)}if(e==null&&a.empty){return this}if(t==="string"){o=h.exec(e);if(o){e=r+parseFloat(o[2])*(o[1]==="+"?1:-1)}}n[a.idx]=e;return this[i](n)}})});v(e,function(e,o){u.cssHooks[o]={set:function(e,t){var i,n,r;if(u.type(t)!=="string"||(i=c(t))){t=f(i||t);if(!s.rgba&&t._rgba[3]!==1){r=o==="backgroundColor"?e.parentNode:e;do{n=u.curCSS(r,"backgroundColor")}while((n===""||n==="transparent")&&(r=r.parentNode)&&r.style);t=t.blend(n&&n!=="transparent"?n:"_default")}t=t.toRgbaString()}e.style[o]=t}};u.fx.step[o]=function(e){if(!e.colorInit){e.start=f(e.elem,o);e.end=f(e.end);e.colorInit=true}u.cssHooks[o].set(e.elem,e.start.transition(e.end,e.pos))}});u(function(){var e=document.createElement("div"),t=e.style;t.cssText="background-color:rgba(1,1,1,.5)";s.rgba=t.backgroundColor.indexOf("rgba")>-1});m=u.Color.names={aqua:"#00ffff",azure:"#f0ffff",beige:"#f5f5dc",black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightcyan:"#e0ffff",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightyellow:"#ffffe0",lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);(function(ve){ve.Jcrop=function(e,t){var T=ve.extend({},ve.Jcrop.defaults),s,r=navigator.userAgent.toLowerCase(),o=/msie/.test(r),m=/msie [1-6]\./.test(r);function D(e){return Math.round(e)+"px"}function R(e){return T.baseClass+"-"+e}function v(){return ve.fx.step.hasOwnProperty("backgroundColor")}function a(e){var t=ve(e).offset();return[t.left,t.top]}function d(e){return[e.pageX-s[0],e.pageY-s[1]]}function y(e){if(typeof e!=="object")e={};T=ve.extend(T,e);ve.each(["onChange","onSelect","onRelease","onDblClick"],function(e,t){if(typeof T[t]!=="function")T[t]=function(){}})}function b(e,t,i){s=a(k);g.setCursor(e==="move"?e:e+"-resize");if(e==="move"){return g.activateHandlers(j(t),l,i)}var n=G.getFixed();var r=z(e);var o=G.getCorner(z(r));G.setPressed(G.getCorner(r));G.setCurrent(o);g.activateHandlers(V(e,n),l,i)}function V(t,i){return function(e){if(!T.aspectRatio){switch(t){case"e":e[1]=i.y2;break;case"w":e[1]=i.y2;break;case"n":e[0]=i.x2;break;case"s":e[0]=i.x2;break}}else{switch(t){case"e":e[1]=i.y+1;break;case"w":e[1]=i.y+1;break;case"n":e[0]=i.x+1;break;case"s":e[0]=i.x+1;break}}G.setCurrent(e);H.update()}}function j(e){var t=e;ie.watchKeys();return function(e){G.moveOffset([e[0]-t[0],e[1]-t[1]]);t=e;H.update()}}function z(e){switch(e){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function W(t){return function(e){if(T.disabled){return false}if(t==="move"&&!T.allowMove){return false}s=a(k);p=true;b(t,d(e));e.stopPropagation();e.preventDefault();return false}}function U(e,t,i){var n=e.width(),r=e.height();if(n>t&&t>0){n=t;r=t/e.width()*e.height()}if(r>i&&i>0){r=i;n=i/e.height()*e.width()}A=e.width()/n;E=e.height()/r;e.width(n).height(r)}function M(e){return{x:e.x*A,y:e.y*E,x2:e.x2*A,y2:e.y2*E,w:e.w*A,h:e.h*E}}function l(e){var t=G.getFixed();if(t.w>T.minSelect[0]&&t.h>T.minSelect[1]){H.enableHandles();H.done()}else{H.release()}g.setCursor(T.allowSelect?"crosshair":"default")}function Y(e){if(T.disabled){return false}if(!T.allowSelect){return false}p=true;s=a(k);H.disableHandles();g.setCursor("crosshair");var t=d(e);G.setPressed(t);H.update();g.activateHandlers(q,l,e.type.substring(0,5)==="touch");ie.watchKeys();e.stopPropagation();e.preventDefault();return false}function q(e){G.setCurrent(e);H.update()}function K(){var e=ve("<div></div>").addClass(R("tracker"));if(o){e.css({opacity:0,backgroundColor:"white"})}return e}if(typeof e!=="object"){e=ve(e)[0]}if(typeof t!=="object"){t={}}y(t);var i={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0};var n=ve(e),X=true;if(e.tagName=="IMG"){if(n[0].width!=0&&n[0].height!=0){n.width(n[0].width);n.height(n[0].height)}else{var Z=new Image;Z.src=n[0].src;n.width(Z.width);n.height(Z.height)}var k=n.clone().removeAttr("id").css(i).show();k.width(n.width());k.height(n.height());n.after(k).hide()}else{k=n.css(i).show();X=false;if(T.shade===null){T.shade=true}}U(k,T.boxWidth,T.boxHeight);var _=k.width(),w=k.height(),f=ve("<div />").width(_).height(w).addClass(R("holder")).css({position:"relative",backgroundColor:T.bgColor}).insertAfter(n).append(k);if(T.addClass){f.addClass(T.addClass)}var O=ve("<div />"),N=ve("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),I=ve("<div />").width("100%").height("100%").css("zIndex",320),L=ve("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var e=G.getFixed();T.onDblClick.call(B,e)}).insertBefore(k).append(N,I);if(X){O=ve("<img />").attr("src",k.attr("src")).css(i).width(_).height(w),N.append(O)}if(m){L.css({overflowY:"hidden"})}var c=T.boundary;var h=K().width(_+c*2).height(w+c*2).css({position:"absolute",top:D(-c),left:D(-c),zIndex:290}).mousedown(Y);var Q=T.bgColor,P=T.bgOpacity,u,C,x,S,A,E,J=true,p,ee,te;s=a(k);var F=function(){function e(){var e={},t=["touchstart","touchmove","touchend"],i=document.createElement("div"),n;try{for(n=0;n<t.length;n++){var r=t[n];r="on"+r;var o=r in i;if(!o){i.setAttribute(r,"return;");o=typeof i[r]=="function"}e[t[n]]=o}return e.touchstart&&e.touchend&&e.touchmove}catch(e){return false}}function t(){if(T.touchSupport===true||T.touchSupport===false)return T.touchSupport;else return e()}return{createDragger:function(t){return function(e){if(T.disabled){return false}if(t==="move"&&!T.allowMove){return false}s=a(k);p=true;b(t,d(F.cfilter(e)),true);e.stopPropagation();e.preventDefault();return false}},newSelection:function(e){return Y(F.cfilter(e))},cfilter:function(e){e.pageX=e.originalEvent.changedTouches[0].pageX;e.pageY=e.originalEvent.changedTouches[0].pageY;return e},isSupported:e,support:t()}}();var G=function(){var f=0,p=0,g=0,m=0,t,i;function e(e){e=l(e);g=f=e[0];m=p=e[1]}function n(e){e=l(e);t=e[0]-g;i=e[1]-m;g=e[0];m=e[1]}function r(){return[t,i]}function o(e){var t=e[0],i=e[1];if(0>f+t){t-=t+f}if(0>p+i){i-=i+p}if(w<m+i){i+=w-(m+i)}if(_<g+t){t+=_-(g+t)}f+=t;g+=t;p+=i;m+=i}function s(e){var t=a();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}}function a(){if(!T.aspectRatio){return y()}var e=T.aspectRatio,t=T.minSize[0]/A,i=T.maxSize[0]/A,n=T.maxSize[1]/E,r=g-f,o=m-p,s=Math.abs(r),a=Math.abs(o),l=s/a,c,u,d,h;if(i===0){i=_*10}if(n===0){n=w*10}if(l<e){u=m;d=a*e;c=r<0?f-d:d+f;if(c<0){c=0;h=Math.abs((c-f)/e);u=o<0?p-h:h+p}else if(c>_){c=_;h=Math.abs((c-f)/e);u=o<0?p-h:h+p}}else{c=g;h=s/e;u=o<0?p-h:p+h;if(u<0){u=0;d=Math.abs((u-p)*e);c=r<0?f-d:d+f}else if(u>w){u=w;d=Math.abs(u-p)*e;c=r<0?f-d:d+f}}if(c>f){if(c-f<t){c=f+t}else if(c-f>i){c=f+i}if(u>p){u=p+(c-f)/e}else{u=p-(c-f)/e}}else if(c<f){if(f-c<t){c=f-t}else if(f-c>i){c=f-i}if(u>p){u=p+(f-c)/e}else{u=p-(f-c)/e}}if(c<0){f-=c;c=0}else if(c>_){f-=c-_;c=_}if(u<0){p-=u;u=0}else if(u>w){p-=u-w;u=w}return b(v(f,p,c,u))}function l(e){if(e[0]<0)e[0]=0;if(e[1]<0)e[1]=0;if(e[0]>_)e[0]=_;if(e[1]>w)e[1]=w;return[Math.round(e[0]),Math.round(e[1])]}function v(e,t,i,n){var r=e,o=i,s=t,a=n;if(i<e){r=i;o=e}if(n<t){s=n;a=t}return[r,s,o,a]}function y(){var e=g-f,t=m-p,i;if(u&&Math.abs(e)>u){g=e>0?f+u:f-u}if(C&&Math.abs(t)>C){m=t>0?p+C:p-C}if(S/E&&Math.abs(t)<S/E){m=t>0?p+S/E:p-S/E}if(x/A&&Math.abs(e)<x/A){g=e>0?f+x/A:f-x/A}if(f<0){g-=f;f-=f}if(p<0){m-=p;p-=p}if(g<0){f-=g;g-=g}if(m<0){p-=m;m-=m}if(g>_){i=g-_;f-=i;g-=i}if(m>w){i=m-w;p-=i;m-=i}if(f>_){i=f-w;m-=i;p-=i}if(p>w){i=p-w;m-=i;p-=i}return b(v(f,p,g,m))}function b(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}return{flipCoords:v,setPressed:e,setCurrent:n,getOffset:r,moveOffset:o,getCorner:s,getFixed:a}}();var $=function(){var i=false,n=ve("<div />").css({position:"absolute",zIndex:240,opacity:0}),r={top:s(),left:s().height(w),right:s().height(w),bottom:s()};function e(e,t){r.left.css({height:D(t)});r.right.css({height:D(t)})}function t(){return o(G.getFixed())}function o(e){r.top.css({left:D(e.x),width:D(e.w),height:D(e.y)});r.bottom.css({top:D(e.y2),left:D(e.x),width:D(e.w),height:D(w-e.y2)});r.right.css({left:D(e.x2),width:D(_-e.x2)});r.left.css({width:D(e.x)})}function s(){return ve("<div />").css({position:"absolute",backgroundColor:T.shadeColor||T.bgColor}).appendTo(n)}function a(){if(!i){i=true;n.insertBefore(k);t();H.setBgOpacity(1,0,1);O.hide();l(T.shadeColor||T.bgColor,1);if(H.isAwake()){u(T.bgOpacity,1)}else u(1,1)}}function l(e,t){ge(h(),e,t)}function c(){if(i){n.remove();O.show();i=false;if(H.isAwake()){H.setBgOpacity(T.bgOpacity,1,1)}else{H.setBgOpacity(1,1,1);H.disableHandles()}ge(f,0,1)}}function u(e,t){if(i){if(T.bgFade&&!t){n.animate({opacity:1-e},{queue:false,duration:T.fadeTime})}else n.css({opacity:1-e})}}function d(){T.shade?a():c();if(H.isAwake())u(T.bgOpacity)}function h(){return n.children()}return{update:t,updateRaw:o,getShades:h,setBgColor:l,enable:a,disable:c,resize:e,refresh:d,opacity:u}}();var H=function(){var n,r=370,o={},i={},s={},e=false;function a(e){var t=ve("<div />").css({position:"absolute",opacity:T.borderOpacity}).addClass(R(e));N.append(t);return t}function l(e,t){var i=ve("<div />").mousedown(W(e)).css({cursor:e+"-resize",position:"absolute",zIndex:t}).addClass("ord-"+e);if(F.support){i.bind("touchstart.jcrop",F.createDragger(e))}I.append(i);return i}function c(e){var t=T.handleSize,i=l(e,r++).css({opacity:T.handleOpacity}).addClass(R("handle"));if(t){i.width(t).height(t)}return i}function u(e){return l(e,r++).addClass("jcrop-dragbar")}function t(e){var t;for(t=0;t<e.length;t++){s[e[t]]=u(e[t])}}function d(e){var t,i;for(i=0;i<e.length;i++){switch(e[i]){case"n":t="hline";break;case"s":t="hline bottom";break;case"e":t="vline right";break;case"w":t="vline";break}o[e[i]]=a(t)}}function h(e){var t;for(t=0;t<e.length;t++){i[e[t]]=c(e[t])}}function f(e,t){if(!T.shade){O.css({top:D(-t),left:D(-e)})}L.css({top:D(t),left:D(e)})}function p(e,t){L.width(Math.round(e)).height(Math.round(t))}function g(){var e=G.getFixed();G.setPressed([e.x,e.y]);G.setCurrent([e.x2,e.y2]);m()}function m(e){if(n){return v(e)}}function v(e){var t=G.getFixed();p(t.w,t.h);f(t.x,t.y);if(T.shade)$.updateRaw(t);n||b();if(e){T.onSelect.call(B,M(t))}else{T.onChange.call(B,M(t))}}function y(e,t,i){if(!n&&!t)return;if(T.bgFade&&!i){k.animate({opacity:e},{queue:false,duration:T.fadeTime})}else{k.css("opacity",e)}}function b(){L.show();if(T.shade)$.opacity(P);else y(P,true);n=true}function _(){x();L.hide();if(T.shade)$.opacity(1);else y(1);n=false;T.onRelease.call(B)}function w(){if(e){I.show()}}function C(){e=true;if(T.allowResize){I.show();return true}}function x(){e=false;I.hide()}function S(e){if(e){ee=true;x()}else{ee=false;C()}}function A(){S(false);g()}if(T.dragEdges&&ve.isArray(T.createDragbars))t(T.createDragbars);if(ve.isArray(T.createHandles))h(T.createHandles);if(T.drawBorders&&ve.isArray(T.createBorders))d(T.createBorders);ve(document).bind("touchstart.jcrop-ios",function(e){if(ve(e.currentTarget).hasClass("jcrop-tracker"))e.stopPropagation()});var E=K().mousedown(W("move")).css({cursor:"move",position:"absolute",zIndex:360});if(F.support){E.bind("touchstart.jcrop",F.createDragger("move"))}N.append(E);x();return{updateVisible:m,update:v,release:_,refresh:g,isAwake:function(){return n},setCursor:function(e){E.css("cursor",e)},enableHandles:C,enableOnly:function(){e=true},showHandles:w,disableHandles:x,animMode:S,setBgOpacity:y,done:A}}();var g=function(){var n=function(){},r=function(){},t=T.trackDocument;function o(e){h.css({zIndex:450});if(e)ve(document).bind("touchmove.jcrop",l).bind("touchend.jcrop",c);else if(t)ve(document).bind("mousemove.jcrop",s).bind("mouseup.jcrop",a)}function i(){h.css({zIndex:290});ve(document).unbind(".jcrop")}function s(e){n(d(e));return false}function a(e){e.preventDefault();e.stopPropagation();if(p){p=false;r(d(e));if(H.isAwake()){T.onSelect.call(B,M(G.getFixed()))}i();n=function(){};r=function(){}}return false}function e(e,t,i){p=true;n=e;r=t;o(i);return false}function l(e){n(d(F.cfilter(e)));return false}function c(e){return a(F.cfilter(e))}function u(e){h.css("cursor",e)}if(!t){h.mousemove(s).mouseup(a).mouseout(a)}k.before(h);return{activateHandlers:e,setCursor:u}}();var ie=function(){var t=ve('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),e=ve("<div />").css({position:"absolute",overflow:"hidden"}).append(t);function i(){if(T.keySupport){}}function n(e){t.hide()}function r(e,t,i){if(T.allowMove){G.moveOffset([t,i]);H.updateVisible(true)}e.preventDefault();e.stopPropagation()}function o(e){if(e.ctrlKey||e.metaKey){return true}te=e.shiftKey?true:false;var t=te?10:1;switch(e.keyCode){case 37:r(e,-t,0);break;case 39:r(e,t,0);break;case 38:r(e,0,-t);break;case 40:r(e,0,t);break;case 27:if(T.allowSelect)H.release();break;case 9:return true}return false}if(T.keySupport){t.keydown(o).blur(n);if(m||!T.fixedSupport){t.css({position:"absolute",left:"-20px"});e.append(t).insertBefore(k)}else{t.insertBefore(k)}t.hide()}return{watchKeys:i}}();function ne(e){f.removeClass().addClass(R("holder")).addClass(e)}function re(e,t){var i=e[0]/A,n=e[1]/E,r=e[2]/A,o=e[3]/E;if(ee){return}var s=G.flipCoords(i,n,r,o),a=G.getFixed(),l=[a.x,a.y,a.x2,a.y2],c=l,u=T.animationDelay,d=s[0]-l[0],h=s[1]-l[1],f=s[2]-l[2],p=s[3]-l[3],g=0,m=T.swingSpeed;i=c[0];n=c[1];r=c[2];o=c[3];H.animMode(true);var v;function y(){window.setTimeout(b,u)}var b=function(){return function(){g+=(100-g)/m;c[0]=Math.round(i+g/100*d);c[1]=Math.round(n+g/100*h);c[2]=Math.round(r+g/100*f);c[3]=Math.round(o+g/100*p);if(g>=99.8){g=100}if(g<100){se(c);y()}else{H.done();H.animMode(false);if(typeof t==="function"){t.call(B)}}}}();y()}function oe(e){se([e[0]/A,e[1]/E,e[2]/A,e[3]/E]);T.onSelect.call(B,M(G.getFixed()));H.enableHandles()}function se(e){G.setPressed([e[0],e[1]]);G.setCurrent([e[2],e[3]]);H.update()}function ae(){return M(G.getFixed())}function le(){return G.getFixed()}function ce(e){y(e);me()}function ue(){T.disabled=true;H.disableHandles();H.setCursor("default");g.setCursor("default")}function de(){T.disabled=false;me()}function he(){H.done();g.activateHandlers(null,null)}function fe(){f.remove();n.show();n.css("visibility","visible");ve(e).removeData("Jcrop")}function pe(r,o){H.release();ue();var s=new Image;s.onload=function(){var e=s.width;var t=s.height;var i=T.boxWidth;var n=T.boxHeight;k.width(e).height(t);k.attr("src",r);O.attr("src",r);U(k,i,n);_=k.width();w=k.height();O.width(_).height(w);h.width(_+c*2).height(w+c*2);f.width(_).height(w);$.resize(_,w);de();if(typeof o==="function"){o.call(B)}};s.src=r}function ge(e,t,i){var n=t||T.bgColor;if(T.bgFade&&v()&&T.fadeTime&&!i){e.animate({backgroundColor:n},{queue:false,duration:T.fadeTime})}else{e.css("backgroundColor",n)}}function me(e){if(T.allowResize){if(e){H.enableOnly()}else{H.enableHandles()}}else{H.disableHandles()}g.setCursor(T.allowSelect?"crosshair":"default");H.setCursor(T.allowMove?"move":"default");if(T.hasOwnProperty("trueSize")){A=T.trueSize[0]/_;E=T.trueSize[1]/w}if(T.hasOwnProperty("setSelect")){oe(T.setSelect);H.done();delete T.setSelect}$.refresh();if(T.bgColor!=Q){ge(T.shade?$.getShades():f,T.shade?T.shadeColor||T.bgColor:T.bgColor);Q=T.bgColor}if(P!=T.bgOpacity){P=T.bgOpacity;if(T.shade)$.refresh();else H.setBgOpacity(P)}u=T.maxSize[0]||0;C=T.maxSize[1]||0;x=T.minSize[0]||0;S=T.minSize[1]||0;if(T.hasOwnProperty("outerImage")){k.attr("src",T.outerImage);delete T.outerImage}H.refresh()}if(F.support)h.bind("touchstart.jcrop",F.newSelection);I.hide();me(true);var B={setImage:pe,animateTo:re,setSelect:oe,setOptions:ce,tellSelect:ae,tellScaled:le,setClass:ne,disable:ue,enable:de,cancel:he,release:H.release,destroy:fe,focus:ie.watchKeys,getBounds:function(){return[_*A,w*E]},getWidgetSize:function(){return[_,w]},getScaleFactor:function(){return[A,E]},getOptions:function(){return T},ui:{holder:f,selection:L}};if(o)f.bind("selectstart",function(){return false});n.data("Jcrop",B);return B};ve.fn.Jcrop=function(e,t){var i;this.each(function(){if(ve(this).data("Jcrop")){if(e==="api")return ve(this).data("Jcrop");else ve(this).data("Jcrop").setOptions(e)}else{if(this.tagName=="IMG")ve.Jcrop.Loader(this,function(){ve(this).css({display:"block",visibility:"hidden"});i=ve.Jcrop(this,e);if(ve.isFunction(t))t.call(i)});else{ve(this).css({display:"block",visibility:"hidden"});i=ve.Jcrop(this,e);if(ve.isFunction(t))t.call(i)}}});return this};ve.Jcrop.Loader=function(e,t,i){var n=ve(e),r=n[0];function o(){if(r.complete){n.unbind(".jcloader");if(ve.isFunction(t))t.call(r)}else window.setTimeout(o,50)}n.bind("load.jcloader",o).bind("error.jcloader",function(e){n.unbind(".jcloader");if(ve.isFunction(i))i.call(r)});if(r.complete&&ve.isFunction(t)){n.unbind(".jcloader");t.call(r)}};ve.Jcrop.defaults={allowSelect:true,allowMove:true,allowResize:true,trackDocument:true,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:false,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:true,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:true,dragEdges:true,fixedSupport:true,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}})(jQuery);(function(e,t){if(typeof define==="function"&&define.amd){define(["jquery"],t)}else{t(e.jQuery)}})(this,function(d){"use strict";d.extendext=function(){var e,t,i,n,r,o,s=arguments[0]||{},a=1,l=arguments.length,c=false,u="default";if(typeof s==="boolean"){c=s;s=arguments[a++]||{}}if(typeof s==="string"){u=d([s.toLowerCase(),"default"]).filter(["default","concat","replace","extend"])[0];s=arguments[a++]||{}}if(typeof s!=="object"&&!d.isFunction(s)){s={}}if(a===l){s=this;a--}for(;a<l;a++){if((e=arguments[a])!==null){if(d.isArray(e)&&u!=="default"){o=s&&d.isArray(s)?s:[];switch(u){case"concat":s=o.concat(d.extend(c,[],e));break;case"replace":s=d.extend(c,[],e);break;case"extend":e.forEach(function(e,t){if(typeof e==="object"){var i=d.isArray(e)?[]:{};o[t]=d.extendext(c,u,o[t]||i,e)}else if(o.indexOf(e)===-1){o.push(e)}});s=o;break}}else{for(t in e){i=s[t];n=e[t];if(s===n){continue}if(c&&n&&(d.isPlainObject(n)||(r=d.isArray(n)))){if(r){r=false;o=i&&d.isArray(i)?i:[]}else{o=i&&d.isPlainObject(i)?i:{}}s[t]=d.extendext(c,u,o,n)}else if(n!==undefined){s[t]=n}}}}}return s}});(function(){"use strict";var l={version:"1.0.3",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:true,append:true,selfcontained:false,doNotSkipEncoded:false},template:undefined,compile:undefined},c;l.encodeHTMLSource=function(e){var t={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=e?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(e){return e?e.toString().replace(i,function(e){return t[e]||e}):""}};c=function(){return this||(0,eval)("this")}();if(typeof module!=="undefined"&&module.exports){module.exports=l}else if(typeof define==="function"&&define.amd){define(function(){return l})}else{c.doT=l}var u={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},d=/$^/;function h(r,e,o){return(typeof e==="string"?e:e.toString()).replace(r.define||d,function(e,n,t,i){if(n.indexOf("def.")===0){n=n.substring(4)}if(!(n in o)){if(t===":"){if(r.defineParams)i.replace(r.defineParams,function(e,t,i){o[n]={arg:t,text:i}});if(!(n in o))o[n]=i}else{new Function("def","def['"+n+"']="+i)(o)}}return""}).replace(r.use||d,function(e,t){if(r.useParams)t=t.replace(r.useParams,function(e,t,i,n){if(o[i]&&o[i].arg&&n){var r=(i+":"+n).replace(/'|\\/g,"_");o.__exp=o.__exp||{};o.__exp[r]=o[i].text.replace(new RegExp("(^|[^\\w$])"+o[i].arg+"([^\\w$])","g"),"$1"+n+"$2");return t+"def.__exp['"+r+"']"}});var i=new Function("def","return "+t)(o);return i?h(r,i,o):i})}function f(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}l.template=function(e,t,i){t=t||l.templateSettings;var n=t.append?u.append:u.split,r,o=0,s,a=t.use||t.define?h(t,e,i||{}):e;a=("var out='"+(t.strip?a.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):a).replace(/'|\\/g,"\\$&").replace(t.interpolate||d,function(e,t){return n.start+f(t)+n.end}).replace(t.encode||d,function(e,t){r=true;return n.startencode+f(t)+n.end}).replace(t.conditional||d,function(e,t,i){return t?i?"';}else if("+f(i)+"){out+='":"';}else{out+='":i?"';if("+f(i)+"){out+='":"';}out+='"}).replace(t.iterate||d,function(e,t,i,n){if(!t)return"';} } out+='";o+=1;s=n||"i"+o;t=f(t);return"';var arr"+o+"="+t+";if(arr"+o+"){var "+i+","+s+"=-1,l"+o+"=arr"+o+".length-1;while("+s+"<l"+o+"){"+i+"=arr"+o+"["+s+"+=1];out+='"}).replace(t.evaluate||d,function(e,t){return"';"+f(t)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,"");if(r){if(!t.selfcontained&&c&&!c._encodeHTML)c._encodeHTML=l.encodeHTMLSource(t.doNotSkipEncoded);a="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+l.encodeHTMLSource.toString()+"("+(t.doNotSkipEncoded||"")+"));"+a}try{return new Function(t.varname,a)}catch(e){if(typeof console!=="undefined")console.log("Could not create a template function: "+a);throw e}};l.compile=function(e,t){return l.template(e,null,t)}})();!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.agGrid=t():e.agGrid=t()}(window,function(){return function(i){var n={};function r(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}return r.m=i,r.c=n,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(P,e,t){"use strict";t.r(e),t.d(e,"ColumnFactory",function(){return Rt}),t.d(e,"ColumnModel",function(){return ni}),t.d(e,"ColumnKeyCreator",function(){return ce}),t.d(e,"ColumnUtils",function(){return oi}),t.d(e,"DisplayedGroupCreator",function(){return ai}),t.d(e,"GroupInstanceIdCreator",function(){return kt}),t.d(e,"GROUP_AUTO_COLUMN_ID",function(){return Nt}),t.d(e,"ComponentUtil",function(){return _}),t.d(e,"AgStackComponentsRegistry",function(){return vi}),t.d(e,"UserComponentRegistry",function(){return Ms}),t.d(e,"UserComponentFactory",function(){return Xs}),t.d(e,"ColDefUtil",function(){return Wt}),t.d(e,"BeanStub",function(){return p}),t.d(e,"Context",function(){return He}),t.d(e,"Autowired",function(){return s}),t.d(e,"PostConstruct",function(){return r}),t.d(e,"PreConstruct",function(){return Be}),t.d(e,"Optional",function(){return c}),t.d(e,"Bean",function(){return o}),t.d(e,"Qualifier",function(){return ze}),t.d(e,"PreDestroy",function(){return Ve}),t.d(e,"QuerySelector",function(){return Fr}),t.d(e,"RefSelector",function(){return A}),t.d(e,"ExcelFactoryMode",function(){return Zs}),t.d(e,"DragAndDropService",function(){return M}),t.d(e,"DragSourceType",function(){return es}),t.d(e,"HorizontalDirection",function(){return is}),t.d(e,"VerticalDirection",function(){return ts}),t.d(e,"DragService",function(){return Js}),t.d(e,"Column",function(){return d}),t.d(e,"ColumnGroup",function(){return g}),t.d(e,"ProvidedColumnGroup",function(){return h}),t.d(e,"RowNode",function(){return R}),t.d(e,"RowHighlightPosition",function(){return ea}),t.d(e,"FilterManager",function(){return oa}),t.d(e,"ProvidedFilter",function(){return Kr}),t.d(e,"SimpleFilter",function(){return E}),t.d(e,"ScalarFilter",function(){return T}),t.d(e,"NumberFilter",function(){return xo}),t.d(e,"TextFilter",function(){return Ao}),t.d(e,"DateFilter",function(){return fo}),t.d(e,"TextFloatingFilter",function(){return ko}),t.d(e,"HeaderFilterCellComp",function(){return la}),t.d(e,"FloatingFilterMapper",function(){return qs}),t.d(e,"GridBodyComp",function(){return sl}),t.d(e,"GridBodyCtrl",function(){return wa}),t.d(e,"RowAnimationCssClasses",function(){return ba}),t.d(e,"ScrollVisibleService",function(){return ll}),t.d(e,"MouseEventService",function(){return dl}),t.d(e,"NavigationService",function(){return fl}),t.d(e,"RowContainerComp",function(){return bl}),t.d(e,"RowContainerName",function(){return L}),t.d(e,"RowContainerCtrl",function(){return nl}),t.d(e,"RowContainerType",function(){return Za}),t.d(e,"getRowContainerTypeForName",function(){return Ja}),t.d(e,"BodyDropPivotTarget",function(){return wl}),t.d(e,"BodyDropTarget",function(){return Al}),t.d(e,"CssClassApplier",function(){return El}),t.d(e,"HeaderRowContainerComp",function(){return fc}),t.d(e,"GridHeaderComp",function(){return _c}),t.d(e,"GridHeaderCtrl",function(){return yc}),t.d(e,"HeaderRowComp",function(){return Nl}),t.d(e,"HeaderRowType",function(){return kl}),t.d(e,"HeaderRowCtrl",function(){return cc}),t.d(e,"HeaderCellCtrl",function(){return ec}),t.d(e,"SortIndicatorComp",function(){return No}),t.d(e,"HeaderFilterCellCtrl",function(){return Vl}),t.d(e,"HeaderGroupCellCtrl",function(){return sc}),t.d(e,"AbstractHeaderCellCtrl",function(){return Pl}),t.d(e,"HeaderRowContainerCtrl",function(){return dc}),t.d(e,"HorizontalResizeService",function(){return Cc}),t.d(e,"MoveColumnFeature",function(){return xl}),t.d(e,"StandardMenuFactory",function(){return Sc}),t.d(e,"TabbedLayout",function(){return Ec}),t.d(e,"simpleHttpRequest",function(){return Tc}),t.d(e,"ResizeObserverService",function(){return Rc}),t.d(e,"AnimationFrameService",function(){return kc}),t.d(e,"LargeTextCellEditor",function(){return Ho}),t.d(e,"PopupEditorWrapper",function(){return gl}),t.d(e,"SelectCellEditor",function(){return Vo}),t.d(e,"TextCellEditor",function(){return Uo}),t.d(e,"NumberCellEditor",function(){return bs}),t.d(e,"DateCellEditor",function(){return ws}),t.d(e,"DateStringCellEditor",function(){return Ss}),t.d(e,"CheckboxCellEditor",function(){return Ds}),t.d(e,"Beans",function(){return I}),t.d(e,"AnimateShowChangeCellRenderer",function(){return qo}),t.d(e,"AnimateSlideCellRenderer",function(){return Xo}),t.d(e,"GroupCellRenderer",function(){return hs}),t.d(e,"GroupCellRendererCtrl",function(){return us}),t.d(e,"SetLeftFeature",function(){return Gl}),t.d(e,"PositionableFeature",function(){return Yr}),t.d(e,"AutoWidthCalculator",function(){return Nc}),t.d(e,"CheckboxSelectionComponent",function(){return Qo}),t.d(e,"CellComp",function(){return ml}),t.d(e,"CellCtrl",function(){return Na}),t.d(e,"RowCtrl",function(){return Pa}),t.d(e,"RowRenderer",function(){return Fc}),t.d(e,"ValueFormatterService",function(){return Hc}),t.d(e,"CssClassManager",function(){return Ir}),t.d(e,"CheckboxCellRenderer",function(){return Es}),t.d(e,"PinnedRowModel",function(){return Vc}),t.d(e,"ServerSideTransactionResultStatus",function(){return jc}),t.d(e,"ChangedPath",function(){return zc}),t.d(e,"RowNodeBlock",function(){return Wc}),t.d(e,"RowNodeBlockLoader",function(){return Kc}),t.d(e,"PaginationProxy",function(){return Zc}),t.d(e,"ClientSideRowModelSteps",function(){return ta}),t.d(e,"StylingService",function(){return Jc}),t.d(e,"LayoutCssClasses",function(){return ca}),t.d(e,"AgAbstractField",function(){return Qr}),t.d(e,"AgCheckbox",function(){return ao}),t.d(e,"AgRadioButton",function(){return lo}),t.d(e,"AgToggleButton",function(){return eu}),t.d(e,"AgInputTextField",function(){return bo}),t.d(e,"AgInputTextArea",function(){return tu}),t.d(e,"AgInputNumberField",function(){return _o}),t.d(e,"AgInputDateField",function(){return iu}),t.d(e,"AgInputRange",function(){return nu}),t.d(e,"AgSelect",function(){return ro}),t.d(e,"AgSlider",function(){return ou}),t.d(e,"AgGroupComponent",function(){return au}),t.d(e,"AgMenuItemComponent",function(){return pu}),t.d(e,"AgMenuList",function(){return uu}),t.d(e,"AgMenuPanel",function(){return hu}),t.d(e,"AgDialog",function(){return yu}),t.d(e,"AgPanel",function(){return mu}),t.d(e,"Component",function(){return S}),t.d(e,"ManagedFocusFeature",function(){return Wr}),t.d(e,"TabGuardComp",function(){return lu}),t.d(e,"TabGuardCtrl",function(){return Kl}),t.d(e,"TabGuardClassNames",function(){return Yl}),t.d(e,"PopupComponent",function(){return Go}),t.d(e,"PopupService",function(){return xu}),t.d(e,"TouchListener",function(){return D}),t.d(e,"VirtualList",function(){return Au}),t.d(e,"AgAbstractLabel",function(){return Zr}),t.d(e,"AgPickerField",function(){return eo}),t.d(e,"CellRangeType",function(){return xa}),t.d(e,"SelectionHandleType",function(){return Ca}),t.d(e,"AutoScrollService",function(){return ma}),t.d(e,"VanillaFrameworkOverrides",function(){return Du}),t.d(e,"CellNavigationService",function(){return Mu}),t.d(e,"AlignedGridsService",function(){return Nu}),t.d(e,"KeyCode",function(){return x}),t.d(e,"Grid",function(){return wh}),t.d(e,"GridCoreCreator",function(){return xh}),t.d(e,"GridApi",function(){return O}),t.d(e,"Events",function(){return y}),t.d(e,"FocusService",function(){return Ql}),t.d(e,"GridOptionsService",function(){return uh}),t.d(e,"EventService",function(){return qe}),t.d(e,"SelectableService",function(){return Ad}),t.d(e,"RowNodeSorter",function(){return Yd}),t.d(e,"CtrlsService",function(){return Xd}),t.d(e,"GridComp",function(){return Ju}),t.d(e,"GridCtrl",function(){return Zu}),t.d(e,"Logger",function(){return Ku}),t.d(e,"LoggerFactory",function(){return qu}),t.d(e,"SortController",function(){return id}),t.d(e,"TemplateService",function(){return Wu}),t.d(e,"LocaleService",function(){return hh}),t.d(e,"_",function(){return Er}),t.d(e,"NumberSequence",function(){return Tr}),t.d(e,"AgPromiseStatus",function(){return Dr}),t.d(e,"AgPromise",function(){return Rr}),t.d(e,"Timer",function(){return Mr}),t.d(e,"ValueService",function(){return Hu}),t.d(e,"ValueCache",function(){return ud}),t.d(e,"ExpressionService",function(){return ju}),t.d(e,"ValueParserService",function(){return _h}),t.d(e,"CellPositionUtils",function(){return Id}),t.d(e,"RowPositionUtils",function(){return Od}),t.d(e,"HeaderPositionUtils",function(){return Bd}),t.d(e,"HeaderNavigationService",function(){return mc}),t.d(e,"HeaderNavigationDirection",function(){return pc}),t.d(e,"PropertyKeys",function(){return b}),t.d(e,"ColumnApi",function(){return Gu}),t.d(e,"BaseComponentWrapper",function(){return Sh}),t.d(e,"Environment",function(){return _d}),t.d(e,"CustomTooltipFeature",function(){return Nr}),t.d(e,"DEFAULT_CHART_GROUPS",function(){return Ah}),t.d(e,"CHART_TOOL_PANEL_ALLOW_LIST",function(){return Eh}),t.d(e,"CHART_TOOLBAR_ALLOW_LIST",function(){return Th}),t.d(e,"CHART_TOOL_PANEL_MENU_OPTIONS",function(){return Dh}),t.d(e,"__FORCE_MODULE_DETECTION",function(){return Rh}),t.d(e,"BarColumnLabelPlacement",function(){return Mh}),t.d(e,"ModuleNames",function(){return m}),t.d(e,"ModuleRegistry",function(){return v});var F={};t.r(F),t.d(F,"makeNull",function(){return J}),t.d(F,"exists",function(){return C}),t.d(F,"missing",function(){return u}),t.d(F,"missingOrEmpty",function(){return ee}),t.d(F,"toStringOrNull",function(){return te}),t.d(F,"attrToNumber",function(){return ie}),t.d(F,"attrToBoolean",function(){return ne}),t.d(F,"attrToString",function(){return re}),t.d(F,"referenceCompare",function(){return oe}),t.d(F,"jsonEquals",function(){return se}),t.d(F,"defaultComparator",function(){return ae}),t.d(F,"values",function(){return le});var G={};t.r(G),t.d(G,"iterateObject",function(){return a}),t.d(G,"cloneObject",function(){return ue}),t.d(G,"deepCloneObject",function(){return de}),t.d(G,"deepCloneDefinition",function(){return he}),t.d(G,"getProperty",function(){return fe}),t.d(G,"setProperty",function(){return pe}),t.d(G,"copyPropertiesIfPresent",function(){return ge}),t.d(G,"copyPropertyIfPresent",function(){return me}),t.d(G,"getAllKeysInObjects",function(){return ve}),t.d(G,"getAllValuesInObject",function(){return ye}),t.d(G,"mergeDeep",function(){return be}),t.d(G,"missingOrEmptyObject",function(){return _e}),t.d(G,"get",function(){return we}),t.d(G,"set",function(){return Ce}),t.d(G,"getValueUsingField",function(){return xe}),t.d(G,"removeAllReferences",function(){return Se}),t.d(G,"isNonNullObject",function(){return Ae});var $={};t.r($),t.d($,"doOnce",function(){return l}),t.d($,"getFunctionName",function(){return Te}),t.d($,"isFunction",function(){return De}),t.d($,"executeInAWhile",function(){return Re}),t.d($,"executeNextVMTurn",function(){return Oe}),t.d($,"executeAfter",function(){return Ne}),t.d($,"debounce",function(){return Ie}),t.d($,"throttle",function(){return Le}),t.d($,"waitUntil",function(){return Pe}),t.d($,"compose",function(){return Fe}),t.d($,"callIfPresent",function(){return Ge}),t.d($,"noop",function(){return $e});var H={};t.r(H),t.d(H,"firstExistingValue",function(){return et}),t.d(H,"existsAndNotEmpty",function(){return tt}),t.d(H,"last",function(){return f}),t.d(H,"areEqual",function(){return it}),t.d(H,"shallowCompare",function(){return nt}),t.d(H,"sortNumerically",function(){return rt}),t.d(H,"removeRepeatsFromArray",function(){return ot}),t.d(H,"removeFromArray",function(){return st}),t.d(H,"removeAllFromArray",function(){return at}),t.d(H,"insertIntoArray",function(){return lt}),t.d(H,"insertArrayIntoArray",function(){return ct}),t.d(H,"moveInArray",function(){return ut}),t.d(H,"includes",function(){return dt}),t.d(H,"flatten",function(){return ht}),t.d(H,"pushAll",function(){return ft}),t.d(H,"toStrings",function(){return pt}),t.d(H,"forEachReverse",function(){return gt});var B={};t.r(B),t.d(B,"stopPropagationForAgGrid",function(){return yt}),t.d(B,"isStopPropagationForAgGrid",function(){return bt}),t.d(B,"isEventSupported",function(){return _t}),t.d(B,"getCtrlForEventTarget",function(){return wt}),t.d(B,"isElementInEventPath",function(){return Ct}),t.d(B,"createEventPath",function(){return xt}),t.d(B,"getEventPath",function(){return St}),t.d(B,"addSafePassiveEventListener",function(){return At});var V={};t.r(V),t.d(V,"utf8_encode",function(){return Ft}),t.d(V,"capitalise",function(){return Gt}),t.d(V,"escapeString",function(){return $t}),t.d(V,"camelCaseToHumanText",function(){return Ht}),t.d(V,"camelCaseToHyphenated",function(){return Bt});var j={};t.r(j),t.d(j,"convertToMap",function(){return Vt}),t.d(j,"mapById",function(){return jt}),t.d(j,"keys",function(){return zt});var z={};t.r(z),t.d(z,"fuzzyCheckStrings",function(){return Ut}),t.d(z,"fuzzySuggestions",function(){return Yt});var i={};t.r(i),t.d(i,"setAriaRole",function(){return Ci}),t.d(i,"getAriaSortState",function(){return xi}),t.d(i,"getAriaLevel",function(){return Si}),t.d(i,"getAriaPosInSet",function(){return Ai}),t.d(i,"getAriaDescribedBy",function(){return Ei}),t.d(i,"setAriaLabel",function(){return Ti}),t.d(i,"setAriaLabelledBy",function(){return Di}),t.d(i,"setAriaDescription",function(){return Ri}),t.d(i,"setAriaDescribedBy",function(){return Mi}),t.d(i,"setAriaLive",function(){return ki}),t.d(i,"setAriaLevel",function(){return Oi}),t.d(i,"setAriaDisabled",function(){return Ni}),t.d(i,"setAriaHidden",function(){return Ii}),t.d(i,"setAriaExpanded",function(){return Li}),t.d(i,"removeAriaExpanded",function(){return Pi}),t.d(i,"setAriaSetSize",function(){return Fi}),t.d(i,"setAriaPosInSet",function(){return Gi}),t.d(i,"setAriaMultiSelectable",function(){return $i}),t.d(i,"setAriaRowCount",function(){return Hi}),t.d(i,"setAriaRowIndex",function(){return Bi}),t.d(i,"setAriaColCount",function(){return Vi}),t.d(i,"setAriaColIndex",function(){return ji}),t.d(i,"setAriaColSpan",function(){return zi}),t.d(i,"setAriaSort",function(){return Wi}),t.d(i,"removeAriaSort",function(){return Ui}),t.d(i,"setAriaSelected",function(){return Yi}),t.d(i,"setAriaChecked",function(){return qi}),t.d(i,"setAriaControls",function(){return Ki}),t.d(i,"getAriaCheckboxStateName",function(){return Xi});var W={};t.r(W),t.d(W,"isBrowserSafari",function(){return Zi}),t.d(W,"getSafariVersion",function(){return Qi}),t.d(W,"isBrowserChrome",function(){return Ji}),t.d(W,"isBrowserFirefox",function(){return en}),t.d(W,"isMacOsUserAgent",function(){return tn}),t.d(W,"isIOSUserAgent",function(){return nn}),t.d(W,"browserSupportsPreventScroll",function(){return rn}),t.d(W,"getTabIndex",function(){return on}),t.d(W,"getMaxDivHeight",function(){return sn}),t.d(W,"getBodyWidth",function(){return an}),t.d(W,"getBodyHeight",function(){return ln}),t.d(W,"getScrollbarWidth",function(){return cn}),t.d(W,"isInvisibleScrollbar",function(){return dn});var U={};t.r(U),t.d(U,"padStartWidthZeros",function(){return hn}),t.d(U,"createArrayOfNumbers",function(){return fn}),t.d(U,"cleanNumber",function(){return pn}),t.d(U,"decToHex",function(){return gn}),t.d(U,"formatNumberTwoDecimalPlacesAndCommas",function(){return mn}),t.d(U,"formatNumberCommas",function(){return vn}),t.d(U,"sum",function(){return yn}),t.d(U,"zeroOrGreater",function(){return bn}),t.d(U,"oneOrGreater",function(){return _n});var Y={};t.r(Y),t.d(Y,"serialiseDate",function(){return wn}),t.d(Y,"dateToFormattedString",function(){return xn}),t.d(Y,"parseDateTimeFromString",function(){return Sn});var n={};t.r(n),t.d(n,"radioCssClass",function(){return En}),t.d(n,"FOCUSABLE_SELECTOR",function(){return Tn}),t.d(n,"FOCUSABLE_EXCLUDE",function(){return Dn}),t.d(n,"isFocusableFormField",function(){return Rn}),t.d(n,"setDisplayed",function(){return w}),t.d(n,"setVisible",function(){return Mn}),t.d(n,"setDisabled",function(){return kn}),t.d(n,"isElementChildOfClass",function(){return On}),t.d(n,"getElementSize",function(){return Nn}),t.d(n,"getInnerHeight",function(){return In}),t.d(n,"getInnerWidth",function(){return Ln}),t.d(n,"getAbsoluteHeight",function(){return Pn}),t.d(n,"getAbsoluteWidth",function(){return Fn}),t.d(n,"getElementRectWithOffset",function(){return Gn}),t.d(n,"isRtlNegativeScroll",function(){return $n}),t.d(n,"getScrollLeft",function(){return Hn}),t.d(n,"setScrollLeft",function(){return Bn}),t.d(n,"clearElement",function(){return Vn}),t.d(n,"removeElement",function(){return jn}),t.d(n,"removeFromParent",function(){return zn}),t.d(n,"isVisible",function(){return Wn}),t.d(n,"loadTemplate",function(){return Un}),t.d(n,"appendHtml",function(){return Yn}),t.d(n,"getElementAttribute",function(){return qn}),t.d(n,"offsetHeight",function(){return Kn}),t.d(n,"offsetWidth",function(){return Xn}),t.d(n,"ensureDomOrder",function(){return Zn}),t.d(n,"setDomChildOrder",function(){return Qn}),t.d(n,"insertWithDomOrder",function(){return Jn}),t.d(n,"prependDC",function(){return er}),t.d(n,"addStylesToElement",function(){return tr}),t.d(n,"isHorizontalScrollShowing",function(){return ir}),t.d(n,"isVerticalScrollShowing",function(){return nr}),t.d(n,"setElementWidth",function(){return rr}),t.d(n,"setFixedWidth",function(){return or}),t.d(n,"setElementHeight",function(){return sr}),t.d(n,"setFixedHeight",function(){return ar}),t.d(n,"formatSize",function(){return lr}),t.d(n,"isNodeOrElement",function(){return cr}),t.d(n,"copyNodeList",function(){return ur}),t.d(n,"iterateNamedNodeMap",function(){return dr}),t.d(n,"addOrRemoveAttribute",function(){return hr}),t.d(n,"nodeListForEach",function(){return fr});var q={};t.r(q),t.d(q,"iconNameClassMap",function(){return pr}),t.d(q,"createIcon",function(){return gr}),t.d(q,"createIconNoSpan",function(){return mr});var K={};t.r(K),t.d(K,"isEventFromPrintableCharacter",function(){return vr}),t.d(K,"isUserSuppressingKeyboardEvent",function(){return yr}),t.d(K,"isUserSuppressingHeaderKeyboardEvent",function(){return br}),t.d(K,"normaliseQwertyAzerty",function(){return _r}),t.d(K,"isDeleteKey",function(){return wr});var X={};t.r(X),t.d(X,"areEventsNear",function(){return Cr});var Z={};t.r(Z),t.d(Z,"sortRowNodesByOrder",function(){return xr}),t.d(Z,"traverseNodesWithKey",function(){return Sr});var Q={};function J(e){return null==e||""===e?null:e}function C(e,t=!1){return null!=e&&(""!==e||t)}function u(e){return!C(e)}function ee(e){return null==e||0===e.length}function te(e){return null!=e&&"function"==typeof e.toString?e.toString():null}function ie(e){if(void 0===e)return;if(null===e||""===e)return null;if("number"==typeof e)return isNaN(e)?void 0:e;const t=parseInt(e,10);return isNaN(t)?void 0:t}function ne(e){if(void 0!==e)return null!==e&&""!==e&&("boolean"==typeof e?e:/true/i.test(e))}function re(e){if(null!=e&&""!==e)return e}function oe(e,t){return null==e&&null==t||(null!=e||null==t)&&((null==e||null!=t)&&e===t)}function se(e,t){return(e?JSON.stringify(e):null)===(t?JSON.stringify(t):null)}function ae(e,t,i=!1){const n=null==e,r=null==t;if(e&&e.toNumber&&(e=e.toNumber()),t&&t.toNumber&&(t=t.toNumber()),n&&r)return 0;if(n)return-1;if(r)return 1;function o(e,t){return e>t?1:e<t?-1:0}if("string"!=typeof e)return o(e,t);if(!i)return o(e,t);try{return e.localeCompare(t)}catch(i){return o(e,t)}}function le(e){if(e instanceof Set||e instanceof Map){const t=[];return e.forEach(e=>t.push(e)),t}return Object.values(e)}t.r(Q),t.d(Q,"convertToSet",function(){return Ar});class ce{constructor(){this.existingKeys={}}addExistingKeys(t){for(let e=0;e<t.length;e++)this.existingKeys[t[e]]=!0}getUniqueKey(t,i){t=te(t);let n=0;for(;;){let e;if(t?(e=t,0!==n&&(e+="_"+n)):i?(e=i,0!==n&&(e+="_"+n)):e=""+n,!this.existingKeys[e])return this.existingKeys[e]=!0,e;n++}}}function a(t,i){null!=t&&(Array.isArray(t)?t.forEach((e,t)=>i(""+t,e)):Object.keys(t).forEach(e=>i(e,t[e])))}function ue(n){const r={},o=Object.keys(n);for(let i=0;i<o.length;i++){const e=o[i],t=n[e];r[e]=t}return r}function de(e){return JSON.parse(JSON.stringify(e))}function he(e,n){if(!e)return;const r=e,o={};return Object.keys(r).forEach(e=>{if(n&&n.indexOf(e)>=0)return;const t=r[e],i=Ae(t)&&t.constructor===Object;o[e]=i?he(t):t}),o}function fe(e,t){return e[t]}function pe(e,t,i){e[t]=i}function ge(t,i,...e){e.forEach(e=>me(t,i,e))}function me(e,t,i,n){const r=fe(e,i);void 0!==r&&pe(t,i,n?n(r):r)}function ve(e){const t={};return e.filter(e=>null!=e).forEach(e=>{Object.keys(e).forEach(e=>t[e]=null)}),Object.keys(t)}function ye(e){if(!e)return[];const t=Object;if("function"==typeof t.values)return t.values(e);const i=[];for(const t in e)e.hasOwnProperty(t)&&e.propertyIsEnumerable(t)&&i.push(e[t]);return i}function be(n,e,r=!0,o=!1){C(e)&&a(e,(e,t)=>{let i=n[e];if(i!==t){if(o){if(null==i&&null!=t){"object"==typeof t&&t.constructor===Object&&(i={},n[e]=i)}}Ae(t)&&Ae(i)&&!Array.isArray(i)?be(i,t,r,o):(r||void 0!==t)&&(n[e]=t)}})}function _e(e){return u(e)||0===Object.keys(e).length}function we(e,t,i){if(null==e)return i;const n=t.split(".");let r=e;for(;n.length>1;)if(r=r[n.shift()],null==r)return i;const o=r[n[0]];return null!=o?o:i}function Ce(e,t,i){if(null==e)return;const n=t.split(".");let r=e;n.forEach((e,t)=>{r[e]||(r[e]={}),t<n.length-1&&(r=r[e])}),r[n[n.length-1]]=i}function xe(e,t,i){if(!t||!e)return;if(!i)return e[t];const n=t.split(".");let r=e;for(let e=0;e<n.length;e++){if(null==r)return;r=r[n[e]]}return r}function Se(t,i){Object.keys(t).forEach(e=>{"object"==typeof t[e]&&(t[e]=void 0)});const n=Object.getPrototypeOf(t),r={};Object.keys(n).forEach(e=>{if("function"==typeof n[e]){const n=()=>{console.warn(`AG Grid: ${i} function ${e}() cannot be called as the grid has been destroyed.\n                     Please don't call grid API functions on destroyed grids - as a matter of fact you shouldn't\n                     be keeping the API reference, your application has a memory leak! Remove the API reference\n                     when the grid is destroyed.`)};r[e]={value:n,writable:!0}}}),Object.defineProperties(t,r)}function Ae(e){return"object"==typeof e&&null!==e}const Ee={};function l(e,t){Ee[t]||(e(),Ee[t]=!0)}function Te(e){if(e.name)return e.name;const t=/function\s+([^\(]+)/.exec(e.toString());return t&&2===t.length?t[1].trim():null}function De(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Re(e){Ne(e,400)}const Me=[];let ke=!1;function Oe(e){Me.push(e),ke||(ke=!0,window.setTimeout(()=>{const e=Me.slice();Me.length=0,ke=!1,e.forEach(e=>e())},0))}function Ne(e,t=0){e.length>0&&window.setTimeout(()=>e.forEach(e=>e()),t)}function Ie(i,n){let r;return function(...e){const t=this;window.clearTimeout(r),r=window.setTimeout(function(){i.apply(t,e)},n)}}function Le(i,n){let r=0;return function(...e){const t=(new Date).getTime();t-r<n||(r=t,i.apply(this,e))}}function Pe(t,i,n=100,r){const o=(new Date).getTime();let s=null,a=!1;const e=()=>{const e=(new Date).getTime()-o>n;(t()||e)&&(i(),a=!0,null!=s&&(window.clearInterval(s),s=null),e&&r&&console.warn(r))};e(),a||(s=window.setInterval(e,10))}function Fe(...t){return e=>t.reduce((e,t)=>t(e),e)}function Ge(e){e&&e()}const $e=()=>{};var m;!function(e){e.CommunityCoreModule="@ag-grid-community/core",e.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",e.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",e.CsvExportModule="@ag-grid-community/csv-export",e.EnterpriseCoreModule="@ag-grid-enterprise/core",e.RowGroupingModule="@ag-grid-enterprise/row-grouping",e.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",e.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",e.MenuModule="@ag-grid-enterprise/menu",e.SetFilterModule="@ag-grid-enterprise/set-filter",e.MultiFilterModule="@ag-grid-enterprise/multi-filter",e.StatusBarModule="@ag-grid-enterprise/status-bar",e.SideBarModule="@ag-grid-enterprise/side-bar",e.RangeSelectionModule="@ag-grid-enterprise/range-selection",e.MasterDetailModule="@ag-grid-enterprise/master-detail",e.RichSelectModule="@ag-grid-enterprise/rich-select",e.GridChartsModule="@ag-grid-enterprise/charts",e.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",e.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",e.ExcelExportModule="@ag-grid-enterprise/excel-export",e.ClipboardModule="@ag-grid-enterprise/clipboard",e.SparklinesModule="@ag-grid-enterprise/sparklines",e.AngularModule="@ag-grid-community/angular",e.ReactModule="@ag-grid-community/react",e.VueModule="@ag-grid-community/vue"}(m||(m={}));class v{static register(e){v.__register(e,!0,void 0)}static registerModules(e){v.__registerModules(e,!0,void 0)}static __register(e,t,i){v.runVersionChecks(e),void 0!==i?(v.areGridScopedModules=!0,void 0===v.gridModulesMap[i]&&(v.gridModulesMap[i]={}),v.gridModulesMap[i][e.moduleName]=e):v.globalModulesMap[e.moduleName]=e,v.setModuleBased(t)}static __unRegisterGridModules(e){delete v.gridModulesMap[e]}static __registerModules(e,t,i){v.setModuleBased(t),e&&e.forEach(e=>v.__register(e,t,i))}static isValidModuleVersion(e){const[t,i]=e.version.split(".")||[],[n,r]=v.currentModuleVersion.split(".")||[];return t===n&&i===r}static runVersionChecks(t){if(v.currentModuleVersion||(v.currentModuleVersion=t.version),t.version?v.isValidModuleVersion(t)||console.error(`AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '${t.moduleName}' is version ${t.version} but the other modules are version ${this.currentModuleVersion}. Please update all modules to the same version.`):console.error(`AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '${t.moduleName}' is incompatible. Please update all modules to the same version.`),t.validate){const e=t.validate();if(!e.isValid){const t=e;console.error("AG Grid: "+t.message)}}}static setModuleBased(e){void 0===v.moduleBased?v.moduleBased=e:v.moduleBased!==e&&l(()=>{console.warn("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),console.warn("Please see https://www.ag-grid.com/javascript-grid/packages-modules/ for more information.")},"ModulePackageCheck")}static __setIsBundled(){v.isBundled=!0}static __assertRegistered(i,t,n){var r;if(this.__isRegistered(i,n))return!0;const e=t+i;let o;if(v.isBundled)o=`AG Grid: unable to use ${t} as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:\n        \n        <script src="https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js"><\/script>\n        \nFor more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise`;else if(v.moduleBased||void 0===v.moduleBased){let e=null===(r=Object.entries(m).find(([e,t])=>t===i))||void 0===r?void 0:r[0];o=`AG Grid: unable to use ${t} as the ${e} is not registered${v.areGridScopedModules?" for gridId: "+n:""}. Check if you have registered the module:\n           \n    import { ModuleRegistry } from '@ag-grid-community/core';\n    import { ${e} } from '${i}';\n    \n    ModuleRegistry.registerModules([ ${e} ]);\n\nFor more info see: https://www.ag-grid.com/javascript-grid/modules/`}else o=`AG Grid: unable to use ${t} as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:\n            \n    import 'ag-grid-enterprise';\n            \nFor more info see: https://www.ag-grid.com/javascript-grid/packages/`;return l(()=>{console.warn(o)},e),!1}static __isRegistered(e,t){var i;return!!v.globalModulesMap[e]||!!(null===(i=v.gridModulesMap[t])||void 0===i?void 0:i[e])}static __getRegisteredModules(e){return[...le(v.globalModulesMap),...le(v.gridModulesMap[e]||{})]}static __getGridRegisteredModules(e){var t;return le(null!==(t=v.gridModulesMap[e])&&void 0!==t?t:{})||[]}static __isPackageBased(){return!v.moduleBased}}v.globalModulesMap={},v.gridModulesMap={},v.areGridScopedModules=!1;class He{constructor(e,t){if(this.beanWrappers={},this.destroyed=!1,!e||!e.beanClasses)return;this.contextParams=e,this.logger=t,this.logger.log(">> creating ag-Application Context"),this.createBeans();const i=this.getBeanInstances();this.wireBeans(i),this.logger.log(">> ag-Application Context ready - component is alive")}getBeanInstances(){return le(this.beanWrappers).map(e=>e.beanInstance)}createBean(e,t){if(!e)throw Error("Can't wire to bean since it is null");return this.wireBeans([e],t),e}wireBeans(e,t){this.autoWireBeans(e),this.methodWireBeans(e),this.callLifeCycleMethods(e,"preConstructMethods"),C(t)&&e.forEach(t),this.callLifeCycleMethods(e,"postConstructMethods")}createBeans(){this.contextParams.beanClasses.forEach(this.createBeanWrapper.bind(this)),a(this.beanWrappers,(e,t)=>{let i;t.bean.__agBeanMetaData&&t.bean.__agBeanMetaData.autowireMethods&&t.bean.__agBeanMetaData.autowireMethods.agConstructor&&(i=t.bean.__agBeanMetaData.autowireMethods.agConstructor);const n=this.getBeansForParameters(i,t.bean.name),r=new(t.bean.bind.apply(t.bean,[null,...n]));t.beanInstance=r});const e=Object.keys(this.beanWrappers).join(", ");this.logger.log("created beans: "+e)}createBeanWrapper(t){const e=t.__agBeanMetaData;if(!e){let e;return e=t.prototype.constructor?Te(t.prototype.constructor):""+t,void console.error(`Context item ${e} is not a bean`)}const i={bean:t,beanInstance:null,beanName:e.beanName};this.beanWrappers[e.beanName]=i}autoWireBeans(e){e.forEach(n=>{this.forEachMetaDataInHierarchy(n,(e,i)=>{const t=e.agClassAttributes;t&&t.forEach(e=>{const t=this.lookupBeanInstance(i,e.beanName,e.optional);n[e.attributeName]=t})})})}methodWireBeans(e){e.forEach(r=>{this.forEachMetaDataInHierarchy(r,(e,n)=>{a(e.autowireMethods,(e,t)=>{if("agConstructor"===e)return;const i=this.getBeansForParameters(t,n);r[e].apply(r,i)})})})}forEachMetaDataInHierarchy(e,t){let i=Object.getPrototypeOf(e);for(;null!=i;){const e=i.constructor;if(e.hasOwnProperty("__agBeanMetaData")){t(e.__agBeanMetaData,this.getBeanName(e))}i=Object.getPrototypeOf(i)}}getBeanName(e){if(e.__agBeanMetaData&&e.__agBeanMetaData.beanName)return e.__agBeanMetaData.beanName;const t=e.toString();return t.substring(9,t.indexOf("("))}getBeansForParameters(e,n){const r=[];return e&&a(e,(e,t)=>{const i=this.lookupBeanInstance(n,t);r[Number(e)]=i}),r}lookupBeanInstance(e,t,i=!1){if(this.destroyed)return this.logger.log(`AG Grid: bean reference ${t} is used after the grid is destroyed!`),null;if("context"===t)return this;if(this.contextParams.providedBeanInstances&&this.contextParams.providedBeanInstances.hasOwnProperty(t))return this.contextParams.providedBeanInstances[t];const n=this.beanWrappers[t];return n?n.beanInstance:(i||console.error(`AG Grid: unable to find bean reference ${t} while initialising ${e}`),null)}callLifeCycleMethods(e,t){e.forEach(e=>this.callLifeCycleMethodsOnBean(e,t))}callLifeCycleMethodsOnBean(t,i,n){const r={};this.forEachMetaDataInHierarchy(t,e=>{const t=e[i];t&&t.forEach(e=>{e!=n&&(r[e]=!0)})});Object.keys(r).forEach(e=>t[e]())}getBean(e){return this.lookupBeanInstance("getBean",e,!0)}destroy(){if(this.destroyed)return;this.logger.log(">> Shutting down ag-Application Context");const e=this.getBeanInstances();this.destroyBeans(e),this.contextParams.providedBeanInstances=null,v.__unRegisterGridModules(this.contextParams.gridId),this.destroyed=!0,this.logger.log(">> ag-Application Context shut down - component is dead")}destroyBean(e){e&&this.destroyBeans([e])}destroyBeans(e){return e?(e.forEach(e=>{this.callLifeCycleMethodsOnBean(e,"preDestroyMethods","destroy");const t=e;"function"==typeof t.destroy&&t.destroy()}),[]):[]}isDestroyed(){return this.destroyed}getGridId(){return this.contextParams.gridId}}function Be(e,t,i){const n=We(e.constructor);n.preConstructMethods||(n.preConstructMethods=[]),n.preConstructMethods.push(t)}function r(e,t,i){const n=We(e.constructor);n.postConstructMethods||(n.postConstructMethods=[]),n.postConstructMethods.push(t)}function Ve(e,t,i){const n=We(e.constructor);n.preDestroyMethods||(n.preDestroyMethods=[]),n.preDestroyMethods.push(t)}function o(t){return e=>{We(e).beanName=t}}function s(n){return(e,t,i)=>{je(e,n,!1,e,t,null)}}function c(n){return(e,t,i)=>{je(e,n,!0,e,t,null)}}function je(e,t,i,n,r,o){if(null===t)return void console.error("AG Grid: Autowired name should not be null");if("number"==typeof o)return void console.error("AG Grid: Autowired should be on an attribute");const s=We(e.constructor);s.agClassAttributes||(s.agClassAttributes=[]),s.agClassAttributes.push({attributeName:r,beanName:t,optional:i})}function ze(o){return(e,t,i)=>{const n="function"==typeof e?e:e.constructor;let r;if("number"==typeof i){let e;t?(r=We(n),e=t):(r=We(n),e="agConstructor"),r.autowireMethods||(r.autowireMethods={}),r.autowireMethods[e]||(r.autowireMethods[e]={}),r.autowireMethods[e][i]=o}}}function We(e){return e.hasOwnProperty("__agBeanMetaData")||(e.__agBeanMetaData={}),e.__agBeanMetaData}var Ue=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Ye=function(i,n){return function(e,t){n(e,t,i)}};let qe=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setBeans(e,t,i,n=null){if(this.frameworkOverrides=i,this.gridOptionsService=t,n){const e=t.useAsyncEvents();this.addGlobalListener(n,e)}}getListeners(e,t,i){const n=t?this.allAsyncListeners:this.allSyncListeners;let r=n.get(e);return!r&&i&&(r=new Set,n.set(e,r)),r}noRegisteredListenersExist(){return 0===this.allSyncListeners.size&&0===this.allAsyncListeners.size&&0===this.globalSyncListeners.size&&0===this.globalAsyncListeners.size}addEventListener(e,t,i=!1){this.getListeners(e,i,!0).add(t)}removeEventListener(e,t,i=!1){const n=this.getListeners(e,i,!1);if(n&&(n.delete(t),0===n.size)){(i?this.allAsyncListeners:this.allSyncListeners).delete(e)}}addGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).add(e)}removeGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).delete(e)}dispatchEvent(i){let n=i;if(this.gridOptionsService){const{api:i,columnApi:e,context:t}=this.gridOptionsService;n.api=i,n.columnApi=e,n.context=t}this.dispatchToListeners(n,!0),this.dispatchToListeners(n,!1),this.firedEvents[n.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(t,i){const n=t.type;if(i&&"event"in t){const i=t.event;i instanceof Event&&(t.eventPath=i.composedPath())}const e=e=>e.forEach(e=>{i?this.dispatchAsync(()=>e(t)):e(t)}),r=new Set(this.getListeners(n,i,!1));r&&e(r);new Set(i?this.globalAsyncListeners:this.globalSyncListeners).forEach(e=>{i?this.dispatchAsync(()=>this.frameworkOverrides.dispatchEvent(n,()=>e(n,t),!0)):this.frameworkOverrides.dispatchEvent(n,()=>e(n,t),!0)})}dispatchAsync(e){this.asyncFunctionsQueue.push(e),this.scheduled||(window.setTimeout(this.flushAsyncQueue.bind(this),0),this.scheduled=!0)}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach(e=>e())}};Ue([Ye(0,ze("loggerFactory")),Ye(1,ze("gridOptionsService")),Ye(2,ze("frameworkOverrides")),Ye(3,ze("globalEventListener"))],qe.prototype,"setBeans",null),qe=Ue([o("eventService")],qe);var Ke=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Xe=0;function Ze(){return Xe++}class d{constructor(e,t,i,n){this.instanceId=Ze(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.filterActive=!1,this.eventService=new qe,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=e,this.userProvidedColDef=t,this.colId=i,this.primary=n,this.setState(e)}getInstanceId(){return this.instanceId}setState(e){void 0!==e.sort?"asc"!==e.sort&&"desc"!==e.sort||(this.sort=e.sort):"asc"!==e.initialSort&&"desc"!==e.initialSort||(this.sort=e.initialSort);const t=ie(e.sortIndex),i=ie(e.initialSortIndex);void 0!==t?null!==t&&(this.sortIndex=t):null!==i&&(this.sortIndex=i);const n=ne(e.hide),r=ne(e.initialHide);this.visible=void 0!==n?!n:!r,void 0!==e.pinned?this.setPinned(e.pinned):this.setPinned(e.initialPinned);const o=ie(e.flex),s=ie(e.initialFlex);void 0!==o?this.flex=o:void 0!==s&&(this.flex=s)}setColDef(e,t){this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.eventService.dispatchEvent(this.createColumnEvent("colDefChanged","api"))}getUserProvidedColDef(){return this.userProvidedColDef}setParent(e){this.parent=e}getParent(){return this.parent}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}initialise(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.validate()}initDotNotation(){const e=this.gridOptionsService.is("suppressFieldDotNotation");this.fieldContainsDots=C(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!e,this.tooltipFieldContainsDots=C(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!e}initMinAndMaxWidths(){const e=this.colDef;this.minWidth=this.columnUtils.calculateColMinWidth(e),this.maxWidth=this.columnUtils.calculateColMaxWidth(e)}initTooltip(){this.tooltipEnabled=C(this.colDef.tooltipField)||C(this.colDef.tooltipValueGetter)||C(this.colDef.tooltipComponent)}resetActualWidth(e="api"){const t=this.columnUtils.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){if(u(this.colDef)||u(this.colDef.showRowGroup))return!1;const t=!0===this.colDef.showRowGroup,i=this.colDef.showRowGroup===e;return t||i}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}validate(){const n=this.colDef;function r(e,t,i){l(()=>{i?console.warn(e,i):l(()=>console.warn(e),t)},t)}if(this.gridOptionsService.isRowModelType("clientSide")&&!v.__isRegistered(m.RowGroupingModule,this.gridOptionsService.getGridId())){const r=["enableRowGroup","rowGroup","rowGroupIndex","enablePivot","enableValue","pivot","pivotIndex","aggFunc"].filter(e=>C(n[e]));r.length>0&&v.__assertRegistered(m.RowGroupingModule,r.map(e=>"colDef."+e).join(", "),this.gridOptionsService.getGridId())}if("agRichSelect"!==this.colDef.cellEditor&&"agRichSelectCellEditor"!==this.colDef.cellEditor||v.__assertRegistered(m.RichSelectModule,this.colDef.cellEditor,this.gridOptionsService.getGridId()),this.gridOptionsService.isTreeData()){const e=["rowGroup","rowGroupIndex","pivot","pivotIndex"].filter(e=>C(n[e]));e.length>0&&r(`AG Grid: ${e.join()} is not possible when doing tree data, your column definition should not have ${e.join()}`,"TreeDataCannotRowGroup")}if(C(n.menuTabs))if(Array.isArray(n.menuTabs)){const t=["filterMenuTab"],i=["columnsMenuTab","generalMenuTab"],e=i.filter(e=>n.menuTabs.includes(e));e.length>0&&v.__assertRegistered(m.MenuModule,"menuTab(s): "+e.map(e=>`'${e}'`).join(),this.gridOptionsService.getGridId()),n.menuTabs.forEach(e=>{i.includes(e)||t.includes(e)||r(`AG Grid: '${e}' is not valid for 'colDef.menuTabs'. Valid values are: ${[...t,...i].map(e=>`'${e}'`).join()}.`,"wrongValue_menuTabs_"+e)})}else r("AG Grid: The typeof 'colDef.menuTabs' should be an array not:"+typeof n.menuTabs,"wrongType_menuTabs");C(n.columnsMenuParams)&&v.__assertRegistered(m.MenuModule,"columnsMenuParams",this.gridOptionsService.getGridId()),C(n.columnsMenuParams)&&v.__assertRegistered(m.ColumnsToolPanelModule,"columnsMenuParams",this.gridOptionsService.getGridId()),C(this.colDef.width)&&"number"!=typeof this.colDef.width&&r("AG Grid: colDef.width should be a number, not "+typeof this.colDef.width,"ColumnCheck"),C(n.columnGroupShow)&&"closed"!==n.columnGroupShow&&"open"!==n.columnGroupShow&&r(`AG Grid: '${n.columnGroupShow}' is not valid for columnGroupShow. Valid values are 'open', 'closed', undefined, null`,"columnGroupShow_invalid")}addEventListener(e,t){this.eventService.addEventListener(e,t)}removeEventListener(e,t){this.eventService.removeEventListener(e,t)}createColumnFunctionCallbackParams(e){return{node:e,data:e.data,column:this,colDef:this.colDef,context:this.gridOptionsService.context,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi}}isSuppressNavigable(t){if("boolean"==typeof this.colDef.suppressNavigable)return this.colDef.suppressNavigable;if("function"==typeof this.colDef.suppressNavigable){const e=this.createColumnFunctionCallbackParams(t);return(0,this.colDef.suppressNavigable)(e)}return!1}isCellEditable(e){return!(e.group&&!this.gridOptionsService.is("enableGroupEdit"))&&this.isColumnFunc(e,this.colDef.editable)}isSuppressFillHandle(){return!!ne(this.colDef.suppressFillHandle)}isAutoHeight(){return!!ne(this.colDef.autoHeight)}isAutoHeaderHeight(){return!!ne(this.colDef.autoHeaderHeight)}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){return this.isColumnFunc(e,this.colDef.checkboxSelection)}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?this.colDef.suppressPaste:null)}isResizable(){return!!ne(this.colDef.resizable)}isColumnFunc(e,t){if("boolean"==typeof t)return t;if("function"==typeof t){return t(this.createColumnFunctionCallbackParams(e))}return!1}setMoving(e,t="api"){this.moving=e,this.eventService.dispatchEvent(this.createColumnEvent("movingChanged",t))}createColumnEvent(e,t){return{type:e,column:this,columns:[this],source:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}}isMoving(){return this.moving}getSort(){return this.sort}setSort(e,t="api"){this.sort!==e&&(this.sort=e,this.eventService.dispatchEvent(this.createColumnEvent("sortChanged",t))),this.dispatchStateUpdatedEvent("sort")}setMenuVisible(e,t="api"){this.menuVisible!==e&&(this.menuVisible=e,this.eventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",t)))}isMenuVisible(){return this.menuVisible}isSortAscending(){return"asc"===this.sort}isSortDescending(){return"desc"===this.sort}isSortNone(){return u(this.sort)}isSorting(){return C(this.sort)}getSortIndex(){return this.sortIndex}setSortIndex(e){this.sortIndex=e,this.dispatchStateUpdatedEvent("sortIndex")}setAggFunc(e){this.aggFunc=e,this.dispatchStateUpdatedEvent("aggFunc")}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t="api"){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.eventService.dispatchEvent(this.createColumnEvent("leftChanged",t)))}isFilterActive(){return this.filterActive}setFilterActive(e,t="api",i){this.filterActive!==e&&(this.filterActive=e,this.eventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",t)));const n=this.createColumnEvent("filterChanged",t);i&&be(n,i),this.eventService.dispatchEvent(n)}isHovered(){return this.columnHoverService.isHovered(this)}setPinned(e){this.pinned=!0===e||"left"===e?"left":"right"===e?"right":null,this.dispatchStateUpdatedEvent("pinned")}setFirstRightPinned(e,t="api"){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.eventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",t)))}setLastLeftPinned(e,t="api"){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.eventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",t)))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return"left"===this.pinned||"right"===this.pinned}isPinnedLeft(){return"left"===this.pinned}isPinnedRight(){return"right"===this.pinned}getPinned(){return this.pinned}setVisible(e,t="api"){const i=!0===e;this.visible!==i&&(this.visible=i,this.eventService.dispatchEvent(this.createColumnEvent("visibleChanged",t))),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){const e=this.getColDef();return!e.suppressSpanHeaderHeight&&!e.autoHeaderHeight}getColDef(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getDefinition(){return this.colDef}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return{node:e,data:e.data,colDef:this.colDef,column:this,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}}getColSpan(e){if(u(this.colDef.colSpan))return 1;const t=this.createBaseColDefParams(e),i=this.colDef.colSpan(t);return Math.max(i,1)}getRowSpan(e){if(u(this.colDef.rowSpan))return 1;const t=this.createBaseColDefParams(e),i=this.colDef.rowSpan(t);return Math.max(i,1)}setActualWidth(e,t="api",i=!1){null!=this.minWidth&&(e=Math.max(e,this.minWidth)),null!=this.maxWidth&&(e=Math.min(e,this.maxWidth)),this.actualWidth!==e&&(this.actualWidth=e,this.flex&&"flex"!==t&&"gridInitializing"!==t&&(this.flex=null),i||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.eventService.dispatchEvent(this.createColumnEvent("widthChanged",e))}isGreaterThanMax(e){return null!=this.maxWidth&&e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex||0}setFlex(e){this.flex!==e&&(this.flex=e),this.dispatchStateUpdatedEvent("flex")}setMinimum(e="api"){C(this.minWidth)&&this.setActualWidth(this.minWidth,e)}setRowGroupActive(e,t="api"){this.rowGroupActive!==e&&(this.rowGroupActive=e,this.eventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",t))),this.dispatchStateUpdatedEvent("rowGroup")}isRowGroupActive(){return this.rowGroupActive}setPivotActive(e,t="api"){this.pivotActive!==e&&(this.pivotActive=e,this.eventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",t))),this.dispatchStateUpdatedEvent("pivot")}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}setValueActive(e,t="api"){this.aggregationActive!==e&&(this.aggregationActive=e,this.eventService.dispatchEvent(this.createColumnEvent("columnValueChanged",t)))}isValueActive(){return this.aggregationActive}isAllowPivot(){return!0===this.colDef.enablePivot}isAllowValue(){return!0===this.colDef.enableValue}isAllowRowGroup(){return!0===this.colDef.enableRowGroup}getMenuTabs(e){let t=this.getColDef().menuTabs;return null==t&&(t=e),t}dispatchStateUpdatedEvent(e){this.eventService.dispatchEvent({type:d.EVENT_STATE_UPDATED,key:e})}}d.EVENT_MOVING_CHANGED="movingChanged",d.EVENT_LEFT_CHANGED="leftChanged",d.EVENT_WIDTH_CHANGED="widthChanged",d.EVENT_LAST_LEFT_PINNED_CHANGED="lastLeftPinnedChanged",d.EVENT_FIRST_RIGHT_PINNED_CHANGED="firstRightPinnedChanged",d.EVENT_VISIBLE_CHANGED="visibleChanged",d.EVENT_FILTER_CHANGED="filterChanged",d.EVENT_FILTER_ACTIVE_CHANGED="filterActiveChanged",d.EVENT_SORT_CHANGED="sortChanged",d.EVENT_COL_DEF_CHANGED="colDefChanged",d.EVENT_MENU_VISIBLE_CHANGED="menuVisibleChanged",d.EVENT_ROW_GROUP_CHANGED="columnRowGroupChanged",d.EVENT_PIVOT_CHANGED="columnPivotChanged",d.EVENT_VALUE_CHANGED="columnValueChanged",d.EVENT_STATE_UPDATED="columnStateUpdated",Ke([s("gridOptionsService")],d.prototype,"gridOptionsService",void 0),Ke([s("columnUtils")],d.prototype,"columnUtils",void 0),Ke([s("columnHoverService")],d.prototype,"columnHoverService",void 0),Ke([r],d.prototype,"initialise",null);var Qe=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class h{constructor(e,t,i,n){this.localEventService=new qe,this.expandable=!1,this.instanceId=Ze(),this.expandableListenerRemoveCallback=null,this.colGroupDef=e,this.groupId=t,this.expanded=!!e&&!!e.openByDefault,this.padding=i,this.level=n}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0)}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return!!this.children&&this.children.some(e=>e.isVisible())}isPadding(){return this.padding}setExpanded(e){this.expanded=void 0!==e&&e;const t={type:h.EVENT_EXPANDED_CHANGED};this.localEventService.dispatchEvent(t)}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}addLeafColumns(t){this.children&&this.children.forEach(e=>{e instanceof d?t.push(e):e instanceof h&&e.addLeafColumns(t)})}getColumnGroupShow(){const e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const t=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach(e=>e.addEventListener("visibleChanged",t)),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach(e=>e.removeEventListener("visibleChanged",t)),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let n=!1,r=!1,o=!1;const s=this.findChildrenRemovingPadding();for(let i=0,e=s.length;i<e;i++){const e=s[i];if(!e.isVisible())continue;const t=e.getColumnGroupShow();"open"===t?(n=!0,o=!0):"closed"===t?(r=!0,o=!0):(n=!0,r=!0)}const e=n&&r&&o;if(this.expandable!==e){this.expandable=e;const n={type:h.EVENT_EXPANDABLE_CHANGED};this.localEventService.dispatchEvent(n)}}findChildrenRemovingPadding(){const t=[],i=e=>{e.forEach(e=>{e instanceof h&&e.isPadding()?i(e.children):t.push(e)})};return i(this.children),t}onColumnVisibilityChanged(){this.setExpandable()}addEventListener(e,t){this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService.removeEventListener(e,t)}}h.EVENT_EXPANDED_CHANGED="expandedChanged",h.EVENT_EXPANDABLE_CHANGED="expandableChanged",Qe([Ve],h.prototype,"destroy",null);const Je={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function et(...i){for(let t=0;t<i.length;t++){const e=i[t];if(C(e))return e}return null}function tt(e){return null!=e&&e.length>0}function f(e){if(e&&e.length)return e[e.length-1]}function it(e,i,n){return null==e&&null==i||null!=e&&null!=i&&e.length===i.length&&e.every((e,t)=>n?n(e,i[t]):i[t]===e)}function nt(e,t){return it(e,t)}function rt(e){return e.sort((e,t)=>e-t)}function ot(n,r){if(n)for(let i=n.length-2;i>=0;i--){const e=n[i]===r,t=n[i+1]===r;e&&t&&n.splice(i+1,1)}}function st(e,t){const i=e.indexOf(t);i>=0&&e.splice(i,1)}function at(t,e){e.forEach(e=>st(t,e))}function lt(e,t,i){e.splice(i,0,t)}function ct(t,i,n){if(null!=t&&null!=i)for(let e=i.length-1;e>=0;e--){lt(t,i[e],n)}}function ut(t,e,i){at(t,e),e.slice().reverse().forEach(e=>lt(t,e,i))}function dt(e,t){return e.indexOf(t)>-1}function ht(e){return[].concat.apply([],e)}function ft(t,e){null!=e&&null!=t&&e.forEach(e=>t.push(e))}function pt(e){return e.map(te)}function gt(t,i){if(null!=t)for(let e=t.length-1;e>=0;e--)i(t[e],e)}const mt=["touchstart","touchend","touchmove","touchcancel","scroll"],vt={};function yt(e){e.__ag_Grid_Stop_Propagation=!0}function bt(e){return!0===e.__ag_Grid_Stop_Propagation}const _t=(()=>{const i={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return e=>{if("boolean"==typeof vt[e])return vt[e];const t=document.createElement(i[e]||"div");return vt[e="on"+e]=e in t}})();function wt(e,t,i){let n=t;for(;n;){const t=e.getDomData(n,i);if(t)return t;n=n.parentElement}return null}function Ct(e,t){return!(!t||!e)&&St(t).indexOf(e)>=0}function xt(e){const t=[];let i=e.target;for(;i;)t.push(i),i=i.parentElement;return t}function St(e){const t=e;return t.path?t.path:t.composedPath?t.composedPath():xt(t)}function At(e,t,i,n){const r=dt(mt,i)?{passive:!0}:void 0;e&&e.addEventListener&&e.addEventListener(t,i,n,r)}var Et=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class p{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.isAlive=()=>!this.destroyed}getFrameworkOverrides(){return this.frameworkOverrides}getContext(){return this.context}destroy(){this.destroyFunctions.forEach(e=>e()),this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchEvent({type:p.EVENT_DESTROYED})}addEventListener(e,t){this.localEventService||(this.localEventService=new qe),this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService&&this.localEventService.removeEventListener(e,t)}dispatchEventAsync(e){window.setTimeout(()=>this.dispatchEvent(e),0)}dispatchEvent(e){this.localEventService&&this.localEventService.dispatchEvent(e)}addManagedListener(e,t,i){if(this.destroyed)return;e instanceof HTMLElement?At(this.getFrameworkOverrides(),e,t,i):e.addEventListener(t,i);const n=()=>(e.removeEventListener(t,i),this.destroyFunctions=this.destroyFunctions.filter(e=>e!==n),null);return this.destroyFunctions.push(n),n}addManagedPropertyListener(e,t){if(this.destroyed)return;this.gridOptionsService.addEventListener(e,t);const i=()=>(this.gridOptionsService.removeEventListener(e,t),this.destroyFunctions=this.destroyFunctions.filter(e=>e!==i),null);return this.destroyFunctions.push(i),i}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createManagedBean(e,t){const i=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),i}createBean(e,t,i){return(t||this.getContext()).createBean(e,i)}destroyBean(e,t){return(t||this.getContext()).destroyBean(e)}destroyBeans(e,t){return e&&e.forEach(e=>this.destroyBean(e,t)),[]}}p.EVENT_DESTROYED="destroyed",Et([s("frameworkOverrides")],p.prototype,"frameworkOverrides",void 0),Et([s("context")],p.prototype,"context",void 0),Et([s("eventService")],p.prototype,"eventService",void 0),Et([s("gridOptionsService")],p.prototype,"gridOptionsService",void 0),Et([s("localeService")],p.prototype,"localeService",void 0),Et([s("environment")],p.prototype,"environment",void 0),Et([Ve],p.prototype,"destroy",null);var Tt=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Dt=function(i,n){return function(e,t){n(e,t,i)}};let Rt=class extends p{setBeans(e){this.logger=e.create("ColumnFactory")}createColumnTree(e,t,i){const n=new ce,{existingCols:r,existingGroups:o,existingColKeys:s}=this.extractExistingTreeData(i);n.addExistingKeys(s);const a=this.recursivelyCreateColumns(e,0,t,r,n,o),l=this.findMaxDept(a,0);this.logger.log("Number of levels for grouped columns is "+l);const c=this.balanceColumnTree(a,0,l,n);return this.columnUtils.depthFirstOriginalTreeSearch(null,c,(e,t)=>{e instanceof h&&e.setupExpandable(),e.setOriginalParent(t)}),{columnTree:c,treeDept:l}}extractExistingTreeData(e){const t=[],i=[],n=[];return e&&this.columnUtils.depthFirstOriginalTreeSearch(null,e,e=>{if(e instanceof h){const t=e;i.push(t)}else{const i=e;n.push(i.getId()),t.push(i)}}),{existingCols:t,existingGroups:i,existingColKeys:n}}createForAutoGroups(e,t){return e.map(e=>this.createAutoGroupTreeItem(t,e))}createAutoGroupTreeItem(t,i){let n=i;for(let e=this.findDepth(t)-1;e>=0;e--){const t=new h(null,`FAKE_PATH_${i.getId()}}_${e}`,!0,e);this.createBean(t),t.setChildren([n]),n.setOriginalParent(t),n=t}return n}findDepth(e){let t=0,i=e;for(;i&&i[0]&&i[0]instanceof h;)t++,i=i[0].getChildren();return t}balanceColumnTree(r,o,s,a){const l=[];for(let e=0;e<r.length;e++){const n=r[e];if(n instanceof h){const r=n,e=this.balanceColumnTree(r.getChildren(),o+1,s,a);r.setChildren(e),l.push(r)}else{let t,i;for(let e=s-1;e>=o;e--){const r=a.getUniqueKey(null,null),s=this.createMergedColGroupDef(null),l=new h(s,r,!0,o);this.createBean(l),i&&i.setChildren([l]),i=l,t||(t=i)}if(t&&i){l.push(t);if(r.some(e=>e instanceof h)){i.setChildren([n]);continue}i.setChildren(r);break}l.push(n)}}return l}findMaxDept(i,n){let r=n;for(let e=0;e<i.length;e++){const t=i[e];if(t instanceof h){const i=t,e=this.findMaxDept(i.getChildren(),n+1);r<e&&(r=e)}}return r}recursivelyCreateColumns(e,t,i,n,r,o){return(e||[]).map(e=>this.isColumnGroup(e)?this.createColumnGroup(i,e,t,n,r,o):this.createColumn(i,e,n,r))}createColumnGroup(e,t,i,n,r,o){const s=this.createMergedColGroupDef(t),a=r.getUniqueKey(s.groupId||null,null),l=new h(s,a,!1,i);this.createBean(l);const c=this.findExistingGroup(t,o);c&&st(o,c),c&&c.isExpanded()&&l.setExpanded(!0);const u=this.recursivelyCreateColumns(s.children,i+1,e,n,r,o);return l.setChildren(u),l}createMergedColGroupDef(e){const t={};return Object.assign(t,this.gridOptionsService.get("defaultColGroupDef")),Object.assign(t,e),t}createColumn(t,i,n,r){let o=this.findExistingColumn(i,n);if(n&&o&&st(n,o),o){const t=this.mergeColDefs(i,o.getColId());o.setColDef(t,i),this.applyColumnState(o,t)}else{const n=r.getUniqueKey(i.colId,i.field),e=this.mergeColDefs(i,n);o=new d(e,i,n,t),this.context.createBean(o)}return this.dataTypeService.addColumnListeners(o),o}applyColumnState(e,t){const i=ie(t.flex);void 0!==i&&e.setFlex(i);if(e.getFlex()<=0){const i=ie(t.width);if(null!=i)e.setActualWidth(i);else{const t=e.getActualWidth();e.setActualWidth(t)}}void 0!==t.sort&&("asc"==t.sort||"desc"==t.sort?e.setSort(t.sort):e.setSort(void 0));const n=ie(t.sortIndex);void 0!==n&&e.setSortIndex(n);const r=ne(t.hide);void 0!==r&&e.setVisible(!r),void 0!==t.pinned&&e.setPinned(t.pinned)}findExistingColumn(r,e){return(e||[]).find(e=>{const t=e.getUserProvidedColDef();if(!t)return!1;const i=null!=r.colId,n=null!=r.field;return i?e.getId()===r.colId:n?t.field===r.field:t===r})}findExistingGroup(t,e){return e.find(e=>{if(!e.getColGroupDef())return!1;return!(null==t.groupId)&&e.getId()===t.groupId})}mergeColDefs(e,t){const i={};be(i,this.gridOptionsService.get("defaultColDef"),!1,!0);const n=this.dataTypeService.updateColDefAndGetColumnType(i,e,t);n&&this.assignColumnTypes(n,i),be(i,e,!1,!0);const r=this.gridOptionsService.get("autoGroupColumnDef"),o=this.gridOptionsService.isColumnsSortingCoupledToGroup();return e.rowGroup&&r&&o&&be(i,{sort:r.sort,initialSort:r.initialSort},!1,!0),this.dataTypeService.validateColDef(i),i}assignColumnTypes(e,i){if(!e.length)return;const n=Object.assign({},Je);a(this.gridOptionsService.get("columnTypes")||{},(e,t)=>{e in n?console.warn(`AG Grid: the column type '${e}' is a default column type and cannot be overridden.`):n[e]=t}),e.forEach(e=>{const t=n[e.trim()];t?be(i,t,!1,!0):console.warn("AG Grid: colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes")})}isColumnGroup(e){return void 0!==e.children}};Tt([s("columnUtils")],Rt.prototype,"columnUtils",void 0),Tt([s("dataTypeService")],Rt.prototype,"dataTypeService",void 0),Tt([Dt(0,ze("loggerFactory"))],Rt.prototype,"setBeans",null),Rt=Tt([o("columnFactory")],Rt);var Mt=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class g{constructor(e,t,i,n){this.displayedChildren=[],this.localEventService=new qe,this.groupId=t,this.partId=i,this.providedColumnGroup=e,this.pinned=n}static createUniqueId(e,t){return e+"_"+t}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}setParent(e){this.parent=e}getUniqueId(){return g.createUniqueId(this.groupId,this.partId)}isEmptyGroup(){return 0===this.displayedChildren.length}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!(!e||0===e.length)&&e.every(e=>e.isMoving())}checkLeft(){if(this.displayedChildren.forEach(e=>{e instanceof g&&e.checkLeft()}),this.displayedChildren.length>0)if(this.gridOptionsService.is("enableRtl")){const e=f(this.displayedChildren).getLeft();this.setLeft(e)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=e,this.left!==e&&(this.left=e,this.localEventService.dispatchEvent(this.createAgEvent(g.EVENT_LEFT_CHANGED)))}getPinned(){return this.pinned}createAgEvent(e){return{type:e}}addEventListener(e,t){this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService.removeEventListener(e,t)}getGroupId(){return this.groupId}getPartId(){return this.partId}isChildInThisGroupDeepSearch(t){let i=!1;return this.children.forEach(e=>{t===e&&(i=!0),e instanceof g&&e.isChildInThisGroupDeepSearch(t)&&(i=!0)}),i}getActualWidth(){let t=0;return this.displayedChildren&&this.displayedChildren.forEach(e=>{t+=e.getActualWidth()}),t}isResizable(){if(!this.displayedChildren)return!1;let t=!1;return this.displayedChildren.forEach(e=>{e.isResizable()&&(t=!0)}),t}getMinWidth(){let t=0;return this.displayedChildren.forEach(e=>{t+=e.getMinWidth()||0}),t}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}addDisplayedLeafColumns(t){this.displayedChildren.forEach(e=>{e instanceof d?t.push(e):e instanceof g&&e.addDisplayedLeafColumns(t)})}addLeafColumns(t){this.children.forEach(e=>{e instanceof d?t.push(e):e instanceof g&&e.addLeafColumns(t)})}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return this.isPadding()&&e&&e.isPadding()?1+e.getPaddingLevel():0}calculateDisplayedColumns(){this.displayedChildren=[];let t=this;for(;null!=t&&t.isPadding();)t=t.getParent();if(!(!!t&&t.providedColumnGroup.isExpandable()))return this.displayedChildren=this.children,void this.localEventService.dispatchEvent(this.createAgEvent(g.EVENT_DISPLAYED_CHILDREN_CHANGED));this.children.forEach(e=>{if(e instanceof g&&(!e.displayedChildren||!e.displayedChildren.length))return;switch(e.getColumnGroupShow()){case"open":t.providedColumnGroup.isExpanded()&&this.displayedChildren.push(e);break;case"closed":t.providedColumnGroup.isExpanded()||this.displayedChildren.push(e);break;default:this.displayedChildren.push(e)}}),this.localEventService.dispatchEvent(this.createAgEvent(g.EVENT_DISPLAYED_CHILDREN_CHANGED))}}g.EVENT_LEFT_CHANGED="leftChanged",g.EVENT_DISPLAYED_CHILDREN_CHANGED="displayedChildrenChanged",Mt([s("gridOptionsService")],g.prototype,"gridOptionsService",void 0);class y{}y.EVENT_COLUMN_EVERYTHING_CHANGED="columnEverythingChanged",y.EVENT_NEW_COLUMNS_LOADED="newColumnsLoaded",y.EVENT_COLUMN_PIVOT_MODE_CHANGED="columnPivotModeChanged",y.EVENT_COLUMN_ROW_GROUP_CHANGED="columnRowGroupChanged",y.EVENT_EXPAND_COLLAPSE_ALL="expandOrCollapseAll",y.EVENT_COLUMN_PIVOT_CHANGED="columnPivotChanged",y.EVENT_GRID_COLUMNS_CHANGED="gridColumnsChanged",y.EVENT_COLUMN_VALUE_CHANGED="columnValueChanged",y.EVENT_COLUMN_MOVED="columnMoved",y.EVENT_COLUMN_VISIBLE="columnVisible",y.EVENT_COLUMN_PINNED="columnPinned",y.EVENT_COLUMN_GROUP_OPENED="columnGroupOpened",y.EVENT_COLUMN_RESIZED="columnResized",y.EVENT_DISPLAYED_COLUMNS_CHANGED="displayedColumnsChanged",y.EVENT_VIRTUAL_COLUMNS_CHANGED="virtualColumnsChanged",y.EVENT_ASYNC_TRANSACTIONS_FLUSHED="asyncTransactionsFlushed",y.EVENT_ROW_GROUP_OPENED="rowGroupOpened",y.EVENT_ROW_DATA_CHANGED="rowDataChanged",y.EVENT_ROW_DATA_UPDATED="rowDataUpdated",y.EVENT_PINNED_ROW_DATA_CHANGED="pinnedRowDataChanged",y.EVENT_RANGE_SELECTION_CHANGED="rangeSelectionChanged",y.EVENT_CHART_CREATED="chartCreated",y.EVENT_CHART_RANGE_SELECTION_CHANGED="chartRangeSelectionChanged",y.EVENT_CHART_OPTIONS_CHANGED="chartOptionsChanged",y.EVENT_CHART_DESTROYED="chartDestroyed",y.EVENT_TOOL_PANEL_VISIBLE_CHANGED="toolPanelVisibleChanged",y.EVENT_TOOL_PANEL_SIZE_CHANGED="toolPanelSizeChanged",y.EVENT_COLUMN_PANEL_ITEM_DRAG_START="columnPanelItemDragStart",y.EVENT_COLUMN_PANEL_ITEM_DRAG_END="columnPanelItemDragEnd",y.EVENT_MODEL_UPDATED="modelUpdated",y.EVENT_CUT_START="cutStart",y.EVENT_CUT_END="cutEnd",y.EVENT_PASTE_START="pasteStart",y.EVENT_PASTE_END="pasteEnd",y.EVENT_FILL_START="fillStart",y.EVENT_FILL_END="fillEnd",y.EVENT_RANGE_DELETE_START="rangeDeleteStart",y.EVENT_RANGE_DELETE_END="rangeDeleteEnd",y.EVENT_UNDO_STARTED="undoStarted",y.EVENT_UNDO_ENDED="undoEnded",y.EVENT_REDO_STARTED="redoStarted",y.EVENT_REDO_ENDED="redoEnded",y.EVENT_KEY_SHORTCUT_CHANGED_CELL_START="keyShortcutChangedCellStart",y.EVENT_KEY_SHORTCUT_CHANGED_CELL_END="keyShortcutChangedCellEnd",y.EVENT_CELL_CLICKED="cellClicked",y.EVENT_CELL_DOUBLE_CLICKED="cellDoubleClicked",y.EVENT_CELL_MOUSE_DOWN="cellMouseDown",y.EVENT_CELL_CONTEXT_MENU="cellContextMenu",y.EVENT_CELL_VALUE_CHANGED="cellValueChanged",y.EVENT_CELL_EDIT_REQUEST="cellEditRequest",y.EVENT_ROW_VALUE_CHANGED="rowValueChanged",y.EVENT_CELL_FOCUSED="cellFocused",y.EVENT_CELL_FOCUS_CLEARED="cellFocusCleared",y.EVENT_FULL_WIDTH_ROW_FOCUSED="fullWidthRowFocused",y.EVENT_ROW_SELECTED="rowSelected",y.EVENT_SELECTION_CHANGED="selectionChanged",y.EVENT_CELL_KEY_DOWN="cellKeyDown",y.EVENT_CELL_MOUSE_OVER="cellMouseOver",y.EVENT_CELL_MOUSE_OUT="cellMouseOut",y.EVENT_FILTER_CHANGED="filterChanged",y.EVENT_FILTER_MODIFIED="filterModified",y.EVENT_FILTER_OPENED="filterOpened",y.EVENT_SORT_CHANGED="sortChanged",y.EVENT_VIRTUAL_ROW_REMOVED="virtualRowRemoved",y.EVENT_ROW_CLICKED="rowClicked",y.EVENT_ROW_DOUBLE_CLICKED="rowDoubleClicked",y.EVENT_GRID_READY="gridReady",y.EVENT_GRID_SIZE_CHANGED="gridSizeChanged",y.EVENT_VIEWPORT_CHANGED="viewportChanged",y.EVENT_SCROLLBAR_WIDTH_CHANGED="scrollbarWidthChanged",y.EVENT_FIRST_DATA_RENDERED="firstDataRendered",y.EVENT_DRAG_STARTED="dragStarted",y.EVENT_DRAG_STOPPED="dragStopped",y.EVENT_CHECKBOX_CHANGED="checkboxChanged",y.EVENT_ROW_EDITING_STARTED="rowEditingStarted",y.EVENT_ROW_EDITING_STOPPED="rowEditingStopped",y.EVENT_CELL_EDITING_STARTED="cellEditingStarted",y.EVENT_CELL_EDITING_STOPPED="cellEditingStopped",y.EVENT_BODY_SCROLL="bodyScroll",y.EVENT_BODY_SCROLL_END="bodyScrollEnd",y.EVENT_HEIGHT_SCALE_CHANGED="heightScaleChanged",y.EVENT_PAGINATION_CHANGED="paginationChanged",y.EVENT_COMPONENT_STATE_CHANGED="componentStateChanged",y.EVENT_STORE_REFRESHED="storeRefreshed",y.EVENT_BODY_HEIGHT_CHANGED="bodyHeightChanged",y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED="displayedColumnsWidthChanged",y.EVENT_SCROLL_VISIBILITY_CHANGED="scrollVisibilityChanged",y.EVENT_COLUMN_HOVER_CHANGED="columnHoverChanged",y.EVENT_FLASH_CELLS="flashCells",y.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED="paginationPixelOffsetChanged",y.EVENT_DISPLAYED_ROWS_CHANGED="displayedRowsChanged",y.EVENT_LEFT_PINNED_WIDTH_CHANGED="leftPinnedWidthChanged",y.EVENT_RIGHT_PINNED_WIDTH_CHANGED="rightPinnedWidthChanged",y.EVENT_ROW_CONTAINER_HEIGHT_CHANGED="rowContainerHeightChanged",y.EVENT_HEADER_HEIGHT_CHANGED="headerHeightChanged",y.EVENT_COLUMN_HEADER_HEIGHT_CHANGED="columnHeaderHeightChanged",y.EVENT_ROW_DRAG_ENTER="rowDragEnter",y.EVENT_ROW_DRAG_MOVE="rowDragMove",y.EVENT_ROW_DRAG_LEAVE="rowDragLeave",y.EVENT_ROW_DRAG_END="rowDragEnd",y.EVENT_GRID_STYLES_CHANGED="gridStylesChanged",y.EVENT_POPUP_TO_FRONT="popupToFront",y.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST="columnRowGroupChangeRequest",y.EVENT_COLUMN_PIVOT_CHANGE_REQUEST="columnPivotChangeRequest",y.EVENT_COLUMN_VALUE_CHANGE_REQUEST="columnValueChangeRequest",y.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST="columnAggFuncChangeRequest",y.EVENT_KEYBOARD_FOCUS="keyboardFocus",y.EVENT_MOUSE_FOCUS="mouseFocus",y.EVENT_STORE_UPDATED="storeUpdated",y.EVENT_FILTER_DESTROYED="filterDestroyed",y.EVENT_ROW_DATA_UPDATE_STARTED="rowDataUpdateStarted";class kt{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let i;return i="number"!=typeof t?0:t+1,this.existingIds[e]=i,i}}var Ot=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};const Nt="ag-Grid-AutoColumn";let It=class extends p{createAutoGroupColumns(i,e){const n=[],t=this.gridOptionsService.isTreeData();let r=this.gridOptionsService.isGroupMultiAutoColumn();return t&&r&&(console.warn('AG Grid: you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data'),r=!1),r?e.forEach((e,t)=>{n.push(this.createOneAutoGroupColumn(i,e,t))}):n.push(this.createOneAutoGroupColumn(i)),n}createOneAutoGroupColumn(e,t,i){let n,r=this.generateDefaultColDef(t);n=t?`${Nt}-${t.getId()}`:Nt;if(be(r,this.gridOptionsService.get("autoGroupColumnDef")),r=this.columnFactory.mergeColDefs(r,n),r.colId=n,!this.gridOptionsService.isTreeData()){u(r.field)&&u(r.valueGetter)&&u(r.filterValueGetter)&&"agGroupColumnFilter"!==r.filter&&(r.filter=!1)}i&&i>0&&(r.headerCheckboxSelection=!1);const o=e.find(e=>e.getId()==n),s=this.gridOptionsService.isColumnsSortingCoupledToGroup();if(o)return s&&(r.sort=void 0,r.sortIndex=void 0),o.setColDef(r,null),this.columnFactory.applyColumnState(o,r),o;s&&(r.sort||r.initialSort||"sortIndex"in r)&&!r.field&&(r.sort=null,r.sortIndex=null,r.initialSort=null);const a=new d(r,null,n,!0);return this.context.createBean(a),a}generateDefaultColDef(e){const t=this.gridOptionsService.get("autoGroupColumnDef"),i={headerName:this.localeService.getLocaleTextFunc()("group","Group")};if(t&&(t.cellRenderer||t.cellRendererSelector)||(i.cellRenderer="agGroupCellRenderer"),e){const t=e.getColDef();Object.assign(i,{headerName:this.columnModel.getDisplayNameForColumn(e,"header"),headerValueGetter:t.headerValueGetter}),t.cellRenderer&&Object.assign(i,{cellRendererParams:{innerRenderer:t.cellRenderer,innerRendererParams:t.cellRendererParams}}),i.showRowGroup=e.getColId()}else i.showRowGroup=!0;return i}};Ot([s("columnModel")],It.prototype,"columnModel",void 0),Ot([s("columnFactory")],It.prototype,"columnFactory",void 0),It=Ot([o("autoGroupColService")],It);const Lt=/[&<>"']/g,Pt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Ft(e){const i=String.fromCharCode;function n(e,t){return i(e>>t&63|128)}function t(e){if(e>=0&&e<=31&&10!==e){return`_x${e.toString(16).toUpperCase().padStart(4,"0")}_`}if(0==(4294967168&e))return i(e);let t="";return 0==(4294965248&e)?t=i(e>>6&31|192):0==(4294901760&e)?(!function(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}(e),t=i(e>>12&15|224),t+=n(e,6)):0==(4292870144&e)&&(t=i(e>>18&7|240),t+=n(e,12),t+=n(e,6)),t+=i(63&e|128),t}const r=function(e){const t=[];if(!e)return[];const i=e.length;let n,r,o=0;for(;o<i;)n=e.charCodeAt(o++),n>=55296&&n<=56319&&o<i?(r=e.charCodeAt(o++),56320==(64512&r)?t.push(((1023&n)<<10)+(1023&r)+65536):(t.push(n),o--)):t.push(n);return t}(e),o=r.length;let s,a=-1,l="";for(;++a<o;)s=r[a],l+=t(s);return l}function Gt(e){return e[0].toUpperCase()+e.substr(1).toLowerCase()}function $t(e,t){if(null==e)return null;const i=e.toString().toString();return t?i:i.replace(Lt,e=>Pt[e])}function Ht(e){if(!e||null==e)return null;return e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z])([a-z])/g,"$1 $2$3").replace(/\./g," ").split(" ").map(e=>e.substring(0,1).toUpperCase()+(e.length>1?e.substring(1,e.length):"")).join(" ")}function Bt(e){return e.replace(/[A-Z]/g,e=>"-"+e.toLocaleLowerCase())}function Vt(e){const t=new Map;return e.forEach(e=>t.set(e[0],e[1])),t}function jt(e,t){const i=new Map;return e.forEach(e=>i.set(t(e),e)),i}function zt(e){const i=[];return e.forEach((e,t)=>i.push(t)),i}class Wt{}Wt.ColDefPropertyMap={headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnsMenuParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0},Wt.ALL_PROPERTIES=Object.keys(Wt.ColDefPropertyMap);class b{}b.STRING_PROPERTIES=["rowSelection","overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","serverSideStoreType","groupDisplayType","treeDataDisplayType","colResizeDefault"],b.OBJECT_PROPERTIES=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions"],b.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass"],b.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","tabIndex"],b.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHorizontalScroll","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSelectsChildren","groupIncludeFooter","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressParentsInRowNodes","suppressColumnMoveAnimation","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","rememberGroupStateWhenNewData","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressAggAtRootLevel","suppressFocusAfterRefresh","functionsPassive","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","excludeHiddenColumnsFromQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","treeData","masterDetail","suppressMultiRangeSelection","enterMovesDown","enterMovesDownAfterEdit","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","enableChartToolPanelsButton","suppressChartToolPanelsButton","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideFilteringAlwaysResets","serverSideFilterAllLevels","serverSideSortingAlwaysResets","serverSideSortAllLevels","serverSideOnlyRefreshFilteredGroups","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","maintainColumnOrder","groupMaintainOrder","columnHoverHighlight","suppressReactUi","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","suppressCutToClipboard"],b.FUNCTIONAL_PROPERTIES=["doesExternalFilterPass","processSecondaryColDef","processSecondaryColGroupDef","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer"],b.CALLBACK_PROPERTIES=["getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideStoreParams","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","groupAggFiltering"],b.FUNCTION_PROPERTIES=[...b.FUNCTIONAL_PROPERTIES,...b.CALLBACK_PROPERTIES],b.ALL_PROPERTIES=[...b.ARRAY_PROPERTIES,...b.OBJECT_PROPERTIES,...b.STRING_PROPERTIES,...b.NUMBER_PROPERTIES,...b.FUNCTION_PROPERTIES,...b.BOOLEAN_PROPERTIES];class _{static getCallbackForEvent(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substr(1)}static getCoercionLookup(){let t={};return[..._.ARRAY_PROPERTIES,..._.OBJECT_PROPERTIES,..._.STRING_PROPERTIES,..._.FUNCTION_PROPERTIES,..._.EVENT_CALLBACKS].forEach(e=>t[e]="none"),_.BOOLEAN_PROPERTIES.forEach(e=>t[e]="boolean"),_.NUMBER_PROPERTIES.forEach(e=>t[e]="number"),t}static getValue(t,i){const n=_.coercionLookup[t];if(n){let e=i;switch(n){case"number":e=_.toNumber(i);break;case"boolean":e=_.toBoolean(i);break;case"none":"groupAggFiltering"===t&&"function"!=typeof i&&(e=_.toBoolean(i))}return e}}static getGridOptionKeys(e,t){return t?Object.keys(_.coercionLookup):Object.keys(e)}static copyAttributesToGridOptions(e,i,t=!1){"object"!=typeof e&&(e={});const n=e;return _.getGridOptionKeys(i,t).forEach(e=>{const t=i[e];if(void 0!==t){const i=_.getValue(e,t);void 0!==i&&(n[e]=i)}}),e}static processOnChange(e,n){if(!e||0===Object.keys(e).length)return;const r=Object.assign({},e);r.columnTypes&&(n.setColumnTypes(r.columnTypes.currentValue,"gridOptionsChanged"),delete r.columnTypes),r.autoGroupColumnDef&&(n.setAutoGroupColumnDef(r.autoGroupColumnDef.currentValue,"gridOptionsChanged"),delete r.autoGroupColumnDef),r.defaultColDef&&(n.setDefaultColDef(r.defaultColDef.currentValue,"gridOptionsChanged"),delete r.defaultColDef),r.columnDefs&&(n.setColumnDefs(r.columnDefs.currentValue,"gridOptionsChanged"),delete r.columnDefs),Object.keys(r).forEach(e=>{const t=e,i=_.getValue(t,r[t].currentValue);n.__setProperty(t,i)});const i={type:y.EVENT_COMPONENT_STATE_CHANGED};a(e,(e,t)=>{i[e]=t}),n.dispatchEvent(i)}static toBoolean(e){return"boolean"==typeof e?e:"string"==typeof e&&("TRUE"===e.toUpperCase()||""==e)}static toNumber(e){return"number"==typeof e?e:"string"==typeof e?Number(e):void 0}}function Ut(e,i,t){const n={},r=e.filter(t=>!i.some(e=>e===t));return r.length>0&&r.forEach(e=>n[e]=Yt(e,t)),n}function Yt(t,e,i,n){let r=e.map(e=>({value:e,relevance:qt(t.toLowerCase(),e.toLocaleLowerCase())}));if(r.sort((e,t)=>t.relevance-e.relevance),i&&(r=r.filter(e=>0!==e.relevance)),n&&n>0){const t=r[0].relevance*n;r=r.filter(e=>t-e.relevance<0)}return r.map(e=>e.value)}function qt(e,t){const i=e.replace(/\s/g,""),n=t.replace(/\s/g,"");let r=0,o=-1;for(let e=0;e<i.length;e++){const t=n.indexOf(i[e],o+1);-1!==t&&(o=t,r+=100-100*o/1e4*100)}return r}_.EVENTS=le(y),_.EXCLUDED_INTERNAL_EVENTS=[y.EVENT_SCROLLBAR_WIDTH_CHANGED,y.EVENT_CHECKBOX_CHANGED,y.EVENT_HEIGHT_SCALE_CHANGED,y.EVENT_BODY_HEIGHT_CHANGED,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,y.EVENT_SCROLL_VISIBILITY_CHANGED,y.EVENT_COLUMN_HOVER_CHANGED,y.EVENT_FLASH_CELLS,y.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,y.EVENT_DISPLAYED_ROWS_CHANGED,y.EVENT_LEFT_PINNED_WIDTH_CHANGED,y.EVENT_RIGHT_PINNED_WIDTH_CHANGED,y.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,y.EVENT_POPUP_TO_FRONT,y.EVENT_KEYBOARD_FOCUS,y.EVENT_MOUSE_FOCUS,y.EVENT_STORE_UPDATED,y.EVENT_COLUMN_PANEL_ITEM_DRAG_START,y.EVENT_COLUMN_PANEL_ITEM_DRAG_END,y.EVENT_FILL_START,y.EVENT_FILL_END,y.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,y.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,y.EVENT_FULL_WIDTH_ROW_FOCUSED,y.EVENT_HEADER_HEIGHT_CHANGED,y.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,y.EVENT_CELL_FOCUS_CLEARED,y.EVENT_GRID_STYLES_CHANGED,y.EVENT_FILTER_DESTROYED,y.EVENT_ROW_DATA_UPDATE_STARTED],_.PUBLIC_EVENTS=_.EVENTS.filter(e=>!dt(_.EXCLUDED_INTERNAL_EVENTS,e)),_.EVENT_CALLBACKS=_.EVENTS.map(e=>_.getCallbackForEvent(e)),_.STRING_PROPERTIES=b.STRING_PROPERTIES,_.OBJECT_PROPERTIES=b.OBJECT_PROPERTIES,_.ARRAY_PROPERTIES=b.ARRAY_PROPERTIES,_.NUMBER_PROPERTIES=b.NUMBER_PROPERTIES,_.BOOLEAN_PROPERTIES=b.BOOLEAN_PROPERTIES,_.FUNCTION_PROPERTIES=b.FUNCTION_PROPERTIES,_.ALL_PROPERTIES=b.ALL_PROPERTIES,_.ALL_PROPERTIES_SET=new Set(b.ALL_PROPERTIES),_.coercionLookup=_.getCoercionLookup();var Kt=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};function Xt(e,t,i,n){const r=i?`Please use '${i}' instead. `:"";l(()=>console.warn(`AG Grid: since v${e}, '${t}' is deprecated. ${r}${null!=n?n:""}`),"Deprecated_"+t)}const Zt=["__ob__","__v_skip","__metadata__"];let Qt=class{constructor(){this.deprecatedProperties={rememberGroupStateWhenNewData:{version:"24",message:"Now that transaction updates are possible and they keep group state, this feature is no longer needed."},serverSideFilteringAlwaysResets:{version:"28.0",newProp:"serverSideOnlyRefreshFilteredGroups",copyToNewProp:!0},serverSideSortingAlwaysResets:{version:"28.0",newProp:"serverSideSortAllLevels",copyToNewProp:!0},suppressReactUi:{version:"28",message:"The legacy React rendering engine is deprecated and will be removed in the next major version of the grid."},processSecondaryColDef:{version:"28",newProp:"processPivotResultColDef",copyToNewProp:!0},processSecondaryColGroupDef:{version:"28",newProp:"processPivotResultColGroupDef",copyToNewProp:!0},getServerSideStoreParams:{version:"28",newProp:"getServerSideGroupLevelParams",copyToNewProp:!0},serverSideInfiniteScroll:{version:"29",message:"Infinite Scrolling is now the default behaviour. This can be suppressed with `suppressServerSideInfiniteScroll`."},enableChartToolPanelsButton:{version:"29",message:"The Chart Tool Panels button is now enabled by default. To hide the Chart Tool Panels button and display the hamburger button instead, set suppressChartToolPanelsButton=true."},functionsPassive:{version:"29.2"},onColumnRowGroupChangeRequest:{version:"29.2"},onColumnPivotChangeRequest:{version:"29.2"},onColumnValueChangeRequest:{version:"29.2"},onColumnAggFuncChangeRequest:{version:"29.2"},serverSideFilterAllLevels:{version:"30",message:"All server-side group levels are now filtered by default. This can be toggled using `serverSideOnlyRefreshFilteredGroups`."},suppressAggAtRootLevel:{version:"30",message:"The root level aggregation is now suppressed by default. This can be toggled using  `alwaysAggregateAtRootLevel`."},excludeHiddenColumnsFromQuickFilter:{version:"30",message:"Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `includeHiddenColumnsInQuickFilter`."},enterMovesDown:{version:"30",newProp:"enterNavigatesVertically",copyToNewProp:!0},enterMovesDownAfterEdit:{version:"30",newProp:"enterNavigatesVerticallyAfterEdit",copyToNewProp:!0}}}pickOneWarning(e,t){console.warn(`AG Grid: ${e} and ${t} do not work with each other, you need to pick one.`)}init(){if(this.checkForDeprecated(),this.checkForViolations(),!0!==this.gridOptions.suppressPropertyNamesCheck&&(this.checkGridOptionsProperties(),this.checkColumnDefProperties()),this.checkColumnDefViolations(),this.gridOptionsService.is("groupSelectsChildren")&&this.gridOptionsService.is("suppressParentsInRowNodes")&&console.warn("AG Grid: 'groupSelectsChildren' does not work with 'suppressParentsInRowNodes', this selection method needs the part in rowNode to work"),this.gridOptionsService.is("groupSelectsChildren")&&"multiple"!==this.gridOptionsService.get("rowSelection")&&console.warn("AG Grid: rowSelection must be 'multiple' for groupSelectsChildren to make sense"),this.gridOptionsService.is("groupRemoveSingleChildren")&&this.gridOptionsService.is("groupHideOpenParents")&&this.pickOneWarning("groupRemoveSingleChildren","groupHideOpenParents"),this.gridOptionsService.isRowModelType("serverSide")){const e=(e,t)=>`AG Grid: '${e}' is not supported on the Server-Side Row Model.`+(t?` Please use ${t} instead.`:"");this.gridOptionsService.exists("groupDefaultExpanded")&&console.warn(e("groupDefaultExpanded","isServerSideGroupOpenByDefault callback")),this.gridOptionsService.exists("groupIncludeFooter")&&this.gridOptionsService.is("suppressServerSideInfiniteScroll")&&console.warn(e("groupIncludeFooter")),this.gridOptionsService.exists("groupIncludeTotalFooter")&&console.warn(e("groupIncludeTotalFooter"))}this.gridOptionsService.is("enableRangeSelection")?v.__assertRegistered(m.RangeSelectionModule,"enableRangeSelection",this.gridOptionsService.getGridId()):(this.gridOptionsService.is("enableRangeHandle")||this.gridOptionsService.is("enableFillHandle"))&&console.warn("AG Grid: 'enableRangeHandle' or 'enableFillHandle' will not work unless 'enableRangeSelection' is set to true");const e=(e,t)=>this.gridOptionsService.exists(e)&&v.__assertRegistered(t,e,this.gridOptionsService.getGridId());e("sideBar",m.SideBarModule),e("statusBar",m.StatusBarModule),e("enableCharts",m.GridChartsModule),e("getMainMenuItems",m.MenuModule),e("getContextMenuItems",m.MenuModule),e("allowContextMenuWithControlKey",m.MenuModule)}checkColumnDefProperties(){if(null==this.gridOptions.columnDefs)return;const n=Wt.ALL_PROPERTIES,r=(e,t)=>{const i=Object.getOwnPropertyNames(e);this.checkProperties(i,[...n,...Zt],n,t,"https://www.ag-grid.com/javascript-data-grid/column-properties/"),e.children&&e.children.forEach(e=>r(e,"columnDefs.children"))};this.gridOptions.columnDefs.forEach(e=>r(e,"columnDefs")),this.gridOptions.defaultColDef&&r(this.gridOptions.defaultColDef,"defaultColDef")}checkColumnDefViolations(){var e;const i=null!==(e=this.gridOptionsService.get("rowModelType"))&&void 0!==e?e:"clientSide",n={infinite:["headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],viewport:["headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],serverSide:["headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],clientSide:[]}[i];if(!(null==n?void 0:n.length))return;const t=t=>{n.forEach(e=>{e in t&&t[e]&&console.warn(`AG Grid: Column property ${e} is not supported with the row model type ${i}.`)})};null!=this.gridOptions.columnDefs&&this.gridOptions.columnDefs.forEach(e=>t(e)),null!=this.gridOptions.autoGroupColumnDef&&t(this.gridOptions.autoGroupColumnDef),null!=this.gridOptions.defaultColDef&&t(this.gridOptions.defaultColDef)}checkGridOptionsProperties(){const e=Object.getOwnPropertyNames(this.gridOptions),t=[...b.ALL_PROPERTIES,..._.EVENT_CALLBACKS],i=[...t,"api","columnApi",...Zt,...Object.keys(this.deprecatedProperties)];this.checkProperties(e,i,t,"gridOptions","https://www.ag-grid.com/javascript-data-grid/grid-options/")}checkProperties(e,t,i,n,r){const o=Ut(e,t,i);a(o,(e,t)=>{l(()=>console.warn(`AG Grid: invalid ${n} property '${e}' did you mean any of these: ${t.slice(0,8).join(", ")}`),"invalidProperty"+n+e)}),Object.keys(o).length>0&&l(()=>console.warn(`AG Grid: to see all the valid ${n} properties please check: ${r}`),"invalidProperties"+n+r)}checkForDeprecated(){const r=this.gridOptions;Object.entries(this.deprecatedProperties).forEach(([e,t])=>{var i;const n=r[e];n&&(Xt(t.version,e,t.newProp,t.message),t.copyToNewProp&&t.newProp&&null==r[t.newProp]&&(r[t.newProp]=null!==(i=t.newPropValue)&&void 0!==i?i:n))}),r.serverSideStoreType&&(console.warn("AG Grid: since v29.0, `serverSideStoreType` has been replaced by `suppressServerSideInfiniteScroll`. Set to false to use Partial Store, and true to use Full Store."),r.suppressServerSideInfiniteScroll="partial"!==r.serverSideStoreType)}checkForViolations(){this.gridOptionsService.is("treeData")&&this.treeDataViolations()}treeDataViolations(){this.gridOptionsService.isRowModelType("clientSide")&&(this.gridOptionsService.exists("getDataPath")||console.warn("AG Grid: property usingTreeData=true with rowModel=clientSide, but you did not provide getDataPath function, please provide getDataPath function if using tree data.")),this.gridOptionsService.isRowModelType("serverSide")&&(this.gridOptionsService.exists("isServerSideGroup")||console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide isServerSideGroup function, please provide isServerSideGroup function if using tree data."),this.gridOptionsService.exists("getServerSideGroupKey")||console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide getServerSideGroupKey function, please provide getServerSideGroupKey function if using tree data."))}};function Jt(e,t){const i=["groupRows","multipleColumns","custom","singleColumn"];return i.indexOf(t)<0?(console.warn(`AG Grid: '${t}' is not a valid groupDisplayType value - possible values are: '${i.join("', '")}'`),!1):t===e}Kt([s("gridOptions")],Qt.prototype,"gridOptions",void 0),Kt([s("gridOptionsService")],Qt.prototype,"gridOptionsService",void 0),Kt([r],Qt.prototype,"init",null),Qt=Kt([o("gridOptionsValidator")],Qt);var ei=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},ti=function(i,n){return function(e,t){n(e,t,i)}},ii=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};let ni=class extends p{constructor(){super(...arguments),this.primaryHeaderRowCount=0,this.secondaryHeaderRowCount=0,this.gridHeaderRowCount=0,this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.displayedColumnsAndGroupsMap={},this.viewportColumns=[],this.viewportColumnsHash="",this.headerViewportColumns=[],this.viewportColumnsCenter=[],this.headerViewportColumnsCenter=[],this.autoHeightActiveAtLeastOnce=!1,this.rowGroupColumns=[],this.valueColumns=[],this.pivotColumns=[],this.ready=!1,this.autoGroupsNeedBuilding=!1,this.forceRecreateAutoGroups=!1,this.pivotMode=!1,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.bodyWidthDirty=!0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}init(){this.suppressColumnVirtualisation=this.gridOptionsService.is("suppressColumnVirtualisation");const e=this.gridOptionsService.is("pivotMode");this.isPivotSettingAllowed(e)&&(this.pivotMode=e),this.usingTreeData=this.gridOptionsService.isTreeData(),this.addManagedPropertyListener("groupDisplayType",()=>this.onAutoGroupColumnDefChanged()),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.onAutoGroupColumnDefChanged()),this.addManagedPropertyListener("defaultColDef",e=>this.onSharedColDefChanged(e.source)),this.addManagedPropertyListener("columnTypes",e=>this.onSharedColDefChanged(e.source))}onAutoGroupColumnDefChanged(){this.columnDefs&&(this.autoGroupsNeedBuilding=!0,this.forceRecreateAutoGroups=!0,this.updateGridColumns(),this.updateDisplayedColumns("gridOptionsChanged"))}onSharedColDefChanged(e="api"){this.forceRecreateAutoGroups=!0,this.createColumnsFromColumnDefs(!0,e)}setColumnDefs(e,t="api"){const i=!!this.columnDefs;this.columnDefs=e,this.createColumnsFromColumnDefs(i,t)}recreateColumnDefs(e="api"){this.onSharedColDefChanged(e)}destroyOldColumns(e,t){const i={};if(!e)return;this.columnUtils.depthFirstOriginalTreeSearch(null,e,e=>{i[e.getInstanceId()]=e}),t&&this.columnUtils.depthFirstOriginalTreeSearch(null,t,e=>{i[e.getInstanceId()]=null});const n=Object.values(i).filter(e=>null!=e);this.destroyBeans(n)}destroyColumns(){this.destroyOldColumns(this.primaryColumnTree),this.destroyOldColumns(this.secondaryBalancedTree),this.destroyOldColumns(this.groupAutoColsBalancedTree)}createColumnsFromColumnDefs(e,t="api"){const i=e?this.compareColumnStatesAndDispatchEvents(t):void 0;this.valueCache.expire(),this.autoGroupsNeedBuilding=!0;const n=this.primaryColumns,r=this.primaryColumnTree,o=this.columnFactory.createColumnTree(this.columnDefs,!0,r);this.destroyOldColumns(this.primaryColumnTree,o.columnTree),this.primaryColumnTree=o.columnTree,this.primaryHeaderRowCount=o.treeDept+1,this.primaryColumns=this.getColumnsFromTree(this.primaryColumnTree),this.primaryColumnsMap={},this.primaryColumns.forEach(e=>this.primaryColumnsMap[e.getId()]=e),this.extractRowGroupColumns(t,n),this.extractPivotColumns(t,n),this.extractValueColumns(t,n),this.ready=!0;const s=void 0===this.gridColsArePrimary;(this.gridColsArePrimary||s)&&(this.updateGridColumns(),e&&!this.gridOptionsService.is("maintainColumnOrder")&&this.orderGridColumnsLikePrimary(),this.updateDisplayedColumns(t),this.checkViewportColumns()),this.dispatchEverythingChanged(t),i&&i(),this.dispatchNewColumnsLoaded()}dispatchNewColumnsLoaded(){const e={type:y.EVENT_NEW_COLUMNS_LOADED};this.eventService.dispatchEvent(e)}dispatchEverythingChanged(e="api"){const t={type:y.EVENT_COLUMN_EVERYTHING_CHANGED,source:e};this.eventService.dispatchEvent(t)}orderGridColumnsLikePrimary(){const s=this.primaryColumns;s&&(this.gridColumns.sort((e,t)=>{const i=s.indexOf(e),n=s.indexOf(t),r=i>=0,o=n>=0;if(r&&o)return i-n;if(r)return 1;if(o)return-1;return this.gridColumns.indexOf(e)-this.gridColumns.indexOf(t)}),this.gridColumns=this.placeLockedColumns(this.gridColumns))}getAllDisplayedAutoHeightCols(){return this.displayedAutoHeightCols}setViewport(){this.gridOptionsService.is("enableRtl")?(this.viewportLeft=this.bodyWidth-this.scrollPosition-this.scrollWidth,this.viewportRight=this.bodyWidth-this.scrollPosition):(this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition)}getDisplayedColumnsStartingAt(e){let t=e;const i=[];for(;null!=t;)i.push(t),t=this.getDisplayedColAfter(t);return i}checkViewportColumns(){if(null==this.displayedColumnsCenter)return;if(!this.extractViewport())return;const e={type:y.EVENT_VIRTUAL_COLUMNS_CHANGED};this.eventService.dispatchEvent(e)}setViewportPosition(e,t){(e!==this.scrollWidth||t!==this.scrollPosition||this.bodyWidthDirty)&&(this.scrollWidth=e,this.scrollPosition=t,this.bodyWidthDirty=!0,this.setViewport(),this.ready&&this.checkViewportColumns())}isPivotMode(){return this.pivotMode}isPivotSettingAllowed(e){return!e||!this.gridOptionsService.isTreeData()||(console.warn("AG Grid: Pivot mode not available in conjunction Tree Data i.e. 'gridOptions.treeData: true'"),!1)}setPivotMode(e,t="api"){if(e===this.pivotMode||!this.isPivotSettingAllowed(this.pivotMode))return;this.pivotMode=e,this.autoGroupsNeedBuilding=!0,this.updateGridColumns(),this.updateDisplayedColumns(t);const i={type:y.EVENT_COLUMN_PIVOT_MODE_CHANGED};this.eventService.dispatchEvent(i)}getSecondaryPivotColumn(n,e){if(u(this.secondaryColumns))return null;const r=this.getPrimaryColumn(e);let o=null;return this.secondaryColumns.forEach(e=>{const t=e.getColDef().pivotKeys,i=e.getColDef().pivotValueColumn;it(t,n)&&i===r&&(o=e)}),o}setBeans(e){this.logger=e.create("columnModel")}setFirstRightAndLastLeftPinned(t){let i,n;this.gridOptionsService.is("enableRtl")?(i=this.displayedColumnsLeft?this.displayedColumnsLeft[0]:null,n=this.displayedColumnsRight?f(this.displayedColumnsRight):null):(i=this.displayedColumnsLeft?f(this.displayedColumnsLeft):null,n=this.displayedColumnsRight?this.displayedColumnsRight[0]:null),this.gridColumns.forEach(e=>{e.setLastLeftPinned(e===i,t),e.setFirstRightPinned(e===n,t)})}autoSizeColumns(e){if(this.shouldQueueResizeOperations)return void this.resizeOperationQueue.push(()=>this.autoSizeColumns(e));const{columns:t,skipHeader:i,skipHeaderGroups:n,stopAtGroup:r,source:o="api"}=e;this.animationFrameService.flushAllFrames();const s=[];let a=-1;const l=null!=i?i:this.gridOptionsService.is("skipHeaderOnAutoSize"),c=null!=n?n:l;for(;0!==a;)a=0,this.actionOnGridColumns(t,t=>{if(s.indexOf(t)>=0)return!1;const i=this.autoWidthCalculator.getPreferredWidthForColumn(t,l);if(i>0){const e=this.normaliseColumnWidth(t,i);t.setActualWidth(e,o),s.push(t),a++}return!0},o);c||this.autoSizeColumnGroupsByColumns(t,o,r),this.dispatchColumnResizedEvent(s,!0,"autosizeColumns")}dispatchColumnResizedEvent(t,i,n,r=null){if(t&&t.length){const e={type:y.EVENT_COLUMN_RESIZED,columns:t,column:1===t.length?t[0]:null,flexColumns:r,finished:i,source:n};this.eventService.dispatchEvent(e)}}dispatchColumnChangedEvent(e,t,i){const n={type:e,columns:t,column:t&&1==t.length?t[0]:null,source:i};this.eventService.dispatchEvent(n)}dispatchColumnMovedEvent(e){const{movedColumns:t,source:i,toIndex:n,finished:r}=e,o={type:y.EVENT_COLUMN_MOVED,columns:t,column:t&&1===t.length?t[0]:null,toIndex:n,finished:r,source:i};this.eventService.dispatchEvent(o)}dispatchColumnPinnedEvent(e,t){if(!e.length)return;const i=1===e.length?e[0]:null,n=this.getCommonValue(e,e=>e.getPinned()),r={type:y.EVENT_COLUMN_PINNED,pinned:null!=n?n:null,columns:e,column:i,source:t};this.eventService.dispatchEvent(r)}dispatchColumnVisibleEvent(e,t){if(!e.length)return;const i=1===e.length?e[0]:null,n=this.getCommonValue(e,e=>e.isVisible()),r={type:y.EVENT_COLUMN_VISIBLE,visible:n,columns:e,column:i,source:t};this.eventService.dispatchEvent(r)}autoSizeColumn(e,t,i="api"){e&&this.autoSizeColumns({columns:[e],skipHeader:t,skipHeaderGroups:!0,source:i})}autoSizeColumnGroupsByColumns(e,t,i){const n=new Set;let r;this.getGridColumns(e).forEach(e=>{let t=e.getParent();for(;t&&t!=i;)t.isPadding()||n.add(t),t=t.getParent()});for(const e of n){for(const t of this.ctrlsService.getHeaderRowContainerCtrls())if(r=t.getHeaderCtrlForColumn(e),r)break;r&&r.resizeLeafColumnsToFit(t)}return[]}autoSizeAllColumns(e,t="api"){if(this.shouldQueueResizeOperations)return void this.resizeOperationQueue.push(()=>this.autoSizeAllColumns(e,t));const i=this.getAllDisplayedColumns();this.autoSizeColumns({columns:i,skipHeader:e,source:t})}getColumnsFromTree(e){const n=[],r=i=>{for(let t=0;t<i.length;t++){const e=i[t];e instanceof d?n.push(e):e instanceof h&&r(e.getChildren())}};return r(e),n}getAllDisplayedTrees(){return this.displayedTreeLeft&&this.displayedTreeRight&&this.displayedTreeCentre?this.displayedTreeLeft.concat(this.displayedTreeCentre).concat(this.displayedTreeRight):null}getPrimaryColumnTree(){return this.primaryColumnTree}getHeaderRowCount(){return this.gridHeaderRowCount}getDisplayedTreeLeft(){return this.displayedTreeLeft}getDisplayedTreeRight(){return this.displayedTreeRight}getDisplayedTreeCentre(){return this.displayedTreeCentre}isColumnDisplayed(e){return this.getAllDisplayedColumns().indexOf(e)>=0}getAllDisplayedColumns(){return this.displayedColumns}getViewportColumns(){return this.viewportColumns}getDisplayedLeftColumnsForRow(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedColumnsLeft):this.displayedColumnsLeft}getDisplayedRightColumnsForRow(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedColumnsRight):this.displayedColumnsRight}isColSpanActive(){return this.colSpanActive}getDisplayedColumnsForRow(s,a,l,c){const u=[];let d=null;for(let o=0;o<a.length;o++){const e=a[o],t=a.length-o,i=Math.min(e.getColSpan(s),t),n=[e];if(i>1){const s=i-1;for(let e=1;e<=s;e++)n.push(a[o+e]);o+=s}let r;if(l?(r=!1,n.forEach(e=>{l(e)&&(r=!0)})):r=!0,r){if(0===u.length&&d){!!c&&c(e)&&u.push(d)}u.push(e)}d=e}return u}getViewportCenterColumnsForRow(e){if(!this.colSpanActive)return this.viewportColumnsCenter;const t=this.suppressColumnVirtualisation?null:this.isColumnInRowViewport.bind(this);return this.getDisplayedColumnsForRow(e,this.displayedColumnsCenter,t,e=>{const t=e.getLeft();return C(t)&&t>this.viewportLeft})}getAriaColumnIndex(e){return this.getAllGridColumns().indexOf(e)+1}isColumnInHeaderViewport(e){return!!e.isAutoHeaderHeight()||this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,i=t+e.getActualWidth(),n=this.viewportLeft-200,r=this.viewportRight+200;return!(t<n&&i<n)&&!(t>r&&i>r)}getDisplayedColumnsLeftWidth(){return this.getWidthOfColsInList(this.displayedColumnsLeft)}getDisplayedColumnsRightWidth(){return this.getWidthOfColsInList(this.displayedColumnsRight)}updatePrimaryColumnList(e,i,n,r,t,o="api"){if(!e||ee(e))return;let s=!1;if(e.forEach(e=>{const t=this.getPrimaryColumn(e);if(t){if(n){if(i.indexOf(t)>=0)return;i.push(t)}else{if(i.indexOf(t)<0)return;st(i,t)}r(t),s=!0}}),!s)return;this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(o);const a={type:t,columns:i,column:1===i.length?i[0]:null,source:o};this.eventService.dispatchEvent(a)}setRowGroupColumns(e,t="api"){this.autoGroupsNeedBuilding=!0,this.setPrimaryColumnList(e,this.rowGroupColumns,y.EVENT_COLUMN_ROW_GROUP_CHANGED,this.setRowGroupActive.bind(this),t)}setRowGroupActive(e,t,i){e!==t.isRowGroupActive()&&(t.setRowGroupActive(e,i),e&&!this.gridOptionsService.is("suppressRowGroupHidesColumns")&&this.setColumnVisible(t,!1,i),e||this.gridOptionsService.is("suppressMakeColumnVisibleAfterUnGroup")||this.setColumnVisible(t,!0,i))}addRowGroupColumn(e,t="api"){e&&this.addRowGroupColumns([e],t)}addRowGroupColumns(e,t="api"){this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!0,this.setRowGroupActive.bind(this,!0),y.EVENT_COLUMN_ROW_GROUP_CHANGED,t)}removeRowGroupColumns(e,t="api"){this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!1,this.setRowGroupActive.bind(this,!1),y.EVENT_COLUMN_ROW_GROUP_CHANGED,t)}removeRowGroupColumn(e,t="api"){e&&this.removeRowGroupColumns([e],t)}addPivotColumns(e,t="api"){this.updatePrimaryColumnList(e,this.pivotColumns,!0,e=>e.setPivotActive(!0,t),y.EVENT_COLUMN_PIVOT_CHANGED,t)}setPivotColumns(e,i="api"){this.setPrimaryColumnList(e,this.pivotColumns,y.EVENT_COLUMN_PIVOT_CHANGED,(e,t)=>{t.setPivotActive(e,i)},i)}addPivotColumn(e,t="api"){this.addPivotColumns([e],t)}removePivotColumns(e,t="api"){this.updatePrimaryColumnList(e,this.pivotColumns,!1,e=>e.setPivotActive(!1,t),y.EVENT_COLUMN_PIVOT_CHANGED,t)}removePivotColumn(e,t="api"){this.removePivotColumns([e],t)}setPrimaryColumnList(e,i,t,n,r){i.length=0,C(e)&&e.forEach(e=>{const t=this.getPrimaryColumn(e);t&&i.push(t)}),(this.primaryColumns||[]).forEach(e=>{const t=i.indexOf(e)>=0;n(t,e)}),this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(r),this.dispatchColumnChangedEvent(t,i,r)}setValueColumns(e,t="api"){this.setPrimaryColumnList(e,this.valueColumns,y.EVENT_COLUMN_VALUE_CHANGED,this.setValueActive.bind(this),t)}setValueActive(e,t,i){if(e!==t.isValueActive()&&(t.setValueActive(e,i),e&&!t.getAggFunc())){const e=this.aggFuncService.getDefaultAggFunc(t);t.setAggFunc(e)}}addValueColumns(e,t="api"){this.updatePrimaryColumnList(e,this.valueColumns,!0,this.setValueActive.bind(this,!0),y.EVENT_COLUMN_VALUE_CHANGED,t)}addValueColumn(e,t="api"){e&&this.addValueColumns([e],t)}removeValueColumn(e,t="api"){this.removeValueColumns([e],t)}removeValueColumns(e,t="api"){this.updatePrimaryColumnList(e,this.valueColumns,!1,this.setValueActive.bind(this,!1),y.EVENT_COLUMN_VALUE_CHANGED,t)}normaliseColumnWidth(e,t){const i=e.getMinWidth();C(i)&&t<i&&(t=i);const n=e.getMaxWidth();return C(n)&&e.isGreaterThanMax(t)&&(t=n),t}getPrimaryOrGridColumn(e){return this.getPrimaryColumn(e)||this.getGridColumn(e)}setColumnWidths(e,r,t,i="api"){const o=[];e.forEach(i=>{const n=this.getPrimaryOrGridColumn(i.key);if(!n)return;o.push({width:i.newWidth,ratios:[1],columns:[n]});if("shift"===this.gridOptionsService.get("colResizeDefault")&&(r=!r),r){const r=this.getDisplayedColAfter(n);if(!r)return;const e=n.getActualWidth()-i.newWidth,t=r.getActualWidth()+e;o.push({width:t,ratios:[1],columns:[r]})}}),0!==o.length&&this.resizeColumnSets({resizeSets:o,finished:t,source:i})}checkMinAndMaxWidthsForSet(e){const{columns:t,width:i}=e;let n=0,r=0,o=!0;t.forEach(e=>{const t=e.getMinWidth();n+=t||0;const i=e.getMaxWidth();C(i)&&i>0?r+=i:o=!1});return i>=n&&(!o||i<=r)}resizeColumnSets(e){const{resizeSets:t,finished:i,source:n}=e;if(!(!t||t.every(e=>this.checkMinAndMaxWidthsForSet(e)))){if(i){const e=t&&t.length>0?t[0].columns:null;this.dispatchColumnResizedEvent(e,i,n)}return}const r=[],h=[];t.forEach(s=>{const{width:a,columns:e,ratios:l}=s,c={},u={};e.forEach(e=>h.push(e));let d=!0,t=0;for(;d;){if(t++,t>1e3){console.error("AG Grid: infinite loop in resizeColumnSets");break}d=!1;const s=[];let i=0,o=a;e.forEach((e,t)=>{if(u[e.getId()])o-=c[e.getId()];else{s.push(e);const o=l[t];i+=o}});const h=1/i;s.forEach((e,t)=>{let i;t===s.length-1?i=o:(i=Math.round(l[t]*a*h),o-=i);const n=e.getMinWidth(),r=e.getMaxWidth();C(n)&&i<n?(i=n,u[e.getId()]=!0,d=!0):C(r)&&r>0&&i>r&&(i=r,u[e.getId()]=!0,d=!0),c[e.getId()]=i})}e.forEach(e=>{const t=c[e.getId()];e.getActualWidth()!==t&&(e.setActualWidth(t,n),r.push(e))})});const o=r.length>0;let s=[];o&&(s=this.refreshFlexedColumns({resizingCols:h,skipSetLeft:!0}),this.setLeftValues(n),this.updateBodyWidths(),this.checkViewportColumns());const a=h.concat(s);(o||i)&&this.dispatchColumnResizedEvent(a,i,n,s)}setColumnAggFunc(e,t,i="api"){if(!e)return;const n=this.getPrimaryColumn(e);n&&(n.setAggFunc(t),this.dispatchColumnChangedEvent(y.EVENT_COLUMN_VALUE_CHANGED,[n],i))}moveRowGroupColumn(e,t,i="api"){const n=this.rowGroupColumns[e];this.rowGroupColumns.splice(e,1),this.rowGroupColumns.splice(t,0,n);const r={type:y.EVENT_COLUMN_ROW_GROUP_CHANGED,columns:this.rowGroupColumns,column:1===this.rowGroupColumns.length?this.rowGroupColumns[0]:null,source:i};this.eventService.dispatchEvent(r)}moveColumns(e,t,i="api",n=!0){if(this.columnAnimationService.start(),t>this.gridColumns.length-e.length)return console.warn("AG Grid: tried to insert columns in invalid location, toIndex = "+t),void console.warn("AG Grid: remember that you should not count the moving columns when calculating the new index");const r=this.getGridColumns(e);!this.doesMovePassRules(r,t)||(ut(this.gridColumns,r,t),this.updateDisplayedColumns(i),this.dispatchColumnMovedEvent({movedColumns:r,source:i,toIndex:t,finished:n}),this.columnAnimationService.finish())}doesMovePassRules(e,t){const i=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(i)}doesOrderPassRules(e){return!!this.doesMovePassMarryChildren(e)&&!!this.doesMovePassLockedPositions(e)}getProposedColumnOrder(e,t){const i=this.gridColumns.slice();return ut(i,e,t),i}sortColumnsLikeGridColumns(e){if(!e||e.length<=1)return;e.filter(e=>this.gridColumns.indexOf(e)<0).length>0||e.sort((e,t)=>this.gridColumns.indexOf(e)-this.gridColumns.indexOf(t))}doesMovePassLockedPositions(e){let n=0,r=!0;return e.forEach(e=>{const t=(i=e.getColDef().lockPosition)?!0===i||"left"===i?0:2:1;var i;t<n&&(r=!1),n=t}),r}doesMovePassMarryChildren(r){let o=!0;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,e=>{if(!(e instanceof h))return;const t=e,i=t.getColGroupDef();if(!(i&&i.marryChildren))return;const n=[];t.getLeafColumns().forEach(e=>{const t=r.indexOf(e);n.push(t)});Math.max.apply(Math,n)-Math.min.apply(Math,n)>t.getLeafColumns().length-1&&(o=!1)}),o}moveColumn(e,t,i="api"){this.moveColumns([e],t,i)}moveColumnByIndex(e,t,i="api"){const n=this.gridColumns[e];this.moveColumn(n,t,i)}getColumnDefs(){if(!this.primaryColumns)return;const e=this.primaryColumns.slice();return this.gridColsArePrimary?e.sort((e,t)=>this.gridColumns.indexOf(e)-this.gridColumns.indexOf(t)):this.lastPrimaryOrder&&e.sort((e,t)=>this.lastPrimaryOrder.indexOf(e)-this.lastPrimaryOrder.indexOf(t)),this.columnDefFactory.buildColumnDefs(e,this.rowGroupColumns,this.pivotColumns)}getBodyContainerWidth(){return this.bodyWidth}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}updateBodyWidths(){const t=this.getWidthOfColsInList(this.displayedColumnsCenter),i=this.getWidthOfColsInList(this.displayedColumnsLeft),n=this.getWidthOfColsInList(this.displayedColumnsRight);this.bodyWidthDirty=this.bodyWidth!==t;if(this.bodyWidth!==t||this.leftWidth!==i||this.rightWidth!==n){this.bodyWidth=t,this.leftWidth=i,this.rightWidth=n;const e={type:y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED};this.eventService.dispatchEvent(e)}}getValueColumns(){return this.valueColumns?this.valueColumns:[]}getPivotColumns(){return this.pivotColumns?this.pivotColumns:[]}isPivotActive(){return this.pivotColumns&&this.pivotColumns.length>0&&this.pivotMode}getRowGroupColumns(){return this.rowGroupColumns?this.rowGroupColumns:[]}getDisplayedCenterColumns(){return this.displayedColumnsCenter}getDisplayedLeftColumns(){return this.displayedColumnsLeft}getDisplayedRightColumns(){return this.displayedColumnsRight}getDisplayedColumns(e){switch(e){case"left":return this.getDisplayedLeftColumns();case"right":return this.getDisplayedRightColumns();default:return this.getDisplayedCenterColumns()}}getAllPrimaryColumns(){return this.primaryColumns?this.primaryColumns.slice():null}getSecondaryColumns(){return this.secondaryColumns?this.secondaryColumns.slice():null}getAllColumnsForQuickFilter(){return this.columnsForQuickFilter}getAllGridColumns(){return this.gridColumns}isEmpty(){return ee(this.gridColumns)}isRowGroupEmpty(){return ee(this.rowGroupColumns)}setColumnVisible(e,t,i="api"){this.setColumnsVisible([e],t,i)}setColumnsVisible(e,t=!1,i="api"){this.applyColumnState({state:e.map(e=>({colId:"string"==typeof e?e:e.getColId(),hide:!t}))},i)}setColumnPinned(e,t,i="api"){e&&this.setColumnsPinned([e],t,i)}setColumnsPinned(e,t,i="api"){if(this.gridOptionsService.isDomLayout("print"))return void console.warn("AG Grid: Changing the column pinning status is not allowed with domLayout='print'");let n;this.columnAnimationService.start(),n=!0===t||"left"===t?"left":"right"===t?"right":null,this.actionOnGridColumns(e,e=>e.getPinned()!==n&&(e.setPinned(n),!0),i,()=>({type:y.EVENT_COLUMN_PINNED,pinned:n,column:null,columns:null,source:i})),this.columnAnimationService.finish()}actionOnGridColumns(e,i,t,n){if(ee(e))return;const r=[];if(e.forEach(e=>{const t=this.getGridColumn(e);if(!t)return;!1!==i(t)&&r.push(t)}),r.length&&(this.updateDisplayedColumns(t),C(n)&&n)){const e=n();e.columns=r,e.column=1===r.length?r[0]:null,this.eventService.dispatchEvent(e)}}getDisplayedColBefore(e){const t=this.getAllDisplayedColumns(),i=t.indexOf(e);return i>0?t[i-1]:null}getDisplayedColAfter(e){const t=this.getAllDisplayedColumns(),i=t.indexOf(e);return i<t.length-1?t[i+1]:null}getDisplayedGroupAfter(e){return this.getDisplayedGroupAtDirection(e,"After")}getDisplayedGroupBefore(e){return this.getDisplayedGroupAtDirection(e,"Before")}getDisplayedGroupAtDirection(e,t){const i=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),n=e.getDisplayedLeafColumns(),r="After"===t?f(n):n[0],o="getDisplayedCol"+t;for(;;){const t=this[o](r);if(!t)return null;const n=this.getColumnGroupAtLevel(t,i);if(n!==e)return n}}getColumnGroupAtLevel(e,t){let i,n,r=e.getParent();for(;;){if(i=r.getProvidedColumnGroup().getLevel(),n=r.getPaddingLevel(),i+n<=t)break;r=r.getParent()}return r}isPinningLeft(){return this.displayedColumnsLeft.length>0}isPinningRight(){return this.displayedColumnsRight.length>0}getPrimaryAndSecondaryAndAutoColumns(){return[].concat(this.primaryColumns||[],this.groupAutoColumns||[],this.secondaryColumns||[])}createStateItemFromColumn(e){const t=e.isRowGroupActive()?this.rowGroupColumns.indexOf(e):null,i=e.isPivotActive()?this.pivotColumns.indexOf(e):null,n=e.isValueActive()?e.getAggFunc():null,r=null!=e.getSort()?e.getSort():null,o=null!=e.getSortIndex()?e.getSortIndex():null,s=null!=e.getFlex()&&e.getFlex()>0?e.getFlex():null;return{colId:e.getColId(),width:e.getActualWidth(),hide:!e.isVisible(),pinned:e.getPinned(),sort:r,sortIndex:o,aggFunc:n,rowGroup:e.isRowGroupActive(),rowGroupIndex:t,pivot:e.isPivotActive(),pivotIndex:i,flex:s}}getColumnState(){if(u(this.primaryColumns)||!this.isAlive())return[];const e=this.getPrimaryAndSecondaryAndAutoColumns().map(this.createStateItemFromColumn.bind(this));return this.orderColumnStateList(e),e}orderColumnStateList(e){const i=Vt(this.gridColumns.map((e,t)=>[e.getColId(),t]));e.sort((e,t)=>(i.has(e.colId)?i.get(e.colId):-1)-(i.has(t.colId)?i.get(t.colId):-1))}resetColumnState(e="api"){const t=this.getColumnsFromTree(this.primaryColumnTree),i=[];let n=1e3,r=1e3,o=[];this.groupAutoColumns&&(o=o.concat(this.groupAutoColumns)),t&&(o=o.concat(t)),o.forEach(e=>{const t=this.getColumnStateFromColDef(e);u(t.rowGroupIndex)&&t.rowGroup&&(t.rowGroupIndex=n++),u(t.pivotIndex)&&t.pivot&&(t.pivotIndex=r++),i.push(t)}),this.applyColumnState({state:i,applyOrder:!0},e)}getColumnStateFromColDef(e){const t=(e,t)=>null!=e?e:null!=t?t:null,i=e.getColDef(),n=t(i.sort,i.initialSort),r=t(i.sortIndex,i.initialSortIndex),o=t(i.hide,i.initialHide),s=t(i.pinned,i.initialPinned),a=t(i.width,i.initialWidth),l=t(i.flex,i.initialFlex);let c=t(i.rowGroupIndex,i.initialRowGroupIndex),u=t(i.rowGroup,i.initialRowGroup);null!=c||null!=u&&0!=u||(c=null,u=null);let d=t(i.pivotIndex,i.initialPivotIndex),h=t(i.pivot,i.initialPivot);null!=d||null!=h&&0!=h||(d=null,h=null);const f=t(i.aggFunc,i.initialAggFunc);return{colId:e.getColId(),sort:n,sortIndex:r,hide:o,pinned:s,width:a,flex:l,rowGroup:u,rowGroupIndex:c,pivot:h,pivotIndex:d,aggFunc:f}}applyColumnState(g,m){if(ee(this.primaryColumns))return!1;if(g&&g.state&&!g.state.forEach)return console.warn("AG Grid: applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;const e=(e,t,n)=>{const i=this.compareColumnStatesAndDispatchEvents(m);this.autoGroupsNeedBuilding=!0;const r=t.slice(),o={},s={},a=[],l=[];let c=0;const u=this.rowGroupColumns.slice(),d=this.pivotColumns.slice();e.forEach(e=>{const t=e.colId||"";if(t.startsWith(Nt))return a.push(e),void l.push(e);const i=n(t);i?(this.syncColumnWithStateItem(i,e,g.defaultState,o,s,!1,m),st(r,i)):(l.push(e),c+=1)});const h=e=>this.syncColumnWithStateItem(e,null,g.defaultState,o,s,!1,m);r.forEach(h);const f=(e,t,i,n)=>{const r=e[i.getId()],o=e[n.getId()],s=null!=r,a=null!=o;if(s&&a)return r-o;if(s)return-1;if(a)return 1;const l=t.indexOf(i),c=t.indexOf(n),u=l>=0;return u&&c>=0?l-c:u?-1:1};this.rowGroupColumns.sort(f.bind(this,o,u)),this.pivotColumns.sort(f.bind(this,s,d)),this.updateGridColumns();const p=this.groupAutoColumns?this.groupAutoColumns.slice():[];return a.forEach(e=>{const t=this.getAutoColumn(e.colId);st(p,t),this.syncColumnWithStateItem(t,e,g.defaultState,null,null,!0,m)}),p.forEach(h),this.applyOrderAfterApplyState(g),this.updateDisplayedColumns(m),this.dispatchEverythingChanged(m),i(),{unmatchedAndAutoStates:l,unmatchedCount:c}};this.columnAnimationService.start();let{unmatchedAndAutoStates:t,unmatchedCount:i}=e(g.state||[],this.primaryColumns||[],e=>this.getPrimaryColumn(e));return(t.length>0||C(g.defaultState))&&(i=e(t,this.secondaryColumns||[],e=>this.getSecondaryColumn(e)).unmatchedCount),this.columnAnimationService.finish(),0===i}applyOrderAfterApplyState(e){if(!e.applyOrder||!e.state)return;let i=[];const n={};e.state.forEach(e=>{if(!e.colId||n[e.colId])return;const t=this.gridColumnsMap[e.colId];t&&(i.push(t),n[e.colId]=!0)});let r=0;this.gridColumns.forEach(e=>{const t=e.getColId();if(null!=n[t])return;t.startsWith(Nt)?lt(i,e,r++):i.push(e)}),i=this.placeLockedColumns(i),this.doesMovePassMarryChildren(i)?this.gridColumns=i:console.warn("AG Grid: Applying column order broke a group where columns should be married together. Applying new order has been discarded.")}compareColumnStatesAndDispatchEvents(o){const r={rowGroupColumns:this.rowGroupColumns.slice(),pivotColumns:this.pivotColumns.slice(),valueColumns:this.valueColumns.slice()},s=this.getColumnState(),a={};return s.forEach(e=>{a[e.colId]=e}),()=>{const e=this.getPrimaryAndSecondaryAndAutoColumns(),t=(e,t,i,n)=>{if(it(t.map(n),i.map(n)))return;const r={type:e,columns:i,column:1===i.length?i[0]:null,source:o};this.eventService.dispatchEvent(r)},i=i=>{const n=[];return e.forEach(e=>{const t=a[e.getColId()];t&&i(t,e)&&n.push(e)}),n},n=e=>e.getColId();t(y.EVENT_COLUMN_ROW_GROUP_CHANGED,r.rowGroupColumns,this.rowGroupColumns,n),t(y.EVENT_COLUMN_PIVOT_CHANGED,r.pivotColumns,this.pivotColumns,n);i((e,t)=>{const i=null!=e.aggFunc,n=i!=t.isValueActive(),r=i&&e.aggFunc!=t.getAggFunc();return n||r}).length>0&&this.dispatchColumnChangedEvent(y.EVENT_COLUMN_VALUE_CHANGED,this.valueColumns,o);this.dispatchColumnResizedEvent(i((e,t)=>e.width!=t.getActualWidth()),!0,o);this.dispatchColumnPinnedEvent(i((e,t)=>e.pinned!=t.getPinned()),o);this.dispatchColumnVisibleEvent(i((e,t)=>e.hide==t.isVisible()),o);i((e,t)=>e.sort!=t.getSort()||e.sortIndex!=t.getSortIndex()).length>0&&this.sortController.dispatchSortChangedEvents(o),this.normaliseColumnMovedEventForColumnState(s,o)}}getCommonValue(t,i){if(!t||0==t.length)return;const n=i(t[0]);for(let e=1;e<t.length;e++)if(n!==i(t[e]))return;return n}normaliseColumnMovedEventForColumnState(e,t){const i=this.getColumnState(),n={};i.forEach(e=>n[e.colId]=e);const r={};e.forEach(e=>{n[e.colId]&&(r[e.colId]=!0)});const o=e.filter(e=>r[e.colId]),s=i.filter(e=>r[e.colId]),a=[];s.forEach((e,t)=>{const i=o&&o[t];if(i&&i.colId!==e.colId){const e=this.getGridColumn(i.colId);e&&a.push(e)}}),a.length&&this.dispatchColumnMovedEvent({movedColumns:a,source:t,finished:!0})}syncColumnWithStateItem(e,r,o,t,i,n,s){if(!e)return;const a=(e,t)=>{const i={value1:void 0,value2:void 0};let n=!1;return r&&(void 0!==r[e]&&(i.value1=r[e],n=!0),C(t)&&void 0!==r[t]&&(i.value2=r[t],n=!0)),!n&&o&&(void 0!==o[e]&&(i.value1=o[e]),C(t)&&void 0!==o[t]&&(i.value2=o[t])),i},l=a("hide").value1;void 0!==l&&e.setVisible(!l,s);const c=a("pinned").value1;void 0!==c&&e.setPinned(c);const u=this.columnUtils.calculateColMinWidth(e.getColDef()),d=a("flex").value1;void 0!==d&&e.setFlex(d);if(e.getFlex()<=0){const r=a("width").value1;null!=r&&null!=u&&r>=u&&e.setActualWidth(r,s)}const h=a("sort").value1;void 0!==h&&("desc"===h||"asc"===h?e.setSort(h,s):e.setSort(void 0,s));const f=a("sortIndex").value1;if(void 0!==f&&e.setSortIndex(f),n||!e.isPrimary())return;const p=a("aggFunc").value1;void 0!==p&&("string"==typeof p?(e.setAggFunc(p),e.isValueActive()||(e.setValueActive(!0,s),this.valueColumns.push(e))):(C(p)&&console.warn("AG Grid: stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),e.isValueActive()&&(e.setValueActive(!1,s),st(this.valueColumns,e))));const{value1:g,value2:m}=a("rowGroup","rowGroupIndex");void 0===g&&void 0===m||("number"==typeof m||g?(e.isRowGroupActive()||(e.setRowGroupActive(!0,s),this.rowGroupColumns.push(e)),t&&"number"==typeof m&&(t[e.getId()]=m)):e.isRowGroupActive()&&(e.setRowGroupActive(!1,s),st(this.rowGroupColumns,e)));const{value1:v,value2:y}=a("pivot","pivotIndex");void 0===v&&void 0===y||("number"==typeof y||v?(e.isPivotActive()||(e.setPivotActive(!0,s),this.pivotColumns.push(e)),i&&"number"==typeof y&&(i[e.getId()]=y)):e.isPivotActive()&&(e.setPivotActive(!1,s),st(this.pivotColumns,e)))}getGridColumns(e){return this.getColumns(e,this.getGridColumn.bind(this))}getColumns(e,i){const n=[];return e&&e.forEach(e=>{const t=i(e);t&&n.push(t)}),n}getColumnWithValidation(e){if(null==e)return null;const t=this.getGridColumn(e);return t||console.warn("AG Grid: could not find column "+e),t}getPrimaryColumn(e){return this.primaryColumns?this.getColumn(e,this.primaryColumns,this.primaryColumnsMap):null}getGridColumn(e){return this.getColumn(e,this.gridColumns,this.gridColumnsMap)}getSecondaryColumn(e){return this.secondaryColumns?this.getColumn(e,this.secondaryColumns,this.secondaryColumnsMap):null}getColumn(t,i,e){if(!t)return null;if("string"==typeof t&&e[t])return e[t];for(let e=0;e<i.length;e++)if(this.columnsMatch(i[e],t))return i[e];return this.getAutoColumn(t)}getSourceColumnsForGroupColumn(e){const t=e.getColDef().showRowGroup;if(!t)return null;if(!0===t)return this.rowGroupColumns.slice(0);const i=this.getPrimaryColumn(t);return i?[i]:null}getAutoColumn(t){return this.groupAutoColumns&&C(this.groupAutoColumns)&&!u(this.groupAutoColumns)&&this.groupAutoColumns.find(e=>this.columnsMatch(e,t))||null}columnsMatch(e,t){const i=e===t,n=e.getColDef()===t,r=e.getColId()==t;return i||n||r}getDisplayNameForColumn(e,t,i=!1){if(!e)return null;const n=this.getHeaderName(e.getColDef(),e,null,null,t);return i?this.wrapHeaderNameWithAggFunc(e,n):n}getDisplayNameForProvidedColumnGroup(e,t,i){const n=t?t.getColGroupDef():null;return n?this.getHeaderName(n,null,e,t,i):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(t,i,n,r,o){const s=t.headerValueGetter;if(s){const e={colDef:t,column:i,columnGroup:n,providedColumnGroup:r,location:o,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};return"function"==typeof s?s(e):"string"==typeof s?this.expressionService.evaluate(s,e):(console.warn("AG Grid: headerValueGetter must be a function or a string"),"")}return null!=t.headerName?t.headerName:t.field?Ht(t.field):""}wrapHeaderNameWithAggFunc(i,n){if(this.gridOptionsService.is("suppressAggFuncInHeader"))return n;const r=i.getColDef().pivotValueColumn;let o,s=null;if(C(r)){const e=this.gridOptionsService.is("removePivotHeaderRowWhenSingleValueColumn")&&1===this.valueColumns.length,t=void 0!==i.getColDef().pivotTotalColumnIds;if(e&&!t)return n;s=r?r.getAggFunc():null,o=!0}else{const n=i.isValueActive(),r=this.pivotMode||!this.isRowGroupEmpty();n&&r?(s=i.getAggFunc(),o=!0):o=!1}if(o){const i="string"==typeof s?s:"func";return`${this.localeService.getLocaleTextFunc()(i,i)}(${n})`}return n}getColumnGroup(n,r){if(!n)return null;if(n instanceof g)return n;const e=this.getAllDisplayedTrees(),o="number"==typeof r;let s=null;return this.columnUtils.depthFirstAllColumnTreeSearch(e,i=>{if(i instanceof g){const e=i;let t;t=o?n===e.getGroupId()&&r===e.getPartId():n===e.getGroupId(),t&&(s=e)}}),s}isReady(){return this.ready}extractValueColumns(i,e){this.valueColumns=this.extractColumns(e,this.valueColumns,(e,t)=>e.setValueActive(t,i),()=>{},()=>{},e=>{const t=e.aggFunc;return null===t||""===t?null:void 0!==t?!!t:void 0},e=>null!=e.initialAggFunc&&""!=e.initialAggFunc),this.valueColumns.forEach(e=>{const t=e.getColDef();null!=t.aggFunc&&""!=t.aggFunc?e.setAggFunc(t.aggFunc):e.getAggFunc()||e.setAggFunc(t.initialAggFunc)})}extractRowGroupColumns(i,e){this.rowGroupColumns=this.extractColumns(e,this.rowGroupColumns,(e,t)=>e.setRowGroupActive(t,i),e=>e.rowGroupIndex,e=>e.initialRowGroupIndex,e=>e.rowGroup,e=>e.initialRowGroup)}extractColumns(l=[],c=[],t,u,d,h,f){const p=[],g=[];(this.primaryColumns||[]).forEach(e=>{const t=l.indexOf(e)<0,i=e.getColDef(),n=ne(h(i)),r=ne(f(i)),o=ie(u(i)),s=ie(d(i));let a;if(a=void 0!==n?n:void 0!==o?null!==o&&o>=0:t?void 0!==r?r:!!(void 0!==s)&&(null!=s&&s>=0):c.indexOf(e)>=0,a){(t?null!=o||null!=s:null!=o)?p.push(e):g.push(e)}});const r=e=>{const t=u(e.getColDef()),i=d(e.getColDef());return null!=t?t:i};p.sort((e,t)=>{const i=r(e),n=r(t);return i===n?0:i<n?-1:1});const i=[].concat(p);return c.forEach(e=>{g.indexOf(e)>=0&&i.push(e)}),g.forEach(e=>{i.indexOf(e)<0&&i.push(e)}),c.forEach(e=>{i.indexOf(e)<0&&t(e,!1)}),i.forEach(e=>{c.indexOf(e)<0&&t(e,!0)}),i}extractPivotColumns(i,e){this.pivotColumns=this.extractColumns(e,this.pivotColumns,(e,t)=>e.setPivotActive(t,i),e=>e.pivotIndex,e=>e.initialPivotIndex,e=>e.pivot,e=>e.initialPivot)}resetColumnGroupState(e="api"){const n=[];this.columnUtils.depthFirstOriginalTreeSearch(null,this.primaryColumnTree,i=>{if(i instanceof h){const e=i.getColGroupDef(),t={groupId:i.getGroupId(),open:e?e.openByDefault:void 0};n.push(t)}}),this.setColumnGroupState(n,e)}getColumnGroupState(){const t=[];return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,e=>{e instanceof h&&t.push({groupId:e.getGroupId(),open:e.isExpanded()})}),t}setColumnGroupState(e,t="api"){this.columnAnimationService.start();const r=[];e.forEach(e=>{const t=e.groupId,i=e.open,n=this.getProvidedColumnGroup(t);n&&n.isExpanded()!==i&&(this.logger.log("columnGroupOpened("+n.getGroupId()+","+i+")"),n.setExpanded(i),r.push(n))}),this.updateGroupsAndDisplayedColumns(t),this.setFirstRightAndLastLeftPinned(t),r.forEach(e=>{const t={type:y.EVENT_COLUMN_GROUP_OPENED,columnGroup:e};this.eventService.dispatchEvent(t)}),this.columnAnimationService.finish()}setColumnGroupOpened(e,t,i="api"){let n;n=e instanceof h?e.getId():e||"",this.setColumnGroupState([{groupId:n,open:t}],i)}getProvidedColumnGroup(t){"string"!=typeof t&&console.error("AG Grid: group key must be a string");let i=null;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,e=>{e instanceof h&&e.getId()===t&&(i=e)}),i}calculateColumnsForDisplay(){let e;return e=this.pivotMode&&u(this.secondaryColumns)?this.gridColumns.filter(e=>{const t=this.groupAutoColumns&&dt(this.groupAutoColumns,e),i=this.valueColumns&&dt(this.valueColumns,e);return t||i}):this.gridColumns.filter(e=>this.groupAutoColumns&&dt(this.groupAutoColumns,e)||e.isVisible()),e}checkColSpanActiveInCols(e){let t=!1;return e.forEach(e=>{C(e.getColDef().colSpan)&&(t=!0)}),t}calculateColumnsForGroupDisplay(){this.groupDisplayColumns=[],this.groupDisplayColumnsMap={};this.gridColumns.forEach(t=>{const e=t.getColDef(),i=e.showRowGroup;e&&C(i)&&(this.groupDisplayColumns.push(t),"string"==typeof i?this.groupDisplayColumnsMap[i]=t:!0===i&&this.getRowGroupColumns().forEach(e=>{this.groupDisplayColumnsMap[e.getId()]=t}))})}getGroupDisplayColumns(){return this.groupDisplayColumns}getGroupDisplayColumnForGroup(e){return this.groupDisplayColumnsMap[e]}updateDisplayedColumns(e){const t=this.calculateColumnsForDisplay();this.buildDisplayedTrees(t),this.updateGroupsAndDisplayedColumns(e),this.setFirstRightAndLastLeftPinned(e)}isSecondaryColumnsPresent(){return C(this.secondaryColumns)}setSecondaryColumns(e,t="api"){const i=e&&e.length>0;if(i||!u(this.secondaryColumns)){if(i){this.processSecondaryColumnDefinitions(e);const t=this.columnFactory.createColumnTree(e,!1,this.secondaryBalancedTree||this.previousSecondaryColumns||void 0);this.destroyOldColumns(this.secondaryBalancedTree,t.columnTree),this.secondaryBalancedTree=t.columnTree,this.secondaryHeaderRowCount=t.treeDept+1,this.secondaryColumns=this.getColumnsFromTree(this.secondaryBalancedTree),this.secondaryColumnsMap={},this.secondaryColumns.forEach(e=>this.secondaryColumnsMap[e.getId()]=e),this.previousSecondaryColumns=null}else this.previousSecondaryColumns=this.secondaryBalancedTree,this.secondaryBalancedTree=null,this.secondaryHeaderRowCount=-1,this.secondaryColumns=null,this.secondaryColumnsMap={};this.updateGridColumns(),this.updateDisplayedColumns(t)}}processSecondaryColumnDefinitions(e){const t=this.gridOptionsService.get("processPivotResultColDef")||this.gridOptionsService.get("processSecondaryColDef"),i=this.gridOptionsService.get("processPivotResultColGroupDef")||this.gridOptionsService.get("processSecondaryColGroupDef");if(!t&&!i)return;const n=e=>{e.forEach(e=>{if(C(e.children)){const t=e;i&&i(t),n(t.children)}else{const i=e;t&&t(i)}})};e&&n(e)}updateGridColumns(){const t=this.gridBalancedTree;let e;if(this.gridColsArePrimary?this.lastPrimaryOrder=this.gridColumns:this.lastSecondaryOrder=this.gridColumns,this.secondaryColumns&&this.secondaryBalancedTree){const t=this.secondaryColumns.every(e=>void 0!==this.gridColumnsMap[e.getColId()]);this.gridBalancedTree=this.secondaryBalancedTree.slice(),this.gridHeaderRowCount=this.secondaryHeaderRowCount,this.gridColumns=this.secondaryColumns.slice(),this.gridColsArePrimary=!1,t&&(e=this.lastSecondaryOrder)}else this.primaryColumns&&(this.gridBalancedTree=this.primaryColumnTree.slice(),this.gridHeaderRowCount=this.primaryHeaderRowCount,this.gridColumns=this.primaryColumns.slice(),this.gridColsArePrimary=!0,e=this.lastPrimaryOrder);if(this.createGroupAutoColumnsIfNeeded()&&e){const t=Vt(this.groupAutoColumns.map(e=>[e,!0]));e=e.filter(e=>!t.has(e)),e=[...this.groupAutoColumns,...e]}if(this.addAutoGroupToGridColumns(),this.orderGridColsLike(e),this.gridColumns=this.placeLockedColumns(this.gridColumns),this.calculateColumnsForGroupDisplay(),this.refreshQuickFilterColumns(),this.clearDisplayedAndViewportColumns(),this.colSpanActive=this.checkColSpanActiveInCols(this.gridColumns),this.gridColumnsMap={},this.gridColumns.forEach(e=>this.gridColumnsMap[e.getId()]=e),this.setAutoHeightActive(),!it(t,this.gridBalancedTree)){const t={type:y.EVENT_GRID_COLUMNS_CHANGED};this.eventService.dispatchEvent(t)}}setAutoHeightActive(){if(this.autoHeightActive=this.gridColumns.filter(e=>e.isAutoHeight()).length>0,this.autoHeightActive){this.autoHeightActiveAtLeastOnce=!0;if(!(this.gridOptionsService.isRowModelType("clientSide")||this.gridOptionsService.isRowModelType("serverSide"))){const e="AG Grid - autoHeight columns only work with Client Side Row Model and Server Side Row Model.";l(()=>console.warn(e),"autoHeightActive.wrongRowModel")}}}orderGridColsLike(e){if(u(e))return;const t=Vt(e.map((e,t)=>[e,t]));let i=!0;if(this.gridColumns.forEach(e=>{t.has(e)&&(i=!1)}),i)return;const n=Vt(this.gridColumns.map(e=>[e,!0])),r=e.filter(e=>n.has(e)),o=Vt(r.map(e=>[e,!0])),s=this.gridColumns.filter(e=>!o.has(e)),a=r.slice();s.forEach(e=>{let t=e.getOriginalParent();if(!t)return void a.push(e);const n=[];for(;!n.length&&t;){t.getLeafColumns().forEach(e=>{const t=a.indexOf(e)>=0,i=n.indexOf(e)<0;t&&i&&n.push(e)}),t=t.getOriginalParent()}if(!n.length)return void a.push(e);const i=n.map(e=>a.indexOf(e)),r=Math.max(...i);lt(a,e,r+1)}),this.gridColumns=a}isPrimaryColumnGroupsPresent(){return this.primaryHeaderRowCount>1}refreshQuickFilterColumns(){var e;let t=null!==(e=this.isPivotMode()?this.secondaryColumns:this.primaryColumns)&&void 0!==e?e:[];this.groupAutoColumns&&(t=t.concat(this.groupAutoColumns)),this.columnsForQuickFilter=this.gridOptionsService.is("includeHiddenColumnsInQuickFilter")?t:t.filter(e=>e.isVisible()||e.isRowGroupActive())}placeLockedColumns(e){const i=[],n=[],r=[];return e.forEach(e=>{const t=e.getColDef().lockPosition;"right"===t?r.push(e):"left"===t||!0===t?i.push(e):n.push(e)}),[...i,...n,...r]}addAutoGroupToGridColumns(){if(u(this.groupAutoColumns))return this.destroyOldColumns(this.groupAutoColsBalancedTree),void(this.groupAutoColsBalancedTree=null);this.gridColumns=this.groupAutoColumns?this.groupAutoColumns.concat(this.gridColumns):this.gridColumns;const e=this.columnFactory.createForAutoGroups(this.groupAutoColumns,this.gridBalancedTree);this.destroyOldColumns(this.groupAutoColsBalancedTree,e),this.groupAutoColsBalancedTree=e,this.gridBalancedTree=e.concat(this.gridBalancedTree)}clearDisplayedAndViewportColumns(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.viewportColumns=[],this.headerViewportColumns=[],this.viewportColumnsHash=""}updateGroupsAndDisplayedColumns(e){this.updateOpenClosedVisibilityInColumnGroups(),this.deriveDisplayedColumns(e),this.refreshFlexedColumns(),this.extractViewport(),this.updateBodyWidths();const t={type:y.EVENT_DISPLAYED_COLUMNS_CHANGED};this.eventService.dispatchEvent(t)}deriveDisplayedColumns(e){this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeLeft,this.displayedColumnsLeft),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeCentre,this.displayedColumnsCenter),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeRight,this.displayedColumnsRight),this.joinDisplayedColumns(),this.setLeftValues(e),this.displayedAutoHeightCols=this.displayedColumns.filter(e=>e.isAutoHeight())}isAutoRowHeightActive(){return this.autoHeightActive}wasAutoRowHeightEverActive(){return this.autoHeightActiveAtLeastOnce}joinDisplayedColumns(){this.gridOptionsService.is("enableRtl")?this.displayedColumns=this.displayedColumnsRight.concat(this.displayedColumnsCenter).concat(this.displayedColumnsLeft):this.displayedColumns=this.displayedColumnsLeft.concat(this.displayedColumnsCenter).concat(this.displayedColumnsRight)}setLeftValues(e){this.setLeftValuesOfColumns(e),this.setLeftValuesOfGroups()}setLeftValuesOfColumns(i){if(!this.primaryColumns)return;const t=this.primaryColumns.slice(0),n=this.gridOptionsService.is("enableRtl");[this.displayedColumnsLeft,this.displayedColumnsRight,this.displayedColumnsCenter].forEach(e=>{if(n){let t=this.getWidthOfColsInList(e);e.forEach(e=>{t-=e.getActualWidth(),e.setLeft(t,i)})}else{let t=0;e.forEach(e=>{e.setLeft(t,i),t+=e.getActualWidth()})}at(t,e)}),t.forEach(e=>{e.setLeft(null,i)})}setLeftValuesOfGroups(){[this.displayedTreeLeft,this.displayedTreeRight,this.displayedTreeCentre].forEach(e=>{e.forEach(e=>{if(e instanceof g){e.checkLeft()}})})}derivedDisplayedColumnsFromDisplayedTree(e,t){t.length=0,this.columnUtils.depthFirstDisplayedColumnTreeSearch(e,e=>{e instanceof d&&t.push(e)})}extractViewportColumns(){this.suppressColumnVirtualisation?(this.viewportColumnsCenter=this.displayedColumnsCenter,this.headerViewportColumnsCenter=this.displayedColumnsCenter):(this.viewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInRowViewport.bind(this)),this.headerViewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInHeaderViewport.bind(this))),this.viewportColumns=this.viewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight),this.headerViewportColumns=this.headerViewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight)}getVirtualHeaderGroupRow(e,t){let i;switch(e){case"left":i=this.viewportRowLeft[t];break;case"right":i=this.viewportRowRight[t];break;default:i=this.viewportRowCenter[t]}return u(i)&&(i=[]),i}calculateHeaderRows(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={};const a={};this.headerViewportColumns.forEach(e=>a[e.getId()]=!0);const l=(n,r,o)=>{let s=!1;for(let i=0;i<n.length;i++){const e=n[i];let t=!1;if(e instanceof d)t=!0===a[e.getId()];else{const a=e.getDisplayedChildren();a&&(t=l(a,r,o+1))}t&&(s=!0,r[o]||(r[o]=[]),r[o].push(e))}return s};l(this.displayedTreeLeft,this.viewportRowLeft,0),l(this.displayedTreeRight,this.viewportRowRight,0),l(this.displayedTreeCentre,this.viewportRowCenter,0)}extractViewport(){this.extractViewportColumns();const e=this.viewportColumns.map(e=>`${e.getId()}-${e.getPinned()||"normal"}`).join("#"),t=this.viewportColumnsHash!==e;return t&&(this.viewportColumnsHash=e,this.calculateHeaderRows()),t}refreshFlexedColumns(r={}){const o=r.source?r.source:"flex";if(null!=r.viewportWidth&&(this.flexViewportWidth=r.viewportWidth),!this.flexViewportWidth)return[];let i=-1;r.resizingCols&&r.resizingCols.forEach(e=>{const t=this.displayedColumnsCenter.indexOf(e);i<t&&(i=t)});const s=e=>{const t=this.displayedColumnsCenter.indexOf(e)>i;return e.getFlex()&&t},a=this.displayedColumnsCenter.filter(e=>!s(e)),l=this.displayedColumnsCenter.filter(e=>s(e)),c=[];if(!l.length)return[];const u=[];let d;e:for(;;){const r=l.reduce((e,t)=>e+t.getFlex(),0);d=this.flexViewportWidth-this.getWidthOfColsInList(a);for(let n=0;n<l.length;n++){const s=l[n],h=d*s.getFlex()/r;let e=0;const t=s.getMinWidth(),i=s.getMaxWidth();if(C(t)&&h<t?e=t:C(i)&&h>i&&(e=i),e){s.setActualWidth(e,o),st(l,s),c.push(s),a.push(s);continue e}u[n]=Math.round(h)}break}let h=d;return l.forEach((e,t)=>{e.setActualWidth(Math.min(u[t],h),o),c.push(e),h-=u[t]}),r.skipSetLeft||this.setLeftValues(o),r.updateBodyWidths&&this.updateBodyWidths(),r.fireResizedEvent&&this.dispatchColumnResizedEvent(c,!0,o,l),l}sizeColumnsToFit(a,l="sizeColumnsToFit",e,c){var t,u,d,h,f;if(this.shouldQueueResizeOperations)return void this.resizeOperationQueue.push(()=>this.sizeColumnsToFit(a,l,e,c));const p={};c&&(null===(t=null==c?void 0:c.columnLimits)||void 0===t||t.forEach(e=>{var{key:t}=e,i=ii(e,["key"]);p["string"==typeof t?t:t.getColId()]=i}));const g=this.getAllDisplayedColumns(),m=a===this.getWidthOfColsInList(g);if(a<=0||!g.length||m)return;const v=[],y=[];g.forEach(e=>{!0===e.getColDef().suppressSizeToFit?y.push(e):v.push(e)});const b=v.slice(0);let _=!1;const w=e=>{st(v,e),y.push(e)};for(v.forEach(e=>e.resetActualWidth(l));!_;){_=!0;const e=a-this.getWidthOfColsInList(y);if(e<=0)v.forEach(e=>{var t,i;const n=null!==(i=null===(t=null==p?void 0:p[e.getId()])||void 0===t?void 0:t.minWidth)&&void 0!==i?i:null==c?void 0:c.defaultMinWidth;"number"!=typeof n?e.setMinimum(l):e.setActualWidth(n)});else{const a=e/this.getWidthOfColsInList(v);let s=e;for(let o=v.length-1;o>=0;o--){const g=v[o],m=null==p?void 0:p[g.getId()],y=null!==(u=null==m?void 0:m.minWidth)&&void 0!==u?u:null==c?void 0:c.defaultMinWidth,b=null!==(d=null==m?void 0:m.maxWidth)&&void 0!==d?d:null==c?void 0:c.defaultMaxWidth,e=null!==(h=g.getMinWidth())&&void 0!==h?h:0,t=null!==(f=g.getMaxWidth())&&void 0!==f?f:Number.MAX_VALUE,i="number"==typeof y&&y>e?y:g.getMinWidth(),n="number"==typeof b&&b<t?b:g.getMaxWidth();let r=Math.round(g.getActualWidth()*a);C(i)&&r<i?(r=i,w(g),_=!1):C(n)&&r>n?(r=n,w(g),_=!1):0===o&&(r=s),g.setActualWidth(r,l,!0),s-=r}}}b.forEach(e=>{e.fireColumnWidthChangedEvent(l)}),this.setLeftValues(l),this.updateBodyWidths(),e||this.dispatchColumnResizedEvent(b,!0,l)}buildDisplayedTrees(e){const t=[],i=[],n=[];e.forEach(e=>{switch(e.getPinned()){case"left":t.push(e);break;case"right":i.push(e);break;default:n.push(e)}});const r=new kt;this.displayedTreeLeft=this.displayedGroupCreator.createDisplayedGroups(t,this.gridBalancedTree,r,"left",this.displayedTreeLeft),this.displayedTreeRight=this.displayedGroupCreator.createDisplayedGroups(i,this.gridBalancedTree,r,"right",this.displayedTreeRight),this.displayedTreeCentre=this.displayedGroupCreator.createDisplayedGroups(n,this.gridBalancedTree,r,null,this.displayedTreeCentre),this.updateDisplayedMap()}updateDisplayedMap(){this.displayedColumnsAndGroupsMap={};const e=e=>{this.displayedColumnsAndGroupsMap[e.getUniqueId()]=e};this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeCentre,e),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeLeft,e),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeRight,e)}isDisplayed(e){return this.displayedColumnsAndGroupsMap[e.getUniqueId()]===e}updateOpenClosedVisibilityInColumnGroups(){const e=this.getAllDisplayedTrees();this.columnUtils.depthFirstAllColumnTreeSearch(e,e=>{if(e instanceof g){e.calculateDisplayedColumns()}})}getGroupAutoColumns(){return this.groupAutoColumns}createGroupAutoColumnsIfNeeded(){const e=this.forceRecreateAutoGroups;if(this.forceRecreateAutoGroups=!1,!this.autoGroupsNeedBuilding)return!1;this.autoGroupsNeedBuilding=!1;const t=this.gridOptionsService.isGroupUseEntireRow(this.pivotMode),i=this.pivotMode?this.gridOptionsService.is("pivotSuppressAutoColumn"):this.isGroupSuppressAutoColumn();if((this.rowGroupColumns.length>0||this.usingTreeData)&&!i&&!t){const t=this.groupAutoColumns||[],i=this.autoGroupColService.createAutoGroupColumns(t,this.rowGroupColumns);if(!this.autoColsEqual(i,this.groupAutoColumns)||e)return this.groupAutoColumns=i,!0}else this.groupAutoColumns=null;return!1}isGroupSuppressAutoColumn(){const e=this.gridOptionsService.get("groupDisplayType");if(!!e&&Jt("custom",e))return!0;const t=this.gridOptionsService.get("treeDataDisplayType");return!!t&&function(e,t){const i=["auto","custom"];return i.indexOf(t)<0?(console.warn(`AG Grid: '${t}' is not a valid treeDataDisplayType value - possible values are: '${i.join("', '")}'`),!1):t===e}("custom",t)}autoColsEqual(e,t){return it(e,t,(e,t)=>e.getColId()===t.getColId())}getWidthOfColsInList(e){return e.reduce((e,t)=>e+t.getActualWidth(),0)}getGridBalancedTree(){return this.gridBalancedTree}hasFloatingFilters(){if(!this.gridColumns)return!1;return this.gridColumns.some(e=>e.getColDef().floatingFilter)}getFirstDisplayedColumn(){const i=this.gridOptionsService.is("enableRtl"),n=["getDisplayedLeftColumns","getDisplayedCenterColumns","getDisplayedRightColumns"];i&&n.reverse();for(let t=0;t<n.length;t++){const e=this[n[t]]();if(e.length)return i?f(e):e[0]}return null}setColumnHeaderHeight(e,t){if(e.setAutoHeaderHeight(t)){const t={type:y.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,column:e,columns:[e],source:"autosizeColumnHeaderHeight"};this.eventService.dispatchEvent(t)}}getColumnGroupHeaderRowHeight(){return this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight()}getColumnHeaderRowHeight(){const e=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),t=this.getAllDisplayedColumns().filter(e=>e.isAutoHeaderHeight()).map(e=>e.getAutoHeaderHeight()||0);return Math.max(e,...t)}getHeaderHeight(){var e;return null!==(e=this.gridOptionsService.getNum("headerHeight"))&&void 0!==e?e:this.environment.getFromTheme(25,"headerHeight")}getFloatingFiltersHeight(){var e;return null!==(e=this.gridOptionsService.getNum("floatingFiltersHeight"))&&void 0!==e?e:this.getHeaderHeight()}getGroupHeaderHeight(){var e;return null!==(e=this.gridOptionsService.getNum("groupHeaderHeight"))&&void 0!==e?e:this.getHeaderHeight()}getPivotHeaderHeight(){var e;return null!==(e=this.gridOptionsService.getNum("pivotHeaderHeight"))&&void 0!==e?e:this.getHeaderHeight()}getPivotGroupHeaderHeight(){var e;return null!==(e=this.gridOptionsService.getNum("pivotGroupHeaderHeight"))&&void 0!==e?e:this.getGroupHeaderHeight()}queueResizeOperations(){this.shouldQueueResizeOperations=!0}processResizeOperations(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach(e=>e()),this.resizeOperationQueue=[]}resetColumnDefIntoColumn(e){const t=e.getUserProvidedColDef();if(!t)return!1;const i=this.columnFactory.mergeColDefs(t,e.getColId());return e.setColDef(i,t),!0}generateColumnStateForRowGroupAndPivotIndexes(e,t){let v={};const i=(i,t,n,r,o,s)=>{if(!t.length||!this.primaryColumns)return[];const e=Object.keys(i),a=new Set(e),l=new Set(e),c=new Set(t.map(e=>{const t=e.getColId();return l.delete(t),t}).concat(e)),u=[],d={};let h=0;for(let e=0;e<this.primaryColumns.length;e++){const t=this.primaryColumns[e].getColId();c.has(t)&&(u.push(t),d[t]=h++)}let f=1e3,p=!1,g=0;const m=e=>{const t=d[e];for(let e=g;e<t;e++){const t=u[e];l.has(t)&&(i[t][o]=f++,l.delete(t))}g=t};t.forEach(e=>{const t=e.getColId();if(a.has(t))m(t),i[t][o]=f++;else{const a=e.getColDef();if(null===a[o]||void 0===a[o]&&null==a[s]){if(!p){a[n]||void 0===a[n]&&a[r]?m(t):(l.forEach(e=>{i[e][o]=f+d[e]}),f+=u.length,p=!0)}v[t]||(v[t]={colId:t}),v[t][o]=f++}}})};return i(e,this.rowGroupColumns,"rowGroup","initialRowGroup","rowGroupIndex","initialRowGroupIndex"),i(t,this.pivotColumns,"pivot","initialPivot","pivotIndex","initialPivotIndex"),Object.values(v)}};ei([s("expressionService")],ni.prototype,"expressionService",void 0),ei([s("columnFactory")],ni.prototype,"columnFactory",void 0),ei([s("displayedGroupCreator")],ni.prototype,"displayedGroupCreator",void 0),ei([s("ctrlsService")],ni.prototype,"ctrlsService",void 0),ei([s("autoWidthCalculator")],ni.prototype,"autoWidthCalculator",void 0),ei([s("columnUtils")],ni.prototype,"columnUtils",void 0),ei([s("columnAnimationService")],ni.prototype,"columnAnimationService",void 0),ei([s("autoGroupColService")],ni.prototype,"autoGroupColService",void 0),ei([c("aggFuncService")],ni.prototype,"aggFuncService",void 0),ei([c("valueCache")],ni.prototype,"valueCache",void 0),ei([c("animationFrameService")],ni.prototype,"animationFrameService",void 0),ei([s("sortController")],ni.prototype,"sortController",void 0),ei([s("columnDefFactory")],ni.prototype,"columnDefFactory",void 0),ei([r],ni.prototype,"init",null),ei([Ve],ni.prototype,"destroyColumns",null),ei([ti(0,ze("loggerFactory"))],ni.prototype,"setBeans",null),ni=ei([o("columnModel")],ni);var ri=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let oi=class extends p{calculateColMinWidth(e){return null!=e.minWidth?e.minWidth:this.environment.getMinColWidth()}calculateColMaxWidth(e){return null!=e.maxWidth?e.maxWidth:Number.MAX_SAFE_INTEGER}calculateColInitialWidth(e){const t=this.calculateColMinWidth(e),i=this.calculateColMaxWidth(e);let n;const r=ie(e.width),o=ie(e.initialWidth);return n=null!=r?r:null!=o?o:200,Math.max(Math.min(n,i),t)}getOriginalPathForColumn(r,e){const o=[];let s=!1;const a=(i,n)=>{for(let t=0;t<i.length;t++){if(s)return;const e=i[t];if(e instanceof h){a(e.getChildren(),n+1),o[n]=e}else e===r&&(s=!0)}};return a(e,0),s?o:null}depthFirstOriginalTreeSearch(t,e,i){e&&e.forEach(e=>{e instanceof h&&this.depthFirstOriginalTreeSearch(e,e.getChildren(),i),i(e,t)})}depthFirstAllColumnTreeSearch(e,t){e&&e.forEach(e=>{e instanceof g&&this.depthFirstAllColumnTreeSearch(e.getChildren(),t),t(e)})}depthFirstDisplayedColumnTreeSearch(e,t){e&&e.forEach(e=>{e instanceof g&&this.depthFirstDisplayedColumnTreeSearch(e.getDisplayedChildren(),t),t(e)})}};oi=ri([o("columnUtils")],oi);var si=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let ai=class extends p{createDisplayedGroups(e,r,o,s,t){const a=[];let l,c;const u=this.mapOldGroupsById(t);return e.forEach(e=>{const t=this.getOriginalPathForColumn(r,e),i=[],n=!c;for(let e=0;e<t.length;e++)if(n||t[e]!==c[e]){const r=this.createColumnGroup(t[e],o,u,s);i[e]=r,0==e?a.push(r):i[e-1].addChild(r)}else i[e]=l[e];if(0===i.length)a.push(e);else{f(i).addChild(e)}l=i,c=t}),this.setupParentsIntoColumns(a,null),a}createColumnGroup(e,t,i,n){const r=e.getGroupId(),o=t.getInstanceIdForKey(r);let s=i[g.createUniqueId(r,o)];return s&&s.getProvidedColumnGroup()!==e&&(s=null),C(s)?s.reset():(s=new g(e,r,o,n),this.context.createBean(s)),s}mapOldGroupsById(e){const i={},n=e=>{e.forEach(t=>{if(t instanceof g){const e=t;i[t.getUniqueId()]=e,n(e.getChildren())}})};return e&&n(e),i}setupParentsIntoColumns(e,t){e.forEach(e=>{if(e.setParent(t),e instanceof g){const t=e;this.setupParentsIntoColumns(t.getChildren(),t)}})}getOriginalPathForColumn(e,r){const o=[];let s=!1;const a=(i,n)=>{for(let t=0;t<i.length;t++){if(s)return;const e=i[t];e instanceof h?(a(e.getChildren(),n+1),o[n]=e):e===r&&(s=!0)}};return a(e,0),s?o:(console.warn("AG Grid: could not get path"),null)}};ai=si([o("displayedGroupCreator")],ai);var li=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let ci,ui,di,hi,fi,pi,gi,mi,vi=class extends p{constructor(){super(...arguments),this.componentsMappedByName={}}setupComponents(e){e&&e.forEach(e=>this.addComponent(e))}addComponent(e){const t=e.componentName.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase().toUpperCase();this.componentsMappedByName[t]=e.componentClass}getComponentClass(e){return this.componentsMappedByName[e]}};function yi(e,t,i){null==i||""==i?_i(e,t):bi(e,t,i)}function bi(e,t,i){e.setAttribute(wi(t),i.toString())}function _i(e,t){e.removeAttribute(wi(t))}function wi(e){return"aria-"+e}function Ci(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function xi(e){let t;return t="asc"===e?"ascending":"desc"===e?"descending":"mixed"===e?"other":"none",t}function Si(e){return parseInt(e.getAttribute("aria-level"),10)}function Ai(e){return parseInt(e.getAttribute("aria-posinset"),10)}function Ei(e){return e.getAttribute("aria-describedby")||""}function Ti(e,t){yi(e,"label",t)}function Di(e,t){yi(e,"labelledby",t)}function Ri(e,t){yi(e,"description",t)}function Mi(e,t){yi(e,"describedby",t)}function ki(e,t){yi(e,"live",t)}function Oi(e,t){yi(e,"level",t)}function Ni(e,t){yi(e,"disabled",t)}function Ii(e,t){yi(e,"hidden",t)}function Li(e,t){bi(e,"expanded",t)}function Pi(e){_i(e,"expanded")}function Fi(e,t){bi(e,"setsize",t)}function Gi(e,t){bi(e,"posinset",t)}function $i(e,t){bi(e,"multiselectable",t)}function Hi(e,t){bi(e,"rowcount",t)}function Bi(e,t){bi(e,"rowindex",t)}function Vi(e,t){bi(e,"colcount",t)}function ji(e,t){bi(e,"colindex",t)}function zi(e,t){bi(e,"colspan",t)}function Wi(e,t){bi(e,"sort",t)}function Ui(e){_i(e,"sort")}function Yi(e,t){yi(e,"selected",t)}function qi(e,t){bi(e,"checked",void 0===t?"mixed":t)}function Ki(e,t){yi(e,"controls",t.id),Di(t,e.id)}function Xi(e,t){return void 0===t?e("ariaIndeterminate","indeterminate"):!0===t?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}function Zi(){return void 0===ci&&(ci=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),ci}function Qi(){if(void 0===ui)if(Zi()){const e=navigator.userAgent.match(/version\/(\d+)/i);e&&(ui=null!=e[1]?parseFloat(e[1]):0)}else ui=0;return ui}function Ji(){if(void 0===di){const e=window;di=!!e.chrome&&(!!e.chrome.webstore||!!e.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return di}function en(){return void 0===hi&&(hi=/(firefox)/i.test(navigator.userAgent)),hi}function tn(){return void 0===fi&&(fi=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),fi}function nn(){return void 0===pi&&(pi=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),pi}function rn(){return!Zi()||Qi()>=15}function on(e){if(!e)return null;const t=e.tabIndex,i=e.getAttribute("tabIndex");return-1!==t||null!==i&&(""!==i||en())?t.toString():null}function sn(){if(!document.body)return-1;let t=1e6;const i=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,n=document.createElement("div");for(document.body.appendChild(n);;){const e=2*t;if(n.style.height=e+"px",e>i||n.clientHeight!==e)break;t=e}return document.body.removeChild(n),t}function an(){var e,t,i;return null!==(t=null===(e=document.body)||void 0===e?void 0:e.clientWidth)&&void 0!==t?t:window.innerHeight||(null===(i=document.documentElement)||void 0===i?void 0:i.clientWidth)||-1}function ln(){var e,t,i;return null!==(t=null===(e=document.body)||void 0===e?void 0:e.clientHeight)&&void 0!==t?t:window.innerHeight||(null===(i=document.documentElement)||void 0===i?void 0:i.clientHeight)||-1}function cn(){return null==mi&&un(),mi}function un(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let i=t.offsetWidth-t.clientWidth;0===i&&0===t.clientWidth&&(i=null),t.parentNode&&t.parentNode.removeChild(t),null!=i&&(mi=i,gi=0===i)}function dn(){return null==gi&&un(),gi}function hn(e,t){return e.toString().padStart(t,"0")}function fn(t,i){const n=[];for(let e=t;e<=i;e++)n.push(e);return n}function pn(e){return"string"==typeof e&&(e=parseInt(e,10)),"number"==typeof e?Math.floor(e):null}function gn(t,i){let n="";for(let e=0;e<i;e++)n+=String.fromCharCode(255&t),t>>>=8;return n}function mn(e,t,i){return"number"!=typeof e?"":vn(Math.round(100*e)/100,t,i)}function vn(e,t,i){return"number"!=typeof e?"":e.toString().replace(".",i).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+t)}function yn(e){return null==e?null:e.reduce((e,t)=>e+t,0)}function bn(e,t){return e>=0?e:t}function _n(e,t){const i=parseInt(e,10);return!isNaN(i)&&isFinite(i)&&i>0?i:t}function wn(e,t=!0,i="-"){if(!e)return null;let n=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(e=>hn(e,2)).join(i);return t&&(n+=" "+[e.getHours(),e.getMinutes(),e.getSeconds()].map(e=>hn(e,2)).join(":")),n}vi=li([o("agStackComponentsRegistry")],vi);const Cn=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function xn(e,t="YYYY-MM-DD"){const i=hn(e.getFullYear(),4),n=["January","February","March","April","May","June","July","August","September","October","November","December"],r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],o={YYYY:()=>i.slice(i.length-4,i.length),YY:()=>i.slice(i.length-2,i.length),Y:()=>""+e.getFullYear(),MMMM:()=>n[e.getMonth()],MMM:()=>n[e.getMonth()].slice(0,3),MM:()=>hn(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${Cn(e.getMonth()+1)}`,M:()=>""+(e.getMonth()+1),Do:()=>`${e.getDate()}${Cn(e.getDate())}`,DD:()=>hn(e.getDate(),2),D:()=>""+e.getDate(),dddd:()=>r[e.getDay()],ddd:()=>r[e.getDay()].slice(0,3),dd:()=>r[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${Cn(e.getDay())}`,d:()=>""+e.getDay()},s=new RegExp(Object.keys(o).join("|"),"g");return t.replace(s,e=>e in o?o[e]():e)}function Sn(e){if(!e)return null;const[t,i]=e.split(" ");if(!t)return null;const n=t.split("-").map(e=>parseInt(e,10));if(3!==n.filter(e=>!isNaN(e)).length)return null;const[r,o,s]=n,a=new Date(r,o-1,s);if(a.getFullYear()!==r||a.getMonth()!==o-1||a.getDate()!==s)return null;if(!i||"00:00:00"===i)return a;const[l,c,u]=i.split(":").map(e=>parseInt(e,10));return l>=0&&l<24&&a.setHours(l),c>=0&&c<60&&a.setMinutes(c),u>=0&&u<60&&a.setSeconds(u),a}let An;function En(e,t,i){const n=e.parentElement;let r=n&&n.firstChild;for(;r;)t&&r.classList.toggle(t,r===e),i&&r.classList.toggle(i,r!==e),r=r.nextSibling}const Tn="[tabindex], input, select, button, textarea, [href]",Dn=".ag-hidden, .ag-hidden *, [disabled], .ag-disabled:not(.ag-button), .ag-disabled *.mjs";function Rn(e){const t=Element.prototype.matches||Element.prototype.msMatchesSelector,i=t.call(e,"input, select, button, textarea"),n=t.call(e,Dn),r=Wn(e);return i&&!n&&r}function w(e,t,i={}){const{skipAriaHidden:n}=i;e.classList.toggle("ag-hidden",!t),n||Ii(e,!t)}function Mn(e,t,i={}){const{skipAriaHidden:n}=i;e.classList.toggle("ag-invisible",!t),n||Ii(e,!t)}function kn(e,t){const i=t?e=>e.setAttribute("disabled",""):e=>e.removeAttribute("disabled");i(e),fr(e.querySelectorAll("input"),e=>i(e))}function On(e,t,i){let n=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,"number"==typeof i){if(++n>i)break}else if(e===i)break}return!1}function Nn(e){const{height:t,width:i,borderTopWidth:n,borderRightWidth:r,borderBottomWidth:o,borderLeftWidth:s,paddingTop:a,paddingRight:l,paddingBottom:c,paddingLeft:u,marginTop:d,marginRight:h,marginBottom:f,marginLeft:p,boxSizing:g}=window.getComputedStyle(e);return{height:parseFloat(t),width:parseFloat(i),borderTopWidth:parseFloat(n),borderRightWidth:parseFloat(r),borderBottomWidth:parseFloat(o),borderLeftWidth:parseFloat(s),paddingTop:parseFloat(a),paddingRight:parseFloat(l),paddingBottom:parseFloat(c),paddingLeft:parseFloat(u),marginTop:parseFloat(d),marginRight:parseFloat(h),marginBottom:parseFloat(f),marginLeft:parseFloat(p),boxSizing:g}}function In(e){const t=Nn(e);return"border-box"===t.boxSizing?t.height-t.paddingTop-t.paddingBottom:t.height}function Ln(e){const t=Nn(e);return"border-box"===t.boxSizing?t.width-t.paddingLeft-t.paddingRight:t.width}function Pn(e){const t=Nn(e),i=t.marginBottom+t.marginTop;return Math.ceil(e.offsetHeight+i)}function Fn(e){const t=Nn(e),i=t.marginLeft+t.marginRight;return Math.ceil(e.offsetWidth+i)}function Gn(e){const t=e.getBoundingClientRect(),{borderTopWidth:i,borderLeftWidth:n,borderRightWidth:r,borderBottomWidth:o}=Nn(e);return{top:t.top+(i||0),left:t.left+(n||0),right:t.right+(r||0),bottom:t.bottom+(o||0)}}function $n(){if("boolean"==typeof An)return An;const e=document.createElement("div");return e.style.direction="rtl",e.style.width="1px",e.style.height="1px",e.style.position="fixed",e.style.top="0px",e.style.overflow="hidden",e.dir="rtl",e.innerHTML='<div style="width: 2px">\n            <span style="display: inline-block; width: 1px"></span>\n            <span style="display: inline-block; width: 1px"></span>\n        </div>',document.body.appendChild(e),e.scrollLeft=1,An=0===Math.floor(e.scrollLeft),document.body.removeChild(e),An}function Hn(e,t){let i=e.scrollLeft;return t&&(i=Math.abs(i),Ji()&&!$n()&&(i=e.scrollWidth-e.clientWidth-i)),i}function Bn(e,t,i){i&&($n()?t*=-1:(Zi()||Ji())&&(t=e.scrollWidth-e.clientWidth-t)),e.scrollLeft=t}function Vn(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}function jn(e,t){zn(e.querySelector(t))}function zn(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Wn(e){return null!==e.offsetParent}function Un(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function Yn(e,t){e.lastChild?e.insertAdjacentHTML("afterbegin",t):e.innerHTML=t}function qn(e,t){if(e.attributes&&e.attributes[t]){return e.attributes[t].value}return null}function Kn(e){return e&&e.clientHeight?e.clientHeight:0}function Xn(e){return e&&e.clientWidth?e.clientWidth:0}function Zn(e,t,i){if(i&&i.nextSibling===t)return;const n=document.activeElement,r=t.contains(n);i?i.nextSibling?e.insertBefore(t,i.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t),r&&n&&rn()&&n.focus({preventScroll:!0})}function Qn(n,r){for(let i=0;i<r.length;i++){const e=r[i],t=n.children[i];t!==e&&n.insertBefore(e,t)}}function Jn(e,t,i){i?i.insertAdjacentElement("afterend",t):e.firstChild?e.insertAdjacentElement("afterbegin",t):e.appendChild(t)}function er(e,t){C(e.firstChild)?e.insertBefore(t,e.firstChild):e.appendChild(t)}function tr(o,s){if(s)for(const[n,r]of Object.entries(s)){if(!n||!n.length||null==r)continue;const s=Bt(n),e=r.toString(),t=e.replace(/\s*!important/g,""),i=t.length!=e.length?"important":void 0;o.style.setProperty(s,t,i)}}function ir(e){return e.clientWidth<e.scrollWidth}function nr(e){return e.clientHeight<e.scrollHeight}function rr(e,t){"flex"===t?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):or(e,t)}function or(e,t){t=lr(t),e.style.width=t.toString(),e.style.maxWidth=t.toString(),e.style.minWidth=t.toString()}function sr(e,t){"flex"===t?(e.style.removeProperty("height"),e.style.removeProperty("minHeight"),e.style.removeProperty("maxHeight"),e.style.flex="1 1 auto"):ar(e,t)}function ar(e,t){t=lr(t),e.style.height=t.toString(),e.style.maxHeight=t.toString(),e.style.minHeight=t.toString()}function lr(e){return"number"==typeof e?e+"px":e}function cr(e){return e instanceof Node||e instanceof HTMLElement}function ur(e){if(null==e)return[];const t=[];return fr(e,e=>t.push(e)),t}function dr(i,n){if(i)for(let t=0;t<i.length;t++){const e=i[t];n(e.name,e.value)}}function hr(e,t,i){null==i?e.removeAttribute(t):e.setAttribute(t,i.toString())}function fr(t,i){if(null!=t)for(let e=0;e<t.length;e++)i(t[e])}const pr={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"};function gr(e,t,i){const n=mr(e,t,i);if(n){const{className:e}=n;if("string"==typeof e&&e.indexOf("ag-icon")>-1||"object"==typeof e&&e["ag-icon"])return n}const r=document.createElement("span");return r.appendChild(n),r}function mr(t,i,e,n){let r=null;const o=e&&e.getColDef().icons;if(o&&(r=o[t]),i&&!r){const e=i.get("icons");e&&(r=e[t])}if(!r){const i=document.createElement("span");let e=pr[t];return e||(n?e=t:(console.warn("AG Grid: Did not find icon "+t),e="")),i.setAttribute("class","ag-icon ag-icon-"+e),i.setAttribute("unselectable","on"),Ci(i,"presentation"),i}{let e;if("function"==typeof r)e=r();else{if("string"!=typeof r)throw new Error("icon from grid options needs to be a string or a function");e=r}if("string"==typeof e)return Un(e);if(cr(e))return e;console.warn("AG Grid: iconRenderer should return back a string or a dom object")}}class x{}x.BACKSPACE="Backspace",x.TAB="Tab",x.ENTER="Enter",x.ESCAPE="Escape",x.SPACE=" ",x.LEFT="ArrowLeft",x.UP="ArrowUp",x.RIGHT="ArrowRight",x.DOWN="ArrowDown",x.DELETE="Delete",x.F2="F2",x.PAGE_UP="PageUp",x.PAGE_DOWN="PageDown",x.PAGE_HOME="Home",x.PAGE_END="End",x.A="KeyA",x.C="KeyC",x.D="KeyD",x.V="KeyV",x.X="KeyX",x.Y="KeyY",x.Z="KeyZ";function vr(e){if(e.altKey||e.ctrlKey||e.metaKey)return!1;return 1===e.key.length}function yr(e,t,i,n,r){const o=n?n.getColDef().suppressKeyboardEvent:void 0;if(!o)return!1;const s={event:t,editing:r,column:n,api:e.api,node:i,data:i.data,colDef:n.getColDef(),context:e.context,columnApi:e.columnApi};if(o){if(o(s))return!0}return!1}function br(e,t,i,n){const r=n.getDefinition(),o=r&&r.suppressHeaderKeyboardEvent;if(!C(o))return!1;return!!o({api:e.api,columnApi:e.columnApi,context:e.context,colDef:r,column:n,headerRowIndex:i,event:t})}function _r(e){const{keyCode:t}=e;let i;switch(t){case 65:i=x.A;break;case 67:i=x.C;break;case 86:i=x.V;break;case 68:i=x.D;break;case 90:i=x.Z;break;case 89:i=x.Y;break;default:i=e.code}return i}function wr(e,t=!1){return e===x.DELETE||!t&&e===x.BACKSPACE&&tn()}function Cr(e,t,i){if(0===i)return!1;const n=Math.abs(e.clientX-t.clientX),r=Math.abs(e.clientY-t.clientY);return Math.max(n,r)<=i}function xr(t,s){if(!t)return!1;const i=(e,t)=>{const i=s[e.id],n=s[t.id],r=void 0!==i,o=void 0!==n;return r&&o?i-n:!r&&!o?e.__objectId-t.__objectId:r?1:-1};let n,r,o=!1;for(let e=0;e<t.length-1;e++)if(n=t[e],r=t[e+1],i(n,r)>0){o=!0;break}return!!o&&(t.sort(i),!0)}function Sr(e,n){const r=[];!function i(e){if(!e)return;e.forEach(t=>{if(t.group||t.hasChildren()){r.push(t.key);const e=r.join("|");n(t,e),i(t.childrenAfterGroup),r.pop()}})}(e)}function Ar(e){const t=new Set;return e.forEach(e=>t.add(e)),t}const Er=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},i),H),W),Y),n),B),$),z),F),q),K),j),X),U),G),Z),Q),V);class Tr{constructor(e=0,t=1){this.nextValue=e,this.step=t}next(){const e=this.nextValue;return this.nextValue+=this.step,e}peek(){return this.nextValue}skip(e){this.nextValue+=e}}var Dr;!function(e){e[e.IN_PROGRESS=0]="IN_PROGRESS",e[e.RESOLVED=1]="RESOLVED"}(Dr||(Dr={}));class Rr{constructor(e){this.status=Dr.IN_PROGRESS,this.resolution=null,this.waiters=[],e(e=>this.onDone(e),e=>this.onReject(e))}static all(e){return new Rr(i=>{let n=e.length;const r=new Array(n);e.forEach((e,t)=>{e.then(e=>{r[t]=e,n--,0===n&&i(r)})})})}static resolve(t=null){return new Rr(e=>e(t))}then(i){return new Rr(t=>{this.status===Dr.RESOLVED?t(i(this.resolution)):this.waiters.push(e=>t(i(e)))})}resolveNow(e,t){return this.status===Dr.RESOLVED?t(this.resolution):e}onDone(t){this.status=Dr.RESOLVED,this.resolution=t,this.waiters.forEach(e=>e(t))}onReject(e){console.warn("TBI")}}class Mr{constructor(){this.timestamp=(new Date).getTime()}print(e){const t=(new Date).getTime()-this.timestamp;console.info(`${e} = ${t}`),this.timestamp=(new Date).getTime()}}var kr,Or=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e[e.NOTHING=0]="NOTHING",e[e.WAITING_TO_SHOW=1]="WAITING_TO_SHOW",e[e.SHOWING=2]="SHOWING"}(kr||(kr={}));class Nr extends p{constructor(e){super(),this.DEFAULT_SHOW_TOOLTIP_DELAY=2e3,this.DEFAULT_HIDE_TOOLTIP_DELAY=1e4,this.SHOW_QUICK_TOOLTIP_DIFF=1e3,this.FADE_OUT_TOOLTIP_TIMEOUT=1e3,this.state=kr.NOTHING,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1,this.parentComp=e}postConstruct(){this.tooltipShowDelay=this.getTooltipDelay("show")||this.DEFAULT_SHOW_TOOLTIP_DELAY,this.tooltipHideDelay=this.getTooltipDelay("hide")||this.DEFAULT_HIDE_TOOLTIP_DELAY,this.tooltipMouseTrack=this.gridOptionsService.is("tooltipMouseTrack");const e=this.parentComp.getGui();this.addManagedListener(e,"mouseenter",this.onMouseEnter.bind(this)),this.addManagedListener(e,"mouseleave",this.onMouseLeave.bind(this)),this.addManagedListener(e,"mousemove",this.onMouseMove.bind(this)),this.addManagedListener(e,"mousedown",this.onMouseDown.bind(this)),this.addManagedListener(e,"keydown",this.onKeyDown.bind(this))}destroy(){this.setToDoNothing(),super.destroy()}onMouseEnter(e){if(nn())return;if(this.state!=kr.NOTHING)return;const t=this.isLastTooltipHiddenRecently()?200:this.tooltipShowDelay;this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),t),this.lastMouseEvent=e,this.state=kr.WAITING_TO_SHOW}onMouseLeave(){this.setToDoNothing()}onKeyDown(){this.setToDoNothing()}setToDoNothing(){this.state===kr.SHOWING&&this.hideTooltip(),this.clearTimeouts(),this.state=kr.NOTHING}onMouseMove(e){this.lastMouseEvent=e,this.tooltipMouseTrack&&this.state===kr.SHOWING&&this.tooltipComp&&this.positionTooltipUnderLastMouseEvent()}onMouseDown(){this.setToDoNothing()}getTooltipDelay(e){const t=this.gridOptionsService.getNum("tooltipShowDelay"),i=this.gridOptionsService.getNum("tooltipHideDelay"),n="show"===e?t:i,r=Gt(e);return C(n)?(n<0&&l(()=>console.warn(`AG Grid: tooltip${r}Delay should not be lower than 0`),`tooltip${r}DelayWarn`),Math.max(200,n)):null}hideTooltip(){this.tooltipComp&&(this.destroyTooltipComp(),Nr.lastTooltipHideTime=(new Date).getTime()),this.state=kr.NOTHING}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const e=this.tooltipPopupDestroyFunc,t=this.tooltipComp;window.setTimeout(()=>{e(),this.getContext().destroyBean(t)},this.FADE_OUT_TOOLTIP_TIMEOUT),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}isLastTooltipHiddenRecently(){return(new Date).getTime()-Nr.lastTooltipHideTime<this.SHOW_QUICK_TOOLTIP_DIFF}showTooltip(){const e=Object.assign({},this.parentComp.getTooltipParams());if(!C(e.value))return void this.setToDoNothing();this.state=kr.SHOWING,this.tooltipInstanceCount++;const t=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(e).newAgStackInstance().then(t)}newTooltipComponentCallback(e,t){if(this.state!==kr.SHOWING||this.tooltipInstanceCount!==e)return void this.getContext().destroyBean(t);const i=t.getGui();this.tooltipComp=t,i.classList.contains("ag-tooltip")||i.classList.add("ag-tooltip-custom");const n=this.localeService.getLocaleTextFunc(),r=this.popupService.addPopup({eChild:i,ariaLabel:n("ariaLabelTooltip","Tooltip")});r&&(this.tooltipPopupDestroyFunc=r.hideFunc),this.positionTooltipUnderLastMouseEvent(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.tooltipHideDelay)}positionTooltipUnderLastMouseEvent(){this.popupService.positionPopupUnderMouseEvent({type:"tooltip",mouseEvent:this.lastMouseEvent,ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack})}clearTimeouts(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0),this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}}Or([s("popupService")],Nr.prototype,"popupService",void 0),Or([s("userComponentFactory")],Nr.prototype,"userComponentFactory",void 0),Or([r],Nr.prototype,"postConstruct",null);class Ir{constructor(e){this.cssClassStates={},this.getGui=e}addCssClass(e){const t=(e||"").split(" ");if(t.length>1)return void t.forEach(e=>this.addCssClass(e));if(!0!==this.cssClassStates[e]&&e.length){const t=this.getGui();t&&t.classList.add(e),this.cssClassStates[e]=!0}}removeCssClass(e){const t=(e||"").split(" ");if(t.length>1)return void t.forEach(e=>this.removeCssClass(e));if(!1!==this.cssClassStates[e]&&e.length){const t=this.getGui();t&&t.classList.remove(e),this.cssClassStates[e]=!1}}containsCssClass(e){const t=this.getGui();return!!t&&t.classList.contains(e)}addOrRemoveCssClass(t,i){if(!t)return;if(t.indexOf(" ")>=0){const e=(t||"").split(" ");if(e.length>1)return void e.forEach(e=>this.addOrRemoveCssClass(e,i))}if(this.cssClassStates[t]!==i&&t.length){const e=this.getGui();e&&e.classList.toggle(t,i),this.cssClassStates[t]=i}}}var Lr=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};const Pr=new Tr;class S extends p{constructor(e){super(),this.displayed=!0,this.visible=!0,this.compId=Pr.next(),this.cssClassManager=new Ir(()=>this.eGui),e&&this.setTemplate(e)}preConstructOnComponent(){this.usingBrowserTooltips=this.gridOptionsService.is("enableBrowserTooltips")}getCompId(){return this.compId}getTooltipParams(){return{value:this.tooltipText,location:"UNKNOWN"}}setTooltip(e){const t=()=>{this.usingBrowserTooltips?this.getGui().removeAttribute("title"):this.tooltipFeature=this.destroyBean(this.tooltipFeature)},i=()=>{this.usingBrowserTooltips?this.getGui().setAttribute("title",this.tooltipText):this.tooltipFeature=this.createBean(new Nr(this))};this.tooltipText!=e&&(this.tooltipText&&t(),null!=e&&(this.tooltipText=e,this.tooltipText&&i()))}createChildComponentsFromTags(i,n){ur(i.childNodes).forEach(t=>{if(!(t instanceof HTMLElement))return;const e=this.createComponentFromElement(t,e=>{e.getGui()&&this.copyAttributesFromNode(t,e.getGui())},n);if(e){if(e.addItems&&t.children.length){this.createChildComponentsFromTags(t,n);const i=Array.prototype.slice.call(t.children);e.addItems(i)}this.swapComponentForNode(e,i,t)}else t.childNodes&&this.createChildComponentsFromTags(t,n)})}createComponentFromElement(e,t,i){const n=e.nodeName,r=i?i[e.getAttribute("ref")]:void 0,o=this.agStackComponentsRegistry.getComponentClass(n);if(o){S.elementGettingCreated=e;const i=new o(r);return i.setParentComponent(this),this.createBean(i,null,t),i}return null}copyAttributesFromNode(e,i){dr(e.attributes,(e,t)=>i.setAttribute(e,t))}swapComponentForNode(e,t,i){const n=e.getGui();t.replaceChild(n,i),t.insertBefore(document.createComment(i.nodeName),n),this.addDestroyFunc(this.destroyBean.bind(this,e)),this.swapInComponentForQuerySelectors(e,i)}swapInComponentForQuerySelectors(t,i){const n=this;this.iterateOverQuerySelectors(e=>{n[e.attributeName]===i&&(n[e.attributeName]=t)})}iterateOverQuerySelectors(i){let n=Object.getPrototypeOf(this);for(;null!=n;){const e=n.__agComponentMetaData,t=Te(n.constructor);e&&e[t]&&e[t].querySelectors&&e[t].querySelectors.forEach(e=>i(e)),n=Object.getPrototypeOf(n)}}activateTabIndex(e){const t=this.gridOptionsService.getNum("tabIndex")||0;e||(e=[]),e.length||e.push(this.getGui()),e.forEach(e=>e.setAttribute("tabindex",t.toString()))}setTemplate(e,t){const i=Un(e);this.setTemplateFromElement(i,t)}setTemplateFromElement(e,t){this.eGui=e,this.eGui.__agComponent=this,this.wireQuerySelectors(),this.getContext()&&this.createChildComponentsFromTags(this.getGui(),t)}createChildComponentsPreConstruct(){this.getGui()&&this.createChildComponentsFromTags(this.getGui())}wireQuerySelectors(){if(!this.eGui)return;const i=this;this.iterateOverQuerySelectors(t=>{const e=e=>i[t.attributeName]=e;if(t.refSelector&&this.getAttribute("ref")===t.refSelector)e(this.eGui);else{const i=this.eGui.querySelector(t.querySelector);i&&e(i.__agComponent||i)}})}getGui(){return this.eGui}getFocusableElement(){return this.eGui}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}queryForHtmlInputElement(e){return this.eGui.querySelector(e)}appendChild(t,i){if(null!=t)if(i||(i=this.eGui),cr(t))i.appendChild(t);else{const e=t;i.appendChild(e.getGui())}}isDisplayed(){return this.displayed}setVisible(t,i={}){if(t!==this.visible){this.visible=t;const{skipAriaHidden:e}=i;Mn(this.eGui,t,{skipAriaHidden:e})}}setDisplayed(i,n={}){if(i!==this.displayed){this.displayed=i;const{skipAriaHidden:e}=n;w(this.eGui,i,{skipAriaHidden:e});const t={type:S.EVENT_DISPLAYED_CHANGED,visible:this.displayed};this.dispatchEvent(t)}}destroy(){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.parentComponent&&(this.parentComponent=void 0);const e=this.eGui;e&&e.__agComponent&&(e.__agComponent=void 0),super.destroy()}addGuiEventListener(e,t,i){this.eGui.addEventListener(e,t,i),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,t))}addCssClass(e){this.cssClassManager.addCssClass(e)}removeCssClass(e){this.cssClassManager.removeCssClass(e)}containsCssClass(e){return this.cssClassManager.containsCssClass(e)}addOrRemoveCssClass(e,t){this.cssClassManager.addOrRemoveCssClass(e,t)}getAttribute(e){const{eGui:t}=this;return t?t.getAttribute(e):null}getRefElement(e){return this.queryForHtmlElement(`[ref="${e}"]`)}}function Fr(e){return Gr.bind(this,e,void 0)}function A(e){return Gr.bind(this,`[ref=${e}]`,e)}function Gr(e,t,i,n,r){null!==e?"number"!=typeof r?function(e,t,i){const n=function(e,t){e.__agComponentMetaData||(e.__agComponentMetaData={});e.__agComponentMetaData[t]||(e.__agComponentMetaData[t]={});return e.__agComponentMetaData[t]}(e,Te(e.constructor));n[t]||(n[t]=[]);n[t].push(i)}(i,"querySelectors",{attributeName:n,querySelector:e,refSelector:t}):console.error("AG Grid: QuerySelector should be on an attribute"):console.error("AG Grid: QuerySelector selector should not be null")}S.EVENT_DISPLAYED_CHANGED="displayedChanged",Lr([s("agStackComponentsRegistry")],S.prototype,"agStackComponentsRegistry",void 0),Lr([Be],S.prototype,"preConstructOnComponent",null),Lr([Be],S.prototype,"createChildComponentsPreConstruct",null);var $r=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Hr extends S{constructor(){super('\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>\n            </div>')}destroy(){super.destroy()}init(e){this.params=e;const t=this.columnModel.getDisplayNameForColumn(e.column,"header",!0),i=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${i("ariaFilterInput","Filter Input")}`)}onParentModelChanged(i){i?this.params.parentFilterInstance(t=>{if(t.getModelAsString){const e=t.getModelAsString(i);this.eFloatingFilterText.setValue(e)}}):this.eFloatingFilterText.setValue("")}}$r([A("eFloatingFilterText")],Hr.prototype,"eFloatingFilterText",void 0),$r([s("columnModel")],Hr.prototype,"columnModel",void 0);class Br{constructor(t,e,i,n){this.alive=!0,this.context=t,this.eParent=n;e.getDateCompDetails(i).newAgStackInstance().then(e=>{this.alive?(this.dateComp=e,e&&(n.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached(),this.tempValue&&e.setDate(this.tempValue),null!=this.disabled&&this.setDateCompDisabled(this.disabled))):t.destroyBean(e)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){this.dateComp?this.dateComp.setDate(e):this.tempValue=e}setDisabled(e){this.dateComp?this.setDateCompDisabled(e):this.disabled=e}setDisplayed(e){w(this.eParent,e)}setInputPlaceholder(e){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(e)}setInputAriaLabel(e){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(e)}afterGuiAttached(e){this.dateComp&&"function"==typeof this.dateComp.afterGuiAttached&&this.dateComp.afterGuiAttached(e)}setDateCompDisabled(e){null!=this.dateComp&&null!=this.dateComp.setDisabled&&this.dateComp.setDisabled(e)}}class Vr{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions||t,this.mapCustomOptions(),this.selectDefaultItem(e)}getFilterOptions(){return this.filterOptions}mapCustomOptions(){this.filterOptions&&this.filterOptions.forEach(t=>{if("string"==typeof t)return;[["displayKey"],["displayName"],["predicate","test"]].every(e=>!!e.some(e=>null!=t[e])||(console.warn(`AG Grid: ignoring FilterOptionDef as it doesn't contain one of '${e}'`),!1))?this.customFilterOptions[t.displayKey]=t:this.filterOptions=this.filterOptions.filter(e=>e===t)||[]})}selectDefaultItem(e){if(e.defaultOption)this.defaultOption=e.defaultOption;else if(this.filterOptions.length>=1){const e=this.filterOptions[0];"string"==typeof e?this.defaultOption=e:e.displayKey?this.defaultOption=e.displayKey:console.warn("AG Grid: invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else console.warn("AG Grid: no filter options for filter")}getDefaultOption(){return this.defaultOption}getCustomOption(e){return this.customFilterOptions[e]}}const jr={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose One",equals:"Equals",notEqual:"Not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"In range",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equals",greaterThanOrEqual:"Greater than or equals",contains:"Contains",notContains:"Not contains",startsWith:"Starts with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"};var zr=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Wr extends p{constructor(e,t={}){super(),this.eFocusableElement=e,this.callbacks=t,this.callbacks=Object.assign({shouldStopEventPropagation:()=>!1,onTabKeyDown:e=>{if(e.defaultPrevented)return;const t=this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e.shiftKey);t&&(t.focus(),e.preventDefault())}},t)}postConstruct(){this.eFocusableElement.classList.add(Wr.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedListener(this.eFocusableElement,"focusin",this.callbacks.onFocusIn),this.callbacks.onFocusOut&&this.addManagedListener(this.eFocusableElement,"focusout",this.callbacks.onFocusOut)}addKeyDownListeners(e){this.addManagedListener(e,"keydown",e=>{e.defaultPrevented||bt(e)||(this.callbacks.shouldStopEventPropagation(e)?yt(e):e.key===x.TAB?this.callbacks.onTabKeyDown(e):this.callbacks.handleKeyDown&&this.callbacks.handleKeyDown(e))})}}Wr.FOCUS_MANAGED_CLASS="ag-focus-managed",zr([s("focusService")],Wr.prototype,"focusService",void 0),zr([r],Wr.prototype,"postConstruct",null);var Ur=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Yr extends p{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}center(){const{clientHeight:e,clientWidth:t}=this.offsetParent,i=t/2-this.getWidth()/2,n=e/2-this.getHeight()/2;this.offsetElement(i,n)}initialisePosition(){if(this.positioned)return;const{centered:e,forcePopupParentAsOffsetParent:t,minWidth:i,width:n,minHeight:r,height:o,x:s,y:a}=this.config;this.offsetParent||this.setOffsetParent();let l=0,c=0;const u=!!this.element.offsetParent;if(u){const e=this.findBoundaryElement(),t=window.getComputedStyle(e);if(null!=t.minWidth){const i=e.offsetWidth-this.element.offsetWidth;c=parseInt(t.minWidth,10)-i}if(null!=t.minHeight){const i=e.offsetHeight-this.element.offsetHeight;l=parseInt(t.minHeight,10)-i}}if(this.minHeight=r||l,this.minWidth=i||c,n&&this.setWidth(n),o&&this.setHeight(o),n&&o||this.refreshSize(),e)this.center();else if(s||a)this.offsetElement(s,a);else if(u&&t){let e=this.boundaryEl,t=!0;if(e||(e=this.findBoundaryElement(),t=!1),e){const i=parseFloat(e.style.top),n=parseFloat(e.style.left);t?this.offsetElement(isNaN(n)?0:n,isNaN(i)?0:i):this.setPosition(n,i)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;const i=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragService.addDragSource(i),this.moveElementDragListener=i):(this.dragService.removeDragSource(i),this.moveElementDragListener=void 0)}setResizable(r){if(this.clearResizeListeners(),r?this.addResizers():this.removeResizers(),"boolean"==typeof r){if(!1===r)return;r={topLeft:r,top:r,topRight:r,right:r,bottomRight:r,bottom:r,bottomLeft:r,left:r}}Object.keys(r).forEach(t=>{const e=!!r[t],i=this.getResizerElement(t),n={dragStartPixels:0,eElement:i,onDragStart:e=>this.onResizeStart(e,t),onDragging:this.onResize.bind(this),onDragStop:e=>this.onResizeEnd(e,t)};(e||!this.isAlive()&&!e)&&(e?(this.dragService.addDragSource(n),this.resizeListeners.push(n),i.style.pointerEvents="all"):i.style.pointerEvents="none",this.resizable[t]=e)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;-1!==t&&(this.element.style.width=t+"px"),-1!==e&&(this.element.style.height=e+"px")}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,i=this.element;let n=!1;if("string"==typeof e&&-1!==e.indexOf("%"))ar(i,e),e=Pn(i),n=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const t=this.getAvailableHeight();t&&e>t&&(e=t)}this.getHeight()!==e&&(n?(i.style.maxHeight="unset",i.style.minHeight="unset"):t?ar(i,e):(i.style.height=e+"px",i.style.flex="0 0 auto",this.lastSize.height="number"==typeof e?e:parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:i}=this.offsetParent;if(!i)return null;const n=this.element.getBoundingClientRect(),r=this.offsetParent.getBoundingClientRect(),o=e?this.position.y:n.top,s=e?0:r.top;let a=0;if(t){const e=this.element.parentElement;if(e){const{bottom:t}=e.getBoundingClientRect();a=t-n.bottom}}return i+s-o-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:i}=this.config;let n=!1;if("string"==typeof e&&-1!==e.indexOf("%"))or(t,e),e=Fn(t),n=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:t}=this.offsetParent,n=i?this.position.x:this.element.getBoundingClientRect().left;t&&e+n>t&&(e=t-n)}this.getWidth()!==e&&(n?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?or(t,e):(t.style.width=e+"px",t.style.flex=" unset",this.lastSize.width="number"==typeof e?e:parseFloat(e)))}offsetElement(e=0,t=0){const{forcePopupParentAsOffsetParent:i}=this.config,n=i?this.boundaryEl:this.element;n&&(this.popupService.positionPopup({ePopup:n,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t})}),this.setPosition(parseFloat(n.style.left),parseFloat(n.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;const t=()=>{const e=this.getAvailableHeight();this.element.style.setProperty("max-height",e+"px")};e?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),t):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:i,isTop:n,anywhereWithin:r,topBuffer:o}=e,s=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y;return{movementX:this.shouldSkipX(t,!!i,!!r,s)?0:s,movementY:this.shouldSkipY(t,!!n,o,a)?0:a}}shouldSkipX(e,t,i,n){const r=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:r.left;let l=a<=0&&o.left>=e.clientX||o.right<=e.clientX&&o.right<=s.right;return!!l||(l=t?n<0&&e.clientX>a+o.left||n>0&&e.clientX<a+o.left:i?n<0&&e.clientX>s.right||n>0&&e.clientX<a+o.left:n<0&&e.clientX>s.right||n>0&&e.clientX<s.right,l)}shouldSkipY(e,t,i=0,n){const r=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:r.top;let l=a<=0&&o.top>=e.clientY||o.bottom<=e.clientY&&o.bottom<=s.bottom;return!!l||(l=t?n<0&&e.clientY>a+o.top+i||n>0&&e.clientY<a+o.top:n<0&&e.clientY>s.bottom||n>0&&e.clientY<s.bottom,l)}createResizeMap(){const e=this.element;this.resizerMap={topLeft:{element:e.querySelector("[ref=eTopLeftResizer]")},top:{element:e.querySelector("[ref=eTopResizer]")},topRight:{element:e.querySelector("[ref=eTopRightResizer]")},right:{element:e.querySelector("[ref=eRightResizer]")},bottomRight:{element:e.querySelector("[ref=eBottomRightResizer]")},bottom:{element:e.querySelector("[ref=eBottomResizer]")},bottomLeft:{element:e.querySelector("[ref=eBottomLeftResizer]")},left:{element:e.querySelector("[ref=eLeftResizer]")}}}addResizers(){if(this.resizersAdded)return;const e=this.element;if(!e)return;const t=(new DOMParser).parseFromString('<div class="ag-resizer-wrapper">\n        <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>\n        <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>\n        <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>\n        <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>\n        <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>\n        <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>\n        <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>\n        <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>\n    </div>',"text/html").body;e.appendChild(t.firstChild),this.createResizeMap(),this.resizersAdded=!0}removeResizers(){this.resizerMap=void 0;const e=this.element.querySelector(".ag-resizer-wrapper");e&&this.element.removeChild(e),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:i,forcePopupParentAsOffsetParent:n}=this.config;i||n||this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const e=this.element.parentElement;return e?Array.prototype.slice.call(e.children).filter(e=>!e.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const o=this.getSiblings()||[];let s=0,a=0;for(let r=0;r<o.length;r++){const e=o[r],t=!!e.style.flex&&"0 0 auto"!==e.style.flex;if(e===this.element)continue;let i=this.minHeight||0,n=this.minWidth||0;if(t){const o=window.getComputedStyle(e);o.minHeight&&(i=parseInt(o.minHeight,10)),o.minWidth&&(n=parseInt(o.minWidth,10))}else i=e.offsetHeight,n=e.offsetWidth;s+=i,a+=n}return{height:s,width:a}}applySizeToSiblings(i){let n=null;const r=this.getSiblings();if(r){for(let t=0;t<r.length;t++){const e=r[t];e!==n&&(i?e.style.height=e.offsetHeight+"px":e.style.width=e.offsetWidth+"px",e.style.flex="0 0 auto",e===this.element&&(n=r[t+1]))}n&&(n.style.removeProperty("height"),n.style.removeProperty("min-height"),n.style.removeProperty("max-height"),n.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(t){if(!this.isResizing||!this.currentResizer)return;const{popup:i,forcePopupParentAsOffsetParent:n}=this.config,{isTop:r,isRight:e,isBottom:o,isLeft:s}=this.currentResizer,a=e||s,l=o||r,{movementX:c,movementY:u}=this.calculateMouseMovement({e:t,isLeft:s,isTop:r}),d=this.position.x,h=this.position.y;let f=0,p=0;if(a&&c){const t=s?-1:1,i=this.getWidth(),n=i+c*t;let e=!1;s&&(f=i-n,(d+f<=0||n<=this.minWidth)&&(e=!0,f=0)),e||this.setWidth(n)}if(l&&u){const t=r?-1:1,i=this.getHeight(),n=i+u*t;let e=!1;r?(p=i-n,(h+p<=0||n<=this.minHeight)&&(e=!0,p=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&i<n&&this.getMinSizeOfSiblings().height+n>this.element.parentElement.offsetHeight&&(e=!0),e||this.setHeight(n)}this.updateDragStartPosition(t.clientX,t.clientY),((i||n)&&f||p)&&this.offsetElement(d+f,h+p)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null;const i={type:"resize",api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi};this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchEvent(i)}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:i}=this.position;let n;this.config.calculateTopBuffer&&(n=this.config.calculateTopBuffer());const{movementX:r,movementY:o}=this.calculateMouseMovement({e:e,isTop:!0,anywhereWithin:!0,topBuffer:n});this.offsetElement(t+r,i+o),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if("static"!==window.getComputedStyle(e).position)return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const e=this.resizeListeners.pop();this.dragService.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}}Ur([s("popupService")],Yr.prototype,"popupService",void 0),Ur([s("resizeObserverService")],Yr.prototype,"resizeObserverService",void 0),Ur([s("dragService")],Yr.prototype,"dragService",void 0);var qr=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Kr extends S{constructor(e){super(),this.filterNameKey=e,this.applyActive=!1,this.hidePopup=null,this.debouncePending=!1,this.appliedModel=null}postConstruct(){this.resetTemplate(),this.createManagedBean(new Wr(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new Yr(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}handleKeyDown(e){}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return!!this.appliedModel}resetTemplate(e){let t=this.getGui();t&&t.removeEventListener("submit",this.onFormSubmit);const i=`\n            <form class="ag-filter-wrapper">\n                <div class="ag-filter-body-wrapper ag-${this.getCssIdentifier()}-body-wrapper" ref="eFilterBody">\n                    ${this.createBodyTemplate()}\n                </div>\n            </form>`;this.setTemplate(i,e),t=this.getGui(),t&&t.addEventListener("submit",this.onFormSubmit)}isReadOnly(){return!!this.providedFilterParams.readOnly}init(e){this.setParams(e),this.resetUiToDefaults(!0).then(()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}setParams(e){this.providedFilterParams=e,this.applyActive=Kr.isUseApplyButton(e),this.createButtonPanel()}createButtonPanel(){const{buttons:e}=this.providedFilterParams;if(!e||e.length<1||this.isReadOnly())return;const r=document.createElement("div");r.classList.add("ag-filter-apply-panel");const t=e=>{let t,i;switch(e){case"apply":t=this.translate("applyFilter"),i=e=>this.onBtApply(!1,!1,e);break;case"clear":t=this.translate("clearFilter"),i=()=>this.onBtClear();break;case"reset":t=this.translate("resetFilter"),i=()=>this.onBtReset();break;case"cancel":t=this.translate("cancelFilter"),i=e=>{this.onBtCancel(e)};break;default:return void console.warn("AG Grid: Unknown button type specified")}const n=Un(`<button\n                    type="${"apply"===e?"submit":"button"}"\n                    ref="${e}FilterButton"\n                    class="ag-button ag-standard-button ag-filter-apply-panel-button"\n                >${t}\n                </button>`);r.appendChild(n),this.addManagedListener(n,"click",i)};Ar(e).forEach(e=>t(e)),this.getGui().appendChild(r)}getDefaultDebounceMs(){return 0}setupOnBtApplyDebounce(){const e=Kr.getDebounceMs(this.providedFilterParams,this.getDefaultDebounceMs()),t=Ie(this.checkApplyDebounce.bind(this),e);this.onBtApplyDebounce=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}getModel(){return this.appliedModel?this.appliedModel:null}setModel(e){return(null!=e?this.setModelIntoUi(e):this.resetUiToDefaults()).then(()=>{this.updateUiVisibility(),this.applyModel("api")})}onBtCancel(e){this.resetUiToActiveModel(this.getModel(),()=>{this.handleCancelEnd(e)})}handleCancelEnd(e){this.providedFilterParams.closeOnApply&&this.close(e)}resetUiToActiveModel(e,t){const i=()=>{this.onUiChanged(!1,"prevent"),null==t||t()};null!=e?this.setModelIntoUi(e).then(i):this.resetUiToDefaults().then(i)}onBtClear(){this.resetUiToDefaults().then(()=>this.onUiChanged())}onBtReset(){this.onBtClear(),this.onBtApply()}applyModel(e="api"){const t=this.getModelFromUi();if(!this.isModelValid(t))return!1;const i=this.appliedModel;return this.appliedModel=t,!this.areModelsEqual(i,t)}isModelValid(e){return!0}onFormSubmit(e){e.preventDefault()}onBtApply(e=!1,t=!1,i){i&&i.preventDefault(),this.applyModel(t?"rowDataUpdated":"ui")&&this.providedFilterParams.filterChangedCallback({afterFloatingFilter:e,afterDataChange:t});const{closeOnApply:n}=this.providedFilterParams;n&&this.applyActive&&!e&&!t&&this.close(i)}onNewRowsLoaded(){}close(e){if(!this.hidePopup)return;const t=e,i=t&&t.key;let n;"Enter"!==i&&"Space"!==i||(n={keyboardEvent:t}),this.hidePopup(n),this.hidePopup=null}onUiChanged(e=!1,t){if(this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){const e=this.isModelValid(this.getModelFromUi());kn(this.getRefElement("applyFilterButton"),!e)}e&&!t||"immediately"===t?this.onBtApply(e):(this.applyActive||t)&&"debounce"!==t||this.onBtApplyDebounce()}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup),this.refreshFilterResizer(null==e?void 0:e.container)}refreshFilterResizer(e){if(!this.positionableFeature||"toolPanel"===e)return;const t="floatingFilter"===e,{positionableFeature:i,gridOptionsService:n}=this;t?(i.restoreLastSize(),i.setResizable(n.is("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)}static getDebounceMs(e,t){return Kr.isUseApplyButton(e)?(null!=e.debounceMs&&console.warn("AG Grid: debounceMs is ignored when apply button is present"),0):null!=e.debounceMs?e.debounceMs:t}static isUseApplyButton(e){return!!e.buttons&&e.buttons.indexOf("apply")>=0}destroy(){const e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),super.destroy()}translate(e){return this.localeService.getLocaleTextFunc()(e,jr[e])}getCellValue(t){const{api:e,colDef:i,column:n,columnApi:r,context:o}=this.providedFilterParams;return this.providedFilterParams.valueGetter({api:e,colDef:i,column:n,columnApi:r,context:o,data:t.data,getValue:e=>t.data[e],node:t})}getPositionableElement(){return this.eFilterBody}}qr([s("rowModel")],Kr.prototype,"rowModel",void 0),qr([A("eFilterBody")],Kr.prototype,"eFilterBody",void 0),qr([r],Kr.prototype,"postConstruct",null);var Xr=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Zr extends S{constructor(e,t){super(t),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{}}postConstruct(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:i,labelAlignment:n}=this.config;null!=e&&this.setLabelSeparator(e),null!=t&&this.setLabel(t),null!=i&&this.setLabelWidth(i),this.setLabelAlignment(n||this.labelAlignment),this.refreshLabel()}refreshLabel(){Vn(this.eLabel),"string"==typeof this.label?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),""===this.label?(w(this.eLabel,!1),Ci(this.eLabel,"presentation")):(w(this.eLabel,!0),Ci(this.eLabel,null))}setLabelSeparator(e){return this.labelSeparator===e||(this.labelSeparator=e,null!=this.label&&this.refreshLabel()),this}getLabelId(){return this.eLabel.id=this.eLabel.id||`ag-${this.getCompId()}-label`,this.eLabel.id}getLabel(){return this.label}setLabel(e){return this.label===e||(this.label=e,this.refreshLabel()),this}setLabelAlignment(e){const t=this.getGui().classList;return t.toggle("ag-label-align-left","left"===e),t.toggle("ag-label-align-right","right"===e),t.toggle("ag-label-align-top","top"===e),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return null==this.label||rr(this.eLabel,e),this}setDisabled(e){e=!!e;const t=this.getGui();return kn(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}}Xr([r],Zr.prototype,"postConstruct",null);class Qr extends Zr{constructor(e,t,i){super(e,t),this.className=i}postConstruct(){super.postConstruct(),this.className&&this.addCssClass(this.className)}onValueChange(e){return this.addManagedListener(this,Qr.EVENT_CHANGED,()=>e(this.getValue())),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return or(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e||(this.previousValue=this.value,this.value=e,t||this.dispatchEvent({type:Qr.EVENT_CHANGED})),this}}Qr.EVENT_CHANGED="valueChange";var Jr=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class eo extends Qr{constructor(e,t,i,n){super(e,`<div class="ag-picker-field" role="presentation">\n                <div ref="eLabel"></div>\n                <div ref="eWrapper"\n                    class="ag-wrapper ag-picker-field-wrapper"\n                    tabIndex="-1"\n                    aria-expanded="false"\n                    ${n?`role="${n}"`:""}\n                >\n                    <div ref="eDisplayField" class="ag-picker-field-display"></div>\n                    <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                </div>\n            </div>`,t),this.pickerIcon=i,this.isPickerDisplayed=!1,this.isDestroyingPicker=!1,this.skipClick=!1}postConstruct(){super.postConstruct();const e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e),Mi(this.eWrapper,e);const t=()=>{this.skipClick?this.skipClick=!1:this.isDisabled()||(this.pickerComponent=this.showPicker())},i=this.getGui();if(this.addManagedListener(i,"mousedown",e=>{!this.skipClick&&this.pickerComponent&&this.pickerComponent.isAlive()&&Wn(this.pickerComponent.getGui())&&i.contains(e.target)&&(this.skipClick=!0)}),this.addManagedListener(i,"keydown",e=>{switch(e.key){case x.UP:case x.DOWN:case x.ENTER:case x.SPACE:t();case x.ESCAPE:this.isPickerDisplayed&&e.preventDefault()}}),this.addManagedListener(this.eWrapper,"click",t),this.addManagedListener(this.eLabel,"click",t),this.pickerIcon){const e=mr(this.pickerIcon,this.gridOptionsService);e&&this.eIcon.appendChild(e)}}refreshLabel(){C(this.getLabel())?Di(this.eWrapper,this.getLabelId()):this.eWrapper.removeAttribute("aria-labelledby"),super.refreshLabel()}setAriaLabel(e){return Ti(this.eWrapper,e),this}setInputWidth(e){return rr(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}}Jr([A("eLabel")],eo.prototype,"eLabel",void 0),Jr([A("eWrapper")],eo.prototype,"eWrapper",void 0),Jr([A("eDisplayField")],eo.prototype,"eDisplayField",void 0),Jr([A("eIcon")],eo.prototype,"eIcon",void 0);var to=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class io extends S{constructor(e="default"){super(`<div class="ag-list ag-${e}-list" role="listbox"></div>`),this.cssIdentifier=e,this.options=[],this.itemEls=[]}init(){this.addManagedListener(this.getGui(),"keydown",this.handleKeyDown.bind(this))}handleKeyDown(e){const n=e.key;switch(n){case x.ENTER:if(this.highlightedEl){const e=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(e)}else this.setValue(this.getValue());break;case x.DOWN:case x.UP:const t=n===x.DOWN;let i;if(e.preventDefault(),this.highlightedEl){let e=this.itemEls.indexOf(this.highlightedEl)+(t?1:-1);e=Math.min(Math.max(e,0),this.itemEls.length-1),i=this.itemEls[e]}else i=this.itemEls[t?0:this.itemEls.length-1];this.highlightItem(i)}}addOptions(e){return e.forEach(e=>this.addOption(e)),this}addOption(e){const{value:t,text:i}=e,n=$t(i||t);return this.options.push({value:t,text:n}),this.renderOption(t,n),this.updateIndices(),this}updateIndices(){const i=this.getGui().querySelectorAll(".ag-list-item");i.forEach((e,t)=>{Gi(e,t+1),Fi(e,i.length)})}renderOption(e,t){const i=document.createElement("div");Ci(i,"option"),i.classList.add("ag-list-item",`ag-${this.cssIdentifier}-list-item`),i.innerHTML=`<span>${t}</span>`,i.tabIndex=-1,this.itemEls.push(i),this.addManagedListener(i,"mouseover",()=>this.highlightItem(i)),this.addManagedListener(i,"mouseleave",()=>this.clearHighlighted()),this.addManagedListener(i,"click",()=>this.setValue(e)),this.getGui().appendChild(i)}setValue(t,e){if(this.value===t)return this.fireItemSelected(),this;if(null==t)return this.reset(),this;const i=this.options.findIndex(e=>e.value===t);if(-1!==i){const t=this.options[i];this.value=t.value,this.displayValue=null!=t.text?t.text:t.value,this.highlightItem(this.itemEls[i]),e||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const e=this.options.findIndex(e=>e.value===this.value);-1!==e&&this.highlightItem(this.itemEls[e])}reset(){this.value=null,this.displayValue=null,this.clearHighlighted(),this.fireChangeEvent()}highlightItem(e){e.offsetParent&&(this.clearHighlighted(),this.highlightedEl=e,this.highlightedEl.classList.add(io.ACTIVE_CLASS),Yi(this.highlightedEl,!0),this.highlightedEl.focus())}clearHighlighted(){this.highlightedEl&&this.highlightedEl.offsetParent&&(this.highlightedEl.classList.remove(io.ACTIVE_CLASS),Yi(this.highlightedEl,!1),this.highlightedEl=null)}fireChangeEvent(){this.dispatchEvent({type:Qr.EVENT_CHANGED}),this.fireItemSelected()}fireItemSelected(){this.dispatchEvent({type:io.EVENT_ITEM_SELECTED})}}io.EVENT_ITEM_SELECTED="selectedItem",io.ACTIVE_CLASS="ag-active-item",to([r],io.prototype,"init",null);var no=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class ro extends eo{constructor(e){super(e,"ag-select","smallDown","listbox")}init(){this.listComponent=this.createBean(new io("select")),this.listComponent.setParentComponent(this),this.eWrapper.tabIndex=0,this.listComponent.addManagedListener(this.listComponent,io.EVENT_ITEM_SELECTED,()=>{this.hideList&&this.hideList(),this.dispatchEvent({type:ro.EVENT_ITEM_SELECTED})}),this.listComponent.addManagedListener(this.listComponent,Qr.EVENT_CHANGED,()=>{this.setValue(this.listComponent.getValue(),!1,!0),this.hideList&&this.hideList()})}showPicker(){const t=this.listComponent.getGui(),e=this.gridOptionsService.getDocument(),i=this.addManagedListener(e.body,"wheel",e=>{!t.contains(e.target)&&this.hideList&&this.hideList()}),n=this.addManagedListener(t,"focusout",e=>{!t.contains(e.relatedTarget)&&this.hideList&&this.hideList()}),r=this.localeService.getLocaleTextFunc(),o=this.popupService.addPopup({modal:!0,eChild:t,closeOnEsc:!0,closedCallback:()=>{this.hideList=null,this.isPickerDisplayed=!1,n(),i(),this.isAlive()&&(Li(this.eWrapper,!1),this.getFocusableElement().focus())},ariaLabel:r("ariaLabelSelectField","Select Field")});return o&&(this.hideList=o.hideFunc),this.isPickerDisplayed=!0,rr(t,Fn(this.eWrapper)),Li(this.eWrapper,!0),t.style.maxHeight=In(this.popupService.getPopupParent())+"px",t.style.position="absolute",this.popupService.positionPopupByComponent({type:"ag-list",eventSource:this.eWrapper,ePopup:t,position:"under",keepWithinBounds:!0}),this.listComponent.refreshHighlighted(),this.listComponent}addOptions(e){return e.forEach(e=>this.addOption(e)),this}addOption(e){return this.listComponent.addOption(e),this}setValue(e,t,i){if(this.value===e)return this;i||this.listComponent.setValue(e,!0);return this.listComponent.getValue()===this.getValue()?this:(this.eDisplayField.innerHTML=this.listComponent.getDisplayValue(),super.setValue(e,t))}destroy(){this.hideList&&this.hideList(),this.destroyBean(this.listComponent),super.destroy()}}ro.EVENT_ITEM_SELECTED="selectedItem",no([s("popupService")],ro.prototype,"popupService",void 0),no([r],ro.prototype,"init",null);var oo=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class so extends Qr{constructor(e,t,i="text",n="input"){super(e,`\n            <div role="presentation">\n                <div ref="eLabel" class="ag-input-field-label"></div>\n                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">\n                    <${n} ref="eInput" class="ag-input-field-input"></${n}>\n                </div>\n            </div>`,t),this.inputType=i,this.displayFieldTag=n}postConstruct(){super.postConstruct(),this.setInputType(),this.eLabel.classList.add(this.className+"-label"),this.eWrapper.classList.add(this.className+"-input-wrapper"),this.eInput.classList.add(this.className+"-input"),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||`ag-${this.getCompId()}-input`;const{width:e,value:t}=this.config;null!=e&&this.setWidth(e),null!=t&&this.setValue(t),this.addInputListeners(),this.activateTabIndex([this.eInput])}refreshLabel(){C(this.getLabel())?Di(this.eInput,this.getLabelId()):this.eInput.removeAttribute("aria-labelledby"),super.refreshLabel()}addInputListeners(){this.addManagedListener(this.eInput,"input",e=>this.setValue(e.target.value))}setInputType(){"input"===this.displayFieldTag&&this.eInput.setAttribute("type",this.inputType)}getInputElement(){return this.eInput}setInputWidth(e){return rr(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){return this.eInput.maxLength=e,this}setInputPlaceholder(e){return hr(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return Ti(this.eInput,e),this}setDisabled(e){return kn(this.eInput,e),super.setDisabled(e)}}oo([A("eLabel")],so.prototype,"eLabel",void 0),oo([A("eWrapper")],so.prototype,"eWrapper",void 0),oo([A("eInput")],so.prototype,"eInput",void 0);class ao extends so{constructor(e,t="ag-checkbox",i="checkbox"){super(e,t,i),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}addInputListeners(){this.addManagedListener(this.eInput,"click",this.onCheckboxClick.bind(this)),this.addManagedListener(this.eLabel,"click",this.toggle.bind(this))}getNextValue(){return void 0===this.selected||!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){return this.getInputElement().name=e,this}isSelected(){return this.selected}setSelected(e,t){this.isSelected()!==e&&(this.previousValue=this.isSelected(),e=this.selected="boolean"==typeof e?e:void 0,this.eInput.checked=e,this.eInput.indeterminate=void 0===e,t||this.dispatchChange(this.selected,this.previousValue))}dispatchChange(e,t,i){this.dispatchEvent({type:ao.EVENT_CHANGED,selected:e,previousValue:t,event:i});const n=this.getInputElement(),r={type:y.EVENT_CHECKBOX_CHANGED,id:n.id,name:n.name,selected:e,previousValue:t};this.eventService.dispatchEvent(r)}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),i=this.selected=e.target.checked;this.refreshSelectedClass(i),this.dispatchChange(i,t,e)}refreshSelectedClass(e){this.eWrapper.classList.toggle("ag-checked",!0===e),this.eWrapper.classList.toggle("ag-indeterminate",null==e)}}class lo extends ao{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedListener(this.eventService,y.EVENT_CHECKBOX_CHANGED,this.onChange.bind(this))}onChange(e){e.selected&&e.name&&this.eInput.name&&this.eInput.name===e.name&&e.id&&this.eInput.id!==e.id&&this.setValue(!1,!0)}}class co{constructor(e,t){this.localeService=e,this.optionsFactory=t}getModelAsString(r){if(!r)return null;const o=null!=r.operator,s=this.localeService.getLocaleTextFunc();if(o){const o=r;let{conditions:e}=o;if(!e){const{condition1:r,condition2:s}=o;e=[r,s]}const t=e.map(e=>this.getModelAsString(e)),i="AND"===o.operator?"andCondition":"orCondition";return t.join(` ${s(i,jr[i])} `)}if(r.type===E.BLANK||r.type===E.NOT_BLANK)return s(r.type,r.type);{const o=r,e=this.optionsFactory.getCustomOption(o.type),{displayKey:t,displayName:i,numberOfInputs:n}=e||{};return t&&i&&0===n?(s(t,i),i):this.conditionToString(o,e)}}}class E extends Kr{constructor(){super(...arguments),this.eTypes=[],this.eJoinOperatorPanels=[],this.eJoinOperatorsAnd=[],this.eJoinOperatorsOr=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}getNumberOfInputs(e){const t=this.optionsFactory.getCustomOption(e);if(t){const{numberOfInputs:e}=t;return null!=e?e:1}const i=[E.EMPTY,E.NOT_BLANK,E.BLANK];return e&&i.indexOf(e)>=0?0:e===E.IN_RANGE?2:1}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged(!0)}setTypeFromFloatingFilter(i){this.eTypes.forEach((e,t)=>{0===t?e.setValue(i,!0):e.setValue(this.optionsFactory.getDefaultOption(),!0)})}getModelFromUi(){const e=this.getUiCompleteConditions();return 0===e.length?null:this.maxNumConditions>1&&e.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),condition1:e[0],condition2:e[1],conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){return 0===this.eJoinOperatorsOr.length?this.defaultJoinOperator:!0===this.eJoinOperatorsOr[0].getValue()?"OR":"AND"}areModelsEqual(e,t){if(!e&&!t)return!0;if(!e&&t||e&&!t)return!1;const i=!e.operator,n=!t.operator;if(!i&&n||i&&!n)return!1;let r;if(i){const i=e,n=t;r=this.areSimpleModelsEqual(i,n)}else{const i=e,n=t;r=i.operator===n.operator&&it(i.conditions,n.conditions,(e,t)=>this.areSimpleModelsEqual(e,t))}return r}setModelIntoUi(r){if(r.operator){let e=r;e.conditions||(e.conditions=[e.condition1,e.condition2]);const t=this.validateAndUpdateConditions(e.conditions),i=this.getNumConditions();if(t<i)this.removeConditionsAndOperators(t);else if(t>i)for(let e=i;e<t;e++)this.createJoinOperatorPanel(),this.createOption();const n="OR"===e.operator;this.eJoinOperatorsAnd.forEach(e=>e.setValue(!n,!0)),this.eJoinOperatorsOr.forEach(e=>e.setValue(n,!0)),e.conditions.forEach((e,t)=>{this.eTypes[t].setValue(e.type,!0),this.setConditionIntoUi(e,t)})}else{const e=r;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(e.type,!0),this.setConditionIntoUi(e,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),Rr.resolve()}validateAndUpdateConditions(e){let t=e.length;return t>this.maxNumConditions&&(e.splice(this.maxNumConditions),l(()=>console.warn('AG Grid: Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.'),"simpleFilterSetModelMaxNumConditions"),t=this.maxNumConditions),t}doesFilterPass(t){var e;const i=this.getModel();if(null==i)return!0;const{operator:n}=i,r=[];if(n){const t=i;r.push(...null!==(e=t.conditions)&&void 0!==e?e:[])}else r.push(i);return r[n&&"OR"===n?"some":"every"](e=>this.individualConditionPasses(t,e))}setParams(e){super.setParams(e),this.setNumConditions(e),this.defaultJoinOperator=this.getDefaultJoinOperator(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.optionsFactory=new Vr,this.optionsFactory.init(e,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators()}setNumConditions(e){var t,i;null!=e.suppressAndOrCondition&&l(()=>console.warn('AG Grid: Since v29.2 "filterParams.suppressAndOrCondition" is deprecated. Use "filterParams.maxNumConditions = 1" instead.'),"simpleFilterSuppressAndOrCondition"),null!=e.alwaysShowBothConditions&&l(()=>console.warn('AG Grid: Since v29.2 "filterParams.alwaysShowBothConditions" is deprecated. Use "filterParams.numAlwaysVisibleConditions = 2" instead.'),"simpleFilterAlwaysShowBothConditions"),this.maxNumConditions=null!==(t=e.maxNumConditions)&&void 0!==t?t:e.suppressAndOrCondition?1:2,this.maxNumConditions<1&&(l(()=>console.warn('AG Grid: "filterParams.maxNumConditions" must be greater than or equal to zero.'),"simpleFilterMaxNumConditions"),this.maxNumConditions=1),this.numAlwaysVisibleConditions=null!==(i=e.numAlwaysVisibleConditions)&&void 0!==i?i:e.alwaysShowBothConditions?2:1,this.numAlwaysVisibleConditions<1&&(l(()=>console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.'),"simpleFilterNumAlwaysVisibleConditions"),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(l(()=>console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".'),"simpleFilterNumAlwaysVisibleGreaterThanMaxNumConditions"),this.numAlwaysVisibleConditions=this.maxNumConditions)}createOption(){const e=this.createManagedBean(new ro);this.eTypes.push(e),e.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(e.getGui());const t=this.createValueElement();this.eConditionBodies.push(t),this.eFilterBody.appendChild(t),this.putOptionsIntoDropdown(e),this.resetType(e);const i=this.getNumConditions()-1;this.forEachPositionInput(i,e=>this.resetInput(e)),this.addChangedListeners(e,i)}createJoinOperatorPanel(){const e=document.createElement("div");this.eJoinOperatorPanels.push(e),e.classList.add("ag-filter-condition");const t=this.createJoinOperator(this.eJoinOperatorsAnd,e,"and"),i=this.createJoinOperator(this.eJoinOperatorsOr,e,"or");this.eFilterBody.appendChild(e);const n=this.eJoinOperatorPanels.length-1,r=this.joinOperatorId++;this.resetJoinOperatorAnd(t,n,r),this.resetJoinOperatorOr(i,n,r),this.isReadOnly()||(t.onValueChange(this.listener),i.onValueChange(this.listener))}createJoinOperator(e,t,i){const n=this.createManagedBean(new lo);return e.push(n),n.addCssClass("ag-filter-condition-operator"),n.addCssClass("ag-filter-condition-operator-"+i),t.appendChild(n.getGui()),n}getDefaultJoinOperator(e){return"AND"===e||"OR"===e?e:"AND"}createFilterListOptions(){const e=this.optionsFactory.getFilterOptions();this.filterListOptions=e.map(e=>"string"==typeof e?this.createBoilerplateListOption(e):this.createCustomListOption(e))}putOptionsIntoDropdown(t){this.filterListOptions.forEach(e=>{t.addOption(e)}),t.setDisabled(this.filterListOptions.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){const{displayKey:t}=e,i=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:i?this.localeService.getLocaleTextFunc()(i.displayKey,i.displayName):this.translate(t)}}isAllowTwoConditions(){return this.maxNumConditions>=2}createBodyTemplate(){return""}getCssIdentifier(){return"simple-filter"}updateUiVisibility(){const e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){var t;let i=-1,n=!0;for(let e=0;e<this.getNumConditions();e++)this.isConditionUiComplete(e)?i=e:n=!1;if(this.shouldAddNewConditionAtEnd(n))this.createJoinOperatorPanel(),this.createOption();else{const n=null!==(t=this.lastUiCompletePosition)&&void 0!==t?t:this.getNumConditions()-2;if(i<n){this.removeConditionsAndOperators(n+1);const t=i+1,e=n-t;e>0&&this.removeConditionsAndOperators(t,e),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=i}updateConditionStatusesAndValues(r,e){this.eTypes.forEach((e,t)=>{const i=this.isConditionDisabled(t,r);e.setDisabled(i||this.filterListOptions.length<=1),1===t&&(kn(this.eJoinOperatorPanels[0],i),this.eJoinOperatorsAnd[0].setDisabled(i),this.eJoinOperatorsOr[0].setDisabled(i))}),this.eConditionBodies.forEach((e,t)=>{w(e,this.isConditionBodyVisible(t))});const i="OR"===(null!=e?e:this.getJoinOperator());this.eJoinOperatorsAnd.forEach((e,t)=>{e.setValue(!i,!0)}),this.eJoinOperatorsOr.forEach((e,t)=>{e.setValue(i,!0)}),this.forEachInput((e,t,i,n)=>{this.setElementDisplayed(e,t<n),this.setElementDisabled(e,this.isConditionDisabled(i,r))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;this.removeComponents(this.eTypes,e,t),this.removeElements(this.eConditionBodies,e,t),this.removeValueElements(e,t);const i=Math.max(e-1,0);this.removeElements(this.eJoinOperatorPanels,i,t),this.removeComponents(this.eJoinOperatorsAnd,i,t),this.removeComponents(this.eJoinOperatorsOr,i,t)}removeElements(e,t,i){this.removeItems(e,t,i).forEach(e=>zn(e))}removeComponents(e,t,i){this.removeItems(e,t,i).forEach(e=>{zn(e.getGui()),this.destroyBean(e)})}removeItems(e,t,i){return null==i?e.splice(t):e.splice(t,i)}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!e||!e.suppressFocus&&!this.isReadOnly()){const e=this.getInputs(0)[0];if(!e)return;e instanceof so&&e.getInputElement().focus()}}afterGuiDetached(){super.afterGuiDetached();const e=this.getModel();this.areModelsEqual(e,this.getModelFromUi())&&!this.hasInvalidInputs()||this.resetUiToActiveModel(e);let t=-1,i=-1,n=!1;const r=this.getJoinOperator();for(let e=this.getNumConditions()-1;e>=0;e--)if(this.isConditionUiComplete(e))-1===t&&(t=e,i=e);else{const r=e<t;(e>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(e-1)||r)&&(this.removeConditionsAndOperators(e,1),n=!0,r&&i--)}let o=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),o=!0),this.shouldAddNewConditionAtEnd(i===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),o=!0),o&&this.updateConditionStatusesAndValues(i,r),n&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=i}getPlaceholderText(t,i){let n=this.translate(t);if(De(this.filterPlaceholder)){const t=this.filterPlaceholder,e=this.eTypes[i].getValue();n=t({filterOptionKey:e,filterOption:this.translate(e),placeholder:n})}else"string"==typeof this.filterPlaceholder&&(n=this.filterPlaceholder);return n}resetPlaceholder(){const s=this.localeService.getLocaleTextFunc();this.forEachInput((e,t,i,n)=>{if(!(e instanceof so))return;const r=0===t&&n>1?"inRangeStart":0===t?"filterOoo":"inRangeEnd",o=0===t&&n>1?s("ariaFilterFromValue","Filter from value"):0===t?s("ariaFilterValue","Filter Value"):s("ariaFilterToValue","Filter to Value");e.setInputPlaceholder(this.getPlaceholderText(r,i)),e.setInputAriaLabel(o)})}setElementValue(e,t){e instanceof so&&e.setValue(null!=t?String(t):null,!0)}setElementDisplayed(e,t){e instanceof S&&w(e.getGui(),t)}setElementDisabled(e,t){e instanceof S&&kn(e.getGui(),t)}attachElementOnChange(e,t){e instanceof so&&e.onValueChange(t)}forEachInput(i){this.getConditionTypes().forEach((e,t)=>{this.forEachPositionTypeInput(t,e,i)})}forEachPositionInput(e,t){const i=this.getConditionType(e);this.forEachPositionTypeInput(e,i,t)}forEachPositionTypeInput(i,e,n){const r=this.getNumberOfInputs(e),o=this.getInputs(i);for(let t=0;t<o.length;t++){const e=o[t];null!=e&&n(e,t,i,r)}}isConditionDisabled(e,t){return!!this.isReadOnly()||0!==e&&e>t+1}isConditionBodyVisible(e){const t=this.getConditionType(e);return this.getNumberOfInputs(t)>0}isConditionUiComplete(e){if(e>=this.getNumConditions())return!1;return this.getConditionType(e)!==E.EMPTY&&!this.getValues(e).some(e=>null==e)}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const t=[];for(let e=0;e<this.getNumConditions();e++)this.isConditionUiComplete(e)&&t.push(this.createCondition(e));return t}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(e=>this.resetType(e)),this.eJoinOperatorsAnd.forEach((e,t)=>this.resetJoinOperatorAnd(e,t,this.joinOperatorId+t)),this.eJoinOperatorsOr.forEach((e,t)=>this.resetJoinOperatorOr(e,t,this.joinOperatorId+t)),this.joinOperatorId++,this.forEachInput(e=>this.resetInput(e)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,e||this.onUiChanged(),Rr.resolve()}resetType(e){const t=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(t).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,i){this.resetJoinOperator(e,t,this.isDefaultOperator("AND"),this.translate("andCondition"),i)}resetJoinOperatorOr(e,t,i){this.resetJoinOperator(e,t,this.isDefaultOperator("OR"),this.translate("orCondition"),i)}resetJoinOperator(e,t,i,n,r){this.updateJoinOperatorDisabled(e.setValue(i,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${r}`).setLabel(n),t)}updateJoinOperatorsDisabled(){this.eJoinOperatorsAnd.forEach((e,t)=>this.updateJoinOperatorDisabled(e,t)),this.eJoinOperatorsOr.forEach((e,t)=>this.updateJoinOperatorDisabled(e,t))}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,r){const o=this.mapValuesFromModel(e);this.forEachInput((e,t,i,n)=>{i===r&&this.setElementValue(e,null!=o[t]?o[t]:null)})}setValueFromFloatingFilter(r){this.forEachInput((e,t,i,n)=>{this.setElementValue(e,0===t&&0===i?r:null)})}isDefaultOperator(e){return e===this.defaultJoinOperator}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,e=>{this.attachElementOnChange(e,this.listener)}))}individualConditionPasses(e,t){const i=this.getCellValue(e.node),n=this.mapValuesFromModel(t),r=this.optionsFactory.getCustomOption(t.type),o=this.evaluateCustomFilter(r,n,i);return null!=o?o:null==i?this.evaluateNullValue(t.type):this.evaluateNonNullValue(n,i,t,e)}evaluateCustomFilter(e,t,i){if(null==e)return;const{predicate:n}=e;return null==n||t.some(e=>null==e)?void 0:n(t,i)}isBlank(e){return null==e||"string"==typeof e&&0===e.trim().length}hasInvalidInputs(){return!1}}E.EMPTY="empty",E.BLANK="blank",E.NOT_BLANK="notBlank",E.EQUALS="equals",E.NOT_EQUAL="notEqual",E.LESS_THAN="lessThan",E.LESS_THAN_OR_EQUAL="lessThanOrEqual",E.GREATER_THAN="greaterThan",E.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",E.IN_RANGE="inRange",E.CONTAINS="contains",E.NOT_CONTAINS="notContains",E.STARTS_WITH="startsWith",E.ENDS_WITH="endsWith";class T extends E{setParams(e){super.setParams(e),this.scalarFilterParams=e}evaluateNullValue(e){switch(e){case T.EQUALS:case T.NOT_EQUAL:if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case T.GREATER_THAN:case T.GREATER_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case T.LESS_THAN:case T.LESS_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case T.IN_RANGE:if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case T.BLANK:return!0;case T.NOT_BLANK:return!1}return!1}evaluateNonNullValue(e,t,i){const n=this.comparator(),r=null!=e[0]?n(e[0],t):0;switch(i.type){case T.EQUALS:return 0===r;case T.NOT_EQUAL:return 0!==r;case T.GREATER_THAN:return r>0;case T.GREATER_THAN_OR_EQUAL:return r>=0;case T.LESS_THAN:return r<0;case T.LESS_THAN_OR_EQUAL:return r<=0;case T.IN_RANGE:{const i=n(e[1],t);return this.scalarFilterParams.inRangeInclusive?r>=0&&i<=0:r>0&&i<0}case T.BLANK:return this.isBlank(t);case T.NOT_BLANK:return!this.isBlank(t);default:return console.warn('AG Grid: Unexpected type of filter "'+i.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}}}var uo=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class ho extends co{constructor(e,t,i){super(t,i),this.dateFilterParams=e}conditionToString(e,t){const{type:i}=e,{numberOfInputs:n}=t||{},r=i==E.IN_RANGE||2===n,o=Sn(e.dateFrom),s=Sn(e.dateTo),a=this.dateFilterParams.inRangeFloatingFilterDateFormat;if(r){return`${null!==o?xn(o,a):"null"}-${null!==s?xn(s,a):"null"}`}return null!=o?xn(o,a):""+i}}class fo extends T{constructor(){super("dateFilter"),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=1e3,this.maxValidYear=1/0}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}mapValuesFromModel(e){const{dateFrom:t,dateTo:i,type:n}=e||{};return[t&&Sn(t)||null,i&&Sn(i)||null].slice(0,this.getNumberOfInputs(n))}comparator(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)}defaultComparator(e,t){return null==t||t<e?-1:t>e?1:0}setParams(i){this.dateFilterParams=i,super.setParams(i);const e=(e,t)=>{if(null!=i[e]){if(!isNaN(i[e]))return null==i[e]?t:Number(i[e]);console.warn(`AG Grid: DateFilter ${e} is not a number`)}return t};this.minValidYear=e("minValidYear",1e3),this.maxValidYear=e("maxValidYear",1/0),this.minValidYear>this.maxValidYear&&console.warn("AG Grid: DateFilter minValidYear should be <= maxValidYear"),this.filterModelFormatter=new ho(this.dateFilterParams,this.localeService,this.optionsFactory)}createDateCompWrapper(e){const t=new Br(this.getContext(),this.userComponentFactory,{onDateChanged:()=>this.onUiChanged(),filterParams:this.dateFilterParams},e);return this.addDestroyFunc(()=>t.destroy()),t}setElementValue(e,t){e.setDate(t)}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}getDefaultFilterOptions(){return fo.DEFAULT_FILTER_OPTIONS}createValueElement(){const e=document.createElement("div");return e.classList.add("ag-filter-body"),this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e}createFromToElement(e,t,i,n){const r=document.createElement("div");r.classList.add("ag-filter-"+n),r.classList.add("ag-filter-date-"+n),t.push(r),e.appendChild(r),i.push(this.createDateCompWrapper(r))}removeValueElements(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),this.removeItems(this.eConditionPanelsFrom,e,t),this.removeItems(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,i){this.removeItems(e,t,i).forEach(e=>e.destroy())}isConditionUiComplete(r){if(!super.isConditionUiComplete(r))return!1;const o=e=>null!=e&&e.getUTCFullYear()>=this.minValidYear&&e.getUTCFullYear()<=this.maxValidYear;let s=!0;return this.forEachInput((e,t,i,n)=>{i!==r||!s||t>=n||(s=s&&o(e.getDate()))}),s}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}getFilterType(){return"date"}createCondition(e){const t=this.getConditionType(e),i={},n=this.getValues(e);return n.length>0&&(i.dateFrom=wn(n[0])),n.length>1&&(i.dateTo=wn(n[1])),Object.assign({dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:t},i)}resetPlaceholder(){const e=this.localeService.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),i=e("ariaFilterValue","Filter Value");this.forEachInput(e=>{e.setInputPlaceholder(t),e.setInputAriaLabel(i)})}getInputs(e){return e>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[e],this.dateConditionToComps[e]]}getValues(e){const r=[];return this.forEachPositionInput(e,(e,t,i,n)=>{t<n&&r.push(e.getDate())}),r}getModelAsString(e){var t;return null!==(t=this.filterModelFormatter.getModelAsString(e))&&void 0!==t?t:""}}fo.DEFAULT_FILTER_OPTIONS=[T.EQUALS,T.GREATER_THAN,T.LESS_THAN,T.NOT_EQUAL,T.IN_RANGE,T.BLANK,T.NOT_BLANK],uo([s("userComponentFactory")],fo.prototype,"userComponentFactory",void 0);class po extends S{getDefaultDebounceMs(){return 0}destroy(){super.destroy()}isEventFromFloatingFilter(e){return e&&e.afterFloatingFilter}isEventFromDataChange(e){return null==e?void 0:e.afterDataChange}getLastType(){return this.lastType}isReadOnly(){return this.readOnly}setLastTypeFromModel(e){if(!e)return void(this.lastType=this.optionsFactory.getDefaultOption());let t;if(e.operator){t=e.conditions[0]}else t=e;this.lastType=t.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;const t=e;return this.isTypeEditable(t.type)}init(e){this.optionsFactory=new Vr,this.optionsFactory.init(e.filterParams,this.getDefaultFilterOptions()),this.lastType=this.optionsFactory.getDefaultOption(),this.readOnly=!!e.filterParams.readOnly;const t=this.isTypeEditable(this.lastType);this.setEditable(t)}doesFilterHaveSingleInput(e){const t=this.optionsFactory.getCustomOption(e),{numberOfInputs:i}=t||{};return null==i||1==i}isTypeEditable(e){const t=[E.IN_RANGE,E.EMPTY,E.BLANK,E.NOT_BLANK];return!!e&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(e)&&t.indexOf(e)<0}}var go=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class mo extends po{constructor(){super('\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eReadOnlyText"></ag-input-text-field>\n                <div ref="eDateWrapper" style="display: flex;"></div>\n            </div>')}getDefaultFilterOptions(){return fo.DEFAULT_FILTER_OPTIONS}init(e){super.init(e),this.params=e,this.filterParams=e.filterParams,this.createDateComponent();const t=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input")),this.filterModelFormatter=new ho(this.filterParams,this.localeService,this.optionsFactory)}setEditable(e){w(this.eDateWrapper,e),w(this.eReadOnlyText.getGui(),!e)}onParentModelChanged(e,t){if(this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t))return;super.setLastTypeFromModel(e);const i=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(i),i){if(e){const t=e;this.dateComp.setDate(Sn(t.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}onDateChanged(){const i=wn(this.dateComp.getDate());this.params.parentFilterInstance(t=>{if(t){const e=Sn(i);t.onFloatingFilterChanged(this.getLastType()||null,e)}})}createDateComponent(){const e=Kr.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),t={onDateChanged:Ie(this.onDateChanged.bind(this),e),filterParams:this.params.column.getColDef().filterParams};this.dateComp=new Br(this.getContext(),this.userComponentFactory,t,this.eDateWrapper),this.addDestroyFunc(()=>this.dateComp.destroy())}getFilterModelFormatter(){return this.filterModelFormatter}}go([s("userComponentFactory")],mo.prototype,"userComponentFactory",void 0),go([A("eReadOnlyText")],mo.prototype,"eReadOnlyText",void 0),go([A("eDateWrapper")],mo.prototype,"eDateWrapper",void 0);var vo=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class yo extends S{constructor(){super('\n            <div class="ag-filter-filter">\n                <ag-input-text-field class="ag-date-filter" ref="eDateInput"></ag-input-text-field>\n            </div>')}destroy(){super.destroy()}init(t){const i=this.gridOptionsService.getDocument(),e=this.eDateInput.getInputElement(),n=this.shouldUseBrowserDatePicker(t);n&&(e.type="date");const r=n&&Zi();this.addManagedListener(e,"mousedown",()=>{this.eDateInput.isDisabled()||r||e.focus()}),this.addManagedListener(e,"input",e=>{e.target===i.activeElement&&(this.eDateInput.isDisabled()||t.onDateChanged())});const{minValidYear:o,maxValidYear:s}=t.filterParams||{};o&&(e.min=o+"-01-01"),s&&(e.max=s+"-12-31")}getDate(){return Sn(this.eDateInput.getValue())}setDate(e){this.eDateInput.setValue(wn(e,!1))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){e&&e.suppressFocus||this.eDateInput.getInputElement().focus()}shouldUseBrowserDatePicker(e){return e.filterParams&&null!=e.filterParams.browserDatePicker?e.filterParams.browserDatePicker:Ji()||en()||Zi()&&Qi()>=14.1}}vo([A("eDateInput")],yo.prototype,"eDateInput",void 0);class bo extends so{constructor(e,t="ag-text-field",i="text"){super(e,t,i)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){const i=super.setValue(e,t);return this.eInput.value!==e&&(this.eInput.value=C(e)?e:""),i}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){const n=new RegExp(`[${this.config.allowedCharPattern}]`);this.addManagedListener(this.eInput,"keydown",e=>{vr(e)&&e.key&&!n.test(e.key)&&e.preventDefault()}),this.addManagedListener(this.eInput,"paste",e=>{var t;const i=null===(t=e.clipboardData)||void 0===t?void 0:t.getData("text");i&&i.split("").some(e=>!n.test(e))&&e.preventDefault()})}}class _o extends bo{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct(),this.addManagedListener(this.eInput,"blur",()=>{const e=parseFloat(this.eInput.value),t=isNaN(e)?"":this.normalizeValue(e.toString());this.value!==t&&this.setValue(t)}),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this)),this.eInput.step="any"}onWheel(e){document.activeElement===this.eInput&&e.preventDefault()}normalizeValue(e){if(""===e)return"";null!=this.precision&&(e=this.adjustPrecision(e));const t=parseFloat(e);return null!=this.min&&t<this.min?e=this.min.toString():null!=this.max&&t>this.max&&(e=this.max.toString()),e}adjustPrecision(e,t){if(null==this.precision)return e;if(t){const t=parseFloat(e).toFixed(this.precision);return parseFloat(t).toString()}const i=String(e).split(".");if(i.length>1){if(i[1].length<=this.precision)return e;if(this.precision>0)return`${i[0]}.${i[1].slice(0,this.precision)}`}return i[0]}setMin(e){return this.min===e||(this.min=e,hr(this.eInput,"min",e)),this}setMax(e){return this.max===e||(this.max=e,hr(this.eInput,"max",e)),this}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e||(this.step=e,hr(this.eInput,"step",e)),this}setValue(e,t){return this.setValueOrInputValue(e=>super.setValue(e,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(e=>super.setValue(e,!0),e=>{this.eInput.value=e},e)}setValueOrInputValue(t,i,n){if(C(n)){let e=this.isScientificNotation(n);if(e&&this.eInput.validity.valid)return t(n);if(!e){e=(n=this.adjustPrecision(n))!=this.normalizeValue(n)}if(e)return i(n)}return t(n)}getValue(){if(!this.eInput.validity.valid)return;const e=this.eInput.value;return this.isScientificNotation(e)?this.adjustPrecision(e,!0):super.getValue()}isScientificNotation(e){return"string"==typeof e&&e.includes("e")}}class wo extends co{conditionToString(e,t){const{numberOfInputs:i}=t||{};return e.type==E.IN_RANGE||2===i?`${e.filter}-${e.filterTo}`:null!=e.filter?""+e.filter:""+e.type}}function Co(e){const{allowedCharPattern:t}=null!=e?e:{};return null!=t?t:null}class xo extends T{constructor(){super("numberFilter"),this.eValuesFrom=[],this.eValuesTo=[]}mapValuesFromModel(e){const{filter:t,filterTo:i,type:n}=e||{};return[this.processValue(t),this.processValue(i)].slice(0,this.getNumberOfInputs(n))}getDefaultDebounceMs(){return 500}comparator(){return(e,t)=>e===t?0:e<t?1:-1}setParams(e){this.numberFilterParams=e,super.setParams(e),this.filterModelFormatter=new wo(this.localeService,this.optionsFactory)}getDefaultFilterOptions(){return xo.DEFAULT_FILTER_OPTIONS}createValueElement(){const e=Co(this.numberFilterParams),t=document.createElement("div");return t.classList.add("ag-filter-body"),Ci(t,"presentation"),this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,i,n){const r=this.createManagedBean(n?new bo({allowedCharPattern:n}):new _o);r.addCssClass("ag-filter-"+i),r.addCssClass("ag-filter-filter"),t.push(r),e.appendChild(r.getGui())}removeValueElements(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}getValues(e){const r=[];return this.forEachPositionInput(e,(e,t,i,n)=>{t<n&&r.push(this.processValue(this.stringToFloat(e.getValue())))}),r}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getFilterType(){return"number"}processValue(e){return null==e||isNaN(e)?null:e}stringToFloat(e){if("number"==typeof e)return e;let t=J(e);return null!=t&&""===t.trim()&&(t=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(t):null==t||"-"===t.trim()?null:parseFloat(t)}createCondition(e){const t=this.getConditionType(e),i={filterType:this.getFilterType(),type:t},n=this.getValues(e);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getModelAsString(e){var t;return null!==(t=this.filterModelFormatter.getModelAsString(e))&&void 0!==t?t:""}hasInvalidInputs(){let t=!1;return this.forEachInput(e=>{e.getInputElement().validity.valid||(t=!0)}),t}}xo.DEFAULT_FILTER_OPTIONS=[T.EQUALS,T.NOT_EQUAL,T.LESS_THAN,T.LESS_THAN_OR_EQUAL,T.GREATER_THAN,T.GREATER_THAN_OR_EQUAL,T.IN_RANGE,T.BLANK,T.NOT_BLANK];class So extends co{conditionToString(e,t){const{numberOfInputs:i}=t||{};return e.type==E.IN_RANGE||2===i?`${e.filter}-${e.filterTo}`:null!=e.filter?""+e.filter:""+e.type}}class Ao extends E{constructor(){super("textFilter"),this.eValuesFrom=[],this.eValuesTo=[]}static trimInput(e){const t=e&&e.trim();return""===t?e:t}getDefaultDebounceMs(){return 500}setParams(e){this.textFilterParams=e,super.setParams(e),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?Ao.DEFAULT_FORMATTER:Ao.DEFAULT_LOWERCASE_FORMATTER),this.filterModelFormatter=new So(this.localeService,this.optionsFactory)}getTextMatcher(){const n=this.textFilterParams.textCustomComparator;return n?(Er.doOnce(()=>console.warn("AG Grid - textCustomComparator is deprecated, use textMatcher instead."),"textCustomComparator.deprecated"),({filterOption:e,value:t,filterText:i})=>n(e,t,i)):this.textFilterParams.textMatcher||Ao.DEFAULT_MATCHER}createCondition(e){const t=this.getConditionType(e),i={filterType:this.getFilterType(),type:t},n=this.getValues(e);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i}getFilterType(){return"text"}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getValues(e){const r=[];return this.forEachPositionInput(e,(e,t,i,n)=>{if(t<n){const t=J(e.getValue()),i=(this.textFilterParams.trimInput?Ao.trimInput(t):t)||null;r.push(i),e.setValue(i,!0)}}),r}getDefaultFilterOptions(){return Ao.DEFAULT_FILTER_OPTIONS}createValueElement(){const e=document.createElement("div");return e.classList.add("ag-filter-body"),Ci(e,"presentation"),this.createFromToElement(e,this.eValuesFrom,"from"),this.createFromToElement(e,this.eValuesTo,"to"),e}createFromToElement(e,t,i){const n=this.createManagedBean(new bo);n.addCssClass("ag-filter-"+i),n.addCssClass("ag-filter-filter"),t.push(n),e.appendChild(n.getGui())}removeValueElements(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}mapValuesFromModel(e){const{filter:t,filterTo:i,type:n}=e||{};return[t||null,i||null].slice(0,this.getNumberOfInputs(n))}evaluateNullValue(e){const t=[E.NOT_EQUAL,E.NOT_CONTAINS,E.BLANK];return!!e&&t.indexOf(e)>=0}evaluateNonNullValue(e,t,i,n){const r=e.map(e=>this.formatter(e))||[],o=this.formatter(t),{api:s,colDef:a,column:l,columnApi:c,context:u,textFormatter:d}=this.textFilterParams;if(i.type===E.BLANK)return this.isBlank(t);if(i.type===E.NOT_BLANK)return!this.isBlank(t);const h={api:s,colDef:a,column:l,columnApi:c,context:u,node:n.node,data:n.data,filterOption:i.type,value:o,textFormatter:d};return r.some(e=>this.matcher(Object.assign(Object.assign({},h),{filterText:e})))}getModelAsString(e){var t;return null!==(t=this.filterModelFormatter.getModelAsString(e))&&void 0!==t?t:""}}Ao.DEFAULT_FILTER_OPTIONS=[E.CONTAINS,E.NOT_CONTAINS,E.EQUALS,E.NOT_EQUAL,E.STARTS_WITH,E.ENDS_WITH,E.BLANK,E.NOT_BLANK],Ao.DEFAULT_FORMATTER=e=>e,Ao.DEFAULT_LOWERCASE_FORMATTER=e=>null==e?null:e.toString().toLowerCase(),Ao.DEFAULT_MATCHER=({filterOption:e,value:t,filterText:i})=>{if(null==i)return!1;switch(e){case Ao.CONTAINS:return t.indexOf(i)>=0;case Ao.NOT_CONTAINS:return t.indexOf(i)<0;case Ao.EQUALS:return t===i;case Ao.NOT_EQUAL:return t!=i;case Ao.STARTS_WITH:return 0===t.indexOf(i);case Ao.ENDS_WITH:const e=t.lastIndexOf(i);return e>=0&&e===t.length-i.length;default:return!1}};var Eo=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class To extends p{constructor(e){super(),this.params=e}setupGui(e){this.eFloatingFilterTextInput=this.createManagedBean(new bo(this.params.config)),this.eFloatingFilterTextInput.setInputAriaLabel(this.params.ariaLabel),e.appendChild(this.eFloatingFilterTextInput.getGui())}setEditable(e){this.eFloatingFilterTextInput.setDisabled(!e)}getValue(){return this.eFloatingFilterTextInput.getValue()}setValue(e,t){this.eFloatingFilterTextInput.setValue(e,t)}addValueChangedListener(e){const t=this.eFloatingFilterTextInput.getGui();this.addManagedListener(t,"input",e),this.addManagedListener(t,"keydown",e)}}class Do extends po{postConstruct(){this.setTemplate('\n            <div class="ag-floating-filter-input" role="presentation" ref="eFloatingFilterInputContainer"></div>\n        ')}getDefaultDebounceMs(){return 500}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(e)))}init(e){this.params=e;const t=`${this.columnModel.getDisplayNameForColumn(e.column,"header",!0)} ${this.localeService.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`;if(this.floatingFilterInputService=this.createFloatingFilterInputService(t),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer),super.init(e),this.applyActive=Kr.isUseApplyButton(this.params.filterParams),!this.isReadOnly()){const e=Kr.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),t=Ie(this.syncUpWithParentFilter.bind(this),e);this.floatingFilterInputService.addValueChangedListener(t)}}syncUpWithParentFilter(e){const t=e.key===x.ENTER;if(this.applyActive&&!t)return;let i=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(i=Ao.trimInput(i),this.floatingFilterInputService.setValue(i,!0)),this.params.parentFilterInstance(e=>{e&&e.onFloatingFilterChanged(this.getLastType()||null,i||null)})}setEditable(e){this.floatingFilterInputService.setEditable(e)}}Eo([s("columnModel")],Do.prototype,"columnModel",void 0),Eo([A("eFloatingFilterInputContainer")],Do.prototype,"eFloatingFilterInputContainer",void 0),Eo([r],Do.prototype,"postConstruct",null);class Ro extends p{constructor(e){super(),this.params=e,this.numberInputActive=!0}setupGui(e){this.eFloatingFilterNumberInput=this.createManagedBean(new _o),this.eFloatingFilterTextInput=this.createManagedBean(new bo),this.eFloatingFilterTextInput.setDisabled(!0),this.eFloatingFilterNumberInput.setInputAriaLabel(this.params.ariaLabel),this.eFloatingFilterTextInput.setInputAriaLabel(this.params.ariaLabel),e.appendChild(this.eFloatingFilterNumberInput.getGui()),e.appendChild(this.eFloatingFilterTextInput.getGui())}setEditable(e){this.numberInputActive=e,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput}addValueChangedListener(e){this.setupListeners(this.eFloatingFilterNumberInput.getGui(),e),this.setupListeners(this.eFloatingFilterTextInput.getGui(),e)}setupListeners(e,t){this.addManagedListener(e,"input",t),this.addManagedListener(e,"keydown",t)}}class Mo extends Do{init(e){super.init(e),this.filterModelFormatter=new wo(this.localeService,this.optionsFactory)}getDefaultFilterOptions(){return xo.DEFAULT_FILTER_OPTIONS}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(e){const t=Co(this.params.filterParams);return t?this.createManagedBean(new To({config:{allowedCharPattern:t},ariaLabel:e})):this.createManagedBean(new Ro({ariaLabel:e}))}}class ko extends Do{init(e){super.init(e),this.filterModelFormatter=new So(this.localeService,this.optionsFactory)}getDefaultFilterOptions(){return Ao.DEFAULT_FILTER_OPTIONS}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(e){return this.createManagedBean(new To({ariaLabel:e}))}}class D{constructor(e,t=!1){this.destroyFuncs=[],this.touching=!1,this.eventService=new qe,this.eElement=e,this.preventMouseClick=t;const i=this.onTouchStart.bind(this),n=this.onTouchMove.bind(this),r=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",i,{passive:!0}),this.eElement.addEventListener("touchmove",n,{passive:!0}),this.eElement.addEventListener("touchend",r,{passive:!1}),this.destroyFuncs.push(()=>{this.eElement.removeEventListener("touchstart",i,{passive:!0}),this.eElement.removeEventListener("touchmove",n,{passive:!0}),this.eElement.removeEventListener("touchend",r,{passive:!1})})}getActiveTouch(t){for(let e=0;e<t.length;e++){if(t[e].identifier===this.touchStart.identifier)return t[e]}return null}addEventListener(e,t){this.eventService.addEventListener(e,t)}removeEventListener(e,t){this.eventService.removeEventListener(e,t)}onTouchStart(t){if(this.touching)return;this.touchStart=t.touches[0],this.touching=!0,this.moved=!1;const i=this.touchStart;window.setTimeout(()=>{const e=this.touchStart===i;if(this.touching&&e&&!this.moved){this.moved=!0;const i={type:D.EVENT_LONG_TAP,touchStart:this.touchStart,touchEvent:t};this.eventService.dispatchEvent(i)}},500)}onTouchMove(e){if(!this.touching)return;const t=this.getActiveTouch(e.touches);if(!t)return;!Cr(t,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(e){if(this.touching){if(!this.moved){const e={type:D.EVENT_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(e),this.checkForDoubleTap()}this.preventMouseClick&&e.cancelable&&e.preventDefault(),this.touching=!1}}checkForDoubleTap(){const e=(new Date).getTime();if(this.lastTapTime&&this.lastTapTime>0){if(e-this.lastTapTime>D.DOUBLE_TAP_MILLIS){const e={type:D.EVENT_DOUBLE_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(e),this.lastTapTime=null}else this.lastTapTime=e}else this.lastTapTime=e}destroy(){this.destroyFuncs.forEach(e=>e())}}D.EVENT_TAP="tap",D.EVENT_DOUBLE_TAP="doubleTap",D.EVENT_LONG_TAP="longTap",D.DOUBLE_TAP_MILLIS=500;var Oo=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class No extends S{constructor(e){super(),e||this.setTemplate(No.TEMPLATE)}attachCustomElements(e,t,i,n,r){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=i,this.eSortMixed=n,this.eSortNone=r}setupSort(e,t=!1){this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator();!!this.column.getColDef().sortable&&(this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e),this.addManagedListener(this.eventService,y.EVENT_SORT_CHANGED,()=>this.onSortChanged()),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.onSortChanged()),this.onSortChanged())}addInIcon(e,t,i){if(null==t)return;const n=mr(e,this.gridOptionsService,i);n&&t.appendChild(n)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const i=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){const e="asc"===i;w(this.eSortAsc,e,{skipAriaHidden:!0})}if(this.eSortDesc){const e="desc"===i;w(this.eSortDesc,e,{skipAriaHidden:!0})}if(this.eSortNone){const e=!this.column.getColDef().unSortIcon&&!this.gridOptionsService.is("unSortIcon"),t=null==i;w(this.eSortNone,!e&&t,{skipAriaHidden:!0})}}setupMultiSortIndicator(){this.addInIcon("sortUnSort",this.eSortMixed,this.column);const e=this.column.getColDef().showRowGroup;this.gridOptionsService.isColumnsSortingCoupledToGroup()&&e&&(this.addManagedListener(this.eventService,y.EVENT_SORT_CHANGED,()=>this.updateMultiSortIndicator()),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.updateMultiSortIndicator()),this.updateMultiSortIndicator())}updateMultiSortIndicator(){if(this.eSortMixed){const e="mixed"===this.sortController.getDisplaySortForColumn(this.column);w(this.eSortMixed,e,{skipAriaHidden:!0})}}updateSortOrder(){var e;if(!this.eSortOrder)return;const t=this.sortController.getColumnsWithSortingOrdered(),i=null!==(e=this.sortController.getDisplaySortIndexForColumn(this.column))&&void 0!==e?e:-1,n=t.some(e=>{var t;return null!==(t=this.sortController.getDisplaySortIndexForColumn(e))&&void 0!==t&&t}),r=i>=0&&n;w(this.eSortOrder,r,{skipAriaHidden:!0}),i>=0?this.eSortOrder.innerHTML=(i+1).toString():Vn(this.eSortOrder)}}No.TEMPLATE='<span class="ag-sort-indicator-container">\n            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"></span>\n        </span>',Oo([A("eSortOrder")],No.prototype,"eSortOrder",void 0),Oo([A("eSortAsc")],No.prototype,"eSortAsc",void 0),Oo([A("eSortDesc")],No.prototype,"eSortDesc",void 0),Oo([A("eSortMixed")],No.prototype,"eSortMixed",void 0),Oo([A("eSortNone")],No.prototype,"eSortNone",void 0),Oo([s("columnModel")],No.prototype,"columnModel",void 0),Oo([s("sortController")],No.prototype,"sortController",void 0);var Io=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Lo extends S{constructor(){super(...arguments),this.lastMovingChanged=0}destroy(){super.destroy()}refresh(e){return this.params=e,this.workOutTemplate()==this.currentTemplate&&(this.workOutShowMenu()==this.currentShowMenu&&(this.workOutSort()==this.currentSort&&(this.setDisplayName(e),!0)))}workOutTemplate(){let e=et(this.params.template,Lo.TEMPLATE);return e=e&&e.trim?e.trim():e,e}init(e){this.params=e,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate),this.setupTap(),this.setupIcons(e.column),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setDisplayName(e)}setDisplayName(t){if(this.currentDisplayName!=t.displayName){this.currentDisplayName=t.displayName;const e=$t(this.currentDisplayName);this.eText&&(this.eText.innerHTML=e)}}setupIcons(e){this.addInIcon("menu",this.eMenu,e),this.addInIcon("filter",this.eFilter,e)}addInIcon(e,t,i){if(null==t)return;const n=mr(e,this.gridOptionsService,i);n&&t.appendChild(n)}setupTap(){const{gridOptionsService:t}=this;if(t.is("suppressTouch"))return;const e=new D(this.getGui(),!0),i=t.is("suppressMenuHide"),n=i&&C(this.eMenu),r=n?new D(this.eMenu,!0):e;if(this.params.enableMenu){const e=n?"EVENT_TAP":"EVENT_LONG_TAP",i=e=>{t.api.showColumnMenuAfterMouseClick(this.params.column,e.touchStart)};this.addManagedListener(r,D[e],i)}if(this.params.enableSorting){const t=e=>{const t=e.touchStart.target;i&&this.eMenu.contains(t)||this.sortController.progressSort(this.params.column,!1,"uiColumnSorted")};this.addManagedListener(e,D.EVENT_TAP,t)}this.addDestroyFunc(()=>e.destroy()),n&&this.addDestroyFunc(()=>r.destroy())}workOutShowMenu(){const e=!this.gridOptionsService.is("suppressMenuHide"),t=nn()&&e;return this.params.enableMenu&&!t}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu)return void zn(this.eMenu);const e=this.gridOptionsService.is("suppressMenuHide");this.addManagedListener(this.eMenu,"click",()=>this.showMenu(this.eMenu)),this.eMenu.classList.toggle("ag-header-menu-always-show",e)}showMenu(e){e||(e=this.eMenu),this.menuFactory.showMenuAfterButtonClick(this.params.column,e,"columnMenu")}workOutSort(){return this.params.enableSorting}setupSort(){if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.context.createBean(new No(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),!this.currentSort)return;const n="ctrl"===this.gridOptionsService.get("multiSortKey");this.addManagedListener(this.params.column,d.EVENT_MOVING_CHANGED,()=>{this.lastMovingChanged=(new Date).getTime()}),this.eLabel&&this.addManagedListener(this.eLabel,"click",e=>{const t=this.params.column.isMoving(),i=(new Date).getTime()-this.lastMovingChanged<50;if(!(t||i)){const t=n?e.ctrlKey||e.metaKey:e.shiftKey;this.params.progressSort(t)}});const e=()=>{if(this.addOrRemoveCssClass("ag-header-cell-sorted-asc",this.params.column.isSortAscending()),this.addOrRemoveCssClass("ag-header-cell-sorted-desc",this.params.column.isSortDescending()),this.addOrRemoveCssClass("ag-header-cell-sorted-none",this.params.column.isSortNone()),this.params.column.getColDef().showRowGroup){const e=this.columnModel.getSourceColumnsForGroupColumn(this.params.column),t=!(null==e?void 0:e.every(e=>this.params.column.getSort()==e.getSort()));this.addOrRemoveCssClass("ag-header-cell-sorted-mixed",t)}};this.addManagedListener(this.eventService,y.EVENT_SORT_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,e)}setupFilterIcon(){this.eFilter&&(this.addManagedListener(this.params.column,d.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.onFilterChanged())}onFilterChanged(){const e=this.params.column.isFilterActive();w(this.eFilter,e,{skipAriaHidden:!0})}}Lo.TEMPLATE='<div class="ag-cell-label-container" role="presentation">\n            <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n            <div ref="eLabel" class="ag-header-cell-label" role="presentation">\n                <span ref="eText" class="ag-header-cell-text"></span>\n                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>\n                <ag-sort-indicator ref="eSortIndicator"></ag-sort-indicator>\n            </div>\n        </div>',Io([s("sortController")],Lo.prototype,"sortController",void 0),Io([s("menuFactory")],Lo.prototype,"menuFactory",void 0),Io([s("columnModel")],Lo.prototype,"columnModel",void 0),Io([A("eFilter")],Lo.prototype,"eFilter",void 0),Io([A("eSortIndicator")],Lo.prototype,"eSortIndicator",void 0),Io([A("eMenu")],Lo.prototype,"eMenu",void 0),Io([A("eLabel")],Lo.prototype,"eLabel",void 0),Io([A("eText")],Lo.prototype,"eText",void 0),Io([A("eSortOrder")],Lo.prototype,"eSortOrder",void 0),Io([A("eSortAsc")],Lo.prototype,"eSortAsc",void 0),Io([A("eSortDesc")],Lo.prototype,"eSortDesc",void 0),Io([A("eSortMixed")],Lo.prototype,"eSortMixed",void 0),Io([A("eSortNone")],Lo.prototype,"eSortNone",void 0);var Po=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Fo extends S{constructor(){super(Fo.TEMPLATE)}destroy(){super.destroy()}init(e){this.params=e,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()}checkWarnings(){if(this.params.template){const e="AG Grid: A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)";l(()=>console.warn(e),"HeaderGroupComp.templateNotSupported")}}setupExpandIcons(){this.addInIcon("columnGroupOpened","agOpened"),this.addInIcon("columnGroupClosed","agClosed");const e=e=>{if(bt(e))return;const t=!this.params.columnGroup.isExpanded();this.columnModel.setColumnGroupOpened(this.params.columnGroup.getProvidedColumnGroup(),t,"uiColumnExpanded")};this.addTouchAndClickListeners(this.eCloseIcon,e),this.addTouchAndClickListeners(this.eOpenIcon,e);const t=e=>{yt(e)};this.addManagedListener(this.eCloseIcon,"dblclick",t),this.addManagedListener(this.eOpenIcon,"dblclick",t),this.addManagedListener(this.getGui(),"dblclick",e),this.updateIconVisibility();const i=this.params.columnGroup.getProvidedColumnGroup();this.addManagedListener(i,h.EVENT_EXPANDED_CHANGED,this.updateIconVisibility.bind(this)),this.addManagedListener(i,h.EVENT_EXPANDABLE_CHANGED,this.updateIconVisibility.bind(this))}addTouchAndClickListeners(e,t){const i=new D(e,!0);this.addManagedListener(i,D.EVENT_TAP,t),this.addDestroyFunc(()=>i.destroy()),this.addManagedListener(e,"click",t)}updateIconVisibility(){if(this.params.columnGroup.isExpandable()){const e=this.params.columnGroup.isExpanded();w(this.eOpenIcon,e),w(this.eCloseIcon,!e)}else w(this.eOpenIcon,!1),w(this.eCloseIcon,!1)}addInIcon(e,t){const i=mr(e,this.gridOptionsService,null);i&&this.getRefElement(t).appendChild(i)}addGroupExpandIcon(){if(!this.params.columnGroup.isExpandable())return w(this.eOpenIcon,!1),void w(this.eCloseIcon,!1)}setupLabel(){var e;const{displayName:t,columnGroup:i}=this.params;if(C(t)){const e=$t(t);this.getRefElement("agLabel").innerHTML=e}this.addOrRemoveCssClass("ag-sticky-label",!(null===(e=i.getColGroupDef())||void 0===e?void 0:e.suppressStickyLabel))}}Fo.TEMPLATE='<div class="ag-header-group-cell-label" ref="agContainer" role="presentation">\n            <span ref="agLabel" class="ag-header-group-text" role="presentation"></span>\n            <span ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>\n            <span ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>\n        </div>',Po([s("columnModel")],Fo.prototype,"columnModel",void 0),Po([A("agOpened")],Fo.prototype,"eOpenIcon",void 0),Po([A("agClosed")],Fo.prototype,"eCloseIcon",void 0);class Go extends S{isPopup(){return!0}setParentComponent(e){e.addCssClass("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}}var $o=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Ho extends Go{constructor(){super(Ho.TEMPLATE)}init(e){this.params=e,this.focusAfterAttached=e.cellStartedEdit,this.eTextArea.setMaxLength(e.maxLength||200).setCols(e.cols||60).setRows(e.rows||10),C(e.value,!0)&&this.eTextArea.setValue(e.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}onKeyDown(e){const t=e.key;(t===x.LEFT||t===x.UP||t===x.RIGHT||t===x.DOWN||e.shiftKey&&t===x.ENTER)&&e.stopPropagation()}afterGuiAttached(){const e=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(e("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()}getValue(){const e=this.eTextArea.getValue();return C(e)||C(this.params.value)?this.params.parseValue(e):this.params.value}}Ho.TEMPLATE='<div class="ag-large-text">\n            <ag-input-text-area ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>\n        </div>',$o([A("eTextArea")],Ho.prototype,"eTextArea",void 0);var Bo=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Vo extends Go{constructor(){super('<div class="ag-cell-edit-wrapper"><ag-select class="ag-cell-editor" ref="eSelect"></ag-select></div>'),this.startedByEnter=!1}init(r){if(this.focusAfterAttached=r.cellStartedEdit,u(r.values))return void console.warn("AG Grid: no values found for select cellEditor");this.startedByEnter=null!=r.eventKey&&r.eventKey===x.ENTER;let o=!1;r.values.forEach(e=>{const t={value:e},i=this.valueFormatterService.formatValue(r.column,null,e),n=null!=i;t.text=n?i:e,this.eSelect.addOption(t),o=o||r.value===e}),o?this.eSelect.setValue(r.value,!0):r.values.length&&this.eSelect.setValue(r.values[0],!0),"fullRow"!==this.gridOptionsService.get("editType")&&this.addManagedListener(this.eSelect,ro.EVENT_ITEM_SELECTED,()=>r.stopEditing())}afterGuiAttached(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&this.eSelect.showPicker()}focusIn(){this.eSelect.getFocusableElement().focus()}getValue(){return this.eSelect.getValue()}isPopup(){return!1}}Bo([s("valueFormatterService")],Vo.prototype,"valueFormatterService",void 0),Bo([A("eSelect")],Vo.prototype,"eSelect",void 0);var jo=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class zo extends Go{constructor(e){super(`\n            <div class="ag-cell-edit-wrapper">\n                ${e.getTemplate()}\n            </div>`),this.cellEditorInput=e}init(e){this.params=e;const t=this.eInput;let i;if(this.cellEditorInput.init(t,e),e.cellStartedEdit){this.focusAfterAttached=!0;const t=e.eventKey;t===x.BACKSPACE||e.eventKey===x.DELETE?i="":t&&1===t.length?i=t:(i=this.cellEditorInput.getStartValue(),t!==x.F2&&(this.highlightAllOnFocus=!0))}else this.focusAfterAttached=!1,i=this.cellEditorInput.getStartValue();null!=i&&t.setStartValue(i),this.addManagedListener(t.getGui(),"keydown",e=>{const{key:t}=e;t!==x.PAGE_UP&&t!==x.PAGE_DOWN||e.preventDefault()})}afterGuiAttached(){var e,t;const i=this.localeService.getLocaleTextFunc(),n=this.eInput;if(n.setInputAriaLabel(i("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;Zi()||n.getFocusableElement().focus();const r=n.getInputElement();this.highlightAllOnFocus?r.select():null===(t=(e=this.cellEditorInput).setCaret)||void 0===t||t.call(e)}focusIn(){const e=this.eInput,t=e.getFocusableElement(),i=e.getInputElement();t.focus(),i.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}}jo([A("eInput")],zo.prototype,"eInput",void 0);class Wo{getTemplate(){return'<ag-input-text-field class="ag-cell-editor" ref="eInput"></ag-input-text-field>'}init(e,t){this.eInput=e,this.params=t,null!=t.maxLength&&e.setMaxLength(t.maxLength)}getValue(){const e=this.eInput.getValue();return C(e)||C(this.params.value)?this.params.parseValue(e):this.params.value}getStartValue(){return this.params.useFormatter||this.params.column.getColDef().refData?this.params.formatValue(this.params.value):this.params.value}setCaret(){const e=this.eInput.getValue(),t=C(e)&&e.length||0;t&&this.eInput.getInputElement().setSelectionRange(t,t)}}class Uo extends zo{constructor(){super(new Wo)}}var Yo=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class qo extends S{constructor(){super(qo.TEMPLATE),this.refreshCount=0}init(e){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(e)}showDelta(e,t){const i=Math.abs(t),n=e.formatValue(i),r=C(n)?n:i,o=t>=0;this.eDelta.innerHTML=o?"‚Üë"+r:"‚Üì"+r,this.eDelta.classList.toggle("ag-value-change-delta-up",o),this.eDelta.classList.toggle("ag-value-change-delta-down",!o)}setTimerToRemoveDelta(){this.refreshCount++;const e=this.refreshCount;window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),Vn(this.eDelta)}refresh(t){const i=t.value;if(i===this.lastValue)return!1;if(C(t.valueFormatted)?this.eValue.innerHTML=t.valueFormatted:C(t.value)?this.eValue.innerHTML=i:Vn(this.eValue),this.filterManager.isSuppressFlashingCellsBecauseFiltering())return!1;if("number"==typeof i&&"number"==typeof this.lastValue){const e=i-this.lastValue;this.showDelta(t,e)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),this.setTimerToRemoveDelta(),this.lastValue=i,!0}}qo.TEMPLATE='<span><span class="ag-value-change-delta"></span><span class="ag-value-change-value"></span></span>',Yo([s("filterManager")],qo.prototype,"filterManager",void 0);var Ko=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Xo extends S{constructor(){super(Xo.TEMPLATE),this.refreshCount=0,this.eCurrent=this.queryForHtmlElement(".ag-value-slide-current")}init(e){this.refresh(e)}addSlideAnimation(){this.refreshCount++;const e=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious),this.ePrevious=Un('<span class="ag-value-slide-previous ag-value-slide-out"></span>'),this.ePrevious.innerHTML=this.eCurrent.innerHTML,this.getGui().insertBefore(this.ePrevious,this.eCurrent),window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.getGui().removeChild(this.ePrevious),this.ePrevious=null)},3e3)}refresh(e){let t=e.value;return u(t)&&(t=""),t!==this.lastValue&&(!this.filterManager.isSuppressFlashingCellsBecauseFiltering()&&(this.addSlideAnimation(),this.lastValue=t,C(e.valueFormatted)?this.eCurrent.innerHTML=e.valueFormatted:C(e.value)?this.eCurrent.innerHTML=t:Vn(this.eCurrent),!0))}}Xo.TEMPLATE='<span>\n            <span class="ag-value-slide-current"></span>\n        </span>',Ko([s("filterManager")],Xo.prototype,"filterManager",void 0);class R{constructor(e){this.rowIndex=null,this.key=null,this.childrenMapped={},this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=R.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=e}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){const i=this.data;this.data=e,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();const n=this.createDataChangedEvent(e,i,t);this.dispatchLocalEvent(n)}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(e,t,i){return{type:R.EVENT_DATA_CHANGED,node:this,oldData:t,newData:e,update:i}}createLocalRowEvent(e){return{type:e,node:this}}getRowIndexString(){return"top"===this.rowPinned?"t-"+this.rowIndex:"bottom"===this.rowPinned?"b-"+this.rowIndex:this.rowIndex.toString()}createDaemonNode(){const e=new R(this.beans);return e.id=this.id,e.data=this.data,e.__daemon=!0,e.selected=this.selected,e.level=this.level,e}setDataAndId(e,t){const i=C(this.id)?this.createDaemonNode():null,n=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),this.beans.selectionService.syncInRowNode(this,i),this.checkRowSelectable();const r=this.createDataChangedEvent(e,n,!1);this.dispatchLocalEvent(r)}checkRowSelectable(){const e=this.beans.gridOptionsService.get("isRowSelectable");this.setRowSelectable(!e||e(this))}setRowSelectable(e){if(this.selectable!==e){this.selectable=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_SELECTABLE_CHANGED));if(this.beans.gridOptionsService.is("groupSelectsChildren")){const e=this.calculateSelectedFromChildren();this.setSelectedParams({newValue:null!=e&&e,source:"selectableChanged"})}}}setId(e){const t=this.beans.gridOptionsService.getCallback("getRowId");if(t)if(this.data){const e=this.getGroupKeys(!0);this.id=t({data:this.data,parentKeys:e.length>0?e:void 0,level:this.level}),null!==this.id&&"string"==typeof this.id&&this.id.startsWith(R.ID_PREFIX_ROW_GROUP)&&console.error(`AG Grid: Row IDs cannot start with ${R.ID_PREFIX_ROW_GROUP}, this is a reserved prefix for AG Grid's row grouping feature.`),null!==this.id&&"string"!=typeof this.id&&(this.id=""+this.id)}else this.id=void 0;else this.id=e}getGroupKeys(e=!1){const t=[];let i=this;for(e&&(i=i.parent);i&&i.level>=0;)t.push(i.key),i=i.parent;return t.reverse(),t}isPixelInRange(e){return!(!C(this.rowTop)||!C(this.rowHeight))&&(e>=this.rowTop&&e<this.rowTop+this.rowHeight)}setFirstChild(e){this.firstChild!==e&&(this.firstChild=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_FIRST_CHILD_CHANGED)))}setLastChild(e){this.lastChild!==e&&(this.lastChild=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_LAST_CHILD_CHANGED)))}setChildIndex(e){this.childIndex!==e&&(this.childIndex=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_CHILD_INDEX_CHANGED)))}setRowTop(e){this.oldRowTop=this.rowTop,this.rowTop!==e&&(this.rowTop=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_TOP_CHANGED)),this.setDisplayed(null!==e))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setDisplayed(e){this.displayed!==e&&(this.displayed=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_DISPLAYED_CHANGED)))}setDragging(e){this.dragging!==e&&(this.dragging=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_DRAGGING_CHANGED)))}setHighlighted(e){e!==this.highlighted&&(this.highlighted=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_HIGHLIGHT_CHANGED)))}setHovered(e){this.hovered!==e&&(this.hovered=e)}isHovered(){return this.hovered}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_ALL_CHILDREN_COUNT_CHANGED)))}setMaster(e){this.master!==e&&(this.master&&!e&&(this.expanded=!1),this.master=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_MASTER_CHANGED)))}setGroup(e){this.group!==e&&(this.group&&!e&&(this.expanded=!1),this.group=e,this.updateHasChildren(),this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_GROUP_CHANGED)))}setRowHeight(e,t=!1){this.rowHeight=e,this.rowHeightEstimated=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_HEIGHT_CHANGED))}setRowAutoHeight(e,t){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[t.getId()]=e,null!=e&&(null==this.checkAutoHeightsDebounced&&(this.checkAutoHeightsDebounced=Ie(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())}checkAutoHeights(){let n=!1,e=!0,r=0;const o=this.__autoHeights;if(null==o)return;if(this.beans.columnModel.getAllDisplayedAutoHeightCols().forEach(t=>{let i=o[t.getId()];if(null==i){if(!this.beans.columnModel.isColSpanActive())return void(n=!0);{let e=[];switch(t.getPinned()){case"left":e=this.beans.columnModel.getDisplayedLeftColumnsForRow(this);break;case"right":e=this.beans.columnModel.getDisplayedRightColumnsForRow(this);break;case null:e=this.beans.columnModel.getViewportCenterColumnsForRow(this)}if(e.includes(t))return void(n=!0);i=-1}}else e=!1;i>r&&(r=i)}),n)return;if((e||r<10)&&(r=this.beans.gridOptionsService.getRowHeightForNode(this).height),r==this.rowHeight)return;this.setRowHeight(r);const t=this.beans.rowModel;t.onRowHeightChangedDebounced&&t.onRowHeightChangedDebounced()}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_ROW_INDEX_CHANGED)))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_UI_LEVEL_CHANGED)))}setExpanded(e,t){if(this.expanded===e)return;this.expanded=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_EXPANDED_CHANGED));const i=Object.assign({},this.createGlobalRowEvent(y.EVENT_ROW_GROUP_OPENED),{expanded:e,event:t||null});this.beans.rowNodeEventThrottle.dispatchExpanded(i),this.beans.gridOptionsService.is("groupIncludeFooter")&&this.beans.rowRenderer.refreshCells({rowNodes:[this]})}createGlobalRowEvent(e){return{type:e,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned,context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi}}dispatchLocalEvent(e){this.eventService&&this.eventService.dispatchEvent(e)}setDataValue(t,e,i){const n=(()=>{var e;return"string"!=typeof t?t:null!==(e=this.beans.columnModel.getGridColumn(t))&&void 0!==e?e:this.beans.columnModel.getPrimaryColumn(t)})(),r=this.getValueFromValueService(n);if(this.beans.gridOptionsService.is("readOnlyEdit"))return this.dispatchEventForSaveValueReadOnly(n,r,e,i),!1;const o=this.beans.valueService.setValue(this,n,e,i);return this.dispatchCellChangedEvent(n,e,r),this.checkRowSelectable(),o}getValueFromValueService(e){const t=this.leafGroup&&this.beans.columnModel.isPivotMode(),i=this.group&&this.expanded&&!this.footer&&!t,n=this.beans.gridOptionsService.is("groupIncludeFooter"),r=this.beans.gridOptionsService.is("groupSuppressBlankHeader"),o=i&&n&&!r;return this.beans.valueService.getValue(e,this,!1,o)}dispatchEventForSaveValueReadOnly(e,t,i,n){const r={type:y.EVENT_CELL_EDIT_REQUEST,event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column:e,colDef:e.getColDef(),context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,data:this.data,node:this,oldValue:t,newValue:i,value:i,source:n};this.beans.eventService.dispatchEvent(r)}setGroupValue(e,t){const i=this.beans.columnModel.getGridColumn(e);u(this.groupData)&&(this.groupData={});const n=i.getColId(),r=this.groupData[n];r!==t&&(this.groupData[n]=t,this.dispatchCellChangedEvent(i,t,r))}setAggData(e){const t=ve([this.aggData,e]),r=this.aggData;this.aggData=e,this.eventService&&t.forEach(e=>{const t=this.beans.columnModel.getGridColumn(e),i=this.aggData?this.aggData[e]:void 0,n=r?r[e]:void 0;this.dispatchCellChangedEvent(t,i,n)})}updateHasChildren(){let i=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(this.beans.gridOptionsService.isRowModelType("serverSide")){const e=this.beans.gridOptionsService.isTreeData(),t=this.beans.gridOptionsService.get("isServerSideGroup");i=!this.stub&&!this.footer&&(e?!!t&&t(this.data):!!this.group)}i!==this.__hasChildren&&(this.__hasChildren=!!i,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_HAS_CHILDREN_CHANGED)))}hasChildren(){return null==this.__hasChildren&&this.updateHasChildren(),this.__hasChildren}isEmptyRowGroupNode(){return this.group&&ee(this.childrenAfterGroup)}dispatchCellChangedEvent(e,t,i){const n={type:R.EVENT_CELL_CHANGED,node:this,column:e,newValue:t,oldValue:i};this.dispatchLocalEvent(n)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return!!(this.hasChildren()&&!this.footer||this.master)}isSelected(){return this.footer?this.sibling.isSelected():this.selected}depthFirstSearch(t){this.childrenAfterGroup&&this.childrenAfterGroup.forEach(e=>e.depthFirstSearch(t)),t(this)}calculateSelectedFromChildren(){var n;let r=!1,o=!1,s=!1;if(!(null===(n=this.childrenAfterGroup)||void 0===n?void 0:n.length))return this.selectable?this.selected:null;for(let i=0;i<this.childrenAfterGroup.length;i++){const e=this.childrenAfterGroup[i];let t=e.isSelected();if(!e.selectable){const n=e.calculateSelectedFromChildren();if(null===n)continue;t=n}switch(t){case!0:r=!0;break;case!1:o=!0;break;default:s=!0}}return s||r&&o?void 0:!!r||!o&&(this.selectable?this.selected:null)}setSelectedInitialValue(e){this.selected=e}selectThisNode(e,t,i="api"){const n=!this.selectable&&e,r=this.selected===e;if(n||r)return!1;this.selected=e,this.eventService&&this.dispatchLocalEvent(this.createLocalRowEvent(R.EVENT_ROW_SELECTED));const o=Object.assign(Object.assign({},this.createGlobalRowEvent(y.EVENT_ROW_SELECTED)),{event:t||null,source:i});return this.beans.eventService.dispatchEvent(o),!0}setSelected(e,t=!1,i="api"){"boolean"!=typeof i?this.setSelectedParams({newValue:e,clearSelection:t,rangeSelect:!1,source:i}):console.warn("AG Grid: since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.")}setSelectedParams(e){return this.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),0):void 0===this.id?(console.warn("AG Grid: cannot select node until id for node is known"),0):this.beans.selectionService.setNodesSelected(Object.assign(Object.assign({},e),{nodes:[this.footer?this.sibling:this]}))}isRowPinned(){return"top"===this.rowPinned||"bottom"===this.rowPinned}isParentOfNode(e){let t=this.parent;for(;t;){if(t===e)return!0;t=t.parent}return!1}addEventListener(e,t){this.eventService||(this.eventService=new qe),this.eventService.addEventListener(e,t)}removeEventListener(e,t){this.eventService&&(this.eventService.removeEventListener(e,t),this.eventService.noRegisteredListenersExist()&&(this.eventService=null))}onMouseEnter(){this.dispatchLocalEvent(this.createLocalRowEvent(R.EVENT_MOUSE_ENTER))}onMouseLeave(){this.dispatchLocalEvent(this.createLocalRowEvent(R.EVENT_MOUSE_LEAVE))}getFirstChildOfFirstChild(t){let i=this,n=!0,r=!1,o=null;for(;n&&!r;){const e=i.parent;C(e)&&i.firstChild?e.rowGroupColumn===t&&(r=!0,o=e):n=!1,i=e}return r?o:null}isFullWidthCell(){const e=this.beans.gridOptionsService.getCallback("isFullWidthRow");return!!e&&e({rowNode:this})}getRoute(){if(null==this.key)return;const e=[];let t=this;for(;null!=t.key;)e.push(t.key),t=t.parent;return e.reverse()}createFooter(){if(this.sibling)return;const t=new R(this.beans);Object.keys(this).forEach(e=>{t[e]=this[e]}),t.footer=!0,t.setRowTop(null),t.setRowIndex(null),t.oldRowTop=null,t.id="rowGroupFooter_"+this.id,t.sibling=this,this.sibling=t}}R.ID_PREFIX_ROW_GROUP="row-group-",R.ID_PREFIX_TOP_PINNED="t-",R.ID_PREFIX_BOTTOM_PINNED="b-",R.OBJECT_ID_SEQUENCE=0,R.EVENT_ROW_SELECTED="rowSelected",R.EVENT_DATA_CHANGED="dataChanged",R.EVENT_CELL_CHANGED="cellChanged",R.EVENT_ALL_CHILDREN_COUNT_CHANGED="allChildrenCountChanged",R.EVENT_MASTER_CHANGED="masterChanged",R.EVENT_GROUP_CHANGED="groupChanged",R.EVENT_MOUSE_ENTER="mouseEnter",R.EVENT_MOUSE_LEAVE="mouseLeave",R.EVENT_HEIGHT_CHANGED="heightChanged",R.EVENT_TOP_CHANGED="topChanged",R.EVENT_DISPLAYED_CHANGED="displayedChanged",R.EVENT_FIRST_CHILD_CHANGED="firstChildChanged",R.EVENT_LAST_CHILD_CHANGED="lastChildChanged",R.EVENT_CHILD_INDEX_CHANGED="childIndexChanged",R.EVENT_ROW_INDEX_CHANGED="rowIndexChanged",R.EVENT_EXPANDED_CHANGED="expandedChanged",R.EVENT_HAS_CHILDREN_CHANGED="hasChildrenChanged",R.EVENT_SELECTABLE_CHANGED="selectableChanged",R.EVENT_UI_LEVEL_CHANGED="uiLevelChanged",R.EVENT_HIGHLIGHT_CHANGED="rowHighlightChanged",R.EVENT_DRAGGING_CHANGED="draggingChanged";var Zo=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Qo extends S{constructor(){super('\n            <div class="ag-selection-checkbox" role="presentation">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>')}postConstruct(){this.eCheckbox.setPassive(!0),ki(this.eCheckbox.getInputElement(),"polite")}getCheckboxId(){return this.eCheckbox.getInputElement().id}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const e=this.localeService.getLocaleTextFunc(),t=this.rowNode.isSelected(),i=Xi(e,t),n=e("ariaRowToggleSelection","Press Space to toggle row selection");this.eCheckbox.setValue(t,!0),this.eCheckbox.setInputAriaLabel(`${n} (${i})`)}onClicked(e,t,i){return this.rowNode.setSelectedParams({newValue:e,rangeSelect:i.shiftKey,groupSelectsFiltered:t,event:i,source:"checkboxSelected"})}init(e){this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",e=>{yt(e)}),this.addManagedListener(this.eCheckbox.getInputElement(),"click",e=>{yt(e);const t=this.gridOptionsService.is("groupSelectsFiltered"),i=this.eCheckbox.getValue();if(this.shouldHandleIndeterminateState(i,t)){0===this.onClicked(!0,t,e||{})&&this.onClicked(!1,t,e)}else i?this.onClicked(!1,t,e):this.onClicked(!0,t,e||{})}),this.addManagedListener(this.rowNode,R.EVENT_ROW_SELECTED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_DATA_CHANGED,this.onDataChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_SELECTABLE_CHANGED,this.onSelectableChanged.bind(this));if(this.gridOptionsService.get("isRowSelectable")||"function"==typeof this.getIsVisible()){const e=this.showOrHideSelect.bind(this);this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.rowNode,R.EVENT_DATA_CHANGED,e),this.addManagedListener(this.rowNode,R.EVENT_CELL_CHANGED,e),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}shouldHandleIndeterminateState(e,t){return t&&(void 0===this.eCheckbox.getPreviousValue()||void 0===e)&&this.gridOptionsService.isRowModelType("clientSide")}showOrHideSelect(){var e,t,i,n;let r=this.rowNode.selectable;const o=this.getIsVisible();if(r)if("function"==typeof o){const i=null===(e=this.overrides)||void 0===e?void 0:e.callbackParams,n=null===(t=this.column)||void 0===t?void 0:t.createColumnFunctionCallbackParams(this.rowNode);r=!!n&&o(Object.assign(Object.assign({},i),n))}else r=null!=o&&o;if(null===(i=this.column)||void 0===i?void 0:i.getColDef().showDisabledCheckboxes)return this.eCheckbox.setDisabled(!r),this.setVisible(!0),void this.setDisplayed(!0);(null===(n=this.overrides)||void 0===n?void 0:n.removeHidden)?this.setDisplayed(r):this.setVisible(r)}getIsVisible(){var e,t;return this.overrides?this.overrides.isVisible:null===(t=null===(e=this.column)||void 0===e?void 0:e.getColDef())||void 0===t?void 0:t.checkboxSelection}}Zo([A("eCheckbox")],Qo.prototype,"eCheckbox",void 0),Zo([r],Qo.prototype,"postConstruct",null);var Jo,es,ts,is,ns=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e[e.ToolPanel=0]="ToolPanel",e[e.HeaderCell=1]="HeaderCell",e[e.RowDrag=2]="RowDrag",e[e.ChartPanel=3]="ChartPanel"}(es||(es={})),function(e){e[e.Up=0]="Up",e[e.Down=1]="Down"}(ts||(ts={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(is||(is={}));let M=Jo=class extends p{constructor(){super(...arguments),this.dragSourceAndParamsList=[],this.dropTargets=[]}init(){this.ePinnedIcon=gr("columnMovePin",this.gridOptionsService,null),this.eHideIcon=gr("columnMoveHide",this.gridOptionsService,null),this.eMoveIcon=gr("columnMoveMove",this.gridOptionsService,null),this.eLeftIcon=gr("columnMoveLeft",this.gridOptionsService,null),this.eRightIcon=gr("columnMoveRight",this.gridOptionsService,null),this.eGroupIcon=gr("columnMoveGroup",this.gridOptionsService,null),this.eAggregateIcon=gr("columnMoveValue",this.gridOptionsService,null),this.ePivotIcon=gr("columnMovePivot",this.gridOptionsService,null),this.eDropNotAllowedIcon=gr("dropNotAllowed",this.gridOptionsService,null)}addDragSource(e,t=!1){const i={eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),includeTouch:t};this.dragSourceAndParamsList.push({params:i,dragSource:e}),this.dragService.addDragSource(i)}removeDragSource(t){const e=this.dragSourceAndParamsList.find(e=>e.dragSource===t);e&&(this.dragService.removeDragSource(e.params),st(this.dragSourceAndParamsList,e))}clearDragSourceParamsList(){this.dragSourceAndParamsList.forEach(e=>this.dragService.removeDragSource(e.params)),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0}nudge(){this.dragging&&this.onDragging(this.eventLastTime,!0)}onDragStart(e,t){this.dragging=!0,this.dragSource=e,this.eventLastTime=t,this.dragItem=this.dragSource.getDragItem(),this.lastDropTarget=this.dragSource.dragSourceDropTarget,this.dragSource.onDragStarted&&this.dragSource.onDragStarted(),this.createGhost()}onDragStop(t){if(this.eventLastTime=null,this.dragging=!1,this.dragSource.onDragStopped&&this.dragSource.onDragStopped(),this.lastDropTarget&&this.lastDropTarget.onDragStop){const e=this.createDropTargetEvent(this.lastDropTarget,t,null,null,!1);this.lastDropTarget.onDragStop(e)}this.lastDropTarget=null,this.dragItem=null,this.removeGhost()}onDragging(t,e){var i,n,r,o;const s=this.getHorizontalDirection(t),a=this.getVerticalDirection(t);this.eventLastTime=t,this.positionGhost(t);const l=this.dropTargets.filter(e=>this.isMouseOnDropTarget(t,e)),c=this.findCurrentDropTarget(t,l);if(c!==this.lastDropTarget)this.leaveLastTargetIfExists(t,s,a,e),null!==this.lastDropTarget&&null===c&&(null===(n=(i=this.dragSource).onGridExit)||void 0===n||n.call(i,this.dragItem)),null===this.lastDropTarget&&null!==c&&(null===(o=(r=this.dragSource).onGridEnter)||void 0===o||o.call(r,this.dragItem)),this.enterDragTargetIfExists(c,t,s,a,e),this.lastDropTarget=c;else if(c&&c.onDragging){const i=this.createDropTargetEvent(c,t,s,a,e);c.onDragging(i)}}getAllContainersFromDropTarget(e){const t=e.getSecondaryContainers?e.getSecondaryContainers():null,i=[[e.getContainer()]];return t?i.concat(t):i}allContainersIntersect(n,r){for(const i of r){const r=i.getBoundingClientRect();if(0===r.width||0===r.height)return!1;const e=n.clientX>=r.left&&n.clientX<r.right,t=n.clientY>=r.top&&n.clientY<r.bottom;if(!e||!t)return!1}return!0}isMouseOnDropTarget(e,t){const i=this.getAllContainersFromDropTarget(t);let n=!1;for(const t of i)if(this.allContainersIntersect(e,t)){n=!0;break}return!(t.targetContainsSource&&!t.getContainer().contains(this.dragSource.eElement))&&(n&&t.isInterestedIn(this.dragSource.type,this.dragSource.eElement))}findCurrentDropTarget(e,t){const i=t.length;if(0===i)return null;if(1===i)return t[0];const n=this.gridOptionsService.getRootNode().elementsFromPoint(e.clientX,e.clientY);for(const e of n)for(const i of t){if(-1!==ht(this.getAllContainersFromDropTarget(i)).indexOf(e))return i}return null}enterDragTargetIfExists(t,i,n,r,o){if(t){if(t.onDragEnter){const e=this.createDropTargetEvent(t,i,n,r,o);t.onDragEnter(e)}this.setGhostIcon(t.getIconName?t.getIconName():null)}}leaveLastTargetIfExists(t,i,n,r){if(this.lastDropTarget){if(this.lastDropTarget.onDragLeave){const e=this.createDropTargetEvent(this.lastDropTarget,t,i,n,r);this.lastDropTarget.onDragLeave(e)}this.setGhostIcon(null)}}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(t){this.dropTargets=this.dropTargets.filter(e=>e.getContainer()!==t.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(t){return this.dropTargets.filter(e=>e.external).find(e=>e.getContainer()===t.getContainer())||null}getHorizontalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientX,i=e.clientX;return t===i?null:t>i?is.Left:is.Right}getVerticalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientY,i=e.clientY;return t===i?null:t>i?ts.Up:ts.Down}createDropTargetEvent(e,t,i,n,r){const o=e.getContainer(),s=o.getBoundingClientRect(),{gridApi:a,columnApi:l,dragItem:c,dragSource:u}=this;return{event:t,x:t.clientX-s.left,y:t.clientY-s.top,vDirection:n,hDirection:i,dragSource:u,fromNudge:r,dragItem:c,api:a,columnApi:l,dropZoneTarget:o}}positionGhost(e){const t=this.eGhost;if(!t)return;const i=t.getBoundingClientRect().height,n=an()-2,r=ln()-2,o=Gn(t.offsetParent),{clientY:s,clientX:a}=e;let l=s-o.top-i/2,c=a-o.left-10;const u=this.gridOptionsService.getDocument(),d=u.defaultView||window,h=d.pageYOffset||u.documentElement.scrollTop,f=d.pageXOffset||u.documentElement.scrollLeft;n>0&&c+t.clientWidth>n+f&&(c=n+f-t.clientWidth),c<0&&(c=0),r>0&&l+t.clientHeight>r+h&&(l=r+h-t.clientHeight),l<0&&(l=0),t.style.left=c+"px",t.style.top=l+"px"}removeGhost(){this.eGhost&&this.eGhostParent&&this.eGhostParent.removeChild(this.eGhost),this.eGhost=null}createGhost(){this.eGhost=Un(Jo.GHOST_TEMPLATE),this.mouseEventService.stampTopLevelGridCompWithGridInstance(this.eGhost);const{theme:e}=this.environment.getTheme();e&&this.eGhost.classList.add(e),this.eGhostIcon=this.eGhost.querySelector(".ag-dnd-ghost-icon"),this.setGhostIcon(null);const t=this.eGhost.querySelector(".ag-dnd-ghost-label");let i=this.dragSource.dragItemName;De(i)&&(i=i()),t.innerHTML=$t(i)||"",this.eGhost.style.height="25px",this.eGhost.style.top="20px",this.eGhost.style.left="20px";const n=this.gridOptionsService.getDocument();let r=null;try{r=n.fullscreenElement}catch(e){}finally{if(!r){const e=this.gridOptionsService.getRootNode(),t=e.querySelector("body");r=t||(e instanceof ShadowRoot?e:null==e?void 0:e.documentElement)}}this.eGhostParent=r,this.eGhostParent?this.eGhostParent.appendChild(this.eGhost):console.warn("AG Grid: could not find document body, it is needed for dragging columns")}setGhostIcon(e,t=!1){Vn(this.eGhostIcon);let i=null;switch(e||(e=this.dragSource.defaultIconName||Jo.ICON_NOT_ALLOWED),e){case Jo.ICON_PINNED:i=this.ePinnedIcon;break;case Jo.ICON_MOVE:i=this.eMoveIcon;break;case Jo.ICON_LEFT:i=this.eLeftIcon;break;case Jo.ICON_RIGHT:i=this.eRightIcon;break;case Jo.ICON_GROUP:i=this.eGroupIcon;break;case Jo.ICON_AGGREGATE:i=this.eAggregateIcon;break;case Jo.ICON_PIVOT:i=this.ePivotIcon;break;case Jo.ICON_NOT_ALLOWED:i=this.eDropNotAllowedIcon;break;case Jo.ICON_HIDE:i=this.eHideIcon}this.eGhostIcon.classList.toggle("ag-shake-left-to-right",t),i===this.eHideIcon&&this.gridOptionsService.is("suppressDragLeaveHidesColumns")||i&&this.eGhostIcon.appendChild(i)}};M.ICON_PINNED="pinned",M.ICON_MOVE="move",M.ICON_LEFT="left",M.ICON_RIGHT="right",M.ICON_GROUP="group",M.ICON_AGGREGATE="aggregate",M.ICON_PIVOT="pivot",M.ICON_NOT_ALLOWED="notAllowed",M.ICON_HIDE="hide",M.GHOST_TEMPLATE='<div class="ag-dnd-ghost ag-unselectable">\n            <span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>\n            <div class="ag-dnd-ghost-label"></div>\n        </div>',ns([s("dragService")],M.prototype,"dragService",void 0),ns([s("mouseEventService")],M.prototype,"mouseEventService",void 0),ns([s("columnApi")],M.prototype,"columnApi",void 0),ns([s("gridApi")],M.prototype,"gridApi",void 0),ns([r],M.prototype,"init",null),ns([Ve],M.prototype,"clearDragSourceParamsList",null),M=Jo=ns([o("dragAndDropService")],M);var rs=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class os extends S{constructor(e,t,i,n,r,o){super(),this.cellValueFn=e,this.rowNode=t,this.column=i,this.customGui=n,this.dragStartPixels=r,this.suppressVisibilityChange=o,this.dragSource=null}isCustomGui(){return null!=this.customGui}postConstruct(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(mr("rowDrag",this.gridOptionsService,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){const e=this.gridOptionsService.is("rowDragManaged")?new ls(this,this.beans,this.rowNode,this.column):new as(this,this.beans,this.rowNode,this.column);this.createManagedBean(e,this.beans.context)}}setDragElement(e,t){this.setTemplateFromElement(e),this.addDragSource(t)}getSelectedNodes(){if(!this.gridOptionsService.is("rowDragMultiRow"))return[this.rowNode];const e=this.beans.selectionService.getSelectedNodes();return-1!==e.indexOf(this.rowNode)?e:[this.rowNode]}checkCompatibility(){const e=this.gridOptionsService.is("rowDragManaged");this.gridOptionsService.isTreeData()&&e&&l(()=>console.warn("AG Grid: If using row drag with tree data, you cannot have rowDragManaged=true"),"RowDragComp.managedAndTreeData")}getDragItem(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(t){if(t){const e=t.getColDef();if(e.rowDragText)return e.rowDragText}return this.gridOptionsService.get("rowDragText")}addDragSource(e=4){this.dragSource&&this.removeDragSource();const n=this.getRowDragText(this.column),r=this.localeService.getLocaleTextFunc();this.dragSource={type:es.RowDrag,eElement:this.getGui(),dragItemName:()=>{var e;const t=this.getDragItem(),i=(null===(e=t.rowNodes)||void 0===e?void 0:e.length)||1;return n?n(t,i):1===i?this.cellValueFn():`${i} ${r("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gridOptionsService.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)}removeDragSource(){this.dragSource&&this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null}}rs([s("beans")],os.prototype,"beans",void 0),rs([r],os.prototype,"postConstruct",null),rs([Ve],os.prototype,"removeDragSource",null);class ss extends p{constructor(e,t,i){super(),this.parent=e,this.rowNode=t,this.column=i}setDisplayedOrVisible(e){const i={skipAriaHidden:!0};if(e)this.parent.setDisplayed(!1,i);else{let e=!0,t=!1;this.column&&(e=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),t=De(this.column.getColDef().rowDrag)),t?(this.parent.setDisplayed(!0,i),this.parent.setVisible(e,i)):(this.parent.setDisplayed(e,i),this.parent.setVisible(!0,i))}}}class as extends ss{constructor(e,t,i,n){super(e,i,n),this.beans=t}postConstruct(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,y.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.gridOptionsService.is("suppressRowDrag");this.setDisplayedOrVisible(e)}}rs([r],as.prototype,"postConstruct",null);class ls extends ss{constructor(e,t,i,n){super(e,i,n),this.beans=t}postConstruct(){this.addManagedListener(this.beans.eventService,y.EVENT_SORT_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,y.EVENT_FILTER_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,y.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),t=e&&e.shouldPreventRowMove(),i=this.gridOptionsService.is("suppressRowDrag"),n=this.beans.dragAndDropService.hasExternalDropZones(),r=t&&!n||i;this.setDisplayedOrVisible(r)}}rs([r],ls.prototype,"postConstruct",null);var cs=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class us extends p{init(e,t,i,n,r,o,s){this.params=s,this.eGui=t,this.eCheckbox=i,this.eExpanded=n,this.eContracted=r,this.comp=e,this.compClass=o;const a=this.isTopLevelFooter(),l=this.isEmbeddedRowMismatch(),c=null==s.value&&!s.node.master;let u=!1;if(this.gridOptionsService.is("groupIncludeFooter")&&this.gridOptionsService.is("groupHideOpenParents")){const e=s.node;if(e.footer){u=(s.colDef&&s.colDef.showRowGroup)!==(e.rowGroupColumn&&e.rowGroupColumn.getColId())}}this.cellIsBlank=!a&&(l||c&&!s.node.master||u),this.cellIsBlank||(this.setupShowingValueForOpenedParent(),this.findDisplayedGroupNode(),this.addFullWidthRowDraggerIfNeeded(),this.addExpandAndContract(),this.addCheckboxIfNeeded(),this.addValueElement(),this.setupIndent(),this.refreshAriaExpanded())}destroy(){super.destroy(),this.expandListener=null}refreshAriaExpanded(){const{node:e,eParentOfValue:t}=this.params;if(this.expandListener&&(this.expandListener=this.expandListener()),!this.isExpandable())return void Pi(t);const i=()=>{Li(t,!!e.expanded)};this.expandListener=this.addManagedListener(e,R.EVENT_EXPANDED_CHANGED,i)||null,i()}isTopLevelFooter(){if(!this.gridOptionsService.is("groupIncludeTotalFooter"))return!1;if(null!=this.params.value||-1!=this.params.node.level)return!1;const e=this.params.colDef;if(null==e)return!0;if(!0===e.showRowGroup)return!0;const t=this.columnModel.getRowGroupColumns();if(!t||0===t.length)return!0;return t[0].getId()===e.showRowGroup}isEmbeddedRowMismatch(){if(!this.params.fullWidth||!this.gridOptionsService.is("embedFullWidthRows"))return!1;const e="left"===this.params.pinned,t="right"===this.params.pinned,i=!e&&!t;return this.gridOptionsService.is("enableRtl")?this.columnModel.isPinningLeft()?!t:!i:this.columnModel.isPinningLeft()?!e:!i}findDisplayedGroupNode(){const t=this.params.column,i=this.params.node;if(this.showingValueForOpenedParent){let e=i.parent;for(;null!=e;){if(e.rowGroupColumn&&t.isRowGroupDisplayed(e.rowGroupColumn.getId())){this.displayedGroupNode=e;break}e=e.parent}}u(this.displayedGroupNode)&&(this.displayedGroupNode=i)}setupShowingValueForOpenedParent(){const e=this.params.node,t=this.params.column;if(!this.gridOptionsService.is("groupHideOpenParents"))return void(this.showingValueForOpenedParent=!1);if(!e.groupData)return void(this.showingValueForOpenedParent=!1);if(null!=e.rowGroupColumn){const i=e.rowGroupColumn.getId();if(t.isRowGroupDisplayed(i))return void(this.showingValueForOpenedParent=!1)}const i=null!=e.groupData[t.getId()];this.showingValueForOpenedParent=i}addValueElement(){this.displayedGroupNode.footer?this.addFooterValue():(this.addGroupValue(),this.addChildCount())}addGroupValue(){const e=this.adjustParamsWithDetailsFromRelatedColumn(),t=this.getInnerCompDetails(e),{valueFormatted:i,value:n}=e;let r=i;if(null==r)if(""===n&&this.params.node.group){r=this.localeService.getLocaleTextFunc()("blanks","(Blanks)")}else r=null!=n?n:null;this.comp.setInnerRenderer(t,r)}adjustParamsWithDetailsFromRelatedColumn(){const e=this.displayedGroupNode.rowGroupColumn,t=this.params.column;if(!e)return this.params;if(null!=t){if(!t.isRowGroupDisplayed(e.getId()))return this.params}const i=this.params,{value:n,node:r}=this.params,o=this.valueFormatterService.formatValue(e,r,n);return Object.assign(Object.assign({},i),{valueFormatted:o})}addFooterValue(){const e=this.params.footerValueGetter;let t="";if(e){const i=ue(this.params);i.value=this.params.value,"function"==typeof e?t=e(i):"string"==typeof e?t=this.expressionService.evaluate(e,i):console.warn("AG Grid: footerValueGetter should be either a function or a string (expression)")}else t="Total "+(null!=this.params.value?this.params.value:"");const i=this.getInnerCompDetails(this.params);this.comp.setInnerRenderer(i,t)}getInnerCompDetails(e){if(e.fullWidth)return this.userComponentFactory.getFullWidthGroupRowInnerCellRenderer(this.gridOptionsService.get("groupRowRendererParams"),e);const t=this.userComponentFactory.getInnerRendererDetails(e,e),i=e=>e&&e.componentClass==this.compClass;if(t&&!i(t))return t;const n=this.displayedGroupNode.rowGroupColumn,r=n?n.getColDef():void 0;if(!r)return;const o=this.userComponentFactory.getCellRendererDetails(r,e);if(o&&!i(o))return o;if(i(o)&&r.cellRendererParams&&r.cellRendererParams.innerRenderer){return this.userComponentFactory.getInnerRendererDetails(r.cellRendererParams,e)}}addChildCount(){this.params.suppressCount||(this.addManagedListener(this.displayedGroupNode,R.EVENT_ALL_CHILDREN_COUNT_CHANGED,this.updateChildCount.bind(this)),this.updateChildCount())}updateChildCount(){const e=this.displayedGroupNode.allChildrenCount,t=this.isShowRowGroupForThisRow()&&null!=e&&e>=0?`(${e})`:"";this.comp.setChildCount(t)}isShowRowGroupForThisRow(){if(this.gridOptionsService.isTreeData())return!0;const e=this.displayedGroupNode.rowGroupColumn;if(!e)return!1;const t=this.params.column;return null==t||t.isRowGroupDisplayed(e.getId())}addExpandAndContract(){var e;const t=this.params,i=mr("groupExpanded",this.gridOptionsService,null),n=mr("groupContracted",this.gridOptionsService,null);i&&this.eExpanded.appendChild(i),n&&this.eContracted.appendChild(n);const r=t.eGridCell;(null===(e=this.params.column)||void 0===e?void 0:e.isCellEditable(t.node))&&this.gridOptionsService.is("enableGroupEdit")||!this.isExpandable()||t.suppressDoubleClickExpand||this.addManagedListener(r,"dblclick",this.onCellDblClicked.bind(this)),this.addManagedListener(this.eExpanded,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eContracted,"click",this.onExpandClicked.bind(this)),this.addManagedListener(r,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(t.node,R.EVENT_EXPANDED_CHANGED,this.showExpandAndContractIcons.bind(this)),this.showExpandAndContractIcons();const o=this.onRowNodeIsExpandableChanged.bind(this);this.addManagedListener(this.displayedGroupNode,R.EVENT_ALL_CHILDREN_COUNT_CHANGED,o),this.addManagedListener(this.displayedGroupNode,R.EVENT_MASTER_CHANGED,o),this.addManagedListener(this.displayedGroupNode,R.EVENT_GROUP_CHANGED,o),this.addManagedListener(this.displayedGroupNode,R.EVENT_HAS_CHILDREN_CHANGED,o)}onExpandClicked(e){bt(e)||(yt(e),this.onExpandOrContract(e))}onExpandOrContract(e){const t=this.displayedGroupNode,i=!t.expanded;!i&&t.sticky&&this.scrollToStickyNode(t),t.setExpanded(i,e)}scrollToStickyNode(e){this.ctrlsService.getGridBodyCtrl().getScrollFeature().setVerticalScrollPosition(e.rowTop-e.stickyRowTop)}isExpandable(){if(this.showingValueForOpenedParent)return!0;const e=this.displayedGroupNode,t=this.columnModel.isPivotMode()&&e.leafGroup;if(!(e.isExpandable()&&!e.footer&&!t))return!1;const i=this.params.column;if(null!=i&&"string"==typeof i.getColDef().showRowGroup){return this.isShowRowGroupForThisRow()}return!0}showExpandAndContractIcons(){const{params:e,displayedGroupNode:t,columnModel:i}=this,{node:n}=e,r=this.isExpandable();if(r){const e=!!this.showingValueForOpenedParent||n.expanded;this.comp.setExpandedDisplayed(e),this.comp.setContractedDisplayed(!e)}else this.comp.setExpandedDisplayed(!1),this.comp.setContractedDisplayed(!1);const o=i.isPivotMode(),s=o&&t.leafGroup,a=r&&!s,l=n.footer&&-1===n.level;this.comp.addOrRemoveCssClass("ag-cell-expandable",a),this.comp.addOrRemoveCssClass("ag-row-group",a),o?this.comp.addOrRemoveCssClass("ag-pivot-leaf-group",s):l||this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent",!a)}onRowNodeIsExpandableChanged(){this.showExpandAndContractIcons(),this.setIndent(),this.refreshAriaExpanded()}setupIndent(){const e=this.params.node;this.params.suppressPadding||(this.addManagedListener(e,R.EVENT_UI_LEVEL_CHANGED,this.setIndent.bind(this)),this.setIndent())}setIndent(){if(this.gridOptionsService.is("groupHideOpenParents"))return;const e=this.params,t=e.node,i=!!e.colDef,n=this.gridOptionsService.isTreeData(),r=!i||n||!0===e.colDef.showRowGroup?t.uiLevel:0;this.indentClass&&this.comp.addOrRemoveCssClass(this.indentClass,!1),this.indentClass="ag-row-group-indent-"+r,this.comp.addOrRemoveCssClass(this.indentClass,!0)}addFullWidthRowDraggerIfNeeded(){if(!this.params.fullWidth||!this.params.rowDrag)return;const e=new os(()=>this.params.value,this.params.node);this.createManagedBean(e,this.context),this.eGui.insertAdjacentElement("afterbegin",e.getGui())}isUserWantsSelected(){const e=this.params.checkbox;return"function"==typeof e||!0===e}addCheckboxIfNeeded(){const e=this.displayedGroupNode,t=this.isUserWantsSelected()&&!e.footer&&!e.rowPinned&&!e.detail;if(t){const t=new Qo;this.getContext().createBean(t),t.init({rowNode:e,column:this.params.column,overrides:{isVisible:this.params.checkbox,callbackParams:this.params,removeHidden:!0}}),this.eCheckbox.appendChild(t.getGui()),this.addDestroyFunc(()=>this.getContext().destroyBean(t))}this.comp.setCheckboxVisible(t)}onKeyDown(e){if(!(e.key===x.ENTER)||this.params.suppressEnterExpand)return;this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract(e)}onCellDblClicked(e){if(bt(e))return;Ct(this.eExpanded,e)||Ct(this.eContracted,e)||this.onExpandOrContract(e)}}cs([s("expressionService")],us.prototype,"expressionService",void 0),cs([s("valueFormatterService")],us.prototype,"valueFormatterService",void 0),cs([s("columnModel")],us.prototype,"columnModel",void 0),cs([s("userComponentFactory")],us.prototype,"userComponentFactory",void 0),cs([s("ctrlsService")],us.prototype,"ctrlsService",void 0);var ds=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class hs extends S{constructor(){super(hs.TEMPLATE)}init(e){const t={setInnerRenderer:(e,t)=>this.setRenderDetails(e,t),setChildCount:e=>this.eChildCount.innerHTML=e,addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),setContractedDisplayed:e=>w(this.eContracted,e),setExpandedDisplayed:e=>w(this.eExpanded,e),setCheckboxVisible:e=>this.eCheckbox.classList.toggle("ag-invisible",!e)},i=this.createManagedBean(new us),n=!e.colDef,r=this.getGui();i.init(t,r,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,e),n&&Ci(r,"gridcell")}setRenderDetails(e,t){if(e){const t=e.newAgStackInstance();if(!t)return;t.then(e=>{if(!e)return;const t=()=>this.context.destroyBean(e);this.isAlive()?(this.eValue.appendChild(e.getGui()),this.addDestroyFunc(t)):t()})}else this.eValue.innerText=t}destroy(){this.getContext().destroyBean(this.innerCellRenderer),super.destroy()}refresh(){return!1}}hs.TEMPLATE='<span class="ag-cell-wrapper">\n            <span class="ag-group-expanded" ref="eExpanded"></span>\n            <span class="ag-group-contracted" ref="eContracted"></span>\n            <span class="ag-group-checkbox ag-invisible" ref="eCheckbox"></span>\n            <span class="ag-group-value" ref="eValue"></span>\n            <span class="ag-group-child-count" ref="eChildCount"></span>\n        </span>',ds([A("eExpanded")],hs.prototype,"eExpanded",void 0),ds([A("eContracted")],hs.prototype,"eContracted",void 0),ds([A("eCheckbox")],hs.prototype,"eCheckbox",void 0),ds([A("eValue")],hs.prototype,"eValue",void 0),ds([A("eChildCount")],hs.prototype,"eChildCount",void 0);var fs=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class ps extends S{constructor(){super(ps.TEMPLATE)}init(e){e.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const e=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=e("loadingError","ERR")}setupLoading(){const e=mr("groupLoading",this.gridOptionsService,null);e&&this.eLoadingIcon.appendChild(e);const t=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=t("loadingOoo","Loading")}refresh(e){return!1}destroy(){super.destroy()}}ps.TEMPLATE='<div class="ag-loading">\n            <span class="ag-loading-icon" ref="eLoadingIcon"></span>\n            <span class="ag-loading-text" ref="eLoadingText"></span>\n        </div>',fs([A("eLoadingIcon")],ps.prototype,"eLoadingIcon",void 0),fs([A("eLoadingText")],ps.prototype,"eLoadingText",void 0);class gs extends S{constructor(){super()}destroy(){super.destroy()}init(e){var t;const i=null!==(t=this.gridOptionsService.get("overlayLoadingTemplate"))&&void 0!==t?t:gs.DEFAULT_LOADING_OVERLAY_TEMPLATE,n=this.localeService.getLocaleTextFunc(),r=i.replace("[LOADING...]",n("loadingOoo","Loading..."));this.setTemplate(r)}}gs.DEFAULT_LOADING_OVERLAY_TEMPLATE='<span class="ag-overlay-loading-center">[LOADING...]</span>';class ms extends S{constructor(){super()}destroy(){super.destroy()}init(e){var t;const i=null!==(t=this.gridOptionsService.get("overlayNoRowsTemplate"))&&void 0!==t?t:ms.DEFAULT_NO_ROWS_TEMPLATE,n=this.localeService.getLocaleTextFunc(),r=i.replace("[NO_ROWS_TO_SHOW]",n("noRowsToShow","No Rows To Show"));this.setTemplate(r)}}ms.DEFAULT_NO_ROWS_TEMPLATE='<span class="ag-overlay-no-rows-center">[NO_ROWS_TO_SHOW]</span>';class vs extends Go{constructor(){super('<div class="ag-tooltip"></div>')}init(e){const{value:t}=e;this.getGui().innerHTML=$t(t)}}class ys{getTemplate(){return'<ag-input-number-field class="ag-cell-editor" ref="eInput"></ag-input-number-field>'}init(e,t){this.eInput=e,this.params=t,null!=t.max&&e.setMax(t.max),null!=t.min&&e.setMin(t.min),null!=t.precision&&e.setPrecision(t.precision),null!=t.step&&e.setStep(t.step),t.showStepperButtons&&e.getInputElement().classList.add("ag-number-field-input-stepper")}getValue(){const e=this.eInput.getValue();if(!C(e)&&!C(this.params.value))return this.params.value;let t=this.params.parseValue(e);if(null==t)return t;if("string"==typeof t){if(""===t)return null;t=Number(t)}return isNaN(t)?null:t}getStartValue(){return this.params.value}}class bs extends zo{constructor(){super(new ys)}}class _s{getTemplate(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}init(e,t){this.eInput=e,this.params=t,null!=t.min&&e.setMin(t.min),null!=t.max&&e.setMax(t.max),null!=t.step&&e.setStep(t.step)}getValue(){const e=this.eInput.getDate();return C(e)||C(this.params.value)?null!=e?e:null:this.params.value}getStartValue(){const{value:e}=this.params;if(e instanceof Date)return wn(e,!1)}}class ws extends zo{constructor(){super(new _s)}}var Cs=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class xs{constructor(e){this.getDataTypeService=e}getTemplate(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}init(e,t){this.eInput=e,this.params=t,null!=t.min&&e.setMin(t.min),null!=t.max&&e.setMax(t.max),null!=t.step&&e.setStep(t.step)}getValue(){const e=this.formatDate(this.eInput.getDate());return C(e)||C(this.params.value)?this.params.parseValue(null!=e?e:""):this.params.value}getStartValue(){var e,t;return wn(null!==(t=this.parseDate(null!==(e=this.params.value)&&void 0!==e?e:void 0))&&void 0!==t?t:null,!1)}parseDate(e){return this.getDataTypeService().getDateParserFunction()(e)}formatDate(e){return this.getDataTypeService().getDateFormatterFunction()(e)}}class Ss extends zo{constructor(){super(new xs(()=>this.dataTypeService))}}Cs([s("dataTypeService")],Ss.prototype,"dataTypeService",void 0);var As=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Es extends S{constructor(){super(Es.TEMPLATE)}init(e){this.params=e,this.updateCheckbox(e),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.addManagedListener(this.eCheckbox.getInputElement(),"click",e=>{if(yt(e),this.eCheckbox.isDisabled())return;const t=this.eCheckbox.getValue();this.onCheckboxChanged(t)}),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",e=>{yt(e)});const i=this.gridOptionsService.getDocument();this.addManagedListener(this.params.eGridCell,"keydown",t=>{if(t.key===x.SPACE&&!this.eCheckbox.isDisabled()){this.params.eGridCell===i.activeElement&&this.eCheckbox.toggle();const e=this.eCheckbox.getValue();this.onCheckboxChanged(e),t.preventDefault()}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){var t,i,n;let r,o=!0;if(e.node.group&&e.column){const i=e.column.getColId();i.startsWith(Nt)?r=null==e.value||""===e.value?void 0:"true"===e.value:e.node.aggData&&void 0!==e.node.aggData[i]?r=null!==(t=e.value)&&void 0!==t?t:void 0:o=!1}else r=null!==(i=e.value)&&void 0!==i?i:void 0;if(!o)return void this.eCheckbox.setDisplayed(!1);this.eCheckbox.setValue(r);const s=null!=e.disabled?e.disabled:!(null===(n=e.column)||void 0===n?void 0:n.isCellEditable(e.node));this.eCheckbox.setDisabled(s);const a=this.localeService.getLocaleTextFunc(),l=Xi(a,r),c=s?l:`${a("ariaToggleCellValue","Press SPACE to toggle cell value")} (${l})`;this.eCheckbox.setInputAriaLabel(c)}onCheckboxChanged(e){const{column:t,node:i,rowIndex:n,value:r}=this.params,o={type:y.EVENT_CELL_EDITING_STARTED,column:t,colDef:null==t?void 0:t.getColDef(),data:i.data,node:i,rowIndex:n,rowPinned:i.rowPinned,value:r};this.eventService.dispatchEvent(o);const s=this.params.node.setDataValue(this.params.column,e,"edit"),a={type:y.EVENT_CELL_EDITING_STOPPED,column:t,colDef:null==t?void 0:t.getColDef(),data:i.data,node:i,rowIndex:n,rowPinned:i.rowPinned,value:r,oldValue:r,newValue:e,valueChanged:s};this.eventService.dispatchEvent(a)}}Es.TEMPLATE='\n        <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">\n            <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n        </div>',As([A("eCheckbox")],Es.prototype,"eCheckbox",void 0);var Ts=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Ds extends Go{constructor(){super('\n            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>')}init(e){var t;this.params=e;const i=null!==(t=e.value)&&void 0!==t?t:void 0;this.eCheckbox.setValue(i),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(i),this.addManagedListener(this.eCheckbox,ao.EVENT_CHANGED,e=>this.setAriaLabel(e.selected))}getValue(){return this.eCheckbox.getValue()}focusIn(){this.eCheckbox.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){const t=this.localeService.getLocaleTextFunc(),i=Xi(t,e),n=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel(`${n} (${i})`)}}Ts([A("eCheckbox")],Ds.prototype,"eCheckbox",void 0);var Rs=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Ms=class extends p{constructor(){super(...arguments),this.agGridDefaults={agDateInput:yo,agColumnHeader:Lo,agColumnGroupHeader:Fo,agSortIndicator:No,agTextColumnFloatingFilter:ko,agNumberColumnFloatingFilter:Mo,agDateColumnFloatingFilter:mo,agReadOnlyFloatingFilter:Hr,agAnimateShowChangeCellRenderer:qo,agAnimateSlideCellRenderer:Xo,agGroupCellRenderer:hs,agGroupRowRenderer:hs,agLoadingCellRenderer:ps,agCheckboxCellRenderer:Es,agCellEditor:Uo,agTextCellEditor:Uo,agNumberCellEditor:bs,agDateCellEditor:ws,agDateStringCellEditor:Ss,agSelectCellEditor:Vo,agLargeTextCellEditor:Ho,agCheckboxCellEditor:Ds,agTextColumnFilter:Ao,agNumberColumnFilter:xo,agDateColumnFilter:fo,agLoadingOverlay:gs,agNoRowsOverlay:ms,agTooltipComponent:vs},this.enterpriseAgDefaultCompsModule={agSetColumnFilter:m.SetFilterModule,agSetColumnFloatingFilter:m.SetFilterModule,agMultiColumnFilter:m.MultiFilterModule,agMultiColumnFloatingFilter:m.MultiFilterModule,agGroupColumnFilter:m.RowGroupingModule,agGroupColumnFloatingFilter:m.RowGroupingModule,agRichSelect:m.RichSelectModule,agRichSelectCellEditor:m.RichSelectModule,agDetailCellRenderer:m.MasterDetailModule,agSparklineCellRenderer:m.SparklinesModule},this.jsComps={}}init(){null!=this.gridOptions.components&&a(this.gridOptions.components,(e,t)=>this.registerJsComponent(e,t))}registerDefaultComponent(e,t){this.agGridDefaults[e]?console.error("Trying to overwrite a default component. You should call registerComponent"):this.agGridDefaults[e]=t}registerJsComponent(e,t){this.jsComps[e]=t}retrieve(e,t){const i=(e,t)=>({componentFromFramework:t,component:e}),n=this.getFrameworkOverrides().frameworkComponent(t,this.gridOptions.components);if(null!=n)return i(n,!0);const r=this.jsComps[t];if(r){return i(r,this.getFrameworkOverrides().isFrameworkComponent(r))}const o=this.agGridDefaults[t];if(o)return i(o,!1);const s=this.enterpriseAgDefaultCompsModule[t];return s?v.__assertRegistered(s,`AG Grid '${e}' component: ${t}`,this.context.getGridId()):l(()=>{this.warnAboutMissingComponent(e,t)},"MissingComp"+t),null}warnAboutMissingComponent(e,t){const i=Yt(t,[...Object.keys(this.agGridDefaults).filter(e=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(e)),...Object.keys(this.jsComps)],!0,.8);console.warn(`AG Grid: Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.`),i.length>0&&console.warn(`         Did you mean: [${i.slice(0,3)}]?`),console.warn("If using a custom component check it has been registered as described in: https://ag-grid.com/javascript-data-grid/components/")}};Rs([s("gridOptions")],Ms.prototype,"gridOptions",void 0),Rs([r],Ms.prototype,"init",null),Ms=Rs([o("userComponentRegistry")],Ms);const ks={propertyName:"dateComponent",cellRenderer:!1},Os={propertyName:"headerComponent",cellRenderer:!1},Ns={propertyName:"headerGroupComponent",cellRenderer:!1},Is={propertyName:"cellRenderer",cellRenderer:!0},Ls={propertyName:"cellEditor",cellRenderer:!1},Ps={propertyName:"innerRenderer",cellRenderer:!0},Fs={propertyName:"loadingOverlayComponent",cellRenderer:!1},Gs={propertyName:"noRowsOverlayComponent",cellRenderer:!1},$s={propertyName:"tooltipComponent",cellRenderer:!1},Hs={propertyName:"filter",cellRenderer:!1},Bs={propertyName:"floatingFilterComponent",cellRenderer:!1},Vs={propertyName:"toolPanel",cellRenderer:!1},js={propertyName:"statusPanel",cellRenderer:!1},zs={propertyName:"fullWidthCellRenderer",cellRenderer:!0},Ws={propertyName:"loadingCellRenderer",cellRenderer:!0},Us={propertyName:"groupRowRenderer",cellRenderer:!0},Ys={propertyName:"detailCellRenderer",cellRenderer:!0};class qs{static getFloatingFilterType(e){return this.filterToFloatingFilterMapping[e]}}qs.filterToFloatingFilterMapping={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"};var Ks=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Xs=class extends p{getHeaderCompDetails(e,t){return this.getCompDetails(e,Os,"agColumnHeader",t)}getHeaderGroupCompDetails(e){const t=e.columnGroup.getColGroupDef();return this.getCompDetails(t,Ns,"agColumnGroupHeader",e)}getFullWidthCellRendererDetails(e){return this.getCompDetails(this.gridOptions,zs,null,e,!0)}getFullWidthLoadingCellRendererDetails(e){return this.getCompDetails(this.gridOptions,Ws,"agLoadingCellRenderer",e,!0)}getFullWidthGroupCellRendererDetails(e){return this.getCompDetails(this.gridOptions,Us,"agGroupRowRenderer",e,!0)}getFullWidthDetailCellRendererDetails(e){return this.getCompDetails(this.gridOptions,Ys,"agDetailCellRenderer",e,!0)}getInnerRendererDetails(e,t){return this.getCompDetails(e,Ps,null,t)}getFullWidthGroupRowInnerCellRenderer(e,t){return this.getCompDetails(e,Ps,null,t)}getCellRendererDetails(e,t){return this.getCompDetails(e,Is,null,t)}getCellEditorDetails(e,t){return this.getCompDetails(e,Ls,"agCellEditor",t,!0)}getFilterDetails(e,t,i){return this.getCompDetails(e,Hs,i,t,!0)}getDateCompDetails(e){return this.getCompDetails(this.gridOptions,ks,"agDateInput",e,!0)}getLoadingOverlayCompDetails(e){return this.getCompDetails(this.gridOptions,Fs,"agLoadingOverlay",e,!0)}getNoRowsOverlayCompDetails(e){return this.getCompDetails(this.gridOptions,Gs,"agNoRowsOverlay",e,!0)}getTooltipCompDetails(e){return this.getCompDetails(e.colDef,$s,"agTooltipComponent",e,!0)}getSetFilterCellRendererDetails(e,t){return this.getCompDetails(e,Is,null,t)}getFloatingFilterCompDetails(e,t,i){return this.getCompDetails(e,Bs,i,t)}getToolPanelCompDetails(e,t){return this.getCompDetails(e,Vs,null,t,!0)}getStatusPanelCompDetails(e,t){return this.getCompDetails(e,js,null,t,!0)}getCompDetails(e,t,i,n,r=!1){const{propertyName:o,cellRenderer:s}=t;let{compName:a,jsComp:l,fwComp:c,paramsFromSelector:u,popupFromSelector:d,popupPositionFromSelector:h}=this.getCompKeys(e,t,n);const f=e=>{const t=this.userComponentRegistry.retrieve(o,e);t&&(l=t.componentFromFramework?void 0:t.component,c=t.componentFromFramework?t.component:void 0)};if(null!=a&&f(a),null==l&&null==c&&null!=i&&f(i),l&&s&&!this.agComponentUtils.doesImplementIComponent(l)&&(l=this.agComponentUtils.adaptFunction(o,l)),!l&&!c)return void(r&&console.error(`AG Grid: Could not find component ${a}, did you forget to configure this component?`));const p=this.mergeParamsWithApplicationProvidedParams(e,t,n,u),g=null==l,m=l||c;return{componentFromFramework:g,componentClass:m,params:p,type:t,popupFromSelector:d,popupPositionFromSelector:h,newAgStackInstance:()=>this.newAgStackInstance(m,g,p,t)}}getCompKeys(n,r,o){const{propertyName:s}=r;let a,l,c,u,d,h;if(n){const r=n,e=r[s+"Selector"],t=e?e(o):null,i=e=>{if("string"==typeof e)a=e;else if(null!=e&&!0!==e){this.getFrameworkOverrides().isFrameworkComponent(e)?c=e:l=e}};t?(i(t.component),u=t.params,d=t.popup,h=t.popupPosition):i(r[s])}return{compName:a,jsComp:l,fwComp:c,paramsFromSelector:u,popupFromSelector:d,popupPositionFromSelector:h}}newAgStackInstance(e,t,i,n){const r=n.propertyName;let o;if(!t)o=new e;else{const t=this.componentMetadataProvider.retrieve(r);o=this.frameworkComponentWrapper.wrap(e,t.mandatoryMethodList,t.optionalMethodList,n)}const s=this.initComponent(o,i);return null==s?Rr.resolve(o):s.then(()=>o)}mergeParamsWithApplicationProvidedParams(e,t,i,n=null){const r={context:this.gridOptionsService.context,columnApi:this.gridOptionsService.columnApi,api:this.gridOptionsService.api};be(r,i);const o=e&&e[t.propertyName+"Params"];if("function"==typeof o){be(r,o(i))}else"object"==typeof o&&be(r,o);return be(r,n),r}initComponent(e,t){if(this.context.createBean(e),null!=e.init)return e.init(t)}getDefaultFloatingFilterType(e,t){if(null==e)return null;let i=null,{compName:n,jsComp:r,fwComp:o}=this.getCompKeys(e,Hs);if(n)i=qs.getFloatingFilterType(n);else{null==r&&null==o&&!0===e.filter&&(i=t())}return i}};var Zs;Ks([s("gridOptions")],Xs.prototype,"gridOptions",void 0),Ks([s("agComponentUtils")],Xs.prototype,"agComponentUtils",void 0),Ks([s("componentMetadataProvider")],Xs.prototype,"componentMetadataProvider",void 0),Ks([s("userComponentRegistry")],Xs.prototype,"userComponentRegistry",void 0),Ks([c("frameworkComponentWrapper")],Xs.prototype,"frameworkComponentWrapper",void 0),Xs=Ks([o("userComponentFactory")],Xs),function(e){e[e.SINGLE_SHEET=0]="SINGLE_SHEET",e[e.MULTI_SHEET=1]="MULTI_SHEET"}(Zs||(Zs={}));var Qs=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Js=class extends p{constructor(){super(...arguments),this.dragEndFunctions=[],this.dragSources=[]}removeAllListeners(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0}removeListener(e){const t=e.dragSource.eElement,i=e.mouseDownListener;if(t.removeEventListener("mousedown",i),e.touchEnabled){const i=e.touchStartListener;t.removeEventListener("touchstart",i,{passive:!0})}}removeDragSource(t){const e=this.dragSources.find(e=>e.dragSource===t);e&&(this.removeListener(e),st(this.dragSources,e))}isDragging(){return this.dragging}addDragSource(t){const e=this.onMouseDown.bind(this,t),{eElement:i,includeTouch:n,stopPropagationForTouch:r}=t;i.addEventListener("mousedown",e);let o=null;const s=this.gridOptionsService.is("suppressTouch");n&&!s&&(o=e=>{Rn(e.target)||(e.cancelable&&(e.preventDefault(),r&&e.stopPropagation()),this.onTouchStart(t,e))},i.addEventListener("touchstart",o,{passive:!1})),this.dragSources.push({dragSource:t,mouseDownListener:e,touchStartListener:o,touchEnabled:!!n})}getStartTarget(){return this.startTarget}onTouchStart(t,e){this.currentDragParams=t,this.dragging=!1;const i=e.touches[0];this.touchLastTime=i,this.touchStart=i;const n=e=>this.onTouchUp(e,t.eElement),r=e.target,o=[{target:this.gridOptionsService.getRootNode(),type:"touchmove",listener:e=>{e.cancelable&&e.preventDefault()},options:{passive:!1}},{target:r,type:"touchmove",listener:e=>this.onTouchMove(e,t.eElement),options:{passive:!0}},{target:r,type:"touchend",listener:n,options:{passive:!0}},{target:r,type:"touchcancel",listener:n,options:{passive:!0}}];this.addTemporaryEvents(o),0===t.dragStartPixels&&this.onCommonMove(i,this.touchStart,t.eElement)}onMouseDown(t,e){const i=e;if(t.skipMouseEvent&&t.skipMouseEvent(e))return;if(i._alreadyProcessedByDragService)return;if(i._alreadyProcessedByDragService=!0,0!==e.button)return;this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.currentDragParams=t,this.dragging=!1,this.mouseStartEvent=e,this.startTarget=e.target;const n=this.gridOptionsService.getRootNode(),r=[{target:n,type:"mousemove",listener:e=>this.onMouseMove(e,t.eElement)},{target:n,type:"mouseup",listener:e=>this.onMouseUp(e,t.eElement)},{target:n,type:"contextmenu",listener:e=>e.preventDefault()}];this.addTemporaryEvents(r),0===t.dragStartPixels&&this.onMouseMove(e,t.eElement)}addTemporaryEvents(e){e.forEach(e=>{const{target:t,type:i,listener:n,options:r}=e;t.addEventListener(i,n,r)}),this.dragEndFunctions.push(()=>{e.forEach(e=>{const{target:t,type:i,listener:n,options:r}=e;t.removeEventListener(i,n,r)})})}isEventNearStartEvent(e,t){const{dragStartPixels:i}=this.currentDragParams;return Cr(e,t,C(i)?i:4)}getFirstActiveTouch(t){for(let e=0;e<t.length;e++)if(t[e].identifier===this.touchStart.identifier)return t[e];return null}onCommonMove(t,i,n){if(!this.dragging){if(!this.dragging&&this.isEventNearStartEvent(t,i))return;this.dragging=!0;const e={type:y.EVENT_DRAG_STARTED,target:n};this.eventService.dispatchEvent(e),this.currentDragParams.onDragStart(i),this.currentDragParams.onDragging(i)}this.currentDragParams.onDragging(t)}onTouchMove(e,t){const i=this.getFirstActiveTouch(e.touches);i&&this.onCommonMove(i,this.touchStart,t)}onMouseMove(e,t){this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,t)}shouldPreventMouseEvent(e){const t=this.gridOptionsService.is("enableCellTextSelection"),i=Zi(),n="mousemove"===e.type;return(t&&n||i)&&e.cancelable&&this.mouseEventService.isEventFromThisGrid(e)&&!this.isOverFormFieldElement(e)}isOverFormFieldElement(e){const t=e.target,i=null==t?void 0:t.tagName.toLocaleLowerCase();return!!(null==i?void 0:i.match("^a$|textarea|input|select|button"))}onTouchUp(e,t){let i=this.getFirstActiveTouch(e.changedTouches);i||(i=this.touchLastTime),this.onUpCommon(i,t)}onMouseUp(e,t){this.onUpCommon(e,t)}onUpCommon(t,i){if(this.dragging){this.dragging=!1,this.currentDragParams.onDragStop(t);const e={type:y.EVENT_DRAG_STOPPED,target:i};this.eventService.dispatchEvent(e)}this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach(e=>e()),this.dragEndFunctions.length=0}};var ea,ta;Qs([s("mouseEventService")],Js.prototype,"mouseEventService",void 0),Qs([Ve],Js.prototype,"removeAllListeners",null),Js=Qs([o("dragService")],Js),function(e){e[e.Above=0]="Above",e[e.Below=1]="Below"}(ea||(ea={})),function(e){e.EVERYTHING="group",e.FILTER="filter",e.SORT="sort",e.MAP="map",e.AGGREGATE="aggregate",e.FILTER_AGGREGATES="filter_aggregates",e.PIVOT="pivot",e.NOTHING="nothing"}(ta||(ta={}));var k=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};function ia(e){const t=e;return null!=t&&null!=t.getFrameworkComponentInstance?t.getFrameworkComponentInstance():e}let O=class{constructor(){this.detailGridInfoMap={},this.destroyCalled=!1}registerOverlayWrapperComp(e){this.overlayWrapperComp=e}registerSideBarComp(e){this.sideBarComp=e}init(){switch(this.rowModel.getType()){case"clientSide":this.clientSideRowModel=this.rowModel;break;case"infinite":this.infiniteRowModel=this.rowModel;break;case"serverSide":this.serverSideRowModel=this.rowModel}this.ctrlsService.whenReady(()=>{this.gridBodyCtrl=this.ctrlsService.getGridBodyCtrl()})}__getAlignedGridService(){return this.alignedGridsService}__getContext(){return this.context}getSetterMethod(e){return`set${e.charAt(0).toUpperCase()}${e.substring(1)}`}__setProperty(e,t){this.gridOptionsService.set(e,t);const i=this.getSetterMethod(e),n=this;n[i]&&n[i](t)}getGridId(){return this.context.getGridId()}addDetailGridInfo(e,t){this.detailGridInfoMap[e]=t}removeDetailGridInfo(e){this.detailGridInfoMap[e]=void 0}getDetailGridInfo(e){return this.detailGridInfoMap[e]}forEachDetailGridInfo(i){let n=0;a(this.detailGridInfoMap,(e,t)=>{C(t)&&(i(t,n),n++)})}getDataAsCsv(e){if(v.__assertRegistered(m.CsvExportModule,"api.getDataAsCsv",this.context.getGridId()))return this.csvCreator.getDataAsCsv(e)}exportDataAsCsv(e){v.__assertRegistered(m.CsvExportModule,"api.exportDataAsCSv",this.context.getGridId())&&this.csvCreator.exportDataAsCsv(e)}getExcelExportMode(e){const t=this.gridOptionsService.get("defaultExcelExportParams");return Object.assign({exportMode:"xlsx"},t,e).exportMode}assertNotExcelMultiSheet(e,t){if(!v.__assertRegistered(m.ExcelExportModule,"api."+e,this.context.getGridId()))return!1;const i=this.getExcelExportMode(t);return this.excelCreator.getFactoryMode(i)!==Zs.MULTI_SHEET||(console.warn("AG Grid: The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'"),!1)}getDataAsExcel(e){if(this.assertNotExcelMultiSheet("getDataAsExcel",e))return this.excelCreator.getDataAsExcel(e)}exportDataAsExcel(e){this.assertNotExcelMultiSheet("exportDataAsExcel",e)&&this.excelCreator.exportDataAsExcel(e)}getSheetDataForExcel(e){if(!v.__assertRegistered(m.ExcelExportModule,"api.getSheetDataForExcel",this.context.getGridId()))return;const t=this.getExcelExportMode(e);return this.excelCreator.setFactoryMode(Zs.MULTI_SHEET,t),this.excelCreator.getSheetDataForExcel(e)}getMultipleSheetsAsExcel(e){if(v.__assertRegistered(m.ExcelExportModule,"api.getMultipleSheetsAsExcel",this.context.getGridId()))return this.excelCreator.getMultipleSheetsAsExcel(e)}exportMultipleSheetsAsExcel(e){if(v.__assertRegistered(m.ExcelExportModule,"api.exportMultipleSheetsAsExcel",this.context.getGridId()))return this.excelCreator.exportMultipleSheetsAsExcel(e)}setGridAriaProperty(e,t){if(!e)return;const i=this.ctrlsService.getGridBodyCtrl().getGui(),n="aria-"+e;null===t?i.removeAttribute(n):i.setAttribute(n,t)}logMissingRowModel(e,...t){console.error(`AG Grid: api.${e} can only be called when gridOptions.rowModelType is ${t.join(" or ")}`)}setServerSideDatasource(e){this.serverSideRowModel?this.serverSideRowModel.setDatasource(e):this.logMissingRowModel("setServerSideDatasource","serverSide")}setCacheBlockSize(e){this.serverSideRowModel?(this.gridOptionsService.set("cacheBlockSize",e),this.serverSideRowModel.resetRootStore()):this.logMissingRowModel("setCacheBlockSize","serverSide")}setDatasource(e){this.gridOptionsService.isRowModelType("infinite")?this.rowModel.setDatasource(e):this.logMissingRowModel("setDatasource","infinite")}setViewportDatasource(e){this.gridOptionsService.isRowModelType("viewport")?this.rowModel.setViewportDatasource(e):this.logMissingRowModel("setViewportDatasource","viewport")}setRowData(e){null==this.immutableService?this.logMissingRowModel("setRowData","clientSide"):this.immutableService.isActive()?this.immutableService.setRowData(e):(this.selectionService.reset(),this.clientSideRowModel.setRowData(e))}setPinnedTopRowData(e){this.pinnedRowModel.setPinnedTopRowData(e)}setPinnedBottomRowData(e){this.pinnedRowModel.setPinnedBottomRowData(e)}getPinnedTopRowCount(){return this.pinnedRowModel.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.pinnedRowModel.getPinnedBottomRowCount()}getPinnedTopRow(e){return this.pinnedRowModel.getPinnedTopRow(e)}getPinnedBottomRow(e){return this.pinnedRowModel.getPinnedBottomRow(e)}setColumnDefs(e,t="api"){this.columnModel.setColumnDefs(e,t),this.gridOptionsService.set("columnDefs",e,!0,{source:t})}setAutoGroupColumnDef(e,t="api"){this.gridOptionsService.set("autoGroupColumnDef",e,!0,{source:t})}setDefaultColDef(e,t="api"){this.gridOptionsService.set("defaultColDef",e,!0,{source:t})}setColumnTypes(e,t="api"){this.gridOptionsService.set("columnTypes",e,!0,{source:t})}expireValueCache(){this.valueCache.expire()}getVerticalPixelRange(){return this.gridBodyCtrl.getScrollFeature().getVScrollPosition()}getHorizontalPixelRange(){return this.gridBodyCtrl.getScrollFeature().getHScrollPosition()}setAlwaysShowHorizontalScroll(e){this.gridOptionsService.set("alwaysShowHorizontalScroll",e)}setAlwaysShowVerticalScroll(e){this.gridOptionsService.set("alwaysShowVerticalScroll",e)}refreshCells(e={}){this.rowRenderer.refreshCells(e)}flashCells(e={}){this.rowRenderer.flashCells(e)}redrawRows(e={}){const t=e?e.rowNodes:void 0;this.rowRenderer.redrawRows(t)}setFunctionsReadOnly(e){this.gridOptionsService.set("functionsReadOnly",e)}refreshHeader(){this.ctrlsService.getHeaderRowContainerCtrls().forEach(e=>e.refresh())}isAnyFilterPresent(){return this.filterManager.isAnyFilterPresent()}isColumnFilterPresent(){return this.filterManager.isColumnFilterPresent()||this.filterManager.isAggregateFilterPresent()}isQuickFilterPresent(){return this.filterManager.isQuickFilterPresent()}getModel(){return this.rowModel}setRowNodeExpanded(e,t,i){e&&(i&&e.parent&&-1!==e.parent.level&&this.setRowNodeExpanded(e.parent,t,i),e.setExpanded(t))}onGroupExpandedOrCollapsed(){u(this.clientSideRowModel)?this.logMissingRowModel("onGroupExpandedOrCollapsed","clientSide"):this.clientSideRowModel.refreshModel({step:ta.MAP})}refreshClientSideRowModel(e){u(this.clientSideRowModel)?this.logMissingRowModel("refreshClientSideRowModel","clientSide"):this.clientSideRowModel.refreshModel(e)}isAnimationFrameQueueEmpty(){return this.animationFrameService.isQueueEmpty()}flushAllAnimationFrames(){this.animationFrameService.flushAllFrames()}getRowNode(e){return this.rowModel.getRowNode(e)}getSizesForCurrentTheme(){return{rowHeight:this.gridOptionsService.getRowHeightAsNumber(),headerHeight:this.columnModel.getHeaderHeight()}}expandAll(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!0):this.serverSideRowModel?this.serverSideRowModel.expandAll(!0):this.logMissingRowModel("expandAll","clientSide","serverSide")}collapseAll(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!1):this.serverSideRowModel?this.serverSideRowModel.expandAll(!1):this.logMissingRowModel("expandAll","clientSide","serverSide")}addRenderedRowListener(e,t,i){this.rowRenderer.addRenderedRowListener(e,t,i)}getQuickFilter(){return this.gridOptionsService.get("quickFilterText")}setQuickFilter(e){this.gridOptionsService.set("quickFilterText",e)}setExcludeHiddenColumnsFromQuickFilter(e){Xt("30","setExcludeHiddenColumnsFromQuickFilter",void 0,"Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `setIncludeHiddenColumnsInQuickFilter`"),this.setIncludeHiddenColumnsInQuickFilter(!e)}setIncludeHiddenColumnsInQuickFilter(e){this.gridOptionsService.set("includeHiddenColumnsInQuickFilter",e)}setNodesSelected(e){if(!e.nodes.every(e=>e.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),!1):void 0!==e.id||(console.warn("AG Grid: cannot select node until id for node is known"),!1)))return;const{nodes:t,source:i,newValue:n}=e,r=t;this.selectionService.setNodesSelected({nodes:r,source:null!=i?i:"api",newValue:n})}selectAll(e="apiSelectAll"){this.selectionService.selectAllRowNodes({source:e})}deselectAll(e="apiSelectAll"){this.selectionService.deselectAllRowNodes({source:e})}selectAllFiltered(e="apiSelectAllFiltered"){this.selectionService.selectAllRowNodes({source:e,justFiltered:!0})}deselectAllFiltered(e="apiSelectAllFiltered"){this.selectionService.deselectAllRowNodes({source:e,justFiltered:!0})}getServerSideSelectionState(){return u(this.serverSideRowModel)?(this.logMissingRowModel("getServerSideSelectionState","serverSide"),null):this.selectionService.getServerSideSelectionState()}setServerSideSelectionState(e){u(this.serverSideRowModel)?this.logMissingRowModel("setServerSideSelectionState","serverSide"):this.selectionService.setServerSideSelectionState(e)}selectAllOnCurrentPage(e="apiSelectAllCurrentPage"){this.selectionService.selectAllRowNodes({source:e,justCurrentPage:!0})}deselectAllOnCurrentPage(e="apiSelectAllCurrentPage"){this.selectionService.deselectAllRowNodes({source:e,justCurrentPage:!0})}sizeColumnsToFit(e){this.gridBodyCtrl.sizeColumnsToFit(e)}showLoadingOverlay(){this.overlayWrapperComp.showLoadingOverlay()}showNoRowsOverlay(){this.overlayWrapperComp.showNoRowsOverlay()}hideOverlay(){this.overlayWrapperComp.hideOverlay()}getSelectedNodes(){return this.selectionService.getSelectedNodes()}getSelectedRows(){return this.selectionService.getSelectedRows()}getBestCostNodeSelection(){if(!u(this.clientSideRowModel))return this.selectionService.getBestCostNodeSelection();this.logMissingRowModel("getBestCostNodeSelection","clientSide")}getRenderedNodes(){return this.rowRenderer.getRenderedNodes()}ensureColumnVisible(e,t="auto"){this.gridBodyCtrl.getScrollFeature().ensureColumnVisible(e,t)}ensureIndexVisible(e,t){this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(e,t)}ensureNodeVisible(e,t=null){this.gridBodyCtrl.getScrollFeature().ensureNodeVisible(e,t)}forEachLeafNode(e){u(this.clientSideRowModel)?this.logMissingRowModel("forEachLeafNode","clientSide"):this.clientSideRowModel.forEachLeafNode(e)}forEachNode(e,t){this.rowModel.forEachNode(e,t)}forEachNodeAfterFilter(e){u(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilter","clientSide"):this.clientSideRowModel.forEachNodeAfterFilter(e)}forEachNodeAfterFilterAndSort(e){u(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilterAndSort","clientSide"):this.clientSideRowModel.forEachNodeAfterFilterAndSort(e)}getFilterInstance(e,i){const t=this.getFilterInstanceImpl(e,e=>{if(!i)return;const t=ia(e);i(t)});return ia(t)}getFilterInstanceImpl(e,t){const i=this.columnModel.getPrimaryColumn(e);if(!i)return;const n=this.filterManager.getFilterComponent(i,"NO_UI"),r=n&&n.resolveNow(null,e=>e);return r?setTimeout(t,0,r):n&&n.then(e=>{t(e)}),r}destroyFilter(e){const t=this.columnModel.getPrimaryColumn(e);if(t)return this.filterManager.destroyFilter(t,"api")}getStatusPanel(e){if(!v.__assertRegistered(m.StatusBarModule,"api.getStatusPanel",this.context.getGridId()))return;return ia(this.statusBarService.getStatusPanel(e))}getColumnDef(e){const t=this.columnModel.getPrimaryColumn(e);return t?t.getColDef():null}getColumnDefs(){return this.columnModel.getColumnDefs()}onFilterChanged(){this.filterManager.onFilterChanged()}onSortChanged(){this.sortController.onSortChanged("api")}setFilterModel(e){this.filterManager.setFilterModel(e)}getFilterModel(){return this.filterManager.getFilterModel()}getFocusedCell(){return this.focusService.getFocusedCell()}clearFocusedCell(){return this.focusService.clearFocusedCell()}setFocusedCell(e,t,i){this.focusService.setFocusedCell({rowIndex:e,column:t,rowPinned:i,forceBrowserFocus:!0})}setSuppressRowDrag(e){this.gridOptionsService.set("suppressRowDrag",e)}setSuppressMoveWhenRowDragging(e){this.gridOptionsService.set("suppressMoveWhenRowDragging",e)}setSuppressRowClickSelection(e){this.gridOptionsService.set("suppressRowClickSelection",e)}addRowDropZone(e){this.gridBodyCtrl.getRowDragFeature().addRowDropZone(e)}removeRowDropZone(e){const t=this.dragAndDropService.findExternalZone(e);t&&this.dragAndDropService.removeDropTarget(t)}getRowDropZoneParams(e){return this.gridBodyCtrl.getRowDragFeature().getRowDropZone(e)}setHeaderHeight(e){this.gridOptionsService.set("headerHeight",e)}setDomLayout(e){this.gridOptionsService.set("domLayout",e)}setEnableCellTextSelection(e){this.gridBodyCtrl.setCellTextSelection(e)}setFillHandleDirection(e){this.gridOptionsService.set("fillHandleDirection",e)}setGroupHeaderHeight(e){this.gridOptionsService.set("groupHeaderHeight",e)}setFloatingFiltersHeight(e){this.gridOptionsService.set("floatingFiltersHeight",e)}setPivotHeaderHeight(e){this.gridOptionsService.set("pivotHeaderHeight",e)}setPivotGroupHeaderHeight(e){this.gridOptionsService.set("pivotGroupHeaderHeight",e)}setPivotMode(e){this.columnModel.setPivotMode(e)}setAnimateRows(e){this.gridOptionsService.set("animateRows",e)}setIsExternalFilterPresent(e){this.gridOptionsService.set("isExternalFilterPresent",e)}setDoesExternalFilterPass(e){this.gridOptionsService.set("doesExternalFilterPass",e)}setNavigateToNextCell(e){this.gridOptionsService.set("navigateToNextCell",e)}setTabToNextCell(e){this.gridOptionsService.set("tabToNextCell",e)}setTabToNextHeader(e){this.gridOptionsService.set("tabToNextHeader",e)}setNavigateToNextHeader(e){this.gridOptionsService.set("navigateToNextHeader",e)}setRowGroupPanelShow(e){this.gridOptionsService.set("rowGroupPanelShow",e)}setGetGroupRowAgg(e){this.gridOptionsService.set("getGroupRowAgg",e)}setGetBusinessKeyForNode(e){this.gridOptionsService.set("getBusinessKeyForNode",e)}setGetChildCount(e){this.gridOptionsService.set("getChildCount",e)}setProcessRowPostCreate(e){this.gridOptionsService.set("processRowPostCreate",e)}setGetRowId(e){this.gridOptionsService.set("getRowId",e)}setGetRowClass(e){this.gridOptionsService.set("getRowClass",e)}setIsFullWidthRow(e){this.gridOptionsService.set("isFullWidthRow",e)}setIsRowSelectable(e){this.gridOptionsService.set("isRowSelectable",e)}setIsRowMaster(e){this.gridOptionsService.set("isRowMaster",e)}setPostSortRows(e){this.gridOptionsService.set("postSortRows",e)}setGetDocument(e){this.gridOptionsService.set("getDocument",e)}setGetContextMenuItems(e){this.gridOptionsService.set("getContextMenuItems",e)}setGetMainMenuItems(e){this.gridOptionsService.set("getMainMenuItems",e)}setProcessCellForClipboard(e){this.gridOptionsService.set("processCellForClipboard",e)}setSendToClipboard(e){this.gridOptionsService.set("sendToClipboard",e)}setProcessCellFromClipboard(e){this.gridOptionsService.set("processCellFromClipboard",e)}setProcessSecondaryColDef(e){Xt("28.0","setProcessSecondaryColDef","setProcessPivotResultColDef"),this.setProcessPivotResultColDef(e)}setProcessSecondaryColGroupDef(e){Xt("28.0","setProcessSecondaryColGroupDef","setProcessPivotResultColGroupDef"),this.setProcessPivotResultColGroupDef(e)}setProcessPivotResultColDef(e){this.gridOptionsService.set("processPivotResultColDef",e)}setProcessPivotResultColGroupDef(e){this.gridOptionsService.set("processPivotResultColGroupDef",e)}setPostProcessPopup(e){this.gridOptionsService.set("postProcessPopup",e)}setInitialGroupOrderComparator(e){this.gridOptionsService.set("initialGroupOrderComparator",e)}setGetChartToolbarItems(e){this.gridOptionsService.set("getChartToolbarItems",e)}setPaginationNumberFormatter(e){this.gridOptionsService.set("paginationNumberFormatter",e)}setGetServerSideStoreParams(e){Xt("28.0","setGetServerSideStoreParams","setGetServerSideGroupLevelParams"),this.setGetServerSideGroupLevelParams(e)}setGetServerSideGroupLevelParams(e){this.gridOptionsService.set("getServerSideGroupLevelParams",e)}setIsServerSideGroupOpenByDefault(e){this.gridOptionsService.set("isServerSideGroupOpenByDefault",e)}setIsApplyServerSideTransaction(e){this.gridOptionsService.set("isApplyServerSideTransaction",e)}setIsServerSideGroup(e){this.gridOptionsService.set("isServerSideGroup",e)}setGetServerSideGroupKey(e){this.gridOptionsService.set("getServerSideGroupKey",e)}setGetRowStyle(e){this.gridOptionsService.set("getRowStyle",e)}setGetRowHeight(e){this.gridOptionsService.set("getRowHeight",e)}assertSideBarLoaded(e){return v.__assertRegistered(m.SideBarModule,"api."+e,this.context.getGridId())}isSideBarVisible(){return this.assertSideBarLoaded("isSideBarVisible")&&this.sideBarComp.isDisplayed()}setSideBarVisible(e){this.assertSideBarLoaded("setSideBarVisible")&&this.sideBarComp.setDisplayed(e)}setSideBarPosition(e){this.assertSideBarLoaded("setSideBarPosition")&&this.sideBarComp.setSideBarPosition(e)}openToolPanel(e){this.assertSideBarLoaded("openToolPanel")&&this.sideBarComp.openToolPanel(e,"api")}closeToolPanel(){this.assertSideBarLoaded("closeToolPanel")&&this.sideBarComp.close("api")}getOpenedToolPanel(){return this.assertSideBarLoaded("getOpenedToolPanel")?this.sideBarComp.openedItem():null}refreshToolPanel(){this.assertSideBarLoaded("refreshToolPanel")&&this.sideBarComp.refresh()}isToolPanelShowing(){return this.assertSideBarLoaded("isToolPanelShowing")&&this.sideBarComp.isToolPanelShowing()}getToolPanelInstance(e){if(this.assertSideBarLoaded("getToolPanelInstance")){return ia(this.sideBarComp.getToolPanelInstance(e))}}getSideBar(){if(this.assertSideBarLoaded("getSideBar"))return this.sideBarComp.getDef()}setSideBar(e){this.gridOptionsService.set("sideBar",e)}setSuppressClipboardPaste(e){this.gridOptionsService.set("suppressClipboardPaste",e)}resetRowHeights(){if(C(this.clientSideRowModel)){if(this.columnModel.isAutoRowHeightActive())return void console.warn("AG Grid: calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.");this.clientSideRowModel.resetRowHeights()}}setGroupRemoveSingleChildren(e){this.gridOptionsService.set("groupRemoveSingleChildren",e)}setGroupRemoveLowestSingleChildren(e){this.gridOptionsService.set("groupRemoveLowestSingleChildren",e)}setGroupDisplayType(e){this.gridOptionsService.set("groupDisplayType",e)}setRowClass(e){this.gridOptionsService.set("rowClass",e)}setDeltaSort(e){this.gridOptionsService.set("deltaSort",e)}setRowCount(e,t){if(this.serverSideRowModel)return this.columnModel.isRowGroupEmpty()?void this.serverSideRowModel.setRowCount(e,t):void console.error("AG Grid: setRowCount cannot be used while using row grouping.");this.infiniteRowModel?this.infiniteRowModel.setRowCount(e,t):this.logMissingRowModel("setRowCount","infinite","serverSide")}onRowHeightChanged(){this.clientSideRowModel?this.clientSideRowModel.onRowHeightChanged():this.serverSideRowModel&&this.serverSideRowModel.onRowHeightChanged()}getValue(e,t){let i=this.columnModel.getPrimaryColumn(e);return u(i)&&(i=this.columnModel.getGridColumn(e)),u(i)?null:this.valueService.getValue(i,t)}addEventListener(e,t){const i=this.gridOptionsService.useAsyncEvents();this.eventService.addEventListener(e,t,i)}addGlobalListener(e){const t=this.gridOptionsService.useAsyncEvents();this.eventService.addGlobalListener(e,t)}removeEventListener(e,t){const i=this.gridOptionsService.useAsyncEvents();this.eventService.removeEventListener(e,t,i)}removeGlobalListener(e){const t=this.gridOptionsService.useAsyncEvents();this.eventService.removeGlobalListener(e,t)}dispatchEvent(e){this.eventService.dispatchEvent(e)}destroy(){if(this.destroyCalled)return;this.destroyCalled=!0;const e=this.ctrlsService.getGridCtrl();e&&e.destroyGridUi(),this.context.destroy()}cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid(){setTimeout(Se.bind(window,this,"Grid API"),100)}warnIfDestroyed(e){return this.destroyCalled&&console.warn(`AG Grid: Grid API method ${e} was called on a grid that was destroyed.`),this.destroyCalled}resetQuickFilter(){this.warnIfDestroyed("resetQuickFilter")||this.filterManager.resetQuickFilterCache()}getCellRanges(){return this.rangeService?this.rangeService.getCellRanges():(v.__assertRegistered(m.RangeSelectionModule,"api.getCellRanges",this.context.getGridId()),null)}addCellRange(e){this.rangeService?this.rangeService.addCellRange(e):v.__assertRegistered(m.RangeSelectionModule,"api.addCellRange",this.context.getGridId())}clearRangeSelection(){this.rangeService&&this.rangeService.removeAllCellRanges(),v.__assertRegistered(m.RangeSelectionModule,"gridApi.clearRangeSelection",this.context.getGridId())}undoCellEditing(){this.undoRedoService.undo("api")}redoCellEditing(){this.undoRedoService.redo("api")}getCurrentUndoSize(){return this.undoRedoService.getCurrentUndoStackSize()}getCurrentRedoSize(){return this.undoRedoService.getCurrentRedoStackSize()}getChartModels(){if(v.__assertRegistered(m.GridChartsModule,"api.getChartModels",this.context.getGridId()))return this.chartService.getChartModels()}getChartRef(e){if(v.__assertRegistered(m.GridChartsModule,"api.getChartRef",this.context.getGridId()))return this.chartService.getChartRef(e)}getChartImageDataURL(e){if(v.__assertRegistered(m.GridChartsModule,"api.getChartImageDataURL",this.context.getGridId()))return this.chartService.getChartImageDataURL(e)}downloadChart(e){if(v.__assertRegistered(m.GridChartsModule,"api.downloadChart",this.context.getGridId()))return this.chartService.downloadChart(e)}openChartToolPanel(e){if(v.__assertRegistered(m.GridChartsModule,"api.openChartToolPanel",this.context.getGridId()))return this.chartService.openChartToolPanel(e)}closeChartToolPanel(e){if(v.__assertRegistered(m.GridChartsModule,"api.closeChartToolPanel",this.context.getGridId()))return this.chartService.closeChartToolPanel(e.chartId)}createRangeChart(e){if(v.__assertRegistered(m.GridChartsModule,"api.createRangeChart",this.context.getGridId()))return this.chartService.createRangeChart(e)}createPivotChart(e){if(v.__assertRegistered(m.GridChartsModule,"api.createPivotChart",this.context.getGridId()))return this.chartService.createPivotChart(e)}createCrossFilterChart(e){if(v.__assertRegistered(m.GridChartsModule,"api.createCrossFilterChart",this.context.getGridId()))return this.chartService.createCrossFilterChart(e)}updateChart(e){v.__assertRegistered(m.GridChartsModule,"api.updateChart",this.context.getGridId())&&this.chartService.updateChart(e)}restoreChart(e,t){if(v.__assertRegistered(m.GridChartsModule,"api.restoreChart",this.context.getGridId()))return this.chartService.restoreChart(e,t)}copyToClipboard(e){v.__assertRegistered(m.ClipboardModule,"api.copyToClipboard",this.context.getGridId())&&this.clipboardService.copyToClipboard(e)}cutToClipboard(e){v.__assertRegistered(m.ClipboardModule,"api.cutToClipboard",this.context.getGridId())&&this.clipboardService.cutToClipboard(e,"api")}copySelectedRowsToClipboard(e){v.__assertRegistered(m.ClipboardModule,"api.copySelectedRowsToClipboard",this.context.getGridId())&&this.clipboardService.copySelectedRowsToClipboard(e)}copySelectedRangeToClipboard(e){v.__assertRegistered(m.ClipboardModule,"api.copySelectedRangeToClipboard",this.context.getGridId())&&this.clipboardService.copySelectedRangeToClipboard(e)}copySelectedRangeDown(){v.__assertRegistered(m.ClipboardModule,"api.copySelectedRangeDown",this.context.getGridId())&&this.clipboardService.copyRangeDown()}pasteFromClipboard(){v.__assertRegistered(m.ClipboardModule,"api.pasteFromClipboard",this.context.getGridId())&&this.clipboardService.pasteFromClipboard()}showColumnMenuAfterButtonClick(e,t){const i=this.columnModel.getGridColumn(e);this.menuFactory.showMenuAfterButtonClick(i,t,"columnMenu")}showColumnMenuAfterMouseClick(e,t){let i=this.columnModel.getGridColumn(e);i||(i=this.columnModel.getPrimaryColumn(e)),i?this.menuFactory.showMenuAfterMouseEvent(i,t):console.error(`AG Grid: column '${e}' not found`)}hidePopupMenu(){this.contextMenuFactory&&this.contextMenuFactory.hideActiveMenu(),this.menuFactory.hideActiveMenu()}setPopupParent(e){this.gridOptionsService.set("popupParent",e)}tabToNextCell(e){return this.navigationService.tabToNextCell(!1,e)}tabToPreviousCell(e){return this.navigationService.tabToNextCell(!0,e)}getCellRendererInstances(e={}){return this.rowRenderer.getCellRendererInstances(e).map(ia)}getCellEditorInstances(e={}){return this.rowRenderer.getCellEditorInstances(e).map(ia)}getEditingCells(){return this.rowRenderer.getEditingCells()}stopEditing(e=!1){this.rowRenderer.stopEditing(e)}startEditingCell(e){const t=this.columnModel.getGridColumn(e.colKey);if(!t)return void console.warn("AG Grid: no column found for "+e.colKey);const i={rowIndex:e.rowIndex,rowPinned:e.rowPinned||null,column:t};null==e.rowPinned&&this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(e.rowIndex);const n=this.navigationService.getCellByPosition(i);n&&n.startRowOrCellEdit(e.key)}addAggFunc(e,t){this.aggFuncService&&this.aggFuncService.addAggFunc(e,t)}addAggFuncs(e){this.aggFuncService&&this.aggFuncService.addAggFuncs(e)}clearAggFuncs(){this.aggFuncService&&this.aggFuncService.clear()}applyServerSideTransaction(e){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransaction(e);this.logMissingRowModel("applyServerSideTransaction","serverSide")}applyServerSideTransactionAsync(e,t){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransactionAsync(e,t);this.logMissingRowModel("applyServerSideTransactionAsync","serverSide")}retryServerSideLoads(){this.serverSideRowModel?this.serverSideRowModel.retryLoads():this.logMissingRowModel("retryServerSideLoads","serverSide")}flushServerSideAsyncTransactions(){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.flushAsyncTransactions();this.logMissingRowModel("flushServerSideAsyncTransactions","serverSide")}applyTransaction(e){if(this.clientSideRowModel)return this.clientSideRowModel.updateRowData(e);this.logMissingRowModel("applyTransaction","clientSide")}applyTransactionAsync(e,t){this.clientSideRowModel?this.clientSideRowModel.batchUpdateRowData(e,t):this.logMissingRowModel("applyTransactionAsync","clientSide")}flushAsyncTransactions(){this.clientSideRowModel?this.clientSideRowModel.flushAsyncTransactions():this.logMissingRowModel("flushAsyncTransactions","clientSide")}setSuppressModelUpdateAfterUpdateTransaction(e){this.gridOptionsService.set("suppressModelUpdateAfterUpdateTransaction",e)}refreshInfiniteCache(){this.infiniteRowModel?this.infiniteRowModel.refreshCache():this.logMissingRowModel("refreshInfiniteCache","infinite")}purgeInfiniteCache(){this.infiniteRowModel?this.infiniteRowModel.purgeCache():this.logMissingRowModel("purgeInfiniteCache","infinite")}refreshServerSide(e){this.serverSideRowModel?this.serverSideRowModel.refreshStore(e):this.logMissingRowModel("refreshServerSide","serverSide")}refreshServerSideStore(e){return Xt("28.0","refreshServerSideStore","refreshServerSide"),this.refreshServerSide(e)}getServerSideStoreState(){return Xt("28.0","getServerSideStoreState","getServerSideGroupLevelState"),this.getServerSideGroupLevelState()}getServerSideGroupLevelState(){return this.serverSideRowModel?this.serverSideRowModel.getStoreState():(this.logMissingRowModel("getServerSideGroupLevelState","serverSide"),[])}getInfiniteRowCount(){if(this.infiniteRowModel)return this.infiniteRowModel.getRowCount();this.logMissingRowModel("getInfiniteRowCount","infinite")}isLastRowIndexKnown(){if(this.infiniteRowModel)return this.infiniteRowModel.isLastRowIndexKnown();this.logMissingRowModel("isLastRowIndexKnown","infinite")}getCacheBlockState(){return this.rowNodeBlockLoader.getBlockState()}getFirstDisplayedRow(){return this.rowRenderer.getFirstVirtualRenderedRow()}getLastDisplayedRow(){return this.rowRenderer.getLastVirtualRenderedRow()}getDisplayedRowAtIndex(e){return this.rowModel.getRow(e)}getDisplayedRowCount(){return this.rowModel.getRowCount()}setDataTypeDefinitions(e){this.gridOptionsService.set("dataTypeDefinitions",e)}setPagination(e){this.gridOptionsService.set("pagination",e)}paginationIsLastPageFound(){return this.paginationProxy.isLastPageFound()}paginationGetPageSize(){return this.paginationProxy.getPageSize()}paginationSetPageSize(e){this.gridOptionsService.set("paginationPageSize",e)}paginationGetCurrentPage(){return this.paginationProxy.getCurrentPage()}paginationGetTotalPages(){return this.paginationProxy.getTotalPages()}paginationGetRowCount(){return this.paginationProxy.getMasterRowCount()}paginationGoToNextPage(){this.paginationProxy.goToNextPage()}paginationGoToPreviousPage(){this.paginationProxy.goToPreviousPage()}paginationGoToFirstPage(){this.paginationProxy.goToFirstPage()}paginationGoToLastPage(){this.paginationProxy.goToLastPage()}paginationGoToPage(e){this.paginationProxy.goToPage(e)}};k([c("immutableService")],O.prototype,"immutableService",void 0),k([c("csvCreator")],O.prototype,"csvCreator",void 0),k([c("excelCreator")],O.prototype,"excelCreator",void 0),k([s("rowRenderer")],O.prototype,"rowRenderer",void 0),k([s("navigationService")],O.prototype,"navigationService",void 0),k([s("filterManager")],O.prototype,"filterManager",void 0),k([s("columnModel")],O.prototype,"columnModel",void 0),k([s("selectionService")],O.prototype,"selectionService",void 0),k([s("gridOptionsService")],O.prototype,"gridOptionsService",void 0),k([s("valueService")],O.prototype,"valueService",void 0),k([s("alignedGridsService")],O.prototype,"alignedGridsService",void 0),k([s("eventService")],O.prototype,"eventService",void 0),k([s("pinnedRowModel")],O.prototype,"pinnedRowModel",void 0),k([s("context")],O.prototype,"context",void 0),k([s("rowModel")],O.prototype,"rowModel",void 0),k([s("sortController")],O.prototype,"sortController",void 0),k([s("paginationProxy")],O.prototype,"paginationProxy",void 0),k([s("focusService")],O.prototype,"focusService",void 0),k([s("dragAndDropService")],O.prototype,"dragAndDropService",void 0),k([c("rangeService")],O.prototype,"rangeService",void 0),k([c("clipboardService")],O.prototype,"clipboardService",void 0),k([c("aggFuncService")],O.prototype,"aggFuncService",void 0),k([s("menuFactory")],O.prototype,"menuFactory",void 0),k([c("contextMenuFactory")],O.prototype,"contextMenuFactory",void 0),k([s("valueCache")],O.prototype,"valueCache",void 0),k([s("animationFrameService")],O.prototype,"animationFrameService",void 0),k([c("statusBarService")],O.prototype,"statusBarService",void 0),k([c("chartService")],O.prototype,"chartService",void 0),k([c("undoRedoService")],O.prototype,"undoRedoService",void 0),k([c("rowNodeBlockLoader")],O.prototype,"rowNodeBlockLoader",void 0),k([c("ssrmTransactionManager")],O.prototype,"serverSideTransactionManager",void 0),k([s("ctrlsService")],O.prototype,"ctrlsService",void 0),k([r],O.prototype,"init",null),k([Ve],O.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),O=k([o("gridApi")],O);var na,ra=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let oa=na=class extends p{constructor(){super(...arguments),this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.quickFilter=null,this.quickFilterParts=null,this.processingFilterChange=!1}init(){this.addManagedListener(this.eventService,y.EVENT_GRID_COLUMNS_CHANGED,()=>this.onColumnsChanged()),this.addManagedListener(this.eventService,y.EVENT_COLUMN_VALUE_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PIVOT_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>{this.refreshFiltersForAggregations(),this.resetQuickFilterCache()}),this.addManagedListener(this.eventService,y.EVENT_NEW_COLUMNS_LOADED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,y.EVENT_COLUMN_VISIBLE,()=>{this.gridOptionsService.is("includeHiddenColumnsInQuickFilter")||this.resetQuickFilterCache()}),this.addManagedPropertyListener("quickFilterText",e=>this.setQuickFilter(e.currentValue)),this.addManagedPropertyListener("includeHiddenColumnsInQuickFilter",()=>this.onIncludeHiddenColumnsInQuickFilterChanged()),this.quickFilter=this.parseQuickFilter(this.gridOptionsService.get("quickFilterText")),this.setQuickFilterParts(),this.allowShowChangeAfterFilter=this.gridOptionsService.is("allowShowChangeAfterFilter"),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>this.updateAggFiltering())}isExternalFilterPresentCallback(){const e=this.gridOptionsService.getCallback("isExternalFilterPresent");return"function"==typeof e&&e({})}doesExternalFilterPass(e){const t=this.gridOptionsService.get("doesExternalFilterPass");return"function"==typeof t&&t(e)}setQuickFilterParts(){this.quickFilterParts=this.quickFilter?this.quickFilter.split(" "):null}setFilterModel(n){const r=[],s=this.getFilterModel();if(n){const s=Ar(Object.keys(n));this.allColumnFilters.forEach((e,t)=>{const i=n[t];r.push(this.setModelOnFilterWrapper(e.filterPromise,i)),s.delete(t)}),s.forEach(e=>{const t=this.columnModel.getPrimaryColumn(e)||this.columnModel.getGridColumn(e);if(!t)return void console.warn("AG Grid: setFilterModel() - no column found for colId: "+e);if(!t.isFilterAllowed())return void console.warn("AG Grid: setFilterModel() - unable to fully apply model, filtering disabled for colId: "+e);const i=this.getOrCreateFilterWrapper(t,"NO_UI");i?r.push(this.setModelOnFilterWrapper(i.filterPromise,n[e])):console.warn("AG-Grid: setFilterModel() - unable to fully apply model, unable to create filter for colId: "+e)})}else this.allColumnFilters.forEach(e=>{r.push(this.setModelOnFilterWrapper(e.filterPromise,null))});Rr.all(r).then(()=>{const r=this.getFilterModel(),o=[];this.allColumnFilters.forEach((e,t)=>{const i=s?s[t]:null,n=r?r[t]:null;Er.jsonEquals(i,n)||o.push(e.column)}),o.length>0&&this.onFilterChanged({columns:o})})}setModelOnFilterWrapper(e,i){return new Rr(t=>{e.then(e=>{"function"!=typeof e.setModel&&(console.warn("AG Grid: filter missing setModel method, which is needed for setFilterModel"),t()),(e.setModel(i)||Rr.resolve()).then(()=>t())})})}getFilterModel(){const r={};return this.allColumnFilters.forEach((e,t)=>{const i=e.filterPromise.resolveNow(null,e=>e);if(null==i)return null;if("function"!=typeof i.getModel)return void console.warn("AG Grid: filter API missing getModel method, which is needed for getFilterModel");const n=i.getModel();C(n)&&(r[t]=n)}),r}isColumnFilterPresent(){return this.activeColumnFilters.length>0}isAggregateFilterPresent(){return!!this.activeAggregateFilters.length}isExternalFilterPresent(){return this.externalFilterPresent}doAggregateFiltersPass(e,t){return this.doColumnFiltersPass(e,t,!0)}updateActiveFilters(){this.activeColumnFilters.length=0,this.activeAggregateFilters.length=0;const t=e=>!!e&&(e.isFilterActive?e.isFilterActive():(console.warn("AG Grid: Filter is missing isFilterActive() method"),!1)),i=!!this.gridOptionsService.getGroupAggFiltering(),n=e=>{if(!e.isPrimary())return!0;const t=!this.columnModel.isPivotActive();return!(!e.isValueActive()||!t)&&(!!this.columnModel.isPivotMode()||i)};this.allColumnFilters.forEach(e=>{if(e.filterPromise.resolveNow(!1,t)){const t=e.filterPromise.resolveNow(null,e=>e);n(e.column)?this.activeAggregateFilters.push(t):this.activeColumnFilters.push(t)}})}updateFilterFlagInColumns(i,n){this.allColumnFilters.forEach(e=>{const t=e.filterPromise.resolveNow(!1,e=>e.isFilterActive());e.column.setFilterActive(t,i,n)})}isAnyFilterPresent(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()}doColumnFiltersPass(t,i,e){const{data:n,aggData:r}=t,o=e?this.activeAggregateFilters:this.activeColumnFilters,s=e?r:n;for(let e=0;e<o.length;e++){const n=o[e];if(null!=n&&n!==i){if("function"!=typeof n.doesFilterPass)throw new Error("Filter is missing method doesFilterPass");if(!n.doesFilterPass({node:t,data:s}))return!1}}return!0}parseQuickFilter(e){return C(e)?this.gridOptionsService.isRowModelType("clientSide")?e.toUpperCase():(console.warn("AG Grid - Quick filtering only works with the Client-Side Row Model"),null):null}setQuickFilter(e){if(null!=e&&"string"!=typeof e)return void console.warn("AG Grid - setQuickFilter() only supports string inputs, received: "+typeof e);const t=this.parseQuickFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setQuickFilterParts(),this.onFilterChanged())}resetQuickFilterCache(){this.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}onIncludeHiddenColumnsInQuickFilterChanged(){this.columnModel.refreshQuickFilterColumns(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.onFilterChanged()}refreshFiltersForAggregations(){this.gridOptionsService.getGroupAggFiltering()&&this.onFilterChanged()}callOnFilterChangedOutsideRenderCycle(e={}){const t=()=>this.onFilterChanged(e);this.rowRenderer.isRefreshInProgress()?setTimeout(t,0):t()}onFilterChanged(e={}){const{filterInstance:t,additionalEventAttributes:i,columns:n}=e;this.updateDependantFilters(),this.updateActiveFilters(),this.updateFilterFlagInColumns("filterChanged",i),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.allColumnFilters.forEach(e=>{e.filterPromise&&e.filterPromise.then(e=>{e&&e!==t&&e.onAnyFilterChanged&&e.onAnyFilterChanged()})});const r={type:y.EVENT_FILTER_CHANGED,columns:n||[]};i&&be(r,i),this.processingFilterChange=!0,this.eventService.dispatchEvent(r),this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!this.allowShowChangeAfterFilter&&this.processingFilterChange}isQuickFilterPresent(){return null!==this.quickFilter}updateAggFiltering(){this.aggFiltering=!!this.gridOptionsService.getGroupAggFiltering()}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&(this.aggFiltering||this.columnModel.isPivotMode())}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!(this.aggFiltering||this.columnModel.isPivotMode())}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,filterInstanceToSkip:e})}doesRowPassQuickFilterNoCache(i,n){return this.columnModel.getAllColumnsForQuickFilter().some(e=>{const t=this.getQuickFilterTextForColumn(e,i);return C(t)&&t.indexOf(n)>=0})}doesRowPassQuickFilterCache(e,t){return e.quickFilterAggregateText||this.aggregateRowForQuickFilter(e),e.quickFilterAggregateText.indexOf(t)>=0}doesRowPassQuickFilter(t){const i=this.gridOptionsService.is("cacheQuickFilter");return this.quickFilterParts.every(e=>i?this.doesRowPassQuickFilterCache(t,e):this.doesRowPassQuickFilterNoCache(t,e))}doesRowPassAggregateFilters(e){return!(this.isAggregateQuickFilterPresent()&&!this.doesRowPassQuickFilter(e.rowNode))&&!(this.isAggregateFilterPresent()&&!this.doAggregateFiltersPass(e.rowNode,e.filterInstanceToSkip))}doesRowPassFilter(e){return!(this.isNonAggregateQuickFilterPresent()&&!this.doesRowPassQuickFilter(e.rowNode))&&(!(this.isExternalFilterPresent()&&!this.doesExternalFilterPass(e.rowNode))&&!(this.isColumnFilterPresent()&&!this.doColumnFiltersPass(e.rowNode,e.filterInstanceToSkip)))}getQuickFilterTextForColumn(t,i){let n=this.valueService.getValue(t,i,!0);const r=t.getColDef();if(r.getQuickFilterText){const e={value:n,node:i,data:i.data,column:t,colDef:r,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};n=r.getQuickFilterText(e)}return C(n)?n.toString().toUpperCase():null}aggregateRowForQuickFilter(i){const n=[];this.columnModel.getAllColumnsForQuickFilter().forEach(e=>{const t=this.getQuickFilterTextForColumn(e,i);C(t)&&n.push(t)}),i.quickFilterAggregateText=n.join(na.QUICK_FILTER_SEPARATOR)}onNewRowsLoaded(e){this.allColumnFilters.forEach(e=>{e.filterPromise.then(e=>{e.onNewRowsLoaded&&e.onNewRowsLoaded()})}),this.updateFilterFlagInColumns(e,{afterDataChange:!0}),this.updateActiveFilters()}createValueGetter(t){return({node:e})=>this.valueService.getValue(t,e,!0)}getFilterComponent(e,t,i=!0){var n;if(i)return(null===(n=this.getOrCreateFilterWrapper(e,t))||void 0===n?void 0:n.filterPromise)||null;const r=this.cachedFilter(e);return r?r.filterPromise:null}isFilterActive(e){const t=this.cachedFilter(e);return!!t&&t.filterPromise.resolveNow(!1,e=>e.isFilterActive())}getOrCreateFilterWrapper(t,i){if(!t.isFilterAllowed())return null;let n=this.cachedFilter(t);if(n)"NO_UI"!==i&&this.putIntoGui(n,i);else{n=this.createFilterWrapper(t,i);const e=t.getColId();this.allColumnFilters.set(e,n),this.allColumnListeners.set(e,this.addManagedListener(t,d.EVENT_COL_DEF_CHANGED,()=>this.checkDestroyFilter(e)))}return n}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(t){let i;if(v.__isRegistered(m.SetFilterModule,this.context.getGridId()))i="agSetColumnFilter";else{const e=t.getColDef().cellDataType;i="number"===e?"agNumberColumnFilter":"date"===e||"dateString"===e?"agDateColumnFilter":"agTextColumnFilter"}return i}getDefaultFloatingFilter(t){let i;if(v.__isRegistered(m.SetFilterModule,this.context.getGridId()))i="agSetColumnFloatingFilter";else{const e=t.getColDef().cellDataType;i="number"===e?"agNumberColumnFloatingFilter":"date"===e||"dateString"===e?"agDateColumnFloatingFilter":"agTextColumnFloatingFilter"}return i}createFilterInstance(i){const e=this.getDefaultFilter(i),t=i.getColDef();let n;const r=Object.assign(Object.assign({},this.createFilterParams(i,t)),{filterModifiedCallback:()=>{const e={type:y.EVENT_FILTER_MODIFIED,column:i,filterInstance:n};this.eventService.dispatchEvent(e)},filterChangedCallback:e=>{const t={filterInstance:n,additionalEventAttributes:e,columns:[i]};this.callOnFilterChangedOutsideRenderCycle(t)},doesRowPassOtherFilter:e=>this.doesRowPassOtherFilters(n,e)}),o=this.userComponentFactory.getFilterDetails(t,r,e);return o?{filterPromise:()=>{const e=o.newAgStackInstance();return e&&e.then(e=>n=e),e},compDetails:o}:{filterPromise:null,compDetails:null}}createFilterParams(e,t){return{column:e,colDef:ue(t),rowModel:this.rowModel,filterChangedCallback:()=>{},filterModifiedCallback:()=>{},valueGetter:this.createValueGetter(e),doesRowPassOtherFilter:()=>!0,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}}createFilterWrapper(e,t){var i;const n={column:e,filterPromise:null,compiledElement:null,guiPromise:Rr.resolve(null),compDetails:null},{filterPromise:r,compDetails:o}=this.createFilterInstance(e);return n.filterPromise=null!==(i=null==r?void 0:r())&&void 0!==i?i:null,n.compDetails=o,r&&this.putIntoGui(n,t),n}putIntoGui(r,o){const s=document.createElement("div");s.className="ag-filter",r.guiPromise=new Rr(n=>{r.filterPromise.then(e=>{let t=e.getGui();C(t)||console.warn(`AG Grid: getGui method from filter returned ${t}, it should be a DOM element or an HTML template string.`),"string"==typeof t&&(t=Un(t)),s.appendChild(t),n(s);const i={type:y.EVENT_FILTER_OPENED,column:r.column,source:o,eGui:s};this.eventService.dispatchEvent(i)})})}onColumnsChanged(){const n=[];this.allColumnFilters.forEach((e,t)=>{let i;i=e.column.isPrimary()?this.columnModel.getPrimaryColumn(t):this.columnModel.getGridColumn(t),i||(n.push(e.column),this.disposeFilterWrapper(e,"columnChanged"),this.disposeColumnListener(t))}),n.length>0?this.onFilterChanged({columns:n}):this.updateDependantFilters()}updateDependantFilters(){const e=this.columnModel.getGroupAutoColumns();null==e||e.forEach(e=>{"agGroupColumnFilter"===e.getColDef().filter&&this.getOrCreateFilterWrapper(e,"NO_UI")})}isFilterAllowed(e){var t,i;if(!e.isFilterAllowed())return!1;const n=this.allColumnFilters.get(e.getColId());return null===(i=null===(t=null==n?void 0:n.filterPromise)||void 0===t?void 0:t.resolveNow(!0,e=>{var t,i;return"function"!=typeof(null===(t=e)||void 0===t?void 0:t.isFilterAllowed)||(null===(i=e)||void 0===i?void 0:i.isFilterAllowed())}))||void 0===i||i}getFloatingFilterCompDetails(i,e){const t=i.getColDef(),n=this.createFilterParams(i,t),r=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(t,Hs,n);let o=this.userComponentFactory.getDefaultFloatingFilterType(t,()=>this.getDefaultFloatingFilter(i));null==o&&(o="agReadOnlyFloatingFilter");const s={column:i,filterParams:r,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(i),parentFilterInstance:t=>{const e=this.getFilterComponent(i,"NO_UI");null!=e&&e.then(e=>{t(ia(e))})},showParentFilter:e,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(t,s,o)}getCurrentFloatingFilterParentModel(e){const t=this.getFilterComponent(e,"NO_UI",!1);return t?t.resolveNow(null,e=>e&&e.getModel()):null}destroyFilter(e,t="api"){const i=e.getColId(),n=this.allColumnFilters.get(i);this.disposeColumnListener(i),n&&(this.disposeFilterWrapper(n,t),this.onFilterChanged({columns:[e]}))}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(i,n){i.filterPromise.then(t=>{(t.setModel(null)||Rr.resolve()).then(()=>{this.getContext().destroyBean(t),i.column.setFilterActive(!1,"filterDestroyed"),this.allColumnFilters.delete(i.column.getColId());const e={type:y.EVENT_FILTER_DESTROYED,source:n,column:i.column};this.eventService.dispatchEvent(e)})})}checkDestroyFilter(e){const t=this.allColumnFilters.get(e);if(!t)return;const i=t.column,{compDetails:n}=i.isFilterAllowed()?this.createFilterInstance(i):{compDetails:null};((e,t)=>{if(!t||!e)return!0;const{componentClass:i}=e,{componentClass:n}=t;return!(i===n||(null==i?void 0:i.render)&&(null==n?void 0:n.render)&&i.render===n.render)})(t.compDetails,n)&&this.destroyFilter(i,"columnChanged")}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear()}};oa.QUICK_FILTER_SEPARATOR="\n",ra([s("valueService")],oa.prototype,"valueService",void 0),ra([s("columnModel")],oa.prototype,"columnModel",void 0),ra([s("rowModel")],oa.prototype,"rowModel",void 0),ra([s("userComponentFactory")],oa.prototype,"userComponentFactory",void 0),ra([s("rowRenderer")],oa.prototype,"rowRenderer",void 0),ra([r],oa.prototype,"init",null),oa=na=ra([o("filterManager")],oa);class sa extends S{constructor(e,t){super(e),this.ctrl=t}getCtrl(){return this.ctrl}}var aa=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class la extends sa{constructor(e){super(la.TEMPLATE,e)}postConstruct(){const t=this.getGui(),e={addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),addOrRemoveBodyCssClass:(e,t)=>this.eFloatingFilterBody.classList.toggle(e,t),setButtonWrapperDisplayed:e=>w(this.eButtonWrapper,e),setCompDetails:e=>this.setCompDetails(e),getFloatingFilterComp:()=>this.compPromise,setWidth:e=>t.style.width=e,setMenuIcon:e=>this.eButtonShowMainFilter.appendChild(e)};this.ctrl.setComp(e,t,this.eButtonShowMainFilter,this.eFloatingFilterBody)}setCompDetails(e){if(!e)return this.destroyFloatingFilterComp(),void(this.compPromise=null);this.compPromise=e.newAgStackInstance(),this.compPromise.then(e=>this.afterCompCreated(e))}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui()),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(e){e&&(this.isAlive()?(this.destroyFloatingFilterComp(),this.floatingFilterComp=e,this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached()):this.destroyBean(e))}}la.TEMPLATE='<div class="ag-header-cell ag-floating-filter" role="gridcell" tabindex="-1">\n            <div ref="eFloatingFilterBody" role="presentation"></div>\n            <div class="ag-floating-filter-button ag-hidden" ref="eButtonWrapper" role="presentation">\n                <button type="button" class="ag-button ag-floating-filter-button-button" ref="eButtonShowMainFilter" tabindex="-1"></button>\n            </div>\n        </div>',aa([A("eFloatingFilterBody")],la.prototype,"eFloatingFilterBody",void 0),aa([A("eButtonWrapper")],la.prototype,"eButtonWrapper",void 0),aa([A("eButtonShowMainFilter")],la.prototype,"eButtonShowMainFilter",void 0),aa([r],la.prototype,"postConstruct",null),aa([Ve],la.prototype,"destroyFloatingFilterComp",null);var ca,ua=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e.AUTO_HEIGHT="ag-layout-auto-height",e.NORMAL="ag-layout-normal",e.PRINT="ag-layout-print"}(ca||(ca={}));class da extends p{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.getDomLayout(),t={autoHeight:"autoHeight"===e,normal:"normal"===e,print:"print"===e},i=t.autoHeight?ca.AUTO_HEIGHT:t.print?ca.PRINT:ca.NORMAL;this.view.updateLayoutClasses(i,t)}getDomLayout(){var e;const t=null!==(e=this.gridOptionsService.get("domLayout"))&&void 0!==e?e:"normal";return-1===["normal","print","autoHeight"].indexOf(t)?(l(()=>console.warn(`AG Grid: ${t} is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.`),"warn about dom layout values"),"normal"):t}}ua([r],da.prototype,"postConstruct",null);var ha,fa,pa=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal"}(ha||(ha={})),function(e){e[e.Container=0]="Container",e[e.FakeContainer=1]="FakeContainer"}(fa||(fa={}));class ga extends p{constructor(e){super(),this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.eBodyViewport=e,this.resetLastHScrollDebounced=Ie(()=>this.lastScrollSource[ha.Horizontal]=null,500),this.resetLastVScrollDebounced=Ie(()=>this.lastScrollSource[ha.Vertical]=null,500)}postConstruct(){this.enableRtl=this.gridOptionsService.is("enableRtl"),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this)),this.ctrlsService.whenReady(e=>{this.centerRowContainerCtrl=e.centerRowContainerCtrl,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}addScrollListener(){const e=this.ctrlsService.getFakeHScrollComp(),t=this.ctrlsService.getFakeVScrollComp();this.addManagedListener(this.centerRowContainerCtrl.getViewportElement(),"scroll",this.onHScroll.bind(this)),e.onScrollCallback(this.onFakeHScroll.bind(this));const i=this.gridOptionsService.is("debounceVerticalScrollbar"),n=i?Ie(this.onVScroll.bind(this),100):this.onVScroll.bind(this),r=i?Ie(this.onFakeVScroll.bind(this),100):this.onFakeVScroll.bind(this);this.addManagedListener(this.eBodyViewport,"scroll",n),t.onScrollCallback(r)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){if(null==this.centerRowContainerCtrl)return;void 0===e&&(e=this.centerRowContainerCtrl.getCenterViewportScrollLeft());const t=this.enableRtl?e:-e,i=this.ctrlsService.getTopCenterRowContainerCtrl(),n=this.ctrlsService.getStickyTopCenterRowContainerCtrl(),r=this.ctrlsService.getBottomCenterRowContainerCtrl(),o=this.ctrlsService.getFakeHScrollComp();this.ctrlsService.getHeaderRowContainerCtrl().setHorizontalScroll(-t),r.setContainerTranslateX(t),i.setContainerTranslateX(t),n.setContainerTranslateX(t);const s=this.centerRowContainerCtrl.getViewportElement(),a=this.lastScrollSource[ha.Horizontal]===fa.Container;e=Math.abs(e),a?o.setScrollPosition(e):Bn(s,e,this.enableRtl)}isControllingScroll(e,t){return null==this.lastScrollSource[t]?(this.lastScrollSource[t]=e,!0):this.lastScrollSource[t]===e}onFakeHScroll(){this.isControllingScroll(fa.FakeContainer,ha.Horizontal)&&this.onHScrollCommon(fa.FakeContainer)}onHScroll(){this.isControllingScroll(fa.Container,ha.Horizontal)&&this.onHScrollCommon(fa.Container)}onHScrollCommon(e){const t=this.centerRowContainerCtrl.getViewportElement(),{scrollLeft:i}=t;if(this.shouldBlockScrollUpdate(ha.Horizontal,i,!0))return;let n;n=e===fa.Container?Hn(t,this.enableRtl):this.ctrlsService.getFakeHScrollComp().getScrollPosition(),this.doHorizontalScroll(Math.round(n)),this.resetLastHScrollDebounced()}onFakeVScroll(){this.isControllingScroll(fa.FakeContainer,ha.Vertical)&&this.onVScrollCommon(fa.FakeContainer)}onVScroll(){this.isControllingScroll(fa.Container,ha.Vertical)&&this.onVScrollCommon(fa.Container)}onVScrollCommon(e){let t;t=e===fa.Container?this.eBodyViewport.scrollTop:this.ctrlsService.getFakeVScrollComp().getScrollPosition(),this.shouldBlockScrollUpdate(ha.Vertical,t,!0)||(this.animationFrameService.setScrollTop(t),this.nextScrollTop=t,e===fa.Container?this.ctrlsService.getFakeVScrollComp().setScrollPosition(t):this.eBodyViewport.scrollTop=t,this.gridOptionsService.is("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced())}doHorizontalScroll(e){const t=this.ctrlsService.getFakeHScrollComp().getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(ha.Horizontal),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.onHorizontalViewportChanged())}fireScrollEvent(e){const t={type:y.EVENT_BODY_SCROLL,direction:e===ha.Horizontal?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout(()=>{const e=Object.assign(Object.assign({},t),{type:y.EVENT_BODY_SCROLL_END});this.eventService.dispatchEvent(e)},100)}shouldBlockScrollUpdate(e,t,i=!1){return!(i&&!nn())&&(e===ha.Vertical?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t))}shouldBlockVerticalScroll(e){const t=In(this.eBodyViewport),{scrollHeight:i}=this.eBodyViewport;return e<0||e+t>i}shouldBlockHorizontalScroll(e){const t=this.centerRowContainerCtrl.getCenterWidth(),{scrollWidth:i}=this.centerRowContainerCtrl.getViewportElement();if(this.enableRtl&&$n()){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>i}redrawRowsAfterScroll(){this.fireScrollEvent(ha.Vertical)}onHorizontalViewportChanged(){this.centerRowContainerCtrl.onHorizontalViewportChanged()}checkScrollLeft(){this.scrollLeft!==this.centerRowContainerCtrl.getCenterViewportScrollLeft()&&this.onHScrollCommon(fa.Container)}scrollGridIfNeeded(){const e=this.scrollTop!=this.nextScrollTop;return e&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),e}setHorizontalScrollPosition(e,t=!1){const i=this.centerRowContainerCtrl.getViewportElement().scrollWidth-this.centerRowContainerCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(ha.Horizontal,e)&&(e=this.enableRtl&&$n()?e>0?0:i:Math.min(Math.max(e,0),i)),Bn(this.centerRowContainerCtrl.getViewportElement(),Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.eBodyViewport.scrollTop=e}getVScrollPosition(){return{top:this.eBodyViewport.scrollTop,bottom:this.eBodyViewport.scrollTop+this.eBodyViewport.offsetHeight}}getHScrollPosition(){return this.centerRowContainerCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.centerRowContainerCtrl.isHorizontalScrollShowing()}scrollHorizontally(e){const t=this.centerRowContainerCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowContainerCtrl.getViewportElement().scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(i,e=null){const n=this.rowModel.getRowCount();let r=-1;for(let t=0;t<n;t++){const n=this.rowModel.getRow(t);if("function"==typeof i){const e=i;if(n&&e(n)){r=t;break}}else if(i===n||i===n.data){r=t;break}}r>=0&&this.ensureIndexVisible(r,e)}ensureIndexVisible(p,g){if(this.gridOptionsService.isDomLayout("print"))return;const m=this.paginationProxy.getRowCount();if("number"!=typeof p||p<0||p>=m)return void console.warn("AG Grid: Invalid row index for ensureIndexVisible: "+p);this.gridOptionsService.is("pagination")&&!this.gridOptionsService.is("suppressPaginationPanel")||this.paginationProxy.goToPageWithIndex(p);const v=this.ctrlsService.getGridBodyCtrl().getStickyTopHeight(),y=this.paginationProxy.getRow(p);let b;do{const p=y.rowTop,m=y.rowHeight,e=this.paginationProxy.getPixelOffset(),t=y.rowTop-e,i=t+y.rowHeight,n=this.getVScrollPosition(),r=this.heightScaler.getDivStretchOffset(),o=n.top+r,s=n.bottom+r,a=s-o,l=this.heightScaler.getScrollPositionForPixel(t),c=this.heightScaler.getScrollPositionForPixel(i-a),u=Math.min((l+c)/2,t),d=o+v>t,h=s<i;let f=null;"top"===g?f=l:"bottom"===g?f=c:"middle"===g?f=u:d?f=l-v:h&&(f=c),null!==f&&(this.setVerticalScrollPosition(f),this.rowRenderer.redraw()),b=p!==y.rowTop||m!==y.rowHeight}while(b);this.animationFrameService.flushAllFrames()}ensureColumnVisible(e,t="auto"){const i=this.columnModel.getGridColumn(e);if(!i)return;if(i.isPinned())return;if(!this.columnModel.isColumnDisplayed(i))return;const n=this.getPositionedHorizontalScroll(i,t);null!==n&&this.centerRowContainerCtrl.setCenterViewportScrollLeft(n),this.centerRowContainerCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:i,columnAfterEnd:n}=this.isColumnOutsideViewport(e),r=this.centerRowContainerCtrl.getCenterWidth()<e.getActualWidth(),o=this.centerRowContainerCtrl.getCenterWidth(),s=this.enableRtl;let a=(s?i:n)||r,l=s?n:i;"auto"!==t&&(a="start"===t,l="end"===t);const c="middle"===t;if(a||l||c){const{colLeft:t,colMiddle:i,colRight:n}=this.getColumnBounds(e);return c?i-o/2:a?s?n:t:s?t-o:n-o}return null}isColumnOutsideViewport(e){const{start:t,end:i}=this.getViewportBounds(),{colLeft:n,colRight:r}=this.getColumnBounds(e),o=this.enableRtl;return{columnBeforeStart:o?t>r:i<r,columnAfterEnd:o?i<n:t>n}}getColumnBounds(e){const t=this.enableRtl,i=this.columnModel.getBodyContainerWidth(),n=e.getActualWidth(),r=e.getLeft(),o=t?-1:1,s=t?i-r:r;return{colLeft:s,colMiddle:s+n/2*o,colRight:s+n*o}}getViewportBounds(){const e=this.centerRowContainerCtrl.getCenterWidth(),t=this.centerRowContainerCtrl.getCenterViewportScrollLeft();return{start:t,end:e+t,width:e}}}pa([s("ctrlsService")],ga.prototype,"ctrlsService",void 0),pa([s("animationFrameService")],ga.prototype,"animationFrameService",void 0),pa([s("paginationProxy")],ga.prototype,"paginationProxy",void 0),pa([s("rowModel")],ga.prototype,"rowModel",void 0),pa([s("rowContainerHeightService")],ga.prototype,"heightScaler",void 0),pa([s("rowRenderer")],ga.prototype,"rowRenderer",void 0),pa([s("columnModel")],ga.prototype,"columnModel",void 0),pa([r],ga.prototype,"postConstruct",null);class ma{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=-1!==e.scrollAxis.indexOf("x"),this.scrollVertically=-1!==e.scrollAxis.indexOf("y"),this.scrollByTick=null!=e.scrollByTick?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}check(e,t=!1){const i=t||this.shouldSkipVerticalScroll();if(i&&this.shouldSkipHorizontalScroll())return;const n=this.scrollContainer.getBoundingClientRect(),r=this.scrollByTick;this.tickLeft=e.clientX<n.left+r,this.tickRight=e.clientX>n.right-r,this.tickUp=e.clientY<n.top+r&&!i,this.tickDown=e.clientY>n.bottom-r&&!i,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){null===this.tickingInterval&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){let t;if(this.tickCount++,t=this.tickCount>20?200:this.tickCount>10?80:40,this.scrollVertically){const e=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(e-t),this.tickDown&&this.setVerticalPosition(e+t)}if(this.scrollHorizontally){const e=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(e-t),this.tickRight&&this.setHorizontalPosition(e+t)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}}var va=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class ya extends p{constructor(e){super(),this.isMultiRowDrag=!1,this.isGridSorted=!1,this.isGridFiltered=!1,this.isRowGroupActive=!1,this.eContainer=e}postConstruct(){this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel);const e=()=>{this.onSortChanged(),this.onFilterChanged(),this.onRowGroupChanged()};this.addManagedListener(this.eventService,y.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_MODEL_UPDATED,()=>{e()}),e(),this.ctrlsService.whenReady(()=>{const t=this.ctrlsService.getGridBodyCtrl();this.autoScrollService=new ma({scrollContainer:t.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:()=>t.getScrollFeature().getVScrollPosition().top,setVerticalPosition:e=>t.getScrollFeature().setVerticalScrollPosition(e),onScrollCallback:()=>{this.onDragging(this.lastDraggingEvent)}})})}onSortChanged(){this.isGridSorted=this.sortController.isSortActive()}onFilterChanged(){this.isGridFiltered=this.filterManager.isAnyFilterPresent()}onRowGroupChanged(){const e=this.columnModel.getRowGroupColumns();this.isRowGroupActive=!ee(e)}getContainer(){return this.eContainer}isInterestedIn(e){return e===es.RowDrag}getIconName(){return this.gridOptionsService.is("rowDragManaged")&&this.shouldPreventRowMove()?M.ICON_NOT_ALLOWED:M.ICON_MOVE}shouldPreventRowMove(){return this.isGridSorted||this.isGridFiltered||this.isRowGroupActive}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];const t=this.gridOptionsService.is("rowDragMultiRow"),i=[...this.selectionService.getSelectedNodes()].sort((e,t)=>null==e.rowIndex||null==t.rowIndex?0:this.getRowIndexNumber(e)-this.getRowIndexNumber(t)),n=e.dragItem.rowNode;return t&&-1!==i.indexOf(n)?(this.isMultiRowDrag=!0,i):(this.isMultiRowDrag=!1,[n])}onDragEnter(e){e.dragItem.rowNodes=this.getRowNodes(e),this.dispatchGridEvent(y.EVENT_ROW_DRAG_ENTER,e),this.getRowNodes(e).forEach(e=>{e.setDragging(!0)}),this.onEnterOrDragging(e)}onDragging(e){this.onEnterOrDragging(e)}isFromThisGrid(e){const{dragSourceDomDataKey:t}=e.dragSource;return t===this.gridOptionsService.getDomDataKey()}isDropZoneWithinThisGrid(e){const t=this.ctrlsService.getGridBodyCtrl().getGui(),{dropZoneTarget:i}=e;return!t.contains(i)}onEnterOrDragging(e){this.dispatchGridEvent(y.EVENT_ROW_DRAG_MOVE,e),this.lastDraggingEvent=e;const t=this.mouseEventService.getNormalisedPosition(e).y;this.gridOptionsService.is("rowDragManaged")&&this.doManagedDrag(e,t),this.autoScrollService.check(e.event)}doManagedDrag(e,t){const i=this.isFromThisGrid(e),n=this.gridOptionsService.is("rowDragManaged"),r=e.dragItem.rowNodes;n&&this.shouldPreventRowMove()||(this.gridOptionsService.is("suppressMoveWhenRowDragging")||!i?this.isDropZoneWithinThisGrid(e)||this.clientSideRowModel.highlightRowAtPixel(r[0],t):this.moveRows(r,t))}getRowIndexNumber(e){return parseInt(f(e.getRowIndexString().split("-")),10)}moveRowAndClearHighlight(t){const e=this.clientSideRowModel.getLastHighlightedRowNode(),i=e&&e.highlighted===ea.Below,n=this.mouseEventService.getNormalisedPosition(t).y,r=t.dragItem.rowNodes;let o=i?1:0;if(this.isFromThisGrid(t))r.forEach(e=>{e.rowTop<n&&(o-=1)}),this.moveRows(r,n,o);else{const t=this.gridOptionsService.getCallback("getRowId");let e=this.clientSideRowModel.getRowIndexAtPixel(n)+1;this.clientSideRowModel.getHighlightPosition(n)===ea.Above&&e--,this.clientSideRowModel.updateRowData({add:r.map(e=>e.data).filter(e=>!this.clientSideRowModel.getRowNode(t?t({data:e,level:0}):e.id)),addIndex:e})}this.clearRowHighlight()}clearRowHighlight(){this.clientSideRowModel.highlightRowAtPixel(null)}moveRows(e,t,i=0){this.clientSideRowModel.ensureRowsAtPixel(e,t,i)&&(this.focusService.clearFocusedCell(),this.rangeService&&this.rangeService.removeAllCellRanges())}addRowDropZone(t){if(!t.getContainer())return void l(()=>console.warn("AG Grid: addRowDropZone - A container target needs to be provided"),"add-drop-zone-empty-target");if(this.dragAndDropService.findExternalZone(t))return void console.warn("AG Grid: addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");let e={getContainer:t.getContainer};t.fromGrid?(t.fromGrid=void 0,e=t):(t.onDragEnter&&(e.onDragEnter=e=>{t.onDragEnter(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_ENTER,e))}),t.onDragLeave&&(e.onDragLeave=e=>{t.onDragLeave(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_LEAVE,e))}),t.onDragging&&(e.onDragging=e=>{t.onDragging(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_MOVE,e))}),t.onDragStop&&(e.onDragStop=e=>{t.onDragStop(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_END,e))})),this.dragAndDropService.addDropTarget(Object.assign({isInterestedIn:e=>e===es.RowDrag,getIconName:()=>M.ICON_MOVE,external:!0},e))}getRowDropZone(t){const e=this.getContainer.bind(this),i=this.onDragEnter.bind(this),n=this.onDragLeave.bind(this),r=this.onDragging.bind(this),o=this.onDragStop.bind(this);return t?{getContainer:e,onDragEnter:t.onDragEnter?e=>{i(e),t.onDragEnter(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_ENTER,e))}:i,onDragLeave:t.onDragLeave?e=>{n(e),t.onDragLeave(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_LEAVE,e))}:n,onDragging:t.onDragging?e=>{r(e),t.onDragging(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_MOVE,e))}:r,onDragStop:t.onDragStop?e=>{o(e),t.onDragStop(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_END,e))}:o,fromGrid:!0}:{getContainer:e,onDragEnter:i,onDragLeave:n,onDragging:r,onDragStop:o,fromGrid:!0}}draggingToRowDragEvent(e,t){const i=this.mouseEventService.getNormalisedPosition(t).y;let n,r,o=-1;switch(i>this.paginationProxy.getCurrentPageHeight()||(o=this.rowModel.getRowIndexAtPixel(i),n=this.rowModel.getRow(o)),t.vDirection){case ts.Down:r="down";break;case ts.Up:r="up";break;default:r=null}return{type:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,event:t.event,node:t.dragItem.rowNode,nodes:t.dragItem.rowNodes,overIndex:o,overNode:n,y:i,vDirection:r}}dispatchGridEvent(e,t){const i=this.draggingToRowDragEvent(e,t);this.eventService.dispatchEvent(i)}onDragLeave(e){this.dispatchGridEvent(y.EVENT_ROW_DRAG_LEAVE,e),this.stopDragging(e),this.gridOptionsService.is("rowDragManaged")&&this.clearRowHighlight(),this.isFromThisGrid(e)&&(this.isMultiRowDrag=!1)}onDragStop(e){this.dispatchGridEvent(y.EVENT_ROW_DRAG_END,e),this.stopDragging(e),!this.gridOptionsService.is("rowDragManaged")||!this.gridOptionsService.is("suppressMoveWhenRowDragging")&&this.isFromThisGrid(e)||this.isDropZoneWithinThisGrid(e)||this.moveRowAndClearHighlight(e)}stopDragging(e){this.autoScrollService.ensureCleared(),this.getRowNodes(e).forEach(e=>{e.setDragging(!1)})}}va([s("dragAndDropService")],ya.prototype,"dragAndDropService",void 0),va([s("rowModel")],ya.prototype,"rowModel",void 0),va([s("paginationProxy")],ya.prototype,"paginationProxy",void 0),va([s("columnModel")],ya.prototype,"columnModel",void 0),va([s("focusService")],ya.prototype,"focusService",void 0),va([s("sortController")],ya.prototype,"sortController",void 0),va([s("filterManager")],ya.prototype,"filterManager",void 0),va([s("selectionService")],ya.prototype,"selectionService",void 0),va([s("mouseEventService")],ya.prototype,"mouseEventService",void 0),va([s("ctrlsService")],ya.prototype,"ctrlsService",void 0),va([c("rangeService")],ya.prototype,"rangeService",void 0),va([r],ya.prototype,"postConstruct",null);var ba,_a=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e.ANIMATION_ON="ag-row-animation",e.ANIMATION_OFF="ag-row-no-animation"}(ba||(ba={}));class wa extends p{constructor(){super(...arguments),this.stickyTopHeight=0}getScrollFeature(){return this.bodyScrollFeature}getBodyViewportElement(){return this.eBodyViewport}setComp(e,t,i,n,r,o){this.comp=e,this.eGridBody=t,this.eBodyViewport=i,this.eTop=n,this.eBottom=r,this.eStickyTop=o,this.setCellTextSelection(this.gridOptionsService.is("enableCellTextSelection")),this.createManagedBean(new da(this.comp)),this.bodyScrollFeature=this.createManagedBean(new ga(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([n,i,r,o]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.ctrlsService.registerGridBodyCtrl(this)}getComp(){return this.comp}addEventListeners(){this.addManagedListener(this.eventService,y.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}addFocusListeners(e){e.forEach(o=>{this.addManagedListener(o,"focusin",e=>{const{target:t}=e,i=On(t,"ag-root",o);o.classList.toggle("ag-has-focus",!i)}),this.addManagedListener(o,"focusout",e=>{const{target:t,relatedTarget:i}=e,n=o.contains(i),r=On(i,"ag-root",o);On(t,"ag-root",o)||n&&!r||o.classList.remove("ag-has-focus")})})}setColumnMovingCss(e){this.comp.setColumnMovingCss("ag-column-moving",e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss("ag-selectable",e)}onScrollVisibilityChanged(){const e=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(e),this.setStickyTopWidth(e);const t=`calc(100% + ${(e&&this.gridOptionsService.getScrollbarWidth()||0)+(dn()?16:0)}px)`;this.animationFrameService.requestAnimationFrame(()=>this.comp.setBodyViewportWidth(t))}onGridColumnsChanged(){const e=this.columnModel.getAllGridColumns();this.comp.setColumnCount(e?e.length:0)}disableBrowserDragging(){this.addManagedListener(this.eGridBody,"dragstart",e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1})}addStopEditingWhenGridLosesFocus(){if(!this.gridOptionsService.is("stopEditingWhenCellsLoseFocus"))return;const t=e=>{const t=e.relatedTarget;if(null===on(t))return void this.rowRenderer.stopEditing();let i=n.some(e=>e.contains(t))&&this.mouseEventService.isElementInThisGrid(t);if(!i){const e=this.popupService;i=e.getActivePopups().some(e=>e.contains(t))||e.isElementWithinCustomPopup(t)}i||this.rowRenderer.stopEditing()},n=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop];n.forEach(e=>this.addManagedListener(e,"focusout",t))}updateRowCount(){const e=this.headerNavigationService.getHeaderRowCount(),t=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,i=-1===t?-1:e+t;this.comp.setRowCount(i)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gridOptionsService.is("alwaysShowVerticalScroll"),t=e?"ag-force-vertical-scroll":null,i=this.gridOptionsService.isDomLayout("normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||i&&nr(this.eBodyViewport)}setupRowAnimationCssClass(){const e=()=>{const e=this.gridOptionsService.isAnimateRows()&&!this.rowContainerHeightService.isStretching(),t=e?ba.ANIMATION_ON:ba.ANIMATION_OFF;this.comp.setRowAnimationCssOnBodyViewport(t,e)};e(),this.addManagedListener(this.eventService,y.EVENT_HEIGHT_SCALE_CHANGED,e),this.addManagedPropertyListener("animateRows",e)}getGridBodyElement(){return this.eGridBody}addBodyViewportListener(){const e=this.onBodyViewportContextMenu.bind(this);this.addManagedListener(this.eBodyViewport,"contextmenu",e),this.mockContextMenuForIPad(e),this.addManagedListener(this.eBodyViewport,"wheel",this.onBodyViewportWheel.bind(this)),this.addManagedListener(this.eStickyTop,"wheel",this.onStickyTopWheel.bind(this)),this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){const e=this.eBodyViewport.querySelector(".ag-full-width-container"),t=this.eBodyViewport.querySelector(".ag-center-cols-viewport");e&&t&&this.addManagedListener(e,"wheel",e=>this.onFullWidthContainerWheel(e,t))}onFullWidthContainerWheel(e,t){!e.deltaX||Math.abs(e.deltaY)>Math.abs(e.deltaX)||!this.mouseEventService.isEventFromThisGrid(e)||(e.preventDefault(),t.scrollBy({left:e.deltaX}))}onBodyViewportContextMenu(e,t,i){if(!e&&!i)return;if(this.gridOptionsService.is("preventDefaultOnContextMenu")){(e||i).preventDefault()}const{target:n}=e||t;if(n===this.eBodyViewport||n===this.ctrlsService.getCenterRowContainerCtrl().getViewportElement()){if(!this.contextMenuFactory)return;e?this.contextMenuFactory.onContextMenu(e,null,null,null,null,this.eGridBody):i&&this.contextMenuFactory.onContextMenu(null,i,null,null,null,this.eGridBody)}}mockContextMenuForIPad(t){if(!nn())return;const e=new D(this.eBodyViewport);this.addManagedListener(e,D.EVENT_LONG_TAP,e=>{t(void 0,e.touchStart,e.touchEvent)}),this.addDestroyFunc(()=>e.destroy())}onBodyViewportWheel(e){this.gridOptionsService.is("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&e.preventDefault()}onStickyTopWheel(e){e.preventDefault(),e.offsetY&&this.scrollVertically(e.deltaY)}getGui(){return this.eGridBody}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}addRowDragListener(){this.rowDragFeature=this.createManagedBean(new ya(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature)}getRowDragFeature(){return this.rowDragFeature}onPinnedRowDataChanged(){this.setFloatingHeights()}setFloatingHeights(){const{pinnedRowModel:e}=this;let t=e.getPinnedTopTotalHeight();t&&(t+=1);let i=e.getPinnedBottomTotalHeight();i&&(i+=1),this.comp.setTopHeight(t),this.comp.setBottomHeight(i),this.comp.setTopDisplay(t?"inherit":"none"),this.comp.setBottomDisplay(i?"inherit":"none"),this.setStickyTopOffsetTop()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(e+"px"),this.stickyTopHeight=e}getStickyTopHeight(){return this.stickyTopHeight}setStickyTopWidth(e){if(e){const e=this.gridOptionsService.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${e}px)`)}else this.comp.setStickyTopWidth("100%")}onHeaderHeightChanged(){this.setStickyTopOffsetTop()}setStickyTopOffsetTop(){const e=this.ctrlsService.getGridHeaderCtrl().getHeaderHeight(),t=this.pinnedRowModel.getPinnedTopTotalHeight();let i=0;e>0&&(i+=e+1),t>0&&(i+=t+1),this.comp.setStickyTopTop(i+"px")}sizeColumnsToFit(e,t){const i=this.isVerticalScrollShowing()?this.gridOptionsService.getScrollbarWidth():0,n=Ln(this.eGridBody)-i;n>0?this.columnModel.sizeColumnsToFit(n,"sizeColumnsToFit",!1,e):void 0===t?window.setTimeout(()=>{this.sizeColumnsToFit(e,100)},0):100===t?window.setTimeout(()=>{this.sizeColumnsToFit(e,500)},100):500===t?window.setTimeout(()=>{this.sizeColumnsToFit(e,-1)},500):console.warn("AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")}addScrollEventListener(e){this.eBodyViewport.addEventListener("scroll",e,{passive:!0})}removeScrollEventListener(e){this.eBodyViewport.removeEventListener("scroll",e)}}var Ca,xa;_a([s("animationFrameService")],wa.prototype,"animationFrameService",void 0),_a([s("rowContainerHeightService")],wa.prototype,"rowContainerHeightService",void 0),_a([s("ctrlsService")],wa.prototype,"ctrlsService",void 0),_a([s("columnModel")],wa.prototype,"columnModel",void 0),_a([s("scrollVisibleService")],wa.prototype,"scrollVisibleService",void 0),_a([c("contextMenuFactory")],wa.prototype,"contextMenuFactory",void 0),_a([s("headerNavigationService")],wa.prototype,"headerNavigationService",void 0),_a([s("dragAndDropService")],wa.prototype,"dragAndDropService",void 0),_a([s("pinnedRowModel")],wa.prototype,"pinnedRowModel",void 0),_a([s("rowRenderer")],wa.prototype,"rowRenderer",void 0),_a([s("popupService")],wa.prototype,"popupService",void 0),_a([s("mouseEventService")],wa.prototype,"mouseEventService",void 0),_a([s("rowModel")],wa.prototype,"rowModel",void 0),function(e){e[e.FILL=0]="FILL",e[e.RANGE=1]="RANGE"}(Ca||(Ca={})),function(e){e[e.VALUE=0]="VALUE",e[e.DIMENSION=1]="DIMENSION"}(xa||(xa={}));class Sa{constructor(e,t){this.beans=e,this.cellCtrl=t}setComp(e,t){this.cellComp=e,this.eGui=t,this.onRangeSelectionChanged()}onRangeSelectionChanged(){this.cellComp&&(this.rangeCount=this.beans.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected",0!==this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-1",1===this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-2",2===this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-3",3===this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-4",this.rangeCount>=4),this.cellComp.addOrRemoveCssClass("ag-cell-range-chart",this.hasChartRange),Yi(this.eGui,this.rangeCount>0||void 0),this.cellComp.addOrRemoveCssClass("ag-cell-range-single-cell",this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())}updateRangeBorders(){const e=this.getRangeBorders(),t=this.isSingleCell(),i=!t&&e.top,n=!t&&e.right,r=!t&&e.bottom,o=!t&&e.left;this.cellComp.addOrRemoveCssClass("ag-cell-range-top",i),this.cellComp.addOrRemoveCssClass("ag-cell-range-right",n),this.cellComp.addOrRemoveCssClass("ag-cell-range-bottom",r),this.cellComp.addOrRemoveCssClass("ag-cell-range-left",o)}isSingleCell(){const{rangeService:e}=this.beans;return 1===this.rangeCount&&e&&!e.isMoreThanOneCell()}getHasChartRange(){const{rangeService:e}=this.beans;if(!this.rangeCount||!e)return!1;const t=e.getCellRanges();return t.length>0&&t.every(e=>dt([xa.DIMENSION,xa.VALUE],e.type))}updateRangeBordersIfRangeCount(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())}getRangeBorders(){const e=this.beans.gridOptionsService.is("enableRtl");let i=!1,n=!1,r=!1,o=!1;const s=this.cellCtrl.getCellPosition().column,{rangeService:a,columnModel:l}=this.beans;let c,u;e?(c=l.getDisplayedColAfter(s),u=l.getDisplayedColBefore(s)):(c=l.getDisplayedColBefore(s),u=l.getDisplayedColAfter(s));const d=a.getCellRanges().filter(e=>a.isCellInSpecificRange(this.cellCtrl.getCellPosition(),e));c||(o=!0),u||(n=!0);for(let t=0;t<d.length&&!(i&&n&&r&&o);t++){const s=d[t],l=a.getRangeStartRow(s),e=a.getRangeEndRow(s);!i&&this.beans.rowPositionUtils.sameRow(l,this.cellCtrl.getCellPosition())&&(i=!0),!r&&this.beans.rowPositionUtils.sameRow(e,this.cellCtrl.getCellPosition())&&(r=!0),!o&&c&&s.columns.indexOf(c)<0&&(o=!0),!n&&u&&s.columns.indexOf(u)<0&&(n=!0)}return{top:i,right:n,bottom:r,left:o}}refreshHandle(){if(!this.beans.rangeService)return;const e=this.shouldHaveSelectionHandle();this.selectionHandle&&!e&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),e&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass("ag-cell-range-handle",!!this.selectionHandle)}shouldHaveSelectionHandle(){const{gridOptionsService:e,rangeService:t}=this.beans,i=t.getCellRanges(),n=i.length;if(this.rangeCount<1||n<1)return!1;const r=f(i),o=this.cellCtrl.getCellPosition(),s=e.is("enableFillHandle")&&!this.cellCtrl.isSuppressFillHandle(),a=e.is("enableRangeHandle");let l=1===n&&!this.cellCtrl.isEditing()&&(s||a);if(this.hasChartRange){const e=i[0].type===xa.DIMENSION&&t.isCellInSpecificRange(o,i[0]);this.cellComp.addOrRemoveCssClass("ag-cell-range-chart-category",e),l=r.type===xa.VALUE}return l&&null!=r.endRow&&t.isContiguousRange(r)&&t.isBottomRightCell(r,o)}addSelectionHandle(){const{gridOptionsService:e,rangeService:t}=this.beans,i=f(t.getCellRanges()).type,n=e.is("enableFillHandle")&&u(i)?Ca.FILL:Ca.RANGE;this.selectionHandle&&this.selectionHandle.getType()!==n&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.beans.selectionHandleFactory.createSelectionHandle(n)),this.selectionHandle.refresh(this.cellCtrl)}destroy(){this.beans.context.destroyBean(this.selectionHandle)}}class Aa extends p{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode(),this.setupColSpan(),this.setupRowSpan()}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode)}setComp(e){this.eGui=e,this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()}onDisplayColumnsChanged(){const e=this.getColSpanningList();it(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){null!=this.column.getColDef().colSpan&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListener(this.beans.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayColumnsChanged.bind(this)),this.addManagedListener(this.beans.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onWidthChanged.bind(this)))}onWidthChanged(){if(!this.eGui)return;const e=this.getCellWidth();this.eGui.style.width=e+"px"}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const n=this.column.getColSpan(this.rowNode),r=[];if(1===n)r.push(this.column);else{let t=this.column;const i=this.column.getPinned();for(let e=0;t&&e<n&&(r.push(t),t=this.beans.columnModel.getDisplayedColAfter(t),t&&!u(t))&&i===t.getPinned();e++);}return r}onLeftChanged(){if(!this.eGui)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=e+"px"}getCellLeft(){let e;return e=this.beans.gridOptionsService.is("enableRtl")&&this.colsSpanning?f(this.colsSpanning):this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.isPrintLayout()||"left"===this.column.getPinned())return e;const t=this.beans.columnModel.getDisplayedColumnsLeftWidth();if("right"===this.column.getPinned()){return t+this.beans.columnModel.getBodyContainerWidth()+(e||0)}return t+(e||0)}applyRowSpan(){if(1===this.rowSpan)return;const e=this.beans.gridOptionsService.getRowHeightAsNumber()*this.rowSpan;this.eGui.style.height=e+"px",this.eGui.style.zIndex="1"}destroy(){super.destroy()}}class Ea extends p{constructor(e,t){super(),this.staticClasses=[],this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const e=this.column.getColDef(),t={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:e,column:this.column,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};this.beans.stylingService.processClassRules(e.cellClassRules,t,e=>this.cellComp.addOrRemoveCssClass(e,!0),e=>this.cellComp.addOrRemoveCssClass(e,!1))}applyUserStyles(){const t=this.column.getColDef();if(!t.cellStyle)return;let i;if("function"==typeof t.cellStyle){const e={column:this.column,value:this.cellCtrl.getValue(),colDef:t,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};i=(0,t.cellStyle)(e)}else i=t.cellStyle;i&&this.cellComp.setUserStyles(i)}applyClassesFromColDef(){const e=this.column.getColDef(),t={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef:e,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};this.staticClasses.length&&this.staticClasses.forEach(e=>this.cellComp.addOrRemoveCssClass(e,!1)),this.staticClasses=this.beans.stylingService.getStaticCellClasses(e,t),this.staticClasses.length&&this.staticClasses.forEach(e=>this.cellComp.addOrRemoveCssClass(e,!0))}destroy(){super.destroy()}}class Ta extends p{constructor(e,t){super(),this.ctrl=e,this.beans=t}setComp(e){this.comp=e,this.setupTooltip()}setupTooltip(){this.browserTooltips=this.beans.gridOptionsService.is("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?this.comp.setTitle(null!=this.tooltip?this.tooltip:void 0):this.createTooltipFeatureIfNeeded()}updateTooltipText(){this.tooltip=this.ctrl.getTooltipValue()}createTooltipFeatureIfNeeded(){if(null!=this.genericTooltipFeature)return;const e={getTooltipParams:()=>this.getTooltipParams(),getGui:()=>this.ctrl.getGui()};this.genericTooltipFeature=this.createManagedBean(new Nr(e),this.beans.context)}refreshToolTip(){this.updateTooltipText(),this.browserTooltips&&this.comp.setTitle(null!=this.tooltip?this.tooltip:void 0)}getTooltipParams(){const e=this.ctrl,t=e.getColumn?e.getColumn():void 0,i=e.getColDef?e.getColDef():void 0,n=e.getRowNode?e.getRowNode():void 0;return{location:e.getLocation(),colDef:i,column:t,rowIndex:e.getRowIndex?e.getRowIndex():void 0,node:n,data:n?n.data:void 0,value:this.getTooltipText(),valueFormatted:e.getValueFormatted?e.getValueFormatted():void 0}}getTooltipText(){return this.tooltip}destroy(){super.destroy()}}var N=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let I=class{postConstruct(){this.doingMasterDetail=this.gridOptionsService.isMasterDetail(),this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.gridOptionsService.isRowModelType("serverSide")&&(this.serverSideRowModel=this.rowModel)}};N([s("resizeObserverService")],I.prototype,"resizeObserverService",void 0),N([s("paginationProxy")],I.prototype,"paginationProxy",void 0),N([s("context")],I.prototype,"context",void 0),N([s("columnApi")],I.prototype,"columnApi",void 0),N([s("gridApi")],I.prototype,"gridApi",void 0),N([s("gridOptionsService")],I.prototype,"gridOptionsService",void 0),N([s("expressionService")],I.prototype,"expressionService",void 0),N([s("environment")],I.prototype,"environment",void 0),N([s("rowRenderer")],I.prototype,"rowRenderer",void 0),N([s("templateService")],I.prototype,"templateService",void 0),N([s("valueService")],I.prototype,"valueService",void 0),N([s("eventService")],I.prototype,"eventService",void 0),N([s("columnModel")],I.prototype,"columnModel",void 0),N([s("headerNavigationService")],I.prototype,"headerNavigationService",void 0),N([s("navigationService")],I.prototype,"navigationService",void 0),N([s("columnAnimationService")],I.prototype,"columnAnimationService",void 0),N([c("rangeService")],I.prototype,"rangeService",void 0),N([s("focusService")],I.prototype,"focusService",void 0),N([c("contextMenuFactory")],I.prototype,"contextMenuFactory",void 0),N([s("popupService")],I.prototype,"popupService",void 0),N([s("valueFormatterService")],I.prototype,"valueFormatterService",void 0),N([s("stylingService")],I.prototype,"stylingService",void 0),N([s("columnHoverService")],I.prototype,"columnHoverService",void 0),N([s("userComponentFactory")],I.prototype,"userComponentFactory",void 0),N([s("userComponentRegistry")],I.prototype,"userComponentRegistry",void 0),N([s("animationFrameService")],I.prototype,"animationFrameService",void 0),N([s("dragService")],I.prototype,"dragService",void 0),N([s("dragAndDropService")],I.prototype,"dragAndDropService",void 0),N([s("sortController")],I.prototype,"sortController",void 0),N([s("filterManager")],I.prototype,"filterManager",void 0),N([s("rowContainerHeightService")],I.prototype,"rowContainerHeightService",void 0),N([s("frameworkOverrides")],I.prototype,"frameworkOverrides",void 0),N([s("cellPositionUtils")],I.prototype,"cellPositionUtils",void 0),N([s("rowPositionUtils")],I.prototype,"rowPositionUtils",void 0),N([s("selectionService")],I.prototype,"selectionService",void 0),N([c("selectionHandleFactory")],I.prototype,"selectionHandleFactory",void 0),N([s("rowCssClassCalculator")],I.prototype,"rowCssClassCalculator",void 0),N([s("rowModel")],I.prototype,"rowModel",void 0),N([s("ctrlsService")],I.prototype,"ctrlsService",void 0),N([s("ctrlsFactory")],I.prototype,"ctrlsFactory",void 0),N([s("agStackComponentsRegistry")],I.prototype,"agStackComponentsRegistry",void 0),N([s("valueCache")],I.prototype,"valueCache",void 0),N([s("rowNodeEventThrottle")],I.prototype,"rowNodeEventThrottle",void 0),N([s("localeService")],I.prototype,"localeService",void 0),N([s("valueParserService")],I.prototype,"valueParserService",void 0),N([r],I.prototype,"postConstruct",null),I=N([o("beans")],I);class Da extends I{constructor(e,t,i){super(),this.cellCtrl=e,this.beans=t,this.column=i}onMouseEvent(e,t){if(!bt(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t)}}onCellClicked(e){if(this.isDoubleClickOnIPad())return this.onCellDoubleClicked(e),void e.preventDefault();const{eventService:t,rangeService:i,gridOptionsService:n}=this.beans,r=e.ctrlKey||e.metaKey;i&&r&&i.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&i.intersectLastRange(!0);const o=this.cellCtrl.createEvent(e,y.EVENT_CELL_CLICKED);t.dispatchEvent(o);const s=this.column.getColDef();s.onCellClicked&&window.setTimeout(()=>s.onCellClicked(o),0);(n.is("singleClickEdit")||s.singleClickEdit)&&!n.is("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit()}isDoubleClickOnIPad(){if(!nn()||_t("dblclick"))return!1;const e=(new Date).getTime(),t=e-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=e,t}onCellDoubleClicked(e){const t=this.column.getColDef(),i=this.cellCtrl.createEvent(e,y.EVENT_CELL_DOUBLE_CLICKED);this.beans.eventService.dispatchEvent(i),"function"==typeof t.onCellDoubleClicked&&window.setTimeout(()=>t.onCellDoubleClicked(i),0);!this.beans.gridOptionsService.is("singleClickEdit")&&!this.beans.gridOptionsService.is("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit(null,e)}onMouseDown(e){const{ctrlKey:t,metaKey:i,shiftKey:n}=e,r=e.target,{eventService:o,rangeService:s}=this.beans;if(this.isRightClickInExistingRange(e))return;const a=s&&0!=s.getCellRanges().length;if(!n||!a){const e=Zi()&&!this.cellCtrl.isEditing()&&!Rn(r);this.cellCtrl.focusCell(e)}if(n&&a&&e.preventDefault(),!this.containsWidget(r)){if(s){const e=this.cellCtrl.getCellPosition();if(n)s.extendLatestRangeToCell(e);else{const n=t||i;s.setRangeToCell(e,n)}}o.dispatchEvent(this.cellCtrl.createEvent(e,y.EVENT_CELL_MOUSE_DOWN))}}isRightClickInExistingRange(e){const{rangeService:t}=this.beans;if(t){if(t.isCellInAnyRange(this.cellCtrl.getCellPosition())&&2===e.button)return!0}return!1}containsWidget(e){return On(e,"ag-selection-checkbox",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;const t=this.cellCtrl.createEvent(e,y.EVENT_CELL_MOUSE_OUT);this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;const t=this.cellCtrl.createEvent(e,y.EVENT_CELL_MOUSE_OVER);this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.getGui(),i=t.contains(e.target),n=t.contains(e.relatedTarget);return i&&n}destroy(){}}class Ra extends p{constructor(e,t,i,n,r){super(),this.cellCtrl=e,this.beans=t,this.rowNode=n,this.rowCtrl=r}setComp(e){this.eGui=e}onKeyDown(e){const t=e.key;switch(t){case x.ENTER:this.onEnterKeyDown(e);break;case x.F2:this.onF2KeyDown(e);break;case x.ESCAPE:this.onEscapeKeyDown(e);break;case x.TAB:this.onTabKeyDown(e);break;case x.BACKSPACE:case x.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case x.DOWN:case x.UP:case x.RIGHT:case x.LEFT:this.onNavigationKeyDown(e,t)}}onNavigationKeyDown(e,t){this.cellCtrl.isEditing()||(e.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(e):this.beans.navigationService.navigateToNextCell(e,t,this.cellCtrl.getCellPosition(),!0),e.preventDefault())}onShiftRangeSelect(e){if(!this.beans.rangeService)return;const t=this.beans.rangeService.extendLatestRangeInDirection(e);t&&this.beans.navigationService.ensureCellVisible(t)}onTabKeyDown(e){this.beans.navigationService.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){const{cellCtrl:i,beans:n,rowNode:r}=this,{gridOptionsService:o,rangeService:s,eventService:a}=n;i.isEditing()||(a.dispatchEvent({type:y.EVENT_KEY_SHORTCUT_CHANGED_CELL_START}),wr(e,o.is("enableCellEditingOnBackspace"))?s&&o.isEnableRangeSelection()?s.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"}):i.isCellEditable()&&r.setDataValue(i.getColumn(),null,"cellClear"):i.startRowOrCellEdit(e,t),a.dispatchEvent({type:y.EVENT_KEY_SHORTCUT_CHANGED_CELL_END}))}onEnterKeyDown(t){if(this.cellCtrl.isEditing()||this.rowCtrl.isEditing())this.cellCtrl.stopEditingAndFocus(!1,t.shiftKey);else if(this.beans.gridOptionsService.is("enterNavigatesVertically")){const e=t.shiftKey?x.UP:x.DOWN;this.beans.navigationService.navigateToNextCell(null,e,this.cellCtrl.getCellPosition(),!1)}else this.cellCtrl.startRowOrCellEdit(x.ENTER,t),this.cellCtrl.isEditing()&&t.preventDefault()}onF2KeyDown(e){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(x.F2,e)}onEscapeKeyDown(e){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))}processCharacter(e){if(e.target!==this.eGui||this.cellCtrl.isEditing())return;const t=e.key;" "===t?this.onSpaceKeyDown(e):(this.cellCtrl.startRowOrCellEdit(t,e),e.preventDefault())}onSpaceKeyDown(n){const{gridOptionsService:r}=this.beans;if(!this.cellCtrl.isEditing()&&r.isRowSelection()){const t=this.rowNode.isSelected(),i=!t;if(i||!r.is("suppressRowDeselection")){const r=this.beans.gridOptionsService.is("groupSelectsFiltered"),e=this.rowNode.setSelectedParams({newValue:i,rangeSelect:n.shiftKey,groupSelectsFiltered:r,event:n,source:"spaceKey"});void 0===t&&0===e&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:n.shiftKey,groupSelectsFiltered:r,event:n,source:"spaceKey"})}}n.preventDefault()}destroy(){super.destroy()}}var Ma=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class ka extends S{constructor(e,t,i){super('<div class="ag-drag-handle ag-row-drag" draggable="true"></div>'),this.rowNode=e,this.column=t,this.eCell=i}postConstruct(){this.getGui().appendChild(mr("rowDrag",this.gridOptionsService,null)),this.addGuiEventListener("mousedown",e=>{e.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(t){const e=this.column.getColDef().dndSourceOnRowDrag;t.dataTransfer.setDragImage(this.eCell,0,0);const i=()=>{try{const e=JSON.stringify(this.rowNode.data);t.dataTransfer.setData("application/json",e),t.dataTransfer.setData("text/plain",e)}catch(e){}};if(e){e({rowNode:this.rowNode,dragEvent:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context})}else i()}checkVisibility(){const e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}}Ma([r],ka.prototype,"postConstruct",null);let Oa=0;class Na extends p{constructor(e,t,i,n){super(),this.cellRangeFeature=null,this.cellPositionFeature=null,this.cellCustomStyleFeature=null,this.tooltipFeature=null,this.cellMouseListenerFeature=null,this.cellKeyboardListenerFeature=null,this.suppressRefreshCell=!1,this.onCellCompAttachedFuncs=[],this.column=e,this.rowNode=t,this.beans=i,this.rowCtrl=n,this.instanceId=e.getId()+"-"+Oa++,this.createCellPosition(),this.addFeatures()}shouldRestoreFocus(){return this.beans.focusService.shouldRestoreFocus(this.cellPosition)}addFeatures(){this.cellPositionFeature=new Aa(this,this.beans),this.addDestroyFunc(()=>{var e;null===(e=this.cellPositionFeature)||void 0===e||e.destroy(),this.cellPositionFeature=null}),this.cellCustomStyleFeature=new Ea(this,this.beans),this.addDestroyFunc(()=>{var e;null===(e=this.cellCustomStyleFeature)||void 0===e||e.destroy(),this.cellCustomStyleFeature=null}),this.cellMouseListenerFeature=new Da(this,this.beans,this.column),this.addDestroyFunc(()=>{var e;null===(e=this.cellMouseListenerFeature)||void 0===e||e.destroy(),this.cellMouseListenerFeature=null}),this.cellKeyboardListenerFeature=new Ra(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.addDestroyFunc(()=>{var e;null===(e=this.cellKeyboardListenerFeature)||void 0===e||e.destroy(),this.cellKeyboardListenerFeature=null});this.beans.rangeService&&this.beans.gridOptionsService.isEnableRangeSelection()&&(this.cellRangeFeature=new Sa(this.beans,this),this.addDestroyFunc(()=>{var e;null===(e=this.cellRangeFeature)||void 0===e||e.destroy(),this.cellRangeFeature=null})),this.column.isTooltipEnabled()&&this.addTooltipFeature()}addTooltipFeature(){const e={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getRowIndex:()=>this.cellPosition.rowIndex,getRowNode:()=>this.rowNode,getGui:()=>this.getGui(),getLocation:()=>"cell",getTooltipValue:()=>{const e=this.column.getColDef(),t=this.rowNode.data;if(e.tooltipField&&C(t))return xe(t,e.tooltipField,this.column.isTooltipFieldContainsDots());const i=e.tooltipValueGetter;return i?i({location:"cell",api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,colDef:this.column.getColDef(),column:this.column,rowIndex:this.cellPosition.rowIndex,node:this.rowNode,data:this.rowNode.data,value:this.value,valueFormatted:this.valueFormatted}):null},getValueFormatted:()=>this.valueFormatted};this.tooltipFeature=new Ta(e,this.beans),this.addDestroyFunc(()=>{var e;null===(e=this.tooltipFeature)||void 0===e||e.destroy(),this.tooltipFeature=null})}setComp(e,t,i,n,r){var o,s,a,l;this.cellComp=e,this.eGui=t,this.printLayout=n,this.updateAndFormatValue(!0),this.addDomData(),this.onCellFocused(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),i&&this.setupAutoHeight(i),this.setAriaColIndex(),this.beans.gridOptionsService.is("suppressCellFocus")||this.cellComp.setTabIndex(-1);const c=$t(this.column.getId());this.cellComp.setColId(c),this.cellComp.setRole("gridcell"),null===(o=this.cellPositionFeature)||void 0===o||o.setComp(t),null===(s=this.cellCustomStyleFeature)||void 0===s||s.setComp(e),null===(a=this.tooltipFeature)||void 0===a||a.setComp(e),null===(l=this.cellKeyboardListenerFeature)||void 0===l||l.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(e,t),r&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach(e=>e()),this.onCellCompAttachedFuncs=[])}setupAutoHeight(l){if(!this.column.isAutoHeight())return;const c=l.parentElement,u=this.beans.gridOptionsService.getRowHeightForNode(this.rowNode).height,d=e=>{if(this.editing)return;if(!this.isAlive())return;const{paddingTop:t,paddingBottom:i,borderBottomWidth:n,borderTopWidth:r}=Nn(c),o=t+i+n+r,s=l.offsetHeight+o;if(e<5){const c=this.beans.gridOptionsService.getDocument(),u=0==s;if(!c||!c.contains(l)||u)return void this.beans.frameworkOverrides.setTimeout(()=>d(e+1),0)}const a=Math.max(s,u);this.rowNode.setRowAutoHeight(a,this.column)},e=()=>d(0);e();const t=this.beans.resizeObserverService.observeResize(l,e);this.addDestroyFunc(()=>{t(),this.rowNode.setRowAutoHeight(void 0,this.column)})}getInstanceId(){return this.instanceId}showValue(e=!1){const t=null!=this.valueFormatted?this.valueFormatted:this.value,i=this.createCellRendererParams(),n=this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(),i);this.cellComp.setRenderDetails(n,t,e),this.refreshHandle()}setupControlComps(){const e=this.column.getColDef();this.includeSelection=this.isIncludeControl(e.checkboxSelection),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gridOptionsService.is("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(e){return!(null!=this.rowNode.rowPinned)&&("function"==typeof e||!0===e)}refreshShouldDestroy(){const e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(e.checkboxSelection),i=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),n=this.includeDndSource!=this.isIncludeControl(e.dndSource);return t||i||n}startEditing(e=null,t=!1,i=null){if(!this.isCellEditable()||this.editing)return;if(!this.cellComp)return void this.onCellCompAttachedFuncs.push(()=>{this.startEditing(e,t,i)});const n=this.createCellEditorParams(e,t),r=this.column.getColDef(),o=this.beans.userComponentFactory.getCellEditorDetails(r,n),s=null!=(null==o?void 0:o.popupFromSelector)?o.popupFromSelector:!!r.cellEditorPopup,a=null!=(null==o?void 0:o.popupPositionFromSelector)?o.popupPositionFromSelector:r.cellEditorPopupPosition;this.setEditing(!0),this.cellComp.setEditDetails(o,s,a);const l=this.createEvent(i,y.EVENT_CELL_EDITING_STARTED);this.beans.eventService.dispatchEvent(l)}setEditing(e){this.editing!==e&&(this.editing=e,this.refreshHandle())}stopRowOrCellEdit(e=!1){"fullRow"===this.beans.gridOptionsService.get("editType")?this.rowCtrl.stopRowEditing(e):this.stopEditing(e)}onPopupEditorClosed(){this.isEditing()&&this.stopEditingAndFocus()}takeValueFromCellEditor(e){const t={newValueExists:!1};if(e)return t;const i=this.cellComp.getCellEditor();if(!i)return t;if(i.isCancelAfterEnd&&i.isCancelAfterEnd())return t;return{newValue:i.getValue(),newValueExists:!0}}saveNewValue(e,t){if(t===e)return!1;this.suppressRefreshCell=!0;const i=this.rowNode.setDataValue(this.column,t,"edit");return this.suppressRefreshCell=!1,i}stopEditing(e=!1){if(!this.editing)return!1;const{newValue:t,newValueExists:i}=this.takeValueFromCellEditor(e),n=this.rowNode.getValueFromValueService(this.column);let r=!1;return i&&(r=this.saveNewValue(n,t)),this.setEditing(!1),this.cellComp.setEditDetails(),this.updateAndFormatValue(),this.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.dispatchEditingStoppedEvent(n,t,!e&&!!r),r}dispatchEditingStoppedEvent(e,t,i){const n=Object.assign(Object.assign({},this.createEvent(null,y.EVENT_CELL_EDITING_STOPPED)),{oldValue:e,newValue:t,valueChanged:i});this.beans.eventService.dispatchEvent(n)}createCellEditorParams(e,t){return{value:this.rowNode.getValueFromValueService(this.column),eventKey:e,column:this.column,colDef:this.column.getColDef(),rowIndex:this.getCellPosition().rowIndex,node:this.rowNode,data:this.rowNode.data,api:this.beans.gridOptionsService.api,cellStartedEdit:t,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,onKeyDown:this.onKeyDown.bind(this),stopEditing:this.stopEditingAndFocus.bind(this),eGridCell:this.getGui(),parseValue:this.parseValue.bind(this),formatValue:this.formatValue.bind(this)}}createCellRendererParams(){return{value:this.value,valueFormatted:this.valueFormatted,getValue:()=>this.rowNode.getValueFromValueService(this.column),setValue:e=>this.beans.valueService.setValue(this.rowNode,this.column,e),formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,rowIndex:this.getCellPosition().rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:(e,t,i,n)=>this.registerRowDragger(e,t,n)}}parseValue(e){return this.beans.valueParserService.parseValue(this.column,this.rowNode,e,this.getValue())}setFocusOutOnEditor(){if(!this.editing)return;const e=this.cellComp.getCellEditor();e&&e.focusOut&&e.focusOut()}setFocusInOnEditor(){if(!this.editing)return;const e=this.cellComp.getCellEditor();e&&e.focusIn?e.focusIn():this.focusCell(!0)}onCellChanged(e){if(!this.cellComp)return;e.column===this.column&&this.refreshCell({})}refreshCell(e){var t,i,n;if(this.suppressRefreshCell||this.editing)return;if(!this.cellComp)return;const r=this.column.getColDef(),o=null!=e&&!!e.newData,s=null!=e&&!!e.suppressFlash||!!r.suppressCellFlash,a=null==r.field&&null==r.valueGetter&&null==r.showRowGroup,l=e&&e.forceRefresh||a||o,c=this.updateAndFormatValue();if(l||c){this.showValue(o);const e=this.beans.filterManager.isSuppressFlashingCellsBecauseFiltering();!s&&!e&&(this.beans.gridOptionsService.is("enableCellChangeFlash")||r.enableCellChangeFlash)&&this.flashCell(),null===(t=this.cellCustomStyleFeature)||void 0===t||t.applyUserStyles(),null===(i=this.cellCustomStyleFeature)||void 0===i||i.applyClassesFromColDef()}this.refreshToolTip(),null===(n=this.cellCustomStyleFeature)||void 0===n||n.applyCellClassRules()}stopEditingAndFocus(e=!1,t=!1){this.stopRowOrCellEdit(),this.focusCell(!0),e||this.navigateAfterEdit(t)}navigateAfterEdit(t){if(this.beans.gridOptionsService.is("enterNavigatesVerticallyAfterEdit")){const e=t?x.UP:x.DOWN;this.beans.navigationService.navigateToNextCell(null,e,this.getCellPosition(),!1)}}flashCell(e){const t=e&&e.flashDelay,i=e&&e.fadeDelay;this.animateCell("data-changed",t,i)}animateCell(e,t,i){var n,r;const o="ag-cell-"+e,s=`ag-cell-${e}-animation`,{gridOptionsService:a}=this.beans;t||(t=null!==(n=a.getNum("cellFlashDelay"))&&void 0!==n?n:500),C(i)||(i=null!==(r=a.getNum("cellFadeDelay"))&&void 0!==r?r:1e3),this.cellComp.addOrRemoveCssClass(o,!0),this.cellComp.addOrRemoveCssClass(s,!1),window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(o,!1),this.cellComp.addOrRemoveCssClass(s,!0),this.eGui.style.transition=`background-color ${i}ms`,window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(s,!1),this.eGui.style.transition="")},i))},t)}onFlashCells(e){if(!this.cellComp)return;const t=this.beans.cellPositionUtils.createId(this.getCellPosition());e.cells[t]&&this.animateCell("highlight")}isCellEditable(){return this.column.isCellEditable(this.rowNode)}isSuppressFillHandle(){return this.column.isSuppressFillHandle()}formatValue(e){const t=this.callValueFormatter(e);return null!=t?t:e}callValueFormatter(e){return this.beans.valueFormatterService.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e=!1){const t=this.value,i=this.valueFormatted;this.value=this.rowNode.getValueFromValueService(this.column),this.valueFormatted=this.callValueFormatter(this.value);return!!e||(!this.valuesAreEqual(t,this.value)||this.valueFormatted!=i)}valuesAreEqual(e,t){const i=this.column.getColDef();return i.equals?i.equals(e,t):e===t}getComp(){return this.cellComp}getValue(){return this.value}getValueFormatted(){return this.valueFormatted}addDomData(){const e=this.getGui();this.beans.gridOptionsService.setDomData(e,Na.DOM_DATA_KEY_CELL_CTRL,this),this.addDestroyFunc(()=>this.beans.gridOptionsService.setDomData(e,Na.DOM_DATA_KEY_CELL_CTRL,null))}createEvent(e,t){return{type:t,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),context:this.beans.gridOptionsService.context,api:this.beans.gridApi,columnApi:this.beans.columnApi,rowPinned:this.rowNode.rowPinned,event:e,rowIndex:this.rowNode.rowIndex}}processCharacter(e){var t;null===(t=this.cellKeyboardListenerFeature)||void 0===t||t.processCharacter(e)}onKeyDown(e){var t;null===(t=this.cellKeyboardListenerFeature)||void 0===t||t.onKeyDown(e)}onMouseEvent(e,t){var i;null===(i=this.cellMouseListenerFeature)||void 0===i||i.onMouseEvent(e,t)}getGui(){return this.eGui}refreshToolTip(){var e;null===(e=this.tooltipFeature)||void 0===e||e.refreshToolTip()}getColSpanningList(){return this.cellPositionFeature.getColSpanningList()}onLeftChanged(){var e;this.cellComp&&(null===(e=this.cellPositionFeature)||void 0===e||e.onLeftChanged())}onDisplayedColumnsChanged(){this.eGui&&this.setAriaColIndex()}setAriaColIndex(){const e=this.beans.columnModel.getAriaColumnIndex(this.column);ji(this.getGui(),e)}isSuppressNavigable(){return this.column.isSuppressNavigable(this.rowNode)}onWidthChanged(){var e;return null===(e=this.cellPositionFeature)||void 0===e?void 0:e.onWidthChanged()}getColumn(){return this.column}getRowNode(){return this.rowNode}getBeans(){return this.beans}isPrintLayout(){return this.printLayout}appendChild(e){this.eGui.appendChild(e)}refreshHandle(){this.cellRangeFeature&&this.cellRangeFeature.refreshHandle()}getCellPosition(){return this.cellPosition}isEditing(){return this.editing}startRowOrCellEdit(e,t=null){this.cellComp&&("fullRow"===this.beans.gridOptionsService.get("editType")?this.rowCtrl.startRowEditing(e,this):this.startEditing(e,!0,t))}getRowCtrl(){return this.rowCtrl}getRowPosition(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}}updateRangeBordersIfRangeCount(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()}onRangeSelectionChanged(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}isRangeSelectionEnabled(){return null!=this.cellRangeFeature}focusCell(e=!1){this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus:e})}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}onFirstRightPinnedChanged(){if(!this.cellComp)return;const e=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass("ag-cell-first-right-pinned",e)}onLastLeftPinnedChanged(){if(!this.cellComp)return;const e=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass("ag-cell-last-left-pinned",e)}onCellFocused(e){if(!this.cellComp||this.beans.gridOptionsService.is("suppressCellFocus"))return;const t=this.beans.focusService.isCellFocused(this.cellPosition);if(this.cellComp.addOrRemoveCssClass("ag-cell-focus",t),t&&e&&e.forceBrowserFocus){this.cellComp.getFocusableElement().focus({preventScroll:!!e.preventScrollOnBrowserFocus})}const i="fullRow"===this.beans.gridOptionsService.get("editType");t||i||!this.editing||this.stopRowOrCellEdit()}createCellPosition(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:J(this.rowNode.rowPinned),column:this.column}}applyStaticCssClasses(){this.cellComp.addOrRemoveCssClass("ag-cell",!0),this.cellComp.addOrRemoveCssClass("ag-cell-not-inline-editing",!0);const e=1==this.column.isAutoHeight();this.cellComp.addOrRemoveCssClass("ag-cell-auto-height",e),this.cellComp.addOrRemoveCssClass("ag-cell-normal-height",!e)}onColumnHover(){if(!this.cellComp)return;if(!this.beans.gridOptionsService.is("columnHoverHighlight"))return;const e=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass("ag-column-hover",e)}onColDefChanged(){this.cellComp&&(this.setWrapText(),this.editing||this.refreshCell({forceRefresh:!0,suppressFlash:!0}))}setWrapText(){const e=1==this.column.getColDef().wrapText;this.cellComp.addOrRemoveCssClass("ag-cell-wrap-text",e)}dispatchCellContextMenuEvent(e){const t=this.column.getColDef(),i=this.createEvent(e,y.EVENT_CELL_CONTEXT_MENU);this.beans.eventService.dispatchEvent(i),t.onCellContextMenu&&window.setTimeout(()=>t.onCellContextMenu(i),0)}getCellRenderer(){return this.cellComp?this.cellComp.getCellRenderer():null}getCellEditor(){return this.cellComp?this.cellComp.getCellEditor():null}destroy(){this.onCellCompAttachedFuncs=[],super.destroy()}createSelectionCheckbox(){const e=new Qo;return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){const e=new ka(this.rowNode,this.column,this.eGui);return this.beans.context.createBean(e),e}registerRowDragger(e,t,i){if(this.customRowDragComp)return void this.customRowDragComp.setDragElement(e,t);const n=this.createRowDragComp(e,t,i);n&&(this.customRowDragComp=n,this.addDestroyFunc(()=>{this.beans.context.destroyBean(n),this.customRowDragComp=null}))}createRowDragComp(e,t,i){const n=this.beans.gridOptionsService.is("pagination"),r=this.beans.gridOptionsService.is("rowDragManaged"),o=this.beans.gridOptionsService.isRowModelType("clientSide");if(r){if(!o)return void l(()=>console.warn("AG Grid: managed row dragging is only allowed in the Client Side Row Model"),"CellComp.addRowDragging");if(n)return void l(()=>console.warn("AG Grid: managed row dragging is not possible when doing pagination"),"CellComp.addRowDragging")}const s=new os(()=>this.value,this.rowNode,this.column,e,t,i);return this.beans.context.createBean(s),s}}var Ia;Na.DOM_DATA_KEY_CELL_CTRL="cellCtrl",function(e){e.Normal="Normal",e.FullWidth="FullWidth",e.FullWidthLoading="FullWidthLoading",e.FullWidthGroup="FullWidthGroup",e.FullWidthDetail="FullWidthDetail"}(Ia||(Ia={}));let La=0;class Pa extends p{constructor(e,t,i,n,r){super(),this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.lastMouseDownOnDragger=!1,this.updateColumnListsPending=!1,this.businessKeySanitised=null,this.beans=t,this.gridOptionsService=t.gridOptionsService,this.rowNode=e,this.paginationPage=t.paginationProxy.getCurrentPage(),this.useAnimationFrameForCreate=n,this.printLayout=r,this.instanceId=e.id+"-"+La++,this.setAnimateFlags(i),this.initRowBusinessKey(),this.rowFocused=t.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=t.rowCssClassCalculator.calculateRowLevel(this.rowNode),this.setRowType(),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gridOptionsService.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if("function"!=typeof this.businessKeyForNodeFunc)return;const e=this.businessKeyForNodeFunc(this.rowNode);this.businessKeySanitised=$t(e)}isSticky(){return this.rowNode.sticky}getBeans(){return this.beans}getInstanceId(){return this.instanceId}setComp(e,t,i){const n={rowComp:e,element:t,containerType:i};this.allRowGuis.push(n),i===Za.LEFT?this.leftGui=n:i===Za.RIGHT?this.rightGui=n:i===Za.FULL_WIDTH?this.fullWidthGui=n:this.centerGui=n,this.initialiseRowComp(n),"FullWidthLoading"===this.rowType||this.rowNode.rowPinned||this.beans.rowRenderer.dispatchFirstDataRenderedEvent()}unsetComp(t){this.allRowGuis=this.allRowGuis.filter(e=>e.containerType!==t),t===Za.LEFT?this.leftGui=void 0:t===Za.RIGHT?this.rightGui=void 0:t===Za.FULL_WIDTH&&(this.fullWidthGui=void 0)}isCacheable(){return this.rowType===Ia.FullWidthDetail&&this.gridOptionsService.is("keepDetailRows")}setCached(e){const t=e?"none":"";this.allRowGuis.forEach(e=>e.element.style.display=t)}initialiseRowComp(e){const t=this.gridOptionsService;this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(e),t.isRowSelection()&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);const i=e.rowComp;i.setRole("row");this.getInitialRowClasses(e.containerType).forEach(e=>i.addOrRemoveCssClass(e,!0)),this.executeSlideAndFadeAnimations(e),this.rowNode.group&&Li(e.element,1==this.rowNode.expanded),this.setRowCompRowId(i),this.setRowCompRowBusinessKey(i),this.isFullWidth()&&!this.gridOptionsService.is("suppressCellFocus")&&i.setTabIndex(-1),t.setDomData(e.element,Pa.DOM_DATA_KEY_ROW_CTRL,this),this.addDestroyFunc(()=>t.setDomData(e.element,Pa.DOM_DATA_KEY_ROW_CTRL,null)),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,e.element),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(e.element),this.isFullWidth()&&this.setupFullWidth(e),t.is("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask(()=>{this.isAlive()&&e.rowComp.addOrRemoveCssClass("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){null!=this.businessKeySanitised&&e.setRowBusinessKey(this.businessKeySanitised)}setRowCompRowId(e){const t=$t(this.rowNode.id);null!=t&&e.setRowId(t)}executeSlideAndFadeAnimations(e){const{containerType:t}=e;this.slideInAnimation[t]&&(Oe(()=>{this.onTopChanged()}),this.slideInAnimation[t]=!1);this.fadeInAnimation[t]&&(Oe(()=>{e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)}),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){if(this.gridOptionsService.isEnableRangeSelection())return void l(()=>{console.warn("AG Grid: Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `enableRangeSelection: true`")},"rowDragAndRangeSelectionEnabled");const t=this.beans.localeService.getLocaleTextFunc(),i=new os(()=>"1 "+t("rowDragRow","row"),this.rowNode,void 0,e.element,void 0,!0);this.createManagedBean(i,this.beans.context)}setupFullWidth(e){const t=this.getPinnedForContainer(e.containerType),i=this.createFullWidthParams(e.element,t);if(this.rowType==Ia.FullWidthDetail&&!v.__assertRegistered(m.MasterDetailModule,"cell renderer 'agDetailCellRenderer' (for master detail)",this.beans.context.getGridId()))return;let n;switch(this.rowType){case Ia.FullWidthDetail:n=this.beans.userComponentFactory.getFullWidthDetailCellRendererDetails(i);break;case Ia.FullWidthGroup:n=this.beans.userComponentFactory.getFullWidthGroupCellRendererDetails(i);break;case Ia.FullWidthLoading:n=this.beans.userComponentFactory.getFullWidthLoadingCellRendererDetails(i);break;default:n=this.beans.userComponentFactory.getFullWidthCellRendererDetails(i)}e.rowComp.showFullWidth(n)}isPrintLayout(){return this.printLayout}getFullWidthCellRenderer(){var e,t;return null===(t=null===(e=this.fullWidthGui)||void 0===e?void 0:e.rowComp)||void 0===t?void 0:t.getFullWidthCellRenderer()}getCellElement(e){const t=this.getCellCtrl(e);return t?t.getGui():null}executeProcessRowPostCreateFunc(){var e;const t=this.gridOptionsService.getCallback("processRowPostCreate");if(!t||!this.areAllContainersReady())return;t({eRow:null===(e=this.centerGui)||void 0===e?void 0:e.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)})}areAllContainersReady(){const e=!!this.leftGui||!this.beans.columnModel.isPinningLeft(),t=!!this.centerGui,i=!!this.rightGui||!this.beans.columnModel.isPinningRight();return e&&t&&i}setRowType(){const e=this.rowNode.stub,t=this.rowNode.isFullWidthCell(),i=this.beans.doingMasterDetail&&this.rowNode.detail,n=this.beans.columnModel.isPivotMode(),r=!!this.rowNode.group&&!this.rowNode.footer&&this.gridOptionsService.isGroupUseEntireRow(n);this.rowType=e?Ia.FullWidthLoading:i?Ia.FullWidthDetail:t?Ia.FullWidth:r?Ia.FullWidthGroup:Ia.Normal}updateColumnLists(e=!1,t=!1){if(this.isFullWidth())return;e||this.gridOptionsService.is("suppressAnimationFrame")||this.printLayout?this.updateColumnListsImpl(t):this.updateColumnListsPending||(this.beans.animationFrameService.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0)}createCellCtrls(n,e,t=null){const i={list:[],map:{}},r=(e,t)=>{i.list.push(t),i.map[e]=t};return e.forEach(e=>{const t=e.getInstanceId();let i=n.map[t];i||(i=new Na(e,this.rowNode,this.beans,this)),r(t,i)}),n.list.forEach(e=>{if(null!=i.map[e.getColumn().getInstanceId()])return;this.isCellEligibleToBeRemoved(e,t)?e.destroy():r(e.getColumn().getInstanceId(),e)}),i}updateColumnListsImpl(i=!1){this.updateColumnListsPending=!1;const n=this.beans.columnModel;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,n.getAllDisplayedColumns()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const i=n.getViewportCenterColumnsForRow(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,i);const e=n.getDisplayedLeftColumnsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,e,"left");const t=n.getDisplayedRightColumnsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,t,"right")}this.allRowGuis.forEach(e=>{const t=e.containerType===Za.LEFT?this.leftCellCtrls:e.containerType===Za.RIGHT?this.rightCellCtrls:this.centerCellCtrls;e.rowComp.setCellCtrls(t.list,i)})}isCellEligibleToBeRemoved(e,t){if(e.getColumn().getPinned()!=t)return!0;const i=e.isEditing(),n=this.beans.focusService.isCellFocused(e.getCellPosition());if(i||n){const t=e.getColumn();return!(this.beans.columnModel.getAllDisplayedColumns().indexOf(t)>=0)}return!0}listenOnDomOrder(i){const e=()=>{const e=this.gridOptionsService.is("ensureDomOrder"),t=this.gridOptionsService.isDomLayout("print");i.rowComp.setDomOrder(e||t)};this.addManagedPropertyListener("domLayout",e),e()}setAnimateFlags(e){if(this.isSticky()||!e)return;const t=C(this.rowNode.oldRowTop),i=this.beans.columnModel.isPinningLeft(),n=this.beans.columnModel.isPinningRight();t?(this.slideInAnimation.center=!0,this.slideInAnimation.left=i,this.slideInAnimation.right=n):(this.fadeInAnimation.center=!0,this.fadeInAnimation.left=i,this.fadeInAnimation.right=n)}isEditing(){return this.editingRow}stopRowEditing(e){this.stopEditing(e)}isFullWidth(){return this.rowType!==Ia.Normal}getRowType(){return this.rowType}refreshFullWidth(){const e=(e,t)=>{if(!e)return!0;const i=e.rowComp.getFullWidthCellRenderer();if(!i)return!1;if(!i.refresh)return!1;const n=this.createFullWidthParams(e.element,t);return i.refresh(n)},t=e(this.fullWidthGui,null),i=e(this.centerGui,null),n=e(this.leftGui,"left"),r=e(this.rightGui,"right");return t&&i&&n&&r}addListeners(){this.addManagedListener(this.rowNode,R.EVENT_HEIGHT_CHANGED,()=>this.onRowHeightChanged()),this.addManagedListener(this.rowNode,R.EVENT_ROW_SELECTED,()=>this.onRowSelected()),this.addManagedListener(this.rowNode,R.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_TOP_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_EXPANDED_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_HAS_CHILDREN_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_CELL_CHANGED,this.onRowNodeCellChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_HIGHLIGHT_CHANGED,this.onRowNodeHighlightChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_DRAGGING_CHANGED,this.onRowNodeDraggingChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_UI_LEVEL_CHANGED,this.onUiLevelChanged.bind(this));const e=this.beans.eventService;this.addManagedListener(e,y.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,this.onPaginationPixelOffsetChanged.bind(this)),this.addManagedListener(e,y.EVENT_HEIGHT_SCALE_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(e,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(e,y.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(e,y.EVENT_CELL_FOCUSED,this.onCellFocused.bind(this)),this.addManagedListener(e,y.EVENT_CELL_FOCUS_CLEARED,this.onCellFocusCleared.bind(this)),this.addManagedListener(e,y.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addManagedListener(e,y.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedListener(e,y.EVENT_COLUMN_MOVED,this.onColumnMoved.bind(this)),this.addListenersForCellComps()}onColumnMoved(){this.updateColumnLists()}addListenersForCellComps(){this.addManagedListener(this.rowNode,R.EVENT_ROW_INDEX_CHANGED,()=>{this.getAllCellCtrls().forEach(e=>e.onRowIndexChanged())}),this.addManagedListener(this.rowNode,R.EVENT_CELL_CHANGED,t=>{this.getAllCellCtrls().forEach(e=>e.onCellChanged(t))})}onRowNodeDataChanged(t){this.rowNode.detailNode&&this.beans.rowRenderer.refreshFullWidthRow(this.rowNode.detailNode),this.isFullWidth()?this.beans.rowRenderer.refreshFullWidthRow(this.rowNode):(this.getAllCellCtrls().forEach(e=>e.refreshCell({suppressFlash:!t.update,newData:!t.update})),this.allRowGuis.forEach(e=>{this.setRowCompRowId(e.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(e.rowComp)}),this.onRowSelected(),this.postProcessCss())}onRowNodeCellChanged(){this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const n=this.rowNode.highlighted;this.allRowGuis.forEach(e=>{const t=n===ea.Above,i=n===ea.Below;e.rowComp.addOrRemoveCssClass("ag-row-highlight-above",t),e.rowComp.addOrRemoveCssClass("ag-row-highlight-below",i)})}onRowNodeDraggingChanged(){this.postProcessRowDragging()}postProcessRowDragging(){const t=this.rowNode.dragging;this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass("ag-row-dragging",t))}updateExpandedCss(){const t=this.rowNode.isExpandable(),i=1==this.rowNode.expanded;this.allRowGuis.forEach(e=>{e.rowComp.addOrRemoveCssClass("ag-row-group",t),e.rowComp.addOrRemoveCssClass("ag-row-group-expanded",t&&i),e.rowComp.addOrRemoveCssClass("ag-row-group-contracted",t&&!i),Li(e.element,t&&i)})}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:J(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(t){const e=this.allRowGuis.find(e=>e.element.contains(t.target));if(!((e?e.element:null)===t.target))return;const i=this.rowNode,n=this.beans.focusService.getFocusedCell(),r={rowIndex:i.rowIndex,rowPinned:i.rowPinned,column:n&&n.column};this.beans.navigationService.navigateToNextCell(t,t.key,r,!0),t.preventDefault()}onTabKeyDown(t){if(t.defaultPrevented||bt(t))return;const e=this.allRowGuis.find(e=>e.element.contains(t.target)),i=e?e.element:null,n=i===t.target;let r=null;n||(r=this.beans.focusService.findNextFocusableElement(i,!1,t.shiftKey)),(this.isFullWidth()&&n||!r)&&this.beans.navigationService.onTabKeyDown(this,t)}onFullWidthRowFocused(e){var t;const i=this.rowNode,n=!!e&&(this.isFullWidth()&&e.rowIndex===i.rowIndex&&e.rowPinned==i.rowPinned),r=this.fullWidthGui?this.fullWidthGui.element:null===(t=this.centerGui)||void 0===t?void 0:t.element;r&&(r.classList.toggle("ag-full-width-focus",n),n&&r.focus({preventScroll:!0}))}refreshCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),this.updateColumnLists()}removeCellCtrl(e,t){const i={list:[],map:{}};return e.list.forEach(e=>{e!==t&&(i.list.push(e),i.map[e.getInstanceId()]=e)}),i}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t)}}createRowEvent(e,t){return{type:e,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,context:this.gridOptionsService.context,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,event:t}}createRowEventWithSource(e,t){const i=this.createRowEvent(e,t);return i.source=this,i}onRowDblClick(e){if(bt(e))return;const t=this.createRowEventWithSource(y.EVENT_ROW_DOUBLE_CLICKED,e);this.beans.eventService.dispatchEvent(t)}onRowMouseDown(e){if(this.lastMouseDownOnDragger=On(e.target,"ag-row-drag",3),!this.isFullWidth())return;const t=this.rowNode,i=this.beans.columnModel;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges(),this.beans.focusService.setFocusedCell({rowIndex:t.rowIndex,column:i.getAllDisplayedColumns()[0],rowPinned:t.rowPinned,forceBrowserFocus:!0})}onRowClick(e){if(bt(e)||this.lastMouseDownOnDragger)return;const t=this.createRowEventWithSource(y.EVENT_ROW_CLICKED,e);this.beans.eventService.dispatchEvent(t);const i=e.ctrlKey||e.metaKey,n=e.shiftKey;if(this.gridOptionsService.is("groupSelectsChildren")&&this.rowNode.group||!this.rowNode.selectable||this.rowNode.rowPinned||!this.gridOptionsService.isRowSelection()||this.gridOptionsService.is("suppressRowClickSelection"))return;const r=this.gridOptionsService.is("rowMultiSelectWithClick"),o=!this.gridOptionsService.is("suppressRowDeselection"),s="rowClicked";if(this.rowNode.isSelected())r?this.rowNode.setSelectedParams({newValue:!1,event:e,source:s}):i?o&&this.rowNode.setSelectedParams({newValue:!1,event:e,source:s}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!n,rangeSelect:n,event:e,source:s});else{const t=!r&&!i;this.rowNode.setSelectedParams({newValue:!0,clearSelection:t,rangeSelect:n,event:e,source:s})}}setupDetailRowAutoHeight(t){if(this.rowType!==Ia.FullWidthDetail)return;if(!this.gridOptionsService.is("detailRowAutoHeight"))return;const e=()=>{const e=t.clientHeight;if(null!=e&&e>0){const t=()=>{this.rowNode.setRowHeight(e),this.beans.clientSideRowModel?this.beans.clientSideRowModel.onRowHeightChanged():this.beans.serverSideRowModel&&this.beans.serverSideRowModel.onRowHeightChanged()};this.beans.frameworkOverrides.setTimeout(t,0)}},i=this.beans.resizeObserverService.observeResize(t,e);this.addDestroyFunc(i),e()}createFullWidthParams(e,t){return{fullWidth:!0,data:this.rowNode.data,node:this.rowNode,value:this.rowNode.key,valueFormatted:this.rowNode.key,rowIndex:this.rowNode.rowIndex,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(e,t,i,n)=>this.addFullWidthRowDragging(e,t,i,n)}}addFullWidthRowDragging(e,t,i="",n){if(!this.isFullWidth())return;const r=new os(()=>i,this.rowNode,void 0,e,t,n);this.createManagedBean(r,this.beans.context)}onUiLevelChanged(){const e=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=e){const t="ag-row-level-"+e,i="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach(e=>{e.rowComp.addOrRemoveCssClass(t,!0),e.rowComp.addOrRemoveCssClass(i,!1)})}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageLastRow()}onModelUpdated(){this.refreshFirstAndLastRowStyles()}refreshFirstAndLastRowStyles(){const t=this.isFirstRowOnPage(),i=this.isLastRowOnPage();this.firstRowOnPage!==t&&(this.firstRowOnPage=t,this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass("ag-row-first",t))),this.lastRowOnPage!==i&&(this.lastRowOnPage=i,this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass("ag-row-last",i)))}stopEditing(t=!1){if(this.stoppingRowEdit)return;const i=this.getAllCellCtrls(),n=this.editingRow;this.stoppingRowEdit=!0;let r=!1;for(const e of i){const i=e.stopEditing(t);n&&!t&&!r&&i&&(r=!0)}if(r){const t=this.createRowEvent(y.EVENT_ROW_VALUE_CHANGED);this.beans.eventService.dispatchEvent(t)}n&&this.setEditingRow(!1),this.stoppingRowEdit=!1}setInlineEditingCss(t){this.allRowGuis.forEach(e=>{e.rowComp.addOrRemoveCssClass("ag-row-inline-editing",t),e.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!t)})}setEditingRow(t){this.editingRow=t,this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass("ag-row-editing",t));const e=t?this.createRowEvent(y.EVENT_ROW_EDITING_STARTED):this.createRowEvent(y.EVENT_ROW_EDITING_STOPPED);this.beans.eventService.dispatchEvent(e)}startRowEditing(n=null,r=null,o=null){if(this.editingRow)return;this.getAllCellCtrls().reduce((e,t)=>{const i=t===r;return i?t.startEditing(n,i,o):t.startEditing(null,i,o),!!e||t.isEditing()},!1)&&this.setEditingRow(!0)}getAllCellCtrls(){if(0===this.leftCellCtrls.list.length&&0===this.rightCellCtrls.list.length)return this.centerCellCtrls.list;return[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const e=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);e&&e.length&&e.forEach(t=>{this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass(t,!0))})}postProcessRowClassRules(){this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,t=>{this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass(t,!0))},t=>{this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass(t,!1))})}setStylesFromGridOptions(e){const t=this.processStylesFromGridOptions();this.forEachGui(e,e=>e.rowComp.setUserStyles(t))}getPinnedForContainer(e){return e===Za.LEFT?"left":e===Za.RIGHT?"right":null}getInitialRowClasses(e){const t=this.getPinnedForContainer(e),i={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[e],rowIsEven:this.rowNode.rowIndex%2==0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned:t};return this.beans.rowCssClassCalculator.getInitialRowClasses(i)}processStylesFromGridOptions(){const e=this.gridOptionsService.get("rowStyle");if(e&&"function"==typeof e)return void console.warn("AG Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead");const t=this.gridOptionsService.getCallback("getRowStyle");let i;if(t){i=t({data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex})}return Object.assign({},e,i)}onRowSelected(e){const i=!!this.rowNode.isSelected();this.forEachGui(e,e=>{e.rowComp.addOrRemoveCssClass("ag-row-selected",i),Yi(e.element,!!i||void 0);const t=this.createAriaLabel();Ti(e.element,null==t?"":t)})}createAriaLabel(){const e=this.rowNode.isSelected();if(e&&this.gridOptionsService.is("suppressRowDeselection"))return;return this.beans.localeService.getLocaleTextFunc()(e?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${e?"deselect":"select"} this row.`)}isUseAnimationFrameForCreate(){return this.useAnimationFrameForCreate}addHoverFunctionality(e){this.active&&(this.addManagedListener(e,"mouseenter",()=>this.rowNode.onMouseEnter()),this.addManagedListener(e,"mouseleave",()=>this.rowNode.onMouseLeave()),this.addManagedListener(this.rowNode,R.EVENT_MOUSE_ENTER,()=>{this.beans.dragService.isDragging()||this.gridOptionsService.is("suppressRowHoverHighlight")||(e.classList.add("ag-row-hover"),this.rowNode.setHovered(!0))}),this.addManagedListener(this.rowNode,R.EVENT_MOUSE_LEAVE,()=>{e.classList.remove("ag-row-hover"),this.rowNode.setHovered(!1)}))}roundRowTopToBounds(e){const t=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.applyPaginationOffset(t.top,!0)-100,n=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(i,e),n)}getFrameworkOverrides(){return this.beans.frameworkOverrides}forEachGui(e,t){(e?[e]:this.allRowGuis).forEach(t)}onRowHeightChanged(e){if(null==this.rowNode.rowHeight)return;const t=this.rowNode.rowHeight,i=this.beans.environment.getDefaultRowHeight(),n=this.gridOptionsService.isGetRowHeightFunction()?this.gridOptionsService.getRowHeightForNode(this.rowNode).height:void 0,r=n?Math.min(i,n)-2+"px":void 0;this.forEachGui(e,e=>{e.element.style.height=t+"px",r&&e.element.style.setProperty("--ag-line-height",r)})}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}destroyFirstPass(){this.active=!1,this.gridOptionsService.isAnimateRows()&&this.setupRemoveAnimation(),this.rowNode.setHovered(!1);const e=this.createRowEvent(y.EVENT_VIRTUAL_ROW_REMOVED);this.dispatchEvent(e),this.beans.eventService.dispatchEvent(e),super.destroy()}setupRemoveAnimation(){if(this.isSticky())return;if(null!=this.rowNode.rowTop){const e=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(e)}else this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0))}destroySecondPass(){this.allRowGuis.length=0;const e=e=>(e.list.forEach(e=>e.destroy()),{list:[],map:{}});this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,e=>{e.rowComp.addOrRemoveCssClass("ag-row-focus",this.rowFocused),e.rowComp.addOrRemoveCssClass("ag-row-no-focus",!this.rowFocused)})}onCellFocused(){this.onCellFocusChanged()}onCellFocusCleared(){this.onCellFocusChanged()}onCellFocusChanged(){const e=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);e!==this.rowFocused&&(this.rowFocused=e,this.setFocusedClasses()),!e&&this.editingRow&&this.stopEditing(!1)}onPaginationChanged(){const e=this.beans.paginationProxy.getCurrentPage();this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e,t=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;return e+this.beans.paginationProxy.getPixelOffset()*(t?1:-1)}setRowTop(i){if(!this.printLayout&&C(i)){const e=this.applyPaginationOffset(i),t=(this.rowNode.isRowPinned()||this.rowNode.sticky?e:this.beans.rowContainerHeightService.getRealPixelPosition(e))+"px";this.setRowTopStyle(t)}}getInitialRowTop(e){return this.gridOptionsService.is("suppressRowTransform")?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.gridOptionsService.is("suppressRowTransform")?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(i){if(this.printLayout)return"";let n;if(this.isSticky())n=this.rowNode.stickyRowTop;else{const e=this.slideInAnimation[i]?this.roundRowTopToBounds(this.rowNode.oldRowTop):this.rowNode.rowTop,t=this.applyPaginationOffset(e);n=this.rowNode.isRowPinned()?t:this.beans.rowContainerHeightService.getRealPixelPosition(t)}return n+"px"}setRowTopStyle(t){const i=this.gridOptionsService.is("suppressRowTransform");this.allRowGuis.forEach(e=>i?e.rowComp.setTop(t):e.rowComp.setTransform(`translateY(${t})`))}getRowNode(){return this.rowNode}getCellCtrl(t){let i=null;return this.getAllCellCtrls().forEach(e=>{e.getColumn()==t&&(i=e)}),null!=i||this.getAllCellCtrls().forEach(e=>{e.getColSpanningList().indexOf(t)>=0&&(i=e)}),i}onRowIndexChanged(){null!=this.rowNode.rowIndex&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(e){const t=this.rowNode.getRowIndexString(),i=this.beans.headerNavigationService.getHeaderRowCount(),n=this.rowNode.rowIndex%2==0,r=i+this.rowNode.rowIndex+1;this.forEachGui(e,e=>{e.rowComp.setRowIndex(t),e.rowComp.addOrRemoveCssClass("ag-row-even",n),e.rowComp.addOrRemoveCssClass("ag-row-odd",!n),Bi(e.element,r)})}getPinnedLeftRowElement(){return this.leftGui?this.leftGui.element:void 0}getPinnedRightRowElement(){return this.rightGui?this.rightGui.element:void 0}getBodyRowElement(){return this.centerGui?this.centerGui.element:void 0}getFullWidthRowElement(){return this.fullWidthGui?this.fullWidthGui.element:void 0}}Pa.DOM_DATA_KEY_ROW_CTRL="renderedRow";var Fa=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Ga extends p{constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.mockContextMenuForIPad()}addKeyboardListeners(){const e=this.processKeyboardEvent.bind(this,"keydown");this.addManagedListener(this.element,"keydown",e)}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",_t("touchstart")?"touchstart":"mousedown"].forEach(e=>{const t=this.processMouseEvent.bind(this,e);this.addManagedListener(this.element,e,t)})}processMouseEvent(e,t){if(!this.mouseEventService.isEventFromThisGrid(t)||bt(t))return;const i=this.getRowForEvent(t),n=this.mouseEventService.getRenderedCellForEvent(t);"contextmenu"===e?this.handleContextMenuMouseEvent(t,null,i,n):(n&&n.onMouseEvent(e,t),i&&i.onMouseEvent(e,t))}mockContextMenuForIPad(){if(!nn())return;const e=new D(this.element);this.addManagedListener(e,D.EVENT_LONG_TAP,e=>{const t=this.getRowForEvent(e.touchEvent),i=this.mouseEventService.getRenderedCellForEvent(e.touchEvent);this.handleContextMenuMouseEvent(null,e.touchEvent,t,i)}),this.addDestroyFunc(()=>e.destroy())}getRowForEvent(e){let t=e.target;for(;t;){const e=this.gridOptionsService.getDomData(t,Pa.DOM_DATA_KEY_ROW_CTRL);if(e)return e;t=t.parentElement}return null}handleContextMenuMouseEvent(e,t,i,n){const r=i?i.getRowNode():null,o=n?n.getColumn():null;let s=null;if(o){const i=e||t;n.dispatchCellContextMenuEvent(i),s=this.valueService.getValue(o,r)}const a=this.ctrlsService.getGridBodyCtrl(),l=n?n.getGui():a.getGridBodyElement();this.contextMenuFactory&&this.contextMenuFactory.onContextMenu(e,t,r,o,s,l)}getControlsForEventTarget(e){return{cellCtrl:wt(this.gridOptionsService,e,Na.DOM_DATA_KEY_CELL_CTRL),rowCtrl:wt(this.gridOptionsService,e,Pa.DOM_DATA_KEY_ROW_CTRL)}}processKeyboardEvent(e,t){const{cellCtrl:i,rowCtrl:n}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(i?this.processCellKeyboardEvent(i,e,t):n&&n.isFullWidth()&&this.processFullWidthRowKeyboardEvent(n,e,t))}processCellKeyboardEvent(e,t,i){const n=e.getRowNode(),r=e.getColumn(),o=e.isEditing();if(!yr(this.gridOptionsService,i,n,r,o)&&"keydown"===t){!o&&this.navigationService.handlePageScrollingKey(i)||e.onKeyDown(i),this.doGridOperations(i,e.isEditing()),vr(i)&&e.processCharacter(i)}if("keydown"===t){const t=e.createEvent(i,y.EVENT_CELL_KEY_DOWN);this.eventService.dispatchEvent(t)}}processFullWidthRowKeyboardEvent(e,t,i){const n=e.getRowNode(),r=this.focusService.getFocusedCell(),o=r&&r.column;if(!yr(this.gridOptionsService,i,n,o,!1)){const n=i.key;if("keydown"===t)switch(n){case x.PAGE_HOME:case x.PAGE_END:case x.PAGE_UP:case x.PAGE_DOWN:this.navigationService.handlePageScrollingKey(i,!0);break;case x.UP:case x.DOWN:e.onKeyboardNavigate(i);break;case x.TAB:e.onTabKeyDown(i)}}if("keydown"===t){const t=e.createRowEvent(y.EVENT_CELL_KEY_DOWN,i);this.eventService.dispatchEvent(t)}}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey)return;if(t)return;if(!this.mouseEventService.isEventFromThisGrid(e))return;const i=_r(e);return i===x.A?this.onCtrlAndA(e):i===x.C?this.onCtrlAndC(e):i===x.D?this.onCtrlAndD(e):i===x.V?this.onCtrlAndV(e):i===x.X?this.onCtrlAndX(e):i===x.Y?this.onCtrlAndY():i===x.Z?this.onCtrlAndZ(e):void 0}onCtrlAndA(r){const{pinnedRowModel:o,paginationProxy:s,rangeService:a}=this;if(a&&s.isRowsToRender()){const[r,s]=[o.isEmpty("top"),o.isEmpty("bottom")],e=r?null:"top";let t,i;s?(t=null,i=this.paginationProxy.getRowCount()-1):(t="bottom",i=o.getPinnedBottomRowData().length-1);const n=this.columnModel.getAllDisplayedColumns();if(ee(n))return;a.setCellRange({rowStartIndex:0,rowStartPinned:e,rowEndIndex:i,rowEndPinned:t,columnStart:n[0],columnEnd:f(n)})}r.preventDefault()}onCtrlAndC(e){if(!this.clipboardService||this.gridOptionsService.is("enableCellTextSelection"))return;const{cellCtrl:t,rowCtrl:i}=this.getControlsForEventTarget(e.target);(null==t?void 0:t.isEditing())||(null==i?void 0:i.isEditing())||(e.preventDefault(),this.clipboardService.copyToClipboard())}onCtrlAndX(e){if(!this.clipboardService||this.gridOptionsService.is("enableCellTextSelection")||this.gridOptionsService.is("suppressCutToClipboard"))return;const{cellCtrl:t,rowCtrl:i}=this.getControlsForEventTarget(e.target);(null==t?void 0:t.isEditing())||(null==i?void 0:i.isEditing())||(e.preventDefault(),this.clipboardService.cutToClipboard(void 0,"ui"))}onCtrlAndV(e){const{cellCtrl:t,rowCtrl:i}=this.getControlsForEventTarget(e.target);(null==t?void 0:t.isEditing())||(null==i?void 0:i.isEditing())||this.clipboardService&&!this.gridOptionsService.is("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()}onCtrlAndD(e){this.clipboardService&&!this.gridOptionsService.is("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),e.preventDefault()}onCtrlAndZ(e){this.gridOptionsService.is("undoRedoCellEditing")&&(e.preventDefault(),e.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))}onCtrlAndY(){this.undoRedoService.redo("ui")}}Fa([s("mouseEventService")],Ga.prototype,"mouseEventService",void 0),Fa([s("valueService")],Ga.prototype,"valueService",void 0),Fa([c("contextMenuFactory")],Ga.prototype,"contextMenuFactory",void 0),Fa([s("ctrlsService")],Ga.prototype,"ctrlsService",void 0),Fa([s("navigationService")],Ga.prototype,"navigationService",void 0),Fa([s("focusService")],Ga.prototype,"focusService",void 0),Fa([s("undoRedoService")],Ga.prototype,"undoRedoService",void 0),Fa([s("columnModel")],Ga.prototype,"columnModel",void 0),Fa([s("paginationProxy")],Ga.prototype,"paginationProxy",void 0),Fa([s("pinnedRowModel")],Ga.prototype,"pinnedRowModel",void 0),Fa([c("rangeService")],Ga.prototype,"rangeService",void 0),Fa([c("clipboardService")],Ga.prototype,"clipboardService",void 0),Fa([r],Ga.prototype,"postConstruct",null);var $a=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Ha extends p{constructor(e){super(),this.centerContainerCtrl=e}postConstruct(){this.ctrlsService.whenReady(()=>{this.gridBodyCtrl=this.ctrlsService.getGridBodyCtrl(),this.listenForResize()}),this.addManagedListener(this.eventService,y.EVENT_SCROLLBAR_WIDTH_CHANGED,this.onScrollbarWidthChanged.bind(this))}listenForResize(){const e=()=>this.onCenterViewportResized();this.centerContainerCtrl.registerViewportResizeListener(e),this.gridBodyCtrl.registerBodyViewportResizeListener(e)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.centerContainerCtrl.isViewportVisible()){this.checkViewportAndScrolls();const e=this.centerContainerCtrl.getCenterWidth();e!==this.centerWidth&&(this.centerWidth=e,this.columnModel.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const t=In(this.gridBodyCtrl.getBodyViewportElement());if(this.bodyHeight!==t){this.bodyHeight=t;const e={type:y.EVENT_BODY_HEIGHT_CHANGED};this.eventService.dispatchEvent(e)}}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){const e={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(e)}isHorizontalScrollShowing(){return this.centerContainerCtrl.isHorizontalScrollShowing()}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.columnModel.setViewportPosition(e,t)}}$a([s("ctrlsService")],Ha.prototype,"ctrlsService",void 0),$a([s("columnModel")],Ha.prototype,"columnModel",void 0),$a([s("scrollVisibleService")],Ha.prototype,"scrollVisibleService",void 0),$a([r],Ha.prototype,"postConstruct",null);var Ba=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Va extends p{constructor(e){super(),this.element=e}postConstruct(){this.addManagedListener(this.eventService,y.EVENT_LEFT_PINNED_WIDTH_CHANGED,this.onPinnedLeftWidthChanged.bind(this))}onPinnedLeftWidthChanged(){const e=this.pinnedWidthService.getPinnedLeftWidth(),t=e>0;w(this.element,t),or(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedLeftWidth()}}Ba([s("pinnedWidthService")],Va.prototype,"pinnedWidthService",void 0),Ba([r],Va.prototype,"postConstruct",null);var ja=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class za extends p{constructor(e){super(),this.element=e}postConstruct(){this.addManagedListener(this.eventService,y.EVENT_RIGHT_PINNED_WIDTH_CHANGED,this.onPinnedRightWidthChanged.bind(this))}onPinnedRightWidthChanged(){const e=this.pinnedWidthService.getPinnedRightWidth(),t=e>0;w(this.element,t),or(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedRightWidth()}}ja([s("pinnedWidthService")],za.prototype,"pinnedWidthService",void 0),ja([r],za.prototype,"postConstruct",null);var Wa=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Ua extends p{constructor(e,t){super(),this.eContainer=e,this.eWrapper=t}postConstruct(){this.addManagedListener(this.eventService,y.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onHeightChanged.bind(this))}onHeightChanged(){const e=this.maxDivHeightScaler.getUiContainerHeight(),t=null!=e?e+"px":"";this.eContainer.style.height=t,this.eWrapper&&(this.eWrapper.style.height=t)}}Wa([s("rowContainerHeightService")],Ua.prototype,"maxDivHeightScaler",void 0),Wa([r],Ua.prototype,"postConstruct",null);var Ya=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class qa extends p{constructor(e){super(),this.eContainer=e}postConstruct(){if(!this.gridOptionsService.isEnableRangeSelection()||u(this.rangeService))return;const e={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)};this.dragService.addDragSource(e),this.addDestroyFunc(()=>this.dragService.removeDragSource(e))}}Ya([c("rangeService")],qa.prototype,"rangeService",void 0),Ya([s("dragService")],qa.prototype,"dragService",void 0),Ya([r],qa.prototype,"postConstruct",null);var Ka=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Xa extends p{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_LEFT_PINNED_WIDTH_CHANGED,e),this.addSpacer&&(this.addManagedListener(this.eventService,y.EVENT_RIGHT_PINNED_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_SCROLL_VISIBILITY_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_SCROLLBAR_WIDTH_CHANGED,e)),this.setWidth()}setWidth(){const{columnModel:e}=this,t=this.gridOptionsService.isDomLayout("print"),i=e.getBodyContainerWidth(),n=e.getDisplayedColumnsLeftWidth(),r=e.getDisplayedColumnsRightWidth();let o;if(t)o=i+n+r;else if(o=i,this.addSpacer){0===(this.gridOptionsService.is("enableRtl")?n:r)&&this.scrollVisibleService.isVerticalScrollShowing()&&(o+=this.gridOptionsService.getScrollbarWidth())}this.callback(o)}}Ka([s("columnModel")],Xa.prototype,"columnModel",void 0),Ka([s("scrollVisibleService")],Xa.prototype,"scrollVisibleService",void 0),Ka([r],Xa.prototype,"postConstruct",null);var L,Za,Qa=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};function Ja(e){switch(e){case L.CENTER:case L.TOP_CENTER:case L.STICKY_TOP_CENTER:case L.BOTTOM_CENTER:return Za.CENTER;case L.LEFT:case L.TOP_LEFT:case L.STICKY_TOP_LEFT:case L.BOTTOM_LEFT:return Za.LEFT;case L.RIGHT:case L.TOP_RIGHT:case L.STICKY_TOP_RIGHT:case L.BOTTOM_RIGHT:return Za.RIGHT;case L.FULL_WIDTH:case L.TOP_FULL_WIDTH:case L.STICKY_TOP_FULL_WIDTH:case L.BOTTOM_FULL_WIDTH:return Za.FULL_WIDTH;default:throw Error("Invalid Row Container Type")}}!function(e){e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.FULL_WIDTH="fullWidth",e.TOP_LEFT="topLeft",e.TOP_RIGHT="topRight",e.TOP_CENTER="topCenter",e.TOP_FULL_WIDTH="topFullWidth",e.STICKY_TOP_LEFT="stickyTopLeft",e.STICKY_TOP_RIGHT="stickyTopRight",e.STICKY_TOP_CENTER="stickyTopCenter",e.STICKY_TOP_FULL_WIDTH="stickyTopFullWidth",e.BOTTOM_LEFT="bottomLeft",e.BOTTOM_RIGHT="bottomRight",e.BOTTOM_CENTER="bottomCenter",e.BOTTOM_FULL_WIDTH="bottomFullWidth"}(L||(L={})),function(e){e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.FULL_WIDTH="fullWidth"}(Za||(Za={}));const el=Vt([[L.CENTER,"ag-center-cols-container"],[L.LEFT,"ag-pinned-left-cols-container"],[L.RIGHT,"ag-pinned-right-cols-container"],[L.FULL_WIDTH,"ag-full-width-container"],[L.TOP_CENTER,"ag-floating-top-container"],[L.TOP_LEFT,"ag-pinned-left-floating-top"],[L.TOP_RIGHT,"ag-pinned-right-floating-top"],[L.TOP_FULL_WIDTH,"ag-floating-top-full-width-container"],[L.STICKY_TOP_CENTER,"ag-sticky-top-container"],[L.STICKY_TOP_LEFT,"ag-pinned-left-sticky-top"],[L.STICKY_TOP_RIGHT,"ag-pinned-right-sticky-top"],[L.STICKY_TOP_FULL_WIDTH,"ag-sticky-top-full-width-container"],[L.BOTTOM_CENTER,"ag-floating-bottom-container"],[L.BOTTOM_LEFT,"ag-pinned-left-floating-bottom"],[L.BOTTOM_RIGHT,"ag-pinned-right-floating-bottom"],[L.BOTTOM_FULL_WIDTH,"ag-floating-bottom-full-width-container"]]),tl=Vt([[L.CENTER,"ag-center-cols-viewport"],[L.TOP_CENTER,"ag-floating-top-viewport"],[L.STICKY_TOP_CENTER,"ag-sticky-top-viewport"],[L.BOTTOM_CENTER,"ag-floating-bottom-viewport"]]),il=Vt([[L.CENTER,"ag-center-cols-clipper"]]);class nl extends p{constructor(e){super(),this.visible=!0,this.EMPTY_CTRLS=[],this.name=e,this.isFullWithContainer=this.name===L.TOP_FULL_WIDTH||this.name===L.STICKY_TOP_FULL_WIDTH||this.name===L.BOTTOM_FULL_WIDTH||this.name===L.FULL_WIDTH}static getRowContainerCssClasses(e){return{container:el.get(e),viewport:tl.get(e),wrapper:il.get(e)}}static getPinned(e){switch(e){case L.BOTTOM_LEFT:case L.TOP_LEFT:case L.STICKY_TOP_LEFT:case L.LEFT:return"left";case L.BOTTOM_RIGHT:case L.TOP_RIGHT:case L.STICKY_TOP_RIGHT:case L.RIGHT:return"right";default:return null}}postConstruct(){this.enableRtl=this.gridOptionsService.is("enableRtl"),this.embedFullWidthRows=this.gridOptionsService.is("embedFullWidthRows"),this.forContainers([L.CENTER],()=>this.viewportSizeFeature=this.createManagedBean(new Ha(this)))}registerWithCtrlsService(){switch(this.name){case L.CENTER:this.ctrlsService.registerCenterRowContainerCtrl(this);break;case L.LEFT:this.ctrlsService.registerLeftRowContainerCtrl(this);break;case L.RIGHT:this.ctrlsService.registerRightRowContainerCtrl(this);break;case L.TOP_CENTER:this.ctrlsService.registerTopCenterRowContainerCtrl(this);break;case L.TOP_LEFT:this.ctrlsService.registerTopLeftRowContainerCon(this);break;case L.TOP_RIGHT:this.ctrlsService.registerTopRightRowContainerCtrl(this);break;case L.STICKY_TOP_CENTER:this.ctrlsService.registerStickyTopCenterRowContainerCtrl(this);break;case L.STICKY_TOP_LEFT:this.ctrlsService.registerStickyTopLeftRowContainerCon(this);break;case L.STICKY_TOP_RIGHT:this.ctrlsService.registerStickyTopRightRowContainerCtrl(this);break;case L.BOTTOM_CENTER:this.ctrlsService.registerBottomCenterRowContainerCtrl(this);break;case L.BOTTOM_LEFT:this.ctrlsService.registerBottomLeftRowContainerCtrl(this);break;case L.BOTTOM_RIGHT:this.ctrlsService.registerBottomRightRowContainerCtrl(this)}}forContainers(e,t){e.indexOf(this.name)>=0&&t()}getContainerElement(){return this.eContainer}getViewportSizeFeature(){return this.viewportSizeFeature}setComp(e,t,i,n){this.comp=e,this.eContainer=t,this.eViewport=i,this.eWrapper=n,this.createManagedBean(new Ga(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder(),this.stopHScrollOnPinnedRows();const r=[L.TOP_CENTER,L.TOP_LEFT,L.TOP_RIGHT],o=[L.STICKY_TOP_CENTER,L.STICKY_TOP_LEFT,L.STICKY_TOP_RIGHT],s=[...r,...[L.BOTTOM_CENTER,L.BOTTOM_LEFT,L.BOTTOM_RIGHT],...[L.CENTER,L.LEFT,L.RIGHT],...o],a=[L.CENTER,L.LEFT,L.RIGHT,L.FULL_WIDTH],l=[L.CENTER,L.TOP_CENTER,L.STICKY_TOP_CENTER,L.BOTTOM_CENTER],c=[L.LEFT,L.BOTTOM_LEFT,L.TOP_LEFT,L.STICKY_TOP_LEFT],u=[L.RIGHT,L.BOTTOM_RIGHT,L.TOP_RIGHT,L.STICKY_TOP_RIGHT];this.forContainers(c,()=>{this.pinnedWidthFeature=this.createManagedBean(new Va(this.eContainer)),this.addManagedListener(this.eventService,y.EVENT_LEFT_PINNED_WIDTH_CHANGED,()=>this.onPinnedWidthChanged())}),this.forContainers(u,()=>{this.pinnedWidthFeature=this.createManagedBean(new za(this.eContainer)),this.addManagedListener(this.eventService,y.EVENT_RIGHT_PINNED_WIDTH_CHANGED,()=>this.onPinnedWidthChanged())}),this.forContainers(a,()=>this.createManagedBean(new Ua(this.eContainer,this.eWrapper))),this.forContainers(s,()=>this.createManagedBean(new qa(this.eContainer))),this.forContainers(l,()=>this.createManagedBean(new Xa(e=>this.comp.setContainerWidth(e+"px")))),dn()&&(this.forContainers([L.CENTER],()=>{const e=this.enableRtl?y.EVENT_LEFT_PINNED_WIDTH_CHANGED:y.EVENT_RIGHT_PINNED_WIDTH_CHANGED;this.addManagedListener(this.eventService,e,()=>this.refreshPaddingForFakeScrollbar())}),this.refreshPaddingForFakeScrollbar()),this.addListeners(),this.registerWithCtrlsService()}refreshPaddingForFakeScrollbar(){const{enableRtl:i,columnModel:n,name:r,eWrapper:o,eContainer:s}=this,a=i?L.LEFT:L.RIGHT;this.forContainers([L.CENTER,a],()=>{const e=n.getContainerWidth(a),t=i?"marginLeft":"marginRight";r===L.CENTER?o.style[t]=e?"0px":"16px":s.style[t]=e?"16px":"0px"})}addListeners(){this.addManagedListener(this.eventService,y.EVENT_SCROLL_VISIBILITY_CHANGED,()=>this.onScrollVisibilityChanged()),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,()=>this.onDisplayedColumnsChanged()),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,()=>this.onDisplayedColumnsWidthChanged()),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_ROWS_CHANGED,e=>this.onDisplayedRowsChanged(e.afterScroll)),this.onScrollVisibilityChanged(),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()}listenOnDomOrder(){if([L.STICKY_TOP_CENTER,L.STICKY_TOP_LEFT,L.STICKY_TOP_RIGHT,L.STICKY_TOP_FULL_WIDTH].indexOf(this.name)>=0)return void this.comp.setDomOrder(!0);const e=()=>{const e=this.gridOptionsService.is("ensureDomOrder"),t=this.gridOptionsService.isDomLayout("print");this.comp.setDomOrder(e||t)};this.addManagedPropertyListener("domLayout",e),e()}stopHScrollOnPinnedRows(){this.forContainers([L.TOP_CENTER,L.STICKY_TOP_CENTER,L.BOTTOM_CENTER],()=>{this.addManagedListener(this.eViewport,"scroll",()=>this.eViewport.scrollLeft=0)})}onDisplayedColumnsChanged(){this.forContainers([L.CENTER],()=>this.onHorizontalViewportChanged())}onDisplayedColumnsWidthChanged(){this.forContainers([L.CENTER],()=>this.onHorizontalViewportChanged())}onScrollVisibilityChanged(){const i=this.gridOptionsService.getScrollbarWidth()||0;if(this.name===L.CENTER){const e=this.scrollVisibleService.isHorizontalScrollShowing()?i:0,t=0==e?"100%":`calc(100% + ${e}px)`;this.animationFrameService.requestAnimationFrame(()=>this.comp.setViewportHeight(t))}if(this.name===L.FULL_WIDTH){const i=`calc(100% - ${dn()?16:0}px)`;this.eContainer.style.setProperty("width",i)}}addPreventScrollWhileDragging(){const e=e=>{this.dragService.isDragging()&&e.cancelable&&e.preventDefault()};this.eContainer.addEventListener("touchmove",e,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",e))}onHorizontalViewportChanged(){const e=this.getCenterWidth(),t=this.getCenterViewportScrollLeft();this.columnModel.setViewportPosition(e,t)}getCenterWidth(){return Ln(this.eViewport)}getCenterViewportScrollLeft(){return Hn(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const t=this.resizeObserverService.observeResize(this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportVisible(){return Wn(this.eViewport)}getViewportScrollLeft(){return Hn(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gridOptionsService.is("alwaysShowHorizontalScroll")||ir(this.eViewport)}getViewportElement(){return this.eViewport}setContainerTranslateX(e){this.eContainer.style.transform=`translateX(${e}px)`}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){Bn(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!nl.getPinned(this.name)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged()),dn()&&this.refreshPaddingForFakeScrollbar()}onDisplayedRowsChanged(i=!1){if(this.visible){const n=this.gridOptionsService.isDomLayout("print"),e=e=>{const t=e.isFullWidth(),i=this.embedFullWidthRows||n;return this.isFullWithContainer?!i&&t:i||!t},t=this.getRowCtrls().filter(e);this.comp.setRowCtrls(t,i)}else this.comp.setRowCtrls(this.EMPTY_CTRLS,!1)}getRowCtrls(){switch(this.name){case L.TOP_CENTER:case L.TOP_LEFT:case L.TOP_RIGHT:case L.TOP_FULL_WIDTH:return this.rowRenderer.getTopRowCtrls();case L.STICKY_TOP_CENTER:case L.STICKY_TOP_LEFT:case L.STICKY_TOP_RIGHT:case L.STICKY_TOP_FULL_WIDTH:return this.rowRenderer.getStickyTopRowCtrls();case L.BOTTOM_CENTER:case L.BOTTOM_LEFT:case L.BOTTOM_RIGHT:case L.BOTTOM_FULL_WIDTH:return this.rowRenderer.getBottomRowCtrls();default:return this.rowRenderer.getRowCtrls()}}}Qa([s("scrollVisibleService")],nl.prototype,"scrollVisibleService",void 0),Qa([s("dragService")],nl.prototype,"dragService",void 0),Qa([s("ctrlsService")],nl.prototype,"ctrlsService",void 0),Qa([s("columnModel")],nl.prototype,"columnModel",void 0),Qa([s("resizeObserverService")],nl.prototype,"resizeObserverService",void 0),Qa([s("animationFrameService")],nl.prototype,"animationFrameService",void 0),Qa([s("rowRenderer")],nl.prototype,"rowRenderer",void 0),Qa([r],nl.prototype,"postConstruct",null);var rl=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};const ol=`<div class="ag-root ag-unselectable" role="treegrid">\n        <ag-header-root ref="gridHeader"></ag-header-root>\n        <div class="ag-floating-top" ref="eTop" role="presentation">\n            <ag-row-container ref="topLeftContainer" name="${L.TOP_LEFT}"></ag-row-container>\n            <ag-row-container ref="topCenterContainer" name="${L.TOP_CENTER}"></ag-row-container>\n            <ag-row-container ref="topRightContainer" name="${L.TOP_RIGHT}"></ag-row-container>\n            <ag-row-container ref="topFullWidthContainer" name="${L.TOP_FULL_WIDTH}"></ag-row-container>\n        </div>\n        <div class="ag-body" ref="eBody" role="presentation">\n            <div class="ag-body-clipper" ref="eBodyClipper" role="presentation">\n                <div class="ag-body-viewport" ref="eBodyViewport" role="presentation">\n                    <ag-row-container ref="leftContainer" name="${L.LEFT}"></ag-row-container>\n                    <ag-row-container ref="centerContainer" name="${L.CENTER}"></ag-row-container>\n                    <ag-row-container ref="rightContainer" name="${L.RIGHT}"></ag-row-container>\n                    <ag-row-container ref="fullWidthContainer" name="${L.FULL_WIDTH}"></ag-row-container>\n                </div>\n            </div>\n            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>\n        </div>\n        <div class="ag-sticky-top" ref="eStickyTop" role="presentation">\n            <ag-row-container ref="stickyTopLeftContainer" name="${L.STICKY_TOP_LEFT}"></ag-row-container>\n            <ag-row-container ref="stickyTopCenterContainer" name="${L.STICKY_TOP_CENTER}"></ag-row-container>\n            <ag-row-container ref="stickyTopRightContainer" name="${L.STICKY_TOP_RIGHT}"></ag-row-container>\n            <ag-row-container ref="stickyTopFullWidthContainer" name="${L.STICKY_TOP_FULL_WIDTH}"></ag-row-container>\n        </div>\n        <div class="ag-floating-bottom" ref="eBottom" role="presentation">\n            <ag-row-container ref="bottomLeftContainer" name="${L.BOTTOM_LEFT}"></ag-row-container>\n            <ag-row-container ref="bottomCenterContainer" name="${L.BOTTOM_CENTER}"></ag-row-container>\n            <ag-row-container ref="bottomRightContainer" name="${L.BOTTOM_RIGHT}"></ag-row-container>\n            <ag-row-container ref="bottomFullWidthContainer" name="${L.BOTTOM_FULL_WIDTH}"></ag-row-container>\n        </div>\n        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>\n        <ag-overlay-wrapper></ag-overlay-wrapper>\n    </div>`;class sl extends S{constructor(){super(ol)}init(){const t=(e,t)=>{const i=e+"px";t.style.minHeight=i,t.style.height=i},e={setRowAnimationCssOnBodyViewport:(e,t)=>this.setRowAnimationCssOnBodyViewport(e,t),setColumnCount:e=>Vi(this.getGui(),e),setRowCount:e=>Hi(this.getGui(),e),setTopHeight:e=>t(e,this.eTop),setBottomHeight:e=>t(e,this.eBottom),setTopDisplay:e=>this.eTop.style.display=e,setBottomDisplay:e=>this.eBottom.style.display=e,setStickyTopHeight:e=>this.eStickyTop.style.height=e,setStickyTopTop:e=>this.eStickyTop.style.top=e,setStickyTopWidth:e=>this.eStickyTop.style.width=e,setColumnMovingCss:(e,t)=>this.addOrRemoveCssClass(e,t),updateLayoutClasses:(e,t)=>{[this.eBodyViewport.classList,this.eBodyClipper.classList,this.eBody.classList].forEach(e=>{e.toggle(ca.AUTO_HEIGHT,t.autoHeight),e.toggle(ca.NORMAL,t.normal),e.toggle(ca.PRINT,t.print)}),this.addOrRemoveCssClass(ca.AUTO_HEIGHT,t.autoHeight),this.addOrRemoveCssClass(ca.NORMAL,t.normal),this.addOrRemoveCssClass(ca.PRINT,t.print)},setAlwaysVerticalScrollClass:(e,t)=>this.eBodyViewport.classList.toggle("ag-force-vertical-scroll",t),registerBodyViewportResizeListener:e=>{const t=this.resizeObserverService.observeResize(this.eBodyViewport,e);this.addDestroyFunc(()=>t())},setPinnedTopBottomOverflowY:e=>this.eTop.style.overflowY=this.eBottom.style.overflowY=e,setCellSelectableCss:(t,i)=>{[this.eTop,this.eBodyViewport,this.eBottom].forEach(e=>e.classList.toggle(t,i))},setBodyViewportWidth:e=>this.eBodyViewport.style.width=e};this.ctrl=this.createManagedBean(new wa),this.ctrl.setComp(e,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop),(this.rangeService||"multiple"===this.gridOptionsService.get("rowSelection"))&&$i(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(e,t){const i=this.eBodyViewport.classList;i.toggle(ba.ANIMATION_ON,t),i.toggle(ba.ANIMATION_OFF,!t)}getFloatingTopBottom(){return[this.eTop,this.eBottom]}}rl([s("resizeObserverService")],sl.prototype,"resizeObserverService",void 0),rl([c("rangeService")],sl.prototype,"rangeService",void 0),rl([A("eBodyViewport")],sl.prototype,"eBodyViewport",void 0),rl([A("eStickyTop")],sl.prototype,"eStickyTop",void 0),rl([A("eTop")],sl.prototype,"eTop",void 0),rl([A("eBottom")],sl.prototype,"eBottom",void 0),rl([A("gridHeader")],sl.prototype,"headerRootComp",void 0),rl([A("eBodyClipper")],sl.prototype,"eBodyClipper",void 0),rl([A("eBody")],sl.prototype,"eBody",void 0),rl([r],sl.prototype,"init",null);var al=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let ll=class extends p{postConstruct(){this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this))}onDisplayedColumnsChanged(){this.update()}onDisplayedColumnsWidthChanged(){this.update()}update(){this.updateImpl(),setTimeout(this.updateImpl.bind(this),500)}updateImpl(){const e=this.ctrlsService.getCenterRowContainerCtrl();if(!e)return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(t)}setScrollsVisible(t){if(this.horizontalScrollShowing!==t.horizontalScrollShowing||this.verticalScrollShowing!==t.verticalScrollShowing){this.horizontalScrollShowing=t.horizontalScrollShowing,this.verticalScrollShowing=t.verticalScrollShowing;const e={type:y.EVENT_SCROLL_VISIBILITY_CHANGED};this.eventService.dispatchEvent(e)}}isHorizontalScrollShowing(){return this.horizontalScrollShowing}isVerticalScrollShowing(){return this.verticalScrollShowing}};al([s("ctrlsService")],ll.prototype,"ctrlsService",void 0),al([r],ll.prototype,"postConstruct",null),ll=al([o("scrollVisibleService")],ll);var cl,ul=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let dl=cl=class extends p{constructor(){super(...arguments),this.gridInstanceId=cl.gridInstanceSequence.next()}stampTopLevelGridCompWithGridInstance(e){e[cl.GRID_DOM_KEY]=this.gridInstanceId}getRenderedCellForEvent(e){return wt(this.gridOptionsService,e.target,Na.DOM_DATA_KEY_CELL_CTRL)}isEventFromThisGrid(e){return this.isElementInThisGrid(e.target)}isElementInThisGrid(e){let t=e;for(;t;){const e=t[cl.GRID_DOM_KEY];if(C(e)){return e===this.gridInstanceId}t=t.parentElement}return!1}getCellPositionForEvent(e){const t=this.getRenderedCellForEvent(e);return t?t.getCellPosition():null}getNormalisedPosition(e){const t=this.gridOptionsService.isDomLayout("normal"),i=e;let n,r;if(null!=i.clientX||null!=i.clientY?(n=i.clientX,r=i.clientY):(n=i.x,r=i.y),t){const e=this.ctrlsService.getGridBodyCtrl(),t=e.getScrollFeature().getVScrollPosition();n+=e.getScrollFeature().getHScrollPosition().left,r+=t.top}return{x:n,y:r}}};dl.gridInstanceSequence=new Tr,dl.GRID_DOM_KEY="__ag_grid_instance",ul([s("ctrlsService")],dl.prototype,"ctrlsService",void 0),dl=cl=ul([o("mouseEventService")],dl);var hl=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let fl=class extends p{constructor(){super(),this.onPageDown=Le(this.onPageDown,100),this.onPageUp=Le(this.onPageUp,100)}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){const i=e.key,n=e.altKey,r=e.ctrlKey||e.metaKey,o=!!this.rangeService&&e.shiftKey,s=this.mouseEventService.getCellPositionForEvent(e);let a=!1;switch(i){case x.PAGE_HOME:case x.PAGE_END:r||n||(this.onHomeOrEndKey(i),a=!0);break;case x.LEFT:case x.RIGHT:case x.UP:case x.DOWN:if(!s)return!1;!r||n||o||(this.onCtrlUpDownLeftRight(i,s),a=!0);break;case x.PAGE_DOWN:case x.PAGE_UP:r||n||(a=this.handlePageUpDown(i,s,t))}return a&&e.preventDefault(),a}handlePageUpDown(e,t,i){return i&&(t=this.focusService.getFocusedCell()),!!t&&(e===x.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0)}navigateTo(e){const{scrollIndex:t,scrollType:i,scrollColumn:n,focusIndex:r,focusColumn:o}=e;if(C(n)&&!n.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(n),C(t)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(t,i),e.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(r),this.focusService.setFocusedCell({rowIndex:r,column:o,rowPinned:null,forceBrowserFocus:!0}),this.rangeService){const e={rowIndex:r,rowPinned:null,column:o};this.rangeService.setRangeToCell(e)}}onPageDown(e){const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.getViewportHeight(),n=this.paginationProxy.getPixelOffset(),r=t.top+i,o=this.paginationProxy.getRowIndexAtPixel(r+n);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,o):this.navigateToNextPage(e,o)}onPageUp(e){const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.paginationProxy.getPixelOffset(),n=t.top,r=this.paginationProxy.getRowIndexAtPixel(n+i);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,r,!0):this.navigateToNextPage(e,r,!0)}navigateToNextPage(e,t,i=!1){const n=this.getViewportHeight(),r=this.paginationProxy.getPageFirstRow(),o=this.paginationProxy.getPageLastRow(),s=this.paginationProxy.getPixelOffset(),a=this.paginationProxy.getRow(e.rowIndex),l=i?(null==a?void 0:a.rowHeight)-n-s:n-s,c=(null==a?void 0:a.rowTop)+l;let u,d=this.paginationProxy.getRowIndexAtPixel(c+s);if(d===e.rowIndex){const n=i?-1:1;t=d=e.rowIndex+n}i?(u="bottom",d<r&&(d=r),t<r&&(t=r)):(u="top",d>o&&(d=o),t>o&&(t=o)),this.isRowTallerThanView(d)&&(t=d,u="top"),this.navigateTo({scrollIndex:t,scrollType:u,scrollColumn:null,focusIndex:d,focusColumn:e.column})}navigateToNextPageWithAutoHeight(t,i,n=!1){this.navigateTo({scrollIndex:i,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:i,focusColumn:t.column}),setTimeout(()=>{const e=this.getNextFocusIndexForAutoHeight(t,n);this.navigateTo({scrollIndex:i,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:e,focusColumn:t.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){var i;const n=t?-1:1,r=this.getViewportHeight(),o=this.paginationProxy.getPageLastRow();let s=0,a=e.rowIndex;for(;a>=0&&a<=o;){const e=this.paginationProxy.getRow(a);if(e){const t=null!==(i=e.rowHeight)&&void 0!==i?i:0;if(s+t>r)break;s+=t}a+=n}return Math.max(0,Math.min(a,o))}getViewportHeight(){const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),t=this.gridOptionsService.getScrollbarWidth();let i=e.bottom-e.top;return this.ctrlsService.getCenterRowContainerCtrl().isHorizontalScrollShowing()&&(i-=t),i}isRowTallerThanView(e){const t=this.paginationProxy.getRow(e);if(!t)return!1;const i=t.rowHeight;return"number"==typeof i&&i>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const i=this.cellNavigationService.getNextCellToFocus(e,t,!0),{rowIndex:n,column:r}=i;this.navigateTo({scrollIndex:n,scrollType:null,scrollColumn:r,focusIndex:n,focusColumn:r})}onHomeOrEndKey(e){const t=e===x.PAGE_HOME,i=this.columnModel.getAllDisplayedColumns(),n=t?i[0]:f(i),r=t?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow();this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:n,focusIndex:r,focusColumn:n})}onTabKeyDown(t,i){const n=i.shiftKey;if(this.tabToNextCellCommon(t,n,i))i.preventDefault();else if(n){const{rowIndex:n,rowPinned:e}=t.getRowPosition();(e?0===n:n===this.paginationProxy.getPageFirstRow())&&(0===this.gridOptionsService.getNum("headerHeight")?this.focusService.focusNextGridCoreContainer(!0,!0):(i.preventDefault(),this.focusService.focusLastHeader(i)))}else t instanceof Na&&t.focusCell(!0),this.focusService.focusNextGridCoreContainer(n)&&i.preventDefault()}tabToNextCell(e,t){const i=this.focusService.getFocusedCell();if(!i)return!1;let n=this.getCellByPosition(i);return!!(n||(n=this.rowRenderer.getRowByPosition(i),n&&n.isFullWidth()))&&this.tabToNextCellCommon(n,e,t)}tabToNextCellCommon(e,t,i){let n,r=e.isEditing();if(!r&&e instanceof Na){const t=e.getRowCtrl();t&&(r=t.isEditing())}return n=r?"fullRow"===this.gridOptionsService.get("editType")?this.moveToNextEditingRow(e,t,i):this.moveToNextEditingCell(e,t,i):this.moveToNextCellNotEditing(e,t),n||!!this.focusService.getFocusedHeader()}moveToNextEditingCell(e,t,i=null){const n=e.getCellPosition();e.getGui().focus(),e.stopEditing();const r=this.findNextCellToFocusOn(n,t,!0);return null!=r&&(r.startEditing(null,!0,i),r.focusCell(!1),!0)}moveToNextEditingRow(e,t,i=null){const n=e.getCellPosition(),r=this.findNextCellToFocusOn(n,t,!0);if(null==r)return!1;const o=r.getCellPosition(),s=this.isCellEditable(n),a=this.isCellEditable(o),l=o&&n.rowIndex===o.rowIndex&&n.rowPinned===o.rowPinned;if(s&&e.setFocusOutOnEditor(),!l){e.getRowCtrl().stopEditing();r.getRowCtrl().startRowEditing(void 0,void 0,i)}return a?(r.setFocusInOnEditor(),r.focusCell()):r.focusCell(!0),!0}moveToNextCellNotEditing(e,t){const i=this.columnModel.getAllDisplayedColumns();let n;n=e instanceof Pa?Object.assign(Object.assign({},e.getRowPosition()),{column:t?i[0]:f(i)}):e.getCellPosition();const r=this.findNextCellToFocusOn(n,t,!1);if(r instanceof Na)r.focusCell(!0);else if(r)return this.tryToFocusFullWidthRow(r.getRowPosition(),t);return C(r)}findNextCellToFocusOn(n,r,o){let s=n;for(;;){n!==s&&(n=s),r||(s=this.getLastCellOfColSpan(s)),s=this.cellNavigationService.getNextTabbedCell(s,r);const t=this.gridOptionsService.getCallback("tabToNextCell");if(C(t)){const e=t({backwards:r,editing:o,previousCellPosition:n,nextCellPosition:s||null});C(e)?(e.floating&&(l(()=>{console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")},"no floating in userCell"),e.rowPinned=e.floating),s={rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned}):s=null}if(!s)return null;if(s.rowIndex<0){const n=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:n+s.rowIndex,column:s.column}}),null}const e="fullRow"===this.gridOptionsService.get("editType");if(o&&!e){if(!this.isCellEditable(s))continue}this.ensureCellVisible(s);const i=this.getCellByPosition(s);if(!i){const n=this.rowRenderer.getRowByPosition(s);if(!n||!n.isFullWidth()||o)continue;return n}if(!i.isSuppressNavigable())return this.rangeService&&this.rangeService.setRangeToCell(s),i}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return!!t&&e.column.isCellEditable(t)}getCellByPosition(e){const t=this.rowRenderer.getRowByPosition(e);return t?t.getCellCtrl(e.column):null}lookupRowNodeForCell(e){return"top"===e.rowPinned?this.pinnedRowModel.getPinnedTopRow(e.rowIndex):"bottom"===e.rowPinned?this.pinnedRowModel.getPinnedBottomRow(e.rowIndex):this.paginationProxy.getRow(e.rowIndex)}navigateToNextCell(e,t,i,n){let r=i,o=!1;for(;r&&(r===i||!this.isValidNavigateCell(r));)this.gridOptionsService.is("enableRtl")?t===x.LEFT&&(r=this.getLastCellOfColSpan(r)):t===x.RIGHT&&(r=this.getLastCellOfColSpan(r)),r=this.cellNavigationService.getNextCellToFocus(t,r),o=u(r);if(o&&e&&e.key===x.UP&&(r={rowIndex:-1,rowPinned:null,column:i.column}),n){const n=this.gridOptionsService.getCallback("navigateToNextCell");if(C(n)){const o=n({key:t,previousCellPosition:i,nextCellPosition:r||null,event:e});C(o)?(o.floating&&(l(()=>{console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")},"no floating in userCell"),o.rowPinned=o.floating),r={rowPinned:o.rowPinned,rowIndex:o.rowIndex,column:o.column}):r=null}}if(!r)return;if(r.rowIndex<0){const t=this.headerNavigationService.getHeaderRowCount();return void this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:t+r.rowIndex,column:i.column},event:e||void 0})}const s=this.getNormalisedPosition(r);s?this.focusPosition(s):this.tryToFocusFullWidthRow(r)}getNormalisedPosition(e){this.ensureCellVisible(e);const t=this.getCellByPosition(e);return t?(e=t.getCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t=!1){const i=this.columnModel.getAllDisplayedColumns(),n=this.rowRenderer.getRowByPosition(e);if(!n||!n.isFullWidth())return!1;const r=this.focusService.getFocusedCell(),o={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?f(i):i[0])};this.focusPosition(o);const s=null!=r&&this.rowPositionUtils.before(o,r),a={type:y.EVENT_FULL_WIDTH_ROW_FOCUSED,rowIndex:o.rowIndex,rowPinned:o.rowPinned,column:o.column,isFullWidthCell:!0,floating:o.rowPinned,fromBelow:s};return this.eventService.dispatchEvent(a),!0}focusPosition(e){this.focusService.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),this.rangeService&&this.rangeService.setRangeToCell(e)}isValidNavigateCell(e){return!!this.rowPositionUtils.getRowNode(e)}getLastCellOfColSpan(e){const t=this.getCellByPosition(e);if(!t)return e;const i=t.getColSpanningList();return 1===i.length?e:{rowIndex:e.rowIndex,column:f(i),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=this.gridOptionsService.isGroupRowsSticky(),i=this.rowModel.getRow(e.rowIndex);!(t&&(null==i?void 0:i.sticky))&&u(e.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(e.rowIndex),e.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(e.column)}};hl([s("mouseEventService")],fl.prototype,"mouseEventService",void 0),hl([s("paginationProxy")],fl.prototype,"paginationProxy",void 0),hl([s("focusService")],fl.prototype,"focusService",void 0),hl([c("rangeService")],fl.prototype,"rangeService",void 0),hl([s("columnModel")],fl.prototype,"columnModel",void 0),hl([s("rowModel")],fl.prototype,"rowModel",void 0),hl([s("ctrlsService")],fl.prototype,"ctrlsService",void 0),hl([s("rowRenderer")],fl.prototype,"rowRenderer",void 0),hl([s("headerNavigationService")],fl.prototype,"headerNavigationService",void 0),hl([s("rowPositionUtils")],fl.prototype,"rowPositionUtils",void 0),hl([s("cellNavigationService")],fl.prototype,"cellNavigationService",void 0),hl([s("pinnedRowModel")],fl.prototype,"pinnedRowModel",void 0),hl([r],fl.prototype,"postConstruct",null),fl=hl([o("navigationService")],fl);var pl=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class gl extends Go{constructor(e){super('<div class="ag-popup-editor" tabindex="-1"/>'),this.params=e}postConstruct(){this.gridOptionsService.setDomData(this.getGui(),gl.DOM_KEY_POPUP_EDITOR_WRAPPER,!0),this.addKeyDownListener()}addKeyDownListener(){const e=this.getGui(),t=this.params;this.addManagedListener(e,"keydown",e=>{yr(this.gridOptionsService,e,t.node,t.column,!0)||t.onKeyDown(e)})}}gl.DOM_KEY_POPUP_EDITOR_WRAPPER="popupEditorWrapper",pl([r],gl.prototype,"postConstruct",null);class ml extends S{constructor(e,t,i,n,r){super(),this.rendererVersion=0,this.editorVersion=0,this.beans=e,this.column=t.getColumn(),this.rowNode=t.getRowNode(),this.rowCtrl=t.getRowCtrl(),this.eRow=n,this.setTemplate(`<div comp-id="${this.getCompId()}"/>`);const o=this.getGui();this.forceWrapper=t.isForceWrapper(),this.refreshWrapper(!1);const s=(e,t,i)=>{const n=i||o;null!=t&&""!=t?n.setAttribute(e,t):n.removeAttribute(e)},a={addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),setUserStyles:e=>tr(o,e),getFocusableElement:()=>this.getFocusableElement(),setTabIndex:e=>s("tabindex",e.toString()),setRole:e=>Ci(o,e),setColId:e=>s("col-id",e),setTitle:e=>s("title",e),setIncludeSelection:e=>this.includeSelection=e,setIncludeRowDrag:e=>this.includeRowDrag=e,setIncludeDndSource:e=>this.includeDndSource=e,setRenderDetails:(e,t,i)=>this.setRenderDetails(e,t,i),setEditDetails:(e,t,i)=>this.setEditDetails(e,t,i),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue()};this.cellCtrl=t,t.setComp(a,this.getGui(),this.eCellWrapper,i,r)}getParentOfValue(){return this.eCellValue?this.eCellValue:this.eCellWrapper?this.eCellWrapper:this.getGui()}setRenderDetails(e,t,i){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=null==this.firstRender;const n=this.refreshWrapper(!1);if(this.refreshEditStyles(!1),e){!(i||n)&&this.refreshCellRenderer(e)||(this.destroyRenderer(),this.createCellRendererInstance(e))}else this.destroyRenderer(),this.insertValueWithoutCellRenderer(t)}setEditDetails(e,t,i){e?this.createCellEditorInstance(e,t,i):this.destroyEditor()}removeControls(){this.checkboxSelectionComp=this.beans.context.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=this.beans.context.destroyBean(this.dndSourceComp),this.rowDraggingComp=this.beans.context.destroyBean(this.rowDraggingComp)}refreshWrapper(e){const t=this.includeRowDrag||this.includeDndSource||this.includeSelection,i=t||this.forceWrapper,n=i&&null==this.eCellWrapper;n&&(this.eCellWrapper=Un('<div class="ag-cell-wrapper" role="presentation"></div>'),this.getGui().appendChild(this.eCellWrapper));const r=!i&&null!=this.eCellWrapper;r&&(zn(this.eCellWrapper),this.eCellWrapper=void 0),this.addOrRemoveCssClass("ag-cell-value",!i);const o=!e&&i,s=o&&null==this.eCellValue;s&&(this.eCellValue=Un('<span class="ag-cell-value" role="presentation"></span>'),this.eCellWrapper.appendChild(this.eCellValue));const a=!o&&null!=this.eCellValue;a&&(zn(this.eCellValue),this.eCellValue=void 0);const l=n||r||s||a;return l&&this.removeControls(),e||t&&this.addControls(),l}addControls(){this.includeRowDrag&&null==this.rowDraggingComp&&(this.rowDraggingComp=this.cellCtrl.createRowDragComp(),this.rowDraggingComp&&this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(),this.eCellValue)),this.includeDndSource&&null==this.dndSourceComp&&(this.dndSourceComp=this.cellCtrl.createDndSource(),this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(),this.eCellValue)),this.includeSelection&&null==this.checkboxSelectionComp&&(this.checkboxSelectionComp=this.cellCtrl.createSelectionCheckbox(),this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(),this.eCellValue))}createCellEditorInstance(e,t,i){const n=this.editorVersion,r=e.newAgStackInstance();if(!r)return;const{params:o}=e;r.then(e=>this.afterCellEditorCreated(n,e,o,t,i));u(this.cellEditor)&&o.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(e){const t=this.getParentOfValue();Vn(t);const i=null!=e?$t(e):null;null!=i&&(t.innerHTML=i)}destroyEditorAndRenderer(){this.destroyRenderer(),this.destroyEditor()}destroyRenderer(){const{context:e}=this.beans;this.cellRenderer=e.destroyBean(this.cellRenderer),zn(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){const{context:e}=this.beans;this.hideEditorPopup&&this.hideEditorPopup(),this.hideEditorPopup=void 0,this.cellEditor=e.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=e.destroyBean(this.cellEditorPopupWrapper),zn(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(e){if(null==this.cellRenderer||null==this.cellRenderer.refresh)return!1;if(this.cellRendererClass!==e.componentClass)return!1;const t=this.cellRenderer.refresh(e.params);return!0===t||void 0===t}createCellRendererInstance(i){const e=!this.beans.gridOptionsService.is("suppressAnimationFrame"),n=this.rendererVersion,{componentClass:r}=i,t=()=>{if(this.rendererVersion!==n||!this.isAlive())return;const e=i.newAgStackInstance(),t=this.afterCellRendererCreated.bind(this,n,r);e&&e.then(t)};e&&this.firstRender?this.beans.animationFrameService.createTask(t,this.rowNode.rowIndex,"createTasksP2"):t()}getCtrl(){return this.cellCtrl}getRowCtrl(){return this.rowCtrl}getCellRenderer(){return this.cellRenderer}getCellEditor(){return this.cellEditor}afterCellRendererCreated(e,t,i){if(!this.isAlive()||e!==this.rendererVersion)this.beans.context.destroyBean(i);else if(this.cellRenderer=i,this.cellRendererClass=t,this.cellRendererGui=this.cellRenderer.getGui(),null!=this.cellRendererGui){const e=this.getParentOfValue();Vn(e),e.appendChild(this.cellRendererGui)}}afterCellEditorCreated(e,t,i,n,r){if(e!==this.editorVersion)return void this.beans.context.destroyBean(t);if(t.isCancelBeforeStart&&t.isCancelBeforeStart())return this.beans.context.destroyBean(t),void this.cellCtrl.stopEditing(!0);if(!t.getGui)return console.warn(`AG Grid: cellEditor for column ${this.column.getId()} is missing getGui() method`),void this.beans.context.destroyBean(t);this.cellEditor=t,this.cellEditorGui=t.getGui();const o=n||void 0!==t.isPopup&&t.isPopup();o?this.addPopupCellEditor(i,r):this.addInCellEditor(),this.refreshEditStyles(!0,o),t.afterGuiAttached&&t.afterGuiAttached()}refreshEditStyles(e,t){var i;this.addOrRemoveCssClass("ag-cell-inline-editing",e&&!t),this.addOrRemoveCssClass("ag-cell-popup-editing",e&&!!t),this.addOrRemoveCssClass("ag-cell-not-inline-editing",!e||!!t),null===(i=this.rowCtrl)||void 0===i||i.setInlineEditingCss(e)}addInCellEditor(){const e=this.getGui(),t=this.beans.gridOptionsService.getDocument();if(e.contains(t.activeElement)&&e.focus(),this.destroyRenderer(),this.refreshWrapper(!0),this.clearParentOfValue(),this.cellEditorGui){this.getParentOfValue().appendChild(this.cellEditorGui)}}addPopupCellEditor(e,t){"fullRow"===this.beans.gridOptionsService.get("editType")&&console.warn("AG Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");const i=this.cellEditor;this.cellEditorPopupWrapper=this.beans.context.createBean(new gl(e));const n=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&n.appendChild(this.cellEditorGui);const r=this.beans.popupService,o=this.beans.gridOptionsService.is("stopEditingWhenCellsLoseFocus"),s=null!=t?t:i.getPopupPosition?i.getPopupPosition():"over",a=this.beans.gridOptionsService.is("enableRtl"),l={ePopup:n,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),position:s,alignSide:a?"right":"left",keepWithinBounds:!0},c=r.positionPopupByComponent.bind(r,l),u=this.beans.localeService.getLocaleTextFunc(),d=r.addPopup({modal:o,eChild:n,closeOnEsc:!0,closedCallback:()=>{this.cellCtrl.onPopupEditorClosed()},anchorToElement:this.getGui(),positionCallback:c,ariaLabel:u("ariaLabelCellEditor","Cell Editor")});d&&(this.hideEditorPopup=d.hideFunc)}detach(){this.eRow.removeChild(this.getGui())}destroy(){this.cellCtrl.stopEditing(),this.destroyEditorAndRenderer(),this.removeControls(),super.destroy()}clearParentOfValue(){const e=this.getGui(),t=this.beans.gridOptionsService.getDocument();e.contains(t.activeElement)&&rn()&&e.focus({preventScroll:!0}),Vn(this.getParentOfValue())}}class vl extends S{constructor(e,t,i){super(),this.cellComps={},this.beans=t,this.rowCtrl=e,this.setTemplate(`<div comp-id="${this.getCompId()}" style="${this.getInitialStyle(i)}"/>`);const n=this.getGui(),r=n.style,o={setDomOrder:e=>this.domOrder=e,setCellCtrls:e=>this.setCellCtrls(e),showFullWidth:e=>this.showFullWidth(e),getFullWidthCellRenderer:()=>this.getFullWidthCellRenderer(),addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),setUserStyles:e=>tr(n,e),setTop:e=>r.top=e,setTransform:e=>r.transform=e,setRowIndex:e=>n.setAttribute("row-index",e),setRole:e=>Ci(n,e),setRowId:e=>n.setAttribute("row-id",e),setRowBusinessKey:e=>n.setAttribute("row-business-key",e),setTabIndex:e=>n.setAttribute("tabindex",e.toString())};e.setComp(o,this.getGui(),i),this.addDestroyFunc(()=>{e.unsetComp(i)})}getInitialStyle(e){const t=this.rowCtrl.getInitialTransform(e),i=this.rowCtrl.getInitialRowTop(e);return t?"transform: "+t:"top: "+i}showFullWidth(e){const t=e.newAgStackInstance();t&&t.then(t=>{if(this.isAlive()){const e=t.getGui();this.getGui().appendChild(e),this.rowCtrl.setupDetailRowAutoHeight(e),this.setFullWidthRowComp(t)}else this.beans.context.destroyBean(t)})}setCellCtrls(e){const i=Object.assign({},this.cellComps);e.forEach(e=>{const t=e.getInstanceId();null==this.cellComps[t]?this.newCellComp(e):i[t]=null});const t=ye(i).filter(e=>null!=e);this.destroyCells(t),this.ensureDomOrder(e)}ensureDomOrder(e){if(!this.domOrder)return;const i=[];e.forEach(e=>{const t=this.cellComps[e.getInstanceId()];t&&i.push(t.getGui())}),Qn(this.getGui(),i)}newCellComp(e){const t=new ml(this.beans,e,this.rowCtrl.isPrintLayout(),this.getGui(),this.rowCtrl.isEditing());this.cellComps[e.getInstanceId()]=t,this.getGui().appendChild(t.getGui())}destroy(){super.destroy(),this.destroyAllCells()}destroyAllCells(){const e=ye(this.cellComps).filter(e=>null!=e);this.destroyCells(e)}setFullWidthRowComp(e){this.fullWidthCellRenderer&&console.error("AG Grid - should not be setting fullWidthRowComponent twice"),this.fullWidthCellRenderer=e,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer)})}getFullWidthCellRenderer(){return this.fullWidthCellRenderer}destroyCells(e){e.forEach(e=>{if(!e)return;const t=e.getCtrl().getInstanceId();this.cellComps[t]===e&&(e.detach(),e.destroy(),this.cellComps[t]=null)})}}var yl=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class bl extends S{constructor(){super(function(){const e=S.elementGettingCreated.getAttribute("name"),t=nl.getRowContainerCssClasses(e);let i;const n=e===L.CENTER,r=e===L.TOP_CENTER||e===L.STICKY_TOP_CENTER||e===L.BOTTOM_CENTER;return i=n?`<div class="${t.wrapper}" ref="eWrapper" role="presentation">\n                <div class="${t.viewport}" ref="eViewport" role="presentation">\n                    <div class="${t.container}" ref="eContainer"></div>\n                </div>\n            </div>`:r?`<div class="${t.viewport}" ref="eViewport" role="presentation">\n                <div class="${t.container}" ref="eContainer"></div>\n            </div>`:`<div class="${t.container}" ref="eContainer"></div>`,i}()),this.rowComps={},this.name=S.elementGettingCreated.getAttribute("name"),this.type=Ja(this.name)}postConstruct(){const e={setViewportHeight:e=>this.eViewport.style.height=e,setRowCtrls:e=>this.setRowCtrls(e),setDomOrder:e=>{this.domOrder=e},setContainerWidth:e=>this.eContainer.style.width=e};this.createManagedBean(new nl(this.name)).setComp(e,this.eContainer,this.eViewport,this.eWrapper)}preDestroy(){this.setRowCtrls([])}setRowCtrls(e){const n=Object.assign({},this.rowComps);this.rowComps={},this.lastPlacedElement=null;e.forEach(e=>{const t=e.getInstanceId(),i=n[t];if(i)this.rowComps[t]=i,delete n[t],this.ensureDomOrder(i.getGui());else{if(!e.getRowNode().displayed)return;const n=new vl(e,this.beans,this.type);this.rowComps[t]=n,this.appendRow(n.getGui())}}),ye(n).forEach(e=>{this.eContainer.removeChild(e.getGui()),e.destroy()}),Ci(this.eContainer,e.length?"rowgroup":"presentation")}appendRow(e){this.domOrder?Jn(this.eContainer,e,this.lastPlacedElement):this.eContainer.appendChild(e),this.lastPlacedElement=e}ensureDomOrder(e){this.domOrder&&(Zn(this.eContainer,e,this.lastPlacedElement),this.lastPlacedElement=e)}}yl([s("beans")],bl.prototype,"beans",void 0),yl([A("eViewport")],bl.prototype,"eViewport",void 0),yl([A("eContainer")],bl.prototype,"eContainer",void 0),yl([A("eWrapper")],bl.prototype,"eWrapper",void 0),yl([r],bl.prototype,"postConstruct",null),yl([Ve],bl.prototype,"preDestroy",null);var _l=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class wl{constructor(e){this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=e}onDragEnter(e){if(this.clearColumnsList(),this.gridOptionsService.is("functionsReadOnly"))return;const t=e.dragItem.columns;t&&t.forEach(e=>{e.isPrimary()&&(e.isAnyFunctionActive()||(e.isAllowValue()?this.columnsToAggregate.push(e):e.isAllowRowGroup()?this.columnsToGroup.push(e):e.isAllowPivot()&&this.columnsToPivot.push(e)))})}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?M.ICON_PINNED:M.ICON_MOVE:null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){this.columnsToAggregate.length>0&&this.columnModel.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.columnModel.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.columnModel.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")}}_l([s("columnModel")],wl.prototype,"columnModel",void 0),_l([s("gridOptionsService")],wl.prototype,"gridOptionsService",void 0);var Cl=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class xl{constructor(e,t){this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=e,this.eContainer=t,this.centerContainer=!C(e)}init(){this.ctrlsService.whenReady(()=>{this.gridBodyCon=this.ctrlsService.getGridBodyCtrl()})}getIconName(){return this.pinned?M.ICON_PINNED:M.ICON_MOVE}onDragEnter(i){const n=i.dragItem.columns;if(i.dragSource.type===es.ToolPanel)this.setColumnsVisible(n,!0,"uiColumnDragged");else{const t=i.dragItem.visibleState,e=(n||[]).filter(e=>t[e.getId()]);this.setColumnsVisible(e,!0,"uiColumnDragged")}this.setColumnsPinned(n,this.pinned,"uiColumnDragged"),this.onDragging(i,!0,!0)}onDragLeave(){this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(t,i,n="api"){if(t){const e=t.filter(e=>!e.getColDef().lockVisible);this.columnModel.setColumnsVisible(e,i,n)}}setColumnsPinned(t,i,n="api"){if(t){const e=t.filter(e=>!e.getColDef().lockPinned);this.columnModel.setColumnsPinned(e,i,n)}}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}normaliseX(e){if(this.gridOptionsService.is("enableRtl")){e=this.eContainer.clientWidth-e}return this.centerContainer&&(e+=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft()),e}checkCenterForScrolling(i){if(this.centerContainer){const e=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft(),t=e+this.ctrlsService.getCenterRowContainerCtrl().getCenterWidth();this.gridOptionsService.is("enableRtl")?(this.needToMoveRight=i<e+50,this.needToMoveLeft=i>t-50):(this.needToMoveLeft=i<e+50,this.needToMoveRight=i>t-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}}onDragging(e=this.lastDraggingEvent,t=!1,i=!1,n=!1){var r;if(n){if(this.lastMovedInfo){const{columns:e,toIndex:t}=this.lastMovedInfo;this.moveColumns(e,t,"uiColumnMoved",!0)}return}if(this.lastDraggingEvent=e,u(e.hDirection))return;const o=this.normaliseX(e.x);t||this.checkCenterForScrolling(o);const s=this.normaliseDirection(e.hDirection),a=e.dragSource.type,l=(null===(r=e.dragSource.getDragItem().columns)||void 0===r?void 0:r.filter(e=>!e.getColDef().lockPinned||e.getPinned()==this.pinned))||[];this.attemptMoveColumns({dragSourceType:a,allMovingColumns:l,hDirection:s,mouseX:o,fromEnter:t,fakeEvent:i})}normaliseDirection(e){if(!this.gridOptionsService.is("enableRtl"))return e;switch(e){case is.Left:return is.Right;case is.Right:return is.Left;default:console.error("AG Grid: Unknown direction "+e)}}attemptMoveColumns(e){const{dragSourceType:t,hDirection:i,mouseX:n,fromEnter:r,fakeEvent:o}=e,s=i===is.Left,a=i===is.Right;let{allMovingColumns:l}=e;if(t===es.HeaderCell){let n=[];l.forEach(e=>{let t=null,i=e.getParent();for(;null!=i&&1===i.getDisplayedLeafColumns().length;)t=i,i=i.getParent();if(null!=t){t.getProvidedColumnGroup().getLeafColumns().forEach(e=>{n.includes(e)||n.push(e)})}else n.includes(e)||n.push(e)}),l=n}const c=l.slice();this.columnModel.sortColumnsLikeGridColumns(c);const u=this.calculateValidMoves(c,a,n),d=this.calculateOldIndex(c);if(0===u.length)return;const h=u[0];let f=null!==d&&!r;if(t==es.HeaderCell&&(f=null!==d),f&&!o){if(s&&h>=d)return;if(a&&h<=d)return}const p=this.columnModel.getAllDisplayedColumns();let g=[],m=null;for(let e=0;e<u.length;e++){const t=u[e],i=this.columnModel.getProposedColumnOrder(c,t);if(!this.columnModel.doesOrderPassRules(i))continue;const n=i.filter(e=>p.includes(e));if(null===m)m=n;else if(!Er.areEqual(n,m))break;const r=this.groupFragCount(i);g.push({move:t,fragCount:r})}0!==g.length&&(g.sort((e,t)=>e.fragCount-t.fragCount),this.moveColumns(l,g[0].move,"uiColumnMoved",!1))}calculateOldIndex(e){const t=this.columnModel.getAllGridColumns(),i=rt(e.map(e=>t.indexOf(e))),n=i[0];return f(i)-n!==i.length-1?null:n}moveColumns(e,t,i,n){this.columnModel.moveColumns(e,t,i,n),this.lastMovedInfo=n?null:{columns:e,toIndex:t}}groupFragCount(n){function r(e){let t=[],i=e.getOriginalParent();for(;null!=i;)t.push(i),i=i.getOriginalParent();return t}let o=0;for(let i=0;i<n.length-1;i++){let e=r(n[i]),t=r(n[i+1]);[e,t]=e.length>t.length?[e,t]:[t,e],e.forEach(e=>{-1===t.indexOf(e)&&o++})}return o}calculateValidMoves(t,i,e){if(this.gridOptionsService.is("suppressMovableColumns")||t.some(e=>e.getColDef().suppressMovable))return[];const n=this.columnModel.getDisplayedColumns(this.pinned),r=this.columnModel.getAllGridColumns(),o=n.filter(e=>dt(t,e)),s=n.filter(e=>!dt(t,e)),a=r.filter(e=>!dt(t,e));let l,c=0,u=e;if(i){let t=0;o.forEach(e=>t+=e.getActualWidth()),u-=t}if(u>0){for(let e=0;e<s.length;e++){if(u-=s[e].getActualWidth(),u<0)break;c++}i&&c++}if(c>0){const t=s[c-1];l=a.indexOf(t)+1}else l=a.indexOf(s[0]),-1===l&&(l=0);const d=[l],h=(e,t)=>e-t;if(i){let e=l+1;const i=r.length-1;for(;e<=i;)d.push(e),e++;d.sort(h)}else{let e=l;const i=r.length-1;let t=r[e];for(;e<=i&&this.isColumnHidden(n,t);)e++,d.push(e),t=r[e];e=l-1;const o=0;for(;e>=o;)d.push(e),e--;d.sort(h).reverse()}return d}isColumnHidden(e,t){return e.indexOf(t)<0}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.needToMoveLeft?this.dragAndDropService.setGhostIcon(M.ICON_LEFT,!0):this.dragAndDropService.setGhostIcon(M.ICON_RIGHT,!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.dragAndDropService.setGhostIcon(M.ICON_MOVE))}moveInterval(){let e;this.intervalCount++,e=10+5*this.intervalCount,e>100&&(e=100);let t=null;const i=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?t=i.scrollHorizontally(-e):this.needToMoveRight&&(t=i.scrollHorizontally(e)),0!==t)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const e=this.lastDraggingEvent.dragItem.columns.filter(e=>!e.getColDef().lockPinned);if(e.length>0&&(this.dragAndDropService.setGhostIcon(M.ICON_PINNED),this.failedMoveAttempts>7)){const t=this.needToMoveLeft?"left":"right";this.setColumnsPinned(e,t,"uiColumnDragged"),this.dragAndDropService.nudge()}}}}Cl([s("columnModel")],xl.prototype,"columnModel",void 0),Cl([s("dragAndDropService")],xl.prototype,"dragAndDropService",void 0),Cl([s("gridOptionsService")],xl.prototype,"gridOptionsService",void 0),Cl([s("ctrlsService")],xl.prototype,"ctrlsService",void 0),Cl([r],xl.prototype,"init",null);var Sl=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Al extends p{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){this.ctrlsService.whenReady(e=>{switch(this.pinned){case"left":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.leftRowContainerCtrl.getContainerElement()],[e.bottomLeftRowContainerCtrl.getContainerElement()],[e.topLeftRowContainerCtrl.getContainerElement()]];break;case"right":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.rightRowContainerCtrl.getContainerElement()],[e.bottomRightRowContainerCtrl.getContainerElement()],[e.topRightRowContainerCtrl.getContainerElement()]];break;default:this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.centerRowContainerCtrl.getViewportElement()],[e.bottomCenterRowContainerCtrl.getViewportElement()],[e.topCenterRowContainerCtrl.getViewportElement()]]}})}isInterestedIn(e){return e===es.HeaderCell||e===es.ToolPanel&&this.gridOptionsService.is("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}init(){this.moveColumnFeature=this.createManagedBean(new xl(this.pinned,this.eContainer)),this.bodyDropPivotTarget=this.createManagedBean(new wl(this.pinned)),this.dragAndDropService.addDropTarget(this)}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.columnModel.isPivotMode()&&e.dragSource.type===es.ToolPanel}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}}Sl([s("dragAndDropService")],Al.prototype,"dragAndDropService",void 0),Sl([s("columnModel")],Al.prototype,"columnModel",void 0),Sl([s("ctrlsService")],Al.prototype,"ctrlsService",void 0),Sl([r],Al.prototype,"postConstruct",null),Sl([r],Al.prototype,"init",null);class El{static getHeaderClassesFromColDef(e,t,i,n){return u(e)?[]:this.getColumnClassesFromCollDef(e.headerClass,e,t,i,n)}static getToolPanelClassesFromColDef(e,t,i,n){return u(e)?[]:this.getColumnClassesFromCollDef(e.toolPanelClass,e,t,i,n)}static getClassParams(e,t,i,n){return{colDef:e,column:i,columnGroup:n,api:t.api,columnApi:t.columnApi,context:t.context}}static getColumnClassesFromCollDef(e,t,i,n,r){if(u(e))return[];let o;if("function"==typeof e){o=e(this.getClassParams(t,i,n,r))}else o=e;return"string"==typeof o?[o]:Array.isArray(o)?[...o]:[]}}var Tl=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Dl extends sa{constructor(e){super(Dl.TEMPLATE,e),this.headerCompVersion=0,this.column=e.getColumnGroupChild(),this.pinned=e.getPinned()}postConstruct(){const r=this.getGui(),t=(e,t,i)=>{const n=i||r;null!=t&&""!=t?n.setAttribute(e,t):n.removeAttribute(e)},e={setWidth:e=>r.style.width=e,addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),setColId:e=>t("col-id",e),setTitle:e=>t("title",e),setAriaDescription:e=>Ri(r,e),setAriaSort:e=>e?Wi(r,e):Ui(r),setUserCompDetails:e=>this.setUserCompDetails(e),getUserCompInstance:()=>this.headerComp};this.ctrl.setComp(e,this.getGui(),this.eResize,this.eHeaderCompWrapper);const i=this.ctrl.getSelectAllGui();this.eResize.insertAdjacentElement("afterend",i)}destroyHeaderComp(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(e){this.headerCompVersion++;const t=this.headerCompVersion;e.newAgStackInstance().then(e=>this.afterCompCreated(t,e))}afterCompCreated(e,t){e==this.headerCompVersion&&this.isAlive()?(this.destroyHeaderComp(),this.headerComp=t,this.headerCompGui=t.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())):this.destroyBean(t)}}Dl.TEMPLATE='<div class="ag-header-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>\n        </div>',Tl([A("eResize")],Dl.prototype,"eResize",void 0),Tl([A("eHeaderCompWrapper")],Dl.prototype,"eHeaderCompWrapper",void 0),Tl([r],Dl.prototype,"postConstruct",null),Tl([Ve],Dl.prototype,"destroyHeaderComp",null);var Rl=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Ml extends sa{constructor(e){super(Ml.TEMPLATE,e)}postConstruct(){const i=this.getGui(),t=(e,t)=>null!=t?i.setAttribute(e,t):i.removeAttribute(e),e={addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),setResizableDisplayed:e=>w(this.eResize,e),setWidth:e=>i.style.width=e,setColId:e=>i.setAttribute("col-id",e),setAriaExpanded:e=>t("aria-expanded",e),setTitle:e=>t("title",e),setUserCompDetails:e=>this.setUserCompDetails(e)};this.ctrl.setComp(e,i,this.eResize)}setUserCompDetails(e){e.newAgStackInstance().then(e=>this.afterHeaderCompCreated(e))}afterHeaderCompCreated(e){const t=()=>this.destroyBean(e);if(!this.isAlive())return void t();const i=this.getGui(),n=e.getGui();i.appendChild(n),this.addDestroyFunc(t),this.ctrl.setDragSource(i)}}Ml.TEMPLATE='<div class="ag-header-group-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n        </div>',Rl([s("userComponentFactory")],Ml.prototype,"userComponentFactory",void 0),Rl([A("eResize")],Ml.prototype,"eResize",void 0),Rl([r],Ml.prototype,"postConstruct",null);var kl,Ol=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e.COLUMN_GROUP="group",e.COLUMN="column",e.FLOATING_FILTER="filter"}(kl||(kl={}));class Nl extends S{constructor(e){super(),this.headerComps={};const t=e.getType()==kl.COLUMN_GROUP?"ag-header-row-column-group":e.getType()==kl.FLOATING_FILTER?"ag-header-row-column-filter":"ag-header-row-column";this.setTemplate(`<div class="ag-header-row ${t}" role="row"></div>`),this.ctrl=e}init(){const e={setTransform:e=>this.getGui().style.transform=e,setHeight:e=>this.getGui().style.height=e,setTop:e=>this.getGui().style.top=e,setHeaderCtrls:e=>this.setHeaderCtrls(e),setWidth:e=>this.getGui().style.width=e,setAriaRowIndex:e=>Bi(this.getGui(),e)};this.ctrl.setComp(e)}destroyHeaderCtrls(){this.setHeaderCtrls([])}setHeaderCtrls(e){if(!this.isAlive())return;const n=this.headerComps;this.headerComps={},e.forEach(e=>{const t=e.getInstanceId();let i=n[t];delete n[t],null==i&&(i=this.createHeaderComp(e),this.getGui().appendChild(i.getGui())),this.headerComps[t]=i}),a(n,(e,t)=>{this.getGui().removeChild(t.getGui()),this.destroyBean(t)});const t=this.gridOptionsService.is("ensureDomOrder"),i=this.gridOptionsService.isDomLayout("print");if(t||i){const e=ye(this.headerComps);e.sort((e,t)=>e.getCtrl().getColumnGroupChild().getLeft()-t.getCtrl().getColumnGroupChild().getLeft());const n=e.map(e=>e.getGui());Qn(this.getGui(),n)}}createHeaderComp(e){let t;switch(this.ctrl.getType()){case kl.COLUMN_GROUP:t=new Ml(e);break;case kl.FLOATING_FILTER:t=new la(e);break;default:t=new Dl(e)}return this.createBean(t),t.setParentComponent(this),t}}Ol([r],Nl.prototype,"init",null),Ol([Ve],Nl.prototype,"destroyHeaderCtrls",null);var Il=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Ll=0;class Pl extends p{constructor(e,t){super(),this.lastFocusEvent=null,this.columnGroupChild=e,this.parentRowCtrl=t,this.instanceId=e.getUniqueId()+"-"+Ll++}shouldStopEventPropagation(e){const{headerRowIndex:t,column:i}=this.focusService.getFocusedHeader();return br(this.gridOptionsService,e,t,i)}getWrapperHasFocus(){return this.gridOptionsService.getDocument().activeElement===this.eGui}setGui(e){this.eGui=e,this.addDomData()}handleKeyDown(e){const t=this.getWrapperHasFocus();switch(e.key){case x.PAGE_DOWN:case x.PAGE_UP:case x.PAGE_HOME:case x.PAGE_END:t&&e.preventDefault()}}addDomData(){const e=Pl.DOM_DATA_KEY_HEADER_CTRL;this.gridOptionsService.setDomData(this.eGui,e,this),this.addDestroyFunc(()=>this.gridOptionsService.setDomData(this.eGui,e,null))}getGui(){return this.eGui}focus(e){return!!this.eGui&&(this.lastFocusEvent=e||null,this.eGui.focus(),!0)}getRowIndex(){return this.parentRowCtrl.getRowIndex()}getParentRowCtrl(){return this.parentRowCtrl}getPinned(){return this.parentRowCtrl.getPinned()}getInstanceId(){return this.instanceId}getColumnGroupChild(){return this.columnGroupChild}}Pl.DOM_DATA_KEY_HEADER_CTRL="headerCtrl",Il([s("focusService")],Pl.prototype,"focusService",void 0),Il([s("beans")],Pl.prototype,"beans",void 0),Il([s("userComponentFactory")],Pl.prototype,"userComponentFactory",void 0);var Fl=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Gl extends p{constructor(e,t,i,n){super(),this.columnOrGroup=e,this.eCell=t,this.ariaEl=this.eCell.querySelector("[role=columnheader]")||this.eCell,this.colsSpanning=n,this.beans=i}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){return this.beans.gridOptionsService.is("enableRtl")&&this.colsSpanning?f(this.colsSpanning):this.columnOrGroup}postConstruct(){this.addManagedListener(this.columnOrGroup,d.EVENT_LEFT_CHANGED,this.onLeftChanged.bind(this)),this.setLeftFirstTime(),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onLeftChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onLeftChanged.bind(this))}setLeftFirstTime(){const e=this.beans.gridOptionsService.is("suppressColumnMoveAnimation"),t=C(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&t&&!e?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=e.getLeft(),i=e.getOldLeft(),n=this.modifyLeftForPrintLayout(e,i),r=this.modifyLeftForPrintLayout(e,t);this.setLeft(n),this.actualLeft=r,this.beans.columnAnimationService.executeNextVMTurn(()=>{this.actualLeft===r&&this.setLeft(r)})}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){if(!this.beans.gridOptionsService.isDomLayout("print"))return t;if("left"===e.getPinned())return t;const i=this.beans.columnModel.getDisplayedColumnsLeftWidth();if("right"===e.getPinned()){return i+this.beans.columnModel.getBodyContainerWidth()+t}return i+t}setLeft(e){let t;if(C(e)&&(this.eCell.style.left=e+"px"),this.columnOrGroup instanceof d)t=this.columnOrGroup;else{const e=this.columnOrGroup.getLeafColumns();if(!e.length)return;e.length>1&&zi(this.ariaEl,e.length),t=e[0]}const i=this.beans.columnModel.getAriaColumnIndex(t);ji(this.ariaEl,i)}}Fl([r],Gl.prototype,"postConstruct",null);var $l=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Hl extends p{constructor(e,t){super(),this.columns=e,this.element=t}postConstruct(){this.gridOptionsService.is("columnHoverHighlight")&&this.addMouseHoverListeners()}addMouseHoverListeners(){this.addManagedListener(this.element,"mouseout",this.onMouseOut.bind(this)),this.addManagedListener(this.element,"mouseover",this.onMouseOver.bind(this))}onMouseOut(){this.columnHoverService.clearMouseOver()}onMouseOver(){this.columnHoverService.setMouseOver(this.columns)}}$l([s("columnHoverService")],Hl.prototype,"columnHoverService",void 0),$l([r],Hl.prototype,"postConstruct",null);var Bl=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Vl extends Pl{constructor(e,t){super(e,t),this.iconCreated=!1,this.column=e}setComp(e,t,i,n){super.setGui(t),this.comp=e,this.eButtonShowMainFilter=i,this.eFloatingFilterBody=n,this.setupActive(),this.setupWidth(),this.setupLeft(),this.setupHover(),this.setupFocus(),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(),this.setupUi(),this.addManagedListener(this.eButtonShowMainFilter,"click",this.showParentFilter.bind(this)),this.setupFilterChangedListener(),this.addManagedListener(this.column,d.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this))}setupActive(){const e=this.column.getColDef(),t=!!e.filter,i=!!e.floatingFilter;this.active=t&&i}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=mr("filter",this.gridOptionsService,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(){this.createManagedBean(new Wr(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.localeService.getLocaleTextFunc();Ti(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){if(this.gridOptionsService.getDocument().activeElement===this.eGui)return;const t=this.focusService.findNextFocusableElement(this.eGui,null,e.shiftKey);if(t)return this.beans.headerNavigationService.scrollToColumn(this.column),e.preventDefault(),void t.focus();const i=this.findNextColumnWithFloatingFilter(e.shiftKey);i&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:i},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.columnModel;let i=this.column;do{if(i=e?t.getDisplayedColBefore(i):t.getDisplayedColAfter(i),!i)break}while(!i.getColDef().filter||!i.getColDef().floatingFilter);return i}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case x.UP:case x.DOWN:t||e.preventDefault();case x.LEFT:case x.RIGHT:if(t)return;e.stopPropagation();case x.ENTER:t&&this.focusService.focusInto(this.eGui)&&e.preventDefault();break;case x.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const t=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),i=!!e.relatedTarget&&On(e.relatedTarget,"ag-floating-filter");if(t&&i&&e.target===this.eGui){const e=this.lastFocusEvent,t=!(!e||e.key!==x.TAB);if(e&&t){const t=e.shiftKey;this.focusService.focusInto(this.eGui,t)}}const n=this.getRowIndex();this.beans.focusService.setFocusedHeader(n,this.column)}setupHover(){this.createManagedBean(new Hl([this.column],this.eGui));const e=()=>{if(!this.gridOptionsService.is("columnHoverHighlight"))return;const e=this.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",e)};this.addManagedListener(this.eventService,y.EVENT_COLUMN_HOVER_CHANGED,e),e()}setupLeft(){const e=new Gl(this.column,this.eGui,this.beans);this.createManagedBean(e)}setupFilterButton(){const e=this.column.getColDef();this.suppressFilterButton=!!e.floatingFilterComponentParams&&!!e.floatingFilterComponentParams.suppressFilterButton}setupUserComp(){if(!this.active)return;const e=this.filterManager.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){const e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuFactory.showMenuAfterButtonClick(this.column,e,"floatingFilter","filterMenuTab",["filterMenuTab"])}setupSyncWithFilter(){if(!this.active)return;const e=i=>{const e=this.comp.getFloatingFilterComp();e&&e.then(t=>{if(t){const e=this.filterManager.getCurrentFloatingFilterParentModel(this.column);t.onParentModelChanged(e,i)}})};this.destroySyncListener=this.addManagedListener(this.column,d.EVENT_FILTER_CHANGED,e),this.filterManager.isFilterActive(this.column)&&e(null)}setupWidth(){const e=()=>{const e=this.column.getActualWidth()+"px";this.comp.setWidth(e)};this.addManagedListener(this.column,d.EVENT_WIDTH_CHANGED,e),e()}setupFilterChangedListener(){this.active&&(this.destroyFilterChangedListener=this.addManagedListener(this.column,d.EVENT_FILTER_CHANGED,this.updateFilterButton.bind(this)))}updateFilterButton(){!this.suppressFilterButton&&this.comp&&this.comp.setButtonWrapperDisplayed(this.filterManager.isFilterAllowed(this.column))}onColDefChanged(){var e,t;const i=this.active;this.setupActive();const n=!i&&this.active;i&&!this.active&&(null===(e=this.destroySyncListener)||void 0===e||e.call(this),null===(t=this.destroyFilterChangedListener)||void 0===t||t.call(this));const r=this.active?this.filterManager.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,o=this.comp.getFloatingFilterComp();o&&r?o.then(e=>{var t;e&&(null===(t=this.userCompDetails)||void 0===t?void 0:t.componentClass)===r.componentClass||this.updateCompDetails(r,n)}):this.updateCompDetails(r,n)}updateCompDetails(e,t){this.setCompDetails(e),this.setupFilterButton(),this.setupUi(),t&&(this.setupSyncWithFilter(),this.setupFilterChangedListener())}}Bl([s("filterManager")],Vl.prototype,"filterManager",void 0),Bl([s("columnHoverService")],Vl.prototype,"columnHoverService",void 0),Bl([s("menuFactory")],Vl.prototype,"menuFactory",void 0);var jl=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class zl extends p{constructor(e,t,i,n,r){super(),this.pinned=e,this.column=t,this.eResize=i,this.comp=n,this.ctrl=r}postConstruct(){const i=this.column.getColDef(),t=[];let n,r;const o=()=>{if(w(this.eResize,n),!n)return;const e=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(t.push(e),r){const e=this.gridOptionsService.is("skipHeaderOnAutoSize"),t=()=>{this.columnModel.autoSizeColumn(this.column,e,"uiColumnResized")};this.eResize.addEventListener("dblclick",t);const n=new D(this.eResize);n.addEventListener(D.EVENT_DOUBLE_TAP,t),this.addDestroyFunc(()=>{this.eResize.removeEventListener("dblclick",t),n.removeEventListener(D.EVENT_DOUBLE_TAP,t),n.destroy()})}},s=()=>{t.forEach(e=>e()),t.length=0},e=()=>{const e=this.column.isResizable(),t=!this.gridOptionsService.is("suppressAutoSize")&&!i.suppressAutoSize;(e!==n||t!==r)&&(n=e,r=t,s(),o())};e(),this.addDestroyFunc(s),this.ctrl.addRefreshFunction(e)}onResizing(e,t){const i=this.normaliseResizeAmount(t),n=[{key:this.column,newWidth:this.resizeStartWidth+i}];this.columnModel.setColumnWidths(n,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.resizeWithShiftKey=e,this.comp.addOrRemoveCssClass("ag-column-resizing",!0)}normaliseResizeAmount(e){let t=e;const i="left"!==this.pinned,n="right"===this.pinned;return this.gridOptionsService.is("enableRtl")?i&&(t*=-1):n&&(t*=-1),t}}jl([s("horizontalResizeService")],zl.prototype,"horizontalResizeService",void 0),jl([s("columnModel")],zl.prototype,"columnModel",void 0),jl([r],zl.prototype,"postConstruct",null);var Wl=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Ul extends p{constructor(e){super(),this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1,this.column=e;const t=e.getColDef();this.filteredOnly=!!(null==t?void 0:t.headerCheckboxSelectionFilteredOnly),this.currentPageOnly=!!(null==t?void 0:t.headerCheckboxSelectionCurrentPageOnly)}onSpaceKeyDown(e){const t=this.cbSelectAll,i=this.gridOptionsService.getDocument();t.isDisplayed()&&!t.getGui().contains(i.activeElement)&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e,this.cbSelectAll=this.createManagedBean(new ao),this.cbSelectAll.addCssClass("ag-header-select-all"),Ci(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedListener(this.eventService,y.EVENT_NEW_COLUMNS_LOADED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,y.EVENT_SELECTION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_PAGINATION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_MODEL_UPDATED,this.onModelChanged.bind(this)),this.addManagedListener(this.cbSelectAll,ao.EVENT_CHANGED,this.onCbSelectAll.bind(this)),Ii(this.cbSelectAll.getGui(),!0),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}showOrHideSelectAll(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible,{skipAriaHidden:!0}),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()}onModelChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}onSelectionChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}updateStateOfCheckbox(){if(this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const e=this.selectionService.getSelectAllState(this.filteredOnly,this.currentPageOnly);this.cbSelectAll.setValue(e),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(){const e=this.localeService.getLocaleTextFunc(),t=this.cbSelectAll.getValue()?e("ariaChecked","checked"):e("ariaUnchecked","unchecked"),i=e("ariaRowSelectAll","Press Space to toggle all rows selection");this.cbSelectAllVisible?this.headerCellCtrl.setAriaDescriptionProperty("selectAll",`${i} (${t})`):this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel(`${i} (${t})`),this.headerCellCtrl.refreshAriaDescription()}checkRightRowModelType(e){const t=this.rowModel.getType();return!("clientSide"!==t&&"serverSide"!==t)||(console.warn(`AG Grid: ${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox)return;if(!this.cbSelectAllVisible)return;const e=this.cbSelectAll.getValue();let t="uiSelectAll";this.currentPageOnly?t="uiSelectAllCurrentPage":this.filteredOnly&&(t="uiSelectAllFiltered");const i={source:t,justFiltered:this.filteredOnly,justCurrentPage:this.currentPageOnly};e?this.selectionService.selectAllRowNodes(i):this.selectionService.deselectAllRowNodes(i)}isCheckboxSelection(){let e=this.column.getColDef().headerCheckboxSelection;if("function"==typeof e){e=e({column:this.column,colDef:this.column.getColDef(),columnApi:this.columnApi,api:this.gridApi,context:this.gridOptionsService.context})}return!!e&&this.checkRightRowModelType("headerCheckboxSelection")}}Wl([s("gridApi")],Ul.prototype,"gridApi",void 0),Wl([s("columnApi")],Ul.prototype,"columnApi",void 0),Wl([s("rowModel")],Ul.prototype,"rowModel",void 0),Wl([s("selectionService")],Ul.prototype,"selectionService",void 0);var Yl,ql=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e.TAB_GUARD="ag-tab-guard",e.TAB_GUARD_TOP="ag-tab-guard-top",e.TAB_GUARD_BOTTOM="ag-tab-guard-bottom"}(Yl||(Yl={}));class Kl extends p{constructor(e){super(),this.skipTabGuardFocus=!1;const{comp:t,eTopGuard:i,eBottomGuard:n,focusInnerElement:r,onFocusIn:o,onFocusOut:s,shouldStopEventPropagation:a,onTabKeyDown:l,handleKeyDown:c,eFocusableElement:u}=e;this.comp=t,this.eTopGuard=i,this.eBottomGuard=n,this.providedFocusInnerElement=r,this.eFocusableElement=u,this.providedFocusIn=o,this.providedFocusOut=s,this.providedShouldStopEventPropagation=a,this.providedOnTabKeyDown=l,this.providedHandleKeyDown=c}postConstruct(){this.createManagedBean(new Wr(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach(e=>this.addManagedListener(e,"focus",this.onFocus.bind(this)))}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return!!this.providedShouldStopEventPropagation&&this.providedShouldStopEventPropagation()}activateTabGuards(){const e=this.gridOptionsService.getNum("tabIndex")||0;this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.skipTabGuardFocus)return void(this.skipTabGuardFocus=!1);const t=e.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t)}onFocusIn(e){this.providedFocusIn&&this.providedFocusIn(e)||this.deactivateTabGuards()}onFocusOut(e){this.providedFocusOut&&this.providedFocusOut(e)||this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards()}onTabKeyDown(e){if(this.providedOnTabKeyDown)return void this.providedOnTabKeyDown(e);if(e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const i=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),i&&(i.focus(),e.preventDefault())}focusInnerElement(e=!1){const t=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length&&t[e?t.length-1:0].focus({preventScroll:!0})}getNextFocusableElement(e){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,t.focus()}}ql([s("focusService")],Kl.prototype,"focusService",void 0),ql([r],Kl.prototype,"postConstruct",null);var Xl,Zl=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Ql=Xl=class extends p{static addKeyboardModeEvents(e,t){const i=Xl.instancesMonitored.get(e);i&&i.length>0?-1===i.indexOf(t)&&i.push(t):(Xl.instancesMonitored.set(e,[t]),e.addEventListener("keydown",Xl.toggleKeyboardMode),e.addEventListener("mousedown",Xl.toggleKeyboardMode))}static removeKeyboardModeEvents(e,t){const i=Xl.instancesMonitored.get(e);let n=[];i&&i.length&&(n=[...i].filter(e=>e!==t),Xl.instancesMonitored.set(e,n)),0===n.length&&(e.removeEventListener("keydown",Xl.toggleKeyboardMode),e.removeEventListener("mousedown",Xl.toggleKeyboardMode))}static toggleKeyboardMode(e){const t=Xl.keyboardModeActive,i="keydown"===e.type;if(i&&(e.ctrlKey||e.metaKey||e.altKey))return;if(t&&i||!t&&!i)return;Xl.keyboardModeActive=i;const n=e.target.ownerDocument;if(!n)return;const r=Xl.instancesMonitored.get(n);r&&r.forEach(e=>{e.dispatchEvent({type:i?y.EVENT_KEYBOARD_FOCUS:y.EVENT_MOUSE_FOCUS})})}init(){const e=this.clearFocusedCell.bind(this);this.addManagedListener(this.eventService,y.EVENT_COLUMN_PIVOT_MODE_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverythingChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_GROUP_OPENED,e),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.ctrlsService.whenReady(e=>{this.gridCtrl=e.gridCtrl;const t=this.gridOptionsService.getDocument();Xl.addKeyboardModeEvents(t,this.gridCtrl),this.addDestroyFunc(()=>this.unregisterGridCompController(this.gridCtrl))})}unregisterGridCompController(e){const t=this.gridOptionsService.getDocument();Xl.removeKeyboardModeEvents(t,e)}onColumnEverythingChanged(){if(!this.focusedCellPosition)return;const e=this.focusedCellPosition.column,t=this.columnModel.getGridColumn(e.getId());e!==t&&this.clearFocusedCell()}isKeyboardMode(){return Xl.keyboardModeActive}getFocusCellToUseAfterRefresh(){const e=this.gridOptionsService.getDocument();return this.gridOptionsService.is("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(e.activeElement,Pa.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition}getFocusHeaderToUseAfterRefresh(){const e=this.gridOptionsService.getDocument();return this.gridOptionsService.is("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(e.activeElement,Pl.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition}isDomDataMissingInHierarchy(e,t){let i=e;for(;i;){if(this.gridOptionsService.getDomData(i,t))return!1;i=i.parentNode}return!0}getFocusedCell(){return this.focusedCellPosition}shouldRestoreFocus(e){return!!this.isCellRestoreFocused(e)&&(setTimeout(()=>{this.restoredFocusedCellPosition=null},0),!0)}isCellRestoreFocused(e){return null!=this.restoredFocusedCellPosition&&this.cellPositionUtils.equals(e,this.restoredFocusedCellPosition)}setRestoreFocusedCell(e){"react"===this.getFrameworkOverrides().renderingEngine&&(this.restoredFocusedCellPosition=e)}getFocusEventParams(){const{rowIndex:e,rowPinned:t,column:i}=this.focusedCellPosition,n={rowIndex:e,rowPinned:t,column:i,isFullWidthCell:!1},r=this.rowRenderer.getRowByPosition({rowIndex:e,rowPinned:t});return r&&(n.isFullWidthCell=r.isFullWidth()),n}clearFocusedCell(){if(this.restoredFocusedCellPosition=null,null==this.focusedCellPosition)return;const e=Object.assign({type:y.EVENT_CELL_FOCUS_CLEARED},this.getFocusEventParams());this.focusedCellPosition=null,this.eventService.dispatchEvent(e)}setFocusedCell(e){const{column:t,rowIndex:i,rowPinned:n,forceBrowserFocus:r=!1,preventScrollOnBrowserFocus:o=!1}=e,s=this.columnModel.getGridColumn(t);if(!s)return void(this.focusedCellPosition=null);this.focusedCellPosition=s?{rowIndex:i,rowPinned:J(n),column:s}:null;const a=Object.assign(Object.assign({type:y.EVENT_CELL_FOCUSED},this.getFocusEventParams()),{forceBrowserFocus:r,preventScrollOnBrowserFocus:o,floating:null});this.eventService.dispatchEvent(a)}isCellFocused(e){return null!=this.focusedCellPosition&&this.cellPositionUtils.equals(e,this.focusedCellPosition)}isRowNodeFocused(e){return this.isRowFocused(e.rowIndex,e.rowPinned)}isHeaderWrapperFocused(e){if(null==this.focusedHeaderPosition)return!1;const t=e.getColumnGroupChild(),i=e.getRowIndex(),n=e.getPinned(),{column:r,headerRowIndex:o}=this.focusedHeaderPosition;return t===r&&i===o&&n==r.getPinned()}clearFocusedHeader(){this.focusedHeaderPosition=null}getFocusedHeader(){return this.focusedHeaderPosition}setFocusedHeader(e,t){this.focusedHeaderPosition={headerRowIndex:e,column:t}}focusHeaderPosition(e){const{direction:t,fromTab:i,allowUserOverride:n,event:r}=e;let{headerPosition:o}=e;if(n){const e=this.getFocusedHeader(),n=this.headerNavigationService.getHeaderRowCount();if(i){const i=this.gridOptionsService.getCallback("tabToNextHeader");if(i){o=i({backwards:"Before"===t,previousHeaderPosition:e,nextHeaderPosition:o,headerRowCount:n})}}else{const t=this.gridOptionsService.getCallback("navigateToNextHeader");if(t&&r){o=t({key:r.key,previousHeaderPosition:e,nextHeaderPosition:o,headerRowCount:n,event:r})}}}if(!o)return!1;if(-1===o.headerRowIndex)return this.focusGridView(o.column);this.headerNavigationService.scrollToColumn(o.column,t);return this.ctrlsService.getHeaderRowContainerCtrl(o.column.getPinned()).focusHeader(o.headerRowIndex,o.column,r)}focusFirstHeader(){let e=this.columnModel.getAllDisplayedColumns()[0];return!!e&&(e.getParent()&&(e=this.columnModel.getColumnGroupAtLevel(e,0)),this.focusHeaderPosition({headerPosition:{headerRowIndex:0,column:e}}))}focusLastHeader(e){const t=this.headerNavigationService.getHeaderRowCount()-1,i=f(this.columnModel.getAllDisplayedColumns());return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:i},event:e})}isAnyCellFocused(){return!!this.focusedCellPosition}isRowFocused(e,t){return null!=this.focusedCellPosition&&(this.focusedCellPosition.rowIndex===e&&this.focusedCellPosition.rowPinned===J(t))}findFocusableElements(e,t,i=!1){const n=Tn;let r=Dn;t&&(r+=", "+t),i&&(r+=', [tabindex="-1"]');const o=Array.prototype.slice.apply(e.querySelectorAll(n)),s=Array.prototype.slice.apply(e.querySelectorAll(r));if(!s.length)return o;return a=s,o.filter(e=>-1===a.indexOf(e));var a}focusInto(e,t=!1,i=!1){const n=this.findFocusableElements(e,null,i),r=t?f(n):n[0];return!!r&&(r.focus({preventScroll:!0}),!0)}findFocusableElementBeforeTabGuard(e,t){if(!t)return null;const i=this.findFocusableElements(e),n=i.indexOf(t);if(-1===n)return null;let r=-1;for(let e=n-1;e>=0;e--)if(i[e].classList.contains(Yl.TAB_GUARD_TOP)){r=e;break}return r<=0?null:i[r-1]}findNextFocusableElement(e=this.eGridDiv,t,i){const n=this.findFocusableElements(e,t?':not([tabindex="-1"])':null),r=this.gridOptionsService.getDocument().activeElement;let o;o=t?n.findIndex(e=>e.contains(r)):n.indexOf(r);const s=o+(i?-1:1);return s<0||s>=n.length?null:n[s]}isTargetUnderManagedComponent(e,t){if(!t)return!1;const i=e.querySelectorAll("."+Wr.FOCUS_MANAGED_CLASS);if(!i.length)return!1;for(let e=0;e<i.length;e++)if(i[e].contains(t))return!0;return!1}findTabbableParent(e,t=5){let i=0;for(;e&&null===on(e)&&++i<=t;)e=e.parentElement;return null===on(e)?null:e}focusGridView(e,t){if(this.gridOptionsService.is("suppressCellFocus"))return t?this.focusLastHeader():this.focusNextGridCoreContainer(!1);const i=t?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(!i)return!1;const{rowIndex:n,rowPinned:r}=i,o=this.getFocusedHeader();if(!e&&o&&(e=o.column),null==n||!e)return!1;if(this.navigationService.ensureCellVisible({rowIndex:n,column:e,rowPinned:r}),this.setFocusedCell({rowIndex:n,column:e,rowPinned:J(r),forceBrowserFocus:!0}),this.rangeService){const t={rowIndex:n,rowPinned:r,column:e};this.rangeService.setRangeToCell(t)}return!0}focusNextGridCoreContainer(e,t=!1){return!(t||!this.gridCtrl.focusNextInnerContainer(e))||((t||!e&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(e),!1)}};Ql.AG_KEYBOARD_FOCUS="ag-keyboard-focus",Ql.keyboardModeActive=!1,Ql.instancesMonitored=new Map,Zl([s("eGridDiv")],Ql.prototype,"eGridDiv",void 0),Zl([s("columnModel")],Ql.prototype,"columnModel",void 0),Zl([s("headerNavigationService")],Ql.prototype,"headerNavigationService",void 0),Zl([s("rowRenderer")],Ql.prototype,"rowRenderer",void 0),Zl([s("rowPositionUtils")],Ql.prototype,"rowPositionUtils",void 0),Zl([s("cellPositionUtils")],Ql.prototype,"cellPositionUtils",void 0),Zl([c("rangeService")],Ql.prototype,"rangeService",void 0),Zl([s("navigationService")],Ql.prototype,"navigationService",void 0),Zl([s("ctrlsService")],Ql.prototype,"ctrlsService",void 0),Zl([r],Ql.prototype,"init",null),Ql=Xl=Zl([o("focusService")],Ql);var Jl=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class ec extends Pl{constructor(e,t){super(e,t),this.refreshFunctions=[],this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map,this.column=e}setComp(e,t,i,n){super.setGui(t),this.comp=e,this.updateState(),this.setupWidth(),this.setupMovingCss(),this.setupMenuClass(),this.setupSortableClass(),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight(n),this.addColumnHoverListener(),this.setupFilterCss(),this.setupColId(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(),this.setupSelectAll(),this.setupUserComp(),this.refreshAria(),this.createManagedBean(new zl(this.getPinned(),this.column,i,e,this)),this.createManagedBean(new Hl([this.column],t)),this.createManagedBean(new Gl(this.column,t,this.beans)),this.createManagedBean(new Wr(t,{shouldStopEventPropagation:e=>this.shouldStopEventPropagation(e),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addMouseDownListenerIfNeeded(t),this.addManagedListener(this.column,d.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_VALUE_CHANGED,this.onColumnValueChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onColumnRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PIVOT_CHANGED,this.onColumnPivotChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}addMouseDownListenerIfNeeded(i){if(!Zi())return;const n=this.gridOptionsService.getDocument();["mousedown","touchstart"].forEach(e=>{this.addManagedListener(i,e,e=>{const t=n.activeElement;t===i||i.contains(t)||(i.focus(),Ql.toggleKeyboardMode(e))})})}setupUserComp(){const e=this.lookupUserCompDetails();this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){const e=this.createParams(),t=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(t,e)}createParams(){const e=this.column.getColDef();return{column:this.column,displayName:this.displayName,enableSorting:e.sortable,enableMenu:this.menuEnabled,showColumnMenu:e=>{this.gridApi.showColumnMenuAfterButtonClick(this.column,e)},progressSort:e=>{this.sortController.progressSort(this.column,!!e,"uiColumnSorted")},setSort:(e,t)=>{this.sortController.setSortForColumn(this.column,e,!!t,"uiColumnSorted")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsService.context,eGridHeader:this.getGui()}}setupSelectAll(){this.selectAllFeature=this.createManagedBean(new Ul(this.column)),this.selectAllFeature.setComp(this)}getSelectAllGui(){return this.selectAllFeature.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===x.SPACE&&this.selectAllFeature.onSpaceKeyDown(e),e.key===x.ENTER&&this.onEnterKeyDown(e)}onEnterKeyDown(e){const t=this.comp.getUserCompInstance();if(t)if(e.ctrlKey||e.metaKey)this.menuEnabled&&t.showMenu&&(e.preventDefault(),t.showMenu());else if(this.sortable){const t=e.shiftKey;this.sortController.progressSort(this.column,t,"uiColumnSorted")}}isMenuEnabled(){return this.menuEnabled}onFocusIn(e){if(!this.getGui().contains(e.relatedTarget)){const e=this.getRowIndex();this.focusService.setFocusedHeader(e,this.column)}this.setActiveHeader(!0)}onFocusOut(e){this.getGui().contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(){const e={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getGui:()=>this.eGui,getLocation:()=>"header",getTooltipValue:()=>this.column.getColDef().headerTooltip},t=this.createManagedBean(new Ta(e,this.beans));t.setComp(this.comp),this.refreshFunctions.push(()=>t.refreshToolTip())}setupClassesFromColDef(){const e=()=>{const e=this.column.getColDef(),t=El.getHeaderClassesFromColDef(e,this.gridOptionsService,this.column,null),i=this.userHeaderClasses;this.userHeaderClasses=new Set(t),t.forEach(e=>{i.has(e)?i.delete(e):this.comp.addOrRemoveCssClass(e,!0)}),i.forEach(e=>this.comp.addOrRemoveCssClass(e,!1))};this.refreshFunctions.push(e),e()}setDragSource(e){if(this.dragSourceElement=e,this.removeDragSource(),!e)return;if(!this.draggable)return;const i=!this.gridOptionsService.is("suppressDragLeaveHidesColumns");this.moveDragSource={type:es.HeaderCell,eElement:e,defaultIconName:i?M.ICON_HIDE:M.ICON_NOT_ALLOWED,getDragItem:()=>this.createDragItem(),dragItemName:this.displayName,onDragStarted:()=>this.column.setMoving(!0,"uiColumnMoved"),onDragStopped:()=>this.column.setMoving(!1,"uiColumnMoved"),onGridEnter:e=>{var t;if(i){const i=(null===(t=null==e?void 0:e.columns)||void 0===t?void 0:t.filter(e=>!e.getColDef().lockVisible))||[];this.columnModel.setColumnsVisible(i,!0,"uiColumnMoved")}},onGridExit:e=>{var t;if(i){const i=(null===(t=null==e?void 0:e.columns)||void 0===t?void 0:t.filter(e=>!e.getColDef().lockVisible))||[];this.columnModel.setColumnsVisible(i,!1,"uiColumnMoved")}}},this.dragAndDropService.addDragSource(this.moveDragSource,!0)}createDragItem(){const e={};return e[this.column.getId()]=this.column.isVisible(),{columns:[this.column],visibleState:e}}removeDragSource(){this.moveDragSource&&(this.dragAndDropService.removeDragSource(this.moveDragSource),this.moveDragSource=void 0)}onColDefChanged(){this.refresh()}updateState(){const e=this.column.getColDef();this.menuEnabled=this.menuFactory.isMenuEnabled(this.column)&&!e.suppressMenu,this.sortable=e.sortable,this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}addRefreshFunction(e){this.refreshFunctions.push(e)}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),this.refreshFunctions.forEach(e=>e())}refreshHeaderComp(){const e=this.lookupUserCompDetails();!!(null!=this.comp.getUserCompInstance()&&this.userCompDetails.componentClass==e.componentClass)&&this.attemptHeaderCompRefresh(e.params)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();if(!t)return!1;if(!t.refresh)return!1;return t.refresh(e)}calculateDisplayName(){return this.columnModel.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gridOptionsService.is("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}onColumnRowGroupChanged(){this.checkDisplayName()}onColumnPivotChanged(){this.checkDisplayName()}onColumnValueChanged(){this.checkDisplayName()}setupWidth(){const e=()=>{const e=this.column.getActualWidth();this.comp.setWidth(e+"px")};this.addManagedListener(this.column,d.EVENT_WIDTH_CHANGED,e),e()}setupMovingCss(){const e=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving())};this.addManagedListener(this.column,d.EVENT_MOVING_CHANGED,e),e()}setupMenuClass(){const e=()=>{this.comp.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())};this.addManagedListener(this.column,d.EVENT_MENU_VISIBLE_CHANGED,e),e()}setupSortableClass(){const e=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!this.sortable)};e(),this.addRefreshFunction(e),this.addManagedListener(this.eventService,d.EVENT_SORT_CHANGED,this.refreshAriaSort.bind(this))}setupWrapTextClass(){const e=()=>{const e=!!this.column.getColDef().wrapHeaderText;this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",e)};e(),this.addRefreshFunction(e)}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui:e,column:t,comp:i,columnModel:n,gridOptionsService:r}=this;if(!t.isSpanHeaderHeight())return;const{numberOfParents:o,isSpanningTotal:s}=this.getColumnGroupPaddingInfo();if(i.addOrRemoveCssClass("ag-header-span-height",o>0),0===o)return;i.addOrRemoveCssClass("ag-header-span-total",s);const a=r.is("pivotMode")?n.getPivotGroupHeaderHeight():n.getGroupHeaderHeight(),l=n.getColumnHeaderRowHeight(),c=o*a;e.style.setProperty("top",-c+"px"),e.style.setProperty("height",l+c+"px")}getColumnGroupPaddingInfo(){let e=this.column.getParent();if(!e||!e.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const t=e.getPaddingLevel()+1;let i=!0;for(;e;){if(!e.isPadding()){i=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:i}}setupAutoHeight(a){const l=e=>{if(!this.isAlive())return;const{paddingTop:t,paddingBottom:i,borderBottomWidth:n,borderTopWidth:r}=Nn(this.getGui()),o=t+i+n+r,s=a.offsetHeight+o;if(e<5){const t=this.beans.gridOptionsService.getDocument(),i=0==s;if(!t||!t.contains(a)||i)return void this.beans.frameworkOverrides.setTimeout(()=>l(e+1),0)}this.columnModel.setColumnHeaderHeight(this.column,s)};let e,t=!1;const i=()=>{const e=this.column.isAutoHeaderHeight();e&&!t&&n(),!e&&t&&r()},n=()=>{t=!0,l(0),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),e=this.resizeObserverService.observeResize(a,()=>l(0))},r=()=>{t=!1,e&&e(),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),e=void 0};i(),this.addDestroyFunc(()=>r()),this.addManagedListener(this.column,d.EVENT_WIDTH_CHANGED,()=>t&&l(0)),this.addManagedListener(this.eventService,d.EVENT_SORT_CHANGED,()=>{t&&this.beans.frameworkOverrides.setTimeout(()=>l(0))}),this.addRefreshFunction(i)}refreshAriaSort(){if(this.sortable){const e=this.localeService.getLocaleTextFunc(),t=this.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(xi(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort."))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press CTRL ENTER to open column menu."))}else this.setAriaDescriptionProperty("menu",null)}setAriaDescriptionProperty(e,t){null!=t?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}refreshAriaDescription(){const e=Array.from(this.ariaDescriptionProperties.values());this.comp.setAriaDescription(e.length?e.join(" "):void 0)}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaDescription()}addColumnHoverListener(){const e=()=>{if(!this.gridOptionsService.is("columnHoverHighlight"))return;const e=this.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",e)};this.addManagedListener(this.eventService,y.EVENT_COLUMN_HOVER_CHANGED,e),e()}setupFilterCss(){const e=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-filtered",this.column.isFilterActive())};this.addManagedListener(this.column,d.EVENT_FILTER_ACTIVE_CHANGED,e),e()}setupColId(){this.comp.setColId(this.column.getColId())}addActiveHeaderMouseListeners(){const e=e=>this.setActiveHeader("mouseenter"===e.type);this.addManagedListener(this.getGui(),"mouseenter",e),this.addManagedListener(this.getGui(),"mouseleave",e)}setActiveHeader(e){this.comp.addOrRemoveCssClass("ag-header-active",e)}}Jl([s("columnModel")],ec.prototype,"columnModel",void 0),Jl([s("columnHoverService")],ec.prototype,"columnHoverService",void 0),Jl([s("sortController")],ec.prototype,"sortController",void 0),Jl([s("menuFactory")],ec.prototype,"menuFactory",void 0),Jl([s("dragAndDropService")],ec.prototype,"dragAndDropService",void 0),Jl([s("resizeObserverService")],ec.prototype,"resizeObserverService",void 0),Jl([s("gridApi")],ec.prototype,"gridApi",void 0),Jl([s("columnApi")],ec.prototype,"columnApi",void 0),Jl([Ve],ec.prototype,"removeDragSource",null);var tc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class ic extends p{constructor(e,t,i,n){super(),this.eResize=t,this.comp=e,this.pinned=i,this.columnGroup=n}postConstruct(){if(!this.columnGroup.isResizable())return void this.comp.setResizableDisplayed(!1);const e=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(e),!this.gridOptionsService.is("suppressAutoSize")){const e=this.gridOptionsService.is("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",()=>{const t=[];this.columnGroup.getDisplayedLeafColumns().forEach(e=>{e.getColDef().suppressAutoSize||t.push(e.getColId())}),t.length>0&&this.columnModel.autoSizeColumns({columns:t,skipHeader:e,stopAtGroup:this.columnGroup,source:"uiColumnResized"}),this.resizeLeafColumnsToFit("uiColumnResized")})}}onResizeStart(e){this.calculateInitialValues();let t=null;if(e&&(t=this.columnModel.getDisplayedGroupAfter(this.columnGroup)),t){const e=t.getDisplayedLeafColumns();this.resizeTakeFromCols=e.filter(e=>e.isResizable()),this.resizeTakeFromStartWidth=0,this.resizeTakeFromCols.forEach(e=>this.resizeTakeFromStartWidth+=e.getActualWidth()),this.resizeTakeFromRatios=[],this.resizeTakeFromCols.forEach(e=>this.resizeTakeFromRatios.push(e.getActualWidth()/this.resizeTakeFromStartWidth))}else this.resizeTakeFromCols=null,this.resizeTakeFromStartWidth=null,this.resizeTakeFromRatios=null;this.comp.addOrRemoveCssClass("ag-column-resizing",!0)}onResizing(e,t,i="uiColumnResized"){const n=this.normaliseDragChange(t),r=this.resizeStartWidth+n;this.resizeColumns(r,i,e)}resizeLeafColumnsToFit(e){const t=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup);this.calculateInitialValues(),t>this.resizeStartWidth&&this.resizeColumns(t,e,!0)}resizeColumns(e,t,i=!0){const n=[];if(n.push({columns:this.resizeCols,ratios:this.resizeRatios,width:e}),this.resizeTakeFromCols){const t=e-this.resizeStartWidth;n.push({columns:this.resizeTakeFromCols,ratios:this.resizeTakeFromRatios,width:this.resizeTakeFromStartWidth-t})}this.columnModel.resizeColumnSets({resizeSets:n,finished:i,source:t}),i&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)}calculateInitialValues(){const e=this.columnGroup.getDisplayedLeafColumns();this.resizeCols=e.filter(e=>e.isResizable()),this.resizeStartWidth=0,this.resizeCols.forEach(e=>this.resizeStartWidth+=e.getActualWidth()),this.resizeRatios=[],this.resizeCols.forEach(e=>this.resizeRatios.push(e.getActualWidth()/this.resizeStartWidth))}normaliseDragChange(e){let t=e;return this.gridOptionsService.is("enableRtl")?"left"!==this.pinned&&(t*=-1):"right"===this.pinned&&(t*=-1),t}}tc([s("horizontalResizeService")],ic.prototype,"horizontalResizeService",void 0),tc([s("autoWidthCalculator")],ic.prototype,"autoWidthCalculator",void 0),tc([s("columnModel")],ic.prototype,"columnModel",void 0),tc([r],ic.prototype,"postConstruct",null);var nc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class rc extends p{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListener(this.columnGroup,g.EVENT_DISPLAYED_CHILDREN_CHANGED,this.onDisplayedChildrenChanged.bind(this)),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const t=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(e=>{e.addEventListener("widthChanged",t),e.addEventListener("visibleChanged",t),this.removeChildListenersFuncs.push(()=>{e.removeEventListener("widthChanged",t),e.removeEventListener("visibleChanged",t)})})}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach(e=>e()),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(e+"px"),this.comp.addOrRemoveCssClass("ag-hidden",0===e)}}nc([r],rc.prototype,"postConstruct",null);var oc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class sc extends Pl{constructor(e,t){super(e,t),this.columnGroup=e}setComp(e,t,i){super.setGui(t),this.comp=e,this.displayName=this.columnModel.getDisplayNameForColumnGroup(this.columnGroup,"header"),this.addClasses(),this.addAttributes(),this.setupMovingCss(),this.setupExpandable(),this.setupTooltip(),this.setupUserComp();const n=this.getParentRowCtrl().getPinned(),r=this.columnGroup.getProvidedColumnGroup().getLeafColumns();this.createManagedBean(new Hl(r,t)),this.createManagedBean(new Gl(this.columnGroup,t,this.beans)),this.createManagedBean(new rc(e,this.columnGroup)),this.groupResizeFeature=this.createManagedBean(new ic(e,i,n,this.columnGroup)),this.createManagedBean(new Wr(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}resizeLeafColumnsToFit(e){this.groupResizeFeature&&this.groupResizeFeature.resizeLeafColumnsToFit(e)}setupUserComp(){let i=this.displayName;const e={displayName:this.displayName,columnGroup:this.columnGroup,setExpanded:e=>{this.columnModel.setColumnGroupOpened(this.columnGroup.getProvidedColumnGroup(),e,"gridInitializing")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsService.context};if(!i){let e=this.columnGroup;const n=e.getLeafColumns();for(;e.getParent()&&e.getParent().getLeafColumns().length===n.length;)e=e.getParent();const t=e.getColGroupDef();t&&(i=t.headerName),i||(i=n?this.columnModel.getDisplayNameForColumn(n[0],"header",!0):"")}const n=this.userComponentFactory.getHeaderGroupCompDetails(e);this.comp.setUserCompDetails(n)}setupTooltip(){const e=this.columnGroup.getColGroupDef(),t={getColumn:()=>this.columnGroup,getGui:()=>this.eGui,getLocation:()=>"headerGroup",getTooltipValue:()=>e&&e.headerTooltip};e&&(t.getColDef=()=>e);this.createManagedBean(new Ta(t,this.beans)).setComp(this.comp)}setupExpandable(){const e=this.columnGroup.getProvidedColumnGroup();this.refreshExpanded(),this.addManagedListener(e,h.EVENT_EXPANDABLE_CHANGED,this.refreshExpanded.bind(this)),this.addManagedListener(e,h.EVENT_EXPANDED_CHANGED,this.refreshExpanded.bind(this))}refreshExpanded(){const e=this.columnGroup;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0)}addAttributes(){this.comp.setColId(this.columnGroup.getUniqueId())}addClasses(){const e=this.columnGroup.getColGroupDef(),t=El.getHeaderClassesFromColDef(e,this.gridOptionsService,null,this.columnGroup);if(this.columnGroup.isPadding()){t.push("ag-header-group-cell-no-group");this.columnGroup.getLeafColumns().every(e=>e.isSpanHeaderHeight())&&t.push("ag-header-span-height")}else t.push("ag-header-group-cell-with-group");t.forEach(e=>this.comp.addOrRemoveCssClass(e,!0))}setupMovingCss(){const e=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),t=()=>this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.columnGroup.isMoving());e.forEach(e=>{this.addManagedListener(e,d.EVENT_MOVING_CHANGED,t)}),t()}onFocusIn(e){if(!this.eGui.contains(e.relatedTarget)){const e=this.getRowIndex();this.beans.focusService.setFocusedHeader(e,this.columnGroup)}}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();if(this.expandable&&t&&e.key===x.ENTER){const e=this.columnGroup,t=!e.isExpanded();this.columnModel.setColumnGroupOpened(e.getProvidedColumnGroup(),t,"uiColumnExpanded")}}setDragSource(e){if(this.isSuppressMoving())return;const t=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),i=!this.gridOptionsService.is("suppressDragLeaveHidesColumns"),n={type:es.HeaderCell,eElement:e,defaultIconName:i?M.ICON_HIDE:M.ICON_NOT_ALLOWED,dragItemName:this.displayName,getDragItem:this.getDragItemForGroup.bind(this),onDragStarted:()=>t.forEach(e=>e.setMoving(!0,"uiColumnDragged")),onDragStopped:()=>t.forEach(e=>e.setMoving(!1,"uiColumnDragged")),onGridEnter:e=>{var t;if(i){const i=(null===(t=null==e?void 0:e.columns)||void 0===t?void 0:t.filter(e=>!e.getColDef().lockVisible))||[];this.columnModel.setColumnsVisible(i,!0,"uiColumnMoved")}},onGridExit:e=>{var t;if(i){const i=(null===(t=null==e?void 0:e.columns)||void 0===t?void 0:t.filter(e=>!e.getColDef().lockVisible))||[];this.columnModel.setColumnsVisible(i,!1,"uiColumnMoved")}}};this.dragAndDropService.addDragSource(n,!0),this.addDestroyFunc(()=>this.dragAndDropService.removeDragSource(n))}getDragItemForGroup(){const t=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),i={};t.forEach(e=>i[e.getId()]=e.isVisible());const n=[];return this.columnModel.getAllDisplayedColumns().forEach(e=>{t.indexOf(e)>=0&&(n.push(e),st(t,e))}),t.forEach(e=>n.push(e)),{columns:n,visibleState:i}}isSuppressMoving(){let t=!1;this.columnGroup.getLeafColumns().forEach(e=>{(e.getColDef().suppressMovable||e.getColDef().lockPosition)&&(t=!0)});return t||this.gridOptionsService.is("suppressMovableColumns")}}oc([s("columnModel")],sc.prototype,"columnModel",void 0),oc([s("dragAndDropService")],sc.prototype,"dragAndDropService",void 0),oc([s("gridApi")],sc.prototype,"gridApi",void 0),oc([s("columnApi")],sc.prototype,"columnApi",void 0);var ac=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let lc=0;class cc extends p{constructor(e,t,i){super(),this.instanceId=lc++,this.headerCellCtrls={},this.rowIndex=e,this.pinned=t,this.type=i}getInstanceId(){return this.instanceId}setComp(e){this.comp=e,this.onRowHeightChanged(),this.onVirtualColumnsChanged(),this.setWidth(),this.addEventListeners(),Zi()&&this.comp.setTransform("translateZ(0)"),e.setAriaRowIndex(this.rowIndex+1)}addEventListeners(){this.addManagedListener(this.eventService,y.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_GRID_STYLES_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),this.addManagedPropertyListener("headerHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("groupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotGroupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("floatingFiltersHeight",this.onRowHeightChanged.bind(this))}getHeaderCellCtrl(t){return le(this.headerCellCtrls).find(e=>e.getColumnGroupChild()===t)}onDisplayedColumnsChanged(){this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}getType(){return this.type}onColumnResized(){this.setWidth()}setWidth(){const e=this.getWidthForRow();this.comp.setWidth(e+"px")}getWidthForRow(){if(this.gridOptionsService.isDomLayout("print")){return null!=this.pinned?0:this.columnModel.getContainerWidth("right")+this.columnModel.getContainerWidth("left")+this.columnModel.getContainerWidth(null)}return this.columnModel.getContainerWidth(this.pinned)}onRowHeightChanged(){let e=this.columnModel.getHeaderRowCount();const t=[];let i=0;this.columnModel.hasFloatingFilters()&&(e++,i=1);const n=this.columnModel.getColumnGroupHeaderRowHeight(),r=this.columnModel.getColumnHeaderRowHeight(),o=e-(1+i);for(let e=0;e<o;e++)t.push(n);t.push(r);for(let e=0;e<i;e++)t.push(this.columnModel.getFloatingFiltersHeight());let s=0;for(let e=0;e<this.rowIndex;e++)s+=t[e];const a=t[this.rowIndex]+"px";this.comp.setTop(s+"px"),this.comp.setHeight(a)}getPinned(){return this.pinned}getRowIndex(){return this.rowIndex}onVirtualColumnsChanged(){const n=this.headerCellCtrls;this.headerCellCtrls={};this.getColumnsInViewport().forEach(e=>{if(e.isEmptyGroup())return;const t=e.getUniqueId();let i=n[t];delete n[t];if(i&&i.getColumnGroupChild()!=e&&(this.destroyBean(i),i=void 0),null==i)switch(this.type){case kl.FLOATING_FILTER:i=this.createBean(new Vl(e,this));break;case kl.COLUMN_GROUP:i=this.createBean(new sc(e,this));break;default:i=this.createBean(new ec(e,this))}this.headerCellCtrls[t]=i});const i=e=>{if(!this.focusService.isHeaderWrapperFocused(e))return!1;return this.columnModel.isDisplayed(e.getColumnGroupChild())};a(n,(e,t)=>{i(t)?this.headerCellCtrls[e]=t:this.destroyBean(t)});const e=ye(this.headerCellCtrls);this.comp.setHeaderCtrls(e)}getColumnsInViewport(){return this.gridOptionsService.isDomLayout("print")?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}getColumnsInViewportPrintLayout(){if(null!=this.pinned)return[];let i=[];const n=this.getActualDepth();return["left",null,"right"].forEach(e=>{const t=this.columnModel.getVirtualHeaderGroupRow(e,n);i=i.concat(t)}),i}getActualDepth(){return this.type==kl.FLOATING_FILTER?this.rowIndex-1:this.rowIndex}getColumnsInViewportNormalLayout(){return this.columnModel.getVirtualHeaderGroupRow(this.pinned,this.getActualDepth())}focusHeader(t,e){const i=ye(this.headerCellCtrls).find(e=>e.getColumnGroupChild()==t);return!!i&&(i.focus(e),!0)}destroy(){a(this.headerCellCtrls,(e,t)=>{this.destroyBean(t)}),this.headerCellCtrls={},super.destroy()}}ac([s("columnModel")],cc.prototype,"columnModel",void 0),ac([s("focusService")],cc.prototype,"focusService",void 0);var uc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class dc extends p{constructor(e){super(),this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[],this.pinned=e}setComp(e,t){this.comp=e,this.eViewport=t,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport),this.addManagedListener(this.eventService,y.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.ctrlsService.registerHeaderContainer(this,this.pinned),this.columnModel.isReady()&&this.refresh()}setupDragAndDrop(e){const t=new Al(this.pinned,e);this.createManagedBean(t)}refresh(i=!1){const n=new Tr,e=this.focusService.getFocusHeaderToUseAfterRefresh();(()=>{const t=this.columnModel.getHeaderRowCount()-1;this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls);for(let e=0;e<t;e++){const t=this.createBean(new cc(n.next(),this.pinned,kl.COLUMN_GROUP));this.groupsRowCtrls.push(t)}})(),(()=>{const e=n.next(),t=!(this.hidden||null!=this.columnsRowCtrl&&i&&this.columnsRowCtrl.getRowIndex()===e);(t||this.hidden)&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),t&&(this.columnsRowCtrl=this.createBean(new cc(e,this.pinned,kl.COLUMN)))})(),(()=>{this.includeFloatingFilter=this.columnModel.hasFloatingFilters()&&!this.hidden;const e=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter)return void e();const t=n.next();if(this.filtersRowCtrl){const n=this.filtersRowCtrl.getRowIndex()!==t;i&&!n||e()}this.filtersRowCtrl||(this.filtersRowCtrl=this.createBean(new cc(t,this.pinned,kl.FLOATING_FILTER)))})();const t=this.getAllCtrls();this.comp.setCtrls(t),this.restoreFocusOnHeader(e)}restoreFocusOnHeader(e){null!=e&&e.column.getPinned()==this.pinned&&this.focusService.focusHeaderPosition({headerPosition:e})}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}onGridColumnsChanged(){this.refresh(!0)}onDisplayedColumnsChanged(){const e=this.columnModel.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==e&&this.refresh(!0)}setupCenterWidth(){null==this.pinned&&this.createManagedBean(new Xa(e=>this.comp.setCenterWidth(e+"px"),!0))}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}setupPinnedWidth(){if(null==this.pinned)return;const s="left"===this.pinned,a="right"===this.pinned;this.hidden=!0;const e=()=>{const e=s?this.pinnedWidthService.getPinnedLeftWidth():this.pinnedWidthService.getPinnedRightWidth();if(null==e)return;const t=0==e,i=this.hidden!==t,n=this.gridOptionsService.is("enableRtl"),r=this.gridOptionsService.getScrollbarWidth(),o=this.scrollVisibleService.isVerticalScrollShowing()&&(n&&s||!n&&a)?e+r:e;this.comp.setPinnedContainerWidth(o+"px"),this.comp.setDisplayed(!t),i&&(this.hidden=t,this.refresh())};this.addManagedListener(this.eventService,y.EVENT_LEFT_PINNED_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_RIGHT_PINNED_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_SCROLL_VISIBILITY_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_SCROLLBAR_WIDTH_CHANGED,e)}getHeaderCtrlForColumn(i){if(i instanceof d){if(!this.columnsRowCtrl)return;return this.columnsRowCtrl.getHeaderCellCtrl(i)}if(0!==this.groupsRowCtrls.length)for(let t=0;t<this.groupsRowCtrls.length;t++){const e=this.groupsRowCtrls[t].getHeaderCellCtrl(i);if(e)return e}}getHtmlElementForColumnHeader(e){const t=this.getHeaderCtrlForColumn(e);return t?t.getGui():null}getRowType(e){const t=this.getAllCtrls()[e];return t?t.getType():void 0}focusHeader(e,t,i){const n=this.getAllCtrls()[e];return!!n&&n.focusHeader(t,i)}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}destroy(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),super.destroy()}}uc([s("ctrlsService")],dc.prototype,"ctrlsService",void 0),uc([s("scrollVisibleService")],dc.prototype,"scrollVisibleService",void 0),uc([s("pinnedWidthService")],dc.prototype,"pinnedWidthService",void 0),uc([s("columnModel")],dc.prototype,"columnModel",void 0),uc([s("focusService")],dc.prototype,"focusService",void 0);var hc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class fc extends S{constructor(e){super(),this.headerRowComps={},this.rowCompsList=[],this.pinned=e}init(){this.selectAndSetTemplate();const e={setDisplayed:e=>this.setDisplayed(e),setCtrls:e=>this.setCtrls(e),setCenterWidth:e=>this.eCenterContainer.style.width=e,setViewportScrollLeft:e=>this.getGui().scrollLeft=e,setPinnedContainerWidth:e=>{const t=this.getGui();t.style.width=e,t.style.maxWidth=e,t.style.minWidth=e}};this.createManagedBean(new dc(this.pinned)).setComp(e,this.getGui())}selectAndSetTemplate(){const e="left"==this.pinned,t="right"==this.pinned,i=e?fc.PINNED_LEFT_TEMPLATE:t?fc.PINNED_RIGHT_TEMPLATE:fc.CENTER_TEMPLATE;this.setTemplate(i),this.eRowContainer=this.eCenterContainer?this.eCenterContainer:this.getGui()}destroyRowComps(){this.setCtrls([])}destroyRowComp(e){this.destroyBean(e),this.eRowContainer.removeChild(e.getGui())}setCtrls(e){const r=this.headerRowComps;let i;this.headerRowComps={},this.rowCompsList=[];const o=e=>{const t=e.getGui();t.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(t),i&&Zn(this.eRowContainer,t,i),i=t};e.forEach(e=>{const t=e.getInstanceId(),i=r[t];delete r[t];const n=i||this.createBean(new Nl(e));this.headerRowComps[t]=n,this.rowCompsList.push(n),o(n)}),ye(r).forEach(e=>this.destroyRowComp(e))}}fc.PINNED_LEFT_TEMPLATE='<div class="ag-pinned-left-header" role="presentation"></div>',fc.PINNED_RIGHT_TEMPLATE='<div class="ag-pinned-right-header" role="presentation"></div>',fc.CENTER_TEMPLATE='<div class="ag-header-viewport" role="presentation">\n            <div class="ag-header-container" ref="eCenterContainer" role="rowgroup"></div>\n        </div>',hc([A("eCenterContainer")],fc.prototype,"eCenterContainer",void 0),hc([r],fc.prototype,"init",null),hc([Ve],fc.prototype,"destroyRowComps",null);var pc,gc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"}(pc||(pc={}));let mc=class extends p{postConstruct(){this.ctrlsService.whenReady(e=>{this.gridBodyCon=e.gridBodyCtrl})}getHeaderRowCount(){const e=this.ctrlsService.getHeaderRowContainerCtrl();return e?e.getRowCount():0}navigateVertically(e,t,i){if(t||(t=this.focusService.getFocusedHeader()),!t)return!1;const{headerRowIndex:n,column:r}=t,o=this.getHeaderRowCount(),s=e===pc.UP;let{nextRow:a,nextFocusColumn:l}=s?this.headerPositionUtils.getColumnVisibleParent(r,n):this.headerPositionUtils.getColumnVisibleChild(r,n),c=!1;return a<0&&(a=0,l=r,c=!0),a>=o&&(a=-1),!(!c&&!l)&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a,column:l},allowUserOverride:!0,event:i})}navigateHorizontally(e,t=!1,i){const n=this.focusService.getFocusedHeader();let r,o;return e===pc.LEFT!==this.gridOptionsService.is("enableRtl")?(o="Before",r=this.headerPositionUtils.findHeader(n,o)):(o="After",r=this.headerPositionUtils.findHeader(n,o)),r||!t?this.focusService.focusHeaderPosition({headerPosition:r,direction:o,fromTab:t,allowUserOverride:!0,event:i}):this.focusNextHeaderRow(n,o,i)}focusNextHeaderRow(e,t,i){const n=e.headerRowIndex;let r,o=null;return"Before"===t?n>0&&(r=n-1,o=this.headerPositionUtils.findColAtEdgeForHeaderRow(r,"end")):(r=n+1,o=this.headerPositionUtils.findColAtEdgeForHeaderRow(r,"start")),this.focusService.focusHeaderPosition({headerPosition:o,direction:t,fromTab:!0,allowUserOverride:!0,event:i})}scrollToColumn(t,i="After"){if(t.getPinned())return;let n;if(t instanceof g){const e=t.getDisplayedLeafColumns();n="Before"===i?f(e):e[0]}else n=t;this.gridBodyCon.getScrollFeature().ensureColumnVisible(n)}};gc([s("focusService")],mc.prototype,"focusService",void 0),gc([s("headerPositionUtils")],mc.prototype,"headerPositionUtils",void 0),gc([s("ctrlsService")],mc.prototype,"ctrlsService",void 0),gc([r],mc.prototype,"postConstruct",null),mc=gc([o("headerNavigationService")],mc);var vc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class yc extends p{setComp(e,t,i){this.comp=e,this.eGui=t,this.createManagedBean(new Wr(i,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onPivotModeChanged(),this.setupHeaderHeight(),this.ctrlsService.registerGridHeaderCtrl(this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListener("headerHeight",e),this.addManagedPropertyListener("pivotHeaderHeight",e),this.addManagedPropertyListener("groupHeaderHeight",e),this.addManagedPropertyListener("pivotGroupHeaderHeight",e),this.addManagedPropertyListener("floatingFiltersHeight",e),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_GRID_STYLES_CHANGED,e)}getHeaderHeight(){return this.headerHeight}setHeaderHeight(){const{columnModel:e}=this;let t,i=0,n=e.getHeaderRowCount();e.hasFloatingFilters()&&(n++,i=1);const r=this.columnModel.getColumnGroupHeaderRowHeight(),o=this.columnModel.getColumnHeaderRowHeight(),s=n-(1+i);if(t=i*e.getFloatingFiltersHeight(),t+=s*r,t+=o,this.headerHeight===t)return;this.headerHeight=t;const a=t+1+"px";this.comp.setHeightAndMinHeight(a),this.eventService.dispatchEvent({type:y.EVENT_HEADER_HEIGHT_CHANGED})}onPivotModeChanged(){const e=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",e),this.comp.addOrRemoveCssClass("ag-pivot-off",!e)}onDisplayedColumnsChanged(){const e=this.columnModel.getAllDisplayedColumns().some(e=>e.isSpanHeaderHeight());this.comp.addOrRemoveCssClass("ag-header-allow-overflow",e)}onTabKeyDown(e){const t=this.gridOptionsService.is("enableRtl"),i=e.shiftKey!==t?pc.LEFT:pc.RIGHT;(this.headerNavigationService.navigateHorizontally(i,!0,e)||this.focusService.focusNextGridCoreContainer(e.shiftKey))&&e.preventDefault()}handleKeyDown(e){let t=null;switch(e.key){case x.LEFT:t=pc.LEFT;case x.RIGHT:C(t)||(t=pc.RIGHT),this.headerNavigationService.navigateHorizontally(t,!1,e);break;case x.UP:t=pc.UP;case x.DOWN:C(t)||(t=pc.DOWN),this.headerNavigationService.navigateVertically(t,null,e)&&e.preventDefault();break;default:return}}onFocusOut(e){const t=this.gridOptionsService.getDocument(),{relatedTarget:i}=e;!i&&this.eGui.contains(t.activeElement)||this.eGui.contains(i)||this.focusService.clearFocusedHeader()}}vc([s("headerNavigationService")],yc.prototype,"headerNavigationService",void 0),vc([s("focusService")],yc.prototype,"focusService",void 0),vc([s("columnModel")],yc.prototype,"columnModel",void 0),vc([s("ctrlsService")],yc.prototype,"ctrlsService",void 0);var bc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class _c extends S{constructor(){super(_c.TEMPLATE)}postConstruct(){const e={addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),setHeightAndMinHeight:e=>{this.getGui().style.height=e,this.getGui().style.minHeight=e}};this.createManagedBean(new yc).setComp(e,this.getGui(),this.getFocusableElement());const t=e=>{this.createManagedBean(e),this.appendChild(e)};t(new fc("left")),t(new fc(null)),t(new fc("right"))}}_c.TEMPLATE='<div class="ag-header" role="presentation"/>',bc([r],_c.prototype,"postConstruct",null);var wc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Cc=class extends p{addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0};this.dragService.addDragSource(t);return()=>this.dragService.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const i=t instanceof MouseEvent&&!0===t.shiftKey;e.onResizeStart(i)}setResizeIcons(){const e=this.ctrlsService.getGridCtrl();e.setResizeCursor(!0),e.disableUserSelect(!0)}onDragStop(e,t){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.ctrlsService.getGridCtrl();e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}};wc([s("dragService")],Cc.prototype,"dragService",void 0),wc([s("ctrlsService")],Cc.prototype,"ctrlsService",void 0),Cc=wc([o("horizontalResizeService")],Cc);var xc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Sc=class extends p{hideActiveMenu(){this.hidePopup&&this.hidePopup()}showMenuAfterMouseEvent(t,i){this.showPopup(t,e=>{this.popupService.positionPopupUnderMouseEvent({column:t,type:"columnMenu",mouseEvent:i,ePopup:e})},"columnMenu",i.target)}showMenuAfterButtonClick(t,i,n){this.showPopup(t,e=>{this.popupService.positionPopupByComponent({type:n,eventSource:i,ePopup:e,keepWithinBounds:!0,position:"under",column:t})},n,i)}showPopup(n,t,i,r){const o=this.filterManager.getOrCreateFilterWrapper(n,"COLUMN_MENU");if(!o)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");const s=document.createElement("div");let a;Ci(s,"presentation"),s.classList.add("ag-menu"),this.tabListener=this.addManagedListener(s,"keydown",e=>this.trapFocusWithin(e,s)),o.guiPromise.then(e=>s.appendChild(e));const e=r||this.ctrlsService.getGridBodyCtrl().getGui(),l=this.localeService.getLocaleTextFunc(),c=this.popupService.addPopup({modal:!0,eChild:s,closeOnEsc:!0,closedCallback:e=>{n.setMenuVisible(!1,"contextMenu");const t=e instanceof KeyboardEvent;if(this.tabListener&&(this.tabListener=this.tabListener()),t&&r&&Wn(r)){const n=this.focusService.findTabbableParent(r);n&&n.focus()}var i;null===(i=o.filterPromise)||void 0===i||i.then(e=>{var t;return null===(t=null==e?void 0:e.afterGuiDetached)||void 0===t?void 0:t.call(e)})},positionCallback:()=>t(s),anchorToElement:e,ariaLabel:l("ariaLabelColumnMenu","Column Menu")});c&&(this.hidePopup=a=c.hideFunc),o.filterPromise.then(e=>{t(s),e.afterGuiAttached&&e.afterGuiAttached({container:i,hidePopup:a})}),n.setMenuVisible(!0,"contextMenu")}trapFocusWithin(e,t){e.key!==x.TAB||e.defaultPrevented||this.focusService.findNextFocusableElement(t,!1,e.shiftKey)||(e.preventDefault(),this.focusService.focusInto(t,e.shiftKey))}isMenuEnabled(e){return e.isFilterAllowed()&&e.getMenuTabs(["filterMenuTab"]).includes("filterMenuTab")}};xc([s("filterManager")],Sc.prototype,"filterManager",void 0),xc([s("popupService")],Sc.prototype,"popupService",void 0),xc([s("focusService")],Sc.prototype,"focusService",void 0),xc([s("ctrlsService")],Sc.prototype,"ctrlsService",void 0),Sc=xc([o("menuFactory")],Sc);var Ac=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Ec extends S{constructor(e){super(Ec.getTemplate(e.cssClass)),this.items=[],this.tabbedItemScrollMap=new Map,this.params=e,e.items&&e.items.forEach(e=>this.addItem(e))}postConstruct(){this.createManagedBean(new Wr(this.getFocusableElement(),{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this)})),this.addDestroyFunc(()=>{var e,t,i;return null===(i=null===(t=null===(e=this.activeItem)||void 0===e?void 0:e.tabbedItem)||void 0===t?void 0:t.afterDetachedCallback)||void 0===i?void 0:i.call(t)})}static getTemplate(e){return`<div class="ag-tabs ${e}">\n            <div ref="eHeader" role="tablist" class="ag-tabs-header ${e?e+"-header":""}"></div>\n            <div ref="eBody" role="presentation" class="ag-tabs-body ${e?e+"-body":""}"></div>\n        </div>`}handleKeyDown(o){const s=this.gridOptionsService.getDocument();switch(o.key){case x.RIGHT:case x.LEFT:if(!this.eHeader.contains(s.activeElement))return;const e=o.key===x.RIGHT,t=this.gridOptionsService.is("enableRtl"),i=this.items.indexOf(this.activeItem),n=e!==t?Math.min(i+1,this.items.length-1):Math.max(i-1,0);if(i===n)return;o.preventDefault();const r=this.items[n];this.showItemWrapper(r),r.eHeaderButton.focus();break;case x.UP:case x.DOWN:o.stopPropagation()}}onTabKeyDown(e){if(e.defaultPrevented)return;const{focusService:t,eHeader:i,eBody:n,activeItem:r}=this,o=this.gridOptionsService.getDocument().activeElement,s=e.target;if(e.preventDefault(),i.contains(o))return void t.focusInto(n,e.shiftKey);let a=null;t.isTargetUnderManagedComponent(n,s)&&(e.shiftKey&&(a=this.focusService.findFocusableElementBeforeTabGuard(n,s)),a||(a=r.eHeaderButton)),!a&&n.contains(o)&&(a=t.findNextFocusableElement(n,!1,e.shiftKey),a||(a=r.eHeaderButton)),a&&a.focus()}setAfterAttachedParams(e){this.afterAttachedParams=e}showFirstItem(){this.items.length>0&&this.showItemWrapper(this.items[0])}addItem(e){const t=document.createElement("span");Ci(t,"tab"),t.setAttribute("tabindex","-1"),t.appendChild(e.title),t.classList.add("ag-tab"),this.eHeader.appendChild(t),Ti(t,e.titleLabel);const i={tabbedItem:e,eHeaderButton:t};this.items.push(i),t.addEventListener("click",this.showItemWrapper.bind(this,i))}showItem(t){const e=this.items.find(e=>e.tabbedItem===t);e&&this.showItemWrapper(e)}showItemWrapper(e){var t,i;const{tabbedItem:n,eHeaderButton:r}=e;this.params.onItemClicked&&this.params.onItemClicked({item:n}),this.activeItem!==e?(this.lastScrollListener&&(this.lastScrollListener=this.lastScrollListener()),Vn(this.eBody),n.bodyPromise.then(t=>{this.eBody.appendChild(t);const i=!this.focusService.isKeyboardMode();if(this.focusService.focusInto(this.eBody,!1,i),n.afterAttachedCallback&&n.afterAttachedCallback(this.afterAttachedParams),this.params.keepScrollPosition){const i=n.getScrollableContainer&&n.getScrollableContainer()||t;this.lastScrollListener=this.addManagedListener(i,"scroll",()=>{this.tabbedItemScrollMap.set(n.name,i.scrollTop)});const e=this.tabbedItemScrollMap.get(n.name);void 0!==e&&setTimeout(()=>{i.scrollTop=e},0)}}),this.activeItem&&(this.activeItem.eHeaderButton.classList.remove("ag-tab-selected"),null===(i=(t=this.activeItem.tabbedItem).afterDetachedCallback)||void 0===i||i.call(t)),r.classList.add("ag-tab-selected"),this.activeItem=e):Ge(this.params.onActiveItemClicked)}}function Tc(i){return l(()=>console.warn("AG Grid: Since v29 simpleHttpRequest has been deprecated as it was only meant for use in internal AG Grid documentation examples. Please use the browser fetch api directly."),"simpleHttpRequest"),new Rr(e=>{const t=new XMLHttpRequest;t.open("GET",i.url),t.send(),t.onreadystatechange=function(){4===t.readyState&&200===t.status&&e(JSON.parse(t.responseText))}})}Ac([s("focusService")],Ec.prototype,"focusService",void 0),Ac([A("eHeader")],Ec.prototype,"eHeader",void 0),Ac([A("eBody")],Ec.prototype,"eBody",void 0),Ac([r],Ec.prototype,"postConstruct",null);var Dc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Rc=class extends p{constructor(){super(...arguments),this.polyfillFunctions=[]}observeResize(o,s){const t=this.gridOptionsService.getWindow(),e=this.gridOptionsService.is("suppressBrowserResizeObserver");return!!t.ResizeObserver&&!e?(()=>{const e=new t.ResizeObserver(s);return e.observe(o),()=>e.disconnect()})():(()=>{let t=Xn(o),i=Kn(o),n=!0;const r=()=>{if(n){const n=Xn(o),e=Kn(o);(n!==t||e!==i)&&(t=n,i=e,s()),this.doNextPolyfillTurn(r)}};return r(),()=>n=!1})()}doNextPolyfillTurn(e){this.polyfillFunctions.push(e),this.schedulePolyfill()}schedulePolyfill(){if(this.polyfillScheduled)return;this.polyfillScheduled=!0,this.getFrameworkOverrides().setTimeout(()=>{const e=this.polyfillFunctions;this.polyfillScheduled=!1,this.polyfillFunctions=[],e.forEach(e=>e())},50)}};Rc=Dc([o("resizeObserverService")],Rc);var Mc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let kc=class extends p{constructor(){super(...arguments),this.createTasksP1={list:[],sorted:!1},this.createTasksP2={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastPage=0,this.lastScrollTop=0,this.taskCount=0,this.cancelledTasks=new Set}setScrollTop(e){const t=this.gridOptionsService.is("pagination");if(this.scrollGoingDown=e>=this.lastScrollTop,t&&0===e){const e=this.paginationProxy.getCurrentPage();e!==this.lastPage&&(this.lastPage=e,this.scrollGoingDown=!0)}this.lastScrollTop=e}init(){this.useAnimationFrame=!this.gridOptionsService.is("suppressAnimationFrame")}isOn(){return this.useAnimationFrame}verifyAnimationFrameOn(e){!1===this.useAnimationFrame&&console.warn(`AG Grid: AnimationFrameService.${e} called but animation frames are off`)}createTask(e,t,i){this.verifyAnimationFrameOn(i);const n={task:e,index:t,createOrder:++this.taskCount};this.addTaskToList(this[i],n),this.schedule()}cancelTask(e){this.cancelledTasks.add(e)}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const i=this.scrollGoingDown?1:-1;e.list.sort((e,t)=>e.index!==t.index?i*(t.index-e.index):t.createOrder-e.createOrder),e.sorted=!0}addDestroyTask(e){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(e),this.schedule()}executeFrame(e){this.verifyAnimationFrameOn("executeFrame");const t=this.createTasksP1,i=t.list,n=this.createTasksP2,r=n.list,o=this.destroyTasks,s=(new Date).getTime();let a=(new Date).getTime()-s;const l=e<=0,c=this.ctrlsService.getGridBodyCtrl();for(;l||a<e;){if(!c.getScrollFeature().scrollGridIfNeeded()){let e;if(i.length)this.sortTaskList(t),e=i.pop().task;else if(r.length)this.sortTaskList(n),e=r.pop().task;else{if(!o.length){this.cancelledTasks.clear();break}e=o.pop()}this.cancelledTasks.has(e)||e()}a=(new Date).getTime()-s}i.length||r.length||o.length?this.requestFrame():this.stopTicking()}stopTicking(){this.ticking=!1}flushAllFrames(){this.useAnimationFrame&&this.executeFrame(-1)}schedule(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);this.requestAnimationFrame(e)}requestAnimationFrame(e){const t=this.gridOptionsService.getWindow();t.requestAnimationFrame?t.requestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.setTimeout(e,0)}isQueueEmpty(){return!this.ticking}debounce(e){let t=!1;return()=>{this.isOn()?t||(t=!0,this.addDestroyTask(()=>{t=!1,e()})):this.getFrameworkOverrides().setTimeout(e,0)}}};Mc([s("ctrlsService")],kc.prototype,"ctrlsService",void 0),Mc([s("paginationProxy")],kc.prototype,"paginationProxy",void 0),Mc([r],kc.prototype,"init",null),kc=Mc([o("animationFrameService")],kc);var Oc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Nc=class extends p{postConstruct(){this.ctrlsService.whenReady(e=>{this.centerRowContainerCtrl=e.centerRowContainerCtrl})}getPreferredWidthForColumn(e,t){const i=this.getHeaderCellForColumn(e);if(!i)return-1;const n=this.rowRenderer.getAllCellsForColumn(e);return t||n.push(i),this.addElementsToContainerAndGetWidth(n)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.addElementsToContainerAndGetWidth([t]):-1}addElementsToContainerAndGetWidth(e){const t=document.createElement("form");t.style.position="fixed";const i=this.centerRowContainerCtrl.getContainerElement();e.forEach(e=>this.cloneItemIntoDummy(e,t)),i.appendChild(t);const n=t.offsetWidth;i.removeChild(t);return n+this.getAutoSizePadding()}getAutoSizePadding(){const e=this.gridOptionsService.getNum("autoSizePadding");return null!=e&&e>=0?e:20}getHeaderCellForColumn(i){let n=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach(e=>{const t=e.getHtmlElementForColumnHeader(i);null!=t&&(n=t)}),n}cloneItemIntoDummy(e,t){const i=e.cloneNode(!0);i.style.width="",i.style.position="static",i.style.left="";const n=document.createElement("div"),r=n.classList;["ag-header-cell","ag-header-group-cell"].some(e=>i.classList.contains(e))?(r.add("ag-header","ag-header-row"),n.style.position="static"):r.add("ag-row");let o=e.parentElement;for(;o;){if(["ag-header-row","ag-row"].some(e=>o.classList.contains(e))){for(let e=0;e<o.classList.length;e++){const t=o.classList[e];"ag-row-position-absolute"!=t&&r.add(t)}break}o=o.parentElement}n.appendChild(i),t.appendChild(n)}};Oc([s("rowRenderer")],Nc.prototype,"rowRenderer",void 0),Oc([s("ctrlsService")],Nc.prototype,"ctrlsService",void 0),Oc([s("rowCssClassCalculator")],Nc.prototype,"rowCssClassCalculator",void 0),Oc([r],Nc.prototype,"postConstruct",null),Nc=Oc([o("autoWidthCalculator")],Nc);var Ic=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Lc extends p{constructor(e,t){super(),this.createRowCon=e,this.destroyRowCtrls=t,this.stickyRowCtrls=[],this.containerHeight=0}postConstruct(){this.isClientSide="clientSide"===this.rowModel.getType(),this.ctrlsService.whenReady(e=>{this.gridBodyCtrl=e.gridBodyCtrl})}getStickyRowCtrls(){return this.stickyRowCtrls}checkStickyRows(){let s=0;if(!this.gridOptionsService.isGroupRowsSticky())return void this.refreshNodesAndContainerHeight([],s);const a=[],l=this.rowRenderer.getFirstVisibleVerticalPixel(),c=t=>{var e,i,n;let r;if(a.push(t),this.isClientSide){let e=t;for(;e.expanded;)if(e.master)e=e.detailNode;else if(e.childrenAfterSort){if(0===e.childrenAfterSort.length)break;e=f(e.childrenAfterSort)}r=e.rowTop+e.rowHeight}else if(t.master)r=t.detailNode.rowTop+t.detailNode.rowHeight;else{const s=null===(e=t.childStore)||void 0===e?void 0:e.getStoreBounds();r=(null!==(i=null==s?void 0:s.heightPx)&&void 0!==i?i:0)+(null!==(n=null==s?void 0:s.topPx)&&void 0!==n?n:0)}const o=l+s+t.rowHeight;t.stickyRowTop=r<o?s+(r-o):s,s=0,a.forEach(e=>{const t=e.stickyRowTop+e.rowHeight;s<t&&(s=t)})};for(;;){const e=l+s,t=this.rowModel.getRowIndexAtPixel(e),i=this.rowModel.getRow(t);if(null==i)break;if(i.level<0)break;const n=[];let r=i.parent;for(;r.level>=0;)n.push(r),r=r.parent;const o=n.reverse().find(e=>a.indexOf(e)<0&&e.displayed);if(o)c(o);else{if(!(i.isExpandable()&&i.expanded&&i.rowTop<e))break;c(i)}}this.refreshNodesAndContainerHeight(a,s)}refreshStickyNode(i){const n=[];for(let t=0;t<this.stickyRowCtrls.length;t++){const e=this.stickyRowCtrls[t].getRowNode();e!==i&&n.push(e)}this.refreshNodesAndContainerHeight(n,this.containerHeight),this.checkStickyRows()}refreshNodesAndContainerHeight(t,e){const i=this.stickyRowCtrls.filter(e=>-1===t.indexOf(e.getRowNode())),n=t.filter(t=>-1===this.stickyRowCtrls.findIndex(e=>e.getRowNode()===t)),r={};i.forEach(t=>{r[t.getRowNode().id]=t,this.stickyRowCtrls=this.stickyRowCtrls.filter(e=>e!==t)});for(const t of Object.values(r))t.getRowNode().sticky=!1;this.destroyRowCtrls(r,!1);const o=n.map(e=>(e.sticky=!0,this.createRowCon(e,!1,!1)));this.stickyRowCtrls.push(...o),this.stickyRowCtrls.forEach(e=>e.setRowTop(e.getRowNode().stickyRowTop)),this.stickyRowCtrls.sort((e,t)=>t.getRowNode().rowIndex-e.getRowNode().rowIndex),this.containerHeight!==e&&(this.containerHeight=e,this.gridBodyCtrl.setStickyTopHeight(e))}}Ic([s("rowModel")],Lc.prototype,"rowModel",void 0),Ic([s("rowRenderer")],Lc.prototype,"rowRenderer",void 0),Ic([s("ctrlsService")],Lc.prototype,"ctrlsService",void 0),Ic([r],Lc.prototype,"postConstruct",null);var Pc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Fc=class extends p{constructor(){super(...arguments),this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1}postConstruct(){this.ctrlsService.whenReady(()=>{this.gridBodyCtrl=this.ctrlsService.getGridBodyCtrl(),this.initialise()})}initialise(){if(this.addManagedListener(this.eventService,y.EVENT_PAGINATION_CHANGED,this.onPageLoaded.bind(this)),this.addManagedListener(this.eventService,y.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_BODY_SCROLL,this.onBodyScroll.bind(this)),this.addManagedListener(this.eventService,y.EVENT_BODY_HEIGHT_CHANGED,this.redraw.bind(this)),this.addManagedPropertyListener("domLayout",this.onDomLayoutChanged.bind(this)),this.addManagedPropertyListener("rowClass",this.redrawRows.bind(this)),this.gridOptionsService.isGroupRowsSticky()){const e=this.rowModel.getType();"clientSide"!==e&&"serverSide"!==e||(this.stickyRowFeature=this.createManagedBean(new Lc(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this))))}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=this.gridOptionsService.isDomLayout("print"),this.embedFullWidthRows=this.printLayout||this.gridOptionsService.is("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gridOptionsService.is("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=null!=e?e:3;this.cachedRowCtrls=new Gc(t)}}getKeepDetailRowsCount(){const e=this.gridOptionsService.getNum("keepDetailRowsCount");return C(e)&&e>0?e:10}getRowCtrls(){return this.allRowCtrls}getStickyTopRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyRowCtrls():[]}updateAllRowCtrls(){const e=ye(this.rowCtrlsByRowIndex),t=this.gridOptionsService.is("ensureDomOrder"),i=this.gridOptionsService.isDomLayout("print");(t||i)&&e.sort((e,t)=>e.getRowNode().rowIndex-t.getRowNode.rowIndex);const n=ye(this.zombieRowCtrls),r=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];this.allRowCtrls=[...e,...n,...r]}onCellFocusChanged(t){this.getAllCellCtrls().forEach(e=>e.onCellFocused(t)),this.getFullWidthRowCtrls().forEach(e=>e.onFullWidthRowFocused(t))}registerCellEventListeners(){this.addManagedListener(this.eventService,y.EVENT_CELL_FOCUSED,e=>{this.onCellFocusChanged(e)}),this.addManagedListener(this.eventService,y.EVENT_CELL_FOCUS_CLEARED,()=>{this.onCellFocusChanged()}),this.addManagedListener(this.eventService,y.EVENT_FLASH_CELLS,t=>{this.getAllCellCtrls().forEach(e=>e.onFlashCells(t))}),this.addManagedListener(this.eventService,y.EVENT_COLUMN_HOVER_CHANGED,()=>{this.getAllCellCtrls().forEach(e=>e.onColumnHover())}),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,()=>{this.getAllCellCtrls().forEach(e=>e.onDisplayedColumnsChanged())}),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,()=>{this.printLayout&&this.getAllCellCtrls().forEach(e=>e.onLeftChanged())});this.gridOptionsService.isEnableRangeSelection()&&(this.addManagedListener(this.eventService,y.EVENT_RANGE_SELECTION_CHANGED,()=>{this.getAllCellCtrls().forEach(e=>e.onRangeSelectionChanged())}),this.addManagedListener(this.eventService,y.EVENT_COLUMN_MOVED,()=>{this.getAllCellCtrls().forEach(e=>e.updateRangeBordersIfRangeCount())}),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PINNED,()=>{this.getAllCellCtrls().forEach(e=>e.updateRangeBordersIfRangeCount())}),this.addManagedListener(this.eventService,y.EVENT_COLUMN_VISIBLE,()=>{this.getAllCellCtrls().forEach(e=>e.updateRangeBordersIfRangeCount())})),this.refreshListenersToColumnsForCellComps(),this.addManagedListener(this.eventService,y.EVENT_GRID_COLUMNS_CHANGED,this.refreshListenersToColumnsForCellComps.bind(this)),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach(e=>e()),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();const e=this.columnModel.getAllGridColumns();e&&e.forEach(i=>{const e=t=>{this.getAllCellCtrls().forEach(e=>{e.getColumn()===i&&t(e)})},t=()=>{e(e=>e.onLeftChanged())},n=()=>{e(e=>e.onWidthChanged())},r=()=>{e(e=>e.onFirstRightPinnedChanged())},o=()=>{e(e=>e.onLastLeftPinnedChanged())},s=()=>{e(e=>e.onColDefChanged())};i.addEventListener("leftChanged",t),i.addEventListener("widthChanged",n),i.addEventListener("firstRightPinnedChanged",r),i.addEventListener("lastLeftPinnedChanged",o),i.addEventListener("colDefChanged",s),this.destroyFuncsForColumnListeners.push(()=>{i.removeEventListener("leftChanged",t),i.removeEventListener("widthChanged",n),i.removeEventListener("firstRightPinnedChanged",r),i.removeEventListener("lastLeftPinnedChanged",o),i.removeEventListener("colDefChanged",s)})})}onDomLayoutChanged(){const e=this.gridOptionsService.isDomLayout("print"),t=e||this.gridOptionsService.is("embedFullWidthRows"),i=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,i&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsForColumn(i){const n=[];return this.getAllRowCtrls().forEach(e=>{const t=e.getCellElement(i);t&&n.push(t)}),n}refreshFloatingRowComps(){this.refreshFloatingRows(this.topRowCtrls,this.pinnedRowModel.getPinnedTopRowData()),this.refreshFloatingRows(this.bottomRowCtrls,this.pinnedRowModel.getPinnedBottomRowData())}getTopRowCtrls(){return this.topRowCtrls}getBottomRowCtrls(){return this.bottomRowCtrls}refreshFloatingRows(i,e){i.forEach(e=>{e.destroyFirstPass(),e.destroySecondPass()}),i.length=0,e&&e.forEach(e=>{const t=new Pa(e,this.beans,!1,!1,this.printLayout);i.push(t)})}onPinnedRowDataChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}getRenderedIndexesForRowNodes(n){const r=[];return u(n)||a(this.rowCtrlsByRowIndex,(e,t)=>{const i=t.getRowNode();n.indexOf(i)>=0&&r.push(e)}),r}redrawRows(e){const t=null!=e&&e.length>0;if(t){const t=this.getRenderedIndexesForRowNodes(e);this.removeRowCtrls(t)}this.redrawAfterModelUpdate({recycleRows:t})}getCellToRestoreFocusToAfterRefresh(e){const t=(null==e?void 0:e.suppressKeepFocus)?null:this.focusService.getFocusCellToUseAfterRefresh();if(null==t)return null;const i=this.gridOptionsService.getDocument().activeElement,n=this.gridOptionsService.getDomData(i,Na.DOM_DATA_KEY_CELL_CTRL),r=this.gridOptionsService.getDomData(i,Pa.DOM_DATA_KEY_ROW_CTRL);return n||r?t:null}redrawAfterModelUpdate(e={}){this.getLockOnRefresh();const t=this.getCellToRestoreFocusToAfterRefresh(e);this.updateContainerHeights(),this.scrollToTopIfNewData(e);const i=!e.domLayoutChanged&&!!e.recycleRows,n=e.animate&&this.gridOptionsService.isAnimateRows(),r=i?this.getRowsToRecycle():null;i||this.removeAllRowComps(),this.recycleRows(r,n),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),null!=t&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){const t=e.newData||e.newPage,i=this.gridOptionsService.is("suppressScrollOnNewData");t&&!i&&this.gridBodyCtrl.getScrollFeature().scrollToTop()}updateContainerHeights(){if(this.printLayout)return void this.rowContainerHeightService.setModelHeight(null);let e=this.paginationProxy.getCurrentPageHeight();0===e&&(e=1),this.rowContainerHeightService.setModelHeight(e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0}releaseLockOnRefresh(){this.refreshInProgress=!1}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){e&&(this.focusService.setRestoreFocusedCell(e),this.onCellFocusChanged({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,api:this.beans.gridApi,columnApi:this.beans.columnApi,context:this.beans.gridOptionsService.context,type:"mock"}))}stopEditing(t=!1){this.getAllRowCtrls().forEach(e=>{e.stopEditing(t)})}getAllCellCtrls(){const i=[],n=this.getAllRowCtrls(),r=n.length;for(let e=0;e<r;e++){const r=n[e].getAllCellCtrls(),t=r.length;for(let e=0;e<t;e++)i.push(r[e])}return i}getAllRowCtrls(){const e=this.stickyRowFeature&&this.stickyRowFeature.getStickyRowCtrls()||[],t=[...this.topRowCtrls,...this.bottomRowCtrls,...e];for(const e of Object.keys(this.rowCtrlsByRowIndex))t.push(this.rowCtrlsByRowIndex[e]);return t}addRenderedRowListener(e,t,i){const n=this.rowCtrlsByRowIndex[t];n&&n.addEventListener(e,i)}flashCells(e={}){const{flashDelay:t,fadeDelay:i}=e;this.getCellCtrls(e.rowNodes,e.columns).forEach(e=>e.flashCell({flashDelay:t,fadeDelay:i}))}refreshCells(e={}){const t={forceRefresh:e.force,newData:!1,suppressFlash:e.suppressFlash};this.getCellCtrls(e.rowNodes,e.columns).forEach(e=>{if(e.refreshShouldDestroy()){const t=e.getRowCtrl();t&&t.refreshCell(e)}else e.refreshCell(t)}),this.refreshFullWidthRows(e.rowNodes)}getCellRendererInstances(e){var t;const i=this.getCellCtrls(e.rowNodes,e.columns).map(e=>e.getCellRenderer()).filter(e=>null!=e);if(null===(t=e.columns)||void 0===t?void 0:t.length)return i;const n=[],r=this.mapRowNodes(e.rowNodes);return this.getAllRowCtrls().forEach(e=>{if(r&&!this.isRowInMap(e.getRowNode(),r))return;if(!e.isFullWidth())return;const t=e.getFullWidthCellRenderer();t&&n.push(t)}),[...n,...i]}getCellEditorInstances(e){const i=[];return this.getCellCtrls(e.rowNodes,e.columns).forEach(e=>{const t=e.getCellEditor();t&&i.push(t)}),i}getEditingCells(){const i=[];return this.getAllCellCtrls().forEach(t=>{if(t.isEditing()){const e=t.getCellPosition();i.push(e)}}),i}mapRowNodes(e){if(!e)return;const i={top:{},bottom:{},normal:{}};return e.forEach(e=>{const t=e.id;"top"===e.rowPinned?i.top[t]=e:"bottom"===e.rowPinned?i.bottom[t]=e:i.normal[t]=e}),i}isRowInMap(e,t){const i=e.id,n=e.rowPinned;return"bottom"===n?null!=t.bottom[i]:"top"===n?null!=t.top[i]:null!=t.normal[i]}getCellCtrls(e,t){const i=this.mapRowNodes(e),n=[];let r;C(t)&&(r={},t.forEach(e=>{const t=this.columnModel.getGridColumn(e);C(t)&&(r[t.getId()]=!0)}));const o=e=>{const t=e.getRowNode();(null==i||this.isRowInMap(t,i))&&e.getAllCellCtrls().forEach(e=>{const t=e.getColumn().getId();r&&!r[t]||n.push(e)})};return this.getAllRowCtrls().forEach(e=>o(e)),n}destroy(){this.removeAllRowComps(),super.destroy()}removeAllRowComps(){const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}getRowsToRecycle(){const i=[];a(this.rowCtrlsByRowIndex,(e,t)=>{null==t.getRowNode().id&&i.push(e)}),this.removeRowCtrls(i);const n={};return a(this.rowCtrlsByRowIndex,(e,t)=>{const i=t.getRowNode();n[i.id]=t}),this.rowCtrlsByRowIndex={},n}removeRowCtrls(e){e.forEach(e=>{const t=this.rowCtrlsByRowIndex[e];t&&(t.destroyFirstPass(),t.destroySecondPass()),delete this.rowCtrlsByRowIndex[e]})}onBodyScroll(e){"vertical"===e.direction&&this.redraw()}redraw(e=!0){let t;if(this.stickyRowFeature&&rn()&&(t=this.getCellToRestoreFocusToAfterRefresh()||void 0),this.getLockOnRefresh(),this.recycleRows(null,!1,e),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(e),null!=t){const e=this.getCellToRestoreFocusToAfterRefresh();null!=t&&null==e&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(t))}}removeRowCompsNotToDraw(e){const t={};e.forEach(e=>t[e]=!0);const i=Object.keys(this.rowCtrlsByRowIndex).filter(e=>!t[e]);this.removeRowCtrls(i)}calculateIndexesToDraw(e){let n=fn(this.firstRenderedRow,this.lastRenderedRow);const t=(e,t)=>{const i=t.getRowNode().rowIndex;null!=i&&(i<this.firstRenderedRow||i>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(t)&&n.push(i)};return a(this.rowCtrlsByRowIndex,t),a(e,t),n.sort((e,t)=>e-t),n=n.filter(e=>{const t=this.paginationProxy.getRow(e);return t&&!t.sticky}),n}recycleRows(i,n=!1,r=!1){this.rowContainerHeightService.updateOffset(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature&&this.stickyRowFeature.checkStickyRows();const e=this.calculateIndexesToDraw(i);this.removeRowCompsNotToDraw(e),this.printLayout&&(n=!1);const o=[];if(e.forEach(e=>{const t=this.createOrUpdateRowCtrl(e,i,n,r);C(t)&&o.push(t)}),i){r&&!this.gridOptionsService.is("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask(()=>{this.destroyRowCtrls(i,n),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(i,n)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){const t={type:y.EVENT_DISPLAYED_ROWS_CHANGED,afterScroll:e};this.eventService.dispatchEvent(t)}onDisplayedColumnsChanged(){const e=this.columnModel.isPinningLeft(),t=this.columnModel.isPinningRight();(this.pinningLeft!==e||t!==this.pinningRight)&&(this.pinningLeft=e,this.pinningRight=t,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const i=[];this.getFullWidthRowCtrls().forEach(e=>{const t=e.getRowNode().rowIndex;i.push(t.toString())}),this.refreshFloatingRowComps(),this.removeRowCtrls(i),this.redraw()}getFullWidthRowCtrls(e){const i=this.mapRowNodes(e);return this.getAllRowCtrls().filter(e=>{if(!e.isFullWidth())return!1;const t=e.getRowNode();return!(null!=i&&!this.isRowInMap(t,i))})}refreshFullWidthRow(e){this.refreshFullWidthRows([e])}refreshFullWidthRows(e){const t=this.getFullWidthRowCtrls(e);let i=!1;const n=[];t.forEach(e=>{if(e.refreshFullWidth())return;const t=e.getRowNode();t.sticky?this.stickyRowFeature.refreshStickyNode(t):n.push(t.rowIndex),i=!0}),n.length>0&&this.removeRowCtrls(n),i&&this.redraw(!1)}createOrUpdateRowCtrl(e,t,i,n){let r,o=this.rowCtrlsByRowIndex[e];o||(r=this.paginationProxy.getRow(e),C(r)&&C(t)&&t[r.id]&&r.alreadyRendered&&(o=t[r.id],t[r.id]=null));if(!o){if(r||(r=this.paginationProxy.getRow(e)),!C(r))return;o=this.createRowCon(r,i,n)}return r&&(r.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=o,o}destroyRowCtrls(e,i){const n=[];a(e,(e,t)=>{t&&(this.cachedRowCtrls&&t.isCacheable()?this.cachedRowCtrls.addRow(t):(t.destroyFirstPass(),i?(this.zombieRowCtrls[t.getInstanceId()]=t,n.push(()=>{t.destroySecondPass(),delete this.zombieRowCtrls[t.getInstanceId()]})):t.destroySecondPass()))}),i&&(n.push(()=>{this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}),Re(n))}getRowBuffer(){let e=this.gridOptionsService.getNum("rowBuffer");return"number"==typeof e?e<0&&(l(()=>console.warn("AG Grid: rowBuffer should not be negative"),"warn rowBuffer negative"),e=0,this.gridOptionsService.set("rowBuffer",0)):e=10,e}getRowBufferInPixels(){return this.getRowBuffer()*this.gridOptionsService.getRowHeightAsNumber()}workOutFirstAndLastRowsToRender(){let l,c;if(this.paginationProxy.isRowsToRender())if(this.printLayout)l=this.paginationProxy.getPageFirstRow(),c=this.paginationProxy.getPageLastRow();else{const u=this.getRowBufferInPixels(),d=this.ctrlsService.getGridBodyCtrl(),h=this.gridOptionsService.is("suppressRowVirtualisation");let o,s,a=!1;do{const l=this.paginationProxy.getPixelOffset(),{pageFirstPixel:c,pageLastPixel:e}=this.paginationProxy.getCurrentPagePixelRange(),t=this.rowContainerHeightService.getDivStretchOffset(),i=d.getScrollFeature().getVScrollPosition(),n=i.top,r=i.bottom;h?(o=c+t,s=e+t):(o=Math.max(n+l-u,c)+t,s=Math.min(r+l+u,e)+t),this.firstVisibleVPixel=Math.max(n+l,c)+t,a=this.ensureAllRowsInRangeHaveHeightsCalculated(o,s)}while(a);let e=this.paginationProxy.getRowIndexAtPixel(o),t=this.paginationProxy.getRowIndexAtPixel(s);const i=this.paginationProxy.getPageFirstRow(),n=this.paginationProxy.getPageLastRow();e<i&&(e=i),t>n&&(t=n),l=e,c=t}else l=0,c=-1;const u=this.gridOptionsService.isDomLayout("normal"),d=this.gridOptionsService.is("suppressMaxRenderedRowRestriction"),h=Math.max(this.getRowBuffer(),500);u&&!d&&c-l>h&&(c=l+h);const e=l!==this.firstRenderedRow,t=c!==this.lastRenderedRow;if(e||t){this.firstRenderedRow=l,this.lastRenderedRow=c;const u={type:y.EVENT_VIEWPORT_CHANGED,firstRow:l,lastRow:c};this.eventService.dispatchEvent(u)}}dispatchFirstDataRenderedEvent(){if(this.dataFirstRenderedFired)return;this.dataFirstRenderedFired=!0;const e={type:y.EVENT_FIRST_DATA_RENDERED,firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow};window.requestAnimationFrame(()=>{this.beans.eventService.dispatchEvent(e)})}ensureAllRowsInRangeHaveHeightsCalculated(e,t){const i=this.paginationProxy.ensureRowHeightsValid(e,t,-1,-1);return i&&this.updateContainerHeights(),i}getFirstVisibleVerticalPixel(){return this.firstVisibleVPixel}getFirstVirtualRenderedRow(){return this.firstRenderedRow}getLastVirtualRenderedRow(){return this.lastRenderedRow}doNotUnVirtualiseRow(e){const t=e.getRowNode(),i=this.focusService.isRowNodeFocused(t),n=e.isEditing(),r=t.detail;if(!(i||n||r))return!1;return!!this.paginationProxy.isRowPresent(t)}createRowCon(e,t,i){const n=this.cachedRowCtrls?this.cachedRowCtrls.getRow(e):null;if(n)return n;const r=this.gridOptionsService.is("suppressAnimationFrame"),o=i&&!r&&!this.printLayout;return new Pa(e,this.beans,t,o,this.printLayout)}getRenderedNodes(){const t=this.rowCtrlsByRowIndex;return Object.keys(t).map(e=>t[e].getRowNode())}getRowByPosition(e){let t;const{rowIndex:i}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[i];break;case"bottom":t=this.bottomRowCtrls[i];break;default:t=this.rowCtrlsByRowIndex[i],t||(t=this.getStickyTopRowCtrls().find(e=>e.getRowNode().rowIndex===i)||null)}return t}getRowNode(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}}isRangeInRenderedViewport(e,t){if(null==e||null==t)return!1;const i=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!i}};Pc([s("animationFrameService")],Fc.prototype,"animationFrameService",void 0),Pc([s("paginationProxy")],Fc.prototype,"paginationProxy",void 0),Pc([s("columnModel")],Fc.prototype,"columnModel",void 0),Pc([s("pinnedRowModel")],Fc.prototype,"pinnedRowModel",void 0),Pc([s("rowModel")],Fc.prototype,"rowModel",void 0),Pc([s("focusService")],Fc.prototype,"focusService",void 0),Pc([s("beans")],Fc.prototype,"beans",void 0),Pc([s("rowContainerHeightService")],Fc.prototype,"rowContainerHeightService",void 0),Pc([s("ctrlsService")],Fc.prototype,"ctrlsService",void 0),Pc([r],Fc.prototype,"postConstruct",null),Fc=Pc([o("rowRenderer")],Fc);class Gc{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.getRowNode().id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const e=this.entriesList[0];e.destroyFirstPass(),e.destroySecondPass(),this.removeFromCache(e)}}getRow(e){if(null==e||null==e.id)return null;const t=this.entriesMap[e.id];if(!t)return null;this.removeFromCache(t),t.setCached(!1);return t.getRowNode()!=e?null:t}removeFromCache(e){const t=e.getRowNode().id;delete this.entriesMap[t],st(this.entriesList,e)}getEntries(){return this.entriesList}}var $c=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Hc=class extends p{formatValue(e,t,i,n,r=!0){let o,s=null;const a=e.getColDef();if(n?o=n:r&&(o=a.valueFormatter),o){const n={value:i,node:t,data:t?t.data:null,colDef:a,column:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};s="function"==typeof o?o(n):this.expressionService.evaluate(o,n)}else if(a.refData)return a.refData[i]||"";return null==s&&Array.isArray(i)&&(s=i.join(", ")),s}};$c([s("expressionService")],Hc.prototype,"expressionService",void 0),Hc=$c([o("valueFormatterService")],Hc);var Bc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Vc=class extends p{init(){this.setPinnedTopRowData(this.gridOptionsService.get("pinnedTopRowData")),this.setPinnedBottomRowData(this.gridOptionsService.get("pinnedBottomRowData"))}isEmpty(e){return ee("top"===e?this.pinnedTopRows:this.pinnedBottomRows)}isRowsToRender(e){return!this.isEmpty(e)}getRowAtPixel(i,e){const n="top"===e?this.pinnedTopRows:this.pinnedBottomRows;if(ee(n))return 0;for(let t=0;t<n.length;t++){const e=n[t];if(e.rowTop+e.rowHeight-1>=i)return t}return n.length-1}setPinnedTopRowData(e){this.pinnedTopRows=this.createNodesFromData(e,!0);const t={type:y.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(t)}setPinnedBottomRowData(e){this.pinnedBottomRows=this.createNodesFromData(e,!1);const t={type:y.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(t)}createNodesFromData(e,o){const s=[];if(e){let r=0;e.forEach((e,t)=>{const i=new R(this.beans);i.data=e;const n=o?R.ID_PREFIX_TOP_PINNED:R.ID_PREFIX_BOTTOM_PINNED;i.id=n+t,i.rowPinned=o?"top":"bottom",i.setRowTop(r),i.setRowHeight(this.gridOptionsService.getRowHeightForNode(i).height),i.setRowIndex(t),r+=i.rowHeight,s.push(i)})}return s}getPinnedTopRowData(){return this.pinnedTopRows}getPinnedBottomRowData(){return this.pinnedBottomRows}getPinnedTopTotalHeight(){return this.getTotalHeight(this.pinnedTopRows)}getPinnedTopRowCount(){return this.pinnedTopRows?this.pinnedTopRows.length:0}getPinnedBottomRowCount(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0}getPinnedTopRow(e){return this.pinnedTopRows[e]}getPinnedBottomRow(e){return this.pinnedBottomRows[e]}forEachPinnedTopRow(e){ee(this.pinnedTopRows)||this.pinnedTopRows.forEach(e)}forEachPinnedBottomRow(e){ee(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(e)}getPinnedBottomTotalHeight(){return this.getTotalHeight(this.pinnedBottomRows)}getTotalHeight(e){if(!e||0===e.length)return 0;const t=f(e);return t.rowTop+t.rowHeight}};var jc;Bc([s("beans")],Vc.prototype,"beans",void 0),Bc([r],Vc.prototype,"init",null),Vc=Bc([o("pinnedRowModel")],Vc),function(e){e.Applied="Applied",e.StoreNotFound="StoreNotFound",e.StoreLoading="StoreLoading",e.StoreWaitingToLoad="StoreWaitingToLoad",e.StoreLoadingFailed="StoreLoadingFailed",e.StoreWrongType="StoreWrongType",e.Cancelled="Cancelled"}(jc||(jc={}));class zc{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}setInactive(){this.active=!1}isActive(){return this.active}depthFirstSearchChangedPath(t,i){if(t.children)for(let e=0;e<t.children.length;e++)this.depthFirstSearchChangedPath(t.children[e],i);i(t.rowNode)}depthFirstSearchEverything(i,n,r){if(i.childrenAfterGroup)for(let t=0;t<i.childrenAfterGroup.length;t++){const e=i.childrenAfterGroup[t];e.childrenAfterGroup?this.depthFirstSearchEverything(i.childrenAfterGroup[t],n,r):r&&n(e)}n(i)}forEachChangedNodeDepthFirst(e,t=!1,i=!1){this.active&&!i?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,i=0;for(;!this.mapToItems[t.id];){const e={rowNode:t,children:null};this.mapToItems[t.id]=e,i++,t=t.parent}return i}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let i=e;for(;i;)this.nodeIdsToColumns[i.id]||(this.nodeIdsToColumns[i.id]={}),t.forEach(e=>this.nodeIdsToColumns[i.id][e.getId()]=!0),i=i.parent}linkPathItems(t,i){let n=t;for(let e=0;e<i;e++){const t=this.mapToItems[n.id],i=this.mapToItems[n.parent.id];i.children||(i.children=[]),i.children.push(t),n=n.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const i=this.createPathItems(e);this.linkPathItems(e,i),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const i=this.nodeIdsToColumns[e.id];return t.filter(e=>i[e.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const i=this.nodeIdsToColumns[e.id];return t.filter(e=>!i[e.getId()])}}class Wc extends p{constructor(e){super(),this.state=Wc.STATE_WAITING_TO_LOAD,this.version=0,this.id=e}getId(){return this.id}load(){this.state=Wc.STATE_LOADING,this.loadFromDatasource()}getVersion(){return this.version}setStateWaitingToLoad(){this.version++,this.state=Wc.STATE_WAITING_TO_LOAD}getState(){return this.state}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state=Wc.STATE_FAILED,this.processServerFail()),this.dispatchLoadCompleted(!1)}success(e,t){this.successCommon(e,t)}pageLoaded(e,t,i){this.successCommon(e,{rowData:t,rowCount:i})}isRequestMostRecentAndLive(e){const t=e===this.version,i=this.isAlive();return t&&i}successCommon(e,t){this.dispatchLoadCompleted();this.isRequestMostRecentAndLive(e)&&(this.state=Wc.STATE_LOADED,this.processServerResult(t))}dispatchLoadCompleted(e=!0){const t={type:Wc.EVENT_LOAD_COMPLETE,success:e,block:this};this.dispatchEvent(t)}}Wc.EVENT_LOAD_COMPLETE="loadComplete",Wc.STATE_WAITING_TO_LOAD="needsLoading",Wc.STATE_LOADING="loading",Wc.STATE_LOADED="loaded",Wc.STATE_FAILED="failed";var Uc,Yc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},qc=function(i,n){return function(e,t){n(e,t,i)}};let Kc=Uc=class extends p{constructor(){super(...arguments),this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();const e=this.gridOptionsService.getNum("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=Er.debounce(this.performCheckBlocksToLoad.bind(this),e))}setBeans(e){this.logger=e.create("RowNodeBlockLoader")}getMaxConcurrentDatasourceRequests(){const e=this.gridOptionsService.getNum("maxConcurrentDatasourceRequests");return null==e?2:e<=0?void 0:e}addBlock(e){this.blocks.push(e),e.addEventListener(Wc.EVENT_LOAD_COMPLETE,this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){Er.removeFromArray(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchEvent({type:Uc.BLOCK_LOADED_EVENT}),0==this.activeBlockLoadsCount&&this.dispatchEvent({type:Uc.BLOCK_LOADER_FINISHED_EVENT})}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),null!=this.maxConcurrentRequests&&this.activeBlockLoadsCount>=this.maxConcurrentRequests)return void this.logger.log("checkBlockToLoad: max loads exceeded");const e=this.getAvailableLoadingCount(),t=this.blocks.filter(e=>e.getState()===Wc.STATE_WAITING_TO_LOAD).slice(0,e);this.registerLoads(t.length),t.forEach(e=>e.load()),this.printCacheStatus()}getBlockState(){if(this.gridOptionsService.isRowModelType("serverSide")){return this.rowModel.getBlockStates()}const n={};return this.blocks.forEach(e=>{const{id:t,state:i}=e.getBlockStateJson();n[t]=i}),n}printCacheStatus(){this.logger.isLogging()&&this.logger.log(`printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = `+JSON.stringify(this.getBlockState()))}isLoading(){return this.activeBlockLoadsCount>0}registerLoads(e){this.activeBlockLoadsCount+=e}getAvailableLoadingCount(){return void 0!==this.maxConcurrentRequests?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0}};Kc.BLOCK_LOADED_EVENT="blockLoaded",Kc.BLOCK_LOADER_FINISHED_EVENT="blockLoaderFinished",Yc([s("rowModel")],Kc.prototype,"rowModel",void 0),Yc([r],Kc.prototype,"postConstruct",null),Yc([qc(0,ze("loggerFactory"))],Kc.prototype,"setBeans",null),Kc=Uc=Yc([o("rowNodeBlockLoader")],Kc);var Xc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Zc=class extends p{constructor(){super(...arguments),this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.pixelOffset=0,this.masterRowCount=0}postConstruct(){this.active=this.gridOptionsService.is("pagination"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedListener(this.eventService,y.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedPropertyListener("pagination",this.onPaginationPageSizeChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPaginationPageSizeChanged.bind(this)),this.onModelUpdated()}ensureRowHeightsValid(e,t,i,n){const r=this.rowModel.ensureRowHeightsValid(e,t,this.getPageFirstRow(),this.getPageLastRow());return r&&this.calculatePages(),r}isPaginateChildRows(){return!(!this.gridOptionsService.is("groupRemoveSingleChildren")&&!this.gridOptionsService.is("groupRemoveLowestSingleChildren"))||this.gridOptionsService.is("paginateChildRows")}onModelUpdated(e){this.calculatePages();const t={type:y.EVENT_PAGINATION_CHANGED,animate:!!e&&e.animate,newData:!!e&&e.newData,newPage:!!e&&e.newPage,keepRenderedRows:!!e&&e.keepRenderedRows};this.eventService.dispatchEvent(t)}onPaginationPageSizeChanged(){this.active=this.gridOptionsService.is("pagination"),this.calculatePages();const e={type:y.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,keepRenderedRows:!0};this.eventService.dispatchEvent(e)}goToPage(e){if(!this.active||this.currentPage===e||"number"!=typeof this.currentPage)return;this.currentPage=e;const t={type:y.EVENT_MODEL_UPDATED,animate:!1,keepRenderedRows:!1,newData:!1,newPage:!0};this.onModelUpdated(t)}getPixelOffset(){return this.pixelOffset}getRow(e){return this.rowModel.getRow(e)}getRowNode(e){return this.rowModel.getRowNode(e)}getRowIndexAtPixel(e){return this.rowModel.getRowIndexAtPixel(e)}getCurrentPageHeight(){return u(this.topRowBounds)||u(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)}getCurrentPagePixelRange(){return{pageFirstPixel:this.topRowBounds?this.topRowBounds.rowTop:0,pageLastPixel:this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0}}isRowPresent(e){if(!this.rowModel.isRowPresent(e))return!1;return e.rowIndex>=this.topDisplayedRowIndex&&e.rowIndex<=this.bottomDisplayedRowIndex}isEmpty(){return this.rowModel.isEmpty()}isRowsToRender(){return this.rowModel.isRowsToRender()}forEachNode(e){return this.rowModel.forEachNode(e)}forEachNodeOnPage(t){const i=this.getPageFirstRow(),n=this.getPageLastRow();for(let e=i;e<=n;e++){const i=this.getRow(e);i&&t(i)}}getType(){return this.rowModel.getType()}getRowBounds(e){const t=this.rowModel.getRowBounds(e);return t.rowIndex=e,t}getPageFirstRow(){return this.topRowBounds?this.topRowBounds.rowIndex:-1}getPageLastRow(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1}getRowCount(){return this.rowModel.getRowCount()}getPageForIndex(e){return Math.floor(e/this.pageSize)}goToPageWithIndex(e){if(!this.active)return;const t=this.getPageForIndex(e);this.goToPage(t)}isRowInPage(e){if(!this.active)return!0;return this.getPageForIndex(e.rowIndex)===this.currentPage}isLastPageFound(){return this.rowModel.isLastRowIndexKnown()}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPageSize(){this.pageSize=this.gridOptionsService.getNum("paginationPageSize"),(null==this.pageSize||this.pageSize<1)&&(this.pageSize=100)}calculatePages(){this.active?(this.setPageSize(),this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly()):this.calculatedPagesNotActive(),this.topRowBounds=this.rowModel.getRowBounds(this.topDisplayedRowIndex),this.topRowBounds&&(this.topRowBounds.rowIndex=this.topDisplayedRowIndex),this.bottomRowBounds=this.rowModel.getRowBounds(this.bottomDisplayedRowIndex),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=this.bottomDisplayedRowIndex),this.setPixelOffset(C(this.topRowBounds)?this.topRowBounds.rowTop:0)}setPixelOffset(e){this.pixelOffset!==e&&(this.pixelOffset=e,this.eventService.dispatchEvent({type:y.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0)return void this.setZeroRows();const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid();const t=this.pageSize*this.currentPage;let i=this.pageSize*(this.currentPage+1)-1;if(i>e&&(i=e),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(t),i===e)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{const e=this.rowModel.getTopLevelRowDisplayedIndex(i+1);this.bottomDisplayedRowIndex=e-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){if(this.masterRowCount=this.rowModel.getRowCount(),0===this.masterRowCount)return void this.setZeroRows();const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>e&&(this.bottomDisplayedRowIndex=e)}calculatedPagesNotActive(){this.pageSize=this.rowModel.getRowCount(),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1}};Xc([s("rowModel")],Zc.prototype,"rowModel",void 0),Xc([r],Zc.prototype,"postConstruct",null),Zc=Xc([o("paginationProxy")],Zc);var Qc=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Jc=class extends p{processAllCellClasses(e,t,i,n){this.processClassRules(e.cellClassRules,t,i,n),this.processStaticCellClasses(e,t,i)}processClassRules(n,r,e,o){if(null==n)return;const s=Object.keys(n),a={},l={};for(let i=0;i<s.length;i++){const o=s[i],e=n[o];let t;"string"==typeof e?t=this.expressionService.evaluate(e,r):"function"==typeof e&&(t=e(r)),o.split(" ").forEach(e=>{null!=e&&""!=e.trim()&&(t?a[e]=!0:l[e]=!0)})}o&&Object.keys(l).forEach(o),Object.keys(a).forEach(e)}getStaticCellClasses(e,t){const{cellClass:i}=e;if(!i)return[];let n;if("function"==typeof i){n=i(t)}else n=i;return"string"==typeof n&&(n=[n]),n||[]}processStaticCellClasses(e,t,i){this.getStaticCellClasses(e,t).forEach(e=>{i(e)})}};Qc([s("expressionService")],Jc.prototype,"expressionService",void 0),Jc=Qc([o("stylingService")],Jc);class eu extends ao{constructor(e){super(e,"ag-toggle-button")}setValue(e,t){return super.setValue(e,t),this.addOrRemoveCssClass("ag-selected",this.getValue()),this}}class tu extends so{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){const i=super.setValue(e,t);return this.eInput.value=e,i}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}}class iu extends bo{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct(),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this));const e=Zi();this.addManagedListener(this.eInput,"mousedown",()=>{this.isDisabled()||e||this.eInput.focus()}),this.eInput.step="any"}onWheel(e){document.activeElement===this.eInput&&e.preventDefault()}setMin(e){var t;const i=e instanceof Date?null!==(t=wn(null!=e?e:null,!1))&&void 0!==t?t:void 0:e;return this.min===i||(this.min=i,hr(this.eInput,"min",i)),this}setMax(e){var t;const i=e instanceof Date?null!==(t=wn(null!=e?e:null,!1))&&void 0!==t?t:void 0:e;return this.max===i||(this.max=i,hr(this.eInput,"max",i)),this}setStep(e){return this.step===e||(this.step=e,hr(this.eInput,"step",e)),this}getDate(){var e;if(this.eInput.validity.valid)return null!==(e=Sn(this.getValue()))&&void 0!==e?e:void 0}setDate(e,t){this.setValue(wn(null!=e?e:null,!1),t)}}class nu extends so{constructor(e){super(e,"ag-range-field","range")}postConstruct(){super.postConstruct();const{min:e,max:t,step:i}=this.config;null!=e&&this.setMinValue(e),null!=t&&this.setMaxValue(t),this.setStep(i||1)}addInputListeners(){this.addManagedListener(this.eInput,"input",e=>{const t=e.target.value;this.setValue(t)})}setMinValue(e){return this.min=e,this.eInput.setAttribute("min",e.toString()),this}setMaxValue(e){return this.max=e,this.eInput.setAttribute("max",e.toString()),this}setStep(e){return this.eInput.setAttribute("step",e.toString()),this}setValue(e,t){null!=this.min&&(e=Math.max(parseFloat(e),this.min).toString()),null!=this.max&&(e=Math.min(parseFloat(e),this.max).toString());const i=super.setValue(e,t);return this.eInput.value=e,i}}var ru=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class ou extends Zr{constructor(e){super(e,ou.TEMPLATE),this.labelAlignment="top"}init(){this.eSlider.addCssClass("ag-slider-field")}onValueChange(t){const e=Qr.EVENT_CHANGED;return this.addManagedListener(this.eText,e,()=>{const e=parseFloat(this.eText.getValue());this.eSlider.setValue(e.toString(),!0),t(e||0)}),this.addManagedListener(this.eSlider,e,()=>{const e=this.eSlider.getValue();this.eText.setValue(e,!0),t(parseFloat(e))}),this}setSliderWidth(e){return this.eSlider.setWidth(e),this}setTextFieldWidth(e){return this.eText.setWidth(e),this}setMinValue(e){return this.eSlider.setMinValue(e),this.eText.setMin(e),this}setMaxValue(e){return this.eSlider.setMaxValue(e),this.eText.setMax(e),this}getValue(){return this.eText.getValue()}setValue(e){return this.getValue()===e||(this.eText.setValue(e,!0),this.eSlider.setValue(e,!0),this.dispatchEvent({type:Qr.EVENT_CHANGED})),this}setStep(e){return this.eSlider.setStep(e),this.eText.setStep(e),this}}ou.TEMPLATE='<div class="ag-slider">\n            <label ref="eLabel"></label>\n            <div class="ag-wrapper ag-slider-wrapper">\n                <ag-input-range ref="eSlider"></ag-input-range>\n                <ag-input-number-field ref="eText"></ag-input-number-field>\n            </div>\n        </div>',ru([A("eLabel")],ou.prototype,"eLabel",void 0),ru([A("eSlider")],ou.prototype,"eSlider",void 0),ru([A("eText")],ou.prototype,"eText",void 0),ru([r],ou.prototype,"init",null);var su=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class au extends S{constructor(e={}){super(au.getTemplate(e)),this.suppressEnabledCheckbox=!0,this.suppressOpenCloseIcons=!1;const{title:t,enabled:i,items:n,suppressEnabledCheckbox:r,suppressOpenCloseIcons:o}=e;this.title=t,this.cssIdentifier=e.cssIdentifier||"default",this.enabled=null==i||i,this.items=n||[],this.alignItems=e.alignItems||"center",null!=r&&(this.suppressEnabledCheckbox=r),null!=o&&(this.suppressOpenCloseIcons=o)}static getTemplate(e){const t=e.cssIdentifier||"default";return`<div class="ag-group ag-${t}-group" role="presentation">\n            <div class="ag-group-title-bar ag-${t}-group-title-bar ag-unselectable" ref="eTitleBar" role="button">\n                <span class="ag-group-title-bar-icon ag-${t}-group-title-bar-icon" ref="eGroupOpenedIcon" role="presentation"></span>\n                <span class="ag-group-title-bar-icon ag-${t}-group-title-bar-icon" ref="eGroupClosedIcon" role="presentation"></span>\n                <span ref="eTitle" class="ag-group-title ag-${t}-group-title"></span>\n            </div>\n            <div ref="eToolbar" class="ag-group-toolbar ag-${t}-group-toolbar">\n                <ag-checkbox ref="cbGroupEnabled"></ag-checkbox>\n            </div>\n            <div ref="eContainer" class="ag-group-container ag-group-container-${e.direction||"vertical"} ag-${t}-group-container"></div>\n        </div>`}postConstruct(){if(this.items.length){const e=this.items;this.items=[],this.addItems(e)}const e=this.localeService.getLocaleTextFunc();this.cbGroupEnabled.setLabel(e("enabled","Enabled")),this.title&&this.setTitle(this.title),this.enabled&&this.setEnabled(this.enabled),this.setAlignItems(this.alignItems),this.hideEnabledCheckbox(this.suppressEnabledCheckbox),this.hideOpenCloseIcons(this.suppressOpenCloseIcons),this.setupExpandContract(),this.refreshAriaStatus(),this.refreshChildDisplay()}setupExpandContract(){this.eGroupClosedIcon.appendChild(gr("columnSelectClosed",this.gridOptionsService,null)),this.eGroupOpenedIcon.appendChild(gr("columnSelectOpen",this.gridOptionsService,null)),this.addManagedListener(this.eTitleBar,"click",()=>this.toggleGroupExpand()),this.addManagedListener(this.eTitleBar,"keydown",e=>{switch(e.key){case x.ENTER:case x.SPACE:e.preventDefault(),this.toggleGroupExpand();break;case x.RIGHT:case x.LEFT:e.preventDefault(),this.toggleGroupExpand(e.key===x.RIGHT)}})}refreshAriaStatus(){this.suppressOpenCloseIcons||Li(this.eTitleBar,this.expanded)}refreshChildDisplay(){const e=!this.suppressOpenCloseIcons;w(this.eToolbar,this.expanded&&!this.suppressEnabledCheckbox),w(this.eGroupOpenedIcon,e&&this.expanded),w(this.eGroupClosedIcon,e&&!this.expanded)}isExpanded(){return this.expanded}setAlignItems(e){this.alignItems!==e&&this.removeCssClass("ag-group-item-alignment-"+this.alignItems),this.alignItems=e;const t="ag-group-item-alignment-"+this.alignItems;return this.addCssClass(t),this}toggleGroupExpand(e){return this.suppressOpenCloseIcons?(this.expanded=!0,this.refreshChildDisplay(),w(this.eContainer,!0),this):(e=null!=e?e:!this.expanded,this.expanded===e||(this.expanded=e,this.refreshAriaStatus(),this.refreshChildDisplay(),w(this.eContainer,e),this.dispatchEvent({type:this.expanded?au.EVENT_EXPANDED:au.EVENT_COLLAPSED})),this)}addItems(e){e.forEach(e=>this.addItem(e))}addItem(e){const t=this.eContainer,i=e instanceof S?e.getGui():e;i.classList.add("ag-group-item",`ag-${this.cssIdentifier}-group-item`),t.appendChild(i),this.items.push(i)}hideItem(e,t){w(this.items[t],!e)}setTitle(e){return this.eTitle.innerText=e,this}addCssClassToTitleBar(e){this.eTitleBar.classList.add(e)}setEnabled(e,t){return this.enabled=e,this.refreshDisabledStyles(),this.toggleGroupExpand(e),t||this.cbGroupEnabled.setValue(e),this}isEnabled(){return this.enabled}onEnableChange(t){return this.cbGroupEnabled.onValueChange(e=>{this.setEnabled(e,!0),t(e)}),this}hideEnabledCheckbox(e){return this.suppressEnabledCheckbox=e,this.refreshChildDisplay(),this.refreshDisabledStyles(),this}hideOpenCloseIcons(e){return this.suppressOpenCloseIcons=e,e&&this.toggleGroupExpand(!0),this}refreshDisabledStyles(){this.addOrRemoveCssClass("ag-disabled",!this.enabled),this.suppressEnabledCheckbox&&!this.enabled?(this.eTitleBar.classList.add("ag-disabled-group-title-bar"),this.eTitleBar.removeAttribute("tabindex")):(this.eTitleBar.classList.remove("ag-disabled-group-title-bar"),this.eTitleBar.setAttribute("tabindex","0")),this.eContainer.classList.toggle("ag-disabled-group-container",!this.enabled)}}au.EVENT_EXPANDED="expanded",au.EVENT_COLLAPSED="collapsed",su([A("eTitleBar")],au.prototype,"eTitleBar",void 0),su([A("eGroupOpenedIcon")],au.prototype,"eGroupOpenedIcon",void 0),su([A("eGroupClosedIcon")],au.prototype,"eGroupClosedIcon",void 0),su([A("eToolbar")],au.prototype,"eToolbar",void 0),su([A("cbGroupEnabled")],au.prototype,"cbGroupEnabled",void 0),su([A("eTitle")],au.prototype,"eTitle",void 0),su([A("eContainer")],au.prototype,"eContainer",void 0),su([r],au.prototype,"postConstruct",null);class lu extends S{initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.getFocusableElement();const i=[this.eTopGuard,this.eBottomGuard],t={setTabIndex:t=>{i.forEach(e=>null!=t?e.setAttribute("tabindex",t):e.removeAttribute("tabindex"))}};this.addTabGuards(this.eTopGuard,this.eBottomGuard),this.tabGuardCtrl=this.createManagedBean(new Kl({comp:t,eTopGuard:this.eTopGuard,eBottomGuard:this.eBottomGuard,eFocusableElement:this.eFocusableElement,onFocusIn:e.onFocusIn,onFocusOut:e.onFocusOut,focusInnerElement:e.focusInnerElement,handleKeyDown:e.handleKeyDown,onTabKeyDown:e.onTabKeyDown,shouldStopEventPropagation:e.shouldStopEventPropagation}))}createTabGuard(e){const t=document.createElement("div"),i="top"===e?Yl.TAB_GUARD_TOP:Yl.TAB_GUARD_BOTTOM;return t.classList.add(Yl.TAB_GUARD,i),Ci(t,"presentation"),t}addTabGuards(e,t){this.eFocusableElement.insertAdjacentElement("afterbegin",e),this.eFocusableElement.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){const e=[this.eTopGuard,this.eBottomGuard];Vn(this.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(e=!1){this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t){cr(e)||(e=e.getGui());const{eBottomGuard:i}=this;i?i.insertAdjacentElement("beforebegin",e):super.appendChild(e,t)}}var cu=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class uu extends lu{constructor(e=1){super('<div class="ag-menu-list" role="tree"></div>'),this.level=e,this.menuItems=[]}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)})}onTabKeyDown(e){const t=this.getParentComponent(),i=t&&t.getGui();i&&i.classList.contains("ag-focus-managed")||e.preventDefault(),e.shiftKey&&this.closeIfIsChild(e)}handleKeyDown(t){switch(t.key){case x.UP:case x.RIGHT:case x.DOWN:case x.LEFT:t.preventDefault(),this.handleNavKey(t.key);break;case x.ESCAPE:const e=this.findTopMenu();e&&this.focusService.focusInto(e.getGui())}}clearActiveItem(){this.activeMenuItem&&(this.activeMenuItem.deactivate(),this.activeMenuItem=null)}addMenuItems(e){null!=e&&e.forEach(e=>{"separator"===e?this.addSeparator():"string"==typeof e?console.warn("AG Grid: unrecognised menu item "+e):this.addItem(e)})}addItem(e){const t=this.createManagedBean(new pu(Object.assign(Object.assign({},e),{isAnotherSubMenuOpen:()=>this.menuItems.some(e=>e.isSubMenuOpen())})));t.setParentComponent(this),Oi(t.getGui(),this.level),this.menuItems.push(t),this.appendChild(t.getGui()),this.addManagedListener(t,pu.EVENT_MENU_ITEM_SELECTED,e=>{this.dispatchEvent(e)}),this.addManagedListener(t,pu.EVENT_MENU_ITEM_ACTIVATED,e=>{this.activeMenuItem&&this.activeMenuItem!==e.menuItem&&this.activeMenuItem.deactivate(),this.activeMenuItem=e.menuItem})}activateFirstItem(){const e=this.menuItems.filter(e=>!e.isDisabled())[0];e&&e.activate()}addSeparator(){this.appendChild(Un('\n            <div class="ag-menu-separator" aria-hidden="true">\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n            </div>'))}findTopMenu(){let t=this.getParentComponent();if(!t&&this instanceof uu)return this;for(;;){const e=t&&t.getParentComponent&&t.getParentComponent();if(!e||!(e instanceof uu||e instanceof pu))break;t=e}return t instanceof uu?t:void 0}handleNavKey(t){switch(t){case x.UP:case x.DOWN:const e=this.findNextItem(t===x.UP);return void(e&&e!==this.activeMenuItem&&e.activate())}t===(this.gridOptionsService.is("enableRtl")?x.RIGHT:x.LEFT)?this.closeIfIsChild():this.openChild()}closeIfIsChild(e){const t=this.getParentComponent();t&&t instanceof pu&&(e&&e.preventDefault(),t.closeSubMenu(),t.getGui().focus())}openChild(){this.activeMenuItem&&this.activeMenuItem.openSubMenu(!0)}findNextItem(e){const i=this.menuItems.filter(e=>!e.isDisabled());if(!i.length)return;if(!this.activeMenuItem)return e?f(i):i[0];let n;e&&i.reverse();let r=!1;for(let t=0;t<i.length;t++){const e=i[t];if(r){n=e;break}e===this.activeMenuItem&&(r=!0)}return n||this.activeMenuItem}destroy(){this.clearActiveItem(),super.destroy()}}cu([s("focusService")],uu.prototype,"focusService",void 0),cu([r],uu.prototype,"postConstruct",null);var du=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class hu extends lu{constructor(e){super(),this.wrappedComponent=e,this.setTemplateFromElement(e.getGui())}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)})}handleKeyDown(e){e.key===x.ESCAPE&&this.closePanel()}onTabKeyDown(e){e.defaultPrevented||(this.closePanel(),e.preventDefault())}closePanel(){const e=this.parentComponent;e.closeSubMenu(),setTimeout(()=>e.getGui().focus(),0)}}du([r],hu.prototype,"postConstruct",null);var fu=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class pu extends S{constructor(e){super(),this.params=e,this.isActive=!1,this.subMenuIsOpen=!1,this.setTemplate(`<div class="${this.getClassName()}" tabindex="-1" role="treeitem"></div>`)}init(){this.addIcon(),this.addName(),this.addShortcut(),this.addSubMenu(),this.addTooltip();const e=this.getGui();this.params.disabled?(this.addCssClass(this.getClassName("disabled")),Ni(e,!0)):(this.addGuiEventListener("click",e=>this.onItemSelected(e)),this.addGuiEventListener("keydown",e=>{e.key!==x.ENTER&&e.key!==x.SPACE||(e.preventDefault(),this.onItemSelected(e))}),this.addGuiEventListener("mousedown",e=>{e.stopPropagation(),e.preventDefault()}),this.addGuiEventListener("mouseenter",()=>this.onMouseEnter()),this.addGuiEventListener("mouseleave",()=>this.onMouseLeave())),this.params.cssClasses&&this.params.cssClasses.forEach(e=>this.addCssClass(e))}isDisabled(){return!!this.params.disabled}openSubMenu(e=!1){if(this.closeSubMenu(),!this.params.subMenu)return;const t=Un('<div class="ag-menu" role="presentation"></div>');let i;if(this.params.subMenu instanceof Array){const n=Si(this.getGui()),r=isNaN(n)?1:n+1,o=this.createBean(new uu(r));o.setParentComponent(this),o.addMenuItems(this.params.subMenu),t.appendChild(o.getGui()),this.addManagedListener(o,pu.EVENT_MENU_ITEM_SELECTED,e=>this.dispatchEvent(e)),o.addGuiEventListener("mouseenter",()=>this.cancelDeactivate()),i=()=>this.destroyBean(o),e&&setTimeout(()=>o.activateFirstItem(),0)}else{const{subMenu:e}=this.params,n=this.createBean(new hu(e));n.setParentComponent(this);const r=n.getGui(),o="mouseenter",s=()=>this.cancelDeactivate();r.addEventListener(o,s),i=()=>r.removeEventListener(o,s),t.appendChild(r),e.afterGuiAttached&&setTimeout(()=>e.afterGuiAttached(),0)}const n=this.getGui(),r=this.popupService.positionPopupForMenu.bind(this.popupService,{eventSource:n,ePopup:t}),o=this.localeService.getLocaleTextFunc(),s=this.popupService.addPopup({modal:!0,eChild:t,positionCallback:r,anchorToElement:n,ariaLabel:o("ariaLabelSubMenu","SubMenu")});this.subMenuIsOpen=!0,Li(n,!0),this.hideSubMenu=()=>{s&&s.hideFunc(),this.subMenuIsOpen=!1,Li(n,!1),i()}}closeSubMenu(){this.hideSubMenu&&(this.hideSubMenu(),this.hideSubMenu=null,Li(this.getGui(),!1))}isSubMenuOpen(){return this.subMenuIsOpen}activate(e){this.cancelActivate(),this.params.disabled||(this.isActive=!0,this.addCssClass(this.getClassName("active")),this.getGui().focus(),e&&this.params.subMenu&&window.setTimeout(()=>{this.isAlive()&&this.isActive&&this.openSubMenu()},300),this.onItemActivated())}deactivate(){this.cancelDeactivate(),this.removeCssClass(this.getClassName("active")),this.isActive=!1,this.subMenuIsOpen&&this.hideSubMenu()}addIcon(){if(!this.params.checked&&!this.params.icon&&this.params.isCompact)return;const e=Un(`<span ref="eIcon" class="${this.getClassName("part")} ${this.getClassName("icon")}" role="presentation"></span>`);this.params.checked?e.appendChild(mr("check",this.gridOptionsService)):this.params.icon&&(cr(this.params.icon)?e.appendChild(this.params.icon):"string"==typeof this.params.icon?e.innerHTML=this.params.icon:console.warn("AG Grid: menu item icon must be DOM node or string")),this.getGui().appendChild(e)}addName(){if(!this.params.name&&this.params.isCompact)return;const e=Un(`<span ref="eName" class="${this.getClassName("part")} ${this.getClassName("text")}">${this.params.name||""}</span>`);this.getGui().appendChild(e)}addTooltip(){this.params.tooltip&&(this.tooltip=this.params.tooltip,this.gridOptionsService.is("enableBrowserTooltips")?this.getGui().setAttribute("title",this.tooltip):this.createManagedBean(new Nr(this)))}getTooltipParams(){return{location:"menu",value:this.tooltip}}addShortcut(){if(!this.params.shortcut&&this.params.isCompact)return;const e=Un(`<span ref="eShortcut" class="${this.getClassName("part")} ${this.getClassName("shortcut")}">${this.params.shortcut||""}</span>`);this.getGui().appendChild(e)}addSubMenu(){if(!this.params.subMenu&&this.params.isCompact)return;const t=Un(`<span ref="ePopupPointer" class="${this.getClassName("part")} ${this.getClassName("popup-pointer")}"></span>`),i=this.getGui();if(this.params.subMenu){const e=this.gridOptionsService.is("enableRtl")?"smallLeft":"smallRight";Li(i,!1),t.appendChild(mr(e,this.gridOptionsService))}i.appendChild(t)}onItemSelected(e){if(this.params.action?this.params.action():this.openSubMenu(e&&"keydown"===e.type),this.params.subMenu&&!this.params.action)return;const t={type:pu.EVENT_MENU_ITEM_SELECTED,action:this.params.action,checked:this.params.checked,cssClasses:this.params.cssClasses,disabled:this.params.disabled,icon:this.params.icon,name:this.params.name,shortcut:this.params.shortcut,subMenu:this.params.subMenu,tooltip:this.params.tooltip,event:e};this.dispatchEvent(t)}onItemActivated(){const e={type:pu.EVENT_MENU_ITEM_ACTIVATED,menuItem:this};this.dispatchEvent(e)}cancelActivate(){this.activateTimeoutId&&(window.clearTimeout(this.activateTimeoutId),this.activateTimeoutId=0)}cancelDeactivate(){this.deactivateTimeoutId&&(window.clearTimeout(this.deactivateTimeoutId),this.deactivateTimeoutId=0)}onMouseEnter(){this.cancelDeactivate(),this.params.isAnotherSubMenuOpen()?this.activateTimeoutId=window.setTimeout(()=>this.activate(!0),pu.ACTIVATION_DELAY):this.activate(!0)}onMouseLeave(){this.cancelActivate(),this.isSubMenuOpen()?this.deactivateTimeoutId=window.setTimeout(()=>this.deactivate(),pu.ACTIVATION_DELAY):this.deactivate()}getClassName(e){const t=this.params.isCompact?"ag-compact-menu-option":"ag-menu-option";return e?`${t}-${e}`:t}}pu.EVENT_MENU_ITEM_SELECTED="menuItemSelected",pu.EVENT_MENU_ITEM_ACTIVATED="menuItemActivated",pu.ACTIVATION_DELAY=80,fu([s("popupService")],pu.prototype,"popupService",void 0),fu([r],pu.prototype,"init",null);var gu=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class mu extends S{constructor(e){super(mu.getTemplate(e)),this.closable=!0,this.config=e}static getTemplate(e){const t=e&&e.cssIdentifier||"default";return`<div class="ag-panel ag-${t}-panel" tabindex="-1">\n            <div ref="eTitleBar" class="ag-panel-title-bar ag-${t}-panel-title-bar ag-unselectable">\n                <span ref="eTitle" class="ag-panel-title-bar-title ag-${t}-panel-title-bar-title"></span>\n                <div ref="eTitleBarButtons" class="ag-panel-title-bar-buttons ag-${t}-panel-title-bar-buttons"></div>\n            </div>\n            <div ref="eContentWrapper" class="ag-panel-content-wrapper ag-${t}-panel-content-wrapper"></div>\n        </div>`}postConstruct(){const{component:e,closable:t,hideTitleBar:i,title:n,minWidth:r=250,width:o,minHeight:s=250,height:a,centered:l,popup:c,x:u,y:d}=this.config;this.positionableFeature=new Yr(this.getGui(),{minWidth:r,width:o,minHeight:s,height:a,centered:l,x:u,y:d,popup:c,calculateTopBuffer:()=>this.positionableFeature.getHeight()-this.getBodyHeight()}),this.createManagedBean(this.positionableFeature);const h=this.getGui();e&&this.setBodyComponent(e),i?w(this.eTitleBar,!1):(n&&this.setTitle(n),this.setClosable(null!=t?t:this.closable)),this.addManagedListener(this.eTitleBar,"mousedown",e=>{const t=this.gridOptionsService.getDocument();if(h.contains(e.relatedTarget)||h.contains(t.activeElement)||this.eTitleBarButtons.contains(e.target))return void e.preventDefault();const i=this.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");i&&i.focus()}),c&&this.positionableFeature.isPositioned()||(this.renderComponent&&this.renderComponent(),this.positionableFeature.initialisePosition(),this.eContentWrapper.style.height="0")}renderComponent(){const e=this.getGui();e.focus(),this.close=()=>{e.parentElement.removeChild(e),this.destroy()}}getHeight(){return this.positionableFeature.getHeight()}setHeight(e){this.positionableFeature.setHeight(e)}getWidth(){return this.positionableFeature.getWidth()}setWidth(e){this.positionableFeature.setWidth(e)}setClosable(i){if(i!==this.closable&&(this.closable=i),i){const i=this.closeButtonComp=new S(mu.CLOSE_BTN_TEMPLATE);this.getContext().createBean(i);const e=i.getGui(),t=mr("close",this.gridOptionsService);t.classList.add("ag-panel-title-bar-button-icon"),e.appendChild(t),this.addTitleBarButton(i),i.addManagedListener(e,"click",this.onBtClose.bind(this))}else if(this.closeButtonComp){const i=this.closeButtonComp.getGui();i.parentElement.removeChild(i),this.closeButtonComp=this.destroyBean(this.closeButtonComp)}}setBodyComponent(e){e.setParentComponent(this),this.eContentWrapper.appendChild(e.getGui())}addTitleBarButton(e,t){const i=this.eTitleBarButtons,n=i.children,r=n.length;null==t&&(t=r),t=Math.max(0,Math.min(t,r)),e.addCssClass("ag-panel-title-bar-button");const o=e.getGui();0===t?i.insertAdjacentElement("afterbegin",o):t===r?i.insertAdjacentElement("beforeend",o):n[t-1].insertAdjacentElement("afterend",o),e.setParentComponent(this)}getBodyHeight(){return In(this.eContentWrapper)}getBodyWidth(){return Ln(this.eContentWrapper)}setTitle(e){this.eTitle.innerText=e}onBtClose(){this.close()}destroy(){this.closeButtonComp&&(this.closeButtonComp=this.destroyBean(this.closeButtonComp));const e=this.getGui();e&&e.offsetParent&&this.close(),super.destroy()}}mu.CLOSE_BTN_TEMPLATE='<div class="ag-button"></div>',gu([A("eContentWrapper")],mu.prototype,"eContentWrapper",void 0),gu([A("eTitleBar")],mu.prototype,"eTitleBar",void 0),gu([A("eTitleBarButtons")],mu.prototype,"eTitleBarButtons",void 0),gu([A("eTitle")],mu.prototype,"eTitle",void 0),gu([r],mu.prototype,"postConstruct",null);var vu=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class yu extends mu{constructor(e){super(Object.assign(Object.assign({},e),{popup:!0})),this.isMaximizable=!1,this.isMaximized=!1,this.maximizeListeners=[],this.resizeListenerDestroy=null,this.lastPosition={x:0,y:0,width:0,height:0}}postConstruct(){const t=this.getGui(),{movable:e,resizable:i,maximizable:n}=this.config;this.addCssClass("ag-dialog"),super.postConstruct(),this.addManagedListener(t,"focusin",e=>{t.contains(e.relatedTarget)||this.popupService.bringPopupToFront(t)}),e&&this.setMovable(e),n&&this.setMaximizable(n),i&&this.setResizable(i)}renderComponent(){const e=this.getGui(),{alwaysOnTop:t,modal:i,title:n}=this.config,r=this.localeService.getLocaleTextFunc(),o=this.popupService.addPopup({modal:i,eChild:e,closeOnEsc:!0,closedCallback:this.destroy.bind(this),alwaysOnTop:t,ariaLabel:n||r("ariaLabelDialog","Dialog")});o&&(this.close=o.hideFunc)}toggleMaximize(){const n=this.positionableFeature.getPosition();if(this.isMaximized){const{x:n,y:e,width:t,height:i}=this.lastPosition;this.setWidth(t),this.setHeight(i),this.positionableFeature.offsetElement(n,e)}else this.lastPosition.width=this.getWidth(),this.lastPosition.height=this.getHeight(),this.lastPosition.x=n.x,this.lastPosition.y=n.y,this.positionableFeature.offsetElement(0,0),this.setHeight("100%"),this.setWidth("100%");this.isMaximized=!this.isMaximized,this.refreshMaximizeIcon()}refreshMaximizeIcon(){w(this.maximizeIcon,!this.isMaximized),w(this.minimizeIcon,this.isMaximized)}clearMaximizebleListeners(){this.maximizeListeners.length&&(this.maximizeListeners.forEach(e=>e()),this.maximizeListeners.length=0),this.resizeListenerDestroy&&(this.resizeListenerDestroy(),this.resizeListenerDestroy=null)}destroy(){this.maximizeButtonComp=this.destroyBean(this.maximizeButtonComp),this.clearMaximizebleListeners(),super.destroy()}setResizable(e){this.positionableFeature.setResizable(e)}setMovable(e){this.positionableFeature.setMovable(e,this.eTitleBar)}setMaximizable(e){if(!e)return this.clearMaximizebleListeners(),void(this.maximizeButtonComp&&(this.destroyBean(this.maximizeButtonComp),this.maximizeButtonComp=this.maximizeIcon=this.minimizeIcon=void 0));const t=this.eTitleBar;if(!t||e===this.isMaximizable)return;const i=this.buildMaximizeAndMinimizeElements();this.refreshMaximizeIcon(),i.addManagedListener(i.getGui(),"click",this.toggleMaximize.bind(this)),this.addTitleBarButton(i,0),this.maximizeListeners.push(this.addManagedListener(t,"dblclick",this.toggleMaximize.bind(this))),this.resizeListenerDestroy=this.addManagedListener(this,"resize",()=>{this.isMaximized=!1,this.refreshMaximizeIcon()})}buildMaximizeAndMinimizeElements(){const e=this.maximizeButtonComp=this.createBean(new S('<div class="ag-dialog-button"></span>')),t=e.getGui();return this.maximizeIcon=mr("maximize",this.gridOptionsService),t.appendChild(this.maximizeIcon),this.maximizeIcon.classList.add("ag-panel-title-bar-button-icon"),this.minimizeIcon=mr("minimize",this.gridOptionsService),t.appendChild(this.minimizeIcon),this.minimizeIcon.classList.add("ag-panel-title-bar-button-icon"),e}}vu([s("popupService")],yu.prototype,"popupService",void 0);var bu,_u,wu=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e[e.vertical=0]="vertical",e[e.horizontal=1]="horizontal"}(_u||(_u={}));let Cu=0,xu=bu=class extends p{constructor(){super(...arguments),this.popupList=[]}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridCtrl=e.gridCtrl,this.addManagedListener(this.gridCtrl,y.EVENT_KEYBOARD_FOCUS,()=>{this.popupList.forEach(e=>e.element.classList.add(Ql.AG_KEYBOARD_FOCUS))}),this.addManagedListener(this.gridCtrl,y.EVENT_MOUSE_FOCUS,()=>{this.popupList.forEach(e=>e.element.classList.remove(Ql.AG_KEYBOARD_FOCUS))})})}getPopupParent(){const e=this.gridOptionsService.get("popupParent");return e||this.gridCtrl.getGui()}positionPopupForMenu(e){const t=e.eventSource.getBoundingClientRect(),i=this.getParentRect(),n=this.keepXYWithinBounds(e.ePopup,t.top-i.top,_u.vertical),r=e.ePopup.clientWidth>0?e.ePopup.clientWidth:200;e.ePopup.style.minWidth=r+"px";const o=i.right-i.left-r;let s;function a(){return t.right-i.left-2}function l(){return t.left-i.left-r}this.gridOptionsService.is("enableRtl")?(s=l(),s<0&&(s=a()),s>o&&(s=0)):(s=a(),s>o&&(s=l()),s<0&&(s=0)),e.ePopup.style.left=s+"px",e.ePopup.style.top=n+"px"}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:i,nudgeY:n,skipObserver:r}=e;this.positionPopup({ePopup:t,nudgeX:i,nudgeY:n,keepWithinBounds:!0,skipObserver:r,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e.type,e.ePopup,null,e.mouseEvent,e.column,e.rowNode)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(t){const i=t.eventSource.getBoundingClientRect(),n=t.alignSide||"left",r=t.position||"over",o=this.getParentRect();this.positionPopup({ePopup:t.ePopup,nudgeX:t.nudgeX,nudgeY:t.nudgeY,keepWithinBounds:t.keepWithinBounds,updatePosition:()=>{let e=i.left-o.left;"right"===n&&(e-=t.ePopup.offsetWidth-i.width);return{x:e,y:"over"===r?i.top-o.top:i.top-o.top+i.height}},postProcessCallback:()=>this.callPostProcessPopup(t.type,t.ePopup,t.eventSource,null,t.column,t.rowNode)})}callPostProcessPopup(e,t,i,n,r,o){const s=this.gridOptionsService.getCallback("postProcessPopup");if(s){s({column:r,rowNode:o,ePopup:t,type:e,eventSource:i,mouseEvent:n})}}positionPopup(n){const{ePopup:r,keepWithinBounds:o,nudgeX:s,nudgeY:a,skipObserver:e,updatePosition:l}=n,c={width:0,height:0},t=(e=!1)=>{let{x:t,y:i}=l();e&&r.clientWidth===c.width&&r.clientHeight===c.height||(c.width=r.clientWidth,c.height=r.clientHeight,s&&(t+=s),a&&(i+=a),o&&(t=this.keepXYWithinBounds(r,t,_u.horizontal),i=this.keepXYWithinBounds(r,i,_u.vertical)),r.style.left=t+"px",r.style.top=i+"px",n.postProcessCallback&&n.postProcessCallback())};if(t(),!e){const n=this.resizeObserverService.observeResize(r,()=>t(!0));setTimeout(()=>n(),bu.WAIT_FOR_POPUP_CONTENT_RESIZE)}}getActivePopups(){return this.popupList.map(e=>e.element)}getPopupList(){return this.popupList}getParentRect(){const e=this.gridOptionsService.getDocument();let t=this.getPopupParent();return t===e.body?t=e.documentElement:"static"===getComputedStyle(t).position&&(t=t.offsetParent),Gn(t)}keepXYWithinBounds(e,t,i){const n=i===_u.vertical,r=n?"clientHeight":"clientWidth",o=n?"top":"left",s=n?"offsetHeight":"offsetWidth",a=n?"scrollTop":"scrollLeft",l=this.gridOptionsService.getDocument(),c=l.documentElement,u=this.getPopupParent(),d=u.getBoundingClientRect(),h=l.documentElement.getBoundingClientRect(),f=u===l.body,p=e[s];let g=f?(n?Pn:Fn)(c)+c[a]:u[r];f&&(g-=Math.abs(h[o]-d[o]));const m=g-p;return Math.min(Math.max(t,0),Math.abs(m))}addPopup(e){const t=this.gridOptionsService.getDocument(),{eChild:i,ariaLabel:n,alwaysOnTop:r,positionCallback:o,anchorToElement:s}=e;if(!t)return console.warn("AG Grid: could not find the document, document is empty"),{hideFunc:()=>{}};const a=this.popupList.findIndex(e=>e.element===i);if(-1!==a){return{hideFunc:this.popupList[a].hideFunc}}this.initialisePopupPosition(i);const l=this.createPopupWrapper(i,n,!!r),c=this.addEventListenersToPopup(Object.assign(Object.assign({},e),{wrapperEl:l}));return o&&o(),this.addPopupToPopupList(i,l,c,s),{hideFunc:c}}initialisePopupPosition(e){const t=this.getPopupParent().getBoundingClientRect();C(e.style.top)||(e.style.top=-1*t.top+"px"),C(e.style.left)||(e.style.left=-1*t.left+"px")}createPopupWrapper(e,t,i){const n=this.getPopupParent(),r=document.createElement("div"),{allThemes:o}=this.environment.getTheme();return o.length&&r.classList.add(...o),r.classList.add("ag-popup"),e.classList.add(this.gridOptionsService.is("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||Ci(e,"dialog"),Ti(e,t),this.focusService.isKeyboardMode()&&e.classList.add(Ql.AG_KEYBOARD_FOCUS),r.appendChild(e),n.appendChild(r),i?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),r}addEventListenersToPopup(e){const r=this.gridOptionsService.getDocument(),o=this.getPopupParent(),{wrapperEl:s,eChild:a,click:l,closedCallback:c,afterGuiAttached:t,closeOnEsc:i,modal:n}=e;let u=!1;const d=e=>{if(!s.contains(r.activeElement))return;e.key===x.ESCAPE&&p({keyboardEvent:e})},h=e=>p({mouseEvent:e}),f=e=>p({touchEvent:e}),p=(e={})=>{const{mouseEvent:t,touchEvent:i,keyboardEvent:n}=e;this.isEventFromCurrentPopup({mouseEvent:t,touchEvent:i},a)||this.isEventSameChainAsOriginalEvent({originalMouseEvent:l,mouseEvent:t,touchEvent:i})||u||(u=!0,o.removeChild(s),r.removeEventListener("keydown",d),r.removeEventListener("mousedown",h),r.removeEventListener("touchstart",f),r.removeEventListener("contextmenu",h),this.eventService.removeEventListener(y.EVENT_DRAG_STARTED,h),c&&c(t||i||n),this.removePopupFromPopupList(a))};return t&&t({hidePopup:p}),window.setTimeout(()=>{i&&r.addEventListener("keydown",d),n&&(r.addEventListener("mousedown",h),this.eventService.addEventListener(y.EVENT_DRAG_STARTED,h),r.addEventListener("touchstart",f),r.addEventListener("contextmenu",h))},0),p}addPopupToPopupList(e,t,i,n){this.popupList.push({element:e,wrapper:t,hideFunc:i,instanceId:Cu++,isAnchored:!!n}),n&&this.setPopupPositionRelatedToElement(e,n)}setPopupPositionRelatedToElement(t,e){const i=this.popupList.find(e=>e.element===t);if(!i)return;if(i.stopAnchoringPromise&&i.stopAnchoringPromise.then(e=>e&&e()),i.stopAnchoringPromise=void 0,i.isAnchored=!1,!e)return;const n=this.keepPopupPositionedRelativeTo({element:e,ePopup:t,hidePopup:i.hideFunc});return i.stopAnchoringPromise=n,i.isAnchored=!0,n}removePopupFromPopupList(t){this.setPopupPositionRelatedToElement(t,null),this.popupList=this.popupList.filter(e=>e.element!==t)}keepPopupPositionedRelativeTo(r){const o=this.getPopupParent(),e=o.getBoundingClientRect(),{element:s,ePopup:a}=r,t=s.getBoundingClientRect(),l=e.top-t.top,c=e.left-t.left;let u=l,d=c;const i=a.style.top,h=parseInt(i.substring(0,i.length-1),10),n=a.style.left,f=parseInt(n.substring(0,n.length-1),10);return new Rr(t=>{this.getFrameworkOverrides().setInterval(()=>{const e=o.getBoundingClientRect(),t=s.getBoundingClientRect();if(0==t.top&&0==t.left&&0==t.height&&0==t.width)return void r.hidePopup();const i=e.top-t.top;if(i!=u){const r=this.keepXYWithinBounds(a,h+l-i,_u.vertical);a.style.top=r+"px"}u=i;const n=e.left-t.left;if(n!=d){const r=this.keepXYWithinBounds(a,f+c-n,_u.horizontal);a.style.left=r+"px"}d=n},200).then(e=>{t(()=>{null!=e&&window.clearInterval(e)})})})}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isEventFromCurrentPopup(e,t){const{mouseEvent:i,touchEvent:n}=e,r=i||n;if(!r)return!1;const o=this.popupList.findIndex(e=>e.element===t);if(-1===o)return!1;for(let e=o;e<this.popupList.length;e++){if(Ct(this.popupList[e].element,r))return!0}return this.isElementWithinCustomPopup(r.target)}isElementWithinCustomPopup(e){const t=this.gridOptionsService.getDocument();for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||null===e.parentElement)return!0;e=e.parentElement}return!1}isEventSameChainAsOriginalEvent(t){const{originalMouseEvent:i,mouseEvent:n,touchEvent:r}=t;let o=null;if(n?o=n:r&&(o=r.touches[0]),o&&i){const t=n?n.screenX:0,r=n?n.screenY:0,o=Math.abs(i.screenX-t)<5,e=Math.abs(i.screenY-r)<5;if(o&&e)return!0}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const i=this.getWrapper(e);i&&(i.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(i))}bringPopupToFront(e){const t=this.getPopupParent(),i=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),n=i.length,r=Array.prototype.slice.call(t.querySelectorAll(".ag-popup.ag-always-on-top")),o=r.length,s=this.getWrapper(e);if(!s||n<=1||!t.contains(e))return;const a=i.indexOf(s),l=s.querySelectorAll("div"),c=[];if(l.forEach(e=>{0!==e.scrollTop&&c.push([e,e.scrollTop])}),o){s.classList.contains("ag-always-on-top")?a!==n-1&&f(r).insertAdjacentElement("afterend",s):a!==n-o-1&&r[0].insertAdjacentElement("beforebegin",s)}else a!==n-1&&f(i).insertAdjacentElement("afterend",s);for(;c.length;){const e=c.pop();e[0].scrollTop=e[1]}const u={type:"popupToFront",api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,eWrapper:s};this.eventService.dispatchEvent(u)}};xu.WAIT_FOR_POPUP_CONTENT_RESIZE=200,wu([s("focusService")],xu.prototype,"focusService",void 0),wu([s("ctrlsService")],xu.prototype,"ctrlsService",void 0),wu([s("resizeObserverService")],xu.prototype,"resizeObserverService",void 0),wu([r],xu.prototype,"postConstruct",null),xu=bu=wu([o("popupService")],xu);var Su=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Au extends lu{constructor(e="default",t="listbox",i){super(Au.getTemplate(e)),this.cssIdentifier=e,this.ariaRole=t,this.listName=i,this.renderedRows=new Map,this.rowHeight=20}postConstruct(){this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e),focusInnerElement:e=>this.focusInnerElement(e),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)}),this.setAriaProperties(),this.addManagedListener(this.eventService,y.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanged.bind(this))}onGridStylesChanged(){this.rowHeight=this.getItemHeight(),this.refresh()}setAriaProperties(){const e=this.localeService.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),t=this.eContainer;Ci(t,this.ariaRole),Ti(t,e)}addResizeObserver(){const e=this.resizeObserverService.observeResize(this.getGui(),()=>this.drawVirtualRows());this.addDestroyFunc(e)}focusInnerElement(e){this.focusRow(e?this.model.getRowCount()-1:0)}onFocusIn(e){const t=e.target;return t.classList.contains("ag-virtual-list-item")&&(this.lastFocusedRowIndex=Ai(t)-1),!1}onFocusOut(e){return this.getFocusableElement().contains(e.relatedTarget)||(this.lastFocusedRowIndex=null),!1}handleKeyDown(e){switch(e.key){case x.UP:case x.DOWN:this.navigate(e.key===x.UP)&&e.preventDefault()}}onTabKeyDown(e){this.navigate(e.shiftKey)?e.preventDefault():(yt(e),this.forceFocusOutOfContainer(e.shiftKey))}navigate(e){if(null==this.lastFocusedRowIndex)return!1;const t=this.lastFocusedRowIndex+(e?-1:1);return!(t<0||t>=this.model.getRowCount())&&(this.focusRow(t),!0)}getLastFocusedRow(){return this.lastFocusedRowIndex}focusRow(t){this.ensureIndexVisible(t),window.setTimeout(()=>{if(!this.isAlive())return;const e=this.renderedRows.get(t);e&&e.eDiv.focus()},10)}getComponentAt(e){const t=this.renderedRows.get(e);return t&&t.rowComponent}forEachRenderedRow(i){this.renderedRows.forEach((e,t)=>i(e.rowComponent,t))}static getTemplate(e){return`\n            <div class="ag-virtual-list-viewport ag-${e}-virtual-list-viewport" role="presentation">\n                <div class="ag-virtual-list-container ag-${e}-virtual-list-container" ref="eContainer"></div>\n            </div>`}getItemHeight(){return this.environment.getListItemHeight()}ensureIndexVisible(e){const t=this.model.getRowCount();if("number"!=typeof e||e<0||e>=t)return void console.warn("AG Grid: invalid row index for ensureIndexVisible: "+e);const i=e*this.rowHeight,n=i+this.rowHeight,r=this.getGui(),o=r.scrollTop,s=r.offsetHeight,a=o+s<n;if(o>i)r.scrollTop=i;else if(a){const e=n-s;r.scrollTop=e}}setComponentCreator(e){this.componentCreator=e}setComponentUpdater(e){this.componentUpdater=e}getRowHeight(){return this.rowHeight}getScrollTop(){return this.getGui().scrollTop}setRowHeight(e){this.rowHeight=e,this.refresh()}refresh(e){if(null==this.model||!this.isAlive())return;const t=this.model.getRowCount();this.eContainer.style.height=t*this.rowHeight+"px",Pe(()=>this.eContainer.clientHeight>=t*this.rowHeight,()=>{this.isAlive()&&(this.canSoftRefresh(e)?this.drawVirtualRows(!0):(this.clearVirtualRows(),this.drawVirtualRows()))})}canSoftRefresh(e){return!!(e&&this.renderedRows.size&&"function"==typeof this.model.areRowsEqual&&this.componentUpdater)}clearVirtualRows(){this.renderedRows.forEach((e,t)=>this.removeRow(t))}drawVirtualRows(e){if(!this.isAlive())return;const t=this.getGui(),i=t.scrollTop,n=i+t.offsetHeight,r=Math.floor(i/this.rowHeight),o=Math.floor(n/this.rowHeight);this.ensureRowsRendered(r,o,e)}ensureRowsRendered(i,n,e){this.renderedRows.forEach((e,t)=>{(t<i||t>n)&&t!==this.lastFocusedRowIndex&&this.removeRow(t)}),e&&this.refreshRows();for(let e=i;e<=n;e++)this.renderedRows.has(e)||e<this.model.getRowCount()&&this.insertRow(e)}insertRow(e){const t=this.model.getRow(e),i=document.createElement("div");if(i.classList.add("ag-virtual-list-item",`ag-${this.cssIdentifier}-virtual-list-item`),Ci(i,"tree"===this.ariaRole?"treeitem":"option"),Fi(i,this.model.getRowCount()),Gi(i,e+1),i.setAttribute("tabindex","-1"),"function"==typeof this.model.isRowSelected){const t=this.model.isRowSelected(e);Yi(i,!!t),qi(i,t)}i.style.height=this.rowHeight+"px",i.style.top=this.rowHeight*e+"px";const n=this.componentCreator(t,i);n.addGuiEventListener("focusin",()=>this.lastFocusedRowIndex=e),i.appendChild(n.getGui()),this.renderedRows.has(e-1)?this.renderedRows.get(e-1).eDiv.insertAdjacentElement("afterend",i):this.renderedRows.has(e+1)?this.renderedRows.get(e+1).eDiv.insertAdjacentElement("beforebegin",i):this.eContainer.appendChild(i),this.renderedRows.set(e,{rowComponent:n,eDiv:i,value:t})}removeRow(e){const t=this.renderedRows.get(e);this.eContainer.removeChild(t.eDiv),this.destroyBean(t.rowComponent),this.renderedRows.delete(e)}refreshRows(){const r=this.model.getRowCount();this.renderedRows.forEach((e,t)=>{var i,n;if(t>=r)this.removeRow(t);else{const r=this.model.getRow(t);(null===(n=(i=this.model).areRowsEqual)||void 0===n?void 0:n.call(i,e.value,r))?this.componentUpdater(r,e.rowComponent):this.removeRow(t)}})}addScrollListener(){this.addGuiEventListener("scroll",()=>this.drawVirtualRows(),{passive:!0})}setModel(e){this.model=e}destroy(){this.isAlive()&&(this.clearVirtualRows(),super.destroy())}}Su([s("resizeObserverService")],Au.prototype,"resizeObserverService",void 0),Su([A("eContainer")],Au.prototype,"eContainer",void 0),Su([r],Au.prototype,"postConstruct",null);const Eu=["mouseover","mouseout","mouseenter","mouseleave","mousemove"],Tu=["touchstart","touchend","touchmove","touchcancel"];class Du{constructor(){this.renderingEngine="vanilla",this.isOutsideAngular=e=>dt(Eu,e)}setTimeout(e,t){window.setTimeout(e,t)}setInterval(t,i){return new Rr(e=>{e(window.setInterval(t,i))})}addEventListener(e,t,i,n){const r=dt(Tu,t);e.addEventListener(t,i,{capture:!!n,passive:r})}dispatchEvent(e,t,i=!1){t()}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}}var Ru=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Mu=class extends p{getNextCellToFocus(e,t,i=!1){return i?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const i=e===x.UP,n=e===x.DOWN,r=e===x.LEFT;let o,s;if(i||n)s=i?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow(),o=t.column;else{const e=this.columnModel.getAllDisplayedColumns(),i=this.gridOptionsService.is("enableRtl");s=t.rowIndex,o=r!==i?e[0]:f(e)}return{rowIndex:s,rowPinned:null,column:o}}getNextCellToFocusWithoutCtrlPressed(e,t){let i=t,n=!1;for(;!n;){switch(e){case x.UP:i=this.getCellAbove(i);break;case x.DOWN:i=this.getCellBelow(i);break;case x.RIGHT:i=this.gridOptionsService.is("enableRtl")?this.getCellToLeft(i):this.getCellToRight(i);break;case x.LEFT:i=this.gridOptionsService.is("enableRtl")?this.getCellToRight(i):this.getCellToLeft(i);break;default:i=null,console.warn("AG Grid: unknown key for navigation "+e)}n=!i||this.isCellGoodToFocusOn(i)}return i}isCellGoodToFocusOn(e){const t=e.column;let i;switch(e.rowPinned){case"top":i=this.pinnedRowModel.getPinnedTopRow(e.rowIndex);break;case"bottom":i=this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);break;default:i=this.rowModel.getRow(e.rowIndex)}if(!i)return!1;return!t.isSuppressNavigable(i)}getCellToLeft(e){if(!e)return null;const t=this.columnModel.getDisplayedColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.columnModel.getDisplayedColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getRowBelow(e){const t=e.rowIndex,i=e.rowPinned;if(this.isLastRowInContainer(e))switch(i){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.paginationProxy.getPageFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}const n=this.rowModel.getRow(e.rowIndex),r=this.getNextStickyPosition(n);return r||{rowIndex:t+1,rowPinned:i}}getNextStickyPosition(t,e){if(!this.gridOptionsService.isGroupRowsSticky()||!t||!t.sticky)return;const i=[...this.rowRenderer.getStickyTopRowCtrls()].sort((e,t)=>e.getRowNode().rowIndex-t.getRowNode().rowIndex),n=e?-1:1,r=i.findIndex(e=>e.getRowNode().rowIndex===t.rowIndex),o=i[r+n];return o?{rowIndex:o.getRowNode().rowIndex,rowPinned:null}:void 0}getCellBelow(e){if(!e)return null;const t=this.getRowBelow(e);return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}isLastRowInContainer(e){const t=e.rowPinned,i=e.rowIndex;if("top"===t){return this.pinnedRowModel.getPinnedTopRowData().length-1<=i}if("bottom"===t){return this.pinnedRowModel.getPinnedBottomRowData().length-1<=i}return this.paginationProxy.getPageLastRow()<=i}getRowAbove(e){const t=e.rowIndex,i=e.rowPinned;if(i?0===t:t===this.paginationProxy.getPageFirstRow())return"top"===i?null:i&&this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;const n=this.rowModel.getRow(e.rowIndex),r=this.getNextStickyPosition(n,!0);return r||{rowIndex:t-1,rowPinned:i}}getCellAbove(e){if(!e)return null;const t=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}getLastBodyCell(){return{rowIndex:this.paginationProxy.getPageLastRow(),rowPinned:null}}getLastFloatingTopRow(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowData().length-1,rowPinned:"top"}}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(t){const i=this.columnModel.getAllDisplayedColumns();let n=t.rowIndex,r=t.rowPinned,o=this.columnModel.getDisplayedColAfter(t.column);if(!o){o=i[0];const e=this.getRowBelow(t);if(u(e))return null;if(!e.rowPinned&&!this.paginationProxy.isRowInPage(e))return null;n=e?e.rowIndex:null,r=e?e.rowPinned:null}return{rowIndex:n,column:o,rowPinned:r}}getNextTabbedCellBackwards(t){const i=this.columnModel.getAllDisplayedColumns();let n=t.rowIndex,r=t.rowPinned,o=this.columnModel.getDisplayedColBefore(t.column);if(!o){o=f(i);const e=this.getRowAbove({rowIndex:t.rowIndex,rowPinned:t.rowPinned});if(u(e))return null;if(!e.rowPinned&&!this.paginationProxy.isRowInPage(e))return null;n=e?e.rowIndex:null,r=e?e.rowPinned:null}return{rowIndex:n,column:o,rowPinned:r}}};Ru([s("columnModel")],Mu.prototype,"columnModel",void 0),Ru([s("rowModel")],Mu.prototype,"rowModel",void 0),Ru([s("rowRenderer")],Mu.prototype,"rowRenderer",void 0),Ru([s("pinnedRowModel")],Mu.prototype,"pinnedRowModel",void 0),Ru([s("paginationProxy")],Mu.prototype,"paginationProxy",void 0),Mu=Ru([o("cellNavigationService")],Mu);var ku=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Ou=function(i,n){return function(e,t){n(e,t,i)}};let Nu=class extends p{constructor(){super(...arguments),this.consuming=!1}setBeans(e){this.logger=e.create("AlignedGridsService")}init(){this.addManagedListener(this.eventService,y.EVENT_COLUMN_MOVED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_VISIBLE,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PINNED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_GROUP_OPENED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_RESIZED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,y.EVENT_BODY_SCROLL,this.fireScrollEvent.bind(this))}fireEvent(i){if(this.consuming)return;const e=this.gridOptionsService.get("alignedGrids");e&&e.forEach(t=>{if(t.api){const e=t.api.__getAlignedGridService();i(e)}})}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(t){this.fireEvent(e=>{e.onColumnEvent(t)})}fireScrollEvent(t){"horizontal"===t.direction&&this.fireEvent(e=>{e.onScrollEvent(t)})}onScrollEvent(e){this.onEvent(()=>{this.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}getMasterColumns(e){const t=[];return e.columns?e.columns.forEach(e=>{t.push(e)}):e.column&&t.push(e.column),t}getColumnIds(e){const t=[];return e.columns?e.columns.forEach(e=>{t.push(e.getColId())}):e.column&&t.push(e.column.getColId()),t}onColumnEvent(i){this.onEvent(()=>{switch(i.type){case y.EVENT_COLUMN_MOVED:case y.EVENT_COLUMN_VISIBLE:case y.EVENT_COLUMN_PINNED:case y.EVENT_COLUMN_RESIZED:const e=i;this.processColumnEvent(e);break;case y.EVENT_COLUMN_GROUP_OPENED:const t=i;this.processGroupOpenedEvent(t);break;case y.EVENT_COLUMN_PIVOT_CHANGED:console.warn("AG Grid: pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.")}})}processGroupOpenedEvent(e){const t=e.columnGroup;let i=null;if(t){const e=t.getGroupId();i=this.columnModel.getProvidedColumnGroup(e)}t&&!i||(this.logger.log("onColumnEvent-> processing "+e+" expanded = "+t.isExpanded()),this.columnModel.setColumnGroupOpened(i,t.isExpanded(),"alignedGridChanged"))}processColumnEvent(t){var e;const i=t.column;let n=null;if(i&&(n=this.columnModel.getPrimaryColumn(i.getColId())),i&&!n)return;const r=this.getMasterColumns(t);switch(t.type){case y.EVENT_COLUMN_MOVED:{const e=t,i=t.columnApi.getColumnState().map(e=>({colId:e.colId}));this.columnModel.applyColumnState({state:i,applyOrder:!0},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${t.type} toIndex = ${e.toIndex}`)}break;case y.EVENT_COLUMN_VISIBLE:{const e=t,i=t.columnApi.getColumnState().map(e=>({colId:e.colId,hide:e.hide}));this.columnModel.applyColumnState({state:i},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${t.type} visible = ${e.visible}`)}break;case y.EVENT_COLUMN_PINNED:{const e=t,i=t.columnApi.getColumnState().map(e=>({colId:e.colId,pinned:e.pinned}));this.columnModel.applyColumnState({state:i},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${t.type} pinned = ${e.pinned}`)}break;case y.EVENT_COLUMN_RESIZED:const i=t,n={};r.forEach(e=>{this.logger.log(`onColumnEvent-> processing ${t.type} actualWidth = ${e.getActualWidth()}`),n[e.getId()]={key:e.getColId(),newWidth:e.getActualWidth()}}),null===(e=i.flexColumns)||void 0===e||e.forEach(e=>{n[e.getId()]&&delete n[e.getId()]}),this.columnModel.setColumnWidths(Object.values(n),!1,i.finished,"alignedGridChanged")}const o=this.ctrlsService.getGridBodyCtrl().isVerticalScrollShowing(),s=this.gridOptionsService.get("alignedGrids");s&&s.forEach(e=>{e.api&&e.api.setAlwaysShowVerticalScroll(o)})}};ku([s("columnModel")],Nu.prototype,"columnModel",void 0),ku([s("ctrlsService")],Nu.prototype,"ctrlsService",void 0),ku([Ou(0,ze("loggerFactory"))],Nu.prototype,"setBeans",null),ku([r],Nu.prototype,"init",null),Nu=ku([o("alignedGridsService")],Nu);var Iu=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Lu=function(i,n){return function(e,t){n(e,t,i)}};let Pu=class extends p{setBeans(e){this.logger=e.create("selectionService"),this.reset()}init(){this.groupSelectsChildren=this.gridOptionsService.is("groupSelectsChildren"),this.addManagedPropertyListener("groupSelectsChildren",e=>this.groupSelectsChildren=e.currentValue),this.rowSelection=this.gridOptionsService.get("rowSelection"),this.addManagedPropertyListener("rowSelection",e=>this.rowSelection=e.currentValue),this.addManagedListener(this.eventService,y.EVENT_ROW_SELECTED,this.onRowSelected.bind(this))}isMultiselect(){return"multiple"===this.rowSelection}setNodesSelected(t){var i;if(0===t.nodes.length)return 0;const{newValue:n,clearSelection:e,suppressFinishActions:r,rangeSelect:o,event:s,source:a="api"}=t;if(t.nodes.length>1&&!this.isMultiselect())return console.warn("AG Grid: cannot multi select while rowSelection='single'"),0;const l=this.groupSelectsChildren&&!0===t.groupSelectsFiltered,c=t.nodes.map(e=>e.footer?e.sibling:e);if(o){if(t.nodes.length>1)return console.warn("AG Grid: cannot range select while selecting multiple rows"),0;const i=this.getLastSelectedNode();if(i){const n=c[0];if(i!==n&&this.isMultiselect()){const e=this.selectRange(n,i,t.newValue,a);return this.setLastSelectedNode(n),e}}}let u=0;for(let e=0;e<c.length;e++){const r=c[e];if(!(l&&r.group)){r.selectThisNode(n,t.event,a)&&u++}this.groupSelectsChildren&&(null===(i=r.childrenAfterGroup)||void 0===i?void 0:i.length)&&(u+=this.selectChildren(r,n,l,a))}if(!r){if(n&&(e||!this.isMultiselect())&&(u+=this.clearOtherNodes(c[0],a)),u>0){this.updateGroupsFromChildrenSelections(a);const t={type:y.EVENT_SELECTION_CHANGED,source:a};this.eventService.dispatchEvent(t)}n&&this.setLastSelectedNode(c[c.length-1])}return u}selectRange(t,e,i=!0,n){const r=this.rowModel.getNodesInRangeForSelection(t,e);let o=0;r.forEach(e=>{if(e.group&&this.groupSelectsChildren||!1===i&&t===e)return;e.selectThisNode(i,void 0,n)&&o++}),this.updateGroupsFromChildrenSelections(n);const s={type:y.EVENT_SELECTION_CHANGED,source:n};return this.eventService.dispatchEvent(s),o}selectChildren(e,t,i,n){const r=i?e.childrenAfterAggFilter:e.childrenAfterGroup;return Er.missing(r)?0:this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:i,source:n,nodes:r})}setLastSelectedNode(e){this.lastSelectedNode=e}getLastSelectedNode(){return this.lastSelectedNode}getSelectedNodes(){const i=[];return a(this.selectedNodes,(e,t)=>{t&&i.push(t)}),i}getSelectedRows(){const i=[];return a(this.selectedNodes,(e,t)=>{t&&t.data&&i.push(t.data)}),i}getSelectionCount(){return Object.values(this.selectedNodes).length}filterFromSelection(i){const n={};Object.entries(this.selectedNodes).forEach(([e,t])=>{t&&i(t)&&(n[e]=t)}),this.selectedNodes=n}updateGroupsFromChildrenSelections(t,e){if(!this.groupSelectsChildren)return!1;if("clientSide"!==this.rowModel.getType())return!1;const i=this.rowModel.getRootNode();e||(e=new zc(!0,i)).setInactive();let n=!1;return e.forEachChangedNodeDepthFirst(e=>{if(e!==i){const i=e.calculateSelectedFromChildren();n=e.selectThisNode(null!==i&&i,void 0,t)||n}}),n}clearOtherNodes(i,n){const r={};let o=0;return a(this.selectedNodes,(e,t)=>{if(t&&t.id!==i.id){const i=this.selectedNodes[t.id];o+=i.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:n}),this.groupSelectsChildren&&t.parent&&(r[t.parent.id]=t.parent)}}),a(r,(e,t)=>{const i=t.calculateSelectedFromChildren();t.selectThisNode(null!==i&&i,void 0,n)}),o}onRowSelected(e){const t=e.node;this.groupSelectsChildren&&t.group||(t.isSelected()?this.selectedNodes[t.id]=t:delete this.selectedNodes[t.id])}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}syncInOldRowNode(t,i){if(C(i)&&t.id!==i.id&&i){const e=i.id;this.selectedNodes[e]==t&&(this.selectedNodes[i.id]=i)}}syncInNewRowNode(e){C(this.selectedNodes[e.id])?(e.setSelectedInitialValue(!0),this.selectedNodes[e.id]=e):e.setSelectedInitialValue(!1)}reset(){this.logger.log("reset"),this.selectedNodes={},this.lastSelectedNode=null}getBestCostNodeSelection(){if("clientSide"!==this.rowModel.getType())return;const e=this.rowModel.getTopLevelNodes();if(null===e)return;const r=[];return function i(n){for(let t=0,e=n.length;t<e;t++){const e=n[t];if(e.isSelected())r.push(e);else{const r=e;r.group&&r.children&&i(r.children)}}}(e),r}isEmpty(){let i=0;return a(this.selectedNodes,(e,t)=>{t&&i++}),0===i}deselectAllRowNodes(e){const i=e=>e.selectThisNode(!1,void 0,n),t="clientSide"===this.rowModel.getType(),{source:n,justFiltered:r,justCurrentPage:o}=e;if(o||r){if(!t)return void console.error("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'");this.getNodesToSelect(r,o).forEach(i)}else a(this.selectedNodes,(e,t)=>{t&&i(t)}),this.reset();t&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(n);const s={type:y.EVENT_SELECTION_CHANGED,source:n};this.eventService.dispatchEvent(s)}getSelectAllState(e,t){let i=0,n=0;return this.getNodesToSelect(e,t).forEach(e=>{this.groupSelectsChildren&&e.group||(e.isSelected()?i++:e.selectable&&n++)}),(0!==i||0!==n)&&(i>0&&n>0?null:i>0)}getNodesToSelect(e=!1,t=!1){if("clientSide"!==this.rowModel.getType())throw new Error("selectAll only available when rowModelType='clientSide', ie not "+this.rowModel.getType());const n=[];if(t)return this.paginationProxy.forEachNodeOnPage(e=>{if(e.group)if(e.expanded)this.groupSelectsChildren||n.push(e);else{const i=e=>{var t;n.push(e),(null===(t=e.childrenAfterFilter)||void 0===t?void 0:t.length)&&e.childrenAfterFilter.forEach(i)};i(e)}else n.push(e)}),n;const i=this.rowModel;return e?(i.forEachNodeAfterFilter(e=>{n.push(e)}),n):(i.forEachNode(e=>{n.push(e)}),n)}selectAllRowNodes(e){if("clientSide"!==this.rowModel.getType())throw new Error("selectAll only available when rowModelType='clientSide', ie not "+this.rowModel.getType());const{source:t,justFiltered:i,justCurrentPage:n}=e;this.getNodesToSelect(i,n).forEach(e=>e.selectThisNode(!0,void 0,t)),"clientSide"===this.rowModel.getType()&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(t);const r={type:y.EVENT_SELECTION_CHANGED,source:t};this.eventService.dispatchEvent(r)}getServerSideSelectionState(){return null}setServerSideSelectionState(e){}};Iu([s("rowModel")],Pu.prototype,"rowModel",void 0),Iu([s("paginationProxy")],Pu.prototype,"paginationProxy",void 0),Iu([Lu(0,ze("loggerFactory"))],Pu.prototype,"setBeans",null),Iu([r],Pu.prototype,"init",null),Pu=Iu([o("selectionService")],Pu);var Fu=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Gu=class{sizeColumnsToFit(e){void 0===e&&console.error("AG Grid: missing parameter to columnApi.sizeColumnsToFit(gridWidth)"),this.columnModel.sizeColumnsToFit(e,"api")}setColumnGroupOpened(e,t){this.columnModel.setColumnGroupOpened(e,t,"api")}getColumnGroup(e,t){return this.columnModel.getColumnGroup(e,t)}getProvidedColumnGroup(e){return this.columnModel.getProvidedColumnGroup(e)}getDisplayNameForColumn(e,t){return this.columnModel.getDisplayNameForColumn(e,t)||""}getDisplayNameForColumnGroup(e,t){return this.columnModel.getDisplayNameForColumnGroup(e,t)||""}getColumn(e){return this.columnModel.getPrimaryColumn(e)}getColumns(){return this.columnModel.getAllPrimaryColumns()}applyColumnState(e){return this.columnModel.applyColumnState(e,"api")}getColumnState(){return this.columnModel.getColumnState()}resetColumnState(){this.columnModel.resetColumnState("api")}getColumnGroupState(){return this.columnModel.getColumnGroupState()}setColumnGroupState(e){this.columnModel.setColumnGroupState(e,"api")}resetColumnGroupState(){this.columnModel.resetColumnGroupState("api")}isPinning(){return this.columnModel.isPinningLeft()||this.columnModel.isPinningRight()}isPinningLeft(){return this.columnModel.isPinningLeft()}isPinningRight(){return this.columnModel.isPinningRight()}getDisplayedColAfter(e){return this.columnModel.getDisplayedColAfter(e)}getDisplayedColBefore(e){return this.columnModel.getDisplayedColBefore(e)}setColumnVisible(e,t){this.columnModel.setColumnVisible(e,t,"api")}setColumnsVisible(e,t){this.columnModel.setColumnsVisible(e,t,"api")}setColumnPinned(e,t){this.columnModel.setColumnPinned(e,t,"api")}setColumnsPinned(e,t){this.columnModel.setColumnsPinned(e,t,"api")}getAllGridColumns(){return this.columnModel.getAllGridColumns()}getDisplayedLeftColumns(){return this.columnModel.getDisplayedLeftColumns()}getDisplayedCenterColumns(){return this.columnModel.getDisplayedCenterColumns()}getDisplayedRightColumns(){return this.columnModel.getDisplayedRightColumns()}getAllDisplayedColumns(){return this.columnModel.getAllDisplayedColumns()}getAllDisplayedVirtualColumns(){return this.columnModel.getViewportColumns()}moveColumn(e,t){this.columnModel.moveColumn(e,t,"api")}moveColumnByIndex(e,t){this.columnModel.moveColumnByIndex(e,t,"api")}moveColumns(e,t){this.columnModel.moveColumns(e,t,"api")}moveRowGroupColumn(e,t){this.columnModel.moveRowGroupColumn(e,t)}setColumnAggFunc(e,t){this.columnModel.setColumnAggFunc(e,t)}setColumnWidth(e,t,i=!0,n){this.columnModel.setColumnWidths([{key:e,newWidth:t}],!1,i,n)}setColumnWidths(e,t=!0,i){this.columnModel.setColumnWidths(e,!1,t,i)}setPivotMode(e){this.columnModel.setPivotMode(e)}isPivotMode(){return this.columnModel.isPivotMode()}getPivotResultColumn(e,t){return this.columnModel.getSecondaryPivotColumn(e,t)}setValueColumns(e){this.columnModel.setValueColumns(e,"api")}getValueColumns(){return this.columnModel.getValueColumns()}removeValueColumn(e){this.columnModel.removeValueColumn(e,"api")}removeValueColumns(e){this.columnModel.removeValueColumns(e,"api")}addValueColumn(e){this.columnModel.addValueColumn(e,"api")}addValueColumns(e){this.columnModel.addValueColumns(e,"api")}setRowGroupColumns(e){this.columnModel.setRowGroupColumns(e,"api")}removeRowGroupColumn(e){this.columnModel.removeRowGroupColumn(e,"api")}removeRowGroupColumns(e){this.columnModel.removeRowGroupColumns(e,"api")}addRowGroupColumn(e){this.columnModel.addRowGroupColumn(e,"api")}addRowGroupColumns(e){this.columnModel.addRowGroupColumns(e,"api")}getRowGroupColumns(){return this.columnModel.getRowGroupColumns()}setPivotColumns(e){this.columnModel.setPivotColumns(e,"api")}removePivotColumn(e){this.columnModel.removePivotColumn(e,"api")}removePivotColumns(e){this.columnModel.removePivotColumns(e,"api")}addPivotColumn(e){this.columnModel.addPivotColumn(e,"api")}addPivotColumns(e){this.columnModel.addPivotColumns(e,"api")}getPivotColumns(){return this.columnModel.getPivotColumns()}getLeftDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeLeft()}getCenterDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeCentre()}getRightDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeRight()}getAllDisplayedColumnGroups(){return this.columnModel.getAllDisplayedTrees()}autoSizeColumn(e,t){return this.columnModel.autoSizeColumn(e,t,"api")}autoSizeColumns(e,t){this.columnModel.autoSizeColumns({columns:e,skipHeader:t})}autoSizeAllColumns(e){this.columnModel.autoSizeAllColumns(e,"api")}setPivotResultColumns(e){this.columnModel.setSecondaryColumns(e,"api")}getPivotResultColumns(){return this.columnModel.getSecondaryColumns()}cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid(){setTimeout(Er.removeAllReferences.bind(window,this,"Column API"),100)}getAllColumns(){return Xt("28.0","getAllColumns","getColumns"),this.getColumns()}getPrimaryColumns(){return Xt("28.0","getPrimaryColumns","getColumns"),this.getColumns()}getSecondaryColumns(){return Xt("28.0","getSecondaryColumns","getPivotResultColumns"),this.getPivotResultColumns()}setSecondaryColumns(e){Xt("28.0","setSecondaryColumns","setPivotResultColumns"),this.setPivotResultColumns(e)}getSecondaryPivotColumn(e,t){return Xt("28.0","getSecondaryPivotColumn","getPivotResultColumn"),this.getPivotResultColumn(e,t)}};Fu([s("columnModel")],Gu.prototype,"columnModel",void 0),Fu([Ve],Gu.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),Gu=Fu([o("columnApi")],Gu);var $u=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Hu=class extends p{constructor(){super(...arguments),this.initialised=!1,this.isSsrm=!1}init(){this.isSsrm=this.gridOptionsService.isRowModelType("serverSide"),this.cellExpressions=this.gridOptionsService.is("enableCellExpressions"),this.isTreeData=this.gridOptionsService.is("treeData"),this.initialised=!0,this.eventService.addEventListener(y.EVENT_CELL_VALUE_CHANGED,e=>this.callColumnCellValueChangedHandler(e),this.gridOptionsService.useAsyncEvents()),this.addManagedPropertyListener("treeData",e=>this.isTreeData=e.currentValue)}getValue(e,t,i=!1,n=!1){if(this.initialised||this.init(),!t)return;const r=e.getColDef(),o=r.field,s=e.getColId(),a=t.data;let l;const c=t.groupData&&void 0!==t.groupData[s],u=!n&&t.aggData&&void 0!==t.aggData[s],d=this.isSsrm&&n&&!!e.getColDef().aggFunc,h=this.isSsrm&&t.footer&&t.field&&(!0===e.getColDef().showRowGroup||e.getColDef().showRowGroup===t.field);if(i&&r.filterValueGetter?l=this.executeFilterValueGetter(r.filterValueGetter,a,e,t):this.isTreeData&&u?l=t.aggData[s]:this.isTreeData&&r.valueGetter?l=this.executeValueGetter(r.valueGetter,a,e,t):this.isTreeData&&o&&a?l=xe(a,o,e.isFieldContainsDots()):c?l=t.groupData[s]:u?l=t.aggData[s]:r.valueGetter?l=this.executeValueGetter(r.valueGetter,a,e,t):h?l=xe(a,t.field,e.isFieldContainsDots()):o&&a&&!d&&(l=xe(a,o,e.isFieldContainsDots())),this.cellExpressions&&"string"==typeof l&&0===l.indexOf("=")){const i=l.substring(1);l=this.executeValueGetter(i,a,e,t)}if(null==l){const i=this.getOpenedGroup(t,e);if(null!=i)return i}return l}getOpenedGroup(e,t){if(!this.gridOptionsService.is("showOpenedGroup"))return;if(!t.getColDef().showRowGroup)return;const i=t.getColDef().showRowGroup;let n=e.parent;for(;null!=n;){if(n.rowGroupColumn&&(!0===i||i===n.rowGroupColumn.getColId()))return n.key;n=n.parent}}setValue(e,t,i,n){const r=this.columnModel.getPrimaryColumn(t);if(!e||!r)return!1;u(e.data)&&(e.data={});const{field:o,valueSetter:s}=r.getColDef();if(u(o)&&u(s))return console.warn("AG Grid: you need either field or valueSetter set on colDef for editing to work"),!1;if(!this.dataTypeService.checkType(r,i))return console.warn("AG Grid: Data type of the new value does not match the cell data type of the column"),!1;const a={node:e,data:e.data,oldValue:this.getValue(r,e),newValue:i,colDef:r.getColDef(),column:r,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};let l;if(a.newValue=i,l=C(s)?"function"==typeof s?s(a):this.expressionService.evaluate(s,a):this.setValueUsingField(e.data,o,i,r.isFieldContainsDots()),void 0===l&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache.onDataChanged(),a.newValue=this.getValue(r,e);const c={type:y.EVENT_CELL_VALUE_CHANGED,event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:a.column,api:a.api,columnApi:a.columnApi,colDef:a.colDef,context:a.context,data:e.data,node:e,oldValue:a.oldValue,newValue:a.newValue,value:a.newValue,source:n};return this.eventService.dispatchEvent(c),!0}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;"function"==typeof t&&t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,columnApi:e.columnApi,context:e.context})}setValueUsingField(t,i,n,r){if(!i)return!1;let o=!1;if(r){const r=i.split(".");let e=t;for(;r.length>0&&e;){const t=r.shift();0===r.length?(o=e[t]==n,o||(e[t]=n)):e=e[t]}}else o=t[i]==n,o||(t[i]=n);return!o}executeFilterValueGetter(e,t,i,n){const r={data:t,node:n,column:i,colDef:i.getColDef(),api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,getValue:this.getValueCallback.bind(this,n)};return"function"==typeof e?e(r):this.expressionService.evaluate(e,r)}executeValueGetter(e,t,i,n){const r=i.getColId(),o=this.valueCache.getValue(n,r);if(void 0!==o)return o;const s={data:t,node:n,column:i,colDef:i.getColDef(),api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,getValue:this.getValueCallback.bind(this,n)};let a;return a="function"==typeof e?e(s):this.expressionService.evaluate(e,s),this.valueCache.setValue(n,r,a),a}getValueCallback(e,t){const i=this.columnModel.getPrimaryColumn(t);return i?this.getValue(i,e):null}getKeyForNode(e,t){const i=this.getValue(e,t),n=e.getColDef().keyCreator;let r=i;if(n){r=n({value:i,colDef:e.getColDef(),column:e,node:t,data:t.data,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context})}return"string"==typeof r||null==r||(r=String(r),"[object Object]"===r&&l(()=>{console.warn("AG Grid: a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")},"getKeyForNode - warn about [object,object]")),r}};$u([s("expressionService")],Hu.prototype,"expressionService",void 0),$u([s("columnModel")],Hu.prototype,"columnModel",void 0),$u([s("valueCache")],Hu.prototype,"valueCache",void 0),$u([s("dataTypeService")],Hu.prototype,"dataTypeService",void 0),$u([r],Hu.prototype,"init",null),Hu=$u([o("valueService")],Hu);var Bu=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Vu=function(i,n){return function(e,t){n(e,t,i)}};let ju=class extends p{constructor(){super(...arguments),this.expressionToFunctionCache={}}setBeans(e){this.logger=e.create("ExpressionService")}evaluate(e,t){if("string"==typeof e)return this.evaluateExpression(e,t);console.error("AG Grid: value should be either a string or a function",e)}evaluateExpression(t,i){try{const e=this.createExpressionFunction(t);return e(i.value,i.context,i.oldValue,i.newValue,i.value,i.node,i.data,i.colDef,i.rowIndex,i.api,i.columnApi,i.getValue,i.column,i.columnGroup)}catch(e){return console.log("Processing of the expression failed"),console.log("Expression = "+t),console.log("Params =",i),console.log("Exception = "+e),null}}createExpressionFunction(e){if(this.expressionToFunctionCache[e])return this.expressionToFunctionCache[e];const t=this.createFunctionBody(e),i=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, columnApi, getValue, column, columnGroup",t);return this.expressionToFunctionCache[e]=i,i}createFunctionBody(e){return e.indexOf("return")>=0?e:"return "+e+";"}};Bu([Vu(0,ze("loggerFactory"))],ju.prototype,"setBeans",null),ju=Bu([o("expressionService")],ju);var zu=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Wu=class extends p{constructor(){super(...arguments),this.templateCache={},this.waitingCallbacks={}}getTemplate(e,t){const i=this.templateCache[e];if(i)return i;let n=this.waitingCallbacks[e];const r=this;if(!n){n=[],this.waitingCallbacks[e]=n;const t=new XMLHttpRequest;t.onload=function(){r.handleHttpResult(this,e)},t.open("GET",e),t.send()}return t&&n.push(t),null}handleHttpResult(e,t){if(200!==e.status||null===e.response)return void console.warn(`AG Grid: Unable to get template error ${e.status} - ${t}`);this.templateCache[t]=e.response||e.responseText;const i=this.waitingCallbacks[t];for(let e=0;e<i.length;e++){(0,i[e])()}}};Wu=zu([o("templateService")],Wu);var Uu=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Yu=function(i,n){return function(e,t){n(e,t,i)}};let qu=class extends p{setBeans(e){this.logging=e.is("debug")}create(e){return new Ku(e,this.isLogging.bind(this))}isLogging(){return this.logging}};Uu([Yu(0,ze("gridOptionsService"))],qu.prototype,"setBeans",null),qu=Uu([o("loggerFactory")],qu);class Ku{constructor(e,t){this.name=e,this.isLoggingFunc=t}isLogging(){return this.isLoggingFunc()}log(e){this.isLoggingFunc()&&console.log("AG Grid."+this.name+": "+e)}}var Xu=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Zu extends p{setComp(e,t,i){this.view=e,this.eGridHostDiv=t,this.eGui=i,this.eGui.setAttribute("grid-id",this.context.getGridId()),this.dragAndDropService.addDropTarget({getContainer:()=>this.eGui,isInterestedIn:e=>e===es.HeaderCell||e===es.ToolPanel,getIconName:()=>M.ICON_NOT_ALLOWED}),this.mouseEventService.stampTopLevelGridCompWithGridInstance(t),this.createManagedBean(new da(this.view)),this.addRtlSupport(),this.addManagedListener(this,y.EVENT_KEYBOARD_FOCUS,()=>{this.view.addOrRemoveKeyboardFocusClass(!0)}),this.addManagedListener(this,y.EVENT_MOUSE_FOCUS,()=>{this.view.addOrRemoveKeyboardFocusClass(!1)});const n=this.resizeObserverService.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>n()),this.ctrlsService.registerGridCtrl(this)}isDetailGrid(){var e;const t=this.focusService.findTabbableParent(this.getGui());return(null===(e=null==t?void 0:t.getAttribute("row-id"))||void 0===e?void 0:e.startsWith("detail"))||!1}showDropZones(){return v.__isRegistered(m.RowGroupingModule,this.context.getGridId())}showSideBar(){return v.__isRegistered(m.SideBarModule,this.context.getGridId())}showStatusBar(){return v.__isRegistered(m.StatusBarModule,this.context.getGridId())}showWatermark(){return v.__isRegistered(m.EnterpriseCoreModule,this.context.getGridId())}onGridSizeChanged(){const e={type:y.EVENT_GRID_SIZE_CHANGED,clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight};this.eventService.dispatchEvent(e)}addRtlSupport(){const e=this.gridOptionsService.is("enableRtl")?"ag-rtl":"ag-ltr";this.view.setRtlClass(e)}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){this.view.setCursor(e?"ew-resize":null)}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.gridOptionsService.getDocument(),i=this.view.getFocusableContainers(),n=i.findIndex(e=>e.contains(t.activeElement))+(e?-1:1);return!(n<=0||n>=i.length)&&this.focusService.focusInto(i[n])}focusInnerElement(e){const t=this.view.getFocusableContainers(),i=this.columnModel.getAllDisplayedColumns();if(e){if(t.length>1)return this.focusService.focusInto(f(t),!0);const e=f(i);if(this.focusService.focusGridView(e,!0))return!0}return 0===this.gridOptionsService.getNum("headerHeight")?this.focusService.focusGridView(i[0]):this.focusService.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}}Xu([s("focusService")],Zu.prototype,"focusService",void 0),Xu([s("resizeObserverService")],Zu.prototype,"resizeObserverService",void 0),Xu([s("columnModel")],Zu.prototype,"columnModel",void 0),Xu([s("ctrlsService")],Zu.prototype,"ctrlsService",void 0),Xu([s("mouseEventService")],Zu.prototype,"mouseEventService",void 0),Xu([s("dragAndDropService")],Zu.prototype,"dragAndDropService",void 0);var Qu=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Ju extends lu{constructor(e){super(),this.eGridDiv=e}postConstruct(){this.logger=this.loggerFactory.create("GridComp");const e={destroyGridUi:()=>this.destroyBean(this),setRtlClass:e=>this.addCssClass(e),addOrRemoveKeyboardFocusClass:e=>this.addOrRemoveCssClass(Ql.AG_KEYBOARD_FOCUS,e),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:e=>{this.getGui().style.userSelect=null!=e?e:"",this.getGui().style.webkitUserSelect=null!=e?e:""},setCursor:e=>{this.getGui().style.cursor=null!=e?e:""}};this.ctrl=this.createManagedBean(new Zu);const t=this.createTemplate();this.setTemplate(t),this.ctrl.setComp(e,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:e=>this.ctrl.focusInnerElement(e)})}insertGridIntoDom(){const e=this.getGui();this.eGridDiv.appendChild(e),this.addDestroyFunc(()=>{this.eGridDiv.removeChild(e),this.logger.log("Grid removed from DOM")})}updateLayoutClasses(e,t){const i=this.eRootWrapperBody.classList;i.toggle(ca.AUTO_HEIGHT,t.autoHeight),i.toggle(ca.NORMAL,t.normal),i.toggle(ca.PRINT,t.print),this.addOrRemoveCssClass(ca.AUTO_HEIGHT,t.autoHeight),this.addOrRemoveCssClass(ca.NORMAL,t.normal),this.addOrRemoveCssClass(ca.PRINT,t.print)}createTemplate(){return`<div class="ag-root-wrapper" role="presentation">\n                ${this.ctrl.showDropZones()?"<ag-grid-header-drop-zones></ag-grid-header-drop-zones>":""}\n                <div class="ag-root-wrapper-body" ref="rootWrapperBody" role="presentation">\n                    <ag-grid-body ref="gridBody"></ag-grid-body>\n                    ${this.ctrl.showSideBar()?'<ag-side-bar ref="sideBar"></ag-side-bar>':""}\n                </div>\n                ${this.ctrl.showStatusBar()?'<ag-status-bar ref="statusBar"></ag-status-bar>':""}\n                <ag-pagination></ag-pagination>\n                ${this.ctrl.showWatermark()?"<ag-watermark></ag-watermark>":""}\n            </div>`}getFocusableElement(){return this.eRootWrapperBody}getFocusableContainers(){const e=[this.gridBodyComp.getGui()];return this.sideBarComp&&e.push(this.sideBarComp.getGui()),e.filter(e=>Wn(e))}}Qu([s("loggerFactory")],Ju.prototype,"loggerFactory",void 0),Qu([A("gridBody")],Ju.prototype,"gridBodyComp",void 0),Qu([A("sideBar")],Ju.prototype,"sideBarComp",void 0),Qu([A("rootWrapperBody")],Ju.prototype,"eRootWrapperBody",void 0),Qu([r],Ju.prototype,"postConstruct",null);var ed,td=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let id=ed=class extends p{progressSort(e,t,i){const n=this.getNextSortDirection(e);this.setSortForColumn(e,n,t,i)}setSortForColumn(e,t,i,n){"asc"!==t&&"desc"!==t&&(t=null);let r=[e];if(this.gridOptionsService.isColumnsSortingCoupledToGroup()&&e.getColDef().showRowGroup){const t=this.columnModel.getSourceColumnsForGroupColumn(e),i=null==t?void 0:t.filter(e=>e.getColDef().sortable);i&&(r=[e,...i])}r.forEach(e=>e.setSort(t,n));(i||this.gridOptionsService.is("alwaysMultiSort"))&&!this.gridOptionsService.is("suppressMultiSort")||this.clearSortBarTheseColumns(r,n),this.updateSortIndex(e),this.dispatchSortChangedEvents(n)}updateSortIndex(e){const t=this.gridOptionsService.isColumnsSortingCoupledToGroup(),i=this.columnModel.getGroupDisplayColumnForGroup(e.getId()),n=t&&i||e,r=this.getColumnsWithSortingOrdered();this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(e=>e.setSortIndex(null));const o=r.filter(e=>e!==n);(n.getSort()?[...o,n]:o).forEach((e,t)=>e.setSortIndex(t))}onSortChanged(e){this.dispatchSortChangedEvents(e)}isSortActive(){const e=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(e=>!!e.getSort());return e&&e.length>0}dispatchSortChangedEvents(e){const t={type:y.EVENT_SORT_CHANGED,source:e};this.eventService.dispatchEvent(t)}clearSortBarTheseColumns(t,i){this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(e=>{t.includes(e)||e.setSort(void 0,i)})}getNextSortDirection(e){let t;if(t=e.getColDef().sortingOrder?e.getColDef().sortingOrder:this.gridOptionsService.get("sortingOrder")?this.gridOptionsService.get("sortingOrder"):ed.DEFAULT_SORTING_ORDER,!Array.isArray(t)||t.length<=0)return console.warn("AG Grid: sortingOrder must be an array with at least one element, currently it's "+t),null;const i=t.indexOf(e.getSort()),n=i<0,r=i==t.length-1;let o;return o=n||r?t[0]:t[i+1],ed.DEFAULT_SORTING_ORDER.indexOf(o)<0?(console.warn("AG Grid: invalid sort type "+o),null):o}getIndexedSortMap(){let e=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(e=>!!e.getSort());if(this.columnModel.isPivotMode()){const r=this.gridOptionsService.isColumnsSortingCoupledToGroup();e=e.filter(e=>{const t=!!e.getAggFunc(),i=!e.isPrimary(),n=r?this.columnModel.getGroupDisplayColumnForGroup(e.getId()):e.getColDef().showRowGroup;return t||i||n})}const r=this.columnModel.getRowGroupColumns().filter(e=>!!e.getSort()),t=this.gridOptionsService.isColumnsSortingCoupledToGroup()&&!!r.length;t&&(e=[...new Set(e.map(e=>{var t;return null!==(t=this.columnModel.getGroupDisplayColumnForGroup(e.getId()))&&void 0!==t?t:e}))]);const o={};e.forEach((e,t)=>o[e.getId()]=t),e.sort((e,t)=>{const i=e.getSortIndex(),n=t.getSortIndex();if(null!=i&&null!=n)return i-n;if(null==i&&null==n){return o[e.getId()]>o[t.getId()]?1:-1}return null==n?-1:1});const i=new Map;return e.forEach((e,t)=>i.set(e,t)),t&&r.forEach(e=>{const t=this.columnModel.getGroupDisplayColumnForGroup(e.getId());i.set(e,i.get(t))}),i}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([e,t],[i,n])=>t-n).map(([e])=>e)}getSortModel(){return this.getColumnsWithSortingOrdered().map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){const t=this.gridOptionsService.isColumnsSortingCoupledToGroup(),i=!!e.getColDef().showRowGroup;return t&&i}getDisplaySortForColumn(e){const t=this.columnModel.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!(null==t?void 0:t.length))return e.getSort();const i=!!e.getColDef().field?[e,...t]:t,n=i[0].getSort();return i.every(e=>e.getSort()==n)?n:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}};id.DEFAULT_SORTING_ORDER=["asc","desc",null],td([s("columnModel")],id.prototype,"columnModel",void 0),id=ed=td([o("sortController")],id);var nd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let rd=class extends p{setMouseOver(e){this.selectedColumns=e;const t={type:y.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(t)}clearMouseOver(){this.selectedColumns=null;const e={type:y.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(e)}isHovered(e){return!!this.selectedColumns&&this.selectedColumns.indexOf(e)>=0}};rd=nd([o("columnHoverService")],rd);var od=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let sd=class extends p{constructor(){super(...arguments),this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.animationThreadCount=0}postConstruct(){this.ctrlsService.whenReady(e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active}start(){this.active||this.gridOptionsService.is("suppressColumnMoveAnimation")||this.gridOptionsService.is("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0)}finish(){this.active&&(this.flush(),this.active=!1)}executeNextVMTurn(e){this.active?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&this.gridBodyCtrl.setColumnMovingCss(!1)})}flush(){const e=this.executeNextFuncs;this.executeNextFuncs=[];const t=this.executeLaterFuncs;this.executeLaterFuncs=[],0===e.length&&0===t.length||(window.setTimeout(()=>e.forEach(e=>e()),0),window.setTimeout(()=>t.forEach(e=>e()),300))}};od([s("ctrlsService")],sd.prototype,"ctrlsService",void 0),od([r],sd.prototype,"postConstruct",null),sd=od([o("columnAnimationService")],sd);var ad=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let ld=class extends p{postConstruct(){this.ctrlsService.whenReady(e=>{this.centerRowContainerCon=e.centerRowContainerCtrl,this.addManagedListener(this.eventService,y.EVENT_BODY_HEIGHT_CHANGED,this.checkPageSize.bind(this)),this.addManagedListener(this.eventService,y.EVENT_SCROLL_VISIBILITY_CHANGED,this.checkPageSize.bind(this)),this.checkPageSize()})}notActive(){return!this.gridOptionsService.is("paginationAutoPageSize")||null==this.centerRowContainerCon}checkPageSize(){if(this.notActive())return;const i=this.centerRowContainerCon.getViewportSizeFeature().getBodyHeight();if(i>0){const e=()=>{const e=this.gridOptionsService.getRowHeightAsNumber(),t=Math.floor(i/e);this.gridOptionsService.set("paginationPageSize",t)};this.isBodyRendered?Ie(()=>e(),50)():(e(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}};ad([s("ctrlsService")],ld.prototype,"ctrlsService",void 0),ad([r],ld.prototype,"postConstruct",null),ld=ad([o("paginationAutoPageSizeService")],ld);var cd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let ud=class extends p{constructor(){super(...arguments),this.cacheVersion=0}init(){this.active=this.gridOptionsService.is("valueCache"),this.neverExpires=this.gridOptionsService.is("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,i){this.active&&(e.__cacheVersion!==this.cacheVersion&&(e.__cacheVersion=this.cacheVersion,e.__cacheData={}),e.__cacheData[t]=i)}getValue(e,t){if(this.active&&e.__cacheVersion===this.cacheVersion)return e.__cacheData[t]}};cd([r],ud.prototype,"init",null),ud=cd([o("valueCache")],ud);var dd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let hd=class extends p{init(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel),this.addManagedListener(this.eventService,y.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged.bind(this))}onCellValueChanged(e){"paste"!==e.source&&this.doChangeDetection(e.node,e.column)}doChangeDetection(i,n){if(this.gridOptionsService.is("suppressChangeDetection"))return;const r=[i];if(this.clientSideRowModel&&!i.isRowPinned()){const e=this.gridOptionsService.is("aggregateOnlyChangedColumns"),t=new zc(e,this.clientSideRowModel.getRootNode());t.addParentNode(i.parent,[n]),this.clientSideRowModel.doAggregate(t),t.forEachChangedNodeDepthFirst(e=>{r.push(e)})}this.rowRenderer.refreshCells({rowNodes:r})}};dd([s("rowModel")],hd.prototype,"rowModel",void 0),dd([s("rowRenderer")],hd.prototype,"rowRenderer",void 0),dd([r],hd.prototype,"init",null),hd=dd([o("changeDetectionService")],hd);var fd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let pd=class extends p{adaptFunction(e,t){const i=this.componentMetadataProvider.retrieve(e);return i&&i.functionAdapter?i.functionAdapter(t):null}adaptCellRendererFunction(n){return class{refresh(e){return!1}getGui(){return this.eGui}init(e){const t=n(e),i=typeof t;this.eGui="string"!==i&&"number"!==i&&"boolean"!==i?null!=t?t:Un("<span></span>"):Un("<span>"+t+"</span>")}}}doesImplementIComponent(e){return!!e&&(e.prototype&&"getGui"in e.prototype)}};fd([s("componentMetadataProvider")],pd.prototype,"componentMetadataProvider",void 0),pd=fd([o("agComponentUtils")],pd);var gd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let md=class extends p{postConstruct(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[]},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached"]},floatingFilterWrapperComponent:{mandatoryMethodList:[],optionalMethodList:[]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged"]},filterComponent:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]}}}retrieve(e){return this.componentMetaData[e]}};gd([s("agComponentUtils")],md.prototype,"agComponentUtils",void 0),gd([r],md.prototype,"postConstruct",null),md=gd([o("componentMetadataProvider")],md);var vd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};const yd={"ag-theme-custom":{headerHeight:25,headerCellMinWidth:24,listItemHeight:20,rowHeight:25,chartMenuPanelWidth:220},"ag-theme-material":{headerHeight:56,headerCellMinWidth:48,listItemHeight:32,rowHeight:48,chartMenuPanelWidth:240},"ag-theme-balham":{headerHeight:32,headerCellMinWidth:24,listItemHeight:24,rowHeight:28,chartMenuPanelWidth:220},"ag-theme-alpine":{headerHeight:48,headerCellMinWidth:36,listItemHeight:24,rowHeight:42,chartMenuPanelWidth:240}},bd={headerHeight:["ag-header-row"],headerCellMinWidth:["ag-header-cell"],listItemHeight:["ag-virtual-list-item"],rowHeight:["ag-row"],chartMenuPanelWidth:["ag-chart-docked-container"]};let _d=class extends p{constructor(){super(...arguments),this.calculatedSizes={}}postConstruct(){var e;const t=null!==(e=this.getTheme().el)&&void 0!==e?e:this.eGridDiv;this.mutationObserver=new MutationObserver(()=>{this.calculatedSizes={},this.fireGridStylesChangedEvent()}),this.mutationObserver.observe(t||this.eGridDiv,{attributes:!0,attributeFilter:["class"]})}fireGridStylesChangedEvent(){const e={type:y.EVENT_GRID_STYLES_CHANGED};this.eventService.dispatchEvent(e)}getSassVariable(e){const{themeFamily:t,el:i}=this.getTheme();if(!t||0!==t.indexOf("ag-theme"))return;this.calculatedSizes||(this.calculatedSizes={}),this.calculatedSizes[t]||(this.calculatedSizes[t]={});const n=this.calculatedSizes[t][e];return null!=n?n:(this.calculatedSizes[t][e]=this.calculateValueForSassProperty(e,t,i),this.calculatedSizes[t][e])}calculateValueForSassProperty(e,t,i){const n="ag-theme-"+(t.match("material")?"material":t.match("balham")?"balham":t.match("alpine")?"alpine":"custom"),r=yd[n][e],o=this.gridOptionsService.getDocument();if(i||(i=this.eGridDiv),!bd[e])return r;const s=bd[e],a=o.createElement("div"),l=Array.from(i.classList);a.classList.add(t,...l),a.style.position="absolute";const c=s.reduce((e,t)=>{const i=o.createElement("div");return i.style.position="static",i.classList.add(t),e.appendChild(i),i},a);let u=0;if(o.body){o.body.appendChild(a);const t=-1!==e.toLowerCase().indexOf("height")?"height":"width";u=parseInt(window.getComputedStyle(c)[t],10),o.body.removeChild(a)}return u||r}isThemeDark(){const{theme:e}=this.getTheme();return!!e&&e.indexOf("dark")>=0}chartMenuPanelWidth(){return this.getSassVariable("chartMenuPanelWidth")}getTheme(){const e=/\bag-(material|(?:theme-([\w\-]*)))\b/g;let t=this.eGridDiv,i=null,n=[];for(;t;){if(i=e.exec(t.className),i){const i=t.className.match(e);i&&(n=i);break}t=t.parentElement||void 0}if(!i)return{allThemes:n};const r=i[0];return{theme:r,el:t,themeFamily:r.replace(/-dark$/,""),allThemes:n}}getFromTheme(e,t){var i;return null!==(i=this.getSassVariable(t))&&void 0!==i?i:e}getDefaultRowHeight(){return this.getFromTheme(25,"rowHeight")}getListItemHeight(){return this.getFromTheme(20,"listItemHeight")}setRowHeightVariable(e){const t=e+"px";this.eGridDiv.style.getPropertyValue("--ag-line-height").trim()!=t&&this.eGridDiv.style.setProperty("--ag-line-height",t)}getMinColWidth(){const e=this.getFromTheme(null,"headerCellMinWidth");return C(e)?Math.max(e,10):10}destroy(){this.calculatedSizes=null,this.mutationObserver&&this.mutationObserver.disconnect(),super.destroy()}};vd([s("eGridDiv")],_d.prototype,"eGridDiv",void 0),vd([r],_d.prototype,"postConstruct",null),_d=vd([o("environment")],_d);var wd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Cd=function(i,n){return function(e,t){n(e,t,i)}};let xd=class extends p{constructor(){super(...arguments),this.scrollY=0,this.uiBodyHeight=0}agWire(e){this.logger=e.create("RowContainerHeightService")}postConstruct(){this.addManagedListener(this.eventService,y.EVENT_BODY_HEIGHT_CHANGED,this.updateOffset.bind(this)),this.maxDivHeight=sn(),this.logger.log("maxDivHeight = "+this.maxDivHeight)}isStretching(){return this.stretching}getDivStretchOffset(){return this.divStretchOffset}updateOffset(){if(!this.stretching)return;const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;this.logger.log(`Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventService.dispatchEvent({type:y.EVENT_ROW_CONTAINER_HEIGHT_CHANGED}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t="number"==typeof e?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventService.dispatchEvent({type:y.EVENT_HEIGHT_SCALE_CHANGED}))}setModelHeight(e){this.modelHeight=e,this.stretching=null!=e&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getUiContainerHeight(){return this.uiContainerHeight}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=e/(this.modelHeight-this.getUiBodyHeight());return this.maxScrollY*t}};wd([s("ctrlsService")],xd.prototype,"ctrlsService",void 0),wd([Cd(0,ze("loggerFactory"))],xd.prototype,"agWire",null),wd([r],xd.prototype,"postConstruct",null),xd=wd([o("rowContainerHeightService")],xd);var Sd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Ad=class extends p{init(){this.groupSelectsChildren=this.gridOptionsService.is("groupSelectsChildren"),this.isRowSelectableFunc=this.gridOptionsService.get("isRowSelectable")}updateSelectableAfterGrouping(t){if(this.isRowSelectableFunc){const e=e=>e.childrenAfterGroup;this.recurseDown(t.childrenAfterGroup,e)}}recurseDown(e,i){e&&e.forEach(e=>{if(!e.group)return;let t;if(e.hasChildren()&&this.recurseDown(i(e),i),this.groupSelectsChildren){t=C((i(e)||[]).find(e=>!0===e.selectable))}else t=!!this.isRowSelectableFunc&&this.isRowSelectableFunc(e);e.setRowSelectable(t)})}};Sd([r],Ad.prototype,"init",null),Ad=Sd([o("selectableService")],Ad);var Ed=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class Td extends S{constructor(){super(),this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1}postConstruct(){const e=this.gridOptionsService.is("enableRtl");this.setTemplate(this.getTemplate());const{btFirst:t,btPrevious:i,btNext:n,btLast:r}=this;this.activateTabIndex([t,i,n,r]),t.insertAdjacentElement("afterbegin",mr(e?"last":"first",this.gridOptionsService)),i.insertAdjacentElement("afterbegin",mr(e?"next":"previous",this.gridOptionsService)),n.insertAdjacentElement("afterbegin",mr(e?"previous":"next",this.gridOptionsService)),r.insertAdjacentElement("afterbegin",mr(e?"first":"last",this.gridOptionsService)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.onPaginationChanged()}onPaginationChanged(){const e=this.gridOptionsService.is("pagination")&&!this.gridOptionsService.is("suppressPaginationPanel");this.setDisplayed(e),e&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateRowLabels(),this.setCurrentPageLabel(),this.setTotalLabels())}setupListeners(){this.areListenersSetup||(this.addManagedListener(this.eventService,y.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach(e=>{const{el:t,fn:i}=e;this.addManagedListener(t,"click",i),this.addManagedListener(t,"keydown",e=>{e.key!==x.ENTER&&e.key!==x.SPACE||(e.preventDefault(),i())})}),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToFirstPage()}setCurrentPageLabel(){const e=this.paginationProxy.getTotalPages()>0,t=this.paginationProxy.getCurrentPage(),i=e?t+1:0;this.lbCurrent.innerHTML=this.formatNumber(i)}formatNumber(e){const t=this.gridOptionsService.getCallback("paginationNumberFormatter");if(t){return t({value:e})}const i=this.localeService.getLocaleTextFunc();return vn(e,i("thousandSeparator",","),i("decimalSeparator","."))}getTemplate(){const e=this.localeService.getLocaleTextFunc(),t=e("page","Page"),i=e("to","to"),n=e("of","of"),r=e("firstPage","First Page"),o=e("previousPage","Previous Page"),s=e("nextPage","Next Page"),a=e("lastPage","Last Page"),l=this.getCompId();return`<div class="ag-paging-panel ag-unselectable" id="ag-${l}">\n                <span class="ag-paging-row-summary-panel" role="status">\n                    <span id="ag-${l}-first-row" ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-${l}-to">${i}</span>\n                    <span id="ag-${l}-last-row" ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-${l}-of">${n}</span>\n                    <span id="ag-${l}-row-count" ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>\n                </span>\n                <span class="ag-paging-page-summary-panel" role="presentation">\n                    <div ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="${r}"></div>\n                    <div ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="${o}"></div>\n                    <span class="ag-paging-description" role="status">\n                        <span id="ag-${l}-start-page">${t}</span>\n                        <span id="ag-${l}-start-page-number" ref="lbCurrent" class="ag-paging-number"></span>\n                        <span id="ag-${l}-of-page">${n}</span>\n                        <span id="ag-${l}-of-page-number" ref="lbTotal" class="ag-paging-number"></span>\n                    </span>\n                    <div ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="${s}"></div>\n                    <div ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="${a}"></div>\n                </span>\n            </div>`}onBtNext(){this.nextButtonDisabled||this.paginationProxy.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.paginationProxy.goToLastPage()}enableOrDisableButtons(){const e=this.paginationProxy.getCurrentPage(),t=this.paginationProxy.isLastPageFound(),i=this.paginationProxy.getTotalPages();this.previousAndFirstButtonsDisabled=0===e,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const n=this.isZeroPagesToDisplay(),r=t&&e===i-1;this.nextButtonDisabled=r||n,this.lastButtonDisabled=!t||n||e===i-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){Ni(e,t),e.classList.toggle("ag-disabled",t)}updateRowLabels(){const e=this.paginationProxy.getCurrentPage(),t=this.paginationProxy.getPageSize(),i=this.paginationProxy.isLastPageFound(),n=this.paginationProxy.isLastPageFound()?this.paginationProxy.getMasterRowCount():null;let r,o;if(this.isZeroPagesToDisplay()?r=o=0:(r=t*e+1,o=r+t-1,i&&o>n&&(o=n)),this.lbFirstRowOnPage.innerHTML=this.formatNumber(r),this.rowNodeBlockLoader.isLoading()){const e=this.localeService.getLocaleTextFunc();this.lbLastRowOnPage.innerHTML=e("pageLastRowUnknown","?")}else this.lbLastRowOnPage.innerHTML=this.formatNumber(o)}isZeroPagesToDisplay(){const e=this.paginationProxy.isLastPageFound(),t=this.paginationProxy.getTotalPages();return e&&0===t}setTotalLabels(){const e=this.paginationProxy.isLastPageFound(),t=this.paginationProxy.getTotalPages(),i=e?this.paginationProxy.getMasterRowCount():null;if(1===i){const e=this.paginationProxy.getRow(0);if(e&&e.group&&!(e.groupData||e.aggData))return void this.setTotalLabelsToZero()}if(e)this.lbTotal.innerHTML=this.formatNumber(t),this.lbRecordCount.innerHTML=this.formatNumber(i);else{const e=this.localeService.getLocaleTextFunc()("more","more");this.lbTotal.innerHTML=e,this.lbRecordCount.innerHTML=e}}setTotalLabelsToZero(){this.lbFirstRowOnPage.innerHTML=this.formatNumber(0),this.lbCurrent.innerHTML=this.formatNumber(0),this.lbLastRowOnPage.innerHTML=this.formatNumber(0),this.lbTotal.innerHTML=this.formatNumber(0),this.lbRecordCount.innerHTML=this.formatNumber(0)}}Ed([s("paginationProxy")],Td.prototype,"paginationProxy",void 0),Ed([s("rowNodeBlockLoader")],Td.prototype,"rowNodeBlockLoader",void 0),Ed([A("btFirst")],Td.prototype,"btFirst",void 0),Ed([A("btPrevious")],Td.prototype,"btPrevious",void 0),Ed([A("btNext")],Td.prototype,"btNext",void 0),Ed([A("btLast")],Td.prototype,"btLast",void 0),Ed([A("lbRecordCount")],Td.prototype,"lbRecordCount",void 0),Ed([A("lbFirstRowOnPage")],Td.prototype,"lbFirstRowOnPage",void 0),Ed([A("lbLastRowOnPage")],Td.prototype,"lbLastRowOnPage",void 0),Ed([A("lbCurrent")],Td.prototype,"lbCurrent",void 0),Ed([A("lbTotal")],Td.prototype,"lbTotal",void 0),Ed([r],Td.prototype,"postConstruct",null);var Dd,Rd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e[e.Loading=0]="Loading",e[e.NoRows=1]="NoRows"}(Dd||(Dd={}));class Md extends S{constructor(){super(Md.TEMPLATE),this.inProgress=!1,this.destroyRequested=!1,this.manuallyDisplayed=!1}updateLayoutClasses(e,t){const i=this.eOverlayWrapper.classList;i.toggle(ca.AUTO_HEIGHT,t.autoHeight),i.toggle(ca.NORMAL,t.normal),i.toggle(ca.PRINT,t.print)}postConstruct(){this.createManagedBean(new da(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.addManagedListener(this.eventService,y.EVENT_ROW_DATA_UPDATED,this.onRowDataUpdated.bind(this)),this.addManagedListener(this.eventService,y.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.gridOptionsService.isRowModelType("clientSide")&&!this.gridOptionsService.get("rowData")&&this.showLoadingOverlay(),this.gridApi.registerOverlayWrapperComp(this)}setWrapperTypeClass(e){const t=this.eOverlayWrapper.classList;t.toggle("ag-overlay-loading-wrapper",e===Dd.Loading),t.toggle("ag-overlay-no-rows-wrapper",e===Dd.NoRows)}showLoadingOverlay(){if(this.gridOptionsService.is("suppressLoadingOverlay"))return;const e=this.userComponentFactory.getLoadingOverlayCompDetails({}).newAgStackInstance();this.showOverlay(e,Dd.Loading)}showNoRowsOverlay(){if(this.gridOptionsService.is("suppressNoRowsOverlay"))return;const e=this.userComponentFactory.getNoRowsOverlayCompDetails({}).newAgStackInstance();this.showOverlay(e,Dd.NoRows)}showOverlay(e,t){this.inProgress||(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.inProgress=!0,e&&e.then(e=>{this.inProgress=!1,this.eOverlayWrapper.appendChild(e.getGui()),this.activeOverlay=e,this.destroyRequested&&(this.destroyRequested=!1,this.destroyActiveOverlay())}),this.manuallyDisplayed=this.columnModel.isReady()&&!this.paginationProxy.isEmpty(),this.setDisplayed(!0,{skipAriaHidden:!0}))}destroyActiveOverlay(){this.inProgress?this.destroyRequested=!0:this.activeOverlay&&(this.activeOverlay=this.getContext().destroyBean(this.activeOverlay),Vn(this.eOverlayWrapper))}hideOverlay(){this.manuallyDisplayed=!1,this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}destroy(){this.destroyActiveOverlay(),super.destroy()}showOrHideOverlay(){const e=this.paginationProxy.isEmpty(),t=this.gridOptionsService.is("suppressNoRowsOverlay");e&&!t?this.showNoRowsOverlay():this.hideOverlay()}onRowDataUpdated(){this.showOrHideOverlay()}onNewColumnsLoaded(){!this.columnModel.isReady()||this.paginationProxy.isEmpty()||this.manuallyDisplayed||this.hideOverlay()}}Md.TEMPLATE='\n        <div class="ag-overlay" aria-hidden="true">\n            <div class="ag-overlay-panel">\n                <div class="ag-overlay-wrapper" ref="eOverlayWrapper"></div>\n            </div>\n        </div>',Rd([s("userComponentFactory")],Md.prototype,"userComponentFactory",void 0),Rd([s("paginationProxy")],Md.prototype,"paginationProxy",void 0),Rd([s("gridApi")],Md.prototype,"gridApi",void 0),Rd([s("columnModel")],Md.prototype,"columnModel",void 0),Rd([A("eOverlayWrapper")],Md.prototype,"eOverlayWrapper",void 0),Rd([r],Md.prototype,"postConstruct",null);var kd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Od=class extends p{getFirstRow(){let e,t=0;return this.pinnedRowModel.getPinnedTopRowCount()?e="top":this.rowModel.getRowCount()?(e=null,t=this.paginationProxy.getPageFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(e="bottom"),void 0===e?null:{rowIndex:t,rowPinned:e}}getLastRow(){let e,t=null;const i=this.pinnedRowModel.getPinnedBottomRowCount(),n=this.pinnedRowModel.getPinnedTopRowCount();return i?(t="bottom",e=i-1):this.rowModel.getRowCount()?(t=null,e=this.paginationProxy.getPageLastRow()):n&&(t="top",e=n-1),void 0===e?null:{rowIndex:e,rowPinned:t}}getRowNode(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}}sameRow(e,t){return!e&&!t||!(e&&!t||!e&&t)&&(e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned)}before(e,t){switch(e.rowPinned){case"top":if("top"!==t.rowPinned)return!0;break;case"bottom":if("bottom"!==t.rowPinned)return!1;break;default:if(C(t.rowPinned))return"top"!==t.rowPinned}return e.rowIndex<t.rowIndex}rowMax(e){let t;return e.forEach(e=>{(void 0===t||this.before(t,e))&&(t=e)}),t}rowMin(e){let t;return e.forEach(e=>{(void 0===t||this.before(e,t))&&(t=e)}),t}};kd([s("rowModel")],Od.prototype,"rowModel",void 0),kd([s("pinnedRowModel")],Od.prototype,"pinnedRowModel",void 0),kd([s("paginationProxy")],Od.prototype,"paginationProxy",void 0),Od=kd([o("rowPositionUtils")],Od);var Nd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Id=class extends p{createId(e){const{rowIndex:t,rowPinned:i,column:n}=e;return this.createIdFromValues({rowIndex:t,column:n,rowPinned:i})}createIdFromValues(e){const{rowIndex:t,rowPinned:i,column:n}=e;return`${t}.${null==i?"null":i}.${n.getId()}`}equals(e,t){const i=e.column===t.column,n=e.rowPinned===t.rowPinned,r=e.rowIndex===t.rowIndex;return i&&n&&r}};Id=Nd([o("cellPositionUtils")],Id);class Ld{constructor(e){this.cellValueChanges=e}}class Pd extends Ld{constructor(e,t,i,n){super(e),this.initialRange=t,this.finalRange=i,this.ranges=n}}class Fd{constructor(e){this.actionStack=[],this.maxStackSize=e||Fd.DEFAULT_STACK_SIZE,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}}Fd.DEFAULT_STACK_SIZE=10;var Gd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let $d=class extends p{constructor(){super(...arguments),this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.onCellValueChanged=e=>{const t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},i=null!==this.activeCellEdit&&this.cellPositionUtils.equals(this.activeCellEdit,t),n=null!==this.activeRowEdit&&this.rowPositionUtils.sameRow(this.activeRowEdit,t);if(!(i||n||this.isPasting||this.isRangeInAction))return;const{rowPinned:r,rowIndex:o,column:s,oldValue:a,value:l}=e,c={rowPinned:r,rowIndex:o,columnId:s.getColId(),newValue:l,oldValue:a};this.cellValueChanges.push(c)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}init(){if(!this.gridOptionsService.is("undoRedoCellEditing"))return;const e=this.gridOptionsService.getNum("undoRedoCellEditingLimit");e<=0||(this.undoStack=new Fd(e),this.redoStack=new Fd(e),this.addRowEditingListeners(),this.addCellEditingListeners(),this.addPasteListeners(),this.addFillListeners(),this.addCellKeyListeners(),this.addManagedListener(this.eventService,y.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged),this.addManagedListener(this.eventService,y.EVENT_MODEL_UPDATED,e=>{e.keepUndoRedoStack||this.clearStacks()}),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,y.EVENT_NEW_COLUMNS_LOADED,this.clearStacks),this.addManagedListener(this.eventService,y.EVENT_COLUMN_GROUP_OPENED,this.clearStacks),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,y.EVENT_COLUMN_MOVED,this.clearStacks),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PINNED,this.clearStacks),this.addManagedListener(this.eventService,y.EVENT_COLUMN_VISIBLE,this.clearStacks),this.addManagedListener(this.eventService,y.EVENT_ROW_DRAG_END,this.clearStacks),this.ctrlsService.whenReady(()=>{this.gridBodyCtrl=this.ctrlsService.getGridBodyCtrl()}))}getCurrentUndoStackSize(){return this.undoStack?this.undoStack.getCurrentStackSize():0}getCurrentRedoStackSize(){return this.redoStack?this.redoStack.getCurrentStackSize():0}undo(e){const t={type:y.EVENT_UNDO_STARTED,source:e};this.eventService.dispatchEvent(t);const i=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo"),n={type:y.EVENT_UNDO_ENDED,source:e,operationPerformed:i};this.eventService.dispatchEvent(n)}redo(e){const t={type:y.EVENT_REDO_STARTED,source:e};this.eventService.dispatchEvent(t);const i=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo"),n={type:y.EVENT_REDO_ENDED,source:e,operationPerformed:i};this.eventService.dispatchEvent(n)}undoRedo(e,t,i,n,r){if(!e)return!1;const o=e.pop();return!(!o||!o.cellValueChanges)&&(this.processAction(o,e=>e[n],r),o instanceof Pd?this.processRange(o.ranges||[o[i]]):this.processCell(o.cellValueChanges),t.push(o),!0)}processAction(e,s,a){e.cellValueChanges.forEach(e=>{const{rowIndex:t,rowPinned:i,columnId:n}=e,r={rowIndex:t,rowPinned:i},o=this.getRowNode(r);o.displayed&&o.setDataValue(n,s(e),a)})}processRange(o){let s;this.rangeService.removeAllCellRanges(!0),o.forEach((e,t)=>{if(!e)return;const i=e.startRow,n=e.endRow;t===o.length-1&&(s={rowPinned:i.rowPinned,rowIndex:i.rowIndex,columnId:e.startColumn.getColId()},this.setLastFocusedCell(s));const r={rowStartIndex:i.rowIndex,rowStartPinned:i.rowPinned,rowEndIndex:n.rowIndex,rowEndPinned:n.rowPinned,columnStart:e.startColumn,columns:e.columns};this.rangeService.addCellRange(r)})}processCell(e){const t=e[0],{rowIndex:i,rowPinned:n}=t,r={rowIndex:i,rowPinned:n},o=this.getRowNode(r),s={rowPinned:t.rowPinned,rowIndex:o.rowIndex,columnId:t.columnId};this.setLastFocusedCell(s,!!this.rangeService)}setLastFocusedCell(e,t){const{rowIndex:i,columnId:n,rowPinned:r}=e,o=this.gridBodyCtrl.getScrollFeature(),s=this.columnModel.getGridColumn(n);if(!s)return;o.ensureIndexVisible(i),o.ensureColumnVisible(s);const a={rowIndex:i,column:s,rowPinned:r};this.focusService.setFocusedCell(Object.assign(Object.assign({},a),{forceBrowserFocus:!0})),t&&this.rangeService.setRangeToCell(a)}addRowEditingListeners(){this.addManagedListener(this.eventService,y.EVENT_ROW_EDITING_STARTED,e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}}),this.addManagedListener(this.eventService,y.EVENT_ROW_EDITING_STOPPED,()=>{const e=new Ld(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null})}addCellEditingListeners(){this.addManagedListener(this.eventService,y.EVENT_CELL_EDITING_STARTED,e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}}),this.addManagedListener(this.eventService,y.EVENT_CELL_EDITING_STOPPED,e=>{this.activeCellEdit=null;if(e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const e=new Ld(this.cellValueChanges);this.pushActionsToUndoStack(e)}})}addPasteListeners(){this.addManagedListener(this.eventService,y.EVENT_PASTE_START,()=>{this.isPasting=!0}),this.addManagedListener(this.eventService,y.EVENT_PASTE_END,()=>{const e=new Ld(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1})}addFillListeners(){this.addManagedListener(this.eventService,y.EVENT_FILL_START,()=>{this.isRangeInAction=!0}),this.addManagedListener(this.eventService,y.EVENT_FILL_END,e=>{const t=new Pd(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1})}addCellKeyListeners(){this.addManagedListener(this.eventService,y.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,()=>{this.isRangeInAction=!0}),this.addManagedListener(this.eventService,y.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,()=>{let e;e=this.rangeService&&this.gridOptionsService.isEnableRangeSelection()?new Pd(this.cellValueChanges,void 0,void 0,[...this.rangeService.getCellRanges()]):new Ld(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1})}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}getRowNode(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}}};Gd([s("focusService")],$d.prototype,"focusService",void 0),Gd([s("ctrlsService")],$d.prototype,"ctrlsService",void 0),Gd([s("rowModel")],$d.prototype,"rowModel",void 0),Gd([s("pinnedRowModel")],$d.prototype,"pinnedRowModel",void 0),Gd([s("cellPositionUtils")],$d.prototype,"cellPositionUtils",void 0),Gd([s("rowPositionUtils")],$d.prototype,"rowPositionUtils",void 0),Gd([s("columnModel")],$d.prototype,"columnModel",void 0),Gd([c("rangeService")],$d.prototype,"rangeService",void 0),Gd([r],$d.prototype,"init",null),$d=Gd([o("undoRedoService")],$d);var Hd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Bd=class extends p{findHeader(e,t){let i,n,r;if(e.column instanceof g?(n="getDisplayedGroup"+t,i=this.columnModel[n](e.column)):(r="getDisplayedCol"+t,i=this.columnModel[r](e.column)),!i)return;let{headerRowIndex:o}=e;if(this.getHeaderRowType(o)===kl.COLUMN_GROUP){const e=i;if(e.isPadding()&&this.isAnyChildSpanningHeaderHeight(e)){const{nextFocusColumn:n,nextRow:r}=this.getColumnVisibleChild(e,o,t);n&&(i=n,o=r)}}return{column:i,headerRowIndex:o}}isAnyChildSpanningHeaderHeight(e){return!!e&&e.getLeafColumns().some(e=>e.isSpanHeaderHeight())}getColumnVisibleParent(e,t){const i=this.getHeaderRowType(t),n=i===kl.FLOATING_FILTER,r=i===kl.COLUMN;let o=n?e:e.getParent(),s=t-1;if(r&&this.isAnyChildSpanningHeaderHeight(e.getParent())){for(;o&&o.isPadding();)o=o.getParent(),s--;s<0&&(o=e,s=t)}return{nextFocusColumn:o,nextRow:s}}getColumnVisibleChild(i,e,n="After"){let r=i,o=e+1;if(this.getHeaderRowType(e)===kl.COLUMN_GROUP){const e=i.getLeafColumns(),t="After"===n?e[0]:f(e);if(this.isAnyChildSpanningHeaderHeight(t.getParent())){r=t;let e=t.getParent();for(;e&&e!==i;)e=e.getParent(),o++}else r=i.getDisplayedChildren()[0]}return{nextFocusColumn:r,nextRow:o}}getHeaderRowType(e){const t=this.ctrlsService.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}findColAtEdgeForHeaderRow(e,t){const i=this.columnModel.getAllDisplayedColumns(),n=i["start"===t?0:i.length-1];if(!n)return;const r=this.ctrlsService.getHeaderRowContainerCtrl(n.getPinned()).getRowType(e);if(r==kl.COLUMN_GROUP){return{headerRowIndex:e,column:this.columnModel.getColumnGroupAtLevel(n,e)}}return{headerRowIndex:null==r?-1:e,column:n}}};Hd([s("columnModel")],Bd.prototype,"columnModel",void 0),Hd([s("ctrlsService")],Bd.prototype,"ctrlsService",void 0),Bd=Hd([o("headerPositionUtils")],Bd);var Vd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let jd=class{buildColumnDefs(e,o,s){const a=[],l={};return e.forEach(e=>{let t=!0,i=this.createDefFromColumn(e,o,s),n=e.getOriginalParent(),r=null;for(;n;){let e=null;if(n.isPadding()){n=n.getOriginalParent();continue}const o=l[n.getGroupId()];if(o){o.children.push(i),t=!1;break}if(e=this.createDefFromGroup(n),e&&(e.children=[i],l[e.groupId]=e,i=e,n=n.getOriginalParent()),null!=n&&r===n){t=!1;break}r=n}t&&a.push(i)}),a}createDefFromGroup(e){const t=he(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,i){const n=he(e.getColDef());return n.colId=e.getColId(),n.width=e.getActualWidth(),n.rowGroup=e.isRowGroupActive(),n.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,n.pivot=e.isPivotActive(),n.pivotIndex=e.isPivotActive()?i.indexOf(e):null,n.aggFunc=e.isValueActive()?e.getAggFunc():null,n.hide=!e.isVisible()||void 0,n.pinned=e.isPinned()?e.getPinned():null,n.sort=e.getSort()?e.getSort():null,n.sortIndex=null!=e.getSortIndex()?e.getSortIndex():null,n}};jd=Vd([o("columnDefFactory")],jd);var zd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Wd=class{getInitialRowClasses(e){const t=[];return C(e.extraCssClass)&&t.push(e.extraCssClass),t.push("ag-row"),t.push(e.rowFocused?"ag-row-focus":"ag-row-no-focus"),e.fadeRowIn&&t.push("ag-opacity-zero"),t.push(e.rowIsEven?"ag-row-even":"ag-row-odd"),e.rowNode.isRowPinned()&&t.push("ag-row-pinned"),e.rowNode.isSelected()&&t.push("ag-row-selected"),e.rowNode.footer&&t.push("ag-row-footer"),t.push("ag-row-level-"+e.rowLevel),e.rowNode.stub&&t.push("ag-row-loading"),e.fullWidthRow&&t.push("ag-full-width-row"),e.expandable&&(t.push("ag-row-group"),t.push(e.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),e.rowNode.dragging&&t.push("ag-row-dragging"),ft(t,this.processClassesFromGridOptions(e.rowNode)),ft(t,this.preProcessRowClassRules(e.rowNode)),t.push(e.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),e.firstRowOnPage&&t.push("ag-row-first"),e.lastRowOnPage&&t.push("ag-row-last"),e.fullWidthRow&&("left"===e.pinned&&t.push("ag-cell-last-left-pinned"),"right"===e.pinned&&t.push("ag-cell-first-right-pinned")),t}processClassesFromGridOptions(e){const t=[],i=e=>{"string"==typeof e?t.push(e):Array.isArray(e)&&e.forEach(e=>t.push(e))},n=this.gridOptionsService.get("rowClass");if(n){if("function"==typeof n)return console.warn("AG Grid: rowClass should not be a function, please use getRowClass instead"),[];i(n)}const r=this.gridOptionsService.getCallback("getRowClass");if(r){i(r({data:e.data,node:e,rowIndex:e.rowIndex}))}return t}preProcessRowClassRules(e){const t=[];return this.processRowClassRules(e,e=>{t.push(e)},e=>{}),t}processRowClassRules(e,t,i){const n={data:e.data,node:e,rowIndex:e.rowIndex,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};this.stylingService.processClassRules(this.gridOptionsService.get("rowClassRules"),n,t,i)}calculateRowLevel(e){return e.group?e.level:e.parent?e.parent.level+1:0}};zd([s("stylingService")],Wd.prototype,"stylingService",void 0),zd([s("gridOptionsService")],Wd.prototype,"gridOptionsService",void 0),Wd=zd([o("rowCssClassCalculator")],Wd);var Ud=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Yd=class extends p{init(){this.isAccentedSort=this.gridOptionsService.is("accentedSort"),this.primaryColumnsSortGroups=this.gridOptionsService.isColumnsSortingCoupledToGroup(),this.addManagedPropertyListener("accentedSort",e=>this.isAccentedSort=e.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=this.gridOptionsService.isColumnsSortingCoupledToGroup())}doFullSort(e,t){const i=e.map((e,t)=>({currentPos:t,rowNode:e}));return i.sort(this.compareRowNodes.bind(this,t)),i.map(e=>e.rowNode)}compareRowNodes(s,e,a){const l=e.rowNode,c=a.rowNode;for(let o=0,e=s.length;o<e;o++){const a=s[o],e="desc"===a.sort,t=this.getValue(l,a.column),i=this.getValue(c,a.column);let n;const r=this.getComparator(a,l);n=r?r(t,i,l,c,e):Er.defaultComparator(t,i,this.isAccentedSort);if(!isNaN(n)&&0!==n)return"asc"===a.sort?n:-1*n}return e.currentPos-a.currentPos}getComparator(e,t){const i=e.column,n=i.getColDef().comparator;if(null!=n)return n;if(!i.getColDef().showRowGroup)return;const r=!t.group&&i.getColDef().field;if(!r)return;const o=this.columnModel.getPrimaryColumn(r);return o?o.getColDef().comparator:void 0}getValue(t,i){var n,r;if(!this.primaryColumnsSortGroups)return this.valueService.getValue(i,t,!1,!1);if(t.rowGroupColumn===i){if(this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotActive())){if(i.getColDef().keyCreator)return t.key;const r=null===(n=t.allLeafChildren)||void 0===n?void 0:n[0];return r?this.valueService.getValue(i,r,!1,!1):void 0}const e=this.columnModel.getGroupDisplayColumnForGroup(i.getId());if(!e)return;return null===(r=t.groupData)||void 0===r?void 0:r[e.getId()]}return t.group&&i.getColDef().showRowGroup?void 0:this.valueService.getValue(i,t,!1,!1)}};Ud([s("valueService")],Yd.prototype,"valueService",void 0),Ud([s("columnModel")],Yd.prototype,"columnModel",void 0),Ud([r],Yd.prototype,"init",null),Yd=Ud([o("rowNodeSorter")],Yd);var qd,Kd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Xd=qd=class extends p{constructor(){super(...arguments),this.ready=!1,this.readyCallbacks=[]}checkReady(){if(this.ready=null!=this.gridCtrl&&null!=this.gridBodyCtrl&&null!=this.centerRowContainerCtrl&&null!=this.leftRowContainerCtrl&&null!=this.rightRowContainerCtrl&&null!=this.bottomCenterRowContainerCtrl&&null!=this.bottomLeftRowContainerCtrl&&null!=this.bottomRightRowContainerCtrl&&null!=this.topCenterRowContainerCtrl&&null!=this.topLeftRowContainerCtrl&&null!=this.topRightRowContainerCtrl&&null!=this.stickyTopCenterRowContainerCtrl&&null!=this.stickyTopLeftRowContainerCtrl&&null!=this.stickyTopRightRowContainerCtrl&&null!=this.centerHeaderRowContainerCtrl&&null!=this.leftHeaderRowContainerCtrl&&null!=this.rightHeaderRowContainerCtrl&&null!=this.fakeHScrollComp&&null!=this.fakeVScrollComp&&null!=this.gridHeaderCtrl,this.ready){const t=this.createReadyParams();this.readyCallbacks.forEach(e=>e(t)),this.readyCallbacks.length=0}}whenReady(e){this.ready?e(this.createReadyParams()):this.readyCallbacks.push(e)}createReadyParams(){return{centerRowContainerCtrl:this.centerRowContainerCtrl,leftRowContainerCtrl:this.leftRowContainerCtrl,rightRowContainerCtrl:this.rightRowContainerCtrl,bottomCenterRowContainerCtrl:this.bottomCenterRowContainerCtrl,bottomLeftRowContainerCtrl:this.bottomLeftRowContainerCtrl,bottomRightRowContainerCtrl:this.bottomRightRowContainerCtrl,topCenterRowContainerCtrl:this.topCenterRowContainerCtrl,topLeftRowContainerCtrl:this.topLeftRowContainerCtrl,topRightRowContainerCtrl:this.topRightRowContainerCtrl,stickyTopCenterRowContainerCtrl:this.stickyTopCenterRowContainerCtrl,stickyTopLeftRowContainerCtrl:this.stickyTopLeftRowContainerCtrl,stickyTopRightRowContainerCtrl:this.stickyTopRightRowContainerCtrl,centerHeaderRowContainerCtrl:this.centerHeaderRowContainerCtrl,leftHeaderRowContainerCtrl:this.leftHeaderRowContainerCtrl,rightHeaderRowContainerCtrl:this.rightHeaderRowContainerCtrl,fakeHScrollComp:this.fakeHScrollComp,fakeVScrollComp:this.fakeVScrollComp,gridBodyCtrl:this.gridBodyCtrl,gridCtrl:this.gridCtrl,gridHeaderCtrl:this.gridHeaderCtrl}}registerFakeHScrollComp(e){this.fakeHScrollComp=e,this.checkReady()}registerFakeVScrollComp(e){this.fakeVScrollComp=e,this.checkReady()}registerGridHeaderCtrl(e){this.gridHeaderCtrl=e,this.checkReady()}registerCenterRowContainerCtrl(e){this.centerRowContainerCtrl=e,this.checkReady()}registerLeftRowContainerCtrl(e){this.leftRowContainerCtrl=e,this.checkReady()}registerRightRowContainerCtrl(e){this.rightRowContainerCtrl=e,this.checkReady()}registerTopCenterRowContainerCtrl(e){this.topCenterRowContainerCtrl=e,this.checkReady()}registerTopLeftRowContainerCon(e){this.topLeftRowContainerCtrl=e,this.checkReady()}registerTopRightRowContainerCtrl(e){this.topRightRowContainerCtrl=e,this.checkReady()}registerStickyTopCenterRowContainerCtrl(e){this.stickyTopCenterRowContainerCtrl=e,this.checkReady()}registerStickyTopLeftRowContainerCon(e){this.stickyTopLeftRowContainerCtrl=e,this.checkReady()}registerStickyTopRightRowContainerCtrl(e){this.stickyTopRightRowContainerCtrl=e,this.checkReady()}registerBottomCenterRowContainerCtrl(e){this.bottomCenterRowContainerCtrl=e,this.checkReady()}registerBottomLeftRowContainerCtrl(e){this.bottomLeftRowContainerCtrl=e,this.checkReady()}registerBottomRightRowContainerCtrl(e){this.bottomRightRowContainerCtrl=e,this.checkReady()}registerHeaderContainer(e,t){switch(t){case"left":this.leftHeaderRowContainerCtrl=e;break;case"right":this.rightHeaderRowContainerCtrl=e;break;default:this.centerHeaderRowContainerCtrl=e}this.checkReady()}registerGridBodyCtrl(e){this.gridBodyCtrl=e,this.checkReady()}registerGridCtrl(e){this.gridCtrl=e,this.checkReady()}getFakeHScrollComp(){return this.fakeHScrollComp}getFakeVScrollComp(){return this.fakeVScrollComp}getGridHeaderCtrl(){return this.gridHeaderCtrl}getGridCtrl(){return this.gridCtrl}getCenterRowContainerCtrl(){return this.centerRowContainerCtrl}getTopCenterRowContainerCtrl(){return this.topCenterRowContainerCtrl}getBottomCenterRowContainerCtrl(){return this.bottomCenterRowContainerCtrl}getStickyTopCenterRowContainerCtrl(){return this.stickyTopCenterRowContainerCtrl}getGridBodyCtrl(){return this.gridBodyCtrl}getHeaderRowContainerCtrls(){return[this.leftHeaderRowContainerCtrl,this.rightHeaderRowContainerCtrl,this.centerHeaderRowContainerCtrl]}getHeaderRowContainerCtrl(e){switch(e){case"left":return this.leftHeaderRowContainerCtrl;case"right":return this.rightHeaderRowContainerCtrl;default:return this.centerHeaderRowContainerCtrl}}};Xd.NAME="ctrlsService",Xd=qd=Kd([o(qd.NAME)],Xd);var Zd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let Qd=class extends p{constructor(){super(...arguments),this.registry={}}register(e){this.registry[e.controllerName]=e.controllerClass}getInstance(e){const t=this.registry[e];if(null!=t)return new t}};Qd=Zd([o("ctrlsFactory")],Qd);var Jd=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class eh extends S{constructor(e,t){super(e),this.direction=t,this.hideTimeout=null}postConstruct(){this.addManagedListener(this.eventService,y.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",tn()||nn())}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.invisibleScrollbar=dn(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const t=this.getGui();["mouseenter","mousedown","touchstart"].forEach(e=>this.addManagedListener(t,e,()=>this.addOrRemoveCssClass("ag-scrollbar-active",!0))),["mouseleave","touchend"].forEach(e=>this.addManagedListener(t,e,()=>this.addOrRemoveCssClass("ag-scrollbar-active",!1)))}onScrollVisibilityChanged(){void 0===this.invisibleScrollbar&&this.initialiseInvisibleScrollbar(),this.animationFrameService.requestAnimationFrame(()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedListener(this.eventService,y.EVENT_BODY_SCROLL,e=>{e.direction===this.direction&&(null!==this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=null),this.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))}),this.addManagedListener(this.eventService,y.EVENT_BODY_SCROLL_END,()=>{this.hideTimeout=window.setTimeout(()=>{this.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),this.hideTimeout=null},400)})}attemptSettingScrollPosition(e){const t=this.getViewport();Pe(()=>Wn(t),()=>this.setScrollPosition(e),100)}getViewport(){return this.eViewport}getContainer(){return this.eContainer}onScrollCallback(e){this.addManagedListener(this.getViewport(),"scroll",e)}}Jd([A("eViewport")],eh.prototype,"eViewport",void 0),Jd([A("eContainer")],eh.prototype,"eContainer",void 0),Jd([s("scrollVisibleService")],eh.prototype,"scrollVisibleService",void 0),Jd([s("ctrlsService")],eh.prototype,"ctrlsService",void 0),Jd([s("animationFrameService")],eh.prototype,"animationFrameService",void 0);var th=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class ih extends eh{constructor(){super(ih.TEMPLATE,"horizontal")}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedPropertyListener("domLayout",e),this.ctrlsService.registerFakeHScrollComp(this),this.createManagedBean(new Xa(e=>this.eContainer.style.width=e+"px"))}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.enableRtl=this.gridOptionsService.is("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}onPinnedRowDataChanged(){this.refreshCompBottom()}refreshCompBottom(){if(!this.invisibleScrollbar)return;const e=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom=e+"px"}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleService.isVerticalScrollShowing();let t=this.columnModel.getDisplayedColumnsRightWidth();const i=!this.enableRtl&&e,n=this.gridOptionsService.getScrollbarWidth();i&&(t+=n),or(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=n);let r=this.columnModel.getDisplayedColumnsLeftWidth();this.enableRtl&&e&&(r+=n),or(this.eLeftSpacer,r),this.eLeftSpacer.classList.toggle("ag-scroller-corner",r<=n)}setScrollVisible(){const e=this.scrollVisibleService.isHorizontalScrollShowing(),t=this.invisibleScrollbar,i=this.gridOptionsService.is("suppressHorizontalScroll"),n=e&&this.gridOptionsService.getScrollbarWidth()||0,r=i?0:0===n&&t?16:n;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),ar(this.getGui(),r),ar(this.eViewport,r),ar(this.eContainer,r),this.setDisplayed(e,{skipAriaHidden:!0})}getScrollPosition(){return Hn(this.getViewport(),this.enableRtl)}setScrollPosition(e){Wn(this.getViewport())||this.attemptSettingScrollPosition(e),Bn(this.getViewport(),e,this.enableRtl)}}ih.TEMPLATE='<div class="ag-body-horizontal-scroll" aria-hidden="true">\n            <div class="ag-horizontal-left-spacer" ref="eLeftSpacer"></div>\n            <div class="ag-body-horizontal-scroll-viewport" ref="eViewport">\n                <div class="ag-body-horizontal-scroll-container" ref="eContainer"></div>\n            </div>\n            <div class="ag-horizontal-right-spacer" ref="eRightSpacer"></div>\n        </div>',th([A("eLeftSpacer")],ih.prototype,"eLeftSpacer",void 0),th([A("eRightSpacer")],ih.prototype,"eRightSpacer",void 0),th([s("columnModel")],ih.prototype,"columnModel",void 0),th([s("pinnedRowModel")],ih.prototype,"pinnedRowModel",void 0),th([r],ih.prototype,"postConstruct",null);var nh=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let rh=class extends p{postConstruct(){const e=this.checkContainerWidths.bind(this);this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,e),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const e=this.gridOptionsService.isDomLayout("print"),t=e?0:this.columnModel.getDisplayedColumnsLeftWidth(),i=e?0:this.columnModel.getDisplayedColumnsRightWidth();t!=this.leftWidth&&(this.leftWidth=t,this.eventService.dispatchEvent({type:y.EVENT_LEFT_PINNED_WIDTH_CHANGED})),i!=this.rightWidth&&(this.rightWidth=i,this.eventService.dispatchEvent({type:y.EVENT_RIGHT_PINNED_WIDTH_CHANGED}))}getPinnedRightWidth(){return this.rightWidth}getPinnedLeftWidth(){return this.leftWidth}};nh([s("columnModel")],rh.prototype,"columnModel",void 0),nh([r],rh.prototype,"postConstruct",null),rh=nh([o("pinnedWidthService")],rh);var oh=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let sh=class extends p{constructor(){super(...arguments),this.events=[]}postConstruct(){"clientSide"==this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel)}dispatchExpanded(e){if(null==this.clientSideRowModel)return void this.eventService.dispatchEvent(e);this.events.push(e);const t=()=>{this.clientSideRowModel&&this.clientSideRowModel.onRowGroupOpened(),this.events.forEach(e=>this.eventService.dispatchEvent(e)),this.events=[]};null==this.dispatchExpandedDebounced&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce(t)),this.dispatchExpandedDebounced()}};oh([s("animationFrameService")],sh.prototype,"animationFrameService",void 0),oh([s("rowModel")],sh.prototype,"rowModel",void 0),oh([r],sh.prototype,"postConstruct",null),sh=oh([o("rowNodeEventThrottle")],sh);var ah=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},lh=function(i,n){return function(e,t){n(e,t,i)}};function ch(e){return!0===e||"true"===e}let uh=class{constructor(){this.destroyed=!1,this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new qe}get context(){return this.gridOptions.context}agWire(e,t){this.gridOptions.api=e,this.gridOptions.columnApi=t,this.api=e,this.columnApi=t}init(){this.gridOptionLookup=new Set([..._.ALL_PROPERTIES,..._.EVENT_CALLBACKS]);const e=!this.is("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandler.bind(this),e),this.getScrollbarWidth()}destroy(){this.gridOptions.api=null,this.gridOptions.columnApi=null,this.destroyed=!0}is(e){return ch(this.gridOptions[e])}get(e){return this.gridOptions[e]}getNum(e){return"number"==typeof(t=this.gridOptions[e])?t:"string"==typeof t?parseInt(t,10):void 0;var t}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return C(this.gridOptions[e])}mergeGridCommonParams(i){if(i){return e=>{const t=e;return t.api=this.api,t.columnApi=this.columnApi,t.context=this.context,i(t)}}return i}set(t,i,n=!1,r={}){if(this.gridOptionLookup.has(t)){const e=this.gridOptions[t];if(n||e!==i){this.gridOptions[t]=i;const n=Object.assign({type:t,currentValue:i,previousValue:e},r);this.propertyEventService.dispatchEvent(n)}}}addEventListener(e,t){this.propertyEventService.addEventListener(e,t)}removeEventListener(e,t){this.propertyEventService.removeEventListener(e,t)}globalEventHandler(e,t){if(this.destroyed)return;const i=_.getCallbackForEvent(e);"function"==typeof this.gridOptions[i]&&this.gridOptions[i](t)}getGridId(){return this.api.getGridId()}getScrollbarWidth(){if(null==this.scrollbarWidth){const e="number"==typeof this.gridOptions.scrollbarWidth&&this.gridOptions.scrollbarWidth>=0?this.gridOptions.scrollbarWidth:cn();null!=e&&(this.scrollbarWidth=e,this.eventService.dispatchEvent({type:y.EVENT_SCROLLBAR_WIDTH_CHANGED}))}return this.scrollbarWidth}isRowModelType(e){return this.gridOptions.rowModelType===e||"clientSide"===e&&u(this.gridOptions.rowModelType)}isDomLayout(e){var t;return(null!==(t=this.gridOptions.domLayout)&&void 0!==t?t:"normal")===e}isRowSelection(){return"single"===this.gridOptions.rowSelection||"multiple"===this.gridOptions.rowSelection}useAsyncEvents(){return!this.is("suppressAsyncEvents")}isGetRowHeightFunction(){return"function"==typeof this.gridOptions.getRowHeight}getRowHeightForNode(i,n=!1,r){if(null==r&&(r=this.environment.getDefaultRowHeight()),this.isGetRowHeightFunction()){if(n)return{height:r,estimated:!0};const e={node:i,data:i.data},t=this.getCallback("getRowHeight")(e);if(this.isNumeric(t))return 0===t&&l(()=>console.warn("AG Grid: The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead."),"invalidRowHeight"),{height:Math.max(1,t),estimated:!1}}if(i.detail&&this.is("masterDetail"))return this.getMasterDetailRowHeight();return{height:this.gridOptions.rowHeight&&this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:r,estimated:!1}}getMasterDetailRowHeight(){return this.is("detailRowAutoHeight")?{height:1,estimated:!1}:this.isNumeric(this.gridOptions.detailRowHeight)?{height:this.gridOptions.detailRowHeight,estimated:!1}:{height:300,estimated:!1}}getRowHeightAsNumber(){if(!this.gridOptions.rowHeight||u(this.gridOptions.rowHeight))return this.environment.getDefaultRowHeight();const e=this.gridOptions.rowHeight;return e&&this.isNumeric(e)?(this.environment.setRowHeightVariable(e),e):(console.warn("AG Grid row height must be a number if not using standard row model"),this.environment.getDefaultRowHeight())}isNumeric(e){return!isNaN(e)&&"number"==typeof e&&isFinite(e)}getDomDataKey(){return this.domDataKey}getDomData(e,t){const i=e[this.getDomDataKey()];return i?i[t]:void 0}setDomData(e,t,i){const n=this.getDomDataKey();let r=e[n];u(r)&&(r={},e[n]=r),r[t]=i}getDocument(){let e=null;return this.gridOptions.getDocument&&C(this.gridOptions.getDocument)?e=this.gridOptions.getDocument():this.eGridDiv&&(e=this.eGridDiv.ownerDocument),e&&C(e)?e:document}getWindow(){return this.getDocument().defaultView||window}getRootNode(){return this.eGridDiv.getRootNode()}getAsyncTransactionWaitMillis(){return C(this.gridOptions.asyncTransactionWaitMillis)?this.gridOptions.asyncTransactionWaitMillis:50}isAnimateRows(){return!this.is("ensureDomOrder")&&this.is("animateRows")}isGroupRowsSticky(){return!(this.is("suppressGroupRowsSticky")||this.is("paginateChildRows")||this.is("groupHideOpenParents"))}isTreeData(){return this.is("treeData")&&v.__assertRegistered(m.RowGroupingModule,"Tree Data",this.api.getGridId())}isMasterDetail(){return this.is("masterDetail")&&v.__assertRegistered(m.MasterDetailModule,"masterDetail",this.api.getGridId())}isEnableRangeSelection(){return this.is("enableRangeSelection")&&v.__isRegistered(m.RangeSelectionModule,this.api.getGridId())}isColumnsSortingCoupledToGroup(){const e=this.gridOptions.autoGroupColumnDef;return this.isRowModelType("clientSide")&&!(null==e?void 0:e.comparator)&&!this.isTreeData()}getGroupAggFiltering(){const e=this.gridOptions.groupAggFiltering;return"function"==typeof e?this.getCallback("groupAggFiltering"):ch(e)?()=>!0:void 0}isGroupMultiAutoColumn(){return this.gridOptions.groupDisplayType?Jt("multipleColumns",this.gridOptions.groupDisplayType):this.is("groupHideOpenParents")}isGroupUseEntireRow(e){return!e&&(!!this.gridOptions.groupDisplayType&&Jt("groupRows",this.gridOptions.groupDisplayType))}};ah([s("gridOptions")],uh.prototype,"gridOptions",void 0),ah([s("eventService")],uh.prototype,"eventService",void 0),ah([s("environment")],uh.prototype,"environment",void 0),ah([s("eGridDiv")],uh.prototype,"eGridDiv",void 0),ah([lh(0,ze("gridApi")),lh(1,ze("columnApi"))],uh.prototype,"agWire",null),ah([r],uh.prototype,"init",null),ah([Ve],uh.prototype,"destroy",null),uh=ah([o("gridOptionsService")],uh);var dh=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let hh=class extends p{getLocaleTextFunc(){const n=this.gridOptionsService.getCallback("getLocaleText");if(n)return(e,t,i)=>n({key:e,defaultValue:t,variableValues:i});const r=this.gridOptionsService.get("localeText");return(e,t,i)=>{let n=r&&r[e];if(n&&i&&i.length){let e=0;for(;!(e>=i.length);){if(-1===n.indexOf("${variable}"))break;n=n.replace("${variable}",i[e++])}}return null!=n?n:t}}};hh=dh([o("localeService")],hh);var fh=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class ph extends eh{constructor(){super(ph.TEMPLATE,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new Ua(this.eContainer)),this.ctrlsService.registerFakeVScrollComp(this),this.addManagedListener(this.eventService,y.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onRowContainerHeightChanged.bind(this))}setScrollVisible(){const e=this.scrollVisibleService.isVerticalScrollShowing(),t=this.invisibleScrollbar,i=e&&this.gridOptionsService.getScrollbarWidth()||0,n=0===i&&t?16:i;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),or(this.getGui(),n),or(this.eViewport,n),or(this.eContainer,n),this.setDisplayed(e,{skipAriaHidden:!0})}onRowContainerHeightChanged(){const e=this.ctrlsService.getGridBodyCtrl().getBodyViewportElement();this.eViewport.scrollTop!=e.scrollTop&&(this.eViewport.scrollTop=e.scrollTop)}getScrollPosition(){return this.getViewport().scrollTop}setScrollPosition(e){Wn(this.getViewport())||this.attemptSettingScrollPosition(e),this.getViewport().scrollTop=e}}ph.TEMPLATE='<div class="ag-body-vertical-scroll" aria-hidden="true">\n            <div class="ag-body-vertical-scroll-viewport" ref="eViewport">\n                <div class="ag-body-vertical-scroll-container" ref="eContainer"></div>\n            </div>\n        </div>',fh([r],ph.prototype,"postConstruct",null);var gh=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};const mh={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},vh=["january","february","march","april","may","june","july","august","september","october","november","december"];let yh=class extends p{constructor(){super(...arguments),this.dataTypeDefinitions={},this.isWaitingForRowData=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[]}init(){this.groupHideOpenParents=this.gridOptionsService.is("groupHideOpenParents"),this.addManagedPropertyListener("groupHideOpenParents",()=>{this.groupHideOpenParents=this.gridOptionsService.is("groupHideOpenParents")}),this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",()=>{this.processDataTypeDefinitions(),this.columnModel.recreateColumnDefs("gridOptionsChanged")})}processDataTypeDefinitions(){var e;const n=this.getDefaultDataTypes();this.dataTypeDefinitions={},Object.entries(n).forEach(([e,t])=>{this.dataTypeDefinitions[e]=Object.assign(Object.assign({},t),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(t)})});const r=null!==(e=this.gridOptionsService.get("dataTypeDefinitions"))&&void 0!==e?e:{};this.dataTypeMatchers={},Object.entries(r).forEach(([e,t])=>{const i=this.processDataTypeDefinition(t,r,[e],n);i&&(this.dataTypeDefinitions[e]=i,t.dataTypeMatcher&&(this.dataTypeMatchers[e]=t.dataTypeMatcher))}),this.checkObjectValueHandlers(n),["dateString","text","number","boolean","date"].forEach(e=>{const t=this.dataTypeMatchers[e];t&&delete this.dataTypeMatchers[e],this.dataTypeMatchers[e]=null!=t?t:n[e].dataTypeMatcher})}mergeDataTypeDefinitions(e,t){const i=Object.assign(Object.assign({},e),t);return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(i.columnTypes=[...this.convertColumnTypes(e.columnTypes),...this.convertColumnTypes(t.columnTypes)]),i}processDataTypeDefinition(i,n,r,o){let s;const a=i.extendsDataType;if(i.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),i.extendsDataType===i.baseDataType){const n=o[a];if(!this.validateDataTypeDefinition(i,n,a))return;s=this.mergeDataTypeDefinitions(n,i)}else{if(r.includes(a))return void l(()=>console.warn('AG Grid: Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.'),"dataTypeExtendsCircularRef");const e=n[a];if(!this.validateDataTypeDefinition(i,e,a))return;const t=this.processDataTypeDefinition(e,n,[...r,a],o);if(!t)return;s=this.mergeDataTypeDefinitions(t,i)}return Object.assign(Object.assign({},s),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(s)})}validateDataTypeDefinition(e,t,i){return t?t.baseDataType===e.baseDataType||(l(()=>console.warn('AG Grid: The "baseDataType" property of a data type definition must match that of its parent.'),"dataTypeBaseTypesMatch"),!1):(l(()=>console.warn(`AG Grid: The data type definition ${i} does not exist.`),"dataTypeDefMissing"+i),!1)}createGroupSafeValueFormatter(n){if(n.valueFormatter)return e=>{var t,i;if(!(null===(t=e.node)||void 0===t?void 0:t.group))return this.groupHideOpenParents&&e.column.isRowGroupActive()?"string"!=typeof e.value||(null===(i=n.dataTypeMatcher)||void 0===i?void 0:i.call(n,e.value))?n.valueFormatter(e):void 0:n.valueFormatter(e);{const t=e.column.getAggFunc();if(t){if("first"===t||"last"===t)return n.valueFormatter(e);if("number"===n.baseDataType&&"count"!==t){if("number"==typeof e.value)return n.valueFormatter(e);if("object"==typeof e.value){if(!e.value)return;if("toNumber"in e.value)return n.valueFormatter(Object.assign(Object.assign({},e),{value:e.value.toNumber()}));if("value"in e.value)return n.valueFormatter(Object.assign(Object.assign({},e),{value:e.value.value}))}}}}}}updateColDefAndGetDataTypeDefinitionColumnType(e,t,i){let{cellDataType:n}=t;const{field:r}=t;if(void 0===n&&(n=e.cellDataType),null!=n&&!0!==n||(n=!!this.canInferCellDataType(e,t)&&this.inferCellDataType(r,i)),!n)return void(e.cellDataType=!1);const o=this.dataTypeDefinitions[n];if(o)return e.cellDataType=n,o.groupSafeValueFormatter&&(e.valueFormatter=o.groupSafeValueFormatter),o.valueParser&&(e.valueParser=o.valueParser),o.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,o,i),o.columnTypes;l(()=>console.warn(`AG Grid: Missing data type definition - "${n}"`),"dataTypeMissing"+n)}updateColDefAndGetColumnType(e,t,i){var n,r;const o=this.updateColDefAndGetDataTypeDefinitionColumnType(e,t,i),s=null!==(r=null!==(n=t.type)&&void 0!==n?n:o)&&void 0!==r?r:e.type;return e.type=s,s?this.convertColumnTypes(s):void 0}addColumnListeners(e){if(!this.isWaitingForRowData)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const i=e=>{t.add(e.key)};e.addEventListener(d.EVENT_STATE_UPDATED,i),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.removeEventListener(d.EVENT_STATE_UPDATED,i))}canInferCellDataType(i,e){var t;if("clientSide"!==this.rowModel.getType())return!1;const n={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(this.doColDefPropsPreventInference(e,n))return!1;const r=null===e.type?i.type:e.type;if(r){const i=null!==(t=this.gridOptionsService.get("columnTypes"))&&void 0!==t?t:{};if(this.convertColumnTypes(r).some(e=>{const t=i[e.trim()];return t&&this.doColDefPropsPreventInference(t,n)}))return!1}return!this.doColDefPropsPreventInference(i,n)}doColDefPropsPreventInference(i,n){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([e,t])=>this.doesColDefPropPreventInference(i,n,e,t))}doesColDefPropPreventInference(e,t,i,n){if(!t[i])return!1;const r=e[i];return null===r?(t[i]=!1,!1):void 0===n?!!r:r===n}inferCellDataType(e,t){var i;if(!e)return;let n;const r=this.getInitialData();if(r){const t=e.indexOf(".")>=0&&!this.gridOptionsService.is("suppressFieldDotNotation");n=xe(r,e,t)}else this.initWaitForRowData(t);if(null==n)return;const[o]=null!==(i=Object.entries(this.dataTypeMatchers).find(([e,t])=>t(n)))&&void 0!==i?i:["object"];return o}getInitialData(){const e=this.gridOptionsService.get("rowData");if(null==e?void 0:e.length)return e[0];if(this.initialData)return this.initialData;{const e=this.rowModel.getRootNode().allLeafChildren;if(null==e?void 0:e.length)return e[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isWaitingForRowData)return;this.isWaitingForRowData=!0;const i=this.isColumnTypeOverrideInDataTypeDefinitions;i&&this.columnModel.queueResizeOperations();const n=this.addManagedListener(this.eventService,y.EVENT_ROW_DATA_UPDATE_STARTED,e=>{const{firstRowData:t}=e;t&&(null==n||n(),this.isWaitingForRowData=!1,this.processColumnsPendingInference(t,i),this.columnStateUpdatesPendingInference={},i&&this.columnModel.processResizeOperations())})}processColumnsPendingInference(e,o){this.initialData=e;const s=[];this.columnStateUpdateListenerDestroyFuncs.forEach(e=>e()),this.columnStateUpdateListenerDestroyFuncs=[];const a={},l={};Object.entries(this.columnStateUpdatesPendingInference).forEach(([e,t])=>{const i=this.columnModel.getGridColumn(e);if(!i)return;const n=i.getColDef();if(!this.columnModel.resetColumnDefIntoColumn(i))return;const r=i.getColDef();if(o&&r.type&&r.type!==n.type){const o=this.getUpdatedColumnState(i,t);o.rowGroup&&null==o.rowGroupIndex&&(a[e]=o),o.pivot&&null==o.pivotIndex&&(l[e]=o),s.push(o)}}),o&&s.push(...this.columnModel.generateColumnStateForRowGroupAndPivotIndexes(a,l)),s.length&&this.columnModel.applyColumnState({state:s},"cellDataTypeInferred"),this.initialData=null}getUpdatedColumnState(e,t){const i=this.columnModel.getColumnStateFromColDef(e);return t.forEach(e=>{delete i[e],"rowGroup"===e?delete i.rowGroupIndex:"pivot"===e&&delete i.pivotIndex}),i}checkObjectValueHandlers(e){const t=this.dataTypeDefinitions.object,i=e.object;this.hasObjectValueParser=t.valueParser!==i.valueParser,this.hasObjectValueFormatter=t.valueFormatter!==i.valueFormatter}convertColumnTypes(e){let t=[];if(e instanceof Array){e.some(e=>"string"!=typeof e)?console.warn("AG Grid: if colDef.type is supplied an array it should be of type 'string[]'"):t=e}else"string"==typeof e?t=e.split(","):console.warn("AG Grid: colDef.type should be of type 'string' | 'string[]'");return t}getDateStringTypeDefinition(){return this.dataTypeDefinitions.dateString}getDateParserFunction(){return this.getDateStringTypeDefinition().dateParser}getDateFormatterFunction(){return this.getDateStringTypeDefinition().dateFormatter}checkType(e,t){var i;const n=e.getColDef();if(!n.cellDataType||null==t)return!0;const r=null===(i=this.dataTypeDefinitions[n.cellDataType])||void 0===i?void 0:i.dataTypeMatcher;return!r||r(t)}validateColDef(e){"object"===e.cellDataType&&(e.valueFormatter!==this.dataTypeDefinitions.object.groupSafeValueFormatter||this.hasObjectValueFormatter||l(()=>console.warn('AG Grid: Cell data type is "object" but no value formatter has been provided. Please either provide an object data type definition with a value formatter, or set "colDef.valueFormatter"'),"dataTypeObjectValueFormatter"),e.editable&&e.valueParser===this.dataTypeDefinitions.object.valueParser&&!this.hasObjectValueParser&&l(()=>console.warn('AG Grid: Cell data type is "object" but no value parser has been provided. Please either provide an object data type definition with a value parser, or set "colDef.valueParser"'),"dataTypeObjectValueParser"))}setColDefPropertiesForBaseDataType(i,r,s){const a=(e,t,i)=>{let n=e.getColDef().valueFormatter;return n===r.groupSafeValueFormatter&&(n=r.valueFormatter),this.valueFormatterService.formatValue(e,t,i,n)},e=v.__isRegistered(m.SetFilterModule,this.context.getGridId()),n=this.localeService.getLocaleTextFunc(),t=e=>{const{filterParams:t}=i;i.filterParams="object"==typeof t?Object.assign(Object.assign({},t),e):e};switch(i.useValueFormatterForExport=!0,i.useValueParserForImport=!0,r.baseDataType){case"number":i.cellEditor="agNumberCellEditor",e&&t({comparator:(e,t)=>{const i=null==e?0:parseInt(e),n=null==t?0:parseInt(t);return i===n?0:i>n?1:-1}});break;case"boolean":i.cellEditor="agCheckboxCellEditor",i.cellRenderer="agCheckboxCellRenderer",i.suppressKeyboardEvent=e=>!!e.colDef.editable&&e.event.key===x.SPACE,t(e?{valueFormatter:e=>C(e.value)?n(String(e.value),e.value?"True":"False"):n("blanks","(Blanks)")}:{maxNumConditions:1,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(e,t)=>t,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(e,t)=>!1===t,numberOfInputs:0}]});break;case"date":i.cellEditor="agDateCellEditor",i.keyCreator=e=>a(e.column,e.node,e.value),e&&t({valueFormatter:e=>{const t=a(e.column,e.node,e.value);return C(t)?t:n("blanks","(Blanks)")},treeList:!0,treeListFormatter:(e,t)=>{if(1===t&&null!=e){const t=vh[Number(e)-1];return n(t,mh[t])}return null!=e?e:n("blanks","(Blanks)")}});break;case"dateString":{i.cellEditor="agDateStringCellEditor",i.keyCreator=e=>a(e.column,e.node,e.value);const r=this.getDateParserFunction();t(e?{valueFormatter:e=>{const t=a(e.column,e.node,e.value);return C(t)?t:n("blanks","(Blanks)")},treeList:!0,treeListPathGetter:e=>{const t=r(null!=e?e:void 0);return t?[String(t.getFullYear()),String(t.getMonth()+1),String(t.getDate())]:null},treeListFormatter:(e,t)=>{if(1===t&&null!=e){const t=vh[Number(e)-1];return n(t,mh[t])}return null!=e?e:n("blanks","(Blanks)")}}:{comparator:(e,t)=>{const i=r(t);return null==t||i<e?-1:i>e?1:0}});break}case"object":i.cellEditorParams={useFormatter:!0},i.comparator=(e,t)=>{const i=this.columnModel.getPrimaryColumn(s),n=null==i?void 0:i.getColDef();if(!i||!n)return 0;const r=null==e?"":a(i,null,e),o=null==t?"":a(i,null,t);return r===o?0:r>o?1:-1},i.keyCreator=e=>a(e.column,e.node,e.value),e?t({valueFormatter:e=>{const t=a(e.column,e.node,e.value);return C(t)?t:n("blanks","(Blanks)")}}):i.filterValueGetter=e=>a(e.column,e.node,this.valueService.getValue(e.column,e.node))}}getDefaultDataTypes(){const t=e=>!!e.match("^\\d{4}-\\d{2}-\\d{2}$"),i=this.localeService.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:e=>""===e.newValue?null:Number(e.newValue),valueFormatter:e=>null==e.value?"":"number"!=typeof e.value||isNaN(e.value)?i("invalidNumber","Invalid Number"):String(e.value),dataTypeMatcher:e=>"number"==typeof e},text:{baseDataType:"text",valueParser:e=>""===e.newValue?null:te(e.newValue),dataTypeMatcher:e=>"string"==typeof e},boolean:{baseDataType:"boolean",valueParser:e=>""===e.newValue?null:"true"===String(e.newValue).toLowerCase(),valueFormatter:e=>null==e.value?"":String(e.value),dataTypeMatcher:e=>"boolean"==typeof e},date:{baseDataType:"date",valueParser:e=>Sn(null==e.newValue?null:String(e.newValue)),valueFormatter:e=>{var t;return null==e.value?"":e.value instanceof Date&&!isNaN(e.value.getTime())?null!==(t=wn(e.value,!1))&&void 0!==t?t:"":i("invalidDate","Invalid Date")},dataTypeMatcher:e=>e instanceof Date},dateString:{baseDataType:"dateString",dateParser:e=>{var t;return null!==(t=Sn(e))&&void 0!==t?t:void 0},dateFormatter:e=>{var t;return null!==(t=wn(null!=e?e:null,!1))&&void 0!==t?t:void 0},valueParser:e=>t(String(e.newValue))?e.newValue:null,valueFormatter:e=>t(String(e.value))?e.value:"",dataTypeMatcher:e=>"string"==typeof e&&t(e)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:e=>{var t;return null!==(t=te(e.value))&&void 0!==t?t:""}}}}};gh([s("rowModel")],yh.prototype,"rowModel",void 0),gh([s("columnModel")],yh.prototype,"columnModel",void 0),gh([s("columnUtils")],yh.prototype,"columnUtils",void 0),gh([s("valueService")],yh.prototype,"valueService",void 0),gh([s("valueFormatterService")],yh.prototype,"valueFormatterService",void 0),gh([r],yh.prototype,"init",null),yh=gh([o("dataTypeService")],yh);var bh=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let _h=class extends p{parseValue(e,t,i,n){const r=e.getColDef(),o={node:t,data:null==t?void 0:t.data,oldValue:n,newValue:i,colDef:r,column:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context},s=r.valueParser;return C(s)?"function"==typeof s?s(o):this.expressionService.evaluate(s,o):i}};bh([s("expressionService")],_h.prototype,"expressionService",void 0),_h=bh([o("valueParserService")],_h);class wh{constructor(i,e,t){e?(this.gridOptions=e,(new xh).create(i,e,e=>{const t=new Ju(i);e.createBean(t)},void 0,t)):console.error("AG Grid: no gridOptions provided to the grid")}destroy(){this.gridOptions&&this.gridOptions.api&&this.gridOptions.api.destroy()}}let Ch=1;class xh{create(e,t,i,n,r){var o;const s=!!t.debug,a=null!==(o=t.gridId)&&void 0!==o?o:String(Ch++),l=this.getRegisteredModules(r,a),c=this.createBeansList(t.rowModelType,l,a),u=this.createProvidedBeans(e,t,r);if(!c)return;const d={providedBeanInstances:u,beanClasses:c,debug:s,gridId:a},h=new Ku("AG Grid",()=>t.debug),f=new Ku("Context",()=>d.debug),p=new He(d,f),g=p.getBean("beans");this.registerModuleUserComponents(g,l),this.registerStackComponents(g,l),this.registerControllers(g,l),i(p),g.ctrlsService.whenReady(()=>{this.setColumnsAndData(g),this.dispatchGridReadyEvent(g);const e=v.__isRegistered(m.EnterpriseCoreModule,a);h.log("initialised successfully, enterprise = "+e)}),n&&n(p)}registerControllers(t,e){e.forEach(e=>{e.controllers&&e.controllers.forEach(e=>t.ctrlsFactory.register(e))})}registerStackComponents(e,t){const i=this.createAgStackComponentsList(t);e.agStackComponentsRegistry.setupComponents(i)}getRegisteredModules(e,t){const i=e?e.modules:null,n=v.__getRegisteredModules(t),r=[],o={},s=(t,e,i)=>{var n;o[(n=e).moduleName]||(o[n.moduleName]=!0,r.push(n),v.__register(n,t,i)),e.dependantModules&&e.dependantModules.forEach(e=>s(t,e,i))};return i&&i.forEach(e=>s(!0,e,t)),n&&n.forEach(e=>s(!v.__isPackageBased(),e,void 0)),r}registerModuleUserComponents(t,e){this.extractModuleEntity(e,e=>e.userComponents?e.userComponents:[]).forEach(e=>{t.userComponentRegistry.registerDefaultComponent(e.componentName,e.componentClass)})}createProvidedBeans(e,t,i){let n=i?i.frameworkOverrides:null;u(n)&&(n=new Du);const r={gridOptions:t,eGridDiv:e,globalEventListener:i?i.globalEventListener:null,frameworkOverrides:n};return i&&i.providedBeanInstances&&Object.assign(r,i.providedBeanInstances),r}createAgStackComponentsList(e){let t=[{componentName:"AgCheckbox",componentClass:ao},{componentName:"AgRadioButton",componentClass:lo},{componentName:"AgToggleButton",componentClass:eu},{componentName:"AgInputTextField",componentClass:bo},{componentName:"AgInputTextArea",componentClass:tu},{componentName:"AgInputNumberField",componentClass:_o},{componentName:"AgInputDateField",componentClass:iu},{componentName:"AgInputRange",componentClass:nu},{componentName:"AgSelect",componentClass:ro},{componentName:"AgSlider",componentClass:ou},{componentName:"AgGridBody",componentClass:sl},{componentName:"AgHeaderRoot",componentClass:_c},{componentName:"AgSortIndicator",componentClass:No},{componentName:"AgPagination",componentClass:Td},{componentName:"AgOverlayWrapper",componentClass:Md},{componentName:"AgGroupComponent",componentClass:au},{componentName:"AgPanel",componentClass:mu},{componentName:"AgDialog",componentClass:yu},{componentName:"AgRowContainer",componentClass:bl},{componentName:"AgFakeHorizontalScroll",componentClass:ih},{componentName:"AgFakeVerticalScroll",componentClass:ph}];const i=this.extractModuleEntity(e,e=>e.agStackComponents?e.agStackComponents:[]);return t=t.concat(i),t}createBeansList(t="clientSide",e,i){const n=e.filter(e=>!e.rowModel||e.rowModel===t),r={clientSide:m.ClientSideRowModelModule,infinite:m.InfiniteRowModelModule,serverSide:m.ServerSideRowModelModule,viewport:m.ViewportRowModelModule};if(!r[t])return void console.error("AG Grid: could not find row model for rowModelType = "+t);if(!v.__assertRegistered(r[t],`rowModelType = '${t}'`,i))return;const o=[I,Od,Id,Bd,ld,O,Ms,pd,md,Rc,Xs,xd,Cc,hh,Qt,Vc,Js,ai,qe,uh,xu,Pu,oa,ni,mc,Zc,Fc,ju,Rt,Wu,Nu,fl,ud,Hu,qu,oi,Nc,Sc,M,Gu,Ql,dl,_d,Mu,Hc,Jc,ll,id,rd,sd,Ad,It,hd,kc,$d,vi,jd,Wd,Kc,Yd,Xd,rh,sh,Qd,yh,_h],s=this.extractModuleEntity(n,e=>e.beans?e.beans:[]);o.push(...s);const a=[];return o.forEach(e=>{a.indexOf(e)<0&&a.push(e)}),a}extractModuleEntity(e,t){return[].concat(...e.map(t))}setColumnsAndData(e){const t=e.gridOptionsService.get("columnDefs");e.columnModel.setColumnDefs(t||[],"gridInitializing"),e.rowModel.start()}dispatchGridReadyEvent(e){const t={type:y.EVENT_GRID_READY};e.eventService.dispatchEvent(t)}}class Sh{wrap(e,t,i=[],n){const r=this.createWrapper(e,n);return t.forEach(e=>{this.createMethod(r,e,!0)}),i.forEach(e=>{this.createMethod(r,e,!1)}),r}unwrap(e){return e}createMethod(e,t,i){e.addMethod(t,this.createMethodProxy(e,t,i))}createMethodProxy(e,t,i){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(i&&console.warn("AG Grid: Framework component is missing the method "+t+"()"),null)}}}const Ah={columnGroup:["column","stackedColumn","normalizedColumn"],barGroup:["bar","stackedBar","normalizedBar"],pieGroup:["pie","doughnut"],lineGroup:["line"],scatterGroup:["scatter","bubble"],areaGroup:["area","stackedArea","normalizedArea"],histogramGroup:["histogram"],combinationGroup:["columnLineCombo","areaColumnCombo","customCombo"]},Eh=["chartSettings","chartData","chartFormat"],Th=["chartUnlink","chartLink","chartDownload"],Dh={settings:"chartSettings",data:"chartData",format:"chartFormat"},Rh=0;var Mh;!function(e){e.InsideBase="insideBase",e.InsideEnd="insideEnd",e.Center="center",e.OutsideEnd="outsideEnd"}(Mh||(Mh={}));const kh="undefined"==typeof global?{}:global;kh.HTMLElement="undefined"==typeof HTMLElement?{}:HTMLElement,kh.HTMLButtonElement="undefined"==typeof HTMLButtonElement?{}:HTMLButtonElement,kh.HTMLSelectElement="undefined"==typeof HTMLSelectElement?{}:HTMLSelectElement,kh.HTMLInputElement="undefined"==typeof HTMLInputElement?{}:HTMLInputElement,kh.Node="undefined"==typeof Node?{}:Node,kh.MouseEvent="undefined"==typeof MouseEvent?{}:MouseEvent},function(e,t,i){"use strict";i.r(t),i.d(t,"ClientSideRowModelModule",function(){return _});var m=i(0);class a{constructor(e,t,i,n,r,o){this.nextId=0,this.allNodesMap={},this.rootNode=e,this.gridOptionsService=t,this.eventService=i,this.columnModel=n,this.beans=o,this.selectionService=r,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=a.ROOT_NODE_ID,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[],this.postConstruct()}postConstruct(){this.suppressParentsInRowNodes=this.gridOptionsService.is("suppressParentsInRowNodes"),this.isRowMasterFunc=this.gridOptionsService.get("isRowMaster"),this.doingTreeData=this.gridOptionsService.isTreeData(),this.doingMasterDetail=this.gridOptionsService.isMasterDetail()}getCopyOfNodesMap(){return m._.cloneObject(this.allNodesMap)}getRowNode(e){return this.allNodesMap[e]}setRowData(e){if("string"==typeof e)return void console.warn("AG Grid: rowData must be an array, however you passed in a string. If you are loading JSON, make sure you convert the JSON string to JavaScript objects first");this.dispatchRowDataUpdateStartedEvent(e);const t=this.rootNode,i=this.rootNode.sibling;t.childrenAfterFilter=null,t.childrenAfterGroup=null,t.childrenAfterAggFilter=null,t.childrenAfterSort=null,t.childrenMapped=null,t.updateHasChildren(),this.nextId=0,this.allNodesMap={},e?t.allLeafChildren=e.map(e=>this.createNode(e,this.rootNode,a.TOP_LEVEL)):(t.allLeafChildren=[],t.childrenAfterGroup=[]),i&&(i.childrenAfterFilter=t.childrenAfterFilter,i.childrenAfterGroup=t.childrenAfterGroup,i.childrenAfterAggFilter=t.childrenAfterAggFilter,i.childrenAfterSort=t.childrenAfterSort,i.childrenMapped=t.childrenMapped,i.allLeafChildren=t.allLeafChildren)}updateRowData(e,t){this.dispatchRowDataUpdateStartedEvent(e.add);const i={remove:[],update:[],add:[]},n=[];return this.executeRemove(e,i,n),this.executeUpdate(e,i,n),this.executeAdd(e,i),this.updateSelection(n,"rowDataChanged"),t&&m._.sortRowNodesByOrder(this.rootNode.allLeafChildren,t),i}dispatchRowDataUpdateStartedEvent(e){const t={type:m.Events.EVENT_ROW_DATA_UPDATE_STARTED,firstRowData:(null==e?void 0:e.length)?e[0]:null};this.eventService.dispatchEvent(t)}updateSelection(e,t){const i=e.length>0;if(i&&this.selectionService.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),this.selectionService.updateGroupsFromChildrenSelections(t),i){const e={type:m.Events.EVENT_SELECTION_CHANGED,source:t};this.eventService.dispatchEvent(e)}}executeAdd(i,n){var r;const{add:e,addIndex:o}=i;if(m._.missingOrEmpty(e))return;const s=e.map(e=>this.createNode(e,this.rootNode,a.TOP_LEVEL));if("number"==typeof o&&o>=0){const{allLeafChildren:i}=this.rootNode,n=i.length;let t=o;if(this.doingTreeData&&o>0&&n>0)for(let e=0;e<n;e++)if((null===(r=i[e])||void 0===r?void 0:r.rowIndex)==o-1){t=e+1;break}const a=i.slice(0,t),e=i.slice(t,i.length);this.rootNode.allLeafChildren=[...a,...s,...e]}else this.rootNode.allLeafChildren=[...this.rootNode.allLeafChildren,...s];this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren),n.add=s}executeRemove(e,i,n){const{remove:t}=e;if(m._.missingOrEmpty(t))return;const r={};t.forEach(e=>{const t=this.lookupRowNode(e);t&&(t.isSelected()&&n.push(t),t.clearRowTopAndRowIndex(),r[t.id]=!0,delete this.allNodesMap[t.id],i.remove.push(t))}),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren.filter(e=>!r[e.id]),this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren)}executeUpdate(e,i,n){const{update:t}=e;m._.missingOrEmpty(t)||t.forEach(e=>{const t=this.lookupRowNode(e);t&&(t.updateData(e),!t.selectable&&t.isSelected()&&n.push(t),this.setMasterForRow(t,e,a.TOP_LEVEL,!1),i.update.push(t))})}lookupRowNode(t){const i=this.gridOptionsService.getCallback("getRowId");let n;if(i){const e=i({data:t,level:0});if(n=this.allNodesMap[e],!n)return console.error(`AG Grid: could not find row id=${e}, data item was not found for this id`),null}else if(n=this.rootNode.allLeafChildren.find(e=>e.data===t),!n)return console.error("AG Grid: could not find data item as object was not found",t),console.error("Consider using getRowId to help the Grid find matching row data"),null;return n||null}createNode(e,t,i){const n=new m.RowNode(this.beans);return n.group=!1,this.setMasterForRow(n,e,i,!0),t&&!this.suppressParentsInRowNodes&&(n.parent=t),n.level=i,n.setDataAndId(e,this.nextId.toString()),this.allNodesMap[n.id]&&console.warn(`AG Grid: duplicate node id '${n.id}' detected from getRowId callback, this could cause issues in your grid.`),this.allNodesMap[n.id]=n,this.nextId++,n}setMasterForRow(e,t,i,n){if(this.doingTreeData)e.setMaster(!1),n&&(e.expanded=!1);else if(this.doingMasterDetail?this.isRowMasterFunc?e.setMaster(this.isRowMasterFunc(t)):e.setMaster(!0):e.setMaster(!1),n){const t=this.columnModel.getRowGroupColumns(),n=i+(t?t.length:0);e.expanded=!!e.master&&this.isExpanded(n)}}isExpanded(e){const t=this.gridOptionsService.getNum("groupDefaultExpanded");return-1===t||e<t}}a.TOP_LEVEL=0,a.ROOT_NODE_ID="ROOT_NODE_ID";var l,n=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e[e.Normal=0]="Normal",e[e.AfterFilter=1]="AfterFilter",e[e.AfterFilterAndSort=2]="AfterFilterAndSort",e[e.PivotNodes=3]="PivotNodes"}(l||(l={}));let r=class extends m.BeanStub{constructor(){super(...arguments),this.onRowHeightChanged_debounced=m._.debounce(this.onRowHeightChanged.bind(this),100),this.rowsToDisplay=[]}init(){const e=this.refreshModel.bind(this,{step:m.ClientSideRowModelSteps.EVERYTHING}),t=!this.gridOptionsService.is("suppressAnimationFrame"),i=this.refreshModel.bind(this,{step:m.ClientSideRowModelSteps.EVERYTHING,afterColumnsChanged:!0,keepRenderedRows:!0,animate:t});this.addManagedListener(this.eventService,m.Events.EVENT_NEW_COLUMNS_LOADED,i),this.addManagedListener(this.eventService,m.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.addManagedListener(this.eventService,m.Events.EVENT_COLUMN_VALUE_CHANGED,this.onValueChanged.bind(this)),this.addManagedListener(this.eventService,m.Events.EVENT_COLUMN_PIVOT_CHANGED,this.refreshModel.bind(this,{step:m.ClientSideRowModelSteps.PIVOT})),this.addManagedListener(this.eventService,m.Events.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,m.Events.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,m.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,e),this.addManagedListener(this.eventService,m.Events.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanges.bind(this));const n=this.refreshModel.bind(this,{step:m.ClientSideRowModelSteps.MAP,keepRenderedRows:!0,animate:t});this.addManagedPropertyListener("groupRemoveSingleChildren",n),this.addManagedPropertyListener("groupRemoveLowestSingleChildren",n),this.rootNode=new m.RowNode(this.beans),this.nodeManager=new a(this.rootNode,this.gridOptionsService,this.eventService,this.columnModel,this.selectionService,this.beans)}start(){const e=this.gridOptionsService.get("rowData");e&&this.setRowData(e)}ensureRowHeightsValid(r,o,s,a){let l,c=!1;do{l=!1;const e=this.getRowIndexAtPixel(r),t=this.getRowIndexAtPixel(o),i=Math.max(e,s),n=Math.min(t,a);for(let e=i;e<=n;e++){const o=this.getRow(e);if(o.rowHeightEstimated){const r=this.gridOptionsService.getRowHeightForNode(o);o.setRowHeight(r.height),l=!0,c=!0}}l&&this.setRowTopAndRowIndex()}while(l);return c}setRowTopAndRowIndex(){const i=this.environment.getDefaultRowHeight();let n=0;const r=new Set,o=this.gridOptionsService.isDomLayout("normal");for(let t=0;t<this.rowsToDisplay.length;t++){const e=this.rowsToDisplay[t];if(null!=e.id&&r.add(e.id),null==e.rowHeight){const n=this.gridOptionsService.getRowHeightForNode(e,o,i);e.setRowHeight(n.height,n.estimated)}e.setRowTop(n),e.setRowIndex(t),n+=e.rowHeight}return r}clearRowTopAndRowIndex(e,t){const i=e.isActive(),n=e=>{e&&null!=e.id&&!t.has(e.id)&&e.clearRowTopAndRowIndex()},r=t=>{if(n(t),n(t.detailNode),n(t.sibling),t.hasChildren()&&t.childrenAfterGroup){const e=-1==t.level;i&&!e&&!t.expanded||t.childrenAfterGroup.forEach(r)}};r(this.rootNode)}ensureRowsAtPixel(e,t,i=0){const n=this.getRowIndexAtPixel(t),r=this.getRow(n),o=!this.gridOptionsService.is("suppressAnimationFrame");return r!==e[0]&&(e.forEach(e=>{m._.removeFromArray(this.rootNode.allLeafChildren,e)}),e.forEach((e,t)=>{m._.insertIntoArray(this.rootNode.allLeafChildren,e,Math.max(n+i,0)+t)}),this.refreshModel({step:m.ClientSideRowModelSteps.EVERYTHING,keepRenderedRows:!0,keepEditingRows:!0,animate:o}),!0)}highlightRowAtPixel(e,t){const i=null!=t?this.getRowIndexAtPixel(t):null,n=null!=i?this.getRow(i):null;if(!n||!e||n===e||null==t)return void(this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null));const r=this.getHighlightPosition(t,n);this.lastHighlightedRow&&this.lastHighlightedRow!==n&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),n.setHighlighted(r),this.lastHighlightedRow=n}getHighlightPosition(e,t){if(!t){const i=this.getRowIndexAtPixel(e);if(!(t=this.getRow(i||0)))return m.RowHighlightPosition.Below}const{rowTop:i,rowHeight:n}=t;return e-i<n/2?m.RowHighlightPosition.Above:m.RowHighlightPosition.Below}getLastHighlightedRowNode(){return this.lastHighlightedRow}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;const e=this.rootNode.childrenAfterAggFilter;return e?e.length:0}getTopLevelRowDisplayedIndex(e){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return e;let t=this.rootNode.childrenAfterSort[e];if(this.gridOptionsService.is("groupHideOpenParents"))for(;t.expanded&&t.childrenAfterSort&&t.childrenAfterSort.length>0;)t=t.childrenAfterSort[0];return t.rowIndex}getRowBounds(e){if(m._.missing(this.rowsToDisplay))return null;const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){const e=this.gridOptionsService.isAnimateRows();this.refreshModel({step:m.ClientSideRowModelSteps.MAP,keepRenderedRows:!0,animate:e})}onFilterChanged(e){if(e.afterDataChange)return;const t=this.gridOptionsService.isAnimateRows(),i=0===e.columns.length||e.columns.some(e=>e.isPrimary())?m.ClientSideRowModelSteps.FILTER:m.ClientSideRowModelSteps.FILTER_AGGREGATES;this.refreshModel({step:i,keepRenderedRows:!0,animate:t})}onSortChanged(){const e=this.gridOptionsService.isAnimateRows();this.refreshModel({step:m.ClientSideRowModelSteps.SORT,keepRenderedRows:!0,animate:e,keepEditingRows:!0})}getType(){return"clientSide"}onValueChanged(){this.columnModel.isPivotActive()?this.refreshModel({step:m.ClientSideRowModelSteps.PIVOT}):this.refreshModel({step:m.ClientSideRowModelSteps.AGGREGATE})}createChangePath(e){const t=m._.missingOrEmpty(e),i=new m.ChangedPath(!1,this.rootNode);return(t||this.gridOptionsService.isTreeData())&&i.setInactive(),i}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gridOptionsService.is("suppressModelUpdateAfterUpdateTransaction"))return!1;if(null==e.rowNodeTransactions)return!1;const t=e.rowNodeTransactions.filter(e=>null!=e.add&&e.add.length>0||null!=e.remove&&e.remove.length>0);return null==t||0==t.length}buildRefreshModelParams(e){let t=m.ClientSideRowModelSteps.EVERYTHING;const i={everything:m.ClientSideRowModelSteps.EVERYTHING,group:m.ClientSideRowModelSteps.EVERYTHING,filter:m.ClientSideRowModelSteps.FILTER,map:m.ClientSideRowModelSteps.MAP,aggregate:m.ClientSideRowModelSteps.AGGREGATE,sort:m.ClientSideRowModelSteps.SORT,pivot:m.ClientSideRowModelSteps.PIVOT};if(m._.exists(e)&&(t=i[e]),m._.missing(t))return void console.error(`AG Grid: invalid step ${e}, available steps are ${Object.keys(i).join(", ")}`);return{step:t,keepRenderedRows:!0,keepEditingRows:!0,animate:!this.gridOptionsService.is("suppressAnimationFrame")}}refreshModel(e){let t="object"==typeof e&&"step"in e?e:this.buildRefreshModelParams(e);if(!t)return;if(this.isSuppressModelUpdateAfterUpdateTransaction(t))return;const i=this.createChangePath(t.rowNodeTransactions);switch(t.step){case m.ClientSideRowModelSteps.EVERYTHING:this.doRowGrouping(t.groupState,t.rowNodeTransactions,t.rowNodeOrder,i,!!t.afterColumnsChanged);case m.ClientSideRowModelSteps.FILTER:this.doFilter(i);case m.ClientSideRowModelSteps.PIVOT:this.doPivot(i);case m.ClientSideRowModelSteps.AGGREGATE:this.doAggregate(i);case m.ClientSideRowModelSteps.FILTER_AGGREGATES:this.doFilterAggregates(i);case m.ClientSideRowModelSteps.SORT:this.doSort(t.rowNodeTransactions,i);case m.ClientSideRowModelSteps.MAP:this.doRowsToDisplay()}const n=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(i,n);const r={type:m.Events.EVENT_MODEL_UPDATED,animate:t.animate,keepRenderedRows:t.keepRenderedRows,newData:t.newData,newPage:!1,keepUndoRedoStack:t.keepUndoRedoStack};this.eventService.dispatchEvent(r)}isEmpty(){const e=m._.missing(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length;return m._.missing(this.rootNode)||e||!this.columnModel.isReady()}isRowsToRender(){return m._.exists(this.rowsToDisplay)&&this.rowsToDisplay.length>0}getNodesInRangeForSelection(t,i){let n=!i,r=!1;const o=[],s=this.gridOptionsService.is("groupSelectsChildren");return this.forEachNodeAfterFilterAndSort(e=>{if(r)return;if(n&&(e===i||e===t)&&(r=!0,e.group&&s))return void o.push(...e.allLeafChildren);if(!n){if(e!==i&&e!==t)return;n=!0}(!e.group||!s)&&o.push(e)}),o}setDatasource(e){console.error("AG Grid: should never call setDatasource on clientSideRowController")}getTopLevelNodes(){return this.rootNode?this.rootNode.childrenAfterGroup:null}getRootNode(){return this.rootNode}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(t){if(this.isEmpty()||0===this.rowsToDisplay.length)return-1;let i=0,n=this.rowsToDisplay.length-1;if(t<=0)return 0;if(m._.last(this.rowsToDisplay).rowTop<=t)return this.rowsToDisplay.length-1;let r=-1,o=-1;for(;;){const m=Math.floor((i+n)/2),e=this.rowsToDisplay[m];if(this.isRowInPixel(e,t))return m;e.rowTop<t?i=m+1:e.rowTop>t&&(n=m-1);if(r===i&&o===n)return m;r=i,o=n}}isRowInPixel(e,t){const i=e.rowTop,n=e.rowTop+e.rowHeight;return i<=t&&n>t}forEachLeafNode(i){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((e,t)=>i(e,t))}forEachNode(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterGroup||[]],callback:e,recursionType:l.Normal,index:0,includeFooterNodes:t})}forEachNodeAfterFilter(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterAggFilter||[]],callback:e,recursionType:l.AfterFilter,index:0,includeFooterNodes:t})}forEachNodeAfterFilterAndSort(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterSort||[]],callback:e,recursionType:l.AfterFilterAndSort,index:0,includeFooterNodes:t})}forEachPivotNode(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:e,recursionType:l.PivotNodes,index:0,includeFooterNodes:t})}recursivelyWalkNodesAndCallback(e){var t;const{nodes:i,callback:n,recursionType:r,includeFooterNodes:o}=e;let{index:s}=e;const a=i[0];o&&(null===(t=null==a?void 0:a.parent)||void 0===t?void 0:t.sibling)&&i.push(a.parent.sibling);for(let e=0;e<i.length;e++){const t=i[e];if(n(t,s++),t.hasChildren()&&!t.footer){let e=null;switch(r){case l.Normal:e=t.childrenAfterGroup;break;case l.AfterFilter:e=t.childrenAfterAggFilter;break;case l.AfterFilterAndSort:e=t.childrenAfterSort;break;case l.PivotNodes:e=t.leafGroup?null:t.childrenAfterSort}e&&(s=this.recursivelyWalkNodesAndCallback({nodes:[...e],callback:n,recursionType:r,index:s,includeFooterNodes:o}))}}return s}doAggregate(e){this.aggregationStage&&this.aggregationStage.execute({rowNode:this.rootNode,changedPath:e})}doFilterAggregates(e){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:e}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter}expandOrCollapseAll(i){const n=this.gridOptionsService.isTreeData(),r=this.columnModel.isPivotActive(),o=e=>{e&&e.forEach(e=>{const t=()=>{e.expanded=i,o(e.childrenAfterGroup)};if(n){return void(m._.exists(e.childrenAfterGroup)&&t())}if(r){return void(!e.leafGroup&&t())}e.group&&t()})};this.rootNode&&o(this.rootNode.childrenAfterGroup),this.refreshModel({step:m.ClientSideRowModelSteps.MAP});const e=i?"expandAll":"collapseAll",t={type:m.Events.EVENT_EXPAND_COLLAPSE_ALL,source:e};this.eventService.dispatchEvent(t)}doSort(e,t){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,changedPath:t})}doRowGrouping(e,t,i,n,r){if(this.groupStage){if(t?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:t,rowNodeOrder:i,changedPath:n}):(this.groupStage.execute({rowNode:this.rootNode,changedPath:n,afterColumnsChanged:r}),this.restoreGroupState(e)),this.gridOptionsService.is("groupSelectsChildren")){if(this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",n)){const e={type:m.Events.EVENT_SELECTION_CHANGED,source:"rowGroupChanged"};this.eventService.dispatchEvent(e)}}}else this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren,this.rootNode.sibling&&(this.rootNode.sibling.childrenAfterGroup=this.rootNode.childrenAfterGroup),this.rootNode.updateHasChildren()}restoreGroupState(i){i&&m._.traverseNodesWithKey(this.rootNode.childrenAfterGroup,(e,t)=>{"boolean"==typeof i[t]&&(e.expanded=i[t])})}doFilter(e){this.filterStage.execute({rowNode:this.rootNode,changedPath:e})}doPivot(e){this.pivotStage&&this.pivotStage.execute({rowNode:this.rootNode,changedPath:e})}getGroupState(){if(!this.rootNode.childrenAfterGroup||!this.gridOptionsService.is("rememberGroupStateWhenNewData"))return null;const i={};return m._.traverseNodesWithKey(this.rootNode.childrenAfterGroup,(e,t)=>i[t]=e.expanded),i}getCopyOfNodesMap(){return this.nodeManager.getCopyOfNodesMap()}getRowNode(i){if("string"==typeof i&&0==i.indexOf(m.RowNode.ID_PREFIX_ROW_GROUP)){let t=void 0;return this.forEachNode(e=>{e.id===i&&(t=e)}),t}return this.nodeManager.getRowNode(i)}setRowData(e){const t=this.getGroupState();this.nodeManager.setRowData(e),this.selectionService.reset(),this.filterManager.onNewRowsLoaded("rowDataUpdated");const i={type:m.Events.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(i),this.refreshModel({step:m.ClientSideRowModelSteps.EVERYTHING,groupState:t,newData:!0})}batchUpdateRowData(e,t){if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];const e=this.gridOptionsService.getAsyncTransactionWaitMillis();this.applyAsyncTransactionsTimeout=window.setTimeout(()=>{this.executeBatchUpdateRowData()},e)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache.onDataChanged();const i=[],n=[];let r=!1;if(this.rowDataTransactionBatch&&this.rowDataTransactionBatch.forEach(e=>{const t=this.nodeManager.updateRowData(e.rowDataTransaction,void 0);n.push(t),e.callback&&i.push(e.callback.bind(null,t)),"number"==typeof e.rowDataTransaction.addIndex&&(r=!0)}),this.commonUpdateRowData(n,void 0,r),i.length>0&&window.setTimeout(()=>{i.forEach(e=>e())},0),n.length>0){const i={type:m.Events.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:n};this.eventService.dispatchEvent(i)}this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(e,t){this.valueCache.onDataChanged();const i=this.nodeManager.updateRowData(e,t),n="number"==typeof e.addIndex;return this.commonUpdateRowData([i],t,n),i}createRowNodeOrder(){if(this.gridOptionsService.is("suppressMaintainUnsortedOrder"))return;const t={};if(this.rootNode&&this.rootNode.allLeafChildren)for(let e=0;e<this.rootNode.allLeafChildren.length;e++){t[this.rootNode.allLeafChildren[e].id]=e}return t}commonUpdateRowData(e,t,i){const n=!this.gridOptionsService.is("suppressAnimationFrame");i&&(t=this.createRowNodeOrder()),this.refreshModel({step:m.ClientSideRowModelSteps.EVERYTHING,rowNodeTransactions:e,rowNodeOrder:t,keepRenderedRows:!0,keepEditingRows:!0,animate:n}),this.filterManager.onNewRowsLoaded("rowDataUpdated");const r={type:m.Events.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(r)}doRowsToDisplay(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})}onRowHeightChanged(){this.refreshModel({step:m.ClientSideRowModelSteps.MAP,keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}resetRowHeights(){const e=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),e&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let i=!1;return this.forEachNode(e=>{e.setRowHeight(e.rowHeight,!0);const t=e.detailNode;t&&t.setRowHeight(t.rowHeight,!0),i=!0}),i}onGridStylesChanges(){this.columnModel.isAutoRowHeightActive()||this.resetRowHeights()}};n([Object(m.Autowired)("columnModel")],r.prototype,"columnModel",void 0),n([Object(m.Autowired)("selectionService")],r.prototype,"selectionService",void 0),n([Object(m.Autowired)("filterManager")],r.prototype,"filterManager",void 0),n([Object(m.Autowired)("valueCache")],r.prototype,"valueCache",void 0),n([Object(m.Autowired)("beans")],r.prototype,"beans",void 0),n([Object(m.Autowired)("filterStage")],r.prototype,"filterStage",void 0),n([Object(m.Autowired)("sortStage")],r.prototype,"sortStage",void 0),n([Object(m.Autowired)("flattenStage")],r.prototype,"flattenStage",void 0),n([Object(m.Optional)("groupStage")],r.prototype,"groupStage",void 0),n([Object(m.Optional)("aggregationStage")],r.prototype,"aggregationStage",void 0),n([Object(m.Optional)("pivotStage")],r.prototype,"pivotStage",void 0),n([Object(m.Optional)("filterAggregatesStage")],r.prototype,"filterAggregatesStage",void 0),n([m.PostConstruct],r.prototype,"init",null),r=n([Object(m.Bean)("rowModel")],r);var o=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let s=class extends m.BeanStub{execute(e){const{changedPath:t}=e;this.filterService.filter(t)}};o([Object(m.Autowired)("filterService")],s.prototype,"filterService",void 0),s=o([Object(m.Bean)("filterStage")],s);var c=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let u=class extends m.BeanStub{execute(e){const t=this.sortController.getSortOptions(),i=m._.exists(t)&&t.length>0,n=i&&m._.exists(e.rowNodeTransactions)&&this.gridOptionsService.is("deltaSort"),r=t.some(e=>!!this.columnModel.getGroupDisplayColumnForGroup(e.column.getId()));this.sortService.sort(t,i,n,e.rowNodeTransactions,e.changedPath,r)}};c([Object(m.Autowired)("sortService")],u.prototype,"sortService",void 0),c([Object(m.Autowired)("sortController")],u.prototype,"sortController",void 0),c([Object(m.Autowired)("columnModel")],u.prototype,"columnModel",void 0),u=c([Object(m.Bean)("sortStage")],u);var d=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let h=class extends m.BeanStub{execute(e){const t=e.rowNode,i=[],n={value:0},r=this.columnModel.isPivotMode(),o=r&&t.leafGroup,s=o?[t]:t.childrenAfterSort;this.recursivelyAddToRowsToDisplay(s,i,n,r,0);return!o&&i.length>0&&this.gridOptionsService.is("groupIncludeTotalFooter")&&(t.createFooter(),this.addRowNodeToRowsToDisplay(t.sibling,i,n,0)),i}recursivelyAddToRowsToDisplay(l,c,u,d,h){if(m._.missingOrEmpty(l))return;const f=this.gridOptionsService.is("groupHideOpenParents"),p=this.gridOptionsService.is("groupRemoveSingleChildren"),g=!p&&this.gridOptionsService.is("groupRemoveLowestSingleChildren");for(let a=0;a<l.length;a++){const e=l[a],t=e.hasChildren(),i=d&&!t,n=p&&t&&1===e.childrenAfterGroup.length,r=g&&t&&e.leafGroup&&1===e.childrenAfterGroup.length,o=d&&e.leafGroup,s=f&&e.expanded&&!e.master&&!o;if(!(i||s||n||r)&&this.addRowNodeToRowsToDisplay(e,c,u,h),!d||!e.leafGroup)if(t){const l=n||r;if(e.expanded||l){const m=l?h:h+1;this.recursivelyAddToRowsToDisplay(e.childrenAfterSort,c,u,d,m),this.gridOptionsService.is("groupIncludeFooter")&&this.addRowNodeToRowsToDisplay(e.sibling,c,u,m)}}else if(e.master&&e.expanded){const l=this.createDetailNode(e);this.addRowNodeToRowsToDisplay(l,c,u,h)}}}addRowNodeToRowsToDisplay(e,t,i,n){const r=this.gridOptionsService.isGroupMultiAutoColumn();t.push(e),e.setUiLevel(r?0:n)}createDetailNode(e){if(m._.exists(e.detailNode))return e.detailNode;const t=new m.RowNode(this.beans);return t.detail=!0,t.selectable=!1,t.parent=e,m._.exists(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1,e.detailNode=t,t}};d([Object(m.Autowired)("columnModel")],h.prototype,"columnModel",void 0),d([Object(m.Autowired)("beans")],h.prototype,"beans",void 0),h=d([Object(m.Bean)("flattenStage")],h);var f=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let p=class extends m.BeanStub{init(){this.postSortFunc=this.gridOptionsService.getCallback("postSortRows")}sort(i,r,n,e,o,s){const a=this.gridOptionsService.is("groupMaintainOrder"),l=this.columnModel.getAllGridColumns().some(e=>e.isRowGroupActive());let c={};n&&e&&(c=this.calculateDirtyNodes(e));const u=this.columnModel.isPivotMode(),t=e=>{this.pullDownGroupDataForHideOpenParents(e.childrenAfterAggFilter,!0);const t=u&&e.leafGroup;if(a&&l&&!e.leafGroup&&!s){const i=e.childrenAfterAggFilter.slice(0);if(e.childrenAfterSort){const r={};e.childrenAfterSort.forEach((e,t)=>{r[e.id]=t}),i.sort((e,t)=>{var i,n;return(null!==(i=r[e.id])&&void 0!==i?i:0)-(null!==(n=r[t.id])&&void 0!==n?n:0)})}e.childrenAfterSort=i}else e.childrenAfterSort=!r||t?e.childrenAfterAggFilter.slice(0):n?this.doDeltaSort(e,c,o,i):this.rowNodeSorter.doFullSort(e.childrenAfterAggFilter,i);if(e.sibling&&(e.sibling.childrenAfterSort=e.childrenAfterSort),this.updateChildIndexes(e),this.postSortFunc){const i={nodes:e.childrenAfterSort};this.postSortFunc(i)}};o&&o.forEachChangedNodeDepthFirst(t),this.updateGroupDataForHideOpenParents(o)}calculateDirtyNodes(e){const t={},i=e=>{e&&e.forEach(e=>t[e.id]=!0)};return e&&e.forEach(e=>{i(e.add),i(e.update),i(e.remove)}),t}doDeltaSort(e,t,i,n){const r=e.childrenAfterAggFilter,o=e.childrenAfterSort;if(!o)return this.rowNodeSorter.doFullSort(r,n);const s={},a=[];r.forEach(e=>{t[e.id]||!i.canSkip(e)?a.push(e):s[e.id]=!0});const l=o.filter(e=>s[e.id]),c=(e,t)=>({currentPos:t,rowNode:e}),u=a.map(c).sort((e,t)=>this.rowNodeSorter.compareRowNodes(n,e,t));return this.mergeSortedArrays(n,u,l.map(c)).map(({rowNode:e})=>e)}mergeSortedArrays(e,t,i){const n=[];let r=0,o=0;for(;r<t.length&&o<i.length;){this.rowNodeSorter.compareRowNodes(e,t[r],i[o])<0?n.push(t[r++]):n.push(i[o++])}for(;r<t.length;)n.push(t[r++]);for(;o<i.length;)n.push(i[o++]);return n}updateChildIndexes(n){if(m._.missing(n.childrenAfterSort))return;const r=n.childrenAfterSort;for(let i=0;i<r.length;i++){const m=r[i],e=0===i,t=i===n.childrenAfterSort.length-1;m.setFirstChild(e),m.setLastChild(t),m.setChildIndex(i)}}updateGroupDataForHideOpenParents(e){if(!this.gridOptionsService.is("groupHideOpenParents"))return;if(this.gridOptionsService.isTreeData()){const e="AG Grid: The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them (as opposed to Row Grouping, which only has Aggregated Values at the group level).";return m._.doOnce(()=>console.warn(e),"sortService.hideOpenParentsWithTreeData"),!1}const t=e=>{this.pullDownGroupDataForHideOpenParents(e.childrenAfterSort,!1),e.childrenAfterSort.forEach(e=>{e.hasChildren()&&t(e)})};e&&e.executeFromRootNode(e=>t(e))}pullDownGroupDataForHideOpenParents(e,o){this.gridOptionsService.is("groupHideOpenParents")&&!m._.missing(e)&&e.forEach(r=>{this.columnModel.getGroupDisplayColumns().forEach(e=>{const t=e.getColDef().showRowGroup;if("string"!=typeof t)return void console.error("AG Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup");const i=t,n=this.columnModel.getPrimaryColumn(i);if(!(n===r.rowGroupColumn))if(o)r.setGroupValue(e.getId(),void 0);else{const o=r.getFirstChildOfFirstChild(n);o&&r.setGroupValue(e.getId(),o.key)}})})}};f([Object(m.Autowired)("columnModel")],p.prototype,"columnModel",void 0),f([Object(m.Autowired)("rowNodeSorter")],p.prototype,"rowNodeSorter",void 0),f([m.PostConstruct],p.prototype,"init",null),p=f([Object(m.Bean)("sortService")],p);var g=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let v=class extends m.BeanStub{filter(e){const t=this.filterManager.isColumnFilterPresent()||this.filterManager.isQuickFilterPresent()||this.filterManager.isExternalFilterPresent();this.filterNodes(t,e)}filterNodes(o,t){const s=(e,t)=>{e.hasChildren()?e.childrenAfterFilter=o&&!t?e.childrenAfterGroup.filter(e=>{const t=e.childrenAfterFilter&&e.childrenAfterFilter.length>0,i=e.data&&this.filterManager.doesRowPassFilter({rowNode:e});return t||i}):e.childrenAfterGroup:e.childrenAfterFilter=e.childrenAfterGroup,e.sibling&&(e.sibling.childrenAfterFilter=e.childrenAfterFilter)};if(this.doingTreeDataFiltering()){const o=(n,r)=>{if(n.childrenAfterGroup)for(let i=0;i<n.childrenAfterGroup.length;i++){const e=n.childrenAfterGroup[i],t=r||this.filterManager.doesRowPassFilter({rowNode:e});e.childrenAfterGroup?o(n.childrenAfterGroup[i],t):s(e,t)}s(n,r)},e=e=>o(e,!1);t.executeFromRootNode(e)}else{const o=e=>s(e,!1);t.forEachChangedNodeDepthFirst(o,!0)}}doingTreeDataFiltering(){return this.gridOptionsService.isTreeData()&&!this.gridOptionsService.is("excludeChildrenWhenTreeDataFiltering")}};g([Object(m.Autowired)("filterManager")],v.prototype,"filterManager",void 0),v=g([Object(m.Bean)("filterService")],v);var y=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let b=class extends m.BeanStub{postConstruct(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel)}isActive(){const e=this.gridOptionsService.exists("getRowId");return!this.gridOptionsService.is("resetRowDataOnUpdate")&&e}setRowData(e){const t=this.createTransactionForRowData(e);if(!t)return;const[i,n]=t;this.clientSideRowModel.updateRowData(i,n)}createTransactionForRowData(e){if(m._.missing(this.clientSideRowModel))return void console.error("AG Grid: ImmutableService only works with ClientSideRowModel");const r=this.gridOptionsService.getCallback("getRowId");if(null==r)return void console.error("AG Grid: ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!");const o={remove:[],update:[],add:[]},s=this.clientSideRowModel.getCopyOfNodesMap(),a=this.gridOptionsService.is("suppressMaintainUnsortedOrder")?void 0:{};return m._.exists(e)&&e.forEach((e,t)=>{const i=r({data:e,level:0}),n=s[i];if(a&&(a[i]=t),n){n.data!==e&&o.update.push(e),s[i]=void 0}else o.add.push(e)}),m._.iterateObject(s,(e,t)=>{t&&o.remove.push(t.data)}),[o,a]}};y([Object(m.Autowired)("rowModel")],b.prototype,"rowModel",void 0),y([Object(m.Autowired)("rowRenderer")],b.prototype,"rowRenderer",void 0),y([m.PostConstruct],b.prototype,"postConstruct",null),b=y([Object(m.Bean)("immutableService")],b);const _={version:"30.0.6",moduleName:m.ModuleNames.ClientSideRowModelModule,rowModel:"clientSide",beans:[r,s,u,h,p,v,b]}},function(e,t,i){"use strict";i.r(t),i.d(t,"BaseCreator",function(){return n}),i.d(t,"BaseGridSerializingSession",function(){return r}),i.d(t,"CsvCreator",function(){return a}),i.d(t,"CsvExportModule",function(){return d}),i.d(t,"Downloader",function(){return o}),i.d(t,"GridSerializer",function(){return u}),i.d(t,"RowType",function(){return l}),i.d(t,"XmlFactory",function(){return f}),i.d(t,"ZipContainer",function(){return g});class n{setBeans(e){this.beans=e}getFileName(e){const t=this.getDefaultFileExtension();return null!=e&&e.length||(e=this.getDefaultFileName()),-1===e.indexOf(".")?`${e}.${t}`:e}getData(e){const t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}}class r{constructor(e){this.groupColumns=[];const{columnModel:t,valueService:i,gridOptionsService:n,valueFormatterService:r,valueParserService:o,processCellCallback:s,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c}=e;this.columnModel=t,this.valueService=i,this.gridOptionsService=n,this.valueFormatterService=r,this.valueParserService=o,this.processCellCallback=s,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=c}prepare(e){this.groupColumns=e.filter(e=>!!e.getColDef().showRowGroup)}extractHeaderValue(e){const t=this.getHeaderName(this.processHeaderCallback,e);return null!=t?t:""}extractRowCellValue(e,t,i,n,r){const o=this.gridOptionsService.is("groupHideOpenParents")&&!r.footer||!this.shouldRenderGroupSummaryCell(r,e,t)?this.valueService.getValue(e,r):this.createValueForGroupNode(r);return this.processCell({accumulatedRowIndex:i,rowNode:r,column:e,value:o,processCellCallback:this.processCellCallback,type:n})}shouldRenderGroupSummaryCell(e,t,i){var n;if(!(e&&e.group))return!1;if(-1!==this.groupColumns.indexOf(t)){if(null!=(null===(n=e.groupData)||void 0===n?void 0:n[t.getId()]))return!0;if(e.footer&&-1===e.level){const e=t.getColDef();return null==e||!0===e.showRowGroup||e.showRowGroup===this.columnModel.getRowGroupColumns()[0].getId()}}const r=this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotMode());return 0===i&&r}getHeaderName(e,t){return e?e({column:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}):this.columnModel.getDisplayNameForColumn(t,"csv",!0)}createValueForGroupNode(e){if(this.processRowGroupCallback)return this.processRowGroupCallback({node:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context});const t=e.footer,i=[e.key];if(!this.gridOptionsService.isGroupMultiAutoColumn())for(;e.parent;)e=e.parent,i.push(e.key);const n=i.reverse().join(" -> ");return t?"Total "+n:n}processCell(e){var t;const{accumulatedRowIndex:i,rowNode:n,column:r,value:o,processCellCallback:s,type:a}=e;return s?{value:null!==(t=s({accumulatedRowIndex:i,column:r,node:n,value:o,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,type:a,parseValue:e=>this.valueParserService.parseValue(r,n,e,this.valueService.getValue(r,n)),formatValue:e=>{var t;return null!==(t=this.valueFormatterService.formatValue(r,n,e))&&void 0!==t?t:e}}))&&void 0!==t?t:""}:r.getColDef().useValueFormatterForExport?{value:null!=o?o:"",valueFormatted:this.valueFormatterService.formatValue(r,n,o)}:{value:null!=o?o:""}}}var y=i(0);class o{static download(e,t){const i=document.defaultView||window;if(!i)return void console.warn("AG Grid: There is no `window` associated with the current `document`");const n=document.createElement("a"),r=i.URL.createObjectURL(t);n.setAttribute("href",r),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:i})),document.body.removeChild(n),i.setTimeout(()=>{i.URL.revokeObjectURL(r)},0)}}class h extends r{constructor(e){super(e),this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:i}=e;this.suppressQuotes=t,this.columnSeparator=i}addCustomContent(e){e&&("string"==typeof e?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,"\r\n"),this.result+=e):e.forEach(e=>{this.beginNewLine(),e.forEach((e,t)=>{0!==t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(e.data.value||""),e.mergeAcross&&this.appendEmptyCells(e.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,i,n){0!=i&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(n)}appendEmptyCells(t){for(let e=1;e<=t;e++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){0!=t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,i){var n;0!=t&&(this.result+=this.columnSeparator);const r=this.extractRowCellValue(e,t,t,"csv",i);this.result+=this.putInQuotes(null!==(n=r.valueFormatted)&&void 0!==n?n:r.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(null==e)return'""';let t;"string"==typeof e?t=e:"function"==typeof e.toString?t=e.toString():(console.warn("AG Grid: unknown value type during csv conversion"),t="");return'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+="\r\n"),this.isFirstLine=!1}}var s=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let a=class extends n{postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gridOptionsService:this.gridOptionsService})}getMergedParams(e){const t=this.gridOptionsService.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed())return console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration."),"";const t=this.getMergedParams(e),i=this.getData(t),n=new Blob(["\ufeff",i],{type:"text/plain"});return o.download(this.getFileName(t.fileName),n),i}exportDataAsCsv(e){return this.export(e)}getDataAsCsv(e,t=!1){const i=t?Object.assign({},e):this.getMergedParams(e);return this.getData(i)}getDefaultFileName(){return"export.csv"}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{columnModel:t,valueService:i,gridOptionsService:n,valueFormatterService:r,valueParserService:o}=this,{processCellCallback:s,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c,suppressQuotes:u,columnSeparator:d}=e;return new h({columnModel:t,valueService:i,gridOptionsService:n,valueFormatterService:r,valueParserService:o,processCellCallback:s||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:c||void 0,suppressQuotes:u||!1,columnSeparator:d||","})}isExportSuppressed(){return this.gridOptionsService.is("suppressCsvExport")}};s([Object(y.Autowired)("columnModel")],a.prototype,"columnModel",void 0),s([Object(y.Autowired)("valueService")],a.prototype,"valueService",void 0),s([Object(y.Autowired)("gridSerializer")],a.prototype,"gridSerializer",void 0),s([Object(y.Autowired)("gridOptionsService")],a.prototype,"gridOptionsService",void 0),s([Object(y.Autowired)("valueFormatterService")],a.prototype,"valueFormatterService",void 0),s([Object(y.Autowired)("valueParserService")],a.prototype,"valueParserService",void 0),s([y.PostConstruct],a.prototype,"postConstruct",null),a=s([Object(y.Bean)("csvCreator")],a);var l,c=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e[e.HEADER_GROUPING=0]="HEADER_GROUPING",e[e.HEADER=1]="HEADER",e[e.BODY=2]="BODY"}(l||(l={}));let u=class extends y.BeanStub{serialize(e,t={}){const i=this.getColumnsToExport(t.allColumns,t.columnKeys);return y._.compose(this.prepareSession(i),this.prependContent(t),this.exportColumnGroups(t,i),this.exportHeaders(t,i),this.processPinnedTopRows(t,i),this.processRows(t,i),this.processPinnedBottomRows(t,i),this.appendContent(t))(e).parse()}processRow(e,t,i,n){const r=t.shouldRowBeSkipped||(()=>!1),o=this.gridOptionsService.context,s=this.gridOptionsService.api,a=this.gridOptionsService.columnApi,l=this.gridOptionsService.is("groupRemoveSingleChildren"),c=this.gridOptionsService.is("groupRemoveLowestSingleChildren"),u=null!=t.rowPositions||!!t.onlySelected,d=this.gridOptionsService.is("groupHideOpenParents")&&!u,h=this.columnModel.isPivotMode()?n.leafGroup:!n.group,f=!!n.footer,p=t.skipGroups||t.skipRowGroups,g=c&&n.leafGroup,m=1===n.allChildrenCount&&(l||g);if(p&&t.skipGroups&&y._.doOnce(()=>console.warn("AG Grid: Since v25.2 `skipGroups` has been renamed to `skipRowGroups`."),"gridSerializer-skipGroups"),!h&&!f&&(t.skipRowGroups||m||d)||t.onlySelected&&!n.isSelected()||t.skipPinnedTop&&"top"===n.rowPinned||t.skipPinnedBottom&&"bottom"===n.rowPinned)return;if(-1===n.level&&!h&&!f)return;if(r({node:n,api:s,columnApi:a,context:o}))return;const v=e.onNewBodyRow(n);if(i.forEach((e,t)=>{v.onColumn(e,t,n)}),t.getCustomContentBelowRow){const i=t.getCustomContentBelowRow({node:n,api:s,columnApi:a,context:o});i&&e.addCustomContent(i)}}appendContent(i){return e=>{const t=i.customFooter||i.appendContent;return t&&(i.customFooter&&y._.doOnce(()=>console.warn("AG Grid: Since version 25.2.0 the `customFooter` param has been deprecated. Use `appendContent` instead."),"gridSerializer-customFooter"),e.addCustomContent(t)),e}}prependContent(i){return e=>{const t=i.customHeader||i.prependContent;return t&&(i.customHeader&&y._.doOnce(()=>console.warn("AG Grid: Since version 25.2.0 the `customHeader` param has been deprecated. Use `prependContent` instead."),"gridSerializer-customHeader"),e.addCustomContent(t)),e}}prepareSession(t){return e=>(e.prepare(t),e)}exportColumnGroups(n,r){return i=>{if(n.skipColumnGroupHeaders)n.columnGroups&&y._.doOnce(()=>console.warn("AG Grid: Since v25.2 the `columnGroups` param has deprecated, and groups are exported by default."),"gridSerializer-columnGroups");else{const e=new y.GroupInstanceIdCreator,t=this.displayedGroupCreator.createDisplayedGroups(r,this.columnModel.getGridBalancedTree(),e,null);this.recursivelyAddHeaderGroups(t,i,n.processGroupHeaderCallback)}return i}}exportHeaders(i,t){return e=>{if(i.skipHeader||i.skipColumnHeaders)i.skipHeader&&y._.doOnce(()=>console.warn("AG Grid: Since v25.2 the `skipHeader` param has been renamed to `skipColumnHeaders`."),"gridSerializer-skipHeader");else{const i=e.onNewHeaderRow();t.forEach((e,t)=>{i.onColumn(e,t,void 0)})}return e}}processPinnedTopRows(i,n){return e=>{const t=this.processRow.bind(this,e,i,n);return i.rowPositions?i.rowPositions.filter(e=>"top"===e.rowPinned).sort((e,t)=>e.rowIndex-t.rowIndex).map(e=>this.pinnedRowModel.getPinnedTopRow(e.rowIndex)).forEach(t):this.pinnedRowModel.forEachPinnedTopRow(t),e}}processRows(l,c){return e=>{const t=this.rowModel,i=t.getType(),n="clientSide"===i,r="serverSide"===i,o=!n&&l.onlySelected,s=this.processRow.bind(this,e,l,c),{exportedRows:a="filteredAndSorted"}=l;if(l.rowPositions)l.rowPositions.filter(e=>null==e.rowPinned).sort((e,t)=>e.rowIndex-t.rowIndex).map(e=>t.getRow(e.rowIndex)).forEach(s);else if(this.columnModel.isPivotMode())n?t.forEachPivotNode(s,!0):t.forEachNode(s);else if(l.onlySelectedAllPages||o){const l=this.selectionService.getSelectedNodes();this.replicateSortedOrder(l),l.forEach(s)}else"all"===a?t.forEachNode(s):n?t.forEachNodeAfterFilterAndSort(s,!0):r?t.forEachNodeAfterFilterAndSort(s):t.forEachNode(s);return e}}replicateSortedOrder(e){const s=this.sortController.getSortOptions(),a=(e,t)=>{var i,n,r,o;return null!=e.rowIndex&&null!=t.rowIndex?e.rowIndex-t.rowIndex:e.level===t.level?(null===(i=e.parent)||void 0===i?void 0:i.id)===(null===(n=t.parent)||void 0===n?void 0:n.id)?this.rowNodeSorter.compareRowNodes(s,{rowNode:e,currentPos:null!==(r=e.rowIndex)&&void 0!==r?r:-1},{rowNode:t,currentPos:null!==(o=t.rowIndex)&&void 0!==o?o:-1}):a(e.parent,t.parent):e.level>t.level?a(e.parent,t):a(e,t.parent)};e.sort(a)}processPinnedBottomRows(i,n){return e=>{const t=this.processRow.bind(this,e,i,n);return i.rowPositions?i.rowPositions.filter(e=>"bottom"===e.rowPinned).sort((e,t)=>e.rowIndex-t.rowIndex).map(e=>this.pinnedRowModel.getPinnedBottomRow(e.rowIndex)).forEach(t):this.pinnedRowModel.forEachPinnedBottomRow(t),e}}getColumnsToExport(e=!1,t){const i=this.columnModel.isPivotMode();if(t&&t.length)return this.columnModel.getGridColumns(t);if(e&&!i){return(this.gridOptionsService.isTreeData()?this.columnModel.getGridColumns([y.GROUP_AUTO_COLUMN_ID]):[]).concat(this.columnModel.getAllGridColumns()||[])}return this.columnModel.getAllDisplayedColumns()}recursivelyAddHeaderGroups(e,t,i){const n=[];e.forEach(e=>{const t=e;t.getChildren&&t.getChildren().forEach(e=>n.push(e))}),e.length>0&&e[0]instanceof y.ColumnGroup&&this.doAddHeaderHeader(t,e,i),n&&n.length>0&&this.recursivelyAddHeaderGroups(n,t,i)}doAddHeaderHeader(e,t,r){const o=e.onNewHeaderGroupingRow();let s=0;t.forEach(e=>{const t=e;let i;i=r?r({columnGroup:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}):this.columnModel.getDisplayNameForColumnGroup(t,"header");const n=t.getLeafColumns().reduce((e,t,i,n)=>{let r=y._.last(e);return"open"===t.getColumnGroupShow()?r&&null==r[1]||(r=[i],e.push(r)):r&&null==r[1]&&(r[1]=i-1),i===n.length-1&&r&&null==r[1]&&(r[1]=i),e},[]);o.onColumn(t,i||"",s++,t.getLeafColumns().length-1,n)})}};c([Object(y.Autowired)("displayedGroupCreator")],u.prototype,"displayedGroupCreator",void 0),c([Object(y.Autowired)("columnModel")],u.prototype,"columnModel",void 0),c([Object(y.Autowired)("rowModel")],u.prototype,"rowModel",void 0),c([Object(y.Autowired)("pinnedRowModel")],u.prototype,"pinnedRowModel",void 0),c([Object(y.Autowired)("selectionService")],u.prototype,"selectionService",void 0),c([Object(y.Autowired)("rowNodeSorter")],u.prototype,"rowNodeSorter",void 0),c([Object(y.Autowired)("sortController")],u.prototype,"sortController",void 0),u=c([Object(y.Bean)("gridSerializer")],u);const d={version:"30.0.6",moduleName:y.ModuleNames.CsvExportModule,beans:[a,u]};class f{static createHeader(t={}){const e=["version"];t.version||(t.version="1.0"),t.encoding&&e.push("encoding"),t.standalone&&e.push("standalone");return`<?xml ${e.map(e=>`${e}="${t[e]}"`).join(" ")} ?>`}static createXml(t,i){let n="";t.properties&&(t.properties.prefixedAttributes&&t.properties.prefixedAttributes.forEach(t=>{Object.keys(t.map).forEach(e=>{n+=this.returnAttributeIfPopulated(t.prefix+e,t.map[e],i)})}),t.properties.rawMap&&Object.keys(t.properties.rawMap).forEach(e=>{n+=this.returnAttributeIfPopulated(e,t.properties.rawMap[e],i)}));let r="<"+t.name+n;return t.children||null!=t.textNode?null!=t.textNode?r+">"+t.textNode+"</"+t.name+">\r\n":(r+=">\r\n",t.children&&t.children.forEach(e=>{r+=this.createXml(e,i)}),r+"</"+t.name+">\r\n"):r+"/>\r\n"}static returnAttributeIfPopulated(e,t,i){if(!t&&""!==t&&0!==t)return"";let n=t;return"boolean"==typeof t&&i&&(n=i(t)),` ${e}="${n}"`}}const p=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);class g{static addFolders(e){e.forEach(this.addFolder.bind(this))}static addFolder(e){this.folders.push({path:e,created:new Date,isBase64:!1})}static addFile(e,t,i=!1){this.files.push({path:e,created:new Date,content:t,isBase64:i})}static getContent(e="application/zip"){const t=this.buildFileStream(),i=this.buildUint8Array(t);return this.clearStream(),new Blob([i],{type:e})}static clearStream(){this.folders=[],this.files=[]}static buildFileStream(i=""){const n=this.folders.concat(this.files),r=n.length;let o="",s=0,a=0;for(const r of n){const{fileHeader:n,folderHeader:e,content:t}=this.getHeader(r,s);s+=n.length+t.length,a+=e.length,i+=n+t,o+=e}return i+o+this.buildFolderEnd(r,a,s)}static getHeader(e,t){const{content:i,path:n,created:r,isBase64:o}=e,{utf8_encode:s,decToHex:a}=y._,l=s(n),c=l!==n,u=this.convertTime(r),d=this.convertDate(r);let h="";if(c){const e=a(1,1)+a(this.getFromCrc32Table(l),4)+l;h="up"+a(e.length,2)+e}const{size:f,content:p}=i?this.getConvertedContent(i,o):{size:0,content:""},g="\n\0"+(c?"\0\b":"\0\0")+"\0\0"+a(u,2)+a(d,2)+a(f?this.getFromCrc32Table(p):0,4)+a(f,4)+a(f,4)+a(l.length,2)+a(h.length,2);return{fileHeader:"PK"+g+l+h,folderHeader:"PK\0"+g+"\0\0\0\0\0\0"+(i?"\0\0\0\0":"\0\0\0")+a(t,4)+l+h,content:p||""}}static getConvertedContent(e,t=!1){return t&&(e=e.split(";base64,")[1]),{size:(e=t?atob(e):e).length,content:e}}static buildFolderEnd(e,t,i){const{decToHex:n}=y._;return"PK\0\0\0\0"+n(e,2)+n(e,2)+n(t,4)+n(i,4)+"\0\0"}static buildUint8Array(t){const i=new Uint8Array(t.length);for(let e=0;e<i.length;e++)i[e]=t.charCodeAt(e);return i}static getFromCrc32Table(t){if(!t.length)return 0;const i=t.length,n=new Uint8Array(i);for(let e=0;e<i;e++)n[e]=t.charCodeAt(e);let r=-1,o=0,s=0,a=0;for(let e=0;e<i;e++)o=n[e],s=255&(r^o),a=p[s],r=r>>>8^a;return-1^r}static convertTime(e){let t=e.getHours();return t<<=6,t|=e.getMinutes(),t<<=5,t|=e.getSeconds()/2,t}static convertDate(e){let t=e.getFullYear()-1980;return t<<=4,t|=e.getMonth()+1,t<<=5,t|=e.getDate(),t}}g.folders=[],g.files=[]},function(e,t,i){"use strict";i.r(t),i.d(t,"InfiniteRowModelModule",function(){return d});var l=i(0),n=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};class o extends l.RowNodeBlock{constructor(e,t,i){super(e),this.parentCache=t,this.params=i,this.startRow=e*i.blockSize,this.endRow=this.startRow+i.blockSize}postConstruct(){this.createRowNodes()}getBlockStateJson(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}}setDataAndId(e,t,i){l._.exists(t)?e.setDataAndId(t,i.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){const e=this.createLoadParams();l._.missing(this.params.datasource.getRows)?console.warn("AG Grid: datasource is missing getRows method"):window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}processServerFail(){}createLoadParams(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gridOptionsService.context}}forEachNode(i,n,r){this.rowNodes.forEach((e,t)=>{this.startRow+t<r&&i(e,n.next())})}getLastAccessed(){return this.lastAccessed}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.next());const i=e-this.startRow;return this.rowNodes[i]}getStartRow(){return this.startRow}getEndRow(){return this.endRow}createRowNodes(){this.rowNodes=[];for(let i=0;i<this.params.blockSize;i++){const e=this.startRow+i,t=new l.RowNode(this.beans);t.setRowHeight(this.params.rowHeight),t.uiLevel=0,t.setRowIndex(e),t.setRowTop(this.params.rowHeight*e),this.rowNodes.push(t)}}processServerResult(n){this.rowNodes.forEach((e,t)=>{const i=n.rowData?n.rowData[t]:void 0;!e.id&&e.alreadyRendered&&i&&(this.rowNodes[t]=new l.RowNode(this.beans),this.rowNodes[t].setRowIndex(e.rowIndex),this.rowNodes[t].setRowTop(e.rowTop),e.clearRowTopAndRowIndex()),this.setDataAndId(this.rowNodes[t],i,this.startRow+t)});const e=null!=n.rowCount&&n.rowCount>=0?n.rowCount:void 0;this.parentCache.pageLoaded(this,e)}destroyRowNodes(){this.rowNodes.forEach(e=>{e.clearRowTopAndRowIndex()})}}n([Object(l.Autowired)("beans")],o.prototype,"beans",void 0),n([l.PostConstruct],o.prototype,"postConstruct",null),n([l.PreDestroy],o.prototype,"destroyRowNodes",null);var r=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=function(i,n){return function(e,t){n(e,t,i)}};class a extends l.BeanStub{constructor(e){super(),this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount,this.params=e}setBeans(e){this.logger=e.create("InfiniteCache")}getRow(e,t=!1){const i=Math.floor(e/this.params.blockSize);let n=this.blocks[i];if(!n){if(t)return;n=this.createBlock(i)}return n.getRow(e)}createBlock(e){const t=this.createBean(new o(e,this,this.params));return this.blocks[t.getId()]=t,this.blockCount++,this.purgeBlocksIfNeeded(t),this.params.rowNodeBlockLoader.addBlock(t),t}refreshCache(){0==this.blockCount?this.purgeCache():(this.getBlocksInOrder().forEach(e=>e.setStateWaitingToLoad()),this.params.rowNodeBlockLoader.checkBlockToLoad())}destroyAllBlocks(){this.getBlocksInOrder().forEach(e=>this.destroyBlock(e))}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(this.logger.log(`onPageLoaded: page = ${e.getId()}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(t){const e=this.getBlocksInOrder().filter(e=>e!=t);e.sort((e,t)=>t.getLastAccessed()-e.getLastAccessed());const i=this.params.maxBlocksInCache>0,n=i?this.params.maxBlocksInCache-1:null,r=a.MAX_EMPTY_BLOCKS_TO_KEEP-1;e.forEach((e,t)=>{if(e.getState()===o.STATE_WAITING_TO_LOAD&&t>=r||!!i&&t>=n){if(this.isBlockCurrentlyDisplayed(e))return;if(this.isBlockFocused(e))return;this.removeBlockFromCache(e)}})}isBlockFocused(e){const t=this.focusService.getFocusCellToUseAfterRefresh();if(!t)return!1;if(null!=t.rowPinned)return!1;const i=e.getStartRow(),n=e.getEndRow();return t.rowIndex>=i&&t.rowIndex<n}isBlockCurrentlyDisplayed(e){const t=e.getStartRow(),i=e.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(t,i)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if("number"==typeof t&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const t=(e.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<t&&(this.rowCount=t)}}setRowCount(e,t){this.rowCount=e,l._.exists(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize==0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(t){const i=new l.NumberSequence;this.getBlocksInOrder().forEach(e=>e.forEachNode(t,i,this.rowCount))}getBlocksInOrder(){return l._.getAllValuesInObject(this.blocks).sort((e,t)=>e.getId()-t.getId())}destroyBlock(e){delete this.blocks[e.getId()],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){if(this.isAlive()){this.destroyAllBlocksPastVirtualRowCount();const e={type:l.Events.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(e)}}destroyAllBlocksPastVirtualRowCount(){const t=[];this.getBlocksInOrder().forEach(e=>{e.getId()*this.params.blockSize>=this.rowCount&&t.push(e)}),t.length>0&&t.forEach(e=>this.destroyBlock(e))}purgeCache(){this.getBlocksInOrder().forEach(e=>this.removeBlockFromCache(e)),this.lastRowIndexKnown=!1,0===this.rowCount&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(i,n){const r=[];let t=-1,o=!1;const s=new l.NumberSequence;l._.missing(i)&&(o=!0);let a=!1;this.getBlocksInOrder().forEach(e=>{a||(o&&t+1!==e.getId()?a=!0:(t=e.getId(),e.forEachNode(e=>{const t=e===i||e===n;(o||t)&&r.push(e),t&&(o=!o)},s,this.rowCount)))});return a||o?[]:r}}a.MAX_EMPTY_BLOCKS_TO_KEEP=2,r([Object(l.Autowired)("rowRenderer")],a.prototype,"rowRenderer",void 0),r([Object(l.Autowired)("focusService")],a.prototype,"focusService",void 0),r([s(0,Object(l.Qualifier)("loggerFactory"))],a.prototype,"setBeans",null),r([l.PreDestroy],a.prototype,"destroyAllBlocks",null);var c=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};let u=class extends l.BeanStub{getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(e,t,i,n){return!1}init(){this.gridOptionsService.isRowModelType("infinite")&&(this.rowHeight=this.gridOptionsService.getRowHeightAsNumber(),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache()),this.verifyProps())}verifyProps(){if(this.gridOptionsService.exists("initialGroupOrderComparator")){const e="AG Grid: initialGroupOrderComparator cannot be used with Infinite Row Model. If using Infinite Row Model, then sorting is done on the server side, nothing to do with the client.";l._.doOnce(()=>console.warn(e),"IRM.InitialGroupOrderComparator")}}start(){this.setDatasource(this.gridOptionsService.get("datasource"))}destroyDatasource(){this.datasource&&(this.getContext().destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedListener(this.eventService,l.Events.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,l.Events.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,l.Events.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,l.Events.EVENT_STORE_UPDATED,this.onCacheUpdated.bind(this))}onFilterChanged(){this.reset()}onSortChanged(){this.reset()}onColumnEverything(){let e;e=!this.cacheParams||this.isSortModelDifferent(),e&&this.reset()}isSortModelDifferent(){return!l._.jsonEquals(this.cacheParams.sortModel,this.sortController.getSortModel())}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(e,t):[]}reset(){if(!this.datasource)return;null!=this.gridOptionsService.getCallback("getRowId")||this.selectionService.reset(),this.resetCache();const e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}createModelUpdatedEvent(){return{type:l.Events.EVENT_MODEL_UPDATED,newPage:!1,newData:!1,keepRenderedRows:!0,animate:!1}}resetCache(){this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.defaultIfInvalid(this.gridOptionsService.getNum("infiniteInitialRowCount"),1),maxBlocksInCache:this.gridOptionsService.getNum("maxBlocksInCache"),rowHeight:this.gridOptionsService.getRowHeightAsNumber(),overflowSize:this.defaultIfInvalid(this.gridOptionsService.getNum("cacheOverflowSize"),1),blockSize:this.defaultIfInvalid(this.gridOptionsService.getNum("cacheBlockSize"),100),lastAccessedSequence:new l.NumberSequence},this.infiniteCache=this.createBean(new a(this.cacheParams))}defaultIfInvalid(e,t){return e>0?e:t}destroyCache(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))}onCacheUpdated(){const e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}getRow(e){if(this.infiniteCache&&!(e>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(e)}getRowNode(t){let i;return this.forEachNode(e=>{e.id===t&&(i=e)}),i}forEachNode(e){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(i){if(0!==this.rowHeight){const e=Math.floor(i/this.rowHeight),t=this.getRowCount()-1;return e>t?t:e}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache&&this.infiniteCache.refreshCache()}purgeCache(){this.infiniteCache&&this.infiniteCache.purgeCache()}isLastRowIndexKnown(){return!!this.infiniteCache&&this.infiniteCache.isLastRowIndexKnown()}setRowCount(e,t){this.infiniteCache&&this.infiniteCache.setRowCount(e,t)}};c([Object(l.Autowired)("filterManager")],u.prototype,"filterManager",void 0),c([Object(l.Autowired)("sortController")],u.prototype,"sortController",void 0),c([Object(l.Autowired)("selectionService")],u.prototype,"selectionService",void 0),c([Object(l.Autowired)("rowRenderer")],u.prototype,"rowRenderer",void 0),c([Object(l.Autowired)("rowNodeBlockLoader")],u.prototype,"rowNodeBlockLoader",void 0),c([l.PostConstruct],u.prototype,"init",null),c([l.PreDestroy],u.prototype,"destroyDatasource",null),u=c([Object(l.Bean)("rowModel")],u);const d={version:"30.0.6",moduleName:l.ModuleNames.InfiniteRowModelModule,rowModel:"infinite",beans:[u]}},function(e,t,i){var n=i(1),r=(i(0),i(2)),o=i(3),s=i(5);Object.keys(s).forEach(function(e){t[e]=s[e]}),s.ModuleRegistry.register(n.ClientSideRowModelModule),s.ModuleRegistry.register(r.CsvExportModule),s.ModuleRegistry.register(o.InfiniteRowModelModule),s.ModuleRegistry.__setIsBundled()},function(e,t,i){"use strict";i.r(t),i.d(t,"AllCommunityModules",function(){return a});var n=i(1),r=i(3),o=i(2);i.d(t,"ClientSideRowModelModule",function(){return n.ClientSideRowModelModule}),i.d(t,"BaseCreator",function(){return o.BaseCreator}),i.d(t,"BaseGridSerializingSession",function(){return o.BaseGridSerializingSession}),i.d(t,"CsvCreator",function(){return o.CsvCreator}),i.d(t,"CsvExportModule",function(){return o.CsvExportModule}),i.d(t,"Downloader",function(){return o.Downloader}),i.d(t,"GridSerializer",function(){return o.GridSerializer}),i.d(t,"RowType",function(){return o.RowType}),i.d(t,"XmlFactory",function(){return o.XmlFactory}),i.d(t,"ZipContainer",function(){return o.ZipContainer}),i.d(t,"InfiniteRowModelModule",function(){return r.InfiniteRowModelModule});var s=i(0);i.d(t,"ColumnFactory",function(){return s.ColumnFactory}),i.d(t,"ColumnModel",function(){return s.ColumnModel}),i.d(t,"ColumnKeyCreator",function(){return s.ColumnKeyCreator}),i.d(t,"ColumnUtils",function(){return s.ColumnUtils}),i.d(t,"DisplayedGroupCreator",function(){return s.DisplayedGroupCreator}),i.d(t,"GroupInstanceIdCreator",function(){return s.GroupInstanceIdCreator}),i.d(t,"GROUP_AUTO_COLUMN_ID",function(){return s.GROUP_AUTO_COLUMN_ID}),i.d(t,"ComponentUtil",function(){return s.ComponentUtil}),i.d(t,"AgStackComponentsRegistry",function(){return s.AgStackComponentsRegistry}),i.d(t,"UserComponentRegistry",function(){return s.UserComponentRegistry}),i.d(t,"UserComponentFactory",function(){return s.UserComponentFactory}),i.d(t,"ColDefUtil",function(){return s.ColDefUtil}),i.d(t,"BeanStub",function(){return s.BeanStub}),i.d(t,"Context",function(){return s.Context}),i.d(t,"Autowired",function(){return s.Autowired}),i.d(t,"PostConstruct",function(){return s.PostConstruct}),i.d(t,"PreConstruct",function(){return s.PreConstruct}),i.d(t,"Optional",function(){return s.Optional}),i.d(t,"Bean",function(){return s.Bean}),i.d(t,"Qualifier",function(){return s.Qualifier}),i.d(t,"PreDestroy",function(){return s.PreDestroy}),i.d(t,"QuerySelector",function(){return s.QuerySelector}),i.d(t,"RefSelector",function(){return s.RefSelector}),i.d(t,"ExcelFactoryMode",function(){return s.ExcelFactoryMode}),i.d(t,"DragAndDropService",function(){return s.DragAndDropService}),i.d(t,"DragSourceType",function(){return s.DragSourceType}),i.d(t,"HorizontalDirection",function(){return s.HorizontalDirection}),i.d(t,"VerticalDirection",function(){return s.VerticalDirection}),i.d(t,"DragService",function(){return s.DragService}),i.d(t,"Column",function(){return s.Column}),i.d(t,"ColumnGroup",function(){return s.ColumnGroup}),i.d(t,"ProvidedColumnGroup",function(){return s.ProvidedColumnGroup}),i.d(t,"RowNode",function(){return s.RowNode}),i.d(t,"RowHighlightPosition",function(){return s.RowHighlightPosition}),i.d(t,"FilterManager",function(){return s.FilterManager}),i.d(t,"ProvidedFilter",function(){return s.ProvidedFilter}),i.d(t,"SimpleFilter",function(){return s.SimpleFilter}),i.d(t,"ScalarFilter",function(){return s.ScalarFilter}),i.d(t,"NumberFilter",function(){return s.NumberFilter}),i.d(t,"TextFilter",function(){return s.TextFilter}),i.d(t,"DateFilter",function(){return s.DateFilter}),i.d(t,"TextFloatingFilter",function(){return s.TextFloatingFilter}),i.d(t,"HeaderFilterCellComp",function(){return s.HeaderFilterCellComp}),i.d(t,"FloatingFilterMapper",function(){return s.FloatingFilterMapper}),i.d(t,"GridBodyComp",function(){return s.GridBodyComp}),i.d(t,"GridBodyCtrl",function(){return s.GridBodyCtrl}),i.d(t,"RowAnimationCssClasses",function(){return s.RowAnimationCssClasses}),i.d(t,"ScrollVisibleService",function(){return s.ScrollVisibleService}),i.d(t,"MouseEventService",function(){return s.MouseEventService}),i.d(t,"NavigationService",function(){return s.NavigationService}),i.d(t,"RowContainerComp",function(){return s.RowContainerComp}),i.d(t,"RowContainerName",function(){return s.RowContainerName}),i.d(t,"RowContainerCtrl",function(){return s.RowContainerCtrl}),i.d(t,"RowContainerType",function(){return s.RowContainerType}),i.d(t,"getRowContainerTypeForName",function(){return s.getRowContainerTypeForName}),i.d(t,"BodyDropPivotTarget",function(){return s.BodyDropPivotTarget}),i.d(t,"BodyDropTarget",function(){return s.BodyDropTarget}),i.d(t,"CssClassApplier",function(){return s.CssClassApplier}),i.d(t,"HeaderRowContainerComp",function(){return s.HeaderRowContainerComp}),i.d(t,"GridHeaderComp",function(){return s.GridHeaderComp}),i.d(t,"GridHeaderCtrl",function(){return s.GridHeaderCtrl}),i.d(t,"HeaderRowComp",function(){return s.HeaderRowComp}),i.d(t,"HeaderRowType",function(){return s.HeaderRowType}),i.d(t,"HeaderRowCtrl",function(){return s.HeaderRowCtrl}),i.d(t,"HeaderCellCtrl",function(){return s.HeaderCellCtrl}),i.d(t,"SortIndicatorComp",function(){return s.SortIndicatorComp}),i.d(t,"HeaderFilterCellCtrl",function(){return s.HeaderFilterCellCtrl}),i.d(t,"HeaderGroupCellCtrl",function(){return s.HeaderGroupCellCtrl}),i.d(t,"AbstractHeaderCellCtrl",function(){return s.AbstractHeaderCellCtrl}),i.d(t,"HeaderRowContainerCtrl",function(){return s.HeaderRowContainerCtrl}),i.d(t,"HorizontalResizeService",function(){return s.HorizontalResizeService}),i.d(t,"MoveColumnFeature",function(){return s.MoveColumnFeature}),i.d(t,"StandardMenuFactory",function(){return s.StandardMenuFactory}),i.d(t,"TabbedLayout",function(){return s.TabbedLayout}),i.d(t,"simpleHttpRequest",function(){return s.simpleHttpRequest}),i.d(t,"ResizeObserverService",function(){return s.ResizeObserverService}),i.d(t,"AnimationFrameService",function(){return s.AnimationFrameService}),i.d(t,"LargeTextCellEditor",function(){return s.LargeTextCellEditor}),i.d(t,"PopupEditorWrapper",function(){return s.PopupEditorWrapper}),i.d(t,"SelectCellEditor",function(){return s.SelectCellEditor}),i.d(t,"TextCellEditor",function(){return s.TextCellEditor}),i.d(t,"NumberCellEditor",function(){return s.NumberCellEditor}),i.d(t,"DateCellEditor",function(){return s.DateCellEditor}),i.d(t,"DateStringCellEditor",function(){return s.DateStringCellEditor}),i.d(t,"CheckboxCellEditor",function(){return s.CheckboxCellEditor}),i.d(t,"Beans",function(){return s.Beans}),i.d(t,"AnimateShowChangeCellRenderer",function(){return s.AnimateShowChangeCellRenderer}),i.d(t,"AnimateSlideCellRenderer",function(){return s.AnimateSlideCellRenderer}),i.d(t,"GroupCellRenderer",function(){return s.GroupCellRenderer}),i.d(t,"GroupCellRendererCtrl",function(){return s.GroupCellRendererCtrl}),i.d(t,"SetLeftFeature",function(){return s.SetLeftFeature}),i.d(t,"PositionableFeature",function(){return s.PositionableFeature}),i.d(t,"AutoWidthCalculator",function(){return s.AutoWidthCalculator}),i.d(t,"CheckboxSelectionComponent",function(){return s.CheckboxSelectionComponent}),i.d(t,"CellComp",function(){return s.CellComp}),i.d(t,"CellCtrl",function(){return s.CellCtrl}),i.d(t,"RowCtrl",function(){return s.RowCtrl}),i.d(t,"RowRenderer",function(){return s.RowRenderer}),i.d(t,"ValueFormatterService",function(){return s.ValueFormatterService}),i.d(t,"CssClassManager",function(){return s.CssClassManager}),i.d(t,"CheckboxCellRenderer",function(){return s.CheckboxCellRenderer}),i.d(t,"PinnedRowModel",function(){return s.PinnedRowModel}),i.d(t,"ServerSideTransactionResultStatus",function(){return s.ServerSideTransactionResultStatus}),i.d(t,"ChangedPath",function(){return s.ChangedPath}),i.d(t,"RowNodeBlock",function(){return s.RowNodeBlock}),i.d(t,"RowNodeBlockLoader",function(){return s.RowNodeBlockLoader}),i.d(t,"PaginationProxy",function(){return s.PaginationProxy}),i.d(t,"ClientSideRowModelSteps",function(){return s.ClientSideRowModelSteps}),i.d(t,"StylingService",function(){return s.StylingService}),i.d(t,"LayoutCssClasses",function(){return s.LayoutCssClasses}),i.d(t,"AgAbstractField",function(){return s.AgAbstractField}),i.d(t,"AgCheckbox",function(){return s.AgCheckbox}),i.d(t,"AgRadioButton",function(){return s.AgRadioButton}),i.d(t,"AgToggleButton",function(){return s.AgToggleButton}),i.d(t,"AgInputTextField",function(){return s.AgInputTextField}),i.d(t,"AgInputTextArea",function(){return s.AgInputTextArea}),i.d(t,"AgInputNumberField",function(){return s.AgInputNumberField}),i.d(t,"AgInputDateField",function(){return s.AgInputDateField}),i.d(t,"AgInputRange",function(){return s.AgInputRange}),i.d(t,"AgSelect",function(){return s.AgSelect}),i.d(t,"AgSlider",function(){return s.AgSlider}),i.d(t,"AgGroupComponent",function(){return s.AgGroupComponent}),i.d(t,"AgMenuItemComponent",function(){return s.AgMenuItemComponent}),i.d(t,"AgMenuList",function(){return s.AgMenuList}),i.d(t,"AgMenuPanel",function(){return s.AgMenuPanel}),i.d(t,"AgDialog",function(){return s.AgDialog}),i.d(t,"AgPanel",function(){return s.AgPanel}),i.d(t,"Component",function(){return s.Component}),i.d(t,"ManagedFocusFeature",function(){return s.ManagedFocusFeature}),i.d(t,"TabGuardComp",function(){return s.TabGuardComp}),i.d(t,"TabGuardCtrl",function(){return s.TabGuardCtrl}),i.d(t,"TabGuardClassNames",function(){return s.TabGuardClassNames}),i.d(t,"PopupComponent",function(){return s.PopupComponent}),i.d(t,"PopupService",function(){return s.PopupService}),i.d(t,"TouchListener",function(){return s.TouchListener}),i.d(t,"VirtualList",function(){return s.VirtualList}),i.d(t,"AgAbstractLabel",function(){return s.AgAbstractLabel}),i.d(t,"AgPickerField",function(){return s.AgPickerField}),i.d(t,"CellRangeType",function(){return s.CellRangeType}),i.d(t,"SelectionHandleType",function(){return s.SelectionHandleType}),i.d(t,"AutoScrollService",function(){return s.AutoScrollService}),i.d(t,"VanillaFrameworkOverrides",function(){return s.VanillaFrameworkOverrides}),i.d(t,"CellNavigationService",function(){return s.CellNavigationService}),i.d(t,"AlignedGridsService",function(){return s.AlignedGridsService}),i.d(t,"KeyCode",function(){return s.KeyCode}),i.d(t,"Grid",function(){return s.Grid}),i.d(t,"GridCoreCreator",function(){return s.GridCoreCreator}),i.d(t,"GridApi",function(){return s.GridApi}),i.d(t,"Events",function(){return s.Events}),i.d(t,"FocusService",function(){return s.FocusService}),i.d(t,"GridOptionsService",function(){return s.GridOptionsService}),i.d(t,"EventService",function(){return s.EventService}),i.d(t,"SelectableService",function(){return s.SelectableService}),i.d(t,"RowNodeSorter",function(){return s.RowNodeSorter}),i.d(t,"CtrlsService",function(){return s.CtrlsService}),i.d(t,"GridComp",function(){return s.GridComp}),i.d(t,"GridCtrl",function(){return s.GridCtrl}),i.d(t,"Logger",function(){return s.Logger}),i.d(t,"LoggerFactory",function(){return s.LoggerFactory}),i.d(t,"SortController",function(){return s.SortController}),i.d(t,"TemplateService",function(){return s.TemplateService}),i.d(t,"LocaleService",function(){return s.LocaleService}),i.d(t,"_",function(){return s._}),i.d(t,"NumberSequence",function(){return s.NumberSequence}),i.d(t,"AgPromiseStatus",function(){return s.AgPromiseStatus}),i.d(t,"AgPromise",function(){return s.AgPromise}),i.d(t,"Timer",function(){return s.Timer}),i.d(t,"ValueService",function(){return s.ValueService}),i.d(t,"ValueCache",function(){return s.ValueCache}),i.d(t,"ExpressionService",function(){return s.ExpressionService}),i.d(t,"ValueParserService",function(){return s.ValueParserService}),i.d(t,"CellPositionUtils",function(){return s.CellPositionUtils}),i.d(t,"RowPositionUtils",function(){return s.RowPositionUtils}),i.d(t,"HeaderPositionUtils",function(){return s.HeaderPositionUtils}),i.d(t,"HeaderNavigationService",function(){return s.HeaderNavigationService}),i.d(t,"HeaderNavigationDirection",function(){return s.HeaderNavigationDirection}),i.d(t,"PropertyKeys",function(){return s.PropertyKeys}),i.d(t,"ColumnApi",function(){return s.ColumnApi}),i.d(t,"BaseComponentWrapper",function(){return s.BaseComponentWrapper}),i.d(t,"Environment",function(){return s.Environment}),i.d(t,"CustomTooltipFeature",function(){return s.CustomTooltipFeature}),i.d(t,"DEFAULT_CHART_GROUPS",function(){return s.DEFAULT_CHART_GROUPS}),i.d(t,"CHART_TOOL_PANEL_ALLOW_LIST",function(){return s.CHART_TOOL_PANEL_ALLOW_LIST}),i.d(t,"CHART_TOOLBAR_ALLOW_LIST",function(){return s.CHART_TOOLBAR_ALLOW_LIST}),i.d(t,"CHART_TOOL_PANEL_MENU_OPTIONS",function(){return s.CHART_TOOL_PANEL_MENU_OPTIONS}),i.d(t,"__FORCE_MODULE_DETECTION",function(){return s.__FORCE_MODULE_DETECTION}),i.d(t,"BarColumnLabelPlacement",function(){return s.BarColumnLabelPlacement}),i.d(t,"ModuleNames",function(){return s.ModuleNames}),i.d(t,"ModuleRegistry",function(){return s.ModuleRegistry});const a=[n.ClientSideRowModelModule,r.InfiniteRowModelModule,o.CsvExportModule]}])});(function(){var t=function(e){var n={};_.each(e,function(e,i){if(_.isPlainObject(e)){_.each(t(e),function(e,t){n[i+"."+t]=e})}else{n[i]=e}});return n};$.i18n.load(t(window.I18n));window.t=function(){return $.i18n._.apply($.i18n,Array.prototype.slice.call(arguments))}})();AGN=window.AGN||(window.AGN={});AGN.Lib=window.AGN.Lib||(window.AGN.Lib={});AGN.Lib.WM=window.AGN.Lib.WM||(window.AGN.Lib.WM={});AGN.Lib.Dashboard=window.AGN.Lib.Dashboard||(window.AGN.Lib.Dashboard={});AGN.Lib.LB=window.AGN.Lib.LB||(window.AGN.Lib.LB={});AGN.Opt=window.AGN.Opt||(window.AGN.Opt={});AGN.Opt.Fields=window.AGN.Opt.Fields||(window.AGN.Opt.Fields={});AGN.Opt.Forms=window.AGN.Opt.Forms||(window.AGN.Opt.Forms={});AGN.Opt.Controllers=window.AGN.Opt.Controllers||(window.AGN.Opt.Controllers={});AGN.Opt.Templates=window.AGN.Opt.Templates||(window.AGN.Opt.Templates={});AGN.Opt.TableCellRenderers=window.AGN.Opt.TableCellRenderers||(window.AGN.Opt.TableCellRenderers={});AGN.Opt.Table=window.AGN.Opt.Table||(window.AGN.Opt.Table={filters:{},comparators:{}});AGN.Opt.TableHeaderComponents=window.AGN.Opt.TableHeaderComponents||(window.AGN.Opt.TableHeaderComponents={});AGN.Opt.Charts=window.AGN.Opt.Charts||(window.AGN.Opt.Charts={});AGN.Opt.Validators=window.AGN.Opt.Validators||(window.AGN.Opt.Validators={});AGN.Opt.Components=window.AGN.Opt.Components||(window.AGN.Opt.Components={});AGN.url=function(e,t){if(window.agnResolveRelativeUrl){if(e&&e.charAt(0)==="/"){e=e.substring(1)}return window.agnResolveRelativeUrl(e,t)}else{console.error("window.agnResolveRelativeUrl is not defined");return e}};AGN.isIE=/MSIE|Trident/.test(window.navigator.userAgent);AGN.runAll=function(e){AGN.Lib.CoreInitializer.autorun(e);AGN.Lib.DomInitializer.autorun(e)};(function(){if(!Array.prototype.find){Object.defineProperty(Array.prototype,"find",{value:function(e){"use strict";if(this==null){throw new TypeError("Array.prototype.find called on null or undefined")}if(typeof e!=="function"){throw new TypeError("predicate must be a function")}var t=Object(this);var i=t.length>>>0;var n=arguments[1];var r;for(var o=0;o<i;o++){r=t[o];if(e.call(n,r,o,t)){return r}}return undefined}})}if(!Array.prototype.findIndex){Object.defineProperty(Array.prototype,"findIndex",{value:function(e){"use strict";if(this==null){throw new TypeError("Array.prototype.findIndex called on null or undefined")}if(typeof e!=="function"){throw new TypeError("predicate must be a function")}var t=Object(this);var i=t.length>>>0;var n=arguments[1];var r;for(var o=0;o<i;o++){r=t[o];if(e.call(n,r,o,t)){return o}}return-1},enumerable:false,configurable:false,writable:false})}if(!Array.prototype.includes){Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(this==null){throw new TypeError('"this" is null or not defined')}var i=Object(this);var n=i.length>>>0;if(n===0){return false}var r=t|0;var o=Math.max(r>=0?r:n-Math.abs(r),0);function s(e,t){return e===t||typeof e==="number"&&typeof t==="number"&&isNaN(e)&&isNaN(t)}while(o<n){if(s(i[o],e)){return true}o++}return false}})}})();(function(c){const e=c("html");let t;Chart.register(ChartDataLabels);Chart.defaults.color=()=>{if(!t){t=c("body").css("--chart-label-color")}return t};Chart.defaults.maintainAspectRatio=false;Chart.defaults.font.size=e.css("--chart-font-size");Chart.defaults.font.family=e.css("--chart-font-family");Chart.defaults.scale.border.display=false;Chart.defaults.scale.grid.display=false;Chart.controllers.bar.defaults.barPercentage=1;Chart.defaults.plugins.legend.labels.usePointStyle=true;Chart.defaults.plugins.legend.labels.pointStyle="rectRounded";Chart.defaults.plugins.legend.position="right";Chart.defaults.plugins.tooltip.enabled=false;Chart.defaults.plugins.tooltip.external=e=>{const{chart:t,tooltip:s}=e;const i=d(t);if(s.opacity===0){i.css("opacity",0);return}if(s.body){const r=s.title||[];const o=s.body.map(e=>e.lines);const a=c('<div class="tooltip-header">');a.append(c(`<span>${r[0]}</span>`));const l=c('<div class="tooltip-body">');o.forEach((e,t)=>{const i=s.labelColors[t];const n=c("<div>");const r=c('<i class="icon icon-square">').css("color",i.backgroundColor);const o=c('<span class="text-truncate">').text(e);n.append(r);n.append(o);l.append(n)});c(i).empty();c(i).append(a);c(i).append(l)}const n=u(i,t);i.css({opacity:1,left:n.left+"px",top:n.top+"px"})};function u(e,t){const{chartArea:i,tooltip:n}=t;const r=i.right-i.left;const o=i.bottom-i.top;const{offsetLeft:s,offsetTop:a}=t.canvas;const l=s+r;const c=a+o;let u=s+n.caretX;let d=a+n.caretY;if(u+e.outerWidth()>l){u=l-e.outerWidth()}if(d+e.outerHeight()>c){d=c-e.outerHeight()}return{left:Math.max(s,u),top:Math.max(a,d)}}function d(e){let t=c(e.canvas).parent().find(".chart-tooltip");if(!t.exists()){t=c('<div class="chart-tooltip">');c(e.canvas).parent().append(t)}return t}class i extends Chart.DoughnutController{initialize(){this._actualRealValues=this.chart.data.datasets[0].data;this._exactPercentages=AGN.Lib.ChartUtils.calcExactPercentages(this._actualRealValues);this.chart.data.datasets[0].data=a(this._actualRealValues);super.initialize()}}i.id="agnDoughnut";i.defaults=Chart.DoughnutController.defaults;i.overrides=_.merge(_.cloneDeep(Chart.DoughnutController.overrides),{plugins:{legend:{onClick:function(e,i,t){const n=s(t.chart);const r=t.legendItems.map((e,t)=>{if(i.index===t){return e.hidden?n._actualRealValues[t]:0}return e.hidden?0:n._actualRealValues[t]});n._exactPercentages=AGN.Lib.ChartUtils.calcExactPercentages(r);t.chart.data.datasets[0].data=a(r);const o=Chart.DoughnutController.overrides.plugins.legend.onClick;o(e,i,t)}},datalabels:{color:e=>{const t=e.dataset.backgroundColor[e.dataIndex];return AGN.Lib.Helpers.getColorLuminance(t)<.57?"white":"#4B4B4B"},formatter:(e,t)=>{const i=s(t.chart)._exactPercentages;const n=i[t.dataIndex];return n>0?`${n.toFixed(1)}%`:""}},tooltip:{callbacks:{label:e=>s(e.chart)._actualRealValues[e.dataIndex]}}}});function s(e){return e.getDatasetMeta(0).controller}function a(e){const t=AGN.Lib.ChartUtils.getTotal(e);return e.map(e=>{if(e<=0){return 0}return Math.max(e/t*100,1)})}Chart.register(i)})(window.jQuery);(function(){var i=$.ui.dialog.prototype._allowInteraction;$.ui.dialog.prototype._allowInteraction=function(e){var t=$(e.target);if(t.closest(".cke_dialog").length||t.closest(".cke_panel_frame").length){return true}return i.apply(this,arguments)}})();if(Function.prototype.bind&&window.console&&typeof console.log=="object"){["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(e){console[e]=this.bind(console[e],console)},Function.prototype.call)}(function(e,t){if(typeof exports=="object"){module.exports=t(e)}else if(typeof define=="function"&&define.amd){define([],t.bind(e,e))}else{t(e)}})(typeof global!="undefined"?global:this,function(e){if(e.CSS&&e.CSS.escape){return e.CSS.escape}var t=function(e){if(arguments.length==0){throw new TypeError("`CSS.escape` requires an argument.")}var t=String(e);var i=t.length;var n=-1;var r;var o="";var s=t.charCodeAt(0);while(++n<i){r=t.charCodeAt(n);if(r==0){o+="";continue}if(r>=1&&r<=31||r==127||n==0&&r>=48&&r<=57||n==1&&r>=48&&r<=57&&s==45){o+="\\"+r.toString(16)+" ";continue}if(n==0&&i==1&&r==45){o+="\\"+t.charAt(n);continue}if(r>=128||r==45||r==95||r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122){o+=t.charAt(n);continue}o+="\\"+t.charAt(n)}return o};if(!e.CSS){e.CSS={}}e.CSS.escape=t;return t});(function(){jQuery.browser=e().browser;function e(){var e=navigator.userAgent.toLowerCase();var t=/(msie) ([\w.]+)/;var i=/(webkit)[ \/]([\w.]+)/;var n=/(opera)(?:.*version)?[ \/]([\w.]+)/;var r=/(mozilla)(?:.*? rv:([\w.]+))?/;var o=i.exec(e)||n.exec(e)||t.exec(e)||e.indexOf("compatible")<0&&r.exec(e)||[];return{browser:o[1]||"",version:o[2]||"0"}}})(jQuery);(function(c){c.extend(true,c.fn.dirty.prototype,{checkValues:function(e){var s=this;var a=false;this.form.find("select").each(function(e,t){var i=c(t);var n=s.isSelectFieldDirty(i);i.data(s.statuses.dataIsDirty,n);a|=n});this.form.find("input, textarea").each(function(e,t){var i=s.isRadioOrCheckbox(t);var n=s.isFileInput(t);var r=c(t);var o;if(i){o=s.isCheckboxDirty(r)}else if(n){o=s.isFileInputDirty(r)}else{if(!r.is(".select2-input[placeholder]")){o=s.isFieldDirty(r)}}r.data(s.statuses.dataIsDirty,o);a|=o});if(a){s.setDirty()}else{s.setClean()}},saveInitialValues:function(){var s=this;this.form.find("input, select, textarea").each(function(e,t){var i=c(t);if(i.attr("id")||i.attr("name")){i.attr("id",i.prop("tagName"+"__"+e))}var n=s.isRadioOrCheckbox(t);var r=s.isFileInput(t);if(n){var o=c(t).is(":checked")?"checked":"unchecked";i.data(s.statuses.dataInitialValue,o)}else if(r){i.data(s.statuses.dataInitialValue,JSON.stringify(t.files))}else{i.data(s.statuses.dataInitialValue,i.val()||"")}})},backupData:function(){var o=this;var s={};o.form.find("input, select, textarea").each(function(e,t){var i=c(t);var n=i.attr("id")||i.attr("name");var r={};r[o.statuses.dataInitialValue]=i.data(o.statuses.dataInitialValue);r[o.statuses.dataIsDirty]=i.data(o.statuses.dataIsDirty);s[n]=r});return s},restoreData:function(o){var s=this;if(o){s.form.find("input, select, textarea").each(function(e,t){var i=c(t);var n=i.attr("id")||i.attr("name");var r=o[n];if(r){i.data(s.statuses.dataInitialValue,r[s.statuses.dataInitialValue]);i.data(s.statuses.dataIsDirty,r[s.statuses.dataIsDirty])}})}s.checkValues()},isSelectFieldDirty:function(e){var t=this;var i=e.data(t.statuses.dataInitialValue)||"";var n=e.val()||"";return!_.isEqual(n,i)},resetForm:function(){var l=this;this.form.find("select").each(function(e,t){var i=c(t);var n=i.data(l.statuses.dataInitialValue);if(i.data("select2")){i.select2("val",n)}else{i.val(n)}});this.form.find("input, textarea").each(function(e,t){var i=c(t);var n=l.isRadioOrCheckbox(t);var r=l.isFileInput(t);if(n){var o=i.data(l.statuses.dataInitialValue);var s=o==="checked";i.prop("checked",s)}if(r){t.value="";c(t).data(l.statuses.dataInitialValue,JSON.stringify(t.files))}else{var a=i.data(l.statuses.dataInitialValue);i.val(a)}});this.checkValues()}})})(jQuery);(function(e){if(e.fn.all){console.error("$.fn.all is already defined")}else{e.fn.extend({all:function(e){return this.filter(e).add(this.find(e))}})}if(e.fn.exists){console.error("$.fn.exists is already defined")}else{e.fn.extend({exists:function(){return this.length>0}})}if(e.fn.json){console.error("$.fn.json is already defined")}else{e.fn.extend({json:function(){return JSON.parse(this.html())}})}e.expr[":"].truncated=function(e){return e.clientWidth<e.scrollWidth}})(jQuery);(function(t){t.fn.extend({ensureLoad:function(e){return this.each(function(){if(this.complete){e.call(this)}else{t(this).on("load",e)}})}})})(jQuery);$.extend(true,$.inputmask.defaults.aliases,{datetime:{regex:{quartspre:new RegExp("0|1|3|4"),quartspost:new RegExp("00|15|30|45"),halfspre:new RegExp("0|3"),halfspost:new RegExp("00|30")},definitions:{q:{validator:function(e,t,i,n,r){var o=r.regex.quartspost.test(e);if(!n&&!o){if(r.regex.quartspost.test(e[0]+"5")){return{c:"5"}}else{return{c:"0"}}}return true},cardinality:2,prevalidator:[{validator:function(e,t,i,n,r){var o=r.regex.quartspre.test(e);o=false;if(!n&&!o){var s=parseInt(e+"0"),a=["00","15","30","45"],l=100,c,u;for(var d=0;d<a.length;d++){var h=a[d];parsedNum=parseInt(h);if(Math.abs(parsedNum-s)<l){l=Math.abs(parsedNum-s);c=h}}u={caret:i+2,insert:[{pos:i,c:c[0]},{pos:i+1,c:c[1]}]};return u}return true},cardinality:1}]},u:{validator:function(e,t,i,n,r){var o=r.regex.halfspost.test(e);if(!n&&!o){return{c:"0"}}return true},cardinality:2,prevalidator:[{validator:function(e,t,i,n,r){var o=r.regex.halfspre.test(e);o=false;if(!n&&!o){var s=parseInt(e+"0"),a=["00","30"],l=100,c,u;for(var d=0;d<a.length;d++){var h=a[d];parsedNum=parseInt(h);if(Math.abs(parsedNum-s)<l){l=Math.abs(parsedNum-s);c=h}}u={caret:i+2,insert:[{pos:i,c:c[0]},{pos:i+1,c:c[1]}]};return u}return true},cardinality:1}]}}},"h:quarts t":{mask:"h:q t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"h:quarts":{mask:"h:q",placeholder:"hh:mm",alias:"datetime",hourFormat:"24"},"h:halfs t":{mask:"h:u t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"h:halfs":{mask:"h:u",placeholder:"hh:mm",alias:"datetime",hourFormat:"24"},"h:00 t":{mask:"h:00 t\\m",placeholder:"hh:00 xm",alias:"datetime",hourFormat:"12"},"h:00":{mask:"h:00",placeholder:"hh:00",alias:"datetime",hourFormat:"24"}});$.fn.serializeObject=function(){var e={};$.each(this.serializeArray(),function(){if(e[this.name]){if(!e[this.name].push){e[this.name]=[e[this.name]]}e[this.name].push(this.value||"")}else{e[this.name]=this.value||""}});return e};$.fn.serializeFormDataObject=function(){var i=this.serializeObject();this.find("input[type=file]").each(function(){if(!$(this).is(":disabled")&&this.name){var e=this.files;if(e.length==0){e=[new File([],"",{type:"application/octet-stream"})]}if(i[this.name]){var t=i[this.name];if($.isArray(t)){i[this.name]=t.concat(e)}else{i[this.name]=[t].concat(e)}}else{if(e.length>1){i[this.name]=e}else{i[this.name]=e[0]}}}});return i};(function(e){if(e.fn.style){console.error("$.fn.style is already defined")}else{e.fn.extend({style:function(t,i,n){if(i===undefined){return this.css(t)}if(e.isFunction(i)){this.each(function(){if(this.style){var e=i.call(this,this.style.getPropertyValue(t));this.style.setProperty(t,e,n)}})}else{this.each(function(){if(this.style){this.style.setProperty(t,i,n)}})}}})}})(jQuery);(function(e){if(String.prototype.trim){e.trim=function(e){return e==null?"":(e+"").trim()}}})(jQuery);$.widget("ui.dialog",$.extend({},$.ui.dialog.prototype,{_title:function(e){if(!this.options.title){e.html("&#160;")}e.html(this.options.title)}}));AGN.Opt.Components.JsPlumbFixedBezierConnector=function(e){var i=jsPlumb.Connectors.AbstractConnector.apply(this,arguments);this.type="FixedBezierConnector";this._compute=function(e){var t=e.anchorOrientation==="opposite"?2:1.5;i.addSegment(this,"Bezier",{x1:e.tx,y1:e.ty,x2:e.sx,y2:e.sy,cp1x:e.tx+e.to[0]*e.w/t,cp1y:e.ty+e.to[1]*e.h/t,cp2x:e.sx+e.so[0]*e.w/t,cp2y:e.sy+e.so[1]*e.h/t})}};_.templateSettings={evaluate:/\{\{(.+?)\}\}/g,interpolate:/\{\{=(.+?)\}\}/g,escape:/\{\{-(.+?)\}\}/g};jQuery.extend(jQuery.fn.pickadate.defaults,{monthsFull:t("date.monthsFull"),monthsShort:t("date.monthsShort"),weekdaysFull:t("date.weekdaysFull"),weekdaysShort:t("date.weekdaysShort"),labelMonthNext:t("date.nextMonth"),labelMonthPrev:t("date.prevMonth"),labelMonthSelect:t("date.selectMonth"),labelYearSelect:t("date.selectYear"),today:t("defaults.today"),clear:t("defaults.delete"),close:t("defaults.close"),firstDay:t("date.firstDayOfWeek"),format:t("date.format"),hiddenName:true});jQuery.extend(jQuery.fn.pickatime.defaults,{clear:t("defaults.delete"),format:t("time.format"),hiddenName:true});window.onpopstate=function(){window.location.reload()};(function(e){const i=e.fn.select2.amd.require("select2/defaults");e.extend(i.defaults,{searchInputPlaceholder:"",showSearchIcon:false,language:{noResults:function(e){return t("selects.noMatches",e||"")}}});const n=e.fn.select2.amd.require("select2/dropdown/search");const r=n.prototype.render;n.prototype.render=function(e){const t=r.apply(this,Array.prototype.slice.apply(arguments));this.$search.attr("placeholder",this.options.get("searchInputPlaceholder"));if(this.options.get("showSearchIcon")){this.$searchContainer.addClass("has-search-icon");this.$searchContainer.append(`<i class="icon icon-search select2-search-icon"></i>`)}return t};const o=e.fn.select2.amd.require("select2/selection/search");const s=o.prototype.update;o.prototype.update=function(e,t){s.apply(this,Array.prototype.slice.apply(arguments));if(this.options.get("preventPlaceholderClear")&&this.placeholder?.text){this.$search.attr("placeholder",this.placeholder.text)}};o.prototype.resizeSearch=function(){this.$search.css("width","100%")};const a=e.fn.select2.amd.require("select2/selection/single");const l=a.prototype.update;a.prototype.update=function(e,t){l.apply(this,Array.prototype.slice.apply(arguments));this.$selection.find(".select2-selection__rendered").removeAttr("title")}})(window.jQuery);(function(){if(!String.prototype.startsWith){String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e}}if(!String.prototype.endsWith){String.prototype.endsWith=function(e,t){if(t===undefined||t>this.length){t=this.length}return this.substring(t-e.length,t)===e}}if(!String.prototype.includes){String.prototype.includes=function(e,t){"use strict";if(typeof t!=="number"){t=0}if(t+e.length>this.length){return false}else{return this.indexOf(e,t)!==-1}}}})();!function(e,t){"function"==typeof define&&define.amd?define([],function(){return e.svg4everybody=t()}):"object"==typeof exports?module.exports=t():e.svg4everybody=t()}(this,function(){function f(e,t){if(t){var i=!e.getAttribute("viewBox")&&t.getAttribute("viewBox"),n=document.createDocumentFragment(),r=t.cloneNode(!0);for(i&&e.setAttribute("viewBox",i);r.childNodes.length;){n.appendChild(r.firstChild)}e.appendChild(n)}}function p(e){e.onreadystatechange=function(){if(4===e.readyState){var t=document.createElement("x");t.innerHTML=e.responseText,e.s.splice(0).map(function(e){f(e[0],t.querySelector("#"+e[1].replace(/(\W)/g,"\\$1")))})}},e.onreadystatechange()}function e(e){function a(){for(var e;e=l[0];){var t=e.parentNode;if(t&&/svg/i.test(t.nodeName)){var i=e.getAttribute("xlink:href");if(c&&(!u||u(i,t,e))){var n=i.split("#"),r=n[0],o=n[1];if(t.removeChild(e),r.length){var s=h[r]=h[r]||new XMLHttpRequest;s.s||(s.s=[],s.open("GET",r),s.send()),s.s.push([t,o]),p(s)}else{f(t,document.getElementById(o))}}}}d(a,17)}e=e||{};var l=document.getElementsByTagName("use"),c="polyfill"in e?e.polyfill:/\bEdge\/12\b|\bTrident\/[567]\b|\bVersion\/7.0 Safari\b/.test(navigator.userAgent)||(navigator.userAgent.match(/AppleWebKit\/(\d+)/)||[])[1]<537,u=e.validate,d=window.requestAnimationFrame||setTimeout,h={};c&&a()}return e});AGN.Opt.Templates["select2-result"]="<span>{{- title ? title : text }}</span>";AGN.Opt.Templates["error"]=`
   <div class="modal modal-alert" tabindex="-1">
        <div class="modal-dialog modal-fullscreen-lg-down modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title">
                        <i class="icon icon-state-warning"></i>
                        {{= headline }}
                    </h1>
  
                    <button type="button" class="btn-close shadow-none" data-bs-dismiss="modal">
                        <span class="sr-only"><mvc:message code="button.Cancel"/></span>
                    </button>
                </div>
  
                <div class="modal-body">
                    <p>{{= text }}</p>
                </div>
                
                <div class="modal-footer">
                   <button class="btn btn-primary flex-grow-1" data-bs-dismiss="modal" onclick="location.reload();">
                        <i class="icon icon-redo"></i>
                        <span class="text">{{= reload }}</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
`;AGN.Opt.Templates["permission-denied"]=`
   <div class="modal modal-alert" tabindex="-1">
        <div class="modal-dialog modal-fullscreen-lg-down modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title">
                        <i class="icon icon-state-alert"></i>
                        {{= title }}
                    </h1>
                </div>

                <div class="modal-body">
                    <p>{{= text }}</p>
                </div>
                
                <div class="modal-footer">
                     <button class="btn btn-primary flex-grow-1" data-bs-dismiss="modal">
                        <i class="icon icon-check"></i>
                        <span class="text">{{= btn }}</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
`;AGN.Opt.Templates["autosave-restore"]=`
  <div class="modal" tabIndex="-1">
    <div class="modal-dialog modal-fullscreen-lg-down modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title">{{= title }}</h1>
          <button type="button" class="btn-close shadow-none js-confirm-negative" data-bs-dismiss="modal">
            <span class="sr-only"><mvc:message code="button.Cancel"/></span>
          </button>
        </div>
        <div class="modal-body">
          <p>{{= content }}</p>
        </div>
  
        <div class="modal-footer">
            <button type="button" class="btn btn-danger js-confirm-negative flex-grow-1" data-bs-dismiss="modal">
              <i class="icon icon-times"></i>
              <span class="text">{{= negative }}</span>
            </button>
            <button type="button" class="btn btn-primary flex-grow-1 js-confirm-positive" data-bs-dismiss="modal">
                <i class="icon icon-check"></i>
                <span class="text">{{= positive }}</span>
            </button>
        </div>
      </div>
    </div>
  </div>
`;AGN.Opt.Templates["tooltip-template"]=`
  <div class="tooltip {{= tooltipStyle }}" role="tooltip">
    <div class="tooltip-arrow {{= arrowStyle }}"></div>
    <div class="tooltip-inner {{= innerStyle }}"></div>
  </div>
`;AGN.Opt.Templates["table-controls"]=`
<div class="table-controls pages-{{- totalPages }}">
  {{ if (showRecordsCount === 'simple') { }}
    <span>{{- itemTotal }} {{= t('defaults.entries') }}</span>    
  {{ } else if (showRecordsCount) { }}
    <div class="table-controls__entries-wrapper">
      <span>${t("defaults.listShowMax")}</span>
        <select name="numberOfRows" class="form-control compact" data-select-options="minimumResultsForSearch: -1, width: 'auto', dropdownAutoWidth: true">
          {{ _.each([20, 50, 100], function(numberOfRows) { }}       
            <option value="{{- numberOfRows }}" {{- pageSize == numberOfRows ? 'selected="selected"' : ''}}>{{- numberOfRows }} ${t("defaults.entries")}</option>
          {{ }) }}
        </select>       
      <span>${t("defaults.OutOf")} {{- itemTotal }} ${t("defaults.entries")}</span>
    </div>
  {{ } }}

  {{ if (pagination && totalPages > 1) { }}
    <ul class="pagination">
      <li class="js-data-table-first-page {{= currentPage == 1 ? 'disabled' : ''¬†}}">
        <span><i class="icon icon-fast-backward"></i></span>
      </li>
      <li class="js-data-table-prev-page {{= currentPage == 1 ? 'disabled' : ''¬†}}">
        <span><i class="icon icon-step-backward"></i></span>
      </li>
      {{ _.each(pageSelects, function(page) { }} 
      <li class="{{=¬†page == currentPage ? 'active' : 'js-data-table-page' }}" data-page="{{= page - 1 }}">
        <span>{{= page }}</span>
      </li>
      {{ }) }}
      <li class="js-data-table-next-page {{= currentPage == totalPages ? 'disabled' : ''¬†}}">
        <span><i class="icon icon-step-forward"></i></span>
      </li>
      <li class="js-data-table-last-page {{= currentPage == totalPages ? 'disabled' : ''¬†}}">
        <span><i class="icon icon-fast-forward"></i></span>
      </li>
    </ul>
  {{ } }}
</div>`;AGN.Opt.Templates["session-expired"]=`
<div class="modal modal-warning" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-fullscreen-lg-down modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title">
                    <i class="icon icon-state-warning"></i>
                    {{= t(\'logon.session.expired\') }}
                </h1>
            </div>

            <div class="modal-body">
                <p>{{= t(\'logon.session.notification\') }}</p>
            </div>
            
            <div class="modal-footer">
               <button class="btn btn-primary flex-grow-1" data-bs-dismiss="modal">
                  {{= t(\'defaults.relogin\') }}
              </button>
            </div>
        </div>
    </div>
</div>
`;AGN.Opt.Templates["datetime-picker"]=`
  <div class="date-time-container">
      <div class="date-picker-container">
        <input type="text" id="{{- property }}_date" class="form-control js-datepicker" value="{{- date}}"/>
      </div>
     <div class="time-picker-container">
         <input type="text" id="{{- property }}_time" class="form-control js-timepicker" value="{{- time}}" data-timepicker-options="mask: 'h:s'"/>
      </div>
  </div>
`;AGN.Opt.Templates["plus-btn"]=`
<a href="#" class="btn btn-icon-sm btn-primary" {{= attrs }}>
    <i class="icon icon-plus"></i>
</a>`;AGN.Opt.Templates["trash-btn"]=`
<a href="#" class="btn btn-icon-sm btn-danger" {{= attrs }}>
    <i class="icon icon-trash-alt"></i>
</a>`;AGN.Opt.Templates["notification-info"]=`
  <div class="notification-simple">
      <i class="icon icon-info-circle"></i>
      <span>{{- message }}</span>
  </div>
`;AGN.Opt.Templates["progress"]=`
  {{ if (isNaN(currentProgress) || currentProgress === true) { }}
      <div class="progress loop" style="width: 100%"></div>
  {{ } else { }}
      <div class="progress">
          <div class="progress-bar-white-bg"></div>
          <div class="progress-bar"
                     role="progressbar"
                     aria-valuenow="{{= currentProgress }}"
                     aria-valuemin="0"
                     aria-valuemax="100"
                     style="width: {{= currentProgress }}%"></div>
          <div class="progress-bar-primary-bg"></div>
          <div class="percentage">{{= currentProgress }}%</div>
      </div>
  {{ } }}
`;AGN.Opt.Templates["tile-overlay"]=`
  <div class="tile-overlay tile-overlay--{{= state }}">
      {{ if (state === 'visible') { }}
        <button type="button" class="btn btn-danger btn-lg btn-sm-horizontal" data-edit-tile-visibility>
            <i class="icon icon-eye-slash"></i>
            ${t("editableView.tile.state.visible")}
        </button>
      {{ } else if (state === 'hidden') { }}
        <button type="button" class="btn btn-primary btn-lg btn-sm-horizontal" data-edit-tile-visibility>
            <i class="icon icon-eye"></i>
            ${t("editableView.tile.state.hidden")}
        </button>
      {{ } else { }}
        <button type="button" class="btn btn-dark btn-lg btn-sm-horizontal pe-none">
            <i class="icon icon-minus-circle"></i>
            ${t("editableView.tile.state.main")}
        </button>
      {{ } }}
  </div>
`;AGN.Opt.Templates["multi-editor-modal"]=`
<div class="modal modal-adaptive modal-editor">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title">{{= title }}</h1>
                <button type="button" class="btn-close shadow-none js-confirm-negative" data-bs-dismiss="modal">
                    <span class="sr-only">${t("defaults.cancel")}</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="modal-editors-container">
                    <div data-placeholder></div>
                </div>
            </div>
            <div class="modal-footer">
                <a href="#" class="btn btn-primary flex-grow-1" data-apply-enlarged>
                    <i class="icon icon-save"></i>
                    <span class="text">${t("defaults.apply")}</span>
                </a>
            </div>
        </div>
    </div>
</div>
`;AGN.Opt.Templates["mailing-locked"]=`
<div class="modal modal-warning" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title">
                    <i class="icon icon-state-warning"></i>
                    {{= t(\'defaults.warning\') }}
                </h1>
                
                <button type="button" class="btn-close shadow-none" data-bs-dismiss="modal">
                  <span class="sr-only"><mvc:message code="button.Cancel"/></span>
                </button>
            </div>

            <div class="modal-body">
                <p>{{= t(\'error.mailing.exclusiveLockingFailed\', username) }}</p>
            </div>
        </div>
    </div>
</div>
`;(function(){if(window.agnTimeZoneId){moment.tz.setDefault(window.agnTimeZoneId)}})();(function(e,t){if(typeof define=="function"&&define.amd){define(["jquery","dot/doT","jquery-extendext"],t)}else if(typeof module==="object"&&module.exports){module.exports=t(require("jquery"),require("dot/doT"),require("jquery-extendext"))}else{t(e.jQuery,e.doT)}})(this,function(m,i){"use strict";var h=function(e,t){e[0].queryBuilder=this;this.$el=e;this.settings=m.extendext(true,"replace",{},h.DEFAULTS,t);this.model=new n;this.status={id:null,generated_id:false,group_id:0,rule_id:0,has_optgroup:false,has_operator_optgroup:false};this.filters=this.settings.filters;this.icons=this.settings.icons;this.operators=this.settings.operators;this.templates=this.settings.templates;this.plugins=this.settings.plugins;this.lang=null;if(h.regional["en"]===undefined){v.error("Config",'"i18n/en.js" not loaded.')}this.lang=m.extendext(true,"replace",{},h.regional["en"],h.regional[this.settings.lang_code],this.settings.lang);if(this.settings.allow_groups===false){this.settings.allow_groups=0}else if(this.settings.allow_groups===true){this.settings.allow_groups=-1}Object.keys(this.templates).forEach(function(e){if(!this.templates[e]){this.templates[e]=h.templates[e]}if(typeof this.templates[e]=="string"){this.templates[e]=i.template(this.templates[e])}},this);if(!this.$el.attr("id")){this.$el.attr("id","qb_"+Math.floor(Math.random()*99999));this.status.generated_id=true}this.status.id=this.$el.attr("id");this.$el.addClass("query-builder");this.filters=this.checkFilters(this.filters);this.operators=this.checkOperators(this.operators);this.bindEvents();this.initPlugins()};m.extend(h.prototype,{trigger:function(e){var t=new m.Event(this._tojQueryEvent(e),{builder:this});this.$el.triggerHandler(t,Array.prototype.slice.call(arguments,1));return t},change:function(e,t){var i=new m.Event(this._tojQueryEvent(e,true),{builder:this,value:t});this.$el.triggerHandler(i,Array.prototype.slice.call(arguments,2));return i.value},on:function(e,t){this.$el.on(this._tojQueryEvent(e),t);return this},off:function(e,t){this.$el.off(this._tojQueryEvent(e),t);return this},once:function(e,t){this.$el.one(this._tojQueryEvent(e),t);return this},_tojQueryEvent:function(e,t){return e.split(" ").map(function(e){return e+".queryBuilder"+(t?".filter":"")}).join(" ")}});h.types={string:"string",integer:"number",double:"number",date:"datetime",time:"datetime",datetime:"datetime",boolean:"boolean"};h.inputs=["text","number","textarea","radio","checkbox","select"];h.modifiable_options=["display_errors","allow_groups","allow_empty","default_condition","default_filter"];h.selectors={group_container:".rules-group-container",rule_container:".rule-container",filter_container:".rule-filter-container",operator_container:".rule-operator-container",value_container:".rule-value-container",error_container:".error-container",condition_container:".rules-group-header .group-conditions",rule_header:".rule-header",group_header:".rules-group-header",group_actions:".group-actions",rule_actions:".rule-actions",rules_list:".rules-group-body>.rules-list",group_btns:".btn",group_condition:".rules-group-header [name$=_cond]",rule_filter:".rule-filter-container [name$=_filter]",rule_operator:".rule-operator-container [name$=_operator]",rule_value:".rule-value-container :input:not(.icon-help)",add_rule:"[data-add=rule]",delete_rule:"[data-delete=rule]",add_group:"[data-add=group]",delete_group:"[data-delete=group]"};h.templates={};h.regional={};h.OPERATORS={equal:{type:"equal",nb_inputs:1,multiple:false,apply_to:["string","number","datetime","boolean"]},not_equal:{type:"not_equal",nb_inputs:1,multiple:false,apply_to:["string","number","datetime","boolean"]},in:{type:"in",nb_inputs:1,multiple:true,apply_to:["string","number","datetime"]},not_in:{type:"not_in",nb_inputs:1,multiple:true,apply_to:["string","number","datetime"]},less:{type:"less",nb_inputs:1,multiple:false,apply_to:["number","datetime"]},less_or_equal:{type:"less_or_equal",nb_inputs:1,multiple:false,apply_to:["number","datetime"]},greater:{type:"greater",nb_inputs:1,multiple:false,apply_to:["number","datetime"]},greater_or_equal:{type:"greater_or_equal",nb_inputs:1,multiple:false,apply_to:["number","datetime"]},between:{type:"between",nb_inputs:2,multiple:false,apply_to:["number","datetime"]},not_between:{type:"not_between",nb_inputs:2,multiple:false,apply_to:["number","datetime"]},begins_with:{type:"begins_with",nb_inputs:1,multiple:false,apply_to:["string"]},not_begins_with:{type:"not_begins_with",nb_inputs:1,multiple:false,apply_to:["string"]},contains:{type:"contains",nb_inputs:1,multiple:false,apply_to:["string"]},not_contains:{type:"not_contains",nb_inputs:1,multiple:false,apply_to:["string"]},ends_with:{type:"ends_with",nb_inputs:1,multiple:false,apply_to:["string"]},not_ends_with:{type:"not_ends_with",nb_inputs:1,multiple:false,apply_to:["string"]},is_empty:{type:"is_empty",nb_inputs:0,multiple:false,apply_to:["string"]},is_not_empty:{type:"is_not_empty",nb_inputs:0,multiple:false,apply_to:["string"]},is_null:{type:"is_null",nb_inputs:0,multiple:false,apply_to:["string","number","datetime","boolean"]},is_not_null:{type:"is_not_null",nb_inputs:0,multiple:false,apply_to:["string","number","datetime","boolean"]}};h.DEFAULTS={filters:[],plugins:[],sort_filters:false,display_errors:true,allow_groups:-1,allow_empty:false,conditions:["AND","OR"],default_condition:"AND",inputs_separator:" , ",select_placeholder:"------",display_empty_filter:true,default_filter:null,optgroups:{},default_rule_flags:{filter_readonly:false,operator_readonly:false,value_readonly:false,no_delete:false},default_group_flags:{condition_readonly:false,no_add_rule:false,no_add_group:false,no_delete:false},templates:{group:null,rule:null,filterSelect:null,operatorSelect:null,ruleValueSelect:null},lang_code:"en",lang:{},operators:["equal","not_equal","in","not_in","less","less_or_equal","greater","greater_or_equal","between","not_between","begins_with","not_begins_with","contains","not_contains","ends_with","not_ends_with","is_empty","is_not_empty","is_null","is_not_null"],icons:{add_group:"glyphicon glyphicon-plus-sign",add_rule:"glyphicon glyphicon-plus",remove_group:"glyphicon glyphicon-remove",remove_rule:"glyphicon glyphicon-remove",error:"glyphicon glyphicon-warning-sign"}};h.plugins={};h.defaults=function(e){if(typeof e=="object"){m.extendext(true,"replace",h.DEFAULTS,e)}else if(typeof e=="string"){if(typeof h.DEFAULTS[e]=="object"){return m.extend(true,{},h.DEFAULTS[e])}else{return h.DEFAULTS[e]}}else{return m.extend(true,{},h.DEFAULTS)}};h.define=function(e,t,i){h.plugins[e]={fct:t,def:i||{}}};h.extend=function(e){m.extend(h.prototype,e)};h.prototype.initPlugins=function(){if(!this.plugins){return}if(m.isArray(this.plugins)){var t={};this.plugins.forEach(function(e){t[e]=null});this.plugins=t}Object.keys(this.plugins).forEach(function(e){if(e in h.plugins){this.plugins[e]=m.extend(true,{},h.plugins[e].def,this.plugins[e]||{});h.plugins[e].fct.call(this,this.plugins[e])}else{v.error("Config",'Unable to find plugin "{0}"',e)}},this)};h.prototype.getPluginOptions=function(e,t){var i;if(this.plugins&&this.plugins[e]){i=this.plugins[e]}else if(h.plugins[e]){i=h.plugins[e].def}if(i){if(t){return i[t]}else{return i}}else{v.error("Config",'Unable to find plugin "{0}"',e)}};h.prototype.init=function(e){this.trigger("afterInit");if(e){this.setRules(e);delete this.settings.rules}else{this.setRoot(true)}};h.prototype.checkFilters=function(e){var t=[];if(!e||e.length===0){v.error("Config","Missing filters list")}e.forEach(function(n,e){if(!n.id){v.error("Config","Missing filter {0} id",e)}if(t.indexOf(n.id)!=-1){v.error("Config",'Filter "{0}" already defined',n.id)}t.push(n.id);if(!n.type){n.type="string"}else if(!h.types[n.type]){v.error("Config",'Invalid type "{0}"',n.type)}if(!n.input){n.input=h.types[n.type]==="number"?"number":"text"}else if(typeof n.input!="function"&&h.inputs.indexOf(n.input)==-1){v.error("Config",'Invalid input "{0}"',n.input)}if(n.operators){n.operators.forEach(function(e){if(typeof e!="string"){v.error("Config","Filter operators must be global operators types (string)")}})}if(!n.field){n.field=n.id}if(!n.label){n.label=n.field}if(!n.optgroup){n.optgroup=null}else{this.status.has_optgroup=true;if(!this.settings.optgroups[n.optgroup]){this.settings.optgroups[n.optgroup]=n.optgroup}}switch(n.input){case"radio":case"checkbox":if(!n.values||n.values.length<1){v.error("Config",'Missing filter "{0}" values',n.id)}break;case"select":var r=[];n.has_optgroup=false;v.iterateOptions(n.values,function(e,t,i){r.push({value:e,label:t,optgroup:i||null});if(i){n.has_optgroup=true;if(!this.settings.optgroups[i]){this.settings.optgroups[i]=i}}}.bind(this));if(n.has_optgroup){n.values=v.groupSort(r,"optgroup")}else{n.values=r}if(n.placeholder){if(n.placeholder_value===undefined){n.placeholder_value=-1}n.values.forEach(function(e){if(e.value==n.placeholder_value){v.error("Config",'Placeholder of filter "{0}" overlaps with one of its values',n.id)}})}break}},this);if(this.settings.sort_filters){if(typeof this.settings.sort_filters=="function"){e.sort(this.settings.sort_filters)}else{var i=this;e.sort(function(e,t){return i.translate(e.label).localeCompare(i.translate(t.label))})}}if(this.status.has_optgroup){e=v.groupSort(e,"optgroup")}return e};h.prototype.checkOperators=function(i){var n=[];i.forEach(function(e,t){if(typeof e=="string"){if(!h.OPERATORS[e]){v.error("Config",'Unknown operator "{0}"',e)}i[t]=e=m.extendext(true,"replace",{},h.OPERATORS[e])}else{if(!e.type){v.error("Config",'Missing "type" for operator {0}',t)}if(h.OPERATORS[e.type]){i[t]=e=m.extendext(true,"replace",{},h.OPERATORS[e.type],e)}if(e.nb_inputs===undefined||e.apply_to===undefined){v.error("Config",'Missing "nb_inputs" and/or "apply_to" for operator "{0}"',e.type)}}if(n.indexOf(e.type)!=-1){v.error("Config",'Operator "{0}" already defined',e.type)}n.push(e.type);if(!e.optgroup){e.optgroup=null}else{this.status.has_operator_optgroup=true;if(!this.settings.optgroups[e.optgroup]){this.settings.optgroups[e.optgroup]=e.optgroup}}},this);if(this.status.has_operator_optgroup){i=v.groupSort(i,"optgroup")}return i};h.prototype.bindEvents=function(){var o=this;var t=h.selectors;this.$el.on("change.queryBuilder",t.group_condition,function(){if(m(this).is(":checked")){var e=m(this).closest(t.group_container);o.getModel(e).condition=m(this).val()}});this.$el.on("change.queryBuilder",t.rule_filter,function(){var e=m(this).closest(t.rule_container);o.getModel(e).filter=o.getFilterById(m(this).val())});this.$el.on("change.queryBuilder",t.rule_operator,function(){var e=m(this).closest(t.rule_container);o.getModel(e).operator=o.getOperatorByType(m(this).val())});this.$el.on("click.queryBuilder",t.add_rule,function(){var e=m(this).closest(t.group_container);o.addRule(o.getModel(e))});this.$el.on("click.queryBuilder",t.delete_rule,function(){var e=m(this).closest(t.rule_container);o.deleteRule(o.getModel(e))});if(this.settings.allow_groups!==0){this.$el.on("click.queryBuilder",t.add_group,function(){var e=m(this).closest(t.group_container);o.addGroup(o.getModel(e))});this.$el.on("click.queryBuilder",t.delete_group,function(){var e=m(this).closest(t.group_container);o.deleteGroup(o.getModel(e))})}this.model.on({drop:function(e,t){t.$el.remove();o.refreshGroupsConditions()},add:function(e,t,i,n){if(n===0){i.$el.prependTo(t.$el.find(">"+h.selectors.rules_list))}else{i.$el.insertAfter(t.rules[n-1].$el)}o.refreshGroupsConditions()},move:function(e,t,i,n){t.$el.detach();if(n===0){t.$el.prependTo(i.$el.find(">"+h.selectors.rules_list))}else{t.$el.insertAfter(i.rules[n-1].$el)}o.refreshGroupsConditions()},update:function(e,t,i,n,r){if(t instanceof s){switch(i){case"error":o.updateError(t);break;case"flags":o.applyRuleFlags(t);break;case"filter":o.updateRuleFilter(t,r);break;case"operator":o.updateRuleOperator(t,r);break;case"value":o.updateRuleValue(t,r);break}}else{switch(i){case"error":o.updateError(t);break;case"flags":o.applyGroupFlags(t);break;case"condition":o.updateGroupCondition(t,r);break}}}})};h.prototype.setRoot=function(e,t,i){e=e===undefined||e===true;var n=this.nextGroupId();var r=m(this.getGroupTemplate(n,1));r.find(h.selectors.group_btns).addClass(this.settings.readonly?"disabled":"");this.$el.append(r);this.model.root=new c(null,r);this.model.root.model=this.model;this.model.root.data=t;this.model.root.flags=m.extend({},this.settings.default_group_flags,i);this.model.root.condition=this.settings.default_condition;this.trigger("afterAddGroup",this.model.root);if(e){this.addRule(this.model.root)}return this.model.root};h.prototype.addGroup=function(e,t,i,n){t=t===undefined||t===true;var r=e.level+1;var o=this.trigger("beforeAddGroup",e,t,r);if(o.isDefaultPrevented()){return null}var s=this.nextGroupId();var a=m(this.getGroupTemplate(s,r));var l=e.addGroup(a);l.data=i;l.flags=m.extend({},this.settings.default_group_flags,n);l.condition=this.settings.default_condition;this.trigger("afterAddGroup",l);this.trigger("rulesChanged");if(t){this.addRule(l)}return l};h.prototype.deleteGroup=function(e){if(e.isRoot()){return false}var t=this.trigger("beforeDeleteGroup",e);if(t.isDefaultPrevented()){return false}var i=true;e.each("reverse",function(e){i&=this.deleteRule(e)},function(e){i&=this.deleteGroup(e)},this);if(i){e.drop();this.trigger("afterDeleteGroup");this.trigger("rulesChanged")}return i};h.prototype.updateGroupCondition=function(t,e){t.$el.find(">"+h.selectors.group_condition).each(function(){var e=m(this);e.prop("checked",e.val()===t.condition);e.parent().toggleClass("active",e.val()===t.condition)});this.trigger("afterUpdateGroupCondition",t,e);this.trigger("rulesChanged")};h.prototype.refreshGroupsConditions=function(){(function t(e){if(!e.flags||e.flags&&!e.flags.condition_readonly){e.$el.find(">"+h.selectors.group_condition).prop("disabled",e.rules.length<=1).parent().toggleClass("disabled",e.rules.length<=1)}e.each(null,function(e){t(e)},this)})(this.model.root)};h.prototype.addRule=function(e,t,i){var n=this.trigger("beforeAddRule",e);if(n.isDefaultPrevented()){return null}var r=this.nextRuleId();var o=m(this.getRuleTemplate(r));var s=e.addRule(o);s.data=t;s.flags=m.extend({},this.settings.default_rule_flags,i);this.trigger("afterAddRule",s);this.trigger("rulesChanged");this.createRuleFilters(s);if(this.settings.default_filter||!this.settings.display_empty_filter){s.filter=this.change("getDefaultFilter",this.getFilterById(this.settings.default_filter||this.filters[0].id),s)}return s};h.prototype.deleteRule=function(e){if(e.flags.no_delete){return false}var t=this.trigger("beforeDeleteRule",e);if(t.isDefaultPrevented()){return false}e.drop();this.trigger("afterDeleteRule");this.trigger("rulesChanged");return true};h.prototype.createRuleFilters=function(e){var t=this.change("getRuleFilters",this.filters,e);var i=m(this.getRuleFilterSelect(e,t));e.$el.find(h.selectors.filter_container).html(i);this.trigger("afterCreateRuleFilters",e);this.applyRuleFlags(e)};h.prototype.createRuleOperators=function(e){var t=e.$el.find(h.selectors.operator_container).empty();if(!e.filter){return}var i=this.getOperators(e.filter);var n=m(this.getRuleOperatorSelect(e,i));t.html(n);if(e.filter.default_operator){e.__.operator=this.getOperatorByType(e.filter.default_operator)}else{e.__.operator=i[0]}e.$el.find(h.selectors.rule_operator).val(e.operator.type);this.trigger("afterCreateRuleOperators",e,i);this.applyRuleFlags(e)};h.prototype.createRuleInput=function(e){var t=e.$el.find(h.selectors.value_container).empty();e.__.value=undefined;if(!e.filter||!e.operator||e.operator.nb_inputs===0){return}var i=this;var n=m();var r=e.filter;for(var o=0;o<e.operator.nb_inputs;o++){var s=m(this.getRuleInput(e,o));if(o>0)t.append(this.settings.inputs_separator);t.append(s);n=n.add(s)}t.css("display","");n.on("change "+(r.input_event||""),function(){if(!e._updating_input){e._updating_value=true;e.value=i.getRuleInputValue(e);e._updating_value=false}});if(r.plugin){n[r.plugin](r.plugin_config||{})}this.trigger("afterCreateRuleInput",e);if(r.default_value!==undefined){e.value=r.default_value}else{e._updating_value=true;e.value=i.getRuleInputValue(e);e._updating_value=false}this.applyRuleFlags(e)};h.prototype.updateRuleFilter=function(e,t){this.createRuleOperators(e);this.createRuleInput(e);e.$el.find(h.selectors.rule_filter).val(e.filter?e.filter.id:"-1");if(t&&e.filter&&t.id!==e.filter.id){e.data=undefined}this.trigger("afterUpdateRuleFilter",e,t);this.trigger("rulesChanged")};h.prototype.updateRuleOperator=function(e,t){var i=e.$el.find(h.selectors.value_container);if(!e.operator||e.operator.nb_inputs===0){i.hide();e.__.value=undefined}else{i.css("display","");if(i.is(":empty")||!t||e.operator.nb_inputs!==t.nb_inputs||e.operator.optgroup!==t.optgroup){this.createRuleInput(e)}}if(e.operator){e.$el.find(h.selectors.rule_operator).val(e.operator.type);e.__.value=this.getRuleInputValue(e)}this.trigger("afterUpdateRuleOperator",e,t);this.trigger("rulesChanged")};h.prototype.updateRuleValue=function(e,t){if(!e._updating_value){this.setRuleInputValue(e,e.value)}this.trigger("afterUpdateRuleValue",e,t);this.trigger("rulesChanged")};h.prototype.applyRuleFlags=function(e){var t=e.flags;var i=h.selectors;e.$el.find(i.rule_filter).prop("disabled",t.filter_readonly);e.$el.find(i.rule_operator).prop("disabled",t.operator_readonly);e.$el.find(i.rule_value).prop("disabled",t.value_readonly);if(t.no_delete){e.$el.find(i.delete_rule).remove()}this.trigger("afterApplyRuleFlags",e)};h.prototype.applyGroupFlags=function(e){var t=e.flags;var i=h.selectors;e.$el.find(">"+i.group_condition).prop("disabled",t.condition_readonly).parent().toggleClass("readonly",t.condition_readonly);if(t.no_add_rule){e.$el.find(i.add_rule).remove()}if(t.no_add_group){e.$el.find(i.add_group).remove()}if(t.no_delete){e.$el.find(i.delete_group).remove()}this.trigger("afterApplyGroupFlags",e)};h.prototype.clearErrors=function(e){e=e||this.model.root;if(!e){return}e.error=null;if(e instanceof c){e.each(function(e){e.error=null},function(e){this.clearErrors(e)},this)}};h.prototype.updateError=function(e){if(this.settings.display_errors){if(e.error===null){e.$el.removeClass("has-error")}else{var t=this.translate("errors",e.error[0]);t=v.fmt(t,e.error.slice(1));t=this.change("displayError",t,e.error,e);e.$el.addClass("has-error").find(h.selectors.error_container).eq(0).attr("title",t)}}};h.prototype.triggerValidationError=function(e,t,i){if(!m.isArray(t)){t=[t]}var n=this.trigger("validationError",e,t,i);if(!n.isDefaultPrevented()){e.error=t}};h.prototype.destroy=function(){this.trigger("beforeDestroy");if(this.status.generated_id){this.$el.removeAttr("id")}this.clear();this.model=null;this.$el.off(".queryBuilder").removeClass("query-builder").removeData("queryBuilder");delete this.$el[0].queryBuilder};h.prototype.reset=function(){var e=this.trigger("beforeReset");if(e.isDefaultPrevented()){return}this.status.group_id=1;this.status.rule_id=0;this.model.root.empty();this.model.root.data=undefined;this.model.root.flags=m.extend({},this.settings.default_group_flags);this.model.root.condition=this.settings.default_condition;this.addRule(this.model.root);this.trigger("afterReset");this.trigger("rulesChanged")};h.prototype.clear=function(){var e=this.trigger("beforeClear");if(e.isDefaultPrevented()){return}this.status.group_id=0;this.status.rule_id=0;if(this.model.root){this.model.root.drop();this.model.root=null}this.trigger("afterClear");this.trigger("rulesChanged")};h.prototype.setOptions=function(e){m.each(e,function(e,t){if(h.modifiable_options.indexOf(e)!==-1){this.settings[e]=t}}.bind(this))};h.prototype.getModel=function(e){if(!e){return this.model.root}else if(e instanceof r){return e}else{return m(e).data("queryBuilderModel")}};h.prototype.validate=function(o){o=m.extend({skip_empty:false},o);this.clearErrors();var s=this;var e=function i(e){var n=0;var r=0;e.each(function(e){if(!e.filter&&o.skip_empty){return}if(!e.filter){s.triggerValidationError(e,"no_filter",null);r++;return}if(!e.operator){s.triggerValidationError(e,"no_operator",null);r++;return}if(e.operator.nb_inputs!==0){var t=s.validateValue(e,e.value);if(t!==true){s.triggerValidationError(e,t,e.value);r++;return}}n++},function(e){var t=i(e);if(t===true){n++}else if(t===false){r++}});if(r>0){return false}else if(n===0&&!e.isRoot()&&o.skip_empty){return null}else if(n===0&&(!s.settings.allow_empty||!e.isRoot())){s.triggerValidationError(e,"empty_group",null);return false}return true}(this.model.root);return this.change("validate",e)};h.prototype.getRules=function(o){o=m.extend({get_flags:false,allow_invalid:false,skip_empty:false},o);var e=this.validate(o);if(!e&&!o.allow_invalid){return null}var s=this;var t=function i(e){var r={condition:e.condition,rules:[]};if(e.data){r.data=m.extendext(true,"replace",{},e.data)}if(o.get_flags){var t=s.getGroupFlags(e.flags,o.get_flags==="all");if(!m.isEmptyObject(t)){r.flags=t}}e.each(function(e){if(!e.filter&&o.skip_empty){return}var t=null;if(!e.operator||e.operator.nb_inputs!==0){t=e.value}var i={id:e.filter?e.filter.id:null,field:e.filter?e.filter.field:null,type:e.filter?e.filter.type:null,input:e.filter?e.filter.input:null,operator:e.operator?e.operator.type:null,value:t};if(e.filter&&e.filter.data||e.data){i.data=m.extendext(true,"replace",{},e.filter.data,e.data)}if(o.get_flags){var n=s.getRuleFlags(e.flags,o.get_flags==="all");if(!m.isEmptyObject(n)){i.flags=n}}r.rules.push(s.change("ruleToJson",i,e))},function(e){var t=i(e);if(t.rules.length!==0||!o.skip_empty){r.rules.push(t)}},this);return s.change("groupToJson",r,e)}(this.model.root);t.valid=e;return this.change("getRules",t)};h.prototype.setRules=function(e,r){r=m.extend({allow_invalid:false},r);if(m.isArray(e)){e={condition:this.settings.default_condition,rules:e}}if(!e||!e.rules||e.rules.length===0&&!this.settings.allow_empty){v.error("RulesParse","Incorrect data object passed")}this.clear();this.setRoot(false,e.data,this.parseGroupFlags(e));e=this.change("setRules",e,r);var o=this;(function i(e,n){if(n===null){return}if(e.condition===undefined){e.condition=o.settings.default_condition}else if(o.settings.conditions.indexOf(e.condition)==-1){v.error(!r.allow_invalid,"UndefinedCondition",'Invalid condition "{0}"',e.condition);e.condition=o.settings.default_condition}n.condition=e.condition;e.rules.forEach(function(e){var t;if(e.rules!==undefined){if(o.settings.allow_groups!==-1&&o.settings.allow_groups<n.level){v.error(!r.allow_invalid,"RulesParse","No more than {0} groups are allowed",o.settings.allow_groups);o.reset()}else{t=o.addGroup(n,false,e.data,o.parseGroupFlags(e));if(t===null){return}i(e,t)}}else{if(!e.empty){if(e.id===undefined){v.error(!r.allow_invalid,"RulesParse","Missing rule field id");e.empty=true}if(e.operator===undefined){e.operator="equal"}}t=o.addRule(n,e.data,o.parseRuleFlags(e));if(t===null){return}if(!e.empty){t.filter=o.getFilterById(e.id,!r.allow_invalid)}if(t.filter){t.operator=o.getOperatorByType(e.operator,!r.allow_invalid);if(!t.operator){t.operator=o.getOperators(t.filter)[0]}}if(t.operator&&t.operator.nb_inputs!==0){if(e.value!==undefined){t.value=e.value}else if(t.filter.default_value!==undefined){t.value=t.filter.default_value}}if(o.change("jsonToRule",t,e)!=t){v.error("RulesParse","Plugin tried to change rule reference")}}});if(o.change("jsonToGroup",n,e)!=n){v.error("RulesParse","Plugin tried to change group reference")}})(e,this.model.root);this.trigger("afterSetRules")};h.prototype.validateValue=function(e,t){var i=e.filter.validation||{};var n=true;if(i.callback){n=i.callback.call(this,t,e)}else{n=this._validateValue(e,t)}return this.change("validateValue",n,t,e)};h.prototype._validateValue=function(e,t){var i=e.filter;var n=e.operator;var r=i.validation||{};var o=true;var s,a;if(e.operator.nb_inputs===1){t=[t]}for(var l=0;l<n.nb_inputs;l++){if(!n.multiple&&m.isArray(t[l])&&t[l].length>1){o=["operator_not_multiple",n.type,this.translate("operators",n.type)];break}switch(i.input){case"radio":if(t[l]===undefined||t[l].length===0){if(!r.allow_empty_value){o=["radio_empty"]}break}break;case"checkbox":if(t[l]===undefined||t[l].length===0){if(!r.allow_empty_value){o=["checkbox_empty"]}break}break;case"select":if(t[l]===undefined||t[l].length===0||i.placeholder&&t[l]==i.placeholder_value){if(!r.allow_empty_value){o=["select_empty"]}break}break;default:a=m.isArray(t[l])?t[l]:[t[l]];for(var c=0;c<a.length;c++){switch(h.types[i.type]){case"string":if(a[c]===undefined||a[c].length===0){if(!r.allow_empty_value){o=["string_empty"]}break}if(r.min!==undefined){if(a[c].length<parseInt(r.min)){o=[this.getValidationMessage(r,"min","string_exceed_min_length"),r.min];break}}if(r.max!==undefined){if(a[c].length>parseInt(r.max)){o=[this.getValidationMessage(r,"max","string_exceed_max_length"),r.max];break}}if(r.format){if(typeof r.format=="string"){r.format=new RegExp(r.format)}if(!r.format.test(a[c])){o=[this.getValidationMessage(r,"format","string_invalid_format"),r.format];break}}break;case"number":if(a[c]===undefined||a[c].length===0){if(!r.allow_empty_value){o=["number_nan"]}break}if(isNaN(a[c])){o=["number_nan"];break}if(i.type=="integer"){if(parseInt(a[c])!=a[c]){o=["number_not_integer"];break}}else{if(parseFloat(a[c])!=a[c]){o=["number_not_double"];break}}if(r.min!==undefined){if(a[c]<parseFloat(r.min)){o=[this.getValidationMessage(r,"min","number_exceed_min"),r.min];break}}if(r.max!==undefined){if(a[c]>parseFloat(r.max)){o=[this.getValidationMessage(r,"max","number_exceed_max"),r.max];break}}if(r.step!==undefined&&r.step!=="any"){var u=(a[c]/r.step).toPrecision(14);if(parseInt(u)!=u){o=[this.getValidationMessage(r,"step","number_wrong_step"),r.step];break}}break;case"datetime":if(a[c]===undefined||a[c].length===0){if(!r.allow_empty_value){o=["datetime_empty"]}break}if(r.format){if(!("moment"in window)){v.error("MissingLibrary","MomentJS is required for Date/Time validation. Get it here http://momentjs.com")}var d=moment(a[c],r.format);if(!d.isValid()){o=[this.getValidationMessage(r,"format","datetime_invalid"),r.format];break}else{if(r.min){if(d<moment(r.min,r.format)){o=[this.getValidationMessage(r,"min","datetime_exceed_min"),r.min];break}}if(r.max){if(d>moment(r.max,r.format)){o=[this.getValidationMessage(r,"max","datetime_exceed_max"),r.max];break}}}}break;case"boolean":if(a[c]===undefined||a[c].length===0){if(!r.allow_empty_value){o=["boolean_not_valid"]}break}s=(""+a[c]).trim().toLowerCase();if(s!=="true"&&s!=="false"&&s!=="1"&&s!=="0"&&a[c]!==1&&a[c]!==0){o=["boolean_not_valid"];break}}if(o!==true){break}}}if(o!==true){break}}if((e.operator.type==="between"||e.operator.type==="not_between")&&t.length===2){switch(h.types[i.type]){case"number":if(t[0]>t[1]){o=["number_between_invalid",t[0],t[1]]}break;case"datetime":if(r.format){if(!("moment"in window)){v.error("MissingLibrary","MomentJS is required for Date/Time validation. Get it here http://momentjs.com")}if(moment(t[0],r.format).isAfter(moment(t[1],r.format))){o=["datetime_between_invalid",t[0],t[1]]}}break}}return o};h.prototype.nextGroupId=function(){return this.status.id+"_group_"+this.status.group_id++};h.prototype.nextRuleId=function(){return this.status.id+"_rule_"+this.status.rule_id++};h.prototype.getOperators=function(i){if(typeof i=="string"){i=this.getFilterById(i)}var e=[];for(var t=0,n=this.operators.length;t<n;t++){if(i.operators){if(i.operators.indexOf(this.operators[t].type)==-1){continue}}else if(this.operators[t].apply_to.indexOf(h.types[i.type])==-1){continue}e.push(this.operators[t])}if(i.operators){e.sort(function(e,t){return i.operators.indexOf(e.type)-i.operators.indexOf(t.type)})}return this.change("getOperators",e,i)};h.prototype.getFilterById=function(e,t){if(e=="-1"){return null}for(var i=0,n=this.filters.length;i<n;i++){if(this.filters[i].id==e){return this.filters[i]}}v.error(t!==false,"UndefinedFilter",'Undefined filter "{0}"',e);return null};h.prototype.getOperatorByType=function(e,t){if(e=="-1"){return null}for(var i=0,n=this.operators.length;i<n;i++){if(this.operators[i].type==e){return this.operators[i]}}v.error(t!==false,"UndefinedOperator",'Undefined operator "{0}"',e);return null};h.prototype.getRuleInputValue=function(e){var t=e.filter;var i=e.operator;var n=[];if(t.valueGetter){n=t.valueGetter.call(this,e)}else{var r=e.$el.find(h.selectors.value_container);for(var o=0;o<i.nb_inputs;o++){var s=v.escapeElementId(e.id+"_value_"+o);var a;switch(t.input){case"radio":n.push(r.find("[name="+s+"]:checked").val());break;case"checkbox":a=[];r.find("[name="+s+"]:checked").each(function(){a.push(m(this).val())});n.push(a);break;case"select":if(t.multiple){a=[];r.find("[name="+s+"] option:selected").each(function(){a.push(m(this).val())});n.push(a)}else{n.push(r.find("[name="+s+"] option:selected").val())}break;default:n.push(r.find("[name="+s+"]").val())}}n=n.map(function(e){if(i.multiple&&t.value_separator&&typeof e=="string"){e=e.split(t.value_separator)}if(m.isArray(e)){return e.map(function(e){return v.changeType(e,t.type)})}else{return v.changeType(e,t.type)}});if(i.nb_inputs===1){n=n[0]}if(t.valueParser){n=t.valueParser.call(this,e,n)}}return this.change("getRuleValue",n,e)};h.prototype.setRuleInputValue=function(e,t){var i=e.filter;var n=e.operator;if(!i||!n){return}e._updating_input=true;if(i.valueSetter){i.valueSetter.call(this,e,t)}else{var r=e.$el.find(h.selectors.value_container);if(n.nb_inputs==1){t=[t]}for(var o=0;o<n.nb_inputs;o++){var s=v.escapeElementId(e.id+"_value_"+o);switch(i.input){case"radio":r.find("[name="+s+'][value="'+t[o]+'"]').prop("checked",true).trigger("change");break;case"checkbox":if(!m.isArray(t[o])){t[o]=[t[o]]}t[o].forEach(function(e){r.find("[name="+s+'][value="'+e+'"]').prop("checked",true).trigger("change")});break;default:if(n.multiple&&i.value_separator&&m.isArray(t[o])){t[o]=t[o].join(i.value_separator)}r.find("[name="+s+"]").val(t[o]).trigger("change");break}}}e._updating_input=false};h.prototype.parseRuleFlags=function(e){var t=m.extend({},this.settings.default_rule_flags);if(e.readonly){m.extend(t,{header_readonly:true,filter_readonly:true,operator_readonly:true,value_readonly:true,no_delete:true,no_sortable:true})}if(e.flags){m.extend(t,e.flags)}return this.change("parseRuleFlags",t,e)};h.prototype.getRuleFlags=function(i,e){if(e){return m.extend({},i)}else{var n={};m.each(this.settings.default_rule_flags,function(e,t){if(i[e]!==t){n[e]=i[e]}});return n}};h.prototype.parseGroupFlags=function(e){var t=m.extend({},this.settings.default_group_flags);if(e.readonly){m.extend(t,{condition_readonly:true,no_add_rule:true,no_add_group:true,no_delete:true})}if(e.flags){m.extend(t,e.flags)}return this.change("parseGroupFlags",t,e)};h.prototype.getGroupFlags=function(i,e){if(e){return m.extend({},i)}else{var n={};m.each(this.settings.default_group_flags,function(e,t){if(i[e]!==t){n[e]=i[e]}});return n}};h.prototype.translate=function(e,t){if(!t){t=e;e=undefined}var i;if(typeof t==="object"){i=t[this.settings.lang_code]||t["en"]}else{i=(e?this.lang[e]:this.lang)[t]||t}return this.change("translate",i,t,e)};h.prototype.getValidationMessage=function(e,t,i){return e.messages&&e.messages[t]||i};h.templates.group=`
<div id="{{= it.group_id }}" class="rules-group-container">
  <div class="rules-group-header">
    <div class="btn-group group-actions">
      <button type="button" class="btn btn-sm btn-success" data-add="rule">
        <i class="{{= it.icons.add_rule }}"></i>
        <span class="text">{{= it.translate("add_rule") }}</span>
      </button>
      {{? it.settings.allow_groups===-1 || it.settings.allow_groups>=it.level }}
        <button type="button" class="btn btn-sm btn-success" data-add="group">
          <i class="{{= it.icons.add_group }}"></i>
          <span class="text">{{= it.translate("add_group") }}</span>
        </button>
      {{?}}
      {{? it.level>1 }}
        <button type="button" class="btn btn-sm btn-danger" data-delete="group">
          <i class="{{= it.icons.remove_group }}"></i>
          <span class="text">{{= it.translate("delete_group") }}</span>
        </button>
      {{?}}
    </div>
    <div class="group-conditions radio-switch">
      {{~ it.conditions: condition }}
          <input id="qb-codition-btn-{{= condition }}-group-{{= it.group_id }}" type="radio" name="{{= it.group_id }}_cond" value="{{= condition }}">
          <label for="qb-codition-btn-{{= condition }}-group-{{= it.group_id }}">{{= it.translate("conditions", condition) }}</label>
      {{~}}
    </div>
    {{? it.settings.display_errors }}
      <div class="error-container"><i class="{{= it.icons.error }}"></i></div>
    {{?}}
  </div>
  <div class=rules-group-body>
    <div class=rules-list></div>
  </div>
</div>`;h.templates.rule='<div id="{{= it.rule_id }}" class="rule-container">   <div class="rule-header">     <div class="btn-group pull-right rule-actions">       <button type="button" class="btn btn-sm btn-danger" data-delete="rule">         <i class="{{= it.icons.remove_rule }}"></i> {{= it.translate("delete_rule") }}       </button>     </div>   </div>   {{? it.settings.display_errors }}     <div class="error-container"><i class="{{= it.icons.error }}"></i></div>   {{?}}   <div class="rule-filter-container"></div>   <div class="rule-operator-container"></div>   <div class="rule-value-container"></div> </div>';h.templates.filterSelect='{{ var optgroup = null; }} <select class="form-control" name="{{= it.rule.id }}_filter">   {{? it.settings.display_empty_filter }}     <option value="-1">{{= it.settings.select_placeholder }}</option>   {{?}}   {{~ it.filters: filter }}     {{? optgroup !== filter.optgroup }}       {{? optgroup !== null }}</optgroup>{{?}}       {{? (optgroup = filter.optgroup) !== null }}         <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">       {{?}}     {{?}}     <option value="{{= filter.id }}" {{? filter.icon}}data-icon="{{= filter.icon}}"{{?}}>{{= it.translate(filter.label) }}</option>   {{~}}   {{? optgroup !== null }}</optgroup>{{?}} </select>';h.templates.operatorSelect=`
{{? it.operators.length === 1 }}
<span>
{{= it.translate("operators", it.operators[0].type) }}
</span>
{{?}}
{{ var optgroup = null; }}
<select class="form-control {{? it.operators.length === 1 }}hide{{?}}" name="{{= it.rule.id }}_operator" data-select-options="dropdownAutoWidth: true">
  {{~ it.operators: operator }}
    {{? optgroup !== operator.optgroup }}
      {{? optgroup !== null }}</optgroup>{{?}}
      {{? (optgroup = operator.optgroup) !== null }}
        <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">
      {{?}}
    {{?}}
    <option value="{{= operator.type }}" {{? operator.icon}}data-icon="{{= operator.icon}}"{{?}}>{{= it.translate("operators", operator.type) }}</option>
  {{~}}
  {{? optgroup !== null }}</optgroup>{{?}}
</select>`;h.templates.ruleValueSelect='{{ var optgroup = null; }} <select class="form-control" name="{{= it.name }}" {{? it.rule.filter.multiple }}multiple{{?}}>   {{? it.rule.filter.placeholder }}     <option value="{{= it.rule.filter.placeholder_value }}" disabled selected>{{= it.rule.filter.placeholder }}</option>   {{?}}   {{~ it.rule.filter.values: entry }}     {{? optgroup !== entry.optgroup }}       {{? optgroup !== null }}</optgroup>{{?}}       {{? (optgroup = entry.optgroup) !== null }}         <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">       {{?}}     {{?}}     <option value="{{= entry.value }}">{{= entry.label }}</option>   {{~}}   {{? optgroup !== null }}</optgroup>{{?}} </select>';h.prototype.getGroupTemplate=function(e,t){var i=this.templates.group({builder:this,group_id:e,level:t,conditions:this.settings.conditions,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getGroupTemplate",i,t)};h.prototype.getRuleTemplate=function(e){var t=this.templates.rule({builder:this,rule_id:e,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleTemplate",t)};h.prototype.getRuleFilterSelect=function(e,t){var i=this.templates.filterSelect({builder:this,rule:e,filters:t,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleFilterSelect",i,e,t)};h.prototype.getRuleOperatorSelect=function(e,t){var i=this.templates.operatorSelect({builder:this,rule:e,operators:t,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleOperatorSelect",i,e,t)};h.prototype.getRuleValueSelect=function(e,t){var i=this.templates.ruleValueSelect({builder:this,name:e,rule:t,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleValueSelect",i,e,t)};h.prototype.getRuleInput=function(e,t){var i=e.filter;var n=e.filter.validation||{};var r=e.id+"_value_"+t;var o=i.vertical?" class=block":"";var s="";if(typeof i.input=="function"){s=i.input.call(this,e,r)}else{switch(i.input){case"radio":case"checkbox":v.iterateOptions(i.values,function(e,t){s+="<label"+o+'><input type="'+i.input+'" name="'+r+'" value="'+e+'"> '+t+"</label> "});break;case"select":s=this.getRuleValueSelect(r,e);break;case"textarea":s+='<textarea class="form-control" name="'+r+'"';if(i.size)s+=' cols="'+i.size+'"';if(i.rows)s+=' rows="'+i.rows+'"';if(n.min!==undefined)s+=' minlength="'+n.min+'"';if(n.max!==undefined)s+=' maxlength="'+n.max+'"';if(i.placeholder)s+=' placeholder="'+i.placeholder+'"';s+="></textarea>";break;case"number":s+='<input class="form-control" type="number" name="'+r+'"';if(n.step!==undefined)s+=' step="'+n.step+'"';if(n.min!==undefined)s+=' min="'+n.min+'"';if(n.max!==undefined)s+=' max="'+n.max+'"';if(i.placeholder)s+=' placeholder="'+i.placeholder+'"';if(i.size)s+=' size="'+i.size+'"';s+=">";break;default:s+='<input class="form-control" type="text" name="'+r+'"';if(i.placeholder)s+=' placeholder="'+i.placeholder+'"';if(i.type==="string"&&n.min!==undefined)s+=' minlength="'+n.min+'"';if(i.type==="string"&&n.max!==undefined)s+=' maxlength="'+n.max+'"';if(i.size)s+=' size="'+i.size+'"';s+=">"}}return this.change("getRuleInput",s,e,r)};var v={};h.utils=v;v.iterateOptions=function(e,i){if(e){if(m.isArray(e)){e.forEach(function(e){if(m.isPlainObject(e)){if("value"in e){i(e.value,e.label||e.value,e.optgroup)}else{m.each(e,function(e,t){i(e,t);return false})}}else{i(e,e)}})}else{m.each(e,function(e,t){i(e,t)})}}};v.fmt=function(e,i){if(!Array.isArray(i)){i=Array.prototype.slice.call(arguments,1)}return e.replace(/{([0-9]+)}/g,function(e,t){return i[parseInt(t)]})};v.error=function(){var e=0;var t=typeof arguments[e]==="boolean"?arguments[e++]:true;var i=arguments[e++];var n=arguments[e++];var r=Array.isArray(arguments[e])?arguments[e]:Array.prototype.slice.call(arguments,e);if(t){var o=new Error(v.fmt(n,r));o.name=i+"Error";o.args=r;throw o}else{console.error(i+"Error: "+v.fmt(n,r))}};v.changeType=function(e,t){if(e===""||e===undefined){return undefined}switch(t){case"integer":if(typeof e==="string"&&!/^-?\d+$/.test(e)){return e}return parseInt(e);case"double":if(typeof e==="string"&&!/^-?\d+\.?\d*$/.test(e)){return e}return parseFloat(e);case"boolean":if(typeof e==="string"&&!/^(0|1|true|false){1}$/i.test(e)){return e}return e===true||e===1||e.toLowerCase()==="true"||e==="1";default:return e}};v.escapeString=function(e){if(typeof e!="string"){return e}return e.replace(/[\0\n\r\b\\\'\"]/g,function(e){switch(e){case"\0":return"\\0";case"\n":return"\\n";case"\r":return"\\r";case"\b":return"\\b";default:return"\\"+e}}).replace(/\t/g,"\\t").replace(/\x1a/g,"\\Z")};v.escapeRegExp=function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")};v.escapeElementId=function(e){return e?e.replace(/(\\)?([:.\[\],])/g,function(e,t,i){return t?e:"\\"+i}):e};v.groupSort=function(e,i){var n=[];var r=[];e.forEach(function(e){var t;if(e[i]){t=n.lastIndexOf(e[i]);if(t==-1){t=n.length}else{t++}}else{t=n.length}n.splice(t,0,e[i]);r.splice(t,0,e)});return r};v.defineModelProperties=function(e,t){t.forEach(function(i){Object.defineProperty(e.prototype,i,{enumerable:true,get:function(){return this.__[i]},set:function(e){var t=this.__[i]!==null&&typeof this.__[i]=="object"?m.extend({},this.__[i]):this.__[i];this.__[i]=e;if(this.model!==null){this.model.trigger("update",this,i,e,t)}}})})};function n(){this.root=null;this.$=m(this)}m.extend(n.prototype,{trigger:function(e){var t=new m.Event(e);this.$.triggerHandler(t,Array.prototype.slice.call(arguments,1));return t},on:function(){this.$.on.apply(this.$,Array.prototype.slice.call(arguments));return this},off:function(){this.$.off.apply(this.$,Array.prototype.slice.call(arguments));return this},once:function(){this.$.one.apply(this.$,Array.prototype.slice.call(arguments));return this}});var r=function(e,t){if(!(this instanceof r)){return new r(e,t)}Object.defineProperty(this,"__",{value:{}});t.data("queryBuilderModel",this);this.__.level=1;this.__.error=null;this.__.flags={};this.__.data=undefined;this.$el=t;this.id=t[0].id;this.model=null;this.parent=e};v.defineModelProperties(r,["level","error","data","flags"]);Object.defineProperty(r.prototype,"parent",{enumerable:true,get:function(){return this.__.parent},set:function(e){this.__.parent=e;this.level=e===null?1:e.level+1;this.model=e===null?null:e.model}});r.prototype.isRoot=function(){return this.level===1};r.prototype.getPos=function(){if(this.isRoot()){return-1}else{return this.parent.getNodePos(this)}};r.prototype.drop=function(){var e=this.model;if(!!this.parent){this.parent.removeNode(this)}this.$el.removeData("queryBuilderModel");if(e!==null){e.trigger("drop",this)}};r.prototype.moveAfter=function(e){if(!this.isRoot()){this.move(e.parent,e.getPos()+1)}};r.prototype.moveAtBegin=function(e){if(!this.isRoot()){if(e===undefined){e=this.parent}this.move(e,0)}};r.prototype.moveAtEnd=function(e){if(!this.isRoot()){if(e===undefined){e=this.parent}this.move(e,e.length()===0?0:e.length()-1)}};r.prototype.move=function(e,t){if(!this.isRoot()){if(typeof e==="number"){t=e;e=this.parent}this.parent.removeNode(this);e.insertNode(this,t,false);if(this.model!==null){this.model.trigger("move",this,e,t)}}};var c=function(e,t){if(!(this instanceof c)){return new c(e,t)}r.call(this,e,t);this.rules=[];this.__.condition=null};c.prototype=Object.create(r.prototype);c.prototype.constructor=c;v.defineModelProperties(c,["condition"]);c.prototype.empty=function(){this.each("reverse",function(e){e.drop()},function(e){e.drop()})};c.prototype.drop=function(){this.empty();r.prototype.drop.call(this)};c.prototype.length=function(){return this.rules.length};c.prototype.insertNode=function(e,t,i){if(t===undefined){t=this.length()}this.rules.splice(t,0,e);e.parent=this;if(i&&this.model!==null){this.model.trigger("add",this,e,t)}return e};c.prototype.addGroup=function(e,t){return this.insertNode(new c(this,e),t,true)};c.prototype.addRule=function(e,t){return this.insertNode(new s(this,e),t,true)};c.prototype.removeNode=function(e){var t=this.getNodePos(e);if(t!==-1){e.parent=null;this.rules.splice(t,1)}};c.prototype.getNodePos=function(e){return this.rules.indexOf(e)};c.prototype.each=function(e,t,i,n){if(typeof e!=="boolean"&&typeof e!=="string"){n=i;i=t;t=e;e=false}n=n===undefined?null:n;var r=e?this.rules.length-1:0;var o=e?0:this.rules.length-1;var s=e?-1:1;var a=function(){return e?r>=o:r<=o};var l=false;for(;a();r+=s){if(this.rules[r]instanceof c){if(!!i){l=i.call(n,this.rules[r])===false}}else if(!!t){l=t.call(n,this.rules[r])===false}if(l){break}}return!l};c.prototype.contains=function(t,e){if(this.getNodePos(t)!==-1){return true}else if(!e){return false}else{return!this.each(function(){return true},function(e){return!e.contains(t,true)})}};var s=function(e,t){if(!(this instanceof s)){return new s(e,t)}r.call(this,e,t);this._updating_value=false;this._updating_input=false;this.__.filter=null;this.__.operator=null;this.__.value=undefined};s.prototype=Object.create(r.prototype);s.prototype.constructor=s;v.defineModelProperties(s,["filter","operator","value"]);s.prototype.isRoot=function(){return false};h.Group=c;h.Rule=s;m.fn.queryBuilder=function(e){if(this.length===0){v.error("Config","No target defined")}if(this.length>1){v.error("Config","Unable to initialize on multiple target")}var t=this.data("queryBuilder");var i=typeof e=="object"&&e||{};if(!t&&e=="destroy"){return this}if(!t){var n=new h(this,i);this.data("queryBuilder",n);n.init(i.rules)}if(typeof e=="string"){return t[e].apply(t,Array.prototype.slice.call(arguments,1))}return this};m.fn.queryBuilder.constructor=h;m.fn.queryBuilder.defaults=h.defaults;m.fn.queryBuilder.extend=h.extend;m.fn.queryBuilder.define=h.define;m.fn.queryBuilder.regional=h.regional;h.define("bt-checkbox",function(c){if(c.font=="glyphicons"){this.$el.addClass("bt-checkbox-glyphicons")}this.on("getRuleInput.filter",function(r,e,o){var s=e.filter;if((s.input==="radio"||s.input==="checkbox")&&!s.plugin){r.value="";if(!s.colors){s.colors={}}if(s.color){s.colors._def_=s.color}var a=s.vertical?' style="display:block"':"";var l=0;v.iterateOptions(s.values,function(e,t){var i=s.colors[e]||s.colors._def_||c.color;var n=o+"_"+l++;r.value+="<div"+a+' class="'+s.input+" "+s.input+"-"+i+'">   <input type="'+s.input+'" name="'+o+'" id="'+n+'" value="'+e+'">   <label for="'+n+'">'+t+"</label> </div>"})}})},{font:"glyphicons",color:"default"});h.define("bt-selectpicker",function(i){if(!m.fn.selectpicker||!m.fn.selectpicker.Constructor){v.error("MissingLibrary",'Bootstrap Select is required to use "bt-selectpicker" plugin. Get it here: http://silviomoreto.github.io/bootstrap-select')}var n=h.selectors;this.on("afterCreateRuleFilters",function(e,t){t.$el.find(n.rule_filter).removeClass("form-control").selectpicker(i)});this.on("afterCreateRuleOperators",function(e,t){t.$el.find(n.rule_operator).removeClass("form-control").selectpicker(i)});this.on("afterUpdateRuleFilter",function(e,t){t.$el.find(n.rule_filter).selectpicker("render")});this.on("afterUpdateRuleOperator",function(e,t){t.$el.find(n.rule_operator).selectpicker("render")});this.on("beforeDeleteRule",function(e,t){t.$el.find(n.rule_filter).selectpicker("destroy");t.$el.find(n.rule_operator).selectpicker("destroy")})},{container:"body",style:"btn-inverse btn-sm",width:"auto",showIcon:false});h.define("bt-tooltip-errors",function(n){if(!m.fn.tooltip||!m.fn.tooltip.Constructor||!m.fn.tooltip.Constructor.prototype.fixTitle){v.error("MissingLibrary",'Bootstrap Tooltip is required to use "bt-tooltip-errors" plugin. Get it here: http://getbootstrap.com')}var r=this;this.on("getRuleTemplate.filter getGroupTemplate.filter",function(e){var t=m(e.value);t.find(h.selectors.error_container).attr("data-toggle","tooltip");e.value=t.prop("outerHTML")});this.model.on("update",function(e,t,i){if(i=="error"&&r.settings.display_errors){t.$el.find(h.selectors.error_container).eq(0).tooltip(n).tooltip("hide").tooltip("fixTitle")}})},{placement:"right"});h.extend({setFilters:function(e,t){var i=this;if(t===undefined){t=e;e=false}t=this.checkFilters(t);t=this.change("setFilters",t);var n=t.map(function(e){return e.id});if(!e){(function e(t){t.each(function(e){if(e.filter&&n.indexOf(e.filter.id)===-1){v.error("ChangeFilter",'A rule is using filter "{0}"',e.filter.id)}},e)})(this.model.root)}this.filters=t;(function e(t){t.each(true,function(e){if(e.filter&&n.indexOf(e.filter.id)===-1){e.drop();i.trigger("rulesChanged")}else{i.createRuleFilters(e);e.$el.find(h.selectors.rule_filter).val(e.filter?e.filter.id:"-1");i.trigger("afterUpdateRuleFilter",e)}},e)})(this.model.root);if(this.settings.plugins){if(this.settings.plugins["unique-filter"]){this.updateDisabledFilters()}if(this.settings.plugins["bt-selectpicker"]){this.$el.find(h.selectors.rule_filter).selectpicker("render")}}if(this.settings.default_filter){try{this.getFilterById(this.settings.default_filter)}catch(e){this.settings.default_filter=null}}this.trigger("afterSetFilters",t)},addFilter:function(e,i){if(i===undefined||i=="#end"){i=this.filters.length}else if(i=="#start"){i=0}if(!m.isArray(e)){e=[e]}var t=m.extend(true,[],this.filters);if(parseInt(i)==i){Array.prototype.splice.apply(t,[i,0].concat(e))}else{if(this.filters.some(function(e,t){if(e.id==i){i=t+1;return true}})){Array.prototype.splice.apply(t,[i,0].concat(e))}else{Array.prototype.push.apply(t,e)}}this.setFilters(t)},removeFilter:function(t,e){var i=m.extend(true,[],this.filters);if(typeof t==="string"){t=[t]}i=i.filter(function(e){return t.indexOf(e.id)===-1});this.setFilters(e,i)}});h.define("chosen-selectpicker",function(i){if(!m.fn.chosen){v.error("MissingLibrary",'chosen is required to use "chosen-selectpicker" plugin. Get it here: https://github.com/harvesthq/chosen')}if(this.settings.plugins["bt-selectpicker"]){v.error("Conflict","bt-selectpicker is already selected as the dropdown plugin. Please remove chosen-selectpicker from the plugin list")}var n=h.selectors;this.on("afterCreateRuleFilters",function(e,t){t.$el.find(n.rule_filter).removeClass("form-control").chosen(i)});this.on("afterCreateRuleOperators",function(e,t){t.$el.find(n.rule_operator).removeClass("form-control").chosen(i)});this.on("afterUpdateRuleFilter",function(e,t){t.$el.find(n.rule_filter).trigger("chosen:updated")});this.on("afterUpdateRuleOperator",function(e,t){t.$el.find(n.rule_operator).trigger("chosen:updated")});this.on("beforeDeleteRule",function(e,t){t.$el.find(n.rule_filter).chosen("destroy");t.$el.find(n.rule_operator).chosen("destroy")})});h.define("filter-description",function(r){if(r.mode==="inline"){this.on("afterUpdateRuleFilter afterUpdateRuleOperator",function(e,t){var i=t.$el.find("p.filter-description");var n=e.builder.getFilterDescription(t.filter,t);if(!n){i.hide()}else{if(i.length===0){i=m('<p class="filter-description"></p>');i.appendTo(t.$el)}else{i.css("display","")}i.html('<i class="'+r.icon+'"></i> '+n)}})}else if(r.mode==="popover"){if(!m.fn.popover||!m.fn.popover.Constructor||!m.fn.popover.Constructor.prototype.fixTitle){v.error("MissingLibrary",'Bootstrap Popover is required to use "filter-description" plugin. Get it here: http://getbootstrap.com')}this.on("afterUpdateRuleFilter afterUpdateRuleOperator",function(e,t){var i=t.$el.find("button.filter-description");var n=e.builder.getFilterDescription(t.filter,t);if(!n){i.hide();if(i.data("bs.popover")){i.popover("hide")}}else{if(i.length===0){i=m('<button type="button" class="btn btn-sm btn-info filter-description" data-toggle="popover"><i class="'+r.icon+'"></i></button>');i.prependTo(t.$el.find(h.selectors.rule_actions));i.popover({placement:"left",container:"body",html:true});i.on("mouseout",function(){i.popover("hide")})}else{i.css("display","")}i.data("bs.popover").options.content=n;if(i.attr("aria-describedby")){i.popover("show")}}})}else if(r.mode==="bootbox"){if(!("bootbox"in window)){v.error("MissingLibrary",'Bootbox is required to use "filter-description" plugin. Get it here: http://bootboxjs.com')}this.on("afterUpdateRuleFilter afterUpdateRuleOperator",function(e,t){var i=t.$el.find("button.filter-description");var n=e.builder.getFilterDescription(t.filter,t);if(!n){i.hide()}else{if(i.length===0){i=m('<button type="button" class="btn btn-sm btn-info filter-description" data-toggle="bootbox"><i class="'+r.icon+'"></i></button>');i.prependTo(t.$el.find(h.selectors.rule_actions));i.on("click",function(){bootbox.alert(i.data("description"))})}else{i.css("display","")}i.data("description",n)}})}},{icon:"glyphicon glyphicon-info-sign",mode:"popover"});h.extend({getFilterDescription:function(e,t){if(!e){return undefined}else if(typeof e.description=="function"){return e.description.call(this,t)}else{return e.description}}});h.define("invert",function(i){var n=this;var r=h.selectors;this.on("afterInit",function(){n.$el.on("click.queryBuilder","[data-invert=group]",function(){var e=m(this).closest(r.group_container);n.invert(n.getModel(e),i)});if(i.display_rules_button&&i.invert_rules){n.$el.on("click.queryBuilder","[data-invert=rule]",function(){var e=m(this).closest(r.rule_container);n.invert(n.getModel(e),i)})}});if(!i.disable_template){this.on("getGroupTemplate.filter",function(e){var t=m(e.value);t.find(r.condition_container).after('<button type="button" class="btn btn-sm btn-default" data-invert="group">'+'<i class="'+i.icon+'"></i> '+n.translate("invert")+"</button>");e.value=t.prop("outerHTML")});if(i.display_rules_button&&i.invert_rules){this.on("getRuleTemplate.filter",function(e){var t=m(e.value);t.find(r.rule_actions).prepend('<button type="button" class="btn btn-sm btn-default" data-invert="rule">'+'<i class="'+i.icon+'"></i> '+n.translate("invert")+"</button>");e.value=t.prop("outerHTML")})}}},{icon:"glyphicon glyphicon-random",recursive:true,invert_rules:true,display_rules_button:false,silent_fail:false,disable_template:false});h.defaults({operatorOpposites:{equal:"not_equal",not_equal:"equal",in:"not_in",not_in:"in",less:"greater_or_equal",less_or_equal:"greater",greater:"less_or_equal",greater_or_equal:"less",between:"not_between",not_between:"between",begins_with:"not_begins_with",not_begins_with:"begins_with",contains:"not_contains",not_contains:"contains",ends_with:"not_ends_with",not_ends_with:"ends_with",is_empty:"is_not_empty",is_not_empty:"is_empty",is_null:"is_not_null",is_not_null:"is_null"},conditionOpposites:{AND:"OR",OR:"AND"}});h.extend({invert:function(e,t){if(!(e instanceof r)){if(!this.model.root)return;t=e;e=this.model.root}if(typeof t!="object")t={};if(t.recursive===undefined)t.recursive=true;if(t.invert_rules===undefined)t.invert_rules=true;if(t.silent_fail===undefined)t.silent_fail=false;if(t.trigger===undefined)t.trigger=true;if(e instanceof c){if(this.settings.conditionOpposites[e.condition]){e.condition=this.settings.conditionOpposites[e.condition]}else if(!t.silent_fail){v.error("InvertCondition",'Unknown inverse of condition "{0}"',e.condition)}if(t.recursive){var i=m.extend({},t,{trigger:false});e.each(function(e){if(t.invert_rules){this.invert(e,i)}},function(e){this.invert(e,i)},this)}}else if(e instanceof s){if(e.operator&&!e.filter.no_invert){if(this.settings.operatorOpposites[e.operator.type]){var n=this.settings.operatorOpposites[e.operator.type];if(!e.filter.operators||e.filter.operators.indexOf(n)!=-1){e.operator=this.getOperatorByType(n)}}else if(!t.silent_fail){v.error("InvertOperator",'Unknown inverse of operator "{0}"',e.operator.type)}}}if(t.trigger){this.trigger("afterInvert",e,t);this.trigger("rulesChanged")}}});h.defaults({mongoOperators:{equal:function(e){return e[0]},not_equal:function(e){return{$ne:e[0]}},in:function(e){return{$in:e}},not_in:function(e){return{$nin:e}},less:function(e){return{$lt:e[0]}},less_or_equal:function(e){return{$lte:e[0]}},greater:function(e){return{$gt:e[0]}},greater_or_equal:function(e){return{$gte:e[0]}},between:function(e){return{$gte:e[0],$lte:e[1]}},not_between:function(e){return{$lt:e[0],$gt:e[1]}},begins_with:function(e){return{$regex:"^"+v.escapeRegExp(e[0])}},not_begins_with:function(e){return{$regex:"^(?!"+v.escapeRegExp(e[0])+")"}},contains:function(e){return{$regex:v.escapeRegExp(e[0])}},not_contains:function(e){return{$regex:"^((?!"+v.escapeRegExp(e[0])+").)*$",$options:"s"}},ends_with:function(e){return{$regex:v.escapeRegExp(e[0])+"$"}},not_ends_with:function(e){return{$regex:"(?<!"+v.escapeRegExp(e[0])+")$"}},is_empty:function(e){return""},is_not_empty:function(e){return{$ne:""}},is_null:function(e){return null},is_not_null:function(e){return{$ne:null}}},mongoRuleOperators:{$eq:function(e){return{val:e,op:e===null?"is_null":e===""?"is_empty":"equal"}},$ne:function(e){e=e.$ne;return{val:e,op:e===null?"is_not_null":e===""?"is_not_empty":"not_equal"}},$regex:function(e){e=e.$regex;if(e.slice(0,4)=="^(?!"&&e.slice(-1)==")"){return{val:e.slice(4,-1),op:"not_begins_with"}}else if(e.slice(0,5)=="^((?!"&&e.slice(-5)==").)*$"){return{val:e.slice(5,-5),op:"not_contains"}}else if(e.slice(0,4)=="(?<!"&&e.slice(-2)==")$"){return{val:e.slice(4,-2),op:"not_ends_with"}}else if(e.slice(-1)=="$"){return{val:e.slice(0,-1),op:"ends_with"}}else if(e.slice(0,1)=="^"){return{val:e.slice(1),op:"begins_with"}}else{return{val:e,op:"contains"}}},between:function(e){return{val:[e.$gte,e.$lte],op:"between"}},not_between:function(e){return{val:[e.$lt,e.$gt],op:"not_between"}},$in:function(e){return{val:e.$in,op:"in"}},$nin:function(e){return{val:e.$nin,op:"not_in"}},$lt:function(e){return{val:e.$lt,op:"less"}},$lte:function(e){return{val:e.$lte,op:"less_or_equal"}},$gt:function(e){return{val:e.$gt,op:"greater"}},$gte:function(e){return{val:e.$gte,op:"greater_or_equal"}}}});h.extend({getMongo:function(e){e=e===undefined?this.getRules():e;if(!e){return null}var a=this;return function o(e){if(!e.condition){e.condition=a.settings.default_condition}if(["AND","OR"].indexOf(e.condition.toUpperCase())===-1){v.error("UndefinedMongoCondition",'Unable to build MongoDB query with condition "{0}"',e.condition)}if(!e.rules){return{}}var s=[];e.rules.forEach(function(e){if(e.rules&&e.rules.length>0){s.push(o(e))}else{var t=a.settings.mongoOperators[e.operator];var i=a.getOperatorByType(e.operator);if(t===undefined){v.error("UndefinedMongoOperator",'Unknown MongoDB operation for operator "{0}"',e.operator)}if(i.nb_inputs!==0){if(!(e.value instanceof Array)){e.value=[e.value]}}var n=a.change("getMongoDBField",e.field,e);var r={};r[n]=t.call(a,e.value);s.push(a.change("ruleToMongo",r,e,e.value,t))}});var t={};t["$"+e.condition.toLowerCase()]=s;return a.change("groupToMongo",t,e)}(e)},getRulesFromMongo:function(e){if(e===undefined||e===null){return null}var d=this;e=d.change("parseMongoNode",e);if("rules"in e&&"condition"in e){return e}if("id"in e&&"operator"in e&&"value"in e){return{condition:this.settings.default_condition,rules:[e]}}var t=d.getMongoCondition(e);if(!t){v.error("MongoParse","Invalid MongoDB query format")}return function c(e,t){var i=e[t];var u=[];i.forEach(function(e){e=d.change("parseMongoNode",e);if("rules"in e&&"condition"in e){u.push(e);return}if("id"in e&&"operator"in e&&"value"in e){u.push(e);return}var t=d.getMongoCondition(e);if(t){u.push(c(e,t))}else{var i=Object.keys(e)[0];var n=e[i];var r=d.getMongoOperator(n);if(r===undefined){v.error("MongoParse","Invalid MongoDB query format")}var o=d.settings.mongoRuleOperators[r];if(o===undefined){v.error("UndefinedMongoOperator",'JSON Rule operation unknown for operator "{0}"',r)}var s=o.call(d,n);var a=d.getMongoDBFieldID(i,n);var l=d.change("mongoToRule",{id:a,field:i,operator:s.op,value:s.val},e);u.push(l)}});return d.change("mongoToGroup",{condition:t.replace("$","").toUpperCase(),rules:u},e)}(e,t)},setRulesFromMongo:function(e){this.setRules(this.getRulesFromMongo(e))},getMongoDBFieldID:function(t,e){var i=this.filters.filter(function(e){return e.field===t});var n;if(i.length===1){n=i[0].id}else{n=this.change("getMongoDBFieldID",t,e)}return n},getMongoOperator:function(e){if(e!==null&&typeof e==="object"){if(e.$gte!==undefined&&e.$lte!==undefined){return"between"}if(e.$lt!==undefined&&e.$gt!==undefined){return"not_between"}var t=Object.keys(e).filter(function(e){return!!this.settings.mongoRuleOperators[e]}.bind(this));if(t.length===1){return t[0]}}else{return"$eq"}},getMongoCondition:function(e){var t=Object.keys(e);for(var i=0,n=t.length;i<n;i++){if(t[i].toLowerCase()==="$or"||t[i].toLowerCase()==="$and"){return t[i]}}}});h.define("not-group",function(i){var n=this;this.on("afterInit",function(){n.$el.on("click.queryBuilder","[data-not=group]",function(){var e=m(this).closest(h.selectors.group_container);var t=n.getModel(e);t.not=!t.not});n.model.on("update",function(e,t,i){if(t instanceof c&&i==="not"){n.updateGroupNot(t)}})});this.on("afterAddGroup",function(e,t){t.__.not=false});if(!i.disable_template){this.on("getGroupTemplate.filter",function(e){var t=m(e.value);t.find(h.selectors.condition_container).prepend('<button type="button" class="btn btn-sm btn-default" data-not="group">'+'<i class="'+i.icon_unchecked+'"></i> '+n.translate("NOT")+"</button>");e.value=t.prop("outerHTML")})}this.on("groupToJson.filter",function(e,t){e.value.not=t.not});this.on("jsonToGroup.filter",function(e,t){e.value.not=!!t.not});this.on("groupToSQL.filter",function(e,t){if(t.not){e.value="NOT ( "+e.value+" )"}});this.on("parseSQLNode.filter",function(e){if(e.value.name&&e.value.name.toUpperCase()=="NOT"){e.value=e.value.arguments.value[0];if(["AND","OR"].indexOf(e.value.operation.toUpperCase())===-1){e.value=new SQLParser.nodes.Op(n.settings.default_condition,e.value,null)}e.value.not=true}});this.on("sqlGroupsDistinct.filter",function(e,t,i,n){if(i.not&&n>0){e.value=true}});this.on("sqlToGroup.filter",function(e,t){e.value.not=!!t.not});this.on("groupToMongo.filter",function(e,t){var i="$"+t.condition.toLowerCase();if(t.not&&e.value[i]){e.value={$nor:[e.value]}}});this.on("parseMongoNode.filter",function(e){var t=Object.keys(e.value);if(t[0]=="$nor"){e.value=e.value[t[0]][0];e.value.not=true}});this.on("mongoToGroup.filter",function(e,t){e.value.not=!!t.not})},{icon_unchecked:"glyphicon glyphicon-unchecked",icon_checked:"glyphicon glyphicon-check",disable_template:false});v.defineModelProperties(c,["not"]);h.selectors.group_not=h.selectors.group_header+" [data-not=group]";h.extend({updateGroupNot:function(e){var t=this.plugins["not-group"];e.$el.find(">"+h.selectors.group_not).toggleClass("active",e.not).find("i").attr("class",e.not?t.icon_checked:t.icon_unchecked);this.trigger("afterUpdateGroupNot",e);this.trigger("rulesChanged")}});h.define("sortable",function(n){if(!("interact"in window)){v.error("MissingLibrary",'interact.js is required to use "sortable" plugin. Get it here: http://interactjs.io')}if(n.default_no_sortable!==undefined){v.error(false,"Config",'Sortable plugin : "default_no_sortable" options is deprecated, use standard "default_rule_flags" and "default_group_flags" instead');this.settings.default_rule_flags.no_sortable=this.settings.default_group_flags.no_sortable=n.default_no_sortable}interact.dynamicDrop(true);interact.pointerMoveTolerance(10);var r;var o;var s;var a;this.on("afterAddRule afterAddGroup",function(e,t){if(t==r){return}var i=e.builder;if(n.inherit_no_sortable&&t.parent&&t.parent.flags.no_sortable){t.flags.no_sortable=true}if(n.inherit_no_drop&&t.parent&&t.parent.flags.no_drop){t.flags.no_drop=true}if(!t.flags.no_sortable){interact(t.$el[0]).draggable({allowFrom:h.selectors.drag_handle,onstart:function(e){a=false;s=i.getModel(e.target);o=s.$el.clone().appendTo(s.$el.parent()).width(s.$el.outerWidth()).addClass("dragging");var t=m('<div class="rule-placeholder">&nbsp;</div>').height(s.$el.outerHeight());r=s.parent.addRule(t,s.getPos());s.$el.hide()},onmove:function(e){o[0].style.top=e.clientY-15+"px";o[0].style.left=e.clientX-15+"px"},onend:function(e){if(e.dropzone){l(s,m(e.relatedTarget),i);a=true}o.remove();o=undefined;r.drop();r=undefined;s.$el.css("display","");i.trigger("afterMove",s);i.trigger("rulesChanged")}})}if(!t.flags.no_drop){interact(t.$el[0]).dropzone({accept:h.selectors.rule_and_group_containers,ondragenter:function(e){l(r,m(e.target),i)},ondrop:function(e){if(!a){l(s,m(e.target),i)}}});if(t instanceof c){interact(t.$el.find(h.selectors.group_header)[0]).dropzone({accept:h.selectors.rule_and_group_containers,ondragenter:function(e){l(r,m(e.target),i)},ondrop:function(e){if(!a){l(s,m(e.target),i)}}})}}});this.on("beforeDeleteRule beforeDeleteGroup",function(e,t){if(!e.isDefaultPrevented()){interact(t.$el[0]).unset();if(t instanceof c){interact(t.$el.find(h.selectors.group_header)[0]).unset()}}});this.on("afterApplyRuleFlags afterApplyGroupFlags",function(e,t){if(t.flags.no_sortable){t.$el.find(".drag-handle").remove()}});if(!n.disable_template){this.on("getGroupTemplate.filter",function(e,t){if(t>1){var i=m(e.value);i.find(h.selectors.condition_container).after(`<div class="drag-handle"><i class="${n.icon}"></i></div>`);e.value=i.prop("outerHTML")}});this.on("getRuleTemplate.filter",function(e){var t=m(e.value);t.find(h.selectors.rule_header).after(`<div class="drag-handle"><i class="${n.icon}"></i></div>`);e.value=t.prop("outerHTML")})}},{inherit_no_sortable:true,inherit_no_drop:true,icon:"glyphicon glyphicon-sort",disable_template:false});h.selectors.rule_and_group_containers=h.selectors.rule_container+", "+h.selectors.group_container;h.selectors.drag_handle=".drag-handle";h.defaults({default_rule_flags:{no_sortable:false,no_drop:false},default_group_flags:{no_sortable:false,no_drop:false}});function l(e,t,i){var n,r;var o=h.selectors;n=t.closest(o.rule_container);if(n.length){r="moveAfter"}if(!r){n=t.closest(o.group_header);if(n.length){n=t.closest(o.group_container);r="moveAtBegin"}}if(!r){n=t.closest(o.group_container);if(n.length){r="moveAtEnd"}}if(r){e[r](i.getModel(n));if(i&&e instanceof s){i.setRuleInputValue(e,e.value)}}}h.define("sql-support",function(e){},{boolean_as_integer:true});h.defaults({sqlOperators:{equal:{op:"= ?"},not_equal:{op:"!= ?"},in:{op:"IN(?)",sep:", "},not_in:{op:"NOT IN(?)",sep:", "},less:{op:"< ?"},less_or_equal:{op:"<= ?"},greater:{op:"> ?"},greater_or_equal:{op:">= ?"},between:{op:"BETWEEN ?",sep:" AND "},not_between:{op:"NOT BETWEEN ?",sep:" AND "},begins_with:{op:"LIKE(?)",mod:"{0}%"},not_begins_with:{op:"NOT LIKE(?)",mod:"{0}%"},contains:{op:"LIKE(?)",mod:"%{0}%"},not_contains:{op:"NOT LIKE(?)",mod:"%{0}%"},ends_with:{op:"LIKE(?)",mod:"%{0}"},not_ends_with:{op:"NOT LIKE(?)",mod:"%{0}"},is_empty:{op:"= ''"},is_not_empty:{op:"!= ''"},is_null:{op:"IS NULL"},is_not_null:{op:"IS NOT NULL"}},sqlRuleOperator:{"=":function(e){return{val:e,op:e===""?"is_empty":"equal"}},"!=":function(e){return{val:e,op:e===""?"is_not_empty":"not_equal"}},LIKE:function(e){if(e.slice(0,1)=="%"&&e.slice(-1)=="%"){return{val:e.slice(1,-1),op:"contains"}}else if(e.slice(0,1)=="%"){return{val:e.slice(1),op:"ends_with"}}else if(e.slice(-1)=="%"){return{val:e.slice(0,-1),op:"begins_with"}}else{v.error("SQLParse",'Invalid value for LIKE operator "{0}"',e)}},"NOT LIKE":function(e){if(e.slice(0,1)=="%"&&e.slice(-1)=="%"){return{val:e.slice(1,-1),op:"not_contains"}}else if(e.slice(0,1)=="%"){return{val:e.slice(1),op:"not_ends_with"}}else if(e.slice(-1)=="%"){return{val:e.slice(0,-1),op:"not_begins_with"}}else{v.error("SQLParse",'Invalid value for NOT LIKE operator "{0}"',e)}},IN:function(e){return{val:e,op:"in"}},"NOT IN":function(e){return{val:e,op:"not_in"}},"<":function(e){return{val:e,op:"less"}},"<=":function(e){return{val:e,op:"less_or_equal"}},">":function(e){return{val:e,op:"greater"}},">=":function(e){return{val:e,op:"greater_or_equal"}},BETWEEN:function(e){return{val:e,op:"between"}},"NOT BETWEEN":function(e){return{val:e,op:"not_between"}},IS:function(e){if(e!==null){v.error("SQLParse","Invalid value for IS operator")}return{val:null,op:"is_null"}},"IS NOT":function(e){if(e!==null){v.error("SQLParse","Invalid value for IS operator")}return{val:null,op:"is_not_null"}}},sqlStatements:{question_mark:function(){var i=[];return{add:function(e,t){i.push(t);return"?"},run:function(){return i}}},numbered:function(i){if(!i||i.length>1)i="$";var n=0;var r=[];return{add:function(e,t){r.push(t);n++;return i+n},run:function(){return r}}},named:function(n){if(!n||n.length>1)n=":";var r={};var o={};return{add:function(e,t){if(!r[e.field])r[e.field]=1;var i=e.field+"_"+r[e.field]++;o[i]=t;return n+i},run:function(){return o}}}},sqlRuleStatement:{question_mark:function(t){var i=0;return{parse:function(e){return e=="?"?t[i++]:e},esc:function(e){return e.replace(/\?/g,"'?'")}}},numbered:function(t,i){if(!i||i.length>1)i="$";var n=new RegExp("^\\"+i+"[0-9]+$");var r=new RegExp("\\"+i+"([0-9]+)","g");return{parse:function(e){return n.test(e)?t[e.slice(1)-1]:e},esc:function(e){return e.replace(r,"'"+(i=="$"?"$$":i)+"$1'")}}},named:function(t,i){if(!i||i.length>1)i=":";var n=new RegExp("^\\"+i);var r=new RegExp("\\"+i+"("+Object.keys(t).join("|")+")","g");return{parse:function(e){return n.test(e)?t[e.slice(1)]:e},esc:function(e){return e.replace(r,"'"+(i=="$"?"$$":i)+"$1'")}}}}});h.extend({getSQL:function(c,u,e){e=e===undefined?this.getRules():e;if(!e){return null}u=!!u?"\n":" ";var d=this.getPluginOptions("sql-support","boolean_as_integer");if(c===true){c="question_mark"}if(typeof c=="string"){var t=o(c);c=this.settings.sqlStatements[t[1]](t[2])}var h=this;var i=function a(e){if(!e.condition){e.condition=h.settings.default_condition}if(["AND","OR"].indexOf(e.condition.toUpperCase())===-1){v.error("UndefinedSQLCondition",'Unable to build SQL query with condition "{0}"',e.condition)}if(!e.rules){return""}var l=[];e.rules.forEach(function(i){if(i.rules&&i.rules.length>0){l.push("("+u+a(i)+u+")"+u)}else{var n=h.settings.sqlOperators[i.operator];var e=h.getOperatorByType(i.operator);var r="";if(n===undefined){v.error("UndefinedSQLOperator",'Unknown SQL operation for operator "{0}"',i.operator)}if(e.nb_inputs!==0){if(!(i.value instanceof Array)){i.value=[i.value]}i.value.forEach(function(e,t){if(t>0){r+=n.sep}if(i.type=="boolean"&&d){e=e?1:0}else if(!c&&i.type!=="integer"&&i.type!=="double"&&i.type!=="boolean"){e=v.escapeString(e)}if(n.mod){e=v.fmt(n.mod,e)}if(c){r+=c.add(i,e)}else{if(typeof e=="string"){e="'"+e+"'"}r+=e}})}var t=function(e){return n.op.replace("?",function(){return e})};var o=h.change("getSQLField",i.field,i);var s=o+" "+t(r);l.push(h.change("ruleToSQL",s,i,r,t))}});var t=l.join(" "+e.condition+u);return h.change("groupToSQL",t,e)}(e);if(c){return{sql:i,params:c.run()}}else{return{sql:i}}},getRulesFromSQL:function(e,f){if(!("SQLParser"in window)){v.error("MissingLibrary","SQLParser is required to parse SQL queries. Get it here https://github.com/mistic100/sql-parser")}var p=this;if(typeof e=="string"){e={sql:e}}if(f===true)f="question_mark";if(typeof f=="string"){var t=o(f);f=this.settings.sqlRuleStatement[t[1]](e.params,t[2])}if(f){e.sql=f.esc(e.sql)}if(e.sql.toUpperCase().indexOf("SELECT")!==0){e.sql="SELECT * FROM table WHERE "+e.sql}var i=SQLParser.parse(e.sql);if(!i.where){v.error("SQLParse","No WHERE clause found")}var n=p.change("parseSQLNode",i.where.conditions);if("rules"in n&&"condition"in n){return n}if("id"in n&&"operator"in n&&"value"in n){return{condition:this.settings.default_condition,rules:[n]}}var r=p.change("sqlToGroup",{condition:this.settings.default_condition,rules:[]},n);var g=r;(function e(t,i){if(t===null){return}t=p.change("parseSQLNode",t);if("rules"in t&&"condition"in t){g.rules.push(t);return}if("id"in t&&"operator"in t&&"value"in t){g.rules.push(t);return}if(!("left"in t)||!("right"in t)||!("operation"in t)){v.error("SQLParse","Unable to parse WHERE clause")}if(["AND","OR"].indexOf(t.operation.toUpperCase())!==-1){var n=p.change("sqlGroupsDistinct",i>0&&g.condition!=t.operation.toUpperCase(),g,t,i);if(n){var r=p.change("sqlToGroup",{condition:p.settings.default_condition,rules:[]},t);g.rules.push(r);g=r}g.condition=t.operation.toUpperCase();i++;var o=g;e(t.left,i);g=o;e(t.right,i)}else{if(m.isPlainObject(t.right.value)){v.error("SQLParse","Value format not supported for {0}.",t.left.value)}var s;if(m.isArray(t.right.value)){s=t.right.value.map(function(e){return e.value})}else{s=t.right.value}if(f){if(m.isArray(s)){s=s.map(f.parse)}else{s=f.parse(s)}}var a=t.operation.toUpperCase();if(a=="<>"){a="!="}var l=p.settings.sqlRuleOperator[a];if(l===undefined){v.error("UndefinedSQLOperator",'Invalid SQL operation "{0}".',t.operation)}var c=l.call(this,s,t.operation);var u;if("values"in t.left){u=t.left.values.join(".")}else if("value"in t.left){u=t.left.value}else{v.error("SQLParse","Cannot find field name in {0}",JSON.stringify(t.left))}var d=p.getSQLFieldID(u,s);var h=p.change("sqlToRule",{id:d,field:u,operator:c.op,value:c.val},t);g.rules.push(h)}})(n,0);return r},setRulesFromSQL:function(e,t){this.setRules(this.getRulesFromSQL(e,t))},getSQLFieldID:function(t,e){var i=this.filters.filter(function(e){return e.field.toLowerCase()===t.toLowerCase()});var n;if(i.length===1){n=i[0].id}else{n=this.change("getSQLFieldID",t,e)}return n}});function o(e){var t=e.match(/(question_mark|numbered|named)(?:\((.)\))?/);if(!t)t=[null,"question_mark",undefined];return t}h.define("unique-filter",function(){this.status.used_filters={};this.on("afterUpdateRuleFilter",this.updateDisabledFilters);this.on("afterDeleteRule",this.updateDisabledFilters);this.on("afterCreateRuleFilters",this.applyDisabledFilters);this.on("afterReset",this.clearDisabledFilters);this.on("afterClear",this.clearDisabledFilters);this.on("getDefaultFilter.filter",function(t,i){var n=t.builder;n.updateDisabledFilters();if(t.value.id in n.status.used_filters){var e=n.filters.some(function(e){if(!(e.id in n.status.used_filters)||n.status.used_filters[e.id].length>0&&n.status.used_filters[e.id].indexOf(i.parent)===-1){t.value=e;return true}});if(!e){v.error(false,"UniqueFilter","No more non-unique filters available");t.value=undefined}}})});h.extend({updateDisabledFilters:function(e){var i=e?e.builder:this;i.status.used_filters={};if(!i.model){return}(function t(e){e.each(function(e){if(e.filter&&e.filter.unique){if(!i.status.used_filters[e.filter.id]){i.status.used_filters[e.filter.id]=[]}if(e.filter.unique=="group"){i.status.used_filters[e.filter.id].push(e.parent)}}},function(e){t(e)})})(i.model.root);i.applyDisabledFilters(e)},clearDisabledFilters:function(e){var t=e?e.builder:this;t.status.used_filters={};t.applyDisabledFilters(e)},applyDisabledFilters:function(e){var i=e?e.builder:this;i.$el.find(h.selectors.filter_container+" option").prop("disabled",false);m.each(i.status.used_filters,function(t,e){if(e.length===0){i.$el.find(h.selectors.filter_container+' option[value="'+t+'"]:not(:selected)').prop("disabled",true)}else{e.forEach(function(e){e.each(function(e){e.$el.find(h.selectors.filter_container+' option[value="'+t+'"]:not(:selected)').prop("disabled",true)})})}});if(i.settings.plugins&&i.settings.plugins["bt-selectpicker"]){i.$el.find(h.selectors.rule_filter).selectpicker("render")}}});h.regional["en"]={__locale:"English (en)",__author:'Damien "Mistic" Sorel, http://www.strangeplanet.fr',add_rule:t("querybuilder.common.add_rule"),add_group:t("querybuilder.common.add_group"),delete_rule:t("querybuilder.common.delete_rule"),delete_group:t("querybuilder.common.delete_group"),conditions:{AND:t("querybuilder.conditions.AND"),OR:t("querybuilder.conditions.OR")},operators:{equal:t("querybuilder.operators.equal"),not_equal:t("querybuilder.operators.not_equal"),in:t("querybuilder.operators.in"),not_in:t("querybuilder.operators.not_in"),less:t("querybuilder.operators.less"),less_or_equal:t("querybuilder.operators.less_or_equal"),greater:t("querybuilder.operators.greater"),greater_or_equal:t("querybuilder.operators.greater_or_equal"),between:t("querybuilder.operators.between"),not_between:t("querybuilder.operators.not_between"),begins_with:t("querybuilder.operators.begins_with"),not_begins_with:t("querybuilder.operators.not_begins_with"),contains:t("querybuilder.operators.contains"),not_contains:t("querybuilder.operators.not_contains"),ends_with:t("querybuilder.operators.ends_with"),not_ends_with:t("querybuilder.operators.not_ends_with"),is_empty:t("querybuilder.operators.is_empty"),is_not_empty:t("querybuilder.operators.is_not_empty"),is_null:t("querybuilder.operators.is_null"),is_not_null:t("querybuilder.operators.is_not_null"),before:t("querybuilder.operators.before"),after:t("querybuilder.operators.after"),like:"Like",not_like:"Not like"},errors:{no_filter:t("querybuilder.errors.no_filter"),empty_group:t("querybuilder.errors.empty_group"),radio_empty:t("querybuilder.errors.radio_empty"),checkbox_empty:t("querybuilder.errors.checkbox_empty"),select_empty:t("querybuilder.errors.select_empty"),string_empty:t("querybuilder.errors.string_empty"),string_exceed_min_length:t("querybuilder.errors.string_exceed_min_length"),string_exceed_max_length:t("querybuilder.errors.string_exceed_max_length"),string_invalid_format:t("querybuilder.errors.string_invalid_format"),number_nan:t("querybuilder.errors.number_nan"),number_not_integer:t("querybuilder.errors.number_not_integer"),number_not_double:t("querybuilder.errors.number_not_double"),number_exceed_min:t("querybuilder.errors.number_exceed_min"),number_exceed_max:t("querybuilder.errors.number_exceed_max"),number_wrong_step:t("querybuilder.errors.number_wrong_step"),number_between_invalid:"Invalid values, {0} is greater than {1}",datetime_empty:t("querybuilder.errors.datetime_empty"),datetime_invalid:t("querybuilder.errors.datetime_invalid"),datetime_exceed_min:t("querybuilder.errors.datetime_exceed_min"),datetime_exceed_max:t("querybuilder.errors.datetime_exceed_max"),datetime_between_invalid:"Invalid values, {0} is greater than {1}",boolean_not_valid:t("querybuilder.errors.boolean_not_valid"),operator_not_multiple:t("querybuilder.errors.operator_not_multiple")},invert:t("querybuilder.common.invert"),NOT:"NOT"};h.defaults({lang_code:"en"});return h});(function(){class n{constructor(e,r,t){const o=this;r=_.bind(r,this);if(t&&t.exists()){t=t.first()}else{t=$(document)}_.each(e,(e,n)=>{t.on(n,e,function(e,t){o.event=e;o.trigger=n;o.el=$(this);o.data=t;r();const i=$(o.event.target);if(i.is("a")||i.parent("a").length===1){o.event.preventDefault()}})})}static new(e,t,i){new n(e,t,i)}static translate(e){const i={};_.each(e,function(e,t){e=e.split(/,\s?/);e=_.map(e,e=>`[data-action="${e}"]`).join(", ");i[t]=e});return i}}AGN.Lib.Action=n})();(function(){function s(e,i,n){var r=AGN.Lib.Storage.get("autosave#"+e);if(r){var o=i?i(r.values,r.timestamp):r.values;if(o){var s=AGN.Lib.Template.text("autosave-restore",{title:t("autosave.confirm.title"),content:t("autosave.confirm.question",new Date(r.timestamp).toLocaleString(window.adminLocale,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),negative:t("autosave.discard"),positive:t("autosave.restore")});var a=AGN.Lib.Confirm.create(s).done(function(){n(o===true?r.values:o,r.timestamp);AGN.Lib.Messages(t("autosave.success.title"),t("autosave.success.message"),"success")}).always(function(){AGN.Lib.Storage.delete("autosave#"+e)});return a.promise()}else{AGN.Lib.Storage.delete("autosave#"+e)}}return $.Deferred().reject().promise()}function a(t,i,e){var n=function(){var e=i();if(e){AGN.Lib.Storage.set("autosave#"+t,{timestamp:(new Date).getTime(),values:e})}return e!==false};if(e>0){var r=setInterval(function(){n()||clearInterval(r)},e*1e3)}var o=function(){n()||$(document).unbind("ajax:unauthorized",o)};$(document).on("ajax:unauthorized",o)}AGN.Lib.AutoSave={initialize:function(e,t,i,n,r){var o=s(e,i,n);a(e,t,r);return o}}})();(function(){AGN.Lib.ChartUtils={getTotal:e=>e.reduce((e,t)=>e+t,0),calcExactPercentages:function(e){const t=this.getTotal(e);return e.map(e=>e/t*100)}}})();(function(){function e(e,t){try{navigator.clipboard.writeText(e).then(function(){t(true)},function(){t(false)})}catch(e){console.warn(e);t(false)}}function n(e,t){var i=true;try{var n=$("<input>");$("body").append(n);n.val(e);n.select();document.execCommand("copy");n.remove()}catch(e){console.warn(e);i=false}if(t){t(i)}}AGN.Lib.Clipboard={set:function(t,i){e(t,function(e){if(e){if(i){i(t,true)}}else{n(t,function(e){if(i){i(t,e)}})}})}}})();(function(){class i{static DATA_KEY="agn:colorpicker";static get(e){return e.data(i.DATA_KEY)}constructor(t){this.$el=t;this.$trigger=this.#createTriggerInput();t.spectrum({showInput:true,allowEmpty:true,preferredFormat:"hex",move:e=>{t.val(e.toHexString());this.$trigger.val(e.toHexString());this.#updatePipetteColor(e)},change:e=>{this.#updatePipetteColor(e)}});this.#updatePipetteColor(t.spectrum("get"));t.data(i.DATA_KEY,this)}#createTriggerInput(){const t=this.$el.clone();if(this.$el.attr("id")){t.attr("id",this.$el.attr("id")+"_colorpicker")}t.attr("name","");t.removeClass("js-colorpicker");this.$el.before(t);t.on("input",()=>{const e=t.val();this.$el.spectrum("set",e);this.#updatePipetteColor(this.$el.spectrum("get"))});t.on("blur",()=>t.val(this.$el.val()));return t}#updatePipetteColor(e){const t=e?this.#invertColor(e.toHexString()):this.$el.css("--default-text-color");this.$el.parent().find(".sp-preview").css("color",t)}#invertColor(e){return AGN.Lib.Helpers.getColorLuminance(e)>.5?"#000":"#FFF"}}AGN.Lib.Colorpicker=i})();(function(){var o;o=function(e,t){this.$modal=e;this.deferred=t||$.Deferred()};o.get=function(e){var t=o.getWrapper(e);return t.data("_confirm")};o.create=function(e,t){var i,n=AGN.Lib.Modal.create(e);i=new o(n,t);if(n){n.data("_confirm",i)}return i.promise()};o.createFromTemplate=function(e,t,i){var n,r=AGN.Lib.Modal.fromTemplate(t,e);n=new o(r,i);r.data("_confirm",n);return n.promise()};o.request=function(e){var r=$.Deferred();var t;if(_.isString(e)){t=$.get(e)}else{t=e}t.done(function(e){var t=$(e),i=t.all(".modal");if(i.length===1){var n=new o(i,r);i.data("_confirm",n);AGN.Lib.Modal.create(i)}else{AGN.Lib.Page.render(e);r.reject()}}).fail(function(){r.reject()});return r.promise()};o.getWrapper=function(e){var t;t=$(e.data("confirm-target"));if(t.length==0){t=e.closest(".modal")}return t};o.prototype.promise=function(){return this.deferred.promise()};o.prototype.positive=function(e){this.deferred.resolve(e);this.$modal.modal("hide");this.$modal.remove()};o.prototype.negative=function(e){this.deferred.reject(e);this.$modal.modal("hide");this.$modal.remove()};AGN.Lib.Confirm=o})();(function(){AGN.Lib.ContextMenu={create:function(e){$.each(e,function(e,i){$.contextMenu({selector:e,build:function(e,t){return n(i,e,t)}})})}};function n(e,n,r){if(e.shown===false||_.isFunction(e.shown)&&e.shown(n,r)===false){return false}var t=e.items;if(_.isFunction(t)){t=t(n,r)}var o={};var s=0;$.each(t,function(e,i){if(!_.isFunction(i.shown)||i.shown(n,r)!==false){var t=o[e]={name:i.name,icon:i.icon};if(_.isFunction(i.disabled)){t.disabled=i.disabled(n,r)===true}else if(i.disabled===true){t.disabled=true}if(_.isFunction(i.clicked)){t.callback=function(e,t){i.clicked(n,e,t)}}s++}});return s?{items:o}:false}})();(function(){var e;e=function(e){e=_.bind(e,this);e()};e.prototype.addAction=function(e,t){AGN.Lib.Action.new(AGN.Lib.Action.translate(e),t)};e.prototype.addInitializer=function(e,t){AGN.Lib.CoreInitializer.new(e,t)};e.prototype.addDomInitializer=function(e,t){AGN.Lib.DomInitializer.new(e,t)};e.prototype.runInitializer=function(e){AGN.Lib.CoreInitializer.run(e)};e.new=function(e,t){AGN.Opt.Controllers[e]=t};e.init=function(e){if(!e){e=$(document)}e.all("[data-controller]").each(function(){var e=$(this),t=AGN.Opt.Controllers[e.data("controller")];if(t){new AGN.Lib.Controller(t);AGN.Opt.Controllers[e.data("controller")]=undefined}})};AGN.Lib.Controller=e})();(function(){var s={};function e(e){var t=null;var i;if(arguments.length>2){t=arguments[1];i=arguments[2]}else{i=arguments[1]}if(_.isFunction(i)){s["key#"+e]={name:e,handler:i,dependencies:t}}else{console.error("Handler must be a function")}}function a(n,e,r,o){var t="key#"+e.name;if(r[t]){return}if(Array.isArray(e.dependencies)&&e.dependencies.length){o.push(e.name);e.dependencies.forEach(function(e){var t=s["key#"+e];if(t){if(o.includes(e)){var i=o.map(function(e){return"`"+e+"`"}).join(" => ");console.error("Cyclic initializer dependency detected ("+i+" => `"+e+"`)");return}a(n,t,r,o)}else{console.error("Unknown initializer dependency: `"+name+"`")}});o.pop()}try{e.handler.call(e.handler,n)}catch(e){console.error(e)}r[t]=true}function t(i){var n={};var r=[];$.each(s,function(e,t){a(i,t,n,r)})}function n(e,t){if(Array.isArray(e)){e.forEach(function(e){n(e,t)})}else{var i=s["key#"+e];if(i){i.handler.call(i.handler,t);return true}else{console.error("Unknown initializer: `"+e+"`");return false}}}AGN.Lib.CoreInitializer={autorun:t,run:n,new:e}})();(function(){function r(){if(o()){return AGN.Lib.Storage.readCookie(window.csrfCookieName)}return""}function e(){return window.csrfParameterName}function o(){return window.csrfHeaderName&&e()&&window.csrfCookieName}function t(e,t){if(o()&&t!=="GET"){const i=r();e.setRequestHeader(window.csrfHeaderName,i)}}function i(e,t){if(!o()){return e}if(!e){e=$(document)}else if(!(e instanceof $)){e=$("<div>").append(e)}const i=r();const n=e.find('input[name="'+window.csrfParameterName+'"]');_.each(n,function(e){$(e).val(i)});if(t){return e.html()}}AGN.Lib.CSRF={readActualToken:r,isProtectionEnabled:o,setTokenToReqHeader:t,getParameterName:e,updateTokenInDOM:i}})();(function(){var r={};r.get=function(e){var t=e.data("provider"),i=e.data("provider-src"),n;switch(t){case"opt":n=r.opt(i);break;case"remote":n=r.remote(i);break;default:break}return n};r.opt=function(e){var t=$.Deferred();if(AGN.Opt[e]){setTimeout(function(){t.resolve(AGN.Opt[e])},100)}else{setTimeout(function(){t.reject()},100)}return t};r.remote=function(e){return $.get(e)};AGN.Lib.DataProvider=r})();(function(){let R;const s={"ar-SA":"dd/MM/yy","bg-BG":"dd.M.yyyy","ca-ES":"dd/MM/yyyy","zh-TW":"yyyy/M/d","cs-CZ":"d.M.yyyy","da-DK":"dd-MM-yyyy","de-DE":"dd.MM.yyyy","el-GR":"d/M/yyyy","en-US":"M/d/yyyy","fi-FI":"d.M.yyyy","fr-FR":"dd/MM/yyyy","he-IL":"dd/MM/yyyy","hu-HU":"yyyy. MM. dd.","is-IS":"d.M.yyyy","it-IT":"dd/MM/yyyy","ja-JP":"yyyy/MM/dd","ko-KR":"yyyy-MM-dd","nl-NL":"d-M-yyyy","nb-NO":"dd.MM.yyyy","pl-PL":"yyyy-MM-dd","pt-BR":"d/M/yyyy","ro-RO":"dd.MM.yyyy","ru-RU":"dd.MM.yyyy","hr-HR":"d.M.yyyy","sk-SK":"d. M. yyyy","sq-AL":"yyyy-MM-dd","sv-SE":"yyyy-MM-dd","th-TH":"d/M/yyyy","tr-TR":"dd.MM.yyyy","ur-PK":"dd/MM/yyyy","id-ID":"dd/MM/yyyy","uk-UA":"dd.MM.yyyy","be-BY":"dd.MM.yyyy","sl-SI":"d.M.yyyy","et-EE":"d.MM.yyyy","lv-LV":"yyyy.MM.dd.","lt-LT":"yyyy.MM.dd","fa-IR":"MM/dd/yyyy","vi-VN":"dd/MM/yyyy","hy-AM":"dd.MM.yyyy","az-Latn-AZ":"dd.MM.yyyy","eu-ES":"yyyy/MM/dd","mk-MK":"dd.MM.yyyy","af-ZA":"yyyy/MM/dd","ka-GE":"dd.MM.yyyy","fo-FO":"dd-MM-yyyy","hi-IN":"dd-MM-yyyy","ms-MY":"dd/MM/yyyy","kk-KZ":"dd.MM.yyyy","ky-KG":"dd.MM.yy","sw-KE":"M/d/yyyy","uz-Latn-UZ":"dd/MM yyyy","tt-RU":"dd.MM.yyyy","pa-IN":"dd-MM-yy","gu-IN":"dd-MM-yy","ta-IN":"dd-MM-yyyy","te-IN":"dd-MM-yy","kn-IN":"dd-MM-yy","mr-IN":"dd-MM-yyyy","sa-IN":"dd-MM-yyyy","mn-MN":"yy.MM.dd","gl-ES":"dd/MM/yy","kok-IN":"dd-MM-yyyy","syr-SY":"dd/MM/yyyy","dv-MV":"dd/MM/yy","ar-IQ":"dd/MM/yyyy","zh-CN":"yyyy/M/d","de-CH":"dd.MM.yyyy","en-GB":"dd/MM/yyyy","es-MX":"dd/MM/yyyy","fr-BE":"d/MM/yyyy","it-CH":"dd.MM.yyyy","nl-BE":"d/MM/yyyy","nn-NO":"dd.MM.yyyy","pt-PT":"dd-MM-yyyy","sr-Latn-CS":"d.M.yyyy","sv-FI":"d.M.yyyy","az-Cyrl-AZ":"dd.MM.yyyy","ms-BN":"dd/MM/yyyy","uz-Cyrl-UZ":"dd.MM.yyyy","ar-EG":"dd/MM/yyyy","zh-HK":"d/M/yyyy","de-AT":"dd.MM.yyyy","en-AU":"d/MM/yyyy","es-ES":"dd/MM/yyyy","fr-CA":"yyyy-MM-dd","sr-Cyrl-CS":"d.M.yyyy","ar-LY":"dd/MM/yyyy","zh-SG":"d/M/yyyy","de-LU":"dd.MM.yyyy","en-CA":"dd/MM/yyyy","es-GT":"dd/MM/yyyy","fr-CH":"dd.MM.yyyy","ar-DZ":"dd-MM-yyyy","zh-MO":"d/M/yyyy","de-LI":"dd.MM.yyyy","en-NZ":"d/MM/yyyy","es-CR":"dd/MM/yyyy","fr-LU":"dd/MM/yyyy","ar-MA":"dd-MM-yyyy","en-IE":"dd/MM/yyyy","es-PA":"MM/dd/yyyy","fr-MC":"dd/MM/yyyy","ar-TN":"dd-MM-yyyy","en-ZA":"yyyy/MM/dd","es-DO":"dd/MM/yyyy","ar-OM":"dd/MM/yyyy","en-JM":"dd/MM/yyyy","es-VE":"dd/MM/yyyy","ar-YE":"dd/MM/yyyy","en-029":"MM/dd/yyyy","es-CO":"dd/MM/yyyy","ar-SY":"dd/MM/yyyy","en-BZ":"dd/MM/yyyy","es-PE":"dd/MM/yyyy","ar-JO":"dd/MM/yyyy","en-TT":"dd/MM/yyyy","es-AR":"dd/MM/yyyy","ar-LB":"dd/MM/yyyy","en-ZW":"M/d/yyyy","es-EC":"dd/MM/yyyy","ar-KW":"dd/MM/yyyy","en-PH":"M/d/yyyy","es-CL":"dd-MM-yyyy","ar-AE":"dd/MM/yyyy","es-UY":"dd/MM/yyyy","ar-BH":"dd/MM/yyyy","es-PY":"dd/MM/yyyy","ar-QA":"dd/MM/yyyy","es-BO":"dd/MM/yyyy","es-SV":"dd/MM/yyyy","es-HN":"dd/MM/yyyy","es-NI":"dd/MM/yyyy","es-PR":"dd/MM/yyyy","am-ET":"d/M/yyyy","tzm-Latn-DZ":"dd-MM-yyyy","iu-Latn-CA":"d/MM/yyyy","sma-NO":"dd.MM.yyyy","mn-Mong-CN":"yyyy/M/d","gd-GB":"dd/MM/yyyy","en-MY":"d/M/yyyy","prs-AF":"dd/MM/yy","bn-BD":"dd-MM-yy","wo-SN":"dd/MM/yyyy","rw-RW":"M/d/yyyy","qut-GT":"dd/MM/yyyy","sah-RU":"MM.dd.yyyy","gsw-FR":"dd/MM/yyyy","co-FR":"dd/MM/yyyy","oc-FR":"dd/MM/yyyy","mi-NZ":"dd/MM/yyyy","ga-IE":"dd/MM/yyyy","se-SE":"yyyy-MM-dd","br-FR":"dd/MM/yyyy","smn-FI":"d.M.yyyy","moh-CA":"M/d/yyyy","arn-CL":"dd-MM-yyyy","ii-CN":"yyyy/M/d","dsb-DE":"d. M. yyyy","ig-NG":"d/M/yyyy","kl-GL":"dd-MM-yyyy","lb-LU":"dd/MM/yyyy","ba-RU":"dd.MM.yy","nso-ZA":"yyyy/MM/dd","quz-BO":"dd/MM/yyyy","yo-NG":"d/M/yyyy","ha-Latn-NG":"d/M/yyyy","fil-PH":"M/d/yyyy","ps-AF":"dd/MM/yy","fy-NL":"d-M-yyyy","ne-NP":"M/d/yyyy","se-NO":"dd.MM.yyyy","iu-Cans-CA":"d/M/yyyy","sr-Latn-RS":"d.M.yyyy","si-LK":"yyyy-MM-dd","sr-Cyrl-RS":"d.M.yyyy","lo-LA":"dd/MM/yyyy","km-KH":"yyyy-MM-dd","cy-GB":"dd/MM/yyyy","bo-CN":"yyyy/M/d","sms-FI":"d.M.yyyy","as-IN":"dd-MM-yyyy","ml-IN":"dd-MM-yy","en-IN":"dd-MM-yyyy","or-IN":"dd-MM-yy","bn-IN":"dd-MM-yy","tk-TM":"dd.MM.yy","bs-Latn-BA":"d.M.yyyy","mt-MT":"dd/MM/yyyy","sr-Cyrl-ME":"d.M.yyyy","se-FI":"d.M.yyyy","zu-ZA":"yyyy/MM/dd","xh-ZA":"yyyy/MM/dd","tn-ZA":"yyyy/MM/dd","hsb-DE":"d. M. yyyy","bs-Cyrl-BA":"d.M.yyyy","tg-Cyrl-TJ":"dd.MM.yy","sr-Latn-BA":"d.M.yyyy","smj-NO":"dd.MM.yyyy","rm-CH":"dd/MM/yyyy","smj-SE":"yyyy-MM-dd","quz-EC":"dd/MM/yyyy","quz-PE":"dd/MM/yyyy","hr-BA":"d.M.yyyy.","sr-Latn-ME":"d.M.yyyy","sma-SE":"yyyy-MM-dd","en-SG":"d/M/yyyy","ug-CN":"yyyy-M-d","sr-Cyrl-BA":"d.M.yyyy","es-US":"M/d/yyyy"};R={MONTH_NAMES:["January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],DAY_NAMES:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat"],LZ:function(e){return(e<0||e>9?"":"0")+e},compareDates:function(e,t,i,n){var r=R.parseFormat(e,t);var o=R.parseFormat(i,n);if(r==0||o==0)return-1;else if(r>o)return 1;return 0},format:function(e,t){t=t+"";var i="";var n=0;var r="";var o="";var s=e.getYear()+"";var a=e.getMonth()+1;var l=e.getDate();var c=e.getDay();var u=e.getHours();var d=e.getMinutes();var h=e.getSeconds();var f,p,g,m,v,y,b,_,w,C,x,u,S,A,E,T;var D=new Object;if(s.length<4){s=""+(s-0+1900)}D["y"]=""+s;D["yyyy"]=s;D["yy"]=s.substring(2,4);D["M"]=a;D["MM"]=R.LZ(a);D["MMM"]=R.MONTH_NAMES[a-1];D["NNN"]=R.MONTH_NAMES[a+11];D["d"]=l;D["dd"]=R.LZ(l);D["E"]=R.DAY_NAMES[c+7];D["EE"]=R.DAY_NAMES[c];D["H"]=u;D["HH"]=R.LZ(u);if(u==0){D["h"]=12}else if(u>12){D["h"]=u-12}else{D["h"]=u}D["hh"]=R.LZ(D["h"]);if(u>11){D["K"]=u-12}else{D["K"]=u}D["k"]=u+1;D["KK"]=R.LZ(D["K"]);D["kk"]=R.LZ(D["k"]);if(u>11){D["a"]="PM"}else{D["a"]="AM"}D["m"]=d;D["mm"]=R.LZ(d);D["s"]=h;D["ss"]=R.LZ(h);while(n<t.length){r=t.charAt(n);o="";while(t.charAt(n)==r&&n<t.length)o+=t.charAt(n++);if(D[o]!=null)i+=D[o];else i+=o}return i},_isInteger:function(e){var t="1234567890";for(var i=0;i<e.length;i++)if(t.indexOf(e.charAt(i))==-1)return false;return true},_getInt:function(e,t,i,n){for(var r=n;r>=i;r--){var o=e.substring(t,t+r);if(o.length<i)return null;if(R._isInteger(o))return o}return null},parseFormat:function(e,t){e=e+"";t=t+"";var i=0;var n=0;var r="";var o="";var s="";var a,l;var c=new Date;var u=c.getYear();var d=c.getMonth()+1;var h=1;var f=c.getHours();var p=c.getMinutes();var g=c.getSeconds();var m="";while(n<t.length){r=t.charAt(n);o="";while(t.charAt(n)==r&&n<t.length)o+=t.charAt(n++);if(o=="yyyy"||o=="yy"||o=="y"){if(o=="yyyy")a=4;l=4;if(o=="yy")a=2;l=2;if(o=="y")a=2;l=4;u=R._getInt(e,i,a,l);if(u==null)return 0;i+=u.length;if(u.length==2){if(u>70)u=1900+(u-0);else u=2e3+(u-0)}}else if(o=="MMM"||o=="NNN"){d=0;for(var v=0;v<R.MONTH_NAMES.length;v++){var y=R.MONTH_NAMES[v];if(e.substring(i,i+y.length).toLowerCase()==y.toLowerCase()){if(o=="MMM"||o=="NNN"&&v>11){d=v+1;if(d>12)d-=12;i+=y.length;break}}}if(d<1||d>12)return 0}else if(o=="EE"||o=="E"){for(var v=0;v<R.DAY_NAMES.length;v++){var b=R.DAY_NAMES[v];if(e.substring(i,i+b.length).toLowerCase()==b.toLowerCase()){i+=b.length;break}}}else if(o=="MM"||o=="M"){d=R._getInt(e,i,o.length,2);if(d==null||d<1||d>12)return 0;i+=d.length}else if(o=="dd"||o=="d"){h=R._getInt(e,i,o.length,2);if(h==null||h<1||h>31)return 0;i+=h.length}else if(o=="hh"||o=="h"){f=R._getInt(e,i,o.length,2);if(f==null||f<1||f>12)return 0;i+=f.length}else if(o=="HH"||o=="H"){f=R._getInt(e,i,o.length,2);if(f==null||f<0||f>23)return 0;i+=f.length}else if(o=="KK"||o=="K"){f=R._getInt(e,i,o.length,2);if(f==null||f<0||f>11)return 0;i+=f.length}else if(o=="kk"||o=="k"){f=R._getInt(e,i,o.length,2);if(f==null||f<1||f>24)return 0;i+=f.length;f--}else if(o=="mm"||o=="m"){p=R._getInt(e,i,o.length,2);if(p==null||p<0||p>59)return 0;i+=p.length}else if(o=="ss"||o=="s"){g=R._getInt(e,i,o.length,2);if(g==null||g<0||g>59)return 0;i+=g.length}else if(o=="a"){if(e.substring(i,i+2).toLowerCase()=="am")m="AM";else if(e.substring(i,i+2).toLowerCase()=="pm")m="PM";else return 0;i+=2}else{if(e.substring(i,i+o.length)!=o)return 0;else i+=o.length}}if(i!=e.length)return 0;if(d==2){if(u%4==0&&u%100!=0||u%400==0){if(h>29)return 0}else if(h>28){return 0}}if(d==4||d==6||d==9||d==11)if(h>30)return 0;if(f<12&&m=="PM")f=f-0+12;else if(f>11&&m=="AM")f-=12;var _=new Date(u,d-1,h,f,p,g);return _},parse:function(e,t){if(t){return R.parseFormat(e,t)}else{var i=arguments.length==2?arguments[1]:false;var n=new Array("y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d");var r=new Array("M/d/y","M-d-y","M.d.y","MMM-d","M/d","M-d");var o=new Array("d/M/y","d-M-y","d.M.y","d-MMM","d/M","d-M");var s=[n,i?o:r,i?r:o];var a=null;for(var l=0;l<s.length;l++){var c=s[l];for(var u=0;u<c.length;u++){a=R.parseFormat(e,c[u]);if(a!=0)return new Date(a)}}return null}},toArray:function(e,t){if(e&&e.getMonth){return[e.getFullYear(),e.getMonth(),e.getDate()]}else{return t}},getLocaleShortDateString:function(e){var t=navigator.language?navigator.language:navigator["userLanguage"],i=e.getFullYear(),n=e.getMonth()+1,e=e.getDate();var r=t in s?s[t]:"MM/dd/yyyy";function o(e){e=""+e;return e.length>1?e:"0"+e}r=r.replace(/yyyy/,i);r=r.replace(/yy/,String(i).substr(2));r=r.replace(/MM/,o(n));r=r.replace(/M/,n);r=r.replace(/dd/,o(e));r=r.replace(/d/,e);return r},getLocaleDateFormat:function(){var e=navigator.language?navigator.language:navigator["userLanguage"];var t=e in s?s[e]:"MM/dd/yyyy";return t},getLocalizedShortWeekdays:function(t,e){const i=[];const n=new Date;const r={weekday:"short"};n.setDate(n.getDate()-n.getDay()+e);for(let e=0;e<7;e++){const o=n.toLocaleDateString(t,r);i.push(o);n.setDate(n.getDate()+1)}return i},formatAdminDateTime:function(e){if(!e){return""}const t=window.adminDateTimeFormat.replaceAll("d","D").replaceAll("y","Y");return moment(e).format(t)},formatAdminDate:function(e){if(!e){return""}const t=window.adminDateFormat.replaceAll("d","D").replaceAll("y","Y");return moment(e).format(t)}};AGN.Lib.DateFormat=R})();(function(){var r='script[type="application/json"]';var o="config:";var s={};function a(e,t){this.el=e;if(e.is(r)){this.config=e.json()}else{const n=l(e,t);if(n.exists()){var i=n.attr("type");if(!i||i==="application/json"){this.config=n.json()}else{console.error("Unexpected config script type: `"+i+"`")}}}}function l(e,t){const i="script#"+CSS.escape(o+t);const n=e.find(i);if(n.exists()){return n}return $(i)}a.prototype.addAction=function(e,t){AGN.Lib.Action.new(AGN.Lib.Action.translate(e),t,this.el)};function e(t){var e=t;if(!e){e=$(document)}e.all("[data-initializer]").each(function(){var e=$(this);n(e.data("initializer"),e,t)})}function n(e,t,i){var n=s["key#"+e];if(n){var r=n.call(new a(t,e),t,i);if(r===false){s["key#"+e]=undefined}return true}else{return false}}function t(e,t){if(s["key#"+e]){var i=t;if(!i){i=$(document)}i.all('[data-initializer="'+CSS.escape(e)+'"]').each(function(){n(e,$(this),t)})}}function i(e,t){if(_.isFunction(t)){s["key#"+e]=t}else{console.error("Handler must be a function")}}AGN.Lib.DomInitializer={autorun:e,run:n,try:t,new:i}})();(function(){const o={MAIN:"main",VISIBLE:"visible",HIDDEN:"hidden"};class s{static DATA_KEY="agn:editable-tile";static SELECTOR="[data-editable-tile]";constructor(e,t){this.$el=e;this.state=t;this.toggle();this.#setOverlay();this.$el.data(s.DATA_KEY,this)}static get(e){const t=e.closest(s.SELECTOR);return t.data(s.DATA_KEY)}toggleState(){if(this.state===o.VISIBLE){this.state=o.HIDDEN}else{this.state=o.VISIBLE}this.#setOverlay()}toggle(){this.$el.toggleClass("tile--hidden",this.state===o.HIDDEN)}#setOverlay(){const e=AGN.Lib.Template.dom("tile-overlay",{state:this.state});if(this.$overlay){this.$overlay.replaceWith(e)}else{this.$el.append(e)}this.$overlay=e}}AGN.Lib.EditableTile=s;class i{static DATA_KEY="agn:editable-view";static SELECTOR="[data-editable-view]";constructor(e,t){this.$el=e;this.name=t;this.inEditMode=false;this.$btn=$(`[data-edit-view="${t}"]`);this.$btnSiblings=this.$btn.closest("li").siblings("li:visible");this.config=AGN.Lib.Storage.get(this.#getStorageKey())||{};this.tiles=this.#initTiles();this.#controlContainersVisibility();this.$el.removeClass("hidden");this.$el.data(i.DATA_KEY,this);this.#updateControlViewBtn()}static get(e){const t=e.closest(i.SELECTOR);return t.data(i.DATA_KEY)}enableEditMode(){this.inEditMode=true;this.$el.addClass("edit-mode");this.#controlContainersVisibility();this.#updateControlViewBtn();this.$btnSiblings.hide()}applyChanges(){this.inEditMode=false;this.$el.removeClass("edit-mode");this.$btnSiblings.show();const t={};this.tiles.forEach(e=>{e.toggle();if(e.state!==o.MAIN){t[e.$el.attr("id")]=e.state}});this.#controlContainersVisibility();AGN.Lib.Storage.set(this.#getStorageKey(),t);AGN.Lib.Messages.success("editableView.saved");this.#updateControlViewBtn()}#getCountOfHiddenTiles(){return this.#getTilesByState(o.HIDDEN).length}#updateControlViewBtn(){const e=this.$btn.find(".text");if(this.isInEditMode()){e.text(t("editableView.save"))}else{e.text(t("editableView.edit"));const i=this.#getCountOfHiddenTiles();if(i>0){e.append(` (${i} <i class="icon icon-eye-slash"></i>)`)}}}toggleState(e){const t=this.#getTilesByState(o.HIDDEN);const i=s.get(e);if(t.length===this.tiles.length-1&&i.state===o.VISIBLE){AGN.Lib.Messages.alert("editableView.tile.error.cantRemove")}else{i.toggleState()}}#getTilesByState(t){return this.tiles.filter(e=>e.state===t)}isInEditMode(){return this.inEditMode}#initTiles(){const i=this;const n=new Map;this.$el.find(s.SELECTOR).each(function(){const e=$(this);const t=i.getTileState(e);n.set(e,t)});const r=[...n.values()].every(e=>e===o.HIDDEN);return Array.from(n,([e,t])=>new s(e,r?o.VISIBLE:t))}getTileState(e){return e.data("editable-tile")||this.config[e.attr("id")]||o.VISIBLE}#controlContainersVisibility(){const e=this.tiles.flatMap(e=>{const t=e.$el.parentsUntil(this.$el);return t.toArray().map(e=>$(e))});e.forEach(e=>e.toggleClass("tile-container--hidden",this.#areAllTilesHiddenInContainer(e)))}#areAllTilesHiddenInContainer(e){if(this.inEditMode){return false}return e.find(s.SELECTOR).toArray().every(e=>s.get($(e)).state===o.HIDDEN)}#getStorageKey(){return`editable-view#${this.name}`}#contains(e){const t=i.get(e);return t&&this.tiles.includes(t)}add(e){if(this.#contains(e)){return}const t=new s(e,this.getTileState(e));this.tiles.push(t)}}AGN.Lib.EditableView=i})();(function(){var t,i,n,r,o;t=function(e){var t=this,i,n,r,o;this.el=$(e);o=!!this.el.attr("readonly");this.isFullHeight=!!this.el.data("full-height-editor");this.height=parseInt(this.el.attr("rows")||15)*15;i=this.el.attr("id")+"Editor";n=$("#"+i);if(n.length===1){r=i;var s=n.data("full-height-editor");n.css("height",s?"100%":this.height+"px")}else{r=_.uniqueId("Editor");n=$('<div id="'+r+'" class="form-control"></div>');n.css("height",this.isFullHeight?"100%":this.height+"px");n.insertAfter($(this.el))}this.el.hide();this.editor=ace.edit(r);this.editor.setReadOnly(o);this.editor.getSession().setValue(this.el.val());this.editor.getSession().on("change",function(e){t.el.val(t.editor.getSession().getValue());t.el.trigger("editor:change")});this.langTools=ace.require("ace/ext/language_tools");this.decorate();if(this.el.hasClass("js-editor-validate")){this.editor.getSession().setUseWorker(true)}if(this.el.hasClass("js-editor-wrap")){this.editor.getSession().setUseWrapMode(true)}t.el.trigger("editor:create")};t.get=function(e){var t=e.data("_editor");if(t){return t}if(e.hasClass("js-editor")){t=new i(e)}else if(e.hasClass("js-editor-text")){t=new n(e)}else if(e.hasClass("js-editor-eql")){t=new r(e)}else if(e.hasClass("js-editor-css")){t=new o(e)}e.data("_editor",t);return t};t.all=function(){return _.map($(".js-editor, .js-editor-text, .js-editor-eql, .js-editor-css"),function(e){return t.get($(e))})};t.prototype.decorate=function(){if($("body").hasClass("dark-theme")){this.editor.setTheme("ace/theme/idle_fingers")}else{this.editor.setTheme("ace/theme/chrome")}this.editor.session.setUseWrapMode(true);this.editor.session.setWrapLimitRange(null,null);this.editor.setBehavioursEnabled(true);this.editor.setShowPrintMargin(false);this.editor.session.setUseSoftTabs(true);this.editor.getSession().setUseWorker(false);this.editor.setOptions({enableBasicAutocompletion:true,enableSnippets:true,enableLiveAutocompletion:true,minLines:20})};t.prototype.resize=function(){this.editor.resize()};t.prototype.val=function(e){if(typeof e!=="undefined"){this.editor.getSession().setValue(e)}else{return this.editor.getSession().getValue()}};i=function(e){t.apply(this,e)};i.prototype=Object.create(t.prototype);i.prototype.constructor=i;i.prototype.decorate=function(){t.prototype.decorate.call(this);this.editor.getSession().setMode("ace/mode/html")};n=function(e){t.apply(this,e)};n.prototype=Object.create(t.prototype);n.prototype.constructor=n;n.prototype.decorate=function(){if($("body").hasClass("dark-theme")){this.editor.setTheme("ace/theme/idle_fingers")}else{this.editor.setTheme("ace/theme/chrome")}this.editor.session.setUseWrapMode(false);this.editor.session.setWrapLimitRange(null,null);this.editor.setBehavioursEnabled(true);this.editor.setShowPrintMargin(false);this.editor.session.setUseSoftTabs(true);this.editor.getSession().setUseWorker(false);this.editor.setOptions({enableBasicAutocompletion:false,enableSnippets:false,enableLiveAutocompletion:false,minLines:20});this.editor.getSession().setMode("ace/mode/text")};r=function(e){t.apply(this,e)};r.prototype=Object.create(t.prototype);r.prototype.constructor=r;r.prototype.decorate=function(){if($("body").hasClass("dark-theme")){this.editor.setTheme("ace/theme/idle_fingers")}else{this.editor.setTheme("ace/theme/chrome")}this.editor.session.setUseWrapMode(false);this.editor.session.setWrapLimitRange(null,null);this.editor.setBehavioursEnabled(true);this.editor.setShowPrintMargin(false);this.editor.session.setUseSoftTabs(true);this.editor.getSession().setUseWorker(false);this.langTools.setCompleters([this.langTools.keyWordCompleter,this.langTools.snippetCompleter]);this.editor.setOptions({enableBasicAutocompletion:true,enableSnippets:false,enableLiveAutocompletion:true,minLines:20});ace.config.loadModule("ace/ext/eql_constructions_tokens");ace.config.loadModule("ace/ext/eql_constructions_basic");ace.config.loadModule("ace/ext/eql_constructions_extended");this.editor.getSession().setMode("ace/mode/eql")};o=function(e){t.apply(this,e)};o.prototype=Object.create(t.prototype);o.prototype.constructor=o;o.prototype.decorate=function(){t.prototype.decorate.call(this);this.editor.getSession().setMode("ace/mode/css")};AGN.Lib.Editor=t;AGN.Lib.EditorHtml=i;AGN.Lib.EditorText=n;AGN.Lib.EditorEql=r;AGN.Lib.EditorCss=o})();(function(){class n{static DATA_ATTR_NAME="agn:endless-scroll";constructor(e,t,i={}){this.$el=e;this.url=t;this.options=i;this.currentPage=0;this.allPagesLoaded=false;this.$loader=i.loader?$(i.loader):null;e.endlessScroll({fireOnce:true,fireDelay:1e3,loader:"",insertAfter:".js-endless-scroll .js-endless-scroll-content",callback:()=>this.loadContent()});this.loadContent();e.data(n.DATA_ATTR_NAME,this)}static get(e){return e.data(n.DATA_ATTR_NAME)}load(e){this.$el.find(".js-endless-scroll-content").empty();if(e){this.url=e}this.currentPage=0;this.allPagesLoaded=false;this.loadContent()}loadContent(){if(this.allPagesLoaded){return}const n=this.$loader?.exists()&&this.$el.is(":visible");if(n){AGN.Lib.Loader.prevent();this.$loader.removeClass("hidden")}const e=$.get(this.url,{page:this.currentPage+1});e.done(e=>{this.currentPage+=1;const t=$(e);const i=$(e).children();this.$el.find(".js-endless-scroll-content").append(i);this.allPagesLoaded=t.is("[data-endless-scroll-stop]");AGN.Lib.Scrollbar.get(this.$el)?.update();if(n){this.$loader.addClass("hidden")}if(this.options.onLoad){this.options.onLoad(i)}});return e}}AGN.Lib.EndlessScroll=n})();(function(){function r(){}r.defaults=function(){return[{active:false,time:""}]};r.create=function(e,t){e=$.extend(r.defaults()[0],e);if(t){return AGN.Lib.Template.dom("schedule-extended-time-wrapper",{scheduleElement:e})}else{return AGN.Lib.Template.dom("schedule-time-wrapper",{scheduleElement:e})}};r.get=function(e){return e.closest(".schedule-time-wrapper")};function s(e){var t=this;if(!e.exists()){e=s.create({})}t.$rowWrapper=e}s.prototype.toJson=function(){var e=this;var t=e.$rowWrapper.find("select[name=dayOfTheWeek]").val();var i=_.map(e.$rowWrapper.find(".schedule-time-wrapper"),function(e){var t=$(e).find(".time-checkbox");var i=!t.is(":disabled")&&t.is(":checked"),n=$(e).find(".time-input").val();return{active:i,time:n}});var n=e.$rowWrapper.find(".hour-checkbox");var r={active:n.is(":checked")&&!n.is(":disabled"),interval:e.$rowWrapper.find("select.hour-select").val()};return $.extend(s.defaults(),{weekDay:t,scheduledTime:i,scheduledInterval:r})};s.prototype.addSchedule=function(e){var t=this,i=t.$rowWrapper;var n=r.create(e,true);i.find(".schedule-settings-wrapper").append(n);AGN.runAll(n);i.trigger("row:add-schedule")};s.prototype.removeSchedule=function(e){r.get(e).remove();this.$rowWrapper.trigger("row:remove-schedule")};s.prototype.hourCheckboxToggle=function(e){var t=e.attr("disables"),i=e.is(":checked");this.$rowWrapper.find(t).prop("disabled",i)};s.prototype.timeCheckboxToggle=function(e){var t=e.attr("disables"),i=e.is(":checked"),n=this.$rowWrapper.find(".time-checkbox"),r=this.$rowWrapper.find(".hour-checkbox"),o;for(var s=0;s<n.length;s++){var a=n[s];if(e[0]!==a&&$(a).is(":checked")){o=true;break}}if(!r.is(":disabled")||!o){this.$rowWrapper.find(t).prop("disabled",i)}};s.prototype.getAllScheduleTimes=function(){var e=this.toJson();var t=[];e.scheduledTime.forEach(function(e){if(e.active){t.push(parseInt(e.time.replace(":","")))}});return t};s.prototype.isValidTimeIntervals=function(){var e=new i;var t=this.getAllScheduleTimes();return e.valid(t)};s.prototype.showTimeScheduleErrors=function(e){var t=this.$rowWrapper.find(".schedule-time-wrapper");var i=$('<div class="form-control-feedback-message js-form-error-msg">'+e+"</div>");_.each(t,function(e){var t=$(e);if(!t.find(".js-form-error-msg").exists()){t.find(".time-input").after(i.clone());t.addClass("has-alert has-feedback js-form-error")}})};s.prototype.hideTimeScheduleErrors=function(){var e=this.$rowWrapper.find(".schedule-time-wrapper");e.find(".js-form-error-msg").remove();e.removeClass("has-alert has-feedback js-form-error")};s.defaults=function(){return{weekDay:"",scheduledInterval:{active:false,interval:""},scheduledTime:[{active:false,time:""}]}};s.get=function(e){var t;if(e.hasClass("tr.l-time-schedule-row")){t=e}else{t=e.closest("tr.l-time-schedule-row")}return new s(t)};s.create=function(e){e=$.extend(s.defaults(),e);var r=AGN.Lib.Template.dom("schedule-day-row",{entry:e});var o=new s(r);r.on("row:add-schedule",function(){var e=r.find(".schedule-time-wrapper");var t=e.length>1;r.find('[data-action="remove-schedule"]').closest(".input-group-addon").toggleClass("hidden",!t);r.find(".interval-reminder").toggleClass("hidden",!t);var i=r.find(".hour-checkbox");o.hourCheckboxToggle(i);var n=r.find(".time-checkbox");o.timeCheckboxToggle(n)});r.on("row:remove-schedule",function(){var e=r.find(".schedule-time-wrapper");var t=e.length>1;r.find('[data-action="remove-schedule"]').closest(".input-group-addon").toggleClass("hidden",!t);r.find(".interval-reminder").toggleClass("hidden",!t);if(e.length===0){o.addSchedule()}});return r};s.deserialize=function(e){return s.create(e)};function o(e){var t=this;if(!e.exists()){e=o.create({})}t.$rowWrapper=e}o.prototype.toJson=function(){var e=this;var t=e.$rowWrapper.find("input[name=type]:checked").val();var i=undefined;var n=undefined;if(t=="TYPE_MONTHLY"){n=e.$rowWrapper.find("select[name=dayOfTheMonth]").val()}else{i=e.$rowWrapper.find("select[name=dayOfTheWeek]").val()}var r=_.map(e.$rowWrapper.find(".schedule-time-wrapper"),function(e){var t=$(e).find(".time-checkbox");var i=true;if(t.exists()){i=!t.is(":disabled")&&t.is(":checked")}var n=$(e).find(".time-input").val();return{active:i,time:n}});return $.extend(o.defaults(),{type:t,weekDay:i,monthDay:n,scheduledTime:r})};o.prototype.addSchedule=function(e){var t=this,i=t.$rowWrapper;var n=r.create(e);i.find(".schedule-settings-wrapper").append(n);AGN.runAll(n);i.trigger("row:add-schedule")};o.prototype.removeSchedule=function(e){r.get(e).remove();this.$rowWrapper.trigger("row:remove-schedule")};o.defaults=function(){return{type:"1",weekDay:"",monthDay:"",scheduledTime:[{active:false,time:""}]}};o.deserialize=function(e,t){var i=$.extend(o.defaults(),e);i.type=n(e.type);i.monthDay=a(e.monthDay);return o.create(i)};function n(e){switch(e){case"TYPE_MONTHLY":return 2;case"TYPE_WEEKLY":default:return 1}}function a(e){switch(e){case"TYPE_MONTHLY_FIRST":return 1;case"TYPE_MONTHLY_15TH":return 15;case"TYPE_MONTHLY_LAST":return 99;default:return 1}}o.get=function(e){var t;if(e.hasClass("tr.l-time-schedule-row")){t=e}else{t=e.closest("tr.l-time-schedule-row")}return new o(t)};o.create=function(e){e=$.extend(o.defaults(),e);var t=AGN.Lib.Template.dom("schedule-period-row",{entry:e});var i=new o(t);t.on("row:add-schedule",function(){var e=t.find(".schedule-time-wrapper");if(e.length>1){t.find('[data-action="remove-schedule"]').closest(".input-group-addon").removeClass("hidden")}});t.on("row:remove-schedule",function(){var e=t.find(".schedule-time-wrapper");if(e.length<2){t.find('[data-action="remove-schedule"]').closest(".input-group-addon").addClass("hidden")}if(e.length===0){i.addSchedule()}});return t};function e(e){var t=this;t.$container=e.find("table tbody");t.$container.on("scheduler:add-day",function(){var e=t.$container.find(".l-time-schedule-row");if(e.length>1){t.$container.find('[data-action="remove-day"]').removeClass("hidden")}});t.$container.on("scheduler:remove-day",function(){var e=t.$container.find(".l-time-schedule-row");if(e.length<=1){e.find('[data-action="remove-day"]').addClass("hidden")}})}e.prototype.clean=function(){this.$container.find("tr.l-time-schedule-row").remove()};e.prototype.deleteRow=function(e){this.deleteRowByNeedle(e.$rowWrapper)};e.prototype.deleteRowByNeedle=function(e){this.$container.find(e).remove();this.$container.trigger("scheduler:remove-day")};e.prototype.addRow=function(e){if(e){this.$container.append(e);AGN.runAll(e);this.$container.trigger("scheduler:add-day",e);e.trigger("row:add-schedule",e)}};e.prototype.addEmptyDayRow=function(){this.addRow(s.create())};e.prototype.addEmptyPeriodRow=function(){this.addRow(o.create())};e.prototype.getAllDayRows=function(){var e=this.$container.find("tr.l-time-schedule-row");return _.map(e,function(e){return s.get($(e))})};e.prototype.getAllPeriodRows=function(){var e=this.$container.find("tr.l-time-schedule-row");return _.map(e,function(e){return o.get($(e))})};e.prototype.getSubmissionJson=function(e){var t={};if(e=="day"){t=_.map(this.getAllDayRows(),function(e){return e.toJson()})}else if(e=="period"){t=_.map(this.getAllPeriodRows(),function(e){return e.toJson()})}return JSON.stringify(t)};function i(e){var t=100;if(e){t=Number(e)}this.intervalPad=t}i.prototype.valid=function(e){var t=this.intervalPad;return e.every(i.hasCorrectInterval,t)};i.hasCorrectInterval=function(t,e,i){var n=this;var r=true;i.splice(e,1);i.forEach(function(e){if(Math.abs(e-t)<n){r=false}});return r};AGN.Lib.ScheduleTimeTable=e;AGN.Lib.ScheduleTimeTable.DayRow=s,AGN.Lib.ScheduleTimeTable.PeriodRow=o})();(function(){const o=function(e){this.el=e};o.create=function(e){var t,i=e.data("field");t=AGN.Opt.Fields[i]||o;return new t(e)};o.prototype.valid=function(){return true};o.prototype.errors=function(){return[]};AGN.Lib.Field=o;const e=function(e){o.apply(this,[e]);var t=this.el.find("[data-field-validator]");this.$target=t;this.validatorName=t.data("field-validator");var i=t.data("validator-options");this.options=i?AGN.Lib.Helpers.objFromString(i)||{}:{}};e.prototype=Object.create(o.prototype);e.prototype.constructor=e;e.prototype.valid=function(){var e=AGN.Lib.Validator.get(this.validatorName);if(e&&this.$target.exists()&&!this.$target.prop("disabled")){return e.valid(this.$target,this.options)}else{console.debug("Validator `"+this.validatorName+"` doesn't exist");return true}};e.prototype.errors=function(){var e=AGN.Lib.Validator.get(this.validatorName);if(e&&this.$target.exists()){return e.errors(this.$target,this.options)}else{console.debug("Validator `"+this.validatorName+"` doesn't exist");return[]}};AGN.Lib.CustomField=e;AGN.Opt.Fields["validator"]=e;const i=function(e){o.apply(this,[e]);var t=this;this.$source=this.el.find(".js-double-select-trigger");this.$target=this.el.find(".js-double-select-target");this.$source.on("change",function(){t.$target.val([]);t.update()});AGN.Lib.DataProvider.get(e).done(function(e){t.options=e;t.update()})};i.prototype=Object.create(o.prototype);i.prototype.constructor=i;i.prototype.update=function(){var e=this.$source.find("option:selected").val(),t=this.$target.find("option:selected").val(),i='{{ _.forEach(opts, function(name, value) { }}<option value="{{- value }}" {{- ( value == valueSelected ) ? "selected" : "" }}>{{- name }}</option>{{ }); }}';i=_.template(i)({opts:this.options[e],valueSelected:t});this.$target.html(i);AGN.runAll(this.el)};AGN.Lib.DoubleSelectField=i;AGN.Opt.Fields["double-select"]=i;const n="field-vis";const r="field-vis-show";const s="field-vis-hide";const a=`data-${n}`;const l=`data-${r}`;const c=`data-${s}`;const u="data-field-vis-default";const d=function(e){o.apply(this,[e]);const t=this;this.$source=this.el.find(`[${a}]`);this.$source.on("change",function(){t.update()});t.update()};d.prototype=Object.create(o.prototype);d.prototype.constructor=d;d.prototype._updateSelects=function(){var t=this;_.each(this.$source.filter("select"),function(e){t._toggleFields($(e).find(":selected"))})};d.prototype._updateDefaults=function(){var t=this;_.each(this.el.find(`[${u}]`),function(e){t._toggleFields($(e))})};d.prototype._updateCheckboxes=function(){var t=this;_.each(this.$source.filter(":checked"),function(e){t._toggleFields($(e))})};d.prototype._toggleFields=function(t){var e,i;if(t.is(":disabled")&&!t.is("[data-field-vis-nondisabled]")){return}e=t.data(s);i=t.data(r);_.each(this.el.find(e),function(e){t=$(e);t.all(":input").each(function(){var e=$(this);if(!e.prop("disabled")){e.data("field-disabled",true);e.prop("disabled",true)}});t.hide();if(t.data("select2")){t.select2("container").hide();t.select2("enable",false)}if(t.is("option")){t.prop("disabled",true);AGN.Lib.CoreInitializer.run("select",t.parents("select"))}});_.each(this.el.find(i),function(e){t=$(e);t.all(":input").each(function(){var e=$(this);if(e.data("field-disabled")){e.prop("disabled",false);e.removeData("field-disabled")}});t.show();if(t.data("select2")){t.select2("container").show();t.select2("enable",true)}if(t.is("option")){t.prop("disabled",false);AGN.Lib.CoreInitializer.run("select",t.parents("select"))}})};d.prototype.update=function(){this._updateDefaults();this._updateSelects();this._updateCheckboxes()};d.STR={DATA_FIELD_VIS:a,DATA_FIELD_VIS_SHOW:l,DATA_FIELD_VIS_HIDE:c,DATA_FIELD_VIS_DEFAULT:u};AGN.Lib.ToggleVisField=d;AGN.Opt.Fields["toggle-vis"]=d;const h=function(e){o.apply(this,[e]);this.$target=this.el};h.prototype=Object.create(o.prototype);h.prototype.constructor=h;h.prototype.valid=function(){if(this.$target.exists()){return $.trim(this.$target.val())}else{return true}};h.prototype.errors=function(){var e=[];if(this.valid())return e;e.push({field:this.$target,msg:t("fields.required.errors.missing")});return e};AGN.Lib.RequiredField=h;AGN.Opt.Fields["required"]=h;class f extends h{constructor(e){super(e)}valid(){return!this.$target.is(":visible")||super.valid()}}AGN.Opt.Fields["required-when-shown"]=f;const p=function(e){o.apply(this,[e]);const t=this;this.$strength=this.el.find(".js-password-strength");this.$match=this.el.parent().find(".js-password-match");this.$strength.on("keyup",function(){if(event.keyCode!==13){t.updateStrength();t.updateMatch();t.$match.get(0).toggleAttribute("readonly",!t.safe()||t.$strength.val().length===0)}});this.$match.on("keyup",()=>this.updateMatch())};p.prototype=Object.create(o.prototype);p.prototype.constructor=p;p.prototype.match=function(){return this.$strength.val()==this.$match.val()};p.prototype.safe=function(){return this._getSecurityIssues().length===0};p.prototype._getSecurityIssues=function(){const i=[];const e=this.$strength.val();if(e.length==0)return i;const n=this.$strength.attr("data-rule");const r=AGN.Lib.PasswordPolicies.find_password_policy(n);const o=r(e);if(o&&o.length){o.forEach(e=>i.push(t(e)))}return i};p.prototype.valid=function(){if(!this.$match.exists())return true;return this.match()&&this.safe()};p.prototype.errors=function(){const i=this;const n=[];if(this.valid())return n;if(!this.match()){n.push({field:this.$match,msg:t("fields.password.errors.notMatching")})}const e=this._getSecurityIssues();if(e.length>0){e.forEach(e=>{n.push({field:i.$strength,msg:e})})}return n};p.prototype.resetStrength=function(){const e=AGN.Lib.Form.get(this.$strength);e.cleanFieldFeedback(this.$strength)};p.prototype.resetMatch=function(){const e=AGN.Lib.Form.get(this.$match);e.cleanFieldFeedback(this.$match)};p.prototype.updateStrength=function(){this.resetStrength();if(this.$strength.val().length==0){return}const i=AGN.Lib.Form.get(this.$strength);const e=this._getSecurityIssues();if(e.length===0){i.markField(this.$strength,"success");i.appendFeedbackMessage(this.$strength,t("fields.password.safe"),"success")}else{i.markField(this.$strength);e.forEach(e=>i.appendFeedbackMessage(this.$strength,e))}};p.prototype.updateMatch=function(){this.resetMatch();if(this.$match.val().length==0){return}const e=AGN.Lib.Form.get(this.$match);if(this.match()){e.markField(this.$match,"success");e.appendFeedbackMessage(this.$match,t("fields.password.matches"),"success")}else{e.markField(this.$match);e.appendFeedbackMessage(this.$match,t("fields.password.matchesNot"))}};AGN.Lib.PasswordField=p;AGN.Opt.Fields["password"]=p;const g=function(e){o.apply(this,[e]);this.$source=this.el.find("[data-field-split]");this.targets=this.$source.data("field-split").split(/,\s?/);this.rule=new RegExp(this.$source.data("field-split-rule"))};g.prototype=Object.create(o.prototype);g.prototype.constructor=g;g.prototype.valid=function(){var i,n=AGN.Lib.Form.get(this.el);i=this.$source.val().split(this.rule);_.each(this.targets,function(e,t){n.setValueOnce(e,i[t])});return true};AGN.Lib.ValueSplitField=g;AGN.Opt.Fields["split"]=g;const m=function(e){var t=this;o.apply(this,[e]);this.$source=this.el.find("[data-field-date-split]");this.$source.on("change",function(){t.update()})};m.prototype=Object.create(o.prototype);m.prototype.constructor=m;m.prototype.update=function(){var i=null;var e=this.$source.val();if(e){i=new Date(parseInt(e))}var t=this.el.find("[data-date-split-target]");t.each(function(){var e=$(this);var t=e.attr("data-date-split-target");if(i&&t){switch(t.toUpperCase()){case"MILLISECONDS":e.val(i.getMilliseconds());break;case"SECONDS":e.val(i.getSeconds());break;case"MINUTES":e.val(i.getMinutes());break;case"HOURS":e.val(i.getHours());break;case"DAY":e.val(i.getDate());break;case"MONTH":e.val(i.getMonth()+1);break;case"YEAR":e.val(i.getFullYear());break;default:e.val(i.toJSON())}}else{e.val("")}})};AGN.Lib.DateSplitField=m;AGN.Opt.Fields["date-split"]=m;const v=function(e){o.apply(this,[e]);var t=$(this.el);var i=t.data("property");var n=_.extend({},AGN.Lib.Helpers.objFromString(t.data("field-options")));var r=n.value||n.defaultValue||"";A(t,i,r);t.on("change",function(){y(i)})};v.prototype=Object.create(o.prototype);v.prototype.constructor=v;AGN.Lib.DateTimeField=v;AGN.Opt.Fields["datetime"]=v;function y(e){var t=e.replace(/([:.\[\],=@])/g,"\\$1");var i=$("#"+t+"_date");var n=$("#"+t+"_time");$('[name="'+e+'"]').val(b(i,n))}function b(e,t){var i=t?t.val():"";i=i?i.replaceAll("_","0"):"00:00";return e.val()?w(e.val(),i):""}function w(e,t){return e+(C(t)?" "+t:"")}function C(e){return/^(\d{2}):(\d{2})$/.test(e)}function x(e){if(e){return e.split(" ")[0]}return""}function S(e){if(e){var t=e.split(" ");if(t.length==2){return t[1]}}return""}function A(e,t,i){var n=document.createElement("input");n.type="hidden";n.name=t;n.value=i;const r=e.data("field-extra-attributes");const o=r?AGN.Lib.Helpers.objFromString(r)||{}:{};for(const[s,i]of Object.entries(o)){n.setAttribute(s,i)}e.append(_.template(AGN.Opt.Templates["datetime-picker"])({date:x(i),time:S(i),property:t}));e.append(n);AGN.runAll(e)}})();(function(){const n=_.template(`
      {{ const disabled = isDisabled ? 'disabled' : '';}}
      <div class="col-12" data-email-list-manager-row data-action="change-trigger">
        <div class="row g-1">
            <div class="col">
                <input type="text" value="{{= value}}" class="form-control" size="42" maxlength="99" {{- disabled }} />
            </div>
            {{ if (!isDisabled) { }}
                <div class="col-auto">
                     <button type="button" class="btn btn-primary btn-icon-sm" data-action="create-email" data-email-manager-row-add>
                        <i class="icon icon-plus"></i>
                    </button>
                </div>
            {{ } }}
        </div>
      </div>
  `);const s=_.template(`
     <button type="button" class="btn btn-danger btn-icon-sm" data-action="delete-email" data-email-manager-row-delete>
      <i class="icon icon-trash-alt"></i>
    </button>
  `);class r{constructor(e,t,i){this.scope=e;this.data=t;this.options=$.extend({rowTemplate:n,rowSelector:"[data-email-list-manager-row]",addBtnSelector:"[data-email-manager-row-add]",deleteBtnSelector:"[data-email-manager-row-delete]",rowDataMapper:e=>{return{value:e,isDisabled:i.disabled}}},i);_.each(this.data,e=>this.#addFieldRow(this.scope,e,null,this.options))}static initialize(e,t,i){return new r(e,t,i)}createRowAfter(e){this.#addFieldRow(this.scope,"",$(e),this.options)}#addFieldRow(e,t,i,n){const r=n.rowTemplate(n.rowDataMapper(t));if(i&&i.exists()){i.closest(n.rowSelector).after(r)}else{e.append(r)}this.#updateRemoveButtons(e,n)}deleteRow(e){$(e).closest(this.options.rowSelector).remove();this.#updateRemoveButtons(this.scope,this.options)}getJsonData(){const i=[];_.each(this.scope.find(`${this.options.rowSelector} input`),e=>{const t=e.value;if(t.trim()!==""){i.push(t)}});return i}#updateRemoveButtons(e,r){const o=e.find(r.rowSelector);if(o.length===1){o.find(r.deleteBtnSelector).remove()}else{_.each(o,(e,t)=>{const i=$(e);const n=i.find(r.deleteBtnSelector);if(t!=o.length-1&&!n.exists()){i.find(".btn").replaceWith($(s({})))}})}}}AGN.Lib.EmailsListManager=r})();(function(){var s,n=AGN.Lib.Field,i=AGN.Lib.CSRF,r;r=function(e){this.group=e;this.$controls=$()};r.prototype._collect=function(e){var t=$("[data-controls-group]");if(e==="*"){return t}if(e){return t.filter(function(){return e===$(this).attr("data-controls-group")})}else{return $()}};r.prototype.collect=function(){if(this.group){this.$controls=this._collect(this.group).filter(function(){var e=$(this);return!e.prop("disabled")&&!e.hasClass("disabled")})}};r.prototype.setDisabled=function(e){if(e===false){this.$controls.removeClass("disabled");this.$controls.prop("disabled",false)}else{this.$controls.addClass("disabled");this.$controls.prop("disabled",true)}};s=function(e){this.$form=e;this.form=e[0];this._abort=null;this._data={};this._dataNextRequest={};this.fields=[];this.validatorName=null;this.validatorOptions=null;this.dirtyChecking=e.is("[data-form-dirty-checking]");this.url=e.attr("action");this.urlNextRequest=null;this.method=e.attr("method");this.isMultipart="multipart/form-data"==(e.attr("enctype")||"").toLowerCase();this.isCustomLoader=e.is("[data-custom-loader]");this.controlsToDisable=new r(e.attr("data-disable-controls"));if(e.is("[data-custom-loader]")){this.isCustomLoader=e.attr("data-custom-loader")!=="false"}else{this.isCustomLoader=false}this.initFields();this.initValidator();this.handleMessages($("body"),true);if(this.dirtyChecking){o(e)}};function o(e){e.dirty({preventLeaving:true,leavingMessage:t("grid.layout.leaveQuestion")});window.onbeforeunload=function(){if(!e.dirty("isDirty")===true){AGN.Lib.Loader.show()}}}s.get=function(e){var t,i,n,r;t=s.getWrapper(e);r=t.data("_form");if(!r){n=t.data("form");i=AGN.Opt.Forms[n]||AGN.Lib.Form;r=new i(t);t.data("_form",r)}return r};s.getWrapper=function(e){let t=$(e.data("form-target"));if(!t.exists()){if(e.attr("form")){t=$(`#${e.attr("form")}`)}if(!t.exists()){t=e.closest("form")}}return t};s.prototype.valid=function(e){var t=$.Event("validation");e=_.merge({},this.validatorOptions,e);this.$form.trigger(t,e);if(t.isDefaultPrevented()){return false}var i=_.every(this.fields,function(e){return e.valid()});if(this.validatorName){var n=AGN.Lib.Validator.get(this.validatorName);if(n){return n.valid(this,e,i)}}return i};s.prototype.validate=function(e){if(this.valid(e)){return true}else{this.handleErrors();return false}};s.prototype.get$=function(){return this.$form};s.prototype.getAction=function(){if(this.urlNextRequest){var e=this.urlNextRequest;this.urlNextRequest=null;return e}return this.url};s.prototype.setActionOnce=function(e){this.urlNextRequest=e};s.prototype.errors=function(){var t=[];_.each(this.fields,function(e){t=t.concat(e.errors())});if(this.validatorName){var e=AGN.Lib.Validator.get(this.validatorName);if(e){t=t.concat(e.errors(this,this.validatorOptions))}}return t};s.prototype.setValue=function(e,t){var i=this.form[e];if(typeof i==="object"){if($(i).is("select")){AGN.Lib.Select.get($(i)).selectValue(t)}else{$(i).val([t]).trigger("change")}}else{if(typeof t==="undefined"){delete this._data[e]}else{this._data[e]=t}}};s.prototype.setValueOnce=function(e,t){if(typeof t==="undefined"){delete this._dataNextRequest[e]}else{this._dataNextRequest[e]=t}};s.prototype.getValue=function(e){var t=this.form[e];if(typeof t==="object"){return t.value}else{return this._data[e]}};s.prototype.data=function(){if(this.isMultipart){var n=new FormData;var i=this.$form.serializeFormDataObject();$.each(this._data,function(e,t){if(!i.hasOwnProperty(e)){i[e]=t}});$.each(this._dataNextRequest,function(e,t){i[e]=t});$.each(i,function(i,e){if($.isArray(e)){$.each(e,function(e,t){n.append(i,t)})}else{n.append(i,e)}});return n}else{return _.merge({},this._data,this.$form.serializeObject(),this._dataNextRequest)}};s.prototype.params=function(){return $.param(this.data(),true)};s.prototype.jqxhr=function(){var i=this,e=$.ajaxSettings.xhr(),t,o=$.Deferred();this.$form.trigger("form:submit");var n={url:this.getAction(),method:this.method,loader:this.loader(),xhr:function(){return e}};if(this.isMultipart){n.data=this.data();n.enctype="multipart/form-data";n.processData=false;n.contentType=false}else{n.data=this.params()}if(this.isCustomLoader){var r=function(e){var t=true;if(e.lengthComputable){t=(e.loaded/e.total*100).toFixed(1)}i.$form.trigger("form:progress",{loaded:e.loaded,total:e.total,progress:t})};if("upload"in e){n.xhr=function(){e.upload.onprogress=r;return e}}else{n.xhrFields={onprogress:r}}}if(typeof e.abort==="function"){this._abort=function(){e.abort()}}t=$.ajax(n);this._dataNextRequest={};this.setLoaderShown(true);o.always(function(){i.setLoaderShown(false)});t.done(function(i){var e=$(i),t,n,r;t=e.filter('[data-form="polling"]').add(e.find('[data-form="polling"]'));if(t.length==1){n=s.get(t);r=n.jqhxr();r.done(function(){o.resolve.apply(this,arguments);var e=$("body");var t=$("<div></div>");t.html(i);t.find('script[data-message][type="text/html"]').appendTo(e);t.find('script[data-message][type="text/javascript"]').each(function(){try{eval.call(window,$(this).html())}catch(e){}});t.remove()});r.fail(function(){o.reject.apply(this,arguments)})}else{o.resolve(i)}});t.fail(function(){o.reject.apply(this,arguments)});return o.promise()};s.prototype._submit=function(){var e,t=this;this.setLoaderShown(true);e=this.jqxhr();e.done(function(e){t.setLoaderShown(false);t.updateHtml(e);t.$form.trigger("submitted",e);if(t.dirtyChecking){a(t.$form)}});return e};function a(e){const t=$("body").has(e).length===0;if(t){e.dirty("destroy")}else{e.dirty("setAsClean")}}s.prototype._submitStatic=function(){var e=this.data(),r;if(i.isProtectionEnabled()){e[i.getParameterName()]=i.readActualToken()}r=$('<form method="'+this.method+'" action="'+this.getAction()+'"></form>');_.each(e,function(e,t){if(_.isArray(e)){var i=$('<select multiple name="'+t+'"></select>');_.each(e,function(e){var t=$('<option selected="selected"></option>');t.val(e);t.appendTo(i)});i.appendTo(r)}else{var n=$('<input type="hidden" name="'+t+'"/>');n.val(e);n.appendTo(r)}});r.appendTo($("body"));r.submit();r.remove();this._dataNextRequest={}};s.prototype._submitAction=function(e){this.setValue("previousAction",this.getValue("actionList"));this.setValueOnce("action",e);return this.submit()};s.prototype._submitEvent=function(){var e=$.Event("submission");this.$form.trigger(e);if(!e.isDefaultPrevented()){this.$form.trigger("submitted");this._dataNextRequest={}}};s.prototype._submitConfirm=function(e){this.setValue("previousAction",this.getValue("actionList"));this.setValueOnce("action",e);var t=this.jqxhr();var i=this;t.done(function(e){i.$form.trigger("submitted",e)});return t};s.prototype.submit=function(e){var t=0;var i={};if((e=="confirm"||e=="action")&&(typeof arguments[1]==="number"||typeof arguments[1]==="string")){t=arguments[1];i=arguments[2]}else{i=arguments[1]}if(this.valid(i)){this.cleanFieldFeedback()}else{this.handleErrors();return false}switch(e){case"static":return this._submitStatic();case"confirm":return this._submitConfirm(t);case"action":return this._submitAction(t);case"event":return this._submitEvent();default:return this._submit()}};s.prototype.revertAction=function(){};s.prototype.reset=function(){this.$form.trigger("reset");AGN.Lib.CoreInitializer.run("select",this.$form)};s.prototype.abort=function(){this.$form.trigger("form:abort");if(this._abort){this._abort();this._abort=null}};s.prototype.clear=function(){_.forEach(this.data(),(e,t)=>this.setValue(t,""))};s.prototype.bulkUpdate=function(e,t){if(e){this.$form.find('[name^="'+e+'"]:not(:disabled)').prop("checked",t)}else{this.$form.find(".js-bulk-ids:not(:disabled)").prop("checked",t)}};s.prototype.handleMessages=function(e,t){const n=this;if(!(e instanceof $)){e=$(e)}e.all('script[data-message][type="text/html"]').each(function(){const e=$(this);const t=e.text();const i=e.data("message");if(t&&i){n.showFieldError(i,t,false)}});if(t===true){return}const i=e.filter("script[data-message]").add(e.find("script[data-message]"));_.each(i,function(e){$("body").append(e)})};s.prototype.initFields=function(e=$(document)){this.fields.length=0;e.find("[data-field]").each((e,t)=>{const i=$(t);if(s.getWrapper(i).is(this.$form)){this.fields.push(n.create(i))}})};s.prototype.initValidator=function(){this.validatorName=this.$form.data("validator");var e=this.$form.data("validator-options");this.validatorOptions=e?AGN.Lib.Helpers.objFromString(e):null};s.prototype.updateHtml=function(e){var t,i=$(e);if(this.$form.attr("id")){t=$(e).filter("#"+this.$form.attr("id")).add(i.find("#"+this.$form.attr("id")))}else if(this.$form.attr("name")){t=$(e).filter('[name="'+this.$form.attr("name")+'"]').add(i.find('[name="'+this.$form.attr("name")+'"]'))}else{t=$(e).filter("form").add(i.find("form"))}this.$form.html(t.html());this.handleMessages(e);this.initFields();this.initValidator();AGN.Lib.Controller.init(this.$form);AGN.runAll(this.$form)};s.prototype.loader=function(){var e=this;return{show:function(){e.controlsToDisable.collect();e.controlsToDisable.setDisabled(true);e.setLoaderShown(true)},hide:function(){e.controlsToDisable.setDisabled(false);e.setLoaderShown(false)}}};s.prototype.setLoaderShown=function(e){if(this.isCustomLoader){if(e){this.$form.trigger("form:loadershow")}else{this.$form.trigger("form:loaderhide")}}else{if(e){AGN.Lib.Loader.show()}else{AGN.Lib.Loader.hide()}}};s.prototype.cleanFieldFeedback=function(e){l(e,this.$form);if(!e&&this.$form.attr("id")){const t=$(`:input[form='${this.$form.attr("id")}']`);t.each((e,t)=>l($(t)))}};s.cleanFieldFeedback$=function(e){l(e)};function l(e,t){let i;if(!e){i=t.find(".js-form-field-feedback")}else{i=e.parent()}_.each(i,function(e){const t=$(e);t.removeClass("has-alert has-feedback js-form-field-feedback has-success has-warning");t.find(".js-form-field-ind").remove();t.find(".js-form-field-msg").remove()})}s.prototype.appendFeedbackMessage=function(e,t,i="alert"){c(e,t,i)};function c(e,t,i="alert"){var n=e;var r=e.data("_editor");var o=e.data("emojioneArea");var s=true;if(r){r=r.editor;if(r.container){s=false;n=$(r.container)}}else if(o){if(o.editor){s=false;n=o.editor.parent()}}else{if(n.is("select")){s=false;if(n.is(".input-group .input-group-controls .js-select")){n=n.closest(".input-group")}}}let a="warning";if(i==="success"){a="success"}const l=$(`<div class="form-control-feedback-message js-form-field-msg">${t}</div>`);const c=s?`<span class="icon icon-state-${a} form-control-feedback js-form-field-ind"></span>`:"";l.prepend(c);n.parent().append(l);r?.resize()}s.prototype.handleErrors=function(){var n=[];const i=this;this.cleanFieldFeedback();var e=this.errors().filter(function(e){return e.field&&e.field.length>0});_.each(e,function(e){var t=e.field;i.markField(t);i.appendFeedbackMessage(t,e.msg)});_.each(this.errors(),function(e){var t=e.field;if(t.data("select2")){n.push(t.parent().find(".select2-container").offset().top)}else if(t.data("_editor")&&t.data("_editor").editor){var i=t.data("_editor").editor;n.push($(i.container).offset().top)}else{n.push(t.offset().top)}});var t=false;var r=this.$form.closest(".modal");if(!r.exists()){r=$('.tile-content[data-sizing="scroll"]');if(r.exists()){t=true}}if(!r.exists()){r=$(document)}if(r.find(".popover.support-popover").exists()){return}var o=this.$form.offset().top;var s;if(t){s=_.sortBy(n)[0]+r.scrollTop()-r.offset().top-25}else{s=_.sortBy(n)[0]-o-25}r.scrollTop(s)};s.prototype.cleanFieldError=function(e){if(this.form[e]){this.cleanFieldError$($(this.form[e]))}};s.prototype.cleanFieldError$=function(e){this.cleanFieldFeedback(e)};s.prototype.showFieldError=function(e,t,i){if(this.form[e]){this.showFieldError$($(this.form[e]),t,i)}};s.prototype.showFieldError$=function(e,t,i){u(e,t,i,this.$form)};s.showFieldError$=function(e,t,i){u(e,t,i)};function u(e,t,i,n){const r=e.parent();r.addClass("has-alert has-feedback js-form-field-feedback");r.find(".js-form-field-ind").remove();r.find(".js-form-field-msg").remove();c(e,t);if(i!==true){var o=n?n.closest(".modal").first():e.closest(".modal").first();if(o.exists()){var s=$(".has-alert").first();o.animate({scrollTop:s.offset().top-o.offset().top+o.scrollTop()})}else{o=$(document);o.scrollTop(e.offset().top-25)}}}s.prototype.markField=function(e,t="alert"){e.parent().addClass(`has-${t} has-feedback js-form-field-feedback`)};AGN.Lib.Form=s})();(function(){var e;e=function(e){this.$el=e};e.prototype.update=function(e){this.config=e;this.draw()};e.prototype.template=function(){var e=this.config;return _.template('<div class="grid-stage center-block" style="width: {{= viewWidth}} px; height: {{= viewHeight }}px;">'+'<svg class="grid-view center-block" viewBox="0 0 {{= viewWidth }} {{= viewHeight }}" style="width: {{= viewWidth }}px; height: {{= viewHeight }}px">'+'<g class="grid-columns"></g>'+"</svg>"+"</div>")({viewWidth:e.templateWidth,viewHeight:100})};e.prototype.data=function(){var t=[],i=this.config;_.times(i.columnNum,function(e){t.push({type:"gutter",width:i.gutter/2,offset:_.reduce(t,function(e,t){return e+t.width},0)});t.push({type:"col",width:i.columnWidth,offset:_.reduce(t,function(e,t){return e+t.width},0)});t.push({type:"gutter",width:i.gutter/2,offset:_.reduce(t,function(e,t){return e+t.width},0)})});return t};e.prototype.draw=function(){var e;this.$el.html(this.template());e=d3.select(this.$el.find(".grid-columns")[0]).selectAll("g").data(this.data()).enter().append("g").attr("transform",function(e,t){return"translate("+e.offset+",0)"});e.append("rect").attr("class",function(e){return"grid-view-"+e.type}).attr("width",function(e){return e.width}).attr("height",100)};AGN.Lib.GridView=e})();(function(){var e;e=function(e){this.$el=e};e.prototype.update=function(e){this.config=e;this.draw()};e.prototype.template=function(){var e=this.config;return _.template('<div class="grid-stage center-block" style="width: {{= viewWidth }}"px"; height: {{= viewHeight }}px;">'+'<svg class="column-view center-block" viewBox="0 0 {{= viewWidth }} {{= viewHeight }}" style="width: {{= viewWidth }}px; height: {{= viewHeight }}px">'+'<g class="grid-columns"></g>'+"</svg>"+"</div>")({viewWidth:e.templateWidth,viewHeight:e.columnNum*35-5})};e.prototype.data=function(){var i=this.config,n=[];_.times(i.columnNum,function(e){var t=[];t.push({type:"gutter",width:i.gutter/2,offset:0});t.push({type:"col",width:(e+1)*i.columnWidth+e*i.gutter,offset:_.reduce(t,function(e,t){return e+t.width},0)});t.push({type:"gutter",width:i.gutter/2,offset:_.reduce(t,function(e,t){return e+t.width},0)});_.times(i.columnNum-(e+1),function(e){t.push({type:"gutter",width:i.gutter/2,offset:_.reduce(t,function(e,t){return e+t.width},0)});t.push({type:"empty-col",width:i.columnWidth,offset:_.reduce(t,function(e,t){return e+t.width},0)});t.push({type:"gutter",width:i.gutter/2,offset:_.reduce(t,function(e,t){return e+t.width},0)})});n.push(t)});return n};e.prototype.draw=function(){var i=this.config,e,t;this.$el.html(this.template());t=d3.select(this.$el.find(".grid-columns")[0]).selectAll(".row").data(this.data()).enter().append("g").attr("class","row").attr("transform",function(e,t){return"translate(0,"+t*35+")"});e=t.selectAll(".col").data(function(e){return e}).enter().append("g").attr("class","col").attr("transform",function(e){return"translate("+e.offset+",0)"});e.append("rect").attr("class",function(e){return"column-view-"+e.type}).attr("width",function(e){return e.width}).attr("height",30);t.append("text").attr("class","column-view-text").attr("x",i.gutter/2+10).attr("y",20).text(function(e,t){return _.template("{{= width }}px / {{= perc }}%")({width:e[1].width,perc:Math.floor(100*(t+1)/i.columnNum)})})};AGN.Lib.GridColumnView=e})();(function(){class i{constructor(e){this.$el=e;const t=AGN.url(e.data("help"));this.config=null;$.get(t).done(e=>{this.config=$(e);this.popoverInteractive();this.show()})}show(){this.$el.popover("show")}getConfig(e){const t=this.config.find(e).text();return t.replace("<![CDATA[","").replace("]]>","")}popover(){if(!this.config){return}this.$el.popover("dispose");AGN.Lib.Popover.new(this.$el,{title:this.getConfig("title"),content:this.getConfig("content"),html:true,trigger:this.$el.data("trigger")||"focus",offset:[20,0],popperConfig:{placement:"bottom-start"}})}popoverInteractive(){if(!this.config){return}this.$el.popover("dispose");const e=AGN.Lib.Popover.new(this.$el,{title:this.getConfig("title"),content:this.getConfig("content"),html:true,trigger:"manual",offset:[20,0],popperConfig:{placement:"bottom-start"}});const n=$(e.tip);n.attr("tabindex",0);n.css("outline","none");let t=null;const i=function(){t=setTimeout(function(){e.hide()},100)};const r=function(){clearTimeout(t)};n.focusout(i);this.$el.focusout(i);n.focusin(r);this.$el.focusin(r);this.$el.on("shown.bs.popover",function(){const e=n.children(".popover-content");const t=e.css("min-width");const i=e.outerWidth();e.css("min-width","100%");e.css("min-width",e.outerWidth());if(i>e.outerWidth()){e.css("min-width",t||"0px")}})}static show(e){const t=e.data("_help");if(t){t.show();return}e.data("_help",new i(e))}}AGN.Lib.Help=i})();(function(){let mobileViewThreshold=0;AGN.Lib.Helpers={paramsFromUrl:function(e){var t={};var i;if(e){i=e.indexOf("?")}else{return t}if(i==-1)return t;var n=e.substring(i+1);var r=n.split("&");for(var o=0;o<r.length;o++){var s=r[o].split("=");t[s[0]]=s[1]}return t},objFromString:function(optsAsString){var optsArray,optsSplitRegex=/,\s*(?=(?:[^'\\]*(?:\\.|'(?:[^'\\]*\\.)*[^'\\]*'))*[^']*$)/m,tupleSplitRegex=/:\s*(?=(?:[^'\\]*(?:\\.|'(?:[^'\\]*\\.)*[^'\\]*'))*[^']*$)/m,floatRegex=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,arrayRegex=/^\s?\[.*?\]$/i;opts={};if(optsAsString===""||optsAsString===undefined){return opts}optsArray=optsAsString.split(optsSplitRegex);_.forEach(optsArray,function(opt){var tup=opt.split(tupleSplitRegex),name,value;tup=_.filter(tup);name=tup[0].replace(/^'([^]*?)'$/m,"$1");name=name.replace(/\\/,"");value=tup[1];if(typeof value==="undefined"){value=""}if(value=="true"){value=true}else if(value=="false"){value=false}else if(floatRegex.test(value)){value=parseFloat(value)}else if(arrayRegex.test(value)){value=value.replace(/\[|\]/g,"");value=value.split(/\s+/);value=_.map(value,function(v){if(/^\'(.*?)\'$/.test(v)){return v.replace(/^\'(.*?)\'$/g,"$1")}else{return eval(v)}})}else{value=value.replace(/^'(.*?)'$/m,"$1");value=value.replace(/\\/,"")}opts[name]=value});return opts},disableCSSAnimations:function(){var e=$('<style class="disable-animation">* { -webkit-transition: none !important; -o-transition: none !important; transition: none !important; }</style>');$("body").append(e)},enableCSSAnimations:function(){window.setTimeout(function(){$(".disable-animation").remove()},10)},clearFormField:function(e){var t=$("<form></form>");var i=$("<div></div>");i.insertAfter(e);t.append(e);t.get(0).reset();e.insertBefore(i);i.remove()},renameFile:function(e,t){Object.defineProperty(e,"name",{writable:true,value:t})},formatBytes:function(e,t){if(e==0)return"0 Bytes";if(e==1)return"1 Byte";if(e==-1)return"-1 Byte";var e=Math.abs(e);if(t&&t.toLowerCase()&&t.toLowerCase()=="iec"){var i=Math.pow(2,10);var n=["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]}else{var i=Math.pow(10,3);var n=["Bytes","kB","MB","GB","TB","PB","EB","ZB","YB"]}var r=Math.floor(Math.log(e)/Math.log(i));var o=e/Math.pow(i,r);if(e<0){o*=-1}if(o>=99.995||r==0){return o.toFixed(0)+" "+n[r]}else{return o.toFixed(2)+" "+n[r]}},pad:function(e,t,i){i=i||"0";var n=e+"";if(n.length<t){return new Array(t-n.length+1).join(i)+n}else{return n}},caching:function(e,t){var i=false;var n;if(arguments.length>1){e=_.bind.apply(null,Array.prototype.slice.call(arguments))}return function(){if(!i){i=true;n=e()}return n}},replaceAgnTags:function(e,a){try{return e.replace(/\[(agn[A-Z0-9]+)(?:[^'"\]]|'.*?'|".*?")+]/g,function(e,t){var i=$("<"+e.substring(1,e.length-1)+">")[0];if(i instanceof HTMLElement){var n=i.attributes;var r={};for(var o=0;o<n.length;o++){var s=n[o];r[s.nodeName]=s.nodeValue}return a({name:t,attributes:r},e)}return e})}catch(e){}return e},escapeAgnTags:function(e){try{if(e){return e.replace(/\[agn[A-Z0-9]+(?:[^'"\]]|'.*?'|".*?")+]/g,function(e){if(e.includes("'")||e.includes('"')){return _.escape(e)}else{return e}})}}catch(e){}return e},unescapeAgnTags:function(e){try{if(e){return e.replace(/\[agn[A-Z0-9]+(?:(?!&#39;|&quot;)[^'"\]]|=\s*&#39;.*?&#39;|=\s*&quot;.*?&quot;)*]/g,function(e){return _.unescape(e)})}}catch(e){}return e},isValidEmail:function(e){const t=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(String(e).toLowerCase())},isUrl:function(e){const t=/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&/=]*)$/;return t.test(e)},deepFreeze:function(e){Object.freeze(e);const t=Object.getOwnPropertyNames(e);for(const i of t){const n=e[i];if(typeof n==="object"&&n!==null&&!Object.isFrozen(n)){this.deepFreeze(n)}}return e},isMobileView:function(){if(mobileViewThreshold===0){mobileViewThreshold=parseInt($("html").css("--mobile-view-threshold"))}return $(window).width()<=mobileViewThreshold},openHelpModal:function(t="",i={}){const e=$.get(AGN.url(`/support/help-center.action?helpKey=${window.helpKey}`));e.done(e=>{AGN.Lib.Confirm.create(e).done(e=>Page.render(e));if(t){$(`[data-help-tab="${t}"]`).trigger("help-tab:open",i)}})},getColorLuminance:function(e){e=e.replace("#","");const t=parseInt(e.substring(0,2),16);const i=parseInt(e.substring(2,4),16);const n=parseInt(e.substring(4,6),16);return(.299*t+.587*i+.114*n)/255},isFilledTextNode:function(e){return e.nodeType===3&&e.nodeValue?.trim()?.length>0},containsTruncatedElements:function(t){if($(t).is("select, .select2")){return false}if($(t.parentElement).is(":truncated")){return true}if(t.childNodes&&t.childNodes.length>0){for(let e=0;e<t.childNodes.length;e++){const i=this.containsTruncatedElements(t.childNodes[e]);if(i){return i}}}return false},retrieveTextElement:function(t){if(this.isFilledTextNode(t)){return t.parentElement}if(t.childNodes&&t.childNodes.length>0){for(let e=0;e<t.childNodes.length;e++){const i=this.retrieveTextElement(t.childNodes[e]);if(i){return i}}}return null}}})();(function(){var n;n=function(e){var t,i=this;i.el=e;i.url=e.data("load");i.interval=parseInt(e.data("load-interval"));i.target=e.data("load-target");if(i.interval){t=function(){i.load()};i._interval=window.setInterval(t,i.interval)}i.el.removeAttr("data-load")};n.load=function(e,t){var i;i=e.data("_load");if(i){i.load();return}if(e.is(":hidden")&&t!==true){return}i=new n(e);i.load();e.data("_load",i)};n.get=function(e){return e.data("_load")};n.prototype.stop=function(){window.clearInterval(this._interval)};n.prototype.load=function(){var e,r=this;if(r.loading){return}r.loading=true;e=$.get(r.url);e.always(function(){if(r.interval){r.loading=false}});e.fail(function(){r.stop()});e.done(function(e){var t=$(e),i,n;n=t.all("[data-load-stop]");if(n.length!=0){r.stop()}if(!r.target){i=e}else if(r.target=="body"){i=/<body[^>]*>((.|[\n\r])*)<\/body>/im.exec(e)[1]}else{i=t.all(r.target)}if(r.el.is("[data-load-replace]")){r.el.replaceWith(i);r.el=i}else{r.el.html(i)}AGN.Lib.Controller.init(r.el);AGN.runAll(r.el)})};AGN.Lib.Load=n})();(function(){let e={},t,i=0,n=false;e.show=function(){window.clearTimeout(t);if(!n){i+=1;$(".loader--main").removeClass("hidden")}else{n=false}};e.hide=function(){i-=1;if(i<=0){t=window.setTimeout(function(){$(".loader--main").addClass("hidden")},5);i=0}};e.prevent=function(){n=true};AGN.Lib.Loader=e})();(function(){var e,t=AGN.Lib.Form;e=function(e){t.apply(this,[e]);AGN.Lib.Loader.show();this.submit()};e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.prototype.jqxhr=function(){var t=this,i=$.Deferred();this.$form.trigger("form:submit");window.setTimeout(function(){var e=$.ajax({url:t.url,method:t.method,data:t.params(),loader:t.loader()});e.done(function(e){i.resolve.apply(this,arguments)})},parseInt(this.$form.data("polling-interval")));return i.promise()};e.prototype.submit=function(){var e,t=this;e=this.jqxhr();e.done(function(e){t.updateHtml(e)});return e};e.prototype.updateHtml=function(e){var t,i=$(e);t=i.filter('[data-form="loading"]').add(i.find('[data-form="loading"]'));if(t.length==1){this.$form.html(t.html());AGN.runAll(this.$form);this.submit()}else{AGN.Lib.Loader.hide();AGN.Lib.Page.render(e)}};AGN.Lib.LoadingForm=e;AGN.Opt.Forms["loading"]=e})();(function(){var Messages=function(e,t,i,n,r){const o={timeout:{success:3e3,warning:3e3}};if(!i){i="info"}const s=o["timeout"][i||"info"]||0;if(findMessagesWithSameContent(e,t).length){return}const a=toastr[i](e,t,{timeOut:s,extendedTimeOut:s,onCloseClick:n,newestOnTop:r});AGN.Lib.Controller.init(a);AGN.runAll(a)};var findMessagesWithSameContent=function(n,r){return $(".popup-tab:not(.arrow)").filter((e,t)=>{const i=$(t).data("options");return n===i.title&&r===i.message})};var displayMessages=function(t,e,i){e.forEach(function(e){Messages(t,e,i)})};var hideMessages=function(){_.each($(".notification"),function(e){e.remove()})};var JsonMessages=function(e,i){if(!!i){hideMessages()}if(e){if(e.success){displayMessages(t("defaults.success"),e.success,"success")}if(e.warning){displayMessages(t("defaults.warning"),e.warning,"warning")}if(e.alert){displayMessages(t("defaults.error"),e.alert,"alert")}if(e.fields){$.each(e.fields,function(e,i){if(i){displayMessages(t("defaults.error"),i,"alert")}})}}};var RenderMessages=function($resp){$resp.all('script[data-message][type="text/html"]').appendTo($(document.body));$resp.all('script[data-message][type="text/javascript"]').each(function(){try{eval($(this).html())}catch(exception){console.debug(exception)}})};Messages.success=function(e,...i){Messages(t("defaults.success"),t(e,...i),"success")};Messages.alert=function(e,...i){Messages(t("Error"),t(e,...i),"alert")};Messages.alertText=function(e){Messages(t("Error"),e,"alert")};Messages.warn=function(e,...i){Messages(t("defaults.warning"),t(e,...i),"warning")};Messages.warnText=function(e){Messages(t("defaults.warning"),e,"warning")};Messages.info=function(e,...i){Messages(t("defaults.info"),t(e,...i),"info")};Messages.infoText=function(e){Messages(t("defaults.info"),e,"info")};Messages.defaultSaved=function(){Messages.success("defaults.saved")};Messages.defaultError=function(){Messages.alert("defaults.error")};AGN.Lib.Messages=Messages;AGN.Lib.JsonMessages=JsonMessages;AGN.Lib.RenderMessages=RenderMessages})();(function(){var r={};function e(e){var t="key#"+e;var i=r[t];var n=Array.prototype.slice.call(arguments,1);if(i){r[t]=i.filter(function(e){return e.apply(this,n)!==false})}}function t(e,t){var i="key#"+e;if($.isFunction(t)){if(!r[i]){r[i]=[]}r[i].push(t)}else{console.error("Callback must be a function")}}function i(e,t){if(arguments.length){var i="key#"+e;if(arguments.length>1){r[i]=r[i].filter(function(e){return e!==t})}else{r[i]=[]}}}AGN.Lib.Messaging={send:e,subscribe:t,unsubscribe:i}})();(function(){const i=function(){};i.create=function(e,t){let i=null,n;if(e instanceof $){n=e}else{n=$(e)}const r=n.filter(".modal");const o=n.filter("script");if(r.exists()){i=$(r[0]);i.data("_modal",t);o.each(function(){$(this).appendTo(i)});const s=new bootstrap.Modal(i,{focus:false});s.show();AGN.Lib.RenderMessages(n);AGN.Lib.Controller.init(i);AGN.runAll(i)}else{AGN.Lib.RenderMessages(n)}return i};i.fromTemplate=function(e,t={}){e=AGN.Opt.Templates[e]||AGN.Opt.Templates["modal"];return i.create(_.template(e)(t),t)};i.get=function(e){const t=i.getWrapper(e);return t.data("_modal")};i.getWrapper=function(e){return e.closest(".modal")};i.getInstance=function(e){const t=i.getWrapper(e);return bootstrap.Modal.getInstance(t)};AGN.Lib.Modal=i})();(function(){var u=AGN.Lib.Confirm,d={};function r(e){if(e){e=e.toUpperCase();switch(e){case"CONNECT":case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"POST":case"PUT":return e}}return"GET"}d.render=function(e,t){if(/<\s*\/\s*body\s*>/i.test(e)){var i=new DOMParser;var n=i.parseFromString(e,"text/html");if(t!==false&&n.head){var r=$(n.head).data("origin-uri");if(r){t=r}}if(t){window.history.pushState({},"",t)}var o=$(document).scrollTop();setTimeout(function(){AGN.Lib.Controller.init();AGN.runAll();$(document).scrollTop(o)},100);document.body=n.body;document.title=n.title;var s=$(document.body);s.find("script").each(function(e,t){var i=$(t);if(i.attr("src")){var n=$("<script><\/script>");$.each(t.attributes,function(){if(this.specified){n.attr(this.name,this.value)}});try{n.appendTo(s)}catch(e){console.debug(e)}}else if(i.attr("type")=="text/javascript"){try{eval.call(window,i.html())}catch(e){console.debug(e)}}})}else{var a=$(e);var l=a.filter(".modal");if(l.exists()){var c=$.Deferred();AGN.Lib.RenderMessages(a);u.create(a);c.resolve(u.get(a));return c.promise()}else{l=a.all("script[data-load]");if(l.exists()){return d.reload(l.data("load"),true).done(function(){AGN.Lib.RenderMessages(a)})}else{AGN.Lib.RenderMessages(a)}}}};d.reload=function(i,e,t){if(e){i=i||window.location.href;var n=$.Deferred();$.ajax(i,{method:r(t)}).done(function(e){var t=d.render(e,i);if(t){t.done(n.resolve).fail(n.reject)}else{n.resolve()}}).fail(function(){n.reject()});return n.promise()}else{if(i&&i!=window.location.href){window.location.assign(i)}else{window.location.reload(true)}return null}};AGN.Lib.Page=d})();(function(){var e={};var t=function(e){var t=[];if(e.length<8){t.push("password.error.too_short_min8")}if(!e.match("[a-z]")){t.push("password.error.no_lower_case")}if(!e.match("[A-Z]")){t.push("password.error.no_upper_case")}if(!e.match("[0-9]")){t.push("password.error.no_digits")}if(!e.match("[^a-zA-Z0-9]")){t.push("password.error.no_special")}return t};var i=function(e){if(e.length<12){return["password.error.too_short_min12"]}else{return null}};var n=function(e){if(e.length<32){return["password.error.too_short_min32"]}else{return null}};var r=function(e){return["password.error.generic_error"]};var o=[];s("LENGTH_8_MIXED",t);s("LENGTH_12_SIMPLE",i);s("WEBSERVICE",n);function s(e,t){o.push({name:e,fn:t})}e.find_password_policy=function(e){for(var t=0;t<o.length;t++){if(o[t].name==e){return o[t].fn}}return r};AGN.Lib.PasswordPolicies=e})();(function(){var e,r=AGN.Lib.Page,t=AGN.Lib.Form;e=function(e){t.apply(this,[e])};e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.prototype.jqhxr=function(){var n=this,r=$.Deferred();this.$form.trigger("form:submit");window.setTimeout(function(){var e=$.ajax({url:n.url,method:n.method,data:n.params(),loader:n.loader()});e.done(function(e){var t=$(e);var i=t.all('[data-form="polling"]');if(i.length==1){n.$form.data("polling-interval",i.data("polling-interval"));n.jqhxr().done(function(){r.resolve.apply(this,arguments)})}else{r.resolve.apply(this,arguments)}})},parseInt(this.$form.data("polling-interval")));return r.promise()};e.prototype.submit=function(){var e,t=this;AGN.Lib.Loader.show();e=this.jqxhr();e.done(function(e){AGN.Lib.Loader.hide();t.updateHtml(e)});return e};e.prototype.updateHtml=function(e){var t,i=$(e),n=this.$form.data("render");if(n=="page"){r.render(e)}else{if(this.$form.attr("id")){t=i.all("#"+this.$form.attr("id"))}else if(this.$form.attr("name")){t=i.all('[name="'+this.$form.attr("name")+'"]')}else{t=i.all("form")}setTimeout(function(){AGN.Lib.Controller.init();AGN.runAll()},100);this.handleMessages(e);this.$form.replaceWith(t)}};AGN.Lib.PollingForm=e;AGN.Opt.Forms["polling"]=e})();(function(c){const n={};const r=[];const o=function(e,t){const i=c(e);const n=c(t);const r=c(window).scrollTop();const o=c(window).outerHeight();const s=n.outerHeight();const a=n.offset().top-r;const l=a+s;if(i.outerHeight()<=a){return"top"}return o-l>a?"bottom":"top"};n.getOrCreate=function(e,t){const i={trigger:"hover",container:"body",animation:false,content:e.text()};return n.get(e)||n.new(e,c.extend(i,t))};n.new=function(e,t){if(e.length!==1){return false}const i=new bootstrap.Popover(e[0],c.extend({container:"body",placement:o},t));if(t&&t.enableAgnRunAll){e.on("shown.bs.popover",function(){const e=c(i.tip);AGN.Lib.Controller.init(e);AGN.runAll(e)})}r.push(i);return i};n.get=function(e){if(e.length!==1){return null}const t=bootstrap.Popover.getInstance(e);if(t){return t}const i=e.closest("div.popover");if(i.length){return bootstrap.Popover.getInstance(i)}};n.remove=function(e){if(e.length!==1){return false}const t=bootstrap.Popover.getOrCreateInstance(e);i(t);return true};n.validate=function(){const e=Array.from(r);_.each(e,function(e){if(e._element&&!c.contains(document.body,e._element)){i(e)}})};function i(e){const t=r.indexOf(e);if(t!==-1){r.splice(t,1)}e.dispose()}n.hide=function(e){n.get(e)?.hide()};AGN.Lib.Popover=n})(jQuery);(()=>{class i{static init(e){const t=AGN.Lib.Storage.get(i.#getStorageKey(e));if(t){e.prop("checked",!t.preview);i.#toggleUI(e)}}static toggle(e){i.#toggleUI(e);AGN.Lib.Storage.set(i.#getStorageKey(e),{preview:i.#isPreviewEnabled(e)})}static#toggleUI(e){const t=e.data("preview-table");$(t).toggleClass("table-preview",i.#isPreviewEnabled(e))}static#isPreviewEnabled(e){return!e.is(":checked")}static#getStorageKey(e){return`preview-table-${e.data("preview-table")}`}}AGN.Lib.PreviewTable=i})();(function(){var e,t=AGN.Lib.Form,s=AGN.Lib.Page;e=function(e){t.apply(this,[e]);this.resourceSelector=e.data("resource-selector")};e.prototype=Object.create(t.prototype);e.prototype.getResourceSelector=function(){if(this.resourceSelectorNextRequest){var e=this.resourceSelectorNextRequest;this.resourceSelectorNextRequest=null;return e}return this.resourceSelector};e.prototype.setResourceSelectorOnce=function(e){this.resourceSelectorNextRequest=e};e.prototype.updateHtml=function(e){var t=this.getResourceSelector();if(t){var i=$(e);var n=$(t);var r=i.all(t);if(n.length==1&&r.length==1){var o=false;if(n[0]==this.$form[0]||$.contains(n[0],this.$form[0])){o=true}n.html(r.html());this.handleMessages(i);if(o){this.initFields();this.initValidator()}AGN.Lib.Controller.init(n);AGN.runAll(n)}else{s.render(e);this.handleMessages(e,true)}}else{s.render(e);this.handleMessages(e,true)}};AGN.Lib.ResourceForm=e;AGN.Opt.Forms["resource"]=e})();(function(){function t(e,t){this.src=e;this.promises={};this.cache=$.extend({},t)}t.prototype.retrieve=function(i){var e=this.promises;var n=this.cache;var t=e[i];if(t&&t.state()=="pending"){return t}var r=$.Deferred();t=r.promise();if(n[i]){r.resolve(n[i])}else if(this.src){var o=$.ajax(this.src,{type:"POST",data:{mailingId:i}});e[i]=t;o.always(function(){delete e[i]});o.done(function(e){if(e&&e.mailingId==i){var t=e.links||[];n[i]=t;r.resolve(t,i)}else{r.reject(i)}});o.fail(function(){r.reject(i)})}else{r.reject(i)}return t};var l="DATE",c="DATETIME",i="INTEGER",n="DOUBLE",r="FLOAT",o="NUMBER",u="MAILING",d="MAILING_LINKS",h="INTERVAL_MAILING";function f(e){switch(e){case i:case n:case r:case o:return true;default:return false}}function a(e,t){switch(t){case l:case c:return e.dateOperators;case u:case d:return e.mailingOperators;case h:return e.intervalMailingOperators;default:if(f(t)){return e.numericOperators}else{return e.stringOperators}}}function e(e,t){var i=T("columnAndType",e);if(i){var n=i.options[i.selectedIndex];var r=n.value.toUpperCase();var o=n.getAttribute("data-extra").toUpperCase();var s=T("primaryOperator",e);var a=T("primaryValue",e);if(s.value==t["OPERATOR_IS"]){y(t,a,e)}else if(s.value==t["OPERATOR_MOD"]&&f(o)){b(t,a,e)}else if(o==l||o===c){x(t,a,e)}else if(o==h){S(t,a,e)}else if(o==u){A(t,a,e)}else if(o==d){E(t,a,e)}else if(r=="MAILTYPE"){w(t,a,e)}else if(r=="GENDER"){C(t,a,e)}else{_(t,a,e)}p(t,s,o,e)}}function p(e,t,i,n){var r=t.value;var o=M(D("primaryOperator",n),"form-control","1",n);var s=a(e,i);$.each(L(s),function(e,t){N(o,r,t.id,t.value)});G(t,o)}function s(e,t){var i=T("primaryValue",t);var n=i.value;var r=M(D("secondaryValue",t),"form-control js-select js-option-popovers","1",t);r.setAttribute("data-action","updateMailingLinkId"+(t==null?"New":""));R(e,n,r,e.mailingLinksSelectionsCache[t]&&e.mailingLinksSelectionsCache[t][n]);var o=$(i);var s=o.clone();s.val(o.val());s.css({display:"block"});k([s,r],$(i.parentNode))}function g(e,t,i){var n=T("primaryValue",t);var r=n.value;var o=e.mailingLinksSelectionsCache[t];if(!o){o={};e.mailingLinksSelectionsCache[t]=o}o[r]=i}function m(e){return $('select[name="'+e+'"] option')}function v(e){return P(m(e))}function P(e){return $.map(e.toArray(),function(e){var t=$(e);return{id:t.val(),value:t.text()}})}function F(e){var i={};$('select[name="all_mailings_urls_config"] optgroup').each(function(){var e=$(this);var t=e.find("option");i[e.attr("label")]=t.map(function(){var e=$(this);return{id:e.val(),value:e.text()}})});return $.extend(e,{mailingLinks:new t(e&&e["URL_GET_MAILING_LINKS"],i),mailingLinksSelectionsCache:{},allColumns:m("all_columns_config"),intervalMailings:v("interval_mailings_config"),modSecondaryOperators:v("mod_secondary_operators_config"),allMailings:v("all_mailings_config"),dateOperators:v("date_operators_config"),mailingOperators:v("mailing_operators_config"),intervalMailingOperators:v("interval_mailing_operators_config"),numericOperators:v("numeric_operators_config"),stringOperators:v("string_operators_config"),mailTypes:v("mail_types_config"),genders:v("genders_config"),dateFormats:v("date_formats_config")})}function y(e,t,i){var n=t.value==null?"":t.value;var r=M(D("primaryValue",i),"form-control","1",null);N(r,n,"null","null");N(r,n,"not null","not null");k([r],$(t.parentNode))}function b(e,t,i){var n=e.modSecondaryOperators;var r=t.value==null?"":t.value;var o=T("secondaryOperator",i);var s=o==null?"":o.value;var a=T("secondaryValue",i);var l=a==null?"":a.value;var c=I(D("primaryValue",i),r,"form-control");var u=M(D("secondaryOperator",i),"form-control","1",null);$.each(L(n),function(e,t){N(u,s,t.id,t.value)});var d=I(D("secondaryValue",i),l,"form-control");k([c,u,d],$(t.parentNode))}function _(e,t,i){var n=t.value==null?"":t.value;var r=I(D("primaryValue",i),n,"form-control");k([r],$(t.parentNode))}function w(e,t,i){var n=e.mailTypes;var r=t.value==null?"":t.value;var o=M(D("primaryValue",i),"form-control","1",null);$.each(L(n),function(e,t){N(o,r,t.id,t.value)});k([o],$(t.parentNode))}function C(e,t,i){var n=e.genders;var r=t.value==null?"":t.value;var o=M(D("primaryValue",i),"form-control","1",null);$.each(L(n),function(e,t){N(o,r,t.id,t.value)});k([o],$(t.parentNode))}function x(e,t,i){var n=e.dateFormats;var r=t.value==null?"":t.value;var o=T("dateFormat",i);var s=o==null?"":o.value;var a=I(D("primaryValue",i),r,"form-control");var l=M(D("dateFormat",i),"form-control","1",null);$.each(L(n),function(e,t){N(l,s,t.id,t.value)});k([a,l],$(t.parentNode))}function S(e,t,i){var n=e.intervalMailings;var r=t.value==null?"":t.value;var o=M(D("primaryValue",i),"form-control js-select","1",null);$.each(L(n),function(e,t){N(o,r,t.id,t.value)});k([o],$(t.parentNode))}function A(e,t,i){var n=e.allMailings;var r=t.value==null?"":t.value;var o=M(D("primaryValue",i),"form-control js-select","1",null);$.each(L(n),function(e,t){N(o,r,t.id,t.value)});k([o],$(t.parentNode))}function E(e,t,i){var n=e.allMailings;var r=t.value==null?"":t.value;var o=T("secondaryValue",i);var s=o==null?"":o.value;var a=M(D("primaryValue",i),"form-control js-select","1",i);a.setAttribute("data-action","resetMailingUrls"+(i==null?"New":""));$.each(L(n),function(e,t){N(a,r,t.id,t.value)});r=a.value;var l=M(D("secondaryValue",i),"form-control js-select js-option-popovers","1",i);l.setAttribute("data-action","updateMailingLinkId"+(i==null?"New":""));R(e,r,l,e.mailingLinksSelectionsCache[i]&&e.mailingLinksSelectionsCache[i][r]);k([a,l],$(t.parentNode))}function T(e,t){return document.getElementsByName(D(e,t))[0]}function D(e,t){return e+(t!=null?"["+t+"]":"New")}function R(e,t,n,r){e.mailingLinks.retrieve(t).done(function(e){if(e.length==0){return}var t=null;$.each(e,function(e){if(e==0||this.id==r){t=this.id}});var i=$(n);$.each(e,function(){i.append($("<option/>",{value:this.id,text:this.value,selected:t==this.id}))});if(i.data("select2")){i.select2("val",t)}})}function M(e,t,i,n){var r=document.createElement("select");r.setAttribute("name",e);r.setAttribute("class",t);r.setAttribute("size",i);r.setAttribute("data-action",e.replace(/\[\d+\]/,""));if(n!=null){r.setAttribute("data-ruleid",n)}return r}function G(e,t){var i=$(t);$(e).parent().html(i);if(i.is("select")){O(i)}}function k(e,i){if(e.length>0){var t=12;var n="col-sm-"+Math.round(t/e.length);i=i.parent();i.empty();$.each(e,function(){var e=$(this);var t=$("<div>").addClass(n);t.append(e);i.append(t);if(e.is("select")){O(e)}})}}function O(e){AGN.Lib.CoreInitializer.run("select",e.parent())}function N(e,t,i,n){var r=$("<option/>",{value:i,text:n,selected:t.localeCompare(i)==0});r.appendTo($(e));return r}function I(e,t,i){var n=document.createElement("input");n.setAttribute("type","text");n.setAttribute("name",e);n.setAttribute("value",t);n.setAttribute("class",i);return n}function L(e){var t=[];for(var i in e){if(e.hasOwnProperty(i)){t.push(e[i])}}return t}AGN.Lib.RuleService={changedColumn:e,resetPrimaryOperators:p,resetMailingUrls:s,updateMailingLinksCache:g,switchTo:{operators:{mod:b,is:y},types:{string:_,mail:w,gender:C,date:x,mailing:A,mailingLinks:E,intervalMailing:S}},configure:F}})();(function(){class t{static DATA_KEY="agn:perfect-scrollbar";constructor(e){this.$el=e;this.scrollbar=new PerfectScrollbar(e[0],{wheelSpeed:2,wheelPropagation:false,minScrollbarLength:30});e.data(t.DATA_KEY,this)}destroy(){this.scrollbar.destroy();this.$el.data(t.DATA_KEY,null)}update(){this.scrollbar.update()}static get(e){return e.data(t.DATA_KEY)||e.closest(".js-scrollable").data(t.DATA_KEY)}}AGN.Lib.Scrollbar=t})();(function(){const t=AGN.Lib.Form;const e=function(e){t.apply(this,[e])};e.prototype=Object.create(t.prototype);e.prototype.updateHtml=function(e){const t=$(e).find("[data-form-content]");const i=this.$form.is("[data-form-content]")?this.$form:this.$form.find("[data-form-content]");i.html(t.html());this.handleMessages(e);this.initFields(i);AGN.Lib.Controller.init(i);AGN.runAll(i);i.trigger("scrollTo",i)};AGN.Lib.SearchForm=e;AGN.Opt.Forms["search"]=e})();(function(){const n=function(e){this.$select=e;this.select=e[0]};n.get=function(e){const t=e;let i=t.data("_select");if(!i){i=new n(t);t.data("_select",i)}return i};n.prototype.map=function(){const i=this;return _.reduce(i.values(),function(e,t){e[t]=i.$select.find("option[value='"+t+"']").html();return e},{})};n.prototype.values=function(){return _.map(this.$select.find("option"),e=>$(e).val())};n.prototype.hasOption=function(e){return this.values().indexOf(e)!==-1};n.prototype.clear=function(){this.selectValue("")};n.prototype.selectNext=function(){const e=this.values();const t=this.getSelectedValue();const i=e.indexOf(t)+1;if(i<e.length){this.selectValue(e[i])}};n.prototype.selectValue=function(e){this.$select.val(e).trigger("change");if(this.$select.is("[multiple]")){const i=this.$select.data("select2").dataAdapter;this.$select.find("option").each(function(){const e=$(this);const t=i.item(e);if(e.is(":selected")){i.select(t)}else{i.unselect(t)}})}};n.prototype.getFirstValue=function(){return this.$select.find("option:not(:disabled):first").val()};n.prototype.selectFirstValue=function(){this.$select.val(this.getFirstValue()).trigger("change")};n.prototype.selectValueOrSelectFirst=function(e){const t=this.values();if(!_.isArray(e)){e=[e]}const i=_.every(e,e=>{return t.indexOf(e+"")!=-1});if(i&&e.length!=0){this.selectValue(e)}else{this.selectFirstValue()}};n.prototype.resetOptions=function(){this.$select.empty()};n.prototype.setOptions=function(e){const t=_.reduce(e,(e,t)=>{e+=`<option value="${t.id}">${t.text}</option>`;return e},"");this.$select.html(t)};n.prototype.addFormattedOption=function(e){this.$select.append(e)};n.prototype.getSelectedValue=function(){return this.$select.val()||""};n.prototype.addOption=function(e,t=e){this.$select.append($("<option>",{value:e,text:t}))};n.prototype.selectOptions=function(e){e.forEach(e=>this.selectOption(e))};n.prototype.selectOption=function(e){this.$findOption(e).prop("selected",true);this.$select.trigger("change")};n.prototype.isOptionSelected=function(e){return this.$findOption(e).prop("selected")};n.prototype.$findOption=function(e){return this.$select.find(`option[value="${e}"`)};n.prototype.getSelectedText=function(){return this.$select.find("option:selected").text()};n.prototype.disableOptions=function(i=[],e){this.$select.find("option").prop("disabled",false);this.$select.find(`option${e?"":":not(:selected)"}`).filter((e,t)=>i.includes($(t).val())).each((e,t)=>$(t).prop("disabled",true));if(e){this.selectFirstValue()}this.$select.trigger("change",[{programmatic:true}])};n.prototype.disableOption=function(e,t){this.disableOptions([e],t)};n.prototype.setReadonly=function(e){if(e){this.$select.attr("readonly","readonly")}else{this.$select.removeAttr("readonly")}};AGN.Lib.Select=n})();(function(){var e,t=AGN.Lib.Form;e=function(e){t.apply(this,[e])};e.prototype=Object.create(t.prototype);e.prototype.jqxhr=function(){return this.form.submit()};e.prototype.submit=function(){var n=this,e=_.merge({},this._data,this._dataNextRequest);if(!this.valid()){this.handleErrors();return false}this.$form.trigger("form:submit");_.each(e,function(e,t){var i=$('<input type="hidden" name="'+t+'"/>');i.val(e);i.appendTo(n.$form)});this._dataNextRequest={};this.$form.submit();return $.Deferred().promise()};AGN.Lib.StaticForm=e;AGN.Opt.Forms["static"]=e})();(function(d){var h,f,e,t,i,s,n,r;r=function(i){function t(e,t,i){var n,r;if(i){n=new Date;n.setTime(n.getTime()+i*24*60*60*1e3);r="; expires="+n.toGMTString()}else{r=""}document.cookie=e+"="+t+r+"; path=/"}function n(e){e=JSON.stringify(e);if(i=="session"){window.name=e}else{t("localStorage",e,365)}}function e(){if(i=="session"){window.name=""}else{t("localStorage","",365)}}function r(){var t=i=="session"?window.name:s("localStorage");try{return JSON.parse(t)}catch(e){console.warn("Could not parse storage data: "+t+" cause: "+e)}return{}}var o=r();return{length:0,clear:function(){o={};this.length=0;e()},getItem:function(e,t){if(t===true){var i=r();return i[e]===undefined?null:i[e]}else{return o[e]===undefined?null:o[e]}},key:function(e){var t=0;for(var i in o){if(t==e)return i;else t++}return null},removeItem:function(e){delete o[e];this.length--;n(o)},setItem:function(e,t){o[e]=t+"";this.length++;n(o)}}};s=function(e){var t=e+"=",i=document.cookie.split(";"),n,r;for(n=0;n<i.length;n++){r=i[n];while(r.charAt(0)==" "){r=r.substring(1,r.length)}if(r.indexOf(t)==0){return r.substring(t.length,r.length)}}return null};try{if(!window.localStorage){n=new r("local")}else{n=window.localStorage}}catch(e){n=new r("local")}h=function(t){try{var e=n.getItem(l(t));if(e){return JSON.parse(e)}}catch(e){console.warn("Could not get Storage key: "+t+" cause: "+e)}return undefined};f=function(t,i){try{i=JSON.stringify(i);n.setItem(l(t),i)}catch(e){console.warn("Could not set Storage key:value "+t+":"+i+" cause: "+e)}};e=function(t){try{n.removeItem(l(t))}catch(e){console.warn("Could not remove Storage key:"+t+" cause: "+e)}};t=function(e){e.each(function(){var e=d(this);if(e.is("[data-stored-field]")&&(e.is("input")||e.is("select"))){o(e)}else{e.find("[data-stored-field]").each(function(){o(d(this))})}})};i=function(e){var t=false;e.each(function(){var e=d(this);if(e.is("[data-stored-field]")&&(e.is("input")||e.is("select"))){if(a(e)){t=true}}else{e.find("[data-stored-field]").each(function(){if(a(d(this))){t=true}})}});return t};function o(e){var t=e.data("stored-field")|"";var i=e.prop("name");if(i!=undefined){var n=undefined;if(e.prop("type")=="checkbox"){n=e.is(":checked")}else if(e.is("input")||e.is("select")){n=e.val()}if(n!=undefined){f(g(i,t),n)}}}function a(e){var t=e.data("stored-field")|"";var i=false;var n=e.prop("name");if(n!=undefined){var r=e.prop("type")||e.prop("type");var o=h(g(n,t));if(o===undefined){o=h(p(n,t));if(o===undefined){return false}f(g(n,t),o)}if(r=="radio"){if(e.val()!==o&&e.is(":checked")){e.prop("checked",false);return true}else if(e.val()==o&&!e.is(":checked")){e.prop("checked",true);return true}}else if(r=="checkbox"){if(e.prop("checked")!==o){e.prop("checked",o);i=true}}else if(r=="select-one"){var s=false;e.find("option").each(function(){if(d(this).val()==o){s=true;return false}});if(s&&e.val()!==o){e.val(o).change();i=true}}else if(r=="select-multiple"){var a=[];var l=e.value();e.find("option").each(function(){var i=d(this);d.each(o,function(e,t){if(i.val()==t){a.push(t)}})});a.sort();l.sort();var c=true;if(a.length!=l.length)c=false;for(var u=0;u<a.length;++u){if(a[u]!==l[u])c=false}if(!c){e.val(a).change();i=true}}else if(r=="textarea"||r=="text"){if(e.val()!==o){e.val(o);i=true}}}return i}function p(e,t){var i="stored_field_";if(e){i=i+e}if(t){i=i+"_"+t;return i}return undefined}function g(e,t){var i=p(e,t);if(i){return l(i)}else{return i}}function l(e){if(window.adminId){return window.adminId+"-"+e}return e}AGN.Lib.Storage={get:h,set:f,delete:e,readCookie:s,saveChosenFields:t,restoreChosenFields:i}})(jQuery);(function(){const a=AGN.Lib.Storage;const e=function(e){var t=e.data("toggle-tab"),i=c(e,t),n=a.get("toggle_tab"+i)||{},r=$(t);if(typeof r.data("tab-show")!=="undefined"){n.hidden=false;r.data("tab-show",undefined)}if(typeof r.data("tab-hide")!=="undefined"){n.hidden=true;r.data("tab-hide",undefined)}if(n.hidden===false||n.hidden!==true&&r.is(":visible")){o(e)}};const o=function(e){var t=e.parents("ul").find("[data-toggle-tab]").not(e),i=e.data("toggle-tab"),n=c(e,i),r=$(i),o=e.find(".tab-toggle"),s=$(e.data("extends-tab"));_.each(t,e=>l($(e)));e.addClass("active");e.closest("nav").find(".chosen-tab > span").text(e.text());o.removeClass("icon-angle-down").addClass("icon-angle-up");r.removeClass("hidden");s.removeClass("hidden");r.trigger("tile:show");a.set("toggle_tab"+n,{hidden:false});AGN.Lib.CoreInitializer.run("load",r)};const l=function(e){var t=e.data("toggle-tab"),i=c(e,t),n=e.find(".tab-toggle");e.removeClass("active");n.removeClass("icon-angle-up").addClass("icon-angle-down");$(t).addClass("hidden");$(t).trigger("tile:hide");a.set("toggle_tab"+i,{hidden:true})};const t=function(e){var t=e.data("toggle-tab"),i=$(t);if(i.is(":visible")){l(e)}else{o(e)}};function c(e,t){const i=e.data("tab-group");return i?`/${i}`:t}AGN.Lib.Tab={init:e,show:o,hide:l,toggle:t}})();(function(){const n=AGN.Lib.Helpers;const r=AGN.Lib.Popover;class o{constructor(e,t,i,n){this.$el=e;this.$el.html(this.#template);this.$tableControls=this.$el.find(".table-controls-wrapper");this.$el.data("_table",this);t.forEach(function(e){if(e.cellRenderer){e.cellRenderer=AGN.Opt.TableCellRenderers[e.cellRenderer]}if(e.headerComponent){e.headerComponent=AGN.Opt.TableHeaderComponents[e.headerComponent]}if(e.filter){e.filter=AGN.Opt.Table["filters"][e.filter]}if(e.comparator){e.comparator=AGN.Opt.Table["comparators"][e.comparator]}if(e.hasOwnProperty("suppressSizeToFit")&&!i.length){e.suppressSizeToFit=false}});t[t.length-1].resizable=false;this.gridOptions=_.merge(this.#defaultGridOptions(t),n||{});this.#setTableHeight();this.grid=new agGrid.Grid(this.$table.get(0),this.gridOptions);this.api=this.gridOptions.api;this.columnApi=this.gridOptions.columnApi;this.api.setRowData(this.gridOptions.singleNameTable?i.map(e=>({name:e})):i);this.redraw();this.#bindFilters();this.popoverTimer=undefined}#defaultGridOptions(e){const i=this;return{autoSizePadding:4,columnDefs:e,accentedSort:true,colResizeDefault:"shift",scrollbarWidth:0,pagination:true,showRecordsCount:true,filtersDescription:{enabled:false,templateName:"",templateParams:{}},paginationPageSize:100,rowSelection:"multiple",unSortIcon:true,overlayNoRowsTemplate:`
        <div class="w-100 align-self-start">
         ${AGN.Lib.Template.text("notification-info",{message:t("defaults.table.empty")})}
        </div>
      `,onCellClicked:function(e){switch(e.colDef.cellAction){case"select":e.node.setSelected(!e.node.isSelected());break;case"goTo":const t=e.data.show;if(t){if(e.event.ctrlKey){window.open(t,"_blank")}else{window.location.href=t}}break}},onCellMouseOver:_.throttle(e=>this.showCellPopoverIfTruncated(e),50),onCellMouseOut:_.throttle(e=>this.hideCellPopover(e),50),suppressRowClickSelection:true,headerHeight:30,suppressPaginationPanel:true,onPaginationChanged:function(){i.renderPagination()},defaultColDef:{filter:true,sortable:true,resizable:true,headerComponentParams:{template:`
          <div class="ag-cell-label-container" role="presentation">
            <!-- <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button"></span> filters are displaying in separate 'Filter' tile-->
            <div ref="eLabel" class="ag-header-cell-label" role="presentation">
              <span ref="eSortAsc" class="ag-header-icon ag-sort-ascending-icon" ></span>
              <span ref="eSortDesc" class="ag-header-icon ag-sort-descending-icon" ></span>
              <span ref="eSortNone" class="ag-header-icon ag-sort-none-icon" ></span>
              <span ref="eText" class="ag-header-cell-text" role="columnheader"></span>
              <!-- <span ref="eFilter" class="ag-header-icon ag-filter-icon"></span> filters are displaying in separate 'Filter' tile-->
              <span ref="eSortOrder" class="ag-header-icon ag-sort-order" ></span>
            </div>
          </div>`},filterParams:{clearButton:true}},columnTypes:{numberColumn:{cellDataType:"text",comparator:AGN.Lib.TableNumberComparator},numberRangeColumn:{filter:"agNumberColumnFilter",filterParams:{inRangeInclusive:true}},dateColumn:{filter:DateRangeFilter,cellRenderer:o.dateCellRenderer},dateTimeColumn:{filter:DateRangeFilter,cellRenderer:o.dateTimeCellRenderer},setColumn:{filter:SetFilter},bulkSelectColumn:{headerName:"",editable:false,checkboxSelection:true,headerCheckboxSelection:true,headerComponent:AGN.Opt.TableHeaderComponents["NoLabelHeader"],resizable:false,suppressMenu:true,sortable:false,cellAction:"select",suppressSizeToFit:true,cellStyle:{textAlign:"center"}},deleteColumn:{headerName:"",editable:false,resizable:false,suppressMenu:true,sortable:false,cellAction:null,cellRenderer:AGN.Opt.TableCellRenderers["DeleteCellRenderer"],suppressSizeToFit:true,"button-tooltip":t("defaults.delete")},textCaseInsensitiveColumn:{comparator:AGN.Lib.TableCaseInsensitiveComparator},select:{comparator:AGN.Lib.TableCaseInsensitiveComparator}},icons:{menu:'<i class="icon icon-filter"/>',filter:'<i class="icon icon-filter"/>',columns:'<i class="icon icon-handshake-o"/>',sortAscending:'<i class="icon icon-sort-down"/>',sortDescending:'<i class="icon icon-sort-up"/>',checkboxChecked:'<i class="icon icon-check-square"/>',checkboxUnchecked:'<i class="icon icon-square"/>',checkboxIndeterminate:'<i class="icon icon-square-o"/>',checkboxCheckedReadOnly:'<i class="icon icon-check-square-o"/>',checkboxUncheckedReadOnly:'<i class="icon icon-square-o"/>',checkboxIndeterminateReadOnly:'<i class="icon icon-square-o"/>',sortUnSort:'<i class="icon icon-sort"/>'},localeText:window.I18n.tables,onFilterChanged:function(){const e=i.api.getModel().rowsToDisplay.length;if(e===0){i.api.showNoRowsOverlay()}else{i.api.hideOverlay()}}}}hideCellPopover(e){clearTimeout(this.popoverTimer);const t=this.#getClosestCell(e.event.target);r.get(t)?.hide()}showCellPopoverIfTruncated(i){this.popoverTimer=setTimeout(()=>{const e=this.#getClosestCell(i.event.target);if(this.#isTruncatedCell(e[0])){const t=$(n.retrieveTextElement(e[0])).text();r.getOrCreate(e,{trigger:"manual",content:t}).show()}},400)}#isTruncatedCell(e){return e&&($(e).is(":truncated")||n.containsTruncatedElements(e))}#getClosestCell(e){const t=$(e);return t.is(".ag-cell")?t:t.closest(".ag-cell")}static dateCellRenderer(e,t=false){const i=t?window.adminDateTimeFormat:window.adminDateFormat;const n=AGN.Lib.TableCellWrapper(e?.data?.show);const r=e?.value?.date||e.value;n.innerHTML=r?moment(r).format(i.replaceAll("d","D").replaceAll("y","Y")):"";return n}static dateTimeCellRenderer(e){return o.dateCellRenderer(e,true)}get theme(){return"bootstrap"}get#template(){return`<div class="ag-theme-${this.theme}" style="width: 100%; height: calc(100% - 30px)"></div>
            <div class="table-controls-wrapper"></div>`}get $table(){if(!this._$table){this._$table=this.$el.find(`.ag-theme-${this.theme}`)}return this._$table}#setTableHeight(){if(!this.gridOptions.showRecordsCount&&!this.gridOptions.pagination){this.$table.height(this.$el.parent().height())}}renderPagination(){const e=this.api;if(!e){return}const t=e.paginationGetCurrentPage()+1;const i=e.paginationGetTotalPages();const n=[t];const r=AGN.Lib.Template.prepare("table-controls");_.times(5,function(e){if(t-(e+1)>0){n.unshift(t-(e+1))}if(t+(e+1)<=i){n.push(t+(e+1))}});const o={pagination:this.gridOptions.pagination,showRecordsCount:this.gridOptions.showRecordsCount,currentPage:t,totalPages:i,pageSize:e.paginationGetPageSize(),itemStart:e.paginationGetPageSize()*(t-1)+1,itemEnd:t==i?e.paginationGetRowCount():e.paginationGetPageSize()*t,itemTotal:this.gridOptions.pagination?e.paginationGetRowCount():e.getDisplayedRowCount(),pageSelects:n};const s=this.gridOptions.filtersDescription;if(s.enabled&&s.templateName){this.$paginationTop.find("#filtersDescription").html(AGN.Lib.Template.text(s.templateName),s.templateParams)}this.$tableControls.html(r(o));AGN.Lib.CoreInitializer.run("select",this.$tableControls);this.api.redrawRows()}redraw(){const e=this.columnApi.getAllDisplayedColumns().filter(function(e){return e.getColDef().suppressSizeToFit===true}).map(function(e){return e.getColId()});if(e.length){this.columnApi.autoSizeColumns(e)}this.api.sizeColumnsToFit();this.$el.trigger("table:redraw")}#bindFilters(){$("#filter-tile").on("enterdown",e=>{e.preventDefault();this.applyFilter.bind(this)()});$("#apply-filter").on("click",this.applyFilter.bind(this));$("#reset-filter").on("apply-filter",this.applyFilter.bind(this))}applyFilter(){const e=_.groupBy(this.columnApi.getAllDisplayedColumns(),e=>e.getColDef().type);const t=this.#getFilterModelForTextCols(e["numberColumn"]);const i=this.#getFilterModelForNumberRangeCols(e["numberRangeColumn"]);const n=this.#getFilterModelForTextCols(e["textCaseInsensitiveColumn"]);const r=this.#getFilterModelForSelectCols(e["select"]);const o=this.#getEmptyFilterModelForCols(_.union(e["dateColumn"],e["dateTimeColumn"],e["customColumn"],e["setColumn"]));const s=this.#getFilterModelForTextCols(e["undefined"]);this.api.setFilterModel({...i,...t,...n,...r,...s,...o})}#getFilterModelForNumberRangeCols(e=[]){return e.reduce((e,t)=>{const i=t.getColId();const n=$(`#${i}-min-filter`).val()||Number.MIN_SAFE_INTEGER;const r=$(`#${i}-max-filter`).val()||Number.MAX_SAFE_INTEGER;e[i]={filterType:"number",type:"inRange",filter:n,filterTo:r};return e},{})}#getFilterModelForTextCols(e=[]){return e.reduce((e,t)=>{const i=t.getColId();const n=$(`#${i}-filter`.replaceAll(".","\\.")).val()?.toLowerCase();e[i]={type:"contains",filter:n};return e},{})}#getFilterModelForSelectCols(e=[]){return e.reduce((e,t)=>{const i=t.getColId();const n=$(`#${i}-filter`).val()?.toLowerCase();e[i]={type:"equals",filter:n};return e},{})}#getEmptyFilterModelForCols(e=[]){return e.reduce((e,t)=>{e[t.getColId()]={};return e},{})}static get(e){return o.getWrapper(e).data("_table")}static getWrapper(e){let t=$(e.data("table-body"));if(t.length==0){t=e.closest(".js-data-table-body")}return t}}AGN.Lib.Table=o})();(function(){var e;e=function(){};e.getComplexityColor=function(e){var t;if(e<10){t="green"}else if(e>=10&&e<17){t="yellow"}else{t="red"}return t};AGN.Lib.TargetGroup=e})();(function(){const i=AGN.Lib.CSRF;const n=AGN.Opt.Templates;function r(e){if(a(e)){const t=_.template(n[e]);return o(t)}throw new Error("There's no template `"+e+"` registered")}function o(t){return function(){const e=t.apply(this,arguments);return i.updateTokenInDOM(e,true)}}function s(e,t){return r(e)(t)}function e(e,t){return $(s(e,t))}function a(e){return e in n}AGN.Lib.Template={prepare:r,text:s,dom:e,exists:a}})();(function(){const n=AGN.Lib.Storage;function r(e,t){const i=e.find("> .tile-header .tile-title .icon");i.toggleClass("icon-caret-down",t);i.toggleClass("icon-caret-up",!t)}function o(e){return`collapsed${e.data("toggle-tile")==="mobile"?"-mobile":""}`}function s(e,t,i){e.toggleClass(o(e),t);r(e,t);if(i&&e.attr("id")){n.set(`toggle_tile#${e.attr("id")}`,{hidden:t})}if(!t){AGN.Lib.CoreInitializer.run("load",e.find(".tile-body"))}}function a(e){const t=e.data("toggle-tile-default-state");if(!t){return}s(e,t!=="open",false)}const e=function(e){const t=e.attr("id");const i=t?n.get("toggle_tile#"+t):undefined;if(!i){a(e);return}s(e,i.hidden,true)};const t=function(e){s(e,!e.hasClass(o(e)),true)};const i=function(e){return e.closest(".tile").find("[data-toggle-tile]")};const l=function(e){s(e,false,true)};const c=function(e){s(e,true,true)};AGN.Lib.Tile={toggle:t,init:e,show:l,hide:c,trigger:i}})();(function(){const r={};const o=AGN.Lib.Template;const e=AGN.Lib.Helpers;const t=AGN.Lib.Popover;r.get=function(e){const t=bootstrap.Tooltip.getInstance(e);if(t){return t}return null};const n=function(){const n=o.prepare("tooltip-template");return function(e,t,i){return n({tooltipStyle:e,arrowStyle:t,innerStyle:i})}}();function s(e,t,i){return{title:e,container:"body",template:n(t),...i&&{trigger:i}}}r.options=function(t){let i={};if(t.is("[data-tooltip]")){let e=t.data("tooltip");const n=t.data("tooltip-src");if(n){e=o.text(n,{element:t})}i=s(e,t.data("tooltip-style"))}return $.extend(i,e.objFromString(t.data("tooltip-options")))};r.create=function(e,t){r.remove(e);const i=new bootstrap.Tooltip(e,t);e.on("remove",function(){r.remove(e)});if(t.trigger!=="manual"){const n=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){i.hide()}})});n.observe(e[0])}return i};r.remove=function(e){const t=bootstrap.Tooltip.getInstance(e);if(t){t.dispose()}};r.setShown=function(e,t){if(t||t===undefined){e.tooltip("show")}else{e.tooltip("hide")}};r.createTip=function(e,t,i,n){return r.create(e,s(t,i,n))};AGN.Lib.Tooltip=r;class i{static defaultOptions={trigger:"hover",html:true,popperConfig:{placement:"bottom-start"}};constructor(e){this.$el=e;this.elementData=this.$el.data("tooltip-help");this.$el.one("mouseenter",()=>t.getOrCreate(e,this.getOptions(e)).show())}getOptions(e){return $.extend(i.defaultOptions,this.getElementSpecificOptions(e))}#getXOffset(){const e=this.elementData;const t=this.$el.outerWidth();return e.placement==="bottom-end"?-t:t}getElementSpecificOptions(){const e=this.elementData;const t=[this.#getXOffset(),0];if(!e.content){return{content:e,offset:t}}if(e.placement){e.popperConfig={placement:e.placement}}e.offset=t;return e}}AGN.Lib.HelpTooltip=i})();(function(){class e{constructor(e,t,i){const n=this;this.multiple=!t.exists()||t.is("[multiple]");this.selection=[];this.$dropzone=e;this.$file=t;if(e.exists()){e.data("agn:upload",this);new Dropzone(e,{classDragOver:"drag-over",onSelectFiles:function(e){const t=i?i:n;t.#drop(e)}})}else{t.data("agn:upload",this);t.on("change",()=>{const e=i?i:n;e.#drop(t.prop("files"))})}}static get(e,t){if(e.exists()){return e.data("agn:upload")}return t.data("agn:upload")}reset(){this.selection=[];this.$file.val("")}getSelection(){return this.selection.slice(0)}#drop(i){if(!i||i.length<=0){return}let n=false;if(this.multiple){for(let t=0;t<i.length;t++){let e=i[t];if(this.#onDrop(e,this.selection.length)){this.selection.push(e);n=true}}}else{let e=i[0];if(this.#onDrop(e,0)){this.selection=[e];n=true}}if(n){this.$dropzone.trigger("upload:dropped")}}#onDrop(e,t){const i=$.Event("upload:add");const n=this.$dropzone.exists()?this.$dropzone:this.$file;n.trigger(i,{file:e,index:t});return!i.isDefaultPrevented()}}AGN.Lib.Upload=e})();(function(){var n;n=function(e){if(e.init){e.init();delete e.init}return $.extend(this,e)};n.exists=function(e){return AGN.Opt.Validators.hasOwnProperty(e)};n.get=function(e){return n.exists(e)?AGN.Opt.Validators[e]:null};n.new=function(e,t){if(n.exists(e)){console.debug("Validator with name `"+e+"` was overridden")}var i=new n(t);AGN.Opt.Validators[e]=i;return i};n.prototype.valid=function(){return true};n.prototype.errors=function(){return[]};AGN.Lib.Validator=n})();(function(){var i=AGN.Lib.Storage;var n={};n.get=function(e){var t="web-storage#"+$.trim(e);try{return i.get(t)}catch(e){console.error(e)}return null};n.set=function(e,t){i.set("web-storage#"+$.trim(e),t)};n.extend=function(e,t){var i=n.get(e);if(i!=null){i=$.extend(i,t)}else{i=t}n.set(e,i);return i};AGN.Lib.WebStorage=n})();(function(){var o={};o.make=function(t,e){o.adjustChildren(t,e);e.forEach(function(e){e.adjustHeight(t.getHeightForSpans(e.getRow(),e.getColumn(),e.getRows(),e.getColumns()))})};o.getChildrenProjections=function(n,e){var a=[];n.each(function(e){a.push({row:e,projections:[]})});var l=[];e.forEach(function(e){var t=[];var i={child:e,height:e.getHeight(),spans:t};var n=e.getRow();var r=n+e.getRows()-1;for(var o=n;o<=r;o++){var s={cascade:i,height:0,margin:0,adjusted:false};t.push(s);a[o-1].projections.push(s)}l.push(i)});$.each(a,function(e,t){var i=n.getRowMargin(t.row.isGuttered());$.each(t.projections,function(e,t){t.margin=i})});$.each(l,function(e,t){o.adjustCascade(t)});return a};o.adjustCascade=function(e){var t=Math.max(e.height,AGN.Lib.LB.Definitions.COLLAPSED_BLOCK_SIZE);var i=0;var n=e.spans;var r=[];for(var o=0;o<n.length;o++){var s=n[o];if(s.adjusted===false){s.height=AGN.Lib.LB.Definitions.COLLAPSED_BLOCK_SIZE;r.push(s)}i+=s.height;if(i+s.margin>=t){for(o=o+1;o<n.length;o++){n[o].height=0}break}if(o+1<n.length){i+=s.margin}}var a=t-i;if(a>0&&r.length){var l=a/r.length;$.each(r,function(e,t){t.height+=l})}};o.adjustChildren=function(e,t){$.each(o.getChildrenProjections(e,t),function(e,t){var i=t.projections;if(i.length){var n=0;var r=0;$.each(i,function(e,t){if(t.height>n){n=t.height;r=e}});if(n===0){n=AGN.Lib.LB.Definitions.EMPTY_ROW_HEIGHT}$.each(i,function(e,t){t.adjusted=true;if(e!==r){t.height=n;o.adjustCascade(t.cascade)}});t.row.setHeight(n)}else{t.row.setHeight(AGN.Lib.LB.Definitions.EMPTY_ROW_HEIGHT)}})};AGN.Lib.LB.Adjustments=o})();(function(){function r(e){var t=this;var i=$.Deferred();var n=AGN.Lib.Template.dom("div-sandbox");this.promise=i.promise();this.watcher=new AGN.Lib.LB.PromiseProgressWatcher;this.$capsule=n;this.$content=r.stub();if(e.isContainerDeleted()){this.showIsDeleted()}n.find("iframe").on("load",function(){var e=$(this).contents().get(0);$(e.head).append(r.style());$(e.body).append(t.$content);t.watcher.bind(AGN.Lib.LB.Ui.imagesAdjusted(t.$content));i.resolveWith(t)});n.appendTo("#lb-childrens");AGN.Lib.LB.Child.set(n,e);this.controls=new AGN.Lib.LB.Controls(n)}r.stub=function(){return $('<div class="div-container"></div>')};r.css=function(){return $("#template-styles").html()};r.style=function(){return $("<style/>",{html:this.css()})};r.prototype.get$=function(){return this.$capsule};r.prototype.updateControls=function(){this.controls.update()};r.prototype.setControlsEnabled=function(e){this.controls.setEnabled(e)};r.prototype.ready=function(e){if(e!==undefined){this.promise.done(e)}return this.promise.state()==="resolved"};r.prototype.setLayeringIndex=function(e){this.controls.updateLayeringBtn(e)};r.prototype.pulse=function(){return this.watcher.promise()};r.prototype.embrace=function(e){var t=$(e).filter("*");if(this.ready()){this.$content.replaceWith(t);this.$content=t;var i=this.$capsule.outerWidth();if(i>0){this.setSize(i,"auto")}this.watcher.bind(AGN.Lib.LB.Ui.imagesAdjusted(t,true))}else{this.$content=t}};r.prototype.recycle=function(){var t=this;this.setShown(false);this.ready(function(){var e=r.stub();t.watcher.bind(false);t.$content.replaceWith(e);t.$content=e})};r.prototype.getZ=function(){return this.$capsule.css("z-index")};r.prototype.setZ=function(e){this.$capsule.css("z-index",e)};r.prototype.setShown=function(e){AGN.Lib.LB.Ui.setShown(this.$capsule,e)};r.prototype.setBorderHighlighted=function(e){this.$capsule.toggleClass("highlight-border",e)};r.prototype.setHighlighted=function(e){this.$capsule.toggleClass("highlighted",e)};r.prototype.setCoordinates=function(e){this.$capsule.offset(e)};r.prototype.setSize=function(e,t){if(!AGN.Lib.LB.Definitions.IS_BASIC_LB){this.$content.outerWidth(e)}this.$capsule.outerWidth(e);if(this.ready()){this.$content.style("width",function(e){return e},"important");this.$content.style("height","auto","important");if(t==="auto"){t=this.$content.outerHeight()}this.$capsule.outerHeight(t)}else{if(t==="auto"){this.$capsule.outerHeight(AGN.Lib.LB.Definitions.EMPTY_ROW_HEIGHT)}else{this.$capsule.outerHeight(t)}}};r.prototype.adjustHeight=function(e){this.$capsule.outerHeight(e)};r.prototype.getHeight=function(){if(this.ready()){return AGN.Lib.LB.Ui.getHeightAccurate(this.$content)}else{return AGN.Lib.LB.Definitions.EMPTY_ROW_HEIGHT}};r.prototype.setResizingEnabled=function(e){if(e){this.$capsule.css("box-sizing","content-box");this.$capsule.css("opacity",.4);this.$content.style("width","100%","important");this.$content.style("height","100%","important")}else{this.$capsule.css("box-sizing","");this.$capsule.css("opacity","")}};r.prototype.showIsDeleted=function(){const e=this.$capsule.find(".div-sandbox-overlay");e.addClass("div--deleted");const i=$(`
        <div data-tooltip="${t("grid.container.deleted")}">
            <button type="button" class="btn btn-icon-sm btn-danger pe-none">
                <i class="icon icon-trash-alt"></i>
            </button>
        </div>
    `);AGN.Lib.Tooltip.create(i,AGN.Lib.Tooltip.options(i));e.append(i)};AGN.Lib.LB.Capsule=r})();(function(){function e(e){var t={};if(e){this.data=e.slice();this.data.forEach(function(e){t[e.id]=e.name})}else{this.data=[]}this.map=t}e.prototype.name=function(e){return this.map[e]};e.prototype.list=function(){return this.data.slice()};AGN.Lib.LB.Categories=e})();(function(){function s(e){var t={id:0,name:"",targetId:0,row:0,column:0,rows:1,columns:1,z:0,isTocItem:false,isRecycled:false,interestGroup:"",container:{id:0,name:"",isToc:false,isSortable:false,markup:[],content:{},tocItemPlaceholderId:0,type:"",filter:""},content:undefined};this.data=_.merge(t,e);if(this.data.content===undefined){this.data.content=_.clone(this.data.container.content)}this.capsule=new AGN.Lib.LB.Capsule(this);this.layeringIndex=AGN.Lib.LB.Definitions.DEFAULT_LAYERING_INDEX;this.callbacks={};var i=e.container.modeEdit;if(this.isContainerDeleted()||i===AGN.Lib.LB.Definitions.CONTAINER_TYPE.ANCHORED||i===AGN.Lib.LB.Definitions.CONTAINER_TYPE.FIXED_AND_ANCHORED){this.setDraggable(false);this.setResizable(false)}}s.get=function(e){return e.data("agn:child")};s.set=function(e,t){e.data("agn:child",t)};s.resolveAgnImageTags=function(e,i){return AGN.Lib.Helpers.replaceAgnTags(e,function(e,t){if(e.name==="agnIMAGE"&&e.attributes["name"]){if(!e.attributes["source"]||e.attributes["source"]==="mediapool"||e.attributes["source"]==="mediapoolbg"){return i.replace(":filename:",encodeURIComponent(e.attributes["name"]))}}return t})};s.render=function(e,i,n){var r="";e.forEach(function(t){switch(t.type){case AGN.Lib.LB.Definitions.MARKUP_SPAN.TEXT:if(t.value){r+=s.resolveAgnImageTags(t.value,n.imageByFilenameUriPattern)}else{r+=t.value}break;case AGN.Lib.LB.Definitions.MARKUP_SPAN.PLACEHOLDER:var e=i[t.id];if(t.markup){if(e){r+=s.render(t.markup,i,n)}}else{switch(t.placeholderType){case AGN.Lib.LB.Definitions.PLACEHOLDER.LABEL:case AGN.Lib.LB.Definitions.PLACEHOLDER.TEXT:case AGN.Lib.LB.Definitions.PLACEHOLDER.LINK:case AGN.Lib.LB.Definitions.PLACEHOLDER.COLOR:case AGN.Lib.LB.Definitions.PLACEHOLDER.SELECT:case AGN.Lib.LB.Definitions.PLACEHOLDER.CHECK:if(e){r+=$.trim(s.resolveAgnImageTags(e,n.imageByFilenameUriPattern))}break;case AGN.Lib.LB.Definitions.PLACEHOLDER.IMAGE_SRC:if(e){r+=$.trim(s.resolveAgnImageTags(e,n.imageByFilenameUriPattern))}else{r+=n.noImageLink}break;case AGN.Lib.LB.Definitions.PLACEHOLDER.IMAGE:r+=parseInt(e)>0?n.imageUriPattern.replace("{image-id}",e):n.noImageLink;break;default:console.error("Unknown placeholder type: "+t.placeholderType)}}break;case AGN.Lib.LB.Definitions.MARKUP_SPAN.TOC_AREA:n.toc.forEach(function(e){r+=s.render(t.markup,i,$.extend({tocItem:e},n))});break;case AGN.Lib.LB.Definitions.MARKUP_SPAN.TOC_PLACEHOLDER:switch(t.placeholderType){case AGN.Lib.LB.Definitions.TOC_PLACEHOLDER_TYPE_ID:r+=AGN.Lib.LB.Definitions.TOC_ID_PREFIX+n.tocItem.id;break;case AGN.Lib.LB.Definitions.TOC_PLACEHOLDER_TYPE_NAME:r+=n.tocItem.name;break;default:console.error("Unknown TOC placeholder type: "+t.placeholderType)}break;default:console.error("Unknown span type: "+t.type)}});return AGN.Lib.Helpers.escapeAgnTags(r)};s.collectPlaceholders=function(e,t,i,n,r){e.forEach(function(e){switch(e.type){case AGN.Lib.LB.Definitions.MARKUP_SPAN.PLACEHOLDER:if(!r||r.call(r,e)){if(n[e.id]===undefined){i.push({id:e.id,type:e.placeholderType,name:e.name,value:t[e.id],options:e.options,help:e.help});n[e.id]=true}}case AGN.Lib.LB.Definitions.MARKUP_SPAN.TOC_AREA:if(e.markup){s.collectPlaceholders(e.markup,t,i,n,r)}break}})};s.draggableOptions=function(){return{stack:"#lb-childrens .div-container",revert:"invalid",distance:20,cursor:"move",opacity:.4,start:function(){AGN.Lib.LB.Definitions.EDITOR.setChildrenControlsEnabled(false)},stop:function(){AGN.Lib.LB.Definitions.EDITOR.setChildrenControlsEnabled(true)}}};s.resizableOptions=function(n){var r=false;return{handles:"ne, se, sw, nw, w, n, e, s",autoHide:true,create:function(){r=new AGN.Lib.LB.Resizing(n,AGN.Lib.LB.Definitions.EDITOR.getGrid())},start:function(e,t){if(r===false){r=new AGN.Lib.LB.Resizing(n,AGN.Lib.LB.Definitions.EDITOR.getGrid())}var i=$(e.originalEvent.target);n.setControlsEnabled(false);n.capsule.setResizingEnabled(true);r.start(AGN.Lib.LB.Ui.getResizeHandleDirection(i))},stop:function(e,t){r.stop(t.size.width,t.size.height);n.capsule.setResizingEnabled(false);n.setControlsEnabled(true);n.checkHoverState();AGN.Lib.LB.Definitions.EDITOR.updateToc(false);AGN.Lib.LB.Definitions.EDITOR.adjust();AGN.Lib.LB.Definitions.EDITOR.setChanged(true)},resize:function(e,t){r.resize(t.size.width,t.size.height)}}};s.prototype.asSubmittable=function(){return{id:this.data.id,containerId:this.data.container.id,name:this.data.name,targetId:this.data.targetId,interestGroup:this.data.container.isSortable?this.data.interestGroup||"":"",type:this.data.container.type,filter:this.data.container.filter,row:this.data.row,column:this.data.column,rows:this.data.rows,columns:this.data.columns,content:$.extend({},this.data.content),isTocItem:this.data.isTocItem}};s.prototype.get$=function(){return this.capsule.get$()};s.prototype.getId=function(){return this.data.id};s.prototype.getName=function(){return this.data.name};s.prototype.getContainerName=function(){return this.data.container.name};s.prototype.setName=function(e){this.data.name=e||""};s.prototype.getContainerId=function(){return this.data.container.id};s.prototype.isRecycled=function(){return this.data.isRecycled};s.prototype.setRecycled=function(e){if(e){this.setShown(false);this.setRows(1);this.setColumns(1);this.capsule.recycle();this.data.isRecycled=true}else{this.data.isRecycled=false}};s.prototype.setLayeringIndex=function(e){this.layeringIndex=e;this.capsule.setLayeringIndex(e)};s.prototype.getLayeringIndex=function(e){return this.layeringIndex};s.prototype.setOnLayeringRotate=function(e){if(e){this.callbacks.onLayeringRotate=()=>e.call(this)}else{this.callbacks.onLayeringRotate=undefined}};s.prototype.rotateLayering=function(){if(this.callbacks.onLayeringRotate){this.callbacks.onLayeringRotate()}};s.prototype.isInArea=function(e){return!this.isNotInArea(e)};s.prototype.isNotInArea=function(e){var t=e.column,i=t+e.columns-1;var n=e.row,r=n+e.rows-1;var o=this.data.column;var s=o+this.data.columns-1;var a=this.data.row;var l=a+this.data.rows-1;return Math.max(o,s)<t||Math.min(o,s)>i||Math.max(a,l)<n||Math.min(a,l)>r};s.prototype.isMatching=function(e){if(e===AGN.Lib.LB.Definitions.ALL_ENTRIES||this.data.targetId===AGN.Lib.LB.Definitions.ALL_RECIPIENTS){return true}return this.data.targetId===e};s.prototype.isToc=function(){return this.data.container.isToc};s.prototype.modeEdit=function(){return this.data.container.modeEdit};s.prototype.isTocItem=function(){return this.data.isTocItem};s.prototype.setTocItem=function(e){this.data.isTocItem=!!e};s.prototype.isSortable=function(){return this.data.container.isSortable};s.prototype.getInterestGroup=function(){if(this.isSortable()){return this.data.interestGroup||""}else{return""}};s.prototype.setInterestGroup=function(e){if(this.isSortable()){this.data.interestGroup=e||""}else{this.data.interestGroup=""}};s.prototype.getTargetId=function(){return this.data.targetId};s.prototype.setTargetId=function(e){this.data.targetId=e>=0?e:AGN.Lib.LB.Definitions.ALL_RECIPIENTS;this.capsule.updateControls()};s.prototype.getRow=function(){return this.data.row};s.prototype.setRow=function(e){return this.data.row=e};s.prototype.getColumn=function(){return this.data.column};s.prototype.setColumn=function(e){this.data.column=e};s.prototype.getZ=function(){return this.capsule.getZ()};s.prototype.setZ=function(e){this.capsule.setZ(e)};s.prototype.getRows=function(){return this.data.rows};s.prototype.setRows=function(e){this.data.rows=e};s.prototype.getColumns=function(){return this.data.columns};s.prototype.setColumns=function(e){this.data.columns=e};s.prototype.getArea=function(){return AGN.Lib.LB.Grid.area(this.data.row,this.data.column,this.data.rows,this.data.columns)};s.prototype.setArea=function(e){this.setRow(e.row);this.setColumn(e.column);this.setRows(e.rows);this.setColumns(e.columns)};s.prototype.getHeight=function(){return this.capsule.getHeight()};s.prototype.setShown=function(e){this.capsule.setShown(e);if(!this.isContainerDeleted()){this.setDraggable(e);this.setResizable(e)}};s.prototype.setBorderHighlighted=function(e){this.capsule.setBorderHighlighted(e)};s.prototype.setHighlighted=function(e){this.capsule.setHighlighted(e)};s.prototype.setSize=function(e,t){this.capsule.setSize(e,t)};s.prototype.setCoordinates=function(e){this.capsule.setCoordinates(e)};s.prototype.setControlsEnabled=function(e){this.capsule.setControlsEnabled(e)};s.prototype.checkHoverState=function(){AGN.Lib.LB.Ui.checkHoverState(this.capsule.get$())};s.prototype.adjustSize=function(e,t){this.setSize(e.getWidthForSpans(this.getColumns()),t||"auto")};s.prototype.adjustHeight=function(e){this.capsule.adjustHeight(e)};s.prototype.adjustCoordinates=function(e){this.setCoordinates(e.getCoordinates(this.getRow(),this.getColumn()))};s.prototype.setDraggable=function(e){var t=this.capsule.get$();if(e){t.draggable(s.draggableOptions())}else{try{t.draggable("destroy")}catch(e){}}};s.prototype.setResizable=function(e){var t=this.capsule.get$();if(e){t.resizable(s.resizableOptions(this))}else{try{t.resizable("destroy")}catch(e){}}};s.prototype.getPlaceholders=function(t){var e=this.data.content;var i=[];var n={};var r=undefined;if(t){r=function(e){return e.placeholderType===t}}s.collectPlaceholders(this.data.container.markup,e,i,n,r);i.sort(function(e,t){return e.name.localeCompare(t.name)});return o(i)};s.prototype.getPlaceholder=function(t){const e=this.getPlaceholders();return e.find(e=>e.id==t)};s.prototype.setContent=function(e){$.extend(this.data.content,e)};s.prototype.asTocItem=function(){var t=this.data.container.tocItemPlaceholderId;if(t>0){var e=this.data.content;var i=[];var n={};function r(e){return e.id===t}s.collectPlaceholders(this.data.container.markup,e,i,n,r);if(i.length){var o=i[0];return{id:this.data.id,name:e[o.id]||"",placeholderName:o.name,isEnabled:this.data.isTocItem}}}return null};s.prototype.rebuild=function(e){this.capsule.embrace(s.render(this.data.container.markup,this.data.content,e))};s.prototype.pulse=function(){return this.capsule.pulse()};s.prototype.clone=function(){var e=new s(this.data);e.data.id=0;return e};s.prototype.isContainerDeleted=function(){return this.data.container.isDeleted};s.prototype.isRssTemplateChild=function(){return!!(this.data.container.type&&this.data.container.type.startsWith("rss:contentSourceId="))};s.prototype.isRssImportedChild=function(){const e="rss:import";return!!(this.data.container.type&&this.data.container.type.startsWith(e))||!!(this.data.type&&this.data.type.startsWith(e))};function o(i){const n=new Map(i.filter(function(e){return e.type===AGN.Lib.LB.Definitions.PLACEHOLDER.CHECK}).map(function(e){return[e.id,e.options.split(",").map(function(t){return i.find(function(e){return t==e.id})})]}));const t=Array.from(n.values()).flat();const r=[];i.filter(function(e){return!t.includes(e)}).forEach(function(e){r.push(e);if(e.type===AGN.Lib.LB.Definitions.PLACEHOLDER.CHECK){const t=n.get(e.id);t.forEach(function(e){r.push(e)})}});return r}AGN.Lib.LB.Child=s})();(function(){function s(e,t,i){this.$el=e;this.child=t;this.options=i;this._displayMediapoolImages();this._controlCheckPhChildrenVisibility();this._setupJsEditorChangeDetection(this.$el);this._updateImageSrcPreview=_.throttle(this._updateImageSrcPreview,300)}s.get=function(){return a().data("agn:child-editor")};s.init=function(e,t){const i=s.get();if(i&&!i._applySheduledChanges()){return}const n=AGN.Lib.Template.dom("div-editing-block",t);const r=AGN.Lib.Template.dom("child-targetgroup-dropdown",{targets:t.targets,targetId:e.getTargetId()});const o=a();o.find(".js-wysiwyg").each(function(){window.removeEditor($(this).attr("id"))});o.find(".tile-title").text(e.getContainerName());o.find(".tile-body").empty().append(n);o.find("> .tile-header .tile-controls").empty().removeClass("hidden").append(r);AGN.Lib.Controller.init(n);AGN.runAll(o);AGN.Lib.Form.get(o).initFields();o.data("agn:child-editor",new s(o,e,t))};s.prototype.updateImageSrc=function(e){const t=e.data("placeholder-id");const i=$.trim(e.val());this._updateImageSrcPreview(t,i)};s.prototype._updateImageSrcPreview=function(e,t){const i=$(`#preview-${e}`);if(i.attr("src")!==t){i.attr("src",this.options.resolveAgnImageTags(t)||this.options.noPreviewImageLink)}};s.prototype.updateImage=function(e,t){const i=e.data("placeholder-id");const n=e.prop("files");const r=$(`#content-${i}`);if(n&&n.length){const o=n[0];if(o.type==="image"||o.type.match("image/.*")){const s=new FileReader;if(t){const a=i.replace(this.options.mobileSuffix,"");const l=$(`#image-name-${a}`).text();AGN.Lib.Helpers.renameFile(o,this.options.mobileImagePrefix+l)}else{const c=this._buildMobilePlaceholder(i);this._toggleMobileImageBlockVisibility(c,true);this._updateImagePreview(c)}s.onload=e=>this._updateImagePreview(i,e.target.result,o.name,o.name);s.readAsDataURL(o)}else{AGN.Lib.Helpers.clearFormField(e);this._updateImagePreview(i)}}else{this._updateImagePreview(i)}r.val("")};s.prototype.syncImageCategories=function(e,i){const t=$(`#content-${e}`).val();const n=this._findPlaceholdersWithImage(t);n.forEach(e=>{const t=$(`#image-category-id-${e.id}`);t.val(i).trigger("change.select2")})};s.prototype._findPlaceholdersWithImage=function(t){return this.child.getPlaceholders(AGN.Lib.LB.Definitions.PLACEHOLDER.IMAGE).filter(e=>t==$(`#content-${e.id}`).val())};s.prototype._updateImagePreview=function(e,t,i,n){const r=$(`#preview-${e}`);const o=$(`#image-name-${e}`);if(r.attr("src")!==t){r.attr("src",t||this.options.noPreviewImageLink)}r.attr("title",n||"");o.text(i||"")};s.prototype._toggleMobileImageBlockVisibility=function(e,t){const i=$(`#image-block-${e}`);AGN.Lib.LB.Ui.setShown(i,t)};s.prototype.chooseImage=function(e){const t=$(`#file-${e}`);if(t.val()||String(e).endsWith(this.options.mobileSuffix)){t.trigger("click")}else{this.showMediapoolDialog(e)}};s.prototype.deleteImage=function(e,t){this._clearImageData(e);if(!t){const i=this._buildMobilePlaceholder(e);this._clearImageData(i);this._changeImageControlsState(i,false);this._toggleMobileImageBlockVisibility(i,false);this.savePlaceholder(e)}};s.prototype._clearImageData=function(e){const t=$(`#file-${e}`);const i=$(`#image-name-${e}`);const n=$(`#content-${e}`);const r=$(`#preview-${e}`);AGN.Lib.Helpers.clearFormField(t);i.text("");n.val("");r.attr("src",this.options.noPreviewImageLink)};s.prototype.showMediapoolDialog=function(n){AGN.Lib.Confirm.request(this.options.urls.MEDIAPOOL_IMAGE_PICK).done(e=>{this._updateMobileAlternative(e.id,n);let t=e.category.categoryId;const i=this._findPlaceholdersWithImage(e.id);if(i.length>0){t=$(`#image-category-id-${i[0].id}`).val()}$(`#content-${n}`).val(e.id);$(`#image-category-id-${n}`).val(t).trigger("change.select2");AGN.Lib.Helpers.clearFormField($(`#file-${n}`));this._updateImagePreview(n,e.src,e.fileName,e.title);this.savePlaceholder(n)})};s.prototype._updateMobileAlternative=function(e,t){const i=this._buildMobilePlaceholder(t);this._loadMobileAlternative(e).then(e=>{$(`#content-${i}`).val(e.id);this._updateImagePreview(i,e.src,e.name,e.title);this._changeImageControlsState(i,true)}).catch(()=>{this._updateImagePreview(i);this._changeImageControlsState(i,false)}).finally(()=>{AGN.Lib.Helpers.clearFormField($(`#file-${i}`));this._toggleMobileImageBlockVisibility(i,true)})};s.prototype._changeImageControlsState=function(e,t){const i=$(`#preview-${e}`);$(`#image-delete-button-${e}`).prop("disabled",t);$(`#choose-image-btn-${e}`).prop("disabled",t);i.toggleClass("clickable",!t);i.attr("data-action",t?"":"chooseImage")};s.prototype._loadMobileAlternative=function(i){return new Promise((t,e)=>{$.ajax({url:AGN.url(`/mediapool/content/images/mobile-alternative/${i}/load.action`),type:"GET",success:e=>t(e),error:()=>e(),statusCode:{404:()=>e()}})})};s.prototype._buildMobilePlaceholder=function(e){return e+this.options.mobileSuffix};s.prototype.updateChildTarget=function(e){AGN.Lib.LB.Definitions.EDITOR.setChildTarget(this.child,e)};s.prototype.updateChildInterestGroup=function(){const e=$("#is-interest-sortable").is(":checked")?$("#interest-group").val():"";this.child.setInterestGroup(e);AGN.Lib.LB.Definitions.EDITOR.setChanged(true)};s.prototype.updateToC=function(){const t={};$("input.js-is-toc-item").each(function(){const e=$(this);t[e.data("child-id")]=e.is(":checked")});AGN.Lib.LB.Definitions.EDITOR.updateTocItemsUsage(this.child,t)};s.prototype.setTocItem=function(e){AGN.Lib.LB.Definitions.EDITOR.setTocItem(this.child,e)};s.prototype._saveIfChanged=function(e){if(this._placeholderWasChanged(e)){return this.savePlaceholder(e)}return true};s.prototype._placeholderWasChanged=function(e){const t=this.child.getPlaceholder(e);if(!t){return false}const i=t.value;const n=this._readPlaceholderValue(e);return i!==n};s.prototype.savePlaceholder=function(i){const n=this.child.getPlaceholder(i);if(!this._validatePlaceholder(n)){return false}this._prepareDataBeforeSave(n).done(()=>{if(n.type===AGN.Lib.LB.Definitions.PLACEHOLDER.TEXT){const t=this._findCkEditor(i);if(t.exists()){AGN.Lib.Editor.get(t).val(t.val())}}const e=this._readPlaceholderValue(i,n.type);AGN.Lib.LB.Definitions.EDITOR.savePlaceholder(this.child,i,e)});return true};s.prototype._readPlaceholderValue=function(e,t){const i=$(`#content-${e}`);if(t===AGN.Lib.LB.Definitions.PLACEHOLDER.CHECK){return i.prop("checked")?"checked":""}return i.val()};s.prototype._prepareDataBeforeSave=function(e){const t=$.Deferred();if(e.type===AGN.Lib.LB.Definitions.PLACEHOLDER.IMAGE){this._updateImageCategory(e).then(()=>this._uploadImage(e)).done(()=>t.resolve())}else{t.resolve()}return t.promise()};s.prototype._updateImageCategory=function(e){const t=$.Deferred();const i=e.id;const n=parseInt($(`#content-${i}`).val());if(n>0){const r=$(`#image-category-id-${i}`).val();$.ajax(this.options.urls.MEDIAPOOL_SET_CATEGORIES,{type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({[n]:r})}).done(()=>t.resolve()).fail(()=>t.reject())}else{t.resolve()}return t.promise()};s.prototype._uploadImage=function(e){const t=$.Deferred();const n=[];const i=e.id;const r=this._buildMobilePlaceholder(i);const o=e=>{const t=$(`#file-${e}`).prop("files");if(t&&t.length){n.push({placeholderId:e,image:t[0],categoryId:$(`#image-category-id-${i}`).val()})}};o(i);o(r);if(!n.length){t.resolve()}else{const s=new FormData;n.forEach((e,t)=>{s.append(`images[${t}].file`,e.image);s.append(`images[${t}].fileName`,e.image.name);s.append(`images[${t}].title`,e.image.name);s.append(`images[${t}].categoryId`,e.categoryId)});$.ajax(this.options.urls.MEDIAPOOL_IMAGE,{type:"POST",dataType:"json",enctype:"multipart/form-data",processData:false,contentType:false,data:s}).done(e=>{AGN.Lib.JsonMessages(e.popups);if(e.data){e.data.forEach((e,t)=>{if(e>0){const i=n[t].placeholderId;$(`#content-${i}`).val(e);AGN.Lib.Helpers.clearFormField($(`#file-${i}`));if(i==r){this._changeImageControlsState(r,true)}}})}if(e.success===true){t.resolve()}else{t.reject()}}).fail(()=>t.reject())}return t.promise()};s.prototype._validatePlaceholder=function(e){if(e.type===AGN.Lib.LB.Definitions.PLACEHOLDER.CHECK||e.type===AGN.Lib.LB.Definitions.PLACEHOLDER.COLOR){return true}if(e.type===AGN.Lib.LB.Definitions.PLACEHOLDER.IMAGE){return this._validateImageCategory(e)&&this._validateImageFormats(e)}if(e.type===AGN.Lib.LB.Definitions.PLACEHOLDER.TEXT){this.updateCkEditorsValue(e.id)}return this._validateHtml(e)};s.prototype._validateHtml=function(e){const t=$(`#content-${e.id}`).val();if(!$.trim(t)){return true}let i=false;$.ajax({type:"POST",url:AGN.url(`/layoutbuilder/template/${AGN.Lib.LB.Definitions.EDITOR.getTemplateId()}/validateHtml.action`),contentType:"application/json",async:false,data:JSON.stringify({htmlPlaceholders:{[e.name]:t}})}).done(e=>{AGN.Lib.JsonMessages(e.popups,true);i=!!e.success});return i};s.prototype._validateImageCategory=function(e){const i=e.id;const n=$(`#image-category-id-${i}`);AGN.Lib.Form.cleanFieldFeedback$(n);if(n.val()>0){return true}const r=!!$(`#file-${i}`).val();const o=$(`#content-${i}`).val();if(r||parseInt(o)>0){AGN.Lib.Form.showFieldError$(n,t("error.grid.noCategorySelected"))}return false};s.prototype._validateImageFormats=function(e){const i=e=>{const t=e.match(/[^.\\/]\.([^.\\/]+)$/);if(t){const i=["GIF","JPG","JPEG","PNG","SVG","ICO"];return i.includes(t[1].toUpperCase())}return false};const n=e.id;const r=$(`#file-${n}`).val();const o=$(`#content-${n}`);AGN.Lib.Form.cleanFieldFeedback$(o);if(r&&!i(r)){AGN.Lib.Form.showFieldError$(o,t("grid.divchild.format.error"));return false}return true};s.prototype.updateCkEditorsValue=function(e){const t=this._findCkEditor(e);if(t.exists()){CKEDITOR.instances[t.attr("id")]?.updateElement()}};s.prototype._findCkEditor=function(e){return this.$el.find(`.js-wysiwyg[data-ph-id='${e}']`)};s.prototype._controlCheckPhChildrenVisibility=function(){this.child.getPlaceholders(AGN.Lib.LB.Definitions.PLACEHOLDER.CHECK).filter(e=>e).forEach(e=>{const t=$(`
            <div id="${e.id}-children" class="bordered-box-sm" data-show-by-checkbox="#content-${e.id}">
                <div class="row g-2"></div>
            </div>
        `);t.insertAfter($(`#content-${e.id}`).parent());e.options.split(",").forEach(e=>{t.find("> .row").append($(`.ph-${e}`))})});AGN.Lib.CoreInitializer.run("checkbox-hider",this.$el)};s.prototype._displayMediapoolImages=function(){const e=this.child.getPlaceholders(AGN.Lib.LB.Definitions.PLACEHOLDER.IMAGE);const t=e.map(e=>parseInt(e.value)).filter(e=>e>0);if(t.length<=0){return}$.ajax(this.options.urls.MEDIAPOOL_LOAD_ELEMENTS,{type:"POST",dataType:"json",traditional:true,contentType:"application/json",data:JSON.stringify(t)}).done(r=>{e.forEach(e=>{const t=parseInt(e.value);if(t>0){const i=r[t];$(`#image-category-id-${e.id}`).val(i.categoryId).trigger("change.select2");this._updateImagePreview(e.id,i.src,i.name,i.title);const n=this._buildMobilePlaceholder(e.id);if(i.mobileSrc){this._updateImagePreview(n,i.mobileSrc,i.mobileName,i.mobileTitle);this._changeImageControlsState(n,true)}this._toggleMobileImageBlockVisibility(n,true)}})})};s.prototype._setupJsEditorChangeDetection=function(e){const o=this;e.find(".js-editor").each(function(){const n=$(this);const r=n.attr("id");o._clearAutoSaveTimeout(n);const e=()=>{o._clearAutoSaveTimeout(n);const e=window.setTimeout(()=>{const e=n.data("ph-id");const t=o.child.getPlaceholder(e).value;const i=CKEDITOR.instances[r]?.getData()||n.val();if(t!==i){o.savePlaceholder(e,t)}},AGN.Lib.LB.Definitions.AUTOSAVE_INACITVE_INTERVAL);n.data("lb:autosave-timeoutId",e)};n.off("editor:change",e);n.on("editor:change",e);CKEDITOR.instances[r]?.on("change",e)})};s.prototype._clearAutoSaveTimeout=function(e){if(e.data("lb:autosave-timeoutId")){clearTimeout(e.data("lb:autosave-timeoutId"));e.data("lb:autosave-timeoutId",undefined)}};s.prototype._applySheduledChanges=function(){const i=this;let n=true;this.$el.find(".js-editor").each(function(){const e=$(this);i._clearAutoSaveTimeout(e);const t=i._saveIfChanged(e.data("ph-id"));if(n){n=t}});return n};s.prototype.notifyTabChanged=function(e){const t=e.closest(".tile");const i=t.find(".js-editor").data("ph-id");this._setupJsEditorChangeDetection(t);this._saveIfChanged(i)};s.prototype.get$=function(){return this.$el};function a(){return $("#div-child-edit-tile")}AGN.Lib.LB.ChildEditor=s})();(function(){function e(e){this.data=$.extend({id:0,name:"",isToc:false,markup:[],content:{}},e)}e.draggableOptions=function(){return{stack:"#lb-childrens .div-container",revert:"invalid",distance:20,helper:"clone",appendTo:"#page-wrapper",containment:"window",zIndex:AGN.Lib.LB.Definitions.TOP_Z,refreshPositions:true,start:function(e,t){t.helper.width($(this).width());AGN.Lib.LB.Definitions.EDITOR.setChildrenControlsEnabled(false)},stop:function(e,t){t.helper.width("auto");AGN.Lib.LB.Definitions.EDITOR.setChildrenControlsEnabled(true);AGN.Lib.LB.Definitions.EDITOR.clearEmptyAddedOnTheFlyRows()},drag:function(e,t){AGN.Lib.LB.Definitions.EDITOR.processAddedOnTheFlyRows(e)}}};e.prototype.getContainerId=function(){return this.data.id};e.prototype.getRows=function(){return 1};e.prototype.getColumns=function(){return 1};e.prototype.isToc=function(){return this.data.isToc};e.prototype.instantiate=function(){return new AGN.Lib.LB.Child({name:this.data.name,container:this.data})};AGN.Lib.LB.ChildSample=e})();(function(){function t(e){if(e[0]instanceof AGN.Lib.LB.Child){this.children=e.slice()}else{this.children=e.sort(function(e,t){if(e.z===t.z){if(e.columns===t.columns){return e.column-t.column}return t.columns-e.columns}return e.z-t.z}).map(function(e){return new AGN.Lib.LB.Child(e)})}}t.make=function(e){return new t(e||[])};t.prototype.get=function(){return this.children.slice()};t.prototype.size=function(){return this.children.length};t.prototype.each=function(e){this.children.forEach(e)};t.prototype.sort=function(e){this.children.sort(e)};t.prototype.contains=function(e){return this.children.indexOf(e)>=0};t.prototype.containsToc=function(){for(var e=0;e<this.children.length;e++){if(this.children[e].isToc()){return true}}return false};t.prototype.matching=function(t){return this.select(function(e){return e.isMatching(t)})};t.prototype.unmatching=function(t){return this.select(function(e){return!e.isMatching(t)})};t.prototype.containsRssChildren=function(){return this.active().children.some(function(e){return e.isRssImportedChild()||e.isRssTemplateChild()})};t.prototype.active=function(){return this.select(function(e){return!e.isRecycled()})};t.prototype.recycled=function(){return this.select(function(e){return e.isRecycled()})};t.prototype.select=function(e){return new t(this.children.filter(e))};t.prototype.removeChilds=function(t){this.children=this.children.filter(e=>!t.includes(e))};t.prototype.add=function(e){e.setZ(this.active().calculateMaxZ()+1);this.children.push(e)};t.prototype.groupsMap=function(){var o={};var e=_.groupBy(this.children,function(e){return e.getRow()});$.each(e,function(n,e){var r={};e.forEach(function(e){var t=e.getColumns();if(t>1){var i=e.getColumn();for(var n=1;n<t;n++){r[i+n]=i}}});e.forEach(function(e){var t=e.getColumn();while(r[t]){t=r[t]}var i=n+":"+t;if(o[i]===undefined){o[i]=[]}o[i].push(e)})});return o};t.prototype.groups=function(){var i=[];var e=this.groupsMap();$.each(e,function(e,t){if(t.length){i.push(t)}});return i};t.prototype.collectTargetIds=function(){var t={};this.each(function(e){t[e.getTargetId()]=true});return Object.keys(t).sort()};t.prototype.calculateMaxZ=function(){return this.children.reduce(function(e,t){return Math.max(t.getZ(),e)},0)};t.prototype.calculateRowsCount=function(){return this.children.reduce(function(e,t){return Math.max(t.getRow()+t.getRows()-1,e)},0)};t.prototype.setShown=function(i){this.children.forEach(function(e){e.setShown(i);var t=e.data.container.modeEdit;if(t===AGN.Lib.LB.Definitions.CONTAINER_TYPE.ANCHORED||t===AGN.Lib.LB.Definitions.CONTAINER_TYPE.FIXED_AND_ANCHORED){e.setDraggable(false);e.setResizable(false)}})};t.prototype.setBorderHighlighted=function(t){this.children.forEach(function(e){e.setBorderHighlighted(t)})};t.prototype.setHighlighted=function(t){this.children.forEach(function(e){e.setHighlighted(t)})};t.prototype.setControlsEnabled=function(t){this.children.forEach(function(e){e.setControlsEnabled(t);if(!e.isContainerDeleted()){e.setResizable(t)}e.checkHoverState()})};t.prototype.asTocItems=function(e){var t;if(e){t=_.map(this.groupsMap(),function(e){return _.maxBy(e,function(e){return e.getZ()})})}else{t=this.children.slice()}var i=t.sort(function(e,t){if(e.getRow()===t.getRow()){if(e.getColumn()===t.getColumn()){return t.getZ()-e.getZ()}return e.getColumn()-t.getColumn()}return e.getRow()-t.getRow()}).map(function(e){return e.asTocItem()}).filter(function(e){return!!e});if(e){return i.filter(function(e){return e.isEnabled})}return i};t.prototype.pulse=function(){var e=this.children.map(function(e){return e.pulse()});return e};t.prototype.rebuildStatic=function(t){this.each(function(e){if(!e.isToc()){e.rebuild(t)}})};t.prototype.rebuildToc=function(t){let i=false;this.each(e=>{if(e.isToc()){e.rebuild($.extend({},t,{toc:this.asTocItems(true)}));i=true}});return i};t.prototype.rotateLayering=function(){const e=this.children.slice().sort((e,t)=>e.getZ()-t.getZ());const i=e.map(e=>e.getZ());e.forEach((e,t)=>{e.setShown(t===1);e.setZ(i[(t+1)%i.length])})};t.prototype.setLayeringByTargets=function(t){const e=this.children.slice().sort((e,t)=>t.getZ()-e.getZ());const i=e.map(e=>e.getZ());_.sortBy(e,e=>t.indexOf(e.getTargetId())).forEach((e,t)=>{e.setShown(t===0);e.setZ(i[t])})};t.prototype.stick=function(t){this.children.forEach(function(e){if(e.isInArea(t)){e.setArea(t)}})};t.prototype.adjustLayering=function(){let t=this.children.length;this.children.forEach(e=>e.setZ(--t))};t.prototype.adjustSizes=function(t){this.children.forEach(function(e){e.adjustSize(t)})};t.prototype.adjustCoordinates=function(t){this.children.forEach(function(e){e.adjustCoordinates(t)})};AGN.Lib.LB.Children=t})();(function(){function e(e){this.$capsule=e;this.child=AGN.Lib.LB.Child.get(e);this.factory=new AGN.Lib.LB.ControlsFactory(this.child);this.timeoutId=null;this.state=AGN.Lib.LB.Definitions.CONTROLS_STATE.HIDDEN;this.update();e.on("mouseenter",()=>this.show());e.on("mouseleave",()=>this.hide())}e.popoverOptions=function(e){return{trigger:"manual",html:true,content:function(){return e.getPopoverContent()}}};e.prototype.stopHiding=function(){if(this.timeoutId){clearTimeout(this.timeoutId);this.timeoutId=undefined;return true}return false};e.prototype.popoverShow=function(e=true){if(!this.stopHiding()){this.popover.show();if(e){const t=$(this.popover.tip);t.on("mouseenter",()=>this.popoverShow(false));t.on("mouseleave",()=>this.popoverHide())}}this.state=AGN.Lib.LB.Definitions.CONTROLS_STATE.POPOVER};e.prototype.popoverHide=function(e){this.stopHiding();if(e===true){this.popover.hide();this.state=AGN.Lib.LB.Definitions.CONTROLS_STATE.HIDDEN}else{var t=this;this.timeoutId=setTimeout(function(){t.popoverHide(true)},200)}};e.prototype.inlineShow=function(){this.$inlineControls.css("display","flex");this.state=AGN.Lib.LB.Definitions.CONTROLS_STATE.INLINE};e.prototype.inlineHide=function(){this.$inlineControls.hide();this.state=AGN.Lib.LB.Definitions.CONTROLS_STATE.HIDDEN};e.prototype.show=function(){if(this.state===AGN.Lib.LB.Definitions.CONTROLS_STATE.DISABLED){return}this.$inlineControls.css("bottom","");if(this.$inlineControls.height()<=this.$capsule.height()){this.$inlineControls.css("bottom",0);if(this.state===AGN.Lib.LB.Definitions.CONTROLS_STATE.POPOVER){this.popoverHide(true)}this.inlineShow()}else{if(this.state===AGN.Lib.LB.Definitions.CONTROLS_STATE.INLINE){this.inlineHide()}this.popoverShow()}};e.prototype.hide=function(e){switch(this.state){case AGN.Lib.LB.Definitions.CONTROLS_STATE.INLINE:this.inlineHide();break;case AGN.Lib.LB.Definitions.CONTROLS_STATE.POPOVER:this.popoverHide(e);break}};e.prototype.setEnabled=function(e){if(e){if(this.state===AGN.Lib.LB.Definitions.CONTROLS_STATE.DISABLED){this.state=AGN.Lib.LB.Definitions.CONTROLS_STATE.HIDDEN}}else{this.hide(true);this.state=AGN.Lib.LB.Definitions.CONTROLS_STATE.DISABLED}};e.prototype.update=function(){if(this.$inlineControls){this.$inlineControls.remove()}this.$inlineControls=this.factory.createInlineControls();this.$capsule.append(this.$inlineControls);if(this.popover){AGN.Lib.Popover.remove(this.$capsule)}if(this.$popoverControls){this.$popoverControls=undefined}this.popover=AGN.Lib.Popover.new(this.$capsule,e.popoverOptions(this));if(this.state===AGN.Lib.LB.Definitions.CONTROLS_STATE.INLINE||this.state===AGN.Lib.LB.Definitions.CONTROLS_STATE.POPOVER){this.show()}};e.prototype.getPopoverContent=function(){if(this.$popoverControls===undefined){this.$popoverControls=this.factory.createPopoverControls();var e=this.$popoverControls.find("[data-action]");AGN.Lib.LB.Child.set(e,this.child);var t=this;e.on("click",function(){t.popoverHide(true)})}this._updateLayeringBtn(this.child.getLayeringIndex(),this.$popoverControls);var i=this.$popoverControls.clone(true);AGN.runAll(i);return i};e.prototype.updateLayeringBtn=function(e){this._updateLayeringBtn(e,this.$inlineControls);this._updateLayeringBtn(e,this.$popoverControls)};e.prototype._updateLayeringBtn=function(e,t){if(!t){return}const i=t.find(".lb-layering-btn");if(e>0){i.find(".layer-number").text(e);i.off("click");i.on("click",()=>{this.child.rotateLayering();this.hide()})}i.toggleClass("hidden",e<=0)};e.prototype.remove=function(){this.state=AGN.Lib.LB.Definitions.CONTROLS_STATE.DISABLED;this.stopHiding();this.popover.destroy();this.$popoverControls=undefined;this.$inlineControls.remove();this.$inlineControls=undefined};AGN.Lib.LB.Controls=e})();(function(){function e(e){this.child=e}e.prototype.getOptions=function(){return{targetName:AGN.Lib.LB.Definitions.EDITOR.getTargetName(this.child.getTargetId()),isToc:this.child.isToc(),containerDeleted:this.child.isContainerDeleted(),containerModeEdit:this.child.modeEdit()}};e.prototype.createControls=function(e){var t=AGN.Lib.Template.dom(e,this.getOptions());AGN.Lib.LB.Child.set(t.find("[data-action]"),this.child);AGN.runAll(t);return t};e.prototype.createInlineControls=function(){return this.createControls("child-controls")};e.prototype.createPopoverControls=function(){return this.createControls("child-popover-controls")};AGN.Lib.LB.ControlsFactory=e})();(function(){AGN.Lib.LB.Definitions={EDITOR:null,IS_BASIC_LB:false,EMPTY_ROW_HEIGHT:80,COLLAPSED_BLOCK_SIZE:10,ALL_ENTRIES:-1,ALL_RECIPIENTS:0,DEFAULT_LAYERING_INDEX:-1,TOP_Z:500,UNCOLLAPSIBLE_GUTTER_SIZE:2,AUTOSAVE_INACITVE_INTERVAL:2e3,CONTROLS_STATE:{DISABLED:0,HIDDEN:1,POPOVER:2,INLINE:3},MARKUP_SPAN:{TEXT:"Text",PLACEHOLDER:"Placeholder",TOC_AREA:"TocArea",TOC_PLACEHOLDER:"TocPlaceholder"},PLACEHOLDER:{LABEL:"Label",TEXT:"Text",LINK:"Link",IMAGE:"Image",IMAGE_SRC:"ImageLink",SELECT:"Select",COLOR:"Color",CHECK:"Check"},TOC_PLACEHOLDER_TYPE_ID:"Id",TOC_PLACEHOLDER_TYPE_NAME:"Name",TOC_ID_PREFIX:"toc_",DIRECTION:{NONE:"",EAST:"e",WEST:"w",NORTH:"n",SOUTH:"s"},CONTAINER_TYPE:{EDITABLE:0,ANCHORED:2,FIXED_AND_ANCHORED:3}}})();(function(){function t(e){this.$droppable=AGN.Lib.Template.dom("droppable");this.$droppable.data("agn:droppable",this);this.$droppable.droppable(t.options(this));this.row=e;this.callbacks={}}t.get=function(e){return e.data("agn:droppable")};t.options=function(i){return{accept:"[data-building-block]",tolerance:"pointer",deactivate:function(){i.setHovered(false);if(i.callbacks.onHoverChange){i.callbacks.onHoverChange(false)}},drop:function(e,t){i.setHovered(false);if(i.callbacks.onDrop){i.callbacks.onDrop(AGN.Lib.LB.Child.get(t.draggable))}i.row.isEmptyRowAddedOnTheFly=false},over:function(e,t){if(i.callbacks.onHoverChange){i.callbacks.onHoverChange(AGN.Lib.LB.Child.get(t.draggable),true)}else{i.setHovered(true)}},out:function(e,t){if(i.callbacks.onHoverChange){i.callbacks.onHoverChange(AGN.Lib.LB.Child.get(t.draggable),false)}else{i.setHovered(false)}}}};t.prototype.get$=function(){return this.$droppable};t.prototype.getCoordinates=function(){return this.$droppable.offset()};t.prototype.getRow=function(){return this.row};t.prototype.getHeight=function(){return AGN.Lib.LB.Ui.getHeightAccurate(this.$droppable)};t.prototype.setHeight=function(e){this.$droppable.outerHeight(e)};t.prototype.setHovered=function(e){if(e){this.$droppable.addClass("container-hover-accept")}else{this.$droppable.removeClass("container-hover-accept")}};t.prototype.remove=function(){this.$droppable.droppable("destroy");this.$droppable.remove();this.callbacks.onDrop=undefined;this.callbacks.onHoverChange=undefined};t.prototype.setOnDrop=function(t){var i=this;this.callbacks.onDrop=function(e){t.call(i,e)}};t.prototype.setOnHoverChange=function(i){var n=this;this.callbacks.onHoverChange=function(e,t){i.call(n,e,t)}};AGN.Lib.LB.Droppable=t})();(function(){function e(){this.templateId=0;this.targetId=AGN.Lib.LB.Definitions.ALL_ENTRIES;this.targets=new AGN.Lib.LB.Targets;this.categories=new AGN.Lib.LB.Categories;this.children=new AGN.Lib.LB.Children([]);this.imageUriPattern="{image-id}";this.imageByFilenameUriPattern=":filename:";this.watcher=new AGN.Lib.LB.PromiseProgressWatcher;this.removedChildren=[];this.adjust=_.throttle(this.adjust,200);this.watcher.promise().progress(()=>this.adjust(false))}e.prototype.setup=function(e){e=$.extend({templateId:0,targetId:AGN.Lib.LB.Definitions.ALL_ENTRIES,grid:{},children:[],imageUriPattern:"{image-id}",imageByFilenameUriPattern:":filename:",noPreviewImageLink:"#",mobileImagePrefix:"mobile_",isTextVersionGenerationAllowed:false,isEmptyTextVersion:false,targets:[],interestGroups:[],categories:[],translations:{},urls:{},actions:{}},e);$.i18n.load(e.translations);this.changesNotSaved=false;this.templateId=e.templateId;this.targetId=e.targetId;this.imageUriPattern=e.imageUriPattern;this.imageByFilenameUriPattern=e.imageByFilenameUriPattern;this.noPreviewImageLink=e.noPreviewImageLink;this.textVersionGenerationAllowed=e.isTextVersionGenerationAllowed;this.emptyTextVersion=e.isEmptyTextVersion;this.noImageLink=e.noImageLink;this.targets=new AGN.Lib.LB.Targets(e.targets);this.interestGroups=e.interestGroups;this.categories=new AGN.Lib.LB.Categories(e.categories);this.children=new AGN.Lib.LB.Children(e.children);this.urls=e.urls;this.actions=e.actions;this.mailingId=e.mailingId;this.mobileSuffix="-mobile";this.mobileImagePrefix=e.mobileImagePrefix;var t=this.children.active();this.grid=new AGN.Lib.LB.Grid(e.grid,Math.max(1,t.calculateRowsCount()));t.rebuildStatic({imageUriPattern:this.imageUriPattern,imageByFilenameUriPattern:this.imageByFilenameUriPattern,noImageLink:this.noImageLink});t.adjustLayering();this.updateAvailableTargets();if(this.mailingId>0){this.editable=AGN.Opt.Components.MailingContentLock.manageLock(this.mailingId,e.isMailingExclusiveLockingAcquired,e.anotherLockingUserName)}else{this.editable=true}AGN.Lib.LB.Ui.setTargetId(this.targetId);this.setTargetId(this.targetId);if(this.editable){this.setupInteractions();this.updateRecycleBin();this.restoreUpdateTextVersionCheckbox(e.mailingId);AGN.Lib.LB.Ui.setLoading(false)}else{t.each(function(e){e.setDraggable(false);e.setControlsEnabled(false);e.setResizable(false)});AGN.Lib.LB.Ui.setLoading(false);AGN.Lib.LB.Ui.setEditable(false)}};e.prototype.restoreUpdateTextVersionCheckbox=function(){$("#update-text-version").attr("checked",this.getMadeChoice())};e.prototype.setupInteractions=function(){var s=this;this.children.recycled().each(function(e){e.setRows(1);e.setColumns(1)});function t(t,i){s.children.active().matching(s.targetId).each(function(e){if(e!==t){e.setControlsEnabled(i);if(!e.isContainerDeleted()){e.setResizable(i)}if(e.data.container.modeEdit===AGN.Lib.LB.Definitions.CONTAINER_TYPE.ANCHORED||e.data.container.modeEdit===AGN.Lib.LB.Definitions.CONTAINER_TYPE.FIXED_AND_ANCHORED){e.setResizable(false)}}})}this.grid.setOnResizingStarted(function(e){t(e,false)});this.grid.setOnResizingStopped(function(e){t(e,true);s.children.active().stick(e.getArea())});var e=null;this.grid.setOnAreaHovered(function(t){var i=s.children.active().matching(s.targetId);if(t){i=i.select(function(e){return e.isInArea(t)});if(e){e.each(function(e){if(!i.contains(e)){e.setHighlighted(false)}})}i.setHighlighted(true);e=i}else{i.setHighlighted(false);e=null}});this.grid.setOnDrop(function(e,t,i){var n=s.children.active();var r=false;if(!n.contains(e)){r=true;if(e instanceof AGN.Lib.LB.ChildSample){e=e.instantiate();s.children.add(e)}else if(e.isRecycled()){e.setRecycled(false);s.updateRecycleBin()}else{e=e.clone();s.children.add(e)}if(s.targetId!==AGN.Lib.LB.Definitions.ALL_ENTRIES){e.setTargetId(s.targetId)}n=s.children.active();if(!e.isToc()){e.rebuild({imageUriPattern:s.imageUriPattern,imageByFilenameUriPattern:s.imageByFilenameUriPattern,noImageLink:s.noImageLink})}}e.setArea(i);n.active().stick(i);n.matching(s.targetId).rebuildToc({imageUriPattern:this.imageUriPattern,imageByFilenameUriPattern:this.imageByFilenameUriPattern,noImageLink:this.noImageLink});e.adjustSize(s.grid);e.adjustCoordinates(s.grid);if(r){var o=e.data.container.modeEdit;e.setShown(true);if(o===AGN.Lib.LB.Definitions.CONTAINER_TYPE.ANCHORED||o===AGN.Lib.LB.Definitions.CONTAINER_TYPE.FIXED_AND_ANCHORED){e.setDraggable(false);e.setResizable(false)}s.adjust();s.watcher.bind(n.matching(s.targetId).pulse())}else{s.adjust()}s.updateAvailableTargets();s.setChanged(true)});$("#lb-childrens").on("click","[data-building-block]",function(e){var t=$(e.target);if(t.is("button")||t.is(".ui-resizable-handle")||t.closest("button").exists()){return}var i=$(this);var n=AGN.Lib.LB.Child.get(i);var r=n.data.container.modeEdit;if(n){if(r===AGN.Lib.LB.Definitions.CONTAINER_TYPE.EDITABLE||r===AGN.Lib.LB.Definitions.CONTAINER_TYPE.ANCHORED){AGN.Lib.LB.Definitions.EDITOR.editChild(n)}}})};e.prototype.updateAvailableTargets=function(){var e=this.children.active();var t=this.targets;var i=e.collectTargetIds();var o=[];e.groups().forEach(function(e){var i={};e.sort(function(e,t){return e.getZ()-t.getZ()}).forEach(function(e,t){i[e.getTargetId()]=t});o.push(i)});i.sort(function(i,n){var r=0;o.forEach(function(e){if(i in e&&n in e){var t=e[i]-e[n];if(t<0){r++}else if(t>0){r--}}});return r});AGN.Lib.LB.Ui.setAvailableTargetIds(i.map(function(e){return{id:e,name:t.name(e)}}));if(i.indexOf(String(this.targetId))<0){this.targetId=AGN.Lib.LB.Definitions.ALL_ENTRIES}AGN.Lib.LB.Ui.setTargetId(this.targetId)};e.prototype.getTemplateId=function(){return this.templateId};e.prototype.isTextVersionGenerationAllowed=function(){return this.textVersionGenerationAllowed};e.prototype.saveMadeChoice=function(e){AGN.Lib.WebStorage.set("updateTextVersion_"+this.mailingId,e)};e.prototype.getMadeChoice=function(){return AGN.Lib.WebStorage.get("updateTextVersion_"+this.mailingId)};e.prototype.isEmptyTextVersion=function(){return this.emptyTextVersion};e.prototype.isChanged=function(){return this.changesNotSaved};e.prototype.isEditable=function(){return this.editable};e.prototype.setChanged=function(e){if(!!e){this.controlRssBtn()}this.changesNotSaved=!!e};e.prototype.getGrid=function(){return this.grid};e.prototype.getTargetName=function(e){return this.targets.name(e)};e.prototype.setTargetId=function(e){var t=this.children.active();this.targetId=e;t.unmatching(this.targetId).setShown(false);t=t.matching(this.targetId);t.rebuildToc({imageUriPattern:this.imageUriPattern,imageByFilenameUriPattern:this.imageByFilenameUriPattern,noImageLink:this.noImageLink});t.setShown(true);this.adjust();this.watcher.bind(t.pulse())};e.prototype.setLayeringByTargets=function(t){let i=false;this.children.active().groups().forEach(e=>{if(e.length>1){AGN.Lib.LB.Children.make(e).setLayeringByTargets(t);i=true}});if(i){this.updateToc(true)}this.setChanged(true);this.adjust(false)};e.prototype.setChildrenControlsEnabled=function(e){this.children.active().matching(this.targetId).setControlsEnabled(e)};e.prototype.updateToc=function(e){var t=this.children.active().matching(this.targetId);if(t.rebuildToc({imageUriPattern:this.imageUriPattern,imageByFilenameUriPattern:this.imageByFilenameUriPattern,noImageLink:this.noImageLink})&&e){this.adjustSizes(t);this.adjustCoordinates(t)}};e.prototype.adjustSizes=function(e){if(e===undefined){e=this.children.active().matching(this.targetId)}e.adjustSizes(this.grid);this.grid.adjustRows(e)};e.prototype.adjustCoordinates=function(e){if(e===undefined){e=this.children.active().matching(this.targetId)}this.grid.adjustSidebar();e.adjustCoordinates(this.grid)};e.prototype.adjustLayering=function(e){var o=this;if(e===undefined){e=this.children.active().matching(this.targetId)}var s=e.groupsMap();this.grid.each(function(e,r){e.each(function(e,t){var i=r+1+":"+(t+1);var n=AGN.Lib.LB.Children.make(s[i]);if(n.size()>1){n.setBorderHighlighted(true);n.each((e,t)=>{e.setShown(t===0);e.setLayeringIndex(t+1);e.setOnLayeringRotate(()=>{o.setChanged(true);n.rotateLayering();o.updateToc(true);o.adjust(false)})})}else{n.setBorderHighlighted(false);n.each(e=>{e.setShown(true);e.setLayeringIndex(AGN.Lib.LB.Definitions.DEFAULT_LAYERING_INDEX);e.setOnLayeringRotate(null)});o.adjust(false)}})})};e.prototype.adjust=function(e){const t=this.children.active().matching(this.targetId);if(e!==false){this.adjustLayering(t)}this.adjustSizes(t);this.adjustCoordinates(t)};e.prototype.addRowBefore=function(e,t){var r=this.grid.addRowBefore(e);var i=this.children.active();var o=false;i.each(function(e){var t=e.getRows();var i=e.getRow();var n=i+t-1;if(r<=i){e.setRow(i+1)}else if(r>i&&r<=n){o=true;e.setRows(t+1)}});if(t!==false){if(o){this.adjust()}else{this.adjustCoordinates(i.matching(this.targetId))}}this.setChanged(true)};e.prototype.addRowAfter=function(e){if(!this.isEditable()){return}if(this.grid.rows.indexOf(e)==this.grid.getRows()-1){this.addRow()}else{const t=this.grid.rows.indexOf(e);this.addRowBefore(this.grid.rows[t+1])}};e.prototype.addRow=function(e){this.grid.addRow();if(e!==false){this.grid.adjustSidebar()}this.setChanged(true)};e.prototype.removeRow=function(e){var r=this.grid.removeRow(e);var t=this.children.active();var o=false;var s=false;t.each(function(e){var t=e.getRows();var i=e.getRow();var n=i+t-1;if(r>=i&&r<=n){if(t>1){e.setRows(t-1);s=true}else{e.setRecycled(true);o=true}}else if(r<i){e.setRow(i-1)}});if(o){t=this.children.active().matching(this.targetId);t.rebuildToc({imageUriPattern:this.imageUriPattern,imageByFilenameUriPattern:this.imageByFilenameUriPattern,noImageLink:this.noImageLink});this.adjust();this.watcher.bind(t.pulse());this.updateAvailableTargets();this.updateRecycleBin()}else if(s){this.adjust()}else{this.adjustCoordinates()}this.setChanged(true)};e.prototype.removeChild=function(e){if(this.children.contains(e)){e.setRecycled(true);this.updateToc(false);this.adjust();this.updateAvailableTargets();this.updateRecycleBin();this.setChanged(true)}};e.prototype.cloneChild=function(e){var i=this;var c=this.grid.getColumns();var t=this.children.active();function l(e,r,o){var s=[];var a={};e.each(function(e){var t=e.getColumn();if(r===e.getRow()&&t>=o){s.push(e);var i=e.getColumns();a[t]=Math.min(a[t]||t,t);for(var n=1;n<i;n++){a[t+n]=t}}});var t=_.groupBy(s,function(e){var t=e.getColumn();while(a[t]&&a[t]!==t){t=a[t]}return t});var i=[];for(var n=o;n<=c;n++){if(a[n]){var l=t[n];if(l){i.push(l)}}else{i.push([])}}return i}function u(e){var t=0;e.forEach(function(e){if(e.length===0){t++}});return t}function d(e,t){function i(e,i){var n=null,r=null;e.forEach(function(e){var t=e.getColumn();var i=t+e.getColumns()-1;n=Math.min(n||t,t);r=Math.max(r||i,i)});var t=0;if(r+i>c){t=c+1-n-i;i=i+t}e.forEach(function(e){var t=e.getColumn()+i;if(t>c){e.setRow(e.getRow()+1);e.setColumn(t-c)}else{e.setColumn(t)}});return t}for(var n=0;n<e.length&&t>0;n++){var r=e[n];if(r.length>0){t+=i(r,t)}else{t--}}}function h(e){var t=i.grid.getRow(e);if(t){i.addRowBefore(t,false)}else{i.addRow(false)}}function n(e,t,i){var n=t.getRow();var r=t.getColumns();var o=t.getColumn()+r;var s=l(e,n,o);var a=c-o+1;if(a>=r){if(u(s)>=r){d(s,r)}else{h(n+1);d(s,r)}i.setRow(n);i.setColumn(o)}else{h(n+1);d(s,a+r);i.setRow(n+1);i.setColumn(1)}}var r=e.clone();n(t,e,r);r.rebuild({imageUriPattern:this.imageUriPattern,imageByFilenameUriPattern:this.imageByFilenameUriPattern,noImageLink:this.noImageLink});r.setShown(true);this.children.add(r);this.updateToc(false);this.watcher.bind(this.children.active().matching(this.targetId).pulse());this.adjust();this.setChanged(true);return r};e.prototype.replaceChildren=function(e,t){this.removeChild(e);t.setRow(e.getRow());t.setColumn(e.getColumn());t.rebuild({imageUriPattern:this.imageUriPattern,imageByFilenameUriPattern:this.imageByFilenameUriPattern,noImageLink:this.noImageLink});t.setShown(true);this.children.add(t);this.updateToc(false);this.watcher.bind(this.children.active().matching(this.targetId).pulse());this.adjust();this.setChanged(true)};e.prototype.editChild=function(e){if(this.isEditable()){var t=this.imageByFilenameUriPattern;var i={child:{name:e.getName(),containerName:e.getContainerName(),isToc:e.isToc(),isSortable:e.isSortable(),interestGroup:e.getInterestGroup(),targetId:e.getTargetId(),asTocItem:e.asTocItem(),placeholders:e.getPlaceholders()},targets:this.targets.list(),interestGroups:this.interestGroups.slice(),categories:this.categories.list(),imageUriPattern:this.imageUriPattern,noPreviewImageLink:this.noPreviewImageLink,noImageLink:this.noImageLink,urls:this.urls,mailingId:this.mailingId,mobileSuffix:this.mobileSuffix,mobileImagePrefix:this.mobileImagePrefix,resolveAgnImageTags:function(e){if(e){return $.trim(AGN.Lib.LB.Child.resolveAgnImageTags(e,t))}else{return e}}};if(e.isToc()){i.child.toc=this.children.active().asTocItems(false)}AGN.Lib.LB.ChildEditor.init(e,i)}};e.prototype.setChildTarget=function(e,t){e.setTargetId(t);const i=e.isMatching(this.targetId);e.setShown(i);if(!i){this.watcher.bind(this.children.active().matching(this.targetId).pulse());if(!e.isToc()&&!e.isTocItem()){this.updateToc(false)}}if(e.isTocItem()){this.updateToc(false)}this.adjust();this.setChanged(true);this.updateAvailableTargets()};e.prototype.updateTocItemsUsage=function(e,i){if(e.isToc()){this.children.active().each(e=>{const t=i[e.getId()];if(t===true||t===false){e.setTocItem(t)}});this.updateToc(false);this.adjust();this.setChanged(true)}};e.prototype.setTocItem=function(e,t){e.setTocItem(t);this.updateToc(false);this.adjust();this.setChanged(true)};e.prototype.savePlaceholder=function(e,t,i){e.setContent({[t]:i});if(e.isToc()){this.updateToc(false)}else{e.rebuild({imageUriPattern:this.imageUriPattern,imageByFilenameUriPattern:this.imageByFilenameUriPattern,noImageLink:this.noImageLink})}if(!e.isMatching(this.targetId)){this.watcher.bind(this.children.active().matching(this.targetId).pulse())}this.adjust(false);this.setChanged(true)};e.prototype.controlRssBtn=function(){$('[data-action="import-from-content-source"]').parent().toggle(this.children.containsRssChildren())};e.prototype.updateRecycleBin=function(){const e=$("#recyclebin-content");const t=$("#grid-recyclebin-tab").find("[data-no-found-blocks-msg]");const i=$("#recycle-bin-clear-btn");this.children.sort(function(e,t){if(e.isRecycled()===t.isRecycled()){return 0}return e.isRecycled()?1:-1});var n=this.children.recycled().get();AGN.Lib.LB.Ui.setShown(t,n.length===0);AGN.Lib.LB.Ui.setShown(i,n.length>0);var r=AGN.Lib.Template.dom("recyclebin-blocks",{children:n.map(function(e){return{name:e.getName()||e.getContainerName(),id:e.getId(),containerId:e.getContainerId()}})});e.html(r);r.find("[data-building-block]").each(function(e){var t=$(this);t.draggable(AGN.Lib.LB.ChildSample.draggableOptions());AGN.Lib.LB.Child.set(t,n[e])})};e.prototype.getGuttersAsString=function(){var t=[];this.grid.each(function(e){t.push(e.isGuttered()?"1":"0")});return t.join("|")};e.prototype.getChildrenAsSubmittable=function(){var e=this.children.active().groups();var i=[];var n=AGN.Lib.LB.Ui.getAvailableTargetIds();e.forEach(function(e){e=_.sortBy(e,function(e){return n.indexOf(e.getTargetId())});var t=0;e.forEach(function(e){e.setZ(t++);i.push(e.asSubmittable())})});return i};e.prototype.validateOverlaps=function(){var e=this.children.active().select(function(e){return e.getRows()>1}).get();for(var t=0;t<e.length;t++){var i=e[t];var n=i.getRow();var r=n+i.getRows()-1;for(var o=t+1;o<e.length;o++){var s=e[o];var a=s.getRow();var l=a+s.getRows()-1;if(a>n&&a<=r&&l>r||a<n&&l>=n&&l<r){var c=i.getColumn();var u=c+i.getColumns()-1;var d=s.getColumn();var h=d+s.getColumns()-1;if(d>u||h<c){return false}}}}return true};e.prototype.save=function(e){if(this.validateOverlaps()){var i=AGN.Lib.Form.get($("#grid-template-tile"));this.setChanged(false);i.setValue("forceGenerateTextVersion",e===true);i.setValue("rowGutters",this.getGuttersAsString());i.setValue("childrenJson",JSON.stringify(this.getChildrenAsSubmittable()));i.setValue("removedChildren",this.removedChildren);i.submit("resource")}else{AGN.Lib.Messages(t("defaults.error"),t("error.template.invalidVerticalSpanning"),"alert")}};e.prototype.checkIfDataRestoreNeeded=function(e){var t=this.getChildrenData();var i=e.children;if(t.length!==i.length){return true}return JSON.stringify(t)!==JSON.stringify(i)};e.prototype.getDataForAutoSave=function(){return{children:this.getChildrenData()}};e.prototype.getChildrenData=function(){return this.children.children.map(function(e){return e.data})};e.prototype.clearEmptyAddedOnTheFlyRows=function(){const t=this;this.grid.each(function(e){e.preventAddOnTheFly=false;if(e.isEmptyRowAddedOnTheFly){t.removeRow(e)}})};e.prototype.processAddedOnTheFlyRows=function(t){if(this.grid.getRows()>0){this.grid.rows.filter(e=>{return e.isAllowedToAppendNewRowOnTheFly(t.pageX,t.pageY)}).forEach(e=>{this.appendRowOnTheFlyAfter(e)})}else{this.appendRowOnTheFly()}};e.prototype.appendRowOnTheFlyAfter=function(e){this.clearEmptyAddedOnTheFlyRows();this.addRowAfter(e);const t=this.grid.rows[AGN.Lib.LB.Definitions.EDITOR.grid.rows.indexOf(e)+1];t.animateAppearance();t.isEmptyRowAddedOnTheFly=true;e.preventAddOnTheFly=true};e.prototype.appendRowOnTheFly=function(){this.clearEmptyAddedOnTheFlyRows();this.addRow(false);const e=this.grid.rows[0];e.animateAppearance();e.isEmptyRowAddedOnTheFly=true};e.prototype.getRecycledChildren=function(){return this.children.recycled().get().map(e=>e.getId()).filter(e=>e>0)};e.prototype.clearRecycleBin=function(){const e=this.children.recycled();e.each(e=>{if(e.getId()>0){this.removedChildren.push(e.getId())}});this.children.removeChilds(e.get());this.updateRecycleBin()};AGN.Lib.LB.Editor=e})();(function(){function f(e,t){this.$template=$("#lb-grid-template");this.$sidebar=$("#lb-sidebar");this.columns=e.columns;this.rows=[];this.gap=e.gap;this.columnWidth=e.columnWidth;this.callbacks={};this.hoveredDroppable=null;for(var i=1;i<=t;i++){var n=this.createRow(e.gutters[i-1]);this.$template.append(n.get$());this.rows.push(n)}this.adjustSidebar()}f.area=function(e,t,i,n){return{row:e,column:t,rows:i,columns:n}};f.prototype.createRow=function(e){var l=new AGN.Lib.LB.Row(this.columns,e);var c=this;l.setOnHoverChange(function(e,t,i,n){var r=c.rows.indexOf(l)+1;if(r>0){if(n){c.setAreaHovered(f.area(r,i,t.getRows(),t.getColumns()));c.hoveredDroppable=e}else if(c.hoveredDroppable===e){c.setAreaHovered(false)}}else{c.setAreaHovered(false)}});l.setOnDrop(function(e,t,i){if(c.callbacks.onDrop){var n=c.rows.indexOf(l)+1;if(n>0){var r=e.getRows();var o=c.getRows()-n+1;if(r>o){r=o}var s=e.getColumns();var a=c.getColumns()-i+1;if(s>a){s=a}c.callbacks.onDrop.call(c,e,t,f.area(n,i,r,s))}}});return l};f.prototype.each=function(e){this.rows.forEach(e)};f.prototype.getRows=function(){return this.rows.length};f.prototype.getColumns=function(){return this.columns};f.prototype.getRow=function(e){return this.rows[e-1]||null};f.prototype.getDroppable=function(e,t){var i=this.getRow(e);if(i){return i.getDroppable(t)}return null};f.prototype.getRowMargin=function(e){return AGN.Lib.LB.Definitions.UNCOLLAPSIBLE_GUTTER_SIZE+(e?this.gap:0)};f.prototype.getCoordinates=function(e,t){return this.getDroppable(e,t).getCoordinates()};f.prototype.getConstraints=function(e,t){return $.extend(this.getWidthConstraints(e,t),this.getHeightConstraints(e,t))};f.prototype.getWidthConstraints=function(e,t){var i=e.getColumn();var n=e.getColumns();var r=this.getWidthForSpans(1);var o;if(t.isHorizontal()){if(t.isEast()){o=this.getWidthForSpans(this.getColumns()-i+1)}else{o=this.getWidthForSpans(i+n-1)}}else{o=r}return{minWidth:r,maxWidth:o}};f.prototype.getHeightConstraints=function(e,t){var i=e.getColumns();var n=e.getColumn();var r=n+i-1;var o=e.getRows();var s=e.getRow();var a=s+o-1;var l,c;if(t.isVertical()){if(t.isSouth()){l=this.getMinHeightConstraint(s,n,1,i);a=this.getRows();if(t.isHorizontal()){if(t.isEast()){r=this.getColumns()}else{n=1}}}else{l=this.getMinHeightConstraint(a,n,1,i);s=1}c=this.getMaxHeightConstraint(s,n,a-s+1,r-n+1)}else{l=c=e.getHeight()}return{minHeight:Math.min(l,e.getHeight()),maxHeight:c}};f.prototype.getWidthForSpans=function(e){if(AGN.Lib.LB.Definitions.IS_BASIC_LB){return this.columnWidth}return this.columnWidth*e+this.gap*(e-1)};f.prototype.getHeightForSpans=function(e,t,i,n,r){var o=this;if(r===undefined){r=function(e,t){return e.getHeight()>t.getHeight()?e:t}}function s(e){return o.rows[e-1].getDroppables().slice(t-1,t+n-1).reduce(r)}var a=e;var l=e+i-1;if(a===l){return s(a).getHeight()}else{var c=s(a).get$();var u=s(l).get$();return u.position().top-c.position().top+u.outerHeight()}};f.prototype.getMinHeightConstraint=function(e,t,i,n){function r(e,t){return e.getHeight()<t.getHeight()?e:t}return this.getHeightForSpans(e,t,i,n,r)};f.prototype.getMaxHeightConstraint=function(e,t,i,n){function r(e,t){return e.getHeight()>t.getHeight()?e:t}return this.getHeightForSpans(e,t,i,n,r)};f.prototype.getArea=function(e,t,i,n){var r=this;var o,s;if(t.isHorizontal()){s=Math.ceil(i/(this.columnWidth+this.gap));if(t.isEast()){o=e.getColumn()}else{o=e.getColumn()+e.getColumns()-s}}else{o=e.getColumn();s=e.getColumns()}function a(e){var t=r.rows[e-1];if(t){return t.getDroppables().slice(o-1,o+s-1).reduce(function(e,t){return e.getHeight()>t.getHeight()?e:t})}else{return null}}function l(e){return e.get$().position().top}var c,u;if(t.isVertical()){var d,h;u=1;if(t.isSouth()){c=e.getRow();d=a(c);while(h=a(c+u)){if(n>l(h)-l(d)){u++}else{break}}}else{c=e.getRow()+e.getRows()-1;h=a(c);while(d=a(c-1)){if(n>l(h)-l(d)+h.getHeight()-d.getHeight()){c--;u++}else{break}}}}else{c=e.getRow();u=e.getRows()}return f.area(c,o,u,s)};f.prototype.setAreaHovered=function(i){if(i){this.each(function(e,t){if(t>=i.row-1&&t<=i.row-1+i.rows-1){e.setHovered(true,i.column,i.column+i.columns-1)}else{e.setHovered(false)}})}else{this.each(function(e){e.setHovered(false)})}if(this.callbacks.onAreaHovered){this.callbacks.onAreaHovered.call(this,i)}};f.prototype.startResizing=function(e){if(this.callbacks.onResizingStarted){this.callbacks.onResizingStarted.call(this,e)}};f.prototype.stopResizing=function(e){if(this.callbacks.onResizingStopped){this.callbacks.onResizingStopped.call(this,e)}};f.prototype.adjustRows=function(e){AGN.Lib.LB.Adjustments.make(this,e.get())};f.prototype.getDroppables=function(){var r=[];var t=this.gap;this.each(function(e,i){var n=(e.isGuttered()?t:0)+AGN.Lib.LB.Definitions.UNCOLLAPSIBLE_GUTTER_SIZE;e.each(function(e,t){r.push({droppable:e,row:i+1,column:t+1,marginBottom:n})})});return r};f.prototype.addRowBefore=function(e){var t=this.rows.indexOf(e);if(t>=0){var i=true;if(t>0){i=this.rows[t-1].isGuttered()}var n=this.createRow(i);this.rows[t].get$().before(n.get$());this.rows.splice(t,0,n)}return t+1};f.prototype.addRow=function(){if(this.rows.length>0){this.rows[this.rows.length-1].setGuttered(true)}var e=this.createRow(true);this.$template.append(e.get$());this.rows.push(e);return this.rows.length};f.prototype.removeRow=function(e){var t=this.rows.indexOf(e);if(t>=0){this.rows[t].remove();this.rows.splice(t,1)}return t+1};f.prototype.adjustSidebar=function(){const l=e=>{e.removeClass("btn--small");e.removeClass("btn--detached");e.removeClass("btn--attached");e.css("height","")};const c=(e,t)=>{const i=t.offset().top+t.outerHeight()/2;const n=e.outerHeight()/2;e.offset({top:i-n})};let u=null;this.each(e=>{const t=e.get$();const i=e.getRemoveBtn$();l(i);const n=t.outerHeight();const r=n-i.outerHeight();const o=r>=0;const s=10;if(o){if(r>=s*2){i.css("height",n-s*2)}i.addClass("btn--attached")}else{i.addClass("btn--small");const a=u?.getRemoveBtn$();if(a&&a.hasClass("btn--detached")){i.addClass("btn--attached")}else{i.addClass("btn--detached")}}c(i,t);e.setRemoveButtonShown(true);u=e});this._updateSidebarWidth()};f.prototype._updateSidebarWidth=function(){const e=this.$sidebar.children().get().reduce((e,t)=>{const{left:i}=$(t).position();const n=i+$(t).outerWidth(true);return Math.max(e,n)},0);this.$sidebar.css("width",e)};f.prototype.setOnDrop=function(e){this.callbacks.onDrop=e};f.prototype.setOnAreaHovered=function(e){this.callbacks.onAreaHovered=e};f.prototype.setOnResizingStarted=function(e){this.callbacks.onResizingStarted=e};f.prototype.setOnResizingStopped=function(e){this.callbacks.onResizingStopped=e};AGN.Lib.LB.Grid=f})();(function(){function e(){this.deferred=$.Deferred();this.callback=null}e.prototype.promise=function(){return this.deferred.promise()};e.prototype.bind=function(e){var t=this;if(e===false){t.callback=null}else{var i=t.callback=function(){if(t.callback===i){t.deferred.notifyWith(this,arguments)}};if($.isArray(e)){e.forEach(function(e){e.progress(i)})}else{e.progress(i)}}};AGN.Lib.LB.PromiseProgressWatcher=e})();(function(){function e(e,t){var i=e.get$();this.child=e;this.$child=i;this.grid=t}e.prototype.setupConstraints=function(){this.setConstraints(this.grid.getConstraints(this.child,this.direction))};e.prototype.setConstraints=function(e){this.$child.resizable({minWidth:e.minWidth,maxWidth:e.maxWidth,minHeight:e.minHeight,maxHeight:e.maxHeight})};e.prototype.getArea=function(e,t){return this.grid.getArea(this.child,this.direction,e,t)};e.prototype.start=function(e){this.direction=e;this.area={row:this.child.getRow(),column:this.child.getColumn(),rows:this.child.getRows(),columns:this.child.getColumns()};this.z=this.child.getZ();this.setupConstraints();this.grid.setAreaHovered(this.area);this.grid.startResizing(this.child);this.child.setZ(AGN.Lib.LB.Definitions.TOP_Z)};e.prototype.resize=function(e,t){var i=this.getArea(e,t);if(i.row!==this.area.row||i.column!==this.area.column||i.rows!==this.area.rows||i.columns!==this.area.columns){this.area=i;this.grid.setAreaHovered(i)}};e.prototype.stop=function(e,t){this.area=this.getArea(e,t);this.child.setZ(this.z);this.child.setRow(this.area.row);this.child.setColumn(this.area.column);this.child.setRows(this.area.rows);this.child.setColumns(this.area.columns);this.grid.setAreaHovered(null);this.grid.stopResizing(this.child);this.child.adjustSize(this.grid);this.child.adjustCoordinates(this.grid)};AGN.Lib.LB.Resizing=e})();(function(){function e(e){this.horizontal=AGN.Lib.LB.Definitions.DIRECTION.NONE;this.vertical=AGN.Lib.LB.Definitions.DIRECTION.NONE;for(var t=0;t<e.length;t++){var i=e.charAt(t).toLowerCase();switch(i){case AGN.Lib.LB.Definitions.DIRECTION.EAST:case AGN.Lib.LB.Definitions.DIRECTION.WEST:if(this.horizontal===AGN.Lib.LB.Definitions.DIRECTION.NONE){this.horizontal=i}else{console.error("Ambiguous direction code: "+e)}break;case AGN.Lib.LB.Definitions.DIRECTION.NORTH:case AGN.Lib.LB.Definitions.DIRECTION.SOUTH:if(this.vertical===AGN.Lib.LB.Definitions.DIRECTION.NONE){this.vertical=i}else{console.error("Ambiguous direction code: "+e)}break;default:console.error("Unknown direction code: "+i)}}}e.prototype.isHorizontal=function(){return this.horizontal!==AGN.Lib.LB.Definitions.DIRECTION.NONE};e.prototype.isVertical=function(){return this.vertical!==AGN.Lib.LB.Definitions.DIRECTION.NONE};e.prototype.isEast=function(){return this.horizontal===AGN.Lib.LB.Definitions.DIRECTION.EAST};e.prototype.isWest=function(){return this.horizontal===AGN.Lib.LB.Definitions.DIRECTION.WEST};e.prototype.isNorth=function(){return this.vertical===AGN.Lib.LB.Definitions.DIRECTION.NORTH};e.prototype.isSouth=function(){return this.vertical===AGN.Lib.LB.Definitions.DIRECTION.SOUTH};AGN.Lib.LB.ResizingDirection=e})();(function(){function e(e,i){this.$row=AGN.Lib.Template.dom("droppables-row");this.$removeButton=AGN.Lib.Template.dom("remove-row-button");this.$row.data("agn:row",this);this.$removeButton.data("agn:row",this);this.droppables=[];this.callbacks={};for(var n=1;n<=e;n++){var r=this.createDroppable();this.droppables.push(r);this.$row.append(r.get$())}this.setGuttered(i);this.$removeButton.appendTo("#lb-sidebar");AGN.Lib.LB.Ui.setTooltip(this.$removeButton,t("grid.row.delete"))}e.get=function(e){return e.data("agn:row")};e.prototype._isPointerAtAddOnTheFlyPosition=function(e,t){const i=this.$row;const n=10;const r=i.offset().top;const o=i.offset().left;const s=i.outerHeight();const a=i.outerWidth();const l=r+s;const c=this.isGuttered()?AGN.Lib.LB.Definitions.EDITOR.grid.gap:1;return e>o&&e<o+a&&(t>l-n&&t<l+c+n)};e.prototype.isAllowedToAppendNewRowOnTheFly=function(e,t){return this._isPointerAtAddOnTheFlyPosition(e,t)&&(!this.preventAddOnTheFly&&!this.isEmptyRowAddedOnTheFly)};e.prototype.animateAppearance=function(){const e=this.$row;const t=e.clone(true);e.hide().after(t);t.show().addClass("container-row-animated");t.one("animationend",function(){e.show();t.remove()})};e.prototype.createDroppable=function(){var e=new AGN.Lib.LB.Droppable(this);var r=this;e.setOnHoverChange(function(e,t){if(r.callbacks.onHoverChange){var i=this;var n=r.droppables.indexOf(i)+1;if(n>0){r.callbacks.onHoverChange.call(r,i,e,n,t)}}});e.setOnDrop(function(e){if(r.callbacks.onDrop){var t=this;var i=r.droppables.indexOf(t)+1;if(i>0){r.callbacks.onDrop.call(r,e,t,i)}}});return e};e.isEmpty=function(t){return!AGN.Lib.LB.Definitions.EDITOR.children.active().children.some(e=>e.getRow()>=t&&e.getRow()+e.getRows()-1<=t)};e.prototype.get$=function(){return this.$row};e.prototype.each=function(e){this.droppables.forEach(e)};e.prototype.getDroppables=function(){return this.droppables.slice()};e.prototype.getDroppable=function(e){return this.droppables[e-1]||null};e.prototype.setHeight=function(t){if(t>0){t=Math.max(t,AGN.Lib.LB.Definitions.COLLAPSED_BLOCK_SIZE)}else{t=AGN.Lib.LB.Definitions.EMPTY_ROW_HEIGHT}this.droppables.forEach(function(e){e.setHeight(t)})};e.prototype.isGuttered=function(){return this.$row.hasClass("guttered")};e.prototype.setGuttered=function(e){if(e){this.$row.addClass("guttered")}else{this.$row.removeClass("guttered")}};e.prototype.setHovered=function(n,r,o){if(r===undefined){this.droppables.forEach(function(e){e.setHovered(n)})}else{if(o===undefined){o=r}this.droppables.forEach(function(e,t){var i=t+1;if(r<=i&&i<=o){e.setHovered(n)}else{e.setHovered(!n)}})}};e.prototype.remove=function(){this.droppables.forEach(function(e){e.remove()});this.droppables=[];AGN.Lib.LB.Ui.removeTooltip(this.$removeButton);this.$removeButton.remove();this.$row.remove();this.callbacks.onDrop=undefined};e.prototype.setRemoveButtonShown=function(e){AGN.Lib.LB.Ui.setShown(this.$removeButton,e)};e.prototype.setOnHoverChange=function(e){this.callbacks.onHoverChange=e};e.prototype.setOnDrop=function(e){this.callbacks.onDrop=e};e.prototype.getRemoveBtn$=function(){return this.$removeButton};AGN.Lib.LB.Row=e})();(function(){function e(){e.prototype.import=function(){const t=this;this.getRssChildrenToReplaceWithNewContent().forEach(function(e){t._importContent(e)})};e.prototype.getRssChildrenToReplaceWithNewContent=function(){return _.union(this._getRssImportedStartChildren(),this.getRssTemplateChildren())};e.prototype._importContent=function(t){const i=this;$.get(AGN.url("/layoutbuilder/container/"+t.getContainerId()+"/importRss.action")).done(function(e){i.insertRssChildren(i.getRssChildrenFromSamples(e),t)})};e.prototype.insertRssChildren=function(e,t){if(!e.length){return}var i=t.getColumn();var n=t.getRow();AGN.Lib.LB.Definitions.EDITOR.replaceChildren(t,e[0]);e.slice(1).forEach(function(e){e.setColumn(i);e.setRow(n);const t=AGN.Lib.LB.Definitions.EDITOR.cloneChild(e);i=t.getColumn();n=t.getRow()})};e.prototype.getRssChildrenFromSamples=function(e){return e.map(function(e){return new AGN.Lib.LB.ChildSample(e).instantiate()})};e.prototype.getImportedRssChildren=function(){return _.groupBy(AGN.Lib.LB.Definitions.EDITOR.children.active().children.filter(function(e){return e.isRssImportedChild()}),function(e){return e.data.type||e.data.container.type})};e.prototype.getRssTemplateChildren=function(){return AGN.Lib.LB.Definitions.EDITOR.children.active().children.filter(function(e){return e.isRssTemplateChild()})};e.prototype._removeRssChildrenAndGetPlaceholder=function(e){e.slice(1).forEach(function(e){const t=e.getRow();AGN.Lib.LB.Definitions.EDITOR.removeChild(e);if(AGN.Lib.LB.Row.isEmpty(t)){AGN.Lib.LB.Definitions.EDITOR.removeRow(AGN.Lib.LB.Definitions.EDITOR.grid.getRow(t))}});return e[0]};e.prototype._getRssImportedStartChildren=function(){const t=this;return _.map(this.getImportedRssChildren(),function(e){return t._removeRssChildrenAndGetPlaceholder(e)})}}AGN.Lib.LB.RssImporter=e})();(function(){function e(e){var t={};if(e){this.data=e.slice();this.data.forEach(function(e){t[e.id]=e.name})}else{this.data=[]}this.map=t}e.prototype.name=function(e){return this.map[e==AGN.Lib.LB.Definitions.ALL_ENTRIES?AGN.Lib.LB.Definitions.ALL_RECIPIENTS:e]};e.prototype.list=function(){return this.data.slice()};AGN.Lib.LB.Targets=e})();(function(){const e={setShown:function(e,t){e.toggleClass("hidden",!t)},setTooltip:function(e,t){e.data("tooltip",t);AGN.Lib.Tooltip.createTip(e,t)},removeTooltip:function(e){AGN.Lib.Tooltip.remove(e)},checkHoverState:function(e){if(e.is(":hover")){e.trigger("mouseleave").trigger("mouseenter")}},setLoading:function(e){$("#lb-editor-progress").toggle(!!e);$("#disabled-save-button").parent().toggleClass("hidden",!e);$("#save-button").parent().toggleClass("hidden",!!e)},setEditable:function(e){$("#save-button").parent().toggleClass("hidden",!e);$("#building-blocks-search").toggleClass("disabled",!e);$("#update-text-version").parent().toggle(!!e);$("#visibleTargets").attr("disabled",!e)},setTargetId:function(e){$("#visibleTargets").val(e).trigger("change.select2")},getAvailableTargetIds:function(){return $("#visibleTargets").children("option").get().map(function(e){return parseInt($(e).val())})},setAvailableTargetIds:function(e){var i=this.getAvailableTargetIds();var n=$("#visibleTargets");n.empty();e.push({id:AGN.Lib.LB.Definitions.ALL_ENTRIES,name:t("filter.reset")});_.sortBy(e,function(e){if(e.id>AGN.Lib.LB.Definitions.ALL_RECIPIENTS){return i.indexOf(parseInt(e.id))}else if(e.id==AGN.Lib.LB.Definitions.ALL_RECIPIENTS){return 1e6}else{return 1000001}}).forEach(function(e){$("<option></option>").val(e.id).text(e.name).appendTo(n)})},imagesAdjusted:function(i,e){var n=$.Deferred();var r=undefined,o=undefined;if(e===true){r=i.outerWidth();o=i.outerHeight()}var t=function(){var e=i.outerWidth(),t=i.outerHeight();if(r!==e||o!==t){r=e;o=t;n.notify()}};i.imagesLoaded().progress(t).always(t);return n.promise()},getHeightAccurate:function(e){return e[0].getBoundingClientRect().height},getResizeHandleDirection:function(e){if(e.hasClass("ui-resizable-ne")){return new AGN.Lib.LB.ResizingDirection("ne")}if(e.hasClass("ui-resizable-se")){return new AGN.Lib.LB.ResizingDirection("se")}if(e.hasClass("ui-resizable-nw")){return new AGN.Lib.LB.ResizingDirection("nw")}if(e.hasClass("ui-resizable-sw")){return new AGN.Lib.LB.ResizingDirection("sw")}if(e.hasClass("ui-resizable-e")){return new AGN.Lib.LB.ResizingDirection("e")}if(e.hasClass("ui-resizable-w")){return new AGN.Lib.LB.ResizingDirection("w")}if(e.hasClass("ui-resizable-n")){return new AGN.Lib.LB.ResizingDirection("n")}if(e.hasClass("ui-resizable-s")){return new AGN.Lib.LB.ResizingDirection("s")}console.error("Invalid resizing direction handle");return new AGN.Lib.LB.ResizingDirection("")}};AGN.Lib.LB.Ui=e})();(function(){var e={actionbased_mailing:{anchors:[[.07,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.78,0,1]]},mailing_mediatype_sms:{anchors:[[.07,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.78,0,1]]},mailing_mediatype_post:{anchors:[[.07,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.78,0,1]]},archive:{anchors:[[.1,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.8,0,1]]},datebased_mailing:{anchors:[[.07,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.78,0,1]]},deadline:{anchors:[[.1,.5,-1,0],[.5,.05,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},decision:{anchors:[[.06,.5,-1,0],[.5,.06,0,-1],[.94,.5,1,0],[.5,.94,0,1]]},export:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},followup_mailing:{anchors:[[.04,.5,-1,0],[.5,.2,0,-1],[.96,.5,1,0],[.5,.8,0,1]]},form:{anchors:[[.1,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.78,0,1]]},import:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},mailing:{anchors:[[.1,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.78,0,1]]},ownWorkflow:{anchors:[[.1,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.78,0,1]]},parameter:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},recipient:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},scABTest:{anchors:[[.1,.5,-1,0],[.5,.15,0,-1],[.9,.5,1,0],[.5,.85,0,1]]},scBirthday:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.85,0,1]]},scDOI:{anchors:[[.3,.5,-1,0],[.5,.04,0,-1],[.72,.5,1,0],[.5,.96,0,1]]},start:{anchors:[[0,.5,-1,0],[.5,.15,0,-1],[1,.5,1,0],[.5,.85,0,1]]},stop:{anchors:[[0,.5,-1,0],[.5,.15,0,-1],[1,.5,1,0],[.5,.85,0,1]]}};var t={"*":{deadline:function(e,t){return!t.connections.incoming.some(function(e){return e.source.getType()==="import"})},mailing:function(e,t){return t.connections.incoming.length===0},datebased_mailing:function(e,t){return t.connections.incoming.length===0}},start:{recipient:true,form:true,import:true,export:true},stop:false,decision:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,mailing_mediatype_sms:true,mailing_mediatype_post:true,actionbased_mailing:true,datebased_mailing:true,followup_mailing:true,mailing:true},parameter:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,mailing_mediatype_sms:true,mailing_mediatype_post:true,actionbased_mailing:true,datebased_mailing:true,followup_mailing:true,mailing:true},deadline:{decision:true,parameter:true,recipient:true,archive:true,mailing_mediatype_sms:true,mailing_mediatype_post:true,actionbased_mailing:true,datebased_mailing:true,followup_mailing:true,mailing:true,import:true,export:true},recipient:{decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,mailing_mediatype_sms:true,mailing_mediatype_post:true,actionbased_mailing:true,datebased_mailing:true,followup_mailing:true,mailing:true,import:true,export:true},actionbased_mailing:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,import:true,export:true},datebased_mailing:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,import:true,export:true},followup_mailing:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,import:true,export:true},mailing:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,import:true,export:true},mailing_mediatype_sms:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,import:true,export:true},mailing_mediatype_post:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,import:true,export:true},archive:{decision:true,parameter:true,deadline:true,recipient:true,actionbased_mailing:true,mailing_mediatype_sms:true,mailing_mediatype_post:true,datebased_mailing:true,followup_mailing:true,mailing:true,import:true,export:true},form:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,actionbased_mailing:true,mailing_mediatype_sms:true,mailing_mediatype_post:true,datebased_mailing:true,followup_mailing:true,mailing:true,import:true,export:true},import:{deadline:function(e){return e.connections.outgoing.length===0}},export:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,actionbased_mailing:true,mailing_mediatype_sms:true,mailing_mediatype_post:true,datebased_mailing:true,followup_mailing:true,mailing:true,import:true,export:true,archive:true,form:true}};AGN.Lib.WM.Definitions={KEY_ENTER:13,KEY_SHIFT:16,KEY_CTRL:17,KEY_SPACE:32,KEY_DELETE:46,MOUSE_BUTTON_LEFT:0,MOUSE_BUTTON_MIDDLE:1,DEFAULT_DRAG_MODE:0,GRID_CELL_DRAG_MODE:1,BOTTOM:"BOTTOM",LEFT:"LEFT",RIGHT:"RIGHT",TOP:"TOP",NODE_ANIMATION_DROPPED:"animate-dropped",NODE_ANIMATION_AUTO_DROPPED:"animate-auto-dropped",Z_INDEX_VIEW_PORT:10,Z_INDEX_ICON_PANEL:50,Z_INDEX_DRAGGABLE_BUTTON:60,Z_INDEX_ICON_TITLES_CONTAINER:5,Z_INDEX_CONNECTION_OVERLAY:9,Z_INDEX_ICON:10,Z_INDEX_CONNECTION_HOVER:11,Z_INDEX_CONNECTION_OVERLAY_HOVER:12,Z_INDEX_ICON_HOVER:13,Z_INDEX_ICON_TITLE_HOVER:19,Z_INDEX_DRAGGED_ICON_NODE:20,Z_INDEX_JSPLUMB_DRAG_OPTIONS:25,Z_INDEX_NAVIGATOR_GLOBE:30,Z_INDEX_NAVIGATOR_ARROWS:31,Z_INDEX_CONTEXT_MENU:40,CANVAS_DEFAULT_GRID_SIZE:20,CANVAS_GRID_SIZE:20,NODE_SIZE:64,NODE_MIN_MARGIN:.1,TITLE_WIDTH:94,MINIMAP_PADDING:2,DEFAULT_AUTO_ALIGN_STEP_X:5,GRID_AUTO_ALIGN_STEP_X:2,AUTO_ALIGN_STEP_X:5,AUTO_ALIGN_EXTRA_STEP_X:.5,DEFAULT_AUTO_ALIGN_STEP_Y:6,GRID_AUTO_ALIGN_STEP_Y:2,AUTO_ALIGN_STEP_Y:6,AUTO_ALIGN_STEP_BETWEEN_GROUPS:2,AUTO_DROP_STEP_X:4,AUTO_DROP_STEP_Y:3,MIN_ZOOM:.5,MAX_ZOOM:1.5,DEFAULT_ZOOM:1,ZOOM_STEP:.1,NAVIGATION_STEP:100,MAX_UNDO_STEPS:17,CONNECTION_COLOR:"#C0C0C0",CONNECTION_THICKNESS:3,CONNECTION_OUTLINE_COLOR:"transparent",CONNECTION_OUTLINE_WIDTH:4,CONNECTION_HOVER_COLOR:"#6F6F6F",CONNECTION_ARROW_SIZE:10,NODE_TYPE_START:"start",NODE_TYPE_STOP:"stop",NODE_TYPE_DECISION:"decision",NODE_TYPE_DEADLINE:"deadline",NODE_TYPE_PARAMETER:"parameter",NODE_TYPE_RECIPIENT:"recipient",NODE_TYPE_ARCHIVE:"archive",NODE_TYPE_FORM:"form",NODE_TYPE_MAILING:"mailing",NODE_TYPE_OWN_WORKFLOW:"ownWorkflow",NODE_TYPE_SC_BIRTHDAY:"scBirthday",NODE_TYPE_SC_DOI:"scDOI",NODE_TYPE_SC_ABTEST:"scABTest",NODE_TYPE_ACTION_BASED_MAILING:"actionbased_mailing",NODE_TYPE_MAILING_MEDIATYPE_SMS:"mailing_mediatype_sms",NODE_TYPE_MAILING_MEDIATYPE_POST:"mailing_mediatype_post",NODE_TYPE_DATE_BASED_MAILING:"datebased_mailing",NODE_TYPE_FOLLOWUP_MAILING:"followup_mailing",NODE_TYPE_IMPORT:"import",NODE_TYPE_EXPORT:"export",NODE_TYPES_MAILING:["mailing","followup_mailing","actionbased_mailing","datebased_mailing","mailing_mediatype_sms","mailing_mediatype_post"],NODE_TYPES_IMPORT_EXPORT:["import","export"],NODE_TYPE_START_ID:0,NODE_TYPE_STOP_ID:1,NODE_TYPE_DECISION_ID:2,NODE_TYPE_DEADLINE_ID:3,NODE_TYPE_PARAMETER_ID:4,NODE_TYPE_RECIPIENT_ID:6,NODE_TYPE_ARCHIVE_ID:7,NODE_TYPE_FORM_ID:8,NODE_TYPE_MAILING_ID:9,NODE_TYPE_OWN_WORKFLOW_ID:10,NODE_TYPE_SC_BIRTHDAY_ID:11,NODE_TYPE_SC_DOI_ID:12,NODE_TYPE_SC_ABTEST_ID:13,NODE_TYPE_ACTION_BASED_MAILING_ID:14,NODE_TYPE_DATE_BASED_MAILING_ID:15,NODE_TYPE_FOLLOWUP_MAILING_ID:16,NODE_TYPE_IMPORT_ID:17,NODE_TYPE_EXPORT_ID:18,NODE_TYPE_MAILING_MEDIATYPE_SMS_ID:19,NODE_TYPE_MAILING_MEDIATYPE_POST_ID:20,MAILING_PARAM_MAILING_LIST:1,MAILING_PARAM_TARGET_GROUPS:2,MAILING_PARAM_ARCHIVE:3,MAILING_PARAM_LIST_SPLIT:4,MAILING_PARAM_PLANNED_DATE:5,MAILING_PARAM_SEND_DATE:6,MAILING_PARAM_ALTGS:7,DEPENDENCY_TYPE_ARCHIVE:1,DEPENDENCY_TYPE_AUTO_EXPORT:2,DEPENDENCY_TYPE_AUTO_IMPORT:3,DEPENDENCY_TYPE_MAILING_DELIVERY:4,DEPENDENCY_TYPE_MAILING_LINK:5,DEPENDENCY_TYPE_MAILING_REFERENCE:6,DEPENDENCY_TYPE_MAILINGLIST:7,DEPENDENCY_TYPE_PROFILE_FIELD:8,DEPENDENCY_TYPE_PROFILE_FIELD_HISTORY:9,DEPENDENCY_TYPE_TARGET_GROUP:11,DEPENDENCY_TYPE_USER_FORM:12,GENDER_PROFILE_FIELD:"gender",FIELD_TYPE_DATE:"date",SPLIT_DEFAULT_PARAMETERS:[5,10,15,20,25,30,33,40,50],TITLE_MAX_TARGETS:2,PDF_SIZE:"A4",PDF_ORIENTATION:"landscape",PAGE_DIMENSIONS:{A4:{width:800,height:1360}},ICONS_CONFIG:e,CONNECTION_CONSTRAINTS:t,NODE_POPOVER_TEMPLATE:'<div class="popover popover-wide" role="tooltip" ><div class="arrow"></div><div class="popover-content" style="width: auto; height: auto; max-width: 300px; max-height: 350px; overflow: auto;"></div></div>',EMPTY_OPTION_PLACEHOLDER:"--"}})();(function(){var n=AGN.Lib.WM.Definitions,i=AGN.Lib.Helpers,o=AGN.Lib.DateFormat;AGN.Lib.WM.Utils={checkActivation:function(e){var i=$("#workflow-status").val();if(n.constants.initialWorkflowStatus===n.constants.statusActive&&(i===n.constants.statusActive||i===n.constants.statusTesting)){if(e){AGN.Lib.Messages(t("workflow.defaults.error"),t("error.workflow.saveActivatedWorkflow"),"alert")}return true}else{return false}},getConfigData:function(e){return i.objFromString(e.data("config"))},mapAsOptionsHtml:function(i){var n="";Object.keys(i).forEach(function(e){var t='value="'+e+'"';n+="<option "+t+">"+i[e]+"</option>"});return n},arrayAsOptionsHtml:function(e){var r="";e.forEach(function(e){var t='value="'+e.id+'"';var i=e.data;if(i){Object.keys(i).forEach(function(e){t+=" data-"+e+'="'+i[e].replace('"',"&quot;")+'"'})}var n=e.text.replace("<","&lt;").replace(">","&gt;");r+="<option "+t+">"+n+"</option>"});return r}};AGN.Lib.WM.DateTimeUtils={toDateTime:function(e,t,i){var n=null;if(!!e&&e.getMonth){n=new Date(e);if(!!t&&t!==0){n.setHours(t)}if(!!i&&i!==0){n.setMinutes(i)}}return n},getDateTimeValue:function(e,t,i){var n=this.toDateTime(e,t,i);return n!=null?n.getTime():null},getDateTimeStr:function(e,t,i,n){if(!e||!e.getMonth){return""}t=t||e.getHours();i=i||e.getMinutes();var r=this.toDateTime(e,t,i);if(!!r){return o.format(r,n)}else{return""}},getDateStr:function(e,t){return this.getDateTimeStr(e,null,null,t)}}})();(function(){function e(e){this.rules=e}e.prototype.isConstraint=function(e){return _.isBoolean(e)||_.isFunction(e)};e.prototype.evaluate=function(e,t,i){if(e===true||e===false){return e}if(_.isFunction(e)){return e(t,i)}return undefined};e.prototype.getRulesToCheck=function(e,t){return[{from:e.type,to:[t.type,"*"]},{from:"*",to:[t.type,"*"]}]};e.prototype.getRelevantConstraints=function(e,t){var r=this.isConstraint;var i=this.getRulesToCheck(e,t);var o=this.rules;var s=[];i.forEach(function(t){var i=true;if(_.has(o,t.from)){var n=o[t.from];if(r(n)){s.push(n);i=false}else{t.to.forEach(function(e){if(_.has(o[t.from],e)){n=o[t.from][e];if(r(n)){s.push(n);i=false}}})}}if(i&&t.from!="*"){s.push(false)}});return s};e.prototype.check=function(e,t){var i=this.getRelevantConstraints(e,t);var n=false;for(var r=0;r<i.length;r++){if(this.evaluate(i[r],e,t)){n=true}else{return false}}return n};AGN.Lib.WM.ConnectionConstraints=e})();(function(){var t=AGN.Lib.WM.DateTimeUtils,i=AGN.Lib.Template,l=AGN.Lib.WM.Definitions,n=AGN.Lib.Popover;class c{constructor(e,t){this.id=null;this.x=0;this.y=0;this.type=e;this.title="";this.overlayTitle="";this.overlayImage={image:"",title:"",visible:false};this.filled=false;this.editable=true;this.expandable=false;this.dependent=false;this.inRecipientsChain=false;this.anchors=l.ICONS_CONFIG[e].anchors;this.data=t;this.$element=c.create$(e);this.$element.data("agn:node",this);this.$connectionButton=this.$element.find(".node-connect-button");this.$titleDiv=c.createTitleDiv$();this.$titleSpan=this.$titleDiv.find(".icon-title-span");this.$overlayTitle=this.$element.find(".icon-overlay-title");this.$overlayImage=this.$element.find(".icon-overlay-image img");this.nodePopover=new u(this);this.lastTitleAnchor=l.BOTTOM}static restore(e){var t=e.get$().data("agn:node");if(!t){e.get$().data("agn:node",e)}return e}static get(e){if(e instanceof HTMLElement){e=$(e)}if(!e.is(".node")){e=e.closest(".node")}return e.data("agn:node")}static isDecisionNode(e){return e.getType()===l.NODE_TYPE_DECISION}static isMailingNode(e){if(!e){return false}return l.NODE_TYPES_MAILING.includes(e.getType())}static isBranchingDecisionNode(e){if(c.isDecisionNode(e)){var t=e.getData();if(t.decisionType===l.constants.decisionTypeDecision){return true}}return false}static isDecisionBranchesOrderFromPositiveToNegative(e,t,i){if(t.y<=e.y&&i.y<=e.y){if(t.y<i.y){return true}else if(i.y<t.y){return false}else{return t.x<i.x}}else if(t.y>e.y&&i.y>e.y){return t.x>i.x}else{return t.y<i.y}}static getDecisionBranches(e){if(e.length===2){var t=c.getPosition(e[0].source.get$());var i=c.getPosition(e[0].target.get$());var n=c.getPosition(e[1].target.get$());if(this.isDecisionBranchesOrderFromPositiveToNegative(t,i,n)){return{positive:e[0],negative:e[1]}}else{return{positive:e[1],negative:e[0]}}}return null}static isCommented(e){return!!_.trim(e.getComment())}static isSelected(e){return e.hasClass("ui-selected")}static setSelected(e,t){return e.toggleClass("ui-selected",!!t)}static isChainSource(e){return e.hasClass("chain-mode-source")}static setChainSource(e,t){e.toggleClass("chain-mode-source",!!t)}static getAnchors(e){var t=c.get(e);if(t){return t.getAnchors()}return l.ICONS_CONFIG[e.data("type")].anchors}static getAnchorsInUse(e){var i={};e.forEach(function(e){var t=e.anchor.getOrientation();if(t[0]>0){i[l.RIGHT]=true}else if(t[0]<0){i[l.LEFT]=true}else if(t[1]>0){i[l.BOTTOM]=true}else if(t[1]<0){i[l.TOP]=true}});return i}static getPosition(e){var t=e.position();return{x:t.left,y:t.top}}static getBox(e){var t=e.position();var i=e[0].getBoundingClientRect();return{minX:t.left,minY:t.top,maxX:t.left+i.width,maxY:t.top+i.height}}static isInRegion(e,t){var i=c.getBox(e);return(i.minX>=t.minX&&i.minX<=t.maxX||i.maxX>=t.minX&&i.maxX<=t.maxX)&&(i.minY>=t.minY&&i.minY<=t.maxY||i.maxY>=t.minY&&i.maxY<=t.maxY)}static getCollisionBox(e){var t=c.getAnchors(e);var i=e.position();var n=e[0].getBoundingClientRect();var r=(t[0][0]-l.NODE_MIN_MARGIN)*n.width;var o=(t[1][1]-l.NODE_MIN_MARGIN)*n.height;var s=(1-t[2][0]-l.NODE_MIN_MARGIN)*n.width;var a=(1-t[3][1]-l.NODE_MIN_MARGIN)*n.height;return{minX:i.left+r,minY:i.top+o,maxX:i.left+n.width-s,maxY:i.top+n.height-a}}static detectBoxCollision=function(e,t){return!(e.minX>t.maxX||e.maxX<t.minX||e.minY>t.maxY||e.maxY<t.minY)};static create$=function(){var t=null;return function(e){if(t==null){t=i.prepare("workflow-node")}return $(t({type:e}))}}();static createDraggable$=function(){var t=null;return function(e){if(t==null){t=i.prepare("workflow-draggable-node")}return $(t({type:e}))}}();static createTitleDiv$=function(){var e=null;return function(){if(e==null){e=i.prepare("workflow-icon-title")}return $(e({}))}}();static create(e){var t={iconComment:""};var i=new c(e,t);switch(e){case"scABTest":case"scBirthday":case"scDOI":i.setFilled(true);i.setExpandable(true);t.copyContent=true;t.created=false;break;case"ownWorkflow":i.setExpandable(true);t.ownWorkflowId=0;t.copyContent=true;t.created=false;break;case"start":t.startType=null;t.date=null;t.hour=0;t.minute=0;t.sendReminder=false;t.remindAdminId=0;t.remindAtOnce=false;t.scheduleReminder=false;t.remindSpecificDate=false;t.remindDate=new Date;t.remindHour=0;t.remindMinute=0;t.event=null;t.reaction=null;t.mailingId=0;t.profileField="";t.dateProfileField="";t.dateFieldOperator=1;t.dateFieldValue="";t.useRules=false;t.rules=[];t.executeOnce=true;t.comment="";t.recipients="";t.adminTimezone="";break;case"stop":t.endType=null;t.date=null;t.hour=0;t.minute=0;t.sendReminder=false;t.remindAdminId=0;t.remindAtOnce=false;t.scheduleReminder=false;t.remindSpecificDate=false;t.remindDate=new Date;t.remindHour=0;t.remindMinute=0;t.event=null;t.reaction=null;t.mailingId=0;t.profileField="";t.useRules=false;t.rules=[];t.executeOnce=true;t.comment="";t.recipients="";t.adminTimezone="";break;case"decision":t.decisionType=null;t.decisionCriteria=null;t.reaction=null;t.mailingId=0;t.linkId=0;t.profileField="";t.aoDecisionCriteria=null;t.threshold="";t.decisionDate=new Date;t.rules=[];t.includeVetoed=true;break;case"deadline":t.deadlineType=null;t.date=new Date;t.timeUnit=null;t.delayValue=0;t.hour=0;t.minute=0;t.useTime=false;break;case"parameter":t.value=0;break;case"recipient":i.setDependent(false);t.mailinglistId=0;t.targets=[];t.altgs=[];t.targetsOption=null;break;case"archive":t.campaignId=0;t.archived=false;break;case"form":t.userFormId=0;t.formType="form";break;case"mailing":t.mailingId=0;t.skipEmptyBlocks=false;t.doubleCheck=true;break;case"actionbased_mailing":case"datebased_mailing":case"mailing_mediatype_sms":case"mailing_mediatype_post":t.mailingId=0;break;case"followup_mailing":t.baseMailingId=0;t.mailingId=0;t.decisionCriterion="OPENED";break;case"import":case"export":t.importexportId=0;t.errorTolerant=false;break}return i}static isExpandableType(e){switch(e){case"scABTest":case"scBirthday":case"scDOI":case"ownWorkflow":return true;default:return false}}static deserialize(e){var n=$.extend({},e);var t=new c(e.type,n);t.setId(e.id);t.setCoordinates(e.x,e.y);t.setTitle(e.iconTitle);t.setComment(e.iconComment);t.setFilled(e.filled);t.setEditable(e.editable);if(["ownWorkflow","scBirthday","scDOI","scABTest"].includes(e.type)){t.setExpandable(true)}delete n["id"];delete n["x"];delete n["y"];delete n["type"];delete n["iconTitle"];delete n["filled"];delete n["editable"];["date","remindDate","decisionDate"].forEach(function(e){if(n[e]){var t=n[e].toString();if(t.includes("-")){var i=t.split("-");n[e]=new Date(i[0],i[1]-1,i[2])}else{n[e]=new Date(n[e])}}});return t}static deserializeConnections(e,n){var r=[];e.forEach(function(e){var i=n[e.id];if(i instanceof c){if(e.connections){e.connections.forEach(function(e){var t=n[e.targetIconId];if(t instanceof c){r.push({source:i,target:t})}})}}});return r}static toMap(e){var t={};e.forEach(function(e){t[e.getId()]=e});return t}appendTo(e,t,i){this.$container=e;this.$titlesContainer=t;if(i){this.$element.addClass(i)}e.append(this.$element);t.append(this.$titleDiv);this.$titleDiv.toggleClass("expandable",this.$titleSpan.height()>this.$titleDiv.height())}isAppended(){return!!this.$container}get$(){return this.$element}getId(){return this.id}setId(e){this.id=e;this.$element.prop("id",e)}getX(){return this.x}getY(){return this.y}getCoordinates(){return{x:this.x,y:this.y}}setCoordinates(e,t){this.x=e;this.y=t;this.$element.css("left",e*l.CANVAS_GRID_SIZE);this.$element.css("top",t*l.CANVAS_GRID_SIZE)}updateCoordinates(e){var t=c.getPosition(this.$element);this.x=t.x/e/l.CANVAS_GRID_SIZE;this.y=t.y/e/l.CANVAS_GRID_SIZE}getType(){return this.type}setType(e){this.type=e}getTitle(){return this.title}setTitle(e){this.title=e;if(e){this.$titleSpan.text(e);this.positionTitle(this.lastTitleAnchor);this.$titleDiv.toggleClass("expandable",this.$titleSpan.height()>this.$titleDiv.height())}this.setTitleEnabled(!!e)}setTitleEnabled(e){this.$titleDiv.toggle(!!e&&!!this.title)}setTitleExpanded(e){this.$titleDiv.toggleClass("expanded",!!e);if(this.isAppended()){if(e){this.$titleDiv.appendTo(this.$container)}else{this.$titleDiv.appendTo(this.$titlesContainer)}}}positionTitle(e){this.lastTitleAnchor=e;var t=this.x*l.CANVAS_GRID_SIZE;var i=t+l.NODE_SIZE;var n=this.y*l.CANVAS_GRID_SIZE;var r=n+l.NODE_SIZE;switch(e){case l.BOTTOM:this.$titleDiv.css({top:r,left:t+(l.NODE_SIZE-l.TITLE_WIDTH)/2,transform:"none"});break;case l.LEFT:this.$titleDiv.css({top:(n+r)/2,left:t-l.TITLE_WIDTH,transform:"translateY(-50%)"});break;case l.RIGHT:this.$titleDiv.css({top:(n+r)/2,left:i,transform:"translateY(-50%)"});break;case l.TOP:this.$titleDiv.css({top:n,left:t+(l.NODE_SIZE-l.TITLE_WIDTH)/2,transform:"translateY(-100%)"});break;default:return}}getOverlayTitle(){return this.overlayTitle}setOverlayTitle(e){this.overlayTitle=e;this.$overlayTitle.text(_.trim(e))}getOverlayImage(){return this.overlayImage}setOverlayImage(e){this.overlayImage=$.extend({image:"",title:"",visible:false},e);var t=!!_.trim(this.overlayImage.image)?l.constants.imagePath+"/"+_.trim(this.overlayImage.image):"";this.$overlayImage.prop("src",t);this.$overlayImage.prop("title",this.overlayImage.title);if(this.overlayImage.visible){this.$overlayImage.show()}else{this.$overlayImage.hide()}}getComment(){return this.comment}get $commentBtn(){return this.$element.find(".node-comment-button")}setComment(e){this.comment=this.data.iconComment=e;this.updateCommentLabels()}updateCommentLabels(){this.$commentBtn.toggle(!!_.trim(this.comment))}setFootnote(e){if(e>0){this.$element.attr("comment-footnote",e)}else{this.$element.removeAttr("comment-footnote")}}isFilled(){return this.filled}setFilled(e){this.filled=e;this.$element.toggleClass("active",e)}isEditable(){return this.editable}setEditable(e){this.editable=e}isExpandable(){return this.expandable}setExpandable(e){this.expandable=e}isDependent(){return this.dependent}setDependent(e){this.dependent=e}isInRecipientsChain(){return this.inRecipientsChain}setInRecipientsChain(e){this.inRecipientsChain=e}getAnchors(){return this.anchors}setAnchors(e){this.anchors=e}getData(){return this.data}setData(e){this.data=e}setInteractionEnabled(e){this.$connectionButton.toggle(!!e)}removePopover(){this.nodePopover.remove()}setPopoverEnabled(e){if(!e){this.nodePopover._hidePopover(true)}this.nodePopover.setEnabled(e)}setPopoverShown(e){if(e){this.nodePopover.show()}else{this.nodePopover.hide()}}setHovered(e){this.setPopoverShown(e);this.setTitleExpanded(e)}remove(){this.nodePopover.remove();this.$element.remove();this.$titleDiv.remove();this.$container=null;this.$titlesContainer=null}serialize(){var e=$.extend({},this.data,{id:this.id,x:this.x,y:this.y,type:this.type,filled:this.filled,editable:this.editable,iconTitle:this.title});if("date"in e&&"hour"in e&&"minute"in e){e.date=t.getDateTimeValue(e.date,e.hour,e.minute)}if("remindDate"in e&&"remindHour"in e&&"remindMinute"in e){e.remindDate=t.getDateTimeValue(e.remindDate,e.remindHour,e.remindMinute)}if("decisionDate"in e){e.decisionDate=t.getDateTimeValue(e.decisionDate)}return e}}function u(e){if(e instanceof c){this.node=e}else{this.node=c.get(e)}this.popover=undefined;this.timeoutId=undefined;this.isEnabled=true}u.prototype.remove=function(){if(this.popover){this.popover.hide()}n.remove(this.node.get$());this.popover=null};u.destroyAll=function(){$("[rel=popover]").each(function(e,t){c.get($(t)).removePopover()});$(".popover").remove()};u.prototype.initPopover=function(){var e=this;e.deferred=false;e.content=null;var t=n.new(e.node.get$(),{trigger:"manual",html:true,template:l.NODE_POPOVER_TEMPLATE,content:function(){return e.getPopoverContent()}});if(e.isEnabled){t.enable()}else{t.disable()}var i=t.tip();i.on({mouseenter:function(){e._showPopover()},mouseleave:function(){e._hidePopover(true)}});return t};u.prototype.show=function(){u.destroyAll();this.popover=this.initPopover();if(this.popover.hasContent()&&this.popover.enabled){this._showPopover()}};u.prototype.hide=function(e){this._hidePopover(e)};u.prototype.getPopoverContent=function(){const e=this;var t=this.node;var i="";var n=u.getThumbnail(t);if(n&&!_.isEmpty(n.src)){i+='<img src="'+n.src+'" style="width: 100%; height: 100%;" />'}if(c.isCommented(t)){i+="<div>"+t.getComment()+"</div>"}if(i&&e.deferred===false){this.deferred=$.Deferred();var r=$("<div></div>");r.css({position:"fixed",visibility:"hidden"});r.html(i);$elements=r.children();$(document.body).append(r);this.deferred.done(function(){$elements.detach();r.remove();e.content=$elements});var o=$elements.find("img").add($elements.filter("img")).filter(function(){return this.complete?null:this});if(o.length>0){e.deferred.done(function(){if(e.popover){e.popover.setContent();if(t.get$().is(":hover")){e._showPopover()}}});var s=function(){var e=true;for(var t=0;t<o.length;t++){var i=o[t];if(i){if(i.complete){$(i).off("load error");o[t]=null}else{e=false}}}return e};for(var a=0;a<o.length;a++){$(o[a]).on("load error",function(){if(s()){e.deferred.resolve()}})}}else{e.deferred.resolve()}}return this.content};u.getThumbnail=function(e){if(c.isMailingNode(e)&&e.getData().mailingId>0){return u.getMailingThumbnail(e.getData().mailingId)}return""};u.getMailingThumbnail=_.memoize(function(e){var t="";$.ajax({type:"POST",url:AGN.url("/workflow/getMailingThumbnail.action"),async:false,data:{mailingId:e},success:function(e){if(e>0){t=new Image;t.src=AGN.url("/sc?compID="+e)}}});return t});u.prototype._stopHiding=function(){if(this.timeoutId){clearTimeout(this.timeoutId);this.timeoutId=undefined}};u.prototype._showPopover=function(){this._stopHiding();this.popover.show()};u.prototype._hidePopover=function(e){this._stopHiding();if(!this.popover){return}if(e===true){if(this.popover){this.popover.hide()}}else{var t=this;this.timeoutId=setTimeout(function(){t._hidePopover(true)},200)}};u.prototype.setEnabled=function(e){this.isEnabled=e;if(!this.popover){return}if(e){this.popover.enable()}else{this.popover.disable()}};AGN.Lib.WM.NodePopover=u;AGN.Lib.WM.Node=c})();(function(){var n=AGN.Lib.WM.Node;function r(e){this.id=e.getId();this.node=e;this.position=n.getPosition(e.get$());this.box=n.getBox(e.get$());this.connections={incoming:[],outgoing:[]}}r.nodesToVertices=function(e){return e.map(function(e){return new r(e)})};r.verticesToMap=function(e){var t={};e.forEach(function(e){t[e.id]=e});return t};r.verticesFrom=function(e,t){var i=r.nodesToVertices(e);var n=r.verticesToMap(i);t.forEach(function(e){var t,i;if("sourceId"in e){t=n[e.sourceId];i=n[e.targetId]}else{t=n[e.source.getId()];i=n[e.target.getId()]}t.connections.outgoing.push(i);i.connections.incoming.push(t)});return i};r.compareByPosition=function(e,t){var i=e.box;var n=t.box;if(i.minX==n.minX){return i.minY-n.minY}return i.minX-n.minX};r.filterUnvisited=function(e,t){return e.filter(function(e){if(t[e.id]){return false}else{t[e.id]=true;return true}})};r.getDecisionBranches=function(t){var e=t.connections.outgoing.map(function(e){return{source:t.node,target:e.node,targetVertex:e}});var i=n.getDecisionBranches(e);if(i){return{positive:i.positive.targetVertex,negative:i.negative.targetVertex}}return null};r.getIncomingChains=function(e){var t={};var i=[];o([],e,t,i);return i};r.getOutgoingChains=function(e){var t={};var i=[];s([],e,t,i);return i};r.prototype.getNode=function(){return this.node};r.prototype.siblings=function(){return this.connections.incoming.concat(this.connections.outgoing)};r.prototype.rightSiblingsOrdered=function(){var e=this.connections.outgoing;if(n.isBranchingDecisionNode(this.node)){var t=r.getDecisionBranches(this);if(t){return[t.positive,t.negative]}}return e.sort(function(e,t){return e.node.getY()-t.node.getY()})};function o(t,e,i,n){if(i[e.id]){n.push(t)}else{t.push(e.node);var r=e.connections.incoming;if(r.length){i[e.id]=true;if(r.length==1){o(t,r[0],i,n)}else{r.forEach(function(e){o(t.slice(),e,i,n)})}i[e.id]=false}else{n.push(t)}}}function s(t,e,i,n){if(i[e.id]){n.push(t)}else{t.push(e.node);var r=e.connections.outgoing;if(r.length){i[e.id]=true;if(r.length==1){s(t,r[0],i,n)}else{r.forEach(function(e){s(t.slice(),e,i,n)})}i[e.id]=false}else{n.push(t)}}}AGN.Lib.WM.Vertex=r})();(function(){var r=AGN.Lib.WM.Vertex;function o(e){this.vertices=e;this.box=e.map(function(e){return e.box}).reduce(function(e,t){return{minX:Math.min(e.minX,t.minX),minY:Math.min(e.minY,t.minY),maxX:Math.max(e.maxX,t.maxX),maxY:Math.max(e.maxY,t.maxY)}})}o.detectGroups=function(e){var i=[];var n={};e.forEach(function(e){var t=o.detectGroup(e,n);if(t){i.push(t)}});return i.sort(o.compareByPosition)};o.detectGroup=function(e,t){if(t[e.id]){return null}var i=[];var n=e.siblings();i.push(e);t[e.id]=true;while(n.length){n=_.flatMap(n,function(e){if(t[e.id]){return[]}else{i.push(e);t[e.id]=true;return e.siblings()}})}return new o(i)};o.compareByPosition=function(e,t){var i=e.box.minX+e.box.maxX-(t.box.minX+t.box.maxX);if(i==0){return e.box.minY+e.box.maxY-(t.box.minY+t.box.maxY)}return i};o.prototype.getNodes=function(){return this.vertices.map(function(e){return e.getNode()})};o.prototype.getStartingVertices=function(){var e=this.vertices.filter(function(e){return e.connections.incoming.length==0});if(e.length){return e.sort(r.compareByPosition)}var t=this.vertices.reduce(function(e,t){var i=e.connections.outgoing.length/e.connections.incoming.length;var n=t.connections.outgoing.length/t.connections.incoming.length;if(i==n){return r.compareByPosition(e,t)>=0?e:t}return i>n?e:t});return[t]};AGN.Lib.WM.VertexGroup=o})();(function(){var s=AGN.Lib.WM.Definitions,n=AGN.Lib.WM.DateTimeUtils;var r={};var a=function(){};function i(t,e,i){if(e<=0){return""}if(_.isEmpty(r[t])){$.ajax({url:AGN.url(i),async:false}).done(function(e){r[t]=_.extend({},e)})}var n=r[t][e];return!!n?n:""}a.getWebFormName=function(e){return i("form",e,"/workflow/ajax/getWebFormNames.action")};a.getTargetName=function(e){return i("target",e,"/workflow/ajax/getTargetNames.action")};a.getMailingName=function(e){return i("mailing",e,"/workflow/ajax/getMailingNames.action")};a.getArchiveName=function(e){return i("archive",e,"/workflow/ajax/getArchiveNames.action")};a.getAutoExportName=function(e){return i("autoExport",e,"/workflow/ajax/getAutoExportNames.action")};a.getAutoImportName=function(e){return i("autoImport",e,"/workflow/ajax/getAutoImportNames.action")};a.getMailinglistName=function(e){return i("mailinglist",e,"/workflow/ajax/getMailinglistNames.action")};function o(e){switch(e){case s.constants.reactionOpened:return"reaction_opened.png";case s.constants.reactionNotOpened:return"reaction_notopened.png";case s.constants.reactionClicked:return"reaction_clicked.png";case s.constants.reactionNotClicked:return"reaction_notclicked.png";case s.constants.reactionBought:return"reaction_bought.png";case s.constants.reactionNotBought:return"reaction_notbought.png";case s.constants.reactionChangeOfProfile:return"reaction_profilechange.png";case s.constants.reactionWaitingForConfirm:return"reaction_wfc.png";case s.constants.reactionOptIn:return"reaction_optin.png";case s.constants.reactionOptOut:return"reaction_optout.png";case s.constants.reactionClickedLink:return"reaction_clicked.png";case s.constants.reactionOpenedAndClicked:return"reaction_profilechange.png";case s.constants.reactionOpenedOrClicked:return"reaction_profilechange.png"}}function l(e){switch(e){case s.constants.reactionOpened:return t("workflow.reaction.opened");case s.constants.reactionNotOpened:return t("workflow.reaction.not_opened");case s.constants.reactionClicked:return t("workflow.reaction.clicked");case s.constants.reactionNotClicked:return t("workflow.reaction.not_clicked");case s.constants.reactionBought:return t("workflow.reaction.bought");case s.constants.reactionNotBought:return t("workflow.reaction.not_bought");case s.constants.reactionChangeOfProfile:return t("workflow.reaction.change_of_profile");case s.constants.reactionWaitingForConfirm:return t("workflow.reaction.waiting_for_confirm");case s.constants.reactionOptIn:return t("workflow.reaction.opt_in");case s.constants.reactionOptOut:return t("workflow.reaction.opt_out");case s.constants.reactionClickedLink:return t("workflow.reaction.clicked_on_link");case s.constants.reactionOpenedAndClicked:return t("workflow.reaction.opened_and_clicked");case s.constants.reactionOpenedOrClicked:return t("workflow.reaction.opened_or_clicked")}}function c(e,i){if(e>1){switch(i){case s.constants.deadlineTimeUnitMinute:return t("workflow.deadline.minutes");case s.constants.deadlineTimeUnitHour:return t("workflow.defaults.hours");case s.constants.deadlineTimeUnitDay:return t("workflow.defaults.days");case s.constants.deadlineTimeUnitWeek:return t("workflow.defaults.weeks");case s.constants.deadlineTimeUnitMonth:return t("workflow.defaults.months")}}else{switch(i){case s.constants.deadlineTimeUnitMinute:return t("workflow.deadline.minute");case s.constants.deadlineTimeUnitHour:return t("workflow.defaults.hour");case s.constants.deadlineTimeUnitDay:return t("workflow.defaults.day");case s.constants.deadlineTimeUnitWeek:return t("workflow.defaults.week");case s.constants.deadlineTimeUnitMonth:return t("workflow.defaults.month")}}}function u(e){switch(e){case s.constants.decisionAOCriteriaClickRate:return t("workflow.defaults.ckickrate");case s.constants.decisionAOCriteriaOpenrate:return t("workflow.opening_rate");default:return t("workflow.statistic.revenue")}}function d(e){switch(Number(e)){case 1:return")";case 0:return""}}function h(e){switch(Number(e)){case 1:return"(";case 0:return""}}function f(e,t){if(e&&s.GENDER_PROFILE_FIELD===e.toLowerCase()){return s.constants.genderOptions[!t?0:t]}else{return _.isEmpty(t)?"":t}}function p(i,e){var n="";e.forEach(function(e){n+=(_.isEmpty(n)?"":" "+e.chainOperator+" ")+h(e.parenthesisOpened)+i+" "+s.constants.operatorsMap[e.primaryOperator]+" "+f(i,e.primaryValue)+d(e.parenthesisClosed)});return t("workflow.start.rule")+(!!n?": "+n:"")}function g(e,i){var n=[];for(var r=0;r<s.TITLE_MAX_TARGETS&&r<e.length;r++){n.push(a.getTargetName(e[r]))}var o=", ";if(s.constants.targetOptions[i]){o=" "+s.constants.targetOptions[i]+" "}if(e.length>s.TITLE_MAX_TARGETS){return n.join(o)+" "+t("defaults.andMore",e.length-s.TITLE_MAX_TARGETS)+"..."}else{return n.join(o)}}function m(e,t,i){if(e){if(arguments.length===1){return n.getDateStr(e,s.constants.localeDateTimePattern)}else{return n.getDateTimeStr(e,t,i,s.constants.localeDateTimePattern)}}else{return""}}function v(e,t){return e+" "+c(e,t)}function y(e,i){return t("workflow.reaction.title")+": "+l(e)+",\n"+t("workflow.defaults.mailing")+": "+a.getMailingName(i)}function b(e,i,n){var r=u(e)+(_.isEmpty(i)?"":": "+i)+"\n";if(!!n){r+=t("workflow.defaults.date")+": "+m(n)}return r}function w(e,t,i){return e+" "+s.constants.operatorsMap[t]+(!i?"":" "+i)}function C(e,t,i){if(e){if(t){return t+" ("+l(i)+") "+e}else{return e}}}function x(e,i,n,r){var o="";if(r){o+=t("workflow.mailinglist.short")+": "+a.getMailinglistName(e)}if(!_.isEmpty(i)){if(!_.isEmpty(o)){o+="\n"}o+=t("workflow.target.short")+": "+g(i,n)}return o}a.positionTitle=function(e,t){if(t[s.BOTTOM]){if(t[s.LEFT]){if(t[s.RIGHT]){if(t[s.TOP]){e.positionTitle(s.BOTTOM)}else{e.positionTitle(s.TOP)}}else{e.positionTitle(s.RIGHT)}}else{e.positionTitle(s.LEFT)}}else{e.positionTitle(s.BOTTOM)}};var e=function(e){var i=e.startType;var n="";if(s.constants.startTypeDate===i){n=t("workflow.start.start_date")+":\n"+m(e.date,e.hour,e.minute)}else if(s.constants.startTypeEvent===i){var r=e.event;if(s.constants.startEventReaction===r){n=t("workflow.start.start_event")+":\n"+l(e.reaction)+": ("+m(e.date,e.hour,e.minute)+")"}else if(s.constants.startEventDate===r){n=t("workflow.start.start_event")+":\n"+w(e.dateProfileField,e.dateFieldOperator,e.dateFieldValue)+":\n"+"("+m(e.date,e.hour,e.minute)+")"}}return n};var S=function(e,i,n){var r=e.endType;var o="";if(s.constants.endTypeDate===r){o=t("workflow.stop.end_date")+":\n"+m(e.date,e.hour,e.minute)}else if(s.constants.endTypeAutomatic===r){o=n?t("workflow.stop.automatic_end"):t("workflow.stop.open_end")}return o};var A=function(e){var i=e.deadlineType;var n="";if(s.constants.deadlineTypeFixedDeadline===i){n=t("workflow.deadline.title")+":\n"+m(e.date,e.hour,e.minute)}else if(s.constants.deadlineTypeDelay===i){n=t("workflow.defaults.delay")+":\n"+v(e.delayValue,e.timeUnit)}return n};var E=function(e){var i=e.decisionType;var n="";if(s.constants.decisionTypeAutoOptimization===i){n=t("workflow.mailing.autooptimization")+":\n"+b(e.aoDecisionCriteria,e.threshold,e.decisionDate)}else{if(s.constants.decisionReaction===e.decisionCriteria){n=t("workflow.decision")+",\n"+y(e.reaction,e.mailingId)}else{n=t("workflow.decision")+",\n"+p(e.profileField,e.rules)}}return n};var T=function(e,t){var i,n;var r=t.getTitle();i=a.getMailingName(e.baseMailingId)||"?";n=a.getMailingName(e.mailingId)||"?";var o=C(n,i,e.decisionCriterion);if(o){r=o}return r};var D={title:function(e){return a.getMailingName(e.mailingId)}};var R={"*":{overlayImage:{},overlayTitle:"",title:""},start:{title:e,isImageAvailable:function(e){return s.constants.startTypeEvent===e.startType&&s.constants.startEventReaction===e.event},overlayImage:function(e){if(this.isImageAvailable(e)){return{visible:true,image:o(e.reaction),title:l(e.reaction)}}else{return{}}}},stop:{title:S},deadline:{title:A},parameter:{title:"",overlayTitle:function(e){return e.value}},decision:{title:E,branches:{title:function(){return{positive:t("workflow.defaults.yes"),negative:t("workflow.defaults.no")}}}},recipient:{title:function(e,t){return x(e.mailinglistId,e.targets,e.targetsOption,!t.isInRecipientsChain())}},archive:{title:function(e){return a.getArchiveName(e.campaignId)}},form:{title:function(e){return a.getWebFormName(e.userFormId)}},mailing:D,mailing_mediatype_sms:D,mailing_mediatype_post:D,actionbased_mailing:D,datebased_mailing:D,followup_mailing:{title:T},import:{title:function(e){return a.getAutoImportName(e.importexportId)}},export:{title:function(e){return a.getAutoExportName(e.importexportId)}}};function M(e){var t=e.getType();if(s.NODE_TYPES_MAILING.includes(t)||s.NODE_TYPES_IMPORT_EXPORT.includes(t)){return!!e.getTitle()}return false}a.getDecisionBranchesLabels=function(){return R.decision.branches.title()};a.updateTitle=function(e,t,i){if(!i&&M(e)){return}if(!e.isFilled()){e.setTitle("");e.setOverlayImage({});e.setOverlayTitle("");return}e.setTitle(N(e,t));e.setOverlayImage(k(e));e.setOverlayTitle(O(e))};function k(e){return I(e.getType(),"overlayImage",e.getData())}function O(e){return I(e.getType(),"overlayTitle",e.getData())}function N(e,t){return I(e.getType(),"title",e.getData(),e,t)}function I(e,t){var i=R[e];if(!i.hasOwnProperty(t)){i=R["*"]}var n=i[t];var r=Array.prototype.slice.call(arguments,2);return _.isFunction(n)?n.apply(i,r):n}AGN.Lib.WM.NodeTitleHelper=a})();(function(){const n=AGN.Lib.WM.Node;const l=AGN.Lib.WM.Definitions;class i{constructor(e,t){this.minimap=e;this.$element=e.$container.find(t);this.scale=1}setScale(e){this.scale=e}getScale(){return this.scale}getPosition(){var e=this.$element.position();return{x:e.left,y:e.top}}update(){this.reset();var e=this.minimap.getPureIconsBox();var t=l.MINIMAP_PADDING*2;var i=e.maxX-e.minX+t;var n=e.maxY-e.minY+t;var r=(this.minimap.getWidth()-t)/i;var o=(this.minimap.getHeight()-t)/n;this.setScale(Math.min(r,o));var s=-e.minX*this.scale+l.MINIMAP_PADDING;var a=-e.minY*this.scale+l.MINIMAP_PADDING;this.$element.css({transform:"scale("+this.scale+")",width:i,height:n,left:s,top:a});this.renderIcons()}renderIcons(){var i=this;this.minimap.getPureIconsPosition().forEach(function(e){var t=$('<div class="miniview-element"></div>').css({width:l.NODE_SIZE,height:l.NODE_SIZE,left:e.x,top:e.y});i.$element.append(t)})}reset(){this.scale=1;this.$element.css({transform:"scale(1)",width:0,height:0,left:0,top:0});this.$element.html("")}}class r{constructor(e,t,i){this.minimap=e;this.$element=e.get$().find(t);this.onDrag=_.isFunction(i.onPannerDrag)?i.onPannerDrag:_.noop;this.containment=$.extend({mode:"",padding:0},i.containment);this.containmentBox=null;var a=this;var l=0;var c=0;this.$element.draggable({start:function(e,t){l=t.position.left;c=t.position.top;if(!a.containmentBox){a.containmentBox=a.getContainmentBox(a.containment)}},drag:function(e,t){var i=a.getScale();if(a.containmentBox){var n=t.position.left;var r=t.position.top;if(n<a.containmentBox.minX){t.position.left=a.containmentBox.minX}else if(n>a.containmentBox.maxX){t.position.left=a.containmentBox.maxX}if(r<a.containmentBox.minY){t.position.top=a.containmentBox.minY}else if(r>a.containmentBox.maxY){t.position.top=a.containmentBox.maxY}}var o=(l-t.position.left)/i;var s=(c-t.position.top)/i;l=t.position.left;c=t.position.top;a.onDrag.call(a,o,s)}})}getContainmentBox(e){if(!e.mode||e.mode=="none"){return undefined}var t=this.minimap.get$();var i=this.getScaledWidth();var n=this.getScaledHeight();if(e.mode=="panner-box"){return{minX:-i+e.padding,maxX:t.width()-e.padding,minY:-n+e.padding,maxY:t.height()-e.padding}}else if(e.mode=="minimap-box"){return{minX:e.padding,maxX:Math.max(0,t.width()-i)-e.padding,minY:e.padding,maxY:Math.max(0,t.height()-n)-e.padding}}return undefined}getScale(){return this.minimap.getMiniCanvasScale()/this.minimap.getCanvasZoom()}getScaledWidth(){return this.getWidth()*this.getScale()}getScaledHeight(){return this.getHeight()*this.getScale()}getWidth(){return this.$element.width()}getHeight(){return this.$element.height()}update(){var e=this.minimap.getCanvasParent$();var t=e.width();var i=e.height();var n=t+l.MINIMAP_PADDING*2;var r=i+l.MINIMAP_PADDING*2;this.$element.css({width:n,height:r});this.containmentBox=this.getContainmentBox(this.containment);this.updatePosition()}updatePosition(){var e=this.minimap.getCanvasPosition();var t=this.minimap.getMiniCanvasPosition();var i=this.getScale();var n=-e.x*i+t.x;var r=-e.y*i+t.y;this.$element.css({transform:"scale("+i+")",left:n,top:r})}}class e{constructor(e,t){this.$container=$("#minimap");this.canvas=e;this.$collapseBtn=this.$container.find(".minimap-collapse");this.miniCanvas=new i(this,".minimap-canvas",t);this.miniPanner=new r(this,".minimap-panner",t);this.enabled=false;this.$container.on("click",".minimap-panner, .minimap-collapse",function(e){e.preventFocusOnArea=true});this.$container.on("click",e=>this.moveToClickPos(e))}moveToClickPos(e){if(e.preventFocusOnArea){return}const t=this.$container[0].getBoundingClientRect();const i=e.clientX-t.left;const n=e.clientY-t.top;this.focusOnClickedArea(i,n)}get$(){return this.$container}getWidth(){return this.get$().width()}getHeight(){return this.get$().height()}moveCanvasTo(e,t){this.canvas.moveTo(e,t)}getCanvas$(){return this.canvas.get$()}getCanvasParent$(){return this.canvas.get$().parent()}focusOnClickedArea(e,t){var i=this.getMiniCanvasPosition();var n=this.getMiniPannerScale();var r=(e-i.x)/n;var o=(t-i.y)/n;var s=this.getMiniPannerCenter();var a=this.getCanvasZoom();var l=(r-s.x)*a;var c=(o-s.y)*a;this.moveCanvasTo(-l,-c)}collapseMinimap(){this.$container.toggleClass("minimap-collapsed");this.updateMinimap()}getIcons(){return this.canvas.getIcons()}getPureIconsPosition(){var i=this.getCanvasZoom();return this.getIcons().map(function(e){var t=n.getPosition(e);return{x:t.x/i,y:t.y/i}})}getPureIconsBox(){return this.canvas.getPureIconsBox()}getMiniCanvasScale(){return this.miniCanvas.getScale()}getMiniCanvasPosition(){return this.miniCanvas.getPosition()}getMiniPannerScale(){return this.miniCanvas.getScale()}getMiniPannerCenter(){return{x:this.miniPanner.getWidth()/2,y:this.miniPanner.getHeight()/2}}getCanvasZoom(){return this.canvas.getZoom()}getCanvasPosition(){return this.canvas.getPosition()}updateMinimap(){if(this.enabled){this.miniCanvas.update();this.miniPanner.update()}}onPanZoom(){if(this.enabled){this.miniPanner.updatePosition()}}setEnabled(e){this.enabled=e;if(e){this.updateMinimap();this.get$().show()}else{this.get$().hide()}}}AGN.Lib.WM.Minimap=e})();(function(){var p=AGN.Lib.WM.Definitions,r=AGN.Lib.WM.Node,t=AGN.Lib.WM.Minimap;var e=function(e){var n=this;this.$canvas=e;this.mouseWheelZoomEnabled=false;this.panningEnabled=false;this.zoomEventHandler=null;this.moveEventHandler=null;this.ignoreNextZoomEvent=false;this.minimap=new t(this,{containment:{mode:"panner-box",padding:5},onPannerDrag:function(e,t){if(e||t){var i=n.getPosition();n.moveTo(i.x+e,i.y+t)}}});this.panzoom=panzoom(e[0],{minZoom:p.MIN_ZOOM,maxZoom:p.MAX_ZOOM,initialZoom:p.DEFAULT_ZOOM,disableKeyboardInteraction:true,smoothScroll:false,onDoubleClick:function(){return false},beforeWheel:function(){return!n.mouseWheelZoomEnabled},beforeMouseDown:function(){return!n.panningEnabled}});this.panzoom.on("zoom",function(){if(n.zoomEventHandler){if(n.ignoreNextZoomEvent){n.ignoreNextZoomEvent=false}else{n.zoomEventHandler.call(null,n.getZoom());n.minimap.onPanZoom()}}});this.panzoom.on("pan",function(){n.minimap.onPanZoom();if(n.moveEventHandler){n.moveEventHandler.call(null,n.getPosition())}})};e.prototype.get$=function(){return this.$canvas};e.prototype.setMinimapEnabled=function(e){this.minimap.setEnabled(e)};e.prototype.updateMinimap=function(){this.minimap.updateMinimap()};e.prototype.setPanningEnabled=function(e){this.panningEnabled=!!e};e.prototype.setMouseWheelZoomEnabled=function(e){this.mouseWheelZoomEnabled=e};e.prototype.getZoom=function(){var e=this.panzoom.getTransform();return e.scale};e.prototype.getPosition=function(){var e=this.panzoom.getTransform();return{x:e.x,y:e.y}};e.prototype.getVisibleArea=function(){var e=this.$canvas.parent();var t=e.width();var i=e.height();var n=this.panzoom.getTransform();return{minX:-n.x/n.scale,minY:-n.y/n.scale,maxX:(t-n.x)/n.scale,maxY:(i-n.y)/n.scale}};e.prototype.moveTo=function(e,t){this.panzoom.moveTo(e,t)};e.prototype.setZoom=function(e){var t=this.panzoom.getTransform();this.ignoreNextZoomEvent=true;this.panzoom.zoomAbs(t.x,t.y,e);this.minimap.onPanZoom()};e.prototype.setOnZoom=function(e){this.zoomEventHandler=e};e.prototype.setOnMove=function(e){this.moveEventHandler=e};e.prototype.getCanvasParent$=function(){return this.get$().parent()};e.prototype.getIcons=function(){var i=[];this.get$().children(".node").each(function(e,t){i.push($(t))});return i};e.prototype.getPureIconsBox=function(){var e=this.getIcons();var t=this.getZoom();if(e.length){var i=e.map(function(e){return r.getBox(e)}).reduce(function(e,t,i){return{minX:Math.min(e.minX,t.minX),minY:Math.min(e.minY,t.minY),maxX:Math.max(e.maxX,t.maxX),maxY:Math.max(e.maxY,t.maxY)}});return{minX:i.minX/t-p.CANVAS_GRID_SIZE,minY:i.minY/t-p.CANVAS_GRID_SIZE,maxX:i.maxX/t+p.CANVAS_GRID_SIZE,maxY:i.maxY/t+p.CANVAS_GRID_SIZE}}else{var n=this.getCanvasParent$();return{minX:-p.CANVAS_GRID_SIZE,minY:-p.CANVAS_GRID_SIZE,maxX:n.width()/t+p.CANVAS_GRID_SIZE,maxY:n.height()/t+p.CANVAS_GRID_SIZE}}};e.prototype.fitPdfPage=function(e,t){var i=this.getPureIconsBox();var n=i.maxX-i.minX+p.NODE_MIN_MARGIN;var r=i.maxY-i.minY+p.NODE_MIN_MARGIN;if(!p.PAGE_DIMENSIONS[e]){return}var o=p.PAGE_DIMENSIONS[e];var s=t=="landscape";var a=s?o.height:o.width;var l=s?o.width:o.height;var c=0;var u=0;var d=1;if(n>a||r>l){if(n/r<a/l){d=l/r}else{d=a/n}}if(i.minX<0){c=-i.minX*d}if(i.minY<0){u=-i.minY*d}var h="matrix("+d+", 0, 0, "+d+", "+c+", "+u+")";var f="left top 0";this.getCanvasParent$().css({transform:h,"-webkit-transform":h,"transform-origin":f,"-webkit-transform-origin":f,"backface-visibility":"hidden","-webkit-backface-visibility":"hidden",overflow:"visible"})};AGN.Lib.WM.Canvas=e})();(function(){var i=AGN.Lib.WM.Definitions,n=AGN.Lib.Confirm;var e={Activation:r,Deactivation:o,confirmTestingStartStop:l,confirmMailingDataTransfer:s,confirmOwnWorkflowExpanding:a,confirmCopy:c};function r(e,i,n){var r=$("#activating-campaign-dialog");if(!n){$("#activating-campaign-mailings").html(i)}r.css("visibility","visible");r.show();var o=$("#activating-campaign-activate-button");o.off("click");o.on("click",function(){e();r.dialog("close");return false});r.dialog({open:function(){var e=r.parent().find(".ui-dialog-title");e.empty();e.append('<span class="dialog-title-image">'+t(n?"workflow.activating.unpauseTitle":"workflow.activating.title")+"</span>");e.find(".dialog-title-image").css("padding-left","0px")},modal:true,resizable:false,width:650,minHeight:0,close:function(){return false}})}function o(e){var i=$("#inactivating-campaign-dialog");i.css("visibility","visible");i.show();var n=$("#inactivating-campaign-inactivate-button");n.off("click");n.on("click",function(){e();i.dialog("close");return false});i.dialog({open:function(){var e=i.parent().find(".ui-dialog-title");e.empty();e.append('<span class="dialog-title-image">'+t("workflow.inactivating.title")+"</span>");e.find(".dialog-title-image").css("padding-left","0px")},modal:true,resizable:false,width:650,minHeight:0,close:function(){return false}})}function s(e){return n.createFromTemplate({Def:i,paramsToAsk:e},"mailing-data-transfer-modal")}function a(){return n.createFromTemplate({},"own-workflow-expanding-modal")}function l(e){return n.createFromTemplate({startTesting:e,shortname:i.shortname},"testing-modal")}function c(e){return n.createFromTemplate({hasContent:e===true},"workflow-copy-modal")}AGN.Lib.WM.Dialogs=e})();(function(){var a=AGN.Lib.WM.Definitions,r=AGN.Lib.WM.Node;var e={};e.loadSample=function(e,t,i){if([a.NODE_TYPE_SC_ABTEST,a.NODE_TYPE_SC_BIRTHDAY,a.NODE_TYPE_SC_DOI].includes(e)){$.ajax({url:AGN.url("/workflow/getSampleWorkflowContent.action"),type:"POST",async:false,data:{type:e,gridEnabled:t},success:n(i)})}else{console.error("Unknown sample type: "+e)}};e.loadOwnWorkflow=function(e,t,i){$.ajax({url:AGN.url("/workflow/getWorkflowContent.action"),type:"POST",async:false,data:{workflowId:e,isWithContent:t},success:n(i)})};e.removeStartStop=function(e,t,i,n){if(i||n){var r=[];var o=e.filter(function(e){var t=e.getType();if(i&&t===a.NODE_TYPE_START||n&&t===a.NODE_TYPE_STOP){r.push(e);return false}else{return true}});if(o.length<e.length){Array.prototype.splice.apply(e,[0,e.length].concat(o));var s=t.filter(function(e){return!(r.includes(e.source)||r.includes(e.target))});if(s.length<t.length){Array.prototype.splice.apply(t,[0,t.length].concat(s))}}}};e.adjustPositions=function(e,t,i,n){var r=0,o=0;if(n){var s=h(e);r=s.getX();o=s.getY()}else{var a=0,l=0,c=0,u=0;var d=true;e.forEach(function(e){if(d){a=l=e.getX();c=u=e.getY();d=false}else{a=Math.min(a,e.getX());l=Math.max(l,e.getX());c=Math.min(c,e.getY());u=Math.max(u,e.getY())}});r=Math.round((a+l)/2);o=Math.round((c+u)/2)}e.forEach(function(e){e.setCoordinates(t+e.getX()-r,i+e.getY()-o)})};function n(n){return function(e){var t=e.map(r.deserialize);var i=r.deserializeConnections(e,r.toMap(t));n.call(null,t,i)}}function h(e){var t=e.filter(function(e){return a.NODE_TYPE_START==e.getType()});if(t.length==0){t=e}if(t.length>1){return t.reduce(function(e,t){if(e.getX()==t.getX()){return e.getY()<t.getY()?e:t}else{return e.getX()<t.getX()?e:t}})}else{return t[0]}}AGN.Lib.WM.Snippets=e})();(function(){var l=AGN.Lib.WM.Definitions,r=AGN.Lib.WM.Node;var e=".js-draggable-button";function o(e,t){var i=r.getCollisionBox(t.helper);return e.some(function(e){return r.detectBoxCollision(i,e)})}function t(s){this.enabled=!!s.enabled;this.$buttons=$(e);var a=this;this.$buttons.each(function(){var e=$(this);var t=e.data("type");var n=[];e.draggable({revert:true,revertDuration:0,zIndex:l.Z_INDEX_DRAGGABLE_BUTTON,disabled:!a.enabled,cursorAt:function(){var e=this.helper[0].getBoundingClientRect();return[e.width/2-1,e.height/2]},appendTo:"#canvas",helper:function(){return r.createDraggable$(t)},start:function(){n=s.getOccupiesAreas.call(a);s.onStart.call(a)},stop:function(){s.onStop.call(a)},drag:function(e,t){var i=s.getZoom.call(a);t.position.left=Math.round(t.position.left/i/l.CANVAS_GRID_SIZE)*l.CANVAS_GRID_SIZE;t.position.top=Math.round(t.position.top/i/l.CANVAS_GRID_SIZE)*l.CANVAS_GRID_SIZE;t.helper.toggleClass("js-collision-detected",o(n,t,i))}}).on("dblclick",function(){if(a.enabled){s.onDrop.call(a,t)}})});$("#viewPort").droppable({accept:e,tolerance:"fit",drop:function(e,t){if(t.helper.hasClass("js-collision-detected")){return}var i=s.getZoom.call(a);var n=$("#canvas").offset();var r=Math.round((t.offset.left-n.left)/i);var o=Math.round((t.offset.top-n.top)/i);s.onDrop.call(a,t.helper.data("type"),{x:Math.round(r/l.CANVAS_GRID_SIZE),y:Math.round(o/l.CANVAS_GRID_SIZE)})}})}t.prototype.setEnabled=function(e){this.enabled=!!e;this.$buttons.draggable("option","disabled",!e)};AGN.Lib.WM.DraggableButtons=t})();(function(){var s=AGN.Lib.WM.Definitions,o=AGN.Lib.WM.Vertex,r=AGN.Lib.WM.VertexGroup;function a(e,t){this.layers=e;this.height=t}a.fromVertexGroup=function(e){var t=[];var i={};var n=o.filterUnvisited(e.getStartingVertices(),i);var r=0;while(n.length){r=Math.max(r,n.length);t.push(n);n=_.flatMap(n,function(e){return o.filterUnvisited(e.rightSiblingsOrdered(),i)})}return new a(t,r)};a.prototype.align=function(n,r){var o=null;this.layers.forEach(function(e){var t=Math.max(Math.round(s.AUTO_ALIGN_STEP_Y*(r-e.length)/2),1);if(o){var i=Math.abs(o.length-e.length);if(i>1){n+=Math.round(s.AUTO_ALIGN_EXTRA_STEP_X*i)}}e.forEach(function(e){e.node.setCoordinates(n,t);t+=s.AUTO_ALIGN_STEP_Y});n+=s.AUTO_ALIGN_STEP_X;o=e});return n};function e(e){var t=r.detectGroups(e).map(function(e){return a.fromVertexGroup(e)});var i=0;t.forEach(function(e){i=Math.max(i,e.height)});var n=1;t.forEach(function(e){n=e.align(n,i);n+=s.AUTO_ALIGN_STEP_BETWEEN_GROUPS})}AGN.Lib.WM.AutoAlignment={align:e}})();(function(){var i=AGN.Lib.WM.Definitions,n=AGN.Lib.WM.Node;function r(e){this.maxLength=e;this._undoStack=[];this._transactionStack=[];this._transaction=false}r.prototype.add=function(e){while(this._undoStack.length>=this.maxLength){this._undoStack.shift()}this._undoStack.push(e)};r.prototype.pop=function(){return this._undoStack.pop()};r.prototype.addOperation=function(e){this._transactionStack.push(e)};r.prototype.isEmpty=function(){return _.isEmpty(this._undoStack)};r.prototype.startTransaction=function(){this._transaction=true};r.prototype.endTransaction=function(){this.flush();this._transaction=false};r.prototype.flush=function(){if(!_.isEmpty(this._transactionStack)){this.add(this._transactionStack)}this._transactionStack=[]};r.prototype.isTransactionStarted=function(){return this._transaction===true};function e(e,t){this.editor=e;this.undoOperations={nodeAdded:this.undoAddNode,nodeDeleted:this.undoDeleteNode,nodeMoved:this.undoMoveNode,nodeDataUpdated:this.undoSaveNodeData,connectionCreated:this.undoCreateConnection,connectionDeleted:this.undoDeleteConnection};this.manualStart=false;this.undoStack=new r(i.MAX_UNDO_STEP);this.onChange=_.isFunction(t.onChange)?t.onChange:_.noop}e.prototype.undoAddNode=function(e){this.editor.deleteNode(e)};e.prototype.undoDeleteNode=function(e){if(e instanceof n){this.editor.add(n.restore(e))}else{this.editor.add(n.get(e))}};e.prototype.undoCreateConnection=function(e){this.editor.deleteConnectionBetween(e.source,e.target)};e.prototype.undoDeleteConnection=function(e){this.editor.connect(n.get(e.source),n.get(e.target))};e.prototype.undoMoveNode=function(e){var n=this.editor.getZoom();var r=this;e.forEach(function(e){e.node.setTitleEnabled(false)});this.editor.batch(function(){e.forEach(function(e){var t=e.coordinates;var i=e.node;if(r.editor.getCurrentDragMode()!==e.dragMode){r.editor.convertCoordinates(t)}i.setCoordinates(t.x,t.y);i.updateCoordinates(n)});r.editor.updateOverlays();r.editor.positionTitles();r.editor.updateMinimap()});e.forEach(function(e){e.node.setTitleEnabled(true)})};e.prototype.undoSaveNodeData=function(e,t){t=t instanceof n?t:n.get(t);e=e instanceof n?e:n.get(e);e.setTitle(t.getTitle());e.setOverlayTitle(t.getOverlayTitle());e.setOverlayImage(t.getOverlayImage());e.setComment(t.getComment());e.setFilled(t.isFilled());e.setDependent(t.isDependent());e.setInRecipientsChain(t.isInRecipientsChain());e.setData(t.getData());this.editor.positionTitles()};e.prototype.canUndo=function(){return!this.undoStack.isEmpty()};e.prototype.startTransaction=function(){this.manualStart=true;this.undoStack.startTransaction()};e.prototype.endTransaction=function(){this.undoStack.endTransaction();this.onChange();this.manualStart=false};e.prototype.transaction=function(e){if(_.isFunction(e)){if(!this.undoStack.isTransactionStarted()){this.manualStart=false;this.undoStack.startTransaction()}e.call();if(!this.manualStart){this.undoStack.endTransaction()}this.onChange()}};e.prototype.operation=function(e){if(this.undoStack.isTransactionStarted()){var t=[].slice.call(arguments);t.shift();this.undoStack.addOperation({operation:e,args:t})}};e.prototype.undo=function(){if(this.canUndo()){var e=this.undoStack.pop();var t=function(e,t){var i=e.operation;var n=t.operation;var r=["nodeAdded","nodeDeleted","nodeDataUpdated"];var o=["connectionCreated","connectionDeleted"];if(o.includes(i)&&r.includes(n)){return 1}if(r.includes(i)&&o.includes(n)){return-1}return 0};var i=this;this.editor.batch(function(){e.sort(t).forEach(function(e){var t=i.undoOperations[e.operation];if(t){t.apply(i,e.args)}})});this.onChange()}};AGN.Lib.WM.UndoManager=e})();(function(){var t=AGN.Lib.WM.Definitions,i=AGN.Lib.Select;var e=function(){var a={};this.editors=[];this.curEditor;this.curEditingNode;this.getCurrentNode=function(){return this.curEditingNode};this.getCurrentNodeId=function(){return this.curEditingNode.getId()};this.getCurrentNodeAnchorsInUse=function(){if(a.getNodeAnchorsInUse){return a.getNodeAnchorsInUse(this.curEditingNode)}return{}};this.getCurrentEditor=function(){return this.curEditor};this.assignOptions=function(e){$.extend(a,e)};this.registerEditor=function(e,t){return this.editors[e]=t};this.isPausedWorkflow=function(){return $("#workflow-status").val()===t.constants.statusPaused};this._notAllowedToChangeDuringPause=function(e){return this.isPausedWorkflow()&&!_.union(t.NODE_TYPES_MAILING,[t.NODE_TYPE_STOP]).includes(e.getType())};this.showEditDialog=function(e,t){var i=this;var n=e.getType();this.curEditingNode=e;this.curEditor=this.editors[n];this.curEditor.fillEditor(e);$("#node-editor").html(this.getEditorPanel(n));AGN.runAll($("#node-editor"));var r=$(this)};this.showIconCommentDialog=function(e){var t=this;this.curEditingNode=e;this.curEditor=this.editors["icon-comment"];this.curEditor.fillEditor(e);this.getEditorPanel("icon-comment").dialog({open:function(){t.getEditorPanel("icon-comment").parent().find(".ui-dialog-titlebar").hide()},width:300,height:"auto",minHeight:"auto",modal:true,resizable:false,fluid:true,position:{my:"left top",at:"left bottom",of:e.get$()}})};this.saveIconComment=function(t){var i=this;a.getUndoManager().transaction(function(){var e=i.curEditingNode;a.getUndoManager().operation("nodeDataUpdated",e,_.cloneDeep(e));e.setComment(t);a.onChange(e)})};this.saveCurrentEditorWithUndo=function(e,t){var i=this;_.defer(function(){a.getUndoManager().startTransaction();i.saveCurrentEditor(e,t,function(){a.getUndoManager().endTransaction()})})};this.saveCurrentEditor=function(t,i,n){n=_.isFunction(n)?n:_.noop;var r=this;var e=this.curEditingNode;a.getUndoManager().operation("nodeDataUpdated",e,_.cloneDeep(e),r.curEditor);var o=r.curEditor.saveEditor();if(!t){r.cancelEditor()}if(r.isNodeIsMailing(e)){var s=o.mailingId;if(i){i.checkDifferentMailingLists(s,function(e){r.mailingSpecificSave(t,e,o,i);n()},function(e){r.curEditor.storedMailingContent=e;r.curEditor.storedMailingId=s;r.curEditor.storedLeaveOpen=t;r.curEditor.storedEditorData=o;i.initOneMailinglistWarningDialog(i);n()})}}else{$.extend(e.getData(),o);if(!e.isFilled()){e.setFilled(true)}if(e.isFilled()&&_.isFunction(r.curEditor.isSetFilledAllowed)){if(!r.curEditor.isSetFilledAllowed()){e.setFilled(false)}}if(a.supplement){a.supplement(e)}if(a.onChange){a.onChange(e)}n()}};this.resave=function(e){var t=this.curEditingNode;var i=this.curEditor;try{this.curEditingNode=e;this.curEditor=this.editors[e.getType()];this.curEditor.fillEditor(e);this.saveCurrentEditor()}finally{this.curEditingNode=t;this.curEditor=i}};this.modify=function(e,t){a.getUndoManager().operation("nodeDataUpdated",e,_.cloneDeep(e));t(e);if(a.onChange){a.onChange(e)}};this.isNodeIsMailing=function(e){return t.NODE_TYPES_MAILING.includes(e.getType())};this.mailingSpecificSave=function(e,t,i,n){var r=this;var o=this.curEditingNode;var s=o.getData();$.extend(s,i);if(o.isFilled()&&_.isFunction(r.curEditor.isSetFilledAllowed)){if(!r.curEditor.isSetFilledAllowed()){o.setFilled(false)}}if(a.supplement){a.supplement(o,n,t)}if(a.onChange){a.onChange(o)}};this.mailingSpecificSaveAfterMailinglistCheckModal=function(e){this.curEditor.storedMailingContent.mailinglistId=e.configuredMailingData.mailinglistId;this.mailingSpecificSave(this.curEditor.storedLeaveOpen,this.curEditor.storedMailingContent,this.curEditor.storedEditorData,e)};this.cancelEditor=function(){var e=this.curEditingNode.getType();var t=this.getEditorPanel(e);if(t.dialog("instance")){t.dialog("close")}};this.getEditorPanel=function(e){const t=e==="stop"?"start":e;return $(`#${t}-editor`)};this.formToObject=function(e){var t=$('form[name="'+e+'"]').serializeArray();var n={};$.each(t,function(){if(this.name.indexOf("[")!=-1){var e=this.name.substring(0,this.name.indexOf("["));if(n[e]==undefined){n[e]=[]}var t=this.name.substring(this.name.indexOf("[")+1,this.name.indexOf("]"));if(n[e][t]==undefined){n[e][t]={}}if(this.name.indexOf(".")!=-1){var i=this.name.substring(this.name.indexOf(".")+1);n[e][t][i]=this.value}else{n[e][t]=this.value}}else{n[this.name]=this.value||""}});$('form[name="'+e+'"] [type="checkbox"]').each(function(){n[this.name]=$(this).prop("checked")});return n};this.fillFormFromObject=function(e,t,i,n){if(typeof t==="string"){this.fillFormFromObjectItem(e,i,i,t||n)}else{for(var r in t){if(t.hasOwnProperty(r)){var o=t[r];if(!o&&n&&n[r]){o=n[r]}this.fillFormFromObjectItem(e,i,r,o)}}}};this.fillFormFromObjectItem=function(e,t,i,n){if(Object.prototype.toString.call(n)==="[object Array]"){for(var r=0;r<n.length;r++){this.fillFormFromObject(e,n[r],i+"["+r+"]"+".")}}else{var o=$('form[name="'+e+'"] [name="'+t+i+'"]');var s=o.attr("type");switch(s){case"checkbox":o.prop("checked",Boolean(n));break;case"radio":o.filter('[value="'+n+'"]').prop("checked",true);break;default:var a=o.prop("tagName");switch(a){case"SELECT":o.val(n);this.initSelectWithValueOrChooseFirst(o,n);break;default:o.val(n)}}}};this.processForward=function(e,t,i,n){var r=[];r.push("nodeId="+this.curEditingNode.getId());r.push("elementId="+encodeURIComponent(t));if(!!n){r.push(n)}var o={forwardName:e,forwardParams:r.join(";")};if(this.curEditor.safeToSave){this.saveCurrentEditor()}i(false,o)};this.getFirstOptionValue=function(e){return i.get(e).getFirstValue()};this.resetSelect=function(e){i.get(e).clear()};this.initSelectWithFirstValue=function(e){i.get(e).selectFirstValue()};this.initSelectWithValueOrChooseFirst=function(e,t){i.get(e).selectValueOrSelectFirst(t)};this.getNodesByTypes=function(e){if(a.getNodesByTypes){return a.getNodesByTypes(e)}return[]};this.getNodesByType=function(e){return this.getNodesByTypes([e])};this.getNodesByIncomingConnections=function(e){if(a.getNodesByIncomingConnections){return a.getNodesByIncomingConnections(e)}return[]};this.getNodesByOutgoingConnections=function(e){if(a.getNodesByOutgoingConnections){return a.getNodesByOutgoingConnections(e)}return[]};this.getFirstIncomingChain=function(){if(this.curEditingNode&&a.getFirstIncomingChain){return a.getFirstIncomingChain(this.curEditingNode)}return[]};this.forEachPreviousNode=function(t){var i=this;if(this.curEditingNode&&a.forEachPreviousNode){return a.forEachPreviousNode(this.curEditingNode,function(e){return t.call(i,e)})}return[]};this.deleteNode=function(e){if(a.deleteNodeById){a.deleteNodeById(e)}};this.openNode=function(e,t){if(a.editNode){a.editNode(e,t)}}};function n(e){e.find(".disable-for-active").each(function(e,t){$(t).attr("disabled",true)});e.find(".hide-for-active").each(function(e,t){$(t).hide()});e.find(':input:enabled[type!="hidden"]').not(":button, .select2, .js-select, .js-datepicker").each(function(e,t){if($(t).prop("type")=="radio"||$(t).prop("type")=="checkbox"){$(t).attr("disabled",true)}else{$(t).attr("readonly",true)}});e.find(":input:enabled.select2, :input:enabled.js-select, .select2-container").not(".disabled, :disabled").each(function(e,t){if($(t).prop("type")=="text"||$(t).is("input, select")){$(t).attr("disabled",true)}else{$(t).select2("disable")}});e.find(".js-datepicker").each(function(e,t){$(t).attr("disabled",true)})}AGN.Lib.WM.EditorsHelper=new e})();(function(){var C=AGN.Lib.WM.Definitions,p=AGN.Lib.WM.Node,x=AGN.Lib.WM.EditorsHelper,S=AGN.Lib.WM.Utils,A=AGN.Lib.WM.Dialogs;var e=function(e,o){this.MAILING_TYPE_ACTIONBASED=1;this.MAILING_TYPE_DATEBASED=2;this.MAILING_TYPE_FOLLOWUP=3;this.node={};this.mailingsStatus="all";this.defaultMailingsSort=e.defaultMailingsSort;this.defaultMailingsOrder=e.defaultMailingsOrder;this.mailingsSort=this.defaultMailingsSort;this.mailingsOrder=this.defaultMailingsOrder;this.formNameJId='form[name="'+e.form+'"]';this.containerId=e.container;this.mailingType=e.mailingType;this.mediaType=e.mediaType;this.mediatypes=e.mediatypes;this.mailingTypesForLoading=e.mailingTypesForLoading;this.statusName=e.mailingStatus;this.selectName=e.selectName;this.selectNameJId="select[name="+e.selectName+"]";this.mailingId=0;this.showCreateEditLinks=e.showCreateEditLinks;this.$dropdown=null;if(e.$dropdown){this.$dropdown=e.$dropdown}this.isChangeDecisionOptions=e.isFollowUpBaseMailing;this.followUpContainer=e.followUpContainer;this.advertisingAdditionalOptions=e.advertisingAdditionalOptions;this.nodesChain=[];this.mailingData={};this.configuredMailingData=null;var c=this;this.fillEditorBase=function(e){this.node=e;if(S.checkActivation()){this.mailingsStatus="all"}else{this.mailingsStatus=$(this.formNameJId).find("input[checked=checked]").val()||"all"}this.mailingsSort=this.defaultMailingsSort;this.mailingsOrder=this.defaultMailingsOrder;this.cleanOptions();this.hideSendSettings();this.changeDecisionOptionsSet($(this.containerId),this.isChangeDecisionOptions)};this.cleanOptions=function(){this.setDefaultSortOptions();$(this.containerId+" #"+this.statusName+"_all").attr("checked","checked");this.activateInputs();this.setSelectMailingOptions(this.node.data[this.selectName]);this.getMailingsByWorkStatus(this.mailingsStatus,this.mailingsSort,this.mailingsOrder,this.node.data.mailingId)};this.setDefaultSortOptions=function(){this.mailingsSort=this.defaultMailingsSort;this.mailingsOrder=this.defaultMailingsOrder;$(this.containerId+" .arrowUp").hide();$(this.containerId+" .arrowDown").hide();$(this.containerId+" #shortname_sort").attr("press",1);$(this.containerId+" #change_date_sort").attr("press",2);if(this.mailingType==this.MAILING_TYPE_ACTIONBASED||this.mailingType==this.MAILING_TYPE_DATEBASED){$(this.containerId+" #shortname_sort .arrowUp").show()}else{$(this.containerId+" #change_date_sort .arrowDown").show()}};this.onMailingsStatusChange=function(e){this.setSelectMailingOptions(0);this.getMailingsByWorkStatus(e,this.mailingsSort,this.mailingsOrder);this.changeDecisionOptionsSet($(this.containerId),this.isChangeDecisionOptions)};this.onMailingSelectChange=function(e){this.setSelectMailingOptions(e);this.changeDecisionOptionsSet($(this.containerId),this.isChangeDecisionOptions)};this.changeDecisionOptionsSet=function(e,t){if(t){var i=this.mailingId;var n=$(e.find(this.followUpContainer));var r=this.advertisingAdditionalOptions;$(n.find(".advertisingOption")).remove();if(i){$.ajax({type:"POST",url:AGN.url("/mailing/ajax/"+i+"/isAdvertisingContentType.action")}).done(function(e){if(e&&e.success){var t=AGN.Lib.Template.text("followupAdvertisingOptions",{items:r});n.append(t)}})}}};this.onMailingSortClick=function(e,t){$(this.containerId+" .arrowUp").hide();$(this.containerId+" .arrowDown").hide();var i=$(this.containerId+" .sort");var n=this.containerId+" #"+e+"_sort";var r=$(n);var o=$(n+" .arrowUp");var s=$(n+" .arrowDown");var a=r.attr("press");var l=$(this.formNameJId+" "+this.selectNameJId).val();if(!a){i.attr("press",2);r.attr("press",2);o.show();this.mailingsOrder="ASC"}else{switch(a){case"1":r.attr("press",2);s.show();this.mailingsOrder="DESC";break;case"2":r.attr("press",1);o.show();this.mailingsOrder="ASC";break}}this.getMailingsByWorkStatus(this.mailingsStatus,t,this.mailingsOrder,l)};this.setMailingId=function(e){this.mailingId=e;if(this.$dropdown){if(this.mailingId>0){this.$dropdown.show()}else{this.$dropdown.hide()}}};this.setSelectMailingOptions=function(e){this.setMailingId(e);if(this.showCreateEditLinks){this.setMailingLinks(e)}};this.setMailingLinks=function(e){const t=$(this.getMailingLink(e));t.addClass("btn btn-icon-sm btn-primary");$(this.containerId+" #mailing_create_edit_link").html(t)};this.getMailingLink=function(e){if(!e||e==="0"){return'<a href="#" data-action="mailing-editor-new"><i class="icon icon-plus"></i></a>'}if(!S.checkActivation()){return'<a href="#" data-action="mailing-editor-edit"><i class="icon icon-pen"></i></a>'}return`<a href="${AGN.url("/mailing/"+e+"/settings.action")}"><i class="icon icon-pen"></i></a>`};this.showSecurityQuestion=function(){this.setSecurityQuestion();this.setIsUsedInCMAttr();if(this.isSentMailing(this.mailingIsSent)||this.mailingIsUsedInCM){var e=this.getSelectedMailingOption();$(this.containerId+"-security-dialog").dialog({title:'<span class="dialog-fat-title">'+e.html()+"</span>",dialogClass:"no-close",open:function(e,t){},width:650,modal:true,resizable:false});return false}return true};this.isSentMailing=function(e){return e=="mailing.status.sent"||e=="mailing.status.scheduled"||e=="mailing.status.norecipients"};this.cancelSecurityDialog=function(){$(this.containerId+"-security-dialog").dialog("close")};this.getMailingsByWorkStatus=function(i,n,r,o){var s=this;var a=$(this.formNameJId+" "+this.selectNameJId);a.attr("readonly","readonly");$.ajax({type:"POST",url:AGN.url("/workflow/getMailingsByWorkStatus.action"),data:{mailingTypes:this.mailingTypesForLoading.join(","),mediatypes:this.mediatypes?this.mediatypes.join(","):"",status:i,sort:n,order:r},success:function(e){a.empty();a.append($("<option></option>",{value:0,text:t("workflow.defaults.no_mailing")}));e.forEach(function(e){var t=$("<option></option>",{value:e.MAILING_ID,text:e.SHORTNAME,selected:o==e.MAILING_ID});if(s.isSentMailing(e.WORK_STATUS)){t.css("color","#808080")}t.attr({status:e.WORK_STATUS,senddate:e.SENDDATE});t.data({status:e.WORK_STATUS,"send-date":e.SENDDATE,"dependent-campaigns":e.USEDINWORKFLOWS||""});a.append(t)});a.removeAttr("readonly");s.mailingsStatus=i;s.mailingsSort=n;s.mailingsOrder=r;a.val(s.mailingId);x.initSelectWithValueOrChooseFirst(a,s.mailingId)}})};this.disableInputs=function(){$(this.containerId+' [name="'+this.statusName+'"]').attr("disabled","disabled")};this.activateInputs=function(){$(this.containerId+' [name="'+this.statusName+'"]').removeAttr("disabled")};this.setNodeFields=function(){this.node.setFilled(parseInt(this.mailingId,10)>0)};this.setSecurityQuestion=function(){var e=this.getSelectedMailingOption();this.mailingIsSent="";if(parseInt(this.mailingId,10)>0){this.mailingIsSent=e.data("status")}};this.setIsUsedInCMAttr=function(){var e=this.getSelectedMailingOption();var t=e.data("dependent-campaigns");var i=e.val();this.mailingIsUsedInCM=false;if(parseInt(this.mailingId,10)>0&&i==this.mailingId&&t){var n=C.workflowId||0;if(t>0){if(n>0){this.mailingIsUsedInCM=n!==t}else{this.mailingIsUsedInCM=true}}}};this.getSelectedMailingOption=function(){return $(this.formNameJId+" "+this.selectNameJId+" option[value="+this.mailingId+"]")};this.getSelectedDecisionOption=function(){var e="decisionCriterion";var t=$(this.formNameJId+' select[name="'+e+'"]').val();return $(this.formNameJId+' select[name="'+e+'"] option[value='+t+"]")};this.createNewMailing=function(e){r({node:this.node,successCallback:i,forwardName:e,mailingEditorBase:this})};var i=function(e,i,n){if(!e.hasMailingList){$(n.containerId+" .editor-error-messages").html(t("error.workflow.notAddedMailingList"));$(n.containerId+" .editor-error-messages").css("display","block")}else{var r=[];r.push("mailingType="+n.mailingType);if(n.mediaType){r.push("mediaType="+n.mediaType)}if(n.mailingType==n.MAILING_TYPE_FOLLOWUP){r.push("workflowFollowUpParentMailing="+n.node.data.baseMailingId);r.push("workflowFollowUpDecisionCriterion="+n.node.data.decisionCriterion)}x.processForward(i,n.formNameJId+" "+n.selectNameJId,o,r.join(";"))}};this.processCopyAndEditMailingForward=function(e,t,i,n){$("#forwardTargetItemId").val(e);var r=[];if(this.mailingType==this.MAILING_TYPE_FOLLOWUP){r.push("workflowFollowUpParentMailing="+this.node.data.baseMailingId);r.push("workflowFollowUpDecisionCriterion="+this.node.data.decisionCriterion)}if(r.length>0){x.processForward(t,i+" "+n,o,r.join(";"))}else{x.processForward(t,i+" "+n,o)}};this.editMailing=function(e){this.processCopyAndEditMailingForward(this.mailingId,e,this.formNameJId,this.selectNameJId)};this.copyMailing=function(e){this.processCopyAndEditMailingForward(this.mailingId,e,this.formNameJId,this.selectNameJId)};this.trySupplementChain=function(e,t,i){if(e.length>0){this.configuredMailingData=a(e);this.nodesChain=e;this.mailingData=t;var n=u(c,true);if(n.length){A.confirmMailingDataTransfer(n).done(function(e){c.transferMailingData(e);c.supplementChain(i)}).fail(function(){c.transferMailingData();c.supplementChain(i)})}else{c.supplementChain(i)}}};this.checkDifferentMailingLists=function(e,r,o){var s=this;n(e).then(function(e){var t=x.getFirstIncomingChain();s.configuredMailingData=a(t);s.nodesChain=t;s.mailingData=e;var i=0;t.forEach(function(e){if(e.getType()==C.NODE_TYPE_MAILING){i++}});var n=s.configuredMailingData.mailinglistId;if(i>1&&n!=0&&n!=e.mailinglistId){o(e)}else{r(e)}})};var a=function(e){var t={parameterValue:0,campaignId:0,mailinglistId:0,targets:[],date:null};for(var i=e.length-1;i>=0;i--){var n=e[i];var r=n.getData();switch(n.getType()){case C.NODE_TYPE_PARAMETER:t.parameterValue=r.value;break;case C.NODE_TYPE_ARCHIVE:t.campaignId=r.campaignId;break;case C.NODE_TYPE_RECIPIENT:if(t.mailinglistId==0){t.mailinglistId=r.mailinglistId}if(r.targets!==null){r.targets.forEach(function(e){if(!t.targets.includes(e)){t.targets.push(parseInt(e))}})}break;case C.NODE_TYPE_START:if(r.date){t.date=y(r.date);t.date.setHours(r.hour);t.date.setMinutes(r.minute)}else{t.date=null}break;case C.NODE_TYPE_DEADLINE:if(r.deadlineType==C.constants.deadlineTypeFixedDeadline){if(r.date){t.date=y(r.date);t.date.setHours(r.hour);t.date.setMinutes(r.minute)}else{t.date=null}}else if(r.deadlineType==C.constants.deadlineTypeDelay){if(t.date!=null){if(r.timeUnit==C.constants.deadlineTimeUnitMinute){t.date.setMinutes(t.date.getMinutes()+parseInt(r.delayValue))}else if(r.timeUnit==C.constants.deadlineTimeUnitHour){t.date.setHours(t.date.getHours()+parseInt(r.delayValue))}else if(r.timeUnit==C.constants.deadlineTimeUnitDay){t.date.setDate(t.date.getDate()+parseInt(r.delayValue));if(r.useTime||r.useTime=="true"){t.date.setMinutes(t.date.getMinutes()+parseInt(r.minute));t.date.setHours(t.date.getHours()+parseInt(r.hour))}}}}break}}return t};var u=function(e,t){var i=e.configuredMailingData;var n=e.mailingData;var r=[];var o=[];var s=[];if(n.mailinglistId==0){s.push(C.MAILING_PARAM_MAILING_LIST)}else{if(i.mailinglistId==0){r.push(C.MAILING_PARAM_MAILING_LIST)}else{if(i.mailinglistId!=n.mailinglistId){if(t){o.push(C.MAILING_PARAM_MAILING_LIST)}else{r.push(C.MAILING_PARAM_MAILING_LIST)}}}}var a=i.targets;var l=n.targetGroupIds;if(l==null||l.length==0){s.push(C.MAILING_PARAM_TARGET_GROUPS)}else{if(a==null||a.length==0){r.push(C.MAILING_PARAM_TARGET_GROUPS)}else{if(!b(i,n)){if(t){o.push(C.MAILING_PARAM_TARGET_GROUPS)}else{r.push(C.MAILING_PARAM_TARGET_GROUPS)}}}}if(C.constants.isAltgExtended){var c=i.altgs;var u=n.altgIds;if(u==null||u.length==0){s.push(C.MAILING_PARAM_ALTGS)}else{if(c==null||c.length==0){r.push(C.MAILING_PARAM_ALTGS)}else{if(!w(i,n)){if(t){o.push(C.MAILING_PARAM_TARGET_GROUPS)}else{r.push(C.MAILING_PARAM_TARGET_GROUPS)}}}}}var d=e.getParameterValue(n.splitBase,n.splitPart);if(d==null){s.push(C.MAILING_PARAM_LIST_SPLIT)}else{if(i.parameterValue==0){r.push(C.MAILING_PARAM_LIST_SPLIT)}else{if(i.parameterValue!=d){if(t){o.push(C.MAILING_PARAM_LIST_SPLIT)}else{r.push(C.MAILING_PARAM_LIST_SPLIT)}}}}if(n.campaignId==0){s.push(C.MAILING_PARAM_ARCHIVE)}else{if(i.campaignId==0){r.push(C.MAILING_PARAM_ARCHIVE)}else{if(i.campaignId!=n.campaignId){if(t){o.push(C.MAILING_PARAM_ARCHIVE)}else{r.push(C.MAILING_PARAM_ARCHIVE)}}}}var h=i.date;var f=v(n);var p=m(n);if(f==null&&p==null){s.push(C.MAILING_PARAM_PLANNED_DATE)}else{if(h==null){if(f!=null){r.push(C.MAILING_PARAM_PLANNED_DATE)}else{r.push(C.MAILING_PARAM_SEND_DATE)}}else{if(y(f)>y(h)){if(t){o.push(C.MAILING_PARAM_PLANNED_DATE)}else{r.push(C.MAILING_PARAM_PLANNED_DATE)}}else if(f&&y(f)<y(h)){s.push(C.MAILING_PARAM_PLANNED_DATE)}if(p>h){if(t){o.push(C.MAILING_PARAM_SEND_DATE)}else{r.push(C.MAILING_PARAM_SEND_DATE)}}else if(p&&p<h){s.push(C.MAILING_PARAM_SEND_DATE)}}}g(e,s);return t?o:r};var g=function(e,t){var i=e.configuredMailingData;var n=e.mailingData;for(var r=0;r<t.length;r++){switch(t[r]){case C.MAILING_PARAM_MAILING_LIST:n.mailinglistId=i.mailinglistId;break;case C.MAILING_PARAM_TARGET_GROUPS:n.targetGroupIds=i.targets;break;case C.MAILING_PARAM_ALTGS:n.altgIds=i.altgs;break;case C.MAILING_PARAM_ARCHIVE:n.campaignId=i.campaignId;break;case C.MAILING_PARAM_LIST_SPLIT:n.splitBase="";n.splitPart="";break;case C.MAILING_PARAM_PLANNED_DATE:var o=y(i.date);if(o){n.planDate=o.getTime()}else{n.planDate=0}break;case C.MAILING_PARAM_SEND_DATE:n.sendDate=y(i.date);if(i.date){n.sendHour=i.date.getHours();n.sendMinute=i.date.getMinutes()}break}}};var n=function(e){return new Promise(function(t){_.defer(function(){$.ajax({type:"POST",url:AGN.url("/workflow/getMailingContent.action"),data:{mailingId:e},success:function(e){t(e)}})})})};var r=function(e){var t=e.node||x.curEditingNode;var i=e.successCallback;var n=e.forwardName;function r(e){var t=0;x.curEditingNode=e;x.forEachPreviousNode(function(e){if(e.type===C.NODE_TYPE_RECIPIENT){t=e.data.mailinglistId;return false}});return t>0}i({hasMailingList:r(t)},n,e.mailingEditorBase)};this.transferMailingData=function(e){if(e){g(c,e)}else{g(c,u(c,true))}};this.supplementChain=function(e){var n=u(this,false);var r=this.mailingData;var o=this.configuredMailingData;var t=this.nodesChain;var i=false;var s=false;for(var a=1;a<t.length;a++){if(C.NODE_TYPES_MAILING.includes(t[a].getType())){t.splice(a+1);s=true;break}}if(!s){if(n.includes(C.MAILING_PARAM_PLANNED_DATE)||n.includes(C.MAILING_PARAM_SEND_DATE)){if(C.NODE_TYPE_START==t[t.length-1].getType()){i=true}else{var l=x.getNodesByType(C.NODE_TYPE_START);if(l.length==0&&r.mailingType!=this.MAILING_TYPE_ACTIONBASED&&r.mailingType!=this.MAILING_TYPE_DATEBASED){i=true}}if(i){this.supplementSingleNode(C.NODE_TYPE_START,function(e){var t=e.getData();if(n.includes(C.MAILING_PARAM_PLANNED_DATE)){t.date=v(r);var i=o.date;if(i){t.hour=i.getHours();t.minute=i.getMinutes()}x.resave(e)}else if(n.includes(C.MAILING_PARAM_SEND_DATE)){t.date=m(r);t.hour=t.date.getHours();t.minute=t.date.getMinutes()}})}}}if(n.includes(C.MAILING_PARAM_LIST_SPLIT)){this.supplementSingleNode(C.NODE_TYPE_PARAMETER,function(e){var t=e.getData();t.value=c.getParameterValue(r.splitBase,r.splitPart)})}if(n.includes(C.MAILING_PARAM_ARCHIVE)){this.supplementSingleNode(C.NODE_TYPE_ARCHIVE,function(e){var t=e.getData();t.campaignId=r.campaignId})}if(n.includes(C.MAILING_PARAM_MAILING_LIST)||n.includes(C.MAILING_PARAM_TARGET_GROUPS)){this.supplementSingleNode(C.NODE_TYPE_RECIPIENT,function(e){var t=e.getData();if(n.includes(C.MAILING_PARAM_MAILING_LIST)){t.mailinglistId=r.mailinglistId;e.setDependent(true)}if(n.includes(C.MAILING_PARAM_TARGET_GROUPS)){t.targets=r.targetGroupIds;if(C.constants.isAltgExtended){t.targetsOption="ONE_TARGET_REQUIRED"}else{t.targetsOption=C.constants.accessLimitTargetId>0?"ALL_TARGETS_REQUIRED":"ONE_TARGET_REQUIRED"}}if(C.constants.isAltgExtended){if(n.includes(C.MAILING_PARAM_ALTGS)){t.altgs=r.altgIds}}})}if(!i&&(n.includes(C.MAILING_PARAM_PLANNED_DATE)||n.includes(C.MAILING_PARAM_SEND_DATE))){this.supplementSingleNode(C.NODE_TYPE_DEADLINE,function(e){var t=e.getData();if(n.includes(C.MAILING_PARAM_PLANNED_DATE)){t.date=v(r);var i=o.date;if(i){t.date.setHours(i.getHours());t.date.setMinutes(i.getMinutes())}}else if(n.includes(C.MAILING_PARAM_SEND_DATE)){t.date=m(r)}t.deadlineType=C.constants.deadlineTypeFixedDeadline;t.hour=t.date.getHours();t.minute=t.date.getMinutes()})}e(t)};this.supplementSingleNode=function(e,t){var i;switch(e){case C.NODE_TYPE_START:i=false;break;case C.NODE_TYPE_PARAMETER:i=[];break;case C.NODE_TYPE_ARCHIVE:i=[C.NODE_TYPE_PARAMETER];break;case C.NODE_TYPE_RECIPIENT:i=[C.NODE_TYPE_PARAMETER,C.NODE_TYPE_ARCHIVE];break;case C.NODE_TYPE_DEADLINE:i=[C.NODE_TYPE_PARAMETER,C.NODE_TYPE_ARCHIVE,C.NODE_TYPE_RECIPIENT];break;default:console.error("Unexpected supplement node type: "+e);return}if(!s(e,t)){l(e,i,t)}};var s=function(e,t){var i=c.nodesChain;for(var n=1;n<i.length;n++){var r=i[n];if(e==r.getType()){t(r);x.resave(r);return true}}return false};var l=function(e,t,i){var n=c.nodesChain;var r=p.create(e);i(r);if(t===false){n.push(r)}else{for(var o=1;o<n.length;o++){var s=n[o];if(!t.includes(s.getType())){n.splice(o,0,r);return}}n.push(r)}};this.closeOneMailinglistWarningDialog=function(){$(this.containerId+"-oneMailinglistWarning-dialog").dialog("close")};this.acceptOneMailinglistPerCampaign=function(){this.closeOneMailinglistWarningDialog();x.mailingSpecificSaveAfterMailinglistCheckModal(c)};this.validateEditor=function(e){var i=$(this.containerId+" .editor-error-messages");i.html("");i.css("display","none");var n=false;if($(this.containerId+" .delivery-settings").length){var r=$(this.containerId+' [name="maxRecipients"]').val();if(parseInt(r)!=r){i.html(t("error.workflow.wrongMaxRecipientsFormat"));n=true}else if(parseInt(r)<0){i.html(t("error.workflow.maxRecipientsLessThanZero"));n=true}else if(parseInt(r)>1e9){i.html(t("error.workflow.maxRecipientsTooBig"));n=true}}var o=$(this.formNameJId+" "+this.selectNameJId);if(o.val()<=0){if(i.html()!=""){i.html(i.html()+"<br>")}i.html(i.html()+t("error.workflow.noMailing"));n=true}if(!n){if(e){e()}else{x.saveCurrentEditor()}}else{i.css("display","block")}};this.toggleSendSettings=function(e){if($("#sendSettings_"+e).css("display")=="none"){$("#sendSettingsToggle_"+e).removeClass("toggle_closed");$("#sendSettingsToggle_"+e).addClass("toggle_open")}else{$("#sendSettingsToggle_"+e).removeClass("toggle_open");$("#sendSettingsToggle_"+e).addClass("toggle_closed")}$("#sendSettings_"+e).toggle("blind",200)};this.hideSendSettings=function(){$(".wm-mailing-send-settings-link").removeClass("toggle_open");$(".wm-mailing-send-settings-link").addClass("toggle_closed");$(".wm-mailing-send-settings").css("display","none")};this.getParameterValue=function(e,t){if(e.length>4){for(var i=0;i<e.length/2;i++){if(i+1==t){return e.substring(i*2,(i+1)*2)}}}else{for(var i=0;i<e.length/2;i++){if(e.substring(i*2,(i+1)*2)==t){return e.substring(i*2,(i+1)*2)}}}return null};this.initOneMailinglistWarningDialog=function(e){$(e.containerId+"-oneMailinglistWarning-dialog").dialog({title:'<span class="dialog-fat-title">'+e.getSelectedMailingOption().html()+"</span>",dialogClass:"no-close",width:350,modal:true,resizable:false})};var d=function(e){return e.sendDate!=undefined&&e.sendDate!=null&&e.sendHour!=null&&e.sendMinute!=null};var h=function(e){return e.planDate>0};var m=function(e){if(d(e)){return new Date(e.sendDate+"T"+e.sendHour+":"+e.sendMinute+":00")}return null};var v=function(e){if(h(e)){return new Date(e.planDate)}return null};var y=function(e){if(e==null){return null}else{return new Date(e.getFullYear(),e.getMonth(),e.getDate())}};var b=function(e,t){var i=e.targets;var n=t.targetGroupIds;if(i==null&&n==null){return true}if(i.length!=n.length){return false}for(var r=0;r<n.length;r++){if(!f(i,n[r])){return false}}return true};var w=function(e,t){var i=e.altgs;var n=t.altgIds;if(i==null&&n==null){return true}if(i.length!=n.length){return false}for(var r=0;r<n.length;r++){if(!f(i,n[r])){return false}}return true};var f=function(e,t){return e.indexOf(t)!=-1}};AGN.Lib.WM.MailingEditorHelper=e})();(function(){var s=AGN.Lib.WM.EditorsHelper;AGN.Lib.WM.MailingSelector=function(e,i,n,r){this.formNameJId='form[name="'+e+'"]';this.container=i;this.selectNameJId="select[name="+n+"]";this.defaultSortField="date";this.mailingId=0;this.noMailingOption=r;this.cleanOptions=function(e){if(e==undefined){e=0}$(this.container+" .sort").prop("press",e);this.onMailingSortClick(this.defaultSortField)};this.onMailingSelectChange=function(e){};this.onMailingSortClick=function(e){$(this.container+" .arrowUp").hide();$(this.container+" .arrowDown").hide();var t=$(this.container+" .sort");var i=this.container+" #"+e+"_sort";var n=$(i);var r=$(i+" .arrowUp");var o=$(i+" .arrowDown");var s=parseInt(n.prop("press"));var a="asc";t.prop("press",0);switch(s){case 0:n.prop("press",1);r.show();a="asc";break;case 1:n.attr("press",2);o.show();a="desc";break;case 2:n.prop("press",1);r.show();a="asc";break}this.getAllMailingSorted(e,a)};this.setMailingId=function(e){this.mailingId=e};this.getAllMailingSorted=function(e,i){var n=this;var r=$(this.formNameJId+" "+this.selectNameJId);var o=r.val();if(o!=null){n.mailingId=o}r.attr("readonly","readonly");$.ajax({type:"GET",url:AGN.url("/workflow/getAllMailingSorted.action"),data:{sortField:e,sortDirection:i},success:function(e){r.html("");if(n.noMailingOption){r.append('<option value="0">'+t("workflow.defaults.no_mailing")+"</option>")}for(var i=0;i<e.length;i++){r.append("<option "+' value="'+e[i].mailingID+'">'+e[i].shortname+"</option>")}r.removeAttr("readonly");if(n.mailingId==0&&n.noMailingOption==false&&e.length>0){r.val(e[0].mailingID)}else{r.val(n.mailingId)}s.initSelectWithValueOrChooseFirst(r,r.val())}})};this.getSelectedMailingOption=function(){return $(this.formNameJId+" "+this.selectNameJId+" option[value="+this.mailingId+"]")}}})();(function(){var v=AGN.Lib.WM.Definitions,d=AGN.Lib.WM.Node,r=AGN.Lib.WM.Vertex,h=AGN.Lib.WM.VertexGroup,o=AGN.Lib.WM.NodeTitleHelper,n=AGN.Lib.WM.Canvas,s=AGN.Lib.WM.ConnectionConstraints,a=AGN.Lib.WM.DraggableButtons,l=AGN.Lib.WM.AutoAlignment,c=AGN.Lib.WM.UndoManager,f=AGN.Lib.WM.EditorsHelper,u=AGN.Lib.WM.Dialogs,p=AGN.Lib.WM.Snippets,g=AGN.Lib.ContextMenu,m=AGN.Lib.Helpers,i=AGN.Lib.WM.Utils;var y={blurInputFields:function(){if(document.activeElement&&$(document.activeElement).is("input, textarea")){document.activeElement.blur()}},setConnectionLabel:function(e,t){if(t){var i=e.origin.getOverlay("label");if(i){i.setLabel(t);i.show()}else{e.origin.addOverlay(["Label",{location:.5,id:"label",cssClass:"connection-label",label:t}])}}else{e.origin.hideOverlay("label")}},setDeleteButtonEnabled:function(e){$("#deleteButton").toggleClass("disabled",!e);$("#deleteItem").prop("disabled",!e)},setUndoButtonEnabled:function(e){$("#undoButton").toggleClass("disabled",!e);$("#undoItem").prop("disabled",!e)}};function b(e,t,i){this.$viewport=$("#viewPort");this.$gridBackground=$("#grid-background");this.$container=$("#canvas");this.$titlesContainer=this.$container.find("#icon-titles-container");this.canvas=new n(this.$container);this.canvasZoomHandler=null;this.instance=jsPlumb.getInstance(b.defaults(this.$container));this.editable=!!e;this.lastAllocatedId=0;this.drag=null;this.chainModeEnabled=false;this.multiConnectionEnabled=false;this.scale=1;this.dragMode=v.DEFAULT_DRAG_MODE;var r=this;this.updateBackgroundCellSize(this.scale);this.canvas.setOnZoom(function(e){r.instance.setZoom(e);if(r.canvasZoomHandler){r.canvasZoomHandler.call(null,e)}});this.canvas.setOnMove(function(e){r.moveGridBackground(e)});this.draggableButtons=new a({enabled:!!e,getZoom:function(){return r.getZoom()},getOccupiesAreas:function(){return r.getNodes$().get().map(function(e){return d.getCollisionBox($(e))})},onStart:function(){},onStop:function(){},onDrop:function(e,t){r.newNode(e,t)}});this.$viewport.selectable({filter:".node",distance:10,disabled:!this.editable,start:function(){$("#selection-backdrop").show()},stop:function(){$("#selection-backdrop").hide()},selected:function(e,t){r.instance.addToDragSelection(t.selected);r.onSelectionChanged()},unselected:function(e,t){r.instance.removeFromDragSelection(t.unselected);r.onSelectionChanged()}});this.$viewport.on("mousedown",function(e){if(["canvas","viewPort","icon-titles-container"].includes(e.target.id)||$.contains(r.$titlesContainer[0],e.target)){r.deselectAll()}y.blurInputFields()});this.instance.bind("connection",function(e){r.undoManager.operation("connectionCreated",e);r.autoConvertMailingNodesTypeIfPossible();r.updateOverlays();r.positionTitles();r.processRecipientsChains()});this.instance.bind("connectionDetached",function(e){r.undoManager.operation("connectionDeleted",e);r.autoConvertMailingNodesTypeIfPossible();r.updateOverlays();r.positionTitles();r.processRecipientsChains()});this.instance.bind("mousedown",function(e,t){if(r.editable&&t.button===v.MOUSE_BUTTON_MIDDLE){_.defer(function(){r.undoManager.transaction(function(){r.deleteConnection(e)})})}y.blurInputFields()});this.instance.bind("beforeDrag",function(){r.undoManager.startTransaction()});this.instance.bind("connectionDragStop",function(){r.undoManager.endTransaction()});this.instance.bind("connectionDrag",function(e){r.deselectAll();if(e.source){var t=$(e.source);r.setNodeSelected(t,true);if(r.isChainMode()){d.setChainSource(t,true)}}});this.instance.bind("beforeDrop",function(e){var t=d.get(document.getElementById(e.sourceId));var i=d.get(document.getElementById(e.targetId));var n=r.connect(t,i,true);if(n){return true}if(n===false){workflowNotAllowedConnectionDialogHandler.showDialog()}return false});this.$footnotesContainer=$("#footnotes-container ol");this.isFootnotesEnabled=i;this.undoManager=new c(this,{onChange:function(){y.setUndoButtonEnabled(this.canUndo());r.processRecipientsChains();r.autoConvertMailingNodesTypeIfPossible()}});f.assignOptions({getUndoManager:function(){return r.getUndoManager()},getNodesByTypes:function(e){return r.getNodesByTypes(e)},getNodesByIncomingConnections:function(e){return r.getNodeIncomingConnections(e).map(function(e){return e.source})},getNodesByOutgoingConnections:function(e){return r.getNodeOutgoingConnections(e).map(function(e){return e.target})},getFirstIncomingChain:function(e){return r.getFirstIncomingChain(e)},forEachPreviousNode:function(e,t){return r.forEachPreviousNode(e,t)},getNodeAnchorsInUse:function(e){return r.getAnchorsInUse(e)},onChange:function(e){r.updateNodeTitle(e,true);r.updateFootnotes();r.updateMinimap()},supplement:function(e){r.supplement.apply(r,arguments)},editNode:function(e,t){alert("Missing editorsHelper.editNode")},deleteNodeById:function(e){alert("Missing editorsHelper.deleteNodeById")}});if(t){g.create(b.contextMenuOptions(r))}}b.defaults=function(e){return{Container:e,Anchor:[[0,.5,-1,0],[.5,0,0,-1],[1,.5,1,0],[.5,1,0,1]],DragOptions:{cursor:"pointer",zIndex:v.Z_INDEX_JSPLUMB_DRAG_OPTIONS},Endpoint:"Blank",Connector:["FixedBezierConnector"],PaintStyle:{stroke:v.CONNECTION_COLOR,strokeWidth:v.CONNECTION_THICKNESS,outlineStroke:v.CONNECTION_OUTLINE_COLOR,outlineWidth:v.CONNECTION_OUTLINE_WIDTH},HoverPaintStyle:{stroke:v.CONNECTION_HOVER_COLOR,strokeWidth:v.CONNECTION_THICKNESS,outlineStroke:v.CONNECTION_OUTLINE_COLOR,outlineWidth:v.CONNECTION_OUTLINE_WIDTH},ConnectionOverlays:[["PlainArrow",{id:"arrow",visible:true,location:1,width:v.CONNECTION_ARROW_SIZE,length:v.CONNECTION_ARROW_SIZE}]]}};b.contextMenuOptions=function(i){return{".jtk-connector":{shown:function(){return i.editable},items:{delete:{name:t("workflow.defaults.delete"),icon:"delete",disabled:function(e){return!i.canDeleteConnection(i.getConnectionByConnector$(e))},clicked:function(t){i.undoManager.transaction(function(){var e=i.getConnectionByConnector$(t);i.deleteConnection(e.origin)})}}}},".node":{shown:function(){return true},items:{connect:{name:t("workflow.connect"),icon:"connect",shown:function(){return i.editable&&i.getSelectionSize()>1},clicked:function(){i.undoManager.transaction(function(){if(i.getSelectionSize()==2&&i.multiConnectionEnabled){i.connectBetweenSelected()}else{i.connectSelected()}})}},disconnect:{name:t("workflow.disconnect"),icon:"disconnect",shown:function(){return i.editable&&i.getSelectionSize()>1},clicked:function(){i.undoManager.transaction(function(){i.disconnectSelected()})}},edit:{name:t("workflow.defaults.edit"),icon:"edit",shown:function(){return i.getSelectionSize()<=1},clicked:function(e){i.editIcon(d.get(e))},disabled:function(e){return!d.get(e).isEditable()}},delete:{name:t("workflow.defaults.delete"),icon:"delete",clicked:function(){i.undoManager.transaction(function(){i.deleteSelected()})},disabled:function(){return!i.editable}},comment:{name:t("workflow.defaults.comment"),icon:"comment",clicked:function(e){i.editIconComment(d.get(e))},disabled:function(){return!i.editable}}}}}};b.prototype.updateFootnotes=_.throttle(function(){this.forEachNode(function(e){e.setFootnote(-1)});this.$footnotesContainer.html("");if(this.isFootnotesEnabled){var t=this;var i=1;this.forEachNode(function(e){if(d.isCommented(e)){t.$footnotesContainer.append('<li id="#fn:'+i+'">'+e.getComment()+"</li>");e.setFootnote(i);i++}})}},150);b.prototype.moveGridBackground=function(e){const t=this.calculateBackgroundOffsetDelta(e.x);const i=this.calculateBackgroundOffsetDelta(e.y);this.$gridBackground.css({left:"-"+t+"px",top:"-"+i+"px",width:"calc(100% + "+t+"px)",height:"calc(100% + "+i+"px)"})};b.prototype.calculateBackgroundOffsetDelta=function(e){if(e<=0){return e*-1}const t=v.NODE_SIZE*this.scale;const i=e/t%1;return t-t*i};b.prototype.isActionBasedWorkflow=function(){return this.getNodes().some(function(e){return e.getType()===v.NODE_TYPE_ACTION_BASED_MAILING})};b.prototype.isDateBasedWorkflow=function(){return this.getNodes().some(function(e){return e.getType()===v.NODE_TYPE_DATE_BASED_MAILING})};b.prototype.isNormalWorkflow=function(){return!this.isActionBasedWorkflow()&&!this.isDateBasedWorkflow()};b.prototype.getNodes$=function(){return this.$container.find(".node")};b.prototype.getNodes=function(){return this.getNodes$().get().map(function(e){return d.get(e)})};b.prototype.getVertices=function(){return r.verticesFrom(this.getNodes(),this.instance.getAllConnections())};b.prototype.getNodesByTypes=function(t){return this.getNodes().filter(function(e){return t.includes(e.type)})};b.prototype.forEachNode$=function(e){var t=this.getNodes$();var i=this;t.each(function(){e.call(i,$(this))})};b.prototype.forEachNode=function(t){var i=this;this.forEachNode$(function(e){t.call(i,d.get(e))})};b.prototype.forEachPreviousNode=function(t,e){var i=this.getConnections();var n=i.filter(function(e){return e.target===t}).map(function(e){return e.source});var r={};while(n.length){for(var o=0;o<n.length;o++){var s=n[o];var a=s.getId();var l=e.call(this,s);if(l===false){return}r[a]=true}n=i.filter(function(e){if(n.includes(e.target)){var t=e.source.getId();if(r[t]){return false}else{r[t]=true;return true}}else{return false}}).map(function(e){return e.source})}};b.prototype.getNodeIncomingChains=function(t){var e=this.getVertices();var i=e.find(function(e){return e.node==t});var n=[];if(i){return r.getIncomingChains(i)}return n};b.prototype.getNodeOutgoingChains=function(t){var e=this.getVertices();var i=e.find(function(e){return e.node==t});var n=[];if(i){return r.getOutgoingChains(i)}return n};b.prototype.getFirstOutgoingChain=function(e){const t=this.getNodeOutgoingChains(e);if(t.length){return t[0]}return[]};b.prototype.getFirstIncomingChain=function(e){var t=this.getNodeIncomingChains(e);if(t.length){return t[0]}return[]};b.prototype.getNodeIncomingConnections=function(t){return this.getConnections(function(e){return d.get(e.target)===t})};b.prototype.getNodeOutgoingConnections=function(t){return this.getConnections(function(e){return d.get(e.source)===t})};b.prototype.getNodeConnections=function(t){return this.getConnections(function(e){return d.get(e.source)===t||d.get(e.target)===t})};b.prototype.hasNodeIncomingConnections=function(t){return this.instance.getAllConnections().some(function(e){return d.get(e.target)===t})};b.prototype.hasNodeOutgoingConnections=function(t){return this.instance.getAllConnections().some(function(e){return d.get(e.source)===t})};b.prototype.hasConnection=function(t){return this.instance.getAllConnections().some(function(e){return t.call(null,{origin:e,source:d.get(e.source),target:d.get(e.target)})})};b.prototype.getConnections=function(e){var t=this.instance.getAllConnections();if(e){t=t.filter(e)}return t.map(function(e){return{origin:e,source:d.get(e.source),target:d.get(e.target)}})};b.prototype.getConnectionByConnector$=function(t){return this.getConnections(function(e){return e.canvas==t[0]})[0]};b.prototype.getConnectionBetween=function(t,i){return this.getConnections(function(e){return $(e.source).is(t)&&$(e.target).is(i)})[0]};b.prototype.recycle=function(){this.instance.reset();this.$container.empty()};b.prototype.batch=function(){this.instance.batch.apply(this.instance,arguments)};b.prototype.newNode=function(e,t){var i=this;if(this.editable){if(d.isExpandableType(e)){switch(e){case v.NODE_TYPE_SC_ABTEST:case v.NODE_TYPE_SC_BIRTHDAY:case v.NODE_TYPE_SC_DOI:if(v.workflowId===0&&this._isInInitialState()){this.deleteAllNodes()}this.newSnippetFromSample(e,t);break;case v.NODE_TYPE_OWN_WORKFLOW:u.confirmOwnWorkflowExpanding().done(function(e){if(v.workflowId===0&&i._isInInitialState()){i.deleteAllNodes()}i.newSnippetFromOwnWorkflow(e.workflowId,e.copyContent,t)});break}}else{var n=d.create(e);var r=v.NODE_ANIMATION_DROPPED;if(!t){t=this.pickNewNodePosition();r=v.NODE_ANIMATION_AUTO_DROPPED}n.setCoordinates(t.x,t.y);this.undoManager.transaction(function(){i.add(n,r);i.supplement(n)})}}};b.prototype._isInInitialState=function(){return v.intialSchema===this.serializeIcons()};b.prototype.newSnippetFromSample=function(e,i){var n=this;p.loadSample(e,this.isGridDisplayed(),function(e,t){n.newSnippet(e,t,i)})};b.prototype.newSnippetFromOwnWorkflow=function(e,t,i){var n=this;p.loadOwnWorkflow(e,t,function(e,t){if(n.isGridDisplayed()){e.forEach(function(e){n.convertNodeCoordinates(e)})}n.newSnippet(e,t,i)})};b.prototype.newSnippet=function(e,t,i){var n=this;var r=i?v.NODE_ANIMATION_DROPPED:v.NODE_ANIMATION_AUTO_DROPPED;var o=this.getNodesByTypes([v.NODE_TYPE_START]).length>0;var s=this.getNodesByTypes([v.NODE_TYPE_STOP]).length>0;p.removeStartStop(e,t,o,s);if(i){p.adjustPositions(e,i.x,i.y,true)}else{i=this.getCenterPosition();p.adjustPositions(e,i.x,i.y,false)}this.undoManager.transaction(function(){n.batch(function(){var i=n.allocateIds(e.length);n.allocateSpaceForSnippet(e);e.forEach(function(e,t){e.setId(i[t]);n.add(e,r)});t.forEach(function(e){n.connect(e.source,e.target)})})})};b.prototype.allocateId=function(){return this.allocateIds(1)[0]};b.prototype.allocateIds=function(e){var t=[];var i={};this.forEachNode(function(e){i[e.getId()]=true});while(e>0){do{this.lastAllocatedId++}while(i[this.lastAllocatedId]);t.push(this.lastAllocatedId);e--}return t};b.prototype._findMaxNodeId=function(){var t=0;this.forEachNode(function(e){if(e.getId()>t){t=e.getId()}});return t};b.prototype.pickNewNodePosition=function(){var e=this.canvas.getVisibleArea();var n=Math.ceil(e.minY/v.CANVAS_GRID_SIZE);var r=Math.floor(e.maxY/v.CANVAS_GRID_SIZE)-(v.AUTO_DROP_STEP_Y>>1);var o=[];var t;this.forEachNode(function(e){var t=e.getCoordinates();o.push({minX:t.x-v.AUTO_DROP_STEP_X+1,minY:t.y-v.AUTO_DROP_STEP_Y+1,maxX:t.x+v.AUTO_DROP_STEP_X-1,maxY:t.y+v.AUTO_DROP_STEP_Y-1})});var i=function(t,i){if(i<n||i>r){return false}var e=!o.some(function(e){return!(t<e.minX||t>e.maxX||i<e.minY||i>e.maxY)});if(e){return{x:t,y:i}}return false};var s=function(){for(var e=0;e+1<arguments.length;e+=2){var t=i(arguments[e],arguments[e+1]);if(t){return t}}return false};var a=Math.round((e.minX+e.maxX-v.NODE_SIZE)/2/v.CANVAS_GRID_SIZE);var l=Math.round((e.minY+e.maxY-v.NODE_SIZE)/2/v.CANVAS_GRID_SIZE);t=s(a,l);if(t){return t}var c=a;var u=a;var d=l;var h=l;var f=0;while(true){t=s(c-v.AUTO_DROP_STEP_X,l,a,d-v.AUTO_DROP_STEP_Y,a,h+v.AUTO_DROP_STEP_Y,u+v.AUTO_DROP_STEP_X,l);if(t){return t}for(var p=1;p<=f;p++){var g=p*v.AUTO_DROP_STEP_X;var m=p*v.AUTO_DROP_STEP_Y;t=s(c-v.AUTO_DROP_STEP_X,l-m,c-v.AUTO_DROP_STEP_X,l+m,a-g,d-v.AUTO_DROP_STEP_Y,a+g,d-v.AUTO_DROP_STEP_Y,a-g,h+v.AUTO_DROP_STEP_Y,a+g,h+v.AUTO_DROP_STEP_Y,u+v.AUTO_DROP_STEP_X,l-m,u+v.AUTO_DROP_STEP_X,l+m);if(t){return t}}t=s(c-v.AUTO_DROP_STEP_X,d-v.AUTO_DROP_STEP_Y,c-v.AUTO_DROP_STEP_X,h+v.AUTO_DROP_STEP_Y,u+v.AUTO_DROP_STEP_X,d-v.AUTO_DROP_STEP_Y,u+v.AUTO_DROP_STEP_X,h+v.AUTO_DROP_STEP_Y);if(t){return t}c-=v.AUTO_DROP_STEP_X;u+=v.AUTO_DROP_STEP_X;d-=v.AUTO_DROP_STEP_Y;h+=v.AUTO_DROP_STEP_Y;f++}};b.prototype.getCenterPosition=function(){var e=this.canvas.getVisibleArea();var t=Math.round((e.minX+e.maxX-v.NODE_SIZE)/2/v.CANVAS_GRID_SIZE);var i=Math.round((e.minY+e.maxY-v.NODE_SIZE)/2/v.CANVAS_GRID_SIZE);return{x:t,y:i}};b.prototype.getLinkedFilledStartNodes=function(e){return _.compact(this.getNodeIncomingChains(e).map(function(e){return _.find(e,function(e){return e.getType()===v.NODE_TYPE_START})})).filter(function(e){return e.isFilled()})};b.prototype.isAutoOptimizationDecisionAllowed=function(e){const t=this.getLinkedFilledStartNodes(e);if(t.length===0){return true}return t.every(function(e){return v.constants.startTypeEvent!==e.data.startType})};b.prototype._possibleToAutoConvertMailingsTypeToActionBased=function(e){const t=this.getLinkedFilledStartNodes(e);return!!t.length&&t.every(function(e){return v.constants.startTypeEvent===e.data.startType&&"EVENT_REACTION"===e.data.event})};b.prototype._possibleToAutoConvertMailingsTypeToDateBased=function(e){const t=this.getLinkedFilledStartNodes(e);return!!t.length&&t.every(function(e){return v.constants.startTypeEvent===e.data.startType&&"EVENT_DATE"===e.data.event})};b.prototype.autoConvertMailingNodesTypeIfPossible=function(){const i=this;const e=[v.NODE_TYPE_MAILING,v.NODE_TYPE_ACTION_BASED_MAILING,v.NODE_TYPE_DATE_BASED_MAILING];this.getNodesByTypes(e).forEach(function(e){const t=undefined;if(e.type===t){return}e.type=t;if(e.isFilled()){e.data.mailingId=0;e.setFilled(false);i.updateNodeTitle(e,true)}})};b.prototype.allocateSpaceForSnippet=function(s){var t=this;function n(e,t){var i=e.getCoordinates();var n=t.getCoordinates();return Math.abs(i.x-n.x)<v.AUTO_DROP_STEP_X&&Math.abs(i.y-n.y)<v.AUTO_DROP_STEP_Y}function a(e,i){return e.some(function(t){return i.some(function(e){return n(t,e)})})}function i(e){var t=0,i=0,n=0,r=0;e.forEach(function(e){t=Math.min(t,e.getX());i=Math.max(i,e.getX());n=Math.min(n,e.getY());r=Math.max(r,e.getY())});return{x:(i-t)/2,y:(r-n)/2}}function r(e,t){if(Math.abs(e.x-t.x)>=Math.abs(e.y-t.y)){return e.x<t.x?{x:-v.AUTO_DROP_STEP_X,y:0}:{x:v.AUTO_DROP_STEP_X,y:0}}else{return e.y<t.y?{x:0,y:-v.AUTO_DROP_STEP_Y}:{x:0,y:v.AUTO_DROP_STEP_Y}}}function l(e,i){e.forEach(function(e){var t=e.getCoordinates();e.setCoordinates(t.x+i.x,t.y+i.y)})}if(s.length){var e=this.getNodes();var o=e.map(function(e){return{node:e,coordinates:e.getCoordinates(),dragMode:t.getCurrentDragMode()}});var c=i(s);var u=h.detectGroups(this.getVertices()).map(function(e){var t=e.getNodes();return{nodes:t,moveDirection:r(i(t),c)}});u.forEach(function(t){if(a(t.nodes,s)){var i=t.moveDirection;var n=t.nodes.slice(0);var r=s.slice(0);var e=u.filter(function(e){return e!==t});do{l(n,i);var o;do{o=false;e=e.filter(function(e){if(a(n,e.nodes)){if(e.moveDirection.x==i.x&&e.moveDirection.y==i.y){l(e.nodes,i);Array.prototype.push.apply(n,e.nodes);o=true}else{Array.prototype.push.apply(r,e.nodes)}return false}else{return true}})}while(o)}while(a(n,r))}});o=o.filter(function(e){var t=e.node.getCoordinates();var i=e.coordinates;return t.x!=i.x||t.y!=i.y});if(o.length){this.undoManager.operation("nodeMoved",o)}}};b.prototype.allocateSpaceForSupplement=function(e,t){var n=[];var i=function(t,i){return!n.some(function(e){return!(t<e.minX||t>e.maxX||i<e.minY||i>e.maxY)})};this.forEachNode(function(e){var t=e.getCoordinates();n.push({minX:t.x-v.AUTO_DROP_STEP_X+1,minY:t.y-v.AUTO_DROP_STEP_Y+1,maxX:t.x+v.AUTO_DROP_STEP_X-1,maxY:t.y+v.AUTO_DROP_STEP_Y-1})});var r=0;var o=0;switch(t){case v.LEFT:default:r=-1;break;case v.RIGHT:r=+1;break;case v.TOP:o=-1;break;case v.BOTTOM:o=+1;break}var s=e.getX()+v.AUTO_DROP_STEP_X*r;var a=e.getY()+v.AUTO_DROP_STEP_Y*o;while(!i(s,a)){s+=r;a+=o}return{x:s,y:a}};b.prototype.allocateSpaceForIncomingSupplement=function(e){var t=this.getAnchorsInUse(e);var i=v.LEFT;if(!t[v.LEFT]&&t[v.TOP]){i=v.TOP}return this.allocateSpaceForSupplement(e,i)};b.prototype.allocateSpaceForOutgoingSupplement=function(e){var t=this.getAnchorsInUse(e);var i=v.RIGHT;if(!t[v.RIGHT]&&t[v.BOTTOM]){i=v.BOTTOM}return this.allocateSpaceForSupplement(e,i)};b.prototype.add=function(i,e){var n=this;var r=i.get$();if(!i.getId()){i.setId(this.allocateId())}i.appendTo(this.$container,this.$titlesContainer,e);i.setInteractionEnabled(this.editable);i.updateCommentLabels();this.instance.makeTarget(r,{anchor:i.getAnchors()});this.instance.makeSource(r,{anchor:i.getAnchors(),filter:".node-connect-button svg"});this.initDraggableOptions(r);var o;r.on({mousedown:function(e){if(e.button===v.MOUSE_BUTTON_MIDDLE){if(n.editable){n.undoManager.transaction(function(){n.deleteNode(r)})}}else{i.wasDragging=false;o=d.isSelected(r);if(!o){if(n.isChainMode()){if(!n.isChainSourceSelected()){n.setNodeSelected(r,true);d.setChainSource(r,true)}else{var t=n.getChainSource();_.defer(function(){n.undoManager.transaction(function(){var e=n.connect(d.get(t),i);if(e){n.deselectAll();n.setNodeSelected(r,true);d.setChainSource(r,true)}else if(e===false){workflowNotAllowedConnectionDialogHandler.showDialog()}})})}}else if(!e.shiftKey&&!e.ctrlKey){n.deselectAll();n.setNodeSelected(r,true)}else{n.setNodeSelected(r,true)}}}y.blurInputFields()},mouseup:function(e){if(o&&!i.wasDragging){if(n.isChainMode()){n.setNodeSelected(r,false);d.setChainSource(r,false)}else if(e.shiftKey||e.ctrlKey){n.setNodeSelected(r,false)}else{n.deselectAll();n.setNodeSelected(r,true)}}},dblclick:function(){n.editIcon(i)},mouseenter:function(){i.setHovered(true)},mouseleave:function(){i.setHovered(false)}});this.undoManager.operation("nodeAdded",i);this.updateMinimap();this.updateFootnotes()};b.prototype.supplement=function(e,t,i){var l=this;if(e.isFilled()){if(v.NODE_TYPES_MAILING.includes(e.getType())&&!f.isPausedWorkflow()){const s=this._findFinalParameterNode(e);if(s){this._fillOptimizationFinalMailingIfPossible(s)}t.trySupplementChain(this.getFirstIncomingChain(e),i,function(a){l.batch(function(){var e=a[0];for(var t=1;t<a.length;t++){var i=a[t];if(i.isAppended()){e=i}else{for(var n=t;n<a.length;n++){var r=a[n];if(r.isAppended()){l.deleteConnectionBetween(r.get$(),e.get$());e=r;t=n;break}}}}for(var t=1;t<a.length;t++){var i=a[t];if(!i.isAppended()){var o=a[t-1];var s=l.allocateSpaceForIncomingSupplement(o);i.setCoordinates(s.x,s.y);l.add(i);l.connect(i,o);if(t+1<a.length&&a[t+1].isAppended()){l.connect(a[t+1],i)}f.resave(i)}}})});this.autoConvertMailingNodesTypeIfPossible()}else if(v.NODE_TYPE_RECIPIENT==e.getType()){this.processRecipientsChains()}else if(v.NODE_TYPE_PARAMETER===e.getType()){const s=l._findFinalParameterNode(e);if(s){const a=l._findTestMailingsParamsNodes(s);const c=e.getData().value;l._setParameterNodesValue(a,c);const u=c*a.length;f.modify(s,function(e){e.setFilled(true);e.setEditable(false);e.getData().value=100-u})}}else if(v.NODE_TYPE_START==e.getType()){this.autoConvertMailingNodesTypeIfPossible()}}else{if(v.NODE_TYPE_IMPORT==e.getType()){var n=!this.hasNodeOutgoingConnections(e);if(n){var r=d.create(v.NODE_TYPE_DEADLINE);var o=this.allocateSpaceForOutgoingSupplement(e);r.setCoordinates(o.x,o.y);this.add(r);this.connect(e,r)}}}};b.prototype.isAutoOptimizationWorkflow=function(e){const t=this._findFinalParameterNode(e);if(!t){return false}const i=this._findOptimizationFinalMailingNode(t);if(!i){return false}const n=this.getFirstIncomingChain(t).find(function(e){return e.getType()===v.NODE_TYPE_DECISION});return!!n&&n.data.decisionType===v.constants.decisionTypeAutoOptimization};b.prototype.getParametersOptions=function(e){const t=this._findFinalParameterNode(e);var i=v.SPLIT_DEFAULT_PARAMETERS;if(t){const n=this._findTestMailingsParamsNodes(t);const r=n.length+1;const o=Math.floor(100/r);i=i.filter(function(e){return e<=o})}return i.map(function(e){return{id:e,text:e}})};b.prototype._fillOptimizationFinalMailingIfPossible=function(e){if(!this._isAllOptimizationTestMailingsFilled(e)){return}const t=this._findOptimizationFinalMailingNode(e);const i=t.getTitle();f.modify(t,function(e){e.setFilled(true)});t.setTitle(i)};b.prototype._findFinalParameterNode=function(e){const t=this.getNodeOutgoingChains(e);for(var i=0;i<t.length;i++){const n=t[i];const r=n.find(function(e,t){return t>0&&v.NODE_TYPE_PARAMETER===e.getType()});if(r){return r}}return null};b.prototype._findTestMailingsParamsNodes=function(e){const i=[];this.getNodeIncomingChains(e).forEach(function(e){const t=e.find(function(e,t){return t>0&&v.NODE_TYPE_PARAMETER===e.getType()});if(t){i.push(t)}});return i};b.prototype._findOptimizationFinalMailingNode=function(e){const t=this.getFirstOutgoingChain(e);return t.find(function(e){return e.getType()===v.NODE_TYPE_MAILING&&!e.isEditable()})};b.prototype._isAllOptimizationTestMailingsFilled=function(e){const t=this._findTestMailingsParamsNodes(e);for(var i=0;i<t.length;i++){const n=t[i];const r=this.getFirstOutgoingChain(n);if(r.length<=1){return false}const o=r[1];if(o.getType()!==v.NODE_TYPE_MAILING||!o.isFilled()||!o.isEditable()){return false}}return true};b.prototype._setParameterNodesValue=function(e,t){e.forEach(function(e){f.modify(e,function(e){e.setFilled(true);e.getData().value=t})})};b.prototype.processRecipientsChains=_.debounce(function(){var e=this._findInitialRecipientsNodes();var r=this;e.forEach(function(n){n.setInRecipientsChain(false);r.updateNodeTitle(n);var e=r.getNodeOutgoingChains(n);e.forEach(function(e){var t=1;for(;t<e.length;++t){var i=e[t];if(i.type!=v.NODE_TYPE_RECIPIENT){break}i.data.mailinglistId=n.data.mailinglistId;i.setInRecipientsChain(true);r.updateNodeTitle(i)}})})},150);b.prototype._findInitialRecipientsNodes=function(){var e=this.getNodesByTypes([v.NODE_TYPE_RECIPIENT]);var t=this.getConnections();var i=[];t.filter(function(e){return e.target.type==v.NODE_TYPE_RECIPIENT&&e.source.type==v.NODE_TYPE_RECIPIENT}).forEach(function(e){i.push(e.target.id)});return e.filter(function(e){return!i.includes(e.id)})};b.prototype.getAnchorsInUse=function(e){var t=e.get$();return d.getAnchorsInUse(this.instance.getEndpoints(t[0]))};b.prototype.positionTitle=function(e){o.positionTitle(e,this.getAnchorsInUse(e))};b.prototype.updateNodeTitle=function(e,t){var i=this.isNormalWorkflow();o.updateTitle(e,i,t);this.positionTitle(e)};b.prototype.updateNodeTitles=_.throttle(function(t){var i=this;var n=this.isNormalWorkflow();this.forEachNode(function(e){o.updateTitle(e,n,t);i.positionTitle(e)})},150);b.prototype.positionTitles=_.throttle(function(){var t=this;this.forEachNode(function(e){t.positionTitle(e)})},150);b.prototype.setMinimapEnabled=function(e){this.canvas.setMinimapEnabled(e)};b.prototype.updateMinimap=_.debounce(function(){this.canvas.updateMinimap()},100);b.prototype.isChainSourceSelected=function(){return this.$container.find(".node.chain-mode-source").exists()};b.prototype.getChainSource=function(){return this.$container.find(".node.chain-mode-source")};b.prototype.setNodeSelected=function(e,t){if(t){this.instance.addToDragSelection(e)}else{this.instance.removeFromDragSelection(e)}d.setSelected(e,!!t);this.onSelectionChanged()};b.prototype.isConnectionPossible=function(t,i){if(t instanceof d&&i instanceof d){if(t===i){return false}return!this.hasConnection(function(e){return e.source===t&&e.target===i||e.source===i&&e.target===t})}return false};b.prototype.isConnectionAllowed=function(e,t){var i=new s(v.CONNECTION_CONSTRAINTS);var n=this;var r={node:e,type:e.getType(),connections:{}};var o={node:t,type:t.getType(),connections:{}};Object.defineProperty(r.connections,"incoming",{get:m.caching(n.getNodeIncomingConnections,n,e)});Object.defineProperty(r.connections,"outgoing",{get:m.caching(n.getNodeOutgoingConnections,n,e)});Object.defineProperty(o.connections,"incoming",{get:m.caching(n.getNodeIncomingConnections,n,t)});Object.defineProperty(o.connections,"outgoing",{get:m.caching(n.getNodeOutgoingConnections,n,t)});if(r.type==v.NODE_TYPE_STOP&&!this.hasNodeIncomingConnections(e)){r.type=v.NODE_TYPE_START;r.node.type=v.NODE_TYPE_START}if(o.type==v.NODE_TYPE_START&&!this.hasNodeOutgoingConnections(t)){o.type=v.NODE_TYPE_STOP;o.node.type=v.NODE_TYPE_STOP}return i.check(r,o)};b.prototype.connect=function(e,t,i){if(this.isConnectionPossible(e,t)){if(!this.isConnectionAllowed(e,t)){return false}if(e.getType()===v.NODE_TYPE_STOP){e.setType(v.NODE_TYPE_START)}if(t.getType()===v.NODE_TYPE_START){t.setType(v.NODE_TYPE_STOP)}if(i!==true){this.instance.connect({source:e.get$(),target:t.get$()})}return true}else{return null}};b.prototype.deselectAll=function(){this.$container.find(".node.ui-selected").removeClass("ui-selected");this.instance.clearDragSelection();this.clearSelectedSource();this.onSelectionChanged()};b.prototype.clearSelectedSource=function(){this.$container.find(".node.chain-mode-source").removeClass("chain-mode-source")};b.prototype.alignAll=function(){var t=this;var e=this.getNodes();var i={};e.forEach(function(e){i[e.getId()]=e.getCoordinates()});this.batch(function(){l.align(t.getVertices())});var n=e.filter(function(e){var t=i[e.getId()];return t.x!=e.getX()||t.y!=e.getY()}).map(function(e){return{node:e,coordinates:i[e.getId()],dragMode:t.getCurrentDragMode()}});if(n.length){t.undoManager.transaction(function(){t.undoManager.operation("nodeMoved",n)});this.positionTitles();this.updateMinimap()}};b.prototype.deleteSelected=function(){this.deleteNodes(this.getSelectedNodes())};b.prototype.deleteNode=function(e){var t=this;if(e instanceof d){}else{e=d.get(e)}if(e.isAppended()){var i=[e];switch(e.getType()){case v.NODE_TYPE_IMPORT:this.getNodeOutgoingConnections(e).forEach(function(e){if(v.NODE_TYPE_DEADLINE==e.target.getType()){i.push(e.target)}});break;case v.NODE_TYPE_DEADLINE:this.getNodeIncomingConnections(e).forEach(function(e){if(v.NODE_TYPE_IMPORT==e.source.getType()){i.push(e.source)}});break}i.forEach(function(e){t.undoManager.operation("nodeDeleted",e);t.instance.remove(e.get$());e.remove()});this.onSelectionChanged();this.positionTitles();this.updateFootnotes();this.updateMinimap()}};b.prototype.deleteAllNodes=function(){this.deleteNodes(this.getNodes())};b.prototype.deleteNodes=function(e){var t=this;this.undoManager.transaction(function(){t.batch(function(){e.forEach(function(e){t.deleteNode(e)})})})};b.prototype.disconnectSelected=function(){this.disconnectNodes(this.getSelectedNodes())};b.prototype.disconnectNode=function(e){var t=this;this.getNodeConnections(e).forEach(function(e){t.deleteConnection(e)})};b.prototype.disconnectNodes=function(e){var t=this;this.batch(function(){e.forEach(function(e){t.disconnectNode(e)})})};b.prototype.canDeleteConnection=function(e){var t,i;if(e.origin){t=e.source;i=e.target}else{t=d.get(e.source);i=d.get(e.target)}return!(v.NODE_TYPE_IMPORT==t.getType()&&v.NODE_TYPE_DEADLINE==i.getType())};b.prototype.deleteConnection=function(e){if(this.canDeleteConnection(e)){if(e.origin){this.instance.deleteConnection(e.origin)}else{this.instance.deleteConnection(e)}return true}return false};b.prototype.deleteConnectionBetween=function(e,t){var i=this.getConnectionBetween(e,t);if(i){this.deleteConnection(i)}};b.prototype.connectSelected=function(){return this.connectNodes(this.getSelectedNodes())};b.prototype.connectBetweenSelected=function(){var e=this.getSelectedNodes$();if(e.length>=2){return this.connectNodes(this.getNodesBetweenSelected(e[0],e[1]))}else{return false}};b.prototype.getNodesBetweenSelected=function(e,t){var i=d.getBox(e);var n=d.getBox(t);var r={minX:Math.min(i.minX,n.minX),maxX:Math.max(i.maxX,n.maxX),minY:Math.min(i.minY,n.minY),maxY:Math.max(i.maxY,n.maxY)};return this.getNodes().filter(function(e){return d.isInRegion(e.get$(),r)})};b.prototype.connectNodes=function(e){var t=this;var i=e.sort(function(e,t){return e.getX()<t.getX()?-1:e.getX()>t.getX()?1:e.getY()<t.getY()?-1:e.getY()>t.getY()?1:0});var n=false;this.undoManager.transaction(function(){t.batch(function(){for(var e=0;e<i.length-1;e++){if(t.connect(i[e],i[e+1])){n=true}}})});return n};b.prototype.getSelectedNodes$=function(){var i=[];this.$container.find(".node.ui-selected").each(function(e,t){i.push($(t))});return i};b.prototype.getSelectedNodes=function(){return this.getSelectedNodes$().map(function(e){return d.get(e)})};b.prototype.getSelectionSize=function(){return this.$container.find(".node.ui-selected").length};b.prototype.onSelectionChanged=function(){y.setDeleteButtonEnabled(this.getSelectionSize()>0)};b.prototype.setOnInitialized=function(e){const t=this;const i=function(){e.apply(this);t.lastAllocatedId=t._findMaxNodeId()};this.instance.ready(i)};b.prototype.setOnZoom=function(e){this.canvasZoomHandler=e};b.prototype.setEditable=function(t){t=!!t;if(this.editable!==t){this.editable=t;this.draggableButtons.setEnabled(t);this.$viewport.selectable(t?"enable":"disable");this.forEachNode(function(e){e.setInteractionEnabled(t)})}};b.prototype.getZoom=function(){return this.instance.getZoom()};b.prototype.setZoom=function(e){this.scale=e;this.canvas.setZoom(e);this.instance.setZoom(e);this.updateBackgroundCellSize(e);this.moveGridBackground(this.canvas.getPosition())};b.prototype.toggleGrid=function(){this.changeGridBackgroundVisibility();this.dragMode=this.isGridDisplayed()?v.GRID_CELL_DRAG_MODE:v.DEFAULT_DRAG_MODE;this.adaptToNewDragMode()};b.prototype.changeGridBackgroundVisibility=function(){this.$gridBackground.toggleClass("hidden")};b.prototype.convertNodeCoordinates=function(e){const t=e.getCoordinates();this.convertCoordinates(t);e.setCoordinates(t.x,t.y)};b.prototype.convertCoordinates=function(e){const t=v.NODE_SIZE/v.CANVAS_DEFAULT_GRID_SIZE;if(this.getCurrentDragMode()===v.GRID_CELL_DRAG_MODE){e.x=e.x/t;e.y=e.y/t}else{e.x=e.x*t;e.y=e.y*t}};b.prototype.adaptToNewDragMode=function(){this.adaptPropertiesToDragMode();const t=this;this.getNodes$().each(function(){t.instance.destroyDraggable(this);t.initDraggableOptions($(this))});this.forEachNode(function(e){t.convertNodeCoordinates(e)})};b.prototype.adaptPropertiesToDragMode=function(){if(this.getCurrentDragMode()===v.GRID_CELL_DRAG_MODE){v.CANVAS_GRID_SIZE=v.NODE_SIZE;v.AUTO_ALIGN_STEP_X=v.GRID_AUTO_ALIGN_STEP_X;v.AUTO_ALIGN_STEP_Y=v.GRID_AUTO_ALIGN_STEP_Y}else{v.CANVAS_GRID_SIZE=v.CANVAS_DEFAULT_GRID_SIZE;v.AUTO_ALIGN_STEP_X=v.DEFAULT_AUTO_ALIGN_STEP_X;v.AUTO_ALIGN_STEP_Y=v.DEFAULT_AUTO_ALIGN_STEP_Y}};b.prototype.initDraggableOptions=function(e){const r=this;const n=d.get($(e));this.instance.draggable(e,{distance:v.CANVAS_GRID_SIZE/2,grid:[v.CANVAS_GRID_SIZE,v.CANVAS_GRID_SIZE],rightButtonCanDrag:false,canDrag:function(){return r.editable},start:function(){n.wasDragging=true;if(r.drag==null){var t=[];var i=[];n.setPopoverEnabled(false);r.forEachNode$(function(e){if(d.isSelected(e)){t.push(e);d.get(e).setTitleEnabled(false)}else{i.push(d.getCollisionBox(e))}});r.drag={lead:e,selected:t,unselected:i}}},stop:function(){r.drag.lead.removeClass("js-no-drop");r.drag.selected.forEach(function(e){d.get(e).setTitleEnabled(true);e.removeClass("js-collision-detected")});n.setPopoverEnabled(true)},drag:function(){if(r.drag&&e==r.drag.lead){var n=false;r.drag.selected.forEach(function(e){var t=d.getCollisionBox(e);var i=r.drag.unselected.some(function(e){return d.detectBoxCollision(e,t)});e.toggleClass("js-collision-detected",i);if(i){n=true}});r.drag.lead.toggleClass("js-no-drop",n)}},revert:function(){if(r.drag){var e=false;r.undoManager.transaction(function(){var t=r.getZoom();e=r.drag.selected.some(function(e){var t=d.getCollisionBox(e);return r.drag.unselected.some(function(e){return d.detectBoxCollision(e,t)})});if(!e){r.undoManager.operation("nodeMoved",r.drag.selected.map(function(e){var t=d.get(e);return{node:t,coordinates:t.getCoordinates(),dragMode:r.getCurrentDragMode()}}));r.drag.selected.forEach(function(e){d.get(e).updateCoordinates(t)})}r.drag=null;r.updateOverlays();r.positionTitles();r.updateMinimap()});return e}else{return false}}})};b.prototype.getCurrentDragMode=function(){return this.dragMode};b.prototype.isGridDisplayed=function(){return!this.$gridBackground.hasClass("hidden")};b.prototype.updateBackgroundCellSize=function(e){const t=v.NODE_SIZE*e;this.$gridBackground.css("background-size",t+"px "+t+"px")};b.prototype.setPanningEnabled=function(e){this.canvas.setPanningEnabled(e);this.$viewport.toggleClass("js-panning",!!e);if(e){this.$viewport.selectable("disable")}else if(this.editable){this.$viewport.selectable("enable")}};b.prototype.setMouseWheelZoomEnabled=function(e){this.canvas.setMouseWheelZoomEnabled(e)};b.prototype.setMultiConnectionEnabled=function(e){this.multiConnectionEnabled=e};b.prototype.setChainModeEnabled=function(e){this.chainModeEnabled=e;this.clearSelectedSource();if(e){var t=this.getSelection().shift();if(t){this.deselectAll();this.setNodeSelected(t,true);d.setChainSource(t,true)}}};b.prototype.isChainMode=function(){return this.chainModeEnabled===true};b.prototype.updateOverlays=_.debounce(function(){this.forEachNode(function(e){if(d.isDecisionNode(e)){this.updateDecisionBranchesOverlays(e)}})},100);b.prototype.updateDecisionBranchesOverlays=function(e){var t=this.getNodeOutgoingConnections(e);if(d.isBranchingDecisionNode(e)){var i=d.getDecisionBranches(t);if(i){var n=o.getDecisionBranchesLabels();y.setConnectionLabel(i.positive,n.positive);y.setConnectionLabel(i.negative,n.negative)}else{t.forEach(function(e){y.setConnectionLabel(e,"?")})}}else{t.forEach(function(e){y.setConnectionLabel(e,false)})}};b.prototype.editIcon=function(e){if(this.drag==null){if(e){if(e.editable){this.deselectAll();f.showEditDialog(e,i.checkActivation(!d.isMailingNode(e)))}}else{var t=this.getSelection();if(t.length==1){this.deselectAll();const e=d.get(t[0]);f.showEditDialog(e,i.checkActivation(!d.isMailingNode(e)))}}}};b.prototype.editIconComment=function(e){f.showIconCommentDialog(e)};b.prototype.serializeIcons=function(){var e=this.getNodes().map(function(e){return e.serialize()});var i={};this.getConnections().forEach(function(e){var t=i[e.source.id];if(!t){t=[]}t.push(e);i[e.source.id]=t});e.forEach(function(e){var t=i[e.id];if(t){e.connections=t.map(function(e){return{targetIconId:e.target.id}})}else{e.connections=[]}});return JSON.stringify(e)};b.prototype.undo=function(){this.undoManager.undo()};b.prototype.getUndoManager=function(){return this.undoManager};b.prototype.hasUnsavedChanges=function(){return this.getUndoManager().canUndo()};b.prototype.fitPdfPage=function(){this.canvas.fitPdfPage(v.PDF_SIZE,v.PDF_ORIENTATION)};AGN.Lib.WM.Editor=b})();(function(){function e(e,t){if(typeof e==="string"&&typeof t==="string"){return e.toLowerCase().localeCompare(t.toLowerCase())}return e.localeCompare(t)}AGN.Lib.TableCaseInsensitiveComparator=e})();(function(){var e=function(){};function t(e,t){if(e.value){if(!e.valueFormatted){e.valueFormatted=moment(e.value).format(t)}return e.valueFormatted}else{return""}}e.prototype.init=function(e){this.eGui=AGN.Lib.TableCellWrapper(e.data.show);if(e.optionDateFormat){this.format=e.optionDateFormat}else{this.format="DD.MM.YYYY";if(e.optionShowTime){if(e.optionShowSeconds){this.format+=" HH:mm:ss"}else{this.format+=" HH:mm"}}}this.eGui.innerHTML=t(e,this.format)};e.prototype.getGui=function(){return this.eGui};e.prototype.refresh=function(e){this.eGui.innerHTML=t(e,this.format);return true};e.prototype.destroy=function(){};AGN.Opt.TableCellRenderers["DateCellRenderer"]=e})();class DateRangeFilter{init(e){this.params=e;this.column=e.column.colId;this.$fromDate=this.#getDateRangeFilter(e,"from");this.$toDate=this.#getDateRangeFilter(e,"to")}#getDateRangeFilter(e,t){let i=$(`${e.colDef[`filter${_.capitalize(t)}Input`]}`);if(!i.length){i=$(`#${e.column.colId}-${t}-filter`)}return i}#getIsoVal(e){return e.datepicker("getDate")?.toISOString()}isFilterActive(){return this.fromDate||this.toDate}doesFilterPass(e){const t=e.data[this.column]?.date||this.params.valueGetter(e);if(!this.fromDate&&!this.toDate){return true}if(!t){return false}if(this.fromDate&&this.toDate){return t>=this.fromDate&&t<=this.toDate}if(this.fromDate){return t>=this.fromDate}if(this.toDate){return t<=this.toDate}}getModel(){return{fromDate:this.fromDate,toDate:this.toDate}}setModel(e){if(this.$fromDate?.length){const t=this.#getIsoVal(this.$fromDate);this.fromDate=t?new Date(t):null}if(this.$toDate?.length){const i=this.#getIsoVal(this.$toDate);this.toDate=i?new Date(i):null}}getGui(){return document.createElement("div")}}(function(){var o=AGN.Lib.Table,s=AGN.Lib.Confirm,a=AGN.Lib.Page,t=AGN.Lib.Tooltip,e=function(){};function i(e){return e.valueFormatted?e.valueFormatted:e.value}e.prototype.init=function(r){r.eGridCell.classList.add("ag-cell-table-actions");this.eGui=document.createElement("div");this.eGui.innerHTML='<button type="button" class="btn btn-icon-sm btn-danger"><i class="icon icon-trash-alt"></i></button>';this.eButton=this.eGui.querySelector(".btn");if(r.colDef["button-tooltip"]){t.createTip($(this.eButton),r.colDef["button-tooltip"])}var e=i(r);if(e){this.eButton.setAttribute("href",e)}else{this.eGui.style.visibility="hidden"}this.eventListener=function(e){const n=this;$.get(i(r)).done(function(e){const t=$(e);const i=t.all(".modal");if(i.length==1){s.create(e).done(function(e){const t=$(e);const i=o.get($(n)).api;i.applyTransaction({remove:[r.data]});AGN.Lib.RenderMessages(t)})}else{a.render(e)}});e.preventDefault();return false};this.eButton.addEventListener("click",this.eventListener)};e.prototype.getGui=function(){return this.eGui};e.prototype.refresh=function(e){var t=i(e);this.eGui.style.visibility=t?"visible":"hidden";this.eButton.dataset.url=t;return true};e.prototype.destroy=function(){this.eButton.removeEventListener("click",this.eventListener)};AGN.Opt.TableCellRenderers["DeleteCellRenderer"]=e})();class DeliveryDateFilter extends DateRangeFilter{init(e){super.init(e);this.$filterType=$(`#${this.column}-filter`)}doesFilterPass(e){const t=e.data[this.column];return this.doesDateFilterPass(t)&&super.doesFilterPass(e)||this.doesSoftBounceFilterPass(t)||this.doesHardBounceFilterPass(t)||this.doesNoFeedbackFilterPass(t)}doesDateFilterPass(e){return e&&this.types.includes("date")&&!["soft-bounce","hard-bounce"].includes(e)}doesSoftBounceFilterPass(e){return this.types.includes("soft-bounce")&&e==="soft-bounce"}doesHardBounceFilterPass(e){return this.types.includes("hard-bounce")&&e==="hard-bounce"}doesNoFeedbackFilterPass(e){return this.types.includes("no-feedback")&&!e}isFilterActive(){return this.types.length>0}getModel(){return{...super.getModel(),types:this.types}}setModel(e){super.setModel(e);this.types=[...this.$filterType.val()]}}AGN.Opt.Table["filters"]["DeliveryDateFilter"]=DeliveryDateFilter;const cachedTemplates=[];(function(){const n=AGN.Lib.Template;var e=function(){};e.prototype.init=function(e){this.eGui=AGN.Lib.TableCellWrapper(e.colDef["noViewLink"]?"":e.data.show);let t;const i=e.templateName;if(cachedTemplates[i]){t=cachedTemplates[i]}else{t=n.prepare(i);cachedTemplates[i]=t}this.eGui.innerHTML=t({value:e.value,entry:e.data})};e.prototype.getGui=function(){return this.eGui};e.prototype.refresh=function(){return false};e.prototype.destroy=function(){};AGN.Opt.TableCellRenderers["MustacheTemplateCellRender"]=e})();(function(){var e=function(){};e.prototype.init=function(e){this.agParams=e;this.eGui=document.createComment("No label")};e.prototype.getGui=function(){return this.eGui};e.prototype.destroy=function(){};AGN.Opt.TableHeaderComponents["NoLabelHeader"]=e})();(function(){var e=function(){};e.prototype.init=function(e){this.gui=AGN.Lib.TableCellWrapper(e.data.show);var t=document.createElement("div");if(e.value){t.innerHTML=e.value}t.style.cssText="text-overflow: ellipsis;"+"overflow: hidden;";this.gui.appendChild(t)};e.prototype.getGui=function(){return this.gui};e.prototype.refresh=function(){return false};AGN.Opt.TableCellRenderers["NotEscapedStringCellRenderer"]=e})();(function(){function e(e,t,i,n,r){e=parseFloat(e);t=parseFloat(t);if(isNaN(e)||isNaN(t)){if(!isNaN(e)){return r?+1:-1}if(!isNaN(t)){return r?-1:+1}return 0}return e-t}AGN.Lib.TableNumberComparator=e})();(function(){var e=AGN.Lib.Table,n=AGN.Lib.Confirm,r=AGN.Lib.Page,t=function(){};function o(e){if(e.deliveryHistoryEnabled){return AGN.url("/recipient/"+e.recipientId+"/mailing/"+e.data.mailingId+"/deliveryHistory.action")}else{return""}}t.prototype.init=function(i){this.eGui=document.createElement("div");var e=o(i);if(!e){this.eGui.innerHTML=i.value}else{i.eGridCell.classList.add("ag-cell-table-actions");this.eGui.innerHTML='<button type="button" class="btn btn-pill"><i class="icon icon-external-link-alt"></i><span>'+i.value+"</span></button>";this.eButton=this.eGui.querySelector(".btn");this.eButton.setAttribute("href",e);this.eventListener=function(e){var t=o(i);if(t){$.get(t).done(function(e){var t=$(e),i;i=t.all(".modal");if(i.length==1){n.create(e)}else{r.render(e)}});e.preventDefault();return false}};this.eButton.addEventListener("click",this.eventListener)}};t.prototype.getGui=function(){return this.eGui};t.prototype.refresh=function(e){if(this.eButton){this.eButton.dataset.url=o(e)}return true};t.prototype.destroy=function(){if(this.eButton){this.eButton.removeEventListener("click",this.eventListener)}};AGN.Opt.TableCellRenderers["RecipientDeliveryInfoRenderer"]=t})();(function(){var n=AGN.Lib.Confirm,r=AGN.Lib.Page,e=function(){};function o(e){if(e.deliveryHistoryEnabled){return AGN.url("/recipient/"+e.recipientId+"/mailing/"+e.data.mailingId+"/successfulDeliveryHistory.action")}else{return""}}e.prototype.init=function(i){this.eGui=document.createElement("div");var e=o(i);if(!e){this.eGui.innerHTML=i.value}else{i.eGridCell.classList.add("ag-cell-table-actions");this.eGui.innerHTML='<button type="button" class="btn btn-pill"><i class="icon icon-external-link-alt"></i><span>'+i.value+"</span></button>";this.eButton=this.eGui.querySelector(".btn");this.eButton.setAttribute("href",e);this.eventListener=function(e){var t=o(i);if(t){$.get(t).done(function(e){var t=$(e),i;i=t.all(".modal");if(i.length==1){n.create(e)}else{r.render(e)}});e.preventDefault();return false}};this.eButton.addEventListener("click",this.eventListener)}};e.prototype.getGui=function(){return this.eGui};e.prototype.refresh=function(e){if(this.eButton){this.eButton.dataset.url=o(e)}return true};e.prototype.destroy=function(){if(this.eButton){this.eButton.removeEventListener("click",this.eventListener)}};AGN.Opt.TableCellRenderers["RecipientSuccessDeliveryInfoRenderer"]=e})();class SetFilter{init(e){this.params=e;this.column=e.column.colId;this.$el=$(`#${this.column}-filter`);this.filterValues=this.$el.val()}getGui(){return document.createElement("div")}doesFilterPass(e){if(!this.filterValues.length){return true}let t=e.data[this.column];t=t?.name||t;return this.filterValues.includes(t)}isFilterActive(){return this.filterValues.length>0}getModel(){return{values:this.filterValues}}setModel(e){this.filterValues=this.$el.val()}}(function(){var e=function(){};e.prototype.init=function(e){this.gui=AGN.Lib.TableCellWrapper(e.data.show);var t=document.createElement("div");if(e.value){t.appendChild(document.createTextNode(e.value))}t.style.cssText="text-overflow: ellipsis;"+"overflow: hidden;";this.gui.appendChild(t)};e.prototype.getGui=function(){return this.gui};e.prototype.refresh=function(){return false};AGN.Opt.TableCellRenderers["StringCellRenderer"]=e})();(function(){AGN.Lib.TableCellWrapper=function(e){if(e){var t=document.createElement("a");t.href=e;t.style.cssText="display: block;"+"height: 33px;"+"margin:  -8px -6px;"+"padding: 8px 6px;";return t}else{return document.createElement("div")}}})();(function(){var e=function(){};e.prototype.init=function(e){this.eGui=AGN.Lib.TableCellWrapper(e.data.show);var i="";if(e.value.endTypeId===1){i=t("workflow.stop.automatic_end")}else if(e.value.endTypeId===2){i=e.value.date}this.eGui.innerHTML=i};e.prototype.getGui=function(){return this.eGui};e.prototype.refresh=function(e){return false};e.prototype.destroy=function(){};AGN.Opt.TableCellRenderers["WorkflowEndCellRenderer"]=e})();(function(){var e=function(){};e.prototype.init=function(e){this.eGui=AGN.Lib.TableCellWrapper(e.data.show);var i="";if(e.value.startTypeId===1){i=' <span class="badge badge-campaigntype-actionbased">\n'+'              <i class="icon icon-gear"></i>\n'+"              <strong>"+t("workflow.start.action_based")+"</strong>\n"+"         </span>"}else if(e.value.startTypeId===2){i='<span class="badge badge-campaigntype-datebased">\n'+'              <i class="icon icon-calendar-o"></i>\n'+"              <strong>"+t("workflow.start.date_based")+"</strong>\n"+"        </span>"}else{i=e.value.date}this.eGui.innerHTML=i};e.prototype.getGui=function(){return this.eGui};e.prototype.refresh=function(e){return false};e.prototype.destroy=function(){};AGN.Opt.TableCellRenderers["WorkflowStartCellRenderer"]=e})();class WorkflowStartFilter extends DateRangeFilter{init(e){super.init(e);this.$filterType=$(`#${this.column}-filter`)}doesFilterPass(e){const t=e.data[this.column]?.type;return this.doesByDateFilterPass(t)&&super.doesFilterPass(e)||this.doesActionBasedFilterPass(t)||this.doesDateBasedFilterPass(t)}doesByDateFilterPass(e){return this.types.includes("startDate")&&e!=="EVENT_REACTION"&&e!=="EVENT_DATE"}doesActionBasedFilterPass(e){return this.types.includes("actionBased")&&e==="EVENT_REACTION"}doesDateBasedFilterPass(e){return this.types.includes("dateBased")&&e==="EVENT_DATE"}isFilterActive(){return this.types.length>0}getModel(){return{...super.getModel(),types:this.types}}setModel(e){super.setModel(e);this.types=[...this.$filterType.val()]}}AGN.Opt.Table["filters"]["WorkflowStartFilter"]=WorkflowStartFilter;class WorkflowStopFilter extends DateRangeFilter{init(e){super.init(e);this.$filterType=$(`#${this.column}-filter`)}doesFilterPass(e){const t=e.data[this.column]?.type;return this.doesByDateFilterPass(t)&&super.doesFilterPass(e)||this.doesAutomaticEndFilterPass(t)}doesByDateFilterPass(e){return this.types.includes("stopDate")&&e!=="AUTOMATIC"}doesAutomaticEndFilterPass(e){return this.types.includes("automaticEnd")&&e==="AUTOMATIC"}isFilterActive(){return this.types.length>0}getModel(){return{...super.getModel(),types:this.types}}setModel(e){super.setModel(e);this.types=[...this.$filterType.val()]}}AGN.Opt.Table["filters"]["WorkflowStopFilter"]=WorkflowStopFilter;(function(){AGN.Lib.FormBuilder=AGN.Lib.FormBuilder||{};AGN.Lib.FormBuilder.Utils={pushControl:function(e,n){if(!Array.isArray(e)){return}e.push(function(e){var t=function(e){var t=e.prototype.constructor;function i(){return t.apply(this,arguments)}i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:true,configurable:true}});i.__proto__=e;if(n.build){i.prototype.build=n.build}if(n.onRender){i.prototype.onRender=n.onRender}Object.defineProperty(i,"definition",{get:n.definition});return i}(e);e.register(n.newControlName,t);return t})}}})();(function(){AGN.Lib.FormBuilder=AGN.Lib.FormBuilder||{};AGN.Lib.FormBuilder.EmmControls={mediapool:function(r){return{newControlName:"mediapool",build:function(){return{field:this.markup("img",null,{}),layout:"agnMediapool"}},onRender:function(e){if(this.preview){var i=$(e.target).parents(".form-field").find(".field-label");i.html(t("userform.formBuilder.mediapoolImage")+": "+r.options.mediapoolImages[this.config.image])}var n=$(this.element);n.attr("src",this.config.image).attr("alt",this.config.alt);if(this.config.width){n.attr("width",this.config.width)}if(this.config.height){n.attr("height",this.config.height)}},definition:function(){return{i18n:{default:t("userform.formBuilder.mediapoolImage")}}}}},nextform:function(){return{newControlName:"formName",build:function(){return{field:this.markup("input",null,{name:"agnFN",type:"hidden"}),layout:"hidden"}},onRender:function(e){if(this.preview){var i=$(e.target).parents(".form-field").find(".field-label");i.html(t("userform.formBuilder.nextForm")+": "+this.config.formName)}$(this.element).attr("value",this.config.formName)},definition:function(){return{i18n:{default:t("userform.formBuilder.nextForm")}}}}}}})();(function(){AGN.Lib.FormBuilder=AGN.Lib.FormBuilder||{};var n={agnCTOKEN:t("userform.formBuilder.tooltips.agnCTOKEN"),agnUID:t("userform.formBuilder.tooltips.agnUID")};const s=2;const i={gender:[{selected:true,label:"Gender Male",value:0},{selected:false,label:"Gender Female",value:1}]};var a=["agnCTOKEN","agnUID","agnMAILINGLIST","agnSUBSCRIBE"];AGN.Lib.FormBuilder.Templates={default:function(){return{onRender:l}},hidden:function(){return{onRender:e}},dateForRender:function(i){var e=this;var t=(this.config.className||"")+" js-datepicker";var n=$.extend({},this.config,{"data-datepicker-options":"format: 'yyyy/mm/dd', formatSubmit: 'yyyy/mm/dd'",className:t});return{field:e.markup("input",null,n),onRender:function(e){var t=$(e.target);t.append('<input type="hidden" name="'+i.name+'_format" value="'+"yyyy/MM/dd"+'">')}}}};function l(e){var t=$(e.target).parents(".form-field"),i=this.config.emmField,n=t.data("currentEmmField"),r=!n,o=i!==n;if(r){t.data("currentEmmField",i)}else if(o){t.data("currentEmmField",i);u(t,this.config,i,n)}}function e(e){var t=this.config.id.replace("-preview","");var i=$(e.target);var n=i.parents(".form-field").find(".form-elements");var r=n.find(".emmField-wrap");if(a.includes(t)){r.hide()}else{r.show()}if(!a.includes(t)){l.apply(this,arguments)}var o=i.parents(".form-field").find(".tooltip-element");c(o,t)}function c(e,t){const i=n[t];if(!i){e.hide();return}e.removeAttr("tooltip").show();AGN.Lib.Tooltip.createTip(e,i)}function u(e,t,i,n){const r=e.find(".form-elements"),o=r.find('input[name="value"]'),s=r.find('input[name="name"]'),a=i!=="none";var l=a?"$!customerData."+i:"",c=a?i:"";o.val(l);s.val(c);if(a){s.prop("disabled",true)}else{s.prop("disabled",false)}if(t.type==="select"){d(i,n,e,t)}}function d(e,t,i,n){const r=g(e);if(r.length>=s){const o={values:r,name:e};h(i,n,o)}else if(g(t).length>0){const o={values:[],name:e};h(i,n,o)}}function h(t,i,n){const r=t.parents(".js-form-builder");const o=r.data("formBuilder");o.actions.removeField(t.prop("id"));p(function(){const e=_.mergeWith(i,n,function(e,t){return _.isArray(t)?t:undefined});o.actions.addField(e,f(t,r))});p(function(){o.actions.toggleFieldEdit(o.actions.getCurrentFieldId())})}function f(i,e){var n=0;_.each(e.find(".form-field"),function(e,t){if($(e).prop("id")===i.prop("id")){n=t}});return n}function p(e){window.setTimeout(function(){e()},0)}function g(e){const t=i[e];return t?t:[]}})();(function(){var e=AGN.Lib.FormBuilder.Utils;var i=AGN.Lib.FormBuilder.EmmControls;var r=AGN.Lib.FormBuilder.Templates;var o="<html>\n"+"    <head>\n"+'        <script type="text/javascript" src="'+AGN.url("/js/lib/jquery/jquery-3.5.1.js",true)+'"><\/script>\n'+'        <script type="text/javascript" src="'+AGN.url("/assets/js/vendor/pickadate-3.5.6.js",true)+'"><\/script>\n'+'        <script type="text/javascript" src="'+AGN.url("/assets/js/vendor/pickadate-3.5.6.date.js",true)+'"><\/script>\n'+'        <script type="text/javascript" src="'+AGN.url("/js/lib/formbuilder/generated-form.js",true)+'"><\/script>\n'+'        <link rel="stylesheet" href="'+AGN.url("/assets/form.css",true)+'">'+"        {{ if (cssUrl) { }}\n"+'        <link rel="stylesheet" href="{{- cssUrl }}">\n'+"        {{ } }}\n"+"    </head>\n"+"    <body>\n"+'        <div class="container" style="margin-top: 50px;">\n'+'            <form action="form.action">\n'+"                {{= generatedHTML}}\n"+"            </form>\n"+"        </div>\n"+"    </body>\n"+"</html>";var s=AGN.Lib.Confirm;var a;var n=["required","label","description","name","className","placeholder","value"];a=function(e,t){this.options=$.extend({},t);var i=this;i.$el=$(e);i.$target=$(this.$el.data("target"));i.initCustomControls();i.builder=i.$el.formBuilder(a.getBuilderDefaultOptions(i));i.defered=$.Deferred();if(i.options.data){i.setJson(i.options.data)}i.builder.promise.then(function(){i.builder=i.$el.data("formBuilder");i.defered.resolve()})};a.getBuilderDefaultOptions=function(e){return{roles:{},disabledAttrs:["access","description"],disableFields:["file","autocomplete"],defaultFields:a.defaultFields(e),disabledActionButtons:["data","save"],actionButtons:[{id:"downloadHtml",className:"btn btn-info",label:t("workflow.reaction.download"),type:"button",events:{click:function(){e.downloadHtml.bind(e)()}}},{id:"generateHtml",className:"btn btn-success",label:t("userform.formBuilder.generateHtml"),type:"button",events:{click:function(){e.generateHtmlToTarget.bind(e)()}}}],editOnAdd:true,typeUserDisabledAttrs:{formName:n,mediapool:n,text:["subtype"],textarea:["subtype"]},typeUserAttrs:c(e),layoutTemplates:{agnMediapool:function(){return document.createElement("span")}},fields:[{type:"text"},{type:"hidden"},{type:"select"},{type:"radio-group"},{type:"checkbox-group"},{type:"number"},{type:"textarea"},{type:"date"}],templates:{text:r.default,hidden:r.hidden,textarea:r.default,date:r.default,select:r.default,"radio-group":r.default,"checkbox-group":r.default,number:r.default},controls:e.controls,i18n:{locale:window.adminLocale,location:AGN.url("/js/lib/formbuilder/translation/")},controlOrder:["header","paragraph","mediapool","","text","date","textarea","number","","select","radio-group","checkbox-group","","hidden","formName","button"],inputSets:a.getDefaultPresetsConfig(e)}};a.defaultFields=function(e){return[{type:"hidden",name:"agnCTOKEN",value:e.options.companyToken},{type:"hidden",name:"agnUID",value:"$!agnUID"}]};a.getDefaultPresetsConfig=function(e){return[{label:u(t("userform.formBuilder.template.subscribe")),name:"subscribe",fields:[{type:"hidden",name:"agnCTOKEN",value:e.options.companyToken,label:" "},{type:"hidden",name:"agnMAILINGLIST",value:"",label:" "},{type:"hidden",name:"agnSUBSCRIBE",value:"1",label:" "},{type:"hidden",name:"agnUID",value:"$!agnUID",label:" "},{type:"text",name:"firstname",value:"$!customerData.firstname",emmField:"firstname",label:"Firstname:"},{type:"text",name:"lastname",value:"$!customerData.lastname",emmField:"lastname",label:"Lastname:"},{type:"text",name:"email",value:"$!customerData.email",emmField:"email",label:"Email:"},{type:"button",subtype:"submit",style:"primary",label:"Subscribe"},{type:"formName",label:" "}]},{label:u(t("userform.formBuilder.template.unsubscribe")),name:"unsubscribe",fields:[{type:"hidden",name:"agnCTOKEN",value:e.options.companyToken,label:" "},{type:"formName",label:" "},{type:"hidden",name:"agnUID",value:"$!agnUID",label:" "},{type:"button",subtype:"submit",style:"primary",label:"Unsubscribe"}]},{label:u(t("userform.formBuilder.template.profile_change")),name:"profile_change",fields:[{type:"hidden",name:"agnCTOKEN",value:e.options.companyToken,label:" "},{type:"hidden",name:"agnUID",value:"$!agnUID",label:" "},{type:"formName",label:" "},{type:"text",name:"firstname",value:"$!customerData.firstname",emmField:"firstname",label:"Firstname:"},{type:"text",name:"lastname",value:"$!customerData.lastname",emmField:"lastname",label:"Lastname:"},{type:"text",name:"email",value:"$!customerData.email",emmField:"email",label:"Email:"},{type:"button",subtype:"submit",style:"primary",label:"Subscribe"}]},{label:u(t("userform.formBuilder.template.other")),name:"other",fields:[{type:"hidden",name:"agnCTOKEN",value:e.options.companyToken,label:" "},{type:"hidden",name:"agnUID",value:"$!agnUID",label:" "}]}]};a.get=function(e,t){var i=$(e);var n=i.data("_form-builder");if(n){return n}n=new a(e,t);i.data("_form-builder",n);return n};a.isCreated=function(e){return!!$(e).data("_form-builder")};a.prototype.initCustomControls=function(){this.controls=[];e.pushControl(this.controls,i.mediapool(this));e.pushControl(this.controls,i.nextform(this))};a.prototype.generateHtml=function(){var e=this.builder.actions.getData();var t=this.options.cssUrl;var i=$("<form/>");i.formRender({formData:e,controls:this.controls,templates:{date:r.dateForRender}});var n;if(o){n=_.template(o)({generatedHTML:i.html(),cssUrl:t})}else{n=i.html()}i.remove();n=d(n);return n};a.prototype.generateHtmlToTarget=function(){var e=this;var t=this.$target;if(!t){return}var i=AGN.Lib.Editor.get(t);if(!i){return}var n=this.options.confirmationModal;if(!n||!i.val()){l(e,i);return}s.createFromTemplate({},"warning-html-generation-modal").done(function(){l(e,i)})};a.prototype.downloadHtml=function(){var e=this.generateHtml();var t=window.btoa(e);var i="Generated form.txt";if(this.options.formName){i=this.options.formName+".txt"}var n=document.createElement("a");n.setAttribute("href","data:application/octet-stream;charset=utf-8;base64,"+t);n.setAttribute("download",i);n.style.display="none";document.body.appendChild(n);n.click();document.body.removeChild(n)};a.prototype.getJson=function(){return this.builder.actions.getData("json",false)};a.prototype.getData=function(){return this.builder.actions.getData()};a.prototype.setJson=function(e){var t=this;t.defered.done(function(){return t.builder.actions.setData(e)})};a.prototype.promise=function(){return this.defered.promise()};a.prototype.getInitJson=function(){return JSON.stringify(this.options.data)};a.prototype.isChanged=function(){var e=this;if(e.options.data){return e.getInitJson()!==e.getJson()}else{return _.isEqual(e.getData(),a.defaultFields(e))}};function l(e,i){i.val(e.generateHtml());AGN.Lib.Messages(t("defaults.success"),t("userform.formBuilder.success.htmlGenerated"),"success")}function c(i){var n={formName:{formName:{label:t("userform.formBuilder.formName"),options:i.options.namesJson.reduce(function(e,t){e[t]=t;return e},{})}},mediapool:{image:{label:t("userform.formBuilder.mediapoolImage"),options:i.options.mediapoolImages},alt:{label:t("userform.formBuilder.imageAlt"),value:""},width:{label:t("userform.formBuilder.imageWidth"),value:0},height:{label:t("userform.formBuilder.imageHeight"),value:0}},date:{emmField:{label:t("userform.formBuilder.emmField"),options:i.options.dateProfileFields}},number:{emmField:{label:t("userform.formBuilder.emmField"),options:i.options.numberProfileFields}},select:{emmField:{label:t("userform.formBuilder.emmField"),options:i.options.profileFieldsForSelect}}};var e=["text","hidden","textarea","radio-group","checkbox-group"];e.forEach(function(e){n[e]={emmField:{label:t("userform.formBuilder.emmField"),options:i.options.textProfileFields}}});return n}function u(e){return t("userform.formBuilder.template.template")+": "+e}function d(e){if(!e||e.length<=0){return e}return e.replace(/<\/.*?>/g,"$&\n")}AGN.Lib.FormBuilder.FormBuilder=a})();AGN.Lib.DomInitializer.new("account-data",function(){var e=$("#account-data .account-initials");var t=e.next(".account-data-infobox");e.popover({trigger:"hover",container:"body",html:true,content:t.html()})});AGN.Lib.CoreInitializer.new("ace",function(e){if(!e){e=$(document)}_.each(e.find(".js-editor, .js-editor-text, .js-editor-eql, .js-editor-css"),function(e){AGN.Lib.Editor.get($(e))})});(function(){AGN.Lib.CoreInitializer.new("checkbox-hider",function(e){if(!e){e=$(document)}_.each(e.find("[data-show-by-checkbox]"),function(e){var t=$(e);var i=$(t.data("show-by-checkbox"));r(t,i,true);n(t,i,true)});_.each(e.find("[data-hide-by-checkbox]"),function(e){var t=$(e);var i=$(t.data("hide-by-checkbox"));r(t,i,false);n(t,i,false)});_.each(e.find("[data-show-by-select]"),function(e){var t=$(e);var i=$(t.data("show-by-select"));const{showBySelectValues:n=""}=t.data();if(i&&n!==""){var r=n.toString().split(",");for(var o=0;o<r.length;o++){r[o]=r[o].trim()}a(t,i,r,true);s(t,i,r,true)}});_.each(e.find("[data-hide-by-select]"),function(e){var t=$(e);var i=$(t.data("hide-by-select"));const{showBySelectValues:n=""}=t.data();if(i&&n!==""){var r=n.toString().split(",");for(var o=0;o<r.length;o++){r[o]=r[o].trim()}a(t,i,r,false);s(t,i,r,false)}})});function n(e,t,i){t.change(function(){r(e,t,i)})}function r(e,t,i){if(i){if(t.is(":checked")){e.removeClass("hidden")}else{e.addClass("hidden")}}else{if(!t.is(":checked")){e.removeClass("hidden")}else{e.addClass("hidden")}}}function s(e,t,i,n){t.change(function(){a(e,t,i,n)})}function a(e,t,i,n){const r=t.val();const o=Array.isArray(r)?r:[r];const s=o.some(e=>i.includes(e));const a=s?!n:n;e.toggleClass("hidden",a).trigger(`select:${a?"hide":"show"}`)}})();(function(){var l=AGN.Lib.AutoSave;function c(e,t){var i=e.attr("id"),n=e.data("_editor");if(window.CKEDITOR&&CKEDITOR.instances[i]){CKEDITOR.instances[i].setData(t)}else if(n){n.val(t)}else{e.val(t)}}AGN.Lib.CoreInitializer.new("auto-save",["ace"],function(e){if(!e){e=$(document)}_.each(e.find("[data-autosave-scope]"),function(e){var t=$(e);var i=t.data("autosave-scope");var n=t.data("autosave-period");var r=t.all("[data-autosave]");if(r.length>0){function o(){r=r.filter(function(e,t){return document.body.contains(t)});if(r.length>0){var i={};_.each(r,function(e){var t=$(e);i["value#"+t.data("autosave")]=t.val()});return i}return false}function s(o){var e=$.map(r,function(e){var t=$(e);var i="value#"+t.data("autosave");if(i in o){var n=t.val();var r=o[i];if(n!=r){if(t.is("[data-autorestore]")){c(t,r)}else{return{target:t,value:r}}}return null}});if(e.length>0){return e}return false}function a(e){_.each(e,function(e){c(e.target,e.value)})}l.initialize(i,o,s,a,n)}})})})();AGN.Lib.DomInitializer.new("autosubmit",function(e){setTimeout(function(){AGN.Lib.Form.get(e).submit()},100)});AGN.Lib.DomInitializer.new("calendar-table",function(){var i=this.config;AGN.Lib.CalendarService.setUp(i);window.setInterval(AGN.Lib.CalendarService.checkProgress,500);if(AGN.Lib.CalendarService.getMonthMode()){AGN.Lib.CalendarService.generateMonthCalendar(AGN.Lib.CalendarService.getCurMonth(),AGN.Lib.CalendarService.getCurYear())}else{AGN.Lib.CalendarService.generateWeekCalendar(AGN.Lib.CalendarService.getCurMonth(),AGN.Lib.CalendarService.getCurYear(),AGN.Lib.CalendarService.getCurDay())}AGN.Lib.CalendarService.generateUnsentMailingsTable();var e=AGN.Lib.Action;e.new({click:"#dateTimePicker"},function(){this.event.stopPropagation()});e.new({click:"#dateTimePickerButton"},function(){this.event.stopPropagation()});e.new({click:".js-calendar-navigate-previous"},function(){AGN.Lib.CalendarService.prevEntry();this.event.preventDefault();return false});e.new({click:".js-calendar-navigate-next"},function(){AGN.Lib.CalendarService.nextEntry();this.event.preventDefault();return false});e.new({click:".js-calendar-navigate-today"},function(){AGN.Lib.CalendarService.jumpToday();this.event.preventDefault();return false});e.new({click:".js-calendar-view-month"},function(){AGN.Lib.CalendarService.toggleDateSelectionMode("SELECT_MONTH");this.event.preventDefault();return false});e.new({click:".js-calendar-view-week"},function(){AGN.Lib.CalendarService.toggleDateSelectionMode("SELECT_WEEK");this.event.preventDefault();return false});e.new({click:".js-calendar-list-unsent"},function(){AGN.Lib.CalendarService.generateUnsentMailingsTable();this.event.preventDefault();return false});e.new({click:".js-calendar-list-planned"},function(){AGN.Lib.CalendarService.generatePlannedMailingsTable();this.event.preventDefault();return false});e.new({click:"#comment-save-button"},function(){AGN.Lib.ReminderService.reminder.onSave()});e.new({click:".calendar-comments-add"},function(){var e=this.el,t;t=e.parents(".calendar-day-container").data("date");AGN.Lib.CalendarService.showCommentDialog(AGN.Lib.ReminderService.getNewReminder(t,i));return false});e.new({click:".calendar-comments-toggle"},function(){var e=this.el,t;t=e.parents(".calendar-day-container").data("date");AGN.Lib.CalendarService.toggleComment(t);return false});e.new({change:".js-calendar-toggle-all-comments"},function(){if(this.el.prop("checked")){$(".calendar-table").find(".calendar-comment").show()}else{$(".calendar-table").find(".calendar-comment").hide()}AGN.Lib.CalendarService.adjustSidebarHeight()});e.new({change:"#scheduleReminder"},function(){AGN.Lib.ReminderService.onScheduleChanged()});e.new({change:"#isDeadline"},function(){AGN.Lib.ReminderService.onDeadlineChanged()});e.new({change:"#month_list, #month_list_year, #weeks_list"},function(){AGN.Lib.CalendarService.showDate()});e.new({change:"#weeks_list_year"},function(){AGN.Lib.CalendarService.createWeeksList(this.el[0])});e.new({change:'#reminderDetails input[name="userType"]'},function(){var e=this.el[0];AGN.Lib.ReminderService.onUserTypeChanged(e.value)});this.addAction({mouseover:"mailing-popup"},function(){var e=this.el,t=$("#popup-"+e.data("mailing-id"));if(t.exists()){var i=$(window).scrollTop();var n=t.outerHeight();var r=15;var o=e.offset().top;var s=o+e.outerHeight();var a=o-i-r;var l=i+$(window).outerHeight()-s;var c;if(n<=a||a>l){c=o-r-n;t.addClass("top");t.removeClass("bottom")}else{c=s+r;t.addClass("bottom");t.removeClass("top")}t.css({top:c,left:e.offset().left+e.outerWidth()/2-t.outerWidth()/2});t.css("z-index","1500");t.css("display","block")}});this.addAction({mouseout:"mailing-popup"},function(){var e=this.el.data("mailing-id");$("#popup-"+e).css("display","none")})});(function(){const r=AGN.Lib.DateFormat;const o=AGN.Lib.Template;const i=AGN.url("/calendar/mailings.action");const t=AGN.url("/mailing/:mailingId:/settings.action");const n=AGN.url("/statistics/mailing/:mailingId:/view.action?init=true");class e{constructor(e,t,i){this.$el=e;this.firstDayOfWeek=t;this.statisticsViewAllowed=i;this.#init()}#init(){const e=new Date;this.#displayWeekDays();this.showMonth(e.getMonth(),e.getFullYear());this.$el.on("change","#month_list, #month_list_year",this.switchMonth.bind(this))}#displayWeekDays(){AGN.Lib.DateFormat.getLocalizedShortWeekdays(window.adminLocale,this.firstDayOfWeek).forEach(e=>{$("#calendar-header").append(`<td><div class="calendar-cell">${e}</div></td>`)})}showMonth(t,e){let i=new Date(e,t,1);let n=this.daysInMonth(t+1,e);let r=i.getDay()-this.firstDayOfWeek;if(r<0){r=7+r}let o=Math.ceil((n+r)/7);let s=new Date(e,t,1-r);let a=new Date(e,t,1+o*7);i=new Date(s);for(let e=0;e<o;e++){const l="row-"+(e+1);const c=this.#getWeek(i);$("#calendar-container").append(`<tr id="${l}"><td><div class="calendar-cell">${c}</div></td></tr>`);for(let e=0;e<7;e++){const u=i.getMonth()!==t;this.addDayToCalendar(i,l,u);i.setDate(i.getDate()+1)}}this.handleCalendarMailings(s,a);this.synchronizeMonthsList(t,e)}daysInMonth(e,t){return new Date(t,e,0).getDate()}removeCurrentCalendar(){$("#calendar-container tr:not(:first)").remove()}addDayToCalendar(e,t,i){const n=!i&&this.isToday(e);const r=this.dateToServiceFormat(new Date(e.getFullYear(),e.getMonth(),e.getDate()));const o="day-"+r;$("#"+t).append(`<td id="${o}"></td>`);$("#"+o).append(`<div class="calendar-cell calendar-day ${n?"calendar-day--today":""} ${i?"calendar-day--alien":""}" id="label-${o}" data-date="${r}">${e.getDate().toString().padStart(2,"0")}</div>`)}isToday(e){const t=new Date;t.setHours(0,0,0,0);e.setHours(0,0,0,0);return e.getTime()===t.getTime()}handleCalendarMailings(e,t){$.get(i,{startDate:this.dateToServiceFormat(e),endDate:this.dateToServiceFormat(t)}).done(e=>this.assignMailingsToCalendarDays(e))}assignMailingsToCalendarDays(e){e.forEach(e=>e.link=this.getMailingLink(e));const t=_.groupBy(e,"sendDate");this.makeDaysSelectable(t);this.makeCurrentDayActive(t)}makeCurrentDayActive(e){const t=this.dateToServiceFormat(new Date);$("#day-"+t).click(()=>this.changeSelectedDay(t,e[t]));this.changeSelectedDay(t,e[t])}makeDaysSelectable(r){_.forEach($(".calendar-day"),e=>{const t=$(e);const i=t.data("date");const n=r[i];if(!_.isEmpty(n)){$("#label-day-"+i).addClass("calendar-day--selectable")}t.click(()=>this.changeSelectedDay(i,_.sortBy(n,"sendTime")))})}changeSelectedDay(e,t){$("#calendar-container").find(".calendar-day--selected").removeClass("calendar-day--selected");$("#label-day-"+e).addClass("calendar-day--selected");const i=r.parseFormat(e,"dd-MM-yy");const n=i.toLocaleString(window.adminLocale,{weekday:"long"});e=AGN.Lib.DateFormat.format(i,window.adminDateFormat);$("#calendar-tile-day-mailings").html(o.dom("dashboard-schedule-day",{dayOfWeek:n,dateStr:e,dayMailings:t}))}getMailingLink(e){return e.sent&&e.workstatus!=="mailing.status.test"&&this.statisticsViewAllowed?n.replace(":mailingId:",e.mailingId):t.replace(":mailingId:",e.mailingId)}switchMonth(){const e=parseInt($("#month_list option:selected").val());const t=parseInt($("#month_list_year option:selected").val());this.removeCurrentCalendar();this.showMonth(e,t);if(this.lastYearSelected()){this.addYearOption()}}addYearOption(){const e=$("#month_list_year");const t=parseInt(e.find("option:last").val(),10)+1;e.append($("<option></option>").val(t).text(t))}lastYearSelected(){return $("#month_list_year option:selected").index()===$("#month_list_year option").length-1}synchronizeMonthsList(e,t){let i=$("#month_list_year");i[0].selectedIndex=$("#month_list_year option[value = "+t+"]")[0].index;let n=$("#month_list");n[0].selectedIndex=$("#month_list option[value = "+e+"]")[0].index;AGN.runAll(i);AGN.runAll(n)}pad(e,t){let i=e+"";while(i.length<t)i="0"+i;return i}dateToServiceFormat(e){let t=this.pad(e.getDate(),2);let i=this.pad(e.getMonth()+1,2);let n=e.getFullYear();return t+"-"+i+"-"+n}#getWeek(e){var t=new Date(e.valueOf());var i=t.getFullYear();var n=t.getMonth();var r=t.getDate();if(this.firstDayOfWeek===0){r=r+1}n=n+1;var o=Math.floor((14-n)/12);var s=i+4800-o;var a=n+12*o-3;var l=r+Math.floor((153*a+2)/5)+365*s+Math.floor(s/4)-Math.floor(s/100)+Math.floor(s/400)-32045;var c=(l+31741-l%7)%146097%36524%1461;var u=Math.floor(c/1460);var d=(c-u)%365+u;return Math.floor(d/7)+1}}AGN.Lib.Calendar=e})();(function(){function r(e,t,i,n){var r=$(e).pickadate("picker").get("select",n);var o=$(t).val();var s="";if(r&&o){s=r+" "+o}$(i).val(s)}function e(e,t,i,n){$(e).pickadate("picker").on({set:function(){r(e,t,i,n)}});$(t).on("change",function(){r(e,t,i,n)})}AGN.Lib.DomInitializer.new("campaign-autooptimization-view",function(){$("form#optimizationForm").submit(false);e("#testMailingsSendDate","#testMailingsSendTime","input[name='testMailingsSendDateAsString']",this.config.datePattern);e("#resultSendDate","#resultSendTime","input[name='resultSendDateAsString']",this.config.datePattern)})})();AGN.Lib.CoreInitializer.new("char-counter",function(e){if(!e){e=$(document)}_.each(e.find("[data-show-char-counter]"),function(e){const t=$(e);if(!t.is("input")&&!t.is("textarea")){return}r(t)});function i(e,i){e.text(t("fields.content.charactersEntered",i.val()?.length||0))}function n(e,t){let i=e.find(".tile-footer");if(!i.exists()){i=$('<div class="tile-footer text-dark fs-3 bg-transparent border-top">');e.append(i)}i.prepend(t)}function r(e){const t=$('<span class="text-truncate">');if(e.data("show-char-counter")==="tile-footer"){n(e.closest(".tile"),t)}else{e.before($(`<div class="char-counter"></div>`).append(t))}i(t,e);e.on("change input editor:create editor:change",_.throttle(()=>i(t,e),100))}});AGN.Lib.CoreInitializer.new("colorpicker",function(e=$(document)){const t=AGN.Lib.Colorpicker;e.find(".js-colorpicker").each(function(){const e=$(this);if(!t.get(e)){new t(e)}})});AGN.Lib.CoreInitializer.new("csrf",function(e){if(!e){e=$(document)}e.find('meta[name="_csrf_header"]').each(function(){window.csrfHeaderName=$(this).attr("content");window.csrfCookieName=window.csrfHeaderName});e.find('meta[name="_csrf_parameter"]').each(function(){window.csrfParameterName=$(this).attr("content")});e.find('div > input[type="hidden"][name="_csrf"]:only-child').parent("div").hide()});(function(){AGN.Lib.CoreInitializer.new("dark-theme",function(){if($("body").hasClass("dark-theme")){$("iframe").each(function(){var e=$(this);e.on("load.iframe",function(){e.contents().find("body").addClass("dark-theme")})})}})})();(function(){var l;l={data:{chartsColors:["#0071b9","#009999","#92d050","#41641a","#ffc000"],statChartData:{columnTitles:[],c3data:{bindto:".js-stat-chart",data:{columns:[],type:"bar",labels:true},axis:{x:{tick:{centered:true,fit:true,format:function(e){return l.data.statChartData.columnTitles[e]}}}},legend:{show:false},tooltip:{format:{title:function(){return null},name:function(e,t,i,n){return l.data.statChartData.columnTitles[n]},value:function(e,t,i,n){return e}}},padding:{right:25}},build:function(e,t){this.columnTitles=e;var i=t.slice(0);i.unshift("values");this.c3data.data.columns=[i];return this.c3data}},clickChartData:{c3data:{bindto:".js-click-chart",data:{rows:[],type:"donut"},size:{height:150},donut:{title:"",label:{show:false},width:15},legend:{position:"right"},tooltip:{show:false}},build:function(e,t,i){this.c3data.donut.title=e;this.c3data.data.rows=[t,i];var n={};for(var r=0;r<t.length;r++){n[t[r]]=l.data.chartsColors[r]}this.c3data.data.colors=n;return this.c3data}},viewChartData:{c3data:{bindto:".js-view-chart",data:{rows:[],type:"donut"},size:{height:150},donut:{title:"",label:{show:false},width:15},legend:{position:"right"},tooltip:{show:false}},build:function(e,t,i){this.c3data.donut.title=e;this.c3data.data.rows=[t,i];var n={};for(var r=0;r<t.length;r++){n[t[r]]=l.data.chartsColors[r]}this.c3data.data.colors=n;return this.c3data}}},updateCharts:function(e){jQuery.ajax({type:"GET",url:AGN.url("/dashboard/statistics.action"),data:{mailingId:e},success:function(e){var t;var i;var n;e=_.merge({common:[["no Data","0"]],clickers:[["no Data","0"]],clickersPercent:[0],openers:[["no Data","0"]],openersPercent:[0]},e);t=[];i=[];for(var r=0;r<e["common"].length;r++){var o=parseInt(e["common"][r][1]);t.push(e["common"][r][0]);i.push(o)}c3.generate(l.data.statChartData.build(t,i));t=[];i=[];n=0;for(var r=0;r<e["clickers"].length;r++){var o=l.roundTo(e["clickers"][r][1]*100,1);t.push(e["clickers"][r][0]);i.push(o);n+=o}if(!isNaN(n)&&n>0){for(var r=0;r<i.length;r++){t[r]+=" "+l.roundTo(100*i[r]/n,1)+"%"}}var s=l.roundTo(e["clickersPercent"][0]*100,1)+"%*";c3.generate(l.data.clickChartData.build(s,t,i));t=[];i=[];n=0;for(var r=0;r<e["openers"].length;r++){var o=l.roundTo(e["openers"][r][1]*100,1);t.push(e["openers"][r][0]);i.push(o);n+=o}if(!isNaN(n)&&n>0){for(var r=0;r<i.length;r++){t[r]+=" "+l.roundTo(100*i[r]/n,1)+"%"}}var a=l.roundTo(e["openersPercent"][0]*100,1)+"%*";c3.generate(l.data.viewChartData.build(a,t,i));AGN.Lib.CoreInitializer.run("equalizer")}})},roundTo:function(e,t){return parseFloat(e).toFixed(t)*1}};AGN.Lib.DashboardStatisticsService=l})();(function(){const h=AGN.Lib.Helpers;const f="agn:datepicker-opt";AGN.Lib.CoreInitializer.new("pickadate",function(e=$(document)){_.each(e.find(".js-datepicker"),function(e){const i=$(e);i.removeClass("hasDatepicker");let n={showWeek:true,changeMonth:true,changeYear:true,selectOtherMonths:true,dateFormat:window.adminDateFormat,showButtonPanel:true,showOtherMonths:true,weekHeader:t("calendar.common.weekNumber"),monthNamesShort:t("date.monthsFull"),dayNamesMin:t("date.weekdaysShort"),onUpdateDatepicker:function(e){u(i);d(e.dpDiv,i)},beforeShow:function(e,t){if(i.attr("readonly")){return false}t.dpDiv.removeClass("hidden");i.parent().addClass("is-active")},onClose:function(){i.parent().removeClass("is-active")}};n=_.merge({},n,h.objFromString(i.data("datepicker-options")));n.dateFormat=l(n.dateFormat);if(n.formatSubmit){n.altFormat=l(n.formatSubmit);n.altField=c(i,n.dateFormat,n.altFormat)}i.data(`${f}-initialMinDate`,n.minDate);i.data(`${f}-initialMaxDate`,n.maxDate);i.datepicker(n);i.datepicker("widget").addClass("hidden");const r=i.closest("[data-date-range]");if(r.exists()){const o=r.find(".js-datepicker");if(i.is(o.get(0))){n.minFor=$(o.get(1))}else{n.maxFor=$(o.get(0))}}if(n.maxFor){i.data(`${f}-maxFor`,n.maxFor);const s=()=>{const e=i.datepicker("getDate")||n.minDate;$(n.maxFor).datepicker("option","maxDate",e)};i.on("change",s);s()}if(n.minFor){i.data(`${f}-minFor`,n.minFor);const a=()=>{const e=i.datepicker("getDate")||n.maxDate;$(n.minFor).datepicker("option","minDate",e)};i.on("change",a);a()}});function l(e){return e.replace(/M/g,"m").replace(/D/g,"d").replace("YYYY","yyyy").replace("yyyy","yy")}function c(e,t,i){const n=o(e.val(),t,i);const r=$(`<input type="hidden" name="${e.attr("name")}" value="${n}">`);e.attr("name","");r.insertAfter(e);return r}function o(e,t,i){const n=$.datepicker.parseDate(t,e);return $.datepicker.formatDate(i,n)}function u(e){const i=$(".ui-datepicker-buttonpane");i.append(`
        <button id="clear-datepicker-btn" class="btn btn-inverse gap-1">
            <i class="icon icon-sync"></i>
            <span class="text">${t("defaults.clear")}</span>
        </button>
      `);i.find("#clear-datepicker-btn").on("click",()=>r(e));if(i.find(".ui-datepicker-current").exists()){i.append(`
            <button id="today-datepicker-btn" class="btn btn-inverse gap-1">
                <i class="icon icon-calendar-alt"></i>
                <span class="text">${t("defaults.today")}</span>
            </button>
        `);i.find("#today-datepicker-btn").on("click",()=>n(e))}}function n(e){e.datepicker("setDate",new Date);e.datepicker("hide");e.trigger("change");e.blur()}function r(e){e.val("");e.datepicker("setDate",null);e.datepicker("hide");e.blur();i(e)}function i(e){if(e.data(`${f}-minFor`)){const t=$(e.data(`${f}-minFor`));t.datepicker("option","minDate",t.data(`${f}-initialMinDate`))}if(e.data(`${f}-maxFor`)){const i=$(e.data(`${f}-maxFor`));i.datepicker("option","maxDate",i.data(`${f}-initialMaxDate`))}}function d(e,t){s(t,e.find("select.ui-datepicker-month"));s(t,e.find("select.ui-datepicker-year"));AGN.runAll(e)}function s(e,t){t.addClass("form-control has-arrows");t.attr("data-select-options","minimumResultsForSearch: -1, dropdownParent: '#ui-datepicker-div'")}_.each(e.find(".js-timepicker"),function(e){let t=$(e),i,n,r={mask:"h:halfs",oncomplete:function(){t.trigger("timepicker:complete")},onincomplete:function(){t.trigger("timepicker:incomplete")}};i=_.merge({},r,h.objFromString(t.data("timepicker-options")));n=i.mask;delete i.mask;t.inputmask(n,i);t.attr("placeholder",t.data("_inputmask").opts.placeholder)})})})();AGN.Lib.CoreInitializer.new("delegate",function(e){if(!e){e=$(document)}e.all("[data-delegate]").each(function(){var e=$(this),i=e.data("delegate"),t=e.data("delegate-events")||"click";e.on(t,function(e){var t=$(i);if(t.length>0){t.trigger($.Event(e))}})})});(function(){var o=AGN.Lib.Helpers;AGN.Lib.CoreInitializer.new("display-dimensions",function(e){if(!e){e=$(document)}_.each(e.find("[data-display-dimensions]"),function(i){var e=$(i),t=o.objFromString(e.data("display-dimensions"))["scope"],n=e.parents(t),r=n.find("[data-dimensions]");e.ensureLoad(function(){var e=i.naturalWidth,t=i.naturalHeight;r.html(e+" x "+t+" px")})})})})();AGN.Lib.CoreInitializer.new("dragster",function(e){if(!e){e=$(document)}e.find(".dropzone").each(function(){new Dragster(this)})});AGN.Lib.CoreInitializer.new("dropzone",function(){Dropzone.autoDiscover=false});AGN.Lib.CoreInitializer.new("editable-view",function(e=$(document)){const t=AGN.Lib.EditableView;const i=AGN.Lib.EditableTile;e.all(t.SELECTOR).each(function(){const e=$(this);new t(e,e.data("editable-view"))});if(e.is(i.SELECTOR)){t.get(e)?.add(e)}});AGN.Lib.CoreInitializer.new("emoji",function(e){if(!e){e=$(document)}e.all("[data-emoji]").each(function(){$(this).emojioneArea({placeholder:null})})});AGN.Lib.CoreInitializer.new("endless-scroll",function(e){const n=AGN.Lib.EndlessScroll;if(!e){e=$(document)}e.find(".js-endless-scroll").each(function(){const e=$(this);let t={};if(e.is("[data-endless-scroll-opts]")){const i=AGN.Lib.Helpers.objFromString(e.data("endless-scroll-opts"));t=_.extend(t,i)}new n(e,e.data("url"),t)})});AGN.Lib.CoreInitializer.new("evaluate-loader",function(e=$(document)){const n=AGN.Lib.Modal;const r=AGN.Lib.Page;e.on("click","[data-evaluate-loader]",function(e){const t=$(this);e.preventDefault();let i;return $.ajax({beforeSend:()=>i=n.fromTemplate(s(t)),xhr:o,url:t.prop("href"),type:"POST",data:t.is("[data-form-target]")?AGN.Lib.Form.get($(t.data("form-target"))).params():""}).done(e=>r.render(e)).fail(e=>r.render(e)).always(()=>n.getInstance(i).hide())});function o(){const e=new XMLHttpRequest;e.addEventListener("progress",e=>{if(e.lengthComputable){$("#progress-text").html(e.loaded+" bytes")}});return e}function s(e){return e.data("evaluate-loader")||"evaluate-loader-template"}});(function(){var o=AGN.Lib.Form;AGN.Lib.CoreInitializer.new("form",["select","switchable-input"],function(e){if(!e){e=$(document)}e.find("form input[type=text], form input[type=password]").on("keyup keypress",function(e){var t=e.keyCode||e.which;if(t===13){e.preventDefault();return false}});var t=e.all("form[data-form-focus]").first();if(t.exists()){setTimeout(function(){var e=t.find('[name="'+t.data("form-focus")+'"]');if(e.exists()&&!e.is(":disabled")&&!e.is(":hidden")){i(e)}},10)}_.each(e.find("form"),function(e){o.get($(e))})});function i(e){var t;var i=25;var n=o.get(e).$form;var r=e.closest("[data-sizing=scroll], .modal").first();if(!r.length){r=$(document);t=e.offset().top-n.offset().top-i}else{t=e.offset().top-r.offset().top+r.scrollTop()-i}e.trigger("focus");r.scrollTop(t)}})();AGN.Lib.DomInitializer.new("formbuilder",function(e){var i=AGN.Lib.Tooltip;if(!e){e=$(document)}var r=this.config;var n=$("script#"+CSS.escape("config:formbuilderCommon")+'[type="application/json"]');if(n.length===1){r=$.extend(n.json(),r)}_.each(e.find(".js-form-builder"),function(t){AGN.Lib.FormBuilder.FormBuilder.get(t,r).promise().then(function(){var e=$(t);e.find(".form-actions button").each(function(){var e=$(this);i.create(e,{title:e.text()})})})});_.each(e.find(".modal-js-form-builder"),function(e){var t=$(e).attr("data-target-formbuilder");if(!t){return}var i=$(t);if(!i){return}var n=AGN.Lib.FormBuilder.FormBuilder.get(i);AGN.Lib.FormBuilder.FormBuilder.get(e,r).setJson(n.getJson())});document.styleSheets[0].insertRule(`:root { --warn-dialog-title: "${t("defaults.warning")}"; }`,0)});AGN.Lib.CoreInitializer.new("hover-dropdown-btn",function(e){if(!e){e=$(document)}const r="agn-isActivedDropdownMenu";_.each(e.find(".js-btn-dropdown"),function(e){const t=$(e);const i=t.closest(".dropdown");const n=i.find(".dropdown-menu");t.attr("aria-expanded",false);t.data(r,false);t.on("mouseenter",()=>{n.css("transform",`translate(0px, ${t.outerHeight()+5}px)`);o(i,t,true)});n.on("mouseenter",()=>t.data(r,true));t.on("mouseleave",()=>{setTimeout(()=>{if(!t.data(r)&&!t.is(":hover")){o(i,t,false)}},400)});n.on("mouseleave",()=>{t.data(r,false);o(i,t,false)})});function o(e,t,i){t.attr("aria-expanded",i);e.toggleClass("open",i)}});AGN.Lib.CoreInitializer.new("icons-defs",function(e){if(!e){e=$(document)}_.each(e.find("[data-icon]"),function(e){var t=$(e);var i=AGN.url("assets/icons-defs.svg#"+t.data("icon"),true);t.html('<svg viewBox="0 0 45 45"><use xlink:href="'+i+'"/></svg>')});svg4everybody()});AGN.Lib.CoreInitializer.new("iframe",function(e){if(!e){e=$(document)}e.find("iframe:not(.js-fixed-iframe)").each(function(){var o=this,s=$(this);if(s.hasClass("js-simple-iframe")){var e=s.parent(),t=e.parent(),a=parseInt(s.data("max-width")),l=parseInt(s.data("height-extra"))||10,c=s.data("media-query"),u=!!window.sidebar,i,d;i=function(){var e=o.contentDocument?o.contentDocument:o.contentWindow.document,t=e.body,i=e.documentElement,n,r;if(c){r=a}else{r=Math.max(t.scrollWidth,t.offsetWidth,i.clientWidth,i.scrollWidth,i.offsetWidth)}n=Math.min(t.scrollHeight,t.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight);s.height(n);n=Math.max(t.scrollHeight,t.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight);n+=l;s.height(n);if(s.data("max-width")!=="100%"){s.width(r)}if(c&&u){s.contents().find("body").css("overflow","hidden")}d()};d=function(){t.width("auto");if(s.data("max-width")!=="100%"){if(s.width()>a&&a>t.width()){e.width(s.width())}else{e.width(Math.min(a,t.width()))}}if(!c){e.doubleScroll();e.parent().doubleScroll();$(".doubleScroll-scroll-wrapper").css("margin","0 auto")}};s.off("load.iframe");s.on("load.iframe",function(){window.setTimeout(function(){i();var e=$(o.contentDocument.body);if(typeof e.imagesLoaded==="function"){e.imagesLoaded().progress(_.throttle(i,100)).always(i)}$(window).off("viewportChanged.iframe",d);$(window).on("viewportChanged.iframe",d)},50)})}else{s.on("load.iframe",function(){window.setTimeout(function(){s.iFrameResize({heightCalculationMethod:"grow",enablePublicMethods:true})},50)})}})});AGN.Lib.CoreInitializer.new("image-editor",function(e){if(!e){e=$(document)}_.each(e.find("#editor-canvas"),function(e){var o=e.getContext("2d");var s=new Image;s.src=$("#editor-img").attr("src");$("#editor-result").val("");s.onload=function(){var e=s.width;var t=s.height;o.canvas.width=e;o.canvas.height=t;o.drawImage(s,0,0,e,t);$("#l-editor-img-width").attr("value",e);$("#l-editor-img-height").attr("value",t);$("#l-editor-img-percent").attr("value",100);var i=e+$("#l-img-editor-tools").width()+10;$("#l-img-editor").css("min-width",i);var n=$("#editor-img").data("content-type");var r=o.canvas.toDataURL(n);$("#editor-result").attr("value",r)}})});(function(){var r=AGN.Lib.Helpers;AGN.Lib.CoreInitializer.new("input-mask",function(e){if(!e){e=$(document)}_.each(e.find(".js-inputmask"),function(e){var t=$(e);var i;var n;i=_.merge({},r.objFromString(t.data("inputmask-options")));n=i.mask;delete i.mask;t.inputmask(n,i)})})})();AGN.Lib.CoreInitializer.new("input-table",function(e=$(document)){const t=AGN.Opt.Templates;const i=_.template(t["plus-btn"]);const n=_.template(t["trash-btn"]);class r{constructor(e){const t=e.find("script[data-config]");this.config=t.exists()?t.json():{readonly:false,data:[]};this.readonly=this.config.readonly;this.$container=e;this.rowTemplateMustache=_.template(this.rowTemplate);this.renderTable(this.config.data);this.addActions();this.$container.data("table",this)}static get(e){return $(e).data("table")}get rowTemplate(){if(this._rowTemplate?.length){return this._rowTemplate}this._rowTemplate=this.$container.find("[data-row-template]").html();return this._rowTemplate}get $rowTemplate(){return $(this.rowTemplate)}renderTable(e){this.$table=$("<table>").addClass("input-table").append($("<tbody>"));if(this.readonly){this.$table.addClass("input-table--readonly")}this.$container.prepend(this.$table);_.each(e,e=>this.addRow(e));if(!this.readonly){this.addEmptyRow()}}addActions(){const e=this;this.addAction({click:"[data-add-row]"},this.addEmptyRow.bind(this));this.addAction({enterdown:"input"},function(){this.event.preventDefault();e.getNextInputToFocus(this.el).focus()});this.addAction({click:"[data-delete-row]"},function(){this.el.closest("tr").remove();e.$container.trigger("input-table:row-removed")})}addAction(e,t){AGN.Lib.Action.new(e,t,this.$table)}collect(e=true){let t=this.$table.find("tr").toArray();if(!e){t=t.slice(0,-1)}return t.filter(e=>!this.isEmptyRow$($(e))).map(e=>this.getRowData($(e)))}getRowData(e){const i={};e.find(":input[data-name]").each((e,t)=>i[$(t).data("name")]=$(t).val());return i}addRow(e){if(!this.isUniqueRow(e)){return}const t=this.#generateRowBtn(e);const i=$(this.rowTemplateMustache(e));if(!this.readonly){i.append($("<td>").html(t))}this.$table.append(i);AGN.runAll(i);AGN.Lib.Form.get(this.$table).initFields()}getNextInputToFocus(e){const t=e.closest("tr");if(this.isEmptyRow$(t)){return t.find(':input[type="text"]:first')}const i=t.find(':input[type="text"]');const n=i.index(e);let r=i.eq(n+1);if(r.length){return r}r=t.next().find(':input[type="text"]:first');if(r.length){return r}this.addEmptyRow();return this.$table.find('tr:last input[type="text"]:first')}#generateRowBtn(e){return this.#isEmptyRow(e)?this.generateAddBtn():this.generateDeleteBtn()}generateAddBtn(){return i({attrs:"data-add-row"})}generateDeleteBtn(){return n({attrs:"data-delete-row"})}#isEmptyRow(e){return this.getRowEntries(e).every(([,e])=>this.#isBlank(e))}getNames(){return this.$rowTemplate.find("[data-name]").toArray().map(e=>$(e).data("name"))}getRowEntries(e){const t=this.getNames();return Object.entries(e).filter(([e])=>t.includes(e))}isEmptyRow$(e){return _.every(e.find(':input:not([type="hidden"])'),e=>{const t=$(e);return t.prop("disabled")||this.#isBlank(t.val())})}#isBlank(e){return e===null||e===undefined||String(e).trim()===""}addEmptyRow(){const e=this.$table.find("tr:last");if(!e.length||!this.isEmptyRow$(e)){this.replaceNewButtonWithDeleteButton();this.addRow(this.getNames().reduce((e,t)=>{e[t]="";return e},{}))}this.focusOnLastRow()}focusOnLastRow(){this.$table.find("tr:last input:first").focus()}isUniqueRow(e){if(this.#isEmptyRow(e)){return true}const t=this.getRowEntries(e);return!this.$table.find("tr").toArray().some(i=>{return t.every(([e,t])=>$(i).find(`[data-name="${e}"]`).val()===t)})}replaceNewButtonWithDeleteButton(){const e=this.$table.find("[data-add-row]");e.after(this.generateDeleteBtn());e.remove()}clean(){this.$table.find("tr").remove();this.addEmptyRow()}}AGN.Lib.InputTable=r;_.each(e.find("[data-input-table]"),function(e){new r($(e))})});$.fn.queryBuilder.defaults({templates:{group:`
<dl id="{{= it.group_id }}" class="rules-group-container">
  <dt class="rules-group-header">
    <div class="group-conditions radio-switch">
      {{~ it.conditions: condition }}
        <input id="qb-codition-btn-{{= condition }}-group-{{= it.group_id }}" type="radio" name="{{= it.group_id }}_cond" value="{{= condition }}">
        <label for="qb-codition-btn-{{= condition }}-group-{{= it.group_id }}">{{= it.translate("conditions", condition) }}</label>
      {{~}}
    </div>
    
    <div class="group-actions">
      <button type="button" class="btn btn-sm btn-primary" data-add="rule">
        <i class="{{= it.icons.add_rule }}"></i>
        <span class="text">{{= it.translate("add_rule") }}</span>
      </button>
      {{? it.settings.allow_groups===-1 || it.settings.allow_groups>=it.level }}
        <button type="button" class="btn btn-sm btn-primary" data-add="group">
          <i class="{{= it.icons.add_group }}"></i>
          <span class="text">{{= it.translate("add_group") }}</span>
        </button>
      {{?}}
      {{? it.level>1 }}
        <button type="button" class="btn btn-sm btn-danger" data-delete="group">
          <i class="{{= it.icons.remove_group }}"></i>
          <span class="text">{{= it.translate("delete_group") }}</span>
        </button>
      {{?}}
    </div>
    
    {{? it.settings.display_errors }}
      <div class="error-container"><i class="{{= it.icons.error }}"></i></div>
    {{?}}
  </dt>
  <dd class=rules-group-body>
    <ul class=rules-list></ul>
  </dd>
</dl>`}});$.fn.queryBuilder.defaults({templates:{rule:`
<li id="{{= it.rule_id }}" class="rule-container">
  <div class="rule-header">
    <div class="rule-actions">
      <button type="button" class="btn btn-icon-sm btn-danger" data-delete="rule">
        <i class="{{= it.icons.remove_rule }}"></i>
      </button>
    </div>
    <div class="rule-operator-conditions-container"></div>
  </div>
  {{? it.settings.display_errors }}
    <div class="error-container"><i class="{{= it.icons.error }}"></i></div>
  {{?}}
  <div class="rule-filter-container"></div>
  <div class="rule-operator-container"></div>
  <div class="rule-value-container"></div>
</li>`}});$.fn.queryBuilder.defaults({templates:{filterSelect:`
{{ var optgroup = null; }}
<select class="form-control" name="{{= it.rule.id }}_filter" data-select-options="dropdownAutoWidth: true">
  {{? it.settings.display_empty_filter }}
    <option value="-1">{{= it.settings.select_placeholder }}</option>
  {{?}}
  {{~ it.filters: filter }}
    {{? optgroup !== filter.optgroup }}
      {{? optgroup !== null }}</optgroup>{{?}}
      {{? (optgroup = filter.optgroup) !== null }}
        <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">
      {{?}}
    {{?}}
    <option value="{{= filter.id }}">{{= it.translate(filter.label) }}</option>
  {{~}}
  {{? optgroup !== null }}</optgroup>{{?}}
</select>`}});$.fn.queryBuilder.defaults({templates:{ruleValueSelect:'{{ var optgroup = null; }} <select class="form-control js-select" name="{{= it.name }}" {{? it.rule.filter.multiple }}multiple{{?}}>   {{? it.rule.filter.placeholder }}     <option value="{{= it.rule.filter.placeholder_value }}" disabled selected>{{= it.rule.filter.placeholder }}</option>   {{?}}   {{~ it.rule.filter.values: entry }}     {{? optgroup !== entry.optgroup }}       {{? optgroup !== null }}</optgroup>{{?}}       {{? (optgroup = entry.optgroup) !== null }}         <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">       {{?}}     {{?}}     <option value="{{= entry.value }}">{{= entry.label }}</option>   {{~}}   {{? optgroup !== null }}</optgroup>{{?}} </select>'}});$.fn.queryBuilder.defaults({icons:{add_group:"icon icon-plus-circle",add_rule:"icon icon-plus",remove_group:"icon icon-times",remove_rule:"icon icon-trash-alt",error:"icon icon-exclamation-triangle"}});(function(){var t=AGN.Lib.Load;AGN.Lib.CoreInitializer.new("load",function(e){if(!e){e=$(document)}_.each(e.find("[data-load]"),function(e){window.setTimeout(function(){t.load($(e))},100)})})})();(function(){const r=30;const i="login-page";const n=AGN.Lib.Storage;const e=AGN.Lib.Messages;function o(){return n.get(i)||{}}function s(e){n.set(i,e)}function a(){const e=o();if(e?.notificationDismissExpiration){return e.notificationDismissExpiration<=Date.now()}const t=localStorage.getItem("closedDate");if(t){const i=new Date;const n=new Date(t);n.setDate(n.getDate()+r);return i-n>0}return true}function l(){const e=o();const t=new Date;t.setDate(t.getDate()+r);e.notificationDismissExpiration=t.getTime();s(e)}function c(){return o().isFrameShown==false}AGN.Lib.DomInitializer.new("logon",function(){if(a()&&this.config.SHOW_TAB_HINT===true){e(t("defaults.info"),t("logon.info.multiple_tabs"),"info",l,false)}if(this.config.logoutMsg){e.infoText(this.config.logoutMsg)}})})();AGN.Lib.DomInitializer.new("logon-complete",function(e){var t=AGN.Lib.Form.get(e);var n={};window.adminId=this.config.adminId;if(this.config){$.each(this.config.webStorageBundleNames,function(e,t){try{var i=AGN.Lib.Storage.get("web-storage#"+t);if(i!=null){n[t]=i}}catch(e){console.error(e)}});var i=AGN.Lib.Storage.get("login-page")||{};i.isFrameShown=!!this.config.isFrameShown;AGN.Lib.Storage.set("login-page",i)}t.setValue("webStorageJson",JSON.stringify(n));t.submit()});(function(){const s=45e3;const a=3*60*6e4;AGN.Opt.Components.MailingContentLock={manageLock:function(e,t,i){if(e>0&&t){var n=Date.now();var r;var o=function(){if(n+a>Date.now()){$.ajax({url:AGN.url("/mailing/ajax/"+e+"/lock.action"),type:"POST",success:function(e){if(e.success!==true){clearInterval(r)}},statusCode:{404:function(){clearInterval(r)}}})}else{clearInterval(r);$(document).trigger("ajax:unauthorized");$.ajax({url:AGN.url("/logout.action"),type:"POST",success:function(){$("body").append(AGN.Lib.Template.text("session-expired"))}})}};r=setInterval(o,s);return true}else{AGN.Lib.Modal.fromTemplate("mailing-locked",{username:i});return false}}}})();AGN.Lib.DomInitializer.new("mailing-content-overview",function(e,t){const i=this.config;const n=$("#myDatePicker");const r=$("#myTimePicker");if(!t){var o=AGN.Lib.Storage.get("mailings-content-dynNameID");if(o){var s=$("tr[data-dyn-name-id='"+o.dynNameID+"']");if(s.exists()){var a=s.position().top;setTimeout(function(){$("body").scrollTop(a)},1);AGN.Lib.Storage.set("mailings-content-dynNameID",{dynNameID:0})}}}if(n.exists()){n.on("change",function(){const e=n.datepicker("getDate");$("#startDay").val(e?e.getDate():0);$("#startMonth").val(e?e.getMonth()+1:0);$("#startYear").val(e?e.getFullYear():0)});r.on("timepicker:complete",function(){var e=r.val();$("#startHour").val(e.substr(0,2));$("#startMinute").val(e.substring(3,5))});r.on("timepicker:incomplete",function(){$("#startHour").val(0);$("#startMinute").val(0)})}function l(){return!i.isMailingExclusiveLockingAcquired&&!AGN.Opt.Components.MailingContentLock.manageLock(i.mailingId,i.isMailingExclusiveLockingAcquired,i.anotherLockingUserName)}if(l()||!i.isEditableMailing){var c=$('[data-controls-group="editing"]');c.prop("disabled",true);c.addClass("disabled")}});AGN.Lib.DomInitializer.new("mailing-content-view",function(e){AGN.Lib.Storage.set("mailings-content-dynNameID",{dynNameID:e.data("dyn-name-id")})});AGN.Lib.Controller.new("mailing-followup-options",function(){var t;var i="";var e=[];this.addDomInitializer("mailing-followup-options",function(){t=$("#followUpType");i=$("#lightWeightMailingList");e=this.config.additionalOptions;r();i.on("change",function(){r()})});var n=function(){return AGN.Lib.Template.text("followupAdvertisingOptions",{items:e})};var r=function(){var e=AGN.Lib.Select.get(i).getSelectedValue();t.children(".advertisingOption").remove();if(e){$.ajax({type:"POST",url:AGN.url("/mailing/ajax/"+e+"/isAdvertisingContentType.action")}).done(function(e){if(e&&e.success){t.append(n())}})}}});AGN.Lib.DomInitializer.new("mediapool-image-pick",function(i){let e;AGN.Lib.Action.new({click:"tbody tr"},function(){if(e){n(e,false)}e=this.el;n(e,true)},i);AGN.Lib.Action.new({dblclick:"tbody tr"},function(){t(this.el)},i);this.addAction({click:"mpAcceptImage"},function(){t(e)});function t(e){if(e){const t=r(e);if(t){AGN.Lib.Confirm.get(i).positive(t)}}else{AGN.Lib.Messages.alert("messages.error.nothing_selected")}}function n(e,t){const i=e.find("input[type=checkbox]");e.toggleClass("picked",t);i.prop("checked",t)}function r(e){return e.find("[data-mediapool-image-info]").json()}});(function(){var r={data:{chartsColors:["#26b98a"],statChartData:{columnTitles:[],c3data:{bindto:"#barchart-message-stats",data:{columns:[],type:"bar",labels:true},axis:{x:{tick:{centered:true,fit:true,format:function(e){return r.data.statChartData.columnTitles[e]}}},y:{show:false}},legend:{show:false},tooltip:{format:{title:function(){return null},name:function(e,t,i,n){return r.data.statChartData.columnTitles[n]},value:function(e,t,i,n){return e}}},padding:{right:25,left:25}},build:function(e){this.columnTitles.push(e.shift());e.unshift("values");this.c3data.data.columns=[e];return this.c3data}}},updateChart:function(e){$.ajax({type:"GET",url:e,success:function(e){c3.generate(r.data.statChartData.build(e));AGN.Lib.CoreInitializer.run("equalizer")}})}};AGN.Lib.MessageStatisticsService=r;AGN.Lib.DomInitializer.new("message-stat",function(e){var t=AGN.Lib.Helpers.objFromString(e.data("config"));if(t&&t.url){r.updateChart(t.url)}})})();AGN.Lib.CoreInitializer.new("multi-editor",function(e=$(document)){const i=AGN.Lib.Helpers;const n=AGN.Lib.Modal;const r=AGN.Lib.FormBuilder.FormBuilder;const o=AGN.Lib.Editor;class s{constructor(e){const t=e.data("_multi_editor");if(t){return t}this.$el=e;this.$container=e.parent();this.#init()}#init(){this.$resizeBtn.on("click",()=>this.resize());this.updateResizeBtn()}resize(){if(this.enlarged){this.apply()}else{this.enlarge()}this.updateResizeBtn()}enlarge(){this.toggleWysiwygIfSelected(false);this.createBackup();this.showModal();this.toggleWysiwygIfSelected(true)}createBackup(){this.backup={};_.each(this.editor$,e=>this.backup[$(e).attr("id")]=o.get($(e)).val());_.each(this.$el.find(".js-form-builder"),e=>this.backup[$(e).attr("id")]=r.get(e).getJson())}showModal(){const e=this.$resizeBtn.data("enlarged-modal")||"multi-editor-modal";const t=i.objFromString(this.$resizeBtn.data("modal-set"));this.$modal=n.fromTemplate(e,t);this.$placeholder.replaceWith(this.$el);this.$applyBtn.on("click",()=>this.resize());this.$modal.on("hide.bs.modal",()=>this.hideModal());this.$el.trigger("enlarged");o.get(this.editor$).resize()}hideModal(){if(!this.applyChanges){this.cancel()}this.applyChanges=false;this.updateResizeBtn()}cancel(){this.toggleWysiwygIfSelected(false);this.restore();this.$container.append(this.$el);this.toggleWysiwygIfSelected(true)}restore(){Object.entries(this.backup).forEach(([e,t])=>{if(r.isCreated(`#${e}`)){r.get("#"+e).setJson(t)}else{this.$el.find(`#${e}`).data("_editor")?.val(t)}})}apply(){this.applyChanges=true;this.toggleWysiwygIfSelected(false);n.getInstance(this.$modal).hide();this.$container.append(this.$el);this.toggleWysiwygIfSelected(true)}toggleWysiwygIfSelected(e){if(this.wysiwygSelected){this.$el.trigger(e?"tile:show":"tile:hide")}}get editor$(){return this.$el.find(".js-editor")}get wysiwygSelected(){return this.$el.find('[data-multi-editor-option="wysiwyg"]').is(".active")}get enlarged(){return this.$el.closest(".modal").length>0}get $resizeBtn(){return this.$el.find("[data-enlarged-modal]")}get $applyBtn(){return this.$modal?.find("[data-apply-enlarged]")}get $placeholder(){return this.$modal?.find(".modal-body [data-placeholder]")}updateResizeBtn(){this.$resizeBtn.find("i").toggleClass("icon-expand-arrows-alt",!this.enlarged).toggleClass("icon-compress-arrows-alt",this.enlarged);AGN.Lib.Tooltip.remove(this.$resizeBtn);AGN.Lib.Tooltip.createTip(this.$resizeBtn,this.enlarged?"":t("defaults.enlargeEditor"))}}_.each(e.find("[data-multi-editor]"),function(e){new s($(e))})});(function(){var s={data:{chartsColors:["#0071b9","#009999","#92d050","#41641a","#ffc000"],browserChartData:{c3data:{bindto:"#notificationGlobalBrowserStat",data:{rows:[],type:"donut"},donut:{label:{show:true}},legend:{position:"right"},tooltip:{show:false}},build:function(e,t){this.c3data.data.rows=[e,t];var i={};for(var n=0;n<e.length;n++){i[e[n]]=s.data.chartsColors[n]}this.c3data.data.colors=i;return this.c3data}}},roundTo:function(e,t){return parseFloat(e).toFixed(t)*1},updateChart:function(e){$.ajax({type:"GET",url:e,success:function(e){if(e&&(e.warning&&e.warning.length>0)){AGN.Lib.JsonMessages(e,true)}else{var t=[];var i=[];var n=0;for(key in e){var r=s.roundTo(e[key]*100,1);t.push(key);i.push(r);n+=r}if(!isNaN(n)&&n>0){for(var o=0;o<i.length;o++){t[o]+=" "+s.roundTo(100*i[o]/n,1)+"%"}}c3.generate(s.data.browserChartData.build(t,i));AGN.Lib.CoreInitializer.run("equalizer")}}})}};AGN.Lib.GLobalNotificationBrowserStatService=s;AGN.Lib.DomInitializer.new("notification-global-browser-stat",function(e){var t=AGN.Lib.Helpers.objFromString(e.data("config"));if(t&&t.url){AGN.Lib.GLobalNotificationBrowserStatService.updateChart(t.url)}})})();(function(){var u={data:{chartColors:["#0071b9","#006600","#b30000"],globalProgressChartData:{columnTitles:[],c3data:{bindto:"#notificationGlobalProgressStat",data:{x:"x",columns:[]},axis:{x:{type:"category",tick:{centered:true,fit:false}}},padding:{right:25}},build:function(e,t,i,n){this.c3data.data.columns=[e,t,i,n];var r={};r[t[0]]=u.data.chartColors[0];r[i[0]]=u.data.chartColors[1];r[n[0]]=u.data.chartColors[2];this.c3data.data.colors=r;return this.c3data}}},updateChart:function(e){var n=["x"];var r=[];var o=[];var s=[];var t=$("#selectMode").val();var i=$("#selectMonth").val();var a=$("#selectYear").val();var l=$("#startDay").val();var c=$("#endDay").val();$.ajax({type:"GET",url:e,data:{dateMode:t,selectMonth:i,selectYear:a,startDay:l,endDay:c},success:function(e){if(e&&e.warning&&e.warning.length>0){AGN.Lib.JsonMessages(e,true)}else{for(objIndex in e){var t=e[objIndex];for(objKey in t){if(objIndex==0&&objKey!="time"){if(r.length==0){r.push(objKey)}else if(o.length==0){o.push(objKey)}else if(s.length==0){s.push(objKey)}}var i=t[objKey];if(objKey=="time"){n.push(i)}else if(objKey==r[0]){r.push(i)}else if(objKey==o[0]){o.push(i)}else if(objKey==s[0]){s.push(i)}}}c3.generate(u.data.globalProgressChartData.build(n,r,o,s));AGN.Lib.CoreInitializer.run("equalizer")}}})}};AGN.Lib.GLobalNotificationProgressStatService=u;AGN.Lib.DomInitializer.new("notification-global-progress-stat",function(e){var t=AGN.Lib.Helpers.objFromString(e.data("config"));if(t&&t.url){AGN.Lib.GLobalNotificationProgressStatService.updateChart(t.url)}})})();(function(){var r={data:{chartsColors:["#0071b9","#92D050","#41641A"],statusChartData:{columnTitles:[],c3data:{bindto:"#notificationGlobalStatusStat",data:{columns:[],type:"bar",labels:true,color:function(e,t){return r.data.chartsColors[t.index]}},axis:{x:{tick:{centered:true,fit:true,format:function(e){return r.data.statusChartData.columnTitles[e]}}},y:{show:false}},legend:{show:false},tooltip:{format:{title:function(){return null},name:function(e,t,i,n){return r.data.statusChartData.columnTitles[n]},value:function(e,t,i,n){return e}}},padding:{right:25,left:25}},build:function(e,t){this.columnTitles=e;var i=t.slice(0);i.unshift("values");this.c3data.data.columns=[i];return this.c3data}}},updateChart:function(e){$.ajax({type:"GET",url:e,success:function(e){if(e&&e.warning&&e.warning.length>0){AGN.Lib.JsonMessages(e,true)}else{var t=[];var i=[];for(key in e){t.push(key);i.push(e[key])}c3.generate(r.data.statusChartData.build(t,i));AGN.Lib.CoreInitializer.run("equalizer")}}})}};AGN.Lib.GLobalNotificationStatusStatService=r;AGN.Lib.DomInitializer.new("notification-global-status-stat",function(e){var t=AGN.Lib.Helpers.objFromString(e.data("config"));if(t&&t.url){AGN.Lib.GLobalNotificationStatusStatService.updateChart(t.url)}})})();AGN.Lib.CoreInitializer.new("push-notification-preview",function(e){if(!e){e=$(document)}_.each(e.find(".push-notification-preview-button"),function(e){function i(e){e.prop("disabled",true);e.parent().attr("data-tooltip",e.parent().attr("data-tooltip-if-disabled"))}var n=$(e);var d=n.data("notification-form");if(Notification.permission=="denied"){i(n)}else{n.on("click",function(){function t(){var e=$("#"+d);var t=e.find("#pushTitle");var i=e.find("#pushContent");var n=e.find("#pushIcon");var r=e.find("#pushLink");var o=t?t.val():"";var s=i?i.val():"";var a=n?n.val():"";var l=r?r.val():"";var c={body:s,icon:a};var u=new Notification(o,c);u.onclick=function(e){e.preventDefault();window.open(l,"_blank")}}if(Notification.permission!="granted"){Notification.requestPermission(function(e){if(e=="granted"){t()}else if(e=="denied"){i(n)}})}else{t()}})}})});(function(){var s={data:{chartsColors:["#0071b9"],statChartData:{columnTitles:[],c3data:{bindto:"#barchart-notification-stats",data:{columns:[],type:"bar",labels:true},axis:{x:{tick:{centered:true,fit:true,format:function(e){return s.data.statChartData.columnTitles[e]}}}},legend:{show:false},tooltip:{format:{title:function(){return null},name:function(e,t,i,n){return s.data.statChartData.columnTitles[n]},value:function(e,t,i,n){return e}}},padding:{right:25}},build:function(e,t){this.columnTitles=e;var i=t.slice(0);i.unshift("values");this.c3data.data.columns=[i];return this.c3data}},progressChartData:{c3data:{bindto:"#progresschart-notification-stats",data:{x:"x",columns:[]},axis:{x:{type:"category",tick:{fit:false}}},zoom:{enabled:true,rescale:true},subchart:{show:true},padding:{right:25}},build:function(e,t,i){this.c3data.data.columns=[e,t,i];return this.c3data}}},updateCharts:function(e,t){$.ajax({type:"GET",url:t,data:{pushID:e},success:function(e){i(e["common"]);n(e["viewsclicks"]);AGN.Lib.CoreInitializer.run("equalizer")}})}};AGN.Lib.NotificationStatService=s;AGN.Lib.DomInitializer.new("notification-stats",function(e){var t=AGN.Lib.Helpers.objFromString(e.data("config"));if(t&&t.pushId&&t.url){AGN.Lib.NotificationStatService.updateCharts(t.pushId,t.url)}});function i(e){var t=[];var i=[];for(var n in e){if(e.hasOwnProperty(n)){t.push(n);i.push(e[n])}}c3.generate(s.data.statChartData.build(t,i))}function n(e){var t=["x"];var i=[];var n=[];for(objIndex in e){var r=e[objIndex];for(var o in r){if(r.hasOwnProperty(o)){if(objIndex==0&&o!="time"){if(i.length==0){i.push(o)}else if(n.length==0){n.push(o)}}if(o=="time"){t.push(r[o])}else if(i[0]==o){i.push(r[o])}else if(n[0]==o){n.push(r[o])}}}}c3.generate(s.data.progressChartData.build(t,i,n))}})();AGN.Lib.CoreInitializer.new("polling-form",function(e){if(!e){e=$(document)}e.find('[data-form="polling"]').each(function(){AGN.Lib.Form.get($(this)).submit()})});AGN.Lib.CoreInitializer.new("popover-validate",function(){AGN.Lib.Popover.validate()});AGN.Lib.CoreInitializer.new("popuot-window",function(e){if(!e){e=$(document)}_.each(e.find("[data-popuot-window]"),function(e){const i=$(e);const n=i.attr("src");if(!n){return}i.parent().append($("<figure>").append(i).append($(`
          <figcaption>
            <span class="text-truncate">${n}</span>
            <a href="" class='link-secondary' data-popup="${n}" data-bs-dismiss="modal">
              ${t("defaults.window.popout")}&nbsp;<i class="icon icon-external-link-alt"></i>
            </a>
          </figcaption>`)))})});AGN.Lib.CoreInitializer.new("preview-table",function(e){if(!e){e=$(document)}e.find("[data-preview-table]").each(function(){AGN.Lib.PreviewTable.init($(this))})});(function(){AGN.Lib.CoreInitializer.new("target-group-query-builder-extend",function(){if(window.queryBuilderIsExtended){return}window.queryBuilderIsExtended=true;var u=2;var l={};function o(e,t){if(Math.sign(e)===-1){t.push("sub")}else{t.push("add")}}function d(e,t,i){if(i){if(i==="sub"){t="-"+Math.abs(t)}else{t="+"+Math.abs(t)}}e.$el.find("#date-filter").val(t)}var e=$.fn.queryBuilder;var r=e.constructor;var i=r.prototype.init;var s=r.prototype.validate;var a=r.prototype.bindEvents;l=r.utils;var c=r.selectors;Object.assign(c,{rule_include_empty:".rule-include-empty[name*=_include_empty]",rule_operator_conditions_container:".rule-operator-conditions-container",rule_header_inputs:".rule-header :input"});l.defineModelProperties(r.Rule,["includeEmpty"]);e.extend({init:function(e){this.on("afterCreateRuleInput",function(e,t){var i=e.builder.optionsByType[t.filter.type];if(i){var n=i.postCreate;if(n&&typeof n==="function"){n.call(e.builder,t,i)}}});this.on("afterUpdateRuleOperator",function(e,t){var i=e.builder.optionsByType[t.filter.type];if(i){var n=i.postOperatorUpdate;if(n&&typeof n==="function"){n.call(e.builder,t,i)}}});this.setupInitialRule(e);return i.call(this,e)},isEmptyOrInitial:function(e){if(!e||!e.rules||!e.rules.length){return true}if(e.rules.length===1&&(e.rules[0].initialRule||e.rules[0].empty)){return true}return false},setupInitialRule:function(e){if(this.isEmptyOrInitial(e)){this.initialRule=true;e.rules=[{initialRule:true,empty:true}]}else{this.initialRule=false}},optionsByType:{date:{availableFormats:function(e){if(e&&e.type&&(e.type=="before"||e.type=="after")){return["YYYYMMDD"]}return["DD.MM.YYYY","YYYYMMDD","DDMMYYYY","MMDD","DDMM","DD","MM","YYYY"]},input:function(e,i){return $(` 
                            <div class="form-check form-switch">
                                <input id="${e.id}-today" name="today" type="checkbox" role="switch" class="form-check-input">
                                <label class="form-label form-check-label" for="${e.id}-today">${t("defaults.today")}</label>
                            </div>
                            <div class="input-group">
                                <input class="form-control rounded-2" type="text" id="date-filter"/>
                                <span id="date-offset-label" class="input-group-text input-group-text--dark" style="display: none;">${t("defaults.Days")}</span>
                            </div>
                            <label class="form-label text-nowrap d-flex align-items-center gap-1">
                                <span>${t("date.formats.label")}</span>
                                <a href="#" class="icon icon-question-circle" data-help="help_${this.settings.helpLanguage}/targets/DateFormat.xml"></a>
                            </label>
                            <div class="flex-grow-1">
                                <select class="form-control" id="date-format" data-select-options="dropdownAutoWidth: true">
                                    ${n(i.availableFormats(i.operator))}
                                </select>
                            </div>
                        `)},postCreate:function(t){var i=t.$el.find("input[name=today]");var n=t.$el.find("#date-offset-label");var r=t.$el.find("#date-filter");var o=t.$el.find("#date-format");var e=function(){var e=i.prop("checked");n.toggle(e);n.parent().find(".form-control").toggleClass("rounded-2",!e);r.off("change.offset keyup.offset");if(!t._updating_input){t._updating_value=true;if(e){r.val("+0")}else{r.val(h(new Date,o.val()))}t._updating_value=false}if(e){r.on("change.offset keyup.offset",function(e){var t=r.val();if(t){var i=parseInt(t);if(!isNaN(i)){var n=(i<0?"":"+")+i;if(n!=t){r.val(n)}}}else if(e.type==="change"){r.val("+0")}})}};i.on("change",e)},postOperatorUpdate:function(e,t){var i=e.$el.find("#date-format");i.html(n(t.availableFormats(e.operator)));i.change();i.trigger("change-date-format")},valueSetter:function(e,t){var i=t.slice(0);var n=e.$el.find("input[name=today]");var r=e.$el.find("#date-offset-label");var o=e.$el.find("#date-format");var s=false,a,l,c;if(t.length>u){if(i.shift()==="today"){s=true}c=i.shift();a=i.shift();l=i.shift()}else{c=i.shift();if(c==="today"){s=true;c="+0"}l=i.shift()}r.toggle(s);r.parent().find(".form-control").toggleClass("rounded-2",!s);d(e,c,a);o.val(l);n.prop("checked",s).change()},valueGetter:function(e){var t=[],i=e.$el.find("#date-filter").val(),n=e.$el.find("#date-format").val(),r=e.$el.find("input[name=today]").is(":checked");if(r){t.push("today");t.push(i);o(i,t)}else{t.push(i)}t.push(n);return t},validate:function(e){if(e.length==2){var t=e[0];var i=e[1];if(t){if("today"!=t&&i){return f(t,i.toUpperCase())?true:["invalid_format"]}else{return true}}else{return["empty_date"]}}else if(e.length==4){var n=e[1];if(!n||n!=parseInt(n)){return["invalid_expression"]}}return true}}},clearInitialRuleSettings:function(){var e=this;e.initialRule=false;$(".initial-rule").removeClass("initial-rule")},isInitial:function(e){if(e.length===1&&e[0].$el.hasClass("initial-rule")){return true}if(this.initialRule&&e.length===1){e[0].$el.addClass("initial-rule");return true}return false},validate:function(e){var t=this;var i=t.model.root.rules;var n=_.clone(e);n=$.extend({skip_filter_validation:true,skip_empty:false},n);if(n.skip_filter_validation){n.skip_empty=true}if(this.isInitial(i)){t.clearErrors();return true}t.clearInitialRuleSettings();return s.call(this,n)},getRuleInput:function(e,t){var i=e.filter;var n=e.filter.validation||{};var r=e.id+"_value_"+t;var o=i.vertical?" class=block":"";var s="";if(typeof i.input==="function"){s=i.input.call(this,e,r)}else if(typeof e.operator.input==="function"){s=e.operator.input.call(this,e,r)}else if(this.optionsByType[e.filter.type]&&typeof this.optionsByType[e.filter.type].input==="function"){s=this.optionsByType[e.filter.type].input.call(this,e,this.optionsByType[e.filter.type],r)}else{switch(i.input){case"radio":case"checkbox":l.iterateOptions(i.values,function(e,t){s+="<label"+o+'><input type="'+i.input+'" name="'+r+'" value="'+e+'"> '+t+"</label> "});break;case"select":s=this.getRuleValueSelect(r,e);break;case"textarea":s+='<textarea class="form-control" name="'+r+'"';if(i.size)s+=' cols="'+i.size+'"';if(i.rows)s+=' rows="'+i.rows+'"';if(n.min!==undefined)s+=' minlength="'+n.min+'"';if(n.max!==undefined)s+=' maxlength="'+n.max+'"';if(i.placeholder)s+=' placeholder="'+i.placeholder+'"';s+="></textarea>";break;case"number":s+='<input class="form-control" type="number" name="'+r+'"';if(n.step!==undefined)s+=' step="'+n.step+'"';if(n.min!==undefined)s+=' min="'+n.min+'"';if(n.max!==undefined)s+=' max="'+n.max+'"';if(i.placeholder)s+=' placeholder="'+i.placeholder+'"';if(i.size)s+=' size="'+i.size+'"';s+=">";break;default:s+='<input class="form-control" type="text" name="'+r+'"';if(i.placeholder)s+=' placeholder="'+i.placeholder+'"';if(i.type==="string"&&n.min!==undefined)s+=' minlength="'+n.min+'"';if(i.type==="string"&&n.max!==undefined)s+=' maxlength="'+n.max+'"';if(i.size)s+=' size="'+i.size+'"';s+=">"}}return this.change("getRuleInput",s,e,r)},getRuleValueSelect:function(e,t){var i=this.templates.ruleValueSelect({builder:this,name:e,rule:t,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleValueSelect",i,e,t)},updateRuleOperator:function(e,t){var i=e.$el.find(c.value_container);if(!e.operator||e.operator.nb_inputs===0){i.hide();e.__.value=undefined}else{i.css("display","");if(i.is(":empty")||!t||typeof t.input==="function"||typeof e.operator.input==="function"||e.operator.nb_inputs!==t.nb_inputs||e.operator.optgroup!==t.optgroup){this.createRuleInput(e)}}if(e.operator){e.$el.find(c.rule_operator).val(e.operator.type);e.__.value=this.getRuleInputValue(e);this.createExtendedOperatorConditions(e)}this.trigger("afterUpdateRuleOperator",e,t);this.trigger("rulesChanged")},createExtendedOperatorConditions:function(e){var i=this;var n=e.$el.find(c.rule_operator_conditions_container);if(e.operator.type==="not_equal"){e.includeEmpty=true;const r=$(`
                      <div class="form-check form-switch">
                        <input id="${e.id}_include_empty" type="checkbox" class="rule-include-empty form-check-input" name="${e.id}_include_empty" role="switch" checked="checked"/>
                        <label class="form-label form-check-label" for="${e.id}_include_empty">${t("querybuilder.common.include_empty")}</label>
                      </div>`);n.html(r);const o=r.find(c.rule_include_empty);o.on("change",function(){e.includeEmpty=i.getRuleIncludeEmptyValue(e)});e.$el.find(c.rule_header_inputs).prop("disabled",e.flags.header_readonly)}else{e.includeEmpty=false;n.html("")}},createRuleOperators:function(e){var t=e.$el.find(c.operator_container).empty();if(!e.filter){return}var i=this.getOperators(e.filter);if(!e.filter.skipOperator){var n=$(this.getRuleOperatorSelect(e,i));t.html(n)}if(e.filter.default_operator){e.__.operator=this.getOperatorByType(e.filter.default_operator)}else{e.__.operator=i[0]}e.$el.find(c.rule_operator).val(e.operator.type);this.trigger("afterCreateRuleOperators",e,i);this.applyRuleFlags(e)},createRuleInput:function(e){var t=e.$el.find(c.value_container).empty();e.__.value=undefined;if(!e.filter||!e.operator||e.operator.nb_inputs===0){return}var i=this;var n=$();var r=e.filter;for(var o=0;o<e.operator.nb_inputs;o++){var s=$(this.getRuleInput(e,o));if(r.canBeNegated){var a=i.getNegateInput();t.prepend(a);n=n.add(a)}if(o>0)t.append(this.settings.inputs_separator);t.append(s);if(typeof r.values==="function"){r.values.call(this,s)}n=n.add(s)}t.css("display","");n.on("change "+(r.input_event||""),function(){if(!e._updating_input){e._updating_value=true;e.negated=i.getNegateValue(e);e.value=i.getRuleInputValue(e);e._updating_value=false}});if(r.plugin){n[r.plugin](r.plugin_config||{})}this.trigger("afterCreateRuleInput",e);if(r.default_value!==undefined){e.value=r.default_value}else{e._updating_value=true;e.negated=i.getNegateValue(e);e.value=i.getRuleInputValue(e);e._updating_value=false}this.applyRuleFlags(e)},setRuleInputValue:function(e,t){var i=e.filter;var n=e.operator;if(!i||!n){return}e._updating_input=true;if(i.valueSetter){i.valueSetter.call(this,e,t)}else if(typeof e.operator.valueSetter==="function"){e.operator.valueSetter.call(this,e,t)}else if(this.optionsByType[e.filter.type]&&typeof this.optionsByType[e.filter.type].valueSetter==="function"){this.optionsByType[e.filter.type].valueSetter.call(this,e,t)}else{var r=e.$el.find(c.value_container);if(n.nb_inputs===1){t=[t]}for(var o=0;o<n.nb_inputs;o++){var s=l.escapeElementId(e.id+"_value_"+o);switch(i.input){case"radio":r.find("[name="+s+'][value="'+t[o]+'"]').prop("checked",true).trigger("change");break;case"checkbox":if(!$.isArray(t[o])){t[o]=[t[o]]}t[o].forEach(function(e){r.find("[name="+s+'][value="'+e+'"]').prop("checked",true).trigger("change")});break;default:if(n.multiple&&i.value_separator&&$.isArray(t[o])){t[o]=t[o].join(i.value_separator)}r.find("[name="+s+"]").val(t[o]).trigger("change");break}}}this.setNegated(e);e._updating_input=false},getRuleInputValue:function(e){var t=e.filter;var i=e.operator;var n=[];if(t.valueGetter){n=t.valueGetter.call(this,e)}else if(typeof e.operator.valueGetter==="function"){n=e.operator.valueGetter.call(this,e)}else if(this.optionsByType[e.filter.type]&&typeof this.optionsByType[e.filter.type].valueGetter==="function"){n=this.optionsByType[e.filter.type].valueGetter.call(this,e)}else{var r=e.$el.find(c.value_container);for(var o=0;o<i.nb_inputs;o++){var s=l.escapeElementId(e.id+"_value_"+o);var a;switch(t.input){case"radio":n.push(r.find("[name="+s+"]:checked").val());break;case"checkbox":a=[];r.find("[name="+s+"]:checked").each(function(){a.push($(this).val())});n.push(a);break;case"select":if(t.multiple){a=[];r.find("[name="+s+"] option:selected").each(function(){a.push($(this).val())});n.push(a)}else{n.push(r.find("[name="+s+"] option:selected").val())}break;default:n.push(r.find("[name="+s+"]").val())}}n=n.map(function(e){if(i.multiple&&t.value_separator&&typeof e=="string"){e=e.split(t.value_separator)}if($.isArray(e)){return e.map(function(e){return l.changeType(e,t.type)})}else{return l.changeType(e,t.type)}});if(i.nb_inputs===1){n=n[0]}if(t.valueParser){n=t.valueParser.call(this,e,n)}}return this.change("getRuleValue",n,e)},getRuleIncludeEmptyValue:function(e){return e.$el.find(c.rule_include_empty).is(":checked")},validateValue:function(e,t){var i=e.filter.validation||{};var n=true;if(i.callback){n=i.callback.call(this,t,e)}else if(typeof e.operator.validate==="function"){n=e.operator.validate.call(this,t,e)}else if(this.optionsByType[e.filter.type]&&typeof this.optionsByType[e.filter.type].validate==="function"){n=this.optionsByType[e.filter.type].validate.call(this,t,e)}else{n=this._validateValue(e,t)}return this.change("validateValue",n,t,e)},getRules:function(o){o=$.extend({get_flags:false,allow_invalid:false,skip_empty:false},o);var e=this.validate(o);if(!e&&!o.allow_invalid){return null}var s=this;var t=function i(e){var r={condition:e.condition,rules:[]};if(e.data){r.data=$.extendext(true,"replace",{},e.data)}if(o.get_flags){var t=s.getGroupFlags(e.flags,o.get_flags==="all");if(!$.isEmptyObject(t)){r.flags=t}}e.each(function(e){if(!e.filter&&o.skip_empty){return}var t=null;if(!e.operator||e.operator.nb_inputs!==0){t=e.value}var i={id:e.filter?e.filter.id:null,field:e.filter?e.filter.field:null,type:e.filter?e.filter.type:null,input:e.filter?e.filter.input:null,operator:e.operator?e.operator.type:null,value:t,includeEmpty:e.includeEmpty};if(e.filter&&e.filter.data||e.data){i.data=$.extendext(true,"replace",{},e.filter.data,e.data)}if(e.filter&&e.filter.canBeNegated){i.negated=e.negated}if(o.get_flags){var n=s.getRuleFlags(e.flags,o.get_flags==="all");if(!$.isEmptyObject(n)){i.flags=n}}r.rules.push(s.change("ruleToJson",i,e))},function(e){var t=i(e);if(t.rules.length!==0||!o.skip_empty){r.rules.push(t)}},this);return s.change("groupToJson",r,e)}(this.model.root);t.valid=e;return this.change("getRules",t)},setRules:function(e,r){r=$.extend({allow_invalid:false},r);this.setupInitialRule(e);if($.isArray(e)){e={condition:this.settings.default_condition,rules:e}}if(!e||!e.rules||e.rules.length===0&&!this.settings.allow_empty){l.error("RulesParse","Incorrect data object passed")}this.clear();this.setRoot(false,e.data,this.parseGroupFlags(e));this.applyGroupFlags(this.model.root);e=this.change("setRules",e,r);var o=this;(function i(e,n){if(n===null){return}if(e.condition===undefined){e.condition=o.settings.default_condition}else if(o.settings.conditions.indexOf(e.condition)==-1){l.error(!r.allow_invalid,"UndefinedCondition",'Invalid condition "{0}"',e.condition);e.condition=o.settings.default_condition}n.condition=e.condition;e.rules.forEach(function(e){var t;if(e.rules!==undefined){if(o.settings.allow_groups!==-1&&o.settings.allow_groups<n.level){l.error(!r.allow_invalid,"RulesParse","No more than {0} groups are allowed",o.settings.allow_groups);o.reset()}else{t=o.addGroup(n,false,e.data,o.parseGroupFlags(e));if(t===null){return}o.applyGroupFlags(t);i(e,t)}}else{if(!e.empty){if(e.id===undefined){l.error(!r.allow_invalid,"RulesParse","Missing rule field id");e.empty=true}if(e.operator===undefined){e.operator="equal"}}t=o.addRule(n,e.data,o.parseRuleFlags(e));if(t===null){return}if(e.id){if(!e.empty){t.filter=o.getFilterById(e.id,!r.allow_invalid)}if(t.filter){t.operator=o.getOperatorByType(e.operator,!r.allow_invalid);if(!t.operator){t.operator=o.getOperators(t.filter)[0]}}t.negated=e.negated;if(t.operator&&t.operator.nb_inputs!==0){t.includeEmpty=!!e.includeEmpty;if(e.value!==undefined){t.value=e.value}else if(t.filter.default_value!==undefined){t.value=t.filter.default_value}}}if(o.change("jsonToRule",t,e)!=t){l.error("RulesParse","Plugin tried to change rule reference")}}});if(o.change("jsonToGroup",n,e)!=n){l.error("RulesParse","Plugin tried to change group reference")}})(e,this.model.root);this.validate();this.trigger("afterSetRules")},getNegateValue:function(e){var t=e.$el.find("select.negate"),i;if(t.length!==0){i=t.val()==="true"}return i},getNegateInput:function(){return $(`
                  <div class="qb-input-negate">
                    <select class="form-control js-select negate" data-select-options="dropdownAutoWidth: true">
                      <option value="false">${t("defaults.yes")}</option>
                      <option value="true">${t("defaults.no")}</option>
                    </select>
                  </div>
                `)},setNegated:function(e){var t=e.$el.find("select.negate");if(t.length!==0){t.val(""+e.negated)}},displayError:function(e){if(this.settings.display_errors){if(e.error===null){e.$el.removeClass("has-error")}else{var t=this.translate("errors",e.error[0]);t=this.constructor.utils.fmt(t,e.error.slice(1));t=this.change("displayError",t,e.error,e);e.$el.addClass("has-error").find(this.constructor.selectors.error_container).eq(0).attr("data-tooltip",t);AGN.Lib.CoreInitializer.run("tooltip",e.$el)}}},bindEvents:function(){a.call(this);var n=this;this.model.on("update",function(e,t,i){if(t instanceof r.Rule&&i==="includeEmpty"){n.updateRuleIncludeEmpty(t)}})},findRuleByField:function(e,t,i){var n=function(e){return e.hasOwnProperty("rules")};if(n(e)){var r=this;return e.rules.find(function(e){if(n(e)){return i?r.findRuleByField(e,i):false}else{return e.field&&e.field===t}})}else{return e.field&&e.field===t}},deleteRuleByField:function(e,t,i){var n=this;if(!e){e=n.model.root;if(!e){return}}var r=false;e.each("reverse",function(e){if(e&&e.filter&&e.filter.id==t){r&=n.deleteRule(n.getModel(e.$el))}},function(e){r&=n.deleteRuleByField(e,t,i)},n);return!!r},setOrReplaceRule:function(e,t,i){if(!e){e=this.getRules({allow_invalid:true,skip_empty:true})}if(t&&t.id){var n=this.findRuleByField(e,t.id,i);if(n){$.extend(n,t)}else{e.rules.push(t)}this.setRules(e);return true}else{return false}},containsNotEmptyRule:function(e){var t=this;var i=t.getModel(e);if(i.rules&&i.rules.length){return i.rules.every(function(e){if(e.hasOwnProperty("rules")){return t.containsNotEmptyRule(e)}else{return!!e.filter}})}else{return!!i.filter}}});r.prototype.updateRuleIncludeEmpty=function(e){var t=e.$el.find(c.rule_include_empty);t.prop("checked",e.includeEmpty);this.trigger("rulesChanged")}});function n(e){var n=[];e.forEach(function(e){var i=$("<option />");i.text(t("date.formats."+e));i.val(e);n.push($("<div/>").append(i).html())});return n.join("")}function h(e,t){return t.replace("DD",AGN.Lib.Helpers.pad(e.getDate(),2)).replace("MM",AGN.Lib.Helpers.pad(e.getMonth()+1,2)).replace("YYYY",AGN.Lib.Helpers.pad(e.getFullYear(),4))}function f(e,t){if(!e){return false}var i=s(t);if(i){for(var n=0;n<i.length;n++){var r=i[n];if(r.isDigitFragment){if(r.isLenient){var o=e.match("^\\d{1,"+r.lexeme.length+"}");if(o){e=e.substring(o[0].length)}else{return false}}else{if(e.length<r.lexeme.length){return false}if(!e.substr(0,r.lexeme.length).match(/^\d+$/)){return false}e=e.substring(r.lexeme.length)}}else{if(e.startsWith(r.lexeme)){e=e.substring(r.lexeme.length)}else{return false}}}return!e}return false}function a(e){var t=["DD","MM","YYYY",".","-","_"];if(e){for(var i=0;i<t.length;i++){if(e.startsWith(t[i])){return t[i]}}}return false}function s(e){var t=["DD","MM","YYYY"];var i=[];while(e){var n=a(e);if(n){var r=false;var o=false;if(t.includes(n)){r=true;o=true;if(i.length){var s=i[i.length-1];if(s.isDigitFragment){s.isLenient=false;o=false}}}i.push({lexeme:n,isDigitFragment:r,isLenient:o})}else{return false}e=e.substring(n.length)}return i.length?i:false}})();(function(){const e="---";const r=.01;const o="< 1";const i=.001;const n={HIGH_PERFORMER:"#4FB102",OPPORTUNITY:"#0ACD70",LEAD:"#C2C2C2",SLEEPER:"#E12E59"};let f;AGN.Lib.DomInitializer.new("recipient-insights",function(){const o=this.config;const e=this.config.insightsData;$.i18n.load(o.translations);l(e.weekdayReactionRankData);c(e.hourReactionRankData);d(e.reactionDeviceRankData);h(e.reactionsInProgressData);p(e.mailingReactionPercentageData);m(e.pageImpressionsData);v(e.customerRevenueData);y(e.customerPerformanceData);this.addAction({change:"selectReactionProgressPeriod"},function(){const e=this.el;const t=e.find("option:selected");let i,n;switch(e.val()){case"YEAR":case"MONTH":i=t.data("min");n=t.data("max");break;case"CUSTOM":const r=a();i=r.min;n=r.max;break;default:console.error(`Unexpected period type: '${$type.val()}'`);return}s(i,n,o)});this.addAction({change:"period-select"},function(){const e=a();s(e.min,e.max,o)})});function s(e,t,i){if(e&&t){$.ajax(i.urls.reactionsInProgress,{type:"GET",data:{customerId:i.customerId,min:e,max:t}}).done(e=>h(e))}}function a(){return{min:$("#reactionProgressMinDate").val(),max:$("#reactionProgressMaxDate").val()}}function l(i){i=u(i);const n=Math.max(...i.values);const r=$("#days-reaction-chart");const e=r[0].getContext("2d");new Chart(e,{type:"bar",data:{labels:t("date.weekdaysShort"),datasets:[{data:i.values,backgroundColor:e=>{const t=i.values[e.dataIndex]===n;return r.css(t?"--chart-very-dark-blue-color":"--chart-blue-color")},categoryPercentage:.9,minBarLength:2}]},options:{indexAxis:"x",layout:{padding:{top:20,right:0}},scales:{x:{ticks:{autoSkip:false,maxRotation:90}},y:{display:false}},plugins:{legend:{display:false},datalabels:{anchor:"end",align:"end",offset:-5,formatter:(e,t)=>{return i.percentages[t.dataIndex]+"%"}},tooltip:{position:"nearest",callbacks:{label:function(e){return t("daysWithReactions")+": "+e.formattedValue}}}}}})}function c(i){i=u(i);const n=Math.max(...i.values);const r=$("#reaction-hour-chart");const e=r[0].getContext("2d");const o=new Chart(e,{type:"bar",data:{labels:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],datasets:[{data:i.values,backgroundColor:e=>{const t=i.values[e.dataIndex]===n;return r.css(t?"--chart-very-dark-blue-color":"--chart-blue-color")},categoryPercentage:.5,minBarLength:2}]},options:{indexAxis:"x",layout:{padding:{top:20,right:0}},scales:{x:{ticks:{autoSkip:false,maxRotation:90}},y:{display:false}},plugins:{legend:{display:false},datalabels:{anchor:"end",align:"end",offset:-5,formatter:(e,t)=>{return i.percentages[t.dataIndex]+"%"}},tooltip:{callbacks:{label:function(e){return t("reactionTimes")+": "+e.formattedValue}}}}}})}function u(e){const t=Object.values(e.values);const i=Object.entries(e.percentages).map(([e,t])=>t);return{values:t,percentages:i}}function d(e){const i=$("#reaction-device-chart");const n=[i.css("--chart-very-dark-blue-color"),i.css("--chart-dark-blue-color"),i.css("--chart-blue-color"),i.css("--chart-light-blue-color"),i.css("--chart-cyan-color")];const r=[];const o=[];$.each(e,function(e,i){r.push(i.value);o.push(t(i.deviceClass))});new Chart(i[0].getContext("2d"),{type:"agnDoughnut",data:{labels:o,datasets:[{data:r,backgroundColor:n,borderWidth:0}]}})}function h(n){if(f){f.destroy()}const e=$("#reaction-progress-chart");const i=e[0].getContext("2d");const r=[];const o=[];const s=[];const a=[];let l=false;let c=false;$.each(n.values,(e,t)=>{r.push(e);o.push(t.reactions);s.push(t.impressions);a.push(t.revenues);if(t.impressions>0){l=true}if(t.revenues>0){c=true}});const u=r.length;let d=3;if(u<60){d=5}else if(u<100){d=4}const h={type:"line",data:{labels:r,datasets:[{label:t("statistic.reactions"),data:o,borderColor:e.css("--chart-very-dark-blue-color"),backgroundColor:e.css("--chart-very-dark-blue-color"),pointRadius:d}]},options:{scales:{x:{ticks:{maxRotation:0}},y:{display:false}},interaction:{mode:"index",intersect:false},stacked:false,plugins:{legend:{position:"bottom"},datalabels:{display:false},tooltip:{callbacks:{title:function(e){const t=e[0].label;const i=n.values[t].mailingIds;if(i.length){return n.mailingNames[i[0]]+" "+t}return t}}}}}};if(l){h.data.datasets.push({label:t("statistic.impressions"),data:s,borderColor:e.css("--chart-blue-color"),backgroundColor:e.css("--chart-blue-color"),pointRadius:d})}if(c){h.data.datasets.push({label:t("statistic.revenue"),data:a,borderColor:e.css("--chart-dark-blue-color"),backgroundColor:e.css("--chart-dark-blue-color"),pointRadius:d})}f=new Chart(i,h)}function p(e){b("#reactionTypeKpi",e.percentage.percentage);$("#reactionGradeIcon").css("color",g(e.grade))}function g(e){return n[e]||"inherit"}function m(e){b("#impressionsByClickKpi",e.perClick);b("#impressionsByVisitKpi",e.perVisit);b("#impressionsByBuyKpi",e.perBuy)}function v(e){b("#revenueSumKpi",e.value);b("#revenueAvgKpi",e.average)}function y(e){if(e.clicks.percentage>0){b("#performanceClicksKpi",e.clicks.percentage)}else{b("#performanceClicksKpi",e.clicks.value>0?i:0)}b("#performanceRevenueKpi",e.revenue)}function b(e,t){const i=$(e);const n=i.find("[data-kpi-value]");if(t>0){if(t<r){n.text(o)}else{let e="";if(n.is("[data-kpi-sign]")){e=" "+n.data("kpi-sign")}n.text(`${t.toFixed(2)}${e}`)}}}})();AGN.Lib.DomInitializer.new("recipient-report-initializer",function(e){if(!$("body").hasClass("dark-theme")){return}const t=e.find("iframe");t.on("load.iframe",function(){i(t)});function i(e){const t=e.contents().find("body");const i=t.find("center");if(i.length){t.css("background-color","var(--main-bg-color)");i.css("background-color","var(--main-bg-color)")}else{e.contents().find("body").css("color","#fff")}e.height(e.contents().height())}});AGN.Lib.CoreInitializer.new("relative-href",function(e){if(!e){e=$(document)}e.find("a[data-relative]").each(function(){var e=$(this);e.attr("href",AGN.url(e.attr("href")));e.removeAttr("data-relative")})});AGN.Lib.CoreInitializer.new("restore",function(e=$(document)){const t=AGN.Lib.Storage;_.each(e.find("[data-restore-fields]"),e=>{t.restoreChosenFields($(e));i($(e))});function i(e){return e.on("change",function(){return t.saveChosenFields($(this))})}});(function(){const n=AGN.Lib.Scrollbar;AGN.Lib.CoreInitializer.new("scrollable",function(e=$(document)){_.each(e.find(".js-scrollable, .table-scrollable, .ag-body-viewport"),function(e){const t=$(e);const i=n.get(t);if(AGN.Lib.Helpers.isMobileView()){i?.destroy();return}if(i){i.update()}else{new n(t)}})})})();(function(){const e=AGN.Lib.Popover,l=AGN.Lib.Template,i=AGN.Lib.Page;const c="agn:select-scrollbar";AGN.Lib.CoreInitializer.new("select",["template"],function(e){if(!e){e=$(document)}_.each(e.all("select"),function(e){const i=$(e);if(i.data("select2")){i.select2("destroy")}if(i.hasClass("has-arrows")){new h(i)}let n={placeholder:i.attr("placeholder"),minimumResultsForSearch:10,showSearchIcon:true,width:"100%",searchInputPlaceholder:t("tables.searchOoo"),dropdownCssClass:":all:",selectionCssClass:":all:",dropdownParent:$("#main-view").exists()?"#main-view":"body",preventPlaceholderClear:false};if(i.closest(".modal").exists()){n.dropdownParent=i.closest(".modal")}if(i.closest(".dropdown-menu").exists()){n.dropdownParent=i.closest(".dropdown-menu")}if(!i.hasClass("js-select")){n.minimumResultsForSearch=0}if(i.hasClass("dropdown-select")){n.placeholder=t("tables.searchOoo");n.preventPlaceholderClear=true;i.on("select2:unselecting",function(e){i.on("select2:opening",function(e){e.preventDefault();i.off("select2:opening")})})}if(i.is("[data-sort]")){if(i.data("sort")==="alphabetic"){n.sorter=function(e){e.sort(function(e,t){if($(e.element).is("[data-no-sort]")){return-1}else if($(t.element).is("[data-no-sort]")){return 1}return e.text.toLowerCase().localeCompare(t.text.toLowerCase())});return e}}}if(i.prop("multiple")){n.matcher=d}if(i.is("[data-result-template]")){const s=i.data("result-template");n.templateResult=function(e){if(e.loading){return e.text}return l.dom(s,{element:e.element,isDisabled:e.disabled,text:e.text,title:e.title,value:e.id})}}const r=i.data("selection-template");const o=l.prepare(r||"select2-result");n.templateSelection=function(e){const t=o({element:Array.isArray(e.element)?e.element[0]:e.element,isDisabled:e.disabled,text:e.text,title:e.title,value:e.id});return $(t)};if(i.is("[data-select-options]")){const a=AGN.Lib.Helpers.objFromString(i.data("select-options"));n=_.extend(n,a)}if(i.is("[data-select-tree]")){u(i);i.select2ToTree(n)}else{i.select2(n)}i.on("select2:open",e=>{const t="scroll.select2";$(e.target).parents().off(t);$(window).off(t);window.setTimeout(()=>{const e=i.data("select2").$dropdown.find(".select2-results__options");i.data(c,new AGN.Lib.Scrollbar(e))},0)});i.on("selec2:closing",e=>i.data(c)?.destroy())})});function u(e){const t=e.find("option");const i=t.map(function(){return String($(this).data("parent")||"")}).get();t.each(function(){const e=$(this);if(e.val()&&i.includes(e.val())){e.attr("data-pup","parent")}else{if(e.data("parent")){e.attr("data-pup",e.data("parent"))}}})}function d(e,t){if(t.selected){return null}if($.trim(e.term)===""){return t}const i=e.term.toLowerCase();const n=t.text.toLowerCase();return n.includes(i)?t:null}class h{constructor(e){const t=e.data("selectWithArrows");if(t){t.toggleArrows();return t}this.$select=e;this.init()}init(){this.#createPrevBtn();this.#createNextBtn();this.$select.wrap($("<div>").addClass("select-container"));this.$select.closest(".select-container").prepend(this.$prevBtn).append(this.$nextBtn);this.$select.on("change",()=>this.toggleArrows());this.toggleArrows();this.$select.data("selectWithArrows",this)}toggleArrows(){const e=this.$select.prop("selectedIndex");this.$prevBtn.prop("disabled",e===0);this.$nextBtn.prop("disabled",e===this.$select.find("option").length-1)}#createPrevBtn(){this.$prevBtn=this.#createArrowBtn(true);this.$prevBtn.on("click",()=>this.#stepBack())}#createNextBtn(){this.$nextBtn=this.#createArrowBtn(false);this.$nextBtn.on("click",()=>this.#stepForward())}#createArrowBtn(e){return $(`
         <button class="btn btn-outline-primary btn-icon-sm btn-select-control">
           <i class="icon icon-caret-${e?"left":"right"}"></i>
         </button>
       `)}#stepForward(){this.#step(false)}#stepBack(){this.#step(true)}#step(e){const t=e?this.$prevBtn:this.$nextBtn;if(t.prop("disabled")){return}this.$select.prop("selectedIndex",this.$select.prop("selectedIndex")+(e?-1:1)).trigger("change");this.toggleArrows()}}})();AGN.Lib.DomInitializer.new("session-timer",function(){const i=10*60*1e3;const n=5*1e3;const r=401;const o=501;const e=this.config;const t=this.config.sessionInfoUrl;const s=this.config.creationTime;const a=this.config.lastAccessedTime;let l=this.config.maxInactiveInterval;let c;let u=false;let d=true;let h=false;let f;if(e&&s&&a&&l){c=l*1e3+Date.now();p()}function p(){setInterval(function(){const e=Date.now();const t=c>e?c-e:0;if(!f){f=new _}if((!d||t<=i)&&!u&&!h){f.showTimerBlock(t)}if(!h&&!u&&c+n>e&&c<e){f.showLoading()}if(!u&&!h&&c+n<e){g()}},1e3)}function g(){$.ajax({url:t,global:false,beforeSend:m,success:v,error:y,complete:b})}function m(){h=true}function v(e){if(!!e){l=e.maxInactiveInterval;c=Date.now()+e.maxInactiveInterval*1e3;u=false}else{u=true;f.showSessionExpired()}}function y(e){if(e.status===r){u=true;f.showSessionExpired()}}function b(){h=false;d=false}$(document).ajaxComplete(function(e,t){if(!e.preventSessionTimer&&!u&&!h&&(t.status!==r&&t.status<o)){c=l*1e3+Date.now()}e.preventSessionTimer=true});class _{constructor(){this.timerBlock=$("#session-timer-block");this.timeLabel=$("#session-time-label");this.isSessionExpiredNotification=false;this.refreshIconClass="icon icon-spinner icon-pulse"}showTimerBlock(e){this.timerBlock.removeClass("hidden");this.printTimerText(e)}showSessionExpired(){this.printTimerText(0);if(!this.isSessionExpiredNotification){const e=AGN.Lib.Modal.fromTemplate("session-expired");e.on("modal:close",()=>AGN.Lib.Page.reload(AGN.url("/logon.action")));this.isSessionExpiredNotification=true}}showLoading(){const e=`<i class="${this.refreshIconClass}"></i>`;this.changeTimeFieldContent(e)}printTimerText(e){let t="00:00";if(e>0){const i=new Date(e);t=i.getMinutes()>0?d3.format("02")(i.getUTCMinutes())+":":"00:";t+=i.getSeconds()>0?d3.format("02")(i.getUTCSeconds()):"00"}this.changeTimeFieldContent(t)}changeTimeFieldContent(e){this.timeLabel.html(e)}}return false});AGN.Lib.CoreInitializer.new("slider",function(e=$(document)){_.each(e.find("[data-toggle-checkboxes]"),function(e){const t=$(e);r(t);n(t).click(()=>r(t));t.on("update-toggle-all",()=>r(t));i(t)});function i(e){e.on("click",function(){const t=$(this);_.each(t.closest(".tile").find(".tile-body [type=checkbox]:enabled:visible"),e=>$(e).prop("checked",t.is(":checked")))})}function n(e){return e.closest(".tile").find(".tile-body").find(".form-check-input:visible")}function r(e){const t=n(e);e.prop("checked",o(t));e.prop("disabled",s(t))}function o(e){return _.every(e.filter(":not(:disabled)"),e=>e.checked)}function s(e){return e.filter(":not(:disabled)").length===0}});AGN.Lib.CoreInitializer.new("switchable-input",function(e=$(document)){const t=AGN.Lib.ToggleVisField.STR;t.DATA_SHOW_ON_SWITCH="data-show-on-switch";t.DATA_HIDE_ON_SWITCH="data-hide-on-switch";t.BODY_SELECTOR=".switchable-input__body";class i{constructor(e){const t=e.data("switchableInput");if(t){return t}this.$el=e;this.#init()}#init(){this.$el.attr("data-field","toggle-vis");this.$checkbox.attr(t.DATA_FIELD_VIS,"").attr(t.DATA_FIELD_VIS_SHOW,this.#getShowOnSwitchElementSelector()).attr(t.DATA_FIELD_VIS_HIDE,this.#getHideOnSwitchElementSelector());this.$switch.prepend(this.#defaultVisHiddenInput());this.$el.data("switchableInput",this)}#getShowOnSwitchElementSelector(){return this.isSwapMode?`[${t.DATA_SHOW_ON_SWITCH}]`:t.BODY_SELECTOR}#getHideOnSwitchElementSelector(){return this.isSwapMode?`[${t.DATA_HIDE_ON_SWITCH}]`:""}#defaultVisHiddenInput(){return $('<div class="hidden"></div>').attr(t.DATA_FIELD_VIS_DEFAULT,"").attr(t.DATA_FIELD_VIS_HIDE,this.#getShowOnSwitchElementSelector()).attr(t.DATA_FIELD_VIS_SHOW,this.#getHideOnSwitchElementSelector())}get $switch(){return this.$el.find(".switchable-input__switch")}get $checkbox(){return this.$switch.find('[role="switch"]')}get isSwapMode(){return this.$body.find(`[${t.DATA_SHOW_ON_SWITCH}]`).length>0&&this.$body.find(`[${t.DATA_HIDE_ON_SWITCH}]`).length>0}get $body(){return this.$el.find(t.BODY_SELECTOR)}}_.each(e.find(".switchable-input"),function(e){new i($(e))})});AGN.Lib.CoreInitializer.new("sync",["ace"],function(e){if(!e){e=$(document)}_.each(e.find("[data-sync]"),function(e){var t=$(e),i=$(t.data("sync")),n=t.data("_editor");if(n){n.val(i.val())}else if(t?.prop("type")?.trim()==="checkbox"){t.prop("checked",i.val()==="true")}else{t.val(i.val())}})});(function(){AGN.Lib.CoreInitializer.new("tab-related",function(e){if(!e){e=$(document)}_.each(e.find("[data-tab-related]"),function(e){const t=$(e);const i=$(t.data("tab-related"));i.on("tile:show",()=>t.removeClass("hidden"));i.on("tile:hide",()=>t.addClass("hidden"))})})})();(function(){var t=AGN.Lib.Tab;AGN.Lib.CoreInitializer.new("tab-toggle",function(e){if(!e){e=$(document)}_.each(e.find("[data-toggle-tab]"),function(e){t.init($(e))})})})();(function(){AGN.Lib.CoreInitializer.new("table",function(e){if(!e){e=$(document)}e.all(".fit-content").each(function(){const e=$(this);document.fonts.ready.then(()=>{e.width(s(e)+1)})});e.all(".js-data-table").each(function(){const e=$(this);const n=e.find(".js-data-table-body");const r=e.data("table");if(n.exists()&&r){let e=$("script#"+CSS.escape(r)),t,i;if(e.exists()){t=e.json();if(n.data("web-storage")){i=_.merge(AGN.Lib.WebStorage.get(n.data("web-storage"))||{},t.options||{})}else{i=t.options||{}}new AGN.Lib.Table(n,t.columns,t.data,i).applyFilter()}}});e.all(".table-controls").each(function(){const e=$(this);const t=e.find(".pagination");if(t.exists()){const i=t.find("[data-page]").length;e.addClass(`pages-${i}`)}});e.all("table th:visible").each((e,t)=>i($(t)));e.all(".js-data-table-body").on("table:redraw",e=>{const t=$(e.currentTarget).find(".ag-header-cell");i(t)});function i(e){e.off("mouseenter mouseleave");e.hover(t,n)}function t(e){const t=$(e.currentTarget);const i=t.is(".ag-header-cell")?t.find(".ag-header-cell-text"):t;if(i.length&&i[0].clientWidth<i[0].scrollWidth){const n=r(t);n.show()}}function n(e){AGN.Lib.Tooltip.get($(e.currentTarget))?.hide()}function r(e){const t=AGN.Lib.Tooltip.get(e);if(t){return t}return AGN.Lib.Tooltip.createTip(e,e.text(),"","manual")}e.all(".table-header-dropdown").each(function(){const e=$(this);let t;e.on("show.bs.dropdown",function(){const e=$(window);t=$(this).find(".dropdown-menu");$("body").append(t.css({position:"fixed",left:t.offset().left-e.scrollLeft(),top:t.offset().top-e.scrollLeft()}).detach())});const i=function(){e.append(t.css({position:"absolute",left:false,top:false}).detach())};e.on("hidden.bs.dropdown",i);e.find(".js-dropdown-close").on("click",i)});o(e);$(window).on("displayTypeChanged",()=>o(e))});function o(e){e.all("tr.empty").each(function(){const e=$(this);const t=e.closest("table").find("th:visible").length;e.find("td").attr("colspan",t)})}function s(e){const t='<span class="table-cell-inline-wrapper" style="display: inline-flex">';e.contents().wrapAll(t);let i=e.children()?.first()?.width()||0;e.find(".table-cell-inline-wrapper").contents().unwrap();$(`td:nth-child(${e.index()+1})`).each(function(){const e=$(this);if(e.contents().length>0){e.contents().wrapAll(t);i=Math.max(i,e.find("span").first().width());e.find(".table-cell-inline-wrapper").contents().unwrap()}});return i}})();(function(){const l=AGN.Lib.Popover;function t(e){const t=e.find("[data-view-row]");if(t.length!==1){return}e.data("link",t.attr("href"));if(t.data("view-row")==="page"){e.data("load-page","true");e.wrap(`<a class="table-row-wrapper" href="${t.attr("href")}"></a>`)}else if(t.data("table-modal")){i(t,e)}t.remove()}function i(e,t){const i="data-table-modal";const n="data-table-modal-options";t.attr(i,e.attr(i)).attr(n,e.attr(n))}function n(r){const o=r.find(".js-row-popover");if(o.length!==1||r.closest("table").hasClass("table-preview")){l.remove(r);return}let s=false;let a=null;const e=function(){if(s===false){s=$.Deferred();var e=o.children();if(e.length==0){var t=$("<div></div>");t.css({position:"fixed",visibility:"hidden"});t.html(o.html());e=t.children();$(document.body).append(t);s.done(function(){e.detach();t.remove()})}s.done(function(){a=e});const n=e.find("img").add(e.filter("img")).filter(function(){return this.complete?null:this});if(n.length>0){s.done(function(){const e=l.get(r);if(e){e.setContent();if(r.is(":hover")){r.popover("show")}}});var i=function(){let e=true;for(var t=0;t<n.length;t++){var i=n[t];if(i){if(i.complete){$(i).off("load error");n[t]=null}else{e=false}}}return e};for(let e=0;e<n.length;e++){$(n[e]).on("load error",function(){if(i()){s.resolve()}})}}else{s.resolve()}}return a};l.new(r,{trigger:"hover",delay:{show:300,hide:100},html:true,content:e})}AGN.Lib.CoreInitializer.new("table-row-actions",function(e){if(!e){e=$(document)}e.find(".js-table").each(function(){$(this).find("tr").each(function(){const e=$(this);t(e);n(e)})})})})();(function(){const x={header_readonly:true,filter_readonly:true,condition_readonly:true,operator_readonly:true,value_readonly:true,no_delete:true,no_add_rule:true,no_sortable:true,no_add_group:true};AGN.Lib.DomInitializer.new("target-group-query-builder",function(e){const o=this.config;const i=AGN.Lib.Form.getWrapper(e);const d="#targetgroup-querybuilder";const n=$(d);const s=o.mailTrackingAvailable;const a=o.isTargetGroupLocked;const l=o.helpLanguage;_.each(n,function(e){const t=$(e);const i=C();const n=f(o.queryBuilderFilters,{mail_tracking_available:s});const r=w(JSON.parse(o.queryBuilderRules),a);t.queryBuilder({filters:n,allow_empty:true,operators:i,helpLanguage:l,readonly:a,plugins:{sortable:{inherit_no_drop:true,inherit_no_sortable:true,icon:"icon icon-arrows-alt"}},rules:r});AGN.Lib.CoreInitializer.run("select",t);t.on("afterSetRules.queryBuilder afterUpdateRuleFilter.queryBuilder afterCreateRuleFilters.queryBuilder afterAddRule.querybuilder",function(e){AGN.Lib.CoreInitializer.run("select",$(this))});t.on("link-values-set",function(e){AGN.Lib.CoreInitializer.run("select",$(e.target))});t.on("mailing-values-set values-set ",function(e){AGN.Lib.CoreInitializer.run("select",$(e.target))});t.on("change-date-format",function(e){AGN.Lib.CoreInitializer.run("select",$(e.target))});t.on("enterdown","input",function(e){return false})});const r=function(n,r){r=$.extend({ignore_qb_validation:false,skip_empty:false},r);_.each($(d),function(e){const t=$(e);const i=t.prop("queryBuilder");if(!c(n,i,r,t)){return false}})};n.on("qb:validation",r);i.off().on("validation",r);function c(e,t,i,n){t.clearInitialRuleSettings();if(i.ignore_qb_validation){return true}else if(t.validate({skip_filter_validation:false,skip_empty:i.skip_empty})){n.find("#queryBuilderRules").val(u(t,i.skip_empty));return true}else{n.trigger("qb:invalidrules");e.preventDefault();return false}}function u(e,t){return JSON.stringify(e.getRules({allow_invalid:true,skip_empty:t}))}function h(e,t){if(e.is("select")){AGN.Lib.Select.get(e).selectValueOrSelectFirst(t)}else{e.val(t)}}function f(e,t){if(e===null){e=[{id:"?",label:"?",type:"string"}]}else{const i={};e=e.filter(function(e){if(i[e.id]){return false}i[e.id]=true;return true})}g(e,t);return $.extend([],e)}function p(e){if(e){e.flags=x;_.each(e.rules,function(e){e.flags=x;if(e.hasOwnProperty("condition")){p(e)}})}return e}function g(e,i){i=$.extend({mail_tracking_available:false},i);const n=function(e){return $(`
          <div class="qb-select-container">
            <select id="${e.id}" class="form-control mailings js-select" data-select-options="dropdownAutoWidth: true"></select>
          </div>
        `)};const r=function(e){const t=$('<select class="form-control auto-imports js-select"></select>');t.attr("id",e.id);return t};const o=function(e){return e.$el.find(".mailings :selected").val()};const s=function(e){return e.$el.find(".auto-imports :selected").val()};const a=function(r){const o={},s={},a=-1;$(d).on("values-set",r,function(e){if($.isEmptyObject(s)){h($(e.target),a)}else{const t=$(e.target).attr("id"),i=s[t],n=i?i.$el.find(r):$(e.target);h(n,o[t]||a)}});return function(e,t){const i=e.$el.find(r);o[e.id]=t;s[e.id]=e;h(i,t)}};const l=a("select.mailings");const c=a("select.auto-imports");const u={"finished auto-import":{type:"string",input_event:"values-setup-finished",input:r,values:function(e){v(e).done(function(){e.trigger("values-setup-finished")})},valueSetter:c,valueGetter:s,canBeNegated:true,skipOperator:true},"received mailing":{type:"string",input_event:"values-setup-finished",input:n,values:function(e){const t=e.find("select.mailings");m(t).done(()=>t.trigger("values-setup-finished"))},valueSetter:l,valueGetter:o,canBeNegated:true,skipOperator:true},"opened mailing":{type:"string",input_event:"values-setup-finished",input:n,values:function(e){const t=e.find("select.mailings");m(t).done(()=>t.trigger("values-setup-finished"))},valueSetter:l,valueGetter:o,canBeNegated:i.mail_tracking_available,skipOperator:true},"clicked in mailing":{type:"string",input_event:"values-setup-finished",valueSelector:function(e,t){const i=["mailingID","linkID"];return e+"_"+i[t]},input:function(e){return $(`
             <div class="qb-select-container">
               <select id="${e.filter.valueSelector(e.id,0)}" class="form-control js-select mailings" data-rule-id="${e.id}" data-select-options="dropdownAutoWidth: true"></select>
             </div>
             <label class="form-label d-flex align-items-center">Links</label>
             <div class="qb-select-container">
               <select id="${e.filter.valueSelector(e.id,1)}" class="form-control js-select links" data-rule-id="${e.id}" data-select-options="dropdownAutoWidth: true"></select>
             </div>
            `)},values:function(o){const i=o.find("select.mailings");const n=AGN.Lib.Select.get(i);i.change(function(){const e=n.getSelectedValue();b(e,function(e){const i=o.find("select.links");const n=AGN.Lib.Select.get(i);const r=[{id:-1,text:t("querybuilder.common.anyLink")}];$.each(e,function(e,t){r.push({id:t.id,text:t.url})});n.setOptions(r);i.trigger("link-values-set")})});m(i,function(e){const t=[];e.forEach(function(e){t.push({id:e.mailingID,text:e.shortname})});n.setOptions(t);i.trigger("mailing-values-set")})},valueGetter:function(e){const t=0,i=1,n=[];n[t]=e.$el.find("#"+e.filter.valueSelector(e.id,t)).val();n[i]=e.$el.find("#"+e.filter.valueSelector(e.id,i)).val();return n},valueSetter:function(){const o=0,r=1,s={},a={};const e=function(e,t){s[e.id]=t;a[e.id]=e};$(d).on("mailing-values-set",function(e){let t=$(e.target),i=t.data("rule-id"),n=a[i],r;if(n){r=n.$el.find("select.mailings");h(r,s[i][o]);r.trigger("change")}else{h(t);t.trigger("change")}});$(d).on("link-values-set",function(e){let t=$(e.target).data("rule-id"),i=a[t],n;if(i){n=i.$el.find("select.links");h(n,s[t][r]||-1)}else{n=$(e.target);h(n)}n.trigger("values-setup-finished")});return e}(),validation:{callback:function(e){return e.every(function(e){return e})||["string_empty"]}},canBeNegated:i.mail_tracking_available,skipOperator:true},"revenue by mailing":{type:"string",input_event:"values-setup-finished",input:n,values:function(e){const t=e.find("select.mailings");m(t).done(()=>t.trigger("values-setup-finished"))},valueSetter:l,valueGetter:o,canBeNegated:i.mail_tracking_available,skipOperator:true}};if(!i.mail_tracking_available){delete u["received mailing"]}e.forEach(function(e){const t=u[e.id];if(t){$.extend(e,t)}})}function m(n,e){const t=e||function(e){const t=AGN.Lib.Select.get(n);const i=[];e.forEach(e=>i.push({id:e.mailingID,text:e.shortname}));t.setOptions(i);n.trigger("values-set")};return $.ajax({type:"GET",url:AGN.url("/workflow/getAllMailingSorted.action"),data:{sortField:"date",sortDirection:"desc"},success:t})}function v(t,e){const i=e||function(e){e.forEach(function(e){t.append($("<option>",{text:e.shortname,value:e.autoImportId}))});t.trigger("values-set")};return $.ajax({type:"POST",url:AGN.url("/autoimport.do"),data:{method:"listJson"},success:i})}function y(e,i){e.forEach(function(e){const t=$("<option>");t.text(e.shortname);t.val(e.mailingID);i.append(t)})}function b(e,t){$.ajax({type:"POST",url:AGN.url("/workflow/getMailingLinks.action"),data:{mailingId:e},success:t})}function w(e,t){if(t){e=p(e)}return $.extend({},e)}function C(){return[{type:"equal",apply_to:["string","number","datetime"]},{type:"not_equal",apply_to:["string","number","datetime"]},{type:"less",apply_to:["string","number"]},{type:"less_or_equal",apply_to:["string","number"]},{type:"greater",apply_to:["string","number"]},{type:"greater_or_equal",apply_to:["string","number"]},{type:"like",nb_inputs:1,apply_to:["string"]},{type:"not_like",nb_inputs:1,apply_to:["string"]},{type:"contains",nb_inputs:1,apply_to:["string"]},{type:"not_contains",nb_inputs:1,apply_to:["string"]},{type:"begins_with",nb_inputs:1,apply_to:["string"]},{type:"not_begins_with",nb_inputs:1,apply_to:["string"]},{type:"mod",nb_inputs:1,apply_to:["number"],valueSelectors:["#first","#operator select","#second"],valueGetter:function(t){const i=[];t.operator.valueSelectors.forEach(function(e){i.push(t.$el.find(e).val())});return i},valueSetter:function(i,n){i.operator.valueSelectors.forEach(function(e,t){i.$el.find(e).val(n[t])})},input:function(e){const t=this.operators.filter(function(e){return e.type!=="mod"&&e.apply_to.includes("number")});const i=this.getRuleOperatorSelect(e,t);return""+"<div class='qb-input-element'>"+"<input class='form-control' id='first' type='number'/>"+"</div>"+"<div class='qb-input-element' id='operator'>"+i+"</div>"+"<div class='qb-input-element'>"+"<input class='form-control' id='second' type='number'/>"+"</div>"},validate:function(e){return e.every(function(e){return e})||["string_empty"]}},{type:"is_empty",nb_inputs:0,apply_to:["string","number","datetime"]},{type:"is_not_empty",nb_inputs:0,apply_to:["string","number","datetime"]},{type:"before",nb_inputs:1,apply_to:["datetime"]},{type:"after",nb_inputs:1,apply_to:["datetime"]}]}})})();AGN.Lib.Controller.new("targets-list",function(){this.addAction({change:"check-favorites"},function(){AGN.Lib.Loader.prevent();$.ajax({type:"GET",url:AGN.url(e(this.el))})});function e(e){var t=e.data("target-id");var i=e.is(":checked");return"/target/"+t+"/"+(i?"addToFavorites":"removeFromFavorites")+".action"}this.addAction({change:"check-admin-favorites"},function(){AGN.Lib.Loader.prevent();const e=this.el.data("target-id");const t=this.el.is(":checked");$.ajax({type:t?"POST":"DELETE",url:AGN.url("/target/"+e+"/favorite.action")})})});AGN.Lib.CoreInitializer.new("template",function(e){if(!e){e=$(document)}e.find('script[type="text/x-mustache-template"]').each(function(){var e=$(this);var t=e.attr("id");if(t){AGN.Opt.Templates[t]=e.html()}})});(function(){var t=AGN.Lib.Tile;AGN.Lib.CoreInitializer.new("tile-toggle",function(e){if(!e){e=$(document)}_.each(e.find("[data-toggle-tile]"),function(e){t.init($(e))})})})();AGN.Lib.CoreInitializer.new("tooltip",function(e=$(document)){const t=AGN.Lib.Tooltip;const i=AGN.Lib.HelpTooltip;$(".tooltip").remove();e.find("[data-tooltip]").each(function(){const e=$(this);t.create(e,t.options(e))});e.all("[data-tooltip-help]").each((e,t)=>new i($(t)))});AGN.Lib.CoreInitializer.new("trackable-link-extensions",function(e=$(document)){const i=AGN.Lib.InputTable;class n extends i{constructor(e){super(e)}get rowTemplate(){return`
        <tr>
            <td><input type="text" class="form-control" data-name="name" value="{{- name }}" placeholder="${t("defaults.name")}" ${this.readonly?"disabled":""}></td>
            <td><input type="text" class="form-control" data-name="value" value="{{- value }}" placeholder="${t("defaults.value")}" ${this.readonly?"disabled":""}></td>
        </tr>
      `}addActions(){super.addActions();AGN.Lib.Action.new({click:"[data-delete-all-extensions]"},this.clean.bind(this),this.$container);AGN.Lib.Action.new({click:"[data-add-default-extensions]"},this.addDefaultExtensions.bind(this),this.$container)}addDefaultExtensions(){const e=this.$table.find("tr:last");if(this.isEmptyRow$(e)){e.remove()}_.each(this.config.defaultExtensions,e=>this.addRow(e));this.addEmptyRow()}}_.each(e.find("[data-trackable-link-extensions]"),function(e){new n($(e))})});AGN.Lib.CoreInitializer.new("truncated-text-popover",["table"],function(e=$(document)){const o=400;const s=AGN.Lib.Popover;const a=AGN.Lib.Helpers;document.fonts.ready.then(()=>{e.find(".js-truncated-text-popover, td").each((e,t)=>i(t))});function i(e){const t=$(e);if(!l(e)){s.remove(t);return}const i=t.closest("td");const n=i.length>0;const r=n?i:t;s.getOrCreate(r,{delay:{show:o,hide:50},content:$(a.retrieveTextElement(r[0])).text()})}function l(e){return $(e).is(":truncated")||$(e).is("td")&&a.containsTruncatedElements(e)}});AGN.Lib.DomInitializer.new("upload",function(t){const e=AGN.Lib.Upload;const i=u(t);const n=u(t,true);const r=(i.exists()?i:t).find("[data-upload]");if(!r.exists()&&!i.exists()){return}let o=e.get(i,r);if(!o){o=new e(i,r)}if(n.exists()){new e(n,n.find("[data-upload]"),o)}const s=r.data("upload")||"";const a=s.includes("[]");const l=AGN.Lib.Form.get(t);const c=l.get$();if(c.exists()){const v=p();const y=AGN.Lib.Template.prepare(v.data("upload-progress-template")||"progress");g(c);c.on("form:loadershow",()=>{v.html(y({currentProgress:true}));v.show()});c.on("form:loaderhide",()=>v.hide());c.on("form:submit",()=>{});c.on("submitted",d);c.on("form:abort",()=>{if(m().length){h()}});c.on("form:progress",(e,t)=>{v.html(y({currentProgress:t.progress}))});i.on("upload:reset",d);i.on("upload:dropped",()=>{h();g(c);if(i.data("upload-dropzone")==="submit"){i.hide();l.submit()}});t.on("click","a[data-upload-reset], button[data-upload-reset]",d)}function u(e,t=false){if(t){return e.find('[data-upload-dropzone="extra"]').first()}const i=$(e.data("linked-dropzone"));return i.length?i:e.find("[data-upload-dropzone]").first()}function d(){if(a){m().forEach((e,t)=>{l.setValueOnce(f(t),undefined)})}else{l.setValueOnce(s,undefined)}o.reset();g(c);i.show()}function h(){const e=m();if(a){e.forEach((e,t)=>{l.setValueOnce(f(t),e)})}else{l.setValueOnce(s,e)}l.get$().trigger("upload:filesSet",[e])}function f(e){return s.replace("[]",`[${e}]`)}function p(){const e=i.nextAll("[data-upload-progress]").first();return e.length?e:t.find("[data-upload-progress]")}function g(e){t.data("upload-selection",m())}function m(){return o?o.getSelection():[]}});AGN.Lib.DomInitializer.new("web-storage-persist",function(){if(this.config){$.each(this.config,function(e,t){var i="web-storage#"+$.trim(e);var n=null;try{n=AGN.Lib.Storage.get(i)}catch(e){console.error(e)}if(n!=null){AGN.Lib.Storage.set(i,$.extend(n,t))}else{AGN.Lib.Storage.set(i,t)}})}});AGN.Lib.DomInitializer.new("workflow-pause-timer",function(){const i=this.config.workflowId;const e=this.config.pauseTime;const n=this.config.defaultExpirationHours;const r=this.config.expirationHours>0?this.config.expirationHours:n;const o=r*60*60*1e3;const s=$("#workflow-pause-timer-text");const a=setInterval(function(){l()},1e3);l();function l(){s.html(u())}function c(){return o-(Date.now()-e)}function u(){const e=c();if(e<=0){if(a){clearInterval(a)}d();return'<i class="icon icon-refresh icon-spin"></i> '+t("workflow.activating.auto")}const i=new Date(e);return(i.getHours()>0?d3.format("01")(i.getUTCHours())+":":"")+(i.getMinutes()>0?d3.format("02")(i.getUTCMinutes())+":":"00:")+(i.getSeconds()>0?d3.format("02")(i.getUTCSeconds()):"00")}function d(){return $.post(AGN.url("/workflow/"+i+"/autoUnpause.action")).done(function(e){if(e.success===true){AGN.Lib.Page.reload(AGN.url("/workflow/"+i+"/view.action"))}else{AGN.Lib.JsonMessages(e.popups)}}).fail(function(){AGN.Lib.Messages(t("Error"),t("defaults.error"),"alert")})}return false});(function(){var i=AGN.Lib.Loader,e=AGN.Lib.Template,c=AGN.Lib.Page,n=AGN.Lib.CSRF;var u={initialize:function(e){if(e.loader===true||e.loader===undefined){e.loader={show:function(){i.show()},hide:function(){i.hide()}}}},show:function(e){var t=e.loader;if(t&&t.show){try{t.show()}catch(e){console.error(e)}}},hide:function(e){var t=e.loader;if(t&&t.hide){try{t.hide()}catch(e){console.error(e)}}}};$.ajaxPrefilter(function(e){u.initialize(e)});$(document).ajaxSend(function(e,t,i){u.show(i);n.setTokenToReqHeader(t,i.type)});$(document).ajaxComplete(function(e,t,i){u.hide(i);n.updateTokenInDOM()});$(document).ajaxError(function(i,n,e){u.hide(e);if(n.readyState==0||n.status==0){return}if(e.statusCode&&n.status in e.statusCode){return}var r;if(n.status==401){var o=$.Event("ajax:unauthorized");$(document).trigger(o);if(!o.isDefaultPrevented()&&n.responseText){c.render(n.responseText)}}else if(n.status==403){if(n.responseText){const s=$(n.responseText);const a=s.filter("#csrf-error-message");if(a.exists()){AGN.Lib.Modal.create(_.template(a.html())({}),{});return}}AGN.Lib.Modal.fromTemplate("permission-denied",{title:t("messages.permission.denied.title"),text:t("messages.permission.denied.text"),btn:t("defaults.ok")})}else{let e=true;if(n.responseText){try{const s=$(n.responseText);const l=s.all("[data-message]");if(l.exists()){c.render(n.responseText);e=false}}catch(i){console.debug(i)}}if(e){AGN.Lib.Modal.fromTemplate("error",{headline:t("messages.error.headline"),text:t("messages.error.text"),reload:t("messages.error.reload")})}}});$(document).on("click","a[data-ajax], a.js-ajax",function(e){var t=$(this);e.preventDefault();c.reload(t.attr("href"),true,t.data("ajax"))});$(document).on("click","[data-prevent-load]",function(){i.prevent()});window.onbeforeunload=function(){i.show()}})();(function(){var e=AGN.Lib.Action;e.new({click:"[data-clone]"},function(){var e=this.el.data("clone"),t=this.el.data("clone-target"),i=parseInt(this.el.data("clone-count")),n,r;i+=1;this.el.data("clone-count",i);n=AGN.Lib.Template.text(e,{count:i});r=$(t).append(n);AGN.runAll(r)});$(document).on("click","a[data-clone]",function(e){e.preventDefault()})})();(function(){var o=AGN.Lib.Form,s=AGN.Lib.Confirm,e=AGN.Lib.Action,n=AGN.Lib.Page;e.new({click:"[data-confirm], .js-confirm"},function(){var e;e=$.get(this.el.attr("href"));e.done(function(e){var t=$(e),i;i=t.filter(".modal").add(t.find(".modal"));if(i.length!=1){n.render(e);return}s.create(e).done(function(e){n.render(e)})});this.event.preventDefault()});$(document).on("click","[data-confirm-positive], .js-confirm-positive",function(){var e=$(this),t=s.get(e),i=o.getWrapper(e);if(t){var n=t.$modal.find('[name="confirm-save-choice"]');if(i.exists()){const r=o.get(i);if(e.is("[data-url]")){r.setActionOnce(e.data("url"))}r.jqxhr().done(function(e){t.positive(e)})}else{if(n.exists()){t.positive({code:e.data("confirm-positive"),saveChoice:n[0].checked})}else{t.positive(e.data("confirm-positive"))}}}});$(document).on("click","[data-confirm-negative], .js-confirm-negative",function(){var e=$(this),t=s.get(e);if(t){var i=t.$modal.find('[name="confirm-save-choice"]');if(i.exists()){t.negative({code:e.data("confirm-negative"),saveChoice:i[0].checked})}else{t.negative(e.data("confirm-negative"))}}})})();(function(){var e=AGN.Lib.Action,r=AGN.Lib.Clipboard,s=AGN.Lib.Tooltip;e.new({click:"[data-copyable]"},function(){var e=undefined;if(this.el.is("[data-copyable-value]")){e=this.el.data("copyable-value")}else{var i=this.el.data("copyable-target");var n;if(i){n=$(i)}else{n=this.el}if(n.exists()){e=n.val()}}if(e!==undefined){var o=this.el;r.set(e,function(e,i){if(i){s.create(o,{title:t("clipboard.copied.tooltip"),trigger:"manual"});s.setShown(o);var n=o.data("tooltip-timeout-id");if(n){clearTimeout(n)}var r=setTimeout(function(){s.remove(o);o.removeData("tooltip-timeout-id")},2500);o.data("tooltip-timeout-id",r)}})}})})();(function(){var a=AGN.Lib.Table,o=AGN.Lib.WebStorage;$(document).on("click",".js-data-table-first-page",function(e){a.get($(this)).api.paginationGoToFirstPage()});$(document).on("click",".js-data-table-prev-page",function(e){a.get($(this)).api.paginationGoToPreviousPage()});$(document).on("click",".js-data-table-page",function(e){a.get($(this)).api.paginationGoToPage($(this).data("page"))});$(document).on("click",".js-data-table-next-page",function(e){a.get($(this)).api.paginationGoToNextPage()});$(document).on("click",".js-data-table-last-page",function(e){a.get($(this)).api.paginationGoToLastPage()});$(document).on("change",".js-data-table [name='numberOfRows']",function(e){var t=$(this);var i=t.val();var n=a.get(t).api;n.paginationSetPageSize(i);var r=t.closest(".js-data-table-body").data("web-storage");if(r){o.extend(r,{paginationPageSize:parseInt(i)})}});$(window).on("viewportChanged",function(e){$(document).all(".js-data-table-body").each(function(){AGN.Lib.Table.get($(this)).redraw()})});$(document).on("click",".js-data-table-bulk-delete",function(e){var t=$(this);i(t,false)});function i(e){const t=e.data("bulk-field")||"id";const i=e.data("bulk-request-field")||"bulkIds";const n=a.get(e).api;const r=n.getSelectedRows();const o=r.map(e=>e[t]);const s={};s[i]=o;l(o,e.data("bulk-url"),s).done(()=>n.applyTransaction({remove:r}))}function l(e,t,i){const n=$.Deferred();if(e&&e.length){const r=$.ajax(t,{method:"GET",traditional:true,data:i}).fail(()=>{n.reject()});AGN.Lib.Confirm.request(r).then(n.resolve,n.reject)}else{n.reject();AGN.Lib.Messages.alert("messages.error.nothing_selected")}return n.promise()}})();$(document).ready(function(){window.AGN.Lib.Controller.init();window.AGN.runAll()});(function(){$(document).on("dragster:enter",function(e){var t=$(e.target);if(!t.is("[data-upload-dropzone]")){t.addClass("drag-over")}});$(document).on("dragster:leave",function(e){var t=$(e.target);if(!t.is("[data-upload-dropzone]")){t.removeClass("drag-over")}})})();(function(){const i=AGN.Lib.EditableView;const e=AGN.Lib.Action;e.new({click:"[data-edit-view]"},function(){const e=$(`[data-editable-view="${this.el.data("edit-view")}"]`);const t=i.get(e);if(t.isInEditMode()){t.applyChanges()}else{t.enableEditMode()}});e.new({click:"[data-edit-tile-visibility]"},function(){i.get(this.el).toggleState(this.el)})})();$(document).on("click",".js-close-error",function(e){if(!$(e.target).hasClass("js-close-error")){return}$(this).closest(".backdrop").remove()});(function(){var e=AGN.Lib.Action,r=AGN.Lib.Form,o=AGN.Lib.Confirm,t=AGN.Lib.Helpers;e.new({click:"[data-form-change]",change:"select[data-form-change]"},function(){r.get(this.el).setValueOnce("numberOfRowsChanged",true)});e.new({click:"[data-form-bulk]"},function(){const e=this.el.data("form-bulk");const t=this.el.prop("checked");r.get(this.el).bulkUpdate(e,t)});e.new({click:"a[data-form-set], button[data-form-set]",change:"select[data-form-set], input[data-form-set]"},function(){var e=t.objFromString(this.el.data("form-set")),i=r.get(this.el);_.forEach(e,function(e,t){i.setValueOnce(t,e)})});e.new({click:"a[data-form-url], button[data-form-url]",change:"select[data-form-url], input[data-form-url]"},function(){r.get(this.el).setActionOnce(this.el.data("form-url"))});e.new({click:"a[data-form-resource], button[data-form-resource]",change:"select[data-form-resource], input[data-form-resource]"},function(){var e=r.get(this.el);if(e instanceof AGN.Lib.ResourceForm){e.setResourceSelectorOnce(this.el.data("form-resource"))}});e.new({click:"a[data-form-clear], button[data-form-clear]"},function(){const e=this.el.data("form-clear");if(!e){r.get(this.el).clear();return}i($(e));this.el.trigger("apply-filter")});function i(e){e.find(":input, select").val("").trigger("change");e.find(":checkbox, :radio").prop("checked",false);AGN.Lib.CoreInitializer.run("select",e)}e.new({click:"a[data-form-persist], button[data-form-persist]",change:"select[data-form-persist], input[data-form-persist]"},function(){var e=t.objFromString(this.el.data("form-persist")),i=r.get(this.el);_.forEach(e,function(e,t){i.setValue(t,e)})});e.new({click:"a[data-form-reset], button[data-form-reset]"},function(){r.get(this.el).reset()});e.new({click:"a[data-form-abort], button[data-form-abort]"},function(){r.get(this.el).abort()});e.new({click:"[data-form-confirm]"},function(){var e=this.el.data("form-confirm"),n=r.get(this.el),t;t=n.submit("confirm",e);t.done(function(e){var t=$(e),i;i=t.filter(".modal").add(t.find(".modal"));if(i.length!=1){n.updateHtml(e);return}o.create(e).done(function(e){n.updateHtml(e)}).fail(n.revertAction)})});e.new({click:"a[data-form-action], button[data-form-action]",change:"select[data-form-action], input[data-form-action]"},function(){var e=this.el.data("form-action"),t=r.get(this.el),i;setTimeout(function(){i=t.submit("action",e)},5)});e.new({click:"a[data-form-submit], button[data-form-submit]",change:"select[data-form-submit], input[data-form-submit]"},function(){var e=this;setTimeout(function(){r.get(e.el).submit()},5)});e.new({click:"a[data-form-submit-static], button[data-form-submit-static]",change:"select[data-form-submit-static], input[data-form-submit-static]"},function(){var e=this;setTimeout(function(){r.get(e.el).submit("static")},5)});e.new({click:"a[data-form-submit-event], button[data-form-submit-event]",change:"select[data-form-submit-event], input[data-form-submit-event]"},function(){var e=this;setTimeout(function(){r.get(e.el).submit("event")},5)});e.new({submit:"[data-form]"},function(){var e=this;if(this.el.data("form")!="static"){this.event.preventDefault();setTimeout(function(){r.get(e.el).submit()},5)}});function n(e){var t=e.keyCode||e.which;if(t===13){return true}if(t===229&&e.originalEvent){var i=e.originalEvent.code;if(i==="Enter"||i==="NumpadEnter"){return true}}return false}e.new({keydown:'input[type="text"], input[type="password"], input[type="number"]'},function(){if(n(this.event)){var e=$.Event("enterdown");this.el.trigger(e);if(e.isDefaultPrevented()){return}var t=this.el.parents("form");if(t.exists()){if(t.is("[data-form]")){var i=r.get(t);if(t.is("[data-action]")){i.submit("event")}else{i.submit()}}else{t.submit()}}}})})();(function(){var t=AGN.Lib.Help;$(document).on("click","[data-help]",function(e){t.show($(this));e.preventDefault()})})();(function(){$(document).on("click","label",function(e){if($(e.target).is("[data-help]")){return}const t=$(this);const i=$(`#${t.attr("for")}`);const n=i.data("select2");if(i.length==1&&n){setTimeout(()=>{if(!n.isOpen()){n.open()}},0)}})})();(function(){var n=window.history;$(document).on("click",'a[href^="#"]',function(e){if(e.isDefaultPrevented()){return}e.preventDefault();t($(this).attr("href"))});$(document).on("click","[data-one-time]",function(){var e=$(this);setTimeout(function(){e.attr("disabled","disabled");if(e.is("a")){e.removeAttr("href")}},1)});function t(e){if(e==="#"){return}var t=window.location.href;var i=t.indexOf("#");if(i>=0){t=t.substring(0,i)}n.replaceState(n.state||{},document.title,t+e)}})();(function(){var e=AGN.Lib.Action,r=AGN.Lib.Messages;e.new({click:"[data-msg]"},function(){var e=this.el.data("msg"),t=this.el.data("msg-content"),i=this.el.data("msg-type");if(this.el.data("msg-system")==="system"){var n=$(document);if(n.find(".notification-info").is(":visible")){return false}else{r(e,t,i)}}else{r(e,t,i)}});$(document).on("click","a[data-msg]",function(e){e.preventDefault()})})();(function(){var e=AGN.Lib.Action,i=AGN.Lib.Modal,n=AGN.Lib.Helpers;e.new({click:"[data-modal]"},function(){const e=this.el.data("modal");let t=this.el.data("modal-set");t=typeof t==="object"?t:n.objFromString(t);i.fromTemplate(e,t)});$(document).on("hidden.bs.modal",".modal",function(){var e=$(this);e.trigger("modal:close");setTimeout(function(){e.remove()},100)});$(document).on("shown.bs.modal",".modal",function(){const e=$(".modal.show");if(e.length>1){t(e.last())}});function t(e){$(".modal-backdrop.show").last().css("z-index",e.css("z-index"))}})();(function(){var e=AGN.Lib.Action;e.new({click:"[data-password]"},function(){var e=this.el.data("password"),t=this.el.data("password-toggle"),i=$(e);this.el.data("password-toggle",this.el.text());this.el.text(t);if(i.prop("type")==="password"){i.prop("type","text")}else{i.prop("type","password")}this.event.preventDefault()})})();(function(){$(document).on("click",".date-picker-container",function(){const e=$(this).find(".js-datepicker");if(!e.prop("disabled")&&!e.datepicker("widget").is(":visible")){e.datepicker("show")}})})();(function(){$(document).on("click",'[data-dismiss="popover"]',function(){var e=AGN.Lib.Popover.get($(this));if(e){e.hide()}})})();(function(){var e=AGN.Lib.Action,t=AGN.Lib.Modal,i=AGN.Lib.Helpers;e.new({click:"[data-popup]"},function(){var e=this.el.data("popup"),t=window.location.href,i=t.substring(0,t.lastIndexOf("/"));if(!e||e.indexOf("://")<=0){e=i+"/"+e}window.open(e,"help","width=800,height=600,left=0,top=0,scrollbars=yes")});$(document).on("click","a[data-modal]",function(e){e.preventDefault()});$(document).on("hidden.bs.modal",".modal",function(){var e=$(this);e.trigger("modal:close");setTimeout(function(){e.remove()},100)})})();(()=>{AGN.Lib.Action.new({change:"[data-preview-table]"},function(){AGN.Lib.PreviewTable.toggle(this.el);AGN.Lib.CoreInitializer.run(["table-row-actions","scrollable","truncated-text-popover"],this.el.closest(".tile"))})})();(function(){const e=$(window);const t={DESKTOP:1,MOBILE:2};let i;let n;const r=function(){if(i){clearTimeout(i)}i=setTimeout(function(){AGN.Lib.CoreInitializer.run(["scrollable","truncated-text-popover"]);_.each(AGN.Lib.Editor.all(),function(e){e.resize()});e.trigger("viewportChanged")},500);if(o()){e.trigger("displayTypeChanged",[n===t.MOBILE])}};function o(){const e=n;n=AGN.Lib.Helpers.isMobileView()?t.MOBILE:t.DESKTOP;return e!==n}e.on("resize",r)})();(function(){const i=AGN.Lib.Helpers;AGN.Lib.Action.new({click:"[data-support-type]"},function(){const e=this.el.data("support-type");const t=i.objFromString(this.el.data("support-options"));i.openHelpModal("support",{type:e,opts:t})})})();(function(){var e=AGN.Lib.Action;var c=AGN.Lib.FormBuilder.FormBuilder;e.new({"click change":"[data-sync-from]"},function(){var e=this.el.data("sync-from").split(/,\s?/),l=this.el.data("sync-to").split(/,\s?/);_.each(e,function(e,t){var i=$(e),n=$(l[t]),r=i.val(),o=n.attr("id"),s=n.data("_editor"),a=n.data("select2");if(window.CKEDITOR&&CKEDITOR.instances[o]){CKEDITOR.instances[o].setData(r)}else if(s){s.val(r)}else if(a){n.select2("val",r)}else if(c.isCreated("#"+o)){c.get("#"+o).setJson(c.get(e).getJson())}else if(i?.prop("type")?.trim()==="checkbox"){n.val(i.prop("checked"))}else{n.val(r)}})});$(document).on("click","a[data-sync-from]",function(e){e.preventDefault()})})();(function(){const o=AGN.Lib.Tile;const s=AGN.Lib.Tab;const a=AGN.Lib.Form;$(document).on("click","[data-toggle-tab]",function(e){const t=$(this);const i=o.trigger(t);const n=t.data("toggle-tab-method")||"show";if(t.is("[data-form-submit]")){const r=a.getWrapper(t);if(r.exists()&&!a.get(r).valid()){e.preventDefault();return false}}o.show(i);s[n](t);AGN.Lib.Scrollbar.get(t)?.update();e.preventDefault();return false})})();(function(){const a=AGN.Lib.Helpers;const o=AGN.Lib.Confirm;const l=AGN.Lib.Form;const c=AGN.Lib.Page;$(document).on("click",".js-table a, .js-table input, .js-table select, .js-table .select2, .js-table button, .js-table .js-checkable, .js-table .disabled",function(e){e.preventViewLoad=true});$(document).on("click",".js-table-sort",function(e){var t=$(this),i=t.children("a"),n=$(e.target),r=i.attr("href");if(n[0]!=i[0]){return}if(l.getWrapper(t).exists()){var o=l.get(t);var s=a.paramsFromUrl(r);_.each(s,function(e,t){o.setValue(t,e)});o.submit()}else{$.get(r).done(function(e){c.render(e,false)})}e.preventDefault()});$(document).on("click",'.js-table-sort input[type="checkbox"]',function(e){const t=$(this);const i=t.is(":checked");e.preventDefault();window.setTimeout(()=>t.prop("checked",i).trigger("change"),0)});$(document).on("click",".js-table-paginate",function(e){var t=$(this),i=t.attr("href"),n=l.get(t),r=a.paramsFromUrl(i);_.each(r,function(e,t){n.setValue(t,e)});n.submit();e.preventDefault();var o=t.closest(".tile");if(o.exists()){var s=o.offset().top;if(window.scrollY>s){window.scrollTo(0,s-150)}}else{window.scrollTo(0,0)}});function n(e,t){const n=l.get(e);const i=$.get(t);i.done(function(e){const t=$(e);const i=t.filter(".modal").add(t.find(".modal"));if(i.length!=1){n.updateHtml(e);return}o.create(e).done(function(e){n.updateHtml(e)})})}$(document).on("click",".js-row-delete",function(e){var n=$(this),t=n.is("button")?n.data("url"):n.attr("href"),r=l.get(n),i;if(t){i=$.get(t);i.done(function(e){var t=$(e),i;i=t.filter(".modal").add(t.find(".modal"));if(i.length!=1){r.updateHtml(e);return}o.create(e).done(function(e){n.closest("tr").remove();r.updateHtml(e)})})}e.preventDefault()});$(document).on("click",".js-table tr",function(e){if(e.preventViewLoad||AGN.Lib.Helpers.isMobileView()){return}const t=$(this);if(t.data("table-modal")){r(t);return}const i=t.data("link");if(typeof i!=="undefined"){if(t.data("load-page")){window.location.href=i}else{n(t,i)}}});function r(e){const t=e.data("table-modal");let i=e.data("table-modal-options");i=typeof i==="object"?i:a.objFromString(i);AGN.Lib.Modal.fromTemplate(t,i)}$(document).on("click",'.js-checkable input[type="checkbox"], .js-checkable input[type="radio"]',function(e){const t=$(this);const i=t.is(":checked");e.preventDefault();window.setTimeout(()=>t.prop("checked",i),0)});$(document).on("click",".js-checkable",function(e){e.preventDefault();var t=$(this),i,n;i=t.find('input[type="checkbox"], input[type="radio"]');if(i.length){_.each(i,function(e){n=$(e);if(!n.prop("disabled")){n.prop("checked",!n.prop("checked"));n.trigger("change")}})}});$(document).on("click",".disabled",function(e){e.preventDefault()})})();(function(){var r=AGN.Lib.Tile;function n(e){const t=".tile-header .tile-title";return $(e).is(t)||$(e).closest(t).length}function o(e){const t=".tile-header .tile-controls";return $(e).is(t)||$(e).closest(t).length}$(document).on("click","[data-toggle-tile] > .tile-header",function(e){const t=$(this).closest(".tile");const i=AGN.Lib.Helpers.isMobileView();if(t.data("toggle-tile")==="mobile"&&!i){return}if(i&&!o(e.target)||n(e.target)){r.toggle(t);AGN.Lib.Scrollbar.get(t)?.update();return}e.preventDefault()});$(document).on("click","[data-toggle-tile-all]",function(i){var n=$(this).data("toggle-tile-all");_.each($("[data-toggle-tile]"),function(e){var t=$(e);if(n=="expand"){r.show(t)}else{r.hide(t)}i.preventDefault()})})})();(function(){$(document).on("change","[data-toggle-usability]",function(){var e=$(this),t=e.data("toggle-usability"),i=$(document).find(t);_.each(i,function(e){var t=$(e);if(t.prop("disabled")){t.prop("disabled",false)}else{t.prop("disabled",true)}})})})();(function(){var i=AGN.Lib.Tooltip;$(window).on("load",function(){var e=$("body");if(AGN.isIE){e.on("DOMNodeInserted","[data-tooltip], [data-tooltip-help]",function(e){var t=$(e.target);i.create(t,i.options(t))})}else{e.on("DOMNodeInserted",function(e){$(e.target).all("[data-tooltip], [data-tooltip-help]").each(function(){var e=$(this);i.create(e,i.options(e))})})}})})();(function(){AGN.Lib.Action.new({click:"[data-upload-reset]"},function(){const e=$(this.el.data("linked-dropzone"));if(e.length){e.trigger("upload:reset")}})})();(function(){var o=AGN.Lib.Form,t=AGN.Lib.Editor;$(document).on("tile:show",function(e){var t=$(e.target);var i=t.find(".js-wysiwyg");var n=i.attr("id");if(i.length===1){var r=l(i);window.createEditorExt(n,r.width,r.height,r.browseMailingId,r.isFullHtml,r.isFullHeight,r.allowExternalScript);if(r.isFullHeight){CKEDITOR.instances[n].on("instanceReady",s(i))}}});$(document).on("tile:hide modal:close",function(e){$(e.target).find(".js-wysiwyg").each(function(){if(CKEDITOR.instances[$(this).attr("id")]){CKEDITOR.instances[$(this).attr("id")].updateElement()}if(n($(this))){$(window).off("resize."+a($(this)))}t.get($(this)).val($(this).val());window.removeEditor($(this).attr("id"))})});$(document).on("form:submit",function(e){var t=$(e.target).find(".js-wysiwyg");if(t.length>0&&window.removeAllEditors){window.removeAllEditors()}});function i(e){var t=e.data("browse-mailing-id");if(!!t){return t}var i=e.data("form-target");var n=!!i?$(i):null;if(!n||n.length===0){return null}var r=o.get(n);t=r.getValue("mailingID");if(!t){t=r.getValue("mailingId")}return t}function s(n){return function(e){var t=n.parent().width();var i=n.parent().height();e.editor.resize(t,i);e.editor.resresize_enabledze=false;$(window).on("resize."+a(n),r(n))}}var r=function(t){return function(){var e=t.parent();CKEDITOR.instances[t.attr("id")].resize(e.width(),e.height())}};var a=function(e){return"ck-editor-"+e.attr("id")};var n=function(e){return!!e.data("full-height-editor")};var l=function(e){var t={};t.isFullHtml=!!e.data("full-tags");t.isFullHeight=n(e);t.browseMailingId=i(e);t.height=t.isFullHeight?0:e.height();t.width=t.isFullHeight?e.parent().width():"100%";t.allowExternalScript=false;return _.extend(t,AGN.Lib.Helpers.objFromString(e.data("editor-options")))}})();AGN.Lib.Validator.new("action",{valid:function(e,t,i){return i&&!this.errors(e,t).length},errors:function(e,t){const i=[];if($("#serviceMailOperation").length)this.validateSendServiceOperation(i);return i},validateSendServiceOperation:function(e){validateEmailList($("input[id$=toAddress]"),e,"triggerManager.operation.serviceMail.error.recipientAddress");validateEmail($("input[id$=fromAddress]"),e,"triggerManager.operation.serviceMail.error.senderAddress");validateEmail($("input[id$=replyAddress]"),e,"triggerManager.operation.serviceMail.error.replyAddress");validateSubject($("input[id$=subjectLine]"),e)}});function validateEmailList(e,o,s){e.each(function(e,i){const n=$(i);const r=getEmailsFromField(n);if(!r||!isValidEmailList(r)){o.push({field:n,msg:t(s)})}else{n.val(r.join(","))}})}function validateEmail(e,o,s){e.each(function(e,i){const n=$(i);const r=n.val().trim();if(!AGN.Lib.Helpers.isValidEmail(r)){o.push({field:n,msg:t(s)})}else{n.val(r)}})}function validateSubject(e,o){e.each(function(e,i){const n=$(i);const r=n.val().trim();if(!r||r.length<3){o.push({field:n,msg:t("triggerManager.operation.serviceMail.error.subjectToShort")})}else if(r&&r.length>200){o.push({field:n,msg:t("triggerManager.operation.serviceMail.error.subjectToLong")})}else{n.val(r)}})}function getEmailsFromField(e){const t=e.val();let i=t.trim()&&t.trim().split(/[ ,|]+/);_.map(i,_.trim);return i}function isValidEmailList(e){return e.every(e=>AGN.Lib.Helpers.isValidEmail(e))}(function(){AGN.Lib.Validator.new("export/form",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,t){var i=[];n(i);return i}});function n(r){var o=[];_.each($("#columnMappings tbody").find("[data-column-mapping-row]"),function(e){var t=$(e);var i=t.find("[data-column-name]");var n=l(i);s(i,r);a(n,o,r,i);o.push(n.toLowerCase())})}function s(e,i){var n=l(e);if(!e.is(":last-child")&&n.length<3||e.is(":last-child")&&n&&n.length<3){i.push({field:e,msg:t("export.columnMapping.error.nameToShort")});return}if(!e.is(":last-child")&&!/^[a-zA-Z0-9_]{3,}$/.test(n)||e.is(":last-child")&&n&&!/^[a-zA-Z0-9_]{3,}$/.test(n)){i.push({field:e,msg:t("export.columnMapping.error.invalidColName")})}}function a(e,i,n,r){if(e&&i.indexOf(e.toLowerCase())>=0){n.push({field:r,msg:t("export.columnMapping.error.duplicate")})}if(o().indexOf(e.toLowerCase())>=0){n.push({field:r,msg:t("export.columnMapping.error.exist")})}}function l(e){return e.val().trim()}function o(){return $.map($('select[name="columns"] option'),function(e){return e.value.toLowerCase()})}})();AGN.Lib.CoreInitializer.new("import-profile-mappings-validator",function(){let s;AGN.Lib.Validator.new("import-profile-mappings/form",{init:function(){const e=$("#config\\:import-profile-mappings-validator");s=e.exists()?e.json():{}},valid:function(e,t){return!this.errors(e,t).length},errors:function(e,t){const i=[];n(i,t.$mappingsBlock);return i}});function a(e,t){return t.length<=e.maxDataSize}function l(e){let t=e.val();if(t[0]=="'"&&t[t.length-1]=="'"){t=t.substring(1,t.length-1)}return t}function r(e,i){const n=l(e);if(n&&d(e)!==s.doNotImportValue){const r=u(e);const o=r.dataType.toLowerCase();if(r.column==="email"&&!AGN.Lib.Helpers.isValidEmail(n)){i.push({field:e,msg:t("import.columnMapping.error.invalidEmail")})}else if(o==="date"||o==="datetime"){if(f(e.val().trim())){return}c(o,n,i,e)}else if(!h(o,n)){i.push({field:e,msg:t("import.columnMapping.error.type",o)})}else if(!a(r,n)){i.push({field:e,msg:t("import.columnMapping.error.length",r.maxDataSize)})}}}function c(e,i,n,r){if(!i||!h(e,i)){n.push({field:r,msg:t("import.columnMapping.error.dateFormat",e==="datetime"?window.adminDateFormat+" hh:mm":window.adminDateFormat)})}}function n(n,e){_.each(e.find("[data-mapping-defaultValue]"),e=>{const t=$(e);const i=t.closest("[data-mapping-row]");if(!i.is("[data-mapping-new]")||d(t)!==s.doNotImportValue&&!m()){r(t,n)}})}function u(e){return s.columns[d(e)]}function d(e){return e.closest("[data-mapping-row]").find("[data-mapping-db-column]").first().val()}function h(e,t){switch(e){case"numeric":case"float":case"double":return p(t);case"integer":return g(t);case"date":return i(t);case"datetime":return o(t);default:return true}}function f(e){return/^(now|now\(\)|sysdate|sysdate\(\)|current_timestamp|current_timestamp\(\)|today)\s*([+\-]\s*\d+\s*)?$/im.test(e)}function i(e){return moment(e,window.adminDateFormat.toUpperCase(),true).isValid()}function o(e){const t=e.split(" ");return i(t[0])&&/^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/.test(t[1])}function p(e){return!isNaN(parseFloat(e))&&isFinite(e)}function g(e){return/^-?\d+$/.test(e)}function m(){const e=$("[data-action=set-today-date]");return e.exists()&&e.is(":checked")}});AGN.Lib.Validator.new("length",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=e.val();var r=[];if(n){if(i.min>=0&&n.length<i.min){r.push({field:e,msg:t("fields.errors.string_exceed_min_length",i.min)})}else if(i.max>=0&&n.length>i.max){r.push({field:e,msg:t("fields.errors.string_exceed_max_length",i.max)})}}else if(i.min>0||i.required===true){r.push({field:e,msg:t("fields.required.errors.missing")})}return r}});AGN.Lib.Validator.new("logon-new-password/form",{valid:function(){return!this.errors().length},errors:function(){var e=[];var i=$("#password");var n=$("#password-repeat");var r=i.val();if(!$.trim(r)){e.push({field:i,msg:t("fields.required.errors.missing")})}else if(r!=n.val()){e.push({field:n,msg:t("fields.password.errors.notMatching")})}return e}});AGN.Lib.Validator.new("mailing-priorities/form",{valid:function(){if($("#priorityCount").val()>0){return true}AGN.Lib.Messages(t("defaults.error"),t("error.mailing.invalidPriorityCount"),"alert");return false},errors:function(){return[]}});AGN.Lib.Validator.new("mailinglist-exist",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=e.val();var r=AGN.Lib.Validator.get("required-id").errors(e,i);if(r&&r.length<=0&&i&&n&&i.removedMailinglistId==n.trim()){r.push({field:e,msg:t("fields.mailinglist.errors.removed")})}return r}});AGN.Lib.Validator.new("max-length-validator",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=e.val();var r=[];if(e.hasClass("js-wysiwyg")&&!n){n=$("#cke_"+e.attr("id")).find("iframe").contents().find("body").text()}if(n){if(n.length>i.max){r.push({field:e,msg:t("fields.errors.contentLengthExceedsLimit",i.max)})}}else if(i.required===true){r.push({field:e,msg:t("fields.required.errors.missing")})}return r}});(function(){AGN.Lib.Validator.new("number",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=[];if(i.excludeHidden&&e.is(":hidden")){return[]}var r=e.val();if(r){var o=i.float===true?parseFloat(r):parseInt(r);if(isNaN(o)){n.push({field:e,msg:t("fields.errors.number_nan")})}else{if(o<i.min){n.push({field:e,msg:t("fields.errors.number_exceed_min",i.min-1)})}else if(o>i.max){n.push({field:e,msg:t("fields.errors.number_exceed_max",i.max)})}else if(i.strict===true){if($.trim(r)!==o.toString()){if(i.float===true){n.push({field:e,msg:t("fields.errors.number_not_double")})}else{n.push({field:e,msg:t("fields.errors.number_not_integer")})}}}}}else if(i.required===true){n.push({field:e,msg:t("fields.required.errors.missing")})}return n}})})();AGN.Lib.Validator.new("phone-number",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=$.trim(e.val());var r=[];var o=0;var s=1;var a=3;var l=4;var c=5;var u=6;if(n){var d=o;var h=false;var f=false;var p=0;for(var g=0;g<n.length;g++){var m=n.charAt(g);if(m>="0"&&m<="9"){p++;d=a}else if(m=="."||m=="-"||m=="/"){if(d==a||d==u){d=l}else{h=true;break}}else if(m=="("){if(f){h=true;break}d=c;f=true}else if(m==")"){if(d==a&&f){d=u;f=false}else{h=true;break}}else if(m=="+"){if(d==o){d=s}else{h=true;break}}else if(!/\s/.test(m)){h=true;break}}if(h||f||p<3||p>20){r.push({field:e,msg:t("fields.errors.phone_number_invalid")})}}else if(i.required===true){r.push({field:e,msg:t("fields.required.errors.missing")})}return r}});(function(){AGN.Lib.Validator.new("reference-table/form",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,t){var i=[];var n=$('[name="shortname"]');var r=$('[name="keyColumn"]');if(n.length)o(n,i,5,t.isVoucher?27:29,new RegExp("^[a-z]*$","i"),"referenceTables.table.error.name");if(r.length)o(r,i,3,30,/^(?![0-9_])[a-z0-9_]*$/,"referenceTables.table.error.keyColumn");return i}});function o(e,t,i,n,r,o){if(!s(e,t,i,n)){return}a(e,t,r,o)}function s(e,t,i,n){var r=AGN.Lib.Validator.get("length").errors(e,{min:i,max:n,required:true});if(r.length){r.forEach(function(e){t.push(e)});return false}return true}function a(e,i,n,r){if(!e.val().match(n)){i.push({field:e,msg:t(r)})}}})();AGN.Lib.Validator.new("reject-script-element",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=[];var r=(new DOMParser).parseFromString(e.val(),"text/html").querySelector("script");if(r){n.push({field:e,msg:t("fields.errors.illegal_script_element")})}return n}});AGN.Lib.Validator.new("required-id",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){if(e.data("select2")&&!e.parent().find(".select2-container").is(":visible")){return[]}var n=e.val();var r=parseInt(n);var o=[];if(isNaN(r)||r.toString()!==n.toString().trim()||r<=0&&i.positive!==false){o.push({field:e,msg:t("fields.required.errors.missing")})}return o}});AGN.Lib.Validator.new("unique-mobile-base",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=AGN.Lib.Select.get(e).getSelectedValue();var r=e.attr("id");var o=[];if(!this.isUniqueMobileBase(n,r)){o.push({field:e,msg:t("fields.mediapool.errors.mobile_base_duplicate")})}return o},isUniqueMobileBase:function(t,e){if(t==""){return true}var i=$("[id^=image-mobile-base]:not(#"+e+")").filter(function(){var e=$(this);return AGN.Lib.Select.get(e).getSelectedValue()===t});return i.length===0}});AGN.Lib.Validator.new("upload-file/form",{valid:function(e,i,n){let r=true;const o=e.get$();if(o.data("upload-selection").length<1){AGN.Lib.Messages(t("defaults.error"),t("error.upload.file"),"alert");r=false}return n&&r&&!this.errors(e,i).length},errors:function(e,i){const n="error.workflow.shortName";const s="fields.required.errors.missing";var r=[{field:$("#name"),minLength:{val:3,msgKey:n},maxLength:99},{field:$("#firstName"),minLength:{val:3,msgKey:n},maxLength:99},{field:$("#phone"),minLength:{val:1,msgKey:s},maxLength:99},{field:$("#email"),maxLength:99,regexpRules:[{regexp:/\S+@\S+\.\S{2,}/,message:t("error.upload.email")}]}];var a=[];r.forEach(function(e){var i=e.field;var n=i.val();if(!n||n.length<1){a.push({field:i,msg:t(s)});return}if(e.minLength&&n.length<e.minLength.val){a.push({field:i,msg:t(e.minLength.msgKey)});return}if(e.maxLength&&n.length>e.maxLength){a.push({field:i,msg:t("fields.errors.contentLengthExceedsLimit",e.maxLength)});return}if(e.regexpRules&&e.regexpRules.length>0){for(var r=0;r<e.regexpRules.length;++r){var o=e.regexpRules[r];if(!n.match(o.regexp)){a.push({field:i,msg:o.message});return}}}});return a}});AGN.Lib.Validator.new("userform-edit/form",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=[];var r=$('[name="formName"]');if(!r.val().match(/^[a-zA-Z0-9-_]+$/gi)){n.push({field:r,msg:t("userform.error.invalid_name")})}this.validateTemplateField(n,$("#successTemplate"),"SUCCESS");this.validateTemplateField(n,$("#errorTemplate"),"ERROR");return n},validateTemplateField:function(e,t,i){if(!this.validateDirectives(e,t)){return false}if(!this.validateHrefPattern(e,t,i)){return false}},validateDirectives:function(e,i){var n=i.val().match(/#(?:include|parse)/gi);if(n){e.push({field:i,msg:t("userform.error.illegal_directive",n.join(", "))});return false}return true},validateHrefPattern:function(e,i,n){var r=i.val();var o=r.search(/\shref\s*=\s*(["'])\s/gi);if(o!=-1){var s=r.slice(0,o).match(/\r?\n/g).length+1;e.push({field:i,msg:t("userform.error.invalid_link",n,s)});return false}return true}});AGN.Lib.Dashboard.Definitions={LAYOUT:{DEFAULT:{COLS_COUNT:3,ROWS_COUNT:2,SCHEMA:[{id:"mailings"},{id:"statistics"},{id:"imports-exports"},{id:"calendar"},{id:"news"}]}},TILE:AGN.Lib.Helpers.deepFreeze({TYPE:{REGULAR:"regular",TALL:"tall",WIDE:"wide"},ID:{EMPTY:"empty",CALENDAR:"calendar",MAILINGS:"mailings",STATISTICS:"statistics",CLICKERS:"clickers",OPENERS:"openers",NEWS:"news",ADD_ONS:"add-ons",ANALYSIS:"analysis",IMPORTS_EXPORTS:"imports-exports",PLANNING:"planning",WORKFLOWS:"workflows"}})};(function(){const r=AGN.Lib.Dashboard.Definitions;const a={setCurrentSchema:function(e){if(!e){e=this.getTiles()}r.LAYOUT.CURRENT.SCHEMA=e.map(({id:e,position:t})=>({id:e,position:t}))},getColsCount:function(){return r.LAYOUT.CURRENT.COLS_COUNT},$getTiles:function(){return $(".draggable-tile")},getTiles:function(){return this.$getTiles().toArray().map(e=>$(e).data("tile"))},removeAllTiles:function(){this.$getTiles().each((e,t)=>$(t).data("tile").remove())},getTileAtPosition:function(t,i,e){if(!e){e=this.getTiles()}return e.find(e=>e.position.rows.includes(t)&&e.position.cols.includes(i))},updateTilesPositions:function(){const t=this.getTiles();const i={row:0,col:-1};t.forEach(e=>e.position={rows:[],cols:[]});t.forEach(e=>e.position=h(t,e.type,i))},getTile:function(e){return e.data("tile")},switchNotAllowedDroppables:function(e,t){this._getNotAllowedDroppablesToSwitch(this.getTile(e)).forEach(e=>e.switchDroppable(t))},_getNotAllowedDroppablesToSwitch:function(e){if(e.isRegular){return this.getTallTiles()}if(e.isTall){return this.getTilesUnderOrAboveWideTiles()}if(e.isWide){return[...this.getTilesLockedByTallTiles(),...this.getTallTiles()]}},setDraggable:function(e){const t=this;e.$el.draggable({containment:r.TILES_CONTAINER,opacity:.7,zIndex:1e3,snap:true,snapMode:"inner",revert:"invalid",cursor:"move",scroll:false,helper:function(e){const t=$(e.currentTarget);return t.clone(true).css({animation:"none",width:t.width(),height:t.height()})},start(){$(this).css({opacity:0});t.switchNotAllowedDroppables($(this),false)},stop(){$(this).css({opacity:1});t.switchNotAllowedDroppables($(this),true)}})},enableDraggable:function(e){this.$getTiles().draggable("option","disabled",!e)},setDroppable:function(e){if(e.$el.is(".tile-wide")){return}const r=this;e.$el.droppable({tolerance:"pointer",activeClass:"draggable-accept",drop:async function(e,t){const i=r.getTile(t.draggable);const n=r.getTile($(this));await r.swapTiles(i,n);r.updateTilesPositions();r.setCurrentSchema()}})},swapTiles:async function(e,t){switch(e.type){case r.TILE.TYPE.TALL:i(e,t);break;case r.TILE.TYPE.WIDE:n(e,t);break;default:e.swap(t);break}},getPreviousTileOfTallTileBottomPart:function(e){if(e===0){return this.getTileAtPosition(0,a.getColsCount()-1)}if(this.getTileAtPosition(1,e-1).isTall){return this.getPreviousTileOfTallTileBottomPart(e-1)}return this.getTileAtPosition(1,e-1)},getTilesUnderOrAboveWideTiles:function(){return this.getTiles().filter(e=>e.isWide).map(e=>{const t=e.beginRow===0?1:0;return[this.getTileAtPosition(t,e.beginCol),this.getTileAtPosition(t,e.endCol)]}).flat()},getTilesLockedByTallTiles:function(){return this.getTiles().filter(e=>e.isRegular&&(e.beginCol===0&&this.getTileAtPosition(e.beginRow,1).isTall)||e.beginCol===this.getColsCount()-1&&this.getTileAtPosition(e.beginRow,this.getColsCount()-2).isTall)},getTallTiles:function(){return this.getTiles().filter(e=>e.isTall)}};function i(e,t){const i=e.beginCol;const n=t.beginCol;const r=a.getTileAtPosition(0,n);const o=a.getTileAtPosition(1,n);const s=a.getPreviousTileOfTallTileBottomPart(i);if(r.$el.is(s.$el)){s.$el.after(o.$el);e.swap(r)}else{e.swap(r);if(!r.isTall){s.$el.after(o.$el)}}}function n(e,t){if(e.beginRow===t.beginRow){o(e,t)}else{d(e,t)}}function o(e,t){const i=e.beginCol;const n=e.beginRow;if(t.beginCol===i-2){a.getTileAtPosition(n,i-2).$el.before(e.$el)}else if(t.beginCol===i+3){a.getTileAtPosition(n,i+3).$el.after(e.$el)}else{e.swap(t)}}function s(e,t,i){e.swap(t);t.$el.after(i.$el)}function l(e,t,i){e.swap(i);i.$el.after(t.$el)}function c(e){return e===0}function u(e){return e===a.getColsCount()-1}function d(e,t){const i=t.beginCol;const n=t.beginRow;const r=a.getTileAtPosition(n,i+1);const o=a.getTileAtPosition(n,i-1);if(!c(i)&&o.isRegular){l(e,t,o)}else if(!u(i)&&r.isRegular){s(e,t,r)}}function h(e,t,i){i.col=i.col+1;if(i.col>=a.getColsCount()){i.row=i.row+1;i.col=0}while(f(e,t,i.row,i.col)){i.col=i.col+1}switch(t){case r.TILE.TYPE.TALL:return{rows:[0,1],cols:[i.col]};case r.TILE.TYPE.WIDE:i.col=i.col+1;return{rows:[i.row],cols:[i.col-1,i.col]};default:return{rows:[i.row],cols:[i.col]}}}function f(e,t,i,n){if(t!==r.TILE.TYPE.TALL){return e.filter(e=>e.isTall).some(e=>e.position.rows.includes(i)&&e.position.cols.includes(n))}if(t!==r.TILE.TYPE.WIDE){return e.filter(e=>e.isWide).some(e=>e.position.rows.includes(i)&&e.position.cols.includes(n))}return false}AGN.Lib.Dashboard.GridUtils=a})();class DraggableTile{static get def(){return AGN.Lib.Dashboard.Definitions}static get#utils(){return AGN.Lib.Dashboard.GridUtils}constructor(e){if(new.target===DraggableTile){throw new TypeError("Cannot construct Abstract Tile instances directly!")}this.type=DraggableTile.def.TILE.TYPE.REGULAR;this.variants=[{type:DraggableTile.def.TILE.TYPE.REGULAR}];this._controller=e}displayOnScreen(e){if(e.is(".draggable-tile")){e.replaceWith(this.$el)}else{DraggableTile.def.TILES_CONTAINER.append(this.$el)}this._$el.data("tile",this);DraggableTile.#utils.updateTilesPositions();this.#initDragAndDrop();AGN.runAll(this.$el);return this}replaceWith(e){e.displayOnScreen(this.$el)}remove(){this.$el.remove()}#initDragAndDrop(){DraggableTile.#utils.setDraggable(this);DraggableTile.#utils.setDroppable(this)}switchDroppable(e){this.$el.droppable("option","disabled",!e)}swap(e){const t=$("<span>").hide();this.$el.before(t);e.$el.before(this.$el);t.replaceWith(e.$el)}get id(){return"unknown"}get name(){return t(`dashboard.tile.${this.id}`)}thumbnail(){return AGN.url(`/assets/core/images/dashboard/tile/${this.id}.svg`)}allowed(){return AGN.Lib.Template.exists(this.#getTemplateName())}get $el(){if(!this._$el){this._$el=AGN.Lib.Template.dom(this.#getTemplateName(),{tileName:this.name,tileType:this.type,overlay:this.getOverlay()})}return this._$el}set $el(e){this._$el=e}get position(){if(!this._position){return{rows:[],cols:[]}}return this._position}set position(e){this._position=e}get beginCol(){return this.position.cols[0]}get beginRow(){return this.position.rows[0]}get endCol(){return this.position.cols[1]}get endRow(){return this.position.rows[1]}get isEmpty(){return this.id===DraggableTile.def.TILE.ID.EMPTY}get isRegular(){return this.type===DraggableTile.def.TILE.TYPE.REGULAR}get isTall(){return this.type===DraggableTile.def.TILE.TYPE.TALL}get isWide(){return this.type===DraggableTile.def.TILE.TYPE.WIDE}#getTemplateName(){return`dashboard-tile-${this.id}`}getOverlay(){return AGN.Lib.Template.text("dashboard-tile-overlay")}}class BaseMailingStatisticsTile extends DraggableTile{constructor(){if(new.target===BaseMailingStatisticsTile){throw new TypeError("Cannot construct Abstract BaseMailingStatisticsTile instances directly!")}super();if(this.needsRedrawOnMobile()){this._isMobileView=false;this.#setupDisplayTypeChangeHandler()}this._chart=null;this._chartData={names:[],values:[],mailingId:0}}#setupDisplayTypeChangeHandler(){$(window).on("displayTypeChanged",(e,t)=>{this._isMobileView=t;if(this._chart){this.updateChart(true)}})}displayOnScreen(e){super.displayOnScreen(e);if(this.#$findCanvas().exists()){this.updateChart()}}async updateChart(e=false){const t=this._chartData.mailingId;this._chartData.mailingId=this.$el.find("[data-statistics-mailing]").val();const i=this._chartData.mailingId!==t;if(!i&&!e){return}if(i){const n=await this.fetchChartData();this.initChartData(n)}this.drawChart()}fetchChartData(){throw new Error("Fetch function not implemented for statistics tile!")}initChartData(e){this._chartData.names=e.names;this._chartData.values=e.values}drawChart(){if(this._chart){this._chart.destroy()}const e=this.#$findCanvas()[0].getContext("2d");this._chart=new Chart(e,this.getChartOptions())}#$findCanvas(){return this.$el.find("canvas")}getChartOptions(){throw new Error("Chart options not defined for statistics tile!")}needsRedrawOnMobile(){return false}}class BaseMailingDeviceStatisticsTile extends BaseMailingStatisticsTile{constructor(){if(new.target===BaseMailingDeviceStatisticsTile){throw new TypeError("Cannot construct Abstract BaseMailingDeviceStatisticsTile instances directly!")}super()}fetchChartData(){const e=this._chartData.mailingId;return new Promise((o,t)=>{$.ajax({type:"GET",url:AGN.url("/dashboard/statistics.action"),data:{mailingId:e},success:e=>{const t=[];const i=[];const n=this.extractStatisticsData(e);for(let e=0;e<n.length;e++){const r=this.roundTo(n[e][1]*100,1);t.push(n[e][0]);i.push(r)}o({names:t,values:i,percent:this.extractPercent(e)})},error:e=>t(e)})})}extractStatisticsData(e){throw new Error("Function not implemented for statistics tile!")}extractPercent(e){throw new Error("Function not implemented for statistics tile!")}initChartData(e){super.initChartData(e);this._chartData.percent=e.percent}getChartOptions(){if(!this._chartData.colors){this._chartData.colors=[this.$el.css("--chart-very-dark-blue-color"),this.$el.css("--chart-dark-blue-color"),this.$el.css("--chart-blue-color"),this.$el.css("--chart-light-blue-color"),this.$el.css("--chart-cyan-color")]}return{type:"agnDoughnut",data:{labels:this._chartData.names,datasets:[{data:this._chartData.values,backgroundColor:this._chartData.colors,borderWidth:0}]}}}roundTo(e,t){return parseFloat(e).toFixed(t)*1}}class EmptyTile extends DraggableTile{get id(){return DraggableTile.def.TILE.ID.EMPTY}getOverlay(){return AGN.Lib.Template.text("dashboard-tile-empty-overlay")}}class AddOnsTile extends DraggableTile{get id(){return DraggableTile.def.TILE.ID.ADD_ONS}}class AnalysisTile extends DraggableTile{get id(){return DraggableTile.def.TILE.ID.ANALYSIS}}class CalendarTile extends DraggableTile{constructor(e){super(e);this.type=DraggableTile.def.TILE.TYPE.WIDE;this.variants=[{type:DraggableTile.def.TILE.TYPE.WIDE},{type:DraggableTile.def.TILE.TYPE.TALL}];this._controller.addDomInitializer("dashboard-calendar",this.#domInitializer)}#domInitializer(){new AGN.Lib.Calendar(this.el,this.config.firstDayOfWeek,this.config.statisticsViewAllowed)}get id(){return DraggableTile.def.TILE.ID.CALENDAR}remove(){super.remove();this.$el=undefined}thumbnail(e){const t=e===DraggableTile.def.TILE.TYPE.TALL?"-tall":"";return AGN.url(`/assets/core/images/dashboard/tile/${this.id}${t}.svg`)}}class ImportExportTile extends DraggableTile{get id(){return DraggableTile.def.TILE.ID.IMPORTS_EXPORTS}}class StatisticsTile extends BaseMailingStatisticsTile{constructor(){super()}fetchChartData(){const i=this._chartData.mailingId;return new Promise(function(e,t){$.ajax({type:"GET",url:AGN.url("/dashboard/statistics.action"),data:{mailingId:i},success:function(t){const i=[];const n=[];for(let e=0;e<t["common"].length;e++){i.push(t["common"][e][0]);n.push(parseInt(t["common"][e][1]))}e({names:i,values:n})},error:function(e){t(e)}})})}getChartOptions(){const e=this._isMobileView;const t=this.$el.css("--chart-blue-color");return{type:"bar",data:{labels:this._chartData.names,datasets:[{data:this._chartData.values,backgroundColor:t,categoryPercentage:e?.7:.9,minBarLength:2}]},options:{indexAxis:e?"y":"x",layout:{padding:{top:e?0:20,right:e?25:0}},scales:{x:{display:!e,ticks:{autoSkip:false,maxRotation:90,minRotation:0}},y:{display:e,ticks:{mirror:true,labelOffset:-37.5}}},plugins:{legend:{display:false},datalabels:{anchor:"end",align:"end",offset:e?0:-5}}}}}needsRedrawOnMobile(){return true}get id(){return DraggableTile.def.TILE.ID.STATISTICS}}class ClickersTile extends BaseMailingDeviceStatisticsTile{constructor(){super()}extractStatisticsData(e){return e["clickers"]}extractPercent(e){return e["clickersPercent"][0]}drawChart(){super.drawChart();this.#updateClickerPercent(this._chartData.percent)}#updateClickerPercent(e){e=this.roundTo(e*100,1);this.$el.find("#statistics-clickers-percent").text(`${e}%`)}get id(){return DraggableTile.def.TILE.ID.CLICKERS}}class OpenersTile extends BaseMailingDeviceStatisticsTile{constructor(){super()}extractStatisticsData(e){return e["openers"]}extractPercent(e){return e["openersPercent"][0]}drawChart(){super.drawChart();this.#updateOpenersPercent(this._chartData.percent)}#updateOpenersPercent(e){e=this.roundTo(e*100,1);this.$el.find("#statistics-openers-percent").text(`${e}%`)}get id(){return DraggableTile.def.TILE.ID.OPENERS}}class MailingsTile extends DraggableTile{get id(){return DraggableTile.def.TILE.ID.MAILINGS}}class NewsTile extends DraggableTile{get id(){return DraggableTile.def.TILE.ID.NEWS}}class PlanningTile extends DraggableTile{constructor(e){super(e);const t=this;this._controller.addDomInitializer("dashboard-planning",function(){$.i18n.load(this.config.translations);t.#setupDatePickers();t.#displayData(new Date,new Date)});this.type=DraggableTile.def.TILE.TYPE.TALL;this.variants=[{type:DraggableTile.def.TILE.TYPE.TALL}]}get id(){return DraggableTile.def.TILE.ID.PLANNING}#setupDatePickers(){const e=this.$el.find("#schedule-start-date");const t=this.$el.find("#schedule-end-date");this.#setupDatePicker(e,e,t);this.#setupDatePicker(t,e,t)}#setupDatePicker(e,l,c){const i=this;e.on("change",function(){const e=l.datepicker("getDate");const t=c.datepicker("getDate");if(e&&t){i.#displayData(e,t)}});e.datepicker("option","onChangeMonthYear",function(e,t,i){const n=$(this);const[r,o]=n.datepicker("option","yearRange").split(":");if(parseInt(e)===parseInt(o)){const s=`${r}:${parseInt(o)+1}`;const a=n.is(l)?c:l;i.settings.yearRange=s;a.datepicker("option","yearRange",s)}})}#displayData(e,i){this.#fetchData(e,i,window.adminDateFormat).then(e=>{let i="";if(e.length){i=`<div class="grid w-100" style="--bs-columns: 1">${this.#handleMailings(e)}</div>`}else{i=AGN.Lib.Template.text("notification-info",{message:t("dashboard.schedule.noMailings")})}const n=this.$el.find("#schedule-data-container");n.html(i);AGN.runAll(n)})}#fetchData(e,n,r){return new Promise((t,i)=>{$.get(AGN.url("/dashboard/scheduledMailings.action"),{startDate:AGN.Lib.DateFormat.format(e,r),endDate:AGN.Lib.DateFormat.format(n,r)}).done(e=>t(e)).fail(e=>i(e))})}#handleMailings(e){_.each(e,e=>e.link=AGN.url(`/mailing/send/${e.id}/view.action`));const t=_.groupBy(e,"sendDate");const i=_.sortBy(t,e=>e[0].maildropSendDate).map(e=>_.sortBy(e,"sendTime"));return i.reduce((e,t)=>{const i=new Date(t[0].maildropSendDate);const n=i.toLocaleString(window.adminLocale,{weekday:"long"});const r=t[0].sendDate;const o=AGN.Lib.Template.text("dashboard-schedule-day",{dayOfWeek:n,dateStr:r,dayMailings:t});return e+o},"")}}class WorkflowsTile extends DraggableTile{get id(){return DraggableTile.def.TILE.ID.WORKFLOWS}}AGN.Lib.Controller.new("dashboard",function(){const e=AGN.Lib.Modal;const o=AGN.Lib.Dashboard.GridUtils;const r=AGN.Lib.Dashboard.Definitions;let i=[new MailingsTile(this),new PlanningTile(this),new StatisticsTile(this),new ClickersTile(this),new OpenersTile(this),new WorkflowsTile(this),new ImportExportTile(this),new AddOnsTile(this),new NewsTile(this),new CalendarTile(this),new AnalysisTile(this)];let s;this.addDomInitializer("dashboard-view",function(){r.LAYOUT.CURRENT=JSON.parse(this.config.layout)||_.clone(r.LAYOUT.DEFAULT);i=i.filter(e=>e.allowed());r.TILES_CONTAINER=$("#dashboard-tiles");f();a();t();$(window).on("displayTypeChanged",(e,t)=>{if(t){R(false)}});R(false)});function t(){if(!n().length){AGN.Lib.Messages.info("dashboard.empty")}}function n(){return o.getTiles().filter(e=>e.$el.css("visibility")!=="hidden")}function a(){const e=_.template(AGN.Opt.Templates["dashboard-tiles-selection-modal"])({tiles:i});l($(e))}function l(e){e.find("img").each(function(){const e=new Image;e.src=$(this).attr("src")})}function c(){const e=r.LAYOUT.CURRENT.SCHEMA;if(e===r.LAYOUT.DEFAULT.SCHEMA){return h(e)}u(e);return h(e)}function u(e){e.sort((e,t)=>{const i=e.position.rows[0];const n=e.position.cols[0];const r=t.position.rows[0];const o=t.position.cols[0];if(i!==r){return i-r}return n-o})}function d(e,t){if(e.position?.rows?.length>1){return r.TILE.TYPE.TALL}if(e.position?.cols?.length>1){return r.TILE.TYPE.WIDE}return t}function h(e){return e.map(e=>{const t=S(e.id);t.type=d(e,t.type);return t})}function f(){o.removeAllTiles();p(o.getColsCount());c().forEach(e=>e.displayOnScreen(r.TILES_CONTAINER))}function p(e){r.TILES_CONTAINER.removeClass(function(e,t){return(t.match(/\bdashboard-grid-cols-\S+/g)||[]).join(" ")});r.TILES_CONTAINER.addClass(`dashboard-grid-cols-${e}`)}this.addAction({click:"delete-tile"},function(){const e=this.el.closest(".draggable-tile");const t=A(e);if(t.isTall){g(t)}if(t.isWide){m(t)}t.replaceWith(new EmptyTile);t.remove()});function g(e){const t=$('<div class="draggable-tile">');const i=e.beginCol;const n=new EmptyTile;const r=o.getPreviousTileOfTallTileBottomPart(i);r.$el.after(t);n.displayOnScreen(t)}function m(e){const t=$('<div class="draggable-tile">');e.$el.after(t);(new EmptyTile).displayOnScreen(t)}this.addAction({click:"select-tile"},function(){s=A(this.el.closest(".draggable-tile"));e.fromTemplate("dashboard-tiles-selection-modal",{tiles:v()})});function v(){const t=o.getTiles().map(e=>e.id);return i.filter(function(e){return e.id!==r.TILE.ID.EMPTY&&!t.includes(e.id)}).map(e=>{e.variants.forEach(e=>e.disabled=!w(e.type));return e})}this.addAction({click:"add-tile"},function(){const e=S(this.el.data("tile-id"));const t=this.el.data("type");if(t){e.type=t}if(!w(t)){return}if(e.isTall){y()}if(e.isWide){b()}s.replaceWith(e)});function y(){const e=s.beginCol;const t=E(0,e);const i=E(1,e);s=t;i.remove()}function b(){const e=s.beginCol;const t=s.beginRow;const i=E(t,e+1);const n=E(t,e-1);if(i&&i.isEmpty){i.remove();return}if(n&&n.isEmpty){s.remove();s=n}}function w(e){switch(e){case r.TILE.TYPE.TALL:return C();case r.TILE.TYPE.WIDE:return x();default:return true}}function C(){const e=s.beginCol;const t=E(0,e);const i=E(1,e);return t.isEmpty&&i.isEmpty}function x(){const e=s.beginRow;const t=s.beginCol;const i=E(e,t-1);const n=E(e,t+1);return i&&i.isEmpty||n&&n.isEmpty}this.addAction({change:"redraw-mailing-statistics"},function(){const e=this.el.closest(".draggable-tile");const t=A(e);t.updateChart()});this.addAction({click:"open-mailing-statistics"},function(){const e=this.el.closest(".draggable-tile").find("[data-statistics-mailing]").val();AGN.Lib.Page.reload(AGN.url(`/statistics/mailing/${e}/view.action`))});function S(t){return i[i.findIndex(e=>e.id===t)]||new EmptyTile}function A(e){return o.getTile(e)}function E(e,t,i){return o.getTileAtPosition(e,t,i)}function T(e){if(!e.length){return}$(":focus",e).blur();toastr.clear(e)}this.addAction({click:"edit-dashboard"},function(){R(true);const e=this.el.closest(".popup");T(e)});this.addAction({click:"stop-editing"},function(){R(false);t();D()});function D(){o.setCurrentSchema();$.ajax({type:"POST",url:AGN.url("/dashboard/layout/save.action"),data:{layout:JSON.stringify(r.LAYOUT.CURRENT)},async:false}).done(()=>AGN.Lib.Messages.defaultSaved()).fail(()=>AGN.Lib.Messages.defaultError())}function R(e){$("#dashboard-start-edit-btn").closest("li").toggle(!e);$("body").toggleClass("edit-mode",!!e);o.enableDraggable(e)}this.addAction({click:"select-layout"},function(){e.fromTemplate("dashboard-layout-selection-modal")});function M(e,t){switch(t){case 3:return e.position.cols.includes(3);case 2:return e.position.cols.includes(2)||e.position.cols.includes(3);default:return false}}function k(i){let e=o.getTiles().map(e=>{if(e.isWide&&M(e,i)){const t=new EmptyTile;t.position={cols:[e.beginCol],rows:[e.beginRow]};return t}return e});return e.filter(e=>!M(e,i))}function O(t,i){for(let e=0;e<r.LAYOUT.CURRENT.ROWS_COUNT;e++){const n=new EmptyTile;n.position={rows:[e],cols:[i]};t.push(n)}}function N(t){const i=o.getColsCount();const n=o.getTiles();for(let e=2;e<2+t-i;e++){O(n,e)}return n}function I(e){const t=o.getColsCount();if(e<t){return k(e)}return N(e)}this.addAction({click:"change-layout"},function(){const e=this.el.data("cols-count");if(e===o.getColsCount()){return}const t=I(e);r.LAYOUT.CURRENT.COLS_COUNT=e;o.setCurrentSchema(t);f()})});AGN.Lib.Controller.new("action-view",function(){const n=AGN.Lib.Form;const r=AGN.Lib.Template;const a=AGN.Lib.Select;let o;let s={};class i{constructor(t){this.$container=t;this.activeModules=[];t.on("remove-module",()=>{const e=t.find("[data-action-module] [data-module-index]");$.each(e,(e,t)=>$(t).html(e+1+"."))});t.on("add-new-module",()=>{const e=t.find("[data-action-module]");e.last().find("[data-module-index]").html(e.length+".")})}clean(){this.$container.empty()}addModule(e){if(e&&e.type){e.index=this._getNextIndex();const i=r.dom("common-module-data",{moduleName:t(`triggerManager.operation.${e.type}`)});const n=r.text(`module-${e.type}`,e.getParameters());i.find(".tile").append(n);this.$container.append(i);AGN.runAll(i);this.$container.trigger("add-new-module");this.activeModules.push(e)}}deleteModule(t){if(t>=0){const e=this.$container.find(`[data-module-content="${t}"]`);e.closest("[data-action-module]").remove();this.$container.trigger("remove-module");this.activeModules=this.activeModules.filter(e=>e.index!==t)}}toJson(){const i=[];this.$container.find("[data-module-content]").each(function(e,t){i.push(l.toJson($(t),e))});return i}getSubmissionJson(){return JSON.stringify(this.toJson())}getModulesByType(t){return this.activeModules.filter(e=>e.type===t)}_getNextIndex(){const e=this.$container.find("[data-module-content]");let t=0;if(e.length>0){const i=e.last().data("module-content");t=i+1}return t}}class l{constructor(e,t,i){this.type=e;this.index=i||0;this.id=t.id||0;this.data=$.extend(l.defaults(e),t)}static defaults(e){const t={};switch(e){case"ActivateDoubleOptIn":t.forAllLists=false;t.mediaTypeCode=0;break;case"ContentView":t.tagName="";break;case"ExecuteScript":t.script="";break;case"GetArchiveList":t.campaignID=0;break;case"GetArchiveMailing":t.expireDate=null;break;case"GetCustomer":t.loadAlways=false;break;case"IdentifyCustomer":t.keyColumn="";t.passColumn="";break;case"SendMailing":t.mailingID=0;t.delayMinutes=0;t.bcc="";t.userStatusesOption=1;break;case"ServiceMail":t.toAddress="";t.fromAddress="";t.replyAddress="";t.subjectLine="";t.mailtype=0;t.textMail="";t.htmlMail="";break;case"SubscribeCustomer":t.doubleCheck=false;t.keyColumn="";t.doubleOptIn=false;break;case"UnsubscribeCustomer":t.mailinglistIds=[];t.allMailinglistsSelected=false;t.additionalMailinglists=false;break;case"UpdateCustomer":t.useTrack=false;t.columnName="";t.updateValue="";t.updateType=1;t.trackingPointId=-1;break}t.readonly=false;return t}static create(e){return new l(e,{})}static deserialize(e,t){const i=s[e.operationType];return new l(i,e,t)}static toJson(e,t){const s={};s.index=t;e.find('[name^="modules[]"]').each(function(e,t){const i=$(t);const n=i.prop("name")||"";const r=n.replace("modules[].","");let o="";if(i.is("select")){o=a.get(i).getSelectedValue()}else if(i.is("input")&&i.prop("type")==="checkbox"){o=i.prop("checked")}else{o=i.val()}s[r]=o});return $.extend(l.defaults(s.type),s)}getParameters(){const e={type:this.type,index:this.index,id:this.id};return _.merge({},this.data,e)}}this.addDomInitializer("action-view",function(){const e=n.get(this.el);s=this.config.operationTypes;o=new i($("#module-list"));o.clean();let t=[];if(this.config.modules){t=JSON.parse(this.config.modules).map((e,t)=>l.deserialize(e,t))}t.forEach(e=>o.addModule(e));e.initFields()});this.addAction({click:"add-new-module"},function(){const e=$("#moduleName").val();const t=l.create(e);if(t.type==="SendMailing"){if(o.getModulesByType("ActivateDoubleOptIn").length>0){t.data.userStatusesOption=0}}o.addModule(t);n.get(this.el).initFields();if(t.type==="ActivateDoubleOptIn"){const i=o.getModulesByType("SendMailing");i.forEach(function(e){const t=$(`#module-${e.index}-userStatusesOption`);a.get(t).selectFirstValue()})}});this.addAction({click:"action-delete-module"},function(){const e=this.el.closest(".tile").find("[data-module-content]").data("module-content");o.deleteModule(e)});this.addAction({submission:"save-action-data"},function(){const e=n.get(this.el);e.setValueOnce("modulesSchema",o.getSubmissionJson());e.submit()});this.addDomInitializer("update-customer-module",function(){const e=$(this.el);const t=e.find('[data-action="toggle-if-first"]:checked');c(e,t.exists())});this.addAction({click:"toggle-if-first"},function(){const e=$(this.el);c(e,e.prop("checked"))});function c(e,t){const i=e.closest("[data-action-module]");const n=i.find("[data-useTrack-trackingPointId]");const r=i.find("[data-useTrack-updateValue]");if(!n.exists()){r.removeClass("hidden");return}if(i.index()===0){n.toggleClass("hidden",!t);r.toggleClass("hidden",t)}}});AGN.Lib.Controller.new("admin-enabling",function(){this.addAction({click:"save-approved-mailing-lists"},function(){var t=this.el;var e=AGN.Lib.Form.getWrapper(t);n(e);var i=AGN.Lib.Form.get(e);i.submit().done(function(e){if(e.success===true){AGN.Lib.JsonMessages(e.popups,true);AGN.Lib.Modal.getWrapper(t).modal("hide")}else{AGN.Lib.JsonMessages(e.popups,true)}})});function n(e){$("input[name*='disabledMailinglistsIds']").remove();t("mailinglist").each(function(){$("<input>").attr({type:"hidden",name:"disabledMailinglistsIds",value:$(this).data("mailinglist")}).appendTo(e)})}function t(e){if(e){return $("input:checkbox:not(:checked)[data-enabling="+e+"]")}else{return $("input:checkbox:not(:checked)[data-enabling]")}}});AGN.Lib.Controller.new("ai-image-generation",function(){let i;let n;let r;let o;let s;let a;this.addDomInitializer("ai-image-generation",function(){i=$("#ai-generated-image");n=$("#remaining-generations-text");r=$("#generate-btn");o=$("#save-btn");s=$("#important-objects-table");a=$("#filters-table");c(this.config.remainingGenerations)});this.addAction({click:"generate"},function(){const e=AGN.Lib.Form.get(this.el);u(e);d(e);e.jqxhr().done(e=>{if(e.success){c(e.data.remainingGenerationsCount);l(e.data.url);o.removeClass("hidden")}else{AGN.Lib.JsonMessages(e.popups)}})});function l(e){i.attr("src",e);i.parent().removeClass("hidden");i.parent().prev().addClass("hidden")}function c(e){if(e<=0){n.text(t(`mediapool.imageGeneration.limitExceeded`));r.parent().remove()}else{n.text(t(`mediapool.imageGeneration.remainingGenerations`,e))}}this.addAction({click:"save"},function(){const e=$("#ai-generated-image").attr("src");$.post(AGN.url("/mediapool/generated-image/save.action"),{url:e}).done(e=>AGN.Lib.Page.render(e))});this.addAction({change:"use-important-objects"},function(){e(s,!this.el.is(":checked"))});this.addAction({change:"use-filters"},function(){e(a,!this.el.is(":checked"))});function e(e,t){const i=e.find(":input");i.prop("disabled",t);i.prev().toggleClass("input-group-text--disabled",t);e.find(".btn").toggleClass("disabled",t);i.filter(".js-colorpicker").spectrum(t?"disable":"enable")}function u(n){const e=AGN.Lib.InputTable.get(s);e.collect().forEach(function(t,i){Object.keys(t).forEach(e=>{n.setValueOnce(`importantObjects[${i}].${e}`,t[e])})})}function d(n){const e=AGN.Lib.InputTable.get(a);const t=_.groupBy(e.collect(),"name");_.forEach(t,function(e,t){const i=_.map(e,"value");n.setValueOnce(`filters[${t}]`,i)})}});AGN.Lib.Controller.new("ai-text-generation",function(){const s=AGN.Lib.Form;const i=AGN.Lib.Select;let n;this.addDomInitializer("ai-text-generation",function(){const e=i.get($("#ai-language"));if(e.hasOption(window.adminLocale)){e.selectValue(window.adminLocale)}});this.addAction({enterdown:"skip-form-submit"},function(){this.event.preventDefault()});this.addAction({click:"generateText"},function(){const t=this.el.closest(".tile");if(r(t)){const e=l(t);$.post(AGN.url("/mailing/content/generateText.action"),e).done(e=>{n=e.data;c(e.data,t)}).fail(()=>AGN.Lib.Messages.defaultError())}});function r(e){let i=true;const n=e.find("[id^='ai-numberOfWords']");const r=e.find("[id^='ai-content-description']");const o=AGN.Lib.Validator.get("number").errors(n,{min:1,required:true});if(o.length>0){i=false;o.forEach(function(e,t){s.showFieldError$(n,e.msg)})}else{s.cleanFieldFeedback$(n)}if(!$.trim(r.val())){i=false;s.showFieldError$(r,t("fields.required.errors.missing"))}else{s.cleanFieldFeedback$(r)}return i}this.addAction({click:"assumeGeneratedText"},function(){const e=this.el.closest(".tile");const t=this.el.data("tab-id");const i=e.find(".ai-generated-text").val();o(t);a(i,e,t)});function o(e){const t=$(`[data-toggle-tab*="wysiwyg${e}"]`);if(t.exists()){t.trigger("click");return}const i=$(`[data-toggle-tab*="html${e}"]`);if(i.exists()){i.trigger("click")}}function a(t,e,i){const n=e.find(".js-wysiwyg");if($("#tab-content-wysiwyg").is(":visible")||$(`[id^='tab-grid-wysiwyg${i}']`).is(":visible")){var r=CKEDITOR.instances[n.attr("id")];if(r.status==="ready"){r.setData(t)}else{r.on("instanceReady",function(e){e.editor.setData(t)})}}if($("#contentEditor").is(":visible")||$(`[id^='tab-grid-html${i}']`).is(":visible")){ace.edit(`${n.attr("name")}Editor`).setValue(t)}}function l(e){return{language:e.find('[id^="ai-language"]').val(),numberOfWords:e.find('[id^="ai-numberOfWords"]').val(),tonality:e.find('[id^="ai-tonality"]').val(),contentDescription:e.find('[id^="ai-content-description"]').val()}}function c(e,t){t.find(".ai-generated-text").val(e);t.find("#ai-assume-generated-text").removeClass("hidden")}});AGN.Lib.Controller.new("auto-import-export",function(){var i;var s;this.addDomInitializer("auto-export",function(){i=this.config.urls.checkConnection;e()});function e(){const e=$("#edit-profile-btn");const t=$("#add-profile-btn");const i=$("#export-profile").val();const n=parseInt(i)>0;t.toggle(!n);e.toggle(n).attr("href",AGN.url("/export/"+i+"/view.action"))}this.addDomInitializer("auto-import",function(){i=this.config.urls.checkConnection;s=this.config.isWorkflowDriven;if(p()){n(this.config.contentSourceIdentifier)}});function n(e){const t=AGN.Lib.Select.get($("#contentSourceId"));if(t.hasOption(e)){t.selectValue(e)}}this.addInitializer("optionsChangeable",function(){if($("#recipient-autoimport-csvdescription").length){$('[data-action="options-availability"][value="ReferenceTable"]').prop("disabled",false)}});this.addAction({click:"select-customer-fields"},function(){AGN.Lib.Modal.createFromTemplate({},"modal-select-customer-fields");$("#modalSelectedProfileFields").select2("val",$("#selectedProfileFields").val())});this.addAction({click:"save-selected-customer-fields"},function(){$("#selectedProfileFields").select2("val",$("#modalSelectedProfileFields").val())});this.addAction({change:"select-export-profile"},function(){e()});this.addAction({click:"check-connection"},function(){const e=AGN.Lib.Form.get(this.el);$.ajax(i,{type:"POST",dataType:"html",enctype:"multipart/form-data",processData:false,contentType:false,data:e.data()}).done(function(e){AGN.Lib.Page.render(e)})});var r={},o=false;this.addDomInitializer("import-profile-mailing-lists",function(){const e=this.config;o=e.isAutoImportNew;r=e.profileMailinglists;const t=$('[name="importProfileId"]').val();a(t,o)});this.addAction({change:"change-import-profile"},function(){const e=AGN.Lib.Select.get($(this.el)).getSelectedValue();a(e,o)});const a=function(e,t){if(t){const i=r[e];$('input[type=checkbox][name^="mailinglists"]').prop("checked",false);_.each(i,function(e){$('input[type=checkbox][name="mailinglists['+e+']"]').prop("checked",true)})}};const l=AGN.Lib.ScheduleTimeTable,c=AGN.Lib.ScheduleTimeTable.DayRow;function u(e){const t=e.closest("[data-controller]");return t.data("_schedule_table")}function d(e,t){const i=e.closest("[data-controller]");i.data("_schedule_table",t)}this.addDomInitializer("auto-import-export-scheduler",function(){const e=$(this.el);const t=this.config;const i=t.intervalAsJson||[];const n=$("#tile-importexport-schedule-time");const r=new l(n);d(e,r);var o=[];if(!_.isEmpty(i)){o=JSON.parse(i).map(function(e){return c.deserialize(e)})}o.forEach(function(e){r.addRow(e)});if(o.length===0){r.addEmptyDayRow()}const s=AGN.Lib.Form.get(e);s.initFields();if(!s.editable){n.find(":input, button").prop("disabled",true);n.find("a").attr("disabled","disabled")}});this.addAction({click:"add-day"},function(){u($(this.el)).addEmptyDayRow()});this.addAction({click:"remove-day"},function(){const e=$(this.el);u(e).deleteRow(c.get($(this.el)))});this.addAction({click:"add-schedule"},function(){c.get($(this.el)).addSchedule()});this.addAction({click:"remove-schedule"},function(){c.get($(this.el)).removeSchedule($(this.el))});this.addAction({click:"time-checkbox-toggle"},function(){const e=$(this.el);const t=c.get(e);t.timeCheckboxToggle(e)});this.addAction({click:"hour-checkbox-toggle"},function(){const e=$(this.el);const t=c.get(e);t.hourCheckboxToggle(e)});this.addAction({change:"validate-changes"},function(){const e=$(this.el);const t=c.get(e);h(t)});function h(e){if(e.isValidTimeIntervals()){e.hideTimeScheduleErrors();return true}else{e.showTimeScheduleErrors(t("error.delay.60"));return false}}this.addAction({submission:"save-scheduler-data"},function(){const e=$(this.el);const t=u(e);const i=t.getAllDayRows().every(function(e){return h(e)});if(i){const n=AGN.Lib.Form.get($(this.el));n.setValueOnce("intervalAsJson",t.getSubmissionJson("day"));n.submit()}});this.addAction({click:"save-auto-import"},function(){const e=$("#recipient-autoimport-form");const t=u(e);const i=t.getAllDayRows().every(function(e){return h(e)});if(i){const r=AGN.Lib.Form.get(e);const o=t.getSubmissionJson("day");var n=f();if(s){r.setValue("intervalAsJson",o);if(n.length){r.setValue("contentSourceID",n[0]);r.setValue("contentSourceType",n[1])}}else{r.setValueOnce("intervalAsJson",o);if(n.length){r.setValueOnce("contentSourceID",n[0]);r.setValueOnce("contentSourceType",n[1])}}r.submit()}});function f(){if(p()){return $("#contentSourceId").val().split("/")}return[]}function p(){const e=$("#contentSourceId");return e.exists()}function g(e){const t=e.closest("[data-controller]");return t.data("_export_type_handler")}function m(e,t){const i=e.closest("[data-controller]");i.data("_export_type_handler",t)}this.addDomInitializer("mailing-options-attribute-resolver",function(){const e=$(this.el);m(e,new v(e,this.config))});function v(e,t){if(!e.exists()){console.error("ExportTypeHandler could not instantiate, element is not defined");return false}this.$element=e;this.exportType=t.exportType||"";this.mailingType=t.mailingType||-1;const i=$('input[name="'+t.oneTimeOption+'"]');this.$oneTimeCheckbox=i;this.initialOneTimeValues={checked:i.is(":checked"),disabled:i.is(":disabled")};this.toggleOneTimeCheckbox()}v.prototype.isAfterMailingDeliveryType=function(){return this.exportType=="Mailing"&&this.mailingType==0};v.prototype.resolve=function(e,t){this.exportType=e||"";this.mailingType=t||-1;this.toggleOneTimeCheckbox()};v.prototype.toggleOneTimeCheckbox=function(){const e=this.isAfterMailingDeliveryType();const t=this.initialOneTimeValues.checked;const i=this.initialOneTimeValues.disabled;this.$oneTimeCheckbox.prop("checked",e||t);this.$oneTimeCheckbox.prop("disabled",e||i)};this.addAction({change:"change-mailing-type"},function(){const e=$(this.el);const t=AGN.Lib.Select.get(e).getSelectedValue();var i;if($("#exportType").is("select")){i=AGN.Lib.Select.get($("#exportType select")).getSelectedValue()}else{i=$("#exportType [type=radio]:checked").val()}g(e).resolve(i,t)});this.addAction({change:"export-type-resolver"},function(){const e=$(this.el);var t;if($("#exportType").is("select")){t=AGN.Lib.Select.get($("#exportType select")).getSelectedValue()}else{t=e.find("[type=radio]:checked").val()}const i=AGN.Lib.Select.get($("#exportMailing select")).getSelectedValue();g(e).resolve(t,i)})});AGN.Lib.Controller.new("available-building-blocks",function(){let n;let r;let i;function e(){n={};r={}}this.addDomInitializer("available-building-blocks",function(){e();i=AGN.Lib.Form.get(this.el);if(this.config.changedBlockStatus){n=JSON.parse(this.config.changedBlockStatus)}});this.addDomInitializer("available-building-blocks-table",function(){const e=this.config.divContainerList;_.each(e,function(e){const t=e.id;const i=e.active;if(t in r){if(t in n){$(`input:checkbox[data-block-id='${t}']`).prop("checked",!!n[t])}}else{r[t]=i}})});this.addAction({click:"search"},function(){const e=this.el;o();i.setActionOnce(e.data("form-url"));i.setResourceSelectorOnce(e.data("form-resource"));i.submit()});this.addAction({click:"save-changed-data"},function(){const t=this.el;o();i.setActionOnce(t.data("form-url"));i.jqxhr().done(e=>{AGN.Lib.JsonMessages(e.popups);if(e.success){AGN.Lib.Confirm.get(t).positive()}})});this.addAction({change:"change-activation"},function(){const e=this.el;const t=e.data("block-id");if(e.is(":checked")==r[t]){if(t in n){delete n[t]}}else{n[t]=e.is(":checked")}});this.addAction({change:"activate-all"},function(){const e=$("input:checkbox[data-block-id]");e.prop("checked",this.el.is(":checked")).change()});function o(){if(!!i){const e=JSON.stringify(n,(e,t)=>t!==null?t:undefined);i.setValue("changedBlockStatusJson",e)}}});AGN.Lib.Controller.new("birt-reports",function(){let o={},t=0,r=[],s=[],a=[],i,n,l;const c=".form-check-input";this.addDomInitializer("birt-reports",function(){o=this.config;n=o.constant.MAILING_ID;i=o.constant.AFTER_MAILING_TYPE_ID;r=o.filtered.FILTER_ARCHIVE;s=o.filtered.FILTER_MAILINGLIST;a=o.filtered.FILTER_TARGET;t=o.reportType;l=this.el});this.addDomInitializer("report-settings",function(){$("#extended-settings-tile").find("[data-toggle-tab]").on("click",function(e){if(!$(e.target).is(c)){const t=$(this).find(c).is(":checked");u().prop("checked",t)}});e();new f(this.el,this.config)});this.addAction({click:"confirm-deactivate-deliveries"},function(){AGN.Lib.Confirm.createFromTemplate({},"report-deactivate-deliveries")});this.addAction({click:"activate-delivery"},function(){const e=this.el.is(":checked");this.event.stopPropagation();window.setTimeout(()=>this.el.prop("checked",e),0);const t=this.el.closest(".btn").is(".active");if(t){u().prop("checked",e)}});function u(){return $('[data-action="activate-delivery-for-active-tab"]')}this.addAction({click:"activate-delivery-for-active-tab"},function(){const e=this.el.is(":checked");this.event.stopPropagation();window.setTimeout(()=>this.el.prop("checked",e),0);$("#extended-settings-tile").find("[data-toggle-tab].active").find(c).prop("checked",e)});this.addAction({change:"interval-change"},function(){e()});function e(){const e=$("#interval").val();if(e==i){d()}else if(t==i){h()}t=e}function d(){$("#extended-settings-tile").find("[data-toggle-tab]").each(function(){const e=$(this);const t=e.data("toggle-tab");if(t.endsWith(n)){e.trigger("click");return}e.addClass("disabled");AGN.Lib.Tab.hide($(t))})}function h(){$("#extended-settings-tile").find("[data-toggle-tab]").each(function(){$(this).removeClass("disabled")})}const f=function(e,t){this.$container=e;this.config=t;this.settingsType=t.settingsType;this.select=AGN.Lib.Select.get(e.find(t.selectors.filterBlockId));this.mailingSelect=AGN.Lib.Select.get(e.find(t.selectors.normalMailing));this.init(t);e.find(t.selectors.mailingType).on("change",e=>{this.handleMailingTypeChanges($(e.target))});e.find(t.selectors.mailingFilter).on("change",e=>{this.handleMailingFilterChanges($(e.target))});e.find(t.selectors.filterBlockId).on("change",e=>{this.handleMailingFilterValueChanges($(e.target))})};f.prototype.init=function(e){const t=e.data.mailingType;const i=e.data.mailingFilter;const n=e.data.predefineMailing;const r=e.data.selectedMailings;const o=this.updateAllComparisonDependentFields(t,i,n,r);o.done(()=>l.dirty("setAsClean"))};f.prototype.handleMailingTypeChanges=function(e){const t=this.getMailingFilter();const i=this.getMailingFilterValue();this.updateNormalMailingField(e.val(),t,i)};f.prototype.handleMailingFilterChanges=function(e){const t=this.getMailingType();this.updateAllComparisonDependentFields(t,e.val())};f.prototype.handleMailingFilterValueChanges=function(e){const t=this.getMailingFilter();const i=this.getMailingType();this.updateNormalMailingField(i,t,e.val())};f.prototype.updateAllComparisonDependentFields=function(e,t,i,n){this.select.resetOptions();if(t>0){let e=[];if(t==1){e=r}else if(t==2){e=s}else if(t==4){e=a}_.each(e,e=>this.select.addFormattedOption(`<option value="${e.id}">${e.shortname}</option>`));this.select.selectValueOrSelectFirst(i);i=this.select.getSelectedValue()}return this.updateNormalMailingField(e,t,i,n)};f.prototype.updateNormalMailingField=function(e,t,i,n){const r=$.Deferred();this.mailingSelect.resetOptions();if(this.settingsType==o.constant.COMPARISON_SETTINGS&&e==2||this.settingsType==o.constant.MAILING_SETTINGS&&e==3){$.ajax({type:"GET",url:AGN.url("/statistics/report/getFilteredMailing.action"),data:{type:t,value:i?i:0,mailingType:o.constant.NORMAL_MAILING_TYPE}}).done(e=>{_.each(e,e=>this.mailingSelect.addFormattedOption(`<option value="${e.id}">${e.shortname}</option>`));this.mailingSelect.selectValue(n?n:"");r.resolve()})}return r.promise()};f.prototype.getMailingFilter=function(){const e=this.$container.find(this.config.selectors.mailingFilter);return parseInt(e.val())|0};f.prototype.getMailingFilterValue=function(){const e=this.select.getSelectedValue();return parseInt(e)|0};f.prototype.getMailingType=function(){const e=this.$container.find(`${this.config.selectors.mailingType}:checked`);return parseInt(e.val())|0}});AGN.Lib.Controller.new("blacklist-list",function(){this.addAction({click:"save"},function(){$.ajax(this.el.data("url"),{type:"POST",data:{email:$("#new-entry-email").val(),reason:$("#new-entry-reason").val()},success:e=>i(e)})});this.addAction({click:"save-edit"},function(){const t=this.el;AGN.Lib.Form.get(t).submit().done(e=>{i(e,()=>AGN.Lib.Modal.getInstance(t).hide())})});function i(e,t){if(e.success===true){AGN.Lib.Form.get($("#blacklist-overview")).submit().done(()=>AGN.Lib.JsonMessages(e.popups,true));if(t){t()}}else if(e.popups){AGN.Lib.JsonMessages(e.popups,true)}else{AGN.Lib.RenderMessages($(e))}}});AGN.Lib.Controller.new("company-insights",function(){const s=AGN.Lib.ChartUtils;const p=50;const g=p+10;let i;let t;let r;let a;let v;let o=[];this.addAction({change:"load-dynamic-statistic"},function(){C()});this.addDomInitializer("company-insights",function(){o=this.config.revenueImages;i=$("#type-of-reactor-chart");t=$("#rebuy-rate-chart");r=$("#revenue-chart");a=$("#reaction-devices-chart");v=$("#devices-progress-chart");C();const e=this.config.chartData;if(this.config.chartData){n(e["reactorType"]);l(e["rebuyRate"]);c(e["revenue"]);u(e)}else{T(i,true);T(t,true);T(r,true)}});function n(e){if(Object.values(e).some(e=>e<=0)){T(i,true);return}const t=[i.css("--chart-very-dark-blue-color"),i.css("--chart-blue-color"),i.css("--chart-cyan-color")];new Chart(i[0].getContext("2d"),{type:"agnDoughnut",data:{labels:Object.keys(e),datasets:[{data:Object.values(e),backgroundColor:t,borderWidth:0}]},options:{plugins:{"half-doughnut-label":false,revenueIcon:false,hideXAxisIfLabelsOverlaps:false}}})}function l(r){if(r<=0){T(t,true);return}r=A(r);const e=[t.css("--chart-blue-color"),t.css("--chart-light-grey-color")];const o=t.css("--chart-half-doughnut-label-color");Chart.register({id:"half-doughnut-label",beforeDraw:(e,t)=>{const i=e.getDatasetMeta(0).data[0].y;const n=Math.floor(e.height*.1);e.ctx.textBaseline="middle";e.ctx.textAlign="center";e.ctx.font=`600 ${n}px ${Chart.defaults.font.family}`;e.ctx.fillStyle=o;e.ctx.fillText(`${r}%`,e.width/2,i-n/3)}});new Chart(t[0].getContext("2d"),{type:"doughnut",data:{datasets:[{data:[r,100-r],backgroundColor:e,borderWidth:0}]},options:{rotation:-90,circumference:180,plugins:{legend:{display:false},datalabels:{display:false},tooltip:{external:null},revenueIcon:false,hideXAxisIfLabelsOverlaps:false}}})}function c(e){const n=s.getTotal(Object.values(e));if(n<=0){T(r,true);return}const t=[r.css("--chart-very-dark-blue-color"),r.css("--chart-dark-blue-color"),r.css("--chart-blue-color"),r.css("--chart-light-blue-color")];const f=o.map(e=>{const t=new Image;t.src=e;return t});Chart.register({id:"revenueIcon",afterDraw:d=>{const h=d.getDatasetMeta(0).data;_.each(Object.keys(h),(i,e)=>{const n=f[e];if(n.complete){const r=h[i];const o=r.x-r.width/2;const s=r.y+r.height;const a=n.width/n.height;const l=40*r.width/100;let e=Math.min(l,a*p);let t=e/a;if(t>p){t=p;e=t*a}const c=o+(r.width-e)/2;const u=s-(g-t)/2-t;d.ctx.drawImage(n,c,u,e,t)}else{n.onload=()=>d.draw()}})}});Chart.register({id:"hideXAxisIfLabelsOverlaps",afterRender:e=>{const t=e.getDatasetMeta(0).data;e.options.scales.x.display=!E(e.data.labels,t,e.ctx);e.update()}});new Chart(r[0].getContext("2d"),{type:"bar",data:{labels:Object.keys(e),datasets:[{data:Object.values(e),backgroundColor:t,categoryPercentage:.9,minBarLength:g}]},options:{indexAxis:"x",layout:{padding:{top:20,right:0}},scales:{x:{ticks:{autoSkip:false,maxRotation:0}},y:{display:false}},plugins:{"half-doughnut-label":false,legend:{display:false},datalabels:{anchor:"end",align:"end",offset:-5,formatter:(e,t)=>{const i=(e*100/n).toFixed(1);return`${i}%`}}}}})}function u(e){d(e["favoriteOpeningDays"]);h(e["favoriteOpeningHours"]);f(e["ctr"]);m(e["conversion"]);y(e["pageImpressions"]);b(e["pageImpressionsPerVisit"]);w(e["pageImpressionsPerBuy"])}function d(e){const i=$("#fav-days-stat-block");if(Object.keys(e).length>0){i.empty()}$.each(e,(e,t)=>{i.append(AGN.Lib.Template.dom("company-insights-fav-day-record",{day:e,value:t}))})}function h(e){const i=$("#fav-time-stat-block");if(Object.keys(e).length>0){i.empty()}$.each(e,(e,t)=>{i.append(AGN.Lib.Template.dom("company-insights-fav-time-record",{time:e,value:t}))})}function f(e){$("#ctr-val").text(e.toString().replace(".",",")+" %")}function m(e){if(e!=0){$("#conversion-val").text(e.toString().replace(".",",")+" %")}}function y(e){if(e!=0){$("#pi-val").text(e.toString().replace(",",".")+" √ò")}}function b(e){if(e!=0){$("#pi-visit-val").text(e.toString().replace(",",".")+" √ò")}}function w(e){if(e!=0){$("#pi-buy-val").text(e.toString().replace(",",".")+" √ò")}}function C(){const e=$("#progressOfUsedPeriod").val();const t={};if(e==="MONTH"){t["byMonth"]=true}else if(e=="PERIOD"){t["from"]=$("#progressOfUsedFrom").val();t["till"]=$("#progressOfUsedTill").val()}$.get(AGN.url("/recipient/chart/progressOfUsedDevices.action"),t).done(e=>{x(e);S(e)})}function x(e){const t=e["usedDevices"];const i=[{title:e["windowsTitle"],count:t["windows"]},{title:e["macTitle"],count:t["mac"]},{title:e["androidTitle"],count:t["android"]},{title:e["iosTitle"],count:t["ios"]}];i.sort((e,t)=>t.count-e.count);const n=i.map(e=>e.title);const r=i.map(e=>e.count);n.push(e["otherTitle"]);r.push(t["other"]);if(s.getTotal(r)===0){T(a,true);return}T(a,false);const o=[a.css("--chart-very-dark-blue-color"),a.css("--chart-dark-blue-color"),a.css("--chart-blue-color"),a.css("--chart-light-blue-color"),a.css("--chart-cyan-color")];Chart.getChart(a)?.destroy();new Chart(a[0].getContext("2d"),{type:"agnDoughnut",data:{labels:n,datasets:[{data:r,backgroundColor:o,borderWidth:0}]},options:{plugins:{"half-doughnut-label":false,revenueIcon:false,hideXAxisIfLabelsOverlaps:false}}})}function S(t){const e=v.css("--chart-black-color");const i=[];const n=[];const r=[];const o=[];const s=[];const a=[];const l=[];for(let e=0;e<t["usedDevicesByPeriods"].length;e++){const u=t["usedDevicesByPeriods"][e];const{windows:d,mac:h,android:f,ios:p,other:g}=u;const m=d+h+f+p+g;n.push(A(d/m));r.push(A(h/m));o.push(A(f/m));s.push(A(p/m));a.push(A(g/m));l.push(m);i.push(u["date"])}const c=Math.max(...l);if(c===0){T(v,true);return}else{T(v,false)}Chart.getChart(v)?.destroy();new Chart(v[0].getContext("2d"),{type:"bar",data:{labels:i,datasets:[{label:t["numberOfReactions"],data:l,borderColor:e,backgroundColor:e,type:"line",yAxisID:"reactions-y"},{label:t["otherTitle"],backgroundColor:v.css("--chart-cyan-color"),data:a},{label:t["iosTitle"],backgroundColor:v.css("--chart-light-blue-color"),data:s},{label:t["androidTitle"],backgroundColor:v.css("--chart-blue-color"),data:o},{label:t["macTitle"],backgroundColor:v.css("--chart-dark-blue-color"),data:r},{label:t["windowsTitle"],backgroundColor:v.css("--chart-very-dark-blue-color"),data:n}]},options:{interaction:{mode:"index"},plugins:{"half-doughnut-label":false,revenueIcon:false,hideXAxisIfLabelsOverlaps:false,datalabels:{display:false},legend:{position:"bottom",reverse:true},tooltip:{callbacks:{label:function(e){let t=e.raw;if(e.datasetIndex>0){t+="%"}return`${e.dataset.label}: ${t}`}},itemSort:(e,t)=>t.datasetIndex-e.datasetIndex}},scales:{x:{stacked:true,ticks:{maxRotation:0}},y:{stacked:true,min:0,max:100,ticks:{callback:(e,t,i)=>`${e}%`}},"reactions-y":{type:"linear",position:"right",min:0,max:c}}}})}function A(e){return Math.round(1e3*e)/10}function E(t,i,n){if(t.length<2){return false}const r=2;const o=t.map(e=>n.measureText(e).width);for(let e=1;e<t.length;e++){const s=i[e].x-o[e]/2;const a=i[e-1].x+o[e-1]/2;if(s-r<=a){return true}}return false}function T(e,t){e.toggleClass("hidden",t);e.next().toggleClass("hidden",!t)}});AGN.Lib.Controller.new("email-list-controller",function(){let i="";let n=" ";let r;const o=()=>{let e=[""];const t=$(`input[name="${i}"]`).val();if(t){e=t.split(n)}return e};const e=()=>{const e=r.getJsonData();$(`input[name="${i}"]`).val(e.join(n))};this.addDomInitializer("email-list-initializer",function(){const e=$(this.el);const t=this.config?.disabled;i=e.data("target-field")||"";n=e.data("data-emails-separator")||n;r=AGN.Lib.EmailsListManager.initialize(e,o(),{disabled:t})});this.addAction({click:"delete-email"},function(){r.deleteRow($(this.el));e()});this.addAction({click:"create-email"},function(){r.createRowAfter($(this.el));e()});this.addAction({change:"change-trigger"},function(){e()})});AGN.Lib.Controller.new("company-view",function(){this.addDomInitializer("company-view",function(){e()});this.addAction({click:"create-postal-field"},function(){const e=this.el.attr("href");const t=AGN.Lib.Form.get(this.el);t.jqxhr().done(()=>AGN.Lib.Page.reload(e))});this.addAction({change:"update-policy"},function(){e()});function e(){const e=$("#passwordPolicy").val();$("#password").attr("data-rule",e)}});AGN.Lib.Controller.new("content-source-view",function(){const e=AGN.Lib.Select;const r=AGN.Lib.InputTable;const i=AGN.Lib.Helpers;let n;let o;let s=[];let a;let l;let c;let u;let d;this.addDomInitializer("content-source-view",function(){n=AGN.Lib.Form.get($("#content-source-form"));a=$("#resource-type").val();d=$("#urls-table");l=$("#url-settings");c=e.get($("#content-block-name"));u=e.get($("#target-group-select"));o=this.config.htmlSourcesAllowed;s=this.config.availableMailings;h();f()});function h(){const e=d.find('[data-name="url"]');if(a==="HTML"&&o){e.each((e,t)=>g($(t)));$("[data-add-row]").closest("td").show();$('[data-action="configure-url"]').closest("td").show()}else if(a==="XML"){$("[data-add-row]").closest("td").hide();$('[data-action="configure-url"]').closest("td").hide();e.first().attr("data-field","required");n.initFields()}}this.addAction({change:"change-resource-type"},function(){a=this.el.val();h()});function f(){$("#mailing-name").on("change",p);y(d.find("tr:first"))}function p(){const e=s.find(e=>e.name===$(this).val()).blocks.map(e=>({id:e,text:e}));c.setOptions(e)}function g(e){e.closest("td").next().toggleClass("hidden",!$(e).val())}this.addAction({change:"url-input",keyup:"url-input",paste:"url-input"},function(){g(this.el)});this.addAction({click:"configure-url"},function(){if(!n.validate()){return}n.cleanFieldFeedback();b();y(this.el.closest("tr"))});function m(e){u.selectValueOrSelectFirst(e.targetGroup)}function v(e){return a!=="XML"&&e.find('[data-name="url"]')?.val()?.trim()?.length>0}function y(e){const i=r.get(d).getRowData(e);l.toggle(v(e));l.data("urlRow",e);$("#url-ph").text(i.url);const n=i.contentBlockName?{id:i.contentBlockName,text:i.contentBlockName}:{id:"",text:t("contentSource.mailingContentSelect")};c.setOptions([n]);m(i)}function b(){const e=l.data("urlRow");e.find('[data-name="contentBlockName"]').val($("#content-block-name").val());e.find('[data-name="targetGroup"]').val($("#target-group-select").val())}function w(t){if(a==="HTML"){for(let e=0;e<t.length;e++){if(t[e].contentBlockName.trim()?.length<=0){y(d.find("tr").eq(e));return n.validate()}}}return true}this.addAction({submission:"content-source-save"},function(){b();const e=r.get(d).collect();if(!w(e)){return}_.each(e,function(e,t){n.setValue("urls["+t+"].url",e.url);n.setValue("urls["+t+"].contentBlockName",e.contentBlockName);n.setValue("urls["+t+"].targetGroup",e.targetGroup||0)});n.submit()});AGN.Lib.Validator.new("content-source-url",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e){if(!e.val()||i.isUrl(e.val())){return[]}return[{field:e,msg:t("url.invalid")}]}})});AGN.Lib.Controller.new("custom-thumbnail-view",function(){this.addAction({change:"use-custom-thumbnail"},function(){var e=$("#customThumbnailFile");e.prop("name",this.el.is(":checked")?"customThumbnailFile":"")});this.addAction({change:"custom-thumbnail-image"},function(){var t=this.el;var e=t.prop("files");if(e&&e.length){var i=e[0];if(i.type=="image"||i.type.match("image/.*")){var n=new FileReader;n.onload=function(e){r(t,i.name,e.target.result)};n.readAsDataURL(i)}else{AGN.Lib.Helpers.clearFormField(t);r(t,"","")}}else{r(t,"","")}});function r(e,t,i){var n;n=e.data("preview-name");if(n){$(n).text(t)}n=e.data("preview-image");if(n){if(i){$(n).prop("src",i)}else{$(n).each(function(){var e=$(this);e.prop("src",e.data("no-preview-src")||"")})}}}});AGN.Lib.Controller.new("emc-template-preview-controller",function(){this.addDomInitializer("emc-template-preview-initializer",function(){if($('[name="view-state"]').length){e()}});function e(){$("#preview").find(".tile-header").removeAttr("data-sizing");$("#previewTabsMenu").replaceWith('<h2 class="headline">'+t("defaults.previewMode")+"</h2>")}});AGN.Lib.Controller.new("emm-activeness",function(){let r=false;let o;this.addDomInitializer("emm-activeness",function(){o=this.config.urls.SAVE});this.addAction({change:"toggle-active"},function(){const e=$(this.el);const t=AGN.Lib.Table.get(e);const i=e.data("item-id");const n=e.is(":checked");if(r){e.prop("checked",!n);return}r=true;$.ajax(AGN.url(o),{method:"POST",traditional:false,data:{activeness:{[i]:n}}}).done(e=>{if(e&&e.success===true){s(t,i,n)}AGN.Lib.JsonMessages(e.popups)}).fail(()=>{s(t,i,!n);e.prop("checked",!n);AGN.Lib.Messages.defaultError()}).always(()=>r=false)});function s(e,t,i){const n=a(e,t);n.activeStatus=i?"ACTIVE":"INACTIVE";e.api.applyTransaction({update:[n]})}function a(e,n){const r=[];e.api.forEachNodeAfterFilterAndSort(function(e,t){const i=e.data.id;if(i===n){r.push(e.data)}});return r[0]}});AGN.Lib.Controller.new("enlarged-content-editor-controller",function(){var i=AGN.Lib.Modal;var n=AGN.Lib.Confirm;var r;this.addDomInitializer("enlarged-content-editor-initializer",function(e){var t=i.get(e);r=t.content;l(t.editorType);o()});function o(){if(a()==="html"){u()}else{d()}}this.addAction({click:"updateContent"},function(){var e=$(this.el);var t=n.get(e);t.positive(s());$("#enlarged_content_modal").modal("toggle")});var s=function(){return{content:e(),editorType:a()}};var e=function(){var e=$("#tab-enlargedContent-wysiwyg");var t=$("#enlargedContentEditor");if(e.is(":visible")){var i=CKEDITOR.instances["enlargedContent"];return i.getData()}if(t.is(":visible")){var n=ace.edit("enlargedContentEditor");return n.getValue()}};var a=function(){var e=$("#tab-enlargedContent-wysiwyg");if(e.is(":visible")){return"wysiwyg"}var t=$("#enlargedContentEditor");if(t.is(":visible")){return"html"}return""};var l=function(e){if(!e||e===""){return}var t=$('[data-toggle-tab$="'+e+'"]');if(t){t.trigger("click")}};const c=function(e){const i=e.val().length;$('[data-enlarged-char-counter-for="'+e.attr("id")+'"]').find("span:first").text(t("fields.content.charactersEntered",i))};this.addAction({"editor:create":"count-enlarged-textarea-chars","editor:change":"count-enlarged-textarea-chars"},function(){c(this.el)});this.addAction({click:"hide-enlarged-char-counter"},function(){d()});this.addAction({click:"show-enlarged-char-counter"},function(){u()});function u(){$("[data-enlarged-char-counter-for]").first().show()}function d(){$("[data-enlarged-char-counter-for]").first().hide()}});AGN.Lib.Controller.new("export-view",function(){var e;var i;var o;var r;this.addDomInitializer("export-view",function(){e=this.config.adminHasOwnColumnPermission;o=this.config.bounceUserStatusCode;f();if(e){t(h(this.config.customColumns))}});this.addAction({click:"save"},function(){p()});this.addAction({click:"evaluate"},function(){p()});this.addAction({change:"add-bounce-col-to-choose"},f);this.addAction({click:"add-column-mapping",enterdown:"mapping-enterdown"},function(){var e=AGN.Lib.Form.get($("#exportForm"));var t=c().find("[data-column-name]");this.event.preventDefault();if(e.valid({})){if(t.val()){e.cleanErrors();l();n("","");c().find("[data-column-name]").focus()}else{t.focus()}}else{e.handleErrors()}});this.addAction({click:"delete-column-mapping"},function(){this.el.closest("tr").remove()});function t(e){r=$("#columnMappings tbody");i=AGN.Lib.Template.prepare("column-mapping-table-row");_.each(e,function(e){n(e.dbColumn,e.defaultValue)});n("","");if(!AGN.Lib.Form.get($("#exportForm")).editable){r.find(":input, button").prop("disabled",true);r.find("a").attr("disabled","disabled")}}function s(e){return e.find("[data-column-name]").val().trim()}function a(e){return e.find("[data-column-value]").val().trim()}function n(e,t){r.append(i({name:e,value:t}))}function l(){var e=r.find('[data-action="add-column-mapping"]');e.after("<a href='#' class='btn btn-regular btn-alert' data-action='delete-column-mapping'>"+"<i class='icon icon-trash-o'></i></a>");e.remove()}function c(){return r.find("[data-column-mapping-row]:last-child")}function u(){var n=[];_.each(r.find("[data-column-mapping-row]"),function(e){var t=$(e);var i=s(t);if(i){n.push([i,a(t)])}});return n}function d(i){_.each(u(),function(e,t){i.setValue("customColumns["+t+"].dbColumn",e[0]);i.setValue("customColumns["+t+"].defaultValue",e[1])})}function h(e){return e.sort(function(e,t){if(e.dbColumn<t.dbColumn){return-1}if(e.dbColumn>t.dbColumn){return 1}return 0})}function f(){var e=$("#mailing-bounce-column-option");var t=$("#recipient-export-recipientstatus").find(":selected").val();if(t==o){e.removeAttr("disabled")}else{var i=$('[name="userColumns"]');var n=i.val();var r=n.filter(function(e){return e!="mailing_bounce"});i.val(r);i.trigger("change");e.attr("disabled","disabled")}}function p(){var e=AGN.Lib.Form.get($("#exportForm"));if(e.valid({})){d(e);e.submit()}else{e.handleErrors()}}});AGN.Lib.Controller.new("facebook-leadads",function(){var i=AGN_FACEBOOK.Login,s=AGN_FACEBOOK.LeadAds,e=AGN_FACEBOOK.SDK,a=AGN.Lib.Select;var l={};this.addDomInitializer("facebook-leadads",function(){l=this.config;AGN.Lib.Storage.delete("fblst_"+l.FACEBOOK_LEADADS_APP_ID);e.load_sdk(l.FACEBOOK_LEADADS_APP_ID,c)});var n=function(e){$("#mailinglistId").prop("disabled",!e)};var r=function(e){$("#doiMailingId").prop("disabled",!e)};var o=function(e){$('[data-action="connect-page"]').prop("disabled",!e)};var c=function(){var e=function(e){var i=function(){AGN.Lib.Messages(t("defaults.error"),t("messages.error.reload"),"alert")};u();s.list_manageable_pages(e,l.URL.LIST_FACEBOOK_PAGE_BINDINGS_AJAX_URL,"#facebook-pages-table",i)};i.attach_login_function(".facebook-login-btn",e,"pages_read_engagement, leads_retrieval");u()};var u=function(){i.doByLoginStatus(h,d)};var d=function(){a.get($("#mailinglistId")).selectFirstValue();n(false);r(false);o(false);$(".facebook-login-btn").removeClass("hidden")};var h=function(e){$(".facebook-login-btn").addClass("hidden");n(true);s.list_manageable_pages(e,l.URL.LIST_FACEBOOK_PAGE_BINDINGS_AJAX_URL,"#facebook-pages-table");$('[data-action="connect-page"]').data("fbAccessToken",e);s.renew_page_access_tokens(e,l.URL.RENEW_FACEBOOK_PAGE_ACCESS_TOKENS_AJAX_URL,function(e){var i=JSON.parse(e);if(i.count>0){AGN.Lib.Messages(t("defaults.success"),t("facebook.leadAds.renewedPageAccessTokens",i.count),"success")}})};this.addAction({change:"mailinglist-change"},function(){o(false);r(false);var e=$(this.el);var t=a.get(e).getSelectedValue();f(t);r(t!==0)});var f=function(e){var i=a.get($('[data-action="doi-mailing-change"]'));i.resetOptions();i.setOptions([{id:0,text:"---"}]);i.selectFirstValue();if(e!==0){r(false);$.ajax({url:l.URL.LIST_ACTIONBASED_AJAX_URL,type:"GET",data:{mailinglist:e},success:function(e){if(e){var t=_.map(e.mailings,function(e){console.log("mailing "+e.id+": "+e.shortname);return{id:e.id,text:e.shortname}});t.unshift({id:0,text:"---"});i.setOptions(t);i.selectFirstValue()}},error:function(e,i,n){console.log("status = "+i+", error = "+n);AGN.Lib.Messages(t("defaults.error"),t("messages.error.reload"),"alert")},statusCode:{500:function(){if(!!onError){onError()}}}})}};this.addAction({change:"doi-mailing-change"},function(){var e=$(this.el);var t=a.get(e).getSelectedValue();o(t>0)});this.addAction({click:"connect-page"},function(){var e=$(this.el);var i=e.data("fbAccessToken");var n=function(){s.list_manageable_pages(i,l.URL.LIST_FACEBOOK_PAGE_BINDINGS_AJAX_URL,"#facebook-pages-table");AGN.Lib.Messages(t("defaults.success"),t("defaults.saved"),"success")};var r=a.get($('[data-action="mailinglist-change"]')).getSelectedValue();var o=a.get($('[data-action="doi-mailing-change"]')).getSelectedValue();s.connect_pages(i,l.URL.CONNECT_FACEBOOK_PAGE_BINDINGS_AJAX_URL,"#facebook-pages-table",r,o,n,null,function(e){if(!!e){e.page_names.forEach(function(e){AGN.Lib.Messages(t("facebook.leadAds.error.already_bound_to_other_company"),e,"alert")})}})})});AGN.Lib.Controller.new("form-trackable-links",function(){this.addAction({submission:"save-all"},function(){const e=AGN.Lib.Form.get($("#userFormTrackableLinksForm"));t(e,"commonExtensions",$("#links-common-extensions"));e.submit()});this.addAction({submission:"save-individual"},function(){const e=AGN.Lib.Form.get($("#userFormTrackableLinkForm"));t(e,"extensions",$("#link-extensions"));e.submit()});function t(i,n,e){const t=e.data("table").collect();_.each(t,function(e,t){i.setValueOnce(n+"["+t+"].name",e.name);i.setValueOnce(n+"["+t+"].value",e.value)})}});AGN.Lib.Controller.new("grid-building-block-defaults",function(){var i=AGN.Lib.Confirm,r=AGN.Lib.Form,n=AGN.Lib.Page,c=AGN.Lib.Helpers;var u;this.addDomInitializer("grid-building-block-defaults",function(){u=this.config;$("img[id^=preview]").each(function(){var e=$(this);var t=e.attr("src");if(t){var i=f(t);if(i!==t){e.attr("src",$.trim(i))}}e.style("display","")});e()});function e(){u.placeholders.filter(function(e){return e.placeholderType===u.CHECK_PLACEHOLDER_TYPE}).forEach(function(e){const t=$('<div id="'+e.id+'-children" class="col-sm-offset-1 col-sm-11" data-show-by-checkbox="#content-'+e.id+'"></div>');t.insertAfter($("#content-"+e.id).closest(".form-group"));e.options.split(",").forEach(function(e){t.append($(".ph-"+e))})});AGN.Lib.CoreInitializer.run("checkbox-hider",$("#defaultsForm"))}function d(e){var t=e.closest("[data-placeholder-id]");if(t.exists()){return parseInt(t.data("placeholder-id"))}else{return 0}}function o(e){var t=$("#file-"+e);if(t.exists()){return!!t.val()}else{return false}}function s(e,t){var i=e.prop("files");var n=$("#content-"+t);var r=$("#image-category-"+t).closest(".form-group");if(i&&i.length){var o=i[0];if(o.type==="image"||o.type.match("image/.*")){var s=new FileReader;s.onload=function(e){r.removeClass("hidden");h(t,e.target.result,o.name,o.name)};s.readAsDataURL(o)}else{r.addClass("hidden");c.clearFormField(e);h(t)}}else{r.addClass("hidden");h(t)}n.val("")}function a(t){i.request(u.urls.MEDIAPOOL_IMAGE_PICK).done(function(e){$("#content-"+t).val(e.id);c.clearFormField($("#file-"+t));h(t,e.src,e.name,e.title)})}function l(e){var t=$("#file-"+e);var i=$("#file-name-"+e);var n=$("#content-"+e);var r=$("#preview-"+e);c.clearFormField(t);i.text("");n.val("");r.attr("src",u.noPreviewImageLink)}function h(e,t,i,n){var r=$("#preview-"+e);var o=$("#file-name-"+e);if(r.attr("src")!==t){r.attr("src",t||u.noPreviewImageLink)}r.attr("title",n||"");o.text(i||"")}function f(e){return c.replaceAgnTags(e,function(e,t){if(e.name==="agnIMAGE"&&e.attributes["name"]){if(!e.attributes["source"]||e.attributes["source"]==="mediapool"||e.attributes["source"]==="mediapoolbg"){return u.imageByFilenameSrcPattern.replace(":filename:",encodeURIComponent(e.attributes["name"]))}}return t})}var p=_.throttle(function(e,t){var i=$("#preview-"+e);if(i.attr("src")!==t){if(t){i.attr("src",$.trim(f(t)))}else{i.attr("src",t||u.noPreviewImageLink)}}},300);function g(){var i=$.Deferred();var s=[];var e=$("#defaultsForm");var a=r.get(e);var l=true;e.find("input[type=file]").each(function(){var e=$(this);var i=d(e);var n=$("#image-category-"+i);var r=e.prop("files");if(r&&r.length){var o=n.val();if(o>0){s.push({placeholderId:i,image:r[0],categoryId:o});a.cleanFieldError$(n)}else{l=false;a.showFieldError$(n,t("error.grid.noCategorySelected"))}}else{a.cleanFieldError$(n)}});if(l){if(s.length){var n=new FormData;s.forEach(function(e,t){n.append("images["+t+"].file",e.image);n.append("images["+t+"].fileName",e.image.name);n.append("images["+t+"].title",e.image.name);n.append("images["+t+"].categoryId",e.categoryId)});$.ajax(u.urls.MEDIAPOOL_IMAGE,{type:"POST",dataType:"json",accepts:["application/json"],enctype:"multipart/form-data",processData:false,contentType:false,data:n}).done(function(e){if(e.success===true){e.data.forEach(function(e,t){var i=s[t].placeholderId;$("#content-"+i).val(e);c.clearFormField($("#file-"+i))});i.resolve()}else{AGN.Lib.JsonMessages(e.popups);i.reject()}}).fail(function(){i.reject()})}else{i.resolve()}}else{i.reject()}return i.promise()}this.addAction({click:"delete"},function(){var e=$.post(u.urls.CONFIRM_DELETE);return i.request(e).done(function(e){if(e.success===true){n.reload(u.urls.BACK,true).done(function(){AGN.Lib.JsonMessages(e.popups)})}else{AGN.Lib.JsonMessages(e.popups)}})});this.addAction({click:"chooseImage"},function(){var e=d(this.el);if(e>0){if(o(e)){$("#file-"+e).trigger("click")}else{a(e)}}});this.addAction({click:"showMediapoolDialog"},function(){var e=d(this.el);if(e>0){a(e)}});this.addAction({change:"chooseImageFile"},function(){var e=d(this.el);if(e>0){s(this.el,e)}});this.addAction({click:"deleteImage"},function(){var e=d(this.el);if(e>0){l(e)}});this.addAction({change:"previewImageLink",keyup:"previewImageLink",mouseup:"previewImageLink"},function(){var e=d(this.el);if(e>0){p(e,$.trim(this.el.val()))}});this.addAction({click:"chooseImageLink"},function(){var e=d(this.el);if(e>0){$("#content-"+e).trigger("focus")}});this.addAction({click:"save"},function(){g().done(function(){$("#defaultsForm").submit()})})});AGN.Lib.Controller.new("grid-building-block",function(){var t=AGN.Lib.Confirm,i=AGN.Lib.Page;var n;this.addDomInitializer("grid-building-block",function(){n=this.config});this.addAction({click:"delete"},function(){var e=$.post(n.urls.CONFIRM_DELETE);return t.request(e).done(function(e){if(e.success===true){i.reload(n.urls.BACK,true).done(function(){AGN.Lib.JsonMessages(e.popups)})}else{AGN.Lib.JsonMessages(e.popups)}})})});AGN.Lib.Controller.new("grid-building-blocks-new",function(){var i=AGN.Lib.Confirm,n=AGN.Lib.Form;var s;var a={setSaveButtonEnabled:function(e){var t=$("#save-button");if(e){t.removeClass("disabled")}else{t.addClass("disabled")}},getActivenessToggles:function(){return $("#containers").find("input.js-activeness-toggle")},getActivenessTogglesMap:function(){var t={};a.getActivenessToggles().each(function(){var e=$(this);t[e.data("container-id")]=e});return t},getActivenessTogglesStateMap:function(){var t={};a.getActivenessToggles().each(function(){var e=$(this);t[e.data("container-id")]=e.prop("checked")});return t},getBulkIds:function(){var t=[];$("#containers").find(".js-bulk-ids:checked").each(function(){var e=parseInt($(this).val());if(e>0){t.push(e)}});return t.length?t:null},resetBulkIds:function(){$("#containers").find(".js-bulk-ids").prop("checked",false)}};function r(){this.map={}}r.prototype.include=function(e,t){this.map[e]=t};r.prototype.exclude=function(e){delete this.map[e]};r.prototype.excludeAll=function(e){for(var t=0;t<e.length;t++){delete this.map[e[t]]}};r.prototype.clear=function(){this.map={}};r.prototype.size=function(){return Object.keys(this.map).length};r.prototype.get=function(){return _.clone(this.map)};function o(r,o){var e={};if(arguments.length<2){o=true}else{o=!!o}for(var t=0;t<r.length;t++){e[r[t]]=o}return l(e).done(function(e){if(e.success===true){var t=a.getActivenessTogglesMap();for(var i=0;i<r.length;i++){var n=r[i];t[n].prop("checked",o);s.activenessInitialStateMap[n]=o}s.activenessChangeMap.excludeAll(r);a.resetBulkIds();a.setSaveButtonEnabled(s.activenessChangeMap.size()>0)}})}function l(e){return $.post(s.urls.SET_ACTIVENESS,{activeness:e}).done(function(e){AGN.Lib.JsonMessages(e.popups)})}function c(e){var t=$.post(s.urls.CONFIRM_DELETE.replace(":containerId:",e));return i.request(t).done(function(e){AGN.Lib.JsonMessages(e.popups)})}function u(e){var t=$.ajax(s.urls.CONFIRM_BULK_DELETE,{method:"POST",traditional:true,data:{bulkIds:e}});return i.request(t).done(function(e){AGN.Lib.JsonMessages(e.popups)})}this.addDomInitializer("grid-building-blocks-new",function(){s=this.config;if(location.hash){var e=parseInt(location.hash.substr(1));if(e>0){var t=$("#containers");var i=t.find('[data-container-id="'+e+'"]').closest("tr");if(i.exists()){var n=i.position().top;t.scrollTop(n-10)}}}s.activenessChangeMap=new r;s.activenessInitialStateMap=a.getActivenessTogglesStateMap()});this.addAction({click:"save"},function(){var t=n.get(this.el);l(s.activenessChangeMap.get()).done(function(e){if(e.success===true){s.activenessChangeMap.clear();s.activenessInitialStateMap=a.getActivenessTogglesStateMap();a.setSaveButtonEnabled(false);t.submit()}})});this.addAction({change:"toggle-activated"},function(){var e=$(this.el);var t=e.data("container-id");var i=e.is(":checked");if(s.activenessInitialStateMap[t]==i){s.activenessChangeMap.exclude(t)}else{s.activenessChangeMap.include(t,i)}a.setSaveButtonEnabled(s.activenessChangeMap.size()>0)});this.addAction({click:"delete-building-block"},function(){var e=this.el.data("container-id");var t=n.get(this.el);if(e>0){c(e).done(function(e){if(e.success===true){t.submit()}})}});this.addAction({click:"bulk-delete"},function(){var e=a.getBulkIds();var i=n.get(this.el);if(e){u(e).done(function(e){if(e.success===true){i.submit()}})}else{AGN.Lib.Messages(t("Error"),t("messages.error.nothing_selected"),"alert")}});this.addAction({click:"bulk-export"},function(){const e=a.getBulkIds();const i=n.get(this.el);if(e){i.setActionOnce(s.urls.BULK_EXPORT);i.setValueOnce("bulkIds",e);i.submit("static")}else{AGN.Lib.Messages(t("Error"),t("messages.error.nothing_selected"),"alert")}});this.addAction({click:"bulk-activate"},function(){var e=a.getBulkIds();var i=n.get(this.el);if(e){o(e,true).done(function(e){if(e.success===true){i.submit()}})}else{AGN.Lib.Messages(t("Error"),t("messages.error.nothing_selected"),"alert")}});this.addAction({click:"bulk-deactivate"},function(){var e=a.getBulkIds();var i=n.get(this.el);if(e){o(e,false).done(function(e){if(e.success===true){i.submit()}})}else{AGN.Lib.Messages(t("Error"),t("messages.error.nothing_selected"),"alert")}});this.addAction({click:"back"},function(){history.back()})});AGN.Lib.Controller.new("grid-edit",function(){const t=this,i=AGN.Lib.Form;this.addDomInitializer("grid-edit",function(){t.isGridInUse=this.config.isGridInUse;t.maxColumnsCount=this.config.maxColumnsCount;t.gridView=new AGN.Lib.GridView($("[data-grid-view]"));t.gridColumnView=new AGN.Lib.GridColumnView($("[data-column-view]"));t.updateViews()});this.addAction({submission:"createTemplate"},function(){$("#templateCreationForm").submit()});this.addAction({submission:"saveGrid"},function(){const e=$("#gridForm");i.get(e).submit()});this.addAction({change:"updateColnum"},function(){t.validateRequiredNumber(this.el,1,t.maxColumnsCount);$('[name="columnWidth"]').val(t.calculateColumnWidth());t.updateViews()});this.addAction({change:"updateTemplateWidth"},function(){t.validateRequiredNumber(this.el,50,2e3);$('[name="columnWidth"]').val(t.calculateColumnWidth());t.updateViews()});this.addAction({change:"updateColumnWidth"},function(){t.validateRequiredNumber(this.el,10,2e3);$('[name="templateWidth"]').val(t.calculateTemplateWidth());t.updateViews()});this.addAction({change:"updateGutterWidth"},function(){t.validateRequiredNumber(this.el,0,500);$('[name="columnWidth"]').val(t.calculateColumnWidth());t.updateViews()});this.addAction({click:"enableEditing"},function(){$(this.el).hide();$('[name="gridName"]').prop("disabled",false);if(!t.isGridInUse){$.each(["columnNum","columnWidth","gutter","templateWidth"],function(e,t){const i=$('[name="'+t+'"]');i.prop("disabled",false);i.attr("type","number")})}$("#createTemplateButton").addClass("hidden");$("#saveAndCreateTemplateButton").removeClass("hidden");$("#gridForm").attr("data-action","saveGrid")});this.addAction({click:"back"},function(){window.history.back()});this.validateRequiredNumber=function(e,t,i){const n=parseInt(e.val());if(n!=e.val()||n<t){e.val(t)}if(n>i){e.val(i)}};this.updateViews=function(){const e={columnNum:this.columnNum(),columnWidth:this.columnWidth(),gutter:this.gutterWidth(),templateWidth:this.templateWidth()};t.gridView.update(e);t.gridColumnView.update(e)};this.calculateColumnWidth=function(){return Math.floor(this.templateWidth()/this.columnNum()-this.gutterWidth())};this.calculateTemplateWidth=function(){return Math.ceil((this.columnWidth()+this.gutterWidth())*this.columnNum())};this.columnNum=function(){return parseInt($('[name="columnNum"]').val())};this.columnWidth=function(){return parseInt($('[name="columnWidth"]').val())};this.gutterWidth=function(){return parseInt($('[name="gutter"]').val())};this.templateWidth=function(){return parseInt($('[name="templateWidth"]').val())}});AGN.Lib.Controller.new("grid-overview",function(){var c;this.addDomInitializer("grid-overview",function(e){c=this.config;e.all(".card[data-grid-id]").each(function(){var e=$(this);var t=c.grids[parseInt(e.data("grid-id"))];var i=[],n=165/90,r=1e3,o=r/n,s=t.columnWidth*r/t.templateWidth,a=t.gutter*r/t.templateWidth,l;if(e.find("svg").exists()){return}e.find(".js-grid").append('<svg class="grid-preview" viewBox="0 0 '+r+" "+o+'"></svg>');_.times(t.columnNum,function(e){i.push({type:"gutter",width:a/2});i.push({type:"col",width:s});i.push({type:"gutter",width:a/2})});_.reduce(i,function(e,t){t.xPos=e;return e+t.width},0);l=d3.select(e.find("svg")[0]).selectAll("g").data(i).enter().append("g").attr("transform",function(e){return"translate("+e.xPos+",0)"});l.append("rect").attr("class",function(e){return"grid-preview-"+e.type}).attr("width",function(e){return e.width}).attr("height",o)})});this.addAction({click:"back"},function(){history.back()});this.addAction({click:"pick"},function(){var e=c.grids[this.el.data("grid-id")];if(e){$.ajax(e.viewLink,{method:"POST",data:{newTemplateName:c.newTemplateName}}).done(function(e){AGN.Lib.Page.render(e)})}});this.addAction({submission:"createNewGrid"},function(){var e=this.el;var i=AGN.Lib.Form.get(e);var n=e.find("#newGridName");$.ajax(c.urls.CHECK_NAME,{type:"GET",data:{name:n.val()}}).done(function(e){if(e.used){i.showFieldError("newGridName",t("fields.name.errors.name_in_use"))}else{i.submit("static")}})})});AGN.Lib.Controller.new("grid-template",function(){var i;var n;var r=new h;var o=AGN.Lib.Storage;var s;var a;var l;this.addDomInitializer("grid-template",function(){var e=this.config;n=this.el;i=new d(n,e)});this.addDomInitializer("grid-template-css",function(){s=this.config.templateId;a=this.config.previewWidths;l=this.config.previewMediaQueries;const e=$('[name="previewSize"]');o.restoreChosenFields(e);if(e.is(":checked")===false){e.filter("[value=1]").prop("checked",true)}c()});function c(){const e=$(".template-preview-wrapper");e.empty();var t=$("#layoutPreviewForm");var i=parseInt($("input[name=previewSize]:checked").val());var n=a[i]+2;e.append('<div>           <div id="layout-preview-container" class="center-block">               <iframe name="layoutPreviewFrame" id="layoutPreviewFrame"                     class="mailing-preview-frame js-simple-iframe" border="0"                     data-max-width="'+n+'" data-media-query="'+l[i]+'"                     style="width:'+n+'px;">                   Your Browser does not support IFRAMEs, please update!               </iframe>           </div>       </div>');AGN.Lib.CoreInitializer.run("iframe");u(t,i);t.submit()}function e(){$("#layoutPreviewForm").find('input[name="css"]').val($("#cssContents").val())}this.addAction({click:"update-css-preview"},function(){o.saveChosenFields($("input[name=previewSize]:checked"));e();c()});function u(e,t){const i=e.find('input[name="previewSize"]');if(i.length>0){i.remove()}e.append('<input type="hidden" name="previewSize" value="'+t+'" />')}this.addAction({submission:"grid-template-validation"},function(){i.validateTemplateName(n.find("#newTemplateName"))});this.addAction({click:"back"},function(){history.back()});this.addAction({click:"delete"},function(){var e=this;var t=e.el;var n="";if(t.prop("tagName")=="A"){n=t.prop("href")}else{n=t.data("url")}var i=$.get(n);i.done(function(e){var t=$(e),i;i=t.filter(".modal").add(t.find(".modal"));if(i.length!=1){AGN.Lib.Page.render(e,n);return}AGN.Lib.Confirm.create(e).done(function(e){AGN.Lib.Page.render(e,n)})});e.event.preventDefault();return false});function d(e,t){this.templateNameValidationUrl=t.templateNameValidationUrl;this.form=AGN.Lib.Form.get(e)}d.prototype.validateTemplateName=function(e){var i=e.val();var n=this.form;var r=this.templateNameValidationUrl;if(i==""){n.showFieldError("newTemplateName",t("fields.required.errors.missing"))}else{$.ajax({type:"GET",url:r,data:{newTemplateName:i}}).done(function(e){if(e.newTemplateName==false){n.showFieldError("templateName",t("fields.name.errors.name_in_use"))}else{n.submit("static")}})}};this.addAction({click:"update-preview"},function(){var e=this.el;r.updateInputValue(e.data("target-form"),e.data("content-type"))});function h(){this.contentTypes={css:{inputSelector:'input[name="css"]',contentId:"#cssContents"},outerHtml:{inputSelector:'input[name="outerHtml"]',contentId:"#templateOuterHTML"},styles:{inputSelector:'input[name^="styles["]',getContentSelector:function(e){return'input[name="'+e+'"]'}}}}h.updateFields=function(e,n,r){var t=$("form").not("#"+r.attr("id"));_.each(t.find(e),function(e){var t=$(e);var i=t.val();r.find(n(t.attr("name"))).val(i)})};h.updateField=function(e,t,i){i.find(e).val(t)};h.prototype.updateInputValue=function(e,t){var i=this.contentTypes[t];var n=$(e);if(t=="styles"&&i&&n){h.updateFields(i.inputSelector,i.getContentSelector,n)}else if(i&&n){var r=$(i.contentId).val();h.updateField(i.inputSelector,r,n)}n.submit()}});AGN.Lib.Controller.new("img-editor",function(){const n=AGN.Lib.Form;let i,r;let o=0,s=0;let e;let a;let l;let c;this.addDomInitializer("img-editor",function(){l=document.getElementById("editor-canvas");c=l.getContext("2d");e=$("#editor-img").attr("src");t();L().prop("disabled",true)});function t(){a=new Image;a.src=$("#editor-img").attr("src");a.onload=function(){l.width=a.width;l.height=a.height;c.drawImage(a,0,0);M();u();d();I()}}function u(e,t){const i=t?.size?.width||l.width;const n=t?.size?.height||l.height;S().val(Math.round(i));x().val(Math.round(n))}function d(){$("#img-percent").val(100)}this.addAction({click:"crop"},async function(){C("crop");if(!T()){R();return}await h()});async function h(){if(o<=1||s<=1){return}const e=function(e,t){e.width=o;e.height=s;t.drawImage(a,i,r,o,s,0,0,o,s)};await p(e);R()}this.addAction({click:"resize"},async function(){await h();C("resize");k()});async function f(e,i){const t=function(e,t){e.width=i.size.width;e.height=i.size.height;t.drawImage(a,0,0,i.size.width,i.size.height)};await p(t)}async function p(e){await g();const t=document.createElement("canvas");const i=t.getContext("2d");e(t,i);l.width=t.width;l.height=t.height;c.clearRect(0,0,l.width,l.height);c.drawImage(t,0,0);await g();d()}async function g(t){await new Promise(e=>{a.src=l.toDataURL();if(!t){L().prop("disabled",false)}a.onload=e})}this.addAction({click:"rotate-clockwise"},m);async function m(){await y(false)}this.addAction({click:"rotate-counterclockwise"},v);async function v(){await y(true)}async function y(i){C();const e=function(e,t){e.width=l.height;e.height=l.width;t.translate(e.width/2,e.height/2);t.rotate((i?-1:1)*Math.PI/2);t.drawImage(a,-a.width/2,-a.height/2)};await p(e);I()}this.addAction({click:"flip-horizontally"},b);async function b(){await w(false)}this.addAction({click:"flip-vertically"},_);async function _(){await w(true)}async function w(e){await g();C();c.clearRect(0,0,l.width,l.height);c.save();if(e){c.scale(1,-1);c.drawImage(a,0,-l.height)}else{c.scale(-1,1);c.drawImage(a,-l.width,0)}c.restore();d();await g()}function C(e){if(e!=="crop"){H()}if(e!=="resize"){B()}}this.addAction({input:"change-size"},A);this.addAction({input:"change-size-via-percentage"},P);function P(){A(true)}function x(){return $("#img-height")}function S(){return $("#img-width")}function A(e){C();let{newWidth:t,newHeight:i}=e?G():F();l.width=t;l.height=i;c.save();c.drawImage(a,0,0,t,i);c.restore();x().val(i);S().val(t);I();L().prop("disabled",false)}function F(){const e=a.width;const t=a.height;let i=S().val();let n=x().val();if($("#img-width").is(":focus")){const r=i/e;n=Math.round(r*t)}else if($("#img-height").is(":focus")){const r=n/t;i=Math.round(r*e)}return{newWidth:i,newHeight:n}}function G(){const e=$("#img-percent").val();const t=a.width;const i=a.height;const n=Math.round(t*(e/100));const r=Math.round(i*(e/100));return{newWidth:n,newHeight:r}}function E(e,t){$(`[data-action="${e}"]`).toggleClass("active",t)}function H(){R(false)}function T(){return!!D()}function D(){return $("#editor-canvas").data("Jcrop")}function R(e){if(e===undefined){e=!T()}if(!e){j()}else{z()}E("crop",e)}function M(){if(O().resizable("instance")){O().resizable("destroy")}O().resizable({handles:"ne, se, sw, nw, w, n, e, s",stop:f,resize:u,disabled:true})}function B(){k(false)}function k(e){if(e===undefined){e=V()}O().resizable(e?"enable":"disable");E("resize",e)}function O(){return $("#editor-canvas")}function V(){const e=O();return e.resizable("instance")&&e.resizable("option","disabled")}function j(){const e=D();if(typeof e!="undefined"){e.destroy();M();I()}o=0;s=0}function z(){O().Jcrop({onChange:N,onSelect:N,setSelect:[0,0,l.width,l.height]})}function N(e){i=e.x;r=e.y;o=e.w;s=e.h}function I(){const e=O();const t=$(".ui-wrapper");e.css("width",l.width);e.css("height",l.height);t.css("width",l.width);t.css("height",l.height);u()}function L(){return $('[name="encodedFile"]')}this.addAction({click:"save"},async function(){await h();await g(true);const e=L();let t=l.toDataURL();const i=t.indexOf(",");if(i>=0){t=t.substring(i+1)}if(e.val()!=t){e.val(t)}n.get(this.el).submit()});this.addAction({"upload:add":"replace"},function(){C();const e=new FileReader;e.readAsDataURL(this.data.file);e.onload=function(e){$("#editor-img").attr("src",e.target.result);t();L().prop("disabled",false)}});this.addAction({click:"reset"},function(){C();$("#editor-img").attr("src",e);t();L().prop("disabled",true)})});AGN.Lib.Controller.new("import-profile",function(){const n=AGN.Lib.Template;const i=AGN.Lib.Modal;const r=AGN.Lib.Messages;const o=AGN.Lib.Form;const G=AGN.Lib.Select;const s=AGN.Lib.CoreInitializer;const a="agn:db-column";let l;let c;let u;let d;let h;let e;let f;let p;let g;this.addDomInitializer("import-profile-view",function(){l=v().prop("disabled");d=this.config.availableGenderIntValues;U(W(this.config.genderMappings));m()});this.addAction({click:"save"},function(){if(b(w(y()))){const e=o.get(this.el);H(e);Y(e);e.submit()}});this.addAction({change:"change-new-recipients-action"},function(){m()});this.addAction({change:"allMailinglists-toggle"},function(){m()});this.addAction({change:"change-mode"},function(){const e=$("#allMalinglistsCheckbox");if(!e.exists()){return}if(!e.parent().is(":visible")){e.prop("checked",false).trigger("change")}});function m(){const e=$("#import_actionnewrecipients");const t=$("#allMalinglistsCheckbox");const i=e.exists()&&e.val()>0;const n=t.exists()&&t.is(":checked");v().prop("disabled",i||l||n);if(t.exists()){const r=i||l;t.prop("disabled",r);t.parent().toggleClass("hidden",r)}}function v(){return $("#recipient-mailinglists")}function H(i){_.each(B(),(e,t)=>{i.setValue(`genderMapping[${t}]`,e)})}function B(){const r={};_.each(u.find("[data-gender-settings-row]"),e=>{const t=$(e);const i=C(t);const n=V(t);if(i.length){r[n]=!r.hasOwnProperty(n)?i:r[n]+", "+i}});return r}function V(e){const t=e.find("[data-gender-int-value]");return t.is("select")?t.val():t.text()[0]}this.addAction({click:"delete-gender-mapping"},function(){const e=this.el.closest("[data-gender-settings-row]");if(e.is(":first-child")){const t=e.next("[data-gender-settings-row]");t.find(".form-label").removeClass("hidden")}e.remove()});this.addAction({click:"add-gender-mapping",enterdown:"gender-enterdown"},function(){this.event.preventDefault();if(j()){z();x("","");y().find("[data-gender-text-value]").focus()}});function j(){const e=w(y());if(e.size<1){r.alert("import.gender.error.empty");return false}return b(e)}function y(){return u.find("[data-gender-settings-row]:last-child")}function b(t){const i=u.find("[data-gender-settings-row]").toArray();for(let e=0;e<i.length-1;e++){if(_.intersection(Array.from(t),Array.from(w($(i[e])))).length){r.alert("import.gender.error.duplicate");return false}}return true}function w(e){const t=C(e);const i=t.length?t.split(","):[];return new Set(_.without(_.map(i,_.trim),""))}function C(e){const t=e.find("[data-gender-text-value]");if(t.is("input")){return t.val().trim()}return t.text().trim()}function z(){const e=u.find('[data-action="add-gender-mapping"]');e.after(`
        <a href='#' class='btn btn-danger btn-icon-sm' data-action='delete-gender-mapping'>
            <i class='icon icon-trash-alt'></i>
        </a>
    `);e.remove()}const W=t=>{if(!t){t=""}const e=Object.keys(t).map(e=>[e,t[e]]);e.sort((e,t)=>e[1]-t[1]);return e};function U(e){u=$("#gender-mappings-block");c=n.prepare("gender-settings-table-row");_.each(e,function(e){x(e[0],e[1])});x("","")}function x(e,i){const n=u.find("[data-gender-settings-row]").length;const r=_.map(d,e=>({value:e,selected:i==e,title:t(`import.gender.short.${e}`)}));u.append(c({intValue:i,textValues:e,mappingsCount:n,genders:r}));s.run("select",u.find("[data-gender-int-value]:last-child"))}let S;function Y(i){if(E()){return}_.each(R(true),(e,t)=>{i.setValueOnce("columnsMappings["+t+"].id",e.id);i.setValueOnce("columnsMappings["+t+"].fileColumn",e.fileColumn);i.setValueOnce("columnsMappings["+t+"].databaseColumn",e.databaseColumn);i.setValueOnce("columnsMappings["+t+"].mandatory",e.mandatory);i.setValueOnce("columnsMappings["+t+"].encrypted",e.encrypted);i.setValueOnce("columnsMappings["+t+"].defaultValue",e.defaultValue)})}this.addAction({change:"change-auto-mapping"},function(){A()});this.addDomInitializer("import-profile-mappings",function(){S=this.config;if(S){e=S.columnMappings;h=S.doNotImportValue;f=S.columns;g=$("#column-mappings-block");N(e);A()}});function A(){const e=$("#manage-fields-tile");const t=E();e.find(".tile-controls").toggleClass("hidden",t);$("[data-mapping-db-column]").prop("disabled",t);$("[data-mappings-actions]").toggleClass("hidden",t);$("#upload-mappings-btn").prop("disabled",t);$("#uploadFile").prop("disabled",t)}function E(){return $("#import_automapping").is(":checked")}this.addAction({click:"upload-column-mappings"},function(){const e=o.get(this.el);$.ajax(S.urls.READ,{type:"POST",dataType:"json",enctype:"multipart/form-data",processData:false,contentType:false,data:e.data()}).done(e=>{if(e.success===true){N(q(e.data))}else{AGN.Lib.JsonMessages(e.popups)}})});function q(e){const i=R();const t=i.filter(e=>!e.fileColumn);const n=e.map(t=>{const e=i.find(e=>e.fileColumn===t.fileColumn);return e!==undefined?e:t});return[].concat(n,t)}this.addAction({change:"select-all-columns-mappings"},function(){$("[data-mapping-checkbox]").prop("checked",this.el.prop("checked"));T()});this.addAction({change:"select-column-mapping"},function(){T()});this.addAction({click:"bulk-mappings-delete"},function(){_.each($("[data-mapping-checkbox]:checked"),e=>M($(e)));T()});function T(){const e=$("[data-mapping-checkbox]").is(":checked");$("#bulk-mappings-delete-btn").toggleClass("hidden",!e)}this.addAction({change:"change-database-column"},function(){const e=this.el.data(a);const t=this.el.val();k(e);P(t);this.el.data(a,t);if(this.el.closest("[data-mapping-row]").is("[data-mapping-new]")){K(t)}});this.addAction({change:"set-today-date"},function(){$("#dateInput").toggleClass("hidden",this.el.is(":checked"));$("#daysInput").toggleClass("hidden",!this.el.is(":checked"));const r=$("#daysCount");r.on("change.offset keyup.offset",function(e){const t=r.val();if(t){const i=parseInt(t);if(!isNaN(i)){const n=(i<0?"":"+")+i;if(n!=t){r.val(n)}}else{r.val(t.replace(/[^\d+-]/g,""))}}else if(e.type==="change"){r.val("+0")}})});function K(e){if(!g.parents("table").exists()){return}const t=Q(e);const i=g.find("[data-mapping-defaultValue]").last();const n=i.val();const r=i.closest("td");if(r.children().first().data("type")!==t){r.empty();r.append(Z(t,n));X(r,t)}}function X(e,t){if(t==="date"){AGN.runAll(e)}else if(t==="datetime"){_.each(e.find("[data-field]"),function(e){AGN.Lib.Field.create($(e))})}}function Z(e,t){switch(e){case"date":case"datetime":return n.text("date-def-val-input",{withTime:e==="datetime",val:t});default:return n.text("text-def-val-input")}}function Q(e){const t=f[e].dataType.toLowerCase();switch(t){case"date":case"datetime":return t;default:return"text"}}this.addAction({click:"show-column-mappings"},function(){const e=R();const t=i.fromTemplate("column-mappings-modal");t.on("modal:close",()=>{g=$("#column-mappings-block");p=n.prepare("column-mapping-row")});g=$("#extended-column-mappings-block");N(e,true);s.run("table",g.closest("table"))});this.addAction({click:"save-extended-mappings"},function(){if(!D(this.el)){return}const e=R(true);g=$("#column-mappings-block");N(e);i.getInstance(this.el).hide()});this.addAction({click:"add-column-mapping"},function(){if(this.el.closest("table").exists()&&!D(this.el)){return}const e=this.el.closest("[data-mapping-row]");const i=ee(e);if(J(i)){r.alert(t("export.columnMapping.error.duplicate"));return}e.remove();i.index=ne()+1;F(i);I();L()});function D(e){const t=o.get(e);t.validatorOptions={$mappingsBlock:g};if(!t.valid()){t.handleErrors();return false}t.cleanFieldFeedback();return true}function J(t){if(t.databaseColumn===h){return false}const e=R();return e.some(e=>{return e.fileColumn===t.databaseColumn||e.databaseColumn===t.databaseColumn})}function R(e=false){if(!g||!g.exists()){return[]}const t=_.map(g.find("[data-mapping-row]"),function(e){const t=$(e);return{id:O(t,"id"),fileColumn:O(t,"fileColumn"),databaseColumn:O(t,"db-column"),mandatory:O(t,"mandatory"),encrypted:O(t,"encrypted"),defaultValue:O(t,"defaultValue")}});const i=t[t.length-1];if(!e||h===i.databaseColumn){t.pop()}return t}function ee(e){const t=e.find("[data-mapping-mandatory]");const i=e.find("[data-mapping-encrypted]");return{id:0,fileColumn:"",databaseColumn:e.find("[data-mapping-db-column]").val(),mandatory:t.exists()?t.is(":checked"):false,encrypted:i.exists()?i.is(":checked"):false,defaultValue:te(e)}}function te(e){if(e.find("[data-action=set-today-date]").is(":checked")){const t=parseInt($("#daysCount").val()||0);const i=t===0?"":t>0?`+${t}`:t;return`CURRENT_TIMESTAMP${i}`}return e.find("[data-mapping-defaultValue]").val()}this.addAction({click:"delete-column-mapping"},function(){M(this.el);T()});function M(e){const t=e.closest("[data-mapping-row]");const i=O(t,"db-column");if(t.is(":first-child")){const n=t.next("[data-mapping-row]");n.find(".form-label").removeClass("hidden")}t.remove();k(i)}function k(t){if(t&&t!==h){_.each(g.find("[data-mapping-db-column]"),e=>{ie($(e),t)})}}function ie(e,t){if(e.val()!==t){G.get(e).addOption(t)}}function O(e,t){const i=e.find(`[data-mapping-${t}]`);if(i.is(":checkbox")){return i.is(":checked")}return i.val()}function N(t,e=false){if(!g.exists()){return}g.empty();p=n.prepare(e?"column-mapping-row-extended":"column-mapping-row");for(let e=0;e<t.length;e++){const i=t[e];i.index=e;F(i)}I();L();g.find("[data-mapping-db-column]").each(function(){const e=$(this);e.data(a,e.val())})}function I(){F({index:-1,id:0,fileColumn:"",databaseColumn:"",mandatory:false,encrypted:false,defaultValue:""})}function L(){g.find("[data-mapping-db-column]").each(function(){P($(this).val())})}function P(t){g.find("[data-mapping-db-column]").each(function(){const e=$(this);if(e.val()!==t&&t!==h){e.find(`[value="${t}"]`).remove()}})}function ne(){return $("[data-mapping-row]").last().data("mapping-row")}function F(e){e.isFirstMapping=g.find("[data-mapping-row]").length==0;const t=$(p(e));g.append(t);AGN.runAll(t)}});AGN.Lib.Controller.new("layout-builder",function(){const e=AGN.Lib.Form,i=AGN.Lib.Action,n=AGN.Lib.AutoSave,o=AGN.Lib.EndlessScroll;let r;let s;let a="";window.onbeforeunload=function(e){const i=t("grid.layout.leaveQuestion");e=e||window.event;if(s&&s.isChanged()){if(e){e.returnValue=i}return i}AGN.Lib.Loader.show()};this.addDomInitializer("layout-builder",function(){r=$("#grid-components-tab");if(!s){s=new AGN.Lib.LB.Editor;AGN.Lib.LB.Definitions.EDITOR=s}const i=this.config;AGN.Lib.LB.Definitions.IS_BASIC_LB=i.IS_BASIC_LB;const e=function(e){var t=$.extend(i,{children:e.children});l(t);s.setChanged(true)};const t=n.initialize(`template-components/${i.templateId}`,_.bind(s.getDataForAutoSave,s),_.bind(s.checkIfDataRestoreNeeded,s),e,0);t.fail(()=>l(i));s.controlRssBtn();$(document).on("tile:show",function(e){const t=AGN.Lib.LB.ChildEditor.get();if(!t){return}const i=$(e.target);if(t.get$().find(i).exists()){t.notifyTabChanged(i)}})});function l(e){s.setup(e);new AGN.Lib.EndlessScroll(r,AGN.url(`/layoutbuilder/template/${s.getTemplateId()}/activeBuildingBlocks.action`),{loader:"#building-blocks-loader",onLoad:e=>{c(e);f()}})}function c(e,i=true){e.each(function(){const e=$(this);const t=e.find("[data-div-cache]");if(i){AGN.Lib.LB.Child.set(e,new AGN.Lib.LB.ChildSample(t.json()))}else{AGN.Lib.LB.Child.set(e,new AGN.Lib.LB.Child(t.json()))}if(s.isEditable()){e.draggable(AGN.Lib.LB.ChildSample.draggableOptions())}t.remove()})}this.addAction({click:"update-available-blocks"},function(){const e=this.el.attr("href");$.get(e).done(e=>{AGN.Lib.Confirm.create(e).done(()=>{o.get(r).load()})})});this.addAction({change:"visibleTargets"},function(){if(s.isEditable()){s.setTargetId(parseInt(this.el.val()))}});this.addAction({"select2:open":"visibleTargets"},function(){if(!s.isEditable()){return}setTimeout(()=>u(this.el),0)});function u(e){const o=e.data("select2");const i=o.dropdown.$dropdown;const t=i.find(".select2-results__options");const n=i.css("min-width");const r=i.outerWidth();i.find(".select2-results__option").each(function(){const e=$(this);if(o.dataAdapter.item(e).id>AGN.Lib.LB.Definitions.ALL_RECIPIENTS){e.addClass("sortable")}});t.sortable({items:".select2-results__option.sortable",containment:"parent",tolerance:"pointer",distance:5,opacity:.4,cursor:"move",start:function(e,t){i.css("min-width",r);t.item.removeClass("select2-results__option--selectable")},stop:function(e,t){i.css("min-width",n);t.item.addClass("select2-results__option--selectable")},update:function(e,t){const i=d(o,t.item);const n=t.item.prev();const r=t.item.next();if(n.exists()){d(o,n).after(i)}else if(r.exists()){d(o,r).before(i)}s.setLayeringByTargets(AGN.Lib.LB.Ui.getAvailableTargetIds())}})}function d(e,t){return $(e.dataAdapter.item(t).element)}this.addAction({"select2-close":"visibleTargets"},function(){if(!s.isEditable()){return}this.el.data("select2").dropdown.$dropdown.find(".select2-results__options").sortable("destroy")});this.addAction({click:"approve"},function(){h(true,this.el)});this.addAction({click:"unapprove"},function(){h(false,this.el)});function h(e,t){if(s.isEditable()){const i=$("[data-template-released-toggle]");i.addClass("disabled");$.post(t.data("url"),{approved:!e}).done(e=>{if(e.success){AGN.Lib.LB.Ui.setShown(t,false);AGN.Lib.LB.Ui.setShown(i.not(t),true);s.setChanged(true)}AGN.Lib.JsonMessages(e.popups);i.removeClass("disabled")})}}this.addAction({click:"clear-recycle-bin"},function(){if(!s.isEditable()){return}const e=s.getRecycledChildren();if(e.length){$.ajax(this.el.attr("href"),{method:"POST",traditional:true,data:{children:e}}).done(e=>{if(e.success){s.clearRecycleBin()}})}else{s.clearRecycleBin()}});this.addAction({click:"deleteRow"},function(){if(s.isEditable()){s.removeRow(AGN.Lib.LB.Row.get(this.el));f()}});this.addAction({click:"clone"},function(){if(s.isEditable()){var e=AGN.Lib.LB.Child.get(this.el);if(e){s.cloneChild(e)}}});this.addAction({click:"remove"},function(){if(s.isEditable()){var e=AGN.Lib.LB.Child.get(this.el);if(e){s.removeChild(e);f()}}});this.addAction({change:"previewImageSrc",keyup:"previewImageSrc",mouseup:"previewImageSrc"},function(){if(s.isEditable()){AGN.Lib.LB.ChildEditor.get().updateImageSrc(this.el)}});this.addAction({change:"chooseImageFile"},function(){if(s.isEditable()){AGN.Lib.LB.ChildEditor.get().updateImage(this.el,false)}});this.addAction({change:"changeImageCategory"},function(){if(s.isEditable()){const e=this.el.data("placeholder-id");AGN.Lib.LB.ChildEditor.get().syncImageCategories(e,this.el.val());AGN.Lib.LB.ChildEditor.get().savePlaceholder(e)}});this.addAction({change:"chooseMobileImageFile"},function(){if(s.isEditable()){AGN.Lib.LB.ChildEditor.get().updateImage(this.el,true)}});this.addAction({click:"chooseImage"},function(){if(s.isEditable()){var e=this.el.data("placeholder-id");AGN.Lib.LB.ChildEditor.get().chooseImage(e)}});this.addAction({click:"deleteImage"},function(){if(s.isEditable()){const e=this.el.data("placeholder-id");AGN.Lib.LB.ChildEditor.get().deleteImage(e,false)}});this.addAction({click:"deleteMobileImage"},function(){if(s.isEditable()){const e=this.el.data("placeholder-id");AGN.Lib.LB.ChildEditor.get().deleteImage(e,true)}});this.addAction({click:"showMediapoolDialog"},function(){if(s.isEditable()){var e=this.el.data("placeholder-id");AGN.Lib.LB.ChildEditor.get().showMediapoolDialog(e)}});this.addAction({change:"set-toc-item"},function(){if(s.isEditable()){AGN.Lib.LB.ChildEditor.get().setTocItem(this.el.is(":checked"))}});this.addAction({change:"use-toc-item"},function(){if(s.isEditable()){AGN.Lib.LB.ChildEditor.get().updateToC()}});this.addAction({change:"child-target-change"},function(){if(s.isEditable()){AGN.Lib.LB.ChildEditor.get().updateChildTarget(parseInt(this.el.val()))}});this.addAction({change:"change-interest-group"},function(){if(s.isEditable()){AGN.Lib.LB.ChildEditor.get().updateChildInterestGroup()}});this.addAction({change:"savePlaceholder"},function(){if(s.isEditable()){AGN.Lib.LB.ChildEditor.get().savePlaceholder(this.el.data("ph-id"))}});this.addAction({"ckeditor-save":"save-text-ph"},function(){if(s.isEditable()){AGN.Lib.LB.ChildEditor.get().savePlaceholder(this.el.data("ph-id"))}});this.addAction({change:"changeContentPool"},function(){const e=$("#grid-contentpool-tab");const t=e.find("[data-no-found-blocks-msg]");const i=parseInt(this.el.val());if(i>0){const n=o.get(e);const r=AGN.url(`/mailing/${i}/buildingBlocks.action`);if(n){n.load(r)}else{new o(e,r,{loader:"#building-blocks-loader",onLoad:e=>{c(e,false);f()}})}}else{e.find(".lb-building-blocks").empty()}AGN.Lib.LB.Ui.setShown(t,i===0)});this.addAction({keyup:"search-building-blocks"},function(){a=this.el.val().toLowerCase();f()});function f(){const e=$("#building-blocks-tile");e.find("[data-building-block]").each(function(){const e=$(this);const t=e.find("[data-building-block-name]").text();e.toggleClass("hidden",!t.toLowerCase().includes(a))});e.find(".tile-body").each(function(){const e=$(this);const t=e.find("[data-building-block]:not(.hidden)").length>0;e.find("[data-no-found-blocks-msg]").toggleClass("hidden",t);if(a.length>0){e.scrollTop(0)}})}this.addAction({submission:"save-content"},function(){if(s.isEditable()){var e=false;if(s.isTextVersionGenerationAllowed()){var t=$("#update-text-version:checked");e=t.length>0}s.saveMadeChoice(e);s.save(e)}});this.addAction({click:"import-from-content-source"},function(){(new AGN.Lib.LB.RssImporter).import()});i.new({"form:loadershow":"form"},function(){AGN.Lib.LB.Ui.setLoading(true)});i.new({"form:loaderhide":"form"},function(){AGN.Lib.LB.Ui.setLoading(false)})});AGN.Lib.Controller.new("lb-template-list",function(){this.addAction({submission:"grid-template-validation"},function(){const i=AGN.Lib.Form.get(this.el);const e=$("#newTemplateName").val();if(e==""){i.showFieldError("newTemplateName",t("fields.required.errors.missing"));return}$.get(AGN.url("/layoutbuilder/template/validateTemplateName.action"),{newTemplateName:e}).done(e=>{if(e.newTemplateName==false){i.showFieldError("templateName",t("fields.name.errors.name_in_use"))}else{i.submit("static")}})})});AGN.Lib.Controller.new("logon-password-change",function(){this.addAction({click:"showPasswordChangeForm"},function(){$("#suggestion-view").addClass("hidden");$("#submission-view").removeClass("hidden")})});AGN.Lib.Controller.new("mailing-upload-attachment",function(){this.addAction({change:"change-attachment-file"},function(){e(false)});this.addAction({change:"change-upload-file"},function(){e(true)});this.addAction({change:"use-pdf"},function(){e(this.el.is(":checked"))});function e(e){let t="";if(e){t=AGN.Lib.Select.get($("#pdfUploadId")).getSelectedText()}else{const i=$("#attachmentFile").prop("files");if(i&&i.length){t=i[0].name}}$("#attachmentName").val(t)}});AGN.Lib.Controller.new("mailing-content-controller",function(){const i=t("defaults.leaveQuestion");const n=AGN.Lib.Template;const r=AGN.Lib.Messages;const e=AGN.Lib.AutoSave;const o=AGN.Lib.Storage;const s=AGN.Lib.Select;const a=AGN.Lib.Form;let l;let c;let u;let d;this.addDomInitializer("mailing-content-initializer",function(){c=this.config;u=$("#dyn-tag-settings");l=new x(c.dynTags,c.targetGroupList,c.interestGroupList);C();e.initialize(`mailing/${c.mailingId}/content-blocks`,h,p,f);b($(".dyn-tag:first").data("dyn-tag-id"))});this.addDomInitializer("gridTemplate-textContent-initializer",function(){c=this.config;u=$("#dyn-tag-settings");c.isEditableMailing=true;l=new x(this.config.dynTags,this.config.targetGroupList,[],[]);b($(".dyn-tag:first").data("dyn-tag-id"))});function h(){y();return l.dynTags.filter(e=>e.modified).map(e=>e.lightWeight)}function f(e){e.forEach(e=>{const t=l.getDynTagById(e.id);t.interestGroup=e.interestGroup;t.contentBlocks=e.contentBlocks.map(e=>new A(e))});d.trigger("tile:hide");b(e[0].id)}function p(i){return i.some(e=>{const t=l.getDynTagById(e.id);return g(t,i)})}function g(e,i){return i.interestGroup!==e.interestGroup||e.contentBlocks.length!==i.contentBlocks.length||e.contentBlocks.some(e=>{const t=i.getContentBlockByTargetId(e.targetId);return!t||t.content!==e.content})}function m(){$("#dyn-tag-list .dyn-tag").each((e,t)=>v($(t)))}function v(e){const t=e.data("dyn-tag-id");const i=l.getDynTagById(t).isEmpty;e.find(".status-badge").toggleClass("mailing.status.has-content",!i).toggleClass("mailing.status.no-content",i)}this.addAction({click:"switch-dyn-tag"},function(){let e=u.data("conf")?.dynTag;if(e&&!e.isValid){this.event.preventDefault();return}y();b(this.el.data("dyn-tag-id"))});function y(){d?.trigger("dynTags:modify")}function b(e){const t=l.getDynTagById(e);const i=w(t);d=n.dom("content-editor-template",i);u.html(d);u.data("conf",i);AGN.Lib.Controller.init(u);AGN.runAll(u);m()}function w(e){return{dynTag:e,targetGroups:_.cloneDeep(l.targetGroups),isFullHtmlTags:e.name==="HTML-Version",showHTMLEditor:e.isHtmlDynTag,isEditableMailing:c.isEditableMailing,isContentGenerationAllowed:c.isContentGenerationAllowed}}this.addAction({click:"save"},function(){if(l.dynTags.some(e=>!e.isValid)){return}y();const e=l.dynTags.filter(e=>e.modified);$.post({url:this.el.data("url"),contentType:"application/json",data:JSON.stringify(e)}).done(e=>AGN.Lib.Page.render(e))});this.addAction({click:"edit-content-modal"},function(){y();if(l.modified&&!window.confirm(i)){return}const e=c.isEmailMediaTypeActive||c.isMailingGrid;AGN.Lib.Modal.fromTemplate("modal-editor",{showText:e,showHtml:e&&c.mailFormat!==0&&!c.isMailingGrid,showSms:c.isSmsMediaTypeActive})});$(window).on("beforeunload",function(){y();if(l.modified){AGN.Lib.Loader.hide();return i}});const C=function(){const e=$("#content-source-select");if(!e){return}const t="web-storage#last-content-source";const i=o.get(t);if(i){if(s.get(e).hasOption(i.id)){e.val(i.id);e.change()}else{o.delete(t)}}};this.addAction({click:"save-content"},function(){let e=$("#content-form");if(!a.get(e).validate()){return}a.get($("#frame-content-form")).submit().done(e=>AGN.Lib.Page.render(e))});class x{constructor(e,i,n){this.dynTags=Object.entries(e).map(function(e){return new S(e[1])},[]);this.interestGroups=_.cloneDeep(n);this.interestGroups.unshift({column:"",shortname:t("mailing.default.interest_group_name")});this.targetGroups=_.cloneDeep(i);this.targetGroups.unshift({id:0,targetName:t("mailing.default.target_group_name")});this.targetGroupsMap=i.reduce(function(e,t){e[t.id]=t;return e},{})}get modified(){return this.dynTags.some(e=>e.modified)}getDynTagById(t){return this.dynTags.filter(e=>e.id===t)[0]}setDynTag(e){const t=this.getDynTagById(e.id);const i=this.dynTags.indexOf(t);if(i>-1){this.dynTags[i]=e.clone()}}getTargetGroupById(e){return this.targetGroupsMap[e]||{id:0,targetName:t("mailing.default.target_group_name")}}}class S{constructor(e){this.id=e.id||0;this.name=e.dynName===undefined?e.name:e.dynName;this.mailingId=e.mailingID===undefined?e.mailingId:e.mailingID;this.interestGroup=this.interestGroup||"";this.interestGroup=e.interestValue===undefined?e.interestGroup:e.dynInterestGroup;if(e.contentBlocks){this.contentBlocks=e.contentBlocks.map(function(e){return new A(e)})}else{this.contentBlocks=Object.entries(e.dynContent).map(function(e){return new A(e[1])})}this.initState=_.cloneDeep(this.lightWeight)}get defaultContentBlock(){return{id:0,index:0,targetId:0,content:""}}get modified(){const e=!this.initState.contentBlocks.length;if(e&&this.isEmpty&&this.contentBlocks.length===1&&this.contentBlocks[0].targetId===0){return false}return!_.isEqual(this.initState,this.lightWeight)}getContentBlockByTargetId(t){return this.contentBlocks.filter(e=>e.targetId===t)[0]}getContentBlockById(t){return this.contentBlocks.filter(e=>e.uniqueId===t)[0]}createNewContentBlock(e=0){const t=new A(this.defaultContentBlock);t.index=this.contentBlocks.length;t.targetId=e;this.contentBlocks.push(t);this.recalculateIndexes();return t}changeTargetGroup(e,t){const i=this.getContentBlockById(e);i.targetId=t;return i}changeContent(e,t){const i=this.getContentBlockById(e);i.content=t||"";return i}changeOrder(e){const t=function(t){return function(e){return t.getContentBlockById(parseInt(e))}};this.contentBlocks=e.map(t(this));this.recalculateIndexes()}remove(e){const t=this.getContentBlockById(e);const i=this.contentBlocks.indexOf(t);if(i>-1){this.contentBlocks.splice(i,1);this.recalculateIndexes()}}clone(){return new S(this)}get isEmpty(){return this.contentBlocks.every(e=>!e.content)}recalculateIndexes(){this.contentBlocks.forEach((e,t)=>e.index=t+1)}get isValid(){const e=this.collectDynTagErrors();e?.forEach(e=>r.alert(e));return!e?.length}collectDynTagErrors(){const e=[];const t=this.contentBlocks.map(e=>e.targetId);if(new Set(t).size!==t.length){e.push("mailing.validation.target_group_duplicated")}if(t.includes(0)&&_.last(t)!==0){e.push("mailing.validation.all_recipients_not_last")}if(this.isHtmlDynTag&&this.contentBlocks.find(e=>this.#containsIllegalElements(e))){e.push("fields.error.illegal_script_element")}return e}get isHtmlDynTag(){return c.htmlDynTagNames?.includes(this.name)}#containsIllegalElements(e){return(new DOMParser).parseFromString(e,"text/html").querySelector("script")}get lightWeight(){return{id:this.id,interestGroup:this.interestGroup,contentBlocks:this.contentBlocks.map(e=>e.lightWeight)}}}class A{constructor(e){if(typeof A.uniqueIdCounter==="undefined"){A.uniqueIdCounter=0}this.uniqueId=++A.uniqueIdCounter;this.id=e.id;this.index=e.dynOrder===undefined?e.index:e.dynOrder;this.content=e.dynContent===undefined?e.content:e.dynContent;this.targetId=e.targetID===undefined?e.targetId:e.targetID}get lightWeight(){const{id:e,content:t,targetId:i}=this;return{id:e,content:t,targetId:i}}}});AGN.Lib.Controller.new("mailing-content-editor-controller",function(){const n=AGN.Lib.Template;const r=AGN.Lib.Select;const t=".mailingContentNamespace";const o=".target-row";const s="content_entry_";const i='[data-action="edit-content-for-target"]';let a;let l;let c;let u;function d(){$("#enlargeable-settings").on("enlarged",function(e){$(e.target).closest(".modal-body").css("overflow","hidden")})}function h(e){e.on("dynTags:modify",function(){v();e.trigger("tile:hide")})}this.addDomInitializer("mailing-content-editor-initializer",function(e){const t=$("#dyn-tag-settings").data("conf");a=t.dynTag;l=$("#targets-order");c=$("#target_groups");u=$("#interest_groups");g();b(a);_(a.interestGroup);d();h(e)});function f(){l.find(i).removeClass("disabled");let e=$(`${o}.selected`);e=e.exists()?e:$(`${o}:first`);e.find(i).addClass("disabled")}this.addAction({click:"edit-content-for-target"},function(){if(!a.isValid){return}const e=$(this.el);const t=A(e);const i=a.getContentBlockById(t);E(i)});this.addAction({click:"deleteContentEntry"},function(){this.event.stopPropagation();var e=$(this.el).parent();var t=A(e);var i=e.next(o);i=i.length>0?i:e.prev(o);a.remove(t);e.remove();if(a.contentBlocks.length>0){var n=A(i);var r=a.getContentBlockById(n);E(r)}else{E()}T()});this.addAction({click:"addDynContent"},M);function p(e){const t=e.sortable("toArray");const i=t.map(function(e){return e.replace(s,"")});a.changeOrder(i)}function g(){l.sortable({delay:10,scroll:true,scrollSensitivity:30,scrollSpeed:5,handle:".target-row-handle",cursor:"move",items:o,stop:e=>p($(e.target))})}var m=function(t,e){const i=$("#tab-content-wysiwyg");const n=$("#contentEditor");const r=$("#tab-content-ai-text-generation");if(i.is(":visible")){var o=CKEDITOR.instances["content"];if(o.status==="ready"){o.setData(t)}else{o.on("instanceReady",function(e){e.editor.setData(t)})}}if(n.is(":visible")){var s;if(e===false){s=1}else{s=null}var a=ace.edit("contentEditor");if($("body").hasClass("dark-theme")){a.setTheme("ace/theme/idle_fingers")}a.setValue(t,s)}if(r.is(":visible")){r.closest("form").find(".js-wysiwyg").val(t)}};var v=function(){var e=C();if(e>0){var t=$("#tab-content-wysiwyg");var i=$("#contentEditor");var n;if(t.is(":visible")){var r=CKEDITOR.instances["content"];n=r.getData()}if(i.is(":visible")){var o=ace.edit("contentEditor");if($("body").hasClass("dark-theme")){o.setTheme("ace/theme/idle_fingers")}n=o.getValue()}if(n!==undefined){a.changeContent(e,n)}}};function y(e,t){const i=n.dom("mailing-target-content-template",{targetId:e,id:s+t.uniqueId});AGN.Lib.CoreInitializer.run("select",i);return i}function b(e){e.contentBlocks.reverse().forEach(function(e){l.prepend(y(e.targetId,e))});if(a.contentBlocks.length>0){E(a.contentBlocks[0],false)}else{M()}T();R();D()}function _(e){u.val(e).trigger("change");u.off("change"+t);u.on("change"+t,e=>a.interestGroup=$(e.target).val())}var w=function(){return l.find(o+".selected")};var C=function(){var e=w();if(e.length>0){return A(e)}};var x=function(e){l.children().removeClass("selected");const t=S(e,l);t.addClass("selected")};var S=function(e,t){t=t?t:$(document);return t.find("#"+s+e)};function A(e){return parseInt(e.closest(o).attr("id").replace(s,""))}this.addAction({change:"change-target"},function(){if(this?.data?.programmatic){return}a.changeTargetGroup(A(this.el),parseInt(this.el.val()));T()});function E(e,t){v();if(e!==undefined){x(e.uniqueId);m(e.content,t)}else{m("")}f();R()}function e(){return $("#targets-order").find("select").map((e,t)=>$(t).val())?.toArray()}function T(){const n=e();$("#targets-order-box").find("select").each(function(e,t){const i=r.get($(t));i.disableOptions(n)});r.get(c).disableOptions(n,true)}function D(){l.find('select option[value="0"]:selected').closest(o).appendTo(l);p(l)}function R(){l.animate({scrollTop:l[0].scrollHeight},100)}function M(){const e=parseInt(c.val());const t=a.createNewContentBlock(e);l.append(y(e,t));E(t);R();D();T()}});AGN.Lib.Controller.new("mailing-images",function(){const o=AGN.Lib.Modal;const s=AGN.Lib.Template;const i=AGN.Lib.Form;this.addAction({"upload:add":"image-upload"},function(){const e=this.data.file;const t=this.data.index;let i=$("#components-upload-modal");if(!i.exists()){i=o.fromTemplate("userform-images-upload-modal-template");i.on("modal:close",c)}const n=i.find("#components-uploads-container");const r=s.dom("mailing-upload-image",{index:t,fileName:e.name,previewUrl:l(e),isArchive:a(e)==="zip"});n.append(r);AGN.runAll(r)});function a(e){if(e.name&&e.name.includes(".")){return e.name.substring(e.name.lastIndexOf(".")+1).toLowerCase()}return""}function l(e){if(/^image/.test(e.type)){return URL.createObjectURL(e)}return""}function c(){$("#upload-files").val("");$("#dropzone").trigger("upload:reset")}this.addAction({click:"upload-images"},function(){const e=i.get(this.el);const t=o.getWrapper(this.el);e.$form.on("submitted",()=>{if(document.contains(t[0])){t.css("opacity",1)}});e.submit();t.css("opacity",0)})});AGN.Lib.Controller.new("mailing-overview",function(){const e=AGN.Lib.Form;const i=AGN.Lib.DateFormat;const o=[{key:"isgrid",text:t("mailing.default.grid"),class:"mailing.status.emc"},{key:"isCampaignManager",text:t("workflow.icon"),class:"mailing.status.cm"}];this.addDomInitializer("mailing-overview",function(){r(e.getWrapper(this.el));n(this.config.badgesFilters)});function n(t){if(!t){t=[]}const i=$("#status-filter");const n=AGN.Lib.Select.get(i);_.each(o,e=>{i.append(`<option value="${e.key}" data-badge-class="${e.class}">${e.text}</option>`);if(t.includes(e.key)){n.selectOption(e.key)}});const r=e.get(i);r.get$().on("form:submit",()=>{let t=0;_.each(o,e=>{if(n.isOptionSelected(e.key)){r.setValueOnce(`filterBadges[${t++}]`,e.key);n.$findOption(e.key).attr("disabled",true)}})});r.get$().on("submitted",()=>{o.forEach(e=>{n.$findOption(e.key).attr("disabled",false)})})}function r(e){e.off("form:submit");e.off("submitted")}this.addAction({click:"restore"},function(){const t=e.get(this.el);$.post(this.el.attr("href")).done(e=>t.updateHtml(e))});this.addAction({click:"bulk-restore"},function(){const t=e.get(this.el);$.ajax(AGN.url("/mailing/bulkRestore.action"),{method:"POST",data:t.data()}).done(e=>t.updateHtml(e))});this.addAction({click:"send-date-filter-period"},function(){u(this.el);s(l(),c());a($("input[name='sendDatePeriod']:checked").length>0)});this.addAction({click:"reset-send-date-filter"},function(){s("","");$('input[name="sendDatePeriod"]:checked').removeAttr("checked");a(false)});function s(e,t){$("#filterSendDateBegin").val(e).trigger("change");$("#filterSendDateEnd").val(t).trigger("change")}function a(e){$("#filterSendDateBegin").get(0).toggleAttribute("readonly",e);$("#filterSendDateEnd").get(0).toggleAttribute("readonly",e)}function l(){const e=$("input[name='sendDatePeriod']:checked").val();if(!e){return""}const t=new Date;t.setDate(t.getDate()-e);return i.format(t,window.adminDateFormat)}function c(){return $("input[name='sendDatePeriod']:checked").length?i.format(new Date,window.adminDateFormat):""}function u(e){if(e.is(":checked")){const t=`input:checkbox[name="${e.attr("name")}"]`;$(t).prop("checked",false);e.prop("checked",true)}else{e.prop("checked",false)}}});AGN.Lib.Controller.new("mailing-parameters",function(){var n=0;this.addDomInitializer("mailing-parameters",function(){var e=this.config;n=e.maxIndex});this.addAction({click:"add-mailing-parameter"},function(){var e=$("#mailingParamsTable tr:last");var t=AGN.Lib.Template.text("mailing-param-row-new",{key:++n});e.after(t);var i=e.find("#newMailingParameterBtn");i.after('<a href="#" class="btn btn-regular btn-alert" data-action="remove-mailing-parameter" id="removeMailingParameterBtn"> <i class="icon icon-trash-o"></i> </a>');i.remove()});this.addAction({click:"remove-mailing-parameter"},function(){var e=this.el.closest("tr");e.remove()})});AGN.Lib.Controller.new("mailing-params",function(){let e=$("#mailingSettingsForm");let t;let i=$("#mailingParamsTable");this.addDomInitializer("mailing-params",function(){t=this.config.params;e=$("#mailingSettingsForm");e.dirty("setAsClean");e.dirty("refreshEvents");i.on("input-table:row-removed",n)});function n(){if(o()&&!r()){e.dirty("setAsClean")}}function r(){const e=t.map(function(e){const t=_.omit(e,"mailingID","mailingInfoID","changeDate");Object.keys(t).forEach(function(e){if(t[e]===null){t[e]=""}});return t});return JSON.stringify(e)!==JSON.stringify(i.data("table").collect())}function o(){return e.dirty("showDirtyFields").filter((e,t)=>!$(t).closest("#mailingParamsTable").length).length===0}});AGN.Lib.Controller.new("mailing-predelivery",function(){var n={aol:"aolonelinespam",yahoo:"yahoospam",gmailnew:"gmailnewspam",ol2003:"ol2003spam"};this.addAction({change:"adjustSpamProvider"},function(){var e=$(this.el);var t=n[e.attr("name")];if(!t){return}var i=$('[name="'+t+'"]');if(e.prop("checked")){i.prop("disabled",false)}else{i.prop("disabled",true);i.prop("checked",false)}});this.addInitializer("readjustSpamProviders",function(){_.each(n,function(e,t){var i=$("[name="+t+"]");if(i.length===0){return}var n=$('[name="'+e+'"]');if(i.prop("checked")){n.prop("disabled",false)}else{n.prop("disabled",true);n.prop("checked",false)}})});function e(e,t){var i=e.closest(".list-group").find('input[type="checkbox"]:enabled');i.prop("checked",t);i.trigger("change")}this.addAction({click:"toggle-checkboxes-on"},function(){e($(this.el),true)});this.addAction({click:"toggle-checkboxes-off"},function(){e($(this.el),false)})});AGN.Lib.Controller.new("mailing-preview",function(){const i=AGN.Lib.Form;const n=AGN.Lib.Storage;const e=AGN.Lib.Messages;const r=AGN.Lib.Helpers;const o=AGN.Lib.Select;const s=["customerATID","customerEmail","modeType","targetGroupId"];let a;let l=false;this.addDomInitializer("mailing-preview",function(e){a=this.config.MAILING_ID;c();var t=i.get(this.el);if(t.getValue("reload")=="false"){t.setValue("reload",true);t.submit().done(()=>{$("[data-stored-field]").on("change",function(){const e=$(this);n.saveChosenFields(e);l=l||u(e)});t.initFields();t.initValidator();d()})}});this.addAction({change:"refresh-preview",click:"update-preview"},function(){l=false;t()});this.addAction({change:"change-stored-header-data"},function(){if(l){l=false;t()}});this.addAction({change:"change-header-data"},function(){t()});function t(){const e=i.get($("#preview-form"));e.setValue("reload",false);e.submit()}function c(){$("[data-stored-field]").each(function(){n.restoreChosenFields($(this))})}function u(e){const t=e.prop("name");return t&&s.includes(t)}function d(){h();p()}this.addAction({click:"change-preview-customer-options"},function(){p()});function h(){const e=f();if(!e.exists()){return}const t=e.val().length<=0;$("#personalized-test-run-container").toggleClass("hidden",t)}function f(){return $("#personalized-test-recipients")}function p(){const e=g();const t=o.get(f()).getSelectedValue().indexOf(e)===-1;$('[data-action="add-to-personalized-test-run"]').toggle(!!t)}function g(){if(m()){return $("#customerEmail").val()}return $('[name="customerATID"]').find(":selected").data("email")}function m(){return $('[name="modeType"]').val()==="MANUAL"}function v(){return new Promise(function(t,i){const n=g();if(!r.isValidEmail(n)){e.alert("defaults.invalidEmail");return}$.get(AGN.url(`/mailing/preview/${a}/isRecipient.action`),{email:n}).done(e=>{if(e.success){t(n)}else{AGN.Lib.JsonMessages(e.popups,true);i()}})})}this.addAction({input:"change-personalized-test-recipients",change:"change-personalized-test-recipients"},function(){d()});this.addAction({click:"add-to-personalized-test-run"},function(){v().then(e=>{const t=f();const i=o.get(t);if(!i.hasOption(e)){i.addOption(e)}i.selectOptions(_.union(t.val(),[e]));d()})});this.addAction({click:"personalized-test-run"},function(){const t=f();const e=t.val();$.post(AGN.url(`/mailing/send/${a}/personalized-test.action`),{mailingTestRecipients:e}).done(e=>{if(e&&e.success===true){t.val([]);AGN.Lib.CoreInitializer.run("select",t);h()}AGN.Lib.JsonMessages(e.popups,true)})})});AGN.Lib.Controller.new("mailing-priorities",function(){const i=AGN.Lib.Template;const t=AGN.Lib.Helpers;const n=AGN.Lib.DateFormat;const r=".mailing-priority__entry";const o=".mailing-priority__container";let s;let a;let l;let c;let u;let d;let h;const f=()=>{s=$("#ordered-area");a=$("#unordered-area");c=$("#priorityCount");l=$("#save-btn")};function p(){return _.reduce(_.keys(h.mailingsMap),function(e,t){return e<t?e:t})}const g=()=>{const e=$("#date-picker");const t=_.keys(h.mailingsMap).sort();if(t.length){if(!e.datepicker("getDate")){e.datepicker("setDate",n.parse(p()))}}e.trigger("change")};this.addDomInitializer("mailing-priorities",function(){h=this.config;f();const e=$(".tiles-container");$(o).sortable({handle:".priority-entry__drag-btn",opacity:.4,connectWith:o,items:r,helper:"clone",containment:e,appendTo:document.body,update:function(){if(this.id===s.attr("id")){v();S()}},out:function(){m($(this),false)},over:function(e,t){m($(e.target),false);m($(this),true)},start:function(){m($(this),true)},stop:function(){m($(this),false)}});g()});this.addAction({change:"priorityCount"},S);this.addAction({input:"priorityCount"},function(){const e=parseFloat(this.el.val());const t=!isNaN(e)&&e>=0?e:0;this.el.val(t)});this.addAction({change:"change-date"},function(){const e=this.el.datepicker("getDate");if(e){y(x([e.getFullYear(),e.getMonth(),e.getDate()]))}else{y()}});this.addAction({click:"save"},function(){const e=AGN.Lib.Form.get(this.el);e.setValueOnce("prioritizedIds",A());e.submit()});const m=(e,t)=>{e.closest(o).toggleClass("highlighted",t)};function v(){let i=1;let n=10;s.children(r).each(function(){const e=$(this);let t=0;if(e.data("type")==h.DATE_BASED_TYPE){t=n;i=n;n+=10}else{t=i;if(i>n){n=Math.round(i/10)*10}}i++;e.find(".priority-entry__order").text(`${t}.`)})}function y(e){const t=b(e);$(r).remove();C(t);S(true)}function b(e){let t=(h.mailingsMap[e]||[]).filter(e=>e.mailingType!==h.DATE_BASED_TYPE||e.priority>0);const i=t.map(e=>e.id);const n=w(i);return _.union(t,n,"id").sort((e,t)=>e.priority>t.priority?1:-1)}const w=e=>{const t=[];const i=_.clone(e);_.keys(h.mailingsMap).forEach(e=>{h.mailingsMap[e].forEach(e=>{if(e.mailingType==h.DATE_BASED_TYPE&&!i.includes(e.id)){i.push(_.clone(e).id);t.push(e)}})});return t};function C(e){if(e&&e.length){e.forEach(function(e){if(e.thumbnailId){e.thumbnailUrl=h.thumbnailLinkPattern.replace("__thumbnailId__",e.thumbnailId)}else{e.thumbnailUrl=h.noPreviewUrl}const t=i.dom("draggable-mailing-priority-entry",e);if(e.priority){s.append(t)}else{a.append(t)}AGN.runAll(t)})}}function x(e){return`${t.pad(e[0],4)}-${t.pad(parseInt(e[1])+1,2)}-${t.pad(e[2],2)}`}function S(e){const t=A(";");const i=c.val();if(u==null&&d==null||e){u=t;d=i;if(i>0){l.prop("disabled",true)}else{const n=E();c.val(n);l.prop("disabled",!n)}}else{l.prop("disabled",t==u&&i==d)}}function A(e){const t=[];s.children(r).each(function(){const e=$(this).data("id");if(e>0){t.push(e)}});return e?t.join(e):t}function E(){return s.children(r).filter(function(){return $(this).data("id")>0}).length}});AGN.Lib.Controller.new("reference-content-settings",function(){const e=AGN.Lib.Template;let i;let n;let t=false;let r=false;let o=[];let s;function a(){const e=$("#referenceTableSelect");const t=e.children("option:selected");$("#keyColumnText").val(t.exists()?t.data("key-column"):"")}function l(e,t){return $(n({name:c(e),value:t,disabled:!r}))}function c(e){return"Item"+e}function u(e){const t=l(h().length+1,e);i.append(t)}function d(e){if(!r){u("");return}_.each(e,e=>u(e))}function h(){return $("#reference-content-items .row")}this.addDomInitializer("reference-content-settings",function(){i=$("#reference-content-items");n=e.prepare("mailing-reference-content-item");s=$("#mailingSettingsForm");a();t=this.config.isAvailable;r=this.config.isEnabled;d(this.config.items);o=h();f();s.dirty("setAsClean");s.dirty("refreshEvents")});function f(){$("#referenceContentEnabled").on("change",function(){$("#referenceTableSelect").prop("disabled",!$(this).prop("checked"))})}this.addAction({change:"select-reference-table"},function(){a()});this.addAction({click:"add-reference-content-item"},function(){p();u("");s.dirty("setAsDirty")});function p(){const e=i.find('[data-action="add-reference-content-item"]');e.after(_.template(AGN.Opt.Templates["mailing-reference-content-delete-btn"])({disabled:!r}));e.remove()}function g(){return o.length!==h().length||o.some(e=>!h().includes(e))}function m(){h().each((e,t)=>{$(t).find(".input-group-text").text(c(e+1))})}this.addAction({click:"delete-reference-content-item"},function(){this.el.closest(".row").remove();m();if(!g()){s.dirty("setAsDirty")}})});AGN.Lib.Controller.new("mailing-send",function(){const n=AGN.Lib.Form,e=AGN.Lib.Modal,i=AGN.Lib.Confirm,r=AGN.Lib.Page,o=AGN.Lib.Template,s=AGN.Lib.Messages;const a="RECIPIENT";const l="TARGET";const c="SEND_TO_SELF";let u;let d;let t;const h={hideGreenMarks:function(){const e=$(".transmission-mark");e.parent().find("button").removeClass("hidden");e.remove()},updateWorkStatus:function(e,t){const i=$(o.text("mailing-workstatus-icon",{workstatus:e,tooltip:t}));$("#workstatus-icon").replaceWith(i)}};this.addDomInitializer("test-mailing",function(){u=$("#test-recipients-table");g(this.config.testRecipients);d=JSON.parse(this.config?this.config.approvalOptions:"[]");f();$("#get-approval-switch").on("change",function(){f()});p();$("#test-run-options").on("change",function(){p()})});function f(){const e=$("#get-approval-switch").prop("checked");const t=$("#test-run-options");t.find("option:not([value='"+d.join("']):not([value='")+"']").attr("disabled",e);if(e&&d.indexOf(t.val())===-1){t.val(t.find("option:not(:disabled):first").val()).trigger("change")}}function p(){const e=$("#test-run-options");if(!e.length){return}const t=e.val()==a;const i=e.val()==l;const n=e.val()==c;const r=!t||!$("#save-target-toggle").prop("checked");u.parent().toggleClass("hidden",!t);$("#adminSendButton").parent().toggleClass("hidden",t||i||n);$("#testTargetSaveButton").parent().toggleClass("hidden",r);$("#test-run-target-name-input").toggleClass("hidden",r);$("#testRunOptionSelect").prop("disabled",!i);u.find("input").prop("disabled",!t)}this.addDomInitializer("send-mailing",function(){t=this.config;const n=window.adminLocale==="en-US"?",":".";_.each($(".commaSplitInput"),e=>{const t=$(e);const i=t.val().replace(/\B(?=(\d{3})+(?!\d))/g,n);t.val(i)});S();if(t.approximateMaxDeliverySize>t.errorSizeThreshold){s.warnText(o.text("delivery-size-error-msg"))}});this.addAction({click:"check-links"},function(){$.post(t.urls.CHECK_LINKS).done(e=>AGN.Lib.RenderMessages($(e)))});this.addAction({click:"send-world"},function(){if(t.approximateMaxDeliverySize>t.errorSizeThreshold){s.alertText(o.text("delivery-size-error-msg"));return}const e=()=>{const t=n.get($("#delivery-settings-tile"));t.setActionOnce(AGN.url("/mailing/send/confirm-send-world.action"));t.submit("confirm").done(e=>{i.create(e).done(e=>t.updateHtml(e))})};if(t.approximateMaxDeliverySize>t.warningSizeThreshold){i.createFromTemplate({},"warning-mailing-size-modal").done(e);return}e()});const g=function(t){if(!t.length){const i=o.dom("test-recipient-row",{value:"",newRow:true,sent:false});u.append(i);AGN.runAll(i);return}for(let e=0;e<t.length;e++){const n=e===t.length-1;const i=o.dom("test-recipient-row",{value:t[e],newRow:n,sent:true});u.append(i);AGN.runAll(i)}};this.addAction({change:"save-interval-settings"},function(){const e=n.get(this.el);e.setActionOnce(AGN.url("/mailing/send/interval.action"));e.submit()});this.addAction({click:"resume-sending"},function(){const t=this.el;const e=t.data("link");$.post(e).done(e=>{r.render(e);t.parent().remove()})});this.addDomInitializer("status-mail-recipients",function(){const e=this.config.recipients||"";const t=$("#status-emails-block");e.split(" ").filter(e=>e).forEach(e=>t.append(o.text("status-mail-recipient-row",{email:e,newRow:false})));t.append(o.text("status-mail-recipient-row",{email:"",newRow:true}))});this.addAction({click:"status-mail-recipient-row-delete"},function(){const e=this.el.closest("[data-status-mail-recipient-row]");const t=e.data("mailing-id");e.remove();v(t,m())});this.addAction({click:"status-mail-recipient-row-add",enterdown:"status-mail-recipient-change"},function(){this.event.preventDefault();const e=this.el.closest("[data-status-mail-recipient-row]");const t=e.find("input");const i=t.val();if(i){v(e.data("mailing-id"),m(true),()=>{e.before(o.text("status-mail-recipient-row",{email:i,newRow:false}));t.val("")})}});const m=(e=false)=>{let t=$("[data-status-mail-recipient-row]").find("input");if(!e){t=t.not(":last")}return t.map(function(){return $(this).val().trim()}).get().join(" ")};const v=(e,t,i)=>{$.post(AGN.url(`/mailing/send/${e}/save-statusmail-recipients.action`),{emails:t}).done(e=>{if(e.success&&i){i()}AGN.Lib.JsonMessages(e.popups)}).fail(()=>s.defaultError())};this.addDomInitializer("delivery-status-view",function(){if(!this.config.isTransmissionRunning){h.hideGreenMarks()}const e=this.config.workStatus;const t=this.config.workStatusTooltip;if(e&&t){h.updateWorkStatus(e,t)}if(this.config.deliveryStat){const e=_.extend(this.config.deliveryStat,this.config.deliveryStatExtraInfo);y(e)}});function y(e){const t=o.dom("delivery-status-buttons",e);$(".delivery-status-action").remove();$(".header__actions").append(t)}this.addAction({click:"start-delivery"},function(){if($("#test-run-options").val()==a){const t=$('input[name="mailingTestRecipients"]').get().some(e=>$(e).val().trim());if(!t){s.alert("error.enterEmailAddresses");return}}$("#adminSendButton").addClass("disabled");$("#testSendButton").addClass("disabled");const e=n.get(this.el);e.setActionOnce(this.el.data("url"));e.submit()});this.addAction({click:"add-test-recipient",enterdown:"new-test-recipient"},function(){this.event.preventDefault();const e=this.el.closest("[data-test-recipient-row]");const t=this.el.is("input")?this.el:e.find("input");const i=o.dom("test-recipient-row",{value:t.val()||"",newRow:false,sent:false});e.before(i);t.val("");AGN.runAll(i);t.focus();b(false)});this.addAction({click:"remove-test-recipient"},function(){const e=this.el.closest("[data-test-recipient-row]");e.remove();b(false)});this.addAction({input:"new-test-recipient"},function(){b(false)});this.addAction({input:"edit-test-recipient",enterdown:"edit-test-recipient"},function(){this.event.preventDefault();b(false)});this.addAction({input:"edit-test-run-target-name"},function(){b(false)});this.addAction({enterdown:"edit-test-run-target-name"},function(){this.event.preventDefault()});function b(e){const t=$("#testTargetSaveButton");const i=t.find("i");if(e){i.hide()}t.toggleClass("btn-primary",!e,500);t.toggleClass("btn-success",e,500);if(e){t.css({cursor:"not-allowed","pointer-events":"none"})}else{t.css({cursor:"","pointer-events":""})}i.toggleClass("icon-save",!e);i.toggleClass("icon-check",e);i.show(500)}this.addAction({click:"save-target-for-test-run"},function(){if(!w()){return}C()});function w(){const t=$('input[name="targetName"]');const i=n.get(t);const e=AGN.Lib.Validator.get("length").errors(t,{min:3,required:true});if(!e.length){i.cleanFieldFeedback();return true}e.forEach(e=>i.showFieldError$(t,e.msg));return false}function C(){$.ajax({type:"POST",url:AGN.url("/mailing/send/test/saveTarget.action"),data:{mailingTestRecipients:x(),targetName:$('input[name="targetName"]').val().trim()}}).done(e=>{if(e.success===true){b(true)}else{AGN.Lib.JsonMessages(e.popups)}})}function x(){return $('input[name="mailingTestRecipients"]').map(function(){return this.value.trim()}).get().filter(e=>e)}this.addAction({focusout:"max-recipients-change"},function(){S()});function S(){const e=$("#maxRecipients");if(e.exists()&&e.val()==="0"){e.val("")}}this.addAction({change:"prioritization-toggle"},function(){A($(this.el),"isPrioritizationDisallowed")});this.addAction({change:"encrypted-send-toggle"},function(){A($(this.el),"isEncryptedSend")});this.addAction({change:"sendStatusOnErrorOnly-toggle"},function(){A($(this.el),"statusOnErrorEnabled")});function A(e,t){const i=e.prop("checked");e.prop("disabled",true);const n=()=>{e.prop("checked",!i);s.defaultError()};const r={};r[t]=e.is(":checked");$.ajax({type:"POST",url:e.data("url"),data:r}).done(e=>{if(e&&e.success){s.success("defaults.saved")}else{n()}}).fail(n).always(()=>e.prop("disabled",false))}});AGN.Lib.Controller.new("mailing-settings-view",function(){const r=AGN.Lib.Form;const e=AGN.Lib.Template;const i=AGN.Lib.Select;const n=AGN.Lib.Modal;const o=AGN.Lib.Messages;const s=["#settingsGeneralMailingList","#lightWeightMailingList","#assignTargetGroups","#targetGroupIds","#altgIds","#followUpType"];let a;let l=false;let c=[];let u;let d=0;let h;let f=false;let p;let g;this.addDomInitializer("mailing-settings-view",function(){a=this.config;m();p=e.text("edit-with-campaign-btn");g=$("#mailingSettingsForm");c=$("#targetGroupIds").val()||[];T(c.length>1);u=i.get($("#settingsGeneralMailingList"));u.setReadonly(false);if(d>0){d=u.selectOption(d)}if(a.selectedRemovedMailinglistId){G()}O(a.mailingType);H();v();w();L()});function m(){$(s.join(",")).on("change",function(){l=true;if(!h){return}const e=D();if(!_.isEqual(e,h)){h=null;R("?")}})}function v(){const e=y()===a.TARGET_MODE_OR;$("#target-mode-description").text(t(`mailing.default.targetmode_${e?"or":"and"}`))}function y(){return $("[name='targetMode']:checked").val()}function b(){return $("<div>",{class:"input-group-text input-group-text--disabled border-end-0 pe-0",html:p})}function w(){_.each($('[data-workflow-driven="true"]'),e=>C($(e)))}function C(e){if(e.is('input[type="text"]')){x(e)}if(e.is('input[type="checkbox"]')){S(e)}if(e.is("select")){A(e)}e.prop("disabled",true)}function x(e){e.css("border-left","0").wrap('<div class="input-group">').before(b(p));AGN.Lib.CoreInitializer.run("tooltip",e.parent())}function S(e){e.next().after(p);AGN.Lib.CoreInitializer.run("tooltip",e.parent())}function A(e){const i=e.next(".select2-container");if(e.prop("multiple")){i.find(".select2-selection__rendered").hide();i.find(".select2-search__field").val(t("mailing.default.editWithCampaign"));i.find(".select2-search--inline").prepend(p)}else{i.find(".select2-selection").prepend(p)}AGN.Lib.CoreInitializer.run("tooltip",i)}function G(){const e=r.get(g);e.showFieldError("mailinglistId",t("fields.mailinglist.errors.removed"),true)}function E(){const e=g.dirty("showDirtyFields");if(e.length>0){var t=e.filter(function(e,t){var i=$(t);return!(i.prop("readonly")===true||i.is(":disabled")||i.prop("type")==="hidden")});return t.length===0}else{return false}}function H(){g.dirty("destroy");g.dirty({preventLeaving:true,leavingMessage:t("grid.layout.leaveQuestion"),onDirty:function(){if(E()&&!f){g.dirty("setAsClean")}}});if(E()&&!f){g.dirty("setAsClean")}f=false}window.onbeforeunload=function(){if(!g.dirty("isDirty")===true){AGN.Lib.Loader.show()}};function T(e){$("#target-mode-box").toggle(e);$("#regular-targets-box").toggleClass("border rounded p-2",e)}this.addAction({change:"selectTargetGroups"},function(){const e=this.el.val()||[];if(e.length>1&&c.length<=1){$("#target-mode-and-btn").prop("checked",true)}T(e.length>1);c=e});function B(e){var r={};e.forEach(function(e){var t=$(e);if(t.exists()&&t.is(":visible")&&!t.prop("disabled")){var i=t.prop("name");var n=t.val();if(i){r[i]=n}}});return r}this.addAction({click:"calculateRecipients"},function(){if(a){h=D();$.ajax({type:"POST",url:AGN.url("/mailing/ajax/"+a.mailingId+"/calculateRecipients.action"),traditional:true,data:h}).always(function(e){if(e&&e.success===true){R(e.count)}else{R("?");o.defaultError()}})}});function D(){return $.extend(B(s),{changeMailing:l,targetMode:y(),isWmSplit:a.wmSplit})}function R(e){$("#number-of-recipients").val(e)}this.addAction({change:"set-parent-mail-mailinglist"},function(){M()});this.addAction({change:"change-general-mailing-type"},function(){const e=this;const t=e.el.val();u.setReadonly(false);if(d>0){u.selectOption(d)}O(t)});this.addAction({change:"save-mailing-list-id"},function(){const t=this.el.select2("val");const e=$("#settingsGeneralMailType").val();if(!k(e)){d=t}if(a.selectedRemovedMailinglistId){u.$findOption(a.selectedRemovedMailinglistId).remove();const i=r.get($(this.el));i.cleanFieldError("mailinglistId")}if(a.allowedMailinglistsAddresses){const n=a.mailinglists.find(function(e){return e.id==t});if(n){if(n.senderEmail){$("#emailSenderMail").val(n.senderEmail).trigger("change")}if(n.replyEmail){$("#emailReplyEmail").val(n.replyEmail)}if(n.senderEmail&&n.replyEmail){o.info("mailing.default.sender_and_reply_emails_changed")}else if(n.senderEmail){o.info("mailing.default.sender_email_changed")}else if(n.replyEmail){o.info("mailing.default.reply_email_changed")}}}});this.addAction({change:"change-target-mode"},v);function M(){const e=$("#lightWeightMailingList").val();const t=$("#parentmailing-"+e+"-mailinglist").attr("data-mailing-list-id");u.selectOption(t);u.setReadonly(true)}function k(e){return a.FOLLOWUP_MAILING_TYPE==e}function V(e){return a.ACTIONBASED_MAILING_TYPE==e}function j(e){return a.DATEBASED_MAILING_TYPE==e}function O(e){var t=false;if(a.followUpAllowed){if(k(e)){M();t=true}N(t,"#followUpControls")}N(j(e),"#mailing-bcc-recipients");const i=V(e)?a.campaignEnableTargetGroups:true;N(i,"#regular-targets-box, #calculate-recipients-box")}function N(e,t){var i=$(t);if(i){if(e){i.removeClass("hidden");i.show()}else{i.hide()}}}this.addAction({change:"change-mediatype"},function(){var e=$(this.el);var t=I(e);U(e,t)});function I(e){return e.find("input:checkbox:first").is(":checked")}function z(){var t=$("#mediatypes-list");var e=W();t.empty();e.forEach(function(e){t.append(e)})}function W(){return $("#mediatypes-list li").toArray().sort(function(e,t){var i=$(e);var n=$(t);if(!I(i)&&I(n))return 1;if(I(i)&&!I(n))return-1;return i.data("priority")-n.data("priority")})}function U(e,t){z();Y(e,t)}function Y(e,t){if(t){e.find(".form-switch").after(q())}else{e.find(".list-group-item-controls").remove()}L()}function L(){let e=$(".list-group");e.find("a").css("opacity","1");e.find(".icon-angle-up:first, .icon-angle-down:last").css("opacity","0");r.get(e).initFields()}function q(){return`
          <div class='list-group-item-controls'>
              <a href='#' class='icon icon-angle-down fs-2' data-action='prioritise-mediatype-down'></a>
              <a href='#' class='icon icon-angle-up fs-2' data-action='prioritise-mediatype-up'></a>
          </div>`}this.addAction({click:"prioritise-mediatype-up"},function(){P($(this.el).closest("li"),true)});this.addAction({click:"prioritise-mediatype-down"},function(){P($(this.el).closest("li"),false)});function K(e){var t=e.prev();var i=e.attr("data-priority");e.attr("data-priority",t.attr("data-priority"));t.attr("data-priority",i);t.before(e)}function X(e){var t=e.next();var i=e.attr("data-priority");e.attr("data-priority",t.attr("data-priority"));t.attr("data-priority",i);t.after(e)}function Z(e,t){return t&&e.prev().length||!t&&e.next().length&&I(e.next())}function P(e,t){f=true;if(Z(e,t)){if(t){K(e)}else{X(e)}g.dirty("setAsDirty");L()}}this.addAction({submission:"save"},F);function F(){const e=r.get(g);Q(e);J(e);e.submit()}function Q(n){$("#mediatypes-list li").toArray().forEach(function(e){const t=$(e);const i=t.data("mediatype");n.setValueOnce(i+"Mediatype.priority",t.data("priority"))})}function J(i){const e=$("#mailingParamsTable");if(!e.exists()){return}_.each(e.data("table").collect(),function(e,t){i.setValueOnce("params["+t+"].name",e.name);i.setValueOnce("params["+t+"].value",e.value);i.setValueOnce("params["+t+"].description",e.description)})}this.addAction({click:"edit-content-modal"},function(){const e=$("#email-mediatype-switch").prop("checked")||a.isMailingGrid;const t=e&&!$("#emailMailFormat").val()==0&&!a.isMailingGrid;const i=$("#sms-mediatype-switch").prop("checked");AGN.Lib.Modal.fromTemplate("modal-editor",{showText:e,showHtml:t,showSms:i})});this.addAction({click:"save-content"},function(){let e=$("#content-form");if(!r.get(e).validate()){return}n.getInstance(e).hide();F()})});AGN.Lib.Controller.new("mailing-styles",function(){function e(){const e=$("form#mailingStylesForm");const o=$("form#mailingPreviewForm");const t=e.find('input[name^="styles["]');$.each(t,function(e,t){const i=$(t);const n=i.attr("name");const r=o.find('input[name="'+n+'"]');r.val(i.val())});o.submit()}this.addAction({submission:"updatePreview"},function(){e()});this.addAction({click:"updateMailingPreview"},function(){e()});this.addAction({click:"saveMailingStyles"},function(){$("form#mailingStylesForm").submit()})});AGN.Lib.Controller.new("mailinglist-list",function(){var r=null;function n(){var e=$(".js-data-table-body");if(e.exists()){var t=e.data("_table");if(t&&t.api){return t.api}}return null}function o(e){var i=$.Deferred();if(e&&e.length){var n=$.ajax(r.urls.MAILINGLIST_BULK_DELETE,{method:"POST",traditional:true,data:{bulkIds:e}}).fail(function(){i.reject()});AGN.Lib.Confirm.request(n).done(function(e){AGN.Lib.Page.render(e)}).then(i.resolve,i.reject)}else{i.reject();AGN.Lib.Messages(t("Error"),t("messages.error.nothing_selected"),"alert")}return i.promise()}this.addDomInitializer("mailinglist-list",function(){r=this.config});this.addAction({click:"bulk-delete"},function(){var e=n();if(e){var t=e.getSelectedRows();var i=t.map(function(e){return e.id});o(i).done(function(){e.updateRowData({remove:t})})}})});AGN.Lib.Controller.new("manage-table-import",function(){const i=AGN.Lib.Form;var s="#new-default-column-format";var a="#new-default-column-value";var l="#new-default-column-encrypted";var c=".manage-tables-mapping-row";var u=AGN.Lib.Template;var d=null;var h;var f;this.addDomInitializer("manage-table-import",function(){d=this.config;t(d.mappings)});this.addAction({click:"add-default-column"},function(){var e=$(c).length;var t=$(s).val(),i=$(a).val(),n=!!$(l).prop("checked"),r=$("#new-default-column-type").val();if("value"===r&&!(i.startsWith("'")&&i.endsWith("'"))){i="'"+i+"'"}var o=u.dom("manage-tables-import-row",{index:e,targetColumns:d.importColumns,format:t,value:i,encrypted:n});$("#manage-tables-tbody").append(o);$(s).val("");$(a).val("");$(l).prop("checked",false)});this.addAction({click:"delete-mapping-row"},function(){var e=this.el,t=e.parents(c),i=e.parents("tbody");t.remove();p(i.find(c))});this.addAction({click:"create-mapping"},function(){const e=i.get(this.el);$.ajax(d.urls.CREATE_MAPPINGS,{type:"POST",dataType:"json",enctype:"multipart/form-data",processData:false,contentType:false,data:e.data()}).done(function(e){if(e.success===true){t(e.data);AGN.Lib.JsonMessages(e.popups)}else{AGN.Lib.JsonMessages(e.popups)}})});this.addAction({click:"import-data"},function(){const e=this.el.data("url");const t=i.get($("#form"));t.setActionOnce(e);o(t)});function t(e){h=$("#manage-tables-tbody");h.html("");f=u.prepare("column-mapping-table-row");for(var t=0;t<e.length;t++){const i=e[t];r(t,i.id,i.sourceColumn,i.targetColumn,i.mandatory,i.encrypted,i.format,i.defaultValue)}}function e(){if(!h||!h.length){return[]}return _.map(h.find("[data-mapping-row]"),function(e){const t=$(e);return{sourceColumn:n(t,"fileColumn"),targetColumn:n(t,"db-column"),mandatory:n(t,"mandatory"),encrypted:n(t,"encrypted"),defaultValue:n(t,"defaultValue"),format:n(t,"format")}})}function n(e,t){const i=e.find("[data-mapping-"+t+"]");if(i.is(":checkbox")){return i.is(":checked")}return i.val()}function r(e,t,i,n,r,o,s,a){const l=f({index:e,id:t,fileColumn:i,databaseColumn:n,mandatory:r,encrypted:o,format:s,defaultValue:a});h.append(l);const c=$('[data-mapping-row="'+e+'"]').find("[data-mapping-db-column]");AGN.Lib.CoreInitializer.run("select",c)}this.addAction({submission:"save"},function(){const e=i.get(this.el);o(e)});function o(i){_.each(e(),function(e,t){i.setValueOnce("mappings["+t+"].sourceColumn",e.sourceColumn);i.setValueOnce("mappings["+t+"].targetColumn",e.targetColumn);i.setValueOnce("mappings["+t+"].mandatory",e.mandatory);i.setValueOnce("mappings["+t+"].encrypted",e.encrypted);i.setValueOnce("mappings["+t+"].defaultValue",e.defaultValue);i.setValueOnce("mappings["+t+"].format",e.format)});i.submit()}function p(e){var i=0;e.each(function(){var e=$(this);var t=e.find('[name*="mappings["]');t.each(function(){var e=$(this);var t=e.attr("name");t=t.replace(/mappings\[\d+]/g,"mappings["+i+"]");e.attr("name",t)});i++})}});AGN.Lib.Controller.new("manage-tables-viewfield",function(){var t="true";this.addAction({change:"typeFieldChangeAction"},function(){var e=$("#nullable");if(this.el.val()==="DATE"||this.el.val()==="DATETIME"){t=e.val();e.val("true")}else{e.val(t)}})});AGN.Lib.Controller.new("mediapool-element-category-select",function(){var n=AGN.Lib.Confirm,i=AGN.Lib.Helpers,r=AGN.Lib.Select;this.addDomInitializer("mediapool-element-category-select",function(e){var t=i.objFromString(e.data("config"));if(t&&t.categoryId){r.get($("#mediapool-file-category-id")).selectValueOrSelectFirst(t.categoryId)}});this.addAction({change:"selectCategory"},function(){var e=this.el.parents(".form-group");e.removeClass("has-alert has-feedback js-form-error");e.find(".js-form-error-msg").addClass("hidden")});this.addAction({click:"applyCategory"},function(){var e=$("#mediapool-file-category-id");var t=parseInt(e.val());if(t>0){n.get(this.el).positive({categoryId:t})}else{var i=e.parents(".form-group");i.addClass("has-alert has-feedback js-form-error");i.find(".js-form-error-msg").removeClass("hidden")}})});AGN.Lib.Controller.new("mediapool-overview",function(){this.addDomInitializer("mediapool-edit",function(){$('[id$="-editor-modal"]').on("modal:close",()=>AGN.Lib.Messages.warn("defaults.changesNotSaved"))});this.addAction({click:"change-category-bulk"},function(){const e=[...$('input[name="bulkIds"]:checked')].map(e=>e.value);if(!e?.length){AGN.Lib.Messages.alert("messages.error.nothing_selected");return}AGN.Lib.Modal.fromTemplate("category-select-modal",{bulkIds:e})})});AGN.Lib.Controller.new("mediapool-upload",function(){const o=AGN.Lib.Template;const l=AGN.Lib.Form;let i={};const s={};let a;let e;this.addDomInitializer("mediapool-upload",function(){i=this.config.fileExtensions;a=$("#components-uploads-container");e=$("#upload-reset-btn");$("#dropzone").on("upload:reset",function(){a.empty();a.prev().removeClass("hidden");e.parent().addClass("hidden")})});this.addAction({"upload:add":"mediapool-upload"},function(){const n=this.data.file;const r=this.data.index;a.prev().addClass("hidden");e.parent().removeClass("hidden");h(n.name,e=>{const t=c(n);const i=o.dom("mediapool-upload-item",{index:r,itemId:e.data?e.data.id:0,fileName:n.name,previewUrl:u(n),typeCode:d(t),isArchive:t==="zip"});a.append(i);l.get(a).initFields();AGN.runAll(i)},true)});function c(e){if(e.name&&e.name.includes(".")){return e.name.substring(e.name.lastIndexOf(".")+1).toLowerCase()}return""}function u(e){if(/^image/.test(e.type)){return URL.createObjectURL(e)}return""}function d(e){if(e){for(const t in i){if(i[t].includes(e)){return t}}}return null}this.addAction({click:"upload-files"},function(){const t=l.get(this.el);const i=t._dataNextRequest;let n=t.validate();let r=0;for(key in i){const o=$(`#item-overwrite-${r}`);const s=$(`#item-file-name-${r}`).val();const a=o.is(":checked");h(s,e=>{if(e.data&&!a){n=false;o.data("item-id",e.data.id);$(`[name='uploads["${r}"].id']`).val(e.data.id);f(r,false);AGN.Lib.Messages.warn("fields.mediapool.warnings.overwrite_inactive",s)}else if(!a){f(r,true)}});r++}if(n){for(let e=0;e<i.length;e++){t.setValue(`uploads[${e}].file`,i[e])}t.submit()}});function h(e,t,i=false){function n(e){if(e.data){s[e.data.id]=e.data}t(e)}$.ajax(AGN.url("/mediapool/findElementWithName.action"),{data:e,contentType:"application/json",async:i,type:"POST",success:n})}function f(e,t){$(`#duplication-error-block-${e}`).toggleClass("hidden",t);$(`#overwrite-block-${e}`).toggleClass("hidden",t)}this.addAction({change:"overwrite-data"},function(){const e=$(this.el);const t=e.data("item-id");const i=e.data("index");let n="";let r="";if(e.is(":checked")&&s[t]){const o=s[t];n=o.title;r=String(o.category.categoryId)}$(`#item-title-${i}`).val(n);$(`#item-category-${i}`).val(r).trigger("change")});this.addAction({change:"change-mobile-base"},function(){const e=this.el;const t=AGN.Lib.Helpers.objFromString(e.data("config"));const i=AGN.Lib.Select.get(e).getSelectedValue();const n=i&&i.length>0;const r=n?t.mobilePrefix+i:t.initialValue;const o=$(`#item-file-name-${t.index}`);o.val(r).prop("readonly",n)})});AGN.Lib.Controller.new("navbar",function(){this.addAction({mouseenter:"expand-navbar-tab",mouseleave:"expand-navbar-tab"},function(){this.el.toggleClass("hovered")})});AGN.Lib.Controller.new("news-editor",function(){var r=AGN.Lib.Template;var o=["de","en"];var s;this.addDomInitializer("news-editor-init",function(){s=0;var e=$('input[name="newsId"]').val();var t=$(".existent-news");if(t&&t.length>0&&e==0){$(t).each(function(){var e=$(this).find(".existent-news-language").val();var t=$(this).find(".existent-news-title").val();var i=$(this).find(".existent-news-content").val();n(e,t,i);l();a();$(this).remove()})}else if(e==0){n(i(),"","");l();a()}});this.addAction({click:"addNewsContent"},function(){n(i(),"","");l();a()});this.addAction({click:"removeNewsContent"},function(){var e=$(this.el).closest(".l-news-content-block");$(e).remove();l();a();c()});this.addAction({change:"changeLanguage"},function(){c()});function n(e,t,i){if(e!=""){var n=r.dom("news-content-template-row",{lang:e,index:s,title:t,content:i});n.appendTo("#news-content-editor");AGN.runAll(n);c();s++}}function a(){const e=u();const t=$("#news-content-editor > .l-news-content-block").last().data("index");$("#add-news-"+t).toggle(o.length!=e.length)}function l(){const e=$("#news-content-editor > .l-news-content-block");$("button[id^='add-news-']").hide();const t=$(e).first().data("index");$("#delete-news-"+t).toggle(e.length!=1)}function c(){var e=t();$("#news-content-editor > .l-news-content-block").find("select.news-language").each(function(){$("option",this).not(":selected").remove();var i=$(this);$.each(e,function(e,t){$(i).append($("<option>",{value:t,text:t}))})})}function t(){var i=[];var n=u();$.each(o,function(e,t){if($.inArray(t,n)==-1){i.push(t)}});return i}function u(){var e=$("#news-content-editor > .l-news-content-block").find("select.news-language").find("option:selected");return e.map(function(){return $(this).val()}).toArray()}function i(){var i=u();var n="";if(i.length==0){n=o[0]}else{$.each(o,function(e,t){if(i.indexOf(t)<0){n=t;return false}})}return n}});AGN.Lib.Controller.new("notification-global-stat",function(){this.addAction({change:"selectReportType"},function(){var e=$("#globalStatInfo");switch(this.el.val()){case"STATUS":n(false,true,false);e.show();break;case"BROWSER":n(false,false,true);e.hide();break;case"PROGRESS":n(true,false,false);e.show();break}});this.addAction({click:"close"},function(){var e=$("#notifications-container");e.fadeOut("slow",function(){e.remove()})});this.addAction({click:"refreshStat"},function(){r()});this.addAction({change:"select-month"},function(){r()});this.addAction({change:"select-year"},function(){r()});this.addAction({click:"weekProgressStat"},function(){$("#selectMode").val("WEEK");e(false,false);r();i(true,false,false)});this.addAction({click:"monthProgressStat"},function(){$("#selectMode").val("MONTH");e(true,false);$("#refreshStat").show();i(false,true,false);r()});this.addAction({click:"dateRangeProgressStat"},function(){$("#selectMode").val("RANGE");e(false,true);$("#refreshStat").show();i(false,false,true);r()});this.addAction({change:"end-date-change"},function(){var e=$("#startDay").val();var t=$("#endDay").val();$("#startDay").pickadate("picker").set("max",t);$("#endDay").pickadate("picker").set("min",e);r()});this.addAction({change:"start-date-change"},function(){var e=$("#startDay").val();var t=$("#endDay").val();$("#startDay").pickadate("picker").set("max",t);$("#endDay").pickadate("picker").set("min",e);r()});function e(e,t){$("#month-progress-stat").hide();$("#daterange-progress-stat").hide();if(e){$("#month-progress-stat").show()}if(t){$("#daterange-progress-stat").show()}}function i(e,t,i){$("#weekProgressStat").removeClass("active");$("#monthProgressStat").removeClass("active");$("#dateRangeProgressStat").removeClass("active");if(e){$("#weekProgressStat").addClass("active")}if(t){$("#monthProgressStat").addClass("active")}if(i){$("#dateRangeProgressStat").addClass("active")}}function n(e,t,i){$("#notificationGlobalStatusStat").hide();$("#notificationGlobalBrowserStat").hide();$("#notificationGlobalProgressStat").hide();if(e){AGN.Lib.DomInitializer.try("notification-global-progress-stat");$("#notificationGlobalProgressStat").show();$("#dateSelectMode").show();$("#dateModeControls").show()}if(t){AGN.Lib.DomInitializer.try("notification-global-status-stat");$("#notificationGlobalStatusStat").show();$("#dateSelectMode").hide();$("#dateModeControls").hide()}if(i){AGN.Lib.DomInitializer.try("notification-global-browser-stat");$("#notificationGlobalBrowserStat").show();$("#dateSelectMode").hide();$("#dateModeControls").hide()}}function r(){$("#notifications-container").remove();if(o()){if($("#monthProgressStat").attr("class")=="active"||$("#dateRangeProgressStat").attr("class")=="active"){AGN.Lib.DomInitializer.try("notification-global-progress-stat")}}}function o(){if($("#dateRangeProgressStat").attr("class")=="active"){var e=$("#startDay").val();var t=$("#endDay").val();if(s(e)||s(t)){a();return false}if(new Date(e).getTime()>new Date(t).getTime()){a();return false}}return true}function s(e){return typeof e==="undefined"||e==""}function a(){AGN.Lib.Messages(t("defaults.error"),t("error.statistic.period_format"),"alert");setTimeout(function(){var e=$("#notifications-container");e.fadeOut("slow",function(){e.remove()})},7e3)}});AGN.Lib.Controller.new("notification-schedule",function(){var t,n,r,i;this.addDomInitializer("notification-schedule",function(e){t=e.find("#startDate");n=e.find("#endDate");r=e.find("#startTime");i=e.find("#endTime");t.pickadate("picker").on("set",s);r.on("change",s);n.pickadate("picker").on("set",d);i.on("change",d)});function o(){var e=t.pickadate("get","select");return e&&new Date(e.obj)}function s(){var e=n.pickadate("picker");var t=o();e.off("set");if(t){var i=u(t);l(t,i);a(i);c(r.val())}else{l(true,false);a(null);c(null)}e.on("set",d)}function e(){var e=o();if(e){l(e,u(e))}else{l(true,false)}}function a(e){var t=n.pickadate("picker");if(e){t.set("select",e)}else{t.clear()}}function l(e,t){var i=n.pickadate("picker");i.set("min",e);i.set("max",t);i.set("select",i.get("select"))}function c(e){i.val(e)}function u(e){var t=new Date(e);t.setDate(t.getDate()+28);return t}function d(){n.removeClass("enableable");i.removeClass("enableable");n.pickadate("off","set");i.unbind("change");t.pickadate("off","set");t.pickadate("picker").on("set",e);r.unbind("change");r.on("change",e)}});AGN.Lib.Controller.new("notification-settings",function(){this.addAction({"editor:create":"content","editor:change":"content"},function(){var e=this.el.val().length;$("#contentSize").text(t("fields.content.charactersEntered",e))})});AGN.Lib.Controller.new("profile-field-view",function(){let n;this.addDomInitializer("profile-field-view",function(){n=$("#fixed-values-container");const e=this.config.fixedValues??[];t(e)});function t(e){_.each(e,e=>i(false,e));i(true)}function i(e,t){var i=AGN.Lib.Template.dom("fixed-value-row",{isLastRow:e});if(t){i.find("input").val(t)}n.append(i)}this.addAction({click:"delete-fixed-value"},function(){this.el.closest("[data-fixed-value-row]").remove()});this.addAction({click:"add-fixed-value"},function(){const e=this.el.closest("[data-fixed-value-row]");const t=e.find("input").val();e.remove();i(false,t);i(true)})});AGN.Lib.Controller.new("recipient-import-errors-edit",function(){const e=AGN.Lib.Page;this.addDomInitializer("recipient-import-errors-edit",function(){if(t()){e.reload(AGN.url("/recipient/import/chooseMethod.action?cancelImport=true"))}else{window.onbeforeunload=function(){return"If you leave the page, the import will be canceled automatically!"}}});function t(){if(typeof performance==="undefined"||typeof performance.getEntriesByType!=="function"){return false}const e=performance.getEntriesByType("navigation");if(e.length>0){return e[0].type==="reload"}return false}this.addAction({submission:"save-errors"},function(){i();const e=AGN.Lib.Form.get(this.el);e.submit("static")});this.addAction({click:"ignore-errors"},function(){i();e.reload(AGN.url("/recipient/import/errors/ignore.action"))});this.addAction({click:"cancel"},function(){i();e.reload(AGN.url("/recipient/import/cancel.action"))});function i(){window.onbeforeunload=null}});AGN.Lib.Controller.new("recipient-import-view",function(){this.addAction({click:"delete-file"},function(){const e=$.post(AGN.url("/recipient/import/file/delete.action"));e.done(function(){$("#uploaded-file-container").remove();$("#uploadFile").removeClass("hidden")})});this.addDomInitializer("recipient-import-view",function(){const e=this.config.attachmentCsvFileID;if(e>0){const t=$("#useCsvUpload");t.prop("checked",true);t.trigger("change")}})});AGN.Lib.Controller.new("recipient-list",function(){const e=AGN.Lib.Action,i=AGN.Lib.Messages,n=AGN.Lib.Form,r=AGN.Lib.Modal,o=AGN.Lib.Storage;const s="-1";const a="#targetgroup-querybuilder";const l=["firstname","lastname","email","gender"];let c;let u;let d={};let h=false;let f;e.new({"qb:invalidrules":a},function(){i.alert("querybuilder.errors.invalid_definition")});this.addDomInitializer("recipient-list",function(){c=$("#filter-query-builder-block");u=$(a);f=this.config.maxSelectedColumns;d=$.extend({},JSON.parse(this.config.initialRules));o.restoreChosenFields(v());window.setTimeout(()=>{b();g();C()},0);u.on("change",()=>{p().toggleClass("hidden",!O())});u.on("afterClear.queryBuilder",()=>{p().toggleClass("hidden",true)});u.on("afterReset.queryBuilder afterDeleteGroup.queryBuilder afterDeleteRule.queryBuilder afterSetRules.queryBuilder afterUpdateRuleFilter.queryBuilder",()=>{p().toggleClass("hidden",!O())})});function p(){return $("#target-group-save-button")}this.addAction({change:"toggle-filter"},function(){g();o.saveChosenFields(this.el)});this.addAction({change:"change-table-columns"},function(){const e=this.el.val();if(e.length>f){i.warn("recipient.maxColumnsSelected");e.pop();this.el.val(e).trigger("change")}});function g(){const e=m();$("#basic-filters-block").toggleClass("hidden",e);$("#advanced-filter-btn").toggleClass("hidden",!e)}function m(){return v().is(":checked")}function v(){return $("#use-advanced-filter")}this.addAction({click:"advanced-filter"},function(){const e=r.fromTemplate("recipient-advanced-filter-modal",{showTargetSaveBtn:O()});e.on("modal:close",()=>u.appendTo(c));u.appendTo(e.find(".modal-body"))});this.addAction({click:"create-new-target"},function(){I()?.clearErrors();if(y()){AGN.Lib.Confirm.createFromTemplate({rules:$("#queryBuilderRules").val()},"new-targetgroup-modal").done(e=>E().updateHtml(e))}});this.addAction({click:"set-advanced-filter"},function(){if(y(true)){r.getInstance(this.el).hide();S()}});function y(e=false){const t=$.Event("qb:validation");u.trigger(t,{ignore_qb_validation:false,skip_empty:e});return!t.isDefaultPrevented()}function b(){const e=$("#advanced-filter-btn").find("span");const i=` (${t("defaults.active")})`;e.text(e.text().replace(i,""));if(w()){e.text(e.text()+i)}}function w(){const e=u.find("#queryBuilderRules").val();const t=JSON.parse(e).rules;return Array.isArray(t)&&t.length>0}this.addAction({change:"change-mailinglist-id"},C);function C(){const e=N("mailinglist").val();const t=e===s;N("type").prop("disabled",t);N("status").prop("disabled",t)}this.addAction({enterdown:"search-recipient"},function(){h=true});this.addAction({validation:"search-recipient"},function(){if(h){const e=this.data;this.data=_.merge({},e,{ignore_qb_validation:false,skip_empty:false})}else if(this.data&&this.data.ignore_qb_validation){x()}});function x(){const e=I();if(e){e.clearErrors();e.setRules(d);M()}}this.addAction({submission:"search-recipient"},function(){if(h){T();A({ignore_qb_validation:false})}});this.addAction({click:"search"},function(){S()});function S(){if(!m()){T()}A({ignore_qb_validation:false})}function A(e){const t=E();t.submit("",_.merge({ignore_qb_validation:true,skip_empty:true},t.validatorOptions,e))}function E(){return n.get($("#listForm"))}function T(){const e=l.map(e=>{const t=D(e);const i=t==="string"?"contains":"equal";let n=N(e).val().trim();if(t==="number"&&n!==""){n=Number(n)}return{id:e,value:n,operator:i}});return R(e,true)}function D(e){const t=I().getFilterById(e).type;return $.fn.queryBuilder.constructor.types[t]}function R(e,n){const r=I();if(!r){return false}return e.reduce((e,t)=>{const i=r.getRules({allow_invalid:true,skip_empty:true});if(!t.id){return e}if(typeof t.value==="number"||t.value){return r.setOrReplaceRule(i,t,n)===true||e}return r.deleteRuleByField(null,t.id,n)===true||e},false)}function M(){const t=k();_.each(l,e=>N(e).val(t[e]))}function k(e=l){const i=I();const n={};if(i){const r=i.getRules({allow_invalid:true,skip_empty:true});e.forEach(function(e){const t=i.findRuleByField(r,e,true);n[e]=t?.value||""})}return n}function O(){const e=I();return e?e.containsNotEmptyRule():false}function N(e){return $(`#filter-${e}`)}function I(){return u.prop("queryBuilder")}});AGN.Lib.Controller.new("recipient-statistics-view",function(){const n=AGN.Lib.Form;this.addAction({change:"type-change"},function(){const e=this.el;const t=e.find("option:selected");const i=$("#mailinglist-select");if(t.is("[data-mailinglist-required]")&&i.val()==="0"){AGN.Lib.Select.get(i).selectNext()}n.get(e).submit()});this.addAction({change:"change-period"},function(){n.get(this.el).submit()})});AGN.Lib.Controller.new("recipient-view",function(){const o="OK";const s="USED";const a="BLACKLISTED";const l=AGN.Lib.Form;const r=AGN.Lib.Confirm;const i=AGN.Lib.Template;let c;let e=false;let u;this.addDomInitializer("recipient-view",function(e){const r=l.get(e);u=this.config;c=new h(u.urls.CHECK_ADDRESS,function(e){switch(e.status){case o:r.cleanFieldError("email");break;case s:const i=u.urls.EXISTING_USER_URL_PATTERN.replace(":recipientID:",e.recipientID);const n=`
            <div class="duplicated-recipient-block">
                ${t("error.inUse")}
                <a href="${i}" class="btn btn-sm btn-inverse text-nowrap">${t("recipient.existing.btn")}</a>
            </div>
          `;r.showFieldError("email",n,true);break;case a:r.showFieldError("email",t("error.isBlacklisted"),true);break}});$("#recipient-email").on("change input",_.debounce(function(){c.check($(this).val())},300));n()});function n(){$(".not-allowed-usertype").each(function(){const e=$(this);if(e.prop("selected")){e.parent("select").prop("disabled",true)}else{e.prop("disabled",true)}})}this.addAction({submission:"recipient-save"},function(){const i=l.get(this.el);const e=$("#recipient-email").val();this.event.preventDefault();const n=()=>{$.post(u.urls.CHECK_MATCH_ALTG,i.params()).done(function(e){if(e.popups&&e.popups.alert&&e.popups.alert.length>0){AGN.Lib.JsonMessages(e.popups)}else if(!e.success||e.success.length===0){r.create(d(t("recipient.hide.question"))).done(()=>{i.setActionOnce(u.urls.SAVE_AND_BACK_TO_LIST);i.submit()})}else{i.submit()}}).fail(()=>{i.submit()})};if(c&&e&&e.trim()){c.jqxhr(e.trim()).done(e=>{if(e.isBlacklisted===true){r.create(d(t("recipient.blacklisted.question"))).done(()=>{if(e.inUse===true){r.create(d(t("recipient.duplicate.question"))).done(n)}else{n()}})}else if(e.inUse===true){r.create(d(t("recipient.duplicate.question"))).done(n)}else{n()}}).fail(n)}else{n()}});function d(e){return i.text("recipient-confirmation-modal",{question:e})}this.addAction({change:"activate-mediatype"},function(){const e=this.el.data("mediatype");const t=this.el.is(":checked");this.el.closest("[data-mailinglist-tile]").find(`.icon-mediatype-${e}`).toggleClass("text-primary",t);this.el.closest(".tile").find("[data-binding-usertype]").prop("disabled",!t)});class h{constructor(e,t){this.url=e;this.running=false;this.callback=$.isFunction(t)?t:$.noop;this.lastAddress=null;this.lastResult=null;this.scheduledCheck=null}jqxhr(e){return $.get(this.url,{email:e})}scheduleCheck(t){const i=this;if(i.scheduledCheck){clearTimeout(i.scheduledCheck)}if(i.running){i.scheduledCheck=setTimeout(function(){i.scheduleCheck(t)},300)}else{i.running=true;i.lastAddress=null;i.lastResult=null;try{i.jqxhr(t).always(function(){i.running=false}).done(function(e){i.lastAddress=t;i.lastResult={status:e.isBlacklisted===true?a:e.inUse===true?s:o,recipientID:e.existingRecipientId||0};i.report()})}catch(e){i.running=false}}}check(e){e=e?e.trim():"";if(e){if(this.lastAddress==e){this.report()}else{this.scheduleCheck(e)}}else{this.report(o)}}report(e){if(arguments.length){this.callback.call(null,e)}else{if(this.lastAddress){this.report(this.lastResult)}}}}});AGN.Lib.Controller.new("reference-table-settings-modal",function(){$(document).on("shown.bs.modal",".modal[reference-table-settings-modal]",function(){var e=$(this).find("input[data-associated-with], select[data-associated-with]");e.each(function(){var e=$(this);var t=$(e.data("associated-with"));if(e.is(":checkbox")){e.prop("checked",t.val()==="true")}else{e.val(t.val())}})});this.addAction({click:"apply-button"},function(){var e=$(this.el);var t=AGN.Lib.Form.get(e);var i=t.validate();if(i){var n=e.closest(".modal").find("input[data-associated-with], select[data-associated-with]");n.each(function(){var e=$(this);var t=$(e.data("associated-with"));if(e.is(":checkbox")){t.val(e.prop("checked"))}else{t.val(e.val())}});AGN.Lib.Modal.getWrapper(e).modal("hide")}})});AGN.Lib.Controller.new("side-menu",function(){const e=AGN.Lib.WebStorage;let i;let n=true;this.addDomInitializer("side-menu",function(){n=!!window.matchMedia("(pointer: fine)").matches;i=n?400:0});this.addAction({click:"switch-to-classic-design"},function(){const e=this.el;const t=e.parent().parent().find(".sidebar__tooltip");r(t,this.event,()=>{$.post(AGN.url("/ui-design/switch.action")).done(()=>{e.prop("disabled",true);window.setTimeout(()=>AGN.Lib.Page.reload(e.data("switch-url")),500)}).fail(()=>e.prop("checked",!e.prop("checked")))})});this.addAction({click:"logout"},function(){const e=this.el.find(".sidebar__tooltip");r(e,this.event,()=>AGN.Lib.Form.get($("#logoutForm")).submit("static"))});this.addAction({click:"open-account-data"},function(){const e=this.el.find(".sidebar__tooltip");r(e,this.event,()=>AGN.Lib.Page.reload(AGN.url(this.el.data("url"))))});this.addAction({click:"open-help"},function(){const e=this.el.find(".sidebar__tooltip");r(e,this.event,AGN.Lib.Helpers.openHelpModal)});function r(e,t,i){if(!n&&!e.hasClass("open")){o(e);t.preventDefault()}else{i()}}this.addAction({mouseenter:"display-tooltip"},function(){if(n){const e=this.el.find(".sidebar__tooltip");o(e)}});function o(e){a(e);clearTimeout(e.data("closeTimerId"));e.addClass("open")}this.addAction({mouseleave:"display-tooltip"},function(){const e=this.el.find(".sidebar__tooltip");e.data("closeTimerId",setTimeout(()=>t(e),i))});this.addAction({mouseenter:"activateSubmenu"},function(){if(!n){return}s(this.el)});this.addAction({click:"activateSubmenu"},function(){const e=this.el.find(".menu-item").next(".submenu");if(e.hasClass("open")){const t=$(this.event.target).closest("a");if(t.exists()){AGN.Lib.Page.reload(t.attr("href"))}}else{s(this.el)}});function s(e){const t=e.find(".menu-item");const i=t.next(".submenu");const n=i.find(".submenu-items-container");a(i);clearTimeout(t.data("closeTimerId"));i.addClass("open");c(i,t);n.addClass("open")}this.addAction({mouseleave:"activateSubmenu"},function(){const e=$(this.el).find(".menu-item");const t=e.next(".submenu");e.data("closeTimerId",setTimeout(()=>l(t),i))});function a(e){$(".sidebar__tooltip.open").not(e).each(function(){t($(this))});$(".submenu.open").not(e).each(function(){l($(this))})}function t(e){e.removeClass("open")}function l(e){e.removeClass("open");e.find(".submenu-items-container").removeClass("open")}function c(e,t){const i=$(window);const n=e.find(".submenu-header");const r=parseInt(t.parent().parent().css("gap"));let o=t.scrollTop()+t.offset().top+t.outerHeight()/2-n.outerHeight()/2-r;const s=e.outerHeight();if(o+s>i.height()+i.scrollTop()){o=i.height()+i.scrollTop()-s-r}if(o-i.scrollTop()<0){o=i.scrollTop()}e.offset({top:o,left:e.offset().left})}});AGN.Lib.Controller.new("help-center",function(){const i=AGN.Lib.Form;const n=AGN.Lib.JsonMessages;const r=AGN.Lib.Template;const e=AGN.Lib.Helpers;const t=()=>{window.hmNavigationFrame=true;window.lazysync=e=>{const t=document.getElementById("manual-iframe").contentWindow;if(t.hmForceRedirect&&t.location&&t.location.href){t.location.href="index.html?"+e}}};t();this.addDomInitializer("help-center",function(){$("[data-help-tab]").on("help-tab:open",function(e,t){const i=$(this);const n=i.data("help-tab");if(n==="support"){l(t.type,t.opts)}if(!i.is(".active")){i.trigger("click")}})});this.addDomInitializer("support-chat",function(){const e=$("#support-chat-tab");s(this.config.initialMessage,true);let t;e.on("form:loadershow",()=>{if(!t){t=o()}});e.on("form:loaderhide",()=>{t.remove();t=null})});this.addAction({submission:"send-message"},function(){const e=$("#support-message");const t=e.val();if(t.length){s(t);i.get(this.el).jqxhr().done(e=>{n(e.popups);if(e.success){s(e.data,true)}});e.val("")}});function o(){const e=r.dom("support-chart-typing-msg");return a(e)}function s(e,t=false){const i=r.dom(t?"support-chart-incoming-message":"support-chart-outgoing-message",{text:e});return a(i)}function a(e){const t=$("#support-chat-tab").find(".chat-content");const i=t.prop("scrollHeight");t.append(e).scrollTop(i);return e}this.addDomInitializer("support",function(){l()});this.addDomInitializer("help-center-docs",function(){const e=this.config.manuals;const t=this.config.translations;e.flatMap(e=>e.files).forEach(e=>{e.link=`manual/${e.lang}/pdf/${e.name}`;e.btnMsgKey=t.download+" "+e.lang.toUpperCase()});$("#help-center-docs-tab").html(r.dom("help-center-docs",{manuals:e}))});this.addAction({submission:"send-support-request"},function(){this.event.preventDefault();i.get(this.el).submit()});this.addAction({submitted:"send-support-request"},function(){if(this.data.success){var e=Popover.get(this.el);if(e){e.hide()}}n(this.data.popups)});function l(e,t){const i=$("#help-center-support-tab");const n={supportType:e||"",subject:"",subjectChangeable:true,page:c()};i.html(r.text("help-center-support",_.merge({},n,t)));AGN.Lib.CoreInitializer.run("select",i);AGN.Lib.CoreInitializer.run("char-counter",i)}function c(){var e=window.location;var t=[".action",".do"];var i,n,r;if(e.origin&&e.pathname){var o=(e.pathname+"").replace(/;jsessionid=[a-z0-9]+/i,"");for(i=0;i<t.length;i++){n=t[i];r=o.indexOf(n);if(r>0){o=o.substring(0,r+n.length)}}return e.origin+o+e.search+e.hash}else{var s=(e.href+"").replace(/;jsessionid=[a-z0-9]+/i,"");for(i=0;i<t.length;i++){n=t[i];r=s.indexOf(n);if(r>0){var a=r+n.length;var l=s.indexOf("?",a);if(l<0){l=s.indexOf("#",a)}if(l>0){return s.substring(0,a)+s.substring(l)}else{return s.substring(0,a)}}}}return s}});AGN.Lib.Controller.new("system-status",function(){this.addAction({click:"cancel-imports"},function(){AGN.Lib.Confirm.createFromTemplate({},"cancel-running-imports-modal").done(()=>{$.post(AGN.url("/serverstatus/killRunningImports.action")).fail(()=>AGN.Lib.Messages.defaultError())})})});AGN.Lib.Controller.new("target-create-mailinglist",function(){this.addAction({click:"select-mediatype"},function(){var e=this.el.closest("form");var t=e.find("#createMailinglistOkBtn");if(!e.find('input:checked[name="mediatypes"]').length){t.attr("disabled","disabled")}else{t.removeAttr("disabled")}})});AGN.Lib.Controller.new("target-scheduler",function(){var r=AGN.Lib.ScheduleTimeTable,o=AGN.Lib.ScheduleTimeTable.PeriodRow;var s;this.addAction({submission:"save-scheduler-data"},function(){var e=AGN.Lib.Form.get($(this.el));e.setValueOnce("intervalAsJson",s.getSubmissionJson("period"));e.submit()});this.addDomInitializer("target-scheduler-init",function(e){var t=e.json();if(s){s.clean()}s=new r($("#tile-schedule-time"));var i=[];if(t.intervalAsJson){i=JSON.parse(t.intervalAsJson).map(function(e){return o.deserialize(e)})}i.forEach(function(e){s.addRow(e)});if(i.length===0){s.addEmptyPeriodRow()}var n=AGN.Lib.Form.get(e);n.initFields()})});AGN.Lib.Controller.new("target-group-view",function(e){const n=AGN.Lib.Form;AGN.Lib.Action.new({"qb:invalidrules":"#targetgroup-querybuilder"},function(){AGN.Lib.Messages.alert("querybuilder.errors.general")});this.addDomInitializer("target-group-view",function(){if(this.config.errorPositionDetails){t(this.config.errorPositionDetails)}});this.addAction({change:"toggle-editor-tab"},function(){const e=this.el;const t=e.is(":checked");const i=n.get(e);if(!i.validate({skip_empty:true})){e.prop("checked",!t);return false}i.setValueOnce("viewFormat",t?"EQL":"QUERY_BUILDER");i.submit("",{skip_empty:true})});this.addAction({submission:"save-target"},function(){n.get(this.el).submit(this.el.data("submit-type")).done(e=>{if(typeof e=="object"&&!e.success){t(e.data);AGN.Lib.JsonMessages(e.popups)}})});function t(e){const t=AGN.Lib.Editor.get($("#eql")).editor;t.focus();t.gotoLine(e.line,e.column)}});AGN.Lib.Controller.new("temp-file",function(){const i=AGN.Lib.Form;let n;this.addAction({"upload:add":"show-upload-file-form"},function(){if(n){return}n=true;$.ajax({url:AGN.url("/upload/new.action"),type:"GET",async:false,success:e=>{AGN.Lib.Page.render(e);$(".modal").on("modal:close",o);c().on("upload:filesSet",(e,t)=>{r(t);n=false})}})});function r(e){if(e.length>1){l(e);return}const t=$("#file-names");t.append(e[0].name)}function o(){$("#files").val("");$("#dropzone").trigger("upload:reset")}this.addAction({click:"save-file"},function(){const t=i.get(this.el);const e=t.submit();if(e){e.done(e=>{AGN.Lib.Modal.getWrapper(t.get$()).modal("hide");AGN.Lib.JsonMessages(e.popups)});$(".modal").hide()}});function s(){return[{field:"name",headerName:t("defaults.name"),filter:false},{field:"size",headerName:t("defaults.size"),filter:false,width:50}]}function a(e){return e.map(({name:e,size:t})=>({name:e,size:AGN.Lib.Helpers.formatBytes(t)}))}function l(e){const t=(e.length+2)*40;const i=new AGN.Lib.Table($(`<div class="js-data-table-body">`),s(),a(e),{pagination:false});const n=$(`<div class="col-12" style="height: ${t}px; max-height: 220px">`);n.append(i.$el);c().find(".row:first").prepend(n)}function c(){return $("#upload-form")}});AGN.Lib.Controller.new("template-css",function(){this.addAction({click:"updatePreview"},function(){var e=$("#layoutPreviewForm");e.find('input[name="css"]').val($("#cssContents").val());e.submit()});this.addAction({click:"saveLayoutCss"},function(){var e=AGN.Lib.Form.get($("#gridTemplateForm"));var t=$('#save-css-approve-modal-form select[name="templatesToUpdate"]').val();var i=e.getValue("templateId");if(i){t.push(i)}e.setValueOnce("bulkIds",t);e.submit()})});AGN.Lib.Controller.new("template-outer-html-edit",function(){this.addAction({click:"updatePreview"},function(){var e=$("#layoutPreviewForm");e.find('input[name="outerHTML"]').val($("#templateOuterHTML").val());e.submit()});this.addAction({click:"saveOuterHTML"},function(){$("#gridTemplateForm").submit()})});AGN.Lib.Controller.new("template-styles",function(){function e(){var e=$("form#gridTemplateForm");var o=$("form#layoutPreviewForm");var t=e.find('input[name^="styles."]');$.each(t,function(e,t){var i=$(t);var n=i.attr("name");var r=o.find('input[name="'+n+'"]');r.val(i.val())});o.submit()}this.addAction({submission:"updatePreview"},function(){e()});this.addAction({click:"updateLayoutPreview"},function(){e()});this.addAction({click:"saveLayoutStyles"},function(){$("form#gridTemplateForm").submit()})});AGN.Lib.Controller.new("mailing-trackable-links",function(){const e=this;const n=AGN.Lib.Form;var t;var i;var r;this.addDomInitializer("mailing-trackable-links",function(){i=this.config.KEEP_UNCHANGED;r=this.config.SAVE_ALL_URL;if(this.config.scrollToLinkId){o($("#link-"+this.config.scrollToLinkId))}});AGN.Lib.Action.new({change:"[id^=link-], #tile-trackableLinkEditAll"},function(){t=this.el.attr("id")});this.addAction({click:"save-bulk-actions"},function(){const i=n.get($("#trackableLinksForm"));const e=$("#bulkActionsForm").serializeFormDataObject();i._data={};$.each(e,function(e,t){i.setValue(e,t)});i.setValue("modifyAllLinksExtensions",false);s(AGN.Lib.InputTable.get("#bulkActionExtensions").collect(),i);i.setActionOnce(r);i.submit();AGN.Lib.Modal.getWrapper(this.el).modal("hide")});this.addAction({click:"save-all"},function(){this.event.preventDefault();const e=n.get($("#trackableLinksForm"));e._data={};e.setValue("modifyBulkLinksExtensions",false);a(e);s(AGN.Lib.InputTable.get("#link-common-extensions").collect(),e);e.setActionOnce(r);e.submit()});this.addAction({scrollTo:"scroll-to"},function(){if(t){o($(this.el).find("#"+t))}});function o(e){if(e&&e.length>0){var t=e.closest('[data-sizing="scroll"]');if(t.length>0){var i=t.find(":first-child").offset().top;var n=e.offset().top;t.scrollTop(0);t.scrollTop(n-i)}}}this.addAction({click:"save-individual"},function(){this.event.preventDefault();const e=n.get($("#trackableLinkForm"));const t=AGN.Lib.InputTable.get("#individual-extensions").collect();s(t,e);e.submit()});this.addAction({change:"link-details-trackable"},function(){e.runInitializer("trackableAction")});this.addInitializer("trackableAction",function(e){const t=$('[data-action="link-details-trackable"] :selected');const i=$("#linkAction");i.prop("disabled",i.prop("disabled")||t.val()==0)});function s(e,i){_.each(e,function(e,t){i.setValue("extensions["+t+"].name",e.name);i.setValue("extensions["+t+"].value",e.value)})}function a(e){e.setValue("bulkUsage",i);e.setValue("bulkAction",i);e.setValue("bulkDeepTracking",i);e.setValue("bulkStatic",i)}});AGN.Lib.Controller.new("trackable-link",function(){var e=this;var t=new AGN.Lib.TrackableLinkExtensions;this.addDomInitializer("trackable-link-extensions",function(){t.load(this.config.extensions,$("#extensions tbody"))});this.addAction({click:"save"},function(){this.event.preventDefault();var e=AGN.Lib.Form.get($("#trackableLinkForm"));i(e);e.submit("static")});function i(i){_.each(t.collect(),function(e,t){i.setValue("extensions["+t+"].name",e.name);i.setValue("extensions["+t+"].value",e.value)})}this.addAction({change:"link-details-trackable"},function(){e.runInitializer("trackableAction")});this.addInitializer("trackableAction",function(e){var t=$('[data-action="link-details-trackable"] :selected');var i=$("#linkAction");i.prop("disabled",i.prop("disabled")||t.val()==0)})});AGN.Lib.Controller.new("user|groups-permissions",function(){let e;this.addDomInitializer("user|groups-permissions",function(){e=t(this.config);c(+a().first().attr("id").match(/\d+/)[0]);o()});function t(e){if(e.isSoapUser){return i(e)}return n(e)}function i(e){const t=e.permissions.map(e=>({...e,name:e.endpointName}));return[...t,...e.permissionGroups]}function n(e){return e.permissionCategories.map(function(e){return e.subCategories}).flatMap(function(e){return Object.values(e)}).flatMap(function(e){return e.permissions})}function s(e){return $(`#${e}-category-permissions`).find(".permission:not(.hidden)")}function r(){return $(".permission-categories__btn")}function o(){_.each(r(),function(e){const t=$(e);const i=t.data("category-index");const n=s(i);const r=n.length;const o=n.find('[role="switch"]:checked').length;$(`label[for="${i}-category-btn"] .permissions-counter`).text(`(${o}/${r})`);t.toggleClass("disabled",r<=0)})}function a(){return $('[id$="-category-permissions"]:visible')}function l(){$(`[id$="-category-permissions"]:visible .tile-body`).scrollTop(0)}function c(e){u(e);l(e);$('[id$="-category-btn"]').prop("checked",false);$(`#${e}-category-btn`).prop("checked",true);S()}function u(e){$('[id$="-category-permissions"]').hide();$(`#${e}-category-permissions`).show();C()}this.addAction({click:"change-category"},function(){c(this.el.data("category-index"))});function d(){e.filter(e=>m(e)).map(e=>$('[id="'+e.name+'"]').closest(".permission")).forEach(e=>e.removeClass("hidden"))}function h(){const e=r().not(".disabled");if(b().length>0||e.length<=0){return}c(+e.first().data("category-index"))}this.addAction({click:"apply-filter",enterdown:"handle-filter-enterdown"},function(){this.event.preventDefault();x();d();C();o();h();l();S()});function f(t){const e=$("#type-filter").val();if(!e?.length){return true}return e.some(e=>v(e)(t))}function p(e){const t=$("#name-filter").val().trim().toLowerCase();const i=$(`#${e.name.replaceAll(".","\\.")}`).parent().find("label").text().toLowerCase().trim();return!t||i.includes(t)}function g(e){const t=$("#right-filter").val()?.trim()?.toLowerCase();return!t||e.name.includes(t)}function m(e){return p(e)&&g(e)&&f(e)}function v(e){switch(e){case"granted":return function(e){return e.granted};case"grantedForUser":return function(e){return e.granted&&!e.showInfoTooltip};case"grantedByGroup":return function(e){return e.showInfoTooltip};case"grantable":return function(e){return!e.granted&&e.changeable};case"notGrantable":return function(e){return!e.granted&&!e.changeable};case"new":return function(e){return e.recent};default:return function(){return true}}}function y(){$(".permission_category-subcategory").show()}function b(){return a().find(".permission:visible")}function w(){const e=b().length<=0;$(".no-results-found").toggle(e)}function C(){y();$(".permission_category-subcategory").each(function(){return $(this).toggle($(this).find("li:visible").length>0)});w()}function x(){$(".permission").addClass("hidden")}function S(){a().find("[data-toggle-checkboxes]").trigger("update-toggle-all")}});AGN.Lib.Controller.new("userform-images",function(){const o=AGN.Lib.Modal;const s=AGN.Lib.Template;const a=AGN.Lib.Form;this.addAction({"upload:add":"image-upload"},function(){const e=this.data.file;const t=this.data.index;let i=$("#components-upload-modal");if(!i.exists()){i=o.fromTemplate("userform-images-upload-modal-template");i.on("modal:close",l)}const n=i.find("#components-uploads-container");const r=s.dom("userform-upload-image",{index:t,fileName:e.name,previewUrl:u(e),isArchive:c(e)==="zip"});n.append(r);a.get(i).initFields();AGN.runAll(r)});function l(){$("#upload-files").val("");$("#dropzone").trigger("upload:reset")}function c(e){if(e.name&&e.name.includes(".")){return e.name.substring(e.name.lastIndexOf(".")+1).toLowerCase()}return""}function u(e){if(/^image/.test(e.type)){return URL.createObjectURL(e)}return""}this.addAction({click:"upload-images"},function(){const e=a.get(this.el);const t=o.getWrapper(this.el);e.$form.on("submitted",()=>{if(document.contains(t[0])){t.css("opacity",1)}});e.submit();t.css("opacity",0)})});AGN.Lib.Controller.new("userform-view",function(){var c=AGN.Lib.FormBuilder.FormBuilder;var u=AGN.Lib.Editor;var s=AGN.Lib.Confirm;var i;let n=0;this.addDomInitializer("userform-view",function(){var e=this.config;i=e.actionURLPattern;n=e.formId;$("#userFormForm").dirty()});this.addAction({click:"activate-and-test"},function(){const t=this.el;const i=t.attr("href");s.createFromTemplate({},"userform-activate-and-test").done(()=>{$.post(AGN.url(`/webform/${n}/activate.action`)).done(e=>{AGN.Lib.JsonMessages(e.popups,true);if(e.success){$("#is-active-switch").prop("checked",true);t.removeAttr("data-action");window.open(i,"_blank")}})})});this.addAction({change:"change-intro-action"},function(){var e=$("#startActionLink");var t=this.el.val();r(e,t)});this.addAction({change:"change-final-action"},function(){var e=$("#finalActionLink");var t=this.el.val();r(e,t)});this.addAction({change:"check-velocity-script"},function(){if(this.el.val()!=="wysiwyg"){return}e(this.el)});this.addAction({submission:"saveUserForm"},function(){var e=l("successFormBuilder");var t=l("errorFormBuilder");var i=e&&a("successTemplate");var n=t&&a("errorTemplate");if(i||n){s.createFromTemplate({needSuccessCodeChoose:i,needErrorCodeChoose:n},"warning-save-different-tabs")}else{var r=e?"FORM_BUILDER":"HTML";var o=t?"FORM_BUILDER":"HTML";d(r,o)}});this.addAction({click:"save-specific-code-mode"},function(){const e=$("#choose-code-format-modal-form");const t=e.find('[name="success_template_mode"]').val();const i=e.find('[name="error_template_mode"]').val();d(t,i)});this.addAction({change:"formTestRecipient"},function(){var e=$("#formTestLink");var t=$("#formTestRecipient");e.attr("href",t.val())});function a(e){var t=CKEDITOR.instances[e];if(t){t.updateElement()}return $("#userFormForm").dirty("isFieldDirty",$("#"+e))}function l(e){if(c.isCreated("#"+e)){return c.get("#"+e).isChanged()}return false}function d(e,t){var i=AGN.Lib.Form.get($("form#userFormForm"));if(c.isCreated("#successFormBuilder")){var n=c.get("#successFormBuilder");if(e==="FORM_BUILDER"){u.get($("#successTemplate")).val(n.generateHtml())}var r=n.getJson();i.setValueOnce("successSettings.formBuilderJson",r);var o=$("#successFormBuilder").find("input:enabled,select:enabled");o.prop("disabled",true)}if(c.isCreated("#errorFormBuilder")){var s=c.get("#errorFormBuilder");if(t==="FORM_BUILDER"){u.get($("#errorTemplate")).val(s.generateHtml())}var a=s.getJson();i.setValueOnce("errorSettings.formBuilderJson",a);var l=$("#errorFormBuilder").find("input:enabled,select:enabled");l.prop("disabled",true)}i.submit();if(o){o.prop("disabled",false)}if(l){l.prop("disabled",false)}}function e(e){const i=AGN.Lib.Helpers.objFromString(e.data("action-options"));const n=AGN.Lib.Editor.get($("#"+i.type+"Template")).val();if(n.match(/#(?:set|include|macro|parse|if|foreach)/gi)){AGN.Lib.Messages(t("defaults.error"),t("userform.error.velocity_not_allowed"),"alert");e.val("html").trigger("change")}}function r(e,t){if(e.exists()){if(t>0){e.attr("href",i.replace(":action-ID:",t));e.removeClass("hidden")}else{e.attr("href","#");e.addClass("hidden")}}}});AGN.Lib.Controller.new("workflow-list",function(){var r=null;function o(){var e=$(".js-data-table-body");if(e.exists()){var t=e.data("_table");if(t&&t.api){return t.api}}return null}this.addDomInitializer("workflow-list",function(){r=this.config;e(this.config.reactions)});function e(e){const i=$("#reaction-filter");e.forEach(e=>{i.append($("<option>",{value:e,text:t(`workflow.reaction.${e}`)}))})}function s(e,i){var n=$.Deferred();if(e&&e.length){var r=$.ajax(i,{method:"GET",traditional:true,data:{bulkIds:e}}).fail(function(){n.reject()});AGN.Lib.Confirm.request(r).then(n.resolve,n.reject)}else{n.reject();AGN.Lib.Messages(t("Error"),t("messages.error.nothing_selected"),"alert")}return n.promise()}this.addAction({click:"bulk-delete"},function(){var t=o();if(t){var i=t.getSelectedRows();var e=i.map(function(e){return e.id});s(e,r.urls.WORKFLOW_BULK_DELETE).done(function(e){t.applyTransaction({remove:i});AGN.Lib.RenderMessages($(e))})}});this.addAction({click:"bulk-deactivate"},function(){var e=o();if(e){var t=e.getSelectedRows();var i=e.getSelectedNodes();var n=t.map(function(e){return e.id});s(n,r.urls.WORKFLOW_BULK_DEACTIVATE).done(function(){i.forEach(function(e){e.setDataValue("status",{name:"inactive",messageKey:"default.status.inActive"})});e.refreshClientSideRowModel("filter");e.deselectAll()})}})});AGN.Lib.Controller.new("workflow-view",function(){const v=AGN.Lib.WM.Definitions;const r=AGN.Lib.WM.Editor;const o=AGN.Lib.WM.Node;const h=AGN.Lib.WM.EditorsHelper;const a=AGN.Lib.WM.MailingEditorHelper;const i=AGN.Lib.WM.Dialogs;const s=AGN.Lib.WM.MailingSelector;const l=AGN.Lib.Confirm;const c=AGN.Lib.Template;const f=AGN.Lib.WM.Utils;const u=AGN.Lib.Select;const n=AGN.Lib.WM.DateTimeUtils;const y=AGN.Lib.Form;const d=AGN.Lib.Modal;var p=this;var g;if(!jsPlumb.Connectors["FixedBezierConnector"]){jsPlumbUtil.extend(AGN.Opt.Components.JsPlumbFixedBezierConnector,jsPlumb.Connectors.AbstractConnector);jsPlumb.Connectors["FixedBezierConnector"]=AGN.Opt.Components.JsPlumbFixedBezierConnector}this.addDomInitializer("workflow-view",function(){var e=this.config;v.constants=e.constants;v.workflowId=e.workflowId;v.shortname=e.shortname;v.statisticUrl=e.statisticUrl;var t=e.icons.map(o.deserialize);var i=o.deserializeConnections(e.icons,o.toMap(t));if(g){g.recycle()}g=new r(e.isEditable!==false,e.isContextMenuEnabled!==false,e.isFootnotesEnabled===true);g.setOnInitialized(function(){g.batch(function(){t.forEach(function(e){g.add(e)});i.forEach(function(e){g.connect(e.source,e.target)})});g.updateNodeTitles();g.updateFootnotes();if(v.workflowId===0){v.intialSchema=g.serializeIcons()}});g.setMinimapEnabled(e.isMinimapEnabled!==false);var n=$("#slider");if(n.exists()){n.slider({min:v.MIN_ZOOM,max:v.MAX_ZOOM,value:v.DEFAULT_ZOOM,step:v.ZOOM_STEP,create:function(){var t=$(this).slider("instance");g.setZoom(v.DEFAULT_ZOOM);g.setOnZoom(function(e){t.value(e)})},slide:function(e,t){g.setZoom(t.value)}})}if(e.fitPdfPage===true){g.fitPdfPage()}window.status=e.initializerFinishStatus||""});this.addDomInitializer("mailing-data-transfer-modal",function(e){var i=e.find("input[data-mailing-param]");var n=e.find("#transferAllSettings");var r={};var o=[];i.on("change",function(){var e=$(this);var t=e.data("mailing-param");if(e.prop("checked")){r[t]=true}else{delete r[t]}o=Object.keys(r);n.prop("checked",o.length==i.length)});n.on("change",function(){var e=n.prop("checked");i.prop("checked",e);if(e){i.each(function(){r[$(this).data("mailing-param")]=true});o=Object.keys(r)}else{r={};o=[]}});this.addAction({click:"transfer-mailing-data"},function(){l.get(e).positive(o)})});this.addDomInitializer("own-workflow-expanding-modal",function(e){var t=e.find("#workflow-select");var i=e.find('input[name="copyContent"]');this.addAction({click:"expand-own-workflow"},function(){l.get(e).positive({workflowId:t.val(),copyContent:i.filter(":checked").val()=="true"})})});this.addDomInitializer("icon-comment-editor-initializer",function(){var e=h.registerEditor("icon-comment",{formName:"iconCommentForm",safeToSave:true,fillEditor:function(e){$("#iconComment").val(e.getComment())},saveEditor:function(){h.saveIconComment($("#iconComment").val());this.cancelEditor()},cancelEditor:function(){$("#icon-comment-editor").dialog("close");return false}});p.addAction({click:"icon-comment-editor-save"},function(){e.saveEditor()});p.addAction({click:"icon-comment-editor-cancel"},function(){e.cancelEditor()})});this.addDomInitializer("parameter-editor-initializer",function(){h.registerEditor("parameter",{formName:"parameterForm",getTitle:function(){return t("workflow.parameter")},fillEditor:function(e){var t=$('form[name="'+this.formName+'"]');u.get(t.find("select[name=value]")).setOptions(g.getParametersOptions(e));var i=e.getData();t.submit(false);t.get(0).reset();h.fillFormFromObject(this.formName,i,"")},saveEditor:function(){return h.formToObject(this.formName)}});p.addAction({click:"parameter-editor-save"},function(){h.saveCurrentEditorWithUndo()})});this.addDomInitializer("deadline-editor-initializer",function(){var e=h.registerEditor("deadline",{panelIds:["fixedDeadlinePanel","delayDeadlinePanel"],timeUnitIds:["deadlineTimeUnitMinute","deadlineTimeUnitHour","deadlineTimeUnitDay","deadlineTimeUnitWeek","deadlineTimeUnitMonth"],formName:"deadlineForm",getDefaultDelayData:function(e){var t={};if(e===v.constants.deadlineTypeDelay&&this.isPrecededByImportIcon){t={timeUnit:v.constants.deadlineTimeUnitHour,delayValue:v.constants.defaultImportDelayLimit}}return t},getTitle:function(){return t("workflow.deadline.title")},fillEditor:function(e){var t=e.getData();$("#deadline-editor").find(".editor-error-messages").css("display","none");this.isPrecededByImportIcon=this.checkPrecededByImportIcon(e);var i=$('form[name="'+this.formName+'"]');i.submit(false);$('form[name="'+this.formName+'"] #deadlineDate').datepicker("setDate",this.dateAsUTC(t.date||new Date));this.fillDelayData(i,t);$('form[name="'+this.formName+'"] #time').val(("0"+t.hour).slice(-2)+":"+("0"+t.minute).slice(-2))},fillDelayData:function(e,t){e.get(0).reset();var i=$('form[name="'+this.formName+'"] input[name="deadlineType"]:checked').val();var n=this.getDefaultDelayData(i);h.fillFormFromObject(this.formName,t,"",n);this.updateVisibility();var r=t.delayValue||n.delayValue;h.initSelectWithValueOrChooseFirst($('form[name="'+this.formName+'"] select[name="delayValue"]'),r)},saveEditor:function(){var e=h.formToObject(this.formName);var t=$('form[name="'+this.formName+'"] #time').val();e.date=$('form[name="'+this.formName+'"] #deadlineDate').pickadate("picker").get("select").obj;e.hour=t.substring(0,2);e.minute=t.substring(3,5);return e},updateVisibility:function(){var e=$('form[name="'+this.formName+'"]');var t=e.find('input[name="deadlineType"]:checked').val();if(this.checkPresentNodeOfType([v.NODE_TYPE_ACTION_BASED_MAILING,v.NODE_TYPE_DATE_BASED_MAILING])){e.find("input#typeFixedDeadline").parent().parent().parent().hide();e.find('input[value="'+v.constants.deadlineTypeDelay+'"]').prop("checked",true);t=v.constants.deadlineTypeDelay}else{e.find("input#typeFixedDeadline").parent().parent().parent().show()}if(t===v.constants.deadlineTypeDelay){this.switchPanelsVisibility("delayDeadlinePanel");this.switchTimeContainerVisibility(false);var i=e.find('select[name="timeUnit"]').val();switch(i){case v.constants.deadlineTimeUnitMinute:this.switchTimeUnitsVisibility("deadlineTimeUnitMinute");break;case v.constants.deadlineTimeUnitHour:this.switchTimeUnitsVisibility("deadlineTimeUnitHour");break;case v.constants.deadlineTimeUnitDay:this.switchTimeUnitsVisibility("deadlineTimeUnitDay");this.switchTimeContainerVisibility(true);$("#deadlineTimeHelp").removeAttr("style");break;case v.constants.deadlineTimeUnitWeek:this.switchTimeUnitsVisibility("deadlineTimeUnitWeek");break;case v.constants.deadlineTimeUnitMonth:this.switchTimeUnitsVisibility("deadlineTimeUnitMonth");break}e.find('input[name="useTime"]').css("display","inline")}else if(t===v.constants.deadlineTypeFixedDeadline){this.switchPanelsVisibility("fixedDeadlinePanel");this.switchTimeContainerVisibility(true);this.hideDiv("deadlineTimeHelp");e.find('input[name="useTime"]').css("display","none")}},switchPanelsVisibility:function(t){var i=this;this.panelIds.forEach(function(e){if(e!==t){i.hideDiv(e)}});this.showDiv(t)},switchTimeUnitsVisibility:function(t){var i=this;this.timeUnitIds.forEach(function(e){if(e!==t){i.hideDiv(e);$("#"+e+" select").removeAttr("name")}});this.showDiv(t);$("#"+t+" select").attr("name","delayValue")},switchTimeContainerVisibility:function(e){var t=this;if(e){t.showDiv("deadlineTimeContainer")}else{t.hideDiv("deadlineTimeContainer")}},hideAllItems:function(e){var t=this;e.forEach(function(e){t.hideDiv(e)})},validateEditor:function(){var e=true;var i=v.constants.defaultImportDelayLimit;if(this.isPrecededByImportIcon){var n=$('form[name="'+this.formName+'"]');var r=n.find('input[name="deadlineType"]:checked').val();if(r===v.constants.deadlineTypeDelay){var o=n.find('select[name="timeUnit"]').val();if(o===v.constants.deadlineTimeUnitMinute){e=false}else if(o===v.constants.deadlineTimeUnitHour){if($("#deadlineTimeUnitHour select").val()<i){e=false}}}}if(e){h.saveCurrentEditorWithUndo()}else{var s=$("#deadline-editor").find(".editor-error-messages");s.html(t("error.workflow.deadlineIsTooShortForImport",i));s.css("display","block")}},onTimeChanged:function(){var e=$('form[name="'+this.formName+'"]');var t=e.find('input[name="deadlineType"]:checked').val();var i=e.find('select[name="timeUnit"]').val();if(t==v.constants.deadlineTypeDelay&&i==v.constants.deadlineTimeUnitDay){e.find('input[name="useTime"]').prop("checked",true)}},hideDiv:function(e){$('form[name="'+this.formName+'"] #'+e).css("display","none")},showDiv:function(e){$('form[name="'+this.formName+'"] #'+e).css("display","block")},dateAsUTC:function(e){if(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))}else{return null}},checkPresentNodeOfType:function(e){return h.getNodesByTypes(e).length>0},checkPrecededByImportIcon:function(e){return h.getNodesByIncomingConnections(e).some(function(e){return v.NODE_TYPE_IMPORT==e.getType()})}});p.addAction({change:"deadline-editor-update"},function(){e.updateVisibility()});p.addAction({change:"deadline-editor-time-change"},function(){e.onTimeChanged()});p.addAction({click:"deadline-editor-save"},function(){e.validateEditor()})});this.addDomInitializer("archive-editor-initializer",function(){var e=h.registerEditor("archive",{formName:"archiveForm",safeToSave:true,getTitle:function(){return t("workflow.mailing.archive")},createNewArchive:function(){h.processForward(v.constants.forwardArchiveCreate,"#settings_general_campaign",m)},fillEditor:function(e){var t=$('form[name="'+this.formName+'"]');var i=e.getData();t.submit(false);t.get(0).reset();h.fillFormFromObject(this.formName,i,"")},saveEditor:function(){return h.formToObject(this.formName)}});p.addAction({click:"archive-editor-new"},function(){e.createNewArchive()})});this.addDomInitializer("recipient-editor-initializer",function(){var n=v.constants.isAltgExtended;var i=h.registerEditor("recipient",{formName:"recipientForm",targetSelector:"#recipientTargetSelect",altgSelector:"#recipientAltgSelect",safeToSave:true,getTargetFieldSelect:function(){return new u($(this.targetSelector).select2({formatSelection:function(e){if($(e.element).data("editable")){return'<a href="#" class="btn-link-light" '+'data-action="recipient-editor-target-edit" data-target-id="'+e.id+'">'+e.text+"</a>"}else{return e.text}}}))},getAltgFieldSelect:function(){return new u($(this.altgSelector).select2({formatSelection:function(e){return e.text}}))},createNewTarget:function(){h.processForward(v.constants.forwardTargetGroupCreate,this.targetSelector,m)},editTarget:function(e){$("#forwardTargetItemId").val(e);h.processForward(v.constants.forwardTargetGroupEdit,this.targetSelector,m)},getTitle:function(){return t("workflow.recipient")},fillEditor:function(e){var t=e.getData();if(!n){if(v.constants.accessLimitTargetId>0){t.targets=_.union([v.constants.accessLimitTargetId],t.targets);t.targetsOption="ALL_TARGETS_REQUIRED"}}var i=$('form[name="'+this.formName+'"]');i.submit(false);i.get(0).reset();h.fillFormFromObject(this.formName,t,"");this.getTargetFieldSelect().selectValue(t.targets);if(n){this.getAltgFieldSelect().selectValue(t.altgs)}},saveEditor:function(){var e=h.formToObject(this.formName);e.targets=this.getTargetFieldSelect().getSelectedValue();if(n){e.altgs=this.getAltgFieldSelect().getSelectedValue()}return e}});p.addAction({click:"recipient-editor-create-new-target"},function(){i.createNewTarget()});p.addAction({click:"recipient-editor-save"},function(){if(n){var e=AGN.Lib.Form.get($("#"+i.formName));if(e.valid({})){e.cleanErrors();h.saveCurrentEditorWithUndo()}else{e.handleErrors()}}else{h.saveCurrentEditorWithUndo()}});p.addAction({click:"recipient-editor-target-edit"},function(){i.editTarget(this.el.data("target-id"))})});this.addDomInitializer("export-editor-initializer",function(){var o=this.config;var e=h.registerEditor("export",{formName:"exportForm",safeToSave:true,getTitle:function(){return t("auto_export")},createNewAutoExport:function(){h.processForward(v.constants.forwardAutoExportCreate,'form[name="'+this.formName+'"] select[name=importexportId]',m)},editAutoExport:function(){var e=$('form[name="'+this.formName+'"] select[name=importexportId]');var t=e.val();$("#forwardTargetItemId").val(t);h.processForward(v.constants.forwardAutoExportEdit,'form[name="'+this.formName+'"] select[name=importexportId]',m)},fillEditor:function(e){var i=$("#export-editor .editor-error-messages");var n=$('form[name="'+this.formName+'"]');var r=e.getData();n.submit(false);n.get(0).reset();h.fillFormFromObject(this.formName,r,"");this.addLinks();if(o.isDisabled=="true"){i.html(t("error.workflow.autoExportPermission"));i.css("display","block")}else{i.css("display","none")}},validateEditor:function(){var i=$("#export-editor .editor-error-messages");var e=$('form[name="'+this.formName+'"] select[name=importexportId]');if(e.val()>0){$.ajax({type:"POST",url:AGN.url("/workflow/validateDependency.action"),data:{workflowId:v.workflowId||0,type:v.DEPENDENCY_TYPE_AUTO_EXPORT,entityId:e.val()}}).done(function(e){if(e.valid===true){h.saveCurrentEditorWithUndo()}else{i.html(t("error.workflow.autoExportInUse"));i.css("display","block")}}).fail(function(){i.html(t("Error"));i.css("display","block")})}else{i.html(t("error.workflow.noExport"));i.css("display","block")}},onChange:function(){this.addLinks()},addLinks:function(){var e=$('form[name="'+this.formName+'"] select[name=importexportId]');var t=e.val();if(t>0){$("#export-editor #editAutoExportLink").css("display","block");$("#export-editor #createAutoExportLink").css("display","none")}else{$("#export-editor #createAutoExportLink").css("display","block");$("#export-editor #editAutoExportLink").css("display","none")}},saveEditor:function(){return h.formToObject(this.formName)},isSetFilledAllowed:function(){var e=$('form[name="'+this.formName+'"] select[name=importexportId]');var t=e.find(":selected");return!(e.val()==0||t.data("is-available")!=true)}});p.addAction({change:"export-editor-change"},function(){e.onChange()});p.addAction({click:"export-editor-new"},function(){e.createNewAutoExport()});p.addAction({click:"export-editor-autoexport"},function(){e.editAutoExport()});p.addAction({click:"export-editor-save"},function(){e.validateEditor()})});this.addDomInitializer("import-editor-initializer",function(){var o=this.config;var e=h.registerEditor("import",{formName:"importForm",safeToSave:true,getTitle:function(){return t("auto_import")},createNewAutoImport:function(){h.processForward(v.constants.forwardAutoImportCreate,"#importexportId",m)},editAutoImport:function(){var e=$('form[name="'+this.formName+'"] select[name=importexportId]');var t=e.val();$("#forwardTargetItemId").val(t);h.processForward(v.constants.forwardAutoImportEdit,'form[name="'+this.formName+'"] select[name=importexportId]',m)},fillEditor:function(e){var i=$("#import-editor .editor-error-messages");var n=$('form[name="'+this.formName+'"]');var r=e.getData();n.submit(false);n.get(0).reset();h.fillFormFromObject(this.formName,r,"");this.addLinks();if(o.isDisabled=="true"){i.html(t("error.workflow.autoImportPermission"));i.css("display","block")}else{i.css("display","none")}},validateEditor:function(){var i=$("#import-editor .editor-error-messages");var e=$('form[name="'+this.formName+'"] select[name=importexportId]');if(e.val()>0){$.ajax({type:"POST",url:AGN.url("/workflow/validateDependency.action"),data:{workflowId:v.workflowId||0,type:v.DEPENDENCY_TYPE_AUTO_IMPORT,entityId:e.val()}}).done(function(e){if(e.valid===true){h.saveCurrentEditorWithUndo()}else{i.html(t("error.workflow.autoImportInUse"));i.css("display","block")}}).fail(function(){i.html(t("Error"));i.css("display","block")})}else{i.html(t("error.workflow.noImport"));i.css("display","block")}},onChange:function(){this.addLinks()},addLinks:function(){var e=$('form[name="'+this.formName+'"] select[name=importexportId]');var t=e.val();if(t>0){$("#import-editor #editAutoImportLink").css("display","block");$("#import-editor #createAutoImportLink").css("display","none")}else{$("#import-editor #createAutoImportLink").css("display","block");$("#import-editor #editAutoImportLink").css("display","none")}},saveEditor:function(){return h.formToObject(this.formName)},isSetFilledAllowed:function(){var e=$('form[name="'+this.formName+'"] select[name=importexportId]');var t=e.find(":selected");return!(e.val()==0||t.data("is-available")!=true)}});p.addAction({change:"import-editor-change"},function(){e.onChange()});p.addAction({click:"import-editor-new"},function(){e.createNewAutoImport()});p.addAction({click:"import-editor-update"},function(){e.editAutoImport()});p.addAction({click:"import-editor-save"},function(){e.validateEditor()})});this.addDomInitializer("start-editor-initializer",function(){var u=this.config;var d=new s(u.form,u.container,u.selectedName,u.noMailingOption);var i=u.profileFields;var m=u.isBigData;var e={rulesNumber:0,isStartEditor:false,timePattern:/^(\d{2}):(\d{2})$/,getTitle:function(){return this.isStartEditor?t("workflow.start.title"):t("workflow.stop.title")},getStartStopDate:function(e){e=e||h.formToObject("startForm");var t=$('form[name="startForm"]');var i=null;if(this.isStartEditor){switch(e.startType){case v.constants.startTypeDate:i=t.find("#startDate").pickadate("picker");break;case v.constants.startTypeEvent:i=t.find("#executionDate").pickadate("picker");break}}else if(e.endType==v.constants.endTypeDate){i=t.find("#startDate").pickadate("picker")}if(i){var n=i.get("select");if(n){return n.obj}}return null},generateReminderComment:function(){var e=$('#workflowForm input[name="workflow.shortname"]').val();var i=n.getDateStr(this.getStartStopDate(),u.localeDatePattern);return(this.isStartEditor?t("workflow.start.reminder_text"):t("workflow.stop.reminder_text")).replace(/:campaignName/g,e).replace(/:startDate/g,i).replace(/:endDate/g,i)},fillEditor:function(e){var i=e.getData();var n=e.getType();this.isStartEditor=n=="start";const r=this.isStartEditor&&(e.data.startType===v.constants.startTypeEvent||!g.isAutoOptimizationWorkflow(e));this.updateEditorType(this.isStartEditor,r);var o=$('form[name="startForm"]');o.submit(false);o.find(".rule-row").each(function(){$(this).remove()});o.find("#remindCalendarDateTitle").text(this.isStartEditor?t("workflow.start.start_date"):t("workflow.stop.end_date"));if(i.rules!=undefined){for(var s=0;s<i.rules.length;s++){var a=i.rules[s];this.createRuleRow(s,a)}this.rulesNumber=i.rules.length}o.get(0).reset();i.adminTimezone=u.adminTimezone;i.sendReminder=i.scheduleReminder;h.fillFormFromObject("startForm",i,"");d.setMailingId(i.mailingId);d.cleanOptions(1);var l=new Date;o.find("#startDate").pickadate("picker").set("select",this.dateAsUTC(i.date!=undefined?i.date:l));o.find("#executionDate").pickadate("picker").set("select",this.dateAsUTC(i.date!=undefined?i.date:l));o.find("#remindDate").pickadate("picker").set("select",this.dateAsUTC(i.remindDate!=undefined?i.remindDate:l));if(i.date!=undefined){o.find("#startTime").val(this.formatTime(i.hour,i.minute));o.find("#remindTime").val(this.formatTime(i.remindHour,i.remindMinute))}else{this.setCurrentTime()}this.updateChainFieldsVisibility();this.updateVisibility();this.updateOperatorsAvailability();if(i.startType==v.constants.startTypeEvent&&i.event==v.constants.startEventReaction&&i.reaction==v.constants.reactionClickedLink&&i.mailingId!=0&&i.mailingId!=null){this.onMailingSelectChange(i.mailingId,i.linkId)}if(!i.comment){o.find("#reminderComment").val(this.generateReminderComment())}var c;if(i.recipients!=""){c=2}else{c=1}$('#start-editor input[name="userType"][value='+c+"]").prop("checked",true).trigger("change");$("#start-editor .editor-error-messages").css("display","none");y.get(o).cleanErrors();if(!this.isStartEditor){this.hideDiv("end-date-radio")}else{this.showDiv("end-date-radio")}},saveEditor:function(){var e=h.formToObject("startForm");e.date=this.getStartStopDate(e);if(e.date==null){e.date=new Date;e.date.setHours(0);e.date.setMinutes(0);e.date.setSeconds(0);e.date.setMilliseconds(0)}var t;var i=$('form[name="startForm"] #startTime').val();if(t=this.timePattern.exec(i)){e.hour=t[1];e.minute=t[2]}else{e.hour=0;e.minute=0}e.scheduleReminder=e.sendReminder;var n=$('form[name="startForm"] #remindTime').val();if(t=this.timePattern.exec(n)){e.remindHour=t[1];e.remindMinute=t[2]}else{e.remindHour=0;e.remindMinute=0}if($('input[name="remindSpecificDate"]:checked').val()=="true"){e.remindDate=$('form[name="startForm"] #remindDate').pickadate("picker").get("select").obj}else{e.remindDate=e.date;e.remindHour=0;e.remindMinute=0}if(e.rules==undefined){e.rules=[]}if(e.linkId==undefined||e.linkId==null){e.linkId=0}if(e.dateFieldOperator!=u.equelsOperatorCode){e.dateFieldOperator=u.equelsOperatorCode}if(e.userType==2){e.remindAdminId=0;e.recipients=$.trim(e.recipients).toLowerCase().split(/[,;\s\n\r]+/).filter(function(e){return!!e}).join(", ")}else{e.recipients=""}delete e.userType;return e},validateEditorInternal:function(d){var h=this;var f=true;var p=$("#start-editor .editor-error-messages");var g=$('form[name="startForm"]');var e=this.isStartEditor?g.find('input[name="startType"]:checked').val():g.find('input[name="endType"]:checked').val();if(this.isStartEditor&&e==v.constants.startTypeEvent){n();r()}if(this.isStartEditor&&e==v.constants.startTypeDate||!this.isStartEditor&&e==v.constants.endTypeDate){r()}if(f&&g.find("#sendReminder").is(":checked")){var i=g.find('input[name="userType"]:checked').val();if(i==2){o()}}return f;function n(){var e=g.find('select[name="event"]').val();switch(e){case v.constants.startEventDate:var i=g.find("#executionDate").pickadate("picker").get("select").obj;if(i){var n=g.find("#startTime").val();if(!h.timePattern.test(n)){f=false}}else{f=false}var r=g.find("#dateFieldValue");if(!$.trim(r.val())){f=false;if(d){p.html(t("error.workflow.startDateOmitted"));p.css("display","block")}}const a=g.find("#dateProfileField");if(!$.trim(a.val())){f=false;if(d){y.get(a).showFieldError("dateProfileField",t("fields.required.errors.missing"))}}break;case v.constants.startEventReaction:var o=g.find('select[name="reaction"]').val();switch(o){case v.constants.reactionClickedLink:const l=g.find('select[name="linkId"]').val();if(!l||parseInt(l,10)<=0){f=false;if(d){p.html(t("error.workflow.noLinkSelected"));p.css("display","block")}}case v.constants.reactionOpened:case v.constants.reactionClicked:const c=g.find('select[name="mailingId"]').val();if(parseInt(c,10)<=0){f=false;if(d){p.html(t("error.workflow.noMailing"));p.css("display","block")}}break;case v.constants.reactionChangeOfProfile:if(typeof m!="undefined"&&m==true){var s=g.find('select[name="profileField"]').val();if(!s){f=false}}const u=g.find("#startProfileField");if(!$.trim(u.val())){f=false;if(d){y.get(u).showFieldError("profileField",t("fields.required.errors.missing"))}}break;case v.constants.reactionWaitingForConfirm:case v.constants.reactionOptIn:case v.constants.reactionOptOut:break;default:f=false;break}break}}function r(){var e=g.find("#startDate").pickadate("picker").get("select").obj;if(e){var t=g.find("#startTime").val();if(!h.timePattern.test(t)){f=false}}else{f=false}}function o(){var e=$.trim(g.find('textarea[name="recipients"]').val()).split(/[,;\s\n\r]+/).filter(function(e){return!!e});if(!e.length){if(d){f=false;p.html(t("error.workflow.emptyRecipientList"));p.css("display","block")}}}},validateEditor:function(){if(this.validateEditorInternal(true)){h.saveCurrentEditorWithUndo()}},isSetFilledAllowed:function(){return this.validateEditorInternal(false)},setCurrentTime:function(){var t=this;$.ajax({type:"GET",url:AGN.url("/workflow/getCurrentAdminTime.action"),success:function(e){$('form[name="startForm"] #startTime').val(t.formatTime(e.hour,e.minute));$('form[name="startForm"] #remindTime').val(t.formatTime(e.remindHour,e.remindMinute))}})},updateEditorType:function(e,i){var n=$("#startStopType");n.empty();if(e){n.append(c.text("start-types",{showStartEventTab:i}));$("#eventReaction").html(t("workflow.start.reaction_based"));$("#eventDate").html(t("workflow.start.date_based"))}else{n.append(c.text("stop-types"));if(this.checkPresentNodeOfType([v.NODE_TYPE_ACTION_BASED_MAILING,v.NODE_TYPE_DATE_BASED_MAILING])){$("#endTypeActiomaticLabel").html(t("workflow.stop.open_end"))}else{$("#endTypeActiomaticLabel").html(t("workflow.stop.automatic_end"))}}},onRulesChanged:function(){var r=0;$('form[name="startForm"] #profileFieldAddedRules tr').each(function(){var e=$(this);var t=e.attr("id");var i=t.substring(5);var n=$("#"+t);n.find(".rule-field").attr("name",function(e,t){return t?t.replace(i,r+""):""});n.find(".delete-rule").attr("data-rule-index",function(e,t){return t==i?r:t});e.attr("id","rule_"+r);r++});this.updateChainFieldsVisibility()},updateChainFieldsVisibility:function(){if(this.rulesNumber>0){$('form[name="startForm"] [name="rules[0].chainOperator"]').css("visibility","hidden");$('form[name="startForm"] #newRule_chainOperator').css("visibility","visible")}else{$('form[name="startForm"] #newRule_chainOperator').css("visibility","hidden")}},updateOperatorsAvailability:function(){var e=$('form[name="startForm"] select[name="profileField"]').val();var t=i[e];$('form[name="startForm"] select.primary-operator').each(function(){var e=$(this);e.children("option").prop("disabled",function(){var e=$(this).data("types");if(e=="*"||!e){return false}return e.split(/[\s,]+/).indexOf(t)==-1});AGN.Lib.CoreInitializer.run("select",e);if(e.val()==null){h.initSelectWithFirstValue(e)}})},addRule:function(){var e=$('form[name="startForm"]');var t={chainOperator:e.find("#newRule_chainOperator").val(),parenthesisOpened:e.find("#newRule_parenthesisOpened").val(),primaryOperator:e.find("#newRule_primaryOperator").val(),primaryValue:e.find("#newRule_primaryValue").val(),parenthesisClosed:e.find("#newRule_parenthesisClosed").val()};this.createRuleRow(this.rulesNumber,t);h.fillFormFromObject("startForm",t,"rules["+this.rulesNumber+"].");this.rulesNumber++;if($("#newRule_primaryOperator").val()==v.constants.operatorIs){$("#newRule_primaryValue").parents("td").replaceWith(this.createSimpleNewRuleValueField())}this.updateChainFieldsVisibility();this.updateOperatorsAvailability();e.find("#profileFieldRuleAdd select").each(function(){h.initSelectWithFirstValue($(this))});e.find("#profileFieldRuleAdd input").each(function(){$(this).val("")})},removeRuleRow:function(e){$('form[name="startForm"] #rule_'+e).remove();this.rulesNumber--;this.onRulesChanged()},createRuleRow:function(e,i){var n=$('form[name="startForm"] #profileFieldAddedRules');var r=this.createSimpleRuleValueField(e);var o=f.arrayAsOptionsHtml(v.constants.operators);if(this.curProfileField&&this.curProfileField.toLowerCase()==v.GENDER_PROFILE_FIELD){r=this.createGenderSelect()}else if(i.primaryOperator==v.constants.operatorIs){r=this.createIsOperatorSelect()}n.append('<tr class="rule-row" id="rule_'+e+'">'+'<td><select name="rules['+e+'].chainOperator" class="rule-field">'+'<option value="'+v.constants.chainOperatorAnd+'">'+t("workflow.defaults.and")+"</option>"+'<option value="'+v.constants.chainOperatorOr+'">'+t("workflow.defaults.or")+"</option>"+"</select></td>"+'<td><select name="rules['+e+'].parenthesisOpened" class="parentheses-opened rule-field">'+'<option value="0">&nbsp</option>'+'<option value="1">(</option>'+"</select></td>"+'<td><select name="rules['+e+'].primaryOperator" class="primary-operator rule-field" data-action="start-rule-operator-change">'+o+"</select></td>"+r+'<td><select name="rules['+e+'].parenthesisClosed" class="parenthesis-closed rule-field">'+'<option value="0">&nbsp</option>'+'<option value="1">)</option>'+"</select></td>"+'<td><a class="mailing_delete delete-rule btn btn-regular btn-alert" href="#" data-action="start-editor-rule-remove" data-rule-index="'+e+'"><i class="icon icon-minus-circle"></i></a></td>'+"</tr>");this.addRuleProperties($("#rule_"+e+" .primary-value"),e);AGN.runAll(n)},onStartTypeChanged:function(){var e=this.isStartEditor?$('form[name="startForm"] input[name="startType"]:checked').val():$('form[name="startForm"] input[name="endType"]:checked').val();if(this.isStartEditor&&e==v.constants.startTypeDate||!this.isStartEditor&&e==v.constants.endTypeDate){this.toggleFormat();this.hideDiv("startEventPanel");this.showDiv("startDatePanel");this.showDiv("startIconTime");this.showDiv("startRemindAdmin")}else if(this.isStartEditor&&e==v.constants.startTypeEvent){this.hideDiv("startDatePanel");this.showDiv("startEventPanel");this.showDiv("startIconTime");this.showDiv("startRemindAdmin");this.onStartEventChanged()}else if(this.isStartEditor&&e==v.constants.startTypeOpen||!this.isStartEditor&&e==v.constants.endTypeAutomatic){this.hideDiv("startDatePanel");this.hideDiv("startEventPanel");this.hideDiv("startIconTime");this.hideDiv("startRemindAdmin")}},onStartEventChanged:function(){var e=$("#startEvent").val();if(e==v.constants.startEventReaction){this.toggleFormat();this.hideDiv("dateStartPanel");this.showDiv("reactionStartPanel");this.onExecutionChanged();this.onProfileFieldChanged()}else if(e==v.constants.startEventDate){this.toggleFormat();this.hideDiv("reactionStartPanel");this.showDiv("dateStartPanel");this.hideDiv("executionDateLabel");this.showDiv("firstExecutionDateLabel");$("#startIconDateFormat").insertAfter("#startIconDateFieldOperator");this.showDiv("startIconDateFormat")}},toggleFormat:function(){var e,t,i,n,r;return function(){i=i||$("select#startEvent");t=t||$("input#typeEvent");e=e||$("input#startTime");n=t.prop("checked");r=i.val()==v.constants.startEventDate;t.prop("checked")&&r?e.inputmask("h:00"):e.inputmask("h:s")}}(),onRuleModeChanged:function(){var e=$('input[name="useRules"]:checked').val();if(e=="false"){this.hideDiv("profileFieldRules")}else{this.showDiv("profileFieldRules")}},onProfileFieldChanged:function(){var e=$('form[name="startForm"] select[name="profileField"]').val();var t=i[e];if(t&&t.toLowerCase()==v.FIELD_TYPE_DATE){$("#startIconDateFormat").insertAfter("#reactionProfileField");this.showDiv("startIconDateFormat")}else{this.hideDiv("startIconDateFormat")}this.updateOperatorsAvailability()},getRuleIndex:function(e){return e.attr("id").substring(5)},onRuleOperatorChanged:function(e){if(this.curProfileField&&this.curProfileField.toLowerCase()==v.GENDER_PROFILE_FIELD){return}var t=e.closest("tr");var i=t.attr("id")?this.getRuleIndex(t):null;if(e.val()==v.constants.operatorIs){var n=$(this.createIsOperatorSelect());t.find(".primary-value").parents("td").replaceWith(n);AGN.Lib.CoreInitializer.run("select",n)}else if(t.find(".primary-value").hasClass("null-select")){var r;if(i==null){r=this.createSimpleNewRuleValueField()}else{r=this.createSimpleRuleValueField(i)}t.find(".primary-value").parents("td").replaceWith(r)}if(i==null){this.addNewRuleProperties(t.find(".primary-value"))}else{this.addRuleProperties(t.find(".primary-value"),i)}},createGenderSelect:function(){var e=f.mapAsOptionsHtml(v.constants.genderOptions);return'<td><select class="primary-value form-control">'+e+"</select></td>"},createIsOperatorSelect:function(){return'<td><select class="primary-value null-select form-control">'+'<option value="NULL">NULL</option>'+'<option value="NOT_NULL">NOT NULL</option>'+"</select></td>"},createSimpleRuleValueField:function(e){return'<td><input name="rules['+e+'].primaryValue" type="text" class="primary-value rule-field form-control"/></td>'},createSimpleNewRuleValueField:function(){return'<td><input id="newRule_primaryValue" type="text" class="primary-value form-control"/></td>'},addRuleProperties:function(e,t){e.filter("select, input").attr("name","rules["+t+"].primaryValue").addClass("rule-field")},addNewRuleProperties:function(e){e.filter("select, input").attr("id","newRule_primaryValue")},onExecutionChanged:function(){var e=$('input[name="executeOnce"]:checked').val();if(e=="false"){this.hideDiv("executionDateLabel");this.showDiv("firstExecutionDateLabel")}else{this.hideDiv("firstExecutionDateLabel");this.showDiv("executionDateLabel")}},onReactionChanged:function(){var e=$('form[name="startForm"] #startReaction').val();if(e==v.constants.reactionOpened||e==v.constants.reactionNotOpened||e==v.constants.reactionClicked||e==v.constants.reactionNotClicked||e==v.constants.reactionBought||e==v.constants.reactionNotBought||e==v.constants.reactionClickedLink){this.hideDiv("reactionStartProfile");this.showDiv("reactionStartMailing")}else if(e==v.constants.reactionChangeOfProfile){this.hideDiv("reactionStartMailing");this.showDiv("reactionStartProfile")}else{this.hideDiv("reactionStartMailing");this.hideDiv("reactionStartProfile")}if(e==v.constants.reactionClickedLink){this.showDiv("reactionStartMailingLink")}else{this.hideDiv("reactionStartMailingLink")}},onReminderChanged:function(){if($('input[name="sendReminder"]:checked').val()){$('form[name="startForm"]').find("#reminderComment").val(this.generateReminderComment());this.showDiv("reminderDetails")}else{this.hideDiv("reminderDetails")}return false},onScheduleReminderDateChanged:function(){if($('form[name="startForm"] input[name="remindSpecificDate"]:checked').val()=="true"){this.showDiv("dateTimePicker")}else{this.hideDiv("dateTimePicker")}return false},onMailingSelectChange:function(e,t){var i=$('form[name="startForm"] select[name="linkId"]');var n=parseInt(e,10);if(n>0){i.attr("readonly","readonly");$.ajax({type:"POST",url:AGN.url("/workflow/getMailingLinks.action"),data:{mailingId:n},success:function(e){i.empty();i.append($("<option></option>",{value:"",text:v.EMPTY_OPTION_PLACEHOLDER}));$.each(e,function(e,t){i.append($("<option></option>",{value:t.id,text:t.url}))});i.removeAttr("readonly");if(t!=null&&t!=undefined){i.val(t);h.initSelectWithValueOrChooseFirst(i,t)}else{h.initSelectWithFirstValue(i)}}})}else{i.empty()}},updateVisibility:function(){this.onStartTypeChanged();this.onStartEventChanged();this.onReactionChanged();this.onRuleModeChanged();this.onExecutionChanged();this.onReminderChanged();this.onScheduleReminderDateChanged()},hideDiv:function(e){$('form[name="startForm"] #'+e).css("display","none")},showDiv:function(e){$('form[name="startForm"] #'+e).css("display","")},dateAsUTC:function(e){if(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))}else{return null}},formatTime:function(e,t){var i=0;var n=0;e=parseInt(e,10);if(e>=0){i=e}t=parseInt(t,10);if(t>=0){n=t}return(i<10?"0"+i:i)+":"+(n<10?"0"+n:n)},checkPresentNodeOfType:function(e){return h.getNodesByTypes(e).length>0}};h.registerEditor("start",e);h.registerEditor("stop",e);p.addAction({change:"start-editor-execution-changed"},function(){e.onExecutionChanged()});p.addAction({change:"start-editor-event-changed"},function(){e.onStartEventChanged()});p.addAction({change:"start-editor-type-changed"},function(){e.onStartTypeChanged()});p.addAction({change:"start-editor-rule-changed"},function(){e.onRuleModeChanged()});p.addAction({change:"start-editor-reaction-changed"},function(){e.onReactionChanged()});p.addAction({change:"start-editor-profile-field-changed"},function(){e.onProfileFieldChanged()});p.addAction({click:"start-editor-add-rule"},function(){e.addRule()});p.addAction({click:"start-editor-reminder-changed"},function(){e.onReminderChanged()});p.addAction({click:"start-editor-schedule-reminder-date-changed"},function(){e.onScheduleReminderDateChanged()});p.addAction({click:"start-editor-validate"},function(){e.validateEditor()});p.addAction({click:"start-editor-mailing-sort-date"},function(){d.onMailingSortClick("date")});p.addAction({change:"start-editor-mailing-select"},function(){e.onMailingSelectChange(this.el.val())});p.addAction({click:"start-editor-mailing-sort-shortname"},function(){d.onMailingSortClick("shortname")})});this.addDomInitializer("decision-editor-initializer",function(){var d=this.config;var n=d.profileFields;var a=new s(d.form,d.container,d.selectName,d.noMailingOption);var l;var e=h.registerEditor("decision",{rulesNumber:0,rulePrefix:"decision_",prevProfileField:"",curProfileField:"",getTitle:function(){return t("workflow.decision")},fillEditor:function(e){var t=$('form[name="decisionForm"]');l=0;var i=e.getData();t.submit(false);t.find(".rule-row").each(function(){$(this).remove()});this.curProfileField=i.profileField;this.possibleToUseAutoOptimization=g.isAutoOptimizationDecisionAllowed(e);if(i.rules!=undefined){for(var n=0;n<i.rules.length;n++){var r=i.rules[n];this.createRuleRow(n,r)}this.rulesNumber=i.rules.length}t.get(0).reset();if(i.profileField){i.profileField=i.profileField.toLowerCase()}h.fillFormFromObject("decisionForm",i,"");a.setMailingId(i.mailingId);a.cleanOptions(1);if(i.decisionDate==undefined){i.decisionDate=new Date}var o=t.find("#decisionDate");var s=t.find("#decisionTime");if(this.checkPresentNodeOfType([v.NODE_TYPE_ACTION_BASED_MAILING,v.NODE_TYPE_DATE_BASED_MAILING])){o.parent().parent().parent().parent().hide();s.parent().parent().parent().parent().hide()}else{o.parent().parent().parent().parent().show();s.parent().parent().parent().parent().show();o.pickadate("picker").set("select",this.dateAsUTC(i.decisionDate));s.val(("0"+i.decisionDate.getHours()).slice(-2)+":"+("0"+i.decisionDate.getMinutes()).slice(-2))}this.updateChainFieldsVisibility();this.updateVisibility();this.updateDateFormatVisibility();this.updateOperatorsAvailability();if(i.decisionType==v.constants.decisionTypeDecision&&i.decisionCriteria==v.constants.decisionReaction&&i.reaction==v.constants.reactionClickedLink&&(i.mailingId!=0&&i.mailingId!=null)){this.onMailingSelectChange(i.mailingId,i.linkId)}else{h.resetSelect(t.find('select[name="linkId"]'))}$("#decision-editor .editor-error-messages").css("display","none");y.get(t).cleanErrors()},saveEditor:function(){var e=h.formToObject("decisionForm");if(e.decisionCriteria==v.constants.decisionProfileField&&l!=0){e.mailingId=l}l=0;if(e.rules==undefined){e.rules=[]}if(!e.threshold){e.threshold=""}if(this.checkPresentNodeOfType([v.NODE_TYPE_ACTION_BASED_MAILING,v.NODE_TYPE_DATE_BASED_MAILING])){e.decisionDate=null}else{var t=$('form[name="decisionForm"]');e.decisionDate=t.find("#decisionDate").pickadate("picker").get("select").obj;var i=t.find("#decisionTime").val();e.decisionDate.setHours(i.substring(0,2));e.decisionDate.setMinutes(i.substring(3,5))}return e},validateEditor:function(){var e=$('form[name="decisionForm"]');var i=$("#decision-editor .editor-error-messages");var n=e.find('input[name="decisionType"]:checked').val();var r=$("#decisionCriteria").val();var o=e.find('select[name="mailingId"]').val();var s=e.find('select[name="linkId"]').val();var a=e.find('select[name="reaction"]').val();var l=e.find('input[name="threshold"]').val();if(n==v.constants.decisionTypeDecision&&r==v.constants.decisionReaction&&o==0){i.html(t("error.workflow.noMailing"));i.css("display","block")}else if(n==v.constants.decisionTypeDecision&&r==v.constants.decisionReaction&&a==v.constants.reactionClickedLink&&(s==0||s==null)){i.html(t("error.workflow.noLinkSelected"));i.css("display","block")}else if(n==v.constants.decisionTypeDecision&&r==v.constants.decisionProfileField){if(d.isMailtrackingActive=="true"){const u=e.find("#decisionProfileField");if(!$.trim(u.val())){y.get(e).showFieldError("profileField",t("fields.required.errors.missing"))}else{h.saveCurrentEditorWithUndo()}}}else if(n==v.constants.decisionTypeAutoOptimization){if(l){var c=parseInt(l,10);if(c&&c>0){h.saveCurrentEditorWithUndo()}else{i.html(t("error.workflow.noValidThreshold"));i.css("display","block")}}else{h.saveCurrentEditorWithUndo()}}else{h.saveCurrentEditorWithUndo()}},onTypeChanged:function(){var e=$('form[name="decisionForm"] input[name="decisionType"]:checked').val();if(!this.possibleToUseAutoOptimization&&e===v.constants.decisionTypeAutoOptimization){const i=$("#decision-editor .editor-error-messages");i.html(t("error.workflow.autoOptimizationDecisionForbidden"));i.css("display","block");$('form[name="decisionForm"] input[name="decisionType"]').filter(':radio[value="'+v.constants.decisionTypeDecision+'"]').prop("checked",true);return}if(e==v.constants.decisionTypeDecision){this.hideDecisionFormDiv("autoOptimizationPanel");this.showDecisionFormDiv("decisionPanel")}else if(e==v.constants.decisionTypeAutoOptimization){this.hideDecisionFormDiv("decisionPanel");this.showDecisionFormDiv("autoOptimizationPanel")}this.updateVisibilityOfRuleMailingReceived()},onDecisionReactionChanged:function(){var e=$('form[name="decisionForm"] select[name="reaction"]').val();if(e==v.constants.reactionClickedLink){this.showDecisionFormDiv("reactionLinkPanel");var t=$('form[name="decisionForm"] select[name="mailingId"]').val();this.onMailingSelectChange(t,0)}else{this.hideDecisionFormDiv("reactionLinkPanel")}},onCriteriaChanged:function(){var e=$('form[name="decisionForm"] select[name="decisionCriteria"]').val();if(e==v.constants.decisionReaction){this.hideDecisionFormDiv("decisionProfileFieldPanel");this.showDecisionFormDiv("decisionReactionPanel")}else if(e==v.constants.decisionProfileField){this.hideDecisionFormDiv("decisionReactionPanel");this.showDecisionFormDiv("decisionProfileFieldPanel")}this.updateVisibilityOfRuleMailingReceived()},onMailingSelectChange:function(e,t){var i=$('form[name="decisionForm"] select[name="linkId"]');var n=parseInt(e,10);if(n>0){i.attr("readonly","readonly");$.ajax({type:"POST",url:AGN.url("/workflow/getMailingLinks.action"),data:{mailingId:n},success:function(e){i.empty();i.append($("<option></option>",{value:"",text:v.EMPTY_OPTION_PLACEHOLDER}));$.each(e,function(e,t){i.append($("<option></option>",{value:t.id,text:t.url}))});i.removeAttr("readonly");if(t!=null&&t!=undefined){i.val(t);h.initSelectWithValueOrChooseFirst(i,t)}else{h.initSelectWithFirstValue(i)}}})}else{i.empty()}},onRuleOperatorChanged:function(e){if(this.curProfileField&&this.curProfileField.toLowerCase()==v.GENDER_PROFILE_FIELD){return}var t=e.closest("tr");var i=t.attr("id")?this.getRuleIndex(t):null;if(e.val()==v.constants.operatorIs){var n=$(this.createIsOperatorSelect());t.find(".primary-value").parents("td").replaceWith(n);AGN.Lib.CoreInitializer.run("select",n)}else if(t.find(".primary-value").hasClass("null-select")){var r;if(i==null){r=this.createSimpleNewRuleValueField()}else{r=this.createSimpleRuleValueField(i)}t.find(".primary-value").parents("td").replaceWith(r)}if(i==null){this.addNewRuleProperties(t.find(".primary-value"))}else{this.addRuleProperties(t.find(".primary-value"),i)}},getRuleIndex:function(e){return e.attr("id").substring(14)},onProfileFieldChanged:function(){var e=$('form[name="decisionForm"]');var t=e.find('select[name="profileField"]').val();this.curProfileField=t;var i=this;if(t&&t.toLowerCase()==v.GENDER_PROFILE_FIELD){$("#decisionProfileFieldRules .primary-value").each(function(){$(this).parents("td").remove()});e.find(".rule-row").each(function(){var e=i.getRuleIndex($(this));$(this).find(".decision-rule-operator").parents("td").after(i.createGenderSelect());i.addRuleProperties($(this).find(".primary-value"),e)});$("#decision_newRule_primaryOperator").parents("td").after(this.createGenderSelect());this.addNewRuleProperties($("#decisionProfileFieldRuleAdd .primary-value"))}else if(this.prevProfileField&&this.prevProfileField.toLowerCase()==v.GENDER_PROFILE_FIELD){$("#decisionProfileFieldRules .primary-value").each(function(){$(this).parents("td").remove()});e.find(".rule-row").each(function(){var e=i.getRuleIndex($(this));if($(this).find(".decision-rule-operator").val()==v.constants.operatorIs){$(this).find(".primary-value").parents("td").remove();$(this).find("select").parents("td").after(i.createIsOperatorSelect());i.addRuleProperties($(this).find(".primary-value"),e)}else{$(this).find(".decision-rule-operator").parents("td").after(i.createSimpleRuleValueField(e))}});if($("#decision_newRule_primaryOperator").val()==v.constants.operatorIs){$("#decisionProfileFieldRuleAdd").find("select").parents("td").after(this.createIsOperatorSelect());this.addNewRuleProperties($("#decisionProfileFieldRuleAdd .primaryValue"))}else{$("#decision_newRule_primaryOperator").parents("td").after(this.createSimpleNewRuleValueField())}}this.updateDateFormatVisibility();this.updateOperatorsAvailability();this.prevProfileField=t},updateDateFormatVisibility:function(){var e=$('form[name="decisionForm"] select[name="profileField"]').val();var t=n[e];if(t&&t.toLowerCase()==v.FIELD_TYPE_DATE){this.showDecisionFormDiv("decisionDateFormat")}else{this.hideDecisionFormDiv("decisionDateFormat")}},updateOperatorsAvailability:function(){var e=$('form[name="decisionForm"]');var t=e.find('select[name="profileField"]').val();var i=n[t];e.find("select.decision-rule-operator").each(function(){var e=$(this);e.children("option").prop("disabled",function(){var e=$(this).data("types");if(t&&t.toLowerCase()==v.GENDER_PROFILE_FIELD){return this.text!="="&&this.text!="!="}if(e=="*"||!e){return false}return e.split(/[\s,]+/).indexOf(i)==-1});AGN.Lib.CoreInitializer.run("select",e);if(e.val()==null){h.initSelectWithFirstValue(e)}})},onRulesChanged:function(){var r=0;var o=this;$('form[name="decisionForm"] #decisionProfileFieldAddedRules .rule-row').each(function(){var e=$(this);var t=e.attr("id");var i=o.getRuleIndex(e);var n=$("#"+t);n.find(".rule-field").attr("name",function(e,t){return t?t.replace(i,r+""):""});n.find(".delete-rule").attr("data-rule-index",function(e,t){return t==i?r:t});e.attr("id","decision_rule_"+r);r++});this.updateChainFieldsVisibility()},updateChainFieldsVisibility:function(){var e=$('form[name="decisionForm"]');if(this.rulesNumber>0){e.find('[name="rules[0].chainOperator"]').css("visibility","hidden");e.find("#decision_newRule_chainOperator").css("visibility","visible")}else{e.find("#decision_newRule_chainOperator").css("visibility","hidden")}},addRule:function(){var e=$('form[name="decisionForm"]');var t={chainOperator:e.find("#decision_newRule_chainOperator").val(),parenthesisOpened:e.find("#decision_newRule_parenthesisOpened").val(),primaryOperator:e.find("#decision_newRule_primaryOperator").val(),primaryValue:e.find("#decision_newRule_primaryValue").val(),parenthesisClosed:e.find("#decision_newRule_parenthesisClosed").val()};this.createRuleRow(this.rulesNumber,t);h.fillFormFromObject("decisionForm",t,"rules["+this.rulesNumber+"].");this.rulesNumber++;if($("#decision_newRule_primaryOperator").val()==v.constants.operatorIs){$("#decision_newRule_primaryValue").parents("td").replaceWith(this.createSimpleNewRuleValueField())}this.updateChainFieldsVisibility();this.updateOperatorsAvailability();e.find("#decisionProfileFieldRuleAdd select").each(function(){h.initSelectWithFirstValue($(this))});e.find("#decisionProfileFieldRuleAdd input").each(function(){$(this).val("")})},removeRuleRow:function(e){$('form[name="decisionForm"] #decision_rule_'+e).remove();this.rulesNumber--;this.onRulesChanged()},createRuleRow:function(e,i){var n=$('form[name="decisionForm"]');var r=this.createSimpleRuleValueField(e);var o=f.arrayAsOptionsHtml(v.constants.operators);if(this.curProfileField&&this.curProfileField.toLowerCase()==v.GENDER_PROFILE_FIELD){r=this.createGenderSelect()}else if(i.primaryOperator==v.constants.operatorIs){r=this.createIsOperatorSelect()}n.find("#decisionProfileFieldAddedRules").append('<tr class="rule-row" id="decision_rule_'+e+'">'+'<td><select name="rules['+e+'].chainOperator" class="rule-field">'+'<option value="'+v.constants.chainOperatorAnd+'">'+t("workflow.defaults.and")+"</option>"+'<option value="'+v.constants.chainOperatorOr+'">'+t("workflow.defaults.or")+"</option>"+"</select></td>"+'<td><select name="rules['+e+'].parenthesisOpened" class="parentheses-opened rule-field">'+'<option value="0">&nbsp</option>'+'<option value="1">(</option>'+"</select></td>"+'<td><select name="rules['+e+'].primaryOperator" class="decision-rule-operator rule-field" data-action="decision-rule-operator-change">'+o+"</select></td>"+r+'<td><select name="rules['+e+'].parenthesisClosed" class="parenthesis-closed rule-field">'+'<option value="0">&nbsp</option>'+'<option value="1">)</option>'+"</select></td>"+'<td><a class="mailing_delete delete-rule btn btn-regular btn-alert" href="#" data-action="decision-editor-rule-remove" data-rule-index="'+e+'"><i class="icon icon-minus-circle"></i></a></td>'+"</tr>");this.addRuleProperties($("#decision_rule_"+e+" .primary-value"),e);AGN.runAll(n.find("#decisionProfileFieldAddedRules"))},createGenderSelect:function(){var e=f.mapAsOptionsHtml(v.constants.genderOptions);return'<td><select class="primary-value form-control">'+e+"</select></td>"},createIsOperatorSelect:function(){return'<td><select class="primary-value null-select form-control">'+'<option value="NULL">NULL</option>'+'<option value="NOT_NULL">NOT NULL</option>'+"</select></td>"},createSimpleRuleValueField:function(e){return'<td><input name="rules['+e+'].primaryValue" type="text" class="primary-value rule-field form-control"/></td>'},createSimpleNewRuleValueField:function(){return'<td><input id="decision_newRule_primaryValue" type="text" class="primary-value form-control"/></td>'},addRuleProperties:function(e,t){e.filter("select, input").attr("name","rules["+t+"].primaryValue").addClass("rule-field")},addNewRuleProperties:function(e){e.filter("select, input").attr("id","decision_newRule_primaryValue")},updateVisibility:function(){this.onTypeChanged();this.onDecisionReactionChanged();this.onCriteriaChanged()},hideDecisionFormDiv:function(e){$('form[name="decisionForm"] #'+e).css("display","none")},showDecisionFormDiv:function(e){$('form[name="decisionForm"] #'+e).css("display","block")},updateVisibilityOfRuleMailingReceived:function(){var e=$('form[name="decisionForm"] input[name="decisionType"]:checked').val();if(e==v.constants.decisionTypeAutoOptimization){this.hideDecisionFormDiv("ruleMailingReceivedWrapper")}else if(e==v.constants.decisionTypeDecision){var t=$('form[name="decisionForm"] select[name="decisionCriteria"]').val();if(t==v.constants.decisionReaction){this.hideDecisionFormDiv("ruleMailingReceivedWrapper")}else if(t==v.constants.decisionProfileField){this.hideDecisionFormDiv("ruleMailingReceivedWrapper");var i=this.showDecisionFormDiv;h.forEachPreviousNode(function(e){if(v.NODE_TYPES_MAILING.includes(e.getType())){var t=e.getData();l=t.mailingId;i("ruleMailingReceivedWrapper");return false}})}}},dateAsUTC:function(e){if(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))}else{return null}},checkPresentNodeOfType:function(e){return h.getNodesByTypes(e).length>0}});p.addAction({click:"decision-editor-mailing-sort-shortname"},function(){a.onMailingSortClick("shortname")});p.addAction({click:"decision-editor-mailing-sort-date"},function(){a.onMailingSortClick("date")});p.addAction({change:"decision-editor-mailing-select"},function(){e.onMailingSelectChange(this.el.val())});p.addAction({change:"decision-rule-operator-change"},function(){e.onRuleOperatorChanged(this.el)});p.addAction({click:"decision-editor-rule-remove"},function(){e.removeRuleRow(this.el.data("rule-index"))});p.addAction({click:"decision-editor-rule-add"},function(){e.addRule()});p.addAction({change:"decision-editor-type-change"},function(){e.onTypeChanged()});p.addAction({change:"decision-editor-criteria-change"},function(){e.onCriteriaChanged()});p.addAction({change:"decision-editor-reaction-change"},function(){e.onDecisionReactionChanged()});p.addAction({click:"decision-editor-save"},function(){e.validateEditor()});p.addAction({change:"decision-editor-profile-field-change"},function(){e.onProfileFieldChanged()})});this.addDomInitializer("mailing-editor-initializer",function(){var e=this.config;var n=new a(e,m);var i=h.registerEditor("mailing",{formName:"mailingForm",safeToSave:true,getTitle:function(){return t("workflow.defaults.mailing")},fillEditor:function(e){var t=$('form[name="'+this.formName+'"]');var i=e.getData();t.submit(false);t.get(0).reset();h.fillFormFromObject(this.formName,i,"");n.fillEditorBase(e);$("#mailing-editor .editor-error-messages").css("display","none")},createNewMailing:function(){n.createNewMailing(v.constants.forwardMailingCreate)},editMailing:function(){n.editMailing(v.constants.forwardMailingEdit)},copyMailing:function(){n.copyMailing(v.constants.forwardMailingCopy)},saveEditor:function(){n.setNodeFields();n.disableInputs();return h.formToObject(this.formName)},saveWithCheckStatus:function(){var e=n.showSecurityQuestion();if(e){h.saveCurrentEditorWithUndo(false,n)}}});p.addAction({click:"mailing-editor-save"},function(){n.validateEditor(i.saveWithCheckStatus)});p.addAction({click:"mailing-editor-base-close"},function(){n.closeOneMailinglistWarningDialog()});p.addAction({click:"mailing-editor-base-accept"},function(){n.acceptOneMailinglistPerCampaign()});p.addAction({click:"mailing-editor-base-sort-shortname"},function(){n.onMailingSortClick("shortname","shortname")});p.addAction({click:"mailing-editor-base-sort-data"},function(){var e=f.getConfigData(this.el);n.onMailingSortClick("shortname",e.sortByDate)});p.addAction({change:"mailing-editor-base-status-change"},function(){n.onMailingsStatusChange(this.el.val())});p.addAction({change:"mailing-editor-base-select-change"},function(){n.onMailingSelectChange(this.el.val())});p.addAction({click:"mailing-editor-base-secure-cancel"},function(){n.cancelSecurityDialog()});p.addAction({click:"mailing-editor-base-toggle-settings"},function(){var e=f.getConfigData(this.el);n.toggleSendSettings(e.editorId)})});this.addDomInitializer("followup-mailing-editor-initializer",function(){var e=this.config.baseMailingData;var r=this.config.followupMailingData;e.$dropdown=$("#followup-m-editor");var o=new a(e,m);var s=new a(r,m);o.selectedFollowUpMailingId=0;o.findPreviousMailingIds=function(){var i=[];h.forEachPreviousNode(function(e){var t=e.getType();if(v.NODE_TYPES_MAILING.includes(t)&&v.NODE_TYPE_FOLLOWUP_MAILING!=t){i.push(e.getId())}});return i};o.getMailingsByWorkStatus=function(s,a,l,c){var u=this;var d=$(this.formNameJId+" "+this.selectNameJId);var e=_.uniq(this.findPreviousMailingIds()).toString();d.attr("readonly","readonly");$.ajax({type:"POST",url:AGN.url("/workflow/getMailingsByWorkStatus.action"),data:{mailingTypes:this.mailingTypesForLoading.join(","),status:s,sort:a,order:l,mailingId:this.selectedFollowUpMailingId,parentMailingId:$(this.formNameJId+" "+this.selectNameJId).val(),mailingStatus:"W",takeMailsForPeriod:true,mailingsInCampaign:e},success:function(e){d.html("");d.append('<option value="0">'+t("workflow.defaults.no_mailing")+"</option>");for(var i=0;i<e.length;i++){var n=e[i];var r="";var o="";if(n.WORK_STATUS=="mailing.status.sent"||n.WORK_STATUS=="mailing.status.norecipients"){r="style='color: #808080;'"}if(c==n.MAILING_ID){o="selected"}d.append("<option "+r+" value='"+n.MAILING_ID+"' status='"+n.WORK_STATUS+"' senddate='"+n.SENDDATE+"' "+o+">"+n.SHORTNAME+"</option>")}d.removeAttr("readonly");u.mailingsStatus=s;u.mailingsSort=a;u.mailingsOrder=l;d.val(u.mailingId);h.initSelectWithValueOrChooseFirst(d,u.mailingId)}})};s.onMailingSelectChange=function(e){o.selectedFollowUpMailingId=e;this.setSelectMailingOptions(e)};var i=h.registerEditor("followup_mailing",{formName:"followupMailingForm",safeToSave:false,getTitle:function(){return t("workflow.mailing.followup")},fillEditor:function(e){var i=$('form[name="'+this.formName+'"]');var n=$("#followup_mailing-editor .editor-error-messages");s.fillEditorBase(e);o.fillEditorBase(e);i.submit(false);i.get(0).reset();h.fillFormFromObject(this.formName,e.getData(),"");if(r.disableFollowup=="true"){n.html(t("error.workflow.followupPermission"));n.css("display","block");o.disableInputs()}else{n.css("display","none")}},createNewMailing:function(){var e=o.node.getData();e.baseMailingId=o.getSelectedMailingOption().val();e.decisionCriterion=o.getSelectedDecisionOption().val();s.createNewMailing(v.constants.forwardMailingCreate)},editMailing:function(){var e=o.node.getData();e.baseMailingId=o.getSelectedMailingOption().val();e.decisionCriterion=o.getSelectedDecisionOption().val();s.editMailing(v.constants.forwardMailingEdit)},copyMailing:function(){var e=o.node.getData();e.baseMailingId=o.getSelectedMailingOption().val();e.decisionCriterion=o.getSelectedDecisionOption().val();s.copyMailing(v.constants.forwardMailingCopy)},saveEditor:function(){o.disableInputs();s.disableInputs();this.setNodeFields();return h.formToObject(this.formName)},saveWithCheckStatus:function(){var e=s.showSecurityQuestion();if(e){h.saveCurrentEditorWithUndo(false,s)}},validateEditor:function(e){var i=$(o.formNameJId+" "+o.selectNameJId);var n=$(s.formNameJId+" "+s.selectNameJId);if(i.val()>0&&n.val()>0){if(e){e()}else{h.saveCurrentEditorWithUndo()}}else{var r=$("#followup_mailing-editor").find(".editor-error-messages");r.html(t("error.workflow.noMailing"));r.css("display","block")}},setNodeFields:function(){o.node.setFilled(parseInt(o.mailingId,10)>0&&parseInt(s.mailingId,10)>0)}});p.addAction({click:"followup-mailing-editor-base-sort-shortname"},function(){s.onMailingSortClick("shortname","shortname")});p.addAction({click:"followup-mailing-editor-base-sort-data"},function(){var e=f.getConfigData(this.el);s.onMailingSortClick("shortname",e.sortByDate)});p.addAction({change:"followup-mailing-editor-base-status-change"},function(){s.onMailingsStatusChange(this.el.val())});p.addAction({change:"followup-mailing-editor-base-select-change"},function(){s.onMailingSelectChange(this.el.val())});p.addAction({click:"followup-base-mailing-editor-base-sort-shortname"},function(){o.onMailingSortClick("shortname","shortname")});p.addAction({click:"followup-base-mailing-editor-base-sort-data"},function(){var e=f.getConfigData(this.el);o.onMailingSortClick("shortname",e.sortByDate)});p.addAction({change:"followup-base-mailing-editor-base-status-change"},function(){o.onMailingsStatusChange(this.el.val())});p.addAction({change:"followup-base-mailing-editor-base-select-change"},function(){o.onMailingSelectChange(this.el.val())});p.addAction({click:"followup-base-mailing-editor-base-secure-cancel"},function(){s.cancelSecurityDialog()});p.addAction({click:"followup-mailing-editor-base-secure-cancel"},function(){s.cancelSecurityDialog()});p.addAction({click:"followup-mailing-editor-save"},function(){i.validateEditor(i.saveWithCheckStatus)})});this.addDomInitializer("mailing_mediatype_sms-editor-initializer",function(){const e=this.config;const i=new a(e,m);const n=h.registerEditor("mailing_mediatype_sms",{formName:"smsMailingForm",safeToSave:false,getTitle:function(){return t("workflow.mailing.mediatype_sms")},fillEditor:function(e){const t=$('form[name="'+this.formName+'"]');t.submit(false);t.get(0).reset();h.fillFormFromObject(this.formName,e.getData(),"");i.fillEditorBase(e);$("#mailing_mediatype_sms-editor .editor-error-messages").css("display","none")},createNewMailing:function(){i.createNewMailing(v.constants.forwardMailingCreate)},editMailing:function(){i.editMailing(v.constants.forwardMailingEdit)},saveEditor:function(){i.setNodeFields();i.disableInputs();return h.formToObject(this.formName)},saveWithCheckStatus:function(){const e=i.showSecurityQuestion();if(e){h.saveCurrentEditorWithUndo(false,i)}},copyMailing:function(){i.copyMailing(v.constants.forwardMailingCopy)}});p.addAction({click:"sms-mailing-editor-save"},function(){i.validateEditor(n.saveWithCheckStatus)});p.addAction({click:"action-mailing-editor-base-sort-shortname"},function(){i.onMailingSortClick("shortname","shortname")});p.addAction({click:"action-mailing-editor-base-sort-data"},function(){const e=f.getConfigData(this.el);i.onMailingSortClick("shortname",e.sortByDate)});p.addAction({change:"action-mailing-editor-base-status-change"},function(){i.onMailingsStatusChange(this.el.val())});p.addAction({change:"action-mailing-editor-base-select-change"},function(){i.onMailingSelectChange(this.el.val())});p.addAction({click:"action-mailing-editor-base-secure-cancel"},function(){i.cancelSecurityDialog()})});this.addDomInitializer("mailing_mediatype_post-editor-initializer",function(){const e=this.config;const i=new a(e,m);const n=h.registerEditor("mailing_mediatype_post",{formName:"postMailingForm",safeToSave:false,getTitle:function(){return t("workflow.mailing.mediatype_post")},fillEditor:function(e){const t=$('form[name="'+this.formName+'"]');t.submit(false);t.get(0).reset();h.fillFormFromObject(this.formName,e.getData(),"");i.fillEditorBase(e);$("#mailing_mediatype_post-editor .editor-error-messages").css("display","none")},createNewMailing:function(){i.createNewMailing(v.constants.forwardMailingCreate)},editMailing:function(){i.editMailing(v.constants.forwardMailingEdit)},saveEditor:function(){i.setNodeFields();i.disableInputs();return h.formToObject(this.formName)},saveWithCheckStatus:function(){const e=i.showSecurityQuestion();if(e){h.saveCurrentEditorWithUndo(false,i)}},copyMailing:function(){i.copyMailing(v.constants.forwardMailingCopy)}});p.addAction({click:"post-mailing-editor-save"},function(){i.validateEditor(n.saveWithCheckStatus)});p.addAction({click:"action-mailing-editor-base-sort-shortname"},function(){i.onMailingSortClick("shortname","shortname")});p.addAction({click:"action-mailing-editor-base-sort-data"},function(){const e=f.getConfigData(this.el);i.onMailingSortClick("shortname",e.sortByDate)});p.addAction({change:"action-mailing-editor-base-status-change"},function(){i.onMailingsStatusChange(this.el.val())});p.addAction({change:"action-mailing-editor-base-select-change"},function(){i.onMailingSelectChange(this.el.val())});p.addAction({click:"action-mailing-editor-base-secure-cancel"},function(){i.cancelSecurityDialog()})});this.addDomInitializer("action-mailing-editor-initializer",function(){var e=this.config;var i=new a(e,m);var n=h.registerEditor("actionbased_mailing",{formName:"actionbasedMailingForm",safeToSave:false,getTitle:function(){return t("workflow.mailing.action_based")},fillEditor:function(e){var t=$('form[name="'+this.formName+'"]');t.submit(false);t.get(0).reset();h.fillFormFromObject(this.formName,e.getData(),"");i.fillEditorBase(e);$("#actionbased_mailing-editor .editor-error-messages").css("display","none")},createNewMailing:function(){i.createNewMailing(v.constants.forwardMailingCreate)},editMailing:function(){i.editMailing(v.constants.forwardMailingEdit)},saveEditor:function(){i.setNodeFields();i.disableInputs();return h.formToObject(this.formName)},saveWithCheckStatus:function(){var e=i.showSecurityQuestion();if(e){h.saveCurrentEditorWithUndo(false,i)}},copyMailing:function(){i.copyMailing(v.constants.forwardMailingCopy)}});p.addAction({click:"action-mailing-editor-save"},function(){i.validateEditor(n.saveWithCheckStatus)});p.addAction({click:"action-mailing-editor-base-sort-shortname"},function(){i.onMailingSortClick("shortname","shortname")});p.addAction({click:"action-mailing-editor-base-sort-data"},function(){var e=f.getConfigData(this.el);i.onMailingSortClick("shortname",e.sortByDate)});p.addAction({change:"action-mailing-editor-base-status-change"},function(){i.onMailingsStatusChange(this.el.val())});p.addAction({change:"action-mailing-editor-base-select-change"},function(){i.onMailingSelectChange(this.el.val())});p.addAction({click:"action-mailing-editor-base-secure-cancel"},function(){i.cancelSecurityDialog()})});this.addDomInitializer("date-mailing-initializer",function(){var e=this.config;var i=new a(e,m);var n=h.registerEditor("datebased_mailing",{formName:"datebasedMailingForm",safeToSave:false,getTitle:function(){return t("workflow.mailing.date_based")},fillEditor:function(e){var t=$('form[name="'+this.formName+'"]');t.submit(false);t.get(0).reset();h.fillFormFromObject(this.formName,e.getData(),"");i.fillEditorBase(e);$("#datebased_mailing-editor .editor-error-messages").css("display","none")},saveEditor:function(){i.setNodeFields();i.disableInputs();return h.formToObject(this.formName)},createNewMailing:function(){i.createNewMailing(v.constants.forwardMailingCreate)},editMailing:function(){i.editMailing(v.constants.forwardMailingEdit)},saveWithCheckStatus:function(){var e=i.showSecurityQuestion();if(e){h.saveCurrentEditorWithUndo(false,i)}},copyMailing:function(){i.copyMailing(v.constants.forwardMailingCopy)}});p.addAction({click:"date-mailing-editor-base-sort-shortname"},function(){i.onMailingSortClick("shortname","shortname")});p.addAction({click:"date-mailing-editor-base-sort-data"},function(){var e=f.getConfigData(this.el);i.onMailingSortClick("shortname",e.sortByDate)});p.addAction({change:"date-mailing-editor-base-status-change"},function(){i.onMailingsStatusChange(this.el.val())});p.addAction({change:"date-mailing-editor-base-select-change"},function(){i.onMailingSelectChange(this.el.val())});p.addAction({click:"date-mailing-editor-base-secure-cancel"},function(){i.cancelSecurityDialog()});p.addAction({click:"date-mailing-editor-save"},function(){i.validateEditor(n.saveWithCheckStatus)})});this.addAction({click:"mailing-editor-copy"},function(){h.getCurrentEditor().copyMailing()});this.addAction({click:"mailing-editor-new"},function(){h.getCurrentEditor().createNewMailing()});this.addAction({click:"mailing-editor-edit"},function(){h.getCurrentEditor().editMailing()});this.addAction({click:"editor-save-current"},function(){h.saveCurrentEditorWithUndo()});this.addAction({click:"editor-cancel"},function(){h.cancelEditor()});this.addAction({click:"chain-mode"},function(){if(g.isChainMode()||g.connectSelected()){g.setChainModeEnabled(false)}else{g.setChainModeEnabled(true)}$(this.el).toggleClass("button-selected",g.isChainMode())});this.addAction({click:"delete-selected"},function(){g.deleteSelected()});this.addAction({click:"align-all"},function(){g.alignAll()});this.addAction({click:"zoom-in"},function(){var e=$("#slider").slider("instance");e.value(e.value()+v.ZOOM_STEP);g.setZoom(e.value())});this.addAction({click:"zoom-out"},function(){var e=$("#slider").slider("instance");e.value(e.value()-v.ZOOM_STEP);g.setZoom(e.value())});this.addAction({click:"reset-zoom"},function(){g.setZoom(v.DEFAULT_ZOOM);$("#slider").slider("value",v.DEFAULT_ZOOM)});this.addAction({click:"show-grid"},function(){g.toggleGrid()});this.addAction({click:"workflow-save"},function(){C(true,{})});this.addAction({click:"workflow-copy"},function(){var t=v.workflowId;var e=g.getNodes().some(function(e){return e.isFilled()});i.confirmCopy(e).done(function(e){window.location.href=AGN.url("/workflow/copy.action"+"?workflowId="+t+"&isWithContent="+(e==true));return false})});this.addAction({change:"workflow-view-change-status"},function(){if($("#workflow_active").is(":checked")){$("#workflow-status").val(v.constants.statusActive)}else{$("#workflow-status").val(v.constants.statusInactive)}});this.addAction({click:"evaluate-statistic"},function(){const e=$("#statistic-iframe");e.removeClass("hidden");e.attr("src",v.statisticUrl)});this.addAction({click:"undo"},function(){g.undo()});this.addAction({click:"workflow-generate-pdf"},function(){var e=v.workflowId<=0||!v.shortname;var t=g.hasUnsavedChanges();if(e||t){d.fromTemplate("save-before-pdf-modal")}else{window.location.href=AGN.url("/workflow/"+v.workflowId+"/generatePDF.action");AGN.Lib.Loader.hide()}});this.addAction({click:"workflow-dry-run"},function(){var e=false;var t=v.constants.statusOpen;if(v.constants.initialWorkflowStatus!=v.constants.statusTesting){e=true;t=v.constants.statusTesting}i.confirmTestingStartStop(e).done(function(){var e=$("#workflow_active");e.prop("disabled",true);C(true,{status:t})})});this.addAction({click:"workflow-pause"},function(){C(true,{status:v.constants.statusPaused})});this.addAction({click:"workflow-unpause"},function(){e(true,{status:v.constants.statusActive})});this.addAction({click:"workflow-activate"},function(){b(true,{status:v.constants.statusActive})});this.addAction({click:"workflow-deactivate"},function(){w(true,{status:v.constants.statusInactive})});$(window).on("resize viewportChanged",function(){if(g){g.updateMinimap()}});$(document).on("keydown",function(e){if(e.target&&!$(e.target).is("input, textarea")){switch(e.keyCode){case v.KEY_SPACE:g.setPanningEnabled(true);break;case v.KEY_SHIFT:g.setMultiConnectionEnabled(true);break;case v.KEY_CTRL:g.setMouseWheelZoomEnabled(true);break}}});$(document).on("keyup",function(e){if(e.target&&!$(e.target).is("input, textarea")){switch(e.keyCode){case v.KEY_DELETE:g.deleteSelected();break;case v.KEY_SPACE:g.setPanningEnabled(false);break;case v.KEY_SHIFT:g.setMultiConnectionEnabled(false);break;case v.KEY_ENTER:g.editIcon();break;case v.KEY_CTRL:g.setMouseWheelZoomEnabled(false);break}}});function m(e,t){var i=$("#workflow_active").is(":checked");var n=v.constants.initialWorkflowStatus;var r=n===v.constants.statusActive&&!i;var o=n!==v.constants.statusActive&&i;if(r||!f.checkActivation(true)){if(o){b(e,t)}else if(r){w(e,t)}else{C(e,t)}}}function b(e,t){i.Activation(function(){C(e,t)},x().join("<br/>"))}function e(e,t){i.Activation(function(){C(e,t)},{},true)}function w(e,t){i.Deactivation(function(){C(e,t)})}function C(e,i){var t=function(){var t=AGN.Lib.Form.get($("form#workflowForm"));i=$.extend({},i);Object.keys(i).forEach(function(e){t.setValueOnce(e,i[e])});if(g.isGridDisplayed()){g.toggleGrid()}t.setValueOnce("workflowSchema",g.serializeIcons());t.setValueOnce("editorPositionLeft",-1);t.setValueOnce("editorPositionTop",-1);t.submit("static")};if(e){S().done(t)}else{t()}}function x(){return g.getNodesByTypes(v.NODE_TYPES_MAILING).map(function(e){return e.getTitle()})}function S(){var e=$.Deferred();if($("#name").val().length<3){AGN.Lib.Messages(t("workflow.defaults.error"),t("error.workflow.shortName"),"alert");e.reject()}else{if(A()){return l.create(c.text("mailing-types-replace-modal"))}else{e.resolve()}}return e.promise()}function A(){var e=g.getNodes();var t="UNKNOWN";var i={};for(var n=0;n<e.length;n++){var r=e[n];if(r.type===v.NODE_TYPE_START&&r.filled){var o="UNKNOWN";switch(r.data.startType){case v.constants.startTypeDate:o="DATE";break;case v.constants.startTypeEvent:switch(r.event){case v.constants.startEventDate:o="RULE";break;case v.constants.startEventReaction:o="REACTION";break}break}if(t!==o){if(t==="UNKNOWN"){t=o}else{return false}}}switch(r.type){case v.NODE_TYPE_MAILING:case v.NODE_TYPE_FOLLOWUP_MAILING:case v.NODE_TYPE_MAILING_MEDIATYPE_SMS:case v.NODE_TYPE_MAILING_MEDIATYPE_POST:i["DATE"]=true;break;case v.NODE_TYPE_ACTION_BASED_MAILING:i["REACTION"]=true;break;case v.NODE_TYPE_DATE_BASED_MAILING:i["RULE"]=true;break}}if(t!=="UNKNOWN"){i=Object.keys(i);if(i.length===1){if(t!==i[0]){return true}}else{if(i.length>1){return true}}}return false}this.addDomInitializer("open-edit-icon-initializer",function(e){var t=e.json();var i=t.nodeId;var n=t.elementValue;if(i){var r=o.get($("#"+i));if(r&&n){switch(r.type){case v.NODE_TYPE_MAILING:case v.NODE_TYPE_ACTION_BASED_MAILING:case v.NODE_TYPE_MAILING_MEDIATYPE_SMS:case v.NODE_TYPE_MAILING_MEDIATYPE_POST:case v.NODE_TYPE_DATE_BASED_MAILING:case v.NODE_TYPE_FOLLOWUP_MAILING:r.data.mailingId=n;break;case v.NODE_TYPE_RECIPIENT:if(n!="0"&&$.inArray(n,r.data.targets)==-1){r.data.targets.push(n)}break;case v.NODE_TYPE_ARCHIVE:r.data.campaignId=n;break;case v.NODE_TYPE_IMPORT:case v.NODE_TYPE_EXPORT:r.data.importexportId=n;break;default:console.debug("Unknown node type")}g.editIcon(r)}}})});AGN.Lib.Controller.new("wysiwyg-agn-tags",function(){const o=AGN.Lib.Template;const e=AGN.Lib.Select;const n=AGN.Lib.Confirm;const r={};const s={};let a;let l;let c;r["agnFULLVIEW"]=()=>{const e=c.children("option:selected");const t=e.val();if(!t){return}if(!$("#createLinkToggle").prop("checked")){return`[${t}]`}let i=$("#tagLinkText").val();if(!i){i="fullview"}return`<a href="[${t}]">${i}</a>`};r["agnWEBVIEW"]=r["agnFULLVIEW"];r["agnFORM"]=function(){const e=c.children("option:selected");const t=e.val();const i=e.data("attributes");if(!t){return}if($("#createLinkToggle").prop("checked")===true){let e=$("#tagLinkText").val();if(!e){const n=i.findIndex(function(e){return e.name==="name"});if(n>-1){e=$(`#agn-tag-attribute-${n}`).val()}}if(e){return`<a href="[${t+h(i)}]">${e}</a>`}}return`[${t+h(i)}]`};s["agnFORM"]=function(){const e=$("#createLinkToggle");if(e.prop("checked")!==true){$("#tagLinkText").hide()}e.on("change",function(){$("#tagLinkText").toggle($(this).prop("checked"))})};s["agnFULLVIEW"]=s["agnFORM"];s["agnWEBVIEW"]=s["agnFULLVIEW"];function u(e,t){const i=$("#agn-tag-attributes");i.empty();if(t&&t.length>0){t.forEach(function(e,t){switch(e.type){case"SELECT":i.append(a({index:t,name:e.name,options:e.options}));break;case"TEXT":i.append(l({index:t,name:e.name}));break}})}const n=`${e}-extended-attributes`;if(o.exists(n)){const r=o.dom(n);if(r){i.append(r)}}AGN.runAll(i)}function d(){const e=c.children("option:selected");const t=e.val();if(t){return"["+t+h(e.data("attributes"))+"]"}return null}function h(e){var n="";if(e&&e.length>0){e.forEach(function(e,t){var i=$(`#agn-tag-attribute-${t}`);n+=" "+e.name+'="'+_.escape(i.val())+'"'})}return n}this.addDomInitializer("wysiwyg-agn-tags",function(){a=o.prepare("agn-tag-select-attribute");l=o.prepare("agn-tag-text-attribute");c=$("#agn-tag-name");this.config.forEach(function(e){var t=$("<option>",{value:e.name,text:e.name});c.append(t);t.data("attributes",e.attributes)});e.get(c).selectFirstValue();c.trigger("change")});this.addAction({change:"select-agn-tag"},function(){const e=this.el.children("option:selected");const t=e.val();u(t,e.data("attributes"));const i=s[t];if(i){i()}});this.addAction({click:"insert-agn-tag"},function(){const e=c.val();const t=r[e];let i;if(t){i=t()}else{i=d()}if(i){n.get(this.el).positive(i)}})});AGN.Lib.Controller.new("wysiwyg-image-browser",function(){let t;const i=e("CKEditorFuncNum");const n=e("mailingID");function e(e){const t=new RegExp("(?:[?&]|&amp;)"+e+"=([^&]+)","i");const i=window.location.search.match(t);return i&&i.length>1?i[1]:""}this.addDomInitializer("wysiwyg-image-browser",function(){t=this.config;r()});this.addAction({change:"update-image"},function(){r()});function r(){const e=c();const t=$("#image-preview");const i=$("#no-image-message");const n=!!(e&&e.length);i.toggleClass("hidden",n);t.parent().toggleClass("hidden",!n);if(n){t.attr("src",l(e))}}this.addAction({click:"submit-image"},function(){const e=$(".navbar li .active").data("image-tab-name");if(e==="mediapool"){s()}else{o()}});this.addAction({click:"close-window"},function(){window.close()});function o(){const e=l(c());a(e)}function s(){const e=$("tr.picked");if(e.exists()){const t=e.find("img").attr("src");a(t)}else{AGN.Lib.Messages.alert("messages.error.nothing_selected")}}function a(e){window.opener.CKEDITOR.tools.callFunction(i,e);window.close()}function l(e){if(e.substr(0,4).toLowerCase()!=="http"){return`${t.rdirDomain}/image?ci=${t.companyId}&mi=${n}&name=${encodeURIComponent(e)}`}return encodeURI(e)}function c(){return $("#image-dropdown").val()}});(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.interact=e()}})(function(){var e,t,i;return function o(s,a,l){function c(i,e){if(!a[i]){if(!s[i]){var t=typeof require=="function"&&require;if(!e&&t)return t(i,!0);if(u)return u(i,!0);var n=new Error("Cannot find module '"+i+"'");throw n.code="MODULE_NOT_FOUND",n}var r=a[i]={exports:{}};s[i][0].call(r.exports,function(e){var t=s[i][1][e];return c(t?t:e)},r,r.exports,o,s,a,l)}return a[i].exports}var u=typeof require=="function"&&require;for(var e=0;e<l.length;e++)c(l[e]);return c}({1:[function(t,e,i){"use strict";if(typeof window==="undefined"){e.exports=function(e){t("./src/utils/window").init(e);return t("./src/index")}}else{e.exports=t("./src/index")}},{"./src/index":19,"./src/utils/window":52}],2:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var r=e("./utils/extend.js");function o(e,t){for(var i=0;i<t.length;i++){var n;n=t[i];var r=n;if(e.immediatePropagationStopped){break}r(e)}}var s=function(){function t(e){n(this,t);this.options=r({},e||{})}t.prototype.fire=function e(t){var i=void 0;var n="on"+t.type;var r=this.global;if(i=this[t.type]){o(t,i)}if(this[n]){this[n](t)}if(!t.propagationStopped&&r&&(i=r[t.type])){o(t,i)}};t.prototype.on=function e(t,i){if(this[t]){this[t].push(i)}else{this[t]=[i]}};t.prototype.off=function e(t,i){var n=this[t];var r=n?n.indexOf(i):-1;if(r!==-1){n.splice(r,1)}if(n&&n.length===0||!i){this[t]=undefined}};return t}();t.exports=s},{"./utils/extend.js":41}],3:[function(e,t,i){"use strict";function y(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var b=e("./utils/extend");var _=e("./utils/getOriginXY");var w=e("./defaultOptions");var C=e("./utils/Signals").new();var n=function(){function v(e,t,i,n,r,o){var s=arguments.length>6&&arguments[6]!==undefined?arguments[6]:false;y(this,v);var a=e.target;var l=(a&&a.options||w).deltaSource;var c=_(a,r,i);var u=n==="start";var d=n==="end";var h=u?e.startCoords:e.curCoords;var f=e.prevEvent;r=r||e.element;var p=b({},h.page);var g=b({},h.client);p.x-=c.x;p.y-=c.y;g.x-=c.x;g.y-=c.y;this.ctrlKey=t.ctrlKey;this.altKey=t.altKey;this.shiftKey=t.shiftKey;this.metaKey=t.metaKey;this.button=t.button;this.buttons=t.buttons;this.target=r;this.currentTarget=r;this.relatedTarget=o||null;this.preEnd=s;this.type=i+(n||"");this.interaction=e;this.interactable=a;this.t0=u?e.downTimes[e.downTimes.length-1]:f.t0;var m={interaction:e,event:t,action:i,phase:n,element:r,related:o,page:p,client:g,coords:h,starting:u,ending:d,deltaSource:l,iEvent:this};C.fire("set-xy",m);if(d){this.pageX=f.pageX;this.pageY=f.pageY;this.clientX=f.clientX;this.clientY=f.clientY}else{this.pageX=p.x;this.pageY=p.y;this.clientX=g.x;this.clientY=g.y}this.x0=e.startCoords.page.x-c.x;this.y0=e.startCoords.page.y-c.y;this.clientX0=e.startCoords.client.x-c.x;this.clientY0=e.startCoords.client.y-c.y;C.fire("set-delta",m);this.timeStamp=h.timeStamp;this.dt=e.pointerDelta.timeStamp;this.duration=this.timeStamp-this.t0;this.speed=e.pointerDelta[l].speed;this.velocityX=e.pointerDelta[l].vx;this.velocityY=e.pointerDelta[l].vy;this.swipe=d||n==="inertiastart"?this.getSwipe():null;C.fire("new",m)}v.prototype.getSwipe=function e(){var t=this.interaction;if(t.prevEvent.speed<600||this.timeStamp-t.prevEvent.timeStamp>150){return null}var i=180*Math.atan2(t.prevEvent.velocityY,t.prevEvent.velocityX)/Math.PI;var n=22.5;if(i<0){i+=360}var r=135-n<=i&&i<225+n;var o=225-n<=i&&i<315+n;var s=!r&&(315-n<=i||i<45+n);var a=!o&&45-n<=i&&i<135+n;return{up:o,down:a,left:r,right:s,angle:i,speed:t.prevEvent.speed,velocity:{x:t.prevEvent.velocityX,y:t.prevEvent.velocityY}}};v.prototype.preventDefault=function e(){};v.prototype.stopImmediatePropagation=function e(){this.immediatePropagationStopped=this.propagationStopped=true};v.prototype.stopPropagation=function e(){this.propagationStopped=true};return v}();C.on("set-delta",function(e){var t=e.iEvent,i=e.interaction,n=e.starting,r=e.deltaSource;var o=n?t:i.prevEvent;if(r==="client"){t.dx=t.clientX-o.clientX;t.dy=t.clientY-o.clientY}else{t.dx=t.pageX-o.pageX;t.dy=t.pageY-o.pageY}});n.signals=C;t.exports=n},{"./defaultOptions":18,"./utils/Signals":34,"./utils/extend":41,"./utils/getOriginXY":42}],4:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=e("./utils/clone");var u=e("./utils/is");var s=e("./utils/events");var r=e("./utils/extend");var d=e("./actions/base");var a=e("./scope");var o=e("./Eventable");var h=e("./defaultOptions");var f=e("./utils/Signals").new();var l=e("./utils/domUtils"),p=l.getElementRect,g=l.nodeContains,m=l.trySelector,v=l.matchesSelector;var y=e("./utils/window"),b=y.getWindow;var _=e("./utils/arr"),w=_.contains;var C=e("./utils/browser"),x=C.wheelEvent;a.interactables=[];var S=function(){function l(e,t){n(this,l);t=t||{};this.target=e;this.events=new o;this._context=t.context||a.document;this._win=b(m(e)?this._context:e);this._doc=this._win.document;f.fire("new",{target:e,options:t,interactable:this,win:this._win});a.addDocument(this._doc,this._win);a.interactables.push(this);this.set(t)}l.prototype.setOnEvents=function e(t,i){var n="on"+t;if(u.function(i.onstart)){this.events[n+"start"]=i.onstart}if(u.function(i.onmove)){this.events[n+"move"]=i.onmove}if(u.function(i.onend)){this.events[n+"end"]=i.onend}if(u.function(i.oninertiastart)){this.events[n+"inertiastart"]=i.oninertiastart}return this};l.prototype.setPerAction=function e(t,i){for(var n in i){if(n in h[t]){if(u.object(i[n])){this.options[t][n]=c(this.options[t][n]||{});r(this.options[t][n],i[n]);if(u.object(h.perAction[n])&&"enabled"in h.perAction[n]){this.options[t][n].enabled=i[n].enabled===false?false:true}}else if(u.bool(i[n])&&u.object(h.perAction[n])){this.options[t][n].enabled=i[n]}else if(i[n]!==undefined){this.options[t][n]=i[n]}}}};l.prototype.getRect=function e(t){t=t||this.target;if(u.string(this.target)&&!u.element(t)){t=this._context.querySelector(this.target)}return p(t)};l.prototype.rectChecker=function e(t){if(u.function(t)){this.getRect=t;return this}if(t===null){delete this.options.getRect;return this}return this.getRect};l.prototype._backCompatOption=function e(t,i){if(m(i)||u.object(i)){this.options[t]=i;for(var n=0;n<d.names.length;n++){var r;r=d.names[n];var o=r;this.options[o][t]=i}return this}return this.options[t]};l.prototype.origin=function e(t){return this._backCompatOption("origin",t)};l.prototype.deltaSource=function e(t){if(t==="page"||t==="client"){this.options.deltaSource=t;return this}return this.options.deltaSource};l.prototype.context=function e(){return this._context};l.prototype.inContext=function e(t){return this._context===t.ownerDocument||g(this._context,t)};l.prototype.fire=function e(t){this.events.fire(t);return this};l.prototype._onOffMultiple=function e(t,i,n,r){if(u.string(i)&&i.search(" ")!==-1){i=i.trim().split(/ +/)}if(u.array(i)){for(var o=0;o<i.length;o++){var s;s=i[o];var a=s;this[t](a,n,r)}return true}if(u.object(i)){for(var l in i){this[t](l,i[l],n)}return true}};l.prototype.on=function e(t,i,n){if(this._onOffMultiple("on",t,i,n)){return this}if(t==="wheel"){t=x}if(w(l.eventTypes,t)){this.events.on(t,i)}else if(u.string(this.target)){s.addDelegate(this.target,this._context,t,i,n)}else{s.add(this.target,t,i,n)}return this};l.prototype.off=function e(t,i,n){if(this._onOffMultiple("off",t,i,n)){return this}if(t==="wheel"){t=x}if(w(l.eventTypes,t)){this.events.off(t,i)}else if(u.string(this.target)){s.removeDelegate(this.target,this._context,t,i,n)}else{s.remove(this.target,t,i,n)}return this};l.prototype.set=function e(t){if(!u.object(t)){t={}}this.options=c(h.base);var i=c(h.perAction);for(var n in d.methodDict){var r=d.methodDict[n];this.options[n]=c(h[n]);this.setPerAction(n,i);this[r](t[n])}for(var o=0;o<l.settingsMethods.length;o++){var s;s=l.settingsMethods[o];var a=s;this.options[a]=h.base[a];if(a in t){this[a](t[a])}}f.fire("set",{options:t,interactable:this});return this};l.prototype.unset=function e(){s.remove(this.target,"all");if(u.string(this.target)){for(var t in s.delegatedEvents){var i=s.delegatedEvents[t];if(i.selectors[0]===this.target&&i.contexts[0]===this._context){i.selectors.splice(0,1);i.contexts.splice(0,1);i.listeners.splice(0,1);if(!i.selectors.length){i[t]=null}}s.remove(this._context,t,s.delegateListener);s.remove(this._context,t,s.delegateUseCapture,true)}}else{s.remove(this,"all")}f.fire("unset",{interactable:this});a.interactables.splice(a.interactables.indexOf(this),1);for(var n=0;n<(a.interactions||[]).length;n++){var r;r=(a.interactions||[])[n];var o=r;if(o.target===this&&o.interacting()&&!o._ending){o.stop()}}return a.interact};return l}();a.interactables.indexOfElement=function e(t,i){i=i||a.document;for(var n=0;n<this.length;n++){var r=this[n];if(r.target===t&&r._context===i){return n}}return-1};a.interactables.get=function e(t,i,n){var r=this[this.indexOfElement(t,i&&i.context)];return r&&(u.string(t)||n||r.inContext(t))?r:null};a.interactables.forEachMatch=function(e,t){for(var i=0;i<this.length;i++){var n;n=this[i];var r=n;var o=void 0;if((u.string(r.target)?u.element(e)&&v(e,r.target):e===r.target)&&r.inContext(e)){o=t(r)}if(o!==undefined){return o}}};S.eventTypes=a.eventTypes=[];S.signals=f;S.settingsMethods=["deltaSource","origin","preventDefault","rectChecker"];t.exports=S},{"./Eventable":2,"./actions/base":6,"./defaultOptions":18,"./scope":33,"./utils/Signals":34,"./utils/arr":35,"./utils/browser":36,"./utils/clone":37,"./utils/domUtils":39,"./utils/events":40,"./utils/extend":41,"./utils/is":46,"./utils/window":52}],5:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var b=e("./scope");var _=e("./utils");var s=e("./utils/events");var w=e("./utils/browser");var r=e("./utils/domObjects");var C=e("./utils/interactionFinder");var c=e("./utils/Signals").new();var o={};var a=["pointerDown","pointerMove","pointerUp","updatePointer","removePointer"];var x=0;b.interactions=[];var S=function(){function l(e){var t=e.pointerType;n(this,l);this.target=null;this.element=null;this.prepared={name:null,axis:null,edges:null};this.pointers=[];this.pointerIds=[];this.downTargets=[];this.downTimes=[];this.prevCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0};this.curCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0};this.startCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0};this.pointerDelta={page:{x:0,y:0,vx:0,vy:0,speed:0},client:{x:0,y:0,vx:0,vy:0,speed:0},timeStamp:0};this.downEvent=null;this.downPointer={};this._eventTarget=null;this._curEventTarget=null;this.prevEvent=null;this.pointerIsDown=false;this.pointerWasMoved=false;this._interacting=false;this._ending=false;this.pointerType=t;c.fire("new",this);b.interactions.push(this)}l.prototype.pointerDown=function e(t,i,n){var r=this.updatePointer(t,i,true);c.fire("down",{pointer:t,event:i,eventTarget:n,pointerIndex:r,interaction:this})};l.prototype.start=function e(t,i,n){if(this.interacting()||!this.pointerIsDown||this.pointerIds.length<(t.name==="gesture"?2:1)){return}if(b.interactions.indexOf(this)===-1){b.interactions.push(this)}_.copyAction(this.prepared,t);this.target=i;this.element=n;c.fire("action-start",{interaction:this,event:this.downEvent})};l.prototype.pointerMove=function e(t,i,n){if(!this.simulation){this.updatePointer(t);_.setCoords(this.curCoords,this.pointers)}var r=this.curCoords.page.x===this.prevCoords.page.x&&this.curCoords.page.y===this.prevCoords.page.y&&this.curCoords.client.x===this.prevCoords.client.x&&this.curCoords.client.y===this.prevCoords.client.y;var o=void 0;var s=void 0;if(this.pointerIsDown&&!this.pointerWasMoved){o=this.curCoords.client.x-this.startCoords.client.x;s=this.curCoords.client.y-this.startCoords.client.y;this.pointerWasMoved=_.hypot(o,s)>l.pointerMoveTolerance}var a={pointer:t,pointerIndex:this.getPointerIndex(t),event:i,eventTarget:n,dx:o,dy:s,duplicate:r,interaction:this,interactingBeforeMove:this.interacting()};if(!r){_.setCoordDeltas(this.pointerDelta,this.prevCoords,this.curCoords)}c.fire("move",a);if(!r){if(this.interacting()){this.doMove(a)}if(this.pointerWasMoved){_.copyCoords(this.prevCoords,this.curCoords)}}};l.prototype.doMove=function e(t){t=_.extend({pointer:this.pointers[0],event:this.prevEvent,eventTarget:this._eventTarget,interaction:this},t||{});c.fire("before-action-move",t);if(!this._dontFireMove){c.fire("action-move",t)}this._dontFireMove=false};l.prototype.pointerUp=function e(t,i,n,r){var o=this.getPointerIndex(t);c.fire(/cancel$/i.test(i.type)?"cancel":"up",{pointer:t,pointerIndex:o,event:i,eventTarget:n,curEventTarget:r,interaction:this});if(!this.simulation){this.end(i)}this.pointerIsDown=false;this.removePointer(t,i)};l.prototype.end=function e(t){this._ending=true;t=t||this.prevEvent;if(this.interacting()){c.fire("action-end",{event:t,interaction:this})}this.stop();this._ending=false};l.prototype.currentAction=function e(){return this._interacting?this.prepared.name:null};l.prototype.interacting=function e(){return this._interacting};l.prototype.stop=function e(){c.fire("stop",{interaction:this});if(this._interacting){c.fire("stop-active",{interaction:this});c.fire("stop-"+this.prepared.name,{interaction:this})}this.target=this.element=null;this._interacting=false;this.prepared.name=this.prevEvent=null};l.prototype.getPointerIndex=function e(t){if(this.pointerType==="mouse"||this.pointerType==="pen"){return 0}return this.pointerIds.indexOf(_.getPointerId(t))};l.prototype.updatePointer=function e(t,i){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:i&&/(down|start)$/i.test(i.type);var r=_.getPointerId(t);var o=this.getPointerIndex(t);if(o===-1){o=this.pointerIds.length;this.pointerIds[o]=r}if(n){c.fire("update-pointer-down",{pointer:t,event:i,down:n,pointerId:r,pointerIndex:o,interaction:this})}this.pointers[o]=t;return o};l.prototype.removePointer=function e(t,i){var n=this.getPointerIndex(t);if(n===-1){return}c.fire("remove-pointer",{pointer:t,event:i,pointerIndex:n,interaction:this});this.pointers.splice(n,1);this.pointerIds.splice(n,1);this.downTargets.splice(n,1);this.downTimes.splice(n,1)};l.prototype._updateEventTargets=function e(t,i){this._eventTarget=t;this._curEventTarget=i};return l}();for(var l=0;l<a.length;l++){var u=a[l];o[u]=d(u)}function d(y){return function(e){var t=_.getPointerType(e);var i=_.getEventTargets(e),n=i[0],r=i[1];var o=[];if(w.supportsTouch&&/touch/.test(e.type)){x=(new Date).getTime();for(var s=0;s<e.changedTouches.length;s++){var a;a=e.changedTouches[s];var l=a;var c=l;var u=C.search(c,e.type,n);o.push([c,u||new S({pointerType:t})])}}else{var d=false;if(!w.supportsPointerEvent&&/mouse/.test(e.type)){for(var h=0;h<b.interactions.length&&!d;h++){d=b.interactions[h].pointerType!=="mouse"&&b.interactions[h].pointerIsDown}d=d||(new Date).getTime()-x<500||e.timeStamp===0}if(!d){var f=C.search(e,e.type,n);if(!f){f=new S({pointerType:t})}o.push([e,f])}}for(var p=0;p<o.length;p++){var g=o[p];var m=g[0];var v=g[1];v._updateEventTargets(n,r);v[y](m,e,n,r)}}}function h(e){for(var t=0;t<b.interactions.length;t++){var i;i=b.interactions[t];var n=i;n.end(e);c.fire("endall",{event:e,interaction:n})}}var f={};var p=w.pEventTypes;if(r.PointerEvent){f[p.down]=o.pointerDown;f[p.move]=o.pointerMove;f[p.up]=o.pointerUp;f[p.cancel]=o.pointerUp}else{f.mousedown=o.pointerDown;f.mousemove=o.pointerMove;f.mouseup=o.pointerUp;f.touchstart=o.pointerDown;f.touchmove=o.pointerMove;f.touchend=o.pointerUp;f.touchcancel=o.pointerUp}f.blur=h;function g(e,t){var i=e.doc;var n=t.indexOf("add")===0?s.add:s.remove;for(var r in b.delegatedEvents){n(i,r,s.delegateListener);n(i,r,s.delegateUseCapture,true)}for(var o in f){n(i,o,f[o],w.isIOS?{passive:false}:undefined)}}c.on("update-pointer-down",function(e){var t=e.interaction,i=e.pointer,n=e.pointerId,r=e.pointerIndex,o=e.event,s=e.eventTarget,a=e.down;t.pointerIds[r]=n;t.pointers[r]=i;if(a){t.pointerIsDown=true}if(!t.interacting()){_.setCoords(t.startCoords,t.pointers);_.copyCoords(t.curCoords,t.startCoords);_.copyCoords(t.prevCoords,t.startCoords);t.downEvent=o;t.downTimes[r]=t.curCoords.timeStamp;t.downTargets[r]=s||o&&_.getEventTargets(o)[0];t.pointerWasMoved=false;_.pointerExtend(t.downPointer,i)}});b.signals.on("add-document",g);b.signals.on("remove-document",g);S.pointerMoveTolerance=1;S.doOnInteractions=d;S.endAll=h;S.signals=c;S.docEvents=f;b.endAllInteractions=h;t.exports=S},{"./scope":33,"./utils":44,"./utils/Signals":34,"./utils/browser":36,"./utils/domObjects":38,"./utils/events":40,"./utils/interactionFinder":45}],6:[function(e,t,i){"use strict";var n=e("../Interaction");var s=e("../InteractEvent");var r={firePrepared:o,names:[],methodDict:{}};n.signals.on("action-start",function(e){var t=e.interaction,i=e.event;t._interacting=true;o(t,i,"start")});n.signals.on("action-move",function(e){var t=e.interaction,i=e.event,n=e.preEnd;o(t,i,"move",n);if(!t.interacting()){return false}});n.signals.on("action-end",function(e){var t=e.interaction,i=e.event;o(t,i,"end")});function o(e,t,i,n){var r=e.prepared.name;var o=new s(e,t,r,i,e.element,null,n);e.target.fire(o);e.prevEvent=o}t.exports=r},{"../InteractEvent":3,"../Interaction":5}],7:[function(e,t,i){"use strict";var n=e("./base");var r=e("../utils");var o=e("../InteractEvent");var s=e("../Interactable");var a=e("../Interaction");var l=e("../defaultOptions");var c={defaults:{enabled:false,mouseButtons:null,origin:null,snap:null,restrict:null,inertia:null,autoScroll:null,startAxis:"xy",lockAxis:"xy"},checker:function e(t,i,n){var r=n.options.drag;return r.enabled?{name:"drag",axis:r.lockAxis==="start"?r.startAxis:r.lockAxis}:null},getCursor:function e(){return"move"}};a.signals.on("before-action-move",function(e){var t=e.interaction;if(t.prepared.name!=="drag"){return}var i=t.prepared.axis;if(i==="x"){t.curCoords.page.y=t.startCoords.page.y;t.curCoords.client.y=t.startCoords.client.y;t.pointerDelta.page.speed=Math.abs(t.pointerDelta.page.vx);t.pointerDelta.client.speed=Math.abs(t.pointerDelta.client.vx);t.pointerDelta.client.vy=0;t.pointerDelta.page.vy=0}else if(i==="y"){t.curCoords.page.x=t.startCoords.page.x;t.curCoords.client.x=t.startCoords.client.x;t.pointerDelta.page.speed=Math.abs(t.pointerDelta.page.vy);t.pointerDelta.client.speed=Math.abs(t.pointerDelta.client.vy);t.pointerDelta.client.vx=0;t.pointerDelta.page.vx=0}});o.signals.on("new",function(e){var t=e.iEvent,i=e.interaction;if(t.type!=="dragmove"){return}var n=i.prepared.axis;if(n==="x"){t.pageY=i.startCoords.page.y;t.clientY=i.startCoords.client.y;t.dy=0}else if(n==="y"){t.pageX=i.startCoords.page.x;t.clientX=i.startCoords.client.x;t.dx=0}});s.prototype.draggable=function(e){if(r.is.object(e)){this.options.drag.enabled=e.enabled===false?false:true;this.setPerAction("drag",e);this.setOnEvents("drag",e);if(/^(xy|x|y|start)$/.test(e.lockAxis)){this.options.drag.lockAxis=e.lockAxis}if(/^(xy|x|y)$/.test(e.startAxis)){this.options.drag.startAxis=e.startAxis}return this}if(r.is.bool(e)){this.options.drag.enabled=e;if(!e){this.ondragstart=this.ondragstart=this.ondragend=null}return this}return this.options.drag};n.drag=c;n.names.push("drag");r.merge(s.eventTypes,["dragstart","dragmove","draginertiastart","draginertiaresume","dragend"]);n.methodDict.drag="draggable";l.drag=c.defaults;t.exports=c},{"../InteractEvent":3,"../Interactable":4,"../Interaction":5,"../defaultOptions":18,"../utils":44,"./base":6}],8:[function(e,t,i){"use strict";var n=e("./base");var v=e("../utils");var h=e("../scope");var r=e("../interact");var o=e("../InteractEvent");var s=e("../Interactable");var a=e("../Interaction");var l=e("../defaultOptions");var c={defaults:{enabled:false,accept:null,overlap:"pointer"}};var u=false;a.signals.on("action-start",function(e){var t=e.interaction,i=e.event;if(t.prepared.name!=="drag"){return}t.activeDrops.dropzones=[];t.activeDrops.elements=[];t.activeDrops.rects=[];t.dropEvents=null;if(!t.dynamicDrop){p(t.activeDrops,t.element)}var n=t.prevEvent;var r=m(t,i,n);if(r.activate){f(t.activeDrops,r.activate)}});o.signals.on("new",function(e){var t=e.interaction,i=e.iEvent,n=e.event;if(i.type!=="dragmove"&&i.type!=="dragend"){return}var r=t.element;var o=i;var s=g(o,n,r);t.dropTarget=s.dropzone;t.dropElement=s.element;t.dropEvents=m(t,n,o)});a.signals.on("action-move",function(e){var t=e.interaction;if(t.prepared.name!=="drag"){return}y(t,t.dropEvents)});a.signals.on("action-end",function(e){var t=e.interaction;if(t.prepared.name==="drag"){y(t,t.dropEvents)}});a.signals.on("stop-drag",function(e){var t=e.interaction;t.activeDrops={dropzones:null,elements:null,rects:null};t.dropEvents=null});function d(e,t){var i=[];var n=[];for(var r=0;r<h.interactables.length;r++){var o;o=h.interactables[r];var s=o;if(!s.options.drop.enabled){continue}var a=s.options.drop.accept;if(v.is.element(a)&&a!==t||v.is.string(a)&&!v.matchesSelector(t,a)){continue}var l=v.is.string(s.target)?s._context.querySelectorAll(s.target):[s.target];for(var c=0;c<l.length;c++){var u;u=l[c];var d=u;if(d!==t){i.push(s);n.push(d)}}}return{elements:n,dropzones:i}}function f(e,t){var i=void 0;for(var n=0;n<e.dropzones.length;n++){var r=e.dropzones[n];var o=e.elements[n];if(o!==i){t.target=o;r.fire(t)}i=o}}function p(e,t){var i=d(e,t);e.dropzones=i.dropzones;e.elements=i.elements;e.rects=[];for(var n=0;n<e.dropzones.length;n++){e.rects[n]=e.dropzones[n].getRect(e.elements[n])}}function g(e,t,i){var n=e.interaction;var r=[];if(u){p(n.activeDrops,i)}for(var o=0;o<n.activeDrops.dropzones.length;o++){var s=n.activeDrops.dropzones[o];var a=n.activeDrops.elements[o];var l=n.activeDrops.rects[o];r.push(s.dropCheck(e,t,n.target,i,a,l)?a:null)}var c=v.indexOfDeepestElement(r);return{dropzone:n.activeDrops.dropzones[c]||null,element:n.activeDrops.elements[c]||null}}function m(e,t,i){var n={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};var r={dragEvent:i,interaction:e,target:e.dropElement,dropzone:e.dropTarget,relatedTarget:i.target,draggable:i.interactable,timeStamp:i.timeStamp};if(e.dropElement!==e.prevDropElement){if(e.prevDropTarget){n.leave=v.extend({type:"dragleave"},r);i.dragLeave=n.leave.target=e.prevDropElement;i.prevDropzone=n.leave.dropzone=e.prevDropTarget}if(e.dropTarget){n.enter={dragEvent:i,interaction:e,target:e.dropElement,dropzone:e.dropTarget,relatedTarget:i.target,draggable:i.interactable,timeStamp:i.timeStamp,type:"dragenter"};i.dragEnter=e.dropElement;i.dropzone=e.dropTarget}}if(i.type==="dragend"&&e.dropTarget){n.drop=v.extend({type:"drop"},r);i.dropzone=e.dropTarget;i.relatedTarget=e.dropElement}if(i.type==="dragstart"){n.activate=v.extend({type:"dropactivate"},r);n.activate.target=null;n.activate.dropzone=null}if(i.type==="dragend"){n.deactivate=v.extend({type:"dropdeactivate"},r);n.deactivate.target=null;n.deactivate.dropzone=null}if(i.type==="dragmove"&&e.dropTarget){n.move=v.extend({dragmove:i,type:"dropmove"},r);i.dropzone=e.dropTarget}return n}function y(e,t){var i=e.activeDrops,n=e.prevDropTarget,r=e.dropTarget,o=e.dropElement;if(t.leave){n.fire(t.leave)}if(t.move){r.fire(t.move)}if(t.enter){r.fire(t.enter)}if(t.drop){r.fire(t.drop)}if(t.deactivate){f(i,t.deactivate)}e.prevDropTarget=r;e.prevDropElement=o}s.prototype.dropzone=function(e){if(v.is.object(e)){this.options.drop.enabled=e.enabled===false?false:true;if(v.is.function(e.ondrop)){this.events.ondrop=e.ondrop}if(v.is.function(e.ondropactivate)){this.events.ondropactivate=e.ondropactivate}if(v.is.function(e.ondropdeactivate)){this.events.ondropdeactivate=e.ondropdeactivate}if(v.is.function(e.ondragenter)){this.events.ondragenter=e.ondragenter}if(v.is.function(e.ondragleave)){this.events.ondragleave=e.ondragleave}if(v.is.function(e.ondropmove)){this.events.ondropmove=e.ondropmove}if(/^(pointer|center)$/.test(e.overlap)){this.options.drop.overlap=e.overlap}else if(v.is.number(e.overlap)){this.options.drop.overlap=Math.max(Math.min(1,e.overlap),0)}if("accept"in e){this.options.drop.accept=e.accept}if("checker"in e){this.options.drop.checker=e.checker}return this}if(v.is.bool(e)){this.options.drop.enabled=e;if(!e){this.ondragenter=this.ondragleave=this.ondrop=this.ondropactivate=this.ondropdeactivate=null}return this}return this.options.drop};s.prototype.dropCheck=function(e,t,i,n,r,o){var s=false;if(!(o=o||this.getRect(r))){return this.options.drop.checker?this.options.drop.checker(e,t,s,this,r,i,n):false}var a=this.options.drop.overlap;if(a==="pointer"){var l=v.getOriginXY(i,n,"drag");var c=v.getPageXY(e);c.x+=l.x;c.y+=l.y;var u=c.x>o.left&&c.x<o.right;var d=c.y>o.top&&c.y<o.bottom;s=u&&d}var h=i.getRect(n);if(h&&a==="center"){var f=h.left+h.width/2;var p=h.top+h.height/2;s=f>=o.left&&f<=o.right&&p>=o.top&&p<=o.bottom}if(h&&v.is.number(a)){var g=Math.max(0,Math.min(o.right,h.right)-Math.max(o.left,h.left))*Math.max(0,Math.min(o.bottom,h.bottom)-Math.max(o.top,h.top));var m=g/(h.width*h.height);s=m>=a}if(this.options.drop.checker){s=this.options.drop.checker(e,t,s,this,r,i,n)}return s};s.signals.on("unset",function(e){var t=e.interactable;t.dropzone(false)});s.settingsMethods.push("dropChecker");a.signals.on("new",function(e){e.dropTarget=null;e.dropElement=null;e.prevDropTarget=null;e.prevDropElement=null;e.dropEvents=null;e.activeDrops={dropzones:[],elements:[],rects:[]}});a.signals.on("stop",function(e){var t=e.interaction;t.dropTarget=t.dropElement=t.prevDropTarget=t.prevDropElement=null});r.dynamicDrop=function(e){if(v.is.bool(e)){u=e;return r}return u};v.merge(s.eventTypes,["dragenter","dragleave","dropactivate","dropdeactivate","dropmove","drop"]);n.methodDict.drop="dropzone";l.drop=c.defaults;t.exports=c},{"../InteractEvent":3,"../Interactable":4,"../Interaction":5,"../defaultOptions":18,"../interact":21,"../scope":33,"../utils":44,"./base":6}],9:[function(e,t,i){"use strict";var n=e("./base");var c=e("../utils");var u=e("../InteractEvent");var r=e("../Interactable");var o=e("../Interaction");var s=e("../defaultOptions");var a={defaults:{enabled:false,origin:null,restrict:null},checker:function e(t,i,n,r,o){if(o.pointerIds.length>=2){return{name:"gesture"}}return null},getCursor:function e(){return""}};u.signals.on("new",function(e){var t=e.iEvent,i=e.interaction;if(t.type!=="gesturestart"){return}t.ds=0;i.gesture.startDistance=i.gesture.prevDistance=t.distance;i.gesture.startAngle=i.gesture.prevAngle=t.angle;i.gesture.scale=1});u.signals.on("new",function(e){var t=e.iEvent,i=e.interaction;if(t.type!=="gesturemove"){return}t.ds=t.scale-i.gesture.scale;i.target.fire(t);i.gesture.prevAngle=t.angle;i.gesture.prevDistance=t.distance;if(t.scale!==Infinity&&t.scale!==null&&t.scale!==undefined&&!isNaN(t.scale)){i.gesture.scale=t.scale}});r.prototype.gesturable=function(e){if(c.is.object(e)){this.options.gesture.enabled=e.enabled===false?false:true;this.setPerAction("gesture",e);this.setOnEvents("gesture",e);return this}if(c.is.bool(e)){this.options.gesture.enabled=e;if(!e){this.ongesturestart=this.ongesturestart=this.ongestureend=null}return this}return this.options.gesture};u.signals.on("set-delta",function(e){var t=e.interaction,i=e.iEvent,n=e.action,r=e.event,o=e.starting,s=e.ending,a=e.deltaSource;if(n!=="gesture"){return}var l=t.pointers;i.touches=[l[0],l[1]];if(o){i.distance=c.touchDistance(l,a);i.box=c.touchBBox(l);i.scale=1;i.ds=0;i.angle=c.touchAngle(l,undefined,a);i.da=0}else if(s||r instanceof u){i.distance=t.prevEvent.distance;i.box=t.prevEvent.box;i.scale=t.prevEvent.scale;i.ds=i.scale-1;i.angle=t.prevEvent.angle;i.da=i.angle-t.gesture.startAngle}else{i.distance=c.touchDistance(l,a);i.box=c.touchBBox(l);i.scale=i.distance/t.gesture.startDistance;i.angle=c.touchAngle(l,t.gesture.prevAngle,a);i.ds=i.scale-t.gesture.prevScale;i.da=i.angle-t.gesture.prevAngle}});o.signals.on("new",function(e){e.gesture={start:{x:0,y:0},startDistance:0,prevDistance:0,distance:0,scale:1,startAngle:0,prevAngle:0}});n.gesture=a;n.names.push("gesture");c.merge(r.eventTypes,["gesturestart","gesturemove","gestureend"]);n.methodDict.gesture="gesturable";s.gesture=a.defaults;t.exports=a},{"../InteractEvent":3,"../Interactable":4,"../Interaction":5,"../defaultOptions":18,"../utils":44,"./base":6}],10:[function(e,t,i){"use strict";var n=e("./base");var b=e("../utils");var r=e("../utils/browser");var o=e("../InteractEvent");var s=e("../Interactable");var a=e("../Interaction");var l=e("../defaultOptions");var p=r.supportsTouch||r.supportsPointerEvent?20:10;var c={defaults:{enabled:false,mouseButtons:null,origin:null,snap:null,restrict:null,inertia:null,autoScroll:null,square:false,preserveAspectRatio:false,axis:"xy",margin:NaN,edges:null,invert:"none"},checker:function e(t,i,n,r,o,s){if(!s){return null}var a=b.extend({},o.curCoords.page);var l=n.options;if(l.resize.enabled){var c=l.resize;var u={left:false,right:false,top:false,bottom:false};if(b.is.object(c.edges)){for(var d in u){u[d]=g(d,c.edges[d],a,o._eventTarget,r,s,c.margin||p)}u.left=u.left&&!u.right;u.top=u.top&&!u.bottom;if(u.left||u.right||u.top||u.bottom){return{name:"resize",edges:u}}}else{var h=l.resize.axis!=="y"&&a.x>s.right-p;var f=l.resize.axis!=="x"&&a.y>s.bottom-p;if(h||f){return{name:"resize",axes:(h?"x":"")+(f?"y":"")}}}}return null},cursors:r.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"},getCursor:function e(t){if(t.axis){return c.cursors[t.name+t.axis]}else if(t.edges){var i="";var n=["top","bottom","left","right"];for(var r=0;r<4;r++){if(t.edges[n[r]]){i+=n[r]}}return c.cursors[i]}}};o.signals.on("new",function(e){var t=e.iEvent,i=e.interaction;if(t.type!=="resizestart"||!i.prepared.edges){return}var n=i.target.getRect(i.element);var r=i.target.options.resize;if(r.square||r.preserveAspectRatio){var o=b.extend({},i.prepared.edges);o.top=o.top||o.left&&!o.bottom;o.left=o.left||o.top&&!o.right;o.bottom=o.bottom||o.right&&!o.top;o.right=o.right||o.bottom&&!o.left;i.prepared._linkedEdges=o}else{i.prepared._linkedEdges=null}if(r.preserveAspectRatio){i.resizeStartAspectRatio=n.width/n.height}i.resizeRects={start:n,current:b.extend({},n),inverted:b.extend({},n),previous:b.extend({},n),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}};t.rect=i.resizeRects.inverted;t.deltaRect=i.resizeRects.delta});o.signals.on("new",function(e){var t=e.iEvent,i=e.phase,n=e.interaction;if(i!=="move"||!n.prepared.edges){return}var r=n.target.options.resize;var o=r.invert;var s=o==="reposition"||o==="negate";var a=n.prepared.edges;var l=n.resizeRects.start;var c=n.resizeRects.current;var u=n.resizeRects.inverted;var d=n.resizeRects.delta;var h=b.extend(n.resizeRects.previous,u);var f=a;var p=t.dx;var g=t.dy;if(r.preserveAspectRatio||r.square){var m=r.preserveAspectRatio?n.resizeStartAspectRatio:1;a=n.prepared._linkedEdges;if(f.left&&f.bottom||f.right&&f.top){g=-p/m}else if(f.left||f.right){g=p/m}else if(f.top||f.bottom){p=g*m}}if(a.top){c.top+=g}if(a.bottom){c.bottom+=g}if(a.left){c.left+=p}if(a.right){c.right+=p}if(s){b.extend(u,c);if(o==="reposition"){var v=void 0;if(u.top>u.bottom){v=u.top;u.top=u.bottom;u.bottom=v}if(u.left>u.right){v=u.left;u.left=u.right;u.right=v}}}else{u.top=Math.min(c.top,l.bottom);u.bottom=Math.max(c.bottom,l.top);u.left=Math.min(c.left,l.right);u.right=Math.max(c.right,l.left)}u.width=u.right-u.left;u.height=u.bottom-u.top;for(var y in u){d[y]=u[y]-h[y]}t.edges=n.prepared.edges;t.rect=u;t.deltaRect=d});s.prototype.resizable=function(e){if(b.is.object(e)){this.options.resize.enabled=e.enabled===false?false:true;this.setPerAction("resize",e);this.setOnEvents("resize",e);if(/^x$|^y$|^xy$/.test(e.axis)){this.options.resize.axis=e.axis}else if(e.axis===null){this.options.resize.axis=l.resize.axis}if(b.is.bool(e.preserveAspectRatio)){this.options.resize.preserveAspectRatio=e.preserveAspectRatio}else if(b.is.bool(e.square)){this.options.resize.square=e.square}return this}if(b.is.bool(e)){this.options.resize.enabled=e;if(!e){this.onresizestart=this.onresizestart=this.onresizeend=null}return this}return this.options.resize};function g(e,t,i,n,r,o,s){if(!t){return false}if(t===true){var a=b.is.number(o.width)?o.width:o.right-o.left;var l=b.is.number(o.height)?o.height:o.bottom-o.top;if(a<0){if(e==="left"){e="right"}else if(e==="right"){e="left"}}if(l<0){if(e==="top"){e="bottom"}else if(e==="bottom"){e="top"}}if(e==="left"){return i.x<(a>=0?o.left:o.right)+s}if(e==="top"){return i.y<(l>=0?o.top:o.bottom)+s}if(e==="right"){return i.x>(a>=0?o.right:o.left)-s}if(e==="bottom"){return i.y>(l>=0?o.bottom:o.top)-s}}if(!b.is.element(n)){return false}return b.is.element(t)?t===n:b.matchesUpTo(n,t,r)}a.signals.on("new",function(e){e.resizeAxes="xy"});o.signals.on("set-delta",function(e){var t=e.interaction,i=e.iEvent,n=e.action;if(n!=="resize"||!t.resizeAxes){return}var r=t.target.options;if(r.resize.square){if(t.resizeAxes==="y"){i.dx=i.dy}else{i.dy=i.dx}i.axes="xy"}else{i.axes=t.resizeAxes;if(t.resizeAxes==="x"){i.dy=0}else if(t.resizeAxes==="y"){i.dx=0}}});n.resize=c;n.names.push("resize");b.merge(s.eventTypes,["resizestart","resizemove","resizeinertiastart","resizeinertiaresume","resizeend"]);n.methodDict.resize="resizable";l.resize=c.defaults;t.exports=c},{"../InteractEvent":3,"../Interactable":4,"../Interaction":5,"../defaultOptions":18,"../utils":44,"../utils/browser":36,"./base":6}],11:[function(e,t,i){"use strict";var s=e("./utils/raf");var d=e("./utils/window").getWindow;var h=e("./utils/is");var f=e("./utils/domUtils");var n=e("./Interaction");var r=e("./defaultOptions");var p={defaults:{enabled:false,container:null,margin:60,speed:300},interaction:null,i:null,x:0,y:0,isScrolling:false,prevTime:0,start:function e(t){p.isScrolling=true;s.cancel(p.i);p.interaction=t;p.prevTime=(new Date).getTime();p.i=s.request(p.scroll)},stop:function e(){p.isScrolling=false;s.cancel(p.i)},scroll:function e(){var t=p.interaction.target.options[p.interaction.prepared.name].autoScroll;var i=t.container||d(p.interaction.element);var n=(new Date).getTime();var r=(n-p.prevTime)/1e3;var o=t.speed*r;if(o>=1){if(h.window(i)){i.scrollBy(p.x*o,p.y*o)}else if(i){i.scrollLeft+=p.x*o;i.scrollTop+=p.y*o}p.prevTime=n}if(p.isScrolling){s.cancel(p.i);p.i=s.request(p.scroll)}},check:function e(t,i){var n=t.options;return n[i].autoScroll&&n[i].autoScroll.enabled},onInteractionMove:function e(t){var i=t.interaction,n=t.pointer;if(!(i.interacting()&&p.check(i.target,i.prepared.name))){return}if(i.simulation){p.x=p.y=0;return}var r=void 0;var o=void 0;var s=void 0;var a=void 0;var l=i.target.options[i.prepared.name].autoScroll;var c=l.container||d(i.element);if(h.window(c)){a=n.clientX<p.margin;r=n.clientY<p.margin;o=n.clientX>c.innerWidth-p.margin;s=n.clientY>c.innerHeight-p.margin}else{var u=f.getElementClientRect(c);a=n.clientX<u.left+p.margin;r=n.clientY<u.top+p.margin;o=n.clientX>u.right-p.margin;s=n.clientY>u.bottom-p.margin}p.x=o?1:a?-1:0;p.y=s?1:r?-1:0;if(!p.isScrolling){p.margin=l.margin;p.speed=l.speed;p.start(i)}}};n.signals.on("stop-active",function(){p.stop()});n.signals.on("action-move",p.onInteractionMove);r.perAction.autoScroll=p.defaults;t.exports=p},{"./Interaction":5,"./defaultOptions":18,"./utils/domUtils":39,"./utils/is":46,"./utils/raf":50,"./utils/window":52}],12:[function(e,t,i){"use strict";var n=e("../Interactable");var u=e("../actions/base");var r=e("../utils/is");var o=e("../utils/domUtils");var s=e("../utils"),a=s.warnOnce;n.prototype.getAction=function(e,t,i,n){var r=this.defaultActionChecker(e,t,i,n);if(this.options.actionChecker){return this.options.actionChecker(e,t,r,this,n,i)}return r};n.prototype.ignoreFrom=a(function(e){return this._backCompatOption("ignoreFrom",e)},"Interactable.ignoreForm() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue}).");n.prototype.allowFrom=a(function(e){return this._backCompatOption("allowFrom",e)},"Interactable.allowForm() has been deprecated. Use Interactble.draggable({allowFrom: newValue}).");n.prototype.testIgnore=function(e,t,i){if(!e||!r.element(i)){return false}if(r.string(e)){return o.matchesUpTo(i,e,t)}else if(r.element(e)){return o.nodeContains(e,i)}return false};n.prototype.testAllow=function(e,t,i){if(!e){return true}if(!r.element(i)){return false}if(r.string(e)){return o.matchesUpTo(i,e,t)}else if(r.element(e)){return o.nodeContains(e,i)}return false};n.prototype.testIgnoreAllow=function(e,t,i){return!this.testIgnore(e.ignoreFrom,t,i)&&this.testAllow(e.allowFrom,t,i)};n.prototype.actionChecker=function(e){if(r.function(e)){this.options.actionChecker=e;return this}if(e===null){delete this.options.actionChecker;return this}return this.options.actionChecker};n.prototype.styleCursor=function(e){if(r.bool(e)){this.options.styleCursor=e;return this}if(e===null){delete this.options.styleCursor;return this}return this.options.styleCursor};n.prototype.defaultActionChecker=function(e,t,i,n){var r=this.getRect(n);var o=t.buttons||{0:1,1:4,3:8,4:16}[t.button];var s=null;for(var a=0;a<u.names.length;a++){var l;l=u.names[a];var c=l;if(i.pointerIsDown&&/mouse|pointer/.test(i.pointerType)&&(o&this.options[c].mouseButtons)===0){continue}s=u[c].checker(e,t,this,n,i,r);if(s){return s}}}},{"../Interactable":4,"../actions/base":6,"../utils":44,"../utils/domUtils":39,"../utils/is":46}],13:[function(e,t,i){"use strict";var n=e("../interact");var r=e("../Interactable");var o=e("../Interaction");var s=e("../actions/base");var a=e("../defaultOptions");var f=e("../scope");var c=e("../utils");var l=e("../utils/Signals").new();e("./InteractableMethods");var p={signals:l,withinInteractionLimit:m,maxInteractions:Infinity,defaults:{perAction:{manualStart:false,max:Infinity,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}},setActionDefaults:function e(t){c.extend(t.defaults,p.defaults.perAction)},validateAction:d};o.signals.on("down",function(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget;if(t.interacting()){return}var o=h(t,i,n,r);g(t,o)});o.signals.on("move",function(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget;if(t.pointerType!=="mouse"||t.pointerIsDown||t.interacting()){return}var o=h(t,i,n,r);g(t,o)});o.signals.on("move",function(e){var t=e.interaction,i=e.event;if(!t.pointerIsDown||t.interacting()||!t.pointerWasMoved||!t.prepared.name){return}l.fire("before-start",e);var n=t.target;if(t.prepared.name&&n){if(n.options[t.prepared.name].manualStart||!m(n,t.element,t.prepared)){t.stop(i)}else{t.start(t.prepared,n,t.element)}}});function d(e,t,i,n){if(c.is.object(e)&&t.testIgnoreAllow(t.options[e.name],i,n)&&t.options[e.name].enabled&&m(t,i,e)){return e}return null}function u(e,t,i,n,r,o){for(var s=0,a=n.length;s<a;s++){var l=n[s];var c=r[s];var u=d(l.getAction(t,i,e,c),l,c,o);if(u){return{action:u,target:l,element:c}}}return{}}function h(e,t,i,n){var r=[];var o=[];var s=n;function a(e){r.push(e);o.push(s)}while(c.is.element(s)){r=[];o=[];f.interactables.forEachMatch(s,a);var l=u(e,t,i,r,o,n);if(l.action&&!l.target.options[l.action.name].manualStart){return l}s=c.parentNode(s)}return{}}function g(e,t){var i=t.action,n=t.target,r=t.element;i=i||{};if(e.target&&e.target.options.styleCursor){e.target._doc.documentElement.style.cursor=""}e.target=n;e.element=r;c.copyAction(e.prepared,i);if(n&&n.options.styleCursor){var o=i?s[i.name].getCursor(i):"";e.target._doc.documentElement.style.cursor=o}l.fire("prepared",{interaction:e})}o.signals.on("stop",function(e){var t=e.interaction;var i=t.target;if(i&&i.options.styleCursor){i._doc.documentElement.style.cursor=""}});function m(e,t,i){var n=e.options;var r=n[i.name].max;var o=n[i.name].maxPerElement;var s=0;var a=0;var l=0;if(!(r&&o&&p.maxInteractions)){return}for(var c=0;c<f.interactions.length;c++){var u;u=f.interactions[c];var d=u;var h=d.prepared.name;if(!d.interacting()){continue}s++;if(s>=p.maxInteractions){return false}if(d.target!==e){continue}a+=h===i.name|0;if(a>=r){return false}if(d.element===t){l++;if(h!==i.name||l>=o){return false}}}return p.maxInteractions>0}n.maxInteractions=function(e){if(c.is.number(e)){p.maxInteractions=e;return n}return p.maxInteractions};r.settingsMethods.push("styleCursor");r.settingsMethods.push("actionChecker");r.settingsMethods.push("ignoreFrom");r.settingsMethods.push("allowFrom");a.base.actionChecker=null;a.base.styleCursor=true;c.extend(a.perAction,p.defaults.perAction);t.exports=p},{"../Interactable":4,"../Interaction":5,"../actions/base":6,"../defaultOptions":18,"../interact":21,"../scope":33,"../utils":44,"../utils/Signals":34,"./InteractableMethods":12}],14:[function(e,t,i){"use strict";var f=e("./base");var p=e("../scope");var g=e("../utils/is");var n=e("../utils/domUtils"),m=n.parentNode;f.setActionDefaults(e("../actions/drag"));f.signals.on("before-start",function(e){var r=e.interaction,o=e.eventTarget,t=e.dx,i=e.dy;if(r.prepared.name!=="drag"){return}var n=Math.abs(t);var s=Math.abs(i);var a=r.target.options.drag;var l=a.startAxis;var c=n>s?"x":n<s?"y":"xy";r.prepared.axis=a.lockAxis==="start"?c[0]:a.lockAxis;if(c!=="xy"&&l!=="xy"&&l!==c){r.prepared.name=null;var u=o;var d=function e(t){if(t===r.target){return}var i=r.target.options.drag;if(!i.manualStart&&t.testIgnoreAllow(i,u,o)){var n=t.getAction(r.downPointer,r.downEvent,r,u);if(n&&n.name==="drag"&&v(c,t)&&f.validateAction(n,t,u,o)){return t}}};while(g.element(u)){var h=p.interactables.forEachMatch(u,d);if(h){r.prepared.name="drag";r.target=h;r.element=u;break}u=m(u)}}});function v(e,t){if(!t){return false}var i=t.options.drag.startAxis;return e==="xy"||i==="xy"||i===e}},{"../actions/drag":7,"../scope":33,"../utils/domUtils":39,"../utils/is":46,"./base":13}],15:[function(e,t,i){"use strict";e("./base").setActionDefaults(e("../actions/gesture"))},{"../actions/gesture":9,"./base":13}],16:[function(e,t,i){"use strict";var n=e("./base");var r=e("../Interaction");n.defaults.perAction.hold=0;n.defaults.perAction.delay=0;r.signals.on("new",function(e){e.autoStartHoldTimer=null});n.signals.on("prepared",function(e){var t=e.interaction;var i=o(t);if(i>0){t.autoStartHoldTimer=setTimeout(function(){t.start(t.prepared,t.target,t.element)},i)}});r.signals.on("move",function(e){var t=e.interaction,i=e.duplicate;if(t.pointerWasMoved&&!i){clearTimeout(t.autoStartHoldTimer)}});n.signals.on("before-start",function(e){var t=e.interaction;var i=o(t);if(i>0){t.prepared.name=null}});function o(e){var t=e.prepared&&e.prepared.name;if(!t){return null}var i=e.target.options;return i[t].hold||i[t].delay}t.exports={getHoldDuration:o}},{"../Interaction":5,"./base":13}],17:[function(e,t,i){"use strict";e("./base").setActionDefaults(e("../actions/resize"))},{"../actions/resize":10,"./base":13}],18:[function(e,t,i){"use strict";t.exports={base:{accept:null,preventDefault:"auto",deltaSource:"page"},perAction:{origin:{x:0,y:0},inertia:{enabled:false,resistance:10,minSpeed:100,endSpeed:10,allowResume:true,smoothEndDuration:300}}}},{}],19:[function(e,t,i){"use strict";e("./inertia");e("./modifiers/snap");e("./modifiers/restrict");e("./pointerEvents/base");e("./pointerEvents/holdRepeat");e("./pointerEvents/interactableTargets");e("./autoStart/hold");e("./actions/gesture");e("./actions/resize");e("./actions/drag");e("./actions/drop");e("./modifiers/snapSize");e("./modifiers/restrictEdges");e("./modifiers/restrictSize");e("./autoStart/gesture");e("./autoStart/resize");e("./autoStart/drag");e("./interactablePreventDefault.js");e("./autoScroll");t.exports=e("./interact")},{"./actions/drag":7,"./actions/drop":8,"./actions/gesture":9,"./actions/resize":10,"./autoScroll":11,"./autoStart/drag":14,"./autoStart/gesture":15,"./autoStart/hold":16,"./autoStart/resize":17,"./inertia":20,"./interact":21,"./interactablePreventDefault.js":22,"./modifiers/restrict":24,"./modifiers/restrictEdges":25,"./modifiers/restrictSize":26,"./modifiers/snap":27,"./modifiers/snapSize":28,"./pointerEvents/base":30,"./pointerEvents/holdRepeat":31,"./pointerEvents/interactableTargets":32}],20:[function(e,t,i){"use strict";var m=e("./InteractEvent");var c=e("./Interaction");var v=e("./modifiers/base");var y=e("./utils");var b=e("./utils/raf");c.signals.on("new",function(e){e.inertiaStatus={active:false,smoothEnd:false,allowResume:false,startEvent:null,upCoords:{},xe:0,ye:0,sx:0,sy:0,t0:0,vx0:0,vys:0,duration:0,lambda_v0:0,one_ve_v0:0,i:null};e.boundInertiaFrame=function(){return n.apply(e)};e.boundSmoothEndFrame=function(){return r.apply(e)}});c.signals.on("down",function(e){var t=e.interaction,i=e.event,n=e.pointer,r=e.eventTarget;var o=t.inertiaStatus;if(o.active){var s=r;while(y.is.element(s)){if(s===t.element){b.cancel(o.i);o.active=false;t.simulation=null;t.updatePointer(n);y.setCoords(t.curCoords,t.pointers);var a={interaction:t};c.signals.fire("before-action-move",a);c.signals.fire("action-resume",a);var l=new m(t,i,t.prepared.name,"inertiaresume",t.element);t.target.fire(l);t.prevEvent=l;v.resetStatuses(t.modifierStatuses);y.copyCoords(t.prevCoords,t.curCoords);break}s=y.parentNode(s)}}});c.signals.on("up",function(e){var t=e.interaction,i=e.event;var n=t.inertiaStatus;if(!t.interacting()||n.active){return}var r=t.target;var o=r&&r.options;var s=o&&t.prepared.name&&o[t.prepared.name].inertia;var a=(new Date).getTime();var l={};var c=y.extend({},t.curCoords.page);var u=t.pointerDelta.client.speed;var d=false;var h=void 0;var f=s&&s.enabled&&t.prepared.name!=="gesture"&&i!==n.startEvent;var p=f&&a-t.curCoords.timeStamp<50&&u>s.minSpeed&&u>s.endSpeed;var g={interaction:t,pageCoords:c,statuses:l,preEnd:true,requireEndOnly:true};if(f&&!p){v.resetStatuses(l);h=v.setAll(g);if(h.shouldMove&&h.locked){d=true}}if(!(p||d)){return}y.copyCoords(n.upCoords,t.curCoords);t.pointers[0]=n.startEvent=new m(t,i,t.prepared.name,"inertiastart",t.element);n.t0=a;n.active=true;n.allowResume=s.allowResume;t.simulation=n;r.fire(n.startEvent);if(p){n.vx0=t.pointerDelta.client.vx;n.vy0=t.pointerDelta.client.vy;n.v0=u;_(t,n);y.extend(c,t.curCoords.page);c.x+=n.xe;c.y+=n.ye;v.resetStatuses(l);h=v.setAll(g);n.modifiedXe+=h.dx;n.modifiedYe+=h.dy;n.i=b.request(t.boundInertiaFrame)}else{n.smoothEnd=true;n.xe=h.dx;n.ye=h.dy;n.sx=n.sy=0;n.i=b.request(t.boundSmoothEndFrame)}});c.signals.on("stop-active",function(e){var t=e.interaction;var i=t.inertiaStatus;if(i.active){b.cancel(i.i);i.active=false;t.simulation=null}});function _(e,t){var i=e.target.options[e.prepared.name].inertia;var n=i.resistance;var r=-Math.log(i.endSpeed/t.v0)/n;t.x0=e.prevEvent.pageX;t.y0=e.prevEvent.pageY;t.t0=t.startEvent.timeStamp/1e3;t.sx=t.sy=0;t.modifiedXe=t.xe=(t.vx0-r)/n;t.modifiedYe=t.ye=(t.vy0-r)/n;t.te=r;t.lambda_v0=n/t.v0;t.one_ve_v0=1-i.endSpeed/t.v0}function n(){s(this);y.setCoordDeltas(this.pointerDelta,this.prevCoords,this.curCoords);var e=this.inertiaStatus;var t=this.target.options[this.prepared.name].inertia;var i=t.resistance;var n=(new Date).getTime()/1e3-e.t0;if(n<e.te){var r=1-(Math.exp(-i*n)-e.lambda_v0)/e.one_ve_v0;if(e.modifiedXe===e.xe&&e.modifiedYe===e.ye){e.sx=e.xe*r;e.sy=e.ye*r}else{var o=y.getQuadraticCurvePoint(0,0,e.xe,e.ye,e.modifiedXe,e.modifiedYe,r);e.sx=o.x;e.sy=o.y}this.doMove();e.i=b.request(this.boundInertiaFrame)}else{e.sx=e.modifiedXe;e.sy=e.modifiedYe;this.doMove();this.end(e.startEvent);e.active=false;this.simulation=null}y.copyCoords(this.prevCoords,this.curCoords)}function r(){s(this);var e=this.inertiaStatus;var t=(new Date).getTime()-e.t0;var i=this.target.options[this.prepared.name].inertia.smoothEndDuration;if(t<i){e.sx=y.easeOutQuad(t,0,e.xe,i);e.sy=y.easeOutQuad(t,0,e.ye,i);this.pointerMove(e.startEvent,e.startEvent);e.i=b.request(this.boundSmoothEndFrame)}else{e.sx=e.xe;e.sy=e.ye;this.pointerMove(e.startEvent,e.startEvent);this.end(e.startEvent);e.smoothEnd=e.active=false;this.simulation=null}}function s(e){var t=e.inertiaStatus;if(!t.active){return}var i=t.upCoords.page;var n=t.upCoords.client;y.setCoords(e.curCoords,[{pageX:i.x+t.sx,pageY:i.y+t.sy,clientX:n.x+t.sx,clientY:n.y+t.sy}])}},{"./InteractEvent":3,"./Interaction":5,"./modifiers/base":23,"./utils":44,"./utils/raf":50}],21:[function(e,t,i){"use strict";var n=e("./utils/browser");var l=e("./utils/events");var c=e("./utils");var u=e("./scope");var d=e("./Interactable");var r=e("./Interaction");var h={};function f(e,t){var i=u.interactables.get(e,t);if(!i){i=new d(e,t);i.events.global=h}return i}f.isSet=function(e,t){return u.interactables.indexOfElement(e,t&&t.context)!==-1};f.on=function(e,t,i){if(c.is.string(e)&&e.search(" ")!==-1){e=e.trim().split(/ +/)}if(c.is.array(e)){for(var n=0;n<e.length;n++){var r;r=e[n];var o=r;f.on(o,t,i)}return f}if(c.is.object(e)){for(var s in e){f.on(s,e[s],t)}return f}if(c.contains(d.eventTypes,e)){if(!h[e]){h[e]=[t]}else{h[e].push(t)}}else{l.add(u.document,e,t,{options:i})}return f};f.off=function(e,t,i){if(c.is.string(e)&&e.search(" ")!==-1){e=e.trim().split(/ +/)}if(c.is.array(e)){for(var n=0;n<e.length;n++){var r;r=e[n];var o=r;f.off(o,t,i)}return f}if(c.is.object(e)){for(var s in e){f.off(s,e[s],t)}return f}if(!c.contains(d.eventTypes,e)){l.remove(u.document,e,t,i)}else{var a=void 0;if(e in h&&(a=h[e].indexOf(t))!==-1){h[e].splice(a,1)}}return f};f.debug=function(){return u};f.getPointerAverage=c.pointerAverage;f.getTouchBBox=c.touchBBox;f.getTouchDistance=c.touchDistance;f.getTouchAngle=c.touchAngle;f.getElementRect=c.getElementRect;f.getElementClientRect=c.getElementClientRect;f.matchesSelector=c.matchesSelector;f.closest=c.closest;f.supportsTouch=function(){return n.supportsTouch};f.supportsPointerEvent=function(){return n.supportsPointerEvent};f.stop=function(e){for(var t=u.interactions.length-1;t>=0;t--){u.interactions[t].stop(e)}return f};f.pointerMoveTolerance=function(e){if(c.is.number(e)){r.pointerMoveTolerance=e;return f}return r.pointerMoveTolerance};f.addDocument=u.addDocument;f.removeDocument=u.removeDocument;u.interact=f;t.exports=f},{"./Interactable":4,"./Interaction":5,"./scope":33,"./utils":44,"./utils/browser":36,"./utils/events":40}],22:[function(e,t,i){"use strict";var n=e("./Interactable");var r=e("./Interaction");var o=e("./scope");var s=e("./utils/is");var a=e("./utils/events");var l=e("./utils/browser");var c=e("./utils/domUtils"),u=c.nodeContains,d=c.matchesSelector;n.prototype.preventDefault=function(e){if(/^(always|never|auto)$/.test(e)){this.options.preventDefault=e;return this}if(s.bool(e)){this.options.preventDefault=e?"always":"never";return this}return this.options.preventDefault};n.prototype.checkAndPreventDefault=function(e){var t=this.options.preventDefault;if(t==="never"){return}if(t==="always"){e.preventDefault();return}if(a.supportsPassive&&/^touch(start|move)$/.test(e.type)&&!l.isIOS){return}if(/^(mouse|pointer|touch)*(down|start)/i.test(e.type)){return}if(s.element(e.target)&&d(e.target,"input,select,textarea,[contenteditable=true],[contenteditable=true] *")){return}e.preventDefault()};function h(e){var t=e.interaction,i=e.event;if(t.target){t.target.checkAndPreventDefault(i)}}var f=["down","move","up","cancel"];for(var p=0;p<f.length;p++){var g=f[p];r.signals.on(g,h)}r.docEvents.dragstart=function e(t){for(var i=0;i<o.interactions.length;i++){var n;n=o.interactions[i];var r=n;if(r.element&&(r.element===t.target||u(r.element,t.target))){r.target.checkAndPreventDefault(t);return}}}},{"./Interactable":4,"./Interaction":5,"./scope":33,"./utils/browser":36,"./utils/domUtils":39,"./utils/events":40,"./utils/is":46}],23:[function(e,t,i){"use strict";var n=e("../InteractEvent");var r=e("../Interaction");var h=e("../utils/extend");var f={names:[],setOffsets:function e(t){var i=t.interaction,n=t.pageCoords;var r=i.target,o=i.element,s=i.startOffset;var a=r.getRect(o);if(a){s.left=n.x-a.left;s.top=n.y-a.top;s.right=a.right-n.x;s.bottom=a.bottom-n.y;if(!("width"in a)){a.width=a.right-a.left}if(!("height"in a)){a.height=a.bottom-a.top}}else{s.left=s.top=s.right=s.bottom=0}t.rect=a;t.interactable=r;t.element=o;for(var l=0;l<f.names.length;l++){var c;c=f.names[l];var u=c;t.options=r.options[i.prepared.name][u];if(!t.options){continue}i.modifierOffsets[u]=f[u].setOffset(t)}},setAll:function e(t){var i=t.interaction,n=t.statuses,r=t.preEnd,o=t.requireEndOnly;var s={dx:0,dy:0,changed:false,locked:false,shouldMove:true};t.modifiedCoords=h({},t.pageCoords);for(var a=0;a<f.names.length;a++){var l;l=f.names[a];var c=l;var u=f[c];var d=i.target.options[i.prepared.name][c];if(!p(d,r,o)){continue}t.status=t.status=n[c];t.options=d;t.offset=t.interaction.modifierOffsets[c];u.set(t);if(t.status.locked){t.modifiedCoords.x+=t.status.dx;t.modifiedCoords.y+=t.status.dy;s.dx+=t.status.dx;s.dy+=t.status.dy;s.locked=true}}s.shouldMove=!t.status||!s.locked||t.status.changed;return s},resetStatuses:function e(t){for(var i=0;i<f.names.length;i++){var n;n=f.names[i];var r=n;var o=t[r]||{};o.dx=o.dy=0;o.modifiedX=o.modifiedY=NaN;o.locked=false;o.changed=true;t[r]=o}return t},start:function e(t,i){var n=t.interaction;var r={interaction:n,pageCoords:(i==="action-resume"?n.curCoords:n.startCoords).page,startOffset:n.startOffset,statuses:n.modifierStatuses,preEnd:false,requireEndOnly:false};f.setOffsets(r);f.resetStatuses(r.statuses);r.pageCoords=h({},n.startCoords.page);n.modifierResult=f.setAll(r)},beforeMove:function e(t){var i=t.interaction,n=t.preEnd,r=t.interactingBeforeMove;var o=f.setAll({interaction:i,preEnd:n,pageCoords:i.curCoords.page,statuses:i.modifierStatuses,requireEndOnly:false});if(!o.shouldMove&&r){i._dontFireMove=true}i.modifierResult=o},end:function e(t){var i=t.interaction,n=t.event;for(var r=0;r<f.names.length;r++){var o;o=f.names[r];var s=o;var a=i.target.options[i.prepared.name][s];if(p(a,true,true)){i.doMove({event:n,preEnd:true});break}}},setXY:function e(t){var i=t.iEvent,n=t.interaction;var r=h({},t);for(var o=0;o<f.names.length;o++){var s=f.names[o];r.options=n.target.options[n.prepared.name][s];if(!r.options){continue}var a=f[s];r.status=n.modifierStatuses[s];i[s]=a.modifyCoords(r)}}};r.signals.on("new",function(e){e.startOffset={left:0,right:0,top:0,bottom:0};e.modifierOffsets={};e.modifierStatuses=f.resetStatuses({});e.modifierResult=null});r.signals.on("action-start",f.start);r.signals.on("action-resume",f.start);r.signals.on("before-action-move",f.beforeMove);r.signals.on("action-end",f.end);n.signals.on("set-xy",f.setXY);function p(e,t,i){return e&&e.enabled&&(t||!e.endOnly)&&(!i||e.endOnly)}t.exports=f},{"../InteractEvent":3,"../Interaction":5,"../utils/extend":41}],24:[function(e,t,i){"use strict";var n=e("./base");var h=e("../utils");var r=e("../defaultOptions");var o={defaults:{enabled:false,endOnly:false,restriction:null,elementRect:null},setOffset:function e(t){var i=t.rect,n=t.startOffset,r=t.options;var o=r&&r.elementRect;var s={};if(i&&o){s.left=n.left-i.width*o.left;s.top=n.top-i.height*o.top;s.right=n.right-i.width*(1-o.right);s.bottom=n.bottom-i.height*(1-o.bottom)}else{s.left=s.top=s.right=s.bottom=0}return s},set:function e(t){var i=t.modifiedCoords,n=t.interaction,r=t.status,o=t.options;if(!o){return r}var s=r.useStatusXY?{x:r.x,y:r.y}:h.extend({},i);var a=f(o.restriction,n,s);if(!a){return r}r.dx=0;r.dy=0;r.locked=false;var l=a;var c=s.x;var u=s.y;var d=n.modifierOffsets.restrict;if("x"in a&&"y"in a){c=Math.max(Math.min(l.x+l.width-d.right,s.x),l.x+d.left);u=Math.max(Math.min(l.y+l.height-d.bottom,s.y),l.y+d.top)}else{c=Math.max(Math.min(l.right-d.right,s.x),l.left+d.left);u=Math.max(Math.min(l.bottom-d.bottom,s.y),l.top+d.top)}r.dx=c-s.x;r.dy=u-s.y;r.changed=r.modifiedX!==c||r.modifiedY!==u;r.locked=!!(r.dx||r.dy);r.modifiedX=c;r.modifiedY=u},modifyCoords:function e(t){var i=t.page,n=t.client,r=t.status,o=t.phase,s=t.options;var a=s&&s.elementRect;if(s&&s.enabled&&!(o==="start"&&a&&r.locked)){if(r.locked){i.x+=r.dx;i.y+=r.dy;n.x+=r.dx;n.y+=r.dy;return{dx:r.dx,dy:r.dy}}}},getRestrictionRect:f};function f(e,t,i){if(h.is.function(e)){return h.resolveRectLike(e,t.target,t.element,[i.x,i.y,t])}else{return h.resolveRectLike(e,t.target,t.element)}}n.restrict=o;n.names.push("restrict");r.perAction.restrict=o.defaults;t.exports=o},{"../defaultOptions":18,"../utils":44,"./base":23}],25:[function(e,t,i){"use strict";var n=e("./base");var f=e("../utils");var p=e("../utils/rect");var r=e("../defaultOptions");var o=e("../actions/resize");var s=e("./restrict"),g=s.getRestrictionRect;var m={top:+Infinity,left:+Infinity,bottom:-Infinity,right:-Infinity};var v={top:-Infinity,left:-Infinity,bottom:+Infinity,right:+Infinity};var a={defaults:{enabled:false,endOnly:false,min:null,max:null,offset:null},setOffset:function e(t){var i=t.interaction,n=t.startOffset,r=t.options;if(!r){return f.extend({},n)}var o=g(r.offset,i,i.startCoords.page);if(o){return{top:n.top+o.y,left:n.left+o.x,bottom:n.bottom+o.y,right:n.right+o.x}}return n},set:function e(t){var i=t.modifiedCoords,n=t.interaction,r=t.status,o=t.offset,s=t.options;var a=n.prepared.linkedEdges||n.prepared.edges;if(!n.interacting()||!a){return}var l=r.useStatusXY?{x:r.x,y:r.y}:f.extend({},i);var c=p.xywhToTlbr(g(s.inner,n,l))||m;var u=p.xywhToTlbr(g(s.outer,n,l))||v;var d=l.x;var h=l.y;r.dx=0;r.dy=0;r.locked=false;if(a.top){h=Math.min(Math.max(u.top+o.top,l.y),c.top+o.top)}else if(a.bottom){h=Math.max(Math.min(u.bottom-o.bottom,l.y),c.bottom-o.bottom)}if(a.left){d=Math.min(Math.max(u.left+o.left,l.x),c.left+o.left)}else if(a.right){d=Math.max(Math.min(u.right-o.right,l.x),c.right-o.right)}r.dx=d-l.x;r.dy=h-l.y;r.changed=r.modifiedX!==d||r.modifiedY!==h;r.locked=!!(r.dx||r.dy);r.modifiedX=d;r.modifiedY=h},modifyCoords:function e(t){var i=t.page,n=t.client,r=t.status,o=t.phase,s=t.options;if(s&&s.enabled&&!(o==="start"&&r.locked)){if(r.locked){i.x+=r.dx;i.y+=r.dy;n.x+=r.dx;n.y+=r.dy;return{dx:r.dx,dy:r.dy}}}},noInner:m,noOuter:v,getRestrictionRect:g};n.restrictEdges=a;n.names.push("restrictEdges");r.perAction.restrictEdges=a.defaults;o.defaults.restrictEdges=a.defaults;t.exports=a},{"../actions/resize":10,"../defaultOptions":18,"../utils":44,"../utils/rect":51,"./base":23,"./restrict":24}],26:[function(e,t,i){"use strict";var n=e("./base");var l=e("./restrictEdges");var c=e("../utils");var u=e("../utils/rect");var r=e("../defaultOptions");var o=e("../actions/resize");var d={width:-Infinity,height:-Infinity};var h={width:+Infinity,height:+Infinity};var s={defaults:{enabled:false,endOnly:false,min:null,max:null},setOffset:function e(t){var i=t.interaction;return i.startOffset},set:function e(t){var i=t.interaction,n=t.options;var r=i.prepared.linkedEdges||i.prepared.edges;if(!i.interacting()||!r){return}var o=u.xywhToTlbr(i.resizeRects.inverted);var s=u.tlbrToXywh(l.getRestrictionRect(n.min,i))||d;var a=u.tlbrToXywh(l.getRestrictionRect(n.max,i))||h;t.options={enabled:n.enabled,endOnly:n.endOnly,inner:c.extend({},l.noInner),outer:c.extend({},l.noOuter)};if(r.top){t.options.inner.top=o.bottom-s.height;t.options.outer.top=o.bottom-a.height}else if(r.bottom){t.options.inner.bottom=o.top+s.height;t.options.outer.bottom=o.top+a.height}if(r.left){t.options.inner.left=o.right-s.width;t.options.outer.left=o.right-a.width}else if(r.right){t.options.inner.right=o.left+s.width;t.options.outer.right=o.left+a.width}l.set(t)},modifyCoords:l.modifyCoords};n.restrictSize=s;n.names.push("restrictSize");r.perAction.restrictSize=s.defaults;o.defaults.restrictSize=s.defaults;t.exports=s},{"../actions/resize":10,"../defaultOptions":18,"../utils":44,"../utils/rect":51,"./base":23,"./restrictEdges":25}],27:[function(e,t,i){"use strict";var n=e("./base");var r=e("../interact");var M=e("../utils");var o=e("../defaultOptions");var s={defaults:{enabled:false,endOnly:false,range:Infinity,targets:null,offsets:null,relativePoints:null},setOffset:function e(t){var i=t.interaction,n=t.interactable,r=t.element,o=t.rect,s=t.startOffset,a=t.options;var l=[];var c=M.rectToXY(M.resolveRectLike(a.origin));var u=c||M.getOriginXY(n,r,i.prepared.name);a=a||n.options[i.prepared.name].snap||{};var d=void 0;if(a.offset==="startCoords"){d={x:i.startCoords.page.x-u.x,y:i.startCoords.page.y-u.y}}else{var h=M.resolveRectLike(a.offset,n,r,[i]);d=M.rectToXY(h)||{x:0,y:0}}if(o&&a.relativePoints&&a.relativePoints.length){for(var f=0;f<a.relativePoints.length;f++){var p;p=a.relativePoints[f];var g=p;var m=g.x;var v=g.y;l.push({x:s.left-o.width*m+d.x,y:s.top-o.height*v+d.y})}}else{l.push(d)}return l},set:function e(t){var i=t.interaction,n=t.modifiedCoords,r=t.status,o=t.options,s=t.offset;var a=[];var l=void 0;var c=void 0;var u=void 0;if(r.useStatusXY){c={x:r.x,y:r.y}}else{var d=M.getOriginXY(i.target,i.element,i.prepared.name);c=M.extend({},n);c.x-=d.x;c.y-=d.y}r.realX=c.x;r.realY=c.y;var h=o.targets?o.targets.length:0;for(var f=0;f<s.length;f++){var p;p=s[f];var g=p;var m=g.x;var v=g.y;var y=c.x-m;var b=c.y-v;for(var _=0;_<(o.targets||[]).length;_++){var w;w=(o.targets||[])[_];var C=w;if(M.is.function(C)){l=C(y,b,i)}else{l=C}if(!l){continue}a.push({x:M.is.number(l.x)?l.x+m:y,y:M.is.number(l.y)?l.y+v:b,range:M.is.number(l.range)?l.range:o.range})}}var x={target:null,inRange:false,distance:0,range:0,dx:0,dy:0};for(u=0,h=a.length;u<h;u++){l=a[u];var S=l.range;var A=l.x-c.x;var E=l.y-c.y;var T=M.hypot(A,E);var D=T<=S;if(S===Infinity&&x.inRange&&x.range!==Infinity){D=false}if(!x.target||(D?x.inRange&&S!==Infinity?T/S<x.distance/x.range:S===Infinity&&x.range!==Infinity||T<x.distance:!x.inRange&&T<x.distance)){x.target=l;x.distance=T;x.range=S;x.inRange=D;x.dx=A;x.dy=E;r.range=S}}var R=void 0;if(x.target){R=r.modifiedX!==x.target.x||r.modifiedY!==x.target.y;r.modifiedX=x.target.x;r.modifiedY=x.target.y}else{R=true;r.modifiedX=NaN;r.modifiedY=NaN}r.dx=x.dx;r.dy=x.dy;r.changed=R||x.inRange&&!r.locked;r.locked=x.inRange},modifyCoords:function e(t){var i=t.page,n=t.client,r=t.status,o=t.phase,s=t.options;var a=s&&s.relativePoints;if(s&&s.enabled&&!(o==="start"&&a&&a.length)){if(r.locked){i.x+=r.dx;i.y+=r.dy;n.x+=r.dx;n.y+=r.dy}return{range:r.range,locked:r.locked,x:r.modifiedX,y:r.modifiedY,realX:r.realX,realY:r.realY,dx:r.dx,dy:r.dy}}}};r.createSnapGrid=function(c){return function(e,t){var i=c.limits||{left:-Infinity,right:Infinity,top:-Infinity,bottom:Infinity};var n=0;var r=0;if(M.is.object(c.offset)){n=c.offset.x;r=c.offset.y}var o=Math.round((e-n)/c.x);var s=Math.round((t-r)/c.y);var a=Math.max(i.left,Math.min(i.right,o*c.x+n));var l=Math.max(i.top,Math.min(i.bottom,s*c.y+r));return{x:a,y:l,range:c.range}}};n.snap=s;n.names.push("snap");o.perAction.snap=s.defaults;t.exports=s},{"../defaultOptions":18,"../interact":21,"../utils":44,"./base":23}],28:[function(e,t,i){"use strict";var n=e("./base");var f=e("./snap");var r=e("../defaultOptions");var o=e("../actions/resize");var p=e("../utils/");var s={defaults:{enabled:false,endOnly:false,range:Infinity,targets:null,offsets:null},setOffset:function e(t){var i=t.interaction,n=t.options;var r=i.prepared.edges;if(!r){return}t.options={relativePoints:[{x:r.left?0:1,y:r.top?0:1}],origin:{x:0,y:0},offset:"self",range:n.range};var o=f.setOffset(t);t.options=n;return o},set:function e(t){var i=t.interaction,n=t.options,r=t.offset,o=t.modifiedCoords;var s=p.extend({},o);var a=s.x-r[0].x;var l=s.y-r[0].y;t.options=p.extend({},n);t.options.targets=[];for(var c=0;c<(n.targets||[]).length;c++){var u;u=(n.targets||[])[c];var d=u;var h=void 0;if(p.is.function(d)){h=d(a,l,i)}else{h=d}if(!h){continue}if("width"in h&&"height"in h){h.x=h.width;h.y=h.height}t.options.targets.push(h)}f.set(t)},modifyCoords:function e(t){var i=t.options;t.options=p.extend({},i);t.options.enabled=i.enabled;t.options.relativePoints=[null];f.modifyCoords(t)}};n.snapSize=s;n.names.push("snapSize");r.perAction.snapSize=s.defaults;o.defaults.snapSize=s.defaults;t.exports=s},{"../actions/resize":10,"../defaultOptions":18,"../utils/":44,"./base":23,"./snap":27}],29:[function(e,t,i){"use strict";function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=e("../utils/pointerUtils");t.exports=function(){function a(e,t,i,n,r){l(this,a);c.pointerExtend(this,i);if(i!==t){c.pointerExtend(this,t)}this.interaction=r;this.timeStamp=(new Date).getTime();this.originalEvent=i;this.type=e;this.pointerId=c.getPointerId(t);this.pointerType=c.getPointerType(t);this.target=n;this.currentTarget=null;if(e==="tap"){var o=r.getPointerIndex(t);this.dt=this.timeStamp-r.downTimes[o];var s=this.timeStamp-r.tapTime;this.double=!!(r.prevTap&&r.prevTap.type!=="doubletap"&&r.prevTap.target===this.target&&s<500)}else if(e==="doubletap"){this.dt=t.timeStamp-r.tapTime}}a.prototype.subtractOrigin=function e(t){var i=t.x,n=t.y;this.pageX-=i;this.pageY-=n;this.clientX-=i;this.clientY-=n;return this};a.prototype.addOrigin=function e(t){var i=t.x,n=t.y;this.pageX+=i;this.pageY+=n;this.clientX+=i;this.clientY+=n;return this};a.prototype.preventDefault=function e(){this.originalEvent.preventDefault()};a.prototype.stopPropagation=function e(){this.propagationStopped=true};a.prototype.stopImmediatePropagation=function e(){this.immediatePropagationStopped=this.propagationStopped=true};return a}()},{"../utils/pointerUtils":49}],30:[function(e,t,i){"use strict";var v=e("./PointerEvent");var n=e("../Interaction");var y=e("../utils");var r=e("../defaultOptions");var b=e("../utils/Signals").new();var o=["down","up","cancel"];var s=["down","up","cancel"];var a={PointerEvent:v,fire:_,collectEventTargets:w,signals:b,defaults:{holdDuration:600,ignoreFrom:null,allowFrom:null,origin:{x:0,y:0}},types:["down","move","up","cancel","tap","doubletap","hold"]};function _(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget,o=e.type,s=o===undefined?e.pointerEvent.type:o,a=e.targets,l=a===undefined?w(e):a,c=e.pointerEvent,u=c===undefined?new v(s,i,n,r,t):c;var d={interaction:t,pointer:i,event:n,eventTarget:r,targets:l,type:s,pointerEvent:u};for(var h=0;h<l.length;h++){var f=l[h];for(var p in f.props||{}){u[p]=f.props[p]}var g=y.getOriginXY(f.eventable,f.element);u.subtractOrigin(g);u.eventable=f.eventable;u.currentTarget=f.element;f.eventable.fire(u);u.addOrigin(g);if(u.immediatePropagationStopped||u.propagationStopped&&h+1<l.length&&l[h+1].element!==u.currentTarget){break}}b.fire("fired",d);if(s==="tap"){var m=u.double?_({interaction:t,pointer:i,event:n,eventTarget:r,type:"doubletap"}):u;t.prevTap=m;t.tapTime=m.timeStamp}return u}function w(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget,o=e.type;var s=t.getPointerIndex(i);if(o==="tap"&&(t.pointerWasMoved||!(t.downTargets[s]&&t.downTargets[s]===r))){return[]}var a=y.getPath(r);var l={interaction:t,pointer:i,event:n,eventTarget:r,type:o,path:a,targets:[],element:null};for(var c=0;c<a.length;c++){var u;u=a[c];var d=u;l.element=d;b.fire("collect-targets",l)}if(o==="hold"){l.targets=l.targets.filter(function(e){return e.eventable.options.holdDuration===t.holdTimers[s].duration})}return l.targets}n.signals.on("update-pointer-down",function(e){var t=e.interaction,i=e.pointerIndex;t.holdTimers[i]={duration:Infinity,timeout:null}});n.signals.on("remove-pointer",function(e){var t=e.interaction,i=e.pointerIndex;t.holdTimers.splice(i,1)});n.signals.on("move",function(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget,o=e.duplicateMove;var s=t.getPointerIndex(i);if(!o&&(!t.pointerIsDown||t.pointerWasMoved)){if(t.pointerIsDown){clearTimeout(t.holdTimers[s].timeout)}_({interaction:t,pointer:i,event:n,eventTarget:r,type:"move"})}});n.signals.on("down",function(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget,o=e.pointerIndex;var s=t.holdTimers[o];var a=y.getPath(r);var l={interaction:t,pointer:i,event:n,eventTarget:r,type:"hold",targets:[],path:a,element:null};for(var c=0;c<a.length;c++){var u;u=a[c];var d=u;l.element=d;b.fire("collect-targets",l)}if(!l.targets.length){return}var h=Infinity;for(var f=0;f<l.targets.length;f++){var p;p=l.targets[f];var g=p;var m=g.eventable.options.holdDuration;if(m<h){h=m}}s.duration=h;s.timeout=setTimeout(function(){_({interaction:t,eventTarget:r,pointer:i,event:n,type:"hold"})},h)});n.signals.on("up",function(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget;if(!t.pointerWasMoved){_({interaction:t,eventTarget:r,pointer:i,event:n,type:"tap"})}});var l=["up","cancel"];for(var c=0;c<l.length;c++){var u=l[c];n.signals.on(u,function(e){var t=e.interaction,i=e.pointerIndex;if(t.holdTimers[i]){clearTimeout(t.holdTimers[i].timeout)}})}function d(o){return function(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget;_({interaction:t,eventTarget:r,pointer:i,event:n,type:o})}}for(var h=0;h<o.length;h++){n.signals.on(o[h],d(s[h]))}n.signals.on("new",function(e){e.prevTap=null;e.tapTime=0;e.holdTimers=[]});r.pointerEvents=a.defaults;t.exports=a},{"../Interaction":5,"../defaultOptions":18,"../utils":44,"../utils/Signals":34,"./PointerEvent":29}],31:[function(e,t,i){"use strict";var s=e("./base");var n=e("../Interaction");s.signals.on("new",l);s.signals.on("fired",c);var r=["move","up","cancel","endall"];for(var o=0;o<r.length;o++){var a=r[o];n.signals.on(a,u)}function l(e){var t=e.pointerEvent;if(t.type!=="hold"){return}t.count=(t.count||0)+1}function c(e){var t=e.interaction,i=e.pointerEvent,n=e.eventTarget,r=e.targets;if(i.type!=="hold"||!r.length){return}var o=r[0].eventable.options.holdRepeatInterval;if(o<=0){return}t.holdIntervalHandle=setTimeout(function(){s.fire({interaction:t,eventTarget:n,type:"hold",pointer:i,event:i})},o)}function u(e){var t=e.interaction;if(t.holdIntervalHandle){clearInterval(t.holdIntervalHandle);t.holdIntervalHandle=null}}s.defaults.holdRepeatInterval=0;s.types.push("holdrepeat");t.exports={onNew:l,onFired:c,endHoldRepeat:u}},{"../Interaction":5,"./base":30}],32:[function(e,t,i){"use strict";var n=e("./base");var r=e("../Interactable");var a=e("../utils/is");var l=e("../scope");var o=e("../utils/extend");var s=e("../utils/arr"),c=s.merge;n.signals.on("collect-targets",function(e){var n=e.targets,r=e.element,o=e.type,s=e.eventTarget;l.interactables.forEachMatch(r,function(e){var t=e.events;var i=t.options;if(t[o]&&a.element(r)&&e.testIgnoreAllow(i,r,s)){n.push({element:r,eventable:t,props:{interactable:e}})}})});r.signals.on("new",function(e){var t=e.interactable;t.events.getRect=function(e){return t.getRect(e)}});r.signals.on("set",function(e){var t=e.interactable,i=e.options;o(t.events.options,n.defaults);o(t.events.options,i)});c(r.eventTypes,n.types);r.prototype.pointerEvents=function(e){o(this.events.options,e);return this};var u=r.prototype._backCompatOption;r.prototype._backCompatOption=function(e,t){var i=u.call(this,e,t);if(i===this){this.events.options[e]=t}return i};r.settingsMethods.push("pointerEvents")},{"../Interactable":4,"../scope":33,"../utils/arr":35,"../utils/extend":41,"../utils/is":46,"./base":30}],33:[function(e,t,i){"use strict";var n=e("./utils");var r=e("./utils/events");var o=e("./utils/Signals").new();var s=e("./utils/window"),a=s.getWindow;var l={signals:o,events:r,utils:n,document:e("./utils/domObjects").document,documents:[],addDocument:function e(t,i){if(n.contains(l.documents,t)){return false}i=i||a(t);l.documents.push(t);r.documents.push(t);if(t!==l.document){r.add(i,"unload",l.onWindowUnload)}o.fire("add-document",{doc:t,win:i})},removeDocument:function e(t,i){var n=l.documents.indexOf(t);i=i||a(t);r.remove(i,"unload",l.onWindowUnload);l.documents.splice(n,1);r.documents.splice(n,1);o.fire("remove-document",{win:i,doc:t})},onWindowUnload:function e(){l.removeDocument(this.document,this)}};t.exports=l},{"./utils":44,"./utils/Signals":34,"./utils/domObjects":38,"./utils/events":40,"./utils/window":52}],34:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var r=function(){function e(){n(this,e);this.listeners={}}e.prototype.on=function e(t,i){if(!this.listeners[t]){this.listeners[t]=[i];return}this.listeners[t].push(i)};e.prototype.off=function e(t,i){if(!this.listeners[t]){return}var n=this.listeners[t].indexOf(i);if(n!==-1){this.listeners[t].splice(n,1)}};e.prototype.fire=function e(t,i){var n=this.listeners[t];if(!n){return}for(var r=0;r<n.length;r++){var o;o=n[r];var s=o;if(s(i,t)===false){return}}};return e}();r.new=function(){return new r};t.exports=r},{}],35:[function(e,t,i){"use strict";function n(e,t){return e.indexOf(t)!==-1}function r(e,t){for(var i=0;i<t.length;i++){var n;n=t[i];var r=n;e.push(r)}return e}t.exports={contains:n,merge:r}},{}],36:[function(e,t,i){"use strict";var n=e("./window"),r=n.window;var o=e("./is");var s=e("./domObjects");var a=s.Element;var l=r.navigator;var c={supportsTouch:!!("ontouchstart"in r||o.function(r.DocumentTouch)&&s.document instanceof r.DocumentTouch),supportsPointerEvent:!!s.PointerEvent,isIOS:/iP(hone|od|ad)/.test(l.platform),isIOS7:/iP(hone|od|ad)/.test(l.platform)&&/OS 7[^\d]/.test(l.appVersion),isIe9:/MSIE 9/.test(l.userAgent),prefixedMatchesSelector:"matches"in a.prototype?"matches":"webkitMatchesSelector"in a.prototype?"webkitMatchesSelector":"mozMatchesSelector"in a.prototype?"mozMatchesSelector":"oMatchesSelector"in a.prototype?"oMatchesSelector":"msMatchesSelector",pEventTypes:s.PointerEvent?s.PointerEvent===r.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"}:null,wheelEvent:"onmousewheel"in s.document?"mousewheel":"wheel"};c.isOperaMobile=l.appName==="Opera"&&c.supportsTouch&&l.userAgent.match("Presto");t.exports=c},{"./domObjects":38,"./is":46,"./window":52}],37:[function(e,t,i){"use strict";var r=e("./is");t.exports=function e(t){var i={};for(var n in t){if(r.plainObject(t[n])){i[n]=e(t[n])}else{i[n]=t[n]}}return i}},{"./is":46}],38:[function(e,t,i){"use strict";var n={};var r=e("./window").window;function o(){}n.document=r.document;n.DocumentFragment=r.DocumentFragment||o;n.SVGElement=r.SVGElement||o;n.SVGSVGElement=r.SVGSVGElement||o;n.SVGElementInstance=r.SVGElementInstance||o;n.Element=r.Element||o;n.HTMLElement=r.HTMLElement||n.Element;n.Event=r.Event;n.Touch=r.Touch||o;n.PointerEvent=r.PointerEvent||r.MSPointerEvent;t.exports=n},{"./window":52}],39:[function(e,t,i){"use strict";var r=e("./window");var o=e("./browser");var s=e("./is");var h=e("./domObjects");var a={nodeContains:function e(t,i){while(i){if(i===t){return true}i=i.parentNode}return false},closest:function e(t,i){while(s.element(t)){if(a.matchesSelector(t,i)){return t}t=a.parentNode(t)}return null},parentNode:function e(t){var i=t.parentNode;if(s.docFrag(i)){while((i=i.host)&&s.docFrag(i)){continue}return i}return i},matchesSelector:function e(t,i){if(r.window!==r.realWindow){i=i.replace(/\/deep\//g," ")}return t[o.prefixedMatchesSelector](i)},indexOfDeepestElement:function e(t){var i=[];var n=[];var r=void 0;var o=t[0];var s=o?0:-1;var a=void 0;var l=void 0;var c=void 0;var u=void 0;for(c=1;c<t.length;c++){r=t[c];if(!r||r===o){continue}if(!o){o=r;s=c;continue}if(r.parentNode===r.ownerDocument){continue}else if(o.parentNode===r.ownerDocument){o=r;s=c;continue}if(!i.length){a=o;while(a.parentNode&&a.parentNode!==a.ownerDocument){i.unshift(a);a=a.parentNode}}if(o instanceof h.HTMLElement&&r instanceof h.SVGElement&&!(r instanceof h.SVGSVGElement)){if(r===o.parentNode){continue}a=r.ownerSVGElement}else{a=r}n=[];while(a.parentNode!==a.ownerDocument){n.unshift(a);a=a.parentNode}u=0;while(n[u]&&n[u]===i[u]){u++}var d=[n[u-1],n[u],i[u]];l=d[0].lastChild;while(l){if(l===d[1]){o=r;s=c;i=[];break}else if(l===d[2]){break}l=l.previousSibling}}return s},matchesUpTo:function e(t,i,n){while(s.element(t)){if(a.matchesSelector(t,i)){return true}t=a.parentNode(t);if(t===n){return a.matchesSelector(t,i)}}return false},getActualElement:function e(t){return t instanceof h.SVGElementInstance?t.correspondingUseElement:t},getScrollXY:function e(t){t=t||r.window;return{x:t.scrollX||t.document.documentElement.scrollLeft,y:t.scrollY||t.document.documentElement.scrollTop}},getElementClientRect:function e(t){var i=t instanceof h.SVGElement?t.getBoundingClientRect():t.getClientRects()[0];return i&&{left:i.left,right:i.right,top:i.top,bottom:i.bottom,width:i.width||i.right-i.left,height:i.height||i.bottom-i.top}},getElementRect:function e(t){var i=a.getElementClientRect(t);if(!o.isIOS7&&i){var n=a.getScrollXY(r.getWindow(t));i.left+=n.x;i.right+=n.x;i.top+=n.y;i.bottom+=n.y}return i},getPath:function e(t){var i=[];while(t){i.push(t);t=a.parentNode(t)}return i},trySelector:function e(t){if(!s.string(t)){return false}h.document.querySelector(t);return true}};t.exports=a},{"./browser":36,"./domObjects":38,"./is":46,"./window":52}],40:[function(e,t,i){"use strict";var v=e("./is");var y=e("./domUtils");var b=e("./pointerUtils");var _=e("./pointerExtend");var n=e("./window"),r=n.window;var o=e("./arr"),a=o.contains;var u=[];var d=[];var w={};var h=[];var f=function(){var e=false;r.document.createElement("div").addEventListener("test",null,{get capture(){e=true}});return e}();function p(e,t,i,n){var r=S(n);var o=u.indexOf(e);var s=d[o];if(!s){s={events:{},typeCount:0};o=u.push(e)-1;d.push(s)}if(!s.events[t]){s.events[t]=[];s.typeCount++}if(!a(s.events[t],i)){e.addEventListener(t,i,f?r:!!r.capture);s.events[t].push(i)}}function g(e,t,i,n){var r=S(n);var o=u.indexOf(e);var s=d[o];if(!s||!s.events){return}if(t==="all"){for(t in s.events){if(s.events.hasOwnProperty(t)){g(e,t,"all")}}return}if(s.events[t]){var a=s.events[t].length;if(i==="all"){for(var l=0;l<a;l++){g(e,t,s.events[t][l],r)}return}else{for(var c=0;c<a;c++){if(s.events[t][c]===i){e.removeEventListener("on"+t,i,f?r:!!r.capture);s.events[t].splice(c,1);break}}}if(s.events[t]&&s.events[t].length===0){s.events[t]=null;s.typeCount--}}if(!s.typeCount){d.splice(o,1);u.splice(o,1)}}function s(e,t,i,n,r){var o=S(r);if(!w[i]){w[i]={selectors:[],contexts:[],listeners:[]};for(var s=0;s<h.length;s++){var a=h[s];p(a,i,m);p(a,i,C,true)}}var l=w[i];var c=void 0;for(c=l.selectors.length-1;c>=0;c--){if(l.selectors[c]===e&&l.contexts[c]===t){break}}if(c===-1){c=l.selectors.length;l.selectors.push(e);l.contexts.push(t);l.listeners.push([])}l.listeners[c].push([n,!!o.capture,o.passive])}function l(e,t,i,n,r){var o=S(r);var s=w[i];var a=false;var l=void 0;if(!s){return}for(l=s.selectors.length-1;l>=0;l--){if(s.selectors[l]===e&&s.contexts[l]===t){var c=s.listeners[l];for(var u=c.length-1;u>=0;u--){var d=c[u],h=d[0],f=d[1],p=d[2];if(h===n&&f===!!o.capture&&p===o.passive){c.splice(u,1);if(!c.length){s.selectors.splice(l,1);s.contexts.splice(l,1);s.listeners.splice(l,1);g(t,i,m);g(t,i,C,true);if(!s.selectors.length){w[i]=null}}a=true;break}}if(a){break}}}}function m(e,t){var i=S(t);var n={};var r=w[e.type];var o=b.getEventTargets(e),s=o[0];var a=s;_(n,e);n.originalEvent=e;n.preventDefault=x;while(v.element(a)){for(var l=0;l<r.selectors.length;l++){var c=r.selectors[l];var u=r.contexts[l];if(y.matchesSelector(a,c)&&y.nodeContains(u,s)&&y.nodeContains(u,a)){var d=r.listeners[l];n.currentTarget=a;for(var h=0;h<d.length;h++){var f=d[h],p=f[0],g=f[1],m=f[2];if(g===!!i.capture&&m===i.passive){p(n)}}}}a=y.parentNode(a)}}function C(e){return m.call(this,e,true)}function x(){this.originalEvent.preventDefault()}function S(e){return v.object(e)?e:{capture:e}}t.exports={add:p,remove:g,addDelegate:s,removeDelegate:l,delegateListener:m,delegateUseCapture:C,delegatedEvents:w,documents:h,supportsOptions:f,_elements:u,_targets:d}},{"./arr":35,"./domUtils":39,"./is":46,"./pointerExtend":48,"./pointerUtils":49,"./window":52}],41:[function(e,t,i){"use strict";t.exports=function e(t,i){for(var n in i){t[n]=i[n]}return t}},{}],42:[function(e,t,i){"use strict";var n=e("./rect"),a=n.resolveRectLike,l=n.rectToXY;t.exports=function(e,t,i){var n=e.options[i];var r=n&&n.origin;var o=r||e.options.origin;var s=a(o,e,t,[e&&t]);return l(s)||{x:0,y:0}}},{"./rect":51}],43:[function(e,t,i){"use strict";t.exports=function(e,t){return Math.sqrt(e*e+t*t)}},{}],44:[function(e,t,i){"use strict";var n=e("./extend");var r=e("./window");var l={warnOnce:function e(t,i){var n=false;return function(){if(!n){r.window.console.warn(i);n=true}return t.apply(this,arguments)}},_getQBezierValue:function e(t,i,n,r){var o=1-t;return o*o*i+2*o*t*n+t*t*r},getQuadraticCurvePoint:function e(t,i,n,r,o,s,a){return{x:l._getQBezierValue(a,t,n,o),y:l._getQBezierValue(a,i,r,s)}},easeOutQuad:function e(t,i,n,r){t/=r;return-n*t*(t-2)+i},copyAction:function e(t,i){t.name=i.name;t.axis=i.axis;t.edges=i.edges;return t},is:e("./is"),extend:n,hypot:e("./hypot"),getOriginXY:e("./getOriginXY")};n(l,e("./arr"));n(l,e("./domUtils"));n(l,e("./pointerUtils"));n(l,e("./rect"));t.exports=l},{"./arr":35,"./domUtils":39,"./extend":41,"./getOriginXY":42,"./hypot":43,"./is":46,"./pointerUtils":49,"./rect":51,"./window":52}],45:[function(e,t,i){"use strict";var h=e("../scope");var f=e("./index");var d={methodOrder:["simulationResume","mouseOrPen","hasPointer","idle"],search:function e(t,i,n){var r=f.getPointerType(t);var o=f.getPointerId(t);var s={pointer:t,pointerId:o,pointerType:r,eventType:i,eventTarget:n};for(var a=0;a<d.methodOrder.length;a++){var l;l=d.methodOrder[a];var c=l;var u=d[c](s);if(u){return u}}},simulationResume:function e(t){var i=t.pointerType,n=t.eventType,r=t.eventTarget;if(!/down|start/i.test(n)){return null}for(var o=0;o<h.interactions.length;o++){var s;s=h.interactions[o];var a=s;var l=r;if(a.simulation&&a.simulation.allowResume&&a.pointerType===i){while(l){if(l===a.element){return a}l=f.parentNode(l)}}}return null},mouseOrPen:function e(t){var i=t.pointerId,n=t.pointerType,r=t.eventType;if(n!=="mouse"&&n!=="pen"){return null}var o=void 0;for(var s=0;s<h.interactions.length;s++){var a;a=h.interactions[s];var l=a;if(l.pointerType===n){if(l.simulation&&!f.contains(l.pointerIds,i)){continue}if(l.interacting()){return l}else if(!o){o=l}}}if(o){return o}for(var c=0;c<h.interactions.length;c++){var u;u=h.interactions[c];var d=u;if(d.pointerType===n&&!(/down/i.test(r)&&d.simulation)){return d}}return null},hasPointer:function e(t){var i=t.pointerId;for(var n=0;n<h.interactions.length;n++){var r;r=h.interactions[n];var o=r;if(f.contains(o.pointerIds,i)){return o}}},idle:function e(t){var i=t.pointerType;for(var n=0;n<h.interactions.length;n++){var r;r=h.interactions[n];var o=r;if(o.pointerIds.length===1){var s=o.target;if(s&&!s.options.gesture.enabled){continue}}else if(o.pointerIds.length>=2){continue}if(!o.interacting()&&i===o.pointerType){return o}}return null}};t.exports=d},{"../scope":33,"./index":44}],46:[function(e,t,i){"use strict";var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var r=e("./window");var o=e("./isWindow");var s={array:function e(){},window:function e(t){return t===r.window||o(t)},docFrag:function e(t){return s.object(t)&&t.nodeType===11},object:function e(t){return!!t&&(typeof t==="undefined"?"undefined":n(t))==="object"},function:function e(t){return typeof t==="function"},number:function e(t){return typeof t==="number"},bool:function e(t){return typeof t==="boolean"},string:function e(t){return typeof t==="string"},element:function e(t){if(!t||(typeof t==="undefined"?"undefined":n(t))!=="object"){return false}var i=r.getWindow(t)||r.window;return/object|function/.test(n(i.Element))?t instanceof i.Element:t.nodeType===1&&typeof t.nodeName==="string"},plainObject:function e(t){return s.object(t)&&t.constructor.name==="Object"}};s.array=function(e){return s.object(e)&&typeof e.length!=="undefined"&&s.function(e.splice)};t.exports=s},{"./isWindow":47,"./window":52}],47:[function(e,t,i){"use strict";t.exports=function(e){return!!(e&&e.Window)&&e instanceof e.Window}},{}],48:[function(e,s,t){"use strict";function i(e,t){for(var i in t){var n=s.exports.prefixedPropREs;var r=false;for(var o in n){if(i.indexOf(o)===0&&n[o].test(i)){r=true;break}}if(!r&&typeof t[i]!=="function"){e[i]=t[i]}}return e}i.prefixedPropREs={webkit:/(Movement[XY]|Radius[XY]|RotationAngle|Force)$/};s.exports=i},{}],49:[function(e,t,i){"use strict";var l=e("./hypot");var n=e("./browser");var r=e("./domObjects");var o=e("./domUtils");var s=e("./domObjects");var a=e("./is");var c=e("./pointerExtend");var u={copyCoords:function e(t,i){t.page=t.page||{};t.page.x=i.page.x;t.page.y=i.page.y;t.client=t.client||{};t.client.x=i.client.x;t.client.y=i.client.y;t.timeStamp=i.timeStamp},setCoordDeltas:function e(t,i,n){t.page.x=n.page.x-i.page.x;t.page.y=n.page.y-i.page.y;t.client.x=n.client.x-i.client.x;t.client.y=n.client.y-i.client.y;t.timeStamp=n.timeStamp-i.timeStamp;var r=Math.max(t.timeStamp/1e3,.001);t.page.speed=l(t.page.x,t.page.y)/r;t.page.vx=t.page.x/r;t.page.vy=t.page.y/r;t.client.speed=l(t.client.x,t.page.y)/r;t.client.vx=t.client.x/r;t.client.vy=t.client.y/r},isNativePointer:function e(t){return t instanceof r.Event||t instanceof r.Touch},getXY:function e(t,i,n){n=n||{};t=t||"page";n.x=i[t+"X"];n.y=i[t+"Y"];return n},getPageXY:function e(t,i){i=i||{};if(n.isOperaMobile&&u.isNativePointer(t)){u.getXY("screen",t,i);i.x+=window.scrollX;i.y+=window.scrollY}else{u.getXY("page",t,i)}return i},getClientXY:function e(t,i){i=i||{};if(n.isOperaMobile&&u.isNativePointer(t)){u.getXY("screen",t,i)}else{u.getXY("client",t,i)}return i},getPointerId:function e(t){return a.number(t.pointerId)?t.pointerId:t.identifier},setCoords:function e(t,i,n){var r=i.length>1?u.pointerAverage(i):i[0];var o={};u.getPageXY(r,o);t.page.x=o.x;t.page.y=o.y;u.getClientXY(r,o);t.client.x=o.x;t.client.y=o.y;t.timeStamp=a.number(n)?n:(new Date).getTime()},pointerExtend:c,getTouchPair:function e(t){var i=[];if(a.array(t)){i[0]=t[0];i[1]=t[1]}else{if(t.type==="touchend"){if(t.touches.length===1){i[0]=t.touches[0];i[1]=t.changedTouches[0]}else if(t.touches.length===0){i[0]=t.changedTouches[0];i[1]=t.changedTouches[1]}}else{i[0]=t.touches[0];i[1]=t.touches[1]}}return i},pointerAverage:function e(t){var i={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0};for(var n=0;n<t.length;n++){var r;r=t[n];var o=r;for(var s in i){i[s]+=o[s]}}for(var a in i){i[a]/=t.length}return i},touchBBox:function e(t){if(!t.length&&!(t.touches&&t.touches.length>1)){return}var i=u.getTouchPair(t);var n=Math.min(i[0].pageX,i[1].pageX);var r=Math.min(i[0].pageY,i[1].pageY);var o=Math.max(i[0].pageX,i[1].pageX);var s=Math.max(i[0].pageY,i[1].pageY);return{x:n,y:r,left:n,top:r,width:o-n,height:s-r}},touchDistance:function e(t,i){var n=i+"X";var r=i+"Y";var o=u.getTouchPair(t);var s=o[0][n]-o[1][n];var a=o[0][r]-o[1][r];return l(s,a)},touchAngle:function e(t,i,n){var r=n+"X";var o=n+"Y";var s=u.getTouchPair(t);var a=s[1][r]-s[0][r];var l=s[1][o]-s[0][o];var c=180*Math.atan2(l,a)/Math.PI;return c},getPointerType:function e(t){return a.string(t.pointerType)?t.pointerType:a.number(t.pointerType)?[undefined,undefined,"touch","pen","mouse"][t.pointerType]:/touch/.test(t.type)||t instanceof s.Touch?"touch":"mouse"},getEventTargets:function e(t){var i=a.function(t.composedPath)?t.composedPath():t.path;return[o.getActualElement(i?i[0]:t.target),o.getActualElement(t.currentTarget)]}};t.exports=u},{"./browser":36,"./domObjects":38,"./domUtils":39,"./hypot":43,"./is":46,"./pointerExtend":48}],50:[function(e,t,i){"use strict";var n=e("./window"),r=n.window;var o=["ms","moz","webkit","o"];var s=0;var a=void 0;var l=void 0;for(var c=0;c<o.length&&!r.requestAnimationFrame;c++){a=r[o[c]+"RequestAnimationFrame"];l=r[o[c]+"CancelAnimationFrame"]||r[o[c]+"CancelRequestAnimationFrame"]}if(!a){a=function e(t){var i=(new Date).getTime();var n=Math.max(0,16-(i-s));var r=setTimeout(function(){t(i+n)},n);s=i+n;return r}}if(!l){l=function e(t){clearTimeout(t)}}t.exports={request:a,cancel:l}},{"./window":52}],51:[function(e,t,i){"use strict";var n=e("./extend");var o=e("./is");var r=e("./domUtils"),s=r.closest,a=r.parentNode,l=r.getElementRect;var c={getStringOptionResult:function e(t,i,n){if(!o.string(t)){return null}if(t==="parent"){t=a(n)}else if(t==="self"){t=i.getRect(n)}else{t=s(n,t)}return t},resolveRectLike:function e(t,i,n,r){t=c.getStringOptionResult(t,i,n)||t;if(o.function(t)){t=t.apply(null,r)}if(o.element(t)){t=l(t)}return t},rectToXY:function e(t){return t&&{x:"x"in t?t.x:t.left,y:"y"in t?t.y:t.top}},xywhToTlbr:function e(t){if(t&&!("left"in t&&"top"in t)){t=n({},t);t.left=t.x||0;t.top=t.y||0;t.right=t.right||t.left+t.width;t.bottom=t.bottom||t.top+t.height}return t},tlbrToXywh:function e(t){if(t&&!("x"in t&&"y"in t)){t=n({},t);t.x=t.left||0;t.top=t.top||0;t.width=t.width||t.right-t.x;t.height=t.height||t.bottom-t.y}return t}};t.exports=c},{"./domUtils":39,"./extend":41,"./is":46}],52:[function(e,t,i){"use strict";var n=t.exports;var r=e("./isWindow");function o(e){n.realWindow=e;var t=e.document.createTextNode("");if(t.ownerDocument!==e.document&&typeof e.wrap==="function"&&e.wrap(t)===t){e=e.wrap(e)}n.window=e}if(typeof window==="undefined"){n.window=undefined;n.realWindow=undefined}else{o(window)}n.getWindow=function e(t){if(r(t)){return t}var i=t.ownerDocument||t;return i.defaultView||i.parentWindow||n.window};n.init=o},{"./isWindow":47}]},{},[1])(1)});"undefined"==typeof jQuery.migrateMute&&(jQuery.migrateMute=!0),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(e){return t(e,window)}):"object"==typeof module&&module.exports?module.exports=t(require("jquery"),window):t(jQuery,window)}(function(a,n){"use strict";function e(e){return 0<=function(e,t){for(var i=/^(\d+)\.(\d+)\.(\d+)/,n=i.exec(e)||[],r=i.exec(t)||[],o=1;o<=3;o++){if(+r[o]<+n[o])return 1;if(+n[o]<+r[o])return-1}return 0}(a.fn.jquery,e)}a.migrateVersion="3.3.2",n.console&&n.console.log&&(a&&e("3.0.0")||n.console.log("JQMIGRATE: jQuery 3.0.0+ REQUIRED"),a.migrateWarnings&&n.console.log("JQMIGRATE: Migrate plugin loaded multiple times"),n.console.log("JQMIGRATE: Migrate is installed"+(a.migrateMute?"":" with logging active")+", version "+a.migrateVersion));var i={};function l(e){var t=n.console;a.migrateDeduplicateWarnings&&i[e]||(i[e]=!0,a.migrateWarnings.push(e),t&&t.warn&&!a.migrateMute&&(t.warn("JQMIGRATE: "+e),a.migrateTrace&&t.trace&&t.trace()))}function t(e,t,i,n){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){return l(n),i},set:function(e){l(n),i=e}})}function r(e,t,i,n){e[t]=function(){return l(n),i.apply(this,arguments)}}a.migrateDeduplicateWarnings=!0,a.migrateWarnings=[],void 0===a.migrateTrace&&(a.migrateTrace=!0),a.migrateReset=function(){i={},a.migrateWarnings.length=0},"BackCompat"===n.document.compatMode&&l("jQuery is not compatible with Quirks Mode");var o,s,c,u={},d=a.fn.init,h=a.find,f=/\[(\s*[-\w]+\s*)([~|^$*]?=)\s*([-\w#]*?#[-\w#]*)\s*\]/,p=/\[(\s*[-\w]+\s*)([~|^$*]?=)\s*([-\w#]*?#[-\w#]*)\s*\]/g,g=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;for(o in a.fn.init=function(e){var t=Array.prototype.slice.call(arguments);return"string"==typeof e&&"#"===e&&(l("jQuery( '#' ) is not a valid selector"),t[0]=[]),d.apply(this,t)},a.fn.init.prototype=a.fn,a.find=function(t){var i=Array.prototype.slice.call(arguments);if("string"==typeof t&&f.test(t))try{n.document.querySelector(t)}catch(e){t=t.replace(p,function(e,t,i,n){return"["+t+i+'"'+n+'"]'});try{n.document.querySelector(t),l("Attribute selector with '#' must be quoted: "+i[0]),i[0]=t}catch(e){l("Attribute selector with '#' was not fixed: "+i[0])}}return h.apply(this,i)},h)Object.prototype.hasOwnProperty.call(h,o)&&(a.find[o]=h[o]);r(a.fn,"size",function(){return this.length},"jQuery.fn.size() is deprecated and removed; use the .length property"),r(a,"parseJSON",function(){return JSON.parse.apply(null,arguments)},"jQuery.parseJSON is deprecated; use JSON.parse"),r(a,"holdReady",a.holdReady,"jQuery.holdReady is deprecated"),r(a,"unique",a.uniqueSort,"jQuery.unique is deprecated; use jQuery.uniqueSort"),t(a.expr,"filters",a.expr.pseudos,"jQuery.expr.filters is deprecated; use jQuery.expr.pseudos"),t(a.expr,":",a.expr.pseudos,"jQuery.expr[':'] is deprecated; use jQuery.expr.pseudos"),e("3.1.1")&&r(a,"trim",function(e){return null==e?"":(e+"").replace(g,"")},"jQuery.trim is deprecated; use String.prototype.trim"),e("3.2.0")&&(r(a,"nodeName",function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},"jQuery.nodeName is deprecated"),r(a,"isArray",Array.isArray,"jQuery.isArray is deprecated; use Array.isArray")),e("3.3.0")&&(r(a,"isNumeric",function(e){var t=typeof e;return("number"==t||"string"==t)&&!isNaN(e-parseFloat(e))},"jQuery.isNumeric() is deprecated"),a.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){u["[object "+t+"]"]=t.toLowerCase()}),r(a,"type",function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?u[Object.prototype.toString.call(e)]||"object":typeof e},"jQuery.type is deprecated"),r(a,"isFunction",function(e){return"function"==typeof e},"jQuery.isFunction() is deprecated"),r(a,"isWindow",function(e){return null!=e&&e===e.window},"jQuery.isWindow() is deprecated")),a.ajax&&(s=a.ajax,c=/(=)\?(?=&|$)|\?\?/,a.ajax=function(){var e=s.apply(this,arguments);return e.promise&&(r(e,"success",e.done,"jQXHR.success is deprecated and removed"),r(e,"error",e.fail,"jQXHR.error is deprecated and removed"),r(e,"complete",e.always,"jQXHR.complete is deprecated and removed")),e},e("4.0.0")||a.ajaxPrefilter("+json",function(e){!1!==e.jsonp&&(c.test(e.url)||"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&c.test(e.data))&&l("JSON-to-JSONP auto-promotion is deprecated")}));var m=a.fn.removeAttr,v=a.fn.toggleClass,y=/\S+/g;function b(e){return e.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()})}a.fn.removeAttr=function(e){var i=this;return a.each(e.match(y),function(e,t){a.expr.match.bool.test(t)&&(l("jQuery.fn.removeAttr no longer sets boolean properties: "+t),i.prop(t,!1))}),m.apply(this,arguments)};var _,w=!(a.fn.toggleClass=function(t){return void 0!==t&&"boolean"!=typeof t?v.apply(this,arguments):(l("jQuery.fn.toggleClass( boolean ) is deprecated"),this.each(function(){var e=this.getAttribute&&this.getAttribute("class")||"";e&&a.data(this,"__className__",e),this.setAttribute&&this.setAttribute("class",!e&&!1!==t&&a.data(this,"__className__")||"")}))}),C=/^[a-z]/,x=/^(?:Border(?:Top|Right|Bottom|Left)?(?:Width|)|(?:Margin|Padding)?(?:Top|Right|Bottom|Left)?|(?:Min|Max)?(?:Width|Height))$/;a.swap&&a.each(["height","width","reliableMarginRight"],function(e,t){var i=a.cssHooks[t]&&a.cssHooks[t].get;i&&(a.cssHooks[t].get=function(){var e;return w=!0,e=i.apply(this,arguments),w=!1,e})}),a.swap=function(e,t,i,n){var r,o,s={};for(o in w||l("jQuery.swap() is undocumented and deprecated"),t)s[o]=e.style[o],e.style[o]=t[o];for(o in r=i.apply(e,n||[]),t)e.style[o]=s[o];return r},e("3.4.0")&&"undefined"!=typeof Proxy&&(a.cssProps=new Proxy(a.cssProps||{},{set:function(){return l("JQMIGRATE: jQuery.cssProps is deprecated"),Reflect.set.apply(this,arguments)}})),a.cssNumber||(a.cssNumber={}),_=a.fn.css,a.fn.css=function(e,t){var i,n,r=this;return e&&"object"==typeof e&&!Array.isArray(e)?(a.each(e,function(e,t){a.fn.css.call(r,e,t)}),this):("number"==typeof t&&(i=b(e),n=i,C.test(n)&&x.test(n[0].toUpperCase()+n.slice(1))||a.cssNumber[i]||l('Number-typed values are deprecated for jQuery.fn.css( "'+e+'", value )')),_.apply(this,arguments))};var S,A,E,T,D=a.data;a.data=function(e,t,i){var n,r,o;if(t&&"object"==typeof t&&2===arguments.length){for(o in n=a.hasData(e)&&D.call(this,e),r={},t)o!==b(o)?(l("jQuery.data() always sets/gets camelCased names: "+o),n[o]=t[o]):r[o]=t[o];return D.call(this,e,r),t}return t&&"string"==typeof t&&t!==b(t)&&(n=a.hasData(e)&&D.call(this,e))&&t in n?(l("jQuery.data() always sets/gets camelCased names: "+t),2<arguments.length&&(n[t]=i),n[t]):D.apply(this,arguments)},a.fx&&(E=a.Tween.prototype.run,T=function(e){return e},a.Tween.prototype.run=function(){1<a.easing[this.easing].length&&(l("'jQuery.easing."+this.easing.toString()+"' should use only one argument"),a.easing[this.easing]=T),E.apply(this,arguments)},S=a.fx.interval||13,A="jQuery.fx.interval is deprecated",n.requestAnimationFrame&&Object.defineProperty(a.fx,"interval",{configurable:!0,enumerable:!0,get:function(){return n.document.hidden||l(A),S},set:function(e){l(A),S=e}}));var R=a.fn.load,P=a.event.add,F=a.event.fix;a.event.props=[],a.event.fixHooks={},t(a.event.props,"concat",a.event.props.concat,"jQuery.event.props.concat() is deprecated and removed"),a.event.fix=function(e){var t,i=e.type,n=this.fixHooks[i],r=a.event.props;if(r.length){l("jQuery.event.props are deprecated and removed: "+r.join());while(r.length)a.event.addProp(r.pop())}if(n&&!n._migrated_&&(n._migrated_=!0,l("jQuery.event.fixHooks are deprecated and removed: "+i),(r=n.props)&&r.length))while(r.length)a.event.addProp(r.pop());return t=F.call(this,e),n&&n.filter?n.filter(t,e):t},a.event.add=function(e,t){return e===n&&"load"===t&&"complete"===n.document.readyState&&l("jQuery(window).on('load'...) called after load event occurred"),P.apply(this,arguments)},a.each(["load","unload","error"],function(e,t){a.fn[t]=function(){var e=Array.prototype.slice.call(arguments,0);return"load"===t&&"string"==typeof e[0]?R.apply(this,e):(l("jQuery.fn."+t+"() is deprecated"),e.splice(0,0,t),arguments.length?this.on.apply(this,e):(this.triggerHandler.apply(this,e),this))}}),a.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,i){a.fn[i]=function(e,t){return l("jQuery.fn."+i+"() event shorthand is deprecated"),0<arguments.length?this.on(i,null,e,t):this.trigger(i)}}),a(function(){a(n.document).triggerHandler("ready")}),a.event.special.ready={setup:function(){this===n.document&&l("'ready' event is deprecated")}},a.fn.extend({bind:function(e,t,i){return l("jQuery.fn.bind() is deprecated"),this.on(e,null,t,i)},unbind:function(e,t){return l("jQuery.fn.unbind() is deprecated"),this.off(e,null,t)},delegate:function(e,t,i,n){return l("jQuery.fn.delegate() is deprecated"),this.on(t,e,i,n)},undelegate:function(e,t,i){return l("jQuery.fn.undelegate() is deprecated"),1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},hover:function(e,t){return l("jQuery.fn.hover() is deprecated"),this.on("mouseenter",e).on("mouseleave",t||e)}});function M(e){var t=n.document.implementation.createHTMLDocument("");return t.body.innerHTML=e,t.body&&t.body.innerHTML}function k(e){var t=e.replace(O,"<$1></$2>");t!==e&&M(e)!==M(t)&&l("HTML tags must be properly nested and closed: "+e)}var O=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,G=a.htmlPrefilter;a.UNSAFE_restoreLegacyHtmlPrefilter=function(){a.htmlPrefilter=function(e){return k(e),e.replace(O,"<$1></$2>")}},a.htmlPrefilter=function(e){return k(e),G(e)};var N,$=a.fn.offset;a.fn.offset=function(){var e=this[0];return!e||e.nodeType&&e.getBoundingClientRect?$.apply(this,arguments):(l("jQuery.fn.offset() requires a valid DOM element"),arguments.length?this:void 0)},a.ajax&&(N=a.param,a.param=function(e,t){var i=a.ajaxSettings&&a.ajaxSettings.traditional;return void 0===t&&i&&(l("jQuery.param() no longer uses jQuery.ajaxSettings.traditional"),t=i),N.call(this,e,t)});var I,L,H=a.fn.andSelf||a.fn.addBack;return a.fn.andSelf=function(){return l("jQuery.fn.andSelf() is deprecated and removed, use jQuery.fn.addBack()"),H.apply(this,arguments)},a.Deferred&&(I=a.Deferred,L=[["resolve","done",a.Callbacks("once memory"),a.Callbacks("once memory"),"resolved"],["reject","fail",a.Callbacks("once memory"),a.Callbacks("once memory"),"rejected"],["notify","progress",a.Callbacks("memory"),a.Callbacks("memory")]],a.Deferred=function(e){var o=I(),s=o.promise();return o.pipe=s.pipe=function(){var r=arguments;return l("deferred.pipe() is deprecated"),a.Deferred(function(n){a.each(L,function(e,t){var i="function"==typeof r[e]&&r[e];o[t[1]](function(){var e=i&&i.apply(this,arguments);e&&"function"==typeof e.promise?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[t[0]+"With"](this===s?n.promise():this,i?[e]:arguments)})}),r=null}).promise()},e&&e.call(o,o),o},a.Deferred.exceptionHook=I.exceptionHook),a});