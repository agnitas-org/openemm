/* ==========================================================================
   Emm JS - nightly build 09-10-2024
   ========================================================================== */

/* License
   ========================================================================== */

/**
 * EMM License to be added
 *
 **/



/* Libraries
   ========================================================================== */

/**
 * jQuery JavaScript Library v3.5.1
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * (c) 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Licensed under MIT (http://jquery.org/license)
 *
 * http://jquery.com
 **/

/**
 * Lo-Dash 4.17.21 (Custom Build)
 *
 * Build: `lodash -o ./dist/lodash.compat.js`
 *
 * Based on Underscore.js 1.8.3
 * Licensed under MIT (http://underscorejs.org/LICENSE)
 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 *
 * (c) 2012-2013 The Dojo Foundation http://dojofoundation.org/
 * Licensed under MIT (http://lodash.com/license)
 *
 * https://lodash.com/
 **/

 /**
 * D3.js 3.5.5
 *
 * Licensed under MIT (https://github.com/mbostock/d3/blob/master/LICENSE)
 * (c) 2010-2015, Michael Bostock
 *
 * http://d3js.org/
 **/

  /**
 * C3.js 0.4.10
 *
 * Licensed under MIT (https://github.com/masayuki0812/c3/blob/master/LICENSE)
 * (c) 2013 Masayuki Tanaka
 *
 * http://c3js.org/
 **/

/**
 * jQuery Plugins
 *
 * jquery-i18n v1.1.1
 * Licensed under MIT
 * (c) 2010 Dave Perrett
 * https://github.com/recurser/jquery-i18n
 *
 * jquery-migrate v3.3.2
 * Licensed under MIT
 * (c) 2005, 2013 jQuery Foundation, Inc. and other contributors
 * https://github.com/jquery/jquery-migrate
 *
 * jquery-select2 v3.5.2
 * Licensed under Apache License, Version 2.0 & GNU General Public License version 2
 * (c) 2012 Igor Vaynberg
 * https://ivaynberg.github.io/select2/
 *
 * jquery-mousewheel v3.1.9
 * Licensed under MIT
 * (c) 2013 Brandon Aaron
 * http://brandon.aaron.sh
 *
 * jquery-perfect-scrollbar v0.5.7
 * Licensed under MIT
 * (c) 2012, 2014 Hyunje Alex Jun and other contributors
 * https://noraesae.github.io/perfect-scrollbar/
 *
 * jquery DoubleScroll v0.4
 * Dual licensed under the MIT and GPL licenses
 * (c) Pawel Suwala, Antoine Vianey
 * https://github.com/avianey/jqDoubleScroll
 *
 * jquery Endless Scroll
 * Dual licensed under the MIT and GPL licenses
 * (c) 2008-2012 Fred Wu
 * https://github.com/fredwu/jquery-endless-scroll
 *
 * jQuery File Upload Plugin
 * Licensed under the MIT license
 * (c) 2010, Sebastian Tschan
 * https://github.com/blueimp/jQuery-File-Upload
 **/

/**
 * Bootstrap Components v3.4.1
 *
 * dropdown.js
 * modal.js
 * popover.js
 * tooltip.js
 *
 * (c) 2011-2019 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 *
 * http://getbootstrap.com/
 **/

/**
 * Bootstrap Extensions
 *
 * bootstrap-slider v4.8.1
 * Licensed under MIT
 * (c) 2015 Kyle Kemp, Rohit Kalkur, and contributors
 *
 * bootstrap-colorpicker v2.5.2
 * Licensed under Apache License v2.0
 * (c) 2012 Stefan Petre
 *
 **/

/**
 * jQuery UI v1.13.1
 *
 * core.js, widget.js, mouse.js, position.js, accordion.js, autocomplete.js, button.js, datepicker.js, dialog.js, draggable.js, droppable.js, effect.js, effect-blind.js, effect-bounce.js, effect-clip.js, effect-drop.js, effect-explode.js, effect-fade.js, effect-fold.js, effect-highlight.js, effect-puff.js, effect-pulsate.js, effect-scale.js, effect-shake.js, effect-size.js, effect-slide.js, effect-transfer.js, menu.js, progressbar.js, resizable.js, selectable.js, selectmenu.js, slider.js, sortable.js, spinner.js, tabs.js, tooltip.js
 *
 * (c) 2014 jQuery Foundation and other contributors
 * Licensed under MIT
 *
 * http://jqueryui.com
 **/

/**
 * Pickadate v3.5.6
 *
 * date.js
 * time.js
 * legacy.js
 *
 * (c) 2014 Amsul, http://amsul.ca
 * Licensed under https://github.com/amsul/pickadate.js/blob/3.5.6/LICENSE.md
 *
 * https://amsul.github.io/pickadate.js
 **/

/**
 * Ace Editor
 *
 * Distributed under the BSD license:

 * Copyright (c) 2010, Ajax.org B.V.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *     * Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in the
 *       documentation and/or other materials provided with the distribution.
 *     * Neither the name of Ajax.org B.V. nor the
 *       names of its contributors may be used to endorse or promote products
 *       derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * http://ace.c9.io/
 **/

/**
 * iFrame Resizer v4.3.2
 *
 * (c) 2014 David J. Bradshaw - dave@bradshaw.net
 * Licensed under MIT
 *
 * https://davidjbradshaw.github.io/iframe-resizer/
 **/

/**
 * Toastr (modified version)
 *
 * (c) 2012-2014 John Papa and Hans Fj√§llemark
 * Licensed under MIT
 *
 * https://github.com/CodeSeven/toastr
 **/

/**
 * EmojiOne Area v v3.4.1
 *
 * EmojiOneArea is released under the MIT license.
 *
 * Copyright (c) 2015-2017 Andrey Izman <izmanw@gmail.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

(function(e,t){"use strict";if(typeof module==="object"&&typeof module.exports==="object"){module.exports=e.document?t(e,true):function(e){if(!e.document){throw new Error("jQuery requires a window with a document")}return t(e)}}else{t(e)}})(typeof window!=="undefined"?window:this,function(A,L){"use strict";var t=[];var F=Object.getPrototypeOf;var a=t.slice;var G=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)};var $=t.push;var H=t.indexOf;var B={};var V=B.toString;var W=B.hasOwnProperty;var z=W.toString;var j=z.call(Object);var g={};var m=function e(t){return typeof t==="function"&&typeof t.nodeType!=="number"&&typeof t.item!=="function"};var v=function e(t){return t!=null&&t===t.window};var E=A.document;var U={type:true,src:true,nonce:true,noModule:true};function Y(e,t,i){i=i||E;var n,r,s=i.createElement("script");s.text=e;if(t){for(n in U){r=t[n]||t.getAttribute&&t.getAttribute(n);if(r){s.setAttribute(n,r)}}}i.head.appendChild(s).parentNode.removeChild(s)}function y(e){if(e==null){return e+""}return typeof e==="object"||typeof e==="function"?B[V.call(e)]||"object":typeof e}var q="3.5.1",S=function(e,t){return new S.fn.init(e,t)};S.fn=S.prototype={jquery:q,constructor:S,length:0,toArray:function(){return a.call(this)},get:function(e){if(e==null){return a.call(this)}return e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=S.merge(this.constructor(),e);t.prevObject=this;return t},each:function(e){return S.each(this,e)},map:function(i){return this.pushStack(S.map(this,function(e,t){return i.call(e,t,e)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(S.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:$,sort:t.sort,splice:t.splice};S.extend=S.fn.extend=function(){var e,t,i,n,r,s,o=arguments[0]||{},a=1,l=arguments.length,c=false;if(typeof o==="boolean"){c=o;o=arguments[a]||{};a++}if(typeof o!=="object"&&!m(o)){o={}}if(a===l){o=this;a--}for(;a<l;a++){if((e=arguments[a])!=null){for(t in e){n=e[t];if(t==="__proto__"||o===n){continue}if(c&&n&&(S.isPlainObject(n)||(r=Array.isArray(n)))){i=o[t];if(r&&!Array.isArray(i)){s=[]}else if(!r&&!S.isPlainObject(i)){s={}}else{s=i}r=false;o[t]=S.extend(c,s,n)}else if(n!==undefined){o[t]=n}}}}return o};S.extend({expando:"jQuery"+(q+Math.random()).replace(/\D/g,""),isReady:true,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,i;if(!e||V.call(e)!=="[object Object]"){return false}t=F(e);if(!t){return true}i=W.call(t,"constructor")&&t.constructor;return typeof i==="function"&&z.call(i)===j},isEmptyObject:function(e){var t;for(t in e){return false}return true},globalEval:function(e,t,i){Y(e,{nonce:t&&t.nonce},i)},each:function(e,t){var i,n=0;if(K(e)){i=e.length;for(;n<i;n++){if(t.call(e[n],n,e[n])===false){break}}}else{for(n in e){if(t.call(e[n],n,e[n])===false){break}}}return e},makeArray:function(e,t){var i=t||[];if(e!=null){if(K(Object(e))){S.merge(i,typeof e==="string"?[e]:e)}else{$.call(i,e)}}return i},inArray:function(e,t,i){return t==null?-1:H.call(t,e,i)},merge:function(e,t){var i=+t.length,n=0,r=e.length;for(;n<i;n++){e[r++]=t[n]}e.length=r;return e},grep:function(e,t,i){var n,r=[],s=0,o=e.length,a=!i;for(;s<o;s++){n=!t(e[s],s);if(n!==a){r.push(e[s])}}return r},map:function(e,t,i){var n,r,s=0,o=[];if(K(e)){n=e.length;for(;s<n;s++){r=t(e[s],s,i);if(r!=null){o.push(r)}}}else{for(s in e){r=t(e[s],s,i);if(r!=null){o.push(r)}}}return G(o)},guid:1,support:g});if(typeof Symbol==="function"){S.fn[Symbol.iterator]=t[Symbol.iterator]}S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){B["[object "+t+"]"]=t.toLowerCase()});function K(e){var t=!!e&&"length"in e&&e.length,i=y(e);if(m(e)||v(e)){return false}return i==="array"||t===0||typeof t==="number"&&t>0&&t-1 in e}var e=function(L){var e,p,C,s,F,f,G,$,w,l,c,_,A,r,E,g,o,a,m,S="sizzle"+1*new Date,u=L.document,T=0,H=0,B=n(),V=n(),W=n(),v=n(),z=function(e,t){if(e===t){c=true}return 0},j={}.hasOwnProperty,t=[],U=t.pop,Y=t.push,x=t.push,q=t.slice,y=function(e,t){var i=0,n=e.length;for(;i<n;i++){if(e[i]===t){return i}}return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|"+"ismap|loop|multiple|open|readonly|required|scoped",d="[\\x20\\t\\r\\n\\f]",i="(?:\\\\[\\da-fA-F]{1,6}"+d+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",X="\\["+d+"*("+i+")(?:"+d+"*([*^$|!~]?=)"+d+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+i+"))|)"+d+"*\\]",Q=":("+i+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+X+")*)|"+".*"+")\\)|)",Z=new RegExp(d+"+","g"),b=new RegExp("^"+d+"+|((?:^|[^\\\\])(?:\\\\.)*)"+d+"+$","g"),J=new RegExp("^"+d+"*,"+d+"*"),ee=new RegExp("^"+d+"*([>+~]|"+d+")"+d+"*"),te=new RegExp(d+"|>"),ie=new RegExp(Q),ne=new RegExp("^"+i+"$"),h={ID:new RegExp("^#("+i+")"),CLASS:new RegExp("^\\.("+i+")"),TAG:new RegExp("^("+i+"|[*])"),ATTR:new RegExp("^"+X),PSEUDO:new RegExp("^"+Q),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+d+"*(even|odd|(([+-]|)(\\d*)n|)"+d+"*(?:([+-]|)"+d+"*(\\d+)|))"+d+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+d+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+d+"*((?:-\\d)?\\d*)"+d+"*\\)|)(?=[^-]|$)","i")},re=/HTML$/i,se=/^(?:input|select|textarea|button)$/i,oe=/^h\d$/i,D=/^[^{]+\{\s*\[native \w/,ae=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,le=/[+~]/,R=new RegExp("\\\\[\\da-fA-F]{1,6}"+d+"?|\\\\([^\\r\\n\\f])","g"),M=function(e,t){var i="0x"+e.slice(1)-65536;return t?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,i&1023|56320)},ce=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ue=function(e,t){if(t){if(e==="\0"){return""}return e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" "}return"\\"+e},de=function(){_()},he=Ce(function(e){return e.disabled===true&&e.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"});try{x.apply(t=q.call(u.childNodes),u.childNodes);t[u.childNodes.length].nodeType}catch(e){x={apply:t.length?function(e,t){Y.apply(e,q.call(t))}:function(e,t){var i=e.length,n=0;while(e[i++]=t[n++]){}e.length=i-1}}}function N(t,e,i,n){var r,s,o,a,l,c,u,d=e&&e.ownerDocument,h=e?e.nodeType:9;i=i||[];if(typeof t!=="string"||!t||h!==1&&h!==9&&h!==11){return i}if(!n){_(e);e=e||A;if(E){if(h!==11&&(l=ae.exec(t))){if(r=l[1]){if(h===9){if(o=e.getElementById(r)){if(o.id===r){i.push(o);return i}}else{return i}}else{if(d&&(o=d.getElementById(r))&&m(e,o)&&o.id===r){i.push(o);return i}}}else if(l[2]){x.apply(i,e.getElementsByTagName(t));return i}else if((r=l[3])&&p.getElementsByClassName&&e.getElementsByClassName){x.apply(i,e.getElementsByClassName(r));return i}}if(p.qsa&&!v[t+" "]&&(!g||!g.test(t))&&(h!==1||e.nodeName.toLowerCase()!=="object")){u=t;d=e;if(h===1&&(te.test(t)||ee.test(t))){d=le.test(t)&&ye(e.parentNode)||e;if(d!==e||!p.scope){if(a=e.getAttribute("id")){a=a.replace(ce,ue)}else{e.setAttribute("id",a=S)}}c=f(t);s=c.length;while(s--){c[s]=(a?"#"+a:":scope")+" "+k(c[s])}u=c.join(",")}try{x.apply(i,d.querySelectorAll(u));return i}catch(e){v(t,true)}finally{if(a===S){e.removeAttribute("id")}}}}}return $(t.replace(b,"$1"),e,i,n)}function n(){var i=[];function n(e,t){if(i.push(e+" ")>C.cacheLength){delete n[i.shift()]}return n[e+" "]=t}return n}function O(e){e[S]=true;return e}function I(e){var t=A.createElement("fieldset");try{return!!e(t)}catch(e){return false}finally{if(t.parentNode){t.parentNode.removeChild(t)}t=null}}function pe(e,t){var i=e.split("|"),n=i.length;while(n--){C.attrHandle[i[n]]=t}}function fe(e,t){var i=t&&e,n=i&&e.nodeType===1&&t.nodeType===1&&e.sourceIndex-t.sourceIndex;if(n){return n}if(i){while(i=i.nextSibling){if(i===t){return-1}}}return e?1:-1}function ge(i){return function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type===i}}function me(i){return function(e){var t=e.nodeName.toLowerCase();return(t==="input"||t==="button")&&e.type===i}}function ve(t){return function(e){if("form"in e){if(e.parentNode&&e.disabled===false){if("label"in e){if("label"in e.parentNode){return e.parentNode.disabled===t}else{return e.disabled===t}}return e.isDisabled===t||e.isDisabled!==!t&&he(e)===t}return e.disabled===t}else if("label"in e){return e.disabled===t}return false}}function P(o){return O(function(s){s=+s;return O(function(e,t){var i,n=o([],e.length,s),r=n.length;while(r--){if(e[i=n[r]]){e[i]=!(t[i]=e[i])}}})})}function ye(e){return e&&typeof e.getElementsByTagName!=="undefined"&&e}p=N.support={};F=N.isXML=function(e){var t=e.namespaceURI,i=(e.ownerDocument||e).documentElement;return!re.test(t||i&&i.nodeName||"HTML")};_=N.setDocument=function(e){var t,i,n=e?e.ownerDocument||e:u;if(n==A||n.nodeType!==9||!n.documentElement){return A}A=n;r=A.documentElement;E=!F(A);if(u!=A&&(i=A.defaultView)&&i.top!==i){if(i.addEventListener){i.addEventListener("unload",de,false)}else if(i.attachEvent){i.attachEvent("onunload",de)}}p.scope=I(function(e){r.appendChild(e).appendChild(A.createElement("div"));return typeof e.querySelectorAll!=="undefined"&&!e.querySelectorAll(":scope fieldset div").length});p.attributes=I(function(e){e.className="i";return!e.getAttribute("className")});p.getElementsByTagName=I(function(e){e.appendChild(A.createComment(""));return!e.getElementsByTagName("*").length});p.getElementsByClassName=D.test(A.getElementsByClassName);p.getById=I(function(e){r.appendChild(e).id=S;return!A.getElementsByName||!A.getElementsByName(S).length});if(p.getById){C.filter["ID"]=function(e){var t=e.replace(R,M);return function(e){return e.getAttribute("id")===t}};C.find["ID"]=function(e,t){if(typeof t.getElementById!=="undefined"&&E){var i=t.getElementById(e);return i?[i]:[]}}}else{C.filter["ID"]=function(e){var i=e.replace(R,M);return function(e){var t=typeof e.getAttributeNode!=="undefined"&&e.getAttributeNode("id");return t&&t.value===i}};C.find["ID"]=function(e,t){if(typeof t.getElementById!=="undefined"&&E){var i,n,r,s=t.getElementById(e);if(s){i=s.getAttributeNode("id");if(i&&i.value===e){return[s]}r=t.getElementsByName(e);n=0;while(s=r[n++]){i=s.getAttributeNode("id");if(i&&i.value===e){return[s]}}}return[]}}}C.find["TAG"]=p.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!=="undefined"){return t.getElementsByTagName(e)}else if(p.qsa){return t.querySelectorAll(e)}}:function(e,t){var i,n=[],r=0,s=t.getElementsByTagName(e);if(e==="*"){while(i=s[r++]){if(i.nodeType===1){n.push(i)}}return n}return s};C.find["CLASS"]=p.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!=="undefined"&&E){return t.getElementsByClassName(e)}};o=[];g=[];if(p.qsa=D.test(A.querySelectorAll)){I(function(e){var t;r.appendChild(e).innerHTML="<a id='"+S+"'></a>"+"<select id='"+S+"-\r\\' msallowcapture=''>"+"<option selected=''></option></select>";if(e.querySelectorAll("[msallowcapture^='']").length){g.push("[*^$]="+d+"*(?:''|\"\")")}if(!e.querySelectorAll("[selected]").length){g.push("\\["+d+"*(?:value|"+K+")")}if(!e.querySelectorAll("[id~="+S+"-]").length){g.push("~=")}t=A.createElement("input");t.setAttribute("name","");e.appendChild(t);if(!e.querySelectorAll("[name='']").length){g.push("\\["+d+"*name"+d+"*="+d+"*(?:''|\"\")")}if(!e.querySelectorAll(":checked").length){g.push(":checked")}if(!e.querySelectorAll("a#"+S+"+*").length){g.push(".#.+[+~]")}e.querySelectorAll("\\\f");g.push("[\\r\\n\\f]")});I(function(e){e.innerHTML="<a href='' disabled='disabled'></a>"+"<select disabled='disabled'><option/></select>";var t=A.createElement("input");t.setAttribute("type","hidden");e.appendChild(t).setAttribute("name","D");if(e.querySelectorAll("[name=d]").length){g.push("name"+d+"*[*^$|!~]?=")}if(e.querySelectorAll(":enabled").length!==2){g.push(":enabled",":disabled")}r.appendChild(e).disabled=true;if(e.querySelectorAll(":disabled").length!==2){g.push(":enabled",":disabled")}e.querySelectorAll("*,:x");g.push(",.*:")})}if(p.matchesSelector=D.test(a=r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.oMatchesSelector||r.msMatchesSelector)){I(function(e){p.disconnectedMatch=a.call(e,"*");a.call(e,"[s!='']:x");o.push("!=",Q)})}g=g.length&&new RegExp(g.join("|"));o=o.length&&new RegExp(o.join("|"));t=D.test(r.compareDocumentPosition);m=t||D.test(r.contains)?function(e,t){var i=e.nodeType===9?e.documentElement:e,n=t&&t.parentNode;return e===n||!!(n&&n.nodeType===1&&(i.contains?i.contains(n):e.compareDocumentPosition&&e.compareDocumentPosition(n)&16))}:function(e,t){if(t){while(t=t.parentNode){if(t===e){return true}}}return false};z=t?function(e,t){if(e===t){c=true;return 0}var i=!e.compareDocumentPosition-!t.compareDocumentPosition;if(i){return i}i=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1;if(i&1||!p.sortDetached&&t.compareDocumentPosition(e)===i){if(e==A||e.ownerDocument==u&&m(u,e)){return-1}if(t==A||t.ownerDocument==u&&m(u,t)){return 1}return l?y(l,e)-y(l,t):0}return i&4?-1:1}:function(e,t){if(e===t){c=true;return 0}var i,n=0,r=e.parentNode,s=t.parentNode,o=[e],a=[t];if(!r||!s){return e==A?-1:t==A?1:r?-1:s?1:l?y(l,e)-y(l,t):0}else if(r===s){return fe(e,t)}i=e;while(i=i.parentNode){o.unshift(i)}i=t;while(i=i.parentNode){a.unshift(i)}while(o[n]===a[n]){n++}return n?fe(o[n],a[n]):o[n]==u?-1:a[n]==u?1:0};return A};N.matches=function(e,t){return N(e,null,null,t)};N.matchesSelector=function(e,t){_(e);if(p.matchesSelector&&E&&!v[t+" "]&&(!o||!o.test(t))&&(!g||!g.test(t))){try{var i=a.call(e,t);if(i||p.disconnectedMatch||e.document&&e.document.nodeType!==11){return i}}catch(e){v(t,true)}}return N(t,A,null,[e]).length>0};N.contains=function(e,t){if((e.ownerDocument||e)!=A){_(e)}return m(e,t)};N.attr=function(e,t){if((e.ownerDocument||e)!=A){_(e)}var i=C.attrHandle[t.toLowerCase()],n=i&&j.call(C.attrHandle,t.toLowerCase())?i(e,t,!E):undefined;return n!==undefined?n:p.attributes||!E?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null};N.escape=function(e){return(e+"").replace(ce,ue)};N.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};N.uniqueSort=function(e){var t,i=[],n=0,r=0;c=!p.detectDuplicates;l=!p.sortStable&&e.slice(0);e.sort(z);if(c){while(t=e[r++]){if(t===e[r]){n=i.push(r)}}while(n--){e.splice(i[n],1)}}l=null;return e};s=N.getText=function(e){var t,i="",n=0,r=e.nodeType;if(!r){while(t=e[n++]){i+=s(t)}}else if(r===1||r===9||r===11){if(typeof e.textContent==="string"){return e.textContent}else{for(e=e.firstChild;e;e=e.nextSibling){i+=s(e)}}}else if(r===3||r===4){return e.nodeValue}return i};C=N.selectors={cacheLength:50,createPseudo:O,match:h,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[1]=e[1].replace(R,M);e[3]=(e[3]||e[4]||e[5]||"").replace(R,M);if(e[2]==="~="){e[3]=" "+e[3]+" "}return e.slice(0,4)},CHILD:function(e){e[1]=e[1].toLowerCase();if(e[1].slice(0,3)==="nth"){if(!e[3]){N.error(e[0])}e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd"));e[5]=+(e[7]+e[8]||e[3]==="odd")}else if(e[3]){N.error(e[0])}return e},PSEUDO:function(e){var t,i=!e[6]&&e[2];if(h["CHILD"].test(e[0])){return null}if(e[3]){e[2]=e[4]||e[5]||""}else if(i&&ie.test(i)&&(t=f(i,true))&&(t=i.indexOf(")",i.length-t)-i.length)){e[0]=e[0].slice(0,t);e[2]=i.slice(0,t)}return e.slice(0,3)}},filter:{TAG:function(e){var t=e.replace(R,M).toLowerCase();return e==="*"?function(){return true}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=B[e+" "];return t||(t=new RegExp("(^|"+d+")"+e+"("+d+"|$)"))&&B(e,function(e){return t.test(typeof e.className==="string"&&e.className||typeof e.getAttribute!=="undefined"&&e.getAttribute("class")||"")})},ATTR:function(i,n,r){return function(e){var t=N.attr(e,i);if(t==null){return n==="!="}if(!n){return true}t+="";return n==="="?t===r:n==="!="?t!==r:n==="^="?r&&t.indexOf(r)===0:n==="*="?r&&t.indexOf(r)>-1:n==="$="?r&&t.slice(-r.length)===r:n==="~="?(" "+t.replace(Z," ")+" ").indexOf(r)>-1:n==="|="?t===r||t.slice(0,r.length+1)===r+"-":false}},CHILD:function(f,e,t,g,m){var v=f.slice(0,3)!=="nth",y=f.slice(-4)!=="last",b=e==="of-type";return g===1&&m===0?function(e){return!!e.parentNode}:function(e,t,i){var n,r,s,o,a,l,c=v!==y?"nextSibling":"previousSibling",u=e.parentNode,d=b&&e.nodeName.toLowerCase(),h=!i&&!b,p=false;if(u){if(v){while(c){o=e;while(o=o[c]){if(b?o.nodeName.toLowerCase()===d:o.nodeType===1){return false}}l=c=f==="only"&&!l&&"nextSibling"}return true}l=[y?u.firstChild:u.lastChild];if(y&&h){o=u;s=o[S]||(o[S]={});r=s[o.uniqueID]||(s[o.uniqueID]={});n=r[f]||[];a=n[0]===T&&n[1];p=a&&n[2];o=a&&u.childNodes[a];while(o=++a&&o&&o[c]||(p=a=0)||l.pop()){if(o.nodeType===1&&++p&&o===e){r[f]=[T,a,p];break}}}else{if(h){o=e;s=o[S]||(o[S]={});r=s[o.uniqueID]||(s[o.uniqueID]={});n=r[f]||[];a=n[0]===T&&n[1];p=a}if(p===false){while(o=++a&&o&&o[c]||(p=a=0)||l.pop()){if((b?o.nodeName.toLowerCase()===d:o.nodeType===1)&&++p){if(h){s=o[S]||(o[S]={});r=s[o.uniqueID]||(s[o.uniqueID]={});r[f]=[T,p]}if(o===e){break}}}}}p-=m;return p===g||p%g===0&&p/g>=0}}},PSEUDO:function(e,s){var t,o=C.pseudos[e]||C.setFilters[e.toLowerCase()]||N.error("unsupported pseudo: "+e);if(o[S]){return o(s)}if(o.length>1){t=[e,e,"",s];return C.setFilters.hasOwnProperty(e.toLowerCase())?O(function(e,t){var i,n=o(e,s),r=n.length;while(r--){i=y(e,n[r]);e[i]=!(t[i]=n[r])}}):function(e){return o(e,0,t)}}return o}},pseudos:{not:O(function(e){var n=[],r=[],a=G(e.replace(b,"$1"));return a[S]?O(function(e,t,i,n){var r,s=a(e,null,n,[]),o=e.length;while(o--){if(r=s[o]){e[o]=!(t[o]=r)}}}):function(e,t,i){n[0]=e;a(n,null,i,r);n[0]=null;return!r.pop()}}),has:O(function(t){return function(e){return N(t,e).length>0}}),contains:O(function(t){t=t.replace(R,M);return function(e){return(e.textContent||s(e)).indexOf(t)>-1}}),lang:O(function(i){if(!ne.test(i||"")){N.error("unsupported lang: "+i)}i=i.replace(R,M).toLowerCase();return function(e){var t;do{if(t=E?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang")){t=t.toLowerCase();return t===i||t.indexOf(i+"-")===0}}while((e=e.parentNode)&&e.nodeType===1);return false}}),target:function(e){var t=L.location&&L.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===r},focus:function(e){return e===A.activeElement&&(!A.hasFocus||A.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ve(false),disabled:ve(true),checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){if(e.parentNode){e.parentNode.selectedIndex}return e.selected===true},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling){if(e.nodeType<6){return false}}return true},parent:function(e){return!C.pseudos["empty"](e)},header:function(e){return oe.test(e.nodeName)},input:function(e){return se.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()==="text")},first:P(function(){return[0]}),last:P(function(e,t){return[t-1]}),eq:P(function(e,t,i){return[i<0?i+t:i]}),even:P(function(e,t){var i=0;for(;i<t;i+=2){e.push(i)}return e}),odd:P(function(e,t){var i=1;for(;i<t;i+=2){e.push(i)}return e}),lt:P(function(e,t,i){var n=i<0?i+t:i>t?t:i;for(;--n>=0;){e.push(n)}return e}),gt:P(function(e,t,i){var n=i<0?i+t:i;for(;++n<t;){e.push(n)}return e})}};C.pseudos["nth"]=C.pseudos["eq"];for(e in{radio:true,checkbox:true,file:true,password:true,image:true}){C.pseudos[e]=ge(e)}for(e in{submit:true,reset:true}){C.pseudos[e]=me(e)}function be(){}be.prototype=C.filters=C.pseudos;C.setFilters=new be;f=N.tokenize=function(e,t){var i,n,r,s,o,a,l,c=V[e+" "];if(c){return t?0:c.slice(0)}o=e;a=[];l=C.preFilter;while(o){if(!i||(n=J.exec(o))){if(n){o=o.slice(n[0].length)||o}a.push(r=[])}i=false;if(n=ee.exec(o)){i=n.shift();r.push({value:i,type:n[0].replace(b," ")});o=o.slice(i.length)}for(s in C.filter){if((n=h[s].exec(o))&&(!l[s]||(n=l[s](n)))){i=n.shift();r.push({value:i,type:s,matches:n});o=o.slice(i.length)}}if(!i){break}}return t?o.length:o?N.error(e):V(e,a).slice(0)};function k(e){var t=0,i=e.length,n="";for(;t<i;t++){n+=e[t].value}return n}function Ce(a,e,t){var l=e.dir,c=e.next,u=c||l,d=t&&u==="parentNode",h=H++;return e.first?function(e,t,i){while(e=e[l]){if(e.nodeType===1||d){return a(e,t,i)}}return false}:function(e,t,i){var n,r,s,o=[T,h];if(i){while(e=e[l]){if(e.nodeType===1||d){if(a(e,t,i)){return true}}}}else{while(e=e[l]){if(e.nodeType===1||d){s=e[S]||(e[S]={});r=s[e.uniqueID]||(s[e.uniqueID]={});if(c&&c===e.nodeName.toLowerCase()){e=e[l]||e}else if((n=r[u])&&n[0]===T&&n[1]===h){return o[2]=n[2]}else{r[u]=o;if(o[2]=a(e,t,i)){return true}}}}}return false}}function we(r){return r.length>1?function(e,t,i){var n=r.length;while(n--){if(!r[n](e,t,i)){return false}}return true}:r[0]}function _e(e,t,i){var n=0,r=t.length;for(;n<r;n++){N(e,t[n],i)}return i}function Ae(e,t,i,n,r){var s,o=[],a=0,l=e.length,c=t!=null;for(;a<l;a++){if(s=e[a]){if(!i||i(s,n,r)){o.push(s);if(c){t.push(a)}}}}return o}function Ee(p,f,g,m,v,e){if(m&&!m[S]){m=Ee(m)}if(v&&!v[S]){v=Ee(v,e)}return O(function(e,t,i,n){var r,s,o,a=[],l=[],c=t.length,u=e||_e(f||"*",i.nodeType?[i]:i,[]),d=p&&(e||!f)?Ae(u,a,p,i,n):u,h=g?v||(e?p:c||m)?[]:t:d;if(g){g(d,h,i,n)}if(m){r=Ae(h,l);m(r,[],i,n);s=r.length;while(s--){if(o=r[s]){h[l[s]]=!(d[l[s]]=o)}}}if(e){if(v||p){if(v){r=[];s=h.length;while(s--){if(o=h[s]){r.push(d[s]=o)}}v(null,h=[],r,n)}s=h.length;while(s--){if((o=h[s])&&(r=v?y(e,o):a[s])>-1){e[r]=!(t[r]=o)}}}}else{h=Ae(h===t?h.splice(c,h.length):h);if(v){v(null,t,h,n)}else{x.apply(t,h)}}})}function Se(e){var r,t,i,n=e.length,s=C.relative[e[0].type],o=s||C.relative[" "],a=s?1:0,l=Ce(function(e){return e===r},o,true),c=Ce(function(e){return y(r,e)>-1},o,true),u=[function(e,t,i){var n=!s&&(i||t!==w)||((r=t).nodeType?l(e,t,i):c(e,t,i));r=null;return n}];for(;a<n;a++){if(t=C.relative[e[a].type]){u=[Ce(we(u),t)]}else{t=C.filter[e[a].type].apply(null,e[a].matches);if(t[S]){i=++a;for(;i<n;i++){if(C.relative[e[i].type]){break}}return Ee(a>1&&we(u),a>1&&k(e.slice(0,a-1).concat({value:e[a-2].type===" "?"*":""})).replace(b,"$1"),t,a<i&&Se(e.slice(a,i)),i<n&&Se(e=e.slice(i)),i<n&&k(e))}u.push(t)}}return we(u)}function Te(m,v){var y=v.length>0,b=m.length>0,e=function(e,t,i,n,r){var s,o,a,l=0,c="0",u=e&&[],d=[],h=w,p=e||b&&C.find["TAG"]("*",r),f=T+=h==null?1:Math.random()||.1,g=p.length;if(r){w=t==A||t||r}for(;c!==g&&(s=p[c])!=null;c++){if(b&&s){o=0;if(!t&&s.ownerDocument!=A){_(s);i=!E}while(a=m[o++]){if(a(s,t||A,i)){n.push(s);break}}if(r){T=f}}if(y){if(s=!a&&s){l--}if(e){u.push(s)}}}l+=c;if(y&&c!==l){o=0;while(a=v[o++]){a(u,d,t,i)}if(e){if(l>0){while(c--){if(!(u[c]||d[c])){d[c]=U.call(n)}}}d=Ae(d)}x.apply(n,d);if(r&&!e&&d.length>0&&l+v.length>1){N.uniqueSort(n)}}if(r){T=f;w=h}return u};return y?O(e):e}G=N.compile=function(e,t){var i,n=[],r=[],s=W[e+" "];if(!s){if(!t){t=f(e)}i=t.length;while(i--){s=Se(t[i]);if(s[S]){n.push(s)}else{r.push(s)}}s=W(e,Te(r,n));s.selector=e}return s};$=N.select=function(e,t,i,n){var r,s,o,a,l,c=typeof e==="function"&&e,u=!n&&f(e=c.selector||e);i=i||[];if(u.length===1){s=u[0]=u[0].slice(0);if(s.length>2&&(o=s[0]).type==="ID"&&t.nodeType===9&&E&&C.relative[s[1].type]){t=(C.find["ID"](o.matches[0].replace(R,M),t)||[])[0];if(!t){return i}else if(c){t=t.parentNode}e=e.slice(s.shift().value.length)}r=h["needsContext"].test(e)?0:s.length;while(r--){o=s[r];if(C.relative[a=o.type]){break}if(l=C.find[a]){if(n=l(o.matches[0].replace(R,M),le.test(s[0].type)&&ye(t.parentNode)||t)){s.splice(r,1);e=n.length&&k(s);if(!e){x.apply(i,n);return i}break}}}}(c||G(e,u))(n,t,!E,i,!t||le.test(e)&&ye(t.parentNode)||t);return i};p.sortStable=S.split("").sort(z).join("")===S;p.detectDuplicates=!!c;_();p.sortDetached=I(function(e){return e.compareDocumentPosition(A.createElement("fieldset"))&1});if(!I(function(e){e.innerHTML="<a href='#'></a>";return e.firstChild.getAttribute("href")==="#"})){pe("type|href|height|width",function(e,t,i){if(!i){return e.getAttribute(t,t.toLowerCase()==="type"?1:2)}})}if(!p.attributes||!I(function(e){e.innerHTML="<input/>";e.firstChild.setAttribute("value","");return e.firstChild.getAttribute("value")===""})){pe("value",function(e,t,i){if(!i&&e.nodeName.toLowerCase()==="input"){return e.defaultValue}})}if(!I(function(e){return e.getAttribute("disabled")==null})){pe(K,function(e,t,i){var n;if(!i){return e[t]===true?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}})}return N}(A);S.find=e;S.expr=e.selectors;S.expr[":"]=S.expr.pseudos;S.uniqueSort=S.unique=e.uniqueSort;S.text=e.getText;S.isXMLDoc=e.isXML;S.contains=e.contains;S.escapeSelector=e.escape;var n=function(e,t,i){var n=[],r=i!==undefined;while((e=e[t])&&e.nodeType!==9){if(e.nodeType===1){if(r&&S(e).is(i)){break}n.push(e)}}return n};var X=function(e,t){var i=[];for(;e;e=e.nextSibling){if(e.nodeType===1&&e!==t){i.push(e)}}return i};var Q=S.expr.match.needsContext;function c(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var Z=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function J(e,i,n){if(m(i)){return S.grep(e,function(e,t){return!!i.call(e,t,e)!==n})}if(i.nodeType){return S.grep(e,function(e){return e===i!==n})}if(typeof i!=="string"){return S.grep(e,function(e){return H.call(i,e)>-1!==n})}return S.filter(i,e,n)}S.filter=function(e,t,i){var n=t[0];if(i){e=":not("+e+")"}if(t.length===1&&n.nodeType===1){return S.find.matchesSelector(n,e)?[n]:[]}return S.find.matches(e,S.grep(t,function(e){return e.nodeType===1}))};S.fn.extend({find:function(e){var t,i,n=this.length,r=this;if(typeof e!=="string"){return this.pushStack(S(e).filter(function(){for(t=0;t<n;t++){if(S.contains(r[t],this)){return true}}}))}i=this.pushStack([]);for(t=0;t<n;t++){S.find(e,r[t],i)}return n>1?S.uniqueSort(i):i},filter:function(e){return this.pushStack(J(this,e||[],false))},not:function(e){return this.pushStack(J(this,e||[],true))},is:function(e){return!!J(this,typeof e==="string"&&Q.test(e)?S(e):e||[],false).length}});var ee,te=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,ie=S.fn.init=function(e,t,i){var n,r;if(!e){return this}i=i||ee;if(typeof e==="string"){if(e[0]==="<"&&e[e.length-1]===">"&&e.length>=3){n=[null,e,null]}else{n=te.exec(e)}if(n&&(n[1]||!t)){if(n[1]){t=t instanceof S?t[0]:t;S.merge(this,S.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:E,true));if(Z.test(n[1])&&S.isPlainObject(t)){for(n in t){if(m(this[n])){this[n](t[n])}else{this.attr(n,t[n])}}}return this}else{r=E.getElementById(n[2]);if(r){this[0]=r;this.length=1}return this}}else if(!t||t.jquery){return(t||i).find(e)}else{return this.constructor(t).find(e)}}else if(e.nodeType){this[0]=e;this.length=1;return this}else if(m(e)){return i.ready!==undefined?i.ready(e):e(S)}return S.makeArray(e,this)};ie.prototype=S.fn;ee=S(E);var ne=/^(?:parents|prev(?:Until|All))/,re={children:true,contents:true,next:true,prev:true};S.fn.extend({has:function(e){var t=S(e,this),i=t.length;return this.filter(function(){var e=0;for(;e<i;e++){if(S.contains(this,t[e])){return true}}})},closest:function(e,t){var i,n=0,r=this.length,s=[],o=typeof e!=="string"&&S(e);if(!Q.test(e)){for(;n<r;n++){for(i=this[n];i&&i!==t;i=i.parentNode){if(i.nodeType<11&&(o?o.index(i)>-1:i.nodeType===1&&S.find.matchesSelector(i,e))){s.push(i);break}}}}return this.pushStack(s.length>1?S.uniqueSort(s):s)},index:function(e){if(!e){return this[0]&&this[0].parentNode?this.first().prevAll().length:-1}if(typeof e==="string"){return H.call(S(e),this[0])}return H.call(this,e.jquery?e[0]:e)},add:function(e,t){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(e,t))))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}});function se(e,t){while((e=e[t])&&e.nodeType!==1){}return e}S.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return n(e,"parentNode")},parentsUntil:function(e,t,i){return n(e,"parentNode",i)},next:function(e){return se(e,"nextSibling")},prev:function(e){return se(e,"previousSibling")},nextAll:function(e){return n(e,"nextSibling")},prevAll:function(e){return n(e,"previousSibling")},nextUntil:function(e,t,i){return n(e,"nextSibling",i)},prevUntil:function(e,t,i){return n(e,"previousSibling",i)},siblings:function(e){return X((e.parentNode||{}).firstChild,e)},children:function(e){return X(e.firstChild)},contents:function(e){if(e.contentDocument!=null&&F(e.contentDocument)){return e.contentDocument}if(c(e,"template")){e=e.content||e}return S.merge([],e.childNodes)}},function(n,r){S.fn[n]=function(e,t){var i=S.map(this,r,e);if(n.slice(-5)!=="Until"){t=e}if(t&&typeof t==="string"){i=S.filter(t,i)}if(this.length>1){if(!re[n]){S.uniqueSort(i)}if(ne.test(n)){i.reverse()}}return this.pushStack(i)}});var T=/[^\x20\t\r\n\f]+/g;function oe(e){var i={};S.each(e.match(T)||[],function(e,t){i[t]=true});return i}S.Callbacks=function(n){n=typeof n==="string"?oe(n):S.extend({},n);var i,e,t,r,s=[],o=[],a=-1,l=function(){r=r||n.once;t=i=true;for(;o.length;a=-1){e=o.shift();while(++a<s.length){if(s[a].apply(e[0],e[1])===false&&n.stopOnFalse){a=s.length;e=false}}}if(!n.memory){e=false}i=false;if(r){if(e){s=[]}else{s=""}}},c={add:function(){if(s){if(e&&!i){a=s.length-1;o.push(e)}(function i(e){S.each(e,function(e,t){if(m(t)){if(!n.unique||!c.has(t)){s.push(t)}}else if(t&&t.length&&y(t)!=="string"){i(t)}})})(arguments);if(e&&!i){l()}}return this},remove:function(){S.each(arguments,function(e,t){var i;while((i=S.inArray(t,s,i))>-1){s.splice(i,1);if(i<=a){a--}}});return this},has:function(e){return e?S.inArray(e,s)>-1:s.length>0},empty:function(){if(s){s=[]}return this},disable:function(){r=o=[];s=e="";return this},disabled:function(){return!s},lock:function(){r=o=[];if(!e&&!i){s=e=""}return this},locked:function(){return!!r},fireWith:function(e,t){if(!r){t=t||[];t=[e,t.slice?t.slice():t];o.push(t);if(!i){l()}}return this},fire:function(){c.fireWith(this,arguments);return this},fired:function(){return!!t}};return c};function u(e){return e}function ae(e){throw e}function le(e,t,i,n){var r;try{if(e&&m(r=e.promise)){r.call(e).done(t).fail(i)}else if(e&&m(r=e.then)){r.call(e,t,i)}else{t.apply(undefined,[e].slice(n))}}catch(e){i.apply(undefined,[e])}}S.extend({Deferred:function(e){var s=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],r="pending",o={state:function(){return r},always:function(){a.done(arguments).fail(arguments);return this},catch:function(e){return o.then(null,e)},pipe:function(){var r=arguments;return S.Deferred(function(n){S.each(s,function(e,t){var i=m(r[t[4]])&&r[t[4]];a[t[1]](function(){var e=i&&i.apply(this,arguments);if(e&&m(e.promise)){e.promise().progress(n.notify).done(n.resolve).fail(n.reject)}else{n[t[0]+"With"](this,i?[e]:arguments)}})});r=null}).promise()},then:function(t,i,n){var l=0;function c(r,s,o,a){return function(){var i=this,n=arguments,e=function(){var e,t;if(r<l){return}e=o.apply(i,n);if(e===s.promise()){throw new TypeError("Thenable self-resolution")}t=e&&(typeof e==="object"||typeof e==="function")&&e.then;if(m(t)){if(a){t.call(e,c(l,s,u,a),c(l,s,ae,a))}else{l++;t.call(e,c(l,s,u,a),c(l,s,ae,a),c(l,s,u,s.notifyWith))}}else{if(o!==u){i=undefined;n=[e]}(a||s.resolveWith)(i,n)}},t=a?e:function(){try{e()}catch(e){if(S.Deferred.exceptionHook){S.Deferred.exceptionHook(e,t.stackTrace)}if(r+1>=l){if(o!==ae){i=undefined;n=[e]}s.rejectWith(i,n)}}};if(r){t()}else{if(S.Deferred.getStackHook){t.stackTrace=S.Deferred.getStackHook()}A.setTimeout(t)}}}return S.Deferred(function(e){s[0][3].add(c(0,e,m(n)?n:u,e.notifyWith));s[1][3].add(c(0,e,m(t)?t:u));s[2][3].add(c(0,e,m(i)?i:ae))}).promise()},promise:function(e){return e!=null?S.extend(e,o):o}},a={};S.each(s,function(e,t){var i=t[2],n=t[5];o[t[1]]=i.add;if(n){i.add(function(){r=n},s[3-e][2].disable,s[3-e][3].disable,s[0][2].lock,s[0][3].lock)}i.add(t[3].fire);a[t[0]]=function(){a[t[0]+"With"](this===a?undefined:this,arguments);return this};a[t[0]+"With"]=i.fireWith});o.promise(a);if(e){e.call(a,a)}return a},when:function(e){var i=arguments.length,t=i,n=Array(t),r=a.call(arguments),s=S.Deferred(),o=function(t){return function(e){n[t]=this;r[t]=arguments.length>1?a.call(arguments):e;if(!--i){s.resolveWith(n,r)}}};if(i<=1){le(e,s.done(o(t)).resolve,s.reject,!i);if(s.state()==="pending"||m(r[t]&&r[t].then)){return s.then()}}while(t--){le(r[t],o(t),s.reject)}return s.promise()}});var ce=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(e,t){if(A.console&&A.console.warn&&e&&ce.test(e.name)){A.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)}};S.readyException=function(e){A.setTimeout(function(){throw e})};var ue=S.Deferred();S.fn.ready=function(e){ue.then(e).catch(function(e){S.readyException(e)});return this};S.extend({isReady:false,readyWait:1,ready:function(e){if(e===true?--S.readyWait:S.isReady){return}S.isReady=true;if(e!==true&&--S.readyWait>0){return}ue.resolveWith(E,[S])}});S.ready.then=ue.then;function de(){E.removeEventListener("DOMContentLoaded",de);A.removeEventListener("load",de);S.ready()}if(E.readyState==="complete"||E.readyState!=="loading"&&!E.documentElement.doScroll){A.setTimeout(S.ready)}else{E.addEventListener("DOMContentLoaded",de);A.addEventListener("load",de)}var d=function(e,t,i,n,r,s,o){var a=0,l=e.length,c=i==null;if(y(i)==="object"){r=true;for(a in i){d(e,t,a,i[a],true,s,o)}}else if(n!==undefined){r=true;if(!m(n)){o=true}if(c){if(o){t.call(e,n);t=null}else{c=t;t=function(e,t,i){return c.call(S(e),i)}}}if(t){for(;a<l;a++){t(e[a],i,o?n:n.call(e[a],a,t(e[a],i)))}}}if(r){return e}if(c){return t.call(e)}return l?t(e[0],i):s};var he=/^-ms-/,pe=/-([a-z])/g;function fe(e,t){return t.toUpperCase()}function h(e){return e.replace(he,"ms-").replace(pe,fe)}var b=function(e){return e.nodeType===1||e.nodeType===9||!+e.nodeType};function i(){this.expando=S.expando+i.uid++}i.uid=1;i.prototype={cache:function(e){var t=e[this.expando];if(!t){t={};if(b(e)){if(e.nodeType){e[this.expando]=t}else{Object.defineProperty(e,this.expando,{value:t,configurable:true})}}}return t},set:function(e,t,i){var n,r=this.cache(e);if(typeof t==="string"){r[h(t)]=i}else{for(n in t){r[h(n)]=t[n]}}return r},get:function(e,t){return t===undefined?this.cache(e):e[this.expando]&&e[this.expando][h(t)]},access:function(e,t,i){if(t===undefined||t&&typeof t==="string"&&i===undefined){return this.get(e,t)}this.set(e,t,i);return i!==undefined?i:t},remove:function(e,t){var i,n=e[this.expando];if(n===undefined){return}if(t!==undefined){if(Array.isArray(t)){t=t.map(h)}else{t=h(t);t=t in n?[t]:t.match(T)||[]}i=t.length;while(i--){delete n[t[i]]}}if(t===undefined||S.isEmptyObject(n)){if(e.nodeType){e[this.expando]=undefined}else{delete e[this.expando]}}},hasData:function(e){var t=e[this.expando];return t!==undefined&&!S.isEmptyObject(t)}};var C=new i;var p=new i;var ge=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,me=/[A-Z]/g;function ve(e){if(e==="true"){return true}if(e==="false"){return false}if(e==="null"){return null}if(e===+e+""){return+e}if(ge.test(e)){return JSON.parse(e)}return e}function ye(e,t,i){var n;if(i===undefined&&e.nodeType===1){n="data-"+t.replace(me,"-$&").toLowerCase();i=e.getAttribute(n);if(typeof i==="string"){try{i=ve(i)}catch(e){}p.set(e,t,i)}else{i=undefined}}return i}S.extend({hasData:function(e){return p.hasData(e)||C.hasData(e)},data:function(e,t,i){return p.access(e,t,i)},removeData:function(e,t){p.remove(e,t)},_data:function(e,t,i){return C.access(e,t,i)},_removeData:function(e,t){C.remove(e,t)}});S.fn.extend({data:function(i,e){var t,n,r,s=this[0],o=s&&s.attributes;if(i===undefined){if(this.length){r=p.get(s);if(s.nodeType===1&&!C.get(s,"hasDataAttrs")){t=o.length;while(t--){if(o[t]){n=o[t].name;if(n.indexOf("data-")===0){n=h(n.slice(5));ye(s,n,r[n])}}}C.set(s,"hasDataAttrs",true)}}return r}if(typeof i==="object"){return this.each(function(){p.set(this,i)})}return d(this,function(e){var t;if(s&&e===undefined){t=p.get(s,i);if(t!==undefined){return t}t=ye(s,i);if(t!==undefined){return t}return}this.each(function(){p.set(this,i,e)})},null,e,arguments.length>1,null,true)},removeData:function(e){return this.each(function(){p.remove(this,e)})}});S.extend({queue:function(e,t,i){var n;if(e){t=(t||"fx")+"queue";n=C.get(e,t);if(i){if(!n||Array.isArray(i)){n=C.access(e,t,S.makeArray(i))}else{n.push(i)}}return n||[]}},dequeue:function(e,t){t=t||"fx";var i=S.queue(e,t),n=i.length,r=i.shift(),s=S._queueHooks(e,t),o=function(){S.dequeue(e,t)};if(r==="inprogress"){r=i.shift();n--}if(r){if(t==="fx"){i.unshift("inprogress")}delete s.stop;r.call(e,o,s)}if(!n&&s){s.empty.fire()}},_queueHooks:function(e,t){var i=t+"queueHooks";return C.get(e,i)||C.access(e,i,{empty:S.Callbacks("once memory").add(function(){C.remove(e,[t+"queue",i])})})}});S.fn.extend({queue:function(t,i){var e=2;if(typeof t!=="string"){i=t;t="fx";e--}if(arguments.length<e){return S.queue(this[0],t)}return i===undefined?this:this.each(function(){var e=S.queue(this,t,i);S._queueHooks(this,t);if(t==="fx"&&e[0]!=="inprogress"){S.dequeue(this,t)}})},dequeue:function(e){return this.each(function(){S.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,r=S.Deferred(),s=this,o=this.length,a=function(){if(!--n){r.resolveWith(s,[s])}};if(typeof e!=="string"){t=e;e=undefined}e=e||"fx";while(o--){i=C.get(s[o],e+"queueHooks");if(i&&i.empty){n++;i.empty.add(a)}}a();return r.promise(t)}});var be=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;var f=new RegExp("^(?:([+-])=|)("+be+")([a-z%]*)$","i");var w=["Top","Right","Bottom","Left"];var _=E.documentElement;var x=function(e){return S.contains(e.ownerDocument,e)},Ce={composed:true};if(_.getRootNode){x=function(e){return S.contains(e.ownerDocument,e)||e.getRootNode(Ce)===e.ownerDocument}}var we=function(e,t){e=t||e;return e.style.display==="none"||e.style.display===""&&x(e)&&S.css(e,"display")==="none"};function _e(e,t,i,n){var r,s,o=20,a=n?function(){return n.cur()}:function(){return S.css(e,t,"")},l=a(),c=i&&i[3]||(S.cssNumber[t]?"":"px"),u=e.nodeType&&(S.cssNumber[t]||c!=="px"&&+l)&&f.exec(S.css(e,t));if(u&&u[3]!==c){l=l/2;c=c||u[3];u=+l||1;while(o--){S.style(e,t,u+c);if((1-s)*(1-(s=a()/l||.5))<=0){o=0}u=u/s}u=u*2;S.style(e,t,u+c);i=i||[]}if(i){u=+u||+l||0;r=i[1]?u+(i[1]+1)*i[2]:+i[2];if(n){n.unit=c;n.start=u;n.end=r}}return r}var Ae={};function Ee(e){var t,i=e.ownerDocument,n=e.nodeName,r=Ae[n];if(r){return r}t=i.body.appendChild(i.createElement(n));r=S.css(t,"display");t.parentNode.removeChild(t);if(r==="none"){r="block"}Ae[n]=r;return r}function D(e,t){var i,n,r=[],s=0,o=e.length;for(;s<o;s++){n=e[s];if(!n.style){continue}i=n.style.display;if(t){if(i==="none"){r[s]=C.get(n,"display")||null;if(!r[s]){n.style.display=""}}if(n.style.display===""&&we(n)){r[s]=Ee(n)}}else{if(i!=="none"){r[s]="none";C.set(n,"display",i)}}}for(s=0;s<o;s++){if(r[s]!=null){e[s].style.display=r[s]}}return e}S.fn.extend({show:function(){return D(this,true)},hide:function(){return D(this)},toggle:function(e){if(typeof e==="boolean"){return e?this.show():this.hide()}return this.each(function(){if(we(this)){S(this).show()}else{S(this).hide()}})}});var r=/^(?:checkbox|radio)$/i;var Se=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i;var Te=/^$|^module$|\/(?:java|ecma)script/i;(function(){var e=E.createDocumentFragment(),t=e.appendChild(E.createElement("div")),i=E.createElement("input");i.setAttribute("type","radio");i.setAttribute("checked","checked");i.setAttribute("name","t");t.appendChild(i);g.checkClone=t.cloneNode(true).cloneNode(true).lastChild.checked;t.innerHTML="<textarea>x</textarea>";g.noCloneChecked=!!t.cloneNode(true).lastChild.defaultValue;t.innerHTML="<option></option>";g.option=!!t.lastChild})();var R={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};R.tbody=R.tfoot=R.colgroup=R.caption=R.thead;R.th=R.td;if(!g.option){R.optgroup=R.option=[1,"<select multiple='multiple'>","</select>"]}function M(e,t){var i;if(typeof e.getElementsByTagName!=="undefined"){i=e.getElementsByTagName(t||"*")}else if(typeof e.querySelectorAll!=="undefined"){i=e.querySelectorAll(t||"*")}else{i=[]}if(t===undefined||t&&c(e,t)){return S.merge([e],i)}return i}function xe(e,t){var i=0,n=e.length;for(;i<n;i++){C.set(e[i],"globalEval",!t||C.get(t[i],"globalEval"))}}var De=/<|&#?\w+;/;function Re(e,t,i,n,r){var s,o,a,l,c,u,d=t.createDocumentFragment(),h=[],p=0,f=e.length;for(;p<f;p++){s=e[p];if(s||s===0){if(y(s)==="object"){S.merge(h,s.nodeType?[s]:s)}else if(!De.test(s)){h.push(t.createTextNode(s))}else{o=o||d.appendChild(t.createElement("div"));a=(Se.exec(s)||["",""])[1].toLowerCase();l=R[a]||R._default;o.innerHTML=l[1]+S.htmlPrefilter(s)+l[2];u=l[0];while(u--){o=o.lastChild}S.merge(h,o.childNodes);o=d.firstChild;o.textContent=""}}}d.textContent="";p=0;while(s=h[p++]){if(n&&S.inArray(s,n)>-1){if(r){r.push(s)}continue}c=x(s);o=M(d.appendChild(s),"script");if(c){xe(o)}if(i){u=0;while(s=o[u++]){if(Te.test(s.type||"")){i.push(s)}}}}return d}var Me=/^key/,Ne=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Oe=/^([^.]*)(?:\.(.+)|)/;function o(){return true}function l(){return false}function Ie(e,t){return e===Pe()===(t==="focus")}function Pe(){try{return E.activeElement}catch(e){}}function ke(e,t,i,n,r,s){var o,a;if(typeof t==="object"){if(typeof i!=="string"){n=n||i;i=undefined}for(a in t){ke(e,a,i,n,t[a],s)}return e}if(n==null&&r==null){r=i;n=i=undefined}else if(r==null){if(typeof i==="string"){r=n;n=undefined}else{r=n;n=i;i=undefined}}if(r===false){r=l}else if(!r){return e}if(s===1){o=r;r=function(e){S().off(e);return o.apply(this,arguments)};r.guid=o.guid||(o.guid=S.guid++)}return e.each(function(){S.event.add(this,t,r,n,i)})}S.event={global:{},add:function(t,e,i,n,r){var s,o,a,l,c,u,d,h,p,f,g,m=C.get(t);if(!b(t)){return}if(i.handler){s=i;i=s.handler;r=s.selector}if(r){S.find.matchesSelector(_,r)}if(!i.guid){i.guid=S.guid++}if(!(l=m.events)){l=m.events=Object.create(null)}if(!(o=m.handle)){o=m.handle=function(e){return typeof S!=="undefined"&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):undefined}}e=(e||"").match(T)||[""];c=e.length;while(c--){a=Oe.exec(e[c])||[];p=g=a[1];f=(a[2]||"").split(".").sort();if(!p){continue}d=S.event.special[p]||{};p=(r?d.delegateType:d.bindType)||p;d=S.event.special[p]||{};u=S.extend({type:p,origType:g,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&S.expr.match.needsContext.test(r),namespace:f.join(".")},s);if(!(h=l[p])){h=l[p]=[];h.delegateCount=0;if(!d.setup||d.setup.call(t,n,f,o)===false){if(t.addEventListener){t.addEventListener(p,o)}}}if(d.add){d.add.call(t,u);if(!u.handler.guid){u.handler.guid=i.guid}}if(r){h.splice(h.delegateCount++,0,u)}else{h.push(u)}S.event.global[p]=true}},remove:function(e,t,i,n,r){var s,o,a,l,c,u,d,h,p,f,g,m=C.hasData(e)&&C.get(e);if(!m||!(l=m.events)){return}t=(t||"").match(T)||[""];c=t.length;while(c--){a=Oe.exec(t[c])||[];p=g=a[1];f=(a[2]||"").split(".").sort();if(!p){for(p in l){S.event.remove(e,p+t[c],i,n,true)}continue}d=S.event.special[p]||{};p=(n?d.delegateType:d.bindType)||p;h=l[p]||[];a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)");o=s=h.length;while(s--){u=h[s];if((r||g===u.origType)&&(!i||i.guid===u.guid)&&(!a||a.test(u.namespace))&&(!n||n===u.selector||n==="**"&&u.selector)){h.splice(s,1);if(u.selector){h.delegateCount--}if(d.remove){d.remove.call(e,u)}}}if(o&&!h.length){if(!d.teardown||d.teardown.call(e,f,m.handle)===false){S.removeEvent(e,p,m.handle)}delete l[p]}}if(S.isEmptyObject(l)){C.remove(e,"handle events")}},dispatch:function(e){var t,i,n,r,s,o,a=new Array(arguments.length),l=S.event.fix(e),c=(C.get(this,"events")||Object.create(null))[l.type]||[],u=S.event.special[l.type]||{};a[0]=l;for(t=1;t<arguments.length;t++){a[t]=arguments[t]}l.delegateTarget=this;if(u.preDispatch&&u.preDispatch.call(this,l)===false){return}o=S.event.handlers.call(this,l,c);t=0;while((r=o[t++])&&!l.isPropagationStopped()){l.currentTarget=r.elem;i=0;while((s=r.handlers[i++])&&!l.isImmediatePropagationStopped()){if(!l.rnamespace||s.namespace===false||l.rnamespace.test(s.namespace)){l.handleObj=s;l.data=s.data;n=((S.event.special[s.origType]||{}).handle||s.handler).apply(r.elem,a);if(n!==undefined){if((l.result=n)===false){l.preventDefault();l.stopPropagation()}}}}}if(u.postDispatch){u.postDispatch.call(this,l)}return l.result},handlers:function(e,t){var i,n,r,s,o,a=[],l=t.delegateCount,c=e.target;if(l&&c.nodeType&&!(e.type==="click"&&e.button>=1)){for(;c!==this;c=c.parentNode||this){if(c.nodeType===1&&!(e.type==="click"&&c.disabled===true)){s=[];o={};for(i=0;i<l;i++){n=t[i];r=n.selector+" ";if(o[r]===undefined){o[r]=n.needsContext?S(r,this).index(c)>-1:S.find(r,this,null,[c]).length}if(o[r]){s.push(n)}}if(s.length){a.push({elem:c,handlers:s})}}}}c=this;if(l<t.length){a.push({elem:c,handlers:t.slice(l)})}return a},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:true,configurable:true,get:m(e)?function(){if(this.originalEvent){return e(this.originalEvent)}}:function(){if(this.originalEvent){return this.originalEvent[t]}},set:function(e){Object.defineProperty(this,t,{enumerable:true,configurable:true,writable:true,value:e})}})},fix:function(e){return e[S.expando]?e:new S.Event(e)},special:{load:{noBubble:true},click:{setup:function(e){var t=this||e;if(r.test(t.type)&&t.click&&c(t,"input")){Le(t,"click",o)}return false},trigger:function(e){var t=this||e;if(r.test(t.type)&&t.click&&c(t,"input")){Le(t,"click")}return true},_default:function(e){var t=e.target;return r.test(t.type)&&t.click&&c(t,"input")&&C.get(t,"click")||c(t,"a")}},beforeunload:{postDispatch:function(e){if(e.result!==undefined&&e.originalEvent){e.originalEvent.returnValue=e.result}}}}};function Le(e,r,s){if(!s){if(C.get(e,r)===undefined){S.event.add(e,r,o)}return}C.set(e,r,false);S.event.add(e,r,{namespace:false,handler:function(e){var t,i,n=C.get(this,r);if(e.isTrigger&1&&this[r]){if(!n.length){n=a.call(arguments);C.set(this,r,n);t=s(this,r);this[r]();i=C.get(this,r);if(n!==i||t){C.set(this,r,false)}else{i={}}if(n!==i){e.stopImmediatePropagation();e.preventDefault();return i.value}}else if((S.event.special[r]||{}).delegateType){e.stopPropagation()}}else if(n.length){C.set(this,r,{value:S.event.trigger(S.extend(n[0],S.Event.prototype),n.slice(1),this)});e.stopImmediatePropagation()}}})}S.removeEvent=function(e,t,i){if(e.removeEventListener){e.removeEventListener(t,i)}};S.Event=function(e,t){if(!(this instanceof S.Event)){return new S.Event(e,t)}if(e&&e.type){this.originalEvent=e;this.type=e.type;this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===undefined&&e.returnValue===false?o:l;this.target=e.target&&e.target.nodeType===3?e.target.parentNode:e.target;this.currentTarget=e.currentTarget;this.relatedTarget=e.relatedTarget}else{this.type=e}if(t){S.extend(this,t)}this.timeStamp=e&&e.timeStamp||Date.now();this[S.expando]=true};S.Event.prototype={constructor:S.Event,isDefaultPrevented:l,isPropagationStopped:l,isImmediatePropagationStopped:l,isSimulated:false,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=o;if(e&&!this.isSimulated){e.preventDefault()}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=o;if(e&&!this.isSimulated){e.stopPropagation()}},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=o;if(e&&!this.isSimulated){e.stopImmediatePropagation()}this.stopPropagation()}};S.each({altKey:true,bubbles:true,cancelable:true,changedTouches:true,ctrlKey:true,detail:true,eventPhase:true,metaKey:true,pageX:true,pageY:true,shiftKey:true,view:true,char:true,code:true,charCode:true,key:true,keyCode:true,button:true,buttons:true,clientX:true,clientY:true,offsetX:true,offsetY:true,pointerId:true,pointerType:true,screenX:true,screenY:true,targetTouches:true,toElement:true,touches:true,which:function(e){var t=e.button;if(e.which==null&&Me.test(e.type)){return e.charCode!=null?e.charCode:e.keyCode}if(!e.which&&t!==undefined&&Ne.test(e.type)){if(t&1){return 1}if(t&2){return 3}if(t&4){return 2}return 0}return e.which}},S.event.addProp);S.each({focus:"focusin",blur:"focusout"},function(e,t){S.event.special[e]={setup:function(){Le(this,e,Ie);return false},trigger:function(){Le(this,e);return true},delegateType:t}});S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,s){S.event.special[e]={delegateType:s,bindType:s,handle:function(e){var t,i=this,n=e.relatedTarget,r=e.handleObj;if(!n||n!==i&&!S.contains(i,n)){e.type=r.origType;t=r.handler.apply(this,arguments);e.type=s}return t}}});S.fn.extend({on:function(e,t,i,n){return ke(this,e,t,i,n)},one:function(e,t,i,n){return ke(this,e,t,i,n,1)},off:function(e,t,i){var n,r;if(e&&e.preventDefault&&e.handleObj){n=e.handleObj;S(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler);return this}if(typeof e==="object"){for(r in e){this.off(r,t,e[r])}return this}if(t===false||typeof t==="function"){i=t;t=undefined}if(i===false){i=l}return this.each(function(){S.event.remove(this,e,i,t)})}});var Fe=/<script|<style|<link/i,Ge=/checked\s*(?:[^=]|=\s*.checked.)/i,$e=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function He(e,t){if(c(e,"table")&&c(t.nodeType!==11?t:t.firstChild,"tr")){return S(e).children("tbody")[0]||e}return e}function Be(e){e.type=(e.getAttribute("type")!==null)+"/"+e.type;return e}function Ve(e){if((e.type||"").slice(0,5)==="true/"){e.type=e.type.slice(5)}else{e.removeAttribute("type")}return e}function We(e,t){var i,n,r,s,o,a,l;if(t.nodeType!==1){return}if(C.hasData(e)){s=C.get(e);l=s.events;if(l){C.remove(t,"handle events");for(r in l){for(i=0,n=l[r].length;i<n;i++){S.event.add(t,r,l[r][i])}}}}if(p.hasData(e)){o=p.access(e);a=S.extend({},o);p.set(t,a)}}function ze(e,t){var i=t.nodeName.toLowerCase();if(i==="input"&&r.test(e.type)){t.checked=e.checked}else if(i==="input"||i==="textarea"){t.defaultValue=e.defaultValue}}function N(i,n,r,s){n=G(n);var e,t,o,a,l,c,u=0,d=i.length,h=d-1,p=n[0],f=m(p);if(f||d>1&&typeof p==="string"&&!g.checkClone&&Ge.test(p)){return i.each(function(e){var t=i.eq(e);if(f){n[0]=p.call(this,e,t.html())}N(t,n,r,s)})}if(d){e=Re(n,i[0].ownerDocument,false,i,s);t=e.firstChild;if(e.childNodes.length===1){e=t}if(t||s){o=S.map(M(e,"script"),Be);a=o.length;for(;u<d;u++){l=e;if(u!==h){l=S.clone(l,true,true);if(a){S.merge(o,M(l,"script"))}}r.call(i[u],l,u)}if(a){c=o[o.length-1].ownerDocument;S.map(o,Ve);for(u=0;u<a;u++){l=o[u];if(Te.test(l.type||"")&&!C.access(l,"globalEval")&&S.contains(c,l)){if(l.src&&(l.type||"").toLowerCase()!=="module"){if(S._evalUrl&&!l.noModule){S._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},c)}}else{Y(l.textContent.replace($e,""),l,c)}}}}}}return i}function je(e,t,i){var n,r=t?S.filter(t,e):e,s=0;for(;(n=r[s])!=null;s++){if(!i&&n.nodeType===1){S.cleanData(M(n))}if(n.parentNode){if(i&&x(n)){xe(M(n,"script"))}n.parentNode.removeChild(n)}}return e}S.extend({htmlPrefilter:function(e){return e},clone:function(e,t,i){var n,r,s,o,a=e.cloneNode(true),l=x(e);if(!g.noCloneChecked&&(e.nodeType===1||e.nodeType===11)&&!S.isXMLDoc(e)){o=M(a);s=M(e);for(n=0,r=s.length;n<r;n++){ze(s[n],o[n])}}if(t){if(i){s=s||M(e);o=o||M(a);for(n=0,r=s.length;n<r;n++){We(s[n],o[n])}}else{We(e,a)}}o=M(a,"script");if(o.length>0){xe(o,!l&&M(e,"script"))}return a},cleanData:function(e){var t,i,n,r=S.event.special,s=0;for(;(i=e[s])!==undefined;s++){if(b(i)){if(t=i[C.expando]){if(t.events){for(n in t.events){if(r[n]){S.event.remove(i,n)}else{S.removeEvent(i,n,t.handle)}}}i[C.expando]=undefined}if(i[p.expando]){i[p.expando]=undefined}}}}});S.fn.extend({detach:function(e){return je(this,e,true)},remove:function(e){return je(this,e)},text:function(e){return d(this,function(e){return e===undefined?S.text(this):this.empty().each(function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){this.textContent=e}})},null,e,arguments.length)},append:function(){return N(this,arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=He(this,e);t.appendChild(e)}})},prepend:function(){return N(this,arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=He(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return N(this,arguments,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this)}})},after:function(){return N(this,arguments,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this.nextSibling)}})},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){if(e.nodeType===1){S.cleanData(M(e,false));e.textContent=""}}return this},clone:function(e,t){e=e==null?false:e;t=t==null?e:t;return this.map(function(){return S.clone(this,e,t)})},html:function(e){return d(this,function(e){var t=this[0]||{},i=0,n=this.length;if(e===undefined&&t.nodeType===1){return t.innerHTML}if(typeof e==="string"&&!Fe.test(e)&&!R[(Se.exec(e)||["",""])[1].toLowerCase()]){e=S.htmlPrefilter(e);try{for(;i<n;i++){t=this[i]||{};if(t.nodeType===1){S.cleanData(M(t,false));t.innerHTML=e}}t=0}catch(e){}}if(t){this.empty().append(e)}},null,e,arguments.length)},replaceWith:function(){var i=[];return N(this,arguments,function(e){var t=this.parentNode;if(S.inArray(this,i)<0){S.cleanData(M(this));if(t){t.replaceChild(e,this)}}},i)}});S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,o){S.fn[e]=function(e){var t,i=[],n=S(e),r=n.length-1,s=0;for(;s<=r;s++){t=s===r?this:this.clone(true);S(n[s])[o](t);$.apply(i,t.get())}return this.pushStack(i)}});var Ue=new RegExp("^("+be+")(?!px)[a-z%]+$","i");var Ye=function(e){var t=e.ownerDocument.defaultView;if(!t||!t.opener){t=A}return t.getComputedStyle(e)};var qe=function(e,t,i){var n,r,s={};for(r in t){s[r]=e.style[r];e.style[r]=t[r]}n=i.call(e);for(r in t){e.style[r]=s[r]}return n};var Ke=new RegExp(w.join("|"),"i");(function(){function e(){if(!c){return}l.style.cssText="position:absolute;left:-11111px;width:60px;"+"margin-top:1px;padding:0;border:0";c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;"+"margin:auto;border:1px;padding:1px;"+"width:60%;top:1%";_.appendChild(l).appendChild(c);var e=A.getComputedStyle(c);i=e.top!=="1%";a=t(e.marginLeft)===12;c.style.right="60%";s=t(e.right)===36;n=t(e.width)===36;c.style.position="absolute";r=t(c.offsetWidth/3)===12;_.removeChild(l);c=null}function t(e){return Math.round(parseFloat(e))}var i,n,r,s,o,a,l=E.createElement("div"),c=E.createElement("div");if(!c.style){return}c.style.backgroundClip="content-box";c.cloneNode(true).style.backgroundClip="";g.clearCloneStyle=c.style.backgroundClip==="content-box";S.extend(g,{boxSizingReliable:function(){e();return n},pixelBoxStyles:function(){e();return s},pixelPosition:function(){e();return i},reliableMarginLeft:function(){e();return a},scrollboxSize:function(){e();return r},reliableTrDimensions:function(){var e,t,i,n;if(o==null){e=E.createElement("table");t=E.createElement("tr");i=E.createElement("div");e.style.cssText="position:absolute;left:-11111px";t.style.height="1px";i.style.height="9px";_.appendChild(e).appendChild(t).appendChild(i);n=A.getComputedStyle(t);o=parseInt(n.height)>3;_.removeChild(e)}return o}})})();function Xe(e,t,i){var n,r,s,o,a=e.style;i=i||Ye(e);if(i){o=i.getPropertyValue(t)||i[t];if(o===""&&!x(e)){o=S.style(e,t)}if(!g.pixelBoxStyles()&&Ue.test(o)&&Ke.test(t)){n=a.width;r=a.minWidth;s=a.maxWidth;a.minWidth=a.maxWidth=a.width=o;o=i.width;a.width=n;a.minWidth=r;a.maxWidth=s}}return o!==undefined?o+"":o}function Qe(e,t){return{get:function(){if(e()){delete this.get;return}return(this.get=t).apply(this,arguments)}}}var Ze=["Webkit","Moz","ms"],Je=E.createElement("div").style,et={};function tt(e){var t=e[0].toUpperCase()+e.slice(1),i=Ze.length;while(i--){e=Ze[i]+t;if(e in Je){return e}}}function it(e){var t=S.cssProps[e]||et[e];if(t){return t}if(e in Je){return e}return et[e]=tt(e)||e}var nt=/^(none|table(?!-c[ea]).+)/,rt=/^--/,st={position:"absolute",visibility:"hidden",display:"block"},ot={letterSpacing:"0",fontWeight:"400"};function at(e,t,i){var n=f.exec(t);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):t}function lt(e,t,i,n,r,s){var o=t==="width"?1:0,a=0,l=0;if(i===(n?"border":"content")){return 0}for(;o<4;o+=2){if(i==="margin"){l+=S.css(e,i+w[o],true,r)}if(!n){l+=S.css(e,"padding"+w[o],true,r);if(i!=="padding"){l+=S.css(e,"border"+w[o]+"Width",true,r)}else{a+=S.css(e,"border"+w[o]+"Width",true,r)}}else{if(i==="content"){l-=S.css(e,"padding"+w[o],true,r)}if(i!=="margin"){l-=S.css(e,"border"+w[o]+"Width",true,r)}}}if(!n&&s>=0){l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-s-l-a-.5))||0}return l}function ct(e,t,i){var n=Ye(e),r=!g.boxSizingReliable()||i,s=r&&S.css(e,"boxSizing",false,n)==="border-box",o=s,a=Xe(e,t,n),l="offset"+t[0].toUpperCase()+t.slice(1);if(Ue.test(a)){if(!i){return a}a="auto"}if((!g.boxSizingReliable()&&s||!g.reliableTrDimensions()&&c(e,"tr")||a==="auto"||!parseFloat(a)&&S.css(e,"display",false,n)==="inline")&&e.getClientRects().length){s=S.css(e,"boxSizing",false,n)==="border-box";o=l in e;if(o){a=e[l]}}a=parseFloat(a)||0;return a+lt(e,t,i||(s?"border":"content"),o,n,a)+"px"}S.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=Xe(e,"opacity");return i===""?"1":i}}}},cssNumber:{animationIterationCount:true,columnCount:true,fillOpacity:true,flexGrow:true,flexShrink:true,fontWeight:true,gridArea:true,gridColumn:true,gridColumnEnd:true,gridColumnStart:true,gridRow:true,gridRowEnd:true,gridRowStart:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{},style:function(e,t,i,n){if(!e||e.nodeType===3||e.nodeType===8||!e.style){return}var r,s,o,a=h(t),l=rt.test(t),c=e.style;if(!l){t=it(a)}o=S.cssHooks[t]||S.cssHooks[a];if(i!==undefined){s=typeof i;if(s==="string"&&(r=f.exec(i))&&r[1]){i=_e(e,t,r);s="number"}if(i==null||i!==i){return}if(s==="number"&&!l){i+=r&&r[3]||(S.cssNumber[a]?"":"px")}if(!g.clearCloneStyle&&i===""&&t.indexOf("background")===0){c[t]="inherit"}if(!o||!("set"in o)||(i=o.set(e,i,n))!==undefined){if(l){c.setProperty(t,i)}else{c[t]=i}}}else{if(o&&"get"in o&&(r=o.get(e,false,n))!==undefined){return r}return c[t]}},css:function(e,t,i,n){var r,s,o,a=h(t),l=rt.test(t);if(!l){t=it(a)}o=S.cssHooks[t]||S.cssHooks[a];if(o&&"get"in o){r=o.get(e,true,i)}if(r===undefined){r=Xe(e,t,n)}if(r==="normal"&&t in ot){r=ot[t]}if(i===""||i){s=parseFloat(r);return i===true||isFinite(s)?s||0:r}return r}});S.each(["height","width"],function(e,c){S.cssHooks[c]={get:function(e,t,i){if(t){return nt.test(S.css(e,"display"))&&(!e.getClientRects().length||!e.getBoundingClientRect().width)?qe(e,st,function(){return ct(e,c,i)}):ct(e,c,i)}},set:function(e,t,i){var n,r=Ye(e),s=!g.scrollboxSize()&&r.position==="absolute",o=s||i,a=o&&S.css(e,"boxSizing",false,r)==="border-box",l=i?lt(e,c,i,a,r):0;if(a&&s){l-=Math.ceil(e["offset"+c[0].toUpperCase()+c.slice(1)]-parseFloat(r[c])-lt(e,c,"border",false,r)-.5)}if(l&&(n=f.exec(t))&&(n[3]||"px")!=="px"){e.style[c]=t;t=S.css(e,c)}return at(e,t,l)}}});S.cssHooks.marginLeft=Qe(g.reliableMarginLeft,function(e,t){if(t){return(parseFloat(Xe(e,"marginLeft"))||e.getBoundingClientRect().left-qe(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}});S.each({margin:"",padding:"",border:"Width"},function(r,s){S.cssHooks[r+s]={expand:function(e){var t=0,i={},n=typeof e==="string"?e.split(" "):[e];for(;t<4;t++){i[r+w[t]+s]=n[t]||n[t-2]||n[0]}return i}};if(r!=="margin"){S.cssHooks[r+s].set=at}});S.fn.extend({css:function(e,t){return d(this,function(e,t,i){var n,r,s={},o=0;if(Array.isArray(t)){n=Ye(e);r=t.length;for(;o<r;o++){s[t[o]]=S.css(e,t[o],false,n)}return s}return i!==undefined?S.style(e,t,i):S.css(e,t)},e,t,arguments.length>1)}});function s(e,t,i,n,r){return new s.prototype.init(e,t,i,n,r)}S.Tween=s;s.prototype={constructor:s,init:function(e,t,i,n,r,s){this.elem=e;this.prop=i;this.easing=r||S.easing._default;this.options=t;this.start=this.now=this.cur();this.end=n;this.unit=s||(S.cssNumber[i]?"":"px")},cur:function(){var e=s.propHooks[this.prop];return e&&e.get?e.get(this):s.propHooks._default.get(this)},run:function(e){var t,i=s.propHooks[this.prop];if(this.options.duration){this.pos=t=S.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration)}else{this.pos=t=e}this.now=(this.end-this.start)*t+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(i&&i.set){i.set(this)}else{s.propHooks._default.set(this)}return this}};s.prototype.init.prototype=s.prototype;s.propHooks={_default:{get:function(e){var t;if(e.elem.nodeType!==1||e.elem[e.prop]!=null&&e.elem.style[e.prop]==null){return e.elem[e.prop]}t=S.css(e.elem,e.prop,"");return!t||t==="auto"?0:t},set:function(e){if(S.fx.step[e.prop]){S.fx.step[e.prop](e)}else if(e.elem.nodeType===1&&(S.cssHooks[e.prop]||e.elem.style[it(e.prop)]!=null)){S.style(e.elem,e.prop,e.now+e.unit)}else{e.elem[e.prop]=e.now}}}};s.propHooks.scrollTop=s.propHooks.scrollLeft={set:function(e){if(e.elem.nodeType&&e.elem.parentNode){e.elem[e.prop]=e.now}}};S.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"};S.fx=s.prototype.init;S.fx.step={};var O,ut,dt=/^(?:toggle|show|hide)$/,ht=/queueHooks$/;function pt(){if(ut){if(E.hidden===false&&A.requestAnimationFrame){A.requestAnimationFrame(pt)}else{A.setTimeout(pt,S.fx.interval)}S.fx.tick()}}function ft(){A.setTimeout(function(){O=undefined});return O=Date.now()}function gt(e,t){var i,n=0,r={height:e};t=t?1:0;for(;n<4;n+=2-t){i=w[n];r["margin"+i]=r["padding"+i]=e}if(t){r.opacity=r.width=e}return r}function mt(e,t,i){var n,r=(I.tweeners[t]||[]).concat(I.tweeners["*"]),s=0,o=r.length;for(;s<o;s++){if(n=r[s].call(i,t,e)){return n}}}function vt(e,t,i){var n,r,s,o,a,l,c,u,d="width"in t||"height"in t,h=this,p={},f=e.style,g=e.nodeType&&we(e),m=C.get(e,"fxshow");if(!i.queue){o=S._queueHooks(e,"fx");if(o.unqueued==null){o.unqueued=0;a=o.empty.fire;o.empty.fire=function(){if(!o.unqueued){a()}}}o.unqueued++;h.always(function(){h.always(function(){o.unqueued--;if(!S.queue(e,"fx").length){o.empty.fire()}})})}for(n in t){r=t[n];if(dt.test(r)){delete t[n];s=s||r==="toggle";if(r===(g?"hide":"show")){if(r==="show"&&m&&m[n]!==undefined){g=true}else{continue}}p[n]=m&&m[n]||S.style(e,n)}}l=!S.isEmptyObject(t);if(!l&&S.isEmptyObject(p)){return}if(d&&e.nodeType===1){i.overflow=[f.overflow,f.overflowX,f.overflowY];c=m&&m.display;if(c==null){c=C.get(e,"display")}u=S.css(e,"display");if(u==="none"){if(c){u=c}else{D([e],true);c=e.style.display||c;u=S.css(e,"display");D([e])}}if(u==="inline"||u==="inline-block"&&c!=null){if(S.css(e,"float")==="none"){if(!l){h.done(function(){f.display=c});if(c==null){u=f.display;c=u==="none"?"":u}}f.display="inline-block"}}}if(i.overflow){f.overflow="hidden";h.always(function(){f.overflow=i.overflow[0];f.overflowX=i.overflow[1];f.overflowY=i.overflow[2]})}l=false;for(n in p){if(!l){if(m){if("hidden"in m){g=m.hidden}}else{m=C.access(e,"fxshow",{display:c})}if(s){m.hidden=!g}if(g){D([e],true)}h.done(function(){if(!g){D([e])}C.remove(e,"fxshow");for(n in p){S.style(e,n,p[n])}})}l=mt(g?m[n]:0,n,h);if(!(n in m)){m[n]=l.start;if(g){l.end=l.start;l.start=0}}}}function yt(e,t){var i,n,r,s,o;for(i in e){n=h(i);r=t[n];s=e[i];if(Array.isArray(s)){r=s[1];s=e[i]=s[0]}if(i!==n){e[n]=s;delete e[i]}o=S.cssHooks[n];if(o&&"expand"in o){s=o.expand(s);delete e[n];for(i in s){if(!(i in e)){e[i]=s[i];t[i]=r}}}else{t[n]=r}}}function I(o,e,t){var i,a,n=0,r=I.prefilters.length,l=S.Deferred().always(function(){delete s.elem}),s=function(){if(a){return false}var e=O||ft(),t=Math.max(0,c.startTime+c.duration-e),i=t/c.duration||0,n=1-i,r=0,s=c.tweens.length;for(;r<s;r++){c.tweens[r].run(n)}l.notifyWith(o,[c,n,t]);if(n<1&&s){return t}if(!s){l.notifyWith(o,[c,1,0])}l.resolveWith(o,[c]);return false},c=l.promise({elem:o,props:S.extend({},e),opts:S.extend(true,{specialEasing:{},easing:S.easing._default},t),originalProperties:e,originalOptions:t,startTime:O||ft(),duration:t.duration,tweens:[],createTween:function(e,t){var i=S.Tween(o,c.opts,e,t,c.opts.specialEasing[e]||c.opts.easing);c.tweens.push(i);return i},stop:function(e){var t=0,i=e?c.tweens.length:0;if(a){return this}a=true;for(;t<i;t++){c.tweens[t].run(1)}if(e){l.notifyWith(o,[c,1,0]);l.resolveWith(o,[c,e])}else{l.rejectWith(o,[c,e])}return this}}),u=c.props;yt(u,c.opts.specialEasing);for(;n<r;n++){i=I.prefilters[n].call(c,o,u,c.opts);if(i){if(m(i.stop)){S._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)}return i}}S.map(u,mt,c);if(m(c.opts.start)){c.opts.start.call(o,c)}c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always);S.fx.timer(S.extend(s,{elem:o,anim:c,queue:c.opts.queue}));return c}S.Animation=S.extend(I,{tweeners:{"*":[function(e,t){var i=this.createTween(e,t);_e(i.elem,e,f.exec(t),i);return i}]},tweener:function(e,t){if(m(e)){t=e;e=["*"]}else{e=e.match(T)}var i,n=0,r=e.length;for(;n<r;n++){i=e[n];I.tweeners[i]=I.tweeners[i]||[];I.tweeners[i].unshift(t)}},prefilters:[vt],prefilter:function(e,t){if(t){I.prefilters.unshift(e)}else{I.prefilters.push(e)}}});S.speed=function(e,t,i){var n=e&&typeof e==="object"?S.extend({},e):{complete:i||!i&&t||m(e)&&e,duration:e,easing:i&&t||t&&!m(t)&&t};if(S.fx.off){n.duration=0}else{if(typeof n.duration!=="number"){if(n.duration in S.fx.speeds){n.duration=S.fx.speeds[n.duration]}else{n.duration=S.fx.speeds._default}}}if(n.queue==null||n.queue===true){n.queue="fx"}n.old=n.complete;n.complete=function(){if(m(n.old)){n.old.call(this)}if(n.queue){S.dequeue(this,n.queue)}};return n};S.fn.extend({fadeTo:function(e,t,i,n){return this.filter(we).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(t,e,i,n){var r=S.isEmptyObject(t),s=S.speed(e,i,n),o=function(){var e=I(this,S.extend({},t),s);if(r||C.get(this,"finish")){e.stop(true)}};o.finish=o;return r||s.queue===false?this.each(o):this.queue(s.queue,o)},stop:function(r,e,s){var o=function(e){var t=e.stop;delete e.stop;t(s)};if(typeof r!=="string"){s=e;e=r;r=undefined}if(e){this.queue(r||"fx",[])}return this.each(function(){var e=true,t=r!=null&&r+"queueHooks",i=S.timers,n=C.get(this);if(t){if(n[t]&&n[t].stop){o(n[t])}}else{for(t in n){if(n[t]&&n[t].stop&&ht.test(t)){o(n[t])}}}for(t=i.length;t--;){if(i[t].elem===this&&(r==null||i[t].queue===r)){i[t].anim.stop(s);e=false;i.splice(t,1)}}if(e||!s){S.dequeue(this,r)}})},finish:function(o){if(o!==false){o=o||"fx"}return this.each(function(){var e,t=C.get(this),i=t[o+"queue"],n=t[o+"queueHooks"],r=S.timers,s=i?i.length:0;t.finish=true;S.queue(this,o,[]);if(n&&n.stop){n.stop.call(this,true)}for(e=r.length;e--;){if(r[e].elem===this&&r[e].queue===o){r[e].anim.stop(true);r.splice(e,1)}}for(e=0;e<s;e++){if(i[e]&&i[e].finish){i[e].finish.call(this)}}delete t.finish})}});S.each(["toggle","show","hide"],function(e,n){var r=S.fn[n];S.fn[n]=function(e,t,i){return e==null||typeof e==="boolean"?r.apply(this,arguments):this.animate(gt(n,true),e,t,i)}});S.each({slideDown:gt("show"),slideUp:gt("hide"),slideToggle:gt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,n){S.fn[e]=function(e,t,i){return this.animate(n,e,t,i)}});S.timers=[];S.fx.tick=function(){var e,t=0,i=S.timers;O=Date.now();for(;t<i.length;t++){e=i[t];if(!e()&&i[t]===e){i.splice(t--,1)}}if(!i.length){S.fx.stop()}O=undefined};S.fx.timer=function(e){S.timers.push(e);S.fx.start()};S.fx.interval=13;S.fx.start=function(){if(ut){return}ut=true;pt()};S.fx.stop=function(){ut=null};S.fx.speeds={slow:600,fast:200,_default:400};S.fn.delay=function(n,e){n=S.fx?S.fx.speeds[n]||n:n;e=e||"fx";return this.queue(e,function(e,t){var i=A.setTimeout(e,n);t.stop=function(){A.clearTimeout(i)}})};(function(){var e=E.createElement("input"),t=E.createElement("select"),i=t.appendChild(E.createElement("option"));e.type="checkbox";g.checkOn=e.value!=="";g.optSelected=i.selected;e=E.createElement("input");e.value="t";e.type="radio";g.radioValue=e.value==="t"})();var bt,Ct=S.expr.attrHandle;S.fn.extend({attr:function(e,t){return d(this,S.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){S.removeAttr(this,e)})}});S.extend({attr:function(e,t,i){var n,r,s=e.nodeType;if(s===3||s===8||s===2){return}if(typeof e.getAttribute==="undefined"){return S.prop(e,t,i)}if(s!==1||!S.isXMLDoc(e)){r=S.attrHooks[t.toLowerCase()]||(S.expr.match.bool.test(t)?bt:undefined)}if(i!==undefined){if(i===null){S.removeAttr(e,t);return}if(r&&"set"in r&&(n=r.set(e,i,t))!==undefined){return n}e.setAttribute(t,i+"");return i}if(r&&"get"in r&&(n=r.get(e,t))!==null){return n}n=S.find.attr(e,t);return n==null?undefined:n},attrHooks:{type:{set:function(e,t){if(!g.radioValue&&t==="radio"&&c(e,"input")){var i=e.value;e.setAttribute("type",t);if(i){e.value=i}return t}}}},removeAttr:function(e,t){var i,n=0,r=t&&t.match(T);if(r&&e.nodeType===1){while(i=r[n++]){e.removeAttribute(i)}}}});bt={set:function(e,t,i){if(t===false){S.removeAttr(e,i)}else{e.setAttribute(i,i)}return i}};S.each(S.expr.match.bool.source.match(/\w+/g),function(e,t){var o=Ct[t]||S.find.attr;Ct[t]=function(e,t,i){var n,r,s=t.toLowerCase();if(!i){r=Ct[s];Ct[s]=n;n=o(e,t,i)!=null?s:null;Ct[s]=r}return n}});var wt=/^(?:input|select|textarea|button)$/i,_t=/^(?:a|area)$/i;S.fn.extend({prop:function(e,t){return d(this,S.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[S.propFix[e]||e]})}});S.extend({prop:function(e,t,i){var n,r,s=e.nodeType;if(s===3||s===8||s===2){return}if(s!==1||!S.isXMLDoc(e)){t=S.propFix[t]||t;r=S.propHooks[t]}if(i!==undefined){if(r&&"set"in r&&(n=r.set(e,i,t))!==undefined){return n}return e[t]=i}if(r&&"get"in r&&(n=r.get(e,t))!==null){return n}return e[t]},propHooks:{tabIndex:{get:function(e){var t=S.find.attr(e,"tabindex");if(t){return parseInt(t,10)}if(wt.test(e.nodeName)||_t.test(e.nodeName)&&e.href){return 0}return-1}}},propFix:{for:"htmlFor",class:"className"}});if(!g.optSelected){S.propHooks.selected={get:function(e){var t=e.parentNode;if(t&&t.parentNode){t.parentNode.selectedIndex}return null},set:function(e){var t=e.parentNode;if(t){t.selectedIndex;if(t.parentNode){t.parentNode.selectedIndex}}}}}S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this});function P(e){var t=e.match(T)||[];return t.join(" ")}function k(e){return e.getAttribute&&e.getAttribute("class")||""}function At(e){if(Array.isArray(e)){return e}if(typeof e==="string"){return e.match(T)||[]}return[]}S.fn.extend({addClass:function(t){var e,i,n,r,s,o,a,l=0;if(m(t)){return this.each(function(e){S(this).addClass(t.call(this,e,k(this)))})}e=At(t);if(e.length){while(i=this[l++]){r=k(i);n=i.nodeType===1&&" "+P(r)+" ";if(n){o=0;while(s=e[o++]){if(n.indexOf(" "+s+" ")<0){n+=s+" "}}a=P(n);if(r!==a){i.setAttribute("class",a)}}}}return this},removeClass:function(t){var e,i,n,r,s,o,a,l=0;if(m(t)){return this.each(function(e){S(this).removeClass(t.call(this,e,k(this)))})}if(!arguments.length){return this.attr("class","")}e=At(t);if(e.length){while(i=this[l++]){r=k(i);n=i.nodeType===1&&" "+P(r)+" ";if(n){o=0;while(s=e[o++]){while(n.indexOf(" "+s+" ")>-1){n=n.replace(" "+s+" "," ")}}a=P(n);if(r!==a){i.setAttribute("class",a)}}}}return this},toggleClass:function(r,t){var s=typeof r,o=s==="string"||Array.isArray(r);if(typeof t==="boolean"&&o){return t?this.addClass(r):this.removeClass(r)}if(m(r)){return this.each(function(e){S(this).toggleClass(r.call(this,e,k(this),t),t)})}return this.each(function(){var e,t,i,n;if(o){t=0;i=S(this);n=At(r);while(e=n[t++]){if(i.hasClass(e)){i.removeClass(e)}else{i.addClass(e)}}}else if(r===undefined||s==="boolean"){e=k(this);if(e){C.set(this,"__className__",e)}if(this.setAttribute){this.setAttribute("class",e||r===false?"":C.get(this,"__className__")||"")}}})},hasClass:function(e){var t,i,n=0;t=" "+e+" ";while(i=this[n++]){if(i.nodeType===1&&(" "+P(k(i))+" ").indexOf(t)>-1){return true}}return false}});var Et=/\r/g;S.fn.extend({val:function(i){var n,e,r,t=this[0];if(!arguments.length){if(t){n=S.valHooks[t.type]||S.valHooks[t.nodeName.toLowerCase()];if(n&&"get"in n&&(e=n.get(t,"value"))!==undefined){return e}e=t.value;if(typeof e==="string"){return e.replace(Et,"")}return e==null?"":e}return}r=m(i);return this.each(function(e){var t;if(this.nodeType!==1){return}if(r){t=i.call(this,e,S(this).val())}else{t=i}if(t==null){t=""}else if(typeof t==="number"){t+=""}else if(Array.isArray(t)){t=S.map(t,function(e){return e==null?"":e+""})}n=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,t,"value")===undefined){this.value=t}})}});S.extend({valHooks:{option:{get:function(e){var t=S.find.attr(e,"value");return t!=null?t:P(S.text(e))}},select:{get:function(e){var t,i,n,r=e.options,s=e.selectedIndex,o=e.type==="select-one",a=o?null:[],l=o?s+1:r.length;if(s<0){n=l}else{n=o?s:0}for(;n<l;n++){i=r[n];if((i.selected||n===s)&&!i.disabled&&(!i.parentNode.disabled||!c(i.parentNode,"optgroup"))){t=S(i).val();if(o){return t}a.push(t)}}return a},set:function(e,t){var i,n,r=e.options,s=S.makeArray(t),o=r.length;while(o--){n=r[o];if(n.selected=S.inArray(S.valHooks.option.get(n),s)>-1){i=true}}if(!i){e.selectedIndex=-1}return s}}}});S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(e,t){if(Array.isArray(t)){return e.checked=S.inArray(S(e).val(),t)>-1}}};if(!g.checkOn){S.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value}}});g.focusin="onfocusin"in A;var St=/^(?:focusinfocus|focusoutblur)$/,Tt=function(e){e.stopPropagation()};S.extend(S.event,{trigger:function(e,t,i,n){var r,s,o,a,l,c,u,d,h=[i||E],p=W.call(e,"type")?e.type:e,f=W.call(e,"namespace")?e.namespace.split("."):[];s=d=o=i=i||E;if(i.nodeType===3||i.nodeType===8){return}if(St.test(p+S.event.triggered)){return}if(p.indexOf(".")>-1){f=p.split(".");p=f.shift();f.sort()}l=p.indexOf(":")<0&&"on"+p;e=e[S.expando]?e:new S.Event(p,typeof e==="object"&&e);e.isTrigger=n?2:3;e.namespace=f.join(".");e.rnamespace=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;e.result=undefined;if(!e.target){e.target=i}t=t==null?[e]:S.makeArray(t,[e]);u=S.event.special[p]||{};if(!n&&u.trigger&&u.trigger.apply(i,t)===false){return}if(!n&&!u.noBubble&&!v(i)){a=u.delegateType||p;if(!St.test(a+p)){s=s.parentNode}for(;s;s=s.parentNode){h.push(s);o=s}if(o===(i.ownerDocument||E)){h.push(o.defaultView||o.parentWindow||A)}}r=0;while((s=h[r++])&&!e.isPropagationStopped()){d=s;e.type=r>1?a:u.bindType||p;c=(C.get(s,"events")||Object.create(null))[e.type]&&C.get(s,"handle");if(c){c.apply(s,t)}c=l&&s[l];if(c&&c.apply&&b(s)){e.result=c.apply(s,t);if(e.result===false){e.preventDefault()}}}e.type=p;if(!n&&!e.isDefaultPrevented()){if((!u._default||u._default.apply(h.pop(),t)===false)&&b(i)){if(l&&m(i[p])&&!v(i)){o=i[l];if(o){i[l]=null}S.event.triggered=p;if(e.isPropagationStopped()){d.addEventListener(p,Tt)}i[p]();if(e.isPropagationStopped()){d.removeEventListener(p,Tt)}S.event.triggered=undefined;if(o){i[l]=o}}}}return e.result},simulate:function(e,t,i){var n=S.extend(new S.Event,i,{type:e,isSimulated:true});S.event.trigger(n,null,t)}});S.fn.extend({trigger:function(e,t){return this.each(function(){S.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i){return S.event.trigger(e,t,i,true)}}});if(!g.focusin){S.each({focus:"focusin",blur:"focusout"},function(i,n){var r=function(e){S.event.simulate(n,e.target,S.event.fix(e))};S.event.special[n]={setup:function(){var e=this.ownerDocument||this.document||this,t=C.access(e,n);if(!t){e.addEventListener(i,r,true)}C.access(e,n,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=C.access(e,n)-1;if(!t){e.removeEventListener(i,r,true);C.remove(e,n)}else{C.access(e,n,t)}}}})}var xt=A.location;var Dt={guid:Date.now()};var Rt=/\?/;S.parseXML=function(e){var t;if(!e||typeof e!=="string"){return null}try{t=(new A.DOMParser).parseFromString(e,"text/xml")}catch(e){t=undefined}if(!t||t.getElementsByTagName("parsererror").length){S.error("Invalid XML: "+e)}return t};var Mt=/\[\]$/,Nt=/\r?\n/g,Ot=/^(?:submit|button|image|reset|file)$/i,It=/^(?:input|select|textarea|keygen)/i;function Pt(i,e,n,r){var t;if(Array.isArray(e)){S.each(e,function(e,t){if(n||Mt.test(i)){r(i,t)}else{Pt(i+"["+(typeof t==="object"&&t!=null?e:"")+"]",t,n,r)}})}else if(!n&&y(e)==="object"){for(t in e){Pt(i+"["+t+"]",e[t],n,r)}}else{r(i,e)}}S.param=function(e,t){var i,n=[],r=function(e,t){var i=m(t)?t():t;n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(i==null?"":i)};if(e==null){return""}if(Array.isArray(e)||e.jquery&&!S.isPlainObject(e)){S.each(e,function(){r(this.name,this.value)})}else{for(i in e){Pt(i,e[i],t,r)}}return n.join("&")};S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=S.prop(this,"elements");return e?S.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!S(this).is(":disabled")&&It.test(this.nodeName)&&!Ot.test(e)&&(this.checked||!r.test(e))}).map(function(e,t){var i=S(this).val();if(i==null){return null}if(Array.isArray(i)){return S.map(i,function(e){return{name:t.name,value:e.replace(Nt,"\r\n")}})}return{name:t.name,value:i.replace(Nt,"\r\n")}}).get()}});var kt=/%20/g,Lt=/#.*$/,Ft=/([?&])_=[^&]*/,Gt=/^(.*?):[ \t]*([^\r\n]*)$/gm,$t=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ht=/^(?:GET|HEAD)$/,Bt=/^\/\//,Vt={},Wt={},zt="*/".concat("*"),jt=E.createElement("a");jt.href=xt.href;function Ut(s){return function(e,t){if(typeof e!=="string"){t=e;e="*"}var i,n=0,r=e.toLowerCase().match(T)||[];if(m(t)){while(i=r[n++]){if(i[0]==="+"){i=i.slice(1)||"*";(s[i]=s[i]||[]).unshift(t)}else{(s[i]=s[i]||[]).push(t)}}}}}function Yt(t,r,s,o){var a={},l=t===Wt;function c(e){var n;a[e]=true;S.each(t[e]||[],function(e,t){var i=t(r,s,o);if(typeof i==="string"&&!l&&!a[i]){r.dataTypes.unshift(i);c(i);return false}else if(l){return!(n=i)}});return n}return c(r.dataTypes[0])||!a["*"]&&c("*")}function qt(e,t){var i,n,r=S.ajaxSettings.flatOptions||{};for(i in t){if(t[i]!==undefined){(r[i]?e:n||(n={}))[i]=t[i]}}if(n){S.extend(true,e,n)}return e}function Kt(e,t,i){var n,r,s,o,a=e.contents,l=e.dataTypes;while(l[0]==="*"){l.shift();if(n===undefined){n=e.mimeType||t.getResponseHeader("Content-Type")}}if(n){for(r in a){if(a[r]&&a[r].test(n)){l.unshift(r);break}}}if(l[0]in i){s=l[0]}else{for(r in i){if(!l[0]||e.converters[r+" "+l[0]]){s=r;break}if(!o){o=r}}s=s||o}if(s){if(s!==l[0]){l.unshift(s)}return i[s]}}function Xt(e,t,i,n){var r,s,o,a,l,c={},u=e.dataTypes.slice();if(u[1]){for(o in e.converters){c[o.toLowerCase()]=e.converters[o]}}s=u.shift();while(s){if(e.responseFields[s]){i[e.responseFields[s]]=t}if(!l&&n&&e.dataFilter){t=e.dataFilter(t,e.dataType)}l=s;s=u.shift();if(s){if(s==="*"){s=l}else if(l!=="*"&&l!==s){o=c[l+" "+s]||c["* "+s];if(!o){for(r in c){a=r.split(" ");if(a[1]===s){o=c[l+" "+a[0]]||c["* "+a[0]];if(o){if(o===true){o=c[r]}else if(c[r]!==true){s=a[0];u.unshift(a[1])}break}}}}if(o!==true){if(o&&e.throws){t=o(t)}else{try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+l+" to "+s}}}}}}}return{state:"success",data:t}}S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:xt.href,type:"GET",isLocal:$t.test(xt.protocol),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":zt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(e,t){return t?qt(qt(e,S.ajaxSettings),t):qt(S.ajaxSettings,e)},ajaxPrefilter:Ut(Vt),ajaxTransport:Ut(Wt),ajax:function(e,t){if(typeof e==="object"){t=e;e=undefined}t=t||{};var u,d,h,i,p,n,f,g,r,s,m=S.ajaxSetup({},t),v=m.context||m,y=m.context&&(v.nodeType||v.jquery)?S(v):S.event,b=S.Deferred(),C=S.Callbacks("once memory"),w=m.statusCode||{},o={},a={},l="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(f){if(!i){i={};while(t=Gt.exec(h)){i[t[1].toLowerCase()+" "]=(i[t[1].toLowerCase()+" "]||[]).concat(t[2])}}t=i[e.toLowerCase()+" "]}return t==null?null:t.join(", ")},getAllResponseHeaders:function(){return f?h:null},setRequestHeader:function(e,t){if(f==null){e=a[e.toLowerCase()]=a[e.toLowerCase()]||e;o[e]=t}return this},overrideMimeType:function(e){if(f==null){m.mimeType=e}return this},statusCode:function(e){var t;if(e){if(f){_.always(e[_.status])}else{for(t in e){w[t]=[w[t],e[t]]}}}return this},abort:function(e){var t=e||l;if(u){u.abort(t)}c(0,t);return this}};b.promise(_);m.url=((e||m.url||xt.href)+"").replace(Bt,xt.protocol+"//");m.type=t.method||t.type||m.method||m.type;m.dataTypes=(m.dataType||"*").toLowerCase().match(T)||[""];if(m.crossDomain==null){n=E.createElement("a");try{n.href=m.url;n.href=n.href;m.crossDomain=jt.protocol+"//"+jt.host!==n.protocol+"//"+n.host}catch(e){m.crossDomain=true}}if(m.data&&m.processData&&typeof m.data!=="string"){m.data=S.param(m.data,m.traditional)}Yt(Vt,m,t,_);if(f){return _}g=S.event&&m.global;if(g&&S.active++===0){S.event.trigger("ajaxStart")}m.type=m.type.toUpperCase();m.hasContent=!Ht.test(m.type);d=m.url.replace(Lt,"");if(!m.hasContent){s=m.url.slice(d.length);if(m.data&&(m.processData||typeof m.data==="string")){d+=(Rt.test(d)?"&":"?")+m.data;delete m.data}if(m.cache===false){d=d.replace(Ft,"$1");s=(Rt.test(d)?"&":"?")+"_="+Dt.guid+++s}m.url=d+s}else if(m.data&&m.processData&&(m.contentType||"").indexOf("application/x-www-form-urlencoded")===0){m.data=m.data.replace(kt,"+")}if(m.ifModified){if(S.lastModified[d]){_.setRequestHeader("If-Modified-Since",S.lastModified[d])}if(S.etag[d]){_.setRequestHeader("If-None-Match",S.etag[d])}}if(m.data&&m.hasContent&&m.contentType!==false||t.contentType){_.setRequestHeader("Content-Type",m.contentType)}_.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+(m.dataTypes[0]!=="*"?", "+zt+"; q=0.01":""):m.accepts["*"]);for(r in m.headers){_.setRequestHeader(r,m.headers[r])}if(m.beforeSend&&(m.beforeSend.call(v,_,m)===false||f)){return _.abort()}l="abort";C.add(m.complete);_.done(m.success);_.fail(m.error);u=Yt(Wt,m,t,_);if(!u){c(-1,"No Transport")}else{_.readyState=1;if(g){y.trigger("ajaxSend",[_,m])}if(f){return _}if(m.async&&m.timeout>0){p=A.setTimeout(function(){_.abort("timeout")},m.timeout)}try{f=false;u.send(o,c)}catch(e){if(f){throw e}c(-1,e)}}function c(e,t,i,n){var r,s,o,a,l,c=t;if(f){return}f=true;if(p){A.clearTimeout(p)}u=undefined;h=n||"";_.readyState=e>0?4:0;r=e>=200&&e<300||e===304;if(i){a=Kt(m,_,i)}if(!r&&S.inArray("script",m.dataTypes)>-1){m.converters["text script"]=function(){}}a=Xt(m,a,_,r);if(r){if(m.ifModified){l=_.getResponseHeader("Last-Modified");if(l){S.lastModified[d]=l}l=_.getResponseHeader("etag");if(l){S.etag[d]=l}}if(e===204||m.type==="HEAD"){c="nocontent"}else if(e===304){c="notmodified"}else{c=a.state;s=a.data;o=a.error;r=!o}}else{o=c;if(e||!c){c="error";if(e<0){e=0}}}_.status=e;_.statusText=(t||c)+"";if(r){b.resolveWith(v,[s,c,_])}else{b.rejectWith(v,[_,c,o])}_.statusCode(w);w=undefined;if(g){y.trigger(r?"ajaxSuccess":"ajaxError",[_,m,r?s:o])}C.fireWith(v,[_,c]);if(g){y.trigger("ajaxComplete",[_,m]);if(!--S.active){S.event.trigger("ajaxStop")}}}return _},getJSON:function(e,t,i){return S.get(e,t,i,"json")},getScript:function(e,t){return S.get(e,undefined,t,"script")}});S.each(["get","post"],function(e,r){S[r]=function(e,t,i,n){if(m(t)){n=n||i;i=t;t=undefined}return S.ajax(S.extend({url:e,type:r,dataType:n,data:t,success:i},S.isPlainObject(e)&&e))}});S.ajaxPrefilter(function(e){var t;for(t in e.headers){if(t.toLowerCase()==="content-type"){e.contentType=e.headers[t]||""}}});S._evalUrl=function(e,t,i){return S.ajax({url:e,type:"GET",dataType:"script",cache:true,async:false,global:false,converters:{"text script":function(){}},dataFilter:function(e){S.globalEval(e,t,i)}})};S.fn.extend({wrapAll:function(e){var t;if(this[0]){if(m(e)){e=e.call(this[0])}t=S(e,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){t.insertBefore(this[0])}t.map(function(){var e=this;while(e.firstElementChild){e=e.firstElementChild}return e}).append(this)}return this},wrapInner:function(i){if(m(i)){return this.each(function(e){S(this).wrapInner(i.call(this,e))})}return this.each(function(){var e=S(this),t=e.contents();if(t.length){t.wrapAll(i)}else{e.append(i)}})},wrap:function(t){var i=m(t);return this.each(function(e){S(this).wrapAll(i?t.call(this,e):t)})},unwrap:function(e){this.parent(e).not("body").each(function(){S(this).replaceWith(this.childNodes)});return this}});S.expr.pseudos.hidden=function(e){return!S.expr.pseudos.visible(e)};S.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)};S.ajaxSettings.xhr=function(){try{return new A.XMLHttpRequest}catch(e){}};var Qt={0:200,1223:204},Zt=S.ajaxSettings.xhr();g.cors=!!Zt&&"withCredentials"in Zt;g.ajax=Zt=!!Zt;S.ajaxTransport(function(r){var s,o;if(g.cors||Zt&&!r.crossDomain){return{send:function(e,t){var i,n=r.xhr();n.open(r.type,r.url,r.async,r.username,r.password);if(r.xhrFields){for(i in r.xhrFields){n[i]=r.xhrFields[i]}}if(r.mimeType&&n.overrideMimeType){n.overrideMimeType(r.mimeType)}if(!r.crossDomain&&!e["X-Requested-With"]){e["X-Requested-With"]="XMLHttpRequest"}for(i in e){n.setRequestHeader(i,e[i])}s=function(e){return function(){if(s){s=o=n.onload=n.onerror=n.onabort=n.ontimeout=n.onreadystatechange=null;if(e==="abort"){n.abort()}else if(e==="error"){if(typeof n.status!=="number"){t(0,"error")}else{t(n.status,n.statusText)}}else{t(Qt[n.status]||n.status,n.statusText,(n.responseType||"text")!=="text"||typeof n.responseText!=="string"?{binary:n.response}:{text:n.responseText},n.getAllResponseHeaders())}}}};n.onload=s();o=n.onerror=n.ontimeout=s("error");if(n.onabort!==undefined){n.onabort=o}else{n.onreadystatechange=function(){if(n.readyState===4){A.setTimeout(function(){if(s){o()}})}}}s=s("abort");try{n.send(r.hasContent&&r.data||null)}catch(e){if(s){throw e}}},abort:function(){if(s){s()}}}}});S.ajaxPrefilter(function(e){if(e.crossDomain){e.contents.script=false}});S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, "+"application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){S.globalEval(e);return e}}});S.ajaxPrefilter("script",function(e){if(e.cache===undefined){e.cache=false}if(e.crossDomain){e.type="GET"}});S.ajaxTransport("script",function(i){if(i.crossDomain||i.scriptAttrs){var n,r;return{send:function(e,t){n=S("<script>").attr(i.scriptAttrs||{}).prop({charset:i.scriptCharset,src:i.url}).on("load error",r=function(e){n.remove();r=null;if(e){t(e.type==="error"?404:200,e.type)}});E.head.appendChild(n[0])},abort:function(){if(r){r()}}}}});var Jt=[],ei=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Jt.pop()||S.expando+"_"+Dt.guid++;this[e]=true;return e}});S.ajaxPrefilter("json jsonp",function(e,t,i){var n,r,s,o=e.jsonp!==false&&(ei.test(e.url)?"url":typeof e.data==="string"&&(e.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&ei.test(e.data)&&"data");if(o||e.dataTypes[0]==="jsonp"){n=e.jsonpCallback=m(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback;if(o){e[o]=e[o].replace(ei,"$1"+n)}else if(e.jsonp!==false){e.url+=(Rt.test(e.url)?"&":"?")+e.jsonp+"="+n}e.converters["script json"]=function(){if(!s){S.error(n+" was not called")}return s[0]};e.dataTypes[0]="json";r=A[n];A[n]=function(){s=arguments};i.always(function(){if(r===undefined){S(A).removeProp(n)}else{A[n]=r}if(e[n]){e.jsonpCallback=t.jsonpCallback;Jt.push(n)}if(s&&m(r)){r(s[0])}s=r=undefined});return"script"}});g.createHTMLDocument=function(){var e=E.implementation.createHTMLDocument("").body;e.innerHTML="<form></form><form></form>";return e.childNodes.length===2}();S.parseHTML=function(e,t,i){if(typeof e!=="string"){return[]}if(typeof t==="boolean"){i=t;t=false}var n,r,s;if(!t){if(g.createHTMLDocument){t=E.implementation.createHTMLDocument("");n=t.createElement("base");n.href=E.location.href;t.head.appendChild(n)}else{t=E}}r=Z.exec(e);s=!i&&[];if(r){return[t.createElement(r[1])]}r=Re([e],t,s);if(s&&s.length){S(s).remove()}return S.merge([],r.childNodes)};S.fn.load=function(e,t,i){var n,r,s,o=this,a=e.indexOf(" ");if(a>-1){n=P(e.slice(a));e=e.slice(0,a)}if(m(t)){i=t;t=undefined}else if(t&&typeof t==="object"){r="POST"}if(o.length>0){S.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done(function(e){s=arguments;o.html(n?S("<div>").append(S.parseHTML(e)).find(n):e)}).always(i&&function(e,t){o.each(function(){i.apply(this,s||[e.responseText,t,e])})})}return this};S.expr.pseudos.animated=function(t){return S.grep(S.timers,function(e){return t===e.elem}).length};S.offset={setOffset:function(e,t,i){var n,r,s,o,a,l,c,u=S.css(e,"position"),d=S(e),h={};if(u==="static"){e.style.position="relative"}a=d.offset();s=S.css(e,"top");l=S.css(e,"left");c=(u==="absolute"||u==="fixed")&&(s+l).indexOf("auto")>-1;if(c){n=d.position();o=n.top;r=n.left}else{o=parseFloat(s)||0;r=parseFloat(l)||0}if(m(t)){t=t.call(e,i,S.extend({},a))}if(t.top!=null){h.top=t.top-a.top+o}if(t.left!=null){h.left=t.left-a.left+r}if("using"in t){t.using.call(e,h)}else{if(typeof h.top==="number"){h.top+="px"}if(typeof h.left==="number"){h.left+="px"}d.css(h)}}};S.fn.extend({offset:function(t){if(arguments.length){return t===undefined?this:this.each(function(e){S.offset.setOffset(this,t,e)})}var e,i,n=this[0];if(!n){return}if(!n.getClientRects().length){return{top:0,left:0}}e=n.getBoundingClientRect();i=n.ownerDocument.defaultView;return{top:e.top+i.pageYOffset,left:e.left+i.pageXOffset}},position:function(){if(!this[0]){return}var e,t,i,n=this[0],r={top:0,left:0};if(S.css(n,"position")==="fixed"){t=n.getBoundingClientRect()}else{t=this.offset();i=n.ownerDocument;e=n.offsetParent||i.documentElement;while(e&&(e===i.body||e===i.documentElement)&&S.css(e,"position")==="static"){e=e.parentNode}if(e&&e!==n&&e.nodeType===1){r=S(e).offset();r.top+=S.css(e,"borderTopWidth",true);r.left+=S.css(e,"borderLeftWidth",true)}}return{top:t.top-r.top-S.css(n,"marginTop",true),left:t.left-r.left-S.css(n,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&S.css(e,"position")==="static"){e=e.offsetParent}return e||_})}});S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,r){var s="pageYOffset"===r;S.fn[t]=function(e){return d(this,function(e,t,i){var n;if(v(e)){n=e}else if(e.nodeType===9){n=e.defaultView}if(i===undefined){return n?n[r]:e[t]}if(n){n.scrollTo(!s?i:n.pageXOffset,s?i:n.pageYOffset)}else{e[t]=i}},t,e,arguments.length)}});S.each(["top","left"],function(e,i){S.cssHooks[i]=Qe(g.pixelPosition,function(e,t){if(t){t=Xe(e,i);return Ue.test(t)?S(e).position()[i]+"px":t}})});S.each({Height:"height",Width:"width"},function(o,a){S.each({padding:"inner"+o,content:a,"":"outer"+o},function(n,s){S.fn[s]=function(e,t){var i=arguments.length&&(n||typeof e!=="boolean"),r=n||(e===true||t===true?"margin":"border");return d(this,function(e,t,i){var n;if(v(e)){return s.indexOf("outer")===0?e["inner"+o]:e.document.documentElement["client"+o]}if(e.nodeType===9){n=e.documentElement;return Math.max(e.body["scroll"+o],n["scroll"+o],e.body["offset"+o],n["offset"+o],n["client"+o])}return i===undefined?S.css(e,t,r):S.style(e,t,i,r)},a,i?e:undefined,i)}})});S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){S.fn[t]=function(e){return this.on(t,e)}});S.fn.extend({bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}});S.each(("blur focus focusin focusout resize scroll click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup contextmenu").split(" "),function(e,i){S.fn[i]=function(e,t){return arguments.length>0?this.on(i,null,e,t):this.trigger(i)}});var ti=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;S.proxy=function(e,t){var i,n,r;if(typeof t==="string"){i=e[t];t=e;e=i}if(!m(e)){return undefined}n=a.call(arguments,2);r=function(){return e.apply(t||this,n.concat(a.call(arguments)))};r.guid=e.guid=e.guid||S.guid++;return r};S.holdReady=function(e){if(e){S.readyWait++}else{S.ready(true)}};S.isArray=Array.isArray;S.parseJSON=JSON.parse;S.nodeName=c;S.isFunction=m;S.isWindow=v;S.camelCase=h;S.type=y;S.now=Date.now;S.isNumeric=function(e){var t=S.type(e);return(t==="number"||t==="string")&&!isNaN(e-parseFloat(e))};S.trim=function(e){return e==null?"":(e+"").replace(ti,"")};if(typeof define==="function"&&define.amd){define("jquery",[],function(){return S})}var ii=A.jQuery,ni=A.$;S.noConflict=function(e){if(A.$===S){A.$=ni}if(e&&A.jQuery===S){A.jQuery=ii}return S};if(typeof L==="undefined"){A.jQuery=A.$=S}return S});(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(te){"use strict";te.ui=te.ui||{};var k=te.ui.version="1.13.1";var i=0;var o=Array.prototype.hasOwnProperty;var a=Array.prototype.slice;te.cleanData=function(r){return function(e){var t,i,n;for(n=0;(i=e[n])!=null;n++){t=te._data(i,"events");if(t&&t.remove){te(i).triggerHandler("remove")}}r(e)}}(te.cleanData);te.widget=function(e,i,t){var n,r,s;var o={};var a=e.split(".")[0];e=e.split(".")[1];var l=a+"-"+e;if(!t){t=i;i=te.Widget}if(Array.isArray(t)){t=te.extend.apply(null,[{}].concat(t))}te.expr.pseudos[l.toLowerCase()]=function(e){return!!te.data(e,l)};te[a]=te[a]||{};n=te[a][e];r=te[a][e]=function(e,t){if(!this||!this._createWidget){return new r(e,t)}if(arguments.length){this._createWidget(e,t)}};te.extend(r,n,{version:t.version,_proto:te.extend({},t),_childConstructors:[]});s=new i;s.options=te.widget.extend({},s.options);te.each(t,function(t,s){if(typeof s!=="function"){o[t]=s;return}o[t]=function(){function n(){return i.prototype[t].apply(this,arguments)}function r(e){return i.prototype[t].apply(this,e)}return function(){var e=this._super;var t=this._superApply;var i;this._super=n;this._superApply=r;i=s.apply(this,arguments);this._super=e;this._superApply=t;return i}}()});r.prototype=te.widget.extend(s,{widgetEventPrefix:n?s.widgetEventPrefix||e:e},o,{constructor:r,namespace:a,widgetName:e,widgetFullName:l});if(n){te.each(n._childConstructors,function(e,t){var i=t.prototype;te.widget(i.namespace+"."+i.widgetName,r,t._proto)});delete n._childConstructors}else{i._childConstructors.push(r)}te.widget.bridge(e,r);return r};te.widget.extend=function(e){var t=a.call(arguments,1);var i=0;var n=t.length;var r;var s;for(;i<n;i++){for(r in t[i]){s=t[i][r];if(o.call(t[i],r)&&s!==undefined){if(te.isPlainObject(s)){e[r]=te.isPlainObject(e[r])?te.widget.extend({},e[r],s):te.widget.extend({},s)}else{e[r]=s}}}}return e};te.widget.bridge=function(s,t){var o=t.prototype.widgetFullName||s;te.fn[s]=function(i){var e=typeof i==="string";var n=a.call(arguments,1);var r=this;if(e){if(!this.length&&i==="instance"){r=undefined}else{this.each(function(){var e;var t=te.data(this,o);if(i==="instance"){r=t;return false}if(!t){return te.error("cannot call methods on "+s+" prior to initialization; "+"attempted to call method '"+i+"'")}if(typeof t[i]!=="function"||i.charAt(0)==="_"){return te.error("no such method '"+i+"' for "+s+" widget instance")}e=t[i].apply(t,n);if(e!==t&&e!==undefined){r=e&&e.jquery?r.pushStack(e.get()):e;return false}})}}else{if(n.length){i=te.widget.extend.apply(null,[i].concat(n))}this.each(function(){var e=te.data(this,o);if(e){e.option(i||{});if(e._init){e._init()}}else{te.data(this,o,new t(i,this))}})}return r}};te.Widget=function(){};te.Widget._childConstructors=[];te.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:false,create:null},_createWidget:function(e,t){t=te(t||this.defaultElement||this)[0];this.element=te(t);this.uuid=i++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=te();this.hoverable=te();this.focusable=te();this.classesElementLookup={};if(t!==this){te.data(t,this.widgetFullName,this);this._on(true,this.element,{remove:function(e){if(e.target===t){this.destroy()}}});this.document=te(t.style?t.ownerDocument:t.document||t);this.window=te(this.document[0].defaultView||this.document[0].parentWindow)}this.options=te.widget.extend({},this.options,this._getCreateOptions(),e);this._create();if(this.options.disabled){this._setOptionDisabled(this.options.disabled)}this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:te.noop,_create:te.noop,_init:te.noop,destroy:function(){var i=this;this._destroy();te.each(this.classesElementLookup,function(e,t){i._removeClass(t,e)});this.element.off(this.eventNamespace).removeData(this.widgetFullName);this.widget().off(this.eventNamespace).removeAttr("aria-disabled");this.bindings.off(this.eventNamespace)},_destroy:te.noop,widget:function(){return this.element},option:function(e,t){var i=e;var n;var r;var s;if(arguments.length===0){return te.widget.extend({},this.options)}if(typeof e==="string"){i={};n=e.split(".");e=n.shift();if(n.length){r=i[e]=te.widget.extend({},this.options[e]);for(s=0;s<n.length-1;s++){r[n[s]]=r[n[s]]||{};r=r[n[s]]}e=n.pop();if(arguments.length===1){return r[e]===undefined?null:r[e]}r[e]=t}else{if(arguments.length===1){return this.options[e]===undefined?null:this.options[e]}i[e]=t}}this._setOptions(i);return this},_setOptions:function(e){var t;for(t in e){this._setOption(t,e[t])}return this},_setOption:function(e,t){if(e==="classes"){this._setOptionClasses(t)}this.options[e]=t;if(e==="disabled"){this._setOptionDisabled(t)}return this},_setOptionClasses:function(e){var t,i,n;for(t in e){n=this.classesElementLookup[t];if(e[t]===this.options.classes[t]||!n||!n.length){continue}i=te(n.get());this._removeClass(n,t);i.addClass(this._classes({element:i,keys:t,classes:e,add:true}))}},_setOptionDisabled:function(e){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!e);if(e){this._removeClass(this.hoverable,null,"ui-state-hover");this._removeClass(this.focusable,null,"ui-state-focus")}},enable:function(){return this._setOptions({disabled:false})},disable:function(){return this._setOptions({disabled:true})},_classes:function(r){var s=[];var o=this;r=te.extend({element:this.element,classes:this.options.classes||{}},r);function a(){var n=[];r.element.each(function(e,t){var i=te.map(o.classesElementLookup,function(e){return e}).some(function(e){return e.is(t)});if(!i){n.push(t)}});o._on(te(n),{remove:"_untrackClassesElement"})}function e(e,t){var i,n;for(n=0;n<e.length;n++){i=o.classesElementLookup[e[n]]||te();if(r.add){a();i=te(te.uniqueSort(i.get().concat(r.element.get())))}else{i=te(i.not(r.element).get())}o.classesElementLookup[e[n]]=i;s.push(e[n]);if(t&&r.classes[e[n]]){s.push(r.classes[e[n]])}}}if(r.keys){e(r.keys.match(/\S+/g)||[],true)}if(r.extra){e(r.extra.match(/\S+/g)||[])}return s.join(" ")},_untrackClassesElement:function(i){var n=this;te.each(n.classesElementLookup,function(e,t){if(te.inArray(i.target,t)!==-1){n.classesElementLookup[e]=te(t.not(i.target).get())}});this._off(te(i.target))},_removeClass:function(e,t,i){return this._toggleClass(e,t,i,false)},_addClass:function(e,t,i){return this._toggleClass(e,t,i,true)},_toggleClass:function(e,t,i,n){n=typeof n==="boolean"?n:i;var r=typeof e==="string"||e===null,s={extra:r?t:i,keys:r?e:t,element:r?this.element:e,add:n};s.element.toggleClass(this._classes(s),n);return this},_on:function(o,a,e){var l;var c=this;if(typeof o!=="boolean"){e=a;a=o;o=false}if(!e){e=a;a=this.element;l=this.widget()}else{a=l=te(a);this.bindings=this.bindings.add(a)}te.each(e,function(e,t){function i(){if(!o&&(c.options.disabled===true||te(this).hasClass("ui-state-disabled"))){return}return(typeof t==="string"?c[t]:t).apply(c,arguments)}if(typeof t!=="string"){i.guid=t.guid=t.guid||i.guid||te.guid++}var n=e.match(/^([\w:-]*)\s*(.*)$/);var r=n[1]+c.eventNamespace;var s=n[2];if(s){l.on(r,s,i)}else{a.on(r,i)}})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;e.off(t);this.bindings=te(this.bindings.not(e).get());this.focusable=te(this.focusable.not(e).get());this.hoverable=te(this.hoverable.not(e).get())},_delay:function(e,t){function i(){return(typeof e==="string"?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e);this._on(e,{mouseenter:function(e){this._addClass(te(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(te(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e);this._on(e,{focusin:function(e){this._addClass(te(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(te(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,t,i){var n,r;var s=this.options[e];i=i||{};t=te.Event(t);t.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase();t.target=this.element[0];r=t.originalEvent;if(r){for(n in r){if(!(n in t)){t[n]=r[n]}}}this.element.trigger(t,i);return!(typeof s==="function"&&s.apply(this.element[0],[t].concat(i))===false||t.isDefaultPrevented())}};te.each({show:"fadeIn",hide:"fadeOut"},function(s,o){te.Widget.prototype["_"+s]=function(t,e,i){if(typeof e==="string"){e={effect:e}}var n;var r=!e?s:e===true||typeof e==="number"?o:e.effect||o;e=e||{};if(typeof e==="number"){e={duration:e}}else if(e===true){e={}}n=!te.isEmptyObject(e);e.complete=i;if(e.delay){t.delay(e.delay)}if(n&&te.effects&&te.effects.effect[r]){t[s](e)}else if(r!==s&&t[r]){t[r](e.duration,e.easing,i)}else{t.queue(function(e){te(this)[s]();if(i){i.call(t[0])}e()})}}});var L=te.widget;(function(){var r,_=Math.max,A=Math.abs,n=/left|center|right/,s=/top|center|bottom/,o=/[\+\-]\d+(\.[\d]+)?%?/,a=/^\w+/,l=/%$/,t=te.fn.position;function E(e,t,i){return[parseFloat(e[0])*(l.test(e[0])?t/100:1),parseFloat(e[1])*(l.test(e[1])?i/100:1)]}function S(e,t){return parseInt(te.css(e,t),10)||0}function c(e){return e!=null&&e===e.window}function i(e){var t=e[0];if(t.nodeType===9){return{width:e.width(),height:e.height(),offset:{top:0,left:0}}}if(c(t)){return{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}}if(t.preventDefault){return{width:0,height:0,offset:{top:t.pageY,left:t.pageX}}}return{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}te.position={scrollbarWidth:function(){if(r!==undefined){return r}var e,t,i=te("<div style="+"'display:block;position:absolute;width:200px;height:200px;overflow:hidden;'>"+"<div style='height:300px;width:auto;'></div></div>"),n=i.children()[0];te("body").append(i);e=n.offsetWidth;i.css("overflow","scroll");t=n.offsetWidth;if(e===t){t=i[0].clientWidth}i.remove();return r=e-t},getScrollInfo:function(e){var t=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),i=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),n=t==="scroll"||t==="auto"&&e.width<e.element[0].scrollWidth,r=i==="scroll"||i==="auto"&&e.height<e.element[0].scrollHeight;return{width:r?te.position.scrollbarWidth():0,height:n?te.position.scrollbarWidth():0}},getWithinInfo:function(e){var t=te(e||window),i=c(t[0]),n=!!t[0]&&t[0].nodeType===9,r=!i&&!n;return{element:t,isWindow:i,isDocument:n,offset:r?te(e).offset():{left:0,top:0},scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop(),width:t.outerWidth(),height:t.outerHeight()}}};te.fn.position=function(d){if(!d||!d.of){return t.apply(this,arguments)}d=te.extend({},d);var h,p,f,g,m,e,v=typeof d.of==="string"?te(document).find(d.of):te(d.of),y=te.position.getWithinInfo(d.within),b=te.position.getScrollInfo(y),C=(d.collision||"flip").split(" "),w={};e=i(v);if(v[0].preventDefault){d.at="left top"}p=e.width;f=e.height;g=e.offset;m=te.extend({},g);te.each(["my","at"],function(){var e=(d[this]||"").split(" "),t,i;if(e.length===1){e=n.test(e[0])?e.concat(["center"]):s.test(e[0])?["center"].concat(e):["center","center"]}e[0]=n.test(e[0])?e[0]:"center";e[1]=s.test(e[1])?e[1]:"center";t=o.exec(e[0]);i=o.exec(e[1]);w[this]=[t?t[0]:0,i?i[0]:0];d[this]=[a.exec(e[0])[0],a.exec(e[1])[0]]});if(C.length===1){C[1]=C[0]}if(d.at[0]==="right"){m.left+=p}else if(d.at[0]==="center"){m.left+=p/2}if(d.at[1]==="bottom"){m.top+=f}else if(d.at[1]==="center"){m.top+=f/2}h=E(w.at,p,f);m.left+=h[0];m.top+=h[1];return this.each(function(){var i,e,o=te(this),a=o.outerWidth(),l=o.outerHeight(),t=S(this,"marginLeft"),n=S(this,"marginTop"),r=a+t+S(this,"marginRight")+b.width,s=l+n+S(this,"marginBottom")+b.height,c=te.extend({},m),u=E(w.my,o.outerWidth(),o.outerHeight());if(d.my[0]==="right"){c.left-=a}else if(d.my[0]==="center"){c.left-=a/2}if(d.my[1]==="bottom"){c.top-=l}else if(d.my[1]==="center"){c.top-=l/2}c.left+=u[0];c.top+=u[1];i={marginLeft:t,marginTop:n};te.each(["left","top"],function(e,t){if(te.ui.position[C[e]]){te.ui.position[C[e]][t](c,{targetWidth:p,targetHeight:f,elemWidth:a,elemHeight:l,collisionPosition:i,collisionWidth:r,collisionHeight:s,offset:[h[0]+u[0],h[1]+u[1]],my:d.my,at:d.at,within:y,elem:o})}});if(d.using){e=function(e){var t=g.left-c.left,i=t+p-a,n=g.top-c.top,r=n+f-l,s={target:{element:v,left:g.left,top:g.top,width:p,height:f},element:{element:o,left:c.left,top:c.top,width:a,height:l},horizontal:i<0?"left":t>0?"right":"center",vertical:r<0?"top":n>0?"bottom":"middle"};if(p<a&&A(t+i)<p){s.horizontal="center"}if(f<l&&A(n+r)<f){s.vertical="middle"}if(_(A(t),A(i))>_(A(n),A(r))){s.important="horizontal"}else{s.important="vertical"}d.using.call(this,e,s)}}o.offset(te.extend(c,{using:e}))})};te.ui.position={fit:{left:function(e,t){var i=t.within,n=i.isWindow?i.scrollLeft:i.offset.left,r=i.width,s=e.left-t.collisionPosition.marginLeft,o=n-s,a=s+t.collisionWidth-r-n,l;if(t.collisionWidth>r){if(o>0&&a<=0){l=e.left+o+t.collisionWidth-r-n;e.left+=o-l}else if(a>0&&o<=0){e.left=n}else{if(o>a){e.left=n+r-t.collisionWidth}else{e.left=n}}}else if(o>0){e.left+=o}else if(a>0){e.left-=a}else{e.left=_(e.left-s,e.left)}},top:function(e,t){var i=t.within,n=i.isWindow?i.scrollTop:i.offset.top,r=t.within.height,s=e.top-t.collisionPosition.marginTop,o=n-s,a=s+t.collisionHeight-r-n,l;if(t.collisionHeight>r){if(o>0&&a<=0){l=e.top+o+t.collisionHeight-r-n;e.top+=o-l}else if(a>0&&o<=0){e.top=n}else{if(o>a){e.top=n+r-t.collisionHeight}else{e.top=n}}}else if(o>0){e.top+=o}else if(a>0){e.top-=a}else{e.top=_(e.top-s,e.top)}}},flip:{left:function(e,t){var i=t.within,n=i.offset.left+i.scrollLeft,r=i.width,s=i.isWindow?i.scrollLeft:i.offset.left,o=e.left-t.collisionPosition.marginLeft,a=o-s,l=o+t.collisionWidth-r-s,c=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,u=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,d=-2*t.offset[0],h,p;if(a<0){h=e.left+c+u+d+t.collisionWidth-r-n;if(h<0||h<A(a)){e.left+=c+u+d}}else if(l>0){p=e.left-t.collisionPosition.marginLeft+c+u+d-s;if(p>0||A(p)<l){e.left+=c+u+d}}},top:function(e,t){var i=t.within,n=i.offset.top+i.scrollTop,r=i.height,s=i.isWindow?i.scrollTop:i.offset.top,o=e.top-t.collisionPosition.marginTop,a=o-s,l=o+t.collisionHeight-r-s,c=t.my[1]==="top",u=c?-t.elemHeight:t.my[1]==="bottom"?t.elemHeight:0,d=t.at[1]==="top"?t.targetHeight:t.at[1]==="bottom"?-t.targetHeight:0,h=-2*t.offset[1],p,f;if(a<0){f=e.top+u+d+h+t.collisionHeight-r-n;if(f<0||f<A(a)){e.top+=u+d+h}}else if(l>0){p=e.top-t.collisionPosition.marginTop+u+d+h-s;if(p>0||A(p)<l){e.top+=u+d+h}}}},flipfit:{left:function(){te.ui.position.flip.left.apply(this,arguments);te.ui.position.fit.left.apply(this,arguments)},top:function(){te.ui.position.flip.top.apply(this,arguments);te.ui.position.fit.top.apply(this,arguments)}}}})();var F=te.ui.position;var G=te.extend(te.expr.pseudos,{data:te.expr.createPseudo?te.expr.createPseudo(function(t){return function(e){return!!te.data(e,t)}}):function(e,t,i){return!!te.data(e,i[3])}});var $=te.fn.extend({disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}});var u=te;var e="backgroundColor borderBottomColor borderLeftColor borderRightColor "+"borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",n={},t=n.toString,d=/^([\-+])=\s*(\d+\.?\d*)/,r=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1]*2.55,e[2]*2.55,e[3]*2.55,e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})?/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),e[4]?(parseInt(e[4],16)/255).toFixed(2):1]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])?/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),e[4]?(parseInt(e[4]+e[4],16)/255).toFixed(2):1]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],h=u.Color=function(e,t,i,n){return new u.Color.fn.parse(e,t,i,n)},p={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},f={byte:{floor:true,max:255},percent:{max:1},degrees:{mod:360,floor:true}},l=h.support={},s=u("<p>")[0],c,g=u.each;s.style.cssText="background-color:rgba(1,1,1,.5)";l.rgba=s.style.backgroundColor.indexOf("rgba")>-1;g(p,function(e,t){t.cache="_"+e;t.props.alpha={idx:3,type:"percent",def:1}});u.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});function m(e){if(e==null){return e+""}return typeof e==="object"?n[t.call(e)]||"object":typeof e}function v(e,t,i){var n=f[t.type]||{};if(e==null){return i||!t.def?null:t.def}e=n.floor?~~e:parseFloat(e);if(isNaN(e)){return t.def}if(n.mod){return(e+n.mod)%n.mod}return Math.min(n.max,Math.max(0,e))}function y(o){var a=h(),l=a._rgba=[];o=o.toLowerCase();g(r,function(e,t){var i,n=t.re.exec(o),r=n&&t.parse(n),s=t.space||"rgba";if(r){i=a[s](r);a[p[s].cache]=i[p[s].cache];l=a._rgba=i._rgba;return false}});if(l.length){if(l.join()==="0,0,0,0"){u.extend(l,c.transparent)}return a}return c[o]}h.fn=u.extend(h.prototype,{parse:function(r,e,t,i){if(r===undefined){this._rgba=[null,null,null,null];return this}if(r.jquery||r.nodeType){r=u(r).css(e);e=undefined}var s=this,n=m(r),o=this._rgba=[];if(e!==undefined){r=[r,e,t,i];n="array"}if(n==="string"){return this.parse(y(r)||c._default)}if(n==="array"){g(p.rgba.props,function(e,t){o[t.idx]=v(r[t.idx],t)});return this}if(n==="object"){if(r instanceof h){g(p,function(e,t){if(r[t.cache]){s[t.cache]=r[t.cache].slice()}})}else{g(p,function(e,i){var n=i.cache;g(i.props,function(e,t){if(!s[n]&&i.to){if(e==="alpha"||r[e]==null){return}s[n]=i.to(s._rgba)}s[n][t.idx]=v(r[e],t,true)});if(s[n]&&u.inArray(null,s[n].slice(0,3))<0){if(s[n][3]==null){s[n][3]=1}if(i.from){s._rgba=i.from(s[n])}}})}return this}},is:function(e){var r=h(e),s=true,o=this;g(p,function(e,t){var i,n=r[t.cache];if(n){i=o[t.cache]||t.to&&t.to(o._rgba)||[];g(t.props,function(e,t){if(n[t.idx]!=null){s=n[t.idx]===i[t.idx];return s}})}return s});return s},_space:function(){var i=[],n=this;g(p,function(e,t){if(n[t.cache]){i.push(e)}});return i.pop()},transition:function(e,o){var a=h(e),t=a._space(),i=p[t],n=this.alpha()===0?h("transparent"):this,l=n[i.cache]||i.to(n._rgba),c=l.slice();a=a[i.cache];g(i.props,function(e,t){var i=t.idx,n=l[i],r=a[i],s=f[t.type]||{};if(r===null){return}if(n===null){c[i]=r}else{if(s.mod){if(r-n>s.mod/2){n+=s.mod}else if(n-r>s.mod/2){n-=s.mod}}c[i]=v((r-n)*o+n,t)}});return this[t](c)},blend:function(e){if(this._rgba[3]===1){return this}var t=this._rgba.slice(),i=t.pop(),n=h(e)._rgba;return h(u.map(t,function(e,t){return(1-i)*n[t]+i*e}))},toRgbaString:function(){var e="rgba(",t=u.map(this._rgba,function(e,t){if(e!=null){return e}return t>2?1:0});if(t[3]===1){t.pop();e="rgb("}return e+t.join()+")"},toHslaString:function(){var e="hsla(",t=u.map(this.hsla(),function(e,t){if(e==null){e=t>2?1:0}if(t&&t<3){e=Math.round(e*100)+"%"}return e});if(t[3]===1){t.pop();e="hsl("}return e+t.join()+")"},toHexString:function(e){var t=this._rgba.slice(),i=t.pop();if(e){t.push(~~(i*255))}return"#"+u.map(t,function(e){e=(e||0).toString(16);return e.length===1?"0"+e:e}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}});h.fn.parse.prototype=h.fn;function b(e,t,i){i=(i+1)%1;if(i*6<1){return e+(t-e)*i*6}if(i*2<1){return t}if(i*3<2){return e+(t-e)*(2/3-i)*6}return e}p.hsla.to=function(e){if(e[0]==null||e[1]==null||e[2]==null){return[null,null,null,e[3]]}var t=e[0]/255,i=e[1]/255,n=e[2]/255,r=e[3],s=Math.max(t,i,n),o=Math.min(t,i,n),a=s-o,l=s+o,c=l*.5,u,d;if(o===s){u=0}else if(t===s){u=60*(i-n)/a+360}else if(i===s){u=60*(n-t)/a+120}else{u=60*(t-i)/a+240}if(a===0){d=0}else if(c<=.5){d=a/l}else{d=a/(2-l)}return[Math.round(u)%360,d,c,r==null?1:r]};p.hsla.from=function(e){if(e[0]==null||e[1]==null||e[2]==null){return[null,null,null,e[3]]}var t=e[0]/360,i=e[1],n=e[2],r=e[3],s=n<=.5?n*(1+i):n+i-n*i,o=2*n-s;return[Math.round(b(o,s,t+1/3)*255),Math.round(b(o,s,t)*255),Math.round(b(o,s,t-1/3)*255),r]};g(p,function(l,e){var i=e.props,o=e.cache,a=e.to,c=e.from;h.fn[l]=function(e){if(a&&!this[o]){this[o]=a(this._rgba)}if(e===undefined){return this[o].slice()}var t,n=m(e),r=n==="array"||n==="object"?e:arguments,s=this[o].slice();g(i,function(e,t){var i=r[n==="object"?e:t.idx];if(i==null){i=s[t.idx]}s[t.idx]=v(i,t)});if(c){t=h(c(s));t[o]=s;return t}else{return h(s)}};g(i,function(o,a){if(h.fn[o]){return}h.fn[o]=function(e){var t,i,n,r,s=m(e);if(o==="alpha"){r=this._hsla?"hsla":"rgba"}else{r=l}t=this[r]();i=t[a.idx];if(s==="undefined"){return i}if(s==="function"){e=e.call(this,i);s=m(e)}if(e==null&&a.empty){return this}if(s==="string"){n=d.exec(e);if(n){e=i+parseFloat(n[2])*(n[1]==="+"?1:-1)}}t[a.idx]=e;return this[r](t)}})});h.hook=function(e){var t=e.split(" ");g(t,function(e,s){u.cssHooks[s]={set:function(e,t){var i,n,r="";if(t!=="transparent"&&(m(t)!=="string"||(i=y(t)))){t=h(i||t);if(!l.rgba&&t._rgba[3]!==1){n=s==="backgroundColor"?e.parentNode:e;while((r===""||r==="transparent")&&n&&n.style){try{r=u.css(n,"backgroundColor");n=n.parentNode}catch(e){}}t=t.blend(r&&r!=="transparent"?r:"_default")}t=t.toRgbaString()}try{e.style[s]=t}catch(e){}}};u.fx.step[s]=function(e){if(!e.colorInit){e.start=h(e.elem,s);e.end=h(e.end);e.colorInit=true}u.cssHooks[s].set(e.elem,e.start.transition(e.end,e.pos))}})};h.hook(e);u.cssHooks.borderColor={expand:function(i){var n={};g(["Top","Right","Bottom","Left"],function(e,t){n["border"+t+"Color"]=i});return n}};c=u.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"};var C="ui-effects-",w="ui-effects-style",_="ui-effects-animated";te.effects={effect:{}};(function(){var o=["add","remove","toggle"],s={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};te.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,t){te.fx.step[t]=function(e){if(e.end!=="none"&&!e.setAttr||e.pos===1&&!e.setAttr){u.style(e.elem,t,e.end);e.setAttr=true}}});function a(e){return e.replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()})}function l(e){var t,i,n=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,r={};if(n&&n.length&&n[0]&&n[n[0]]){i=n.length;while(i--){t=n[i];if(typeof n[t]==="string"){r[a(t)]=n[t]}}}else{for(t in n){if(typeof n[t]==="string"){r[t]=n[t]}}}return r}function c(e,t){var i={},n,r;for(n in t){r=t[n];if(e[n]!==r){if(!s[n]){if(te.fx.step[n]||!isNaN(parseFloat(r))){i[n]=r}}}}return i}if(!te.fn.addBack){te.fn.addBack=function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}te.effects.animateClass=function(r,e,t,i){var s=te.speed(e,t,i);return this.queue(function(){var i=te(this),e=i.attr("class")||"",t,n=s.children?i.find("*").addBack():i;n=n.map(function(){var e=te(this);return{el:e,start:l(this)}});t=function(){te.each(o,function(e,t){if(r[t]){i[t+"Class"](r[t])}})};t();n=n.map(function(){this.end=l(this.el[0]);this.diff=c(this.start,this.end);return this});i.attr("class",e);n=n.map(function(){var e=this,t=te.Deferred(),i=te.extend({},s,{queue:false,complete:function(){t.resolve(e)}});this.el.animate(this.diff,i);return t.promise()});te.when.apply(te,n.get()).done(function(){t();te.each(arguments,function(){var t=this.el;te.each(this.diff,function(e){t.css(e,"")})});s.complete.call(i[0])})})};te.fn.extend({addClass:function(r){return function(e,t,i,n){return t?te.effects.animateClass.call(this,{add:e},t,i,n):r.apply(this,arguments)}}(te.fn.addClass),removeClass:function(r){return function(e,t,i,n){return arguments.length>1?te.effects.animateClass.call(this,{remove:e},t,i,n):r.apply(this,arguments)}}(te.fn.removeClass),toggleClass:function(s){return function(e,t,i,n,r){if(typeof t==="boolean"||t===undefined){if(!i){return s.apply(this,arguments)}else{return te.effects.animateClass.call(this,t?{add:e}:{remove:e},i,n,r)}}else{return te.effects.animateClass.call(this,{toggle:e},t,i,n)}}}(te.fn.toggleClass),switchClass:function(e,t,i,n,r){return te.effects.animateClass.call(this,{add:t,remove:e},i,n,r)}})})();(function(){if(te.expr&&te.expr.pseudos&&te.expr.pseudos.animated){te.expr.pseudos.animated=function(t){return function(e){return!!te(e).data(_)||t(e)}}(te.expr.pseudos.animated)}if(te.uiBackCompat!==false){te.extend(te.effects,{save:function(e,t){var i=0,n=t.length;for(;i<n;i++){if(t[i]!==null){e.data(C+t[i],e[0].style[t[i]])}}},restore:function(e,t){var i,n=0,r=t.length;for(;n<r;n++){if(t[n]!==null){i=e.data(C+t[n]);e.css(t[n],i)}}},setMode:function(e,t){if(t==="toggle"){t=e.is(":hidden")?"show":"hide"}return t},createWrapper:function(i){if(i.parent().is(".ui-effects-wrapper")){return i.parent()}var n={width:i.outerWidth(true),height:i.outerHeight(true),float:i.css("float")},e=te("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),t={width:i.width(),height:i.height()},r=document.activeElement;try{r.id}catch(e){r=document.body}i.wrap(e);if(i[0]===r||te.contains(i[0],r)){te(r).trigger("focus")}e=i.parent();if(i.css("position")==="static"){e.css({position:"relative"});i.css({position:"relative"})}else{te.extend(n,{position:i.css("position"),zIndex:i.css("z-index")});te.each(["top","left","bottom","right"],function(e,t){n[t]=i.css(t);if(isNaN(parseInt(n[t],10))){n[t]="auto"}});i.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}i.css(t);return e.css(n).show()},removeWrapper:function(e){var t=document.activeElement;if(e.parent().is(".ui-effects-wrapper")){e.parent().replaceWith(e);if(e[0]===t||te.contains(e[0],t)){te(t).trigger("focus")}}return e}})}te.extend(te.effects,{version:"1.13.1",define:function(e,t,i){if(!i){i=t;t="effect"}te.effects.effect[e]=i;te.effects.effect[e].mode=t;return i},scaledDimensions:function(e,t,i){if(t===0){return{height:0,width:0,outerHeight:0,outerWidth:0}}var n=i!=="horizontal"?(t||100)/100:1,r=i!=="vertical"?(t||100)/100:1;return{height:e.height()*r,width:e.width()*n,outerHeight:e.outerHeight()*r,outerWidth:e.outerWidth()*n}},clipToBox:function(e){return{width:e.clip.right-e.clip.left,height:e.clip.bottom-e.clip.top,left:e.clip.left,top:e.clip.top}},unshift:function(e,t,i){var n=e.queue();if(t>1){n.splice.apply(n,[1,0].concat(n.splice(t,i)))}e.dequeue()},saveStyle:function(e){e.data(w,e[0].style.cssText)},restoreStyle:function(e){e[0].style.cssText=e.data(w)||"";e.removeData(w)},mode:function(e,t){var i=e.is(":hidden");if(t==="toggle"){t=i?"show":"hide"}if(i?t==="hide":t==="show"){t="none"}return t},getBaseline:function(e,t){var i,n;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=e[1]/t.width}return{x:n,y:i}},createPlaceholder:function(e){var t,i=e.css("position"),n=e.position();e.css({marginTop:e.css("marginTop"),marginBottom:e.css("marginBottom"),marginLeft:e.css("marginLeft"),marginRight:e.css("marginRight")}).outerWidth(e.outerWidth()).outerHeight(e.outerHeight());if(/^(static|relative)/.test(i)){i="absolute";t=te("<"+e[0].nodeName+">").insertAfter(e).css({display:/^(inline|ruby)/.test(e.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:e.css("marginTop"),marginBottom:e.css("marginBottom"),marginLeft:e.css("marginLeft"),marginRight:e.css("marginRight"),float:e.css("float")}).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).addClass("ui-effects-placeholder");e.data(C+"placeholder",t)}e.css({position:i,left:n.left,top:n.top});return t},removePlaceholder:function(e){var t=C+"placeholder",i=e.data(t);if(i){i.remove();e.removeData(t)}},cleanUp:function(e){te.effects.restoreStyle(e);te.effects.removePlaceholder(e)},setTransition:function(n,e,r,s){s=s||{};te.each(e,function(e,t){var i=n.cssUnit(t);if(i[0]>0){s[t]=i[0]*r+i[1]}});return s}});function u(e,t,i,n){if(te.isPlainObject(e)){t=e;e=e.effect}e={effect:e};if(t==null){t={}}if(typeof t==="function"){n=t;i=null;t={}}if(typeof t==="number"||te.fx.speeds[t]){n=i;i=t;t={}}if(typeof i==="function"){n=i;i=null}if(t){te.extend(e,t)}i=i||t.duration;e.duration=te.fx.off?0:typeof i==="number"?i:i in te.fx.speeds?te.fx.speeds[i]:te.fx.speeds._default;e.complete=n||t.complete;return e}function n(e){if(!e||typeof e==="number"||te.fx.speeds[e]){return true}if(typeof e==="string"&&!te.effects.effect[e]){return true}if(typeof e==="function"){return true}if(typeof e==="object"&&!e.effect){return true}return false}te.fn.extend({effect:function(){var r=u.apply(this,arguments),s=te.effects.effect[r.effect],o=s.mode,e=r.queue,t=e||"fx",a=r.complete,l=r.mode,c=[],i=function(e){var t=te(this),i=te.effects.mode(t,l)||o;t.data(_,true);c.push(i);if(o&&(i==="show"||i===o&&i==="hide")){t.show()}if(!o||i!=="none"){te.effects.saveStyle(t)}if(typeof e==="function"){e()}};if(te.fx.off||!s){if(l){return this[l](r.duration,a)}else{return this.each(function(){if(a){a.call(this)}})}}function n(e){var t=te(this);function i(){t.removeData(_);te.effects.cleanUp(t);if(r.mode==="hide"){t.hide()}n()}function n(){if(typeof a==="function"){a.call(t[0])}if(typeof e==="function"){e()}}r.mode=c.shift();if(te.uiBackCompat!==false&&!o){if(t.is(":hidden")?l==="hide":l==="show"){t[l]();n()}else{s.call(t[0],r,n)}}else{if(r.mode==="none"){t[l]();n()}else{s.call(t[0],r,i)}}}return e===false?this.each(i).each(n):this.queue(t,i).queue(t,n)},show:function(i){return function(e){if(n(e)){return i.apply(this,arguments)}else{var t=u.apply(this,arguments);t.mode="show";return this.effect.call(this,t)}}}(te.fn.show),hide:function(i){return function(e){if(n(e)){return i.apply(this,arguments)}else{var t=u.apply(this,arguments);t.mode="hide";return this.effect.call(this,t)}}}(te.fn.hide),toggle:function(i){return function(e){if(n(e)||typeof e==="boolean"){return i.apply(this,arguments)}else{var t=u.apply(this,arguments);t.mode="toggle";return this.effect.call(this,t)}}}(te.fn.toggle),cssUnit:function(e){var i=this.css(e),n=[];te.each(["em","px","%","pt"],function(e,t){if(i.indexOf(t)>0){n=[parseFloat(i),t]}});return n},cssClip:function(e){if(e){return this.css("clip","rect("+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px)")}return t(this.css("clip"),this)},transfer:function(e,t){var i=te(this),n=te(e.to),r=n.css("position")==="fixed",s=te("body"),o=r?s.scrollTop():0,a=r?s.scrollLeft():0,l=n.offset(),c={top:l.top-o,left:l.left-a,height:n.innerHeight(),width:n.innerWidth()},u=i.offset(),d=te("<div class='ui-effects-transfer'></div>");d.appendTo("body").addClass(e.className).css({top:u.top-o,left:u.left-a,height:i.innerHeight(),width:i.innerWidth(),position:r?"fixed":"absolute"}).animate(c,e.duration,e.easing,function(){d.remove();if(typeof t==="function"){t()}})}});function t(e,t){var i=t.outerWidth(),n=t.outerHeight(),r=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/,s=r.exec(e)||["",0,i,n,0];return{top:parseFloat(s[1])||0,right:s[2]==="auto"?i:parseFloat(s[2]),bottom:s[3]==="auto"?n:parseFloat(s[3]),left:parseFloat(s[4])||0}}te.fx.step.clip=function(e){if(!e.clipInit){e.start=te(e.elem).cssClip();if(typeof e.end==="string"){e.end=t(e.end,e.elem)}e.clipInit=true}te(e.elem).cssClip({top:e.pos*(e.end.top-e.start.top)+e.start.top,right:e.pos*(e.end.right-e.start.right)+e.start.right,bottom:e.pos*(e.end.bottom-e.start.bottom)+e.start.bottom,left:e.pos*(e.end.left-e.start.left)+e.start.left})}})();(function(){var i={};te.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,e){i[e]=function(e){return Math.pow(e,t+2)}});te.extend(i,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return e===0||e===1?e:-Math.pow(2,8*(e-1))*Math.sin(((e-1)*80-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){var t,i=4;while(e<((t=Math.pow(2,--i))-1)/11){}return 1/Math.pow(4,3-i)-7.5625*Math.pow((t*3-2)/22-e,2)}});te.each(i,function(e,t){te.easing["easeIn"+e]=t;te.easing["easeOut"+e]=function(e){return 1-t(1-e)};te.easing["easeInOut"+e]=function(e){return e<.5?t(e*2)/2:1-t(e*-2+2)/2}})})();var A=te.effects;var H=te.effects.define("blind","hide",function(e,t){var i={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},n=te(this),r=e.direction||"up",s=n.cssClip(),o={clip:te.extend({},s)},a=te.effects.createPlaceholder(n);o.clip[i[r][0]]=o.clip[i[r][1]];if(e.mode==="show"){n.cssClip(o.clip);if(a){a.css(te.effects.clipToBox(o))}o.clip=s}if(a){a.animate(te.effects.clipToBox(o),e.duration,e.easing)}n.animate(o,{queue:false,duration:e.duration,easing:e.easing,complete:t})});var B=te.effects.define("bounce",function(e,t){var i,n,r,s=te(this),o=e.mode,a=o==="hide",l=o==="show",c=e.direction||"up",u=e.distance,d=e.times||5,h=d*2+(l||a?1:0),p=e.duration/h,f=e.easing,g=c==="up"||c==="down"?"top":"left",m=c==="up"||c==="left",v=0,y=s.queue().length;te.effects.createPlaceholder(s);r=s.css(g);if(!u){u=s[g==="top"?"outerHeight":"outerWidth"]()/3}if(l){n={opacity:1};n[g]=r;s.css("opacity",0).css(g,m?-u*2:u*2).animate(n,p,f)}if(a){u=u/Math.pow(2,d-1)}n={};n[g]=r;for(;v<d;v++){i={};i[g]=(m?"-=":"+=")+u;s.animate(i,p,f).animate(n,p,f);u=a?u*2:u/2}if(a){i={opacity:0};i[g]=(m?"-=":"+=")+u;s.animate(i,p,f)}s.queue(t);te.effects.unshift(s,y,h+1)});var V=te.effects.define("clip","hide",function(e,t){var i,n={},r=te(this),s=e.direction||"vertical",o=s==="both",a=o||s==="horizontal",l=o||s==="vertical";i=r.cssClip();n.clip={top:l?(i.bottom-i.top)/2:i.top,right:a?(i.right-i.left)/2:i.right,bottom:l?(i.bottom-i.top)/2:i.bottom,left:a?(i.right-i.left)/2:i.left};te.effects.createPlaceholder(r);if(e.mode==="show"){r.cssClip(n.clip);n.clip=i}r.animate(n,{queue:false,duration:e.duration,easing:e.easing,complete:t})});var W=te.effects.define("drop","hide",function(e,t){var i,n=te(this),r=e.mode,s=r==="show",o=e.direction||"left",a=o==="up"||o==="down"?"top":"left",l=o==="up"||o==="left"?"-=":"+=",c=l==="+="?"-=":"+=",u={opacity:0};te.effects.createPlaceholder(n);i=e.distance||n[a==="top"?"outerHeight":"outerWidth"](true)/2;u[a]=l+i;if(s){n.css(u);u[a]=c+i;u.opacity=1}n.animate(u,{queue:false,duration:e.duration,easing:e.easing,complete:t})});var z=te.effects.define("explode","hide",function(e,t){var i,n,r,s,o,a,l=e.pieces?Math.round(Math.sqrt(e.pieces)):3,c=l,u=te(this),d=e.mode,h=d==="show",p=u.show().css("visibility","hidden").offset(),f=Math.ceil(u.outerWidth()/c),g=Math.ceil(u.outerHeight()/l),m=[];function v(){m.push(this);if(m.length===l*c){y()}}for(i=0;i<l;i++){s=p.top+i*g;a=i-(l-1)/2;for(n=0;n<c;n++){r=p.left+n*f;o=n-(c-1)/2;u.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-n*f,top:-i*g}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:f,height:g,left:r+(h?o*f:0),top:s+(h?a*g:0),opacity:h?0:1}).animate({left:r+(h?0:o*f),top:s+(h?0:a*g),opacity:h?1:0},e.duration||500,e.easing,v)}}function y(){u.css({visibility:"visible"});te(m).remove();t()}});var j=te.effects.define("fade","toggle",function(e,t){var i=e.mode==="show";te(this).css("opacity",i?0:1).animate({opacity:i?1:0},{queue:false,duration:e.duration,easing:e.easing,complete:t})});var U=te.effects.define("fold","hide",function(t,e){var i=te(this),n=t.mode,r=n==="show",s=n==="hide",o=t.size||15,a=/([0-9]+)%/.exec(o),l=!!t.horizFirst,c=l?["right","bottom"]:["bottom","right"],u=t.duration/2,d=te.effects.createPlaceholder(i),h=i.cssClip(),p={clip:te.extend({},h)},f={clip:te.extend({},h)},g=[h[c[0]],h[c[1]]],m=i.queue().length;if(a){o=parseInt(a[1],10)/100*g[s?0:1]}p.clip[c[0]]=o;f.clip[c[0]]=o;f.clip[c[1]]=0;if(r){i.cssClip(f.clip);if(d){d.css(te.effects.clipToBox(f))}f.clip=h}i.queue(function(e){if(d){d.animate(te.effects.clipToBox(p),u,t.easing).animate(te.effects.clipToBox(f),u,t.easing)}e()}).animate(p,u,t.easing).animate(f,u,t.easing).queue(e);te.effects.unshift(i,m,4)});var Y=te.effects.define("highlight","show",function(e,t){var i=te(this),n={backgroundColor:i.css("backgroundColor")};if(e.mode==="hide"){n.opacity=0}te.effects.saveStyle(i);i.css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(n,{queue:false,duration:e.duration,easing:e.easing,complete:t})});var q=te.effects.define("size",function(r,t){var e,s,i,n=te(this),o=["fontSize"],a=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],l=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],c=r.mode,u=c!=="effect",d=r.scale||"both",h=r.origin||["middle","center"],p=n.css("position"),f=n.position(),g=te.effects.scaledDimensions(n),m=r.from||g,v=r.to||te.effects.scaledDimensions(n,0);te.effects.createPlaceholder(n);if(c==="show"){i=m;m=v;v=i}s={from:{y:m.height/g.height,x:m.width/g.width},to:{y:v.height/g.height,x:v.width/g.width}};if(d==="box"||d==="both"){if(s.from.y!==s.to.y){m=te.effects.setTransition(n,a,s.from.y,m);v=te.effects.setTransition(n,a,s.to.y,v)}if(s.from.x!==s.to.x){m=te.effects.setTransition(n,l,s.from.x,m);v=te.effects.setTransition(n,l,s.to.x,v)}}if(d==="content"||d==="both"){if(s.from.y!==s.to.y){m=te.effects.setTransition(n,o,s.from.y,m);v=te.effects.setTransition(n,o,s.to.y,v)}}if(h){e=te.effects.getBaseline(h,g);m.top=(g.outerHeight-m.outerHeight)*e.y+f.top;m.left=(g.outerWidth-m.outerWidth)*e.x+f.left;v.top=(g.outerHeight-v.outerHeight)*e.y+f.top;v.left=(g.outerWidth-v.outerWidth)*e.x+f.left}delete m.outerHeight;delete m.outerWidth;n.css(m);if(d==="content"||d==="both"){a=a.concat(["marginTop","marginBottom"]).concat(o);l=l.concat(["marginLeft","marginRight"]);n.find("*[width]").each(function(){var e=te(this),t=te.effects.scaledDimensions(e),i={height:t.height*s.from.y,width:t.width*s.from.x,outerHeight:t.outerHeight*s.from.y,outerWidth:t.outerWidth*s.from.x},n={height:t.height*s.to.y,width:t.width*s.to.x,outerHeight:t.height*s.to.y,outerWidth:t.width*s.to.x};if(s.from.y!==s.to.y){i=te.effects.setTransition(e,a,s.from.y,i);n=te.effects.setTransition(e,a,s.to.y,n)}if(s.from.x!==s.to.x){i=te.effects.setTransition(e,l,s.from.x,i);n=te.effects.setTransition(e,l,s.to.x,n)}if(u){te.effects.saveStyle(e)}e.css(i);e.animate(n,r.duration,r.easing,function(){if(u){te.effects.restoreStyle(e)}})})}n.animate(v,{queue:false,duration:r.duration,easing:r.easing,complete:function(){var e=n.offset();if(v.opacity===0){n.css("opacity",m.opacity)}if(!u){n.css("position",p==="static"?"relative":p).offset(e);te.effects.saveStyle(n)}t()}})});var K=te.effects.define("scale",function(e,t){var i=te(this),n=e.mode,r=parseInt(e.percent,10)||(parseInt(e.percent,10)===0?0:n!=="effect"?0:100),s=te.extend(true,{from:te.effects.scaledDimensions(i),to:te.effects.scaledDimensions(i,r,e.direction||"both"),origin:e.origin||["middle","center"]},e);if(e.fade){s.from.opacity=1;s.to.opacity=0}te.effects.effect.size.call(this,s,t)});var X=te.effects.define("puff","hide",function(e,t){var i=te.extend(true,{},e,{fade:true,percent:parseInt(e.percent,10)||150});te.effects.effect.scale.call(this,i,t)});var Q=te.effects.define("pulsate","show",function(e,t){var i=te(this),n=e.mode,r=n==="show",s=n==="hide",o=r||s,a=(e.times||5)*2+(o?1:0),l=e.duration/a,c=0,u=1,d=i.queue().length;if(r||!i.is(":visible")){i.css("opacity",0).show();c=1}for(;u<a;u++){i.animate({opacity:c},l,e.easing);c=1-c}i.animate({opacity:c},l,e.easing);i.queue(t);te.effects.unshift(i,d,a+1)});var Z=te.effects.define("shake",function(e,t){var i=1,n=te(this),r=e.direction||"left",s=e.distance||20,o=e.times||3,a=o*2+1,l=Math.round(e.duration/a),c=r==="up"||r==="down"?"top":"left",u=r==="up"||r==="left",d={},h={},p={},f=n.queue().length;te.effects.createPlaceholder(n);d[c]=(u?"-=":"+=")+s;h[c]=(u?"+=":"-=")+s*2;p[c]=(u?"-=":"+=")+s*2;n.animate(d,l,e.easing);for(;i<o;i++){n.animate(h,l,e.easing).animate(p,l,e.easing)}n.animate(h,l,e.easing).animate(d,l/2,e.easing).queue(t);te.effects.unshift(n,f,a+1)});var J=te.effects.define("slide","show",function(e,t){var i,n,r=te(this),s={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},o=e.mode,a=e.direction||"left",l=a==="up"||a==="down"?"top":"left",c=a==="up"||a==="left",u=e.distance||r[l==="top"?"outerHeight":"outerWidth"](true),d={};te.effects.createPlaceholder(r);i=r.cssClip();n=r.position()[l];d[l]=(c?-1:1)*u+n;d.clip=r.cssClip();d.clip[s[a][1]]=d.clip[s[a][0]];if(o==="show"){r.cssClip(d.clip);r.css(l,d[l]);d.clip=i;d[l]=n}r.animate(d,{queue:false,duration:e.duration,easing:e.easing,complete:t})});var A;if(te.uiBackCompat!==false){A=te.effects.define("transfer",function(e,t){te(this).transfer(e,t)})}var ee=A;te.ui.focusable=function(e,t){var i,n,r,s,o,a=e.nodeName.toLowerCase();if("area"===a){i=e.parentNode;n=i.name;if(!e.href||!n||i.nodeName.toLowerCase()!=="map"){return false}r=te("img[usemap='#"+n+"']");return r.length>0&&r.is(":visible")}if(/^(input|select|textarea|button|object)$/.test(a)){s=!e.disabled;if(s){o=te(e).closest("fieldset")[0];if(o){s=!o.disabled}}}else if("a"===a){s=e.href||t}else{s=t}return s&&te(e).is(":visible")&&E(te(e))};function E(e){var t=e.css("visibility");while(t==="inherit"){e=e.parent();t=e.css("visibility")}return t==="visible"}te.extend(te.expr.pseudos,{focusable:function(e){return te.ui.focusable(e,te.attr(e,"tabindex")!=null)}});var ie=te.ui.focusable;var ne=te.fn._form=function(){return typeof this[0].form==="string"?this.closest("form"):te(this[0].form)};var re=te.ui.formResetMixin={_formResetHandler:function(){var t=te(this);setTimeout(function(){var e=t.data("ui-form-reset-instances");te.each(e,function(){this.refresh()})})},_bindFormResetHandler:function(){this.form=this.element._form();if(!this.form.length){return}var e=this.form.data("ui-form-reset-instances")||[];if(!e.length){this.form.on("reset.ui-form-reset",this._formResetHandler)}e.push(this);this.form.data("ui-form-reset-instances",e)},_unbindFormResetHandler:function(){if(!this.form.length){return}var e=this.form.data("ui-form-reset-instances");e.splice(te.inArray(this,e),1);if(e.length){this.form.data("ui-form-reset-instances",e)}else{this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}};if(!te.expr.pseudos){te.expr.pseudos=te.expr[":"]}if(!te.uniqueSort){te.uniqueSort=te.unique}if(!te.escapeSelector){var S=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;var T=function(e,t){if(t){if(e==="\0"){return""}return e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" "}return"\\"+e};te.escapeSelector=function(e){return(e+"").replace(S,T)}}if(!te.fn.even||!te.fn.odd){te.fn.extend({even:function(){return this.filter(function(e){return e%2===0})},odd:function(){return this.filter(function(e){return e%2===1})}})}var se=te.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38};var oe=te.fn.labels=function(){var e,t,i,n,r;if(!this.length){return this.pushStack([])}if(this[0].labels&&this[0].labels.length){return this.pushStack(this[0].labels)}n=this.eq(0).parents("label");i=this.attr("id");if(i){e=this.eq(0).parents().last();r=e.add(e.length?e.siblings():this.siblings());t="label[for='"+te.escapeSelector(i)+"']";n=n.add(r.find(t).addBack(t))}return this.pushStack(n)};var ae=te.fn.scrollParent=function(e){var t=this.css("position"),i=t==="absolute",n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,r=this.parents().filter(function(){var e=te(this);if(i&&e.css("position")==="static"){return false}return n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return t==="fixed"||!r.length?te(this[0].ownerDocument||document):r};var le=te.extend(te.expr.pseudos,{tabbable:function(e){var t=te.attr(e,"tabindex"),i=t!=null;return(!i||t>=0)&&te.ui.focusable(e,i)}});var ce=te.fn.extend({uniqueId:function(){var e=0;return function(){return this.each(function(){if(!this.id){this.id="ui-id-"+ ++e}})}}(),removeUniqueId:function(){return this.each(function(){if(/^ui-id-\d+$/.test(this.id)){te(this).removeAttr("id")}})}});var ue=te.widget("ui.accordion",{version:"1.13.1",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:false,event:"click",header:function(e){return e.find("> li > :first-child").add(e.find("> :not(li)").even())},heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var e=this.options;this.prevShow=this.prevHide=te();this._addClass("ui-accordion","ui-widget ui-helper-reset");this.element.attr("role","tablist");if(!e.collapsible&&(e.active===false||e.active==null)){e.active=0}this._processPanels();if(e.active<0){e.active+=this.headers.length}this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:!this.active.length?te():this.active.next()}},_createIcons:function(){var e,t,i=this.options.icons;if(i){e=te("<span>");this._addClass(e,"ui-accordion-header-icon","ui-icon "+i.header);e.prependTo(this.headers);t=this.active.children(".ui-accordion-header-icon");this._removeClass(t,i.header)._addClass(t,null,i.activeHeader)._addClass(this.headers,"ui-accordion-icons")}},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons");this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeAttr("role");this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId();this._destroyIcons();e=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId();if(this.options.heightStyle!=="content"){e.css("height","")}},_setOption:function(e,t){if(e==="active"){this._activate(t);return}if(e==="event"){if(this.options.event){this._off(this.headers,this.options.event)}this._setupEvents(t)}this._super(e,t);if(e==="collapsible"&&!t&&this.options.active===false){this._activate(0)}if(e==="icons"){this._destroyIcons();if(t){this._createIcons()}}},_setOptionDisabled:function(e){this._super(e);this.element.attr("aria-disabled",e);this._toggleClass(null,"ui-state-disabled",!!e);this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!e)},_keydown:function(e){if(e.altKey||e.ctrlKey){return}var t=te.ui.keyCode,i=this.headers.length,n=this.headers.index(e.target),r=false;switch(e.keyCode){case t.RIGHT:case t.DOWN:r=this.headers[(n+1)%i];break;case t.LEFT:case t.UP:r=this.headers[(n-1+i)%i];break;case t.SPACE:case t.ENTER:this._eventHandler(e);break;case t.HOME:r=this.headers[0];break;case t.END:r=this.headers[i-1];break}if(r){te(e.target).attr("tabIndex",-1);te(r).attr("tabIndex",0);te(r).trigger("focus");e.preventDefault()}},_panelKeyDown:function(e){if(e.keyCode===te.ui.keyCode.UP&&e.ctrlKey){te(e.currentTarget).prev().trigger("focus")}},refresh:function(){var e=this.options;this._processPanels();if(e.active===false&&e.collapsible===true||!this.headers.length){e.active=false;this.active=te()}else if(e.active===false){this._activate(0)}else if(this.active.length&&!te.contains(this.element[0],this.active[0])){if(this.headers.length===this.headers.find(".ui-state-disabled").length){e.active=false;this.active=te()}else{this._activate(Math.max(0,e.active-1))}}else{e.active=this.headers.index(this.active)}this._destroyIcons();this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;if(typeof this.options.header==="function"){this.headers=this.options.header(this.element)}else{this.headers=this.element.find(this.options.header)}this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default");this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide();this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content");if(t){this._off(e.not(this.headers));this._off(t.not(this.panels))}},_refresh:function(){var i,e=this.options,t=e.heightStyle,n=this.element.parent();this.active=this._findActive(e.active);this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed");this._addClass(this.active.next(),"ui-accordion-content-active");this.active.next().show();this.headers.attr("role","tab").each(function(){var e=te(this),t=e.uniqueId().attr("id"),i=e.next(),n=i.uniqueId().attr("id");e.attr("aria-controls",n);i.attr("aria-labelledby",t)}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide();if(!this.active.length){this.headers.eq(0).attr("tabIndex",0)}else{this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"})}this._createIcons();this._setupEvents(e.event);if(t==="fill"){i=n.height();this.element.siblings(":visible").each(function(){var e=te(this),t=e.css("position");if(t==="absolute"||t==="fixed"){return}i-=e.outerHeight(true)});this.headers.each(function(){i-=te(this).outerHeight(true)});this.headers.next().each(function(){te(this).height(Math.max(0,i-te(this).innerHeight()+te(this).height()))}).css("overflow","auto")}else if(t==="auto"){i=0;this.headers.next().each(function(){var e=te(this).is(":visible");if(!e){te(this).show()}i=Math.max(i,te(this).css("height","").height());if(!e){te(this).hide()}}).height(i)}},_activate:function(e){var t=this._findActive(e)[0];if(t===this.active[0]){return}t=t||this.active[0];this._eventHandler({target:t,currentTarget:t,preventDefault:te.noop})},_findActive:function(e){return typeof e==="number"?this.headers.eq(e):te()},_setupEvents:function(e){var i={keydown:"_keydown"};if(e){te.each(e.split(" "),function(e,t){i[t]="_eventHandler"})}this._off(this.headers.add(this.headers.next()));this._on(this.headers,i);this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._hoverable(this.headers);this._focusable(this.headers)},_eventHandler:function(e){var t,i,n=this.options,r=this.active,s=te(e.currentTarget),o=s[0]===r[0],a=o&&n.collapsible,l=a?te():s.next(),c=r.next(),u={oldHeader:r,oldPanel:c,newHeader:a?te():s,newPanel:l};e.preventDefault();if(o&&!n.collapsible||this._trigger("beforeActivate",e,u)===false){return}n.active=a?false:this.headers.index(s);this.active=o?te():s;this._toggle(u);this._removeClass(r,"ui-accordion-header-active","ui-state-active");if(n.icons){t=r.children(".ui-accordion-header-icon");this._removeClass(t,null,n.icons.activeHeader)._addClass(t,null,n.icons.header)}if(!o){this._removeClass(s,"ui-accordion-header-collapsed")._addClass(s,"ui-accordion-header-active","ui-state-active");if(n.icons){i=s.children(".ui-accordion-header-icon");this._removeClass(i,null,n.icons.header)._addClass(i,null,n.icons.activeHeader)}this._addClass(s.next(),"ui-accordion-content-active")}},_toggle:function(e){var t=e.newPanel,i=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(true,true);this.prevShow=t;this.prevHide=i;if(this.options.animate){this._animate(t,i,e)}else{i.hide();t.show();this._toggleComplete(e)}i.attr({"aria-hidden":"true"});i.prev().attr({"aria-selected":"false","aria-expanded":"false"});if(t.length&&i.length){i.prev().attr({tabIndex:-1,"aria-expanded":"false"})}else if(t.length){this.headers.filter(function(){return parseInt(te(this).attr("tabIndex"),10)===0}).attr("tabIndex",-1)}t.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(e,i,t){var n,r,s,o=this,a=0,l=e.css("box-sizing"),c=e.length&&(!i.length||e.index()<i.index()),u=this.options.animate||{},d=c&&u.down||u,h=function(){o._toggleComplete(t)};if(typeof d==="number"){s=d}if(typeof d==="string"){r=d}r=r||d.easing||u.easing;s=s||d.duration||u.duration;if(!i.length){return e.animate(this.showProps,s,r,h)}if(!e.length){return i.animate(this.hideProps,s,r,h)}n=e.show().outerHeight();i.animate(this.hideProps,{duration:s,easing:r,step:function(e,t){t.now=Math.round(e)}});e.hide().animate(this.showProps,{duration:s,easing:r,complete:h,step:function(e,t){t.now=Math.round(e);if(t.prop!=="height"){if(l==="content-box"){a+=t.now}}else if(o.options.heightStyle!=="content"){t.now=Math.round(n-i.outerHeight()-a);a=0}}})},_toggleComplete:function(e){var t=e.oldPanel,i=t.prev();this._removeClass(t,"ui-accordion-content-active");this._removeClass(i,"ui-accordion-header-active")._addClass(i,"ui-accordion-header-collapsed");if(t.length){t.parent()[0].className=t.parent()[0].className}this._trigger("activate",null,e)}});var de=te.ui.safeActiveElement=function(t){var i;try{i=t.activeElement}catch(e){i=t.body}if(!i){i=t.body}if(!i.nodeName){i=t.body}return i};var he=te.widget("ui.menu",{version:"1.13.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=false;this.lastMousePosition={x:null,y:null};this.element.uniqueId().attr({role:this.options.role,tabIndex:0});this._addClass("ui-menu","ui-widget ui-widget-content");this._on({"mousedown .ui-menu-item":function(e){e.preventDefault();this._activateItem(e)},"click .ui-menu-item":function(e){var t=te(e.target);var i=te(te.ui.safeActiveElement(this.document[0]));if(!this.mouseHandled&&t.not(".ui-state-disabled").length){this.select(e);if(!e.isPropagationStopped()){this.mouseHandled=true}if(t.has(".ui-menu").length){this.expand(e)}else if(!this.element.is(":focus")&&i.closest(".ui-menu").length){this.element.trigger("focus",[true]);if(this.active&&this.active.parents(".ui-menu").length===1){clearTimeout(this.timer)}}}},"mouseenter .ui-menu-item":"_activateItem","mousemove .ui-menu-item":"_activateItem",mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this._menuItems().first();if(!t){this.focus(e,i)}},blur:function(t){this._delay(function(){var e=!te.contains(this.element[0],te.ui.safeActiveElement(this.document[0]));if(e){this.collapseAll(t)}})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(e){if(this._closeOnDocumentClick(e)){this.collapseAll(e,true)}this.mouseHandled=false}})},_activateItem:function(e){if(this.previousFilter){return}if(e.clientX===this.lastMousePosition.x&&e.clientY===this.lastMousePosition.y){return}this.lastMousePosition={x:e.clientX,y:e.clientY};var t=te(e.target).closest(".ui-menu-item"),i=te(e.currentTarget);if(t[0]!==i[0]){return}if(i.is(".ui-state-active")){return}this._removeClass(i.siblings().children(".ui-state-active"),null,"ui-state-active");this.focus(e,i)},_destroy:function(){var e=this.element.find(".ui-menu-item").removeAttr("role aria-disabled"),t=e.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled "+"tabIndex").removeUniqueId().show();t.children().each(function(){var e=te(this);if(e.data("ui-menu-submenu-caret")){e.remove()}})},_keydown:function(e){var t,i,n,r,s=true;switch(e.keyCode){case te.ui.keyCode.PAGE_UP:this.previousPage(e);break;case te.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case te.ui.keyCode.HOME:this._move("first","first",e);break;case te.ui.keyCode.END:this._move("last","last",e);break;case te.ui.keyCode.UP:this.previous(e);break;case te.ui.keyCode.DOWN:this.next(e);break;case te.ui.keyCode.LEFT:this.collapse(e);break;case te.ui.keyCode.RIGHT:if(this.active&&!this.active.is(".ui-state-disabled")){this.expand(e)}break;case te.ui.keyCode.ENTER:case te.ui.keyCode.SPACE:this._activate(e);break;case te.ui.keyCode.ESCAPE:this.collapse(e);break;default:s=false;i=this.previousFilter||"";r=false;n=e.keyCode>=96&&e.keyCode<=105?(e.keyCode-96).toString():String.fromCharCode(e.keyCode);clearTimeout(this.filterTimer);if(n===i){r=true}else{n=i+n}t=this._filterMenuItems(n);t=r&&t.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):t;if(!t.length){n=String.fromCharCode(e.keyCode);t=this._filterMenuItems(n)}if(t.length){this.focus(e,t);this.previousFilter=n;this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)}else{delete this.previousFilter}}if(s){e.preventDefault()}},_activate:function(e){if(this.active&&!this.active.is(".ui-state-disabled")){if(this.active.children("[aria-haspopup='true']").length){this.expand(e)}else{this.select(e)}}},refresh:function(){var e,t,i,n,r,s=this,o=this.options.icons.submenu,a=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length);i=a.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=te(this),t=e.prev(),i=te("<span>").data("ui-menu-submenu-caret",true);s._addClass(i,"ui-menu-icon","ui-icon "+o);t.attr("aria-haspopup","true").prepend(i);e.attr("aria-labelledby",t.attr("id"))});this._addClass(i,"ui-menu","ui-widget ui-widget-content ui-front");e=a.add(this.element);t=e.find(this.options.items);t.not(".ui-menu-item").each(function(){var e=te(this);if(s._isDivider(e)){s._addClass(e,"ui-menu-divider","ui-widget-content")}});n=t.not(".ui-menu-item, .ui-menu-divider");r=n.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()});this._addClass(n,"ui-menu-item")._addClass(r,"ui-menu-item-wrapper");t.filter(".ui-state-disabled").attr("aria-disabled","true");if(this.active&&!te.contains(this.element[0],this.active[0])){this.blur()}},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){if(e==="icons"){var i=this.element.find(".ui-menu-icon");this._removeClass(i,null,this.options.icons.submenu)._addClass(i,null,t.submenu)}this._super(e,t)},_setOptionDisabled:function(e){this._super(e);this.element.attr("aria-disabled",String(e));this._toggleClass(null,"ui-state-disabled",!!e)},focus:function(e,t){var i,n,r;this.blur(e,e&&e.type==="focus");this._scrollIntoView(t);this.active=t.first();n=this.active.children(".ui-menu-item-wrapper");this._addClass(n,null,"ui-state-active");if(this.options.role){this.element.attr("aria-activedescendant",n.attr("id"))}r=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper");this._addClass(r,null,"ui-state-active");if(e&&e.type==="keydown"){this._close()}else{this.timer=this._delay(function(){this._close()},this.delay)}i=t.children(".ui-menu");if(i.length&&e&&/^mouse/.test(e.type)){this._startOpening(i)}this.activeMenu=t.parent();this._trigger("focus",e,{item:t})},_scrollIntoView:function(e){var t,i,n,r,s,o;if(this._hasScroll()){t=parseFloat(te.css(this.activeMenu[0],"borderTopWidth"))||0;i=parseFloat(te.css(this.activeMenu[0],"paddingTop"))||0;n=e.offset().top-this.activeMenu.offset().top-t-i;r=this.activeMenu.scrollTop();s=this.activeMenu.height();o=e.outerHeight();if(n<0){this.activeMenu.scrollTop(r+n)}else if(n+o>s){this.activeMenu.scrollTop(r+n-s+o)}}},blur:function(e,t){if(!t){clearTimeout(this.timer)}if(!this.active){return}this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active");this._trigger("blur",e,{item:this.active});this.active=null},_startOpening:function(e){clearTimeout(this.timer);if(e.attr("aria-hidden")!=="true"){return}this.timer=this._delay(function(){this._close();this._open(e)},this.delay)},_open:function(e){var t=te.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true");e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(t)},collapseAll:function(t,i){clearTimeout(this.timer);this.timer=this._delay(function(){var e=i?this.element:te(t&&t.target).closest(this.element.find(".ui-menu"));if(!e.length){e=this.element}this._close(e);this.blur(t);this._removeClass(e.find(".ui-state-active"),null,"ui-state-active");this.activeMenu=e},i?0:this.delay)},_close:function(e){if(!e){e=this.active?this.active.parent():this.element}e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(e){return!te(e.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);if(t&&t.length){this._close();this.focus(e,t)}},expand:function(e){var t=this.active&&this._menuItems(this.active.children(".ui-menu")).first();if(t&&t.length){this._open(t.parent());this._delay(function(){this.focus(e,t)})}},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_menuItems:function(e){return(e||this.element).find(this.options.items).filter(".ui-menu-item")},_move:function(e,t,i){var n;if(this.active){if(e==="first"||e==="last"){n=this.active[e==="first"?"prevAll":"nextAll"](".ui-menu-item").last()}else{n=this.active[e+"All"](".ui-menu-item").first()}}if(!n||!n.length||!this.active){n=this._menuItems(this.activeMenu)[t]()}this.focus(i,n)},nextPage:function(e){var t,i,n;if(!this.active){this.next(e);return}if(this.isLastItem()){return}if(this._hasScroll()){i=this.active.offset().top;n=this.element.innerHeight();if(te.fn.jquery.indexOf("3.2.")===0){n+=this.element[0].offsetHeight-this.element.outerHeight()}this.active.nextAll(".ui-menu-item").each(function(){t=te(this);return t.offset().top-i-n<0});this.focus(e,t)}else{this.focus(e,this._menuItems(this.activeMenu)[!this.active?"first":"last"]())}},previousPage:function(e){var t,i,n;if(!this.active){this.next(e);return}if(this.isFirstItem()){return}if(this._hasScroll()){i=this.active.offset().top;n=this.element.innerHeight();if(te.fn.jquery.indexOf("3.2.")===0){n+=this.element[0].offsetHeight-this.element.outerHeight()}this.active.prevAll(".ui-menu-item").each(function(){t=te(this);return t.offset().top-i+n>0});this.focus(e,t)}else{this.focus(e,this._menuItems(this.activeMenu).first())}},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||te(e.target).closest(".ui-menu-item");var t={item:this.active};if(!this.active.has(".ui-menu").length){this.collapseAll(e,true)}this._trigger("select",e,t)},_filterMenuItems:function(e){var t=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),i=new RegExp("^"+t,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return i.test(String.prototype.trim.call(te(this).children(".ui-menu-item-wrapper").text()))})}});te.widget("ui.autocomplete",{version:"1.13.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,liveRegionTimer:null,_create:function(){var i,n,r,e=this.element[0].nodeName.toLowerCase(),t=e==="textarea",s=e==="input";this.isMultiLine=t||!s&&this._isContentEditable(this.element);this.valueMethod=this.element[t||s?"val":"text"];this.isNewMenu=true;this._addClass("ui-autocomplete-input");this.element.attr("autocomplete","off");this._on(this.element,{keydown:function(e){if(this.element.prop("readOnly")){i=true;r=true;n=true;return}i=false;r=false;n=false;var t=te.ui.keyCode;switch(e.keyCode){case t.PAGE_UP:i=true;this._move("previousPage",e);break;case t.PAGE_DOWN:i=true;this._move("nextPage",e);break;case t.UP:i=true;this._keyEvent("previous",e);break;case t.DOWN:i=true;this._keyEvent("next",e);break;case t.ENTER:if(this.menu.active){i=true;e.preventDefault();this.menu.select(e)}break;case t.TAB:if(this.menu.active){this.menu.select(e)}break;case t.ESCAPE:if(this.menu.element.is(":visible")){if(!this.isMultiLine){this._value(this.term)}this.close(e);e.preventDefault()}break;default:n=true;this._searchTimeout(e);break}},keypress:function(e){if(i){i=false;if(!this.isMultiLine||this.menu.element.is(":visible")){e.preventDefault()}return}if(n){return}var t=te.ui.keyCode;switch(e.keyCode){case t.PAGE_UP:this._move("previousPage",e);break;case t.PAGE_DOWN:this._move("nextPage",e);break;case t.UP:this._keyEvent("previous",e);break;case t.DOWN:this._keyEvent("next",e);break}},input:function(e){if(r){r=false;e.preventDefault();return}this._searchTimeout(e)},focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(e){clearTimeout(this.searching);this.close(e);this._change(e)}});this._initSource();this.menu=te("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().attr({unselectable:"on"}).menu("instance");this._addClass(this.menu.element,"ui-autocomplete","ui-front");this._on(this.menu.element,{mousedown:function(e){e.preventDefault()},menufocus:function(e,t){var i,n;if(this.isNewMenu){this.isNewMenu=false;if(e.originalEvent&&/^mouse/.test(e.originalEvent.type)){this.menu.blur();this.document.one("mousemove",function(){te(e.target).trigger(e.originalEvent)});return}}n=t.item.data("ui-autocomplete-item");if(false!==this._trigger("focus",e,{item:n})){if(e.originalEvent&&/^key/.test(e.originalEvent.type)){this._value(n.value)}}i=t.item.attr("aria-label")||n.value;if(i&&String.prototype.trim.call(i).length){clearTimeout(this.liveRegionTimer);this.liveRegionTimer=this._delay(function(){this.liveRegion.html(te("<div>").text(i))},100)}},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),n=this.previous;if(this.element[0]!==te.ui.safeActiveElement(this.document[0])){this.element.trigger("focus");this.previous=n;this._delay(function(){this.previous=n;this.selectedItem=i})}if(false!==this._trigger("select",e,{item:i})){this._value(i.value)}this.term=this._value();this.close(e);this.selectedItem=i}});this.liveRegion=te("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body);this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible");this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t);if(e==="source"){this._initSource()}if(e==="appendTo"){this.menu.element.appendTo(this._appendTo())}if(e==="disabled"&&t&&this.xhr){this.xhr.abort()}},_isEventTargetInWidget:function(e){var t=this.menu.element[0];return e.target===this.element[0]||e.target===t||te.contains(t,e.target)},_closeOnClickOutside:function(e){if(!this._isEventTargetInWidget(e)){this.close()}},_appendTo:function(){var e=this.options.appendTo;if(e){e=e.jquery||e.nodeType?te(e):this.document.find(e).eq(0)}if(!e||!e[0]){e=this.element.closest(".ui-front, dialog")}if(!e.length){e=this.document[0].body}return e},_initSource:function(){var i,n,r=this;if(Array.isArray(this.options.source)){i=this.options.source;this.source=function(e,t){t(te.ui.autocomplete.filter(i,e.term))}}else if(typeof this.options.source==="string"){n=this.options.source;this.source=function(e,t){if(r.xhr){r.xhr.abort()}r.xhr=te.ajax({url:n,data:e,dataType:"json",success:function(e){t(e)},error:function(){t([])}})}}else{this.source=this.options.source}},_searchTimeout:function(n){clearTimeout(this.searching);this.searching=this._delay(function(){var e=this.term===this._value(),t=this.menu.element.is(":visible"),i=n.altKey||n.ctrlKey||n.metaKey||n.shiftKey;if(!e||e&&!t&&!i){this.selectedItem=null;this.search(null,n)}},this.options.delay)},search:function(e,t){e=e!=null?e:this._value();this.term=this._value();if(e.length<this.options.minLength){return this.close(t)}if(this._trigger("search",t)===false){return}return this._search(e)},_search:function(e){this.pending++;this._addClass("ui-autocomplete-loading");this.cancelSearch=false;this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return function(e){if(t===this.requestIndex){this.__response(e)}this.pending--;if(!this.pending){this._removeClass("ui-autocomplete-loading")}}.bind(this)},__response:function(e){if(e){e=this._normalize(e)}this._trigger("response",null,{content:e});if(!this.options.disabled&&e&&e.length&&!this.cancelSearch){this._suggest(e);this._trigger("open")}else{this._close()}},close:function(e){this.cancelSearch=true;this._close(e)},_close:function(e){this._off(this.document,"mousedown");if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.blur();this.isNewMenu=true;this._trigger("close",e)}},_change:function(e){if(this.previous!==this._value()){this._trigger("change",e,{item:this.selectedItem})}},_normalize:function(e){if(e.length&&e[0].label&&e[0].value){return e}return te.map(e,function(e){if(typeof e==="string"){return{label:e,value:e}}return te.extend({},e,{label:e.label||e.value,value:e.value||e.label})})},_suggest:function(e){var t=this.menu.element.empty();this._renderMenu(t,e);this.isNewMenu=true;this.menu.refresh();t.show();this._resizeMenu();t.position(te.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next()}this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(i,e){var n=this;te.each(e,function(e,t){n._renderItemData(i,t)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(e,t){return te("<li>").append(te("<div>").text(t.label)).appendTo(e)},_move:function(e,t){if(!this.menu.element.is(":visible")){this.search(null,t);return}if(this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)){if(!this.isMultiLine){this._value(this.term)}this.menu.blur();return}this.menu[e](t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(e,t);t.preventDefault()}},_isContentEditable:function(e){if(!e.length){return false}var t=e.prop("contentEditable");if(t==="inherit"){return this._isContentEditable(e.parent())}return t==="true"}});te.extend(te.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,t){var i=new RegExp(te.ui.autocomplete.escapeRegex(t),"i");return te.grep(e,function(e){return i.test(e.label||e.value||e)})}});te.widget("ui.autocomplete",te.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments);if(this.options.disabled||this.cancelSearch){return}if(e&&e.length){t=this.options.messages.results(e.length)}else{t=this.options.messages.noResults}clearTimeout(this.liveRegionTimer);this.liveRegionTimer=this._delay(function(){this.liveRegion.html(te("<div>").text(t))},100)}});var pe=te.ui.autocomplete;var x=/ui-corner-([a-z]){2,6}/g;var fe=te.widget("ui.controlgroup",{version:"1.13.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:true,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar");this.refresh()},_destroy:function(){this._callChildMethod("destroy");this.childWidgets.removeData("ui-controlgroup-data");this.element.removeAttr("role");if(this.options.items.controlgroupLabel){this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()}},_initWidgets:function(){var o=this,a=[];te.each(this.options.items,function(r,e){var t;var s={};if(!e){return}if(r==="controlgroupLabel"){t=o.element.find(e);t.each(function(){var e=te(this);if(e.children(".ui-controlgroup-label-contents").length){return}e.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")});o._addClass(t,null,"ui-widget ui-widget-content ui-state-default");a=a.concat(t.get());return}if(!te.fn[r]){return}if(o["_"+r+"Options"]){s=o["_"+r+"Options"]("middle")}else{s={classes:{}}}o.element.find(e).each(function(){var e=te(this);var t=e[r]("instance");var i=te.widget.extend({},s);if(r==="button"&&e.parent(".ui-spinner").length){return}if(!t){t=e[r]()[r]("instance")}if(t){i.classes=o._resolveClassesValues(i.classes,t)}e[r](i);var n=e[r]("widget");te.data(n[0],"ui-controlgroup-data",t?t:e[r]("instance"));a.push(n[0])})});this.childWidgets=te(te.uniqueSort(a));this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(i){this.childWidgets.each(function(){var e=te(this),t=e.data("ui-controlgroup-data");if(t&&t[i]){t[i]()}})},_updateCornerClass:function(e,t){var i="ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all";var n=this._buildSimpleOptions(t,"label").classes.label;this._removeClass(e,null,i);this._addClass(e,null,n)},_buildSimpleOptions:function(e,t){var i=this.options.direction==="vertical";var n={classes:{}};n.classes[t]={middle:"",first:"ui-corner-"+(i?"top":"left"),last:"ui-corner-"+(i?"bottom":"right"),only:"ui-corner-all"}[e];return n},_spinnerOptions:function(e){var t=this._buildSimpleOptions(e,"ui-spinner");t.classes["ui-spinner-up"]="";t.classes["ui-spinner-down"]="";return t},_buttonOptions:function(e){return this._buildSimpleOptions(e,"ui-button")},_checkboxradioOptions:function(e){return this._buildSimpleOptions(e,"ui-checkboxradio-label")},_selectmenuOptions:function(e){var t=this.options.direction==="vertical";return{width:t?"auto":false,classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(t?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(t?"top":"left")},last:{"ui-selectmenu-button-open":t?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(t?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[e]}},_resolveClassesValues:function(i,n){var r={};te.each(i,function(e){var t=n.options.classes[e]||"";t=String.prototype.trim.call(t.replace(x,""));r[e]=(t+" "+i[e]).replace(/\s+/g," ")});return r},_setOption:function(e,t){if(e==="direction"){this._removeClass("ui-controlgroup-"+this.options.direction)}this._super(e,t);if(e==="disabled"){this._callChildMethod(t?"disable":"enable");return}this.refresh()},refresh:function(){var r,s=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction);if(this.options.direction==="horizontal"){this._addClass(null,"ui-helper-clearfix")}this._initWidgets();r=this.childWidgets;if(this.options.onlyVisible){r=r.filter(":visible")}if(r.length){te.each(["first","last"],function(e,t){var i=r[t]().data("ui-controlgroup-data");if(i&&s["_"+i.widgetName+"Options"]){var n=s["_"+i.widgetName+"Options"](r.length===1?"only":t);n.classes=s._resolveClassesValues(n.classes,i);i.element[i.widgetName](n)}else{s._updateCornerClass(r[t](),t)}});this._callChildMethod("refresh")}}});te.widget("ui.checkboxradio",[te.ui.formResetMixin,{version:"1.13.1",options:{disabled:null,label:null,icon:true,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var e,t;var i=this;var n=this._super()||{};this._readType();t=this.element.labels();this.label=te(t[t.length-1]);if(!this.label.length){te.error("No label found for checkboxradio widget")}this.originalLabel="";this.label.contents().not(this.element[0]).each(function(){i.originalLabel+=this.nodeType===3?te(this).text():this.outerHTML});if(this.originalLabel){n.label=this.originalLabel}e=this.element[0].disabled;if(e!=null){n.disabled=e}return n},_create:function(){var e=this.element[0].checked;this._bindFormResetHandler();if(this.options.disabled==null){this.options.disabled=this.element[0].disabled}this._setOption("disabled",this.options.disabled);this._addClass("ui-checkboxradio","ui-helper-hidden-accessible");this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget");if(this.type==="radio"){this._addClass(this.label,"ui-checkboxradio-radio-label")}if(this.options.label&&this.options.label!==this.originalLabel){this._updateLabel()}else if(this.originalLabel){this.options.label=this.originalLabel}this._enhance();if(e){this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active")}this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var e=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type;if(e!=="input"||!/radio|checkbox/.test(this.type)){te.error("Can't create checkboxradio on element.nodeName="+e+" and element.type="+this.type)}},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var e;var t=this.element[0].name;var i="input[name='"+te.escapeSelector(t)+"']";if(!t){return te([])}if(this.form.length){e=te(this.form[0].elements).filter(i)}else{e=te(i).filter(function(){return te(this)._form().length===0})}return e.not(this.element)},_toggleClasses:function(){var e=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",e);if(this.options.icon&&this.type==="checkbox"){this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",e)._toggleClass(this.icon,null,"ui-icon-blank",!e)}if(this.type==="radio"){this._getRadioGroup().each(function(){var e=te(this).checkboxradio("instance");if(e){e._removeClass(e.label,"ui-checkboxradio-checked","ui-state-active")}})}},_destroy:function(){this._unbindFormResetHandler();if(this.icon){this.icon.remove();this.iconSpace.remove()}},_setOption:function(e,t){if(e==="label"&&!t){return}this._super(e,t);if(e==="disabled"){this._toggleClass(this.label,null,"ui-state-disabled",t);this.element[0].disabled=t;return}this.refresh()},_updateIcon:function(e){var t="ui-icon ui-icon-background ";if(this.options.icon){if(!this.icon){this.icon=te("<span>");this.iconSpace=te("<span> </span>");this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")}if(this.type==="checkbox"){t+=e?"ui-icon-check ui-state-checked":"ui-icon-blank";this._removeClass(this.icon,null,e?"ui-icon-blank":"ui-icon-check")}else{t+="ui-icon-blank"}this._addClass(this.icon,"ui-checkboxradio-icon",t);if(!e){this._removeClass(this.icon,null,"ui-icon-check ui-state-checked")}this.icon.prependTo(this.label).after(this.iconSpace)}else if(this.icon!==undefined){this.icon.remove();this.iconSpace.remove();delete this.icon}},_updateLabel:function(){var e=this.label.contents().not(this.element[0]);if(this.icon){e=e.not(this.icon[0])}if(this.iconSpace){e=e.not(this.iconSpace[0])}e.remove();this.label.append(this.options.label)},refresh:function(){var e=this.element[0].checked,t=this.element[0].disabled;this._updateIcon(e);this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",e);if(this.options.label!==null){this._updateLabel()}if(t!==this.options.disabled){this._setOptions({disabled:t})}}}]);var ge=te.ui.checkboxradio;te.widget("ui.button",{version:"1.13.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:true},_getCreateOptions:function(){var e,t=this._super()||{};this.isInput=this.element.is("input");e=this.element[0].disabled;if(e!=null){t.disabled=e}this.originalLabel=this.isInput?this.element.val():this.element.html();if(this.originalLabel){t.label=this.originalLabel}return t},_create:function(){if(!this.option.showLabel&!this.options.icon){this.options.showLabel=true}if(this.options.disabled==null){this.options.disabled=this.element[0].disabled||false}this.hasTitle=!!this.element.attr("title");if(this.options.label&&this.options.label!==this.originalLabel){if(this.isInput){this.element.val(this.options.label)}else{this.element.html(this.options.label)}}this._addClass("ui-button","ui-widget");this._setOption("disabled",this.options.disabled);this._enhance();if(this.element.is("a")){this._on({keyup:function(e){if(e.keyCode===te.ui.keyCode.SPACE){e.preventDefault();if(this.element[0].click){this.element[0].click()}else{this.element.trigger("click")}}}})}},_enhance:function(){if(!this.element.is("button")){this.element.attr("role","button")}if(this.options.icon){this._updateIcon("icon",this.options.icon);this._updateTooltip()}},_updateTooltip:function(){this.title=this.element.attr("title");if(!this.options.showLabel&&!this.title){this.element.attr("title",this.options.label)}},_updateIcon:function(e,t){var i=e!=="iconPosition",n=i?this.options.iconPosition:t,r=n==="top"||n==="bottom";if(!this.icon){this.icon=te("<span>");this._addClass(this.icon,"ui-button-icon","ui-icon");if(!this.options.showLabel){this._addClass("ui-button-icon-only")}}else if(i){this._removeClass(this.icon,null,this.options.icon)}if(i){this._addClass(this.icon,null,t)}this._attachIcon(n);if(r){this._addClass(this.icon,null,"ui-widget-icon-block");if(this.iconSpace){this.iconSpace.remove()}}else{if(!this.iconSpace){this.iconSpace=te("<span> </span>");this._addClass(this.iconSpace,"ui-button-icon-space")}this._removeClass(this.icon,null,"ui-wiget-icon-block");this._attachIconSpace(n)}},_destroy:function(){this.element.removeAttr("role");if(this.icon){this.icon.remove()}if(this.iconSpace){this.iconSpace.remove()}if(!this.hasTitle){this.element.removeAttr("title")}},_attachIconSpace:function(e){this.icon[/^(?:end|bottom)/.test(e)?"before":"after"](this.iconSpace)},_attachIcon:function(e){this.element[/^(?:end|bottom)/.test(e)?"append":"prepend"](this.icon)},_setOptions:function(e){var t=e.showLabel===undefined?this.options.showLabel:e.showLabel,i=e.icon===undefined?this.options.icon:e.icon;if(!t&&!i){e.showLabel=true}this._super(e)},_setOption:function(e,t){if(e==="icon"){if(t){this._updateIcon(e,t)}else if(this.icon){this.icon.remove();if(this.iconSpace){this.iconSpace.remove()}}}if(e==="iconPosition"){this._updateIcon(e,t)}if(e==="showLabel"){this._toggleClass("ui-button-icon-only",null,!t);this._updateTooltip()}if(e==="label"){if(this.isInput){this.element.val(t)}else{this.element.html(t);if(this.icon){this._attachIcon(this.options.iconPosition);this._attachIconSpace(this.options.iconPosition)}}}this._super(e,t);if(e==="disabled"){this._toggleClass(null,"ui-state-disabled",t);this.element[0].disabled=t;if(t){this.element.trigger("blur")}}},refresh:function(){var e=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");if(e!==this.options.disabled){this._setOptions({disabled:e})}this._updateTooltip()}});if(te.uiBackCompat!==false){te.widget("ui.button",te.ui.button,{options:{text:true,icons:{primary:null,secondary:null}},_create:function(){if(this.options.showLabel&&!this.options.text){this.options.showLabel=this.options.text}if(!this.options.showLabel&&this.options.text){this.options.text=this.options.showLabel}if(!this.options.icon&&(this.options.icons.primary||this.options.icons.secondary)){if(this.options.icons.primary){this.options.icon=this.options.icons.primary}else{this.options.icon=this.options.icons.secondary;this.options.iconPosition="end"}}else if(this.options.icon){this.options.icons.primary=this.options.icon}this._super()},_setOption:function(e,t){if(e==="text"){this._super("showLabel",t);return}if(e==="showLabel"){this.options.text=t}if(e==="icon"){this.options.icons.primary=t}if(e==="icons"){if(t.primary){this._super("icon",t.primary);this._super("iconPosition","beginning")}else if(t.secondary){this._super("icon",t.secondary);this._super("iconPosition","end")}}this._superApply(arguments)}});te.fn.button=function(n){return function(r){var e=typeof r==="string";var s=Array.prototype.slice.call(arguments,1);var o=this;if(e){if(!this.length&&r==="instance"){o=undefined}else{this.each(function(){var e;var t=te(this).attr("type");var i=t!=="checkbox"&&t!=="radio"?"button":"checkboxradio";var n=te.data(this,"ui-"+i);if(r==="instance"){o=n;return false}if(!n){return te.error("cannot call methods on button"+" prior to initialization; "+"attempted to call method '"+r+"'")}if(typeof n[r]!=="function"||r.charAt(0)==="_"){return te.error("no such method '"+r+"' for button"+" widget instance")}e=n[r].apply(n,s);if(e!==n&&e!==undefined){o=e&&e.jquery?o.pushStack(e.get()):e;return false}})}}else{if(s.length){r=te.widget.extend.apply(null,[r].concat(s))}this.each(function(){var e=te(this).attr("type");var t=e!=="checkbox"&&e!=="radio"?"button":"checkboxradio";var i=te.data(this,"ui-"+t);if(i){i.option(r||{});if(i._init){i._init()}}else{if(t==="button"){n.call(te(this),r);return}te(this).checkboxradio(te.extend({icon:false},r))}})}return o}}(te.fn.button);te.fn.buttonset=function(){if(!te.ui.controlgroup){te.error("Controlgroup widget missing")}if(arguments[0]==="option"&&arguments[1]==="items"&&arguments[2]){return this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]])}if(arguments[0]==="option"&&arguments[1]==="items"){return this.controlgroup.apply(this,[arguments[0],"items.button"])}if(typeof arguments[0]==="object"&&arguments[0].items){arguments[0].items={button:arguments[0].items}}return this.controlgroup.apply(this,arguments)}}var me=te.ui.button;te.extend(te.ui,{datepicker:{version:"1.13.1"}});var D;function ve(e){var t,i;while(e.length&&e[0]!==document){t=e.css("position");if(t==="absolute"||t==="relative"||t==="fixed"){i=parseInt(e.css("zIndex"),10);if(!isNaN(i)&&i!==0){return i}}e=e.parent()}return 0}function R(){this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:"",selectMonthLabel:"Select month",selectYearLabel:"Select year"};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,onUpdateDatepicker:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};te.extend(this._defaults,this.regional[""]);this.regional.en=te.extend(true,{},this.regional[""]);this.regional["en-US"]=te.extend(true,{},this.regional.en);this.dpDiv=M(te("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}te.extend(R.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){O(this._defaults,e||{});return this},_attachDatepicker:function(e,t){var i,n,r;i=e.nodeName.toLowerCase();n=i==="div"||i==="span";if(!e.id){this.uuid+=1;e.id="dp"+this.uuid}r=this._newInst(te(e),n);r.settings=te.extend({},t||{});if(i==="input"){this._connectDatepicker(e,r)}else if(n){this._inlineDatepicker(e,r)}},_newInst:function(e,t){var i=e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:i,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:!t?this.dpDiv:M(te("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}},_connectDatepicker:function(e,t){var i=te(e);t.append=te([]);t.trigger=te([]);if(i.hasClass(this.markerClassName)){return}this._attachments(i,t);i.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp);this._autoSize(t);te.data(e,"datepicker",t);if(t.settings.disabled){this._disableDatepicker(e)}},_attachments:function(e,t){var i,n,r,s=this._get(t,"appendText"),o=this._get(t,"isRTL");if(t.append){t.append.remove()}if(s){t.append=te("<span>").addClass(this._appendClass).text(s);e[o?"before":"after"](t.append)}e.off("focus",this._showDatepicker);if(t.trigger){t.trigger.remove()}i=this._get(t,"showOn");if(i==="focus"||i==="both"){e.on("focus",this._showDatepicker)}if(i==="button"||i==="both"){n=this._get(t,"buttonText");r=this._get(t,"buttonImage");if(this._get(t,"buttonImageOnly")){t.trigger=te("<img>").addClass(this._triggerClass).attr({src:r,alt:n,title:n})}else{t.trigger=te("<button type='button'>").addClass(this._triggerClass);if(r){t.trigger.html(te("<img>").attr({src:r,alt:n,title:n}))}else{t.trigger.text(n)}}e[o?"before":"after"](t.trigger);t.trigger.on("click",function(){if(te.datepicker._datepickerShowing&&te.datepicker._lastInput===e[0]){te.datepicker._hideDatepicker()}else if(te.datepicker._datepickerShowing&&te.datepicker._lastInput!==e[0]){te.datepicker._hideDatepicker();te.datepicker._showDatepicker(e[0])}else{te.datepicker._showDatepicker(e[0])}return false})}},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,n,r,s=new Date(2009,12-1,20),o=this._get(e,"dateFormat");if(o.match(/[DM]/)){t=function(e){i=0;n=0;for(r=0;r<e.length;r++){if(e[r].length>i){i=e[r].length;n=r}}return n};s.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort")));s.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())}e.input.attr("size",this._formatDate(e,s).length)}},_inlineDatepicker:function(e,t){var i=te(e);if(i.hasClass(this.markerClassName)){return}i.addClass(this.markerClassName).append(t.dpDiv);te.data(e,"datepicker",t);this._setDate(t,this._getDefaultDate(t),true);this._updateDatepicker(t);this._updateAlternate(t);if(t.settings.disabled){this._disableDatepicker(e)}t.dpDiv.css("display","block")},_dialogDatepicker:function(e,t,i,n,r){var s,o,a,l,c,u=this._dialogInst;if(!u){this.uuid+=1;s="dp"+this.uuid;this._dialogInput=te("<input type='text' id='"+s+"' style='position: absolute; top: -100px; width: 0px;'/>");this._dialogInput.on("keydown",this._doKeyDown);te("body").append(this._dialogInput);u=this._dialogInst=this._newInst(this._dialogInput,false);u.settings={};te.data(this._dialogInput[0],"datepicker",u)}O(u.settings,n||{});t=t&&t.constructor===Date?this._formatDate(u,t):t;this._dialogInput.val(t);this._pos=r?r.length?r:[r.pageX,r.pageY]:null;if(!this._pos){o=document.documentElement.clientWidth;a=document.documentElement.clientHeight;l=document.documentElement.scrollLeft||document.body.scrollLeft;c=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[o/2-100+l,a/2-150+c]}this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");u.settings.onSelect=i;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if(te.blockUI){te.blockUI(this.dpDiv)}te.data(this._dialogInput[0],"datepicker",u);return this},_destroyDatepicker:function(e){var t,i=te(e),n=te.data(e,"datepicker");if(!i.hasClass(this.markerClassName)){return}t=e.nodeName.toLowerCase();te.removeData(e,"datepicker");if(t==="input"){n.append.remove();n.trigger.remove();i.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)}else if(t==="div"||t==="span"){i.removeClass(this.markerClassName).empty()}if(D===n){D=null;this._curInst=null}},_enableDatepicker:function(t){var e,i,n=te(t),r=te.data(t,"datepicker");if(!n.hasClass(this.markerClassName)){return}e=t.nodeName.toLowerCase();if(e==="input"){t.disabled=false;r.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else if(e==="div"||e==="span"){i=n.children("."+this._inlineClass);i.children().removeClass("ui-state-disabled");i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",false)}this._disabledInputs=te.map(this._disabledInputs,function(e){return e===t?null:e})},_disableDatepicker:function(t){var e,i,n=te(t),r=te.data(t,"datepicker");if(!n.hasClass(this.markerClassName)){return}e=t.nodeName.toLowerCase();if(e==="input"){t.disabled=true;r.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else if(e==="div"||e==="span"){i=n.children("."+this._inlineClass);i.children().addClass("ui-state-disabled");i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",true)}this._disabledInputs=te.map(this._disabledInputs,function(e){return e===t?null:e});this._disabledInputs[this._disabledInputs.length]=t},_isDisabledDatepicker:function(e){if(!e){return false}for(var t=0;t<this._disabledInputs.length;t++){if(this._disabledInputs[t]===e){return true}}return false},_getInst:function(e){try{return te.data(e,"datepicker")}catch(e){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,i){var n,r,s,o,a=this._getInst(e);if(arguments.length===2&&typeof t==="string"){return t==="defaults"?te.extend({},te.datepicker._defaults):a?t==="all"?te.extend({},a.settings):this._get(a,t):null}n=t||{};if(typeof t==="string"){n={};n[t]=i}if(a){if(this._curInst===a){this._hideDatepicker()}r=this._getDateDatepicker(e,true);s=this._getMinMaxDate(a,"min");o=this._getMinMaxDate(a,"max");O(a.settings,n);if(s!==null&&n.dateFormat!==undefined&&n.minDate===undefined){a.settings.minDate=this._formatDate(a,s)}if(o!==null&&n.dateFormat!==undefined&&n.maxDate===undefined){a.settings.maxDate=this._formatDate(a,o)}if("disabled"in n){if(n.disabled){this._disableDatepicker(e)}else{this._enableDatepicker(e)}}this._attachments(te(e),a);this._autoSize(a);this._setDate(a,r);this._updateAlternate(a);this._updateDatepicker(a)}},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);if(t){this._updateDatepicker(t)}},_setDateDatepicker:function(e,t){var i=this._getInst(e);if(i){this._setDate(i,t);this._updateDatepicker(i);this._updateAlternate(i)}},_getDateDatepicker:function(e,t){var i=this._getInst(e);if(i&&!i.inline){this._setDateFromField(i,t)}return i?this._getDate(i):null},_doKeyDown:function(e){var t,i,n,r=te.datepicker._getInst(e.target),s=true,o=r.dpDiv.is(".ui-datepicker-rtl");r._keyEvent=true;if(te.datepicker._datepickerShowing){switch(e.keyCode){case 9:te.datepicker._hideDatepicker();s=false;break;case 13:n=te("td."+te.datepicker._dayOverClass+":not(."+te.datepicker._currentClass+")",r.dpDiv);if(n[0]){te.datepicker._selectDay(e.target,r.selectedMonth,r.selectedYear,n[0])}t=te.datepicker._get(r,"onSelect");if(t){i=te.datepicker._formatDate(r);t.apply(r.input?r.input[0]:null,[i,r])}else{te.datepicker._hideDatepicker()}return false;case 27:te.datepicker._hideDatepicker();break;case 33:te.datepicker._adjustDate(e.target,e.ctrlKey?-te.datepicker._get(r,"stepBigMonths"):-te.datepicker._get(r,"stepMonths"),"M");break;case 34:te.datepicker._adjustDate(e.target,e.ctrlKey?+te.datepicker._get(r,"stepBigMonths"):+te.datepicker._get(r,"stepMonths"),"M");break;case 35:if(e.ctrlKey||e.metaKey){te.datepicker._clearDate(e.target)}s=e.ctrlKey||e.metaKey;break;case 36:if(e.ctrlKey||e.metaKey){te.datepicker._gotoToday(e.target)}s=e.ctrlKey||e.metaKey;break;case 37:if(e.ctrlKey||e.metaKey){te.datepicker._adjustDate(e.target,o?+1:-1,"D")}s=e.ctrlKey||e.metaKey;if(e.originalEvent.altKey){te.datepicker._adjustDate(e.target,e.ctrlKey?-te.datepicker._get(r,"stepBigMonths"):-te.datepicker._get(r,"stepMonths"),"M")}break;case 38:if(e.ctrlKey||e.metaKey){te.datepicker._adjustDate(e.target,-7,"D")}s=e.ctrlKey||e.metaKey;break;case 39:if(e.ctrlKey||e.metaKey){te.datepicker._adjustDate(e.target,o?-1:+1,"D")}s=e.ctrlKey||e.metaKey;if(e.originalEvent.altKey){te.datepicker._adjustDate(e.target,e.ctrlKey?+te.datepicker._get(r,"stepBigMonths"):+te.datepicker._get(r,"stepMonths"),"M")}break;case 40:if(e.ctrlKey||e.metaKey){te.datepicker._adjustDate(e.target,+7,"D")}s=e.ctrlKey||e.metaKey;break;default:s=false}}else if(e.keyCode===36&&e.ctrlKey){te.datepicker._showDatepicker(this)}else{s=false}if(s){e.preventDefault();e.stopPropagation()}},_doKeyPress:function(e){var t,i,n=te.datepicker._getInst(e.target);if(te.datepicker._get(n,"constrainInput")){t=te.datepicker._possibleChars(te.datepicker._get(n,"dateFormat"));i=String.fromCharCode(e.charCode==null?e.keyCode:e.charCode);return e.ctrlKey||e.metaKey||(i<" "||!t||t.indexOf(i)>-1)}},_doKeyUp:function(e){var t,i=te.datepicker._getInst(e.target);if(i.input.val()!==i.lastVal){try{t=te.datepicker.parseDate(te.datepicker._get(i,"dateFormat"),i.input?i.input.val():null,te.datepicker._getFormatConfig(i));if(t){te.datepicker._setDateFromField(i);te.datepicker._updateAlternate(i);te.datepicker._updateDatepicker(i)}}catch(e){}}return true},_showDatepicker:function(e){e=e.target||e;if(e.nodeName.toLowerCase()!=="input"){e=te("input",e.parentNode)[0]}if(te.datepicker._isDisabledDatepicker(e)||te.datepicker._lastInput===e){return}var t,i,n,r,s,o,a;t=te.datepicker._getInst(e);if(te.datepicker._curInst&&te.datepicker._curInst!==t){te.datepicker._curInst.dpDiv.stop(true,true);if(t&&te.datepicker._datepickerShowing){te.datepicker._hideDatepicker(te.datepicker._curInst.input[0])}}i=te.datepicker._get(t,"beforeShow");n=i?i.apply(e,[e,t]):{};if(n===false){return}O(t.settings,n);t.lastVal=null;te.datepicker._lastInput=e;te.datepicker._setDateFromField(t);if(te.datepicker._inDialog){e.value=""}if(!te.datepicker._pos){te.datepicker._pos=te.datepicker._findPos(e);te.datepicker._pos[1]+=e.offsetHeight}r=false;te(e).parents().each(function(){r|=te(this).css("position")==="fixed";return!r});s={left:te.datepicker._pos[0],top:te.datepicker._pos[1]};te.datepicker._pos=null;t.dpDiv.empty();t.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});te.datepicker._updateDatepicker(t);s=te.datepicker._checkOffset(t,s,r);t.dpDiv.css({position:te.datepicker._inDialog&&te.blockUI?"static":r?"fixed":"absolute",display:"none",left:s.left+"px",top:s.top+"px"});if(!t.inline){o=te.datepicker._get(t,"showAnim");a=te.datepicker._get(t,"duration");t.dpDiv.css("z-index",ve(te(e))+1);te.datepicker._datepickerShowing=true;if(te.effects&&te.effects.effect[o]){t.dpDiv.show(o,te.datepicker._get(t,"showOptions"),a)}else{t.dpDiv[o||"show"](o?a:null)}if(te.datepicker._shouldFocusInput(t)){t.input.trigger("focus")}te.datepicker._curInst=t}},_updateDatepicker:function(e){this.maxRows=4;D=e;e.dpDiv.empty().append(this._generateHTML(e));this._attachHandlers(e);var t,i=this._getNumberOfMonths(e),n=i[1],r=17,s=e.dpDiv.find("."+this._dayOverClass+" a"),o=te.datepicker._get(e,"onUpdateDatepicker");if(s.length>0){N.apply(s.get(0))}e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(n>1){e.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",r*n+"em")}e.dpDiv[(i[0]!==1||i[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi");e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(e===te.datepicker._curInst&&te.datepicker._datepickerShowing&&te.datepicker._shouldFocusInput(e)){e.input.trigger("focus")}if(e.yearshtml){t=e.yearshtml;setTimeout(function(){if(t===e.yearshtml&&e.yearshtml){e.dpDiv.find("select.ui-datepicker-year").first().replaceWith(e.yearshtml)}t=e.yearshtml=null},0)}if(o){o.apply(e.input?e.input[0]:null,[e])}},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(e,t,i){var n=e.dpDiv.outerWidth(),r=e.dpDiv.outerHeight(),s=e.input?e.input.outerWidth():0,o=e.input?e.input.outerHeight():0,a=document.documentElement.clientWidth+(i?0:te(document).scrollLeft()),l=document.documentElement.clientHeight+(i?0:te(document).scrollTop());t.left-=this._get(e,"isRTL")?n-s:0;t.left-=i&&t.left===e.input.offset().left?te(document).scrollLeft():0;t.top-=i&&t.top===e.input.offset().top+o?te(document).scrollTop():0;t.left-=Math.min(t.left,t.left+n>a&&a>n?Math.abs(t.left+n-a):0);t.top-=Math.min(t.top,t.top+r>l&&l>r?Math.abs(r+o):0);return t},_findPos:function(e){var t,i=this._getInst(e),n=this._get(i,"isRTL");while(e&&(e.type==="hidden"||e.nodeType!==1||te.expr.pseudos.hidden(e))){e=e[n?"previousSibling":"nextSibling"]}t=te(e).offset();return[t.left,t.top]},_hideDatepicker:function(e){var t,i,n,r,s=this._curInst;if(!s||e&&s!==te.data(e,"datepicker")){return}if(this._datepickerShowing){t=this._get(s,"showAnim");i=this._get(s,"duration");n=function(){te.datepicker._tidyDialog(s)};if(te.effects&&(te.effects.effect[t]||te.effects[t])){s.dpDiv.hide(t,te.datepicker._get(s,"showOptions"),i,n)}else{s.dpDiv[t==="slideDown"?"slideUp":t==="fadeIn"?"fadeOut":"hide"](t?i:null,n)}if(!t){n()}this._datepickerShowing=false;r=this._get(s,"onClose");if(r){r.apply(s.input?s.input[0]:null,[s.input?s.input.val():"",s])}this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if(te.blockUI){te.unblockUI();te("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(!te.datepicker._curInst){return}var t=te(e.target),i=te.datepicker._getInst(t[0]);if(t[0].id!==te.datepicker._mainDivId&&t.parents("#"+te.datepicker._mainDivId).length===0&&!t.hasClass(te.datepicker.markerClassName)&&!t.closest("."+te.datepicker._triggerClass).length&&te.datepicker._datepickerShowing&&!(te.datepicker._inDialog&&te.blockUI)||t.hasClass(te.datepicker.markerClassName)&&te.datepicker._curInst!==i){te.datepicker._hideDatepicker()}},_adjustDate:function(e,t,i){var n=te(e),r=this._getInst(n[0]);if(this._isDisabledDatepicker(n[0])){return}this._adjustInstDate(r,t,i);this._updateDatepicker(r)},_gotoToday:function(e){var t,i=te(e),n=this._getInst(i[0]);if(this._get(n,"gotoCurrent")&&n.currentDay){n.selectedDay=n.currentDay;n.drawMonth=n.selectedMonth=n.currentMonth;n.drawYear=n.selectedYear=n.currentYear}else{t=new Date;n.selectedDay=t.getDate();n.drawMonth=n.selectedMonth=t.getMonth();n.drawYear=n.selectedYear=t.getFullYear()}this._notifyChange(n);this._adjustDate(i)},_selectMonthYear:function(e,t,i){var n=te(e),r=this._getInst(n[0]);r["selected"+(i==="M"?"Month":"Year")]=r["draw"+(i==="M"?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10);this._notifyChange(r);this._adjustDate(n)},_selectDay:function(e,t,i,n){var r,s=te(e);if(te(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(s[0])){return}r=this._getInst(s[0]);r.selectedDay=r.currentDay=parseInt(te("a",n).attr("data-date"));r.selectedMonth=r.currentMonth=t;r.selectedYear=r.currentYear=i;this._selectDate(e,this._formatDate(r,r.currentDay,r.currentMonth,r.currentYear))},_clearDate:function(e){var t=te(e);this._selectDate(t,"")},_selectDate:function(e,t){var i,n=te(e),r=this._getInst(n[0]);t=t!=null?t:this._formatDate(r);if(r.input){r.input.val(t)}this._updateAlternate(r);i=this._get(r,"onSelect");if(i){i.apply(r.input?r.input[0]:null,[t,r])}else if(r.input){r.input.trigger("change")}if(r.inline){this._updateDatepicker(r)}else{this._hideDatepicker();this._lastInput=r.input[0];if(typeof r.input[0]!=="object"){r.input.trigger("focus")}this._lastInput=null}},_updateAlternate:function(e){var t,i,n,r=this._get(e,"altField");if(r){t=this._get(e,"altFormat")||this._get(e,"dateFormat");i=this._getDate(e);n=this.formatDate(t,i,this._getFormatConfig(e));te(document).find(r).val(n)}},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());i.setDate(i.getDate()+4-(i.getDay()||7));t=i.getTime();i.setMonth(0);i.setDate(1);return Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(i,o,e){if(i==null||o==null){throw"Invalid arguments"}o=typeof o==="object"?o.toString():o+"";if(o===""){return null}var n,t,r,a=0,s=(e?e.shortYearCutoff:null)||this._defaults.shortYearCutoff,l=typeof s!=="string"?s:(new Date).getFullYear()%100+parseInt(s,10),c=(e?e.dayNamesShort:null)||this._defaults.dayNamesShort,u=(e?e.dayNames:null)||this._defaults.dayNames,d=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort,h=(e?e.monthNames:null)||this._defaults.monthNames,p=-1,f=-1,g=-1,m=-1,v=false,y,b=function(e){var t=n+1<i.length&&i.charAt(n+1)===e;if(t){n++}return t},C=function(e){var t=b(e),i=e==="@"?14:e==="!"?20:e==="y"&&t?4:e==="o"?3:2,n=e==="y"?i:1,r=new RegExp("^\\d{"+n+","+i+"}"),s=o.substring(a).match(r);if(!s){throw"Missing number at position "+a}a+=s[0].length;return parseInt(s[0],10)},w=function(e,t,i){var n=-1,r=te.map(b(e)?i:t,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});te.each(r,function(e,t){var i=t[1];if(o.substr(a,i.length).toLowerCase()===i.toLowerCase()){n=t[0];a+=i.length;return false}});if(n!==-1){return n+1}else{throw"Unknown name at position "+a}},_=function(){if(o.charAt(a)!==i.charAt(n)){throw"Unexpected literal at position "+a}a++};for(n=0;n<i.length;n++){if(v){if(i.charAt(n)==="'"&&!b("'")){v=false}else{_()}}else{switch(i.charAt(n)){case"d":g=C("d");break;case"D":w("D",c,u);break;case"o":m=C("o");break;case"m":f=C("m");break;case"M":f=w("M",d,h);break;case"y":p=C("y");break;case"@":y=new Date(C("@"));p=y.getFullYear();f=y.getMonth()+1;g=y.getDate();break;case"!":y=new Date((C("!")-this._ticksTo1970)/1e4);p=y.getFullYear();f=y.getMonth()+1;g=y.getDate();break;case"'":if(b("'")){_()}else{v=true}break;default:_()}}}if(a<o.length){r=o.substr(a);if(!/^\s+/.test(r)){throw"Extra/unparsed characters found in date: "+r}}if(p===-1){p=(new Date).getFullYear()}else if(p<100){p+=(new Date).getFullYear()-(new Date).getFullYear()%100+(p<=l?0:-100)}if(m>-1){f=1;g=m;do{t=this._getDaysInMonth(p,f-1);if(g<=t){break}f++;g-=t}while(true)}y=this._daylightSavingAdjust(new Date(p,f-1,g));if(y.getFullYear()!==p||y.getMonth()+1!==f||y.getDate()!==g){throw"Invalid date"}return y},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*1e7,formatDate:function(i,e,t){if(!e){return""}var n,r=(t?t.dayNamesShort:null)||this._defaults.dayNamesShort,s=(t?t.dayNames:null)||this._defaults.dayNames,o=(t?t.monthNamesShort:null)||this._defaults.monthNamesShort,a=(t?t.monthNames:null)||this._defaults.monthNames,l=function(e){var t=n+1<i.length&&i.charAt(n+1)===e;if(t){n++}return t},c=function(e,t,i){var n=""+t;if(l(e)){while(n.length<i){n="0"+n}}return n},u=function(e,t,i,n){return l(e)?n[t]:i[t]},d="",h=false;if(e){for(n=0;n<i.length;n++){if(h){if(i.charAt(n)==="'"&&!l("'")){h=false}else{d+=i.charAt(n)}}else{switch(i.charAt(n)){case"d":d+=c("d",e.getDate(),2);break;case"D":d+=u("D",e.getDay(),r,s);break;case"o":d+=c("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=c("m",e.getMonth()+1,2);break;case"M":d+=u("M",e.getMonth(),o,a);break;case"y":d+=l("y")?e.getFullYear():(e.getFullYear()%100<10?"0":"")+e.getFullYear()%100;break;case"@":d+=e.getTime();break;case"!":d+=e.getTime()*1e4+this._ticksTo1970;break;case"'":if(l("'")){d+="'"}else{h=true}break;default:d+=i.charAt(n)}}}}return d},_possibleChars:function(i){var n,e="",t=false,r=function(e){var t=n+1<i.length&&i.charAt(n+1)===e;if(t){n++}return t};for(n=0;n<i.length;n++){if(t){if(i.charAt(n)==="'"&&!r("'")){t=false}else{e+=i.charAt(n)}}else{switch(i.charAt(n)){case"d":case"m":case"y":case"@":e+="0123456789";break;case"D":case"M":return null;case"'":if(r("'")){e+="'"}else{t=true}break;default:e+=i.charAt(n)}}}return e},_get:function(e,t){return e.settings[t]!==undefined?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()===e.lastVal){return}var i=this._get(e,"dateFormat"),n=e.lastVal=e.input?e.input.val():null,r=this._getDefaultDate(e),s=r,o=this._getFormatConfig(e);try{s=this.parseDate(i,n,o)||r}catch(e){n=t?"":n}e.selectedDay=s.getDate();e.drawMonth=e.selectedMonth=s.getMonth();e.drawYear=e.selectedYear=s.getFullYear();e.currentDay=n?s.getDate():0;e.currentMonth=n?s.getMonth():0;e.currentYear=n?s.getFullYear():0;this._adjustInstDate(e)},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(a,e,t){var i=function(e){var t=new Date;t.setDate(t.getDate()+e);return t},n=function(e){try{return te.datepicker.parseDate(te.datepicker._get(a,"dateFormat"),e,te.datepicker._getFormatConfig(a))}catch(e){}var t=(e.toLowerCase().match(/^c/)?te.datepicker._getDate(a):null)||new Date,i=t.getFullYear(),n=t.getMonth(),r=t.getDate(),s=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,o=s.exec(e);while(o){switch(o[2]||"d"){case"d":case"D":r+=parseInt(o[1],10);break;case"w":case"W":r+=parseInt(o[1],10)*7;break;case"m":case"M":n+=parseInt(o[1],10);r=Math.min(r,te.datepicker._getDaysInMonth(i,n));break;case"y":case"Y":i+=parseInt(o[1],10);r=Math.min(r,te.datepicker._getDaysInMonth(i,n));break}o=s.exec(e)}return new Date(i,n,r)},r=e==null||e===""?t:typeof e==="string"?n(e):typeof e==="number"?isNaN(e)?t:i(e):new Date(e.getTime());r=r&&r.toString()==="Invalid Date"?t:r;if(r){r.setHours(0);r.setMinutes(0);r.setSeconds(0);r.setMilliseconds(0)}return this._daylightSavingAdjust(r)},_daylightSavingAdjust:function(e){if(!e){return null}e.setHours(e.getHours()>12?e.getHours()+2:0);return e},_setDate:function(e,t,i){var n=!t,r=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate();e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth();e.drawYear=e.selectedYear=e.currentYear=o.getFullYear();if((r!==e.selectedMonth||s!==e.selectedYear)&&!i){this._notifyChange(e)}this._adjustInstDate(e);if(e.input){e.input.val(n?"":this._formatDate(e))}},_getDate:function(e){var t=!e.currentYear||e.input&&e.input.val()===""?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(e){var t=this._get(e,"stepMonths"),i="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){te.datepicker._adjustDate(i,-t,"M")},next:function(){te.datepicker._adjustDate(i,+t,"M")},hide:function(){te.datepicker._hideDatepicker()},today:function(){te.datepicker._gotoToday(i)},selectDay:function(){te.datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false},selectMonth:function(){te.datepicker._selectMonthYear(i,this,"M");return false},selectYear:function(){te.datepicker._selectMonthYear(i,this,"Y");return false}};te(this).on(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,n,r,s,o,a,l,c,u,d,L,F,G,$,h,p,H,f,g,m,v,y,b,C,w,_,A,B,V,W,E,z,S,j,U,T,x,D,Y=new Date,q=this._daylightSavingAdjust(new Date(Y.getFullYear(),Y.getMonth(),Y.getDate())),R=this._get(e,"isRTL"),K=this._get(e,"showButtonPanel"),X=this._get(e,"hideIfNoPrevNext"),Q=this._get(e,"navigationAsDateFormat"),M=this._getNumberOfMonths(e),Z=this._get(e,"showCurrentAtPos"),J=this._get(e,"stepMonths"),ee=M[0]!==1||M[1]!==1,N=this._daylightSavingAdjust(!e.currentDay?new Date(9999,9,9):new Date(e.currentYear,e.currentMonth,e.currentDay)),O=this._getMinMaxDate(e,"min"),I=this._getMinMaxDate(e,"max"),P=e.drawMonth-Z,k=e.drawYear;if(P<0){P+=12;k--}if(I){t=this._daylightSavingAdjust(new Date(I.getFullYear(),I.getMonth()-M[0]*M[1]+1,I.getDate()));t=O&&t<O?O:t;while(this._daylightSavingAdjust(new Date(k,P,1))>t){P--;if(P<0){P=11;k--}}}e.drawMonth=P;e.drawYear=k;i=this._get(e,"prevText");i=!Q?i:this.formatDate(i,this._daylightSavingAdjust(new Date(k,P-J,1)),this._getFormatConfig(e));if(this._canAdjustMonth(e,-1,k,P)){n=te("<a>").attr({class:"ui-datepicker-prev ui-corner-all","data-handler":"prev","data-event":"click",title:i}).append(te("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(R?"e":"w")).text(i))[0].outerHTML}else if(X){n=""}else{n=te("<a>").attr({class:"ui-datepicker-prev ui-corner-all ui-state-disabled",title:i}).append(te("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(R?"e":"w")).text(i))[0].outerHTML}r=this._get(e,"nextText");r=!Q?r:this.formatDate(r,this._daylightSavingAdjust(new Date(k,P+J,1)),this._getFormatConfig(e));if(this._canAdjustMonth(e,+1,k,P)){s=te("<a>").attr({class:"ui-datepicker-next ui-corner-all","data-handler":"next","data-event":"click",title:r}).append(te("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(R?"w":"e")).text(r))[0].outerHTML}else if(X){s=""}else{s=te("<a>").attr({class:"ui-datepicker-next ui-corner-all ui-state-disabled",title:r}).append(te("<span>").attr("class","ui-icon ui-icon-circle-triangle-"+(R?"w":"e")).text(r))[0].outerHTML}o=this._get(e,"currentText");a=this._get(e,"gotoCurrent")&&e.currentDay?N:q;o=!Q?o:this.formatDate(o,a,this._getFormatConfig(e));l="";if(!e.inline){l=te("<button>").attr({type:"button",class:"ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all","data-handler":"hide","data-event":"click"}).text(this._get(e,"closeText"))[0].outerHTML}c="";if(K){c=te("<div class='ui-datepicker-buttonpane ui-widget-content'>").append(R?l:"").append(this._isInRange(e,a)?te("<button>").attr({type:"button",class:"ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all","data-handler":"today","data-event":"click"}).text(o):"").append(R?"":l)[0].outerHTML}u=parseInt(this._get(e,"firstDay"),10);u=isNaN(u)?0:u;d=this._get(e,"showWeek");L=this._get(e,"dayNames");F=this._get(e,"dayNamesMin");G=this._get(e,"monthNames");$=this._get(e,"monthNamesShort");h=this._get(e,"beforeShowDay");p=this._get(e,"showOtherMonths");H=this._get(e,"selectOtherMonths");f=this._getDefaultDate(e);g="";for(v=0;v<M[0];v++){y="";this.maxRows=4;for(b=0;b<M[1];b++){C=this._daylightSavingAdjust(new Date(k,P,e.selectedDay));w=" ui-corner-all";_="";if(ee){_+="<div class='ui-datepicker-group";if(M[1]>1){switch(b){case 0:_+=" ui-datepicker-group-first";w=" ui-corner-"+(R?"right":"left");break;case M[1]-1:_+=" ui-datepicker-group-last";w=" ui-corner-"+(R?"left":"right");break;default:_+=" ui-datepicker-group-middle";w="";break}}_+="'>"}_+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+w+"'>"+(/all|left/.test(w)&&v===0?R?s:n:"")+(/all|right/.test(w)&&v===0?R?n:s:"")+this._generateMonthYearHeader(e,P,k,O,I,v>0||b>0,G,$)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>";A=d?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"";for(m=0;m<7;m++){B=(m+u)%7;A+="<th scope='col'"+((m+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+L[B]+"'>"+F[B]+"</span></th>"}_+=A+"</tr></thead><tbody>";V=this._getDaysInMonth(k,P);if(k===e.selectedYear&&P===e.selectedMonth){e.selectedDay=Math.min(e.selectedDay,V)}W=(this._getFirstDayOfMonth(k,P)-u+7)%7;E=Math.ceil((W+V)/7);z=ee?this.maxRows>E?this.maxRows:E:E;this.maxRows=z;S=this._daylightSavingAdjust(new Date(k,P,1-W));for(j=0;j<z;j++){_+="<tr>";U=!d?"":"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(S)+"</td>";for(m=0;m<7;m++){T=h?h.apply(e.input?e.input[0]:null,[S]):[true,""];x=S.getMonth()!==P;D=x&&!H||!T[0]||O&&S<O||I&&S>I;U+="<td class='"+((m+u+6)%7>=5?" ui-datepicker-week-end":"")+(x?" ui-datepicker-other-month":"")+(S.getTime()===C.getTime()&&P===e.selectedMonth&&e._keyEvent||f.getTime()===S.getTime()&&f.getTime()===C.getTime()?" "+this._dayOverClass:"")+(D?" "+this._unselectableClass+" ui-state-disabled":"")+(x&&!p?"":" "+T[1]+(S.getTime()===N.getTime()?" "+this._currentClass:"")+(S.getTime()===q.getTime()?" ui-datepicker-today":""))+"'"+((!x||p)&&T[2]?" title='"+T[2].replace(/'/g,"&#39;")+"'":"")+(D?"":" data-handler='selectDay' data-event='click' data-month='"+S.getMonth()+"' data-year='"+S.getFullYear()+"'")+">"+(x&&!p?"&#xa0;":D?"<span class='ui-state-default'>"+S.getDate()+"</span>":"<a class='ui-state-default"+(S.getTime()===q.getTime()?" ui-state-highlight":"")+(S.getTime()===N.getTime()?" ui-state-active":"")+(x?" ui-priority-secondary":"")+"' href='#' aria-current='"+(S.getTime()===N.getTime()?"true":"false")+"' data-date='"+S.getDate()+"'>"+S.getDate()+"</a>")+"</td>";S.setDate(S.getDate()+1);S=this._daylightSavingAdjust(S)}_+=U+"</tr>"}P++;if(P>11){P=0;k++}_+="</tbody></table>"+(ee?"</div>"+(M[0]>0&&b===M[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"");y+=_}g+=y}g+=c;e._keyEvent=false;return g},_generateMonthYearHeader:function(e,t,i,n,r,s,o,a){var l,c,u,d,h,p,f,g,m=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b=this._get(e,"selectMonthLabel"),C=this._get(e,"selectYearLabel"),w="<div class='ui-datepicker-title'>",_="";if(s||!m){_+="<span class='ui-datepicker-month'>"+o[t]+"</span>"}else{l=n&&n.getFullYear()===i;c=r&&r.getFullYear()===i;_+="<select class='ui-datepicker-month' aria-label='"+b+"' data-handler='selectMonth' data-event='change'>";for(u=0;u<12;u++){if((!l||u>=n.getMonth())&&(!c||u<=r.getMonth())){_+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+a[u]+"</option>"}}_+="</select>"}if(!y){w+=_+(s||!(m&&v)?"&#xa0;":"")}if(!e.yearshtml){e.yearshtml="";if(s||!v){w+="<span class='ui-datepicker-year'>"+i+"</span>"}else{d=this._get(e,"yearRange").split(":");h=(new Date).getFullYear();p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t};f=p(d[0]);g=Math.max(f,p(d[1]||""));f=n?Math.max(f,n.getFullYear()):f;g=r?Math.min(g,r.getFullYear()):g;e.yearshtml+="<select class='ui-datepicker-year' aria-label='"+C+"' data-handler='selectYear' data-event='change'>";for(;f<=g;f++){e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>"}e.yearshtml+="</select>";w+=e.yearshtml;e.yearshtml=null}}w+=this._get(e,"yearSuffix");if(y){w+=(s||!(m&&v)?"&#xa0;":"")+_}w+="</div>";return w},_adjustInstDate:function(e,t,i){var n=e.selectedYear+(i==="Y"?t:0),r=e.selectedMonth+(i==="M"?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(n,r))+(i==="D"?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(n,r,s)));e.selectedDay=o.getDate();e.drawMonth=e.selectedMonth=o.getMonth();e.drawYear=e.selectedYear=o.getFullYear();if(i==="M"||i==="Y"){this._notifyChange(e)}},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),n=this._getMinMaxDate(e,"max"),r=i&&t<i?i:t;return n&&r>n?n:r},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");if(t){t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])}},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return t==null?[1,1]:typeof t==="number"?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,n){var r=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(i,n+(t<0?t:r[0]*r[1]),1));if(t<0){s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth()))}return this._isInRange(e,s)},_isInRange:function(e,t){var i,n,r=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),o=null,a=null,l=this._get(e,"yearRange");if(l){i=l.split(":");n=(new Date).getFullYear();o=parseInt(i[0],10);a=parseInt(i[1],10);if(i[0].match(/[+\-].*/)){o+=n}if(i[1].match(/[+\-].*/)){a+=n}}return(!r||t.getTime()>=r.getTime())&&(!s||t.getTime()<=s.getTime())&&(!o||t.getFullYear()>=o)&&(!a||t.getFullYear()<=a)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");t=typeof t!=="string"?t:(new Date).getFullYear()%100+parseInt(t,10);return{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,n){if(!t){e.currentDay=e.selectedDay;e.currentMonth=e.selectedMonth;e.currentYear=e.selectedYear}var r=t?typeof t==="object"?t:this._daylightSavingAdjust(new Date(n,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),r,this._getFormatConfig(e))}});function M(e){var t="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.on("mouseout",t,function(){te(this).removeClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){te(this).removeClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){te(this).removeClass("ui-datepicker-next-hover")}}).on("mouseover",t,N)}function N(){if(!te.datepicker._isDisabledDatepicker(D.inline?D.dpDiv.parent()[0]:D.input[0])){te(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");te(this).addClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){te(this).addClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){te(this).addClass("ui-datepicker-next-hover")}}}function O(e,t){te.extend(e,t);for(var i in t){if(t[i]==null){e[i]=t[i]}}return e}te.fn.datepicker=function(e){if(!this.length){return this}if(!te.datepicker.initialized){te(document).on("mousedown",te.datepicker._checkExternalClick);te.datepicker.initialized=true}if(te("#"+te.datepicker._mainDivId).length===0){te("body").append(te.datepicker.dpDiv)}var t=Array.prototype.slice.call(arguments,1);if(typeof e==="string"&&(e==="isDisabled"||e==="getDate"||e==="widget")){return te.datepicker["_"+e+"Datepicker"].apply(te.datepicker,[this[0]].concat(t))}if(e==="option"&&arguments.length===2&&typeof arguments[1]==="string"){return te.datepicker["_"+e+"Datepicker"].apply(te.datepicker,[this[0]].concat(t))}return this.each(function(){if(typeof e==="string"){te.datepicker["_"+e+"Datepicker"].apply(te.datepicker,[this].concat(t))}else{te.datepicker._attachDatepicker(this,e)}})};te.datepicker=new R;te.datepicker.initialized=false;te.datepicker.uuid=(new Date).getTime();te.datepicker.version="1.13.1";var ye=te.datepicker;var be=te.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var I=false;te(document).on("mouseup",function(){I=false});var Ce=te.widget("ui.mouse",{version:"1.13.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.on("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).on("click."+this.widgetName,function(e){if(true===te.data(e.target,t.widgetName+".preventClickEvent")){te.removeData(e.target,t.widgetName+".preventClickEvent");e.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.off("."+this.widgetName);if(this._mouseMoveDelegate){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)}},_mouseDown:function(e){if(I){return}this._mouseMoved=false;if(this._mouseStarted){this._mouseUp(e)}this._mouseDownEvent=e;var t=this,i=e.which===1,n=typeof this.options.cancel==="string"&&e.target.nodeName?te(e.target).closest(this.options.cancel).length:false;if(!i||n||!this._mouseCapture(e)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){t.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)){this._mouseStarted=this._mouseStart(e)!==false;if(!this._mouseStarted){e.preventDefault();return true}}if(true===te.data(e.target,this.widgetName+".preventClickEvent")){te.removeData(e.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(e){return t._mouseMove(e)};this._mouseUpDelegate=function(e){return t._mouseUp(e)};this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate);e.preventDefault();I=true;return true},_mouseMove:function(e){if(this._mouseMoved){if(te.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button){return this._mouseUp(e)}else if(!e.which){if(e.originalEvent.altKey||e.originalEvent.ctrlKey||e.originalEvent.metaKey||e.originalEvent.shiftKey){this.ignoreMissingWhich=true}else if(!this.ignoreMissingWhich){return this._mouseUp(e)}}}if(e.which||e.button){this._mouseMoved=true}if(this._mouseStarted){this._mouseDrag(e);return e.preventDefault()}if(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)){this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==false;if(this._mouseStarted){this._mouseDrag(e)}else{this._mouseUp(e)}}return!this._mouseStarted},_mouseUp:function(e){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(e.target===this._mouseDownEvent.target){te.data(e.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(e)}if(this._mouseDelayTimer){clearTimeout(this._mouseDelayTimer);delete this._mouseDelayTimer}this.ignoreMissingWhich=false;I=false;e.preventDefault()},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}});var we=te.ui.plugin={add:function(e,t,i){var n,r=te.ui[e].prototype;for(n in i){r.plugins[n]=r.plugins[n]||[];r.plugins[n].push([t,i[n]])}},call:function(e,t,i,n){var r,s=e.plugins[t];if(!s){return}if(!n&&(!e.element[0].parentNode||e.element[0].parentNode.nodeType===11)){return}for(r=0;r<s.length;r++){if(e.options[s[r][0]]){s[r][1].apply(e.element,i)}}}};var _e=te.ui.safeBlur=function(e){if(e&&e.nodeName.toLowerCase()!=="body"){te(e).trigger("blur")}};te.widget("ui.draggable",te.ui.mouse,{version:"1.13.1",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false,drag:null,start:null,stop:null},_create:function(){if(this.options.helper==="original"){this._setPositionRelative()}if(this.options.addClasses){this._addClass("ui-draggable")}this._setHandleClassName();this._mouseInit()},_setOption:function(e,t){this._super(e,t);if(e==="handle"){this._removeHandleClassName();this._setHandleClassName()}},_destroy:function(){if((this.helper||this.element).is(".ui-draggable-dragging")){this.destroyOnClear=true;return}this._removeHandleClassName();this._mouseDestroy()},_mouseCapture:function(e){var t=this.options;if(this.helper||t.disabled||te(e.target).closest(".ui-resizable-handle").length>0){return false}this.handle=this._getHandle(e);if(!this.handle){return false}this._blurActiveElement(e);this._blockFrames(t.iframeFix===true?"iframe":t.iframeFix);return true},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=te(this);return te("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks}},_blurActiveElement:function(e){var t=te.ui.safeActiveElement(this.document[0]),i=te(e.target);if(i.closest(t).length){return}te.ui.safeBlur(t)},_mouseStart:function(e){var t=this.options;this.helper=this._createHelper(e);this._addClass(this.helper,"ui-draggable-dragging");this._cacheHelperProportions();if(te.ui.ddmanager){te.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent(true);this.offsetParent=this.helper.offsetParent();this.hasFixedAncestor=this.helper.parents().filter(function(){return te(this).css("position")==="fixed"}).length>0;this.positionAbs=this.element.offset();this._refreshOffsets(e);this.originalPosition=this.position=this._generatePosition(e,false);this.originalPageX=e.pageX;this.originalPageY=e.pageY;if(t.cursorAt){this._adjustOffsetFromHelper(t.cursorAt)}this._setContainment();if(this._trigger("start",e)===false){this._clear();return false}this._cacheHelperProportions();if(te.ui.ddmanager&&!t.dropBehaviour){te.ui.ddmanager.prepareOffsets(this,e)}this._mouseDrag(e,true);if(te.ui.ddmanager){te.ui.ddmanager.dragStart(this,e)}return true},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:false,parent:this._getParentOffset(),relative:this._getRelativeOffset()};this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(e,t){if(this.hasFixedAncestor){this.offset.parent=this._getParentOffset()}this.position=this._generatePosition(e,true);this.positionAbs=this._convertPositionTo("absolute");if(!t){var i=this._uiHash();if(this._trigger("drag",e,i)===false){this._mouseUp(new te.Event("mouseup",e));return false}this.position=i.position}this.helper[0].style.left=this.position.left+"px";this.helper[0].style.top=this.position.top+"px";if(te.ui.ddmanager){te.ui.ddmanager.drag(this,e)}return false},_mouseStop:function(e){var t=this,i=false;if(te.ui.ddmanager&&!this.options.dropBehaviour){i=te.ui.ddmanager.drop(this,e)}if(this.dropped){i=this.dropped;this.dropped=false}if(this.options.revert==="invalid"&&!i||this.options.revert==="valid"&&i||this.options.revert===true||typeof this.options.revert==="function"&&this.options.revert.call(this.element,i)){te(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(t._trigger("stop",e)!==false){t._clear()}})}else{if(this._trigger("stop",e)!==false){this._clear()}}return false},_mouseUp:function(e){this._unblockFrames();if(te.ui.ddmanager){te.ui.ddmanager.dragStop(this,e)}if(this.handleElement.is(e.target)){this.element.trigger("focus")}return te.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp(new te.Event("mouseup",{target:this.element[0]}))}else{this._clear()}return this},_getHandle:function(e){return this.options.handle?!!te(e.target).closest(this.element.find(this.options.handle)).length:true},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element;this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(e){var t=this.options,i=typeof t.helper==="function",n=i?te(t.helper.apply(this.element[0],[e])):t.helper==="clone"?this.element.clone().removeAttr("id"):this.element;if(!n.parents("body").length){n.appendTo(t.appendTo==="parent"?this.element[0].parentNode:t.appendTo)}if(i&&n[0]===this.element[0]){this._setPositionRelative()}if(n[0]!==this.element[0]&&!/(fixed|absolute)/.test(n.css("position"))){n.css("position","absolute")}return n},_setPositionRelative:function(){if(!/^(?:r|a|f)/.test(this.element.css("position"))){this.element[0].style.position="relative"}},_adjustOffsetFromHelper:function(e){if(typeof e==="string"){e=e.split(" ")}if(Array.isArray(e)){e={left:+e[0],top:+e[1]||0}}if("left"in e){this.offset.click.left=e.left+this.margins.left}if("right"in e){this.offset.click.left=this.helperProportions.width-e.right+this.margins.left}if("top"in e){this.offset.click.top=e.top+this.margins.top}if("bottom"in e){this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top}},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),t=this.document[0];if(this.cssPosition==="absolute"&&this.scrollParent[0]!==t&&te.contains(this.scrollParent[0],this.offsetParent[0])){e.left+=this.scrollParent.scrollLeft();e.top+=this.scrollParent.scrollTop()}if(this._isRootNode(this.offsetParent[0])){e={top:0,left:0}}return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition!=="relative"){return{top:0,left:0}}var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(!t?this.scrollParent.scrollTop():0),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(!t?this.scrollParent.scrollLeft():0)}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,i,n=this.options,r=this.document[0];this.relativeContainer=null;if(!n.containment){this.containment=null;return}if(n.containment==="window"){this.containment=[te(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,te(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,te(window).scrollLeft()+te(window).width()-this.helperProportions.width-this.margins.left,te(window).scrollTop()+(te(window).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(n.containment==="document"){this.containment=[0,0,te(r).width()-this.helperProportions.width-this.margins.left,(te(r).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(n.containment.constructor===Array){this.containment=n.containment;return}if(n.containment==="parent"){n.containment=this.helper[0].parentNode}t=te(n.containment);i=t[0];if(!i){return}e=/(scroll|auto)/.test(t.css("overflow"));this.containment=[(parseInt(t.css("borderLeftWidth"),10)||0)+(parseInt(t.css("paddingLeft"),10)||0),(parseInt(t.css("borderTopWidth"),10)||0)+(parseInt(t.css("paddingTop"),10)||0),(e?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(t.css("borderRightWidth"),10)||0)-(parseInt(t.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(t.css("borderBottomWidth"),10)||0)-(parseInt(t.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relativeContainer=t},_convertPositionTo:function(e,t){if(!t){t=this.position}var i=e==="absolute"?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-(this.cssPosition==="fixed"?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-(this.cssPosition==="fixed"?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,n,r,s,o=this.options,a=this._isRootNode(this.scrollParent[0]),l=e.pageX,c=e.pageY;if(!a||!this.offset.scroll){this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}}if(t){if(this.containment){if(this.relativeContainer){n=this.relativeContainer.offset();i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]}else{i=this.containment}if(e.pageX-this.offset.click.left<i[0]){l=i[0]+this.offset.click.left}if(e.pageY-this.offset.click.top<i[1]){c=i[1]+this.offset.click.top}if(e.pageX-this.offset.click.left>i[2]){l=i[2]+this.offset.click.left}if(e.pageY-this.offset.click.top>i[3]){c=i[3]+this.offset.click.top}}if(o.grid){r=o.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY;c=i?r-this.offset.click.top>=i[1]||r-this.offset.click.top>i[3]?r:r-this.offset.click.top>=i[1]?r-o.grid[1]:r+o.grid[1]:r;s=o.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX;l=i?s-this.offset.click.left>=i[0]||s-this.offset.click.left>i[2]?s:s-this.offset.click.left>=i[0]?s-o.grid[0]:s+o.grid[0]:s}if(o.axis==="y"){l=this.originalPageX}if(o.axis==="x"){c=this.originalPageY}}return{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging");if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false;if(this.destroyOnClear){this.destroy()}},_trigger:function(e,t,i){i=i||this._uiHash();te.ui.plugin.call(this,e,[t,i,this],true);if(/^(drag|start|stop)/.test(e)){this.positionAbs=this._convertPositionTo("absolute");i.offset=this.positionAbs}return te.Widget.prototype._trigger.call(this,e,t,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});te.ui.plugin.add("draggable","connectToSortable",{start:function(t,e,i){var n=te.extend({},e,{item:i.element});i.sortables=[];te(i.options.connectToSortable).each(function(){var e=te(this).sortable("instance");if(e&&!e.options.disabled){i.sortables.push(e);e.refreshPositions();e._trigger("activate",t,n)}})},stop:function(t,e,i){var n=te.extend({},e,{item:i.element});i.cancelHelperRemoval=false;te.each(i.sortables,function(){var e=this;if(e.isOver){e.isOver=0;i.cancelHelperRemoval=true;e.cancelHelperRemoval=false;e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")};e._mouseStop(t);e.options.helper=e.options._helper}else{e.cancelHelperRemoval=true;e._trigger("deactivate",t,n)}})},drag:function(i,n,r){te.each(r.sortables,function(){var e=false,t=this;t.positionAbs=r.positionAbs;t.helperProportions=r.helperProportions;t.offset.click=r.offset.click;if(t._intersectsWith(t.containerCache)){e=true;te.each(r.sortables,function(){this.positionAbs=r.positionAbs;this.helperProportions=r.helperProportions;this.offset.click=r.offset.click;if(this!==t&&this._intersectsWith(this.containerCache)&&te.contains(t.element[0],this.element[0])){e=false}return e})}if(e){if(!t.isOver){t.isOver=1;r._parent=n.helper.parent();t.currentItem=n.helper.appendTo(t.element).data("ui-sortable-item",true);t.options._helper=t.options.helper;t.options.helper=function(){return n.helper[0]};i.target=t.currentItem[0];t._mouseCapture(i,true);t._mouseStart(i,true,true);t.offset.click.top=r.offset.click.top;t.offset.click.left=r.offset.click.left;t.offset.parent.left-=r.offset.parent.left-t.offset.parent.left;t.offset.parent.top-=r.offset.parent.top-t.offset.parent.top;r._trigger("toSortable",i);r.dropped=t.element;te.each(r.sortables,function(){this.refreshPositions()});r.currentItem=r.element;t.fromOutside=r}if(t.currentItem){t._mouseDrag(i);n.position=t.position}}else{if(t.isOver){t.isOver=0;t.cancelHelperRemoval=true;t.options._revert=t.options.revert;t.options.revert=false;t._trigger("out",i,t._uiHash(t));t._mouseStop(i,true);t.options.revert=t.options._revert;t.options.helper=t.options._helper;if(t.placeholder){t.placeholder.remove()}n.helper.appendTo(r._parent);r._refreshOffsets(i);n.position=r._generatePosition(i,true);r._trigger("fromSortable",i);r.dropped=false;te.each(r.sortables,function(){this.refreshPositions()})}}})}});te.ui.plugin.add("draggable","cursor",{start:function(e,t,i){var n=te("body"),r=i.options;if(n.css("cursor")){r._cursor=n.css("cursor")}n.css("cursor",r.cursor)},stop:function(e,t,i){var n=i.options;if(n._cursor){te("body").css("cursor",n._cursor)}}});te.ui.plugin.add("draggable","opacity",{start:function(e,t,i){var n=te(t.helper),r=i.options;if(n.css("opacity")){r._opacity=n.css("opacity")}n.css("opacity",r.opacity)},stop:function(e,t,i){var n=i.options;if(n._opacity){te(t.helper).css("opacity",n._opacity)}}});te.ui.plugin.add("draggable","scroll",{start:function(e,t,i){if(!i.scrollParentNotHidden){i.scrollParentNotHidden=i.helper.scrollParent(false)}if(i.scrollParentNotHidden[0]!==i.document[0]&&i.scrollParentNotHidden[0].tagName!=="HTML"){i.overflowOffset=i.scrollParentNotHidden.offset()}},drag:function(e,t,i){var n=i.options,r=false,s=i.scrollParentNotHidden[0],o=i.document[0];if(s!==o&&s.tagName!=="HTML"){if(!n.axis||n.axis!=="x"){if(i.overflowOffset.top+s.offsetHeight-e.pageY<n.scrollSensitivity){s.scrollTop=r=s.scrollTop+n.scrollSpeed}else if(e.pageY-i.overflowOffset.top<n.scrollSensitivity){s.scrollTop=r=s.scrollTop-n.scrollSpeed}}if(!n.axis||n.axis!=="y"){if(i.overflowOffset.left+s.offsetWidth-e.pageX<n.scrollSensitivity){s.scrollLeft=r=s.scrollLeft+n.scrollSpeed}else if(e.pageX-i.overflowOffset.left<n.scrollSensitivity){s.scrollLeft=r=s.scrollLeft-n.scrollSpeed}}}else{if(!n.axis||n.axis!=="x"){if(e.pageY-te(o).scrollTop()<n.scrollSensitivity){r=te(o).scrollTop(te(o).scrollTop()-n.scrollSpeed)}else if(te(window).height()-(e.pageY-te(o).scrollTop())<n.scrollSensitivity){r=te(o).scrollTop(te(o).scrollTop()+n.scrollSpeed)}}if(!n.axis||n.axis!=="y"){if(e.pageX-te(o).scrollLeft()<n.scrollSensitivity){r=te(o).scrollLeft(te(o).scrollLeft()-n.scrollSpeed)}else if(te(window).width()-(e.pageX-te(o).scrollLeft())<n.scrollSensitivity){r=te(o).scrollLeft(te(o).scrollLeft()+n.scrollSpeed)}}}if(r!==false&&te.ui.ddmanager&&!n.dropBehaviour){te.ui.ddmanager.prepareOffsets(i,e)}}});te.ui.plugin.add("draggable","snap",{start:function(e,t,i){var n=i.options;i.snapElements=[];te(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var e=te(this),t=e.offset();if(this!==i.element[0]){i.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:t.top,left:t.left})}})},drag:function(e,t,i){var n,r,s,o,a,l,c,u,d,h,p=i.options,f=p.snapTolerance,g=t.offset.left,m=g+i.helperProportions.width,v=t.offset.top,y=v+i.helperProportions.height;for(d=i.snapElements.length-1;d>=0;d--){a=i.snapElements[d].left-i.margins.left;l=a+i.snapElements[d].width;c=i.snapElements[d].top-i.margins.top;u=c+i.snapElements[d].height;if(m<a-f||g>l+f||y<c-f||v>u+f||!te.contains(i.snapElements[d].item.ownerDocument,i.snapElements[d].item)){if(i.snapElements[d].snapping){if(i.options.snap.release){i.options.snap.release.call(i.element,e,te.extend(i._uiHash(),{snapItem:i.snapElements[d].item}))}}i.snapElements[d].snapping=false;continue}if(p.snapMode!=="inner"){n=Math.abs(c-y)<=f;r=Math.abs(u-v)<=f;s=Math.abs(a-m)<=f;o=Math.abs(l-g)<=f;if(n){t.position.top=i._convertPositionTo("relative",{top:c-i.helperProportions.height,left:0}).top}if(r){t.position.top=i._convertPositionTo("relative",{top:u,left:0}).top}if(s){t.position.left=i._convertPositionTo("relative",{top:0,left:a-i.helperProportions.width}).left}if(o){t.position.left=i._convertPositionTo("relative",{top:0,left:l}).left}}h=n||r||s||o;if(p.snapMode!=="outer"){n=Math.abs(c-v)<=f;r=Math.abs(u-y)<=f;s=Math.abs(a-g)<=f;o=Math.abs(l-m)<=f;if(n){t.position.top=i._convertPositionTo("relative",{top:c,left:0}).top}if(r){t.position.top=i._convertPositionTo("relative",{top:u-i.helperProportions.height,left:0}).top}if(s){t.position.left=i._convertPositionTo("relative",{top:0,left:a}).left}if(o){t.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left}}if(!i.snapElements[d].snapping&&(n||r||s||o||h)){if(i.options.snap.snap){i.options.snap.snap.call(i.element,e,te.extend(i._uiHash(),{snapItem:i.snapElements[d].item}))}}i.snapElements[d].snapping=n||r||s||o||h}}});te.ui.plugin.add("draggable","stack",{start:function(e,t,i){var n,r=i.options,s=te.makeArray(te(r.stack)).sort(function(e,t){return(parseInt(te(e).css("zIndex"),10)||0)-(parseInt(te(t).css("zIndex"),10)||0)});if(!s.length){return}n=parseInt(te(s[0]).css("zIndex"),10)||0;te(s).each(function(e){te(this).css("zIndex",n+e)});this.css("zIndex",n+s.length)}});te.ui.plugin.add("draggable","zIndex",{start:function(e,t,i){var n=te(t.helper),r=i.options;if(n.css("zIndex")){r._zIndex=n.css("zIndex")}n.css("zIndex",r.zIndex)},stop:function(e,t,i){var n=i.options;if(n._zIndex){te(t.helper).css("zIndex",n._zIndex)}}});var Ae=te.ui.draggable;te.widget("ui.resizable",te.ui.mouse,{version:"1.13.1",widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseFloat(e)||0},_isNumber:function(e){return!isNaN(parseFloat(e))},_hasScroll:function(e,t){if(te(e).css("overflow")==="hidden"){return false}var i=t&&t==="left"?"scrollLeft":"scrollTop",n=false;if(e[i]>0){return true}try{e[i]=1;n=e[i]>0;e[i]=0}catch(e){}return n},_create:function(){var e,t=this.options,i=this;this._addClass("ui-resizable");te.extend(this,{_aspectRatio:!!t.aspectRatio,aspectRatio:t.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:t.helper||t.ghost||t.animate?t.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)){this.element.wrap(te("<div class='ui-wrapper'></div>").css({overflow:"hidden",position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance"));this.elementIsWrapper=true;e={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")};this.element.css(e);this.originalElement.css("margin",0);this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css(e);this._proportionallyResize()}this._setupHandles();if(t.autoHide){te(this.element).on("mouseenter",function(){if(t.disabled){return}i._removeClass("ui-resizable-autohide");i._handles.show()}).on("mouseleave",function(){if(t.disabled){return}if(!i.resizing){i._addClass("ui-resizable-autohide");i._handles.hide()}})}this._mouseInit()},_destroy:function(){this._mouseDestroy();this._addedHandles.remove();var e,t=function(e){te(e).removeData("resizable").removeData("ui-resizable").off(".resizable")};if(this.elementIsWrapper){t(this.element);e=this.element;this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e);e.remove()}this.originalElement.css("resize",this.originalResizeStyle);t(this.originalElement);return this},_setOption:function(e,t){this._super(e,t);switch(e){case"handles":this._removeHandles();this._setupHandles();break;case"aspectRatio":this._aspectRatio=!!t;break;default:break}},_setupHandles:function(){var e=this.options,t,i,n,r,s,o=this;this.handles=e.handles||(!te(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});this._handles=te();this._addedHandles=te();if(this.handles.constructor===String){if(this.handles==="all"){this.handles="n,e,s,w,se,sw,ne,nw"}n=this.handles.split(",");this.handles={};for(i=0;i<n.length;i++){t=String.prototype.trim.call(n[i]);r="ui-resizable-"+t;s=te("<div>");this._addClass(s,"ui-resizable-handle "+r);s.css({zIndex:e.zIndex});this.handles[t]=".ui-resizable-"+t;if(!this.element.children(this.handles[t]).length){this.element.append(s);this._addedHandles=this._addedHandles.add(s)}}}this._renderAxis=function(e){var t,i,n,r;e=e||this.element;for(t in this.handles){if(this.handles[t].constructor===String){this.handles[t]=this.element.children(this.handles[t]).first().show()}else if(this.handles[t].jquery||this.handles[t].nodeType){this.handles[t]=te(this.handles[t]);this._on(this.handles[t],{mousedown:o._mouseDown})}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)){i=te(this.handles[t],this.element);r=/sw|ne|nw|se|n|s/.test(t)?i.outerHeight():i.outerWidth();n=["padding",/ne|nw|n/.test(t)?"Top":/se|sw|s/.test(t)?"Bottom":/^e$/.test(t)?"Right":"Left"].join("");e.css(n,r);this._proportionallyResize()}this._handles=this._handles.add(this.handles[t])}};this._renderAxis(this.element);this._handles=this._handles.add(this.element.find(".ui-resizable-handle"));this._handles.disableSelection();this._handles.on("mouseover",function(){if(!o.resizing){if(this.className){s=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}o.axis=s&&s[1]?s[1]:"se"}});if(e.autoHide){this._handles.hide();this._addClass("ui-resizable-autohide")}},_removeHandles:function(){this._addedHandles.remove()},_mouseCapture:function(e){var t,i,n=false;for(t in this.handles){i=te(this.handles[t])[0];if(i===e.target||te.contains(i,e.target)){n=true}}return!this.options.disabled&&n},_mouseStart:function(e){var t,i,n,r=this.options,s=this.element;this.resizing=true;this._renderProxy();t=this._num(this.helper.css("left"));i=this._num(this.helper.css("top"));if(r.containment){t+=te(r.containment).scrollLeft()||0;i+=te(r.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:t,top:i};this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:s.width(),height:s.height()};this.originalSize=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()};this.sizeDiff={width:s.outerWidth()-s.width(),height:s.outerHeight()-s.height()};this.originalPosition={left:t,top:i};this.originalMousePosition={left:e.pageX,top:e.pageY};this.aspectRatio=typeof r.aspectRatio==="number"?r.aspectRatio:this.originalSize.width/this.originalSize.height||1;n=te(".ui-resizable-"+this.axis).css("cursor");te("body").css("cursor",n==="auto"?this.axis+"-resize":n);this._addClass("ui-resizable-resizing");this._propagate("start",e);return true},_mouseDrag:function(e){var t,i,n=this.originalMousePosition,r=this.axis,s=e.pageX-n.left||0,o=e.pageY-n.top||0,a=this._change[r];this._updatePrevProperties();if(!a){return false}t=a.apply(this,[e,s,o]);this._updateVirtualBoundaries(e.shiftKey);if(this._aspectRatio||e.shiftKey){t=this._updateRatio(t,e)}t=this._respectSize(t,e);this._updateCache(t);this._propagate("resize",e);i=this._applyChanges();if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}if(!te.isEmptyObject(i)){this._updatePrevProperties();this._trigger("resize",e,this.ui());this._applyChanges()}return false},_mouseStop:function(e){this.resizing=false;var t,i,n,r,s,o,a,l=this.options,c=this;if(this._helper){t=this._proportionallyResizeElements;i=t.length&&/textarea/i.test(t[0].nodeName);n=i&&this._hasScroll(t[0],"left")?0:c.sizeDiff.height;r=i?0:c.sizeDiff.width;s={width:c.helper.width()-r,height:c.helper.height()-n};o=parseFloat(c.element.css("left"))+(c.position.left-c.originalPosition.left)||null;a=parseFloat(c.element.css("top"))+(c.position.top-c.originalPosition.top)||null;if(!l.animate){this.element.css(te.extend(s,{top:a,left:o}))}c.helper.height(c.size.height);c.helper.width(c.size.width);if(this._helper&&!l.animate){this._proportionallyResize()}}te("body").css("cursor","auto");this._removeClass("ui-resizable-resizing");this._propagate("stop",e);if(this._helper){this.helper.remove()}return false},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left};this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};if(this.position.top!==this.prevPosition.top){e.top=this.position.top+"px"}if(this.position.left!==this.prevPosition.left){e.left=this.position.left+"px"}if(this.size.width!==this.prevSize.width){e.width=this.size.width+"px"}if(this.size.height!==this.prevSize.height){e.height=this.size.height+"px"}this.helper.css(e);return e},_updateVirtualBoundaries:function(e){var t,i,n,r,s,o=this.options;s={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:Infinity,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:Infinity};if(this._aspectRatio||e){t=s.minHeight*this.aspectRatio;n=s.minWidth/this.aspectRatio;i=s.maxHeight*this.aspectRatio;r=s.maxWidth/this.aspectRatio;if(t>s.minWidth){s.minWidth=t}if(n>s.minHeight){s.minHeight=n}if(i<s.maxWidth){s.maxWidth=i}if(r<s.maxHeight){s.maxHeight=r}}this._vBoundaries=s},_updateCache:function(e){this.offset=this.helper.offset();if(this._isNumber(e.left)){this.position.left=e.left}if(this._isNumber(e.top)){this.position.top=e.top}if(this._isNumber(e.height)){this.size.height=e.height}if(this._isNumber(e.width)){this.size.width=e.width}},_updateRatio:function(e){var t=this.position,i=this.size,n=this.axis;if(this._isNumber(e.height)){e.width=e.height*this.aspectRatio}else if(this._isNumber(e.width)){e.height=e.width/this.aspectRatio}if(n==="sw"){e.left=t.left+(i.width-e.width);e.top=null}if(n==="nw"){e.top=t.top+(i.height-e.height);e.left=t.left+(i.width-e.width)}return e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,n=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,r=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,s=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,o=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,a=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,c=/sw|nw|w/.test(i),u=/nw|ne|n/.test(i);if(s){e.width=t.minWidth}if(o){e.height=t.minHeight}if(n){e.width=t.maxWidth}if(r){e.height=t.maxHeight}if(s&&c){e.left=a-t.minWidth}if(n&&c){e.left=a-t.maxWidth}if(o&&u){e.top=l-t.minHeight}if(r&&u){e.top=l-t.maxHeight}if(!e.width&&!e.height&&!e.left&&e.top){e.top=null}else if(!e.width&&!e.height&&!e.top&&e.left){e.left=null}return e},_getPaddingPlusBorderDimensions:function(e){var t=0,i=[],n=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],r=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];for(;t<4;t++){i[t]=parseFloat(n[t])||0;i[t]+=parseFloat(r[t])||0}return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(!this._proportionallyResizeElements.length){return}var e,t=0,i=this.helper||this.element;for(;t<this._proportionallyResizeElements.length;t++){e=this._proportionallyResizeElements[t];if(!this.outerDimensions){this.outerDimensions=this._getPaddingPlusBorderDimensions(e)}e.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})}},_renderProxy:function(){var e=this.element,t=this.options;this.elementOffset=e.offset();if(this._helper){this.helper=this.helper||te("<div></div>").css({overflow:"hidden"});this._addClass(this.helper,this._helper);this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++t.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,n=this.originalPosition;return{left:n.left+t,width:i.width-t}},n:function(e,t,i){var n=this.originalSize,r=this.originalPosition;return{top:r.top+i,height:n.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(e,t,i){return te.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,t,i]))},sw:function(e,t,i){return te.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,t,i]))},ne:function(e,t,i){return te.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,t,i]))},nw:function(e,t,i){return te.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,t,i]))}},_propagate:function(e,t){te.ui.plugin.call(this,e,[t,this.ui()]);if(e!=="resize"){this._trigger(e,t,this.ui())}},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});te.ui.plugin.add("resizable","animate",{stop:function(t){var i=te(this).resizable("instance"),e=i.options,n=i._proportionallyResizeElements,r=n.length&&/textarea/i.test(n[0].nodeName),s=r&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,o=r?0:i.sizeDiff.width,a={width:i.size.width-o,height:i.size.height-s},l=parseFloat(i.element.css("left"))+(i.position.left-i.originalPosition.left)||null,c=parseFloat(i.element.css("top"))+(i.position.top-i.originalPosition.top)||null;i.element.animate(te.extend(a,c&&l?{top:c,left:l}:{}),{duration:e.animateDuration,easing:e.animateEasing,step:function(){var e={width:parseFloat(i.element.css("width")),height:parseFloat(i.element.css("height")),top:parseFloat(i.element.css("top")),left:parseFloat(i.element.css("left"))};if(n&&n.length){te(n[0]).css({width:e.width,height:e.height})}i._updateCache(e);i._propagate("resize",t)}})}});te.ui.plugin.add("resizable","containment",{start:function(){var i,n,e,t,r,s,o,a=te(this).resizable("instance"),l=a.options,c=a.element,u=l.containment,d=u instanceof te?u.get(0):/parent/.test(u)?c.parent().get(0):u;if(!d){return}a.containerElement=te(d);if(/document/.test(u)||u===document){a.containerOffset={left:0,top:0};a.containerPosition={left:0,top:0};a.parentData={element:te(document),left:0,top:0,width:te(document).width(),height:te(document).height()||document.body.parentNode.scrollHeight}}else{i=te(d);n=[];te(["Top","Right","Left","Bottom"]).each(function(e,t){n[e]=a._num(i.css("padding"+t))});a.containerOffset=i.offset();a.containerPosition=i.position();a.containerSize={height:i.innerHeight()-n[3],width:i.innerWidth()-n[1]};e=a.containerOffset;t=a.containerSize.height;r=a.containerSize.width;s=a._hasScroll(d,"left")?d.scrollWidth:r;o=a._hasScroll(d)?d.scrollHeight:t;a.parentData={element:d,left:e.left,top:e.top,width:s,height:o}}},resize:function(e){var t,i,n,r,s=te(this).resizable("instance"),o=s.options,a=s.containerOffset,l=s.position,c=s._aspectRatio||e.shiftKey,u={top:0,left:0},d=s.containerElement,h=true;if(d[0]!==document&&/static/.test(d.css("position"))){u=a}if(l.left<(s._helper?a.left:0)){s.size.width=s.size.width+(s._helper?s.position.left-a.left:s.position.left-u.left);if(c){s.size.height=s.size.width/s.aspectRatio;h=false}s.position.left=o.helper?a.left:0}if(l.top<(s._helper?a.top:0)){s.size.height=s.size.height+(s._helper?s.position.top-a.top:s.position.top);if(c){s.size.width=s.size.height*s.aspectRatio;h=false}s.position.top=s._helper?a.top:0}n=s.containerElement.get(0)===s.element.parent().get(0);r=/relative|absolute/.test(s.containerElement.css("position"));if(n&&r){s.offset.left=s.parentData.left+s.position.left;s.offset.top=s.parentData.top+s.position.top}else{s.offset.left=s.element.offset().left;s.offset.top=s.element.offset().top}t=Math.abs(s.sizeDiff.width+(s._helper?s.offset.left-u.left:s.offset.left-a.left));i=Math.abs(s.sizeDiff.height+(s._helper?s.offset.top-u.top:s.offset.top-a.top));if(t+s.size.width>=s.parentData.width){s.size.width=s.parentData.width-t;if(c){s.size.height=s.size.width/s.aspectRatio;h=false}}if(i+s.size.height>=s.parentData.height){s.size.height=s.parentData.height-i;if(c){s.size.width=s.size.height*s.aspectRatio;h=false}}if(!h){s.position.left=s.prevPosition.left;s.position.top=s.prevPosition.top;s.size.width=s.prevSize.width;s.size.height=s.prevSize.height}},stop:function(){var e=te(this).resizable("instance"),t=e.options,i=e.containerOffset,n=e.containerPosition,r=e.containerElement,s=te(e.helper),o=s.offset(),a=s.outerWidth()-e.sizeDiff.width,l=s.outerHeight()-e.sizeDiff.height;if(e._helper&&!t.animate&&/relative/.test(r.css("position"))){te(this).css({left:o.left-n.left-i.left,width:a,height:l})}if(e._helper&&!t.animate&&/static/.test(r.css("position"))){te(this).css({left:o.left-n.left-i.left,width:a,height:l})}}});te.ui.plugin.add("resizable","alsoResize",{start:function(){var e=te(this).resizable("instance"),t=e.options;te(t.alsoResize).each(function(){var e=te(this);e.data("ui-resizable-alsoresize",{width:parseFloat(e.width()),height:parseFloat(e.height()),left:parseFloat(e.css("left")),top:parseFloat(e.css("top"))})})},resize:function(e,i){var t=te(this).resizable("instance"),n=t.options,r=t.originalSize,s=t.originalPosition,o={height:t.size.height-r.height||0,width:t.size.width-r.width||0,top:t.position.top-s.top||0,left:t.position.left-s.left||0};te(n.alsoResize).each(function(){var e=te(this),n=te(this).data("ui-resizable-alsoresize"),r={},t=e.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];te.each(t,function(e,t){var i=(n[t]||0)+(o[t]||0);if(i&&i>=0){r[t]=i||null}});e.css(r)})},stop:function(){te(this).removeData("ui-resizable-alsoresize")}});te.ui.plugin.add("resizable","ghost",{start:function(){var e=te(this).resizable("instance"),t=e.size;e.ghost=e.originalElement.clone();e.ghost.css({opacity:.25,display:"block",position:"relative",height:t.height,width:t.width,margin:0,left:0,top:0});e._addClass(e.ghost,"ui-resizable-ghost");if(te.uiBackCompat!==false&&typeof e.options.ghost==="string"){e.ghost.addClass(this.options.ghost)}e.ghost.appendTo(e.helper)},resize:function(){var e=te(this).resizable("instance");if(e.ghost){e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})}},stop:function(){var e=te(this).resizable("instance");if(e.ghost&&e.helper){e.helper.get(0).removeChild(e.ghost.get(0))}}});te.ui.plugin.add("resizable","grid",{resize:function(){var e,t=te(this).resizable("instance"),i=t.options,n=t.size,r=t.originalSize,s=t.originalPosition,o=t.axis,a=typeof i.grid==="number"?[i.grid,i.grid]:i.grid,l=a[0]||1,c=a[1]||1,u=Math.round((n.width-r.width)/l)*l,d=Math.round((n.height-r.height)/c)*c,h=r.width+u,p=r.height+d,f=i.maxWidth&&i.maxWidth<h,g=i.maxHeight&&i.maxHeight<p,m=i.minWidth&&i.minWidth>h,v=i.minHeight&&i.minHeight>p;i.grid=a;if(m){h+=l}if(v){p+=c}if(f){h-=l}if(g){p-=c}if(/^(se|s|e)$/.test(o)){t.size.width=h;t.size.height=p}else if(/^(ne)$/.test(o)){t.size.width=h;t.size.height=p;t.position.top=s.top-d}else if(/^(sw)$/.test(o)){t.size.width=h;t.size.height=p;t.position.left=s.left-u}else{if(p-c<=0||h-l<=0){e=t._getPaddingPlusBorderDimensions(this)}if(p-c>0){t.size.height=p;t.position.top=s.top-d}else{p=c-e.height;t.size.height=p;t.position.top=s.top+r.height-p}if(h-l>0){t.size.width=h;t.position.left=s.left-u}else{h=l-e.width;t.size.width=h;t.position.left=s.left+r.width-h}}}});var Ee=te.ui.resizable;te.widget("ui.dialog",{version:"1.13.1",options:{appendTo:"body",autoOpen:true,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:true,closeText:"Close",draggable:true,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var t=te(this).css(e).offset().top;if(t<0){te(this).css("top",e.top-t)}}},resizable:true,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},resizableRelatedOptions:{maxHeight:true,maxWidth:true,minHeight:true,minWidth:true},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.originalTitle=this.element.attr("title");if(this.options.title==null&&this.originalTitle!=null){this.options.title=this.originalTitle}if(this.options.disabled){this.options.disabled=false}this._createWrapper();this.element.show().removeAttr("title").appendTo(this.uiDialog);this._addClass("ui-dialog-content","ui-widget-content");this._createTitlebar();this._createButtonPane();if(this.options.draggable&&te.fn.draggable){this._makeDraggable()}if(this.options.resizable&&te.fn.resizable){this._makeResizable()}this._isOpen=false;this._trackFocus()},_init:function(){if(this.options.autoOpen){this.open()}},_appendTo:function(){var e=this.options.appendTo;if(e&&(e.jquery||e.nodeType)){return te(e)}return this.document.find(e||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._untrackInstance();this._destroyOverlay();this.element.removeUniqueId().css(this.originalCss).detach();this.uiDialog.remove();if(this.originalTitle){this.element.attr("title",this.originalTitle)}e=t.parent.children().eq(t.index);if(e.length&&e[0]!==this.element[0]){e.before(this.element)}else{t.parent.append(this.element)}},widget:function(){return this.uiDialog},disable:te.noop,enable:te.noop,close:function(e){var t=this;if(!this._isOpen||this._trigger("beforeClose",e)===false){return}this._isOpen=false;this._focusedElement=null;this._destroyOverlay();this._untrackInstance();if(!this.opener.filter(":focusable").trigger("focus").length){te.ui.safeBlur(te.ui.safeActiveElement(this.document[0]))}this._hide(this.uiDialog,this.options.hide,function(){t._trigger("close",e)})},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,t){var i=false,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+te(this).css("z-index")}).get(),r=Math.max.apply(null,n);if(r>=+this.uiDialog.css("z-index")){this.uiDialog.css("z-index",r+1);i=true}if(i&&!t){this._trigger("focus",e)}return i},open:function(){var e=this;if(this._isOpen){if(this._moveToTop()){this._focusTabbable()}return}this._isOpen=true;this.opener=te(te.ui.safeActiveElement(this.document[0]));this._size();this._position();this._createOverlay();this._moveToTop(null,true);if(this.overlay){this.overlay.css("z-index",this.uiDialog.css("z-index")-1)}this._show(this.uiDialog,this.options.show,function(){e._focusTabbable();e._trigger("focus")});this._makeFocusTarget();this._trigger("open")},_focusTabbable:function(){var e=this._focusedElement;if(!e){e=this.element.find("[autofocus]")}if(!e.length){e=this.element.find(":tabbable")}if(!e.length){e=this.uiDialogButtonPane.find(":tabbable")}if(!e.length){e=this.uiDialogTitlebarClose.filter(":tabbable")}if(!e.length){e=this.uiDialog}e.eq(0).trigger("focus")},_restoreTabbableFocus:function(){var e=te.ui.safeActiveElement(this.document[0]),t=this.uiDialog[0]===e||te.contains(this.uiDialog[0],e);if(!t){this._focusTabbable()}},_keepFocus:function(e){e.preventDefault();this._restoreTabbableFocus();this._delay(this._restoreTabbableFocus)},_createWrapper:function(){this.uiDialog=te("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo());this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front");this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===te.ui.keyCode.ESCAPE){e.preventDefault();this.close(e);return}if(e.keyCode!==te.ui.keyCode.TAB||e.isDefaultPrevented()){return}var t=this.uiDialog.find(":tabbable"),i=t.first(),n=t.last();if((e.target===n[0]||e.target===this.uiDialog[0])&&!e.shiftKey){this._delay(function(){i.trigger("focus")});e.preventDefault()}else if((e.target===i[0]||e.target===this.uiDialog[0])&&e.shiftKey){this._delay(function(){n.trigger("focus")});e.preventDefault()}},mousedown:function(e){if(this._moveToTop(e)){this._focusTabbable()}}});if(!this.element.find("[aria-describedby]").length){this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})}},_createTitlebar:function(){var e;this.uiDialogTitlebar=te("<div>");this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix");this._on(this.uiDialogTitlebar,{mousedown:function(e){if(!te(e.target).closest(".ui-dialog-titlebar-close")){this.uiDialog.trigger("focus")}}});this.uiDialogTitlebarClose=te("<button type='button'></button>").button({label:te("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:false}).appendTo(this.uiDialogTitlebar);this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close");this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault();this.close(e)}});e=te("<span>").uniqueId().prependTo(this.uiDialogTitlebar);this._addClass(e,"ui-dialog-title");this._title(e);this.uiDialogTitlebar.prependTo(this.uiDialog);this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(e){if(this.options.title){e.text(this.options.title)}else{e.html("&#160;")}},_createButtonPane:function(){this.uiDialogButtonPane=te("<div>");this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix");this.uiButtonSet=te("<div>").appendTo(this.uiDialogButtonPane);this._addClass(this.uiButtonSet,"ui-dialog-buttonset");this._createButtons()},_createButtons:function(){var r=this,e=this.options.buttons;this.uiDialogButtonPane.remove();this.uiButtonSet.empty();if(te.isEmptyObject(e)||Array.isArray(e)&&!e.length){this._removeClass(this.uiDialog,"ui-dialog-buttons");return}te.each(e,function(e,t){var i,n;t=typeof t==="function"?{click:t,text:e}:t;t=te.extend({type:"button"},t);i=t.click;n={icon:t.icon,iconPosition:t.iconPosition,showLabel:t.showLabel,icons:t.icons,text:t.text};delete t.click;delete t.icon;delete t.iconPosition;delete t.showLabel;delete t.icons;if(typeof t.text==="boolean"){delete t.text}te("<button></button>",t).button(n).appendTo(r.uiButtonSet).on("click",function(){i.apply(r.element[0],arguments)})});this._addClass(this.uiDialog,"ui-dialog-buttons");this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){var r=this,s=this.options;function o(e){return{position:e.position,offset:e.offset}}this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(e,t){r._addClass(te(this),"ui-dialog-dragging");r._blockFrames();r._trigger("dragStart",e,o(t))},drag:function(e,t){r._trigger("drag",e,o(t))},stop:function(e,t){var i=t.offset.left-r.document.scrollLeft(),n=t.offset.top-r.document.scrollTop();s.position={my:"left top",at:"left"+(i>=0?"+":"")+i+" "+"top"+(n>=0?"+":"")+n,of:r.window};r._removeClass(te(this),"ui-dialog-dragging");r._unblockFrames();r._trigger("dragStop",e,o(t))}})},_makeResizable:function(){var s=this,o=this.options,e=o.resizable,t=this.uiDialog.css("position"),i=typeof e==="string"?e:"n,e,s,w,se,sw,ne,nw";function a(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:o.maxWidth,maxHeight:o.maxHeight,minWidth:o.minWidth,minHeight:this._minHeight(),handles:i,start:function(e,t){s._addClass(te(this),"ui-dialog-resizing");s._blockFrames();s._trigger("resizeStart",e,a(t))},resize:function(e,t){s._trigger("resize",e,a(t))},stop:function(e,t){var i=s.uiDialog.offset(),n=i.left-s.document.scrollLeft(),r=i.top-s.document.scrollTop();o.height=s.uiDialog.height();o.width=s.uiDialog.width();o.position={my:"left top",at:"left"+(n>=0?"+":"")+n+" "+"top"+(r>=0?"+":"")+r,of:s.window};s._removeClass(te(this),"ui-dialog-resizing");s._unblockFrames();s._trigger("resizeStop",e,a(t))}}).css("position",t)},_trackFocus:function(){this._on(this.widget(),{focusin:function(e){this._makeFocusTarget();this._focusedElement=te(e.target)}})},_makeFocusTarget:function(){this._untrackInstance();this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),t=te.inArray(this,e);if(t!==-1){e.splice(t,1)}},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");if(!e){e=[];this.document.data("ui-dialog-instances",e)}return e},_minHeight:function(){var e=this.options;return e.height==="auto"?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");if(!e){this.uiDialog.show()}this.uiDialog.position(this.options.position);if(!e){this.uiDialog.hide()}},_setOptions:function(e){var i=this,n=false,r={};te.each(e,function(e,t){i._setOption(e,t);if(e in i.sizeRelatedOptions){n=true}if(e in i.resizableRelatedOptions){r[e]=t}});if(n){this._size();this._position()}if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option",r)}},_setOption:function(e,t){var i,n,r=this.uiDialog;if(e==="disabled"){return}this._super(e,t);if(e==="appendTo"){this.uiDialog.appendTo(this._appendTo())}if(e==="buttons"){this._createButtons()}if(e==="closeText"){this.uiDialogTitlebarClose.button({label:te("<a>").text(""+this.options.closeText).html()})}if(e==="draggable"){i=r.is(":data(ui-draggable)");if(i&&!t){r.draggable("destroy")}if(!i&&t){this._makeDraggable()}}if(e==="position"){this._position()}if(e==="resizable"){n=r.is(":data(ui-resizable)");if(n&&!t){r.resizable("destroy")}if(n&&typeof t==="string"){r.resizable("option","handles",t)}if(!n&&t!==false){this._makeResizable()}}if(e==="title"){this._title(this.uiDialogTitlebar.find(".ui-dialog-title"))}},_size:function(){var e,t,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0});if(n.minWidth>n.width){n.width=n.minWidth}e=this.uiDialog.css({height:"auto",width:n.width}).outerHeight();t=Math.max(0,n.minHeight-e);i=typeof n.maxHeight==="number"?Math.max(0,n.maxHeight-e):"none";if(n.height==="auto"){this.element.css({minHeight:t,maxHeight:i,height:"auto"})}else{this.element.height(Math.max(0,n.height-e))}if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight())}},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=te(this);return te("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks}},_allowInteraction:function(e){if(te(e.target).closest(".ui-dialog").length){return true}return!!te(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(!this.options.modal){return}var i=te.fn.jquery.substring(0,4);var n=true;this._delay(function(){n=false});if(!this.document.data("ui-dialog-overlays")){this.document.on("focusin.ui-dialog",function(e){if(n){return}var t=this._trackingInstances()[0];if(!t._allowInteraction(e)){e.preventDefault();t._focusTabbable();if(i==="3.4."||i==="3.5."){t._delay(t._restoreTabbableFocus)}}}.bind(this))}this.overlay=te("<div>").appendTo(this._appendTo());this._addClass(this.overlay,null,"ui-widget-overlay ui-front");this._on(this.overlay,{mousedown:"_keepFocus"});this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)},_destroyOverlay:function(){if(!this.options.modal){return}if(this.overlay){var e=this.document.data("ui-dialog-overlays")-1;if(!e){this.document.off("focusin.ui-dialog");this.document.removeData("ui-dialog-overlays")}else{this.document.data("ui-dialog-overlays",e)}this.overlay.remove();this.overlay=null}}});if(te.uiBackCompat!==false){te.widget("ui.dialog",te.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super();this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(e,t){if(e==="dialogClass"){this.uiDialog.removeClass(this.options.dialogClass).addClass(t)}this._superApply(arguments)}})}var Se=te.ui.dialog;te.widget("ui.droppable",{version:"1.13.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:true,greedy:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,t=this.options,i=t.accept;this.isover=false;this.isout=true;this.accept=typeof i==="function"?i:function(e){return e.is(i)};this.proportions=function(){if(arguments.length){e=arguments[0]}else{return e?e:e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}}};this._addToManager(t.scope);if(t.addClasses){this._addClass("ui-droppable")}},_addToManager:function(e){te.ui.ddmanager.droppables[e]=te.ui.ddmanager.droppables[e]||[];te.ui.ddmanager.droppables[e].push(this)},_splice:function(e){var t=0;for(;t<e.length;t++){if(e[t]===this){e.splice(t,1)}}},_destroy:function(){var e=te.ui.ddmanager.droppables[this.options.scope];this._splice(e)},_setOption:function(e,t){if(e==="accept"){this.accept=typeof t==="function"?t:function(e){return e.is(t)}}else if(e==="scope"){var i=te.ui.ddmanager.droppables[this.options.scope];this._splice(i);this._addToManager(t)}this._super(e,t)},_activate:function(e){var t=te.ui.ddmanager.current;this._addActiveClass();if(t){this._trigger("activate",e,this.ui(t))}},_deactivate:function(e){var t=te.ui.ddmanager.current;this._removeActiveClass();if(t){this._trigger("deactivate",e,this.ui(t))}},_over:function(e){var t=te.ui.ddmanager.current;if(!t||(t.currentItem||t.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],t.currentItem||t.element)){this._addHoverClass();this._trigger("over",e,this.ui(t))}},_out:function(e){var t=te.ui.ddmanager.current;if(!t||(t.currentItem||t.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],t.currentItem||t.element)){this._removeHoverClass();this._trigger("out",e,this.ui(t))}},_drop:function(t,e){var i=e||te.ui.ddmanager.current,n=false;if(!i||(i.currentItem||i.element)[0]===this.element[0]){return false}this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var e=te(this).droppable("instance");if(e.options.greedy&&!e.options.disabled&&e.options.scope===i.options.scope&&e.accept.call(e.element[0],i.currentItem||i.element)&&te.ui.intersect(i,te.extend(e,{offset:e.element.offset()}),e.options.tolerance,t)){n=true;return false}});if(n){return false}if(this.accept.call(this.element[0],i.currentItem||i.element)){this._removeActiveClass();this._removeHoverClass();this._trigger("drop",t,this.ui(i));return this.element}return false},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});te.ui.intersect=function(){function h(e,t,i){return e>=t&&e<t+i}return function(e,t,i,n){if(!t.offset){return false}var r=(e.positionAbs||e.position.absolute).left+e.margins.left,s=(e.positionAbs||e.position.absolute).top+e.margins.top,o=r+e.helperProportions.width,a=s+e.helperProportions.height,l=t.offset.left,c=t.offset.top,u=l+t.proportions().width,d=c+t.proportions().height;switch(i){case"fit":return l<=r&&o<=u&&c<=s&&a<=d;case"intersect":return l<r+e.helperProportions.width/2&&o-e.helperProportions.width/2<u&&c<s+e.helperProportions.height/2&&a-e.helperProportions.height/2<d;case"pointer":return h(n.pageY,c,t.proportions().height)&&h(n.pageX,l,t.proportions().width);case"touch":return(s>=c&&s<=d||a>=c&&a<=d||s<c&&a>d)&&(r>=l&&r<=u||o>=l&&o<=u||r<l&&o>u);default:return false}}}();te.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,t){var i,n,r=te.ui.ddmanager.droppables[e.options.scope]||[],s=t?t.type:null,o=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();e:for(i=0;i<r.length;i++){if(r[i].options.disabled||e&&!r[i].accept.call(r[i].element[0],e.currentItem||e.element)){continue}for(n=0;n<o.length;n++){if(o[n]===r[i].element[0]){r[i].proportions().height=0;continue e}}r[i].visible=r[i].element.css("display")!=="none";if(!r[i].visible){continue}if(s==="mousedown"){r[i]._activate.call(r[i],t)}r[i].offset=r[i].element.offset();r[i].proportions({width:r[i].element[0].offsetWidth,height:r[i].element[0].offsetHeight})}},drop:function(e,t){var i=false;te.each((te.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&te.ui.intersect(e,this,this.options.tolerance,t)){i=this._drop.call(this,t)||i}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)){this.isout=true;this.isover=false;this._deactivate.call(this,t)}});return i},dragStart:function(e,t){e.element.parentsUntil("body").on("scroll.droppable",function(){if(!e.options.refreshPositions){te.ui.ddmanager.prepareOffsets(e,t)}})},drag:function(s,o){if(s.options.refreshPositions){te.ui.ddmanager.prepareOffsets(s,o)}te.each(te.ui.ddmanager.droppables[s.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var e,t,i,n=te.ui.intersect(s,this,this.options.tolerance,o),r=!n&&this.isover?"isout":n&&!this.isover?"isover":null;if(!r){return}if(this.options.greedy){t=this.options.scope;i=this.element.parents(":data(ui-droppable)").filter(function(){return te(this).droppable("instance").options.scope===t});if(i.length){e=te(i[0]).droppable("instance");e.greedyChild=r==="isover"}}if(e&&r==="isover"){e.isover=false;e.isout=true;e._out.call(e,o)}this[r]=true;this[r==="isout"?"isover":"isout"]=false;this[r==="isover"?"_over":"_out"].call(this,o);if(e&&r==="isout"){e.isout=false;e.isover=true;e._over.call(e,o)}})},dragStop:function(e,t){e.element.parentsUntil("body").off("scroll.droppable");if(!e.options.refreshPositions){te.ui.ddmanager.prepareOffsets(e,t)}}};if(te.uiBackCompat!==false){te.widget("ui.droppable",te.ui.droppable,{options:{hoverClass:false,activeClass:false},_addActiveClass:function(){this._super();if(this.options.activeClass){this.element.addClass(this.options.activeClass)}},_removeActiveClass:function(){this._super();if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}},_addHoverClass:function(){this._super();if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}},_removeHoverClass:function(){this._super();if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}}})}var Te=te.ui.droppable;var xe=te.widget("ui.progressbar",{version:"1.13.1",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue();this.element.attr({role:"progressbar","aria-valuemin":this.min});this._addClass("ui-progressbar","ui-widget ui-widget-content");this.valueDiv=te("<div>").appendTo(this.element);this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header");this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow");this.valueDiv.remove()},value:function(e){if(e===undefined){return this.options.value}this.options.value=this._constrainedValue(e);this._refreshValue()},_constrainedValue:function(e){if(e===undefined){e=this.options.value}this.indeterminate=e===false;if(typeof e!=="number"){e=0}return this.indeterminate?false:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value;this._super(e);this.options.value=this._constrainedValue(t);this._refreshValue()},_setOption:function(e,t){if(e==="max"){t=Math.max(this.min,t)}this._super(e,t)},_setOptionDisabled:function(e){this._super(e);this.element.attr("aria-disabled",e);this._toggleClass(null,"ui-state-disabled",!!e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,t=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).width(t.toFixed(0)+"%");this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,e===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate);if(this.indeterminate){this.element.removeAttr("aria-valuenow");if(!this.overlayDiv){this.overlayDiv=te("<div>").appendTo(this.valueDiv);this._addClass(this.overlayDiv,"ui-progressbar-overlay")}}else{this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e});if(this.overlayDiv){this.overlayDiv.remove();this.overlayDiv=null}}if(this.oldValue!==e){this.oldValue=e;this._trigger("change")}if(e===this.options.max){this._trigger("complete")}}});var De=te.widget("ui.selectable",te.ui.mouse,{version:"1.13.1",options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var r=this;this._addClass("ui-selectable");this.dragged=false;this.refresh=function(){r.elementPos=te(r.element[0]).offset();r.selectees=te(r.options.filter,r.element[0]);r._addClass(r.selectees,"ui-selectee");r.selectees.each(function(){var e=te(this),t=e.offset(),i=this.getBoundingClientRect(),n={left:t.left-r.elementPos.left,top:t.top-r.elementPos.top};te.data(this,"selectable-item",{element:this,$element:e,left:n.left,top:n.top,right:n.left+i.width,bottom:n.top+i.height,startselected:false,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})};this.refresh();this._mouseInit();this.helper=te("<div>");this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item");this._mouseDestroy()},_mouseStart:function(i){var n=this,e=this.options;this.opos=[i.pageX,i.pageY];this.elementPos=te(this.element[0]).offset();if(this.options.disabled){return}this.selectees=te(e.filter,this.element[0]);this._trigger("start",i);te(e.appendTo).append(this.helper);this.helper.css({left:i.pageX,top:i.pageY,width:0,height:0});if(e.autoRefresh){this.refresh()}this.selectees.filter(".ui-selected").each(function(){var e=te.data(this,"selectable-item");e.startselected=true;if(!i.metaKey&&!i.ctrlKey){n._removeClass(e.$element,"ui-selected");e.selected=false;n._addClass(e.$element,"ui-unselecting");e.unselecting=true;n._trigger("unselecting",i,{unselecting:e.element})}});te(i.target).parents().addBack().each(function(){var e,t=te.data(this,"selectable-item");if(t){e=!i.metaKey&&!i.ctrlKey||!t.$element.hasClass("ui-selected");n._removeClass(t.$element,e?"ui-unselecting":"ui-selected")._addClass(t.$element,e?"ui-selecting":"ui-unselecting");t.unselecting=!e;t.selecting=e;t.selected=e;if(e){n._trigger("selecting",i,{selecting:t.element})}else{n._trigger("unselecting",i,{unselecting:t.element})}return false}})},_mouseDrag:function(n){this.dragged=true;if(this.options.disabled){return}var e,r=this,s=this.options,o=this.opos[0],a=this.opos[1],l=n.pageX,c=n.pageY;if(o>l){e=l;l=o;o=e}if(a>c){e=c;c=a;a=e}this.helper.css({left:o,top:a,width:l-o,height:c-a});this.selectees.each(function(){var e=te.data(this,"selectable-item"),t=false,i={};if(!e||e.element===r.element[0]){return}i.left=e.left+r.elementPos.left;i.right=e.right+r.elementPos.left;i.top=e.top+r.elementPos.top;i.bottom=e.bottom+r.elementPos.top;if(s.tolerance==="touch"){t=!(i.left>l||i.right<o||i.top>c||i.bottom<a)}else if(s.tolerance==="fit"){t=i.left>o&&i.right<l&&i.top>a&&i.bottom<c}if(t){if(e.selected){r._removeClass(e.$element,"ui-selected");e.selected=false}if(e.unselecting){r._removeClass(e.$element,"ui-unselecting");e.unselecting=false}if(!e.selecting){r._addClass(e.$element,"ui-selecting");e.selecting=true;r._trigger("selecting",n,{selecting:e.element})}}else{if(e.selecting){if((n.metaKey||n.ctrlKey)&&e.startselected){r._removeClass(e.$element,"ui-selecting");e.selecting=false;r._addClass(e.$element,"ui-selected");e.selected=true}else{r._removeClass(e.$element,"ui-selecting");e.selecting=false;if(e.startselected){r._addClass(e.$element,"ui-unselecting");e.unselecting=true}r._trigger("unselecting",n,{unselecting:e.element})}}if(e.selected){if(!n.metaKey&&!n.ctrlKey&&!e.startselected){r._removeClass(e.$element,"ui-selected");e.selected=false;r._addClass(e.$element,"ui-unselecting");e.unselecting=true;r._trigger("unselecting",n,{unselecting:e.element})}}}});return false},_mouseStop:function(t){var i=this;this.dragged=false;te(".ui-unselecting",this.element[0]).each(function(){var e=te.data(this,"selectable-item");i._removeClass(e.$element,"ui-unselecting");e.unselecting=false;e.startselected=false;i._trigger("unselected",t,{unselected:e.element})});te(".ui-selecting",this.element[0]).each(function(){var e=te.data(this,"selectable-item");i._removeClass(e.$element,"ui-selecting")._addClass(e.$element,"ui-selected");e.selecting=false;e.selected=true;e.startselected=true;i._trigger("selected",t,{selected:e.element})});this._trigger("stop",t);this.helper.remove();return false}});var Re=te.widget("ui.selectmenu",[te.ui.formResetMixin,{version:"1.13.1",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:false,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"};this._drawButton();this._drawMenu();this._bindFormResetHandler();this._rendered=false;this.menuItems=te()},_drawButton:function(){var e,t=this,i=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button);this._on(this.labels,{click:function(e){this.button.trigger("focus");e.preventDefault()}});this.element.hide();this.button=te("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element);this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget");e=te("<span>").appendTo(this.button);this._addClass(e,"ui-selectmenu-icon","ui-icon "+this.options.icons.button);this.buttonItem=this._renderButtonItem(i).appendTo(this.button);if(this.options.width!==false){this._resizeButton()}this._on(this.button,this._buttonEvents);this.button.one("focusin",function(){if(!t._rendered){t._refreshMenu()}})},_drawMenu:function(){var n=this;this.menu=te("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu});this.menuWrap=te("<div>").append(this.menu);this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front");this.menuWrap.appendTo(this._appendTo());this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(e,t){e.preventDefault();n._setSelection();n._select(t.item.data("ui-selectmenu-item"),e)},focus:function(e,t){var i=t.item.data("ui-selectmenu-item");if(n.focusIndex!=null&&i.index!==n.focusIndex){n._trigger("focus",e,{item:i});if(!n.isOpen){n._select(i,e)}}n.focusIndex=i.index;n.button.attr("aria-activedescendant",n.menuItems.eq(i.index).attr("id"))}}).menu("instance");this.menuInstance._off(this.menu,"mouseleave");this.menuInstance._closeOnDocumentClick=function(){return false};this.menuInstance._isDivider=function(){return false}},refresh:function(){this._refreshMenu();this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{}));if(this.options.width===null){this._resizeButton()}},_refreshMenu:function(){var e,t=this.element.find("option");this.menu.empty();this._parseOptions(t);this._renderMenu(this.menu,this.items);this.menuInstance.refresh();this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper");this._rendered=true;if(!t.length){return}e=this._getSelectedItem();this.menuInstance.focus(null,e);this._setAria(e.data("ui-selectmenu-item"));this._setOption("disabled",this.element.prop("disabled"))},open:function(e){if(this.options.disabled){return}if(!this._rendered){this._refreshMenu()}else{this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active");this.menuInstance.focus(null,this._getSelectedItem())}if(!this.menuItems.length){return}this.isOpen=true;this._toggleAttr();this._resizeMenu();this._position();this._on(this.document,this._documentClick);this._trigger("open",e)},_position:function(){this.menuWrap.position(te.extend({of:this.button},this.options.position))},close:function(e){if(!this.isOpen){return}this.isOpen=false;this._toggleAttr();this.range=null;this._off(this.document);this._trigger("close",e)},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(e){var t=te("<span>");this._setText(t,e.label);this._addClass(t,"ui-selectmenu-text");return t},_renderMenu:function(n,e){var r=this,s="";te.each(e,function(e,t){var i;if(t.optgroup!==s){i=te("<li>",{text:t.optgroup});r._addClass(i,"ui-selectmenu-optgroup","ui-menu-divider"+(t.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""));i.appendTo(n);s=t.optgroup}r._renderItemData(n,t)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(e,t){var i=te("<li>"),n=te("<div>",{title:t.element.attr("title")});if(t.disabled){this._addClass(i,null,"ui-state-disabled")}this._setText(n,t.label);return i.append(n).appendTo(e)},_setText:function(e,t){if(t){e.text(t)}else{e.html("&#160;")}},_move:function(e,t){var i,n,r=".ui-menu-item";if(this.isOpen){i=this.menuItems.eq(this.focusIndex).parent("li")}else{i=this.menuItems.eq(this.element[0].selectedIndex).parent("li");r+=":not(.ui-state-disabled)"}if(e==="first"||e==="last"){n=i[e==="first"?"prevAll":"nextAll"](r).eq(-1)}else{n=i[e+"All"](r).eq(0)}if(n.length){this.menuInstance.focus(t,n)}},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_setSelection:function(){var e;if(!this.range){return}if(window.getSelection){e=window.getSelection();e.removeAllRanges();e.addRange(this.range)}else{this.range.select()}this.button.focus()},_documentClick:{mousedown:function(e){if(!this.isOpen){return}if(!te(e.target).closest(".ui-selectmenu-menu, #"+te.escapeSelector(this.ids.button)).length){this.close(e)}}},_buttonEvents:{mousedown:function(){var e;if(window.getSelection){e=window.getSelection();if(e.rangeCount){this.range=e.getRangeAt(0)}}else{this.range=document.selection.createRange()}},click:function(e){this._setSelection();this._toggle(e)},keydown:function(e){var t=true;switch(e.keyCode){case te.ui.keyCode.TAB:case te.ui.keyCode.ESCAPE:this.close(e);t=false;break;case te.ui.keyCode.ENTER:if(this.isOpen){this._selectFocusedItem(e)}break;case te.ui.keyCode.UP:if(e.altKey){this._toggle(e)}else{this._move("prev",e)}break;case te.ui.keyCode.DOWN:if(e.altKey){this._toggle(e)}else{this._move("next",e)}break;case te.ui.keyCode.SPACE:if(this.isOpen){this._selectFocusedItem(e)}else{this._toggle(e)}break;case te.ui.keyCode.LEFT:this._move("prev",e);break;case te.ui.keyCode.RIGHT:this._move("next",e);break;case te.ui.keyCode.HOME:case te.ui.keyCode.PAGE_UP:this._move("first",e);break;case te.ui.keyCode.END:case te.ui.keyCode.PAGE_DOWN:this._move("last",e);break;default:this.menu.trigger(e);t=false}if(t){e.preventDefault()}}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex).parent("li");if(!t.hasClass("ui-state-disabled")){this._select(t.data("ui-selectmenu-item"),e)}},_select:function(e,t){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index;this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(e));this._setAria(e);this._trigger("select",t,{item:e});if(e.index!==i){this._trigger("change",t,{item:e})}this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t});this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){if(e==="icons"){var i=this.button.find("span.ui-icon");this._removeClass(i,null,this.options.icons.button)._addClass(i,null,t.button)}this._super(e,t);if(e==="appendTo"){this.menuWrap.appendTo(this._appendTo())}if(e==="width"){this._resizeButton()}},_setOptionDisabled:function(e){this._super(e);this.menuInstance.option("disabled",e);this.button.attr("aria-disabled",e);this._toggleClass(this.button,null,"ui-state-disabled",e);this.element.prop("disabled",e);if(e){this.button.attr("tabindex",-1);this.close()}else{this.button.attr("tabindex",0)}},_appendTo:function(){var e=this.options.appendTo;if(e){e=e.jquery||e.nodeType?te(e):this.document.find(e).eq(0)}if(!e||!e[0]){e=this.element.closest(".ui-front, dialog")}if(!e.length){e=this.document[0].body}return e},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen);this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen);this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;if(e===false){this.button.css("width","");return}if(e===null){e=this.element.show().outerWidth();this.element.hide()}this.button.outerWidth(e)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var e=this._super();e.disabled=this.element.prop("disabled");return e},_parseOptions:function(e){var i=this,n=[];e.each(function(e,t){if(t.hidden){return}n.push(i._parseOption(te(t),e))});this.items=n},_parseOption:function(e,t){var i=e.parent("optgroup");return{element:e,index:t,value:e.val(),label:e.text(),optgroup:i.attr("label")||"",disabled:i.prop("disabled")||e.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler();this.menuWrap.remove();this.button.remove();this.element.show();this.element.removeUniqueId();this.labels.attr("for",this.ids.element)}}]);var Me=te.widget("ui.slider",te.ui.mouse,{version:"1.13.1",widgetEventPrefix:"slide",options:{animate:false,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this._calculateNewMax();this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content");this._refresh();this._animateOff=false},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var e,t,i=this.options,n=this.element.find(".ui-slider-handle"),r="<span tabindex='0'></span>",s=[];t=i.values&&i.values.length||1;if(n.length>t){n.slice(t).remove();n=n.slice(0,t)}for(e=n.length;e<t;e++){s.push(r)}this.handles=n.add(te(s.join("")).appendTo(this.element));this._addClass(this.handles,"ui-slider-handle","ui-state-default");this.handle=this.handles.eq(0);this.handles.each(function(e){te(this).data("ui-slider-handle-index",e).attr("tabIndex",0)})},_createRange:function(){var e=this.options;if(e.range){if(e.range===true){if(!e.values){e.values=[this._valueMin(),this._valueMin()]}else if(e.values.length&&e.values.length!==2){e.values=[e.values[0],e.values[0]]}else if(Array.isArray(e.values)){e.values=e.values.slice(0)}}if(!this.range||!this.range.length){this.range=te("<div>").appendTo(this.element);this._addClass(this.range,"ui-slider-range")}else{this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max");this.range.css({left:"",bottom:""})}if(e.range==="min"||e.range==="max"){this._addClass(this.range,"ui-slider-range-"+e.range)}}else{if(this.range){this.range.remove()}this.range=null}},_setupEvents:function(){this._off(this.handles);this._on(this.handles,this._handleEvents);this._hoverable(this.handles);this._focusable(this.handles)},_destroy:function(){this.handles.remove();if(this.range){this.range.remove()}this._mouseDestroy()},_mouseCapture:function(e){var t,i,n,r,s,o,a,l,c=this,u=this.options;if(u.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();t={x:e.pageX,y:e.pageY};i=this._normValueFromMouse(t);n=this._valueMax()-this._valueMin()+1;this.handles.each(function(e){var t=Math.abs(i-c.values(e));if(n>t||n===t&&(e===c._lastChangedValue||c.values(e)===u.min)){n=t;r=te(this);s=e}});o=this._start(e,s);if(o===false){return false}this._mouseSliding=true;this._handleIndex=s;this._addClass(r,null,"ui-state-active");r.trigger("focus");a=r.offset();l=!te(e.target).parents().addBack().is(".ui-slider-handle");this._clickOffset=l?{left:0,top:0}:{left:e.pageX-a.left-r.width()/2,top:e.pageY-a.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(e,s,i)}this._animateOff=true;return true},_mouseStart:function(){return true},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);this._slide(e,this._handleIndex,i);return false},_mouseStop:function(e){this._removeClass(this.handles,null,"ui-state-active");this._mouseSliding=false;this._stop(e,this._handleIndex);this._change(e,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,n,r,s;if(this.orientation==="horizontal"){t=this.elementSize.width;i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{t=this.elementSize.height;i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}n=i/t;if(n>1){n=1}if(n<0){n=0}if(this.orientation==="vertical"){n=1-n}r=this._valueMax()-this._valueMin();s=this._valueMin()+n*r;return this._trimAlignValue(s)},_uiHash:function(e,t,i){var n={handle:this.handles[e],handleIndex:e,value:t!==undefined?t:this.value()};if(this._hasMultipleValues()){n.value=t!==undefined?t:this.values(e);n.values=i||this.values()}return n},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(e,t){return this._trigger("start",e,this._uiHash(t))},_slide:function(e,t,i){var n,r,s=this.value(),o=this.values();if(this._hasMultipleValues()){r=this.values(t?0:1);s=this.values(t);if(this.options.values.length===2&&this.options.range===true){i=t===0?Math.min(r,i):Math.max(r,i)}o[t]=i}if(i===s){return}n=this._trigger("slide",e,this._uiHash(t,i,o));if(n===false){return}if(this._hasMultipleValues()){this.values(t,i)}else{this.value(i)}},_stop:function(e,t){this._trigger("stop",e,this._uiHash(t))},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){this._lastChangedValue=t;this._trigger("change",e,this._uiHash(t))}},value:function(e){if(arguments.length){this.options.value=this._trimAlignValue(e);this._refreshValue();this._change(null,0);return}return this._value()},values:function(e,t){var i,n,r;if(arguments.length>1){this.options.values[e]=this._trimAlignValue(t);this._refreshValue();this._change(null,e);return}if(arguments.length){if(Array.isArray(arguments[0])){i=this.options.values;n=arguments[0];for(r=0;r<i.length;r+=1){i[r]=this._trimAlignValue(n[r]);this._change(null,r)}this._refreshValue()}else{if(this._hasMultipleValues()){return this._values(e)}else{return this.value()}}}else{return this._values()}},_setOption:function(e,t){var i,n=0;if(e==="range"&&this.options.range===true){if(t==="min"){this.options.value=this._values(0);this.options.values=null}else if(t==="max"){this.options.value=this._values(this.options.values.length-1);this.options.values=null}}if(Array.isArray(this.options.values)){n=this.options.values.length}this._super(e,t);switch(e){case"orientation":this._detectOrientation();this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation);this._refreshValue();if(this.options.range){this._refreshRange(t)}this.handles.css(t==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(i=n-1;i>=0;i--){this._change(null,i)}this._animateOff=false;break;case"step":case"min":case"max":this._animateOff=true;this._calculateNewMax();this._refreshValue();this._animateOff=false;break;case"range":this._animateOff=true;this._refresh();this._animateOff=false;break}},_setOptionDisabled:function(e){this._super(e);this._toggleClass(null,"ui-state-disabled",!!e)},_value:function(){var e=this.options.value;e=this._trimAlignValue(e);return e},_values:function(e){var t,i,n;if(arguments.length){t=this.options.values[e];t=this._trimAlignValue(t);return t}else if(this._hasMultipleValues()){i=this.options.values.slice();for(n=0;n<i.length;n+=1){i[n]=this._trimAlignValue(i[n])}return i}else{return[]}},_trimAlignValue:function(e){if(e<=this._valueMin()){return this._valueMin()}if(e>=this._valueMax()){return this._valueMax()}var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,n=e-i;if(Math.abs(i)*2>=t){n+=i>0?t:-t}return parseFloat(n.toFixed(5))},_calculateNewMax:function(){var e=this.options.max,t=this._valueMin(),i=this.options.step,n=Math.round((e-t)/i)*i;e=n+t;if(e>this.options.max){e-=i}this.max=parseFloat(e.toFixed(this._precision()))},_precision:function(){var e=this._precisionOf(this.options.step);if(this.options.min!==null){e=Math.max(e,this._precisionOf(this.options.min))}return e},_precisionOf:function(e){var t=e.toString(),i=t.indexOf(".");return i===-1?0:t.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(e){if(e==="vertical"){this.range.css({width:"",left:""})}if(e==="horizontal"){this.range.css({height:"",bottom:""})}},_refreshValue:function(){var t,i,e,n,r,s=this.options.range,o=this.options,a=this,l=!this._animateOff?o.animate:false,c={};if(this._hasMultipleValues()){this.handles.each(function(e){i=(a.values(e)-a._valueMin())/(a._valueMax()-a._valueMin())*100;c[a.orientation==="horizontal"?"left":"bottom"]=i+"%";te(this).stop(1,1)[l?"animate":"css"](c,o.animate);if(a.options.range===true){if(a.orientation==="horizontal"){if(e===0){a.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},o.animate)}if(e===1){a.range[l?"animate":"css"]({width:i-t+"%"},{queue:false,duration:o.animate})}}else{if(e===0){a.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},o.animate)}if(e===1){a.range[l?"animate":"css"]({height:i-t+"%"},{queue:false,duration:o.animate})}}}t=i})}else{e=this.value();n=this._valueMin();r=this._valueMax();i=r!==n?(e-n)/(r-n)*100:0;c[this.orientation==="horizontal"?"left":"bottom"]=i+"%";this.handle.stop(1,1)[l?"animate":"css"](c,o.animate);if(s==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},o.animate)}if(s==="max"&&this.orientation==="horizontal"){this.range.stop(1,1)[l?"animate":"css"]({width:100-i+"%"},o.animate)}if(s==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},o.animate)}if(s==="max"&&this.orientation==="vertical"){this.range.stop(1,1)[l?"animate":"css"]({height:100-i+"%"},o.animate)}}},_handleEvents:{keydown:function(e){var t,i,n,r,s=te(e.target).data("ui-slider-handle-index");switch(e.keyCode){case te.ui.keyCode.HOME:case te.ui.keyCode.END:case te.ui.keyCode.PAGE_UP:case te.ui.keyCode.PAGE_DOWN:case te.ui.keyCode.UP:case te.ui.keyCode.RIGHT:case te.ui.keyCode.DOWN:case te.ui.keyCode.LEFT:e.preventDefault();if(!this._keySliding){this._keySliding=true;this._addClass(te(e.target),null,"ui-state-active");t=this._start(e,s);if(t===false){return}}break}r=this.options.step;if(this._hasMultipleValues()){i=n=this.values(s)}else{i=n=this.value()}switch(e.keyCode){case te.ui.keyCode.HOME:n=this._valueMin();break;case te.ui.keyCode.END:n=this._valueMax();break;case te.ui.keyCode.PAGE_UP:n=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/this.numPages);break;case te.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/this.numPages);break;case te.ui.keyCode.UP:case te.ui.keyCode.RIGHT:if(i===this._valueMax()){return}n=this._trimAlignValue(i+r);break;case te.ui.keyCode.DOWN:case te.ui.keyCode.LEFT:if(i===this._valueMin()){return}n=this._trimAlignValue(i-r);break}this._slide(e,s,n)},keyup:function(e){var t=te(e.target).data("ui-slider-handle-index");if(this._keySliding){this._keySliding=false;this._stop(e,t);this._change(e,t);this._removeClass(te(e.target),null,"ui-state-active")}}}});var Ne=te.widget("ui.sortable",te.ui.mouse,{version:"1.13.1",widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&e<t+i},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={};this._addClass("ui-sortable");this.refresh();this.offset=this.element.offset();this._mouseInit();this._setHandleClassName();this.ready=true},_setOption:function(e,t){this._super(e,t);if(e==="handle"){this._setHandleClassName()}},_setHandleClassName:function(){var e=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle");te.each(this.items,function(){e._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--){this.items[e].item.removeData(this.widgetName+"-item")}return this},_mouseCapture:function(e,t){var i=null,n=false,r=this;if(this.reverting){return false}if(this.options.disabled||this.options.type==="static"){return false}this._refreshItems(e);te(e.target).parents().each(function(){if(te.data(this,r.widgetName+"-item")===r){i=te(this);return false}});if(te.data(e.target,r.widgetName+"-item")===r){i=te(e.target)}if(!i){return false}if(this.options.handle&&!t){te(this.options.handle,i).find("*").addBack().each(function(){if(this===e.target){n=true}});if(!n){return false}}this.currentItem=i;this._removeCurrentsFromItems();return true},_mouseStart:function(e,t,i){var n,r,s=this.options;this.currentContainer=this;this.refreshPositions();this.appendTo=te(s.appendTo!=="parent"?s.appendTo:this.currentItem.parent());this.helper=this._createHelper(e);this._cacheHelperProportions();this._cacheMargins();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};te.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");if(s.cursorAt){this._adjustOffsetFromHelper(s.cursorAt)}this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();this.scrollParent=this.placeholder.scrollParent();te.extend(this.offset,{parent:this._getParentOffset()});if(s.containment){this._setContainment()}if(s.cursor&&s.cursor!=="auto"){r=this.document.find("body");this.storedCursor=r.css("cursor");r.css("cursor",s.cursor);this.storedStylesheet=te("<style>*{ cursor: "+s.cursor+" !important; }</style>").appendTo(r)}if(s.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",s.zIndex)}if(s.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",s.opacity)}if(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",e,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions()}if(!i){for(n=this.containers.length-1;n>=0;n--){this.containers[n]._trigger("activate",e,this._uiHash(this))}}if(te.ui.ddmanager){te.ui.ddmanager.current=this}if(te.ui.ddmanager&&!s.dropBehaviour){te.ui.ddmanager.prepareOffsets(this,e)}this.dragging=true;this._addClass(this.helper,"ui-sortable-helper");if(!this.helper.parent().is(this.appendTo)){this.helper.detach().appendTo(this.appendTo);this.offset.parent=this._getParentOffset()}this.position=this.originalPosition=this._generatePosition(e);this.originalPageX=e.pageX;this.originalPageY=e.pageY;this.lastPositionAbs=this.positionAbs=this._convertPositionTo("absolute");this._mouseDrag(e);return true},_scroll:function(e){var t=this.options,i=false;if(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"){if(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<t.scrollSensitivity){this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop+t.scrollSpeed}else if(e.pageY-this.overflowOffset.top<t.scrollSensitivity){this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop-t.scrollSpeed}if(this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<t.scrollSensitivity){this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft+t.scrollSpeed}else if(e.pageX-this.overflowOffset.left<t.scrollSensitivity){this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft-t.scrollSpeed}}else{if(e.pageY-this.document.scrollTop()<t.scrollSensitivity){i=this.document.scrollTop(this.document.scrollTop()-t.scrollSpeed)}else if(this.window.height()-(e.pageY-this.document.scrollTop())<t.scrollSensitivity){i=this.document.scrollTop(this.document.scrollTop()+t.scrollSpeed)}if(e.pageX-this.document.scrollLeft()<t.scrollSensitivity){i=this.document.scrollLeft(this.document.scrollLeft()-t.scrollSpeed)}else if(this.window.width()-(e.pageX-this.document.scrollLeft())<t.scrollSensitivity){i=this.document.scrollLeft(this.document.scrollLeft()+t.scrollSpeed)}}return i},_mouseDrag:function(e){var t,i,n,r,s=this.options;this.position=this._generatePosition(e);this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px"}if(s.scroll){if(this._scroll(e)!==false){this._refreshItemPositions(true);if(te.ui.ddmanager&&!s.dropBehaviour){te.ui.ddmanager.prepareOffsets(this,e)}}}this.dragDirection={vertical:this._getDragVerticalDirection(),horizontal:this._getDragHorizontalDirection()};for(t=this.items.length-1;t>=0;t--){i=this.items[t];n=i.item[0];r=this._intersectsWithPointer(i);if(!r){continue}if(i.instance!==this.currentContainer){continue}if(n!==this.currentItem[0]&&this.placeholder[r===1?"next":"prev"]()[0]!==n&&!te.contains(this.placeholder[0],n)&&(this.options.type==="semi-dynamic"?!te.contains(this.element[0],n):true)){this.direction=r===1?"down":"up";if(this.options.tolerance==="pointer"||this._intersectsWithSides(i)){this._rearrange(e,i)}else{break}this._trigger("change",e,this._uiHash());break}}this._contactContainers(e);if(te.ui.ddmanager){te.ui.ddmanager.drag(this,e)}this._trigger("sort",e,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(e,t){if(!e){return}if(te.ui.ddmanager&&!this.options.dropBehaviour){te.ui.ddmanager.drop(this,e)}if(this.options.revert){var i=this,n=this.placeholder.offset(),r=this.options.axis,s={};if(!r||r==="x"){s.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)}if(!r||r==="y"){s.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)}this.reverting=true;te(this.helper).animate(s,parseInt(this.options.revert,10)||500,function(){i._clear(e)})}else{this._clear(e,t)}return false},cancel:function(){if(this.dragging){this._mouseUp(new te.Event("mouseup",{target:null}));if(this.options.helper==="original"){this.currentItem.css(this._storedCSS);this._removeClass(this.currentItem,"ui-sortable-helper")}else{this.currentItem.show()}for(var e=this.containers.length-1;e>=0;e--){this.containers[e]._trigger("deactivate",null,this._uiHash(this));if(this.containers[e].containerCache.over){this.containers[e]._trigger("out",null,this._uiHash(this));this.containers[e].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])}if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove()}te.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){te(this.domPosition.prev).after(this.currentItem)}else{te(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(t){var e=this._getItemsAsjQuery(t&&t.connected),i=[];t=t||{};te(e).each(function(){var e=(te(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);if(e){i.push((t.key||e[1]+"[]")+"="+(t.key&&t.expression?e[1]:e[2]))}});if(!i.length&&t.key){i.push(t.key+"=")}return i.join("&")},toArray:function(e){var t=this._getItemsAsjQuery(e&&e.connected),i=[];e=e||{};t.each(function(){i.push(te(e.item||this).attr(e.attribute||"id")||"")});return i},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,n=this.positionAbs.top,r=n+this.helperProportions.height,s=e.left,o=s+e.width,a=e.top,l=a+e.height,c=this.offset.click.top,u=this.offset.click.left,d=this.options.axis==="x"||n+c>a&&n+c<l,h=this.options.axis==="y"||t+u>s&&t+u<o,p=d&&h;if(this.options.tolerance==="pointer"||this.options.forcePointerForContainers||this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]){return p}else{return s<t+this.helperProportions.width/2&&i-this.helperProportions.width/2<o&&a<n+this.helperProportions.height/2&&r-this.helperProportions.height/2<l}},_intersectsWithPointer:function(e){var t,i,n=this.options.axis==="x"||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),r=this.options.axis==="y"||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),s=n&&r;if(!s){return false}t=this.dragDirection.vertical;i=this.dragDirection.horizontal;return this.floating?i==="right"||t==="down"?2:1:t&&(t==="down"?2:1)},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),n=this.dragDirection.vertical,r=this.dragDirection.horizontal;if(this.floating&&r){return r==="right"&&i||r==="left"&&!i}else{return n&&(n==="down"&&t||n==="up"&&!t)}},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return e!==0&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return e!==0&&(e>0?"right":"left")},refresh:function(e){this._refreshItems(e);this._setHandleClassName();this.refreshPositions();return this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(e){var t,i,n,r,s=[],o=[],a=this._connectWith();if(a&&e){for(t=a.length-1;t>=0;t--){n=te(a[t],this.document[0]);for(i=n.length-1;i>=0;i--){r=te.data(n[i],this.widgetFullName);if(r&&r!==this&&!r.options.disabled){o.push([typeof r.options.items==="function"?r.options.items.call(r.element):te(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r])}}}}o.push([typeof this.options.items==="function"?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):te(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);function l(){s.push(this)}for(t=o.length-1;t>=0;t--){o[t][0].each(l)}return te(s)},_removeCurrentsFromItems:function(){var i=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=te.grep(this.items,function(e){for(var t=0;t<i.length;t++){if(i[t]===e.item[0]){return false}}return true})},_refreshItems:function(e){this.items=[];this.containers=[this];var t,i,n,r,s,o,a,l,c=this.items,u=[[typeof this.options.items==="function"?this.options.items.call(this.element[0],e,{item:this.currentItem}):te(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready){for(t=d.length-1;t>=0;t--){n=te(d[t],this.document[0]);for(i=n.length-1;i>=0;i--){r=te.data(n[i],this.widgetFullName);if(r&&r!==this&&!r.options.disabled){u.push([typeof r.options.items==="function"?r.options.items.call(r.element[0],e,{item:this.currentItem}):te(r.options.items,r.element),r]);this.containers.push(r)}}}}for(t=u.length-1;t>=0;t--){s=u[t][1];o=u[t][0];for(i=0,l=o.length;i<l;i++){a=te(o[i]);a.data(this.widgetName+"-item",s);c.push({item:a,instance:s,width:0,height:0,left:0,top:0})}}},_refreshItemPositions:function(e){var t,i,n,r;for(t=this.items.length-1;t>=0;t--){i=this.items[t];if(this.currentContainer&&i.instance!==this.currentContainer&&i.item[0]!==this.currentItem[0]){continue}n=this.options.toleranceElement?te(this.options.toleranceElement,i.item):i.item;if(!e){i.width=n.outerWidth();i.height=n.outerHeight()}r=n.offset();i.left=r.left;i.top=r.top}},refreshPositions:function(e){this.floating=this.items.length?this.options.axis==="x"||this._isFloating(this.items[0].item):false;if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}this._refreshItemPositions(e);var t,i;if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(t=this.containers.length-1;t>=0;t--){i=this.containers[t].element.offset();this.containers[t].containerCache.left=i.left;this.containers[t].containerCache.top=i.top;this.containers[t].containerCache.width=this.containers[t].element.outerWidth();this.containers[t].containerCache.height=this.containers[t].element.outerHeight()}}return this},_createPlaceholder:function(i){i=i||this;var n,r,s=i.options;if(!s.placeholder||s.placeholder.constructor===String){n=s.placeholder;r=i.currentItem[0].nodeName.toLowerCase();s.placeholder={element:function(){var e=te("<"+r+">",i.document[0]);i._addClass(e,"ui-sortable-placeholder",n||i.currentItem[0].className)._removeClass(e,"ui-sortable-helper");if(r==="tbody"){i._createTrPlaceholder(i.currentItem.find("tr").eq(0),te("<tr>",i.document[0]).appendTo(e))}else if(r==="tr"){i._createTrPlaceholder(i.currentItem,e)}else if(r==="img"){e.attr("src",i.currentItem.attr("src"))}if(!n){e.css("visibility","hidden")}return e},update:function(e,t){if(n&&!s.forcePlaceholderSize){return}if(!t.height()||s.forcePlaceholderSize&&(r==="tbody"||r==="tr")){t.height(i.currentItem.innerHeight()-parseInt(i.currentItem.css("paddingTop")||0,10)-parseInt(i.currentItem.css("paddingBottom")||0,10))}if(!t.width()){t.width(i.currentItem.innerWidth()-parseInt(i.currentItem.css("paddingLeft")||0,10)-parseInt(i.currentItem.css("paddingRight")||0,10))}}}}i.placeholder=te(s.placeholder.element.call(i.element,i.currentItem));i.currentItem.after(i.placeholder);s.placeholder.update(i,i.placeholder)},_createTrPlaceholder:function(e,t){var i=this;e.children().each(function(){te("<td>&#160;</td>",i.document[0]).attr("colspan",te(this).attr("colspan")||1).appendTo(t)})},_contactContainers:function(e){var t,i,n,r,s,o,a,l,c,u,d=null,h=null;for(t=this.containers.length-1;t>=0;t--){if(te.contains(this.currentItem[0],this.containers[t].element[0])){continue}if(this._intersectsWith(this.containers[t].containerCache)){if(d&&te.contains(this.containers[t].element[0],d.element[0])){continue}d=this.containers[t];h=t}else{if(this.containers[t].containerCache.over){this.containers[t]._trigger("out",e,this._uiHash(this));this.containers[t].containerCache.over=0}}}if(!d){return}if(this.containers.length===1){if(!this.containers[h].containerCache.over){this.containers[h]._trigger("over",e,this._uiHash(this));this.containers[h].containerCache.over=1}}else{n=1e4;r=null;c=d.floating||this._isFloating(this.currentItem);s=c?"left":"top";o=c?"width":"height";u=c?"pageX":"pageY";for(i=this.items.length-1;i>=0;i--){if(!te.contains(this.containers[h].element[0],this.items[i].item[0])){continue}if(this.items[i].item[0]===this.currentItem[0]){continue}a=this.items[i].item.offset()[s];l=false;if(e[u]-a>this.items[i][o]/2){l=true}if(Math.abs(e[u]-a)<n){n=Math.abs(e[u]-a);r=this.items[i];this.direction=l?"up":"down"}}if(!r&&!this.options.dropOnEmpty){return}if(this.currentContainer===this.containers[h]){if(!this.currentContainer.containerCache.over){this.containers[h]._trigger("over",e,this._uiHash());this.currentContainer.containerCache.over=1}return}if(r){this._rearrange(e,r,null,true)}else{this._rearrange(e,null,this.containers[h].element,true)}this._trigger("change",e,this._uiHash());this.containers[h]._trigger("change",e,this._uiHash(this));this.currentContainer=this.containers[h];this.options.placeholder.update(this.currentContainer,this.placeholder);this.scrollParent=this.placeholder.scrollParent();if(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset()}this.containers[h]._trigger("over",e,this._uiHash(this));this.containers[h].containerCache.over=1}},_createHelper:function(e){var t=this.options,i=typeof t.helper==="function"?te(t.helper.apply(this.element[0],[e,this.currentItem])):t.helper==="clone"?this.currentItem.clone():this.currentItem;if(!i.parents("body").length){this.appendTo[0].appendChild(i[0])}if(i[0]===this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(!i[0].style.width||t.forceHelperSize){i.width(this.currentItem.width())}if(!i[0].style.height||t.forceHelperSize){i.height(this.currentItem.height())}return i},_adjustOffsetFromHelper:function(e){if(typeof e==="function"){e=e.call(this)}if(typeof e==="string"){e=e.split(" ")}if(Array.isArray(e)){e={left:+e[0],top:+e[1]||0}}if("left"in e){this.offset.click.left=e.left+this.margins.left}if("right"in e){this.offset.click.left=this.helperProportions.width-e.right+this.margins.left}if("top"in e){this.offset.click.top=e.top+this.margins.top}if("bottom"in e){this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==this.document[0]&&te.contains(this.scrollParent[0],this.offsetParent[0])){e.left+=this.scrollParent.scrollLeft();e.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&te.ui.ie){e={top:0,left:0}}return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,i,n=this.options;if(n.containment==="parent"){n.containment=this.helper[0].parentNode}if(n.containment==="document"||n.containment==="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,n.containment==="document"?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,(n.containment==="document"?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!/^(document|window|parent)$/.test(n.containment)){e=te(n.containment)[0];t=te(n.containment).offset();i=te(e).css("overflow")!=="hidden";this.containment=[t.left+(parseInt(te(e).css("borderLeftWidth"),10)||0)+(parseInt(te(e).css("paddingLeft"),10)||0)-this.margins.left,t.top+(parseInt(te(e).css("borderTopWidth"),10)||0)+(parseInt(te(e).css("paddingTop"),10)||0)-this.margins.top,t.left+(i?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(te(e).css("borderLeftWidth"),10)||0)-(parseInt(te(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,t.top+(i?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(te(e).css("borderTopWidth"),10)||0)-(parseInt(te(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(e,t){if(!t){t=this.position}var i=e==="absolute"?1:-1,n=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&te.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,r=/(html|body)/i.test(n[0].tagName);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():r?0:n.scrollTop())*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():r?0:n.scrollLeft())*i}},_generatePosition:function(e){var t,i,n=this.options,r=e.pageX,s=e.pageY,o=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&te.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,a=/(html|body)/i.test(o[0].tagName);if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}if(this.originalPosition){if(this.containment){if(e.pageX-this.offset.click.left<this.containment[0]){r=this.containment[0]+this.offset.click.left}if(e.pageY-this.offset.click.top<this.containment[1]){s=this.containment[1]+this.offset.click.top}if(e.pageX-this.offset.click.left>this.containment[2]){r=this.containment[2]+this.offset.click.left}if(e.pageY-this.offset.click.top>this.containment[3]){s=this.containment[3]+this.offset.click.top}}if(n.grid){t=this.originalPageY+Math.round((s-this.originalPageY)/n.grid[1])*n.grid[1];s=this.containment?t-this.offset.click.top>=this.containment[1]&&t-this.offset.click.top<=this.containment[3]?t:t-this.offset.click.top>=this.containment[1]?t-n.grid[1]:t+n.grid[1]:t;i=this.originalPageX+Math.round((r-this.originalPageX)/n.grid[0])*n.grid[0];r=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-n.grid[0]:i+n.grid[0]:i}}return{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():a?0:o.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():a?0:o.scrollLeft())}},_rearrange:function(e,t,i,n){if(i){i[0].appendChild(this.placeholder[0])}else{t.item[0].parentNode.insertBefore(this.placeholder[0],this.direction==="down"?t.item[0]:t.item[0].nextSibling)}this.counter=this.counter?++this.counter:1;var r=this.counter;this._delay(function(){if(r===this.counter){this.refreshPositions(!n)}})},_clear:function(e,t){this.reverting=false;var i,n=[];if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(i in this._storedCSS){if(this._storedCSS[i]==="auto"||this._storedCSS[i]==="static"){this._storedCSS[i]=""}}this.currentItem.css(this._storedCSS);this._removeClass(this.currentItem,"ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!t){n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!t){n.push(function(e){this._trigger("update",e,this._uiHash())})}if(this!==this.currentContainer){if(!t){n.push(function(e){this._trigger("remove",e,this._uiHash())});n.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer));n.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer))}}function r(t,i,n){return function(e){n._trigger(t,e,i._uiHash(i))}}for(i=this.containers.length-1;i>=0;i--){if(!t){n.push(r("deactivate",this,this.containers[i]))}if(this.containers[i].containerCache.over){n.push(r("out",this,this.containers[i]));this.containers[i].containerCache.over=0}}if(this.storedCursor){this.document.find("body").css("cursor",this.storedCursor);this.storedStylesheet.remove()}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex)}this.dragging=false;if(!t){this._trigger("beforeStop",e,this._uiHash())}this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(!this.cancelHelperRemoval){if(this.helper[0]!==this.currentItem[0]){this.helper.remove()}this.helper=null}if(!t){for(i=0;i<n.length;i++){n[i].call(this,e)}this._trigger("stop",e,this._uiHash())}this.fromOutside=false;return!this.cancelHelperRemoval},_trigger:function(){if(te.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel()}},_uiHash:function(e){var t=e||this;return{helper:t.helper,placeholder:t.placeholder||te([]),position:t.position,originalPosition:t.originalPosition,offset:t.positionAbs,item:t.currentItem,sender:e?e.element:null}}});function P(t){return function(){var e=this.element.val();t.apply(this,arguments);this._refresh();if(e!==this.element.val()){this._trigger("change")}}}te.widget("ui.spinner",{version:"1.13.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:true,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);this._setOption("min",this.options.min);this._setOption("step",this.options.step);if(this.value()!==""){this._value(this.element.val(),true)}this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var n=this._super();var r=this.element;te.each(["min","max","step"],function(e,t){var i=r.attr(t);if(i!=null&&i.length){n[t]=i}});return n},_events:{keydown:function(e){if(this._start(e)&&this._keydown(e)){e.preventDefault()}},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){if(this.cancelBlur){delete this.cancelBlur;return}this._stop();this._refresh();if(this.previous!==this.element.val()){this._trigger("change",e)}},mousewheel:function(e,t){var i=te.ui.safeActiveElement(this.document[0]);var n=this.element[0]===i;if(!n||!t){return}if(!this.spinning&&!this._start(e)){return false}this._spin((t>0?1:-1)*this.options.step,e);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){if(this.spinning){this._stop(e)}},100);e.preventDefault()},"mousedown .ui-spinner-button":function(e){var t;t=this.element[0]===te.ui.safeActiveElement(this.document[0])?this.previous:this.element.val();function i(){var e=this.element[0]===te.ui.safeActiveElement(this.document[0]);if(!e){this.element.trigger("focus");this.previous=t;this._delay(function(){this.previous=t})}}e.preventDefault();i.call(this);this.cancelBlur=true;this._delay(function(){delete this.cancelBlur;i.call(this)});if(this._start(e)===false){return}this._repeat(null,te(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){if(!te(e.currentTarget).hasClass("ui-state-active")){return}if(this._start(e)===false){return false}this._repeat(null,te(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance();this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content");this._addClass("ui-spinner-input");this.element.attr("role","spinbutton");this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",true).button({classes:{"ui-button":""}});this._removeClass(this.buttons,"ui-corner-all");this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up");this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down");this.buttons.first().button({icon:this.options.icons.up,showLabel:false});this.buttons.last().button({icon:this.options.icons.down,showLabel:false});if(this.buttons.height()>Math.ceil(this.uiSpinner.height()*.5)&&this.uiSpinner.height()>0){this.uiSpinner.height(this.uiSpinner.height())}},_keydown:function(e){var t=this.options,i=te.ui.keyCode;switch(e.keyCode){case i.UP:this._repeat(null,1,e);return true;case i.DOWN:this._repeat(null,-1,e);return true;case i.PAGE_UP:this._repeat(null,t.page,e);return true;case i.PAGE_DOWN:this._repeat(null,-t.page,e);return true}return false},_start:function(e){if(!this.spinning&&this._trigger("start",e)===false){return false}if(!this.counter){this.counter=1}this.spinning=true;return true},_repeat:function(e,t,i){e=e||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,t,i)},e);this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;if(!this.counter){this.counter=1}i=this._adjustValue(i+e*this._increment(this.counter));if(!this.spinning||this._trigger("spin",t,{value:i})!==false){this._value(i);this.counter++}},_increment:function(e){var t=this.options.incremental;if(t){return typeof t==="function"?t(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1)}return 1},_precision:function(){var e=this._precisionOf(this.options.step);if(this.options.min!==null){e=Math.max(e,this._precisionOf(this.options.min))}return e},_precisionOf:function(e){var t=e.toString(),i=t.indexOf(".");return i===-1?0:t.length-i-1},_adjustValue:function(e){var t,i,n=this.options;t=n.min!==null?n.min:0;i=e-t;i=Math.round(i/n.step)*n.step;e=t+i;e=parseFloat(e.toFixed(this._precision()));if(n.max!==null&&e>n.max){return n.max}if(n.min!==null&&e<n.min){return n.min}return e},_stop:function(e){if(!this.spinning){return}clearTimeout(this.timer);clearTimeout(this.mousewheelTimer);this.counter=0;this.spinning=false;this._trigger("stop",e)},_setOption:function(e,t){var i,n,r;if(e==="culture"||e==="numberFormat"){i=this._parse(this.element.val());this.options[e]=t;this.element.val(this._format(i));return}if(e==="max"||e==="min"||e==="step"){if(typeof t==="string"){t=this._parse(t)}}if(e==="icons"){n=this.buttons.first().find(".ui-icon");this._removeClass(n,null,this.options.icons.up);this._addClass(n,null,t.up);r=this.buttons.last().find(".ui-icon");this._removeClass(r,null,this.options.icons.down);this._addClass(r,null,t.down)}this._super(e,t)},_setOptionDisabled:function(e){this._super(e);this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!e);this.element.prop("disabled",!!e);this.buttons.button(e?"disable":"enable")},_setOptions:P(function(e){this._super(e)}),_parse:function(e){if(typeof e==="string"&&e!==""){e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e}return e===""||isNaN(e)?null:e},_format:function(e){if(e===""){return""}return window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();if(e===null){return false}return e===this._adjustValue(e)},_value:function(e,t){var i;if(e!==""){i=this._parse(e);if(i!==null){if(!t){i=this._adjustValue(i)}e=this._format(i)}}this.element.val(e);this._refresh()},_destroy:function(){this.element.prop("disabled",false).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow");this.uiSpinner.replaceWith(this.element)},stepUp:P(function(e){this._stepUp(e)}),_stepUp:function(e){if(this._start()){this._spin((e||1)*this.options.step);this._stop()}},stepDown:P(function(e){this._stepDown(e)}),_stepDown:function(e){if(this._start()){this._spin((e||1)*-this.options.step);this._stop()}},pageUp:P(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:P(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){if(!arguments.length){return this._parse(this.element.val())}P(this._value).call(this,e)},widget:function(){return this.uiSpinner}});if(te.uiBackCompat!==false){te.widget("ui.spinner",te.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}})}var Oe=te.ui.spinner;te.widget("ui.tabs",{version:"1.13.1",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:false,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var n=/#.*$/;return function(e){var t,i;t=e.href.replace(n,"");i=location.href.replace(n,"");try{t=decodeURIComponent(t)}catch(e){}try{i=decodeURIComponent(i)}catch(e){}return e.hash.length>1&&t===i}}(),_create:function(){var t=this,e=this.options;this.running=false;this._addClass("ui-tabs","ui-widget ui-widget-content");this._toggleClass("ui-tabs-collapsible",null,e.collapsible);this._processTabs();e.active=this._initialActive();if(Array.isArray(e.disabled)){e.disabled=te.uniqueSort(e.disabled.concat(te.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()}if(this.options.active!==false&&this.anchors.length){this.active=this._findActive(e.active)}else{this.active=te()}this._refresh();if(this.active.length){this.load(e.active)}},_initialActive:function(){var i=this.options.active,e=this.options.collapsible,n=location.hash.substring(1);if(i===null){if(n){this.tabs.each(function(e,t){if(te(t).attr("aria-controls")===n){i=e;return false}})}if(i===null){i=this.tabs.index(this.tabs.filter(".ui-tabs-active"))}if(i===null||i===-1){i=this.tabs.length?0:false}}if(i!==false){i=this.tabs.index(this.tabs.eq(i));if(i===-1){i=e?false:0}}if(!e&&i===false&&this.anchors.length){i=0}return i},_getCreateEventData:function(){return{tab:this.active,panel:!this.active.length?te():this._getPanelForTab(this.active)}},_tabKeydown:function(e){var t=te(te.ui.safeActiveElement(this.document[0])).closest("li"),i=this.tabs.index(t),n=true;if(this._handlePageNav(e)){return}switch(e.keyCode){case te.ui.keyCode.RIGHT:case te.ui.keyCode.DOWN:i++;break;case te.ui.keyCode.UP:case te.ui.keyCode.LEFT:n=false;i--;break;case te.ui.keyCode.END:i=this.anchors.length-1;break;case te.ui.keyCode.HOME:i=0;break;case te.ui.keyCode.SPACE:e.preventDefault();clearTimeout(this.activating);this._activate(i);return;case te.ui.keyCode.ENTER:e.preventDefault();clearTimeout(this.activating);this._activate(i===this.options.active?false:i);return;default:return}e.preventDefault();clearTimeout(this.activating);i=this._focusNextTab(i,n);if(!e.ctrlKey&&!e.metaKey){t.attr("aria-selected","false");this.tabs.eq(i).attr("aria-selected","true");this.activating=this._delay(function(){this.option("active",i)},this.delay)}},_panelKeydown:function(e){if(this._handlePageNav(e)){return}if(e.ctrlKey&&e.keyCode===te.ui.keyCode.UP){e.preventDefault();this.active.trigger("focus")}},_handlePageNav:function(e){if(e.altKey&&e.keyCode===te.ui.keyCode.PAGE_UP){this._activate(this._focusNextTab(this.options.active-1,false));return true}if(e.altKey&&e.keyCode===te.ui.keyCode.PAGE_DOWN){this._activate(this._focusNextTab(this.options.active+1,true));return true}},_findNextTab:function(e,t){var i=this.tabs.length-1;function n(){if(e>i){e=0}if(e<0){e=i}return e}while(te.inArray(n(),this.options.disabled)!==-1){e=t?e+1:e-1}return e},_focusNextTab:function(e,t){e=this._findNextTab(e,t);this.tabs.eq(e).trigger("focus");return e},_setOption:function(e,t){if(e==="active"){this._activate(t);return}this._super(e,t);if(e==="collapsible"){this._toggleClass("ui-tabs-collapsible",null,t);if(!t&&this.options.active===false){this._activate(0)}}if(e==="event"){this._setupEvents(t)}if(e==="heightStyle"){this._setupHeightStyle(t)}},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,t=this.tablist.children(":has(a[href])");e.disabled=te.map(t.filter(".ui-state-disabled"),function(e){return t.index(e)});this._processTabs();if(e.active===false||!this.anchors.length){e.active=false;this.active=te()}else if(this.active.length&&!te.contains(this.tablist[0],this.active[0])){if(this.tabs.length===e.disabled.length){e.active=false;this.active=te()}else{this._activate(this._findNextTab(Math.max(0,e.active-1),false))}}else{e.active=this.tabs.index(this.active)}this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"});if(!this.active.length){this.tabs.eq(0).attr("tabIndex",0)}else{this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0});this._addClass(this.active,"ui-tabs-active","ui-state-active");this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})}},_processTabs:function(){var l=this,e=this.tabs,t=this.anchors,i=this.panels;this.tablist=this._getList().attr("role","tablist");this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header");this.tablist.on("mousedown"+this.eventNamespace,"> li",function(e){if(te(this).is(".ui-state-disabled")){e.preventDefault()}}).on("focus"+this.eventNamespace,".ui-tabs-anchor",function(){if(te(this).closest("li").is(".ui-state-disabled")){this.blur()}});this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1});this._addClass(this.tabs,"ui-tabs-tab","ui-state-default");this.anchors=this.tabs.map(function(){return te("a",this)[0]}).attr({tabIndex:-1});this._addClass(this.anchors,"ui-tabs-anchor");this.panels=te();this.anchors.each(function(e,t){var i,n,r,s=te(t).uniqueId().attr("id"),o=te(t).closest("li"),a=o.attr("aria-controls");if(l._isLocal(t)){i=t.hash;r=i.substring(1);n=l.element.find(l._sanitizeSelector(i))}else{r=o.attr("aria-controls")||te({}).uniqueId()[0].id;i="#"+r;n=l.element.find(i);if(!n.length){n=l._createPanel(r);n.insertAfter(l.panels[e-1]||l.tablist)}n.attr("aria-live","polite")}if(n.length){l.panels=l.panels.add(n)}if(a){o.data("ui-tabs-aria-controls",a)}o.attr({"aria-controls":r,"aria-labelledby":s});n.attr("aria-labelledby",s)});this.panels.attr("role","tabpanel");this._addClass(this.panels,"ui-tabs-panel","ui-widget-content");if(e){this._off(e.not(this.tabs));this._off(t.not(this.anchors));this._off(i.not(this.panels))}},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(e){return te("<div>").attr("id",e).data("ui-tabs-destroy",true)},_setOptionDisabled:function(e){var t,i,n;if(Array.isArray(e)){if(!e.length){e=false}else if(e.length===this.anchors.length){e=true}}for(n=0;i=this.tabs[n];n++){t=te(i);if(e===true||te.inArray(n,e)!==-1){t.attr("aria-disabled","true");this._addClass(t,null,"ui-state-disabled")}else{t.removeAttr("aria-disabled");this._removeClass(t,null,"ui-state-disabled")}}this.options.disabled=e;this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,e===true)},_setupEvents:function(e){var i={};if(e){te.each(e.split(" "),function(e,t){i[t]="_eventHandler"})}this._off(this.anchors.add(this.tabs).add(this.panels));this._on(true,this.anchors,{click:function(e){e.preventDefault()}});this._on(this.anchors,i);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,t=this.element.parent();if(e==="fill"){i=t.height();i-=this.element.outerHeight()-this.element.height();this.element.siblings(":visible").each(function(){var e=te(this),t=e.css("position");if(t==="absolute"||t==="fixed"){return}i-=e.outerHeight(true)});this.element.children().not(this.panels).each(function(){i-=te(this).outerHeight(true)});this.panels.each(function(){te(this).height(Math.max(0,i-te(this).innerHeight()+te(this).height()))}).css("overflow","auto")}else if(e==="auto"){i=0;this.panels.each(function(){i=Math.max(i,te(this).height("").height())}).height(i)}},_eventHandler:function(e){var t=this.options,i=this.active,n=te(e.currentTarget),r=n.closest("li"),s=r[0]===i[0],o=s&&t.collapsible,a=o?te():this._getPanelForTab(r),l=!i.length?te():this._getPanelForTab(i),c={oldTab:i,oldPanel:l,newTab:o?te():r,newPanel:a};e.preventDefault();if(r.hasClass("ui-state-disabled")||r.hasClass("ui-tabs-loading")||this.running||s&&!t.collapsible||this._trigger("beforeActivate",e,c)===false){return}t.active=o?false:this.tabs.index(r);this.active=s?te():r;if(this.xhr){this.xhr.abort()}if(!l.length&&!a.length){te.error("jQuery UI Tabs: Mismatching fragment identifier.")}if(a.length){this.load(this.tabs.index(r),e)}this._toggle(e,c)},_toggle:function(e,t){var i=this,n=t.newPanel,r=t.oldPanel;this.running=true;function s(){i.running=false;i._trigger("activate",e,t)}function o(){i._addClass(t.newTab.closest("li"),"ui-tabs-active","ui-state-active");if(n.length&&i.options.show){i._show(n,i.options.show,s)}else{n.show();s()}}if(r.length&&this.options.hide){this._hide(r,this.options.hide,function(){i._removeClass(t.oldTab.closest("li"),"ui-tabs-active","ui-state-active");o()})}else{this._removeClass(t.oldTab.closest("li"),"ui-tabs-active","ui-state-active");r.hide();o()}r.attr("aria-hidden","true");t.oldTab.attr({"aria-selected":"false","aria-expanded":"false"});if(n.length&&r.length){t.oldTab.attr("tabIndex",-1)}else if(n.length){this.tabs.filter(function(){return te(this).attr("tabIndex")===0}).attr("tabIndex",-1)}n.attr("aria-hidden","false");t.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(e){var t,i=this._findActive(e);if(i[0]===this.active[0]){return}if(!i.length){i=this.active}t=i.find(".ui-tabs-anchor")[0];this._eventHandler({target:t,currentTarget:t,preventDefault:te.noop})},_findActive:function(e){return e===false?te():this.tabs.eq(e)},_getIndex:function(e){if(typeof e==="string"){e=this.anchors.index(this.anchors.filter("[href$='"+te.escapeSelector(e)+"']"))}return e},_destroy:function(){if(this.xhr){this.xhr.abort()}this.tablist.removeAttr("role").off(this.eventNamespace);this.anchors.removeAttr("role tabIndex").removeUniqueId();this.tabs.add(this.panels).each(function(){if(te.data(this,"ui-tabs-destroy")){te(this).remove()}else{te(this).removeAttr("role tabIndex "+"aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")}});this.tabs.each(function(){var e=te(this),t=e.data("ui-tabs-aria-controls");if(t){e.attr("aria-controls",t).removeData("ui-tabs-aria-controls")}else{e.removeAttr("aria-controls")}});this.panels.show();if(this.options.heightStyle!=="content"){this.panels.css("height","")}},enable:function(i){var e=this.options.disabled;if(e===false){return}if(i===undefined){e=false}else{i=this._getIndex(i);if(Array.isArray(e)){e=te.map(e,function(e){return e!==i?e:null})}else{e=te.map(this.tabs,function(e,t){return t!==i?t:null})}}this._setOptionDisabled(e)},disable:function(e){var t=this.options.disabled;if(t===true){return}if(e===undefined){t=true}else{e=this._getIndex(e);if(te.inArray(e,t)!==-1){return}if(Array.isArray(t)){t=te.merge([e],t).sort()}else{t=[e]}}this._setOptionDisabled(t)},load:function(e,n){e=this._getIndex(e);var r=this,i=this.tabs.eq(e),t=i.find(".ui-tabs-anchor"),s=this._getPanelForTab(i),o={tab:i,panel:s},a=function(e,t){if(t==="abort"){r.panels.stop(false,true)}r._removeClass(i,"ui-tabs-loading");s.removeAttr("aria-busy");if(e===r.xhr){delete r.xhr}};if(this._isLocal(t[0])){return}this.xhr=te.ajax(this._ajaxSettings(t,n,o));if(this.xhr&&this.xhr.statusText!=="canceled"){this._addClass(i,"ui-tabs-loading");s.attr("aria-busy","true");this.xhr.done(function(e,t,i){setTimeout(function(){s.html(e);r._trigger("load",n,o);a(i,t)},1)}).fail(function(e,t){setTimeout(function(){a(e,t)},1)})}},_ajaxSettings:function(e,i,n){var r=this;return{url:e.attr("href").replace(/#.*$/,""),beforeSend:function(e,t){return r._trigger("beforeLoad",i,te.extend({jqXHR:e,ajaxSettings:t},n))}}},_getPanelForTab:function(e){var t=te(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+t))}});if(te.uiBackCompat!==false){te.widget("ui.tabs",te.ui.tabs,{_processTabs:function(){this._superApply(arguments);this._addClass(this.tabs,"ui-tab")}})}var Ie=te.ui.tabs;te.widget("ui.tooltip",{version:"1.13.1",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var e=te(this).attr("title");return te("<a>").text(e).html()},hide:true,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:true,track:false,close:null,open:null},_addDescribedBy:function(e,t){var i=(e.attr("aria-describedby")||"").split(/\s+/);i.push(t);e.data("ui-tooltip-id",t).attr("aria-describedby",String.prototype.trim.call(i.join(" ")))},_removeDescribedBy:function(e){var t=e.data("ui-tooltip-id"),i=(e.attr("aria-describedby")||"").split(/\s+/),n=te.inArray(t,i);if(n!==-1){i.splice(n,1)}e.removeData("ui-tooltip-id");i=String.prototype.trim.call(i.join(" "));if(i){e.attr("aria-describedby",i)}else{e.removeAttr("aria-describedby")}},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={};this.parents={};this.liveRegion=te("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body);this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible");this.disabledTitles=te([])},_setOption:function(e,t){var i=this;this._super(e,t);if(e==="content"){te.each(this.tooltips,function(e,t){i._updateContent(t.element)})}},_setOptionDisabled:function(e){this[e?"_disable":"_enable"]()},_disable:function(){var n=this;te.each(this.tooltips,function(e,t){var i=te.Event("blur");i.target=i.currentTarget=t.element[0];n.close(i,true)});this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function(){var e=te(this);if(e.is("[title]")){return e.data("ui-tooltip-title",e.attr("title")).removeAttr("title")}}))},_enable:function(){this.disabledTitles.each(function(){var e=te(this);if(e.data("ui-tooltip-title")){e.attr("title",e.data("ui-tooltip-title"))}});this.disabledTitles=te([])},open:function(e){var i=this,t=te(e?e.target:this.element).closest(this.options.items);if(!t.length||t.data("ui-tooltip-id")){return}if(t.attr("title")){t.data("ui-tooltip-title",t.attr("title"))}t.data("ui-tooltip-open",true);if(e&&e.type==="mouseover"){t.parents().each(function(){var e=te(this),t;if(e.data("ui-tooltip-open")){t=te.Event("blur");t.target=t.currentTarget=this;i.close(t,true)}if(e.attr("title")){e.uniqueId();i.parents[this.id]={element:this,title:e.attr("title")};e.attr("title","")}})}this._registerCloseHandlers(e,t);this._updateContent(t,e)},_updateContent:function(t,i){var e,n=this.options.content,r=this,s=i?i.type:null;if(typeof n==="string"||n.nodeType||n.jquery){return this._open(i,t,n)}e=n.call(t[0],function(e){r._delay(function(){if(!t.data("ui-tooltip-open")){return}if(i){i.type=s}this._open(i,t,e)})});if(e){this._open(i,t,e)}},_open:function(e,t,i){var n,r,s,o,a=te.extend({},this.options.position);if(!i){return}n=this._find(t);if(n){n.tooltip.find(".ui-tooltip-content").html(i);return}if(t.is("[title]")){if(e&&e.type==="mouseover"){t.attr("title","")}else{t.removeAttr("title")}}n=this._tooltip(t);r=n.tooltip;this._addDescribedBy(t,r.attr("id"));r.find(".ui-tooltip-content").html(i);this.liveRegion.children().hide();o=te("<div>").html(r.find(".ui-tooltip-content").html());o.removeAttr("name").find("[name]").removeAttr("name");o.removeAttr("id").find("[id]").removeAttr("id");o.appendTo(this.liveRegion);function l(e){a.of=e;if(r.is(":hidden")){return}r.position(a)}if(this.options.track&&e&&/^mouse/.test(e.type)){this._on(this.document,{mousemove:l});l(e)}else{r.position(te.extend({of:t},this.options.position))}r.hide();this._show(r,this.options.show);if(this.options.track&&this.options.show&&this.options.show.delay){s=this.delayedShow=setInterval(function(){if(r.is(":visible")){l(a.of);clearInterval(s)}},13)}this._trigger("open",e,{tooltip:r})},_registerCloseHandlers:function(e,i){var t={keyup:function(e){if(e.keyCode===te.ui.keyCode.ESCAPE){var t=te.Event(e);t.currentTarget=i[0];this.close(t,true)}}};if(i[0]!==this.element[0]){t.remove=function(){var e=this._find(i);if(e){this._removeTooltip(e.tooltip)}}}if(!e||e.type==="mouseover"){t.mouseleave="close"}if(!e||e.type==="focusin"){t.focusout="close"}this._on(true,i,t)},close:function(e){var t,i=this,n=te(e?e.currentTarget:this.element),r=this._find(n);if(!r){n.removeData("ui-tooltip-open");return}t=r.tooltip;if(r.closing){return}clearInterval(this.delayedShow);if(n.data("ui-tooltip-title")&&!n.attr("title")){n.attr("title",n.data("ui-tooltip-title"))}this._removeDescribedBy(n);r.hiding=true;t.stop(true);this._hide(t,this.options.hide,function(){i._removeTooltip(te(this))});n.removeData("ui-tooltip-open");this._off(n,"mouseleave focusout keyup");if(n[0]!==this.element[0]){this._off(n,"remove")}this._off(this.document,"mousemove");if(e&&e.type==="mouseleave"){te.each(this.parents,function(e,t){te(t.element).attr("title",t.title);delete i.parents[e]})}r.closing=true;this._trigger("close",e,{tooltip:t});if(!r.hiding){r.closing=false}},_tooltip:function(e){var t=te("<div>").attr("role","tooltip"),i=te("<div>").appendTo(t),n=t.uniqueId().attr("id");this._addClass(i,"ui-tooltip-content");this._addClass(t,"ui-tooltip","ui-widget ui-widget-content");t.appendTo(this._appendTo(e));return this.tooltips[n]={element:e,tooltip:t}},_find:function(e){var t=e.data("ui-tooltip-id");return t?this.tooltips[t]:null},_removeTooltip:function(e){clearInterval(this.delayedShow);e.remove();delete this.tooltips[e.attr("id")]},_appendTo:function(e){var t=e.closest(".ui-front, dialog");if(!t.length){t=this.document[0].body}return t},_destroy:function(){var r=this;te.each(this.tooltips,function(e,t){var i=te.Event("blur"),n=t.element;i.target=i.currentTarget=n[0];r.close(i,true);te("#"+e).remove();if(n.data("ui-tooltip-title")){if(!n.attr("title")){n.attr("title",n.data("ui-tooltip-title"))}n.removeData("ui-tooltip-title")}});this.liveRegion.remove()}});if(te.uiBackCompat!==false){te.widget("ui.tooltip",te.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var e=this._superApply(arguments);if(this.options.tooltipClass){e.tooltip.addClass(this.options.tooltipClass)}return e}})}var Pe=te.ui.tooltip});(function(){var au;var Hu="4.17.21";var Bu=200;var Vu="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",lu="Expected a function",Wu="Invalid `variable` option passed into `_.template`";var zu="__lodash_hash_undefined__";var ju=500;var Uu="__lodash_placeholder__";var cu=1,Yu=2,uu=4;var du=1,qu=2;var hu=1,pu=2,Ku=4,fu=8,gu=16,mu=32,vu=64,yu=128,Xu=256,Qu=512;var Zu=30,Ju="...";var ed=800,td=16;var id=1,nd=2,rd=3;var bu=1/0,Cu=9007199254740991,sd=17976931348623157e292,od=0/0;var wu=4294967295,ad=wu-1,ld=wu>>>1;var cd=[["ary",yu],["bind",hu],["bindKey",pu],["curry",fu],["curryRight",gu],["flip",Qu],["partial",mu],["partialRight",vu],["rearg",Xu]];var _u="[object Arguments]",ud="[object Array]",dd="[object AsyncFunction]",hd="[object Boolean]",pd="[object Date]",fd="[object DOMException]",gd="[object Error]",md="[object Function]",vd="[object GeneratorFunction]",Au="[object Map]",yd="[object Number]",bd="[object Null]",Eu="[object Object]",Cd="[object Promise]",wd="[object Proxy]",_d="[object RegExp]",Su="[object Set]",Ad="[object String]",Ed="[object Symbol]",Sd="[object Undefined]",Td="[object WeakMap]",xd="[object WeakSet]";var Dd="[object ArrayBuffer]",Tu="[object DataView]",Rd="[object Float32Array]",Md="[object Float64Array]",Nd="[object Int8Array]",Od="[object Int16Array]",Id="[object Int32Array]",Pd="[object Uint8Array]",kd="[object Uint8ClampedArray]",Ld="[object Uint16Array]",Fd="[object Uint32Array]";var Gd=/\b__p \+= '';/g,$d=/\b(__p \+=) '' \+/g,Hd=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var Bd=/&(?:amp|lt|gt|quot|#39);/g,Vd=/[&<>"']/g,Wd=RegExp(Bd.source),zd=RegExp(Vd.source);var jd=/<%-([\s\S]+?)%>/g,Ud=/<%([\s\S]+?)%>/g,Yd=/<%=([\s\S]+?)%>/g;var qd=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Kd=/^\w*$/,Xd=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var Qd=/[\\^$.*+?()[\]{}|]/g,Zd=RegExp(Qd.source);var Jd=/^\s+/;var n=/\s/;var eh=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,th=/\{\n\/\* \[wrapped with (.+)\] \*/,ih=/,? & /;var r=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var nh=/[()=,{}\[\]\/\s]/;var rh=/\\(\\)?/g;var sh=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var oh=/\w*$/;var ah=/^[-+]0x[0-9a-f]+$/i;var lh=/^0b[01]+$/i;var ch=/^\[object .+?Constructor\]$/;var uh=/^0o[0-7]+$/i;var dh=/^(?:0|[1-9]\d*)$/;var hh=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g;var ph=/($^)/;var fh=/['\n\r\u2028\u2029\\]/g;var s="\\ud800-\\udfff",o="\\u0300-\\u036f",a="\\ufe20-\\ufe2f",l="\\u20d0-\\u20ff",c=o+a+l,u="\\u2700-\\u27bf",d="a-z\\xdf-\\xf6\\xf8-\\xff",h="\\xac\\xb1\\xd7\\xf7",p="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",f="\\u2000-\\u206f",g=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",m="A-Z\\xc0-\\xd6\\xd8-\\xde",v="\\ufe0e\\ufe0f",y=h+p+f+g;var b="['‚Äô]",C="["+s+"]",w="["+y+"]",_="["+c+"]",A="\\d+",E="["+u+"]",S="["+d+"]",T="[^"+s+y+A+u+d+m+"]",x="\\ud83c[\\udffb-\\udfff]",D="(?:"+_+"|"+x+")",R="[^"+s+"]",M="(?:\\ud83c[\\udde6-\\uddff]){2}",N="[\\ud800-\\udbff][\\udc00-\\udfff]",e="["+m+"]",O="\\u200d";var I="(?:"+S+"|"+T+")",P="(?:"+e+"|"+T+")",k="(?:"+b+"(?:d|ll|m|re|s|t|ve))?",L="(?:"+b+"(?:D|LL|M|RE|S|T|VE))?",F=D+"?",G="["+v+"]?",$="(?:"+O+"(?:"+[R,M,N].join("|")+")"+G+F+")*",H="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",B="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",V=G+F+$,W="(?:"+[E,M,N].join("|")+")"+V,z="(?:"+[R+_+"?",_,M,N,C].join("|")+")";var gh=RegExp(b,"g");var mh=RegExp(_,"g");var j=RegExp(x+"(?="+x+")|"+z+V,"g");var U=RegExp([e+"?"+S+"+"+k+"(?="+[w,e,"$"].join("|")+")",P+"+"+L+"(?="+[w,e+I,"$"].join("|")+")",e+"?"+I+"+"+k,e+"+"+L,B,H,A,W].join("|"),"g");var Y=RegExp("["+O+s+c+v+"]");var q=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var vh=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"];var yh=-1;var xu={};xu[Rd]=xu[Md]=xu[Nd]=xu[Od]=xu[Id]=xu[Pd]=xu[kd]=xu[Ld]=xu[Fd]=true;xu[_u]=xu[ud]=xu[Dd]=xu[hd]=xu[Tu]=xu[pd]=xu[gd]=xu[md]=xu[Au]=xu[yd]=xu[Eu]=xu[_d]=xu[Su]=xu[Ad]=xu[Td]=false;var Du={};Du[_u]=Du[ud]=Du[Dd]=Du[Tu]=Du[hd]=Du[pd]=Du[Rd]=Du[Md]=Du[Nd]=Du[Od]=Du[Id]=Du[Au]=Du[yd]=Du[Eu]=Du[_d]=Du[Su]=Du[Ad]=Du[Ed]=Du[Pd]=Du[kd]=Du[Ld]=Du[Fd]=true;Du[gd]=Du[md]=Du[Td]=false;var K={"√Ä":"A","√Å":"A","√Ç":"A","√É":"A","√Ñ":"A","√Ö":"A","√†":"a","√°":"a","√¢":"a","√£":"a","√§":"a","√•":"a","√á":"C","√ß":"c","√ê":"D","√∞":"d","√à":"E","√â":"E","√ä":"E","√ã":"E","√®":"e","√©":"e","√™":"e","√´":"e","√å":"I","√ç":"I","√é":"I","√è":"I","√¨":"i","√≠":"i","√Æ":"i","√Ø":"i","√ë":"N","√±":"n","√í":"O","√ì":"O","√î":"O","√ï":"O","√ñ":"O","√ò":"O","√≤":"o","√≥":"o","√¥":"o","√µ":"o","√∂":"o","√∏":"o","√ô":"U","√ö":"U","√õ":"U","√ú":"U","√π":"u","√∫":"u","√ª":"u","√º":"u","√ù":"Y","√Ω":"y","√ø":"y","√Ü":"Ae","√¶":"ae","√û":"Th","√æ":"th","√ü":"ss","ƒÄ":"A","ƒÇ":"A","ƒÑ":"A","ƒÅ":"a","ƒÉ":"a","ƒÖ":"a","ƒÜ":"C","ƒà":"C","ƒä":"C","ƒå":"C","ƒá":"c","ƒâ":"c","ƒã":"c","ƒç":"c","ƒé":"D","ƒê":"D","ƒè":"d","ƒë":"d","ƒí":"E","ƒî":"E","ƒñ":"E","ƒò":"E","ƒö":"E","ƒì":"e","ƒï":"e","ƒó":"e","ƒô":"e","ƒõ":"e","ƒú":"G","ƒû":"G","ƒ†":"G","ƒ¢":"G","ƒù":"g","ƒü":"g","ƒ°":"g","ƒ£":"g","ƒ§":"H","ƒ¶":"H","ƒ•":"h","ƒß":"h","ƒ®":"I","ƒ™":"I","ƒ¨":"I","ƒÆ":"I","ƒ∞":"I","ƒ©":"i","ƒ´":"i","ƒ≠":"i","ƒØ":"i","ƒ±":"i","ƒ¥":"J","ƒµ":"j","ƒ∂":"K","ƒ∑":"k","ƒ∏":"k","ƒπ":"L","ƒª":"L","ƒΩ":"L","ƒø":"L","≈Å":"L","ƒ∫":"l","ƒº":"l","ƒæ":"l","≈Ä":"l","≈Ç":"l","≈É":"N","≈Ö":"N","≈á":"N","≈ä":"N","≈Ñ":"n","≈Ü":"n","≈à":"n","≈ã":"n","≈å":"O","≈é":"O","≈ê":"O","≈ç":"o","≈è":"o","≈ë":"o","≈î":"R","≈ñ":"R","≈ò":"R","≈ï":"r","≈ó":"r","≈ô":"r","≈ö":"S","≈ú":"S","≈û":"S","≈†":"S","≈õ":"s","≈ù":"s","≈ü":"s","≈°":"s","≈¢":"T","≈§":"T","≈¶":"T","≈£":"t","≈•":"t","≈ß":"t","≈®":"U","≈™":"U","≈¨":"U","≈Æ":"U","≈∞":"U","≈≤":"U","≈©":"u","≈´":"u","≈≠":"u","≈Ø":"u","≈±":"u","≈≥":"u","≈¥":"W","≈µ":"w","≈∂":"Y","≈∑":"y","≈∏":"Y","≈π":"Z","≈ª":"Z","≈Ω":"Z","≈∫":"z","≈º":"z","≈æ":"z","ƒ≤":"IJ","ƒ≥":"ij","≈í":"Oe","≈ì":"oe","≈â":"'n","≈ø":"s"};var X={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};var Q={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};var Z={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};var bh=parseFloat,Ch=parseInt;var J=typeof global=="object"&&global&&global.Object===Object&&global;var ee=typeof self=="object"&&self&&self.Object===Object&&self;var Ru=J||ee||Function("return this")();var te=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var t=te&&typeof module=="object"&&module&&!module.nodeType&&module;var wh=t&&t.exports===te;var ie=wh&&J.process;var i=function(){try{var e=t&&t.require&&t.require("util").types;if(e){return e}return ie&&ie.binding&&ie.binding("util")}catch(e){}}();var _h=i&&i.isArrayBuffer,Ah=i&&i.isDate,Eh=i&&i.isMap,Sh=i&&i.isRegExp,Th=i&&i.isSet,xh=i&&i.isTypedArray;function Mu(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function Dh(e,t,i,n){var r=-1,s=e==null?0:e.length;while(++r<s){var o=e[r];t(n,o,i(o),e)}return n}function Nu(e,t){var i=-1,n=e==null?0:e.length;while(++i<n){if(t(e[i],i,e)===false){break}}return e}function Rh(e,t){var i=e==null?0:e.length;while(i--){if(t(e[i],i,e)===false){break}}return e}function Mh(e,t){var i=-1,n=e==null?0:e.length;while(++i<n){if(!t(e[i],i,e)){return false}}return true}function Ou(e,t){var i=-1,n=e==null?0:e.length,r=0,s=[];while(++i<n){var o=e[i];if(t(o,i,e)){s[r++]=o}}return s}function Nh(e,t){var i=e==null?0:e.length;return!!i&&ku(e,t,0)>-1}function Oh(e,t,i){var n=-1,r=e==null?0:e.length;while(++n<r){if(i(t,e[n])){return true}}return false}function Iu(e,t){var i=-1,n=e==null?0:e.length,r=Array(n);while(++i<n){r[i]=t(e[i],i,e)}return r}function Pu(e,t){var i=-1,n=t.length,r=e.length;while(++i<n){e[r+i]=t[i]}return e}function Ih(e,t,i,n){var r=-1,s=e==null?0:e.length;if(n&&s){i=e[++r]}while(++r<s){i=t(i,e[r],r,e)}return i}function Ph(e,t,i,n){var r=e==null?0:e.length;if(n&&r){i=e[--r]}while(r--){i=t(i,e[r],r,e)}return i}function kh(e,t){var i=-1,n=e==null?0:e.length;while(++i<n){if(t(e[i],i,e)){return true}}return false}var ne=Vh("length");function re(e){return e.split("")}function Lh(e){return e.match(r)||[]}function Fh(e,n,t){var r;t(e,function(e,t,i){if(n(e,t,i)){r=t;return false}});return r}function Gh(e,t,i,n){var r=e.length,s=i+(n?1:-1);while(n?s--:++s<r){if(t(e[s],s,e)){return s}}return-1}function ku(e,t,i){return t===t?oe(e,t,i):Gh(e,Hh,i)}function $h(e,t,i,n){var r=i-1,s=e.length;while(++r<s){if(n(e[r],t)){return r}}return-1}function Hh(e){return e!==e}function Bh(e,t){var i=e==null?0:e.length;return i?jh(e,t)/i:od}function Vh(t){return function(e){return e==null?au:e[t]}}function se(t){return function(e){return t==null?au:t[e]}}function Wh(e,n,r,s,t){t(e,function(e,t,i){r=s?(s=false,e):n(r,e,t,i)});return r}function zh(e,t){var i=e.length;e.sort(t);while(i--){e[i]=e[i].value}return e}function jh(e,t){var i,n=-1,r=e.length;while(++n<r){var s=t(e[n]);if(s!==au){i=i===au?s:i+s}}return i}function Uh(e,t){var i=-1,n=Array(e);while(++i<e){n[i]=t(i)}return n}function Yh(t,e){return Iu(e,function(e){return[e,t[e]]})}function qh(e){return e?e.slice(0,pp(e)+1).replace(Jd,""):e}function Lu(t){return function(e){return t(e)}}function Kh(t,e){return Iu(e,function(e){return t[e]})}function Xh(e,t){return e.has(t)}function Qh(e,t){var i=-1,n=e.length;while(++i<n&&ku(t,e[i],0)>-1){}return i}function Zh(e,t){var i=e.length;while(i--&&ku(t,e[i],0)>-1){}return i}function Jh(e,t){var i=e.length,n=0;while(i--){if(e[i]===t){++n}}return n}var ep=se(K);var tp=se(X);function ip(e){return"\\"+Z[e]}function np(e,t){return e==null?au:e[t]}function rp(e){return Y.test(e)}function sp(e){return q.test(e)}function op(e){var t,i=[];while(!(t=e.next()).done){i.push(t.value)}return i}function ap(e){var i=-1,n=Array(e.size);e.forEach(function(e,t){n[++i]=[t,e]});return n}function lp(t,i){return function(e){return t(i(e))}}function Fu(e,t){var i=-1,n=e.length,r=0,s=[];while(++i<n){var o=e[i];if(o===t||o===Uu){e[i]=Uu;s[r++]=i}}return s}function cp(e){var t=-1,i=Array(e.size);e.forEach(function(e){i[++t]=e});return i}function up(e){var t=-1,i=Array(e.size);e.forEach(function(e){i[++t]=[e,e]});return i}function oe(e,t,i){var n=i-1,r=e.length;while(++n<r){if(e[n]===t){return n}}return-1}function dp(e,t,i){var n=i+1;while(n--){if(e[n]===t){return n}}return n}function hp(e){return rp(e)?ae(e):ne(e)}function Gu(e){return rp(e)?le(e):re(e)}function pp(e){var t=e.length;while(t--&&n.test(e.charAt(t))){}return t}var fp=se(Q);function ae(e){var t=j.lastIndex=0;while(j.test(e)){++t}return t}function le(e){return e.match(j)||[]}function gp(e){return e.match(U)||[]}var ce=function t(e){e=e==null?Ru:$u.defaults(Ru.Object(),e,$u.pick(Ru,vh));var S=e.Array,n=e.Date,G=e.Error,$=e.Function,H=e.Math,p=e.Object,B=e.RegExp,V=e.String,_=e.TypeError;var W=S.prototype,z=$.prototype,j=p.prototype;var U=e["__core-js_shared__"];var Y=z.toString;var A=j.hasOwnProperty;var q=0;var K=function(){var e=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var X=j.toString;var Q=Y.call(p);var Z=Ru._;var J=B("^"+Y.call(A).replace(Qd,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ee=wh?e.Buffer:au,te=e.Symbol,ie=e.Uint8Array,ne=ee?ee.allocUnsafe:au,re=lp(p.getPrototypeOf,p),se=p.create,oe=j.propertyIsEnumerable,ae=W.splice,le=te?te.isConcatSpreadable:au,ce=te?te.iterator:au,ue=te?te.toStringTag:au;var de=function(){try{var e=Jn(p,"defineProperty");e({},"",{});return e}catch(e){}}();var he=e.clearTimeout!==Ru.clearTimeout&&e.clearTimeout,pe=n&&n.now!==Ru.Date.now&&n.now,fe=e.setTimeout!==Ru.setTimeout&&e.setTimeout;var ge=H.ceil,me=H.floor,ve=p.getOwnPropertySymbols,ye=ee?ee.isBuffer:au,be=e.isFinite,Ce=W.join,we=lp(p.keys,p),E=H.max,T=H.min,_e=n.now,Ae=e.parseInt,Ee=H.random,Se=W.reverse;var Te=Jn(e,"DataView"),xe=Jn(e,"Map"),De=Jn(e,"Promise"),Re=Jn(e,"Set"),Me=Jn(e,"WeakMap"),Ne=Jn(p,"create");var Oe=Me&&new Me;var Ie={};var Pe=Lr(Te),ke=Lr(xe),Le=Lr(De),Fe=Lr(Re),Ge=Lr(Me);var $e=te?te.prototype:au,He=$e?$e.valueOf:au,Be=$e?$e.toString:au;function m(e){if(h(e)&&!R(e)&&!(e instanceof y)){if(e instanceof v){return e}if(A.call(e,"__wrapped__")){return Gr(e)}}return new v(e)}var Ve=function(){function i(){}return function(e){if(!M(e)){return{}}if(se){return se(e)}i.prototype=e;var t=new i;i.prototype=au;return t}}();function We(){}function v(e,t){this.__wrapped__=e;this.__actions__=[];this.__chain__=!!t;this.__index__=0;this.__values__=au}m.templateSettings={escape:jd,evaluate:Ud,interpolate:Yd,variable:"",imports:{_:m}};m.prototype=We.prototype;m.prototype.constructor=m;v.prototype=Ve(We.prototype);v.prototype.constructor=v;function y(e){this.__wrapped__=e;this.__actions__=[];this.__dir__=1;this.__filtered__=false;this.__iteratees__=[];this.__takeCount__=wu;this.__views__=[]}function ze(){var e=new y(this.__wrapped__);e.__actions__=w(this.__actions__);e.__dir__=this.__dir__;e.__filtered__=this.__filtered__;e.__iteratees__=w(this.__iteratees__);e.__takeCount__=this.__takeCount__;e.__views__=w(this.__views__);return e}function je(){if(this.__filtered__){var e=new y(this);e.__dir__=-1;e.__filtered__=true}else{e=this.clone();e.__dir__*=-1}return e}function Ue(){var e=this.__wrapped__.value(),t=this.__dir__,i=R(e),n=t<0,r=i?e.length:0,s=nr(0,r,this.__views__),o=s.start,a=s.end,l=a-o,c=n?a:o-1,u=this.__iteratees__,d=u.length,h=0,p=T(l,this.__takeCount__);if(!i||!n&&r==l&&p==l){return Ui(e,this.__actions__)}var f=[];e:while(l--&&h<p){c+=t;var g=-1,m=e[c];while(++g<d){var v=u[g],y=v.iteratee,b=v.type,C=y(m);if(b==nd){m=C}else if(!C){if(b==id){continue e}else{break e}}}f[h++]=m}return f}y.prototype=Ve(We.prototype);y.prototype.constructor=y;function Ye(e){var t=-1,i=e==null?0:e.length;this.clear();while(++t<i){var n=e[t];this.set(n[0],n[1])}}function qe(){this.__data__=Ne?Ne(null):{};this.size=0}function Ke(e){var t=this.has(e)&&delete this.__data__[e];this.size-=t?1:0;return t}function Xe(e){var t=this.__data__;if(Ne){var i=t[e];return i===zu?au:i}return A.call(t,e)?t[e]:au}function Qe(e){var t=this.__data__;return Ne?t[e]!==au:A.call(t,e)}function Ze(e,t){var i=this.__data__;this.size+=this.has(e)?0:1;i[e]=Ne&&t===au?zu:t;return this}Ye.prototype.clear=qe;Ye.prototype["delete"]=Ke;Ye.prototype.get=Xe;Ye.prototype.has=Qe;Ye.prototype.set=Ze;function Je(e){var t=-1,i=e==null?0:e.length;this.clear();while(++t<i){var n=e[t];this.set(n[0],n[1])}}function et(){this.__data__=[];this.size=0}function tt(e){var t=this.__data__,i=St(t,e);if(i<0){return false}var n=t.length-1;if(i==n){t.pop()}else{ae.call(t,i,1)}--this.size;return true}function it(e){var t=this.__data__,i=St(t,e);return i<0?au:t[i][1]}function nt(e){return St(this.__data__,e)>-1}function rt(e,t){var i=this.__data__,n=St(i,e);if(n<0){++this.size;i.push([e,t])}else{i[n][1]=t}return this}Je.prototype.clear=et;Je.prototype["delete"]=tt;Je.prototype.get=it;Je.prototype.has=nt;Je.prototype.set=rt;function st(e){var t=-1,i=e==null?0:e.length;this.clear();while(++t<i){var n=e[t];this.set(n[0],n[1])}}function ot(){this.size=0;this.__data__={hash:new Ye,map:new(xe||Je),string:new Ye}}function at(e){var t=Qn(this,e)["delete"](e);this.size-=t?1:0;return t}function lt(e){return Qn(this,e).get(e)}function ct(e){return Qn(this,e).has(e)}function ut(e,t){var i=Qn(this,e),n=i.size;i.set(e,t);this.size+=i.size==n?0:1;return this}st.prototype.clear=ot;st.prototype["delete"]=at;st.prototype.get=lt;st.prototype.has=ct;st.prototype.set=ut;function dt(e){var t=-1,i=e==null?0:e.length;this.__data__=new st;while(++t<i){this.add(e[t])}}function ht(e){this.__data__.set(e,zu);return this}function pt(e){return this.__data__.has(e)}dt.prototype.add=dt.prototype.push=ht;dt.prototype.has=pt;function b(e){var t=this.__data__=new Je(e);this.size=t.size}function ft(){this.__data__=new Je;this.size=0}function gt(e){var t=this.__data__,i=t["delete"](e);this.size=t.size;return i}function mt(e){return this.__data__.get(e)}function vt(e){return this.__data__.has(e)}function yt(e,t){var i=this.__data__;if(i instanceof Je){var n=i.__data__;if(!xe||n.length<Bu-1){n.push([e,t]);this.size=++i.size;return this}i=this.__data__=new st(n)}i.set(e,t);this.size=i.size;return this}b.prototype.clear=ft;b.prototype["delete"]=gt;b.prototype.get=mt;b.prototype.has=vt;b.prototype.set=yt;function bt(e,t){var i=R(e),n=!i&&ua(e),r=!i&&!n&&pa(e),s=!i&&!n&&!r&&Fa(e),o=i||n||r||s,a=o?Uh(e.length,V):[],l=a.length;for(var c in e){if((t||A.call(e,c))&&!(o&&(c=="length"||r&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||dr(c,l)))){a.push(c)}}return a}function Ct(e){var t=e.length;return t?e[Di(0,t-1)]:au}function wt(e,t){return Ir(w(e),Nt(t,0,e.length))}function _t(e){return Ir(w(e))}function At(e,t,i){if(i!==au&&!d(e[t],i)||i===au&&!(t in e)){Rt(e,t,i)}}function Et(e,t,i){var n=e[t];if(!(A.call(e,t)&&d(n,i))||i===au&&!(t in e)){Rt(e,t,i)}}function St(e,t){var i=e.length;while(i--){if(d(e[i][0],t)){return i}}return-1}function Tt(e,n,r,s){Lt(e,function(e,t,i){n(s,e,r(e),i)});return s}function xt(e,t){return e&&hn(t,k(t),e)}function Dt(e,t){return e&&hn(t,L(t),e)}function Rt(e,t,i){if(t=="__proto__"&&de){de(e,t,{configurable:true,enumerable:true,value:i,writable:true})}else{e[t]=i}}function Mt(e,t){var i=-1,n=t.length,r=S(n),s=e==null;while(++i<n){r[i]=s?au:ul(e,t[i])}return r}function Nt(e,t,i){if(e===e){if(i!==au){e=e<=i?e:i}if(t!==au){e=e>=t?e:t}}return e}function C(i,n,r,e,t,s){var o,a=n&cu,l=n&Yu,c=n&uu;if(r){o=t?r(i,e,t,s):r(i)}if(o!==au){return o}if(!M(i)){return i}var u=R(i);if(u){o=or(i);if(!a){return w(i,o)}}else{var d=x(i),h=d==md||d==vd;if(pa(i)){return tn(i,a)}if(d==Eu||d==_u||h&&!t){o=l||h?{}:ar(i);if(!a){return l?fn(i,Dt(o,i)):pn(i,xt(o,i))}}else{if(!Du[d]){return t?i:{}}o=lr(i,d,a)}}s||(s=new b);var p=s.get(i);if(p){return p}s.set(i,o);if(ka(i)){i.forEach(function(e){o.add(C(e,n,r,e,i,s))})}else if(Ea(i)){i.forEach(function(e,t){o.set(t,C(e,n,r,t,i,s))})}var f=c?l?Yn:Un:l?L:k;var g=u?au:f(i);Nu(g||i,function(e,t){if(g){t=e;e=i[t]}Et(o,t,C(e,n,r,t,i,s))});return o}function Ot(t){var i=k(t);return function(e){return It(e,t,i)}}function It(e,t,i){var n=i.length;if(e==null){return!n}e=p(e);while(n--){var r=i[n],s=t[r],o=e[r];if(o===au&&!(r in e)||!s(o)){return false}}return true}function Pt(e,t,i){if(typeof e!="function"){throw new _(lu)}return Rr(function(){e.apply(au,i)},t)}function kt(e,t,i,n){var r=-1,s=Nh,o=true,a=e.length,l=[],c=t.length;if(!a){return l}if(i){t=Iu(t,Lu(i))}if(n){s=Oh;o=false}else if(t.length>=Bu){s=Xh;o=false;t=new dt(t)}e:while(++r<a){var u=e[r],d=i==null?u:i(u);u=n||u!==0?u:0;if(o&&d===d){var h=c;while(h--){if(t[h]===d){continue e}}l.push(u)}else if(!s(t,d,n)){l.push(u)}}return l}var Lt=vn(o);var Ft=vn(zt,true);function Gt(e,n){var r=true;Lt(e,function(e,t,i){r=!!n(e,t,i);return r});return r}function $t(e,t,i){var n=-1,r=e.length;while(++n<r){var s=e[n],o=t(s);if(o!=null&&(a===au?o===o&&!N(o):i(o,a))){var a=o,l=s}}return l}function Ht(e,t,i,n){var r=e.length;i=O(i);if(i<0){i=-i>r?0:r+i}n=n===au||n>r?r:O(n);if(n<0){n+=r}n=i>n?0:ja(n);while(i<n){e[i++]=t}return e}function Bt(e,n){var r=[];Lt(e,function(e,t,i){if(n(e,t,i)){r.push(e)}});return r}function l(e,t,i,n,r){var s=-1,o=e.length;i||(i=ur);r||(r=[]);while(++s<o){var a=e[s];if(t>0&&i(a)){if(t>1){l(a,t-1,i,n,r)}else{Pu(r,a)}}else if(!n){r[r.length]=a}}return r}var Vt=yn();var Wt=yn(true);function o(e,t){return e&&Vt(e,t,k)}function zt(e,t){return e&&Wt(e,t,k)}function jt(t,e){return Ou(e,function(e){return wa(t[e])})}function Ut(e,t){t=Qi(t,e);var i=0,n=t.length;while(e!=null&&i<n){e=e[kr(t[i++])]}return i&&i==n?e:au}function Yt(e,t,i){var n=t(e);return R(e)?n:Pu(n,i(e))}function r(e){if(e==null){return e===au?Sd:bd}return ue&&ue in p(e)?er(e):Ar(e)}function qt(e,t){return e>t}function Kt(e,t){return e!=null&&A.call(e,t)}function Xt(e,t){return e!=null&&t in p(e)}function Qt(e,t,i){return e>=T(t,i)&&e<E(t,i)}function Zt(e,t,i){var n=i?Oh:Nh,r=e[0].length,s=e.length,o=s,a=S(s),l=Infinity,c=[];while(o--){var u=e[o];if(o&&t){u=Iu(u,Lu(t))}l=T(u.length,l);a[o]=!i&&(t||r>=120&&u.length>=120)?new dt(o&&u):au}u=e[0];var d=-1,h=a[0];e:while(++d<r&&c.length<l){var p=u[d],f=t?t(p):p;p=i||p!==0?p:0;if(!(h?Xh(h,f):n(c,f,i))){o=s;while(--o){var g=a[o];if(!(g?Xh(g,f):n(e[o],f,i))){continue e}}if(h){h.push(f)}c.push(p)}}return c}function Jt(e,n,r,s){o(e,function(e,t,i){n(s,r(e),t,i)});return s}function ei(e,t,i){t=Qi(t,e);e=Sr(e,t);var n=e==null?e:e[kr(s(t))];return n==null?au:Mu(n,e,i)}function ti(e){return h(e)&&r(e)==_u}function ii(e){return h(e)&&r(e)==Dd}function ni(e){return h(e)&&r(e)==pd}function ri(e,t,i,n,r){if(e===t){return true}if(e==null||t==null||!h(e)&&!h(t)){return e!==e&&t!==t}return si(e,t,i,n,ri,r)}function si(e,t,i,n,r,s){var o=R(e),a=R(t),l=o?ud:x(e),c=a?ud:x(t);l=l==_u?Eu:l;c=c==_u?Eu:c;var u=l==Eu,d=c==Eu,h=l==c;if(h&&pa(e)){if(!pa(t)){return false}o=true;u=false}if(h&&!u){s||(s=new b);return o||Fa(e)?Vn(e,t,i,n,r,s):Wn(e,t,l,i,n,r,s)}if(!(i&du)){var p=u&&A.call(e,"__wrapped__"),f=d&&A.call(t,"__wrapped__");if(p||f){var g=p?e.value():e,m=f?t.value():t;s||(s=new b);return r(g,m,i,n,s)}}if(!h){return false}s||(s=new b);return zn(e,t,i,n,r,s)}function oi(e){return h(e)&&x(e)==Au}function ai(e,t,i,n){var r=i.length,s=r,o=!n;if(e==null){return!s}e=p(e);while(r--){var a=i[r];if(o&&a[2]?a[1]!==e[a[0]]:!(a[0]in e)){return false}}while(++r<s){a=i[r];var l=a[0],c=e[l],u=a[1];if(o&&a[2]){if(c===au&&!(l in e)){return false}}else{var d=new b;if(n){var h=n(c,u,l,e,t,d)}if(!(h===au?ri(u,c,du|qu,n,d):h)){return false}}}return true}function li(e){if(!M(e)||gr(e)){return false}var t=wa(e)?J:ch;return t.test(Lr(e))}function ci(e){return h(e)&&r(e)==_d}function ui(e){return h(e)&&x(e)==Su}function di(e){return h(e)&&Aa(e.length)&&!!xu[r(e)]}function hi(e){if(typeof e=="function"){return e}if(e==null){return F}if(typeof e=="object"){return R(e)?yi(e[0],e[1]):vi(e)}return Pc(e)}function pi(e){if(!vr(e)){return we(e)}var t=[];for(var i in p(e)){if(A.call(e,i)&&i!="constructor"){t.push(i)}}return t}function fi(e){if(!M(e)){return _r(e)}var t=vr(e),i=[];for(var n in e){if(!(n=="constructor"&&(t||!A.call(e,n)))){i.push(n)}}return i}function gi(e,t){return e<t}function mi(e,n){var r=-1,s=u(e)?S(e.length):[];Lt(e,function(e,t,i){s[++r]=n(e,t,i)});return s}function vi(t){var i=Zn(t);if(i.length==1&&i[0][2]){return br(i[0][0],i[0][1])}return function(e){return e===t||ai(e,t,i)}}function yi(i,n){if(hr(i)&&yr(n)){return br(kr(i),n)}return function(e){var t=ul(e,i);return t===au&&t===n?hl(e,i):ri(n,t,du|qu)}}function bi(n,r,s,o,a){if(n===r){return}Vt(r,function(e,t){a||(a=new b);if(M(e)){Ci(n,r,t,s,bi,o,a)}else{var i=o?o(xr(n,t),e,t+"",n,r,a):au;if(i===au){i=e}At(n,t,i)}},L)}function Ci(e,t,i,n,r,s,o){var a=xr(e,i),l=xr(t,i),c=o.get(l);if(c){At(e,i,c);return}var u=s?s(a,l,i+"",e,t,o):au;var d=u===au;if(d){var h=R(l),p=!h&&pa(l),f=!h&&!p&&Fa(l);u=l;if(h||p||f){if(R(a)){u=a}else if(g(a)){u=w(a)}else if(p){d=false;u=tn(l,true)}else if(f){d=false;u=an(l,true)}else{u=[]}}else if(Oa(l)||ua(l)){u=a;if(ua(a)){u=Ua(a)}else if(!M(a)||wa(a)){u=ar(l)}}else{d=false}}if(d){o.set(l,u);r(u,l,n,s,o);o["delete"](l)}At(e,i,u)}function wi(e,t){var i=e.length;if(!i){return}t+=t<0?i:0;return dr(t,i)?e[t]:au}function _i(e,r,i){if(r.length){r=Iu(r,function(t){if(R(t)){return function(e){return Ut(e,t.length===1?t[0]:t)}}return t})}else{r=[F]}var s=-1;r=Iu(r,Lu(c()));var t=mi(e,function(t,e,i){var n=Iu(r,function(e){return e(t)});return{criteria:n,index:++s,value:t}});return zh(t,function(e,t){return cn(e,t,i)})}function Ai(i,e){return Ei(i,e,function(e,t){return hl(i,t)})}function Ei(e,t,i){var n=-1,r=t.length,s={};while(++n<r){var o=t[n],a=Ut(e,o);if(i(a,o)){Ii(s,Qi(o,e),a)}}return s}function Si(t){return function(e){return Ut(e,t)}}function Ti(e,t,i,n){var r=n?$h:ku,s=-1,o=t.length,a=e;if(e===t){t=w(t)}if(i){a=Iu(e,Lu(i))}while(++s<o){var l=0,c=t[s],u=i?i(c):c;while((l=r(a,u,l,n))>-1){if(a!==e){ae.call(a,l,1)}ae.call(e,l,1)}}return e}function xi(e,t){var i=e?t.length:0,n=i-1;while(i--){var r=t[i];if(i==n||r!==s){var s=r;if(dr(r)){ae.call(e,r,1)}else{Wi(e,r)}}}return e}function Di(e,t){return e+me(Ee()*(t-e+1))}function Ri(e,t,i,n){var r=-1,s=E(ge((t-e)/(i||1)),0),o=S(s);while(s--){o[n?s:++r]=e;e+=i}return o}function Mi(e,t){var i="";if(!e||t<1||t>Cu){return i}do{if(t%2){i+=e}t=me(t/2);if(t){e+=e}}while(t);return i}function i(e,t){return Mr(Er(e,t,F),e+"")}function Ni(e){return Ct(Il(e))}function Oi(e,t){var i=Il(e);return Ir(i,Nt(t,0,i.length))}function Ii(e,t,i,n){if(!M(e)){return e}t=Qi(t,e);var r=-1,s=t.length,o=s-1,a=e;while(a!=null&&++r<s){var l=kr(t[r]),c=i;if(l==="__proto__"||l==="constructor"||l==="prototype"){return e}if(r!=o){var u=a[l];c=n?n(u,l,a):au;if(c===au){c=M(u)?u:dr(t[r+1])?[]:{}}}Et(a,l,c);a=a[l]}return e}var Pi=!Oe?F:function(e,t){Oe.set(e,t);return e};var ki=!de?F:function(e,t){return de(e,"toString",{configurable:true,enumerable:false,value:yc(t),writable:true})};function Li(e){return Ir(Il(e))}function a(e,t,i){var n=-1,r=e.length;if(t<0){t=-t>r?0:r+t}i=i>r?r:i;if(i<0){i+=r}r=t>i?0:i-t>>>0;t>>>=0;var s=S(r);while(++n<r){s[n]=e[n+t]}return s}function Fi(e,n){var r;Lt(e,function(e,t,i){r=n(e,t,i);return!r});return!!r}function Gi(e,t,i){var n=0,r=e==null?n:e.length;if(typeof t=="number"&&t===t&&r<=ld){while(n<r){var s=n+r>>>1,o=e[s];if(o!==null&&!N(o)&&(i?o<=t:o<t)){n=s+1}else{r=s}}return r}return $i(e,t,F,i)}function $i(e,t,i,n){var r=0,s=e==null?0:e.length;if(s===0){return 0}t=i(t);var o=t!==t,a=t===null,l=N(t),c=t===au;while(r<s){var u=me((r+s)/2),d=i(e[u]),h=d!==au,p=d===null,f=d===d,g=N(d);if(o){var m=n||f}else if(c){m=f&&(n||h)}else if(a){m=f&&h&&(n||!p)}else if(l){m=f&&h&&!p&&(n||!g)}else if(p||g){m=false}else{m=n?d<=t:d<t}if(m){r=u+1}else{s=u}}return T(s,ad)}function Hi(e,t){var i=-1,n=e.length,r=0,s=[];while(++i<n){var o=e[i],a=t?t(o):o;if(!i||!d(a,l)){var l=a;s[r++]=o===0?0:o}}return s}function Bi(e){if(typeof e=="number"){return e}if(N(e)){return od}return+e}function f(e){if(typeof e=="string"){return e}if(R(e)){return Iu(e,f)+""}if(N(e)){return Be?Be.call(e):""}var t=e+"";return t=="0"&&1/e==-bu?"-0":t}function Vi(e,t,i){var n=-1,r=Nh,s=e.length,o=true,a=[],l=a;if(i){o=false;r=Oh}else if(s>=Bu){var c=t?null:Ln(e);if(c){return cp(c)}o=false;r=Xh;l=new dt}else{l=t?[]:a}e:while(++n<s){var u=e[n],d=t?t(u):u;u=i||u!==0?u:0;if(o&&d===d){var h=l.length;while(h--){if(l[h]===d){continue e}}if(t){l.push(d)}a.push(u)}else if(!r(l,d,i)){if(l!==a){l.push(d)}a.push(u)}}return a}function Wi(e,t){t=Qi(t,e);e=Sr(e,t);return e==null||delete e[kr(s(t))]}function zi(e,t,i,n){return Ii(e,t,i(Ut(e,t)),n)}function ji(e,t,i,n){var r=e.length,s=n?r:-1;while((n?s--:++s<r)&&t(e[s],s,e)){}return i?a(e,n?0:s,n?s+1:r):a(e,n?s+1:0,n?r:s)}function Ui(e,t){var i=e;if(i instanceof y){i=i.value()}return Ih(t,function(e,t){return t.func.apply(t.thisArg,Pu([e],t.args))},i)}function Yi(e,t,i){var n=e.length;if(n<2){return n?Vi(e[0]):[]}var r=-1,s=S(n);while(++r<n){var o=e[r],a=-1;while(++a<n){if(a!=r){s[r]=kt(s[r]||o,e[a],t,i)}}}return Vi(l(s,1),t,i)}function qi(e,t,i){var n=-1,r=e.length,s=t.length,o={};while(++n<r){var a=n<s?t[n]:au;i(o,e[n],a)}return o}function Ki(e){return g(e)?e:[]}function Xi(e){return typeof e=="function"?e:F}function Qi(e,t){if(R(e)){return e}return hr(e,t)?[e]:Pr(P(e))}var Zi=i;function Ji(e,t,i){var n=e.length;i=i===au?n:i;return!t&&i>=n?e:a(e,t,i)}var en=he||function(e){return Ru.clearTimeout(e)};function tn(e,t){if(t){return e.slice()}var i=e.length,n=ne?ne(i):new e.constructor(i);e.copy(n);return n}function nn(e){var t=new e.constructor(e.byteLength);new ie(t).set(new ie(e));return t}function rn(e,t){var i=t?nn(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}function sn(e){var t=new e.constructor(e.source,oh.exec(e));t.lastIndex=e.lastIndex;return t}function on(e){return He?p(He.call(e)):{}}function an(e,t){var i=t?nn(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}function ln(e,t){if(e!==t){var i=e!==au,n=e===null,r=e===e,s=N(e);var o=t!==au,a=t===null,l=t===t,c=N(t);if(!a&&!c&&!s&&e>t||s&&o&&l&&!a&&!c||n&&o&&l||!i&&l||!r){return 1}if(!n&&!s&&!c&&e<t||c&&i&&r&&!n&&!s||a&&i&&r||!o&&r||!l){return-1}}return 0}function cn(e,t,i){var n=-1,r=e.criteria,s=t.criteria,o=r.length,a=i.length;while(++n<o){var l=ln(r[n],s[n]);if(l){if(n>=a){return l}var c=i[n];return l*(c=="desc"?-1:1)}}return e.index-t.index}function un(e,t,i,n){var r=-1,s=e.length,o=i.length,a=-1,l=t.length,c=E(s-o,0),u=S(l+c),d=!n;while(++a<l){u[a]=t[a]}while(++r<o){if(d||r<s){u[i[r]]=e[r]}}while(c--){u[a++]=e[r++]}return u}function dn(e,t,i,n){var r=-1,s=e.length,o=-1,a=i.length,l=-1,c=t.length,u=E(s-a,0),d=S(u+c),h=!n;while(++r<u){d[r]=e[r]}var p=r;while(++l<c){d[p+l]=t[l]}while(++o<a){if(h||r<s){d[p+i[o]]=e[r++]}}return d}function w(e,t){var i=-1,n=e.length;t||(t=S(n));while(++i<n){t[i]=e[i]}return t}function hn(e,t,i,n){var r=!i;i||(i={});var s=-1,o=t.length;while(++s<o){var a=t[s];var l=n?n(i[a],e[a],a,i,e):au;if(l===au){l=e[a]}if(r){Rt(i,a,l)}else{Et(i,a,l)}}return i}function pn(e,t){return hn(e,tr(e),t)}function fn(e,t){return hn(e,ir(e),t)}function gn(r,s){return function(e,t){var i=R(e)?Dh:Tt,n=s?s():{};return i(e,r,c(t,2),n)}}function mn(a){return i(function(e,t){var i=-1,n=t.length,r=n>1?t[n-1]:au,s=n>2?t[2]:au;r=a.length>3&&typeof r=="function"?(n--,r):au;if(s&&D(t[0],t[1],s)){r=n<3?au:r;n=1}e=p(e);while(++i<n){var o=t[i];if(o){a(e,o,i,r)}}return e})}function vn(s,o){return function(e,t){if(e==null){return e}if(!u(e)){return s(e,t)}var i=e.length,n=o?i:-1,r=p(e);while(o?n--:++n<i){if(t(r[n],n,r)===false){break}}return e}}function yn(l){return function(e,t,i){var n=-1,r=p(e),s=i(e),o=s.length;while(o--){var a=s[l?o:++n];if(t(r[a],a,r)===false){break}}return e}}function bn(t,e,i){var n=e&hu,r=_n(t);function s(){var e=this&&this!==Ru&&this instanceof s?r:t;return e.apply(n?i:this,arguments)}return s}function Cn(r){return function(e){e=P(e);var t=rp(e)?Gu(e):au;var i=t?t[0]:e.charAt(0);var n=t?Ji(t,1).join(""):e.slice(1);return i[r]()+n}}function wn(t){return function(e){return Ih(pc(Hl(e).replace(gh,"")),t,"")}}function _n(n){return function(){var e=arguments;switch(e.length){case 0:return new n;case 1:return new n(e[0]);case 2:return new n(e[0],e[1]);case 3:return new n(e[0],e[1],e[2]);case 4:return new n(e[0],e[1],e[2],e[3]);case 5:return new n(e[0],e[1],e[2],e[3],e[4]);case 6:return new n(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new n(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var t=Ve(n.prototype),i=n.apply(t,e);return M(i)?i:t}}function An(o,a,l){var c=_n(o);function u(){var e=arguments.length,t=S(e),i=e,n=Xn(u);while(i--){t[i]=arguments[i]}var r=e<3&&t[0]!==n&&t[e-1]!==n?[]:Fu(t,n);e-=r.length;if(e<l){return Pn(o,a,Tn,u.placeholder,au,t,r,au,au,l-e)}var s=this&&this!==Ru&&this instanceof u?c:o;return Mu(s,this,t)}return u}function En(o){return function(e,t,i){var n=p(e);if(!u(e)){var r=c(t,3);e=k(e);t=function(e){return r(n[e],e,n)}}var s=o(e,t,i);return s>-1?n[r?e[s]:s]:au}}function Sn(l){return jn(function(r){var s=r.length,e=s,t=v.prototype.thru;if(l){r.reverse()}while(e--){var i=r[e];if(typeof i!="function"){throw new _(lu)}if(t&&!o&&Kn(i)=="wrapper"){var o=new v([],true)}}e=o?e:s;while(++e<s){i=r[e];var n=Kn(i),a=n=="wrapper"?qn(i):au;if(a&&fr(a[0])&&a[1]==(yu|fu|mu|Xu)&&!a[4].length&&a[9]==1){o=o[Kn(a[0])].apply(o,a[3])}else{o=i.length==1&&fr(i)?o[n]():o.thru(i)}}return function(){var e=arguments,t=e[0];if(o&&e.length==1&&R(t)){return o.plant(t).value()}var i=0,n=s?r[i].apply(this,e):t;while(++i<s){n=r[i].call(this,n)}return n}})}function Tn(l,c,u,d,h,p,f,g,m,v){var y=c&yu,b=c&hu,C=c&pu,w=c&(fu|gu),_=c&Qu,A=C?au:_n(l);function E(){var e=arguments.length,t=S(e),i=e;while(i--){t[i]=arguments[i]}if(w){var n=Xn(E),r=Jh(t,n)}if(d){t=un(t,d,h,w)}if(p){t=dn(t,p,f,w)}e-=r;if(w&&e<v){var s=Fu(t,n);return Pn(l,c,Tn,E.placeholder,u,t,s,g,m,v-e)}var o=b?u:this,a=C?o[l]:l;e=t.length;if(g){t=Tr(t,g)}else if(_&&e>1){t.reverse()}if(y&&m<e){t.length=m}if(this&&this!==Ru&&this instanceof E){a=A||_n(a)}return a.apply(o,t)}return E}function xn(i,n){return function(e,t){return Jt(e,i,n(t),{})}}function Dn(n,r){return function(e,t){var i;if(e===au&&t===au){return r}if(e!==au){i=e}if(t!==au){if(i===au){return t}if(typeof e=="string"||typeof t=="string"){e=f(e);t=f(t)}else{e=Bi(e);t=Bi(t)}i=n(e,t)}return i}}function Rn(n){return jn(function(e){e=Iu(e,Lu(c()));return i(function(t){var i=this;return n(e,function(e){return Mu(e,i,t)})})})}function Mn(e,t){t=t===au?" ":f(t);var i=t.length;if(i<2){return i?Mi(t,e):t}var n=Mi(t,ge(e/hp(t)));return rp(t)?Ji(Gu(n),0,e).join(""):n.slice(0,e)}function Nn(o,e,a,l){var c=e&hu,u=_n(o);function d(){var e=-1,t=arguments.length,i=-1,n=l.length,r=S(n+t),s=this&&this!==Ru&&this instanceof d?u:o;while(++i<n){r[i]=l[i]}while(t--){r[i++]=arguments[++e]}return Mu(s,c?a:this,r)}return d}function On(n){return function(e,t,i){if(i&&typeof i!="number"&&D(e,t,i)){t=i=au}e=za(e);if(t===au){t=e;e=0}else{t=za(t)}i=i===au?e<t?1:-1:za(i);return Ri(e,t,i,n)}}function In(i){return function(e,t){if(!(typeof e=="string"&&typeof t=="string")){e=I(e);t=I(t)}return i(e,t)}}function Pn(e,t,i,n,r,s,o,a,l,c){var u=t&fu,d=u?o:au,h=u?au:o,p=u?s:au,f=u?au:s;t|=u?mu:vu;t&=~(u?vu:mu);if(!(t&Ku)){t&=~(hu|pu)}var g=[e,t,r,p,d,f,h,a,l,c];var m=i.apply(au,g);if(fr(e)){Dr(m,g)}m.placeholder=n;return Nr(m,e,t)}function kn(e){var r=H[e];return function(e,t){e=I(e);t=t==null?0:T(O(t),292);if(t&&be(e)){var i=(P(e)+"e").split("e"),n=r(i[0]+"e"+(+i[1]+t));i=(P(n)+"e").split("e");return+(i[0]+"e"+(+i[1]-t))}return r(e)}}var Ln=!(Re&&1/cp(new Re([,-0]))[1]==bu)?Rc:function(e){return new Re(e)};function Fn(i){return function(e){var t=x(e);if(t==Au){return ap(e)}if(t==Su){return up(e)}return Yh(e,i(e))}}function Gn(e,t,i,n,r,s,o,a){var l=t&pu;if(!l&&typeof e!="function"){throw new _(lu)}var c=n?n.length:0;if(!c){t&=~(mu|vu);n=r=au}o=o===au?o:E(O(o),0);a=a===au?a:O(a);c-=r?r.length:0;if(t&vu){var u=n,d=r;n=r=au}var h=l?au:qn(e);var p=[e,t,i,n,r,u,d,s,o,a];if(h){wr(p,h)}e=p[0];t=p[1];i=p[2];n=p[3];r=p[4];a=p[9]=p[9]===au?l?0:e.length:E(p[9]-c,0);if(!a&&t&(fu|gu)){t&=~(fu|gu)}if(!t||t==hu){var f=bn(e,t,i)}else if(t==fu||t==gu){f=An(e,t,a)}else if((t==mu||t==(hu|mu))&&!r.length){f=Nn(e,t,i,n)}else{f=Tn.apply(au,p)}var g=h?Pi:Dr;return Nr(g(f,p),e,t)}function $n(e,t,i,n){if(e===au||d(e,j[i])&&!A.call(n,i)){return t}return e}function Hn(e,t,i,n,r,s){if(M(e)&&M(t)){s.set(t,e);bi(e,t,au,Hn,s);s["delete"](t)}return e}function Bn(e){return Oa(e)?au:e}function Vn(e,t,i,n,r,s){var o=i&du,a=e.length,l=t.length;if(a!=l&&!(o&&l>a)){return false}var c=s.get(e);var u=s.get(t);if(c&&u){return c==t&&u==e}var d=-1,h=true,p=i&qu?new dt:au;s.set(e,t);s.set(t,e);while(++d<a){var f=e[d],g=t[d];if(n){var m=o?n(g,f,d,t,e,s):n(f,g,d,e,t,s)}if(m!==au){if(m){continue}h=false;break}if(p){if(!kh(t,function(e,t){if(!Xh(p,t)&&(f===e||r(f,e,i,n,s))){return p.push(t)}})){h=false;break}}else if(!(f===g||r(f,g,i,n,s))){h=false;break}}s["delete"](e);s["delete"](t);return h}function Wn(e,t,i,n,r,s,o){switch(i){case Tu:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset){return false}e=e.buffer;t=t.buffer;case Dd:if(e.byteLength!=t.byteLength||!s(new ie(e),new ie(t))){return false}return true;case hd:case pd:case yd:return d(+e,+t);case gd:return e.name==t.name&&e.message==t.message;case _d:case Ad:return e==t+"";case Au:var a=ap;case Su:var l=n&du;a||(a=cp);if(e.size!=t.size&&!l){return false}var c=o.get(e);if(c){return c==t}n|=qu;o.set(e,t);var u=Vn(a(e),a(t),n,r,s,o);o["delete"](e);return u;case Ed:if(He){return He.call(e)==He.call(t)}}return false}function zn(e,t,i,n,r,s){var o=i&du,a=Un(e),l=a.length,c=Un(t),u=c.length;if(l!=u&&!o){return false}var d=l;while(d--){var h=a[d];if(!(o?h in t:A.call(t,h))){return false}}var p=s.get(e);var f=s.get(t);if(p&&f){return p==t&&f==e}var g=true;s.set(e,t);s.set(t,e);var m=o;while(++d<l){h=a[d];var v=e[h],y=t[h];if(n){var b=o?n(y,v,h,t,e,s):n(v,y,h,e,t,s)}if(!(b===au?v===y||r(v,y,i,n,s):b)){g=false;break}m||(m=h=="constructor")}if(g&&!m){var C=e.constructor,w=t.constructor;if(C!=w&&("constructor"in e&&"constructor"in t)&&!(typeof C=="function"&&C instanceof C&&typeof w=="function"&&w instanceof w)){g=false}}s["delete"](e);s["delete"](t);return g}function jn(e){return Mr(Er(e,au,Zr),e+"")}function Un(e){return Yt(e,k,tr)}function Yn(e){return Yt(e,L,ir)}var qn=!Oe?Rc:function(e){return Oe.get(e)};function Kn(e){var t=e.name+"",i=Ie[t],n=A.call(Ie,t)?i.length:0;while(n--){var r=i[n],s=r.func;if(s==null||s==e){return r.name}}return t}function Xn(e){var t=A.call(m,"placeholder")?m:e;return t.placeholder}function c(){var e=m.iteratee||_c;e=e===_c?hi:e;return arguments.length?e(arguments[0],arguments[1]):e}function Qn(e,t){var i=e.__data__;return pr(t)?i[typeof t=="string"?"string":"hash"]:i.map}function Zn(e){var t=k(e),i=t.length;while(i--){var n=t[i],r=e[n];t[i]=[n,r,yr(r)]}return t}function Jn(e,t){var i=np(e,t);return li(i)?i:au}function er(e){var t=A.call(e,ue),i=e[ue];try{e[ue]=au;var n=true}catch(e){}var r=X.call(e);if(n){if(t){e[ue]=i}else{delete e[ue]}}return r}var tr=!ve?Gc:function(t){if(t==null){return[]}t=p(t);return Ou(ve(t),function(e){return oe.call(t,e)})};var ir=!ve?Gc:function(e){var t=[];while(e){Pu(t,tr(e));e=re(e)}return t};var x=r;if(Te&&x(new Te(new ArrayBuffer(1)))!=Tu||xe&&x(new xe)!=Au||De&&x(De.resolve())!=Cd||Re&&x(new Re)!=Su||Me&&x(new Me)!=Td){x=function(e){var t=r(e),i=t==Eu?e.constructor:au,n=i?Lr(i):"";if(n){switch(n){case Pe:return Tu;case ke:return Au;case Le:return Cd;case Fe:return Su;case Ge:return Td}}return t}}function nr(e,t,i){var n=-1,r=i.length;while(++n<r){var s=i[n],o=s.size;switch(s.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=T(t,e+o);break;case"takeRight":e=E(e,t-o);break}}return{start:e,end:t}}function rr(e){var t=e.match(th);return t?t[1].split(ih):[]}function sr(e,t,i){t=Qi(t,e);var n=-1,r=t.length,s=false;while(++n<r){var o=kr(t[n]);if(!(s=e!=null&&i(e,o))){break}e=e[o]}if(s||++n!=r){return s}r=e==null?0:e.length;return!!r&&Aa(r)&&dr(o,r)&&(R(e)||ua(e))}function or(e){var t=e.length,i=new e.constructor(t);if(t&&typeof e[0]=="string"&&A.call(e,"index")){i.index=e.index;i.input=e.input}return i}function ar(e){return typeof e.constructor=="function"&&!vr(e)?Ve(re(e)):{}}function lr(e,t,i){var n=e.constructor;switch(t){case Dd:return nn(e);case hd:case pd:return new n(+e);case Tu:return rn(e,i);case Rd:case Md:case Nd:case Od:case Id:case Pd:case kd:case Ld:case Fd:return an(e,i);case Au:return new n;case yd:case Ad:return new n(e);case _d:return sn(e);case Su:return new n;case Ed:return on(e)}}function cr(e,t){var i=t.length;if(!i){return e}var n=i-1;t[n]=(i>1?"& ":"")+t[n];t=t.join(i>2?", ":" ");return e.replace(eh,"{\n/* [wrapped with "+t+"] */\n")}function ur(e){return R(e)||ua(e)||!!(le&&e&&e[le])}function dr(e,t){var i=typeof e;t=t==null?Cu:t;return!!t&&(i=="number"||i!="symbol"&&dh.test(e))&&(e>-1&&e%1==0&&e<t)}function D(e,t,i){if(!M(i)){return false}var n=typeof t;if(n=="number"?u(i)&&dr(t,i.length):n=="string"&&t in i){return d(i[t],e)}return false}function hr(e,t){if(R(e)){return false}var i=typeof e;if(i=="number"||i=="symbol"||i=="boolean"||e==null||N(e)){return true}return Kd.test(e)||!qd.test(e)||t!=null&&e in p(t)}function pr(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function fr(e){var t=Kn(e),i=m[t];if(typeof i!="function"||!(t in y.prototype)){return false}if(e===i){return true}var n=qn(i);return!!n&&e===n[0]}function gr(e){return!!K&&K in e}var mr=U?wa:$c;function vr(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||j;return e===i}function yr(e){return e===e&&!M(e)}function br(t,i){return function(e){if(e==null){return false}return e[t]===i&&(i!==au||t in p(e))}}function Cr(e){var t=zo(e,function(e){if(i.size===ju){i.clear()}return e});var i=t.cache;return t}function wr(e,t){var i=e[1],n=t[1],r=i|n,s=r<(hu|pu|yu);var o=n==yu&&i==fu||n==yu&&i==Xu&&e[7].length<=t[8]||n==(yu|Xu)&&t[7].length<=t[8]&&i==fu;if(!(s||o)){return e}if(n&hu){e[2]=t[2];r|=i&hu?0:Ku}var a=t[3];if(a){var l=e[3];e[3]=l?un(l,a,t[4]):a;e[4]=l?Fu(e[3],Uu):t[4]}a=t[5];if(a){l=e[5];e[5]=l?dn(l,a,t[6]):a;e[6]=l?Fu(e[5],Uu):t[6]}a=t[7];if(a){e[7]=a}if(n&yu){e[8]=e[8]==null?t[8]:T(e[8],t[8])}if(e[9]==null){e[9]=t[9]}e[0]=t[0];e[1]=r;return e}function _r(e){var t=[];if(e!=null){for(var i in p(e)){t.push(i)}}return t}function Ar(e){return X.call(e)}function Er(s,o,a){o=E(o===au?s.length-1:o,0);return function(){var e=arguments,t=-1,i=E(e.length-o,0),n=S(i);while(++t<i){n[t]=e[o+t]}t=-1;var r=S(o+1);while(++t<o){r[t]=e[t]}r[o]=a(n);return Mu(s,this,r)}}function Sr(e,t){return t.length<2?e:Ut(e,a(t,0,-1))}function Tr(e,t){var i=e.length,n=T(t.length,i),r=w(e);while(n--){var s=t[n];e[n]=dr(s,i)?r[s]:au}return e}function xr(e,t){if(t==="constructor"&&typeof e[t]==="function"){return}if(t=="__proto__"){return}return e[t]}var Dr=Or(Pi);var Rr=fe||function(e,t){return Ru.setTimeout(e,t)};var Mr=Or(ki);function Nr(e,t,i){var n=t+"";return Mr(e,cr(n,Fr(rr(n),i)))}function Or(i){var n=0,r=0;return function(){var e=_e(),t=td-(e-r);r=e;if(t>0){if(++n>=ed){return arguments[0]}}else{n=0}return i.apply(au,arguments)}}function Ir(e,t){var i=-1,n=e.length,r=n-1;t=t===au?n:t;while(++i<t){var s=Di(i,r),o=e[s];e[s]=e[i];e[i]=o}e.length=t;return e}var Pr=Cr(function(e){var r=[];if(e.charCodeAt(0)===46){r.push("")}e.replace(Xd,function(e,t,i,n){r.push(i?n.replace(rh,"$1"):t||e)});return r});function kr(e){if(typeof e=="string"||N(e)){return e}var t=e+"";return t=="0"&&1/e==-bu?"-0":t}function Lr(e){if(e!=null){try{return Y.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Fr(i,n){Nu(cd,function(e){var t="_."+e[0];if(n&e[1]&&!Nh(i,t)){i.push(t)}});return i.sort()}function Gr(e){if(e instanceof y){return e.clone()}var t=new v(e.__wrapped__,e.__chain__);t.__actions__=w(e.__actions__);t.__index__=e.__index__;t.__values__=e.__values__;return t}function $r(e,t,i){if(i?D(e,t,i):t===au){t=1}else{t=E(O(t),0)}var n=e==null?0:e.length;if(!n||t<1){return[]}var r=0,s=0,o=S(ge(n/t));while(r<n){o[s++]=a(e,r,r+=t)}return o}function Hr(e){var t=-1,i=e==null?0:e.length,n=0,r=[];while(++t<i){var s=e[t];if(s){r[n++]=s}}return r}function Br(){var e=arguments.length;if(!e){return[]}var t=S(e-1),i=arguments[0],n=e;while(n--){t[n-1]=arguments[n]}return Pu(R(i)?w(i):[i],l(t,1))}var Vr=i(function(e,t){return g(e)?kt(e,l(t,1,g,true)):[]});var Wr=i(function(e,t){var i=s(t);if(g(i)){i=au}return g(e)?kt(e,l(t,1,g,true),c(i,2)):[]});var zr=i(function(e,t){var i=s(t);if(g(i)){i=au}return g(e)?kt(e,l(t,1,g,true),au,i):[]});function jr(e,t,i){var n=e==null?0:e.length;if(!n){return[]}t=i||t===au?1:O(t);return a(e,t<0?0:t,n)}function Ur(e,t,i){var n=e==null?0:e.length;if(!n){return[]}t=i||t===au?1:O(t);t=n-t;return a(e,0,t<0?0:t)}function Yr(e,t){return e&&e.length?ji(e,c(t,3),true,true):[]}function qr(e,t){return e&&e.length?ji(e,c(t,3),true):[]}function Kr(e,t,i,n){var r=e==null?0:e.length;if(!r){return[]}if(i&&typeof i!="number"&&D(e,t,i)){i=0;n=r}return Ht(e,t,i,n)}function Xr(e,t,i){var n=e==null?0:e.length;if(!n){return-1}var r=i==null?0:O(i);if(r<0){r=E(n+r,0)}return Gh(e,c(t,3),r)}function Qr(e,t,i){var n=e==null?0:e.length;if(!n){return-1}var r=n-1;if(i!==au){r=O(i);r=i<0?E(n+r,0):T(r,n-1)}return Gh(e,c(t,3),r,true)}function Zr(e){var t=e==null?0:e.length;return t?l(e,1):[]}function Jr(e){var t=e==null?0:e.length;return t?l(e,bu):[]}function es(e,t){var i=e==null?0:e.length;if(!i){return[]}t=t===au?1:O(t);return l(e,t)}function ts(e){var t=-1,i=e==null?0:e.length,n={};while(++t<i){var r=e[t];n[r[0]]=r[1]}return n}function is(e){return e&&e.length?e[0]:au}function ns(e,t,i){var n=e==null?0:e.length;if(!n){return-1}var r=i==null?0:O(i);if(r<0){r=E(n+r,0)}return ku(e,t,r)}function rs(e){var t=e==null?0:e.length;return t?a(e,0,-1):[]}var ss=i(function(e){var t=Iu(e,Ki);return t.length&&t[0]===e[0]?Zt(t):[]});var os=i(function(e){var t=s(e),i=Iu(e,Ki);if(t===s(i)){t=au}else{i.pop()}return i.length&&i[0]===e[0]?Zt(i,c(t,2)):[]});var as=i(function(e){var t=s(e),i=Iu(e,Ki);t=typeof t=="function"?t:au;if(t){i.pop()}return i.length&&i[0]===e[0]?Zt(i,au,t):[]});function ls(e,t){return e==null?"":Ce.call(e,t)}function s(e){var t=e==null?0:e.length;return t?e[t-1]:au}function cs(e,t,i){var n=e==null?0:e.length;if(!n){return-1}var r=n;if(i!==au){r=O(i);r=r<0?E(n+r,0):T(r,n-1)}return t===t?dp(e,t,r):Gh(e,Hh,r,true)}function us(e,t){return e&&e.length?wi(e,O(t)):au}var ds=i(hs);function hs(e,t){return e&&e.length&&t&&t.length?Ti(e,t):e}function ps(e,t,i){return e&&e.length&&t&&t.length?Ti(e,t,c(i,2)):e}function fs(e,t,i){return e&&e.length&&t&&t.length?Ti(e,t,au,i):e}var gs=jn(function(e,t){var i=e==null?0:e.length,n=Mt(e,t);xi(e,Iu(t,function(e){return dr(e,i)?+e:e}).sort(ln));return n});function ms(e,t){var i=[];if(!(e&&e.length)){return i}var n=-1,r=[],s=e.length;t=c(t,3);while(++n<s){var o=e[n];if(t(o,n,e)){i.push(o);r.push(n)}}xi(e,r);return i}function vs(e){return e==null?e:Se.call(e)}function ys(e,t,i){var n=e==null?0:e.length;if(!n){return[]}if(i&&typeof i!="number"&&D(e,t,i)){t=0;i=n}else{t=t==null?0:O(t);i=i===au?n:O(i)}return a(e,t,i)}function bs(e,t){return Gi(e,t)}function Cs(e,t,i){return $i(e,t,c(i,2))}function ws(e,t){var i=e==null?0:e.length;if(i){var n=Gi(e,t);if(n<i&&d(e[n],t)){return n}}return-1}function _s(e,t){return Gi(e,t,true)}function As(e,t,i){return $i(e,t,c(i,2),true)}function Es(e,t){var i=e==null?0:e.length;if(i){var n=Gi(e,t,true)-1;if(d(e[n],t)){return n}}return-1}function Ss(e){return e&&e.length?Hi(e):[]}function Ts(e,t){return e&&e.length?Hi(e,c(t,2)):[]}function xs(e){var t=e==null?0:e.length;return t?a(e,1,t):[]}function Ds(e,t,i){if(!(e&&e.length)){return[]}t=i||t===au?1:O(t);return a(e,0,t<0?0:t)}function Rs(e,t,i){var n=e==null?0:e.length;if(!n){return[]}t=i||t===au?1:O(t);t=n-t;return a(e,t<0?0:t,n)}function Ms(e,t){return e&&e.length?ji(e,c(t,3),false,true):[]}function Ns(e,t){return e&&e.length?ji(e,c(t,3)):[]}var Os=i(function(e){return Vi(l(e,1,g,true))});var Is=i(function(e){var t=s(e);if(g(t)){t=au}return Vi(l(e,1,g,true),c(t,2))});var Ps=i(function(e){var t=s(e);t=typeof t=="function"?t:au;return Vi(l(e,1,g,true),au,t)});function ks(e){return e&&e.length?Vi(e):[]}function Ls(e,t){return e&&e.length?Vi(e,c(t,2)):[]}function Fs(e,t){t=typeof t=="function"?t:au;return e&&e.length?Vi(e,au,t):[]}function Gs(t){if(!(t&&t.length)){return[]}var i=0;t=Ou(t,function(e){if(g(e)){i=E(e.length,i);return true}});return Uh(i,function(e){return Iu(t,Vh(e))})}function $s(e,t){if(!(e&&e.length)){return[]}var i=Gs(e);if(t==null){return i}return Iu(i,function(e){return Mu(t,au,e)})}var Hs=i(function(e,t){return g(e)?kt(e,t):[]});var Bs=i(function(e){return Yi(Ou(e,g))});var Vs=i(function(e){var t=s(e);if(g(t)){t=au}return Yi(Ou(e,g),c(t,2))});var Ws=i(function(e){var t=s(e);t=typeof t=="function"?t:au;return Yi(Ou(e,g),au,t)});var zs=i(Gs);function js(e,t){return qi(e||[],t||[],Et)}function Us(e,t){return qi(e||[],t||[],Ii)}var Ys=i(function(e){var t=e.length,i=t>1?e[t-1]:au;i=typeof i=="function"?(e.pop(),i):au;return $s(e,i)});function qs(e){var t=m(e);t.__chain__=true;return t}function Ks(e,t){t(e);return e}function Xs(e,t){return t(e)}var Qs=jn(function(t){var i=t.length,e=i?t[0]:0,n=this.__wrapped__,r=function(e){return Mt(e,t)};if(i>1||this.__actions__.length||!(n instanceof y)||!dr(e)){return this.thru(r)}n=n.slice(e,+e+(i?1:0));n.__actions__.push({func:Xs,args:[r],thisArg:au});return new v(n,this.__chain__).thru(function(e){if(i&&!e.length){e.push(au)}return e})});function Zs(){return qs(this)}function Js(){return new v(this.value(),this.__chain__)}function eo(){if(this.__values__===au){this.__values__=Wa(this.value())}var e=this.__index__>=this.__values__.length,t=e?au:this.__values__[this.__index__++];return{done:e,value:t}}function to(){return this}function io(e){var t,i=this;while(i instanceof We){var n=Gr(i);n.__index__=0;n.__values__=au;if(t){r.__wrapped__=n}else{t=n}var r=n;i=i.__wrapped__}r.__wrapped__=e;return t}function no(){var e=this.__wrapped__;if(e instanceof y){var t=e;if(this.__actions__.length){t=new y(this)}t=t.reverse();t.__actions__.push({func:Xs,args:[vs],thisArg:au});return new v(t,this.__chain__)}return this.thru(vs)}function ro(){return Ui(this.__wrapped__,this.__actions__)}var so=gn(function(e,t,i){if(A.call(e,i)){++e[i]}else{Rt(e,i,1)}});function oo(e,t,i){var n=R(e)?Mh:Gt;if(i&&D(e,t,i)){t=au}return n(e,c(t,3))}function ao(e,t){var i=R(e)?Ou:Bt;return i(e,c(t,3))}var lo=En(Xr);var co=En(Qr);function uo(e,t){return l(Co(e,t),1)}function ho(e,t){return l(Co(e,t),bu)}function po(e,t,i){i=i===au?1:O(i);return l(Co(e,t),i)}function fo(e,t){var i=R(e)?Nu:Lt;return i(e,c(t,3))}function go(e,t){var i=R(e)?Rh:Ft;return i(e,c(t,3))}var mo=gn(function(e,t,i){if(A.call(e,i)){e[i].push(t)}else{Rt(e,i,[t])}});function vo(e,t,i,n){e=u(e)?e:Il(e);i=i&&!n?O(i):0;var r=e.length;if(i<0){i=E(r+i,0)}return La(e)?i<=r&&e.indexOf(t,i)>-1:!!r&&ku(e,t,i)>-1}var yo=i(function(e,t,i){var n=-1,r=typeof t=="function",s=u(e)?S(e.length):[];Lt(e,function(e){s[++n]=r?Mu(t,e,i):ei(e,t,i)});return s});var bo=gn(function(e,t,i){Rt(e,i,t)});function Co(e,t){var i=R(e)?Iu:mi;return i(e,c(t,3))}function wo(e,t,i,n){if(e==null){return[]}if(!R(t)){t=t==null?[]:[t]}i=n?au:i;if(!R(i)){i=i==null?[]:[i]}return _i(e,t,i)}var _o=gn(function(e,t,i){e[i?0:1].push(t)},function(){return[[],[]]});function Ao(e,t,i){var n=R(e)?Ih:Wh,r=arguments.length<3;return n(e,c(t,4),i,r,Lt)}function Eo(e,t,i){var n=R(e)?Ph:Wh,r=arguments.length<3;return n(e,c(t,4),i,r,Ft)}function So(e,t){var i=R(e)?Ou:Bt;return i(e,jo(c(t,3)))}function To(e){var t=R(e)?Ct:Ni;return t(e)}function xo(e,t,i){if(i?D(e,t,i):t===au){t=1}else{t=O(t)}var n=R(e)?wt:Oi;return n(e,t)}function Do(e){var t=R(e)?_t:Li;return t(e)}function Ro(e){if(e==null){return 0}if(u(e)){return La(e)?hp(e):e.length}var t=x(e);if(t==Au||t==Su){return e.size}return pi(e).length}function Mo(e,t,i){var n=R(e)?kh:Fi;if(i&&D(e,t,i)){t=au}return n(e,c(t,3))}var No=i(function(e,t){if(e==null){return[]}var i=t.length;if(i>1&&D(e,t[0],t[1])){t=[]}else if(i>2&&D(t[0],t[1],t[2])){t=[t[0]]}return _i(e,l(t,1),[])});var Oo=pe||function(){return Ru.Date.now()};function Io(e,t){if(typeof t!="function"){throw new _(lu)}e=O(e);return function(){if(--e<1){return t.apply(this,arguments)}}}function Po(e,t,i){t=i?au:t;t=e&&t==null?e.length:t;return Gn(e,yu,au,au,au,au,t)}function ko(e,t){var i;if(typeof t!="function"){throw new _(lu)}e=O(e);return function(){if(--e>0){i=t.apply(this,arguments)}if(e<=1){t=au}return i}}var Lo=i(function(e,t,i){var n=hu;if(i.length){var r=Fu(i,Xn(Lo));n|=mu}return Gn(e,n,t,i,r)});var Fo=i(function(e,t,i){var n=hu|pu;if(i.length){var r=Fu(i,Xn(Fo));n|=mu}return Gn(t,n,e,i,r)});function Go(e,t,i){t=i?au:t;var n=Gn(e,fu,au,au,au,au,au,t);n.placeholder=Go.placeholder;return n}function $o(e,t,i){t=i?au:t;var n=Gn(e,gu,au,au,au,au,au,t);n.placeholder=$o.placeholder;return n}function Ho(n,r,e){var s,o,a,l,i,c,u=0,t=false,d=false,h=true;if(typeof n!="function"){throw new _(lu)}r=I(r)||0;if(M(e)){t=!!e.leading;d="maxWait"in e;a=d?E(I(e.maxWait)||0,r):a;h="trailing"in e?!!e.trailing:h}function p(e){var t=s,i=o;s=o=au;u=e;l=n.apply(i,t);return l}function f(e){u=e;i=Rr(v,r);return t?p(e):l}function g(e){var t=e-c,i=e-u,n=r-t;return d?T(n,a-i):n}function m(e){var t=e-c,i=e-u;return c===au||t>=r||t<0||d&&i>=a}function v(){var e=Oo();if(m(e)){return y(e)}i=Rr(v,g(e))}function y(e){i=au;if(h&&s){return p(e)}s=o=au;return l}function b(){if(i!==au){en(i)}u=0;s=c=o=i=au}function C(){return i===au?l:y(Oo())}function w(){var e=Oo(),t=m(e);s=arguments;o=this;c=e;if(t){if(i===au){return f(c)}if(d){en(i);i=Rr(v,r);return p(c)}}if(i===au){i=Rr(v,r)}return l}w.cancel=b;w.flush=C;return w}var Bo=i(function(e,t){return Pt(e,1,t)});var Vo=i(function(e,t,i){return Pt(e,I(t)||0,i)});function Wo(e){return Gn(e,Qu)}function zo(r,s){if(typeof r!="function"||s!=null&&typeof s!="function"){throw new _(lu)}var o=function(){var e=arguments,t=s?s.apply(this,e):e[0],i=o.cache;if(i.has(t)){return i.get(t)}var n=r.apply(this,e);o.cache=i.set(t,n)||i;return n};o.cache=new(zo.Cache||st);return o}zo.Cache=st;function jo(t){if(typeof t!="function"){throw new _(lu)}return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Uo(e){return ko(2,e)}var Yo=Zi(function(n,r){r=r.length==1&&R(r[0])?Iu(r[0],Lu(c())):Iu(l(r,1),Lu(c()));var s=r.length;return i(function(e){var t=-1,i=T(e.length,s);while(++t<i){e[t]=r[t].call(this,e[t])}return Mu(n,this,e)})});var qo=i(function(e,t){var i=Fu(t,Xn(qo));return Gn(e,mu,au,t,i)});var Ko=i(function(e,t){var i=Fu(t,Xn(Ko));return Gn(e,vu,au,t,i)});var Xo=jn(function(e,t){return Gn(e,Xu,au,au,au,t)});function Qo(e,t){if(typeof e!="function"){throw new _(lu)}t=t===au?t:O(t);return i(e,t)}function Zo(n,r){if(typeof n!="function"){throw new _(lu)}r=r==null?0:E(O(r),0);return i(function(e){var t=e[r],i=Ji(e,0,r);if(t){Pu(i,t)}return Mu(n,this,i)})}function Jo(e,t,i){var n=true,r=true;if(typeof e!="function"){throw new _(lu)}if(M(i)){n="leading"in i?!!i.leading:n;r="trailing"in i?!!i.trailing:r}return Ho(e,t,{leading:n,maxWait:t,trailing:r})}function ea(e){return Po(e,1)}function ta(e,t){return qo(Xi(t),e)}function ia(){if(!arguments.length){return[]}var e=arguments[0];return R(e)?e:[e]}function na(e){return C(e,uu)}function ra(e,t){t=typeof t=="function"?t:au;return C(e,uu,t)}function sa(e){return C(e,cu|uu)}function oa(e,t){t=typeof t=="function"?t:au;return C(e,cu|uu,t)}function aa(e,t){return t==null||It(e,t,k(t))}function d(e,t){return e===t||e!==e&&t!==t}var la=In(qt);var ca=In(function(e,t){return e>=t});var ua=ti(function(){return arguments}())?ti:function(e){return h(e)&&A.call(e,"callee")&&!oe.call(e,"callee")};var R=S.isArray;var da=_h?Lu(_h):ii;function u(e){return e!=null&&Aa(e.length)&&!wa(e)}function g(e){return h(e)&&u(e)}function ha(e){return e===true||e===false||h(e)&&r(e)==hd}var pa=ye||$c;var fa=Ah?Lu(Ah):ni;function ga(e){return h(e)&&e.nodeType===1&&!Oa(e)}function ma(e){if(e==null){return true}if(u(e)&&(R(e)||typeof e=="string"||typeof e.splice=="function"||pa(e)||Fa(e)||ua(e))){return!e.length}var t=x(e);if(t==Au||t==Su){return!e.size}if(vr(e)){return!pi(e).length}for(var i in e){if(A.call(e,i)){return false}}return true}function va(e,t){return ri(e,t)}function ya(e,t,i){i=typeof i=="function"?i:au;var n=i?i(e,t):au;return n===au?ri(e,t,au,i):!!n}function ba(e){if(!h(e)){return false}var t=r(e);return t==gd||t==fd||typeof e.message=="string"&&typeof e.name=="string"&&!Oa(e)}function Ca(e){return typeof e=="number"&&be(e)}function wa(e){if(!M(e)){return false}var t=r(e);return t==md||t==vd||t==dd||t==wd}function _a(e){return typeof e=="number"&&e==O(e)}function Aa(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Cu}function M(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function h(e){return e!=null&&typeof e=="object"}var Ea=Eh?Lu(Eh):oi;function Sa(e,t){return e===t||ai(e,t,Zn(t))}function Ta(e,t,i){i=typeof i=="function"?i:au;return ai(e,t,Zn(t),i)}function xa(e){return Na(e)&&e!=+e}function Da(e){if(mr(e)){throw new G(Vu)}return li(e)}function Ra(e){return e===null}function Ma(e){return e==null}function Na(e){return typeof e=="number"||h(e)&&r(e)==yd}function Oa(e){if(!h(e)||r(e)!=Eu){return false}var t=re(e);if(t===null){return true}var i=A.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&Y.call(i)==Q}var Ia=Sh?Lu(Sh):ci;function Pa(e){return _a(e)&&e>=-Cu&&e<=Cu}var ka=Th?Lu(Th):ui;function La(e){return typeof e=="string"||!R(e)&&h(e)&&r(e)==Ad}function N(e){return typeof e=="symbol"||h(e)&&r(e)==Ed}var Fa=xh?Lu(xh):di;function Ga(e){return e===au}function $a(e){return h(e)&&x(e)==Td}function Ha(e){return h(e)&&r(e)==xd}var Ba=In(gi);var Va=In(function(e,t){return e<=t});function Wa(e){if(!e){return[]}if(u(e)){return La(e)?Gu(e):w(e)}if(ce&&e[ce]){return op(e[ce]())}var t=x(e),i=t==Au?ap:t==Su?cp:Il;return i(e)}function za(e){if(!e){return e===0?e:0}e=I(e);if(e===bu||e===-bu){var t=e<0?-1:1;return t*sd}return e===e?e:0}function O(e){var t=za(e),i=t%1;return t===t?i?t-i:t:0}function ja(e){return e?Nt(O(e),0,wu):0}function I(e){if(typeof e=="number"){return e}if(N(e)){return od}if(M(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=M(t)?t+"":t}if(typeof e!="string"){return e===0?e:+e}e=qh(e);var i=lh.test(e);return i||uh.test(e)?Ch(e.slice(2),i?2:8):ah.test(e)?od:+e}function Ua(e){return hn(e,L(e))}function Ya(e){return e?Nt(O(e),-Cu,Cu):e===0?e:0}function P(e){return e==null?"":f(e)}var qa=mn(function(e,t){if(vr(t)||u(t)){hn(t,k(t),e);return}for(var i in t){if(A.call(t,i)){Et(e,i,t[i])}}});var Ka=mn(function(e,t){hn(t,L(t),e)});var Xa=mn(function(e,t,i,n){hn(t,L(t),e,n)});var Qa=mn(function(e,t,i,n){hn(t,k(t),e,n)});var Za=jn(Mt);function Ja(e,t){var i=Ve(e);return t==null?i:xt(i,t)}var el=i(function(e,t){e=p(e);var i=-1;var n=t.length;var r=n>2?t[2]:au;if(r&&D(t[0],t[1],r)){n=1}while(++i<n){var s=t[i];var o=L(s);var a=-1;var l=o.length;while(++a<l){var c=o[a];var u=e[c];if(u===au||d(u,j[c])&&!A.call(e,c)){e[c]=s[c]}}}return e});var tl=i(function(e){e.push(au,Hn);return Mu(bl,au,e)});function il(e,t){return Fh(e,c(t,3),o)}function nl(e,t){return Fh(e,c(t,3),zt)}function rl(e,t){return e==null?e:Vt(e,c(t,3),L)}function sl(e,t){return e==null?e:Wt(e,c(t,3),L)}function ol(e,t){return e&&o(e,c(t,3))}function al(e,t){return e&&zt(e,c(t,3))}function ll(e){return e==null?[]:jt(e,k(e))}function cl(e){return e==null?[]:jt(e,L(e))}function ul(e,t,i){var n=e==null?au:Ut(e,t);return n===au?i:n}function dl(e,t){return e!=null&&sr(e,t,Kt)}function hl(e,t){return e!=null&&sr(e,t,Xt)}var pl=xn(function(e,t,i){if(t!=null&&typeof t.toString!="function"){t=X.call(t)}e[t]=i},yc(F));var fl=xn(function(e,t,i){if(t!=null&&typeof t.toString!="function"){t=X.call(t)}if(A.call(e,t)){e[t].push(i)}else{e[t]=[i]}},c);var gl=i(ei);function k(e){return u(e)?bt(e):pi(e)}function L(e){return u(e)?bt(e,true):fi(e)}function ml(e,n){var r={};n=c(n,3);o(e,function(e,t,i){Rt(r,n(e,t,i),e)});return r}function vl(e,n){var r={};n=c(n,3);o(e,function(e,t,i){Rt(r,t,n(e,t,i))});return r}var yl=mn(function(e,t,i){bi(e,t,i)});var bl=mn(function(e,t,i,n){bi(e,t,i,n)});var Cl=jn(function(t,e){var i={};if(t==null){return i}var n=false;e=Iu(e,function(e){e=Qi(e,t);n||(n=e.length>1);return e});hn(t,Yn(t),i);if(n){i=C(i,cu|Yu|uu,Bn)}var r=e.length;while(r--){Wi(i,e[r])}return i});function wl(e,t){return Al(e,jo(c(t)))}var _l=jn(function(e,t){return e==null?{}:Ai(e,t)});function Al(e,i){if(e==null){return{}}var t=Iu(Yn(e),function(e){return[e]});i=c(i);return Ei(e,t,function(e,t){return i(e,t[0])})}function El(e,t,i){t=Qi(t,e);var n=-1,r=t.length;if(!r){r=1;e=au}while(++n<r){var s=e==null?au:e[kr(t[n])];if(s===au){n=r;s=i}e=wa(s)?s.call(e):s}return e}function Sl(e,t,i){return e==null?e:Ii(e,t,i)}function Tl(e,t,i,n){n=typeof n=="function"?n:au;return e==null?e:Ii(e,t,i,n)}var xl=Fn(k);var Dl=Fn(L);function Rl(e,n,r){var t=R(e),i=t||pa(e)||Fa(e);n=c(n,4);if(r==null){var s=e&&e.constructor;if(i){r=t?new s:[]}else if(M(e)){r=wa(s)?Ve(re(e)):{}}else{r={}}}(i?Nu:o)(e,function(e,t,i){return n(r,e,t,i)});return r}function Ml(e,t){return e==null?true:Wi(e,t)}function Nl(e,t,i){return e==null?e:zi(e,t,Xi(i))}function Ol(e,t,i,n){n=typeof n=="function"?n:au;return e==null?e:zi(e,t,Xi(i),n)}function Il(e){return e==null?[]:Kh(e,k(e))}function Pl(e){return e==null?[]:Kh(e,L(e))}function kl(e,t,i){if(i===au){i=t;t=au}if(i!==au){i=I(i);i=i===i?i:0}if(t!==au){t=I(t);t=t===t?t:0}return Nt(I(e),t,i)}function Ll(e,t,i){t=za(t);if(i===au){i=t;t=0}else{i=za(i)}e=I(e);return Qt(e,t,i)}function Fl(e,t,i){if(i&&typeof i!="boolean"&&D(e,t,i)){t=i=au}if(i===au){if(typeof t=="boolean"){i=t;t=au}else if(typeof e=="boolean"){i=e;e=au}}if(e===au&&t===au){e=0;t=1}else{e=za(e);if(t===au){t=e;e=0}else{t=za(t)}}if(e>t){var n=e;e=t;t=n}if(i||e%1||t%1){var r=Ee();return T(e+r*(t-e+bh("1e-"+((r+"").length-1))),t)}return Di(e,t)}var Gl=wn(function(e,t,i){t=t.toLowerCase();return e+(i?$l(t):t)});function $l(e){return hc(P(e).toLowerCase())}function Hl(e){e=P(e);return e&&e.replace(hh,ep).replace(mh,"")}function Bl(e,t,i){e=P(e);t=f(t);var n=e.length;i=i===au?n:Nt(O(i),0,n);var r=i;i-=t.length;return i>=0&&e.slice(i,r)==t}function Vl(e){e=P(e);return e&&zd.test(e)?e.replace(Vd,tp):e}function Wl(e){e=P(e);return e&&Zd.test(e)?e.replace(Qd,"\\$&"):e}var zl=wn(function(e,t,i){return e+(i?"-":"")+t.toLowerCase()});var jl=wn(function(e,t,i){return e+(i?" ":"")+t.toLowerCase()});var Ul=Cn("toLowerCase");function Yl(e,t,i){e=P(e);t=O(t);var n=t?hp(e):0;if(!t||n>=t){return e}var r=(t-n)/2;return Mn(me(r),i)+e+Mn(ge(r),i)}function ql(e,t,i){e=P(e);t=O(t);var n=t?hp(e):0;return t&&n<t?e+Mn(t-n,i):e}function Kl(e,t,i){e=P(e);t=O(t);var n=t?hp(e):0;return t&&n<t?Mn(t-n,i)+e:e}function Xl(e,t,i){if(i||t==null){t=0}else if(t){t=+t}return Ae(P(e).replace(Jd,""),t||0)}function Ql(e,t,i){if(i?D(e,t,i):t===au){t=1}else{t=O(t)}return Mi(P(e),t)}function Zl(){var e=arguments,t=P(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var Jl=wn(function(e,t,i){return e+(i?"_":"")+t.toLowerCase()});function ec(e,t,i){if(i&&typeof i!="number"&&D(e,t,i)){t=i=au}i=i===au?wu:i>>>0;if(!i){return[]}e=P(e);if(e&&(typeof t=="string"||t!=null&&!Ia(t))){t=f(t);if(!t&&rp(e)){return Ji(Gu(e),0,i)}}return e.split(t,i)}var tc=wn(function(e,t,i){return e+(i?" ":"")+hc(t)});function ic(e,t,i){e=P(e);i=i==null?0:Nt(O(i),0,e.length);t=f(t);return e.slice(i,i+t.length)==t}function nc(o,e,t){var i=m.templateSettings;if(t&&D(o,e,t)){e=au}o=P(o);e=Xa({},e,i,$n);var n=Xa({},e.imports,i.imports,$n),r=k(n),s=Kh(n,r);var a,l,c=0,u=e.interpolate||ph,d="__p += '";var h=B((e.escape||ph).source+"|"+u.source+"|"+(u===Yd?sh:ph).source+"|"+(e.evaluate||ph).source+"|$","g");var p="//# sourceURL="+(A.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++yh+"]")+"\n";o.replace(h,function(e,t,i,n,r,s){i||(i=n);d+=o.slice(c,s).replace(fh,ip);if(t){a=true;d+="' +\n__e("+t+") +\n'"}if(r){l=true;d+="';\n"+r+";\n__p += '"}if(i){d+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"}c=s+e.length;return e});d+="';\n";var f=A.call(e,"variable")&&e.variable;if(!f){d="with (obj) {\n"+d+"\n}\n"}else if(nh.test(f)){throw new G(Wu)}d=(l?d.replace(Gd,""):d).replace($d,"$1").replace(Hd,"$1;");d="function("+(f||"obj")+") {\n"+(f?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(l?", __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=fc(function(){return $(r,p+"return "+d).apply(au,s)});g.source=d;if(ba(g)){throw g}return g}function rc(e){return P(e).toLowerCase()}function sc(e){return P(e).toUpperCase()}function oc(e,t,i){e=P(e);if(e&&(i||t===au)){return qh(e)}if(!e||!(t=f(t))){return e}var n=Gu(e),r=Gu(t),s=Qh(n,r),o=Zh(n,r)+1;return Ji(n,s,o).join("")}function ac(e,t,i){e=P(e);if(e&&(i||t===au)){return e.slice(0,pp(e)+1)}if(!e||!(t=f(t))){return e}var n=Gu(e),r=Zh(n,Gu(t))+1;return Ji(n,0,r).join("")}function lc(e,t,i){e=P(e);if(e&&(i||t===au)){return e.replace(Jd,"")}if(!e||!(t=f(t))){return e}var n=Gu(e),r=Qh(n,Gu(t));return Ji(n,r).join("")}function cc(e,t){var i=Zu,n=Ju;if(M(t)){var r="separator"in t?t.separator:r;i="length"in t?O(t.length):i;n="omission"in t?f(t.omission):n}e=P(e);var s=e.length;if(rp(e)){var o=Gu(e);s=o.length}if(i>=s){return e}var a=i-hp(n);if(a<1){return n}var l=o?Ji(o,0,a).join(""):e.slice(0,a);if(r===au){return l+n}if(o){a+=l.length-a}if(Ia(r)){if(e.slice(a).search(r)){var c,u=l;if(!r.global){r=B(r.source,P(oh.exec(r))+"g")}r.lastIndex=0;while(c=r.exec(u)){var d=c.index}l=l.slice(0,d===au?a:d)}}else if(e.indexOf(f(r),a)!=a){var h=l.lastIndexOf(r);if(h>-1){l=l.slice(0,h)}}return l+n}function uc(e){e=P(e);return e&&Wd.test(e)?e.replace(Bd,fp):e}var dc=wn(function(e,t,i){return e+(i?" ":"")+t.toUpperCase()});var hc=Cn("toUpperCase");function pc(e,t,i){e=P(e);t=i?au:t;if(t===au){return sp(e)?gp(e):Lh(e)}return e.match(t)||[]}var fc=i(function(e,t){try{return Mu(e,au,t)}catch(e){return ba(e)?e:new G(e)}});var gc=jn(function(t,e){Nu(e,function(e){e=kr(e);Rt(t,e,Lo(t[e],t))});return t});function mc(n){var r=n==null?0:n.length,t=c();n=!r?[]:Iu(n,function(e){if(typeof e[1]!="function"){throw new _(lu)}return[t(e[0]),e[1]]});return i(function(e){var t=-1;while(++t<r){var i=n[t];if(Mu(i[0],this,e)){return Mu(i[1],this,e)}}})}function vc(e){return Ot(C(e,cu))}function yc(e){return function(){return e}}function bc(e,t){return e==null||e!==e?t:e}var Cc=Sn();var wc=Sn(true);function F(e){return e}function _c(e){return hi(typeof e=="function"?e:C(e,cu))}function Ac(e){return vi(C(e,cu))}function Ec(e,t){return yi(e,C(t,cu))}var Sc=i(function(t,i){return function(e){return ei(e,t,i)}});var Tc=i(function(t,i){return function(e){return ei(t,e,i)}});function xc(r,t,e){var i=k(t),n=jt(t,i);if(e==null&&!(M(t)&&(n.length||!i.length))){e=t;t=r;r=this;n=jt(t,k(t))}var s=!(M(e)&&"chain"in e)||!!e.chain,o=wa(r);Nu(n,function(e){var n=t[e];r[e]=n;if(o){r.prototype[e]=function(){var e=this.__chain__;if(s||e){var t=r(this.__wrapped__),i=t.__actions__=w(this.__actions__);i.push({func:n,args:arguments,thisArg:r});t.__chain__=e;return t}return n.apply(r,Pu([this.value()],arguments))}}});return r}function Dc(){if(Ru._===this){Ru._=Z}return this}function Rc(){}function Mc(t){t=O(t);return i(function(e){return wi(e,t)})}var Nc=Rn(Iu);var Oc=Rn(Mh);var Ic=Rn(kh);function Pc(e){return hr(e)?Vh(kr(e)):Si(e)}function kc(t){return function(e){return t==null?au:Ut(t,e)}}var Lc=On();var Fc=On(true);function Gc(){return[]}function $c(){return false}function Hc(){return{}}function Bc(){return""}function Vc(){return true}function Wc(e,t){e=O(e);if(e<1||e>Cu){return[]}var i=wu,n=T(e,wu);t=c(t);e-=wu;var r=Uh(n,t);while(++i<e){t(i)}return r}function zc(e){if(R(e)){return Iu(e,kr)}return N(e)?[e]:w(Pr(P(e)))}function jc(e){var t=++q;return P(e)+t}var Uc=Dn(function(e,t){return e+t},0);var Yc=kn("ceil");var qc=Dn(function(e,t){return e/t},1);var Kc=kn("floor");function Xc(e){return e&&e.length?$t(e,F,qt):au}function Qc(e,t){return e&&e.length?$t(e,c(t,2),qt):au}function Zc(e){return Bh(e,F)}function Jc(e,t){return Bh(e,c(t,2))}function eu(e){return e&&e.length?$t(e,F,gi):au}function tu(e,t){return e&&e.length?$t(e,c(t,2),gi):au}var iu=Dn(function(e,t){return e*t},1);var nu=kn("round");var ru=Dn(function(e,t){return e-t},0);function su(e){return e&&e.length?jh(e,F):0}function ou(e,t){return e&&e.length?jh(e,c(t,2)):0}m.after=Io;m.ary=Po;m.assign=qa;m.assignIn=Ka;m.assignInWith=Xa;m.assignWith=Qa;m.at=Za;m.before=ko;m.bind=Lo;m.bindAll=gc;m.bindKey=Fo;m.castArray=ia;m.chain=qs;m.chunk=$r;m.compact=Hr;m.concat=Br;m.cond=mc;m.conforms=vc;m.constant=yc;m.countBy=so;m.create=Ja;m.curry=Go;m.curryRight=$o;m.debounce=Ho;m.defaults=el;m.defaultsDeep=tl;m.defer=Bo;m.delay=Vo;m.difference=Vr;m.differenceBy=Wr;m.differenceWith=zr;m.drop=jr;m.dropRight=Ur;m.dropRightWhile=Yr;m.dropWhile=qr;m.fill=Kr;m.filter=ao;m.flatMap=uo;m.flatMapDeep=ho;m.flatMapDepth=po;m.flatten=Zr;m.flattenDeep=Jr;m.flattenDepth=es;m.flip=Wo;m.flow=Cc;m.flowRight=wc;m.fromPairs=ts;m.functions=ll;m.functionsIn=cl;m.groupBy=mo;m.initial=rs;m.intersection=ss;m.intersectionBy=os;m.intersectionWith=as;m.invert=pl;m.invertBy=fl;m.invokeMap=yo;m.iteratee=_c;m.keyBy=bo;m.keys=k;m.keysIn=L;m.map=Co;m.mapKeys=ml;m.mapValues=vl;m.matches=Ac;m.matchesProperty=Ec;m.memoize=zo;m.merge=yl;m.mergeWith=bl;m.method=Sc;m.methodOf=Tc;m.mixin=xc;m.negate=jo;m.nthArg=Mc;m.omit=Cl;m.omitBy=wl;m.once=Uo;m.orderBy=wo;m.over=Nc;m.overArgs=Yo;m.overEvery=Oc;m.overSome=Ic;m.partial=qo;m.partialRight=Ko;m.partition=_o;m.pick=_l;m.pickBy=Al;m.property=Pc;m.propertyOf=kc;m.pull=ds;m.pullAll=hs;m.pullAllBy=ps;m.pullAllWith=fs;m.pullAt=gs;m.range=Lc;m.rangeRight=Fc;m.rearg=Xo;m.reject=So;m.remove=ms;m.rest=Qo;m.reverse=vs;m.sampleSize=xo;m.set=Sl;m.setWith=Tl;m.shuffle=Do;m.slice=ys;m.sortBy=No;m.sortedUniq=Ss;m.sortedUniqBy=Ts;m.split=ec;m.spread=Zo;m.tail=xs;m.take=Ds;m.takeRight=Rs;m.takeRightWhile=Ms;m.takeWhile=Ns;m.tap=Ks;m.throttle=Jo;m.thru=Xs;m.toArray=Wa;m.toPairs=xl;m.toPairsIn=Dl;m.toPath=zc;m.toPlainObject=Ua;m.transform=Rl;m.unary=ea;m.union=Os;m.unionBy=Is;m.unionWith=Ps;m.uniq=ks;m.uniqBy=Ls;m.uniqWith=Fs;m.unset=Ml;m.unzip=Gs;m.unzipWith=$s;m.update=Nl;m.updateWith=Ol;m.values=Il;m.valuesIn=Pl;m.without=Hs;m.words=pc;m.wrap=ta;m.xor=Bs;m.xorBy=Vs;m.xorWith=Ws;m.zip=zs;m.zipObject=js;m.zipObjectDeep=Us;m.zipWith=Ys;m.entries=xl;m.entriesIn=Dl;m.extend=Ka;m.extendWith=Xa;xc(m,m);m.add=Uc;m.attempt=fc;m.camelCase=Gl;m.capitalize=$l;m.ceil=Yc;m.clamp=kl;m.clone=na;m.cloneDeep=sa;m.cloneDeepWith=oa;m.cloneWith=ra;m.conformsTo=aa;m.deburr=Hl;m.defaultTo=bc;m.divide=qc;m.endsWith=Bl;m.eq=d;m.escape=Vl;m.escapeRegExp=Wl;m.every=oo;m.find=lo;m.findIndex=Xr;m.findKey=il;m.findLast=co;m.findLastIndex=Qr;m.findLastKey=nl;m.floor=Kc;m.forEach=fo;m.forEachRight=go;m.forIn=rl;m.forInRight=sl;m.forOwn=ol;m.forOwnRight=al;m.get=ul;m.gt=la;m.gte=ca;m.has=dl;m.hasIn=hl;m.head=is;m.identity=F;m.includes=vo;m.indexOf=ns;m.inRange=Ll;m.invoke=gl;m.isArguments=ua;m.isArray=R;m.isArrayBuffer=da;m.isArrayLike=u;m.isArrayLikeObject=g;m.isBoolean=ha;m.isBuffer=pa;m.isDate=fa;m.isElement=ga;m.isEmpty=ma;m.isEqual=va;m.isEqualWith=ya;m.isError=ba;m.isFinite=Ca;m.isFunction=wa;m.isInteger=_a;m.isLength=Aa;m.isMap=Ea;m.isMatch=Sa;m.isMatchWith=Ta;m.isNaN=xa;m.isNative=Da;m.isNil=Ma;m.isNull=Ra;m.isNumber=Na;m.isObject=M;m.isObjectLike=h;m.isPlainObject=Oa;m.isRegExp=Ia;m.isSafeInteger=Pa;m.isSet=ka;m.isString=La;m.isSymbol=N;m.isTypedArray=Fa;m.isUndefined=Ga;m.isWeakMap=$a;m.isWeakSet=Ha;m.join=ls;m.kebabCase=zl;m.last=s;m.lastIndexOf=cs;m.lowerCase=jl;m.lowerFirst=Ul;m.lt=Ba;m.lte=Va;m.max=Xc;m.maxBy=Qc;m.mean=Zc;m.meanBy=Jc;m.min=eu;m.minBy=tu;m.stubArray=Gc;m.stubFalse=$c;m.stubObject=Hc;m.stubString=Bc;m.stubTrue=Vc;m.multiply=iu;m.nth=us;m.noConflict=Dc;m.noop=Rc;m.now=Oo;m.pad=Yl;m.padEnd=ql;m.padStart=Kl;m.parseInt=Xl;m.random=Fl;m.reduce=Ao;m.reduceRight=Eo;m.repeat=Ql;m.replace=Zl;m.result=El;m.round=nu;m.runInContext=t;m.sample=To;m.size=Ro;m.snakeCase=Jl;m.some=Mo;m.sortedIndex=bs;m.sortedIndexBy=Cs;m.sortedIndexOf=ws;m.sortedLastIndex=_s;m.sortedLastIndexBy=As;m.sortedLastIndexOf=Es;m.startCase=tc;m.startsWith=ic;m.subtract=ru;m.sum=su;m.sumBy=ou;m.template=nc;m.times=Wc;m.toFinite=za;m.toInteger=O;m.toLength=ja;m.toLower=rc;m.toNumber=I;m.toSafeInteger=Ya;m.toString=P;m.toUpper=sc;m.trim=oc;m.trimEnd=ac;m.trimStart=lc;m.truncate=cc;m.unescape=uc;m.uniqueId=jc;m.upperCase=dc;m.upperFirst=hc;m.each=fo;m.eachRight=go;m.first=is;xc(m,function(){var i={};o(m,function(e,t){if(!A.call(m.prototype,t)){i[t]=e}});return i}(),{chain:false});m.VERSION=Hu;Nu(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){m[e].placeholder=m});Nu(["drop","take"],function(i,n){y.prototype[i]=function(e){e=e===au?1:E(O(e),0);var t=this.__filtered__&&!n?new y(this):this.clone();if(t.__filtered__){t.__takeCount__=T(e,t.__takeCount__)}else{t.__views__.push({size:T(e,wu),type:i+(t.__dir__<0?"Right":"")})}return t};y.prototype[i+"Right"]=function(e){return this.reverse()[i](e).reverse()}});Nu(["filter","map","takeWhile"],function(e,t){var i=t+1,n=i==id||i==rd;y.prototype[e]=function(e){var t=this.clone();t.__iteratees__.push({iteratee:c(e,3),type:i});t.__filtered__=t.__filtered__||n;return t}});Nu(["head","last"],function(e,t){var i="take"+(t?"Right":"");y.prototype[e]=function(){return this[i](1).value()[0]}});Nu(["initial","tail"],function(e,t){var i="drop"+(t?"":"Right");y.prototype[e]=function(){return this.__filtered__?new y(this):this[i](1)}});y.prototype.compact=function(){return this.filter(F)};y.prototype.find=function(e){return this.filter(e).head()};y.prototype.findLast=function(e){return this.reverse().find(e)};y.prototype.invokeMap=i(function(t,i){if(typeof t=="function"){return new y(this)}return this.map(function(e){return ei(e,t,i)})});y.prototype.reject=function(e){return this.filter(jo(c(e)))};y.prototype.slice=function(e,t){e=O(e);var i=this;if(i.__filtered__&&(e>0||t<0)){return new y(i)}if(e<0){i=i.takeRight(-e)}else if(e){i=i.drop(e)}if(t!==au){t=O(t);i=t<0?i.dropRight(-t):i.take(t-e)}return i};y.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()};y.prototype.toArray=function(){return this.take(wu)};o(y.prototype,function(d,e){var h=/^(?:filter|find|map|reject)|While$/.test(e),p=/^(?:head|last)$/.test(e),f=m[p?"take"+(e=="last"?"Right":""):e],g=p||/^find/.test(e);if(!f){return}m.prototype[e]=function(){var e=this.__wrapped__,i=p?[1]:arguments,t=e instanceof y,n=i[0],r=t||R(e);var s=function(e){var t=f.apply(m,Pu([e],i));return p&&o?t[0]:t};if(r&&h&&typeof n=="function"&&n.length!=1){t=r=false}var o=this.__chain__,a=!!this.__actions__.length,l=g&&!o,c=t&&!a;if(!g&&r){e=c?e:new y(this);var u=d.apply(e,i);u.__actions__.push({func:Xs,args:[s],thisArg:au});return new v(u,o)}if(l&&c){return d.apply(this,i)}u=this.thru(s);return l?p?u.value()[0]:u.value():u}});Nu(["pop","push","shift","sort","splice","unshift"],function(e){var i=W[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);m.prototype[e]=function(){var t=arguments;if(r&&!this.__chain__){var e=this.value();return i.apply(R(e)?e:[],t)}return this[n](function(e){return i.apply(R(e)?e:[],t)})}});o(y.prototype,function(e,t){var i=m[t];if(i){var n=i.name+"";if(!A.call(Ie,n)){Ie[n]=[]}Ie[n].push({name:t,func:i})}});Ie[Tn(au,pu).name]=[{name:"wrapper",func:au}];y.prototype.clone=ze;y.prototype.reverse=je;y.prototype.value=Ue;m.prototype.at=Qs;m.prototype.chain=Zs;m.prototype.commit=Js;m.prototype.next=eo;m.prototype.plant=io;m.prototype.reverse=no;m.prototype.toJSON=m.prototype.valueOf=m.prototype.value=ro;m.prototype.first=m.prototype.head;if(ce){m.prototype[ce]=to}return m};var $u=ce();if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){Ru._=$u;define(function(){return $u})}else if(t){(t.exports=$u)._=$u;te._=$u}else{Ru._=$u}}).call(this);(function(i){var t=Array.prototype.slice;var n={dict:null,load:function(e){if(this.dict!==null){i.extend(this.dict,e)}else{this.dict=e}},_:function(e){dict=this.dict;if(dict&&dict.hasOwnProperty(e)){e=dict[e]}args=t.call(arguments);args[0]=e;return this.printf.apply(this,args)},printf:function(e,n){if(arguments.length<2)return e;n=i.isArray(n)?n:t.call(arguments,1);return e.replace(/([^%]|^)%(?:(\d+)\$)?s/g,function(e,t,i){if(i){return t+n[parseInt(i)-1]}return t+n.shift()}).replace(/%%s/g,"%s")}};i.fn._t=function(e,t){return i(this).html(n._.apply(n,arguments))};i.i18n=n})(jQuery);(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports=="object"&&typeof module=="object"){module.exports=e(require("jquery"))}else{e(jQuery)}})(function(Ge,$e){"use strict";var n={beforeShow:e,move:e,change:e,show:e,hide:e,color:false,flat:false,showInput:false,allowEmpty:false,showButtons:true,clickoutFiresChange:true,showInitial:false,showPalette:false,showPaletteOnly:false,hideAfterPaletteSelect:false,togglePaletteOnly:false,showSelectionPalette:true,localStorageKey:false,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:false,className:"",containerClassName:"",replacerClassName:"",showAlpha:false,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:false,offset:null},He=[],Be=!!/msie/i.exec(window.navigator.userAgent),Ve=function(){function e(e,t){return!!~(""+e).indexOf(t)}var t=document.createElement("div");var i=t.style;i.cssText="background-color:rgba(0,0,0,.5)";return e(i.backgroundColor,"rgba")||e(i.backgroundColor,"hsla")}(),We=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),ze=function(){var e="";if(Be){for(var t=1;t<=6;t++){e+="<div class='sp-"+t+"'></div>"}}return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function je(e,t,i,n){var r=[];for(var s=0;s<e.length;s++){var o=e[s];if(o){var a=tinycolor(o);var l=a.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";l+=tinycolor.equals(t,o)?" sp-thumb-active":"";var c=a.toString(n.preferredFormat||"rgb");var u=Ve?"background-color:"+a.toRgbString():"filter:"+a.toFilter();r.push('<span title="'+c+'" data-color="'+a.toRgbString()+'" class="'+l+'"><span class="sp-thumb-inner" style="'+u+';"></span></span>')}else{var d="sp-clear-display";r.push(Ge("<div />").append(Ge('<span data-color="" style="background-color:transparent;" class="'+d+'"></span>').attr("title",n.noColorSelectedText)).html())}}return"<div class='sp-cf "+i+"'>"+r.join("")+"</div>"}function Ue(){for(var e=0;e<He.length;e++){if(He[e]){He[e].hide()}}}function Ye(e,t){var i=Ge.extend({},n,e);i.callbacks={move:r(i.move,t),change:r(i.change,t),show:r(i.show,t),hide:r(i.hide,t),beforeShow:r(i.beforeShow,t)};return i}function s(e,F){var c=Ye(F,e),n=c.flat,G=c.showSelectionPalette,i=c.localStorageKey,$=c.theme,r=c.callbacks,H=Qe(L,10),t=false,B=false,l=0,u=0,o=0,a=0,V=0,W=0,z=0,j=0,d=0,h=0,p=0,f=1,U=[],s=[],Y={},g=c.selectionPalette.slice(0),q=c.maxSelectionSize,K="sp-dragging",m=null;var v=e.ownerDocument,X=v.body,y=Ge(e),Q=false,b=Ge(ze,v).addClass($),Z=b.find(".sp-picker-container"),J=b.find(".sp-color"),ee=b.find(".sp-dragger"),te=b.find(".sp-hue"),ie=b.find(".sp-slider"),C=b.find(".sp-alpha-inner"),ne=b.find(".sp-alpha"),re=b.find(".sp-alpha-handle"),w=b.find(".sp-input"),se=b.find(".sp-palette"),oe=b.find(".sp-initial"),ae=b.find(".sp-cancel"),le=b.find(".sp-clear"),ce=b.find(".sp-choose"),ue=b.find(".sp-palette-toggle"),de=y.is("input"),he=de&&y.attr("type")==="color"&&Ze(),pe=de&&!n,_=pe?Ge(We).addClass($).addClass(c.className).addClass(c.replacerClassName):Ge([]),A=pe?_:y,E=_.find(".sp-preview-inner"),S=c.color||de&&y.val(),T=false,x=c.preferredFormat,fe=!c.showButtons||c.clickoutFiresChange,D=!S,R=c.allowEmpty&&!he;function ge(){if(c.showPaletteOnly){c.showPalette=true}ue.text(c.showPaletteOnly?c.togglePaletteMoreText:c.togglePaletteLessText);if(c.palette){U=c.palette.slice(0);s=Ge.isArray(U[0])?U:[U];Y={};for(var e=0;e<s.length;e++){for(var t=0;t<s[e].length;t++){var i=tinycolor(s[e][t]).toRgbString();Y[i]=true}}}b.toggleClass("sp-flat",n);b.toggleClass("sp-input-disabled",!c.showInput);b.toggleClass("sp-alpha-enabled",c.showAlpha);b.toggleClass("sp-clear-enabled",R);b.toggleClass("sp-buttons-disabled",!c.showButtons);b.toggleClass("sp-palette-buttons-disabled",!c.togglePaletteOnly);b.toggleClass("sp-palette-disabled",!c.showPalette);b.toggleClass("sp-palette-only",c.showPaletteOnly);b.toggleClass("sp-initial-disabled",!c.showInitial);b.addClass(c.className).addClass(c.containerClassName);L()}function me(){if(Be){b.find("*:not(input)").attr("unselectable","on")}ge();if(pe){y.after(_).hide()}if(!R){le.hide()}if(n){y.after(b).hide()}else{var e=c.appendTo==="parent"?y.parent():Ge(c.appendTo);if(e.length!==1){e=Ge("body")}e.append(b)}ve();A.on("click.spectrum touchstart.spectrum",function(e){if(!Q){Se()}e.stopPropagation();if(!Ge(e.target).is("input")){e.preventDefault()}});if(y.is(":disabled")||c.disabled===true){ke()}b.click(Ke);w.change(Ee);w.on("paste",function(){setTimeout(Ee,1)});w.keydown(function(e){if(e.keyCode==13){Ee()}});ae.text(c.cancelText);ae.on("click.spectrum",function(e){e.stopPropagation();e.preventDefault();Re();M()});le.attr("title",c.clearText);le.on("click.spectrum",function(e){e.stopPropagation();e.preventDefault();D=true;I();if(n){k(true)}});ce.text(c.chooseText);ce.on("click.spectrum",function(e){e.stopPropagation();e.preventDefault();if(Be&&w.is(":focus")){w.trigger("change")}if(Me()){k(true);M()}});ue.text(c.showPaletteOnly?c.togglePaletteMoreText:c.togglePaletteLessText);ue.on("click.spectrum",function(e){e.stopPropagation();e.preventDefault();c.showPaletteOnly=!c.showPaletteOnly;if(!c.showPaletteOnly&&!n){b.css("left","-="+(Z.outerWidth(true)+5))}ge()});Xe(ne,function(e,t,i){f=e/W;D=false;if(i.shiftKey){f=Math.round(f*10)/10}I()},_e,Ae);Xe(te,function(e,t){d=parseFloat(t/a);D=false;if(!c.showAlpha){f=1}I()},_e,Ae);Xe(J,function(e,t,i){if(!i.shiftKey){m=null}else if(!m){var n=h*l;var r=u-p*u;var s=Math.abs(e-n)>Math.abs(t-r);m=s?"x":"y"}var o=!m||m==="x";var a=!m||m==="y";if(o){h=parseFloat(e/l)}if(a){p=parseFloat((u-t)/u)}D=false;if(!c.showAlpha){f=1}I()},_e,Ae);if(!!S){N(S);P();x=c.preferredFormat||tinycolor(S).format;ye(S)}else{P()}if(n){Te()}function t(e){if(e.data&&e.data.ignore){N(Ge(e.target).closest(".sp-thumb-el").data("color"));I()}else{N(Ge(e.target).closest(".sp-thumb-el").data("color"));I();if(c.hideAfterPaletteSelect){k(true);M()}else{k()}}return false}var i=Be?"mousedown.spectrum":"click.spectrum touchstart.spectrum";se.on(i,".sp-thumb-el",t);oe.on(i,".sp-thumb-el:nth-child(1)",{ignore:true},t)}function ve(){if(i&&window.localStorage){try{var e=window.localStorage[i].split(",#");if(e.length>1){delete window.localStorage[i];Ge.each(e,function(e,t){ye(t)})}}catch(e){}try{g=window.localStorage[i].split(";")}catch(e){}}}function ye(e){if(G){var t=tinycolor(e).toRgbString();if(!Y[t]&&Ge.inArray(t,g)===-1){g.push(t);while(g.length>q){g.shift()}}if(i&&window.localStorage){try{window.localStorage[i]=g.join(";")}catch(e){}}}}function be(){var e=[];if(c.showPalette){for(var t=0;t<g.length;t++){var i=tinycolor(g[t]).toRgbString();if(!Y[i]){e.push(g[t])}}}return e.reverse().slice(0,c.maxSelectionSize)}function Ce(){var i=O();var e=Ge.map(s,function(e,t){return je(e,i,"sp-palette-row sp-palette-row-"+t,c)});ve();if(g){e.push(je(be(),i,"sp-palette-row sp-palette-row-selection",c))}se.html(e.join(""))}function we(){if(c.showInitial){var e=T;var t=O();oe.html(je([e,t],t,"sp-palette-row-initial",c))}}function _e(){if(u<=0||l<=0||a<=0){L()}B=true;b.addClass(K);m=null;y.trigger("dragstart.spectrum",[O()])}function Ae(){B=false;b.removeClass(K);y.trigger("dragstop.spectrum",[O()])}function Ee(){var e=w.val();if((e===null||e==="")&&R){N(null);I();k()}else{var t=tinycolor(e);if(t.isValid()){N(t);I();k()}else{w.addClass("sp-validation-error")}}}function Se(){if(t){M()}else{Te()}}function Te(){var e=Ge.Event("beforeShow.spectrum");if(t){L();return}y.trigger(e,[O()]);if(r.beforeShow(O())===false||e.isDefaultPrevented()){return}Ue();t=true;Ge(v).on("keydown.spectrum",xe);Ge(v).on("click.spectrum",De);Ge(window).on("resize.spectrum",H);_.addClass("sp-active");b.removeClass("sp-hidden");L();P();T=O();we();r.show(T);y.trigger("show.spectrum",[T])}function xe(e){if(e.keyCode===27){M()}}function De(e){if(e.button==2){return}if(B){return}if(fe){k(true)}else{Re()}M()}function M(){if(!t||n){return}t=false;Ge(v).off("keydown.spectrum",xe);Ge(v).off("click.spectrum",De);Ge(window).off("resize.spectrum",H);_.removeClass("sp-active");b.addClass("sp-hidden");r.hide(O());y.trigger("hide.spectrum",[O()])}function Re(){N(T,true);k(true)}function N(e,t){if(tinycolor.equals(e,O())){P();return}var i,n;if(!e&&R){D=true}else{D=false;i=tinycolor(e);n=i.toHsv();d=n.h%360/360;h=n.s;p=n.v;f=n.a}P();if(i&&i.isValid()&&!t){x=c.preferredFormat||i.getFormat()}}function O(e){e=e||{};if(R&&D){return null}return tinycolor.fromRatio({h:d,s:h,v:p,a:Math.round(f*1e3)/1e3},{format:e.format||x})}function Me(){return!w.hasClass("sp-validation-error")}function I(){P();r.move(O());y.trigger("move.spectrum",[O()])}function P(){w.removeClass("sp-validation-error");Ne();var e=tinycolor.fromRatio({h:d,s:1,v:1});J.css("background-color",e.toHexString());var t=x;if(f<1&&!(f===0&&t==="name")){if(t==="hex"||t==="hex3"||t==="hex6"||t==="name"){t="rgb"}}var i=O({format:t}),n="";E.removeClass("sp-clear-display");E.css("background-color","transparent");if(!i&&R){E.addClass("sp-clear-display")}else{var r=i.toHexString(),s=i.toRgbString();if(Ve||i.alpha===1){E.css("background-color",s)}else{E.css("background-color","transparent");E.css("filter",i.toFilter())}if(c.showAlpha){var o=i.toRgb();o.a=0;var a=tinycolor(o).toRgbString();var l="linear-gradient(left, "+a+", "+r+")";if(Be){C.css("filter",tinycolor(a).toFilter({gradientType:1},r))}else{C.css("background","-webkit-"+l);C.css("background","-moz-"+l);C.css("background","-ms-"+l);C.css("background","linear-gradient(to right, "+a+", "+r+")")}}n=i.toString(t)}if(c.showInput){w.val(n)}if(c.showPalette){Ce()}we()}function Ne(){var e=h;var t=p;if(R&&D){re.hide();ie.hide();ee.hide()}else{re.show();ie.show();ee.show();var i=e*l;var n=u-t*u;i=Math.max(-o,Math.min(l-o,i-o));n=Math.max(-o,Math.min(u-o,n-o));ee.css({top:n+"px",left:i+"px"});var r=f*W;re.css({left:r-z/2+"px"});var s=d*a;ie.css({top:s-j+"px"})}}function k(e){var t=O(),i="",n=!tinycolor.equals(t,T);if(t){i=t.toString(x);ye(t)}if(de){y.val(i)}if(e&&n){r.change(t);y.trigger("change",[t])}}function L(){if(!t){return}l=J.width();u=J.height();o=ee.height();V=te.width();a=te.height();j=ie.height();W=ne.width();z=re.width();if(!n){b.css("position","absolute");if(c.offset){b.offset(c.offset)}else{b.offset(qe(b,A))}}Ne();if(c.showPalette){Ce()}y.trigger("reflow.spectrum")}function Oe(){y.show();A.off("click.spectrum touchstart.spectrum");b.remove();_.remove();He[Fe.id]=null}function Ie(e,t){if(e===$e){return Ge.extend({},c)}if(t===$e){return c[e]}c[e]=t;if(e==="preferredFormat"){x=c.preferredFormat}ge()}function Pe(){Q=false;y.attr("disabled",false);A.removeClass("sp-disabled")}function ke(){M();Q=true;y.attr("disabled",true);A.addClass("sp-disabled")}function Le(e){c.offset=e;L()}me();var Fe={show:Te,hide:M,toggle:Se,reflow:L,option:Ie,enable:Pe,disable:ke,offset:Le,set:function(e){N(e);k()},get:O,destroy:Oe,container:b};Fe.id=He.push(Fe)-1;return Fe}function qe(e,t){var i=0;var n=e.outerWidth();var r=e.outerHeight();var s=t.outerHeight();var o=e[0].ownerDocument;var a=o.documentElement;var l=a.clientWidth+Ge(o).scrollLeft();var c=a.clientHeight+Ge(o).scrollTop();var u=t.offset();var d=u.left;var h=u.top;h+=s;d-=Math.min(d,d+n>l&&l>n?Math.abs(d+n-l):0);h-=Math.min(h,h+r>c&&c>r?Math.abs(r+s-i):i);return{top:h,bottom:u.bottom,left:d,right:u.right,width:u.width,height:u.height}}function e(){}function Ke(e){e.stopPropagation()}function r(e,t){var i=Array.prototype.slice;var n=i.call(arguments,2);return function(){return e.apply(t,n.concat(i.call(arguments)))}}function Xe(o,a,i,e){a=a||function(){};i=i||function(){};e=e||function(){};var l=document;var c=false;var u={};var d=0;var h=0;var p="ontouchstart"in window;var n={};n["selectstart"]=f;n["dragstart"]=f;n["touchmove mousemove"]=r;n["touchend mouseup"]=g;function f(e){if(e.stopPropagation){e.stopPropagation()}if(e.preventDefault){e.preventDefault()}e.returnValue=false}function r(e){if(c){if(Be&&l.documentMode<9&&!e.button){return g()}var t=e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches[0];var i=t&&t.pageX||e.pageX;var n=t&&t.pageY||e.pageY;var r=Math.max(0,Math.min(i-u.left,h));var s=Math.max(0,Math.min(n-u.top,d));if(p){f(e)}a.apply(o,[r,s,e])}}function t(e){var t=e.which?e.which==3:e.button==2;if(!t&&!c){if(i.apply(o,arguments)!==false){c=true;d=Ge(o).height();h=Ge(o).width();u=Ge(o).offset();Ge(l).on(n);Ge(l.body).addClass("sp-dragging");r(e);f(e)}}}function g(){if(c){Ge(l).off(n);Ge(l.body).removeClass("sp-dragging");setTimeout(function(){e.apply(o,arguments)},0)}c=false}Ge(o).on("touchstart mousedown",t)}function Qe(n,r,s){var o;return function(){var e=this,t=arguments;var i=function(){o=null;n.apply(e,t)};if(s)clearTimeout(o);if(s||!o)o=setTimeout(i,r)}}function Ze(){return Ge.fn.spectrum.inputTypeColorSupport()}var o="spectrum.id";Ge.fn.spectrum=function(i,e){if(typeof i=="string"){var n=this;var r=Array.prototype.slice.call(arguments,1);this.each(function(){var e=He[Ge(this).data(o)];if(e){var t=e[i];if(!t){throw new Error("Spectrum: no such method: '"+i+"'")}if(i=="get"){n=e.get()}else if(i=="container"){n=e.container}else if(i=="option"){n=e.option.apply(e,r)}else if(i=="destroy"){e.destroy();Ge(this).removeData(o)}else{t.apply(e,r)}}});return n}return this.spectrum("destroy").each(function(){var e=Ge.extend({},Ge(this).data(),i);var t=s(this,e);Ge(this).data(o,t.id)})};Ge.fn.spectrum.load=true;Ge.fn.spectrum.loadOpts={};Ge.fn.spectrum.draggable=Xe;Ge.fn.spectrum.defaults=n;Ge.fn.spectrum.inputTypeColorSupport=function e(){if(typeof e._cachedResult==="undefined"){var t=Ge("<input type='color'/>")[0];e._cachedResult=t.type==="color"&&t.value!==""}return e._cachedResult};Ge.spectrum={};Ge.spectrum.localization={};Ge.spectrum.palettes={};Ge.fn.spectrum.processNativeColorInputs=function(){var e=Ge("input[type=color]");if(e.length&&!Ze()){e.spectrum({preferredFormat:"hex6"})}};(function(){var n=/^[\s,#]+/,r=/\s+$/,s=0,h=Math,o=h.round,c=h.min,u=h.max,e=h.random;var d=function(e,t){e=e?e:"";t=t||{};if(e instanceof d){return e}if(!(this instanceof d)){return new d(e,t)}var i=a(e);this._originalInput=e;this._r=i.r;this._g=i.g;this._b=i.b;this._a=i.a;this._roundA=o(1e3*this._a)/1e3;this._format=t.format||i.format;this._gradientType=t.gradientType;if(this._r<1){this._r=o(this._r)}if(this._g<1){this._g=o(this._g)}if(this._b<1){this._b=o(this._b)}this._ok=i.ok;this._tc_id=s++};d.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},setAlpha:function(e){this._a=R(e);this._roundA=o(1e3*this._a)/1e3;return this},toHsv:function(){var e=g(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=g(this._r,this._g,this._b);var t=o(e.h*360),i=o(e.s*100),n=o(e.v*100);return this._a==1?"hsv("+t+", "+i+"%, "+n+"%)":"hsva("+t+", "+i+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var e=p(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=p(this._r,this._g,this._b);var t=o(e.h*360),i=o(e.s*100),n=o(e.l*100);return this._a==1?"hsl("+t+", "+i+"%, "+n+"%)":"hsla("+t+", "+i+"%, "+n+"%, "+this._roundA+")"},toHex:function(e){return t(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(){return v(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:o(this._r),g:o(this._g),b:o(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+o(this._r)+", "+o(this._g)+", "+o(this._b)+")":"rgba("+o(this._r)+", "+o(this._g)+", "+o(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:o(M(this._r,255)*100)+"%",g:o(M(this._g,255)*100)+"%",b:o(M(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+o(M(this._r,255)*100)+"%, "+o(M(this._g,255)*100)+"%, "+o(M(this._b,255)*100)+"%)":"rgba("+o(M(this._r,255)*100)+"%, "+o(M(this._g,255)*100)+"%, "+o(M(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){if(this._a===0){return"transparent"}if(this._a<1){return false}return G[t(this._r,this._g,this._b,true)]||false},toFilter:function(e){var t="#"+v(this._r,this._g,this._b,this._a);var i=t;var n=this._gradientType?"GradientType = 1, ":"";if(e){var r=d(e);i=r.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+t+",endColorstr="+i+")"},toString:function(e){var t=!!e;e=e||this._format;var i=false;var n=this._a<1&&this._a>=0;var r=!t&&n&&(e==="hex"||e==="hex6"||e==="hex3"||e==="name");if(r){if(e==="name"&&this._a===0){return this.toName()}return this.toRgbString()}if(e==="rgb"){i=this.toRgbString()}if(e==="prgb"){i=this.toPercentageRgbString()}if(e==="hex"||e==="hex6"){i=this.toHexString()}if(e==="hex3"){i=this.toHexString(true)}if(e==="hex8"){i=this.toHex8String()}if(e==="name"){i=this.toName()}if(e==="hsl"){i=this.toHslString()}if(e==="hsv"){i=this.toHsvString()}return i||this.toHexString()},_applyModification:function(e,t){var i=e.apply(null,[this].concat([].slice.call(t)));this._r=i._r;this._g=i._g;this._b=i._b;this.setAlpha(i._a);return this},lighten:function(){return this._applyModification(C,arguments)},brighten:function(){return this._applyModification(w,arguments)},darken:function(){return this._applyModification(_,arguments)},desaturate:function(){return this._applyModification(i,arguments)},saturate:function(){return this._applyModification(y,arguments)},greyscale:function(){return this._applyModification(b,arguments)},spin:function(){return this._applyModification(A,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(L,arguments)},complement:function(){return this._applyCombination(E,arguments)},monochromatic:function(){return this._applyCombination(F,arguments)},splitcomplement:function(){return this._applyCombination(x,arguments)},triad:function(){return this._applyCombination(S,arguments)},tetrad:function(){return this._applyCombination(T,arguments)}};d.fromRatio=function(e,t){if(typeof e=="object"){var i={};for(var n in e){if(e.hasOwnProperty(n)){if(n==="a"){i[n]=e[n]}else{i[n]=P(e[n])}}}e=i}return d(e,t)};function a(e){var t={r:0,g:0,b:0};var i=1;var n=false;var r=false;if(typeof e=="string"){e=z(e)}if(typeof e=="object"){if(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b")){t=l(e.r,e.g,e.b);n=true;r=String(e.r).substr(-1)==="%"?"prgb":"rgb"}else if(e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")){e.s=P(e.s);e.v=P(e.v);t=m(e.h,e.s,e.v);n=true;r="hsv"}else if(e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")){e.s=P(e.s);e.l=P(e.l);t=f(e.h,e.s,e.l);n=true;r="hsl"}if(e.hasOwnProperty("a")){i=e.a}}i=R(i);return{ok:n,format:e.format||r,r:c(255,u(t.r,0)),g:c(255,u(t.g,0)),b:c(255,u(t.b,0)),a:i}}function l(e,t,i){return{r:M(e,255)*255,g:M(t,255)*255,b:M(i,255)*255}}function p(e,t,i){e=M(e,255);t=M(t,255);i=M(i,255);var n=u(e,t,i),r=c(e,t,i);var s,o,a=(n+r)/2;if(n==r){s=o=0}else{var l=n-r;o=a>.5?l/(2-n-r):l/(n+r);switch(n){case e:s=(t-i)/l+(t<i?6:0);break;case t:s=(i-e)/l+2;break;case i:s=(e-t)/l+4;break}s/=6}return{h:s,s:o,l:a}}function f(e,t,i){var n,r,s;e=M(e,360);t=M(t,100);i=M(i,100);function o(e,t,i){if(i<0)i+=1;if(i>1)i-=1;if(i<1/6)return e+(t-e)*6*i;if(i<1/2)return t;if(i<2/3)return e+(t-e)*(2/3-i)*6;return e}if(t===0){n=r=s=i}else{var a=i<.5?i*(1+t):i+t-i*t;var l=2*i-a;n=o(l,a,e+1/3);r=o(l,a,e);s=o(l,a,e-1/3)}return{r:n*255,g:r*255,b:s*255}}function g(e,t,i){e=M(e,255);t=M(t,255);i=M(i,255);var n=u(e,t,i),r=c(e,t,i);var s,o,a=n;var l=n-r;o=n===0?0:l/n;if(n==r){s=0}else{switch(n){case e:s=(t-i)/l+(t<i?6:0);break;case t:s=(i-e)/l+2;break;case i:s=(e-t)/l+4;break}s/=6}return{h:s,s:o,v:a}}function m(e,t,i){e=M(e,360)*6;t=M(t,100);i=M(i,100);var n=h.floor(e),r=e-n,s=i*(1-t),o=i*(1-r*t),a=i*(1-(1-r)*t),l=n%6,c=[i,o,s,s,a,i][l],u=[a,i,i,o,s,s][l],d=[s,s,a,i,i,o][l];return{r:c*255,g:u*255,b:d*255}}function t(e,t,i,n){var r=[I(o(e).toString(16)),I(o(t).toString(16)),I(o(i).toString(16))];if(n&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)){return r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0)}return r.join("")}function v(e,t,i,n){var r=[I(V(n)),I(o(e).toString(16)),I(o(t).toString(16)),I(o(i).toString(16))];return r.join("")}d.equals=function(e,t){if(!e||!t){return false}return d(e).toRgbString()==d(t).toRgbString()};d.random=function(){return d.fromRatio({r:e(),g:e(),b:e()})};function i(e,t){t=t===0?0:t||10;var i=d(e).toHsl();i.s-=t/100;i.s=N(i.s);return d(i)}function y(e,t){t=t===0?0:t||10;var i=d(e).toHsl();i.s+=t/100;i.s=N(i.s);return d(i)}function b(e){return d(e).desaturate(100)}function C(e,t){t=t===0?0:t||10;var i=d(e).toHsl();i.l+=t/100;i.l=N(i.l);return d(i)}function w(e,t){t=t===0?0:t||10;var i=d(e).toRgb();i.r=u(0,c(255,i.r-o(255*-(t/100))));i.g=u(0,c(255,i.g-o(255*-(t/100))));i.b=u(0,c(255,i.b-o(255*-(t/100))));return d(i)}function _(e,t){t=t===0?0:t||10;var i=d(e).toHsl();i.l-=t/100;i.l=N(i.l);return d(i)}function A(e,t){var i=d(e).toHsl();var n=(o(i.h)+t)%360;i.h=n<0?360+n:n;return d(i)}function E(e){var t=d(e).toHsl();t.h=(t.h+180)%360;return d(t)}function S(e){var t=d(e).toHsl();var i=t.h;return[d(e),d({h:(i+120)%360,s:t.s,l:t.l}),d({h:(i+240)%360,s:t.s,l:t.l})]}function T(e){var t=d(e).toHsl();var i=t.h;return[d(e),d({h:(i+90)%360,s:t.s,l:t.l}),d({h:(i+180)%360,s:t.s,l:t.l}),d({h:(i+270)%360,s:t.s,l:t.l})]}function x(e){var t=d(e).toHsl();var i=t.h;return[d(e),d({h:(i+72)%360,s:t.s,l:t.l}),d({h:(i+216)%360,s:t.s,l:t.l})]}function L(e,t,i){t=t||6;i=i||30;var n=d(e).toHsl();var r=360/i;var s=[d(e)];for(n.h=(n.h-(r*t>>1)+720)%360;--t;){n.h=(n.h+r)%360;s.push(d(n))}return s}function F(e,t){t=t||6;var i=d(e).toHsv();var n=i.h,r=i.s,s=i.v;var o=[];var a=1/t;while(t--){o.push(d({h:n,s:r,v:s}));s=(s+a)%1}return o}d.mix=function(e,t,i){i=i===0?0:i||50;var n=d(e).toRgb();var r=d(t).toRgb();var s=i/100;var o=s*2-1;var a=r.a-n.a;var l;if(o*a==-1){l=o}else{l=(o+a)/(1+o*a)}l=(l+1)/2;var c=1-l;var u={r:r.r*l+n.r*c,g:r.g*l+n.g*c,b:r.b*l+n.b*c,a:r.a*s+n.a*(1-s)};return d(u)};d.readability=function(e,t){var i=d(e);var n=d(t);var r=i.toRgb();var s=n.toRgb();var o=i.getBrightness();var a=n.getBrightness();var l=Math.max(r.r,s.r)-Math.min(r.r,s.r)+Math.max(r.g,s.g)-Math.min(r.g,s.g)+Math.max(r.b,s.b)-Math.min(r.b,s.b);return{brightness:Math.abs(o-a),color:l}};d.isReadable=function(e,t){var i=d.readability(e,t);return i.brightness>125&&i.color>500};d.mostReadable=function(e,t){var i=null;var n=0;var r=false;for(var s=0;s<t.length;s++){var o=d.readability(e,t[s]);var a=o.brightness>125&&o.color>500;var l=3*(o.brightness/125)+o.color/500;if(a&&!r||a&&r&&l>n||!a&&!r&&l>n){r=a;n=l;i=d(t[s])}}return i};var D=d.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};var G=d.hexNames=$(D);function $(e){var t={};for(var i in e){if(e.hasOwnProperty(i)){t[e[i]]=i}}return t}function R(e){e=parseFloat(e);if(isNaN(e)||e<0||e>1){e=1}return e}function M(e,t){if(H(e)){e="100%"}var i=B(e);e=c(t,u(0,parseFloat(e)));if(i){e=parseInt(e*t,10)/100}if(h.abs(e-t)<1e-6){return 1}return e%t/parseFloat(t)}function N(e){return c(1,u(0,e))}function O(e){return parseInt(e,16)}function H(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function B(e){return typeof e==="string"&&e.indexOf("%")!=-1}function I(e){return e.length==1?"0"+e:""+e}function P(e){if(e<=1){e=e*100+"%"}return e}function V(e){return Math.round(parseFloat(e)*255).toString(16)}function W(e){return O(e)/255}var k=function(){var e="[-\\+]?\\d+%?";var t="[-\\+]?\\d*\\.\\d+%?";var i="(?:"+t+")|(?:"+e+")";var n="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?";var r="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?";return{rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+r),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function z(e){e=e.replace(n,"").replace(r,"").toLowerCase();var t=false;if(D[e]){e=D[e];t=true}else if(e=="transparent"){return{r:0,g:0,b:0,a:0,format:"name"}}var i;if(i=k.rgb.exec(e)){return{r:i[1],g:i[2],b:i[3]}}if(i=k.rgba.exec(e)){return{r:i[1],g:i[2],b:i[3],a:i[4]}}if(i=k.hsl.exec(e)){return{h:i[1],s:i[2],l:i[3]}}if(i=k.hsla.exec(e)){return{h:i[1],s:i[2],l:i[3],a:i[4]}}if(i=k.hsv.exec(e)){return{h:i[1],s:i[2],v:i[3]}}if(i=k.hsva.exec(e)){return{h:i[1],s:i[2],v:i[3],a:i[4]}}if(i=k.hex8.exec(e)){return{a:W(i[1]),r:O(i[2]),g:O(i[3]),b:O(i[4]),format:t?"name":"hex8"}}if(i=k.hex6.exec(e)){return{r:O(i[1]),g:O(i[2]),b:O(i[3]),format:t?"name":"hex"}}if(i=k.hex3.exec(e)){return{r:O(i[1]+""+i[1]),g:O(i[2]+""+i[2]),b:O(i[3]+""+i[3]),format:t?"name":"hex"}}return false}window.tinycolor=d})();Ge(function(){if(Ge.fn.spectrum.load){Ge.fn.spectrum.processNativeColorInputs()}})});(function(i){if(typeof define==="function"&&define.amd){define(["jquery"],i)}else if(typeof module==="object"&&module.exports){module.exports=function(e,t){if(t===undefined){if(typeof window!=="undefined"){t=require("jquery")}else{t=require("jquery")(e)}}i(t);return t}}else{i(jQuery)}})(function(i){var e=function(){if(i&&i.fn&&i.fn.select2&&i.fn.select2.amd){var t=i.fn.select2.amd}var t;(function(){if(!t||!t.requirejs){if(!t){t={}}else{r=t}var e,r,u;(function(p){var s,o,f,g,m={},v={},y={},b={},i=Object.prototype.hasOwnProperty,n=[].slice,C=/\.js$/;function w(e,t){return i.call(e,t)}function a(e,t){var i,n,r,s,o,a,l,c,u,d,h,p,f=t&&t.split("/"),g=y.map,m=g&&g["*"]||{};if(e){e=e.split("/");o=e.length-1;if(y.nodeIdCompat&&C.test(e[o])){e[o]=e[o].replace(C,"")}if(e[0].charAt(0)==="."&&f){p=f.slice(0,f.length-1);e=p.concat(e)}for(u=0;u<e.length;u++){h=e[u];if(h==="."){e.splice(u,1);u-=1}else if(h===".."){if(u===0||u===1&&e[2]===".."||e[u-1]===".."){continue}else if(u>0){e.splice(u-1,2);u-=2}}}e=e.join("/")}if((f||m)&&g){i=e.split("/");for(u=i.length;u>0;u-=1){n=i.slice(0,u).join("/");if(f){for(d=f.length;d>0;d-=1){r=g[f.slice(0,d).join("/")];if(r){r=r[n];if(r){s=r;a=u;break}}}}if(s){break}if(!l&&m&&m[n]){l=m[n];c=u}}if(!s&&l){s=l;a=c}if(s){i.splice(0,a,s);e=i.join("/")}}return e}function _(t,i){return function(){var e=n.call(arguments,0);if(typeof e[0]!=="string"&&e.length===1){e.push(null)}return o.apply(p,e.concat([t,i]))}}function l(t){return function(e){return a(e,t)}}function A(t){return function(e){m[t]=e}}function E(e){if(w(v,e)){var t=v[e];delete v[e];b[e]=true;s.apply(p,t)}if(!w(m,e)&&!w(b,e)){throw new Error("No "+e)}return m[e]}function c(e){var t,i=e?e.indexOf("!"):-1;if(i>-1){t=e.substring(0,i);e=e.substring(i+1,e.length)}return[t,e]}function S(e){return e?c(e):[]}f=function(e,t){var i,n=c(e),r=n[0],s=t[1];e=n[1];if(r){r=a(r,s);i=E(r)}if(r){if(i&&i.normalize){e=i.normalize(e,l(s))}else{e=a(e,s)}}else{e=a(e,s);n=c(e);r=n[0];e=n[1];if(r){i=E(r)}}return{f:r?r+"!"+e:e,n:e,pr:r,p:i}};function t(e){return function(){return y&&y.config&&y.config[e]||{}}}g={require:function(e){return _(e)},exports:function(e){var t=m[e];if(typeof t!=="undefined"){return t}else{return m[e]={}}},module:function(e){return{id:e,uri:"",exports:m[e],config:t(e)}}};s=function(e,t,i,n){var r,s,o,a,l,c,u=[],d=typeof i,h;n=n||e;c=S(n);if(d==="undefined"||d==="function"){t=!t.length&&i.length?["require","exports","module"]:t;for(l=0;l<t.length;l+=1){a=f(t[l],c);s=a.f;if(s==="require"){u[l]=g.require(e)}else if(s==="exports"){u[l]=g.exports(e);h=true}else if(s==="module"){r=u[l]=g.module(e)}else if(w(m,s)||w(v,s)||w(b,s)){u[l]=E(s)}else if(a.p){a.p.load(a.n,_(n,true),A(s),{});u[l]=m[s]}else{throw new Error(e+" missing "+s)}}o=i?i.apply(m[e],u):undefined;if(e){if(r&&r.exports!==p&&r.exports!==m[e]){m[e]=r.exports}else if(o!==p||!h){m[e]=o}}}else if(e){m[e]=i}};e=r=o=function(e,t,i,n,r){if(typeof e==="string"){if(g[e]){return g[e](t)}return E(f(e,S(t)).f)}else if(!e.splice){y=e;if(y.deps){o(y.deps,y.callback)}if(!t){return}if(t.splice){e=t;t=i;i=null}else{e=p}}t=t||function(){};if(typeof i==="function"){i=n;n=r}if(n){s(p,e,t,i)}else{setTimeout(function(){s(p,e,t,i)},4)}return o};o.config=function(e){return o(e)};e._defined=m;u=function(e,t,i){if(typeof e!=="string"){throw new Error("See almond README: incorrect module build, no module name")}if(!t.splice){i=t;t=[]}if(!w(m,e)&&!w(v,e)){v[e]=[e,t,i]}};u.amd={jQuery:true}})();t.requirejs=e;t.require=r;t.define=u}})();t.define("almond",function(){});t.define("jquery",[],function(){var e=i||$;if(e==null&&console&&console.error){console.error("Select2: An instance of jQuery or a jQuery-compatible library was not "+"found. Make sure that you are including jQuery before Select2 on your "+"web page.")}return e});t.define("select2/utils",["jquery"],function(s){var r={};r.Extend=function(e,t){var i={}.hasOwnProperty;function n(){this.constructor=e}for(var r in t){if(i.call(t,r)){e[r]=t[r]}}n.prototype=t.prototype;e.prototype=new n;e.__super__=t.prototype;return e};function d(e){var t=e.prototype;var i=[];for(var n in t){var r=t[n];if(typeof r!=="function"){continue}if(n==="constructor"){continue}i.push(n)}return i}r.Decorate=function(n,r){var e=d(r);var t=d(n);function s(){var e=Array.prototype.unshift;var t=r.prototype.constructor.length;var i=n.prototype.constructor;if(t>0){e.call(arguments,n.prototype.constructor);i=r.prototype.constructor}i.apply(this,arguments)}r.displayName=n.displayName;function i(){this.constructor=s}s.prototype=new i;for(var o=0;o<t.length;o++){var a=t[o];s.prototype[a]=n.prototype[a]}var l=function(e){var t=function(){};if(e in s.prototype){t=s.prototype[e]}var i=r.prototype[e];return function(){var e=Array.prototype.unshift;e.call(arguments,t);return i.apply(this,arguments)}};for(var c=0;c<e.length;c++){var u=e[c];s.prototype[u]=l(u)}return s};var e=function(){this.listeners={}};e.prototype.on=function(e,t){this.listeners=this.listeners||{};if(e in this.listeners){this.listeners[e].push(t)}else{this.listeners[e]=[t]}};e.prototype.trigger=function(e){var t=Array.prototype.slice;var i=t.call(arguments,1);this.listeners=this.listeners||{};if(i==null){i=[]}if(i.length===0){i.push({})}i[0]._type=e;if(e in this.listeners){this.invoke(this.listeners[e],t.call(arguments,1))}if("*"in this.listeners){this.invoke(this.listeners["*"],arguments)}};e.prototype.invoke=function(e,t){for(var i=0,n=e.length;i<n;i++){e[i].apply(this,t)}};r.Observable=e;r.generateChars=function(e){var t="";for(var i=0;i<e;i++){var n=Math.floor(Math.random()*36);t+=n.toString(36)}return t};r.bind=function(e,t){return function(){e.apply(t,arguments)}};r._convertData=function(e){for(var t in e){var i=t.split("-");var n=e;if(i.length===1){continue}for(var r=0;r<i.length;r++){var s=i[r];s=s.substring(0,1).toLowerCase()+s.substring(1);if(!(s in n)){n[s]={}}if(r==i.length-1){n[s]=e[t]}n=n[s]}delete e[t]}return e};r.hasScroll=function(e,t){var i=s(t);var n=t.style.overflowX;var r=t.style.overflowY;if(n===r&&(r==="hidden"||r==="visible")){return false}if(n==="scroll"||r==="scroll"){return true}return i.innerHeight()<t.scrollHeight||i.innerWidth()<t.scrollWidth};r.escapeMarkup=function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};if(typeof e!=="string"){return e}return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})};r.__cache={};var i=0;r.GetUniqueElementId=function(e){var t=e.getAttribute("data-select2-id");if(t!=null){return t}if(e.id){t="select2-data-"+e.id}else{t="select2-data-"+(++i).toString()+"-"+r.generateChars(4)}e.setAttribute("data-select2-id",t);return t};r.StoreData=function(e,t,i){var n=r.GetUniqueElementId(e);if(!r.__cache[n]){r.__cache[n]={}}r.__cache[n][t]=i};r.GetData=function(e,t){var i=r.GetUniqueElementId(e);if(t){if(r.__cache[i]){if(r.__cache[i][t]!=null){return r.__cache[i][t]}return s(e).data(t)}return s(e).data(t)}else{return r.__cache[i]}};r.RemoveData=function(e){var t=r.GetUniqueElementId(e);if(r.__cache[t]!=null){delete r.__cache[t]}e.removeAttribute("data-select2-id")};r.copyNonInternalCssClasses=function(e,t){var i;var n=e.getAttribute("class").trim().split(/\s+/);n=n.filter(function(e){return e.indexOf("select2-")===0});var r=t.getAttribute("class").trim().split(/\s+/);r=r.filter(function(e){return e.indexOf("select2-")!==0});var s=n.concat(r);e.setAttribute("class",s.join(" "))};return r});t.define("select2/results",["jquery","./utils"],function(p,f){function n(e,t,i){this.$element=e;this.data=i;this.options=t;n.__super__.constructor.call(this)}f.Extend(n,f.Observable);n.prototype.render=function(){var e=p('<ul class="select2-results__options" role="listbox"></ul>');if(this.options.get("multiple")){e.attr("aria-multiselectable","true")}this.$results=e;return e};n.prototype.clear=function(){this.$results.empty()};n.prototype.displayMessage=function(e){var t=this.options.get("escapeMarkup");this.clear();this.hideLoading();var i=p('<li role="alert" aria-live="assertive"'+' class="select2-results__option"></li>');var n=this.options.get("translations").get(e.message);i.append(t(n(e.args)));i[0].className+=" select2-results__message";this.$results.append(i)};n.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()};n.prototype.append=function(e){this.hideLoading();var t=[];if(e.results==null||e.results.length===0){if(this.$results.children().length===0){this.trigger("results:message",{message:"noResults"})}return}e.results=this.sort(e.results);for(var i=0;i<e.results.length;i++){var n=e.results[i];var r=this.option(n);t.push(r)}this.$results.append(t)};n.prototype.position=function(e,t){var i=t.find(".select2-results");i.append(e)};n.prototype.sort=function(e){var t=this.options.get("sorter");return t(e)};n.prototype.highlightFirstItem=function(){var e=this.$results.find(".select2-results__option--selectable");var t=e.filter(".select2-results__option--selected");if(t.length>0){t.first().trigger("mouseenter")}else{e.first().trigger("mouseenter")}this.ensureHighlightVisible()};n.prototype.setClasses=function(){var i=this;this.data.current(function(e){var n=e.map(function(e){return e.id.toString()});var t=i.$results.find(".select2-results__option--selectable");t.each(function(){var e=p(this);var t=f.GetData(this,"data");var i=""+t.id;if(t.element!=null&&t.element.selected||t.element==null&&n.indexOf(i)>-1){this.classList.add("select2-results__option--selected");e.attr("aria-selected","true")}else{this.classList.remove("select2-results__option--selected");e.attr("aria-selected","false")}})})};n.prototype.showLoading=function(e){this.hideLoading();var t=this.options.get("translations").get("searching");var i={disabled:true,loading:true,text:t(e)};var n=this.option(i);n.className+=" loading-results";this.$results.prepend(n)};n.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()};n.prototype.option=function(e){var t=document.createElement("li");t.classList.add("select2-results__option");t.classList.add("select2-results__option--selectable");var i={role:"option"};var n=window.Element.prototype.matches||window.Element.prototype.msMatchesSelector||window.Element.prototype.webkitMatchesSelector;if(e.element!=null&&n.call(e.element,":disabled")||e.element==null&&e.disabled){i["aria-disabled"]="true";t.classList.remove("select2-results__option--selectable");t.classList.add("select2-results__option--disabled")}if(e.id==null){t.classList.remove("select2-results__option--selectable")}if(e._resultId!=null){t.id=e._resultId}if(e.title){t.title=e.title}if(e.children){i.role="group";i["aria-label"]=e.text;t.classList.remove("select2-results__option--selectable");t.classList.add("select2-results__option--group")}for(var r in i){var s=i[r];t.setAttribute(r,s)}if(e.children){var o=p(t);var a=document.createElement("strong");a.className="select2-results__group";this.template(e,a);var l=[];for(var c=0;c<e.children.length;c++){var u=e.children[c];var d=this.option(u);l.push(d)}var h=p("<ul></ul>",{class:"select2-results__options select2-results__options--nested",role:"none"});h.append(l);o.append(a);o.append(h)}else{this.template(e,t)}f.StoreData(t,"data",e);return t};n.prototype.bind=function(t,e){var l=this;var i=t.id+"-results";this.$results.attr("id",i);t.on("results:all",function(e){l.clear();l.append(e.data);if(t.isOpen()){l.setClasses();l.highlightFirstItem()}});t.on("results:append",function(e){l.append(e.data);if(t.isOpen()){l.setClasses()}});t.on("query",function(e){l.hideMessages();l.showLoading(e)});t.on("select",function(){if(!t.isOpen()){return}l.setClasses();if(l.options.get("scrollAfterSelect")){l.highlightFirstItem()}});t.on("unselect",function(){if(!t.isOpen()){return}l.setClasses();if(l.options.get("scrollAfterSelect")){l.highlightFirstItem()}});t.on("open",function(){l.$results.attr("aria-expanded","true");l.$results.attr("aria-hidden","false");l.setClasses();l.ensureHighlightVisible()});t.on("close",function(){l.$results.attr("aria-expanded","false");l.$results.attr("aria-hidden","true");l.$results.removeAttr("aria-activedescendant")});t.on("results:toggle",function(){var e=l.getHighlightedResults();if(e.length===0){return}e.trigger("mouseup")});t.on("results:select",function(){var e=l.getHighlightedResults();if(e.length===0){return}var t=f.GetData(e[0],"data");if(e.hasClass("select2-results__option--selected")){l.trigger("close",{})}else{l.trigger("select",{data:t})}});t.on("results:previous",function(){var e=l.getHighlightedResults();var t=l.$results.find(".select2-results__option--selectable");var i=t.index(e);if(i<=0){return}var n=i-1;if(e.length===0){n=0}var r=t.eq(n);r.trigger("mouseenter");var s=l.$results.offset().top;var o=r.offset().top;var a=l.$results.scrollTop()+(o-s);if(n===0){l.$results.scrollTop(0)}else if(o-s<0){l.$results.scrollTop(a)}});t.on("results:next",function(){var e=l.getHighlightedResults();var t=l.$results.find(".select2-results__option--selectable");var i=t.index(e);var n=i+1;if(n>=t.length){return}var r=t.eq(n);r.trigger("mouseenter");var s=l.$results.offset().top+l.$results.outerHeight(false);var o=r.offset().top+r.outerHeight(false);var a=l.$results.scrollTop()+o-s;if(n===0){l.$results.scrollTop(0)}else if(o>s){l.$results.scrollTop(a)}});t.on("results:focus",function(e){e.element[0].classList.add("select2-results__option--highlighted");e.element[0].setAttribute("aria-selected","true")});t.on("results:message",function(e){l.displayMessage(e)});if(p.fn.mousewheel){this.$results.on("mousewheel",function(e){var t=l.$results.scrollTop();var i=l.$results.get(0).scrollHeight-t+e.deltaY;var n=e.deltaY>0&&t-e.deltaY<=0;var r=e.deltaY<0&&i<=l.$results.height();if(n){l.$results.scrollTop(0);e.preventDefault();e.stopPropagation()}else if(r){l.$results.scrollTop(l.$results.get(0).scrollHeight-l.$results.height());e.preventDefault();e.stopPropagation()}})}this.$results.on("mouseup",".select2-results__option--selectable",function(e){var t=p(this);var i=f.GetData(this,"data");if(t.hasClass("select2-results__option--selected")){if(l.options.get("multiple")){l.trigger("unselect",{originalEvent:e,data:i})}else{l.trigger("close",{})}return}l.trigger("select",{originalEvent:e,data:i})});this.$results.on("mouseenter",".select2-results__option--selectable",function(e){var t=f.GetData(this,"data");l.getHighlightedResults().removeClass("select2-results__option--highlighted").attr("aria-selected","false");l.trigger("results:focus",{data:t,element:p(this)})})};n.prototype.getHighlightedResults=function(){var e=this.$results.find(".select2-results__option--highlighted");return e};n.prototype.destroy=function(){this.$results.remove()};n.prototype.ensureHighlightVisible=function(){var e=this.getHighlightedResults();if(e.length===0){return}var t=this.$results.find(".select2-results__option--selectable");var i=t.index(e);var n=this.$results.offset().top;var r=e.offset().top;var s=this.$results.scrollTop()+(r-n);var o=r-n;s-=e.outerHeight(false)*2;if(i<=2){this.$results.scrollTop(0)}else if(o>this.$results.outerHeight()||o<0){this.$results.scrollTop(s)}};n.prototype.template=function(e,t){var i=this.options.get("templateResult");var n=this.options.get("escapeMarkup");var r=i(e,t);if(r==null){t.style.display="none"}else if(typeof r==="string"){t.innerHTML=n(r)}else{p(t).append(r)}};return n});t.define("select2/keys",[],function(){var e={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};return e});t.define("select2/selection/base",["jquery","../utils","../keys"],function(r,s,o){function i(e,t){this.$element=e;this.options=t;i.__super__.constructor.call(this)}s.Extend(i,s.Observable);i.prototype.render=function(){var e=r('<span class="select2-selection" role="combobox" '+' aria-haspopup="true" aria-expanded="false">'+"</span>");this._tabindex=0;if(s.GetData(this.$element[0],"old-tabindex")!=null){this._tabindex=s.GetData(this.$element[0],"old-tabindex")}else if(this.$element.attr("tabindex")!=null){this._tabindex=this.$element.attr("tabindex")}e.attr("title",this.$element.attr("title"));e.attr("tabindex",this._tabindex);e.attr("aria-disabled","false");this.$selection=e;return e};i.prototype.bind=function(e,t){var i=this;var n=e.id+"-results";this.container=e;this.$selection.on("focus",function(e){i.trigger("focus",e)});this.$selection.on("blur",function(e){i._handleBlur(e)});this.$selection.on("keydown",function(e){i.trigger("keypress",e);if(e.which===o.SPACE){e.preventDefault()}});e.on("results:focus",function(e){i.$selection.attr("aria-activedescendant",e.data._resultId)});e.on("selection:update",function(e){i.update(e.data)});e.on("open",function(){i.$selection.attr("aria-expanded","true");i.$selection.attr("aria-owns",n);i._attachCloseHandler(e)});e.on("close",function(){i.$selection.attr("aria-expanded","false");i.$selection.removeAttr("aria-activedescendant");i.$selection.removeAttr("aria-owns");i.$selection.trigger("focus");i._detachCloseHandler(e)});e.on("enable",function(){i.$selection.attr("tabindex",i._tabindex);i.$selection.attr("aria-disabled","false")});e.on("disable",function(){i.$selection.attr("tabindex","-1");i.$selection.attr("aria-disabled","true")})};i.prototype._handleBlur=function(e){var t=this;window.setTimeout(function(){if(document.activeElement==t.$selection[0]||r.contains(t.$selection[0],document.activeElement)){return}t.trigger("blur",e)},1)};i.prototype._attachCloseHandler=function(e){r(document.body).on("mousedown.select2."+e.id,function(e){var t=r(e.target);var i=t.closest(".select2");var n=r(".select2.select2-container--open");n.each(function(){if(this==i[0]){return}var e=s.GetData(this,"element");e.select2("close")})})};i.prototype._detachCloseHandler=function(e){r(document.body).off("mousedown.select2."+e.id)};i.prototype.position=function(e,t){var i=t.find(".selection");i.append(e)};i.prototype.destroy=function(){this._detachCloseHandler(this.container)};i.prototype.update=function(e){throw new Error("The `update` method must be defined in child classes.")};i.prototype.isEnabled=function(){return!this.isDisabled()};i.prototype.isDisabled=function(){return this.options.get("disabled")};return i});t.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(e,t,i,n){function r(){r.__super__.constructor.apply(this,arguments)}i.Extend(r,t);r.prototype.render=function(){var e=r.__super__.render.call(this);e[0].classList.add("select2-selection--single");e.html('<span class="select2-selection__rendered"></span>'+'<span class="select2-selection__arrow" role="presentation">'+'<b role="presentation"></b>'+"</span>");return e};r.prototype.bind=function(t,e){var i=this;r.__super__.bind.apply(this,arguments);var n=t.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",n).attr("role","textbox").attr("aria-readonly","true");this.$selection.attr("aria-labelledby",n);this.$selection.attr("aria-controls",n);this.$selection.on("mousedown",function(e){if(e.which!==1){return}i.trigger("toggle",{originalEvent:e})});this.$selection.on("focus",function(e){});this.$selection.on("blur",function(e){});t.on("focus",function(e){if(!t.isOpen()){i.$selection.trigger("focus")}})};r.prototype.clear=function(){var e=this.$selection.find(".select2-selection__rendered");e.empty();e.removeAttr("title")};r.prototype.display=function(e,t){var i=this.options.get("templateSelection");var n=this.options.get("escapeMarkup");return n(i(e,t))};r.prototype.selectionContainer=function(){return e("<span></span>")};r.prototype.update=function(e){if(e.length===0){this.clear();return}var t=e[0];var i=this.$selection.find(".select2-selection__rendered");var n=this.display(t,i);i.empty().append(n);var r=t.title||t.text;if(r){i.attr("title",r)}else{i.removeAttr("title")}};return r});t.define("select2/selection/multiple",["jquery","./base","../utils"],function(s,e,h){function n(e,t){n.__super__.constructor.apply(this,arguments)}h.Extend(n,e);n.prototype.render=function(){var e=n.__super__.render.call(this);e[0].classList.add("select2-selection--multiple");e.html('<ul class="select2-selection__rendered"></ul>');return e};n.prototype.bind=function(e,t){var r=this;n.__super__.bind.apply(this,arguments);var i=e.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",i);this.$selection.on("click",function(e){r.trigger("toggle",{originalEvent:e})});this.$selection.on("click",".select2-selection__choice__remove",function(e){if(r.isDisabled()){return}var t=s(this);var i=t.parent();var n=h.GetData(i[0],"data");r.trigger("unselect",{originalEvent:e,data:n})});this.$selection.on("keydown",".select2-selection__choice__remove",function(e){if(r.isDisabled()){return}e.stopPropagation()})};n.prototype.clear=function(){var e=this.$selection.find(".select2-selection__rendered");e.empty();e.removeAttr("title")};n.prototype.display=function(e,t){var i=this.options.get("templateSelection");var n=this.options.get("escapeMarkup");return n(i(e,t))};n.prototype.selectionContainer=function(){var e=s('<li class="select2-selection__choice">'+'<button type="button" class="select2-selection__choice__remove" '+'tabindex="-1">'+'<span aria-hidden="true">&times;</span>'+"</button>"+'<span class="select2-selection__choice__display"></span>'+"</li>");return e};n.prototype.update=function(e){this.clear();if(e.length===0){return}var t=[];var i=this.$selection.find(".select2-selection__rendered").attr("id")+"-choice-";for(var n=0;n<e.length;n++){var r=e[n];var s=this.selectionContainer();var o=this.display(r,s);var a=i+h.generateChars(4)+"-";if(r.id){a+=r.id}else{a+=h.generateChars(4)}s.find(".select2-selection__choice__display").append(o).attr("id",a);var l=r.title||r.text;if(l){s.attr("title",l)}var c=this.options.get("translations").get("removeItem");var u=s.find(".select2-selection__choice__remove");u.attr("title",c());u.attr("aria-label",c());u.attr("aria-describedby",a);h.StoreData(s[0],"data",r);t.push(s)}var d=this.$selection.find(".select2-selection__rendered");d.append(t)};return n});t.define("select2/selection/placeholder",[],function(){function e(e,t,i){this.placeholder=this.normalizePlaceholder(i.get("placeholder"));e.call(this,t,i)}e.prototype.normalizePlaceholder=function(e,t){if(typeof t==="string"){t={id:"",text:t}}return t};e.prototype.createPlaceholder=function(e,t){var i=this.selectionContainer();i.html(this.display(t));i[0].classList.add("select2-selection__placeholder");i[0].classList.remove("select2-selection__choice");var n=t.title||t.text||i.text();this.$selection.find(".select2-selection__rendered").attr("title",n);return i};e.prototype.update=function(e,t){var i=t.length==1&&t[0].id!=this.placeholder.id;var n=t.length>1;if(n||i){return e.call(this,t)}this.clear();var r=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(r)};return e});t.define("select2/selection/allowClear",["jquery","../keys","../utils"],function(s,n,a){function e(){}e.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i);if(this.placeholder==null){if(this.options.get("debug")&&window.console&&console.error){console.error("Select2: The `allowClear` option should be used in combination "+"with the `placeholder` option.")}}this.$selection.on("mousedown",".select2-selection__clear",function(e){n._handleClear(e)});t.on("keypress",function(e){n._handleKeyboardClear(e,t)})};e.prototype._handleClear=function(e,t){if(this.isDisabled()){return}var i=this.$selection.find(".select2-selection__clear");if(i.length===0){return}t.stopPropagation();var n=a.GetData(i[0],"data");var r=this.$element.val();this.$element.val(this.placeholder.id);var s={data:n};this.trigger("clear",s);if(s.prevented){this.$element.val(r);return}for(var o=0;o<n.length;o++){s={data:n[o]};this.trigger("unselect",s);if(s.prevented){this.$element.val(r);return}}this.$element.trigger("input").trigger("change");this.trigger("toggle",{})};e.prototype._handleKeyboardClear=function(e,t,i){if(i.isOpen()){return}if(t.which==n.DELETE||t.which==n.BACKSPACE){this._handleClear(t)}};e.prototype.update=function(e,t){e.call(this,t);this.$selection.find(".select2-selection__clear").remove();this.$selection[0].classList.remove("select2-selection--clearable");if(this.$selection.find(".select2-selection__placeholder").length>0||t.length===0){return}var i=this.$selection.find(".select2-selection__rendered").attr("id");var n=this.options.get("translations").get("removeAllItems");var r=s('<button type="button" class="select2-selection__clear" tabindex="-1">'+'<span aria-hidden="true">&times;</span>'+"</button>");r.attr("title",n());r.attr("aria-label",n());r.attr("aria-describedby",i);a.StoreData(r[0],"data",t);this.$selection.prepend(r);this.$selection[0].classList.add("select2-selection--clearable")};return e});t.define("select2/selection/search",["jquery","../utils","../keys"],function(r,l,c){function e(e,t,i){e.call(this,t,i)}e.prototype.render=function(e){var t=this.options.get("translations").get("search");var i=r('<span class="select2-search select2-search--inline">'+'<textarea class="select2-search__field"'+' type="search" tabindex="-1"'+' autocorrect="off" autocapitalize="none"'+' spellcheck="false" role="searchbox" aria-autocomplete="list" >'+"</textarea>"+"</span>");this.$searchContainer=i;this.$search=i.find("textarea");this.$search.prop("autocomplete",this.options.get("autocomplete"));this.$search.attr("aria-label",t());var n=e.call(this);this._transferTabIndex();n.append(this.$searchContainer);return n};e.prototype.bind=function(e,t,i){var r=this;var n=t.id+"-results";var s=t.id+"-container";e.call(this,t,i);r.$search.attr("aria-describedby",s);t.on("open",function(){r.$search.attr("aria-controls",n);r.$search.trigger("focus")});t.on("close",function(){r.$search.val("");r.resizeSearch();r.$search.removeAttr("aria-controls");r.$search.removeAttr("aria-activedescendant");r.$search.trigger("focus")});t.on("enable",function(){r.$search.prop("disabled",false);r._transferTabIndex()});t.on("disable",function(){r.$search.prop("disabled",true)});t.on("focus",function(e){r.$search.trigger("focus")});t.on("results:focus",function(e){if(e.data._resultId){r.$search.attr("aria-activedescendant",e.data._resultId)}else{r.$search.removeAttr("aria-activedescendant")}});this.$selection.on("focusin",".select2-search--inline",function(e){r.trigger("focus",e)});this.$selection.on("focusout",".select2-search--inline",function(e){r._handleBlur(e)});this.$selection.on("keydown",".select2-search--inline",function(e){e.stopPropagation();r.trigger("keypress",e);r._keyUpPrevented=e.isDefaultPrevented();var t=e.which;if(t===c.BACKSPACE&&r.$search.val()===""){var i=r.$selection.find(".select2-selection__choice").last();if(i.length>0){var n=l.GetData(i[0],"data");r.searchRemoveChoice(n);e.preventDefault()}}});this.$selection.on("click",".select2-search--inline",function(e){if(r.$search.val()){e.stopPropagation()}});var o=document.documentMode;var a=o&&o<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(e){if(a){r.$selection.off("input.search input.searchcheck");return}r.$selection.off("keyup.search")});this.$selection.on("keyup.search input.search",".select2-search--inline",function(e){if(a&&e.type==="input"){r.$selection.off("input.search input.searchcheck");return}var t=e.which;if(t==c.SHIFT||t==c.CTRL||t==c.ALT){return}if(t==c.TAB){return}r.handleSearch(e)})};e.prototype._transferTabIndex=function(e){this.$search.attr("tabindex",this.$selection.attr("tabindex"));this.$selection.attr("tabindex","-1")};e.prototype.createPlaceholder=function(e,t){this.$search.attr("placeholder",t.text)};e.prototype.update=function(e,t){var i=this.$search[0]==document.activeElement;this.$search.attr("placeholder","");e.call(this,t);this.resizeSearch();if(i){this.$search.trigger("focus")}};e.prototype.handleSearch=function(){this.resizeSearch();if(!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=false};e.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t});this.$search.val(t.text);this.handleSearch()};e.prototype.resizeSearch=function(){this.$search.css("width","25px");var e="100%";if(this.$search.attr("placeholder")===""){var t=this.$search.val().length+1;e=t*.75+"em"}this.$search.css("width",e)};return e});t.define("select2/selection/selectionCss",["../utils"],function(n){function e(){}e.prototype.render=function(e){var t=e.call(this);var i=this.options.get("selectionCssClass")||"";if(i.indexOf(":all:")!==-1){i=i.replace(":all:","");n.copyNonInternalCssClasses(t[0],this.$element[0])}t.addClass(i);return t};return e});t.define("select2/selection/eventRelay",["jquery"],function(o){function e(){}e.prototype.bind=function(e,t,i){var n=this;var r=["open","opening","close","closing","select","selecting","unselect","unselecting","clear","clearing"];var s=["opening","closing","selecting","unselecting","clearing"];e.call(this,t,i);t.on("*",function(e,t){if(r.indexOf(e)===-1){return}t=t||{};var i=o.Event("select2:"+e,{params:t});n.$element.trigger(i);if(s.indexOf(e)===-1){return}t.prevented=i.isDefaultPrevented()})};return e});t.define("select2/translation",["jquery","require"],function(t,i){function n(e){this.dict=e||{}}n.prototype.all=function(){return this.dict};n.prototype.get=function(e){return this.dict[e]};n.prototype.extend=function(e){this.dict=t.extend({},e.all(),this.dict)};n._cache={};n.loadPath=function(e){if(!(e in n._cache)){var t=i(e);n._cache[e]=t}return new n(n._cache[e])};return n});t.define("select2/diacritics",[],function(){var e={"‚í∂":"A","Ôº°":"A","√Ä":"A","√Å":"A","√Ç":"A","·∫¶":"A","·∫§":"A","·∫™":"A","·∫®":"A","√É":"A","ƒÄ":"A","ƒÇ":"A","·∫∞":"A","·∫Æ":"A","·∫¥":"A","·∫≤":"A","»¶":"A","«†":"A","√Ñ":"A","«û":"A","·∫¢":"A","√Ö":"A","«∫":"A","«ç":"A","»Ä":"A","»Ç":"A","·∫†":"A","·∫¨":"A","·∫∂":"A","·∏Ä":"A","ƒÑ":"A","»∫":"A","‚±Ø":"A","Íú≤":"AA","√Ü":"AE","«º":"AE","«¢":"AE","Íú¥":"AO","Íú∂":"AU","Íú∏":"AV","Íú∫":"AV","Íúº":"AY","‚í∑":"B","Ôº¢":"B","·∏Ç":"B","·∏Ñ":"B","·∏Ü":"B","…É":"B","∆Ç":"B","∆Å":"B","‚í∏":"C","Ôº£":"C","ƒÜ":"C","ƒà":"C","ƒä":"C","ƒå":"C","√á":"C","·∏à":"C","∆á":"C","»ª":"C","Íúæ":"C","‚íπ":"D","Ôº§":"D","·∏ä":"D","ƒé":"D","·∏å":"D","·∏ê":"D","·∏í":"D","·∏é":"D","ƒê":"D","∆ã":"D","∆ä":"D","∆â":"D","Íùπ":"D","«±":"DZ","«Ñ":"DZ","«≤":"Dz","«Ö":"Dz","‚í∫":"E","Ôº•":"E","√à":"E","√â":"E","√ä":"E","·ªÄ":"E","·∫æ":"E","·ªÑ":"E","·ªÇ":"E","·∫º":"E","ƒí":"E","·∏î":"E","·∏ñ":"E","ƒî":"E","ƒñ":"E","√ã":"E","·∫∫":"E","ƒö":"E","»Ñ":"E","»Ü":"E","·∫∏":"E","·ªÜ":"E","»®":"E","·∏ú":"E","ƒò":"E","·∏ò":"E","·∏ö":"E","∆ê":"E","∆é":"E","‚íª":"F","Ôº¶":"F","·∏û":"F","∆ë":"F","Íùª":"F","‚íº":"G","Ôºß":"G","«¥":"G","ƒú":"G","·∏†":"G","ƒû":"G","ƒ†":"G","«¶":"G","ƒ¢":"G","«§":"G","∆ì":"G","Íû†":"G","ÍùΩ":"G","Íùæ":"G","‚íΩ":"H","Ôº®":"H","ƒ§":"H","·∏¢":"H","·∏¶":"H","»û":"H","·∏§":"H","·∏®":"H","·∏™":"H","ƒ¶":"H","‚±ß":"H","‚±µ":"H","Íûç":"H","‚íæ":"I","Ôº©":"I","√å":"I","√ç":"I","√é":"I","ƒ®":"I","ƒ™":"I","ƒ¨":"I","ƒ∞":"I","√è":"I","·∏Æ":"I","·ªà":"I","«è":"I","»à":"I","»ä":"I","·ªä":"I","ƒÆ":"I","·∏¨":"I","∆ó":"I","‚íø":"J","Ôº™":"J","ƒ¥":"J","…à":"J","‚ìÄ":"K","Ôº´":"K","·∏∞":"K","«®":"K","·∏≤":"K","ƒ∂":"K","·∏¥":"K","∆ò":"K","‚±©":"K","ÍùÄ":"K","ÍùÇ":"K","ÍùÑ":"K","Íû¢":"K","‚ìÅ":"L","Ôº¨":"L","ƒø":"L","ƒπ":"L","ƒΩ":"L","·∏∂":"L","·∏∏":"L","ƒª":"L","·∏º":"L","·∏∫":"L","≈Å":"L","»Ω":"L","‚±¢":"L","‚±†":"L","Íùà":"L","ÍùÜ":"L","ÍûÄ":"L","«á":"LJ","«à":"Lj","‚ìÇ":"M","Ôº≠":"M","·∏æ":"M","·πÄ":"M","·πÇ":"M","‚±Æ":"M","∆ú":"M","‚ìÉ":"N","ÔºÆ":"N","«∏":"N","≈É":"N","√ë":"N","·πÑ":"N","≈á":"N","·πÜ":"N","≈Ö":"N","·πä":"N","·πà":"N","»†":"N","∆ù":"N","Íûê":"N","Íû§":"N","«ä":"NJ","«ã":"Nj","‚ìÑ":"O","ÔºØ":"O","√í":"O","√ì":"O","√î":"O","·ªí":"O","·ªê":"O","·ªñ":"O","·ªî":"O","√ï":"O","·πå":"O","»¨":"O","·πé":"O","≈å":"O","·πê":"O","·πí":"O","≈é":"O","»Æ":"O","»∞":"O","√ñ":"O","»™":"O","·ªé":"O","≈ê":"O","«ë":"O","»å":"O","»é":"O","∆†":"O","·ªú":"O","·ªö":"O","·ª†":"O","·ªû":"O","·ª¢":"O","·ªå":"O","·ªò":"O","«™":"O","«¨":"O","√ò":"O","«æ":"O","∆Ü":"O","∆ü":"O","Íùä":"O","Íùå":"O","≈í":"OE","∆¢":"OI","Íùé":"OO","»¢":"OU","‚ìÖ":"P","Ôº∞":"P","·πî":"P","·πñ":"P","∆§":"P","‚±£":"P","Íùê":"P","Íùí":"P","Íùî":"P","‚ìÜ":"Q","Ôº±":"Q","Íùñ":"Q","Íùò":"Q","…ä":"Q","‚ìá":"R","Ôº≤":"R","≈î":"R","·πò":"R","≈ò":"R","»ê":"R","»í":"R","·πö":"R","·πú":"R","≈ñ":"R","·πû":"R","…å":"R","‚±§":"R","Íùö":"R","Íû¶":"R","ÍûÇ":"R","‚ìà":"S","Ôº≥":"S","·∫û":"S","≈ö":"S","·π§":"S","≈ú":"S","·π†":"S","≈†":"S","·π¶":"S","·π¢":"S","·π®":"S","»ò":"S","≈û":"S","‚±æ":"S","Íû®":"S","ÍûÑ":"S","‚ìâ":"T","Ôº¥":"T","·π™":"T","≈§":"T","·π¨":"T","»ö":"T","≈¢":"T","·π∞":"T","·πÆ":"T","≈¶":"T","∆¨":"T","∆Æ":"T","»æ":"T","ÍûÜ":"T","Íú®":"TZ","‚ìä":"U","Ôºµ":"U","√ô":"U","√ö":"U","√õ":"U","≈®":"U","·π∏":"U","≈™":"U","·π∫":"U","≈¨":"U","√ú":"U","«õ":"U","«ó":"U","«ï":"U","«ô":"U","·ª¶":"U","≈Æ":"U","≈∞":"U","«ì":"U","»î":"U","»ñ":"U","∆Ø":"U","·ª™":"U","·ª®":"U","·ªÆ":"U","·ª¨":"U","·ª∞":"U","·ª§":"U","·π≤":"U","≈≤":"U","·π∂":"U","·π¥":"U","…Ñ":"U","‚ìã":"V","Ôº∂":"V","·πº":"V","·πæ":"V","∆≤":"V","Íùû":"V","…Ö":"V","Íù†":"VY","‚ìå":"W","Ôº∑":"W","·∫Ä":"W","·∫Ç":"W","≈¥":"W","·∫Ü":"W","·∫Ñ":"W","·∫à":"W","‚±≤":"W","‚ìç":"X","Ôº∏":"X","·∫ä":"X","·∫å":"X","‚ìé":"Y","Ôºπ":"Y","·ª≤":"Y","√ù":"Y","≈∂":"Y","·ª∏":"Y","»≤":"Y","·∫é":"Y","≈∏":"Y","·ª∂":"Y","·ª¥":"Y","∆≥":"Y","…é":"Y","·ªæ":"Y","‚ìè":"Z","Ôº∫":"Z","≈π":"Z","·∫ê":"Z","≈ª":"Z","≈Ω":"Z","·∫í":"Z","·∫î":"Z","∆µ":"Z","»§":"Z","‚±ø":"Z","‚±´":"Z","Íù¢":"Z","‚ìê":"a","ÔΩÅ":"a","·∫ö":"a","√†":"a","√°":"a","√¢":"a","·∫ß":"a","·∫•":"a","·∫´":"a","·∫©":"a","√£":"a","ƒÅ":"a","ƒÉ":"a","·∫±":"a","·∫Ø":"a","·∫µ":"a","·∫≥":"a","»ß":"a","«°":"a","√§":"a","«ü":"a","·∫£":"a","√•":"a","«ª":"a","«é":"a","»Å":"a","»É":"a","·∫°":"a","·∫≠":"a","·∫∑":"a","·∏Å":"a","ƒÖ":"a","‚±•":"a","…ê":"a","Íú≥":"aa","√¶":"ae","«Ω":"ae","«£":"ae","Íúµ":"ao","Íú∑":"au","Íúπ":"av","Íúª":"av","ÍúΩ":"ay","‚ìë":"b","ÔΩÇ":"b","·∏É":"b","·∏Ö":"b","·∏á":"b","∆Ä":"b","∆É":"b","…ì":"b","‚ìí":"c","ÔΩÉ":"c","ƒá":"c","ƒâ":"c","ƒã":"c","ƒç":"c","√ß":"c","·∏â":"c","∆à":"c","»º":"c","Íúø":"c","‚ÜÑ":"c","‚ìì":"d","ÔΩÑ":"d","·∏ã":"d","ƒè":"d","·∏ç":"d","·∏ë":"d","·∏ì":"d","·∏è":"d","ƒë":"d","∆å":"d","…ñ":"d","…ó":"d","Íù∫":"d","«≥":"dz","«Ü":"dz","‚ìî":"e","ÔΩÖ":"e","√®":"e","√©":"e","√™":"e","·ªÅ":"e","·∫ø":"e","·ªÖ":"e","·ªÉ":"e","·∫Ω":"e","ƒì":"e","·∏ï":"e","·∏ó":"e","ƒï":"e","ƒó":"e","√´":"e","·∫ª":"e","ƒõ":"e","»Ö":"e","»á":"e","·∫π":"e","·ªá":"e","»©":"e","·∏ù":"e","ƒô":"e","·∏ô":"e","·∏õ":"e","…á":"e","…õ":"e","«ù":"e","‚ìï":"f","ÔΩÜ":"f","·∏ü":"f","∆í":"f","Íùº":"f","‚ìñ":"g","ÔΩá":"g","«µ":"g","ƒù":"g","·∏°":"g","ƒü":"g","ƒ°":"g","«ß":"g","ƒ£":"g","«•":"g","…†":"g","Íû°":"g","·µπ":"g","Íùø":"g","‚ìó":"h","ÔΩà":"h","ƒ•":"h","·∏£":"h","·∏ß":"h","»ü":"h","·∏•":"h","·∏©":"h","·∏´":"h","·∫ñ":"h","ƒß":"h","‚±®":"h","‚±∂":"h","…•":"h","∆ï":"hv","‚ìò":"i","ÔΩâ":"i","√¨":"i","√≠":"i","√Æ":"i","ƒ©":"i","ƒ´":"i","ƒ≠":"i","√Ø":"i","·∏Ø":"i","·ªâ":"i","«ê":"i","»â":"i","»ã":"i","·ªã":"i","ƒØ":"i","·∏≠":"i","…®":"i","ƒ±":"i","‚ìô":"j","ÔΩä":"j","ƒµ":"j","«∞":"j","…â":"j","‚ìö":"k","ÔΩã":"k","·∏±":"k","«©":"k","·∏≥":"k","ƒ∑":"k","·∏µ":"k","∆ô":"k","‚±™":"k","ÍùÅ":"k","ÍùÉ":"k","ÍùÖ":"k","Íû£":"k","‚ìõ":"l","ÔΩå":"l","≈Ä":"l","ƒ∫":"l","ƒæ":"l","·∏∑":"l","·∏π":"l","ƒº":"l","·∏Ω":"l","·∏ª":"l","≈ø":"l","≈Ç":"l","∆ö":"l","…´":"l","‚±°":"l","Íùâ":"l","ÍûÅ":"l","Íùá":"l","«â":"lj","‚ìú":"m","ÔΩç":"m","·∏ø":"m","·πÅ":"m","·πÉ":"m","…±":"m","…Ø":"m","‚ìù":"n","ÔΩé":"n","«π":"n","≈Ñ":"n","√±":"n","·πÖ":"n","≈à":"n","·πá":"n","≈Ü":"n","·πã":"n","·πâ":"n","∆û":"n","…≤":"n","≈â":"n","Íûë":"n","Íû•":"n","«å":"nj","‚ìû":"o","ÔΩè":"o","√≤":"o","√≥":"o","√¥":"o","·ªì":"o","·ªë":"o","·ªó":"o","·ªï":"o","√µ":"o","·πç":"o","»≠":"o","·πè":"o","≈ç":"o","·πë":"o","·πì":"o","≈è":"o","»Ø":"o","»±":"o","√∂":"o","»´":"o","·ªè":"o","≈ë":"o","«í":"o","»ç":"o","»è":"o","∆°":"o","·ªù":"o","·ªõ":"o","·ª°":"o","·ªü":"o","·ª£":"o","·ªç":"o","·ªô":"o","«´":"o","«≠":"o","√∏":"o","«ø":"o","…î":"o","Íùã":"o","Íùç":"o","…µ":"o","≈ì":"oe","∆£":"oi","»£":"ou","Íùè":"oo","‚ìü":"p","ÔΩê":"p","·πï":"p","·πó":"p","∆•":"p","·µΩ":"p","Íùë":"p","Íùì":"p","Íùï":"p","‚ì†":"q","ÔΩë":"q","…ã":"q","Íùó":"q","Íùô":"q","‚ì°":"r","ÔΩí":"r","≈ï":"r","·πô":"r","≈ô":"r","»ë":"r","»ì":"r","·πõ":"r","·πù":"r","≈ó":"r","·πü":"r","…ç":"r","…Ω":"r","Íùõ":"r","Íûß":"r","ÍûÉ":"r","‚ì¢":"s","ÔΩì":"s","√ü":"s","≈õ":"s","·π•":"s","≈ù":"s","·π°":"s","≈°":"s","·πß":"s","·π£":"s","·π©":"s","»ô":"s","≈ü":"s","»ø":"s","Íû©":"s","ÍûÖ":"s","·∫õ":"s","‚ì£":"t","ÔΩî":"t","·π´":"t","·∫ó":"t","≈•":"t","·π≠":"t","»õ":"t","≈£":"t","·π±":"t","·πØ":"t","≈ß":"t","∆≠":"t"," à":"t","‚±¶":"t","Íûá":"t","Íú©":"tz","‚ì§":"u","ÔΩï":"u","√π":"u","√∫":"u","√ª":"u","≈©":"u","·ππ":"u","≈´":"u","·πª":"u","≈≠":"u","√º":"u","«ú":"u","«ò":"u","«ñ":"u","«ö":"u","·ªß":"u","≈Ø":"u","≈±":"u","«î":"u","»ï":"u","»ó":"u","∆∞":"u","·ª´":"u","·ª©":"u","·ªØ":"u","·ª≠":"u","·ª±":"u","·ª•":"u","·π≥":"u","≈≥":"u","·π∑":"u","·πµ":"u"," â":"u","‚ì•":"v","ÔΩñ":"v","·πΩ":"v","·πø":"v"," ã":"v","Íùü":"v"," å":"v","Íù°":"vy","‚ì¶":"w","ÔΩó":"w","·∫Å":"w","·∫É":"w","≈µ":"w","·∫á":"w","·∫Ö":"w","·∫ò":"w","·∫â":"w","‚±≥":"w","‚ìß":"x","ÔΩò":"x","·∫ã":"x","·∫ç":"x","‚ì®":"y","ÔΩô":"y","·ª≥":"y","√Ω":"y","≈∑":"y","·ªπ":"y","»≥":"y","·∫è":"y","√ø":"y","·ª∑":"y","·∫ô":"y","·ªµ":"y","∆¥":"y","…è":"y","·ªø":"y","‚ì©":"z","ÔΩö":"z","≈∫":"z","·∫ë":"z","≈º":"z","≈æ":"z","·∫ì":"z","·∫ï":"z","∆∂":"z","»•":"z","…Ä":"z","‚±¨":"z","Íù£":"z","ŒÜ":"Œë","Œà":"Œï","Œâ":"Œó","Œä":"Œô","Œ™":"Œô","Œå":"Œü","Œé":"Œ•","Œ´":"Œ•","Œè":"Œ©","Œ¨":"Œ±","Œ≠":"Œµ","ŒÆ":"Œ∑","ŒØ":"Œπ","œä":"Œπ","Œê":"Œπ","œå":"Œø","œç":"œÖ","œã":"œÖ","Œ∞":"œÖ","œé":"œâ","œÇ":"œÉ","‚Äô":"'"};return e});t.define("select2/data/base",["../utils"],function(n){function i(e,t){i.__super__.constructor.call(this)}n.Extend(i,n.Observable);i.prototype.current=function(e){throw new Error("The `current` method must be defined in child classes.")};i.prototype.query=function(e,t){throw new Error("The `query` method must be defined in child classes.")};i.prototype.bind=function(e,t){};i.prototype.destroy=function(){};i.prototype.generateResultId=function(e,t){var i=e.id+"-result-";i+=n.generateChars(4);if(t.id!=null){i+="-"+t.id.toString()}else{i+="-"+n.generateChars(4)}return i};return i});t.define("select2/data/select",["./base","../utils","jquery"],function(e,l,c){function i(e,t){this.$element=e;this.options=t;i.__super__.constructor.call(this)}l.Extend(i,e);i.prototype.current=function(e){var t=this;var i=Array.prototype.map.call(this.$element[0].querySelectorAll(":checked"),function(e){return t.item(c(e))});e(i)};i.prototype.select=function(r){var s=this;r.selected=true;if(r.element!=null&&r.element.tagName.toLowerCase()==="option"){r.element.selected=true;this.$element.trigger("input").trigger("change");return}if(this.$element.prop("multiple")){this.current(function(e){var t=[];r=[r];r.push.apply(r,e);for(var i=0;i<r.length;i++){var n=r[i].id;if(t.indexOf(n)===-1){t.push(n)}}s.$element.val(t);s.$element.trigger("input").trigger("change")})}else{var e=r.id;this.$element.val(e);this.$element.trigger("input").trigger("change")}};i.prototype.unselect=function(r){var s=this;if(!this.$element.prop("multiple")){return}r.selected=false;if(r.element!=null&&r.element.tagName.toLowerCase()==="option"){r.element.selected=false;this.$element.trigger("input").trigger("change");return}this.current(function(e){var t=[];for(var i=0;i<e.length;i++){var n=e[i].id;if(n!==r.id&&t.indexOf(n)===-1){t.push(n)}}s.$element.val(t);s.$element.trigger("input").trigger("change")})};i.prototype.bind=function(e,t){var i=this;this.container=e;e.on("select",function(e){i.select(e.data)});e.on("unselect",function(e){i.unselect(e.data)})};i.prototype.destroy=function(){this.$element.find("*").each(function(){l.RemoveData(this)})};i.prototype.query=function(n,e){var r=[];var s=this;var t=this.$element.children();t.each(function(){if(this.tagName.toLowerCase()!=="option"&&this.tagName.toLowerCase()!=="optgroup"){return}var e=c(this);var t=s.item(e);var i=s.matches(n,t);if(i!==null){r.push(i)}});e({results:r})};i.prototype.addOptions=function(e){this.$element.append(e)};i.prototype.option=function(e){var t;if(e.children){t=document.createElement("optgroup");t.label=e.text}else{t=document.createElement("option");if(t.textContent!==undefined){t.textContent=e.text}else{t.innerText=e.text}}if(e.id!==undefined){t.value=e.id}if(e.disabled){t.disabled=true}if(e.selected){t.selected=true}if(e.title){t.title=e.title}var i=this._normalizeItem(e);i.element=t;l.StoreData(t,"data",i);return c(t)};i.prototype.item=function(e){var t={};t=l.GetData(e[0],"data");if(t!=null){return t}var i=e[0];if(i.tagName.toLowerCase()==="option"){t={id:e.val(),text:e.text(),disabled:e.prop("disabled"),selected:e.prop("selected"),title:e.prop("title")}}else if(i.tagName.toLowerCase()==="optgroup"){t={text:e.prop("label"),children:[],title:e.prop("title")};var n=e.children("option");var r=[];for(var s=0;s<n.length;s++){var o=c(n[s]);var a=this.item(o);r.push(a)}t.children=r}t=this._normalizeItem(t);t.element=e[0];l.StoreData(e[0],"data",t);return t};i.prototype._normalizeItem=function(e){if(e!==Object(e)){e={id:e,text:e}}e=c.extend({},{text:""},e);var t={selected:false,disabled:false};if(e.id!=null){e.id=e.id.toString()}if(e.text!=null){e.text=e.text.toString()}if(e._resultId==null&&e.id&&this.container!=null){e._resultId=this.generateResultId(this.container,e)}return c.extend({},t,e)};i.prototype.matches=function(e,t){var i=this.options.get("matcher");return i(e,t)};return i});t.define("select2/data/array",["./select","../utils","jquery"],function(e,t,f){function n(e,t){this._dataToConvert=t.get("data")||[];n.__super__.constructor.call(this,e,t)}t.Extend(n,e);n.prototype.bind=function(e,t){n.__super__.bind.call(this,e,t);this.addOptions(this.convertToOptions(this._dataToConvert))};n.prototype.select=function(i){var e=this.$element.find("option").filter(function(e,t){return t.value==i.id.toString()});if(e.length===0){e=this.option(i);this.addOptions(e)}n.__super__.select.call(this,i)};n.prototype.convertToOptions=function(e){var t=this;var i=this.$element.find("option");var n=i.map(function(){return t.item(f(this)).id}).get();var r=[];function s(e){return function(){return f(this).val()==e.id}}for(var o=0;o<e.length;o++){var a=this._normalizeItem(e[o]);if(n.indexOf(a.id)>=0){var l=i.filter(s(a));var c=this.item(l);var u=f.extend(true,{},a,c);var d=this.option(u);l.replaceWith(d);continue}var h=this.option(a);if(a.children){var p=this.convertToOptions(a.children);h.append(p)}r.push(h)}return r};return n});t.define("select2/data/ajax",["./array","../utils","jquery"],function(e,t,o){function i(e,t){this.ajaxOptions=this._applyDefaults(t.get("ajax"));if(this.ajaxOptions.processResults!=null){this.processResults=this.ajaxOptions.processResults}i.__super__.constructor.call(this,e,t)}t.Extend(i,e);i.prototype._applyDefaults=function(e){var t={data:function(e){return o.extend({},e,{q:e.term})},transport:function(e,t,i){var n=o.ajax(e);n.then(t);n.fail(i);return n}};return o.extend({},t,e,true)};i.prototype.processResults=function(e){return e};i.prototype.query=function(i,n){var e=[];var r=this;if(this._request!=null){if(typeof this._request.abort==="function"){this._request.abort()}this._request=null}var t=o.extend({type:"GET"},this.ajaxOptions);if(typeof t.url==="function"){t.url=t.url.call(this.$element,i)}if(typeof t.data==="function"){t.data=t.data.call(this.$element,i)}function s(){var e=t.transport(t,function(e){var t=r.processResults(e,i);if(r.options.get("debug")&&window.console&&console.error){if(!t||!t.results||!Array.isArray(t.results)){console.error("Select2: The AJAX results did not return an array in the "+"`results` key of the response.")}}n(t)},function(){if("status"in e&&(e.status===0||e.status==="0")){return}r.trigger("results:message",{message:"errorLoading"})});r._request=e}if(this.ajaxOptions.delay&&i.term!=null){if(this._queryTimeout){window.clearTimeout(this._queryTimeout)}this._queryTimeout=window.setTimeout(s,this.ajaxOptions.delay)}else{s()}};return i});t.define("select2/data/tags",["jquery"],function(i){function e(e,t,i){var n=i.get("tags");var r=i.get("createTag");if(r!==undefined){this.createTag=r}var s=i.get("insertTag");if(s!==undefined){this.insertTag=s}e.call(this,t,i);if(Array.isArray(n)){for(var o=0;o<n.length;o++){var a=n[o];var l=this._normalizeItem(a);var c=this.option(l);this.$element.append(c)}}}e.prototype.query=function(e,d,h){var p=this;this._removeOldTags();if(d.term==null||d.page!=null){e.call(this,d,h);return}function f(e,t){var i=e.results;for(var n=0;n<i.length;n++){var r=i[n];var s=r.children!=null&&!f({results:r.children},true);var o=(r.text||"").toUpperCase();var a=(d.term||"").toUpperCase();var l=o===a;if(l||s){if(t){return false}e.data=i;h(e);return}}if(t){return true}var c=p.createTag(d);if(c!=null){var u=p.option(c);u.attr("data-select2-tag","true");p.addOptions([u]);p.insertTag(i,c)}e.results=i;h(e)}e.call(this,d,f)};e.prototype.createTag=function(e,t){if(t.term==null){return null}var i=t.term.trim();if(i===""){return null}return{id:i,text:i}};e.prototype.insertTag=function(e,t,i){t.unshift(i)};e.prototype._removeOldTags=function(e){var t=this.$element.find("option[data-select2-tag]");t.each(function(){if(this.selected){return}i(this).remove()})};return e});t.define("select2/data/tokenizer",["jquery"],function(h){function e(e,t,i){var n=i.get("tokenizer");if(n!==undefined){this.tokenizer=n}e.call(this,t,i)}e.prototype.bind=function(e,t,i){e.call(this,t,i);this.$search=t.dropdown.$search||t.selection.$search||i.find(".select2-search__field")};e.prototype.query=function(e,t,i){var r=this;function n(e){var t=r._normalizeItem(e);var i=r.$element.find("option").filter(function(){return h(this).val()===t.id});if(!i.length){var n=r.option(t);n.attr("data-select2-tag",true);r._removeOldTags();r.addOptions([n])}s(t)}function s(e){r.trigger("select",{data:e})}t.term=t.term||"";var o=this.tokenizer(t,this.options,n);if(o.term!==t.term){if(this.$search.length){this.$search.val(o.term);this.$search.trigger("focus")}t.term=o.term}e.call(this,t,i)};e.prototype.tokenizer=function(e,t,i,n){var r=i.get("tokenSeparators")||[];var s=t.term;var o=0;var a=this.createTag||function(e){return{id:e.term,text:e.term}};while(o<s.length){var l=s[o];if(r.indexOf(l)===-1){o++;continue}var c=s.substr(0,o);var u=h.extend({},t,{term:c});var d=a(u);if(d==null){o++;continue}n(d);s=s.substr(o+1)||"";o=0}return{term:s}};return e});t.define("select2/data/minimumInputLength",[],function(){function e(e,t,i){this.minimumInputLength=i.get("minimumInputLength");e.call(this,t,i)}e.prototype.query=function(e,t,i){t.term=t.term||"";if(t.term.length<this.minimumInputLength){this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}});return}e.call(this,t,i)};return e});t.define("select2/data/maximumInputLength",[],function(){function e(e,t,i){this.maximumInputLength=i.get("maximumInputLength");e.call(this,t,i)}e.prototype.query=function(e,t,i){t.term=t.term||"";if(this.maximumInputLength>0&&t.term.length>this.maximumInputLength){this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}});return}e.call(this,t,i)};return e});t.define("select2/data/maximumSelectionLength",[],function(){function e(e,t,i){this.maximumSelectionLength=i.get("maximumSelectionLength");e.call(this,t,i)}e.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i);t.on("select",function(){n._checkIfMaximumSelected()})};e.prototype.query=function(e,t,i){var n=this;this._checkIfMaximumSelected(function(){e.call(n,t,i)})};e.prototype._checkIfMaximumSelected=function(e,i){var n=this;this.current(function(e){var t=e!=null?e.length:0;if(n.maximumSelectionLength>0&&t>=n.maximumSelectionLength){n.trigger("results:message",{message:"maximumSelected",args:{maximum:n.maximumSelectionLength}});return}if(i){i()}})};return e});t.define("select2/dropdown",["jquery","./utils"],function(t,e){function i(e,t){this.$element=e;this.options=t;i.__super__.constructor.call(this)}e.Extend(i,e.Observable);i.prototype.render=function(){var e=t('<span class="select2-dropdown">'+'<span class="select2-results"></span>'+"</span>");e.attr("dir",this.options.get("dir"));this.$dropdown=e;return e};i.prototype.bind=function(){};i.prototype.position=function(e,t){};i.prototype.destroy=function(){this.$dropdown.remove()};return i});t.define("select2/dropdown/search",["jquery"],function(s){function e(){}e.prototype.render=function(e){var t=e.call(this);var i=this.options.get("translations").get("search");var n=s('<span class="select2-search select2-search--dropdown">'+'<input class="select2-search__field" type="search" tabindex="-1"'+' autocorrect="off" autocapitalize="none"'+' spellcheck="false" role="searchbox" aria-autocomplete="list" />'+"</span>");this.$searchContainer=n;this.$search=n.find("input");this.$search.prop("autocomplete",this.options.get("autocomplete"));this.$search.attr("aria-label",i());t.prepend(n);return t};e.prototype.bind=function(e,t,i){var n=this;var r=t.id+"-results";e.call(this,t,i);this.$search.on("keydown",function(e){n.trigger("keypress",e);n._keyUpPrevented=e.isDefaultPrevented()});this.$search.on("input",function(e){s(this).off("keyup")});this.$search.on("keyup input",function(e){n.handleSearch(e)});t.on("open",function(){n.$search.attr("tabindex",0);n.$search.attr("aria-controls",r);n.$search.trigger("focus");window.setTimeout(function(){n.$search.trigger("focus")},0)});t.on("close",function(){n.$search.attr("tabindex",-1);n.$search.removeAttr("aria-controls");n.$search.removeAttr("aria-activedescendant");n.$search.val("");n.$search.trigger("blur")});t.on("focus",function(){if(!t.isOpen()){n.$search.trigger("focus")}});t.on("results:all",function(e){if(e.query.term==null||e.query.term===""){var t=n.showSearch(e);if(t){n.$searchContainer[0].classList.remove("select2-search--hide")}else{n.$searchContainer[0].classList.add("select2-search--hide")}}});t.on("results:focus",function(e){if(e.data._resultId){n.$search.attr("aria-activedescendant",e.data._resultId)}else{n.$search.removeAttr("aria-activedescendant")}})};e.prototype.handleSearch=function(e){if(!this._keyUpPrevented){var t=this.$search.val();this.trigger("query",{term:t})}this._keyUpPrevented=false};e.prototype.showSearch=function(e,t){return true};return e});t.define("select2/dropdown/hidePlaceholder",[],function(){function e(e,t,i,n){this.placeholder=this.normalizePlaceholder(i.get("placeholder"));e.call(this,t,i,n)}e.prototype.append=function(e,t){t.results=this.removePlaceholder(t.results);e.call(this,t)};e.prototype.normalizePlaceholder=function(e,t){if(typeof t==="string"){t={id:"",text:t}}return t};e.prototype.removePlaceholder=function(e,t){var i=t.slice(0);for(var n=t.length-1;n>=0;n--){var r=t[n];if(this.placeholder.id===r.id){i.splice(n,1)}}return i};return e});t.define("select2/dropdown/infiniteScroll",["jquery"],function(n){function e(e,t,i,n){this.lastParams={};e.call(this,t,i,n);this.$loadingMore=this.createLoadingMore();this.loading=false}e.prototype.append=function(e,t){this.$loadingMore.remove();this.loading=false;e.call(this,t);if(this.showLoadingMore(t)){this.$results.append(this.$loadingMore);this.loadMoreIfNeeded()}};e.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i);t.on("query",function(e){n.lastParams=e;n.loading=true});t.on("query:append",function(e){n.lastParams=e;n.loading=true});this.$results.on("scroll",this.loadMoreIfNeeded.bind(this))};e.prototype.loadMoreIfNeeded=function(){var e=n.contains(document.documentElement,this.$loadingMore[0]);if(this.loading||!e){return}var t=this.$results.offset().top+this.$results.outerHeight(false);var i=this.$loadingMore.offset().top+this.$loadingMore.outerHeight(false);if(t+50>=i){this.loadMore()}};e.prototype.loadMore=function(){this.loading=true;var e=n.extend({},{page:1},this.lastParams);e.page++;this.trigger("query:append",e)};e.prototype.showLoadingMore=function(e,t){return t.pagination&&t.pagination.more};e.prototype.createLoadingMore=function(){var e=n("<li "+'class="select2-results__option select2-results__option--load-more"'+'role="option" aria-disabled="true"></li>');var t=this.options.get("translations").get("loadingMore");e.html(t(this.lastParams));return e};return e});t.define("select2/dropdown/attachBody",["jquery","../utils"],function(p,a){function e(e,t,i){this.$dropdownParent=p(i.get("dropdownParent")||document.body);e.call(this,t,i)}e.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i);t.on("open",function(){n._showDropdown();n._attachPositioningHandler(t);n._bindContainerResultHandlers(t)});t.on("close",function(){n._hideDropdown();n._detachPositioningHandler(t)});this.$dropdownContainer.on("mousedown",function(e){e.stopPropagation()})};e.prototype.destroy=function(e){e.call(this);this.$dropdownContainer.remove()};e.prototype.position=function(e,t,i){t.attr("class",i.attr("class"));t[0].classList.remove("select2");t[0].classList.add("select2-container--open");t.css({position:"absolute",top:-999999});this.$container=i};e.prototype.render=function(e){var t=p("<span></span>");var i=e.call(this);t.append(i);this.$dropdownContainer=t;return t};e.prototype._hideDropdown=function(e){this.$dropdownContainer.detach()};e.prototype._bindContainerResultHandlers=function(e,t){if(this._containerResultsHandlersBound){return}var i=this;t.on("results:all",function(){i._positionDropdown();i._resizeDropdown()});t.on("results:append",function(){i._positionDropdown();i._resizeDropdown()});t.on("results:message",function(){i._positionDropdown();i._resizeDropdown()});t.on("select",function(){i._positionDropdown();i._resizeDropdown()});t.on("unselect",function(){i._positionDropdown();i._resizeDropdown()});this._containerResultsHandlersBound=true};e.prototype._attachPositioningHandler=function(e,t){var i=this;var n="scroll.select2."+t.id;var r="resize.select2."+t.id;var s="orientationchange.select2."+t.id;var o=this.$container.parents().filter(a.hasScroll);o.each(function(){a.StoreData(this,"select2-scroll-position",{x:p(this).scrollLeft(),y:p(this).scrollTop()})});o.on(n,function(e){var t=a.GetData(this,"select2-scroll-position");p(this).scrollTop(t.y)});p(window).on(n+" "+r+" "+s,function(e){i._positionDropdown();i._resizeDropdown()})};e.prototype._detachPositioningHandler=function(e,t){var i="scroll.select2."+t.id;var n="resize.select2."+t.id;var r="orientationchange.select2."+t.id;var s=this.$container.parents().filter(a.hasScroll);s.off(i);p(window).off(i+" "+n+" "+r)};e.prototype._positionDropdown=function(){var e=p(window);var t=this.$dropdown[0].classList.contains("select2-dropdown--above");var i=this.$dropdown[0].classList.contains("select2-dropdown--below");var n=null;var r=this.$container.offset();r.bottom=r.top+this.$container.outerHeight(false);var s={height:this.$container.outerHeight(false)};s.top=r.top;s.bottom=r.top+s.height;var o={height:this.$dropdown.outerHeight(false)};var a={top:e.scrollTop(),bottom:e.scrollTop()+e.height()};var l=a.top<r.top-o.height;var c=a.bottom>r.bottom+o.height;var u={left:r.left,top:s.bottom};var d=this.$dropdownParent;if(d.css("position")==="static"){d=d.offsetParent()}var h={top:0,left:0};if(p.contains(document.body,d[0])||d[0].isConnected){h=d.offset()}u.top-=h.top;u.left-=h.left;if(!t&&!i){n="below"}if(!c&&l&&!t){n="above"}else if(!l&&c&&t){n="below"}if(n=="above"||t&&n!=="below"){u.top=s.top-h.top-o.height}if(n!=null){this.$dropdown[0].classList.remove("select2-dropdown--below");this.$dropdown[0].classList.remove("select2-dropdown--above");this.$dropdown[0].classList.add("select2-dropdown--"+n);this.$container[0].classList.remove("select2-container--below");this.$container[0].classList.remove("select2-container--above");this.$container[0].classList.add("select2-container--"+n)}this.$dropdownContainer.css(u)};e.prototype._resizeDropdown=function(){var e={width:this.$container.outerWidth(false)+"px"};if(this.options.get("dropdownAutoWidth")){e.minWidth=e.width;e.position="relative";e.width="auto"}this.$dropdown.css(e)};e.prototype._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent);this._positionDropdown();this._resizeDropdown()};return e});t.define("select2/dropdown/minimumResultsForSearch",[],function(){function r(e){var t=0;for(var i=0;i<e.length;i++){var n=e[i];if(n.children){t+=r(n.children)}else{t++}}return t}function e(e,t,i,n){this.minimumResultsForSearch=i.get("minimumResultsForSearch");if(this.minimumResultsForSearch<0){this.minimumResultsForSearch=Infinity}e.call(this,t,i,n)}e.prototype.showSearch=function(e,t){if(r(t.data.results)<this.minimumResultsForSearch){return false}return e.call(this,t)};return e});t.define("select2/dropdown/selectOnClose",["../utils"],function(s){function e(){}e.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i);t.on("close",function(e){n._handleSelectOnClose(e)})};e.prototype._handleSelectOnClose=function(e,t){if(t&&t.originalSelect2Event!=null){var i=t.originalSelect2Event;if(i._type==="select"||i._type==="unselect"){return}}var n=this.getHighlightedResults();if(n.length<1){return}var r=s.GetData(n[0],"data");if(r.element!=null&&r.element.selected||r.element==null&&r.selected){return}this.trigger("select",{data:r})};return e});t.define("select2/dropdown/closeOnSelect",[],function(){function e(){}e.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i);t.on("select",function(e){n._selectTriggered(e)});t.on("unselect",function(e){n._selectTriggered(e)})};e.prototype._selectTriggered=function(e,t){var i=t.originalEvent;if(i&&(i.ctrlKey||i.metaKey)){return}this.trigger("close",{originalEvent:i,originalSelect2Event:t})};return e});t.define("select2/dropdown/dropdownCss",["../utils"],function(n){function e(){}e.prototype.render=function(e){var t=e.call(this);var i=this.options.get("dropdownCssClass")||"";if(i.indexOf(":all:")!==-1){i=i.replace(":all:","");n.copyNonInternalCssClasses(t[0],this.$element[0])}t.addClass(i);return t};return e});t.define("select2/dropdown/tagsSearchHighlight",["../utils"],function(s){function e(){}e.prototype.highlightFirstItem=function(e){var t=this.$results.find(".select2-results__option--selectable"+":not(.select2-results__option--selected)");if(t.length>0){var i=t.first();var n=s.GetData(i[0],"data");var r=n.element;if(r&&r.getAttribute){if(r.getAttribute("data-select2-tag")==="true"){i.trigger("mouseenter");return}}}e.call(this)};return e});t.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum;var i="Please delete "+t+" character";if(t!=1){i+="s"}return i},inputTooShort:function(e){var t=e.minimum-e.input.length;var i="Please enter "+t+" or more characters";return i},loadingMore:function(){return"Loading more results‚Ä¶"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";if(e.maximum!=1){t+="s"}return t},noResults:function(){return"No results found"},searching:function(){return"Searching‚Ä¶"},removeAllItems:function(){return"Remove all items"},removeItem:function(){return"Remove item"},search:function(){return"Search"}}});t.define("select2/defaults",["jquery","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/selectionCss","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./dropdown/dropdownCss","./dropdown/tagsSearchHighlight","./i18n/en"],function(u,s,o,a,l,c,d,h,p,f,g,i,m,v,y,b,C,w,_,A,E,S,T,x,D,R,M,N,O,I,e){function t(){this.reset()}t.prototype.apply=function(e){e=u.extend(true,{},this.defaults,e);if(e.dataAdapter==null){if(e.ajax!=null){e.dataAdapter=y}else if(e.data!=null){e.dataAdapter=v}else{e.dataAdapter=m}if(e.minimumInputLength>0){e.dataAdapter=f.Decorate(e.dataAdapter,w)}if(e.maximumInputLength>0){e.dataAdapter=f.Decorate(e.dataAdapter,_)}if(e.maximumSelectionLength>0){e.dataAdapter=f.Decorate(e.dataAdapter,A)}if(e.tags){e.dataAdapter=f.Decorate(e.dataAdapter,b)}if(e.tokenSeparators!=null||e.tokenizer!=null){e.dataAdapter=f.Decorate(e.dataAdapter,C)}}if(e.resultsAdapter==null){e.resultsAdapter=s;if(e.ajax!=null){e.resultsAdapter=f.Decorate(e.resultsAdapter,x)}if(e.placeholder!=null){e.resultsAdapter=f.Decorate(e.resultsAdapter,T)}if(e.selectOnClose){e.resultsAdapter=f.Decorate(e.resultsAdapter,M)}if(e.tags){e.resultsAdapter=f.Decorate(e.resultsAdapter,I)}}if(e.dropdownAdapter==null){if(e.multiple){e.dropdownAdapter=E}else{var t=f.Decorate(E,S);e.dropdownAdapter=t}if(e.minimumResultsForSearch!==0){e.dropdownAdapter=f.Decorate(e.dropdownAdapter,R)}if(e.closeOnSelect){e.dropdownAdapter=f.Decorate(e.dropdownAdapter,N)}if(e.dropdownCssClass!=null){e.dropdownAdapter=f.Decorate(e.dropdownAdapter,O)}e.dropdownAdapter=f.Decorate(e.dropdownAdapter,D)}if(e.selectionAdapter==null){if(e.multiple){e.selectionAdapter=a}else{e.selectionAdapter=o}if(e.placeholder!=null){e.selectionAdapter=f.Decorate(e.selectionAdapter,l)}if(e.allowClear){e.selectionAdapter=f.Decorate(e.selectionAdapter,c)}if(e.multiple){e.selectionAdapter=f.Decorate(e.selectionAdapter,d)}if(e.selectionCssClass!=null){e.selectionAdapter=f.Decorate(e.selectionAdapter,h)}e.selectionAdapter=f.Decorate(e.selectionAdapter,p)}e.language=this._resolveLanguage(e.language);e.language.push("en");var i=[];for(var n=0;n<e.language.length;n++){var r=e.language[n];if(i.indexOf(r)===-1){i.push(r)}}e.language=i;e.translations=this._processTranslations(e.language,e.debug);return e};t.prototype.reset=function(){function l(e){function t(e){return i[e]||e}return e.replace(/[^\u0000-\u007E]/g,t)}function c(e,t){if(e.term==null||e.term.trim()===""){return t}if(t.children&&t.children.length>0){var i=u.extend(true,{},t);for(var n=t.children.length-1;n>=0;n--){var r=t.children[n];var s=c(e,r);if(s==null){i.children.splice(n,1)}}if(i.children.length>0){return i}return c(e,i)}var o=l(t.text).toUpperCase();var a=l(e.term).toUpperCase();if(o.indexOf(a)>-1){return t}return null}this.defaults={amdLanguageBase:"./i18n/",autocomplete:"off",closeOnSelect:true,debug:false,dropdownAutoWidth:false,escapeMarkup:f.escapeMarkup,language:{},matcher:c,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:false,scrollAfterSelect:false,sorter:function(e){return e},templateResult:function(e){return e.text},templateSelection:function(e){return e.text},theme:"default",width:"resolve"}};t.prototype.applyFromElement=function(e,t){var i=e.language;var n=this.defaults.language;var r=t.prop("lang");var s=t.closest("[lang]").prop("lang");var o=Array.prototype.concat.call(this._resolveLanguage(r),this._resolveLanguage(i),this._resolveLanguage(n),this._resolveLanguage(s));e.language=o;return e};t.prototype._resolveLanguage=function(e){if(!e){return[]}if(u.isEmptyObject(e)){return[]}if(u.isPlainObject(e)){return[e]}var t;if(!Array.isArray(e)){t=[e]}else{t=e}var i=[];for(var n=0;n<t.length;n++){i.push(t[n]);if(typeof t[n]==="string"&&t[n].indexOf("-")>0){var r=t[n].split("-");var s=r[0];i.push(s)}}return i};t.prototype._processTranslations=function(e,t){var i=new g;for(var n=0;n<e.length;n++){var r=new g;var s=e[n];if(typeof s==="string"){try{r=g.loadPath(s)}catch(e){try{s=this.defaults.amdLanguageBase+s;r=g.loadPath(s)}catch(e){if(t&&window.console&&console.warn){console.warn('Select2: The language file for "'+s+'" could '+"not be automatically loaded. A fallback will be used instead.")}}}}else if(u.isPlainObject(s)){r=new g(s)}else{r=s}i.extend(r)}return i};t.prototype.set=function(e,t){var i=u.camelCase(e);var n={};n[i]=t;var r=f._convertData(n);u.extend(true,this.defaults,r)};var n=new t;return n});t.define("select2/options",["jquery","./defaults","./utils"],function(h,i,p){function e(e,t){this.options=e;if(t!=null){this.fromElement(t)}if(t!=null){this.options=i.applyFromElement(this.options,t)}this.options=i.apply(this.options)}e.prototype.fromElement=function(e){var t=["select2"];if(this.options.multiple==null){this.options.multiple=e.prop("multiple")}if(this.options.disabled==null){this.options.disabled=e.prop("disabled")}if(this.options.autocomplete==null&&e.prop("autocomplete")){this.options.autocomplete=e.prop("autocomplete")}if(this.options.dir==null){if(e.prop("dir")){this.options.dir=e.prop("dir")}else if(e.closest("[dir]").prop("dir")){this.options.dir=e.closest("[dir]").prop("dir")}else{this.options.dir="ltr"}}e.prop("disabled",this.options.disabled);e.prop("multiple",this.options.multiple);if(p.GetData(e[0],"select2Tags")){if(this.options.debug&&window.console&&console.warn){console.warn("Select2: The `data-select2-tags` attribute has been changed to "+'use the `data-data` and `data-tags="true"` attributes and will be '+"removed in future versions of Select2.")}p.StoreData(e[0],"data",p.GetData(e[0],"select2Tags"));p.StoreData(e[0],"tags",true)}if(p.GetData(e[0],"ajaxUrl")){if(this.options.debug&&window.console&&console.warn){console.warn("Select2: The `data-ajax-url` attribute has been changed to "+"`data-ajax--url` and support for the old attribute will be removed"+" in future versions of Select2.")}e.attr("ajax--url",p.GetData(e[0],"ajaxUrl"));p.StoreData(e[0],"ajax-Url",p.GetData(e[0],"ajaxUrl"))}var i={};function n(e,t){return t.toUpperCase()}for(var r=0;r<e[0].attributes.length;r++){var s=e[0].attributes[r].name;var o="data-";if(s.substr(0,o.length)==o){var a=s.substring(o.length);var l=p.GetData(e[0],a);var c=a.replace(/-([a-z])/g,n);i[c]=l}}if(h.fn.jquery&&h.fn.jquery.substr(0,2)=="1."&&e[0].dataset){i=h.extend(true,{},e[0].dataset,i)}var u=h.extend(true,{},p.GetData(e[0]),i);u=p._convertData(u);for(var d in u){if(t.indexOf(d)>-1){continue}if(h.isPlainObject(this.options[d])){h.extend(this.options[d],u[d])}else{this.options[d]=u[d]}}return this};e.prototype.get=function(e){return this.options[e]};e.prototype.set=function(e,t){this.options[e]=t};return e});t.define("select2/core",["jquery","./options","./utils","./keys"],function(t,c,u,n){var d=function(e,t){if(u.GetData(e[0],"select2")!=null){u.GetData(e[0],"select2").destroy()}this.$element=e;this.id=this._generateId(e);t=t||{};this.options=new c(t,e);d.__super__.constructor.call(this);var i=e.attr("tabindex")||0;u.StoreData(e[0],"old-tabindex",i);e.attr("tabindex","-1");var n=this.options.get("dataAdapter");this.dataAdapter=new n(e,this.options);var r=this.render();this._placeContainer(r);var s=this.options.get("selectionAdapter");this.selection=new s(e,this.options);this.$selection=this.selection.render();this.selection.position(this.$selection,r);var o=this.options.get("dropdownAdapter");this.dropdown=new o(e,this.options);this.$dropdown=this.dropdown.render();this.dropdown.position(this.$dropdown,r);var a=this.options.get("resultsAdapter");this.results=new a(e,this.options,this.dataAdapter);this.$results=this.results.render();this.results.position(this.$results,this.$dropdown);var l=this;this._bindAdapters();this._registerDomEvents();this._registerDataEvents();this._registerSelectionEvents();this._registerDropdownEvents();this._registerResultsEvents();this._registerEvents();this.dataAdapter.current(function(e){l.trigger("selection:update",{data:e})});e[0].classList.add("select2-hidden-accessible");e.attr("aria-hidden","true");this._syncAttributes();u.StoreData(e[0],"select2",this);e.data("select2",this)};u.Extend(d,u.Observable);d.prototype._generateId=function(e){var t="";if(e.attr("id")!=null){t=e.attr("id")}else if(e.attr("name")!=null){t=e.attr("name")+"-"+u.generateChars(2)}else{t=u.generateChars(4)}t=t.replace(/(:|\.|\[|\]|,)/g,"");t="select2-"+t;return t};d.prototype._placeContainer=function(e){e.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));if(t!=null){e.css("width",t)}};d.prototype._resolveWidth=function(e,t){var i=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if(t=="resolve"){var n=this._resolveWidth(e,"style");if(n!=null){return n}return this._resolveWidth(e,"element")}if(t=="element"){var r=e.outerWidth(false);if(r<=0){return"auto"}return r+"px"}if(t=="style"){var s=e.attr("style");if(typeof s!=="string"){return null}var o=s.split(";");for(var a=0,l=o.length;a<l;a=a+1){var c=o[a].replace(/\s/g,"");var u=c.match(i);if(u!==null&&u.length>=1){return u[1]}}return null}if(t=="computedstyle"){var d=window.getComputedStyle(e[0]);return d.width}return t};d.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container);this.selection.bind(this,this.$container);this.dropdown.bind(this,this.$container);this.results.bind(this,this.$container)};d.prototype._registerDomEvents=function(){var t=this;this.$element.on("change.select2",function(){t.dataAdapter.current(function(e){t.trigger("selection:update",{data:e})})});this.$element.on("focus.select2",function(e){t.trigger("focus",e)});this._syncA=u.bind(this._syncAttributes,this);this._syncS=u.bind(this._syncSubtree,this);this._observer=new window.MutationObserver(function(e){t._syncA();t._syncS(e)});this._observer.observe(this.$element[0],{attributes:true,childList:true,subtree:false})};d.prototype._registerDataEvents=function(){var i=this;this.dataAdapter.on("*",function(e,t){i.trigger(e,t)})};d.prototype._registerSelectionEvents=function(){var i=this;var n=["toggle","focus"];this.selection.on("toggle",function(){i.toggleDropdown()});this.selection.on("focus",function(e){i.focus(e)});this.selection.on("*",function(e,t){if(n.indexOf(e)!==-1){return}i.trigger(e,t)})};d.prototype._registerDropdownEvents=function(){var i=this;this.dropdown.on("*",function(e,t){i.trigger(e,t)})};d.prototype._registerResultsEvents=function(){var i=this;this.results.on("*",function(e,t){i.trigger(e,t)})};d.prototype._registerEvents=function(){var i=this;this.on("open",function(){i.$container[0].classList.add("select2-container--open")});this.on("close",function(){i.$container[0].classList.remove("select2-container--open")});this.on("enable",function(){i.$container[0].classList.remove("select2-container--disabled")});this.on("disable",function(){i.$container[0].classList.add("select2-container--disabled")});this.on("blur",function(){i.$container[0].classList.remove("select2-container--focus")});this.on("query",function(t){if(!i.isOpen()){i.trigger("open",{})}this.dataAdapter.query(t,function(e){i.trigger("results:all",{data:e,query:t})})});this.on("query:append",function(t){this.dataAdapter.query(t,function(e){i.trigger("results:append",{data:e,query:t})})});this.on("keypress",function(e){var t=e.which;if(i.isOpen()){if(t===n.ESC||t===n.UP&&e.altKey){i.close(e);e.preventDefault()}else if(t===n.ENTER||t===n.TAB){i.trigger("results:select",{});e.preventDefault()}else if(t===n.SPACE&&e.ctrlKey){i.trigger("results:toggle",{});e.preventDefault()}else if(t===n.UP){i.trigger("results:previous",{});e.preventDefault()}else if(t===n.DOWN){i.trigger("results:next",{});e.preventDefault()}}else{if(t===n.ENTER||t===n.SPACE||t===n.DOWN&&e.altKey){i.open();e.preventDefault()}}})};d.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled"));if(this.isDisabled()){if(this.isOpen()){this.close()}this.trigger("disable",{})}else{this.trigger("enable",{})}};d.prototype._isChangeMutation=function(e){var t=this;if(e.addedNodes&&e.addedNodes.length>0){for(var i=0;i<e.addedNodes.length;i++){var n=e.addedNodes[i];if(n.selected){return true}}}else if(e.removedNodes&&e.removedNodes.length>0){return true}else if(Array.isArray(e)){return e.some(function(e){return t._isChangeMutation(e)})}return false};d.prototype._syncSubtree=function(e){var t=this._isChangeMutation(e);var i=this;if(t){this.dataAdapter.current(function(e){i.trigger("selection:update",{data:e})})}};d.prototype.trigger=function(e,t){var i=d.__super__.trigger;var n={open:"opening",close:"closing",select:"selecting",unselect:"unselecting",clear:"clearing"};if(t===undefined){t={}}if(e in n){var r=n[e];var s={prevented:false,name:e,args:t};i.call(this,r,s);if(s.prevented){t.prevented=true;return}}i.call(this,e,t)};d.prototype.toggleDropdown=function(){if(this.isDisabled()){return}if(this.isOpen()){this.close()}else{this.open()}};d.prototype.open=function(){if(this.isOpen()){return}if(this.isDisabled()){return}this.trigger("query",{})};d.prototype.close=function(e){if(!this.isOpen()){return}this.trigger("close",{originalEvent:e})};d.prototype.isEnabled=function(){return!this.isDisabled()};d.prototype.isDisabled=function(){return this.options.get("disabled")};d.prototype.isOpen=function(){return this.$container[0].classList.contains("select2-container--open")};d.prototype.hasFocus=function(){return this.$container[0].classList.contains("select2-container--focus")};d.prototype.focus=function(e){if(this.hasFocus()){return}this.$container[0].classList.add("select2-container--focus");this.trigger("focus",{})};d.prototype.enable=function(e){if(this.options.get("debug")&&window.console&&console.warn){console.warn('Select2: The `select2("enable")` method has been deprecated and will'+' be removed in later Select2 versions. Use $element.prop("disabled")'+" instead.")}if(e==null||e.length===0){e=[true]}var t=!e[0];this.$element.prop("disabled",t)};d.prototype.data=function(){if(this.options.get("debug")&&arguments.length>0&&window.console&&console.warn){console.warn('Select2: Data can no longer be set using `select2("data")`. You '+"should consider setting the value instead using `$element.val()`.")}var t=[];this.dataAdapter.current(function(e){t=e});return t};d.prototype.val=function(e){if(this.options.get("debug")&&window.console&&console.warn){console.warn('Select2: The `select2("val")` method has been deprecated and will be'+" removed in later Select2 versions. Use $element.val() instead.")}if(e==null||e.length===0){return this.$element.val()}var t=e[0];if(Array.isArray(t)){t=t.map(function(e){return e.toString()})}this.$element.val(t).trigger("input").trigger("change")};d.prototype.destroy=function(){u.RemoveData(this.$container[0]);this.$container.remove();this._observer.disconnect();this._observer=null;this._syncA=null;this._syncS=null;this.$element.off(".select2");this.$element.attr("tabindex",u.GetData(this.$element[0],"old-tabindex"));this.$element[0].classList.remove("select2-hidden-accessible");this.$element.attr("aria-hidden","false");u.RemoveData(this.$element[0]);this.$element.removeData("select2");this.dataAdapter.destroy();this.selection.destroy();this.dropdown.destroy();this.results.destroy();this.dataAdapter=null;this.selection=null;this.dropdown=null;this.results=null};d.prototype.render=function(){var e=t('<span class="select2 select2-container">'+'<span class="selection"></span>'+'<span class="dropdown-wrapper" aria-hidden="true"></span>'+"</span>");e.attr("dir",this.options.get("dir"));this.$container=e;this.$container[0].classList.add("select2-container--"+this.options.get("theme"));u.StoreData(e[0],"element",this.$element);return e};return d});t.define("jquery-mousewheel",["jquery"],function(e){return e});t.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults","./select2/utils"],function(r,e,s,t,o){if(r.fn.select2==null){var a=["open","close","destroy"];r.fn.select2=function(i){i=i||{};if(typeof i==="object"){this.each(function(){var e=r.extend(true,{},i);var t=new s(r(this),e)});return this}else if(typeof i==="string"){var t;var n=Array.prototype.slice.call(arguments,1);this.each(function(){var e=o.GetData(this,"select2");if(e==null&&window.console&&console.error){console.error("The select2('"+i+"') method was called on an "+"element that is not using Select2.")}t=e[i].apply(e,n)});if(a.indexOf(i)>-1){return this}return t}else{throw new Error("Invalid arguments for Select2: "+i)}}}if(r.fn.select2.defaults==null){r.fn.select2.defaults=t}return s});return{define:t.define,require:t.require}}();var t=e.require("jquery.select2");i.fn.select2.amd=e;return t});(function(p){p.fn.select2ToTree=function(e){var s=p.extend({},e);if(s.treeData){t(s.treeData,this)}s._templateResult=s.templateResult;s.templateResult=function(e,t){var i=e.text;if(typeof s._templateResult==="function"){i=s._templateResult(e,t)}var n=p("<span class='item-label'></span>").append(i);if(e.element){var r=e.element;t.setAttribute("data-val",r.value);if(r.className)t.className+=" "+r.className;if(r.getAttribute("data-pup")){t.setAttribute("data-pup",r.getAttribute("data-pup"))}if(p(t).hasClass("non-leaf")){return p.merge(p('<span class="expand-collapse" onmouseup="expColMouseupHandler(event);"></span>'),n)}}return n};window.expColMouseupHandler=function(e){i(e.target||e.srcElement);e.stopPropagation?e.stopPropagation():e.cancelBubble=true;e.preventDefault?e.preventDefault():e.returnValue=false};var n=this.select2(s);n.on("select2:open",function(e){var t=n.data("select2");t.$dropdown.addClass("s2-to-tree");t.$dropdown.removeClass("searching-result");var i=t.$dropdown.find(".select2-search__field").add(t.$container.find(".select2-search__field"));i.off("input",r);i.on("input",r)});function r(e){var t=n.data("select2");if(p(this).val().trim().length>0){t.$dropdown.addClass("searching-result")}else{t.$dropdown.removeClass("searching-result")}}return n};function t(c,u){function d(e,t){var i=e;for(var n=0;n<t.length;n++){var r=t[n];if(i[r]){i=i[r];continue}return"MISSING"}return i}function h(e,t,i){var n;if(c.labelFld&&c.labelFld.split(".").length>1){n=c.labelFld.split(".")}var r;if(c.valFld&&c.valFld.split(".").length>1){r=c.valFld.split(".")}for(var s=0;s<e.length;s++){var o=e[s]||{};var a=p("<option></option>");if(n){a.text(d(o,n))}else{a.text(o[c.labelFld||"text"])}if(r){a.val(d(o,r))}else{a.val(o[c.valFld||"id"])}if(o[c.selFld||"selected"]&&String(o[c.selFld||"selected"])==="true"){a.prop("selected",o[c.selFld||"selected"])}if(a.val()===""){a.prop("disabled",true);a.val(f())}a.addClass("l"+t);if(i)a.attr("data-pup",i);u.append(a);var l=o[c.incFld||"inc"];if(l&&l.length>0){a.addClass("non-leaf");h(l,t+1,a.val())}}}h(c.dataArr,1,"");if(c.dftVal)u.val(c.dftVal)}var e=1;function f(){return"autoUniqueVal_"+e++}function i(e){p(e.parentNode).toggleClass("opened");a(e.parentNode)}function a(e){var t=e;var i=p(e).parent(".select2-results__options");var n=true;do{var r=(p(t).attr("data-pup")||"").replace(/'/g,"\\'");t=null;if(r){var s=i.find(".select2-results__option[data-val='"+r+"']");if(s.length>0){if(!s.eq(0).hasClass("opened")){p(e).removeClass("showme");n=false;break}t=s[0]}}}while(t);if(n)p(e).addClass("showme");var o=(p(e).attr("data-val")||"").replace(/'/g,"\\'");i.find(".select2-results__option[data-pup='"+o+"']").each(function(){a(this)})}})(jQuery);var EndlessScroll;EndlessScroll=function(){var n;e.name="EndlessScroll";n={bottomPixels:50,fireOnce:true,fireDelay:150,loader:"Loading...",content:"",insertAfter:"div:last",intervalFrequency:250,resetCounter:function(){return false},callback:function(){return true},ceaseFire:function(){return false}};function e(e,t){var i=this;this.options=$.extend({},n,t);this.firing=true;this.fired=false;this.fireSequence=0;this.didScroll=false;this.isScrollable=true;this.target=e;this.targetId="";this.content="";this.innerWrap=$(".endless_scroll_inner_wrap",this.target);if(this.options.data){this.options.content=this.options.data}$(e).scroll(function(){i.didScroll=true;i.target=e;return i.targetId=$(i.target).attr("id")})}e.prototype.run=function(){var e=this;return setInterval(function(){if(e.shouldTryFiring()){e.didScroll=false;if(e.ceaseFireWhenNecessary()){return}if(e.shouldBeFiring()){e.resetFireSequenceWhenNecessary();e.acknowledgeFiring();e.insertLoader();if(e.hasContent()){e.showContent();e.fireCallback();e.delayFireingWhenNecessary()}return e.removeLoader()}}},this.options.intervalFrequency)};e.prototype.shouldTryFiring=function(){return this.didScroll&&this.firing===true};e.prototype.ceaseFireWhenNecessary=function(){if(this.options.ceaseFire.apply(this.target,[this.fireSequence])){this.firing=false;return true}else{return false}};e.prototype.wrapContainer=function(){if(this.innerWrap.length===0){return this.innerWrap=$(this.target).wrapInner('<div class="endless_scroll_inner_wrap" />').find(".endless_scroll_inner_wrap")}};e.prototype.isScrollableOrNot=function(){if(this.target===document||this.target===window){return this.isScrollable=$(document).height()-$(window).height()<=$(window).scrollTop()+this.options.bottomPixels}else{this.wrapContainer();return this.isScrollable=this.innerWrap.length>0&&this.innerWrap.height()-$(this.target).height()<=$(this.target).scrollTop()+this.options.bottomPixels}};e.prototype.shouldBeFiring=function(){this.isScrollableOrNot();return this.isScrollable&&(this.options.fireOnce===false||this.options.fireOnce===true&&this.fired!==true)};e.prototype.resetFireSequenceWhenNecessary=function(){if(this.options.resetCounter.apply(this.target)===true){return this.fireSequence=0}};e.prototype.acknowledgeFiring=function(){this.fired=true;return this.fireSequence++};e.prototype.insertLoader=function(){return $(this.options.insertAfter).after('<div class="endless_scroll_loader_'+this.targetId+' endless_scroll_loader">'+this.options.loader+"</div>")};e.prototype.removeLoader=function(){return $(".endless_scroll_loader_"+this.targetId).fadeOut(function(){return $(this).remove()})};e.prototype.hasContent=function(){if(typeof this.options.content==="function"){this.content=this.options.content.apply(this.target,[this.fireSequence])}else{this.content=this.options.content}return this.content!==false};e.prototype.showContent=function(){$(this.options.insertAfter).after('<div id="endless_scroll_content">'+this.content+"</div>");return $("#endless_scroll_content").hide().fadeIn(250,function(){return $(this).removeAttr("id")})};e.prototype.fireCallback=function(){return this.options.callback.apply(this.target,[this.fireSequence])};e.prototype.delayFireingWhenNecessary=function(){var e=this;if(this.options.fireDelay>0){$("body").after('<div id="endless_scroll_marker"></div>');return $("#endless_scroll_marker").fadeTo(this.options.fireDelay,1,function(){$("#endless_scroll_marker").remove();return e.fired=false})}else{return this.fired=false}};return e}();(function(e){return e.fn.endlessScroll=function(e){return new EndlessScroll(this,e).run()}})(jQuery);(function(c){var n=[];var e="dirty";var i="clean";var u="dirtyInitialValue";var l="isDirty";var r=function(t){var i;n.forEach(function(e){if(e.id===t){i=e}});return i};const s=function(t){n=n.filter(function(e){return e!==t});t.isDirty=false};var t=function(t){t.form.on("submit",function(){t.submitting=true});if(t.options.preventLeaving){c(window).on("beforeunload",function(e){if(t.isDirty&&!t.submitting){e.preventDefault();return t.options.leavingMessage}})}};var o=function(t){t.form.find("input, select, textarea").on("change.dirty click.dirty keyup.dirty keydown.dirty blur.dirty",function(e){t.checkValues(e)});t.form.on("dirty",function(){t.options.onDirty()});t.form.on("clean",function(){t.options.onClean()})};var a=function(e){e.form.find("input, select, textarea").off("change.dirty click.dirty keyup.dirty keydown.dirty blur.dirty");e.form.off("dirty");e.form.off("clean")};var d=function(e,t){this.form=e;this.isDirty=false;this.options=t;this.history=[i,i];this.id=c(e).attr("id");n.push(this)};d.prototype={init:function(){this.saveInitialValues();this.setEvents()},statuses:{dirty:e,clean:i,dataInitialValue:u,dataIsDirty:l},isRadioOrCheckbox:function(e){return c(e).is(":radio, :checkbox")},isFileInput:function(e){return c(e).is(":file")},saveInitialValues:function(){var s=this;this.form.find("input, select, textarea").each(function(e,t){var i=s.isRadioOrCheckbox(t);var n=s.isFileInput(t);if(i){var r=c(t).is(":checked")?"checked":"unchecked";c(t).data(u,r)}else if(n){c(t).data(u,JSON.stringify(t.files))}else{c(t).data(u,c(t).val()||"")}})},refreshEvents:function(){var e=this;a(e);o(e)},showDirtyFields:function(){var e=this;return e.form.find("input, select, textarea").filter(function(e,t){return c(t).data(l)})},setEvents:function(){var e=this;t(e);o(e)},isFieldDirty:function(e){var t=e.data(u);if(t==null){t=""}var i=e.val();if(i==null){i=""}var n=/^(true|false)$/i;var r=n.test(t)&&n.test(i);if(r){var s=new RegExp("^"+t+"$","i");return!s.test(i)}return i!==t},isFileInputDirty:function(e){var t=e.data(u);var i=e[0];var n=JSON.stringify(i.files);return n!==t},isCheckboxDirty:function(e){var t=e.data(u);var i=e.is(":checked")?"checked":"unchecked";return t!==i},checkValues:function(e){var o=this;var a=false;this.form.find("input, select, textarea").each(function(e,t){var i=o.isRadioOrCheckbox(t);var n=o.isFileInput(t);var r=c(t);var s;if(i){s=o.isCheckboxDirty(r)}else if(n){s=o.isFileInputDirty(r)}else{s=o.isFieldDirty(r)}r.data(l,s);a|=s});if(a){o.setDirty()}else{o.setClean()}},setDirty:function(){this.isDirty=true;this.history[0]=this.history[1];this.history[1]=e;if(this.options.fireEventsOnEachChange||this.wasJustClean()){this.form.trigger("dirty")}},setClean:function(){this.isDirty=false;this.history[0]=this.history[1];this.history[1]=i;if(this.options.fireEventsOnEachChange||this.wasJustDirty()){this.form.trigger("clean")}},wasJustDirty:function(){return this.history[0]===e},wasJustClean:function(){return this.history[0]===i},setAsClean:function(){this.saveInitialValues();this.setClean()},setAsDirty:function(){this.saveInitialValues();this.setDirty()},resetForm:function(){var l=this;this.form.find("input, select, textarea").each(function(e,t){var i=c(t);var n=l.isRadioOrCheckbox(t);var r=l.isFileInput(t);if(n){var s=i.data(u);var o=s==="checked";i.prop("checked",o)}if(r){t.value="";c(t).data(u,JSON.stringify(t.files))}else{var a=i.data(u);i.val(a)}});this.checkValues()}};c.fn.dirty=function(n){if(typeof n==="string"){var e=r(c(this).attr("id"));if(!e){return null}if(/^(isDirty|isClean|refreshEvents|resetForm|setAsClean|setAsDirty|showDirtyFields|destroy)$/i.test(n)){var t=n.toLowerCase();switch(t){case"isclean":return!e.isDirty;case"isdirty":return e.isDirty;case"refreshevents":return e.refreshEvents();case"resetform":return e.resetForm();case"setasclean":return e.setAsClean();case"setasdirty":return e.setAsDirty();case"showdirtyfields":return e.showDirtyFields();case"destroy":return s(e)}}else{return e[n].apply(e,Array.prototype.slice.call(arguments,1))}}else{return this.each(function(e,t){n=c.extend({},c.fn.dirty.defaults,n);var i=new d(c(t),n);i.init()})}};c.fn.dirty.singleton=r;c.fn.dirty.defaults={preventLeaving:false,leavingMessage:"There are unsaved changes on this page which will be discarded if you continue.",onDirty:c.noop,onClean:c.noop,fireEventsOnEachChange:false};c.fn.dirty.extend=function(e){c.extend(d.prototype,e)};c.fn.dirty.constructor=d;c.fn.dirty.prototype=d.prototype})(jQuery);!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).bootstrap=t()}(this,function(){"use strict";const y="transitionend",b=t=>{let i=t.getAttribute("data-bs-target");if(!i||"#"===i){let e=t.getAttribute("href");if(!e||!e.includes("#")&&!e.startsWith("."))return null;e.includes("#")&&!e.startsWith("#")&&(e=`#${e.split("#")[1]}`),i=e&&"#"!==e?e.trim():null}return i},C=e=>{const t=b(e);return t&&document.querySelector(t)?t:null},s=e=>{const t=b(e);return t?document.querySelector(t):null},w=e=>{e.dispatchEvent(new Event(y))},a=e=>!(!e||"object"!=typeof e)&&(void 0!==e.jquery&&(e=e[0]),void 0!==e.nodeType),r=e=>a(e)?e.jquery?e[0]:e:"string"==typeof e&&e.length>0?document.querySelector(e):null,n=e=>{if(!a(e)||0===e.getClientRects().length)return!1;const t="visible"===getComputedStyle(e).getPropertyValue("visibility"),i=e.closest("details:not([open])");if(!i)return t;if(i!==e){const t=e.closest("summary");if(t&&t.parentNode!==i)return!1;if(null===t)return!1}return t},o=e=>!e||e.nodeType!==Node.ELEMENT_NODE||!!e.classList.contains("disabled")||(void 0!==e.disabled?e.disabled:e.hasAttribute("disabled")&&"false"!==e.getAttribute("disabled")),_=t=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof t.getRootNode){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?_(t.parentNode):null},A=()=>{},E=e=>{e.offsetHeight},S=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,T=[],l=()=>"rtl"===document.documentElement.dir,e=n=>{var e;e=()=>{const i=S();if(i){const e=n.NAME,t=i.fn[e];i.fn[e]=n.jQueryInterface,i.fn[e].Constructor=n,i.fn[e].noConflict=()=>(i.fn[e]=t,n.jQueryInterface)}},"loading"===document.readyState?(T.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of T)e()}),T.push(e)):e()},c=e=>{"function"==typeof e&&e()},x=(t,i,e=!0)=>{if(!e)return void c(t);const n=(e=>{if(!e)return 0;let{transitionDuration:t,transitionDelay:i}=window.getComputedStyle(e);const n=Number.parseFloat(t),r=Number.parseFloat(i);return n||r?(t=t.split(",")[0],i=i.split(",")[0],1e3*(Number.parseFloat(t)+Number.parseFloat(i))):0})(i)+5;let r=!1;const s=({target:e})=>{e===i&&(r=!0,i.removeEventListener(y,s),c(t))};i.addEventListener(y,s),setTimeout(()=>{r||w(i)},n)},$=(e,t,i,n)=>{const r=e.length;let s=e.indexOf(t);return-1===s?!i&&n?e[r-1]:e[0]:(s+=i?1:-1,n&&(s=(s+r)%r),e[Math.max(0,Math.min(s,r-1))])},H=/[^.]*(?=\..*)\.|.*/,B=/\..*/,V=/::\d+$/,W={};let z=1;const j={mouseenter:"mouseover",mouseleave:"mouseout"},U=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Y(e,t){return t&&`${t}::${z++}`||e.uidEvent||z++}function q(e){const t=Y(e);return e.uidEvent=t,W[t]=W[t]||{},W[t]}function K(e,t,i=null){return Object.values(e).find(e=>e.callable===t&&e.delegationSelector===i)}function X(e,t,i){const n="string"==typeof t,r=n?i:t||i;let s=ee(e);return U.has(s)||(s=e),[n,r,s]}function Q(e,t,i,n,r){if("string"!=typeof t||!e)return;let[s,o,a]=X(t,i,n);if(t in j){const e=t=>function(e){if(!e.relatedTarget||e.relatedTarget!==e.delegateTarget&&!e.delegateTarget.contains(e.relatedTarget))return t.call(this,e)};o=e(o)}const l=q(e),c=l[a]||(l[a]={}),u=K(c,o,s?i:null);if(u)return void(u.oneOff=u.oneOff&&r);const d=Y(o,t.replace(H,"")),h=s?function(s,o,a){return function i(n){const r=s.querySelectorAll(o);for(let{target:t}=n;t&&t!==this;t=t.parentNode)for(const e of r)if(e===t)return te(n,{delegateTarget:t}),i.oneOff&&p.off(s,n.type,o,a),a.apply(t,[n])}}(e,i,o):function(i,n){return function e(t){return te(t,{delegateTarget:i}),e.oneOff&&p.off(i,t.type,n),n.apply(i,[t])}}(e,o);h.delegationSelector=s?i:null,h.callable=o,h.oneOff=r,h.uidEvent=d,c[d]=h,e.addEventListener(a,h,s)}function Z(e,t,i,n,r){const s=K(t[i],n,r);s&&(e.removeEventListener(i,s,Boolean(r)),delete t[i][s.uidEvent])}function J(t,i,n,r){const s=i[n]||{};for(const e of Object.keys(s))if(e.includes(r)){const r=s[e];Z(t,i,n,r.callable,r.delegationSelector)}}function ee(e){return e=e.replace(B,""),j[e]||e}const p={on(e,t,i,n){Q(e,t,i,n,!1)},one(e,t,i,n){Q(e,t,i,n,!0)},off(e,t,i,n){if("string"!=typeof t||!e)return;const[r,s,o]=X(t,i,n),a=o!==t,l=q(e),c=l[o]||{},u=t.startsWith(".");if(void 0===s){if(u)for(const i of Object.keys(l))J(e,l,i,t.slice(1));for(const i of Object.keys(c)){const n=i.replace(V,"");if(!a||t.includes(n)){const t=c[i];Z(e,l,o,t.callable,t.delegationSelector)}}}else{if(!Object.keys(c).length)return;Z(e,l,o,s,r?i:null)}},trigger(e,t,i){if("string"!=typeof t||!e)return null;const n=S();let r=null,s=!0,o=!0,a=!1;t!==ee(t)&&n&&(r=n.Event(t,i),n(e).trigger(r),s=!r.isPropagationStopped(),o=!r.isImmediatePropagationStopped(),a=r.isDefaultPrevented());let l=new Event(t,{bubbles:s,cancelable:!0});return l=te(l,i),a&&l.preventDefault(),o&&e.dispatchEvent(l),l.defaultPrevented&&r&&r.preventDefault(),l}};function te(i,n){for(const[e,t]of Object.entries(n||{}))try{i[e]=t}catch(n){Object.defineProperty(i,e,{configurable:!0,get:()=>t})}return i}const u=new Map,ie={set(e,t,i){u.has(e)||u.set(e,new Map);const n=u.get(e);n.has(t)||0===n.size?n.set(t,i):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(n.keys())[0]}.`)},get:(e,t)=>u.has(e)&&u.get(e).get(t)||null,remove(e,t){if(!u.has(e))return;const i=u.get(e);i.delete(t),0===i.size&&u.delete(e)}};function ne(t){if("true"===t)return!0;if("false"===t)return!1;if(t===Number(t).toString())return Number(t);if(""===t||"null"===t)return null;if("string"!=typeof t)return t;try{return JSON.parse(decodeURIComponent(t))}catch(e){return t}}function re(e){return e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const d={setDataAttribute(e,t,i){e.setAttribute(`data-bs-${re(t)}`,i)},removeDataAttribute(e,t){e.removeAttribute(`data-bs-${re(t)}`)},getDataAttributes(i){if(!i)return{};const n={},e=Object.keys(i.dataset).filter(e=>e.startsWith("bs")&&!e.startsWith("bsConfig"));for(const t of e){let e=t.replace(/^bs/,"");e=e.charAt(0).toLowerCase()+e.slice(1,e.length),n[e]=ne(i.dataset[t])}return n},getDataAttribute:(e,t)=>ne(e.getAttribute(`data-bs-${re(t)}`))};class se{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const i=a(t)?d.getDataAttribute(t,"config"):{};return{...this.constructor.Default,..."object"==typeof i?i:{},...a(t)?d.getDataAttributes(t):{},..."object"==typeof e?e:{}}}_typeCheckConfig(r,s=this.constructor.DefaultType){for(const n of Object.keys(s)){const e=s[n],t=r[n],i=a(t)?"element":null==(o=t)?`${o}`:Object.prototype.toString.call(o).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(e).test(i))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${i}" but expected type "${e}".`)}var o}}class t extends se{constructor(e,t){super(),(e=r(e))&&(this._element=e,this._config=this._getConfig(t),ie.set(this._element,this.constructor.DATA_KEY,this))}dispose(){ie.remove(this._element,this.constructor.DATA_KEY),p.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,i=!0){x(e,t,i)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return ie.get(r(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,"object"==typeof t?t:null)}static get VERSION(){return"5.2.3"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const oe=(i,n="hide")=>{const e=`click.dismiss${i.EVENT_KEY}`,r=i.NAME;p.on(document,e,`[data-bs-dismiss="${r}"]`,function(e){if(["A","AREA"].includes(this.tagName)&&e.preventDefault(),o(this))return;const t=s(this)||this.closest(`.${r}`);i.getOrCreateInstance(t)[n]()})};class ae extends t{static get NAME(){return"alert"}close(){if(p.trigger(this._element,"close.bs.alert").defaultPrevented)return;this._element.classList.remove("show");const e=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,e)}_destroyElement(){this._element.remove(),p.trigger(this._element,"closed.bs.alert"),this.dispose()}static jQueryInterface(t){return this.each(function(){const e=ae.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}})}}oe(ae,"close"),e(ae);const le='[data-bs-toggle="button"]';class ce extends t{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(t){return this.each(function(){const e=ce.getOrCreateInstance(this);"toggle"===t&&e[t]()})}}p.on(document,"click.bs.button.data-api",le,e=>{e.preventDefault();const t=e.target.closest(le);ce.getOrCreateInstance(t).toggle()}),e(ce);const h={find:(e,t=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(t,e)),findOne:(e,t=document.documentElement)=>Element.prototype.querySelector.call(t,e),children:(e,t)=>[].concat(...e.children).filter(e=>e.matches(t)),parents(e,t){const i=[];let n=e.parentNode.closest(t);for(;n;)i.push(n),n=n.parentNode.closest(t);return i},prev(e,t){let i=e.previousElementSibling;for(;i;){if(i.matches(t))return[i];i=i.previousElementSibling}return[]},next(e,t){let i=e.nextElementSibling;for(;i;){if(i.matches(t))return[i];i=i.nextElementSibling}return[]},focusableChildren(e){const t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(e=>`${e}:not([tabindex^="-"])`).join(",");return this.find(t,e).filter(e=>!o(e)&&n(e))}},ve={endCallback:null,leftCallback:null,rightCallback:null},ye={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class be extends se{constructor(e,t){super(),this._element=e,e&&be.isSupported()&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return ve}static get DefaultType(){return ye}static get NAME(){return"swipe"}dispose(){p.off(this._element,".bs.swipe")}_start(e){this._supportPointerEvents?this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX):this._deltaX=e.touches[0].clientX}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),c(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=40)return;const t=e/this._deltaX;this._deltaX=0,t&&c(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(p.on(this._element,"pointerdown.bs.swipe",e=>this._start(e)),p.on(this._element,"pointerup.bs.swipe",e=>this._end(e)),this._element.classList.add("pointer-event")):(p.on(this._element,"touchstart.bs.swipe",e=>this._start(e)),p.on(this._element,"touchmove.bs.swipe",e=>this._move(e)),p.on(this._element,"touchend.bs.swipe",e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&("pen"===e.pointerType||"touch"===e.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Ce="next",f="prev",i="left",we="right",_e="slid.bs.carousel",Ae="carousel",Ee="active",Se={ArrowLeft:we,ArrowRight:i},Te={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},xe={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class De extends t{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=h.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===Ae&&this.cycle()}static get Default(){return Te}static get DefaultType(){return xe}static get NAME(){return"carousel"}next(){this._slide(Ce)}nextWhenVisible(){!document.hidden&&n(this._element)&&this.next()}prev(){this._slide(f)}pause(){this._isSliding&&w(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?p.one(this._element,_e,()=>this.cycle()):this.cycle())}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding)return void p.one(this._element,_e,()=>this.to(e));const i=this._getItemIndex(this._getActive());if(i===e)return;const n=e>i?Ce:f;this._slide(n,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&p.on(this._element,"keydown.bs.carousel",e=>this._keydown(e)),"hover"===this._config.pause&&(p.on(this._element,"mouseenter.bs.carousel",()=>this.pause()),p.on(this._element,"mouseleave.bs.carousel",()=>this._maybeEnableCycle())),this._config.touch&&be.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const e of h.find(".carousel-item img",this._element))p.on(e,"dragstart.bs.carousel",e=>e.preventDefault());const e={leftCallback:()=>this._slide(this._directionToOrder(i)),rightCallback:()=>this._slide(this._directionToOrder(we)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new be(this._element,e)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=Se[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=h.findOne(".active",this._indicatorsElement);t.classList.remove(Ee),t.removeAttribute("aria-current");const i=h.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);i&&(i.classList.add(Ee),i.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(t,e=null){if(this._isSliding)return;const i=this._getActive(),n=t===Ce,r=e||$(this._getItems(),i,n,this._config.wrap);if(r===i)return;const s=this._getItemIndex(r),o=e=>p.trigger(this._element,e,{relatedTarget:r,direction:this._orderToDirection(t),from:this._getItemIndex(i),to:s});if(o("slide.bs.carousel").defaultPrevented)return;if(!i||!r)return;const a=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(s),this._activeElement=r;const l=n?"carousel-item-start":"carousel-item-end",c=n?"carousel-item-next":"carousel-item-prev";r.classList.add(c),E(r),i.classList.add(l),r.classList.add(l),this._queueCallback(()=>{r.classList.remove(l,c),r.classList.add(Ee),i.classList.remove(Ee,c,l),this._isSliding=!1,o(_e)},i,this._isAnimated()),a&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return h.findOne(".active.carousel-item",this._element)}_getItems(){return h.find(".carousel-item",this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return l()?e===i?f:Ce:e===i?Ce:f}_orderToDirection(e){return l()?e===f?i:we:e===f?we:i}static jQueryInterface(t){return this.each(function(){const e=De.getOrCreateInstance(this,t);if("number"!=typeof t){if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}else e.to(t)})}}p.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",function(e){const t=s(this);if(!t||!t.classList.contains(Ae))return;e.preventDefault();const i=De.getOrCreateInstance(t),n=this.getAttribute("data-bs-slide-to");return n?(i.to(n),void i._maybeEnableCycle()):"next"===d.getDataAttribute(this,"slide")?(i.next(),void i._maybeEnableCycle()):(i.prev(),void i._maybeEnableCycle())}),p.on(window,"load.bs.carousel.data-api",()=>{const t=h.find('[data-bs-ride="carousel"]');for(const e of t)De.getOrCreateInstance(e)}),e(De);const Re="show",Me="collapse",Ne="collapsing",Oe='[data-bs-toggle="collapse"]',Ie={parent:null,toggle:!0},Pe={parent:"(null|element)",toggle:"boolean"};class ke extends t{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const i=h.find(Oe);for(const e of i){const t=C(e),i=h.find(t).filter(e=>e===this._element);null!==t&&i.length&&this._triggerArray.push(e)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Ie}static get DefaultType(){return Pe}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(e=>e!==this._element).map(e=>ke.getOrCreateInstance(e,{toggle:!1}))),e.length&&e[0]._isTransitioning)return;if(p.trigger(this._element,"show.bs.collapse").defaultPrevented)return;for(const t of e)t.hide();const t=this._getDimension();this._element.classList.remove(Me),this._element.classList.add(Ne),this._element.style[t]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=`scroll${t[0].toUpperCase()+t.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(Ne),this._element.classList.add(Me,Re),this._element.style[t]="",p.trigger(this._element,"shown.bs.collapse")},this._element,!0),this._element.style[t]=`${this._element[i]}px`}hide(){if(this._isTransitioning||!this._isShown())return;if(p.trigger(this._element,"hide.bs.collapse").defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,E(this._element),this._element.classList.add(Ne),this._element.classList.remove(Me,Re);for(const t of this._triggerArray){const e=s(t);e&&!this._isShown(e)&&this._addAriaAndCollapsedClass([t],!1)}this._isTransitioning=!0,this._element.style[t]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(Ne),this._element.classList.add(Me),p.trigger(this._element,"hidden.bs.collapse")},this._element,!0)}_isShown(e=this._element){return e.classList.contains(Re)}_configAfterMerge(e){return e.toggle=Boolean(e.toggle),e.parent=r(e.parent),e}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const t=this._getFirstLevelChildren(Oe);for(const e of t){const t=s(e);t&&this._addAriaAndCollapsedClass([e],this._isShown(t))}}_getFirstLevelChildren(e){const t=h.find(":scope .collapse .collapse",this._config.parent);return h.find(e,this._config.parent).filter(e=>!t.includes(e))}_addAriaAndCollapsedClass(t,i){if(t.length)for(const e of t)e.classList.toggle("collapsed",!i),e.setAttribute("aria-expanded",i)}static jQueryInterface(t){const i={};return"string"==typeof t&&/show|hide/.test(t)&&(i.toggle=!1),this.each(function(){const e=ke.getOrCreateInstance(this,i);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}}p.on(document,"click.bs.collapse.data-api",Oe,function(e){("A"===e.target.tagName||e.delegateTarget&&"A"===e.delegateTarget.tagName)&&e.preventDefault();const t=C(this),i=h.find(t);for(const e of i)ke.getOrCreateInstance(e,{toggle:!1}).toggle()}),e(ke);var ue="top",de="bottom",he="right",pe="left",Le="auto",R=[ue,de,he,pe],fe="start",D="end",Fe="clippingParents",Ge="viewport",M="popper",$e="reference",He=R.reduce(function(e,t){return e.concat([t+"-"+fe,t+"-"+D])},[]),Be=[].concat(R,[Le]).reduce(function(e,t){return e.concat([t,t+"-"+fe,t+"-"+D])},[]),Ve="beforeRead",We="read",ze="afterRead",je="beforeMain",Ue="main",Ye="afterMain",qe="beforeWrite",Ke="write",Xe="afterWrite",Qe=[Ve,We,ze,je,Ue,Ye,qe,Ke,Xe];function N(e){return e?(e.nodeName||"").toLowerCase():null}function O(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function I(e){return e instanceof O(e).Element||e instanceof Element}function P(e){return e instanceof O(e).HTMLElement||e instanceof HTMLElement}function Ze(e){return"undefined"!=typeof ShadowRoot&&(e instanceof O(e).ShadowRoot||e instanceof ShadowRoot)}const Je={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var r=e.state;Object.keys(r.elements).forEach(function(e){var t=r.styles[e]||{},i=r.attributes[e]||{},n=r.elements[e];P(n)&&N(n)&&(Object.assign(n.style,t),Object.keys(i).forEach(function(e){var t=i[e];!1===t?n.removeAttribute(e):n.setAttribute(e,!0===t?"":t)}))})},effect:function(e){var r=e.state,s={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(r.elements.popper.style,s.popper),r.styles=s,r.elements.arrow&&Object.assign(r.elements.arrow.style,s.arrow),function(){Object.keys(r.elements).forEach(function(e){var t=r.elements[e],i=r.attributes[e]||{},n=Object.keys(r.styles.hasOwnProperty(e)?r.styles[e]:s[e]).reduce(function(e,t){return e[t]="",e},{});P(t)&&N(t)&&(Object.assign(t.style,n),Object.keys(i).forEach(function(e){t.removeAttribute(e)}))})}},requires:["computeStyles"]};function ge(e){return e.split("-")[0]}var me=Math.max,et=Math.min,k=Math.round;function tt(){var e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function it(){return!/^((?!chrome|android).)*safari/i.test(tt())}function L(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1);var n=e.getBoundingClientRect(),r=1,s=1;t&&P(e)&&(r=e.offsetWidth>0&&k(n.width)/e.offsetWidth||1,s=e.offsetHeight>0&&k(n.height)/e.offsetHeight||1);var o=(I(e)?O(e):window).visualViewport,a=!it()&&i,l=(n.left+(a&&o?o.offsetLeft:0))/r,c=(n.top+(a&&o?o.offsetTop:0))/s,u=n.width/r,d=n.height/s;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l,x:l,y:c}}function nt(e){var t=L(e),i=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:n}}function rt(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&Ze(i)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function F(e){return O(e).getComputedStyle(e)}function st(e){return["table","td","th"].indexOf(N(e))>=0}function G(e){return((I(e)?e.ownerDocument:e.document)||window.document).documentElement}function ot(e){return"html"===N(e)?e:e.assignedSlot||e.parentNode||(Ze(e)?e.host:null)||G(e)}function at(e){return P(e)&&"fixed"!==F(e).position?e.offsetParent:null}function lt(e){for(var t=O(e),i=at(e);i&&st(i)&&"static"===F(i).position;)i=at(i);return i&&("html"===N(i)||"body"===N(i)&&"static"===F(i).position)?t:i||function(e){var t=/firefox/i.test(tt());if(/Trident/i.test(tt())&&P(e)&&"fixed"===F(e).position)return null;var i=ot(e);for(Ze(i)&&(i=i.host);P(i)&&["html","body"].indexOf(N(i))<0;){var n=F(i);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return i;i=i.parentNode}return null}(e)||t}function ct(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function ut(e,t,i){return me(e,et(t,i))}function dt(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function ht(i,e){return e.reduce(function(e,t){return e[t]=i,e},{})}const pt={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,i=e.state,n=e.name,r=e.options,s=i.elements.arrow,o=i.modifiersData.popperOffsets,a=ge(i.placement),l=ct(a),c=[pe,he].indexOf(a)>=0?"height":"width";if(s&&o){var u=function(e,t){return dt("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:ht(e,R))}(r.padding,i),d=nt(s),h="y"===l?ue:pe,p="y"===l?de:he,f=i.rects.reference[c]+i.rects.reference[l]-o[l]-i.rects.popper[c],g=o[l]-i.rects.reference[l],m=lt(s),v=m?"y"===l?m.clientHeight||0:m.clientWidth||0:0,y=f/2-g/2,b=u[h],C=v-d[c]-u[p],w=v/2-d[c]/2+y,_=ut(b,w,C),A=l;i.modifiersData[n]=((t={})[A]=_,t.centerOffset=_-w,t)}},effect:function(e){var t=e.state,i=e.options.element,n=void 0===i?"[data-popper-arrow]":i;null!=n&&("string"!=typeof n||(n=t.elements.popper.querySelector(n)))&&rt(t.elements.popper,n)&&(t.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ft(e){return e.split("-")[1]}var gt={top:"auto",right:"auto",bottom:"auto",left:"auto"};function mt(e){var t,i=e.popper,n=e.popperRect,r=e.placement,s=e.variation,o=e.offsets,a=e.position,l=e.gpuAcceleration,c=e.adaptive,u=e.roundOffsets,d=e.isFixed,h=o.x,p=void 0===h?0:h,f=o.y,g=void 0===f?0:f,m="function"==typeof u?u({x:p,y:g}):{x:p,y:g};p=m.x,g=m.y;var v=o.hasOwnProperty("x"),y=o.hasOwnProperty("y"),b=pe,C=ue,w=window;if(c){var _=lt(i),A="clientHeight",E="clientWidth";_===O(i)&&"static"!==F(_=G(i)).position&&"absolute"===a&&(A="scrollHeight",E="scrollWidth"),(r===ue||(r===pe||r===he)&&s===D)&&(C=de,g-=(d&&_===w&&w.visualViewport?w.visualViewport.height:_[A])-n.height,g*=l?1:-1),r!==pe&&(r!==ue&&r!==de||s!==D)||(b=he,p-=(d&&_===w&&w.visualViewport?w.visualViewport.width:_[E])-n.width,p*=l?1:-1)}var S,T=Object.assign({position:a},c&&gt),x=!0===u?function(e){var t=e.x,i=e.y,n=window.devicePixelRatio||1;return{x:k(t*n)/n||0,y:k(i*n)/n||0}}({x:p,y:g}):{x:p,y:g};return p=x.x,g=x.y,l?Object.assign({},T,((S={})[C]=y?"0":"",S[b]=v?"0":"",S.transform=(w.devicePixelRatio||1)<=1?"translate("+p+"px, "+g+"px)":"translate3d("+p+"px, "+g+"px, 0)",S)):Object.assign({},T,((t={})[C]=y?g+"px":"",t[b]=v?p+"px":"",t.transform="",t))}const vt={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,i=e.options,n=i.gpuAcceleration,r=void 0===n||n,s=i.adaptive,o=void 0===s||s,a=i.roundOffsets,l=void 0===a||a,c={placement:ge(t.placement),variation:ft(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,mt(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,mt(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}};var yt={passive:!0};const bt={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,i=e.instance,n=e.options,r=n.scroll,s=void 0===r||r,o=n.resize,a=void 0===o||o,l=O(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&c.forEach(function(e){e.addEventListener("scroll",i.update,yt)}),a&&l.addEventListener("resize",i.update,yt),function(){s&&c.forEach(function(e){e.removeEventListener("scroll",i.update,yt)}),a&&l.removeEventListener("resize",i.update,yt)}},data:{}};var Ct={left:"right",right:"left",bottom:"top",top:"bottom"};function wt(e){return e.replace(/left|right|bottom|top/g,function(e){return Ct[e]})}var _t={start:"end",end:"start"};function At(e){return e.replace(/start|end/g,function(e){return _t[e]})}function Et(e){var t=O(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function St(e){return L(G(e)).left+Et(e).scrollLeft}function Tt(e){var t=F(e),i=t.overflow,n=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+r+n)}function xt(e){return["html","body","#document"].indexOf(N(e))>=0?e.ownerDocument.body:P(e)&&Tt(e)?e:xt(ot(e))}function Dt(e,t){var i;void 0===t&&(t=[]);var n=xt(e),r=n===(null==(i=e.ownerDocument)?void 0:i.body),s=O(n),o=r?[s].concat(s.visualViewport||[],Tt(n)?n:[]):n,a=t.concat(o);return r?a:a.concat(Dt(ot(o)))}function Rt(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Mt(e,t,i){return t===Ge?Rt(function(e,t){var i=O(e),n=G(e),r=i.visualViewport,s=n.clientWidth,o=n.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;var c=it();(c||!c&&"fixed"===t)&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a+St(e),y:l}}(e,i)):I(t)?function(e,t){var i=L(e,!1,"fixed"===t);return i.top=i.top+e.clientTop,i.left=i.left+e.clientLeft,i.bottom=i.top+e.clientHeight,i.right=i.left+e.clientWidth,i.width=e.clientWidth,i.height=e.clientHeight,i.x=i.left,i.y=i.top,i}(t,i):Rt(function(e){var t,i=G(e),n=Et(e),r=null==(t=e.ownerDocument)?void 0:t.body,s=me(i.scrollWidth,i.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=me(i.scrollHeight,i.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-n.scrollLeft+St(e),l=-n.scrollTop;return"rtl"===F(r||i).direction&&(a+=me(i.clientWidth,r?r.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}(G(e)))}function Nt(e){var t,i=e.reference,n=e.element,r=e.placement,s=r?ge(r):null,o=r?ft(r):null,a=i.x+i.width/2-n.width/2,l=i.y+i.height/2-n.height/2;switch(s){case ue:t={x:a,y:i.y-n.height};break;case de:t={x:a,y:i.y+i.height};break;case he:t={x:i.x+i.width,y:l};break;case pe:t={x:i.x-n.width,y:l};break;default:t={x:i.x,y:i.y}}var c=s?ct(s):null;if(null!=c){var u="y"===c?"height":"width";switch(o){case fe:t[c]=t[c]-(i[u]/2-n[u]/2);break;case D:t[c]=t[c]+(i[u]/2-n[u]/2)}}return t}function Ot(e,t){void 0===t&&(t={});var i=t,n=i.placement,r=void 0===n?e.placement:n,s=i.strategy,o=void 0===s?e.strategy:s,a=i.boundary,l=void 0===a?Fe:a,c=i.rootBoundary,u=void 0===c?Ge:c,d=i.elementContext,h=void 0===d?M:d,p=i.altBoundary,f=void 0!==p&&p,g=i.padding,m=void 0===g?0:g,v=dt("number"!=typeof m?m:ht(m,R)),y=h===M?$e:M,b=e.rects.popper,C=e.elements[f?y:h],w=function(n,e,t,r){var i="clippingParents"===e?function(e){var t=Dt(ot(e)),i=["absolute","fixed"].indexOf(F(e).position)>=0&&P(e)?lt(e):e;return I(i)?t.filter(function(e){return I(e)&&rt(e,i)&&"body"!==N(e)}):[]}(n):[].concat(e),s=[].concat(i,[t]),o=s[0],a=s.reduce(function(e,t){var i=Mt(n,t,r);return e.top=me(i.top,e.top),e.right=et(i.right,e.right),e.bottom=et(i.bottom,e.bottom),e.left=me(i.left,e.left),e},Mt(n,o,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}(I(C)?C:C.contextElement||G(e.elements.popper),l,u,o),_=L(e.elements.reference),A=Nt({reference:_,element:b,strategy:"absolute",placement:r}),E=Rt(Object.assign({},b,A)),S=h===M?E:_,T={top:w.top-S.top+v.top,bottom:S.bottom-w.bottom+v.bottom,left:w.left-S.left+v.left,right:S.right-w.right+v.right},x=e.modifiersData.offset;if(h===M&&x){var D=x[r];Object.keys(T).forEach(function(e){var t=[he,de].indexOf(e)>=0?1:-1,i=[ue,de].indexOf(e)>=0?"y":"x";T[e]+=D[i]*t})}return T}function It(i,e){void 0===e&&(e={});var t=e,n=t.placement,r=t.boundary,s=t.rootBoundary,o=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,c=void 0===l?Be:l,u=ft(n),d=u?a?He:He.filter(function(e){return ft(e)===u}):R,h=d.filter(function(e){return c.indexOf(e)>=0});0===h.length&&(h=d);var p=h.reduce(function(e,t){return e[t]=Ot(i,{placement:t,boundary:r,rootBoundary:s,padding:o})[ge(t)],e},{});return Object.keys(p).sort(function(e,t){return p[e]-p[t]})}const Pt={name:"flip",enabled:!0,phase:"main",fn:function(e){var i=e.state,t=e.options,n=e.name;if(!i.modifiersData[n]._skip){for(var r=t.mainAxis,s=void 0===r||r,o=t.altAxis,a=void 0===o||o,l=t.fallbackPlacements,c=t.padding,u=t.boundary,d=t.rootBoundary,h=t.altBoundary,p=t.flipVariations,f=void 0===p||p,g=t.allowedAutoPlacements,m=i.options.placement,v=ge(m),y=l||(v!==m&&f?function(e){if(ge(e)===Le)return[];var t=wt(e);return[At(e),t,At(t)]}(m):[wt(m)]),b=[m].concat(y).reduce(function(e,t){return e.concat(ge(t)===Le?It(i,{placement:t,boundary:u,rootBoundary:d,padding:c,flipVariations:f,allowedAutoPlacements:g}):t)},[]),C=i.rects.reference,w=i.rects.popper,_=new Map,A=!0,E=b[0],S=0;S<b.length;S++){var T=b[S],x=ge(T),D=ft(T)===fe,R=[ue,de].indexOf(x)>=0,M=R?"width":"height",N=Ot(i,{placement:T,boundary:u,rootBoundary:d,altBoundary:h,padding:c}),O=R?D?he:pe:D?de:ue;C[M]>w[M]&&(O=wt(O));var I=wt(O),P=[];if(s&&P.push(N[x]<=0),a&&P.push(N[O]<=0,N[I]<=0),P.every(function(e){return e})){E=T,A=!1;break}_.set(T,P)}if(A)for(var L=function(i){var e=b.find(function(e){var t=_.get(e);if(t)return t.slice(0,i).every(function(e){return e})});if(e)return E=e,"break"},k=f?3:1;k>0&&"break"!==L(k);k--);i.placement!==E&&(i.modifiersData[n]._skip=!0,i.placement=E,i.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function kt(e,t,i){return void 0===i&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function Lt(t){return[ue,he,de,pe].some(function(e){return t[e]>=0})}const Ft={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,i=e.name,n=t.rects.reference,r=t.rects.popper,s=t.modifiersData.preventOverflow,o=Ot(t,{elementContext:"reference"}),a=Ot(t,{altBoundary:!0}),l=kt(o,n),c=kt(a,r,s),u=Lt(l),d=Lt(c);t.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}},Gt={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var i=e.state,t=e.options,n=e.name,r=t.offset,s=void 0===r?[0,0]:r,o=Be.reduce(function(e,t){return e[t]=function(e,t,i){var n=ge(e),r=[pe,ue].indexOf(n)>=0?-1:1,s="function"==typeof i?i(Object.assign({},t,{placement:e})):i,o=s[0],a=s[1];return o=o||0,a=(a||0)*r,[pe,he].indexOf(n)>=0?{x:a,y:o}:{x:o,y:a}}(t,i.rects,s),e},{}),a=o[i.placement],l=a.x,c=a.y;null!=i.modifiersData.popperOffsets&&(i.modifiersData.popperOffsets.x+=l,i.modifiersData.popperOffsets.y+=c),i.modifiersData[n]=o}},$t={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,i=e.name;t.modifiersData[i]=Nt({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},Ht={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,L=e.name,n=i.mainAxis,F=void 0===n||n,r=i.altAxis,G=void 0!==r&&r,$=i.boundary,H=i.rootBoundary,B=i.altBoundary,V=i.padding,s=i.tether,o=void 0===s||s,a=i.tetherOffset,l=void 0===a?0:a,c=Ot(t,{boundary:$,rootBoundary:H,padding:V,altBoundary:B}),u=ge(t.placement),d=ft(t.placement),h=!d,p=ct(u),f="x"===p?"y":"x",g=t.modifiersData.popperOffsets,m=t.rects.reference,v=t.rects.popper,y="function"==typeof l?l(Object.assign({},t.rects,{placement:t.placement})):l,b="number"==typeof y?{mainAxis:y,altAxis:y}:Object.assign({mainAxis:0,altAxis:0},y),C=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,w={x:0,y:0};if(g){if(F){var _,A="y"===p?ue:pe,E="y"===p?de:he,S="y"===p?"height":"width",T=g[p],x=T+c[A],D=T-c[E],R=o?-v[S]/2:0,W=d===fe?m[S]:v[S],z=d===fe?-v[S]:-m[S],M=t.elements.arrow,j=o&&M?nt(M):{width:0,height:0},U=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Y=U[A],q=U[E],N=ut(0,m[S],j[S]),K=h?m[S]/2-R-N-Y-b.mainAxis:W-N-Y-b.mainAxis,X=h?-m[S]/2+R+N+q+b.mainAxis:z+N+q+b.mainAxis,O=t.elements.arrow&&lt(t.elements.arrow),Q=O?"y"===p?O.clientTop||0:O.clientLeft||0:0,Z=null!=(_=null==C?void 0:C[p])?_:0,J=T+X-Z,ee=ut(o?et(x,T+K-Z-Q):x,T,o?me(D,J):D);g[p]=ee,w[p]=ee-T}if(G){var te,ie="x"===p?ue:pe,ne="x"===p?de:he,I=g[f],P="y"===f?"height":"width",re=I+c[ie],se=I-c[ne],k=-1!==[ue,pe].indexOf(u),oe=null!=(te=null==C?void 0:C[f])?te:0,ae=k?re:I-m[P]-v[P]-oe+b.altAxis,le=k?I+m[P]+v[P]-oe-b.altAxis:se,ce=o&&k?function(e,t,i){var n=ut(e,t,i);return n>i?i:n}(ae,I,le):ut(o?ae:re,I,o?le:se);g[f]=ce,w[f]=ce-I}t.modifiersData[L]=w}},requiresIfExists:["offset"]};function Bt(e,t,i){void 0===i&&(i=!1);var n,r,s=P(t),o=P(t)&&function(e){var t=e.getBoundingClientRect(),i=k(t.width)/e.offsetWidth||1,n=k(t.height)/e.offsetHeight||1;return 1!==i||1!==n}(t),a=G(t),l=L(e,o,i),c={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(s||!s&&!i)&&(("body"!==N(t)||Tt(a))&&(c=(n=t)!==O(n)&&P(n)?{scrollLeft:(r=n).scrollLeft,scrollTop:r.scrollTop}:Et(n)),P(t)?((u=L(t,!0)).x+=t.clientLeft,u.y+=t.clientTop):a&&(u.x=St(a))),{x:l.left+c.scrollLeft-u.x,y:l.top+c.scrollTop-u.y,width:l.width,height:l.height}}function Vt(e){var i=new Map,n=new Set,t=[];function r(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach(function(e){if(!n.has(e)){var t=i.get(e);t&&r(t)}}),t.push(e)}return e.forEach(function(e){i.set(e.name,e)}),e.forEach(function(e){n.has(e.name)||r(e)}),t}var Wt={placement:"bottom",modifiers:[],strategy:"absolute"};function zt(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some(function(e){return!(e&&"function"==typeof e.getBoundingClientRect)})}function jt(e){void 0===e&&(e={});var t=e,i=t.defaultModifiers,h=void 0===i?[]:i,n=t.defaultOptions,p=void 0===n?Wt:n;return function(s,o,t){void 0===t&&(t=p);var i,n,c={placement:"bottom",orderedModifiers:[],options:Object.assign({},Wt,p),modifiersData:{},elements:{reference:s,popper:o},attributes:{},styles:{}},a=[],u=!1,d={state:c,setOptions:function(e){var t="function"==typeof e?e(c.options):e;l(),c.options=Object.assign({},p,c.options,t),c.scrollParents={reference:I(s)?Dt(s):s.contextElement?Dt(s.contextElement):[],popper:Dt(o)};var i,n,r=function(e){var i=Vt(e);return Qe.reduce(function(e,t){return e.concat(i.filter(function(e){return e.phase===t}))},[])}((i=[].concat(h,c.options.modifiers),n=i.reduce(function(e,t){var i=e[t.name];return e[t.name]=i?Object.assign({},i,t,{options:Object.assign({},i.options,t.options),data:Object.assign({},i.data,t.data)}):t,e},{}),Object.keys(n).map(function(e){return n[e]})));return c.orderedModifiers=r.filter(function(e){return e.enabled}),c.orderedModifiers.forEach(function(e){var t=e.name,i=e.options,n=void 0===i?{}:i,r=e.effect;if("function"==typeof r){var s=r({state:c,name:t,instance:d,options:n});a.push(s||function(){})}}),d.update()},forceUpdate:function(){if(!u){var e=c.elements,t=e.reference,i=e.popper;if(zt(t,i)){c.rects={reference:Bt(t,lt(i),"fixed"===c.options.strategy),popper:nt(i)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(e){return c.modifiersData[e.name]=Object.assign({},e.data)});for(var n=0;n<c.orderedModifiers.length;n++)if(!0!==c.reset){var r=c.orderedModifiers[n],s=r.fn,o=r.options,a=void 0===o?{}:o,l=r.name;"function"==typeof s&&(c=s({state:c,options:a,name:l,instance:d})||c)}else c.reset=!1,n=-1}}},update:(i=function(){return new Promise(function(e){d.forceUpdate(),e(c)})},function(){return n||(n=new Promise(function(e){Promise.resolve().then(function(){n=void 0,e(i())})})),n}),destroy:function(){l(),u=!0}};if(!zt(s,o))return d;function l(){a.forEach(function(e){return e()}),a=[]}return d.setOptions(t).then(function(e){!u&&t.onFirstUpdate&&t.onFirstUpdate(e)}),d}}var Ut=jt(),Yt=jt({defaultModifiers:[bt,$t,vt,Je]}),qt=jt({defaultModifiers:[bt,$t,vt,Je,Gt,Pt,Ht,pt,Ft]});const Kt=Object.freeze(Object.defineProperty({__proto__:null,popperGenerator:jt,detectOverflow:Ot,createPopperBase:Ut,createPopper:qt,createPopperLite:Yt,top:ue,bottom:de,right:he,left:pe,auto:Le,basePlacements:R,start:fe,end:D,clippingParents:Fe,viewport:Ge,popper:M,reference:$e,variationPlacements:He,placements:Be,beforeRead:Ve,read:We,afterRead:ze,beforeMain:je,main:Ue,afterMain:Ye,beforeWrite:qe,write:Ke,afterWrite:Xe,modifierPhases:Qe,applyStyles:Je,arrow:pt,computeStyles:vt,eventListeners:bt,flip:Pt,hide:Ft,offset:Gt,popperOffsets:$t,preventOverflow:Ht},Symbol.toStringTag,{value:"Module"})),Xt="dropdown",Qt="ArrowUp",Zt="ArrowDown",Jt="click.bs.dropdown.data-api",ei="keydown.bs.dropdown.data-api",ti="show",g='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',ii=`${g}.show`,ni=".dropdown-menu",ri=l()?"top-end":"top-start",si=l()?"top-start":"top-end",oi=l()?"bottom-end":"bottom-start",ai=l()?"bottom-start":"bottom-end",li=l()?"left-start":"right-start",ci=l()?"right-start":"left-start",ui={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},di={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class m extends t{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=h.next(this._element,ni)[0]||h.prev(this._element,ni)[0]||h.findOne(ni,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return ui}static get DefaultType(){return di}static get NAME(){return Xt}toggle(){return this._isShown()?this.hide():this.show()}show(){if(o(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!p.trigger(this._element,"show.bs.dropdown",e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const e of[].concat(...document.body.children))p.on(e,"mouseover",A);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(ti),this._element.classList.add(ti),p.trigger(this._element,"shown.bs.dropdown",e)}}hide(){if(o(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!p.trigger(this._element,"hide.bs.dropdown",e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))p.off(e,"mouseover",A);this._popper&&this._popper.destroy(),this._menu.classList.remove(ti),this._element.classList.remove(ti),this._element.setAttribute("aria-expanded","false"),d.removeDataAttribute(this._menu,"popper"),p.trigger(this._element,"hidden.bs.dropdown",e)}}_getConfig(e){if("object"==typeof(e=super._getConfig(e)).reference&&!a(e.reference)&&"function"!=typeof e.reference.getBoundingClientRect)throw new TypeError(`${Xt.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(void 0===Kt)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let e=this._element;"parent"===this._config.reference?e=this._parent:a(this._config.reference)?e=r(this._config.reference):"object"==typeof this._config.reference&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=qt(e,this._menu,t)}_isShown(){return this._menu.classList.contains(ti)}_getPlacement(){const e=this._parent;if(e.classList.contains("dropend"))return li;if(e.classList.contains("dropstart"))return ci;if(e.classList.contains("dropup-center"))return"top";if(e.classList.contains("dropdown-center"))return"bottom";const t="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return e.classList.contains("dropup")?t?si:ri:t?ai:oi}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map(e=>Number.parseInt(e,10)):"function"==typeof t?e=>t(e,this._element):t}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(d.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,..."function"==typeof this._config.popperConfig?this._config.popperConfig(e):this._config.popperConfig}}_selectMenuItem({key:e,target:t}){const i=h.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(e=>n(e));i.length&&$(i,t,e===Zt,!i.includes(t)).focus()}static jQueryInterface(t){return this.each(function(){const e=m.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}static clearMenus(r){if(2===r.button||"keyup"===r.type&&"Tab"!==r.key)return;const s=h.find(ii);for(const n of s){const s=m.getInstance(n);if(!s||!1===s._config.autoClose)continue;const e=r.composedPath(),t=e.includes(s._menu);if(e.includes(s._element)||"inside"===s._config.autoClose&&!t||"outside"===s._config.autoClose&&t)continue;if(s._menu.contains(r.target)&&("keyup"===r.type&&"Tab"===r.key||/input|select|option|textarea|form/i.test(r.target.tagName)))continue;const i={relatedTarget:s._element};"click"===r.type&&(i.clickEvent=r),s._completeHide(i)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),i="Escape"===e.key,n=[Qt,Zt].includes(e.key);if(!n&&!i)return;if(t&&!i)return;e.preventDefault();const r=this.matches(g)?this:h.prev(this,g)[0]||h.next(this,g)[0]||h.findOne(g,e.delegateTarget.parentNode),s=m.getOrCreateInstance(r);if(n)return e.stopPropagation(),s.show(),void s._selectMenuItem(e);s._isShown()&&(e.stopPropagation(),s.hide(),r.focus())}}p.on(document,ei,g,m.dataApiKeydownHandler),p.on(document,ei,ni,m.dataApiKeydownHandler),p.on(document,Jt,m.clearMenus),p.on(document,"keyup.bs.dropdown.data-api",m.clearMenus),p.on(document,Jt,g,function(e){e.preventDefault(),m.getOrCreateInstance(this).toggle()}),e(m);const hi=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",pi=".sticky-top",fi="padding-right",gi="margin-right";class mi{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,fi,e=>e+t),this._setElementAttributes(hi,fi,e=>e+t),this._setElementAttributes(pi,gi,e=>e-t)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,fi),this._resetElementAttributes(hi,fi),this._resetElementAttributes(pi,gi)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,i,n){const r=this.getWidth();this._applyManipulationCallback(e,e=>{if(e!==this._element&&window.innerWidth>e.clientWidth+r)return;this._saveInitialAttribute(e,i);const t=window.getComputedStyle(e).getPropertyValue(i);e.style.setProperty(i,`${n(Number.parseFloat(t))}px`)})}_saveInitialAttribute(e,t){const i=e.style.getPropertyValue(t);i&&d.setDataAttribute(e,t,i)}_resetElementAttributes(e,i){this._applyManipulationCallback(e,e=>{const t=d.getDataAttribute(e,i);null!==t?(d.removeDataAttribute(e,i),e.style.setProperty(i,t)):e.style.removeProperty(i)})}_applyManipulationCallback(t,i){if(a(t))i(t);else for(const e of h.find(t,this._element))i(e)}}const vi="show",yi="mousedown.bs.backdrop",bi={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Ci={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class wi extends se{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return bi}static get DefaultType(){return Ci}static get NAME(){return"backdrop"}show(e){if(!this._config.isVisible)return void c(e);this._append();const t=this._getElement();this._config.isAnimated&&E(t),t.classList.add(vi),this._emulateAnimation(()=>{c(e)})}hide(e){this._config.isVisible?(this._getElement().classList.remove(vi),this._emulateAnimation(()=>{this.dispose(),c(e)})):c(e)}dispose(){this._isAppended&&(p.off(this._element,yi),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add("fade"),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=r(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),p.on(e,yi,()=>{c(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){x(e,this._getElement(),this._config.isAnimated)}}const _i=".bs.focustrap",Ai="backward",Ei={autofocus:!0,trapElement:null},Si={autofocus:"boolean",trapElement:"element"};class Ti extends se{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Ei}static get DefaultType(){return Si}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),p.off(document,_i),p.on(document,"focusin.bs.focustrap",e=>this._handleFocusin(e)),p.on(document,"keydown.tab.bs.focustrap",e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,p.off(document,_i))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const i=h.focusableChildren(t);0===i.length?t.focus():this._lastTabNavDirection===Ai?i[i.length-1].focus():i[0].focus()}_handleKeydown(e){"Tab"===e.key&&(this._lastTabNavDirection=e.shiftKey?Ai:"forward")}}const xi="hidden.bs.modal",Di="show.bs.modal",Ri="modal-open",Mi="show",Ni="modal-static",Oi={backdrop:!0,focus:!0,keyboard:!0},Ii={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Pi extends t{constructor(e,t){super(e,t),this._dialog=h.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new mi,this._addEventListeners()}static get Default(){return Oi}static get DefaultType(){return Ii}static get NAME(){return"modal"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||p.trigger(this._element,Di,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Ri),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){this._isShown&&!this._isTransitioning&&(p.trigger(this._element,"hide.bs.modal").defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Mi),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){for(const e of[window,this._dialog])p.off(e,".bs.modal");this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new wi({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Ti({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=h.findOne(".modal-body",this._dialog);t&&(t.scrollTop=0),E(this._element),this._element.classList.add(Mi),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,p.trigger(this._element,"shown.bs.modal",{relatedTarget:e})},this._dialog,this._isAnimated())}_addEventListeners(){p.on(this._element,"keydown.dismiss.bs.modal",e=>{if("Escape"===e.key)return this._config.keyboard?(e.preventDefault(),void this.hide()):void this._triggerBackdropTransition()}),p.on(window,"resize.bs.modal",()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),p.on(this._element,"mousedown.dismiss.bs.modal",t=>{p.one(this._element,"click.dismiss.bs.modal",e=>{this._element===t.target&&this._element===e.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Ri),this._resetAdjustments(),this._scrollBar.reset(),p.trigger(this._element,xi)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(p.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented)return;const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._element.style.overflowY;"hidden"===t||this._element.classList.contains(Ni)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add(Ni),this._queueCallback(()=>{this._element.classList.remove(Ni),this._queueCallback(()=>{this._element.style.overflowY=t},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),i=t>0;if(i&&!e){const e=l()?"paddingLeft":"paddingRight";this._element.style[e]=`${t}px`}if(!i&&e){const e=l()?"paddingRight":"paddingLeft";this._element.style[e]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,i){return this.each(function(){const e=Pi.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](i)}})}}p.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',function(e){const t=s(this);["A","AREA"].includes(this.tagName)&&e.preventDefault(),p.one(t,Di,e=>{e.defaultPrevented||p.one(t,xi,()=>{n(this)&&this.focus()})});const i=h.findOne(".modal.show");i&&Pi.getInstance(i).hide(),Pi.getOrCreateInstance(t).toggle(this)}),oe(Pi),e(Pi);const ki="show",Li="showing",Fi="hiding",Gi=".offcanvas.show",$i="hidePrevented.bs.offcanvas",Hi="hidden.bs.offcanvas",Bi={backdrop:!0,keyboard:!0,scroll:!1},Vi={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class v extends t{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Bi}static get DefaultType(){return Vi}static get NAME(){return"offcanvas"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||p.trigger(this._element,"show.bs.offcanvas",{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new mi).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Li),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(ki),this._element.classList.remove(Li),p.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:e})},this._element,!0))}hide(){this._isShown&&(p.trigger(this._element,"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Fi),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(ki,Fi),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new mi).reset(),p.trigger(this._element,Hi)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=Boolean(this._config.backdrop);return new wi({className:"offcanvas-backdrop",isVisible:e,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:e?()=>{"static"!==this._config.backdrop?this.hide():p.trigger(this._element,$i)}:null})}_initializeFocusTrap(){return new Ti({trapElement:this._element})}_addEventListeners(){p.on(this._element,"keydown.dismiss.bs.offcanvas",e=>{"Escape"===e.key&&(this._config.keyboard?this.hide():p.trigger(this._element,$i))})}static jQueryInterface(t){return this.each(function(){const e=v.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}})}}p.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',function(e){const t=s(this);if(["A","AREA"].includes(this.tagName)&&e.preventDefault(),o(this))return;p.one(t,Hi,()=>{n(this)&&this.focus()});const i=h.findOne(Gi);i&&i!==t&&v.getInstance(i).hide(),v.getOrCreateInstance(t).toggle(this)}),p.on(window,"load.bs.offcanvas.data-api",()=>{for(const e of h.find(Gi))v.getOrCreateInstance(e).show()}),p.on(window,"resize.bs.offcanvas",()=>{for(const e of h.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(e).position&&v.getOrCreateInstance(e).hide()}),oe(v),e(v);const Wi=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),zi=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,ji=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,Ui=(e,t)=>{const i=e.nodeName.toLowerCase();return t.includes(i)?!Wi.has(i)||Boolean(zi.test(e.nodeValue)||ji.test(e.nodeValue)):t.filter(e=>e instanceof RegExp).some(e=>e.test(i))},Yi={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},qi={allowList:Yi,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Ki={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Xi={entry:"(string|element|function|null)",selector:"(string|element)"};class Qi extends se{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return qi}static get DefaultType(){return Ki}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[t,i]of Object.entries(this._config.content))this._setContent(e,i,t);const t=e.children[0],i=this._resolvePossibleFunction(this._config.extraClass);return i&&t.classList.add(...i.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(i){for(const[e,t]of Object.entries(i))super._typeCheckConfig({selector:e,entry:t},Xi)}_setContent(e,t,i){const n=h.findOne(i,e);n&&((t=this._resolvePossibleFunction(t))?a(t)?this._putElementInTemplate(r(t),n):this._config.html?n.innerHTML=this._maybeSanitize(t):n.textContent=t:n.remove())}_maybeSanitize(e){return this._config.sanitize?function(e,t,i){if(!e.length)return e;if(i&&"function"==typeof i)return i(e);const n=(new window.DOMParser).parseFromString(e,"text/html"),r=[].concat(...n.body.querySelectorAll("*"));for(const e of r){const i=e.nodeName.toLowerCase();if(!Object.keys(t).includes(i)){e.remove();continue}const n=[].concat(...e.attributes),r=[].concat(t["*"]||[],t[i]||[]);for(const t of n)Ui(t,r)||e.removeAttribute(t.nodeName)}return n.body.innerHTML}(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return"function"==typeof e?e(this):e}_putElementInTemplate(e,t){if(this._config.html)return t.innerHTML="",void t.append(e);t.textContent=e.textContent}}const Zi=new Set(["sanitize","allowList","sanitizeFn"]),Ji="fade",en="show",tn=".modal",nn="hide.bs.modal",rn="hover",sn="focus",on={AUTO:"auto",TOP:"top",RIGHT:l()?"left":"right",BOTTOM:"bottom",LEFT:l()?"right":"left"},an={allowList:Yi,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,0],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},ln={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class cn extends t{constructor(e,t){if(void 0===Kt)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return an}static get DefaultType(){return ln}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),p.off(this._element.closest(tn),nn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const e=p.trigger(this._element,this.constructor.eventName("show")),t=(_(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!t)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:n}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(n.append(i),p.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(i),i.classList.add(en),"ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))p.on(e,"mouseover",A);this._queueCallback(()=>{p.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!p.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(en),"ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))p.off(e,"mouseover",A);this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),p.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Ji,en),t.classList.add(`bs-${this.constructor.NAME}-auto`);const i=(e=>{do{e+=Math.floor(1e6*Math.random())}while(document.getElementById(e));return e})(this.constructor.NAME).toString();return t.setAttribute("id",i),this._isAnimated()&&t.classList.add(Ji),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Qi({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ji)}_isShown(){return this.tip&&this.tip.classList.contains(en)}_createPopper(e){const t="function"==typeof this._config.placement?this._config.placement.call(this,e,this._element):this._config.placement,i=on[t.toUpperCase()];return qt(this._element,e,this._getPopperConfig(i))}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map(e=>Number.parseInt(e,10)):"function"==typeof t?e=>t(e,this._element):t}_resolvePossibleFunction(e){return"function"==typeof e?e.call(this._element):e}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:e=>{this._getTipElement().setAttribute("data-popper-placement",e.state.placement)}}]};return{...t,..."function"==typeof this._config.popperConfig?this._config.popperConfig(t):this._config.popperConfig}}_setListeners(){const i=this._config.trigger.split(" ");for(const t of i)if("click"===t)p.on(this._element,this.constructor.eventName("click"),this._config.selector,e=>{this._initializeOnDelegatedTarget(e).toggle()});else if("manual"!==t){const i=t===rn?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),e=t===rn?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");p.on(this._element,i,this._config.selector,e=>{const t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusin"===e.type?sn:rn]=!0,t._enter()}),p.on(this._element,e,this._config.selector,e=>{const t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusout"===e.type?sn:rn]=t._element.contains(e.relatedTarget),t._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},p.on(this._element.closest(tn),nn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=d.getDataAttributes(this._element);for(const e of Object.keys(t))Zi.has(e)&&delete t[e];return e={...t,..."object"==typeof e&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=!1===e.container?document.body:r(e.container),"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),"number"==typeof e.title&&(e.title=e.title.toString()),"number"==typeof e.content&&(e.content=e.content.toString()),e}_getDelegateConfig(){const t={};for(const e in this._config)this.constructor.Default[e]!==this._config[e]&&(t[e]=this._config[e]);return t.selector=!1,t.trigger="manual",t}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each(function(){const e=cn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}}e(cn);const un={...cn.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},dn={...cn.DefaultType,content:"(null|string|element|function)"};class hn extends cn{static get Default(){return un}static get DefaultType(){return dn}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each(function(){const e=hn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}}e(hn);const pn="click.bs.scrollspy",fn="active",gn="[href]",mn={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},vn={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class yn extends t{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return mn}static get DefaultType(){return vn}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=r(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,"string"==typeof e.threshold&&(e.threshold=e.threshold.split(",").map(e=>Number.parseFloat(e))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(p.off(this._config.target,pn),p.on(this._config.target,pn,gn,i=>{const n=this._observableSections.get(i.target.hash);if(n){i.preventDefault();const e=this._rootElement||window,t=n.offsetTop-this._element.offsetTop;if(e.scrollTo)return void e.scrollTo({top:t,behavior:"smooth"});e.scrollTop=t}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(e=>this._observerCallback(e),e)}_observerCallback(t){const i=e=>this._targetLinks.get(`#${e.target.id}`),n=e=>{this._previousScrollData.visibleEntryTop=e.target.offsetTop,this._process(i(e))},r=(this._rootElement||document.documentElement).scrollTop,s=r>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=r;for(const e of t){if(!e.isIntersecting){this._activeTarget=null,this._clearActiveClass(i(e));continue}const t=e.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(s&&t){if(n(e),!r)return}else s||t||n(e)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const t=h.find(gn,this._config.target);for(const e of t){if(!e.hash||o(e))continue;const t=h.findOne(e.hash,this._element);n(t)&&(this._targetLinks.set(e.hash,e),this._observableSections.set(e.hash,t))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(fn),this._activateParents(e),p.trigger(this._element,"activate.bs.scrollspy",{relatedTarget:e}))}_activateParents(t){if(t.classList.contains("dropdown-item"))h.findOne(".dropdown-toggle",t.closest(".dropdown")).classList.add(fn);else for(const e of h.parents(t,".nav, .list-group"))for(const t of h.prev(e,".nav-link, .nav-item > .nav-link, .list-group-item"))t.classList.add(fn)}_clearActiveClass(e){e.classList.remove(fn);const t=h.find("[href].active",e);for(const e of t)e.classList.remove(fn)}static jQueryInterface(t){return this.each(function(){const e=yn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}})}}p.on(window,"load.bs.scrollspy.data-api",()=>{for(const e of h.find('[data-bs-spy="scroll"]'))yn.getOrCreateInstance(e)}),e(yn);const bn="ArrowLeft",Cn="ArrowRight",wn="ArrowUp",_n="ArrowDown",An="active",En="fade",Sn="show",Tn='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',xn=`.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), ${Tn}`;class Dn extends t{constructor(e){super(e),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),p.on(this._element,"keydown.bs.tab",e=>this._keydown(e)))}static get NAME(){return"tab"}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),i=t?p.trigger(t,"hide.bs.tab",{relatedTarget:e}):null;p.trigger(e,"show.bs.tab",{relatedTarget:t}).defaultPrevented||i&&i.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){e&&(e.classList.add(An),this._activate(s(e)),this._queueCallback(()=>{"tab"===e.getAttribute("role")?(e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),p.trigger(e,"shown.bs.tab",{relatedTarget:t})):e.classList.add(Sn)},e,e.classList.contains(En)))}_deactivate(e,t){e&&(e.classList.remove(An),e.blur(),this._deactivate(s(e)),this._queueCallback(()=>{"tab"===e.getAttribute("role")?(e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),p.trigger(e,"hidden.bs.tab",{relatedTarget:t})):e.classList.remove(Sn)},e,e.classList.contains(En)))}_keydown(e){if(![bn,Cn,wn,_n].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=[Cn,_n].includes(e.key),i=$(this._getChildren().filter(e=>!o(e)),e.target,t,!0);i&&(i.focus({preventScroll:!0}),Dn.getOrCreateInstance(i).show())}_getChildren(){return h.find(xn,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const e of t)this._setInitialAttributesOnChild(e)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),i=this._getOuterElement(e);e.setAttribute("aria-selected",t),i!==e&&this._setAttributeIfNotExists(i,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=s(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`#${e.id}`))}_toggleDropDown(e,n){const r=this._getOuterElement(e);if(!r.classList.contains("dropdown"))return;const t=(e,t)=>{const i=h.findOne(e,r);i&&i.classList.toggle(t,n)};t(".dropdown-toggle",An),t(".dropdown-menu",Sn),r.setAttribute("aria-expanded",n)}_setAttributeIfNotExists(e,t,i){e.hasAttribute(t)||e.setAttribute(t,i)}_elemIsActive(e){return e.classList.contains(An)}_getInnerElement(e){return e.matches(xn)?e:h.findOne(xn,e)}_getOuterElement(e){return e.closest(".nav-item, .list-group-item")||e}static jQueryInterface(t){return this.each(function(){const e=Dn.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}})}}p.on(document,"click.bs.tab",Tn,function(e){["A","AREA"].includes(this.tagName)&&e.preventDefault(),o(this)||Dn.getOrCreateInstance(this).show()}),p.on(window,"load.bs.tab",()=>{for(const e of h.find('.active[data-bs-toggle="tab"], .active[data-bs-toggle="pill"], .active[data-bs-toggle="list"]'))Dn.getOrCreateInstance(e)}),e(Dn);const Rn="hide",Mn="show",Nn="showing",On={animation:"boolean",autohide:"boolean",delay:"number"},In={animation:!0,autohide:!0,delay:5e3};class Pn extends t{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return In}static get DefaultType(){return On}static get NAME(){return"toast"}show(){p.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(Rn),E(this._element),this._element.classList.add(Mn,Nn),this._queueCallback(()=>{this._element.classList.remove(Nn),p.trigger(this._element,"shown.bs.toast"),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(p.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add(Nn),this._queueCallback(()=>{this._element.classList.add(Rn),this._element.classList.remove(Nn,Mn),p.trigger(this._element,"hidden.bs.toast")},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Mn),super.dispose()}isShown(){return this._element.classList.contains(Mn)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":this._hasMouseInteraction=t;break;case"focusin":case"focusout":this._hasKeyboardInteraction=t}if(t)return void this._clearTimeout();const i=e.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){p.on(this._element,"mouseover.bs.toast",e=>this._onInteraction(e,!0)),p.on(this._element,"mouseout.bs.toast",e=>this._onInteraction(e,!1)),p.on(this._element,"focusin.bs.toast",e=>this._onInteraction(e,!0)),p.on(this._element,"focusout.bs.toast",e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each(function(){const e=Pn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](this)}})}}return oe(Pn),e(Pn),{Alert:ae,Button:ce,Carousel:De,Collapse:ke,Dropdown:m,Modal:Pi,Offcanvas:v,Popover:hn,ScrollSpy:yn,Tab:Dn,Toast:Pn,Tooltip:cn}});!function(s,L,F,d){"use strict";function G(e,t,i){return setTimeout(H(e,i),t)}function n(e,t,i){return Array.isArray(e)?(o(e,i[t],i),!0):!1}function o(e,t,i){var n;if(e)if(e.forEach)e.forEach(t,i);else if(e.length!==d)for(n=0;n<e.length;)t.call(i,e[n],n,e),n++;else for(n in e)e.hasOwnProperty(n)&&t.call(i,e[n],n,e)}function $(n,e,t){var r="DEPRECATED METHOD: "+e+"\n"+t+" AT \n";return function(){var e=new Error("get-stack-trace"),t=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",i=s.console&&(s.console.warn||s.console.log);return i&&i.call(s.console,r,t),n.apply(this,arguments)}}function e(e,t,i){var n,r=t.prototype;n=e.prototype=Object.create(r),n.constructor=e,n._super=r,i&&p(n,i)}function H(e,t){return function(){return e.apply(t,arguments)}}function B(e,t){return typeof e==Le?e.apply(t?t[0]||d:d,t):e}function V(e,t){return e===d?t:e}function t(t,e,i){o(z(e),function(e){t.addEventListener(e,i,!1)})}function i(t,e,i){o(z(e),function(e){t.removeEventListener(e,i,!1)})}function W(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function u(e,t){return e.indexOf(t)>-1}function z(e){return e.trim().split(/\s+/g)}function l(e,t,i){if(e.indexOf&&!i)return e.indexOf(t);for(var n=0;n<e.length;){if(i&&e[n][i]==t||!i&&e[n]===t)return n;n++}return-1}function j(e){return Array.prototype.slice.call(e,0)}function U(e,i,t){for(var n=[],r=[],s=0;s<e.length;){var o=i?e[s][i]:e[s];l(r,o)<0&&n.push(e[s]),r[s]=o,s++}return t&&(n=i?n.sort(function(e,t){return e[i]>t[i]}):n.sort()),n}function Y(e,t){for(var i,n,r=t[0].toUpperCase()+t.slice(1),s=0;s<Pe.length;){if(i=Pe[s],n=i?i+r:t,n in e)return n;s++}return d}function q(){return He++}function K(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||s}function r(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){B(t.options.enable,[t])&&i.handler(e)},this.init()}function X(e){var t,i=e.options.inputClass;return new(t=i?i:We?ue:ze?pe:Ve?ge:ce)(e,Q)}function Q(e,t,i){var n=i.pointers.length,r=i.changedPointers.length,s=t&v&&n-r===0,o=t&(b|C)&&n-r===0;i.isFirst=!!s,i.isFinal=!!o,s&&(e.session={}),i.eventType=t,Z(e,i),e.emit("hammer.input",i),e.recognize(i),e.session.prevInput=i}function Z(e,t){var i=e.session,n=t.pointers,r=n.length;i.firstInput||(i.firstInput=te(t)),r>1&&!i.firstMultiple?i.firstMultiple=te(t):1===r&&(i.firstMultiple=!1);var s=i.firstInput,o=i.firstMultiple,a=o?o.center:s.center,l=t.center=ie(n);t.timeStamp=Fe(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=oe(a,l),t.distance=se(a,l),J(i,t),t.offsetDirection=re(t.deltaX,t.deltaY);var c=ne(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=g(c.x)>g(c.y)?c.x:c.y,t.scale=o?le(o.pointers,n):1,t.rotation=o?ae(o.pointers,n):0,t.maxPointers=i.prevInput?t.pointers.length>i.prevInput.maxPointers?t.pointers.length:i.prevInput.maxPointers:t.pointers.length,ee(i,t);var u=e.element;W(t.srcEvent.target,u)&&(u=t.srcEvent.target),t.target=u}function J(e,t){var i=t.center,n=e.offsetDelta||{},r=e.prevDelta||{},s=e.prevInput||{};t.eventType!==v&&s.eventType!==b||(r=e.prevDelta={x:s.deltaX||0,y:s.deltaY||0},n=e.offsetDelta={x:i.x,y:i.y}),t.deltaX=r.x+(i.x-n.x),t.deltaY=r.y+(i.y-n.y)}function ee(e,t){var i,n,r,s,o=e.lastInterval||t,a=t.timeStamp-o.timeStamp;if(t.eventType!=C&&(a>qe||o.velocity===d)){var l=t.deltaX-o.deltaX,c=t.deltaY-o.deltaY,u=ne(a,l,c);n=u.x,r=u.y,i=g(u.x)>g(u.y)?u.x:u.y,s=re(l,c),e.lastInterval=t}else i=o.velocity,n=o.velocityX,r=o.velocityY,s=o.direction;t.velocity=i,t.velocityX=n,t.velocityY=r,t.direction=s}function te(e){for(var t=[],i=0;i<e.pointers.length;)t[i]={clientX:f(e.pointers[i].clientX),clientY:f(e.pointers[i].clientY)},i++;return{timeStamp:Fe(),pointers:t,center:ie(t),deltaX:e.deltaX,deltaY:e.deltaY}}function ie(e){var t=e.length;if(1===t)return{x:f(e[0].clientX),y:f(e[0].clientY)};for(var i=0,n=0,r=0;t>r;)i+=e[r].clientX,n+=e[r].clientY,r++;return{x:f(i/t),y:f(n/t)}}function ne(e,t,i){return{x:t/e||0,y:i/e||0}}function re(e,t){return e===t?Ke:g(e)>=g(t)?0>e?w:_:0>t?A:E}function se(e,t,i){i||(i=Qe);var n=t[i[0]]-e[i[0]],r=t[i[1]]-e[i[1]];return Math.sqrt(n*n+r*r)}function oe(e,t,i){i||(i=Qe);var n=t[i[0]]-e[i[0]],r=t[i[1]]-e[i[1]];return 180*Math.atan2(r,n)/Math.PI}function ae(e,t){return oe(t[1],t[0],Ze)+oe(e[1],e[0],Ze)}function le(e,t){return se(t[0],t[1],Ze)/se(e[0],e[1],Ze)}function ce(){this.evEl=et,this.evWin=tt,this.pressed=!1,r.apply(this,arguments)}function ue(){this.evEl=rt,this.evWin=st,r.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function de(){this.evTarget=at,this.evWin=lt,this.started=!1,r.apply(this,arguments)}function he(e,t){var i=j(e.touches),n=j(e.changedTouches);return t&(b|C)&&(i=U(i.concat(n),"identifier",!0)),[i,n]}function pe(){this.evTarget=ut,this.targetIds={},r.apply(this,arguments)}function fe(e,t){var i=j(e.touches),n=this.targetIds;if(t&(v|y)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var r,s,o=j(e.changedTouches),a=[],l=this.target;if(s=i.filter(function(e){return W(e.target,l)}),t===v)for(r=0;r<s.length;)n[s[r].identifier]=!0,r++;for(r=0;r<o.length;)n[o[r].identifier]&&a.push(o[r]),t&(b|C)&&delete n[o[r].identifier],r++;return a.length?[U(s.concat(a),"identifier",!0),a]:void 0}function ge(){r.apply(this,arguments);var e=H(this.handler,this);this.touch=new pe(this.manager,e),this.mouse=new ce(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function me(e,t){e&v?(this.primaryTouch=t.changedPointers[0].identifier,ve.call(this,t)):e&(b|C)&&ve.call(this,t)}function ve(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var i={x:t.clientX,y:t.clientY};this.lastTouches.push(i);var n=this.lastTouches,r=function(){var e=n.indexOf(i);e>-1&&n.splice(e,1)};setTimeout(r,dt)}}function ye(e){for(var t=e.srcEvent.clientX,i=e.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var r=this.lastTouches[n],s=Math.abs(t-r.x),o=Math.abs(i-r.y);if(ht>=s&&ht>=o)return!0}return!1}function be(e,t){this.manager=e,this.set(t)}function Ce(e){if(u(e,x))return x;var t=u(e,D),i=u(e,R);return t&&i?x:t||i?t?D:R:u(e,vt)?vt:mt}function we(){if(!ft)return!1;var t={},i=s.CSS&&s.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(e){t[e]=i?s.CSS.supports("touch-action",e):!0}),t}function a(e){this.options=p({},this.defaults,e||{}),this.id=q(),this.manager=null,this.options.enable=V(this.options.enable,!0),this.state=bt,this.simultaneous={},this.requireFail=[]}function _e(e){return e&P?"cancel":e&O?"end":e&N?"move":e&M?"start":""}function Ae(e){return e==E?"down":e==A?"up":e==w?"left":e==_?"right":""}function Ee(e,t){var i=t.manager;return i?i.get(e):e}function c(){a.apply(this,arguments)}function Se(){c.apply(this,arguments),this.pX=null,this.pY=null}function Te(){c.apply(this,arguments)}function xe(){a.apply(this,arguments),this._timer=null,this._input=null}function De(){c.apply(this,arguments)}function Re(){c.apply(this,arguments)}function Me(){a.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function h(e,t){return t=t||{},t.recognizers=V(t.recognizers,h.defaults.preset),new Ne(e,t)}function Ne(e,t){this.options=p({},h.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=X(this),this.touchAction=new be(this,this.options.touchAction),Oe(this,!0),o(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function Oe(i,n){var r=i.element;if(r.style){var s;o(i.options.cssProps,function(e,t){s=Y(r.style,t),n?(i.oldCssProps[s]=r.style[s],r.style[s]=e):r.style[s]=i.oldCssProps[s]||""}),n||(i.oldCssProps={})}}function Ie(e,t){var i=L.createEvent("Event");i.initEvent(e,!0,!0),i.gesture=t,t.target.dispatchEvent(i)}var p,Pe=["","webkit","Moz","MS","ms","o"],ke=L.createElement("div"),Le="function",f=Math.round,g=Math.abs,Fe=Date.now;p="function"!=typeof Object.assign?function(e){if(e===d||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==d&&null!==n)for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}return t}:Object.assign;var Ge=$(function(e,t,i){for(var n=Object.keys(t),r=0;r<n.length;)(!i||i&&e[n[r]]===d)&&(e[n[r]]=t[n[r]]),r++;return e},"extend","Use `assign`."),$e=$(function(e,t){return Ge(e,t,!0)},"merge","Use `assign`."),He=1,Be=/mobile|tablet|ip(ad|hone|od)|android/i,Ve="ontouchstart"in s,We=Y(s,"PointerEvent")!==d,ze=Ve&&Be.test(navigator.userAgent),m="touch",je="pen",Ue="mouse",Ye="kinect",qe=25,v=1,y=2,b=4,C=8,Ke=1,w=2,_=4,A=8,E=16,S=w|_,T=A|E,Xe=S|T,Qe=["x","y"],Ze=["clientX","clientY"];r.prototype={handler:function(){},init:function(){this.evEl&&t(this.element,this.evEl,this.domHandler),this.evTarget&&t(this.target,this.evTarget,this.domHandler),this.evWin&&t(K(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&i(this.element,this.evEl,this.domHandler),this.evTarget&&i(this.target,this.evTarget,this.domHandler),this.evWin&&i(K(this.element),this.evWin,this.domHandler)}};var Je={mousedown:v,mousemove:y,mouseup:b},et="mousedown",tt="mousemove mouseup";e(ce,r,{handler:function(e){var t=Je[e.type];t&v&&0===e.button&&(this.pressed=!0),t&y&&1!==e.which&&(t=b),this.pressed&&(t&b&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:Ue,srcEvent:e}))}});var it={pointerdown:v,pointermove:y,pointerup:b,pointercancel:C,pointerout:C},nt={2:m,3:je,4:Ue,5:Ye},rt="pointerdown",st="pointermove pointerup pointercancel";s.MSPointerEvent&&!s.PointerEvent&&(rt="MSPointerDown",st="MSPointerMove MSPointerUp MSPointerCancel"),e(ue,r,{handler:function(e){var t=this.store,i=!1,n=e.type.toLowerCase().replace("ms",""),r=it[n],s=nt[e.pointerType]||e.pointerType,o=s==m,a=l(t,e.pointerId,"pointerId");r&v&&(0===e.button||o)?0>a&&(t.push(e),a=t.length-1):r&(b|C)&&(i=!0),0>a||(t[a]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:s,srcEvent:e}),i&&t.splice(a,1))}});var ot={touchstart:v,touchmove:y,touchend:b,touchcancel:C},at="touchstart",lt="touchstart touchmove touchend touchcancel";e(de,r,{handler:function(e){var t=ot[e.type];if(t===v&&(this.started=!0),this.started){var i=he.call(this,e,t);t&(b|C)&&i[0].length-i[1].length===0&&(this.started=!1),this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:m,srcEvent:e})}}});var ct={touchstart:v,touchmove:y,touchend:b,touchcancel:C},ut="touchstart touchmove touchend touchcancel";e(pe,r,{handler:function(e){var t=ct[e.type],i=fe.call(this,e,t);i&&this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:m,srcEvent:e})}});var dt=2500,ht=25;e(ge,r,{handler:function(e,t,i){var n=i.pointerType==m,r=i.pointerType==Ue;if(!(r&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)me.call(this,t,i);else if(r&&ye.call(this,i))return;this.callback(e,t,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var pt=Y(ke.style,"touchAction"),ft=pt!==d,gt="compute",mt="auto",vt="manipulation",x="none",D="pan-x",R="pan-y",yt=we();be.prototype={set:function(e){e==gt&&(e=this.compute()),ft&&this.manager.element.style&&yt[e]&&(this.manager.element.style[pt]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return o(this.manager.recognizers,function(e){B(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),Ce(t.join(" "))},preventDefaults:function(e){var t=e.srcEvent,i=e.offsetDirection;if(this.manager.session.prevented)return void t.preventDefault();var n=this.actions,r=u(n,x)&&!yt[x],s=u(n,R)&&!yt[R],o=u(n,D)&&!yt[D];if(r){var a=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(a&&l&&c)return}return o&&s?void 0:r||s&&i&S||o&&i&T?this.preventSrc(t):void 0},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var bt=1,M=2,N=4,O=8,I=O,P=16,k=32;a.prototype={defaults:{},set:function(e){return p(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(n(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=Ee(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return n(e,"dropRecognizeWith",this)?this:(e=Ee(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(n(e,"requireFailure",this))return this;var t=this.requireFail;return e=Ee(e,this),-1===l(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(n(e,"dropRequireFailure",this))return this;e=Ee(e,this);var t=l(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(t){function e(e){i.manager.emit(e,t)}var i=this,n=this.state;O>n&&e(i.options.event+_e(n)),e(i.options.event),t.additionalEvent&&e(t.additionalEvent),n>=O&&e(i.options.event+_e(n))},tryEmit:function(e){return this.canEmit()?this.emit(e):void(this.state=k)},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(k|bt)))return!1;e++}return!0},recognize:function(e){var t=p({},e);return B(this.options.enable,[this,t])?(this.state&(I|P|k)&&(this.state=bt),this.state=this.process(t),void(this.state&(M|N|O|P)&&this.tryEmit(t))):(this.reset(),void(this.state=k))},process:function(e){},getTouchAction:function(){},reset:function(){}},e(c,a,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,i=e.eventType,n=t&(M|N),r=this.attrTest(e);return n&&(i&C||!r)?t|P:n||r?i&b?t|O:t&M?t|N:M:k}}),e(Se,c,{defaults:{event:"pan",threshold:10,pointers:1,direction:Xe},getTouchAction:function(){var e=this.options.direction,t=[];return e&S&&t.push(R),e&T&&t.push(D),t},directionTest:function(e){var t=this.options,i=!0,n=e.distance,r=e.direction,s=e.deltaX,o=e.deltaY;return r&t.direction||(t.direction&S?(r=0===s?Ke:0>s?w:_,i=s!=this.pX,n=Math.abs(e.deltaX)):(r=0===o?Ke:0>o?A:E,i=o!=this.pY,n=Math.abs(e.deltaY))),e.direction=r,i&&n>t.threshold&&r&t.direction},attrTest:function(e){return c.prototype.attrTest.call(this,e)&&(this.state&M||!(this.state&M)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Ae(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),e(Te,c,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[x]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&M)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),e(xe,a,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[mt]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!n||!i||e.eventType&(b|C)&&!r)this.reset();else if(e.eventType&v)this.reset(),this._timer=G(function(){this.state=I,this.tryEmit()},t.time,this);else if(e.eventType&b)return I;return k},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===I&&(e&&e.eventType&b?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=Fe(),this.manager.emit(this.options.event,this._input)))}}),e(De,c,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[x]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&M)}}),e(Re,c,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:S|T,pointers:1},getTouchAction:function(){return Se.prototype.getTouchAction.call(this)},attrTest:function(e){var t,i=this.options.direction;return i&(S|T)?t=e.overallVelocity:i&S?t=e.overallVelocityX:i&T&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&i&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&g(t)>this.options.velocity&&e.eventType&b},emit:function(e){var t=Ae(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),e(Me,a,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[vt]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),e.eventType&v&&0===this.count)return this.failTimeout();if(n&&r&&i){if(e.eventType!=b)return this.failTimeout();var s=this.pTime?e.timeStamp-this.pTime<t.interval:!0,o=!this.pCenter||se(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,o&&s?this.count+=1:this.count=1,this._input=e;var a=this.count%t.taps;if(0===a)return this.hasRequireFailures()?(this._timer=G(function(){this.state=I,this.tryEmit()},t.interval,this),M):I}return k},failTimeout:function(){return this._timer=G(function(){this.state=k},this.options.interval,this),k},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==I&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),h.VERSION="2.0.7",h.defaults={domEvents:!1,touchAction:gt,enable:!0,inputTarget:null,inputClass:null,preset:[[De,{enable:!1}],[Te,{enable:!1},["rotate"]],[Re,{direction:S}],[Se,{direction:S},["swipe"]],[Me],[Me,{event:"doubletap",taps:2},["tap"]],[xe]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Ct=1,wt=2;Ne.prototype={set:function(e){return p(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?wt:Ct},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var i,n=this.recognizers,r=t.curRecognizer;(!r||r&&r.state&I)&&(r=t.curRecognizer=null);for(var s=0;s<n.length;)i=n[s],t.stopped===wt||r&&i!=r&&!i.canRecognizeWith(r)?i.reset():i.recognize(e),!r&&i.state&(M|N|O)&&(r=t.curRecognizer=i),s++}},get:function(e){if(e instanceof a)return e;for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i];return null},add:function(e){if(n(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(n(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,i=l(t,e);-1!==i&&(t.splice(i,1),this.touchAction.update())}return this},on:function(e,t){if(e!==d&&t!==d){var i=this.handlers;return o(z(e),function(e){i[e]=i[e]||[],i[e].push(t)}),this}},off:function(e,t){if(e!==d){var i=this.handlers;return o(z(e),function(e){t?i[e]&&i[e].splice(l(i[e],t),1):delete i[e]}),this}},emit:function(e,t){this.options.domEvents&&Ie(e,t);var i=this.handlers[e]&&this.handlers[e].slice();if(i&&i.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](t),n++}},destroy:function(){this.element&&Oe(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},p(h,{INPUT_START:v,INPUT_MOVE:y,INPUT_END:b,INPUT_CANCEL:C,STATE_POSSIBLE:bt,STATE_BEGAN:M,STATE_CHANGED:N,STATE_ENDED:O,STATE_RECOGNIZED:I,STATE_CANCELLED:P,STATE_FAILED:k,DIRECTION_NONE:Ke,DIRECTION_LEFT:w,DIRECTION_RIGHT:_,DIRECTION_UP:A,DIRECTION_DOWN:E,DIRECTION_HORIZONTAL:S,DIRECTION_VERTICAL:T,DIRECTION_ALL:Xe,Manager:Ne,Input:r,TouchAction:be,TouchInput:pe,MouseInput:ce,PointerEventInput:ue,TouchMouseInput:ge,SingleTouchInput:de,Recognizer:a,AttrRecognizer:c,Tap:Me,Pan:Se,Swipe:Re,Pinch:Te,Rotate:De,Press:xe,on:t,off:i,each:o,merge:$e,extend:Ge,assign:p,inherit:e,bindFn:H,prefixed:Y});var _t="undefined"!=typeof s?s:"undefined"!=typeof self?self:{};_t.Hammer=h,"function"==typeof define&&define.amd?define(function(){return h}):"undefined"!=typeof module&&module.exports?module.exports=h:s[F]=h}(window,document,"Hammer");!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Chart=t()}(this,function(){"use strict";var n=Object.freeze({__proto__:null,get Colors(){return Xs},get Decimation(){return Js},get Filler(){return vo},get Legend(){return wo},get SubTitle(){return So},get Title(){return Ao},get Tooltip(){return Go}});function e(){}const G=(()=>{let e=0;return()=>e++})();function x(e){return null==e}function M(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function N(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function f(e){return("number"==typeof e||e instanceof Number)&&isFinite(+e)}function g(e,t){return f(e)?e:t}function O(e,t){return void 0===e?t:e}const $=(e,t)=>"string"==typeof e&&e.endsWith("%")?parseFloat(e)/100:+e/t,H=(e,t)=>"string"==typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function p(e,t,i){if(e&&"function"==typeof e.call)return e.apply(i,t)}function E(e,t,i,n){let r,s,o;if(M(e))if(s=e.length,n)for(r=s-1;r>=0;r--)t.call(i,e[r],r);else for(r=0;r<s;r++)t.call(i,e[r],r);else if(N(e))for(o=Object.keys(e),s=o.length,r=0;r<s;r++)t.call(i,e[o[r]],o[r])}function B(e,t){let i,n,r,s;if(!e||!t||e.length!==t.length)return!1;for(i=0,n=e.length;i<n;++i)if(r=e[i],s=t[i],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function V(r){if(M(r))return r.map(V);if(N(r)){const e=Object.create(null),t=Object.keys(r),i=t.length;let n=0;for(;n<i;++n)e[t[n]]=V(r[t[n]]);return e}return r}function W(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function z(e,t,i,n){if(!W(e))return;const r=t[e],s=i[e];N(r)&&N(s)?j(r,s,n):t[e]=V(s)}function j(i,e,n){const t=M(e)?e:[e],r=t.length;if(!N(i))return i;const s=(n=n||{}).merger||z;let o;for(let e=0;e<r;++e){if(o=t[e],!N(o))continue;const M=Object.keys(o);for(let e=0,t=M.length;e<t;++e)s(M[e],i,o,n)}return i}function U(e,t){return j(e,t,{merger:s})}function s(e,t,i){if(!W(e))return;const n=t[e],r=i[e];N(n)&&N(r)?U(n,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=V(r))}const Y={"":e=>e,x:e=>e.x,y:e=>e.y};function q(e){const t=e.split("."),i=[];let n="";for(const e of t)n+=e,n.endsWith("\\")?n=n.slice(0,-1)+".":(i.push(n),n="");return i}function m(e,t){const i=Y[t]||(Y[t]=function(e){const i=q(e);return t=>{for(const e of i){if(""===e)break;t=t&&t[e]}return t}}(t));return i(e)}function K(e){return e.charAt(0).toUpperCase()+e.slice(1)}const X=e=>void 0!==e,l=e=>"function"==typeof e,Q=(t,i)=>{if(t.size!==i.size)return!1;for(const e of t)if(!i.has(e))return!1;return!0};function Z(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}const I=Math.PI,C=2*I,J=C+I,ee=Number.POSITIVE_INFINITY,te=I/180,P=I/2,ie=I/4,ne=2*I/3,c=Math.log10,v=Math.sign;function re(e,t,i){return Math.abs(e-t)<i}function se(e){const t=Math.round(e);e=re(e,t,e/1e3)?t:e;const i=Math.pow(10,Math.floor(c(e))),n=e/i;return(n<=1?1:n<=2?2:n<=5?5:10)*i}function oe(e){const t=[],i=Math.sqrt(e);let n;for(n=1;n<i;n++)e%n==0&&(t.push(n),t.push(e/n));return i===(0|i)&&t.push(i),t.sort((e,t)=>e-t).pop(),t}function ae(e){return!isNaN(parseFloat(e))&&isFinite(e)}function le(e,t){const i=Math.round(e);return i-t<=e&&i+t>=e}function ce(e,t,i){let n,r,s;for(n=0,r=e.length;n<r;n++)s=e[n][i],isNaN(s)||(t.min=Math.min(t.min,s),t.max=Math.max(t.max,s))}function k(e){return e*(I/180)}function ue(e){return e*(180/I)}function de(e){if(!f(e))return;let t=1,i=0;for(;Math.round(e*t)/t!==e;)t*=10,i++;return i}function he(e,t){const i=t.x-e.x,n=t.y-e.y,r=Math.sqrt(i*i+n*n);let s=Math.atan2(n,i);return s<-.5*I&&(s+=C),{angle:s,distance:r}}function pe(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function fe(e,t){return(e-t+J)%C-I}function y(e){return(e%C+C)%C}function ge(e,t,i,n){const r=y(e),s=y(t),o=y(i),a=y(s-r),l=y(o-r),c=y(r-s),u=y(r-o);return r===s||r===o||n&&s===o||a>l&&c<u}function b(e,t,i){return Math.max(t,Math.min(i,e))}function me(e){return b(e,-32768,32767)}function w(e,t,i,n=1e-6){return e>=Math.min(t,i)-n&&e<=Math.max(t,i)+n}function ve(t,i,e){e=e||(e=>t[e]<i);let n,r=t.length-1,s=0;for(;r-s>1;)n=s+r>>1,e(n)?s=n:r=n;return{lo:s,hi:r}}const _=(i,n,r,e)=>ve(i,r,e?e=>{const t=i[e][n];return t<r||t===r&&i[e+1][n]===r}:e=>i[e][n]<r),ye=(t,i,n)=>ve(t,n,e=>t[e][i]>=n);function be(e,t,i){let n=0,r=e.length;for(;n<r&&e[n]<t;)n++;for(;r>n&&e[r-1]>i;)r--;return n>0||r<e.length?e.slice(n,r):e}const Ce=["push","pop","shift","splice","unshift"];function we(r,e){r._chartjs?r._chartjs.listeners.push(e):(Object.defineProperty(r,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Ce.forEach(e=>{const i="_onData"+K(e),n=r[e];Object.defineProperty(r,e,{configurable:!0,enumerable:!1,value(...t){const e=n.apply(this,t);return r._chartjs.listeners.forEach(e=>{"function"==typeof e[i]&&e[i](...t)}),e}})}))}function _e(t,e){const i=t._chartjs;if(!i)return;const n=i.listeners,r=n.indexOf(e);-1!==r&&n.splice(r,1),n.length>0||(Ce.forEach(e=>{delete t[e]}),delete t._chartjs)}function Ae(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const Ee="undefined"==typeof window?function(e){return e()}:window.requestAnimationFrame;function Se(t,i){let n=[],r=!1;return function(...e){n=e,r||(r=!0,Ee.call(window,()=>{r=!1,t.apply(i,n)}))}}function Te(t,i){let n;return function(...e){return i?(clearTimeout(n),n=setTimeout(t,i,e)):t.apply(this,e),i}}const xe=e=>"start"===e?"left":"end"===e?"right":"center",T=(e,t,i)=>"start"===e?t:"end"===e?i:(t+i)/2,De=(e,t,i,n)=>e===(n?"left":"right")?i:"center"===e?(t+i)/2:t;function Re(a,l,c){const u=l.length;let d=0,h=u;if(a._sorted){const{iScale:e,_parsed:t}=a,i=e.axis,{min:n,max:r,minDefined:s,maxDefined:o}=e.getUserBounds();s&&(d=b(Math.min(_(t,e.axis,n).lo,c?u:_(l,i,e.getPixelForValue(n)).lo),0,u-1)),h=o?b(Math.max(_(t,e.axis,r,!0).hi+1,c?0:_(l,i,e.getPixelForValue(r),!0).hi+1),d,u)-d:u-d}return{start:d,count:h}}function Me(e){const{xScale:t,yScale:i,_scaleRanges:n}=e,r={xmin:t.min,xmax:t.max,ymin:i.min,ymax:i.max};if(!n)return e._scaleRanges=r,!0;const s=n.xmin!==t.min||n.xmax!==t.max||n.ymin!==i.min||n.ymax!==i.max;return Object.assign(n,r),s}class Ne{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,i,n,e){const r=i.listeners[e],s=i.duration;r.forEach(e=>e({chart:t,initial:i.initial,numSteps:s,currentStep:Math.min(n-i.start,s)}))}_refresh(){this._request||(this._running=!0,this._request=Ee.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(o=Date.now()){let a=0;this._charts.forEach((e,t)=>{if(!e.running||!e.items.length)return;const i=e.items;let n,r=i.length-1,s=!1;for(;r>=0;--r)n=i[r],n._active?(n._total>e.duration&&(e.duration=n._total),n.tick(o),s=!0):(i[r]=i[i.length-1],i.pop());s&&(t.draw(),this._notify(t,e,o,"progress")),i.length||(e.running=!1,this._notify(t,e,o,"complete"),e.initial=!1),a+=i.length}),this._lastDate=o,0===a&&(this._running=!1)}_getAnims(e){const t=this._charts;let i=t.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,i)),i}listen(e,t,i){this._getAnims(e).listeners[t].push(i)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((e,t)=>Math.max(e,t._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const i=t.items;let n=i.length-1;for(;n>=0;--n)i[n].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var u=new Ne;function Oe(e){return e+.5|0}const Ie=(e,t,i)=>Math.max(Math.min(e,i),t);function Pe(e){return Ie(Oe(2.55*e),0,255)}function ke(e){return Ie(Oe(255*e),0,255)}function o(e){return Ie(Oe(e/2.55)/100,0,1)}function Le(e){return Ie(Oe(100*e),0,100)}const a={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Fe=[..."0123456789ABCDEF"],Ge=e=>Fe[15&e],$e=e=>Fe[(240&e)>>4]+Fe[15&e],He=e=>(240&e)>>4==(15&e);function Be(e){var t=(e=>He(e.r)&&He(e.g)&&He(e.b)&&He(e.a))(e)?Ge:$e;return e?"#"+t(e.r)+t(e.g)+t(e.b)+((e,t)=>e<255?t(e):"")(e.a,t):void 0}const Ve=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function We(i,e,n){const r=e*Math.min(n,1-n),t=(e,t=(e+i/30)%12)=>n-r*Math.max(Math.min(t-3,9-t,1),-1);return[t(0),t(8),t(4)]}function ze(i,n,r){const e=(e,t=(e+i/60)%6)=>r-r*n*Math.max(Math.min(t,4-t,1),0);return[e(5),e(3),e(1)]}function je(e,t,i){const n=We(e,1,.5);let r;for(t+i>1&&(r=1/(t+i),t*=r,i*=r),r=0;r<3;r++)n[r]*=1-t-i,n[r]+=t;return n}function Ue(e){const t=e.r/255,i=e.g/255,n=e.b/255,r=Math.max(t,i,n),s=Math.min(t,i,n),o=(r+s)/2;let a,l,c;return r!==s&&(c=r-s,l=o>.5?c/(2-r-s):c/(r+s),a=function(e,t,i,n,r){return e===r?(t-i)/n+(t<i?6:0):t===r?(i-e)/n+2:(e-t)/n+4}(t,i,n,c,r),a=60*a+.5),[0|a,l||0,o]}function Ye(e,t,i,n){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,i,n)).map(ke)}function qe(e,t,i){return Ye(We,e,t,i)}function Ke(e){return(e%360+360)%360}function Xe(e){const t=Ve.exec(e);let i,n=255;if(!t)return;t[5]!==i&&(n=t[6]?Pe(+t[5]):ke(+t[5]));const r=Ke(+t[2]),s=+t[3]/100,o=+t[4]/100;return i="hwb"===t[1]?function(e,t,i){return Ye(je,e,t,i)}(r,s,o):"hsv"===t[1]?function(e,t,i){return Ye(ze,e,t,i)}(r,s,o):qe(r,s,o),{r:i[0],g:i[1],b:i[2],a:n}}const Qe={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Ze={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Je;function et(e){Je||(Je=function(){const e={},t=Object.keys(Ze),i=Object.keys(Qe);let n,r,s,o,a;for(n=0;n<t.length;n++){for(o=a=t[n],r=0;r<i.length;r++)s=i[r],a=a.replace(s,Qe[s]);s=parseInt(Ze[o],16),e[a]=[s>>16&255,s>>8&255,255&s]}return e}(),Je.transparent=[0,0,0,0]);const t=Je[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}const tt=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const it=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,nt=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function rt(t,i,n){if(t){let e=Ue(t);e[i]=Math.max(0,Math.min(e[i]+e[i]*n,0===i?360:1)),e=qe(e),t.r=e[0],t.g=e[1],t.b=e[2]}}function st(e,t){return e?Object.assign(t||{},e):e}function ot(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=ke(e[3]))):(t=st(e,{r:0,g:0,b:0,a:1})).a=ke(t.a),t}function at(e){return"r"===e.charAt(0)?function(e){const t=tt.exec(e);let i,n,r,s=255;if(t){if(t[7]!==i){const e=+t[7];s=t[8]?Pe(e):Ie(255*e,0,255)}return i=+t[1],n=+t[3],r=+t[5],i=255&(t[2]?Pe(i):Ie(i,0,255)),n=255&(t[4]?Pe(n):Ie(n,0,255)),r=255&(t[6]?Pe(r):Ie(r,0,255)),{r:i,g:n,b:r,a:s}}}(e):Xe(e)}class lt{constructor(e){if(e instanceof lt)return e;const t=typeof e;let i;var n,r,s;"object"===t?i=ot(e):"string"===t&&(s=(n=e).length,"#"===n[0]&&(4===s||5===s?r={r:255&17*a[n[1]],g:255&17*a[n[2]],b:255&17*a[n[3]],a:5===s?17*a[n[4]]:255}:7!==s&&9!==s||(r={r:a[n[1]]<<4|a[n[2]],g:a[n[3]]<<4|a[n[4]],b:a[n[5]]<<4|a[n[6]],a:9===s?a[n[7]]<<4|a[n[8]]:255})),i=r||et(e)||at(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=st(this._rgb);return e&&(e.a=o(e.a)),e}set rgb(e){this._rgb=ot(e)}rgbString(){return this._valid?(e=this._rgb)&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${o(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`):void 0;var e}hexString(){return this._valid?Be(this._rgb):void 0}hslString(){return this._valid?function(e){if(!e)return;const t=Ue(e),i=t[0],n=Le(t[1]),r=Le(t[2]);return e.a<255?`hsla(${i}, ${n}%, ${r}%, ${o(e.a)})`:`hsl(${i}, ${n}%, ${r}%)`}(this._rgb):void 0}mix(a,l){if(a){const e=this.rgb,t=a.rgb;let i;const n=l===i?.5:l,r=2*n-1,s=e.a-t.a,o=((r*s==-1?r:(r+s)/(1+r*s))+1)/2;i=1-o,e.r=255&o*e.r+i*t.r+.5,e.g=255&o*e.g+i*t.g+.5,e.b=255&o*e.b+i*t.b+.5,e.a=n*e.a+(1-n)*t.a,this.rgb=e}return this}interpolate(e,t){return e&&(this._rgb=function(e,t,i){const n=nt(o(e.r)),r=nt(o(e.g)),s=nt(o(e.b));return{r:ke(it(n+i*(nt(o(t.r))-n))),g:ke(it(r+i*(nt(o(t.g))-r))),b:ke(it(s+i*(nt(o(t.b))-s))),a:e.a+i*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}clone(){return new lt(this.rgb)}alpha(e){return this._rgb.a=ke(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=Oe(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return rt(this._rgb,2,e),this}darken(e){return rt(this._rgb,2,-e),this}saturate(e){return rt(this._rgb,1,e),this}desaturate(e){return rt(this._rgb,1,-e),this}rotate(e){return function(e,t){var i=Ue(e);i[0]=Ke(i[0]+t),i=qe(i),e.r=i[0],e.g=i[1],e.b=i[2]}(this._rgb,e),this}}function ct(t){if(t&&"object"==typeof t){const e=t.toString();return"[object CanvasPattern]"===e||"[object CanvasGradient]"===e}return!1}function ut(e){return ct(e)?e:new lt(e)}function dt(e){return ct(e)?e:new lt(e).saturate(.5).darken(.1).hexString()}const ht=["x","y","borderWidth","radius","tension"],pt=["color","borderColor","backgroundColor"];const ft=new Map;function gt(e,t,i){return function(e,t){t=t||{};const i=e+JSON.stringify(t);let n=ft.get(i);return n||(n=new Intl.NumberFormat(e,t),ft.set(i,n)),n}(t,i).format(e)}const mt={values:e=>M(e)?e:""+e,numeric(e,t,i){if(0===e)return"0";const n=this.chart.options.locale;let r,s=e;if(i.length>1){const t=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(t<1e-4||t>1e15)&&(r="scientific"),s=function(e,t){let i=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(i)>=1&&e!==Math.floor(e)&&(i=e-Math.floor(e));return i}(e,i)}const o=c(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),gt(e,n,l)},logarithmic(e,t,i){if(0===e)return"0";const n=i[t].significand||e/Math.pow(10,Math.floor(c(e)));return[1,2,3,5,10,15].includes(n)||t>.8*i.length?mt.numeric.call(this,e,t,i):""}};var vt={formatters:mt};const yt=Object.create(null),bt=Object.create(null);function Ct(i,e){if(!e)return i;const n=e.split(".");for(let t=0,e=n.length;t<e;++t){const e=n[t];i=i[e]||(i[e]=Object.create(null))}return i}function wt(e,t,i){return"string"==typeof t?j(Ct(e,t),i):j(Ct(e,""),t)}class _t{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>dt(t.backgroundColor),this.hoverBorderColor=(e,t)=>dt(t.borderColor),this.hoverColor=(e,t)=>dt(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return wt(this,e,t)}get(e){return Ct(this,e)}describe(e,t){return wt(bt,e,t)}override(e,t){return wt(yt,e,t)}route(e,t,i,n){const r=Ct(this,e),s=Ct(this,i),o="_"+t;Object.defineProperties(r,{[o]:{value:r[t],writable:!0},[t]:{enumerable:!0,get(){const e=this[o],t=s[n];return N(e)?Object.assign({},t,e):O(e,t)},set(e){this[o]=e}}})}apply(e){e.forEach(e=>e(this))}}var D=new _t({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),e.set("animations",{colors:{type:"color",properties:pt},numbers:{type:"number",properties:ht}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:vt.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e})}]);function At(){return"undefined"!=typeof window&&"undefined"!=typeof document}function Et(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function St(e,t,i){let n;return"string"==typeof e?(n=parseInt(e,10),-1!==e.indexOf("%")&&(n=n/100*t.parentNode[i])):n=e,n}const Tt=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function xt(e,t){return Tt(e).getPropertyValue(t)}const Dt=["top","right","bottom","left"];function Rt(i,n,r){const s={};r=r?"-"+r:"";for(let t=0;t<4;t++){const e=Dt[t];s[e]=parseFloat(i[n+"-"+e+r])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const Mt=(e,t,i)=>(e>0||t>0)&&(!i||!i.shadowRoot);function Nt(e,t){if("native"in e)return e;const{canvas:i,currentDevicePixelRatio:n}=t,r=Tt(i),s="border-box"===r.boxSizing,o=Rt(r,"padding"),a=Rt(r,"border","width"),{x:l,y:c,box:u}=function(e,t){const i=e.touches,n=i&&i.length?i[0]:e,{offsetX:r,offsetY:s}=n;let o,a,l=!1;if(Mt(r,s,e.target))o=r,a=s;else{const e=t.getBoundingClientRect();o=n.clientX-e.left,a=n.clientY-e.top,l=!0}return{x:o,y:a,box:l}}(e,i),d=o.left+(u&&a.left),h=o.top+(u&&a.top);let{width:p,height:f}=t;return s&&(p-=o.width+a.width,f-=o.height+a.height),{x:Math.round((l-d)/p*i.width/n),y:Math.round((c-h)/f*i.height/n)}}const Ot=e=>Math.round(10*e)/10;function It(e,t,i,n){const r=Tt(e),s=Rt(r,"margin"),o=St(r.maxWidth,e,"clientWidth")||ee,a=St(r.maxHeight,e,"clientHeight")||ee,l=function(r,s,o){let a,l;if(void 0===s||void 0===o){const n=Et(r);if(n){const r=n.getBoundingClientRect(),e=Tt(n),t=Rt(e,"border","width"),i=Rt(e,"padding");s=r.width-i.width-t.width,o=r.height-i.height-t.height,a=St(e.maxWidth,n,"clientWidth"),l=St(e.maxHeight,n,"clientHeight")}else s=r.clientWidth,o=r.clientHeight}return{width:s,height:o,maxWidth:a||ee,maxHeight:l||ee}}(e,t,i);let{width:c,height:u}=l;if("content-box"===r.boxSizing){const e=Rt(r,"border","width"),t=Rt(r,"padding");c-=t.width+e.width,u-=t.height+e.height}c=Math.max(0,c-s.width),u=Math.max(0,n?c/n:u-s.height),c=Ot(Math.min(c,o,l.maxWidth)),u=Ot(Math.min(u,a,l.maxHeight)),c&&!u&&(u=Ot(c/2));return(void 0!==t||void 0!==i)&&n&&l.height&&u>l.height&&(u=l.height,c=Ot(Math.floor(u*n))),{width:c,height:u}}function Pt(e,t,i){const n=t||1,r=Math.floor(e.height*n),s=Math.floor(e.width*n);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const o=e.canvas;return o.style&&(i||!o.style.height&&!o.style.width)&&(o.style.height=`${e.height}px`,o.style.width=`${e.width}px`),(e.currentDevicePixelRatio!==n||o.height!==r||o.width!==s)&&(e.currentDevicePixelRatio=n,o.height=r,o.width=s,e.ctx.setTransform(n,0,0,n,0,0),!0)}const kt=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(t){}return t}();function Lt(e,t){const i=xt(e,t),n=i&&i.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function Ft(e){return!e||x(e.size)||x(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function Gt(e,t,i,n,r){let s=t[r];return s||(s=t[r]=e.measureText(r).width,i.push(r)),s>n&&(n=s),n}function $t(e,t,i,n){let r=(n=n||{}).data=n.data||{},s=n.garbageCollect=n.garbageCollect||[];n.font!==t&&(r=n.data={},s=n.garbageCollect=[],n.font=t),e.save(),e.font=t;let o=0;const a=i.length;let l,c,u,d,h;for(l=0;l<a;l++)if(d=i[l],null==d||M(d)){if(M(d))for(c=0,u=d.length;c<u;c++)h=d[c],null==h||M(h)||(o=Gt(e,r,s,o,h))}else o=Gt(e,r,s,o,d);e.restore();const p=s.length/2;if(p>i.length){for(l=0;l<p;l++)delete r[s[l]];s.splice(0,p)}return o}function Ht(e,t,i){const n=e.currentDevicePixelRatio,r=0!==i?Math.max(i/2,.5):0;return Math.round((t-r)*n)/n+r}function Bt(e,t){(t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore()}function Vt(e,t,i,n){Wt(e,t,i,n,null)}function Wt(e,t,i,n,r){let s,o,a,l,c,u,d,h;const p=t.pointStyle,f=t.rotation,g=t.radius;let m=(f||0)*te;if(p&&"object"==typeof p&&(s=p.toString(),"[object HTMLImageElement]"===s||"[object HTMLCanvasElement]"===s))return e.save(),e.translate(i,n),e.rotate(m),e.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),void e.restore();if(!(isNaN(g)||g<=0)){switch(e.beginPath(),p){default:r?e.ellipse(i,n,r/2,g,0,0,C):e.arc(i,n,g,0,C),e.closePath();break;case"triangle":u=r?r/2:g,e.moveTo(i+Math.sin(m)*u,n-Math.cos(m)*g),m+=ne,e.lineTo(i+Math.sin(m)*u,n-Math.cos(m)*g),m+=ne,e.lineTo(i+Math.sin(m)*u,n-Math.cos(m)*g),e.closePath();break;case"rectRounded":c=.516*g,l=g-c,o=Math.cos(m+ie)*l,d=Math.cos(m+ie)*(r?r/2-c:l),a=Math.sin(m+ie)*l,h=Math.sin(m+ie)*(r?r/2-c:l),e.arc(i-d,n-a,c,m-I,m-P),e.arc(i+h,n-o,c,m-P,m),e.arc(i+d,n+a,c,m,m+P),e.arc(i-h,n+o,c,m+P,m+I),e.closePath();break;case"rect":if(!f){l=Math.SQRT1_2*g,u=r?r/2:l,e.rect(i-u,n-l,2*u,2*l);break}m+=ie;case"rectRot":d=Math.cos(m)*(r?r/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(r?r/2:g),e.moveTo(i-d,n-a),e.lineTo(i+h,n-o),e.lineTo(i+d,n+a),e.lineTo(i-h,n+o),e.closePath();break;case"crossRot":m+=ie;case"cross":d=Math.cos(m)*(r?r/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(r?r/2:g),e.moveTo(i-d,n-a),e.lineTo(i+d,n+a),e.moveTo(i+h,n-o),e.lineTo(i-h,n+o);break;case"star":d=Math.cos(m)*(r?r/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(r?r/2:g),e.moveTo(i-d,n-a),e.lineTo(i+d,n+a),e.moveTo(i+h,n-o),e.lineTo(i-h,n+o),m+=ie,d=Math.cos(m)*(r?r/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(r?r/2:g),e.moveTo(i-d,n-a),e.lineTo(i+d,n+a),e.moveTo(i+h,n-o),e.lineTo(i-h,n+o);break;case"line":o=r?r/2:Math.cos(m)*g,a=Math.sin(m)*g,e.moveTo(i-o,n-a),e.lineTo(i+o,n+a);break;case"dash":e.moveTo(i,n),e.lineTo(i+Math.cos(m)*(r?r/2:g),n+Math.sin(m)*g);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function d(e,t,i){return i=i||.5,!t||e&&e.x>t.left-i&&e.x<t.right+i&&e.y>t.top-i&&e.y<t.bottom+i}function zt(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function jt(e){e.restore()}function Ut(e,t,i,n,r){if(!t)return e.lineTo(i.x,i.y);if("middle"===r){const n=(t.x+i.x)/2;e.lineTo(n,t.y),e.lineTo(n,i.y)}else"after"===r!=!!n?e.lineTo(t.x,i.y):e.lineTo(i.x,t.y);e.lineTo(i.x,i.y)}function Yt(e,t,i,n){if(!t)return e.lineTo(i.x,i.y);e.bezierCurveTo(n?t.cp1x:t.cp2x,n?t.cp1y:t.cp2y,n?i.cp2x:i.cp1x,n?i.cp2y:i.cp1y,i.x,i.y)}function qt(o,a,l,c,u){if(u.strikethrough||u.underline){const e=o.measureText(c),t=a-e.actualBoundingBoxLeft,i=a+e.actualBoundingBoxRight,n=l-e.actualBoundingBoxAscent,r=l+e.actualBoundingBoxDescent,s=u.strikethrough?(n+r)/2:r;o.strokeStyle=o.fillStyle,o.beginPath(),o.lineWidth=u.decorationWidth||2,o.moveTo(t,s),o.lineTo(i,s),o.stroke()}}function Kt(e,t){const i=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=i}function Xt(e,t,i,n,r,s={}){const o=M(t)?t:[t],a=s.strokeWidth>0&&""!==s.strokeColor;let l,c;for(e.save(),e.font=r.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),x(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,s),l=0;l<o.length;++l)c=o[l],s.backdrop&&Kt(e,s.backdrop),a&&(s.strokeColor&&(e.strokeStyle=s.strokeColor),x(s.strokeWidth)||(e.lineWidth=s.strokeWidth),e.strokeText(c,i,n,s.maxWidth)),e.fillText(c,i,n,s.maxWidth),qt(e,i,n,c,s),n+=Number(r.lineHeight);e.restore()}function Qt(e,t){const{x:i,y:n,w:r,h:s,radius:o}=t;e.arc(i+o.topLeft,n+o.topLeft,o.topLeft,-P,I,!0),e.lineTo(i,n+s-o.bottomLeft),e.arc(i+o.bottomLeft,n+s-o.bottomLeft,o.bottomLeft,I,P,!0),e.lineTo(i+r-o.bottomRight,n+s),e.arc(i+r-o.bottomRight,n+s-o.bottomRight,o.bottomRight,P,0,!0),e.lineTo(i+r,n+o.topRight),e.arc(i+r-o.topRight,n+o.topRight,o.topRight,0,-P,!0),e.lineTo(i+o.topLeft,n)}function Zt(i,n=[""],e,t,r=()=>i[0]){const s=e||i;void 0===t&&(t=ci("_fallback",i));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:i,_rootScopes:s,_fallback:t,_getTarget:r,override:e=>Zt([e,...i],n,s,t)};return new Proxy(o,{deleteProperty:(e,t)=>(delete e[t],delete e._keys,delete i[0][t],!0),get:(e,t)=>ni(e,t,()=>function(t,i,n,r){let s;for(const e of i)if(s=ci(ti(e,t),n),void 0!==s)return ii(t,s)?ai(n,r,t,s):s}(t,n,i,e)),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(i[0]),has:(e,t)=>ui(e).includes(t),ownKeys:e=>ui(e),set(e,t,i){const n=e._storage||(e._storage=r());return e[t]=n[t]=i,delete e._keys,!0}})}function Jt(n,t,i,r){const e={_cacheable:!1,_proxy:n,_context:t,_subProxy:i,_stack:new Set,_descriptors:ei(n,r),setContext:e=>Jt(n,e,i,r),override:e=>Jt(n.override(e),t,i,r)};return new Proxy(e,{deleteProperty:(e,t)=>(delete e[t],delete n[t],!0),get:(e,t,i)=>ni(e,t,()=>function(e,t,i){const{_proxy:n,_context:r,_subProxy:s,_descriptors:o}=e;let a=n[t];l(a)&&o.isScriptable(t)&&(a=function(e,t,i,n){const{_proxy:r,_context:s,_subProxy:o,_stack:a}=i;if(a.has(e))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+e);a.add(e);let l=t(s,o||n);a.delete(e),ii(e,l)&&(l=ai(r._scopes,r,e,l));return l}(t,a,e,i));M(a)&&a.length&&(a=function(e,t,i,n){const{_proxy:r,_context:s,_subProxy:o,_descriptors:a}=i;if(void 0!==s.index&&n(e))return t[s.index%t.length];if(N(t[0])){const i=t,n=r._scopes.filter(e=>e!==i);t=[];for(const N of i){const i=ai(n,r,e,N);t.push(Jt(i,s,o&&o[e],a))}}return t}(t,a,e,o.isIndexable));ii(t,a)&&(a=Jt(a,r,s&&s[t],o));return a}(e,t,i)),getOwnPropertyDescriptor:(e,t)=>e._descriptors.allKeys?Reflect.has(n,t)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,t),getPrototypeOf:()=>Reflect.getPrototypeOf(n),has:(e,t)=>Reflect.has(n,t),ownKeys:()=>Reflect.ownKeys(n),set:(e,t,i)=>(n[t]=i,delete e[t],!0)})}function ei(e,t={scriptable:!0,indexable:!0}){const{_scriptable:i=t.scriptable,_indexable:n=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:i,indexable:n,isScriptable:l(i)?i:()=>i,isIndexable:l(n)?n:()=>n}}const ti=(e,t)=>e?e+K(t):t,ii=(e,t)=>N(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function ni(e,t,i){if(Object.prototype.hasOwnProperty.call(e,t))return e[t];const n=i();return e[t]=n,n}function ri(e,t,i){return l(e)?e(t,i):e}const si=(e,t)=>!0===e?t:"string"==typeof e?m(t,e):void 0;function oi(t,i,n,r,s){for(const e of i){const i=si(n,e);if(i){t.add(i);const e=ri(i._fallback,n,s);if(void 0!==e&&e!==n&&e!==r)return e}else if(!1===i&&void 0!==r&&n!==r)return null}return!1}function ai(e,t,i,n){const r=t._rootScopes,s=ri(t._fallback,i,n),o=[...e,...r],a=new Set;a.add(n);let l=li(a,o,i,s||i,n);return null!==l&&((void 0===s||s===i||(l=li(a,o,s,l,n),null!==l))&&Zt(Array.from(a),[""],r,s,()=>function(e,t,i){const n=e._getTarget();t in n||(n[t]={});const r=n[t];if(M(r)&&N(i))return i;return r||{}}(t,i,n)))}function li(e,t,i,n,r){for(;i;)i=oi(e,t,i,n,r);return i}function ci(t,i){for(const e of i){if(!e)continue;const i=e[t];if(void 0!==i)return i}}function ui(e){let t=e._keys;return t||(t=e._keys=function(t){const i=new Set;for(const e of t)for(const t of Object.keys(e).filter(e=>!e.startsWith("_")))i.add(t);return Array.from(i)}(e._scopes)),t}function di(e,t,i,n){const{iScale:r}=e,{key:s="r"}=this._parsing,o=new Array(n);let a,l,c,u;for(a=0,l=n;a<l;++a)c=a+i,u=t[c],o[a]={r:r.parse(m(u,s),c)};return o}const hi=Number.EPSILON||1e-14,pi=(e,t)=>t<e.length&&!e[t].skip&&e[t],fi=e=>"x"===e?"y":"x";function gi(e,t,i,n){const r=e.skip?t:e,s=t,o=i.skip?t:i,a=pe(s,r),l=pe(o,s);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const d=n*c,h=n*u;return{previous:{x:s.x-d*(o.x-r.x),y:s.y-d*(o.y-r.y)},next:{x:s.x+h*(o.x-r.x),y:s.y+h*(o.y-r.y)}}}function mi(e,t="x"){const i=fi(t),n=e.length,r=Array(n).fill(0),s=Array(n);let o,a,l,c=pi(e,0);for(o=0;o<n;++o)if(a=l,l=c,c=pi(e,o+1),l){if(c){const e=c[t]-l[t];r[o]=0!==e?(c[i]-l[i])/e:0}s[o]=a?c?v(r[o-1])!==v(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}!function(t,i,n){const r=t.length;let s,o,a,l,c,u=pi(t,0);for(let e=0;e<r-1;++e)c=u,u=pi(t,e+1),c&&u&&(re(i[e],0,hi)?n[e]=n[e+1]=0:(s=n[e]/i[e],o=n[e+1]/i[e],l=Math.pow(s,2)+Math.pow(o,2),l<=9||(a=3/Math.sqrt(l),n[e]=s*a*i[e],n[e+1]=o*a*i[e])))}(e,r,s),function(i,n,r="x"){const s=fi(r),o=i.length;let a,l,c,u=pi(i,0);for(let t=0;t<o;++t){if(l=c,c=u,u=pi(i,t+1),!c)continue;const o=c[r],e=c[s];l&&(a=(o-l[r])/3,c[`cp1${r}`]=o-a,c[`cp1${s}`]=e-a*n[t]),u&&(a=(u[r]-o)/3,c[`cp2${r}`]=o+a,c[`cp2${s}`]=e+a*n[t])}}(e,s,t)}function vi(e,t,i){return Math.max(Math.min(e,i),t)}function yi(t,i,e,n,r){let s,o,a,l;if(i.spanGaps&&(t=t.filter(e=>!e.skip)),"monotone"===i.cubicInterpolationMode)mi(t,r);else{let e=n?t[t.length-1]:t[0];for(s=0,o=t.length;s<o;++s)a=t[s],l=gi(e,a,t[Math.min(s+1,o-(n?0:1))%o],i.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,e=a}i.capBezierPoints&&function(e,t){let i,n,r,s,o,a=d(e[0],t);for(i=0,n=e.length;i<n;++i)o=s,s=a,a=i<n-1&&d(e[i+1],t),s&&(r=e[i],o&&(r.cp1x=vi(r.cp1x,t.left,t.right),r.cp1y=vi(r.cp1y,t.top,t.bottom)),a&&(r.cp2x=vi(r.cp2x,t.left,t.right),r.cp2y=vi(r.cp2y,t.top,t.bottom)))}(t,e)}const bi=e=>0===e||1===e,Ci=(e,t,i)=>-Math.pow(2,10*(e-=1))*Math.sin((e-t)*C/i),wi=(e,t,i)=>Math.pow(2,-10*e)*Math.sin((e-t)*C/i)+1,_i={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*P),easeOutSine:e=>Math.sin(e*P),easeInOutSine:e=>-.5*(Math.cos(I*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>bi(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>bi(e)?e:Ci(e,.075,.3),easeOutElastic:e=>bi(e)?e:wi(e,.075,.3),easeInOutElastic(e){const t=.1125;return bi(e)?e:e<.5?.5*Ci(2*e,t,.45):.5+.5*wi(2*e-1,t,.45)},easeInBack(e){const t=1.70158;return e*e*((t+1)*e-t)},easeOutBack(e){const t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-_i.easeOutBounce(1-e),easeOutBounce(e){const t=7.5625,i=2.75;return e<1/i?t*e*e:e<2/i?t*(e-=1.5/i)*e+.75:e<2.5/i?t*(e-=2.25/i)*e+.9375:t*(e-=2.625/i)*e+.984375},easeInOutBounce:e=>e<.5?.5*_i.easeInBounce(2*e):.5*_i.easeOutBounce(2*e-1)+.5};function Ai(e,t,i,n){return{x:e.x+i*(t.x-e.x),y:e.y+i*(t.y-e.y)}}function Ei(e,t,i,n){return{x:e.x+i*(t.x-e.x),y:"middle"===n?i<.5?e.y:t.y:"after"===n?i<1?e.y:t.y:i>0?t.y:e.y}}function Si(e,t,i,n){const r={x:e.cp2x,y:e.cp2y},s={x:t.cp1x,y:t.cp1y},o=Ai(e,r,i),a=Ai(r,s,i),l=Ai(s,t,i),c=Ai(o,a,i),u=Ai(a,l,i);return Ai(c,u,i)}const Ti=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,xi=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Di(e,t){const i=(""+e).match(Ti);if(!i||"normal"===i[1])return 1.2*t;switch(e=+i[2],i[3]){case"px":return e;case"%":e/=100}return t*e}const Ri=e=>+e||0;function Mi(t,i){const e={},n=N(i),r=n?Object.keys(i):i,s=N(t)?n?e=>O(t[e],t[i[e]]):e=>t[e]:()=>t;for(const t of r)e[t]=Ri(s(t));return e}function Ni(e){return Mi(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Oi(e){return Mi(e,["topLeft","topRight","bottomLeft","bottomRight"])}function L(e){const t=Ni(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function R(e,t){e=e||{},t=t||D.font;let i=O(e.size,t.size);"string"==typeof i&&(i=parseInt(i,10));let n=O(e.style,t.style);n&&!(""+n).match(xi)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const r={family:O(e.family,t.family),lineHeight:Di(O(e.lineHeight,t.lineHeight),i),size:i,style:n,weight:O(e.weight,t.weight),string:""};return r.string=Ft(r),r}function Ii(e,t,i,n){let r,s,o,a=!0;for(r=0,s=e.length;r<s;++r)if(o=e[r],void 0!==o&&(void 0!==t&&"function"==typeof o&&(o=o(t),a=!1),void 0!==i&&M(o)&&(o=o[i%o.length],a=!1),void 0!==o))return n&&!a&&(n.cacheable=!1),o}function Pi(e,t,i){const{min:n,max:r}=e,s=H(t,(r-n)/2),o=(e,t)=>i&&0===e?0:e+t;return{min:o(n,-Math.abs(s)),max:o(r,s)}}function ki(e,t){return Object.assign(Object.create(e),t)}function Li(e,t,i){return e?function(t,i){return{x:e=>t+t+i-e,setWidth(e){i=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}}(t,i):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function Fi(e,t){let i,n;"ltr"!==t&&"rtl"!==t||(i=e.canvas.style,n=[i.getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",t,"important"),e.prevTextDirection=n)}function Gi(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function $i(e){return"angle"===e?{between:ge,compare:fe,normalize:y}:{between:w,compare:(e,t)=>e-t,normalize:e=>e}}function Hi({start:e,end:t,count:i,loop:n,style:r}){return{start:e%i,end:t%i,loop:n&&(t-e+1)%i==0,style:r}}function Bi(e,i,t){if(!t)return[e];const{property:n,start:r,end:s}=t,o=i.length,{compare:a,between:l,normalize:c}=$i(n),{start:u,end:d,loop:h,style:p}=function(e,t,i){const{property:n,start:r,end:s}=i,{between:o,normalize:a}=$i(n),l=t.length;let c,u,{start:d,end:h,loop:p}=e;if(p){for(d+=l,h+=l,c=0,u=l;c<u&&o(a(t[d%l][n]),r,s);++c)d--,h--;d%=l,h%=l}return h<d&&(h+=l),{start:d,end:h,loop:p,style:e.style}}(e,i,t),f=[];let g,m,v,y=!1,b=null;const C=()=>y||l(r,v,g)&&0!==a(r,v),w=()=>!y||0===a(s,g)||l(s,v,g);for(let e=u,t=u;e<=d;++e)m=i[e%o],m.skip||(g=c(m[n]),g!==v&&(y=l(g,r,s),null===b&&C()&&(b=0===a(g,r)?e:t),null!==b&&w()&&(f.push(Hi({start:b,end:e,loop:h,count:o,style:p})),b=null),t=e,v=g));return null!==b&&f.push(Hi({start:b,end:d,loop:h,count:o,style:p})),f}function Vi(i,n){const r=[],s=i.segments;for(let t=0;t<s.length;t++){const e=Bi(s[t],i.points,n);e.length&&r.push(...e)}return r}function Wi(e,t){const i=e.points,n=e.options.spanGaps,r=i.length;if(!r)return[];const s=!!e._loop,{start:o,end:a}=function(e,t,i,n){let r=0,s=t-1;if(i&&!n)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,i&&(s+=r);s>r&&e[s%t].skip;)s--;return s%=t,{start:r,end:s}}(i,r,s,n);if(!0===n)return zi(e,[{start:o,end:a,loop:s}],i,t);return zi(e,function(e,t,i,n){const r=e.length,s=[];let o,a=t,l=e[t];for(o=t+1;o<=i;++o){const i=e[o%r];i.skip||i.stop?l.skip||(n=!1,s.push({start:t%r,end:(o-1)%r,loop:n}),t=a=i.stop?o:null):(a=o,l.skip&&(t=o)),l=i}return null!==a&&s.push({start:t%r,end:a%r,loop:n}),s}(i,o,a<o?a+r:a,!!e._fullLoop&&0===o&&a===r-1),i,t)}function zi(e,t,i,n){return n&&n.setContext&&i?function(i,e,s,n){const r=i._chart.getContext(),t=ji(i.options),{_datasetIndex:o,options:{spanGaps:a}}=i,l=s.length,c=[];let u=t,d=e[0].start,h=d;function p(e,t,i,n){const r=a?-1:1;if(e!==t){for(e+=l;s[e%l].skip;)e-=r;for(;s[t%l].skip;)t+=r;e%l!=t%l&&(c.push({start:e%l,end:t%l,loop:i,style:n}),u=n,d=t%l)}}for(const i of e){d=a?d:i.start;let e,t=s[d%l];for(h=d+1;h<=i.end;h++){const a=s[h%l];e=ji(n.setContext(ki(r,{type:"segment",p0:t,p1:a,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:o}))),Ui(e,u)&&p(d,h-1,i.loop,u),t=a,u=e}d<h-1&&p(d,h-1,i.loop,u)}return c}(e,t,i,n):t}function ji(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Ui(e,t){if(!t)return!1;const i=[],n=function(e,t){return ct(t)?(i.includes(t)||i.push(t),i.indexOf(t)):t};return JSON.stringify(e,n)!==JSON.stringify(t,n)}var Yi=Object.freeze({__proto__:null,HALF_PI:P,INFINITY:ee,PI:I,PITAU:J,QUARTER_PI:ie,RAD_PER_DEG:te,TAU:C,TWO_THIRDS_PI:ne,_addGrace:Pi,_alignPixel:Ht,_alignStartEnd:T,_angleBetween:ge,_angleDiff:fe,_arrayUnique:Ae,_attachContext:Jt,_bezierCurveTo:Yt,_bezierInterpolation:Si,_boundSegment:Bi,_boundSegments:Vi,_capitalize:K,_computeSegments:Wi,_createResolver:Zt,_decimalPlaces:de,_deprecated:function(e,t,i,n){void 0!==t&&console.warn(e+': "'+i+'" is deprecated. Please use "'+n+'" instead')},_descriptors:ei,_elementsEqual:B,_factorize:oe,_filterBetween:be,_getParentNode:Et,_getStartAndCountOfVisiblePoints:Re,_int16Range:me,_isBetween:w,_isClickEvent:Z,_isDomSupported:At,_isPointInArea:d,_limitValue:b,_longestText:$t,_lookup:ve,_lookupByKey:_,_measureText:Gt,_merger:z,_mergerIf:s,_normalizeAngle:y,_parseObjectDataRadialScale:di,_pointInLine:Ai,_readValueToProps:Mi,_rlookupByKey:ye,_scaleRangesChanged:Me,_setMinAndMaxByKey:ce,_splitKey:q,_steppedInterpolation:Ei,_steppedLineTo:Ut,_textX:De,_toLeftRightCenter:xe,_updateBezierControlPoints:yi,addRoundedRectPath:Qt,almostEquals:re,almostWhole:le,callback:p,clearCanvas:Bt,clipArea:zt,clone:V,color:ut,createContext:ki,debounce:Te,defined:X,distanceBetweenPoints:pe,drawPoint:Vt,drawPointLegend:Wt,each:E,easingEffects:_i,finiteOrDefault:g,fontString:function(e,t,i){return t+" "+e+"px "+i},formatNumber:gt,getAngleFromPoint:he,getHoverColor:dt,getMaximumSize:It,getRelativePosition:Nt,getRtlAdapter:Li,getStyle:xt,isArray:M,isFinite:f,isFunction:l,isNullOrUndef:x,isNumber:ae,isObject:N,isPatternOrGradient:ct,listenArrayEvents:we,log10:c,merge:j,mergeIf:U,niceNum:se,noop:e,overrideTextDirection:Fi,readUsedSize:Lt,renderText:Xt,requestAnimFrame:Ee,resolve:Ii,resolveObjectKey:m,restoreTextDirection:Gi,retinaScale:Pt,setsEqual:Q,sign:v,splineCurve:gi,splineCurveMonotone:mi,supportsEventListenerOptions:kt,throttled:Se,toDegrees:ue,toDimension:H,toFont:R,toFontString:Ft,toLineHeight:Di,toPadding:L,toPercentage:$,toRadians:k,toTRBL:Ni,toTRBLCorners:Oi,uid:G,unclipArea:jt,unlistenArrayEvents:_e,valueOrDefault:O});function qi(e,t,i,n){const{controller:r,data:s,_sorted:o}=e,a=r._cachedMeta.iScale;if(a&&t===a.axis&&"r"!==t&&o&&s.length){const e=a._reversePixels?ye:_;if(!n)return e(s,t,i);if(r._sharedOptions){const n=s[0],r="function"==typeof n.getRange&&n.getRange(t);if(r){const n=e(s,t,i-r),o=e(s,t,i+r);return{lo:n.lo,hi:o.hi}}}}return{lo:0,hi:s.length-1}}function Ki(e,r,s,o,a){const l=e.getSortedVisibleDatasetMetas(),c=s[r];for(let e=0,t=l.length;e<t;++e){const{index:s,data:t}=l[e],{lo:i,hi:n}=qi(l[e],r,c,a);for(let e=i;e<=n;++e){const r=t[e];r.skip||o(r,s,e)}}}function Xi(n,r,e,s,o){const a=[];if(!o&&!n.isPointInArea(r))return a;return Ki(n,e,r,function(e,t,i){(o||d(e,n.chartArea,0))&&e.inRange(r.x,r.y,s)&&a.push({element:e,datasetIndex:t,index:i})},!0),a}function Qi(o,a,e,l,c,u){let d=[];const h=function(e){const r=-1!==e.indexOf("x"),s=-1!==e.indexOf("y");return function(e,t){const i=r?Math.abs(e.x-t.x):0,n=s?Math.abs(e.y-t.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(n,2))}}(e);let p=Number.POSITIVE_INFINITY;return Ki(o,e,a,function(e,t,i){const n=e.inRange(a.x,a.y,c);if(l&&!n)return;const r=e.getCenterPoint(c);if(!(!!u||o.isPointInArea(r))&&!n)return;const s=h(a,r);s<p?(d=[{element:e,datasetIndex:t,index:i}],p=s):s===p&&d.push({element:e,datasetIndex:t,index:i})}),d}function Zi(e,t,i,n,r,s){return s||e.isPointInArea(t)?"r"!==i||n?Qi(e,t,i,n,r,s):function(e,o,t,a){let l=[];return Ki(e,t,o,function(e,t,i){const{startAngle:n,endAngle:r}=e.getProps(["startAngle","endAngle"],a),{angle:s}=he(e,{x:o.x,y:o.y});ge(s,n,r)&&l.push({element:e,datasetIndex:t,index:i})}),l}(e,t,i,r):[]}function Ji(e,n,r,t,s){const o=[],a="x"===r?"inXRange":"inYRange";let l=!1;return Ki(e,r,n,(e,t,i)=>{e[a](n[r],s)&&(o.push({element:e,datasetIndex:t,index:i}),l=l||e.inRange(n.x,n.y,s))}),t&&!l?[]:o}var en={evaluateInteractionItems:Ki,modes:{index(e,t,i,n){const r=Nt(t,e),s=i.axis||"x",o=i.includeInvisible||!1,a=i.intersect?Xi(e,r,s,n,o):Zi(e,r,s,!1,n,o),l=[];return a.length?(e.getSortedVisibleDatasetMetas().forEach(e=>{const t=a[0].index,i=e.data[t];i&&!i.skip&&l.push({element:i,datasetIndex:e.index,index:t})}),l):[]},dataset(e,t,i,n){const r=Nt(t,e),s=i.axis||"xy",o=i.includeInvisible||!1;let a=i.intersect?Xi(e,r,s,n,o):Zi(e,r,s,!1,n,o);if(a.length>0){const t=a[0].datasetIndex,i=e.getDatasetMeta(t).data;a=[];for(let e=0;e<i.length;++e)a.push({element:i[e],datasetIndex:t,index:e})}return a},point:(e,t,i,n)=>Xi(e,Nt(t,e),i.axis||"xy",n,i.includeInvisible||!1),nearest(e,t,i,n){const r=Nt(t,e),s=i.axis||"xy",o=i.includeInvisible||!1;return Zi(e,r,s,i.intersect,n,o)},x:(e,t,i,n)=>Ji(e,Nt(t,e),"x",i.intersect,n),y:(e,t,i,n)=>Ji(e,Nt(t,e),"y",i.intersect,n)}};const tn=["left","top","right","bottom"];function nn(e,t){return e.filter(e=>e.pos===t)}function rn(e,t){return e.filter(e=>-1===tn.indexOf(e.pos)&&e.box.axis===t)}function sn(e,r){return e.sort((e,t)=>{const i=r?t:e,n=r?e:t;return i.weight===n.weight?i.index-n.index:i.weight-n.weight})}function on(i,n){const r=function(r){const s={};for(const n of r){const{stack:r,pos:e,stackWeight:t}=n;if(!r||!tn.includes(e))continue;const i=s[r]||(s[r]={count:0,placed:0,weight:0,size:0});i.count++,i.weight+=t}return s}(i),{vBoxMaxWidth:s,hBoxMaxHeight:o}=n;let a,l,c;for(a=0,l=i.length;a<l;++a){c=i[a];const{fullSize:l}=c.box,e=r[c.stack],t=e&&c.stackWeight/e.weight;c.horizontal?(c.width=t?t*s:l&&n.availableWidth,c.height=o):(c.width=s,c.height=t?t*o:l&&n.availableHeight)}return r}function an(e,t,i,n){return Math.max(e[i],t[i])+Math.max(e[n],t[n])}function ln(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function cn(e,t,i,n){const{pos:r,box:s}=i,o=e.maxPadding;if(!N(r)){i.size&&(e[r]-=i.size);const t=n[i.stack]||{size:0,count:1};t.size=Math.max(t.size,i.horizontal?s.height:s.width),i.size=t.size/t.count,e[r]+=i.size}s.getPadding&&ln(o,s.getPadding());const a=Math.max(0,t.outerWidth-an(o,e,"left","right")),l=Math.max(0,t.outerHeight-an(o,e,"top","bottom")),c=a!==e.w,u=l!==e.h;return e.w=a,e.h=l,i.horizontal?{same:c,other:u}:{same:u,other:c}}function un(e,i){const n=i.maxPadding;function t(e){const t={left:0,top:0,right:0,bottom:0};return e.forEach(e=>{t[e]=Math.max(i[e],n[e])}),t}return t(e?["left","right"]:["top","bottom"])}function dn(t,i,n,r){const s=[];let o,a,l,c,u,d;for(o=0,a=t.length,u=0;o<a;++o){l=t[o],c=l.box,c.update(l.width||i.w,l.height||i.h,un(l.horizontal,i));const{same:a,other:e}=cn(i,n,l,r);u|=a&&s.length,d=d||e,c.fullSize||s.push(l)}return u&&dn(s,i,n,r)||d}function hn(e,t,i,n,r){e.top=i,e.left=t,e.right=t+n,e.bottom=i+r,e.width=n,e.height=r}function pn(n,r,s,o){const a=s.padding;let{x:l,y:c}=r;for(const i of n){const n=i.box,e=o[i.stack]||{count:1,placed:0,weight:1},t=i.stackWeight/e.weight||1;if(i.horizontal){const o=r.w*t,l=e.size||n.height;X(e.start)&&(c=e.start),n.fullSize?hn(n,a.left,c,s.outerWidth-a.right-a.left,l):hn(n,r.left+e.placed,c,o,l),e.start=c,e.placed+=o,c=n.bottom}else{const o=r.h*t,c=e.size||n.width;X(e.start)&&(l=e.start),n.fullSize?hn(n,l,a.top,c,s.outerHeight-a.bottom-a.top):hn(n,l,r.top+e.placed,c,o),e.start=l,e.placed+=o,l=n.right}}r.x=l,r.y=c}var r={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){const i=e.boxes?e.boxes.indexOf(t):-1;-1!==i&&e.boxes.splice(i,1)},configure(e,t,i){t.fullSize=i.fullSize,t.position=i.position,t.weight=i.weight},update(i,e,t,n){if(!i)return;const r=L(i.options.layout.padding),s=Math.max(e-r.width,0),o=Math.max(t-r.height,0),a=function(e){const t=function(e){const t=[];let i,n,r,s,o,a;for(i=0,n=(e||[]).length;i<n;++i)r=e[i],{position:s,options:{stack:o,stackWeight:a=1}}=r,t.push({index:i,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&s+o,stackWeight:a});return t}(e),i=sn(t.filter(e=>e.box.fullSize),!0),n=sn(nn(t,"left"),!0),r=sn(nn(t,"right")),s=sn(nn(t,"top"),!0),o=sn(nn(t,"bottom")),a=rn(t,"x"),l=rn(t,"y");return{fullSize:i,leftAndTop:n.concat(s),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:nn(t,"chartArea"),vertical:n.concat(r).concat(l),horizontal:s.concat(o).concat(a)}}(i.boxes),l=a.vertical,c=a.horizontal;E(i.boxes,e=>{"function"==typeof e.beforeLayout&&e.beforeLayout()});const u=l.reduce((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:t,padding:r,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/u,hBoxMaxHeight:o/2}),h=Object.assign({},r);ln(h,L(n));const p=Object.assign({maxPadding:h,w:s,h:o,x:r.left,y:r.top},r),f=on(l.concat(c),d);dn(a.fullSize,p,d,f),dn(l,p,d,f),dn(c,p,d,f)&&dn(l,p,d,f),function(i){const n=i.maxPadding;function e(e){const t=Math.max(n[e]-i[e],0);return i[e]+=t,t}i.y+=e("top"),i.x+=e("left"),e("right"),e("bottom")}(p),pn(a.leftAndTop,p,d,f),p.x+=p.w,p.y+=p.h,pn(a.rightAndBottom,p,d,f),i.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},E(a.chartArea,e=>{const t=e.box;Object.assign(t,i.chartArea),t.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class fn{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,i){}removeEventListener(e,t,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,i,n){return t=Math.max(0,t||e.width),i=i||e.height,{width:t,height:Math.max(0,n?Math.floor(t/n):i)}}isAttached(e){return!0}updateConfig(e){}}class gn extends fn{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const mn="$chartjs",vn={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},yn=e=>null===e||""===e;const bn=!!kt&&{passive:!0};function Cn(e,t,i){e.canvas.removeEventListener(t,i,bn)}function wn(t,i){for(const e of t)if(e===i||e.contains(i))return!0}function _n(e,t,i){const n=e.canvas,r=new MutationObserver(e=>{let t=!1;for(const i of e)t=t||wn(i.addedNodes,n),t=t&&!wn(i.removedNodes,n);t&&i()});return r.observe(document,{childList:!0,subtree:!0}),r}function An(e,t,i){const n=e.canvas,r=new MutationObserver(e=>{let t=!1;for(const i of e)t=t||wn(i.removedNodes,n),t=t&&!wn(i.addedNodes,n);t&&i()});return r.observe(document,{childList:!0,subtree:!0}),r}const En=new Map;let Sn=0;function Tn(){const i=window.devicePixelRatio;i!==Sn&&(Sn=i,En.forEach((e,t)=>{t.currentDevicePixelRatio!==i&&e()}))}function xn(e,t,n){const i=e.canvas,r=i&&Et(i);if(!r)return;const s=Se((e,t)=>{const i=r.clientWidth;n(e,t),i<r.clientWidth&&n()},window),o=new ResizeObserver(e=>{const t=e[0],i=t.contentRect.width,n=t.contentRect.height;0===i&&0===n||s(i,n)});return o.observe(r),function(e,t){En.size||window.addEventListener("resize",Tn),En.set(e,t)}(e,s),o}function Dn(e,t,i){i&&i.disconnect(),"resize"===t&&function(e){En.delete(e),En.size||window.removeEventListener("resize",Tn)}(e)}function Rn(t,e,i){const n=t.canvas,r=Se(e=>{null!==t.ctx&&i(function(e,t){const i=vn[e.type]||e.type,{x:n,y:r}=Nt(e,t);return{type:i,chart:t,native:e,x:void 0!==n?n:null,y:void 0!==r?r:null}}(e,t))},t);return function(e,t,i){e.addEventListener(t,i,bn)}(n,e,r),r}class Mn extends fn{acquireContext(e,t){const i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(function(e,t){const i=e.style,n=e.getAttribute("height"),r=e.getAttribute("width");if(e[mn]={initial:{height:n,width:r,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",yn(r)){const t=Lt(e,"width");void 0!==t&&(e.width=t)}if(yn(n))if(""===e.style.height)e.height=e.width/(t||2);else{const t=Lt(e,"height");void 0!==t&&(e.height=t)}}(e,t),i):null}releaseContext(e){const i=e.canvas;if(!i[mn])return!1;const n=i[mn].initial;["height","width"].forEach(e=>{const t=n[e];x(t)?i.removeAttribute(e):i.setAttribute(e,t)});const t=n.style||{};return Object.keys(t).forEach(e=>{i.style[e]=t[e]}),i.width=i.width,delete i[mn],!0}addEventListener(e,t,i){this.removeEventListener(e,t);const n=e.$proxies||(e.$proxies={}),r={attach:_n,detach:An,resize:xn}[t]||Rn;n[t]=r(e,t,i)}removeEventListener(e,t){const i=e.$proxies||(e.$proxies={}),n=i[t];if(!n)return;({attach:Dn,detach:Dn,resize:Dn}[t]||Cn)(e,t,n),i[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,i,n){return It(e,t,i,n)}isAttached(e){const t=Et(e);return!(!t||!t.isConnected)}}function Nn(e){return!At()||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?gn:Mn}var On=Object.freeze({__proto__:null,BasePlatform:fn,BasicPlatform:gn,DomPlatform:Mn,_detectPlatform:Nn});const In="transparent",Pn={boolean:(e,t,i)=>i>.5?t:e,color(e,t,i){const n=ut(e||In),r=n.valid&&ut(t||In);return r&&r.valid?r.mix(n,i).hexString():t},number:(e,t,i)=>e+(t-e)*i};class kn{constructor(e,t,i,n){const r=t[i];n=Ii([e.to,n,r,e.from]);const s=Ii([e.from,r,n]);this._active=!0,this._fn=e.fn||Pn[e.type||typeof s],this._easing=_i[e.easing]||_i.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=i,this._from=s,this._to=n,this._promises=void 0}active(){return this._active}update(n,r,s){if(this._active){this._notify(!1);const e=this._target[this._prop],t=s-this._start,i=this._duration-t;this._start=s,this._duration=Math.floor(Math.max(i,n.duration)),this._total+=t,this._loop=!!n.loop,this._to=Ii([n.to,r,e,n.from]),this._from=Ii([n.from,e,r])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,i=this._duration,n=this._prop,r=this._from,s=this._loop,o=this._to;let a;if(this._active=r!==o&&(s||t<i),!this._active)return this._target[n]=o,void this._notify(!0);t<0?this._target[n]=r:(a=t/i%2,a=s&&a>1?2-a:a,a=this._easing(Math.min(1,Math.max(0,a))),this._target[n]=this._fn(r,o,a))}wait(){const i=this._promises||(this._promises=[]);return new Promise((e,t)=>{i.push({res:e,rej:t})})}_notify(e){const t=e?"res":"rej",i=this._promises||[];for(let e=0;e<i.length;e++)i[e][t]()}}class Ln{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(n){if(!N(n))return;const r=Object.keys(D.animation),s=this._properties;Object.getOwnPropertyNames(n).forEach(t=>{const e=n[t];if(!N(e))return;const i={};for(const n of r)i[n]=e[n];(M(e.properties)&&e.properties||[t]).forEach(e=>{e!==t&&s.has(e)||s.set(e,i)})})}_animateOptions(e,t){const i=t.options,n=function(e,t){if(!t)return;let i=e.options;if(!i)return void(e.options=t);i.$shared&&(e.options=i=Object.assign({},i,{$shared:!1,$animations:{}}));return i}(e,i);if(!n)return[];const r=this._createAnimations(n,i);return i.$shared&&function(i,e){const n=[],r=Object.keys(e);for(let t=0;t<r.length;t++){const e=i[r[t]];e&&e.active()&&n.push(e.wait())}return Promise.all(n)}(e.options.$animations,i).then(()=>{e.options=i},()=>{}),r}_createAnimations(r,s){const o=this._properties,a=[],l=r.$animations||(r.$animations={}),c=Object.keys(s),u=Date.now();let d;for(d=c.length-1;d>=0;--d){const e=c[d];if("$"===e.charAt(0))continue;if("options"===e){a.push(...this._animateOptions(r,s));continue}const t=s[e];let i=l[e];const n=o.get(e);if(i){if(n&&i.active()){i.update(n,t,u);continue}i.cancel()}n&&n.duration?(l[e]=i=new kn(n,r,e,t),a.push(i)):r[e]=t}return a}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const i=this._createAnimations(e,t);return i.length?(u.add(this._chart,i),!0):void 0}}function Fn(e,t){const i=e&&e.options||{},n=i.reverse,r=void 0===i.min?t:0,s=void 0===i.max?t:0;return{start:n?s:r,end:n?r:s}}function Gn(e,t){const i=[],n=e._getSortedDatasetMetas(t);let r,s;for(r=0,s=n.length;r<s;++r)i.push(n[r].index);return i}function $n(e,t,i,n={}){const r=e.keys,s="single"===n.mode;let o,a,l,c;if(null!==t){for(o=0,a=r.length;o<a;++o){if(l=+r[o],l===i){if(n.all)continue;break}c=e.values[l],f(c)&&(s||0===t||v(t)===v(c))&&(t+=c)}return t}}function Hn(e,t){const i=e&&e.options.stacked;return i||void 0===i&&void 0!==t.stack}function Bn(e,t,i){const n=e[t]||(e[t]={});return n[i]||(n[i]={})}function Vn(t,i,n,r){for(const e of i.getMatchingVisibleMetas(r).reverse()){const i=t[e.index];if(n&&i>0||!n&&i<0)return e.index}return null}function Wn(e,t){const{chart:i,_cachedMeta:n}=e,r=i._stacks||(i._stacks={}),{iScale:s,vScale:o,index:a}=n,l=s.axis,c=o.axis,u=function(e,t,i){return`${e.id}.${t.id}.${i.stack||i.type}`}(s,o,n),d=t.length;let h;for(let e=0;e<d;++e){const i=t[e],{[l]:s,[c]:d}=i;h=(i._stacks||(i._stacks={}))[c]=Bn(r,u,s),h[a]=d,h._top=Vn(h,o,!0,n.type),h._bottom=Vn(h,o,!1,n.type);(h._visualValues||(h._visualValues={}))[a]=d}}function zn(e,t){const i=e.scales;return Object.keys(i).filter(e=>i[e].axis===t).shift()}function jn(e,t){const i=e.controller.index,n=e.vScale&&e.vScale.axis;if(n){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[n]||void 0===t[n][i])return;delete t[n][i],void 0!==t[n]._visualValues&&void 0!==t[n]._visualValues[i]&&delete t[n]._visualValues[i]}}}const Un=e=>"reset"===e||"none"===e,Yn=(e,t)=>t?e:Object.assign({},e);class qn{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Hn(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&jn(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,i=this.getDataset(),n=(e,t,i,n)=>"x"===e?t:"r"===e?n:i,r=t.xAxisID=O(i.xAxisID,zn(e,"x")),s=t.yAxisID=O(i.yAxisID,zn(e,"y")),o=t.rAxisID=O(i.rAxisID,zn(e,"r")),a=t.indexAxis,l=t.iAxisID=n(a,r,s,o),c=t.vAxisID=n(a,s,r,o);t.xScale=this.getScaleForId(r),t.yScale=this.getScaleForId(s),t.rScale=this.getScaleForId(o),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&_e(this._data,this),e._stacked&&jn(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),i=this._data;if(N(t))this._data=function(e){const t=Object.keys(e),i=new Array(t.length);let n,r,s;for(n=0,r=t.length;n<r;++n)s=t[n],i[n]={x:s,y:e[s]};return i}(t);else if(i!==t){if(i){_e(i,this);const e=this._cachedMeta;jn(e),e._parsed=[]}t&&Object.isExtensible(t)&&we(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,i=this.getDataset();let n=!1;this._dataCheck();const r=t._stacked;t._stacked=Hn(t.vScale,t),t.stack!==i.stack&&(n=!0,jn(t),t.stack=i.stack),this._resyncElements(e),(n||r!==t._stacked)&&Wn(this,t._parsed)}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),i=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:i,_data:n}=this,{iScale:r,_stacked:s}=i,o=r.axis;let a,l,c,u=0===e&&t===n.length||i._sorted,d=e>0&&i._parsed[e-1];if(!1===this._parsing)i._parsed=n,i._sorted=!0,c=n;else{c=M(n[e])?this.parseArrayData(i,n,e,t):N(n[e])?this.parseObjectData(i,n,e,t):this.parsePrimitiveData(i,n,e,t);const r=()=>null===l[o]||d&&l[o]<d[o];for(a=0;a<t;++a)i._parsed[a+e]=l=c[a],u&&(r()&&(u=!1),d=l);i._sorted=u}s&&Wn(this,c)}parsePrimitiveData(e,t,i,n){const{iScale:r,vScale:s}=e,o=r.axis,a=s.axis,l=r.getLabels(),c=r===s,u=new Array(n);let d,h,p;for(d=0,h=n;d<h;++d)p=d+i,u[d]={[o]:c||r.parse(l[p],p),[a]:s.parse(t[p],p)};return u}parseArrayData(e,t,i,n){const{xScale:r,yScale:s}=e,o=new Array(n);let a,l,c,u;for(a=0,l=n;a<l;++a)c=a+i,u=t[c],o[a]={x:r.parse(u[0],c),y:s.parse(u[1],c)};return o}parseObjectData(e,t,i,n){const{xScale:r,yScale:s}=e,{xAxisKey:o="x",yAxisKey:a="y"}=this._parsing,l=new Array(n);let c,u,d,h;for(c=0,u=n;c<u;++c)d=c+i,h=t[d],l[c]={x:r.parse(m(h,o),d),y:s.parse(m(h,a),d)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,i){const n=this.chart,r=this._cachedMeta,s=t[e.axis];return $n({keys:Gn(n,!0),values:t._stacks[e.axis]._visualValues},s,r.index,{mode:i})}updateRangeFromParsed(e,t,i,n){const r=i[t.axis];let s=null===r?NaN:r;const o=n&&i._stacks[t.axis];n&&o&&(n.values=o,s=$n(n,r,this._cachedMeta.index)),e.min=Math.min(e.min,s),e.max=Math.max(e.max,s)}getMinMax(t,e){const i=this._cachedMeta,n=i._parsed,r=i._sorted&&t===i.iScale,s=n.length,o=this._getOtherScale(t),a=((e,t,i)=>e&&!t.hidden&&t._stacked&&{keys:Gn(i,!0),values:null})(e,i,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:u}=function(e){const{min:t,max:i,minDefined:n,maxDefined:r}=e.getUserBounds();return{min:n?t:Number.NEGATIVE_INFINITY,max:r?i:Number.POSITIVE_INFINITY}}(o);let d,h;function p(){h=n[d];const e=h[o.axis];return!f(h[t.axis])||c>e||u<e}for(d=0;d<s&&(p()||(this.updateRangeFromParsed(l,t,h,a),!r));++d);if(r)for(d=s-1;d>=0;--d)if(!p()){this.updateRangeFromParsed(l,t,h,a);break}return l}getAllParsedValues(e){const t=this._cachedMeta._parsed,i=[];let n,r,s;for(n=0,r=t.length;n<r;++n)s=t[n][e.axis],f(s)&&i.push(s);return i}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,i=t.iScale,n=t.vScale,r=this.getParsed(e);return{label:i?""+i.getLabelForValue(r[i.axis]):"",value:n?""+n.getLabelForValue(r[n.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){let t,i,n,r;return N(e)?(t=e.top,i=e.right,n=e.bottom,r=e.left):t=i=n=r=e,{top:t,right:i,bottom:n,left:r,disabled:!1===e}}(O(this.options.clip,function(e,t,i){if(!1===i)return!1;const n=Fn(e,i),r=Fn(t,i);return{top:r.end,right:n.end,bottom:r.start,left:n.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,i=this._cachedMeta,n=i.data||[],r=t.chartArea,s=[],o=this._drawStart||0,a=this._drawCount||n.length-o,l=this.options.drawActiveElementsOnTop;let c;for(i.dataset&&i.dataset.draw(e,r,o,a),c=o;c<o+a;++c){const t=n[c];t.hidden||(t.active&&l?s.push(t):t.draw(e,r))}for(c=0;c<s.length;++c)s[c].draw(e,r)}getStyle(e,t){const i=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(e||0,i)}getContext(e,t,i){const n=this.getDataset();let r;if(e>=0&&e<this._cachedMeta.data.length){const t=this._cachedMeta.data[e];r=t.$context||(t.$context=function(e,t,i){return ki(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:i,index:t,mode:"default",type:"data"})}(this.getContext(),e,t)),r.parsed=this.getParsed(e),r.raw=n.data[e],r.index=r.dataIndex=e}else r=this.$context||(this.$context=function(e,t){return ki(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),r.dataset=n,r.index=r.datasetIndex=this.index;return r.active=!!t,r.mode=i,r}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",i){const n="active"===t,r=this._cachedDataOpts,s=e+"-"+t,o=r[s],a=this.enableOptionSharing&&X(i);if(o)return Yn(o,a);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,e),u=n?[`${e}Hover`,"hover",e,""]:[e,""],d=l.getOptionScopes(this.getDataset(),c),h=Object.keys(D.elements[e]),p=l.resolveNamedOptions(d,h,()=>this.getContext(i,n,t),u);return p.$shared&&(p.$shared=a,r[s]=Object.freeze(Yn(p,a))),p}_resolveAnimations(e,t,i){const n=this.chart,r=this._cachedDataOpts,s=`animation-${t}`,o=r[s];if(o)return o;let a;if(!1!==n.options.animation){const n=this.chart.config,r=n.datasetAnimationScopeKeys(this._type,t),s=n.getOptionScopes(this.getDataset(),r);a=n.createResolver(s,this.getContext(e,i,t))}const l=new Ln(n,a&&a.animations);return a&&a._cacheable&&(r[s]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||Un(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const i=this.resolveDataElementOptions(e,t),n=this._sharedOptions,r=this.getSharedOptions(i),s=this.includeOptions(t,r)||r!==n;return this.updateSharedOptions(r,t,i),{sharedOptions:r,includeOptions:s}}updateElement(e,t,i,n){Un(n)?Object.assign(e,i):this._resolveAnimations(t,n).update(e,i)}updateSharedOptions(e,t,i){e&&!Un(t)&&this._resolveAnimations(void 0,t).update(e,i)}_setStyle(e,t,i,n){e.active=n;const r=this.getStyle(t,n);this._resolveAnimations(t,i,n).update(e,{options:!n&&this.getSharedOptions(r)||r})}removeHoverStyle(e,t,i){this._setStyle(e,i,"active",!1)}setHoverStyle(e,t,i){this._setStyle(e,i,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,i=this._cachedMeta.data;for(const[e,t,i]of this._syncList)this[e](t,i);this._syncList=[];const n=i.length,r=t.length,s=Math.min(r,n);s&&this.parse(0,s),r>n?this._insertElements(n,r-n,e):r<n&&this._removeElements(r,n-r)}_insertElements(e,t,i=!0){const n=this._cachedMeta,r=n.data,s=e+t;let o;const a=e=>{for(e.length+=t,o=e.length-1;o>=s;o--)e[o]=e[o-t]};for(a(r),o=e;o<s;++o)r[o]=new this.dataElementType;this._parsing&&a(n._parsed),this.parse(e,t),i&&this.updateElements(r,e,t,"reset")}updateElements(e,t,i,n){}_removeElements(t,i){const n=this._cachedMeta;if(this._parsing){const e=n._parsed.splice(t,i);n._stacked&&jn(n,e)}n.data.splice(t,i)}_sync(n){if(this._parsing)this._syncList.push(n);else{const[e,t,i]=n;this[e](t,i)}this.chart._dataChanges.push([this.index,...n])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const i=arguments.length-2;i&&this._sync(["_insertElements",e,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}class t{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}hasValue(){return ae(this.x)&&ae(this.y)}getProps(e,t){const i=this.$animations;if(!t||!i)return this;const n={};return e.forEach(e=>{n[e]=i[e]&&i[e].active()?i[e]._to:this[e]}),n}}function Kn(e,i){const t=e.options.ticks,n=function(e){const t=e.options.offset,i=e._tickSize(),n=e._length/i+(t?0:1),r=e._maxLength/i;return Math.floor(Math.min(n,r))}(e),r=Math.min(t.maxTicksLimit||n,n),s=t.major.enabled?function(e){const t=[];let i,n;for(i=0,n=e.length;i<n;i++)e[i].major&&t.push(i);return t}(i):[],o=s.length,a=s[0],l=s[o-1],c=[];if(o>r)return function(e,t,i,n){let r,s=0,o=i[0];for(n=Math.ceil(n),r=0;r<e.length;r++)r===o&&(t.push(e[r]),s++,o=i[s*n])}(i,c,s,o/r),c;const u=function(e,i,t){const n=function(e){const t=e.length;let i,n;if(t<2)return!1;for(n=e[0],i=1;i<t;++i)if(e[i]-e[i-1]!==n)return!1;return n}(e),r=i.length/t;if(!n)return Math.max(r,1);const s=oe(n);for(let e=0,t=s.length-1;e<t;e++){const i=s[e];if(i>r)return i}return Math.max(r,1)}(s,i,r);if(o>0){let e,t;const n=o>1?Math.round((l-a)/(o-1)):null;for(Xn(i,c,u,x(n)?0:a-n,a),e=0,t=o-1;e<t;e++)Xn(i,c,u,s[e],s[e+1]);return Xn(i,c,u,l,x(n)?i.length:l+n),c}return Xn(i,c,u),c}function Xn(e,t,i,n,r){const s=O(n,0),o=Math.min(O(r,e.length),e.length);let a,l,c,u=0;for(i=Math.ceil(i),r&&(a=r-n,i=a/Math.floor(a/i)),c=s;c<0;)u++,c=Math.round(s+u*i);for(l=Math.max(s,0);l<o;l++)l===c&&(t.push(e[l]),u++,c=Math.round(s+u*i))}const Qn=(e,t,i)=>"top"===t||"left"===t?e[t]+i:e[t]-i,Zn=(e,t)=>Math.min(t||e,e);function Jn(e,t){const i=[],n=e.length/t,r=e.length;let s=0;for(;s<r;s+=n)i.push(e[Math.floor(s)]);return i}function er(e,t,i){const n=e.ticks.length,r=Math.min(t,n-1),s=e._startPixel,o=e._endPixel,a=1e-6;let l,c=e.getPixelForTick(r);if(!(i&&(l=1===n?Math.max(c-s,o-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(r-1))/2,c+=r<t?l:-l,c<s-a||c>o+a)))return c}function tr(e){return e.drawTicks?e.tickLength:0}function ir(e,t){if(!e.display)return 0;const i=R(e.font,t),n=L(e.padding);return(M(e.text)?e.text.length:1)*i.lineHeight+n.height}function nr(e,t,i){let n=xe(e);return(i&&"right"!==t||!i&&"right"===t)&&(n=(e=>"left"===e?"right":"right"===e?"left":e)(n)),n}class rr extends t{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:i,_suggestedMax:n}=this;return e=g(e,Number.POSITIVE_INFINITY),t=g(t,Number.NEGATIVE_INFINITY),i=g(i,Number.POSITIVE_INFINITY),n=g(n,Number.NEGATIVE_INFINITY),{min:g(e,i),max:g(t,n),minDefined:f(e),maxDefined:f(t)}}getMinMax(i){let n,{min:r,max:s,minDefined:o,maxDefined:a}=this.getUserBounds();if(o&&a)return{min:r,max:s};const l=this.getMatchingVisibleMetas();for(let e=0,t=l.length;e<t;++e)n=l[e].controller.getMinMax(this,i),o||(r=Math.min(r,n.min)),a||(s=Math.max(s,n.max));return r=a&&r>s?s:r,s=o&&r>s?r:s,{min:g(r,g(s,r)),max:g(s,g(r,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){p(this.options.beforeUpdate,[this])}update(e,t,i){const{beginAtZero:n,grace:r,ticks:s}=this.options,o=s.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Pi(this,r,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const a=o<this.ticks.length;this._convertTicksToLabels(a?Jn(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),s.display&&(s.autoSkip||"auto"===s.source)&&(this.ticks=Kn(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),a&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,t,i=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,i=!i),this._startPixel=e,this._endPixel=t,this._reversePixels=i,this._length=t-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){p(this.options.afterUpdate,[this])}beforeSetDimensions(){p(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){p(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),p(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){p(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let i,n,r;for(i=0,n=e.length;i<n;i++)r=e[i],r.label=p(t.callback,[r.value,i,e],this)}afterTickToLabelConversion(){p(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){p(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,i=Zn(this.ticks.length,e.ticks.maxTicksLimit),n=t.minRotation||0,r=t.maxRotation;let s,o,a,l=n;if(!this._isVisible()||!t.display||n>=r||i<=1||!this.isHorizontal())return void(this.labelRotation=n);const c=this._getLabelSizes(),u=c.widest.width,d=c.highest.height,h=b(this.chart.width-u,0,this.maxWidth);s=e.offset?this.maxWidth/i:h/(i-1),u+6>s&&(s=h/(i-(e.offset?.5:1)),o=this.maxHeight-tr(e.grid)-t.padding-ir(e.title,this.chart.options.font),a=Math.sqrt(u*u+d*d),l=ue(Math.min(Math.asin(b((c.highest.height+6)/s,-1,1)),Math.asin(b(o/a,-1,1))-Math.asin(b(d/a,-1,1)))),l=Math.max(n,Math.min(r,l))),this.labelRotation=l}afterCalculateLabelRotation(){p(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){p(this.options.beforeFit,[this])}fit(){const r={width:0,height:0},{chart:s,options:{ticks:o,title:a,grid:l}}=this,c=this._isVisible(),u=this.isHorizontal();if(c){const c=ir(a,s.options.font);if(u?(r.width=this.maxWidth,r.height=tr(l)+c):(r.height=this.maxHeight,r.width=tr(l)+c),o.display&&this.ticks.length){const{first:s,last:a,widest:l,highest:c}=this._getLabelSizes(),e=2*o.padding,t=k(this.labelRotation),i=Math.cos(t),n=Math.sin(t);if(u){const s=o.mirror?0:n*l.width+i*c.height;r.height=Math.min(this.maxHeight,r.height+s+e)}else{const s=o.mirror?0:i*l.width+n*c.height;r.width=Math.min(this.maxWidth,r.width+s+e)}this._calculatePadding(s,a,n,i)}}this._handleMargins(),u?(this.width=this._length=s.width-this._margins.left-this._margins.right,this.height=r.height):(this.width=r.width,this.height=this._length=s.height-this._margins.top-this._margins.bottom)}_calculatePadding(n,r,s,o){const{ticks:{align:a,padding:l},position:c}=this.options,u=0!==this.labelRotation,d="top"!==c&&"x"===this.axis;if(this.isHorizontal()){const c=this.getPixelForTick(0)-this.left,e=this.right-this.getPixelForTick(this.ticks.length-1);let t=0,i=0;u?d?(t=o*n.width,i=s*r.height):(t=s*n.height,i=o*r.width):"start"===a?i=r.width:"end"===a?t=n.width:"inner"!==a&&(t=n.width/2,i=r.width/2),this.paddingLeft=Math.max((t-c+l)*this.width/(this.width-c),0),this.paddingRight=Math.max((i-e+l)*this.width/(this.width-e),0)}else{let e=r.height/2,t=n.height/2;"start"===a?(e=0,t=n.height):"end"===a&&(e=r.height,t=0),this.paddingTop=e+l,this.paddingBottom=t+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){p(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){let t,i;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,i=e.length;t<i;t++)x(e[t].label)&&(e.splice(t,1),i--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let i=this._labelSizes;if(!i){const e=this.options.ticks.sampleSize;let t=this.ticks;e<t.length&&(t=Jn(t,e)),this._labelSizes=i=this._computeLabelSizes(t,t.length,this.options.ticks.maxTicksLimit)}return i}_computeLabelSizes(e,t,i){const{ctx:n,_longestTextCache:r}=this,s=[],o=[],a=Math.floor(t/Zn(t,i));let l,c,u,d,h,p,f,g,m,v,y,b=0,C=0;for(l=0;l<t;l+=a){if(d=e[l].label,h=this._resolveTickFontOptions(l),n.font=p=h.string,f=r[p]=r[p]||{data:{},gc:[]},g=h.lineHeight,m=v=0,x(d)||M(d)){if(M(d))for(c=0,u=d.length;c<u;++c)y=d[c],x(y)||M(y)||(m=Gt(n,f.data,f.gc,m,y),v+=g)}else m=Gt(n,f.data,f.gc,m,d),v=g;s.push(m),o.push(v),b=Math.max(m,b),C=Math.max(v,C)}!function(e,r){E(e,e=>{const t=e.gc,i=t.length/2;let n;if(i>r){for(n=0;n<i;++n)delete e.data[t[n]];t.splice(0,i)}})}(r,t);const w=s.indexOf(b),_=o.indexOf(C),A=e=>({width:s[e]||0,height:o[e]||0});return{first:A(0),last:A(t-1),widest:A(w),highest:A(_),widths:s,heights:o}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return me(this._alignToPixels?Ht(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(t){const i=this.ticks||[];if(t>=0&&t<i.length){const e=i[t];return e.$context||(e.$context=function(e,t,i){return ki(e,{tick:i,index:t,type:"tick"})}(this.getContext(),t,e))}return this.$context||(this.$context=ki(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const e=this.options.ticks,t=k(this.labelRotation),i=Math.abs(Math.cos(t)),n=Math.abs(Math.sin(t)),r=this._getLabelSizes(),s=e.autoSkipPadding||0,o=r?r.widest.width+s:0,a=r?r.highest.height+s:0;return this.isHorizontal()?a*i>o*n?o/i:a/n:a*n<o*i?a/i:o/n}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,i=this.chart,n=this.options,{grid:r,position:s,border:o}=n,a=r.offset,l=this.isHorizontal(),c=this.ticks.length+(a?1:0),u=tr(r),d=[],h=o.setContext(this.getContext()),p=h.display?h.width:0,f=p/2,g=function(e){return Ht(i,e,p)};let m,v,y,b,C,w,_,A,E,S,T,x;if("top"===s)m=g(this.bottom),w=this.bottom-u,A=m-f,S=g(e.top)+f,x=e.bottom;else if("bottom"===s)m=g(this.top),S=e.top,x=g(e.bottom)-f,w=m+f,A=this.top+u;else if("left"===s)m=g(this.right),C=this.right-u,_=m-f,E=g(e.left)+f,T=e.right;else if("right"===s)m=g(this.left),E=e.left,T=g(e.right)-f,C=m+f,_=this.left+u;else if("x"===t){if("center"===s)m=g((e.top+e.bottom)/2+.5);else if(N(s)){const e=Object.keys(s)[0],t=s[e];m=g(this.chart.scales[e].getPixelForValue(t))}S=e.top,x=e.bottom,w=m+f,A=w+u}else if("y"===t){if("center"===s)m=g((e.left+e.right)/2);else if(N(s)){const e=Object.keys(s)[0],t=s[e];m=g(this.chart.scales[e].getPixelForValue(t))}C=m-f,_=C-u,E=e.left,T=e.right}const D=O(n.ticks.maxTicksLimit,c),R=Math.max(1,Math.ceil(c/D));for(v=0;v<c;v+=R){const e=this.getContext(v),t=r.setContext(e),n=o.setContext(e),N=t.lineWidth,s=t.color,O=n.dash||[],c=n.dashOffset,u=t.tickWidth,h=t.tickColor,p=t.tickBorderDash||[],f=t.tickBorderDashOffset;y=er(this,v,a),void 0!==y&&(b=Ht(i,y,N),l?C=_=E=T=b:w=A=S=x=b,d.push({tx1:C,ty1:w,tx2:_,ty2:A,x1:E,y1:S,x2:T,y2:x,width:N,color:s,borderDash:O,borderDashOffset:c,tickWidth:u,tickColor:h,tickBorderDash:p,tickBorderDashOffset:f}))}return this._ticksLength=c,this._borderValue=m,d}_computeLabelItems(n){const r=this.axis,s=this.options,{position:o,ticks:t}=s,a=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:u,padding:e,mirror:d}=t,i=tr(s.grid),h=i+e,p=d?-e:h,f=-k(this.labelRotation),g=[];let m,v,y,b,C,w,_,A,E,S,T,x,D="middle";if("top"===o)w=this.bottom-p,_=this._getXAxisLabelAlignment();else if("bottom"===o)w=this.top+p,_=this._getXAxisLabelAlignment();else if("left"===o){const n=this._getYAxisLabelAlignment(i);_=n.textAlign,C=n.x}else if("right"===o){const n=this._getYAxisLabelAlignment(i);_=n.textAlign,C=n.x}else if("x"===r){if("center"===o)w=(n.top+n.bottom)/2+h;else if(N(o)){const n=Object.keys(o)[0],r=o[n];w=this.chart.scales[n].getPixelForValue(r)+h}_=this._getXAxisLabelAlignment()}else if("y"===r){if("center"===o)C=(n.left+n.right)/2-h;else if(N(o)){const n=Object.keys(o)[0],r=o[n];C=this.chart.scales[n].getPixelForValue(r)}_=this._getYAxisLabelAlignment(i).textAlign}"y"===r&&("start"===c?D="top":"end"===c&&(D="bottom"));const R=this._getLabelSizes();for(m=0,v=l.length;m<v;++m){y=l[m],b=y.label;const n=t.setContext(this.getContext(m));A=this.getPixelForTick(m)+t.labelOffset,E=this._resolveTickFontOptions(m),S=E.lineHeight,T=M(b)?b.length:1;const r=T/2,s=n.color,N=n.textStrokeColor,c=n.textStrokeWidth;let i,e=_;if(a?(C=A,"inner"===_&&(e=m===v-1?this.options.reverse?"left":"right":0===m?this.options.reverse?"right":"left":"center"),x="top"===o?"near"===u||0!==f?-T*S+S/2:"center"===u?-R.highest.height/2-r*S+S:-R.highest.height+S/2:"near"===u||0!==f?S/2:"center"===u?R.highest.height/2-r*S:R.highest.height-T*S,d&&(x*=-1),0===f||n.showLabelBackdrop||(C+=S/2*Math.sin(f))):(w=A,x=(1-T)*S/2),n.showLabelBackdrop){const r=L(n.backdropPadding),s=R.heights[m],o=R.widths[m];let e=x-r.top,t=0-r.left;switch(D){case"middle":e-=s/2;break;case"bottom":e-=s}switch(_){case"center":t-=o/2;break;case"right":t-=o}i={left:t,top:e,width:o+r.width,height:s+r.height,color:n.backdropColor}}g.push({label:b,font:E,textOffset:x,options:{rotation:f,color:s,strokeColor:N,strokeWidth:c,textAlign:e,textBaseline:D,translation:[C,w],backdrop:i}})}return g}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-k(this.labelRotation))return"top"===e?"left":"right";let i="center";return"start"===t.align?i="left":"end"===t.align?i="right":"inner"===t.align&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:i,mirror:n,padding:r}}=this.options,s=e+r,o=this._getLabelSizes().widest.width;let a,l;return"left"===t?n?(l=this.right+r,"near"===i?a="left":"center"===i?(a="center",l+=o/2):(a="right",l+=o)):(l=this.right-s,"near"===i?a="right":"center"===i?(a="center",l-=o/2):(a="left",l=this.left)):"right"===t?n?(l=this.left+r,"near"===i?a="right":"center"===i?(a="center",l-=o/2):(a="left",l-=o)):(l=this.left+s,"near"===i?a="left":"center"===i?(a="center",l+=o/2):(a="right",l=this.right)):a="right",{textAlign:a,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:i,top:n,width:r,height:s}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(i,n,r,s),e.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const i=this.ticks.findIndex(e=>e.value===t);if(i>=0){return e.setContext(this.getContext(i)).lineWidth}return 0}drawGrid(e){const t=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let r,s;const o=(e,t,i)=>{i.width&&i.color&&(n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.setLineDash(i.borderDash||[]),n.lineDashOffset=i.borderDashOffset,n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n.stroke(),n.restore())};if(t.display)for(r=0,s=i.length;r<s;++r){const e=i[r];t.drawOnChartArea&&o({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),t.drawTicks&&o({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:i,grid:n}}=this,r=i.setContext(this.getContext()),s=i.display?r.width:0;if(!s)return;const o=n.setContext(this.getContext(0)).lineWidth,a=this._borderValue;let l,c,u,d;this.isHorizontal()?(l=Ht(e,this.left,s)-s/2,c=Ht(e,this.right,o)+o/2,u=d=a):(u=Ht(e,this.top,s)-s/2,d=Ht(e,this.bottom,o)+o/2,l=c=a),t.save(),t.lineWidth=r.width,t.strokeStyle=r.color,t.beginPath(),t.moveTo(l,u),t.lineTo(c,d),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const t=this.ctx,i=this._computeLabelArea();i&&zt(t,i);const n=this.getLabelItems(e);for(const e of n){const i=e.options,n=e.font;Xt(t,e.label,0,e.textOffset,n,i)}i&&jt(t)}drawTitle(){const{ctx:e,options:{position:t,title:i,reverse:n}}=this;if(!i.display)return;const r=R(i.font),s=L(i.padding),o=i.align;let a=r.lineHeight/2;"bottom"===t||"center"===t||N(t)?(a+=s.bottom,M(i.text)&&(a+=r.lineHeight*(i.text.length-1))):a+=s.top;const{titleX:l,titleY:c,maxWidth:u,rotation:d}=function(e,t,i,n){const{top:r,left:s,bottom:o,right:a,chart:l}=e,{chartArea:c,scales:u}=l;let d,h,p,f=0;const g=o-r,m=a-s;if(e.isHorizontal()){if(h=T(n,s,a),N(i)){const e=Object.keys(i)[0],n=i[e];p=u[e].getPixelForValue(n)+g-t}else p="center"===i?(c.bottom+c.top)/2+g-t:Qn(e,i,t);d=a-s}else{if(N(i)){const e=Object.keys(i)[0],n=i[e];h=u[e].getPixelForValue(n)-m+t}else h="center"===i?(c.left+c.right)/2-m+t:Qn(e,i,t);p=T(n,o,r),f="left"===i?-P:P}return{titleX:h,titleY:p,maxWidth:d,rotation:f}}(this,a,t,o);Xt(e,i.text,0,0,r,{color:i.color,maxWidth:u,rotation:d,textAlign:nr(o,t,n),textBaseline:"middle",translation:[l,c]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,i=O(e.grid&&e.grid.z,-1),n=O(e.border&&e.border.z,0);return this._isVisible()&&this.draw===rr.prototype.draw?[{z:i,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:t,draw:e=>{this.drawLabels(e)}}]:[{z:t,draw:e=>{this.draw(e)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",n=[];let r,s;for(r=0,s=t.length;r<s;++r){const s=t[r];s[i]!==this.id||e&&s.type!==e||n.push(s)}return n}_resolveTickFontOptions(e){return R(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class sr{constructor(e,t,i){this.type=e,this.scope=t,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let i;(function(e){return"id"in e&&"defaults"in e})(t)&&(i=this.register(t));const n=this.items,r=e.id,s=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+e);return r in n||(n[r]=e,function(e,t,i){const n=j(Object.create(null),[i?D.get(i):{},D.get(t),e.defaults]);D.set(t,n),e.defaultRoutes&&function(a,l){Object.keys(l).forEach(e=>{const t=e.split("."),i=t.pop(),n=[a].concat(t).join("."),r=l[e].split("."),s=r.pop(),o=r.join(".");D.route(n,i,o,s)})}(t,e.defaultRoutes);e.descriptors&&D.describe(t,e.descriptors)}(e,s,i),this.override&&D.override(e.id,e.overrides)),s}get(e){return this.items[e]}unregister(e){const t=this.items,i=e.id,n=this.scope;i in t&&delete t[i],n&&i in D[n]&&(delete D[n][i],this.override&&delete yt[i])}}class or{constructor(){this.controllers=new sr(qn,"datasets",!0),this.elements=new sr(t,"elements"),this.plugins=new sr(Object,"plugins"),this.scales=new sr(rr,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(i,e,n){[...e].forEach(e=>{const t=n||this._getRegistryForType(e);n||t.isForType(e)||t===this.plugins&&e.id?this._exec(i,t,e):E(e,e=>{const t=n||this._getRegistryForType(e);this._exec(i,t,e)})})}_exec(e,t,i){const n=K(e);p(i["before"+n],[],i),t[e](i),p(i["after"+n],[],i)}_getRegistryForType(i){for(let t=0;t<this._typedRegistries.length;t++){const e=this._typedRegistries[t];if(e.isForType(i))return e}return this.plugins}_get(e,t,i){const n=t.get(e);if(void 0===n)throw new Error('"'+e+'" is not a registered '+i+".");return n}}var h=new or;class ar{constructor(){this._init=[]}notify(e,t,i,n){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const r=n?this._descriptors(e).filter(n):this._descriptors(e),s=this._notify(r,e,t,i);return"afterDestroy"===t&&(this._notify(r,e,"stop"),this._notify(this._init,e,"uninstall")),s}_notify(t,i,n,r){r=r||{};for(const e of t){const t=e.plugin;if(!1===p(t[n],[i,r,e.options],t)&&r.cancelable)return!1}return!0}invalidate(){x(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const i=e&&e.config,n=O(i.options&&i.options.plugins,{}),r=function(e){const t={},i=[],n=Object.keys(h.plugins.items);for(let e=0;e<n.length;e++)i.push(h.getPlugin(n[e]));const r=e.plugins||[];for(let e=0;e<r.length;e++){const n=r[e];-1===i.indexOf(n)&&(i.push(n),t[n.id]=!0)}return{plugins:i,localIds:t}}(i);return!1!==n||t?function(i,{plugins:n,localIds:r},s,o){const a=[],l=i.getContext();for(const t of n){const n=t.id,e=lr(s[n],o);null!==e&&a.push({plugin:t,options:cr(i.config,{plugin:t,local:r[n]},e,l)})}return a}(e,r,n,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],i=this._cache,n=(e,i)=>e.filter(t=>!i.some(e=>t.plugin.id===e.plugin.id));this._notify(n(t,i),e,"stop"),this._notify(n(i,t),e,"start")}}function lr(e,t){return t||!1!==e?!0===e?{}:e:null}function cr(e,{plugin:t,local:i},n,r){const s=e.pluginScopeKeys(t),o=e.getOptionScopes(n,s);return i&&t.defaults&&o.push(t.defaults),e.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function ur(e,t){const i=D.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||i.indexAxis||"x"}function dr(e){if("x"===e||"y"===e||"r"===e)return e}function hr(t,...i){if(dr(t))return t;for(const e of i){const i=e.axis||("top"===(n=e.position)||"bottom"===n?"x":"left"===n||"right"===n?"y":void 0)||t.length>1&&dr(t[0].toLowerCase());if(i)return i}var n;throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function pr(e,t,i){if(i[t+"AxisID"]===e)return{axis:t}}function fr(o,t){const s=yt[o.type]||{scales:{}},a=t.scales||{},l=ur(o.type,t),c=Object.create(null);return Object.keys(a).forEach(e=>{const t=a[e];if(!N(t))return console.error(`Invalid scale configuration for scale: ${e}`);if(t._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${e}`);const i=hr(e,t,function(t,i){if(i.data&&i.data.datasets){const e=i.data.datasets.filter(e=>e.xAxisID===t||e.yAxisID===t);if(e.length)return pr(t,"x",e[0])||pr(t,"y",e[0])}return{}}(e,o),D.scales[t.type]),n=function(e,t){return e===t?"_index_":"_value_"}(i,l),r=s.scales||{};c[e]=U(Object.create(null),[{axis:i},t,r[i],r[n]])}),o.data.datasets.forEach(n=>{const e=n.type||o.type,r=n.indexAxis||ur(e,t),s=(yt[e]||{}).scales||{};Object.keys(s).forEach(e=>{const t=function(e,t){let i=e;return"_index_"===e?i=t:"_value_"===e&&(i="x"===t?"y":"x"),i}(e,r),i=n[t+"AxisID"]||t;c[i]=c[i]||Object.create(null),U(c[i],[{axis:t},a[i],s[e]])})}),Object.keys(c).forEach(e=>{const t=c[e];U(t,[D.scales[t.type],D.scale])}),c}function gr(e){const t=e.options||(e.options={});t.plugins=O(t.plugins,{}),t.scales=fr(e,t)}function mr(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const vr=new Map,yr=new Set;function br(e,t){let i=vr.get(e);return i||(i=t(),vr.set(e,i),yr.add(i)),i}const Cr=(e,t,i)=>{const n=m(t,i);void 0!==n&&e.add(n)};class wr{constructor(e){this._config=function(e){return(e=e||{}).data=mr(e.data),gr(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=mr(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),gr(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return br(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return br(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return br(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id;return br(`${this.type}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const i=this._scopeCache;let n=i.get(e);return n&&!t||(n=new Map,i.set(e,n)),n}getOptionScopes(t,e,i){const{options:n,type:r}=this,s=this._cachedScopes(t,i),o=s.get(e);if(o)return o;const a=new Set;e.forEach(e=>{t&&(a.add(t),e.forEach(e=>Cr(a,t,e))),e.forEach(e=>Cr(a,n,e)),e.forEach(e=>Cr(a,yt[r]||{},e)),e.forEach(e=>Cr(a,D,e)),e.forEach(e=>Cr(a,bt,e))});const l=Array.from(a);return 0===l.length&&l.push(Object.create(null)),yr.has(e)&&s.set(e,l),l}chartOptionScopes(){const{options:e,type:t}=this;return[e,yt[t]||{},D.datasets[t]||{},{type:t},D,bt]}resolveNamedOptions(e,t,i,n=[""]){const r={$shared:!0},{resolver:s,subPrefixes:o}=_r(this._resolverCache,e,n);let a=s;if(function(n,r){const{isScriptable:s,isIndexable:o}=ei(n);for(const i of r){const r=s(i),e=o(i),t=(e||r)&&n[i];if(r&&(l(t)||Ar(t))||e&&M(t))return!0}return!1}(s,t)){r.$shared=!1;a=Jt(s,i=l(i)?i():i,this.createResolver(e,i,o))}for(const e of t)r[e]=a[e];return r}createResolver(e,t,i=[""],n){const{resolver:r}=_r(this._resolverCache,e,i);return N(t)?Jt(r,t,void 0,n):r}}function _r(e,t,i){let n=e.get(t);n||(n=new Map,e.set(t,n));const r=i.join();let s=n.get(r);if(!s){s={resolver:Zt(t,i),subPrefixes:i.filter(e=>!e.toLowerCase().includes("hover"))},n.set(r,s)}return s}const Ar=i=>N(i)&&Object.getOwnPropertyNames(i).reduce((e,t)=>e||l(i[t]),!1);const Er=["top","bottom","left","right","chartArea"];function Sr(e,t){return"top"===e||"bottom"===e||-1===Er.indexOf(e)&&"x"===t}function Tr(i,n){return function(e,t){return e[i]===t[i]?e[n]-t[n]:e[i]-t[i]}}function xr(e){const t=e.chart,i=t.options.animation;t.notifyPlugins("afterRender"),p(i&&i.onComplete,[e],t)}function Dr(e){const t=e.chart,i=t.options.animation;p(i&&i.onProgress,[e],t)}function Rr(e){return At()&&"string"==typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const Mr={},Nr=e=>{const t=Rr(e);return Object.values(Mr).filter(e=>e.canvas===t).pop()};function Or(i,n,r){const s=Object.keys(i);for(const t of s){const s=+t;if(s>=n){const e=i[t];delete i[t],(r>0||s>n)&&(i[s+r]=e)}}}class i{static defaults=D;static instances=Mr;static overrides=yt;static registry=h;static version="4.3.0";static getChart=Nr;static register(...e){h.add(...e),Ir()}static unregister(...e){h.remove(...e),Ir()}constructor(e,t){const i=this.config=new wr(t),n=Rr(e),r=Nr(n);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const s=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||Nn(n)),this.platform.updateConfig(i);const o=this.platform.acquireContext(n,s.aspectRatio),a=o&&o.canvas,l=a&&a.height,c=a&&a.width;this.id=G(),this.ctx=o,this.canvas=a,this.width=c,this.height=l,this._options=s,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new ar,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Te(e=>this.update(e),s.resizeDelay||0),this._dataChanges=[],Mr[this.id]=this,o&&a?(u.listen(this,"complete",xr),u.listen(this,"progress",Dr),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:i,height:n,_aspectRatio:r}=this;return x(e)?t&&r?r:n?i/n:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return h}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Pt(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Bt(this.canvas,this.ctx),this}stop(){return u.stop(this),this}resize(e,t){u.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const i=this.options,n=this.canvas,r=i.maintainAspectRatio&&this.aspectRatio,s=this.platform.getMaximumSize(n,e,t,r),o=i.devicePixelRatio||this.platform.getDevicePixelRatio(),a=this.width?"resize":"attach";this.width=s.width,this.height=s.height,this._aspectRatio=this.aspectRatio,Pt(this,o,!0)&&(this.notifyPlugins("resize",{size:s}),p(i.onResize,[this,s],this),this.attached&&this._doResize(a)&&this.render())}ensureScalesHaveIDs(){E(this.options.scales||{},(e,t)=>{e.id=t})}buildOrUpdateScales(){const o=this.options,s=o.scales,a=this.scales,l=Object.keys(a).reduce((e,t)=>(e[t]=!1,e),{});let e=[];s&&(e=e.concat(Object.keys(s).map(e=>{const t=s[e],i=hr(e,t),n="r"===i,r="x"===i;return{options:t,dposition:n?"chartArea":r?"bottom":"left",dtype:n?"radialLinear":r?"category":"linear"}}))),E(e,e=>{const t=e.options,i=t.id,n=hr(i,t),r=O(t.type,e.dtype);void 0!==t.position&&Sr(t.position,n)===Sr(e.dposition)||(t.position=e.dposition),l[i]=!0;let s=null;if(i in a&&a[i].type===r)s=a[i];else{s=new(h.getScale(r))({id:i,type:r,ctx:this.ctx,chart:this}),a[s.id]=s}s.init(t,o)}),E(l,(e,t)=>{e||delete a[t]}),E(a,e=>{r.configure(this,e,e.options),r.addBox(this,e)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,i=e.length;if(e.sort((e,t)=>e.index-t.index),i>t){for(let e=t;e<i;++e)this._destroyDatasetMeta(e);e.splice(t,i-t)}this._sortedMetasets=e.slice(0).sort(Tr("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:i}}=this;e.length>i.length&&delete this._stacks,e.forEach((t,e)=>{0===i.filter(e=>e===t._dataset).length&&this._destroyDatasetMeta(e)})}buildOrUpdateControllers(){const n=[],r=this.data.datasets;let s,o;for(this._removeUnreferencedMetasets(),s=0,o=r.length;s<o;s++){const o=r[s];let t=this.getDatasetMeta(s);const i=o.type||this.config.type;if(t.type&&t.type!==i&&(this._destroyDatasetMeta(s),t=this.getDatasetMeta(s)),t.type=i,t.indexAxis=o.indexAxis||ur(i,this.options),t.order=o.order||0,t.index=s,t.label=""+o.label,t.visible=this.isDatasetVisible(s),t.controller)t.controller.updateIndex(s),t.controller.linkScales();else{const r=h.getController(i),{datasetElementType:o,dataElementType:e}=D.datasets[i];Object.assign(r,{dataElementType:h.getElement(e),datasetElementType:o&&h.getElement(o)}),t.controller=new r(this,s),n.push(t.controller)}}return this._updateMetasets(),n}_resetElements(){E(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const i=this.config;i.update();const n=this._options=i.createResolver(i.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let e=0,t=this.data.datasets.length;e<t;e++){const{controller:i}=this.getDatasetMeta(e),n=!r&&-1===s.indexOf(i);i.buildOrUpdateElements(n),o=Math.max(+i.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),r||E(s,e=>{e.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Tr("z","_idx"));const{_active:t,_lastEvent:a}=this;a?this._eventHandler(a,!0):t.length&&this._updateHoverStyles(t,t,!0),this.render()}_updateScales(){E(this.scales,e=>{r.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),i=new Set(e.events);Q(t,i)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:n}=this,r=this._getUniformDataChanges()||[];for(const{method:e,start:t,count:i}of r){Or(n,t,"_removeElements"===e?-i:i)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,i=t=>new Set(e.filter(e=>e[0]===t).map((e,t)=>t+","+e.splice(1).join(","))),n=i(0);for(let e=1;e<t;e++)if(!Q(n,i(e)))return;return Array.from(n).map(e=>e.split(",")).map(e=>({method:e[1],start:+e[2],count:+e[3]}))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;r.update(this,this.width,this.height,e);const t=this.chartArea,i=t.width<=0||t.height<=0;this._layers=[],E(this.boxes,e=>{i&&"chartArea"===e.position||(e.configure&&e.configure(),this._layers.push(...e._layers()))},this),this._layers.forEach((e,t)=>{e._idx=t}),this.notifyPlugins("afterLayout")}_updateDatasets(i){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:i,cancelable:!0})){for(let e=0,t=this.data.datasets.length;e<t;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,t=this.data.datasets.length;e<t;++e)this._updateDataset(e,l(i)?i({datasetIndex:e}):i);this.notifyPlugins("afterDatasetsUpdate",{mode:i})}}_updateDataset(e,t){const i=this.getDatasetMeta(e),n={meta:i,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",n)&&(i.controller._update(t),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(u.has(this)?this.attached&&!u.running(this)&&u.start(this):(this.draw(),xr({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:e,height:t}=this._resizeBeforeDraw;this._resize(e,t),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,i=[];let n,r;for(n=0,r=t.length;n<r;++n){const r=t[n];e&&!r.visible||i.push(r)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,i=e._clip,n=!i.disabled,r=function(e){const{xScale:t,yScale:i}=e;if(t&&i)return{left:t.left,right:t.right,top:i.top,bottom:i.bottom}}(e)||this.chartArea,s={meta:e,index:e.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",s)&&(n&&zt(t,{left:!1===i.left?0:r.left-i.left,right:!1===i.right?this.width:r.right+i.right,top:!1===i.top?0:r.top-i.top,bottom:!1===i.bottom?this.height:r.bottom+i.bottom}),e.controller.draw(),n&&jt(t),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return d(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,i,n){const r=en.modes[t];return"function"==typeof r?r(this,e,i,n):[]}getDatasetMeta(e){const t=this.data.datasets[e],i=this._metasets;let n=i.filter(e=>e&&e._dataset===t).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},i.push(n)),n}getContext(){return this.$context||(this.$context=ki(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const i=this.getDatasetMeta(e);return"boolean"==typeof i.hidden?!i.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(t,e,i){const n=i?"show":"hide",r=this.getDatasetMeta(t),s=r.controller._resolveAnimations(void 0,n);X(e)?(r.data[e].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),s.update(r,{visible:i}),this.update(e=>e.datasetIndex===t?n:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),u.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Bt(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Mr[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const i=this._listeners,n=this.platform,t=(e,t)=>{n.addEventListener(this,e,t),i[e]=t},r=(e,t,i)=>{e.offsetX=t,e.offsetY=i,this._eventHandler(e)};E(this.options.events,e=>t(e,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const i=this._responsiveListeners,n=this.platform,e=(e,t)=>{n.addEventListener(this,e,t),i[e]=t},t=(e,t)=>{i[e]&&(n.removeEventListener(this,e,t),delete i[e])},r=(e,t)=>{this.canvas&&this.resize(e,t)};let s;const o=()=>{t("attach",o),this.attached=!0,this.resize(),e("resize",r),e("detach",s)};s=()=>{this.attached=!1,t("resize",r),this._stop(),this._resize(0,0),e("attach",o)},n.isAttached(this.canvas)?o():s()}unbindEvents(){E(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},E(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,i){const n=i?"set":"remove";let r,s,o,a;for("dataset"===t&&(r=this.getDatasetMeta(e[0].datasetIndex),r.controller["_"+n+"DatasetHoverStyle"]()),o=0,a=e.length;o<a;++o){s=e[o];const t=s&&this.getDatasetMeta(s.datasetIndex).controller;t&&t[n+"HoverStyle"](s.element,s.datasetIndex,s.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],i=e.map(({datasetIndex:e,index:t})=>{const i=this.getDatasetMeta(e);if(!i)throw new Error("No dataset found at index "+e);return{datasetIndex:e,element:i.data[t],index:t}});!B(i,t)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,t))}notifyPlugins(e,t,i){return this._plugins.notify(this,e,t,i)}isPluginEnabled(t){return 1===this._plugins._cache.filter(e=>e.plugin.id===t).length}_updateHoverStyles(e,t,i){const n=this.options.hover,r=(e,i)=>e.filter(t=>!i.some(e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)),s=r(t,e),o=i?e:r(e,t);s.length&&this.updateHoverStyle(s,n.mode,!1),o.length&&n.mode&&this.updateHoverStyle(o,n.mode,!0)}_eventHandler(t,e){const i={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},n=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",i,n))return;const r=this._handleEvent(t,e,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,n),(r||i.changed)&&this.render(),this}_handleEvent(e,t,i){const{_active:n=[],options:r}=this,s=t,o=this._getActiveElements(e,n,i,s),a=Z(e),l=function(e,t,i,n){return i&&"mouseout"!==e.type?n?t:e:null}(e,this._lastEvent,i,a);i&&(this._lastEvent=null,p(r.onHover,[e,o,this],this),a&&p(r.onClick,[e,o,this],this));const c=!B(o,n);return(c||t)&&(this._active=o,this._updateHoverStyles(o,n,t)),this._lastEvent=l,c}_getActiveElements(e,t,i,n){if("mouseout"===e.type)return[];if(!i)return t;const r=this.options.hover;return this.getElementsAtEventForMode(e,r.mode,r,n)}}function Ir(){return E(i.instances,e=>e._plugins.invalidate())}function Pr(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class kr{static override(e){Object.assign(kr.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Pr()}parse(){return Pr()}format(){return Pr()}add(){return Pr()}diff(){return Pr()}startOf(){return Pr()}endOf(){return Pr()}}var Lr={_date:kr};function Fr(e){const t=e.iScale,i=function(r,e){if(!r._cache.$bar){const i=r.getMatchingVisibleMetas(e);let n=[];for(let e=0,t=i.length;e<t;e++)n=n.concat(i[e].controller.getAllParsedValues(r));r._cache.$bar=Ae(n.sort((e,t)=>e-t))}return r._cache.$bar}(t,e.type);let n,r,s,o,a=t._length;const l=()=>{32767!==s&&-32768!==s&&(X(o)&&(a=Math.min(a,Math.abs(s-o)||a)),o=s)};for(n=0,r=i.length;n<r;++n)s=t.getPixelForValue(i[n]),l();for(o=void 0,n=0,r=t.ticks.length;n<r;++n)s=t.getPixelForTick(n),l();return a}function Gr(e,t,i,n){return M(e)?function(e,t,i,n){const r=i.parse(e[0],n),s=i.parse(e[1],n),o=Math.min(r,s),a=Math.max(r,s);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),t[i.axis]=c,t._custom={barStart:l,barEnd:c,start:r,end:s,min:o,max:a}}(e,t,i,n):t[i.axis]=i.parse(e,n),t}function $r(e,t,i,n){const r=e.iScale,s=e.vScale,o=r.getLabels(),a=r===s,l=[];let c,u,d,h;for(c=i,u=i+n;c<u;++c)h=t[c],d={},d[r.axis]=a||r.parse(o[c],c),l.push(Gr(h,d,s,c));return l}function Hr(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function Br(e,t,i,n){let r=t.borderSkipped;const s={};if(!r)return void(e.borderSkipped=s);if(!0===r)return void(e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:o,end:a,reverse:l,top:c,bottom:u}=function(e){let t,i,n,r,s;return e.horizontal?(t=e.base>e.x,i="left",n="right"):(t=e.base<e.y,i="bottom",n="top"),t?(r="end",s="start"):(r="start",s="end"),{start:i,end:n,reverse:t,top:r,bottom:s}}(e);"middle"===r&&i&&(e.enableBorderRadius=!0,(i._top||0)===n?r=c:(i._bottom||0)===n?r=u:(s[Vr(u,o,a,l)]=!0,r=c)),s[Vr(r,o,a,l)]=!0,e.borderSkipped=s}function Vr(e,t,i,n){var r,s,o;return n?(o=i,e=Wr(e=(r=e)===(s=t)?o:r===o?s:r,i,t)):e=Wr(e,t,i),e}function Wr(e,t,i){return"start"===e?t:"end"===e?i:e}function zr(e,{inflateAmount:t},i){e.inflateAmount="auto"===t?1===i?.33:0:t}class jr extends qn{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(s){const e=s.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n,color:r}}=s.legend.options;return e.labels.map((e,t)=>{const i=s.getDatasetMeta(0).controller.getStyle(t);return{text:e,fillStyle:i.backgroundColor,strokeStyle:i.borderColor,fontColor:r,lineWidth:i.borderWidth,pointStyle:n,hidden:!s.getDataVisibility(t),index:t}})}return[]}},onClick(e,t,i){i.chart.toggleDataVisibility(t.index),i.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(n,r){const s=this.getDataset().data,o=this._cachedMeta;if(!1===this._parsing)o._parsed=s;else{let e,t,i=e=>+s[e];if(N(s[n])){const{key:n="value"}=this._parsing;i=e=>+m(s[e],n)}for(e=n,t=n+r;e<t;++e)o._parsed[e]=i(e)}}_getRotation(){return k(this.options.rotation-90)}_getCircumference(){return k(this.options.circumference)}_getRotationExtents(){let r=C,s=-C;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const e=this.chart.getDatasetMeta(n).controller,t=e._getRotation(),i=e._getCircumference();r=Math.min(r,t),s=Math.max(s,t+i)}return{rotation:r,circumference:s-r}}update(e){const t=this.chart,{chartArea:i}=t,n=this._cachedMeta,r=n.data,s=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,o=Math.max((Math.min(i.width,i.height)-s)/2,0),a=Math.min($(this.options.cutout,o),1),l=this._getRingWeight(this.index),{circumference:c,rotation:u}=this._getRotationExtents(),{ratioX:d,ratioY:h,offsetX:p,offsetY:f}=function(h,p,f){let g=1,m=1,v=0,y=0;if(p<C){const n=h,r=n+p,e=Math.cos(n),t=Math.sin(n),i=Math.cos(r),s=Math.sin(r),o=(e,t,i)=>ge(e,n,r,!0)?1:Math.max(t,t*f,i,i*f),a=(e,t,i)=>ge(e,n,r,!0)?-1:Math.min(t,t*f,i,i*f),l=o(0,e,i),c=o(P,t,s),u=a(I,e,i),d=a(I+P,t,s);g=(l-u)/2,m=(c-d)/2,v=-(l+u)/2,y=-(c+d)/2}return{ratioX:g,ratioY:m,offsetX:v,offsetY:y}}(u,c,a),g=(i.width-s)/d,m=(i.height-s)/h,v=Math.max(Math.min(g,m)/2,0),y=H(this.options.radius,v),b=(y-Math.max(y*a,0))/this._getVisibleDatasetWeightTotal();this.offsetX=p*y,this.offsetY=f*y,n.total=this.calculateTotal(),this.outerRadius=y-b*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-b*l,0),this.updateElements(r,0,r.length,e)}_circumference(e,t){const i=this.options,n=this._cachedMeta,r=this._getCircumference();return t&&i.animation.animateRotate||!this.chart.getDataVisibility(e)||null===n._parsed[e]||n.data[e].hidden?0:this.calculateCircumference(n._parsed[e]*r/C)}updateElements(e,t,i,n){const r="reset"===n,s=this.chart,o=s.chartArea,a=s.options.animation,l=(o.left+o.right)/2,c=(o.top+o.bottom)/2,u=r&&a.animateScale,d=u?0:this.innerRadius,h=u?0:this.outerRadius,{sharedOptions:p,includeOptions:f}=this._getSharedOptions(t,n);let g,m=this._getRotation();for(g=0;g<t;++g)m+=this._circumference(g,r);for(g=t;g<t+i;++g){const t=this._circumference(g,r),i=e[g],s={x:l+this.offsetX,y:c+this.offsetY,startAngle:m,endAngle:m+t,circumference:t,outerRadius:h,innerRadius:d};f&&(s.options=p||this.resolveDataElementOptions(g,i.active?"active":n)),m+=t,this.updateElement(i,g,s,n)}}calculateTotal(){const t=this._cachedMeta,i=t.data;let n,r=0;for(n=0;n<i.length;n++){const e=t._parsed[n];null===e||isNaN(e)||!this.chart.getDataVisibility(n)||i[n].hidden||(r+=Math.abs(e))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?C*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,n=i.data.labels||[],r=gt(t._parsed[e],i.options.locale);return{label:n[e]||"",value:r}}getMaxBorderWidth(e){let t=0;const i=this.chart;let n,r,s,o,a;if(!e)for(n=0,r=i.data.datasets.length;n<r;++n)if(i.isDatasetVisible(n)){s=i.getDatasetMeta(n),e=s.data,o=s.controller;break}if(!e)return 0;for(n=0,r=e.length;n<r;++n)a=o.resolveDataElementOptions(n),"inner"!==a.borderAlign&&(t=Math.max(t,a.borderWidth||0,a.hoverBorderWidth||0));return t}getMaxOffset(i){let n=0;for(let e=0,t=i.length;e<t;++e){const i=this.resolveDataElementOptions(e);n=Math.max(n,i.offset||0,i.hoverOffset||0)}return n}_getRingWeightOffset(t){let i=0;for(let e=0;e<t;++e)this.chart.isDatasetVisible(e)&&(i+=this._getRingWeight(e));return i}_getRingWeight(e){return Math.max(O(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class Ur extends qn{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(s){const e=s.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n,color:r}}=s.legend.options;return e.labels.map((e,t)=>{const i=s.getDatasetMeta(0).controller.getStyle(t);return{text:e,fillStyle:i.backgroundColor,strokeStyle:i.borderColor,fontColor:r,lineWidth:i.borderWidth,pointStyle:n,hidden:!s.getDataVisibility(t),index:t}})}return[]}},onClick(e,t,i){i.chart.toggleDataVisibility(t.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,n=i.data.labels||[],r=gt(t._parsed[e].r,i.options.locale);return{label:n[e]||"",value:r}}parseObjectData(e,t,i,n){return di.bind(this)(e,t,i,n)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((e,t)=>{const i=this.getParsed(t).r;!isNaN(i)&&this.chart.getDataVisibility(t)&&(i<n.min&&(n.min=i),i>n.max&&(n.max=i))}),n}_updateRadius(){const e=this.chart,t=e.chartArea,i=e.options,n=Math.min(t.right-t.left,t.bottom-t.top),r=Math.max(n/2,0),s=(r-Math.max(i.cutoutPercentage?r/100*i.cutoutPercentage:1,0))/e.getVisibleDatasetCount();this.outerRadius=r-s*this.index,this.innerRadius=this.outerRadius-s}updateElements(r,s,e,o){const a="reset"===o,l=this.chart,c=l.options.animation,u=this._cachedMeta.rScale,d=u.xCenter,h=u.yCenter,p=u.getIndexAngle(0)-.5*I;let f,g=p;const m=360/this.countVisibleElements();for(f=0;f<s;++f)g+=this._computeAngle(f,o,m);for(f=s;f<s+e;f++){const s=r[f];let e=g,t=g+this._computeAngle(f,o,m),i=l.getDataVisibility(f)?u.getDistanceFromCenterForValue(this.getParsed(f).r):0;g=t,a&&(c.animateScale&&(i=0),c.animateRotate&&(e=t=p));const n={x:d,y:h,innerRadius:0,outerRadius:i,startAngle:e,endAngle:t,options:this.resolveDataElementOptions(f,s.active?"active":o)};this.updateElement(s,f,n,o)}}countVisibleElements(){const e=this._cachedMeta;let i=0;return e.data.forEach((e,t)=>{!isNaN(this.getParsed(t).r)&&this.chart.getDataVisibility(t)&&i++}),i}_computeAngle(e,t,i){return this.chart.getDataVisibility(e)?k(this.resolveDataElementOptions(e,t).angle||i):0}}var Yr=Object.freeze({__proto__:null,BarController:class extends qn{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,i,n){return $r(e,t,i,n)}parseArrayData(e,t,i,n){return $r(e,t,i,n)}parseObjectData(e,t,i,n){const{iScale:r,vScale:s}=e,{xAxisKey:o="x",yAxisKey:a="y"}=this._parsing,l="x"===r.axis?o:a,c="x"===s.axis?o:a,u=[];let d,h,p,f;for(d=i,h=i+n;d<h;++d)f=t[d],p={},p[r.axis]=r.parse(m(f,l),d),u.push(Gr(m(f,c),p,s,d));return u}updateRangeFromParsed(e,t,i,n){super.updateRangeFromParsed(e,t,i,n);const r=i._custom;r&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,r.min),e.max=Math.max(e.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:i,vScale:n}=t,r=this.getParsed(e),s=r._custom,o=Hr(s)?"["+s.start+", "+s.end+"]":""+n.getLabelForValue(r[n.axis]);return{label:""+i.getLabelForValue(r[i.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(s,o,a,l){const c="reset"===l,{index:u,_cachedMeta:{vScale:d}}=this,h=d.getBasePixel(),p=d.isHorizontal(),f=this._getRuler(),{sharedOptions:g,includeOptions:m}=this._getSharedOptions(o,l);for(let r=o;r<o+a;r++){const o=this.getParsed(r),a=c||x(o[d.axis])?{base:h,head:h}:this._calculateBarValuePixels(r),e=this._calculateBarIndexPixels(r,f),t=(o._stacks||{})[d.axis],i={horizontal:p,base:a.base,enableBorderRadius:!t||Hr(o._custom)||u===t._top||u===t._bottom,x:p?a.head:e.center,y:p?e.center:a.head,height:p?e.size:Math.abs(a.size),width:p?Math.abs(a.size):e.size};m&&(i.options=g||this.resolveDataElementOptions(r,s[r].active?"active":l));const n=i.options||s[r].options;Br(i,n,t,u),zr(i,n,f.ratio),this.updateElement(s[r],r,i,l)}}_getStacks(e,n){const{iScale:t}=this._cachedMeta,i=t.getMatchingVisibleMetas(this._type).filter(e=>e.controller.options.grouped),r=t.options.stacked,s=[],o=e=>{const t=e.controller.getParsed(n),i=t&&t[e.vScale.axis];if(x(i)||isNaN(i))return!0};for(const t of i)if((void 0===n||!o(t))&&((!1===r||-1===s.indexOf(t.stack)||void 0===r&&void 0===t.stack)&&s.push(t.stack),t.index===e))break;return s.length||s.push(void 0),s}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,i){const n=this._getStacks(e,i),r=void 0!==t?n.indexOf(t):-1;return-1===r?n.length-1:r}_getRuler(){const e=this.options,t=this._cachedMeta,i=t.iScale,n=[];let r,s;for(r=0,s=t.data.length;r<s;++r)n.push(i.getPixelForValue(this.getParsed(r)[i.axis],r));const o=e.barThickness;return{min:o||Fr(t),pixels:n,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:e.grouped,ratio:o?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:i,index:n},options:{base:r,minBarLength:s}}=this,o=r||0,a=this.getParsed(e),l=a._custom,c=Hr(l);let u,d,h=a[t.axis],p=0,f=i?this.applyStack(t,a,i):h;f!==h&&(p=f-h,f=h),c&&(h=l.barStart,f=l.barEnd-l.barStart,0!==h&&v(h)!==v(l.barEnd)&&(p=0),p+=h);const g=x(r)||c?p:r;let m=t.getPixelForValue(g);if(u=this.chart.getDataVisibility(e)?t.getPixelForValue(p+f):m,d=u-m,Math.abs(d)<s){d=function(e,t,i){return 0!==e?v(e):(t.isHorizontal()?1:-1)*(t.min>=i?1:-1)}(d,t,o)*s,h===o&&(m-=d/2);const e=t.getPixelForDecimal(0),x=t.getPixelForDecimal(1),r=Math.min(e,x),l=Math.max(e,x);m=Math.max(Math.min(m,l),r),u=m+d,i&&!c&&(a._stacks[t.axis]._visualValues[n]=t.getValueForPixel(u)-t.getValueForPixel(m))}if(m===t.getPixelForValue(o)){const e=v(d)*t.getLineWidthForValue(o)/2;m+=e,d-=e}return{size:d,base:m,head:u,center:u+d/2}}_calculateBarIndexPixels(t,i){const n=i.scale,r=this.options,s=r.skipNull,o=O(r.maxBarThickness,1/0);let a,l;if(i.grouped){const n=s?this._getStackCount(t):i.stackCount,O="flex"===r.barThickness?function(e,t,i,n){const r=t.pixels,s=r[e];let o=e>0?r[e-1]:null,a=e<r.length-1?r[e+1]:null;const l=i.categoryPercentage;null===o&&(o=s-(null===a?t.end-t.start:a-s)),null===a&&(a=s+s-o);const c=s-(s-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/n,ratio:i.barPercentage,start:c}}(t,i,r,n):function(e,t,i,n){const r=i.barThickness;let s,o;return x(r)?(s=t.min*i.categoryPercentage,o=i.barPercentage):(s=r*n,o=1),{chunk:s/n,ratio:o,start:t.pixels[e]-s/2}}(t,i,r,n),e=this._getStackIndex(this.index,this._cachedMeta.stack,s?t:void 0);a=O.start+O.chunk*e+O.chunk/2,l=Math.min(o,O.chunk*O.ratio)}else a=n.getPixelForValue(this.getParsed(t)[n.axis],t),l=Math.min(o,i.min*i.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,t=e.vScale,i=e.data,n=i.length;let r=0;for(;r<n;++r)null!==this.getParsed(r)[t.axis]&&i[r].draw(this._ctx)}},BubbleController:class extends qn{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,i,n){const r=super.parsePrimitiveData(e,t,i,n);for(let e=0;e<r.length;e++)r[e]._custom=this.resolveDataElementOptions(e+i).radius;return r}parseArrayData(e,t,i,n){const r=super.parseArrayData(e,t,i,n);for(let e=0;e<r.length;e++){const n=t[i+e];r[e]._custom=O(n[2],this.resolveDataElementOptions(e+i).radius)}return r}parseObjectData(e,t,i,n){const r=super.parseObjectData(e,t,i,n);for(let e=0;e<r.length;e++){const n=t[i+e];r[e]._custom=O(n&&n.r&&+n.r,this.resolveDataElementOptions(e+i).radius)}return r}getMaxOverflow(){const t=this._cachedMeta.data;let i=0;for(let e=t.length-1;e>=0;--e)i=Math.max(i,t[e].size(this.resolveDataElementOptions(e))/2);return i>0&&i}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart.data.labels||[],{xScale:n,yScale:r}=t,s=this.getParsed(e),o=n.getLabelForValue(s.x),a=r.getLabelForValue(s.y),l=s._custom;return{label:i[e]||"",value:"("+o+", "+a+(l?", "+l:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(r,s,o,a){const l="reset"===a,{iScale:c,vScale:u}=this._cachedMeta,{sharedOptions:d,includeOptions:h}=this._getSharedOptions(s,a),p=c.axis,f=u.axis;for(let n=s;n<s+o;n++){const s=r[n],o=!l&&this.getParsed(n),e={},t=e[p]=l?c.getPixelForDecimal(.5):c.getPixelForValue(o[p]),i=e[f]=l?u.getBasePixel():u.getPixelForValue(o[f]);e.skip=isNaN(t)||isNaN(i),h&&(e.options=d||this.resolveDataElementOptions(n,s.active?"active":a),l&&(e.options.radius=0)),this.updateElement(s,n,e,a)}}resolveDataElementOptions(e,t){const i=this.getParsed(e);let n=super.resolveDataElementOptions(e,t);n.$shared&&(n=Object.assign({},n,{$shared:!1}));const r=n.radius;return"active"!==t&&(n.radius=0),n.radius+=O(i&&i._custom,r),n}},DoughnutController:jr,LineController:class extends qn{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:i,data:n=[],_dataset:r}=t,s=this.chart._animationsDisabled;let{start:o,count:a}=Re(t,n,s);this._drawStart=o,this._drawCount=a,Me(t)&&(o=0,a=n.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!r._decimated,i.points=n;const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(i,void 0,{animated:!s,options:l},e),this.updateElements(n,o,a,e)}updateElements(s,o,e,a){const l="reset"===a,{iScale:c,vScale:u,_stacked:d,_dataset:h}=this._cachedMeta,{sharedOptions:p,includeOptions:f}=this._getSharedOptions(o,a),g=c.axis,m=u.axis,{spanGaps:v,segment:y}=this.options,b=ae(v)?v:Number.POSITIVE_INFINITY,C=this.chart._animationsDisabled||l||"none"===a,w=o+e,_=s.length;let A=o>0&&this.getParsed(o-1);for(let r=0;r<_;++r){const v=s[r],_=C?v:{};if(r<o||r>=w){_.skip=!0;continue}const e=this.getParsed(r),t=x(e[m]),i=_[g]=c.getPixelForValue(e[g],r),n=_[m]=l||t?u.getBasePixel():u.getPixelForValue(d?this.applyStack(u,e,d):e[m],r);_.skip=isNaN(i)||isNaN(n)||t,_.stop=r>0&&Math.abs(e[g]-A[g])>b,y&&(_.parsed=e,_.raw=h.data[r]),f&&(_.options=p||this.resolveDataElementOptions(r,v.active?"active":a)),C||this.updateElement(v,r,_,a),A=e}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,i=t.options&&t.options.borderWidth||0,n=e.data||[];if(!n.length)return i;const r=n[0].size(this.resolveDataElementOptions(0)),s=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(i,r,s)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}},PieController:class extends jr{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}},PolarAreaController:Ur,RadarController:class extends qn{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(e){const t=this._cachedMeta.vScale,i=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(i[t.axis])}}parseObjectData(e,t,i,n){return di.bind(this)(e,t,i,n)}update(t){const i=this._cachedMeta,n=i.dataset,r=i.data||[],s=i.iScale.getLabels();if(n.points=r,"resize"!==t){const i=this.resolveDatasetElementOptions(t);this.options.showLine||(i.borderWidth=0);const e={_loop:!0,_fullLoop:s.length===r.length,options:i};this.updateElement(n,void 0,e,t)}this.updateElements(r,0,r.length,t)}updateElements(s,o,a,l){const c=this._cachedMeta.rScale,u="reset"===l;for(let r=o;r<o+a;r++){const o=s[r],a=this.resolveDataElementOptions(r,o.active?"active":l),e=c.getPointPositionForValue(r,this.getParsed(r).r),t=u?c.xCenter:e.x,i=u?c.yCenter:e.y,n={x:t,y:i,angle:e.angle,skip:isNaN(t)||isNaN(i),options:a};this.updateElement(o,r,n,l)}}},ScatterController:class extends qn{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(e){const t=this._cachedMeta,i=this.chart.data.labels||[],{xScale:n,yScale:r}=t,s=this.getParsed(e),o=n.getLabelForValue(s.x),a=r.getLabelForValue(s.y);return{label:i[e]||"",value:"("+o+", "+a+")"}}update(t){const i=this._cachedMeta,{data:n=[]}=i,r=this.chart._animationsDisabled;let{start:s,count:o}=Re(i,n,r);if(this._drawStart=s,this._drawCount=o,Me(i)&&(s=0,o=n.length),this.options.showLine){const{dataset:s,_dataset:o}=i;s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!o._decimated,s.points=n;const e=this.resolveDatasetElementOptions(t);e.segment=this.options.segment,this.updateElement(s,void 0,{animated:!r,options:e},t)}this.updateElements(n,s,o,t)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(r,s,o,a){const l="reset"===a,{iScale:c,vScale:u,_stacked:d,_dataset:h}=this._cachedMeta,e=this.resolveDataElementOptions(s,a),p=this.getSharedOptions(e),f=this.includeOptions(a,p),g=c.axis,m=u.axis,{spanGaps:v,segment:y}=this.options,b=ae(v)?v:Number.POSITIVE_INFINITY,C=this.chart._animationsDisabled||l||"none"===a;let w=s>0&&this.getParsed(s-1);for(let n=s;n<s+o;++n){const s=r[n],o=this.getParsed(n),v=C?s:{},e=x(o[m]),t=v[g]=c.getPixelForValue(o[g],n),i=v[m]=l||e?u.getBasePixel():u.getPixelForValue(d?this.applyStack(u,o,d):o[m],n);v.skip=isNaN(t)||isNaN(i)||e,v.stop=n>0&&Math.abs(o[g]-w[g])>b,y&&(v.parsed=o,v.raw=h.data[n]),f&&(v.options=p||this.resolveDataElementOptions(n,s.active?"active":a)),C||this.updateElement(s,n,v,a),w=o}this.updateSharedOptions(p,a,e)}getMaxOverflow(){const e=this._cachedMeta,i=e.data||[];if(!this.options.showLine){let t=0;for(let e=i.length-1;e>=0;--e)t=Math.max(t,i[e].size(this.resolveDataElementOptions(e))/2);return t>0&&t}const t=e.dataset,n=t.options&&t.options.borderWidth||0;if(!i.length)return n;const r=i[0].size(this.resolveDataElementOptions(0)),s=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,r,s)/2}}});function qr(e,t,i,n){const r=Mi(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const s=(i-t)/2,o=Math.min(s,n*t/2),a=e=>{const t=(i-Math.min(s,e))*n/2;return b(e,0,Math.min(s,t))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:b(r.innerStart,0,o),innerEnd:b(r.innerEnd,0,o)}}function Kr(e,t,i,n){return{x:i+e*Math.cos(t),y:n+e*Math.sin(t)}}function Xr(e,t,i,n,r,s){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=t,d=Math.max(t.outerRadius+n+i-c,0),h=u>0?u+n+i+c:0;let p=0;const f=r-l;if(n){const e=((u>0?u-n:0)+(d>0?d-n:0))/2;p=(f-(0!==e?f*e/(e+n):f))/2}const g=(f-Math.max(.001,f*d-i/I)/d)/2,m=l+g+p,v=r-g-p,{outerStart:y,outerEnd:b,innerStart:C,innerEnd:w}=qr(t,h,d,v-m),_=d-y,A=d-b,E=m+y/_,S=v-b/A,T=h+C,x=h+w,D=m+C/T,R=v-w/x;if(e.beginPath(),s){const t=(E+S)/2;if(e.arc(o,a,d,E,t),e.arc(o,a,d,t,S),b>0){const t=Kr(A,S,o,a);e.arc(t.x,t.y,b,S,v+P)}const i=Kr(x,v,o,a);if(e.lineTo(i.x,i.y),w>0){const t=Kr(x,R,o,a);e.arc(t.x,t.y,w,v+P,R+Math.PI)}const n=(v-w/h+(m+C/h))/2;if(e.arc(o,a,h,v-w/h,n,!0),e.arc(o,a,h,n,m+C/h,!0),C>0){const t=Kr(T,D,o,a);e.arc(t.x,t.y,C,D+Math.PI,m-P)}const r=Kr(_,m,o,a);if(e.lineTo(r.x,r.y),y>0){const t=Kr(_,E,o,a);e.arc(t.x,t.y,y,m-P,E)}}else{e.moveTo(o,a);const t=Math.cos(E)*d+o,i=Math.sin(E)*d+a;e.lineTo(t,i);const n=Math.cos(S)*d+o,r=Math.sin(S)*d+a;e.lineTo(n,r)}e.closePath()}function Qr(t,e,i,n,r){const{fullCircles:s,startAngle:o,circumference:a,options:l}=e,{borderWidth:c,borderJoinStyle:u,borderDash:d,borderDashOffset:h}=l,p="inner"===l.borderAlign;if(!c)return;t.setLineDash(d||[]),t.lineDashOffset=h,p?(t.lineWidth=2*c,t.lineJoin=u||"round"):(t.lineWidth=c,t.lineJoin=u||"bevel");let f=e.endAngle;if(s){Xr(t,e,i,n,f,r);for(let e=0;e<s;++e)t.stroke();isNaN(a)||(f=o+(a%C||C))}p&&function(e,t,i){const{startAngle:n,pixelMargin:r,x:s,y:o,outerRadius:a,innerRadius:l}=t;let c=r/a;e.beginPath(),e.arc(s,o,a,n-c,i+c),l>r?(c=r/l,e.arc(s,o,l,i+c,n-c,!0)):e.arc(s,o,r,i+P,n-P),e.closePath(),e.clip()}(t,e,f),s||(Xr(t,e,i,n,f,r),t.stroke())}function Zr(e,t,i=t){e.lineCap=O(i.borderCapStyle,t.borderCapStyle),e.setLineDash(O(i.borderDash,t.borderDash)),e.lineDashOffset=O(i.borderDashOffset,t.borderDashOffset),e.lineJoin=O(i.borderJoinStyle,t.borderJoinStyle),e.lineWidth=O(i.borderWidth,t.borderWidth),e.strokeStyle=O(i.borderColor,t.borderColor)}function Jr(e,t,i){e.lineTo(i.x,i.y)}function es(e,t,i={}){const n=e.length,{start:r=0,end:s=n-1}=i,{start:o,end:a}=t,l=Math.max(r,o),c=Math.min(s,a),u=r<o&&s<o||r>a&&s>a;return{count:n,start:l,loop:t.loop,ilen:c<l&&!u?n+c-l:c-l}}function ts(e,t,i,n){const{points:r,options:s}=t,{count:o,start:a,loop:l,ilen:c}=es(r,i,n),u=function(e){return e.stepped?Ut:e.tension||"monotone"===e.cubicInterpolationMode?Yt:Jr}(s);let d,h,p,{move:f=!0,reverse:g}=n||{};for(d=0;d<=c;++d)h=r[(a+(g?c-d:d))%o],h.skip||(f?(e.moveTo(h.x,h.y),f=!1):u(e,p,h,g,s.stepped),p=h);return l&&(h=r[(a+(g?c:0))%o],u(e,p,h,g,s.stepped)),!!l}function is(e,t,i,n){const r=t.points,{count:s,start:o,ilen:a}=es(r,i,n),{move:l=!0,reverse:c}=n||{};let u,d,h,p,f,g,m=0,v=0;const y=e=>(o+(c?a-e:e))%s,b=()=>{p!==f&&(e.lineTo(m,f),e.lineTo(m,p),e.lineTo(m,g))};for(l&&(d=r[y(0)],e.moveTo(d.x,d.y)),u=0;u<=a;++u){if(d=r[y(u)],d.skip)continue;const t=d.x,i=d.y,n=0|t;n===h?(i<p?p=i:i>f&&(f=i),m=(v*m+t)/++v):(b(),e.lineTo(t,i),h=n,v=0,p=f=i),g=i}b()}function ns(e){const t=e.options,i=t.borderDash&&t.borderDash.length;return!(e._decimated||e._loop||t.tension||"monotone"===t.cubicInterpolationMode||t.stepped||i)?is:ts}const rs="function"==typeof Path2D;function ss(e,t,i,n){rs&&!t.options.segment?function(e,t,i,n){let r=t._path;r||(r=t._path=new Path2D,t.path(r,i,n)&&r.closePath()),Zr(e,t.options),e.stroke(r)}(e,t,i,n):function(t,i,n,r){const{segments:s,options:o}=i,a=ns(i);for(const e of s)Zr(t,o,e.style),t.beginPath(),a(t,i,e,{start:n,end:n+r-1})&&t.closePath(),t.stroke()}(e,t,i,n)}class os extends t{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(t,i){const n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){const e=n.spanGaps?this._loop:this._fullLoop;yi(this._points,n,t,e,i),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Wi(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,i=e.length;return i&&t[e[i-1].end]}interpolate(r,s){const o=this.options,a=r[s],l=this.points,c=Vi(this,{property:s,start:a,end:a});if(!c.length)return;const u=[],d=function(e){return e.stepped?Ei:e.tension||"monotone"===e.cubicInterpolationMode?Si:Ai}(o);let h,p;for(h=0,p=c.length;h<p;++h){const{start:p,end:e}=c[h],t=l[p],i=l[e];if(t===i){u.push(t);continue}const n=d(t,i,Math.abs((a-t[s])/(i[s]-t[s])),o.stepped);n[s]=r[s],u.push(n)}return 1===u.length?u[0]:u}pathSegment(e,t,i){return ns(this)(e,this,t,i)}path(t,i,n){const r=this.segments,s=ns(this);let o=this._loop;i=i||0,n=n||this.points.length-i;for(const e of r)o&=s(t,this,e,{start:i,end:i+n-1});return!!o}draw(e,t,i,n){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(e.save(),ss(e,this,i,n),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function as(e,t,i,n){const r=e.options,{[i]:s}=e.getProps([i],n);return Math.abs(t-s)<r.radius+r.hitRadius}function ls(e,t){const{x:i,y:n,base:r,width:s,height:o}=e.getProps(["x","y","base","width","height"],t);let a,l,c,u,d;return e.horizontal?(d=o/2,a=Math.min(i,r),l=Math.max(i,r),c=n-d,u=n+d):(d=s/2,a=i-d,l=i+d,c=Math.min(n,r),u=Math.max(n,r)),{left:a,top:c,right:l,bottom:u}}function cs(e,t,i,n){return e?0:b(t,i,n)}function us(e){const t=ls(e),i=t.right-t.left,n=t.bottom-t.top,r=function(e,t,i){const n=e.options.borderWidth,r=e.borderSkipped,s=Ni(n);return{t:cs(r.top,s.top,0,i),r:cs(r.right,s.right,0,t),b:cs(r.bottom,s.bottom,0,i),l:cs(r.left,s.left,0,t)}}(e,i/2,n/2),s=function(e,t,i){const{enableBorderRadius:n}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,s=Oi(r),o=Math.min(t,i),a=e.borderSkipped,l=n||N(r);return{topLeft:cs(!l||a.top||a.left,s.topLeft,0,o),topRight:cs(!l||a.top||a.right,s.topRight,0,o),bottomLeft:cs(!l||a.bottom||a.left,s.bottomLeft,0,o),bottomRight:cs(!l||a.bottom||a.right,s.bottomRight,0,o)}}(e,i/2,n/2);return{outer:{x:t.left,y:t.top,w:i,h:n,radius:s},inner:{x:t.left+r.l,y:t.top+r.t,w:i-r.l-r.r,h:n-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function ds(e,t,i,n){const r=null===t,s=null===i,o=e&&!(r&&s)&&ls(e,n);return o&&(r||w(t,o.left,o.right))&&(s||w(i,o.top,o.bottom))}function hs(e,t){e.rect(t.x,t.y,t.w,t.h)}function ps(e,t,i={}){const n=e.x!==i.x?-t:0,r=e.y!==i.y?-t:0,s=(e.x+e.w!==i.x+i.w?t:0)-n,o=(e.y+e.h!==i.y+i.h?t:0)-r;return{x:e.x+n,y:e.y+r,w:e.w+s,h:e.h+o,radius:e.radius}}var fs=Object.freeze({__proto__:null,ArcElement:class extends t{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,i){const n=this.getProps(["x","y"],i),{angle:r,distance:s}=he(n,{x:e,y:t}),{startAngle:o,endAngle:a,innerRadius:l,outerRadius:c,circumference:u}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),d=(this.options.spacing+this.options.borderWidth)/2,h=O(u,a-o)>=C||ge(r,o,a),p=w(s,l+d,c+d);return h&&p}getCenterPoint(e){const{x:t,y:i,startAngle:n,endAngle:r,innerRadius:s,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:a,spacing:l}=this.options,c=(n+r)/2,u=(s+o+l+a)/2;return{x:t+Math.cos(c)*u,y:i+Math.sin(c)*u}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:i}=this,n=(t.offset||0)/4,r=(t.spacing||0)/2,s=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=i>C?Math.floor(i/C):0,0===i||this.innerRadius<0||this.outerRadius<0)return;e.save();const o=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(o)*n,Math.sin(o)*n);const a=n*(1-Math.sin(Math.min(I,i||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(t,e,i,n,r){const{fullCircles:s,startAngle:o,circumference:a}=e;let l=e.endAngle;if(s){Xr(t,e,i,n,l,r);for(let e=0;e<s;++e)t.fill();isNaN(a)||(l=o+(a%C||C))}Xr(t,e,i,n,l,r),t.fill()}(e,this,a,r,s),Qr(e,this,a,r,s),e.restore()}},BarElement:class extends t{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:i,backgroundColor:n}}=this,{inner:r,outer:s}=us(this),o=(a=s.radius).topLeft||a.topRight||a.bottomLeft||a.bottomRight?Qt:hs;var a;e.save(),s.w===r.w&&s.h===r.h||(e.beginPath(),o(e,ps(s,t,r)),e.clip(),o(e,ps(r,-t,s)),e.fillStyle=i,e.fill("evenodd")),e.beginPath(),o(e,ps(r,t)),e.fillStyle=n,e.fill(),e.restore()}inRange(e,t,i){return ds(this,e,t,i)}inXRange(e,t){return ds(this,e,null,t)}inYRange(e,t){return ds(this,null,e,t)}getCenterPoint(e){const{x:t,y:i,base:n,horizontal:r}=this.getProps(["x","y","base","horizontal"],e);return{x:r?(t+n)/2:t,y:r?i:(i+n)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}},LineElement:os,PointElement:class extends t{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,i){const n=this.options,{x:r,y:s}=this.getProps(["x","y"],i);return Math.pow(e-r,2)+Math.pow(t-s,2)<Math.pow(n.hitRadius+n.radius,2)}inXRange(e,t){return as(this,e,"x",t)}inYRange(e,t){return as(this,e,"y",t)}getCenterPoint(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}size(e){let t=(e=e||this.options||{}).radius||0;t=Math.max(t,t&&e.hoverRadius||0);return 2*(t+(t&&e.borderWidth||0))}draw(e,t){const i=this.options;this.skip||i.radius<.1||!d(this,t,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,Vt(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}});function gs(e,t,i,n){const r=e.indexOf(t);if(-1===r)return((e,t,i,n)=>("string"==typeof t?(i=e.push(t)-1,n.unshift({index:i,label:t})):isNaN(t)&&(i=null),i))(e,t,i,n);return r!==e.lastIndexOf(t)?i:r}function ms(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}function vs(e,t,{horizontal:i,minRotation:n}){const r=k(n),s=(i?Math.sin(r):Math.cos(r))||.001,o=.75*t*(""+e).length;return Math.min(t/s,o)}class ys extends rr{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return x(e)||("number"==typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:i,maxDefined:n}=this.getUserBounds();let{min:r,max:s}=this;const o=e=>r=i?r:e,a=e=>s=n?s:e;if(t){const t=v(r),i=v(s);t<0&&i<0?a(0):t>0&&i>0&&o(0)}if(r===s){let e=0===s?1:Math.abs(.05*s);a(s+e),t||o(r-e)}this.min=r,this.max=s}getTickLimit(){const e=this.options.ticks;let t,{maxTicksLimit:i,stepSize:n}=e;return n?(t=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,t>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${t} ticks. Limiting to 1000.`),t=1e3)):(t=this.computeTickLimit(),i=i||11),i&&(t=Math.min(i,t)),t}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let i=this.getTickLimit();i=Math.max(2,i);const n=function(e,t){const i=[],{bounds:n,step:r,min:s,max:o,precision:a,count:l,maxTicks:c,maxDigits:u,includeBounds:d}=e,h=r||1,p=c-1,{min:f,max:g}=t,m=!x(s),v=!x(o),y=!x(l),b=(g-f)/(u+1);let C,w,_,A,E=se((g-f)/p/h)*h;if(E<1e-14&&!m&&!v)return[{value:f},{value:g}];A=Math.ceil(g/E)-Math.floor(f/E),A>p&&(E=se(A*E/p/h)*h),x(a)||(C=Math.pow(10,a),E=Math.ceil(E*C)/C),"ticks"===n?(w=Math.floor(f/E)*E,_=Math.ceil(g/E)*E):(w=f,_=g),m&&v&&r&&le((o-s)/r,E/1e3)?(A=Math.round(Math.min((o-s)/E,c)),E=(o-s)/A,w=s,_=o):y?(w=m?s:w,_=v?o:_,A=l-1,E=(_-w)/A):(A=(_-w)/E,A=re(A,Math.round(A),E/1e3)?Math.round(A):Math.ceil(A));const S=Math.max(de(E),de(w));C=Math.pow(10,x(a)?S:a),w=Math.round(w*C)/C,_=Math.round(_*C)/C;let T=0;for(m&&(d&&w!==s?(i.push({value:s}),w<s&&T++,re(Math.round((w+T*E)*C)/C,s,vs(s,b,e))&&T++):w<s&&T++);T<A;++T){const e=Math.round((w+T*E)*C)/C;if(v&&e>o)break;i.push({value:e})}return v&&d&&_!==o?i.length&&re(i[i.length-1].value,o,vs(o,b,e))?i[i.length-1].value=o:i.push({value:o}):v&&_!==o||i.push({value:_}),i}({maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&ce(n,this,"value"),e.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}configure(){const t=this.ticks;let i=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const e=(n-i)/Math.max(t.length-1,1)/2;i-=e,n+=e}this._startValue=i,this._endValue=n,this._valueRange=n-i}getLabelForValue(e){return gt(e,this.chart.options.locale,this.options.ticks.format)}}class bs extends ys{static id="linear";static defaults={ticks:{callback:vt.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=f(e)?e:0,this.max=f(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,i=k(this.options.ticks.minRotation),n=(e?Math.sin(i):Math.cos(i))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,r.lineHeight/n))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const Cs=e=>Math.floor(c(e)),ws=(e,t)=>Math.pow(10,Cs(e)+t);function _s(e){return 1===e/Math.pow(10,Cs(e))}function As(e,t,i){const n=Math.pow(10,i),r=Math.floor(e/n);return Math.ceil(t/n)-r}function Es(e,{min:t,max:i}){t=g(e.min,t);const n=[],r=Cs(t);let s=function(e,t){let i=Cs(t-e);for(;As(e,t,i)>10;)i++;for(;As(e,t,i)<10;)i--;return Math.min(i,Cs(e))}(t,i),o=s<0?Math.pow(10,Math.abs(s)):1;const a=Math.pow(10,s),l=r>s?Math.pow(10,r):0,c=Math.round((t-l)*o)/o,u=Math.floor((t-l)/a/10)*a*10;let d=Math.floor((c-u)/Math.pow(10,s)),h=g(e.min,Math.round((l+u+d*Math.pow(10,s))*o)/o);for(;h<i;)n.push({value:h,major:_s(h),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(s++,d=2,o=s>=0?1:o),h=Math.round((l+u+d*Math.pow(10,s))*o)/o;const p=g(e.max,h);return n.push({value:p,major:_s(p),significand:d}),n}class Ss extends rr{static id="logarithmic";static defaults={ticks:{callback:vt.formatters.logarithmic,major:{enabled:!0}}};constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const i=ys.prototype.parse.apply(this,[e,t]);if(0!==i)return f(i)&&i>0?i:null;this._zero=!0}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=f(e)?Math.max(0,e):null,this.max=f(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!f(this._userMin)&&(this.min=e===ws(this.min,0)?ws(this.min,-1):ws(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:i}=this.getUserBounds();let n=this.min,r=this.max;const e=e=>n=t?n:e,s=e=>r=i?r:e;n===r&&(n<=0?(e(1),s(10)):(e(ws(n,-1)),s(ws(r,1)))),n<=0&&e(ws(r,-1)),r<=0&&s(ws(n,1)),this.min=n,this.max=r}buildTicks(){const e=this.options,t=Es({min:this._userMin,max:this._userMax},this);return"ticks"===e.bounds&&ce(t,this,"value"),e.reverse?(t.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),t}getLabelForValue(e){return void 0===e?"0":gt(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=c(e),this._valueRange=c(this.max)-c(e)}getPixelForValue(e){return void 0!==e&&0!==e||(e=this.min),null===e||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(c(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}function Ts(e){const t=e.ticks;if(t.display&&e.display){const e=L(t.backdropPadding);return O(t.font&&t.font.size,D.font.size)+e.height}return 0}function xs(e,t,i,n,r){return e===n||e===r?{start:t-i/2,end:t+i/2}:e<n||e>r?{start:t-i,end:t}:{start:t,end:t+i}}function Ds(o){const a={l:o.left+o._padding.left,r:o.right-o._padding.right,t:o.top+o._padding.top,b:o.bottom-o._padding.bottom},l=Object.assign({},a),c=[],u=[],d=o._pointLabels.length,h=o.options.pointLabels,p=h.centerPointLabels?I/d:0;for(let s=0;s<d;s++){const d=h.setContext(o.getPointLabelContext(s));u[s]=d.padding;const e=o.getPointPosition(s,o.drawingArea+u[s],p),t=R(d.font),i=(f=o.ctx,g=t,m=M(m=o._pointLabels[s])?m:[m],{w:$t(f,g.string,m),h:m.length*g.lineHeight});c[s]=i;const n=y(o.getIndexAngle(s)+p),r=Math.round(ue(n));Rs(l,a,n,xs(r,e.x,i.w,0,180),xs(r,e.y,i.h,90,270))}var f,g,m;o.setCenterPoint(a.l-l.l,l.r-a.r,a.t-l.t,l.b-a.b),o._pointLabelItems=function(t,i,n){const r=[],s=t._pointLabels.length,e=t.options,{centerPointLabels:o,display:a}=e.pointLabels,l={extra:Ts(e)/2,additionalAngle:o?I/s:0};let c;for(let e=0;e<s;e++){l.padding=n[e],l.size=i[e];const s=Ms(t,e,l);r.push(s),"auto"===a&&(s.visible=Ns(s,c),s.visible&&(c=s))}return r}(o,c,u)}function Rs(e,t,i,n,r){const s=Math.abs(Math.sin(i)),o=Math.abs(Math.cos(i));let a=0,l=0;n.start<t.l?(a=(t.l-n.start)/s,e.l=Math.min(e.l,t.l-a)):n.end>t.r&&(a=(n.end-t.r)/s,e.r=Math.max(e.r,t.r+a)),r.start<t.t?(l=(t.t-r.start)/o,e.t=Math.min(e.t,t.t-l)):r.end>t.b&&(l=(r.end-t.b)/o,e.b=Math.max(e.b,t.b+l))}function Ms(e,t,i){const n=e.drawingArea,{extra:r,additionalAngle:s,padding:o,size:a}=i,l=e.getPointPosition(t,n+r+o,s),c=Math.round(ue(y(l.angle+P))),u=function(e,t,i){90===i||270===i?e-=t/2:(i>270||i<90)&&(e-=t);return e}(l.y,a.h,c),d=function(e){if(0===e||180===e)return"center";if(e<180)return"left";return"right"}(c),h=function(e,t,i){"right"===i?e-=t:"center"===i&&(e-=t/2);return e}(l.x,a.w,d);return{visible:!0,x:l.x,y:u,textAlign:d,left:h,top:u,right:h+a.w,bottom:u+a.h}}function Ns(e,t){if(!t)return!0;const{left:i,top:n,right:r,bottom:s}=e;return!(d({x:i,y:n},t)||d({x:i,y:s},t)||d({x:r,y:n},t)||d({x:r,y:s},t))}function Os(r,s,o){const{left:a,top:l,right:c,bottom:u}=o,{backdropColor:d}=s;if(!x(d)){const o=Oi(s.borderRadius),x=L(s.backdropPadding);r.fillStyle=d;const e=a-x.left,t=l-x.top,i=c-a+x.width,n=u-l+x.height;Object.values(o).some(e=>0!==e)?(r.beginPath(),Qt(r,{x:e,y:t,w:i,h:n,radius:o}),r.fill()):r.fillRect(e,t,i,n)}}function Is(i,n,e,r){const{ctx:s}=i;if(e)s.arc(i.xCenter,i.yCenter,n,0,C);else{let t=i.getPointPosition(0,n);s.moveTo(t.x,t.y);for(let e=1;e<r;e++)t=i.getPointPosition(e,n),s.lineTo(t.x,t.y)}}class Ps extends ys{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:vt.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:e=>e,padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=L(Ts(this.options)/2),t=this.width=this.maxWidth-e.width,i=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+i/2+e.top),this.drawingArea=Math.floor(Math.min(t,i)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=f(e)&&!isNaN(e)?e:0,this.max=f(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Ts(this.options))}generateTickLabels(e){ys.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((e,t)=>{const i=p(this.options.pointLabels.callback,[e,t],this);return i||0===i?i:""}).filter((e,t)=>this.chart.getDataVisibility(t))}fit(){const e=this.options;e.display&&e.pointLabels.display?Ds(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,i,n){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((i-n)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,i,n))}getIndexAngle(e){return y(e*(C/(this._pointLabels.length||1))+k(this.options.startAngle||0))}getDistanceFromCenterForValue(e){if(x(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(x(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(t){const i=this._pointLabels||[];if(t>=0&&t<i.length){const e=i[t];return function(e,t,i){return ki(e,{label:i,index:t,type:"pointLabel"})}(this.getContext(),t,e)}}getPointPosition(e,t,i=0){const n=this.getIndexAngle(e)-P+i;return{x:Math.cos(n)*t+this.xCenter,y:Math.sin(n)*t+this.yCenter,angle:n}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:i,right:n,bottom:r}=this._pointLabelItems[e];return{left:t,top:i,right:n,bottom:r}}drawBackground(){const{backgroundColor:t,grid:{circular:i}}=this.options;if(t){const e=this.ctx;e.save(),e.beginPath(),Is(this,this.getDistanceFromCenterForValue(this._endValue),i,this._pointLabels.length),e.closePath(),e.fillStyle=t,e.fill(),e.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:i,grid:s,border:o}=t,a=this._pointLabels.length;let n,l,r;if(t.pointLabels.display&&function(o,a){const{ctx:l,options:{pointLabels:c}}=o;for(let s=a-1;s>=0;s--){const a=o._pointLabelItems[s];if(!a.visible)continue;const e=c.setContext(o.getPointLabelContext(s));Os(l,e,a);const t=R(e.font),{x:i,y:n,textAlign:r}=a;Xt(l,o._pointLabels[s],i,n+t.lineHeight/2,t,{color:e.color,textAlign:r,textBaseline:"middle"})}}(this,a),s.display&&this.ticks.forEach((n,r)=>{if(0!==r){l=this.getDistanceFromCenterForValue(n.value);const e=this.getContext(r),t=s.setContext(e),i=o.setContext(e);!function(e,t,i,n,r){const s=e.ctx,o=t.circular,{color:a,lineWidth:l}=t;!o&&!n||!a||!l||i<0||(s.save(),s.strokeStyle=a,s.lineWidth=l,s.setLineDash(r.dash),s.lineDashOffset=r.dashOffset,s.beginPath(),Is(e,i,o,n),s.closePath(),s.stroke(),s.restore())}(this,t,l,a,i)}}),i.display){for(e.save(),n=a-1;n>=0;n--){const s=i.setContext(this.getPointLabelContext(n)),{color:o,lineWidth:a}=s;a&&o&&(e.lineWidth=a,e.strokeStyle=o,e.setLineDash(s.borderDash),e.lineDashOffset=s.borderDashOffset,l=this.getDistanceFromCenterForValue(t.ticks.reverse?this.min:this.max),r=this.getPointPosition(n,l),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(r.x,r.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const r=this.ctx,s=this.options,o=s.ticks;if(!o.display)return;const e=this.getIndexAngle(0);let a,l;r.save(),r.translate(this.xCenter,this.yCenter),r.rotate(e),r.textAlign="center",r.textBaseline="middle",this.ticks.forEach((e,t)=>{if(0===t&&!s.reverse)return;const i=o.setContext(this.getContext(t)),n=R(i.font);if(a=this.getDistanceFromCenterForValue(this.ticks[t].value),i.showLabelBackdrop){r.font=n.string,l=r.measureText(e.label).width,r.fillStyle=i.backdropColor;const s=L(i.backdropPadding);r.fillRect(-l/2-s.left,-a-n.size/2-s.top,l+s.width,n.size+s.height)}Xt(r,e.label,0,-a,n,{color:i.color})}),r.restore()}drawTitle(){}}const ks={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},A=Object.keys(ks);function Ls(e,t){return e-t}function Fs(e,t){if(x(t))return null;const i=e._adapter,{parser:n,round:r,isoWeekday:s}=e._parseOpts;let o=t;return"function"==typeof n&&(o=n(o)),f(o)||(o="string"==typeof n?i.parse(o,n):i.parse(o)),null===o?null:(r&&(o="week"!==r||!ae(s)&&!0!==s?i.startOf(o,r):i.startOf(o,"isoWeek",s)),+o)}function Gs(t,i,n,r){const s=A.length;for(let e=A.indexOf(t);e<s-1;++e){const t=ks[A[e]],s=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((n-i)/(s*t.size))<=r)return A[e]}return A[s-1]}function $s(i,n,r){if(r){if(r.length){const{lo:e,hi:t}=ve(r,n);i[r[e]>=n?r[e]:r[t]]=!0}}else i[n]=!0}function Hs(e,t,i){const n=[],r={},s=t.length;let o,a;for(o=0;o<s;++o)a=t[o],r[a]=o,n.push({value:a,major:!1});return 0!==s&&i?function(e,t,i,n){const r=e._adapter,s=+r.startOf(t[0].value,n),o=t[t.length-1].value;let a,l;for(a=s;a<=o;a=+r.add(a,1,n))l=i[a],l>=0&&(t[l].major=!0);return t}(e,n,r,i):n}class Bs extends rr{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const i=e.time||(e.time={}),n=this._adapter=new Lr._date(e.adapters.date);n.init(t),U(i.displayFormats,n.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:Fs(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,i=e.time.unit||"day";let{min:n,max:r,minDefined:s,maxDefined:o}=this.getUserBounds();function a(e){s||isNaN(e.min)||(n=Math.min(n,e.min)),o||isNaN(e.max)||(r=Math.max(r,e.max))}s&&o||(a(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||a(this.getMinMax(!1))),n=f(n)&&!isNaN(n)?n:+t.startOf(Date.now(),i),r=f(r)&&!isNaN(r)?r:+t.endOf(Date.now(),i)+1,this.min=Math.min(n,r-1),this.max=Math.max(n+1,r)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],i=e[e.length-1]),{min:t,max:i}}buildTicks(){const e=this.options,t=e.time,i=e.ticks,n="labels"===i.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const r=this.min,s=be(n,r,this.max);return this._unit=t.unit||(i.autoSkip?Gs(t.minUnit,this.min,this.max,this._getLabelCapacity(r)):function(t,i,n,r,s){for(let e=A.length-1;e>=A.indexOf(n);e--){const n=A[e];if(ks[n].common&&t._adapter.diff(s,r,n)>=i-1)return n}return A[n?A.indexOf(n):0]}(this,s.length,t.minUnit,this.min,this.max)),this._majorUnit=i.major.enabled&&"year"!==this._unit?function(i){for(let e=A.indexOf(i)+1,t=A.length;e<t;++e)if(ks[A[e]].common)return A[e]}(this._unit):void 0,this.initOffsets(n),e.reverse&&s.reverse(),Hs(this,s,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t,i,n=0,r=0;this.options.offset&&e.length&&(t=this.getDecimalForValue(e[0]),n=1===e.length?1-t:(this.getDecimalForValue(e[1])-t)/2,i=this.getDecimalForValue(e[e.length-1]),r=1===e.length?i:(i-this.getDecimalForValue(e[e.length-2]))/2);const s=e.length<3?.5:.25;n=b(n,0,s),r=b(r,0,s),this._offsets={start:n,end:r,factor:1/(n+1+r)}}_generate(){const e=this._adapter,t=this.min,i=this.max,n=this.options,r=n.time,s=r.unit||Gs(r.minUnit,t,i,this._getLabelCapacity(t)),o=O(n.ticks.stepSize,1),a="week"===s&&r.isoWeekday,l=ae(a)||!0===a,c={};let u,d,h=t;if(l&&(h=+e.startOf(h,"isoWeek",a)),h=+e.startOf(h,l?"day":s),e.diff(i,t,s)>1e5*o)throw new Error(t+" and "+i+" are too far apart with stepSize of "+o+" "+s);const p="data"===n.ticks.source&&this.getDataTimestamps();for(u=h,d=0;u<i;u=+e.add(u,o,s),d++)$s(c,u,p);return u!==i&&"ticks"!==n.bounds&&1!==d||$s(c,u,p),Object.keys(c).sort((e,t)=>e-t).map(e=>+e)}getLabelForValue(e){const t=this._adapter,i=this.options.time;return i.tooltipFormat?t.format(e,i.tooltipFormat):t.format(e,i.displayFormats.datetime)}format(e,t){const i=this.options.time.displayFormats,n=this._unit,r=t||i[n];return this._adapter.format(e,r)}_tickFormatFunction(e,t,i,n){const r=this.options,s=r.ticks.callback;if(s)return p(s,[e,t,i],this);const o=r.time.displayFormats,a=this._unit,l=this._majorUnit,c=a&&o[a],u=l&&o[l],d=i[t],h=l&&u&&d&&d.major;return this._adapter.format(e,n||(h?u:c))}generateTickLabels(e){let t,i,n;for(t=0,i=e.length;t<i;++t)n=e[t],n.label=this._tickFormatFunction(n.value,t,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,i=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+i)*t.factor)}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+i*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,i=this.ctx.measureText(e).width,n=k(this.isHorizontal()?t.maxRotation:t.minRotation),r=Math.cos(n),s=Math.sin(n),o=this._resolveTickFontOptions(0).size;return{w:i*r+o*s,h:i*s+o*r}}_getLabelCapacity(e){const t=this.options.time,i=t.displayFormats,n=i[t.unit]||i.millisecond,r=this._tickFormatFunction(e,0,Hs(this,[e],this._majorUnit),n),s=this._getLabelSize(r),o=Math.floor(this.isHorizontal()?this.width/s.w:this.height/s.h)-1;return o>0?o:1}getDataTimestamps(){let e,t,i=this._cache.data||[];if(i.length)return i;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(e=0,t=n.length;e<t;++e)i=i.concat(n[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(i)}getLabelTimestamps(){const e=this._cache.labels||[];let t,i;if(e.length)return e;const n=this.getLabels();for(t=0,i=n.length;t<i;++t)e.push(Fs(this,n[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Ae(e.sort(Ls))}}function Vs(e,t,i){let n,r,s,o,a=0,l=e.length-1;i?(t>=e[a].pos&&t<=e[l].pos&&({lo:a,hi:l}=_(e,"pos",t)),{pos:n,time:s}=e[a],{pos:r,time:o}=e[l]):(t>=e[a].time&&t<=e[l].time&&({lo:a,hi:l}=_(e,"time",t)),{time:n,pos:s}=e[a],{time:r,pos:o}=e[l]);const c=r-n;return c?s+(o-s)*(t-n)/c:s}var Ws=Object.freeze({__proto__:null,CategoryScale:class extends rr{static id="category";static defaults={ticks:{callback:ms}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(i){const n=this._addedLabels;if(n.length){const i=this.getLabels();for(const{index:e,label:t}of n)i[e]===t&&i.splice(e,1);this._addedLabels=[]}super.init(i)}parse(e,t){if(x(e))return null;const i=this.getLabels();return((e,t)=>null===e?null:b(Math.round(e),0,t))(t=isFinite(t)&&i[t]===e?t:gs(i,e,O(t,e),this._addedLabels),i.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:i,max:n}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(i=0),t||(n=this.getLabels().length-1)),this.min=i,this.max=n}buildTicks(){const t=this.min,i=this.max,e=this.options.offset,n=[];let r=this.getLabels();r=0===t&&i===r.length-1?r:r.slice(t,i+1),this._valueRange=Math.max(r.length-(e?0:1),1),this._startValue=this.min-(e?.5:0);for(let e=t;e<=i;e++)n.push({value:e});return n}getLabelForValue(e){return ms.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!=typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}},LinearScale:bs,LogarithmicScale:Ss,RadialLinearScale:Ps,TimeScale:Bs,TimeSeriesScale:class extends Bs{static id="timeseries";static defaults=Bs.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=Vs(t,this.min),this._tableRange=Vs(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:i}=this,n=[],r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;++s)l=e[s],l>=t&&l<=i&&n.push(l);if(n.length<2)return[{time:t,pos:0},{time:i,pos:1}];for(s=0,o=n.length;s<o;++s)c=n[s+1],a=n[s-1],l=n[s],Math.round((c+a)/2)!==l&&r.push({time:l,pos:s/(o-1)});return r}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),i=this.getLabelTimestamps();return e=t.length&&i.length?this.normalize(t.concat(i)):t.length?t:i,e=this._cache.all=e,e}getDecimalForValue(e){return(Vs(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return Vs(this._table,i*this._tableRange+this._minPos,!0)}}});const zs=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],js=zs.map(e=>e.replace("rgb(","rgba(").replace(")",", 0.5)"));function Us(e){return zs[e%zs.length]}function Ys(e){return js[e%js.length]}function qs(n){let r=0;return(e,t)=>{const i=n.getDatasetMeta(t).controller;i instanceof jr?r=function(e,t){return e.backgroundColor=e.data.map(()=>Us(t++)),t}(e,r):i instanceof Ur?r=function(e,t){return e.backgroundColor=e.data.map(()=>Ys(t++)),t}(e,r):i&&(r=function(e,t){return e.borderColor=Us(t),e.backgroundColor=Ys(t),++t}(e,r))}}function Ks(e){let t;for(t in e)if(e[t].borderColor||e[t].backgroundColor)return!0;return!1}var Xs={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(e,t,i){if(!i.enabled)return;const{data:{datasets:n},options:r}=e.config,{elements:s}=r;if(!i.forceOverride&&(Ks(n)||(o=r)&&(o.borderColor||o.backgroundColor)||s&&Ks(s)))return;var o;const a=qs(e);n.forEach(a)}};function Qs(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function Zs(e){e.data.datasets.forEach(e=>{Qs(e)})}var Js={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(u,e,d)=>{if(!d.enabled)return void Zs(u);const h=u.width;u.data.datasets.forEach((e,t)=>{const{_data:i,indexAxis:n}=e,r=u.getDatasetMeta(t),s=i||e.data;if("y"===Ii([n,u.options.indexAxis]))return;if(!r.controller.supportsDecimation)return;const o=u.scales[r.xAxisID];if("linear"!==o.type&&"time"!==o.type)return;if(u.options.parsing)return;let{start:a,count:l}=function(e,t){const i=t.length;let n,r=0;const{iScale:s}=e,{min:o,max:a,minDefined:l,maxDefined:c}=s.getUserBounds();return l&&(r=b(_(t,s.axis,o).lo,0,i-1)),n=c?b(_(t,s.axis,a).hi+1,r,i)-r:i-r,{start:r,count:n}}(r,s);if(l<=(d.threshold||4*h))return void Qs(e);let c;switch(x(i)&&(e._data=s,delete e.data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(e){this._data=e}})),d.algorithm){case"lttb":c=function(c,u,d,e,t){const i=t.samples||e;if(i>=d)return c.slice(u,u+d);const h=[],p=(d-2)/(i-2);let f=0;const g=u+d-1;let m,v,y,b,C,w=u;for(h[f++]=c[w],m=0;m<i-2;m++){let e,t=0,i=0;const g=Math.floor((m+1)*p)+1+u,n=Math.min(Math.floor((m+2)*p)+1,d)+u,r=n-g;for(e=g;e<n;e++)t+=c[e].x,i+=c[e].y;t/=r,i/=r;const s=Math.floor(m*p)+1+u,o=Math.min(Math.floor((m+1)*p)+1,d)+u,{x:a,y:l}=c[w];for(y=b=-1,e=s;e<o;e++)b=.5*Math.abs((a-t)*(c[e].y-l)-(a-c[e].x)*(i-l)),b>y&&(y=b,v=c[e],C=e);h[f++]=v,w=C}return h[f++]=c[g],h}(s,a,l,h,d);break;case"min-max":c=function(e,t,i,n){let r,s,o,a,l,c,u,d,h,p,f=0,g=0;const m=[],v=t+i-1,y=e[t].x,b=e[v].x-y;for(r=t;r<t+i;++r){s=e[r],o=(s.x-y)/b*n,a=s.y;const t=0|o;if(t===l)a<h?(h=a,c=r):a>p&&(p=a,u=r),f=(g*f+s.x)/++g;else{const i=r-1;if(!x(c)&&!x(u)){const t=Math.min(c,u),x=Math.max(c,u);t!==d&&t!==i&&m.push({...e[t],x:f}),x!==d&&x!==i&&m.push({...e[x],x:f})}r>0&&i!==d&&m.push(e[i]),m.push(s),l=t,g=0,h=p=a,c=u=d=r}}return m}(s,a,l,h);break;default:throw new Error(`Unsupported decimation algorithm '${d.algorithm}'`)}e._decimated=c})},destroy(e){Zs(e)}};function eo(e,t,i,n){if(n)return;let r=t[e],s=i[e];return"angle"===e&&(r=y(r),s=y(s)),{property:e,start:r,end:s}}function to(e,t,i){for(;t>e;t--){const e=i[t];if(!isNaN(e.x)&&!isNaN(e.y))break}return t}function io(e,t,i,n){return e&&t?n(e[i],t[i]):e?e[i]:t?t[i]:0}function no(e,t){let i=[],n=!1;return M(e)?(n=!0,i=e):i=function(e,t){const{x:r=null,y:s=null}=e||{},o=t.points,a=[];return t.segments.forEach(({start:e,end:t})=>{t=to(e,t,o);const i=o[e],n=o[t];null!==s?(a.push({x:i.x,y:s}),a.push({x:n.x,y:s})):null!==r&&(a.push({x:r,y:i.y}),a.push({x:r,y:n.y}))}),a}(e,t),i.length?new os({points:i,options:{tension:0},_loop:n,_fullLoop:n}):null}function ro(e){return e&&!1!==e.fill}function so(e,t,i){let n=e[t].fill;const r=[t];let s;if(!i)return n;for(;!1!==n&&-1===r.indexOf(n);){if(!f(n))return n;if(s=e[n],!s)return!1;if(s.visible)return n;r.push(n),n=s.fill}return!1}function oo(e,t,i){const n=function(e){const t=e.options,i=t.fill;let n=O(i&&i.target,i);void 0===n&&(n=!!t.backgroundColor);if(!1===n||null===n)return!1;if(!0===n)return"origin";return n}(e);if(N(n))return!isNaN(n.value)&&n;let r=parseFloat(n);return f(r)&&Math.floor(r)===r?function(e,t,i,n){"-"!==e&&"+"!==e||(i=t+i);if(i===t||i<0||i>=n)return!1;return i}(n[0],t,r,i):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function ao(s,o,a){const l=[];for(let r=0;r<a.length;r++){const e=a[r],{first:t,last:i,point:n}=lo(e,o,"x");if(!(!n||t&&i))if(t)l.unshift(n);else if(s.push(n),!i)break}s.push(...l)}function lo(e,i,n){const r=e.interpolate(i,n);if(!r)return{};const s=r[n],o=e.segments,a=e.points;let l=!1,c=!1;for(let t=0;t<o.length;t++){const i=o[t],r=a[i.start][n],e=a[i.end][n];if(w(s,r,e)){l=s===r,c=s===e;break}}return{first:l,last:c,point:r}}class co{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,i){const{x:n,y:r,radius:s}=this;return t=t||{start:0,end:C},e.arc(n,r,s,t.end,t.start,!0),!i.bounds}interpolate(e){const{x:t,y:i,radius:n}=this,r=e.angle;return{x:t+Math.cos(r)*n,y:i+Math.sin(r)*n,angle:r}}}function uo(e){const{chart:t,fill:i,line:n}=e;if(f(i))return function(e,t){const i=e.getDatasetMeta(t),n=i&&e.isDatasetVisible(t);return n?i.dataset:null}(t,i);if("stack"===i)return function(e){const{scale:t,index:i,line:n}=e,r=[],s=n.segments,o=n.points,a=function(e,i){const n=[],r=e.getMatchingVisibleMetas("line");for(let t=0;t<r.length;t++){const e=r[t];if(e.index===i)break;e.hidden||n.unshift(e.dataset)}return n}(t,i);a.push(no({x:null,y:t.bottom},n));for(let e=0;e<s.length;e++){const t=s[e];for(let e=t.start;e<=t.end;e++)ao(r,o[e],a)}return new os({points:r,options:{}})}(e);if("shape"===i)return!0;const r=function(e){const t=e.scale||{};if(t.getPointPositionForValue)return function(e){const{scale:t,fill:i}=e,n=t.options,r=t.getLabels().length,s=n.reverse?t.max:t.min,o=function(e,t,i){let n;return n="start"===e?i:"end"===e?t.options.reverse?t.min:t.max:N(e)?e.value:t.getBaseValue(),n}(i,t,s),a=[];if(n.grid.circular){const e=t.getPointPositionForValue(0,s);return new co({x:e.x,y:e.y,radius:t.getDistanceFromCenterForValue(o)})}for(let e=0;e<r;++e)a.push(t.getPointPositionForValue(e,o));return a}(e);return function(e){const{scale:t={},fill:i}=e,n=function(e,t){let i=null;return"start"===e?i=t.bottom:"end"===e?i=t.top:N(e)?i=t.getPixelForValue(e.value):t.getBasePixel&&(i=t.getBasePixel()),i}(i,t);if(f(n)){const e=t.isHorizontal();return{x:e?n:null,y:e?null:n}}return null}(e)}(e);return r instanceof co?r:no(r,n)}function ho(e,t,i){const n=uo(t),{line:r,scale:s,axis:o}=t,a=r.options,l=a.fill,c=a.backgroundColor,{above:u=c,below:d=c}=l||{};n&&r.points.length&&(zt(e,i),function(e,t){const{line:i,target:n,above:r,below:s,area:o,scale:a}=t,l=i._loop?"angle":t.axis;e.save(),"x"===l&&s!==r&&(po(e,n,o.top),fo(e,{line:i,target:n,color:r,scale:a,property:l}),e.restore(),e.save(),po(e,n,o.bottom));fo(e,{line:i,target:n,color:s,scale:a,property:l}),e.restore()}(e,{line:r,target:n,above:u,below:d,area:i,scale:s,axis:o}),jt(e))}function po(r,s,o){const{segments:a,points:l}=s;let c=!0,u=!1;r.beginPath();for(const n of a){const{start:a,end:e}=n,t=l[a],i=l[to(a,e,l)];c?(r.moveTo(t.x,t.y),c=!1):(r.lineTo(t.x,o),r.lineTo(t.x,t.y)),u=!!s.pathSegment(r,n,{move:u}),u?r.closePath():r.lineTo(i.x,o)}r.lineTo(s.first().x,o),r.closePath(),r.clip()}function fo(o,a){const{line:l,target:c,property:u,color:d,scale:h}=a,p=function(r,s,o){const a=r.segments,l=r.points,c=s.points,u=[];for(const r of a){let{start:e,end:t}=r;t=to(e,t,l);const i=eo(o,l[e],l[t],r.loop);if(!s.segments){u.push({source:r,target:i,start:l[e],end:l[t]});continue}const n=Vi(s,i);for(const s of n){const a=eo(o,c[s.start],c[s.end],s.loop),e=Bi(r,l,a);for(const r of e)u.push({source:r,target:s,start:{[o]:io(i,a,"start",Math.max)},end:{[o]:io(i,a,"end",Math.min)}})}}return u}(l,c,u);for(const{source:a,target:n,start:r,end:s}of p){const{style:{backgroundColor:p=d}={}}=a,e=!0!==c;o.save(),o.fillStyle=p,go(o,h,e&&eo(u,r,s)),o.beginPath();const t=!!l.pathSegment(o,a);let i;if(e){t?o.closePath():mo(o,c,s,u);const a=!!c.pathSegment(o,n,{move:t,reverse:!0});i=t&&a,i||mo(o,c,r,u)}o.closePath(),o.fill(i?"evenodd":"nonzero"),o.restore()}}function go(e,t,i){const{top:n,bottom:r}=t.chart.chartArea,{property:s,start:o,end:a}=i||{};"x"===s&&(e.beginPath(),e.rect(o,n,a-o,r-n),e.clip())}function mo(e,t,i,n){const r=t.interpolate(i,n);r&&e.lineTo(r.x,r.y)}var vo={id:"filler",afterDatasetsUpdate(e,t,i){const n=(e.data.datasets||[]).length,r=[];let s,o,a,l;for(o=0;o<n;++o)s=e.getDatasetMeta(o),a=s.dataset,l=null,a&&a.options&&a instanceof os&&(l={visible:e.isDatasetVisible(o),index:o,fill:oo(a,o,n),chart:e,axis:s.controller.options.indexAxis,scale:s.vScale,line:a}),s.$filler=l,r.push(l);for(o=0;o<n;++o)l=r[o],l&&!1!==l.fill&&(l.fill=so(r,o,i.propagate))},beforeDraw(t,e,i){const n="beforeDraw"===i.drawTime,r=t.getSortedVisibleDatasetMetas(),s=t.chartArea;for(let e=r.length-1;e>=0;--e){const i=r[e].$filler;i&&(i.line.updateControlPoints(s,i.axis),n&&i.fill&&ho(t.ctx,i,s))}},beforeDatasetsDraw(t,e,i){if("beforeDatasetsDraw"!==i.drawTime)return;const n=t.getSortedVisibleDatasetMetas();for(let e=n.length-1;e>=0;--e){const i=n[e].$filler;ro(i)&&ho(t.ctx,i,t.chartArea)}},beforeDatasetDraw(e,t,i){const n=t.meta.$filler;ro(n)&&"beforeDatasetDraw"===i.drawTime&&ho(e.ctx,n,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const yo=(e,t)=>{let{boxHeight:i=t,boxWidth:n=t}=e;return e.usePointStyle&&(i=Math.min(i,t),n=e.pointStyleWidth||Math.min(n,t)),{boxWidth:n,boxHeight:i,itemHeight:Math.max(t,i)}};class bo extends t{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,i){this.maxWidth=e,this.maxHeight=t,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const i=this.options.labels||{};let e=p(i.generateLabels,[this.chart],this)||[];i.filter&&(e=e.filter(e=>i.filter(e,this.chart.data))),i.sort&&(e=e.sort((e,t)=>i.sort(e,t,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:e,ctx:t}=this;if(!e.display)return void(this.width=this.height=0);const i=e.labels,n=R(i.font),r=n.size,s=this._computeTitleHeight(),{boxWidth:o,itemHeight:a}=yo(i,r);let l,c;t.font=n.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(s,r,o,a)+10):(c=this.maxHeight,l=this._fitCols(s,n,o,a)+10),this.width=Math.min(l,e.maxWidth||this.maxWidth),this.height=Math.min(c,e.maxHeight||this.maxHeight)}_fitRows(e,n,r,s){const{ctx:o,maxWidth:a,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.lineWidths=[0],d=s+l;let h=e;o.textAlign="left",o.textBaseline="middle";let p=-1,f=-d;return this.legendItems.forEach((e,t)=>{const i=r+n/2+o.measureText(e.text).width;(0===t||u[u.length-1]+i+2*l>a)&&(h+=d,u[u.length-(t>0?0:1)]=0,f+=d,p++),c[t]={left:0,top:f,row:p,width:i,height:s},u[u.length-1]+=i+l}),h}_fitCols(e,r,s,o){const{ctx:a,maxHeight:t,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.columnSizes=[],d=t-e;let h=l,p=0,f=0,g=0,m=0;return this.legendItems.forEach((e,t)=>{const{itemWidth:i,itemHeight:n}=function(e,t,i,n,r){const s=function(e,t,i,n){let r=e.text;r&&"string"!=typeof r&&(r=r.reduce((e,t)=>e.length>t.length?e:t));return t+i.size/2+n.measureText(r).width}(n,e,t,i),o=function(e,t,i){let n=e;"string"!=typeof t.text&&(n=Co(t,i));return n}(r,n,t.lineHeight);return{itemWidth:s,itemHeight:o}}(s,r,a,e,o);t>0&&f+n+2*l>d&&(h+=p+l,u.push({width:p,height:f}),g+=p+l,m++,p=f=0),c[t]={left:g,top:f,col:m,width:i,height:n},p=Math.max(p,i),f+=n+l}),h+=p,u.push({width:p,height:f}),h}adjustHitBoxes(){if(!this.options.display)return;const n=this._computeTitleHeight(),{legendHitBoxes:r,options:{align:s,labels:{padding:o},rtl:e}}=this,a=Li(e,this.left,this.width);if(this.isHorizontal()){let t=0,i=T(s,this.left+o,this.right-this.lineWidths[t]);for(const e of r)t!==e.row&&(t=e.row,i=T(s,this.left+o,this.right-this.lineWidths[t])),e.top+=this.top+n+o,e.left=a.leftForLtr(a.x(i),e.width),i+=e.width+o}else{let t=0,i=T(s,this.top+n+o,this.bottom-this.columnSizes[t].height);for(const e of r)e.col!==t&&(t=e.col,i=T(s,this.top+n+o,this.bottom-this.columnSizes[t].height)),e.top=i,e.left+=this.left+o,e.left=a.leftForLtr(a.x(e.left),e.width),i+=e.height+o}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const e=this.ctx;zt(e,this),this._draw(),jt(e)}}_draw(){const{options:a,columnSizes:l,lineWidths:c,ctx:u}=this,{align:d,labels:h}=a,p=D.color,f=Li(a.rtl,this.left,this.width),g=R(h.font),{padding:m}=h,v=g.size,y=v/2;let b;this.drawTitle(),u.textAlign=f.textAlign("left"),u.textBaseline="middle",u.lineWidth=.5,u.font=g.string;const{boxWidth:C,boxHeight:w,itemHeight:_}=yo(h,v),A=this.isHorizontal(),E=this._computeTitleHeight();b=A?{x:T(d,this.left+m,this.right-c[0]),y:this.top+m+E,line:0}:{x:this.left+m,y:T(d,this.top+E+m,this.bottom-l[0].height),line:0},Fi(this.ctx,a.textDirection);const S=_+m;this.legendItems.forEach((e,t)=>{u.strokeStyle=e.fontColor,u.fillStyle=e.fontColor;const i=u.measureText(e.text).width,n=f.textAlign(e.textAlign||(e.textAlign=h.textAlign)),r=C+y+i;let s=b.x,o=b.y;f.setWidth(this.width),A?t>0&&s+r+m>this.right&&(o=b.y+=S,b.line++,s=b.x=T(d,this.left+m,this.right-c[b.line])):t>0&&o+S>this.bottom&&(s=b.x=s+l[b.line].width+m,b.line++,o=b.y=T(d,this.top+E+m,this.bottom-l[b.line].height));if(function(e,t,i){if(isNaN(C)||C<=0||isNaN(w)||w<0)return;u.save();const n=O(i.lineWidth,1);if(u.fillStyle=O(i.fillStyle,p),u.lineCap=O(i.lineCap,"butt"),u.lineDashOffset=O(i.lineDashOffset,0),u.lineJoin=O(i.lineJoin,"miter"),u.lineWidth=n,u.strokeStyle=O(i.strokeStyle,p),u.setLineDash(O(i.lineDash,[])),h.usePointStyle){const p={radius:w*Math.SQRT2/2,pointStyle:i.pointStyle,rotation:i.rotation,borderWidth:n},O=f.xPlus(e,C/2);Wt(u,p,O,t+y,h.pointStyleWidth&&C)}else{const h=t+Math.max((v-w)/2,0),p=f.leftForLtr(e,C),O=Oi(i.borderRadius);u.beginPath(),Object.values(O).some(e=>0!==e)?Qt(u,{x:p,y:h,w:C,h:w,radius:O}):u.rect(p,h,C,w),u.fill(),0!==n&&u.stroke()}u.restore()}(f.x(s),o,e),s=De(n,s+C+y,A?s+r:this.right,a.rtl),function(e,t,i){Xt(u,i.text,e,t+_/2,g,{strikethrough:i.hidden,textAlign:f.textAlign(i.textAlign)})}(f.x(s),o,e),A)b.x+=r+m;else if("string"!=typeof e.text){const a=g.lineHeight;b.y+=Co(e,a)}else b.y+=S}),Gi(this.ctx,a.textDirection)}drawTitle(){const e=this.options,t=e.title,i=R(t.font),n=L(t.padding);if(!t.display)return;const r=Li(e.rtl,this.left,this.width),s=this.ctx,o=t.position,a=i.size/2,l=n.top+a;let c,u=this.left,d=this.width;if(this.isHorizontal())d=Math.max(...this.lineWidths),c=this.top+l,u=T(e.align,u,this.right-d);else{const t=this.columnSizes.reduce((e,t)=>Math.max(e,t.height),0);c=l+T(e.align,this.top,this.bottom-t-e.labels.padding-this._computeTitleHeight())}const h=T(o,u,u+d);s.textAlign=r.textAlign(xe(o)),s.textBaseline="middle",s.strokeStyle=t.color,s.fillStyle=t.color,s.font=i.string,Xt(s,t.text,h,c,i)}_computeTitleHeight(){const e=this.options.title,t=R(e.font),i=L(e.padding);return e.display?t.lineHeight+i.height:0}_getLegendItemAt(e,t){let i,n,r;if(w(e,this.left,this.right)&&w(t,this.top,this.bottom))for(r=this.legendHitBoxes,i=0;i<r.length;++i)if(n=r[i],w(e,n.left,n.left+n.width)&&w(t,n.top,n.top+n.height))return this.legendItems[i];return null}handleEvent(i){const n=this.options;if(!function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(i.type,n))return;const r=this._getLegendItemAt(i.x,i.y);if("mousemove"===i.type||"mouseout"===i.type){const e=this._hoveredItem,t=(o=r,null!==(s=e)&&null!==o&&s.datasetIndex===o.datasetIndex&&s.index===o.index);e&&!t&&p(n.onLeave,[i,e,this],this),this._hoveredItem=r,r&&!t&&p(n.onHover,[i,r,this],this)}else r&&p(n.onClick,[i,r,this],this);var s,o}}function Co(e,t){return t*(e.text?e.text.length+.5:0)}var wo={id:"legend",_element:bo,start(e,t,i){const n=e.legend=new bo({ctx:e.ctx,options:i,chart:e});r.configure(e,n,i),r.addBox(e,n)},stop(e){r.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,i){const n=e.legend;r.configure(e,n,i),n.options=i},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,i){const n=t.datasetIndex,r=i.chart;r.isDatasetVisible(n)?(r.hide(n),t.hidden=!0):(r.show(n),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const n=e.data.datasets,{labels:{usePointStyle:r,pointStyle:s,textAlign:o,color:a,useBorderRadius:l,borderRadius:c}}=e.legend.options;return e._getSortedDatasetMetas().map(e=>{const t=e.controller.getStyle(r?0:void 0),i=L(t.borderWidth);return{text:n[e.index].label,fillStyle:t.backgroundColor,fontColor:a,hidden:!e.visible,lineCap:t.borderCapStyle,lineDash:t.borderDash,lineDashOffset:t.borderDashOffset,lineJoin:t.borderJoinStyle,lineWidth:(i.width+i.height)/4,strokeStyle:t.borderColor,pointStyle:s||t.pointStyle,rotation:t.rotation,textAlign:o||t.textAlign,borderRadius:l&&(c||t.borderRadius),datasetIndex:e.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class _o extends t{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const i=this.options;if(this.left=0,this.top=0,!i.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=e,this.height=this.bottom=t;const n=M(i.text)?i.text.length:1;this._padding=L(i.padding);const r=n*R(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){const{top:t,left:i,bottom:n,right:r,options:s}=this,o=s.align;let a,l,c,u=0;return this.isHorizontal()?(l=T(o,i,r),c=t+e,a=r-i):("left"===s.position?(l=i+e,c=T(o,n,t),u=-.5*I):(l=r-e,c=T(o,t,n),u=.5*I),a=n-t),{titleX:l,titleY:c,maxWidth:a,rotation:u}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const i=R(t.font),n=i.lineHeight/2+this._padding.top,{titleX:r,titleY:s,maxWidth:o,rotation:a}=this._drawArgs(n);Xt(e,t.text,0,0,i,{color:t.color,maxWidth:o,rotation:a,textAlign:xe(t.align),textBaseline:"middle",translation:[r,s]})}}var Ao={id:"title",_element:_o,start(e,t,i){!function(e,t){const i=new _o({ctx:e.ctx,options:t,chart:e});r.configure(e,i,t),r.addBox(e,i),e.titleBlock=i}(e,i)},stop(e){const t=e.titleBlock;r.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,i){const n=e.titleBlock;r.configure(e,n,i),n.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Eo=new WeakMap;var So={id:"subtitle",start(e,t,i){const n=new _o({ctx:e.ctx,options:i,chart:e});r.configure(e,n,i),r.addBox(e,n),Eo.set(e,n)},stop(e){r.removeBox(e,Eo.get(e)),Eo.delete(e)},beforeUpdate(e,t,i){const n=Eo.get(e);r.configure(e,n,i),n.options=i},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const To={average(e){if(!e.length)return!1;let t,i,n=0,r=0,s=0;for(t=0,i=e.length;t<i;++t){const i=e[t].element;if(i&&i.hasValue()){const e=i.tooltipPosition();n+=e.x,r+=e.y,++s}}return{x:n/s,y:r/s}},nearest(e,t){if(!e.length)return!1;let i,n,r,s=t.x,o=t.y,a=Number.POSITIVE_INFINITY;for(i=0,n=e.length;i<n;++i){const n=e[i].element;if(n&&n.hasValue()){const e=pe(t,n.getCenterPoint());e<a&&(a=e,r=n)}}if(r){const e=r.tooltipPosition();s=e.x,o=e.y}return{x:s,y:o}}};function S(e,t){return t&&(M(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function xo(e){return("string"==typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function Do(e,t){const{element:i,datasetIndex:n,index:r}=t,s=e.getDatasetMeta(n).controller,{label:o,value:a}=s.getLabelAndValue(r);return{chart:e,label:o,parsed:s.getParsed(r),raw:e.data.datasets[n].data[r],formattedValue:a,dataset:s.getDataset(),dataIndex:r,datasetIndex:n,element:i}}function Ro(e,t){const i=e.chart.ctx,{body:n,footer:r,title:s}=e,{boxWidth:o,boxHeight:a}=t,l=R(t.bodyFont),c=R(t.titleFont),u=R(t.footerFont),d=s.length,h=r.length,p=n.length,f=L(t.padding);let g=f.height,m=0,v=n.reduce((e,t)=>e+t.before.length+t.lines.length+t.after.length,0);if(v+=e.beforeBody.length+e.afterBody.length,d&&(g+=d*c.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),v){g+=p*(t.displayColors?Math.max(a,l.lineHeight):l.lineHeight)+(v-p)*l.lineHeight+(v-1)*t.bodySpacing}h&&(g+=t.footerMarginTop+h*u.lineHeight+(h-1)*t.footerSpacing);let y=0;const b=function(e){m=Math.max(m,i.measureText(e).width+y)};return i.save(),i.font=c.string,E(e.title,b),i.font=l.string,E(e.beforeBody.concat(e.afterBody),b),y=t.displayColors?o+2+t.boxPadding:0,E(n,e=>{E(e.before,b),E(e.lines,b),E(e.after,b)}),y=0,i.font=u.string,E(e.footer,b),i.restore(),m+=f.width,{width:m,height:g}}function Mo(e,t,i,n){const{x:r,width:s}=i,{width:o,chartArea:{left:a,right:l}}=e;let c="center";return"center"===n?c=r<=(a+l)/2?"left":"right":r<=s/2?c="left":r>=o-s/2&&(c="right"),function(e,t,i,n){const{x:r,width:s}=n,o=i.caretSize+i.caretPadding;return"left"===e&&r+s+o>t.width||"right"===e&&r-s-o<0||void 0}(c,e,t,i)&&(c="center"),c}function No(e,t,i){const n=i.yAlign||t.yAlign||function(e,t){const{y:i,height:n}=t;return i<n/2?"top":i>e.height-n/2?"bottom":"center"}(e,i);return{xAlign:i.xAlign||t.xAlign||Mo(e,t,i,n),yAlign:n}}function Oo(e,t,i,n){const{caretSize:r,caretPadding:s,cornerRadius:o}=e,{xAlign:a,yAlign:l}=i,c=r+s,{topLeft:u,topRight:d,bottomLeft:h,bottomRight:p}=Oi(o);let f=function(e,t){let{x:i,width:n}=e;return"right"===t?i-=n:"center"===t&&(i-=n/2),i}(t,a);const g=function(e,t,i){let{y:n,height:r}=e;return"top"===t?n+=i:n-="bottom"===t?r+i:r/2,n}(t,l,c);return"center"===l?"left"===a?f+=c:"right"===a&&(f-=c):"left"===a?f-=Math.max(u,h)+r:"right"===a&&(f+=Math.max(d,p)+r),{x:b(f,0,n.width-t.width),y:b(g,0,n.height-t.height)}}function Io(e,t,i){const n=L(i.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-n.right:e.x+n.left}function Po(e){return S([],xo(e))}function ko(e,t){const i=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return i?e.override(i):e}const Lo={beforeTitle:e,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,i=t?t.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return t[e.dataIndex]}return""},afterTitle:e,beforeBody:e,beforeLabel:e,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const i=e.formattedValue;return x(i)||(t+=i),t},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:e,afterBody:e,beforeFooter:e,footer:e,afterFooter:e};function F(e,t,i,n){const r=e[t].call(i,n);return void 0===r?Lo[t].call(i,n):r}class Fo extends t{static positioners=To;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,i=this.options.setContext(this.getContext()),n=i.enabled&&t.options.animation&&i.animations,r=new Ln(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,i=this._tooltipItems,ki(e,{tooltip:t,tooltipItems:i,type:"tooltip"})));var e,t,i}getTitle(e,t){const{callbacks:i}=t,n=F(i,"beforeTitle",this,e),r=F(i,"title",this,e),s=F(i,"afterTitle",this,e);let o=[];return o=S(o,xo(n)),o=S(o,xo(r)),o=S(o,xo(s)),o}getBeforeBody(e,t){return Po(F(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,r=[];return E(e,e=>{const t={before:[],lines:[],after:[]},i=ko(n,e);S(t.before,xo(F(i,"beforeLabel",this,e))),S(t.lines,F(i,"label",this,e)),S(t.after,xo(F(i,"afterLabel",this,e))),r.push(t)}),r}getAfterBody(e,t){return Po(F(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:i}=t,n=F(i,"beforeFooter",this,e),r=F(i,"footer",this,e),s=F(i,"afterFooter",this,e);let o=[];return o=S(o,xo(n)),o=S(o,xo(r)),o=S(o,xo(s)),o}_createItems(n){const e=this._active,r=this.chart.data,i=[],s=[],o=[];let t,a,l=[];for(t=0,a=e.length;t<a;++t)l.push(Do(this.chart,e[t]));return n.filter&&(l=l.filter((e,t,i)=>n.filter(e,t,i,r))),n.itemSort&&(l=l.sort((e,t)=>n.itemSort(e,t,r))),E(l,e=>{const t=ko(n.callbacks,e);i.push(F(t,"labelColor",this,e)),s.push(F(t,"labelPointStyle",this,e)),o.push(F(t,"labelTextColor",this,e))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=l,l}update(n,r){const s=this.options.setContext(this.getContext()),o=this._active;let a,l=[];if(o.length){const n=To[s.position].call(this,o,this._eventPosition);l=this._createItems(s),this.title=this.getTitle(l,s),this.beforeBody=this.getBeforeBody(l,s),this.body=this.getBody(l,s),this.afterBody=this.getAfterBody(l,s),this.footer=this.getFooter(l,s);const r=this._size=Ro(this,s),e=Object.assign({},n,r),t=No(this.chart,s,e),i=Oo(s,e,t,this.chart);this.xAlign=t.xAlign,this.yAlign=t.yAlign,a={opacity:1,x:i.x,y:i.y,width:r.width,height:r.height,caretX:n.x,caretY:n.y}}else 0!==this.opacity&&(a={opacity:0});this._tooltipItems=l,this.$context=void 0,a&&this._resolveAnimations().update(this,a),n&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:r})}drawCaret(e,t,i,n){const r=this.getCaretPosition(e,i,n);t.lineTo(r.x1,r.y1),t.lineTo(r.x2,r.y2),t.lineTo(r.x3,r.y3)}getCaretPosition(e,t,i){const{xAlign:n,yAlign:r}=this,{caretSize:s,cornerRadius:o}=i,{topLeft:a,topRight:l,bottomLeft:c,bottomRight:u}=Oi(o),{x:d,y:h}=e,{width:p,height:f}=t;let g,m,v,y,b,C;return"center"===r?(b=h+f/2,"left"===n?(g=d,m=g-s,y=b+s,C=b-s):(g=d+p,m=g+s,y=b-s,C=b+s),v=g):(m="left"===n?d+Math.max(a,c)+s:"right"===n?d+p-Math.max(l,u)-s:this.caretX,"top"===r?(y=h,b=y-s,g=m-s,v=m+s):(y=h+f,b=y+s,g=m+s,v=m-s),C=y),{x1:g,x2:m,x3:v,y1:y,y2:b,y3:C}}drawTitle(t,i,n){const r=this.title,s=r.length;let o,a,l;if(s){const e=Li(n.rtl,this.x,this.width);for(t.x=Io(this,n.titleAlign,n),i.textAlign=e.textAlign(n.titleAlign),i.textBaseline="middle",o=R(n.titleFont),a=n.titleSpacing,i.fillStyle=n.titleColor,i.font=o.string,l=0;l<s;++l)i.fillText(r[l],e.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a,l+1===s&&(t.y+=n.titleMarginBottom-a)}}_drawColorBox(e,t,i,n,r){const s=this.labelColors[i],o=this.labelPointStyles[i],{boxHeight:a,boxWidth:l}=r,c=R(r.bodyFont),u=Io(this,"left",r),d=n.x(u),h=a<c.lineHeight?(c.lineHeight-a)/2:0,p=t.y+h;if(r.usePointStyle){const t={radius:Math.min(l,a)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},i=n.leftForLtr(d,l)+l/2,N=p+a/2;e.strokeStyle=r.multiKeyBackground,e.fillStyle=r.multiKeyBackground,Vt(e,t,i,N),e.strokeStyle=s.borderColor,e.fillStyle=s.backgroundColor,Vt(e,t,i,N)}else{e.lineWidth=N(s.borderWidth)?Math.max(...Object.values(s.borderWidth)):s.borderWidth||1,e.strokeStyle=s.borderColor,e.setLineDash(s.borderDash||[]),e.lineDashOffset=s.borderDashOffset||0;const t=n.leftForLtr(d,l),i=n.leftForLtr(n.xPlus(d,1),l-2),o=Oi(s.borderRadius);Object.values(o).some(e=>0!==e)?(e.beginPath(),e.fillStyle=r.multiKeyBackground,Qt(e,{x:t,y:p,w:l,h:a,radius:o}),e.fill(),e.stroke(),e.fillStyle=s.backgroundColor,e.beginPath(),Qt(e,{x:i,y:p+1,w:l-2,h:a-2,radius:o}),e.fill()):(e.fillStyle=r.multiKeyBackground,e.fillRect(t,p,l,a),e.strokeRect(t,p,l,a),e.fillStyle=s.backgroundColor,e.fillRect(i,p+1,l-2,a-2))}e.fillStyle=this.labelTextColors[i]}drawBody(t,i,e){const{body:n}=this,{bodySpacing:r,bodyAlign:s,displayColors:o,boxHeight:a,boxWidth:l,boxPadding:c}=e,u=R(e.bodyFont);let d=u.lineHeight,h=0;const p=Li(e.rtl,this.x,this.width),f=function(e){i.fillText(e,p.x(t.x+h),t.y+d/2),t.y+=d+r},g=p.textAlign(s);let m,v,y,b,C,w,_;for(i.textAlign=s,i.textBaseline="middle",i.font=u.string,t.x=Io(this,g,e),i.fillStyle=e.bodyColor,E(this.beforeBody,f),h=o&&"right"!==g?"center"===s?l/2+c:l+2+c:0,b=0,w=n.length;b<w;++b){for(m=n[b],v=this.labelTextColors[b],i.fillStyle=v,E(m.before,f),y=m.lines,o&&y.length&&(this._drawColorBox(i,t,b,p,e),d=Math.max(u.lineHeight,a)),C=0,_=y.length;C<_;++C)f(y[C]),d=u.lineHeight;E(m.after,f)}h=0,d=u.lineHeight,E(this.afterBody,f),t.y-=r}drawFooter(t,i,n){const r=this.footer,s=r.length;let o,a;if(s){const e=Li(n.rtl,this.x,this.width);for(t.x=Io(this,n.footerAlign,n),t.y+=n.footerMarginTop,i.textAlign=e.textAlign(n.footerAlign),i.textBaseline="middle",o=R(n.footerFont),i.fillStyle=n.footerColor,i.font=o.string,a=0;a<s;++a)i.fillText(r[a],e.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+n.footerSpacing}}drawBackground(e,t,i,n){const{xAlign:r,yAlign:s}=this,{x:o,y:a}=e,{width:l,height:c}=i,{topLeft:u,topRight:d,bottomLeft:h,bottomRight:p}=Oi(n.cornerRadius);t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.beginPath(),t.moveTo(o+u,a),"top"===s&&this.drawCaret(e,t,i,n),t.lineTo(o+l-d,a),t.quadraticCurveTo(o+l,a,o+l,a+d),"center"===s&&"right"===r&&this.drawCaret(e,t,i,n),t.lineTo(o+l,a+c-p),t.quadraticCurveTo(o+l,a+c,o+l-p,a+c),"bottom"===s&&this.drawCaret(e,t,i,n),t.lineTo(o+h,a+c),t.quadraticCurveTo(o,a+c,o,a+c-h),"center"===s&&"left"===r&&this.drawCaret(e,t,i,n),t.lineTo(o,a+u),t.quadraticCurveTo(o,a,o+u,a),t.closePath(),t.fill(),n.borderWidth>0&&t.stroke()}_updateAnimationTarget(r){const s=this.chart,o=this.$animations,a=o&&o.x,l=o&&o.y;if(a||l){const o=To[r.position].call(this,this._active,this._eventPosition);if(!o)return;const e=this._size=Ro(this,r),t=Object.assign({},o,this._size),i=No(s,r,t),n=Oo(r,t,i,s);a._to===n.x&&l._to===n.y||(this.xAlign=i.xAlign,this.yAlign=i.yAlign,this.width=e.width,this.height=e.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,n))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(t);const n={width:this.width,height:this.height},r={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const s=L(t.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&o&&(e.save(),e.globalAlpha=i,this.drawBackground(r,e,n,t),Fi(e,t.textDirection),r.y+=s.top,this.drawTitle(r,e,t),this.drawBody(r,e,t),this.drawFooter(r,e,t),Gi(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const i=this._active,n=e.map(({datasetIndex:e,index:t})=>{const i=this.chart.getDatasetMeta(e);if(!i)throw new Error("Cannot find a dataset at index "+e);return{datasetIndex:e,element:i.data[t],index:t}}),r=!B(i,n),s=this._positionChanged(n,t);(r||s)&&(this._active=n,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,i=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,r=this._active||[],s=this._getActiveElements(e,r,t,i),o=this._positionChanged(s,e),a=t||!B(s,r)||o;return a&&(this._active=s,(n.enabled||n.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),a}_getActiveElements(e,t,i,n){const r=this.options;if("mouseout"===e.type)return[];if(!n)return t;const s=this.chart.getElementsAtEventForMode(e,r.mode,r,i);return r.reverse&&s.reverse(),s}_positionChanged(e,t){const{caretX:i,caretY:n,options:r}=this,s=To[r.position].call(this,e,t);return!1!==s&&(i!==s.x||n!==s.y)}}var Go={id:"tooltip",_element:Fo,positioners:To,afterInit(e,t,i){i&&(e.tooltip=new Fo({chart:e,options:i}))},beforeUpdate(e,t,i){e.tooltip&&e.tooltip.initialize(i)},reset(e,t,i){e.tooltip&&e.tooltip.initialize(i)},afterDraw(t){const i=t.tooltip;if(i&&i._willRender()){const e={tooltip:i};if(!1===t.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0}))return;i.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",e)}},afterEvent(t,i){if(t.tooltip){const e=i.replay;t.tooltip.handleEvent(i.event,e,i.inChartArea)&&(i.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Lo},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};return i.register(Yr,Ws,fs,n),i.helpers={...Yi},i._adapters=Lr,i.Animation=kn,i.Animations=Ln,i.animator=u,i.controllers=h.controllers.items,i.DatasetController=qn,i.Element=t,i.elements=fs,i.Interaction=en,i.layouts=r,i.platforms=On,i.Scale=rr,i.Ticks=vt,Object.assign(i,Yr,Ws,fs,n,On),i.Chart=i,"undefined"!=typeof window&&(window.Chart=i),i});(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?t(require("chart.js")):typeof define==="function"&&define.amd?define(["chart.js"],t):(e=typeof globalThis!=="undefined"?globalThis:e||self,t(e.Chart))})(this,function(N){"use strict";function I(e){if(e===null||e===true||e===false){return NaN}var t=Number(e);if(isNaN(t)){return t}return t<0?Math.ceil(t):Math.floor(t)}function P(e,t){if(t.length<e){throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}}function k(e){P(1,arguments);var t=Object.prototype.toString.call(e);if(e instanceof Date||typeof e==="object"&&t==="[object Date]"){return new Date(e.getTime())}else if(typeof e==="number"||t==="[object Number]"){return new Date(e)}else{if((typeof e==="string"||t==="[object String]")&&typeof console!=="undefined"){console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule");console.warn((new Error).stack)}return new Date(NaN)}}function r(e,t){P(2,arguments);var i=k(e);var n=I(t);if(isNaN(n)){return new Date(NaN)}if(!n){return i}i.setDate(i.getDate()+n);return i}function s(e,t){P(2,arguments);var i=k(e);var n=I(t);if(isNaN(n)){return new Date(NaN)}if(!n){return i}var r=i.getDate();var s=new Date(i.getTime());s.setMonth(i.getMonth()+n+1,0);var o=s.getDate();if(r>=o){return s}else{i.setFullYear(s.getFullYear(),s.getMonth(),r);return i}}function n(e,t){P(2,arguments);var i=k(e).getTime();var n=I(t);return new Date(i+n)}var O=36e5;function G(e,t){P(2,arguments);var i=I(t);return n(e,i*O)}function o(e,t){P(1,arguments);var i=t||{};var n=i.locale;var r=n&&n.options&&n.options.weekStartsOn;var s=r==null?0:I(r);var o=i.weekStartsOn==null?s:I(i.weekStartsOn);if(!(o>=0&&o<=6)){throw new RangeError("weekStartsOn must be between 0 and 6 inclusively")}var a=k(e);var l=a.getDay();var c=(l<o?7:0)+l-o;a.setDate(a.getDate()-c);a.setHours(0,0,0,0);return a}function L(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));t.setUTCFullYear(e.getFullYear());return e.getTime()-t.getTime()}function a(e){P(1,arguments);var t=k(e);t.setHours(0,0,0,0);return t}var $=864e5;function H(e,t){P(2,arguments);var i=a(e);var n=a(t);var r=i.getTime()-L(i);var s=n.getTime()-L(n);return Math.round((r-s)/$)}var B=6e4;function V(e,t){P(2,arguments);var i=I(t);return n(e,i*B)}function W(e,t){P(2,arguments);var i=I(t);var n=i*3;return s(e,n)}function z(e,t){P(2,arguments);var i=I(t);return n(e,i*1e3)}function j(e,t){P(2,arguments);var i=I(t);var n=i*7;return r(e,n)}function U(e,t){P(2,arguments);var i=I(t);return s(e,i*12)}function l(e,t){P(2,arguments);var i=k(e);var n=k(t);var r=i.getTime()-n.getTime();if(r<0){return-1}else if(r>0){return 1}else{return r}}function v(e){P(1,arguments);var t=k(e);return!isNaN(t)}function Y(e,t){P(2,arguments);var i=k(e);var n=k(t);var r=i.getFullYear()-n.getFullYear();var s=i.getMonth()-n.getMonth();return r*12+s}function q(e,t){P(2,arguments);var i=k(e);var n=k(t);return i.getFullYear()-n.getFullYear()}function c(e,t){var i=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();if(i<0){return-1}else if(i>0){return 1}else{return i}}function K(e,t){P(2,arguments);var i=k(e);var n=k(t);var r=c(i,n);var s=Math.abs(H(i,n));i.setDate(i.getDate()-r*s);var o=c(i,n)===-r;var a=r*(s-o);return a===0?0:a}function u(e,t){P(2,arguments);var i=k(e);var n=k(t);return i.getTime()-n.getTime()}var X=36e5;function Q(e,t){P(2,arguments);var i=u(e,t)/X;return i>0?Math.floor(i):Math.ceil(i)}var Z=6e4;function J(e,t){P(2,arguments);var i=u(e,t)/Z;return i>0?Math.floor(i):Math.ceil(i)}function ee(e){P(1,arguments);var t=k(e);t.setHours(23,59,59,999);return t}function te(e){P(1,arguments);var t=k(e);var i=t.getMonth();t.setFullYear(t.getFullYear(),i+1,0);t.setHours(23,59,59,999);return t}function ie(e){P(1,arguments);var t=k(e);return ee(t).getTime()===te(t).getTime()}function ne(e,t){P(2,arguments);var i=k(e);var n=k(t);var r=l(i,n);var s=Math.abs(Y(i,n));var o;if(s<1){o=0}else{if(i.getMonth()===1&&i.getDate()>27){i.setDate(30)}i.setMonth(i.getMonth()-r*s);var a=l(i,n)===-r;if(ie(k(e))&&s===1&&l(e,n)===1){a=false}o=r*(s-a)}return o===0?0:o}function re(e,t){P(2,arguments);var i=ne(e,t)/3;return i>0?Math.floor(i):Math.ceil(i)}function se(e,t){P(2,arguments);var i=u(e,t)/1e3;return i>0?Math.floor(i):Math.ceil(i)}function oe(e,t){P(2,arguments);var i=K(e,t)/7;return i>0?Math.floor(i):Math.ceil(i)}function ae(e,t){P(2,arguments);var i=k(e);var n=k(t);var r=l(i,n);var s=Math.abs(q(i,n));i.setFullYear("1584");n.setFullYear("1584");var o=l(i,n)===-r;var a=r*(s-o);return a===0?0:a}function le(e){P(1,arguments);var t=k(e);var i=t.getMonth();var n=i-i%3;t.setMonth(n,1);t.setHours(0,0,0,0);return t}function ce(e){P(1,arguments);var t=k(e);t.setDate(1);t.setHours(0,0,0,0);return t}function ue(e){P(1,arguments);var t=k(e);var i=new Date(0);i.setFullYear(t.getFullYear(),0,1);i.setHours(0,0,0,0);return i}function de(e){P(1,arguments);var t=k(e);var i=t.getFullYear();t.setFullYear(i+1,0,0);t.setHours(23,59,59,999);return t}function he(e){P(1,arguments);var t=k(e);t.setMinutes(59,59,999);return t}function pe(e,t){P(1,arguments);var i=t||{};var n=i.locale;var r=n&&n.options&&n.options.weekStartsOn;var s=r==null?0:I(r);var o=i.weekStartsOn==null?s:I(i.weekStartsOn);if(!(o>=0&&o<=6)){throw new RangeError("weekStartsOn must be between 0 and 6 inclusively")}var a=k(e);var l=a.getDay();var c=(l<o?-7:0)+6-(l-o);a.setDate(a.getDate()+c);a.setHours(23,59,59,999);return a}function fe(e){P(1,arguments);var t=k(e);t.setSeconds(59,999);return t}function ge(e){P(1,arguments);var t=k(e);var i=t.getMonth();var n=i-i%3+3;t.setMonth(n,0);t.setHours(23,59,59,999);return t}function me(e){P(1,arguments);var t=k(e);t.setMilliseconds(999);return t}var d={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function ve(e,t,i){i=i||{};var n;if(typeof d[e]==="string"){n=d[e]}else if(t===1){n=d[e].one}else{n=d[e].other.replace("{{count}}",t)}if(i.addSuffix){if(i.comparison>0){return"in "+n}else{return n+" ago"}}return n}function e(r){return function(e){var t=e||{};var i=t.width?String(t.width):r.defaultWidth;var n=r.formats[i]||r.formats[r.defaultWidth];return n}}var ye={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"};var be={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"};var Ce={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"};var we={date:e({formats:ye,defaultWidth:"full"}),time:e({formats:be,defaultWidth:"full"}),dateTime:e({formats:Ce,defaultWidth:"full"})};var _e=we;var Ae={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function Ee(e,t,i,n){return Ae[e]}function t(u){return function(e,t){var i=t||{};var n=i.context?String(i.context):"standalone";var r;if(n==="formatting"&&u.formattingValues){var s=u.defaultFormattingWidth||u.defaultWidth;var o=i.width?String(i.width):s;r=u.formattingValues[o]||u.formattingValues[s]}else{var a=u.defaultWidth;var l=i.width?String(i.width):u.defaultWidth;r=u.values[l]||u.values[a]}var c=u.argumentCallback?u.argumentCallback(e):e;return r[c]}}var Se={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]};var Te={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]};var xe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]};var De={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]};var Re={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}};var Me={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}};function Ne(e,t){var i=Number(e);var n=i%100;if(n>20||n<10){switch(n%10){case 1:return i+"st";case 2:return i+"nd";case 3:return i+"rd"}}return i+"th"}var Oe={ordinalNumber:Ne,era:t({values:Se,defaultWidth:"wide"}),quarter:t({values:Te,defaultWidth:"wide",argumentCallback:function(e){return Number(e)-1}}),month:t({values:xe,defaultWidth:"wide"}),day:t({values:De,defaultWidth:"wide"}),dayPeriod:t({values:Re,defaultWidth:"wide",formattingValues:Me,defaultFormattingWidth:"wide"})};var Ie=Oe;function Pe(l){return function(e,t){var i=String(e);var n=t||{};var r=i.match(l.matchPattern);if(!r){return null}var s=r[0];var o=i.match(l.parsePattern);if(!o){return null}var a=l.valueCallback?l.valueCallback(o[0]):o[0];a=n.valueCallback?n.valueCallback(a):a;return{value:a,rest:i.slice(s.length)}}}function i(u){return function(e,t){var i=String(e);var n=t||{};var r=n.width;var s=r&&u.matchPatterns[r]||u.matchPatterns[u.defaultMatchWidth];var o=i.match(s);if(!o){return null}var a=o[0];var l=r&&u.parsePatterns[r]||u.parsePatterns[u.defaultParseWidth];var c;if(Object.prototype.toString.call(l)==="[object Array]"){c=Le(l,function(e){return e.test(a)})}else{c=ke(l,function(e){return e.test(a)})}c=u.valueCallback?u.valueCallback(c):c;c=n.valueCallback?n.valueCallback(c):c;return{value:c,rest:i.slice(a.length)}}}function ke(e,t){for(var i in e){if(e.hasOwnProperty(i)&&t(e[i])){return i}}}function Le(e,t){for(var i=0;i<e.length;i++){if(t(e[i])){return i}}}var Fe=/^(\d+)(th|st|nd|rd)?/i;var Ge=/\d+/i;var $e={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i};var He={any:[/^b/i,/^(a|c)/i]};var Be={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i};var Ve={any:[/1/i,/2/i,/3/i,/4/i]};var We={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i};var ze={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]};var je={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i};var Ue={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]};var Ye={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i};var qe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}};var Ke={ordinalNumber:Pe({matchPattern:Fe,parsePattern:Ge,valueCallback:function(e){return parseInt(e,10)}}),era:i({matchPatterns:$e,defaultMatchWidth:"wide",parsePatterns:He,defaultParseWidth:"any"}),quarter:i({matchPatterns:Be,defaultMatchWidth:"wide",parsePatterns:Ve,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:i({matchPatterns:We,defaultMatchWidth:"wide",parsePatterns:ze,defaultParseWidth:"any"}),day:i({matchPatterns:je,defaultMatchWidth:"wide",parsePatterns:Ue,defaultParseWidth:"any"}),dayPeriod:i({matchPatterns:Ye,defaultMatchWidth:"any",parsePatterns:qe,defaultParseWidth:"any"})};var Xe=Ke;var Qe={code:"en-US",formatDistance:ve,formatLong:_e,formatRelative:Ee,localize:Ie,match:Xe,options:{weekStartsOn:0,firstWeekContainsDate:1}};var Ze=Qe;function Je(e,t){P(2,arguments);var i=I(t);return n(e,-i)}function h(e,t){var i=e<0?"-":"";var n=Math.abs(e).toString();while(n.length<t){n="0"+n}return i+n}var et={y:function(e,t){var i=e.getUTCFullYear();var n=i>0?i:1-i;return h(t==="yy"?n%100:n,t.length)},M:function(e,t){var i=e.getUTCMonth();return t==="M"?String(i+1):h(i+1,2)},d:function(e,t){return h(e.getUTCDate(),t.length)},a:function(e,t){var i=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return i.toUpperCase();case"aaa":return i;case"aaaaa":return i[0];case"aaaa":default:return i==="am"?"a.m.":"p.m."}},h:function(e,t){return h(e.getUTCHours()%12||12,t.length)},H:function(e,t){return h(e.getUTCHours(),t.length)},m:function(e,t){return h(e.getUTCMinutes(),t.length)},s:function(e,t){return h(e.getUTCSeconds(),t.length)},S:function(e,t){var i=t.length;var n=e.getUTCMilliseconds();var r=Math.floor(n*Math.pow(10,i-3));return h(r,t.length)}};var p=et;var tt=864e5;function it(e){P(1,arguments);var t=k(e);var i=t.getTime();t.setUTCMonth(0,1);t.setUTCHours(0,0,0,0);var n=t.getTime();var r=i-n;return Math.floor(r/tt)+1}function f(e){P(1,arguments);var t=1;var i=k(e);var n=i.getUTCDay();var r=(n<t?7:0)+n-t;i.setUTCDate(i.getUTCDate()-r);i.setUTCHours(0,0,0,0);return i}function nt(e){P(1,arguments);var t=k(e);var i=t.getUTCFullYear();var n=new Date(0);n.setUTCFullYear(i+1,0,4);n.setUTCHours(0,0,0,0);var r=f(n);var s=new Date(0);s.setUTCFullYear(i,0,4);s.setUTCHours(0,0,0,0);var o=f(s);if(t.getTime()>=r.getTime()){return i+1}else if(t.getTime()>=o.getTime()){return i}else{return i-1}}function rt(e){P(1,arguments);var t=nt(e);var i=new Date(0);i.setUTCFullYear(t,0,4);i.setUTCHours(0,0,0,0);var n=f(i);return n}var st=6048e5;function ot(e){P(1,arguments);var t=k(e);var i=f(t).getTime()-rt(t).getTime();return Math.round(i/st)+1}function g(e,t){P(1,arguments);var i=t||{};var n=i.locale;var r=n&&n.options&&n.options.weekStartsOn;var s=r==null?0:I(r);var o=i.weekStartsOn==null?s:I(i.weekStartsOn);if(!(o>=0&&o<=6)){throw new RangeError("weekStartsOn must be between 0 and 6 inclusively")}var a=k(e);var l=a.getUTCDay();var c=(l<o?7:0)+l-o;a.setUTCDate(a.getUTCDate()-c);a.setUTCHours(0,0,0,0);return a}function m(e,t){P(1,arguments);var i=k(e,t);var n=i.getUTCFullYear();var r=t||{};var s=r.locale;var o=s&&s.options&&s.options.firstWeekContainsDate;var a=o==null?1:I(o);var l=r.firstWeekContainsDate==null?a:I(r.firstWeekContainsDate);if(!(l>=1&&l<=7)){throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively")}var c=new Date(0);c.setUTCFullYear(n+1,0,l);c.setUTCHours(0,0,0,0);var u=g(c,t);var d=new Date(0);d.setUTCFullYear(n,0,l);d.setUTCHours(0,0,0,0);var h=g(d,t);if(i.getTime()>=u.getTime()){return n+1}else if(i.getTime()>=h.getTime()){return n}else{return n-1}}function at(e,t){P(1,arguments);var i=t||{};var n=i.locale;var r=n&&n.options&&n.options.firstWeekContainsDate;var s=r==null?1:I(r);var o=i.firstWeekContainsDate==null?s:I(i.firstWeekContainsDate);var a=m(e,t);var l=new Date(0);l.setUTCFullYear(a,0,o);l.setUTCHours(0,0,0,0);var c=g(l,t);return c}var lt=6048e5;function ct(e,t){P(1,arguments);var i=k(e);var n=g(i,t).getTime()-at(i,t).getTime();return Math.round(n/lt)+1}var y={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"};var ut={G:function(e,t,i){var n=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return i.era(n,{width:"abbreviated"});case"GGGGG":return i.era(n,{width:"narrow"});case"GGGG":default:return i.era(n,{width:"wide"})}},y:function(e,t,i){if(t==="yo"){var n=e.getUTCFullYear();var r=n>0?n:1-n;return i.ordinalNumber(r,{unit:"year"})}return p.y(e,t)},Y:function(e,t,i,n){var r=m(e,n);var s=r>0?r:1-r;if(t==="YY"){var o=s%100;return h(o,2)}if(t==="Yo"){return i.ordinalNumber(s,{unit:"year"})}return h(s,t.length)},R:function(e,t){var i=nt(e);return h(i,t.length)},u:function(e,t){var i=e.getUTCFullYear();return h(i,t.length)},Q:function(e,t,i){var n=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return h(n,2);case"Qo":return i.ordinalNumber(n,{unit:"quarter"});case"QQQ":return i.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return i.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,i){var n=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return h(n,2);case"qo":return i.ordinalNumber(n,{unit:"quarter"});case"qqq":return i.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return i.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,i){var n=e.getUTCMonth();switch(t){case"M":case"MM":return p.M(e,t);case"Mo":return i.ordinalNumber(n+1,{unit:"month"});case"MMM":return i.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return i.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,i){var n=e.getUTCMonth();switch(t){case"L":return String(n+1);case"LL":return h(n+1,2);case"Lo":return i.ordinalNumber(n+1,{unit:"month"});case"LLL":return i.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return i.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,i,n){var r=ct(e,n);if(t==="wo"){return i.ordinalNumber(r,{unit:"week"})}return h(r,t.length)},I:function(e,t,i){var n=ot(e);if(t==="Io"){return i.ordinalNumber(n,{unit:"week"})}return h(n,t.length)},d:function(e,t,i){if(t==="do"){return i.ordinalNumber(e.getUTCDate(),{unit:"date"})}return p.d(e,t)},D:function(e,t,i){var n=it(e);if(t==="Do"){return i.ordinalNumber(n,{unit:"dayOfYear"})}return h(n,t.length)},E:function(e,t,i){var n=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return i.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return i.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(n,{width:"short",context:"formatting"});case"EEEE":default:return i.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,i,n){var r=e.getUTCDay();var s=(r-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return h(s,2);case"eo":return i.ordinalNumber(s,{unit:"day"});case"eee":return i.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return i.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(r,{width:"short",context:"formatting"});case"eeee":default:return i.day(r,{width:"wide",context:"formatting"})}},c:function(e,t,i,n){var r=e.getUTCDay();var s=(r-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return h(s,t.length);case"co":return i.ordinalNumber(s,{unit:"day"});case"ccc":return i.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return i.day(r,{width:"narrow",context:"standalone"});case"cccccc":return i.day(r,{width:"short",context:"standalone"});case"cccc":default:return i.day(r,{width:"wide",context:"standalone"})}},i:function(e,t,i){var n=e.getUTCDay();var r=n===0?7:n;switch(t){case"i":return String(r);case"ii":return h(r,t.length);case"io":return i.ordinalNumber(r,{unit:"day"});case"iii":return i.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return i.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return i.day(n,{width:"short",context:"formatting"});case"iiii":default:return i.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,i){var n=e.getUTCHours();var r=n/12>=1?"pm":"am";switch(t){case"a":case"aa":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return i.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,i){var n=e.getUTCHours();var r;if(n===12){r=y.noon}else if(n===0){r=y.midnight}else{r=n/12>=1?"pm":"am"}switch(t){case"b":case"bb":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return i.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,i){var n=e.getUTCHours();var r;if(n>=17){r=y.evening}else if(n>=12){r=y.afternoon}else if(n>=4){r=y.morning}else{r=y.night}switch(t){case"B":case"BB":case"BBB":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return i.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,i){if(t==="ho"){var n=e.getUTCHours()%12;if(n===0)n=12;return i.ordinalNumber(n,{unit:"hour"})}return p.h(e,t)},H:function(e,t,i){if(t==="Ho"){return i.ordinalNumber(e.getUTCHours(),{unit:"hour"})}return p.H(e,t)},K:function(e,t,i){var n=e.getUTCHours()%12;if(t==="Ko"){return i.ordinalNumber(n,{unit:"hour"})}return h(n,t.length)},k:function(e,t,i){var n=e.getUTCHours();if(n===0)n=24;if(t==="ko"){return i.ordinalNumber(n,{unit:"hour"})}return h(n,t.length)},m:function(e,t,i){if(t==="mo"){return i.ordinalNumber(e.getUTCMinutes(),{unit:"minute"})}return p.m(e,t)},s:function(e,t,i){if(t==="so"){return i.ordinalNumber(e.getUTCSeconds(),{unit:"second"})}return p.s(e,t)},S:function(e,t){return p.S(e,t)},X:function(e,t,i,n){var r=n._originalDate||e;var s=r.getTimezoneOffset();if(s===0){return"Z"}switch(t){case"X":return ht(s);case"XXXX":case"XX":return b(s);case"XXXXX":case"XXX":default:return b(s,":")}},x:function(e,t,i,n){var r=n._originalDate||e;var s=r.getTimezoneOffset();switch(t){case"x":return ht(s);case"xxxx":case"xx":return b(s);case"xxxxx":case"xxx":default:return b(s,":")}},O:function(e,t,i,n){var r=n._originalDate||e;var s=r.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+dt(s,":");case"OOOO":default:return"GMT"+b(s,":")}},z:function(e,t,i,n){var r=n._originalDate||e;var s=r.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+dt(s,":");case"zzzz":default:return"GMT"+b(s,":")}},t:function(e,t,i,n){var r=n._originalDate||e;var s=Math.floor(r.getTime()/1e3);return h(s,t.length)},T:function(e,t,i,n){var r=n._originalDate||e;var s=r.getTime();return h(s,t.length)}};function dt(e,t){var i=e>0?"-":"+";var n=Math.abs(e);var r=Math.floor(n/60);var s=n%60;if(s===0){return i+String(r)}var o=t||"";return i+String(r)+o+h(s,2)}function ht(e,t){if(e%60===0){var i=e>0?"-":"+";return i+h(Math.abs(e)/60,2)}return b(e,t)}function b(e,t){var i=t||"";var n=e>0?"-":"+";var r=Math.abs(e);var s=h(Math.floor(r/60),2);var o=h(r%60,2);return n+s+i+o}var pt=ut;function ft(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}}function gt(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}}function mt(e,t){var i=e.match(/(P+)(p+)?/);var n=i[1];var r=i[2];if(!r){return ft(e,t)}var s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",ft(n,t)).replace("{{time}}",gt(r,t))}var vt={p:gt,P:mt};var yt=vt;var bt=["D","DD"];var Ct=["YY","YYYY"];function wt(e){return bt.indexOf(e)!==-1}function _t(e){return Ct.indexOf(e)!==-1}function F(e,t,i){if(e==="YYYY"){throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(i,"`; see: https://git.io/fxCyr"))}else if(e==="YY"){throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(i,"`; see: https://git.io/fxCyr"))}else if(e==="D"){throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(i,"`; see: https://git.io/fxCyr"))}else if(e==="DD"){throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(i,"`; see: https://git.io/fxCyr"))}}var At=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g;var Et=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;var St=/^'([^]*?)'?$/;var Tt=/''/g;var xt=/[a-zA-Z]/;function Dt(n,r,e){P(2,arguments);var t=String(r);var s=e||{};var o=s.locale||Ze;var i=o.options&&o.options.firstWeekContainsDate;var a=i==null?1:I(i);var l=s.firstWeekContainsDate==null?a:I(s.firstWeekContainsDate);if(!(l>=1&&l<=7)){throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively")}var c=o.options&&o.options.weekStartsOn;var u=c==null?0:I(c);var d=s.weekStartsOn==null?u:I(s.weekStartsOn);if(!(d>=0&&d<=6)){throw new RangeError("weekStartsOn must be between 0 and 6 inclusively")}if(!o.localize){throw new RangeError("locale must contain localize property")}if(!o.formatLong){throw new RangeError("locale must contain formatLong property")}var h=k(n);if(!v(h)){throw new RangeError("Invalid time value")}var p=L(h);var f=Je(h,p);var g={firstWeekContainsDate:l,weekStartsOn:d,locale:o,_originalDate:h};var m=t.match(Et).map(function(e){var t=e[0];if(t==="p"||t==="P"){var i=yt[t];return i(e,o.formatLong,g)}return e}).join("").match(At).map(function(e){if(e==="''"){return"'"}var t=e[0];if(t==="'"){return Rt(e)}var i=pt[t];if(i){if(!s.useAdditionalWeekYearTokens&&_t(e)){F(e,r,n)}if(!s.useAdditionalDayOfYearTokens&&wt(e)){F(e,r,n)}return i(f,e,o.localize,g)}if(t.match(xt)){throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`")}return e}).join("");return m}function Rt(e){return e.match(St)[1].replace(Tt,"'")}function Mt(e,t){if(e==null){throw new TypeError("assign requires that input parameter not be null or undefined")}t=t||{};for(var i in t){if(t.hasOwnProperty(i)){e[i]=t[i]}}return e}function C(e,t,i){P(2,arguments);var n=i||{};var r=n.locale;var s=r&&r.options&&r.options.weekStartsOn;var o=s==null?0:I(s);var a=n.weekStartsOn==null?o:I(n.weekStartsOn);if(!(a>=0&&a<=6)){throw new RangeError("weekStartsOn must be between 0 and 6 inclusively")}var l=k(e);var c=I(t);var u=l.getUTCDay();var d=c%7;var h=(d+7)%7;var p=(h<a?7:0)+c-u;l.setUTCDate(l.getUTCDate()+p);return l}function Nt(e,t){P(2,arguments);var i=I(t);if(i%7===0){i=i-7}var n=1;var r=k(e);var s=r.getUTCDay();var o=i%7;var a=(o+7)%7;var l=(a<n?7:0)+i-s;r.setUTCDate(r.getUTCDate()+l);return r}function Ot(e,t){P(2,arguments);var i=k(e);var n=I(t);var r=ot(i)-n;i.setUTCDate(i.getUTCDate()-r*7);return i}function It(e,t,i){P(2,arguments);var n=k(e);var r=I(t);var s=ct(n,i)-r;n.setUTCDate(n.getUTCDate()-s*7);return n}var Pt=36e5;var kt=6e4;var Lt=1e3;var w={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/};var _={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function A(e,t,i){var n=t.match(e);if(!n){return null}var r=parseInt(n[0],10);return{value:i?i(r):r,rest:t.slice(n[0].length)}}function E(e,t){var i=t.match(e);if(!i){return null}if(i[0]==="Z"){return{value:0,rest:t.slice(1)}}var n=i[1]==="+"?1:-1;var r=i[2]?parseInt(i[2],10):0;var s=i[3]?parseInt(i[3],10):0;var o=i[5]?parseInt(i[5],10):0;return{value:n*(r*Pt+s*kt+o*Lt),rest:t.slice(i[0].length)}}function Ft(e,t){return A(w.anyDigitsSigned,e,t)}function S(e,t,i){switch(e){case 1:return A(w.singleDigit,t,i);case 2:return A(w.twoDigits,t,i);case 3:return A(w.threeDigits,t,i);case 4:return A(w.fourDigits,t,i);default:return A(new RegExp("^\\d{1,"+e+"}"),t,i)}}function T(e,t,i){switch(e){case 1:return A(w.singleDigitSigned,t,i);case 2:return A(w.twoDigitsSigned,t,i);case 3:return A(w.threeDigitsSigned,t,i);case 4:return A(w.fourDigitsSigned,t,i);default:return A(new RegExp("^-?\\d{1,"+e+"}"),t,i)}}function x(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Gt(e,t){var i=t>0;var n=i?t:1-t;var r;if(n<=50){r=e||100}else{var s=n+50;var o=Math.floor(s/100)*100;var a=e>=s%100;r=e+o-(a?100:0)}return i?r:1-r}var $t=[31,28,31,30,31,30,31,31,30,31,30,31];var Ht=[31,29,31,30,31,30,31,31,30,31,30,31];function Bt(e){return e%400===0||e%4===0&&e%100!==0}var Vt={G:{priority:140,parse:function(e,t,i,n){switch(t){case"G":case"GG":case"GGG":return i.era(e,{width:"abbreviated"})||i.era(e,{width:"narrow"});case"GGGGG":return i.era(e,{width:"narrow"});case"GGGG":default:return i.era(e,{width:"wide"})||i.era(e,{width:"abbreviated"})||i.era(e,{width:"narrow"})}},set:function(e,t,i,n){t.era=i;e.setUTCFullYear(i,0,1);e.setUTCHours(0,0,0,0);return e},incompatibleTokens:["R","u","t","T"]},y:{priority:130,parse:function(e,t,i,n){var r=function(e){return{year:e,isTwoDigitYear:t==="yy"}};switch(t){case"y":return S(4,e,r);case"yo":return i.ordinalNumber(e,{unit:"year",valueCallback:r});default:return S(t.length,e,r)}},validate:function(e,t,i){return t.isTwoDigitYear||t.year>0},set:function(e,t,i,n){var r=e.getUTCFullYear();if(i.isTwoDigitYear){var s=Gt(i.year,r);e.setUTCFullYear(s,0,1);e.setUTCHours(0,0,0,0);return e}var o=!("era"in t)||t.era===1?i.year:1-i.year;e.setUTCFullYear(o,0,1);e.setUTCHours(0,0,0,0);return e},incompatibleTokens:["Y","R","u","w","I","i","e","c","t","T"]},Y:{priority:130,parse:function(e,t,i,n){var r=function(e){return{year:e,isTwoDigitYear:t==="YY"}};switch(t){case"Y":return S(4,e,r);case"Yo":return i.ordinalNumber(e,{unit:"year",valueCallback:r});default:return S(t.length,e,r)}},validate:function(e,t,i){return t.isTwoDigitYear||t.year>0},set:function(e,t,i,n){var r=m(e,n);if(i.isTwoDigitYear){var s=Gt(i.year,r);e.setUTCFullYear(s,0,n.firstWeekContainsDate);e.setUTCHours(0,0,0,0);return g(e,n)}var o=!("era"in t)||t.era===1?i.year:1-i.year;e.setUTCFullYear(o,0,n.firstWeekContainsDate);e.setUTCHours(0,0,0,0);return g(e,n)},incompatibleTokens:["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},R:{priority:130,parse:function(e,t,i,n){if(t==="R"){return T(4,e)}return T(t.length,e)},set:function(e,t,i,n){var r=new Date(0);r.setUTCFullYear(i,0,4);r.setUTCHours(0,0,0,0);return f(r)},incompatibleTokens:["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},u:{priority:130,parse:function(e,t,i,n){if(t==="u"){return T(4,e)}return T(t.length,e)},set:function(e,t,i,n){e.setUTCFullYear(i,0,1);e.setUTCHours(0,0,0,0);return e},incompatibleTokens:["G","y","Y","R","w","I","i","e","c","t","T"]},Q:{priority:120,parse:function(e,t,i,n){switch(t){case"Q":case"QQ":return S(t.length,e);case"Qo":return i.ordinalNumber(e,{unit:"quarter"});case"QQQ":return i.quarter(e,{width:"abbreviated",context:"formatting"})||i.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return i.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(e,{width:"wide",context:"formatting"})||i.quarter(e,{width:"abbreviated",context:"formatting"})||i.quarter(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,i){return t>=1&&t<=4},set:function(e,t,i,n){e.setUTCMonth((i-1)*3,1);e.setUTCHours(0,0,0,0);return e},incompatibleTokens:["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},q:{priority:120,parse:function(e,t,i,n){switch(t){case"q":case"qq":return S(t.length,e);case"qo":return i.ordinalNumber(e,{unit:"quarter"});case"qqq":return i.quarter(e,{width:"abbreviated",context:"standalone"})||i.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return i.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(e,{width:"wide",context:"standalone"})||i.quarter(e,{width:"abbreviated",context:"standalone"})||i.quarter(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,i){return t>=1&&t<=4},set:function(e,t,i,n){e.setUTCMonth((i-1)*3,1);e.setUTCHours(0,0,0,0);return e},incompatibleTokens:["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},M:{priority:110,parse:function(e,t,i,n){var r=function(e){return e-1};switch(t){case"M":return A(w.month,e,r);case"MM":return S(2,e,r);case"Mo":return i.ordinalNumber(e,{unit:"month",valueCallback:r});case"MMM":return i.month(e,{width:"abbreviated",context:"formatting"})||i.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return i.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(e,{width:"wide",context:"formatting"})||i.month(e,{width:"abbreviated",context:"formatting"})||i.month(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,i){return t>=0&&t<=11},set:function(e,t,i,n){e.setUTCMonth(i,1);e.setUTCHours(0,0,0,0);return e},incompatibleTokens:["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]},L:{priority:110,parse:function(e,t,i,n){var r=function(e){return e-1};switch(t){case"L":return A(w.month,e,r);case"LL":return S(2,e,r);case"Lo":return i.ordinalNumber(e,{unit:"month",valueCallback:r});case"LLL":return i.month(e,{width:"abbreviated",context:"standalone"})||i.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return i.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(e,{width:"wide",context:"standalone"})||i.month(e,{width:"abbreviated",context:"standalone"})||i.month(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,i){return t>=0&&t<=11},set:function(e,t,i,n){e.setUTCMonth(i,1);e.setUTCHours(0,0,0,0);return e},incompatibleTokens:["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]},w:{priority:100,parse:function(e,t,i,n){switch(t){case"w":return A(w.week,e);case"wo":return i.ordinalNumber(e,{unit:"week"});default:return S(t.length,e)}},validate:function(e,t,i){return t>=1&&t<=53},set:function(e,t,i,n){return g(It(e,i,n),n)},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","i","t","T"]},I:{priority:100,parse:function(e,t,i,n){switch(t){case"I":return A(w.week,e);case"Io":return i.ordinalNumber(e,{unit:"week"});default:return S(t.length,e)}},validate:function(e,t,i){return t>=1&&t<=53},set:function(e,t,i,n){return f(Ot(e,i,n),n)},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]},d:{priority:90,subPriority:1,parse:function(e,t,i,n){switch(t){case"d":return A(w.date,e);case"do":return i.ordinalNumber(e,{unit:"date"});default:return S(t.length,e)}},validate:function(e,t,i){var n=e.getUTCFullYear();var r=Bt(n);var s=e.getUTCMonth();if(r){return t>=1&&t<=Ht[s]}else{return t>=1&&t<=$t[s]}},set:function(e,t,i,n){e.setUTCDate(i);e.setUTCHours(0,0,0,0);return e},incompatibleTokens:["Y","R","q","Q","w","I","D","i","e","c","t","T"]},D:{priority:90,subPriority:1,parse:function(e,t,i,n){switch(t){case"D":case"DD":return A(w.dayOfYear,e);case"Do":return i.ordinalNumber(e,{unit:"date"});default:return S(t.length,e)}},validate:function(e,t,i){var n=e.getUTCFullYear();var r=Bt(n);if(r){return t>=1&&t<=366}else{return t>=1&&t<=365}},set:function(e,t,i,n){e.setUTCMonth(0,i);e.setUTCHours(0,0,0,0);return e},incompatibleTokens:["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]},E:{priority:90,parse:function(e,t,i,n){switch(t){case"E":case"EE":case"EEE":return i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return i.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return i.day(e,{width:"wide",context:"formatting"})||i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,i){return t>=0&&t<=6},set:function(e,t,i,n){e=C(e,i,n);e.setUTCHours(0,0,0,0);return e},incompatibleTokens:["D","i","e","c","t","T"]},e:{priority:90,parse:function(e,t,i,n){var r=function(e){var t=Math.floor((e-1)/7)*7;return(e+n.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return S(t.length,e,r);case"eo":return i.ordinalNumber(e,{unit:"day",valueCallback:r});case"eee":return i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"});case"eeeee":return i.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return i.day(e,{width:"wide",context:"formatting"})||i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,i){return t>=0&&t<=6},set:function(e,t,i,n){e=C(e,i,n);e.setUTCHours(0,0,0,0);return e},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},c:{priority:90,parse:function(e,t,i,n){var r=function(e){var t=Math.floor((e-1)/7)*7;return(e+n.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return S(t.length,e,r);case"co":return i.ordinalNumber(e,{unit:"day",valueCallback:r});case"ccc":return i.day(e,{width:"abbreviated",context:"standalone"})||i.day(e,{width:"short",context:"standalone"})||i.day(e,{width:"narrow",context:"standalone"});case"ccccc":return i.day(e,{width:"narrow",context:"standalone"});case"cccccc":return i.day(e,{width:"short",context:"standalone"})||i.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return i.day(e,{width:"wide",context:"standalone"})||i.day(e,{width:"abbreviated",context:"standalone"})||i.day(e,{width:"short",context:"standalone"})||i.day(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,i){return t>=0&&t<=6},set:function(e,t,i,n){e=C(e,i,n);e.setUTCHours(0,0,0,0);return e},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]},i:{priority:90,parse:function(e,t,i,n){var r=function(e){if(e===0){return 7}return e};switch(t){case"i":case"ii":return S(t.length,e);case"io":return i.ordinalNumber(e,{unit:"day"});case"iii":return i.day(e,{width:"abbreviated",context:"formatting",valueCallback:r})||i.day(e,{width:"short",context:"formatting",valueCallback:r})||i.day(e,{width:"narrow",context:"formatting",valueCallback:r});case"iiiii":return i.day(e,{width:"narrow",context:"formatting",valueCallback:r});case"iiiiii":return i.day(e,{width:"short",context:"formatting",valueCallback:r})||i.day(e,{width:"narrow",context:"formatting",valueCallback:r});case"iiii":default:return i.day(e,{width:"wide",context:"formatting",valueCallback:r})||i.day(e,{width:"abbreviated",context:"formatting",valueCallback:r})||i.day(e,{width:"short",context:"formatting",valueCallback:r})||i.day(e,{width:"narrow",context:"formatting",valueCallback:r})}},validate:function(e,t,i){return t>=1&&t<=7},set:function(e,t,i,n){e=Nt(e,i,n);e.setUTCHours(0,0,0,0);return e},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},a:{priority:80,parse:function(e,t,i,n){switch(t){case"a":case"aa":case"aaa":return i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return i.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(e,{width:"wide",context:"formatting"})||i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,i,n){e.setUTCHours(x(i),0,0,0);return e},incompatibleTokens:["b","B","H","K","k","t","T"]},b:{priority:80,parse:function(e,t,i,n){switch(t){case"b":case"bb":case"bbb":return i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return i.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(e,{width:"wide",context:"formatting"})||i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,i,n){e.setUTCHours(x(i),0,0,0);return e},incompatibleTokens:["a","B","H","K","k","t","T"]},B:{priority:80,parse:function(e,t,i,n){switch(t){case"B":case"BB":case"BBB":return i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return i.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(e,{width:"wide",context:"formatting"})||i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,i,n){e.setUTCHours(x(i),0,0,0);return e},incompatibleTokens:["a","b","t","T"]},h:{priority:70,parse:function(e,t,i,n){switch(t){case"h":return A(w.hour12h,e);case"ho":return i.ordinalNumber(e,{unit:"hour"});default:return S(t.length,e)}},validate:function(e,t,i){return t>=1&&t<=12},set:function(e,t,i,n){var r=e.getUTCHours()>=12;if(r&&i<12){e.setUTCHours(i+12,0,0,0)}else if(!r&&i===12){e.setUTCHours(0,0,0,0)}else{e.setUTCHours(i,0,0,0)}return e},incompatibleTokens:["H","K","k","t","T"]},H:{priority:70,parse:function(e,t,i,n){switch(t){case"H":return A(w.hour23h,e);case"Ho":return i.ordinalNumber(e,{unit:"hour"});default:return S(t.length,e)}},validate:function(e,t,i){return t>=0&&t<=23},set:function(e,t,i,n){e.setUTCHours(i,0,0,0);return e},incompatibleTokens:["a","b","h","K","k","t","T"]},K:{priority:70,parse:function(e,t,i,n){switch(t){case"K":return A(w.hour11h,e);case"Ko":return i.ordinalNumber(e,{unit:"hour"});default:return S(t.length,e)}},validate:function(e,t,i){return t>=0&&t<=11},set:function(e,t,i,n){var r=e.getUTCHours()>=12;if(r&&i<12){e.setUTCHours(i+12,0,0,0)}else{e.setUTCHours(i,0,0,0)}return e},incompatibleTokens:["a","b","h","H","k","t","T"]},k:{priority:70,parse:function(e,t,i,n){switch(t){case"k":return A(w.hour24h,e);case"ko":return i.ordinalNumber(e,{unit:"hour"});default:return S(t.length,e)}},validate:function(e,t,i){return t>=1&&t<=24},set:function(e,t,i,n){var r=i<=24?i%24:i;e.setUTCHours(r,0,0,0);return e},incompatibleTokens:["a","b","h","H","K","t","T"]},m:{priority:60,parse:function(e,t,i,n){switch(t){case"m":return A(w.minute,e);case"mo":return i.ordinalNumber(e,{unit:"minute"});default:return S(t.length,e)}},validate:function(e,t,i){return t>=0&&t<=59},set:function(e,t,i,n){e.setUTCMinutes(i,0,0);return e},incompatibleTokens:["t","T"]},s:{priority:50,parse:function(e,t,i,n){switch(t){case"s":return A(w.second,e);case"so":return i.ordinalNumber(e,{unit:"second"});default:return S(t.length,e)}},validate:function(e,t,i){return t>=0&&t<=59},set:function(e,t,i,n){e.setUTCSeconds(i,0);return e},incompatibleTokens:["t","T"]},S:{priority:30,parse:function(e,t,i,n){var r=function(e){return Math.floor(e*Math.pow(10,-t.length+3))};return S(t.length,e,r)},set:function(e,t,i,n){e.setUTCMilliseconds(i);return e},incompatibleTokens:["t","T"]},X:{priority:10,parse:function(e,t,i,n){switch(t){case"X":return E(_.basicOptionalMinutes,e);case"XX":return E(_.basic,e);case"XXXX":return E(_.basicOptionalSeconds,e);case"XXXXX":return E(_.extendedOptionalSeconds,e);case"XXX":default:return E(_.extended,e)}},set:function(e,t,i,n){if(t.timestampIsSet){return e}return new Date(e.getTime()-i)},incompatibleTokens:["t","T","x"]},x:{priority:10,parse:function(e,t,i,n){switch(t){case"x":return E(_.basicOptionalMinutes,e);case"xx":return E(_.basic,e);case"xxxx":return E(_.basicOptionalSeconds,e);case"xxxxx":return E(_.extendedOptionalSeconds,e);case"xxx":default:return E(_.extended,e)}},set:function(e,t,i,n){if(t.timestampIsSet){return e}return new Date(e.getTime()-i)},incompatibleTokens:["t","T","X"]},t:{priority:40,parse:function(e,t,i,n){return Ft(e)},set:function(e,t,i,n){return[new Date(i*1e3),{timestampIsSet:true}]},incompatibleTokens:"*"},T:{priority:20,parse:function(e,t,i,n){return Ft(e)},set:function(e,t,i,n){return[new Date(i),{timestampIsSet:true}]},incompatibleTokens:"*"}};var Wt=Vt;var zt=10;var jt=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g;var Ut=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;var Yt=/^'([^]*?)'?$/;var qt=/''/g;var Kt=/\S/;var Xt=/[a-zA-Z]/;function Qt(e,t,i,n){P(3,arguments);var r=String(e);var s=String(t);var o=n||{};var a=o.locale||Ze;if(!a.match){throw new RangeError("locale must contain match property")}var l=a.options&&a.options.firstWeekContainsDate;var c=l==null?1:I(l);var u=o.firstWeekContainsDate==null?c:I(o.firstWeekContainsDate);if(!(u>=1&&u<=7)){throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively")}var d=a.options&&a.options.weekStartsOn;var h=d==null?0:I(d);var p=o.weekStartsOn==null?h:I(o.weekStartsOn);if(!(p>=0&&p<=6)){throw new RangeError("weekStartsOn must be between 0 and 6 inclusively")}if(s===""){if(r===""){return k(i)}else{return new Date(NaN)}}var f={firstWeekContainsDate:u,weekStartsOn:p,locale:a};var g=[{priority:zt,subPriority:-1,set:Zt,index:0}];var m;var v=s.match(Ut).map(function(e){var t=e[0];if(t==="p"||t==="P"){var i=yt[t];return i(e,a.formatLong,f)}return e}).join("").match(jt);var y=[];for(m=0;m<v.length;m++){var b=v[m];if(!o.useAdditionalWeekYearTokens&&_t(b)){F(b,s,e)}if(!o.useAdditionalDayOfYearTokens&&wt(b)){F(b,s,e)}var C=b[0];var w=Wt[C];if(w){var _=w.incompatibleTokens;if(Array.isArray(_)){var A=void 0;for(var E=0;E<y.length;E++){var S=y[E].token;if(_.indexOf(S)!==-1||S===C){A=y[E];break}}if(A){throw new RangeError("The format string mustn't contain `".concat(A.fullToken,"` and `").concat(b,"` at the same time"))}}else if(w.incompatibleTokens==="*"&&y.length){throw new RangeError("The format string mustn't contain `".concat(b,"` and any other token at the same time"))}y.push({token:C,fullToken:b});var T=w.parse(r,b,a.match,f);if(!T){return new Date(NaN)}g.push({priority:w.priority,subPriority:w.subPriority||0,set:w.set,validate:w.validate,value:T.value,index:g.length});r=T.rest}else{if(C.match(Xt)){throw new RangeError("Format string contains an unescaped latin alphabet character `"+C+"`")}if(b==="''"){b="'"}else if(C==="'"){b=Jt(b)}if(r.indexOf(b)===0){r=r.slice(b.length)}else{return new Date(NaN)}}}if(r.length>0&&Kt.test(r)){return new Date(NaN)}var x=g.map(function(e){return e.priority}).sort(function(e,t){return t-e}).filter(function(e,t,i){return i.indexOf(e)===t}).map(function(t){return g.filter(function(e){return e.priority===t}).sort(function(e,t){return t.subPriority-e.subPriority})}).map(function(e){return e[0]});var D=k(i);if(isNaN(D)){return new Date(NaN)}var R=Je(D,L(D));var M={};for(m=0;m<x.length;m++){var N=x[m];if(N.validate&&!N.validate(R,N.value,f)){return new Date(NaN)}var O=N.set(R,M,N.value,f);if(O[0]){R=O[0];Mt(M,O[1])}else{R=O}}return R}function Zt(e,t){if(t.timestampIsSet){return e}var i=new Date(0);i.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate());i.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return i}function Jt(e){return e.match(Yt)[1].replace(qt,"'")}function ei(e){P(1,arguments);var t=k(e);t.setMinutes(0,0,0);return t}function ti(e){P(1,arguments);var t=k(e);t.setSeconds(0,0);return t}function ii(e){P(1,arguments);var t=k(e);t.setMilliseconds(0);return t}var ni=36e5;var ri=6e4;var si=2;var D={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/};var oi=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/;var ai=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/;var li=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ci(e,t){P(1,arguments);var i=t||{};var n=i.additionalDigits==null?si:I(i.additionalDigits);if(n!==2&&n!==1&&n!==0){throw new RangeError("additionalDigits must be 0, 1 or 2")}if(!(typeof e==="string"||Object.prototype.toString.call(e)==="[object String]")){return new Date(NaN)}var r=ui(e);var s;if(r.date){var o=di(r.date,n);s=hi(o.restDateString,o.year)}if(isNaN(s)||!s){return new Date(NaN)}var a=s.getTime();var l=0;var c;if(r.time){l=pi(r.time);if(isNaN(l)||l===null){return new Date(NaN)}}if(r.timezone){c=fi(r.timezone);if(isNaN(c)){return new Date(NaN)}}else{var u=new Date(a+l);var d=new Date(0);d.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate());d.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds());return d}return new Date(a+l+c)}function ui(e){var t={};var i=e.split(D.dateTimeDelimiter);var n;if(i.length>2){return t}if(/:/.test(i[0])){t.date=null;n=i[0]}else{t.date=i[0];n=i[1];if(D.timeZoneDelimiter.test(t.date)){t.date=e.split(D.timeZoneDelimiter)[0];n=e.substr(t.date.length,e.length)}}if(n){var r=D.timezone.exec(n);if(r){t.time=n.replace(r[1],"");t.timezone=r[1]}else{t.time=n}}return t}function di(e,t){var i=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)");var n=e.match(i);if(!n)return{year:null};var r=n[1]&&parseInt(n[1]);var s=n[2]&&parseInt(n[2]);return{year:s==null?r:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function hi(e,t){if(t===null)return null;var i=e.match(oi);if(!i)return null;var n=!!i[4];var r=R(i[1]);var s=R(i[2])-1;var o=R(i[3]);var a=R(i[4]);var l=R(i[5])-1;if(n){if(!Ci(t,a,l)){return new Date(NaN)}return gi(t,a,l)}else{var c=new Date(0);if(!yi(t,s,o)||!bi(t,r)){return new Date(NaN)}c.setUTCFullYear(t,s,Math.max(r,o));return c}}function R(e){return e?parseInt(e):1}function pi(e){var t=e.match(ai);if(!t)return null;var i=M(t[1]);var n=M(t[2]);var r=M(t[3]);if(!wi(i,n,r)){return NaN}return i*ni+n*ri+r*1e3}function M(e){return e&&parseFloat(e.replace(",","."))||0}function fi(e){if(e==="Z")return 0;var t=e.match(li);if(!t)return 0;var i=t[1]==="+"?-1:1;var n=parseInt(t[2]);var r=t[3]&&parseInt(t[3])||0;if(!_i(n,r)){return NaN}return i*(n*ni+r*ri)}function gi(e,t,i){var n=new Date(0);n.setUTCFullYear(e,0,4);var r=n.getUTCDay()||7;var s=(t-1)*7+i+1-r;n.setUTCDate(n.getUTCDate()+s);return n}var mi=[31,null,31,30,31,30,31,31,30,31,30,31];function vi(e){return e%400===0||e%4===0&&e%100}function yi(e,t,i){return t>=0&&t<=11&&i>=1&&i<=(mi[t]||(vi(e)?29:28))}function bi(e,t){return t>=1&&t<=(vi(e)?366:365)}function Ci(e,t,i){return t>=1&&t<=53&&i>=0&&i<=6}function wi(e,t,i){if(e===24){return t===0&&i===0}return i>=0&&i<60&&t>=0&&t<60&&e>=0&&e<25}function _i(e,t){return t>=0&&t<=59}const Ai={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};N._adapters._date.override({_id:"date-fns",formats:function(){return Ai},parse:function(e,t){if(e===null||typeof e==="undefined"){return null}const i=typeof e;if(i==="number"||e instanceof Date){e=k(e)}else if(i==="string"){if(typeof t==="string"){e=Qt(e,t,new Date,this.options)}else{e=ci(e,this.options)}}return v(e)?e.getTime():null},format:function(e,t){return Dt(e,t,this.options)},add:function(e,t,i){switch(i){case"millisecond":return n(e,t);case"second":return z(e,t);case"minute":return V(e,t);case"hour":return G(e,t);case"day":return r(e,t);case"week":return j(e,t);case"month":return s(e,t);case"quarter":return W(e,t);case"year":return U(e,t);default:return e}},diff:function(e,t,i){switch(i){case"millisecond":return u(e,t);case"second":return se(e,t);case"minute":return J(e,t);case"hour":return Q(e,t);case"day":return K(e,t);case"week":return oe(e,t);case"month":return ne(e,t);case"quarter":return re(e,t);case"year":return ae(e,t);default:return 0}},startOf:function(e,t,i){switch(t){case"second":return ii(e);case"minute":return ti(e);case"hour":return ei(e);case"day":return a(e);case"week":return o(e);case"isoWeek":return o(e,{weekStartsOn:+i});case"month":return ce(e);case"quarter":return le(e);case"year":return ue(e);default:return e}},endOf:function(e,t){switch(t){case"second":return me(e);case"minute":return fe(e);case"hour":return he(e);case"day":return ee(e);case"week":return pe(e);case"month":return te(e);case"quarter":return ge(e);case"year":return de(e);default:return e}}})});(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t(require("chart.js"),require("hammerjs"),require("chart.js/helpers")):typeof define==="function"&&define.amd?define(["chart.js","hammerjs","chart.js/helpers"],t):(e=typeof globalThis!=="undefined"?globalThis:e||self,e.ChartZoom=t(e.Chart,e.Hammer,e.Chart.helpers))})(this,function(t,F,m){"use strict";function G(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}var a=G(F);const l=e=>e&&e.enabled&&e.modifierKey;const c=(e,t)=>e&&t[e+"Key"];const u=(e,t)=>e&&!t[e+"Key"];function v(e,t,i){if(e===undefined){return true}else if(typeof e==="string"){return e.indexOf(t)!==-1}else if(typeof e==="function"){return e({chart:i}).indexOf(t)!==-1}return false}function h(e,t){if(typeof e==="function"){e=e({chart:t})}if(typeof e==="string"){return{x:e.indexOf("x")!==-1,y:e.indexOf("y")!==-1}}return{x:false,y:false}}function $(e,t){let i;return function(){clearTimeout(i);i=setTimeout(e,t);return t}}function H({x:t,y:i},e){const n=e.scales;const r=Object.keys(n);for(let e=0;e<r.length;e++){const s=n[r[e]];if(i>=s.top&&i<=s.bottom&&t>=s.left&&t<=s.right){return s}}return null}function p(e,t,i){const{mode:n="xy",scaleMode:r,overScaleMode:s}=e||{};const o=H(t,i);const a=h(n,i);const l=h(r,i);if(s){const u=h(s,i);for(const d of["x","y"]){if(u[d]){l[d]=a[d];a[d]=false}}}if(o&&l[o.axis]){return[o]}const c=[];m.each(i.scales,function(e){if(a[e.axis]){c.push(e)}});return c}const i=new WeakMap;function g(e){let t=i.get(e);if(!t){t={originalScaleLimits:{},updatedScaleLimits:{},handlers:{},panDelta:{}};i.set(e,t)}return t}function B(e){i.delete(e)}function o(e,t,i){const n=e.max-e.min;const r=n*(t-1);const s=e.isHorizontal()?i.x:i.y;const o=Math.max(0,Math.min(1,(e.getValueForPixel(s)-e.min)/n||0));const a=1-o;return{min:r*o,max:r*a}}function y(e,t,i,n,r){let s=i[n];if(s==="original"){const o=e.originalScaleLimits[t.id][n];s=m.valueOrDefault(o.options,o.scale)}return m.valueOrDefault(s,r)}function V(e,t,i){const n=e.getValueForPixel(t);const r=e.getValueForPixel(i);return{min:Math.min(n,r),max:Math.max(n,r)}}function f(e,{min:t,max:i},n,r=false){const s=g(e.chart);const{id:o,axis:a,options:l}=e;const c=n&&(n[o]||n[a])||{};const{minRange:u=0}=c;const d=y(s,e,c,"min",-Infinity);const h=y(s,e,c,"max",Infinity);const p=r?Math.max(i-t,u):e.max-e.min;const f=(p-i+t)/2;t-=f;i+=f;if(t<d){t=d;i=Math.min(d+p,h)}else if(i>h){i=h;t=Math.max(h-p,d)}l.min=t;l.max=i;s.updatedScaleLimits[e.id]={min:t,max:i};return e.parse(t)!==e.min||e.parse(i)!==e.max}function W(e,t,i,n){const r=o(e,t,i);const s={min:e.min+r.min,max:e.max-r.max};return f(e,s,n,true)}function z(e,t,i,n){f(e,V(e,t,i),n,true)}const d=e=>e===0||isNaN(e)?0:e<0?Math.min(Math.round(e),-1):Math.max(Math.round(e),1);function j(e){const t=e.getLabels();const i=t.length-1;if(e.min>0){e.min-=1}if(e.max<i){e.max+=1}}function U(e,t,i,n){const r=o(e,t,i);if(e.min===e.max&&t<1){j(e)}const s={min:e.min+d(r.min),max:e.max-d(r.max)};return f(e,s,n,true)}function Y(e){return e.isHorizontal()?e.width:e.height}function q(e,t,i){const n=e.getLabels();const r=n.length-1;let{min:s,max:o}=e;const a=Math.max(o-s,1);const l=Math.round(Y(e)/Math.max(a,10));const c=Math.round(Math.abs(t/l));let u;if(t<-l){o=Math.min(o+c,r);s=a===1?o:o-a;u=o===r}else if(t>l){s=Math.max(0,s-c);o=a===1?s:s+a;u=s===0}return f(e,{min:s,max:o},i)||u}const K={second:500,minute:30*1e3,hour:30*60*1e3,day:12*60*60*1e3,week:3.5*24*60*60*1e3,month:15*24*60*60*1e3,quarter:60*24*60*60*1e3,year:182*24*60*60*1e3};function n(e,t,i,n=false){const{min:r,max:s,options:o}=e;const a=o.time&&o.time.round;const l=K[a]||0;const c=e.getValueForPixel(e.getPixelForValue(r+l)-t);const u=e.getValueForPixel(e.getPixelForValue(s+l)-t);const{min:d=-Infinity,max:h=Infinity}=n&&i&&i[e.axis]||{};if(isNaN(c)||isNaN(u)||c<d||u>h){return true}return f(e,{min:c,max:u},i,n)}function e(e,t,i){return n(e,t,i,true)}const s={category:U,default:W};const b={default:z};const C={category:q,default:n,logarithmic:e,timeseries:e};function X(e,t,i){const{id:n,options:{min:r,max:s}}=e;if(!t[n]||!i[n]){return true}const o=i[n];return o.min!==r||o.max!==s}function w(i,n){m.each(i,(e,t)=>{if(!n[t]){delete i[t]}})}function _(e,t){const{scales:i}=e;const{originalScaleLimits:n,updatedScaleLimits:r}=t;m.each(i,function(e){if(X(e,n,r)){n[e.id]={min:{scale:e.min,options:e.options.min},max:{scale:e.max,options:e.options.max}}}});w(n,i);w(r,i);return n}function A(e,t,i,n){const r=s[e.type]||s.default;m.callback(r,[e,t,i,n])}function E(e,t,i,n,r){const s=b[e.type]||b.default;m.callback(s,[e,t,i,n,r])}function Q(e){const t=e.chartArea;return{x:(t.left+t.right)/2,y:(t.top+t.bottom)/2}}function S(e,t,i="none"){const{x:n=1,y:r=1,focalPoint:s=Q(e)}=typeof t==="number"?{x:t,y:t}:t;const o=g(e);const{options:{limits:a,zoom:l}}=o;_(e,o);const c=n!==1;const u=r!==1;const d=p(l,s,e);m.each(d||e.scales,function(e){if(e.isHorizontal()&&c){A(e,n,s,a)}else if(!e.isHorizontal()&&u){A(e,r,s,a)}});e.update(i);m.callback(l.onZoom,[{chart:e}])}function T(e,t,i,n="none"){const r=g(e);const{options:{limits:s,zoom:o}}=r;const{mode:a="xy"}=o;_(e,r);const l=v(a,"x",e);const c=v(a,"y",e);m.each(e.scales,function(e){if(e.isHorizontal()&&l){E(e,t.x,i.x,s)}else if(!e.isHorizontal()&&c){E(e,t.y,i.y,s)}});e.update(n);m.callback(o.onZoom,[{chart:e}])}function Z(e,t,i,n="none"){_(e,g(e));const r=e.scales[t];f(r,i,undefined,true);e.update(n)}function J(e,t="default"){const i=g(e);const n=_(e,i);m.each(e.scales,function(e){const t=e.options;if(n[e.id]){t.min=n[e.id].min.options;t.max=n[e.id].max.options}else{delete t.min;delete t.max}});e.update(t);m.callback(i.options.zoom.onZoomComplete,[{chart:e}])}function ee(e,t){const i=e.originalScaleLimits[t];if(!i){return}const{min:n,max:r}=i;return m.valueOrDefault(r.options,r.scale)-m.valueOrDefault(n.options,n.scale)}function te(e){const n=g(e);let r=1;let s=1;m.each(e.scales,function(e){const t=ee(n,e.id);if(t){const i=Math.round(t/(e.max-e.min)*100)/100;r=Math.min(r,i);s=Math.max(s,i)}});return r<1?r:s}function x(e,t,i,n){const{panDelta:r}=n;const s=r[e.id]||0;if(m.sign(s)===m.sign(t)){t+=s}const o=C[e.type]||C.default;if(m.callback(o,[e,t,i])){r[e.id]=0}else{r[e.id]=t}}function r(e,t,i,n="none"){const{x:r=0,y:s=0}=typeof t==="number"?{x:t,y:t}:t;const o=g(e);const{options:{pan:a,limits:l}}=o;const{onPan:c}=a||{};_(e,o);const u=r!==0;const d=s!==0;m.each(i||e.scales,function(e){if(e.isHorizontal()&&u){x(e,r,l,o)}else if(!e.isHorizontal()&&d){x(e,s,l,o)}});e.update(n);m.callback(c,[{chart:e}])}function D(e){const t=g(e);_(e,t);const i={};for(const n of Object.keys(e.scales)){const{min:r,max:s}=t.originalScaleLimits[n]||{min:{},max:{}};i[n]={min:r.scale,max:s.scale}}return i}function ie(e){const t=D(e);for(const i of Object.keys(e.scales)){const{min:n,max:r}=t[i];if(n!==undefined&&e.scales[i].min!==n){return true}if(r!==undefined&&e.scales[i].max!==r){return true}}return false}function R(e,t){const{handlers:i}=g(e);const n=i[t];if(n&&n.target){n.target.removeEventListener(t,n);delete i[t]}}function M(t,e,i,n){const{handlers:r,options:s}=g(t);const o=r[i];if(o&&o.target===e){return}R(t,i);r[i]=e=>n(t,e,s);r[i].target=e;e.addEventListener(i,r[i])}function ne(e,t){const i=g(e);if(i.dragStart){i.dragging=true;i.dragEnd=t;e.update("none")}}function re(e,t){const i=g(e);if(!i.dragStart||t.key!=="Escape"){return}R(e,"keydown");i.dragging=false;i.dragStart=i.dragEnd=null;e.update("none")}function N(e,t,i){const{onZoomStart:n,onZoomRejected:r}=i;if(n){const s=m.getRelativePosition(t,e);if(m.callback(n,[{chart:e,event:t,point:s}])===false){m.callback(r,[{chart:e,event:t}]);return false}}}function se(e,t){const i=g(e);const{pan:n,zoom:r={}}=i.options;if(t.button!==0||c(l(n),t)||u(l(r.drag),t)){return m.callback(r.onZoomRejected,[{chart:e,event:t}])}if(N(e,t,r)===false){return}i.dragStart=t;M(e,e.canvas,"mousemove",ne);M(e,window.document,"keydown",re)}function O(e,t,i,n){const r=v(t,"x",e);const s=v(t,"y",e);let{top:o,left:a,right:l,bottom:c,width:u,height:d}=e.chartArea;const h=m.getRelativePosition(i,e);const p=m.getRelativePosition(n,e);if(r){a=Math.min(h.x,p.x);l=Math.max(h.x,p.x)}if(s){o=Math.min(h.y,p.y);c=Math.max(h.y,p.y)}const f=l-a;const g=c-o;return{left:a,top:o,right:l,bottom:c,width:f,height:g,zoomX:r&&f?1+(u-f)/u:1,zoomY:s&&g?1+(d-g)/d:1}}function oe(e,t){const i=g(e);if(!i.dragStart){return}R(e,"mousemove");const{mode:n,onZoomComplete:r,drag:{threshold:s=0}}=i.options.zoom;const o=O(e,n,i.dragStart,t);const a=v(n,"x",e)?o.width:0;const l=v(n,"y",e)?o.height:0;const c=Math.sqrt(a*a+l*l);i.dragStart=i.dragEnd=null;if(c<=s){i.dragging=false;e.update("none");return}T(e,{x:o.left,y:o.top},{x:o.right,y:o.bottom},"zoom");setTimeout(()=>i.dragging=false,500);m.callback(r,[{chart:e}])}function ae(e,t,i){if(u(l(i.wheel),t)){m.callback(i.onZoomRejected,[{chart:e,event:t}]);return}if(N(e,t,i)===false){return}if(t.cancelable){t.preventDefault()}if(t.deltaY===undefined){return}return true}function le(e,t){const{handlers:{onZoomComplete:i},options:{zoom:n}}=g(e);if(!ae(e,t,n)){return}const r=t.target.getBoundingClientRect();const s=1+(t.deltaY>=0?-n.wheel.speed:n.wheel.speed);const o={x:s,y:s,focalPoint:{x:t.clientX-r.left,y:t.clientY-r.top}};S(e,o);if(i){i()}}function ce(e,t,i,n){if(i){g(e).handlers[t]=$(()=>m.callback(i,[{chart:e}]),n)}}function ue(e,t){const i=e.canvas;const{wheel:n,drag:r,onZoomComplete:s}=t.zoom;if(n.enabled){M(e,i,"wheel",le);ce(e,"onZoomComplete",s,250)}else{R(e,"wheel")}if(r.enabled){M(e,i,"mousedown",se);M(e,i.ownerDocument,"mouseup",oe)}else{R(e,"mousedown");R(e,"mousemove");R(e,"mouseup");R(e,"keydown")}}function de(e){R(e,"mousedown");R(e,"mousemove");R(e,"mouseup");R(e,"wheel");R(e,"click");R(e,"keydown")}function he(s,o){return function(e,t){const{pan:i,zoom:n={}}=o.options;if(!i||!i.enabled){return false}const r=t&&t.srcEvent;if(!r){return true}if(!o.panning&&t.pointerType==="mouse"&&(u(l(i),r)||c(l(n.drag),r))){m.callback(i.onPanRejected,[{chart:s,event:t}]);return false}return true}}function pe(e,t){const i=Math.abs(e.clientX-t.clientX);const n=Math.abs(e.clientY-t.clientY);const r=i/n;let s,o;if(r>.3&&r<1.7){s=o=true}else if(i>n){s=true}else{o=true}return{x:s,y:o}}function I(e,t,i){if(t.scale){const{center:n,pointers:r}=i;const s=1/t.scale*i.scale;const o=i.target.getBoundingClientRect();const a=pe(r[0],r[1]);const l=t.options.zoom.mode;const c={x:a.x&&v(l,"x",e)?s:1,y:a.y&&v(l,"y",e)?s:1,focalPoint:{x:n.x-o.left,y:n.y-o.top}};S(e,c);t.scale=i.scale}}function fe(e,t){if(t.options.zoom.pinch.enabled){t.scale=1}}function ge(e,t,i){if(t.scale){I(e,t,i);t.scale=null;m.callback(t.options.zoom.onZoomComplete,[{chart:e}])}}function P(e,t,i){const n=t.delta;if(n){t.panning=true;r(e,{x:i.deltaX-n.x,y:i.deltaY-n.y},t.panScales);t.delta={x:i.deltaX,y:i.deltaY}}}function me(e,t,i){const{enabled:n,onPanStart:r,onPanRejected:s}=t.options.pan;if(!n){return}const o=i.target.getBoundingClientRect();const a={x:i.center.x-o.left,y:i.center.y-o.top};if(m.callback(r,[{chart:e,event:i,point:a}])===false){return m.callback(s,[{chart:e,event:i}])}t.panScales=p(t.options.pan,a,e);t.delta={x:0,y:0};clearTimeout(t.panEndTimeout);P(e,t,i)}function ve(e,t){t.delta=null;if(t.panning){t.panEndTimeout=setTimeout(()=>t.panning=false,500);m.callback(t.options.pan.onPanComplete,[{chart:e}])}}const k=new WeakMap;function ye(t,e){const i=g(t);const n=t.canvas;const{pan:r,zoom:s}=e;const o=new a["default"].Manager(n);if(s&&s.pinch.enabled){o.add(new a["default"].Pinch);o.on("pinchstart",()=>fe(t,i));o.on("pinch",e=>I(t,i,e));o.on("pinchend",e=>ge(t,i,e))}if(r&&r.enabled){o.add(new a["default"].Pan({threshold:r.threshold,enable:he(t,i)}));o.on("panstart",e=>me(t,i,e));o.on("panmove",e=>P(t,i,e));o.on("panend",()=>ve(t,i))}k.set(t,o)}function be(e){const t=k.get(e);if(t){t.remove("pinchstart");t.remove("pinch");t.remove("pinchend");t.remove("panstart");t.remove("pan");t.remove("panend");t.destroy();k.delete(e)}}var Ce="2.0.1";function L(e,t,i){const n=i.zoom.drag;const{dragStart:r,dragEnd:s}=g(e);if(n.drawTime!==t||!s){return}const{left:o,top:a,width:l,height:c}=O(e,i.zoom.mode,r,s);const u=e.ctx;u.save();u.beginPath();u.fillStyle=n.backgroundColor||"rgba(225,225,225,0.3)";u.fillRect(o,a,l,c);if(n.borderWidth>0){u.lineWidth=n.borderWidth;u.strokeStyle=n.borderColor||"rgba(225,225,225)";u.strokeRect(o,a,l,c)}u.restore()}var we={id:"zoom",version:Ce,defaults:{pan:{enabled:false,mode:"xy",threshold:10,modifierKey:null},zoom:{wheel:{enabled:false,speed:.1,modifierKey:null},drag:{enabled:false,drawTime:"beforeDatasetsDraw",modifierKey:null},pinch:{enabled:false},mode:"xy"}},start:function(n,e,t){const i=g(n);i.options=t;if(Object.prototype.hasOwnProperty.call(t.zoom,"enabled")){console.warn("The option `zoom.enabled` is no longer supported. Please use `zoom.wheel.enabled`, `zoom.drag.enabled`, or `zoom.pinch.enabled`.")}if(Object.prototype.hasOwnProperty.call(t.zoom,"overScaleMode")||Object.prototype.hasOwnProperty.call(t.pan,"overScaleMode")){console.warn("The option `overScaleMode` is deprecated. Please use `scaleMode` instead (and update `mode` as desired).")}if(a["default"]){ye(n,t)}n.pan=(e,t,i)=>r(n,e,t,i);n.zoom=(e,t)=>S(n,e,t);n.zoomRect=(e,t,i)=>T(n,e,t,i);n.zoomScale=(e,t,i)=>Z(n,e,t,i);n.resetZoom=e=>J(n,e);n.getZoomLevel=()=>te(n);n.getInitialScaleBounds=()=>D(n);n.isZoomedOrPanned=()=>ie(n)},beforeEvent(e){const t=g(e);if(t.panning||t.dragging){return false}},beforeUpdate:function(e,t,i){const n=g(e);n.options=i;ue(e,i)},beforeDatasetsDraw(e,t,i){L(e,"beforeDatasetsDraw",i)},afterDatasetsDraw(e,t,i){L(e,"afterDatasetsDraw",i)},beforeDraw(e,t,i){L(e,"beforeDraw",i)},afterDraw(e,t,i){L(e,"afterDraw",i)},stop:function(e){de(e);if(a["default"]){be(e)}B(e)},panFunctions:C,zoomFunctions:s,zoomRectFunctions:b};t.Chart.register(we);return we});(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t(require("chart.js/helpers"),require("chart.js")):typeof define==="function"&&define.amd?define(["chart.js/helpers","chart.js"],t):(e=typeof globalThis!=="undefined"?globalThis:e||self,e.ChartDataLabels=t(e.Chart.helpers,e.Chart))})(this,function(b,l){"use strict";var t=function(){if(typeof window!=="undefined"){if(window.devicePixelRatio){return window.devicePixelRatio}var e=window.screen;if(e){return(e.deviceXDPI||1)/(e.logicalXDPI||1)}}return 1}();var h={toTextLines:function(e){var t=[];var i;e=[].concat(e);while(e.length){i=e.pop();if(typeof i==="string"){t.unshift.apply(t,i.split("\n"))}else if(Array.isArray(i)){e.push.apply(e,i)}else if(!b.isNullOrUndef(e)){t.unshift(""+i)}}return t},textSize:function(e,t,i){var n=[].concat(t);var r=n.length;var s=e.font;var o=0;var a;e.font=i.string;for(a=0;a<r;++a){o=Math.max(e.measureText(n[a]).width,o)}e.font=s;return{height:r*i.lineHeight,width:o}},bound:function(e,t,i){return Math.max(e,Math.min(t,i))},arrayDiff:function(e,t){var i=e.slice();var n=[];var r,s,o,a;for(r=0,o=t.length;r<o;++r){a=t[r];s=i.indexOf(a);if(s===-1){n.push([a,1])}else{i.splice(s,1)}}for(r=0,o=i.length;r<o;++r){n.push([i[r],-1])}return n},rasterize:function(e){return Math.round(e*t)/t}};function a(e,t){var i=t.x;var n=t.y;if(i===null){return{x:0,y:-1}}if(n===null){return{x:1,y:0}}var r=e.x-i;var s=e.y-n;var o=Math.sqrt(r*r+s*s);return{x:o?r/o:0,y:o?s/o:-1}}function o(e,t,i,n,r){switch(r){case"center":i=n=0;break;case"bottom":i=0;n=1;break;case"right":i=1;n=0;break;case"left":i=-1;n=0;break;case"top":i=0;n=-1;break;case"start":i=-i;n=-n;break;case"end":break;default:r*=Math.PI/180;i=Math.cos(r);n=Math.sin(r);break}return{x:e,y:t,vx:i,vy:n}}var r=0;var d=1;var p=2;var f=4;var g=8;function m(e,t,i){var n=r;if(e<i.left){n|=d}else if(e>i.right){n|=p}if(t<i.top){n|=g}else if(t>i.bottom){n|=f}return n}function c(e,t){var i=e.x0;var n=e.y0;var r=e.x1;var s=e.y1;var o=m(i,n,t);var a=m(r,s,t);var l,c,u;while(true){if(!(o|a)||o&a){break}l=o||a;if(l&g){c=i+(r-i)*(t.top-n)/(s-n);u=t.top}else if(l&f){c=i+(r-i)*(t.bottom-n)/(s-n);u=t.bottom}else if(l&p){u=n+(s-n)*(t.right-i)/(r-i);c=t.right}else if(l&d){u=n+(s-n)*(t.left-i)/(r-i);c=t.left}if(l===o){i=c;n=u;o=m(i,n,t)}else{r=c;s=u;a=m(r,s,t)}}return{x0:i,x1:r,y0:n,y1:s}}function u(e,t){var i=t.anchor;var n=e;var r,s;if(t.clamp){n=c(n,t.area)}if(i==="start"){r=n.x0;s=n.y0}else if(i==="end"){r=n.x1;s=n.y1}else{r=(n.x0+n.x1)/2;s=(n.y0+n.y1)/2}return o(r,s,e.vx,e.vy,t.align)}var i={arc:function(e,t){var i=(e.startAngle+e.endAngle)/2;var n=Math.cos(i);var r=Math.sin(i);var s=e.innerRadius;var o=e.outerRadius;return u({x0:e.x+n*s,y0:e.y+r*s,x1:e.x+n*o,y1:e.y+r*o,vx:n,vy:r},t)},point:function(e,t){var i=a(e,t.origin);var n=i.x*e.options.radius;var r=i.y*e.options.radius;return u({x0:e.x-n,y0:e.y-r,x1:e.x+n,y1:e.y+r,vx:i.x,vy:i.y},t)},bar:function(e,t){var i=a(e,t.origin);var n=e.x;var r=e.y;var s=0;var o=0;if(e.horizontal){n=Math.min(e.x,e.base);s=Math.abs(e.base-e.x)}else{r=Math.min(e.y,e.base);o=Math.abs(e.base-e.y)}return u({x0:n,y0:r+o,x1:n+s,y1:r,vx:i.x,vy:i.y},t)},fallback:function(e,t){var i=a(e,t.origin);return u({x0:e.x,y0:e.y,x1:e.x+(e.width||0),y1:e.y+(e.height||0),vx:i.x,vy:i.y},t)}};var v=h.rasterize;function y(e){var t=e.borderWidth||0;var i=e.padding;var n=e.size.height;var r=e.size.width;var s=-r/2;var o=-n/2;return{frame:{x:s-i.left-t,y:o-i.top-t,w:r+i.width+t*2,h:n+i.height+t*2},text:{x:s,y:o,w:r,h:n}}}function C(e,t){var i=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!i){return null}if(i.xCenter!==undefined&&i.yCenter!==undefined){return{x:i.xCenter,y:i.yCenter}}var n=i.getBasePixel();return e.horizontal?{x:n,y:null}:{x:null,y:n}}function w(e){if(e instanceof l.ArcElement){return i.arc}if(e instanceof l.PointElement){return i.point}if(e instanceof l.BarElement){return i.bar}return i.fallback}function _(e,t,i,n,r,s){var o=Math.PI/2;if(s){var a=Math.min(s,r/2,n/2);var l=t+a;var c=i+a;var u=t+n-a;var d=i+r-a;e.moveTo(t,c);if(l<u&&c<d){e.arc(l,c,a,-Math.PI,-o);e.arc(u,c,a,-o,0);e.arc(u,d,a,0,o);e.arc(l,d,a,o,Math.PI)}else if(l<u){e.moveTo(l,i);e.arc(u,c,a,-o,o);e.arc(l,c,a,o,Math.PI+o)}else if(c<d){e.arc(l,c,a,-Math.PI,0);e.arc(l,d,a,0,Math.PI)}else{e.arc(l,c,a,-Math.PI,Math.PI)}e.closePath();e.moveTo(t,i)}else{e.rect(t,i,n,r)}}function A(e,t,i){var n=i.backgroundColor;var r=i.borderColor;var s=i.borderWidth;if(!n&&(!r||!s)){return}e.beginPath();_(e,v(t.x)+s/2,v(t.y)+s/2,v(t.w)-s,v(t.h)-s,i.borderRadius);e.closePath();if(n){e.fillStyle=n;e.fill()}if(r&&s){e.strokeStyle=r;e.lineWidth=s;e.lineJoin="miter";e.stroke()}}function E(e,t,i){var n=i.lineHeight;var r=e.w;var s=e.x;var o=e.y+n/2;if(t==="center"){s+=r/2}else if(t==="end"||t==="right"){s+=r}return{h:n,w:r,x:s,y:o}}function S(e,t,i){var n=e.shadowBlur;var r=i.stroked;var s=v(i.x);var o=v(i.y);var a=v(i.w);if(r){e.strokeText(t,s,o,a)}if(i.filled){if(n&&r){e.shadowBlur=0}e.fillText(t,s,o,a);if(n&&r){e.shadowBlur=n}}}function T(e,t,i,n){var r=n.textAlign;var s=n.color;var o=!!s;var a=n.font;var l=t.length;var c=n.textStrokeColor;var u=n.textStrokeWidth;var d=c&&u;var h;if(!l||!o&&!d){return}i=E(i,r,a);e.font=a.string;e.textAlign=r;e.textBaseline="middle";e.shadowBlur=n.textShadowBlur;e.shadowColor=n.textShadowColor;if(o){e.fillStyle=s}if(d){e.lineJoin="round";e.lineWidth=u;e.strokeStyle=c}for(h=0,l=t.length;h<l;++h){S(e,t[h],{stroked:d,filled:o,w:i.w,x:i.x,y:i.y+i.h*h})}}var x=function(e,t,i,n){var r=this;r._config=e;r._index=n;r._model=null;r._rects=null;r._ctx=t;r._el=i};b.merge(x.prototype,{_modelize:function(e,t,i,n){var r=this;var s=r._index;var o=b.toFont(b.resolve([i.font,{}],n,s));var a=b.resolve([i.color,l.defaults.color],n,s);return{align:b.resolve([i.align,"center"],n,s),anchor:b.resolve([i.anchor,"center"],n,s),area:n.chart.chartArea,backgroundColor:b.resolve([i.backgroundColor,null],n,s),borderColor:b.resolve([i.borderColor,null],n,s),borderRadius:b.resolve([i.borderRadius,0],n,s),borderWidth:b.resolve([i.borderWidth,0],n,s),clamp:b.resolve([i.clamp,false],n,s),clip:b.resolve([i.clip,false],n,s),color:a,display:e,font:o,lines:t,offset:b.resolve([i.offset,4],n,s),opacity:b.resolve([i.opacity,1],n,s),origin:C(r._el,n),padding:b.toPadding(b.resolve([i.padding,4],n,s)),positioner:w(r._el),rotation:b.resolve([i.rotation,0],n,s)*(Math.PI/180),size:h.textSize(r._ctx,t,o),textAlign:b.resolve([i.textAlign,"start"],n,s),textShadowBlur:b.resolve([i.textShadowBlur,0],n,s),textShadowColor:b.resolve([i.textShadowColor,a],n,s),textStrokeColor:b.resolve([i.textStrokeColor,a],n,s),textStrokeWidth:b.resolve([i.textStrokeWidth,0],n,s)}},update:function(e){var t=this;var i=null;var n=null;var r=t._index;var s=t._config;var o,a,l;var c=b.resolve([s.display,true],e,r);if(c){o=e.dataset.data[r];a=b.valueOrDefault(b.callback(s.formatter,[o,e]),o);l=b.isNullOrUndef(a)?[]:h.toTextLines(a);if(l.length){i=t._modelize(c,l,s,e);n=y(i)}}t._model=i;t._rects=n},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(e,t){var i=this;var n=e.ctx;var r=i._model;var s=i._rects;var o;if(!this.visible()){return}n.save();if(r.clip){o=r.area;n.beginPath();n.rect(o.left,o.top,o.right-o.left,o.bottom-o.top);n.clip()}n.globalAlpha=h.bound(0,r.opacity,1);n.translate(v(t.x),v(t.y));n.rotate(r.rotation);A(n,s.frame,r);T(n,r.lines,s.text,r);n.restore()}});var D=Number.MIN_SAFE_INTEGER||-9007199254740991;var R=Number.MAX_SAFE_INTEGER||9007199254740991;function s(e,t,i){var n=Math.cos(i);var r=Math.sin(i);var s=t.x;var o=t.y;return{x:s+n*(e.x-s)-r*(e.y-o),y:o+r*(e.x-s)+n*(e.y-o)}}function M(e,t){var i=R;var n=D;var r=t.origin;var s,o,a,l,c;for(s=0;s<e.length;++s){o=e[s];a=o.x-r.x;l=o.y-r.y;c=t.vx*a+t.vy*l;i=Math.min(i,c);n=Math.max(n,c)}return{min:i,max:n}}function N(e,t){var i=t.x-e.x;var n=t.y-e.y;var r=Math.sqrt(i*i+n*n);return{vx:(t.x-e.x)/r,vy:(t.y-e.y)/r,origin:e,ln:r}}var O=function(){this._rotation=0;this._rect={x:0,y:0,w:0,h:0}};b.merge(O.prototype,{center:function(){var e=this._rect;return{x:e.x+e.w/2,y:e.y+e.h/2}},update:function(e,t,i){this._rotation=i;this._rect={x:t.x+e.x,y:t.y+e.y,w:t.w,h:t.h}},contains:function(e){var t=this;var i=1;var n=t._rect;e=s(e,t.center(),-t._rotation);return!(e.x<n.x-i||e.y<n.y-i||e.x>n.x+n.w+i*2||e.y>n.y+n.h+i*2)},intersects:function(e){var t=this._points();var i=e._points();var n=[N(t[0],t[1]),N(t[0],t[3])];var r,s,o;if(this._rotation!==e._rotation){n.push(N(i[0],i[1]),N(i[0],i[3]))}for(r=0;r<n.length;++r){s=M(t,n[r]);o=M(i,n[r]);if(s.max<o.min||o.max<s.min){return false}}return true},_points:function(){var e=this;var t=e._rect;var i=e._rotation;var n=e.center();return[s({x:t.x,y:t.y},n,i),s({x:t.x+t.w,y:t.y},n,i),s({x:t.x+t.w,y:t.y+t.h},n,i),s({x:t.x,y:t.y+t.h},n,i)]}});function I(e,t,i){var n=t.positioner(e,t);var r=n.vx;var s=n.vy;if(!r&&!s){return{x:n.x,y:n.y}}var o=i.w;var a=i.h;var l=t.rotation;var c=Math.abs(o/2*Math.cos(l))+Math.abs(a/2*Math.sin(l));var u=Math.abs(o/2*Math.sin(l))+Math.abs(a/2*Math.cos(l));var d=1/Math.max(Math.abs(r),Math.abs(s));c*=r*d;u*=s*d;c+=t.offset*r;u+=t.offset*s;return{x:n.x+c,y:n.y+u}}function G(e,t){var i,n,r,s;for(i=e.length-1;i>=0;--i){r=e[i].$layout;for(n=i-1;n>=0&&r._visible;--n){s=e[n].$layout;if(s._visible&&r._box.intersects(s._box)){t(r,s)}}}return e}function $(e){var t,i,n,r,s,o,a;for(t=0,i=e.length;t<i;++t){n=e[t];r=n.$layout;if(r._visible){a=new Proxy(n._el,{get:(e,t)=>e.getProps([t],true)[t]});s=n.geometry();o=I(a,n.model(),s);r._box.update(o,s,n.rotation())}}return G(e,function(e,t){var i=e._hidable;var n=t._hidable;if(i&&n||n){t._visible=false}else if(i){e._visible=false}})}var P={prepare:function(e){var t=[];var i,n,r,s,o;for(i=0,r=e.length;i<r;++i){for(n=0,s=e[i].length;n<s;++n){o=e[i][n];t.push(o);o.$layout={_box:new O,_hidable:false,_visible:true,_set:i,_idx:o._index}}}t.sort(function(e,t){var i=e.$layout;var n=t.$layout;return i._idx===n._idx?n._set-i._set:n._idx-i._idx});this.update(t);return t},update:function(e){var t=false;var i,n,r,s,o;for(i=0,n=e.length;i<n;++i){r=e[i];s=r.model();o=r.$layout;o._hidable=s&&s.display==="auto";o._visible=r.visible();t|=o._hidable}if(t){$(e)}},lookup:function(e,t){var i,n;for(i=e.length-1;i>=0;--i){n=e[i].$layout;if(n&&n._visible&&n._box.contains(t)){return e[i]}}return null},draw:function(e,t){var i,n,r,s,o,a;for(i=0,n=t.length;i<n;++i){r=t[i];s=r.$layout;if(s._visible){o=r.geometry();a=I(r._el,r.model(),o);s._box.update(a,o,r.rotation());r.draw(e,a)}}}};var e=function(e){if(b.isNullOrUndef(e)){return null}var t=e;var i,n,r;if(b.isObject(e)){if(!b.isNullOrUndef(e.label)){t=e.label}else if(!b.isNullOrUndef(e.r)){t=e.r}else{t="";i=Object.keys(e);for(r=0,n=i.length;r<n;++r){t+=(r!==0?", ":"")+i[r]+": "+e[i[r]]}}}return""+t};var n={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:false,clip:false,color:undefined,display:true,font:{family:undefined,lineHeight:1.2,size:undefined,style:undefined,weight:null},formatter:e,labels:undefined,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:undefined,textStrokeWidth:0,textShadowBlur:0,textShadowColor:undefined};var k="$datalabels";var L="$default";function H(e,t){var i=e.datalabels;var n={};var r=[];var s,o;if(i===false){return null}if(i===true){i={}}t=b.merge({},[t,i]);s=t.labels||{};o=Object.keys(s);delete t.labels;if(o.length){o.forEach(function(e){if(s[e]){r.push(b.merge({},[t,s[e],{_key:e}]))}})}else{r.push(t)}n=r.reduce(function(i,n){b.each(n.listeners||{},function(e,t){i[t]=i[t]||{};i[t][n._key||L]=e});delete n.listeners;return i},{});return{labels:r,listeners:n}}function F(e,t,i,n){if(!t){return}var r=i.$context;var s=i.$groups;var o;if(!t[s._set]){return}o=t[s._set][s._key];if(!o){return}if(b.callback(o,[r,n])===true){e[k]._dirty=true;i.update(r)}}function B(e,t,i,n,r){var s,o;if(!i&&!n){return}if(!i){s=true}else if(!n){o=true}else if(i!==n){o=s=true}if(o){F(e,t.leave,i,r)}if(s){F(e,t.enter,n,r)}}function V(e,t){var i=e[k];var n=i._listeners;var r,s;if(!n.enter&&!n.leave){return}if(t.type==="mousemove"){s=P.lookup(i._labels,t)}else if(t.type!=="mouseout"){return}r=i._hovered;i._hovered=s;B(e,n,r,s,t)}function W(e,t){var i=e[k];var n=i._listeners.click;var r=n&&P.lookup(i._labels,t);if(r){F(e,n,r,t)}}var z={id:"datalabels",defaults:n,beforeInit:function(e){e[k]={_actives:[]}},beforeUpdate:function(e){var t=e[k];t._listened=false;t._listeners={};t._datasets=[];t._labels=[]},afterDatasetUpdate:function(e,n,t){var i=n.index;var r=e[k];var s=r._datasets[i]=[];var o=e.isDatasetVisible(i);var a=e.data.datasets[i];var l=H(a,t);var c=n.meta.data||[];var u=e.ctx;var d,h,p,f,g,m,v,y;u.save();for(d=0,p=c.length;d<p;++d){v=c[d];v[k]=[];if(o&&v&&e.getDataVisibility(d)&&!v.skip){for(h=0,f=l.labels.length;h<f;++h){g=l.labels[h];m=g._key;y=new x(g,u,v,d);y.$groups={_set:i,_key:m||L};y.$context={active:false,chart:e,dataIndex:d,dataset:a,datasetIndex:i};y.update(y.$context);v[k].push(y);s.push(y)}}}u.restore();b.merge(r._listeners,l.listeners,{merger:function(e,t,i){t[e]=t[e]||{};t[e][n.index]=i[e];r._listened=true}})},afterUpdate:function(e){e[k]._labels=P.prepare(e[k]._datasets)},afterDatasetsDraw:function(e){P.draw(e,e[k]._labels)},beforeEvent:function(e,t){if(e[k]._listened){var i=t.event;switch(i.type){case"mousemove":case"mouseout":V(e,i);break;case"click":W(e,i);break}}},afterEvent:function(e){var t=e[k];var i=t._actives;var n=t._actives=e.getActiveElements();var r=h.arrayDiff(i,n);var s,o,a,l,c,u,d;for(s=0,o=r.length;s<o;++s){c=r[s];if(c[1]){d=c[0].element[k]||[];for(a=0,l=d.length;a<l;++a){u=d[a];u.$context.active=c[1]===1;u.update(u.$context)}}}if(t._dirty||r.length){P.update(t._labels);e.render()}delete t._dirty}};return z});(function(e){e(["jquery","lodash"],function(j,U){return function(){const P=10;const k=parseInt(j("html").css("--popup-width"));const L=parseInt(j("html").css("--popup-width-mobile"));var F;var t;var G=0;var n={alert:"alert",info:"info",success:"success",warning:"warning"};const $=[n.success,n.warning,n.alert,n.info];var e={clear:l,remove:c,alert:i,getContainer:H,info:r,options:{},subscribe:a,success:s,version:"2.0.3",warning:o,warning_permanent:o};return e;function i(e,t,i){return f({type:n.alert,title:e,message:t,options:i})}function r(e,t,i){return f({type:n.info,title:e,message:t,options:i})}function s(e,t,i){return f({type:n.success,title:e,message:t,options:i})}function o(e,t,i){return f({type:n.warning,title:e,message:t,options:i})}function a(e){t=e}function H(e,t){if(!e){e=W()}F=j("#"+e.containerId);if(F.length){return F}if(t){F=h(e)}return F}function l(e){var t=W();if(!F){H(t)}if(!d(e,t)){u(t)}}function c(e){var t=W();if(!F){H(t)}if(e&&j(":focus",e).length===0){z(e,t.removeEmptyContainer);return}if(F.children().length){F.remove()}}function u(e){var t=F.children();for(var i=t.length-1;i>=0;i--){d(j(t[i]),e)}}function d(e,t){if(e&&j(":focus",e).length===0){e[t.hideMethod]({duration:t.hideDuration,easing:t.hideEasing,complete:function(){z(e,t.removeEmptyContainer)}});return true}return false}function h(e){F=j("<div/>").attr("id",e.containerId).addClass(e.positionClass).attr("aria-live","polite").attr("role","alert");F.appendTo(j(e.target));return F}function p(){return{tapToDismiss:false,toastClass:"popup",containerId:"popups",debug:false,showMethod:"fadeIn",showDuration:300,showEasing:"swing",onShown:undefined,hideMethod:"fadeOut",hideDuration:1e3,hideEasing:"swing",onHidden:undefined,extendedTimeOut:1e3,onCloseClick:undefined,positionClass:"popups-bottom-right",timeOut:5e3,titleClass:"headline",messageClass:"popup-content",tabsClass:"popup-tabs",tabClass:"popup-tab",arrowClass:"arrow",leftArrowClass:"arrow-left",rightArrowClass:"arrow-right",headerClass:"popup-header",activeTabClass:"active",hasTabsClass:"has-tabs",hasCarouselClass:"has-carousel",expandedClass:"expanded",closeIcon:"icon icon-times-circle",target:"body",newestOnTop:false,useTabs:true,removeEmptyContainer:true,collapse:true}}function B(e){if(!t){return}t(e)}function V(){return this._template||(this._template=`
                <div class="{{= toastClass }} {{= toastClass }}-{{= type }}">
                  <div class="{{= headerClass }} {{= tabsClass }}"></div>
                  <div class="{{= tabClass }} {{= arrowClass }} {{= leftArrowClass }} {{= activeTabClass }}">
                    <i class="icon icon-{{= leftArrowClass }}"></i>
                  </div>
                  <div class="{{= tabClass }} {{= arrowClass }} {{= rightArrowClass }} {{= activeTabClass }}">
                    <i class="icon icon-{{= rightArrowClass }}"></i>
                  </div>
                  
                  <div class="{{= headerClass }}">
                    <div class="d-flex">
                     {{ if (collapse) { }}
                        <i class="icon icon-caret-left me-2"></i>
                     {{ } }}
                     <i class="icon icon-state-{{= type }} popup-header-icon me-1"></i>
                    </div>
                    <span class="popup-header-title">{{= title }}</span>
                    <i class="js-close close-icon {{= closeIcon }} ms-auto"></i>
                  </div>
                  <div class="{{= messageClass }}" style="display: none;">{{= message }}</div>
                </div>`)}function f(e){var t=W(),r=j.extend(t,e);if(typeof e.options!=="undefined"){r=j.extend(r,e.options)}F=H(r,true);if(F.is("[data-popups-options]")){const I=AGN.Lib.Helpers.objFromString(F.data("popups-options"));r=U.extend(r,I)}const i=j(`.popup-${r.type}`);if(r.useTabs&&i.is(":visible")){_(i);return i}G++;var n=U.template(V())(r),s=j(n);var o=null,a=s,l=a.find(".js-close"),c=a.find(`.${r.rightArrowClass}`),u=a.find(`.${r.leftArrowClass}`).hide(),d=0,h={toastId:G,state:"visible",startTime:new Date,options:r};if(r.message){a.find("."+r.messageClass).show()}a.data("type",r.type);f(a);a[r.showMethod]({duration:r.showDuration,easing:r.showEasing,complete:r.onShown});if(r.timeOut>0){o=setTimeout(M,r.timeOut)}a.hover(O,N);if(!r.onclick&&r.tapToDismiss){a.click(M)}if(l){l.click(function(e){if(e.stopPropagation){e.stopPropagation()}else if(e.cancelBubble!==undefined&&e.cancelBubble!==true){e.cancelBubble=true}if(r.onCloseClick){r.onCloseClick(e)}if(a.hasClass(r.hasTabsClass)){y()}else{M(true)}})}if(r.onclick){a.click(function(){r.onclick();M()})}B(h);if(r.debug&&console){console.log(h)}u.click(()=>m());c.click(()=>v());if(r.collapse){a.find(`.${r.headerClass}:not(.${r.tabsClass})`).click(()=>{a.toggleClass(r.expandedClass,R(a));b(a)})}else{a.addClass(r.expandedClass)}_(a);return a;function p(){const n=$.indexOf(r.type);return F.find(`.${r.toastClass}`).filter((e,t)=>{const i=$.indexOf(j(t).data("type"));return n<i}).first()}function f(e){if(r.newestOnTop||!F.find(`.${r.toastClass}`).length){F.prepend(e);return}const t=p();if(t.exists()){e.insertBefore(t);return}F.append(e)}function g(e,t){const i=e.find(`.${r.tabsClass}`);i.css("transform",`translateX(${t}px)`);setTimeout(()=>T(e),300)}function m(e){d=d-1;const t=d*-D(a);g(a,t);if(!e){c.show()}if(d===0){u.hide()}}function v(){d=d+1;const e=d*D(a);g(a,e*-1);u.show();if(a.find(`.${r.tabsClass}`).width()-e<=a.width()){c.hide()}}function y(){const e=x(a).filter(`.${r.activeTabClass}`);const t=e.next();const i=t.length?t:e.prev();e.remove();if(u.is(":visible")){m(true)}w(a,i)}function b(e){let t=x(e);e.toggleClass(r.hasTabsClass,t.length>1);e.toggleClass(r.hasCarouselClass,t.length>P);const i=D(e);e.find(`.${r.tabClass}`).each((e,t)=>j(t).css("width",`${i}px`));T(e)}function C(){const e=j(`
                    <div class="${r.tabClass}">
                      <i class="icon icon-state-${r.type}"></i>
                    </div>`);e.data("options",r);return e}function w(e,t){x(e).filter(`.${r.activeTabClass}`).removeClass(r.activeTabClass);t.addClass(r.activeTabClass);e.find(`.${r.messageClass}`).html(t.data("options").message);b(e)}function _(e){const t=C();e.find(`.${r.tabsClass}`).prepend(t);w(e,t);t.click(()=>w(e,t))}function A(e){e.style("border-right-width","0")}function E(e){e.style("border-right-width","1px")}function S(e,t){const s=e.offset().left;const o=e.offset().left+e.outerWidth();return t.filter((e,t)=>{const i=j(t);const n=i.offset().left;const r=i.offset().left+i.outerWidth();return n>=s-5&&r<=o+5})}function T(e){let t=x(e);t.each((e,t)=>E(j(t)));A(t.filter(`.${r.activeTabClass}`).prev());const i=S(e,t);if(e.find(`.${r.rightArrowClass}`).is(":visible")){A(i.last().prev())}if(e.find(`.${r.leftArrowClass}`).is(":visible")){A(i.first())}}function x(e){return e.find(`.${r.tabClass}:not(.${r.arrowClass})`)}function D(e){return!e.hasClass(r.expandedClass)||R(e)?k/P:e.width()/P}function R(e){return e.width()===L}function M(e){if((j(":focus",a).length||a.hasClass(r.expandedClass))&&!e){return}return a[r.hideMethod]({duration:r.hideDuration,easing:r.hideEasing,complete:function(){z(a,r.removeEmptyContainer);if(r.onHidden&&h.state!=="hidden"){r.onHidden()}h.state="hidden";h.endTime=new Date;B(h)}})}function N(){if(r.timeOut>0||r.extendedTimeOut>0){o=setTimeout(M,r.extendedTimeOut)}}function O(){clearTimeout(o);a.stop(true,true)[r.showMethod]({duration:r.showDuration,easing:r.showEasing})}}function W(){return j.extend({},p(),e.options)}function z(e,t=true){if(!F){F=H()}if(e.is(":visible")){return}e.remove();e=null;if(t&&F.children().length===0){F.remove()}}}()})})(typeof define==="function"&&define.amd?define:function(e,t){if(typeof module!=="undefined"&&module.exports){module.exports=t(require("jquery","lodash"))}else{window["toastr"]=t(window["jQuery"],window["_"])}});(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):e.moment=t()})(this,function(){"use strict";var L;function d(){return L.apply(null,arguments)}function F(e){L=e}function o(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function G(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function $(e){if(Object.getOwnPropertyNames){return Object.getOwnPropertyNames(e).length===0}else{var t;for(t in e){if(l(e,t)){return false}}return true}}function a(e){return e===void 0}function c(e){return typeof e==="number"||Object.prototype.toString.call(e)==="[object Number]"}function H(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function B(e,t){var i=[],n,r=e.length;for(n=0;n<r;++n){i.push(t(e[n],n))}return i}function V(e,t){for(var i in t){if(l(t,i)){e[i]=t[i]}}if(l(t,"toString")){e.toString=t.toString}if(l(t,"valueOf")){e.valueOf=t.valueOf}return e}function u(e,t,i,n){return Zi(e,t,i,n,true).utc()}function W(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidEra:null,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],era:null,meridiem:null,rfc2822:false,weekdayMismatch:false}}function h(e){if(e._pf==null){e._pf=W()}return e._pf}var z;if(Array.prototype.some){z=Array.prototype.some}else{z=function(e){var t=Object(this),i=t.length>>>0,n;for(n=0;n<i;n++){if(n in t&&e.call(this,t[n],n,t)){return true}}return false}}function j(e){var t=null,i=false,n=e._d&&!isNaN(e._d.getTime());if(n){t=h(e);i=z.call(t.parsedDateParts,function(e){return e!=null});n=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&i);if(e._strict){n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined}}if(Object.isFrozen==null||!Object.isFrozen(e)){e._isValid=n}else{return n}return e._isValid}function U(e){var t=u(NaN);if(e!=null){V(h(t),e)}else{h(t).userInvalidated=true}return t}var Y=d.momentProperties=[],q=false;function K(e,t){var i,n,r,s=Y.length;if(!a(t._isAMomentObject)){e._isAMomentObject=t._isAMomentObject}if(!a(t._i)){e._i=t._i}if(!a(t._f)){e._f=t._f}if(!a(t._l)){e._l=t._l}if(!a(t._strict)){e._strict=t._strict}if(!a(t._tzm)){e._tzm=t._tzm}if(!a(t._isUTC)){e._isUTC=t._isUTC}if(!a(t._offset)){e._offset=t._offset}if(!a(t._pf)){e._pf=h(t)}if(!a(t._locale)){e._locale=t._locale}if(s>0){for(i=0;i<s;i++){n=Y[i];r=t[n];if(!a(r)){e[n]=r}}}return e}function X(e){K(this,e);this._d=new Date(e._d!=null?e._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN)}if(q===false){q=true;d.updateOffset(this);q=false}}function p(e){return e instanceof X||e!=null&&e._isAMomentObject!=null}function Q(e){if(d.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+e)}}function e(s,o){var a=true;return V(function(){if(d.deprecationHandler!=null){d.deprecationHandler(null,s)}if(a){var e=[],t,i,n,r=arguments.length;for(i=0;i<r;i++){t="";if(typeof arguments[i]==="object"){t+="\n["+i+"] ";for(n in arguments[0]){if(l(arguments[0],n)){t+=n+": "+arguments[0][n]+", "}}t=t.slice(0,-2)}else{t=arguments[i]}e.push(t)}Q(s+"\nArguments: "+Array.prototype.slice.call(e).join("")+"\n"+(new Error).stack);a=false}return o.apply(this,arguments)},o)}var Z={};function J(e,t){if(d.deprecationHandler!=null){d.deprecationHandler(e,t)}if(!Z[e]){Q(t);Z[e]=true}}d.suppressDeprecationWarnings=false;d.deprecationHandler=null;function f(e){return typeof Function!=="undefined"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function ee(e){var t,i;for(i in e){if(l(e,i)){t=e[i];if(f(t)){this[i]=t}else{this["_"+i]=t}}}this._config=e;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function te(e,t){var i=V({},e),n;for(n in t){if(l(t,n)){if(G(e[n])&&G(t[n])){i[n]={};V(i[n],e[n]);V(i[n],t[n])}else if(t[n]!=null){i[n]=t[n]}else{delete i[n]}}}for(n in e){if(l(e,n)&&!l(t,n)&&G(e[n])){i[n]=V({},i[n])}}return i}function ie(e){if(e!=null){this.set(e)}}var ne;if(Object.keys){ne=Object.keys}else{ne=function(e){var t,i=[];for(t in e){if(l(e,t)){i.push(t)}}return i}}var re={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function se(e,t,i){var n=this._calendar[e]||this._calendar["sameElse"];return f(n)?n.call(t,i):n}function s(e,t,i){var n=""+Math.abs(e),r=t-n.length,s=e>=0;return(s?i?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+n}var oe=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ae=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,le={},ce={};function n(e,t,i,n){var r=n;if(typeof n==="string"){r=function(){return this[n]()}}if(e){ce[e]=r}if(t){ce[t[0]]=function(){return s(r.apply(this,arguments),t[1],t[2])}}if(i){ce[i]=function(){return this.localeData().ordinal(r.apply(this,arguments),e)}}}function ue(e){if(e.match(/\[[\s\S]/)){return e.replace(/^\[|\]$/g,"")}return e.replace(/\\/g,"")}function de(n){var r=n.match(oe),e,s;for(e=0,s=r.length;e<s;e++){if(ce[r[e]]){r[e]=ce[r[e]]}else{r[e]=ue(r[e])}}return function(e){var t="",i;for(i=0;i<s;i++){t+=f(r[i])?r[i].call(e,n):r[i]}return t}}function he(e,t){if(!e.isValid()){return e.localeData().invalidDate()}t=pe(t,e.localeData());le[t]=le[t]||de(t);return le[t](e)}function pe(e,t){var i=5;function n(e){return t.longDateFormat(e)||e}ae.lastIndex=0;while(i>=0&&ae.test(e)){e=e.replace(ae,n);ae.lastIndex=0;i-=1}return e}var fe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function ge(e){var t=this._longDateFormat[e],i=this._longDateFormat[e.toUpperCase()];if(t||!i){return t}this._longDateFormat[e]=i.match(oe).map(function(e){if(e==="MMMM"||e==="MM"||e==="DD"||e==="dddd"){return e.slice(1)}return e}).join("");return this._longDateFormat[e]}var me="Invalid date";function ve(){return this._invalidDate}var ye="%d",be=/\d{1,2}/;function Ce(e){return this._ordinal.replace("%d",e)}var we={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function _e(e,t,i,n){var r=this._relativeTime[i];return f(r)?r(e,t,i,n):r.replace(/%d/i,e)}function Ae(e,t){var i=this._relativeTime[e>0?"future":"past"];return f(i)?i(t):i.replace(/%s/i,t)}var Ee={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function g(e){return typeof e==="string"?Ee[e]||Ee[e.toLowerCase()]:undefined}function Se(e){var t={},i,n;for(n in e){if(l(e,n)){i=g(n);if(i){t[i]=e[n]}}}return t}var Te={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function xe(e){var t=[],i;for(i in e){if(l(e,i)){t.push({unit:i,priority:Te[i]})}}t.sort(function(e,t){return e.priority-t.priority});return t}var De=/\d/,t=/\d\d/,Re=/\d{3}/,Me=/\d{4}/,Ne=/[+-]?\d{6}/,i=/\d\d?/,Oe=/\d\d\d\d?/,Ie=/\d\d\d\d\d\d?/,Pe=/\d{1,3}/,ke=/\d{1,4}/,Le=/[+-]?\d{1,6}/,Fe=/\d+/,Ge=/[+-]?\d+/,$e=/Z|[+-]\d\d:?\d\d/gi,He=/Z|[+-]\d\d(?::?\d\d)?/gi,Be=/[+-]?\d+(\.\d{1,3})?/,Ve=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,We=/^[1-9]\d?/,ze=/^([1-9]\d|\d)/,je;je={};function r(e,i,n){je[e]=f(i)?i:function(e,t){return e&&n?n:i}}function Ue(e,t){if(!l(je,e)){return new RegExp(Ye(e))}return je[e](t._strict,t._locale)}function Ye(e){return m(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,n,r){return t||i||n||r}))}function m(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function v(e){if(e<0){return Math.ceil(e)||0}else{return Math.floor(e)}}function y(e){var t=+e,i=0;if(t!==0&&isFinite(t)){i=v(t)}return i}var qe={};function b(e,i){var t,n=i,r;if(typeof e==="string"){e=[e]}if(c(i)){n=function(e,t){t[i]=y(e)}}r=e.length;for(t=0;t<r;t++){qe[e[t]]=n}}function Ke(e,r){b(e,function(e,t,i,n){i._w=i._w||{};r(e,i._w,i,n)})}function Xe(e,t,i){if(t!=null&&l(qe,e)){qe[e](t,i._a,i,e)}}function Qe(e){return e%4===0&&e%100!==0||e%400===0}var C=0,w=1,_=2,A=3,E=4,S=5,Ze=6,Je=7,et=8;n("Y",0,0,function(){var e=this.year();return e<=9999?s(e,4):"+"+e});n(0,["YY",2],0,function(){return this.year()%100});n(0,["YYYY",4],0,"year");n(0,["YYYYY",5],0,"year");n(0,["YYYYYY",6,true],0,"year");r("Y",Ge);r("YY",i,t);r("YYYY",ke,Me);r("YYYYY",Le,Ne);r("YYYYYY",Le,Ne);b(["YYYYY","YYYYYY"],C);b("YYYY",function(e,t){t[C]=e.length===2?d.parseTwoDigitYear(e):y(e)});b("YY",function(e,t){t[C]=d.parseTwoDigitYear(e)});b("Y",function(e,t){t[C]=parseInt(e,10)});function tt(e){return Qe(e)?366:365}d.parseTwoDigitYear=function(e){return y(e)+(y(e)>68?1900:2e3)};var it=rt("FullYear",true);function nt(){return Qe(this.year())}function rt(t,i){return function(e){if(e!=null){ot(this,t,e);d.updateOffset(this,i);return this}else{return st(this,t)}}}function st(e,t){if(!e.isValid()){return NaN}var i=e._d,n=e._isUTC;switch(t){case"Milliseconds":return n?i.getUTCMilliseconds():i.getMilliseconds();case"Seconds":return n?i.getUTCSeconds():i.getSeconds();case"Minutes":return n?i.getUTCMinutes():i.getMinutes();case"Hours":return n?i.getUTCHours():i.getHours();case"Date":return n?i.getUTCDate():i.getDate();case"Day":return n?i.getUTCDay():i.getDay();case"Month":return n?i.getUTCMonth():i.getMonth();case"FullYear":return n?i.getUTCFullYear():i.getFullYear();default:return NaN}}function ot(e,t,i){var n,r,s,o,a;if(!e.isValid()||isNaN(i)){return}n=e._d;r=e._isUTC;switch(t){case"Milliseconds":return void(r?n.setUTCMilliseconds(i):n.setMilliseconds(i));case"Seconds":return void(r?n.setUTCSeconds(i):n.setSeconds(i));case"Minutes":return void(r?n.setUTCMinutes(i):n.setMinutes(i));case"Hours":return void(r?n.setUTCHours(i):n.setHours(i));case"Date":return void(r?n.setUTCDate(i):n.setDate(i));case"FullYear":break;default:return}s=i;o=e.month();a=e.date();a=a===29&&o===1&&!Qe(s)?28:a;void(r?n.setUTCFullYear(s,o,a):n.setFullYear(s,o,a))}function at(e){e=g(e);if(f(this[e])){return this[e]()}return this}function lt(e,t){if(typeof e==="object"){e=Se(e);var i=xe(e),n,r=i.length;for(n=0;n<r;n++){this[i[n].unit](e[i[n].unit])}}else{e=g(e);if(f(this[e])){return this[e](t)}}return this}function ct(e,t){return(e%t+t)%t}var T;if(Array.prototype.indexOf){T=Array.prototype.indexOf}else{T=function(e){var t;for(t=0;t<this.length;++t){if(this[t]===e){return t}}return-1}}function ut(e,t){if(isNaN(e)||isNaN(t)){return NaN}var i=ct(t,12);e+=(t-i)/12;return i===1?Qe(e)?29:28:31-i%7%2}n("M",["MM",2],"Mo",function(){return this.month()+1});n("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});n("MMMM",0,0,function(e){return this.localeData().months(this,e)});r("M",i,We);r("MM",i,t);r("MMM",function(e,t){return t.monthsShortRegex(e)});r("MMMM",function(e,t){return t.monthsRegex(e)});b(["M","MM"],function(e,t){t[w]=y(e)-1});b(["MMM","MMMM"],function(e,t,i,n){var r=i._locale.monthsParse(e,n,i._strict);if(r!=null){t[w]=r}else{h(i).invalidMonth=e}});var dt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ht="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),pt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ft=Ve,gt=Ve;function mt(e,t){if(!e){return o(this._months)?this._months:this._months["standalone"]}return o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||pt).test(t)?"format":"standalone"][e.month()]}function vt(e,t){if(!e){return o(this._monthsShort)?this._monthsShort:this._monthsShort["standalone"]}return o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[pt.test(t)?"format":"standalone"][e.month()]}function yt(e,t,i){var n,r,s,o=e.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(n=0;n<12;++n){s=u([2e3,n]);this._shortMonthsParse[n]=this.monthsShort(s,"").toLocaleLowerCase();this._longMonthsParse[n]=this.months(s,"").toLocaleLowerCase()}}if(i){if(t==="MMM"){r=T.call(this._shortMonthsParse,o);return r!==-1?r:null}else{r=T.call(this._longMonthsParse,o);return r!==-1?r:null}}else{if(t==="MMM"){r=T.call(this._shortMonthsParse,o);if(r!==-1){return r}r=T.call(this._longMonthsParse,o);return r!==-1?r:null}else{r=T.call(this._longMonthsParse,o);if(r!==-1){return r}r=T.call(this._shortMonthsParse,o);return r!==-1?r:null}}}function bt(e,t,i){var n,r,s;if(this._monthsParseExact){return yt.call(this,e,t,i)}if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(n=0;n<12;n++){r=u([2e3,n]);if(i&&!this._longMonthsParse[n]){this._longMonthsParse[n]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i");this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")}if(!i&&!this._monthsParse[n]){s="^"+this.months(r,"")+"|^"+this.monthsShort(r,"");this._monthsParse[n]=new RegExp(s.replace(".",""),"i")}if(i&&t==="MMMM"&&this._longMonthsParse[n].test(e)){return n}else if(i&&t==="MMM"&&this._shortMonthsParse[n].test(e)){return n}else if(!i&&this._monthsParse[n].test(e)){return n}}}function Ct(e,t){if(!e.isValid()){return e}if(typeof t==="string"){if(/^\d+$/.test(t)){t=y(t)}else{t=e.localeData().monthsParse(t);if(!c(t)){return e}}}var i=t,n=e.date();n=n<29?n:Math.min(n,ut(e.year(),i));void(e._isUTC?e._d.setUTCMonth(i,n):e._d.setMonth(i,n));return e}function wt(e){if(e!=null){Ct(this,e);d.updateOffset(this,true);return this}else{return st(this,"Month")}}function _t(){return ut(this.year(),this.month())}function At(e){if(this._monthsParseExact){if(!l(this,"_monthsRegex")){St.call(this)}if(e){return this._monthsShortStrictRegex}else{return this._monthsShortRegex}}else{if(!l(this,"_monthsShortRegex")){this._monthsShortRegex=ft}return this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex}}function Et(e){if(this._monthsParseExact){if(!l(this,"_monthsRegex")){St.call(this)}if(e){return this._monthsStrictRegex}else{return this._monthsRegex}}else{if(!l(this,"_monthsRegex")){this._monthsRegex=gt}return this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex}}function St(){function e(e,t){return t.length-e.length}var t=[],i=[],n=[],r,s,o,a;for(r=0;r<12;r++){s=u([2e3,r]);o=m(this.monthsShort(s,""));a=m(this.months(s,""));t.push(o);i.push(a);n.push(a);n.push(o)}t.sort(e);i.sort(e);n.sort(e);this._monthsRegex=new RegExp("^("+n.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function Tt(e,t,i,n,r,s,o){var a;if(e<100&&e>=0){a=new Date(e+400,t,i,n,r,s,o);if(isFinite(a.getFullYear())){a.setFullYear(e)}}else{a=new Date(e,t,i,n,r,s,o)}return a}function xt(e){var t,i;if(e<100&&e>=0){i=Array.prototype.slice.call(arguments);i[0]=e+400;t=new Date(Date.UTC.apply(null,i));if(isFinite(t.getUTCFullYear())){t.setUTCFullYear(e)}}else{t=new Date(Date.UTC.apply(null,arguments))}return t}function Dt(e,t,i){var n=7+t-i,r=(7+xt(e,0,n).getUTCDay()-t)%7;return-r+n-1}function Rt(e,t,i,n,r){var s=(7+i-n)%7,o=Dt(e,n,r),a=1+7*(t-1)+s+o,l,c;if(a<=0){l=e-1;c=tt(l)+a}else if(a>tt(e)){l=e+1;c=a-tt(e)}else{l=e;c=a}return{year:l,dayOfYear:c}}function Mt(e,t,i){var n=Dt(e.year(),t,i),r=Math.floor((e.dayOfYear()-n-1)/7)+1,s,o;if(r<1){o=e.year()-1;s=r+x(o,t,i)}else if(r>x(e.year(),t,i)){s=r-x(e.year(),t,i);o=e.year()+1}else{o=e.year();s=r}return{week:s,year:o}}function x(e,t,i){var n=Dt(e,t,i),r=Dt(e+1,t,i);return(tt(e)-n+r)/7}n("w",["ww",2],"wo","week");n("W",["WW",2],"Wo","isoWeek");r("w",i,We);r("ww",i,t);r("W",i,We);r("WW",i,t);Ke(["w","ww","W","WW"],function(e,t,i,n){t[n.substr(0,1)]=y(e)});function Nt(e){return Mt(e,this._week.dow,this._week.doy).week}var Ot={dow:0,doy:6};function It(){return this._week.dow}function Pt(){return this._week.doy}function kt(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Lt(e){var t=Mt(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}n("d",0,"do","day");n("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});n("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});n("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});n("e",0,0,"weekday");n("E",0,0,"isoWeekday");r("d",i);r("e",i);r("E",i);r("dd",function(e,t){return t.weekdaysMinRegex(e)});r("ddd",function(e,t){return t.weekdaysShortRegex(e)});r("dddd",function(e,t){return t.weekdaysRegex(e)});Ke(["dd","ddd","dddd"],function(e,t,i,n){var r=i._locale.weekdaysParse(e,n,i._strict);if(r!=null){t.d=r}else{h(i).invalidWeekday=e}});Ke(["d","e","E"],function(e,t,i,n){t[n]=y(e)});function Ft(e,t){if(typeof e!=="string"){return e}if(!isNaN(e)){return parseInt(e,10)}e=t.weekdaysParse(e);if(typeof e==="number"){return e}return null}function Gt(e,t){if(typeof e==="string"){return t.weekdaysParse(e)%7||7}return isNaN(e)?null:e}function $t(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Ht="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Bt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Vt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Wt=Ve,zt=Ve,jt=Ve;function Ut(e,t){var i=o(this._weekdays)?this._weekdays:this._weekdays[e&&e!==true&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===true?$t(i,this._week.dow):e?i[e.day()]:i}function Yt(e){return e===true?$t(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function qt(e){return e===true?$t(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Kt(e,t,i){var n,r,s,o=e.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(n=0;n<7;++n){s=u([2e3,1]).day(n);this._minWeekdaysParse[n]=this.weekdaysMin(s,"").toLocaleLowerCase();this._shortWeekdaysParse[n]=this.weekdaysShort(s,"").toLocaleLowerCase();this._weekdaysParse[n]=this.weekdays(s,"").toLocaleLowerCase()}}if(i){if(t==="dddd"){r=T.call(this._weekdaysParse,o);return r!==-1?r:null}else if(t==="ddd"){r=T.call(this._shortWeekdaysParse,o);return r!==-1?r:null}else{r=T.call(this._minWeekdaysParse,o);return r!==-1?r:null}}else{if(t==="dddd"){r=T.call(this._weekdaysParse,o);if(r!==-1){return r}r=T.call(this._shortWeekdaysParse,o);if(r!==-1){return r}r=T.call(this._minWeekdaysParse,o);return r!==-1?r:null}else if(t==="ddd"){r=T.call(this._shortWeekdaysParse,o);if(r!==-1){return r}r=T.call(this._weekdaysParse,o);if(r!==-1){return r}r=T.call(this._minWeekdaysParse,o);return r!==-1?r:null}else{r=T.call(this._minWeekdaysParse,o);if(r!==-1){return r}r=T.call(this._weekdaysParse,o);if(r!==-1){return r}r=T.call(this._shortWeekdaysParse,o);return r!==-1?r:null}}}function Xt(e,t,i){var n,r,s;if(this._weekdaysParseExact){return Kt.call(this,e,t,i)}if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[]}for(n=0;n<7;n++){r=u([2e3,1]).day(n);if(i&&!this._fullWeekdaysParse[n]){this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i");this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i");this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")}if(!this._weekdaysParse[n]){s="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,"");this._weekdaysParse[n]=new RegExp(s.replace(".",""),"i")}if(i&&t==="dddd"&&this._fullWeekdaysParse[n].test(e)){return n}else if(i&&t==="ddd"&&this._shortWeekdaysParse[n].test(e)){return n}else if(i&&t==="dd"&&this._minWeekdaysParse[n].test(e)){return n}else if(!i&&this._weekdaysParse[n].test(e)){return n}}}function Qt(e){if(!this.isValid()){return e!=null?this:NaN}var t=st(this,"Day");if(e!=null){e=Ft(e,this.localeData());return this.add(e-t,"d")}else{return t}}function Zt(e){if(!this.isValid()){return e!=null?this:NaN}var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Jt(e){if(!this.isValid()){return e!=null?this:NaN}if(e!=null){var t=Gt(e,this.localeData());return this.day(this.day()%7?t:t-7)}else{return this.day()||7}}function ei(e){if(this._weekdaysParseExact){if(!l(this,"_weekdaysRegex")){ni.call(this)}if(e){return this._weekdaysStrictRegex}else{return this._weekdaysRegex}}else{if(!l(this,"_weekdaysRegex")){this._weekdaysRegex=Wt}return this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex}}function ti(e){if(this._weekdaysParseExact){if(!l(this,"_weekdaysRegex")){ni.call(this)}if(e){return this._weekdaysShortStrictRegex}else{return this._weekdaysShortRegex}}else{if(!l(this,"_weekdaysShortRegex")){this._weekdaysShortRegex=zt}return this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}}function ii(e){if(this._weekdaysParseExact){if(!l(this,"_weekdaysRegex")){ni.call(this)}if(e){return this._weekdaysMinStrictRegex}else{return this._weekdaysMinRegex}}else{if(!l(this,"_weekdaysMinRegex")){this._weekdaysMinRegex=jt}return this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}}function ni(){function e(e,t){return t.length-e.length}var t=[],i=[],n=[],r=[],s,o,a,l,c;for(s=0;s<7;s++){o=u([2e3,1]).day(s);a=m(this.weekdaysMin(o,""));l=m(this.weekdaysShort(o,""));c=m(this.weekdays(o,""));t.push(a);i.push(l);n.push(c);r.push(a);r.push(l);r.push(c)}t.sort(e);i.sort(e);n.sort(e);r.sort(e);this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+i.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function ri(){return this.hours()%12||12}function si(){return this.hours()||24}n("H",["HH",2],0,"hour");n("h",["hh",2],0,ri);n("k",["kk",2],0,si);n("hmm",0,0,function(){return""+ri.apply(this)+s(this.minutes(),2)});n("hmmss",0,0,function(){return""+ri.apply(this)+s(this.minutes(),2)+s(this.seconds(),2)});n("Hmm",0,0,function(){return""+this.hours()+s(this.minutes(),2)});n("Hmmss",0,0,function(){return""+this.hours()+s(this.minutes(),2)+s(this.seconds(),2)});function oi(e,t){n(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}oi("a",true);oi("A",false);function ai(e,t){return t._meridiemParse}r("a",ai);r("A",ai);r("H",i,ze);r("h",i,We);r("k",i,We);r("HH",i,t);r("hh",i,t);r("kk",i,t);r("hmm",Oe);r("hmmss",Ie);r("Hmm",Oe);r("Hmmss",Ie);b(["H","HH"],A);b(["k","kk"],function(e,t,i){var n=y(e);t[A]=n===24?0:n});b(["a","A"],function(e,t,i){i._isPm=i._locale.isPM(e);i._meridiem=e});b(["h","hh"],function(e,t,i){t[A]=y(e);h(i).bigHour=true});b("hmm",function(e,t,i){var n=e.length-2;t[A]=y(e.substr(0,n));t[E]=y(e.substr(n));h(i).bigHour=true});b("hmmss",function(e,t,i){var n=e.length-4,r=e.length-2;t[A]=y(e.substr(0,n));t[E]=y(e.substr(n,2));t[S]=y(e.substr(r));h(i).bigHour=true});b("Hmm",function(e,t,i){var n=e.length-2;t[A]=y(e.substr(0,n));t[E]=y(e.substr(n))});b("Hmmss",function(e,t,i){var n=e.length-4,r=e.length-2;t[A]=y(e.substr(0,n));t[E]=y(e.substr(n,2));t[S]=y(e.substr(r))});function li(e){return(e+"").toLowerCase().charAt(0)==="p"}var ci=/[ap]\.?m?\.?/i,ui=rt("Hours",true);function di(e,t,i){if(e>11){return i?"pm":"PM"}else{return i?"am":"AM"}}var hi={calendar:re,longDateFormat:fe,invalidDate:me,ordinal:ye,dayOfMonthOrdinalParse:be,relativeTime:we,months:dt,monthsShort:ht,week:Ot,weekdays:Ht,weekdaysMin:Vt,weekdaysShort:Bt,meridiemParse:ci};var D={},pi={},fi;function gi(e,t){var i,n=Math.min(e.length,t.length);for(i=0;i<n;i+=1){if(e[i]!==t[i]){return i}}return n}function mi(e){return e?e.toLowerCase().replace("_","-"):e}function vi(e){var t=0,i,n,r,s;while(t<e.length){s=mi(e[t]).split("-");i=s.length;n=mi(e[t+1]);n=n?n.split("-"):null;while(i>0){r=bi(s.slice(0,i).join("-"));if(r){return r}if(n&&n.length>=i&&gi(s,n)>=i-1){break}i--}t++}return fi}function yi(e){return!!(e&&e.match("^[^/\\\\]*$"))}function bi(t){var e=null,i;if(D[t]===undefined&&typeof module!=="undefined"&&module&&module.exports&&yi(t)){try{e=fi._abbr;i=require;i("./locale/"+t);Ci(e)}catch(e){D[t]=null}}return D[t]}function Ci(e,t){var i;if(e){if(a(t)){i=R(e)}else{i=wi(e,t)}if(i){fi=i}else{if(typeof console!=="undefined"&&console.warn){console.warn("Locale "+e+" not found. Did you forget to load it?")}}}return fi._abbr}function wi(e,t){if(t!==null){var i,n=hi;t.abbr=e;if(D[e]!=null){J("defineLocaleOverride","use moment.updateLocale(localeName, config) to change "+"an existing locale. moment.defineLocale(localeName, "+"config) should only be used for creating a new locale "+"See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");n=D[e]._config}else if(t.parentLocale!=null){if(D[t.parentLocale]!=null){n=D[t.parentLocale]._config}else{i=bi(t.parentLocale);if(i!=null){n=i._config}else{if(!pi[t.parentLocale]){pi[t.parentLocale]=[]}pi[t.parentLocale].push({name:e,config:t});return null}}}D[e]=new ie(te(n,t));if(pi[e]){pi[e].forEach(function(e){wi(e.name,e.config)})}Ci(e);return D[e]}else{delete D[e];return null}}function _i(e,t){if(t!=null){var i,n,r=hi;if(D[e]!=null&&D[e].parentLocale!=null){D[e].set(te(D[e]._config,t))}else{n=bi(e);if(n!=null){r=n._config}t=te(r,t);if(n==null){t.abbr=e}i=new ie(t);i.parentLocale=D[e];D[e]=i}Ci(e)}else{if(D[e]!=null){if(D[e].parentLocale!=null){D[e]=D[e].parentLocale;if(e===Ci()){Ci(e)}}else if(D[e]!=null){delete D[e]}}}return D[e]}function R(e){var t;if(e&&e._locale&&e._locale._abbr){e=e._locale._abbr}if(!e){return fi}if(!o(e)){t=bi(e);if(t){return t}e=[e]}return vi(e)}function Ai(){return ne(D)}function Ei(e){var t,i=e._a;if(i&&h(e).overflow===-2){t=i[w]<0||i[w]>11?w:i[_]<1||i[_]>ut(i[C],i[w])?_:i[A]<0||i[A]>24||i[A]===24&&(i[E]!==0||i[S]!==0||i[Ze]!==0)?A:i[E]<0||i[E]>59?E:i[S]<0||i[S]>59?S:i[Ze]<0||i[Ze]>999?Ze:-1;if(h(e)._overflowDayOfYear&&(t<C||t>_)){t=_}if(h(e)._overflowWeeks&&t===-1){t=Je}if(h(e)._overflowWeekday&&t===-1){t=et}h(e).overflow=t}return e}var Si=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ti=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,xi=/Z|[+-]\d\d(?::?\d\d)?/,Di=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,false],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,false],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,false],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,false],["YYYY",/\d{4}/,false]],Ri=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Mi=/^\/?Date\((-?\d+)/i,Ni=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Oi={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Ii(e){var t,i,n=e._i,r=Si.exec(n)||Ti.exec(n),s,o,a,l,c=Di.length,u=Ri.length;if(r){h(e).iso=true;for(t=0,i=c;t<i;t++){if(Di[t][1].exec(r[1])){o=Di[t][0];s=Di[t][2]!==false;break}}if(o==null){e._isValid=false;return}if(r[3]){for(t=0,i=u;t<i;t++){if(Ri[t][1].exec(r[3])){a=(r[2]||" ")+Ri[t][0];break}}if(a==null){e._isValid=false;return}}if(!s&&a!=null){e._isValid=false;return}if(r[4]){if(xi.exec(r[4])){l="Z"}else{e._isValid=false;return}}e._f=o+(a||"")+(l||"");ji(e)}else{e._isValid=false}}function Pi(e,t,i,n,r,s){var o=[ki(e),ht.indexOf(t),parseInt(i,10),parseInt(n,10),parseInt(r,10)];if(s){o.push(parseInt(s,10))}return o}function ki(e){var t=parseInt(e,10);if(t<=49){return 2e3+t}else if(t<=999){return 1900+t}return t}function Li(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Fi(e,t,i){if(e){var n=Bt.indexOf(e),r=new Date(t[0],t[1],t[2]).getDay();if(n!==r){h(i).weekdayMismatch=true;i._isValid=false;return false}}return true}function Gi(e,t,i){if(e){return Oi[e]}else if(t){return 0}else{var n=parseInt(i,10),r=n%100,s=(n-r)/100;return s*60+r}}function $i(e){var t=Ni.exec(Li(e._i)),i;if(t){i=Pi(t[4],t[3],t[2],t[5],t[6],t[7]);if(!Fi(t[1],i,e)){return}e._a=i;e._tzm=Gi(t[8],t[9],t[10]);e._d=xt.apply(null,e._a);e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm);h(e).rfc2822=true}else{e._isValid=false}}function Hi(e){var t=Mi.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}Ii(e);if(e._isValid===false){delete e._isValid}else{return}$i(e);if(e._isValid===false){delete e._isValid}else{return}if(e._strict){e._isValid=false}else{d.createFromInputFallback(e)}}d.createFromInputFallback=e("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), "+"which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are "+"discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Bi(e,t,i){if(e!=null){return e}if(t!=null){return t}return i}function Vi(e){var t=new Date(d.now());if(e._useUTC){return[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]}return[t.getFullYear(),t.getMonth(),t.getDate()]}function Wi(e){var t,i,n=[],r,s,o;if(e._d){return}r=Vi(e);if(e._w&&e._a[_]==null&&e._a[w]==null){zi(e)}if(e._dayOfYear!=null){o=Bi(e._a[C],r[C]);if(e._dayOfYear>tt(o)||e._dayOfYear===0){h(e)._overflowDayOfYear=true}i=xt(o,0,e._dayOfYear);e._a[w]=i.getUTCMonth();e._a[_]=i.getUTCDate()}for(t=0;t<3&&e._a[t]==null;++t){e._a[t]=n[t]=r[t]}for(;t<7;t++){e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t]}if(e._a[A]===24&&e._a[E]===0&&e._a[S]===0&&e._a[Ze]===0){e._nextDay=true;e._a[A]=0}e._d=(e._useUTC?xt:Tt).apply(null,n);s=e._useUTC?e._d.getUTCDay():e._d.getDay();if(e._tzm!=null){e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm)}if(e._nextDay){e._a[A]=24}if(e._w&&typeof e._w.d!=="undefined"&&e._w.d!==s){h(e).weekdayMismatch=true}}function zi(e){var t,i,n,r,s,o,a,l,c;t=e._w;if(t.GG!=null||t.W!=null||t.E!=null){s=1;o=4;i=Bi(t.GG,e._a[C],Mt(M(),1,4).year);n=Bi(t.W,1);r=Bi(t.E,1);if(r<1||r>7){l=true}}else{s=e._locale._week.dow;o=e._locale._week.doy;c=Mt(M(),s,o);i=Bi(t.gg,e._a[C],c.year);n=Bi(t.w,c.week);if(t.d!=null){r=t.d;if(r<0||r>6){l=true}}else if(t.e!=null){r=t.e+s;if(t.e<0||t.e>6){l=true}}else{r=s}}if(n<1||n>x(i,s,o)){h(e)._overflowWeeks=true}else if(l!=null){h(e)._overflowWeekday=true}else{a=Rt(i,n,r,s,o);e._a[C]=a.year;e._dayOfYear=a.dayOfYear}}d.ISO_8601=function(){};d.RFC_2822=function(){};function ji(e){if(e._f===d.ISO_8601){Ii(e);return}if(e._f===d.RFC_2822){$i(e);return}e._a=[];h(e).empty=true;var t=""+e._i,i,n,r,s,o,a=t.length,l=0,c,u;r=pe(e._f,e._locale).match(oe)||[];u=r.length;for(i=0;i<u;i++){s=r[i];n=(t.match(Ue(s,e))||[])[0];if(n){o=t.substr(0,t.indexOf(n));if(o.length>0){h(e).unusedInput.push(o)}t=t.slice(t.indexOf(n)+n.length);l+=n.length}if(ce[s]){if(n){h(e).empty=false}else{h(e).unusedTokens.push(s)}Xe(s,n,e)}else if(e._strict&&!n){h(e).unusedTokens.push(s)}}h(e).charsLeftOver=a-l;if(t.length>0){h(e).unusedInput.push(t)}if(e._a[A]<=12&&h(e).bigHour===true&&e._a[A]>0){h(e).bigHour=undefined}h(e).parsedDateParts=e._a.slice(0);h(e).meridiem=e._meridiem;e._a[A]=Ui(e._locale,e._a[A],e._meridiem);c=h(e).era;if(c!==null){e._a[C]=e._locale.erasConvertYear(c,e._a[C])}Wi(e);Ei(e)}function Ui(e,t,i){var n;if(i==null){return t}if(e.meridiemHour!=null){return e.meridiemHour(t,i)}else if(e.isPM!=null){n=e.isPM(i);if(n&&t<12){t+=12}if(!n&&t===12){t=0}return t}else{return t}}function Yi(e){var t,i,n,r,s,o,a=false,l=e._f.length;if(l===0){h(e).invalidFormat=true;e._d=new Date(NaN);return}for(r=0;r<l;r++){s=0;o=false;t=K({},e);if(e._useUTC!=null){t._useUTC=e._useUTC}t._f=e._f[r];ji(t);if(j(t)){o=true}s+=h(t).charsLeftOver;s+=h(t).unusedTokens.length*10;h(t).score=s;if(!a){if(n==null||s<n||o){n=s;i=t;if(o){a=true}}}else{if(s<n){n=s;i=t}}}V(e,i||t)}function qi(e){if(e._d){return}var t=Se(e._i),i=t.day===undefined?t.date:t.day;e._a=B([t.year,t.month,i,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)});Wi(e)}function Ki(e){var t=new X(Ei(Xi(e)));if(t._nextDay){t.add(1,"d");t._nextDay=undefined}return t}function Xi(e){var t=e._i,i=e._f;e._locale=e._locale||R(e._l);if(t===null||i===undefined&&t===""){return U({nullInput:true})}if(typeof t==="string"){e._i=t=e._locale.preparse(t)}if(p(t)){return new X(Ei(t))}else if(H(t)){e._d=t}else if(o(i)){Yi(e)}else if(i){ji(e)}else{Qi(e)}if(!j(e)){e._d=null}return e}function Qi(e){var t=e._i;if(a(t)){e._d=new Date(d.now())}else if(H(t)){e._d=new Date(t.valueOf())}else if(typeof t==="string"){Hi(e)}else if(o(t)){e._a=B(t.slice(0),function(e){return parseInt(e,10)});Wi(e)}else if(G(t)){qi(e)}else if(c(t)){e._d=new Date(t)}else{d.createFromInputFallback(e)}}function Zi(e,t,i,n,r){var s={};if(t===true||t===false){n=t;t=undefined}if(i===true||i===false){n=i;i=undefined}if(G(e)&&$(e)||o(e)&&e.length===0){e=undefined}s._isAMomentObject=true;s._useUTC=s._isUTC=r;s._l=i;s._i=e;s._f=t;s._strict=n;return Ki(s)}function M(e,t,i,n){return Zi(e,t,i,n,false)}var Ji=e("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=M.apply(null,arguments);if(this.isValid()&&e.isValid()){return e<this?this:e}else{return U()}}),en=e("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=M.apply(null,arguments);if(this.isValid()&&e.isValid()){return e>this?this:e}else{return U()}});function tn(e,t){var i,n;if(t.length===1&&o(t[0])){t=t[0]}if(!t.length){return M()}i=t[0];for(n=1;n<t.length;++n){if(!t[n].isValid()||t[n][e](i)){i=t[n]}}return i}function nn(){var e=[].slice.call(arguments,0);return tn("isBefore",e)}function rn(){var e=[].slice.call(arguments,0);return tn("isAfter",e)}var sn=function(){return Date.now?Date.now():+new Date};var on=["year","quarter","month","week","day","hour","minute","second","millisecond"];function an(e){var t,i=false,n,r=on.length;for(t in e){if(l(e,t)&&!(T.call(on,t)!==-1&&(e[t]==null||!isNaN(e[t])))){return false}}for(n=0;n<r;++n){if(e[on[n]]){if(i){return false}if(parseFloat(e[on[n]])!==y(e[on[n]])){i=true}}}return true}function ln(){return this._isValid}function cn(){return N(NaN)}function un(e){var t=Se(e),i=t.year||0,n=t.quarter||0,r=t.month||0,s=t.week||t.isoWeek||0,o=t.day||0,a=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._isValid=an(t);this._milliseconds=+u+c*1e3+l*6e4+a*1e3*60*60;this._days=+o+s*7;this._months=+r+n*3+i*12;this._data={};this._locale=R();this._bubble()}function dn(e){return e instanceof un}function hn(e){if(e<0){return Math.round(-1*e)*-1}else{return Math.round(e)}}function pn(e,t,i){var n=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),s=0,o;for(o=0;o<n;o++){if(i&&e[o]!==t[o]||!i&&y(e[o])!==y(t[o])){s++}}return s+r}function fn(e,i){n(e,0,0,function(){var e=this.utcOffset(),t="+";if(e<0){e=-e;t="-"}return t+s(~~(e/60),2)+i+s(~~e%60,2)})}fn("Z",":");fn("ZZ","");r("Z",He);r("ZZ",He);b(["Z","ZZ"],function(e,t,i){i._useUTC=true;i._tzm=mn(He,e)});var gn=/([\+\-]|\d\d)/gi;function mn(e,t){var i=(t||"").match(e),n,r,s;if(i===null){return null}n=i[i.length-1]||[];r=(n+"").match(gn)||["-",0,0];s=+(r[1]*60)+y(r[2]);return s===0?0:r[0]==="+"?s:-s}function vn(e,t){var i,n;if(t._isUTC){i=t.clone();n=(p(e)||H(e)?e.valueOf():M(e).valueOf())-i.valueOf();i._d.setTime(i._d.valueOf()+n);d.updateOffset(i,false);return i}else{return M(e).local()}}function yn(e){return-Math.round(e._d.getTimezoneOffset())}d.updateOffset=function(){};function bn(e,t,i){var n=this._offset||0,r;if(!this.isValid()){return e!=null?this:NaN}if(e!=null){if(typeof e==="string"){e=mn(He,e);if(e===null){return this}}else if(Math.abs(e)<16&&!i){e=e*60}if(!this._isUTC&&t){r=yn(this)}this._offset=e;this._isUTC=true;if(r!=null){this.add(r,"m")}if(n!==e){if(!t||this._changeInProgress){Ln(this,N(e-n,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;d.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?n:yn(this)}}function Cn(e,t){if(e!=null){if(typeof e!=="string"){e=-e}this.utcOffset(e,t);return this}else{return-this.utcOffset()}}function wn(e){return this.utcOffset(0,e)}function _n(e){if(this._isUTC){this.utcOffset(0,e);this._isUTC=false;if(e){this.subtract(yn(this),"m")}}return this}function An(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true)}else if(typeof this._i==="string"){var e=mn($e,this._i);if(e!=null){this.utcOffset(e)}else{this.utcOffset(0,true)}}return this}function En(e){if(!this.isValid()){return false}e=e?M(e).utcOffset():0;return(this.utcOffset()-e)%60===0}function Sn(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Tn(){if(!a(this._isDSTShifted)){return this._isDSTShifted}var e={},t;K(e,this);e=Xi(e);if(e._a){t=e._isUTC?u(e._a):M(e._a);this._isDSTShifted=this.isValid()&&pn(e._a,t.toArray())>0}else{this._isDSTShifted=false}return this._isDSTShifted}function xn(){return this.isValid()?!this._isUTC:false}function Dn(){return this.isValid()?this._isUTC:false}function Rn(){return this.isValid()?this._isUTC&&this._offset===0:false}var Mn=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Nn=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function N(e,t){var i=e,n=null,r,s,o;if(dn(e)){i={ms:e._milliseconds,d:e._days,M:e._months}}else if(c(e)||!isNaN(+e)){i={};if(t){i[t]=+e}else{i.milliseconds=+e}}else if(n=Mn.exec(e)){r=n[1]==="-"?-1:1;i={y:0,d:y(n[_])*r,h:y(n[A])*r,m:y(n[E])*r,s:y(n[S])*r,ms:y(hn(n[Ze]*1e3))*r}}else if(n=Nn.exec(e)){r=n[1]==="-"?-1:1;i={y:On(n[2],r),M:On(n[3],r),w:On(n[4],r),d:On(n[5],r),h:On(n[6],r),m:On(n[7],r),s:On(n[8],r)}}else if(i==null){i={}}else if(typeof i==="object"&&("from"in i||"to"in i)){o=Pn(M(i.from),M(i.to));i={};i.ms=o.milliseconds;i.M=o.months}s=new un(i);if(dn(e)&&l(e,"_locale")){s._locale=e._locale}if(dn(e)&&l(e,"_isValid")){s._isValid=e._isValid}return s}N.fn=un.prototype;N.invalid=cn;function On(e,t){var i=e&&parseFloat(e.replace(",","."));return(isNaN(i)?0:i)*t}function In(e,t){var i={};i.months=t.month()-e.month()+(t.year()-e.year())*12;if(e.clone().add(i.months,"M").isAfter(t)){--i.months}i.milliseconds=+t-+e.clone().add(i.months,"M");return i}function Pn(e,t){var i;if(!(e.isValid()&&t.isValid())){return{milliseconds:0,months:0}}t=vn(t,e);if(e.isBefore(t)){i=In(e,t)}else{i=In(t,e);i.milliseconds=-i.milliseconds;i.months=-i.months}return i}function kn(r,s){return function(e,t){var i,n;if(t!==null&&!isNaN(+t)){J(s,"moment()."+s+"(period, number) is deprecated. Please use moment()."+s+"(number, period). "+"See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");n=e;e=t;t=n}i=N(e,t);Ln(this,i,r);return this}}function Ln(e,t,i,n){var r=t._milliseconds,s=hn(t._days),o=hn(t._months);if(!e.isValid()){return}n=n==null?true:n;if(o){Ct(e,st(e,"Month")+o*i)}if(s){ot(e,"Date",st(e,"Date")+s*i)}if(r){e._d.setTime(e._d.valueOf()+r*i)}if(n){d.updateOffset(e,s||o)}}var Fn=kn(1,"add"),Gn=kn(-1,"subtract");function $n(e){return typeof e==="string"||e instanceof String}function Hn(e){return p(e)||H(e)||$n(e)||c(e)||Vn(e)||Bn(e)||e===null||e===undefined}function Bn(e){var t=G(e)&&!$(e),i=false,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,s,o=n.length;for(r=0;r<o;r+=1){s=n[r];i=i||l(e,s)}return t&&i}function Vn(t){var e=o(t),i=false;if(e){i=t.filter(function(e){return!c(e)&&$n(t)}).length===0}return e&&i}function Wn(e){var t=G(e)&&!$(e),i=false,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,s;for(r=0;r<n.length;r+=1){s=n[r];i=i||l(e,s)}return t&&i}function zn(e,t){var i=e.diff(t,"days",true);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"}function jn(e,t){if(arguments.length===1){if(!arguments[0]){e=undefined;t=undefined}else if(Hn(arguments[0])){e=arguments[0];t=undefined}else if(Wn(arguments[0])){t=arguments[0];e=undefined}}var i=e||M(),n=vn(i,this).startOf("day"),r=d.calendarFormat(this,n)||"sameElse",s=t&&(f(t[r])?t[r].call(this,i):t[r]);return this.format(s||this.localeData().calendar(r,this,M(i)))}function Un(){return new X(this)}function Yn(e,t){var i=p(e)?e:M(e);if(!(this.isValid()&&i.isValid())){return false}t=g(t)||"millisecond";if(t==="millisecond"){return this.valueOf()>i.valueOf()}else{return i.valueOf()<this.clone().startOf(t).valueOf()}}function qn(e,t){var i=p(e)?e:M(e);if(!(this.isValid()&&i.isValid())){return false}t=g(t)||"millisecond";if(t==="millisecond"){return this.valueOf()<i.valueOf()}else{return this.clone().endOf(t).valueOf()<i.valueOf()}}function Kn(e,t,i,n){var r=p(e)?e:M(e),s=p(t)?t:M(t);if(!(this.isValid()&&r.isValid()&&s.isValid())){return false}n=n||"()";return(n[0]==="("?this.isAfter(r,i):!this.isBefore(r,i))&&(n[1]===")"?this.isBefore(s,i):!this.isAfter(s,i))}function Xn(e,t){var i=p(e)?e:M(e),n;if(!(this.isValid()&&i.isValid())){return false}t=g(t)||"millisecond";if(t==="millisecond"){return this.valueOf()===i.valueOf()}else{n=i.valueOf();return this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()}}function Qn(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Zn(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Jn(e,t,i){var n,r,s;if(!this.isValid()){return NaN}n=vn(e,this);if(!n.isValid()){return NaN}r=(n.utcOffset()-this.utcOffset())*6e4;t=g(t);switch(t){case"year":s=er(this,n)/12;break;case"month":s=er(this,n);break;case"quarter":s=er(this,n)/3;break;case"second":s=(this-n)/1e3;break;case"minute":s=(this-n)/6e4;break;case"hour":s=(this-n)/36e5;break;case"day":s=(this-n-r)/864e5;break;case"week":s=(this-n-r)/6048e5;break;default:s=this-n}return i?s:v(s)}function er(e,t){if(e.date()<t.date()){return-er(t,e)}var i=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(i,"months"),r,s;if(t-n<0){r=e.clone().add(i-1,"months");s=(t-n)/(n-r)}else{r=e.clone().add(i+1,"months");s=(t-n)/(r-n)}return-(i+s)||0}d.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";d.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function tr(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ir(e){if(!this.isValid()){return null}var t=e!==true,i=t?this.clone().utc():this;if(i.year()<0||i.year()>9999){return he(i,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ")}if(f(Date.prototype.toISOString)){if(t){return this.toDate().toISOString()}else{return new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",he(i,"Z"))}}return he(i,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function nr(){if(!this.isValid()){return"moment.invalid(/* "+this._i+" */)"}var e="moment",t="",i,n,r,s;if(!this.isLocal()){e=this.utcOffset()===0?"moment.utc":"moment.parseZone";t="Z"}i="["+e+'("]';n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";r="-MM-DD[T]HH:mm:ss.SSS";s=t+'[")]';return this.format(i+n+r+s)}function rr(e){if(!e){e=this.isUtc()?d.defaultFormatUtc:d.defaultFormat}var t=he(this,e);return this.localeData().postformat(t)}function sr(e,t){if(this.isValid()&&(p(e)&&e.isValid()||M(e).isValid())){return N({to:this,from:e}).locale(this.locale()).humanize(!t)}else{return this.localeData().invalidDate()}}function or(e){return this.from(M(),e)}function ar(e,t){if(this.isValid()&&(p(e)&&e.isValid()||M(e).isValid())){return N({from:this,to:e}).locale(this.locale()).humanize(!t)}else{return this.localeData().invalidDate()}}function lr(e){return this.to(M(),e)}function cr(e){var t;if(e===undefined){return this._locale._abbr}else{t=R(e);if(t!=null){this._locale=t}return this}}var ur=e("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){if(e===undefined){return this.localeData()}else{return this.locale(e)}});function dr(){return this._locale}var hr=1e3,pr=60*hr,fr=60*pr,gr=(365*400+97)*24*fr;function mr(e,t){return(e%t+t)%t}function vr(e,t,i){if(e<100&&e>=0){return new Date(e+400,t,i)-gr}else{return new Date(e,t,i).valueOf()}}function yr(e,t,i){if(e<100&&e>=0){return Date.UTC(e+400,t,i)-gr}else{return Date.UTC(e,t,i)}}function br(e){var t,i;e=g(e);if(e===undefined||e==="millisecond"||!this.isValid()){return this}i=this._isUTC?yr:vr;switch(e){case"year":t=i(this.year(),0,1);break;case"quarter":t=i(this.year(),this.month()-this.month()%3,1);break;case"month":t=i(this.year(),this.month(),1);break;case"week":t=i(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=i(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf();t-=mr(t+(this._isUTC?0:this.utcOffset()*pr),fr);break;case"minute":t=this._d.valueOf();t-=mr(t,pr);break;case"second":t=this._d.valueOf();t-=mr(t,hr);break}this._d.setTime(t);d.updateOffset(this,true);return this}function Cr(e){var t,i;e=g(e);if(e===undefined||e==="millisecond"||!this.isValid()){return this}i=this._isUTC?yr:vr;switch(e){case"year":t=i(this.year()+1,0,1)-1;break;case"quarter":t=i(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=i(this.year(),this.month()+1,1)-1;break;case"week":t=i(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=i(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf();t+=fr-mr(t+(this._isUTC?0:this.utcOffset()*pr),fr)-1;break;case"minute":t=this._d.valueOf();t+=pr-mr(t,pr)-1;break;case"second":t=this._d.valueOf();t+=hr-mr(t,hr)-1;break}this._d.setTime(t);d.updateOffset(this,true);return this}function wr(){return this._d.valueOf()-(this._offset||0)*6e4}function _r(){return Math.floor(this.valueOf()/1e3)}function Ar(){return new Date(this.valueOf())}function Er(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Sr(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Tr(){return this.isValid()?this.toISOString():null}function xr(){return j(this)}function Dr(){return V({},h(this))}function Rr(){return h(this).overflow}function Mr(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}n("N",0,0,"eraAbbr");n("NN",0,0,"eraAbbr");n("NNN",0,0,"eraAbbr");n("NNNN",0,0,"eraName");n("NNNNN",0,0,"eraNarrow");n("y",["y",1],"yo","eraYear");n("y",["yy",2],0,"eraYear");n("y",["yyy",3],0,"eraYear");n("y",["yyyy",4],0,"eraYear");r("N",Br);r("NN",Br);r("NNN",Br);r("NNNN",Vr);r("NNNNN",Wr);b(["N","NN","NNN","NNNN","NNNNN"],function(e,t,i,n){var r=i._locale.erasParse(e,n,i._strict);if(r){h(i).era=r}else{h(i).invalidEra=e}});r("y",Fe);r("yy",Fe);r("yyy",Fe);r("yyyy",Fe);r("yo",zr);b(["y","yy","yyy","yyyy"],C);b(["yo"],function(e,t,i,n){var r;if(i._locale._eraYearOrdinalRegex){r=e.match(i._locale._eraYearOrdinalRegex)}if(i._locale.eraYearOrdinalParse){t[C]=i._locale.eraYearOrdinalParse(e,r)}else{t[C]=parseInt(e,10)}});function Nr(e,t){var i,n,r,s=this._eras||R("en")._eras;for(i=0,n=s.length;i<n;++i){switch(typeof s[i].since){case"string":r=d(s[i].since).startOf("day");s[i].since=r.valueOf();break}switch(typeof s[i].until){case"undefined":s[i].until=+Infinity;break;case"string":r=d(s[i].until).startOf("day").valueOf();s[i].until=r.valueOf();break}}return s}function Or(e,t,i){var n,r,s=this.eras(),o,a,l;e=e.toUpperCase();for(n=0,r=s.length;n<r;++n){o=s[n].name.toUpperCase();a=s[n].abbr.toUpperCase();l=s[n].narrow.toUpperCase();if(i){switch(t){case"N":case"NN":case"NNN":if(a===e){return s[n]}break;case"NNNN":if(o===e){return s[n]}break;case"NNNNN":if(l===e){return s[n]}break}}else if([o,a,l].indexOf(e)>=0){return s[n]}}}function Ir(e,t){var i=e.since<=e.until?+1:-1;if(t===undefined){return d(e.since).year()}else{return d(e.since).year()+(t-e.offset)*i}}function Pr(){var e,t,i,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){i=this.clone().startOf("day").valueOf();if(n[e].since<=i&&i<=n[e].until){return n[e].name}if(n[e].until<=i&&i<=n[e].since){return n[e].name}}return""}function kr(){var e,t,i,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){i=this.clone().startOf("day").valueOf();if(n[e].since<=i&&i<=n[e].until){return n[e].narrow}if(n[e].until<=i&&i<=n[e].since){return n[e].narrow}}return""}function Lr(){var e,t,i,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){i=this.clone().startOf("day").valueOf();if(n[e].since<=i&&i<=n[e].until){return n[e].abbr}if(n[e].until<=i&&i<=n[e].since){return n[e].abbr}}return""}function Fr(){var e,t,i,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){i=r[e].since<=r[e].until?+1:-1;n=this.clone().startOf("day").valueOf();if(r[e].since<=n&&n<=r[e].until||r[e].until<=n&&n<=r[e].since){return(this.year()-d(r[e].since).year())*i+r[e].offset}}return this.year()}function Gr(e){if(!l(this,"_erasNameRegex")){jr.call(this)}return e?this._erasNameRegex:this._erasRegex}function $r(e){if(!l(this,"_erasAbbrRegex")){jr.call(this)}return e?this._erasAbbrRegex:this._erasRegex}function Hr(e){if(!l(this,"_erasNarrowRegex")){jr.call(this)}return e?this._erasNarrowRegex:this._erasRegex}function Br(e,t){return t.erasAbbrRegex(e)}function Vr(e,t){return t.erasNameRegex(e)}function Wr(e,t){return t.erasNarrowRegex(e)}function zr(e,t){return t._eraYearOrdinalRegex||Fe}function jr(){var e=[],t=[],i=[],n=[],r,s,o,a,l,c=this.eras();for(r=0,s=c.length;r<s;++r){o=m(c[r].name);a=m(c[r].abbr);l=m(c[r].narrow);t.push(o);e.push(a);i.push(l);n.push(o);n.push(a);n.push(l)}this._erasRegex=new RegExp("^("+n.join("|")+")","i");this._erasNameRegex=new RegExp("^("+t.join("|")+")","i");this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i");this._erasNarrowRegex=new RegExp("^("+i.join("|")+")","i")}n(0,["gg",2],0,function(){return this.weekYear()%100});n(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Ur(e,t){n(0,[e,e.length],0,t)}Ur("gggg","weekYear");Ur("ggggg","weekYear");Ur("GGGG","isoWeekYear");Ur("GGGGG","isoWeekYear");r("G",Ge);r("g",Ge);r("GG",i,t);r("gg",i,t);r("GGGG",ke,Me);r("gggg",ke,Me);r("GGGGG",Le,Ne);r("ggggg",Le,Ne);Ke(["gggg","ggggg","GGGG","GGGGG"],function(e,t,i,n){t[n.substr(0,2)]=y(e)});Ke(["gg","GG"],function(e,t,i,n){t[n]=d.parseTwoDigitYear(e)});function Yr(e){return Jr.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function qr(e){return Jr.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Kr(){return x(this.year(),1,4)}function Xr(){return x(this.isoWeekYear(),1,4)}function Qr(){var e=this.localeData()._week;return x(this.year(),e.dow,e.doy)}function Zr(){var e=this.localeData()._week;return x(this.weekYear(),e.dow,e.doy)}function Jr(e,t,i,n,r){var s;if(e==null){return Mt(this,n,r).year}else{s=x(e,n,r);if(t>s){t=s}return es.call(this,e,t,i,n,r)}}function es(e,t,i,n,r){var s=Rt(e,t,i,n,r),o=xt(s.year,0,s.dayOfYear);this.year(o.getUTCFullYear());this.month(o.getUTCMonth());this.date(o.getUTCDate());return this}n("Q",0,"Qo","quarter");r("Q",De);b("Q",function(e,t){t[w]=(y(e)-1)*3});function ts(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}n("D",["DD",2],"Do","date");r("D",i,We);r("DD",i,t);r("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});b(["D","DD"],_);b("Do",function(e,t){t[_]=y(e.match(i)[0])});var is=rt("Date",true);n("DDD",["DDDD",3],"DDDo","dayOfYear");r("DDD",Pe);r("DDDD",Re);b(["DDD","DDDD"],function(e,t,i){i._dayOfYear=y(e)});function ns(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}n("m",["mm",2],0,"minute");r("m",i,ze);r("mm",i,t);b(["m","mm"],E);var rs=rt("Minutes",false);n("s",["ss",2],0,"second");r("s",i,ze);r("ss",i,t);b(["s","ss"],S);var ss=rt("Seconds",false);n("S",0,0,function(){return~~(this.millisecond()/100)});n(0,["SS",2],0,function(){return~~(this.millisecond()/10)});n(0,["SSS",3],0,"millisecond");n(0,["SSSS",4],0,function(){return this.millisecond()*10});n(0,["SSSSS",5],0,function(){return this.millisecond()*100});n(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});n(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});n(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});n(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});r("S",Pe,De);r("SS",Pe,t);r("SSS",Pe,Re);var os,as;for(os="SSSS";os.length<=9;os+="S"){r(os,Fe)}function ls(e,t){t[Ze]=y(("0."+e)*1e3)}for(os="S";os.length<=9;os+="S"){b(os,ls)}as=rt("Milliseconds",false);n("z",0,0,"zoneAbbr");n("zz",0,0,"zoneName");function cs(){return this._isUTC?"UTC":""}function us(){return this._isUTC?"Coordinated Universal Time":""}var O=X.prototype;O.add=Fn;O.calendar=jn;O.clone=Un;O.diff=Jn;O.endOf=Cr;O.format=rr;O.from=sr;O.fromNow=or;O.to=ar;O.toNow=lr;O.get=at;O.invalidAt=Rr;O.isAfter=Yn;O.isBefore=qn;O.isBetween=Kn;O.isSame=Xn;O.isSameOrAfter=Qn;O.isSameOrBefore=Zn;O.isValid=xr;O.lang=ur;O.locale=cr;O.localeData=dr;O.max=en;O.min=Ji;O.parsingFlags=Dr;O.set=lt;O.startOf=br;O.subtract=Gn;O.toArray=Er;O.toObject=Sr;O.toDate=Ar;O.toISOString=ir;O.inspect=nr;if(typeof Symbol!=="undefined"&&Symbol.for!=null){O[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}}O.toJSON=Tr;O.toString=tr;O.unix=_r;O.valueOf=wr;O.creationData=Mr;O.eraName=Pr;O.eraNarrow=kr;O.eraAbbr=Lr;O.eraYear=Fr;O.year=it;O.isLeapYear=nt;O.weekYear=Yr;O.isoWeekYear=qr;O.quarter=O.quarters=ts;O.month=wt;O.daysInMonth=_t;O.week=O.weeks=kt;O.isoWeek=O.isoWeeks=Lt;O.weeksInYear=Qr;O.weeksInWeekYear=Zr;O.isoWeeksInYear=Kr;O.isoWeeksInISOWeekYear=Xr;O.date=is;O.day=O.days=Qt;O.weekday=Zt;O.isoWeekday=Jt;O.dayOfYear=ns;O.hour=O.hours=ui;O.minute=O.minutes=rs;O.second=O.seconds=ss;O.millisecond=O.milliseconds=as;O.utcOffset=bn;O.utc=wn;O.local=_n;O.parseZone=An;O.hasAlignedHourOffset=En;O.isDST=Sn;O.isLocal=xn;O.isUtcOffset=Dn;O.isUtc=Rn;O.isUTC=Rn;O.zoneAbbr=cs;O.zoneName=us;O.dates=e("dates accessor is deprecated. Use date instead.",is);O.months=e("months accessor is deprecated. Use month instead",wt);O.years=e("years accessor is deprecated. Use year instead",it);O.zone=e("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Cn);O.isDSTShifted=e("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Tn);function ds(e){return M(e*1e3)}function hs(){return M.apply(null,arguments).parseZone()}function ps(e){return e}var I=ie.prototype;I.calendar=se;I.longDateFormat=ge;I.invalidDate=ve;I.ordinal=Ce;I.preparse=ps;I.postformat=ps;I.relativeTime=_e;I.pastFuture=Ae;I.set=ee;I.eras=Nr;I.erasParse=Or;I.erasConvertYear=Ir;I.erasAbbrRegex=$r;I.erasNameRegex=Gr;I.erasNarrowRegex=Hr;I.months=mt;I.monthsShort=vt;I.monthsParse=bt;I.monthsRegex=Et;I.monthsShortRegex=At;I.week=Nt;I.firstDayOfYear=Pt;I.firstDayOfWeek=It;I.weekdays=Ut;I.weekdaysMin=qt;I.weekdaysShort=Yt;I.weekdaysParse=Xt;I.weekdaysRegex=ei;I.weekdaysShortRegex=ti;I.weekdaysMinRegex=ii;I.isPM=li;I.meridiem=di;function fs(e,t,i,n){var r=R(),s=u().set(n,t);return r[i](s,e)}function gs(e,t,i){if(c(e)){t=e;e=undefined}e=e||"";if(t!=null){return fs(e,t,i,"month")}var n,r=[];for(n=0;n<12;n++){r[n]=fs(e,n,i,"month")}return r}function ms(e,t,i,n){if(typeof e==="boolean"){if(c(t)){i=t;t=undefined}t=t||""}else{t=e;i=t;e=false;if(c(t)){i=t;t=undefined}t=t||""}var r=R(),s=e?r._week.dow:0,o,a=[];if(i!=null){return fs(t,(i+s)%7,n,"day")}for(o=0;o<7;o++){a[o]=fs(t,(o+s)%7,n,"day")}return a}function vs(e,t){return gs(e,t,"months")}function ys(e,t){return gs(e,t,"monthsShort")}function bs(e,t,i){return ms(e,t,i,"weekdays")}function Cs(e,t,i){return ms(e,t,i,"weekdaysShort")}function ws(e,t,i){return ms(e,t,i,"weekdaysMin")}Ci("en",{eras:[{since:"0001-01-01",until:+Infinity,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-Infinity,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,i=y(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+i}});d.lang=e("moment.lang is deprecated. Use moment.locale instead.",Ci);d.langData=e("moment.langData is deprecated. Use moment.localeData instead.",R);var P=Math.abs;function _s(){var e=this._data;this._milliseconds=P(this._milliseconds);this._days=P(this._days);this._months=P(this._months);e.milliseconds=P(e.milliseconds);e.seconds=P(e.seconds);e.minutes=P(e.minutes);e.hours=P(e.hours);e.months=P(e.months);e.years=P(e.years);return this}function As(e,t,i,n){var r=N(t,i);e._milliseconds+=n*r._milliseconds;e._days+=n*r._days;e._months+=n*r._months;return e._bubble()}function Es(e,t){return As(this,e,t,1)}function Ss(e,t){return As(this,e,t,-1)}function Ts(e){if(e<0){return Math.floor(e)}else{return Math.ceil(e)}}function xs(){var e=this._milliseconds,t=this._days,i=this._months,n=this._data,r,s,o,a,l;if(!(e>=0&&t>=0&&i>=0||e<=0&&t<=0&&i<=0)){e+=Ts(Rs(i)+t)*864e5;t=0;i=0}n.milliseconds=e%1e3;r=v(e/1e3);n.seconds=r%60;s=v(r/60);n.minutes=s%60;o=v(s/60);n.hours=o%24;t+=v(o/24);l=v(Ds(t));i+=l;t-=Ts(Rs(l));a=v(i/12);i%=12;n.days=t;n.months=i;n.years=a;return this}function Ds(e){return e*4800/146097}function Rs(e){return e*146097/4800}function Ms(e){if(!this.isValid()){return NaN}var t,i,n=this._milliseconds;e=g(e);if(e==="month"||e==="quarter"||e==="year"){t=this._days+n/864e5;i=this._months+Ds(t);switch(e){case"month":return i;case"quarter":return i/3;case"year":return i/12}}else{t=this._days+Math.round(Rs(this._months));switch(e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}}function Ns(e){return function(){return this.as(e)}}var Os=Ns("ms"),Is=Ns("s"),Ps=Ns("m"),ks=Ns("h"),Ls=Ns("d"),Fs=Ns("w"),Gs=Ns("M"),$s=Ns("Q"),Hs=Ns("y"),Bs=Os;function Vs(){return N(this)}function Ws(e){e=g(e);return this.isValid()?this[e+"s"]():NaN}function zs(e){return function(){return this.isValid()?this._data[e]:NaN}}var js=zs("milliseconds"),Us=zs("seconds"),Ys=zs("minutes"),qs=zs("hours"),Ks=zs("days"),Xs=zs("months"),Qs=zs("years");function Zs(){return v(this.days()/7)}var Js=Math.round,eo={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function to(e,t,i,n,r){return r.relativeTime(t||1,!!i,e,n)}function io(e,t,i,n){var r=N(e).abs(),s=Js(r.as("s")),o=Js(r.as("m")),a=Js(r.as("h")),l=Js(r.as("d")),c=Js(r.as("M")),u=Js(r.as("w")),d=Js(r.as("y")),h=s<=i.ss&&["s",s]||s<i.s&&["ss",s]||o<=1&&["m"]||o<i.m&&["mm",o]||a<=1&&["h"]||a<i.h&&["hh",a]||l<=1&&["d"]||l<i.d&&["dd",l];if(i.w!=null){h=h||u<=1&&["w"]||u<i.w&&["ww",u]}h=h||c<=1&&["M"]||c<i.M&&["MM",c]||d<=1&&["y"]||["yy",d];h[2]=t;h[3]=+e>0;h[4]=n;return to.apply(null,h)}function no(e){if(e===undefined){return Js}if(typeof e==="function"){Js=e;return true}return false}function ro(e,t){if(eo[e]===undefined){return false}if(t===undefined){return eo[e]}eo[e]=t;if(e==="s"){eo.ss=t-1}return true}function so(e,t){if(!this.isValid()){return this.localeData().invalidDate()}var i=false,n=eo,r,s;if(typeof e==="object"){t=e;e=false}if(typeof e==="boolean"){i=e}if(typeof t==="object"){n=Object.assign({},eo,t);if(t.s!=null&&t.ss==null){n.ss=t.s-1}}r=this.localeData();s=io(this,!i,n,r);if(i){s=r.pastFuture(+this,s)}return r.postformat(s)}var oo=Math.abs;function ao(e){return(e>0)-(e<0)||+e}function lo(){if(!this.isValid()){return this.localeData().invalidDate()}var e=oo(this._milliseconds)/1e3,t=oo(this._days),i=oo(this._months),n,r,s,o,a=this.asSeconds(),l,c,u,d;if(!a){return"P0D"}n=v(e/60);r=v(n/60);e%=60;n%=60;s=v(i/12);i%=12;o=e?e.toFixed(3).replace(/\.?0+$/,""):"";l=a<0?"-":"";c=ao(this._months)!==ao(a)?"-":"";u=ao(this._days)!==ao(a)?"-":"";d=ao(this._milliseconds)!==ao(a)?"-":"";return l+"P"+(s?c+s+"Y":"")+(i?c+i+"M":"")+(t?u+t+"D":"")+(r||n||e?"T":"")+(r?d+r+"H":"")+(n?d+n+"M":"")+(e?d+o+"S":"")}var k=un.prototype;k.isValid=ln;k.abs=_s;k.add=Es;k.subtract=Ss;k.as=Ms;k.asMilliseconds=Os;k.asSeconds=Is;k.asMinutes=Ps;k.asHours=ks;k.asDays=Ls;k.asWeeks=Fs;k.asMonths=Gs;k.asQuarters=$s;k.asYears=Hs;k.valueOf=Bs;k._bubble=xs;k.clone=Vs;k.get=Ws;k.milliseconds=js;k.seconds=Us;k.minutes=Ys;k.hours=qs;k.days=Ks;k.weeks=Zs;k.months=Xs;k.years=Qs;k.humanize=so;k.toISOString=lo;k.toString=lo;k.toJSON=lo;k.locale=cr;k.localeData=dr;k.toIsoString=e("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",lo);k.lang=ur;n("X",0,0,"unix");n("x",0,0,"valueOf");r("x",Ge);r("X",Be);b("X",function(e,t,i){i._d=new Date(parseFloat(e)*1e3)});b("x",function(e,t,i){i._d=new Date(y(e))});d.version="2.30.1";F(M);d.fn=O;d.min=nn;d.max=rn;d.now=sn;d.utc=u;d.unix=ds;d.months=vs;d.isDate=H;d.locale=Ci;d.invalid=U;d.duration=N;d.isMoment=p;d.weekdays=bs;d.parseZone=hs;d.localeData=R;d.isDuration=dn;d.monthsShort=ys;d.weekdaysMin=ws;d.defineLocale=wi;d.updateLocale=_i;d.locales=Ai;d.weekdaysShort=Cs;d.normalizeUnits=g;d.relativeTimeRounding=no;d.relativeTimeThreshold=ro;d.calendarFormat=zn;d.prototype=O;d.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};return d});(function(e,t){"use strict";if(typeof module==="object"&&module.exports){module.exports=t(require("moment"))}else if(typeof define==="function"&&define.amd){define(["moment"],t)}else{t(e.moment)}})(this,function(s){"use strict";if(s.version===undefined&&s.default){s=s.default}var e="0.5.45",o={},a={},l={},c={},u={},t;if(!s||typeof s.version!=="string"){M("Moment Timezone requires Moment.js. See https://momentjs.com/timezone/docs/#/use-it/browser/")}var i=s.version.split("."),n=+i[0],r=+i[1];if(n<2||n===2&&r<6){M("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+s.version+". See momentjs.com")}function d(e){if(e>96){return e-87}else if(e>64){return e-29}return e-48}function h(e){var t=0,i=e.split("."),n=i[0],r=i[1]||"",s=1,o,a=0,l=1;if(e.charCodeAt(0)===45){t=1;l=-1}for(t;t<n.length;t++){o=d(n.charCodeAt(t));a=60*a+o}for(t=0;t<r.length;t++){s=s/60;o=d(r.charCodeAt(t));a+=o*s}return a*l}function p(e){for(var t=0;t<e.length;t++){e[t]=h(e[t])}}function f(e,t){for(var i=0;i<t;i++){e[i]=Math.round((e[i-1]||0)+e[i]*6e4)}e[t-1]=Infinity}function g(e,t){var i=[],n;for(n=0;n<t.length;n++){i[n]=e[t[n]]}return i}function m(e){var t=e.split("|"),i=t[2].split(" "),n=t[3].split(""),r=t[4].split(" ");p(i);p(n);p(r);f(r,n.length);return{name:t[0],abbrs:g(t[1].split(" "),n),offsets:g(i,n),untils:r,population:t[5]|0}}function v(e){if(e){this._set(m(e))}}function y(e,t){var i=t.length;if(e<t[0]){return 0}else if(i>1&&t[i-1]===Infinity&&e>=t[i-2]){return i-1}else if(e>=t[i-1]){return-1}var n;var r=0;var s=i-1;while(s-r>1){n=Math.floor((r+s)/2);if(t[n]<=e){r=n}else{s=n}}return s}v.prototype={_set:function(e){this.name=e.name;this.abbrs=e.abbrs;this.untils=e.untils;this.offsets=e.offsets;this.population=e.population},_index:function(e){var t=+e,i=this.untils,n;n=y(t,i);if(n>=0){return n}},countries:function(){var t=this.name;return Object.keys(l).filter(function(e){return l[e].zones.indexOf(t)!==-1})},parse:function(e){var t=+e,i=this.offsets,n=this.untils,r=n.length-1,s,o,a,l;for(l=0;l<r;l++){s=i[l];o=i[l+1];a=i[l?l-1:l];if(s<o&&N.moveAmbiguousForward){s=o}else if(s>a&&N.moveInvalidForward){s=a}if(t<n[l]-s*6e4){return i[l]}}return i[r]},abbr:function(e){return this.abbrs[this._index(e)]},offset:function(e){M("zone.offset has been deprecated in favor of zone.utcOffset");return this.offsets[this._index(e)]},utcOffset:function(e){return this.offsets[this._index(e)]}};function b(e,t){this.name=e;this.zones=t}function C(e){var t=e.toTimeString();var i=t.match(/\([a-z ]+\)/i);if(i&&i[0]){i=i[0].match(/[A-Z]/g);i=i?i.join(""):undefined}else{i=t.match(/[A-Z]{3,5}/g);i=i?i[0]:undefined}if(i==="GMT"){i=undefined}this.at=+e;this.abbr=i;this.offset=e.getTimezoneOffset()}function w(e){this.zone=e;this.offsetScore=0;this.abbrScore=0}w.prototype.scoreOffsetAt=function(e){this.offsetScore+=Math.abs(this.zone.utcOffset(e.at)-e.offset);if(this.zone.abbr(e.at).replace(/[^A-Z]/g,"")!==e.abbr){this.abbrScore++}};function _(e,t){var i,n;while(n=((t.at-e.at)/12e4|0)*6e4){i=new C(new Date(e.at+n));if(i.offset===e.offset){e=i}else{t=i}}return e}function L(){var e=(new Date).getFullYear()-2,t=new C(new Date(e,0,1)),i=t.offset,n=[t],r,s,o,a;for(a=1;a<48;a++){o=new Date(e,a,1).getTimezoneOffset();if(o!==i){s=new C(new Date(e,a,1));r=_(t,s);n.push(r);n.push(new C(new Date(r.at+6e4)));t=s;i=o}}for(a=0;a<4;a++){n.push(new C(new Date(e+a,0,1)));n.push(new C(new Date(e+a,6,1)))}return n}function F(e,t){if(e.offsetScore!==t.offsetScore){return e.offsetScore-t.offsetScore}if(e.abbrScore!==t.abbrScore){return e.abbrScore-t.abbrScore}if(e.zone.population!==t.zone.population){return t.zone.population-e.zone.population}return t.zone.name.localeCompare(e.zone.name)}function G(e,t){var i,n;p(t);for(i=0;i<t.length;i++){n=t[i];u[n]=u[n]||{};u[n][e]=true}}function $(e){var t=e.length,i={},n=[],r={},s,o,a,l;for(s=0;s<t;s++){a=e[s].offset;if(r.hasOwnProperty(a)){continue}l=u[a]||{};for(o in l){if(l.hasOwnProperty(o)){i[o]=true}}r[a]=true}for(s in i){if(i.hasOwnProperty(s)){n.push(c[s])}}return n}function H(){try{var e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(e&&e.length>3){var t=c[A(e)];if(t){return t}M("Moment Timezone found "+e+" from the Intl api, but did not have that data loaded.")}}catch(e){}var i=L(),n=i.length,r=$(i),s=[],o,a,l;for(a=0;a<r.length;a++){o=new w(S(r[a]),n);for(l=0;l<n;l++){o.scoreOffsetAt(i[l])}s.push(o)}s.sort(F);return s.length>0?s[0].zone.name:undefined}function B(e){if(!t||e){t=H()}return t}function A(e){return(e||"").toLowerCase().replace(/\//g,"_")}function E(e){var t,i,n,r;if(typeof e==="string"){e=[e]}for(t=0;t<e.length;t++){n=e[t].split("|");i=n[0];r=A(i);o[r]=e[t];c[r]=i;G(r,n[2].split(" "))}}function S(e,t){e=A(e);var i=o[e];var n;if(i instanceof v){return i}if(typeof i==="string"){i=new v(i);o[e]=i;return i}if(a[e]&&t!==S&&(n=S(a[e],S))){i=o[e]=new v;i._set(n);i.name=c[e];return i}return null}function V(){var e,t=[];for(e in c){if(c.hasOwnProperty(e)&&(o[e]||o[a[e]])&&c[e]){t.push(c[e])}}return t.sort()}function W(){return Object.keys(l)}function T(e){var t,i,n,r;if(typeof e==="string"){e=[e]}for(t=0;t<e.length;t++){i=e[t].split("|");n=A(i[0]);r=A(i[1]);a[n]=r;c[n]=i[0];a[r]=n;c[r]=i[1]}}function z(e){var t,i,n,r;if(!e||!e.length)return;for(t=0;t<e.length;t++){r=e[t].split("|");i=r[0].toUpperCase();n=r[1].split(" ");l[i]=new b(i,n)}}function j(e){e=e.toUpperCase();return l[e]||null}function U(e,t){e=j(e);if(!e)return null;var i=e.zones.sort();if(t){return i.map(function(e){var t=S(e);return{name:e,offset:t.utcOffset(new Date)}})}return i}function x(e){E(e.zones);T(e.links);z(e.countries);N.dataVersion=e.version}function D(e){if(!D.didShowError){D.didShowError=true;M("moment.tz.zoneExists('"+e+"') has been deprecated in favor of !moment.tz.zone('"+e+"')")}return!!S(e)}function R(e){var t=e._f==="X"||e._f==="x";return!!(e._a&&e._tzm===undefined&&!t)}function M(e){if(typeof console!=="undefined"&&typeof console.error==="function"){console.error(e)}}function N(e){var t=Array.prototype.slice.call(arguments,0,-1),i=arguments[arguments.length-1],n=s.utc.apply(null,t),r;if(!s.isMoment(e)&&R(n)&&(r=S(i))){n.add(r.parse(n),"minutes")}n.tz(i);return n}N.version=e;N.dataVersion="";N._zones=o;N._links=a;N._names=c;N._countries=l;N.add=E;N.link=T;N.load=x;N.zone=S;N.zoneExists=D;N.guess=B;N.names=V;N.Zone=v;N.unpack=m;N.unpackBase60=h;N.needsOffset=R;N.moveInvalidForward=true;N.moveAmbiguousForward=false;N.countries=W;N.zonesForCountry=U;var O=s.fn;s.tz=N;s.defaultZone=null;s.updateOffset=function(e,t){var i=s.defaultZone,n;if(e._z===undefined){if(i&&R(e)&&!e._isUTC&&e.isValid()){e._d=s.utc(e._a)._d;e.utc().add(i.parse(e),"minutes")}e._z=i}if(e._z){n=e._z.utcOffset(e);if(Math.abs(n)<16){n=n/60}if(e.utcOffset!==undefined){var r=e._z;e.utcOffset(-n,t);e._z=r}else{e.zone(n,t)}}};O.tz=function(e,t){if(e){if(typeof e!=="string"){throw new Error("Time zone name must be a string, got "+e+" ["+typeof e+"]")}this._z=S(e);if(this._z){s.updateOffset(this,t)}else{M("Moment Timezone has no data for "+e+". See http://momentjs.com/timezone/docs/#/data-loading/.")}return this}if(this._z){return this._z.name}};function I(e){return function(){if(this._z){return this._z.abbr(this)}return e.call(this)}}function P(e){return function(){this._z=null;return e.apply(this,arguments)}}function Y(e){return function(){if(arguments.length>0)this._z=null;return e.apply(this,arguments)}}O.zoneName=I(O.zoneName);O.zoneAbbr=I(O.zoneAbbr);O.utc=P(O.utc);O.local=P(O.local);O.utcOffset=Y(O.utcOffset);s.tz.setDefault=function(e){if(n<2||n===2&&r<9){M("Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js "+s.version+".")}s.defaultZone=e?S(e):null;return s};var k=s.momentProperties;if(Object.prototype.toString.call(k)==="[object Array]"){k.push("_z");k.push("_a")}else if(k){k._z=null}x({version:"2024a",zones:["Africa/Abidjan|GMT|0|0||48e5","Africa/Nairobi|EAT|-30|0||47e5","Africa/Algiers|CET|-10|0||26e5","Africa/Lagos|WAT|-10|0||17e6","Africa/Khartoum|CAT|-20|0||51e5","Africa/Cairo|EET EEST|-20 -30|010101010101010|29NW0 1cL0 1cN0 1fz0 1a10 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0|15e6","Africa/Casablanca|+01 +00|-10 0|010101010101010101010101|208q0 e00 2600 gM0 2600 e00 2600 gM0 2600 e00 28M0 e00 2600 gM0 2600 e00 28M0 e00 2600 gM0 2600 e00 2600|32e5","Europe/Paris|CET CEST|-10 -20|01010101010101010101010|1XSp0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0|11e6","Africa/Johannesburg|SAST|-20|0||84e5","Africa/Juba|EAT CAT|-30 -20|01|24nx0|","Africa/Sao_Tome|WAT GMT|-10 0|01|1XiN0|","Africa/Tripoli|EET|-20|0||11e5","America/Adak|HST HDT|a0 90|01010101010101010101010|1XKc0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0|326","America/Anchorage|AKST AKDT|90 80|01010101010101010101010|1XKb0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0|30e4","America/Santo_Domingo|AST|40|0||29e5","America/Fortaleza|-03|30|0||34e5","America/Asuncion|-03 -04|30 40|01010101010101010101010|1XPD0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0|28e5","America/Panama|EST|50|0||15e5","America/Mexico_City|CST CDT|60 50|010101010|1XVk0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0|20e6","America/Managua|CST|60|0||22e5","America/Caracas|-04|40|0||29e5","America/Lima|-05|50|0||11e6","America/Denver|MST MDT|70 60|01010101010101010101010|1XK90 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0|26e5","America/Campo_Grande|-03 -04|30 40|01|1XBD0|77e4","America/Chicago|CST CDT|60 50|01010101010101010101010|1XK80 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0|92e5","America/Chihuahua|MST MDT CST|70 60 60|010101012|1XVl0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0|81e4","America/Ciudad_Juarez|MST MDT CST|70 60 60|010101012010101010101010|1XK90 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1wn0 cm0 EP0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0|","America/Phoenix|MST|70|0||42e5","America/Whitehorse|PST PDT MST|80 70 70|01012|1XKa0 1zb0 Op0 1z90|23e3","America/New_York|EST EDT|50 40|01010101010101010101010|1XK70 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0|21e6","America/Los_Angeles|PST PDT|80 70|01010101010101010101010|1XKa0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0|15e6","America/Halifax|AST ADT|40 30|01010101010101010101010|1XK60 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0|39e4","America/Godthab|-03 -02 -01|30 20 10|0101010101212121212121|1XSp0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 2so0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0|17e3","America/Havana|CST CDT|50 40|01010101010101010101010|1XK50 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0|21e5","America/Mazatlan|MST MDT|70 60|010101010|1XVl0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0|44e4","America/Metlakatla|PST AKST AKDT|80 90 80|012121212121212121212121|1Xqy0 jB0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0|14e2","America/Miquelon|-03 -02|30 20|01010101010101010101010|1XK50 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0|61e2","America/Noronha|-02|20|0||30e2","America/Ojinaga|MST MDT CST CDT|70 60 60 50|01010101232323232323232|1XK90 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1wn0 Rc0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0|23e3","America/Santiago|-03 -04|30 40|01010101010101010101010|1XVf0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 11B0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0|62e5","America/Sao_Paulo|-02 -03|20 30|01|1XBC0|20e6","America/Scoresbysund|-01 +00 -02|10 0 20|0101010101020202020202|1XSp0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 2pA0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0|452","America/St_Johns|NST NDT|3u 2u|01010101010101010101010|1XK5u 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0|11e4","Antarctica/Casey|+11 +08|-b0 -80|0101010101|1XME0 1kr0 12l0 1o01 14kX 1lf1 14kX 1lf1 13bX|10","Asia/Bangkok|+07|-70|0||15e6","Asia/Vladivostok|+10|-a0|0||60e4","Australia/Sydney|AEDT AEST|-b0 -a0|01010101010101010101010|1XV40 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0|40e5","Asia/Tashkent|+05|-50|0||23e5","Pacific/Auckland|NZDT NZST|-d0 -c0|01010101010101010101010|1XV20 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0|14e5","Europe/Istanbul|+03|-30|0||13e6","Antarctica/Troll|+00 +02|0 -20|01010101010101010101010|1XSp0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0|40","Antarctica/Vostok|+07 +05|-70 -50|01|2bnv0|25","Asia/Almaty|+06 +05|-60 -50|01|2bR60|15e5","Asia/Amman|EET EEST +03|-20 -30 -30|010101012|1XRy0 1o00 11A0 1qM0 WM0 1qM0 LA0 1C00|25e5","Asia/Kamchatka|+12|-c0|0||18e4","Asia/Dubai|+04|-40|0||39e5","Asia/Beirut|EET EEST|-20 -30|01010101010101010101010|1XSm0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0|22e5","Asia/Dhaka|+06|-60|0||16e6","Asia/Kuala_Lumpur|+08|-80|0||71e5","Asia/Kolkata|IST|-5u|0||15e6","Asia/Chita|+09|-90|0||33e4","Asia/Shanghai|CST|-80|0||23e6","Asia/Colombo|+0530|-5u|0||22e5","Asia/Damascus|EET EEST +03|-20 -30 -30|010101012|1XRy0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0|26e5","Europe/Athens|EET EEST|-20 -30|01010101010101010101010|1XSp0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0|35e5","Asia/Gaza|EET EEST|-20 -30|01010101010101010101010|1XRy0 1on0 11B0 1o00 11A0 1qo0 XA0 1qp0 1cN0 1cL0 1a10 1fz0 17d0 1in0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0|18e5","Asia/Hong_Kong|HKT|-80|0||73e5","Asia/Jakarta|WIB|-70|0||31e6","Asia/Jayapura|WIT|-90|0||26e4","Asia/Jerusalem|IST IDT|-20 -30|01010101010101010101010|1XRA0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0|81e4","Asia/Kabul|+0430|-4u|0||46e5","Asia/Karachi|PKT|-50|0||24e6","Asia/Kathmandu|+0545|-5J|0||12e5","Asia/Sakhalin|+11|-b0|0||58e4","Asia/Makassar|WITA|-80|0||15e5","Asia/Manila|PST|-80|0||24e6","Asia/Seoul|KST|-90|0||23e6","Asia/Rangoon|+0630|-6u|0||48e5","Asia/Tehran|+0330 +0430|-3u -4u|010101010|1XOIu 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0|14e6","Asia/Tokyo|JST|-90|0||38e6","Atlantic/Azores|-01 +00|10 0|01010101010101010101010|1XSp0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0|25e4","Europe/Lisbon|WET WEST|0 -10|01010101010101010101010|1XSp0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0|27e5","Atlantic/Cape_Verde|-01|10|0||50e4","Australia/Adelaide|ACDT ACST|-au -9u|01010101010101010101010|1XV4u 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0|11e5","Australia/Brisbane|AEST|-a0|0||20e5","Australia/Darwin|ACST|-9u|0||12e4","Australia/Eucla|+0845|-8J|0||368","Australia/Lord_Howe|+11 +1030|-b0 -au|01010101010101010101010|1XV30 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1fzu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu|347","Australia/Perth|AWST|-80|0||18e5","Pacific/Easter|-05 -06|50 60|01010101010101010101010|1XVf0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 11B0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0|30e2","Europe/Dublin|GMT IST|0 -10|01010101010101010101010|1XSp0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0|12e5","Etc/GMT-1|+01|-10|0||","Pacific/Tongatapu|+13|-d0|0||75e3","Pacific/Kiritimati|+14|-e0|0||51e2","Etc/GMT-2|+02|-20|0||","Pacific/Tahiti|-10|a0|0||18e4","Pacific/Niue|-11|b0|0||12e2","Etc/GMT+12|-12|c0|0||","Pacific/Galapagos|-06|60|0||25e3","Etc/GMT+7|-07|70|0||","Pacific/Pitcairn|-08|80|0||56","Pacific/Gambier|-09|90|0||125","Etc/UTC|UTC|0|0||","Europe/London|GMT BST|0 -10|01010101010101010101010|1XSp0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0|10e6","Europe/Chisinau|EET EEST|-20 -30|01010101010101010101010|1XSo0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0|67e4","Europe/Moscow|MSK|-30|0||16e6","Europe/Volgograd|+04 MSK|-40 -30|01|249a0|10e5","Pacific/Honolulu|HST|a0|0||37e4","MET|MET MEST|-10 -20|01010101010101010101010|1XSp0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0|","Pacific/Chatham|+1345 +1245|-dJ -cJ|01010101010101010101010|1XV20 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0|600","Pacific/Apia|+14 +13|-e0 -d0|010101|1XV20 1a00 1fA0 1a00 1fA0|37e3","Pacific/Fiji|+13 +12|-d0 -c0|010101|1Xnq0 20o0 pc0 2hc0 bc0|88e4","Pacific/Guam|ChST|-a0|0||17e4","Pacific/Marquesas|-0930|9u|0||86e2","Pacific/Pago_Pago|SST|b0|0||37e2","Pacific/Norfolk|+11 +12|-b0 -c0|0101010101010101010101|219P0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0|25e4"],links:["Africa/Abidjan|Africa/Accra","Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Bissau","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Monrovia","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|America/Danmarkshavn","Africa/Abidjan|Atlantic/Reykjavik","Africa/Abidjan|Atlantic/St_Helena","Africa/Abidjan|Etc/GMT","Africa/Abidjan|Etc/GMT+0","Africa/Abidjan|Etc/GMT-0","Africa/Abidjan|Etc/GMT0","Africa/Abidjan|Etc/Greenwich","Africa/Abidjan|GMT","Africa/Abidjan|GMT+0","Africa/Abidjan|GMT-0","Africa/Abidjan|GMT0","Africa/Abidjan|Greenwich","Africa/Abidjan|Iceland","Africa/Algiers|Africa/Tunis","Africa/Cairo|Egypt","Africa/Casablanca|Africa/El_Aaiun","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Khartoum|Africa/Blantyre","Africa/Khartoum|Africa/Bujumbura","Africa/Khartoum|Africa/Gaborone","Africa/Khartoum|Africa/Harare","Africa/Khartoum|Africa/Kigali","Africa/Khartoum|Africa/Lubumbashi","Africa/Khartoum|Africa/Lusaka","Africa/Khartoum|Africa/Maputo","Africa/Khartoum|Africa/Windhoek","Africa/Lagos|Africa/Bangui","Africa/Lagos|Africa/Brazzaville","Africa/Lagos|Africa/Douala","Africa/Lagos|Africa/Kinshasa","Africa/Lagos|Africa/Libreville","Africa/Lagos|Africa/Luanda","Africa/Lagos|Africa/Malabo","Africa/Lagos|Africa/Ndjamena","Africa/Lagos|Africa/Niamey","Africa/Lagos|Africa/Porto-Novo","Africa/Nairobi|Africa/Addis_Ababa","Africa/Nairobi|Africa/Asmara","Africa/Nairobi|Africa/Asmera","Africa/Nairobi|Africa/Dar_es_Salaam","Africa/Nairobi|Africa/Djibouti","Africa/Nairobi|Africa/Kampala","Africa/Nairobi|Africa/Mogadishu","Africa/Nairobi|Indian/Antananarivo","Africa/Nairobi|Indian/Comoro","Africa/Nairobi|Indian/Mayotte","Africa/Tripoli|Europe/Kaliningrad","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|America/Juneau","America/Anchorage|America/Nome","America/Anchorage|America/Sitka","America/Anchorage|America/Yakutat","America/Anchorage|US/Alaska","America/Campo_Grande|America/Cuiaba","America/Caracas|America/Boa_Vista","America/Caracas|America/Guyana","America/Caracas|America/La_Paz","America/Caracas|America/Manaus","America/Caracas|America/Porto_Velho","America/Caracas|Brazil/West","America/Caracas|Etc/GMT+4","America/Chicago|America/Indiana/Knox","America/Chicago|America/Indiana/Tell_City","America/Chicago|America/Knox_IN","America/Chicago|America/Matamoros","America/Chicago|America/Menominee","America/Chicago|America/North_Dakota/Beulah","America/Chicago|America/North_Dakota/Center","America/Chicago|America/North_Dakota/New_Salem","America/Chicago|America/Rainy_River","America/Chicago|America/Rankin_Inlet","America/Chicago|America/Resolute","America/Chicago|America/Winnipeg","America/Chicago|CST6CDT","America/Chicago|Canada/Central","America/Chicago|US/Central","America/Chicago|US/Indiana-Starke","America/Denver|America/Boise","America/Denver|America/Cambridge_Bay","America/Denver|America/Edmonton","America/Denver|America/Inuvik","America/Denver|America/Shiprock","America/Denver|America/Yellowknife","America/Denver|Canada/Mountain","America/Denver|MST7MDT","America/Denver|Navajo","America/Denver|US/Mountain","America/Fortaleza|America/Araguaina","America/Fortaleza|America/Argentina/Buenos_Aires","America/Fortaleza|America/Argentina/Catamarca","America/Fortaleza|America/Argentina/ComodRivadavia","America/Fortaleza|America/Argentina/Cordoba","America/Fortaleza|America/Argentina/Jujuy","America/Fortaleza|America/Argentina/La_Rioja","America/Fortaleza|America/Argentina/Mendoza","America/Fortaleza|America/Argentina/Rio_Gallegos","America/Fortaleza|America/Argentina/Salta","America/Fortaleza|America/Argentina/San_Juan","America/Fortaleza|America/Argentina/San_Luis","America/Fortaleza|America/Argentina/Tucuman","America/Fortaleza|America/Argentina/Ushuaia","America/Fortaleza|America/Bahia","America/Fortaleza|America/Belem","America/Fortaleza|America/Buenos_Aires","America/Fortaleza|America/Catamarca","America/Fortaleza|America/Cayenne","America/Fortaleza|America/Cordoba","America/Fortaleza|America/Jujuy","America/Fortaleza|America/Maceio","America/Fortaleza|America/Mendoza","America/Fortaleza|America/Montevideo","America/Fortaleza|America/Paramaribo","America/Fortaleza|America/Punta_Arenas","America/Fortaleza|America/Recife","America/Fortaleza|America/Rosario","America/Fortaleza|America/Santarem","America/Fortaleza|Antarctica/Palmer","America/Fortaleza|Antarctica/Rothera","America/Fortaleza|Atlantic/Stanley","America/Fortaleza|Etc/GMT+3","America/Godthab|America/Nuuk","America/Halifax|America/Glace_Bay","America/Halifax|America/Goose_Bay","America/Halifax|America/Moncton","America/Halifax|America/Thule","America/Halifax|Atlantic/Bermuda","America/Halifax|Canada/Atlantic","America/Havana|Cuba","America/Lima|America/Bogota","America/Lima|America/Eirunepe","America/Lima|America/Guayaquil","America/Lima|America/Porto_Acre","America/Lima|America/Rio_Branco","America/Lima|Brazil/Acre","America/Lima|Etc/GMT+5","America/Los_Angeles|America/Ensenada","America/Los_Angeles|America/Santa_Isabel","America/Los_Angeles|America/Tijuana","America/Los_Angeles|America/Vancouver","America/Los_Angeles|Canada/Pacific","America/Los_Angeles|Mexico/BajaNorte","America/Los_Angeles|PST8PDT","America/Los_Angeles|US/Pacific","America/Managua|America/Belize","America/Managua|America/Costa_Rica","America/Managua|America/El_Salvador","America/Managua|America/Guatemala","America/Managua|America/Regina","America/Managua|America/Swift_Current","America/Managua|America/Tegucigalpa","America/Managua|Canada/Saskatchewan","America/Mazatlan|Mexico/BajaSur","America/Mexico_City|America/Bahia_Banderas","America/Mexico_City|America/Merida","America/Mexico_City|America/Monterrey","America/Mexico_City|Mexico/General","America/New_York|America/Detroit","America/New_York|America/Fort_Wayne","America/New_York|America/Grand_Turk","America/New_York|America/Indiana/Indianapolis","America/New_York|America/Indiana/Marengo","America/New_York|America/Indiana/Petersburg","America/New_York|America/Indiana/Vevay","America/New_York|America/Indiana/Vincennes","America/New_York|America/Indiana/Winamac","America/New_York|America/Indianapolis","America/New_York|America/Iqaluit","America/New_York|America/Kentucky/Louisville","America/New_York|America/Kentucky/Monticello","America/New_York|America/Louisville","America/New_York|America/Montreal","America/New_York|America/Nassau","America/New_York|America/Nipigon","America/New_York|America/Pangnirtung","America/New_York|America/Port-au-Prince","America/New_York|America/Thunder_Bay","America/New_York|America/Toronto","America/New_York|Canada/Eastern","America/New_York|EST5EDT","America/New_York|US/East-Indiana","America/New_York|US/Eastern","America/New_York|US/Michigan","America/Noronha|Atlantic/South_Georgia","America/Noronha|Brazil/DeNoronha","America/Noronha|Etc/GMT+2","America/Panama|America/Atikokan","America/Panama|America/Cancun","America/Panama|America/Cayman","America/Panama|America/Coral_Harbour","America/Panama|America/Jamaica","America/Panama|EST","America/Panama|Jamaica","America/Phoenix|America/Creston","America/Phoenix|America/Dawson_Creek","America/Phoenix|America/Fort_Nelson","America/Phoenix|America/Hermosillo","America/Phoenix|MST","America/Phoenix|US/Arizona","America/Santiago|Chile/Continental","America/Santo_Domingo|America/Anguilla","America/Santo_Domingo|America/Antigua","America/Santo_Domingo|America/Aruba","America/Santo_Domingo|America/Barbados","America/Santo_Domingo|America/Blanc-Sablon","America/Santo_Domingo|America/Curacao","America/Santo_Domingo|America/Dominica","America/Santo_Domingo|America/Grenada","America/Santo_Domingo|America/Guadeloupe","America/Santo_Domingo|America/Kralendijk","America/Santo_Domingo|America/Lower_Princes","America/Santo_Domingo|America/Marigot","America/Santo_Domingo|America/Martinique","America/Santo_Domingo|America/Montserrat","America/Santo_Domingo|America/Port_of_Spain","America/Santo_Domingo|America/Puerto_Rico","America/Santo_Domingo|America/St_Barthelemy","America/Santo_Domingo|America/St_Kitts","America/Santo_Domingo|America/St_Lucia","America/Santo_Domingo|America/St_Thomas","America/Santo_Domingo|America/St_Vincent","America/Santo_Domingo|America/Tortola","America/Santo_Domingo|America/Virgin","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","America/Whitehorse|America/Dawson","America/Whitehorse|Canada/Yukon","Asia/Almaty|Asia/Qostanay","Asia/Bangkok|Antarctica/Davis","Asia/Bangkok|Asia/Barnaul","Asia/Bangkok|Asia/Ho_Chi_Minh","Asia/Bangkok|Asia/Hovd","Asia/Bangkok|Asia/Krasnoyarsk","Asia/Bangkok|Asia/Novokuznetsk","Asia/Bangkok|Asia/Novosibirsk","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Saigon","Asia/Bangkok|Asia/Tomsk","Asia/Bangkok|Asia/Vientiane","Asia/Bangkok|Etc/GMT-7","Asia/Bangkok|Indian/Christmas","Asia/Chita|Asia/Dili","Asia/Chita|Asia/Khandyga","Asia/Chita|Asia/Yakutsk","Asia/Chita|Etc/GMT-9","Asia/Chita|Pacific/Palau","Asia/Dhaka|Asia/Bishkek","Asia/Dhaka|Asia/Dacca","Asia/Dhaka|Asia/Kashgar","Asia/Dhaka|Asia/Omsk","Asia/Dhaka|Asia/Thimbu","Asia/Dhaka|Asia/Thimphu","Asia/Dhaka|Asia/Urumqi","Asia/Dhaka|Etc/GMT-6","Asia/Dhaka|Indian/Chagos","Asia/Dubai|Asia/Baku","Asia/Dubai|Asia/Muscat","Asia/Dubai|Asia/Tbilisi","Asia/Dubai|Asia/Yerevan","Asia/Dubai|Etc/GMT-4","Asia/Dubai|Europe/Astrakhan","Asia/Dubai|Europe/Samara","Asia/Dubai|Europe/Saratov","Asia/Dubai|Europe/Ulyanovsk","Asia/Dubai|Indian/Mahe","Asia/Dubai|Indian/Mauritius","Asia/Dubai|Indian/Reunion","Asia/Gaza|Asia/Hebron","Asia/Hong_Kong|Hongkong","Asia/Jakarta|Asia/Pontianak","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kamchatka|Asia/Anadyr","Asia/Kamchatka|Etc/GMT-12","Asia/Kamchatka|Kwajalein","Asia/Kamchatka|Pacific/Funafuti","Asia/Kamchatka|Pacific/Kwajalein","Asia/Kamchatka|Pacific/Majuro","Asia/Kamchatka|Pacific/Nauru","Asia/Kamchatka|Pacific/Tarawa","Asia/Kamchatka|Pacific/Wake","Asia/Kamchatka|Pacific/Wallis","Asia/Kathmandu|Asia/Katmandu","Asia/Kolkata|Asia/Calcutta","Asia/Kuala_Lumpur|Asia/Brunei","Asia/Kuala_Lumpur|Asia/Choibalsan","Asia/Kuala_Lumpur|Asia/Irkutsk","Asia/Kuala_Lumpur|Asia/Kuching","Asia/Kuala_Lumpur|Asia/Singapore","Asia/Kuala_Lumpur|Asia/Ulaanbaatar","Asia/Kuala_Lumpur|Asia/Ulan_Bator","Asia/Kuala_Lumpur|Etc/GMT-8","Asia/Kuala_Lumpur|Singapore","Asia/Makassar|Asia/Ujung_Pandang","Asia/Rangoon|Asia/Yangon","Asia/Rangoon|Indian/Cocos","Asia/Sakhalin|Asia/Magadan","Asia/Sakhalin|Asia/Srednekolymsk","Asia/Sakhalin|Etc/GMT-11","Asia/Sakhalin|Pacific/Bougainville","Asia/Sakhalin|Pacific/Efate","Asia/Sakhalin|Pacific/Guadalcanal","Asia/Sakhalin|Pacific/Kosrae","Asia/Sakhalin|Pacific/Noumea","Asia/Sakhalin|Pacific/Pohnpei","Asia/Sakhalin|Pacific/Ponape","Asia/Seoul|Asia/Pyongyang","Asia/Seoul|ROK","Asia/Shanghai|Asia/Chongqing","Asia/Shanghai|Asia/Chungking","Asia/Shanghai|Asia/Harbin","Asia/Shanghai|Asia/Macao","Asia/Shanghai|Asia/Macau","Asia/Shanghai|Asia/Taipei","Asia/Shanghai|PRC","Asia/Shanghai|ROC","Asia/Tashkent|Antarctica/Mawson","Asia/Tashkent|Asia/Aqtau","Asia/Tashkent|Asia/Aqtobe","Asia/Tashkent|Asia/Ashgabat","Asia/Tashkent|Asia/Ashkhabad","Asia/Tashkent|Asia/Atyrau","Asia/Tashkent|Asia/Dushanbe","Asia/Tashkent|Asia/Oral","Asia/Tashkent|Asia/Qyzylorda","Asia/Tashkent|Asia/Samarkand","Asia/Tashkent|Asia/Yekaterinburg","Asia/Tashkent|Etc/GMT-5","Asia/Tashkent|Indian/Kerguelen","Asia/Tashkent|Indian/Maldives","Asia/Tehran|Iran","Asia/Tokyo|Japan","Asia/Vladivostok|Antarctica/DumontDUrville","Asia/Vladivostok|Asia/Ust-Nera","Asia/Vladivostok|Etc/GMT-10","Asia/Vladivostok|Pacific/Chuuk","Asia/Vladivostok|Pacific/Port_Moresby","Asia/Vladivostok|Pacific/Truk","Asia/Vladivostok|Pacific/Yap","Atlantic/Cape_Verde|Etc/GMT+1","Australia/Adelaide|Australia/Broken_Hill","Australia/Adelaide|Australia/South","Australia/Adelaide|Australia/Yancowinna","Australia/Brisbane|Australia/Lindeman","Australia/Brisbane|Australia/Queensland","Australia/Darwin|Australia/North","Australia/Lord_Howe|Australia/LHI","Australia/Perth|Australia/West","Australia/Sydney|Antarctica/Macquarie","Australia/Sydney|Australia/ACT","Australia/Sydney|Australia/Canberra","Australia/Sydney|Australia/Currie","Australia/Sydney|Australia/Hobart","Australia/Sydney|Australia/Melbourne","Australia/Sydney|Australia/NSW","Australia/Sydney|Australia/Tasmania","Australia/Sydney|Australia/Victoria","Etc/UTC|Etc/UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UCT","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Athens|Asia/Famagusta","Europe/Athens|Asia/Nicosia","Europe/Athens|EET","Europe/Athens|Europe/Bucharest","Europe/Athens|Europe/Helsinki","Europe/Athens|Europe/Kiev","Europe/Athens|Europe/Kyiv","Europe/Athens|Europe/Mariehamn","Europe/Athens|Europe/Nicosia","Europe/Athens|Europe/Riga","Europe/Athens|Europe/Sofia","Europe/Athens|Europe/Tallinn","Europe/Athens|Europe/Uzhgorod","Europe/Athens|Europe/Vilnius","Europe/Athens|Europe/Zaporozhye","Europe/Chisinau|Europe/Tiraspol","Europe/Dublin|Eire","Europe/Istanbul|Antarctica/Syowa","Europe/Istanbul|Asia/Aden","Europe/Istanbul|Asia/Baghdad","Europe/Istanbul|Asia/Bahrain","Europe/Istanbul|Asia/Istanbul","Europe/Istanbul|Asia/Kuwait","Europe/Istanbul|Asia/Qatar","Europe/Istanbul|Asia/Riyadh","Europe/Istanbul|Etc/GMT-3","Europe/Istanbul|Europe/Minsk","Europe/Istanbul|Turkey","Europe/Lisbon|Atlantic/Canary","Europe/Lisbon|Atlantic/Faeroe","Europe/Lisbon|Atlantic/Faroe","Europe/Lisbon|Atlantic/Madeira","Europe/Lisbon|Portugal","Europe/Lisbon|WET","Europe/London|Europe/Belfast","Europe/London|Europe/Guernsey","Europe/London|Europe/Isle_of_Man","Europe/London|Europe/Jersey","Europe/London|GB","Europe/London|GB-Eire","Europe/Moscow|Europe/Kirov","Europe/Moscow|Europe/Simferopol","Europe/Moscow|W-SU","Europe/Paris|Africa/Ceuta","Europe/Paris|Arctic/Longyearbyen","Europe/Paris|Atlantic/Jan_Mayen","Europe/Paris|CET","Europe/Paris|Europe/Amsterdam","Europe/Paris|Europe/Andorra","Europe/Paris|Europe/Belgrade","Europe/Paris|Europe/Berlin","Europe/Paris|Europe/Bratislava","Europe/Paris|Europe/Brussels","Europe/Paris|Europe/Budapest","Europe/Paris|Europe/Busingen","Europe/Paris|Europe/Copenhagen","Europe/Paris|Europe/Gibraltar","Europe/Paris|Europe/Ljubljana","Europe/Paris|Europe/Luxembourg","Europe/Paris|Europe/Madrid","Europe/Paris|Europe/Malta","Europe/Paris|Europe/Monaco","Europe/Paris|Europe/Oslo","Europe/Paris|Europe/Podgorica","Europe/Paris|Europe/Prague","Europe/Paris|Europe/Rome","Europe/Paris|Europe/San_Marino","Europe/Paris|Europe/Sarajevo","Europe/Paris|Europe/Skopje","Europe/Paris|Europe/Stockholm","Europe/Paris|Europe/Tirane","Europe/Paris|Europe/Vaduz","Europe/Paris|Europe/Vatican","Europe/Paris|Europe/Vienna","Europe/Paris|Europe/Warsaw","Europe/Paris|Europe/Zagreb","Europe/Paris|Europe/Zurich","Europe/Paris|Poland","Pacific/Auckland|Antarctica/McMurdo","Pacific/Auckland|Antarctica/South_Pole","Pacific/Auckland|NZ","Pacific/Chatham|NZ-CHAT","Pacific/Easter|Chile/EasterIsland","Pacific/Galapagos|Etc/GMT+6","Pacific/Gambier|Etc/GMT+9","Pacific/Guam|Pacific/Saipan","Pacific/Honolulu|HST","Pacific/Honolulu|Pacific/Johnston","Pacific/Honolulu|US/Hawaii","Pacific/Kiritimati|Etc/GMT-14","Pacific/Niue|Etc/GMT+11","Pacific/Pago_Pago|Pacific/Midway","Pacific/Pago_Pago|Pacific/Samoa","Pacific/Pago_Pago|US/Samoa","Pacific/Pitcairn|Etc/GMT+8","Pacific/Tahiti|Etc/GMT+10","Pacific/Tahiti|Pacific/Rarotonga","Pacific/Tongatapu|Etc/GMT-13","Pacific/Tongatapu|Pacific/Enderbury","Pacific/Tongatapu|Pacific/Fakaofo","Pacific/Tongatapu|Pacific/Kanton"],countries:["AD|Europe/Andorra","AE|Asia/Dubai","AF|Asia/Kabul","AG|America/Puerto_Rico America/Antigua","AI|America/Puerto_Rico America/Anguilla","AL|Europe/Tirane","AM|Asia/Yerevan","AO|Africa/Lagos Africa/Luanda","AQ|Antarctica/Casey Antarctica/Davis Antarctica/Mawson Antarctica/Palmer Antarctica/Rothera Antarctica/Troll Antarctica/Vostok Pacific/Auckland Pacific/Port_Moresby Asia/Riyadh Antarctica/McMurdo Antarctica/DumontDUrville Antarctica/Syowa","AR|America/Argentina/Buenos_Aires America/Argentina/Cordoba America/Argentina/Salta America/Argentina/Jujuy America/Argentina/Tucuman America/Argentina/Catamarca America/Argentina/La_Rioja America/Argentina/San_Juan America/Argentina/Mendoza America/Argentina/San_Luis America/Argentina/Rio_Gallegos America/Argentina/Ushuaia","AS|Pacific/Pago_Pago","AT|Europe/Vienna","AU|Australia/Lord_Howe Antarctica/Macquarie Australia/Hobart Australia/Melbourne Australia/Sydney Australia/Broken_Hill Australia/Brisbane Australia/Lindeman Australia/Adelaide Australia/Darwin Australia/Perth Australia/Eucla","AW|America/Puerto_Rico America/Aruba","AX|Europe/Helsinki Europe/Mariehamn","AZ|Asia/Baku","BA|Europe/Belgrade Europe/Sarajevo","BB|America/Barbados","BD|Asia/Dhaka","BE|Europe/Brussels","BF|Africa/Abidjan Africa/Ouagadougou","BG|Europe/Sofia","BH|Asia/Qatar Asia/Bahrain","BI|Africa/Maputo Africa/Bujumbura","BJ|Africa/Lagos Africa/Porto-Novo","BL|America/Puerto_Rico America/St_Barthelemy","BM|Atlantic/Bermuda","BN|Asia/Kuching Asia/Brunei","BO|America/La_Paz","BQ|America/Puerto_Rico America/Kralendijk","BR|America/Noronha America/Belem America/Fortaleza America/Recife America/Araguaina America/Maceio America/Bahia America/Sao_Paulo America/Campo_Grande America/Cuiaba America/Santarem America/Porto_Velho America/Boa_Vista America/Manaus America/Eirunepe America/Rio_Branco","BS|America/Toronto America/Nassau","BT|Asia/Thimphu","BW|Africa/Maputo Africa/Gaborone","BY|Europe/Minsk","BZ|America/Belize","CA|America/St_Johns America/Halifax America/Glace_Bay America/Moncton America/Goose_Bay America/Toronto America/Iqaluit America/Winnipeg America/Resolute America/Rankin_Inlet America/Regina America/Swift_Current America/Edmonton America/Cambridge_Bay America/Inuvik America/Dawson_Creek America/Fort_Nelson America/Whitehorse America/Dawson America/Vancouver America/Panama America/Puerto_Rico America/Phoenix America/Blanc-Sablon America/Atikokan America/Creston","CC|Asia/Yangon Indian/Cocos","CD|Africa/Maputo Africa/Lagos Africa/Kinshasa Africa/Lubumbashi","CF|Africa/Lagos Africa/Bangui","CG|Africa/Lagos Africa/Brazzaville","CH|Europe/Zurich","CI|Africa/Abidjan","CK|Pacific/Rarotonga","CL|America/Santiago America/Punta_Arenas Pacific/Easter","CM|Africa/Lagos Africa/Douala","CN|Asia/Shanghai Asia/Urumqi","CO|America/Bogota","CR|America/Costa_Rica","CU|America/Havana","CV|Atlantic/Cape_Verde","CW|America/Puerto_Rico America/Curacao","CX|Asia/Bangkok Indian/Christmas","CY|Asia/Nicosia Asia/Famagusta","CZ|Europe/Prague","DE|Europe/Zurich Europe/Berlin Europe/Busingen","DJ|Africa/Nairobi Africa/Djibouti","DK|Europe/Berlin Europe/Copenhagen","DM|America/Puerto_Rico America/Dominica","DO|America/Santo_Domingo","DZ|Africa/Algiers","EC|America/Guayaquil Pacific/Galapagos","EE|Europe/Tallinn","EG|Africa/Cairo","EH|Africa/El_Aaiun","ER|Africa/Nairobi Africa/Asmara","ES|Europe/Madrid Africa/Ceuta Atlantic/Canary","ET|Africa/Nairobi Africa/Addis_Ababa","FI|Europe/Helsinki","FJ|Pacific/Fiji","FK|Atlantic/Stanley","FM|Pacific/Kosrae Pacific/Port_Moresby Pacific/Guadalcanal Pacific/Chuuk Pacific/Pohnpei","FO|Atlantic/Faroe","FR|Europe/Paris","GA|Africa/Lagos Africa/Libreville","GB|Europe/London","GD|America/Puerto_Rico America/Grenada","GE|Asia/Tbilisi","GF|America/Cayenne","GG|Europe/London Europe/Guernsey","GH|Africa/Abidjan Africa/Accra","GI|Europe/Gibraltar","GL|America/Nuuk America/Danmarkshavn America/Scoresbysund America/Thule","GM|Africa/Abidjan Africa/Banjul","GN|Africa/Abidjan Africa/Conakry","GP|America/Puerto_Rico America/Guadeloupe","GQ|Africa/Lagos Africa/Malabo","GR|Europe/Athens","GS|Atlantic/South_Georgia","GT|America/Guatemala","GU|Pacific/Guam","GW|Africa/Bissau","GY|America/Guyana","HK|Asia/Hong_Kong","HN|America/Tegucigalpa","HR|Europe/Belgrade Europe/Zagreb","HT|America/Port-au-Prince","HU|Europe/Budapest","ID|Asia/Jakarta Asia/Pontianak Asia/Makassar Asia/Jayapura","IE|Europe/Dublin","IL|Asia/Jerusalem","IM|Europe/London Europe/Isle_of_Man","IN|Asia/Kolkata","IO|Indian/Chagos","IQ|Asia/Baghdad","IR|Asia/Tehran","IS|Africa/Abidjan Atlantic/Reykjavik","IT|Europe/Rome","JE|Europe/London Europe/Jersey","JM|America/Jamaica","JO|Asia/Amman","JP|Asia/Tokyo","KE|Africa/Nairobi","KG|Asia/Bishkek","KH|Asia/Bangkok Asia/Phnom_Penh","KI|Pacific/Tarawa Pacific/Kanton Pacific/Kiritimati","KM|Africa/Nairobi Indian/Comoro","KN|America/Puerto_Rico America/St_Kitts","KP|Asia/Pyongyang","KR|Asia/Seoul","KW|Asia/Riyadh Asia/Kuwait","KY|America/Panama America/Cayman","KZ|Asia/Almaty Asia/Qyzylorda Asia/Qostanay Asia/Aqtobe Asia/Aqtau Asia/Atyrau Asia/Oral","LA|Asia/Bangkok Asia/Vientiane","LB|Asia/Beirut","LC|America/Puerto_Rico America/St_Lucia","LI|Europe/Zurich Europe/Vaduz","LK|Asia/Colombo","LR|Africa/Monrovia","LS|Africa/Johannesburg Africa/Maseru","LT|Europe/Vilnius","LU|Europe/Brussels Europe/Luxembourg","LV|Europe/Riga","LY|Africa/Tripoli","MA|Africa/Casablanca","MC|Europe/Paris Europe/Monaco","MD|Europe/Chisinau","ME|Europe/Belgrade Europe/Podgorica","MF|America/Puerto_Rico America/Marigot","MG|Africa/Nairobi Indian/Antananarivo","MH|Pacific/Tarawa Pacific/Kwajalein Pacific/Majuro","MK|Europe/Belgrade Europe/Skopje","ML|Africa/Abidjan Africa/Bamako","MM|Asia/Yangon","MN|Asia/Ulaanbaatar Asia/Hovd Asia/Choibalsan","MO|Asia/Macau","MP|Pacific/Guam Pacific/Saipan","MQ|America/Martinique","MR|Africa/Abidjan Africa/Nouakchott","MS|America/Puerto_Rico America/Montserrat","MT|Europe/Malta","MU|Indian/Mauritius","MV|Indian/Maldives","MW|Africa/Maputo Africa/Blantyre","MX|America/Mexico_City America/Cancun America/Merida America/Monterrey America/Matamoros America/Chihuahua America/Ciudad_Juarez America/Ojinaga America/Mazatlan America/Bahia_Banderas America/Hermosillo America/Tijuana","MY|Asia/Kuching Asia/Singapore Asia/Kuala_Lumpur","MZ|Africa/Maputo","NA|Africa/Windhoek","NC|Pacific/Noumea","NE|Africa/Lagos Africa/Niamey","NF|Pacific/Norfolk","NG|Africa/Lagos","NI|America/Managua","NL|Europe/Brussels Europe/Amsterdam","NO|Europe/Berlin Europe/Oslo","NP|Asia/Kathmandu","NR|Pacific/Nauru","NU|Pacific/Niue","NZ|Pacific/Auckland Pacific/Chatham","OM|Asia/Dubai Asia/Muscat","PA|America/Panama","PE|America/Lima","PF|Pacific/Tahiti Pacific/Marquesas Pacific/Gambier","PG|Pacific/Port_Moresby Pacific/Bougainville","PH|Asia/Manila","PK|Asia/Karachi","PL|Europe/Warsaw","PM|America/Miquelon","PN|Pacific/Pitcairn","PR|America/Puerto_Rico","PS|Asia/Gaza Asia/Hebron","PT|Europe/Lisbon Atlantic/Madeira Atlantic/Azores","PW|Pacific/Palau","PY|America/Asuncion","QA|Asia/Qatar","RE|Asia/Dubai Indian/Reunion","RO|Europe/Bucharest","RS|Europe/Belgrade","RU|Europe/Kaliningrad Europe/Moscow Europe/Simferopol Europe/Kirov Europe/Volgograd Europe/Astrakhan Europe/Saratov Europe/Ulyanovsk Europe/Samara Asia/Yekaterinburg Asia/Omsk Asia/Novosibirsk Asia/Barnaul Asia/Tomsk Asia/Novokuznetsk Asia/Krasnoyarsk Asia/Irkutsk Asia/Chita Asia/Yakutsk Asia/Khandyga Asia/Vladivostok Asia/Ust-Nera Asia/Magadan Asia/Sakhalin Asia/Srednekolymsk Asia/Kamchatka Asia/Anadyr","RW|Africa/Maputo Africa/Kigali","SA|Asia/Riyadh","SB|Pacific/Guadalcanal","SC|Asia/Dubai Indian/Mahe","SD|Africa/Khartoum","SE|Europe/Berlin Europe/Stockholm","SG|Asia/Singapore","SH|Africa/Abidjan Atlantic/St_Helena","SI|Europe/Belgrade Europe/Ljubljana","SJ|Europe/Berlin Arctic/Longyearbyen","SK|Europe/Prague Europe/Bratislava","SL|Africa/Abidjan Africa/Freetown","SM|Europe/Rome Europe/San_Marino","SN|Africa/Abidjan Africa/Dakar","SO|Africa/Nairobi Africa/Mogadishu","SR|America/Paramaribo","SS|Africa/Juba","ST|Africa/Sao_Tome","SV|America/El_Salvador","SX|America/Puerto_Rico America/Lower_Princes","SY|Asia/Damascus","SZ|Africa/Johannesburg Africa/Mbabane","TC|America/Grand_Turk","TD|Africa/Ndjamena","TF|Asia/Dubai Indian/Maldives Indian/Kerguelen","TG|Africa/Abidjan Africa/Lome","TH|Asia/Bangkok","TJ|Asia/Dushanbe","TK|Pacific/Fakaofo","TL|Asia/Dili","TM|Asia/Ashgabat","TN|Africa/Tunis","TO|Pacific/Tongatapu","TR|Europe/Istanbul","TT|America/Puerto_Rico America/Port_of_Spain","TV|Pacific/Tarawa Pacific/Funafuti","TW|Asia/Taipei","TZ|Africa/Nairobi Africa/Dar_es_Salaam","UA|Europe/Simferopol Europe/Kyiv","UG|Africa/Nairobi Africa/Kampala","UM|Pacific/Pago_Pago Pacific/Tarawa Pacific/Midway Pacific/Wake","US|America/New_York America/Detroit America/Kentucky/Louisville America/Kentucky/Monticello America/Indiana/Indianapolis America/Indiana/Vincennes America/Indiana/Winamac America/Indiana/Marengo America/Indiana/Petersburg America/Indiana/Vevay America/Chicago America/Indiana/Tell_City America/Indiana/Knox America/Menominee America/North_Dakota/Center America/North_Dakota/New_Salem America/North_Dakota/Beulah America/Denver America/Boise America/Phoenix America/Los_Angeles America/Anchorage America/Juneau America/Sitka America/Metlakatla America/Yakutat America/Nome America/Adak Pacific/Honolulu","UY|America/Montevideo","UZ|Asia/Samarkand Asia/Tashkent","VA|Europe/Rome Europe/Vatican","VC|America/Puerto_Rico America/St_Vincent","VE|America/Caracas","VG|America/Puerto_Rico America/Tortola","VI|America/Puerto_Rico America/St_Thomas","VN|Asia/Bangkok Asia/Ho_Chi_Minh","VU|Pacific/Efate","WF|Pacific/Tarawa Pacific/Wallis","WS|Pacific/Apia","YE|Asia/Riyadh Asia/Aden","YT|Africa/Nairobi Indian/Mayotte","ZA|Africa/Johannesburg","ZM|Africa/Maputo Africa/Lusaka","ZW|Africa/Maputo Africa/Harare"]});return s});(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):(e=e||self,e.PerfectScrollbar=t())})(this,function(){"use strict";function m(e){return getComputedStyle(e)}function c(e,t){for(var i in t){var n=t[i];if(typeof n==="number"){n=n+"px"}e.style[i]=n}return e}function u(e){var t=document.createElement("div");t.className=e;return t}var i=typeof Element!=="undefined"&&(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);function n(e,t){if(!i){throw new Error("No element matching method supported")}return i.call(e,t)}function r(e){if(e.remove){e.remove()}else{if(e.parentNode){e.parentNode.removeChild(e)}}}function s(e,t){return Array.prototype.filter.call(e.children,function(e){return n(e,t)})}var y={main:"ps",rtl:"ps__rtl",element:{thumb:function(e){return"ps__thumb-"+e},rail:function(e){return"ps__rail-"+e},consuming:"ps__child--consume"},state:{focus:"ps--focus",clicking:"ps--clicking",active:function(e){return"ps--active-"+e},scrolling:function(e){return"ps--scrolling-"+e}}};var o={x:null,y:null};function b(e,t){var i=e.element.classList;var n=y.state.scrolling(t);if(i.contains(n)){clearTimeout(o[t])}else{i.add(n)}}function C(e,t){o[t]=setTimeout(function(){return e.isAlive&&e.element.classList.remove(y.state.scrolling(t))},e.settings.scrollingThreshold)}function h(e,t){b(e,t);C(e,t)}var a=function e(t){this.element=t;this.handlers={}};var e={isEmpty:{configurable:true}};a.prototype.bind=function e(t,i){if(typeof this.handlers[t]==="undefined"){this.handlers[t]=[]}this.handlers[t].push(i);this.element.addEventListener(t,i,false)};a.prototype.unbind=function e(t,i){var n=this;this.handlers[t]=this.handlers[t].filter(function(e){if(i&&e!==i){return true}n.element.removeEventListener(t,e,false);return false})};a.prototype.unbindAll=function e(){for(var t in this.handlers){this.unbind(t)}};e.isEmpty.get=function(){var t=this;return Object.keys(this.handlers).every(function(e){return t.handlers[e].length===0})};Object.defineProperties(a.prototype,e);var d=function e(){this.eventElements=[]};d.prototype.eventElement=function e(t){var i=this.eventElements.filter(function(e){return e.element===t})[0];if(!i){i=new a(t);this.eventElements.push(i)}return i};d.prototype.bind=function e(t,i,n){this.eventElement(t).bind(i,n)};d.prototype.unbind=function e(t,i,n){var r=this.eventElement(t);r.unbind(i,n);if(r.isEmpty){this.eventElements.splice(this.eventElements.indexOf(r),1)}};d.prototype.unbindAll=function e(){this.eventElements.forEach(function(e){return e.unbindAll()});this.eventElements=[]};d.prototype.once=function e(t,i,n){var r=this.eventElement(t);var s=function(e){r.unbind(i,s);n(e)};r.bind(i,s)};function p(e){if(typeof window.CustomEvent==="function"){return new CustomEvent(e)}else{var t=document.createEvent("CustomEvent");t.initCustomEvent(e,false,false,undefined);return t}}function l(e,t,i,n,r){if(n===void 0)n=true;if(r===void 0)r=false;var s;if(t==="top"){s=["contentHeight","containerHeight","scrollTop","y","up","down"]}else if(t==="left"){s=["contentWidth","containerWidth","scrollLeft","x","left","right"]}else{throw new Error("A proper axis should be provided")}f(e,i,s,n,r)}function f(e,t,i,n,r){var s=i[0];var o=i[1];var a=i[2];var l=i[3];var c=i[4];var u=i[5];if(n===void 0)n=true;if(r===void 0)r=false;var d=e.element;e.reach[l]=null;if(d[a]<1){e.reach[l]="start"}if(d[a]>e[s]-e[o]-1){e.reach[l]="end"}if(t){d.dispatchEvent(p("ps-scroll-"+l));if(t<0){d.dispatchEvent(p("ps-scroll-"+c))}else if(t>0){d.dispatchEvent(p("ps-scroll-"+u))}if(n){h(e,l)}}if(e.reach[l]&&(t||r)){d.dispatchEvent(p("ps-"+l+"-reach-"+e.reach[l]))}}function g(e){return parseInt(e,10)||0}function v(e){return n(e,"input,[contenteditable]")||n(e,"select,[contenteditable]")||n(e,"textarea,[contenteditable]")||n(e,"button,[contenteditable]")}function w(e){var t=m(e);return g(t.width)+g(t.paddingLeft)+g(t.paddingRight)+g(t.borderLeftWidth)+g(t.borderRightWidth)}var _={isWebKit:typeof document!=="undefined"&&"WebkitAppearance"in document.documentElement.style,supportsTouch:typeof window!=="undefined"&&("ontouchstart"in window||"maxTouchPoints"in window.navigator&&window.navigator.maxTouchPoints>0||window.DocumentTouch&&document instanceof window.DocumentTouch),supportsIePointer:typeof navigator!=="undefined"&&navigator.msMaxTouchPoints,isChrome:typeof navigator!=="undefined"&&/Chrome/i.test(navigator&&navigator.userAgent)};function A(e){var t=e.element;if(!e.settings.wheelPropagation){if(e.maxScroll!==0&&t.scrollTop+t.offsetHeight<t.scrollHeight){e.maxScroll=0}if(t.scrollTop+t.offsetHeight>=t.scrollHeight&&e.maxScroll===0){e.maxScroll=t.scrollTop}if(e.maxScroll!==0&&t.scrollTop>e.maxScroll){return}}var i=Math.floor(t.scrollTop);var n=t.getBoundingClientRect();e.containerWidth=Math.round(n.width);e.containerHeight=Math.round(n.height);e.contentWidth=t.scrollWidth;e.contentHeight=t.scrollHeight;if(!t.contains(e.scrollbarXRail)){s(t,y.element.rail("x")).forEach(function(e){return r(e)});t.appendChild(e.scrollbarXRail)}if(!t.contains(e.scrollbarYRail)){s(t,y.element.rail("y")).forEach(function(e){return r(e)});t.appendChild(e.scrollbarYRail)}if(!e.settings.suppressScrollX&&e.containerWidth+e.settings.scrollXMarginOffset<e.contentWidth){e.scrollbarXActive=true;e.railXWidth=e.containerWidth-e.railXMarginWidth;e.railXRatio=e.containerWidth/e.railXWidth;e.scrollbarXWidth=E(e,g(e.railXWidth*e.containerWidth/e.contentWidth));e.scrollbarXLeft=g((e.negativeScrollAdjustment+t.scrollLeft)*(e.railXWidth-e.scrollbarXWidth)/(e.contentWidth-e.containerWidth))}else{e.scrollbarXActive=false}if(!e.settings.suppressScrollY&&e.containerHeight+e.settings.scrollYMarginOffset<e.contentHeight){e.scrollbarYActive=true;e.railYHeight=e.containerHeight-e.railYMarginHeight;e.railYRatio=e.containerHeight/e.railYHeight;e.scrollbarYHeight=E(e,g(e.railYHeight*e.containerHeight/e.contentHeight));e.scrollbarYTop=g(i*(e.railYHeight-e.scrollbarYHeight)/(e.contentHeight-e.containerHeight))}else{e.scrollbarYActive=false}if(e.scrollbarXLeft>=e.railXWidth-e.scrollbarXWidth){e.scrollbarXLeft=e.railXWidth-e.scrollbarXWidth}if(e.scrollbarYTop>=e.railYHeight-e.scrollbarYHeight){e.scrollbarYTop=e.railYHeight-e.scrollbarYHeight}S(t,e);if(e.scrollbarXActive){t.classList.add(y.state.active("x"))}else{t.classList.remove(y.state.active("x"));e.scrollbarXWidth=0;e.scrollbarXLeft=0;t.scrollLeft=e.isRtl===true?e.contentWidth:0}if(e.scrollbarYActive){t.classList.add(y.state.active("y"))}else{t.classList.remove(y.state.active("y"));e.scrollbarYHeight=0;e.scrollbarYTop=0;t.scrollTop=0}}function E(e,t){if(e.settings.minScrollbarLength){t=Math.max(t,e.settings.minScrollbarLength)}if(e.settings.maxScrollbarLength){t=Math.min(t,e.settings.maxScrollbarLength)}return t}function S(e,t){var i={width:t.railXWidth};var n=Math.floor(e.scrollTop);if(t.isRtl){i.left=t.negativeScrollAdjustment+e.scrollLeft+t.containerWidth-t.contentWidth}else{i.left=e.scrollLeft}if(t.isScrollbarXUsingBottom){i.bottom=t.scrollbarXBottom-n}else{i.top=t.scrollbarXTop+n}c(t.scrollbarXRail,i);var r={top:n,height:t.railYHeight};if(t.isScrollbarYUsingRight){if(t.isRtl){r.right=t.contentWidth-(t.negativeScrollAdjustment+e.scrollLeft)-t.scrollbarYRight-t.scrollbarYOuterWidth-9}else{r.right=t.scrollbarYRight-e.scrollLeft}}else{if(t.isRtl){r.left=t.negativeScrollAdjustment+e.scrollLeft+t.containerWidth*2-t.contentWidth-t.scrollbarYLeft-t.scrollbarYOuterWidth}else{r.left=t.scrollbarYLeft+e.scrollLeft}}c(t.scrollbarYRail,r);c(t.scrollbarX,{left:t.scrollbarXLeft,width:t.scrollbarXWidth-t.railBorderXWidth});c(t.scrollbarY,{top:t.scrollbarYTop,height:t.scrollbarYHeight-t.railBorderYWidth})}function t(n){var e=n.element;n.event.bind(n.scrollbarY,"mousedown",function(e){$(document).trigger($.Event("agn:rail-mousedown"),[n.element]);return e.stopPropagation()});n.event.bind(n.scrollbarYRail,"mousedown",function(e){var t=e.pageY-window.pageYOffset-n.scrollbarYRail.getBoundingClientRect().top;var i=t>n.scrollbarYTop?1:-1;n.element.scrollTop+=i*n.containerHeight;A(n);e.stopPropagation()});n.event.bind(n.scrollbarX,"mousedown",function(e){return e.stopPropagation()});n.event.bind(n.scrollbarXRail,"mousedown",function(e){var t=e.pageX-window.pageXOffset-n.scrollbarXRail.getBoundingClientRect().left;var i=t>n.scrollbarXLeft?1:-1;n.element.scrollLeft+=i*n.containerWidth;A(n);e.stopPropagation()})}function T(e){x(e,["containerWidth","contentWidth","pageX","railXWidth","scrollbarX","scrollbarXWidth","scrollLeft","x","scrollbarXRail"]);x(e,["containerHeight","contentHeight","pageY","railYHeight","scrollbarY","scrollbarYHeight","scrollTop","y","scrollbarYRail"])}function x(i,e){var n=e[0];var r=e[1];var s=e[2];var o=e[3];var t=e[4];var a=e[5];var l=e[6];var c=e[7];var u=e[8];var d=i.element;var h=null;var p=null;var f=null;function g(e){if(e.touches&&e.touches[0]){e[s]=e.touches[0].pageY}d[l]=h+f*(e[s]-p);b(i,c);A(i);e.stopPropagation();if(e.type.startsWith("touch")&&e.changedTouches.length>1){e.preventDefault()}}function m(){$(document).trigger($.Event("agn:rail-mouseup"),[i.element]);C(i,c);i[u].classList.remove(y.state.clicking);i.event.unbind(i.ownerDocument,"mousemove",g)}function v(e,t){h=d[l];if(t&&e.touches){e[s]=e.touches[0].pageY}p=e[s];f=(i[r]-i[n])/(i[o]-i[a]);if(!t){i.event.bind(i.ownerDocument,"mousemove",g);i.event.once(i.ownerDocument,"mouseup",m);e.preventDefault()}else{i.event.bind(i.ownerDocument,"touchmove",g)}i[u].classList.add(y.state.clicking);e.stopPropagation()}i.event.bind(i[t],"mousedown",function(e){v(e)});i.event.bind(i[t],"touchstart",function(e){v(e,true)})}function D(r){var s=r.element;var o=function(){return n(s,":hover")};var a=function(){return n(r.scrollbarX,":focus")||n(r.scrollbarY,":focus")};function l(e,t){var i=Math.floor(s.scrollTop);if(e===0){if(!r.scrollbarYActive){return false}if(i===0&&t>0||i>=r.contentHeight-r.containerHeight&&t<0){return!r.settings.wheelPropagation}}var n=s.scrollLeft;if(t===0){if(!r.scrollbarXActive){return false}if(n===0&&e<0||n>=r.contentWidth-r.containerWidth&&e>0){return!r.settings.wheelPropagation}}return true}r.event.bind(r.ownerDocument,"keydown",function(e){if(e.isDefaultPrevented&&e.isDefaultPrevented()||e.defaultPrevented){return}if(!o()&&!a()){return}var t=document.activeElement?document.activeElement:r.ownerDocument.activeElement;if(t){if(t.tagName==="IFRAME"){t=t.contentDocument.activeElement}else{while(t.shadowRoot){t=t.shadowRoot.activeElement}}if(v(t)){return}}var i=0;var n=0;switch(e.which){case 37:if(e.metaKey){i=-r.contentWidth}else if(e.altKey){i=-r.containerWidth}else{i=-30}break;case 38:if(e.metaKey){n=r.contentHeight}else if(e.altKey){n=r.containerHeight}else{n=30}break;case 39:if(e.metaKey){i=r.contentWidth}else if(e.altKey){i=r.containerWidth}else{i=30}break;case 40:if(e.metaKey){n=-r.contentHeight}else if(e.altKey){n=-r.containerHeight}else{n=-30}break;case 32:if(e.shiftKey){n=r.containerHeight}else{n=-r.containerHeight}break;case 33:n=r.containerHeight;break;case 34:n=-r.containerHeight;break;case 36:n=r.contentHeight;break;case 35:n=-r.contentHeight;break;default:return}if(r.settings.suppressScrollX&&i!==0){return}if(r.settings.suppressScrollY&&n!==0){return}s.scrollTop-=n;s.scrollLeft+=i;A(r);if(l(i,n)){e.preventDefault()}})}function R(l){var c=l.element;function s(e,t){var i=Math.floor(c.scrollTop);var n=c.scrollTop===0;var r=i+c.offsetHeight===c.scrollHeight;var s=c.scrollLeft===0;var o=c.scrollLeft+c.offsetWidth===c.scrollWidth;var a;if(Math.abs(t)>Math.abs(e)){a=n||r}else{a=s||o}return a?!l.settings.wheelPropagation:true}function o(e){var t=e.deltaX;var i=-1*e.deltaY;if(typeof t==="undefined"||typeof i==="undefined"){t=-1*e.wheelDeltaX/6;i=e.wheelDeltaY/6}if(e.deltaMode&&e.deltaMode===1){t*=10;i*=10}if(t!==t&&i!==i){t=0;i=e.wheelDelta}if(e.shiftKey){return[-i,-t]}return[t,i]}function a(e,t,i){if(!_.isWebKit&&c.querySelector("select:focus")){return true}if(!c.contains(e)){return false}var n=e;while(n&&n!==c){if(n.classList.contains(y.element.consuming)){return true}var r=m(n);if(i&&r.overflowY.match(/(scroll|auto)/)){var s=n.scrollHeight-n.clientHeight;if(s>0){if(n.scrollTop>0&&i<0||n.scrollTop<s&&i>0){return true}}}if(t&&r.overflowX.match(/(scroll|auto)/)){var o=n.scrollWidth-n.clientWidth;if(o>0){if(n.scrollLeft>0&&t<0||n.scrollLeft<o&&t>0){return true}}}n=n.parentNode}return false}function e(e){var t=o(e);var i=t[0];var n=t[1];if(a(e.target,i,n)){return}var r=false;if(!l.settings.useBothWheelAxes){c.scrollTop-=n*l.settings.wheelSpeed;c.scrollLeft+=i*l.settings.wheelSpeed}else if(l.scrollbarYActive&&!l.scrollbarXActive){if(n){c.scrollTop-=n*l.settings.wheelSpeed}else{c.scrollTop+=i*l.settings.wheelSpeed}r=true}else if(l.scrollbarXActive&&!l.scrollbarYActive){if(i){c.scrollLeft+=i*l.settings.wheelSpeed}else{c.scrollLeft-=n*l.settings.wheelSpeed}r=true}A(l);r=r||s(i,n);if(r&&!e.ctrlKey){e.stopPropagation();e.preventDefault()}}if(typeof window.onwheel!=="undefined"){l.event.bind(c,"wheel",e)}else if(typeof window.onmousewheel!=="undefined"){l.event.bind(c,"mousewheel",e)}}function M(o){if(!_.supportsTouch&&!_.supportsIePointer){return}var a=o.element;function l(e,t){var i=Math.floor(a.scrollTop);var n=a.scrollLeft;var r=Math.abs(e);var s=Math.abs(t);if(s>r){if(t<0&&i===o.contentHeight-o.containerHeight||t>0&&i===0){return window.scrollY===0&&t>0&&_.isChrome}}else if(r>s){if(e<0&&n===o.contentWidth-o.containerWidth||e>0&&n===0){return true}}return true}function c(e,t){a.scrollTop-=t;a.scrollLeft-=e;A(o)}var u={};var d=0;var h={};var i=null;function p(e){if(e.targetTouches){return e.targetTouches[0]}else{return e}}function f(e){if(e.pointerType&&e.pointerType==="pen"&&e.buttons===0){return false}if(e.targetTouches&&e.targetTouches.length===1){return true}if(e.pointerType&&e.pointerType!=="mouse"&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE){return true}return false}function e(e){if(!f(e)){return}var t=p(e);u.pageX=t.pageX;u.pageY=t.pageY;d=(new Date).getTime();if(i!==null){clearInterval(i)}}function g(e,t,i){if(!a.contains(e)){return false}var n=e;while(n&&n!==a){if(n.classList.contains(y.element.consuming)){return true}var r=m(n);if(i&&r.overflowY.match(/(scroll|auto)/)){var s=n.scrollHeight-n.clientHeight;if(s>0){if(n.scrollTop>0&&i<0||n.scrollTop<s&&i>0){return true}}}if(t&&r.overflowX.match(/(scroll|auto)/)){var o=n.scrollWidth-n.clientWidth;if(o>0){if(n.scrollLeft>0&&t<0||n.scrollLeft<o&&t>0){return true}}}n=n.parentNode}return false}function t(e){if(f(e)){var t=p(e);var i={pageX:t.pageX,pageY:t.pageY};var n=i.pageX-u.pageX;var r=i.pageY-u.pageY;if(g(e.target,n,r)){return}c(n,r);u=i;var s=(new Date).getTime();var o=s-d;if(o>0){h.x=n/o;h.y=r/o;d=s}if(l(n,r)){e.preventDefault()}}}function n(){if(o.settings.swipeEasing){clearInterval(i);i=setInterval(function(){if(o.isInitialized){clearInterval(i);return}if(!h.x&&!h.y){clearInterval(i);return}if(Math.abs(h.x)<.01&&Math.abs(h.y)<.01){clearInterval(i);return}if(!o.element){clearInterval(i);return}c(h.x*30,h.y*30);h.x*=.8;h.y*=.8},10)}}if(_.supportsTouch){o.event.bind(a,"touchstart",e);o.event.bind(a,"touchmove",t);o.event.bind(a,"touchend",n)}else if(_.supportsIePointer){if(window.PointerEvent){o.event.bind(a,"pointerdown",e);o.event.bind(a,"pointermove",t);o.event.bind(a,"pointerup",n)}else if(window.MSPointerEvent){o.event.bind(a,"MSPointerDown",e);o.event.bind(a,"MSPointerMove",t);o.event.bind(a,"MSPointerUp",n)}}}var N=function(){return{handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:false,suppressScrollY:false,swipeEasing:true,useBothWheelAxes:false,wheelPropagation:true,wheelSpeed:1}};var O={"click-rail":t,"drag-thumb":T,keyboard:D,wheel:R,touch:M};var I=function e(i,t){var n=this;if(t===void 0)t={};if(typeof i==="string"){i=document.querySelector(i)}if(!i||!i.nodeName){throw new Error("no element is specified to initialize PerfectScrollbar")}this.maxScroll=0;this.element=i;i.classList.add(y.main);this.settings=N();for(var r in t){this.settings[r]=t[r]}this.containerWidth=null;this.containerHeight=null;this.contentWidth=null;this.contentHeight=null;var s=function(){return i.classList.add(y.state.focus)};var o=function(){return i.classList.remove(y.state.focus)};this.isRtl=m(i).direction==="rtl";if(this.isRtl===true){i.classList.add(y.rtl)}this.isNegativeScroll=function(){var e=i.scrollLeft;var t=null;i.scrollLeft=-1;t=i.scrollLeft<0;i.scrollLeft=e;return t}();this.negativeScrollAdjustment=this.isNegativeScroll?i.scrollWidth-i.clientWidth:0;this.event=new d;this.ownerDocument=i.ownerDocument||document;this.scrollbarXRail=u(y.element.rail("x"));i.appendChild(this.scrollbarXRail);this.scrollbarX=u(y.element.thumb("x"));this.scrollbarXRail.appendChild(this.scrollbarX);this.scrollbarX.setAttribute("tabindex",0);this.event.bind(this.scrollbarX,"focus",s);this.event.bind(this.scrollbarX,"blur",o);this.scrollbarXActive=null;this.scrollbarXWidth=null;this.scrollbarXLeft=null;var a=m(this.scrollbarXRail);this.scrollbarXBottom=parseInt(a.bottom,10);if(isNaN(this.scrollbarXBottom)){this.isScrollbarXUsingBottom=false;this.scrollbarXTop=g(a.top)}else{this.isScrollbarXUsingBottom=true}this.railBorderXWidth=g(a.borderLeftWidth)+g(a.borderRightWidth);c(this.scrollbarXRail,{display:"block"});this.railXMarginWidth=g(a.marginLeft)+g(a.marginRight);c(this.scrollbarXRail,{display:""});this.railXWidth=null;this.railXRatio=null;this.scrollbarYRail=u(y.element.rail("y"));i.appendChild(this.scrollbarYRail);this.scrollbarY=u(y.element.thumb("y"));this.scrollbarYRail.appendChild(this.scrollbarY);this.scrollbarY.setAttribute("tabindex",0);this.event.bind(this.scrollbarY,"focus",s);this.event.bind(this.scrollbarY,"blur",o);this.scrollbarYActive=null;this.scrollbarYHeight=null;this.scrollbarYTop=null;var l=m(this.scrollbarYRail);this.scrollbarYRight=parseInt(l.right,10);if(isNaN(this.scrollbarYRight)){this.isScrollbarYUsingRight=false;this.scrollbarYLeft=g(l.left)}else{this.isScrollbarYUsingRight=true}this.scrollbarYOuterWidth=this.isRtl?w(this.scrollbarY):null;this.railBorderYWidth=g(l.borderTopWidth)+g(l.borderBottomWidth);c(this.scrollbarYRail,{display:"block"});this.railYMarginHeight=g(l.marginTop)+g(l.marginBottom);c(this.scrollbarYRail,{display:""});this.railYHeight=null;this.railYRatio=null;this.reach={x:i.scrollLeft<=0?"start":i.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:i.scrollTop<=0?"start":i.scrollTop>=this.contentHeight-this.containerHeight?"end":null};this.isAlive=true;this.settings.handlers.forEach(function(e){return O[e](n)});this.lastScrollTop=Math.floor(i.scrollTop);this.lastScrollLeft=i.scrollLeft;this.event.bind(this.element,"scroll",function(e){return n.onScroll(e)});A(this)};I.prototype.update=function e(){if(!this.isAlive){return}this.negativeScrollAdjustment=this.isNegativeScroll?this.element.scrollWidth-this.element.clientWidth:0;c(this.scrollbarXRail,{display:"block"});c(this.scrollbarYRail,{display:"block"});this.railXMarginWidth=g(m(this.scrollbarXRail).marginLeft)+g(m(this.scrollbarXRail).marginRight);this.railYMarginHeight=g(m(this.scrollbarYRail).marginTop)+g(m(this.scrollbarYRail).marginBottom);c(this.scrollbarXRail,{display:"none"});c(this.scrollbarYRail,{display:"none"});A(this);l(this,"top",0,false,true);l(this,"left",0,false,true);c(this.scrollbarXRail,{display:""});c(this.scrollbarYRail,{display:""})};I.prototype.onScroll=function e(t){if(!this.isAlive){return}A(this);l(this,"top",this.element.scrollTop-this.lastScrollTop);l(this,"left",this.element.scrollLeft-this.lastScrollLeft);this.lastScrollTop=Math.floor(this.element.scrollTop);this.lastScrollLeft=this.element.scrollLeft};I.prototype.destroy=function e(){if(!this.isAlive){return}this.event.unbindAll();r(this.scrollbarX);r(this.scrollbarY);r(this.scrollbarXRail);r(this.scrollbarYRail);this.removePsClasses();this.element=null;this.scrollbarX=null;this.scrollbarY=null;this.scrollbarXRail=null;this.scrollbarYRail=null;this.isAlive=false};I.prototype.removePsClasses=function e(){this.element.className=this.element.className.split(" ").filter(function(e){return!e.match(/^ps([-_].+|)$/)}).join(" ")};return I});(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports==="object"){module.exports=e}else{e(jQuery)}})(function(c){var e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],t="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],u=Array.prototype.slice,d,h;if(c.event.fixHooks){for(var i=e.length;i;){c.event.fixHooks[e[--i]]=c.event.mouseHooks}}var n=c.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener){for(var e=t.length;e;){this.addEventListener(t[--e],r,false)}}else{this.onmousewheel=r}c.data(this,"mousewheel-line-height",n.getLineHeight(this));c.data(this,"mousewheel-page-height",n.getPageHeight(this))},teardown:function(){if(this.removeEventListener){for(var e=t.length;e;){this.removeEventListener(t[--e],r,false)}}else{this.onmousewheel=null}},getLineHeight:function(e){return parseInt(c(e)["offsetParent"in c.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(e){return c(e).height()},settings:{adjustOldDeltas:true}};c.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}});function r(e){var t=e||window.event,i=u.call(arguments,1),n=0,r=0,s=0,o=0;e=c.event.fix(t);e.type="mousewheel";if("detail"in t){s=t.detail*-1}if("wheelDelta"in t){s=t.wheelDelta}if("wheelDeltaY"in t){s=t.wheelDeltaY}if("wheelDeltaX"in t){r=t.wheelDeltaX*-1}if("axis"in t&&t.axis===t.HORIZONTAL_AXIS){r=s*-1;s=0}n=s===0?r:s;if("deltaY"in t){s=t.deltaY*-1;n=s}if("deltaX"in t){r=t.deltaX;if(s===0){n=r*-1}}if(s===0&&r===0){return}if(t.deltaMode===1){var a=c.data(this,"mousewheel-line-height");n*=a;s*=a;r*=a}else if(t.deltaMode===2){var l=c.data(this,"mousewheel-page-height");n*=l;s*=l;r*=l}o=Math.max(Math.abs(s),Math.abs(r));if(!h||o<h){h=o;if(f(t,o)){h/=40}}if(f(t,o)){n/=40;r/=40;s/=40}n=Math[n>=1?"floor":"ceil"](n/h);r=Math[r>=1?"floor":"ceil"](r/h);s=Math[s>=1?"floor":"ceil"](s/h);e.deltaX=r;e.deltaY=s;e.deltaFactor=h;e.deltaMode=0;i.unshift(e,n,r,s);if(d){clearTimeout(d)}d=setTimeout(p,200);return(c.event.dispatch||c.event.handle).apply(this,i)}function p(){h=null}function f(e,t){return n.settings.adjustOldDeltas&&e.type==="mousewheel"&&t%120===0}});(function(v){if(typeof window==="undefined")return;var y=0,b=false,s=false,e="message",Y=e.length,R="[iFrameSizer]",M=R.length,N=null,n=window.requestAnimationFrame,A={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},O={},i=null,C={autoResize:true,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:true,inPageLinks:false,enablePublicMethods:true,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:false,maxHeight:Infinity,maxWidth:Infinity,minHeight:0,minWidth:0,mouseEvents:true,resizeFrom:"parent",scrolling:false,sizeHeight:true,sizeWidth:false,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",onClose:function(){return true},onClosed:function(){},onInit:function(){},onMessage:function(){L("onMessage function not defined")},onMouseEnter:function(){},onMouseLeave:function(){},onResized:function(){},onScroll:function(){return true}};function w(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function I(e,t,i){e.addEventListener(t,i,false)}function q(e,t,i){e.removeEventListener(t,i,false)}function h(){var e=["moz","webkit","o","ms"];var t;for(t=0;t<e.length&&!n;t+=1){n=window[e[t]+"RequestAnimationFrame"]}if(!n){P("setup","RequestAnimationFrame not supported")}else{n=n.bind(window)}}function p(e){var t="Host page: "+e;if(window.top!==window.self){t=window.parentIFrame&&window.parentIFrame.getId?window.parentIFrame.getId()+": "+e:"Nested host page: "+e}return t}function f(e){return R+"["+p(e)+"]"}function r(e){return O[e]?O[e].log:b}function P(e,t){o("log",e,t,r(e))}function k(e,t){o("info",e,t,r(e))}function L(e,t){o("warn",e,t,true)}function o(e,t,i,n){if(true===n&&"object"===typeof window.console){console[e](f(t),i)}}function g(t){function e(){function e(){W(x);H(D);w("onResized",x)}n("Height");n("Width");z(e,x,"init")}function i(){var e=T.substr(M).split(":");var t=e[1]?parseInt(e[1],10):0;var i=O[e[0]]&&O[e[0]].iframe;var n=getComputedStyle(i);return{iframe:i,id:e[0],height:t+r(n)+s(n),width:e[2],type:e[3]}}function r(e){if(e.boxSizing!=="border-box"){return 0}var t=e.paddingTop?parseInt(e.paddingTop,10):0;var i=e.paddingBottom?parseInt(e.paddingBottom,10):0;return t+i}function s(e){if(e.boxSizing!=="border-box"){return 0}var t=e.borderTopWidth?parseInt(e.borderTopWidth,10):0;var i=e.borderBottomWidth?parseInt(e.borderBottomWidth,10):0;return t+i}function n(e){var t=Number(O[D]["max"+e]),i=Number(O[D]["min"+e]),n=e.toLowerCase(),r=Number(x[n]);P(D,"Checking "+n+" is in range "+i+"-"+t);if(r<i){r=i;P(D,"Set "+n+" to min value")}if(r>t){r=t;P(D,"Set "+n+" to max value")}x[n]=""+r}function o(){function e(){function e(){var e=0,t=false;P(D,"Checking connection is from allowed list of origins: "+n);for(;e<n.length;e++){if(n[e]===i){t=true;break}}return t}function t(){var e=O[D]&&O[D].remoteHost;P(D,"Checking connection is from: "+e);return i===e}return n.constructor===Array?e():t()}var i=t.origin,n=O[D]&&O[D].checkOrigin;if(n&&""+i!=="null"&&!e()){throw new Error("Unexpected message received from: "+i+" for "+x.iframe.id+". Message was: "+t.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.")}return true}function a(){return R===(""+T).substr(0,M)&&T.substr(M).split(":")[0]in O}function l(){var e=x.type in{true:1,false:1,undefined:1};if(e){P(D,"Ignoring init message from meta parent page")}return e}function c(e){return T.substr(T.indexOf(":")+Y+e)}function u(e){P(D,"onMessage passed: {iframe: "+x.iframe.id+", message: "+e+"}");w("onMessage",{iframe:x.iframe,message:JSON.parse(e)});P(D,"--")}function d(){var e=document.body.getBoundingClientRect(),t=x.iframe.getBoundingClientRect();return JSON.stringify({iframeHeight:t.height,iframeWidth:t.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(t.top-e.top,10),offsetLeft:parseInt(t.left-e.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,documentHeight:document.documentElement.clientHeight,documentWidth:document.documentElement.clientWidth,windowHeight:window.innerHeight,windowWidth:window.innerWidth})}function h(e,t){function i(){j("Send Page Info","pageInfo:"+d(),e,t)}K(i,32,t)}function p(){function e(t,i){function n(){if(O[s]){h(O[s].iframe,s)}else{r()}}["scroll","resize"].forEach(function(e){P(s,t+e+" listener for sendPageInfo");i(window,e,n)})}function r(){e("Remove ",q)}function t(){e("Add ",I)}var s=D;t();if(O[s]){O[s].stopPageInfo=r}}function f(){if(O[D]&&O[D].stopPageInfo){O[D].stopPageInfo();delete O[D].stopPageInfo}}function g(){var e=true;if(null===x.iframe){L(D,"IFrame ("+x.id+") not found");e=false}return e}function m(e){var t=e.getBoundingClientRect();$(D);return{x:Math.floor(Number(t.left)+Number(N.x)),y:Math.floor(Number(t.top)+Number(N.y))}}function v(e){function t(){N=s;y();P(D,"--")}function i(){return{x:Number(x.width)+r.x,y:Number(x.height)+r.y}}function n(){if(window.parentIFrame){window.parentIFrame["scrollTo"+(e?"Offset":"")](s.x,s.y)}else{L(D,"Unable to scroll to requested position, window.parentIFrame not found")}}var r=e?m(x.iframe):{x:0,y:0},s=i();P(D,"Reposition requested from iFrame (offset x:"+r.x+" y:"+r.y+")");if(window.top!==window.self){n()}else{t()}}function y(){if(false!==w("onScroll",N)){H(D)}else{B()}}function b(e){function t(){var e=m(s);P(D,"Moving to in page link (#"+n+") at x: "+e.x+" y: "+e.y);N={x:e.x,y:e.y};y();P(D,"--")}function i(){if(window.parentIFrame){window.parentIFrame.moveToAnchor(n)}else{P(D,"In page link #"+n+" not found and window.parentIFrame not found")}}var n=e.split("#")[1]||"",r=decodeURIComponent(n),s=document.getElementById(r)||document.getElementsByName(r)[0];if(s){t()}else if(window.top!==window.self){i()}else{P(D,"In page link #"+n+" not found")}}function C(e){var t={};if(Number(x.width)===0&&Number(x.height)===0){var i=c(9).split(":");t={x:i[1],y:i[0]}}else{t={x:x.width,y:x.height}}w(e,{iframe:x.iframe,screenX:Number(t.x),screenY:Number(t.y),type:x.type})}function w(e,t){return F(D,e,t)}function _(){if(O[D]&&O[D].firstRun)S();switch(x.type){case"close":G(x.iframe);break;case"message":u(c(6));break;case"mouseenter":C("onMouseEnter");break;case"mouseleave":C("onMouseLeave");break;case"autoResize":O[D].autoResize=JSON.parse(c(9));break;case"scrollTo":v(false);break;case"scrollToOffset":v(true);break;case"pageInfo":h(O[D]&&O[D].iframe,D);p();break;case"pageInfoStop":f();break;case"inPageLink":b(c(9));break;case"reset":V(x);break;case"init":e();w("onInit",x.iframe);break;default:if(Number(x.width)===0&&Number(x.height)===0){L("Unsupported message received ("+x.type+"), this is likely due to the iframe containing a later "+"version of iframe-resizer than the parent page")}else{e()}}}function A(e){var t=true;if(!O[e]){t=false;L(x.type+" No settings for "+e+". Message was: "+T)}return t}function E(){for(var e in O){j("iFrame requested init",U(e),O[e].iframe,e)}}function S(){if(O[D]){O[D].firstRun=false}}var T=t.data,x={},D=null;if("[iFrameResizerChild]Ready"===T){E()}else if(a()){x=i();D=x.id;if(O[D]){O[D].loaded=true}if(!l()&&A(D)){P(D,"Received: "+T);if(g()&&o()){_()}}}else{k(D,"Ignored: "+T)}}function F(e,t,i){var n=null,r=null;if(O[e]){n=O[e][t];if("function"===typeof n){r=n(i)}else{throw new TypeError(t+" on iFrame["+e+"] is not a function")}}return r}function _(e){var t=e.id;delete O[t]}function G(e){var t=e.id;if(F(t,"onClose",t)===false){P(t,"Close iframe cancelled by onClose event");return}P(t,"Removing iFrame: "+t);try{if(e.parentNode){e.parentNode.removeChild(e)}}catch(e){L(e)}F(t,"onClosed",t);P(t,"--");_(e)}function $(e){if(null===N){N={x:window.pageXOffset!==v?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==v?window.pageYOffset:document.documentElement.scrollTop};P(e,"Get page position: "+N.x+","+N.y)}}function H(e){if(null!==N){window.scrollTo(N.x,N.y);P(e,"Set page position: "+N.x+","+N.y);B()}}function B(){N=null}function V(e){function t(){W(e);j("reset","reset",e.iframe,e.id)}P(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame"));$(e.id);z(t,e,"reset")}function W(t){function i(e){if(!t.id){P("undefined","messageData id not set");return}t.iframe.style[e]=t[e]+"px";P(t.id,"IFrame ("+r+") "+e+" set to "+t[e]+"px")}function n(e){if(!s&&"0"===t[e]){s=true;P(r,"Hidden iFrame detected, creating visibility listener");m()}}function e(e){i(e);n(e)}var r=t.iframe.id;if(O[r]){if(O[r].sizeHeight){e("height")}if(O[r].sizeWidth){e("width")}}}function z(e,t,i){if(i!==t.type&&n&&!window.jasmine){P(t.id,"Requesting animation frame");n(e)}else{e()}}function j(t,i,n,r,s){function e(){var e=O[r]&&O[r].targetOrigin;P(r,"["+t+"] Sending msg to iframe["+r+"] ("+i+") targetOrigin: "+e);n.contentWindow.postMessage(R+i,e)}function o(){L(r,"["+t+"] IFrame("+r+") not found")}function a(){if(n&&"contentWindow"in n&&null!==n.contentWindow){e()}else{o()}}function l(){function e(){if(O[r]&&!O[r].loaded&&!c){c=true;L(r,"IFrame has not responded within "+O[r].warningTimeout/1e3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ignored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning.")}}if(!!s&&O[r]&&!!O[r].warningTimeout){O[r].msgTimeout=setTimeout(e,O[r].warningTimeout)}}var c=false;r=r||n.id;if(O[r]){a();l()}}function U(e){return e+":"+O[e].bodyMarginV1+":"+O[e].sizeWidth+":"+O[e].log+":"+O[e].interval+":"+O[e].enablePublicMethods+":"+O[e].autoResize+":"+O[e].bodyMargin+":"+O[e].heightCalculationMethod+":"+O[e].bodyBackground+":"+O[e].bodyPadding+":"+O[e].tolerance+":"+O[e].inPageLinks+":"+O[e].resizeFrom+":"+O[e].widthCalculationMethod+":"+O[e].mouseEvents}function E(e){return typeof e==="number"}function a(r,t){function e(){function e(e){var t=O[m][e];if(Infinity!==t&&0!==t){r.style[e]=E(t)?t+"px":t;P(m,"Set "+e+" = "+r.style[e])}}function t(e){if(O[m]["min"+e]>O[m]["max"+e]){throw new Error("Value for min"+e+" can not be greater than max"+e)}}t("Height");t("Width");e("maxHeight");e("minHeight");e("maxWidth");e("minWidth")}function i(){var e=t&&t.id||C.id+y++;if(null!==document.getElementById(e)){e+=y++}return e}function n(e){if(""===e){r.id=e=i();b=(t||{}).log;P(e,"Added missing iframe ID: "+e+" ("+r.src+")")}return e}function s(){P(m,"IFrame scrolling "+(O[m]&&O[m].scrolling?"enabled":"disabled")+" for "+m);r.style.overflow=false===(O[m]&&O[m].scrolling)?"hidden":"auto";switch(O[m]&&O[m].scrolling){case"omit":break;case true:r.scrolling="yes";break;case false:r.scrolling="no";break;default:r.scrolling=O[m]?O[m].scrolling:"no"}}function o(){if("number"===typeof(O[m]&&O[m].bodyMargin)||"0"===(O[m]&&O[m].bodyMargin)){O[m].bodyMarginV1=O[m].bodyMargin;O[m].bodyMargin=""+O[m].bodyMargin+"px"}}function a(){var e=O[m]&&O[m].firstRun,t=O[m]&&O[m].heightCalculationMethod in A;if(!e&&t){V({iframe:r,height:0,width:0,type:"init"})}}function l(){if(O[m]){O[m].iframe.iFrameResizer={close:G.bind(null,O[m].iframe),removeListeners:_.bind(null,O[m].iframe),resize:j.bind(null,"Window resize","resize",O[m].iframe),moveToAnchor:function(e){j("Move to anchor","moveToAnchor:"+e,O[m].iframe,m)},sendMessage:function(e){e=JSON.stringify(e);j("Send Message","message:"+e,O[m].iframe,m)}}}}function c(e){function t(){j("iFrame.onload",e,r,v,true);a()}function i(e){if(!r.parentNode){return}var t=new e(function(e){e.forEach(function(e){var t=Array.prototype.slice.call(e.removedNodes);t.forEach(function(e){if(e===r){G(r)}})})});t.observe(r.parentNode,{childList:true})}var n=w();if(n){i(n)}I(r,"load",t);j("init",e,r,v,true)}function u(e){if("object"!==typeof e){throw new TypeError("Options is not an object")}}function d(e){for(var t in C){if(Object.prototype.hasOwnProperty.call(C,t)){O[m][t]=Object.prototype.hasOwnProperty.call(e,t)?e[t]:C[t]}}}function h(e){return""===e||null!==e.match(/^(about:blank|javascript:|file:\/\/)/)?"*":e}function p(e){var t=e.split("Callback");if(t.length===2){var i="on"+t[0].charAt(0).toUpperCase()+t[0].slice(1);this[i]=this[e];delete this[e];L(m,"Deprecated: '"+e+"' has been renamed '"+i+"'. The old method will be removed in the next major version.")}}function f(e){e=e||{};O[m]={firstRun:true,iframe:r,remoteHost:r.src&&r.src.split("/").slice(0,3).join("/")};u(e);Object.keys(e).forEach(p,e);d(e);if(O[m]){O[m].targetOrigin=true===O[m].checkOrigin?h(O[m].remoteHost):"*"}}function g(){return m in O&&"iFrameResizer"in r}var m=n(r.id);if(!g()){f(t);s();e();o();c(U(m));l()}else{L(m,"Ignored iFrame, already setup.")}}function l(e,t){if(null===i){i=setTimeout(function(){i=null;e()},t)}}var c={};function K(e,t,i){if(!c[i]){c[i]=setTimeout(function(){c[i]=null;e()},t)}}function m(){function t(){function t(t){function e(e){return"0px"===(O[t]&&O[t].iframe.style[e])}function i(e){return null!==e.offsetParent}if(O[t]&&i(O[t].iframe)&&(e("height")||e("width"))){j("Visibility change","resize",O[t].iframe,t)}}Object.keys(O).forEach(function(e){t(e)})}function n(e){P("window","Mutation observed: "+e[0].target+" "+e[0].type);l(t,16)}function e(){var e=document.querySelector("body"),t={attributes:true,attributeOldValue:false,characterData:true,characterDataOldValue:false,childList:true,subtree:true},i=new r(n);i.observe(e,t)}var r=w();if(r){e()}}function S(e){function t(){u("Window "+e,"resize")}P("window","Trigger event: "+e);l(t,16)}function t(){function e(){u("Tab Visable","resize")}if("hidden"!==document.visibilityState){P("document","Trigger event: Visiblity change");l(e,16)}}function u(t,i){function n(e){return O[e]&&"parent"===O[e].resizeFrom&&O[e].autoResize&&!O[e].firstRun}Object.keys(O).forEach(function(e){if(n(e)){j(t,i,O[e].iframe,e)}})}function T(){I(window,"message",g);I(window,"resize",function(){S("resize")});I(document,"visibilitychange",t);I(document,"-webkit-visibilitychange",t)}function d(){function n(e,t){function i(){if(!t.tagName){throw new TypeError("Object is not a valid DOM element")}else if("IFRAME"!==t.tagName.toUpperCase()){throw new TypeError("Expected <IFRAME> tag, found <"+t.tagName+">")}}if(t){i();a(t,e);s.push(t)}}function r(e){if(e&&e.enablePublicMethods){L("enablePublicMethods option has been removed, public methods are now always available in the iFrame")}}var s;h();T();return function e(t,i){s=[];r(t);switch(typeof i){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(i||"iframe"),n.bind(v,t));break;case"object":n(t,i);break;default:throw new TypeError("Unexpected data type ("+typeof i+")")}return s}}function x(e){if(!e.fn){k("","Unable to bind to jQuery, it is not fully loaded.")}else if(!e.fn.iFrameResize){e.fn.iFrameResize=function e(i){function t(e,t){a(t,i)}return this.filter("iframe").each(t).end()}}}if(window.jQuery){x(window.jQuery)}if(typeof define==="function"&&define.amd){define([],d)}else if(typeof module==="object"&&typeof module.exports==="object"){module.exports=d()}window.iFrameResize=window.iFrameResize||d()})();!function(de){function he(e){var t=document.createElement("input"),i="on"+e,n=i in t;return n||(t.setAttribute(i,"return;"),n="function"==typeof t[i]),t=null,n}function pe(e){var t="text"==e||"tel"==e||"password"==e;if(!t){var i=document.createElement("input");i.setAttribute("type",e),t="text"===i.type,i=null}return t}function o(e,t,i){var n=i.aliases[e];return n?(n.alias&&o(n.alias,void 0,i),de.extend(!0,i,n),de.extend(!0,i,t),!0):!1}function a(w,r){function s(e){function t(e,t,i,n){this.matches=[],this.isGroup=e||!1,this.isOptional=t||!1,this.isQuantifier=i||!1,this.isAlternator=n||!1,this.quantifier={min:1,max:1}}function i(e,t,i){var n=w.definitions[t],r=0==e.matches.length;if(i=void 0!=i?i:e.matches.length,n&&!d){n.placeholder=de.isFunction(n.placeholder)?n.placeholder.call(this,w):n.placeholder;for(var s=n.prevalidator,o=s?s.length:0,a=1;a<n.cardinality;a++){var l=o>=a?s[a-1]:[],c=l.validator,u=l.cardinality;e.matches.splice(i++,0,{fn:c?"string"==typeof c?new RegExp(c):new function(){this.test=c}:new RegExp("."),cardinality:u?u:1,optionality:e.isOptional,newBlockMarker:r,casing:n.casing,def:n.definitionSymbol||t,placeholder:n.placeholder,mask:t})}e.matches.splice(i++,0,{fn:n.validator?"string"==typeof n.validator?new RegExp(n.validator):new function(){this.test=n.validator}:new RegExp("."),cardinality:n.cardinality,optionality:e.isOptional,newBlockMarker:r,casing:n.casing,def:n.definitionSymbol||t,placeholder:n.placeholder,mask:t})}else e.matches.splice(i++,0,{fn:null,cardinality:0,optionality:e.isOptional,newBlockMarker:r,casing:null,def:t,placeholder:void 0,mask:t}),d=!1}for(var n,r,s,o,a,l,c=/(?:[?*+]|\{[0-9\+\*]+(?:,[0-9\+\*]*)?\})\??|[^.?*+^${[]()|\\]+|./g,d=!1,u=new t,h=[],p=[];n=c.exec(e);)switch(r=n[0],r.charAt(0)){case w.optionalmarker.end:case w.groupmarker.end:if(s=h.pop(),h.length>0){if(o=h[h.length-1],o.matches.push(s),o.isAlternator){a=h.pop();for(var f=0;f<a.matches.length;f++)a.matches[f].isGroup=!1;h.length>0?(o=h[h.length-1],o.matches.push(a)):u.matches.push(a)}}else u.matches.push(s);break;case w.optionalmarker.start:h.push(new t(!1,!0));break;case w.groupmarker.start:h.push(new t(!0));break;case w.quantifiermarker.start:var g=new t(!1,!1,!0);r=r.replace(/[{}]/g,"");var m=r.split(","),v=isNaN(m[0])?m[0]:parseInt(m[0]),y=1==m.length?v:isNaN(m[1])?m[1]:parseInt(m[1]);if(("*"==y||"+"==y)&&(v="*"==y?0:1),g.quantifier={min:v,max:y},h.length>0){var b=h[h.length-1].matches;if(n=b.pop(),!n.isGroup){var C=new t(!0);C.matches.push(n),n=C}b.push(n),b.push(g)}else{if(n=u.matches.pop(),!n.isGroup){var C=new t(!0);C.matches.push(n),n=C}u.matches.push(n),u.matches.push(g)}break;case w.escapeChar:d=!0;break;case w.alternatormarker:h.length>0?(o=h[h.length-1],l=o.matches.pop()):l=u.matches.pop(),l.isAlternator?h.push(l):(a=new t(!1,!1,!1,!0),a.matches.push(l),h.push(a));break;default:if(h.length>0){if(o=h[h.length-1],o.matches.length>0&&!o.isAlternator&&(l=o.matches[o.matches.length-1],l.isGroup&&(l.isGroup=!1,i(l,w.groupmarker.start,0),i(l,w.groupmarker.end))),i(o,r),o.isAlternator){a=h.pop();for(var f=0;f<a.matches.length;f++)a.matches[f].isGroup=!1;h.length>0?(o=h[h.length-1],o.matches.push(a)):u.matches.push(a)}}else u.matches.length>0&&(l=u.matches[u.matches.length-1],l.isGroup&&(l.isGroup=!1,i(l,w.groupmarker.start,0),i(l,w.groupmarker.end))),i(u,r)}return u.matches.length>0&&(l=u.matches[u.matches.length-1],l.isGroup&&(l.isGroup=!1,i(l,w.groupmarker.start,0),i(l,w.groupmarker.end)),p.push(u)),p}function e(e,t){if(void 0==e||""==e)return void 0;if(1==e.length&&0==w.greedy&&0!=w.repeat&&(w.placeholder=""),w.repeat>0||"*"==w.repeat||"+"==w.repeat){var i="*"==w.repeat?0:"+"==w.repeat?1:w.repeat;e=w.groupmarker.start+e+w.groupmarker.end+w.quantifiermarker.start+i+","+w.repeat+w.quantifiermarker.end}var n;return void 0==de.inputmask.masksCache[e]||r===!0?(n={mask:e,maskToken:s(e),validPositions:{},_buffer:void 0,buffer:void 0,tests:{},metadata:t},r!==!0&&(de.inputmask.masksCache[e]=n)):n=de.extend(!0,{},de.inputmask.masksCache[e]),n}function i(e){if(e=e.toString(),w.numericInput){e=e.split("").reverse();for(var t=0;t<e.length;t++)e[t]==w.optionalmarker.start?e[t]=w.optionalmarker.end:e[t]==w.optionalmarker.end?e[t]=w.optionalmarker.start:e[t]==w.groupmarker.start?e[t]=w.groupmarker.end:e[t]==w.groupmarker.end&&(e[t]=w.groupmarker.start);e=e.join("")}return e}var t=void 0;if(de.isFunction(w.mask)&&(w.mask=w.mask.call(this,w)),de.isArray(w.mask)){if(w.mask.length>1){w.keepStatic=void 0==w.keepStatic?!0:w.keepStatic;var n="(";return de.each(w.mask,function(e,t){n.length>1&&(n+=")|("),n+=i(void 0==t.mask||de.isFunction(t.mask)?t:t.mask)}),n+=")",e(n,w.mask)}w.mask=w.mask.pop()}return w.mask&&(t=void 0==w.mask.mask||de.isFunction(w.mask.mask)?e(i(w.mask),w.mask):e(i(w.mask.mask),w.mask)),t}function l(e,s,_){function L(e,t,i){t=t||0;var n,r,s,o=[],a=0;do{if(e===!0&&P().validPositions[a]){var l=P().validPositions[a];r=l.match,n=l.locator.slice(),o.push(i===!0?l.input:y(a,r))}else s=S(a,n,a-1),r=s.match,n=s.locator.slice(),o.push(y(a,r));a++}while((void 0==d||d>a-1)&&null!=r.fn||null==r.fn&&""!=r.def||t>=a);return o.pop(),o}function P(){return s}function A(e){var t=P();t.buffer=void 0,t.tests={},e!==!0&&(t._buffer=void 0,t.validPositions={},t.p=0)}function E(e,t){var i=P(),n=-1,r=i.validPositions;void 0==e&&(e=-1);var s=n,o=n;for(var a in r){var l=parseInt(a);r[l]&&(t||null!=r[l].match.fn)&&(e>=l&&(s=l),l>=e&&(o=l))}return n=-1!=s&&e-s>1||e>o?s:o}function b(e,t,i){if(_.insertMode&&void 0!=P().validPositions[e]&&void 0==i){var n,r=de.extend(!0,{},P().validPositions),s=E();for(n=e;s>=n;n++)delete P().validPositions[n];P().validPositions[e]=t;var o,a=!0,l=P().validPositions;for(n=o=e;s>=n;n++){var c=r[n];if(void 0!=c)for(var u=o,d=-1;u<v()&&(null==c.match.fn&&l[n]&&(l[n].match.optionalQuantifier===!0||l[n].match.optionality===!0)||null!=c.match.fn);){if(null==c.match.fn||!_.keepStatic&&l[n]&&(void 0!=l[n+1]&&C(n+1,l[n].locator.slice(),n).length>1||void 0!=l[n].alternation)?u++:u=D(o),$(u,c.match.def)){a=x(u,c.input,!0,!0)!==!1,o=u;break}if(a=null==c.match.fn,d==u)break;d=u}if(!a)break}if(!a)return P().validPositions=de.extend(!0,{},r),!1}else P().validPositions[e]=t;return!0}function F(e,t,i,n){var r,s=e;P().p=e,void 0!=P().validPositions[e]&&P().validPositions[e].input==_.radixPoint&&(t++,s++);for(r=s;t>r;r++)void 0!=P().validPositions[r]&&(i===!0||0!=_.canClearPosition(P(),r,E(),n,_))&&delete P().validPositions[r];for(A(!0),r=s+1;r<=E();){for(;void 0!=P().validPositions[s];)s++;var o=P().validPositions[s];s>r&&(r=s+1);var a=P().validPositions[r];void 0!=a&&void 0==o?($(s,a.match.def)&&x(s,a.input,!0)!==!1&&(delete P().validPositions[r],r++),s++):r++}var l=E(),c=v();for(l>=e&&void 0!=P().validPositions[l]&&P().validPositions[l].input==_.radixPoint&&delete P().validPositions[l],r=l+1;c>=r;r++)P().validPositions[r]&&delete P().validPositions[r];A(!0)}function S(e,t,i){var n=P().validPositions[e];if(void 0==n)for(var r=C(e,t,i),s=E(),o=P().validPositions[s]||C(0)[0],a=void 0!=o.alternation?o.locator[o.alternation].toString().split(","):[],l=0;l<r.length&&(n=r[l],!(n.match&&(_.greedy&&n.match.optionalQuantifier!==!0||(n.match.optionality===!1||n.match.newBlockMarker===!1)&&n.match.optionalQuantifier!==!0)&&(void 0==o.alternation||o.alternation!=n.alternation||void 0!=n.locator[o.alternation]&&B(n.locator[o.alternation].toString().split(","),a))));l++);return n}function G(e){return P().validPositions[e]?P().validPositions[e].match:C(e)[0].match}function $(e,t){for(var i=!1,n=C(e),r=0;r<n.length;r++)if(n[r].match&&n[r].match.def==t){i=!0;break}return i}function C(R,e,t,i){function M(S,T,e,t){function x(e,i,t){if(N>1e4)return alert("jquery.inputmask: There is probably an error in your mask definition or in the code. Create an issue on github with an example of the mask you are using. "+P().mask),!0;if(N==R&&void 0==e.matches)return O.push({match:e,locator:i.reverse()}),!0;if(void 0!=e.matches){if(e.isGroup&&t!==!0){if(e=x(S.matches[D+1],i))return!0}else if(e.isOptional){var n=e;if(e=M(e,T,i,t)){var r=O[O.length-1].match,s=0==de.inArray(r,n.matches);if(!s)return!0;I=!0,N=R}}else if(e.isAlternator){var o,a=e,l=[],c=O.slice(),u=i.length,d=T.length>0?T.shift():-1;if(-1==d||"string"==typeof d){var h=N,p=T.slice(),f=[];"string"==typeof d&&(f=d.split(","));for(var g=0;g<a.matches.length;g++){if(O=[],e=x(a.matches[g],[g].concat(i),t)||e,e!==!0&&void 0!=e&&f[f.length-1]<a.matches.length){var m=S.matches.indexOf(e)+1;S.matches.length>m&&(e=x(S.matches[m],[m].concat(i.slice(1,i.length)),t),e&&(f.push(m.toString()),de.each(O,function(e,t){t.alternation=i.length-1})))}o=O.slice(),N=h,O=[];for(var v=0;v<p.length;v++)T[v]=p[v];for(var y=0;y<o.length;y++){var b=o[y];b.alternation=b.alternation||u;for(var C=0;C<l.length;C++){var w=l[C];if(b.match.mask==w.match.mask&&("string"!=typeof d||-1!=de.inArray(b.locator[b.alternation].toString(),f))){o.splice(y,1),y--,w.locator[b.alternation]=w.locator[b.alternation]+","+b.locator[b.alternation],w.alternation=b.alternation;break}}}l=l.concat(o)}"string"==typeof d&&(l=de.map(l,function(e,t){if(isFinite(t)){var i,n=e.alternation,r=e.locator[n].toString().split(",");e.locator[n]=void 0,e.alternation=void 0;for(var s=0;s<r.length;s++)i=-1!=de.inArray(r[s],f),i&&(void 0!=e.locator[n]?(e.locator[n]+=",",e.locator[n]+=r[s]):e.locator[n]=parseInt(r[s]),e.alternation=n);if(void 0!=e.locator[n])return e}})),O=c.concat(l),N=R,I=O.length>0}else e=a.matches[d]?x(a.matches[d],[d].concat(i),t):!1;if(e)return!0}else if(e.isQuantifier&&t!==!0)for(var _=e,A=T.length>0&&t!==!0?T.shift():0;A<(isNaN(_.quantifier.max)?A+1:_.quantifier.max)&&R>=N;A++){var E=S.matches[de.inArray(_,S.matches)-1];if(e=x(E,[A].concat(i),!0)){var r=O[O.length-1].match;r.optionalQuantifier=A>_.quantifier.min-1;var s=0==de.inArray(r,E.matches);if(s){if(A>_.quantifier.min-1){I=!0,N=R;break}return!0}return!0}}else if(e=M(e,T,i,t))return!0}else N++}for(var D=T.length>0?T.shift():0;D<S.matches.length;D++)if(S.matches[D].isQuantifier!==!0){var i=x(S.matches[D],[D].concat(e),t);if(i&&N==R)return i;if(N>R)break}}var n=P().maskToken,N=e?t:0,r=e||[0],O=[],I=!1;if(i===!0&&P().tests[R])return P().tests[R];if(void 0==e){for(var s,o=R-1;void 0==(s=P().validPositions[o])&&o>-1&&(!P().tests[o]||void 0==(s=P().tests[o][0]));)o--;void 0!=s&&o>-1&&(N=o,r=s.locator.slice())}for(var a=r.shift();a<n.length;a++){var l=M(n[a],r,[a]);if(l&&N==R||N>R)break}return(0==O.length||I)&&O.push({match:{fn:null,cardinality:0,optionality:!0,casing:null,def:""},locator:[]}),P().tests[R]=de.extend(!0,[],O),P().tests[R]}function h(){return void 0==P()._buffer&&(P()._buffer=L(!1,1)),P()._buffer}function w(){return void 0==P().buffer&&(P().buffer=L(!0,E(),!0)),P().buffer}function T(e,t,i){if(i=i||w().slice(),e===!0)A(),e=0,t=i.length;else for(var n=e;t>n;n++)delete P().validPositions[n],delete P().tests[n];for(var n=e;t>n;n++)i[n]!=_.skipOptionalPartCharacter&&x(n,i[n],!0,!0)}function H(e,t){switch(t.casing){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e}function B(e,t){for(var i=_.greedy?t:t.slice(0,1),n=!1,r=0;r<e.length;r++)if(-1!=de.inArray(e[r],i)){n=!0;break}return n}function x(e,t,i,n){function r(u,d,h,p){var f=!1;return de.each(C(u),function(e,t){for(var i=t.match,n=d?1:0,r="",s=(w(),i.cardinality);s>n;s--)r+=V(u-(s-1));if(d&&(r+=d),f=null!=i.fn?i.fn.test(r,P(),u,h,_):d!=i.def&&d!=_.skipOptionalPartCharacter||""==i.def?!1:{c:i.def,pos:u},f!==!1){var o=void 0!=f.c?f.c:d;o=o==_.skipOptionalPartCharacter&&null===i.fn?i.def:o;var a=u,l=w();if(void 0!=f.remove&&(de.isArray(f.remove)||(f.remove=[f.remove]),de.each(f.remove.sort(function(e,t){return t-e}),function(e,t){F(t,t+1,!0)})),void 0!=f.insert&&(de.isArray(f.insert)||(f.insert=[f.insert]),de.each(f.insert.sort(function(e,t){return e-t}),function(e,t){x(t.pos,t.c,!0)})),f.refreshFromBuffer){var c=f.refreshFromBuffer;if(h=!0,T(c===!0?c:c.start,c.end,l),void 0==f.pos&&void 0==f.c)return f.pos=E(),!1;if(a=void 0!=f.pos?f.pos:u,a!=u)return f=de.extend(f,x(a,o,!0)),!1}else if(f!==!0&&void 0!=f.pos&&f.pos!=u&&(a=f.pos,T(u,a),a!=u))return f=de.extend(f,x(a,o,!0)),!1;return 1!=f&&void 0==f.pos&&void 0==f.c?!1:(e>0&&A(!0),b(a,de.extend({},t,{input:H(o,i)}),p)||(f=!1),!1)}}),f}function s(e,t,i,n){for(var r,s,o,a,l=de.extend(!0,{},P().validPositions),c=E();c>=0&&(a=P().validPositions[c],!a||void 0==a.alternation||(r=c,s=P().validPositions[r].alternation,S(r).locator[a.alternation]==a.locator[a.alternation]));c--);if(void 0!=s)for(var u in P().validPositions)if(a=P().validPositions[u],parseInt(u)>parseInt(r)&&void 0!=a.alternation){var d=P().validPositions[r].locator[s].toString().split(","),h=a.locator[s]||d[0];h.length>0&&(h=h.split(",")[0]);for(var p=0;p<d.length;p++)if(h<d[p]){for(var f,g,m=u-1;m>=0;m--)if(f=P().validPositions[m],void 0!=f){g=f.locator[s],f.locator[s]=parseInt(d[p]);break}if(h!=f.locator[s]){for(var v=[],y=u;y<E()+1;y++){var b=P().validPositions[y];b&&null!=b.match.fn&&v.push(b.input),delete P().validPositions[y],delete P().tests[y]}for(A(!0),_.keepStatic=!_.keepStatic,o=!0;v.length>0;){var C=v.shift();if(C!=_.skipOptionalPartCharacter&&!(o=x(E()+1,C,!1,!0)))break}if(f.alternation=s,f.locator[s]=g,o){var w=E(e)+1;o=x(e>w?w:e,t,i,n)}if(_.keepStatic=!_.keepStatic,o)return o;A(),P().validPositions=de.extend(!0,{},l)}}break}return!1}function o(e,t){for(var i=P().validPositions[t],n=i.locator,r=n.length,s=e;t>s;s++)if(!m(s)){var o=C(s),a=o[0],l=-1;de.each(o,function(e,t){for(var i=0;r>i;i++)t.locator[i]&&B(t.locator[i].toString().split(","),n[i].toString().split(","))&&i>l&&(l=i,a=t)}),b(s,de.extend({},a,{input:a.match.def}),!0)}}i=i===!0;for(var a=w(),l=e-1;l>-1&&!P().validPositions[l];l--);for(l++;e>l;l++)void 0==P().validPositions[l]&&((!m(l)||a[l]!=y(l))&&C(l).length>1||a[l]==_.radixPoint||"0"==a[l]&&de.inArray(_.radixPoint,a)<l)&&r(l,a[l],!0);var c=e,u=!1,d=de.extend(!0,{},P().validPositions);if(c<v()&&(u=r(c,t,i,n),(!i||n)&&u===!1)){var h=P().validPositions[c];if(!h||null!=h.match.fn||h.match.def!=t&&t!=_.skipOptionalPartCharacter){if((_.insertMode||void 0==P().validPositions[D(c)])&&!m(c))for(var p=c+1,f=D(c);f>=p;p++)if(u=r(p,t,i,n),u!==!1){o(c,p),c=p;break}}else u={caret:D(c)}}if(u===!1&&_.keepStatic&&O(a)&&(u=s(e,t,i,n)),u===!0&&(u={pos:c}),de.isFunction(_.postValidation)&&0!=u&&!i){A(!0);var g=_.postValidation(w(),_);if(!g)return A(!0),P().validPositions=de.extend(!0,{},d),!1}return u}function m(e){var t=G(e);if(null!=t.fn)return t.fn;if(!_.keepStatic&&void 0==P().validPositions[e]){for(var i=C(e),n=!0,r=0;r<i.length;r++)if(""!=i[r].match.def&&(void 0==i[r].alternation||i[r].locator[i[r].alternation].length>1)){n=!1;break}return n}return!1}function v(){var e;d=u.prop("maxLength"),-1==d&&(d=void 0);var t,i=E(),n=P().validPositions[i],r=void 0!=n?n.locator.slice():void 0;for(t=i+1;void 0==n||null!=n.match.fn||null==n.match.fn&&""!=n.match.def;t++)n=S(t,r,t-1),r=n.locator.slice();var s=G(t-1);return e=""!=s.def?t:t-1,void 0==d||d>e?e:d}function D(e){var t=v();if(e>=t)return t;for(var i=e;++i<t&&!m(i)&&(_.nojumps!==!0||_.nojumpsThreshold>i););return i}function R(e){var t=e;if(0>=t)return 0;for(;--t>0&&!m(t););return t}function V(e){return void 0==P().validPositions[e]?y(e):P().validPositions[e].input}function M(e,t,i,n,r){if(n&&de.isFunction(_.onBeforeWrite)){var s=_.onBeforeWrite.call(e,n,t,i,_);if(s){if(s.refreshFromBuffer){var o=s.refreshFromBuffer;T(o===!0?o:o.start,o.end,s.buffer),A(!0),t=w()}i=s.caret||i}}e._valueSet(t.join("")),void 0!=i&&N(e,i),r===!0&&(g=!0,de(e).trigger("input"))}function y(e,t){if(t=t||G(e),void 0!=t.placeholder)return t.placeholder;if(null==t.fn){if(!_.keepStatic&&void 0==P().validPositions[e]){for(var i=C(e),n=!0,r=0;r<i.length;r++)if(""!=i[r].match.def&&(null!==i[r].match.fn||void 0==i[r].alternation||i[r].locator[i[r].alternation].length>1)){n=!1;break}if(n)return _.placeholder.charAt(e%_.placeholder.length)}return t.def}return _.placeholder.charAt(e%_.placeholder.length)}function l(a,e,l,t){function c(){var e=!1,t=h().slice(d,D(d)).join("").indexOf(u);if(-1!=t&&!m(d)){e=!0;for(var i=h().slice(d,d+t),n=0;n<i.length;n++)if(" "!=i[n]){e=!1;break}}return e}var i=void 0!=t?t.slice():a._valueGet().split(""),u="",d=0;if(A(),P().p=D(-1),e&&a._valueSet(""),!l){var n=h().slice(0,D(-1)).join(""),r=i.join("").match(new RegExp("^"+W(n),"g"));r&&r.length>0&&(i.splice(0,r.length*n.length),d=D(d))}de.each(i,function(e,t){var i=de.Event("keypress");i.which=t.charCodeAt(0),u+=t;var n=E(void 0,!0),r=P().validPositions[n],s=S(n+1,r?r.locator.slice():void 0,n);if(!c()||l){var o=l?e:null==s.match.fn&&s.match.optionality&&n+1<P().p?n+1:P().p;p.call(a,i,!0,!1,l,o),d=o+1,u=""}else p.call(a,i,!0,!1,!0,n+1)}),e&&M(a,w(),de(a).is(":focus")?D(E(0)):void 0,de.Event("checkval"))}function W(e){return de.inputmask.escapeRegex(e)}function z(e){if(e.data("_inputmask")&&!e.hasClass("hasDatepicker")){var t=[],i=P().validPositions;for(var n in i)i[n].match&&null!=i[n].match.fn&&t.push(i[n].input);var r=(I?t.reverse():t).join(""),s=(I?w().slice().reverse():w()).join("");return de.isFunction(_.onUnMask)&&(r=_.onUnMask.call(e,s,r,_)||r),r}return e[0]._valueGet()}function c(e){if(I&&"number"==typeof e&&(!_.greedy||""!=_.placeholder)){var t=w().length;e=t-e}return e}function N(e,t,i){var n,r=e.jquery&&e.length>0?e[0]:e;if("number"!=typeof t)return r.setSelectionRange?(t=r.selectionStart,i=r.selectionEnd):window.getSelection?(n=window.getSelection().getRangeAt(0),(n.commonAncestorContainer.parentNode==r||n.commonAncestorContainer==r)&&(t=n.startOffset,i=n.endOffset)):document.selection&&document.selection.createRange&&(n=document.selection.createRange(),t=0-n.duplicate().moveStart("character",-1e5),i=t+n.text.length),{begin:c(t),end:c(i)};if(t=c(t),i=c(i),i="number"==typeof i?i:t,de(r).is(":visible")){var s=de(r).css("font-size").replace("px","")*i;if(r.scrollLeft=s>r.scrollWidth?s:0,ge||0!=_.insertMode||t!=i||i++,r.setSelectionRange)r.selectionStart=t,r.selectionEnd=i;else if(window.getSelection){if(n=document.createRange(),void 0==r.firstChild){var o=document.createTextNode("");r.appendChild(o)}n.setStart(r.firstChild,t<r._valueGet().length?t:r._valueGet().length),n.setEnd(r.firstChild,i<r._valueGet().length?i:r._valueGet().length),n.collapse(!0);var a=window.getSelection();a.removeAllRanges(),a.addRange(n)}else r.createTextRange&&(n=r.createTextRange(),n.collapse(!0),n.moveEnd("character",i),n.moveStart("character",t),n.select())}}function j(e){var t,i,n=w(),r=n.length,s=E(),o={},a=P().validPositions[s],l=void 0!=a?a.locator.slice():void 0;for(t=s+1;t<n.length;t++)i=S(t,l,t-1),l=i.locator.slice(),o[t]=de.extend(!0,{},i);var c=a&&void 0!=a.alternation?a.locator[a.alternation]:void 0;for(t=r-1;t>s&&(i=o[t],(i.match.optionality||i.match.optionalQuantifier||c&&(c!=o[t].locator[a.alternation]&&null!=i.match.fn||null==i.match.fn&&i.locator[a.alternation]&&B(i.locator[a.alternation].toString().split(","),c.split(","))&&""!=C(t)[0].def))&&n[t]==y(t,i.match));t--)r--;return e?{l:r,def:o[r]?o[r].match:void 0}:r}function U(e){for(var t=j(),i=e.length-1;i>t&&!m(i);i--);return e.splice(t,i+1-t),e}function O(e){if(de.isFunction(_.isComplete))return _.isComplete.call(u,e,_);if("*"==_.repeat)return void 0;{var t=!1,i=j(!0),n=R(i.l);E()}if(void 0==i.def||i.def.newBlockMarker||i.def.optionality||i.def.optionalQuantifier){t=!0;for(var r=0;n>=r;r++){var s=S(r).match;if(null!=s.fn&&void 0==P().validPositions[r]&&s.optionality!==!0&&s.optionalQuantifier!==!0||null==s.fn&&e[r]!=y(r,s)){t=!1;break}}}return t}function Y(e,t){return I?e-t>1||e-t==1&&_.insertMode:t-e>1||t-e==1&&_.insertMode}function q(e){var t=de._data(e).events,n=!1;de.each(t,function(e,t){de.each(t,function(e,t){if("inputmask"==t.namespace&&"setvalue"!=t.type){var i=t.handler;t.handler=function(e){if(!(this.disabled||this.readOnly&&!("keydown"==e.type&&e.ctrlKey&&67==e.keyCode||e.keyCode==de.inputmask.keyCode.TAB))){switch(e.type){case"input":if(g===!0||n===!0)return g=!1,e.preventDefault();break;case"keydown":f=!1,n=!1;break;case"keypress":if(f===!0)return e.preventDefault();f=!0;break;case"compositionstart":n=!0;break;case"compositionupdate":g=!0;break;case"compositionend":n=!1}return i.apply(this,arguments)}e.preventDefault()}}})})}function K(t){function e(e){if(void 0==de.valHooks[e]||1!=de.valHooks[e].inputmaskpatch){var o=de.valHooks[e]&&de.valHooks[e].get?de.valHooks[e].get:function(e){return e.value},s=de.valHooks[e]&&de.valHooks[e].set?de.valHooks[e].set:function(e,t){return e.value=t,e};de.valHooks[e]={get:function(e){var t=de(e);if(t.data("_inputmask")){if(t.data("_inputmask").opts.autoUnmask)return t.inputmask("unmaskedvalue");var i=o(e),n=t.data("_inputmask"),r=n.maskset,s=r._buffer;return s=s?s.join(""):"",i!=s?i:""}return o(e)},set:function(e,t){var i,n=de(e),r=n.data("_inputmask");return i=s(e,t),r&&n.triggerHandler("setvalue.inputmask"),i},inputmaskpatch:!0}}}function i(){var e=de(this),t=de(this).data("_inputmask");return t?t.opts.autoUnmask?e.inputmask("unmaskedvalue"):s.call(this)!=h().join("")?s.call(this):"":s.call(this)}function n(e){var t=de(this).data("_inputmask");o.call(this,e),t&&de(this).triggerHandler("setvalue.inputmask")}function r(e){de(e).bind("mouseenter.inputmask",function(e){var t=de(this),i=this,n=i._valueGet();""!=n&&n!=w().join("")&&t.triggerHandler("setvalue.inputmask")});var t=de._data(e).events,i=t.mouseover;if(i){for(var n=i[i.length-1],r=i.length-1;r>0;r--)i[r]=i[r-1];i[0]=n}}var s,o;if(!t._valueGet){var a;Object.getOwnPropertyDescriptor&&void 0==t.value?(s=function(){return this.textContent},o=function(e){this.textContent=e},Object.defineProperty(t,"value",{get:i,set:n})):((a=Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(t,"value"))&&a.configurable,document.__lookupGetter__&&t.__lookupGetter__("value")?(s=t.__lookupGetter__("value"),o=t.__lookupSetter__("value"),t.__defineGetter__("value",i),t.__defineSetter__("value",n)):(s=function(){return t.value},o=function(e){t.value=e},e(t.type),r(t))),t._valueGet=function(e){return I&&e!==!0?s.call(this).split("").reverse().join(""):s.call(this)},t._valueSet=function(e){o.call(this,I?e.split("").reverse().join(""):e)}}}function X(s,e,t,i){function n(){if(_.keepStatic){A(!0);var e,t=[],i=de.extend(!0,{},P().validPositions);for(e=E();e>=0;e--){var n=P().validPositions[e];if(n){if(void 0!=n.alternation&&n.locator[n.alternation]==S(e).locator[n.alternation])break;null!=n.match.fn&&t.push(n.input),delete P().validPositions[e]}}if(e>0)for(;t.length>0;){P().p=D(E());var r=de.Event("keypress");r.which=t.pop().charCodeAt(0),p.call(s,r,!0,!1,!1,P().p)}else P().validPositions=de.extend(!0,{},i)}}if((_.numericInput||I)&&(e==de.inputmask.keyCode.BACKSPACE?e=de.inputmask.keyCode.DELETE:e==de.inputmask.keyCode.DELETE&&(e=de.inputmask.keyCode.BACKSPACE),I)){var r=t.end;t.end=t.begin,t.begin=r}if(e==de.inputmask.keyCode.BACKSPACE&&(t.end-t.begin<1||0==_.insertMode)?t.begin=R(t.begin):e==de.inputmask.keyCode.DELETE&&t.begin==t.end&&(t.end=m(t.end)?t.end+1:D(t.end)+1),F(t.begin,t.end,!1,i),i!==!0){n();var o=E(t.begin);o<t.begin?(-1==o&&A(),P().p=D(o)):P().p=t.begin}}function Q(t){var i=this,e=de(i),n=t.keyCode,r=N(i);n==de.inputmask.keyCode.BACKSPACE||n==de.inputmask.keyCode.DELETE||fe&&127==n||t.ctrlKey&&88==n&&!he("cut")?(t.preventDefault(),88==n&&(o=w().join("")),X(i,n,r),M(i,w(),P().p,t,o!=w().join("")),i._valueGet()==h().join("")?e.trigger("cleared"):O(w())===!0&&e.trigger("complete"),_.showTooltip&&e.prop("title",P().mask)):n==de.inputmask.keyCode.END||n==de.inputmask.keyCode.PAGE_DOWN?setTimeout(function(){var e=D(E());_.insertMode||e!=v()||t.shiftKey||e--,N(i,t.shiftKey?r.begin:e,e)},0):n==de.inputmask.keyCode.HOME&&!t.shiftKey||n==de.inputmask.keyCode.PAGE_UP?N(i,0,t.shiftKey?r.begin:0):(_.undoOnEscape&&n==de.inputmask.keyCode.ESCAPE||90==n&&t.ctrlKey)&&t.altKey!==!0?(l(i,!0,!1,o.split("")),e.click()):n!=de.inputmask.keyCode.INSERT||t.shiftKey||t.ctrlKey?0!=_.insertMode||t.shiftKey||(n==de.inputmask.keyCode.RIGHT?setTimeout(function(){var e=N(i);N(i,e.begin)},0):n==de.inputmask.keyCode.LEFT&&setTimeout(function(){var e=N(i);N(i,I?e.begin+1:e.begin-1)},0)):(_.insertMode=!_.insertMode,N(i,_.insertMode||r.begin!=v()?r.begin:r.begin-1)),_.onKeyDown.call(this,t,w(),N(i).begin,_),se=-1!=de.inArray(n,_.ignorables)}function p(e,t,i,n,r){var s=this,o=de(s),a=e.which||e.charCode||e.keyCode;if(!(t===!0||e.ctrlKey&&e.altKey)&&(e.ctrlKey||e.metaKey||se))return!0;if(a){46==a&&0==e.shiftKey&&","==_.radixPoint&&(a=44);var l,c=t?{begin:r,end:r}:N(s),u=String.fromCharCode(a),d=Y(c.begin,c.end);d&&(P().undoPositions=de.extend(!0,{},P().validPositions),X(s,de.inputmask.keyCode.DELETE,c,!0),c.begin=P().p,_.insertMode||(_.insertMode=!_.insertMode,b(c.begin,n),_.insertMode=!_.insertMode),d=!_.multi),P().writeOutBuffer=!0;var h=I&&!d?c.end:c.begin,p=x(h,u,n);if(p!==!1){if(p!==!0&&(h=void 0!=p.pos?p.pos:h,u=void 0!=p.c?p.c:u),A(!0),void 0!=p.caret)l=p.caret;else{var f=P().validPositions;l=!_.keepStatic&&(void 0!=f[h+1]&&C(h+1,f[h].locator.slice(),h).length>1||void 0!=f[h].alternation)?h+1:D(h)}P().p=l}if(i!==!1){var g=this;if(setTimeout(function(){_.onKeyValidation.call(g,p,_)},0),P().writeOutBuffer&&p!==!1){var m=w();M(s,m,t?void 0:_.numericInput?R(l):l,e,t!==!0),t!==!0&&setTimeout(function(){O(m)===!0&&o.trigger("complete")},0)}else d&&(P().buffer=void 0,P().validPositions=P().undoPositions)}else d&&(P().buffer=void 0,P().validPositions=P().undoPositions);if(_.showTooltip&&o.prop("title",P().mask),t&&de.isFunction(_.onBeforeWrite)){var v=_.onBeforeWrite.call(this,e,w(),l,_);if(v&&v.refreshFromBuffer){var y=v.refreshFromBuffer;T(y===!0?y:y.start,y.end,v.buffer),A(!0),v.caret&&(P().p=v.caret)}}e.preventDefault()}}function Z(e){var t=this,i=de(t),n=t._valueGet(!0),r=N(t);if("propertychange"==e.type&&t._valueGet().length<=v())return!0;if("paste"==e.type){var s=n.substr(0,r.begin),o=n.substr(r.end,n.length);s==h().slice(0,r.begin).join("")&&(s=""),o==h().slice(r.end).join("")&&(o=""),window.clipboardData&&window.clipboardData.getData?n=s+window.clipboardData.getData("Text")+o:e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.getData&&(n=s+e.originalEvent.clipboardData.getData("text/plain")+o)}var a=n;if(de.isFunction(_.onBeforePaste)){if(a=_.onBeforePaste.call(t,n,_),a===!1)return e.preventDefault(),!1;a||(a=n)}return l(t,!0,!1,I?a.split("").reverse():a.split("")),i.click(),O(w())===!0&&i.trigger("complete"),!1}function J(e){var t=this;l(t,!0,!1),O(w())===!0&&de(t).trigger("complete"),e.preventDefault()}function ee(e){var t=this;o=w().join(""),(""==a||0!=e.originalEvent.data.indexOf(a))&&(re=N(t))}function te(e){var t=this,i=re||N(t);0==e.originalEvent.data.indexOf(a)&&(A(),i={begin:0,end:0});var n=e.originalEvent.data;N(t,i.begin,i.end);for(var r=0;r<n.length;r++){var s=de.Event("keypress");s.which=n.charCodeAt(r),f=!1,se=!1,p.call(t,s)}setTimeout(function(){var e=P().p;M(t,w(),_.numericInput?R(e):e)},0),a=e.originalEvent.data}function ie(e){}function ne(e){if(u=de(e),u.data("_inputmask",{maskset:s,opts:_,isRTL:!1}),_.showTooltip&&u.prop("title",P().mask),("rtl"==e.dir||_.rightAlign)&&u.css("text-align","right"),"rtl"==e.dir||_.numericInput){e.dir="ltr",u.removeAttr("dir");var t=u.data("_inputmask");t.isRTL=!0,u.data("_inputmask",t),I=!0}u.unbind(".inputmask"),(u.is(":input")&&pe(u.attr("type"))||e.isContentEditable)&&(u.closest("form").bind("submit",function(e){o!=w().join("")&&u.change(),u[0]._valueGet&&u[0]._valueGet()==h().join("")&&u[0]._valueSet(""),_.removeMaskOnSubmit&&u.inputmask("remove")}).bind("reset",function(){setTimeout(function(){u.triggerHandler("setvalue.inputmask")},0)}),u.bind("mouseenter.inputmask",function(){var e=de(this),t=this;!e.is(":focus")&&_.showMaskOnHover&&t._valueGet()!=w().join("")&&M(t,w())}).bind("blur.inputmask",function(e){var t=de(this),i=this;if(t.data("_inputmask")){var n=i._valueGet(),r=w().slice();oe=!0,o!=r.join("")&&setTimeout(function(){t.change(),o=r.join("")},0),""!=n&&(_.clearMaskOnLostFocus&&(n==h().join("")?r=[]:U(r)),O(r)===!1&&(t.trigger("incomplete"),_.clearIncomplete&&(A(),r=_.clearMaskOnLostFocus?[]:h().slice())),M(i,r,void 0,e))}}).bind("focus.inputmask",function(e){var t=(de(this),this),i=t._valueGet();_.showMaskOnFocus&&(!_.showMaskOnHover||_.showMaskOnHover&&""==i)&&t._valueGet()!=w().join("")&&M(t,w(),D(E())),o=w().join("")}).bind("mouseleave.inputmask",function(){var e=de(this),t=this;if(_.clearMaskOnLostFocus){var i=w().slice(),n=t._valueGet();e.is(":focus")||n==e.attr("placeholder")||""==n||(n==h().join("")?i=[]:U(i),M(t,i))}}).bind("click.inputmask",function(){var e=de(this),t=this;if(e.is(":focus")){var i=N(t);if(i.begin==i.end)if(_.radixFocus&&""!=_.radixPoint&&-1!=de.inArray(_.radixPoint,w())&&(oe||w().join("")==h().join("")))N(t,de.inArray(_.radixPoint,w())),oe=!1;else{var n=c(i.begin),r=D(E(n));r>n?N(t,m(n)?n:D(n)):N(t,r)}}}).bind("dblclick.inputmask",function(){var e=this;setTimeout(function(){N(e,0,D(E()))},0)}).bind(ve+".inputmask dragdrop.inputmask drop.inputmask",Z).bind("cut.inputmask",function(e){g=!0;var t=this,i=de(t),n=N(t);X(t,de.inputmask.keyCode.DELETE,n),M(t,w(),P().p,e,o!=w().join("")),t._valueGet()==h().join("")&&i.trigger("cleared"),_.showTooltip&&i.prop("title",P().mask)}).bind("complete.inputmask",_.oncomplete).bind("incomplete.inputmask",_.onincomplete).bind("cleared.inputmask",_.oncleared),u.bind("keydown.inputmask",Q).bind("keypress.inputmask",p),me||u.bind("compositionstart.inputmask",ee).bind("compositionupdate.inputmask",te).bind("compositionend.inputmask",ie),"paste"===ve&&u.bind("input.inputmask",J)),u.bind("setvalue.inputmask",function(){var e=this,t=e._valueGet();e._valueSet(de.isFunction(_.onBeforeMask)?_.onBeforeMask.call(e,t,_)||t:t),l(e,!0,!1),o=w().join(""),(_.clearMaskOnLostFocus||_.clearIncomplete)&&e._valueGet()==h().join("")&&e._valueSet("")}),K(e);var i=de.isFunction(_.onBeforeMask)?_.onBeforeMask.call(e,e._valueGet(),_)||e._valueGet():e._valueGet();l(e,!0,!1,i.split(""));var n=w().slice();o=n.join("");var r;try{r=document.activeElement}catch(e){}O(n)===!1&&_.clearIncomplete&&A(),_.clearMaskOnLostFocus&&(n.join("")==h().join("")?n=[]:U(n)),M(e,n),r===e&&N(e,D(E())),q(e)}var o,re,a,u,d,I=!1,f=!1,g=!1,se=!1,oe=!0;if(void 0!=e)switch(e.action){case"isComplete":return u=de(e.el),s=u.data("_inputmask").maskset,_=u.data("_inputmask").opts,O(e.buffer);case"unmaskedvalue":return u=e.$input,s=u.data("_inputmask").maskset,_=u.data("_inputmask").opts,I=e.$input.data("_inputmask").isRTL,z(e.$input);case"mask":o=w().join(""),ne(e.el);break;case"format":u=de({}),u.data("_inputmask",{maskset:s,opts:_,isRTL:_.numericInput}),_.numericInput&&(I=!0);var t=(de.isFunction(_.onBeforeMask)?_.onBeforeMask.call(u,e.value,_)||e.value:e.value).split("");return l(u,!1,!1,I?t.reverse():t),de.isFunction(_.onBeforeWrite)&&_.onBeforeWrite.call(this,void 0,w(),0,_),e.metadata?{value:I?w().slice().reverse().join(""):w().join(""),metadata:u.inputmask("getmetadata")}:I?w().slice().reverse().join(""):w().join("");case"isValid":u=de({}),u.data("_inputmask",{maskset:s,opts:_,isRTL:_.numericInput}),_.numericInput&&(I=!0);var t=e.value.split("");l(u,!1,!0,I?t.reverse():t);for(var i=w(),ae=j(),n=i.length-1;n>ae&&!m(n);n--);return i.splice(ae,n+1-ae),O(i)&&e.value==i.join("");case"getemptymask":return u=de(e.el),s=u.data("_inputmask").maskset,_=u.data("_inputmask").opts,h();case"remove":var r=e.el;u=de(r),s=u.data("_inputmask").maskset,_=u.data("_inputmask").opts,r._valueSet(z(u)),u.unbind(".inputmask"),u.removeData("_inputmask");var le;Object.getOwnPropertyDescriptor&&(le=Object.getOwnPropertyDescriptor(r,"value")),le&&le.get?r._valueGet&&Object.defineProperty(r,"value",{get:r._valueGet,set:r._valueSet}):document.__lookupGetter__&&r.__lookupGetter__("value")&&r._valueGet&&(r.__defineGetter__("value",r._valueGet),r.__defineSetter__("value",r._valueSet));try{delete r._valueGet,delete r._valueSet}catch(e){r._valueGet=void 0,r._valueSet=void 0}break;case"getmetadata":if(u=de(e.el),s=u.data("_inputmask").maskset,_=u.data("_inputmask").opts,de.isArray(s.metadata)){for(var ce,ue=E(),k=ue;k>=0;k--)if(P().validPositions[k]&&void 0!=P().validPositions[k].alternation){ce=P().validPositions[k].alternation;break}return void 0!=ce?s.metadata[P().validPositions[ue].locator[ce]]:s.metadata[0]}return s.metadata}}if(void 0===de.fn.inputmask){var e=navigator.userAgent,fe=null!==e.match(new RegExp("iphone","i")),ge=(null!==e.match(new RegExp("android.*safari.*","i")),null!==e.match(new RegExp("android.*chrome.*","i"))),me=null!==e.match(new RegExp("android.*firefox.*","i")),ve=(/Kindle/i.test(e)||/Silk/i.test(e)||/KFTT/i.test(e)||/KFOT/i.test(e)||/KFJWA/i.test(e)||/KFJWI/i.test(e)||/KFSOWI/i.test(e)||/KFTHWA/i.test(e)||/KFTHWI/i.test(e)||/KFAPWA/i.test(e)||/KFAPWI/i.test(e),he("paste")?"paste":he("input")?"input":"propertychange");de.inputmask={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},quantifiermarker:{start:"{",end:"}"},groupmarker:{start:"(",end:")"},alternatormarker:"|",escapeChar:"\\",mask:null,oncomplete:de.noop,onincomplete:de.noop,oncleared:de.noop,repeat:0,greedy:!0,autoUnmask:!1,removeMaskOnSubmit:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},alias:null,onKeyDown:de.noop,onBeforeMask:void 0,onBeforePaste:void 0,onBeforeWrite:void 0,onUnMask:void 0,showMaskOnFocus:!0,showMaskOnHover:!0,onKeyValidation:de.noop,skipOptionalPartCharacter:" ",showTooltip:!1,numericInput:!1,rightAlign:!1,undoOnEscape:!0,radixPoint:"",radixFocus:!1,nojumps:!1,nojumpsThreshold:0,keepStatic:void 0,definitions:{9:{validator:"[0-9]",cardinality:1,definitionSymbol:"*"},a:{validator:"[A-Za-z–ê-—è–Å—ë√Ä-√ø¬µ]",cardinality:1,definitionSymbol:"*"},"*":{validator:"[0-9A-Za-z–ê-—è–Å—ë√Ä-√ø¬µ]",cardinality:1}},ignorables:[8,9,13,19,27,33,34,35,36,37,38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123],isComplete:void 0,canClearPosition:de.noop,postValidation:void 0},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91},masksCache:{},escapeRegex:function(e){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^"];return e.replace(new RegExp("(\\"+t.join("|\\")+")","gim"),"\\$1")},format:function(e,t,i){var n=de.extend(!0,{},de.inputmask.defaults,t);return o(n.alias,t,n),l({action:"format",value:e,metadata:i},a(n,t&&void 0!==t.definitions),n)},isValid:function(e,t){var i=de.extend(!0,{},de.inputmask.defaults,t);return o(i.alias,t,i),l({action:"isValid",value:e},a(i,t&&void 0!==t.definitions),i)}},de.fn.inputmask=function(e,n){function r(e,t,i){var n=de(e);n.data("inputmask-alias")&&o(n.data("inputmask-alias"),de.extend(!0,{},t),t);for(var r in t){var s=n.data("inputmask-"+r.toLowerCase());void 0!=s&&(s="boolean"==typeof s?s:s.toString(),"mask"==r&&0==s.indexOf("[")?(t[r]=s.replace(/[\s[\]]/g,"").split("','"),t[r][0]=t[r][0].replace("'",""),t[r][t[r].length-1]=t[r][t[r].length-1].replace("'","")):t[r]=s,i&&(i[r]=t[r]))}return t}var t,s=de.extend(!0,{},de.inputmask.defaults,n);if("string"==typeof e)switch(e){case"mask":return o(s.alias,n,s),this.each(function(){return r(this,s),t=a(s,n&&void 0!==n.definitions),void 0==t?this:void l({action:"mask",el:this},t,s)});case"unmaskedvalue":var i=de(this);return i.data("_inputmask")?l({action:"unmaskedvalue",$input:i}):i.val();case"remove":return this.each(function(){var e=de(this);e.data("_inputmask")&&l({action:"remove",el:this})});case"getemptymask":return this.data("_inputmask")?l({action:"getemptymask",el:this}):"";case"hasMaskedValue":return this.data("_inputmask")?!this.data("_inputmask").opts.autoUnmask:!1;case"isComplete":return this.data("_inputmask")?l({action:"isComplete",buffer:this[0]._valueGet().split(""),el:this}):!0;case"getmetadata":return this.data("_inputmask")?l({action:"getmetadata",el:this}):void 0;default:return o(s.alias,n,s),o(e,n,s)||(s.mask=e),this.each(function(){return r(this,s),t=a(s,n&&void 0!==n.definitions),void 0==t?this:void l({action:"mask",el:this},t,s)})}else{if("object"==typeof e)return s=de.extend(!0,{},de.inputmask.defaults,e),o(s.alias,e,s),this.each(function(){return r(this,s),t=a(s,e&&void 0!==e.definitions),void 0==t?this:void l({action:"mask",el:this},t,s)});if(void 0==e)return this.each(function(){var e=de(this).attr("data-inputmask");if(e&&""!=e)try{e=e.replace(new RegExp("'","g"),'"');var t=de.parseJSON("{"+e+"}");de.extend(!0,t,n),s=de.extend(!0,{},de.inputmask.defaults,t),s=r(this,s),o(s.alias,t,s),s.alias=void 0,de(this).inputmask("mask",s)}catch(e){}if(de(this).attr("data-inputmask-mask")||de(this).attr("data-inputmask-alias")){s=de.extend(!0,{},de.inputmask.defaults,{});var i={};s=r(this,s,i),o(s.alias,i,s),s.alias=void 0,de(this).inputmask("mask",s)}})}}}return de.fn.inputmask}(jQuery),function(o){return o.extend(o.inputmask.defaults.definitions,{h:{validator:"[01][0-9]|2[0-3]",cardinality:2,prevalidator:[{validator:"[0-2]",cardinality:1}]},s:{validator:"[0-5][0-9]",cardinality:2,prevalidator:[{validator:"[0-5]",cardinality:1}]},d:{validator:"0[1-9]|[12][0-9]|3[01]",cardinality:2,prevalidator:[{validator:"[0-3]",cardinality:1}]},m:{validator:"0[1-9]|1[012]",cardinality:2,prevalidator:[{validator:"[01]",cardinality:1}]},y:{validator:"(19|20)\\d{2}",cardinality:4,prevalidator:[{validator:"[12]",cardinality:1},{validator:"(19|20)",cardinality:2},{validator:"(19|20)\\d",cardinality:3}]}}),o.extend(o.inputmask.defaults.aliases,{"dd/mm/yyyy":{mask:"1/2/y",placeholder:"dd/mm/yyyy",regex:{val1pre:new RegExp("[0-3]"),val1:new RegExp("0[1-9]|[12][0-9]|3[01]"),val2pre:function(e){var t=o.inputmask.escapeRegex.call(this,e);return new RegExp("((0[1-9]|[12][0-9]|3[01])"+t+"[01])")},val2:function(e){var t=o.inputmask.escapeRegex.call(this,e);return new RegExp("((0[1-9]|[12][0-9])"+t+"(0[1-9]|1[012]))|(30"+t+"(0[13-9]|1[012]))|(31"+t+"(0[13578]|1[02]))")}},leapday:"29/02/",separator:"/",yearrange:{minyear:1900,maxyear:2099},isInYearRange:function(e,t,i){if(isNaN(e))return!1;var n=parseInt(e.concat(t.toString().slice(e.length))),r=parseInt(e.concat(i.toString().slice(e.length)));return(isNaN(n)?!1:n>=t&&i>=n)||(isNaN(r)?!1:r>=t&&i>=r)},determinebaseyear:function(e,t,i){var n=(new Date).getFullYear();if(e>n)return e;if(n>t){for(var r=t.toString().slice(0,2),s=t.toString().slice(2,4);r+i>t;)r--;var o=r+s;return e>o?e:o}return n},onKeyDown:function(e,t,i,n){var r=o(this);if(e.ctrlKey&&e.keyCode==o.inputmask.keyCode.RIGHT){var s=new Date;r.val(s.getDate().toString()+(s.getMonth()+1).toString()+s.getFullYear().toString()),r.triggerHandler("setvalue.inputmask")}},getFrontValue:function(e,t,i){for(var n=0,r=0,s=0;s<e.length&&"2"!=e.charAt(s);s++){var o=i.definitions[e.charAt(s)];o?(n+=r,r=o.cardinality):r++}return t.join("").substr(n,r)},definitions:{1:{validator:function(e,t,i,n,r){var s=r.regex.val1.test(e);return n||s||e.charAt(1)!=r.separator&&-1=="-./".indexOf(e.charAt(1))||!(s=r.regex.val1.test("0"+e.charAt(0)))?s:(t.buffer[i-1]="0",{refreshFromBuffer:{start:i-1,end:i},pos:i,c:e.charAt(0)})},cardinality:2,prevalidator:[{validator:function(e,t,i,n,r){var s=e;isNaN(t.buffer[i+1])||(s+=t.buffer[i+1]);var o=1==s.length?r.regex.val1pre.test(s):r.regex.val1.test(s);if(!n&&!o){if(o=r.regex.val1.test(e+"0"))return t.buffer[i]=e,t.buffer[++i]="0",{pos:i,c:"0"};if(o=r.regex.val1.test("0"+e))return t.buffer[i]="0",i++,{pos:i}}return o},cardinality:1}]},2:{validator:function(e,t,i,n,r){var s=r.getFrontValue(t.mask,t.buffer,r);-1!=s.indexOf(r.placeholder[0])&&(s="01"+r.separator);var o=r.regex.val2(r.separator).test(s+e);if(!n&&!o&&(e.charAt(1)==r.separator||-1!="-./".indexOf(e.charAt(1)))&&(o=r.regex.val2(r.separator).test(s+"0"+e.charAt(0))))return t.buffer[i-1]="0",{refreshFromBuffer:{start:i-1,end:i},pos:i,c:e.charAt(0)};if(r.mask.indexOf("2")==r.mask.length-1&&o){var a=t.buffer.join("").substr(4,4)+e;if(a!=r.leapday)return!0;var l=parseInt(t.buffer.join("").substr(0,4),10);return l%4===0?l%100===0?l%400===0?!0:!1:!0:!1}return o},cardinality:2,prevalidator:[{validator:function(e,t,i,n,r){isNaN(t.buffer[i+1])||(e+=t.buffer[i+1]);var s=r.getFrontValue(t.mask,t.buffer,r);-1!=s.indexOf(r.placeholder[0])&&(s="01"+r.separator);var o=1==e.length?r.regex.val2pre(r.separator).test(s+e):r.regex.val2(r.separator).test(s+e);return n||o||!(o=r.regex.val2(r.separator).test(s+"0"+e))?o:(t.buffer[i]="0",i++,{pos:i})},cardinality:1}]},y:{validator:function(e,t,i,n,r){if(r.isInYearRange(e,r.yearrange.minyear,r.yearrange.maxyear)){var s=t.buffer.join("").substr(0,6);if(s!=r.leapday)return!0;var o=parseInt(e,10);return o%4===0?o%100===0?o%400===0?!0:!1:!0:!1}return!1},cardinality:4,prevalidator:[{validator:function(e,t,i,n,r){var s=r.isInYearRange(e,r.yearrange.minyear,r.yearrange.maxyear);if(!n&&!s){var o=r.determinebaseyear(r.yearrange.minyear,r.yearrange.maxyear,e+"0").toString().slice(0,1);if(s=r.isInYearRange(o+e,r.yearrange.minyear,r.yearrange.maxyear))return t.buffer[i++]=o.charAt(0),{pos:i};if(o=r.determinebaseyear(r.yearrange.minyear,r.yearrange.maxyear,e+"0").toString().slice(0,2),s=r.isInYearRange(o+e,r.yearrange.minyear,r.yearrange.maxyear))return t.buffer[i++]=o.charAt(0),t.buffer[i++]=o.charAt(1),{pos:i}}return s},cardinality:1},{validator:function(e,t,i,n,r){var s=r.isInYearRange(e,r.yearrange.minyear,r.yearrange.maxyear);if(!n&&!s){var o=r.determinebaseyear(r.yearrange.minyear,r.yearrange.maxyear,e).toString().slice(0,2);if(s=r.isInYearRange(e[0]+o[1]+e[1],r.yearrange.minyear,r.yearrange.maxyear))return t.buffer[i++]=o.charAt(1),{pos:i};if(o=r.determinebaseyear(r.yearrange.minyear,r.yearrange.maxyear,e).toString().slice(0,2),r.isInYearRange(o+e,r.yearrange.minyear,r.yearrange.maxyear)){var a=t.buffer.join("").substr(0,6);if(a!=r.leapday)s=!0;else{var l=parseInt(e,10);s=l%4===0?l%100===0?l%400===0?!0:!1:!0:!1}}else s=!1;if(s)return t.buffer[i-1]=o.charAt(0),t.buffer[i++]=o.charAt(1),t.buffer[i++]=e.charAt(0),{refreshFromBuffer:{start:i-3,end:i},pos:i}}return s},cardinality:2},{validator:function(e,t,i,n,r){return r.isInYearRange(e,r.yearrange.minyear,r.yearrange.maxyear)},cardinality:3}]}},insertMode:!1,autoUnmask:!1},"mm/dd/yyyy":{placeholder:"mm/dd/yyyy",alias:"dd/mm/yyyy",regex:{val2pre:function(e){var t=o.inputmask.escapeRegex.call(this,e);return new RegExp("((0[13-9]|1[012])"+t+"[0-3])|(02"+t+"[0-2])")},val2:function(e){var t=o.inputmask.escapeRegex.call(this,e);return new RegExp("((0[1-9]|1[012])"+t+"(0[1-9]|[12][0-9]))|((0[13-9]|1[012])"+t+"30)|((0[13578]|1[02])"+t+"31)")},val1pre:new RegExp("[01]"),val1:new RegExp("0[1-9]|1[012]")},leapday:"02/29/",onKeyDown:function(e,t,i,n){var r=o(this);if(e.ctrlKey&&e.keyCode==o.inputmask.keyCode.RIGHT){var s=new Date;r.val((s.getMonth()+1).toString()+s.getDate().toString()+s.getFullYear().toString()),r.triggerHandler("setvalue.inputmask")}}},"yyyy/mm/dd":{mask:"y/1/2",placeholder:"yyyy/mm/dd",alias:"mm/dd/yyyy",leapday:"/02/29",onKeyDown:function(e,t,i,n){var r=o(this);if(e.ctrlKey&&e.keyCode==o.inputmask.keyCode.RIGHT){var s=new Date;r.val(s.getFullYear().toString()+(s.getMonth()+1).toString()+s.getDate().toString()),r.triggerHandler("setvalue.inputmask")}}},"dd.mm.yyyy":{mask:"1.2.y",placeholder:"dd.mm.yyyy",leapday:"29.02.",separator:".",alias:"dd/mm/yyyy"},"dd-mm-yyyy":{mask:"1-2-y",placeholder:"dd-mm-yyyy",leapday:"29-02-",separator:"-",alias:"dd/mm/yyyy"},"mm.dd.yyyy":{mask:"1.2.y",placeholder:"mm.dd.yyyy",leapday:"02.29.",separator:".",alias:"mm/dd/yyyy"},"mm-dd-yyyy":{mask:"1-2-y",placeholder:"mm-dd-yyyy",leapday:"02-29-",separator:"-",alias:"mm/dd/yyyy"},"yyyy.mm.dd":{mask:"y.1.2",placeholder:"yyyy.mm.dd",leapday:".02.29",separator:".",alias:"yyyy/mm/dd"},"yyyy-mm-dd":{mask:"y-1-2",placeholder:"yyyy-mm-dd",leapday:"-02-29",separator:"-",alias:"yyyy/mm/dd"},datetime:{mask:"1/2/y h:s",placeholder:"dd/mm/yyyy hh:mm",alias:"dd/mm/yyyy",regex:{hrspre:new RegExp("[012]"),hrs24:new RegExp("2[0-4]|1[3-9]"),hrs:new RegExp("[01][0-9]|2[0-4]"),ampm:new RegExp("^[a|p|A|P][m|M]"),mspre:new RegExp("[0-5]"),ms:new RegExp("[0-5][0-9]")},timeseparator:":",hourFormat:"24",definitions:{h:{validator:function(e,t,i,n,r){if("24"==r.hourFormat&&24==parseInt(e,10))return t.buffer[i-1]="0",t.buffer[i]="0",{refreshFromBuffer:{start:i-1,end:i},c:"0"};var s=r.regex.hrs.test(e);if(!n&&!s&&(e.charAt(1)==r.timeseparator||-1!="-.:".indexOf(e.charAt(1)))&&(s=r.regex.hrs.test("0"+e.charAt(0))))return t.buffer[i-1]="0",t.buffer[i]=e.charAt(0),i++,{refreshFromBuffer:{start:i-2,end:i},pos:i,c:r.timeseparator};if(s&&"24"!==r.hourFormat&&r.regex.hrs24.test(e)){var o=parseInt(e,10);return 24==o?(t.buffer[i+5]="a",t.buffer[i+6]="m"):(t.buffer[i+5]="p",t.buffer[i+6]="m"),o-=12,10>o?(t.buffer[i]=o.toString(),t.buffer[i-1]="0"):(t.buffer[i]=o.toString().charAt(1),t.buffer[i-1]=o.toString().charAt(0)),{refreshFromBuffer:{start:i-1,end:i+6},c:t.buffer[i]}}return s},cardinality:2,prevalidator:[{validator:function(e,t,i,n,r){var s=r.regex.hrspre.test(e);return n||s||!(s=r.regex.hrs.test("0"+e))?s:(t.buffer[i]="0",i++,{pos:i})},cardinality:1}]},s:{validator:"[0-5][0-9]",cardinality:2,prevalidator:[{validator:function(e,t,i,n,r){var s=r.regex.mspre.test(e);return n||s||!(s=r.regex.ms.test("0"+e))?s:(t.buffer[i]="0",i++,{pos:i})},cardinality:1}]},t:{validator:function(e,t,i,n,r){return r.regex.ampm.test(e+"m")},casing:"lower",cardinality:1}},insertMode:!1,autoUnmask:!1},datetime12:{mask:"1/2/y h:s t\\m",placeholder:"dd/mm/yyyy hh:mm xm",alias:"datetime",hourFormat:"12"},"hh:mm t":{mask:"h:s t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"h:s t":{mask:"h:s t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"hh:mm:ss":{mask:"h:s:s",placeholder:"hh:mm:ss",alias:"datetime",autoUnmask:!1},"hh:mm":{mask:"h:s",placeholder:"hh:mm",alias:"datetime",autoUnmask:!1},date:{alias:"dd/mm/yyyy"},"mm/yyyy":{mask:"1/y",placeholder:"mm/yyyy",leapday:"donotuse",separator:"/",alias:"mm/dd/yyyy"}}),o.fn.inputmask}(jQuery),function(e){return e.extend(e.inputmask.defaults.definitions,{A:{validator:"[A-Za-z–ê-—è–Å—ë√Ä-√ø¬µ]",cardinality:1,casing:"upper"},"#":{validator:"[0-9A-Za-z–ê-—è–Å—ë√Ä-√ø¬µ]",cardinality:1,casing:"upper"}}),e.extend(e.inputmask.defaults.aliases,{url:{mask:"ir",placeholder:"",separator:"",defaultPrefix:"http://",regex:{urlpre1:new RegExp("[fh]"),urlpre2:new RegExp("(ft|ht)"),urlpre3:new RegExp("(ftp|htt)"),urlpre4:new RegExp("(ftp:|http|ftps)"),urlpre5:new RegExp("(ftp:/|ftps:|http:|https)"),urlpre6:new RegExp("(ftp://|ftps:/|http:/|https:)"),urlpre7:new RegExp("(ftp://|ftps://|http://|https:/)"),urlpre8:new RegExp("(ftp://|ftps://|http://|https://)")},definitions:{i:{validator:function(e,t,i,n,r){return!0},cardinality:8,prevalidator:function(){for(var e=[],t=8,i=0;t>i;i++)e[i]=function(){var l=i;return{validator:function(e,t,i,n,r){if(r.regex["urlpre"+(l+1)]){var s,o=e;l+1-e.length>0&&(o=t.buffer.join("").substring(0,l+1-e.length)+""+o);var a=r.regex["urlpre"+(l+1)].test(o);if(!n&&!a){for(i-=l,s=0;s<r.defaultPrefix.length;s++)t.buffer[i]=r.defaultPrefix[s],i++;for(s=0;s<o.length-1;s++)t.buffer[i]=o[s],i++;return{pos:i}}return a}return!1},cardinality:l}}();return e}()},r:{validator:".",cardinality:50}},insertMode:!1,autoUnmask:!1},ip:{mask:"i[i[i]].i[i[i]].i[i[i]].i[i[i]]",definitions:{i:{validator:function(e,t,i,n,r){return i-1>-1&&"."!=t.buffer[i-1]?(e=t.buffer[i-1]+e,e=i-2>-1&&"."!=t.buffer[i-2]?t.buffer[i-2]+e:"0"+e):e="00"+e,new RegExp("25[0-5]|2[0-4][0-9]|[01][0-9][0-9]").test(e)},cardinality:1}}},email:{mask:"*{1,64}[.*{1,64}][.*{1,64}][.*{1,64}]@*{1,64}[.*{2,64}][.*{2,6}][.*{1,2}]",greedy:!1,onBeforePaste:function(e,t){return e=e.toLowerCase(),e.replace("mailto:","")},definitions:{"*":{validator:"[0-9A-Za-z!#$%&'*+/=?^_`{|}~-]",cardinality:1,casing:"lower"}}}}),e.fn.inputmask}(jQuery),function(m){return m.extend(m.inputmask.defaults.aliases,{numeric:{mask:function(n){function e(e){for(var t="",i=0;i<e.length;i++)t+=n.definitions[e[i]]?"\\"+e[i]:e[i];return t}if(0!==n.repeat&&isNaN(n.integerDigits)&&(n.integerDigits=n.repeat),n.repeat=0,n.groupSeparator==n.radixPoint&&("."==n.radixPoint?n.groupSeparator=",":","==n.radixPoint?n.groupSeparator=".":n.groupSeparator="")," "===n.groupSeparator&&(n.skipOptionalPartCharacter=void 0),n.autoGroup=n.autoGroup&&""!=n.groupSeparator,n.autoGroup&&("string"==typeof n.groupSize&&isFinite(n.groupSize)&&(n.groupSize=parseInt(n.groupSize)),isFinite(n.integerDigits))){var t=Math.floor(n.integerDigits/n.groupSize),i=n.integerDigits%n.groupSize;n.integerDigits=parseInt(n.integerDigits)+(0==i?t-1:t)}n.placeholder.length>1&&(n.placeholder=n.placeholder.charAt(0)),n.radixFocus=n.radixFocus&&"0"==n.placeholder,n.definitions[";"]=n.definitions["~"];var r=e(n.prefix);return r+="[+]",r+="~{1,"+n.integerDigits+"}",void 0!=n.digits&&(isNaN(n.digits)||parseInt(n.digits)>0)&&(r+=n.digitsOptional?"["+(n.decimalProtect?":":n.radixPoint)+";{"+n.digits+"}]":(n.decimalProtect?":":n.radixPoint)+";{"+n.digits+"}"),""!=n.negationSymbol.back&&(r+="[-]"),r+=e(n.suffix),n.greedy=!1,r},placeholder:"",greedy:!1,digits:"*",digitsOptional:!0,groupSeparator:"",radixPoint:".",radixFocus:!0,groupSize:3,autoGroup:!1,allowPlus:!0,allowMinus:!0,negationSymbol:{front:"-",back:""},integerDigits:"+",prefix:"",suffix:"",rightAlign:!0,decimalProtect:!0,min:void 0,max:void 0,postFormat:function(e,t,i,n){var r=!1;e.length>=n.suffix.length&&e.join("").indexOf(n.suffix)==e.length-n.suffix.length&&(e.length=e.length-n.suffix.length,r=!0),t=t>=e.length?e.length-1:t<n.prefix.length?n.prefix.length:t;var s=!1,o=e[t];if(""==n.groupSeparator||-1!=m.inArray(n.radixPoint,e)&&t>=m.inArray(n.radixPoint,e)||new RegExp("["+m.inputmask.escapeRegex(n.negationSymbol.front)+"+]").test(o)){if(r)for(var a=0,l=n.suffix.length;l>a;a++)e.push(n.suffix.charAt(a));return{pos:t}}var c=e.slice();o==n.groupSeparator&&(c.splice(t--,1),o=c[t]),i?c[t]="?":c.splice(t,0,"?");var u=c.join(""),d=u;if(u.length>0&&n.autoGroup||i&&-1!=u.indexOf(n.groupSeparator)){var h=m.inputmask.escapeRegex(n.groupSeparator);s=0==u.indexOf(n.groupSeparator),u=u.replace(new RegExp(h,"g"),"");var p=u.split(n.radixPoint);if(u=""==n.radixPoint?u:p[0],u!=n.prefix+"?0"&&u.length>=n.groupSize+n.prefix.length)for(var f=new RegExp("([-+]?[\\d?]+)([\\d?]{"+n.groupSize+"})");f.test(u);)u=u.replace(f,"$1"+n.groupSeparator+"$2"),u=u.replace(n.groupSeparator+n.groupSeparator,n.groupSeparator);""!=n.radixPoint&&p.length>1&&(u+=n.radixPoint+p[1])}s=d!=u,e.length=u.length;for(var a=0,l=u.length;l>a;a++)e[a]=u.charAt(a);var g=m.inArray("?",e);if(i?e[g]=o:e.splice(g,1),!s&&r)for(var a=0,l=n.suffix.length;l>a;a++)e.push(n.suffix.charAt(a));return{pos:g,refreshFromBuffer:s,buffer:e}},onBeforeWrite:function(e,t,i,n){if(e&&"blur"==e.type){var r=t.join(""),s=r.replace(n.prefix,"");if(s=s.replace(n.suffix,""),s=s.replace(new RegExp(m.inputmask.escapeRegex(n.groupSeparator),"g"),""),","===n.radixPoint&&(s=s.replace(m.inputmask.escapeRegex(n.radixPoint),".")),isFinite(s)&&isFinite(n.min)&&parseFloat(s)<parseFloat(n.min))return m.extend(!0,{refreshFromBuffer:!0,buffer:(n.prefix+n.min).split("")},n.postFormat((n.prefix+n.min).split(""),0,!0,n));var o=""!=n.radixPoint?t.join("").split(n.radixPoint):[t.join("")],a=o[0].match(n.regex.integerPart(n)),l=2==o.length?o[1].match(n.regex.integerNPart(n)):void 0;!a||a[0]!=n.negationSymbol.front+"0"&&a[0]!=n.negationSymbol.front&&"+"!=a[0]||void 0!=l&&!l[0].match(/^0+$/)||t.splice(a.index,1);var c=m.inArray(n.radixPoint,t);if(-1!=c&&isFinite(n.digits)&&!n.digitsOptional){for(var u=1;u<=n.digits;u++)(void 0==t[c+u]||t[c+u]==n.placeholder.charAt(0))&&(t[c+u]="0");return{refreshFromBuffer:!0,buffer:t}}}if(n.autoGroup){var d=n.postFormat(t,i-1,!0,n);return d.caret=i<=n.prefix.length?d.pos:d.pos+1,d}},regex:{integerPart:function(e){return new RegExp("["+m.inputmask.escapeRegex(e.negationSymbol.front)+"+]?\\d+")},integerNPart:function(e){return new RegExp("[\\d"+m.inputmask.escapeRegex(e.groupSeparator)+"]+")}},signHandler:function(e,t,i,n,r){if(!n&&r.allowMinus&&"-"===e||r.allowPlus&&"+"===e){var s=t.buffer.join("").match(r.regex.integerPart(r));if(s&&s[0].length>0)return t.buffer[s.index]==("-"===e?"+":r.negationSymbol.front)?"-"==e?""!=r.negationSymbol.back?{pos:s.index,c:r.negationSymbol.front,remove:s.index,caret:i,insert:{pos:t.buffer.length-r.suffix.length-1,c:r.negationSymbol.back}}:{pos:s.index,c:r.negationSymbol.front,remove:s.index,caret:i}:""!=r.negationSymbol.back?{pos:s.index,c:"+",remove:[s.index,t.buffer.length-r.suffix.length-1],caret:i}:{pos:s.index,c:"+",remove:s.index,caret:i}:t.buffer[s.index]==("-"===e?r.negationSymbol.front:"+")?"-"==e&&""!=r.negationSymbol.back?{remove:[s.index,t.buffer.length-r.suffix.length-1],caret:i-1}:{remove:s.index,caret:i-1}:"-"==e?""!=r.negationSymbol.back?{pos:s.index,c:r.negationSymbol.front,caret:i+1,insert:{pos:t.buffer.length-r.suffix.length,c:r.negationSymbol.back}}:{pos:s.index,c:r.negationSymbol.front,caret:i+1}:{pos:s.index,c:e,caret:i+1}}return!1},radixHandler:function(e,t,i,n,r){if(!n&&e===r.radixPoint&&r.digits>0){var s=m.inArray(r.radixPoint,t.buffer),o=t.buffer.join("").match(r.regex.integerPart(r));if(-1!=s&&t.validPositions[s])return t.validPositions[s-1]?{caret:s+1}:{pos:o.index,c:o[0],caret:s+1};if(!o||"0"==o[0]&&o.index+1!=i)return t.buffer[o?o.index:i]="0",{pos:(o?o.index:i)+1}}return!1},leadingZeroHandler:function(e,t,i,n,r){var s=t.buffer.join("").match(r.regex.integerNPart(r)),o=m.inArray(r.radixPoint,t.buffer);if(s&&!n&&(-1==o||o>=i))if(0==s[0].indexOf("0")){i<r.prefix.length&&(i=s.index);var a=m.inArray(r.radixPoint,t._buffer),l=t._buffer&&t.buffer.slice(o).join("")==t._buffer.slice(a).join("")||0==parseInt(t.buffer.slice(o+1).join("")),c=t._buffer&&t.buffer.slice(s.index,o).join("")==t._buffer.slice(r.prefix.length,a).join("")||"0"==t.buffer.slice(s.index,o).join("");if(-1==o||l&&c)return t.buffer.splice(s.index,1),i=i>s.index?i-1:s.index,{pos:i,remove:s.index};if(s.index+1==i||"0"==e)return t.buffer.splice(s.index,1),i=s.index,{pos:i,remove:s.index}}else if("0"===e&&i<=s.index&&s[0]!=r.groupSeparator)return!1;return!0},postValidation:function(e,t){var i=!0,n=e.join(""),r=n.replace(t.prefix,"");return r=r.replace(t.suffix,""),r=r.replace(new RegExp(m.inputmask.escapeRegex(t.groupSeparator),"g"),""),","===t.radixPoint&&(r=r.replace(m.inputmask.escapeRegex(t.radixPoint),".")),r=r.replace(new RegExp("^"+m.inputmask.escapeRegex(t.negationSymbol.front)),"-"),r=r.replace(new RegExp(m.inputmask.escapeRegex(t.negationSymbol.back)+"$"),""),isFinite(r)&&isFinite(t.max)&&(i=parseFloat(r)<=parseFloat(t.max)),i},definitions:{"~":{validator:function(e,t,i,n,r){var s=r.signHandler(e,t,i,n,r);if(!s&&(s=r.radixHandler(e,t,i,n,r),!s&&(s=n?new RegExp("[0-9"+m.inputmask.escapeRegex(r.groupSeparator)+"]").test(e):new RegExp("[0-9]").test(e),s===!0&&(s=r.leadingZeroHandler(e,t,i,n,r),s===!0)))){var o=m.inArray(r.radixPoint,t.buffer);s=r.digitsOptional===!1&&i>o&&!n?{pos:i,remove:i}:{pos:i}}return s},cardinality:1,prevalidator:null},"+":{validator:function(e,t,i,n,r){var s=r.signHandler(e,t,i,n,r);return!s&&(n&&r.allowMinus&&e===r.negationSymbol.front||r.allowMinus&&"-"==e||r.allowPlus&&"+"==e)&&(s="-"==e?""!=r.negationSymbol.back?{pos:i,c:"-"===e?r.negationSymbol.front:"+",caret:i+1,insert:{pos:t.buffer.length,c:r.negationSymbol.back}}:{pos:i,c:"-"===e?r.negationSymbol.front:"+",caret:i+1}:!0),s},cardinality:1,prevalidator:null,placeholder:""},"-":{validator:function(e,t,i,n,r){var s=r.signHandler(e,t,i,n,r);return!s&&n&&r.allowMinus&&e===r.negationSymbol.back&&(s=!0),s},cardinality:1,prevalidator:null,placeholder:""},":":{validator:function(e,t,i,n,r){var s=r.signHandler(e,t,i,n,r);if(!s){var o="["+m.inputmask.escapeRegex(r.radixPoint)+"]";s=new RegExp(o).test(e),s&&t.validPositions[i]&&t.validPositions[i].match.placeholder==r.radixPoint&&(s={caret:i+1})}return s},cardinality:1,prevalidator:null,placeholder:function(e){return e.radixPoint}}},insertMode:!0,autoUnmask:!1,unmaskAsNumber:!1,onUnMask:function(e,t,i){var n=e.replace(i.prefix,"");return n=n.replace(i.suffix,""),n=n.replace(new RegExp(m.inputmask.escapeRegex(i.groupSeparator),"g"),""),i.unmaskAsNumber?(n=n.replace(m.inputmask.escapeRegex.call(this,i.radixPoint),"."),Number(n)):n},isComplete:function(e,t){var i=e.join(""),n=e.slice();if(t.postFormat(n,0,!0,t),n.join("")!=i)return!1;var r=i.replace(t.prefix,"");return r=r.replace(t.suffix,""),r=r.replace(new RegExp(m.inputmask.escapeRegex(t.groupSeparator),"g"),""),","===t.radixPoint&&(r=r.replace(m.inputmask.escapeRegex(t.radixPoint),".")),isFinite(r)},onBeforeMask:function(e,t){if(""!=t.radixPoint&&isFinite(e))e=e.toString().replace(".",t.radixPoint);else{var i=e.match(/,/g),n=e.match(/\./g);n&&i?n.length>i.length?(e=e.replace(/\./g,""),e=e.replace(",",t.radixPoint)):i.length>n.length?(e=e.replace(/,/g,""),e=e.replace(".",t.radixPoint)):e=e.indexOf(".")<e.indexOf(",")?e.replace(/\./g,""):e=e.replace(/,/g,""):e=e.replace(new RegExp(m.inputmask.escapeRegex(t.groupSeparator),"g"),"")}return 0==t.digits&&(-1!=e.indexOf(".")?e=e.substring(0,e.indexOf(".")):-1!=e.indexOf(",")&&(e=e.substring(0,e.indexOf(",")))),e},canClearPosition:function(e,t,i,n,r){var s=e.validPositions[t].input,o=s!=r.radixPoint&&isFinite(s)||t==i||s==r.groupSeparator||s==r.negationSymbol.front||s==r.negationSymbol.back;if(o&&isFinite(s)){var a;if(!n&&e.buffer){a=e.buffer.join("").substr(0,t).match(r.regex.integerNPart(r));var l=t+1,c=null==a||0==parseInt(a[0].replace(new RegExp(m.inputmask.escapeRegex(r.groupSeparator),"g"),""));if(c)for(;e.validPositions[l]&&(e.validPositions[l].input==r.groupSeparator||"0"==e.validPositions[l].input);)delete e.validPositions[l],l++}var u=[];for(var d in e.validPositions)u.push(e.validPositions[d].input);a=u.join("").match(r.regex.integerNPart(r));var h=m.inArray(r.radixPoint,e.buffer);if(a&&(-1==h||h>=t))if(0==a[0].indexOf("0"))o=a.index!=t||-1==h;else{var p=parseInt(a[0].replace(new RegExp(m.inputmask.escapeRegex(r.groupSeparator),"g"),""));-1!=h&&10>p&&"0"==r.placeholder.charAt(0)&&(e.validPositions[t].input="0",e.p=r.prefix.length+1,o=!1)}}return o}},currency:{prefix:"$ ",groupSeparator:",",alias:"numeric",placeholder:"0",autoGroup:!0,digits:2,digitsOptional:!1,clearMaskOnLostFocus:!1},decimal:{alias:"numeric"},integer:{alias:"numeric",digits:"0",radixPoint:""}}),m.fn.inputmask}(jQuery),function(e){return e.extend(e.inputmask.defaults.aliases,{phone:{url:"phone-codes/phone-codes.js",countrycode:"",mask:function(n){n.definitions["#"]=n.definitions[9];var t=[];return e.ajax({url:n.url,async:!1,dataType:"json",success:function(e){t=e},error:function(e,t,i){alert(i+" - "+n.url)}}),t=t.sort(function(e,t){return(e.mask||e)<(t.mask||t)?-1:1})},keepStatic:!1,nojumps:!0,nojumpsThreshold:1,onBeforeMask:function(e,t){var i=e.replace(/^0/g,"");return(i.indexOf(t.countrycode)>1||-1==i.indexOf(t.countrycode))&&(i="+"+t.countrycode+i),i}},phonebe:{alias:"phone",url:"phone-codes/phone-be.js",countrycode:"32",nojumpsThreshold:4}}),e.fn.inputmask}(jQuery),function(C){return C.extend(C.inputmask.defaults.aliases,{Regex:{mask:"r",greedy:!1,repeat:"*",regex:null,regexTokens:null,tokenizer:/\[\^?]?(?:[^\\\]]+|\\[\S\s]?)*]?|\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9][0-9]*|x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4}|c[A-Za-z]|[\S\s]?)|\((?:\?[:=!]?)?|(?:[?*+]|\{[0-9]+(?:,[0-9]*)?\})\??|[^.?*+^${[()|\\]+|./g,quantifierFilter:/[0-9]+[^,]/,isComplete:function(e,t){return new RegExp(t.regex).test(e.join(""))},definitions:{r:{validator:function(e,t,i,n,u){function d(e,t){this.matches=[],this.isGroup=e||!1,this.isQuantifier=t||!1,this.quantifier={min:1,max:1},this.repeaterPart=void 0}function r(){var e,t,i=new d,n=[];for(u.regexTokens=[];e=u.tokenizer.exec(u.regex);)switch(t=e[0],t.charAt(0)){case"(":n.push(new d(!0));break;case")":var r=n.pop();n.length>0?n[n.length-1].matches.push(r):i.matches.push(r);break;case"{":case"+":case"*":var s=new d(!1,!0);t=t.replace(/[{}]/g,"");var o=t.split(","),a=isNaN(o[0])?o[0]:parseInt(o[0]),l=1==o.length?a:isNaN(o[1])?o[1]:parseInt(o[1]);if(s.quantifier={min:a,max:l},n.length>0){var c=n[n.length-1].matches;if(e=c.pop(),!e.isGroup){var r=new d(!0);r.matches.push(e),e=r}c.push(e),c.push(s)}else{if(e=i.matches.pop(),!e.isGroup){var r=new d(!0);r.matches.push(e),e=r}i.matches.push(e),i.matches.push(s)}break;default:n.length>0?n[n.length-1].matches.push(t):i.matches.push(t)}i.matches.length>0&&u.regexTokens.push(i)}function m(e,t){var i=!1;t&&(v+="(",y++);for(var n=0;n<e.matches.length;n++){var r=e.matches[n];if(1==r.isGroup)i=m(r,!0);else if(1==r.isQuantifier){var s=C.inArray(r,e.matches),o=e.matches[s-1],a=v;if(isNaN(r.quantifier.max)){for(;r.repeaterPart&&r.repeaterPart!=v&&r.repeaterPart.length>v.length&&!(i=m(o,!0)););i=i||m(o,!0),i&&(r.repeaterPart=v),v=a+r.quantifier.max}else{for(var l=0,c=r.quantifier.max-1;c>l&&!(i=m(o,!0));l++);v=a+"{"+r.quantifier.min+","+r.quantifier.max+"}"}}else if(void 0!=r.matches)for(var u=0;u<r.length&&!(i=m(r[u],t));u++);else{var d;if("["==r.charAt(0)){d=v,d+=r;for(var h=0;y>h;h++)d+=")";var p=new RegExp("^("+d+")$");i=p.test(b)}else for(var f=0,g=r.length;g>f;f++)if("\\"!=r.charAt(f)){d=v,d+=r.substr(0,f+1),d=d.replace(/\|$/,"");for(var h=0;y>h;h++)d+=")";var p=new RegExp("^("+d+")$");if(i=p.test(b))break}v+=r}if(i)break}return t&&(v+=")",y--),i}null==u.regexTokens&&r();var s=t.buffer.slice(),v="",o=!1,y=0;s.splice(i,0,e);for(var b=s.join(""),a=0;a<u.regexTokens.length;a++){var d=u.regexTokens[a];if(o=m(d,d.isGroup))break}return o},cardinality:1}}}}),C.fn.inputmask}(jQuery);(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports==="object"){e(require("jquery"))}else{e(window.jQuery)}})(function(l){"use strict";var n=0;l.ajaxTransport("iframe",function(r){if(r.async){var s=r.initialIframeSrc||"javascript:false;",o,a,t;return{send:function(e,i){o=l('<form style="display:none;"></form>');o.attr("accept-charset",r.formAcceptCharset);t=/\?/.test(r.url)?"&":"?";if(r.type==="DELETE"){r.url=r.url+t+"_method=DELETE";r.type="POST"}else if(r.type==="PUT"){r.url=r.url+t+"_method=PUT";r.type="POST"}else if(r.type==="PATCH"){r.url=r.url+t+"_method=PATCH";r.type="POST"}n+=1;a=l('<iframe src="'+s+'" name="iframe-transport-'+n+'"></iframe>').bind("load",function(){var n,t=l.isArray(r.paramName)?r.paramName:[r.paramName];a.unbind("load").bind("load",function(){var t;try{t=a.contents();if(!t.length||!t[0].firstChild){throw new Error}}catch(e){t=undefined}i(200,"success",{iframe:t});l('<iframe src="'+s+'"></iframe>').appendTo(o);window.setTimeout(function(){o.remove()},0)});o.prop("target",a.prop("name")).prop("action",r.url).prop("method",r.type);if(r.formData){l.each(r.formData,function(e,t){l('<input type="hidden"/>').prop("name",t.name).val(t.value).appendTo(o)})}if(r.fileInput&&r.fileInput.length&&r.type==="POST"){n=r.fileInput.clone();r.fileInput.after(function(e){return n[e]});if(r.paramName){r.fileInput.each(function(e){l(this).prop("name",t[e]||r.paramName)})}o.append(r.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data");r.fileInput.removeAttr("form")}o.submit();if(n&&n.length){r.fileInput.each(function(e,t){var i=l(n[e]);l(t).prop("name",i.prop("name")).attr("form",i.attr("form"));i.replaceWith(t)})}});o.append(a).appendTo(document.body)},abort:function(){if(a){a.unbind("load").prop("src",s)}if(o){o.remove()}}}}});l.ajaxSetup({converters:{"iframe text":function(e){return e&&l(e[0].body).text()},"iframe json":function(e){return e&&l.parseJSON(l(e[0].body).text())},"iframe html":function(e){return e&&l(e[0].body).html()},"iframe xml":function(e){var t=e&&e[0];return t&&l.isXMLDoc(t)?t:l.parseXML(t.XMLDocument&&t.XMLDocument.xml||l(t.body).html())},"iframe script":function(e){return e&&l.globalEval(l(e[0].body).text())}}})});(function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e){this.el=e;this.dragleave=t(this.dragleave,this);this.dragenter=t(this.dragenter,this);if(this.supportsEventConstructors()){this.first=false;this.second=false;this.el.addEventListener("dragenter",this.dragenter,false);this.el.addEventListener("dragleave",this.dragleave,false)}}e.prototype.dragenter=function(e){if(this.first){return this.second=true}else{this.first=true;return this.el.dispatchEvent(new CustomEvent("dragster:enter",{bubbles:true,cancelable:true,detail:{dataTransfer:e.dataTransfer}}))}};e.prototype.dragleave=function(e){if(this.second){this.second=false}else if(this.first){this.first=false}if(!this.first&&!this.second){return this.el.dispatchEvent(new CustomEvent("dragster:leave",{bubbles:true,cancelable:true,detail:{dataTransfer:e.dataTransfer}}))}};e.prototype.removeListeners=function(){this.el.removeEventListener("dragenter",this.dragenter,false);return this.el.removeEventListener("dragleave",this.dragleave,false)};e.prototype.supportsEventConstructors=function(){try{new CustomEvent("z")}catch(e){return false}return true};e.prototype.reset=function(){this.first=false;return this.second=false};return e}();if(typeof module==="undefined"){window.Dragster=e}else{module.exports=e}}).call(this);(function(){var e;e=function(){function e(e,t){var i;if(t==null){t=[]}i={script:null,ajaxQueue:false,autoUpload:false,classDragOver:"is-dragover",onUploadingFiles:function(e,t){},onSelectFiles:function(e,t){},onSuccessFile:function(e,t,i){},onComplete:function(e,t){},onFileError:function(e,t){},onFileFail:function(e,t){}};this.options=$.extend(i,t);this.files=[];$.each($(e),function(r){return function(e,t){var i,n;i=$(t);n=i.find("input[type=file]");i.data("pos",e);n.on("change",function(e){var t;t=$(e.currentTarget).prop("files");r.options.onSelectFiles(t,i);r.files[i.data("pos")]=e.target.files;if(r.options.autoUpload){return r.submit(i,e.target.files)}});return r.initDrag(i)}}(this))}e.prototype.initDrag=function(i){var n;if(this.isAdvancedUpload()){n=false;return i.on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault();e.stopPropagation()}).on("dragover dragenter",function(e){return function(){i.addClass(e.options.classDragOver)}}(this)).on("dragleave dragend drop",function(e){return function(){i.removeClass(e.options.classDragOver)}}(this)).on("drop",function(t){return function(e){n=e.originalEvent.dataTransfer.files;t.options.onSelectFiles(n,i);if(t.options.autoUpload){return t.submit(i,n)}else{return t.files[i.data("pos")]=n}}}(this))}};e.prototype.startUpload=function(e){var t;t=this.files[e.data("pos")];if(t){return this.submit(e,t)}};e.prototype.submit=function(i,t){var e,n,r,s,o,a,l,c,u,d;if(i.hasClass("is-uploading")){return false}i.addClass("is-uploading");u=t.length;d=1;r=i.find("input[type=file]").attr("name");this.options.onUploadingFiles(d,u);c=[];for(o=s=0,a=t.length;s<a;o=++s){n=t[o];l=new FormData;l.append(r+"[]",n);l.append("position",o);e=this.options.ajaxQueue?$.ajaxQueue:$.ajax;c.push(e({url:this.options.script,type:"POST",data:l,processData:false,contentType:false,cache:false,complete:function(e){return function(){d++;if(d>=u+1){e.options.onComplete(t,i);e.removeFiles(i);return i.removeClass("is-uploading")}else{return e.options.onUploadingFiles(d,u)}}}(this),success:function(t){return function(e){t.options.onSuccessFile(n,e,i)}}(this),fail:function(t){return function(e){t.options.onFileFail(e,i)}}(this),error:function(t){return function(e){t.options.onFileError(e,i)}}(this)}))}return c};e.prototype.removeFiles=function(e){return this.files[e.data("pos")]=null};e.prototype.isAdvancedUpload=function(){var e;e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&"FormData"in window&&"FileReader"in window};e.prototype.isFormData=function(){return"FormData"in window};e.prototype.isFileReader=function(){return"FileReader"in window};e.prototype.isDraggable=function(){var e;e=document.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e};return e}();if(typeof module==="undefined"){window.Dropzone=e}else{module.exports=e}return e}).call(this);(function(u,d){var e="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),h=/^([\-+])=\s*(\d+\.?\d*)/,t=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],p=u.Color=function(e,t,i,n){return new u.Color.fn.parse(e,t,i,n)},f={rgba:{cache:"_rgba",props:{red:{idx:0,type:"byte",empty:true},green:{idx:1,type:"byte",empty:true},blue:{idx:2,type:"byte",empty:true},alpha:{idx:3,type:"percent",def:1}}},hsla:{cache:"_hsla",props:{hue:{idx:0,type:"degrees",empty:true},saturation:{idx:1,type:"percent",empty:true},lightness:{idx:2,type:"percent",empty:true}}}},g={byte:{floor:true,min:0,max:255},percent:{min:0,max:1},degrees:{mod:360,floor:true}},l=f.rgba.props,o=p.support={},m,v=u.each;f.hsla.props.alpha=l.alpha;function y(e,t,i){var n=g[t.type]||{},r=t.empty||i;if(r&&e==null){return null}if(t.def&&e==null){return t.def}if(n.floor){e=~~e}else{e=parseFloat(e)}if(e==null||isNaN(e)){return t.def}if(n.mod){e=e%n.mod;return e<0?n.mod+e:e}return n.min>e?n.min:n.max<e?n.max:e}function c(a){var l=p(),c=l._rgba=[];a=a.toLowerCase();v(t,function(e,t){var i=t.re.exec(a),n=i&&t.parse(i),r,s=t.space||"rgba",o=f[s].cache;if(n){r=l[s](n);l[o]=r[o];c=l._rgba=r._rgba;return false}});if(c.length!==0){if(Math.max.apply(Math,c)===0){u.extend(c,m.transparent)}return l}if(a=m[a]){return a}}p.fn=p.prototype={constructor:p,parse:function(r,e,t,i){if(r===d){this._rgba=[null,null,null,null];return this}if(r instanceof u||r.nodeType){r=r instanceof u?r.css(e):u(r).css(e);e=d}var s=this,n=u.type(r),o=this._rgba=[],a;if(e!==d){r=[r,e,t,i];n="array"}if(n==="string"){return this.parse(c(r)||m._default)}if(n==="array"){v(l,function(e,t){o[t.idx]=y(r[t.idx],t)});return this}if(n==="object"){if(r instanceof p){v(f,function(e,t){if(r[t.cache]){s[t.cache]=r[t.cache].slice()}})}else{v(f,function(e,n){v(n.props,function(e,t){var i=n.cache;if(!s[i]&&n.to){if(r[e]==null||e==="alpha"){return}s[i]=n.to(s._rgba)}s[i][t.idx]=y(r[e],t,true)})})}return this}},is:function(e){var r=p(e),s=true,o=this;v(f,function(e,t){var i=r[t.cache],n;if(i){n=o[t.cache]||t.to&&t.to(o._rgba)||[];v(t.props,function(e,t){if(i[t.idx]!=null){s=i[t.idx]===n[t.idx];return s}})}return s});return s},_space:function(){var i=[],n=this;v(f,function(e,t){if(n[t.cache]){i.push(e)}});return i.pop()},transition:function(e,o){var a=p(e),t=a._space(),i=f[t],l=this[i.cache]||i.to(this._rgba),c=l.slice();a=a[i.cache];v(i.props,function(e,t){var i=t.idx,n=l[i],r=a[i],s=g[t.type]||{};if(r===null){return}if(n===null){c[i]=r}else{if(s.mod){if(r-n>s.mod/2){n+=s.mod}else if(n-r>s.mod/2){n-=s.mod}}c[t.idx]=y((r-n)*o+n,t)}});return this[t](c)},blend:function(e){if(this._rgba[3]===1){return this}var t=this._rgba.slice(),i=t.pop(),n=p(e)._rgba;return p(u.map(t,function(e,t){return(1-i)*n[t]+i*e}))},toRgbaString:function(){var e="rgba(",t=u.map(this._rgba,function(e,t){return e==null?t>2?1:0:e});if(t[3]===1){t.pop();e="rgb("}return e+t.join(",")+")"},toHslaString:function(){var e="hsla(",t=u.map(this.hsla(),function(e,t){if(e==null){e=t>2?1:0}if(t&&t<3){e=Math.round(e*100)+"%"}return e});if(t[3]===1){t.pop();e="hsl("}return e+t.join(",")+")"},toHexString:function(e){var t=this._rgba.slice(),i=t.pop();if(e){t.push(~~(i*255))}return"#"+u.map(t,function(e,t){e=(e||0).toString(16);return e.length===1?"0"+e:e}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}};p.fn.parse.prototype=p.fn;function b(e,t,i){i=(i+1)%1;if(i*6<1){return e+(t-e)*6*i}if(i*2<1){return t}if(i*3<2){return e+(t-e)*(2/3-i)*6}return e}f.hsla.to=function(e){if(e[0]==null||e[1]==null||e[2]==null){return[null,null,null,e[3]]}var t=e[0]/255,i=e[1]/255,n=e[2]/255,r=e[3],s=Math.max(t,i,n),o=Math.min(t,i,n),a=s-o,l=s+o,c=l*.5,u,d;if(o===s){u=0}else if(t===s){u=60*(i-n)/a+360}else if(i===s){u=60*(n-t)/a+120}else{u=60*(t-i)/a+240}if(c===0||c===1){d=c}else if(c<=.5){d=a/l}else{d=a/(2-l)}return[Math.round(u)%360,d,c,r==null?1:r]};f.hsla.from=function(e){if(e[0]==null||e[1]==null||e[2]==null){return[null,null,null,e[3]]}var t=e[0]/360,i=e[1],n=e[2],r=e[3],s=n<=.5?n*(1+i):n+i-n*i,o=2*n-s,a,l,c;return[Math.round(b(o,s,t+1/3)*255),Math.round(b(o,s,t)*255),Math.round(b(o,s,t-1/3)*255),r]};v(f,function(l,e){var i=e.props,o=e.cache,a=e.to,c=e.from;p.fn[l]=function(e){if(a&&!this[o]){this[o]=a(this._rgba)}if(e===d){return this[o].slice()}var n=u.type(e),r=n==="array"||n==="object"?e:arguments,s=this[o].slice(),t;v(i,function(e,t){var i=r[n==="object"?e:t.idx];if(i==null){i=s[t.idx]}s[t.idx]=y(i,t)});if(c){t=p(c(s));t[o]=s;return t}else{return p(s)}};v(i,function(o,a){if(p.fn[o]){return}p.fn[o]=function(e){var t=u.type(e),i=o==="alpha"?this._hsla?"hsla":"rgba":l,n=this[i](),r=n[a.idx],s;if(t==="undefined"){return r}if(t==="function"){e=e.call(this,r);t=u.type(e)}if(e==null&&a.empty){return this}if(t==="string"){s=h.exec(e);if(s){e=r+parseFloat(s[2])*(s[1]==="+"?1:-1)}}n[a.idx]=e;return this[i](n)}})});v(e,function(e,s){u.cssHooks[s]={set:function(e,t){var i,n,r;if(u.type(t)!=="string"||(i=c(t))){t=p(i||t);if(!o.rgba&&t._rgba[3]!==1){r=s==="backgroundColor"?e.parentNode:e;do{n=u.curCSS(r,"backgroundColor")}while((n===""||n==="transparent")&&(r=r.parentNode)&&r.style);t=t.blend(n&&n!=="transparent"?n:"_default")}t=t.toRgbaString()}e.style[s]=t}};u.fx.step[s]=function(e){if(!e.colorInit){e.start=p(e.elem,s);e.end=p(e.end);e.colorInit=true}u.cssHooks[s].set(e.elem,e.start.transition(e.end,e.pos))}});u(function(){var e=document.createElement("div"),t=e.style;t.cssText="background-color:rgba(1,1,1,.5)";o.rgba=t.backgroundColor.indexOf("rgba")>-1});m=u.Color.names={aqua:"#00ffff",azure:"#f0ffff",beige:"#f5f5dc",black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightcyan:"#e0ffff",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightyellow:"#ffffe0",lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);(function(ve){ve.Jcrop=function(e,t){var x=ve.extend({},ve.Jcrop.defaults),o,r=navigator.userAgent.toLowerCase(),s=/msie/.test(r),m=/msie [1-6]\./.test(r);function D(e){return Math.round(e)+"px"}function R(e){return x.baseClass+"-"+e}function v(){return ve.fx.step.hasOwnProperty("backgroundColor")}function a(e){var t=ve(e).offset();return[t.left,t.top]}function d(e){return[e.pageX-o[0],e.pageY-o[1]]}function y(e){if(typeof e!=="object")e={};x=ve.extend(x,e);ve.each(["onChange","onSelect","onRelease","onDblClick"],function(e,t){if(typeof x[t]!=="function")x[t]=function(){}})}function b(e,t,i){o=a(N);g.setCursor(e==="move"?e:e+"-resize");if(e==="move"){return g.activateHandlers(W(t),l,i)}var n=G.getFixed();var r=z(e);var s=G.getCorner(z(r));G.setPressed(G.getCorner(r));G.setCurrent(s);g.activateHandlers(V(e,n),l,i)}function V(t,i){return function(e){if(!x.aspectRatio){switch(t){case"e":e[1]=i.y2;break;case"w":e[1]=i.y2;break;case"n":e[0]=i.x2;break;case"s":e[0]=i.x2;break}}else{switch(t){case"e":e[1]=i.y+1;break;case"w":e[1]=i.y+1;break;case"n":e[0]=i.x+1;break;case"s":e[0]=i.x+1;break}}G.setCurrent(e);H.update()}}function W(e){var t=e;ie.watchKeys();return function(e){G.moveOffset([e[0]-t[0],e[1]-t[1]]);t=e;H.update()}}function z(e){switch(e){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function j(t){return function(e){if(x.disabled){return false}if(t==="move"&&!x.allowMove){return false}o=a(N);f=true;b(t,d(e));e.stopPropagation();e.preventDefault();return false}}function U(e,t,i){var n=e.width(),r=e.height();if(n>t&&t>0){n=t;r=t/e.width()*e.height()}if(r>i&&i>0){r=i;n=i/e.height()*e.width()}S=e.width()/n;T=e.height()/r;e.width(n).height(r)}function M(e){return{x:e.x*S,y:e.y*T,x2:e.x2*S,y2:e.y2*T,w:e.w*S,h:e.h*T}}function l(e){var t=G.getFixed();if(t.w>x.minSelect[0]&&t.h>x.minSelect[1]){H.enableHandles();H.done()}else{H.release()}g.setCursor(x.allowSelect?"crosshair":"default")}function Y(e){if(x.disabled){return false}if(!x.allowSelect){return false}f=true;o=a(N);H.disableHandles();g.setCursor("crosshair");var t=d(e);G.setPressed(t);H.update();g.activateHandlers(q,l,e.type.substring(0,5)==="touch");ie.watchKeys();e.stopPropagation();e.preventDefault();return false}function q(e){G.setCurrent(e);H.update()}function K(){var e=ve("<div></div>").addClass(R("tracker"));if(s){e.css({opacity:0,backgroundColor:"white"})}return e}if(typeof e!=="object"){e=ve(e)[0]}if(typeof t!=="object"){t={}}y(t);var i={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0};var n=ve(e),X=true;if(e.tagName=="IMG"){if(n[0].width!=0&&n[0].height!=0){n.width(n[0].width);n.height(n[0].height)}else{var Q=new Image;Q.src=n[0].src;n.width(Q.width);n.height(Q.height)}var N=n.clone().removeAttr("id").css(i).show();N.width(n.width());N.height(n.height());n.after(N).hide()}else{N=n.css(i).show();X=false;if(x.shade===null){x.shade=true}}U(N,x.boxWidth,x.boxHeight);var C=N.width(),w=N.height(),p=ve("<div />").width(C).height(w).addClass(R("holder")).css({position:"relative",backgroundColor:x.bgColor}).insertAfter(n).append(N);if(x.addClass){p.addClass(x.addClass)}var O=ve("<div />"),I=ve("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),P=ve("<div />").width("100%").height("100%").css("zIndex",320),k=ve("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var e=G.getFixed();x.onDblClick.call(B,e)}).insertBefore(N).append(I,P);if(X){O=ve("<img />").attr("src",N.attr("src")).css(i).width(C).height(w),I.append(O)}if(m){k.css({overflowY:"hidden"})}var c=x.boundary;var h=K().width(C+c*2).height(w+c*2).css({position:"absolute",top:D(-c),left:D(-c),zIndex:290}).mousedown(Y);var Z=x.bgColor,L=x.bgOpacity,u,_,A,E,S,T,J=true,f,ee,te;o=a(N);var F=function(){function e(){var e={},t=["touchstart","touchmove","touchend"],i=document.createElement("div"),n;try{for(n=0;n<t.length;n++){var r=t[n];r="on"+r;var s=r in i;if(!s){i.setAttribute(r,"return;");s=typeof i[r]=="function"}e[t[n]]=s}return e.touchstart&&e.touchend&&e.touchmove}catch(e){return false}}function t(){if(x.touchSupport===true||x.touchSupport===false)return x.touchSupport;else return e()}return{createDragger:function(t){return function(e){if(x.disabled){return false}if(t==="move"&&!x.allowMove){return false}o=a(N);f=true;b(t,d(F.cfilter(e)),true);e.stopPropagation();e.preventDefault();return false}},newSelection:function(e){return Y(F.cfilter(e))},cfilter:function(e){e.pageX=e.originalEvent.changedTouches[0].pageX;e.pageY=e.originalEvent.changedTouches[0].pageY;return e},isSupported:e,support:t()}}();var G=function(){var p=0,f=0,g=0,m=0,t,i;function e(e){e=l(e);g=p=e[0];m=f=e[1]}function n(e){e=l(e);t=e[0]-g;i=e[1]-m;g=e[0];m=e[1]}function r(){return[t,i]}function s(e){var t=e[0],i=e[1];if(0>p+t){t-=t+p}if(0>f+i){i-=i+f}if(w<m+i){i+=w-(m+i)}if(C<g+t){t+=C-(g+t)}p+=t;g+=t;f+=i;m+=i}function o(e){var t=a();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}}function a(){if(!x.aspectRatio){return y()}var e=x.aspectRatio,t=x.minSize[0]/S,i=x.maxSize[0]/S,n=x.maxSize[1]/T,r=g-p,s=m-f,o=Math.abs(r),a=Math.abs(s),l=o/a,c,u,d,h;if(i===0){i=C*10}if(n===0){n=w*10}if(l<e){u=m;d=a*e;c=r<0?p-d:d+p;if(c<0){c=0;h=Math.abs((c-p)/e);u=s<0?f-h:h+f}else if(c>C){c=C;h=Math.abs((c-p)/e);u=s<0?f-h:h+f}}else{c=g;h=o/e;u=s<0?f-h:f+h;if(u<0){u=0;d=Math.abs((u-f)*e);c=r<0?p-d:d+p}else if(u>w){u=w;d=Math.abs(u-f)*e;c=r<0?p-d:d+p}}if(c>p){if(c-p<t){c=p+t}else if(c-p>i){c=p+i}if(u>f){u=f+(c-p)/e}else{u=f-(c-p)/e}}else if(c<p){if(p-c<t){c=p-t}else if(p-c>i){c=p-i}if(u>f){u=f+(p-c)/e}else{u=f-(p-c)/e}}if(c<0){p-=c;c=0}else if(c>C){p-=c-C;c=C}if(u<0){f-=u;u=0}else if(u>w){f-=u-w;u=w}return b(v(p,f,c,u))}function l(e){if(e[0]<0)e[0]=0;if(e[1]<0)e[1]=0;if(e[0]>C)e[0]=C;if(e[1]>w)e[1]=w;return[Math.round(e[0]),Math.round(e[1])]}function v(e,t,i,n){var r=e,s=i,o=t,a=n;if(i<e){r=i;s=e}if(n<t){o=n;a=t}return[r,o,s,a]}function y(){var e=g-p,t=m-f,i;if(u&&Math.abs(e)>u){g=e>0?p+u:p-u}if(_&&Math.abs(t)>_){m=t>0?f+_:f-_}if(E/T&&Math.abs(t)<E/T){m=t>0?f+E/T:f-E/T}if(A/S&&Math.abs(e)<A/S){g=e>0?p+A/S:p-A/S}if(p<0){g-=p;p-=p}if(f<0){m-=f;f-=f}if(g<0){p-=g;g-=g}if(m<0){f-=m;m-=m}if(g>C){i=g-C;p-=i;g-=i}if(m>w){i=m-w;f-=i;m-=i}if(p>C){i=p-w;m-=i;f-=i}if(f>w){i=f-w;m-=i;f-=i}return b(v(p,f,g,m))}function b(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}return{flipCoords:v,setPressed:e,setCurrent:n,getOffset:r,moveOffset:s,getCorner:o,getFixed:a}}();var $=function(){var i=false,n=ve("<div />").css({position:"absolute",zIndex:240,opacity:0}),r={top:o(),left:o().height(w),right:o().height(w),bottom:o()};function e(e,t){r.left.css({height:D(t)});r.right.css({height:D(t)})}function t(){return s(G.getFixed())}function s(e){r.top.css({left:D(e.x),width:D(e.w),height:D(e.y)});r.bottom.css({top:D(e.y2),left:D(e.x),width:D(e.w),height:D(w-e.y2)});r.right.css({left:D(e.x2),width:D(C-e.x2)});r.left.css({width:D(e.x)})}function o(){return ve("<div />").css({position:"absolute",backgroundColor:x.shadeColor||x.bgColor}).appendTo(n)}function a(){if(!i){i=true;n.insertBefore(N);t();H.setBgOpacity(1,0,1);O.hide();l(x.shadeColor||x.bgColor,1);if(H.isAwake()){u(x.bgOpacity,1)}else u(1,1)}}function l(e,t){ge(h(),e,t)}function c(){if(i){n.remove();O.show();i=false;if(H.isAwake()){H.setBgOpacity(x.bgOpacity,1,1)}else{H.setBgOpacity(1,1,1);H.disableHandles()}ge(p,0,1)}}function u(e,t){if(i){if(x.bgFade&&!t){n.animate({opacity:1-e},{queue:false,duration:x.fadeTime})}else n.css({opacity:1-e})}}function d(){x.shade?a():c();if(H.isAwake())u(x.bgOpacity)}function h(){return n.children()}return{update:t,updateRaw:s,getShades:h,setBgColor:l,enable:a,disable:c,resize:e,refresh:d,opacity:u}}();var H=function(){var n,r=370,s={},i={},o={},e=false;function a(e){var t=ve("<div />").css({position:"absolute",opacity:x.borderOpacity}).addClass(R(e));I.append(t);return t}function l(e,t){var i=ve("<div />").mousedown(j(e)).css({cursor:e+"-resize",position:"absolute",zIndex:t}).addClass("ord-"+e);if(F.support){i.bind("touchstart.jcrop",F.createDragger(e))}P.append(i);return i}function c(e){var t=x.handleSize,i=l(e,r++).css({opacity:x.handleOpacity}).addClass(R("handle"));if(t){i.width(t).height(t)}return i}function u(e){return l(e,r++).addClass("jcrop-dragbar")}function t(e){var t;for(t=0;t<e.length;t++){o[e[t]]=u(e[t])}}function d(e){var t,i;for(i=0;i<e.length;i++){switch(e[i]){case"n":t="hline";break;case"s":t="hline bottom";break;case"e":t="vline right";break;case"w":t="vline";break}s[e[i]]=a(t)}}function h(e){var t;for(t=0;t<e.length;t++){i[e[t]]=c(e[t])}}function p(e,t){if(!x.shade){O.css({top:D(-t),left:D(-e)})}k.css({top:D(t),left:D(e)})}function f(e,t){k.width(Math.round(e)).height(Math.round(t))}function g(){var e=G.getFixed();G.setPressed([e.x,e.y]);G.setCurrent([e.x2,e.y2]);m()}function m(e){if(n){return v(e)}}function v(e){var t=G.getFixed();f(t.w,t.h);p(t.x,t.y);if(x.shade)$.updateRaw(t);n||b();if(e){x.onSelect.call(B,M(t))}else{x.onChange.call(B,M(t))}}function y(e,t,i){if(!n&&!t)return;if(x.bgFade&&!i){N.animate({opacity:e},{queue:false,duration:x.fadeTime})}else{N.css("opacity",e)}}function b(){k.show();if(x.shade)$.opacity(L);else y(L,true);n=true}function C(){A();k.hide();if(x.shade)$.opacity(1);else y(1);n=false;x.onRelease.call(B)}function w(){if(e){P.show()}}function _(){e=true;if(x.allowResize){P.show();return true}}function A(){e=false;P.hide()}function E(e){if(e){ee=true;A()}else{ee=false;_()}}function S(){E(false);g()}if(x.dragEdges&&ve.isArray(x.createDragbars))t(x.createDragbars);if(ve.isArray(x.createHandles))h(x.createHandles);if(x.drawBorders&&ve.isArray(x.createBorders))d(x.createBorders);ve(document).bind("touchstart.jcrop-ios",function(e){if(ve(e.currentTarget).hasClass("jcrop-tracker"))e.stopPropagation()});var T=K().mousedown(j("move")).css({cursor:"move",position:"absolute",zIndex:360});if(F.support){T.bind("touchstart.jcrop",F.createDragger("move"))}I.append(T);A();return{updateVisible:m,update:v,release:C,refresh:g,isAwake:function(){return n},setCursor:function(e){T.css("cursor",e)},enableHandles:_,enableOnly:function(){e=true},showHandles:w,disableHandles:A,animMode:E,setBgOpacity:y,done:S}}();var g=function(){var n=function(){},r=function(){},t=x.trackDocument;function s(e){h.css({zIndex:450});if(e)ve(document).bind("touchmove.jcrop",l).bind("touchend.jcrop",c);else if(t)ve(document).bind("mousemove.jcrop",o).bind("mouseup.jcrop",a)}function i(){h.css({zIndex:290});ve(document).unbind(".jcrop")}function o(e){n(d(e));return false}function a(e){e.preventDefault();e.stopPropagation();if(f){f=false;r(d(e));if(H.isAwake()){x.onSelect.call(B,M(G.getFixed()))}i();n=function(){};r=function(){}}return false}function e(e,t,i){f=true;n=e;r=t;s(i);return false}function l(e){n(d(F.cfilter(e)));return false}function c(e){return a(F.cfilter(e))}function u(e){h.css("cursor",e)}if(!t){h.mousemove(o).mouseup(a).mouseout(a)}N.before(h);return{activateHandlers:e,setCursor:u}}();var ie=function(){var t=ve('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),e=ve("<div />").css({position:"absolute",overflow:"hidden"}).append(t);function i(){if(x.keySupport){}}function n(e){t.hide()}function r(e,t,i){if(x.allowMove){G.moveOffset([t,i]);H.updateVisible(true)}e.preventDefault();e.stopPropagation()}function s(e){if(e.ctrlKey||e.metaKey){return true}te=e.shiftKey?true:false;var t=te?10:1;switch(e.keyCode){case 37:r(e,-t,0);break;case 39:r(e,t,0);break;case 38:r(e,0,-t);break;case 40:r(e,0,t);break;case 27:if(x.allowSelect)H.release();break;case 9:return true}return false}if(x.keySupport){t.keydown(s).blur(n);if(m||!x.fixedSupport){t.css({position:"absolute",left:"-20px"});e.append(t).insertBefore(N)}else{t.insertBefore(N)}t.hide()}return{watchKeys:i}}();function ne(e){p.removeClass().addClass(R("holder")).addClass(e)}function re(e,t){var i=e[0]/S,n=e[1]/T,r=e[2]/S,s=e[3]/T;if(ee){return}var o=G.flipCoords(i,n,r,s),a=G.getFixed(),l=[a.x,a.y,a.x2,a.y2],c=l,u=x.animationDelay,d=o[0]-l[0],h=o[1]-l[1],p=o[2]-l[2],f=o[3]-l[3],g=0,m=x.swingSpeed;i=c[0];n=c[1];r=c[2];s=c[3];H.animMode(true);var v;function y(){window.setTimeout(b,u)}var b=function(){return function(){g+=(100-g)/m;c[0]=Math.round(i+g/100*d);c[1]=Math.round(n+g/100*h);c[2]=Math.round(r+g/100*p);c[3]=Math.round(s+g/100*f);if(g>=99.8){g=100}if(g<100){oe(c);y()}else{H.done();H.animMode(false);if(typeof t==="function"){t.call(B)}}}}();y()}function se(e){oe([e[0]/S,e[1]/T,e[2]/S,e[3]/T]);x.onSelect.call(B,M(G.getFixed()));H.enableHandles()}function oe(e){G.setPressed([e[0],e[1]]);G.setCurrent([e[2],e[3]]);H.update()}function ae(){return M(G.getFixed())}function le(){return G.getFixed()}function ce(e){y(e);me()}function ue(){x.disabled=true;H.disableHandles();H.setCursor("default");g.setCursor("default")}function de(){x.disabled=false;me()}function he(){H.done();g.activateHandlers(null,null)}function pe(){p.remove();n.show();n.css("visibility","visible");ve(e).removeData("Jcrop")}function fe(r,s){H.release();ue();var o=new Image;o.onload=function(){var e=o.width;var t=o.height;var i=x.boxWidth;var n=x.boxHeight;N.width(e).height(t);N.attr("src",r);O.attr("src",r);U(N,i,n);C=N.width();w=N.height();O.width(C).height(w);h.width(C+c*2).height(w+c*2);p.width(C).height(w);$.resize(C,w);de();if(typeof s==="function"){s.call(B)}};o.src=r}function ge(e,t,i){var n=t||x.bgColor;if(x.bgFade&&v()&&x.fadeTime&&!i){e.animate({backgroundColor:n},{queue:false,duration:x.fadeTime})}else{e.css("backgroundColor",n)}}function me(e){if(x.allowResize){if(e){H.enableOnly()}else{H.enableHandles()}}else{H.disableHandles()}g.setCursor(x.allowSelect?"crosshair":"default");H.setCursor(x.allowMove?"move":"default");if(x.hasOwnProperty("trueSize")){S=x.trueSize[0]/C;T=x.trueSize[1]/w}if(x.hasOwnProperty("setSelect")){se(x.setSelect);H.done();delete x.setSelect}$.refresh();if(x.bgColor!=Z){ge(x.shade?$.getShades():p,x.shade?x.shadeColor||x.bgColor:x.bgColor);Z=x.bgColor}if(L!=x.bgOpacity){L=x.bgOpacity;if(x.shade)$.refresh();else H.setBgOpacity(L)}u=x.maxSize[0]||0;_=x.maxSize[1]||0;A=x.minSize[0]||0;E=x.minSize[1]||0;if(x.hasOwnProperty("outerImage")){N.attr("src",x.outerImage);delete x.outerImage}H.refresh()}if(F.support)h.bind("touchstart.jcrop",F.newSelection);P.hide();me(true);var B={setImage:fe,animateTo:re,setSelect:se,setOptions:ce,tellSelect:ae,tellScaled:le,setClass:ne,disable:ue,enable:de,cancel:he,release:H.release,destroy:pe,focus:ie.watchKeys,getBounds:function(){return[C*S,w*T]},getWidgetSize:function(){return[C,w]},getScaleFactor:function(){return[S,T]},getOptions:function(){return x},ui:{holder:p,selection:k}};if(s)p.bind("selectstart",function(){return false});n.data("Jcrop",B);return B};ve.fn.Jcrop=function(e,t){var i;this.each(function(){if(ve(this).data("Jcrop")){if(e==="api")return ve(this).data("Jcrop");else ve(this).data("Jcrop").setOptions(e)}else{if(this.tagName=="IMG")ve.Jcrop.Loader(this,function(){ve(this).css({display:"block",visibility:"hidden"});i=ve.Jcrop(this,e);if(ve.isFunction(t))t.call(i)});else{ve(this).css({display:"block",visibility:"hidden"});i=ve.Jcrop(this,e);if(ve.isFunction(t))t.call(i)}}});return this};ve.Jcrop.Loader=function(e,t,i){var n=ve(e),r=n[0];function s(){if(r.complete){n.unbind(".jcloader");if(ve.isFunction(t))t.call(r)}else window.setTimeout(s,50)}n.bind("load.jcloader",s).bind("error.jcloader",function(e){n.unbind(".jcloader");if(ve.isFunction(i))i.call(r)});if(r.complete&&ve.isFunction(t)){n.unbind(".jcloader");t.call(r)}};ve.Jcrop.defaults={allowSelect:true,allowMove:true,allowResize:true,trackDocument:true,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:false,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:true,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:true,dragEdges:true,fixedSupport:true,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}})(jQuery);(function(e,t){if(typeof define==="function"&&define.amd){define(["jquery"],t)}else{t(e.jQuery)}})(this,function(d){"use strict";d.extendext=function(){var e,t,i,n,r,s,o=arguments[0]||{},a=1,l=arguments.length,c=false,u="default";if(typeof o==="boolean"){c=o;o=arguments[a++]||{}}if(typeof o==="string"){u=d([o.toLowerCase(),"default"]).filter(["default","concat","replace","extend"])[0];o=arguments[a++]||{}}if(typeof o!=="object"&&!d.isFunction(o)){o={}}if(a===l){o=this;a--}for(;a<l;a++){if((e=arguments[a])!==null){if(d.isArray(e)&&u!=="default"){s=o&&d.isArray(o)?o:[];switch(u){case"concat":o=s.concat(d.extend(c,[],e));break;case"replace":o=d.extend(c,[],e);break;case"extend":e.forEach(function(e,t){if(typeof e==="object"){var i=d.isArray(e)?[]:{};s[t]=d.extendext(c,u,s[t]||i,e)}else if(s.indexOf(e)===-1){s.push(e)}});o=s;break}}else{for(t in e){i=o[t];n=e[t];if(o===n){continue}if(c&&n&&(d.isPlainObject(n)||(r=d.isArray(n)))){if(r){r=false;s=i&&d.isArray(i)?i:[]}else{s=i&&d.isPlainObject(i)?i:{}}o[t]=d.extendext(c,u,s,n)}else if(n!==undefined){o[t]=n}}}}}return o}});(function(){"use strict";var l={version:"1.0.3",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:true,append:true,selfcontained:false,doNotSkipEncoded:false},template:undefined,compile:undefined},c;l.encodeHTMLSource=function(e){var t={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=e?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(e){return e?e.toString().replace(i,function(e){return t[e]||e}):""}};c=function(){return this||(0,eval)("this")}();if(typeof module!=="undefined"&&module.exports){module.exports=l}else if(typeof define==="function"&&define.amd){define(function(){return l})}else{c.doT=l}var u={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},d=/$^/;function h(r,e,s){return(typeof e==="string"?e:e.toString()).replace(r.define||d,function(e,n,t,i){if(n.indexOf("def.")===0){n=n.substring(4)}if(!(n in s)){if(t===":"){if(r.defineParams)i.replace(r.defineParams,function(e,t,i){s[n]={arg:t,text:i}});if(!(n in s))s[n]=i}else{new Function("def","def['"+n+"']="+i)(s)}}return""}).replace(r.use||d,function(e,t){if(r.useParams)t=t.replace(r.useParams,function(e,t,i,n){if(s[i]&&s[i].arg&&n){var r=(i+":"+n).replace(/'|\\/g,"_");s.__exp=s.__exp||{};s.__exp[r]=s[i].text.replace(new RegExp("(^|[^\\w$])"+s[i].arg+"([^\\w$])","g"),"$1"+n+"$2");return t+"def.__exp['"+r+"']"}});var i=new Function("def","return "+t)(s);return i?h(r,i,s):i})}function p(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}l.template=function(e,t,i){t=t||l.templateSettings;var n=t.append?u.append:u.split,r,s=0,o,a=t.use||t.define?h(t,e,i||{}):e;a=("var out='"+(t.strip?a.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):a).replace(/'|\\/g,"\\$&").replace(t.interpolate||d,function(e,t){return n.start+p(t)+n.end}).replace(t.encode||d,function(e,t){r=true;return n.startencode+p(t)+n.end}).replace(t.conditional||d,function(e,t,i){return t?i?"';}else if("+p(i)+"){out+='":"';}else{out+='":i?"';if("+p(i)+"){out+='":"';}out+='"}).replace(t.iterate||d,function(e,t,i,n){if(!t)return"';} } out+='";s+=1;o=n||"i"+s;t=p(t);return"';var arr"+s+"="+t+";if(arr"+s+"){var "+i+","+o+"=-1,l"+s+"=arr"+s+".length-1;while("+o+"<l"+s+"){"+i+"=arr"+s+"["+o+"+=1];out+='"}).replace(t.evaluate||d,function(e,t){return"';"+p(t)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,"");if(r){if(!t.selfcontained&&c&&!c._encodeHTML)c._encodeHTML=l.encodeHTMLSource(t.doNotSkipEncoded);a="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+l.encodeHTMLSource.toString()+"("+(t.doNotSkipEncoded||"")+"));"+a}try{return new Function(t.varname,a)}catch(e){if(typeof console!=="undefined")console.log("Could not create a template function: "+a);throw e}};l.compile=function(e,t){return l.template(e,null,t)}})();!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.agGrid=t():e.agGrid=t()}(window,function(){return function(i){var n={};function r(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}return r.m=i,r.c=n,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(L,e,t){"use strict";t.r(e),t.d(e,"ColumnFactory",function(){return Rt}),t.d(e,"ColumnModel",function(){return ni}),t.d(e,"ColumnKeyCreator",function(){return ce}),t.d(e,"ColumnUtils",function(){return si}),t.d(e,"DisplayedGroupCreator",function(){return ai}),t.d(e,"GroupInstanceIdCreator",function(){return Nt}),t.d(e,"GROUP_AUTO_COLUMN_ID",function(){return It}),t.d(e,"ComponentUtil",function(){return C}),t.d(e,"AgStackComponentsRegistry",function(){return vi}),t.d(e,"UserComponentRegistry",function(){return Mo}),t.d(e,"UserComponentFactory",function(){return Xo}),t.d(e,"ColDefUtil",function(){return jt}),t.d(e,"BeanStub",function(){return f}),t.d(e,"Context",function(){return He}),t.d(e,"Autowired",function(){return o}),t.d(e,"PostConstruct",function(){return r}),t.d(e,"PreConstruct",function(){return Be}),t.d(e,"Optional",function(){return c}),t.d(e,"Bean",function(){return s}),t.d(e,"Qualifier",function(){return ze}),t.d(e,"PreDestroy",function(){return Ve}),t.d(e,"QuerySelector",function(){return Fr}),t.d(e,"RefSelector",function(){return S}),t.d(e,"ExcelFactoryMode",function(){return Qo}),t.d(e,"DragAndDropService",function(){return M}),t.d(e,"DragSourceType",function(){return Js}),t.d(e,"HorizontalDirection",function(){return to}),t.d(e,"VerticalDirection",function(){return eo}),t.d(e,"DragService",function(){return Jo}),t.d(e,"Column",function(){return d}),t.d(e,"ColumnGroup",function(){return g}),t.d(e,"ProvidedColumnGroup",function(){return h}),t.d(e,"RowNode",function(){return R}),t.d(e,"RowHighlightPosition",function(){return ea}),t.d(e,"FilterManager",function(){return sa}),t.d(e,"ProvidedFilter",function(){return Kr}),t.d(e,"SimpleFilter",function(){return T}),t.d(e,"ScalarFilter",function(){return x}),t.d(e,"NumberFilter",function(){return _s}),t.d(e,"TextFilter",function(){return Es}),t.d(e,"DateFilter",function(){return hs}),t.d(e,"TextFloatingFilter",function(){return Ms}),t.d(e,"HeaderFilterCellComp",function(){return la}),t.d(e,"FloatingFilterMapper",function(){return qo}),t.d(e,"GridBodyComp",function(){return ol}),t.d(e,"GridBodyCtrl",function(){return wa}),t.d(e,"RowAnimationCssClasses",function(){return ba}),t.d(e,"ScrollVisibleService",function(){return ll}),t.d(e,"MouseEventService",function(){return dl}),t.d(e,"NavigationService",function(){return pl}),t.d(e,"RowContainerComp",function(){return bl}),t.d(e,"RowContainerName",function(){return k}),t.d(e,"RowContainerCtrl",function(){return nl}),t.d(e,"RowContainerType",function(){return Qa}),t.d(e,"getRowContainerTypeForName",function(){return Ja}),t.d(e,"BodyDropPivotTarget",function(){return wl}),t.d(e,"BodyDropTarget",function(){return Sl}),t.d(e,"CssClassApplier",function(){return Tl}),t.d(e,"HeaderRowContainerComp",function(){return pc}),t.d(e,"GridHeaderComp",function(){return Cc}),t.d(e,"GridHeaderCtrl",function(){return yc}),t.d(e,"HeaderRowComp",function(){return Il}),t.d(e,"HeaderRowType",function(){return Nl}),t.d(e,"HeaderRowCtrl",function(){return cc}),t.d(e,"HeaderCellCtrl",function(){return ec}),t.d(e,"SortIndicatorComp",function(){return Os}),t.d(e,"HeaderFilterCellCtrl",function(){return Vl}),t.d(e,"HeaderGroupCellCtrl",function(){return oc}),t.d(e,"AbstractHeaderCellCtrl",function(){return Ll}),t.d(e,"HeaderRowContainerCtrl",function(){return dc}),t.d(e,"HorizontalResizeService",function(){return _c}),t.d(e,"MoveColumnFeature",function(){return Al}),t.d(e,"StandardMenuFactory",function(){return Ec}),t.d(e,"TabbedLayout",function(){return Tc}),t.d(e,"simpleHttpRequest",function(){return xc}),t.d(e,"ResizeObserverService",function(){return Rc}),t.d(e,"AnimationFrameService",function(){return Nc}),t.d(e,"LargeTextCellEditor",function(){return $s}),t.d(e,"PopupEditorWrapper",function(){return gl}),t.d(e,"SelectCellEditor",function(){return Bs}),t.d(e,"TextCellEditor",function(){return js}),t.d(e,"NumberCellEditor",function(){return bo}),t.d(e,"DateCellEditor",function(){return wo}),t.d(e,"DateStringCellEditor",function(){return Eo}),t.d(e,"CheckboxCellEditor",function(){return Do}),t.d(e,"Beans",function(){return P}),t.d(e,"AnimateShowChangeCellRenderer",function(){return Ys}),t.d(e,"AnimateSlideCellRenderer",function(){return Ks}),t.d(e,"GroupCellRenderer",function(){return ho}),t.d(e,"GroupCellRendererCtrl",function(){return co}),t.d(e,"SetLeftFeature",function(){return Gl}),t.d(e,"PositionableFeature",function(){return Yr}),t.d(e,"AutoWidthCalculator",function(){return Ic}),t.d(e,"CheckboxSelectionComponent",function(){return Qs}),t.d(e,"CellComp",function(){return ml}),t.d(e,"CellCtrl",function(){return Ia}),t.d(e,"RowCtrl",function(){return La}),t.d(e,"RowRenderer",function(){return Fc}),t.d(e,"ValueFormatterService",function(){return Hc}),t.d(e,"CssClassManager",function(){return Pr}),t.d(e,"CheckboxCellRenderer",function(){return To}),t.d(e,"PinnedRowModel",function(){return Vc}),t.d(e,"ServerSideTransactionResultStatus",function(){return Wc}),t.d(e,"ChangedPath",function(){return zc}),t.d(e,"RowNodeBlock",function(){return jc}),t.d(e,"RowNodeBlockLoader",function(){return Kc}),t.d(e,"PaginationProxy",function(){return Qc}),t.d(e,"ClientSideRowModelSteps",function(){return ta}),t.d(e,"StylingService",function(){return Jc}),t.d(e,"LayoutCssClasses",function(){return ca}),t.d(e,"AgAbstractField",function(){return Zr}),t.d(e,"AgCheckbox",function(){return as}),t.d(e,"AgRadioButton",function(){return ls}),t.d(e,"AgToggleButton",function(){return eu}),t.d(e,"AgInputTextField",function(){return ys}),t.d(e,"AgInputTextArea",function(){return tu}),t.d(e,"AgInputNumberField",function(){return bs}),t.d(e,"AgInputDateField",function(){return iu}),t.d(e,"AgInputRange",function(){return nu}),t.d(e,"AgSelect",function(){return rs}),t.d(e,"AgSlider",function(){return su}),t.d(e,"AgGroupComponent",function(){return au}),t.d(e,"AgMenuItemComponent",function(){return fu}),t.d(e,"AgMenuList",function(){return uu}),t.d(e,"AgMenuPanel",function(){return hu}),t.d(e,"AgDialog",function(){return yu}),t.d(e,"AgPanel",function(){return mu}),t.d(e,"Component",function(){return E}),t.d(e,"ManagedFocusFeature",function(){return jr}),t.d(e,"TabGuardComp",function(){return lu}),t.d(e,"TabGuardCtrl",function(){return Kl}),t.d(e,"TabGuardClassNames",function(){return Yl}),t.d(e,"PopupComponent",function(){return Fs}),t.d(e,"PopupService",function(){return Au}),t.d(e,"TouchListener",function(){return D}),t.d(e,"VirtualList",function(){return Su}),t.d(e,"AgAbstractLabel",function(){return Qr}),t.d(e,"AgPickerField",function(){return es}),t.d(e,"CellRangeType",function(){return Aa}),t.d(e,"SelectionHandleType",function(){return _a}),t.d(e,"AutoScrollService",function(){return ma}),t.d(e,"VanillaFrameworkOverrides",function(){return Du}),t.d(e,"CellNavigationService",function(){return Mu}),t.d(e,"AlignedGridsService",function(){return Iu}),t.d(e,"KeyCode",function(){return A}),t.d(e,"Grid",function(){return wh}),t.d(e,"GridCoreCreator",function(){return Ah}),t.d(e,"GridApi",function(){return O}),t.d(e,"Events",function(){return y}),t.d(e,"FocusService",function(){return Zl}),t.d(e,"GridOptionsService",function(){return uh}),t.d(e,"EventService",function(){return qe}),t.d(e,"SelectableService",function(){return Sd}),t.d(e,"RowNodeSorter",function(){return Yd}),t.d(e,"CtrlsService",function(){return Xd}),t.d(e,"GridComp",function(){return Ju}),t.d(e,"GridCtrl",function(){return Qu}),t.d(e,"Logger",function(){return Ku}),t.d(e,"LoggerFactory",function(){return qu}),t.d(e,"SortController",function(){return id}),t.d(e,"TemplateService",function(){return ju}),t.d(e,"LocaleService",function(){return hh}),t.d(e,"_",function(){return Tr}),t.d(e,"NumberSequence",function(){return xr}),t.d(e,"AgPromiseStatus",function(){return Dr}),t.d(e,"AgPromise",function(){return Rr}),t.d(e,"Timer",function(){return Mr}),t.d(e,"ValueService",function(){return Hu}),t.d(e,"ValueCache",function(){return ud}),t.d(e,"ExpressionService",function(){return Wu}),t.d(e,"ValueParserService",function(){return Ch}),t.d(e,"CellPositionUtils",function(){return Pd}),t.d(e,"RowPositionUtils",function(){return Od}),t.d(e,"HeaderPositionUtils",function(){return Bd}),t.d(e,"HeaderNavigationService",function(){return mc}),t.d(e,"HeaderNavigationDirection",function(){return fc}),t.d(e,"PropertyKeys",function(){return b}),t.d(e,"ColumnApi",function(){return Gu}),t.d(e,"BaseComponentWrapper",function(){return Eh}),t.d(e,"Environment",function(){return Cd}),t.d(e,"CustomTooltipFeature",function(){return Ir}),t.d(e,"DEFAULT_CHART_GROUPS",function(){return Sh}),t.d(e,"CHART_TOOL_PANEL_ALLOW_LIST",function(){return Th}),t.d(e,"CHART_TOOLBAR_ALLOW_LIST",function(){return xh}),t.d(e,"CHART_TOOL_PANEL_MENU_OPTIONS",function(){return Dh}),t.d(e,"__FORCE_MODULE_DETECTION",function(){return Rh}),t.d(e,"BarColumnLabelPlacement",function(){return Mh}),t.d(e,"ModuleNames",function(){return m}),t.d(e,"ModuleRegistry",function(){return v});var F={};t.r(F),t.d(F,"makeNull",function(){return J}),t.d(F,"exists",function(){return _}),t.d(F,"missing",function(){return u}),t.d(F,"missingOrEmpty",function(){return ee}),t.d(F,"toStringOrNull",function(){return te}),t.d(F,"attrToNumber",function(){return ie}),t.d(F,"attrToBoolean",function(){return ne}),t.d(F,"attrToString",function(){return re}),t.d(F,"referenceCompare",function(){return se}),t.d(F,"jsonEquals",function(){return oe}),t.d(F,"defaultComparator",function(){return ae}),t.d(F,"values",function(){return le});var G={};t.r(G),t.d(G,"iterateObject",function(){return a}),t.d(G,"cloneObject",function(){return ue}),t.d(G,"deepCloneObject",function(){return de}),t.d(G,"deepCloneDefinition",function(){return he}),t.d(G,"getProperty",function(){return pe}),t.d(G,"setProperty",function(){return fe}),t.d(G,"copyPropertiesIfPresent",function(){return ge}),t.d(G,"copyPropertyIfPresent",function(){return me}),t.d(G,"getAllKeysInObjects",function(){return ve}),t.d(G,"getAllValuesInObject",function(){return ye}),t.d(G,"mergeDeep",function(){return be}),t.d(G,"missingOrEmptyObject",function(){return Ce}),t.d(G,"get",function(){return we}),t.d(G,"set",function(){return _e}),t.d(G,"getValueUsingField",function(){return Ae}),t.d(G,"removeAllReferences",function(){return Ee}),t.d(G,"isNonNullObject",function(){return Se});var $={};t.r($),t.d($,"doOnce",function(){return l}),t.d($,"getFunctionName",function(){return xe}),t.d($,"isFunction",function(){return De}),t.d($,"executeInAWhile",function(){return Re}),t.d($,"executeNextVMTurn",function(){return Oe}),t.d($,"executeAfter",function(){return Ie}),t.d($,"debounce",function(){return Pe}),t.d($,"throttle",function(){return ke}),t.d($,"waitUntil",function(){return Le}),t.d($,"compose",function(){return Fe}),t.d($,"callIfPresent",function(){return Ge}),t.d($,"noop",function(){return $e});var H={};t.r(H),t.d(H,"firstExistingValue",function(){return et}),t.d(H,"existsAndNotEmpty",function(){return tt}),t.d(H,"last",function(){return p}),t.d(H,"areEqual",function(){return it}),t.d(H,"shallowCompare",function(){return nt}),t.d(H,"sortNumerically",function(){return rt}),t.d(H,"removeRepeatsFromArray",function(){return st}),t.d(H,"removeFromArray",function(){return ot}),t.d(H,"removeAllFromArray",function(){return at}),t.d(H,"insertIntoArray",function(){return lt}),t.d(H,"insertArrayIntoArray",function(){return ct}),t.d(H,"moveInArray",function(){return ut}),t.d(H,"includes",function(){return dt}),t.d(H,"flatten",function(){return ht}),t.d(H,"pushAll",function(){return pt}),t.d(H,"toStrings",function(){return ft}),t.d(H,"forEachReverse",function(){return gt});var B={};t.r(B),t.d(B,"stopPropagationForAgGrid",function(){return yt}),t.d(B,"isStopPropagationForAgGrid",function(){return bt}),t.d(B,"isEventSupported",function(){return Ct}),t.d(B,"getCtrlForEventTarget",function(){return wt}),t.d(B,"isElementInEventPath",function(){return _t}),t.d(B,"createEventPath",function(){return At}),t.d(B,"getEventPath",function(){return Et}),t.d(B,"addSafePassiveEventListener",function(){return St});var V={};t.r(V),t.d(V,"utf8_encode",function(){return Ft}),t.d(V,"capitalise",function(){return Gt}),t.d(V,"escapeString",function(){return $t}),t.d(V,"camelCaseToHumanText",function(){return Ht}),t.d(V,"camelCaseToHyphenated",function(){return Bt});var W={};t.r(W),t.d(W,"convertToMap",function(){return Vt}),t.d(W,"mapById",function(){return Wt}),t.d(W,"keys",function(){return zt});var z={};t.r(z),t.d(z,"fuzzyCheckStrings",function(){return Ut}),t.d(z,"fuzzySuggestions",function(){return Yt});var i={};t.r(i),t.d(i,"setAriaRole",function(){return _i}),t.d(i,"getAriaSortState",function(){return Ai}),t.d(i,"getAriaLevel",function(){return Ei}),t.d(i,"getAriaPosInSet",function(){return Si}),t.d(i,"getAriaDescribedBy",function(){return Ti}),t.d(i,"setAriaLabel",function(){return xi}),t.d(i,"setAriaLabelledBy",function(){return Di}),t.d(i,"setAriaDescription",function(){return Ri}),t.d(i,"setAriaDescribedBy",function(){return Mi}),t.d(i,"setAriaLive",function(){return Ni}),t.d(i,"setAriaLevel",function(){return Oi}),t.d(i,"setAriaDisabled",function(){return Ii}),t.d(i,"setAriaHidden",function(){return Pi}),t.d(i,"setAriaExpanded",function(){return ki}),t.d(i,"removeAriaExpanded",function(){return Li}),t.d(i,"setAriaSetSize",function(){return Fi}),t.d(i,"setAriaPosInSet",function(){return Gi}),t.d(i,"setAriaMultiSelectable",function(){return $i}),t.d(i,"setAriaRowCount",function(){return Hi}),t.d(i,"setAriaRowIndex",function(){return Bi}),t.d(i,"setAriaColCount",function(){return Vi}),t.d(i,"setAriaColIndex",function(){return Wi}),t.d(i,"setAriaColSpan",function(){return zi}),t.d(i,"setAriaSort",function(){return ji}),t.d(i,"removeAriaSort",function(){return Ui}),t.d(i,"setAriaSelected",function(){return Yi}),t.d(i,"setAriaChecked",function(){return qi}),t.d(i,"setAriaControls",function(){return Ki}),t.d(i,"getAriaCheckboxStateName",function(){return Xi});var j={};t.r(j),t.d(j,"isBrowserSafari",function(){return Qi}),t.d(j,"getSafariVersion",function(){return Zi}),t.d(j,"isBrowserChrome",function(){return Ji}),t.d(j,"isBrowserFirefox",function(){return en}),t.d(j,"isMacOsUserAgent",function(){return tn}),t.d(j,"isIOSUserAgent",function(){return nn}),t.d(j,"browserSupportsPreventScroll",function(){return rn}),t.d(j,"getTabIndex",function(){return sn}),t.d(j,"getMaxDivHeight",function(){return on}),t.d(j,"getBodyWidth",function(){return an}),t.d(j,"getBodyHeight",function(){return ln}),t.d(j,"getScrollbarWidth",function(){return cn}),t.d(j,"isInvisibleScrollbar",function(){return dn});var U={};t.r(U),t.d(U,"padStartWidthZeros",function(){return hn}),t.d(U,"createArrayOfNumbers",function(){return pn}),t.d(U,"cleanNumber",function(){return fn}),t.d(U,"decToHex",function(){return gn}),t.d(U,"formatNumberTwoDecimalPlacesAndCommas",function(){return mn}),t.d(U,"formatNumberCommas",function(){return vn}),t.d(U,"sum",function(){return yn}),t.d(U,"zeroOrGreater",function(){return bn}),t.d(U,"oneOrGreater",function(){return Cn});var Y={};t.r(Y),t.d(Y,"serialiseDate",function(){return wn}),t.d(Y,"dateToFormattedString",function(){return An}),t.d(Y,"parseDateTimeFromString",function(){return En});var n={};t.r(n),t.d(n,"radioCssClass",function(){return Tn}),t.d(n,"FOCUSABLE_SELECTOR",function(){return xn}),t.d(n,"FOCUSABLE_EXCLUDE",function(){return Dn}),t.d(n,"isFocusableFormField",function(){return Rn}),t.d(n,"setDisplayed",function(){return w}),t.d(n,"setVisible",function(){return Mn}),t.d(n,"setDisabled",function(){return Nn}),t.d(n,"isElementChildOfClass",function(){return On}),t.d(n,"getElementSize",function(){return In}),t.d(n,"getInnerHeight",function(){return Pn}),t.d(n,"getInnerWidth",function(){return kn}),t.d(n,"getAbsoluteHeight",function(){return Ln}),t.d(n,"getAbsoluteWidth",function(){return Fn}),t.d(n,"getElementRectWithOffset",function(){return Gn}),t.d(n,"isRtlNegativeScroll",function(){return $n}),t.d(n,"getScrollLeft",function(){return Hn}),t.d(n,"setScrollLeft",function(){return Bn}),t.d(n,"clearElement",function(){return Vn}),t.d(n,"removeElement",function(){return Wn}),t.d(n,"removeFromParent",function(){return zn}),t.d(n,"isVisible",function(){return jn}),t.d(n,"loadTemplate",function(){return Un}),t.d(n,"appendHtml",function(){return Yn}),t.d(n,"getElementAttribute",function(){return qn}),t.d(n,"offsetHeight",function(){return Kn}),t.d(n,"offsetWidth",function(){return Xn}),t.d(n,"ensureDomOrder",function(){return Qn}),t.d(n,"setDomChildOrder",function(){return Zn}),t.d(n,"insertWithDomOrder",function(){return Jn}),t.d(n,"prependDC",function(){return er}),t.d(n,"addStylesToElement",function(){return tr}),t.d(n,"isHorizontalScrollShowing",function(){return ir}),t.d(n,"isVerticalScrollShowing",function(){return nr}),t.d(n,"setElementWidth",function(){return rr}),t.d(n,"setFixedWidth",function(){return sr}),t.d(n,"setElementHeight",function(){return or}),t.d(n,"setFixedHeight",function(){return ar}),t.d(n,"formatSize",function(){return lr}),t.d(n,"isNodeOrElement",function(){return cr}),t.d(n,"copyNodeList",function(){return ur}),t.d(n,"iterateNamedNodeMap",function(){return dr}),t.d(n,"addOrRemoveAttribute",function(){return hr}),t.d(n,"nodeListForEach",function(){return pr});var q={};t.r(q),t.d(q,"iconNameClassMap",function(){return fr}),t.d(q,"createIcon",function(){return gr}),t.d(q,"createIconNoSpan",function(){return mr});var K={};t.r(K),t.d(K,"isEventFromPrintableCharacter",function(){return vr}),t.d(K,"isUserSuppressingKeyboardEvent",function(){return yr}),t.d(K,"isUserSuppressingHeaderKeyboardEvent",function(){return br}),t.d(K,"normaliseQwertyAzerty",function(){return Cr}),t.d(K,"isDeleteKey",function(){return wr});var X={};t.r(X),t.d(X,"areEventsNear",function(){return _r});var Q={};t.r(Q),t.d(Q,"sortRowNodesByOrder",function(){return Ar}),t.d(Q,"traverseNodesWithKey",function(){return Er});var Z={};function J(e){return null==e||""===e?null:e}function _(e,t=!1){return null!=e&&(""!==e||t)}function u(e){return!_(e)}function ee(e){return null==e||0===e.length}function te(e){return null!=e&&"function"==typeof e.toString?e.toString():null}function ie(e){if(void 0===e)return;if(null===e||""===e)return null;if("number"==typeof e)return isNaN(e)?void 0:e;const t=parseInt(e,10);return isNaN(t)?void 0:t}function ne(e){if(void 0!==e)return null!==e&&""!==e&&("boolean"==typeof e?e:/true/i.test(e))}function re(e){if(null!=e&&""!==e)return e}function se(e,t){return null==e&&null==t||(null!=e||null==t)&&((null==e||null!=t)&&e===t)}function oe(e,t){return(e?JSON.stringify(e):null)===(t?JSON.stringify(t):null)}function ae(e,t,i=!1){const n=null==e,r=null==t;if(e&&e.toNumber&&(e=e.toNumber()),t&&t.toNumber&&(t=t.toNumber()),n&&r)return 0;if(n)return-1;if(r)return 1;function s(e,t){return e>t?1:e<t?-1:0}if("string"!=typeof e)return s(e,t);if(!i)return s(e,t);try{return e.localeCompare(t)}catch(i){return s(e,t)}}function le(e){if(e instanceof Set||e instanceof Map){const t=[];return e.forEach(e=>t.push(e)),t}return Object.values(e)}t.r(Z),t.d(Z,"convertToSet",function(){return Sr});class ce{constructor(){this.existingKeys={}}addExistingKeys(t){for(let e=0;e<t.length;e++)this.existingKeys[t[e]]=!0}getUniqueKey(t,i){t=te(t);let n=0;for(;;){let e;if(t?(e=t,0!==n&&(e+="_"+n)):i?(e=i,0!==n&&(e+="_"+n)):e=""+n,!this.existingKeys[e])return this.existingKeys[e]=!0,e;n++}}}function a(t,i){null!=t&&(Array.isArray(t)?t.forEach((e,t)=>i(""+t,e)):Object.keys(t).forEach(e=>i(e,t[e])))}function ue(n){const r={},s=Object.keys(n);for(let i=0;i<s.length;i++){const e=s[i],t=n[e];r[e]=t}return r}function de(e){return JSON.parse(JSON.stringify(e))}function he(e,n){if(!e)return;const r=e,s={};return Object.keys(r).forEach(e=>{if(n&&n.indexOf(e)>=0)return;const t=r[e],i=Se(t)&&t.constructor===Object;s[e]=i?he(t):t}),s}function pe(e,t){return e[t]}function fe(e,t,i){e[t]=i}function ge(t,i,...e){e.forEach(e=>me(t,i,e))}function me(e,t,i,n){const r=pe(e,i);void 0!==r&&fe(t,i,n?n(r):r)}function ve(e){const t={};return e.filter(e=>null!=e).forEach(e=>{Object.keys(e).forEach(e=>t[e]=null)}),Object.keys(t)}function ye(e){if(!e)return[];const t=Object;if("function"==typeof t.values)return t.values(e);const i=[];for(const t in e)e.hasOwnProperty(t)&&e.propertyIsEnumerable(t)&&i.push(e[t]);return i}function be(n,e,r=!0,s=!1){_(e)&&a(e,(e,t)=>{let i=n[e];if(i!==t){if(s){if(null==i&&null!=t){"object"==typeof t&&t.constructor===Object&&(i={},n[e]=i)}}Se(t)&&Se(i)&&!Array.isArray(i)?be(i,t,r,s):(r||void 0!==t)&&(n[e]=t)}})}function Ce(e){return u(e)||0===Object.keys(e).length}function we(e,t,i){if(null==e)return i;const n=t.split(".");let r=e;for(;n.length>1;)if(r=r[n.shift()],null==r)return i;const s=r[n[0]];return null!=s?s:i}function _e(e,t,i){if(null==e)return;const n=t.split(".");let r=e;n.forEach((e,t)=>{r[e]||(r[e]={}),t<n.length-1&&(r=r[e])}),r[n[n.length-1]]=i}function Ae(e,t,i){if(!t||!e)return;if(!i)return e[t];const n=t.split(".");let r=e;for(let e=0;e<n.length;e++){if(null==r)return;r=r[n[e]]}return r}function Ee(t,i){Object.keys(t).forEach(e=>{"object"==typeof t[e]&&(t[e]=void 0)});const n=Object.getPrototypeOf(t),r={};Object.keys(n).forEach(e=>{if("function"==typeof n[e]){const n=()=>{console.warn(`AG Grid: ${i} function ${e}() cannot be called as the grid has been destroyed.\n                     Please don't call grid API functions on destroyed grids - as a matter of fact you shouldn't\n                     be keeping the API reference, your application has a memory leak! Remove the API reference\n                     when the grid is destroyed.`)};r[e]={value:n,writable:!0}}}),Object.defineProperties(t,r)}function Se(e){return"object"==typeof e&&null!==e}const Te={};function l(e,t){Te[t]||(e(),Te[t]=!0)}function xe(e){if(e.name)return e.name;const t=/function\s+([^\(]+)/.exec(e.toString());return t&&2===t.length?t[1].trim():null}function De(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Re(e){Ie(e,400)}const Me=[];let Ne=!1;function Oe(e){Me.push(e),Ne||(Ne=!0,window.setTimeout(()=>{const e=Me.slice();Me.length=0,Ne=!1,e.forEach(e=>e())},0))}function Ie(e,t=0){e.length>0&&window.setTimeout(()=>e.forEach(e=>e()),t)}function Pe(i,n){let r;return function(...e){const t=this;window.clearTimeout(r),r=window.setTimeout(function(){i.apply(t,e)},n)}}function ke(i,n){let r=0;return function(...e){const t=(new Date).getTime();t-r<n||(r=t,i.apply(this,e))}}function Le(t,i,n=100,r){const s=(new Date).getTime();let o=null,a=!1;const e=()=>{const e=(new Date).getTime()-s>n;(t()||e)&&(i(),a=!0,null!=o&&(window.clearInterval(o),o=null),e&&r&&console.warn(r))};e(),a||(o=window.setInterval(e,10))}function Fe(...t){return e=>t.reduce((e,t)=>t(e),e)}function Ge(e){e&&e()}const $e=()=>{};var m;!function(e){e.CommunityCoreModule="@ag-grid-community/core",e.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",e.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",e.CsvExportModule="@ag-grid-community/csv-export",e.EnterpriseCoreModule="@ag-grid-enterprise/core",e.RowGroupingModule="@ag-grid-enterprise/row-grouping",e.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",e.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",e.MenuModule="@ag-grid-enterprise/menu",e.SetFilterModule="@ag-grid-enterprise/set-filter",e.MultiFilterModule="@ag-grid-enterprise/multi-filter",e.StatusBarModule="@ag-grid-enterprise/status-bar",e.SideBarModule="@ag-grid-enterprise/side-bar",e.RangeSelectionModule="@ag-grid-enterprise/range-selection",e.MasterDetailModule="@ag-grid-enterprise/master-detail",e.RichSelectModule="@ag-grid-enterprise/rich-select",e.GridChartsModule="@ag-grid-enterprise/charts",e.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",e.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",e.ExcelExportModule="@ag-grid-enterprise/excel-export",e.ClipboardModule="@ag-grid-enterprise/clipboard",e.SparklinesModule="@ag-grid-enterprise/sparklines",e.AngularModule="@ag-grid-community/angular",e.ReactModule="@ag-grid-community/react",e.VueModule="@ag-grid-community/vue"}(m||(m={}));class v{static register(e){v.__register(e,!0,void 0)}static registerModules(e){v.__registerModules(e,!0,void 0)}static __register(e,t,i){v.runVersionChecks(e),void 0!==i?(v.areGridScopedModules=!0,void 0===v.gridModulesMap[i]&&(v.gridModulesMap[i]={}),v.gridModulesMap[i][e.moduleName]=e):v.globalModulesMap[e.moduleName]=e,v.setModuleBased(t)}static __unRegisterGridModules(e){delete v.gridModulesMap[e]}static __registerModules(e,t,i){v.setModuleBased(t),e&&e.forEach(e=>v.__register(e,t,i))}static isValidModuleVersion(e){const[t,i]=e.version.split(".")||[],[n,r]=v.currentModuleVersion.split(".")||[];return t===n&&i===r}static runVersionChecks(t){if(v.currentModuleVersion||(v.currentModuleVersion=t.version),t.version?v.isValidModuleVersion(t)||console.error(`AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '${t.moduleName}' is version ${t.version} but the other modules are version ${this.currentModuleVersion}. Please update all modules to the same version.`):console.error(`AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '${t.moduleName}' is incompatible. Please update all modules to the same version.`),t.validate){const e=t.validate();if(!e.isValid){const t=e;console.error("AG Grid: "+t.message)}}}static setModuleBased(e){void 0===v.moduleBased?v.moduleBased=e:v.moduleBased!==e&&l(()=>{console.warn("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),console.warn("Please see https://www.ag-grid.com/javascript-grid/packages-modules/ for more information.")},"ModulePackageCheck")}static __setIsBundled(){v.isBundled=!0}static __assertRegistered(i,t,n){var r;if(this.__isRegistered(i,n))return!0;const e=t+i;let s;if(v.isBundled)s=`AG Grid: unable to use ${t} as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:\n        \n        <script src="https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js"><\/script>\n        \nFor more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise`;else if(v.moduleBased||void 0===v.moduleBased){let e=null===(r=Object.entries(m).find(([e,t])=>t===i))||void 0===r?void 0:r[0];s=`AG Grid: unable to use ${t} as the ${e} is not registered${v.areGridScopedModules?" for gridId: "+n:""}. Check if you have registered the module:\n           \n    import { ModuleRegistry } from '@ag-grid-community/core';\n    import { ${e} } from '${i}';\n    \n    ModuleRegistry.registerModules([ ${e} ]);\n\nFor more info see: https://www.ag-grid.com/javascript-grid/modules/`}else s=`AG Grid: unable to use ${t} as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:\n            \n    import 'ag-grid-enterprise';\n            \nFor more info see: https://www.ag-grid.com/javascript-grid/packages/`;return l(()=>{console.warn(s)},e),!1}static __isRegistered(e,t){var i;return!!v.globalModulesMap[e]||!!(null===(i=v.gridModulesMap[t])||void 0===i?void 0:i[e])}static __getRegisteredModules(e){return[...le(v.globalModulesMap),...le(v.gridModulesMap[e]||{})]}static __getGridRegisteredModules(e){var t;return le(null!==(t=v.gridModulesMap[e])&&void 0!==t?t:{})||[]}static __isPackageBased(){return!v.moduleBased}}v.globalModulesMap={},v.gridModulesMap={},v.areGridScopedModules=!1;class He{constructor(e,t){if(this.beanWrappers={},this.destroyed=!1,!e||!e.beanClasses)return;this.contextParams=e,this.logger=t,this.logger.log(">> creating ag-Application Context"),this.createBeans();const i=this.getBeanInstances();this.wireBeans(i),this.logger.log(">> ag-Application Context ready - component is alive")}getBeanInstances(){return le(this.beanWrappers).map(e=>e.beanInstance)}createBean(e,t){if(!e)throw Error("Can't wire to bean since it is null");return this.wireBeans([e],t),e}wireBeans(e,t){this.autoWireBeans(e),this.methodWireBeans(e),this.callLifeCycleMethods(e,"preConstructMethods"),_(t)&&e.forEach(t),this.callLifeCycleMethods(e,"postConstructMethods")}createBeans(){this.contextParams.beanClasses.forEach(this.createBeanWrapper.bind(this)),a(this.beanWrappers,(e,t)=>{let i;t.bean.__agBeanMetaData&&t.bean.__agBeanMetaData.autowireMethods&&t.bean.__agBeanMetaData.autowireMethods.agConstructor&&(i=t.bean.__agBeanMetaData.autowireMethods.agConstructor);const n=this.getBeansForParameters(i,t.bean.name),r=new(t.bean.bind.apply(t.bean,[null,...n]));t.beanInstance=r});const e=Object.keys(this.beanWrappers).join(", ");this.logger.log("created beans: "+e)}createBeanWrapper(t){const e=t.__agBeanMetaData;if(!e){let e;return e=t.prototype.constructor?xe(t.prototype.constructor):""+t,void console.error(`Context item ${e} is not a bean`)}const i={bean:t,beanInstance:null,beanName:e.beanName};this.beanWrappers[e.beanName]=i}autoWireBeans(e){e.forEach(n=>{this.forEachMetaDataInHierarchy(n,(e,i)=>{const t=e.agClassAttributes;t&&t.forEach(e=>{const t=this.lookupBeanInstance(i,e.beanName,e.optional);n[e.attributeName]=t})})})}methodWireBeans(e){e.forEach(r=>{this.forEachMetaDataInHierarchy(r,(e,n)=>{a(e.autowireMethods,(e,t)=>{if("agConstructor"===e)return;const i=this.getBeansForParameters(t,n);r[e].apply(r,i)})})})}forEachMetaDataInHierarchy(e,t){let i=Object.getPrototypeOf(e);for(;null!=i;){const e=i.constructor;if(e.hasOwnProperty("__agBeanMetaData")){t(e.__agBeanMetaData,this.getBeanName(e))}i=Object.getPrototypeOf(i)}}getBeanName(e){if(e.__agBeanMetaData&&e.__agBeanMetaData.beanName)return e.__agBeanMetaData.beanName;const t=e.toString();return t.substring(9,t.indexOf("("))}getBeansForParameters(e,n){const r=[];return e&&a(e,(e,t)=>{const i=this.lookupBeanInstance(n,t);r[Number(e)]=i}),r}lookupBeanInstance(e,t,i=!1){if(this.destroyed)return this.logger.log(`AG Grid: bean reference ${t} is used after the grid is destroyed!`),null;if("context"===t)return this;if(this.contextParams.providedBeanInstances&&this.contextParams.providedBeanInstances.hasOwnProperty(t))return this.contextParams.providedBeanInstances[t];const n=this.beanWrappers[t];return n?n.beanInstance:(i||console.error(`AG Grid: unable to find bean reference ${t} while initialising ${e}`),null)}callLifeCycleMethods(e,t){e.forEach(e=>this.callLifeCycleMethodsOnBean(e,t))}callLifeCycleMethodsOnBean(t,i,n){const r={};this.forEachMetaDataInHierarchy(t,e=>{const t=e[i];t&&t.forEach(e=>{e!=n&&(r[e]=!0)})});Object.keys(r).forEach(e=>t[e]())}getBean(e){return this.lookupBeanInstance("getBean",e,!0)}destroy(){if(this.destroyed)return;this.logger.log(">> Shutting down ag-Application Context");const e=this.getBeanInstances();this.destroyBeans(e),this.contextParams.providedBeanInstances=null,v.__unRegisterGridModules(this.contextParams.gridId),this.destroyed=!0,this.logger.log(">> ag-Application Context shut down - component is dead")}destroyBean(e){e&&this.destroyBeans([e])}destroyBeans(e){return e?(e.forEach(e=>{this.callLifeCycleMethodsOnBean(e,"preDestroyMethods","destroy");const t=e;"function"==typeof t.destroy&&t.destroy()}),[]):[]}isDestroyed(){return this.destroyed}getGridId(){return this.contextParams.gridId}}function Be(e,t,i){const n=je(e.constructor);n.preConstructMethods||(n.preConstructMethods=[]),n.preConstructMethods.push(t)}function r(e,t,i){const n=je(e.constructor);n.postConstructMethods||(n.postConstructMethods=[]),n.postConstructMethods.push(t)}function Ve(e,t,i){const n=je(e.constructor);n.preDestroyMethods||(n.preDestroyMethods=[]),n.preDestroyMethods.push(t)}function s(t){return e=>{je(e).beanName=t}}function o(n){return(e,t,i)=>{We(e,n,!1,e,t,null)}}function c(n){return(e,t,i)=>{We(e,n,!0,e,t,null)}}function We(e,t,i,n,r,s){if(null===t)return void console.error("AG Grid: Autowired name should not be null");if("number"==typeof s)return void console.error("AG Grid: Autowired should be on an attribute");const o=je(e.constructor);o.agClassAttributes||(o.agClassAttributes=[]),o.agClassAttributes.push({attributeName:r,beanName:t,optional:i})}function ze(s){return(e,t,i)=>{const n="function"==typeof e?e:e.constructor;let r;if("number"==typeof i){let e;t?(r=je(n),e=t):(r=je(n),e="agConstructor"),r.autowireMethods||(r.autowireMethods={}),r.autowireMethods[e]||(r.autowireMethods[e]={}),r.autowireMethods[e][i]=s}}}function je(e){return e.hasOwnProperty("__agBeanMetaData")||(e.__agBeanMetaData={}),e.__agBeanMetaData}var Ue=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},Ye=function(i,n){return function(e,t){n(e,t,i)}};let qe=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setBeans(e,t,i,n=null){if(this.frameworkOverrides=i,this.gridOptionsService=t,n){const e=t.useAsyncEvents();this.addGlobalListener(n,e)}}getListeners(e,t,i){const n=t?this.allAsyncListeners:this.allSyncListeners;let r=n.get(e);return!r&&i&&(r=new Set,n.set(e,r)),r}noRegisteredListenersExist(){return 0===this.allSyncListeners.size&&0===this.allAsyncListeners.size&&0===this.globalSyncListeners.size&&0===this.globalAsyncListeners.size}addEventListener(e,t,i=!1){this.getListeners(e,i,!0).add(t)}removeEventListener(e,t,i=!1){const n=this.getListeners(e,i,!1);if(n&&(n.delete(t),0===n.size)){(i?this.allAsyncListeners:this.allSyncListeners).delete(e)}}addGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).add(e)}removeGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).delete(e)}dispatchEvent(i){let n=i;if(this.gridOptionsService){const{api:i,columnApi:e,context:t}=this.gridOptionsService;n.api=i,n.columnApi=e,n.context=t}this.dispatchToListeners(n,!0),this.dispatchToListeners(n,!1),this.firedEvents[n.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(t,i){const n=t.type;if(i&&"event"in t){const i=t.event;i instanceof Event&&(t.eventPath=i.composedPath())}const e=e=>e.forEach(e=>{i?this.dispatchAsync(()=>e(t)):e(t)}),r=new Set(this.getListeners(n,i,!1));r&&e(r);new Set(i?this.globalAsyncListeners:this.globalSyncListeners).forEach(e=>{i?this.dispatchAsync(()=>this.frameworkOverrides.dispatchEvent(n,()=>e(n,t),!0)):this.frameworkOverrides.dispatchEvent(n,()=>e(n,t),!0)})}dispatchAsync(e){this.asyncFunctionsQueue.push(e),this.scheduled||(window.setTimeout(this.flushAsyncQueue.bind(this),0),this.scheduled=!0)}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach(e=>e())}};Ue([Ye(0,ze("loggerFactory")),Ye(1,ze("gridOptionsService")),Ye(2,ze("frameworkOverrides")),Ye(3,ze("globalEventListener"))],qe.prototype,"setBeans",null),qe=Ue([s("eventService")],qe);var Ke=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Xe=0;function Qe(){return Xe++}class d{constructor(e,t,i,n){this.instanceId=Qe(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.filterActive=!1,this.eventService=new qe,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=e,this.userProvidedColDef=t,this.colId=i,this.primary=n,this.setState(e)}getInstanceId(){return this.instanceId}setState(e){void 0!==e.sort?"asc"!==e.sort&&"desc"!==e.sort||(this.sort=e.sort):"asc"!==e.initialSort&&"desc"!==e.initialSort||(this.sort=e.initialSort);const t=ie(e.sortIndex),i=ie(e.initialSortIndex);void 0!==t?null!==t&&(this.sortIndex=t):null!==i&&(this.sortIndex=i);const n=ne(e.hide),r=ne(e.initialHide);this.visible=void 0!==n?!n:!r,void 0!==e.pinned?this.setPinned(e.pinned):this.setPinned(e.initialPinned);const s=ie(e.flex),o=ie(e.initialFlex);void 0!==s?this.flex=s:void 0!==o&&(this.flex=o)}setColDef(e,t){this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.eventService.dispatchEvent(this.createColumnEvent("colDefChanged","api"))}getUserProvidedColDef(){return this.userProvidedColDef}setParent(e){this.parent=e}getParent(){return this.parent}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}initialise(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.validate()}initDotNotation(){const e=this.gridOptionsService.is("suppressFieldDotNotation");this.fieldContainsDots=_(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!e,this.tooltipFieldContainsDots=_(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!e}initMinAndMaxWidths(){const e=this.colDef;this.minWidth=this.columnUtils.calculateColMinWidth(e),this.maxWidth=this.columnUtils.calculateColMaxWidth(e)}initTooltip(){this.tooltipEnabled=_(this.colDef.tooltipField)||_(this.colDef.tooltipValueGetter)||_(this.colDef.tooltipComponent)}resetActualWidth(e="api"){const t=this.columnUtils.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){if(u(this.colDef)||u(this.colDef.showRowGroup))return!1;const t=!0===this.colDef.showRowGroup,i=this.colDef.showRowGroup===e;return t||i}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}validate(){const n=this.colDef;function r(e,t,i){l(()=>{i?console.warn(e,i):l(()=>console.warn(e),t)},t)}if(this.gridOptionsService.isRowModelType("clientSide")&&!v.__isRegistered(m.RowGroupingModule,this.gridOptionsService.getGridId())){const r=["enableRowGroup","rowGroup","rowGroupIndex","enablePivot","enableValue","pivot","pivotIndex","aggFunc"].filter(e=>_(n[e]));r.length>0&&v.__assertRegistered(m.RowGroupingModule,r.map(e=>"colDef."+e).join(", "),this.gridOptionsService.getGridId())}if("agRichSelect"!==this.colDef.cellEditor&&"agRichSelectCellEditor"!==this.colDef.cellEditor||v.__assertRegistered(m.RichSelectModule,this.colDef.cellEditor,this.gridOptionsService.getGridId()),this.gridOptionsService.isTreeData()){const e=["rowGroup","rowGroupIndex","pivot","pivotIndex"].filter(e=>_(n[e]));e.length>0&&r(`AG Grid: ${e.join()} is not possible when doing tree data, your column definition should not have ${e.join()}`,"TreeDataCannotRowGroup")}if(_(n.menuTabs))if(Array.isArray(n.menuTabs)){const t=["filterMenuTab"],i=["columnsMenuTab","generalMenuTab"],e=i.filter(e=>n.menuTabs.includes(e));e.length>0&&v.__assertRegistered(m.MenuModule,"menuTab(s): "+e.map(e=>`'${e}'`).join(),this.gridOptionsService.getGridId()),n.menuTabs.forEach(e=>{i.includes(e)||t.includes(e)||r(`AG Grid: '${e}' is not valid for 'colDef.menuTabs'. Valid values are: ${[...t,...i].map(e=>`'${e}'`).join()}.`,"wrongValue_menuTabs_"+e)})}else r("AG Grid: The typeof 'colDef.menuTabs' should be an array not:"+typeof n.menuTabs,"wrongType_menuTabs");_(n.columnsMenuParams)&&v.__assertRegistered(m.MenuModule,"columnsMenuParams",this.gridOptionsService.getGridId()),_(n.columnsMenuParams)&&v.__assertRegistered(m.ColumnsToolPanelModule,"columnsMenuParams",this.gridOptionsService.getGridId()),_(this.colDef.width)&&"number"!=typeof this.colDef.width&&r("AG Grid: colDef.width should be a number, not "+typeof this.colDef.width,"ColumnCheck"),_(n.columnGroupShow)&&"closed"!==n.columnGroupShow&&"open"!==n.columnGroupShow&&r(`AG Grid: '${n.columnGroupShow}' is not valid for columnGroupShow. Valid values are 'open', 'closed', undefined, null`,"columnGroupShow_invalid")}addEventListener(e,t){this.eventService.addEventListener(e,t)}removeEventListener(e,t){this.eventService.removeEventListener(e,t)}createColumnFunctionCallbackParams(e){return{node:e,data:e.data,column:this,colDef:this.colDef,context:this.gridOptionsService.context,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi}}isSuppressNavigable(t){if("boolean"==typeof this.colDef.suppressNavigable)return this.colDef.suppressNavigable;if("function"==typeof this.colDef.suppressNavigable){const e=this.createColumnFunctionCallbackParams(t);return(0,this.colDef.suppressNavigable)(e)}return!1}isCellEditable(e){return!(e.group&&!this.gridOptionsService.is("enableGroupEdit"))&&this.isColumnFunc(e,this.colDef.editable)}isSuppressFillHandle(){return!!ne(this.colDef.suppressFillHandle)}isAutoHeight(){return!!ne(this.colDef.autoHeight)}isAutoHeaderHeight(){return!!ne(this.colDef.autoHeaderHeight)}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){return this.isColumnFunc(e,this.colDef.checkboxSelection)}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?this.colDef.suppressPaste:null)}isResizable(){return!!ne(this.colDef.resizable)}isColumnFunc(e,t){if("boolean"==typeof t)return t;if("function"==typeof t){return t(this.createColumnFunctionCallbackParams(e))}return!1}setMoving(e,t="api"){this.moving=e,this.eventService.dispatchEvent(this.createColumnEvent("movingChanged",t))}createColumnEvent(e,t){return{type:e,column:this,columns:[this],source:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}}isMoving(){return this.moving}getSort(){return this.sort}setSort(e,t="api"){this.sort!==e&&(this.sort=e,this.eventService.dispatchEvent(this.createColumnEvent("sortChanged",t))),this.dispatchStateUpdatedEvent("sort")}setMenuVisible(e,t="api"){this.menuVisible!==e&&(this.menuVisible=e,this.eventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",t)))}isMenuVisible(){return this.menuVisible}isSortAscending(){return"asc"===this.sort}isSortDescending(){return"desc"===this.sort}isSortNone(){return u(this.sort)}isSorting(){return _(this.sort)}getSortIndex(){return this.sortIndex}setSortIndex(e){this.sortIndex=e,this.dispatchStateUpdatedEvent("sortIndex")}setAggFunc(e){this.aggFunc=e,this.dispatchStateUpdatedEvent("aggFunc")}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t="api"){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.eventService.dispatchEvent(this.createColumnEvent("leftChanged",t)))}isFilterActive(){return this.filterActive}setFilterActive(e,t="api",i){this.filterActive!==e&&(this.filterActive=e,this.eventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",t)));const n=this.createColumnEvent("filterChanged",t);i&&be(n,i),this.eventService.dispatchEvent(n)}isHovered(){return this.columnHoverService.isHovered(this)}setPinned(e){this.pinned=!0===e||"left"===e?"left":"right"===e?"right":null,this.dispatchStateUpdatedEvent("pinned")}setFirstRightPinned(e,t="api"){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.eventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",t)))}setLastLeftPinned(e,t="api"){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.eventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",t)))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return"left"===this.pinned||"right"===this.pinned}isPinnedLeft(){return"left"===this.pinned}isPinnedRight(){return"right"===this.pinned}getPinned(){return this.pinned}setVisible(e,t="api"){const i=!0===e;this.visible!==i&&(this.visible=i,this.eventService.dispatchEvent(this.createColumnEvent("visibleChanged",t))),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){const e=this.getColDef();return!e.suppressSpanHeaderHeight&&!e.autoHeaderHeight}getColDef(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getDefinition(){return this.colDef}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return{node:e,data:e.data,colDef:this.colDef,column:this,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}}getColSpan(e){if(u(this.colDef.colSpan))return 1;const t=this.createBaseColDefParams(e),i=this.colDef.colSpan(t);return Math.max(i,1)}getRowSpan(e){if(u(this.colDef.rowSpan))return 1;const t=this.createBaseColDefParams(e),i=this.colDef.rowSpan(t);return Math.max(i,1)}setActualWidth(e,t="api",i=!1){null!=this.minWidth&&(e=Math.max(e,this.minWidth)),null!=this.maxWidth&&(e=Math.min(e,this.maxWidth)),this.actualWidth!==e&&(this.actualWidth=e,this.flex&&"flex"!==t&&"gridInitializing"!==t&&(this.flex=null),i||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.eventService.dispatchEvent(this.createColumnEvent("widthChanged",e))}isGreaterThanMax(e){return null!=this.maxWidth&&e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex||0}setFlex(e){this.flex!==e&&(this.flex=e),this.dispatchStateUpdatedEvent("flex")}setMinimum(e="api"){_(this.minWidth)&&this.setActualWidth(this.minWidth,e)}setRowGroupActive(e,t="api"){this.rowGroupActive!==e&&(this.rowGroupActive=e,this.eventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",t))),this.dispatchStateUpdatedEvent("rowGroup")}isRowGroupActive(){return this.rowGroupActive}setPivotActive(e,t="api"){this.pivotActive!==e&&(this.pivotActive=e,this.eventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",t))),this.dispatchStateUpdatedEvent("pivot")}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}setValueActive(e,t="api"){this.aggregationActive!==e&&(this.aggregationActive=e,this.eventService.dispatchEvent(this.createColumnEvent("columnValueChanged",t)))}isValueActive(){return this.aggregationActive}isAllowPivot(){return!0===this.colDef.enablePivot}isAllowValue(){return!0===this.colDef.enableValue}isAllowRowGroup(){return!0===this.colDef.enableRowGroup}getMenuTabs(e){let t=this.getColDef().menuTabs;return null==t&&(t=e),t}dispatchStateUpdatedEvent(e){this.eventService.dispatchEvent({type:d.EVENT_STATE_UPDATED,key:e})}}d.EVENT_MOVING_CHANGED="movingChanged",d.EVENT_LEFT_CHANGED="leftChanged",d.EVENT_WIDTH_CHANGED="widthChanged",d.EVENT_LAST_LEFT_PINNED_CHANGED="lastLeftPinnedChanged",d.EVENT_FIRST_RIGHT_PINNED_CHANGED="firstRightPinnedChanged",d.EVENT_VISIBLE_CHANGED="visibleChanged",d.EVENT_FILTER_CHANGED="filterChanged",d.EVENT_FILTER_ACTIVE_CHANGED="filterActiveChanged",d.EVENT_SORT_CHANGED="sortChanged",d.EVENT_COL_DEF_CHANGED="colDefChanged",d.EVENT_MENU_VISIBLE_CHANGED="menuVisibleChanged",d.EVENT_ROW_GROUP_CHANGED="columnRowGroupChanged",d.EVENT_PIVOT_CHANGED="columnPivotChanged",d.EVENT_VALUE_CHANGED="columnValueChanged",d.EVENT_STATE_UPDATED="columnStateUpdated",Ke([o("gridOptionsService")],d.prototype,"gridOptionsService",void 0),Ke([o("columnUtils")],d.prototype,"columnUtils",void 0),Ke([o("columnHoverService")],d.prototype,"columnHoverService",void 0),Ke([r],d.prototype,"initialise",null);var Ze=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class h{constructor(e,t,i,n){this.localEventService=new qe,this.expandable=!1,this.instanceId=Qe(),this.expandableListenerRemoveCallback=null,this.colGroupDef=e,this.groupId=t,this.expanded=!!e&&!!e.openByDefault,this.padding=i,this.level=n}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0)}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return!!this.children&&this.children.some(e=>e.isVisible())}isPadding(){return this.padding}setExpanded(e){this.expanded=void 0!==e&&e;const t={type:h.EVENT_EXPANDED_CHANGED};this.localEventService.dispatchEvent(t)}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}addLeafColumns(t){this.children&&this.children.forEach(e=>{e instanceof d?t.push(e):e instanceof h&&e.addLeafColumns(t)})}getColumnGroupShow(){const e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const t=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach(e=>e.addEventListener("visibleChanged",t)),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach(e=>e.removeEventListener("visibleChanged",t)),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let n=!1,r=!1,s=!1;const o=this.findChildrenRemovingPadding();for(let i=0,e=o.length;i<e;i++){const e=o[i];if(!e.isVisible())continue;const t=e.getColumnGroupShow();"open"===t?(n=!0,s=!0):"closed"===t?(r=!0,s=!0):(n=!0,r=!0)}const e=n&&r&&s;if(this.expandable!==e){this.expandable=e;const n={type:h.EVENT_EXPANDABLE_CHANGED};this.localEventService.dispatchEvent(n)}}findChildrenRemovingPadding(){const t=[],i=e=>{e.forEach(e=>{e instanceof h&&e.isPadding()?i(e.children):t.push(e)})};return i(this.children),t}onColumnVisibilityChanged(){this.setExpandable()}addEventListener(e,t){this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService.removeEventListener(e,t)}}h.EVENT_EXPANDED_CHANGED="expandedChanged",h.EVENT_EXPANDABLE_CHANGED="expandableChanged",Ze([Ve],h.prototype,"destroy",null);const Je={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function et(...i){for(let t=0;t<i.length;t++){const e=i[t];if(_(e))return e}return null}function tt(e){return null!=e&&e.length>0}function p(e){if(e&&e.length)return e[e.length-1]}function it(e,i,n){return null==e&&null==i||null!=e&&null!=i&&e.length===i.length&&e.every((e,t)=>n?n(e,i[t]):i[t]===e)}function nt(e,t){return it(e,t)}function rt(e){return e.sort((e,t)=>e-t)}function st(n,r){if(n)for(let i=n.length-2;i>=0;i--){const e=n[i]===r,t=n[i+1]===r;e&&t&&n.splice(i+1,1)}}function ot(e,t){const i=e.indexOf(t);i>=0&&e.splice(i,1)}function at(t,e){e.forEach(e=>ot(t,e))}function lt(e,t,i){e.splice(i,0,t)}function ct(t,i,n){if(null!=t&&null!=i)for(let e=i.length-1;e>=0;e--){lt(t,i[e],n)}}function ut(t,e,i){at(t,e),e.slice().reverse().forEach(e=>lt(t,e,i))}function dt(e,t){return e.indexOf(t)>-1}function ht(e){return[].concat.apply([],e)}function pt(t,e){null!=e&&null!=t&&e.forEach(e=>t.push(e))}function ft(e){return e.map(te)}function gt(t,i){if(null!=t)for(let e=t.length-1;e>=0;e--)i(t[e],e)}const mt=["touchstart","touchend","touchmove","touchcancel","scroll"],vt={};function yt(e){e.__ag_Grid_Stop_Propagation=!0}function bt(e){return!0===e.__ag_Grid_Stop_Propagation}const Ct=(()=>{const i={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return e=>{if("boolean"==typeof vt[e])return vt[e];const t=document.createElement(i[e]||"div");return vt[e="on"+e]=e in t}})();function wt(e,t,i){let n=t;for(;n;){const t=e.getDomData(n,i);if(t)return t;n=n.parentElement}return null}function _t(e,t){return!(!t||!e)&&Et(t).indexOf(e)>=0}function At(e){const t=[];let i=e.target;for(;i;)t.push(i),i=i.parentElement;return t}function Et(e){const t=e;return t.path?t.path:t.composedPath?t.composedPath():At(t)}function St(e,t,i,n){const r=dt(mt,i)?{passive:!0}:void 0;e&&e.addEventListener&&e.addEventListener(t,i,n,r)}var Tt=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class f{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.isAlive=()=>!this.destroyed}getFrameworkOverrides(){return this.frameworkOverrides}getContext(){return this.context}destroy(){this.destroyFunctions.forEach(e=>e()),this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchEvent({type:f.EVENT_DESTROYED})}addEventListener(e,t){this.localEventService||(this.localEventService=new qe),this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService&&this.localEventService.removeEventListener(e,t)}dispatchEventAsync(e){window.setTimeout(()=>this.dispatchEvent(e),0)}dispatchEvent(e){this.localEventService&&this.localEventService.dispatchEvent(e)}addManagedListener(e,t,i){if(this.destroyed)return;e instanceof HTMLElement?St(this.getFrameworkOverrides(),e,t,i):e.addEventListener(t,i);const n=()=>(e.removeEventListener(t,i),this.destroyFunctions=this.destroyFunctions.filter(e=>e!==n),null);return this.destroyFunctions.push(n),n}addManagedPropertyListener(e,t){if(this.destroyed)return;this.gridOptionsService.addEventListener(e,t);const i=()=>(this.gridOptionsService.removeEventListener(e,t),this.destroyFunctions=this.destroyFunctions.filter(e=>e!==i),null);return this.destroyFunctions.push(i),i}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createManagedBean(e,t){const i=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),i}createBean(e,t,i){return(t||this.getContext()).createBean(e,i)}destroyBean(e,t){return(t||this.getContext()).destroyBean(e)}destroyBeans(e,t){return e&&e.forEach(e=>this.destroyBean(e,t)),[]}}f.EVENT_DESTROYED="destroyed",Tt([o("frameworkOverrides")],f.prototype,"frameworkOverrides",void 0),Tt([o("context")],f.prototype,"context",void 0),Tt([o("eventService")],f.prototype,"eventService",void 0),Tt([o("gridOptionsService")],f.prototype,"gridOptionsService",void 0),Tt([o("localeService")],f.prototype,"localeService",void 0),Tt([o("environment")],f.prototype,"environment",void 0),Tt([Ve],f.prototype,"destroy",null);var xt=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},Dt=function(i,n){return function(e,t){n(e,t,i)}};let Rt=class extends f{setBeans(e){this.logger=e.create("ColumnFactory")}createColumnTree(e,t,i){const n=new ce,{existingCols:r,existingGroups:s,existingColKeys:o}=this.extractExistingTreeData(i);n.addExistingKeys(o);const a=this.recursivelyCreateColumns(e,0,t,r,n,s),l=this.findMaxDept(a,0);this.logger.log("Number of levels for grouped columns is "+l);const c=this.balanceColumnTree(a,0,l,n);return this.columnUtils.depthFirstOriginalTreeSearch(null,c,(e,t)=>{e instanceof h&&e.setupExpandable(),e.setOriginalParent(t)}),{columnTree:c,treeDept:l}}extractExistingTreeData(e){const t=[],i=[],n=[];return e&&this.columnUtils.depthFirstOriginalTreeSearch(null,e,e=>{if(e instanceof h){const t=e;i.push(t)}else{const i=e;n.push(i.getId()),t.push(i)}}),{existingCols:t,existingGroups:i,existingColKeys:n}}createForAutoGroups(e,t){return e.map(e=>this.createAutoGroupTreeItem(t,e))}createAutoGroupTreeItem(t,i){let n=i;for(let e=this.findDepth(t)-1;e>=0;e--){const t=new h(null,`FAKE_PATH_${i.getId()}}_${e}`,!0,e);this.createBean(t),t.setChildren([n]),n.setOriginalParent(t),n=t}return n}findDepth(e){let t=0,i=e;for(;i&&i[0]&&i[0]instanceof h;)t++,i=i[0].getChildren();return t}balanceColumnTree(r,s,o,a){const l=[];for(let e=0;e<r.length;e++){const n=r[e];if(n instanceof h){const r=n,e=this.balanceColumnTree(r.getChildren(),s+1,o,a);r.setChildren(e),l.push(r)}else{let t,i;for(let e=o-1;e>=s;e--){const r=a.getUniqueKey(null,null),o=this.createMergedColGroupDef(null),l=new h(o,r,!0,s);this.createBean(l),i&&i.setChildren([l]),i=l,t||(t=i)}if(t&&i){l.push(t);if(r.some(e=>e instanceof h)){i.setChildren([n]);continue}i.setChildren(r);break}l.push(n)}}return l}findMaxDept(i,n){let r=n;for(let e=0;e<i.length;e++){const t=i[e];if(t instanceof h){const i=t,e=this.findMaxDept(i.getChildren(),n+1);r<e&&(r=e)}}return r}recursivelyCreateColumns(e,t,i,n,r,s){return(e||[]).map(e=>this.isColumnGroup(e)?this.createColumnGroup(i,e,t,n,r,s):this.createColumn(i,e,n,r))}createColumnGroup(e,t,i,n,r,s){const o=this.createMergedColGroupDef(t),a=r.getUniqueKey(o.groupId||null,null),l=new h(o,a,!1,i);this.createBean(l);const c=this.findExistingGroup(t,s);c&&ot(s,c),c&&c.isExpanded()&&l.setExpanded(!0);const u=this.recursivelyCreateColumns(o.children,i+1,e,n,r,s);return l.setChildren(u),l}createMergedColGroupDef(e){const t={};return Object.assign(t,this.gridOptionsService.get("defaultColGroupDef")),Object.assign(t,e),t}createColumn(t,i,n,r){let s=this.findExistingColumn(i,n);if(n&&s&&ot(n,s),s){const t=this.mergeColDefs(i,s.getColId());s.setColDef(t,i),this.applyColumnState(s,t)}else{const n=r.getUniqueKey(i.colId,i.field),e=this.mergeColDefs(i,n);s=new d(e,i,n,t),this.context.createBean(s)}return this.dataTypeService.addColumnListeners(s),s}applyColumnState(e,t){const i=ie(t.flex);void 0!==i&&e.setFlex(i);if(e.getFlex()<=0){const i=ie(t.width);if(null!=i)e.setActualWidth(i);else{const t=e.getActualWidth();e.setActualWidth(t)}}void 0!==t.sort&&("asc"==t.sort||"desc"==t.sort?e.setSort(t.sort):e.setSort(void 0));const n=ie(t.sortIndex);void 0!==n&&e.setSortIndex(n);const r=ne(t.hide);void 0!==r&&e.setVisible(!r),void 0!==t.pinned&&e.setPinned(t.pinned)}findExistingColumn(r,e){return(e||[]).find(e=>{const t=e.getUserProvidedColDef();if(!t)return!1;const i=null!=r.colId,n=null!=r.field;return i?e.getId()===r.colId:n?t.field===r.field:t===r})}findExistingGroup(t,e){return e.find(e=>{if(!e.getColGroupDef())return!1;return!(null==t.groupId)&&e.getId()===t.groupId})}mergeColDefs(e,t){const i={};be(i,this.gridOptionsService.get("defaultColDef"),!1,!0);const n=this.dataTypeService.updateColDefAndGetColumnType(i,e,t);n&&this.assignColumnTypes(n,i),be(i,e,!1,!0);const r=this.gridOptionsService.get("autoGroupColumnDef"),s=this.gridOptionsService.isColumnsSortingCoupledToGroup();return e.rowGroup&&r&&s&&be(i,{sort:r.sort,initialSort:r.initialSort},!1,!0),this.dataTypeService.validateColDef(i),i}assignColumnTypes(e,i){if(!e.length)return;const n=Object.assign({},Je);a(this.gridOptionsService.get("columnTypes")||{},(e,t)=>{e in n?console.warn(`AG Grid: the column type '${e}' is a default column type and cannot be overridden.`):n[e]=t}),e.forEach(e=>{const t=n[e.trim()];t?be(i,t,!1,!0):console.warn("AG Grid: colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes")})}isColumnGroup(e){return void 0!==e.children}};xt([o("columnUtils")],Rt.prototype,"columnUtils",void 0),xt([o("dataTypeService")],Rt.prototype,"dataTypeService",void 0),xt([Dt(0,ze("loggerFactory"))],Rt.prototype,"setBeans",null),Rt=xt([s("columnFactory")],Rt);var Mt=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class g{constructor(e,t,i,n){this.displayedChildren=[],this.localEventService=new qe,this.groupId=t,this.partId=i,this.providedColumnGroup=e,this.pinned=n}static createUniqueId(e,t){return e+"_"+t}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}setParent(e){this.parent=e}getUniqueId(){return g.createUniqueId(this.groupId,this.partId)}isEmptyGroup(){return 0===this.displayedChildren.length}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!(!e||0===e.length)&&e.every(e=>e.isMoving())}checkLeft(){if(this.displayedChildren.forEach(e=>{e instanceof g&&e.checkLeft()}),this.displayedChildren.length>0)if(this.gridOptionsService.is("enableRtl")){const e=p(this.displayedChildren).getLeft();this.setLeft(e)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=e,this.left!==e&&(this.left=e,this.localEventService.dispatchEvent(this.createAgEvent(g.EVENT_LEFT_CHANGED)))}getPinned(){return this.pinned}createAgEvent(e){return{type:e}}addEventListener(e,t){this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService.removeEventListener(e,t)}getGroupId(){return this.groupId}getPartId(){return this.partId}isChildInThisGroupDeepSearch(t){let i=!1;return this.children.forEach(e=>{t===e&&(i=!0),e instanceof g&&e.isChildInThisGroupDeepSearch(t)&&(i=!0)}),i}getActualWidth(){let t=0;return this.displayedChildren&&this.displayedChildren.forEach(e=>{t+=e.getActualWidth()}),t}isResizable(){if(!this.displayedChildren)return!1;let t=!1;return this.displayedChildren.forEach(e=>{e.isResizable()&&(t=!0)}),t}getMinWidth(){let t=0;return this.displayedChildren.forEach(e=>{t+=e.getMinWidth()||0}),t}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}addDisplayedLeafColumns(t){this.displayedChildren.forEach(e=>{e instanceof d?t.push(e):e instanceof g&&e.addDisplayedLeafColumns(t)})}addLeafColumns(t){this.children.forEach(e=>{e instanceof d?t.push(e):e instanceof g&&e.addLeafColumns(t)})}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return this.isPadding()&&e&&e.isPadding()?1+e.getPaddingLevel():0}calculateDisplayedColumns(){this.displayedChildren=[];let t=this;for(;null!=t&&t.isPadding();)t=t.getParent();if(!(!!t&&t.providedColumnGroup.isExpandable()))return this.displayedChildren=this.children,void this.localEventService.dispatchEvent(this.createAgEvent(g.EVENT_DISPLAYED_CHILDREN_CHANGED));this.children.forEach(e=>{if(e instanceof g&&(!e.displayedChildren||!e.displayedChildren.length))return;switch(e.getColumnGroupShow()){case"open":t.providedColumnGroup.isExpanded()&&this.displayedChildren.push(e);break;case"closed":t.providedColumnGroup.isExpanded()||this.displayedChildren.push(e);break;default:this.displayedChildren.push(e)}}),this.localEventService.dispatchEvent(this.createAgEvent(g.EVENT_DISPLAYED_CHILDREN_CHANGED))}}g.EVENT_LEFT_CHANGED="leftChanged",g.EVENT_DISPLAYED_CHILDREN_CHANGED="displayedChildrenChanged",Mt([o("gridOptionsService")],g.prototype,"gridOptionsService",void 0);class y{}y.EVENT_COLUMN_EVERYTHING_CHANGED="columnEverythingChanged",y.EVENT_NEW_COLUMNS_LOADED="newColumnsLoaded",y.EVENT_COLUMN_PIVOT_MODE_CHANGED="columnPivotModeChanged",y.EVENT_COLUMN_ROW_GROUP_CHANGED="columnRowGroupChanged",y.EVENT_EXPAND_COLLAPSE_ALL="expandOrCollapseAll",y.EVENT_COLUMN_PIVOT_CHANGED="columnPivotChanged",y.EVENT_GRID_COLUMNS_CHANGED="gridColumnsChanged",y.EVENT_COLUMN_VALUE_CHANGED="columnValueChanged",y.EVENT_COLUMN_MOVED="columnMoved",y.EVENT_COLUMN_VISIBLE="columnVisible",y.EVENT_COLUMN_PINNED="columnPinned",y.EVENT_COLUMN_GROUP_OPENED="columnGroupOpened",y.EVENT_COLUMN_RESIZED="columnResized",y.EVENT_DISPLAYED_COLUMNS_CHANGED="displayedColumnsChanged",y.EVENT_VIRTUAL_COLUMNS_CHANGED="virtualColumnsChanged",y.EVENT_ASYNC_TRANSACTIONS_FLUSHED="asyncTransactionsFlushed",y.EVENT_ROW_GROUP_OPENED="rowGroupOpened",y.EVENT_ROW_DATA_CHANGED="rowDataChanged",y.EVENT_ROW_DATA_UPDATED="rowDataUpdated",y.EVENT_PINNED_ROW_DATA_CHANGED="pinnedRowDataChanged",y.EVENT_RANGE_SELECTION_CHANGED="rangeSelectionChanged",y.EVENT_CHART_CREATED="chartCreated",y.EVENT_CHART_RANGE_SELECTION_CHANGED="chartRangeSelectionChanged",y.EVENT_CHART_OPTIONS_CHANGED="chartOptionsChanged",y.EVENT_CHART_DESTROYED="chartDestroyed",y.EVENT_TOOL_PANEL_VISIBLE_CHANGED="toolPanelVisibleChanged",y.EVENT_TOOL_PANEL_SIZE_CHANGED="toolPanelSizeChanged",y.EVENT_COLUMN_PANEL_ITEM_DRAG_START="columnPanelItemDragStart",y.EVENT_COLUMN_PANEL_ITEM_DRAG_END="columnPanelItemDragEnd",y.EVENT_MODEL_UPDATED="modelUpdated",y.EVENT_CUT_START="cutStart",y.EVENT_CUT_END="cutEnd",y.EVENT_PASTE_START="pasteStart",y.EVENT_PASTE_END="pasteEnd",y.EVENT_FILL_START="fillStart",y.EVENT_FILL_END="fillEnd",y.EVENT_RANGE_DELETE_START="rangeDeleteStart",y.EVENT_RANGE_DELETE_END="rangeDeleteEnd",y.EVENT_UNDO_STARTED="undoStarted",y.EVENT_UNDO_ENDED="undoEnded",y.EVENT_REDO_STARTED="redoStarted",y.EVENT_REDO_ENDED="redoEnded",y.EVENT_KEY_SHORTCUT_CHANGED_CELL_START="keyShortcutChangedCellStart",y.EVENT_KEY_SHORTCUT_CHANGED_CELL_END="keyShortcutChangedCellEnd",y.EVENT_CELL_CLICKED="cellClicked",y.EVENT_CELL_DOUBLE_CLICKED="cellDoubleClicked",y.EVENT_CELL_MOUSE_DOWN="cellMouseDown",y.EVENT_CELL_CONTEXT_MENU="cellContextMenu",y.EVENT_CELL_VALUE_CHANGED="cellValueChanged",y.EVENT_CELL_EDIT_REQUEST="cellEditRequest",y.EVENT_ROW_VALUE_CHANGED="rowValueChanged",y.EVENT_CELL_FOCUSED="cellFocused",y.EVENT_CELL_FOCUS_CLEARED="cellFocusCleared",y.EVENT_FULL_WIDTH_ROW_FOCUSED="fullWidthRowFocused",y.EVENT_ROW_SELECTED="rowSelected",y.EVENT_SELECTION_CHANGED="selectionChanged",y.EVENT_CELL_KEY_DOWN="cellKeyDown",y.EVENT_CELL_MOUSE_OVER="cellMouseOver",y.EVENT_CELL_MOUSE_OUT="cellMouseOut",y.EVENT_FILTER_CHANGED="filterChanged",y.EVENT_FILTER_MODIFIED="filterModified",y.EVENT_FILTER_OPENED="filterOpened",y.EVENT_SORT_CHANGED="sortChanged",y.EVENT_VIRTUAL_ROW_REMOVED="virtualRowRemoved",y.EVENT_ROW_CLICKED="rowClicked",y.EVENT_ROW_DOUBLE_CLICKED="rowDoubleClicked",y.EVENT_GRID_READY="gridReady",y.EVENT_GRID_SIZE_CHANGED="gridSizeChanged",y.EVENT_VIEWPORT_CHANGED="viewportChanged",y.EVENT_SCROLLBAR_WIDTH_CHANGED="scrollbarWidthChanged",y.EVENT_FIRST_DATA_RENDERED="firstDataRendered",y.EVENT_DRAG_STARTED="dragStarted",y.EVENT_DRAG_STOPPED="dragStopped",y.EVENT_CHECKBOX_CHANGED="checkboxChanged",y.EVENT_ROW_EDITING_STARTED="rowEditingStarted",y.EVENT_ROW_EDITING_STOPPED="rowEditingStopped",y.EVENT_CELL_EDITING_STARTED="cellEditingStarted",y.EVENT_CELL_EDITING_STOPPED="cellEditingStopped",y.EVENT_BODY_SCROLL="bodyScroll",y.EVENT_BODY_SCROLL_END="bodyScrollEnd",y.EVENT_HEIGHT_SCALE_CHANGED="heightScaleChanged",y.EVENT_PAGINATION_CHANGED="paginationChanged",y.EVENT_COMPONENT_STATE_CHANGED="componentStateChanged",y.EVENT_STORE_REFRESHED="storeRefreshed",y.EVENT_BODY_HEIGHT_CHANGED="bodyHeightChanged",y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED="displayedColumnsWidthChanged",y.EVENT_SCROLL_VISIBILITY_CHANGED="scrollVisibilityChanged",y.EVENT_COLUMN_HOVER_CHANGED="columnHoverChanged",y.EVENT_FLASH_CELLS="flashCells",y.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED="paginationPixelOffsetChanged",y.EVENT_DISPLAYED_ROWS_CHANGED="displayedRowsChanged",y.EVENT_LEFT_PINNED_WIDTH_CHANGED="leftPinnedWidthChanged",y.EVENT_RIGHT_PINNED_WIDTH_CHANGED="rightPinnedWidthChanged",y.EVENT_ROW_CONTAINER_HEIGHT_CHANGED="rowContainerHeightChanged",y.EVENT_HEADER_HEIGHT_CHANGED="headerHeightChanged",y.EVENT_COLUMN_HEADER_HEIGHT_CHANGED="columnHeaderHeightChanged",y.EVENT_ROW_DRAG_ENTER="rowDragEnter",y.EVENT_ROW_DRAG_MOVE="rowDragMove",y.EVENT_ROW_DRAG_LEAVE="rowDragLeave",y.EVENT_ROW_DRAG_END="rowDragEnd",y.EVENT_GRID_STYLES_CHANGED="gridStylesChanged",y.EVENT_POPUP_TO_FRONT="popupToFront",y.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST="columnRowGroupChangeRequest",y.EVENT_COLUMN_PIVOT_CHANGE_REQUEST="columnPivotChangeRequest",y.EVENT_COLUMN_VALUE_CHANGE_REQUEST="columnValueChangeRequest",y.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST="columnAggFuncChangeRequest",y.EVENT_KEYBOARD_FOCUS="keyboardFocus",y.EVENT_MOUSE_FOCUS="mouseFocus",y.EVENT_STORE_UPDATED="storeUpdated",y.EVENT_FILTER_DESTROYED="filterDestroyed",y.EVENT_ROW_DATA_UPDATE_STARTED="rowDataUpdateStarted";class Nt{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let i;return i="number"!=typeof t?0:t+1,this.existingIds[e]=i,i}}var Ot=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};const It="ag-Grid-AutoColumn";let Pt=class extends f{createAutoGroupColumns(i,e){const n=[],t=this.gridOptionsService.isTreeData();let r=this.gridOptionsService.isGroupMultiAutoColumn();return t&&r&&(console.warn('AG Grid: you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data'),r=!1),r?e.forEach((e,t)=>{n.push(this.createOneAutoGroupColumn(i,e,t))}):n.push(this.createOneAutoGroupColumn(i)),n}createOneAutoGroupColumn(e,t,i){let n,r=this.generateDefaultColDef(t);n=t?`${It}-${t.getId()}`:It;if(be(r,this.gridOptionsService.get("autoGroupColumnDef")),r=this.columnFactory.mergeColDefs(r,n),r.colId=n,!this.gridOptionsService.isTreeData()){u(r.field)&&u(r.valueGetter)&&u(r.filterValueGetter)&&"agGroupColumnFilter"!==r.filter&&(r.filter=!1)}i&&i>0&&(r.headerCheckboxSelection=!1);const s=e.find(e=>e.getId()==n),o=this.gridOptionsService.isColumnsSortingCoupledToGroup();if(s)return o&&(r.sort=void 0,r.sortIndex=void 0),s.setColDef(r,null),this.columnFactory.applyColumnState(s,r),s;o&&(r.sort||r.initialSort||"sortIndex"in r)&&!r.field&&(r.sort=null,r.sortIndex=null,r.initialSort=null);const a=new d(r,null,n,!0);return this.context.createBean(a),a}generateDefaultColDef(e){const t=this.gridOptionsService.get("autoGroupColumnDef"),i={headerName:this.localeService.getLocaleTextFunc()("group","Group")};if(t&&(t.cellRenderer||t.cellRendererSelector)||(i.cellRenderer="agGroupCellRenderer"),e){const t=e.getColDef();Object.assign(i,{headerName:this.columnModel.getDisplayNameForColumn(e,"header"),headerValueGetter:t.headerValueGetter}),t.cellRenderer&&Object.assign(i,{cellRendererParams:{innerRenderer:t.cellRenderer,innerRendererParams:t.cellRendererParams}}),i.showRowGroup=e.getColId()}else i.showRowGroup=!0;return i}};Ot([o("columnModel")],Pt.prototype,"columnModel",void 0),Ot([o("columnFactory")],Pt.prototype,"columnFactory",void 0),Pt=Ot([s("autoGroupColService")],Pt);const kt=/[&<>"']/g,Lt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Ft(e){const i=String.fromCharCode;function n(e,t){return i(e>>t&63|128)}function t(e){if(e>=0&&e<=31&&10!==e){return`_x${e.toString(16).toUpperCase().padStart(4,"0")}_`}if(0==(4294967168&e))return i(e);let t="";return 0==(4294965248&e)?t=i(e>>6&31|192):0==(4294901760&e)?(!function(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}(e),t=i(e>>12&15|224),t+=n(e,6)):0==(4292870144&e)&&(t=i(e>>18&7|240),t+=n(e,12),t+=n(e,6)),t+=i(63&e|128),t}const r=function(e){const t=[];if(!e)return[];const i=e.length;let n,r,s=0;for(;s<i;)n=e.charCodeAt(s++),n>=55296&&n<=56319&&s<i?(r=e.charCodeAt(s++),56320==(64512&r)?t.push(((1023&n)<<10)+(1023&r)+65536):(t.push(n),s--)):t.push(n);return t}(e),s=r.length;let o,a=-1,l="";for(;++a<s;)o=r[a],l+=t(o);return l}function Gt(e){return e[0].toUpperCase()+e.substr(1).toLowerCase()}function $t(e,t){if(null==e)return null;const i=e.toString().toString();return t?i:i.replace(kt,e=>Lt[e])}function Ht(e){if(!e||null==e)return null;return e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z])([a-z])/g,"$1 $2$3").replace(/\./g," ").split(" ").map(e=>e.substring(0,1).toUpperCase()+(e.length>1?e.substring(1,e.length):"")).join(" ")}function Bt(e){return e.replace(/[A-Z]/g,e=>"-"+e.toLocaleLowerCase())}function Vt(e){const t=new Map;return e.forEach(e=>t.set(e[0],e[1])),t}function Wt(e,t){const i=new Map;return e.forEach(e=>i.set(t(e),e)),i}function zt(e){const i=[];return e.forEach((e,t)=>i.push(t)),i}class jt{}jt.ColDefPropertyMap={headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnsMenuParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0},jt.ALL_PROPERTIES=Object.keys(jt.ColDefPropertyMap);class b{}b.STRING_PROPERTIES=["rowSelection","overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","serverSideStoreType","groupDisplayType","treeDataDisplayType","colResizeDefault"],b.OBJECT_PROPERTIES=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions"],b.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass"],b.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","tabIndex"],b.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHorizontalScroll","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSelectsChildren","groupIncludeFooter","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressParentsInRowNodes","suppressColumnMoveAnimation","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","rememberGroupStateWhenNewData","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressAggAtRootLevel","suppressFocusAfterRefresh","functionsPassive","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","excludeHiddenColumnsFromQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","treeData","masterDetail","suppressMultiRangeSelection","enterMovesDown","enterMovesDownAfterEdit","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","enableChartToolPanelsButton","suppressChartToolPanelsButton","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideFilteringAlwaysResets","serverSideFilterAllLevels","serverSideSortingAlwaysResets","serverSideSortAllLevels","serverSideOnlyRefreshFilteredGroups","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","maintainColumnOrder","groupMaintainOrder","columnHoverHighlight","suppressReactUi","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","suppressCutToClipboard"],b.FUNCTIONAL_PROPERTIES=["doesExternalFilterPass","processSecondaryColDef","processSecondaryColGroupDef","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer"],b.CALLBACK_PROPERTIES=["getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideStoreParams","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","groupAggFiltering"],b.FUNCTION_PROPERTIES=[...b.FUNCTIONAL_PROPERTIES,...b.CALLBACK_PROPERTIES],b.ALL_PROPERTIES=[...b.ARRAY_PROPERTIES,...b.OBJECT_PROPERTIES,...b.STRING_PROPERTIES,...b.NUMBER_PROPERTIES,...b.FUNCTION_PROPERTIES,...b.BOOLEAN_PROPERTIES];class C{static getCallbackForEvent(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substr(1)}static getCoercionLookup(){let t={};return[...C.ARRAY_PROPERTIES,...C.OBJECT_PROPERTIES,...C.STRING_PROPERTIES,...C.FUNCTION_PROPERTIES,...C.EVENT_CALLBACKS].forEach(e=>t[e]="none"),C.BOOLEAN_PROPERTIES.forEach(e=>t[e]="boolean"),C.NUMBER_PROPERTIES.forEach(e=>t[e]="number"),t}static getValue(t,i){const n=C.coercionLookup[t];if(n){let e=i;switch(n){case"number":e=C.toNumber(i);break;case"boolean":e=C.toBoolean(i);break;case"none":"groupAggFiltering"===t&&"function"!=typeof i&&(e=C.toBoolean(i))}return e}}static getGridOptionKeys(e,t){return t?Object.keys(C.coercionLookup):Object.keys(e)}static copyAttributesToGridOptions(e,i,t=!1){"object"!=typeof e&&(e={});const n=e;return C.getGridOptionKeys(i,t).forEach(e=>{const t=i[e];if(void 0!==t){const i=C.getValue(e,t);void 0!==i&&(n[e]=i)}}),e}static processOnChange(e,n){if(!e||0===Object.keys(e).length)return;const r=Object.assign({},e);r.columnTypes&&(n.setColumnTypes(r.columnTypes.currentValue,"gridOptionsChanged"),delete r.columnTypes),r.autoGroupColumnDef&&(n.setAutoGroupColumnDef(r.autoGroupColumnDef.currentValue,"gridOptionsChanged"),delete r.autoGroupColumnDef),r.defaultColDef&&(n.setDefaultColDef(r.defaultColDef.currentValue,"gridOptionsChanged"),delete r.defaultColDef),r.columnDefs&&(n.setColumnDefs(r.columnDefs.currentValue,"gridOptionsChanged"),delete r.columnDefs),Object.keys(r).forEach(e=>{const t=e,i=C.getValue(t,r[t].currentValue);n.__setProperty(t,i)});const i={type:y.EVENT_COMPONENT_STATE_CHANGED};a(e,(e,t)=>{i[e]=t}),n.dispatchEvent(i)}static toBoolean(e){return"boolean"==typeof e?e:"string"==typeof e&&("TRUE"===e.toUpperCase()||""==e)}static toNumber(e){return"number"==typeof e?e:"string"==typeof e?Number(e):void 0}}function Ut(e,i,t){const n={},r=e.filter(t=>!i.some(e=>e===t));return r.length>0&&r.forEach(e=>n[e]=Yt(e,t)),n}function Yt(t,e,i,n){let r=e.map(e=>({value:e,relevance:qt(t.toLowerCase(),e.toLocaleLowerCase())}));if(r.sort((e,t)=>t.relevance-e.relevance),i&&(r=r.filter(e=>0!==e.relevance)),n&&n>0){const t=r[0].relevance*n;r=r.filter(e=>t-e.relevance<0)}return r.map(e=>e.value)}function qt(e,t){const i=e.replace(/\s/g,""),n=t.replace(/\s/g,"");let r=0,s=-1;for(let e=0;e<i.length;e++){const t=n.indexOf(i[e],s+1);-1!==t&&(s=t,r+=100-100*s/1e4*100)}return r}C.EVENTS=le(y),C.EXCLUDED_INTERNAL_EVENTS=[y.EVENT_SCROLLBAR_WIDTH_CHANGED,y.EVENT_CHECKBOX_CHANGED,y.EVENT_HEIGHT_SCALE_CHANGED,y.EVENT_BODY_HEIGHT_CHANGED,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,y.EVENT_SCROLL_VISIBILITY_CHANGED,y.EVENT_COLUMN_HOVER_CHANGED,y.EVENT_FLASH_CELLS,y.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,y.EVENT_DISPLAYED_ROWS_CHANGED,y.EVENT_LEFT_PINNED_WIDTH_CHANGED,y.EVENT_RIGHT_PINNED_WIDTH_CHANGED,y.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,y.EVENT_POPUP_TO_FRONT,y.EVENT_KEYBOARD_FOCUS,y.EVENT_MOUSE_FOCUS,y.EVENT_STORE_UPDATED,y.EVENT_COLUMN_PANEL_ITEM_DRAG_START,y.EVENT_COLUMN_PANEL_ITEM_DRAG_END,y.EVENT_FILL_START,y.EVENT_FILL_END,y.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,y.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,y.EVENT_FULL_WIDTH_ROW_FOCUSED,y.EVENT_HEADER_HEIGHT_CHANGED,y.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,y.EVENT_CELL_FOCUS_CLEARED,y.EVENT_GRID_STYLES_CHANGED,y.EVENT_FILTER_DESTROYED,y.EVENT_ROW_DATA_UPDATE_STARTED],C.PUBLIC_EVENTS=C.EVENTS.filter(e=>!dt(C.EXCLUDED_INTERNAL_EVENTS,e)),C.EVENT_CALLBACKS=C.EVENTS.map(e=>C.getCallbackForEvent(e)),C.STRING_PROPERTIES=b.STRING_PROPERTIES,C.OBJECT_PROPERTIES=b.OBJECT_PROPERTIES,C.ARRAY_PROPERTIES=b.ARRAY_PROPERTIES,C.NUMBER_PROPERTIES=b.NUMBER_PROPERTIES,C.BOOLEAN_PROPERTIES=b.BOOLEAN_PROPERTIES,C.FUNCTION_PROPERTIES=b.FUNCTION_PROPERTIES,C.ALL_PROPERTIES=b.ALL_PROPERTIES,C.ALL_PROPERTIES_SET=new Set(b.ALL_PROPERTIES),C.coercionLookup=C.getCoercionLookup();var Kt=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};function Xt(e,t,i,n){const r=i?`Please use '${i}' instead. `:"";l(()=>console.warn(`AG Grid: since v${e}, '${t}' is deprecated. ${r}${null!=n?n:""}`),"Deprecated_"+t)}const Qt=["__ob__","__v_skip","__metadata__"];let Zt=class{constructor(){this.deprecatedProperties={rememberGroupStateWhenNewData:{version:"24",message:"Now that transaction updates are possible and they keep group state, this feature is no longer needed."},serverSideFilteringAlwaysResets:{version:"28.0",newProp:"serverSideOnlyRefreshFilteredGroups",copyToNewProp:!0},serverSideSortingAlwaysResets:{version:"28.0",newProp:"serverSideSortAllLevels",copyToNewProp:!0},suppressReactUi:{version:"28",message:"The legacy React rendering engine is deprecated and will be removed in the next major version of the grid."},processSecondaryColDef:{version:"28",newProp:"processPivotResultColDef",copyToNewProp:!0},processSecondaryColGroupDef:{version:"28",newProp:"processPivotResultColGroupDef",copyToNewProp:!0},getServerSideStoreParams:{version:"28",newProp:"getServerSideGroupLevelParams",copyToNewProp:!0},serverSideInfiniteScroll:{version:"29",message:"Infinite Scrolling is now the default behaviour. This can be suppressed with `suppressServerSideInfiniteScroll`."},enableChartToolPanelsButton:{version:"29",message:"The Chart Tool Panels button is now enabled by default. To hide the Chart Tool Panels button and display the hamburger button instead, set suppressChartToolPanelsButton=true."},functionsPassive:{version:"29.2"},onColumnRowGroupChangeRequest:{version:"29.2"},onColumnPivotChangeRequest:{version:"29.2"},onColumnValueChangeRequest:{version:"29.2"},onColumnAggFuncChangeRequest:{version:"29.2"},serverSideFilterAllLevels:{version:"30",message:"All server-side group levels are now filtered by default. This can be toggled using `serverSideOnlyRefreshFilteredGroups`."},suppressAggAtRootLevel:{version:"30",message:"The root level aggregation is now suppressed by default. This can be toggled using  `alwaysAggregateAtRootLevel`."},excludeHiddenColumnsFromQuickFilter:{version:"30",message:"Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `includeHiddenColumnsInQuickFilter`."},enterMovesDown:{version:"30",newProp:"enterNavigatesVertically",copyToNewProp:!0},enterMovesDownAfterEdit:{version:"30",newProp:"enterNavigatesVerticallyAfterEdit",copyToNewProp:!0}}}pickOneWarning(e,t){console.warn(`AG Grid: ${e} and ${t} do not work with each other, you need to pick one.`)}init(){if(this.checkForDeprecated(),this.checkForViolations(),!0!==this.gridOptions.suppressPropertyNamesCheck&&(this.checkGridOptionsProperties(),this.checkColumnDefProperties()),this.checkColumnDefViolations(),this.gridOptionsService.is("groupSelectsChildren")&&this.gridOptionsService.is("suppressParentsInRowNodes")&&console.warn("AG Grid: 'groupSelectsChildren' does not work with 'suppressParentsInRowNodes', this selection method needs the part in rowNode to work"),this.gridOptionsService.is("groupSelectsChildren")&&"multiple"!==this.gridOptionsService.get("rowSelection")&&console.warn("AG Grid: rowSelection must be 'multiple' for groupSelectsChildren to make sense"),this.gridOptionsService.is("groupRemoveSingleChildren")&&this.gridOptionsService.is("groupHideOpenParents")&&this.pickOneWarning("groupRemoveSingleChildren","groupHideOpenParents"),this.gridOptionsService.isRowModelType("serverSide")){const e=(e,t)=>`AG Grid: '${e}' is not supported on the Server-Side Row Model.`+(t?` Please use ${t} instead.`:"");this.gridOptionsService.exists("groupDefaultExpanded")&&console.warn(e("groupDefaultExpanded","isServerSideGroupOpenByDefault callback")),this.gridOptionsService.exists("groupIncludeFooter")&&this.gridOptionsService.is("suppressServerSideInfiniteScroll")&&console.warn(e("groupIncludeFooter")),this.gridOptionsService.exists("groupIncludeTotalFooter")&&console.warn(e("groupIncludeTotalFooter"))}this.gridOptionsService.is("enableRangeSelection")?v.__assertRegistered(m.RangeSelectionModule,"enableRangeSelection",this.gridOptionsService.getGridId()):(this.gridOptionsService.is("enableRangeHandle")||this.gridOptionsService.is("enableFillHandle"))&&console.warn("AG Grid: 'enableRangeHandle' or 'enableFillHandle' will not work unless 'enableRangeSelection' is set to true");const e=(e,t)=>this.gridOptionsService.exists(e)&&v.__assertRegistered(t,e,this.gridOptionsService.getGridId());e("sideBar",m.SideBarModule),e("statusBar",m.StatusBarModule),e("enableCharts",m.GridChartsModule),e("getMainMenuItems",m.MenuModule),e("getContextMenuItems",m.MenuModule),e("allowContextMenuWithControlKey",m.MenuModule)}checkColumnDefProperties(){if(null==this.gridOptions.columnDefs)return;const n=jt.ALL_PROPERTIES,r=(e,t)=>{const i=Object.getOwnPropertyNames(e);this.checkProperties(i,[...n,...Qt],n,t,"https://www.ag-grid.com/javascript-data-grid/column-properties/"),e.children&&e.children.forEach(e=>r(e,"columnDefs.children"))};this.gridOptions.columnDefs.forEach(e=>r(e,"columnDefs")),this.gridOptions.defaultColDef&&r(this.gridOptions.defaultColDef,"defaultColDef")}checkColumnDefViolations(){var e;const i=null!==(e=this.gridOptionsService.get("rowModelType"))&&void 0!==e?e:"clientSide",n={infinite:["headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],viewport:["headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],serverSide:["headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],clientSide:[]}[i];if(!(null==n?void 0:n.length))return;const t=t=>{n.forEach(e=>{e in t&&t[e]&&console.warn(`AG Grid: Column property ${e} is not supported with the row model type ${i}.`)})};null!=this.gridOptions.columnDefs&&this.gridOptions.columnDefs.forEach(e=>t(e)),null!=this.gridOptions.autoGroupColumnDef&&t(this.gridOptions.autoGroupColumnDef),null!=this.gridOptions.defaultColDef&&t(this.gridOptions.defaultColDef)}checkGridOptionsProperties(){const e=Object.getOwnPropertyNames(this.gridOptions),t=[...b.ALL_PROPERTIES,...C.EVENT_CALLBACKS],i=[...t,"api","columnApi",...Qt,...Object.keys(this.deprecatedProperties)];this.checkProperties(e,i,t,"gridOptions","https://www.ag-grid.com/javascript-data-grid/grid-options/")}checkProperties(e,t,i,n,r){const s=Ut(e,t,i);a(s,(e,t)=>{l(()=>console.warn(`AG Grid: invalid ${n} property '${e}' did you mean any of these: ${t.slice(0,8).join(", ")}`),"invalidProperty"+n+e)}),Object.keys(s).length>0&&l(()=>console.warn(`AG Grid: to see all the valid ${n} properties please check: ${r}`),"invalidProperties"+n+r)}checkForDeprecated(){const r=this.gridOptions;Object.entries(this.deprecatedProperties).forEach(([e,t])=>{var i;const n=r[e];n&&(Xt(t.version,e,t.newProp,t.message),t.copyToNewProp&&t.newProp&&null==r[t.newProp]&&(r[t.newProp]=null!==(i=t.newPropValue)&&void 0!==i?i:n))}),r.serverSideStoreType&&(console.warn("AG Grid: since v29.0, `serverSideStoreType` has been replaced by `suppressServerSideInfiniteScroll`. Set to false to use Partial Store, and true to use Full Store."),r.suppressServerSideInfiniteScroll="partial"!==r.serverSideStoreType)}checkForViolations(){this.gridOptionsService.is("treeData")&&this.treeDataViolations()}treeDataViolations(){this.gridOptionsService.isRowModelType("clientSide")&&(this.gridOptionsService.exists("getDataPath")||console.warn("AG Grid: property usingTreeData=true with rowModel=clientSide, but you did not provide getDataPath function, please provide getDataPath function if using tree data.")),this.gridOptionsService.isRowModelType("serverSide")&&(this.gridOptionsService.exists("isServerSideGroup")||console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide isServerSideGroup function, please provide isServerSideGroup function if using tree data."),this.gridOptionsService.exists("getServerSideGroupKey")||console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide getServerSideGroupKey function, please provide getServerSideGroupKey function if using tree data."))}};function Jt(e,t){const i=["groupRows","multipleColumns","custom","singleColumn"];return i.indexOf(t)<0?(console.warn(`AG Grid: '${t}' is not a valid groupDisplayType value - possible values are: '${i.join("', '")}'`),!1):t===e}Kt([o("gridOptions")],Zt.prototype,"gridOptions",void 0),Kt([o("gridOptionsService")],Zt.prototype,"gridOptionsService",void 0),Kt([r],Zt.prototype,"init",null),Zt=Kt([s("gridOptionsValidator")],Zt);var ei=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},ti=function(i,n){return function(e,t){n(e,t,i)}},ii=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};let ni=class extends f{constructor(){super(...arguments),this.primaryHeaderRowCount=0,this.secondaryHeaderRowCount=0,this.gridHeaderRowCount=0,this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.displayedColumnsAndGroupsMap={},this.viewportColumns=[],this.viewportColumnsHash="",this.headerViewportColumns=[],this.viewportColumnsCenter=[],this.headerViewportColumnsCenter=[],this.autoHeightActiveAtLeastOnce=!1,this.rowGroupColumns=[],this.valueColumns=[],this.pivotColumns=[],this.ready=!1,this.autoGroupsNeedBuilding=!1,this.forceRecreateAutoGroups=!1,this.pivotMode=!1,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.bodyWidthDirty=!0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}init(){this.suppressColumnVirtualisation=this.gridOptionsService.is("suppressColumnVirtualisation");const e=this.gridOptionsService.is("pivotMode");this.isPivotSettingAllowed(e)&&(this.pivotMode=e),this.usingTreeData=this.gridOptionsService.isTreeData(),this.addManagedPropertyListener("groupDisplayType",()=>this.onAutoGroupColumnDefChanged()),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.onAutoGroupColumnDefChanged()),this.addManagedPropertyListener("defaultColDef",e=>this.onSharedColDefChanged(e.source)),this.addManagedPropertyListener("columnTypes",e=>this.onSharedColDefChanged(e.source))}onAutoGroupColumnDefChanged(){this.columnDefs&&(this.autoGroupsNeedBuilding=!0,this.forceRecreateAutoGroups=!0,this.updateGridColumns(),this.updateDisplayedColumns("gridOptionsChanged"))}onSharedColDefChanged(e="api"){this.forceRecreateAutoGroups=!0,this.createColumnsFromColumnDefs(!0,e)}setColumnDefs(e,t="api"){const i=!!this.columnDefs;this.columnDefs=e,this.createColumnsFromColumnDefs(i,t)}recreateColumnDefs(e="api"){this.onSharedColDefChanged(e)}destroyOldColumns(e,t){const i={};if(!e)return;this.columnUtils.depthFirstOriginalTreeSearch(null,e,e=>{i[e.getInstanceId()]=e}),t&&this.columnUtils.depthFirstOriginalTreeSearch(null,t,e=>{i[e.getInstanceId()]=null});const n=Object.values(i).filter(e=>null!=e);this.destroyBeans(n)}destroyColumns(){this.destroyOldColumns(this.primaryColumnTree),this.destroyOldColumns(this.secondaryBalancedTree),this.destroyOldColumns(this.groupAutoColsBalancedTree)}createColumnsFromColumnDefs(e,t="api"){const i=e?this.compareColumnStatesAndDispatchEvents(t):void 0;this.valueCache.expire(),this.autoGroupsNeedBuilding=!0;const n=this.primaryColumns,r=this.primaryColumnTree,s=this.columnFactory.createColumnTree(this.columnDefs,!0,r);this.destroyOldColumns(this.primaryColumnTree,s.columnTree),this.primaryColumnTree=s.columnTree,this.primaryHeaderRowCount=s.treeDept+1,this.primaryColumns=this.getColumnsFromTree(this.primaryColumnTree),this.primaryColumnsMap={},this.primaryColumns.forEach(e=>this.primaryColumnsMap[e.getId()]=e),this.extractRowGroupColumns(t,n),this.extractPivotColumns(t,n),this.extractValueColumns(t,n),this.ready=!0;const o=void 0===this.gridColsArePrimary;(this.gridColsArePrimary||o)&&(this.updateGridColumns(),e&&!this.gridOptionsService.is("maintainColumnOrder")&&this.orderGridColumnsLikePrimary(),this.updateDisplayedColumns(t),this.checkViewportColumns()),this.dispatchEverythingChanged(t),i&&i(),this.dispatchNewColumnsLoaded()}dispatchNewColumnsLoaded(){const e={type:y.EVENT_NEW_COLUMNS_LOADED};this.eventService.dispatchEvent(e)}dispatchEverythingChanged(e="api"){const t={type:y.EVENT_COLUMN_EVERYTHING_CHANGED,source:e};this.eventService.dispatchEvent(t)}orderGridColumnsLikePrimary(){const o=this.primaryColumns;o&&(this.gridColumns.sort((e,t)=>{const i=o.indexOf(e),n=o.indexOf(t),r=i>=0,s=n>=0;if(r&&s)return i-n;if(r)return 1;if(s)return-1;return this.gridColumns.indexOf(e)-this.gridColumns.indexOf(t)}),this.gridColumns=this.placeLockedColumns(this.gridColumns))}getAllDisplayedAutoHeightCols(){return this.displayedAutoHeightCols}setViewport(){this.gridOptionsService.is("enableRtl")?(this.viewportLeft=this.bodyWidth-this.scrollPosition-this.scrollWidth,this.viewportRight=this.bodyWidth-this.scrollPosition):(this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition)}getDisplayedColumnsStartingAt(e){let t=e;const i=[];for(;null!=t;)i.push(t),t=this.getDisplayedColAfter(t);return i}checkViewportColumns(){if(null==this.displayedColumnsCenter)return;if(!this.extractViewport())return;const e={type:y.EVENT_VIRTUAL_COLUMNS_CHANGED};this.eventService.dispatchEvent(e)}setViewportPosition(e,t){(e!==this.scrollWidth||t!==this.scrollPosition||this.bodyWidthDirty)&&(this.scrollWidth=e,this.scrollPosition=t,this.bodyWidthDirty=!0,this.setViewport(),this.ready&&this.checkViewportColumns())}isPivotMode(){return this.pivotMode}isPivotSettingAllowed(e){return!e||!this.gridOptionsService.isTreeData()||(console.warn("AG Grid: Pivot mode not available in conjunction Tree Data i.e. 'gridOptions.treeData: true'"),!1)}setPivotMode(e,t="api"){if(e===this.pivotMode||!this.isPivotSettingAllowed(this.pivotMode))return;this.pivotMode=e,this.autoGroupsNeedBuilding=!0,this.updateGridColumns(),this.updateDisplayedColumns(t);const i={type:y.EVENT_COLUMN_PIVOT_MODE_CHANGED};this.eventService.dispatchEvent(i)}getSecondaryPivotColumn(n,e){if(u(this.secondaryColumns))return null;const r=this.getPrimaryColumn(e);let s=null;return this.secondaryColumns.forEach(e=>{const t=e.getColDef().pivotKeys,i=e.getColDef().pivotValueColumn;it(t,n)&&i===r&&(s=e)}),s}setBeans(e){this.logger=e.create("columnModel")}setFirstRightAndLastLeftPinned(t){let i,n;this.gridOptionsService.is("enableRtl")?(i=this.displayedColumnsLeft?this.displayedColumnsLeft[0]:null,n=this.displayedColumnsRight?p(this.displayedColumnsRight):null):(i=this.displayedColumnsLeft?p(this.displayedColumnsLeft):null,n=this.displayedColumnsRight?this.displayedColumnsRight[0]:null),this.gridColumns.forEach(e=>{e.setLastLeftPinned(e===i,t),e.setFirstRightPinned(e===n,t)})}autoSizeColumns(e){if(this.shouldQueueResizeOperations)return void this.resizeOperationQueue.push(()=>this.autoSizeColumns(e));const{columns:t,skipHeader:i,skipHeaderGroups:n,stopAtGroup:r,source:s="api"}=e;this.animationFrameService.flushAllFrames();const o=[];let a=-1;const l=null!=i?i:this.gridOptionsService.is("skipHeaderOnAutoSize"),c=null!=n?n:l;for(;0!==a;)a=0,this.actionOnGridColumns(t,t=>{if(o.indexOf(t)>=0)return!1;const i=this.autoWidthCalculator.getPreferredWidthForColumn(t,l);if(i>0){const e=this.normaliseColumnWidth(t,i);t.setActualWidth(e,s),o.push(t),a++}return!0},s);c||this.autoSizeColumnGroupsByColumns(t,s,r),this.dispatchColumnResizedEvent(o,!0,"autosizeColumns")}dispatchColumnResizedEvent(t,i,n,r=null){if(t&&t.length){const e={type:y.EVENT_COLUMN_RESIZED,columns:t,column:1===t.length?t[0]:null,flexColumns:r,finished:i,source:n};this.eventService.dispatchEvent(e)}}dispatchColumnChangedEvent(e,t,i){const n={type:e,columns:t,column:t&&1==t.length?t[0]:null,source:i};this.eventService.dispatchEvent(n)}dispatchColumnMovedEvent(e){const{movedColumns:t,source:i,toIndex:n,finished:r}=e,s={type:y.EVENT_COLUMN_MOVED,columns:t,column:t&&1===t.length?t[0]:null,toIndex:n,finished:r,source:i};this.eventService.dispatchEvent(s)}dispatchColumnPinnedEvent(e,t){if(!e.length)return;const i=1===e.length?e[0]:null,n=this.getCommonValue(e,e=>e.getPinned()),r={type:y.EVENT_COLUMN_PINNED,pinned:null!=n?n:null,columns:e,column:i,source:t};this.eventService.dispatchEvent(r)}dispatchColumnVisibleEvent(e,t){if(!e.length)return;const i=1===e.length?e[0]:null,n=this.getCommonValue(e,e=>e.isVisible()),r={type:y.EVENT_COLUMN_VISIBLE,visible:n,columns:e,column:i,source:t};this.eventService.dispatchEvent(r)}autoSizeColumn(e,t,i="api"){e&&this.autoSizeColumns({columns:[e],skipHeader:t,skipHeaderGroups:!0,source:i})}autoSizeColumnGroupsByColumns(e,t,i){const n=new Set;let r;this.getGridColumns(e).forEach(e=>{let t=e.getParent();for(;t&&t!=i;)t.isPadding()||n.add(t),t=t.getParent()});for(const e of n){for(const t of this.ctrlsService.getHeaderRowContainerCtrls())if(r=t.getHeaderCtrlForColumn(e),r)break;r&&r.resizeLeafColumnsToFit(t)}return[]}autoSizeAllColumns(e,t="api"){if(this.shouldQueueResizeOperations)return void this.resizeOperationQueue.push(()=>this.autoSizeAllColumns(e,t));const i=this.getAllDisplayedColumns();this.autoSizeColumns({columns:i,skipHeader:e,source:t})}getColumnsFromTree(e){const n=[],r=i=>{for(let t=0;t<i.length;t++){const e=i[t];e instanceof d?n.push(e):e instanceof h&&r(e.getChildren())}};return r(e),n}getAllDisplayedTrees(){return this.displayedTreeLeft&&this.displayedTreeRight&&this.displayedTreeCentre?this.displayedTreeLeft.concat(this.displayedTreeCentre).concat(this.displayedTreeRight):null}getPrimaryColumnTree(){return this.primaryColumnTree}getHeaderRowCount(){return this.gridHeaderRowCount}getDisplayedTreeLeft(){return this.displayedTreeLeft}getDisplayedTreeRight(){return this.displayedTreeRight}getDisplayedTreeCentre(){return this.displayedTreeCentre}isColumnDisplayed(e){return this.getAllDisplayedColumns().indexOf(e)>=0}getAllDisplayedColumns(){return this.displayedColumns}getViewportColumns(){return this.viewportColumns}getDisplayedLeftColumnsForRow(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedColumnsLeft):this.displayedColumnsLeft}getDisplayedRightColumnsForRow(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedColumnsRight):this.displayedColumnsRight}isColSpanActive(){return this.colSpanActive}getDisplayedColumnsForRow(o,a,l,c){const u=[];let d=null;for(let s=0;s<a.length;s++){const e=a[s],t=a.length-s,i=Math.min(e.getColSpan(o),t),n=[e];if(i>1){const o=i-1;for(let e=1;e<=o;e++)n.push(a[s+e]);s+=o}let r;if(l?(r=!1,n.forEach(e=>{l(e)&&(r=!0)})):r=!0,r){if(0===u.length&&d){!!c&&c(e)&&u.push(d)}u.push(e)}d=e}return u}getViewportCenterColumnsForRow(e){if(!this.colSpanActive)return this.viewportColumnsCenter;const t=this.suppressColumnVirtualisation?null:this.isColumnInRowViewport.bind(this);return this.getDisplayedColumnsForRow(e,this.displayedColumnsCenter,t,e=>{const t=e.getLeft();return _(t)&&t>this.viewportLeft})}getAriaColumnIndex(e){return this.getAllGridColumns().indexOf(e)+1}isColumnInHeaderViewport(e){return!!e.isAutoHeaderHeight()||this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,i=t+e.getActualWidth(),n=this.viewportLeft-200,r=this.viewportRight+200;return!(t<n&&i<n)&&!(t>r&&i>r)}getDisplayedColumnsLeftWidth(){return this.getWidthOfColsInList(this.displayedColumnsLeft)}getDisplayedColumnsRightWidth(){return this.getWidthOfColsInList(this.displayedColumnsRight)}updatePrimaryColumnList(e,i,n,r,t,s="api"){if(!e||ee(e))return;let o=!1;if(e.forEach(e=>{const t=this.getPrimaryColumn(e);if(t){if(n){if(i.indexOf(t)>=0)return;i.push(t)}else{if(i.indexOf(t)<0)return;ot(i,t)}r(t),o=!0}}),!o)return;this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(s);const a={type:t,columns:i,column:1===i.length?i[0]:null,source:s};this.eventService.dispatchEvent(a)}setRowGroupColumns(e,t="api"){this.autoGroupsNeedBuilding=!0,this.setPrimaryColumnList(e,this.rowGroupColumns,y.EVENT_COLUMN_ROW_GROUP_CHANGED,this.setRowGroupActive.bind(this),t)}setRowGroupActive(e,t,i){e!==t.isRowGroupActive()&&(t.setRowGroupActive(e,i),e&&!this.gridOptionsService.is("suppressRowGroupHidesColumns")&&this.setColumnVisible(t,!1,i),e||this.gridOptionsService.is("suppressMakeColumnVisibleAfterUnGroup")||this.setColumnVisible(t,!0,i))}addRowGroupColumn(e,t="api"){e&&this.addRowGroupColumns([e],t)}addRowGroupColumns(e,t="api"){this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!0,this.setRowGroupActive.bind(this,!0),y.EVENT_COLUMN_ROW_GROUP_CHANGED,t)}removeRowGroupColumns(e,t="api"){this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!1,this.setRowGroupActive.bind(this,!1),y.EVENT_COLUMN_ROW_GROUP_CHANGED,t)}removeRowGroupColumn(e,t="api"){e&&this.removeRowGroupColumns([e],t)}addPivotColumns(e,t="api"){this.updatePrimaryColumnList(e,this.pivotColumns,!0,e=>e.setPivotActive(!0,t),y.EVENT_COLUMN_PIVOT_CHANGED,t)}setPivotColumns(e,i="api"){this.setPrimaryColumnList(e,this.pivotColumns,y.EVENT_COLUMN_PIVOT_CHANGED,(e,t)=>{t.setPivotActive(e,i)},i)}addPivotColumn(e,t="api"){this.addPivotColumns([e],t)}removePivotColumns(e,t="api"){this.updatePrimaryColumnList(e,this.pivotColumns,!1,e=>e.setPivotActive(!1,t),y.EVENT_COLUMN_PIVOT_CHANGED,t)}removePivotColumn(e,t="api"){this.removePivotColumns([e],t)}setPrimaryColumnList(e,i,t,n,r){i.length=0,_(e)&&e.forEach(e=>{const t=this.getPrimaryColumn(e);t&&i.push(t)}),(this.primaryColumns||[]).forEach(e=>{const t=i.indexOf(e)>=0;n(t,e)}),this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(r),this.dispatchColumnChangedEvent(t,i,r)}setValueColumns(e,t="api"){this.setPrimaryColumnList(e,this.valueColumns,y.EVENT_COLUMN_VALUE_CHANGED,this.setValueActive.bind(this),t)}setValueActive(e,t,i){if(e!==t.isValueActive()&&(t.setValueActive(e,i),e&&!t.getAggFunc())){const e=this.aggFuncService.getDefaultAggFunc(t);t.setAggFunc(e)}}addValueColumns(e,t="api"){this.updatePrimaryColumnList(e,this.valueColumns,!0,this.setValueActive.bind(this,!0),y.EVENT_COLUMN_VALUE_CHANGED,t)}addValueColumn(e,t="api"){e&&this.addValueColumns([e],t)}removeValueColumn(e,t="api"){this.removeValueColumns([e],t)}removeValueColumns(e,t="api"){this.updatePrimaryColumnList(e,this.valueColumns,!1,this.setValueActive.bind(this,!1),y.EVENT_COLUMN_VALUE_CHANGED,t)}normaliseColumnWidth(e,t){const i=e.getMinWidth();_(i)&&t<i&&(t=i);const n=e.getMaxWidth();return _(n)&&e.isGreaterThanMax(t)&&(t=n),t}getPrimaryOrGridColumn(e){return this.getPrimaryColumn(e)||this.getGridColumn(e)}setColumnWidths(e,r,t,i="api"){const s=[];e.forEach(i=>{const n=this.getPrimaryOrGridColumn(i.key);if(!n)return;s.push({width:i.newWidth,ratios:[1],columns:[n]});if("shift"===this.gridOptionsService.get("colResizeDefault")&&(r=!r),r){const r=this.getDisplayedColAfter(n);if(!r)return;const e=n.getActualWidth()-i.newWidth,t=r.getActualWidth()+e;s.push({width:t,ratios:[1],columns:[r]})}}),0!==s.length&&this.resizeColumnSets({resizeSets:s,finished:t,source:i})}checkMinAndMaxWidthsForSet(e){const{columns:t,width:i}=e;let n=0,r=0,s=!0;t.forEach(e=>{const t=e.getMinWidth();n+=t||0;const i=e.getMaxWidth();_(i)&&i>0?r+=i:s=!1});return i>=n&&(!s||i<=r)}resizeColumnSets(e){const{resizeSets:t,finished:i,source:n}=e;if(!(!t||t.every(e=>this.checkMinAndMaxWidthsForSet(e)))){if(i){const e=t&&t.length>0?t[0].columns:null;this.dispatchColumnResizedEvent(e,i,n)}return}const r=[],h=[];t.forEach(o=>{const{width:a,columns:e,ratios:l}=o,c={},u={};e.forEach(e=>h.push(e));let d=!0,t=0;for(;d;){if(t++,t>1e3){console.error("AG Grid: infinite loop in resizeColumnSets");break}d=!1;const o=[];let i=0,s=a;e.forEach((e,t)=>{if(u[e.getId()])s-=c[e.getId()];else{o.push(e);const s=l[t];i+=s}});const h=1/i;o.forEach((e,t)=>{let i;t===o.length-1?i=s:(i=Math.round(l[t]*a*h),s-=i);const n=e.getMinWidth(),r=e.getMaxWidth();_(n)&&i<n?(i=n,u[e.getId()]=!0,d=!0):_(r)&&r>0&&i>r&&(i=r,u[e.getId()]=!0,d=!0),c[e.getId()]=i})}e.forEach(e=>{const t=c[e.getId()];e.getActualWidth()!==t&&(e.setActualWidth(t,n),r.push(e))})});const s=r.length>0;let o=[];s&&(o=this.refreshFlexedColumns({resizingCols:h,skipSetLeft:!0}),this.setLeftValues(n),this.updateBodyWidths(),this.checkViewportColumns());const a=h.concat(o);(s||i)&&this.dispatchColumnResizedEvent(a,i,n,o)}setColumnAggFunc(e,t,i="api"){if(!e)return;const n=this.getPrimaryColumn(e);n&&(n.setAggFunc(t),this.dispatchColumnChangedEvent(y.EVENT_COLUMN_VALUE_CHANGED,[n],i))}moveRowGroupColumn(e,t,i="api"){const n=this.rowGroupColumns[e];this.rowGroupColumns.splice(e,1),this.rowGroupColumns.splice(t,0,n);const r={type:y.EVENT_COLUMN_ROW_GROUP_CHANGED,columns:this.rowGroupColumns,column:1===this.rowGroupColumns.length?this.rowGroupColumns[0]:null,source:i};this.eventService.dispatchEvent(r)}moveColumns(e,t,i="api",n=!0){if(this.columnAnimationService.start(),t>this.gridColumns.length-e.length)return console.warn("AG Grid: tried to insert columns in invalid location, toIndex = "+t),void console.warn("AG Grid: remember that you should not count the moving columns when calculating the new index");const r=this.getGridColumns(e);!this.doesMovePassRules(r,t)||(ut(this.gridColumns,r,t),this.updateDisplayedColumns(i),this.dispatchColumnMovedEvent({movedColumns:r,source:i,toIndex:t,finished:n}),this.columnAnimationService.finish())}doesMovePassRules(e,t){const i=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(i)}doesOrderPassRules(e){return!!this.doesMovePassMarryChildren(e)&&!!this.doesMovePassLockedPositions(e)}getProposedColumnOrder(e,t){const i=this.gridColumns.slice();return ut(i,e,t),i}sortColumnsLikeGridColumns(e){if(!e||e.length<=1)return;e.filter(e=>this.gridColumns.indexOf(e)<0).length>0||e.sort((e,t)=>this.gridColumns.indexOf(e)-this.gridColumns.indexOf(t))}doesMovePassLockedPositions(e){let n=0,r=!0;return e.forEach(e=>{const t=(i=e.getColDef().lockPosition)?!0===i||"left"===i?0:2:1;var i;t<n&&(r=!1),n=t}),r}doesMovePassMarryChildren(r){let s=!0;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,e=>{if(!(e instanceof h))return;const t=e,i=t.getColGroupDef();if(!(i&&i.marryChildren))return;const n=[];t.getLeafColumns().forEach(e=>{const t=r.indexOf(e);n.push(t)});Math.max.apply(Math,n)-Math.min.apply(Math,n)>t.getLeafColumns().length-1&&(s=!1)}),s}moveColumn(e,t,i="api"){this.moveColumns([e],t,i)}moveColumnByIndex(e,t,i="api"){const n=this.gridColumns[e];this.moveColumn(n,t,i)}getColumnDefs(){if(!this.primaryColumns)return;const e=this.primaryColumns.slice();return this.gridColsArePrimary?e.sort((e,t)=>this.gridColumns.indexOf(e)-this.gridColumns.indexOf(t)):this.lastPrimaryOrder&&e.sort((e,t)=>this.lastPrimaryOrder.indexOf(e)-this.lastPrimaryOrder.indexOf(t)),this.columnDefFactory.buildColumnDefs(e,this.rowGroupColumns,this.pivotColumns)}getBodyContainerWidth(){return this.bodyWidth}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}updateBodyWidths(){const t=this.getWidthOfColsInList(this.displayedColumnsCenter),i=this.getWidthOfColsInList(this.displayedColumnsLeft),n=this.getWidthOfColsInList(this.displayedColumnsRight);this.bodyWidthDirty=this.bodyWidth!==t;if(this.bodyWidth!==t||this.leftWidth!==i||this.rightWidth!==n){this.bodyWidth=t,this.leftWidth=i,this.rightWidth=n;const e={type:y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED};this.eventService.dispatchEvent(e)}}getValueColumns(){return this.valueColumns?this.valueColumns:[]}getPivotColumns(){return this.pivotColumns?this.pivotColumns:[]}isPivotActive(){return this.pivotColumns&&this.pivotColumns.length>0&&this.pivotMode}getRowGroupColumns(){return this.rowGroupColumns?this.rowGroupColumns:[]}getDisplayedCenterColumns(){return this.displayedColumnsCenter}getDisplayedLeftColumns(){return this.displayedColumnsLeft}getDisplayedRightColumns(){return this.displayedColumnsRight}getDisplayedColumns(e){switch(e){case"left":return this.getDisplayedLeftColumns();case"right":return this.getDisplayedRightColumns();default:return this.getDisplayedCenterColumns()}}getAllPrimaryColumns(){return this.primaryColumns?this.primaryColumns.slice():null}getSecondaryColumns(){return this.secondaryColumns?this.secondaryColumns.slice():null}getAllColumnsForQuickFilter(){return this.columnsForQuickFilter}getAllGridColumns(){return this.gridColumns}isEmpty(){return ee(this.gridColumns)}isRowGroupEmpty(){return ee(this.rowGroupColumns)}setColumnVisible(e,t,i="api"){this.setColumnsVisible([e],t,i)}setColumnsVisible(e,t=!1,i="api"){this.applyColumnState({state:e.map(e=>({colId:"string"==typeof e?e:e.getColId(),hide:!t}))},i)}setColumnPinned(e,t,i="api"){e&&this.setColumnsPinned([e],t,i)}setColumnsPinned(e,t,i="api"){if(this.gridOptionsService.isDomLayout("print"))return void console.warn("AG Grid: Changing the column pinning status is not allowed with domLayout='print'");let n;this.columnAnimationService.start(),n=!0===t||"left"===t?"left":"right"===t?"right":null,this.actionOnGridColumns(e,e=>e.getPinned()!==n&&(e.setPinned(n),!0),i,()=>({type:y.EVENT_COLUMN_PINNED,pinned:n,column:null,columns:null,source:i})),this.columnAnimationService.finish()}actionOnGridColumns(e,i,t,n){if(ee(e))return;const r=[];if(e.forEach(e=>{const t=this.getGridColumn(e);if(!t)return;!1!==i(t)&&r.push(t)}),r.length&&(this.updateDisplayedColumns(t),_(n)&&n)){const e=n();e.columns=r,e.column=1===r.length?r[0]:null,this.eventService.dispatchEvent(e)}}getDisplayedColBefore(e){const t=this.getAllDisplayedColumns(),i=t.indexOf(e);return i>0?t[i-1]:null}getDisplayedColAfter(e){const t=this.getAllDisplayedColumns(),i=t.indexOf(e);return i<t.length-1?t[i+1]:null}getDisplayedGroupAfter(e){return this.getDisplayedGroupAtDirection(e,"After")}getDisplayedGroupBefore(e){return this.getDisplayedGroupAtDirection(e,"Before")}getDisplayedGroupAtDirection(e,t){const i=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),n=e.getDisplayedLeafColumns(),r="After"===t?p(n):n[0],s="getDisplayedCol"+t;for(;;){const t=this[s](r);if(!t)return null;const n=this.getColumnGroupAtLevel(t,i);if(n!==e)return n}}getColumnGroupAtLevel(e,t){let i,n,r=e.getParent();for(;;){if(i=r.getProvidedColumnGroup().getLevel(),n=r.getPaddingLevel(),i+n<=t)break;r=r.getParent()}return r}isPinningLeft(){return this.displayedColumnsLeft.length>0}isPinningRight(){return this.displayedColumnsRight.length>0}getPrimaryAndSecondaryAndAutoColumns(){return[].concat(this.primaryColumns||[],this.groupAutoColumns||[],this.secondaryColumns||[])}createStateItemFromColumn(e){const t=e.isRowGroupActive()?this.rowGroupColumns.indexOf(e):null,i=e.isPivotActive()?this.pivotColumns.indexOf(e):null,n=e.isValueActive()?e.getAggFunc():null,r=null!=e.getSort()?e.getSort():null,s=null!=e.getSortIndex()?e.getSortIndex():null,o=null!=e.getFlex()&&e.getFlex()>0?e.getFlex():null;return{colId:e.getColId(),width:e.getActualWidth(),hide:!e.isVisible(),pinned:e.getPinned(),sort:r,sortIndex:s,aggFunc:n,rowGroup:e.isRowGroupActive(),rowGroupIndex:t,pivot:e.isPivotActive(),pivotIndex:i,flex:o}}getColumnState(){if(u(this.primaryColumns)||!this.isAlive())return[];const e=this.getPrimaryAndSecondaryAndAutoColumns().map(this.createStateItemFromColumn.bind(this));return this.orderColumnStateList(e),e}orderColumnStateList(e){const i=Vt(this.gridColumns.map((e,t)=>[e.getColId(),t]));e.sort((e,t)=>(i.has(e.colId)?i.get(e.colId):-1)-(i.has(t.colId)?i.get(t.colId):-1))}resetColumnState(e="api"){const t=this.getColumnsFromTree(this.primaryColumnTree),i=[];let n=1e3,r=1e3,s=[];this.groupAutoColumns&&(s=s.concat(this.groupAutoColumns)),t&&(s=s.concat(t)),s.forEach(e=>{const t=this.getColumnStateFromColDef(e);u(t.rowGroupIndex)&&t.rowGroup&&(t.rowGroupIndex=n++),u(t.pivotIndex)&&t.pivot&&(t.pivotIndex=r++),i.push(t)}),this.applyColumnState({state:i,applyOrder:!0},e)}getColumnStateFromColDef(e){const t=(e,t)=>null!=e?e:null!=t?t:null,i=e.getColDef(),n=t(i.sort,i.initialSort),r=t(i.sortIndex,i.initialSortIndex),s=t(i.hide,i.initialHide),o=t(i.pinned,i.initialPinned),a=t(i.width,i.initialWidth),l=t(i.flex,i.initialFlex);let c=t(i.rowGroupIndex,i.initialRowGroupIndex),u=t(i.rowGroup,i.initialRowGroup);null!=c||null!=u&&0!=u||(c=null,u=null);let d=t(i.pivotIndex,i.initialPivotIndex),h=t(i.pivot,i.initialPivot);null!=d||null!=h&&0!=h||(d=null,h=null);const p=t(i.aggFunc,i.initialAggFunc);return{colId:e.getColId(),sort:n,sortIndex:r,hide:s,pinned:o,width:a,flex:l,rowGroup:u,rowGroupIndex:c,pivot:h,pivotIndex:d,aggFunc:p}}applyColumnState(g,m){if(ee(this.primaryColumns))return!1;if(g&&g.state&&!g.state.forEach)return console.warn("AG Grid: applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;const e=(e,t,n)=>{const i=this.compareColumnStatesAndDispatchEvents(m);this.autoGroupsNeedBuilding=!0;const r=t.slice(),s={},o={},a=[],l=[];let c=0;const u=this.rowGroupColumns.slice(),d=this.pivotColumns.slice();e.forEach(e=>{const t=e.colId||"";if(t.startsWith(It))return a.push(e),void l.push(e);const i=n(t);i?(this.syncColumnWithStateItem(i,e,g.defaultState,s,o,!1,m),ot(r,i)):(l.push(e),c+=1)});const h=e=>this.syncColumnWithStateItem(e,null,g.defaultState,s,o,!1,m);r.forEach(h);const p=(e,t,i,n)=>{const r=e[i.getId()],s=e[n.getId()],o=null!=r,a=null!=s;if(o&&a)return r-s;if(o)return-1;if(a)return 1;const l=t.indexOf(i),c=t.indexOf(n),u=l>=0;return u&&c>=0?l-c:u?-1:1};this.rowGroupColumns.sort(p.bind(this,s,u)),this.pivotColumns.sort(p.bind(this,o,d)),this.updateGridColumns();const f=this.groupAutoColumns?this.groupAutoColumns.slice():[];return a.forEach(e=>{const t=this.getAutoColumn(e.colId);ot(f,t),this.syncColumnWithStateItem(t,e,g.defaultState,null,null,!0,m)}),f.forEach(h),this.applyOrderAfterApplyState(g),this.updateDisplayedColumns(m),this.dispatchEverythingChanged(m),i(),{unmatchedAndAutoStates:l,unmatchedCount:c}};this.columnAnimationService.start();let{unmatchedAndAutoStates:t,unmatchedCount:i}=e(g.state||[],this.primaryColumns||[],e=>this.getPrimaryColumn(e));return(t.length>0||_(g.defaultState))&&(i=e(t,this.secondaryColumns||[],e=>this.getSecondaryColumn(e)).unmatchedCount),this.columnAnimationService.finish(),0===i}applyOrderAfterApplyState(e){if(!e.applyOrder||!e.state)return;let i=[];const n={};e.state.forEach(e=>{if(!e.colId||n[e.colId])return;const t=this.gridColumnsMap[e.colId];t&&(i.push(t),n[e.colId]=!0)});let r=0;this.gridColumns.forEach(e=>{const t=e.getColId();if(null!=n[t])return;t.startsWith(It)?lt(i,e,r++):i.push(e)}),i=this.placeLockedColumns(i),this.doesMovePassMarryChildren(i)?this.gridColumns=i:console.warn("AG Grid: Applying column order broke a group where columns should be married together. Applying new order has been discarded.")}compareColumnStatesAndDispatchEvents(s){const r={rowGroupColumns:this.rowGroupColumns.slice(),pivotColumns:this.pivotColumns.slice(),valueColumns:this.valueColumns.slice()},o=this.getColumnState(),a={};return o.forEach(e=>{a[e.colId]=e}),()=>{const e=this.getPrimaryAndSecondaryAndAutoColumns(),t=(e,t,i,n)=>{if(it(t.map(n),i.map(n)))return;const r={type:e,columns:i,column:1===i.length?i[0]:null,source:s};this.eventService.dispatchEvent(r)},i=i=>{const n=[];return e.forEach(e=>{const t=a[e.getColId()];t&&i(t,e)&&n.push(e)}),n},n=e=>e.getColId();t(y.EVENT_COLUMN_ROW_GROUP_CHANGED,r.rowGroupColumns,this.rowGroupColumns,n),t(y.EVENT_COLUMN_PIVOT_CHANGED,r.pivotColumns,this.pivotColumns,n);i((e,t)=>{const i=null!=e.aggFunc,n=i!=t.isValueActive(),r=i&&e.aggFunc!=t.getAggFunc();return n||r}).length>0&&this.dispatchColumnChangedEvent(y.EVENT_COLUMN_VALUE_CHANGED,this.valueColumns,s);this.dispatchColumnResizedEvent(i((e,t)=>e.width!=t.getActualWidth()),!0,s);this.dispatchColumnPinnedEvent(i((e,t)=>e.pinned!=t.getPinned()),s);this.dispatchColumnVisibleEvent(i((e,t)=>e.hide==t.isVisible()),s);i((e,t)=>e.sort!=t.getSort()||e.sortIndex!=t.getSortIndex()).length>0&&this.sortController.dispatchSortChangedEvents(s),this.normaliseColumnMovedEventForColumnState(o,s)}}getCommonValue(t,i){if(!t||0==t.length)return;const n=i(t[0]);for(let e=1;e<t.length;e++)if(n!==i(t[e]))return;return n}normaliseColumnMovedEventForColumnState(e,t){const i=this.getColumnState(),n={};i.forEach(e=>n[e.colId]=e);const r={};e.forEach(e=>{n[e.colId]&&(r[e.colId]=!0)});const s=e.filter(e=>r[e.colId]),o=i.filter(e=>r[e.colId]),a=[];o.forEach((e,t)=>{const i=s&&s[t];if(i&&i.colId!==e.colId){const e=this.getGridColumn(i.colId);e&&a.push(e)}}),a.length&&this.dispatchColumnMovedEvent({movedColumns:a,source:t,finished:!0})}syncColumnWithStateItem(e,r,s,t,i,n,o){if(!e)return;const a=(e,t)=>{const i={value1:void 0,value2:void 0};let n=!1;return r&&(void 0!==r[e]&&(i.value1=r[e],n=!0),_(t)&&void 0!==r[t]&&(i.value2=r[t],n=!0)),!n&&s&&(void 0!==s[e]&&(i.value1=s[e]),_(t)&&void 0!==s[t]&&(i.value2=s[t])),i},l=a("hide").value1;void 0!==l&&e.setVisible(!l,o);const c=a("pinned").value1;void 0!==c&&e.setPinned(c);const u=this.columnUtils.calculateColMinWidth(e.getColDef()),d=a("flex").value1;void 0!==d&&e.setFlex(d);if(e.getFlex()<=0){const r=a("width").value1;null!=r&&null!=u&&r>=u&&e.setActualWidth(r,o)}const h=a("sort").value1;void 0!==h&&("desc"===h||"asc"===h?e.setSort(h,o):e.setSort(void 0,o));const p=a("sortIndex").value1;if(void 0!==p&&e.setSortIndex(p),n||!e.isPrimary())return;const f=a("aggFunc").value1;void 0!==f&&("string"==typeof f?(e.setAggFunc(f),e.isValueActive()||(e.setValueActive(!0,o),this.valueColumns.push(e))):(_(f)&&console.warn("AG Grid: stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),e.isValueActive()&&(e.setValueActive(!1,o),ot(this.valueColumns,e))));const{value1:g,value2:m}=a("rowGroup","rowGroupIndex");void 0===g&&void 0===m||("number"==typeof m||g?(e.isRowGroupActive()||(e.setRowGroupActive(!0,o),this.rowGroupColumns.push(e)),t&&"number"==typeof m&&(t[e.getId()]=m)):e.isRowGroupActive()&&(e.setRowGroupActive(!1,o),ot(this.rowGroupColumns,e)));const{value1:v,value2:y}=a("pivot","pivotIndex");void 0===v&&void 0===y||("number"==typeof y||v?(e.isPivotActive()||(e.setPivotActive(!0,o),this.pivotColumns.push(e)),i&&"number"==typeof y&&(i[e.getId()]=y)):e.isPivotActive()&&(e.setPivotActive(!1,o),ot(this.pivotColumns,e)))}getGridColumns(e){return this.getColumns(e,this.getGridColumn.bind(this))}getColumns(e,i){const n=[];return e&&e.forEach(e=>{const t=i(e);t&&n.push(t)}),n}getColumnWithValidation(e){if(null==e)return null;const t=this.getGridColumn(e);return t||console.warn("AG Grid: could not find column "+e),t}getPrimaryColumn(e){return this.primaryColumns?this.getColumn(e,this.primaryColumns,this.primaryColumnsMap):null}getGridColumn(e){return this.getColumn(e,this.gridColumns,this.gridColumnsMap)}getSecondaryColumn(e){return this.secondaryColumns?this.getColumn(e,this.secondaryColumns,this.secondaryColumnsMap):null}getColumn(t,i,e){if(!t)return null;if("string"==typeof t&&e[t])return e[t];for(let e=0;e<i.length;e++)if(this.columnsMatch(i[e],t))return i[e];return this.getAutoColumn(t)}getSourceColumnsForGroupColumn(e){const t=e.getColDef().showRowGroup;if(!t)return null;if(!0===t)return this.rowGroupColumns.slice(0);const i=this.getPrimaryColumn(t);return i?[i]:null}getAutoColumn(t){return this.groupAutoColumns&&_(this.groupAutoColumns)&&!u(this.groupAutoColumns)&&this.groupAutoColumns.find(e=>this.columnsMatch(e,t))||null}columnsMatch(e,t){const i=e===t,n=e.getColDef()===t,r=e.getColId()==t;return i||n||r}getDisplayNameForColumn(e,t,i=!1){if(!e)return null;const n=this.getHeaderName(e.getColDef(),e,null,null,t);return i?this.wrapHeaderNameWithAggFunc(e,n):n}getDisplayNameForProvidedColumnGroup(e,t,i){const n=t?t.getColGroupDef():null;return n?this.getHeaderName(n,null,e,t,i):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(t,i,n,r,s){const o=t.headerValueGetter;if(o){const e={colDef:t,column:i,columnGroup:n,providedColumnGroup:r,location:s,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};return"function"==typeof o?o(e):"string"==typeof o?this.expressionService.evaluate(o,e):(console.warn("AG Grid: headerValueGetter must be a function or a string"),"")}return null!=t.headerName?t.headerName:t.field?Ht(t.field):""}wrapHeaderNameWithAggFunc(i,n){if(this.gridOptionsService.is("suppressAggFuncInHeader"))return n;const r=i.getColDef().pivotValueColumn;let s,o=null;if(_(r)){const e=this.gridOptionsService.is("removePivotHeaderRowWhenSingleValueColumn")&&1===this.valueColumns.length,t=void 0!==i.getColDef().pivotTotalColumnIds;if(e&&!t)return n;o=r?r.getAggFunc():null,s=!0}else{const n=i.isValueActive(),r=this.pivotMode||!this.isRowGroupEmpty();n&&r?(o=i.getAggFunc(),s=!0):s=!1}if(s){const i="string"==typeof o?o:"func";return`${this.localeService.getLocaleTextFunc()(i,i)}(${n})`}return n}getColumnGroup(n,r){if(!n)return null;if(n instanceof g)return n;const e=this.getAllDisplayedTrees(),s="number"==typeof r;let o=null;return this.columnUtils.depthFirstAllColumnTreeSearch(e,i=>{if(i instanceof g){const e=i;let t;t=s?n===e.getGroupId()&&r===e.getPartId():n===e.getGroupId(),t&&(o=e)}}),o}isReady(){return this.ready}extractValueColumns(i,e){this.valueColumns=this.extractColumns(e,this.valueColumns,(e,t)=>e.setValueActive(t,i),()=>{},()=>{},e=>{const t=e.aggFunc;return null===t||""===t?null:void 0!==t?!!t:void 0},e=>null!=e.initialAggFunc&&""!=e.initialAggFunc),this.valueColumns.forEach(e=>{const t=e.getColDef();null!=t.aggFunc&&""!=t.aggFunc?e.setAggFunc(t.aggFunc):e.getAggFunc()||e.setAggFunc(t.initialAggFunc)})}extractRowGroupColumns(i,e){this.rowGroupColumns=this.extractColumns(e,this.rowGroupColumns,(e,t)=>e.setRowGroupActive(t,i),e=>e.rowGroupIndex,e=>e.initialRowGroupIndex,e=>e.rowGroup,e=>e.initialRowGroup)}extractColumns(l=[],c=[],t,u,d,h,p){const f=[],g=[];(this.primaryColumns||[]).forEach(e=>{const t=l.indexOf(e)<0,i=e.getColDef(),n=ne(h(i)),r=ne(p(i)),s=ie(u(i)),o=ie(d(i));let a;if(a=void 0!==n?n:void 0!==s?null!==s&&s>=0:t?void 0!==r?r:!!(void 0!==o)&&(null!=o&&o>=0):c.indexOf(e)>=0,a){(t?null!=s||null!=o:null!=s)?f.push(e):g.push(e)}});const r=e=>{const t=u(e.getColDef()),i=d(e.getColDef());return null!=t?t:i};f.sort((e,t)=>{const i=r(e),n=r(t);return i===n?0:i<n?-1:1});const i=[].concat(f);return c.forEach(e=>{g.indexOf(e)>=0&&i.push(e)}),g.forEach(e=>{i.indexOf(e)<0&&i.push(e)}),c.forEach(e=>{i.indexOf(e)<0&&t(e,!1)}),i.forEach(e=>{c.indexOf(e)<0&&t(e,!0)}),i}extractPivotColumns(i,e){this.pivotColumns=this.extractColumns(e,this.pivotColumns,(e,t)=>e.setPivotActive(t,i),e=>e.pivotIndex,e=>e.initialPivotIndex,e=>e.pivot,e=>e.initialPivot)}resetColumnGroupState(e="api"){const n=[];this.columnUtils.depthFirstOriginalTreeSearch(null,this.primaryColumnTree,i=>{if(i instanceof h){const e=i.getColGroupDef(),t={groupId:i.getGroupId(),open:e?e.openByDefault:void 0};n.push(t)}}),this.setColumnGroupState(n,e)}getColumnGroupState(){const t=[];return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,e=>{e instanceof h&&t.push({groupId:e.getGroupId(),open:e.isExpanded()})}),t}setColumnGroupState(e,t="api"){this.columnAnimationService.start();const r=[];e.forEach(e=>{const t=e.groupId,i=e.open,n=this.getProvidedColumnGroup(t);n&&n.isExpanded()!==i&&(this.logger.log("columnGroupOpened("+n.getGroupId()+","+i+")"),n.setExpanded(i),r.push(n))}),this.updateGroupsAndDisplayedColumns(t),this.setFirstRightAndLastLeftPinned(t),r.forEach(e=>{const t={type:y.EVENT_COLUMN_GROUP_OPENED,columnGroup:e};this.eventService.dispatchEvent(t)}),this.columnAnimationService.finish()}setColumnGroupOpened(e,t,i="api"){let n;n=e instanceof h?e.getId():e||"",this.setColumnGroupState([{groupId:n,open:t}],i)}getProvidedColumnGroup(t){"string"!=typeof t&&console.error("AG Grid: group key must be a string");let i=null;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,e=>{e instanceof h&&e.getId()===t&&(i=e)}),i}calculateColumnsForDisplay(){let e;return e=this.pivotMode&&u(this.secondaryColumns)?this.gridColumns.filter(e=>{const t=this.groupAutoColumns&&dt(this.groupAutoColumns,e),i=this.valueColumns&&dt(this.valueColumns,e);return t||i}):this.gridColumns.filter(e=>this.groupAutoColumns&&dt(this.groupAutoColumns,e)||e.isVisible()),e}checkColSpanActiveInCols(e){let t=!1;return e.forEach(e=>{_(e.getColDef().colSpan)&&(t=!0)}),t}calculateColumnsForGroupDisplay(){this.groupDisplayColumns=[],this.groupDisplayColumnsMap={};this.gridColumns.forEach(t=>{const e=t.getColDef(),i=e.showRowGroup;e&&_(i)&&(this.groupDisplayColumns.push(t),"string"==typeof i?this.groupDisplayColumnsMap[i]=t:!0===i&&this.getRowGroupColumns().forEach(e=>{this.groupDisplayColumnsMap[e.getId()]=t}))})}getGroupDisplayColumns(){return this.groupDisplayColumns}getGroupDisplayColumnForGroup(e){return this.groupDisplayColumnsMap[e]}updateDisplayedColumns(e){const t=this.calculateColumnsForDisplay();this.buildDisplayedTrees(t),this.updateGroupsAndDisplayedColumns(e),this.setFirstRightAndLastLeftPinned(e)}isSecondaryColumnsPresent(){return _(this.secondaryColumns)}setSecondaryColumns(e,t="api"){const i=e&&e.length>0;if(i||!u(this.secondaryColumns)){if(i){this.processSecondaryColumnDefinitions(e);const t=this.columnFactory.createColumnTree(e,!1,this.secondaryBalancedTree||this.previousSecondaryColumns||void 0);this.destroyOldColumns(this.secondaryBalancedTree,t.columnTree),this.secondaryBalancedTree=t.columnTree,this.secondaryHeaderRowCount=t.treeDept+1,this.secondaryColumns=this.getColumnsFromTree(this.secondaryBalancedTree),this.secondaryColumnsMap={},this.secondaryColumns.forEach(e=>this.secondaryColumnsMap[e.getId()]=e),this.previousSecondaryColumns=null}else this.previousSecondaryColumns=this.secondaryBalancedTree,this.secondaryBalancedTree=null,this.secondaryHeaderRowCount=-1,this.secondaryColumns=null,this.secondaryColumnsMap={};this.updateGridColumns(),this.updateDisplayedColumns(t)}}processSecondaryColumnDefinitions(e){const t=this.gridOptionsService.get("processPivotResultColDef")||this.gridOptionsService.get("processSecondaryColDef"),i=this.gridOptionsService.get("processPivotResultColGroupDef")||this.gridOptionsService.get("processSecondaryColGroupDef");if(!t&&!i)return;const n=e=>{e.forEach(e=>{if(_(e.children)){const t=e;i&&i(t),n(t.children)}else{const i=e;t&&t(i)}})};e&&n(e)}updateGridColumns(){const t=this.gridBalancedTree;let e;if(this.gridColsArePrimary?this.lastPrimaryOrder=this.gridColumns:this.lastSecondaryOrder=this.gridColumns,this.secondaryColumns&&this.secondaryBalancedTree){const t=this.secondaryColumns.every(e=>void 0!==this.gridColumnsMap[e.getColId()]);this.gridBalancedTree=this.secondaryBalancedTree.slice(),this.gridHeaderRowCount=this.secondaryHeaderRowCount,this.gridColumns=this.secondaryColumns.slice(),this.gridColsArePrimary=!1,t&&(e=this.lastSecondaryOrder)}else this.primaryColumns&&(this.gridBalancedTree=this.primaryColumnTree.slice(),this.gridHeaderRowCount=this.primaryHeaderRowCount,this.gridColumns=this.primaryColumns.slice(),this.gridColsArePrimary=!0,e=this.lastPrimaryOrder);if(this.createGroupAutoColumnsIfNeeded()&&e){const t=Vt(this.groupAutoColumns.map(e=>[e,!0]));e=e.filter(e=>!t.has(e)),e=[...this.groupAutoColumns,...e]}if(this.addAutoGroupToGridColumns(),this.orderGridColsLike(e),this.gridColumns=this.placeLockedColumns(this.gridColumns),this.calculateColumnsForGroupDisplay(),this.refreshQuickFilterColumns(),this.clearDisplayedAndViewportColumns(),this.colSpanActive=this.checkColSpanActiveInCols(this.gridColumns),this.gridColumnsMap={},this.gridColumns.forEach(e=>this.gridColumnsMap[e.getId()]=e),this.setAutoHeightActive(),!it(t,this.gridBalancedTree)){const t={type:y.EVENT_GRID_COLUMNS_CHANGED};this.eventService.dispatchEvent(t)}}setAutoHeightActive(){if(this.autoHeightActive=this.gridColumns.filter(e=>e.isAutoHeight()).length>0,this.autoHeightActive){this.autoHeightActiveAtLeastOnce=!0;if(!(this.gridOptionsService.isRowModelType("clientSide")||this.gridOptionsService.isRowModelType("serverSide"))){const e="AG Grid - autoHeight columns only work with Client Side Row Model and Server Side Row Model.";l(()=>console.warn(e),"autoHeightActive.wrongRowModel")}}}orderGridColsLike(e){if(u(e))return;const t=Vt(e.map((e,t)=>[e,t]));let i=!0;if(this.gridColumns.forEach(e=>{t.has(e)&&(i=!1)}),i)return;const n=Vt(this.gridColumns.map(e=>[e,!0])),r=e.filter(e=>n.has(e)),s=Vt(r.map(e=>[e,!0])),o=this.gridColumns.filter(e=>!s.has(e)),a=r.slice();o.forEach(e=>{let t=e.getOriginalParent();if(!t)return void a.push(e);const n=[];for(;!n.length&&t;){t.getLeafColumns().forEach(e=>{const t=a.indexOf(e)>=0,i=n.indexOf(e)<0;t&&i&&n.push(e)}),t=t.getOriginalParent()}if(!n.length)return void a.push(e);const i=n.map(e=>a.indexOf(e)),r=Math.max(...i);lt(a,e,r+1)}),this.gridColumns=a}isPrimaryColumnGroupsPresent(){return this.primaryHeaderRowCount>1}refreshQuickFilterColumns(){var e;let t=null!==(e=this.isPivotMode()?this.secondaryColumns:this.primaryColumns)&&void 0!==e?e:[];this.groupAutoColumns&&(t=t.concat(this.groupAutoColumns)),this.columnsForQuickFilter=this.gridOptionsService.is("includeHiddenColumnsInQuickFilter")?t:t.filter(e=>e.isVisible()||e.isRowGroupActive())}placeLockedColumns(e){const i=[],n=[],r=[];return e.forEach(e=>{const t=e.getColDef().lockPosition;"right"===t?r.push(e):"left"===t||!0===t?i.push(e):n.push(e)}),[...i,...n,...r]}addAutoGroupToGridColumns(){if(u(this.groupAutoColumns))return this.destroyOldColumns(this.groupAutoColsBalancedTree),void(this.groupAutoColsBalancedTree=null);this.gridColumns=this.groupAutoColumns?this.groupAutoColumns.concat(this.gridColumns):this.gridColumns;const e=this.columnFactory.createForAutoGroups(this.groupAutoColumns,this.gridBalancedTree);this.destroyOldColumns(this.groupAutoColsBalancedTree,e),this.groupAutoColsBalancedTree=e,this.gridBalancedTree=e.concat(this.gridBalancedTree)}clearDisplayedAndViewportColumns(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.viewportColumns=[],this.headerViewportColumns=[],this.viewportColumnsHash=""}updateGroupsAndDisplayedColumns(e){this.updateOpenClosedVisibilityInColumnGroups(),this.deriveDisplayedColumns(e),this.refreshFlexedColumns(),this.extractViewport(),this.updateBodyWidths();const t={type:y.EVENT_DISPLAYED_COLUMNS_CHANGED};this.eventService.dispatchEvent(t)}deriveDisplayedColumns(e){this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeLeft,this.displayedColumnsLeft),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeCentre,this.displayedColumnsCenter),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeRight,this.displayedColumnsRight),this.joinDisplayedColumns(),this.setLeftValues(e),this.displayedAutoHeightCols=this.displayedColumns.filter(e=>e.isAutoHeight())}isAutoRowHeightActive(){return this.autoHeightActive}wasAutoRowHeightEverActive(){return this.autoHeightActiveAtLeastOnce}joinDisplayedColumns(){this.gridOptionsService.is("enableRtl")?this.displayedColumns=this.displayedColumnsRight.concat(this.displayedColumnsCenter).concat(this.displayedColumnsLeft):this.displayedColumns=this.displayedColumnsLeft.concat(this.displayedColumnsCenter).concat(this.displayedColumnsRight)}setLeftValues(e){this.setLeftValuesOfColumns(e),this.setLeftValuesOfGroups()}setLeftValuesOfColumns(i){if(!this.primaryColumns)return;const t=this.primaryColumns.slice(0),n=this.gridOptionsService.is("enableRtl");[this.displayedColumnsLeft,this.displayedColumnsRight,this.displayedColumnsCenter].forEach(e=>{if(n){let t=this.getWidthOfColsInList(e);e.forEach(e=>{t-=e.getActualWidth(),e.setLeft(t,i)})}else{let t=0;e.forEach(e=>{e.setLeft(t,i),t+=e.getActualWidth()})}at(t,e)}),t.forEach(e=>{e.setLeft(null,i)})}setLeftValuesOfGroups(){[this.displayedTreeLeft,this.displayedTreeRight,this.displayedTreeCentre].forEach(e=>{e.forEach(e=>{if(e instanceof g){e.checkLeft()}})})}derivedDisplayedColumnsFromDisplayedTree(e,t){t.length=0,this.columnUtils.depthFirstDisplayedColumnTreeSearch(e,e=>{e instanceof d&&t.push(e)})}extractViewportColumns(){this.suppressColumnVirtualisation?(this.viewportColumnsCenter=this.displayedColumnsCenter,this.headerViewportColumnsCenter=this.displayedColumnsCenter):(this.viewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInRowViewport.bind(this)),this.headerViewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInHeaderViewport.bind(this))),this.viewportColumns=this.viewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight),this.headerViewportColumns=this.headerViewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight)}getVirtualHeaderGroupRow(e,t){let i;switch(e){case"left":i=this.viewportRowLeft[t];break;case"right":i=this.viewportRowRight[t];break;default:i=this.viewportRowCenter[t]}return u(i)&&(i=[]),i}calculateHeaderRows(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={};const a={};this.headerViewportColumns.forEach(e=>a[e.getId()]=!0);const l=(n,r,s)=>{let o=!1;for(let i=0;i<n.length;i++){const e=n[i];let t=!1;if(e instanceof d)t=!0===a[e.getId()];else{const a=e.getDisplayedChildren();a&&(t=l(a,r,s+1))}t&&(o=!0,r[s]||(r[s]=[]),r[s].push(e))}return o};l(this.displayedTreeLeft,this.viewportRowLeft,0),l(this.displayedTreeRight,this.viewportRowRight,0),l(this.displayedTreeCentre,this.viewportRowCenter,0)}extractViewport(){this.extractViewportColumns();const e=this.viewportColumns.map(e=>`${e.getId()}-${e.getPinned()||"normal"}`).join("#"),t=this.viewportColumnsHash!==e;return t&&(this.viewportColumnsHash=e,this.calculateHeaderRows()),t}refreshFlexedColumns(r={}){const s=r.source?r.source:"flex";if(null!=r.viewportWidth&&(this.flexViewportWidth=r.viewportWidth),!this.flexViewportWidth)return[];let i=-1;r.resizingCols&&r.resizingCols.forEach(e=>{const t=this.displayedColumnsCenter.indexOf(e);i<t&&(i=t)});const o=e=>{const t=this.displayedColumnsCenter.indexOf(e)>i;return e.getFlex()&&t},a=this.displayedColumnsCenter.filter(e=>!o(e)),l=this.displayedColumnsCenter.filter(e=>o(e)),c=[];if(!l.length)return[];const u=[];let d;e:for(;;){const r=l.reduce((e,t)=>e+t.getFlex(),0);d=this.flexViewportWidth-this.getWidthOfColsInList(a);for(let n=0;n<l.length;n++){const o=l[n],h=d*o.getFlex()/r;let e=0;const t=o.getMinWidth(),i=o.getMaxWidth();if(_(t)&&h<t?e=t:_(i)&&h>i&&(e=i),e){o.setActualWidth(e,s),ot(l,o),c.push(o),a.push(o);continue e}u[n]=Math.round(h)}break}let h=d;return l.forEach((e,t)=>{e.setActualWidth(Math.min(u[t],h),s),c.push(e),h-=u[t]}),r.skipSetLeft||this.setLeftValues(s),r.updateBodyWidths&&this.updateBodyWidths(),r.fireResizedEvent&&this.dispatchColumnResizedEvent(c,!0,s,l),l}sizeColumnsToFit(a,l="sizeColumnsToFit",e,c){var t,u,d,h,p;if(this.shouldQueueResizeOperations)return void this.resizeOperationQueue.push(()=>this.sizeColumnsToFit(a,l,e,c));const f={};c&&(null===(t=null==c?void 0:c.columnLimits)||void 0===t||t.forEach(e=>{var{key:t}=e,i=ii(e,["key"]);f["string"==typeof t?t:t.getColId()]=i}));const g=this.getAllDisplayedColumns(),m=a===this.getWidthOfColsInList(g);if(a<=0||!g.length||m)return;const v=[],y=[];g.forEach(e=>{!0===e.getColDef().suppressSizeToFit?y.push(e):v.push(e)});const b=v.slice(0);let C=!1;const w=e=>{ot(v,e),y.push(e)};for(v.forEach(e=>e.resetActualWidth(l));!C;){C=!0;const e=a-this.getWidthOfColsInList(y);if(e<=0)v.forEach(e=>{var t,i;const n=null!==(i=null===(t=null==f?void 0:f[e.getId()])||void 0===t?void 0:t.minWidth)&&void 0!==i?i:null==c?void 0:c.defaultMinWidth;"number"!=typeof n?e.setMinimum(l):e.setActualWidth(n)});else{const a=e/this.getWidthOfColsInList(v);let o=e;for(let s=v.length-1;s>=0;s--){const g=v[s],m=null==f?void 0:f[g.getId()],y=null!==(u=null==m?void 0:m.minWidth)&&void 0!==u?u:null==c?void 0:c.defaultMinWidth,b=null!==(d=null==m?void 0:m.maxWidth)&&void 0!==d?d:null==c?void 0:c.defaultMaxWidth,e=null!==(h=g.getMinWidth())&&void 0!==h?h:0,t=null!==(p=g.getMaxWidth())&&void 0!==p?p:Number.MAX_VALUE,i="number"==typeof y&&y>e?y:g.getMinWidth(),n="number"==typeof b&&b<t?b:g.getMaxWidth();let r=Math.round(g.getActualWidth()*a);_(i)&&r<i?(r=i,w(g),C=!1):_(n)&&r>n?(r=n,w(g),C=!1):0===s&&(r=o),g.setActualWidth(r,l,!0),o-=r}}}b.forEach(e=>{e.fireColumnWidthChangedEvent(l)}),this.setLeftValues(l),this.updateBodyWidths(),e||this.dispatchColumnResizedEvent(b,!0,l)}buildDisplayedTrees(e){const t=[],i=[],n=[];e.forEach(e=>{switch(e.getPinned()){case"left":t.push(e);break;case"right":i.push(e);break;default:n.push(e)}});const r=new Nt;this.displayedTreeLeft=this.displayedGroupCreator.createDisplayedGroups(t,this.gridBalancedTree,r,"left",this.displayedTreeLeft),this.displayedTreeRight=this.displayedGroupCreator.createDisplayedGroups(i,this.gridBalancedTree,r,"right",this.displayedTreeRight),this.displayedTreeCentre=this.displayedGroupCreator.createDisplayedGroups(n,this.gridBalancedTree,r,null,this.displayedTreeCentre),this.updateDisplayedMap()}updateDisplayedMap(){this.displayedColumnsAndGroupsMap={};const e=e=>{this.displayedColumnsAndGroupsMap[e.getUniqueId()]=e};this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeCentre,e),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeLeft,e),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeRight,e)}isDisplayed(e){return this.displayedColumnsAndGroupsMap[e.getUniqueId()]===e}updateOpenClosedVisibilityInColumnGroups(){const e=this.getAllDisplayedTrees();this.columnUtils.depthFirstAllColumnTreeSearch(e,e=>{if(e instanceof g){e.calculateDisplayedColumns()}})}getGroupAutoColumns(){return this.groupAutoColumns}createGroupAutoColumnsIfNeeded(){const e=this.forceRecreateAutoGroups;if(this.forceRecreateAutoGroups=!1,!this.autoGroupsNeedBuilding)return!1;this.autoGroupsNeedBuilding=!1;const t=this.gridOptionsService.isGroupUseEntireRow(this.pivotMode),i=this.pivotMode?this.gridOptionsService.is("pivotSuppressAutoColumn"):this.isGroupSuppressAutoColumn();if((this.rowGroupColumns.length>0||this.usingTreeData)&&!i&&!t){const t=this.groupAutoColumns||[],i=this.autoGroupColService.createAutoGroupColumns(t,this.rowGroupColumns);if(!this.autoColsEqual(i,this.groupAutoColumns)||e)return this.groupAutoColumns=i,!0}else this.groupAutoColumns=null;return!1}isGroupSuppressAutoColumn(){const e=this.gridOptionsService.get("groupDisplayType");if(!!e&&Jt("custom",e))return!0;const t=this.gridOptionsService.get("treeDataDisplayType");return!!t&&function(e,t){const i=["auto","custom"];return i.indexOf(t)<0?(console.warn(`AG Grid: '${t}' is not a valid treeDataDisplayType value - possible values are: '${i.join("', '")}'`),!1):t===e}("custom",t)}autoColsEqual(e,t){return it(e,t,(e,t)=>e.getColId()===t.getColId())}getWidthOfColsInList(e){return e.reduce((e,t)=>e+t.getActualWidth(),0)}getGridBalancedTree(){return this.gridBalancedTree}hasFloatingFilters(){if(!this.gridColumns)return!1;return this.gridColumns.some(e=>e.getColDef().floatingFilter)}getFirstDisplayedColumn(){const i=this.gridOptionsService.is("enableRtl"),n=["getDisplayedLeftColumns","getDisplayedCenterColumns","getDisplayedRightColumns"];i&&n.reverse();for(let t=0;t<n.length;t++){const e=this[n[t]]();if(e.length)return i?p(e):e[0]}return null}setColumnHeaderHeight(e,t){if(e.setAutoHeaderHeight(t)){const t={type:y.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,column:e,columns:[e],source:"autosizeColumnHeaderHeight"};this.eventService.dispatchEvent(t)}}getColumnGroupHeaderRowHeight(){return this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight()}getColumnHeaderRowHeight(){const e=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),t=this.getAllDisplayedColumns().filter(e=>e.isAutoHeaderHeight()).map(e=>e.getAutoHeaderHeight()||0);return Math.max(e,...t)}getHeaderHeight(){var e;return null!==(e=this.gridOptionsService.getNum("headerHeight"))&&void 0!==e?e:this.environment.getFromTheme(25,"headerHeight")}getFloatingFiltersHeight(){var e;return null!==(e=this.gridOptionsService.getNum("floatingFiltersHeight"))&&void 0!==e?e:this.getHeaderHeight()}getGroupHeaderHeight(){var e;return null!==(e=this.gridOptionsService.getNum("groupHeaderHeight"))&&void 0!==e?e:this.getHeaderHeight()}getPivotHeaderHeight(){var e;return null!==(e=this.gridOptionsService.getNum("pivotHeaderHeight"))&&void 0!==e?e:this.getHeaderHeight()}getPivotGroupHeaderHeight(){var e;return null!==(e=this.gridOptionsService.getNum("pivotGroupHeaderHeight"))&&void 0!==e?e:this.getGroupHeaderHeight()}queueResizeOperations(){this.shouldQueueResizeOperations=!0}processResizeOperations(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach(e=>e()),this.resizeOperationQueue=[]}resetColumnDefIntoColumn(e){const t=e.getUserProvidedColDef();if(!t)return!1;const i=this.columnFactory.mergeColDefs(t,e.getColId());return e.setColDef(i,t),!0}generateColumnStateForRowGroupAndPivotIndexes(e,t){let v={};const i=(i,t,n,r,s,o)=>{if(!t.length||!this.primaryColumns)return[];const e=Object.keys(i),a=new Set(e),l=new Set(e),c=new Set(t.map(e=>{const t=e.getColId();return l.delete(t),t}).concat(e)),u=[],d={};let h=0;for(let e=0;e<this.primaryColumns.length;e++){const t=this.primaryColumns[e].getColId();c.has(t)&&(u.push(t),d[t]=h++)}let p=1e3,f=!1,g=0;const m=e=>{const t=d[e];for(let e=g;e<t;e++){const t=u[e];l.has(t)&&(i[t][s]=p++,l.delete(t))}g=t};t.forEach(e=>{const t=e.getColId();if(a.has(t))m(t),i[t][s]=p++;else{const a=e.getColDef();if(null===a[s]||void 0===a[s]&&null==a[o]){if(!f){a[n]||void 0===a[n]&&a[r]?m(t):(l.forEach(e=>{i[e][s]=p+d[e]}),p+=u.length,f=!0)}v[t]||(v[t]={colId:t}),v[t][s]=p++}}})};return i(e,this.rowGroupColumns,"rowGroup","initialRowGroup","rowGroupIndex","initialRowGroupIndex"),i(t,this.pivotColumns,"pivot","initialPivot","pivotIndex","initialPivotIndex"),Object.values(v)}};ei([o("expressionService")],ni.prototype,"expressionService",void 0),ei([o("columnFactory")],ni.prototype,"columnFactory",void 0),ei([o("displayedGroupCreator")],ni.prototype,"displayedGroupCreator",void 0),ei([o("ctrlsService")],ni.prototype,"ctrlsService",void 0),ei([o("autoWidthCalculator")],ni.prototype,"autoWidthCalculator",void 0),ei([o("columnUtils")],ni.prototype,"columnUtils",void 0),ei([o("columnAnimationService")],ni.prototype,"columnAnimationService",void 0),ei([o("autoGroupColService")],ni.prototype,"autoGroupColService",void 0),ei([c("aggFuncService")],ni.prototype,"aggFuncService",void 0),ei([c("valueCache")],ni.prototype,"valueCache",void 0),ei([c("animationFrameService")],ni.prototype,"animationFrameService",void 0),ei([o("sortController")],ni.prototype,"sortController",void 0),ei([o("columnDefFactory")],ni.prototype,"columnDefFactory",void 0),ei([r],ni.prototype,"init",null),ei([Ve],ni.prototype,"destroyColumns",null),ei([ti(0,ze("loggerFactory"))],ni.prototype,"setBeans",null),ni=ei([s("columnModel")],ni);var ri=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let si=class extends f{calculateColMinWidth(e){return null!=e.minWidth?e.minWidth:this.environment.getMinColWidth()}calculateColMaxWidth(e){return null!=e.maxWidth?e.maxWidth:Number.MAX_SAFE_INTEGER}calculateColInitialWidth(e){const t=this.calculateColMinWidth(e),i=this.calculateColMaxWidth(e);let n;const r=ie(e.width),s=ie(e.initialWidth);return n=null!=r?r:null!=s?s:200,Math.max(Math.min(n,i),t)}getOriginalPathForColumn(r,e){const s=[];let o=!1;const a=(i,n)=>{for(let t=0;t<i.length;t++){if(o)return;const e=i[t];if(e instanceof h){a(e.getChildren(),n+1),s[n]=e}else e===r&&(o=!0)}};return a(e,0),o?s:null}depthFirstOriginalTreeSearch(t,e,i){e&&e.forEach(e=>{e instanceof h&&this.depthFirstOriginalTreeSearch(e,e.getChildren(),i),i(e,t)})}depthFirstAllColumnTreeSearch(e,t){e&&e.forEach(e=>{e instanceof g&&this.depthFirstAllColumnTreeSearch(e.getChildren(),t),t(e)})}depthFirstDisplayedColumnTreeSearch(e,t){e&&e.forEach(e=>{e instanceof g&&this.depthFirstDisplayedColumnTreeSearch(e.getDisplayedChildren(),t),t(e)})}};si=ri([s("columnUtils")],si);var oi=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let ai=class extends f{createDisplayedGroups(e,r,s,o,t){const a=[];let l,c;const u=this.mapOldGroupsById(t);return e.forEach(e=>{const t=this.getOriginalPathForColumn(r,e),i=[],n=!c;for(let e=0;e<t.length;e++)if(n||t[e]!==c[e]){const r=this.createColumnGroup(t[e],s,u,o);i[e]=r,0==e?a.push(r):i[e-1].addChild(r)}else i[e]=l[e];if(0===i.length)a.push(e);else{p(i).addChild(e)}l=i,c=t}),this.setupParentsIntoColumns(a,null),a}createColumnGroup(e,t,i,n){const r=e.getGroupId(),s=t.getInstanceIdForKey(r);let o=i[g.createUniqueId(r,s)];return o&&o.getProvidedColumnGroup()!==e&&(o=null),_(o)?o.reset():(o=new g(e,r,s,n),this.context.createBean(o)),o}mapOldGroupsById(e){const i={},n=e=>{e.forEach(t=>{if(t instanceof g){const e=t;i[t.getUniqueId()]=e,n(e.getChildren())}})};return e&&n(e),i}setupParentsIntoColumns(e,t){e.forEach(e=>{if(e.setParent(t),e instanceof g){const t=e;this.setupParentsIntoColumns(t.getChildren(),t)}})}getOriginalPathForColumn(e,r){const s=[];let o=!1;const a=(i,n)=>{for(let t=0;t<i.length;t++){if(o)return;const e=i[t];e instanceof h?(a(e.getChildren(),n+1),s[n]=e):e===r&&(o=!0)}};return a(e,0),o?s:(console.warn("AG Grid: could not get path"),null)}};ai=oi([s("displayedGroupCreator")],ai);var li=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let ci,ui,di,hi,pi,fi,gi,mi,vi=class extends f{constructor(){super(...arguments),this.componentsMappedByName={}}setupComponents(e){e&&e.forEach(e=>this.addComponent(e))}addComponent(e){const t=e.componentName.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase().toUpperCase();this.componentsMappedByName[t]=e.componentClass}getComponentClass(e){return this.componentsMappedByName[e]}};function yi(e,t,i){null==i||""==i?Ci(e,t):bi(e,t,i)}function bi(e,t,i){e.setAttribute(wi(t),i.toString())}function Ci(e,t){e.removeAttribute(wi(t))}function wi(e){return"aria-"+e}function _i(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function Ai(e){let t;return t="asc"===e?"ascending":"desc"===e?"descending":"mixed"===e?"other":"none",t}function Ei(e){return parseInt(e.getAttribute("aria-level"),10)}function Si(e){return parseInt(e.getAttribute("aria-posinset"),10)}function Ti(e){return e.getAttribute("aria-describedby")||""}function xi(e,t){yi(e,"label",t)}function Di(e,t){yi(e,"labelledby",t)}function Ri(e,t){yi(e,"description",t)}function Mi(e,t){yi(e,"describedby",t)}function Ni(e,t){yi(e,"live",t)}function Oi(e,t){yi(e,"level",t)}function Ii(e,t){yi(e,"disabled",t)}function Pi(e,t){yi(e,"hidden",t)}function ki(e,t){bi(e,"expanded",t)}function Li(e){Ci(e,"expanded")}function Fi(e,t){bi(e,"setsize",t)}function Gi(e,t){bi(e,"posinset",t)}function $i(e,t){bi(e,"multiselectable",t)}function Hi(e,t){bi(e,"rowcount",t)}function Bi(e,t){bi(e,"rowindex",t)}function Vi(e,t){bi(e,"colcount",t)}function Wi(e,t){bi(e,"colindex",t)}function zi(e,t){bi(e,"colspan",t)}function ji(e,t){bi(e,"sort",t)}function Ui(e){Ci(e,"sort")}function Yi(e,t){yi(e,"selected",t)}function qi(e,t){bi(e,"checked",void 0===t?"mixed":t)}function Ki(e,t){yi(e,"controls",t.id),Di(t,e.id)}function Xi(e,t){return void 0===t?e("ariaIndeterminate","indeterminate"):!0===t?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}function Qi(){return void 0===ci&&(ci=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),ci}function Zi(){if(void 0===ui)if(Qi()){const e=navigator.userAgent.match(/version\/(\d+)/i);e&&(ui=null!=e[1]?parseFloat(e[1]):0)}else ui=0;return ui}function Ji(){if(void 0===di){const e=window;di=!!e.chrome&&(!!e.chrome.webstore||!!e.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return di}function en(){return void 0===hi&&(hi=/(firefox)/i.test(navigator.userAgent)),hi}function tn(){return void 0===pi&&(pi=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),pi}function nn(){return void 0===fi&&(fi=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),fi}function rn(){return!Qi()||Zi()>=15}function sn(e){if(!e)return null;const t=e.tabIndex,i=e.getAttribute("tabIndex");return-1!==t||null!==i&&(""!==i||en())?t.toString():null}function on(){if(!document.body)return-1;let t=1e6;const i=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,n=document.createElement("div");for(document.body.appendChild(n);;){const e=2*t;if(n.style.height=e+"px",e>i||n.clientHeight!==e)break;t=e}return document.body.removeChild(n),t}function an(){var e,t,i;return null!==(t=null===(e=document.body)||void 0===e?void 0:e.clientWidth)&&void 0!==t?t:window.innerHeight||(null===(i=document.documentElement)||void 0===i?void 0:i.clientWidth)||-1}function ln(){var e,t,i;return null!==(t=null===(e=document.body)||void 0===e?void 0:e.clientHeight)&&void 0!==t?t:window.innerHeight||(null===(i=document.documentElement)||void 0===i?void 0:i.clientHeight)||-1}function cn(){return null==mi&&un(),mi}function un(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let i=t.offsetWidth-t.clientWidth;0===i&&0===t.clientWidth&&(i=null),t.parentNode&&t.parentNode.removeChild(t),null!=i&&(mi=i,gi=0===i)}function dn(){return null==gi&&un(),gi}function hn(e,t){return e.toString().padStart(t,"0")}function pn(t,i){const n=[];for(let e=t;e<=i;e++)n.push(e);return n}function fn(e){return"string"==typeof e&&(e=parseInt(e,10)),"number"==typeof e?Math.floor(e):null}function gn(t,i){let n="";for(let e=0;e<i;e++)n+=String.fromCharCode(255&t),t>>>=8;return n}function mn(e,t,i){return"number"!=typeof e?"":vn(Math.round(100*e)/100,t,i)}function vn(e,t,i){return"number"!=typeof e?"":e.toString().replace(".",i).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+t)}function yn(e){return null==e?null:e.reduce((e,t)=>e+t,0)}function bn(e,t){return e>=0?e:t}function Cn(e,t){const i=parseInt(e,10);return!isNaN(i)&&isFinite(i)&&i>0?i:t}function wn(e,t=!0,i="-"){if(!e)return null;let n=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(e=>hn(e,2)).join(i);return t&&(n+=" "+[e.getHours(),e.getMinutes(),e.getSeconds()].map(e=>hn(e,2)).join(":")),n}vi=li([s("agStackComponentsRegistry")],vi);const _n=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function An(e,t="YYYY-MM-DD"){const i=hn(e.getFullYear(),4),n=["January","February","March","April","May","June","July","August","September","October","November","December"],r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s={YYYY:()=>i.slice(i.length-4,i.length),YY:()=>i.slice(i.length-2,i.length),Y:()=>""+e.getFullYear(),MMMM:()=>n[e.getMonth()],MMM:()=>n[e.getMonth()].slice(0,3),MM:()=>hn(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${_n(e.getMonth()+1)}`,M:()=>""+(e.getMonth()+1),Do:()=>`${e.getDate()}${_n(e.getDate())}`,DD:()=>hn(e.getDate(),2),D:()=>""+e.getDate(),dddd:()=>r[e.getDay()],ddd:()=>r[e.getDay()].slice(0,3),dd:()=>r[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${_n(e.getDay())}`,d:()=>""+e.getDay()},o=new RegExp(Object.keys(s).join("|"),"g");return t.replace(o,e=>e in s?s[e]():e)}function En(e){if(!e)return null;const[t,i]=e.split(" ");if(!t)return null;const n=t.split("-").map(e=>parseInt(e,10));if(3!==n.filter(e=>!isNaN(e)).length)return null;const[r,s,o]=n,a=new Date(r,s-1,o);if(a.getFullYear()!==r||a.getMonth()!==s-1||a.getDate()!==o)return null;if(!i||"00:00:00"===i)return a;const[l,c,u]=i.split(":").map(e=>parseInt(e,10));return l>=0&&l<24&&a.setHours(l),c>=0&&c<60&&a.setMinutes(c),u>=0&&u<60&&a.setSeconds(u),a}let Sn;function Tn(e,t,i){const n=e.parentElement;let r=n&&n.firstChild;for(;r;)t&&r.classList.toggle(t,r===e),i&&r.classList.toggle(i,r!==e),r=r.nextSibling}const xn="[tabindex], input, select, button, textarea, [href]",Dn=".ag-hidden, .ag-hidden *, [disabled], .ag-disabled:not(.ag-button), .ag-disabled *.mjs";function Rn(e){const t=Element.prototype.matches||Element.prototype.msMatchesSelector,i=t.call(e,"input, select, button, textarea"),n=t.call(e,Dn),r=jn(e);return i&&!n&&r}function w(e,t,i={}){const{skipAriaHidden:n}=i;e.classList.toggle("ag-hidden",!t),n||Pi(e,!t)}function Mn(e,t,i={}){const{skipAriaHidden:n}=i;e.classList.toggle("ag-invisible",!t),n||Pi(e,!t)}function Nn(e,t){const i=t?e=>e.setAttribute("disabled",""):e=>e.removeAttribute("disabled");i(e),pr(e.querySelectorAll("input"),e=>i(e))}function On(e,t,i){let n=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,"number"==typeof i){if(++n>i)break}else if(e===i)break}return!1}function In(e){const{height:t,width:i,borderTopWidth:n,borderRightWidth:r,borderBottomWidth:s,borderLeftWidth:o,paddingTop:a,paddingRight:l,paddingBottom:c,paddingLeft:u,marginTop:d,marginRight:h,marginBottom:p,marginLeft:f,boxSizing:g}=window.getComputedStyle(e);return{height:parseFloat(t),width:parseFloat(i),borderTopWidth:parseFloat(n),borderRightWidth:parseFloat(r),borderBottomWidth:parseFloat(s),borderLeftWidth:parseFloat(o),paddingTop:parseFloat(a),paddingRight:parseFloat(l),paddingBottom:parseFloat(c),paddingLeft:parseFloat(u),marginTop:parseFloat(d),marginRight:parseFloat(h),marginBottom:parseFloat(p),marginLeft:parseFloat(f),boxSizing:g}}function Pn(e){const t=In(e);return"border-box"===t.boxSizing?t.height-t.paddingTop-t.paddingBottom:t.height}function kn(e){const t=In(e);return"border-box"===t.boxSizing?t.width-t.paddingLeft-t.paddingRight:t.width}function Ln(e){const t=In(e),i=t.marginBottom+t.marginTop;return Math.ceil(e.offsetHeight+i)}function Fn(e){const t=In(e),i=t.marginLeft+t.marginRight;return Math.ceil(e.offsetWidth+i)}function Gn(e){const t=e.getBoundingClientRect(),{borderTopWidth:i,borderLeftWidth:n,borderRightWidth:r,borderBottomWidth:s}=In(e);return{top:t.top+(i||0),left:t.left+(n||0),right:t.right+(r||0),bottom:t.bottom+(s||0)}}function $n(){if("boolean"==typeof Sn)return Sn;const e=document.createElement("div");return e.style.direction="rtl",e.style.width="1px",e.style.height="1px",e.style.position="fixed",e.style.top="0px",e.style.overflow="hidden",e.dir="rtl",e.innerHTML='<div style="width: 2px">\n            <span style="display: inline-block; width: 1px"></span>\n            <span style="display: inline-block; width: 1px"></span>\n        </div>',document.body.appendChild(e),e.scrollLeft=1,Sn=0===Math.floor(e.scrollLeft),document.body.removeChild(e),Sn}function Hn(e,t){let i=e.scrollLeft;return t&&(i=Math.abs(i),Ji()&&!$n()&&(i=e.scrollWidth-e.clientWidth-i)),i}function Bn(e,t,i){i&&($n()?t*=-1:(Qi()||Ji())&&(t=e.scrollWidth-e.clientWidth-t)),e.scrollLeft=t}function Vn(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}function Wn(e,t){zn(e.querySelector(t))}function zn(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function jn(e){return null!==e.offsetParent}function Un(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function Yn(e,t){e.lastChild?e.insertAdjacentHTML("afterbegin",t):e.innerHTML=t}function qn(e,t){if(e.attributes&&e.attributes[t]){return e.attributes[t].value}return null}function Kn(e){return e&&e.clientHeight?e.clientHeight:0}function Xn(e){return e&&e.clientWidth?e.clientWidth:0}function Qn(e,t,i){if(i&&i.nextSibling===t)return;const n=document.activeElement,r=t.contains(n);i?i.nextSibling?e.insertBefore(t,i.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t),r&&n&&rn()&&n.focus({preventScroll:!0})}function Zn(n,r){for(let i=0;i<r.length;i++){const e=r[i],t=n.children[i];t!==e&&n.insertBefore(e,t)}}function Jn(e,t,i){i?i.insertAdjacentElement("afterend",t):e.firstChild?e.insertAdjacentElement("afterbegin",t):e.appendChild(t)}function er(e,t){_(e.firstChild)?e.insertBefore(t,e.firstChild):e.appendChild(t)}function tr(s,o){if(o)for(const[n,r]of Object.entries(o)){if(!n||!n.length||null==r)continue;const o=Bt(n),e=r.toString(),t=e.replace(/\s*!important/g,""),i=t.length!=e.length?"important":void 0;s.style.setProperty(o,t,i)}}function ir(e){return e.clientWidth<e.scrollWidth}function nr(e){return e.clientHeight<e.scrollHeight}function rr(e,t){"flex"===t?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):sr(e,t)}function sr(e,t){t=lr(t),e.style.width=t.toString(),e.style.maxWidth=t.toString(),e.style.minWidth=t.toString()}function or(e,t){"flex"===t?(e.style.removeProperty("height"),e.style.removeProperty("minHeight"),e.style.removeProperty("maxHeight"),e.style.flex="1 1 auto"):ar(e,t)}function ar(e,t){t=lr(t),e.style.height=t.toString(),e.style.maxHeight=t.toString(),e.style.minHeight=t.toString()}function lr(e){return"number"==typeof e?e+"px":e}function cr(e){return e instanceof Node||e instanceof HTMLElement}function ur(e){if(null==e)return[];const t=[];return pr(e,e=>t.push(e)),t}function dr(i,n){if(i)for(let t=0;t<i.length;t++){const e=i[t];n(e.name,e.value)}}function hr(e,t,i){null==i?e.removeAttribute(t):e.setAttribute(t,i.toString())}function pr(t,i){if(null!=t)for(let e=0;e<t.length;e++)i(t[e])}const fr={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"};function gr(e,t,i){const n=mr(e,t,i);if(n){const{className:e}=n;if("string"==typeof e&&e.indexOf("ag-icon")>-1||"object"==typeof e&&e["ag-icon"])return n}const r=document.createElement("span");return r.appendChild(n),r}function mr(t,i,e,n){let r=null;const s=e&&e.getColDef().icons;if(s&&(r=s[t]),i&&!r){const e=i.get("icons");e&&(r=e[t])}if(!r){const i=document.createElement("span");let e=fr[t];return e||(n?e=t:(console.warn("AG Grid: Did not find icon "+t),e="")),i.setAttribute("class","ag-icon ag-icon-"+e),i.setAttribute("unselectable","on"),_i(i,"presentation"),i}{let e;if("function"==typeof r)e=r();else{if("string"!=typeof r)throw new Error("icon from grid options needs to be a string or a function");e=r}if("string"==typeof e)return Un(e);if(cr(e))return e;console.warn("AG Grid: iconRenderer should return back a string or a dom object")}}class A{}A.BACKSPACE="Backspace",A.TAB="Tab",A.ENTER="Enter",A.ESCAPE="Escape",A.SPACE=" ",A.LEFT="ArrowLeft",A.UP="ArrowUp",A.RIGHT="ArrowRight",A.DOWN="ArrowDown",A.DELETE="Delete",A.F2="F2",A.PAGE_UP="PageUp",A.PAGE_DOWN="PageDown",A.PAGE_HOME="Home",A.PAGE_END="End",A.A="KeyA",A.C="KeyC",A.D="KeyD",A.V="KeyV",A.X="KeyX",A.Y="KeyY",A.Z="KeyZ";function vr(e){if(e.altKey||e.ctrlKey||e.metaKey)return!1;return 1===e.key.length}function yr(e,t,i,n,r){const s=n?n.getColDef().suppressKeyboardEvent:void 0;if(!s)return!1;const o={event:t,editing:r,column:n,api:e.api,node:i,data:i.data,colDef:n.getColDef(),context:e.context,columnApi:e.columnApi};if(s){if(s(o))return!0}return!1}function br(e,t,i,n){const r=n.getDefinition(),s=r&&r.suppressHeaderKeyboardEvent;if(!_(s))return!1;return!!s({api:e.api,columnApi:e.columnApi,context:e.context,colDef:r,column:n,headerRowIndex:i,event:t})}function Cr(e){const{keyCode:t}=e;let i;switch(t){case 65:i=A.A;break;case 67:i=A.C;break;case 86:i=A.V;break;case 68:i=A.D;break;case 90:i=A.Z;break;case 89:i=A.Y;break;default:i=e.code}return i}function wr(e,t=!1){return e===A.DELETE||!t&&e===A.BACKSPACE&&tn()}function _r(e,t,i){if(0===i)return!1;const n=Math.abs(e.clientX-t.clientX),r=Math.abs(e.clientY-t.clientY);return Math.max(n,r)<=i}function Ar(t,o){if(!t)return!1;const i=(e,t)=>{const i=o[e.id],n=o[t.id],r=void 0!==i,s=void 0!==n;return r&&s?i-n:!r&&!s?e.__objectId-t.__objectId:r?1:-1};let n,r,s=!1;for(let e=0;e<t.length-1;e++)if(n=t[e],r=t[e+1],i(n,r)>0){s=!0;break}return!!s&&(t.sort(i),!0)}function Er(e,n){const r=[];!function i(e){if(!e)return;e.forEach(t=>{if(t.group||t.hasChildren()){r.push(t.key);const e=r.join("|");n(t,e),i(t.childrenAfterGroup),r.pop()}})}(e)}function Sr(e){const t=new Set;return e.forEach(e=>t.add(e)),t}const Tr=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},i),H),j),Y),n),B),$),z),F),q),K),W),X),U),G),Q),Z),V);class xr{constructor(e=0,t=1){this.nextValue=e,this.step=t}next(){const e=this.nextValue;return this.nextValue+=this.step,e}peek(){return this.nextValue}skip(e){this.nextValue+=e}}var Dr;!function(e){e[e.IN_PROGRESS=0]="IN_PROGRESS",e[e.RESOLVED=1]="RESOLVED"}(Dr||(Dr={}));class Rr{constructor(e){this.status=Dr.IN_PROGRESS,this.resolution=null,this.waiters=[],e(e=>this.onDone(e),e=>this.onReject(e))}static all(e){return new Rr(i=>{let n=e.length;const r=new Array(n);e.forEach((e,t)=>{e.then(e=>{r[t]=e,n--,0===n&&i(r)})})})}static resolve(t=null){return new Rr(e=>e(t))}then(i){return new Rr(t=>{this.status===Dr.RESOLVED?t(i(this.resolution)):this.waiters.push(e=>t(i(e)))})}resolveNow(e,t){return this.status===Dr.RESOLVED?t(this.resolution):e}onDone(t){this.status=Dr.RESOLVED,this.resolution=t,this.waiters.forEach(e=>e(t))}onReject(e){console.warn("TBI")}}class Mr{constructor(){this.timestamp=(new Date).getTime()}print(e){const t=(new Date).getTime()-this.timestamp;console.info(`${e} = ${t}`),this.timestamp=(new Date).getTime()}}var Nr,Or=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};!function(e){e[e.NOTHING=0]="NOTHING",e[e.WAITING_TO_SHOW=1]="WAITING_TO_SHOW",e[e.SHOWING=2]="SHOWING"}(Nr||(Nr={}));class Ir extends f{constructor(e){super(),this.DEFAULT_SHOW_TOOLTIP_DELAY=2e3,this.DEFAULT_HIDE_TOOLTIP_DELAY=1e4,this.SHOW_QUICK_TOOLTIP_DIFF=1e3,this.FADE_OUT_TOOLTIP_TIMEOUT=1e3,this.state=Nr.NOTHING,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1,this.parentComp=e}postConstruct(){this.tooltipShowDelay=this.getTooltipDelay("show")||this.DEFAULT_SHOW_TOOLTIP_DELAY,this.tooltipHideDelay=this.getTooltipDelay("hide")||this.DEFAULT_HIDE_TOOLTIP_DELAY,this.tooltipMouseTrack=this.gridOptionsService.is("tooltipMouseTrack");const e=this.parentComp.getGui();this.addManagedListener(e,"mouseenter",this.onMouseEnter.bind(this)),this.addManagedListener(e,"mouseleave",this.onMouseLeave.bind(this)),this.addManagedListener(e,"mousemove",this.onMouseMove.bind(this)),this.addManagedListener(e,"mousedown",this.onMouseDown.bind(this)),this.addManagedListener(e,"keydown",this.onKeyDown.bind(this))}destroy(){this.setToDoNothing(),super.destroy()}onMouseEnter(e){if(nn())return;if(this.state!=Nr.NOTHING)return;const t=this.isLastTooltipHiddenRecently()?200:this.tooltipShowDelay;this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),t),this.lastMouseEvent=e,this.state=Nr.WAITING_TO_SHOW}onMouseLeave(){this.setToDoNothing()}onKeyDown(){this.setToDoNothing()}setToDoNothing(){this.state===Nr.SHOWING&&this.hideTooltip(),this.clearTimeouts(),this.state=Nr.NOTHING}onMouseMove(e){this.lastMouseEvent=e,this.tooltipMouseTrack&&this.state===Nr.SHOWING&&this.tooltipComp&&this.positionTooltipUnderLastMouseEvent()}onMouseDown(){this.setToDoNothing()}getTooltipDelay(e){const t=this.gridOptionsService.getNum("tooltipShowDelay"),i=this.gridOptionsService.getNum("tooltipHideDelay"),n="show"===e?t:i,r=Gt(e);return _(n)?(n<0&&l(()=>console.warn(`AG Grid: tooltip${r}Delay should not be lower than 0`),`tooltip${r}DelayWarn`),Math.max(200,n)):null}hideTooltip(){this.tooltipComp&&(this.destroyTooltipComp(),Ir.lastTooltipHideTime=(new Date).getTime()),this.state=Nr.NOTHING}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const e=this.tooltipPopupDestroyFunc,t=this.tooltipComp;window.setTimeout(()=>{e(),this.getContext().destroyBean(t)},this.FADE_OUT_TOOLTIP_TIMEOUT),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}isLastTooltipHiddenRecently(){return(new Date).getTime()-Ir.lastTooltipHideTime<this.SHOW_QUICK_TOOLTIP_DIFF}showTooltip(){const e=Object.assign({},this.parentComp.getTooltipParams());if(!_(e.value))return void this.setToDoNothing();this.state=Nr.SHOWING,this.tooltipInstanceCount++;const t=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(e).newAgStackInstance().then(t)}newTooltipComponentCallback(e,t){if(this.state!==Nr.SHOWING||this.tooltipInstanceCount!==e)return void this.getContext().destroyBean(t);const i=t.getGui();this.tooltipComp=t,i.classList.contains("ag-tooltip")||i.classList.add("ag-tooltip-custom");const n=this.localeService.getLocaleTextFunc(),r=this.popupService.addPopup({eChild:i,ariaLabel:n("ariaLabelTooltip","Tooltip")});r&&(this.tooltipPopupDestroyFunc=r.hideFunc),this.positionTooltipUnderLastMouseEvent(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.tooltipHideDelay)}positionTooltipUnderLastMouseEvent(){this.popupService.positionPopupUnderMouseEvent({type:"tooltip",mouseEvent:this.lastMouseEvent,ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack})}clearTimeouts(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0),this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}}Or([o("popupService")],Ir.prototype,"popupService",void 0),Or([o("userComponentFactory")],Ir.prototype,"userComponentFactory",void 0),Or([r],Ir.prototype,"postConstruct",null);class Pr{constructor(e){this.cssClassStates={},this.getGui=e}addCssClass(e){const t=(e||"").split(" ");if(t.length>1)return void t.forEach(e=>this.addCssClass(e));if(!0!==this.cssClassStates[e]&&e.length){const t=this.getGui();t&&t.classList.add(e),this.cssClassStates[e]=!0}}removeCssClass(e){const t=(e||"").split(" ");if(t.length>1)return void t.forEach(e=>this.removeCssClass(e));if(!1!==this.cssClassStates[e]&&e.length){const t=this.getGui();t&&t.classList.remove(e),this.cssClassStates[e]=!1}}containsCssClass(e){const t=this.getGui();return!!t&&t.classList.contains(e)}addOrRemoveCssClass(t,i){if(!t)return;if(t.indexOf(" ")>=0){const e=(t||"").split(" ");if(e.length>1)return void e.forEach(e=>this.addOrRemoveCssClass(e,i))}if(this.cssClassStates[t]!==i&&t.length){const e=this.getGui();e&&e.classList.toggle(t,i),this.cssClassStates[t]=i}}}var kr=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};const Lr=new xr;class E extends f{constructor(e){super(),this.displayed=!0,this.visible=!0,this.compId=Lr.next(),this.cssClassManager=new Pr(()=>this.eGui),e&&this.setTemplate(e)}preConstructOnComponent(){this.usingBrowserTooltips=this.gridOptionsService.is("enableBrowserTooltips")}getCompId(){return this.compId}getTooltipParams(){return{value:this.tooltipText,location:"UNKNOWN"}}setTooltip(e){const t=()=>{this.usingBrowserTooltips?this.getGui().removeAttribute("title"):this.tooltipFeature=this.destroyBean(this.tooltipFeature)},i=()=>{this.usingBrowserTooltips?this.getGui().setAttribute("title",this.tooltipText):this.tooltipFeature=this.createBean(new Ir(this))};this.tooltipText!=e&&(this.tooltipText&&t(),null!=e&&(this.tooltipText=e,this.tooltipText&&i()))}createChildComponentsFromTags(i,n){ur(i.childNodes).forEach(t=>{if(!(t instanceof HTMLElement))return;const e=this.createComponentFromElement(t,e=>{e.getGui()&&this.copyAttributesFromNode(t,e.getGui())},n);if(e){if(e.addItems&&t.children.length){this.createChildComponentsFromTags(t,n);const i=Array.prototype.slice.call(t.children);e.addItems(i)}this.swapComponentForNode(e,i,t)}else t.childNodes&&this.createChildComponentsFromTags(t,n)})}createComponentFromElement(e,t,i){const n=e.nodeName,r=i?i[e.getAttribute("ref")]:void 0,s=this.agStackComponentsRegistry.getComponentClass(n);if(s){E.elementGettingCreated=e;const i=new s(r);return i.setParentComponent(this),this.createBean(i,null,t),i}return null}copyAttributesFromNode(e,i){dr(e.attributes,(e,t)=>i.setAttribute(e,t))}swapComponentForNode(e,t,i){const n=e.getGui();t.replaceChild(n,i),t.insertBefore(document.createComment(i.nodeName),n),this.addDestroyFunc(this.destroyBean.bind(this,e)),this.swapInComponentForQuerySelectors(e,i)}swapInComponentForQuerySelectors(t,i){const n=this;this.iterateOverQuerySelectors(e=>{n[e.attributeName]===i&&(n[e.attributeName]=t)})}iterateOverQuerySelectors(i){let n=Object.getPrototypeOf(this);for(;null!=n;){const e=n.__agComponentMetaData,t=xe(n.constructor);e&&e[t]&&e[t].querySelectors&&e[t].querySelectors.forEach(e=>i(e)),n=Object.getPrototypeOf(n)}}activateTabIndex(e){const t=this.gridOptionsService.getNum("tabIndex")||0;e||(e=[]),e.length||e.push(this.getGui()),e.forEach(e=>e.setAttribute("tabindex",t.toString()))}setTemplate(e,t){const i=Un(e);this.setTemplateFromElement(i,t)}setTemplateFromElement(e,t){this.eGui=e,this.eGui.__agComponent=this,this.wireQuerySelectors(),this.getContext()&&this.createChildComponentsFromTags(this.getGui(),t)}createChildComponentsPreConstruct(){this.getGui()&&this.createChildComponentsFromTags(this.getGui())}wireQuerySelectors(){if(!this.eGui)return;const i=this;this.iterateOverQuerySelectors(t=>{const e=e=>i[t.attributeName]=e;if(t.refSelector&&this.getAttribute("ref")===t.refSelector)e(this.eGui);else{const i=this.eGui.querySelector(t.querySelector);i&&e(i.__agComponent||i)}})}getGui(){return this.eGui}getFocusableElement(){return this.eGui}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}queryForHtmlInputElement(e){return this.eGui.querySelector(e)}appendChild(t,i){if(null!=t)if(i||(i=this.eGui),cr(t))i.appendChild(t);else{const e=t;i.appendChild(e.getGui())}}isDisplayed(){return this.displayed}setVisible(t,i={}){if(t!==this.visible){this.visible=t;const{skipAriaHidden:e}=i;Mn(this.eGui,t,{skipAriaHidden:e})}}setDisplayed(i,n={}){if(i!==this.displayed){this.displayed=i;const{skipAriaHidden:e}=n;w(this.eGui,i,{skipAriaHidden:e});const t={type:E.EVENT_DISPLAYED_CHANGED,visible:this.displayed};this.dispatchEvent(t)}}destroy(){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.parentComponent&&(this.parentComponent=void 0);const e=this.eGui;e&&e.__agComponent&&(e.__agComponent=void 0),super.destroy()}addGuiEventListener(e,t,i){this.eGui.addEventListener(e,t,i),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,t))}addCssClass(e){this.cssClassManager.addCssClass(e)}removeCssClass(e){this.cssClassManager.removeCssClass(e)}containsCssClass(e){return this.cssClassManager.containsCssClass(e)}addOrRemoveCssClass(e,t){this.cssClassManager.addOrRemoveCssClass(e,t)}getAttribute(e){const{eGui:t}=this;return t?t.getAttribute(e):null}getRefElement(e){return this.queryForHtmlElement(`[ref="${e}"]`)}}function Fr(e){return Gr.bind(this,e,void 0)}function S(e){return Gr.bind(this,`[ref=${e}]`,e)}function Gr(e,t,i,n,r){null!==e?"number"!=typeof r?function(e,t,i){const n=function(e,t){e.__agComponentMetaData||(e.__agComponentMetaData={});e.__agComponentMetaData[t]||(e.__agComponentMetaData[t]={});return e.__agComponentMetaData[t]}(e,xe(e.constructor));n[t]||(n[t]=[]);n[t].push(i)}(i,"querySelectors",{attributeName:n,querySelector:e,refSelector:t}):console.error("AG Grid: QuerySelector should be on an attribute"):console.error("AG Grid: QuerySelector selector should not be null")}E.EVENT_DISPLAYED_CHANGED="displayedChanged",kr([o("agStackComponentsRegistry")],E.prototype,"agStackComponentsRegistry",void 0),kr([Be],E.prototype,"preConstructOnComponent",null),kr([Be],E.prototype,"createChildComponentsPreConstruct",null);var $r=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Hr extends E{constructor(){super('\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>\n            </div>')}destroy(){super.destroy()}init(e){this.params=e;const t=this.columnModel.getDisplayNameForColumn(e.column,"header",!0),i=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${i("ariaFilterInput","Filter Input")}`)}onParentModelChanged(i){i?this.params.parentFilterInstance(t=>{if(t.getModelAsString){const e=t.getModelAsString(i);this.eFloatingFilterText.setValue(e)}}):this.eFloatingFilterText.setValue("")}}$r([S("eFloatingFilterText")],Hr.prototype,"eFloatingFilterText",void 0),$r([o("columnModel")],Hr.prototype,"columnModel",void 0);class Br{constructor(t,e,i,n){this.alive=!0,this.context=t,this.eParent=n;e.getDateCompDetails(i).newAgStackInstance().then(e=>{this.alive?(this.dateComp=e,e&&(n.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached(),this.tempValue&&e.setDate(this.tempValue),null!=this.disabled&&this.setDateCompDisabled(this.disabled))):t.destroyBean(e)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){this.dateComp?this.dateComp.setDate(e):this.tempValue=e}setDisabled(e){this.dateComp?this.setDateCompDisabled(e):this.disabled=e}setDisplayed(e){w(this.eParent,e)}setInputPlaceholder(e){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(e)}setInputAriaLabel(e){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(e)}afterGuiAttached(e){this.dateComp&&"function"==typeof this.dateComp.afterGuiAttached&&this.dateComp.afterGuiAttached(e)}setDateCompDisabled(e){null!=this.dateComp&&null!=this.dateComp.setDisabled&&this.dateComp.setDisabled(e)}}class Vr{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions||t,this.mapCustomOptions(),this.selectDefaultItem(e)}getFilterOptions(){return this.filterOptions}mapCustomOptions(){this.filterOptions&&this.filterOptions.forEach(t=>{if("string"==typeof t)return;[["displayKey"],["displayName"],["predicate","test"]].every(e=>!!e.some(e=>null!=t[e])||(console.warn(`AG Grid: ignoring FilterOptionDef as it doesn't contain one of '${e}'`),!1))?this.customFilterOptions[t.displayKey]=t:this.filterOptions=this.filterOptions.filter(e=>e===t)||[]})}selectDefaultItem(e){if(e.defaultOption)this.defaultOption=e.defaultOption;else if(this.filterOptions.length>=1){const e=this.filterOptions[0];"string"==typeof e?this.defaultOption=e:e.displayKey?this.defaultOption=e.displayKey:console.warn("AG Grid: invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else console.warn("AG Grid: no filter options for filter")}getDefaultOption(){return this.defaultOption}getCustomOption(e){return this.customFilterOptions[e]}}const Wr={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose One",equals:"Equals",notEqual:"Not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"In range",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equals",greaterThanOrEqual:"Greater than or equals",contains:"Contains",notContains:"Not contains",startsWith:"Starts with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"};var zr=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class jr extends f{constructor(e,t={}){super(),this.eFocusableElement=e,this.callbacks=t,this.callbacks=Object.assign({shouldStopEventPropagation:()=>!1,onTabKeyDown:e=>{if(e.defaultPrevented)return;const t=this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e.shiftKey);t&&(t.focus(),e.preventDefault())}},t)}postConstruct(){this.eFocusableElement.classList.add(jr.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedListener(this.eFocusableElement,"focusin",this.callbacks.onFocusIn),this.callbacks.onFocusOut&&this.addManagedListener(this.eFocusableElement,"focusout",this.callbacks.onFocusOut)}addKeyDownListeners(e){this.addManagedListener(e,"keydown",e=>{e.defaultPrevented||bt(e)||(this.callbacks.shouldStopEventPropagation(e)?yt(e):e.key===A.TAB?this.callbacks.onTabKeyDown(e):this.callbacks.handleKeyDown&&this.callbacks.handleKeyDown(e))})}}jr.FOCUS_MANAGED_CLASS="ag-focus-managed",zr([o("focusService")],jr.prototype,"focusService",void 0),zr([r],jr.prototype,"postConstruct",null);var Ur=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Yr extends f{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}center(){const{clientHeight:e,clientWidth:t}=this.offsetParent,i=t/2-this.getWidth()/2,n=e/2-this.getHeight()/2;this.offsetElement(i,n)}initialisePosition(){if(this.positioned)return;const{centered:e,forcePopupParentAsOffsetParent:t,minWidth:i,width:n,minHeight:r,height:s,x:o,y:a}=this.config;this.offsetParent||this.setOffsetParent();let l=0,c=0;const u=!!this.element.offsetParent;if(u){const e=this.findBoundaryElement(),t=window.getComputedStyle(e);if(null!=t.minWidth){const i=e.offsetWidth-this.element.offsetWidth;c=parseInt(t.minWidth,10)-i}if(null!=t.minHeight){const i=e.offsetHeight-this.element.offsetHeight;l=parseInt(t.minHeight,10)-i}}if(this.minHeight=r||l,this.minWidth=i||c,n&&this.setWidth(n),s&&this.setHeight(s),n&&s||this.refreshSize(),e)this.center();else if(o||a)this.offsetElement(o,a);else if(u&&t){let e=this.boundaryEl,t=!0;if(e||(e=this.findBoundaryElement(),t=!1),e){const i=parseFloat(e.style.top),n=parseFloat(e.style.left);t?this.offsetElement(isNaN(n)?0:n,isNaN(i)?0:i):this.setPosition(n,i)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;const i=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragService.addDragSource(i),this.moveElementDragListener=i):(this.dragService.removeDragSource(i),this.moveElementDragListener=void 0)}setResizable(r){if(this.clearResizeListeners(),r?this.addResizers():this.removeResizers(),"boolean"==typeof r){if(!1===r)return;r={topLeft:r,top:r,topRight:r,right:r,bottomRight:r,bottom:r,bottomLeft:r,left:r}}Object.keys(r).forEach(t=>{const e=!!r[t],i=this.getResizerElement(t),n={dragStartPixels:0,eElement:i,onDragStart:e=>this.onResizeStart(e,t),onDragging:this.onResize.bind(this),onDragStop:e=>this.onResizeEnd(e,t)};(e||!this.isAlive()&&!e)&&(e?(this.dragService.addDragSource(n),this.resizeListeners.push(n),i.style.pointerEvents="all"):i.style.pointerEvents="none",this.resizable[t]=e)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;-1!==t&&(this.element.style.width=t+"px"),-1!==e&&(this.element.style.height=e+"px")}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,i=this.element;let n=!1;if("string"==typeof e&&-1!==e.indexOf("%"))ar(i,e),e=Ln(i),n=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const t=this.getAvailableHeight();t&&e>t&&(e=t)}this.getHeight()!==e&&(n?(i.style.maxHeight="unset",i.style.minHeight="unset"):t?ar(i,e):(i.style.height=e+"px",i.style.flex="0 0 auto",this.lastSize.height="number"==typeof e?e:parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:i}=this.offsetParent;if(!i)return null;const n=this.element.getBoundingClientRect(),r=this.offsetParent.getBoundingClientRect(),s=e?this.position.y:n.top,o=e?0:r.top;let a=0;if(t){const e=this.element.parentElement;if(e){const{bottom:t}=e.getBoundingClientRect();a=t-n.bottom}}return i+o-s-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:i}=this.config;let n=!1;if("string"==typeof e&&-1!==e.indexOf("%"))sr(t,e),e=Fn(t),n=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:t}=this.offsetParent,n=i?this.position.x:this.element.getBoundingClientRect().left;t&&e+n>t&&(e=t-n)}this.getWidth()!==e&&(n?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?sr(t,e):(t.style.width=e+"px",t.style.flex=" unset",this.lastSize.width="number"==typeof e?e:parseFloat(e)))}offsetElement(e=0,t=0){const{forcePopupParentAsOffsetParent:i}=this.config,n=i?this.boundaryEl:this.element;n&&(this.popupService.positionPopup({ePopup:n,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t})}),this.setPosition(parseFloat(n.style.left),parseFloat(n.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;const t=()=>{const e=this.getAvailableHeight();this.element.style.setProperty("max-height",e+"px")};e?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),t):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:i,isTop:n,anywhereWithin:r,topBuffer:s}=e,o=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y;return{movementX:this.shouldSkipX(t,!!i,!!r,o)?0:o,movementY:this.shouldSkipY(t,!!n,s,a)?0:a}}shouldSkipX(e,t,i,n){const r=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:r.left;let l=a<=0&&s.left>=e.clientX||s.right<=e.clientX&&s.right<=o.right;return!!l||(l=t?n<0&&e.clientX>a+s.left||n>0&&e.clientX<a+s.left:i?n<0&&e.clientX>o.right||n>0&&e.clientX<a+s.left:n<0&&e.clientX>o.right||n>0&&e.clientX<o.right,l)}shouldSkipY(e,t,i=0,n){const r=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:r.top;let l=a<=0&&s.top>=e.clientY||s.bottom<=e.clientY&&s.bottom<=o.bottom;return!!l||(l=t?n<0&&e.clientY>a+s.top+i||n>0&&e.clientY<a+s.top:n<0&&e.clientY>o.bottom||n>0&&e.clientY<o.bottom,l)}createResizeMap(){const e=this.element;this.resizerMap={topLeft:{element:e.querySelector("[ref=eTopLeftResizer]")},top:{element:e.querySelector("[ref=eTopResizer]")},topRight:{element:e.querySelector("[ref=eTopRightResizer]")},right:{element:e.querySelector("[ref=eRightResizer]")},bottomRight:{element:e.querySelector("[ref=eBottomRightResizer]")},bottom:{element:e.querySelector("[ref=eBottomResizer]")},bottomLeft:{element:e.querySelector("[ref=eBottomLeftResizer]")},left:{element:e.querySelector("[ref=eLeftResizer]")}}}addResizers(){if(this.resizersAdded)return;const e=this.element;if(!e)return;const t=(new DOMParser).parseFromString('<div class="ag-resizer-wrapper">\n        <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>\n        <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>\n        <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>\n        <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>\n        <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>\n        <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>\n        <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>\n        <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>\n    </div>',"text/html").body;e.appendChild(t.firstChild),this.createResizeMap(),this.resizersAdded=!0}removeResizers(){this.resizerMap=void 0;const e=this.element.querySelector(".ag-resizer-wrapper");e&&this.element.removeChild(e),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:i,forcePopupParentAsOffsetParent:n}=this.config;i||n||this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const e=this.element.parentElement;return e?Array.prototype.slice.call(e.children).filter(e=>!e.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const s=this.getSiblings()||[];let o=0,a=0;for(let r=0;r<s.length;r++){const e=s[r],t=!!e.style.flex&&"0 0 auto"!==e.style.flex;if(e===this.element)continue;let i=this.minHeight||0,n=this.minWidth||0;if(t){const s=window.getComputedStyle(e);s.minHeight&&(i=parseInt(s.minHeight,10)),s.minWidth&&(n=parseInt(s.minWidth,10))}else i=e.offsetHeight,n=e.offsetWidth;o+=i,a+=n}return{height:o,width:a}}applySizeToSiblings(i){let n=null;const r=this.getSiblings();if(r){for(let t=0;t<r.length;t++){const e=r[t];e!==n&&(i?e.style.height=e.offsetHeight+"px":e.style.width=e.offsetWidth+"px",e.style.flex="0 0 auto",e===this.element&&(n=r[t+1]))}n&&(n.style.removeProperty("height"),n.style.removeProperty("min-height"),n.style.removeProperty("max-height"),n.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(t){if(!this.isResizing||!this.currentResizer)return;const{popup:i,forcePopupParentAsOffsetParent:n}=this.config,{isTop:r,isRight:e,isBottom:s,isLeft:o}=this.currentResizer,a=e||o,l=s||r,{movementX:c,movementY:u}=this.calculateMouseMovement({e:t,isLeft:o,isTop:r}),d=this.position.x,h=this.position.y;let p=0,f=0;if(a&&c){const t=o?-1:1,i=this.getWidth(),n=i+c*t;let e=!1;o&&(p=i-n,(d+p<=0||n<=this.minWidth)&&(e=!0,p=0)),e||this.setWidth(n)}if(l&&u){const t=r?-1:1,i=this.getHeight(),n=i+u*t;let e=!1;r?(f=i-n,(h+f<=0||n<=this.minHeight)&&(e=!0,f=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&i<n&&this.getMinSizeOfSiblings().height+n>this.element.parentElement.offsetHeight&&(e=!0),e||this.setHeight(n)}this.updateDragStartPosition(t.clientX,t.clientY),((i||n)&&p||f)&&this.offsetElement(d+p,h+f)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null;const i={type:"resize",api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi};this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchEvent(i)}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:i}=this.position;let n;this.config.calculateTopBuffer&&(n=this.config.calculateTopBuffer());const{movementX:r,movementY:s}=this.calculateMouseMovement({e:e,isTop:!0,anywhereWithin:!0,topBuffer:n});this.offsetElement(t+r,i+s),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if("static"!==window.getComputedStyle(e).position)return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const e=this.resizeListeners.pop();this.dragService.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}}Ur([o("popupService")],Yr.prototype,"popupService",void 0),Ur([o("resizeObserverService")],Yr.prototype,"resizeObserverService",void 0),Ur([o("dragService")],Yr.prototype,"dragService",void 0);var qr=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Kr extends E{constructor(e){super(),this.filterNameKey=e,this.applyActive=!1,this.hidePopup=null,this.debouncePending=!1,this.appliedModel=null}postConstruct(){this.resetTemplate(),this.createManagedBean(new jr(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new Yr(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}handleKeyDown(e){}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return!!this.appliedModel}resetTemplate(e){let t=this.getGui();t&&t.removeEventListener("submit",this.onFormSubmit);const i=`\n            <form class="ag-filter-wrapper">\n                <div class="ag-filter-body-wrapper ag-${this.getCssIdentifier()}-body-wrapper" ref="eFilterBody">\n                    ${this.createBodyTemplate()}\n                </div>\n            </form>`;this.setTemplate(i,e),t=this.getGui(),t&&t.addEventListener("submit",this.onFormSubmit)}isReadOnly(){return!!this.providedFilterParams.readOnly}init(e){this.setParams(e),this.resetUiToDefaults(!0).then(()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}setParams(e){this.providedFilterParams=e,this.applyActive=Kr.isUseApplyButton(e),this.createButtonPanel()}createButtonPanel(){const{buttons:e}=this.providedFilterParams;if(!e||e.length<1||this.isReadOnly())return;const r=document.createElement("div");r.classList.add("ag-filter-apply-panel");const t=e=>{let t,i;switch(e){case"apply":t=this.translate("applyFilter"),i=e=>this.onBtApply(!1,!1,e);break;case"clear":t=this.translate("clearFilter"),i=()=>this.onBtClear();break;case"reset":t=this.translate("resetFilter"),i=()=>this.onBtReset();break;case"cancel":t=this.translate("cancelFilter"),i=e=>{this.onBtCancel(e)};break;default:return void console.warn("AG Grid: Unknown button type specified")}const n=Un(`<button\n                    type="${"apply"===e?"submit":"button"}"\n                    ref="${e}FilterButton"\n                    class="ag-button ag-standard-button ag-filter-apply-panel-button"\n                >${t}\n                </button>`);r.appendChild(n),this.addManagedListener(n,"click",i)};Sr(e).forEach(e=>t(e)),this.getGui().appendChild(r)}getDefaultDebounceMs(){return 0}setupOnBtApplyDebounce(){const e=Kr.getDebounceMs(this.providedFilterParams,this.getDefaultDebounceMs()),t=Pe(this.checkApplyDebounce.bind(this),e);this.onBtApplyDebounce=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}getModel(){return this.appliedModel?this.appliedModel:null}setModel(e){return(null!=e?this.setModelIntoUi(e):this.resetUiToDefaults()).then(()=>{this.updateUiVisibility(),this.applyModel("api")})}onBtCancel(e){this.resetUiToActiveModel(this.getModel(),()=>{this.handleCancelEnd(e)})}handleCancelEnd(e){this.providedFilterParams.closeOnApply&&this.close(e)}resetUiToActiveModel(e,t){const i=()=>{this.onUiChanged(!1,"prevent"),null==t||t()};null!=e?this.setModelIntoUi(e).then(i):this.resetUiToDefaults().then(i)}onBtClear(){this.resetUiToDefaults().then(()=>this.onUiChanged())}onBtReset(){this.onBtClear(),this.onBtApply()}applyModel(e="api"){const t=this.getModelFromUi();if(!this.isModelValid(t))return!1;const i=this.appliedModel;return this.appliedModel=t,!this.areModelsEqual(i,t)}isModelValid(e){return!0}onFormSubmit(e){e.preventDefault()}onBtApply(e=!1,t=!1,i){i&&i.preventDefault(),this.applyModel(t?"rowDataUpdated":"ui")&&this.providedFilterParams.filterChangedCallback({afterFloatingFilter:e,afterDataChange:t});const{closeOnApply:n}=this.providedFilterParams;n&&this.applyActive&&!e&&!t&&this.close(i)}onNewRowsLoaded(){}close(e){if(!this.hidePopup)return;const t=e,i=t&&t.key;let n;"Enter"!==i&&"Space"!==i||(n={keyboardEvent:t}),this.hidePopup(n),this.hidePopup=null}onUiChanged(e=!1,t){if(this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){const e=this.isModelValid(this.getModelFromUi());Nn(this.getRefElement("applyFilterButton"),!e)}e&&!t||"immediately"===t?this.onBtApply(e):(this.applyActive||t)&&"debounce"!==t||this.onBtApplyDebounce()}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup),this.refreshFilterResizer(null==e?void 0:e.container)}refreshFilterResizer(e){if(!this.positionableFeature||"toolPanel"===e)return;const t="floatingFilter"===e,{positionableFeature:i,gridOptionsService:n}=this;t?(i.restoreLastSize(),i.setResizable(n.is("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)}static getDebounceMs(e,t){return Kr.isUseApplyButton(e)?(null!=e.debounceMs&&console.warn("AG Grid: debounceMs is ignored when apply button is present"),0):null!=e.debounceMs?e.debounceMs:t}static isUseApplyButton(e){return!!e.buttons&&e.buttons.indexOf("apply")>=0}destroy(){const e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),super.destroy()}translate(e){return this.localeService.getLocaleTextFunc()(e,Wr[e])}getCellValue(t){const{api:e,colDef:i,column:n,columnApi:r,context:s}=this.providedFilterParams;return this.providedFilterParams.valueGetter({api:e,colDef:i,column:n,columnApi:r,context:s,data:t.data,getValue:e=>t.data[e],node:t})}getPositionableElement(){return this.eFilterBody}}qr([o("rowModel")],Kr.prototype,"rowModel",void 0),qr([S("eFilterBody")],Kr.prototype,"eFilterBody",void 0),qr([r],Kr.prototype,"postConstruct",null);var Xr=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Qr extends E{constructor(e,t){super(t),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{}}postConstruct(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:i,labelAlignment:n}=this.config;null!=e&&this.setLabelSeparator(e),null!=t&&this.setLabel(t),null!=i&&this.setLabelWidth(i),this.setLabelAlignment(n||this.labelAlignment),this.refreshLabel()}refreshLabel(){Vn(this.eLabel),"string"==typeof this.label?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),""===this.label?(w(this.eLabel,!1),_i(this.eLabel,"presentation")):(w(this.eLabel,!0),_i(this.eLabel,null))}setLabelSeparator(e){return this.labelSeparator===e||(this.labelSeparator=e,null!=this.label&&this.refreshLabel()),this}getLabelId(){return this.eLabel.id=this.eLabel.id||`ag-${this.getCompId()}-label`,this.eLabel.id}getLabel(){return this.label}setLabel(e){return this.label===e||(this.label=e,this.refreshLabel()),this}setLabelAlignment(e){const t=this.getGui().classList;return t.toggle("ag-label-align-left","left"===e),t.toggle("ag-label-align-right","right"===e),t.toggle("ag-label-align-top","top"===e),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return null==this.label||rr(this.eLabel,e),this}setDisabled(e){e=!!e;const t=this.getGui();return Nn(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}}Xr([r],Qr.prototype,"postConstruct",null);class Zr extends Qr{constructor(e,t,i){super(e,t),this.className=i}postConstruct(){super.postConstruct(),this.className&&this.addCssClass(this.className)}onValueChange(e){return this.addManagedListener(this,Zr.EVENT_CHANGED,()=>e(this.getValue())),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return sr(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e||(this.previousValue=this.value,this.value=e,t||this.dispatchEvent({type:Zr.EVENT_CHANGED})),this}}Zr.EVENT_CHANGED="valueChange";var Jr=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class es extends Zr{constructor(e,t,i,n){super(e,`<div class="ag-picker-field" role="presentation">\n                <div ref="eLabel"></div>\n                <div ref="eWrapper"\n                    class="ag-wrapper ag-picker-field-wrapper"\n                    tabIndex="-1"\n                    aria-expanded="false"\n                    ${n?`role="${n}"`:""}\n                >\n                    <div ref="eDisplayField" class="ag-picker-field-display"></div>\n                    <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                </div>\n            </div>`,t),this.pickerIcon=i,this.isPickerDisplayed=!1,this.isDestroyingPicker=!1,this.skipClick=!1}postConstruct(){super.postConstruct();const e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e),Mi(this.eWrapper,e);const t=()=>{this.skipClick?this.skipClick=!1:this.isDisabled()||(this.pickerComponent=this.showPicker())},i=this.getGui();if(this.addManagedListener(i,"mousedown",e=>{!this.skipClick&&this.pickerComponent&&this.pickerComponent.isAlive()&&jn(this.pickerComponent.getGui())&&i.contains(e.target)&&(this.skipClick=!0)}),this.addManagedListener(i,"keydown",e=>{switch(e.key){case A.UP:case A.DOWN:case A.ENTER:case A.SPACE:t();case A.ESCAPE:this.isPickerDisplayed&&e.preventDefault()}}),this.addManagedListener(this.eWrapper,"click",t),this.addManagedListener(this.eLabel,"click",t),this.pickerIcon){const e=mr(this.pickerIcon,this.gridOptionsService);e&&this.eIcon.appendChild(e)}}refreshLabel(){_(this.getLabel())?Di(this.eWrapper,this.getLabelId()):this.eWrapper.removeAttribute("aria-labelledby"),super.refreshLabel()}setAriaLabel(e){return xi(this.eWrapper,e),this}setInputWidth(e){return rr(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}}Jr([S("eLabel")],es.prototype,"eLabel",void 0),Jr([S("eWrapper")],es.prototype,"eWrapper",void 0),Jr([S("eDisplayField")],es.prototype,"eDisplayField",void 0),Jr([S("eIcon")],es.prototype,"eIcon",void 0);var ts=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class is extends E{constructor(e="default"){super(`<div class="ag-list ag-${e}-list" role="listbox"></div>`),this.cssIdentifier=e,this.options=[],this.itemEls=[]}init(){this.addManagedListener(this.getGui(),"keydown",this.handleKeyDown.bind(this))}handleKeyDown(e){const n=e.key;switch(n){case A.ENTER:if(this.highlightedEl){const e=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(e)}else this.setValue(this.getValue());break;case A.DOWN:case A.UP:const t=n===A.DOWN;let i;if(e.preventDefault(),this.highlightedEl){let e=this.itemEls.indexOf(this.highlightedEl)+(t?1:-1);e=Math.min(Math.max(e,0),this.itemEls.length-1),i=this.itemEls[e]}else i=this.itemEls[t?0:this.itemEls.length-1];this.highlightItem(i)}}addOptions(e){return e.forEach(e=>this.addOption(e)),this}addOption(e){const{value:t,text:i}=e,n=$t(i||t);return this.options.push({value:t,text:n}),this.renderOption(t,n),this.updateIndices(),this}updateIndices(){const i=this.getGui().querySelectorAll(".ag-list-item");i.forEach((e,t)=>{Gi(e,t+1),Fi(e,i.length)})}renderOption(e,t){const i=document.createElement("div");_i(i,"option"),i.classList.add("ag-list-item",`ag-${this.cssIdentifier}-list-item`),i.innerHTML=`<span>${t}</span>`,i.tabIndex=-1,this.itemEls.push(i),this.addManagedListener(i,"mouseover",()=>this.highlightItem(i)),this.addManagedListener(i,"mouseleave",()=>this.clearHighlighted()),this.addManagedListener(i,"click",()=>this.setValue(e)),this.getGui().appendChild(i)}setValue(t,e){if(this.value===t)return this.fireItemSelected(),this;if(null==t)return this.reset(),this;const i=this.options.findIndex(e=>e.value===t);if(-1!==i){const t=this.options[i];this.value=t.value,this.displayValue=null!=t.text?t.text:t.value,this.highlightItem(this.itemEls[i]),e||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const e=this.options.findIndex(e=>e.value===this.value);-1!==e&&this.highlightItem(this.itemEls[e])}reset(){this.value=null,this.displayValue=null,this.clearHighlighted(),this.fireChangeEvent()}highlightItem(e){e.offsetParent&&(this.clearHighlighted(),this.highlightedEl=e,this.highlightedEl.classList.add(is.ACTIVE_CLASS),Yi(this.highlightedEl,!0),this.highlightedEl.focus())}clearHighlighted(){this.highlightedEl&&this.highlightedEl.offsetParent&&(this.highlightedEl.classList.remove(is.ACTIVE_CLASS),Yi(this.highlightedEl,!1),this.highlightedEl=null)}fireChangeEvent(){this.dispatchEvent({type:Zr.EVENT_CHANGED}),this.fireItemSelected()}fireItemSelected(){this.dispatchEvent({type:is.EVENT_ITEM_SELECTED})}}is.EVENT_ITEM_SELECTED="selectedItem",is.ACTIVE_CLASS="ag-active-item",ts([r],is.prototype,"init",null);var ns=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class rs extends es{constructor(e){super(e,"ag-select","smallDown","listbox")}init(){this.listComponent=this.createBean(new is("select")),this.listComponent.setParentComponent(this),this.eWrapper.tabIndex=0,this.listComponent.addManagedListener(this.listComponent,is.EVENT_ITEM_SELECTED,()=>{this.hideList&&this.hideList(),this.dispatchEvent({type:rs.EVENT_ITEM_SELECTED})}),this.listComponent.addManagedListener(this.listComponent,Zr.EVENT_CHANGED,()=>{this.setValue(this.listComponent.getValue(),!1,!0),this.hideList&&this.hideList()})}showPicker(){const t=this.listComponent.getGui(),e=this.gridOptionsService.getDocument(),i=this.addManagedListener(e.body,"wheel",e=>{!t.contains(e.target)&&this.hideList&&this.hideList()}),n=this.addManagedListener(t,"focusout",e=>{!t.contains(e.relatedTarget)&&this.hideList&&this.hideList()}),r=this.localeService.getLocaleTextFunc(),s=this.popupService.addPopup({modal:!0,eChild:t,closeOnEsc:!0,closedCallback:()=>{this.hideList=null,this.isPickerDisplayed=!1,n(),i(),this.isAlive()&&(ki(this.eWrapper,!1),this.getFocusableElement().focus())},ariaLabel:r("ariaLabelSelectField","Select Field")});return s&&(this.hideList=s.hideFunc),this.isPickerDisplayed=!0,rr(t,Fn(this.eWrapper)),ki(this.eWrapper,!0),t.style.maxHeight=Pn(this.popupService.getPopupParent())+"px",t.style.position="absolute",this.popupService.positionPopupByComponent({type:"ag-list",eventSource:this.eWrapper,ePopup:t,position:"under",keepWithinBounds:!0}),this.listComponent.refreshHighlighted(),this.listComponent}addOptions(e){return e.forEach(e=>this.addOption(e)),this}addOption(e){return this.listComponent.addOption(e),this}setValue(e,t,i){if(this.value===e)return this;i||this.listComponent.setValue(e,!0);return this.listComponent.getValue()===this.getValue()?this:(this.eDisplayField.innerHTML=this.listComponent.getDisplayValue(),super.setValue(e,t))}destroy(){this.hideList&&this.hideList(),this.destroyBean(this.listComponent),super.destroy()}}rs.EVENT_ITEM_SELECTED="selectedItem",ns([o("popupService")],rs.prototype,"popupService",void 0),ns([r],rs.prototype,"init",null);var ss=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class os extends Zr{constructor(e,t,i="text",n="input"){super(e,`\n            <div role="presentation">\n                <div ref="eLabel" class="ag-input-field-label"></div>\n                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">\n                    <${n} ref="eInput" class="ag-input-field-input"></${n}>\n                </div>\n            </div>`,t),this.inputType=i,this.displayFieldTag=n}postConstruct(){super.postConstruct(),this.setInputType(),this.eLabel.classList.add(this.className+"-label"),this.eWrapper.classList.add(this.className+"-input-wrapper"),this.eInput.classList.add(this.className+"-input"),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||`ag-${this.getCompId()}-input`;const{width:e,value:t}=this.config;null!=e&&this.setWidth(e),null!=t&&this.setValue(t),this.addInputListeners(),this.activateTabIndex([this.eInput])}refreshLabel(){_(this.getLabel())?Di(this.eInput,this.getLabelId()):this.eInput.removeAttribute("aria-labelledby"),super.refreshLabel()}addInputListeners(){this.addManagedListener(this.eInput,"input",e=>this.setValue(e.target.value))}setInputType(){"input"===this.displayFieldTag&&this.eInput.setAttribute("type",this.inputType)}getInputElement(){return this.eInput}setInputWidth(e){return rr(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){return this.eInput.maxLength=e,this}setInputPlaceholder(e){return hr(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return xi(this.eInput,e),this}setDisabled(e){return Nn(this.eInput,e),super.setDisabled(e)}}ss([S("eLabel")],os.prototype,"eLabel",void 0),ss([S("eWrapper")],os.prototype,"eWrapper",void 0),ss([S("eInput")],os.prototype,"eInput",void 0);class as extends os{constructor(e,t="ag-checkbox",i="checkbox"){super(e,t,i),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}addInputListeners(){this.addManagedListener(this.eInput,"click",this.onCheckboxClick.bind(this)),this.addManagedListener(this.eLabel,"click",this.toggle.bind(this))}getNextValue(){return void 0===this.selected||!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){return this.getInputElement().name=e,this}isSelected(){return this.selected}setSelected(e,t){this.isSelected()!==e&&(this.previousValue=this.isSelected(),e=this.selected="boolean"==typeof e?e:void 0,this.eInput.checked=e,this.eInput.indeterminate=void 0===e,t||this.dispatchChange(this.selected,this.previousValue))}dispatchChange(e,t,i){this.dispatchEvent({type:as.EVENT_CHANGED,selected:e,previousValue:t,event:i});const n=this.getInputElement(),r={type:y.EVENT_CHECKBOX_CHANGED,id:n.id,name:n.name,selected:e,previousValue:t};this.eventService.dispatchEvent(r)}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),i=this.selected=e.target.checked;this.refreshSelectedClass(i),this.dispatchChange(i,t,e)}refreshSelectedClass(e){this.eWrapper.classList.toggle("ag-checked",!0===e),this.eWrapper.classList.toggle("ag-indeterminate",null==e)}}class ls extends as{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedListener(this.eventService,y.EVENT_CHECKBOX_CHANGED,this.onChange.bind(this))}onChange(e){e.selected&&e.name&&this.eInput.name&&this.eInput.name===e.name&&e.id&&this.eInput.id!==e.id&&this.setValue(!1,!0)}}class cs{constructor(e,t){this.localeService=e,this.optionsFactory=t}getModelAsString(r){if(!r)return null;const s=null!=r.operator,o=this.localeService.getLocaleTextFunc();if(s){const s=r;let{conditions:e}=s;if(!e){const{condition1:r,condition2:o}=s;e=[r,o]}const t=e.map(e=>this.getModelAsString(e)),i="AND"===s.operator?"andCondition":"orCondition";return t.join(` ${o(i,Wr[i])} `)}if(r.type===T.BLANK||r.type===T.NOT_BLANK)return o(r.type,r.type);{const s=r,e=this.optionsFactory.getCustomOption(s.type),{displayKey:t,displayName:i,numberOfInputs:n}=e||{};return t&&i&&0===n?(o(t,i),i):this.conditionToString(s,e)}}}class T extends Kr{constructor(){super(...arguments),this.eTypes=[],this.eJoinOperatorPanels=[],this.eJoinOperatorsAnd=[],this.eJoinOperatorsOr=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}getNumberOfInputs(e){const t=this.optionsFactory.getCustomOption(e);if(t){const{numberOfInputs:e}=t;return null!=e?e:1}const i=[T.EMPTY,T.NOT_BLANK,T.BLANK];return e&&i.indexOf(e)>=0?0:e===T.IN_RANGE?2:1}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged(!0)}setTypeFromFloatingFilter(i){this.eTypes.forEach((e,t)=>{0===t?e.setValue(i,!0):e.setValue(this.optionsFactory.getDefaultOption(),!0)})}getModelFromUi(){const e=this.getUiCompleteConditions();return 0===e.length?null:this.maxNumConditions>1&&e.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),condition1:e[0],condition2:e[1],conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){return 0===this.eJoinOperatorsOr.length?this.defaultJoinOperator:!0===this.eJoinOperatorsOr[0].getValue()?"OR":"AND"}areModelsEqual(e,t){if(!e&&!t)return!0;if(!e&&t||e&&!t)return!1;const i=!e.operator,n=!t.operator;if(!i&&n||i&&!n)return!1;let r;if(i){const i=e,n=t;r=this.areSimpleModelsEqual(i,n)}else{const i=e,n=t;r=i.operator===n.operator&&it(i.conditions,n.conditions,(e,t)=>this.areSimpleModelsEqual(e,t))}return r}setModelIntoUi(r){if(r.operator){let e=r;e.conditions||(e.conditions=[e.condition1,e.condition2]);const t=this.validateAndUpdateConditions(e.conditions),i=this.getNumConditions();if(t<i)this.removeConditionsAndOperators(t);else if(t>i)for(let e=i;e<t;e++)this.createJoinOperatorPanel(),this.createOption();const n="OR"===e.operator;this.eJoinOperatorsAnd.forEach(e=>e.setValue(!n,!0)),this.eJoinOperatorsOr.forEach(e=>e.setValue(n,!0)),e.conditions.forEach((e,t)=>{this.eTypes[t].setValue(e.type,!0),this.setConditionIntoUi(e,t)})}else{const e=r;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(e.type,!0),this.setConditionIntoUi(e,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),Rr.resolve()}validateAndUpdateConditions(e){let t=e.length;return t>this.maxNumConditions&&(e.splice(this.maxNumConditions),l(()=>console.warn('AG Grid: Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.'),"simpleFilterSetModelMaxNumConditions"),t=this.maxNumConditions),t}doesFilterPass(t){var e;const i=this.getModel();if(null==i)return!0;const{operator:n}=i,r=[];if(n){const t=i;r.push(...null!==(e=t.conditions)&&void 0!==e?e:[])}else r.push(i);return r[n&&"OR"===n?"some":"every"](e=>this.individualConditionPasses(t,e))}setParams(e){super.setParams(e),this.setNumConditions(e),this.defaultJoinOperator=this.getDefaultJoinOperator(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.optionsFactory=new Vr,this.optionsFactory.init(e,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators()}setNumConditions(e){var t,i;null!=e.suppressAndOrCondition&&l(()=>console.warn('AG Grid: Since v29.2 "filterParams.suppressAndOrCondition" is deprecated. Use "filterParams.maxNumConditions = 1" instead.'),"simpleFilterSuppressAndOrCondition"),null!=e.alwaysShowBothConditions&&l(()=>console.warn('AG Grid: Since v29.2 "filterParams.alwaysShowBothConditions" is deprecated. Use "filterParams.numAlwaysVisibleConditions = 2" instead.'),"simpleFilterAlwaysShowBothConditions"),this.maxNumConditions=null!==(t=e.maxNumConditions)&&void 0!==t?t:e.suppressAndOrCondition?1:2,this.maxNumConditions<1&&(l(()=>console.warn('AG Grid: "filterParams.maxNumConditions" must be greater than or equal to zero.'),"simpleFilterMaxNumConditions"),this.maxNumConditions=1),this.numAlwaysVisibleConditions=null!==(i=e.numAlwaysVisibleConditions)&&void 0!==i?i:e.alwaysShowBothConditions?2:1,this.numAlwaysVisibleConditions<1&&(l(()=>console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.'),"simpleFilterNumAlwaysVisibleConditions"),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(l(()=>console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".'),"simpleFilterNumAlwaysVisibleGreaterThanMaxNumConditions"),this.numAlwaysVisibleConditions=this.maxNumConditions)}createOption(){const e=this.createManagedBean(new rs);this.eTypes.push(e),e.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(e.getGui());const t=this.createValueElement();this.eConditionBodies.push(t),this.eFilterBody.appendChild(t),this.putOptionsIntoDropdown(e),this.resetType(e);const i=this.getNumConditions()-1;this.forEachPositionInput(i,e=>this.resetInput(e)),this.addChangedListeners(e,i)}createJoinOperatorPanel(){const e=document.createElement("div");this.eJoinOperatorPanels.push(e),e.classList.add("ag-filter-condition");const t=this.createJoinOperator(this.eJoinOperatorsAnd,e,"and"),i=this.createJoinOperator(this.eJoinOperatorsOr,e,"or");this.eFilterBody.appendChild(e);const n=this.eJoinOperatorPanels.length-1,r=this.joinOperatorId++;this.resetJoinOperatorAnd(t,n,r),this.resetJoinOperatorOr(i,n,r),this.isReadOnly()||(t.onValueChange(this.listener),i.onValueChange(this.listener))}createJoinOperator(e,t,i){const n=this.createManagedBean(new ls);return e.push(n),n.addCssClass("ag-filter-condition-operator"),n.addCssClass("ag-filter-condition-operator-"+i),t.appendChild(n.getGui()),n}getDefaultJoinOperator(e){return"AND"===e||"OR"===e?e:"AND"}createFilterListOptions(){const e=this.optionsFactory.getFilterOptions();this.filterListOptions=e.map(e=>"string"==typeof e?this.createBoilerplateListOption(e):this.createCustomListOption(e))}putOptionsIntoDropdown(t){this.filterListOptions.forEach(e=>{t.addOption(e)}),t.setDisabled(this.filterListOptions.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){const{displayKey:t}=e,i=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:i?this.localeService.getLocaleTextFunc()(i.displayKey,i.displayName):this.translate(t)}}isAllowTwoConditions(){return this.maxNumConditions>=2}createBodyTemplate(){return""}getCssIdentifier(){return"simple-filter"}updateUiVisibility(){const e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){var t;let i=-1,n=!0;for(let e=0;e<this.getNumConditions();e++)this.isConditionUiComplete(e)?i=e:n=!1;if(this.shouldAddNewConditionAtEnd(n))this.createJoinOperatorPanel(),this.createOption();else{const n=null!==(t=this.lastUiCompletePosition)&&void 0!==t?t:this.getNumConditions()-2;if(i<n){this.removeConditionsAndOperators(n+1);const t=i+1,e=n-t;e>0&&this.removeConditionsAndOperators(t,e),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=i}updateConditionStatusesAndValues(r,e){this.eTypes.forEach((e,t)=>{const i=this.isConditionDisabled(t,r);e.setDisabled(i||this.filterListOptions.length<=1),1===t&&(Nn(this.eJoinOperatorPanels[0],i),this.eJoinOperatorsAnd[0].setDisabled(i),this.eJoinOperatorsOr[0].setDisabled(i))}),this.eConditionBodies.forEach((e,t)=>{w(e,this.isConditionBodyVisible(t))});const i="OR"===(null!=e?e:this.getJoinOperator());this.eJoinOperatorsAnd.forEach((e,t)=>{e.setValue(!i,!0)}),this.eJoinOperatorsOr.forEach((e,t)=>{e.setValue(i,!0)}),this.forEachInput((e,t,i,n)=>{this.setElementDisplayed(e,t<n),this.setElementDisabled(e,this.isConditionDisabled(i,r))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;this.removeComponents(this.eTypes,e,t),this.removeElements(this.eConditionBodies,e,t),this.removeValueElements(e,t);const i=Math.max(e-1,0);this.removeElements(this.eJoinOperatorPanels,i,t),this.removeComponents(this.eJoinOperatorsAnd,i,t),this.removeComponents(this.eJoinOperatorsOr,i,t)}removeElements(e,t,i){this.removeItems(e,t,i).forEach(e=>zn(e))}removeComponents(e,t,i){this.removeItems(e,t,i).forEach(e=>{zn(e.getGui()),this.destroyBean(e)})}removeItems(e,t,i){return null==i?e.splice(t):e.splice(t,i)}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!e||!e.suppressFocus&&!this.isReadOnly()){const e=this.getInputs(0)[0];if(!e)return;e instanceof os&&e.getInputElement().focus()}}afterGuiDetached(){super.afterGuiDetached();const e=this.getModel();this.areModelsEqual(e,this.getModelFromUi())&&!this.hasInvalidInputs()||this.resetUiToActiveModel(e);let t=-1,i=-1,n=!1;const r=this.getJoinOperator();for(let e=this.getNumConditions()-1;e>=0;e--)if(this.isConditionUiComplete(e))-1===t&&(t=e,i=e);else{const r=e<t;(e>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(e-1)||r)&&(this.removeConditionsAndOperators(e,1),n=!0,r&&i--)}let s=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),s=!0),this.shouldAddNewConditionAtEnd(i===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),s=!0),s&&this.updateConditionStatusesAndValues(i,r),n&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=i}getPlaceholderText(t,i){let n=this.translate(t);if(De(this.filterPlaceholder)){const t=this.filterPlaceholder,e=this.eTypes[i].getValue();n=t({filterOptionKey:e,filterOption:this.translate(e),placeholder:n})}else"string"==typeof this.filterPlaceholder&&(n=this.filterPlaceholder);return n}resetPlaceholder(){const o=this.localeService.getLocaleTextFunc();this.forEachInput((e,t,i,n)=>{if(!(e instanceof os))return;const r=0===t&&n>1?"inRangeStart":0===t?"filterOoo":"inRangeEnd",s=0===t&&n>1?o("ariaFilterFromValue","Filter from value"):0===t?o("ariaFilterValue","Filter Value"):o("ariaFilterToValue","Filter to Value");e.setInputPlaceholder(this.getPlaceholderText(r,i)),e.setInputAriaLabel(s)})}setElementValue(e,t){e instanceof os&&e.setValue(null!=t?String(t):null,!0)}setElementDisplayed(e,t){e instanceof E&&w(e.getGui(),t)}setElementDisabled(e,t){e instanceof E&&Nn(e.getGui(),t)}attachElementOnChange(e,t){e instanceof os&&e.onValueChange(t)}forEachInput(i){this.getConditionTypes().forEach((e,t)=>{this.forEachPositionTypeInput(t,e,i)})}forEachPositionInput(e,t){const i=this.getConditionType(e);this.forEachPositionTypeInput(e,i,t)}forEachPositionTypeInput(i,e,n){const r=this.getNumberOfInputs(e),s=this.getInputs(i);for(let t=0;t<s.length;t++){const e=s[t];null!=e&&n(e,t,i,r)}}isConditionDisabled(e,t){return!!this.isReadOnly()||0!==e&&e>t+1}isConditionBodyVisible(e){const t=this.getConditionType(e);return this.getNumberOfInputs(t)>0}isConditionUiComplete(e){if(e>=this.getNumConditions())return!1;return this.getConditionType(e)!==T.EMPTY&&!this.getValues(e).some(e=>null==e)}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const t=[];for(let e=0;e<this.getNumConditions();e++)this.isConditionUiComplete(e)&&t.push(this.createCondition(e));return t}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(e=>this.resetType(e)),this.eJoinOperatorsAnd.forEach((e,t)=>this.resetJoinOperatorAnd(e,t,this.joinOperatorId+t)),this.eJoinOperatorsOr.forEach((e,t)=>this.resetJoinOperatorOr(e,t,this.joinOperatorId+t)),this.joinOperatorId++,this.forEachInput(e=>this.resetInput(e)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,e||this.onUiChanged(),Rr.resolve()}resetType(e){const t=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(t).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,i){this.resetJoinOperator(e,t,this.isDefaultOperator("AND"),this.translate("andCondition"),i)}resetJoinOperatorOr(e,t,i){this.resetJoinOperator(e,t,this.isDefaultOperator("OR"),this.translate("orCondition"),i)}resetJoinOperator(e,t,i,n,r){this.updateJoinOperatorDisabled(e.setValue(i,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${r}`).setLabel(n),t)}updateJoinOperatorsDisabled(){this.eJoinOperatorsAnd.forEach((e,t)=>this.updateJoinOperatorDisabled(e,t)),this.eJoinOperatorsOr.forEach((e,t)=>this.updateJoinOperatorDisabled(e,t))}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,r){const s=this.mapValuesFromModel(e);this.forEachInput((e,t,i,n)=>{i===r&&this.setElementValue(e,null!=s[t]?s[t]:null)})}setValueFromFloatingFilter(r){this.forEachInput((e,t,i,n)=>{this.setElementValue(e,0===t&&0===i?r:null)})}isDefaultOperator(e){return e===this.defaultJoinOperator}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,e=>{this.attachElementOnChange(e,this.listener)}))}individualConditionPasses(e,t){const i=this.getCellValue(e.node),n=this.mapValuesFromModel(t),r=this.optionsFactory.getCustomOption(t.type),s=this.evaluateCustomFilter(r,n,i);return null!=s?s:null==i?this.evaluateNullValue(t.type):this.evaluateNonNullValue(n,i,t,e)}evaluateCustomFilter(e,t,i){if(null==e)return;const{predicate:n}=e;return null==n||t.some(e=>null==e)?void 0:n(t,i)}isBlank(e){return null==e||"string"==typeof e&&0===e.trim().length}hasInvalidInputs(){return!1}}T.EMPTY="empty",T.BLANK="blank",T.NOT_BLANK="notBlank",T.EQUALS="equals",T.NOT_EQUAL="notEqual",T.LESS_THAN="lessThan",T.LESS_THAN_OR_EQUAL="lessThanOrEqual",T.GREATER_THAN="greaterThan",T.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",T.IN_RANGE="inRange",T.CONTAINS="contains",T.NOT_CONTAINS="notContains",T.STARTS_WITH="startsWith",T.ENDS_WITH="endsWith";class x extends T{setParams(e){super.setParams(e),this.scalarFilterParams=e}evaluateNullValue(e){switch(e){case x.EQUALS:case x.NOT_EQUAL:if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case x.GREATER_THAN:case x.GREATER_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case x.LESS_THAN:case x.LESS_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case x.IN_RANGE:if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case x.BLANK:return!0;case x.NOT_BLANK:return!1}return!1}evaluateNonNullValue(e,t,i){const n=this.comparator(),r=null!=e[0]?n(e[0],t):0;switch(i.type){case x.EQUALS:return 0===r;case x.NOT_EQUAL:return 0!==r;case x.GREATER_THAN:return r>0;case x.GREATER_THAN_OR_EQUAL:return r>=0;case x.LESS_THAN:return r<0;case x.LESS_THAN_OR_EQUAL:return r<=0;case x.IN_RANGE:{const i=n(e[1],t);return this.scalarFilterParams.inRangeInclusive?r>=0&&i<=0:r>0&&i<0}case x.BLANK:return this.isBlank(t);case x.NOT_BLANK:return!this.isBlank(t);default:return console.warn('AG Grid: Unexpected type of filter "'+i.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}}}var us=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class ds extends cs{constructor(e,t,i){super(t,i),this.dateFilterParams=e}conditionToString(e,t){const{type:i}=e,{numberOfInputs:n}=t||{},r=i==T.IN_RANGE||2===n,s=En(e.dateFrom),o=En(e.dateTo),a=this.dateFilterParams.inRangeFloatingFilterDateFormat;if(r){return`${null!==s?An(s,a):"null"}-${null!==o?An(o,a):"null"}`}return null!=s?An(s,a):""+i}}class hs extends x{constructor(){super("dateFilter"),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=1e3,this.maxValidYear=1/0}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}mapValuesFromModel(e){const{dateFrom:t,dateTo:i,type:n}=e||{};return[t&&En(t)||null,i&&En(i)||null].slice(0,this.getNumberOfInputs(n))}comparator(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)}defaultComparator(e,t){return null==t||t<e?-1:t>e?1:0}setParams(i){this.dateFilterParams=i,super.setParams(i);const e=(e,t)=>{if(null!=i[e]){if(!isNaN(i[e]))return null==i[e]?t:Number(i[e]);console.warn(`AG Grid: DateFilter ${e} is not a number`)}return t};this.minValidYear=e("minValidYear",1e3),this.maxValidYear=e("maxValidYear",1/0),this.minValidYear>this.maxValidYear&&console.warn("AG Grid: DateFilter minValidYear should be <= maxValidYear"),this.filterModelFormatter=new ds(this.dateFilterParams,this.localeService,this.optionsFactory)}createDateCompWrapper(e){const t=new Br(this.getContext(),this.userComponentFactory,{onDateChanged:()=>this.onUiChanged(),filterParams:this.dateFilterParams},e);return this.addDestroyFunc(()=>t.destroy()),t}setElementValue(e,t){e.setDate(t)}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}getDefaultFilterOptions(){return hs.DEFAULT_FILTER_OPTIONS}createValueElement(){const e=document.createElement("div");return e.classList.add("ag-filter-body"),this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e}createFromToElement(e,t,i,n){const r=document.createElement("div");r.classList.add("ag-filter-"+n),r.classList.add("ag-filter-date-"+n),t.push(r),e.appendChild(r),i.push(this.createDateCompWrapper(r))}removeValueElements(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),this.removeItems(this.eConditionPanelsFrom,e,t),this.removeItems(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,i){this.removeItems(e,t,i).forEach(e=>e.destroy())}isConditionUiComplete(r){if(!super.isConditionUiComplete(r))return!1;const s=e=>null!=e&&e.getUTCFullYear()>=this.minValidYear&&e.getUTCFullYear()<=this.maxValidYear;let o=!0;return this.forEachInput((e,t,i,n)=>{i!==r||!o||t>=n||(o=o&&s(e.getDate()))}),o}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}getFilterType(){return"date"}createCondition(e){const t=this.getConditionType(e),i={},n=this.getValues(e);return n.length>0&&(i.dateFrom=wn(n[0])),n.length>1&&(i.dateTo=wn(n[1])),Object.assign({dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:t},i)}resetPlaceholder(){const e=this.localeService.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),i=e("ariaFilterValue","Filter Value");this.forEachInput(e=>{e.setInputPlaceholder(t),e.setInputAriaLabel(i)})}getInputs(e){return e>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[e],this.dateConditionToComps[e]]}getValues(e){const r=[];return this.forEachPositionInput(e,(e,t,i,n)=>{t<n&&r.push(e.getDate())}),r}getModelAsString(e){var t;return null!==(t=this.filterModelFormatter.getModelAsString(e))&&void 0!==t?t:""}}hs.DEFAULT_FILTER_OPTIONS=[x.EQUALS,x.GREATER_THAN,x.LESS_THAN,x.NOT_EQUAL,x.IN_RANGE,x.BLANK,x.NOT_BLANK],us([o("userComponentFactory")],hs.prototype,"userComponentFactory",void 0);class ps extends E{getDefaultDebounceMs(){return 0}destroy(){super.destroy()}isEventFromFloatingFilter(e){return e&&e.afterFloatingFilter}isEventFromDataChange(e){return null==e?void 0:e.afterDataChange}getLastType(){return this.lastType}isReadOnly(){return this.readOnly}setLastTypeFromModel(e){if(!e)return void(this.lastType=this.optionsFactory.getDefaultOption());let t;if(e.operator){t=e.conditions[0]}else t=e;this.lastType=t.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;const t=e;return this.isTypeEditable(t.type)}init(e){this.optionsFactory=new Vr,this.optionsFactory.init(e.filterParams,this.getDefaultFilterOptions()),this.lastType=this.optionsFactory.getDefaultOption(),this.readOnly=!!e.filterParams.readOnly;const t=this.isTypeEditable(this.lastType);this.setEditable(t)}doesFilterHaveSingleInput(e){const t=this.optionsFactory.getCustomOption(e),{numberOfInputs:i}=t||{};return null==i||1==i}isTypeEditable(e){const t=[T.IN_RANGE,T.EMPTY,T.BLANK,T.NOT_BLANK];return!!e&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(e)&&t.indexOf(e)<0}}var fs=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class gs extends ps{constructor(){super('\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eReadOnlyText"></ag-input-text-field>\n                <div ref="eDateWrapper" style="display: flex;"></div>\n            </div>')}getDefaultFilterOptions(){return hs.DEFAULT_FILTER_OPTIONS}init(e){super.init(e),this.params=e,this.filterParams=e.filterParams,this.createDateComponent();const t=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input")),this.filterModelFormatter=new ds(this.filterParams,this.localeService,this.optionsFactory)}setEditable(e){w(this.eDateWrapper,e),w(this.eReadOnlyText.getGui(),!e)}onParentModelChanged(e,t){if(this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t))return;super.setLastTypeFromModel(e);const i=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(i),i){if(e){const t=e;this.dateComp.setDate(En(t.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}onDateChanged(){const i=wn(this.dateComp.getDate());this.params.parentFilterInstance(t=>{if(t){const e=En(i);t.onFloatingFilterChanged(this.getLastType()||null,e)}})}createDateComponent(){const e=Kr.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),t={onDateChanged:Pe(this.onDateChanged.bind(this),e),filterParams:this.params.column.getColDef().filterParams};this.dateComp=new Br(this.getContext(),this.userComponentFactory,t,this.eDateWrapper),this.addDestroyFunc(()=>this.dateComp.destroy())}getFilterModelFormatter(){return this.filterModelFormatter}}fs([o("userComponentFactory")],gs.prototype,"userComponentFactory",void 0),fs([S("eReadOnlyText")],gs.prototype,"eReadOnlyText",void 0),fs([S("eDateWrapper")],gs.prototype,"eDateWrapper",void 0);var ms=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class vs extends E{constructor(){super('\n            <div class="ag-filter-filter">\n                <ag-input-text-field class="ag-date-filter" ref="eDateInput"></ag-input-text-field>\n            </div>')}destroy(){super.destroy()}init(t){const i=this.gridOptionsService.getDocument(),e=this.eDateInput.getInputElement(),n=this.shouldUseBrowserDatePicker(t);n&&(e.type="date");const r=n&&Qi();this.addManagedListener(e,"mousedown",()=>{this.eDateInput.isDisabled()||r||e.focus()}),this.addManagedListener(e,"input",e=>{e.target===i.activeElement&&(this.eDateInput.isDisabled()||t.onDateChanged())});const{minValidYear:s,maxValidYear:o}=t.filterParams||{};s&&(e.min=s+"-01-01"),o&&(e.max=o+"-12-31")}getDate(){return En(this.eDateInput.getValue())}setDate(e){this.eDateInput.setValue(wn(e,!1))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){e&&e.suppressFocus||this.eDateInput.getInputElement().focus()}shouldUseBrowserDatePicker(e){return e.filterParams&&null!=e.filterParams.browserDatePicker?e.filterParams.browserDatePicker:Ji()||en()||Qi()&&Zi()>=14.1}}ms([S("eDateInput")],vs.prototype,"eDateInput",void 0);class ys extends os{constructor(e,t="ag-text-field",i="text"){super(e,t,i)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){const i=super.setValue(e,t);return this.eInput.value!==e&&(this.eInput.value=_(e)?e:""),i}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){const n=new RegExp(`[${this.config.allowedCharPattern}]`);this.addManagedListener(this.eInput,"keydown",e=>{vr(e)&&e.key&&!n.test(e.key)&&e.preventDefault()}),this.addManagedListener(this.eInput,"paste",e=>{var t;const i=null===(t=e.clipboardData)||void 0===t?void 0:t.getData("text");i&&i.split("").some(e=>!n.test(e))&&e.preventDefault()})}}class bs extends ys{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct(),this.addManagedListener(this.eInput,"blur",()=>{const e=parseFloat(this.eInput.value),t=isNaN(e)?"":this.normalizeValue(e.toString());this.value!==t&&this.setValue(t)}),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this)),this.eInput.step="any"}onWheel(e){document.activeElement===this.eInput&&e.preventDefault()}normalizeValue(e){if(""===e)return"";null!=this.precision&&(e=this.adjustPrecision(e));const t=parseFloat(e);return null!=this.min&&t<this.min?e=this.min.toString():null!=this.max&&t>this.max&&(e=this.max.toString()),e}adjustPrecision(e,t){if(null==this.precision)return e;if(t){const t=parseFloat(e).toFixed(this.precision);return parseFloat(t).toString()}const i=String(e).split(".");if(i.length>1){if(i[1].length<=this.precision)return e;if(this.precision>0)return`${i[0]}.${i[1].slice(0,this.precision)}`}return i[0]}setMin(e){return this.min===e||(this.min=e,hr(this.eInput,"min",e)),this}setMax(e){return this.max===e||(this.max=e,hr(this.eInput,"max",e)),this}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e||(this.step=e,hr(this.eInput,"step",e)),this}setValue(e,t){return this.setValueOrInputValue(e=>super.setValue(e,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(e=>super.setValue(e,!0),e=>{this.eInput.value=e},e)}setValueOrInputValue(t,i,n){if(_(n)){let e=this.isScientificNotation(n);if(e&&this.eInput.validity.valid)return t(n);if(!e){e=(n=this.adjustPrecision(n))!=this.normalizeValue(n)}if(e)return i(n)}return t(n)}getValue(){if(!this.eInput.validity.valid)return;const e=this.eInput.value;return this.isScientificNotation(e)?this.adjustPrecision(e,!0):super.getValue()}isScientificNotation(e){return"string"==typeof e&&e.includes("e")}}class Cs extends cs{conditionToString(e,t){const{numberOfInputs:i}=t||{};return e.type==T.IN_RANGE||2===i?`${e.filter}-${e.filterTo}`:null!=e.filter?""+e.filter:""+e.type}}function ws(e){const{allowedCharPattern:t}=null!=e?e:{};return null!=t?t:null}class _s extends x{constructor(){super("numberFilter"),this.eValuesFrom=[],this.eValuesTo=[]}mapValuesFromModel(e){const{filter:t,filterTo:i,type:n}=e||{};return[this.processValue(t),this.processValue(i)].slice(0,this.getNumberOfInputs(n))}getDefaultDebounceMs(){return 500}comparator(){return(e,t)=>e===t?0:e<t?1:-1}setParams(e){this.numberFilterParams=e,super.setParams(e),this.filterModelFormatter=new Cs(this.localeService,this.optionsFactory)}getDefaultFilterOptions(){return _s.DEFAULT_FILTER_OPTIONS}createValueElement(){const e=ws(this.numberFilterParams),t=document.createElement("div");return t.classList.add("ag-filter-body"),_i(t,"presentation"),this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,i,n){const r=this.createManagedBean(n?new ys({allowedCharPattern:n}):new bs);r.addCssClass("ag-filter-"+i),r.addCssClass("ag-filter-filter"),t.push(r),e.appendChild(r.getGui())}removeValueElements(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}getValues(e){const r=[];return this.forEachPositionInput(e,(e,t,i,n)=>{t<n&&r.push(this.processValue(this.stringToFloat(e.getValue())))}),r}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getFilterType(){return"number"}processValue(e){return null==e||isNaN(e)?null:e}stringToFloat(e){if("number"==typeof e)return e;let t=J(e);return null!=t&&""===t.trim()&&(t=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(t):null==t||"-"===t.trim()?null:parseFloat(t)}createCondition(e){const t=this.getConditionType(e),i={filterType:this.getFilterType(),type:t},n=this.getValues(e);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getModelAsString(e){var t;return null!==(t=this.filterModelFormatter.getModelAsString(e))&&void 0!==t?t:""}hasInvalidInputs(){let t=!1;return this.forEachInput(e=>{e.getInputElement().validity.valid||(t=!0)}),t}}_s.DEFAULT_FILTER_OPTIONS=[x.EQUALS,x.NOT_EQUAL,x.LESS_THAN,x.LESS_THAN_OR_EQUAL,x.GREATER_THAN,x.GREATER_THAN_OR_EQUAL,x.IN_RANGE,x.BLANK,x.NOT_BLANK];class As extends cs{conditionToString(e,t){const{numberOfInputs:i}=t||{};return e.type==T.IN_RANGE||2===i?`${e.filter}-${e.filterTo}`:null!=e.filter?""+e.filter:""+e.type}}class Es extends T{constructor(){super("textFilter"),this.eValuesFrom=[],this.eValuesTo=[]}static trimInput(e){const t=e&&e.trim();return""===t?e:t}getDefaultDebounceMs(){return 500}setParams(e){this.textFilterParams=e,super.setParams(e),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?Es.DEFAULT_FORMATTER:Es.DEFAULT_LOWERCASE_FORMATTER),this.filterModelFormatter=new As(this.localeService,this.optionsFactory)}getTextMatcher(){const n=this.textFilterParams.textCustomComparator;return n?(Tr.doOnce(()=>console.warn("AG Grid - textCustomComparator is deprecated, use textMatcher instead."),"textCustomComparator.deprecated"),({filterOption:e,value:t,filterText:i})=>n(e,t,i)):this.textFilterParams.textMatcher||Es.DEFAULT_MATCHER}createCondition(e){const t=this.getConditionType(e),i={filterType:this.getFilterType(),type:t},n=this.getValues(e);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i}getFilterType(){return"text"}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getValues(e){const r=[];return this.forEachPositionInput(e,(e,t,i,n)=>{if(t<n){const t=J(e.getValue()),i=(this.textFilterParams.trimInput?Es.trimInput(t):t)||null;r.push(i),e.setValue(i,!0)}}),r}getDefaultFilterOptions(){return Es.DEFAULT_FILTER_OPTIONS}createValueElement(){const e=document.createElement("div");return e.classList.add("ag-filter-body"),_i(e,"presentation"),this.createFromToElement(e,this.eValuesFrom,"from"),this.createFromToElement(e,this.eValuesTo,"to"),e}createFromToElement(e,t,i){const n=this.createManagedBean(new ys);n.addCssClass("ag-filter-"+i),n.addCssClass("ag-filter-filter"),t.push(n),e.appendChild(n.getGui())}removeValueElements(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}mapValuesFromModel(e){const{filter:t,filterTo:i,type:n}=e||{};return[t||null,i||null].slice(0,this.getNumberOfInputs(n))}evaluateNullValue(e){const t=[T.NOT_EQUAL,T.NOT_CONTAINS,T.BLANK];return!!e&&t.indexOf(e)>=0}evaluateNonNullValue(e,t,i,n){const r=e.map(e=>this.formatter(e))||[],s=this.formatter(t),{api:o,colDef:a,column:l,columnApi:c,context:u,textFormatter:d}=this.textFilterParams;if(i.type===T.BLANK)return this.isBlank(t);if(i.type===T.NOT_BLANK)return!this.isBlank(t);const h={api:o,colDef:a,column:l,columnApi:c,context:u,node:n.node,data:n.data,filterOption:i.type,value:s,textFormatter:d};return r.some(e=>this.matcher(Object.assign(Object.assign({},h),{filterText:e})))}getModelAsString(e){var t;return null!==(t=this.filterModelFormatter.getModelAsString(e))&&void 0!==t?t:""}}Es.DEFAULT_FILTER_OPTIONS=[T.CONTAINS,T.NOT_CONTAINS,T.EQUALS,T.NOT_EQUAL,T.STARTS_WITH,T.ENDS_WITH,T.BLANK,T.NOT_BLANK],Es.DEFAULT_FORMATTER=e=>e,Es.DEFAULT_LOWERCASE_FORMATTER=e=>null==e?null:e.toString().toLowerCase(),Es.DEFAULT_MATCHER=({filterOption:e,value:t,filterText:i})=>{if(null==i)return!1;switch(e){case Es.CONTAINS:return t.indexOf(i)>=0;case Es.NOT_CONTAINS:return t.indexOf(i)<0;case Es.EQUALS:return t===i;case Es.NOT_EQUAL:return t!=i;case Es.STARTS_WITH:return 0===t.indexOf(i);case Es.ENDS_WITH:const e=t.lastIndexOf(i);return e>=0&&e===t.length-i.length;default:return!1}};var Ss=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Ts extends f{constructor(e){super(),this.params=e}setupGui(e){this.eFloatingFilterTextInput=this.createManagedBean(new ys(this.params.config)),this.eFloatingFilterTextInput.setInputAriaLabel(this.params.ariaLabel),e.appendChild(this.eFloatingFilterTextInput.getGui())}setEditable(e){this.eFloatingFilterTextInput.setDisabled(!e)}getValue(){return this.eFloatingFilterTextInput.getValue()}setValue(e,t){this.eFloatingFilterTextInput.setValue(e,t)}addValueChangedListener(e){const t=this.eFloatingFilterTextInput.getGui();this.addManagedListener(t,"input",e),this.addManagedListener(t,"keydown",e)}}class xs extends ps{postConstruct(){this.setTemplate('\n            <div class="ag-floating-filter-input" role="presentation" ref="eFloatingFilterInputContainer"></div>\n        ')}getDefaultDebounceMs(){return 500}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(e)))}init(e){this.params=e;const t=`${this.columnModel.getDisplayNameForColumn(e.column,"header",!0)} ${this.localeService.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`;if(this.floatingFilterInputService=this.createFloatingFilterInputService(t),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer),super.init(e),this.applyActive=Kr.isUseApplyButton(this.params.filterParams),!this.isReadOnly()){const e=Kr.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),t=Pe(this.syncUpWithParentFilter.bind(this),e);this.floatingFilterInputService.addValueChangedListener(t)}}syncUpWithParentFilter(e){const t=e.key===A.ENTER;if(this.applyActive&&!t)return;let i=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(i=Es.trimInput(i),this.floatingFilterInputService.setValue(i,!0)),this.params.parentFilterInstance(e=>{e&&e.onFloatingFilterChanged(this.getLastType()||null,i||null)})}setEditable(e){this.floatingFilterInputService.setEditable(e)}}Ss([o("columnModel")],xs.prototype,"columnModel",void 0),Ss([S("eFloatingFilterInputContainer")],xs.prototype,"eFloatingFilterInputContainer",void 0),Ss([r],xs.prototype,"postConstruct",null);class Ds extends f{constructor(e){super(),this.params=e,this.numberInputActive=!0}setupGui(e){this.eFloatingFilterNumberInput=this.createManagedBean(new bs),this.eFloatingFilterTextInput=this.createManagedBean(new ys),this.eFloatingFilterTextInput.setDisabled(!0),this.eFloatingFilterNumberInput.setInputAriaLabel(this.params.ariaLabel),this.eFloatingFilterTextInput.setInputAriaLabel(this.params.ariaLabel),e.appendChild(this.eFloatingFilterNumberInput.getGui()),e.appendChild(this.eFloatingFilterTextInput.getGui())}setEditable(e){this.numberInputActive=e,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput}addValueChangedListener(e){this.setupListeners(this.eFloatingFilterNumberInput.getGui(),e),this.setupListeners(this.eFloatingFilterTextInput.getGui(),e)}setupListeners(e,t){this.addManagedListener(e,"input",t),this.addManagedListener(e,"keydown",t)}}class Rs extends xs{init(e){super.init(e),this.filterModelFormatter=new Cs(this.localeService,this.optionsFactory)}getDefaultFilterOptions(){return _s.DEFAULT_FILTER_OPTIONS}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(e){const t=ws(this.params.filterParams);return t?this.createManagedBean(new Ts({config:{allowedCharPattern:t},ariaLabel:e})):this.createManagedBean(new Ds({ariaLabel:e}))}}class Ms extends xs{init(e){super.init(e),this.filterModelFormatter=new As(this.localeService,this.optionsFactory)}getDefaultFilterOptions(){return Es.DEFAULT_FILTER_OPTIONS}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(e){return this.createManagedBean(new Ts({ariaLabel:e}))}}class D{constructor(e,t=!1){this.destroyFuncs=[],this.touching=!1,this.eventService=new qe,this.eElement=e,this.preventMouseClick=t;const i=this.onTouchStart.bind(this),n=this.onTouchMove.bind(this),r=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",i,{passive:!0}),this.eElement.addEventListener("touchmove",n,{passive:!0}),this.eElement.addEventListener("touchend",r,{passive:!1}),this.destroyFuncs.push(()=>{this.eElement.removeEventListener("touchstart",i,{passive:!0}),this.eElement.removeEventListener("touchmove",n,{passive:!0}),this.eElement.removeEventListener("touchend",r,{passive:!1})})}getActiveTouch(t){for(let e=0;e<t.length;e++){if(t[e].identifier===this.touchStart.identifier)return t[e]}return null}addEventListener(e,t){this.eventService.addEventListener(e,t)}removeEventListener(e,t){this.eventService.removeEventListener(e,t)}onTouchStart(t){if(this.touching)return;this.touchStart=t.touches[0],this.touching=!0,this.moved=!1;const i=this.touchStart;window.setTimeout(()=>{const e=this.touchStart===i;if(this.touching&&e&&!this.moved){this.moved=!0;const i={type:D.EVENT_LONG_TAP,touchStart:this.touchStart,touchEvent:t};this.eventService.dispatchEvent(i)}},500)}onTouchMove(e){if(!this.touching)return;const t=this.getActiveTouch(e.touches);if(!t)return;!_r(t,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(e){if(this.touching){if(!this.moved){const e={type:D.EVENT_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(e),this.checkForDoubleTap()}this.preventMouseClick&&e.cancelable&&e.preventDefault(),this.touching=!1}}checkForDoubleTap(){const e=(new Date).getTime();if(this.lastTapTime&&this.lastTapTime>0){if(e-this.lastTapTime>D.DOUBLE_TAP_MILLIS){const e={type:D.EVENT_DOUBLE_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(e),this.lastTapTime=null}else this.lastTapTime=e}else this.lastTapTime=e}destroy(){this.destroyFuncs.forEach(e=>e())}}D.EVENT_TAP="tap",D.EVENT_DOUBLE_TAP="doubleTap",D.EVENT_LONG_TAP="longTap",D.DOUBLE_TAP_MILLIS=500;var Ns=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Os extends E{constructor(e){super(),e||this.setTemplate(Os.TEMPLATE)}attachCustomElements(e,t,i,n,r){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=i,this.eSortMixed=n,this.eSortNone=r}setupSort(e,t=!1){this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator();!!this.column.getColDef().sortable&&(this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e),this.addManagedListener(this.eventService,y.EVENT_SORT_CHANGED,()=>this.onSortChanged()),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.onSortChanged()),this.onSortChanged())}addInIcon(e,t,i){if(null==t)return;const n=mr(e,this.gridOptionsService,i);n&&t.appendChild(n)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const i=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){const e="asc"===i;w(this.eSortAsc,e,{skipAriaHidden:!0})}if(this.eSortDesc){const e="desc"===i;w(this.eSortDesc,e,{skipAriaHidden:!0})}if(this.eSortNone){const e=!this.column.getColDef().unSortIcon&&!this.gridOptionsService.is("unSortIcon"),t=null==i;w(this.eSortNone,!e&&t,{skipAriaHidden:!0})}}setupMultiSortIndicator(){this.addInIcon("sortUnSort",this.eSortMixed,this.column);const e=this.column.getColDef().showRowGroup;this.gridOptionsService.isColumnsSortingCoupledToGroup()&&e&&(this.addManagedListener(this.eventService,y.EVENT_SORT_CHANGED,()=>this.updateMultiSortIndicator()),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.updateMultiSortIndicator()),this.updateMultiSortIndicator())}updateMultiSortIndicator(){if(this.eSortMixed){const e="mixed"===this.sortController.getDisplaySortForColumn(this.column);w(this.eSortMixed,e,{skipAriaHidden:!0})}}updateSortOrder(){var e;if(!this.eSortOrder)return;const t=this.sortController.getColumnsWithSortingOrdered(),i=null!==(e=this.sortController.getDisplaySortIndexForColumn(this.column))&&void 0!==e?e:-1,n=t.some(e=>{var t;return null!==(t=this.sortController.getDisplaySortIndexForColumn(e))&&void 0!==t&&t}),r=i>=0&&n;w(this.eSortOrder,r,{skipAriaHidden:!0}),i>=0?this.eSortOrder.innerHTML=(i+1).toString():Vn(this.eSortOrder)}}Os.TEMPLATE='<span class="ag-sort-indicator-container">\n            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"></span>\n        </span>',Ns([S("eSortOrder")],Os.prototype,"eSortOrder",void 0),Ns([S("eSortAsc")],Os.prototype,"eSortAsc",void 0),Ns([S("eSortDesc")],Os.prototype,"eSortDesc",void 0),Ns([S("eSortMixed")],Os.prototype,"eSortMixed",void 0),Ns([S("eSortNone")],Os.prototype,"eSortNone",void 0),Ns([o("columnModel")],Os.prototype,"columnModel",void 0),Ns([o("sortController")],Os.prototype,"sortController",void 0);var Is=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Ps extends E{constructor(){super(...arguments),this.lastMovingChanged=0}destroy(){super.destroy()}refresh(e){return this.params=e,this.workOutTemplate()==this.currentTemplate&&(this.workOutShowMenu()==this.currentShowMenu&&(this.workOutSort()==this.currentSort&&(this.setDisplayName(e),!0)))}workOutTemplate(){let e=et(this.params.template,Ps.TEMPLATE);return e=e&&e.trim?e.trim():e,e}init(e){this.params=e,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate),this.setupTap(),this.setupIcons(e.column),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setDisplayName(e)}setDisplayName(t){if(this.currentDisplayName!=t.displayName){this.currentDisplayName=t.displayName;const e=$t(this.currentDisplayName);this.eText&&(this.eText.innerHTML=e)}}setupIcons(e){this.addInIcon("menu",this.eMenu,e),this.addInIcon("filter",this.eFilter,e)}addInIcon(e,t,i){if(null==t)return;const n=mr(e,this.gridOptionsService,i);n&&t.appendChild(n)}setupTap(){const{gridOptionsService:t}=this;if(t.is("suppressTouch"))return;const e=new D(this.getGui(),!0),i=t.is("suppressMenuHide"),n=i&&_(this.eMenu),r=n?new D(this.eMenu,!0):e;if(this.params.enableMenu){const e=n?"EVENT_TAP":"EVENT_LONG_TAP",i=e=>{t.api.showColumnMenuAfterMouseClick(this.params.column,e.touchStart)};this.addManagedListener(r,D[e],i)}if(this.params.enableSorting){const t=e=>{const t=e.touchStart.target;i&&this.eMenu.contains(t)||this.sortController.progressSort(this.params.column,!1,"uiColumnSorted")};this.addManagedListener(e,D.EVENT_TAP,t)}this.addDestroyFunc(()=>e.destroy()),n&&this.addDestroyFunc(()=>r.destroy())}workOutShowMenu(){const e=!this.gridOptionsService.is("suppressMenuHide"),t=nn()&&e;return this.params.enableMenu&&!t}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu)return void zn(this.eMenu);const e=this.gridOptionsService.is("suppressMenuHide");this.addManagedListener(this.eMenu,"click",()=>this.showMenu(this.eMenu)),this.eMenu.classList.toggle("ag-header-menu-always-show",e)}showMenu(e){e||(e=this.eMenu),this.menuFactory.showMenuAfterButtonClick(this.params.column,e,"columnMenu")}workOutSort(){return this.params.enableSorting}setupSort(){if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.context.createBean(new Os(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),!this.currentSort)return;const n="ctrl"===this.gridOptionsService.get("multiSortKey");this.addManagedListener(this.params.column,d.EVENT_MOVING_CHANGED,()=>{this.lastMovingChanged=(new Date).getTime()}),this.eLabel&&this.addManagedListener(this.eLabel,"click",e=>{const t=this.params.column.isMoving(),i=(new Date).getTime()-this.lastMovingChanged<50;if(!(t||i)){const t=n?e.ctrlKey||e.metaKey:e.shiftKey;this.params.progressSort(t)}});const e=()=>{if(this.addOrRemoveCssClass("ag-header-cell-sorted-asc",this.params.column.isSortAscending()),this.addOrRemoveCssClass("ag-header-cell-sorted-desc",this.params.column.isSortDescending()),this.addOrRemoveCssClass("ag-header-cell-sorted-none",this.params.column.isSortNone()),this.params.column.getColDef().showRowGroup){const e=this.columnModel.getSourceColumnsForGroupColumn(this.params.column),t=!(null==e?void 0:e.every(e=>this.params.column.getSort()==e.getSort()));this.addOrRemoveCssClass("ag-header-cell-sorted-mixed",t)}};this.addManagedListener(this.eventService,y.EVENT_SORT_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,e)}setupFilterIcon(){this.eFilter&&(this.addManagedListener(this.params.column,d.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.onFilterChanged())}onFilterChanged(){const e=this.params.column.isFilterActive();w(this.eFilter,e,{skipAriaHidden:!0})}}Ps.TEMPLATE='<div class="ag-cell-label-container" role="presentation">\n            <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n            <div ref="eLabel" class="ag-header-cell-label" role="presentation">\n                <span ref="eText" class="ag-header-cell-text"></span>\n                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>\n                <ag-sort-indicator ref="eSortIndicator"></ag-sort-indicator>\n            </div>\n        </div>',Is([o("sortController")],Ps.prototype,"sortController",void 0),Is([o("menuFactory")],Ps.prototype,"menuFactory",void 0),Is([o("columnModel")],Ps.prototype,"columnModel",void 0),Is([S("eFilter")],Ps.prototype,"eFilter",void 0),Is([S("eSortIndicator")],Ps.prototype,"eSortIndicator",void 0),Is([S("eMenu")],Ps.prototype,"eMenu",void 0),Is([S("eLabel")],Ps.prototype,"eLabel",void 0),Is([S("eText")],Ps.prototype,"eText",void 0),Is([S("eSortOrder")],Ps.prototype,"eSortOrder",void 0),Is([S("eSortAsc")],Ps.prototype,"eSortAsc",void 0),Is([S("eSortDesc")],Ps.prototype,"eSortDesc",void 0),Is([S("eSortMixed")],Ps.prototype,"eSortMixed",void 0),Is([S("eSortNone")],Ps.prototype,"eSortNone",void 0);var ks=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Ls extends E{constructor(){super(Ls.TEMPLATE)}destroy(){super.destroy()}init(e){this.params=e,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()}checkWarnings(){if(this.params.template){const e="AG Grid: A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)";l(()=>console.warn(e),"HeaderGroupComp.templateNotSupported")}}setupExpandIcons(){this.addInIcon("columnGroupOpened","agOpened"),this.addInIcon("columnGroupClosed","agClosed");const e=e=>{if(bt(e))return;const t=!this.params.columnGroup.isExpanded();this.columnModel.setColumnGroupOpened(this.params.columnGroup.getProvidedColumnGroup(),t,"uiColumnExpanded")};this.addTouchAndClickListeners(this.eCloseIcon,e),this.addTouchAndClickListeners(this.eOpenIcon,e);const t=e=>{yt(e)};this.addManagedListener(this.eCloseIcon,"dblclick",t),this.addManagedListener(this.eOpenIcon,"dblclick",t),this.addManagedListener(this.getGui(),"dblclick",e),this.updateIconVisibility();const i=this.params.columnGroup.getProvidedColumnGroup();this.addManagedListener(i,h.EVENT_EXPANDED_CHANGED,this.updateIconVisibility.bind(this)),this.addManagedListener(i,h.EVENT_EXPANDABLE_CHANGED,this.updateIconVisibility.bind(this))}addTouchAndClickListeners(e,t){const i=new D(e,!0);this.addManagedListener(i,D.EVENT_TAP,t),this.addDestroyFunc(()=>i.destroy()),this.addManagedListener(e,"click",t)}updateIconVisibility(){if(this.params.columnGroup.isExpandable()){const e=this.params.columnGroup.isExpanded();w(this.eOpenIcon,e),w(this.eCloseIcon,!e)}else w(this.eOpenIcon,!1),w(this.eCloseIcon,!1)}addInIcon(e,t){const i=mr(e,this.gridOptionsService,null);i&&this.getRefElement(t).appendChild(i)}addGroupExpandIcon(){if(!this.params.columnGroup.isExpandable())return w(this.eOpenIcon,!1),void w(this.eCloseIcon,!1)}setupLabel(){var e;const{displayName:t,columnGroup:i}=this.params;if(_(t)){const e=$t(t);this.getRefElement("agLabel").innerHTML=e}this.addOrRemoveCssClass("ag-sticky-label",!(null===(e=i.getColGroupDef())||void 0===e?void 0:e.suppressStickyLabel))}}Ls.TEMPLATE='<div class="ag-header-group-cell-label" ref="agContainer" role="presentation">\n            <span ref="agLabel" class="ag-header-group-text" role="presentation"></span>\n            <span ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>\n            <span ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>\n        </div>',ks([o("columnModel")],Ls.prototype,"columnModel",void 0),ks([S("agOpened")],Ls.prototype,"eOpenIcon",void 0),ks([S("agClosed")],Ls.prototype,"eCloseIcon",void 0);class Fs extends E{isPopup(){return!0}setParentComponent(e){e.addCssClass("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}}var Gs=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class $s extends Fs{constructor(){super($s.TEMPLATE)}init(e){this.params=e,this.focusAfterAttached=e.cellStartedEdit,this.eTextArea.setMaxLength(e.maxLength||200).setCols(e.cols||60).setRows(e.rows||10),_(e.value,!0)&&this.eTextArea.setValue(e.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}onKeyDown(e){const t=e.key;(t===A.LEFT||t===A.UP||t===A.RIGHT||t===A.DOWN||e.shiftKey&&t===A.ENTER)&&e.stopPropagation()}afterGuiAttached(){const e=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(e("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()}getValue(){const e=this.eTextArea.getValue();return _(e)||_(this.params.value)?this.params.parseValue(e):this.params.value}}$s.TEMPLATE='<div class="ag-large-text">\n            <ag-input-text-area ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>\n        </div>',Gs([S("eTextArea")],$s.prototype,"eTextArea",void 0);var Hs=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Bs extends Fs{constructor(){super('<div class="ag-cell-edit-wrapper"><ag-select class="ag-cell-editor" ref="eSelect"></ag-select></div>'),this.startedByEnter=!1}init(r){if(this.focusAfterAttached=r.cellStartedEdit,u(r.values))return void console.warn("AG Grid: no values found for select cellEditor");this.startedByEnter=null!=r.eventKey&&r.eventKey===A.ENTER;let s=!1;r.values.forEach(e=>{const t={value:e},i=this.valueFormatterService.formatValue(r.column,null,e),n=null!=i;t.text=n?i:e,this.eSelect.addOption(t),s=s||r.value===e}),s?this.eSelect.setValue(r.value,!0):r.values.length&&this.eSelect.setValue(r.values[0],!0),"fullRow"!==this.gridOptionsService.get("editType")&&this.addManagedListener(this.eSelect,rs.EVENT_ITEM_SELECTED,()=>r.stopEditing())}afterGuiAttached(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&this.eSelect.showPicker()}focusIn(){this.eSelect.getFocusableElement().focus()}getValue(){return this.eSelect.getValue()}isPopup(){return!1}}Hs([o("valueFormatterService")],Bs.prototype,"valueFormatterService",void 0),Hs([S("eSelect")],Bs.prototype,"eSelect",void 0);var Vs=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Ws extends Fs{constructor(e){super(`\n            <div class="ag-cell-edit-wrapper">\n                ${e.getTemplate()}\n            </div>`),this.cellEditorInput=e}init(e){this.params=e;const t=this.eInput;let i;if(this.cellEditorInput.init(t,e),e.cellStartedEdit){this.focusAfterAttached=!0;const t=e.eventKey;t===A.BACKSPACE||e.eventKey===A.DELETE?i="":t&&1===t.length?i=t:(i=this.cellEditorInput.getStartValue(),t!==A.F2&&(this.highlightAllOnFocus=!0))}else this.focusAfterAttached=!1,i=this.cellEditorInput.getStartValue();null!=i&&t.setStartValue(i),this.addManagedListener(t.getGui(),"keydown",e=>{const{key:t}=e;t!==A.PAGE_UP&&t!==A.PAGE_DOWN||e.preventDefault()})}afterGuiAttached(){var e,t;const i=this.localeService.getLocaleTextFunc(),n=this.eInput;if(n.setInputAriaLabel(i("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;Qi()||n.getFocusableElement().focus();const r=n.getInputElement();this.highlightAllOnFocus?r.select():null===(t=(e=this.cellEditorInput).setCaret)||void 0===t||t.call(e)}focusIn(){const e=this.eInput,t=e.getFocusableElement(),i=e.getInputElement();t.focus(),i.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}}Vs([S("eInput")],Ws.prototype,"eInput",void 0);class zs{getTemplate(){return'<ag-input-text-field class="ag-cell-editor" ref="eInput"></ag-input-text-field>'}init(e,t){this.eInput=e,this.params=t,null!=t.maxLength&&e.setMaxLength(t.maxLength)}getValue(){const e=this.eInput.getValue();return _(e)||_(this.params.value)?this.params.parseValue(e):this.params.value}getStartValue(){return this.params.useFormatter||this.params.column.getColDef().refData?this.params.formatValue(this.params.value):this.params.value}setCaret(){const e=this.eInput.getValue(),t=_(e)&&e.length||0;t&&this.eInput.getInputElement().setSelectionRange(t,t)}}class js extends Ws{constructor(){super(new zs)}}var Us=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Ys extends E{constructor(){super(Ys.TEMPLATE),this.refreshCount=0}init(e){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(e)}showDelta(e,t){const i=Math.abs(t),n=e.formatValue(i),r=_(n)?n:i,s=t>=0;this.eDelta.innerHTML=s?"‚Üë"+r:"‚Üì"+r,this.eDelta.classList.toggle("ag-value-change-delta-up",s),this.eDelta.classList.toggle("ag-value-change-delta-down",!s)}setTimerToRemoveDelta(){this.refreshCount++;const e=this.refreshCount;window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),Vn(this.eDelta)}refresh(t){const i=t.value;if(i===this.lastValue)return!1;if(_(t.valueFormatted)?this.eValue.innerHTML=t.valueFormatted:_(t.value)?this.eValue.innerHTML=i:Vn(this.eValue),this.filterManager.isSuppressFlashingCellsBecauseFiltering())return!1;if("number"==typeof i&&"number"==typeof this.lastValue){const e=i-this.lastValue;this.showDelta(t,e)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),this.setTimerToRemoveDelta(),this.lastValue=i,!0}}Ys.TEMPLATE='<span><span class="ag-value-change-delta"></span><span class="ag-value-change-value"></span></span>',Us([o("filterManager")],Ys.prototype,"filterManager",void 0);var qs=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Ks extends E{constructor(){super(Ks.TEMPLATE),this.refreshCount=0,this.eCurrent=this.queryForHtmlElement(".ag-value-slide-current")}init(e){this.refresh(e)}addSlideAnimation(){this.refreshCount++;const e=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious),this.ePrevious=Un('<span class="ag-value-slide-previous ag-value-slide-out"></span>'),this.ePrevious.innerHTML=this.eCurrent.innerHTML,this.getGui().insertBefore(this.ePrevious,this.eCurrent),window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.getGui().removeChild(this.ePrevious),this.ePrevious=null)},3e3)}refresh(e){let t=e.value;return u(t)&&(t=""),t!==this.lastValue&&(!this.filterManager.isSuppressFlashingCellsBecauseFiltering()&&(this.addSlideAnimation(),this.lastValue=t,_(e.valueFormatted)?this.eCurrent.innerHTML=e.valueFormatted:_(e.value)?this.eCurrent.innerHTML=t:Vn(this.eCurrent),!0))}}Ks.TEMPLATE='<span>\n            <span class="ag-value-slide-current"></span>\n        </span>',qs([o("filterManager")],Ks.prototype,"filterManager",void 0);class R{constructor(e){this.rowIndex=null,this.key=null,this.childrenMapped={},this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=R.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=e}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){const i=this.data;this.data=e,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();const n=this.createDataChangedEvent(e,i,t);this.dispatchLocalEvent(n)}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(e,t,i){return{type:R.EVENT_DATA_CHANGED,node:this,oldData:t,newData:e,update:i}}createLocalRowEvent(e){return{type:e,node:this}}getRowIndexString(){return"top"===this.rowPinned?"t-"+this.rowIndex:"bottom"===this.rowPinned?"b-"+this.rowIndex:this.rowIndex.toString()}createDaemonNode(){const e=new R(this.beans);return e.id=this.id,e.data=this.data,e.__daemon=!0,e.selected=this.selected,e.level=this.level,e}setDataAndId(e,t){const i=_(this.id)?this.createDaemonNode():null,n=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),this.beans.selectionService.syncInRowNode(this,i),this.checkRowSelectable();const r=this.createDataChangedEvent(e,n,!1);this.dispatchLocalEvent(r)}checkRowSelectable(){const e=this.beans.gridOptionsService.get("isRowSelectable");this.setRowSelectable(!e||e(this))}setRowSelectable(e){if(this.selectable!==e){this.selectable=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_SELECTABLE_CHANGED));if(this.beans.gridOptionsService.is("groupSelectsChildren")){const e=this.calculateSelectedFromChildren();this.setSelectedParams({newValue:null!=e&&e,source:"selectableChanged"})}}}setId(e){const t=this.beans.gridOptionsService.getCallback("getRowId");if(t)if(this.data){const e=this.getGroupKeys(!0);this.id=t({data:this.data,parentKeys:e.length>0?e:void 0,level:this.level}),null!==this.id&&"string"==typeof this.id&&this.id.startsWith(R.ID_PREFIX_ROW_GROUP)&&console.error(`AG Grid: Row IDs cannot start with ${R.ID_PREFIX_ROW_GROUP}, this is a reserved prefix for AG Grid's row grouping feature.`),null!==this.id&&"string"!=typeof this.id&&(this.id=""+this.id)}else this.id=void 0;else this.id=e}getGroupKeys(e=!1){const t=[];let i=this;for(e&&(i=i.parent);i&&i.level>=0;)t.push(i.key),i=i.parent;return t.reverse(),t}isPixelInRange(e){return!(!_(this.rowTop)||!_(this.rowHeight))&&(e>=this.rowTop&&e<this.rowTop+this.rowHeight)}setFirstChild(e){this.firstChild!==e&&(this.firstChild=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_FIRST_CHILD_CHANGED)))}setLastChild(e){this.lastChild!==e&&(this.lastChild=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_LAST_CHILD_CHANGED)))}setChildIndex(e){this.childIndex!==e&&(this.childIndex=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_CHILD_INDEX_CHANGED)))}setRowTop(e){this.oldRowTop=this.rowTop,this.rowTop!==e&&(this.rowTop=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_TOP_CHANGED)),this.setDisplayed(null!==e))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setDisplayed(e){this.displayed!==e&&(this.displayed=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_DISPLAYED_CHANGED)))}setDragging(e){this.dragging!==e&&(this.dragging=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_DRAGGING_CHANGED)))}setHighlighted(e){e!==this.highlighted&&(this.highlighted=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_HIGHLIGHT_CHANGED)))}setHovered(e){this.hovered!==e&&(this.hovered=e)}isHovered(){return this.hovered}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_ALL_CHILDREN_COUNT_CHANGED)))}setMaster(e){this.master!==e&&(this.master&&!e&&(this.expanded=!1),this.master=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_MASTER_CHANGED)))}setGroup(e){this.group!==e&&(this.group&&!e&&(this.expanded=!1),this.group=e,this.updateHasChildren(),this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_GROUP_CHANGED)))}setRowHeight(e,t=!1){this.rowHeight=e,this.rowHeightEstimated=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_HEIGHT_CHANGED))}setRowAutoHeight(e,t){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[t.getId()]=e,null!=e&&(null==this.checkAutoHeightsDebounced&&(this.checkAutoHeightsDebounced=Pe(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())}checkAutoHeights(){let n=!1,e=!0,r=0;const s=this.__autoHeights;if(null==s)return;if(this.beans.columnModel.getAllDisplayedAutoHeightCols().forEach(t=>{let i=s[t.getId()];if(null==i){if(!this.beans.columnModel.isColSpanActive())return void(n=!0);{let e=[];switch(t.getPinned()){case"left":e=this.beans.columnModel.getDisplayedLeftColumnsForRow(this);break;case"right":e=this.beans.columnModel.getDisplayedRightColumnsForRow(this);break;case null:e=this.beans.columnModel.getViewportCenterColumnsForRow(this)}if(e.includes(t))return void(n=!0);i=-1}}else e=!1;i>r&&(r=i)}),n)return;if((e||r<10)&&(r=this.beans.gridOptionsService.getRowHeightForNode(this).height),r==this.rowHeight)return;this.setRowHeight(r);const t=this.beans.rowModel;t.onRowHeightChangedDebounced&&t.onRowHeightChangedDebounced()}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_ROW_INDEX_CHANGED)))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_UI_LEVEL_CHANGED)))}setExpanded(e,t){if(this.expanded===e)return;this.expanded=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_EXPANDED_CHANGED));const i=Object.assign({},this.createGlobalRowEvent(y.EVENT_ROW_GROUP_OPENED),{expanded:e,event:t||null});this.beans.rowNodeEventThrottle.dispatchExpanded(i),this.beans.gridOptionsService.is("groupIncludeFooter")&&this.beans.rowRenderer.refreshCells({rowNodes:[this]})}createGlobalRowEvent(e){return{type:e,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned,context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi}}dispatchLocalEvent(e){this.eventService&&this.eventService.dispatchEvent(e)}setDataValue(t,e,i){const n=(()=>{var e;return"string"!=typeof t?t:null!==(e=this.beans.columnModel.getGridColumn(t))&&void 0!==e?e:this.beans.columnModel.getPrimaryColumn(t)})(),r=this.getValueFromValueService(n);if(this.beans.gridOptionsService.is("readOnlyEdit"))return this.dispatchEventForSaveValueReadOnly(n,r,e,i),!1;const s=this.beans.valueService.setValue(this,n,e,i);return this.dispatchCellChangedEvent(n,e,r),this.checkRowSelectable(),s}getValueFromValueService(e){const t=this.leafGroup&&this.beans.columnModel.isPivotMode(),i=this.group&&this.expanded&&!this.footer&&!t,n=this.beans.gridOptionsService.is("groupIncludeFooter"),r=this.beans.gridOptionsService.is("groupSuppressBlankHeader"),s=i&&n&&!r;return this.beans.valueService.getValue(e,this,!1,s)}dispatchEventForSaveValueReadOnly(e,t,i,n){const r={type:y.EVENT_CELL_EDIT_REQUEST,event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column:e,colDef:e.getColDef(),context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,data:this.data,node:this,oldValue:t,newValue:i,value:i,source:n};this.beans.eventService.dispatchEvent(r)}setGroupValue(e,t){const i=this.beans.columnModel.getGridColumn(e);u(this.groupData)&&(this.groupData={});const n=i.getColId(),r=this.groupData[n];r!==t&&(this.groupData[n]=t,this.dispatchCellChangedEvent(i,t,r))}setAggData(e){const t=ve([this.aggData,e]),r=this.aggData;this.aggData=e,this.eventService&&t.forEach(e=>{const t=this.beans.columnModel.getGridColumn(e),i=this.aggData?this.aggData[e]:void 0,n=r?r[e]:void 0;this.dispatchCellChangedEvent(t,i,n)})}updateHasChildren(){let i=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(this.beans.gridOptionsService.isRowModelType("serverSide")){const e=this.beans.gridOptionsService.isTreeData(),t=this.beans.gridOptionsService.get("isServerSideGroup");i=!this.stub&&!this.footer&&(e?!!t&&t(this.data):!!this.group)}i!==this.__hasChildren&&(this.__hasChildren=!!i,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(R.EVENT_HAS_CHILDREN_CHANGED)))}hasChildren(){return null==this.__hasChildren&&this.updateHasChildren(),this.__hasChildren}isEmptyRowGroupNode(){return this.group&&ee(this.childrenAfterGroup)}dispatchCellChangedEvent(e,t,i){const n={type:R.EVENT_CELL_CHANGED,node:this,column:e,newValue:t,oldValue:i};this.dispatchLocalEvent(n)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return!!(this.hasChildren()&&!this.footer||this.master)}isSelected(){return this.footer?this.sibling.isSelected():this.selected}depthFirstSearch(t){this.childrenAfterGroup&&this.childrenAfterGroup.forEach(e=>e.depthFirstSearch(t)),t(this)}calculateSelectedFromChildren(){var n;let r=!1,s=!1,o=!1;if(!(null===(n=this.childrenAfterGroup)||void 0===n?void 0:n.length))return this.selectable?this.selected:null;for(let i=0;i<this.childrenAfterGroup.length;i++){const e=this.childrenAfterGroup[i];let t=e.isSelected();if(!e.selectable){const n=e.calculateSelectedFromChildren();if(null===n)continue;t=n}switch(t){case!0:r=!0;break;case!1:s=!0;break;default:o=!0}}return o||r&&s?void 0:!!r||!s&&(this.selectable?this.selected:null)}setSelectedInitialValue(e){this.selected=e}selectThisNode(e,t,i="api"){const n=!this.selectable&&e,r=this.selected===e;if(n||r)return!1;this.selected=e,this.eventService&&this.dispatchLocalEvent(this.createLocalRowEvent(R.EVENT_ROW_SELECTED));const s=Object.assign(Object.assign({},this.createGlobalRowEvent(y.EVENT_ROW_SELECTED)),{event:t||null,source:i});return this.beans.eventService.dispatchEvent(s),!0}setSelected(e,t=!1,i="api"){"boolean"!=typeof i?this.setSelectedParams({newValue:e,clearSelection:t,rangeSelect:!1,source:i}):console.warn("AG Grid: since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.")}setSelectedParams(e){return this.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),0):void 0===this.id?(console.warn("AG Grid: cannot select node until id for node is known"),0):this.beans.selectionService.setNodesSelected(Object.assign(Object.assign({},e),{nodes:[this.footer?this.sibling:this]}))}isRowPinned(){return"top"===this.rowPinned||"bottom"===this.rowPinned}isParentOfNode(e){let t=this.parent;for(;t;){if(t===e)return!0;t=t.parent}return!1}addEventListener(e,t){this.eventService||(this.eventService=new qe),this.eventService.addEventListener(e,t)}removeEventListener(e,t){this.eventService&&(this.eventService.removeEventListener(e,t),this.eventService.noRegisteredListenersExist()&&(this.eventService=null))}onMouseEnter(){this.dispatchLocalEvent(this.createLocalRowEvent(R.EVENT_MOUSE_ENTER))}onMouseLeave(){this.dispatchLocalEvent(this.createLocalRowEvent(R.EVENT_MOUSE_LEAVE))}getFirstChildOfFirstChild(t){let i=this,n=!0,r=!1,s=null;for(;n&&!r;){const e=i.parent;_(e)&&i.firstChild?e.rowGroupColumn===t&&(r=!0,s=e):n=!1,i=e}return r?s:null}isFullWidthCell(){const e=this.beans.gridOptionsService.getCallback("isFullWidthRow");return!!e&&e({rowNode:this})}getRoute(){if(null==this.key)return;const e=[];let t=this;for(;null!=t.key;)e.push(t.key),t=t.parent;return e.reverse()}createFooter(){if(this.sibling)return;const t=new R(this.beans);Object.keys(this).forEach(e=>{t[e]=this[e]}),t.footer=!0,t.setRowTop(null),t.setRowIndex(null),t.oldRowTop=null,t.id="rowGroupFooter_"+this.id,t.sibling=this,this.sibling=t}}R.ID_PREFIX_ROW_GROUP="row-group-",R.ID_PREFIX_TOP_PINNED="t-",R.ID_PREFIX_BOTTOM_PINNED="b-",R.OBJECT_ID_SEQUENCE=0,R.EVENT_ROW_SELECTED="rowSelected",R.EVENT_DATA_CHANGED="dataChanged",R.EVENT_CELL_CHANGED="cellChanged",R.EVENT_ALL_CHILDREN_COUNT_CHANGED="allChildrenCountChanged",R.EVENT_MASTER_CHANGED="masterChanged",R.EVENT_GROUP_CHANGED="groupChanged",R.EVENT_MOUSE_ENTER="mouseEnter",R.EVENT_MOUSE_LEAVE="mouseLeave",R.EVENT_HEIGHT_CHANGED="heightChanged",R.EVENT_TOP_CHANGED="topChanged",R.EVENT_DISPLAYED_CHANGED="displayedChanged",R.EVENT_FIRST_CHILD_CHANGED="firstChildChanged",R.EVENT_LAST_CHILD_CHANGED="lastChildChanged",R.EVENT_CHILD_INDEX_CHANGED="childIndexChanged",R.EVENT_ROW_INDEX_CHANGED="rowIndexChanged",R.EVENT_EXPANDED_CHANGED="expandedChanged",R.EVENT_HAS_CHILDREN_CHANGED="hasChildrenChanged",R.EVENT_SELECTABLE_CHANGED="selectableChanged",R.EVENT_UI_LEVEL_CHANGED="uiLevelChanged",R.EVENT_HIGHLIGHT_CHANGED="rowHighlightChanged",R.EVENT_DRAGGING_CHANGED="draggingChanged";var Xs=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Qs extends E{constructor(){super('\n            <div class="ag-selection-checkbox" role="presentation">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>')}postConstruct(){this.eCheckbox.setPassive(!0),Ni(this.eCheckbox.getInputElement(),"polite")}getCheckboxId(){return this.eCheckbox.getInputElement().id}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const e=this.localeService.getLocaleTextFunc(),t=this.rowNode.isSelected(),i=Xi(e,t),n=e("ariaRowToggleSelection","Press Space to toggle row selection");this.eCheckbox.setValue(t,!0),this.eCheckbox.setInputAriaLabel(`${n} (${i})`)}onClicked(e,t,i){return this.rowNode.setSelectedParams({newValue:e,rangeSelect:i.shiftKey,groupSelectsFiltered:t,event:i,source:"checkboxSelected"})}init(e){this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",e=>{yt(e)}),this.addManagedListener(this.eCheckbox.getInputElement(),"click",e=>{yt(e);const t=this.gridOptionsService.is("groupSelectsFiltered"),i=this.eCheckbox.getValue();if(this.shouldHandleIndeterminateState(i,t)){0===this.onClicked(!0,t,e||{})&&this.onClicked(!1,t,e)}else i?this.onClicked(!1,t,e):this.onClicked(!0,t,e||{})}),this.addManagedListener(this.rowNode,R.EVENT_ROW_SELECTED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_DATA_CHANGED,this.onDataChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_SELECTABLE_CHANGED,this.onSelectableChanged.bind(this));if(this.gridOptionsService.get("isRowSelectable")||"function"==typeof this.getIsVisible()){const e=this.showOrHideSelect.bind(this);this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.rowNode,R.EVENT_DATA_CHANGED,e),this.addManagedListener(this.rowNode,R.EVENT_CELL_CHANGED,e),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}shouldHandleIndeterminateState(e,t){return t&&(void 0===this.eCheckbox.getPreviousValue()||void 0===e)&&this.gridOptionsService.isRowModelType("clientSide")}showOrHideSelect(){var e,t,i,n;let r=this.rowNode.selectable;const s=this.getIsVisible();if(r)if("function"==typeof s){const i=null===(e=this.overrides)||void 0===e?void 0:e.callbackParams,n=null===(t=this.column)||void 0===t?void 0:t.createColumnFunctionCallbackParams(this.rowNode);r=!!n&&s(Object.assign(Object.assign({},i),n))}else r=null!=s&&s;if(null===(i=this.column)||void 0===i?void 0:i.getColDef().showDisabledCheckboxes)return this.eCheckbox.setDisabled(!r),this.setVisible(!0),void this.setDisplayed(!0);(null===(n=this.overrides)||void 0===n?void 0:n.removeHidden)?this.setDisplayed(r):this.setVisible(r)}getIsVisible(){var e,t;return this.overrides?this.overrides.isVisible:null===(t=null===(e=this.column)||void 0===e?void 0:e.getColDef())||void 0===t?void 0:t.checkboxSelection}}Xs([S("eCheckbox")],Qs.prototype,"eCheckbox",void 0),Xs([r],Qs.prototype,"postConstruct",null);var Zs,Js,eo,to,io=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};!function(e){e[e.ToolPanel=0]="ToolPanel",e[e.HeaderCell=1]="HeaderCell",e[e.RowDrag=2]="RowDrag",e[e.ChartPanel=3]="ChartPanel"}(Js||(Js={})),function(e){e[e.Up=0]="Up",e[e.Down=1]="Down"}(eo||(eo={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(to||(to={}));let M=Zs=class extends f{constructor(){super(...arguments),this.dragSourceAndParamsList=[],this.dropTargets=[]}init(){this.ePinnedIcon=gr("columnMovePin",this.gridOptionsService,null),this.eHideIcon=gr("columnMoveHide",this.gridOptionsService,null),this.eMoveIcon=gr("columnMoveMove",this.gridOptionsService,null),this.eLeftIcon=gr("columnMoveLeft",this.gridOptionsService,null),this.eRightIcon=gr("columnMoveRight",this.gridOptionsService,null),this.eGroupIcon=gr("columnMoveGroup",this.gridOptionsService,null),this.eAggregateIcon=gr("columnMoveValue",this.gridOptionsService,null),this.ePivotIcon=gr("columnMovePivot",this.gridOptionsService,null),this.eDropNotAllowedIcon=gr("dropNotAllowed",this.gridOptionsService,null)}addDragSource(e,t=!1){const i={eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),includeTouch:t};this.dragSourceAndParamsList.push({params:i,dragSource:e}),this.dragService.addDragSource(i)}removeDragSource(t){const e=this.dragSourceAndParamsList.find(e=>e.dragSource===t);e&&(this.dragService.removeDragSource(e.params),ot(this.dragSourceAndParamsList,e))}clearDragSourceParamsList(){this.dragSourceAndParamsList.forEach(e=>this.dragService.removeDragSource(e.params)),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0}nudge(){this.dragging&&this.onDragging(this.eventLastTime,!0)}onDragStart(e,t){this.dragging=!0,this.dragSource=e,this.eventLastTime=t,this.dragItem=this.dragSource.getDragItem(),this.lastDropTarget=this.dragSource.dragSourceDropTarget,this.dragSource.onDragStarted&&this.dragSource.onDragStarted(),this.createGhost()}onDragStop(t){if(this.eventLastTime=null,this.dragging=!1,this.dragSource.onDragStopped&&this.dragSource.onDragStopped(),this.lastDropTarget&&this.lastDropTarget.onDragStop){const e=this.createDropTargetEvent(this.lastDropTarget,t,null,null,!1);this.lastDropTarget.onDragStop(e)}this.lastDropTarget=null,this.dragItem=null,this.removeGhost()}onDragging(t,e){var i,n,r,s;const o=this.getHorizontalDirection(t),a=this.getVerticalDirection(t);this.eventLastTime=t,this.positionGhost(t);const l=this.dropTargets.filter(e=>this.isMouseOnDropTarget(t,e)),c=this.findCurrentDropTarget(t,l);if(c!==this.lastDropTarget)this.leaveLastTargetIfExists(t,o,a,e),null!==this.lastDropTarget&&null===c&&(null===(n=(i=this.dragSource).onGridExit)||void 0===n||n.call(i,this.dragItem)),null===this.lastDropTarget&&null!==c&&(null===(s=(r=this.dragSource).onGridEnter)||void 0===s||s.call(r,this.dragItem)),this.enterDragTargetIfExists(c,t,o,a,e),this.lastDropTarget=c;else if(c&&c.onDragging){const i=this.createDropTargetEvent(c,t,o,a,e);c.onDragging(i)}}getAllContainersFromDropTarget(e){const t=e.getSecondaryContainers?e.getSecondaryContainers():null,i=[[e.getContainer()]];return t?i.concat(t):i}allContainersIntersect(n,r){for(const i of r){const r=i.getBoundingClientRect();if(0===r.width||0===r.height)return!1;const e=n.clientX>=r.left&&n.clientX<r.right,t=n.clientY>=r.top&&n.clientY<r.bottom;if(!e||!t)return!1}return!0}isMouseOnDropTarget(e,t){const i=this.getAllContainersFromDropTarget(t);let n=!1;for(const t of i)if(this.allContainersIntersect(e,t)){n=!0;break}return!(t.targetContainsSource&&!t.getContainer().contains(this.dragSource.eElement))&&(n&&t.isInterestedIn(this.dragSource.type,this.dragSource.eElement))}findCurrentDropTarget(e,t){const i=t.length;if(0===i)return null;if(1===i)return t[0];const n=this.gridOptionsService.getRootNode().elementsFromPoint(e.clientX,e.clientY);for(const e of n)for(const i of t){if(-1!==ht(this.getAllContainersFromDropTarget(i)).indexOf(e))return i}return null}enterDragTargetIfExists(t,i,n,r,s){if(t){if(t.onDragEnter){const e=this.createDropTargetEvent(t,i,n,r,s);t.onDragEnter(e)}this.setGhostIcon(t.getIconName?t.getIconName():null)}}leaveLastTargetIfExists(t,i,n,r){if(this.lastDropTarget){if(this.lastDropTarget.onDragLeave){const e=this.createDropTargetEvent(this.lastDropTarget,t,i,n,r);this.lastDropTarget.onDragLeave(e)}this.setGhostIcon(null)}}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(t){this.dropTargets=this.dropTargets.filter(e=>e.getContainer()!==t.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(t){return this.dropTargets.filter(e=>e.external).find(e=>e.getContainer()===t.getContainer())||null}getHorizontalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientX,i=e.clientX;return t===i?null:t>i?to.Left:to.Right}getVerticalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientY,i=e.clientY;return t===i?null:t>i?eo.Up:eo.Down}createDropTargetEvent(e,t,i,n,r){const s=e.getContainer(),o=s.getBoundingClientRect(),{gridApi:a,columnApi:l,dragItem:c,dragSource:u}=this;return{event:t,x:t.clientX-o.left,y:t.clientY-o.top,vDirection:n,hDirection:i,dragSource:u,fromNudge:r,dragItem:c,api:a,columnApi:l,dropZoneTarget:s}}positionGhost(e){const t=this.eGhost;if(!t)return;const i=t.getBoundingClientRect().height,n=an()-2,r=ln()-2,s=Gn(t.offsetParent),{clientY:o,clientX:a}=e;let l=o-s.top-i/2,c=a-s.left-10;const u=this.gridOptionsService.getDocument(),d=u.defaultView||window,h=d.pageYOffset||u.documentElement.scrollTop,p=d.pageXOffset||u.documentElement.scrollLeft;n>0&&c+t.clientWidth>n+p&&(c=n+p-t.clientWidth),c<0&&(c=0),r>0&&l+t.clientHeight>r+h&&(l=r+h-t.clientHeight),l<0&&(l=0),t.style.left=c+"px",t.style.top=l+"px"}removeGhost(){this.eGhost&&this.eGhostParent&&this.eGhostParent.removeChild(this.eGhost),this.eGhost=null}createGhost(){this.eGhost=Un(Zs.GHOST_TEMPLATE),this.mouseEventService.stampTopLevelGridCompWithGridInstance(this.eGhost);const{theme:e}=this.environment.getTheme();e&&this.eGhost.classList.add(e),this.eGhostIcon=this.eGhost.querySelector(".ag-dnd-ghost-icon"),this.setGhostIcon(null);const t=this.eGhost.querySelector(".ag-dnd-ghost-label");let i=this.dragSource.dragItemName;De(i)&&(i=i()),t.innerHTML=$t(i)||"",this.eGhost.style.height="25px",this.eGhost.style.top="20px",this.eGhost.style.left="20px";const n=this.gridOptionsService.getDocument();let r=null;try{r=n.fullscreenElement}catch(e){}finally{if(!r){const e=this.gridOptionsService.getRootNode(),t=e.querySelector("body");r=t||(e instanceof ShadowRoot?e:null==e?void 0:e.documentElement)}}this.eGhostParent=r,this.eGhostParent?this.eGhostParent.appendChild(this.eGhost):console.warn("AG Grid: could not find document body, it is needed for dragging columns")}setGhostIcon(e,t=!1){Vn(this.eGhostIcon);let i=null;switch(e||(e=this.dragSource.defaultIconName||Zs.ICON_NOT_ALLOWED),e){case Zs.ICON_PINNED:i=this.ePinnedIcon;break;case Zs.ICON_MOVE:i=this.eMoveIcon;break;case Zs.ICON_LEFT:i=this.eLeftIcon;break;case Zs.ICON_RIGHT:i=this.eRightIcon;break;case Zs.ICON_GROUP:i=this.eGroupIcon;break;case Zs.ICON_AGGREGATE:i=this.eAggregateIcon;break;case Zs.ICON_PIVOT:i=this.ePivotIcon;break;case Zs.ICON_NOT_ALLOWED:i=this.eDropNotAllowedIcon;break;case Zs.ICON_HIDE:i=this.eHideIcon}this.eGhostIcon.classList.toggle("ag-shake-left-to-right",t),i===this.eHideIcon&&this.gridOptionsService.is("suppressDragLeaveHidesColumns")||i&&this.eGhostIcon.appendChild(i)}};M.ICON_PINNED="pinned",M.ICON_MOVE="move",M.ICON_LEFT="left",M.ICON_RIGHT="right",M.ICON_GROUP="group",M.ICON_AGGREGATE="aggregate",M.ICON_PIVOT="pivot",M.ICON_NOT_ALLOWED="notAllowed",M.ICON_HIDE="hide",M.GHOST_TEMPLATE='<div class="ag-dnd-ghost ag-unselectable">\n            <span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>\n            <div class="ag-dnd-ghost-label"></div>\n        </div>',io([o("dragService")],M.prototype,"dragService",void 0),io([o("mouseEventService")],M.prototype,"mouseEventService",void 0),io([o("columnApi")],M.prototype,"columnApi",void 0),io([o("gridApi")],M.prototype,"gridApi",void 0),io([r],M.prototype,"init",null),io([Ve],M.prototype,"clearDragSourceParamsList",null),M=Zs=io([s("dragAndDropService")],M);var no=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class ro extends E{constructor(e,t,i,n,r,s){super(),this.cellValueFn=e,this.rowNode=t,this.column=i,this.customGui=n,this.dragStartPixels=r,this.suppressVisibilityChange=s,this.dragSource=null}isCustomGui(){return null!=this.customGui}postConstruct(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(mr("rowDrag",this.gridOptionsService,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){const e=this.gridOptionsService.is("rowDragManaged")?new ao(this,this.beans,this.rowNode,this.column):new oo(this,this.beans,this.rowNode,this.column);this.createManagedBean(e,this.beans.context)}}setDragElement(e,t){this.setTemplateFromElement(e),this.addDragSource(t)}getSelectedNodes(){if(!this.gridOptionsService.is("rowDragMultiRow"))return[this.rowNode];const e=this.beans.selectionService.getSelectedNodes();return-1!==e.indexOf(this.rowNode)?e:[this.rowNode]}checkCompatibility(){const e=this.gridOptionsService.is("rowDragManaged");this.gridOptionsService.isTreeData()&&e&&l(()=>console.warn("AG Grid: If using row drag with tree data, you cannot have rowDragManaged=true"),"RowDragComp.managedAndTreeData")}getDragItem(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(t){if(t){const e=t.getColDef();if(e.rowDragText)return e.rowDragText}return this.gridOptionsService.get("rowDragText")}addDragSource(e=4){this.dragSource&&this.removeDragSource();const n=this.getRowDragText(this.column),r=this.localeService.getLocaleTextFunc();this.dragSource={type:Js.RowDrag,eElement:this.getGui(),dragItemName:()=>{var e;const t=this.getDragItem(),i=(null===(e=t.rowNodes)||void 0===e?void 0:e.length)||1;return n?n(t,i):1===i?this.cellValueFn():`${i} ${r("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gridOptionsService.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)}removeDragSource(){this.dragSource&&this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null}}no([o("beans")],ro.prototype,"beans",void 0),no([r],ro.prototype,"postConstruct",null),no([Ve],ro.prototype,"removeDragSource",null);class so extends f{constructor(e,t,i){super(),this.parent=e,this.rowNode=t,this.column=i}setDisplayedOrVisible(e){const i={skipAriaHidden:!0};if(e)this.parent.setDisplayed(!1,i);else{let e=!0,t=!1;this.column&&(e=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),t=De(this.column.getColDef().rowDrag)),t?(this.parent.setDisplayed(!0,i),this.parent.setVisible(e,i)):(this.parent.setDisplayed(e,i),this.parent.setVisible(!0,i))}}}class oo extends so{constructor(e,t,i,n){super(e,i,n),this.beans=t}postConstruct(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,y.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.gridOptionsService.is("suppressRowDrag");this.setDisplayedOrVisible(e)}}no([r],oo.prototype,"postConstruct",null);class ao extends so{constructor(e,t,i,n){super(e,i,n),this.beans=t}postConstruct(){this.addManagedListener(this.beans.eventService,y.EVENT_SORT_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,y.EVENT_FILTER_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,y.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),t=e&&e.shouldPreventRowMove(),i=this.gridOptionsService.is("suppressRowDrag"),n=this.beans.dragAndDropService.hasExternalDropZones(),r=t&&!n||i;this.setDisplayedOrVisible(r)}}no([r],ao.prototype,"postConstruct",null);var lo=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class co extends f{init(e,t,i,n,r,s,o){this.params=o,this.eGui=t,this.eCheckbox=i,this.eExpanded=n,this.eContracted=r,this.comp=e,this.compClass=s;const a=this.isTopLevelFooter(),l=this.isEmbeddedRowMismatch(),c=null==o.value&&!o.node.master;let u=!1;if(this.gridOptionsService.is("groupIncludeFooter")&&this.gridOptionsService.is("groupHideOpenParents")){const e=o.node;if(e.footer){u=(o.colDef&&o.colDef.showRowGroup)!==(e.rowGroupColumn&&e.rowGroupColumn.getColId())}}this.cellIsBlank=!a&&(l||c&&!o.node.master||u),this.cellIsBlank||(this.setupShowingValueForOpenedParent(),this.findDisplayedGroupNode(),this.addFullWidthRowDraggerIfNeeded(),this.addExpandAndContract(),this.addCheckboxIfNeeded(),this.addValueElement(),this.setupIndent(),this.refreshAriaExpanded())}destroy(){super.destroy(),this.expandListener=null}refreshAriaExpanded(){const{node:e,eParentOfValue:t}=this.params;if(this.expandListener&&(this.expandListener=this.expandListener()),!this.isExpandable())return void Li(t);const i=()=>{ki(t,!!e.expanded)};this.expandListener=this.addManagedListener(e,R.EVENT_EXPANDED_CHANGED,i)||null,i()}isTopLevelFooter(){if(!this.gridOptionsService.is("groupIncludeTotalFooter"))return!1;if(null!=this.params.value||-1!=this.params.node.level)return!1;const e=this.params.colDef;if(null==e)return!0;if(!0===e.showRowGroup)return!0;const t=this.columnModel.getRowGroupColumns();if(!t||0===t.length)return!0;return t[0].getId()===e.showRowGroup}isEmbeddedRowMismatch(){if(!this.params.fullWidth||!this.gridOptionsService.is("embedFullWidthRows"))return!1;const e="left"===this.params.pinned,t="right"===this.params.pinned,i=!e&&!t;return this.gridOptionsService.is("enableRtl")?this.columnModel.isPinningLeft()?!t:!i:this.columnModel.isPinningLeft()?!e:!i}findDisplayedGroupNode(){const t=this.params.column,i=this.params.node;if(this.showingValueForOpenedParent){let e=i.parent;for(;null!=e;){if(e.rowGroupColumn&&t.isRowGroupDisplayed(e.rowGroupColumn.getId())){this.displayedGroupNode=e;break}e=e.parent}}u(this.displayedGroupNode)&&(this.displayedGroupNode=i)}setupShowingValueForOpenedParent(){const e=this.params.node,t=this.params.column;if(!this.gridOptionsService.is("groupHideOpenParents"))return void(this.showingValueForOpenedParent=!1);if(!e.groupData)return void(this.showingValueForOpenedParent=!1);if(null!=e.rowGroupColumn){const i=e.rowGroupColumn.getId();if(t.isRowGroupDisplayed(i))return void(this.showingValueForOpenedParent=!1)}const i=null!=e.groupData[t.getId()];this.showingValueForOpenedParent=i}addValueElement(){this.displayedGroupNode.footer?this.addFooterValue():(this.addGroupValue(),this.addChildCount())}addGroupValue(){const e=this.adjustParamsWithDetailsFromRelatedColumn(),t=this.getInnerCompDetails(e),{valueFormatted:i,value:n}=e;let r=i;if(null==r)if(""===n&&this.params.node.group){r=this.localeService.getLocaleTextFunc()("blanks","(Blanks)")}else r=null!=n?n:null;this.comp.setInnerRenderer(t,r)}adjustParamsWithDetailsFromRelatedColumn(){const e=this.displayedGroupNode.rowGroupColumn,t=this.params.column;if(!e)return this.params;if(null!=t){if(!t.isRowGroupDisplayed(e.getId()))return this.params}const i=this.params,{value:n,node:r}=this.params,s=this.valueFormatterService.formatValue(e,r,n);return Object.assign(Object.assign({},i),{valueFormatted:s})}addFooterValue(){const e=this.params.footerValueGetter;let t="";if(e){const i=ue(this.params);i.value=this.params.value,"function"==typeof e?t=e(i):"string"==typeof e?t=this.expressionService.evaluate(e,i):console.warn("AG Grid: footerValueGetter should be either a function or a string (expression)")}else t="Total "+(null!=this.params.value?this.params.value:"");const i=this.getInnerCompDetails(this.params);this.comp.setInnerRenderer(i,t)}getInnerCompDetails(e){if(e.fullWidth)return this.userComponentFactory.getFullWidthGroupRowInnerCellRenderer(this.gridOptionsService.get("groupRowRendererParams"),e);const t=this.userComponentFactory.getInnerRendererDetails(e,e),i=e=>e&&e.componentClass==this.compClass;if(t&&!i(t))return t;const n=this.displayedGroupNode.rowGroupColumn,r=n?n.getColDef():void 0;if(!r)return;const s=this.userComponentFactory.getCellRendererDetails(r,e);if(s&&!i(s))return s;if(i(s)&&r.cellRendererParams&&r.cellRendererParams.innerRenderer){return this.userComponentFactory.getInnerRendererDetails(r.cellRendererParams,e)}}addChildCount(){this.params.suppressCount||(this.addManagedListener(this.displayedGroupNode,R.EVENT_ALL_CHILDREN_COUNT_CHANGED,this.updateChildCount.bind(this)),this.updateChildCount())}updateChildCount(){const e=this.displayedGroupNode.allChildrenCount,t=this.isShowRowGroupForThisRow()&&null!=e&&e>=0?`(${e})`:"";this.comp.setChildCount(t)}isShowRowGroupForThisRow(){if(this.gridOptionsService.isTreeData())return!0;const e=this.displayedGroupNode.rowGroupColumn;if(!e)return!1;const t=this.params.column;return null==t||t.isRowGroupDisplayed(e.getId())}addExpandAndContract(){var e;const t=this.params,i=mr("groupExpanded",this.gridOptionsService,null),n=mr("groupContracted",this.gridOptionsService,null);i&&this.eExpanded.appendChild(i),n&&this.eContracted.appendChild(n);const r=t.eGridCell;(null===(e=this.params.column)||void 0===e?void 0:e.isCellEditable(t.node))&&this.gridOptionsService.is("enableGroupEdit")||!this.isExpandable()||t.suppressDoubleClickExpand||this.addManagedListener(r,"dblclick",this.onCellDblClicked.bind(this)),this.addManagedListener(this.eExpanded,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eContracted,"click",this.onExpandClicked.bind(this)),this.addManagedListener(r,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(t.node,R.EVENT_EXPANDED_CHANGED,this.showExpandAndContractIcons.bind(this)),this.showExpandAndContractIcons();const s=this.onRowNodeIsExpandableChanged.bind(this);this.addManagedListener(this.displayedGroupNode,R.EVENT_ALL_CHILDREN_COUNT_CHANGED,s),this.addManagedListener(this.displayedGroupNode,R.EVENT_MASTER_CHANGED,s),this.addManagedListener(this.displayedGroupNode,R.EVENT_GROUP_CHANGED,s),this.addManagedListener(this.displayedGroupNode,R.EVENT_HAS_CHILDREN_CHANGED,s)}onExpandClicked(e){bt(e)||(yt(e),this.onExpandOrContract(e))}onExpandOrContract(e){const t=this.displayedGroupNode,i=!t.expanded;!i&&t.sticky&&this.scrollToStickyNode(t),t.setExpanded(i,e)}scrollToStickyNode(e){this.ctrlsService.getGridBodyCtrl().getScrollFeature().setVerticalScrollPosition(e.rowTop-e.stickyRowTop)}isExpandable(){if(this.showingValueForOpenedParent)return!0;const e=this.displayedGroupNode,t=this.columnModel.isPivotMode()&&e.leafGroup;if(!(e.isExpandable()&&!e.footer&&!t))return!1;const i=this.params.column;if(null!=i&&"string"==typeof i.getColDef().showRowGroup){return this.isShowRowGroupForThisRow()}return!0}showExpandAndContractIcons(){const{params:e,displayedGroupNode:t,columnModel:i}=this,{node:n}=e,r=this.isExpandable();if(r){const e=!!this.showingValueForOpenedParent||n.expanded;this.comp.setExpandedDisplayed(e),this.comp.setContractedDisplayed(!e)}else this.comp.setExpandedDisplayed(!1),this.comp.setContractedDisplayed(!1);const s=i.isPivotMode(),o=s&&t.leafGroup,a=r&&!o,l=n.footer&&-1===n.level;this.comp.addOrRemoveCssClass("ag-cell-expandable",a),this.comp.addOrRemoveCssClass("ag-row-group",a),s?this.comp.addOrRemoveCssClass("ag-pivot-leaf-group",o):l||this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent",!a)}onRowNodeIsExpandableChanged(){this.showExpandAndContractIcons(),this.setIndent(),this.refreshAriaExpanded()}setupIndent(){const e=this.params.node;this.params.suppressPadding||(this.addManagedListener(e,R.EVENT_UI_LEVEL_CHANGED,this.setIndent.bind(this)),this.setIndent())}setIndent(){if(this.gridOptionsService.is("groupHideOpenParents"))return;const e=this.params,t=e.node,i=!!e.colDef,n=this.gridOptionsService.isTreeData(),r=!i||n||!0===e.colDef.showRowGroup?t.uiLevel:0;this.indentClass&&this.comp.addOrRemoveCssClass(this.indentClass,!1),this.indentClass="ag-row-group-indent-"+r,this.comp.addOrRemoveCssClass(this.indentClass,!0)}addFullWidthRowDraggerIfNeeded(){if(!this.params.fullWidth||!this.params.rowDrag)return;const e=new ro(()=>this.params.value,this.params.node);this.createManagedBean(e,this.context),this.eGui.insertAdjacentElement("afterbegin",e.getGui())}isUserWantsSelected(){const e=this.params.checkbox;return"function"==typeof e||!0===e}addCheckboxIfNeeded(){const e=this.displayedGroupNode,t=this.isUserWantsSelected()&&!e.footer&&!e.rowPinned&&!e.detail;if(t){const t=new Qs;this.getContext().createBean(t),t.init({rowNode:e,column:this.params.column,overrides:{isVisible:this.params.checkbox,callbackParams:this.params,removeHidden:!0}}),this.eCheckbox.appendChild(t.getGui()),this.addDestroyFunc(()=>this.getContext().destroyBean(t))}this.comp.setCheckboxVisible(t)}onKeyDown(e){if(!(e.key===A.ENTER)||this.params.suppressEnterExpand)return;this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract(e)}onCellDblClicked(e){if(bt(e))return;_t(this.eExpanded,e)||_t(this.eContracted,e)||this.onExpandOrContract(e)}}lo([o("expressionService")],co.prototype,"expressionService",void 0),lo([o("valueFormatterService")],co.prototype,"valueFormatterService",void 0),lo([o("columnModel")],co.prototype,"columnModel",void 0),lo([o("userComponentFactory")],co.prototype,"userComponentFactory",void 0),lo([o("ctrlsService")],co.prototype,"ctrlsService",void 0);var uo=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class ho extends E{constructor(){super(ho.TEMPLATE)}init(e){const t={setInnerRenderer:(e,t)=>this.setRenderDetails(e,t),setChildCount:e=>this.eChildCount.innerHTML=e,addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),setContractedDisplayed:e=>w(this.eContracted,e),setExpandedDisplayed:e=>w(this.eExpanded,e),setCheckboxVisible:e=>this.eCheckbox.classList.toggle("ag-invisible",!e)},i=this.createManagedBean(new co),n=!e.colDef,r=this.getGui();i.init(t,r,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,e),n&&_i(r,"gridcell")}setRenderDetails(e,t){if(e){const t=e.newAgStackInstance();if(!t)return;t.then(e=>{if(!e)return;const t=()=>this.context.destroyBean(e);this.isAlive()?(this.eValue.appendChild(e.getGui()),this.addDestroyFunc(t)):t()})}else this.eValue.innerText=t}destroy(){this.getContext().destroyBean(this.innerCellRenderer),super.destroy()}refresh(){return!1}}ho.TEMPLATE='<span class="ag-cell-wrapper">\n            <span class="ag-group-expanded" ref="eExpanded"></span>\n            <span class="ag-group-contracted" ref="eContracted"></span>\n            <span class="ag-group-checkbox ag-invisible" ref="eCheckbox"></span>\n            <span class="ag-group-value" ref="eValue"></span>\n            <span class="ag-group-child-count" ref="eChildCount"></span>\n        </span>',uo([S("eExpanded")],ho.prototype,"eExpanded",void 0),uo([S("eContracted")],ho.prototype,"eContracted",void 0),uo([S("eCheckbox")],ho.prototype,"eCheckbox",void 0),uo([S("eValue")],ho.prototype,"eValue",void 0),uo([S("eChildCount")],ho.prototype,"eChildCount",void 0);var po=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class fo extends E{constructor(){super(fo.TEMPLATE)}init(e){e.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const e=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=e("loadingError","ERR")}setupLoading(){const e=mr("groupLoading",this.gridOptionsService,null);e&&this.eLoadingIcon.appendChild(e);const t=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=t("loadingOoo","Loading")}refresh(e){return!1}destroy(){super.destroy()}}fo.TEMPLATE='<div class="ag-loading">\n            <span class="ag-loading-icon" ref="eLoadingIcon"></span>\n            <span class="ag-loading-text" ref="eLoadingText"></span>\n        </div>',po([S("eLoadingIcon")],fo.prototype,"eLoadingIcon",void 0),po([S("eLoadingText")],fo.prototype,"eLoadingText",void 0);class go extends E{constructor(){super()}destroy(){super.destroy()}init(e){var t;const i=null!==(t=this.gridOptionsService.get("overlayLoadingTemplate"))&&void 0!==t?t:go.DEFAULT_LOADING_OVERLAY_TEMPLATE,n=this.localeService.getLocaleTextFunc(),r=i.replace("[LOADING...]",n("loadingOoo","Loading..."));this.setTemplate(r)}}go.DEFAULT_LOADING_OVERLAY_TEMPLATE='<span class="ag-overlay-loading-center">[LOADING...]</span>';class mo extends E{constructor(){super()}destroy(){super.destroy()}init(e){var t;const i=null!==(t=this.gridOptionsService.get("overlayNoRowsTemplate"))&&void 0!==t?t:mo.DEFAULT_NO_ROWS_TEMPLATE,n=this.localeService.getLocaleTextFunc(),r=i.replace("[NO_ROWS_TO_SHOW]",n("noRowsToShow","No Rows To Show"));this.setTemplate(r)}}mo.DEFAULT_NO_ROWS_TEMPLATE='<span class="ag-overlay-no-rows-center">[NO_ROWS_TO_SHOW]</span>';class vo extends Fs{constructor(){super('<div class="ag-tooltip"></div>')}init(e){const{value:t}=e;this.getGui().innerHTML=$t(t)}}class yo{getTemplate(){return'<ag-input-number-field class="ag-cell-editor" ref="eInput"></ag-input-number-field>'}init(e,t){this.eInput=e,this.params=t,null!=t.max&&e.setMax(t.max),null!=t.min&&e.setMin(t.min),null!=t.precision&&e.setPrecision(t.precision),null!=t.step&&e.setStep(t.step),t.showStepperButtons&&e.getInputElement().classList.add("ag-number-field-input-stepper")}getValue(){const e=this.eInput.getValue();if(!_(e)&&!_(this.params.value))return this.params.value;let t=this.params.parseValue(e);if(null==t)return t;if("string"==typeof t){if(""===t)return null;t=Number(t)}return isNaN(t)?null:t}getStartValue(){return this.params.value}}class bo extends Ws{constructor(){super(new yo)}}class Co{getTemplate(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}init(e,t){this.eInput=e,this.params=t,null!=t.min&&e.setMin(t.min),null!=t.max&&e.setMax(t.max),null!=t.step&&e.setStep(t.step)}getValue(){const e=this.eInput.getDate();return _(e)||_(this.params.value)?null!=e?e:null:this.params.value}getStartValue(){const{value:e}=this.params;if(e instanceof Date)return wn(e,!1)}}class wo extends Ws{constructor(){super(new Co)}}var _o=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Ao{constructor(e){this.getDataTypeService=e}getTemplate(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}init(e,t){this.eInput=e,this.params=t,null!=t.min&&e.setMin(t.min),null!=t.max&&e.setMax(t.max),null!=t.step&&e.setStep(t.step)}getValue(){const e=this.formatDate(this.eInput.getDate());return _(e)||_(this.params.value)?this.params.parseValue(null!=e?e:""):this.params.value}getStartValue(){var e,t;return wn(null!==(t=this.parseDate(null!==(e=this.params.value)&&void 0!==e?e:void 0))&&void 0!==t?t:null,!1)}parseDate(e){return this.getDataTypeService().getDateParserFunction()(e)}formatDate(e){return this.getDataTypeService().getDateFormatterFunction()(e)}}class Eo extends Ws{constructor(){super(new Ao(()=>this.dataTypeService))}}_o([o("dataTypeService")],Eo.prototype,"dataTypeService",void 0);var So=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class To extends E{constructor(){super(To.TEMPLATE)}init(e){this.params=e,this.updateCheckbox(e),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.addManagedListener(this.eCheckbox.getInputElement(),"click",e=>{if(yt(e),this.eCheckbox.isDisabled())return;const t=this.eCheckbox.getValue();this.onCheckboxChanged(t)}),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",e=>{yt(e)});const i=this.gridOptionsService.getDocument();this.addManagedListener(this.params.eGridCell,"keydown",t=>{if(t.key===A.SPACE&&!this.eCheckbox.isDisabled()){this.params.eGridCell===i.activeElement&&this.eCheckbox.toggle();const e=this.eCheckbox.getValue();this.onCheckboxChanged(e),t.preventDefault()}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){var t,i,n;let r,s=!0;if(e.node.group&&e.column){const i=e.column.getColId();i.startsWith(It)?r=null==e.value||""===e.value?void 0:"true"===e.value:e.node.aggData&&void 0!==e.node.aggData[i]?r=null!==(t=e.value)&&void 0!==t?t:void 0:s=!1}else r=null!==(i=e.value)&&void 0!==i?i:void 0;if(!s)return void this.eCheckbox.setDisplayed(!1);this.eCheckbox.setValue(r);const o=null!=e.disabled?e.disabled:!(null===(n=e.column)||void 0===n?void 0:n.isCellEditable(e.node));this.eCheckbox.setDisabled(o);const a=this.localeService.getLocaleTextFunc(),l=Xi(a,r),c=o?l:`${a("ariaToggleCellValue","Press SPACE to toggle cell value")} (${l})`;this.eCheckbox.setInputAriaLabel(c)}onCheckboxChanged(e){const{column:t,node:i,rowIndex:n,value:r}=this.params,s={type:y.EVENT_CELL_EDITING_STARTED,column:t,colDef:null==t?void 0:t.getColDef(),data:i.data,node:i,rowIndex:n,rowPinned:i.rowPinned,value:r};this.eventService.dispatchEvent(s);const o=this.params.node.setDataValue(this.params.column,e,"edit"),a={type:y.EVENT_CELL_EDITING_STOPPED,column:t,colDef:null==t?void 0:t.getColDef(),data:i.data,node:i,rowIndex:n,rowPinned:i.rowPinned,value:r,oldValue:r,newValue:e,valueChanged:o};this.eventService.dispatchEvent(a)}}To.TEMPLATE='\n        <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">\n            <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n        </div>',So([S("eCheckbox")],To.prototype,"eCheckbox",void 0);var xo=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Do extends Fs{constructor(){super('\n            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>')}init(e){var t;this.params=e;const i=null!==(t=e.value)&&void 0!==t?t:void 0;this.eCheckbox.setValue(i),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(i),this.addManagedListener(this.eCheckbox,as.EVENT_CHANGED,e=>this.setAriaLabel(e.selected))}getValue(){return this.eCheckbox.getValue()}focusIn(){this.eCheckbox.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){const t=this.localeService.getLocaleTextFunc(),i=Xi(t,e),n=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel(`${n} (${i})`)}}xo([S("eCheckbox")],Do.prototype,"eCheckbox",void 0);var Ro=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Mo=class extends f{constructor(){super(...arguments),this.agGridDefaults={agDateInput:vs,agColumnHeader:Ps,agColumnGroupHeader:Ls,agSortIndicator:Os,agTextColumnFloatingFilter:Ms,agNumberColumnFloatingFilter:Rs,agDateColumnFloatingFilter:gs,agReadOnlyFloatingFilter:Hr,agAnimateShowChangeCellRenderer:Ys,agAnimateSlideCellRenderer:Ks,agGroupCellRenderer:ho,agGroupRowRenderer:ho,agLoadingCellRenderer:fo,agCheckboxCellRenderer:To,agCellEditor:js,agTextCellEditor:js,agNumberCellEditor:bo,agDateCellEditor:wo,agDateStringCellEditor:Eo,agSelectCellEditor:Bs,agLargeTextCellEditor:$s,agCheckboxCellEditor:Do,agTextColumnFilter:Es,agNumberColumnFilter:_s,agDateColumnFilter:hs,agLoadingOverlay:go,agNoRowsOverlay:mo,agTooltipComponent:vo},this.enterpriseAgDefaultCompsModule={agSetColumnFilter:m.SetFilterModule,agSetColumnFloatingFilter:m.SetFilterModule,agMultiColumnFilter:m.MultiFilterModule,agMultiColumnFloatingFilter:m.MultiFilterModule,agGroupColumnFilter:m.RowGroupingModule,agGroupColumnFloatingFilter:m.RowGroupingModule,agRichSelect:m.RichSelectModule,agRichSelectCellEditor:m.RichSelectModule,agDetailCellRenderer:m.MasterDetailModule,agSparklineCellRenderer:m.SparklinesModule},this.jsComps={}}init(){null!=this.gridOptions.components&&a(this.gridOptions.components,(e,t)=>this.registerJsComponent(e,t))}registerDefaultComponent(e,t){this.agGridDefaults[e]?console.error("Trying to overwrite a default component. You should call registerComponent"):this.agGridDefaults[e]=t}registerJsComponent(e,t){this.jsComps[e]=t}retrieve(e,t){const i=(e,t)=>({componentFromFramework:t,component:e}),n=this.getFrameworkOverrides().frameworkComponent(t,this.gridOptions.components);if(null!=n)return i(n,!0);const r=this.jsComps[t];if(r){return i(r,this.getFrameworkOverrides().isFrameworkComponent(r))}const s=this.agGridDefaults[t];if(s)return i(s,!1);const o=this.enterpriseAgDefaultCompsModule[t];return o?v.__assertRegistered(o,`AG Grid '${e}' component: ${t}`,this.context.getGridId()):l(()=>{this.warnAboutMissingComponent(e,t)},"MissingComp"+t),null}warnAboutMissingComponent(e,t){const i=Yt(t,[...Object.keys(this.agGridDefaults).filter(e=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(e)),...Object.keys(this.jsComps)],!0,.8);console.warn(`AG Grid: Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.`),i.length>0&&console.warn(`         Did you mean: [${i.slice(0,3)}]?`),console.warn("If using a custom component check it has been registered as described in: https://ag-grid.com/javascript-data-grid/components/")}};Ro([o("gridOptions")],Mo.prototype,"gridOptions",void 0),Ro([r],Mo.prototype,"init",null),Mo=Ro([s("userComponentRegistry")],Mo);const No={propertyName:"dateComponent",cellRenderer:!1},Oo={propertyName:"headerComponent",cellRenderer:!1},Io={propertyName:"headerGroupComponent",cellRenderer:!1},Po={propertyName:"cellRenderer",cellRenderer:!0},ko={propertyName:"cellEditor",cellRenderer:!1},Lo={propertyName:"innerRenderer",cellRenderer:!0},Fo={propertyName:"loadingOverlayComponent",cellRenderer:!1},Go={propertyName:"noRowsOverlayComponent",cellRenderer:!1},$o={propertyName:"tooltipComponent",cellRenderer:!1},Ho={propertyName:"filter",cellRenderer:!1},Bo={propertyName:"floatingFilterComponent",cellRenderer:!1},Vo={propertyName:"toolPanel",cellRenderer:!1},Wo={propertyName:"statusPanel",cellRenderer:!1},zo={propertyName:"fullWidthCellRenderer",cellRenderer:!0},jo={propertyName:"loadingCellRenderer",cellRenderer:!0},Uo={propertyName:"groupRowRenderer",cellRenderer:!0},Yo={propertyName:"detailCellRenderer",cellRenderer:!0};class qo{static getFloatingFilterType(e){return this.filterToFloatingFilterMapping[e]}}qo.filterToFloatingFilterMapping={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"};var Ko=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Xo=class extends f{getHeaderCompDetails(e,t){return this.getCompDetails(e,Oo,"agColumnHeader",t)}getHeaderGroupCompDetails(e){const t=e.columnGroup.getColGroupDef();return this.getCompDetails(t,Io,"agColumnGroupHeader",e)}getFullWidthCellRendererDetails(e){return this.getCompDetails(this.gridOptions,zo,null,e,!0)}getFullWidthLoadingCellRendererDetails(e){return this.getCompDetails(this.gridOptions,jo,"agLoadingCellRenderer",e,!0)}getFullWidthGroupCellRendererDetails(e){return this.getCompDetails(this.gridOptions,Uo,"agGroupRowRenderer",e,!0)}getFullWidthDetailCellRendererDetails(e){return this.getCompDetails(this.gridOptions,Yo,"agDetailCellRenderer",e,!0)}getInnerRendererDetails(e,t){return this.getCompDetails(e,Lo,null,t)}getFullWidthGroupRowInnerCellRenderer(e,t){return this.getCompDetails(e,Lo,null,t)}getCellRendererDetails(e,t){return this.getCompDetails(e,Po,null,t)}getCellEditorDetails(e,t){return this.getCompDetails(e,ko,"agCellEditor",t,!0)}getFilterDetails(e,t,i){return this.getCompDetails(e,Ho,i,t,!0)}getDateCompDetails(e){return this.getCompDetails(this.gridOptions,No,"agDateInput",e,!0)}getLoadingOverlayCompDetails(e){return this.getCompDetails(this.gridOptions,Fo,"agLoadingOverlay",e,!0)}getNoRowsOverlayCompDetails(e){return this.getCompDetails(this.gridOptions,Go,"agNoRowsOverlay",e,!0)}getTooltipCompDetails(e){return this.getCompDetails(e.colDef,$o,"agTooltipComponent",e,!0)}getSetFilterCellRendererDetails(e,t){return this.getCompDetails(e,Po,null,t)}getFloatingFilterCompDetails(e,t,i){return this.getCompDetails(e,Bo,i,t)}getToolPanelCompDetails(e,t){return this.getCompDetails(e,Vo,null,t,!0)}getStatusPanelCompDetails(e,t){return this.getCompDetails(e,Wo,null,t,!0)}getCompDetails(e,t,i,n,r=!1){const{propertyName:s,cellRenderer:o}=t;let{compName:a,jsComp:l,fwComp:c,paramsFromSelector:u,popupFromSelector:d,popupPositionFromSelector:h}=this.getCompKeys(e,t,n);const p=e=>{const t=this.userComponentRegistry.retrieve(s,e);t&&(l=t.componentFromFramework?void 0:t.component,c=t.componentFromFramework?t.component:void 0)};if(null!=a&&p(a),null==l&&null==c&&null!=i&&p(i),l&&o&&!this.agComponentUtils.doesImplementIComponent(l)&&(l=this.agComponentUtils.adaptFunction(s,l)),!l&&!c)return void(r&&console.error(`AG Grid: Could not find component ${a}, did you forget to configure this component?`));const f=this.mergeParamsWithApplicationProvidedParams(e,t,n,u),g=null==l,m=l||c;return{componentFromFramework:g,componentClass:m,params:f,type:t,popupFromSelector:d,popupPositionFromSelector:h,newAgStackInstance:()=>this.newAgStackInstance(m,g,f,t)}}getCompKeys(n,r,s){const{propertyName:o}=r;let a,l,c,u,d,h;if(n){const r=n,e=r[o+"Selector"],t=e?e(s):null,i=e=>{if("string"==typeof e)a=e;else if(null!=e&&!0!==e){this.getFrameworkOverrides().isFrameworkComponent(e)?c=e:l=e}};t?(i(t.component),u=t.params,d=t.popup,h=t.popupPosition):i(r[o])}return{compName:a,jsComp:l,fwComp:c,paramsFromSelector:u,popupFromSelector:d,popupPositionFromSelector:h}}newAgStackInstance(e,t,i,n){const r=n.propertyName;let s;if(!t)s=new e;else{const t=this.componentMetadataProvider.retrieve(r);s=this.frameworkComponentWrapper.wrap(e,t.mandatoryMethodList,t.optionalMethodList,n)}const o=this.initComponent(s,i);return null==o?Rr.resolve(s):o.then(()=>s)}mergeParamsWithApplicationProvidedParams(e,t,i,n=null){const r={context:this.gridOptionsService.context,columnApi:this.gridOptionsService.columnApi,api:this.gridOptionsService.api};be(r,i);const s=e&&e[t.propertyName+"Params"];if("function"==typeof s){be(r,s(i))}else"object"==typeof s&&be(r,s);return be(r,n),r}initComponent(e,t){if(this.context.createBean(e),null!=e.init)return e.init(t)}getDefaultFloatingFilterType(e,t){if(null==e)return null;let i=null,{compName:n,jsComp:r,fwComp:s}=this.getCompKeys(e,Ho);if(n)i=qo.getFloatingFilterType(n);else{null==r&&null==s&&!0===e.filter&&(i=t())}return i}};var Qo;Ko([o("gridOptions")],Xo.prototype,"gridOptions",void 0),Ko([o("agComponentUtils")],Xo.prototype,"agComponentUtils",void 0),Ko([o("componentMetadataProvider")],Xo.prototype,"componentMetadataProvider",void 0),Ko([o("userComponentRegistry")],Xo.prototype,"userComponentRegistry",void 0),Ko([c("frameworkComponentWrapper")],Xo.prototype,"frameworkComponentWrapper",void 0),Xo=Ko([s("userComponentFactory")],Xo),function(e){e[e.SINGLE_SHEET=0]="SINGLE_SHEET",e[e.MULTI_SHEET=1]="MULTI_SHEET"}(Qo||(Qo={}));var Zo=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Jo=class extends f{constructor(){super(...arguments),this.dragEndFunctions=[],this.dragSources=[]}removeAllListeners(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0}removeListener(e){const t=e.dragSource.eElement,i=e.mouseDownListener;if(t.removeEventListener("mousedown",i),e.touchEnabled){const i=e.touchStartListener;t.removeEventListener("touchstart",i,{passive:!0})}}removeDragSource(t){const e=this.dragSources.find(e=>e.dragSource===t);e&&(this.removeListener(e),ot(this.dragSources,e))}isDragging(){return this.dragging}addDragSource(t){const e=this.onMouseDown.bind(this,t),{eElement:i,includeTouch:n,stopPropagationForTouch:r}=t;i.addEventListener("mousedown",e);let s=null;const o=this.gridOptionsService.is("suppressTouch");n&&!o&&(s=e=>{Rn(e.target)||(e.cancelable&&(e.preventDefault(),r&&e.stopPropagation()),this.onTouchStart(t,e))},i.addEventListener("touchstart",s,{passive:!1})),this.dragSources.push({dragSource:t,mouseDownListener:e,touchStartListener:s,touchEnabled:!!n})}getStartTarget(){return this.startTarget}onTouchStart(t,e){this.currentDragParams=t,this.dragging=!1;const i=e.touches[0];this.touchLastTime=i,this.touchStart=i;const n=e=>this.onTouchUp(e,t.eElement),r=e.target,s=[{target:this.gridOptionsService.getRootNode(),type:"touchmove",listener:e=>{e.cancelable&&e.preventDefault()},options:{passive:!1}},{target:r,type:"touchmove",listener:e=>this.onTouchMove(e,t.eElement),options:{passive:!0}},{target:r,type:"touchend",listener:n,options:{passive:!0}},{target:r,type:"touchcancel",listener:n,options:{passive:!0}}];this.addTemporaryEvents(s),0===t.dragStartPixels&&this.onCommonMove(i,this.touchStart,t.eElement)}onMouseDown(t,e){const i=e;if(t.skipMouseEvent&&t.skipMouseEvent(e))return;if(i._alreadyProcessedByDragService)return;if(i._alreadyProcessedByDragService=!0,0!==e.button)return;this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.currentDragParams=t,this.dragging=!1,this.mouseStartEvent=e,this.startTarget=e.target;const n=this.gridOptionsService.getRootNode(),r=[{target:n,type:"mousemove",listener:e=>this.onMouseMove(e,t.eElement)},{target:n,type:"mouseup",listener:e=>this.onMouseUp(e,t.eElement)},{target:n,type:"contextmenu",listener:e=>e.preventDefault()}];this.addTemporaryEvents(r),0===t.dragStartPixels&&this.onMouseMove(e,t.eElement)}addTemporaryEvents(e){e.forEach(e=>{const{target:t,type:i,listener:n,options:r}=e;t.addEventListener(i,n,r)}),this.dragEndFunctions.push(()=>{e.forEach(e=>{const{target:t,type:i,listener:n,options:r}=e;t.removeEventListener(i,n,r)})})}isEventNearStartEvent(e,t){const{dragStartPixels:i}=this.currentDragParams;return _r(e,t,_(i)?i:4)}getFirstActiveTouch(t){for(let e=0;e<t.length;e++)if(t[e].identifier===this.touchStart.identifier)return t[e];return null}onCommonMove(t,i,n){if(!this.dragging){if(!this.dragging&&this.isEventNearStartEvent(t,i))return;this.dragging=!0;const e={type:y.EVENT_DRAG_STARTED,target:n};this.eventService.dispatchEvent(e),this.currentDragParams.onDragStart(i),this.currentDragParams.onDragging(i)}this.currentDragParams.onDragging(t)}onTouchMove(e,t){const i=this.getFirstActiveTouch(e.touches);i&&this.onCommonMove(i,this.touchStart,t)}onMouseMove(e,t){this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,t)}shouldPreventMouseEvent(e){const t=this.gridOptionsService.is("enableCellTextSelection"),i=Qi(),n="mousemove"===e.type;return(t&&n||i)&&e.cancelable&&this.mouseEventService.isEventFromThisGrid(e)&&!this.isOverFormFieldElement(e)}isOverFormFieldElement(e){const t=e.target,i=null==t?void 0:t.tagName.toLocaleLowerCase();return!!(null==i?void 0:i.match("^a$|textarea|input|select|button"))}onTouchUp(e,t){let i=this.getFirstActiveTouch(e.changedTouches);i||(i=this.touchLastTime),this.onUpCommon(i,t)}onMouseUp(e,t){this.onUpCommon(e,t)}onUpCommon(t,i){if(this.dragging){this.dragging=!1,this.currentDragParams.onDragStop(t);const e={type:y.EVENT_DRAG_STOPPED,target:i};this.eventService.dispatchEvent(e)}this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach(e=>e()),this.dragEndFunctions.length=0}};var ea,ta;Zo([o("mouseEventService")],Jo.prototype,"mouseEventService",void 0),Zo([Ve],Jo.prototype,"removeAllListeners",null),Jo=Zo([s("dragService")],Jo),function(e){e[e.Above=0]="Above",e[e.Below=1]="Below"}(ea||(ea={})),function(e){e.EVERYTHING="group",e.FILTER="filter",e.SORT="sort",e.MAP="map",e.AGGREGATE="aggregate",e.FILTER_AGGREGATES="filter_aggregates",e.PIVOT="pivot",e.NOTHING="nothing"}(ta||(ta={}));var N=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};function ia(e){const t=e;return null!=t&&null!=t.getFrameworkComponentInstance?t.getFrameworkComponentInstance():e}let O=class{constructor(){this.detailGridInfoMap={},this.destroyCalled=!1}registerOverlayWrapperComp(e){this.overlayWrapperComp=e}registerSideBarComp(e){this.sideBarComp=e}init(){switch(this.rowModel.getType()){case"clientSide":this.clientSideRowModel=this.rowModel;break;case"infinite":this.infiniteRowModel=this.rowModel;break;case"serverSide":this.serverSideRowModel=this.rowModel}this.ctrlsService.whenReady(()=>{this.gridBodyCtrl=this.ctrlsService.getGridBodyCtrl()})}__getAlignedGridService(){return this.alignedGridsService}__getContext(){return this.context}getSetterMethod(e){return`set${e.charAt(0).toUpperCase()}${e.substring(1)}`}__setProperty(e,t){this.gridOptionsService.set(e,t);const i=this.getSetterMethod(e),n=this;n[i]&&n[i](t)}getGridId(){return this.context.getGridId()}addDetailGridInfo(e,t){this.detailGridInfoMap[e]=t}removeDetailGridInfo(e){this.detailGridInfoMap[e]=void 0}getDetailGridInfo(e){return this.detailGridInfoMap[e]}forEachDetailGridInfo(i){let n=0;a(this.detailGridInfoMap,(e,t)=>{_(t)&&(i(t,n),n++)})}getDataAsCsv(e){if(v.__assertRegistered(m.CsvExportModule,"api.getDataAsCsv",this.context.getGridId()))return this.csvCreator.getDataAsCsv(e)}exportDataAsCsv(e){v.__assertRegistered(m.CsvExportModule,"api.exportDataAsCSv",this.context.getGridId())&&this.csvCreator.exportDataAsCsv(e)}getExcelExportMode(e){const t=this.gridOptionsService.get("defaultExcelExportParams");return Object.assign({exportMode:"xlsx"},t,e).exportMode}assertNotExcelMultiSheet(e,t){if(!v.__assertRegistered(m.ExcelExportModule,"api."+e,this.context.getGridId()))return!1;const i=this.getExcelExportMode(t);return this.excelCreator.getFactoryMode(i)!==Qo.MULTI_SHEET||(console.warn("AG Grid: The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'"),!1)}getDataAsExcel(e){if(this.assertNotExcelMultiSheet("getDataAsExcel",e))return this.excelCreator.getDataAsExcel(e)}exportDataAsExcel(e){this.assertNotExcelMultiSheet("exportDataAsExcel",e)&&this.excelCreator.exportDataAsExcel(e)}getSheetDataForExcel(e){if(!v.__assertRegistered(m.ExcelExportModule,"api.getSheetDataForExcel",this.context.getGridId()))return;const t=this.getExcelExportMode(e);return this.excelCreator.setFactoryMode(Qo.MULTI_SHEET,t),this.excelCreator.getSheetDataForExcel(e)}getMultipleSheetsAsExcel(e){if(v.__assertRegistered(m.ExcelExportModule,"api.getMultipleSheetsAsExcel",this.context.getGridId()))return this.excelCreator.getMultipleSheetsAsExcel(e)}exportMultipleSheetsAsExcel(e){if(v.__assertRegistered(m.ExcelExportModule,"api.exportMultipleSheetsAsExcel",this.context.getGridId()))return this.excelCreator.exportMultipleSheetsAsExcel(e)}setGridAriaProperty(e,t){if(!e)return;const i=this.ctrlsService.getGridBodyCtrl().getGui(),n="aria-"+e;null===t?i.removeAttribute(n):i.setAttribute(n,t)}logMissingRowModel(e,...t){console.error(`AG Grid: api.${e} can only be called when gridOptions.rowModelType is ${t.join(" or ")}`)}setServerSideDatasource(e){this.serverSideRowModel?this.serverSideRowModel.setDatasource(e):this.logMissingRowModel("setServerSideDatasource","serverSide")}setCacheBlockSize(e){this.serverSideRowModel?(this.gridOptionsService.set("cacheBlockSize",e),this.serverSideRowModel.resetRootStore()):this.logMissingRowModel("setCacheBlockSize","serverSide")}setDatasource(e){this.gridOptionsService.isRowModelType("infinite")?this.rowModel.setDatasource(e):this.logMissingRowModel("setDatasource","infinite")}setViewportDatasource(e){this.gridOptionsService.isRowModelType("viewport")?this.rowModel.setViewportDatasource(e):this.logMissingRowModel("setViewportDatasource","viewport")}setRowData(e){null==this.immutableService?this.logMissingRowModel("setRowData","clientSide"):this.immutableService.isActive()?this.immutableService.setRowData(e):(this.selectionService.reset(),this.clientSideRowModel.setRowData(e))}setPinnedTopRowData(e){this.pinnedRowModel.setPinnedTopRowData(e)}setPinnedBottomRowData(e){this.pinnedRowModel.setPinnedBottomRowData(e)}getPinnedTopRowCount(){return this.pinnedRowModel.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.pinnedRowModel.getPinnedBottomRowCount()}getPinnedTopRow(e){return this.pinnedRowModel.getPinnedTopRow(e)}getPinnedBottomRow(e){return this.pinnedRowModel.getPinnedBottomRow(e)}setColumnDefs(e,t="api"){this.columnModel.setColumnDefs(e,t),this.gridOptionsService.set("columnDefs",e,!0,{source:t})}setAutoGroupColumnDef(e,t="api"){this.gridOptionsService.set("autoGroupColumnDef",e,!0,{source:t})}setDefaultColDef(e,t="api"){this.gridOptionsService.set("defaultColDef",e,!0,{source:t})}setColumnTypes(e,t="api"){this.gridOptionsService.set("columnTypes",e,!0,{source:t})}expireValueCache(){this.valueCache.expire()}getVerticalPixelRange(){return this.gridBodyCtrl.getScrollFeature().getVScrollPosition()}getHorizontalPixelRange(){return this.gridBodyCtrl.getScrollFeature().getHScrollPosition()}setAlwaysShowHorizontalScroll(e){this.gridOptionsService.set("alwaysShowHorizontalScroll",e)}setAlwaysShowVerticalScroll(e){this.gridOptionsService.set("alwaysShowVerticalScroll",e)}refreshCells(e={}){this.rowRenderer.refreshCells(e)}flashCells(e={}){this.rowRenderer.flashCells(e)}redrawRows(e={}){const t=e?e.rowNodes:void 0;this.rowRenderer.redrawRows(t)}setFunctionsReadOnly(e){this.gridOptionsService.set("functionsReadOnly",e)}refreshHeader(){this.ctrlsService.getHeaderRowContainerCtrls().forEach(e=>e.refresh())}isAnyFilterPresent(){return this.filterManager.isAnyFilterPresent()}isColumnFilterPresent(){return this.filterManager.isColumnFilterPresent()||this.filterManager.isAggregateFilterPresent()}isQuickFilterPresent(){return this.filterManager.isQuickFilterPresent()}getModel(){return this.rowModel}setRowNodeExpanded(e,t,i){e&&(i&&e.parent&&-1!==e.parent.level&&this.setRowNodeExpanded(e.parent,t,i),e.setExpanded(t))}onGroupExpandedOrCollapsed(){u(this.clientSideRowModel)?this.logMissingRowModel("onGroupExpandedOrCollapsed","clientSide"):this.clientSideRowModel.refreshModel({step:ta.MAP})}refreshClientSideRowModel(e){u(this.clientSideRowModel)?this.logMissingRowModel("refreshClientSideRowModel","clientSide"):this.clientSideRowModel.refreshModel(e)}isAnimationFrameQueueEmpty(){return this.animationFrameService.isQueueEmpty()}flushAllAnimationFrames(){this.animationFrameService.flushAllFrames()}getRowNode(e){return this.rowModel.getRowNode(e)}getSizesForCurrentTheme(){return{rowHeight:this.gridOptionsService.getRowHeightAsNumber(),headerHeight:this.columnModel.getHeaderHeight()}}expandAll(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!0):this.serverSideRowModel?this.serverSideRowModel.expandAll(!0):this.logMissingRowModel("expandAll","clientSide","serverSide")}collapseAll(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!1):this.serverSideRowModel?this.serverSideRowModel.expandAll(!1):this.logMissingRowModel("expandAll","clientSide","serverSide")}addRenderedRowListener(e,t,i){this.rowRenderer.addRenderedRowListener(e,t,i)}getQuickFilter(){return this.gridOptionsService.get("quickFilterText")}setQuickFilter(e){this.gridOptionsService.set("quickFilterText",e)}setExcludeHiddenColumnsFromQuickFilter(e){Xt("30","setExcludeHiddenColumnsFromQuickFilter",void 0,"Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `setIncludeHiddenColumnsInQuickFilter`"),this.setIncludeHiddenColumnsInQuickFilter(!e)}setIncludeHiddenColumnsInQuickFilter(e){this.gridOptionsService.set("includeHiddenColumnsInQuickFilter",e)}setNodesSelected(e){if(!e.nodes.every(e=>e.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),!1):void 0!==e.id||(console.warn("AG Grid: cannot select node until id for node is known"),!1)))return;const{nodes:t,source:i,newValue:n}=e,r=t;this.selectionService.setNodesSelected({nodes:r,source:null!=i?i:"api",newValue:n})}selectAll(e="apiSelectAll"){this.selectionService.selectAllRowNodes({source:e})}deselectAll(e="apiSelectAll"){this.selectionService.deselectAllRowNodes({source:e})}selectAllFiltered(e="apiSelectAllFiltered"){this.selectionService.selectAllRowNodes({source:e,justFiltered:!0})}deselectAllFiltered(e="apiSelectAllFiltered"){this.selectionService.deselectAllRowNodes({source:e,justFiltered:!0})}getServerSideSelectionState(){return u(this.serverSideRowModel)?(this.logMissingRowModel("getServerSideSelectionState","serverSide"),null):this.selectionService.getServerSideSelectionState()}setServerSideSelectionState(e){u(this.serverSideRowModel)?this.logMissingRowModel("setServerSideSelectionState","serverSide"):this.selectionService.setServerSideSelectionState(e)}selectAllOnCurrentPage(e="apiSelectAllCurrentPage"){this.selectionService.selectAllRowNodes({source:e,justCurrentPage:!0})}deselectAllOnCurrentPage(e="apiSelectAllCurrentPage"){this.selectionService.deselectAllRowNodes({source:e,justCurrentPage:!0})}sizeColumnsToFit(e){this.gridBodyCtrl.sizeColumnsToFit(e)}showLoadingOverlay(){this.overlayWrapperComp.showLoadingOverlay()}showNoRowsOverlay(){this.overlayWrapperComp.showNoRowsOverlay()}hideOverlay(){this.overlayWrapperComp.hideOverlay()}getSelectedNodes(){return this.selectionService.getSelectedNodes()}getSelectedRows(){return this.selectionService.getSelectedRows()}getBestCostNodeSelection(){if(!u(this.clientSideRowModel))return this.selectionService.getBestCostNodeSelection();this.logMissingRowModel("getBestCostNodeSelection","clientSide")}getRenderedNodes(){return this.rowRenderer.getRenderedNodes()}ensureColumnVisible(e,t="auto"){this.gridBodyCtrl.getScrollFeature().ensureColumnVisible(e,t)}ensureIndexVisible(e,t){this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(e,t)}ensureNodeVisible(e,t=null){this.gridBodyCtrl.getScrollFeature().ensureNodeVisible(e,t)}forEachLeafNode(e){u(this.clientSideRowModel)?this.logMissingRowModel("forEachLeafNode","clientSide"):this.clientSideRowModel.forEachLeafNode(e)}forEachNode(e,t){this.rowModel.forEachNode(e,t)}forEachNodeAfterFilter(e){u(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilter","clientSide"):this.clientSideRowModel.forEachNodeAfterFilter(e)}forEachNodeAfterFilterAndSort(e){u(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilterAndSort","clientSide"):this.clientSideRowModel.forEachNodeAfterFilterAndSort(e)}getFilterInstance(e,i){const t=this.getFilterInstanceImpl(e,e=>{if(!i)return;const t=ia(e);i(t)});return ia(t)}getFilterInstanceImpl(e,t){const i=this.columnModel.getPrimaryColumn(e);if(!i)return;const n=this.filterManager.getFilterComponent(i,"NO_UI"),r=n&&n.resolveNow(null,e=>e);return r?setTimeout(t,0,r):n&&n.then(e=>{t(e)}),r}destroyFilter(e){const t=this.columnModel.getPrimaryColumn(e);if(t)return this.filterManager.destroyFilter(t,"api")}getStatusPanel(e){if(!v.__assertRegistered(m.StatusBarModule,"api.getStatusPanel",this.context.getGridId()))return;return ia(this.statusBarService.getStatusPanel(e))}getColumnDef(e){const t=this.columnModel.getPrimaryColumn(e);return t?t.getColDef():null}getColumnDefs(){return this.columnModel.getColumnDefs()}onFilterChanged(){this.filterManager.onFilterChanged()}onSortChanged(){this.sortController.onSortChanged("api")}setFilterModel(e){this.filterManager.setFilterModel(e)}getFilterModel(){return this.filterManager.getFilterModel()}getFocusedCell(){return this.focusService.getFocusedCell()}clearFocusedCell(){return this.focusService.clearFocusedCell()}setFocusedCell(e,t,i){this.focusService.setFocusedCell({rowIndex:e,column:t,rowPinned:i,forceBrowserFocus:!0})}setSuppressRowDrag(e){this.gridOptionsService.set("suppressRowDrag",e)}setSuppressMoveWhenRowDragging(e){this.gridOptionsService.set("suppressMoveWhenRowDragging",e)}setSuppressRowClickSelection(e){this.gridOptionsService.set("suppressRowClickSelection",e)}addRowDropZone(e){this.gridBodyCtrl.getRowDragFeature().addRowDropZone(e)}removeRowDropZone(e){const t=this.dragAndDropService.findExternalZone(e);t&&this.dragAndDropService.removeDropTarget(t)}getRowDropZoneParams(e){return this.gridBodyCtrl.getRowDragFeature().getRowDropZone(e)}setHeaderHeight(e){this.gridOptionsService.set("headerHeight",e)}setDomLayout(e){this.gridOptionsService.set("domLayout",e)}setEnableCellTextSelection(e){this.gridBodyCtrl.setCellTextSelection(e)}setFillHandleDirection(e){this.gridOptionsService.set("fillHandleDirection",e)}setGroupHeaderHeight(e){this.gridOptionsService.set("groupHeaderHeight",e)}setFloatingFiltersHeight(e){this.gridOptionsService.set("floatingFiltersHeight",e)}setPivotHeaderHeight(e){this.gridOptionsService.set("pivotHeaderHeight",e)}setPivotGroupHeaderHeight(e){this.gridOptionsService.set("pivotGroupHeaderHeight",e)}setPivotMode(e){this.columnModel.setPivotMode(e)}setAnimateRows(e){this.gridOptionsService.set("animateRows",e)}setIsExternalFilterPresent(e){this.gridOptionsService.set("isExternalFilterPresent",e)}setDoesExternalFilterPass(e){this.gridOptionsService.set("doesExternalFilterPass",e)}setNavigateToNextCell(e){this.gridOptionsService.set("navigateToNextCell",e)}setTabToNextCell(e){this.gridOptionsService.set("tabToNextCell",e)}setTabToNextHeader(e){this.gridOptionsService.set("tabToNextHeader",e)}setNavigateToNextHeader(e){this.gridOptionsService.set("navigateToNextHeader",e)}setRowGroupPanelShow(e){this.gridOptionsService.set("rowGroupPanelShow",e)}setGetGroupRowAgg(e){this.gridOptionsService.set("getGroupRowAgg",e)}setGetBusinessKeyForNode(e){this.gridOptionsService.set("getBusinessKeyForNode",e)}setGetChildCount(e){this.gridOptionsService.set("getChildCount",e)}setProcessRowPostCreate(e){this.gridOptionsService.set("processRowPostCreate",e)}setGetRowId(e){this.gridOptionsService.set("getRowId",e)}setGetRowClass(e){this.gridOptionsService.set("getRowClass",e)}setIsFullWidthRow(e){this.gridOptionsService.set("isFullWidthRow",e)}setIsRowSelectable(e){this.gridOptionsService.set("isRowSelectable",e)}setIsRowMaster(e){this.gridOptionsService.set("isRowMaster",e)}setPostSortRows(e){this.gridOptionsService.set("postSortRows",e)}setGetDocument(e){this.gridOptionsService.set("getDocument",e)}setGetContextMenuItems(e){this.gridOptionsService.set("getContextMenuItems",e)}setGetMainMenuItems(e){this.gridOptionsService.set("getMainMenuItems",e)}setProcessCellForClipboard(e){this.gridOptionsService.set("processCellForClipboard",e)}setSendToClipboard(e){this.gridOptionsService.set("sendToClipboard",e)}setProcessCellFromClipboard(e){this.gridOptionsService.set("processCellFromClipboard",e)}setProcessSecondaryColDef(e){Xt("28.0","setProcessSecondaryColDef","setProcessPivotResultColDef"),this.setProcessPivotResultColDef(e)}setProcessSecondaryColGroupDef(e){Xt("28.0","setProcessSecondaryColGroupDef","setProcessPivotResultColGroupDef"),this.setProcessPivotResultColGroupDef(e)}setProcessPivotResultColDef(e){this.gridOptionsService.set("processPivotResultColDef",e)}setProcessPivotResultColGroupDef(e){this.gridOptionsService.set("processPivotResultColGroupDef",e)}setPostProcessPopup(e){this.gridOptionsService.set("postProcessPopup",e)}setInitialGroupOrderComparator(e){this.gridOptionsService.set("initialGroupOrderComparator",e)}setGetChartToolbarItems(e){this.gridOptionsService.set("getChartToolbarItems",e)}setPaginationNumberFormatter(e){this.gridOptionsService.set("paginationNumberFormatter",e)}setGetServerSideStoreParams(e){Xt("28.0","setGetServerSideStoreParams","setGetServerSideGroupLevelParams"),this.setGetServerSideGroupLevelParams(e)}setGetServerSideGroupLevelParams(e){this.gridOptionsService.set("getServerSideGroupLevelParams",e)}setIsServerSideGroupOpenByDefault(e){this.gridOptionsService.set("isServerSideGroupOpenByDefault",e)}setIsApplyServerSideTransaction(e){this.gridOptionsService.set("isApplyServerSideTransaction",e)}setIsServerSideGroup(e){this.gridOptionsService.set("isServerSideGroup",e)}setGetServerSideGroupKey(e){this.gridOptionsService.set("getServerSideGroupKey",e)}setGetRowStyle(e){this.gridOptionsService.set("getRowStyle",e)}setGetRowHeight(e){this.gridOptionsService.set("getRowHeight",e)}assertSideBarLoaded(e){return v.__assertRegistered(m.SideBarModule,"api."+e,this.context.getGridId())}isSideBarVisible(){return this.assertSideBarLoaded("isSideBarVisible")&&this.sideBarComp.isDisplayed()}setSideBarVisible(e){this.assertSideBarLoaded("setSideBarVisible")&&this.sideBarComp.setDisplayed(e)}setSideBarPosition(e){this.assertSideBarLoaded("setSideBarPosition")&&this.sideBarComp.setSideBarPosition(e)}openToolPanel(e){this.assertSideBarLoaded("openToolPanel")&&this.sideBarComp.openToolPanel(e,"api")}closeToolPanel(){this.assertSideBarLoaded("closeToolPanel")&&this.sideBarComp.close("api")}getOpenedToolPanel(){return this.assertSideBarLoaded("getOpenedToolPanel")?this.sideBarComp.openedItem():null}refreshToolPanel(){this.assertSideBarLoaded("refreshToolPanel")&&this.sideBarComp.refresh()}isToolPanelShowing(){return this.assertSideBarLoaded("isToolPanelShowing")&&this.sideBarComp.isToolPanelShowing()}getToolPanelInstance(e){if(this.assertSideBarLoaded("getToolPanelInstance")){return ia(this.sideBarComp.getToolPanelInstance(e))}}getSideBar(){if(this.assertSideBarLoaded("getSideBar"))return this.sideBarComp.getDef()}setSideBar(e){this.gridOptionsService.set("sideBar",e)}setSuppressClipboardPaste(e){this.gridOptionsService.set("suppressClipboardPaste",e)}resetRowHeights(){if(_(this.clientSideRowModel)){if(this.columnModel.isAutoRowHeightActive())return void console.warn("AG Grid: calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.");this.clientSideRowModel.resetRowHeights()}}setGroupRemoveSingleChildren(e){this.gridOptionsService.set("groupRemoveSingleChildren",e)}setGroupRemoveLowestSingleChildren(e){this.gridOptionsService.set("groupRemoveLowestSingleChildren",e)}setGroupDisplayType(e){this.gridOptionsService.set("groupDisplayType",e)}setRowClass(e){this.gridOptionsService.set("rowClass",e)}setDeltaSort(e){this.gridOptionsService.set("deltaSort",e)}setRowCount(e,t){if(this.serverSideRowModel)return this.columnModel.isRowGroupEmpty()?void this.serverSideRowModel.setRowCount(e,t):void console.error("AG Grid: setRowCount cannot be used while using row grouping.");this.infiniteRowModel?this.infiniteRowModel.setRowCount(e,t):this.logMissingRowModel("setRowCount","infinite","serverSide")}onRowHeightChanged(){this.clientSideRowModel?this.clientSideRowModel.onRowHeightChanged():this.serverSideRowModel&&this.serverSideRowModel.onRowHeightChanged()}getValue(e,t){let i=this.columnModel.getPrimaryColumn(e);return u(i)&&(i=this.columnModel.getGridColumn(e)),u(i)?null:this.valueService.getValue(i,t)}addEventListener(e,t){const i=this.gridOptionsService.useAsyncEvents();this.eventService.addEventListener(e,t,i)}addGlobalListener(e){const t=this.gridOptionsService.useAsyncEvents();this.eventService.addGlobalListener(e,t)}removeEventListener(e,t){const i=this.gridOptionsService.useAsyncEvents();this.eventService.removeEventListener(e,t,i)}removeGlobalListener(e){const t=this.gridOptionsService.useAsyncEvents();this.eventService.removeGlobalListener(e,t)}dispatchEvent(e){this.eventService.dispatchEvent(e)}destroy(){if(this.destroyCalled)return;this.destroyCalled=!0;const e=this.ctrlsService.getGridCtrl();e&&e.destroyGridUi(),this.context.destroy()}cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid(){setTimeout(Ee.bind(window,this,"Grid API"),100)}warnIfDestroyed(e){return this.destroyCalled&&console.warn(`AG Grid: Grid API method ${e} was called on a grid that was destroyed.`),this.destroyCalled}resetQuickFilter(){this.warnIfDestroyed("resetQuickFilter")||this.filterManager.resetQuickFilterCache()}getCellRanges(){return this.rangeService?this.rangeService.getCellRanges():(v.__assertRegistered(m.RangeSelectionModule,"api.getCellRanges",this.context.getGridId()),null)}addCellRange(e){this.rangeService?this.rangeService.addCellRange(e):v.__assertRegistered(m.RangeSelectionModule,"api.addCellRange",this.context.getGridId())}clearRangeSelection(){this.rangeService&&this.rangeService.removeAllCellRanges(),v.__assertRegistered(m.RangeSelectionModule,"gridApi.clearRangeSelection",this.context.getGridId())}undoCellEditing(){this.undoRedoService.undo("api")}redoCellEditing(){this.undoRedoService.redo("api")}getCurrentUndoSize(){return this.undoRedoService.getCurrentUndoStackSize()}getCurrentRedoSize(){return this.undoRedoService.getCurrentRedoStackSize()}getChartModels(){if(v.__assertRegistered(m.GridChartsModule,"api.getChartModels",this.context.getGridId()))return this.chartService.getChartModels()}getChartRef(e){if(v.__assertRegistered(m.GridChartsModule,"api.getChartRef",this.context.getGridId()))return this.chartService.getChartRef(e)}getChartImageDataURL(e){if(v.__assertRegistered(m.GridChartsModule,"api.getChartImageDataURL",this.context.getGridId()))return this.chartService.getChartImageDataURL(e)}downloadChart(e){if(v.__assertRegistered(m.GridChartsModule,"api.downloadChart",this.context.getGridId()))return this.chartService.downloadChart(e)}openChartToolPanel(e){if(v.__assertRegistered(m.GridChartsModule,"api.openChartToolPanel",this.context.getGridId()))return this.chartService.openChartToolPanel(e)}closeChartToolPanel(e){if(v.__assertRegistered(m.GridChartsModule,"api.closeChartToolPanel",this.context.getGridId()))return this.chartService.closeChartToolPanel(e.chartId)}createRangeChart(e){if(v.__assertRegistered(m.GridChartsModule,"api.createRangeChart",this.context.getGridId()))return this.chartService.createRangeChart(e)}createPivotChart(e){if(v.__assertRegistered(m.GridChartsModule,"api.createPivotChart",this.context.getGridId()))return this.chartService.createPivotChart(e)}createCrossFilterChart(e){if(v.__assertRegistered(m.GridChartsModule,"api.createCrossFilterChart",this.context.getGridId()))return this.chartService.createCrossFilterChart(e)}updateChart(e){v.__assertRegistered(m.GridChartsModule,"api.updateChart",this.context.getGridId())&&this.chartService.updateChart(e)}restoreChart(e,t){if(v.__assertRegistered(m.GridChartsModule,"api.restoreChart",this.context.getGridId()))return this.chartService.restoreChart(e,t)}copyToClipboard(e){v.__assertRegistered(m.ClipboardModule,"api.copyToClipboard",this.context.getGridId())&&this.clipboardService.copyToClipboard(e)}cutToClipboard(e){v.__assertRegistered(m.ClipboardModule,"api.cutToClipboard",this.context.getGridId())&&this.clipboardService.cutToClipboard(e,"api")}copySelectedRowsToClipboard(e){v.__assertRegistered(m.ClipboardModule,"api.copySelectedRowsToClipboard",this.context.getGridId())&&this.clipboardService.copySelectedRowsToClipboard(e)}copySelectedRangeToClipboard(e){v.__assertRegistered(m.ClipboardModule,"api.copySelectedRangeToClipboard",this.context.getGridId())&&this.clipboardService.copySelectedRangeToClipboard(e)}copySelectedRangeDown(){v.__assertRegistered(m.ClipboardModule,"api.copySelectedRangeDown",this.context.getGridId())&&this.clipboardService.copyRangeDown()}pasteFromClipboard(){v.__assertRegistered(m.ClipboardModule,"api.pasteFromClipboard",this.context.getGridId())&&this.clipboardService.pasteFromClipboard()}showColumnMenuAfterButtonClick(e,t){const i=this.columnModel.getGridColumn(e);this.menuFactory.showMenuAfterButtonClick(i,t,"columnMenu")}showColumnMenuAfterMouseClick(e,t){let i=this.columnModel.getGridColumn(e);i||(i=this.columnModel.getPrimaryColumn(e)),i?this.menuFactory.showMenuAfterMouseEvent(i,t):console.error(`AG Grid: column '${e}' not found`)}hidePopupMenu(){this.contextMenuFactory&&this.contextMenuFactory.hideActiveMenu(),this.menuFactory.hideActiveMenu()}setPopupParent(e){this.gridOptionsService.set("popupParent",e)}tabToNextCell(e){return this.navigationService.tabToNextCell(!1,e)}tabToPreviousCell(e){return this.navigationService.tabToNextCell(!0,e)}getCellRendererInstances(e={}){return this.rowRenderer.getCellRendererInstances(e).map(ia)}getCellEditorInstances(e={}){return this.rowRenderer.getCellEditorInstances(e).map(ia)}getEditingCells(){return this.rowRenderer.getEditingCells()}stopEditing(e=!1){this.rowRenderer.stopEditing(e)}startEditingCell(e){const t=this.columnModel.getGridColumn(e.colKey);if(!t)return void console.warn("AG Grid: no column found for "+e.colKey);const i={rowIndex:e.rowIndex,rowPinned:e.rowPinned||null,column:t};null==e.rowPinned&&this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(e.rowIndex);const n=this.navigationService.getCellByPosition(i);n&&n.startRowOrCellEdit(e.key)}addAggFunc(e,t){this.aggFuncService&&this.aggFuncService.addAggFunc(e,t)}addAggFuncs(e){this.aggFuncService&&this.aggFuncService.addAggFuncs(e)}clearAggFuncs(){this.aggFuncService&&this.aggFuncService.clear()}applyServerSideTransaction(e){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransaction(e);this.logMissingRowModel("applyServerSideTransaction","serverSide")}applyServerSideTransactionAsync(e,t){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransactionAsync(e,t);this.logMissingRowModel("applyServerSideTransactionAsync","serverSide")}retryServerSideLoads(){this.serverSideRowModel?this.serverSideRowModel.retryLoads():this.logMissingRowModel("retryServerSideLoads","serverSide")}flushServerSideAsyncTransactions(){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.flushAsyncTransactions();this.logMissingRowModel("flushServerSideAsyncTransactions","serverSide")}applyTransaction(e){if(this.clientSideRowModel)return this.clientSideRowModel.updateRowData(e);this.logMissingRowModel("applyTransaction","clientSide")}applyTransactionAsync(e,t){this.clientSideRowModel?this.clientSideRowModel.batchUpdateRowData(e,t):this.logMissingRowModel("applyTransactionAsync","clientSide")}flushAsyncTransactions(){this.clientSideRowModel?this.clientSideRowModel.flushAsyncTransactions():this.logMissingRowModel("flushAsyncTransactions","clientSide")}setSuppressModelUpdateAfterUpdateTransaction(e){this.gridOptionsService.set("suppressModelUpdateAfterUpdateTransaction",e)}refreshInfiniteCache(){this.infiniteRowModel?this.infiniteRowModel.refreshCache():this.logMissingRowModel("refreshInfiniteCache","infinite")}purgeInfiniteCache(){this.infiniteRowModel?this.infiniteRowModel.purgeCache():this.logMissingRowModel("purgeInfiniteCache","infinite")}refreshServerSide(e){this.serverSideRowModel?this.serverSideRowModel.refreshStore(e):this.logMissingRowModel("refreshServerSide","serverSide")}refreshServerSideStore(e){return Xt("28.0","refreshServerSideStore","refreshServerSide"),this.refreshServerSide(e)}getServerSideStoreState(){return Xt("28.0","getServerSideStoreState","getServerSideGroupLevelState"),this.getServerSideGroupLevelState()}getServerSideGroupLevelState(){return this.serverSideRowModel?this.serverSideRowModel.getStoreState():(this.logMissingRowModel("getServerSideGroupLevelState","serverSide"),[])}getInfiniteRowCount(){if(this.infiniteRowModel)return this.infiniteRowModel.getRowCount();this.logMissingRowModel("getInfiniteRowCount","infinite")}isLastRowIndexKnown(){if(this.infiniteRowModel)return this.infiniteRowModel.isLastRowIndexKnown();this.logMissingRowModel("isLastRowIndexKnown","infinite")}getCacheBlockState(){return this.rowNodeBlockLoader.getBlockState()}getFirstDisplayedRow(){return this.rowRenderer.getFirstVirtualRenderedRow()}getLastDisplayedRow(){return this.rowRenderer.getLastVirtualRenderedRow()}getDisplayedRowAtIndex(e){return this.rowModel.getRow(e)}getDisplayedRowCount(){return this.rowModel.getRowCount()}setDataTypeDefinitions(e){this.gridOptionsService.set("dataTypeDefinitions",e)}setPagination(e){this.gridOptionsService.set("pagination",e)}paginationIsLastPageFound(){return this.paginationProxy.isLastPageFound()}paginationGetPageSize(){return this.paginationProxy.getPageSize()}paginationSetPageSize(e){this.gridOptionsService.set("paginationPageSize",e)}paginationGetCurrentPage(){return this.paginationProxy.getCurrentPage()}paginationGetTotalPages(){return this.paginationProxy.getTotalPages()}paginationGetRowCount(){return this.paginationProxy.getMasterRowCount()}paginationGoToNextPage(){this.paginationProxy.goToNextPage()}paginationGoToPreviousPage(){this.paginationProxy.goToPreviousPage()}paginationGoToFirstPage(){this.paginationProxy.goToFirstPage()}paginationGoToLastPage(){this.paginationProxy.goToLastPage()}paginationGoToPage(e){this.paginationProxy.goToPage(e)}};N([c("immutableService")],O.prototype,"immutableService",void 0),N([c("csvCreator")],O.prototype,"csvCreator",void 0),N([c("excelCreator")],O.prototype,"excelCreator",void 0),N([o("rowRenderer")],O.prototype,"rowRenderer",void 0),N([o("navigationService")],O.prototype,"navigationService",void 0),N([o("filterManager")],O.prototype,"filterManager",void 0),N([o("columnModel")],O.prototype,"columnModel",void 0),N([o("selectionService")],O.prototype,"selectionService",void 0),N([o("gridOptionsService")],O.prototype,"gridOptionsService",void 0),N([o("valueService")],O.prototype,"valueService",void 0),N([o("alignedGridsService")],O.prototype,"alignedGridsService",void 0),N([o("eventService")],O.prototype,"eventService",void 0),N([o("pinnedRowModel")],O.prototype,"pinnedRowModel",void 0),N([o("context")],O.prototype,"context",void 0),N([o("rowModel")],O.prototype,"rowModel",void 0),N([o("sortController")],O.prototype,"sortController",void 0),N([o("paginationProxy")],O.prototype,"paginationProxy",void 0),N([o("focusService")],O.prototype,"focusService",void 0),N([o("dragAndDropService")],O.prototype,"dragAndDropService",void 0),N([c("rangeService")],O.prototype,"rangeService",void 0),N([c("clipboardService")],O.prototype,"clipboardService",void 0),N([c("aggFuncService")],O.prototype,"aggFuncService",void 0),N([o("menuFactory")],O.prototype,"menuFactory",void 0),N([c("contextMenuFactory")],O.prototype,"contextMenuFactory",void 0),N([o("valueCache")],O.prototype,"valueCache",void 0),N([o("animationFrameService")],O.prototype,"animationFrameService",void 0),N([c("statusBarService")],O.prototype,"statusBarService",void 0),N([c("chartService")],O.prototype,"chartService",void 0),N([c("undoRedoService")],O.prototype,"undoRedoService",void 0),N([c("rowNodeBlockLoader")],O.prototype,"rowNodeBlockLoader",void 0),N([c("ssrmTransactionManager")],O.prototype,"serverSideTransactionManager",void 0),N([o("ctrlsService")],O.prototype,"ctrlsService",void 0),N([r],O.prototype,"init",null),N([Ve],O.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),O=N([s("gridApi")],O);var na,ra=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let sa=na=class extends f{constructor(){super(...arguments),this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.quickFilter=null,this.quickFilterParts=null,this.processingFilterChange=!1}init(){this.addManagedListener(this.eventService,y.EVENT_GRID_COLUMNS_CHANGED,()=>this.onColumnsChanged()),this.addManagedListener(this.eventService,y.EVENT_COLUMN_VALUE_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PIVOT_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>{this.refreshFiltersForAggregations(),this.resetQuickFilterCache()}),this.addManagedListener(this.eventService,y.EVENT_NEW_COLUMNS_LOADED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,y.EVENT_COLUMN_VISIBLE,()=>{this.gridOptionsService.is("includeHiddenColumnsInQuickFilter")||this.resetQuickFilterCache()}),this.addManagedPropertyListener("quickFilterText",e=>this.setQuickFilter(e.currentValue)),this.addManagedPropertyListener("includeHiddenColumnsInQuickFilter",()=>this.onIncludeHiddenColumnsInQuickFilterChanged()),this.quickFilter=this.parseQuickFilter(this.gridOptionsService.get("quickFilterText")),this.setQuickFilterParts(),this.allowShowChangeAfterFilter=this.gridOptionsService.is("allowShowChangeAfterFilter"),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>this.updateAggFiltering())}isExternalFilterPresentCallback(){const e=this.gridOptionsService.getCallback("isExternalFilterPresent");return"function"==typeof e&&e({})}doesExternalFilterPass(e){const t=this.gridOptionsService.get("doesExternalFilterPass");return"function"==typeof t&&t(e)}setQuickFilterParts(){this.quickFilterParts=this.quickFilter?this.quickFilter.split(" "):null}setFilterModel(n){const r=[],o=this.getFilterModel();if(n){const o=Sr(Object.keys(n));this.allColumnFilters.forEach((e,t)=>{const i=n[t];r.push(this.setModelOnFilterWrapper(e.filterPromise,i)),o.delete(t)}),o.forEach(e=>{const t=this.columnModel.getPrimaryColumn(e)||this.columnModel.getGridColumn(e);if(!t)return void console.warn("AG Grid: setFilterModel() - no column found for colId: "+e);if(!t.isFilterAllowed())return void console.warn("AG Grid: setFilterModel() - unable to fully apply model, filtering disabled for colId: "+e);const i=this.getOrCreateFilterWrapper(t,"NO_UI");i?r.push(this.setModelOnFilterWrapper(i.filterPromise,n[e])):console.warn("AG-Grid: setFilterModel() - unable to fully apply model, unable to create filter for colId: "+e)})}else this.allColumnFilters.forEach(e=>{r.push(this.setModelOnFilterWrapper(e.filterPromise,null))});Rr.all(r).then(()=>{const r=this.getFilterModel(),s=[];this.allColumnFilters.forEach((e,t)=>{const i=o?o[t]:null,n=r?r[t]:null;Tr.jsonEquals(i,n)||s.push(e.column)}),s.length>0&&this.onFilterChanged({columns:s})})}setModelOnFilterWrapper(e,i){return new Rr(t=>{e.then(e=>{"function"!=typeof e.setModel&&(console.warn("AG Grid: filter missing setModel method, which is needed for setFilterModel"),t()),(e.setModel(i)||Rr.resolve()).then(()=>t())})})}getFilterModel(){const r={};return this.allColumnFilters.forEach((e,t)=>{const i=e.filterPromise.resolveNow(null,e=>e);if(null==i)return null;if("function"!=typeof i.getModel)return void console.warn("AG Grid: filter API missing getModel method, which is needed for getFilterModel");const n=i.getModel();_(n)&&(r[t]=n)}),r}isColumnFilterPresent(){return this.activeColumnFilters.length>0}isAggregateFilterPresent(){return!!this.activeAggregateFilters.length}isExternalFilterPresent(){return this.externalFilterPresent}doAggregateFiltersPass(e,t){return this.doColumnFiltersPass(e,t,!0)}updateActiveFilters(){this.activeColumnFilters.length=0,this.activeAggregateFilters.length=0;const t=e=>!!e&&(e.isFilterActive?e.isFilterActive():(console.warn("AG Grid: Filter is missing isFilterActive() method"),!1)),i=!!this.gridOptionsService.getGroupAggFiltering(),n=e=>{if(!e.isPrimary())return!0;const t=!this.columnModel.isPivotActive();return!(!e.isValueActive()||!t)&&(!!this.columnModel.isPivotMode()||i)};this.allColumnFilters.forEach(e=>{if(e.filterPromise.resolveNow(!1,t)){const t=e.filterPromise.resolveNow(null,e=>e);n(e.column)?this.activeAggregateFilters.push(t):this.activeColumnFilters.push(t)}})}updateFilterFlagInColumns(i,n){this.allColumnFilters.forEach(e=>{const t=e.filterPromise.resolveNow(!1,e=>e.isFilterActive());e.column.setFilterActive(t,i,n)})}isAnyFilterPresent(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()}doColumnFiltersPass(t,i,e){const{data:n,aggData:r}=t,s=e?this.activeAggregateFilters:this.activeColumnFilters,o=e?r:n;for(let e=0;e<s.length;e++){const n=s[e];if(null!=n&&n!==i){if("function"!=typeof n.doesFilterPass)throw new Error("Filter is missing method doesFilterPass");if(!n.doesFilterPass({node:t,data:o}))return!1}}return!0}parseQuickFilter(e){return _(e)?this.gridOptionsService.isRowModelType("clientSide")?e.toUpperCase():(console.warn("AG Grid - Quick filtering only works with the Client-Side Row Model"),null):null}setQuickFilter(e){if(null!=e&&"string"!=typeof e)return void console.warn("AG Grid - setQuickFilter() only supports string inputs, received: "+typeof e);const t=this.parseQuickFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setQuickFilterParts(),this.onFilterChanged())}resetQuickFilterCache(){this.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}onIncludeHiddenColumnsInQuickFilterChanged(){this.columnModel.refreshQuickFilterColumns(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.onFilterChanged()}refreshFiltersForAggregations(){this.gridOptionsService.getGroupAggFiltering()&&this.onFilterChanged()}callOnFilterChangedOutsideRenderCycle(e={}){const t=()=>this.onFilterChanged(e);this.rowRenderer.isRefreshInProgress()?setTimeout(t,0):t()}onFilterChanged(e={}){const{filterInstance:t,additionalEventAttributes:i,columns:n}=e;this.updateDependantFilters(),this.updateActiveFilters(),this.updateFilterFlagInColumns("filterChanged",i),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.allColumnFilters.forEach(e=>{e.filterPromise&&e.filterPromise.then(e=>{e&&e!==t&&e.onAnyFilterChanged&&e.onAnyFilterChanged()})});const r={type:y.EVENT_FILTER_CHANGED,columns:n||[]};i&&be(r,i),this.processingFilterChange=!0,this.eventService.dispatchEvent(r),this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!this.allowShowChangeAfterFilter&&this.processingFilterChange}isQuickFilterPresent(){return null!==this.quickFilter}updateAggFiltering(){this.aggFiltering=!!this.gridOptionsService.getGroupAggFiltering()}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&(this.aggFiltering||this.columnModel.isPivotMode())}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!(this.aggFiltering||this.columnModel.isPivotMode())}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,filterInstanceToSkip:e})}doesRowPassQuickFilterNoCache(i,n){return this.columnModel.getAllColumnsForQuickFilter().some(e=>{const t=this.getQuickFilterTextForColumn(e,i);return _(t)&&t.indexOf(n)>=0})}doesRowPassQuickFilterCache(e,t){return e.quickFilterAggregateText||this.aggregateRowForQuickFilter(e),e.quickFilterAggregateText.indexOf(t)>=0}doesRowPassQuickFilter(t){const i=this.gridOptionsService.is("cacheQuickFilter");return this.quickFilterParts.every(e=>i?this.doesRowPassQuickFilterCache(t,e):this.doesRowPassQuickFilterNoCache(t,e))}doesRowPassAggregateFilters(e){return!(this.isAggregateQuickFilterPresent()&&!this.doesRowPassQuickFilter(e.rowNode))&&!(this.isAggregateFilterPresent()&&!this.doAggregateFiltersPass(e.rowNode,e.filterInstanceToSkip))}doesRowPassFilter(e){return!(this.isNonAggregateQuickFilterPresent()&&!this.doesRowPassQuickFilter(e.rowNode))&&(!(this.isExternalFilterPresent()&&!this.doesExternalFilterPass(e.rowNode))&&!(this.isColumnFilterPresent()&&!this.doColumnFiltersPass(e.rowNode,e.filterInstanceToSkip)))}getQuickFilterTextForColumn(t,i){let n=this.valueService.getValue(t,i,!0);const r=t.getColDef();if(r.getQuickFilterText){const e={value:n,node:i,data:i.data,column:t,colDef:r,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};n=r.getQuickFilterText(e)}return _(n)?n.toString().toUpperCase():null}aggregateRowForQuickFilter(i){const n=[];this.columnModel.getAllColumnsForQuickFilter().forEach(e=>{const t=this.getQuickFilterTextForColumn(e,i);_(t)&&n.push(t)}),i.quickFilterAggregateText=n.join(na.QUICK_FILTER_SEPARATOR)}onNewRowsLoaded(e){this.allColumnFilters.forEach(e=>{e.filterPromise.then(e=>{e.onNewRowsLoaded&&e.onNewRowsLoaded()})}),this.updateFilterFlagInColumns(e,{afterDataChange:!0}),this.updateActiveFilters()}createValueGetter(t){return({node:e})=>this.valueService.getValue(t,e,!0)}getFilterComponent(e,t,i=!0){var n;if(i)return(null===(n=this.getOrCreateFilterWrapper(e,t))||void 0===n?void 0:n.filterPromise)||null;const r=this.cachedFilter(e);return r?r.filterPromise:null}isFilterActive(e){const t=this.cachedFilter(e);return!!t&&t.filterPromise.resolveNow(!1,e=>e.isFilterActive())}getOrCreateFilterWrapper(t,i){if(!t.isFilterAllowed())return null;let n=this.cachedFilter(t);if(n)"NO_UI"!==i&&this.putIntoGui(n,i);else{n=this.createFilterWrapper(t,i);const e=t.getColId();this.allColumnFilters.set(e,n),this.allColumnListeners.set(e,this.addManagedListener(t,d.EVENT_COL_DEF_CHANGED,()=>this.checkDestroyFilter(e)))}return n}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(t){let i;if(v.__isRegistered(m.SetFilterModule,this.context.getGridId()))i="agSetColumnFilter";else{const e=t.getColDef().cellDataType;i="number"===e?"agNumberColumnFilter":"date"===e||"dateString"===e?"agDateColumnFilter":"agTextColumnFilter"}return i}getDefaultFloatingFilter(t){let i;if(v.__isRegistered(m.SetFilterModule,this.context.getGridId()))i="agSetColumnFloatingFilter";else{const e=t.getColDef().cellDataType;i="number"===e?"agNumberColumnFloatingFilter":"date"===e||"dateString"===e?"agDateColumnFloatingFilter":"agTextColumnFloatingFilter"}return i}createFilterInstance(i){const e=this.getDefaultFilter(i),t=i.getColDef();let n;const r=Object.assign(Object.assign({},this.createFilterParams(i,t)),{filterModifiedCallback:()=>{const e={type:y.EVENT_FILTER_MODIFIED,column:i,filterInstance:n};this.eventService.dispatchEvent(e)},filterChangedCallback:e=>{const t={filterInstance:n,additionalEventAttributes:e,columns:[i]};this.callOnFilterChangedOutsideRenderCycle(t)},doesRowPassOtherFilter:e=>this.doesRowPassOtherFilters(n,e)}),s=this.userComponentFactory.getFilterDetails(t,r,e);return s?{filterPromise:()=>{const e=s.newAgStackInstance();return e&&e.then(e=>n=e),e},compDetails:s}:{filterPromise:null,compDetails:null}}createFilterParams(e,t){return{column:e,colDef:ue(t),rowModel:this.rowModel,filterChangedCallback:()=>{},filterModifiedCallback:()=>{},valueGetter:this.createValueGetter(e),doesRowPassOtherFilter:()=>!0,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}}createFilterWrapper(e,t){var i;const n={column:e,filterPromise:null,compiledElement:null,guiPromise:Rr.resolve(null),compDetails:null},{filterPromise:r,compDetails:s}=this.createFilterInstance(e);return n.filterPromise=null!==(i=null==r?void 0:r())&&void 0!==i?i:null,n.compDetails=s,r&&this.putIntoGui(n,t),n}putIntoGui(r,s){const o=document.createElement("div");o.className="ag-filter",r.guiPromise=new Rr(n=>{r.filterPromise.then(e=>{let t=e.getGui();_(t)||console.warn(`AG Grid: getGui method from filter returned ${t}, it should be a DOM element or an HTML template string.`),"string"==typeof t&&(t=Un(t)),o.appendChild(t),n(o);const i={type:y.EVENT_FILTER_OPENED,column:r.column,source:s,eGui:o};this.eventService.dispatchEvent(i)})})}onColumnsChanged(){const n=[];this.allColumnFilters.forEach((e,t)=>{let i;i=e.column.isPrimary()?this.columnModel.getPrimaryColumn(t):this.columnModel.getGridColumn(t),i||(n.push(e.column),this.disposeFilterWrapper(e,"columnChanged"),this.disposeColumnListener(t))}),n.length>0?this.onFilterChanged({columns:n}):this.updateDependantFilters()}updateDependantFilters(){const e=this.columnModel.getGroupAutoColumns();null==e||e.forEach(e=>{"agGroupColumnFilter"===e.getColDef().filter&&this.getOrCreateFilterWrapper(e,"NO_UI")})}isFilterAllowed(e){var t,i;if(!e.isFilterAllowed())return!1;const n=this.allColumnFilters.get(e.getColId());return null===(i=null===(t=null==n?void 0:n.filterPromise)||void 0===t?void 0:t.resolveNow(!0,e=>{var t,i;return"function"!=typeof(null===(t=e)||void 0===t?void 0:t.isFilterAllowed)||(null===(i=e)||void 0===i?void 0:i.isFilterAllowed())}))||void 0===i||i}getFloatingFilterCompDetails(i,e){const t=i.getColDef(),n=this.createFilterParams(i,t),r=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(t,Ho,n);let s=this.userComponentFactory.getDefaultFloatingFilterType(t,()=>this.getDefaultFloatingFilter(i));null==s&&(s="agReadOnlyFloatingFilter");const o={column:i,filterParams:r,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(i),parentFilterInstance:t=>{const e=this.getFilterComponent(i,"NO_UI");null!=e&&e.then(e=>{t(ia(e))})},showParentFilter:e,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(t,o,s)}getCurrentFloatingFilterParentModel(e){const t=this.getFilterComponent(e,"NO_UI",!1);return t?t.resolveNow(null,e=>e&&e.getModel()):null}destroyFilter(e,t="api"){const i=e.getColId(),n=this.allColumnFilters.get(i);this.disposeColumnListener(i),n&&(this.disposeFilterWrapper(n,t),this.onFilterChanged({columns:[e]}))}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(i,n){i.filterPromise.then(t=>{(t.setModel(null)||Rr.resolve()).then(()=>{this.getContext().destroyBean(t),i.column.setFilterActive(!1,"filterDestroyed"),this.allColumnFilters.delete(i.column.getColId());const e={type:y.EVENT_FILTER_DESTROYED,source:n,column:i.column};this.eventService.dispatchEvent(e)})})}checkDestroyFilter(e){const t=this.allColumnFilters.get(e);if(!t)return;const i=t.column,{compDetails:n}=i.isFilterAllowed()?this.createFilterInstance(i):{compDetails:null};((e,t)=>{if(!t||!e)return!0;const{componentClass:i}=e,{componentClass:n}=t;return!(i===n||(null==i?void 0:i.render)&&(null==n?void 0:n.render)&&i.render===n.render)})(t.compDetails,n)&&this.destroyFilter(i,"columnChanged")}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear()}};sa.QUICK_FILTER_SEPARATOR="\n",ra([o("valueService")],sa.prototype,"valueService",void 0),ra([o("columnModel")],sa.prototype,"columnModel",void 0),ra([o("rowModel")],sa.prototype,"rowModel",void 0),ra([o("userComponentFactory")],sa.prototype,"userComponentFactory",void 0),ra([o("rowRenderer")],sa.prototype,"rowRenderer",void 0),ra([r],sa.prototype,"init",null),sa=na=ra([s("filterManager")],sa);class oa extends E{constructor(e,t){super(e),this.ctrl=t}getCtrl(){return this.ctrl}}var aa=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class la extends oa{constructor(e){super(la.TEMPLATE,e)}postConstruct(){const t=this.getGui(),e={addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),addOrRemoveBodyCssClass:(e,t)=>this.eFloatingFilterBody.classList.toggle(e,t),setButtonWrapperDisplayed:e=>w(this.eButtonWrapper,e),setCompDetails:e=>this.setCompDetails(e),getFloatingFilterComp:()=>this.compPromise,setWidth:e=>t.style.width=e,setMenuIcon:e=>this.eButtonShowMainFilter.appendChild(e)};this.ctrl.setComp(e,t,this.eButtonShowMainFilter,this.eFloatingFilterBody)}setCompDetails(e){if(!e)return this.destroyFloatingFilterComp(),void(this.compPromise=null);this.compPromise=e.newAgStackInstance(),this.compPromise.then(e=>this.afterCompCreated(e))}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui()),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(e){e&&(this.isAlive()?(this.destroyFloatingFilterComp(),this.floatingFilterComp=e,this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached()):this.destroyBean(e))}}la.TEMPLATE='<div class="ag-header-cell ag-floating-filter" role="gridcell" tabindex="-1">\n            <div ref="eFloatingFilterBody" role="presentation"></div>\n            <div class="ag-floating-filter-button ag-hidden" ref="eButtonWrapper" role="presentation">\n                <button type="button" class="ag-button ag-floating-filter-button-button" ref="eButtonShowMainFilter" tabindex="-1"></button>\n            </div>\n        </div>',aa([S("eFloatingFilterBody")],la.prototype,"eFloatingFilterBody",void 0),aa([S("eButtonWrapper")],la.prototype,"eButtonWrapper",void 0),aa([S("eButtonShowMainFilter")],la.prototype,"eButtonShowMainFilter",void 0),aa([r],la.prototype,"postConstruct",null),aa([Ve],la.prototype,"destroyFloatingFilterComp",null);var ca,ua=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};!function(e){e.AUTO_HEIGHT="ag-layout-auto-height",e.NORMAL="ag-layout-normal",e.PRINT="ag-layout-print"}(ca||(ca={}));class da extends f{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.getDomLayout(),t={autoHeight:"autoHeight"===e,normal:"normal"===e,print:"print"===e},i=t.autoHeight?ca.AUTO_HEIGHT:t.print?ca.PRINT:ca.NORMAL;this.view.updateLayoutClasses(i,t)}getDomLayout(){var e;const t=null!==(e=this.gridOptionsService.get("domLayout"))&&void 0!==e?e:"normal";return-1===["normal","print","autoHeight"].indexOf(t)?(l(()=>console.warn(`AG Grid: ${t} is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.`),"warn about dom layout values"),"normal"):t}}ua([r],da.prototype,"postConstruct",null);var ha,pa,fa=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};!function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal"}(ha||(ha={})),function(e){e[e.Container=0]="Container",e[e.FakeContainer=1]="FakeContainer"}(pa||(pa={}));class ga extends f{constructor(e){super(),this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.eBodyViewport=e,this.resetLastHScrollDebounced=Pe(()=>this.lastScrollSource[ha.Horizontal]=null,500),this.resetLastVScrollDebounced=Pe(()=>this.lastScrollSource[ha.Vertical]=null,500)}postConstruct(){this.enableRtl=this.gridOptionsService.is("enableRtl"),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this)),this.ctrlsService.whenReady(e=>{this.centerRowContainerCtrl=e.centerRowContainerCtrl,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}addScrollListener(){const e=this.ctrlsService.getFakeHScrollComp(),t=this.ctrlsService.getFakeVScrollComp();this.addManagedListener(this.centerRowContainerCtrl.getViewportElement(),"scroll",this.onHScroll.bind(this)),e.onScrollCallback(this.onFakeHScroll.bind(this));const i=this.gridOptionsService.is("debounceVerticalScrollbar"),n=i?Pe(this.onVScroll.bind(this),100):this.onVScroll.bind(this),r=i?Pe(this.onFakeVScroll.bind(this),100):this.onFakeVScroll.bind(this);this.addManagedListener(this.eBodyViewport,"scroll",n),t.onScrollCallback(r)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){if(null==this.centerRowContainerCtrl)return;void 0===e&&(e=this.centerRowContainerCtrl.getCenterViewportScrollLeft());const t=this.enableRtl?e:-e,i=this.ctrlsService.getTopCenterRowContainerCtrl(),n=this.ctrlsService.getStickyTopCenterRowContainerCtrl(),r=this.ctrlsService.getBottomCenterRowContainerCtrl(),s=this.ctrlsService.getFakeHScrollComp();this.ctrlsService.getHeaderRowContainerCtrl().setHorizontalScroll(-t),r.setContainerTranslateX(t),i.setContainerTranslateX(t),n.setContainerTranslateX(t);const o=this.centerRowContainerCtrl.getViewportElement(),a=this.lastScrollSource[ha.Horizontal]===pa.Container;e=Math.abs(e),a?s.setScrollPosition(e):Bn(o,e,this.enableRtl)}isControllingScroll(e,t){return null==this.lastScrollSource[t]?(this.lastScrollSource[t]=e,!0):this.lastScrollSource[t]===e}onFakeHScroll(){this.isControllingScroll(pa.FakeContainer,ha.Horizontal)&&this.onHScrollCommon(pa.FakeContainer)}onHScroll(){this.isControllingScroll(pa.Container,ha.Horizontal)&&this.onHScrollCommon(pa.Container)}onHScrollCommon(e){const t=this.centerRowContainerCtrl.getViewportElement(),{scrollLeft:i}=t;if(this.shouldBlockScrollUpdate(ha.Horizontal,i,!0))return;let n;n=e===pa.Container?Hn(t,this.enableRtl):this.ctrlsService.getFakeHScrollComp().getScrollPosition(),this.doHorizontalScroll(Math.round(n)),this.resetLastHScrollDebounced()}onFakeVScroll(){this.isControllingScroll(pa.FakeContainer,ha.Vertical)&&this.onVScrollCommon(pa.FakeContainer)}onVScroll(){this.isControllingScroll(pa.Container,ha.Vertical)&&this.onVScrollCommon(pa.Container)}onVScrollCommon(e){let t;t=e===pa.Container?this.eBodyViewport.scrollTop:this.ctrlsService.getFakeVScrollComp().getScrollPosition(),this.shouldBlockScrollUpdate(ha.Vertical,t,!0)||(this.animationFrameService.setScrollTop(t),this.nextScrollTop=t,e===pa.Container?this.ctrlsService.getFakeVScrollComp().setScrollPosition(t):this.eBodyViewport.scrollTop=t,this.gridOptionsService.is("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced())}doHorizontalScroll(e){const t=this.ctrlsService.getFakeHScrollComp().getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(ha.Horizontal),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.onHorizontalViewportChanged())}fireScrollEvent(e){const t={type:y.EVENT_BODY_SCROLL,direction:e===ha.Horizontal?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout(()=>{const e=Object.assign(Object.assign({},t),{type:y.EVENT_BODY_SCROLL_END});this.eventService.dispatchEvent(e)},100)}shouldBlockScrollUpdate(e,t,i=!1){return!(i&&!nn())&&(e===ha.Vertical?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t))}shouldBlockVerticalScroll(e){const t=Pn(this.eBodyViewport),{scrollHeight:i}=this.eBodyViewport;return e<0||e+t>i}shouldBlockHorizontalScroll(e){const t=this.centerRowContainerCtrl.getCenterWidth(),{scrollWidth:i}=this.centerRowContainerCtrl.getViewportElement();if(this.enableRtl&&$n()){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>i}redrawRowsAfterScroll(){this.fireScrollEvent(ha.Vertical)}onHorizontalViewportChanged(){this.centerRowContainerCtrl.onHorizontalViewportChanged()}checkScrollLeft(){this.scrollLeft!==this.centerRowContainerCtrl.getCenterViewportScrollLeft()&&this.onHScrollCommon(pa.Container)}scrollGridIfNeeded(){const e=this.scrollTop!=this.nextScrollTop;return e&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),e}setHorizontalScrollPosition(e,t=!1){const i=this.centerRowContainerCtrl.getViewportElement().scrollWidth-this.centerRowContainerCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(ha.Horizontal,e)&&(e=this.enableRtl&&$n()?e>0?0:i:Math.min(Math.max(e,0),i)),Bn(this.centerRowContainerCtrl.getViewportElement(),Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.eBodyViewport.scrollTop=e}getVScrollPosition(){return{top:this.eBodyViewport.scrollTop,bottom:this.eBodyViewport.scrollTop+this.eBodyViewport.offsetHeight}}getHScrollPosition(){return this.centerRowContainerCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.centerRowContainerCtrl.isHorizontalScrollShowing()}scrollHorizontally(e){const t=this.centerRowContainerCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowContainerCtrl.getViewportElement().scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(i,e=null){const n=this.rowModel.getRowCount();let r=-1;for(let t=0;t<n;t++){const n=this.rowModel.getRow(t);if("function"==typeof i){const e=i;if(n&&e(n)){r=t;break}}else if(i===n||i===n.data){r=t;break}}r>=0&&this.ensureIndexVisible(r,e)}ensureIndexVisible(f,g){if(this.gridOptionsService.isDomLayout("print"))return;const m=this.paginationProxy.getRowCount();if("number"!=typeof f||f<0||f>=m)return void console.warn("AG Grid: Invalid row index for ensureIndexVisible: "+f);this.gridOptionsService.is("pagination")&&!this.gridOptionsService.is("suppressPaginationPanel")||this.paginationProxy.goToPageWithIndex(f);const v=this.ctrlsService.getGridBodyCtrl().getStickyTopHeight(),y=this.paginationProxy.getRow(f);let b;do{const f=y.rowTop,m=y.rowHeight,e=this.paginationProxy.getPixelOffset(),t=y.rowTop-e,i=t+y.rowHeight,n=this.getVScrollPosition(),r=this.heightScaler.getDivStretchOffset(),s=n.top+r,o=n.bottom+r,a=o-s,l=this.heightScaler.getScrollPositionForPixel(t),c=this.heightScaler.getScrollPositionForPixel(i-a),u=Math.min((l+c)/2,t),d=s+v>t,h=o<i;let p=null;"top"===g?p=l:"bottom"===g?p=c:"middle"===g?p=u:d?p=l-v:h&&(p=c),null!==p&&(this.setVerticalScrollPosition(p),this.rowRenderer.redraw()),b=f!==y.rowTop||m!==y.rowHeight}while(b);this.animationFrameService.flushAllFrames()}ensureColumnVisible(e,t="auto"){const i=this.columnModel.getGridColumn(e);if(!i)return;if(i.isPinned())return;if(!this.columnModel.isColumnDisplayed(i))return;const n=this.getPositionedHorizontalScroll(i,t);null!==n&&this.centerRowContainerCtrl.setCenterViewportScrollLeft(n),this.centerRowContainerCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:i,columnAfterEnd:n}=this.isColumnOutsideViewport(e),r=this.centerRowContainerCtrl.getCenterWidth()<e.getActualWidth(),s=this.centerRowContainerCtrl.getCenterWidth(),o=this.enableRtl;let a=(o?i:n)||r,l=o?n:i;"auto"!==t&&(a="start"===t,l="end"===t);const c="middle"===t;if(a||l||c){const{colLeft:t,colMiddle:i,colRight:n}=this.getColumnBounds(e);return c?i-s/2:a?o?n:t:o?t-s:n-s}return null}isColumnOutsideViewport(e){const{start:t,end:i}=this.getViewportBounds(),{colLeft:n,colRight:r}=this.getColumnBounds(e),s=this.enableRtl;return{columnBeforeStart:s?t>r:i<r,columnAfterEnd:s?i<n:t>n}}getColumnBounds(e){const t=this.enableRtl,i=this.columnModel.getBodyContainerWidth(),n=e.getActualWidth(),r=e.getLeft(),s=t?-1:1,o=t?i-r:r;return{colLeft:o,colMiddle:o+n/2*s,colRight:o+n*s}}getViewportBounds(){const e=this.centerRowContainerCtrl.getCenterWidth(),t=this.centerRowContainerCtrl.getCenterViewportScrollLeft();return{start:t,end:e+t,width:e}}}fa([o("ctrlsService")],ga.prototype,"ctrlsService",void 0),fa([o("animationFrameService")],ga.prototype,"animationFrameService",void 0),fa([o("paginationProxy")],ga.prototype,"paginationProxy",void 0),fa([o("rowModel")],ga.prototype,"rowModel",void 0),fa([o("rowContainerHeightService")],ga.prototype,"heightScaler",void 0),fa([o("rowRenderer")],ga.prototype,"rowRenderer",void 0),fa([o("columnModel")],ga.prototype,"columnModel",void 0),fa([r],ga.prototype,"postConstruct",null);class ma{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=-1!==e.scrollAxis.indexOf("x"),this.scrollVertically=-1!==e.scrollAxis.indexOf("y"),this.scrollByTick=null!=e.scrollByTick?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}check(e,t=!1){const i=t||this.shouldSkipVerticalScroll();if(i&&this.shouldSkipHorizontalScroll())return;const n=this.scrollContainer.getBoundingClientRect(),r=this.scrollByTick;this.tickLeft=e.clientX<n.left+r,this.tickRight=e.clientX>n.right-r,this.tickUp=e.clientY<n.top+r&&!i,this.tickDown=e.clientY>n.bottom-r&&!i,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){null===this.tickingInterval&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){let t;if(this.tickCount++,t=this.tickCount>20?200:this.tickCount>10?80:40,this.scrollVertically){const e=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(e-t),this.tickDown&&this.setVerticalPosition(e+t)}if(this.scrollHorizontally){const e=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(e-t),this.tickRight&&this.setHorizontalPosition(e+t)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}}var va=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class ya extends f{constructor(e){super(),this.isMultiRowDrag=!1,this.isGridSorted=!1,this.isGridFiltered=!1,this.isRowGroupActive=!1,this.eContainer=e}postConstruct(){this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel);const e=()=>{this.onSortChanged(),this.onFilterChanged(),this.onRowGroupChanged()};this.addManagedListener(this.eventService,y.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_MODEL_UPDATED,()=>{e()}),e(),this.ctrlsService.whenReady(()=>{const t=this.ctrlsService.getGridBodyCtrl();this.autoScrollService=new ma({scrollContainer:t.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:()=>t.getScrollFeature().getVScrollPosition().top,setVerticalPosition:e=>t.getScrollFeature().setVerticalScrollPosition(e),onScrollCallback:()=>{this.onDragging(this.lastDraggingEvent)}})})}onSortChanged(){this.isGridSorted=this.sortController.isSortActive()}onFilterChanged(){this.isGridFiltered=this.filterManager.isAnyFilterPresent()}onRowGroupChanged(){const e=this.columnModel.getRowGroupColumns();this.isRowGroupActive=!ee(e)}getContainer(){return this.eContainer}isInterestedIn(e){return e===Js.RowDrag}getIconName(){return this.gridOptionsService.is("rowDragManaged")&&this.shouldPreventRowMove()?M.ICON_NOT_ALLOWED:M.ICON_MOVE}shouldPreventRowMove(){return this.isGridSorted||this.isGridFiltered||this.isRowGroupActive}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];const t=this.gridOptionsService.is("rowDragMultiRow"),i=[...this.selectionService.getSelectedNodes()].sort((e,t)=>null==e.rowIndex||null==t.rowIndex?0:this.getRowIndexNumber(e)-this.getRowIndexNumber(t)),n=e.dragItem.rowNode;return t&&-1!==i.indexOf(n)?(this.isMultiRowDrag=!0,i):(this.isMultiRowDrag=!1,[n])}onDragEnter(e){e.dragItem.rowNodes=this.getRowNodes(e),this.dispatchGridEvent(y.EVENT_ROW_DRAG_ENTER,e),this.getRowNodes(e).forEach(e=>{e.setDragging(!0)}),this.onEnterOrDragging(e)}onDragging(e){this.onEnterOrDragging(e)}isFromThisGrid(e){const{dragSourceDomDataKey:t}=e.dragSource;return t===this.gridOptionsService.getDomDataKey()}isDropZoneWithinThisGrid(e){const t=this.ctrlsService.getGridBodyCtrl().getGui(),{dropZoneTarget:i}=e;return!t.contains(i)}onEnterOrDragging(e){this.dispatchGridEvent(y.EVENT_ROW_DRAG_MOVE,e),this.lastDraggingEvent=e;const t=this.mouseEventService.getNormalisedPosition(e).y;this.gridOptionsService.is("rowDragManaged")&&this.doManagedDrag(e,t),this.autoScrollService.check(e.event)}doManagedDrag(e,t){const i=this.isFromThisGrid(e),n=this.gridOptionsService.is("rowDragManaged"),r=e.dragItem.rowNodes;n&&this.shouldPreventRowMove()||(this.gridOptionsService.is("suppressMoveWhenRowDragging")||!i?this.isDropZoneWithinThisGrid(e)||this.clientSideRowModel.highlightRowAtPixel(r[0],t):this.moveRows(r,t))}getRowIndexNumber(e){return parseInt(p(e.getRowIndexString().split("-")),10)}moveRowAndClearHighlight(t){const e=this.clientSideRowModel.getLastHighlightedRowNode(),i=e&&e.highlighted===ea.Below,n=this.mouseEventService.getNormalisedPosition(t).y,r=t.dragItem.rowNodes;let s=i?1:0;if(this.isFromThisGrid(t))r.forEach(e=>{e.rowTop<n&&(s-=1)}),this.moveRows(r,n,s);else{const t=this.gridOptionsService.getCallback("getRowId");let e=this.clientSideRowModel.getRowIndexAtPixel(n)+1;this.clientSideRowModel.getHighlightPosition(n)===ea.Above&&e--,this.clientSideRowModel.updateRowData({add:r.map(e=>e.data).filter(e=>!this.clientSideRowModel.getRowNode(t?t({data:e,level:0}):e.id)),addIndex:e})}this.clearRowHighlight()}clearRowHighlight(){this.clientSideRowModel.highlightRowAtPixel(null)}moveRows(e,t,i=0){this.clientSideRowModel.ensureRowsAtPixel(e,t,i)&&(this.focusService.clearFocusedCell(),this.rangeService&&this.rangeService.removeAllCellRanges())}addRowDropZone(t){if(!t.getContainer())return void l(()=>console.warn("AG Grid: addRowDropZone - A container target needs to be provided"),"add-drop-zone-empty-target");if(this.dragAndDropService.findExternalZone(t))return void console.warn("AG Grid: addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");let e={getContainer:t.getContainer};t.fromGrid?(t.fromGrid=void 0,e=t):(t.onDragEnter&&(e.onDragEnter=e=>{t.onDragEnter(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_ENTER,e))}),t.onDragLeave&&(e.onDragLeave=e=>{t.onDragLeave(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_LEAVE,e))}),t.onDragging&&(e.onDragging=e=>{t.onDragging(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_MOVE,e))}),t.onDragStop&&(e.onDragStop=e=>{t.onDragStop(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_END,e))})),this.dragAndDropService.addDropTarget(Object.assign({isInterestedIn:e=>e===Js.RowDrag,getIconName:()=>M.ICON_MOVE,external:!0},e))}getRowDropZone(t){const e=this.getContainer.bind(this),i=this.onDragEnter.bind(this),n=this.onDragLeave.bind(this),r=this.onDragging.bind(this),s=this.onDragStop.bind(this);return t?{getContainer:e,onDragEnter:t.onDragEnter?e=>{i(e),t.onDragEnter(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_ENTER,e))}:i,onDragLeave:t.onDragLeave?e=>{n(e),t.onDragLeave(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_LEAVE,e))}:n,onDragging:t.onDragging?e=>{r(e),t.onDragging(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_MOVE,e))}:r,onDragStop:t.onDragStop?e=>{s(e),t.onDragStop(this.draggingToRowDragEvent(y.EVENT_ROW_DRAG_END,e))}:s,fromGrid:!0}:{getContainer:e,onDragEnter:i,onDragLeave:n,onDragging:r,onDragStop:s,fromGrid:!0}}draggingToRowDragEvent(e,t){const i=this.mouseEventService.getNormalisedPosition(t).y;let n,r,s=-1;switch(i>this.paginationProxy.getCurrentPageHeight()||(s=this.rowModel.getRowIndexAtPixel(i),n=this.rowModel.getRow(s)),t.vDirection){case eo.Down:r="down";break;case eo.Up:r="up";break;default:r=null}return{type:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,event:t.event,node:t.dragItem.rowNode,nodes:t.dragItem.rowNodes,overIndex:s,overNode:n,y:i,vDirection:r}}dispatchGridEvent(e,t){const i=this.draggingToRowDragEvent(e,t);this.eventService.dispatchEvent(i)}onDragLeave(e){this.dispatchGridEvent(y.EVENT_ROW_DRAG_LEAVE,e),this.stopDragging(e),this.gridOptionsService.is("rowDragManaged")&&this.clearRowHighlight(),this.isFromThisGrid(e)&&(this.isMultiRowDrag=!1)}onDragStop(e){this.dispatchGridEvent(y.EVENT_ROW_DRAG_END,e),this.stopDragging(e),!this.gridOptionsService.is("rowDragManaged")||!this.gridOptionsService.is("suppressMoveWhenRowDragging")&&this.isFromThisGrid(e)||this.isDropZoneWithinThisGrid(e)||this.moveRowAndClearHighlight(e)}stopDragging(e){this.autoScrollService.ensureCleared(),this.getRowNodes(e).forEach(e=>{e.setDragging(!1)})}}va([o("dragAndDropService")],ya.prototype,"dragAndDropService",void 0),va([o("rowModel")],ya.prototype,"rowModel",void 0),va([o("paginationProxy")],ya.prototype,"paginationProxy",void 0),va([o("columnModel")],ya.prototype,"columnModel",void 0),va([o("focusService")],ya.prototype,"focusService",void 0),va([o("sortController")],ya.prototype,"sortController",void 0),va([o("filterManager")],ya.prototype,"filterManager",void 0),va([o("selectionService")],ya.prototype,"selectionService",void 0),va([o("mouseEventService")],ya.prototype,"mouseEventService",void 0),va([o("ctrlsService")],ya.prototype,"ctrlsService",void 0),va([c("rangeService")],ya.prototype,"rangeService",void 0),va([r],ya.prototype,"postConstruct",null);var ba,Ca=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};!function(e){e.ANIMATION_ON="ag-row-animation",e.ANIMATION_OFF="ag-row-no-animation"}(ba||(ba={}));class wa extends f{constructor(){super(...arguments),this.stickyTopHeight=0}getScrollFeature(){return this.bodyScrollFeature}getBodyViewportElement(){return this.eBodyViewport}setComp(e,t,i,n,r,s){this.comp=e,this.eGridBody=t,this.eBodyViewport=i,this.eTop=n,this.eBottom=r,this.eStickyTop=s,this.setCellTextSelection(this.gridOptionsService.is("enableCellTextSelection")),this.createManagedBean(new da(this.comp)),this.bodyScrollFeature=this.createManagedBean(new ga(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([n,i,r,s]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.ctrlsService.registerGridBodyCtrl(this)}getComp(){return this.comp}addEventListeners(){this.addManagedListener(this.eventService,y.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}addFocusListeners(e){e.forEach(s=>{this.addManagedListener(s,"focusin",e=>{const{target:t}=e,i=On(t,"ag-root",s);s.classList.toggle("ag-has-focus",!i)}),this.addManagedListener(s,"focusout",e=>{const{target:t,relatedTarget:i}=e,n=s.contains(i),r=On(i,"ag-root",s);On(t,"ag-root",s)||n&&!r||s.classList.remove("ag-has-focus")})})}setColumnMovingCss(e){this.comp.setColumnMovingCss("ag-column-moving",e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss("ag-selectable",e)}onScrollVisibilityChanged(){const e=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(e),this.setStickyTopWidth(e);const t=`calc(100% + ${(e&&this.gridOptionsService.getScrollbarWidth()||0)+(dn()?16:0)}px)`;this.animationFrameService.requestAnimationFrame(()=>this.comp.setBodyViewportWidth(t))}onGridColumnsChanged(){const e=this.columnModel.getAllGridColumns();this.comp.setColumnCount(e?e.length:0)}disableBrowserDragging(){this.addManagedListener(this.eGridBody,"dragstart",e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1})}addStopEditingWhenGridLosesFocus(){if(!this.gridOptionsService.is("stopEditingWhenCellsLoseFocus"))return;const t=e=>{const t=e.relatedTarget;if(null===sn(t))return void this.rowRenderer.stopEditing();let i=n.some(e=>e.contains(t))&&this.mouseEventService.isElementInThisGrid(t);if(!i){const e=this.popupService;i=e.getActivePopups().some(e=>e.contains(t))||e.isElementWithinCustomPopup(t)}i||this.rowRenderer.stopEditing()},n=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop];n.forEach(e=>this.addManagedListener(e,"focusout",t))}updateRowCount(){const e=this.headerNavigationService.getHeaderRowCount(),t=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,i=-1===t?-1:e+t;this.comp.setRowCount(i)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gridOptionsService.is("alwaysShowVerticalScroll"),t=e?"ag-force-vertical-scroll":null,i=this.gridOptionsService.isDomLayout("normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||i&&nr(this.eBodyViewport)}setupRowAnimationCssClass(){const e=()=>{const e=this.gridOptionsService.isAnimateRows()&&!this.rowContainerHeightService.isStretching(),t=e?ba.ANIMATION_ON:ba.ANIMATION_OFF;this.comp.setRowAnimationCssOnBodyViewport(t,e)};e(),this.addManagedListener(this.eventService,y.EVENT_HEIGHT_SCALE_CHANGED,e),this.addManagedPropertyListener("animateRows",e)}getGridBodyElement(){return this.eGridBody}addBodyViewportListener(){const e=this.onBodyViewportContextMenu.bind(this);this.addManagedListener(this.eBodyViewport,"contextmenu",e),this.mockContextMenuForIPad(e),this.addManagedListener(this.eBodyViewport,"wheel",this.onBodyViewportWheel.bind(this)),this.addManagedListener(this.eStickyTop,"wheel",this.onStickyTopWheel.bind(this)),this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){const e=this.eBodyViewport.querySelector(".ag-full-width-container"),t=this.eBodyViewport.querySelector(".ag-center-cols-viewport");e&&t&&this.addManagedListener(e,"wheel",e=>this.onFullWidthContainerWheel(e,t))}onFullWidthContainerWheel(e,t){!e.deltaX||Math.abs(e.deltaY)>Math.abs(e.deltaX)||!this.mouseEventService.isEventFromThisGrid(e)||(e.preventDefault(),t.scrollBy({left:e.deltaX}))}onBodyViewportContextMenu(e,t,i){if(!e&&!i)return;if(this.gridOptionsService.is("preventDefaultOnContextMenu")){(e||i).preventDefault()}const{target:n}=e||t;if(n===this.eBodyViewport||n===this.ctrlsService.getCenterRowContainerCtrl().getViewportElement()){if(!this.contextMenuFactory)return;e?this.contextMenuFactory.onContextMenu(e,null,null,null,null,this.eGridBody):i&&this.contextMenuFactory.onContextMenu(null,i,null,null,null,this.eGridBody)}}mockContextMenuForIPad(t){if(!nn())return;const e=new D(this.eBodyViewport);this.addManagedListener(e,D.EVENT_LONG_TAP,e=>{t(void 0,e.touchStart,e.touchEvent)}),this.addDestroyFunc(()=>e.destroy())}onBodyViewportWheel(e){this.gridOptionsService.is("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&e.preventDefault()}onStickyTopWheel(e){e.preventDefault(),e.offsetY&&this.scrollVertically(e.deltaY)}getGui(){return this.eGridBody}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}addRowDragListener(){this.rowDragFeature=this.createManagedBean(new ya(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature)}getRowDragFeature(){return this.rowDragFeature}onPinnedRowDataChanged(){this.setFloatingHeights()}setFloatingHeights(){const{pinnedRowModel:e}=this;let t=e.getPinnedTopTotalHeight();t&&(t+=1);let i=e.getPinnedBottomTotalHeight();i&&(i+=1),this.comp.setTopHeight(t),this.comp.setBottomHeight(i),this.comp.setTopDisplay(t?"inherit":"none"),this.comp.setBottomDisplay(i?"inherit":"none"),this.setStickyTopOffsetTop()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(e+"px"),this.stickyTopHeight=e}getStickyTopHeight(){return this.stickyTopHeight}setStickyTopWidth(e){if(e){const e=this.gridOptionsService.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${e}px)`)}else this.comp.setStickyTopWidth("100%")}onHeaderHeightChanged(){this.setStickyTopOffsetTop()}setStickyTopOffsetTop(){const e=this.ctrlsService.getGridHeaderCtrl().getHeaderHeight(),t=this.pinnedRowModel.getPinnedTopTotalHeight();let i=0;e>0&&(i+=e+1),t>0&&(i+=t+1),this.comp.setStickyTopTop(i+"px")}sizeColumnsToFit(e,t){const i=this.isVerticalScrollShowing()?this.gridOptionsService.getScrollbarWidth():0,n=kn(this.eGridBody)-i;n>0?this.columnModel.sizeColumnsToFit(n,"sizeColumnsToFit",!1,e):void 0===t?window.setTimeout(()=>{this.sizeColumnsToFit(e,100)},0):100===t?window.setTimeout(()=>{this.sizeColumnsToFit(e,500)},100):500===t?window.setTimeout(()=>{this.sizeColumnsToFit(e,-1)},500):console.warn("AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")}addScrollEventListener(e){this.eBodyViewport.addEventListener("scroll",e,{passive:!0})}removeScrollEventListener(e){this.eBodyViewport.removeEventListener("scroll",e)}}var _a,Aa;Ca([o("animationFrameService")],wa.prototype,"animationFrameService",void 0),Ca([o("rowContainerHeightService")],wa.prototype,"rowContainerHeightService",void 0),Ca([o("ctrlsService")],wa.prototype,"ctrlsService",void 0),Ca([o("columnModel")],wa.prototype,"columnModel",void 0),Ca([o("scrollVisibleService")],wa.prototype,"scrollVisibleService",void 0),Ca([c("contextMenuFactory")],wa.prototype,"contextMenuFactory",void 0),Ca([o("headerNavigationService")],wa.prototype,"headerNavigationService",void 0),Ca([o("dragAndDropService")],wa.prototype,"dragAndDropService",void 0),Ca([o("pinnedRowModel")],wa.prototype,"pinnedRowModel",void 0),Ca([o("rowRenderer")],wa.prototype,"rowRenderer",void 0),Ca([o("popupService")],wa.prototype,"popupService",void 0),Ca([o("mouseEventService")],wa.prototype,"mouseEventService",void 0),Ca([o("rowModel")],wa.prototype,"rowModel",void 0),function(e){e[e.FILL=0]="FILL",e[e.RANGE=1]="RANGE"}(_a||(_a={})),function(e){e[e.VALUE=0]="VALUE",e[e.DIMENSION=1]="DIMENSION"}(Aa||(Aa={}));class Ea{constructor(e,t){this.beans=e,this.cellCtrl=t}setComp(e,t){this.cellComp=e,this.eGui=t,this.onRangeSelectionChanged()}onRangeSelectionChanged(){this.cellComp&&(this.rangeCount=this.beans.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected",0!==this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-1",1===this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-2",2===this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-3",3===this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-4",this.rangeCount>=4),this.cellComp.addOrRemoveCssClass("ag-cell-range-chart",this.hasChartRange),Yi(this.eGui,this.rangeCount>0||void 0),this.cellComp.addOrRemoveCssClass("ag-cell-range-single-cell",this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())}updateRangeBorders(){const e=this.getRangeBorders(),t=this.isSingleCell(),i=!t&&e.top,n=!t&&e.right,r=!t&&e.bottom,s=!t&&e.left;this.cellComp.addOrRemoveCssClass("ag-cell-range-top",i),this.cellComp.addOrRemoveCssClass("ag-cell-range-right",n),this.cellComp.addOrRemoveCssClass("ag-cell-range-bottom",r),this.cellComp.addOrRemoveCssClass("ag-cell-range-left",s)}isSingleCell(){const{rangeService:e}=this.beans;return 1===this.rangeCount&&e&&!e.isMoreThanOneCell()}getHasChartRange(){const{rangeService:e}=this.beans;if(!this.rangeCount||!e)return!1;const t=e.getCellRanges();return t.length>0&&t.every(e=>dt([Aa.DIMENSION,Aa.VALUE],e.type))}updateRangeBordersIfRangeCount(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())}getRangeBorders(){const e=this.beans.gridOptionsService.is("enableRtl");let i=!1,n=!1,r=!1,s=!1;const o=this.cellCtrl.getCellPosition().column,{rangeService:a,columnModel:l}=this.beans;let c,u;e?(c=l.getDisplayedColAfter(o),u=l.getDisplayedColBefore(o)):(c=l.getDisplayedColBefore(o),u=l.getDisplayedColAfter(o));const d=a.getCellRanges().filter(e=>a.isCellInSpecificRange(this.cellCtrl.getCellPosition(),e));c||(s=!0),u||(n=!0);for(let t=0;t<d.length&&!(i&&n&&r&&s);t++){const o=d[t],l=a.getRangeStartRow(o),e=a.getRangeEndRow(o);!i&&this.beans.rowPositionUtils.sameRow(l,this.cellCtrl.getCellPosition())&&(i=!0),!r&&this.beans.rowPositionUtils.sameRow(e,this.cellCtrl.getCellPosition())&&(r=!0),!s&&c&&o.columns.indexOf(c)<0&&(s=!0),!n&&u&&o.columns.indexOf(u)<0&&(n=!0)}return{top:i,right:n,bottom:r,left:s}}refreshHandle(){if(!this.beans.rangeService)return;const e=this.shouldHaveSelectionHandle();this.selectionHandle&&!e&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),e&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass("ag-cell-range-handle",!!this.selectionHandle)}shouldHaveSelectionHandle(){const{gridOptionsService:e,rangeService:t}=this.beans,i=t.getCellRanges(),n=i.length;if(this.rangeCount<1||n<1)return!1;const r=p(i),s=this.cellCtrl.getCellPosition(),o=e.is("enableFillHandle")&&!this.cellCtrl.isSuppressFillHandle(),a=e.is("enableRangeHandle");let l=1===n&&!this.cellCtrl.isEditing()&&(o||a);if(this.hasChartRange){const e=i[0].type===Aa.DIMENSION&&t.isCellInSpecificRange(s,i[0]);this.cellComp.addOrRemoveCssClass("ag-cell-range-chart-category",e),l=r.type===Aa.VALUE}return l&&null!=r.endRow&&t.isContiguousRange(r)&&t.isBottomRightCell(r,s)}addSelectionHandle(){const{gridOptionsService:e,rangeService:t}=this.beans,i=p(t.getCellRanges()).type,n=e.is("enableFillHandle")&&u(i)?_a.FILL:_a.RANGE;this.selectionHandle&&this.selectionHandle.getType()!==n&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.beans.selectionHandleFactory.createSelectionHandle(n)),this.selectionHandle.refresh(this.cellCtrl)}destroy(){this.beans.context.destroyBean(this.selectionHandle)}}class Sa extends f{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode(),this.setupColSpan(),this.setupRowSpan()}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode)}setComp(e){this.eGui=e,this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()}onDisplayColumnsChanged(){const e=this.getColSpanningList();it(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){null!=this.column.getColDef().colSpan&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListener(this.beans.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayColumnsChanged.bind(this)),this.addManagedListener(this.beans.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onWidthChanged.bind(this)))}onWidthChanged(){if(!this.eGui)return;const e=this.getCellWidth();this.eGui.style.width=e+"px"}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const n=this.column.getColSpan(this.rowNode),r=[];if(1===n)r.push(this.column);else{let t=this.column;const i=this.column.getPinned();for(let e=0;t&&e<n&&(r.push(t),t=this.beans.columnModel.getDisplayedColAfter(t),t&&!u(t))&&i===t.getPinned();e++);}return r}onLeftChanged(){if(!this.eGui)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=e+"px"}getCellLeft(){let e;return e=this.beans.gridOptionsService.is("enableRtl")&&this.colsSpanning?p(this.colsSpanning):this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.isPrintLayout()||"left"===this.column.getPinned())return e;const t=this.beans.columnModel.getDisplayedColumnsLeftWidth();if("right"===this.column.getPinned()){return t+this.beans.columnModel.getBodyContainerWidth()+(e||0)}return t+(e||0)}applyRowSpan(){if(1===this.rowSpan)return;const e=this.beans.gridOptionsService.getRowHeightAsNumber()*this.rowSpan;this.eGui.style.height=e+"px",this.eGui.style.zIndex="1"}destroy(){super.destroy()}}class Ta extends f{constructor(e,t){super(),this.staticClasses=[],this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const e=this.column.getColDef(),t={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:e,column:this.column,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};this.beans.stylingService.processClassRules(e.cellClassRules,t,e=>this.cellComp.addOrRemoveCssClass(e,!0),e=>this.cellComp.addOrRemoveCssClass(e,!1))}applyUserStyles(){const t=this.column.getColDef();if(!t.cellStyle)return;let i;if("function"==typeof t.cellStyle){const e={column:this.column,value:this.cellCtrl.getValue(),colDef:t,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};i=(0,t.cellStyle)(e)}else i=t.cellStyle;i&&this.cellComp.setUserStyles(i)}applyClassesFromColDef(){const e=this.column.getColDef(),t={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef:e,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};this.staticClasses.length&&this.staticClasses.forEach(e=>this.cellComp.addOrRemoveCssClass(e,!1)),this.staticClasses=this.beans.stylingService.getStaticCellClasses(e,t),this.staticClasses.length&&this.staticClasses.forEach(e=>this.cellComp.addOrRemoveCssClass(e,!0))}destroy(){super.destroy()}}class xa extends f{constructor(e,t){super(),this.ctrl=e,this.beans=t}setComp(e){this.comp=e,this.setupTooltip()}setupTooltip(){this.browserTooltips=this.beans.gridOptionsService.is("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?this.comp.setTitle(null!=this.tooltip?this.tooltip:void 0):this.createTooltipFeatureIfNeeded()}updateTooltipText(){this.tooltip=this.ctrl.getTooltipValue()}createTooltipFeatureIfNeeded(){if(null!=this.genericTooltipFeature)return;const e={getTooltipParams:()=>this.getTooltipParams(),getGui:()=>this.ctrl.getGui()};this.genericTooltipFeature=this.createManagedBean(new Ir(e),this.beans.context)}refreshToolTip(){this.updateTooltipText(),this.browserTooltips&&this.comp.setTitle(null!=this.tooltip?this.tooltip:void 0)}getTooltipParams(){const e=this.ctrl,t=e.getColumn?e.getColumn():void 0,i=e.getColDef?e.getColDef():void 0,n=e.getRowNode?e.getRowNode():void 0;return{location:e.getLocation(),colDef:i,column:t,rowIndex:e.getRowIndex?e.getRowIndex():void 0,node:n,data:n?n.data:void 0,value:this.getTooltipText(),valueFormatted:e.getValueFormatted?e.getValueFormatted():void 0}}getTooltipText(){return this.tooltip}destroy(){super.destroy()}}var I=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let P=class{postConstruct(){this.doingMasterDetail=this.gridOptionsService.isMasterDetail(),this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.gridOptionsService.isRowModelType("serverSide")&&(this.serverSideRowModel=this.rowModel)}};I([o("resizeObserverService")],P.prototype,"resizeObserverService",void 0),I([o("paginationProxy")],P.prototype,"paginationProxy",void 0),I([o("context")],P.prototype,"context",void 0),I([o("columnApi")],P.prototype,"columnApi",void 0),I([o("gridApi")],P.prototype,"gridApi",void 0),I([o("gridOptionsService")],P.prototype,"gridOptionsService",void 0),I([o("expressionService")],P.prototype,"expressionService",void 0),I([o("environment")],P.prototype,"environment",void 0),I([o("rowRenderer")],P.prototype,"rowRenderer",void 0),I([o("templateService")],P.prototype,"templateService",void 0),I([o("valueService")],P.prototype,"valueService",void 0),I([o("eventService")],P.prototype,"eventService",void 0),I([o("columnModel")],P.prototype,"columnModel",void 0),I([o("headerNavigationService")],P.prototype,"headerNavigationService",void 0),I([o("navigationService")],P.prototype,"navigationService",void 0),I([o("columnAnimationService")],P.prototype,"columnAnimationService",void 0),I([c("rangeService")],P.prototype,"rangeService",void 0),I([o("focusService")],P.prototype,"focusService",void 0),I([c("contextMenuFactory")],P.prototype,"contextMenuFactory",void 0),I([o("popupService")],P.prototype,"popupService",void 0),I([o("valueFormatterService")],P.prototype,"valueFormatterService",void 0),I([o("stylingService")],P.prototype,"stylingService",void 0),I([o("columnHoverService")],P.prototype,"columnHoverService",void 0),I([o("userComponentFactory")],P.prototype,"userComponentFactory",void 0),I([o("userComponentRegistry")],P.prototype,"userComponentRegistry",void 0),I([o("animationFrameService")],P.prototype,"animationFrameService",void 0),I([o("dragService")],P.prototype,"dragService",void 0),I([o("dragAndDropService")],P.prototype,"dragAndDropService",void 0),I([o("sortController")],P.prototype,"sortController",void 0),I([o("filterManager")],P.prototype,"filterManager",void 0),I([o("rowContainerHeightService")],P.prototype,"rowContainerHeightService",void 0),I([o("frameworkOverrides")],P.prototype,"frameworkOverrides",void 0),I([o("cellPositionUtils")],P.prototype,"cellPositionUtils",void 0),I([o("rowPositionUtils")],P.prototype,"rowPositionUtils",void 0),I([o("selectionService")],P.prototype,"selectionService",void 0),I([c("selectionHandleFactory")],P.prototype,"selectionHandleFactory",void 0),I([o("rowCssClassCalculator")],P.prototype,"rowCssClassCalculator",void 0),I([o("rowModel")],P.prototype,"rowModel",void 0),I([o("ctrlsService")],P.prototype,"ctrlsService",void 0),I([o("ctrlsFactory")],P.prototype,"ctrlsFactory",void 0),I([o("agStackComponentsRegistry")],P.prototype,"agStackComponentsRegistry",void 0),I([o("valueCache")],P.prototype,"valueCache",void 0),I([o("rowNodeEventThrottle")],P.prototype,"rowNodeEventThrottle",void 0),I([o("localeService")],P.prototype,"localeService",void 0),I([o("valueParserService")],P.prototype,"valueParserService",void 0),I([r],P.prototype,"postConstruct",null),P=I([s("beans")],P);class Da extends P{constructor(e,t,i){super(),this.cellCtrl=e,this.beans=t,this.column=i}onMouseEvent(e,t){if(!bt(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t)}}onCellClicked(e){if(this.isDoubleClickOnIPad())return this.onCellDoubleClicked(e),void e.preventDefault();const{eventService:t,rangeService:i,gridOptionsService:n}=this.beans,r=e.ctrlKey||e.metaKey;i&&r&&i.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&i.intersectLastRange(!0);const s=this.cellCtrl.createEvent(e,y.EVENT_CELL_CLICKED);t.dispatchEvent(s);const o=this.column.getColDef();o.onCellClicked&&window.setTimeout(()=>o.onCellClicked(s),0);(n.is("singleClickEdit")||o.singleClickEdit)&&!n.is("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit()}isDoubleClickOnIPad(){if(!nn()||Ct("dblclick"))return!1;const e=(new Date).getTime(),t=e-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=e,t}onCellDoubleClicked(e){const t=this.column.getColDef(),i=this.cellCtrl.createEvent(e,y.EVENT_CELL_DOUBLE_CLICKED);this.beans.eventService.dispatchEvent(i),"function"==typeof t.onCellDoubleClicked&&window.setTimeout(()=>t.onCellDoubleClicked(i),0);!this.beans.gridOptionsService.is("singleClickEdit")&&!this.beans.gridOptionsService.is("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit(null,e)}onMouseDown(e){const{ctrlKey:t,metaKey:i,shiftKey:n}=e,r=e.target,{eventService:s,rangeService:o}=this.beans;if(this.isRightClickInExistingRange(e))return;const a=o&&0!=o.getCellRanges().length;if(!n||!a){const e=Qi()&&!this.cellCtrl.isEditing()&&!Rn(r);this.cellCtrl.focusCell(e)}if(n&&a&&e.preventDefault(),!this.containsWidget(r)){if(o){const e=this.cellCtrl.getCellPosition();if(n)o.extendLatestRangeToCell(e);else{const n=t||i;o.setRangeToCell(e,n)}}s.dispatchEvent(this.cellCtrl.createEvent(e,y.EVENT_CELL_MOUSE_DOWN))}}isRightClickInExistingRange(e){const{rangeService:t}=this.beans;if(t){if(t.isCellInAnyRange(this.cellCtrl.getCellPosition())&&2===e.button)return!0}return!1}containsWidget(e){return On(e,"ag-selection-checkbox",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;const t=this.cellCtrl.createEvent(e,y.EVENT_CELL_MOUSE_OUT);this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;const t=this.cellCtrl.createEvent(e,y.EVENT_CELL_MOUSE_OVER);this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.getGui(),i=t.contains(e.target),n=t.contains(e.relatedTarget);return i&&n}destroy(){}}class Ra extends f{constructor(e,t,i,n,r){super(),this.cellCtrl=e,this.beans=t,this.rowNode=n,this.rowCtrl=r}setComp(e){this.eGui=e}onKeyDown(e){const t=e.key;switch(t){case A.ENTER:this.onEnterKeyDown(e);break;case A.F2:this.onF2KeyDown(e);break;case A.ESCAPE:this.onEscapeKeyDown(e);break;case A.TAB:this.onTabKeyDown(e);break;case A.BACKSPACE:case A.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case A.DOWN:case A.UP:case A.RIGHT:case A.LEFT:this.onNavigationKeyDown(e,t)}}onNavigationKeyDown(e,t){this.cellCtrl.isEditing()||(e.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(e):this.beans.navigationService.navigateToNextCell(e,t,this.cellCtrl.getCellPosition(),!0),e.preventDefault())}onShiftRangeSelect(e){if(!this.beans.rangeService)return;const t=this.beans.rangeService.extendLatestRangeInDirection(e);t&&this.beans.navigationService.ensureCellVisible(t)}onTabKeyDown(e){this.beans.navigationService.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){const{cellCtrl:i,beans:n,rowNode:r}=this,{gridOptionsService:s,rangeService:o,eventService:a}=n;i.isEditing()||(a.dispatchEvent({type:y.EVENT_KEY_SHORTCUT_CHANGED_CELL_START}),wr(e,s.is("enableCellEditingOnBackspace"))?o&&s.isEnableRangeSelection()?o.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"}):i.isCellEditable()&&r.setDataValue(i.getColumn(),null,"cellClear"):i.startRowOrCellEdit(e,t),a.dispatchEvent({type:y.EVENT_KEY_SHORTCUT_CHANGED_CELL_END}))}onEnterKeyDown(t){if(this.cellCtrl.isEditing()||this.rowCtrl.isEditing())this.cellCtrl.stopEditingAndFocus(!1,t.shiftKey);else if(this.beans.gridOptionsService.is("enterNavigatesVertically")){const e=t.shiftKey?A.UP:A.DOWN;this.beans.navigationService.navigateToNextCell(null,e,this.cellCtrl.getCellPosition(),!1)}else this.cellCtrl.startRowOrCellEdit(A.ENTER,t),this.cellCtrl.isEditing()&&t.preventDefault()}onF2KeyDown(e){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(A.F2,e)}onEscapeKeyDown(e){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))}processCharacter(e){if(e.target!==this.eGui||this.cellCtrl.isEditing())return;const t=e.key;" "===t?this.onSpaceKeyDown(e):(this.cellCtrl.startRowOrCellEdit(t,e),e.preventDefault())}onSpaceKeyDown(n){const{gridOptionsService:r}=this.beans;if(!this.cellCtrl.isEditing()&&r.isRowSelection()){const t=this.rowNode.isSelected(),i=!t;if(i||!r.is("suppressRowDeselection")){const r=this.beans.gridOptionsService.is("groupSelectsFiltered"),e=this.rowNode.setSelectedParams({newValue:i,rangeSelect:n.shiftKey,groupSelectsFiltered:r,event:n,source:"spaceKey"});void 0===t&&0===e&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:n.shiftKey,groupSelectsFiltered:r,event:n,source:"spaceKey"})}}n.preventDefault()}destroy(){super.destroy()}}var Ma=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Na extends E{constructor(e,t,i){super('<div class="ag-drag-handle ag-row-drag" draggable="true"></div>'),this.rowNode=e,this.column=t,this.eCell=i}postConstruct(){this.getGui().appendChild(mr("rowDrag",this.gridOptionsService,null)),this.addGuiEventListener("mousedown",e=>{e.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(t){const e=this.column.getColDef().dndSourceOnRowDrag;t.dataTransfer.setDragImage(this.eCell,0,0);const i=()=>{try{const e=JSON.stringify(this.rowNode.data);t.dataTransfer.setData("application/json",e),t.dataTransfer.setData("text/plain",e)}catch(e){}};if(e){e({rowNode:this.rowNode,dragEvent:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context})}else i()}checkVisibility(){const e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}}Ma([r],Na.prototype,"postConstruct",null);let Oa=0;class Ia extends f{constructor(e,t,i,n){super(),this.cellRangeFeature=null,this.cellPositionFeature=null,this.cellCustomStyleFeature=null,this.tooltipFeature=null,this.cellMouseListenerFeature=null,this.cellKeyboardListenerFeature=null,this.suppressRefreshCell=!1,this.onCellCompAttachedFuncs=[],this.column=e,this.rowNode=t,this.beans=i,this.rowCtrl=n,this.instanceId=e.getId()+"-"+Oa++,this.createCellPosition(),this.addFeatures()}shouldRestoreFocus(){return this.beans.focusService.shouldRestoreFocus(this.cellPosition)}addFeatures(){this.cellPositionFeature=new Sa(this,this.beans),this.addDestroyFunc(()=>{var e;null===(e=this.cellPositionFeature)||void 0===e||e.destroy(),this.cellPositionFeature=null}),this.cellCustomStyleFeature=new Ta(this,this.beans),this.addDestroyFunc(()=>{var e;null===(e=this.cellCustomStyleFeature)||void 0===e||e.destroy(),this.cellCustomStyleFeature=null}),this.cellMouseListenerFeature=new Da(this,this.beans,this.column),this.addDestroyFunc(()=>{var e;null===(e=this.cellMouseListenerFeature)||void 0===e||e.destroy(),this.cellMouseListenerFeature=null}),this.cellKeyboardListenerFeature=new Ra(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.addDestroyFunc(()=>{var e;null===(e=this.cellKeyboardListenerFeature)||void 0===e||e.destroy(),this.cellKeyboardListenerFeature=null});this.beans.rangeService&&this.beans.gridOptionsService.isEnableRangeSelection()&&(this.cellRangeFeature=new Ea(this.beans,this),this.addDestroyFunc(()=>{var e;null===(e=this.cellRangeFeature)||void 0===e||e.destroy(),this.cellRangeFeature=null})),this.column.isTooltipEnabled()&&this.addTooltipFeature()}addTooltipFeature(){const e={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getRowIndex:()=>this.cellPosition.rowIndex,getRowNode:()=>this.rowNode,getGui:()=>this.getGui(),getLocation:()=>"cell",getTooltipValue:()=>{const e=this.column.getColDef(),t=this.rowNode.data;if(e.tooltipField&&_(t))return Ae(t,e.tooltipField,this.column.isTooltipFieldContainsDots());const i=e.tooltipValueGetter;return i?i({location:"cell",api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,colDef:this.column.getColDef(),column:this.column,rowIndex:this.cellPosition.rowIndex,node:this.rowNode,data:this.rowNode.data,value:this.value,valueFormatted:this.valueFormatted}):null},getValueFormatted:()=>this.valueFormatted};this.tooltipFeature=new xa(e,this.beans),this.addDestroyFunc(()=>{var e;null===(e=this.tooltipFeature)||void 0===e||e.destroy(),this.tooltipFeature=null})}setComp(e,t,i,n,r){var s,o,a,l;this.cellComp=e,this.eGui=t,this.printLayout=n,this.updateAndFormatValue(!0),this.addDomData(),this.onCellFocused(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),i&&this.setupAutoHeight(i),this.setAriaColIndex(),this.beans.gridOptionsService.is("suppressCellFocus")||this.cellComp.setTabIndex(-1);const c=$t(this.column.getId());this.cellComp.setColId(c),this.cellComp.setRole("gridcell"),null===(s=this.cellPositionFeature)||void 0===s||s.setComp(t),null===(o=this.cellCustomStyleFeature)||void 0===o||o.setComp(e),null===(a=this.tooltipFeature)||void 0===a||a.setComp(e),null===(l=this.cellKeyboardListenerFeature)||void 0===l||l.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(e,t),r&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach(e=>e()),this.onCellCompAttachedFuncs=[])}setupAutoHeight(l){if(!this.column.isAutoHeight())return;const c=l.parentElement,u=this.beans.gridOptionsService.getRowHeightForNode(this.rowNode).height,d=e=>{if(this.editing)return;if(!this.isAlive())return;const{paddingTop:t,paddingBottom:i,borderBottomWidth:n,borderTopWidth:r}=In(c),s=t+i+n+r,o=l.offsetHeight+s;if(e<5){const c=this.beans.gridOptionsService.getDocument(),u=0==o;if(!c||!c.contains(l)||u)return void this.beans.frameworkOverrides.setTimeout(()=>d(e+1),0)}const a=Math.max(o,u);this.rowNode.setRowAutoHeight(a,this.column)},e=()=>d(0);e();const t=this.beans.resizeObserverService.observeResize(l,e);this.addDestroyFunc(()=>{t(),this.rowNode.setRowAutoHeight(void 0,this.column)})}getInstanceId(){return this.instanceId}showValue(e=!1){const t=null!=this.valueFormatted?this.valueFormatted:this.value,i=this.createCellRendererParams(),n=this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(),i);this.cellComp.setRenderDetails(n,t,e),this.refreshHandle()}setupControlComps(){const e=this.column.getColDef();this.includeSelection=this.isIncludeControl(e.checkboxSelection),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gridOptionsService.is("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(e){return!(null!=this.rowNode.rowPinned)&&("function"==typeof e||!0===e)}refreshShouldDestroy(){const e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(e.checkboxSelection),i=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),n=this.includeDndSource!=this.isIncludeControl(e.dndSource);return t||i||n}startEditing(e=null,t=!1,i=null){if(!this.isCellEditable()||this.editing)return;if(!this.cellComp)return void this.onCellCompAttachedFuncs.push(()=>{this.startEditing(e,t,i)});const n=this.createCellEditorParams(e,t),r=this.column.getColDef(),s=this.beans.userComponentFactory.getCellEditorDetails(r,n),o=null!=(null==s?void 0:s.popupFromSelector)?s.popupFromSelector:!!r.cellEditorPopup,a=null!=(null==s?void 0:s.popupPositionFromSelector)?s.popupPositionFromSelector:r.cellEditorPopupPosition;this.setEditing(!0),this.cellComp.setEditDetails(s,o,a);const l=this.createEvent(i,y.EVENT_CELL_EDITING_STARTED);this.beans.eventService.dispatchEvent(l)}setEditing(e){this.editing!==e&&(this.editing=e,this.refreshHandle())}stopRowOrCellEdit(e=!1){"fullRow"===this.beans.gridOptionsService.get("editType")?this.rowCtrl.stopRowEditing(e):this.stopEditing(e)}onPopupEditorClosed(){this.isEditing()&&this.stopEditingAndFocus()}takeValueFromCellEditor(e){const t={newValueExists:!1};if(e)return t;const i=this.cellComp.getCellEditor();if(!i)return t;if(i.isCancelAfterEnd&&i.isCancelAfterEnd())return t;return{newValue:i.getValue(),newValueExists:!0}}saveNewValue(e,t){if(t===e)return!1;this.suppressRefreshCell=!0;const i=this.rowNode.setDataValue(this.column,t,"edit");return this.suppressRefreshCell=!1,i}stopEditing(e=!1){if(!this.editing)return!1;const{newValue:t,newValueExists:i}=this.takeValueFromCellEditor(e),n=this.rowNode.getValueFromValueService(this.column);let r=!1;return i&&(r=this.saveNewValue(n,t)),this.setEditing(!1),this.cellComp.setEditDetails(),this.updateAndFormatValue(),this.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.dispatchEditingStoppedEvent(n,t,!e&&!!r),r}dispatchEditingStoppedEvent(e,t,i){const n=Object.assign(Object.assign({},this.createEvent(null,y.EVENT_CELL_EDITING_STOPPED)),{oldValue:e,newValue:t,valueChanged:i});this.beans.eventService.dispatchEvent(n)}createCellEditorParams(e,t){return{value:this.rowNode.getValueFromValueService(this.column),eventKey:e,column:this.column,colDef:this.column.getColDef(),rowIndex:this.getCellPosition().rowIndex,node:this.rowNode,data:this.rowNode.data,api:this.beans.gridOptionsService.api,cellStartedEdit:t,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,onKeyDown:this.onKeyDown.bind(this),stopEditing:this.stopEditingAndFocus.bind(this),eGridCell:this.getGui(),parseValue:this.parseValue.bind(this),formatValue:this.formatValue.bind(this)}}createCellRendererParams(){return{value:this.value,valueFormatted:this.valueFormatted,getValue:()=>this.rowNode.getValueFromValueService(this.column),setValue:e=>this.beans.valueService.setValue(this.rowNode,this.column,e),formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,rowIndex:this.getCellPosition().rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:(e,t,i,n)=>this.registerRowDragger(e,t,n)}}parseValue(e){return this.beans.valueParserService.parseValue(this.column,this.rowNode,e,this.getValue())}setFocusOutOnEditor(){if(!this.editing)return;const e=this.cellComp.getCellEditor();e&&e.focusOut&&e.focusOut()}setFocusInOnEditor(){if(!this.editing)return;const e=this.cellComp.getCellEditor();e&&e.focusIn?e.focusIn():this.focusCell(!0)}onCellChanged(e){if(!this.cellComp)return;e.column===this.column&&this.refreshCell({})}refreshCell(e){var t,i,n;if(this.suppressRefreshCell||this.editing)return;if(!this.cellComp)return;const r=this.column.getColDef(),s=null!=e&&!!e.newData,o=null!=e&&!!e.suppressFlash||!!r.suppressCellFlash,a=null==r.field&&null==r.valueGetter&&null==r.showRowGroup,l=e&&e.forceRefresh||a||s,c=this.updateAndFormatValue();if(l||c){this.showValue(s);const e=this.beans.filterManager.isSuppressFlashingCellsBecauseFiltering();!o&&!e&&(this.beans.gridOptionsService.is("enableCellChangeFlash")||r.enableCellChangeFlash)&&this.flashCell(),null===(t=this.cellCustomStyleFeature)||void 0===t||t.applyUserStyles(),null===(i=this.cellCustomStyleFeature)||void 0===i||i.applyClassesFromColDef()}this.refreshToolTip(),null===(n=this.cellCustomStyleFeature)||void 0===n||n.applyCellClassRules()}stopEditingAndFocus(e=!1,t=!1){this.stopRowOrCellEdit(),this.focusCell(!0),e||this.navigateAfterEdit(t)}navigateAfterEdit(t){if(this.beans.gridOptionsService.is("enterNavigatesVerticallyAfterEdit")){const e=t?A.UP:A.DOWN;this.beans.navigationService.navigateToNextCell(null,e,this.getCellPosition(),!1)}}flashCell(e){const t=e&&e.flashDelay,i=e&&e.fadeDelay;this.animateCell("data-changed",t,i)}animateCell(e,t,i){var n,r;const s="ag-cell-"+e,o=`ag-cell-${e}-animation`,{gridOptionsService:a}=this.beans;t||(t=null!==(n=a.getNum("cellFlashDelay"))&&void 0!==n?n:500),_(i)||(i=null!==(r=a.getNum("cellFadeDelay"))&&void 0!==r?r:1e3),this.cellComp.addOrRemoveCssClass(s,!0),this.cellComp.addOrRemoveCssClass(o,!1),window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(s,!1),this.cellComp.addOrRemoveCssClass(o,!0),this.eGui.style.transition=`background-color ${i}ms`,window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(o,!1),this.eGui.style.transition="")},i))},t)}onFlashCells(e){if(!this.cellComp)return;const t=this.beans.cellPositionUtils.createId(this.getCellPosition());e.cells[t]&&this.animateCell("highlight")}isCellEditable(){return this.column.isCellEditable(this.rowNode)}isSuppressFillHandle(){return this.column.isSuppressFillHandle()}formatValue(e){const t=this.callValueFormatter(e);return null!=t?t:e}callValueFormatter(e){return this.beans.valueFormatterService.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e=!1){const t=this.value,i=this.valueFormatted;this.value=this.rowNode.getValueFromValueService(this.column),this.valueFormatted=this.callValueFormatter(this.value);return!!e||(!this.valuesAreEqual(t,this.value)||this.valueFormatted!=i)}valuesAreEqual(e,t){const i=this.column.getColDef();return i.equals?i.equals(e,t):e===t}getComp(){return this.cellComp}getValue(){return this.value}getValueFormatted(){return this.valueFormatted}addDomData(){const e=this.getGui();this.beans.gridOptionsService.setDomData(e,Ia.DOM_DATA_KEY_CELL_CTRL,this),this.addDestroyFunc(()=>this.beans.gridOptionsService.setDomData(e,Ia.DOM_DATA_KEY_CELL_CTRL,null))}createEvent(e,t){return{type:t,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),context:this.beans.gridOptionsService.context,api:this.beans.gridApi,columnApi:this.beans.columnApi,rowPinned:this.rowNode.rowPinned,event:e,rowIndex:this.rowNode.rowIndex}}processCharacter(e){var t;null===(t=this.cellKeyboardListenerFeature)||void 0===t||t.processCharacter(e)}onKeyDown(e){var t;null===(t=this.cellKeyboardListenerFeature)||void 0===t||t.onKeyDown(e)}onMouseEvent(e,t){var i;null===(i=this.cellMouseListenerFeature)||void 0===i||i.onMouseEvent(e,t)}getGui(){return this.eGui}refreshToolTip(){var e;null===(e=this.tooltipFeature)||void 0===e||e.refreshToolTip()}getColSpanningList(){return this.cellPositionFeature.getColSpanningList()}onLeftChanged(){var e;this.cellComp&&(null===(e=this.cellPositionFeature)||void 0===e||e.onLeftChanged())}onDisplayedColumnsChanged(){this.eGui&&this.setAriaColIndex()}setAriaColIndex(){const e=this.beans.columnModel.getAriaColumnIndex(this.column);Wi(this.getGui(),e)}isSuppressNavigable(){return this.column.isSuppressNavigable(this.rowNode)}onWidthChanged(){var e;return null===(e=this.cellPositionFeature)||void 0===e?void 0:e.onWidthChanged()}getColumn(){return this.column}getRowNode(){return this.rowNode}getBeans(){return this.beans}isPrintLayout(){return this.printLayout}appendChild(e){this.eGui.appendChild(e)}refreshHandle(){this.cellRangeFeature&&this.cellRangeFeature.refreshHandle()}getCellPosition(){return this.cellPosition}isEditing(){return this.editing}startRowOrCellEdit(e,t=null){this.cellComp&&("fullRow"===this.beans.gridOptionsService.get("editType")?this.rowCtrl.startRowEditing(e,this):this.startEditing(e,!0,t))}getRowCtrl(){return this.rowCtrl}getRowPosition(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}}updateRangeBordersIfRangeCount(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()}onRangeSelectionChanged(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}isRangeSelectionEnabled(){return null!=this.cellRangeFeature}focusCell(e=!1){this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus:e})}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}onFirstRightPinnedChanged(){if(!this.cellComp)return;const e=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass("ag-cell-first-right-pinned",e)}onLastLeftPinnedChanged(){if(!this.cellComp)return;const e=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass("ag-cell-last-left-pinned",e)}onCellFocused(e){if(!this.cellComp||this.beans.gridOptionsService.is("suppressCellFocus"))return;const t=this.beans.focusService.isCellFocused(this.cellPosition);if(this.cellComp.addOrRemoveCssClass("ag-cell-focus",t),t&&e&&e.forceBrowserFocus){this.cellComp.getFocusableElement().focus({preventScroll:!!e.preventScrollOnBrowserFocus})}const i="fullRow"===this.beans.gridOptionsService.get("editType");t||i||!this.editing||this.stopRowOrCellEdit()}createCellPosition(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:J(this.rowNode.rowPinned),column:this.column}}applyStaticCssClasses(){this.cellComp.addOrRemoveCssClass("ag-cell",!0),this.cellComp.addOrRemoveCssClass("ag-cell-not-inline-editing",!0);const e=1==this.column.isAutoHeight();this.cellComp.addOrRemoveCssClass("ag-cell-auto-height",e),this.cellComp.addOrRemoveCssClass("ag-cell-normal-height",!e)}onColumnHover(){if(!this.cellComp)return;if(!this.beans.gridOptionsService.is("columnHoverHighlight"))return;const e=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass("ag-column-hover",e)}onColDefChanged(){this.cellComp&&(this.setWrapText(),this.editing||this.refreshCell({forceRefresh:!0,suppressFlash:!0}))}setWrapText(){const e=1==this.column.getColDef().wrapText;this.cellComp.addOrRemoveCssClass("ag-cell-wrap-text",e)}dispatchCellContextMenuEvent(e){const t=this.column.getColDef(),i=this.createEvent(e,y.EVENT_CELL_CONTEXT_MENU);this.beans.eventService.dispatchEvent(i),t.onCellContextMenu&&window.setTimeout(()=>t.onCellContextMenu(i),0)}getCellRenderer(){return this.cellComp?this.cellComp.getCellRenderer():null}getCellEditor(){return this.cellComp?this.cellComp.getCellEditor():null}destroy(){this.onCellCompAttachedFuncs=[],super.destroy()}createSelectionCheckbox(){const e=new Qs;return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){const e=new Na(this.rowNode,this.column,this.eGui);return this.beans.context.createBean(e),e}registerRowDragger(e,t,i){if(this.customRowDragComp)return void this.customRowDragComp.setDragElement(e,t);const n=this.createRowDragComp(e,t,i);n&&(this.customRowDragComp=n,this.addDestroyFunc(()=>{this.beans.context.destroyBean(n),this.customRowDragComp=null}))}createRowDragComp(e,t,i){const n=this.beans.gridOptionsService.is("pagination"),r=this.beans.gridOptionsService.is("rowDragManaged"),s=this.beans.gridOptionsService.isRowModelType("clientSide");if(r){if(!s)return void l(()=>console.warn("AG Grid: managed row dragging is only allowed in the Client Side Row Model"),"CellComp.addRowDragging");if(n)return void l(()=>console.warn("AG Grid: managed row dragging is not possible when doing pagination"),"CellComp.addRowDragging")}const o=new ro(()=>this.value,this.rowNode,this.column,e,t,i);return this.beans.context.createBean(o),o}}var Pa;Ia.DOM_DATA_KEY_CELL_CTRL="cellCtrl",function(e){e.Normal="Normal",e.FullWidth="FullWidth",e.FullWidthLoading="FullWidthLoading",e.FullWidthGroup="FullWidthGroup",e.FullWidthDetail="FullWidthDetail"}(Pa||(Pa={}));let ka=0;class La extends f{constructor(e,t,i,n,r){super(),this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.lastMouseDownOnDragger=!1,this.updateColumnListsPending=!1,this.businessKeySanitised=null,this.beans=t,this.gridOptionsService=t.gridOptionsService,this.rowNode=e,this.paginationPage=t.paginationProxy.getCurrentPage(),this.useAnimationFrameForCreate=n,this.printLayout=r,this.instanceId=e.id+"-"+ka++,this.setAnimateFlags(i),this.initRowBusinessKey(),this.rowFocused=t.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=t.rowCssClassCalculator.calculateRowLevel(this.rowNode),this.setRowType(),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gridOptionsService.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if("function"!=typeof this.businessKeyForNodeFunc)return;const e=this.businessKeyForNodeFunc(this.rowNode);this.businessKeySanitised=$t(e)}isSticky(){return this.rowNode.sticky}getBeans(){return this.beans}getInstanceId(){return this.instanceId}setComp(e,t,i){const n={rowComp:e,element:t,containerType:i};this.allRowGuis.push(n),i===Qa.LEFT?this.leftGui=n:i===Qa.RIGHT?this.rightGui=n:i===Qa.FULL_WIDTH?this.fullWidthGui=n:this.centerGui=n,this.initialiseRowComp(n),"FullWidthLoading"===this.rowType||this.rowNode.rowPinned||this.beans.rowRenderer.dispatchFirstDataRenderedEvent()}unsetComp(t){this.allRowGuis=this.allRowGuis.filter(e=>e.containerType!==t),t===Qa.LEFT?this.leftGui=void 0:t===Qa.RIGHT?this.rightGui=void 0:t===Qa.FULL_WIDTH&&(this.fullWidthGui=void 0)}isCacheable(){return this.rowType===Pa.FullWidthDetail&&this.gridOptionsService.is("keepDetailRows")}setCached(e){const t=e?"none":"";this.allRowGuis.forEach(e=>e.element.style.display=t)}initialiseRowComp(e){const t=this.gridOptionsService;this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(e),t.isRowSelection()&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);const i=e.rowComp;i.setRole("row");this.getInitialRowClasses(e.containerType).forEach(e=>i.addOrRemoveCssClass(e,!0)),this.executeSlideAndFadeAnimations(e),this.rowNode.group&&ki(e.element,1==this.rowNode.expanded),this.setRowCompRowId(i),this.setRowCompRowBusinessKey(i),this.isFullWidth()&&!this.gridOptionsService.is("suppressCellFocus")&&i.setTabIndex(-1),t.setDomData(e.element,La.DOM_DATA_KEY_ROW_CTRL,this),this.addDestroyFunc(()=>t.setDomData(e.element,La.DOM_DATA_KEY_ROW_CTRL,null)),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,e.element),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(e.element),this.isFullWidth()&&this.setupFullWidth(e),t.is("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask(()=>{this.isAlive()&&e.rowComp.addOrRemoveCssClass("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){null!=this.businessKeySanitised&&e.setRowBusinessKey(this.businessKeySanitised)}setRowCompRowId(e){const t=$t(this.rowNode.id);null!=t&&e.setRowId(t)}executeSlideAndFadeAnimations(e){const{containerType:t}=e;this.slideInAnimation[t]&&(Oe(()=>{this.onTopChanged()}),this.slideInAnimation[t]=!1);this.fadeInAnimation[t]&&(Oe(()=>{e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)}),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){if(this.gridOptionsService.isEnableRangeSelection())return void l(()=>{console.warn("AG Grid: Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `enableRangeSelection: true`")},"rowDragAndRangeSelectionEnabled");const t=this.beans.localeService.getLocaleTextFunc(),i=new ro(()=>"1 "+t("rowDragRow","row"),this.rowNode,void 0,e.element,void 0,!0);this.createManagedBean(i,this.beans.context)}setupFullWidth(e){const t=this.getPinnedForContainer(e.containerType),i=this.createFullWidthParams(e.element,t);if(this.rowType==Pa.FullWidthDetail&&!v.__assertRegistered(m.MasterDetailModule,"cell renderer 'agDetailCellRenderer' (for master detail)",this.beans.context.getGridId()))return;let n;switch(this.rowType){case Pa.FullWidthDetail:n=this.beans.userComponentFactory.getFullWidthDetailCellRendererDetails(i);break;case Pa.FullWidthGroup:n=this.beans.userComponentFactory.getFullWidthGroupCellRendererDetails(i);break;case Pa.FullWidthLoading:n=this.beans.userComponentFactory.getFullWidthLoadingCellRendererDetails(i);break;default:n=this.beans.userComponentFactory.getFullWidthCellRendererDetails(i)}e.rowComp.showFullWidth(n)}isPrintLayout(){return this.printLayout}getFullWidthCellRenderer(){var e,t;return null===(t=null===(e=this.fullWidthGui)||void 0===e?void 0:e.rowComp)||void 0===t?void 0:t.getFullWidthCellRenderer()}getCellElement(e){const t=this.getCellCtrl(e);return t?t.getGui():null}executeProcessRowPostCreateFunc(){var e;const t=this.gridOptionsService.getCallback("processRowPostCreate");if(!t||!this.areAllContainersReady())return;t({eRow:null===(e=this.centerGui)||void 0===e?void 0:e.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)})}areAllContainersReady(){const e=!!this.leftGui||!this.beans.columnModel.isPinningLeft(),t=!!this.centerGui,i=!!this.rightGui||!this.beans.columnModel.isPinningRight();return e&&t&&i}setRowType(){const e=this.rowNode.stub,t=this.rowNode.isFullWidthCell(),i=this.beans.doingMasterDetail&&this.rowNode.detail,n=this.beans.columnModel.isPivotMode(),r=!!this.rowNode.group&&!this.rowNode.footer&&this.gridOptionsService.isGroupUseEntireRow(n);this.rowType=e?Pa.FullWidthLoading:i?Pa.FullWidthDetail:t?Pa.FullWidth:r?Pa.FullWidthGroup:Pa.Normal}updateColumnLists(e=!1,t=!1){if(this.isFullWidth())return;e||this.gridOptionsService.is("suppressAnimationFrame")||this.printLayout?this.updateColumnListsImpl(t):this.updateColumnListsPending||(this.beans.animationFrameService.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0)}createCellCtrls(n,e,t=null){const i={list:[],map:{}},r=(e,t)=>{i.list.push(t),i.map[e]=t};return e.forEach(e=>{const t=e.getInstanceId();let i=n.map[t];i||(i=new Ia(e,this.rowNode,this.beans,this)),r(t,i)}),n.list.forEach(e=>{if(null!=i.map[e.getColumn().getInstanceId()])return;this.isCellEligibleToBeRemoved(e,t)?e.destroy():r(e.getColumn().getInstanceId(),e)}),i}updateColumnListsImpl(i=!1){this.updateColumnListsPending=!1;const n=this.beans.columnModel;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,n.getAllDisplayedColumns()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const i=n.getViewportCenterColumnsForRow(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,i);const e=n.getDisplayedLeftColumnsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,e,"left");const t=n.getDisplayedRightColumnsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,t,"right")}this.allRowGuis.forEach(e=>{const t=e.containerType===Qa.LEFT?this.leftCellCtrls:e.containerType===Qa.RIGHT?this.rightCellCtrls:this.centerCellCtrls;e.rowComp.setCellCtrls(t.list,i)})}isCellEligibleToBeRemoved(e,t){if(e.getColumn().getPinned()!=t)return!0;const i=e.isEditing(),n=this.beans.focusService.isCellFocused(e.getCellPosition());if(i||n){const t=e.getColumn();return!(this.beans.columnModel.getAllDisplayedColumns().indexOf(t)>=0)}return!0}listenOnDomOrder(i){const e=()=>{const e=this.gridOptionsService.is("ensureDomOrder"),t=this.gridOptionsService.isDomLayout("print");i.rowComp.setDomOrder(e||t)};this.addManagedPropertyListener("domLayout",e),e()}setAnimateFlags(e){if(this.isSticky()||!e)return;const t=_(this.rowNode.oldRowTop),i=this.beans.columnModel.isPinningLeft(),n=this.beans.columnModel.isPinningRight();t?(this.slideInAnimation.center=!0,this.slideInAnimation.left=i,this.slideInAnimation.right=n):(this.fadeInAnimation.center=!0,this.fadeInAnimation.left=i,this.fadeInAnimation.right=n)}isEditing(){return this.editingRow}stopRowEditing(e){this.stopEditing(e)}isFullWidth(){return this.rowType!==Pa.Normal}getRowType(){return this.rowType}refreshFullWidth(){const e=(e,t)=>{if(!e)return!0;const i=e.rowComp.getFullWidthCellRenderer();if(!i)return!1;if(!i.refresh)return!1;const n=this.createFullWidthParams(e.element,t);return i.refresh(n)},t=e(this.fullWidthGui,null),i=e(this.centerGui,null),n=e(this.leftGui,"left"),r=e(this.rightGui,"right");return t&&i&&n&&r}addListeners(){this.addManagedListener(this.rowNode,R.EVENT_HEIGHT_CHANGED,()=>this.onRowHeightChanged()),this.addManagedListener(this.rowNode,R.EVENT_ROW_SELECTED,()=>this.onRowSelected()),this.addManagedListener(this.rowNode,R.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_TOP_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_EXPANDED_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_HAS_CHILDREN_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_CELL_CHANGED,this.onRowNodeCellChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_HIGHLIGHT_CHANGED,this.onRowNodeHighlightChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_DRAGGING_CHANGED,this.onRowNodeDraggingChanged.bind(this)),this.addManagedListener(this.rowNode,R.EVENT_UI_LEVEL_CHANGED,this.onUiLevelChanged.bind(this));const e=this.beans.eventService;this.addManagedListener(e,y.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,this.onPaginationPixelOffsetChanged.bind(this)),this.addManagedListener(e,y.EVENT_HEIGHT_SCALE_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(e,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(e,y.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(e,y.EVENT_CELL_FOCUSED,this.onCellFocused.bind(this)),this.addManagedListener(e,y.EVENT_CELL_FOCUS_CLEARED,this.onCellFocusCleared.bind(this)),this.addManagedListener(e,y.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addManagedListener(e,y.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedListener(e,y.EVENT_COLUMN_MOVED,this.onColumnMoved.bind(this)),this.addListenersForCellComps()}onColumnMoved(){this.updateColumnLists()}addListenersForCellComps(){this.addManagedListener(this.rowNode,R.EVENT_ROW_INDEX_CHANGED,()=>{this.getAllCellCtrls().forEach(e=>e.onRowIndexChanged())}),this.addManagedListener(this.rowNode,R.EVENT_CELL_CHANGED,t=>{this.getAllCellCtrls().forEach(e=>e.onCellChanged(t))})}onRowNodeDataChanged(t){this.rowNode.detailNode&&this.beans.rowRenderer.refreshFullWidthRow(this.rowNode.detailNode),this.isFullWidth()?this.beans.rowRenderer.refreshFullWidthRow(this.rowNode):(this.getAllCellCtrls().forEach(e=>e.refreshCell({suppressFlash:!t.update,newData:!t.update})),this.allRowGuis.forEach(e=>{this.setRowCompRowId(e.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(e.rowComp)}),this.onRowSelected(),this.postProcessCss())}onRowNodeCellChanged(){this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const n=this.rowNode.highlighted;this.allRowGuis.forEach(e=>{const t=n===ea.Above,i=n===ea.Below;e.rowComp.addOrRemoveCssClass("ag-row-highlight-above",t),e.rowComp.addOrRemoveCssClass("ag-row-highlight-below",i)})}onRowNodeDraggingChanged(){this.postProcessRowDragging()}postProcessRowDragging(){const t=this.rowNode.dragging;this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass("ag-row-dragging",t))}updateExpandedCss(){const t=this.rowNode.isExpandable(),i=1==this.rowNode.expanded;this.allRowGuis.forEach(e=>{e.rowComp.addOrRemoveCssClass("ag-row-group",t),e.rowComp.addOrRemoveCssClass("ag-row-group-expanded",t&&i),e.rowComp.addOrRemoveCssClass("ag-row-group-contracted",t&&!i),ki(e.element,t&&i)})}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:J(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(t){const e=this.allRowGuis.find(e=>e.element.contains(t.target));if(!((e?e.element:null)===t.target))return;const i=this.rowNode,n=this.beans.focusService.getFocusedCell(),r={rowIndex:i.rowIndex,rowPinned:i.rowPinned,column:n&&n.column};this.beans.navigationService.navigateToNextCell(t,t.key,r,!0),t.preventDefault()}onTabKeyDown(t){if(t.defaultPrevented||bt(t))return;const e=this.allRowGuis.find(e=>e.element.contains(t.target)),i=e?e.element:null,n=i===t.target;let r=null;n||(r=this.beans.focusService.findNextFocusableElement(i,!1,t.shiftKey)),(this.isFullWidth()&&n||!r)&&this.beans.navigationService.onTabKeyDown(this,t)}onFullWidthRowFocused(e){var t;const i=this.rowNode,n=!!e&&(this.isFullWidth()&&e.rowIndex===i.rowIndex&&e.rowPinned==i.rowPinned),r=this.fullWidthGui?this.fullWidthGui.element:null===(t=this.centerGui)||void 0===t?void 0:t.element;r&&(r.classList.toggle("ag-full-width-focus",n),n&&r.focus({preventScroll:!0}))}refreshCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),this.updateColumnLists()}removeCellCtrl(e,t){const i={list:[],map:{}};return e.list.forEach(e=>{e!==t&&(i.list.push(e),i.map[e.getInstanceId()]=e)}),i}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t)}}createRowEvent(e,t){return{type:e,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,context:this.gridOptionsService.context,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,event:t}}createRowEventWithSource(e,t){const i=this.createRowEvent(e,t);return i.source=this,i}onRowDblClick(e){if(bt(e))return;const t=this.createRowEventWithSource(y.EVENT_ROW_DOUBLE_CLICKED,e);this.beans.eventService.dispatchEvent(t)}onRowMouseDown(e){if(this.lastMouseDownOnDragger=On(e.target,"ag-row-drag",3),!this.isFullWidth())return;const t=this.rowNode,i=this.beans.columnModel;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges(),this.beans.focusService.setFocusedCell({rowIndex:t.rowIndex,column:i.getAllDisplayedColumns()[0],rowPinned:t.rowPinned,forceBrowserFocus:!0})}onRowClick(e){if(bt(e)||this.lastMouseDownOnDragger)return;const t=this.createRowEventWithSource(y.EVENT_ROW_CLICKED,e);this.beans.eventService.dispatchEvent(t);const i=e.ctrlKey||e.metaKey,n=e.shiftKey;if(this.gridOptionsService.is("groupSelectsChildren")&&this.rowNode.group||!this.rowNode.selectable||this.rowNode.rowPinned||!this.gridOptionsService.isRowSelection()||this.gridOptionsService.is("suppressRowClickSelection"))return;const r=this.gridOptionsService.is("rowMultiSelectWithClick"),s=!this.gridOptionsService.is("suppressRowDeselection"),o="rowClicked";if(this.rowNode.isSelected())r?this.rowNode.setSelectedParams({newValue:!1,event:e,source:o}):i?s&&this.rowNode.setSelectedParams({newValue:!1,event:e,source:o}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!n,rangeSelect:n,event:e,source:o});else{const t=!r&&!i;this.rowNode.setSelectedParams({newValue:!0,clearSelection:t,rangeSelect:n,event:e,source:o})}}setupDetailRowAutoHeight(t){if(this.rowType!==Pa.FullWidthDetail)return;if(!this.gridOptionsService.is("detailRowAutoHeight"))return;const e=()=>{const e=t.clientHeight;if(null!=e&&e>0){const t=()=>{this.rowNode.setRowHeight(e),this.beans.clientSideRowModel?this.beans.clientSideRowModel.onRowHeightChanged():this.beans.serverSideRowModel&&this.beans.serverSideRowModel.onRowHeightChanged()};this.beans.frameworkOverrides.setTimeout(t,0)}},i=this.beans.resizeObserverService.observeResize(t,e);this.addDestroyFunc(i),e()}createFullWidthParams(e,t){return{fullWidth:!0,data:this.rowNode.data,node:this.rowNode,value:this.rowNode.key,valueFormatted:this.rowNode.key,rowIndex:this.rowNode.rowIndex,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(e,t,i,n)=>this.addFullWidthRowDragging(e,t,i,n)}}addFullWidthRowDragging(e,t,i="",n){if(!this.isFullWidth())return;const r=new ro(()=>i,this.rowNode,void 0,e,t,n);this.createManagedBean(r,this.beans.context)}onUiLevelChanged(){const e=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=e){const t="ag-row-level-"+e,i="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach(e=>{e.rowComp.addOrRemoveCssClass(t,!0),e.rowComp.addOrRemoveCssClass(i,!1)})}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageLastRow()}onModelUpdated(){this.refreshFirstAndLastRowStyles()}refreshFirstAndLastRowStyles(){const t=this.isFirstRowOnPage(),i=this.isLastRowOnPage();this.firstRowOnPage!==t&&(this.firstRowOnPage=t,this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass("ag-row-first",t))),this.lastRowOnPage!==i&&(this.lastRowOnPage=i,this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass("ag-row-last",i)))}stopEditing(t=!1){if(this.stoppingRowEdit)return;const i=this.getAllCellCtrls(),n=this.editingRow;this.stoppingRowEdit=!0;let r=!1;for(const e of i){const i=e.stopEditing(t);n&&!t&&!r&&i&&(r=!0)}if(r){const t=this.createRowEvent(y.EVENT_ROW_VALUE_CHANGED);this.beans.eventService.dispatchEvent(t)}n&&this.setEditingRow(!1),this.stoppingRowEdit=!1}setInlineEditingCss(t){this.allRowGuis.forEach(e=>{e.rowComp.addOrRemoveCssClass("ag-row-inline-editing",t),e.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!t)})}setEditingRow(t){this.editingRow=t,this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass("ag-row-editing",t));const e=t?this.createRowEvent(y.EVENT_ROW_EDITING_STARTED):this.createRowEvent(y.EVENT_ROW_EDITING_STOPPED);this.beans.eventService.dispatchEvent(e)}startRowEditing(n=null,r=null,s=null){if(this.editingRow)return;this.getAllCellCtrls().reduce((e,t)=>{const i=t===r;return i?t.startEditing(n,i,s):t.startEditing(null,i,s),!!e||t.isEditing()},!1)&&this.setEditingRow(!0)}getAllCellCtrls(){if(0===this.leftCellCtrls.list.length&&0===this.rightCellCtrls.list.length)return this.centerCellCtrls.list;return[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const e=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);e&&e.length&&e.forEach(t=>{this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass(t,!0))})}postProcessRowClassRules(){this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,t=>{this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass(t,!0))},t=>{this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass(t,!1))})}setStylesFromGridOptions(e){const t=this.processStylesFromGridOptions();this.forEachGui(e,e=>e.rowComp.setUserStyles(t))}getPinnedForContainer(e){return e===Qa.LEFT?"left":e===Qa.RIGHT?"right":null}getInitialRowClasses(e){const t=this.getPinnedForContainer(e),i={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[e],rowIsEven:this.rowNode.rowIndex%2==0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned:t};return this.beans.rowCssClassCalculator.getInitialRowClasses(i)}processStylesFromGridOptions(){const e=this.gridOptionsService.get("rowStyle");if(e&&"function"==typeof e)return void console.warn("AG Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead");const t=this.gridOptionsService.getCallback("getRowStyle");let i;if(t){i=t({data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex})}return Object.assign({},e,i)}onRowSelected(e){const i=!!this.rowNode.isSelected();this.forEachGui(e,e=>{e.rowComp.addOrRemoveCssClass("ag-row-selected",i),Yi(e.element,!!i||void 0);const t=this.createAriaLabel();xi(e.element,null==t?"":t)})}createAriaLabel(){const e=this.rowNode.isSelected();if(e&&this.gridOptionsService.is("suppressRowDeselection"))return;return this.beans.localeService.getLocaleTextFunc()(e?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${e?"deselect":"select"} this row.`)}isUseAnimationFrameForCreate(){return this.useAnimationFrameForCreate}addHoverFunctionality(e){this.active&&(this.addManagedListener(e,"mouseenter",()=>this.rowNode.onMouseEnter()),this.addManagedListener(e,"mouseleave",()=>this.rowNode.onMouseLeave()),this.addManagedListener(this.rowNode,R.EVENT_MOUSE_ENTER,()=>{this.beans.dragService.isDragging()||this.gridOptionsService.is("suppressRowHoverHighlight")||(e.classList.add("ag-row-hover"),this.rowNode.setHovered(!0))}),this.addManagedListener(this.rowNode,R.EVENT_MOUSE_LEAVE,()=>{e.classList.remove("ag-row-hover"),this.rowNode.setHovered(!1)}))}roundRowTopToBounds(e){const t=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.applyPaginationOffset(t.top,!0)-100,n=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(i,e),n)}getFrameworkOverrides(){return this.beans.frameworkOverrides}forEachGui(e,t){(e?[e]:this.allRowGuis).forEach(t)}onRowHeightChanged(e){if(null==this.rowNode.rowHeight)return;const t=this.rowNode.rowHeight,i=this.beans.environment.getDefaultRowHeight(),n=this.gridOptionsService.isGetRowHeightFunction()?this.gridOptionsService.getRowHeightForNode(this.rowNode).height:void 0,r=n?Math.min(i,n)-2+"px":void 0;this.forEachGui(e,e=>{e.element.style.height=t+"px",r&&e.element.style.setProperty("--ag-line-height",r)})}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}destroyFirstPass(){this.active=!1,this.gridOptionsService.isAnimateRows()&&this.setupRemoveAnimation(),this.rowNode.setHovered(!1);const e=this.createRowEvent(y.EVENT_VIRTUAL_ROW_REMOVED);this.dispatchEvent(e),this.beans.eventService.dispatchEvent(e),super.destroy()}setupRemoveAnimation(){if(this.isSticky())return;if(null!=this.rowNode.rowTop){const e=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(e)}else this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0))}destroySecondPass(){this.allRowGuis.length=0;const e=e=>(e.list.forEach(e=>e.destroy()),{list:[],map:{}});this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,e=>{e.rowComp.addOrRemoveCssClass("ag-row-focus",this.rowFocused),e.rowComp.addOrRemoveCssClass("ag-row-no-focus",!this.rowFocused)})}onCellFocused(){this.onCellFocusChanged()}onCellFocusCleared(){this.onCellFocusChanged()}onCellFocusChanged(){const e=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);e!==this.rowFocused&&(this.rowFocused=e,this.setFocusedClasses()),!e&&this.editingRow&&this.stopEditing(!1)}onPaginationChanged(){const e=this.beans.paginationProxy.getCurrentPage();this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e,t=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;return e+this.beans.paginationProxy.getPixelOffset()*(t?1:-1)}setRowTop(i){if(!this.printLayout&&_(i)){const e=this.applyPaginationOffset(i),t=(this.rowNode.isRowPinned()||this.rowNode.sticky?e:this.beans.rowContainerHeightService.getRealPixelPosition(e))+"px";this.setRowTopStyle(t)}}getInitialRowTop(e){return this.gridOptionsService.is("suppressRowTransform")?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.gridOptionsService.is("suppressRowTransform")?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(i){if(this.printLayout)return"";let n;if(this.isSticky())n=this.rowNode.stickyRowTop;else{const e=this.slideInAnimation[i]?this.roundRowTopToBounds(this.rowNode.oldRowTop):this.rowNode.rowTop,t=this.applyPaginationOffset(e);n=this.rowNode.isRowPinned()?t:this.beans.rowContainerHeightService.getRealPixelPosition(t)}return n+"px"}setRowTopStyle(t){const i=this.gridOptionsService.is("suppressRowTransform");this.allRowGuis.forEach(e=>i?e.rowComp.setTop(t):e.rowComp.setTransform(`translateY(${t})`))}getRowNode(){return this.rowNode}getCellCtrl(t){let i=null;return this.getAllCellCtrls().forEach(e=>{e.getColumn()==t&&(i=e)}),null!=i||this.getAllCellCtrls().forEach(e=>{e.getColSpanningList().indexOf(t)>=0&&(i=e)}),i}onRowIndexChanged(){null!=this.rowNode.rowIndex&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(e){const t=this.rowNode.getRowIndexString(),i=this.beans.headerNavigationService.getHeaderRowCount(),n=this.rowNode.rowIndex%2==0,r=i+this.rowNode.rowIndex+1;this.forEachGui(e,e=>{e.rowComp.setRowIndex(t),e.rowComp.addOrRemoveCssClass("ag-row-even",n),e.rowComp.addOrRemoveCssClass("ag-row-odd",!n),Bi(e.element,r)})}getPinnedLeftRowElement(){return this.leftGui?this.leftGui.element:void 0}getPinnedRightRowElement(){return this.rightGui?this.rightGui.element:void 0}getBodyRowElement(){return this.centerGui?this.centerGui.element:void 0}getFullWidthRowElement(){return this.fullWidthGui?this.fullWidthGui.element:void 0}}La.DOM_DATA_KEY_ROW_CTRL="renderedRow";var Fa=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Ga extends f{constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.mockContextMenuForIPad()}addKeyboardListeners(){const e=this.processKeyboardEvent.bind(this,"keydown");this.addManagedListener(this.element,"keydown",e)}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",Ct("touchstart")?"touchstart":"mousedown"].forEach(e=>{const t=this.processMouseEvent.bind(this,e);this.addManagedListener(this.element,e,t)})}processMouseEvent(e,t){if(!this.mouseEventService.isEventFromThisGrid(t)||bt(t))return;const i=this.getRowForEvent(t),n=this.mouseEventService.getRenderedCellForEvent(t);"contextmenu"===e?this.handleContextMenuMouseEvent(t,null,i,n):(n&&n.onMouseEvent(e,t),i&&i.onMouseEvent(e,t))}mockContextMenuForIPad(){if(!nn())return;const e=new D(this.element);this.addManagedListener(e,D.EVENT_LONG_TAP,e=>{const t=this.getRowForEvent(e.touchEvent),i=this.mouseEventService.getRenderedCellForEvent(e.touchEvent);this.handleContextMenuMouseEvent(null,e.touchEvent,t,i)}),this.addDestroyFunc(()=>e.destroy())}getRowForEvent(e){let t=e.target;for(;t;){const e=this.gridOptionsService.getDomData(t,La.DOM_DATA_KEY_ROW_CTRL);if(e)return e;t=t.parentElement}return null}handleContextMenuMouseEvent(e,t,i,n){const r=i?i.getRowNode():null,s=n?n.getColumn():null;let o=null;if(s){const i=e||t;n.dispatchCellContextMenuEvent(i),o=this.valueService.getValue(s,r)}const a=this.ctrlsService.getGridBodyCtrl(),l=n?n.getGui():a.getGridBodyElement();this.contextMenuFactory&&this.contextMenuFactory.onContextMenu(e,t,r,s,o,l)}getControlsForEventTarget(e){return{cellCtrl:wt(this.gridOptionsService,e,Ia.DOM_DATA_KEY_CELL_CTRL),rowCtrl:wt(this.gridOptionsService,e,La.DOM_DATA_KEY_ROW_CTRL)}}processKeyboardEvent(e,t){const{cellCtrl:i,rowCtrl:n}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(i?this.processCellKeyboardEvent(i,e,t):n&&n.isFullWidth()&&this.processFullWidthRowKeyboardEvent(n,e,t))}processCellKeyboardEvent(e,t,i){const n=e.getRowNode(),r=e.getColumn(),s=e.isEditing();if(!yr(this.gridOptionsService,i,n,r,s)&&"keydown"===t){!s&&this.navigationService.handlePageScrollingKey(i)||e.onKeyDown(i),this.doGridOperations(i,e.isEditing()),vr(i)&&e.processCharacter(i)}if("keydown"===t){const t=e.createEvent(i,y.EVENT_CELL_KEY_DOWN);this.eventService.dispatchEvent(t)}}processFullWidthRowKeyboardEvent(e,t,i){const n=e.getRowNode(),r=this.focusService.getFocusedCell(),s=r&&r.column;if(!yr(this.gridOptionsService,i,n,s,!1)){const n=i.key;if("keydown"===t)switch(n){case A.PAGE_HOME:case A.PAGE_END:case A.PAGE_UP:case A.PAGE_DOWN:this.navigationService.handlePageScrollingKey(i,!0);break;case A.UP:case A.DOWN:e.onKeyboardNavigate(i);break;case A.TAB:e.onTabKeyDown(i)}}if("keydown"===t){const t=e.createRowEvent(y.EVENT_CELL_KEY_DOWN,i);this.eventService.dispatchEvent(t)}}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey)return;if(t)return;if(!this.mouseEventService.isEventFromThisGrid(e))return;const i=Cr(e);return i===A.A?this.onCtrlAndA(e):i===A.C?this.onCtrlAndC(e):i===A.D?this.onCtrlAndD(e):i===A.V?this.onCtrlAndV(e):i===A.X?this.onCtrlAndX(e):i===A.Y?this.onCtrlAndY():i===A.Z?this.onCtrlAndZ(e):void 0}onCtrlAndA(r){const{pinnedRowModel:s,paginationProxy:o,rangeService:a}=this;if(a&&o.isRowsToRender()){const[r,o]=[s.isEmpty("top"),s.isEmpty("bottom")],e=r?null:"top";let t,i;o?(t=null,i=this.paginationProxy.getRowCount()-1):(t="bottom",i=s.getPinnedBottomRowData().length-1);const n=this.columnModel.getAllDisplayedColumns();if(ee(n))return;a.setCellRange({rowStartIndex:0,rowStartPinned:e,rowEndIndex:i,rowEndPinned:t,columnStart:n[0],columnEnd:p(n)})}r.preventDefault()}onCtrlAndC(e){if(!this.clipboardService||this.gridOptionsService.is("enableCellTextSelection"))return;const{cellCtrl:t,rowCtrl:i}=this.getControlsForEventTarget(e.target);(null==t?void 0:t.isEditing())||(null==i?void 0:i.isEditing())||(e.preventDefault(),this.clipboardService.copyToClipboard())}onCtrlAndX(e){if(!this.clipboardService||this.gridOptionsService.is("enableCellTextSelection")||this.gridOptionsService.is("suppressCutToClipboard"))return;const{cellCtrl:t,rowCtrl:i}=this.getControlsForEventTarget(e.target);(null==t?void 0:t.isEditing())||(null==i?void 0:i.isEditing())||(e.preventDefault(),this.clipboardService.cutToClipboard(void 0,"ui"))}onCtrlAndV(e){const{cellCtrl:t,rowCtrl:i}=this.getControlsForEventTarget(e.target);(null==t?void 0:t.isEditing())||(null==i?void 0:i.isEditing())||this.clipboardService&&!this.gridOptionsService.is("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()}onCtrlAndD(e){this.clipboardService&&!this.gridOptionsService.is("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),e.preventDefault()}onCtrlAndZ(e){this.gridOptionsService.is("undoRedoCellEditing")&&(e.preventDefault(),e.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))}onCtrlAndY(){this.undoRedoService.redo("ui")}}Fa([o("mouseEventService")],Ga.prototype,"mouseEventService",void 0),Fa([o("valueService")],Ga.prototype,"valueService",void 0),Fa([c("contextMenuFactory")],Ga.prototype,"contextMenuFactory",void 0),Fa([o("ctrlsService")],Ga.prototype,"ctrlsService",void 0),Fa([o("navigationService")],Ga.prototype,"navigationService",void 0),Fa([o("focusService")],Ga.prototype,"focusService",void 0),Fa([o("undoRedoService")],Ga.prototype,"undoRedoService",void 0),Fa([o("columnModel")],Ga.prototype,"columnModel",void 0),Fa([o("paginationProxy")],Ga.prototype,"paginationProxy",void 0),Fa([o("pinnedRowModel")],Ga.prototype,"pinnedRowModel",void 0),Fa([c("rangeService")],Ga.prototype,"rangeService",void 0),Fa([c("clipboardService")],Ga.prototype,"clipboardService",void 0),Fa([r],Ga.prototype,"postConstruct",null);var $a=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Ha extends f{constructor(e){super(),this.centerContainerCtrl=e}postConstruct(){this.ctrlsService.whenReady(()=>{this.gridBodyCtrl=this.ctrlsService.getGridBodyCtrl(),this.listenForResize()}),this.addManagedListener(this.eventService,y.EVENT_SCROLLBAR_WIDTH_CHANGED,this.onScrollbarWidthChanged.bind(this))}listenForResize(){const e=()=>this.onCenterViewportResized();this.centerContainerCtrl.registerViewportResizeListener(e),this.gridBodyCtrl.registerBodyViewportResizeListener(e)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.centerContainerCtrl.isViewportVisible()){this.checkViewportAndScrolls();const e=this.centerContainerCtrl.getCenterWidth();e!==this.centerWidth&&(this.centerWidth=e,this.columnModel.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const t=Pn(this.gridBodyCtrl.getBodyViewportElement());if(this.bodyHeight!==t){this.bodyHeight=t;const e={type:y.EVENT_BODY_HEIGHT_CHANGED};this.eventService.dispatchEvent(e)}}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){const e={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(e)}isHorizontalScrollShowing(){return this.centerContainerCtrl.isHorizontalScrollShowing()}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.columnModel.setViewportPosition(e,t)}}$a([o("ctrlsService")],Ha.prototype,"ctrlsService",void 0),$a([o("columnModel")],Ha.prototype,"columnModel",void 0),$a([o("scrollVisibleService")],Ha.prototype,"scrollVisibleService",void 0),$a([r],Ha.prototype,"postConstruct",null);var Ba=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Va extends f{constructor(e){super(),this.element=e}postConstruct(){this.addManagedListener(this.eventService,y.EVENT_LEFT_PINNED_WIDTH_CHANGED,this.onPinnedLeftWidthChanged.bind(this))}onPinnedLeftWidthChanged(){const e=this.pinnedWidthService.getPinnedLeftWidth(),t=e>0;w(this.element,t),sr(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedLeftWidth()}}Ba([o("pinnedWidthService")],Va.prototype,"pinnedWidthService",void 0),Ba([r],Va.prototype,"postConstruct",null);var Wa=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class za extends f{constructor(e){super(),this.element=e}postConstruct(){this.addManagedListener(this.eventService,y.EVENT_RIGHT_PINNED_WIDTH_CHANGED,this.onPinnedRightWidthChanged.bind(this))}onPinnedRightWidthChanged(){const e=this.pinnedWidthService.getPinnedRightWidth(),t=e>0;w(this.element,t),sr(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedRightWidth()}}Wa([o("pinnedWidthService")],za.prototype,"pinnedWidthService",void 0),Wa([r],za.prototype,"postConstruct",null);var ja=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Ua extends f{constructor(e,t){super(),this.eContainer=e,this.eWrapper=t}postConstruct(){this.addManagedListener(this.eventService,y.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onHeightChanged.bind(this))}onHeightChanged(){const e=this.maxDivHeightScaler.getUiContainerHeight(),t=null!=e?e+"px":"";this.eContainer.style.height=t,this.eWrapper&&(this.eWrapper.style.height=t)}}ja([o("rowContainerHeightService")],Ua.prototype,"maxDivHeightScaler",void 0),ja([r],Ua.prototype,"postConstruct",null);var Ya=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class qa extends f{constructor(e){super(),this.eContainer=e}postConstruct(){if(!this.gridOptionsService.isEnableRangeSelection()||u(this.rangeService))return;const e={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)};this.dragService.addDragSource(e),this.addDestroyFunc(()=>this.dragService.removeDragSource(e))}}Ya([c("rangeService")],qa.prototype,"rangeService",void 0),Ya([o("dragService")],qa.prototype,"dragService",void 0),Ya([r],qa.prototype,"postConstruct",null);var Ka=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Xa extends f{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_LEFT_PINNED_WIDTH_CHANGED,e),this.addSpacer&&(this.addManagedListener(this.eventService,y.EVENT_RIGHT_PINNED_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_SCROLL_VISIBILITY_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_SCROLLBAR_WIDTH_CHANGED,e)),this.setWidth()}setWidth(){const{columnModel:e}=this,t=this.gridOptionsService.isDomLayout("print"),i=e.getBodyContainerWidth(),n=e.getDisplayedColumnsLeftWidth(),r=e.getDisplayedColumnsRightWidth();let s;if(t)s=i+n+r;else if(s=i,this.addSpacer){0===(this.gridOptionsService.is("enableRtl")?n:r)&&this.scrollVisibleService.isVerticalScrollShowing()&&(s+=this.gridOptionsService.getScrollbarWidth())}this.callback(s)}}Ka([o("columnModel")],Xa.prototype,"columnModel",void 0),Ka([o("scrollVisibleService")],Xa.prototype,"scrollVisibleService",void 0),Ka([r],Xa.prototype,"postConstruct",null);var k,Qa,Za=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};function Ja(e){switch(e){case k.CENTER:case k.TOP_CENTER:case k.STICKY_TOP_CENTER:case k.BOTTOM_CENTER:return Qa.CENTER;case k.LEFT:case k.TOP_LEFT:case k.STICKY_TOP_LEFT:case k.BOTTOM_LEFT:return Qa.LEFT;case k.RIGHT:case k.TOP_RIGHT:case k.STICKY_TOP_RIGHT:case k.BOTTOM_RIGHT:return Qa.RIGHT;case k.FULL_WIDTH:case k.TOP_FULL_WIDTH:case k.STICKY_TOP_FULL_WIDTH:case k.BOTTOM_FULL_WIDTH:return Qa.FULL_WIDTH;default:throw Error("Invalid Row Container Type")}}!function(e){e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.FULL_WIDTH="fullWidth",e.TOP_LEFT="topLeft",e.TOP_RIGHT="topRight",e.TOP_CENTER="topCenter",e.TOP_FULL_WIDTH="topFullWidth",e.STICKY_TOP_LEFT="stickyTopLeft",e.STICKY_TOP_RIGHT="stickyTopRight",e.STICKY_TOP_CENTER="stickyTopCenter",e.STICKY_TOP_FULL_WIDTH="stickyTopFullWidth",e.BOTTOM_LEFT="bottomLeft",e.BOTTOM_RIGHT="bottomRight",e.BOTTOM_CENTER="bottomCenter",e.BOTTOM_FULL_WIDTH="bottomFullWidth"}(k||(k={})),function(e){e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.FULL_WIDTH="fullWidth"}(Qa||(Qa={}));const el=Vt([[k.CENTER,"ag-center-cols-container"],[k.LEFT,"ag-pinned-left-cols-container"],[k.RIGHT,"ag-pinned-right-cols-container"],[k.FULL_WIDTH,"ag-full-width-container"],[k.TOP_CENTER,"ag-floating-top-container"],[k.TOP_LEFT,"ag-pinned-left-floating-top"],[k.TOP_RIGHT,"ag-pinned-right-floating-top"],[k.TOP_FULL_WIDTH,"ag-floating-top-full-width-container"],[k.STICKY_TOP_CENTER,"ag-sticky-top-container"],[k.STICKY_TOP_LEFT,"ag-pinned-left-sticky-top"],[k.STICKY_TOP_RIGHT,"ag-pinned-right-sticky-top"],[k.STICKY_TOP_FULL_WIDTH,"ag-sticky-top-full-width-container"],[k.BOTTOM_CENTER,"ag-floating-bottom-container"],[k.BOTTOM_LEFT,"ag-pinned-left-floating-bottom"],[k.BOTTOM_RIGHT,"ag-pinned-right-floating-bottom"],[k.BOTTOM_FULL_WIDTH,"ag-floating-bottom-full-width-container"]]),tl=Vt([[k.CENTER,"ag-center-cols-viewport"],[k.TOP_CENTER,"ag-floating-top-viewport"],[k.STICKY_TOP_CENTER,"ag-sticky-top-viewport"],[k.BOTTOM_CENTER,"ag-floating-bottom-viewport"]]),il=Vt([[k.CENTER,"ag-center-cols-clipper"]]);class nl extends f{constructor(e){super(),this.visible=!0,this.EMPTY_CTRLS=[],this.name=e,this.isFullWithContainer=this.name===k.TOP_FULL_WIDTH||this.name===k.STICKY_TOP_FULL_WIDTH||this.name===k.BOTTOM_FULL_WIDTH||this.name===k.FULL_WIDTH}static getRowContainerCssClasses(e){return{container:el.get(e),viewport:tl.get(e),wrapper:il.get(e)}}static getPinned(e){switch(e){case k.BOTTOM_LEFT:case k.TOP_LEFT:case k.STICKY_TOP_LEFT:case k.LEFT:return"left";case k.BOTTOM_RIGHT:case k.TOP_RIGHT:case k.STICKY_TOP_RIGHT:case k.RIGHT:return"right";default:return null}}postConstruct(){this.enableRtl=this.gridOptionsService.is("enableRtl"),this.embedFullWidthRows=this.gridOptionsService.is("embedFullWidthRows"),this.forContainers([k.CENTER],()=>this.viewportSizeFeature=this.createManagedBean(new Ha(this)))}registerWithCtrlsService(){switch(this.name){case k.CENTER:this.ctrlsService.registerCenterRowContainerCtrl(this);break;case k.LEFT:this.ctrlsService.registerLeftRowContainerCtrl(this);break;case k.RIGHT:this.ctrlsService.registerRightRowContainerCtrl(this);break;case k.TOP_CENTER:this.ctrlsService.registerTopCenterRowContainerCtrl(this);break;case k.TOP_LEFT:this.ctrlsService.registerTopLeftRowContainerCon(this);break;case k.TOP_RIGHT:this.ctrlsService.registerTopRightRowContainerCtrl(this);break;case k.STICKY_TOP_CENTER:this.ctrlsService.registerStickyTopCenterRowContainerCtrl(this);break;case k.STICKY_TOP_LEFT:this.ctrlsService.registerStickyTopLeftRowContainerCon(this);break;case k.STICKY_TOP_RIGHT:this.ctrlsService.registerStickyTopRightRowContainerCtrl(this);break;case k.BOTTOM_CENTER:this.ctrlsService.registerBottomCenterRowContainerCtrl(this);break;case k.BOTTOM_LEFT:this.ctrlsService.registerBottomLeftRowContainerCtrl(this);break;case k.BOTTOM_RIGHT:this.ctrlsService.registerBottomRightRowContainerCtrl(this)}}forContainers(e,t){e.indexOf(this.name)>=0&&t()}getContainerElement(){return this.eContainer}getViewportSizeFeature(){return this.viewportSizeFeature}setComp(e,t,i,n){this.comp=e,this.eContainer=t,this.eViewport=i,this.eWrapper=n,this.createManagedBean(new Ga(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder(),this.stopHScrollOnPinnedRows();const r=[k.TOP_CENTER,k.TOP_LEFT,k.TOP_RIGHT],s=[k.STICKY_TOP_CENTER,k.STICKY_TOP_LEFT,k.STICKY_TOP_RIGHT],o=[...r,...[k.BOTTOM_CENTER,k.BOTTOM_LEFT,k.BOTTOM_RIGHT],...[k.CENTER,k.LEFT,k.RIGHT],...s],a=[k.CENTER,k.LEFT,k.RIGHT,k.FULL_WIDTH],l=[k.CENTER,k.TOP_CENTER,k.STICKY_TOP_CENTER,k.BOTTOM_CENTER],c=[k.LEFT,k.BOTTOM_LEFT,k.TOP_LEFT,k.STICKY_TOP_LEFT],u=[k.RIGHT,k.BOTTOM_RIGHT,k.TOP_RIGHT,k.STICKY_TOP_RIGHT];this.forContainers(c,()=>{this.pinnedWidthFeature=this.createManagedBean(new Va(this.eContainer)),this.addManagedListener(this.eventService,y.EVENT_LEFT_PINNED_WIDTH_CHANGED,()=>this.onPinnedWidthChanged())}),this.forContainers(u,()=>{this.pinnedWidthFeature=this.createManagedBean(new za(this.eContainer)),this.addManagedListener(this.eventService,y.EVENT_RIGHT_PINNED_WIDTH_CHANGED,()=>this.onPinnedWidthChanged())}),this.forContainers(a,()=>this.createManagedBean(new Ua(this.eContainer,this.eWrapper))),this.forContainers(o,()=>this.createManagedBean(new qa(this.eContainer))),this.forContainers(l,()=>this.createManagedBean(new Xa(e=>this.comp.setContainerWidth(e+"px")))),dn()&&(this.forContainers([k.CENTER],()=>{const e=this.enableRtl?y.EVENT_LEFT_PINNED_WIDTH_CHANGED:y.EVENT_RIGHT_PINNED_WIDTH_CHANGED;this.addManagedListener(this.eventService,e,()=>this.refreshPaddingForFakeScrollbar())}),this.refreshPaddingForFakeScrollbar()),this.addListeners(),this.registerWithCtrlsService()}refreshPaddingForFakeScrollbar(){const{enableRtl:i,columnModel:n,name:r,eWrapper:s,eContainer:o}=this,a=i?k.LEFT:k.RIGHT;this.forContainers([k.CENTER,a],()=>{const e=n.getContainerWidth(a),t=i?"marginLeft":"marginRight";r===k.CENTER?s.style[t]=e?"0px":"16px":o.style[t]=e?"16px":"0px"})}addListeners(){this.addManagedListener(this.eventService,y.EVENT_SCROLL_VISIBILITY_CHANGED,()=>this.onScrollVisibilityChanged()),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,()=>this.onDisplayedColumnsChanged()),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,()=>this.onDisplayedColumnsWidthChanged()),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_ROWS_CHANGED,e=>this.onDisplayedRowsChanged(e.afterScroll)),this.onScrollVisibilityChanged(),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()}listenOnDomOrder(){if([k.STICKY_TOP_CENTER,k.STICKY_TOP_LEFT,k.STICKY_TOP_RIGHT,k.STICKY_TOP_FULL_WIDTH].indexOf(this.name)>=0)return void this.comp.setDomOrder(!0);const e=()=>{const e=this.gridOptionsService.is("ensureDomOrder"),t=this.gridOptionsService.isDomLayout("print");this.comp.setDomOrder(e||t)};this.addManagedPropertyListener("domLayout",e),e()}stopHScrollOnPinnedRows(){this.forContainers([k.TOP_CENTER,k.STICKY_TOP_CENTER,k.BOTTOM_CENTER],()=>{this.addManagedListener(this.eViewport,"scroll",()=>this.eViewport.scrollLeft=0)})}onDisplayedColumnsChanged(){this.forContainers([k.CENTER],()=>this.onHorizontalViewportChanged())}onDisplayedColumnsWidthChanged(){this.forContainers([k.CENTER],()=>this.onHorizontalViewportChanged())}onScrollVisibilityChanged(){const i=this.gridOptionsService.getScrollbarWidth()||0;if(this.name===k.CENTER){const e=this.scrollVisibleService.isHorizontalScrollShowing()?i:0,t=0==e?"100%":`calc(100% + ${e}px)`;this.animationFrameService.requestAnimationFrame(()=>this.comp.setViewportHeight(t))}if(this.name===k.FULL_WIDTH){const i=`calc(100% - ${dn()?16:0}px)`;this.eContainer.style.setProperty("width",i)}}addPreventScrollWhileDragging(){const e=e=>{this.dragService.isDragging()&&e.cancelable&&e.preventDefault()};this.eContainer.addEventListener("touchmove",e,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",e))}onHorizontalViewportChanged(){const e=this.getCenterWidth(),t=this.getCenterViewportScrollLeft();this.columnModel.setViewportPosition(e,t)}getCenterWidth(){return kn(this.eViewport)}getCenterViewportScrollLeft(){return Hn(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const t=this.resizeObserverService.observeResize(this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportVisible(){return jn(this.eViewport)}getViewportScrollLeft(){return Hn(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gridOptionsService.is("alwaysShowHorizontalScroll")||ir(this.eViewport)}getViewportElement(){return this.eViewport}setContainerTranslateX(e){this.eContainer.style.transform=`translateX(${e}px)`}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){Bn(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!nl.getPinned(this.name)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged()),dn()&&this.refreshPaddingForFakeScrollbar()}onDisplayedRowsChanged(i=!1){if(this.visible){const n=this.gridOptionsService.isDomLayout("print"),e=e=>{const t=e.isFullWidth(),i=this.embedFullWidthRows||n;return this.isFullWithContainer?!i&&t:i||!t},t=this.getRowCtrls().filter(e);this.comp.setRowCtrls(t,i)}else this.comp.setRowCtrls(this.EMPTY_CTRLS,!1)}getRowCtrls(){switch(this.name){case k.TOP_CENTER:case k.TOP_LEFT:case k.TOP_RIGHT:case k.TOP_FULL_WIDTH:return this.rowRenderer.getTopRowCtrls();case k.STICKY_TOP_CENTER:case k.STICKY_TOP_LEFT:case k.STICKY_TOP_RIGHT:case k.STICKY_TOP_FULL_WIDTH:return this.rowRenderer.getStickyTopRowCtrls();case k.BOTTOM_CENTER:case k.BOTTOM_LEFT:case k.BOTTOM_RIGHT:case k.BOTTOM_FULL_WIDTH:return this.rowRenderer.getBottomRowCtrls();default:return this.rowRenderer.getRowCtrls()}}}Za([o("scrollVisibleService")],nl.prototype,"scrollVisibleService",void 0),Za([o("dragService")],nl.prototype,"dragService",void 0),Za([o("ctrlsService")],nl.prototype,"ctrlsService",void 0),Za([o("columnModel")],nl.prototype,"columnModel",void 0),Za([o("resizeObserverService")],nl.prototype,"resizeObserverService",void 0),Za([o("animationFrameService")],nl.prototype,"animationFrameService",void 0),Za([o("rowRenderer")],nl.prototype,"rowRenderer",void 0),Za([r],nl.prototype,"postConstruct",null);var rl=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};const sl=`<div class="ag-root ag-unselectable" role="treegrid">\n        <ag-header-root ref="gridHeader"></ag-header-root>\n        <div class="ag-floating-top" ref="eTop" role="presentation">\n            <ag-row-container ref="topLeftContainer" name="${k.TOP_LEFT}"></ag-row-container>\n            <ag-row-container ref="topCenterContainer" name="${k.TOP_CENTER}"></ag-row-container>\n            <ag-row-container ref="topRightContainer" name="${k.TOP_RIGHT}"></ag-row-container>\n            <ag-row-container ref="topFullWidthContainer" name="${k.TOP_FULL_WIDTH}"></ag-row-container>\n        </div>\n        <div class="ag-body" ref="eBody" role="presentation">\n            <div class="ag-body-clipper" ref="eBodyClipper" role="presentation">\n                <div class="ag-body-viewport" ref="eBodyViewport" role="presentation">\n                    <ag-row-container ref="leftContainer" name="${k.LEFT}"></ag-row-container>\n                    <ag-row-container ref="centerContainer" name="${k.CENTER}"></ag-row-container>\n                    <ag-row-container ref="rightContainer" name="${k.RIGHT}"></ag-row-container>\n                    <ag-row-container ref="fullWidthContainer" name="${k.FULL_WIDTH}"></ag-row-container>\n                </div>\n            </div>\n            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>\n        </div>\n        <div class="ag-sticky-top" ref="eStickyTop" role="presentation">\n            <ag-row-container ref="stickyTopLeftContainer" name="${k.STICKY_TOP_LEFT}"></ag-row-container>\n            <ag-row-container ref="stickyTopCenterContainer" name="${k.STICKY_TOP_CENTER}"></ag-row-container>\n            <ag-row-container ref="stickyTopRightContainer" name="${k.STICKY_TOP_RIGHT}"></ag-row-container>\n            <ag-row-container ref="stickyTopFullWidthContainer" name="${k.STICKY_TOP_FULL_WIDTH}"></ag-row-container>\n        </div>\n        <div class="ag-floating-bottom" ref="eBottom" role="presentation">\n            <ag-row-container ref="bottomLeftContainer" name="${k.BOTTOM_LEFT}"></ag-row-container>\n            <ag-row-container ref="bottomCenterContainer" name="${k.BOTTOM_CENTER}"></ag-row-container>\n            <ag-row-container ref="bottomRightContainer" name="${k.BOTTOM_RIGHT}"></ag-row-container>\n            <ag-row-container ref="bottomFullWidthContainer" name="${k.BOTTOM_FULL_WIDTH}"></ag-row-container>\n        </div>\n        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>\n        <ag-overlay-wrapper></ag-overlay-wrapper>\n    </div>`;class ol extends E{constructor(){super(sl)}init(){const t=(e,t)=>{const i=e+"px";t.style.minHeight=i,t.style.height=i},e={setRowAnimationCssOnBodyViewport:(e,t)=>this.setRowAnimationCssOnBodyViewport(e,t),setColumnCount:e=>Vi(this.getGui(),e),setRowCount:e=>Hi(this.getGui(),e),setTopHeight:e=>t(e,this.eTop),setBottomHeight:e=>t(e,this.eBottom),setTopDisplay:e=>this.eTop.style.display=e,setBottomDisplay:e=>this.eBottom.style.display=e,setStickyTopHeight:e=>this.eStickyTop.style.height=e,setStickyTopTop:e=>this.eStickyTop.style.top=e,setStickyTopWidth:e=>this.eStickyTop.style.width=e,setColumnMovingCss:(e,t)=>this.addOrRemoveCssClass(e,t),updateLayoutClasses:(e,t)=>{[this.eBodyViewport.classList,this.eBodyClipper.classList,this.eBody.classList].forEach(e=>{e.toggle(ca.AUTO_HEIGHT,t.autoHeight),e.toggle(ca.NORMAL,t.normal),e.toggle(ca.PRINT,t.print)}),this.addOrRemoveCssClass(ca.AUTO_HEIGHT,t.autoHeight),this.addOrRemoveCssClass(ca.NORMAL,t.normal),this.addOrRemoveCssClass(ca.PRINT,t.print)},setAlwaysVerticalScrollClass:(e,t)=>this.eBodyViewport.classList.toggle("ag-force-vertical-scroll",t),registerBodyViewportResizeListener:e=>{const t=this.resizeObserverService.observeResize(this.eBodyViewport,e);this.addDestroyFunc(()=>t())},setPinnedTopBottomOverflowY:e=>this.eTop.style.overflowY=this.eBottom.style.overflowY=e,setCellSelectableCss:(t,i)=>{[this.eTop,this.eBodyViewport,this.eBottom].forEach(e=>e.classList.toggle(t,i))},setBodyViewportWidth:e=>this.eBodyViewport.style.width=e};this.ctrl=this.createManagedBean(new wa),this.ctrl.setComp(e,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop),(this.rangeService||"multiple"===this.gridOptionsService.get("rowSelection"))&&$i(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(e,t){const i=this.eBodyViewport.classList;i.toggle(ba.ANIMATION_ON,t),i.toggle(ba.ANIMATION_OFF,!t)}getFloatingTopBottom(){return[this.eTop,this.eBottom]}}rl([o("resizeObserverService")],ol.prototype,"resizeObserverService",void 0),rl([c("rangeService")],ol.prototype,"rangeService",void 0),rl([S("eBodyViewport")],ol.prototype,"eBodyViewport",void 0),rl([S("eStickyTop")],ol.prototype,"eStickyTop",void 0),rl([S("eTop")],ol.prototype,"eTop",void 0),rl([S("eBottom")],ol.prototype,"eBottom",void 0),rl([S("gridHeader")],ol.prototype,"headerRootComp",void 0),rl([S("eBodyClipper")],ol.prototype,"eBodyClipper",void 0),rl([S("eBody")],ol.prototype,"eBody",void 0),rl([r],ol.prototype,"init",null);var al=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let ll=class extends f{postConstruct(){this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this))}onDisplayedColumnsChanged(){this.update()}onDisplayedColumnsWidthChanged(){this.update()}update(){this.updateImpl(),setTimeout(this.updateImpl.bind(this),500)}updateImpl(){const e=this.ctrlsService.getCenterRowContainerCtrl();if(!e)return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(t)}setScrollsVisible(t){if(this.horizontalScrollShowing!==t.horizontalScrollShowing||this.verticalScrollShowing!==t.verticalScrollShowing){this.horizontalScrollShowing=t.horizontalScrollShowing,this.verticalScrollShowing=t.verticalScrollShowing;const e={type:y.EVENT_SCROLL_VISIBILITY_CHANGED};this.eventService.dispatchEvent(e)}}isHorizontalScrollShowing(){return this.horizontalScrollShowing}isVerticalScrollShowing(){return this.verticalScrollShowing}};al([o("ctrlsService")],ll.prototype,"ctrlsService",void 0),al([r],ll.prototype,"postConstruct",null),ll=al([s("scrollVisibleService")],ll);var cl,ul=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let dl=cl=class extends f{constructor(){super(...arguments),this.gridInstanceId=cl.gridInstanceSequence.next()}stampTopLevelGridCompWithGridInstance(e){e[cl.GRID_DOM_KEY]=this.gridInstanceId}getRenderedCellForEvent(e){return wt(this.gridOptionsService,e.target,Ia.DOM_DATA_KEY_CELL_CTRL)}isEventFromThisGrid(e){return this.isElementInThisGrid(e.target)}isElementInThisGrid(e){let t=e;for(;t;){const e=t[cl.GRID_DOM_KEY];if(_(e)){return e===this.gridInstanceId}t=t.parentElement}return!1}getCellPositionForEvent(e){const t=this.getRenderedCellForEvent(e);return t?t.getCellPosition():null}getNormalisedPosition(e){const t=this.gridOptionsService.isDomLayout("normal"),i=e;let n,r;if(null!=i.clientX||null!=i.clientY?(n=i.clientX,r=i.clientY):(n=i.x,r=i.y),t){const e=this.ctrlsService.getGridBodyCtrl(),t=e.getScrollFeature().getVScrollPosition();n+=e.getScrollFeature().getHScrollPosition().left,r+=t.top}return{x:n,y:r}}};dl.gridInstanceSequence=new xr,dl.GRID_DOM_KEY="__ag_grid_instance",ul([o("ctrlsService")],dl.prototype,"ctrlsService",void 0),dl=cl=ul([s("mouseEventService")],dl);var hl=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let pl=class extends f{constructor(){super(),this.onPageDown=ke(this.onPageDown,100),this.onPageUp=ke(this.onPageUp,100)}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){const i=e.key,n=e.altKey,r=e.ctrlKey||e.metaKey,s=!!this.rangeService&&e.shiftKey,o=this.mouseEventService.getCellPositionForEvent(e);let a=!1;switch(i){case A.PAGE_HOME:case A.PAGE_END:r||n||(this.onHomeOrEndKey(i),a=!0);break;case A.LEFT:case A.RIGHT:case A.UP:case A.DOWN:if(!o)return!1;!r||n||s||(this.onCtrlUpDownLeftRight(i,o),a=!0);break;case A.PAGE_DOWN:case A.PAGE_UP:r||n||(a=this.handlePageUpDown(i,o,t))}return a&&e.preventDefault(),a}handlePageUpDown(e,t,i){return i&&(t=this.focusService.getFocusedCell()),!!t&&(e===A.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0)}navigateTo(e){const{scrollIndex:t,scrollType:i,scrollColumn:n,focusIndex:r,focusColumn:s}=e;if(_(n)&&!n.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(n),_(t)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(t,i),e.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(r),this.focusService.setFocusedCell({rowIndex:r,column:s,rowPinned:null,forceBrowserFocus:!0}),this.rangeService){const e={rowIndex:r,rowPinned:null,column:s};this.rangeService.setRangeToCell(e)}}onPageDown(e){const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.getViewportHeight(),n=this.paginationProxy.getPixelOffset(),r=t.top+i,s=this.paginationProxy.getRowIndexAtPixel(r+n);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,s):this.navigateToNextPage(e,s)}onPageUp(e){const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.paginationProxy.getPixelOffset(),n=t.top,r=this.paginationProxy.getRowIndexAtPixel(n+i);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,r,!0):this.navigateToNextPage(e,r,!0)}navigateToNextPage(e,t,i=!1){const n=this.getViewportHeight(),r=this.paginationProxy.getPageFirstRow(),s=this.paginationProxy.getPageLastRow(),o=this.paginationProxy.getPixelOffset(),a=this.paginationProxy.getRow(e.rowIndex),l=i?(null==a?void 0:a.rowHeight)-n-o:n-o,c=(null==a?void 0:a.rowTop)+l;let u,d=this.paginationProxy.getRowIndexAtPixel(c+o);if(d===e.rowIndex){const n=i?-1:1;t=d=e.rowIndex+n}i?(u="bottom",d<r&&(d=r),t<r&&(t=r)):(u="top",d>s&&(d=s),t>s&&(t=s)),this.isRowTallerThanView(d)&&(t=d,u="top"),this.navigateTo({scrollIndex:t,scrollType:u,scrollColumn:null,focusIndex:d,focusColumn:e.column})}navigateToNextPageWithAutoHeight(t,i,n=!1){this.navigateTo({scrollIndex:i,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:i,focusColumn:t.column}),setTimeout(()=>{const e=this.getNextFocusIndexForAutoHeight(t,n);this.navigateTo({scrollIndex:i,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:e,focusColumn:t.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){var i;const n=t?-1:1,r=this.getViewportHeight(),s=this.paginationProxy.getPageLastRow();let o=0,a=e.rowIndex;for(;a>=0&&a<=s;){const e=this.paginationProxy.getRow(a);if(e){const t=null!==(i=e.rowHeight)&&void 0!==i?i:0;if(o+t>r)break;o+=t}a+=n}return Math.max(0,Math.min(a,s))}getViewportHeight(){const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),t=this.gridOptionsService.getScrollbarWidth();let i=e.bottom-e.top;return this.ctrlsService.getCenterRowContainerCtrl().isHorizontalScrollShowing()&&(i-=t),i}isRowTallerThanView(e){const t=this.paginationProxy.getRow(e);if(!t)return!1;const i=t.rowHeight;return"number"==typeof i&&i>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const i=this.cellNavigationService.getNextCellToFocus(e,t,!0),{rowIndex:n,column:r}=i;this.navigateTo({scrollIndex:n,scrollType:null,scrollColumn:r,focusIndex:n,focusColumn:r})}onHomeOrEndKey(e){const t=e===A.PAGE_HOME,i=this.columnModel.getAllDisplayedColumns(),n=t?i[0]:p(i),r=t?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow();this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:n,focusIndex:r,focusColumn:n})}onTabKeyDown(t,i){const n=i.shiftKey;if(this.tabToNextCellCommon(t,n,i))i.preventDefault();else if(n){const{rowIndex:n,rowPinned:e}=t.getRowPosition();(e?0===n:n===this.paginationProxy.getPageFirstRow())&&(0===this.gridOptionsService.getNum("headerHeight")?this.focusService.focusNextGridCoreContainer(!0,!0):(i.preventDefault(),this.focusService.focusLastHeader(i)))}else t instanceof Ia&&t.focusCell(!0),this.focusService.focusNextGridCoreContainer(n)&&i.preventDefault()}tabToNextCell(e,t){const i=this.focusService.getFocusedCell();if(!i)return!1;let n=this.getCellByPosition(i);return!!(n||(n=this.rowRenderer.getRowByPosition(i),n&&n.isFullWidth()))&&this.tabToNextCellCommon(n,e,t)}tabToNextCellCommon(e,t,i){let n,r=e.isEditing();if(!r&&e instanceof Ia){const t=e.getRowCtrl();t&&(r=t.isEditing())}return n=r?"fullRow"===this.gridOptionsService.get("editType")?this.moveToNextEditingRow(e,t,i):this.moveToNextEditingCell(e,t,i):this.moveToNextCellNotEditing(e,t),n||!!this.focusService.getFocusedHeader()}moveToNextEditingCell(e,t,i=null){const n=e.getCellPosition();e.getGui().focus(),e.stopEditing();const r=this.findNextCellToFocusOn(n,t,!0);return null!=r&&(r.startEditing(null,!0,i),r.focusCell(!1),!0)}moveToNextEditingRow(e,t,i=null){const n=e.getCellPosition(),r=this.findNextCellToFocusOn(n,t,!0);if(null==r)return!1;const s=r.getCellPosition(),o=this.isCellEditable(n),a=this.isCellEditable(s),l=s&&n.rowIndex===s.rowIndex&&n.rowPinned===s.rowPinned;if(o&&e.setFocusOutOnEditor(),!l){e.getRowCtrl().stopEditing();r.getRowCtrl().startRowEditing(void 0,void 0,i)}return a?(r.setFocusInOnEditor(),r.focusCell()):r.focusCell(!0),!0}moveToNextCellNotEditing(e,t){const i=this.columnModel.getAllDisplayedColumns();let n;n=e instanceof La?Object.assign(Object.assign({},e.getRowPosition()),{column:t?i[0]:p(i)}):e.getCellPosition();const r=this.findNextCellToFocusOn(n,t,!1);if(r instanceof Ia)r.focusCell(!0);else if(r)return this.tryToFocusFullWidthRow(r.getRowPosition(),t);return _(r)}findNextCellToFocusOn(n,r,s){let o=n;for(;;){n!==o&&(n=o),r||(o=this.getLastCellOfColSpan(o)),o=this.cellNavigationService.getNextTabbedCell(o,r);const t=this.gridOptionsService.getCallback("tabToNextCell");if(_(t)){const e=t({backwards:r,editing:s,previousCellPosition:n,nextCellPosition:o||null});_(e)?(e.floating&&(l(()=>{console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")},"no floating in userCell"),e.rowPinned=e.floating),o={rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned}):o=null}if(!o)return null;if(o.rowIndex<0){const n=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:n+o.rowIndex,column:o.column}}),null}const e="fullRow"===this.gridOptionsService.get("editType");if(s&&!e){if(!this.isCellEditable(o))continue}this.ensureCellVisible(o);const i=this.getCellByPosition(o);if(!i){const n=this.rowRenderer.getRowByPosition(o);if(!n||!n.isFullWidth()||s)continue;return n}if(!i.isSuppressNavigable())return this.rangeService&&this.rangeService.setRangeToCell(o),i}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return!!t&&e.column.isCellEditable(t)}getCellByPosition(e){const t=this.rowRenderer.getRowByPosition(e);return t?t.getCellCtrl(e.column):null}lookupRowNodeForCell(e){return"top"===e.rowPinned?this.pinnedRowModel.getPinnedTopRow(e.rowIndex):"bottom"===e.rowPinned?this.pinnedRowModel.getPinnedBottomRow(e.rowIndex):this.paginationProxy.getRow(e.rowIndex)}navigateToNextCell(e,t,i,n){let r=i,s=!1;for(;r&&(r===i||!this.isValidNavigateCell(r));)this.gridOptionsService.is("enableRtl")?t===A.LEFT&&(r=this.getLastCellOfColSpan(r)):t===A.RIGHT&&(r=this.getLastCellOfColSpan(r)),r=this.cellNavigationService.getNextCellToFocus(t,r),s=u(r);if(s&&e&&e.key===A.UP&&(r={rowIndex:-1,rowPinned:null,column:i.column}),n){const n=this.gridOptionsService.getCallback("navigateToNextCell");if(_(n)){const s=n({key:t,previousCellPosition:i,nextCellPosition:r||null,event:e});_(s)?(s.floating&&(l(()=>{console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")},"no floating in userCell"),s.rowPinned=s.floating),r={rowPinned:s.rowPinned,rowIndex:s.rowIndex,column:s.column}):r=null}}if(!r)return;if(r.rowIndex<0){const t=this.headerNavigationService.getHeaderRowCount();return void this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:t+r.rowIndex,column:i.column},event:e||void 0})}const o=this.getNormalisedPosition(r);o?this.focusPosition(o):this.tryToFocusFullWidthRow(r)}getNormalisedPosition(e){this.ensureCellVisible(e);const t=this.getCellByPosition(e);return t?(e=t.getCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t=!1){const i=this.columnModel.getAllDisplayedColumns(),n=this.rowRenderer.getRowByPosition(e);if(!n||!n.isFullWidth())return!1;const r=this.focusService.getFocusedCell(),s={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?p(i):i[0])};this.focusPosition(s);const o=null!=r&&this.rowPositionUtils.before(s,r),a={type:y.EVENT_FULL_WIDTH_ROW_FOCUSED,rowIndex:s.rowIndex,rowPinned:s.rowPinned,column:s.column,isFullWidthCell:!0,floating:s.rowPinned,fromBelow:o};return this.eventService.dispatchEvent(a),!0}focusPosition(e){this.focusService.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),this.rangeService&&this.rangeService.setRangeToCell(e)}isValidNavigateCell(e){return!!this.rowPositionUtils.getRowNode(e)}getLastCellOfColSpan(e){const t=this.getCellByPosition(e);if(!t)return e;const i=t.getColSpanningList();return 1===i.length?e:{rowIndex:e.rowIndex,column:p(i),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=this.gridOptionsService.isGroupRowsSticky(),i=this.rowModel.getRow(e.rowIndex);!(t&&(null==i?void 0:i.sticky))&&u(e.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(e.rowIndex),e.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(e.column)}};hl([o("mouseEventService")],pl.prototype,"mouseEventService",void 0),hl([o("paginationProxy")],pl.prototype,"paginationProxy",void 0),hl([o("focusService")],pl.prototype,"focusService",void 0),hl([c("rangeService")],pl.prototype,"rangeService",void 0),hl([o("columnModel")],pl.prototype,"columnModel",void 0),hl([o("rowModel")],pl.prototype,"rowModel",void 0),hl([o("ctrlsService")],pl.prototype,"ctrlsService",void 0),hl([o("rowRenderer")],pl.prototype,"rowRenderer",void 0),hl([o("headerNavigationService")],pl.prototype,"headerNavigationService",void 0),hl([o("rowPositionUtils")],pl.prototype,"rowPositionUtils",void 0),hl([o("cellNavigationService")],pl.prototype,"cellNavigationService",void 0),hl([o("pinnedRowModel")],pl.prototype,"pinnedRowModel",void 0),hl([r],pl.prototype,"postConstruct",null),pl=hl([s("navigationService")],pl);var fl=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class gl extends Fs{constructor(e){super('<div class="ag-popup-editor" tabindex="-1"/>'),this.params=e}postConstruct(){this.gridOptionsService.setDomData(this.getGui(),gl.DOM_KEY_POPUP_EDITOR_WRAPPER,!0),this.addKeyDownListener()}addKeyDownListener(){const e=this.getGui(),t=this.params;this.addManagedListener(e,"keydown",e=>{yr(this.gridOptionsService,e,t.node,t.column,!0)||t.onKeyDown(e)})}}gl.DOM_KEY_POPUP_EDITOR_WRAPPER="popupEditorWrapper",fl([r],gl.prototype,"postConstruct",null);class ml extends E{constructor(e,t,i,n,r){super(),this.rendererVersion=0,this.editorVersion=0,this.beans=e,this.column=t.getColumn(),this.rowNode=t.getRowNode(),this.rowCtrl=t.getRowCtrl(),this.eRow=n,this.setTemplate(`<div comp-id="${this.getCompId()}"/>`);const s=this.getGui();this.forceWrapper=t.isForceWrapper(),this.refreshWrapper(!1);const o=(e,t,i)=>{const n=i||s;null!=t&&""!=t?n.setAttribute(e,t):n.removeAttribute(e)},a={addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),setUserStyles:e=>tr(s,e),getFocusableElement:()=>this.getFocusableElement(),setTabIndex:e=>o("tabindex",e.toString()),setRole:e=>_i(s,e),setColId:e=>o("col-id",e),setTitle:e=>o("title",e),setIncludeSelection:e=>this.includeSelection=e,setIncludeRowDrag:e=>this.includeRowDrag=e,setIncludeDndSource:e=>this.includeDndSource=e,setRenderDetails:(e,t,i)=>this.setRenderDetails(e,t,i),setEditDetails:(e,t,i)=>this.setEditDetails(e,t,i),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue()};this.cellCtrl=t,t.setComp(a,this.getGui(),this.eCellWrapper,i,r)}getParentOfValue(){return this.eCellValue?this.eCellValue:this.eCellWrapper?this.eCellWrapper:this.getGui()}setRenderDetails(e,t,i){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=null==this.firstRender;const n=this.refreshWrapper(!1);if(this.refreshEditStyles(!1),e){!(i||n)&&this.refreshCellRenderer(e)||(this.destroyRenderer(),this.createCellRendererInstance(e))}else this.destroyRenderer(),this.insertValueWithoutCellRenderer(t)}setEditDetails(e,t,i){e?this.createCellEditorInstance(e,t,i):this.destroyEditor()}removeControls(){this.checkboxSelectionComp=this.beans.context.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=this.beans.context.destroyBean(this.dndSourceComp),this.rowDraggingComp=this.beans.context.destroyBean(this.rowDraggingComp)}refreshWrapper(e){const t=this.includeRowDrag||this.includeDndSource||this.includeSelection,i=t||this.forceWrapper,n=i&&null==this.eCellWrapper;n&&(this.eCellWrapper=Un('<div class="ag-cell-wrapper" role="presentation"></div>'),this.getGui().appendChild(this.eCellWrapper));const r=!i&&null!=this.eCellWrapper;r&&(zn(this.eCellWrapper),this.eCellWrapper=void 0),this.addOrRemoveCssClass("ag-cell-value",!i);const s=!e&&i,o=s&&null==this.eCellValue;o&&(this.eCellValue=Un('<span class="ag-cell-value" role="presentation"></span>'),this.eCellWrapper.appendChild(this.eCellValue));const a=!s&&null!=this.eCellValue;a&&(zn(this.eCellValue),this.eCellValue=void 0);const l=n||r||o||a;return l&&this.removeControls(),e||t&&this.addControls(),l}addControls(){this.includeRowDrag&&null==this.rowDraggingComp&&(this.rowDraggingComp=this.cellCtrl.createRowDragComp(),this.rowDraggingComp&&this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(),this.eCellValue)),this.includeDndSource&&null==this.dndSourceComp&&(this.dndSourceComp=this.cellCtrl.createDndSource(),this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(),this.eCellValue)),this.includeSelection&&null==this.checkboxSelectionComp&&(this.checkboxSelectionComp=this.cellCtrl.createSelectionCheckbox(),this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(),this.eCellValue))}createCellEditorInstance(e,t,i){const n=this.editorVersion,r=e.newAgStackInstance();if(!r)return;const{params:s}=e;r.then(e=>this.afterCellEditorCreated(n,e,s,t,i));u(this.cellEditor)&&s.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(e){const t=this.getParentOfValue();Vn(t);const i=null!=e?$t(e):null;null!=i&&(t.innerHTML=i)}destroyEditorAndRenderer(){this.destroyRenderer(),this.destroyEditor()}destroyRenderer(){const{context:e}=this.beans;this.cellRenderer=e.destroyBean(this.cellRenderer),zn(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){const{context:e}=this.beans;this.hideEditorPopup&&this.hideEditorPopup(),this.hideEditorPopup=void 0,this.cellEditor=e.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=e.destroyBean(this.cellEditorPopupWrapper),zn(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(e){if(null==this.cellRenderer||null==this.cellRenderer.refresh)return!1;if(this.cellRendererClass!==e.componentClass)return!1;const t=this.cellRenderer.refresh(e.params);return!0===t||void 0===t}createCellRendererInstance(i){const e=!this.beans.gridOptionsService.is("suppressAnimationFrame"),n=this.rendererVersion,{componentClass:r}=i,t=()=>{if(this.rendererVersion!==n||!this.isAlive())return;const e=i.newAgStackInstance(),t=this.afterCellRendererCreated.bind(this,n,r);e&&e.then(t)};e&&this.firstRender?this.beans.animationFrameService.createTask(t,this.rowNode.rowIndex,"createTasksP2"):t()}getCtrl(){return this.cellCtrl}getRowCtrl(){return this.rowCtrl}getCellRenderer(){return this.cellRenderer}getCellEditor(){return this.cellEditor}afterCellRendererCreated(e,t,i){if(!this.isAlive()||e!==this.rendererVersion)this.beans.context.destroyBean(i);else if(this.cellRenderer=i,this.cellRendererClass=t,this.cellRendererGui=this.cellRenderer.getGui(),null!=this.cellRendererGui){const e=this.getParentOfValue();Vn(e),e.appendChild(this.cellRendererGui)}}afterCellEditorCreated(e,t,i,n,r){if(e!==this.editorVersion)return void this.beans.context.destroyBean(t);if(t.isCancelBeforeStart&&t.isCancelBeforeStart())return this.beans.context.destroyBean(t),void this.cellCtrl.stopEditing(!0);if(!t.getGui)return console.warn(`AG Grid: cellEditor for column ${this.column.getId()} is missing getGui() method`),void this.beans.context.destroyBean(t);this.cellEditor=t,this.cellEditorGui=t.getGui();const s=n||void 0!==t.isPopup&&t.isPopup();s?this.addPopupCellEditor(i,r):this.addInCellEditor(),this.refreshEditStyles(!0,s),t.afterGuiAttached&&t.afterGuiAttached()}refreshEditStyles(e,t){var i;this.addOrRemoveCssClass("ag-cell-inline-editing",e&&!t),this.addOrRemoveCssClass("ag-cell-popup-editing",e&&!!t),this.addOrRemoveCssClass("ag-cell-not-inline-editing",!e||!!t),null===(i=this.rowCtrl)||void 0===i||i.setInlineEditingCss(e)}addInCellEditor(){const e=this.getGui(),t=this.beans.gridOptionsService.getDocument();if(e.contains(t.activeElement)&&e.focus(),this.destroyRenderer(),this.refreshWrapper(!0),this.clearParentOfValue(),this.cellEditorGui){this.getParentOfValue().appendChild(this.cellEditorGui)}}addPopupCellEditor(e,t){"fullRow"===this.beans.gridOptionsService.get("editType")&&console.warn("AG Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");const i=this.cellEditor;this.cellEditorPopupWrapper=this.beans.context.createBean(new gl(e));const n=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&n.appendChild(this.cellEditorGui);const r=this.beans.popupService,s=this.beans.gridOptionsService.is("stopEditingWhenCellsLoseFocus"),o=null!=t?t:i.getPopupPosition?i.getPopupPosition():"over",a=this.beans.gridOptionsService.is("enableRtl"),l={ePopup:n,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),position:o,alignSide:a?"right":"left",keepWithinBounds:!0},c=r.positionPopupByComponent.bind(r,l),u=this.beans.localeService.getLocaleTextFunc(),d=r.addPopup({modal:s,eChild:n,closeOnEsc:!0,closedCallback:()=>{this.cellCtrl.onPopupEditorClosed()},anchorToElement:this.getGui(),positionCallback:c,ariaLabel:u("ariaLabelCellEditor","Cell Editor")});d&&(this.hideEditorPopup=d.hideFunc)}detach(){this.eRow.removeChild(this.getGui())}destroy(){this.cellCtrl.stopEditing(),this.destroyEditorAndRenderer(),this.removeControls(),super.destroy()}clearParentOfValue(){const e=this.getGui(),t=this.beans.gridOptionsService.getDocument();e.contains(t.activeElement)&&rn()&&e.focus({preventScroll:!0}),Vn(this.getParentOfValue())}}class vl extends E{constructor(e,t,i){super(),this.cellComps={},this.beans=t,this.rowCtrl=e,this.setTemplate(`<div comp-id="${this.getCompId()}" style="${this.getInitialStyle(i)}"/>`);const n=this.getGui(),r=n.style,s={setDomOrder:e=>this.domOrder=e,setCellCtrls:e=>this.setCellCtrls(e),showFullWidth:e=>this.showFullWidth(e),getFullWidthCellRenderer:()=>this.getFullWidthCellRenderer(),addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),setUserStyles:e=>tr(n,e),setTop:e=>r.top=e,setTransform:e=>r.transform=e,setRowIndex:e=>n.setAttribute("row-index",e),setRole:e=>_i(n,e),setRowId:e=>n.setAttribute("row-id",e),setRowBusinessKey:e=>n.setAttribute("row-business-key",e),setTabIndex:e=>n.setAttribute("tabindex",e.toString())};e.setComp(s,this.getGui(),i),this.addDestroyFunc(()=>{e.unsetComp(i)})}getInitialStyle(e){const t=this.rowCtrl.getInitialTransform(e),i=this.rowCtrl.getInitialRowTop(e);return t?"transform: "+t:"top: "+i}showFullWidth(e){const t=e.newAgStackInstance();t&&t.then(t=>{if(this.isAlive()){const e=t.getGui();this.getGui().appendChild(e),this.rowCtrl.setupDetailRowAutoHeight(e),this.setFullWidthRowComp(t)}else this.beans.context.destroyBean(t)})}setCellCtrls(e){const i=Object.assign({},this.cellComps);e.forEach(e=>{const t=e.getInstanceId();null==this.cellComps[t]?this.newCellComp(e):i[t]=null});const t=ye(i).filter(e=>null!=e);this.destroyCells(t),this.ensureDomOrder(e)}ensureDomOrder(e){if(!this.domOrder)return;const i=[];e.forEach(e=>{const t=this.cellComps[e.getInstanceId()];t&&i.push(t.getGui())}),Zn(this.getGui(),i)}newCellComp(e){const t=new ml(this.beans,e,this.rowCtrl.isPrintLayout(),this.getGui(),this.rowCtrl.isEditing());this.cellComps[e.getInstanceId()]=t,this.getGui().appendChild(t.getGui())}destroy(){super.destroy(),this.destroyAllCells()}destroyAllCells(){const e=ye(this.cellComps).filter(e=>null!=e);this.destroyCells(e)}setFullWidthRowComp(e){this.fullWidthCellRenderer&&console.error("AG Grid - should not be setting fullWidthRowComponent twice"),this.fullWidthCellRenderer=e,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer)})}getFullWidthCellRenderer(){return this.fullWidthCellRenderer}destroyCells(e){e.forEach(e=>{if(!e)return;const t=e.getCtrl().getInstanceId();this.cellComps[t]===e&&(e.detach(),e.destroy(),this.cellComps[t]=null)})}}var yl=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class bl extends E{constructor(){super(function(){const e=E.elementGettingCreated.getAttribute("name"),t=nl.getRowContainerCssClasses(e);let i;const n=e===k.CENTER,r=e===k.TOP_CENTER||e===k.STICKY_TOP_CENTER||e===k.BOTTOM_CENTER;return i=n?`<div class="${t.wrapper}" ref="eWrapper" role="presentation">\n                <div class="${t.viewport}" ref="eViewport" role="presentation">\n                    <div class="${t.container}" ref="eContainer"></div>\n                </div>\n            </div>`:r?`<div class="${t.viewport}" ref="eViewport" role="presentation">\n                <div class="${t.container}" ref="eContainer"></div>\n            </div>`:`<div class="${t.container}" ref="eContainer"></div>`,i}()),this.rowComps={},this.name=E.elementGettingCreated.getAttribute("name"),this.type=Ja(this.name)}postConstruct(){const e={setViewportHeight:e=>this.eViewport.style.height=e,setRowCtrls:e=>this.setRowCtrls(e),setDomOrder:e=>{this.domOrder=e},setContainerWidth:e=>this.eContainer.style.width=e};this.createManagedBean(new nl(this.name)).setComp(e,this.eContainer,this.eViewport,this.eWrapper)}preDestroy(){this.setRowCtrls([])}setRowCtrls(e){const n=Object.assign({},this.rowComps);this.rowComps={},this.lastPlacedElement=null;e.forEach(e=>{const t=e.getInstanceId(),i=n[t];if(i)this.rowComps[t]=i,delete n[t],this.ensureDomOrder(i.getGui());else{if(!e.getRowNode().displayed)return;const n=new vl(e,this.beans,this.type);this.rowComps[t]=n,this.appendRow(n.getGui())}}),ye(n).forEach(e=>{this.eContainer.removeChild(e.getGui()),e.destroy()}),_i(this.eContainer,e.length?"rowgroup":"presentation")}appendRow(e){this.domOrder?Jn(this.eContainer,e,this.lastPlacedElement):this.eContainer.appendChild(e),this.lastPlacedElement=e}ensureDomOrder(e){this.domOrder&&(Qn(this.eContainer,e,this.lastPlacedElement),this.lastPlacedElement=e)}}yl([o("beans")],bl.prototype,"beans",void 0),yl([S("eViewport")],bl.prototype,"eViewport",void 0),yl([S("eContainer")],bl.prototype,"eContainer",void 0),yl([S("eWrapper")],bl.prototype,"eWrapper",void 0),yl([r],bl.prototype,"postConstruct",null),yl([Ve],bl.prototype,"preDestroy",null);var Cl=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class wl{constructor(e){this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=e}onDragEnter(e){if(this.clearColumnsList(),this.gridOptionsService.is("functionsReadOnly"))return;const t=e.dragItem.columns;t&&t.forEach(e=>{e.isPrimary()&&(e.isAnyFunctionActive()||(e.isAllowValue()?this.columnsToAggregate.push(e):e.isAllowRowGroup()?this.columnsToGroup.push(e):e.isAllowPivot()&&this.columnsToPivot.push(e)))})}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?M.ICON_PINNED:M.ICON_MOVE:null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){this.columnsToAggregate.length>0&&this.columnModel.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.columnModel.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.columnModel.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")}}Cl([o("columnModel")],wl.prototype,"columnModel",void 0),Cl([o("gridOptionsService")],wl.prototype,"gridOptionsService",void 0);var _l=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Al{constructor(e,t){this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=e,this.eContainer=t,this.centerContainer=!_(e)}init(){this.ctrlsService.whenReady(()=>{this.gridBodyCon=this.ctrlsService.getGridBodyCtrl()})}getIconName(){return this.pinned?M.ICON_PINNED:M.ICON_MOVE}onDragEnter(i){const n=i.dragItem.columns;if(i.dragSource.type===Js.ToolPanel)this.setColumnsVisible(n,!0,"uiColumnDragged");else{const t=i.dragItem.visibleState,e=(n||[]).filter(e=>t[e.getId()]);this.setColumnsVisible(e,!0,"uiColumnDragged")}this.setColumnsPinned(n,this.pinned,"uiColumnDragged"),this.onDragging(i,!0,!0)}onDragLeave(){this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(t,i,n="api"){if(t){const e=t.filter(e=>!e.getColDef().lockVisible);this.columnModel.setColumnsVisible(e,i,n)}}setColumnsPinned(t,i,n="api"){if(t){const e=t.filter(e=>!e.getColDef().lockPinned);this.columnModel.setColumnsPinned(e,i,n)}}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}normaliseX(e){if(this.gridOptionsService.is("enableRtl")){e=this.eContainer.clientWidth-e}return this.centerContainer&&(e+=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft()),e}checkCenterForScrolling(i){if(this.centerContainer){const e=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft(),t=e+this.ctrlsService.getCenterRowContainerCtrl().getCenterWidth();this.gridOptionsService.is("enableRtl")?(this.needToMoveRight=i<e+50,this.needToMoveLeft=i>t-50):(this.needToMoveLeft=i<e+50,this.needToMoveRight=i>t-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}}onDragging(e=this.lastDraggingEvent,t=!1,i=!1,n=!1){var r;if(n){if(this.lastMovedInfo){const{columns:e,toIndex:t}=this.lastMovedInfo;this.moveColumns(e,t,"uiColumnMoved",!0)}return}if(this.lastDraggingEvent=e,u(e.hDirection))return;const s=this.normaliseX(e.x);t||this.checkCenterForScrolling(s);const o=this.normaliseDirection(e.hDirection),a=e.dragSource.type,l=(null===(r=e.dragSource.getDragItem().columns)||void 0===r?void 0:r.filter(e=>!e.getColDef().lockPinned||e.getPinned()==this.pinned))||[];this.attemptMoveColumns({dragSourceType:a,allMovingColumns:l,hDirection:o,mouseX:s,fromEnter:t,fakeEvent:i})}normaliseDirection(e){if(!this.gridOptionsService.is("enableRtl"))return e;switch(e){case to.Left:return to.Right;case to.Right:return to.Left;default:console.error("AG Grid: Unknown direction "+e)}}attemptMoveColumns(e){const{dragSourceType:t,hDirection:i,mouseX:n,fromEnter:r,fakeEvent:s}=e,o=i===to.Left,a=i===to.Right;let{allMovingColumns:l}=e;if(t===Js.HeaderCell){let n=[];l.forEach(e=>{let t=null,i=e.getParent();for(;null!=i&&1===i.getDisplayedLeafColumns().length;)t=i,i=i.getParent();if(null!=t){t.getProvidedColumnGroup().getLeafColumns().forEach(e=>{n.includes(e)||n.push(e)})}else n.includes(e)||n.push(e)}),l=n}const c=l.slice();this.columnModel.sortColumnsLikeGridColumns(c);const u=this.calculateValidMoves(c,a,n),d=this.calculateOldIndex(c);if(0===u.length)return;const h=u[0];let p=null!==d&&!r;if(t==Js.HeaderCell&&(p=null!==d),p&&!s){if(o&&h>=d)return;if(a&&h<=d)return}const f=this.columnModel.getAllDisplayedColumns();let g=[],m=null;for(let e=0;e<u.length;e++){const t=u[e],i=this.columnModel.getProposedColumnOrder(c,t);if(!this.columnModel.doesOrderPassRules(i))continue;const n=i.filter(e=>f.includes(e));if(null===m)m=n;else if(!Tr.areEqual(n,m))break;const r=this.groupFragCount(i);g.push({move:t,fragCount:r})}0!==g.length&&(g.sort((e,t)=>e.fragCount-t.fragCount),this.moveColumns(l,g[0].move,"uiColumnMoved",!1))}calculateOldIndex(e){const t=this.columnModel.getAllGridColumns(),i=rt(e.map(e=>t.indexOf(e))),n=i[0];return p(i)-n!==i.length-1?null:n}moveColumns(e,t,i,n){this.columnModel.moveColumns(e,t,i,n),this.lastMovedInfo=n?null:{columns:e,toIndex:t}}groupFragCount(n){function r(e){let t=[],i=e.getOriginalParent();for(;null!=i;)t.push(i),i=i.getOriginalParent();return t}let s=0;for(let i=0;i<n.length-1;i++){let e=r(n[i]),t=r(n[i+1]);[e,t]=e.length>t.length?[e,t]:[t,e],e.forEach(e=>{-1===t.indexOf(e)&&s++})}return s}calculateValidMoves(t,i,e){if(this.gridOptionsService.is("suppressMovableColumns")||t.some(e=>e.getColDef().suppressMovable))return[];const n=this.columnModel.getDisplayedColumns(this.pinned),r=this.columnModel.getAllGridColumns(),s=n.filter(e=>dt(t,e)),o=n.filter(e=>!dt(t,e)),a=r.filter(e=>!dt(t,e));let l,c=0,u=e;if(i){let t=0;s.forEach(e=>t+=e.getActualWidth()),u-=t}if(u>0){for(let e=0;e<o.length;e++){if(u-=o[e].getActualWidth(),u<0)break;c++}i&&c++}if(c>0){const t=o[c-1];l=a.indexOf(t)+1}else l=a.indexOf(o[0]),-1===l&&(l=0);const d=[l],h=(e,t)=>e-t;if(i){let e=l+1;const i=r.length-1;for(;e<=i;)d.push(e),e++;d.sort(h)}else{let e=l;const i=r.length-1;let t=r[e];for(;e<=i&&this.isColumnHidden(n,t);)e++,d.push(e),t=r[e];e=l-1;const s=0;for(;e>=s;)d.push(e),e--;d.sort(h).reverse()}return d}isColumnHidden(e,t){return e.indexOf(t)<0}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.needToMoveLeft?this.dragAndDropService.setGhostIcon(M.ICON_LEFT,!0):this.dragAndDropService.setGhostIcon(M.ICON_RIGHT,!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.dragAndDropService.setGhostIcon(M.ICON_MOVE))}moveInterval(){let e;this.intervalCount++,e=10+5*this.intervalCount,e>100&&(e=100);let t=null;const i=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?t=i.scrollHorizontally(-e):this.needToMoveRight&&(t=i.scrollHorizontally(e)),0!==t)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const e=this.lastDraggingEvent.dragItem.columns.filter(e=>!e.getColDef().lockPinned);if(e.length>0&&(this.dragAndDropService.setGhostIcon(M.ICON_PINNED),this.failedMoveAttempts>7)){const t=this.needToMoveLeft?"left":"right";this.setColumnsPinned(e,t,"uiColumnDragged"),this.dragAndDropService.nudge()}}}}_l([o("columnModel")],Al.prototype,"columnModel",void 0),_l([o("dragAndDropService")],Al.prototype,"dragAndDropService",void 0),_l([o("gridOptionsService")],Al.prototype,"gridOptionsService",void 0),_l([o("ctrlsService")],Al.prototype,"ctrlsService",void 0),_l([r],Al.prototype,"init",null);var El=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Sl extends f{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){this.ctrlsService.whenReady(e=>{switch(this.pinned){case"left":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.leftRowContainerCtrl.getContainerElement()],[e.bottomLeftRowContainerCtrl.getContainerElement()],[e.topLeftRowContainerCtrl.getContainerElement()]];break;case"right":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.rightRowContainerCtrl.getContainerElement()],[e.bottomRightRowContainerCtrl.getContainerElement()],[e.topRightRowContainerCtrl.getContainerElement()]];break;default:this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.centerRowContainerCtrl.getViewportElement()],[e.bottomCenterRowContainerCtrl.getViewportElement()],[e.topCenterRowContainerCtrl.getViewportElement()]]}})}isInterestedIn(e){return e===Js.HeaderCell||e===Js.ToolPanel&&this.gridOptionsService.is("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}init(){this.moveColumnFeature=this.createManagedBean(new Al(this.pinned,this.eContainer)),this.bodyDropPivotTarget=this.createManagedBean(new wl(this.pinned)),this.dragAndDropService.addDropTarget(this)}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.columnModel.isPivotMode()&&e.dragSource.type===Js.ToolPanel}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}}El([o("dragAndDropService")],Sl.prototype,"dragAndDropService",void 0),El([o("columnModel")],Sl.prototype,"columnModel",void 0),El([o("ctrlsService")],Sl.prototype,"ctrlsService",void 0),El([r],Sl.prototype,"postConstruct",null),El([r],Sl.prototype,"init",null);class Tl{static getHeaderClassesFromColDef(e,t,i,n){return u(e)?[]:this.getColumnClassesFromCollDef(e.headerClass,e,t,i,n)}static getToolPanelClassesFromColDef(e,t,i,n){return u(e)?[]:this.getColumnClassesFromCollDef(e.toolPanelClass,e,t,i,n)}static getClassParams(e,t,i,n){return{colDef:e,column:i,columnGroup:n,api:t.api,columnApi:t.columnApi,context:t.context}}static getColumnClassesFromCollDef(e,t,i,n,r){if(u(e))return[];let s;if("function"==typeof e){s=e(this.getClassParams(t,i,n,r))}else s=e;return"string"==typeof s?[s]:Array.isArray(s)?[...s]:[]}}var xl=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Dl extends oa{constructor(e){super(Dl.TEMPLATE,e),this.headerCompVersion=0,this.column=e.getColumnGroupChild(),this.pinned=e.getPinned()}postConstruct(){const r=this.getGui(),t=(e,t,i)=>{const n=i||r;null!=t&&""!=t?n.setAttribute(e,t):n.removeAttribute(e)},e={setWidth:e=>r.style.width=e,addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),setColId:e=>t("col-id",e),setTitle:e=>t("title",e),setAriaDescription:e=>Ri(r,e),setAriaSort:e=>e?ji(r,e):Ui(r),setUserCompDetails:e=>this.setUserCompDetails(e),getUserCompInstance:()=>this.headerComp};this.ctrl.setComp(e,this.getGui(),this.eResize,this.eHeaderCompWrapper);const i=this.ctrl.getSelectAllGui();this.eResize.insertAdjacentElement("afterend",i)}destroyHeaderComp(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(e){this.headerCompVersion++;const t=this.headerCompVersion;e.newAgStackInstance().then(e=>this.afterCompCreated(t,e))}afterCompCreated(e,t){e==this.headerCompVersion&&this.isAlive()?(this.destroyHeaderComp(),this.headerComp=t,this.headerCompGui=t.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())):this.destroyBean(t)}}Dl.TEMPLATE='<div class="ag-header-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>\n        </div>',xl([S("eResize")],Dl.prototype,"eResize",void 0),xl([S("eHeaderCompWrapper")],Dl.prototype,"eHeaderCompWrapper",void 0),xl([r],Dl.prototype,"postConstruct",null),xl([Ve],Dl.prototype,"destroyHeaderComp",null);var Rl=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Ml extends oa{constructor(e){super(Ml.TEMPLATE,e)}postConstruct(){const i=this.getGui(),t=(e,t)=>null!=t?i.setAttribute(e,t):i.removeAttribute(e),e={addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),setResizableDisplayed:e=>w(this.eResize,e),setWidth:e=>i.style.width=e,setColId:e=>i.setAttribute("col-id",e),setAriaExpanded:e=>t("aria-expanded",e),setTitle:e=>t("title",e),setUserCompDetails:e=>this.setUserCompDetails(e)};this.ctrl.setComp(e,i,this.eResize)}setUserCompDetails(e){e.newAgStackInstance().then(e=>this.afterHeaderCompCreated(e))}afterHeaderCompCreated(e){const t=()=>this.destroyBean(e);if(!this.isAlive())return void t();const i=this.getGui(),n=e.getGui();i.appendChild(n),this.addDestroyFunc(t),this.ctrl.setDragSource(i)}}Ml.TEMPLATE='<div class="ag-header-group-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n        </div>',Rl([o("userComponentFactory")],Ml.prototype,"userComponentFactory",void 0),Rl([S("eResize")],Ml.prototype,"eResize",void 0),Rl([r],Ml.prototype,"postConstruct",null);var Nl,Ol=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};!function(e){e.COLUMN_GROUP="group",e.COLUMN="column",e.FLOATING_FILTER="filter"}(Nl||(Nl={}));class Il extends E{constructor(e){super(),this.headerComps={};const t=e.getType()==Nl.COLUMN_GROUP?"ag-header-row-column-group":e.getType()==Nl.FLOATING_FILTER?"ag-header-row-column-filter":"ag-header-row-column";this.setTemplate(`<div class="ag-header-row ${t}" role="row"></div>`),this.ctrl=e}init(){const e={setTransform:e=>this.getGui().style.transform=e,setHeight:e=>this.getGui().style.height=e,setTop:e=>this.getGui().style.top=e,setHeaderCtrls:e=>this.setHeaderCtrls(e),setWidth:e=>this.getGui().style.width=e,setAriaRowIndex:e=>Bi(this.getGui(),e)};this.ctrl.setComp(e)}destroyHeaderCtrls(){this.setHeaderCtrls([])}setHeaderCtrls(e){if(!this.isAlive())return;const n=this.headerComps;this.headerComps={},e.forEach(e=>{const t=e.getInstanceId();let i=n[t];delete n[t],null==i&&(i=this.createHeaderComp(e),this.getGui().appendChild(i.getGui())),this.headerComps[t]=i}),a(n,(e,t)=>{this.getGui().removeChild(t.getGui()),this.destroyBean(t)});const t=this.gridOptionsService.is("ensureDomOrder"),i=this.gridOptionsService.isDomLayout("print");if(t||i){const e=ye(this.headerComps);e.sort((e,t)=>e.getCtrl().getColumnGroupChild().getLeft()-t.getCtrl().getColumnGroupChild().getLeft());const n=e.map(e=>e.getGui());Zn(this.getGui(),n)}}createHeaderComp(e){let t;switch(this.ctrl.getType()){case Nl.COLUMN_GROUP:t=new Ml(e);break;case Nl.FLOATING_FILTER:t=new la(e);break;default:t=new Dl(e)}return this.createBean(t),t.setParentComponent(this),t}}Ol([r],Il.prototype,"init",null),Ol([Ve],Il.prototype,"destroyHeaderCtrls",null);var Pl=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let kl=0;class Ll extends f{constructor(e,t){super(),this.lastFocusEvent=null,this.columnGroupChild=e,this.parentRowCtrl=t,this.instanceId=e.getUniqueId()+"-"+kl++}shouldStopEventPropagation(e){const{headerRowIndex:t,column:i}=this.focusService.getFocusedHeader();return br(this.gridOptionsService,e,t,i)}getWrapperHasFocus(){return this.gridOptionsService.getDocument().activeElement===this.eGui}setGui(e){this.eGui=e,this.addDomData()}handleKeyDown(e){const t=this.getWrapperHasFocus();switch(e.key){case A.PAGE_DOWN:case A.PAGE_UP:case A.PAGE_HOME:case A.PAGE_END:t&&e.preventDefault()}}addDomData(){const e=Ll.DOM_DATA_KEY_HEADER_CTRL;this.gridOptionsService.setDomData(this.eGui,e,this),this.addDestroyFunc(()=>this.gridOptionsService.setDomData(this.eGui,e,null))}getGui(){return this.eGui}focus(e){return!!this.eGui&&(this.lastFocusEvent=e||null,this.eGui.focus(),!0)}getRowIndex(){return this.parentRowCtrl.getRowIndex()}getParentRowCtrl(){return this.parentRowCtrl}getPinned(){return this.parentRowCtrl.getPinned()}getInstanceId(){return this.instanceId}getColumnGroupChild(){return this.columnGroupChild}}Ll.DOM_DATA_KEY_HEADER_CTRL="headerCtrl",Pl([o("focusService")],Ll.prototype,"focusService",void 0),Pl([o("beans")],Ll.prototype,"beans",void 0),Pl([o("userComponentFactory")],Ll.prototype,"userComponentFactory",void 0);var Fl=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Gl extends f{constructor(e,t,i,n){super(),this.columnOrGroup=e,this.eCell=t,this.ariaEl=this.eCell.querySelector("[role=columnheader]")||this.eCell,this.colsSpanning=n,this.beans=i}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){return this.beans.gridOptionsService.is("enableRtl")&&this.colsSpanning?p(this.colsSpanning):this.columnOrGroup}postConstruct(){this.addManagedListener(this.columnOrGroup,d.EVENT_LEFT_CHANGED,this.onLeftChanged.bind(this)),this.setLeftFirstTime(),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onLeftChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onLeftChanged.bind(this))}setLeftFirstTime(){const e=this.beans.gridOptionsService.is("suppressColumnMoveAnimation"),t=_(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&t&&!e?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=e.getLeft(),i=e.getOldLeft(),n=this.modifyLeftForPrintLayout(e,i),r=this.modifyLeftForPrintLayout(e,t);this.setLeft(n),this.actualLeft=r,this.beans.columnAnimationService.executeNextVMTurn(()=>{this.actualLeft===r&&this.setLeft(r)})}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){if(!this.beans.gridOptionsService.isDomLayout("print"))return t;if("left"===e.getPinned())return t;const i=this.beans.columnModel.getDisplayedColumnsLeftWidth();if("right"===e.getPinned()){return i+this.beans.columnModel.getBodyContainerWidth()+t}return i+t}setLeft(e){let t;if(_(e)&&(this.eCell.style.left=e+"px"),this.columnOrGroup instanceof d)t=this.columnOrGroup;else{const e=this.columnOrGroup.getLeafColumns();if(!e.length)return;e.length>1&&zi(this.ariaEl,e.length),t=e[0]}const i=this.beans.columnModel.getAriaColumnIndex(t);Wi(this.ariaEl,i)}}Fl([r],Gl.prototype,"postConstruct",null);var $l=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Hl extends f{constructor(e,t){super(),this.columns=e,this.element=t}postConstruct(){this.gridOptionsService.is("columnHoverHighlight")&&this.addMouseHoverListeners()}addMouseHoverListeners(){this.addManagedListener(this.element,"mouseout",this.onMouseOut.bind(this)),this.addManagedListener(this.element,"mouseover",this.onMouseOver.bind(this))}onMouseOut(){this.columnHoverService.clearMouseOver()}onMouseOver(){this.columnHoverService.setMouseOver(this.columns)}}$l([o("columnHoverService")],Hl.prototype,"columnHoverService",void 0),$l([r],Hl.prototype,"postConstruct",null);var Bl=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Vl extends Ll{constructor(e,t){super(e,t),this.iconCreated=!1,this.column=e}setComp(e,t,i,n){super.setGui(t),this.comp=e,this.eButtonShowMainFilter=i,this.eFloatingFilterBody=n,this.setupActive(),this.setupWidth(),this.setupLeft(),this.setupHover(),this.setupFocus(),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(),this.setupUi(),this.addManagedListener(this.eButtonShowMainFilter,"click",this.showParentFilter.bind(this)),this.setupFilterChangedListener(),this.addManagedListener(this.column,d.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this))}setupActive(){const e=this.column.getColDef(),t=!!e.filter,i=!!e.floatingFilter;this.active=t&&i}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=mr("filter",this.gridOptionsService,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(){this.createManagedBean(new jr(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.localeService.getLocaleTextFunc();xi(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){if(this.gridOptionsService.getDocument().activeElement===this.eGui)return;const t=this.focusService.findNextFocusableElement(this.eGui,null,e.shiftKey);if(t)return this.beans.headerNavigationService.scrollToColumn(this.column),e.preventDefault(),void t.focus();const i=this.findNextColumnWithFloatingFilter(e.shiftKey);i&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:i},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.columnModel;let i=this.column;do{if(i=e?t.getDisplayedColBefore(i):t.getDisplayedColAfter(i),!i)break}while(!i.getColDef().filter||!i.getColDef().floatingFilter);return i}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case A.UP:case A.DOWN:t||e.preventDefault();case A.LEFT:case A.RIGHT:if(t)return;e.stopPropagation();case A.ENTER:t&&this.focusService.focusInto(this.eGui)&&e.preventDefault();break;case A.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const t=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),i=!!e.relatedTarget&&On(e.relatedTarget,"ag-floating-filter");if(t&&i&&e.target===this.eGui){const e=this.lastFocusEvent,t=!(!e||e.key!==A.TAB);if(e&&t){const t=e.shiftKey;this.focusService.focusInto(this.eGui,t)}}const n=this.getRowIndex();this.beans.focusService.setFocusedHeader(n,this.column)}setupHover(){this.createManagedBean(new Hl([this.column],this.eGui));const e=()=>{if(!this.gridOptionsService.is("columnHoverHighlight"))return;const e=this.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",e)};this.addManagedListener(this.eventService,y.EVENT_COLUMN_HOVER_CHANGED,e),e()}setupLeft(){const e=new Gl(this.column,this.eGui,this.beans);this.createManagedBean(e)}setupFilterButton(){const e=this.column.getColDef();this.suppressFilterButton=!!e.floatingFilterComponentParams&&!!e.floatingFilterComponentParams.suppressFilterButton}setupUserComp(){if(!this.active)return;const e=this.filterManager.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){const e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuFactory.showMenuAfterButtonClick(this.column,e,"floatingFilter","filterMenuTab",["filterMenuTab"])}setupSyncWithFilter(){if(!this.active)return;const e=i=>{const e=this.comp.getFloatingFilterComp();e&&e.then(t=>{if(t){const e=this.filterManager.getCurrentFloatingFilterParentModel(this.column);t.onParentModelChanged(e,i)}})};this.destroySyncListener=this.addManagedListener(this.column,d.EVENT_FILTER_CHANGED,e),this.filterManager.isFilterActive(this.column)&&e(null)}setupWidth(){const e=()=>{const e=this.column.getActualWidth()+"px";this.comp.setWidth(e)};this.addManagedListener(this.column,d.EVENT_WIDTH_CHANGED,e),e()}setupFilterChangedListener(){this.active&&(this.destroyFilterChangedListener=this.addManagedListener(this.column,d.EVENT_FILTER_CHANGED,this.updateFilterButton.bind(this)))}updateFilterButton(){!this.suppressFilterButton&&this.comp&&this.comp.setButtonWrapperDisplayed(this.filterManager.isFilterAllowed(this.column))}onColDefChanged(){var e,t;const i=this.active;this.setupActive();const n=!i&&this.active;i&&!this.active&&(null===(e=this.destroySyncListener)||void 0===e||e.call(this),null===(t=this.destroyFilterChangedListener)||void 0===t||t.call(this));const r=this.active?this.filterManager.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,s=this.comp.getFloatingFilterComp();s&&r?s.then(e=>{var t;e&&(null===(t=this.userCompDetails)||void 0===t?void 0:t.componentClass)===r.componentClass||this.updateCompDetails(r,n)}):this.updateCompDetails(r,n)}updateCompDetails(e,t){this.setCompDetails(e),this.setupFilterButton(),this.setupUi(),t&&(this.setupSyncWithFilter(),this.setupFilterChangedListener())}}Bl([o("filterManager")],Vl.prototype,"filterManager",void 0),Bl([o("columnHoverService")],Vl.prototype,"columnHoverService",void 0),Bl([o("menuFactory")],Vl.prototype,"menuFactory",void 0);var Wl=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class zl extends f{constructor(e,t,i,n,r){super(),this.pinned=e,this.column=t,this.eResize=i,this.comp=n,this.ctrl=r}postConstruct(){const i=this.column.getColDef(),t=[];let n,r;const s=()=>{if(w(this.eResize,n),!n)return;const e=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(t.push(e),r){const e=this.gridOptionsService.is("skipHeaderOnAutoSize"),t=()=>{this.columnModel.autoSizeColumn(this.column,e,"uiColumnResized")};this.eResize.addEventListener("dblclick",t);const n=new D(this.eResize);n.addEventListener(D.EVENT_DOUBLE_TAP,t),this.addDestroyFunc(()=>{this.eResize.removeEventListener("dblclick",t),n.removeEventListener(D.EVENT_DOUBLE_TAP,t),n.destroy()})}},o=()=>{t.forEach(e=>e()),t.length=0},e=()=>{const e=this.column.isResizable(),t=!this.gridOptionsService.is("suppressAutoSize")&&!i.suppressAutoSize;(e!==n||t!==r)&&(n=e,r=t,o(),s())};e(),this.addDestroyFunc(o),this.ctrl.addRefreshFunction(e)}onResizing(e,t){const i=this.normaliseResizeAmount(t),n=[{key:this.column,newWidth:this.resizeStartWidth+i}];this.columnModel.setColumnWidths(n,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.resizeWithShiftKey=e,this.comp.addOrRemoveCssClass("ag-column-resizing",!0)}normaliseResizeAmount(e){let t=e;const i="left"!==this.pinned,n="right"===this.pinned;return this.gridOptionsService.is("enableRtl")?i&&(t*=-1):n&&(t*=-1),t}}Wl([o("horizontalResizeService")],zl.prototype,"horizontalResizeService",void 0),Wl([o("columnModel")],zl.prototype,"columnModel",void 0),Wl([r],zl.prototype,"postConstruct",null);var jl=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Ul extends f{constructor(e){super(),this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1,this.column=e;const t=e.getColDef();this.filteredOnly=!!(null==t?void 0:t.headerCheckboxSelectionFilteredOnly),this.currentPageOnly=!!(null==t?void 0:t.headerCheckboxSelectionCurrentPageOnly)}onSpaceKeyDown(e){const t=this.cbSelectAll,i=this.gridOptionsService.getDocument();t.isDisplayed()&&!t.getGui().contains(i.activeElement)&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e,this.cbSelectAll=this.createManagedBean(new as),this.cbSelectAll.addCssClass("ag-header-select-all"),_i(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedListener(this.eventService,y.EVENT_NEW_COLUMNS_LOADED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,y.EVENT_SELECTION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_PAGINATION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_MODEL_UPDATED,this.onModelChanged.bind(this)),this.addManagedListener(this.cbSelectAll,as.EVENT_CHANGED,this.onCbSelectAll.bind(this)),Pi(this.cbSelectAll.getGui(),!0),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}showOrHideSelectAll(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible,{skipAriaHidden:!0}),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()}onModelChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}onSelectionChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}updateStateOfCheckbox(){if(this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const e=this.selectionService.getSelectAllState(this.filteredOnly,this.currentPageOnly);this.cbSelectAll.setValue(e),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(){const e=this.localeService.getLocaleTextFunc(),t=this.cbSelectAll.getValue()?e("ariaChecked","checked"):e("ariaUnchecked","unchecked"),i=e("ariaRowSelectAll","Press Space to toggle all rows selection");this.cbSelectAllVisible?this.headerCellCtrl.setAriaDescriptionProperty("selectAll",`${i} (${t})`):this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel(`${i} (${t})`),this.headerCellCtrl.refreshAriaDescription()}checkRightRowModelType(e){const t=this.rowModel.getType();return!("clientSide"!==t&&"serverSide"!==t)||(console.warn(`AG Grid: ${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox)return;if(!this.cbSelectAllVisible)return;const e=this.cbSelectAll.getValue();let t="uiSelectAll";this.currentPageOnly?t="uiSelectAllCurrentPage":this.filteredOnly&&(t="uiSelectAllFiltered");const i={source:t,justFiltered:this.filteredOnly,justCurrentPage:this.currentPageOnly};e?this.selectionService.selectAllRowNodes(i):this.selectionService.deselectAllRowNodes(i)}isCheckboxSelection(){let e=this.column.getColDef().headerCheckboxSelection;if("function"==typeof e){e=e({column:this.column,colDef:this.column.getColDef(),columnApi:this.columnApi,api:this.gridApi,context:this.gridOptionsService.context})}return!!e&&this.checkRightRowModelType("headerCheckboxSelection")}}jl([o("gridApi")],Ul.prototype,"gridApi",void 0),jl([o("columnApi")],Ul.prototype,"columnApi",void 0),jl([o("rowModel")],Ul.prototype,"rowModel",void 0),jl([o("selectionService")],Ul.prototype,"selectionService",void 0);var Yl,ql=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};!function(e){e.TAB_GUARD="ag-tab-guard",e.TAB_GUARD_TOP="ag-tab-guard-top",e.TAB_GUARD_BOTTOM="ag-tab-guard-bottom"}(Yl||(Yl={}));class Kl extends f{constructor(e){super(),this.skipTabGuardFocus=!1;const{comp:t,eTopGuard:i,eBottomGuard:n,focusInnerElement:r,onFocusIn:s,onFocusOut:o,shouldStopEventPropagation:a,onTabKeyDown:l,handleKeyDown:c,eFocusableElement:u}=e;this.comp=t,this.eTopGuard=i,this.eBottomGuard=n,this.providedFocusInnerElement=r,this.eFocusableElement=u,this.providedFocusIn=s,this.providedFocusOut=o,this.providedShouldStopEventPropagation=a,this.providedOnTabKeyDown=l,this.providedHandleKeyDown=c}postConstruct(){this.createManagedBean(new jr(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach(e=>this.addManagedListener(e,"focus",this.onFocus.bind(this)))}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return!!this.providedShouldStopEventPropagation&&this.providedShouldStopEventPropagation()}activateTabGuards(){const e=this.gridOptionsService.getNum("tabIndex")||0;this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.skipTabGuardFocus)return void(this.skipTabGuardFocus=!1);const t=e.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t)}onFocusIn(e){this.providedFocusIn&&this.providedFocusIn(e)||this.deactivateTabGuards()}onFocusOut(e){this.providedFocusOut&&this.providedFocusOut(e)||this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards()}onTabKeyDown(e){if(this.providedOnTabKeyDown)return void this.providedOnTabKeyDown(e);if(e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const i=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),i&&(i.focus(),e.preventDefault())}focusInnerElement(e=!1){const t=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length&&t[e?t.length-1:0].focus({preventScroll:!0})}getNextFocusableElement(e){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,t.focus()}}ql([o("focusService")],Kl.prototype,"focusService",void 0),ql([r],Kl.prototype,"postConstruct",null);var Xl,Ql=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Zl=Xl=class extends f{static addKeyboardModeEvents(e,t){const i=Xl.instancesMonitored.get(e);i&&i.length>0?-1===i.indexOf(t)&&i.push(t):(Xl.instancesMonitored.set(e,[t]),e.addEventListener("keydown",Xl.toggleKeyboardMode),e.addEventListener("mousedown",Xl.toggleKeyboardMode))}static removeKeyboardModeEvents(e,t){const i=Xl.instancesMonitored.get(e);let n=[];i&&i.length&&(n=[...i].filter(e=>e!==t),Xl.instancesMonitored.set(e,n)),0===n.length&&(e.removeEventListener("keydown",Xl.toggleKeyboardMode),e.removeEventListener("mousedown",Xl.toggleKeyboardMode))}static toggleKeyboardMode(e){const t=Xl.keyboardModeActive,i="keydown"===e.type;if(i&&(e.ctrlKey||e.metaKey||e.altKey))return;if(t&&i||!t&&!i)return;Xl.keyboardModeActive=i;const n=e.target.ownerDocument;if(!n)return;const r=Xl.instancesMonitored.get(n);r&&r.forEach(e=>{e.dispatchEvent({type:i?y.EVENT_KEYBOARD_FOCUS:y.EVENT_MOUSE_FOCUS})})}init(){const e=this.clearFocusedCell.bind(this);this.addManagedListener(this.eventService,y.EVENT_COLUMN_PIVOT_MODE_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverythingChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_GROUP_OPENED,e),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.ctrlsService.whenReady(e=>{this.gridCtrl=e.gridCtrl;const t=this.gridOptionsService.getDocument();Xl.addKeyboardModeEvents(t,this.gridCtrl),this.addDestroyFunc(()=>this.unregisterGridCompController(this.gridCtrl))})}unregisterGridCompController(e){const t=this.gridOptionsService.getDocument();Xl.removeKeyboardModeEvents(t,e)}onColumnEverythingChanged(){if(!this.focusedCellPosition)return;const e=this.focusedCellPosition.column,t=this.columnModel.getGridColumn(e.getId());e!==t&&this.clearFocusedCell()}isKeyboardMode(){return Xl.keyboardModeActive}getFocusCellToUseAfterRefresh(){const e=this.gridOptionsService.getDocument();return this.gridOptionsService.is("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(e.activeElement,La.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition}getFocusHeaderToUseAfterRefresh(){const e=this.gridOptionsService.getDocument();return this.gridOptionsService.is("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(e.activeElement,Ll.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition}isDomDataMissingInHierarchy(e,t){let i=e;for(;i;){if(this.gridOptionsService.getDomData(i,t))return!1;i=i.parentNode}return!0}getFocusedCell(){return this.focusedCellPosition}shouldRestoreFocus(e){return!!this.isCellRestoreFocused(e)&&(setTimeout(()=>{this.restoredFocusedCellPosition=null},0),!0)}isCellRestoreFocused(e){return null!=this.restoredFocusedCellPosition&&this.cellPositionUtils.equals(e,this.restoredFocusedCellPosition)}setRestoreFocusedCell(e){"react"===this.getFrameworkOverrides().renderingEngine&&(this.restoredFocusedCellPosition=e)}getFocusEventParams(){const{rowIndex:e,rowPinned:t,column:i}=this.focusedCellPosition,n={rowIndex:e,rowPinned:t,column:i,isFullWidthCell:!1},r=this.rowRenderer.getRowByPosition({rowIndex:e,rowPinned:t});return r&&(n.isFullWidthCell=r.isFullWidth()),n}clearFocusedCell(){if(this.restoredFocusedCellPosition=null,null==this.focusedCellPosition)return;const e=Object.assign({type:y.EVENT_CELL_FOCUS_CLEARED},this.getFocusEventParams());this.focusedCellPosition=null,this.eventService.dispatchEvent(e)}setFocusedCell(e){const{column:t,rowIndex:i,rowPinned:n,forceBrowserFocus:r=!1,preventScrollOnBrowserFocus:s=!1}=e,o=this.columnModel.getGridColumn(t);if(!o)return void(this.focusedCellPosition=null);this.focusedCellPosition=o?{rowIndex:i,rowPinned:J(n),column:o}:null;const a=Object.assign(Object.assign({type:y.EVENT_CELL_FOCUSED},this.getFocusEventParams()),{forceBrowserFocus:r,preventScrollOnBrowserFocus:s,floating:null});this.eventService.dispatchEvent(a)}isCellFocused(e){return null!=this.focusedCellPosition&&this.cellPositionUtils.equals(e,this.focusedCellPosition)}isRowNodeFocused(e){return this.isRowFocused(e.rowIndex,e.rowPinned)}isHeaderWrapperFocused(e){if(null==this.focusedHeaderPosition)return!1;const t=e.getColumnGroupChild(),i=e.getRowIndex(),n=e.getPinned(),{column:r,headerRowIndex:s}=this.focusedHeaderPosition;return t===r&&i===s&&n==r.getPinned()}clearFocusedHeader(){this.focusedHeaderPosition=null}getFocusedHeader(){return this.focusedHeaderPosition}setFocusedHeader(e,t){this.focusedHeaderPosition={headerRowIndex:e,column:t}}focusHeaderPosition(e){const{direction:t,fromTab:i,allowUserOverride:n,event:r}=e;let{headerPosition:s}=e;if(n){const e=this.getFocusedHeader(),n=this.headerNavigationService.getHeaderRowCount();if(i){const i=this.gridOptionsService.getCallback("tabToNextHeader");if(i){s=i({backwards:"Before"===t,previousHeaderPosition:e,nextHeaderPosition:s,headerRowCount:n})}}else{const t=this.gridOptionsService.getCallback("navigateToNextHeader");if(t&&r){s=t({key:r.key,previousHeaderPosition:e,nextHeaderPosition:s,headerRowCount:n,event:r})}}}if(!s)return!1;if(-1===s.headerRowIndex)return this.focusGridView(s.column);this.headerNavigationService.scrollToColumn(s.column,t);return this.ctrlsService.getHeaderRowContainerCtrl(s.column.getPinned()).focusHeader(s.headerRowIndex,s.column,r)}focusFirstHeader(){let e=this.columnModel.getAllDisplayedColumns()[0];return!!e&&(e.getParent()&&(e=this.columnModel.getColumnGroupAtLevel(e,0)),this.focusHeaderPosition({headerPosition:{headerRowIndex:0,column:e}}))}focusLastHeader(e){const t=this.headerNavigationService.getHeaderRowCount()-1,i=p(this.columnModel.getAllDisplayedColumns());return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:i},event:e})}isAnyCellFocused(){return!!this.focusedCellPosition}isRowFocused(e,t){return null!=this.focusedCellPosition&&(this.focusedCellPosition.rowIndex===e&&this.focusedCellPosition.rowPinned===J(t))}findFocusableElements(e,t,i=!1){const n=xn;let r=Dn;t&&(r+=", "+t),i&&(r+=', [tabindex="-1"]');const s=Array.prototype.slice.apply(e.querySelectorAll(n)),o=Array.prototype.slice.apply(e.querySelectorAll(r));if(!o.length)return s;return a=o,s.filter(e=>-1===a.indexOf(e));var a}focusInto(e,t=!1,i=!1){const n=this.findFocusableElements(e,null,i),r=t?p(n):n[0];return!!r&&(r.focus({preventScroll:!0}),!0)}findFocusableElementBeforeTabGuard(e,t){if(!t)return null;const i=this.findFocusableElements(e),n=i.indexOf(t);if(-1===n)return null;let r=-1;for(let e=n-1;e>=0;e--)if(i[e].classList.contains(Yl.TAB_GUARD_TOP)){r=e;break}return r<=0?null:i[r-1]}findNextFocusableElement(e=this.eGridDiv,t,i){const n=this.findFocusableElements(e,t?':not([tabindex="-1"])':null),r=this.gridOptionsService.getDocument().activeElement;let s;s=t?n.findIndex(e=>e.contains(r)):n.indexOf(r);const o=s+(i?-1:1);return o<0||o>=n.length?null:n[o]}isTargetUnderManagedComponent(e,t){if(!t)return!1;const i=e.querySelectorAll("."+jr.FOCUS_MANAGED_CLASS);if(!i.length)return!1;for(let e=0;e<i.length;e++)if(i[e].contains(t))return!0;return!1}findTabbableParent(e,t=5){let i=0;for(;e&&null===sn(e)&&++i<=t;)e=e.parentElement;return null===sn(e)?null:e}focusGridView(e,t){if(this.gridOptionsService.is("suppressCellFocus"))return t?this.focusLastHeader():this.focusNextGridCoreContainer(!1);const i=t?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(!i)return!1;const{rowIndex:n,rowPinned:r}=i,s=this.getFocusedHeader();if(!e&&s&&(e=s.column),null==n||!e)return!1;if(this.navigationService.ensureCellVisible({rowIndex:n,column:e,rowPinned:r}),this.setFocusedCell({rowIndex:n,column:e,rowPinned:J(r),forceBrowserFocus:!0}),this.rangeService){const t={rowIndex:n,rowPinned:r,column:e};this.rangeService.setRangeToCell(t)}return!0}focusNextGridCoreContainer(e,t=!1){return!(t||!this.gridCtrl.focusNextInnerContainer(e))||((t||!e&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(e),!1)}};Zl.AG_KEYBOARD_FOCUS="ag-keyboard-focus",Zl.keyboardModeActive=!1,Zl.instancesMonitored=new Map,Ql([o("eGridDiv")],Zl.prototype,"eGridDiv",void 0),Ql([o("columnModel")],Zl.prototype,"columnModel",void 0),Ql([o("headerNavigationService")],Zl.prototype,"headerNavigationService",void 0),Ql([o("rowRenderer")],Zl.prototype,"rowRenderer",void 0),Ql([o("rowPositionUtils")],Zl.prototype,"rowPositionUtils",void 0),Ql([o("cellPositionUtils")],Zl.prototype,"cellPositionUtils",void 0),Ql([c("rangeService")],Zl.prototype,"rangeService",void 0),Ql([o("navigationService")],Zl.prototype,"navigationService",void 0),Ql([o("ctrlsService")],Zl.prototype,"ctrlsService",void 0),Ql([r],Zl.prototype,"init",null),Zl=Xl=Ql([s("focusService")],Zl);var Jl=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class ec extends Ll{constructor(e,t){super(e,t),this.refreshFunctions=[],this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map,this.column=e}setComp(e,t,i,n){super.setGui(t),this.comp=e,this.updateState(),this.setupWidth(),this.setupMovingCss(),this.setupMenuClass(),this.setupSortableClass(),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight(n),this.addColumnHoverListener(),this.setupFilterCss(),this.setupColId(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(),this.setupSelectAll(),this.setupUserComp(),this.refreshAria(),this.createManagedBean(new zl(this.getPinned(),this.column,i,e,this)),this.createManagedBean(new Hl([this.column],t)),this.createManagedBean(new Gl(this.column,t,this.beans)),this.createManagedBean(new jr(t,{shouldStopEventPropagation:e=>this.shouldStopEventPropagation(e),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addMouseDownListenerIfNeeded(t),this.addManagedListener(this.column,d.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_VALUE_CHANGED,this.onColumnValueChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onColumnRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PIVOT_CHANGED,this.onColumnPivotChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}addMouseDownListenerIfNeeded(i){if(!Qi())return;const n=this.gridOptionsService.getDocument();["mousedown","touchstart"].forEach(e=>{this.addManagedListener(i,e,e=>{const t=n.activeElement;t===i||i.contains(t)||(i.focus(),Zl.toggleKeyboardMode(e))})})}setupUserComp(){const e=this.lookupUserCompDetails();this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){const e=this.createParams(),t=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(t,e)}createParams(){const e=this.column.getColDef();return{column:this.column,displayName:this.displayName,enableSorting:e.sortable,enableMenu:this.menuEnabled,showColumnMenu:e=>{this.gridApi.showColumnMenuAfterButtonClick(this.column,e)},progressSort:e=>{this.sortController.progressSort(this.column,!!e,"uiColumnSorted")},setSort:(e,t)=>{this.sortController.setSortForColumn(this.column,e,!!t,"uiColumnSorted")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsService.context,eGridHeader:this.getGui()}}setupSelectAll(){this.selectAllFeature=this.createManagedBean(new Ul(this.column)),this.selectAllFeature.setComp(this)}getSelectAllGui(){return this.selectAllFeature.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===A.SPACE&&this.selectAllFeature.onSpaceKeyDown(e),e.key===A.ENTER&&this.onEnterKeyDown(e)}onEnterKeyDown(e){const t=this.comp.getUserCompInstance();if(t)if(e.ctrlKey||e.metaKey)this.menuEnabled&&t.showMenu&&(e.preventDefault(),t.showMenu());else if(this.sortable){const t=e.shiftKey;this.sortController.progressSort(this.column,t,"uiColumnSorted")}}isMenuEnabled(){return this.menuEnabled}onFocusIn(e){if(!this.getGui().contains(e.relatedTarget)){const e=this.getRowIndex();this.focusService.setFocusedHeader(e,this.column)}this.setActiveHeader(!0)}onFocusOut(e){this.getGui().contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(){const e={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getGui:()=>this.eGui,getLocation:()=>"header",getTooltipValue:()=>this.column.getColDef().headerTooltip},t=this.createManagedBean(new xa(e,this.beans));t.setComp(this.comp),this.refreshFunctions.push(()=>t.refreshToolTip())}setupClassesFromColDef(){const e=()=>{const e=this.column.getColDef(),t=Tl.getHeaderClassesFromColDef(e,this.gridOptionsService,this.column,null),i=this.userHeaderClasses;this.userHeaderClasses=new Set(t),t.forEach(e=>{i.has(e)?i.delete(e):this.comp.addOrRemoveCssClass(e,!0)}),i.forEach(e=>this.comp.addOrRemoveCssClass(e,!1))};this.refreshFunctions.push(e),e()}setDragSource(e){if(this.dragSourceElement=e,this.removeDragSource(),!e)return;if(!this.draggable)return;const i=!this.gridOptionsService.is("suppressDragLeaveHidesColumns");this.moveDragSource={type:Js.HeaderCell,eElement:e,defaultIconName:i?M.ICON_HIDE:M.ICON_NOT_ALLOWED,getDragItem:()=>this.createDragItem(),dragItemName:this.displayName,onDragStarted:()=>this.column.setMoving(!0,"uiColumnMoved"),onDragStopped:()=>this.column.setMoving(!1,"uiColumnMoved"),onGridEnter:e=>{var t;if(i){const i=(null===(t=null==e?void 0:e.columns)||void 0===t?void 0:t.filter(e=>!e.getColDef().lockVisible))||[];this.columnModel.setColumnsVisible(i,!0,"uiColumnMoved")}},onGridExit:e=>{var t;if(i){const i=(null===(t=null==e?void 0:e.columns)||void 0===t?void 0:t.filter(e=>!e.getColDef().lockVisible))||[];this.columnModel.setColumnsVisible(i,!1,"uiColumnMoved")}}},this.dragAndDropService.addDragSource(this.moveDragSource,!0)}createDragItem(){const e={};return e[this.column.getId()]=this.column.isVisible(),{columns:[this.column],visibleState:e}}removeDragSource(){this.moveDragSource&&(this.dragAndDropService.removeDragSource(this.moveDragSource),this.moveDragSource=void 0)}onColDefChanged(){this.refresh()}updateState(){const e=this.column.getColDef();this.menuEnabled=this.menuFactory.isMenuEnabled(this.column)&&!e.suppressMenu,this.sortable=e.sortable,this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}addRefreshFunction(e){this.refreshFunctions.push(e)}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),this.refreshFunctions.forEach(e=>e())}refreshHeaderComp(){const e=this.lookupUserCompDetails();!!(null!=this.comp.getUserCompInstance()&&this.userCompDetails.componentClass==e.componentClass)&&this.attemptHeaderCompRefresh(e.params)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();if(!t)return!1;if(!t.refresh)return!1;return t.refresh(e)}calculateDisplayName(){return this.columnModel.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gridOptionsService.is("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}onColumnRowGroupChanged(){this.checkDisplayName()}onColumnPivotChanged(){this.checkDisplayName()}onColumnValueChanged(){this.checkDisplayName()}setupWidth(){const e=()=>{const e=this.column.getActualWidth();this.comp.setWidth(e+"px")};this.addManagedListener(this.column,d.EVENT_WIDTH_CHANGED,e),e()}setupMovingCss(){const e=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving())};this.addManagedListener(this.column,d.EVENT_MOVING_CHANGED,e),e()}setupMenuClass(){const e=()=>{this.comp.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())};this.addManagedListener(this.column,d.EVENT_MENU_VISIBLE_CHANGED,e),e()}setupSortableClass(){const e=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!this.sortable)};e(),this.addRefreshFunction(e),this.addManagedListener(this.eventService,d.EVENT_SORT_CHANGED,this.refreshAriaSort.bind(this))}setupWrapTextClass(){const e=()=>{const e=!!this.column.getColDef().wrapHeaderText;this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",e)};e(),this.addRefreshFunction(e)}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui:e,column:t,comp:i,columnModel:n,gridOptionsService:r}=this;if(!t.isSpanHeaderHeight())return;const{numberOfParents:s,isSpanningTotal:o}=this.getColumnGroupPaddingInfo();if(i.addOrRemoveCssClass("ag-header-span-height",s>0),0===s)return;i.addOrRemoveCssClass("ag-header-span-total",o);const a=r.is("pivotMode")?n.getPivotGroupHeaderHeight():n.getGroupHeaderHeight(),l=n.getColumnHeaderRowHeight(),c=s*a;e.style.setProperty("top",-c+"px"),e.style.setProperty("height",l+c+"px")}getColumnGroupPaddingInfo(){let e=this.column.getParent();if(!e||!e.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const t=e.getPaddingLevel()+1;let i=!0;for(;e;){if(!e.isPadding()){i=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:i}}setupAutoHeight(a){const l=e=>{if(!this.isAlive())return;const{paddingTop:t,paddingBottom:i,borderBottomWidth:n,borderTopWidth:r}=In(this.getGui()),s=t+i+n+r,o=a.offsetHeight+s;if(e<5){const t=this.beans.gridOptionsService.getDocument(),i=0==o;if(!t||!t.contains(a)||i)return void this.beans.frameworkOverrides.setTimeout(()=>l(e+1),0)}this.columnModel.setColumnHeaderHeight(this.column,o)};let e,t=!1;const i=()=>{const e=this.column.isAutoHeaderHeight();e&&!t&&n(),!e&&t&&r()},n=()=>{t=!0,l(0),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),e=this.resizeObserverService.observeResize(a,()=>l(0))},r=()=>{t=!1,e&&e(),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),e=void 0};i(),this.addDestroyFunc(()=>r()),this.addManagedListener(this.column,d.EVENT_WIDTH_CHANGED,()=>t&&l(0)),this.addManagedListener(this.eventService,d.EVENT_SORT_CHANGED,()=>{t&&this.beans.frameworkOverrides.setTimeout(()=>l(0))}),this.addRefreshFunction(i)}refreshAriaSort(){if(this.sortable){const e=this.localeService.getLocaleTextFunc(),t=this.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(Ai(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort."))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press CTRL ENTER to open column menu."))}else this.setAriaDescriptionProperty("menu",null)}setAriaDescriptionProperty(e,t){null!=t?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}refreshAriaDescription(){const e=Array.from(this.ariaDescriptionProperties.values());this.comp.setAriaDescription(e.length?e.join(" "):void 0)}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaDescription()}addColumnHoverListener(){const e=()=>{if(!this.gridOptionsService.is("columnHoverHighlight"))return;const e=this.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",e)};this.addManagedListener(this.eventService,y.EVENT_COLUMN_HOVER_CHANGED,e),e()}setupFilterCss(){const e=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-filtered",this.column.isFilterActive())};this.addManagedListener(this.column,d.EVENT_FILTER_ACTIVE_CHANGED,e),e()}setupColId(){this.comp.setColId(this.column.getColId())}addActiveHeaderMouseListeners(){const e=e=>this.setActiveHeader("mouseenter"===e.type);this.addManagedListener(this.getGui(),"mouseenter",e),this.addManagedListener(this.getGui(),"mouseleave",e)}setActiveHeader(e){this.comp.addOrRemoveCssClass("ag-header-active",e)}}Jl([o("columnModel")],ec.prototype,"columnModel",void 0),Jl([o("columnHoverService")],ec.prototype,"columnHoverService",void 0),Jl([o("sortController")],ec.prototype,"sortController",void 0),Jl([o("menuFactory")],ec.prototype,"menuFactory",void 0),Jl([o("dragAndDropService")],ec.prototype,"dragAndDropService",void 0),Jl([o("resizeObserverService")],ec.prototype,"resizeObserverService",void 0),Jl([o("gridApi")],ec.prototype,"gridApi",void 0),Jl([o("columnApi")],ec.prototype,"columnApi",void 0),Jl([Ve],ec.prototype,"removeDragSource",null);var tc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class ic extends f{constructor(e,t,i,n){super(),this.eResize=t,this.comp=e,this.pinned=i,this.columnGroup=n}postConstruct(){if(!this.columnGroup.isResizable())return void this.comp.setResizableDisplayed(!1);const e=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(e),!this.gridOptionsService.is("suppressAutoSize")){const e=this.gridOptionsService.is("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",()=>{const t=[];this.columnGroup.getDisplayedLeafColumns().forEach(e=>{e.getColDef().suppressAutoSize||t.push(e.getColId())}),t.length>0&&this.columnModel.autoSizeColumns({columns:t,skipHeader:e,stopAtGroup:this.columnGroup,source:"uiColumnResized"}),this.resizeLeafColumnsToFit("uiColumnResized")})}}onResizeStart(e){this.calculateInitialValues();let t=null;if(e&&(t=this.columnModel.getDisplayedGroupAfter(this.columnGroup)),t){const e=t.getDisplayedLeafColumns();this.resizeTakeFromCols=e.filter(e=>e.isResizable()),this.resizeTakeFromStartWidth=0,this.resizeTakeFromCols.forEach(e=>this.resizeTakeFromStartWidth+=e.getActualWidth()),this.resizeTakeFromRatios=[],this.resizeTakeFromCols.forEach(e=>this.resizeTakeFromRatios.push(e.getActualWidth()/this.resizeTakeFromStartWidth))}else this.resizeTakeFromCols=null,this.resizeTakeFromStartWidth=null,this.resizeTakeFromRatios=null;this.comp.addOrRemoveCssClass("ag-column-resizing",!0)}onResizing(e,t,i="uiColumnResized"){const n=this.normaliseDragChange(t),r=this.resizeStartWidth+n;this.resizeColumns(r,i,e)}resizeLeafColumnsToFit(e){const t=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup);this.calculateInitialValues(),t>this.resizeStartWidth&&this.resizeColumns(t,e,!0)}resizeColumns(e,t,i=!0){const n=[];if(n.push({columns:this.resizeCols,ratios:this.resizeRatios,width:e}),this.resizeTakeFromCols){const t=e-this.resizeStartWidth;n.push({columns:this.resizeTakeFromCols,ratios:this.resizeTakeFromRatios,width:this.resizeTakeFromStartWidth-t})}this.columnModel.resizeColumnSets({resizeSets:n,finished:i,source:t}),i&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)}calculateInitialValues(){const e=this.columnGroup.getDisplayedLeafColumns();this.resizeCols=e.filter(e=>e.isResizable()),this.resizeStartWidth=0,this.resizeCols.forEach(e=>this.resizeStartWidth+=e.getActualWidth()),this.resizeRatios=[],this.resizeCols.forEach(e=>this.resizeRatios.push(e.getActualWidth()/this.resizeStartWidth))}normaliseDragChange(e){let t=e;return this.gridOptionsService.is("enableRtl")?"left"!==this.pinned&&(t*=-1):"right"===this.pinned&&(t*=-1),t}}tc([o("horizontalResizeService")],ic.prototype,"horizontalResizeService",void 0),tc([o("autoWidthCalculator")],ic.prototype,"autoWidthCalculator",void 0),tc([o("columnModel")],ic.prototype,"columnModel",void 0),tc([r],ic.prototype,"postConstruct",null);var nc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class rc extends f{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListener(this.columnGroup,g.EVENT_DISPLAYED_CHILDREN_CHANGED,this.onDisplayedChildrenChanged.bind(this)),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const t=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(e=>{e.addEventListener("widthChanged",t),e.addEventListener("visibleChanged",t),this.removeChildListenersFuncs.push(()=>{e.removeEventListener("widthChanged",t),e.removeEventListener("visibleChanged",t)})})}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach(e=>e()),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(e+"px"),this.comp.addOrRemoveCssClass("ag-hidden",0===e)}}nc([r],rc.prototype,"postConstruct",null);var sc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class oc extends Ll{constructor(e,t){super(e,t),this.columnGroup=e}setComp(e,t,i){super.setGui(t),this.comp=e,this.displayName=this.columnModel.getDisplayNameForColumnGroup(this.columnGroup,"header"),this.addClasses(),this.addAttributes(),this.setupMovingCss(),this.setupExpandable(),this.setupTooltip(),this.setupUserComp();const n=this.getParentRowCtrl().getPinned(),r=this.columnGroup.getProvidedColumnGroup().getLeafColumns();this.createManagedBean(new Hl(r,t)),this.createManagedBean(new Gl(this.columnGroup,t,this.beans)),this.createManagedBean(new rc(e,this.columnGroup)),this.groupResizeFeature=this.createManagedBean(new ic(e,i,n,this.columnGroup)),this.createManagedBean(new jr(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}resizeLeafColumnsToFit(e){this.groupResizeFeature&&this.groupResizeFeature.resizeLeafColumnsToFit(e)}setupUserComp(){let i=this.displayName;const e={displayName:this.displayName,columnGroup:this.columnGroup,setExpanded:e=>{this.columnModel.setColumnGroupOpened(this.columnGroup.getProvidedColumnGroup(),e,"gridInitializing")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsService.context};if(!i){let e=this.columnGroup;const n=e.getLeafColumns();for(;e.getParent()&&e.getParent().getLeafColumns().length===n.length;)e=e.getParent();const t=e.getColGroupDef();t&&(i=t.headerName),i||(i=n?this.columnModel.getDisplayNameForColumn(n[0],"header",!0):"")}const n=this.userComponentFactory.getHeaderGroupCompDetails(e);this.comp.setUserCompDetails(n)}setupTooltip(){const e=this.columnGroup.getColGroupDef(),t={getColumn:()=>this.columnGroup,getGui:()=>this.eGui,getLocation:()=>"headerGroup",getTooltipValue:()=>e&&e.headerTooltip};e&&(t.getColDef=()=>e);this.createManagedBean(new xa(t,this.beans)).setComp(this.comp)}setupExpandable(){const e=this.columnGroup.getProvidedColumnGroup();this.refreshExpanded(),this.addManagedListener(e,h.EVENT_EXPANDABLE_CHANGED,this.refreshExpanded.bind(this)),this.addManagedListener(e,h.EVENT_EXPANDED_CHANGED,this.refreshExpanded.bind(this))}refreshExpanded(){const e=this.columnGroup;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0)}addAttributes(){this.comp.setColId(this.columnGroup.getUniqueId())}addClasses(){const e=this.columnGroup.getColGroupDef(),t=Tl.getHeaderClassesFromColDef(e,this.gridOptionsService,null,this.columnGroup);if(this.columnGroup.isPadding()){t.push("ag-header-group-cell-no-group");this.columnGroup.getLeafColumns().every(e=>e.isSpanHeaderHeight())&&t.push("ag-header-span-height")}else t.push("ag-header-group-cell-with-group");t.forEach(e=>this.comp.addOrRemoveCssClass(e,!0))}setupMovingCss(){const e=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),t=()=>this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.columnGroup.isMoving());e.forEach(e=>{this.addManagedListener(e,d.EVENT_MOVING_CHANGED,t)}),t()}onFocusIn(e){if(!this.eGui.contains(e.relatedTarget)){const e=this.getRowIndex();this.beans.focusService.setFocusedHeader(e,this.columnGroup)}}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();if(this.expandable&&t&&e.key===A.ENTER){const e=this.columnGroup,t=!e.isExpanded();this.columnModel.setColumnGroupOpened(e.getProvidedColumnGroup(),t,"uiColumnExpanded")}}setDragSource(e){if(this.isSuppressMoving())return;const t=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),i=!this.gridOptionsService.is("suppressDragLeaveHidesColumns"),n={type:Js.HeaderCell,eElement:e,defaultIconName:i?M.ICON_HIDE:M.ICON_NOT_ALLOWED,dragItemName:this.displayName,getDragItem:this.getDragItemForGroup.bind(this),onDragStarted:()=>t.forEach(e=>e.setMoving(!0,"uiColumnDragged")),onDragStopped:()=>t.forEach(e=>e.setMoving(!1,"uiColumnDragged")),onGridEnter:e=>{var t;if(i){const i=(null===(t=null==e?void 0:e.columns)||void 0===t?void 0:t.filter(e=>!e.getColDef().lockVisible))||[];this.columnModel.setColumnsVisible(i,!0,"uiColumnMoved")}},onGridExit:e=>{var t;if(i){const i=(null===(t=null==e?void 0:e.columns)||void 0===t?void 0:t.filter(e=>!e.getColDef().lockVisible))||[];this.columnModel.setColumnsVisible(i,!1,"uiColumnMoved")}}};this.dragAndDropService.addDragSource(n,!0),this.addDestroyFunc(()=>this.dragAndDropService.removeDragSource(n))}getDragItemForGroup(){const t=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),i={};t.forEach(e=>i[e.getId()]=e.isVisible());const n=[];return this.columnModel.getAllDisplayedColumns().forEach(e=>{t.indexOf(e)>=0&&(n.push(e),ot(t,e))}),t.forEach(e=>n.push(e)),{columns:n,visibleState:i}}isSuppressMoving(){let t=!1;this.columnGroup.getLeafColumns().forEach(e=>{(e.getColDef().suppressMovable||e.getColDef().lockPosition)&&(t=!0)});return t||this.gridOptionsService.is("suppressMovableColumns")}}sc([o("columnModel")],oc.prototype,"columnModel",void 0),sc([o("dragAndDropService")],oc.prototype,"dragAndDropService",void 0),sc([o("gridApi")],oc.prototype,"gridApi",void 0),sc([o("columnApi")],oc.prototype,"columnApi",void 0);var ac=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let lc=0;class cc extends f{constructor(e,t,i){super(),this.instanceId=lc++,this.headerCellCtrls={},this.rowIndex=e,this.pinned=t,this.type=i}getInstanceId(){return this.instanceId}setComp(e){this.comp=e,this.onRowHeightChanged(),this.onVirtualColumnsChanged(),this.setWidth(),this.addEventListeners(),Qi()&&this.comp.setTransform("translateZ(0)"),e.setAriaRowIndex(this.rowIndex+1)}addEventListeners(){this.addManagedListener(this.eventService,y.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_GRID_STYLES_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),this.addManagedPropertyListener("headerHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("groupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotGroupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("floatingFiltersHeight",this.onRowHeightChanged.bind(this))}getHeaderCellCtrl(t){return le(this.headerCellCtrls).find(e=>e.getColumnGroupChild()===t)}onDisplayedColumnsChanged(){this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}getType(){return this.type}onColumnResized(){this.setWidth()}setWidth(){const e=this.getWidthForRow();this.comp.setWidth(e+"px")}getWidthForRow(){if(this.gridOptionsService.isDomLayout("print")){return null!=this.pinned?0:this.columnModel.getContainerWidth("right")+this.columnModel.getContainerWidth("left")+this.columnModel.getContainerWidth(null)}return this.columnModel.getContainerWidth(this.pinned)}onRowHeightChanged(){let e=this.columnModel.getHeaderRowCount();const t=[];let i=0;this.columnModel.hasFloatingFilters()&&(e++,i=1);const n=this.columnModel.getColumnGroupHeaderRowHeight(),r=this.columnModel.getColumnHeaderRowHeight(),s=e-(1+i);for(let e=0;e<s;e++)t.push(n);t.push(r);for(let e=0;e<i;e++)t.push(this.columnModel.getFloatingFiltersHeight());let o=0;for(let e=0;e<this.rowIndex;e++)o+=t[e];const a=t[this.rowIndex]+"px";this.comp.setTop(o+"px"),this.comp.setHeight(a)}getPinned(){return this.pinned}getRowIndex(){return this.rowIndex}onVirtualColumnsChanged(){const n=this.headerCellCtrls;this.headerCellCtrls={};this.getColumnsInViewport().forEach(e=>{if(e.isEmptyGroup())return;const t=e.getUniqueId();let i=n[t];delete n[t];if(i&&i.getColumnGroupChild()!=e&&(this.destroyBean(i),i=void 0),null==i)switch(this.type){case Nl.FLOATING_FILTER:i=this.createBean(new Vl(e,this));break;case Nl.COLUMN_GROUP:i=this.createBean(new oc(e,this));break;default:i=this.createBean(new ec(e,this))}this.headerCellCtrls[t]=i});const i=e=>{if(!this.focusService.isHeaderWrapperFocused(e))return!1;return this.columnModel.isDisplayed(e.getColumnGroupChild())};a(n,(e,t)=>{i(t)?this.headerCellCtrls[e]=t:this.destroyBean(t)});const e=ye(this.headerCellCtrls);this.comp.setHeaderCtrls(e)}getColumnsInViewport(){return this.gridOptionsService.isDomLayout("print")?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}getColumnsInViewportPrintLayout(){if(null!=this.pinned)return[];let i=[];const n=this.getActualDepth();return["left",null,"right"].forEach(e=>{const t=this.columnModel.getVirtualHeaderGroupRow(e,n);i=i.concat(t)}),i}getActualDepth(){return this.type==Nl.FLOATING_FILTER?this.rowIndex-1:this.rowIndex}getColumnsInViewportNormalLayout(){return this.columnModel.getVirtualHeaderGroupRow(this.pinned,this.getActualDepth())}focusHeader(t,e){const i=ye(this.headerCellCtrls).find(e=>e.getColumnGroupChild()==t);return!!i&&(i.focus(e),!0)}destroy(){a(this.headerCellCtrls,(e,t)=>{this.destroyBean(t)}),this.headerCellCtrls={},super.destroy()}}ac([o("columnModel")],cc.prototype,"columnModel",void 0),ac([o("focusService")],cc.prototype,"focusService",void 0);var uc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class dc extends f{constructor(e){super(),this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[],this.pinned=e}setComp(e,t){this.comp=e,this.eViewport=t,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport),this.addManagedListener(this.eventService,y.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.ctrlsService.registerHeaderContainer(this,this.pinned),this.columnModel.isReady()&&this.refresh()}setupDragAndDrop(e){const t=new Sl(this.pinned,e);this.createManagedBean(t)}refresh(i=!1){const n=new xr,e=this.focusService.getFocusHeaderToUseAfterRefresh();(()=>{const t=this.columnModel.getHeaderRowCount()-1;this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls);for(let e=0;e<t;e++){const t=this.createBean(new cc(n.next(),this.pinned,Nl.COLUMN_GROUP));this.groupsRowCtrls.push(t)}})(),(()=>{const e=n.next(),t=!(this.hidden||null!=this.columnsRowCtrl&&i&&this.columnsRowCtrl.getRowIndex()===e);(t||this.hidden)&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),t&&(this.columnsRowCtrl=this.createBean(new cc(e,this.pinned,Nl.COLUMN)))})(),(()=>{this.includeFloatingFilter=this.columnModel.hasFloatingFilters()&&!this.hidden;const e=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter)return void e();const t=n.next();if(this.filtersRowCtrl){const n=this.filtersRowCtrl.getRowIndex()!==t;i&&!n||e()}this.filtersRowCtrl||(this.filtersRowCtrl=this.createBean(new cc(t,this.pinned,Nl.FLOATING_FILTER)))})();const t=this.getAllCtrls();this.comp.setCtrls(t),this.restoreFocusOnHeader(e)}restoreFocusOnHeader(e){null!=e&&e.column.getPinned()==this.pinned&&this.focusService.focusHeaderPosition({headerPosition:e})}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}onGridColumnsChanged(){this.refresh(!0)}onDisplayedColumnsChanged(){const e=this.columnModel.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==e&&this.refresh(!0)}setupCenterWidth(){null==this.pinned&&this.createManagedBean(new Xa(e=>this.comp.setCenterWidth(e+"px"),!0))}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}setupPinnedWidth(){if(null==this.pinned)return;const o="left"===this.pinned,a="right"===this.pinned;this.hidden=!0;const e=()=>{const e=o?this.pinnedWidthService.getPinnedLeftWidth():this.pinnedWidthService.getPinnedRightWidth();if(null==e)return;const t=0==e,i=this.hidden!==t,n=this.gridOptionsService.is("enableRtl"),r=this.gridOptionsService.getScrollbarWidth(),s=this.scrollVisibleService.isVerticalScrollShowing()&&(n&&o||!n&&a)?e+r:e;this.comp.setPinnedContainerWidth(s+"px"),this.comp.setDisplayed(!t),i&&(this.hidden=t,this.refresh())};this.addManagedListener(this.eventService,y.EVENT_LEFT_PINNED_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_RIGHT_PINNED_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_SCROLL_VISIBILITY_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_SCROLLBAR_WIDTH_CHANGED,e)}getHeaderCtrlForColumn(i){if(i instanceof d){if(!this.columnsRowCtrl)return;return this.columnsRowCtrl.getHeaderCellCtrl(i)}if(0!==this.groupsRowCtrls.length)for(let t=0;t<this.groupsRowCtrls.length;t++){const e=this.groupsRowCtrls[t].getHeaderCellCtrl(i);if(e)return e}}getHtmlElementForColumnHeader(e){const t=this.getHeaderCtrlForColumn(e);return t?t.getGui():null}getRowType(e){const t=this.getAllCtrls()[e];return t?t.getType():void 0}focusHeader(e,t,i){const n=this.getAllCtrls()[e];return!!n&&n.focusHeader(t,i)}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}destroy(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),super.destroy()}}uc([o("ctrlsService")],dc.prototype,"ctrlsService",void 0),uc([o("scrollVisibleService")],dc.prototype,"scrollVisibleService",void 0),uc([o("pinnedWidthService")],dc.prototype,"pinnedWidthService",void 0),uc([o("columnModel")],dc.prototype,"columnModel",void 0),uc([o("focusService")],dc.prototype,"focusService",void 0);var hc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class pc extends E{constructor(e){super(),this.headerRowComps={},this.rowCompsList=[],this.pinned=e}init(){this.selectAndSetTemplate();const e={setDisplayed:e=>this.setDisplayed(e),setCtrls:e=>this.setCtrls(e),setCenterWidth:e=>this.eCenterContainer.style.width=e,setViewportScrollLeft:e=>this.getGui().scrollLeft=e,setPinnedContainerWidth:e=>{const t=this.getGui();t.style.width=e,t.style.maxWidth=e,t.style.minWidth=e}};this.createManagedBean(new dc(this.pinned)).setComp(e,this.getGui())}selectAndSetTemplate(){const e="left"==this.pinned,t="right"==this.pinned,i=e?pc.PINNED_LEFT_TEMPLATE:t?pc.PINNED_RIGHT_TEMPLATE:pc.CENTER_TEMPLATE;this.setTemplate(i),this.eRowContainer=this.eCenterContainer?this.eCenterContainer:this.getGui()}destroyRowComps(){this.setCtrls([])}destroyRowComp(e){this.destroyBean(e),this.eRowContainer.removeChild(e.getGui())}setCtrls(e){const r=this.headerRowComps;let i;this.headerRowComps={},this.rowCompsList=[];const s=e=>{const t=e.getGui();t.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(t),i&&Qn(this.eRowContainer,t,i),i=t};e.forEach(e=>{const t=e.getInstanceId(),i=r[t];delete r[t];const n=i||this.createBean(new Il(e));this.headerRowComps[t]=n,this.rowCompsList.push(n),s(n)}),ye(r).forEach(e=>this.destroyRowComp(e))}}pc.PINNED_LEFT_TEMPLATE='<div class="ag-pinned-left-header" role="presentation"></div>',pc.PINNED_RIGHT_TEMPLATE='<div class="ag-pinned-right-header" role="presentation"></div>',pc.CENTER_TEMPLATE='<div class="ag-header-viewport" role="presentation">\n            <div class="ag-header-container" ref="eCenterContainer" role="rowgroup"></div>\n        </div>',hc([S("eCenterContainer")],pc.prototype,"eCenterContainer",void 0),hc([r],pc.prototype,"init",null),hc([Ve],pc.prototype,"destroyRowComps",null);var fc,gc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};!function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"}(fc||(fc={}));let mc=class extends f{postConstruct(){this.ctrlsService.whenReady(e=>{this.gridBodyCon=e.gridBodyCtrl})}getHeaderRowCount(){const e=this.ctrlsService.getHeaderRowContainerCtrl();return e?e.getRowCount():0}navigateVertically(e,t,i){if(t||(t=this.focusService.getFocusedHeader()),!t)return!1;const{headerRowIndex:n,column:r}=t,s=this.getHeaderRowCount(),o=e===fc.UP;let{nextRow:a,nextFocusColumn:l}=o?this.headerPositionUtils.getColumnVisibleParent(r,n):this.headerPositionUtils.getColumnVisibleChild(r,n),c=!1;return a<0&&(a=0,l=r,c=!0),a>=s&&(a=-1),!(!c&&!l)&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a,column:l},allowUserOverride:!0,event:i})}navigateHorizontally(e,t=!1,i){const n=this.focusService.getFocusedHeader();let r,s;return e===fc.LEFT!==this.gridOptionsService.is("enableRtl")?(s="Before",r=this.headerPositionUtils.findHeader(n,s)):(s="After",r=this.headerPositionUtils.findHeader(n,s)),r||!t?this.focusService.focusHeaderPosition({headerPosition:r,direction:s,fromTab:t,allowUserOverride:!0,event:i}):this.focusNextHeaderRow(n,s,i)}focusNextHeaderRow(e,t,i){const n=e.headerRowIndex;let r,s=null;return"Before"===t?n>0&&(r=n-1,s=this.headerPositionUtils.findColAtEdgeForHeaderRow(r,"end")):(r=n+1,s=this.headerPositionUtils.findColAtEdgeForHeaderRow(r,"start")),this.focusService.focusHeaderPosition({headerPosition:s,direction:t,fromTab:!0,allowUserOverride:!0,event:i})}scrollToColumn(t,i="After"){if(t.getPinned())return;let n;if(t instanceof g){const e=t.getDisplayedLeafColumns();n="Before"===i?p(e):e[0]}else n=t;this.gridBodyCon.getScrollFeature().ensureColumnVisible(n)}};gc([o("focusService")],mc.prototype,"focusService",void 0),gc([o("headerPositionUtils")],mc.prototype,"headerPositionUtils",void 0),gc([o("ctrlsService")],mc.prototype,"ctrlsService",void 0),gc([r],mc.prototype,"postConstruct",null),mc=gc([s("headerNavigationService")],mc);var vc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class yc extends f{setComp(e,t,i){this.comp=e,this.eGui=t,this.createManagedBean(new jr(i,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onPivotModeChanged(),this.setupHeaderHeight(),this.ctrlsService.registerGridHeaderCtrl(this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListener("headerHeight",e),this.addManagedPropertyListener("pivotHeaderHeight",e),this.addManagedPropertyListener("groupHeaderHeight",e),this.addManagedPropertyListener("pivotGroupHeaderHeight",e),this.addManagedPropertyListener("floatingFiltersHeight",e),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_GRID_STYLES_CHANGED,e)}getHeaderHeight(){return this.headerHeight}setHeaderHeight(){const{columnModel:e}=this;let t,i=0,n=e.getHeaderRowCount();e.hasFloatingFilters()&&(n++,i=1);const r=this.columnModel.getColumnGroupHeaderRowHeight(),s=this.columnModel.getColumnHeaderRowHeight(),o=n-(1+i);if(t=i*e.getFloatingFiltersHeight(),t+=o*r,t+=s,this.headerHeight===t)return;this.headerHeight=t;const a=t+1+"px";this.comp.setHeightAndMinHeight(a),this.eventService.dispatchEvent({type:y.EVENT_HEADER_HEIGHT_CHANGED})}onPivotModeChanged(){const e=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",e),this.comp.addOrRemoveCssClass("ag-pivot-off",!e)}onDisplayedColumnsChanged(){const e=this.columnModel.getAllDisplayedColumns().some(e=>e.isSpanHeaderHeight());this.comp.addOrRemoveCssClass("ag-header-allow-overflow",e)}onTabKeyDown(e){const t=this.gridOptionsService.is("enableRtl"),i=e.shiftKey!==t?fc.LEFT:fc.RIGHT;(this.headerNavigationService.navigateHorizontally(i,!0,e)||this.focusService.focusNextGridCoreContainer(e.shiftKey))&&e.preventDefault()}handleKeyDown(e){let t=null;switch(e.key){case A.LEFT:t=fc.LEFT;case A.RIGHT:_(t)||(t=fc.RIGHT),this.headerNavigationService.navigateHorizontally(t,!1,e);break;case A.UP:t=fc.UP;case A.DOWN:_(t)||(t=fc.DOWN),this.headerNavigationService.navigateVertically(t,null,e)&&e.preventDefault();break;default:return}}onFocusOut(e){const t=this.gridOptionsService.getDocument(),{relatedTarget:i}=e;!i&&this.eGui.contains(t.activeElement)||this.eGui.contains(i)||this.focusService.clearFocusedHeader()}}vc([o("headerNavigationService")],yc.prototype,"headerNavigationService",void 0),vc([o("focusService")],yc.prototype,"focusService",void 0),vc([o("columnModel")],yc.prototype,"columnModel",void 0),vc([o("ctrlsService")],yc.prototype,"ctrlsService",void 0);var bc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Cc extends E{constructor(){super(Cc.TEMPLATE)}postConstruct(){const e={addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),setHeightAndMinHeight:e=>{this.getGui().style.height=e,this.getGui().style.minHeight=e}};this.createManagedBean(new yc).setComp(e,this.getGui(),this.getFocusableElement());const t=e=>{this.createManagedBean(e),this.appendChild(e)};t(new pc("left")),t(new pc(null)),t(new pc("right"))}}Cc.TEMPLATE='<div class="ag-header" role="presentation"/>',bc([r],Cc.prototype,"postConstruct",null);var wc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let _c=class extends f{addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0};this.dragService.addDragSource(t);return()=>this.dragService.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const i=t instanceof MouseEvent&&!0===t.shiftKey;e.onResizeStart(i)}setResizeIcons(){const e=this.ctrlsService.getGridCtrl();e.setResizeCursor(!0),e.disableUserSelect(!0)}onDragStop(e,t){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.ctrlsService.getGridCtrl();e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}};wc([o("dragService")],_c.prototype,"dragService",void 0),wc([o("ctrlsService")],_c.prototype,"ctrlsService",void 0),_c=wc([s("horizontalResizeService")],_c);var Ac=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Ec=class extends f{hideActiveMenu(){this.hidePopup&&this.hidePopup()}showMenuAfterMouseEvent(t,i){this.showPopup(t,e=>{this.popupService.positionPopupUnderMouseEvent({column:t,type:"columnMenu",mouseEvent:i,ePopup:e})},"columnMenu",i.target)}showMenuAfterButtonClick(t,i,n){this.showPopup(t,e=>{this.popupService.positionPopupByComponent({type:n,eventSource:i,ePopup:e,keepWithinBounds:!0,position:"under",column:t})},n,i)}showPopup(n,t,i,r){const s=this.filterManager.getOrCreateFilterWrapper(n,"COLUMN_MENU");if(!s)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");const o=document.createElement("div");let a;_i(o,"presentation"),o.classList.add("ag-menu"),this.tabListener=this.addManagedListener(o,"keydown",e=>this.trapFocusWithin(e,o)),s.guiPromise.then(e=>o.appendChild(e));const e=r||this.ctrlsService.getGridBodyCtrl().getGui(),l=this.localeService.getLocaleTextFunc(),c=this.popupService.addPopup({modal:!0,eChild:o,closeOnEsc:!0,closedCallback:e=>{n.setMenuVisible(!1,"contextMenu");const t=e instanceof KeyboardEvent;if(this.tabListener&&(this.tabListener=this.tabListener()),t&&r&&jn(r)){const n=this.focusService.findTabbableParent(r);n&&n.focus()}var i;null===(i=s.filterPromise)||void 0===i||i.then(e=>{var t;return null===(t=null==e?void 0:e.afterGuiDetached)||void 0===t?void 0:t.call(e)})},positionCallback:()=>t(o),anchorToElement:e,ariaLabel:l("ariaLabelColumnMenu","Column Menu")});c&&(this.hidePopup=a=c.hideFunc),s.filterPromise.then(e=>{t(o),e.afterGuiAttached&&e.afterGuiAttached({container:i,hidePopup:a})}),n.setMenuVisible(!0,"contextMenu")}trapFocusWithin(e,t){e.key!==A.TAB||e.defaultPrevented||this.focusService.findNextFocusableElement(t,!1,e.shiftKey)||(e.preventDefault(),this.focusService.focusInto(t,e.shiftKey))}isMenuEnabled(e){return e.isFilterAllowed()&&e.getMenuTabs(["filterMenuTab"]).includes("filterMenuTab")}};Ac([o("filterManager")],Ec.prototype,"filterManager",void 0),Ac([o("popupService")],Ec.prototype,"popupService",void 0),Ac([o("focusService")],Ec.prototype,"focusService",void 0),Ac([o("ctrlsService")],Ec.prototype,"ctrlsService",void 0),Ec=Ac([s("menuFactory")],Ec);var Sc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Tc extends E{constructor(e){super(Tc.getTemplate(e.cssClass)),this.items=[],this.tabbedItemScrollMap=new Map,this.params=e,e.items&&e.items.forEach(e=>this.addItem(e))}postConstruct(){this.createManagedBean(new jr(this.getFocusableElement(),{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this)})),this.addDestroyFunc(()=>{var e,t,i;return null===(i=null===(t=null===(e=this.activeItem)||void 0===e?void 0:e.tabbedItem)||void 0===t?void 0:t.afterDetachedCallback)||void 0===i?void 0:i.call(t)})}static getTemplate(e){return`<div class="ag-tabs ${e}">\n            <div ref="eHeader" role="tablist" class="ag-tabs-header ${e?e+"-header":""}"></div>\n            <div ref="eBody" role="presentation" class="ag-tabs-body ${e?e+"-body":""}"></div>\n        </div>`}handleKeyDown(s){const o=this.gridOptionsService.getDocument();switch(s.key){case A.RIGHT:case A.LEFT:if(!this.eHeader.contains(o.activeElement))return;const e=s.key===A.RIGHT,t=this.gridOptionsService.is("enableRtl"),i=this.items.indexOf(this.activeItem),n=e!==t?Math.min(i+1,this.items.length-1):Math.max(i-1,0);if(i===n)return;s.preventDefault();const r=this.items[n];this.showItemWrapper(r),r.eHeaderButton.focus();break;case A.UP:case A.DOWN:s.stopPropagation()}}onTabKeyDown(e){if(e.defaultPrevented)return;const{focusService:t,eHeader:i,eBody:n,activeItem:r}=this,s=this.gridOptionsService.getDocument().activeElement,o=e.target;if(e.preventDefault(),i.contains(s))return void t.focusInto(n,e.shiftKey);let a=null;t.isTargetUnderManagedComponent(n,o)&&(e.shiftKey&&(a=this.focusService.findFocusableElementBeforeTabGuard(n,o)),a||(a=r.eHeaderButton)),!a&&n.contains(s)&&(a=t.findNextFocusableElement(n,!1,e.shiftKey),a||(a=r.eHeaderButton)),a&&a.focus()}setAfterAttachedParams(e){this.afterAttachedParams=e}showFirstItem(){this.items.length>0&&this.showItemWrapper(this.items[0])}addItem(e){const t=document.createElement("span");_i(t,"tab"),t.setAttribute("tabindex","-1"),t.appendChild(e.title),t.classList.add("ag-tab"),this.eHeader.appendChild(t),xi(t,e.titleLabel);const i={tabbedItem:e,eHeaderButton:t};this.items.push(i),t.addEventListener("click",this.showItemWrapper.bind(this,i))}showItem(t){const e=this.items.find(e=>e.tabbedItem===t);e&&this.showItemWrapper(e)}showItemWrapper(e){var t,i;const{tabbedItem:n,eHeaderButton:r}=e;this.params.onItemClicked&&this.params.onItemClicked({item:n}),this.activeItem!==e?(this.lastScrollListener&&(this.lastScrollListener=this.lastScrollListener()),Vn(this.eBody),n.bodyPromise.then(t=>{this.eBody.appendChild(t);const i=!this.focusService.isKeyboardMode();if(this.focusService.focusInto(this.eBody,!1,i),n.afterAttachedCallback&&n.afterAttachedCallback(this.afterAttachedParams),this.params.keepScrollPosition){const i=n.getScrollableContainer&&n.getScrollableContainer()||t;this.lastScrollListener=this.addManagedListener(i,"scroll",()=>{this.tabbedItemScrollMap.set(n.name,i.scrollTop)});const e=this.tabbedItemScrollMap.get(n.name);void 0!==e&&setTimeout(()=>{i.scrollTop=e},0)}}),this.activeItem&&(this.activeItem.eHeaderButton.classList.remove("ag-tab-selected"),null===(i=(t=this.activeItem.tabbedItem).afterDetachedCallback)||void 0===i||i.call(t)),r.classList.add("ag-tab-selected"),this.activeItem=e):Ge(this.params.onActiveItemClicked)}}function xc(i){return l(()=>console.warn("AG Grid: Since v29 simpleHttpRequest has been deprecated as it was only meant for use in internal AG Grid documentation examples. Please use the browser fetch api directly."),"simpleHttpRequest"),new Rr(e=>{const t=new XMLHttpRequest;t.open("GET",i.url),t.send(),t.onreadystatechange=function(){4===t.readyState&&200===t.status&&e(JSON.parse(t.responseText))}})}Sc([o("focusService")],Tc.prototype,"focusService",void 0),Sc([S("eHeader")],Tc.prototype,"eHeader",void 0),Sc([S("eBody")],Tc.prototype,"eBody",void 0),Sc([r],Tc.prototype,"postConstruct",null);var Dc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Rc=class extends f{constructor(){super(...arguments),this.polyfillFunctions=[]}observeResize(s,o){const t=this.gridOptionsService.getWindow(),e=this.gridOptionsService.is("suppressBrowserResizeObserver");return!!t.ResizeObserver&&!e?(()=>{const e=new t.ResizeObserver(o);return e.observe(s),()=>e.disconnect()})():(()=>{let t=Xn(s),i=Kn(s),n=!0;const r=()=>{if(n){const n=Xn(s),e=Kn(s);(n!==t||e!==i)&&(t=n,i=e,o()),this.doNextPolyfillTurn(r)}};return r(),()=>n=!1})()}doNextPolyfillTurn(e){this.polyfillFunctions.push(e),this.schedulePolyfill()}schedulePolyfill(){if(this.polyfillScheduled)return;this.polyfillScheduled=!0,this.getFrameworkOverrides().setTimeout(()=>{const e=this.polyfillFunctions;this.polyfillScheduled=!1,this.polyfillFunctions=[],e.forEach(e=>e())},50)}};Rc=Dc([s("resizeObserverService")],Rc);var Mc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Nc=class extends f{constructor(){super(...arguments),this.createTasksP1={list:[],sorted:!1},this.createTasksP2={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastPage=0,this.lastScrollTop=0,this.taskCount=0,this.cancelledTasks=new Set}setScrollTop(e){const t=this.gridOptionsService.is("pagination");if(this.scrollGoingDown=e>=this.lastScrollTop,t&&0===e){const e=this.paginationProxy.getCurrentPage();e!==this.lastPage&&(this.lastPage=e,this.scrollGoingDown=!0)}this.lastScrollTop=e}init(){this.useAnimationFrame=!this.gridOptionsService.is("suppressAnimationFrame")}isOn(){return this.useAnimationFrame}verifyAnimationFrameOn(e){!1===this.useAnimationFrame&&console.warn(`AG Grid: AnimationFrameService.${e} called but animation frames are off`)}createTask(e,t,i){this.verifyAnimationFrameOn(i);const n={task:e,index:t,createOrder:++this.taskCount};this.addTaskToList(this[i],n),this.schedule()}cancelTask(e){this.cancelledTasks.add(e)}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const i=this.scrollGoingDown?1:-1;e.list.sort((e,t)=>e.index!==t.index?i*(t.index-e.index):t.createOrder-e.createOrder),e.sorted=!0}addDestroyTask(e){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(e),this.schedule()}executeFrame(e){this.verifyAnimationFrameOn("executeFrame");const t=this.createTasksP1,i=t.list,n=this.createTasksP2,r=n.list,s=this.destroyTasks,o=(new Date).getTime();let a=(new Date).getTime()-o;const l=e<=0,c=this.ctrlsService.getGridBodyCtrl();for(;l||a<e;){if(!c.getScrollFeature().scrollGridIfNeeded()){let e;if(i.length)this.sortTaskList(t),e=i.pop().task;else if(r.length)this.sortTaskList(n),e=r.pop().task;else{if(!s.length){this.cancelledTasks.clear();break}e=s.pop()}this.cancelledTasks.has(e)||e()}a=(new Date).getTime()-o}i.length||r.length||s.length?this.requestFrame():this.stopTicking()}stopTicking(){this.ticking=!1}flushAllFrames(){this.useAnimationFrame&&this.executeFrame(-1)}schedule(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);this.requestAnimationFrame(e)}requestAnimationFrame(e){const t=this.gridOptionsService.getWindow();t.requestAnimationFrame?t.requestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.setTimeout(e,0)}isQueueEmpty(){return!this.ticking}debounce(e){let t=!1;return()=>{this.isOn()?t||(t=!0,this.addDestroyTask(()=>{t=!1,e()})):this.getFrameworkOverrides().setTimeout(e,0)}}};Mc([o("ctrlsService")],Nc.prototype,"ctrlsService",void 0),Mc([o("paginationProxy")],Nc.prototype,"paginationProxy",void 0),Mc([r],Nc.prototype,"init",null),Nc=Mc([s("animationFrameService")],Nc);var Oc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Ic=class extends f{postConstruct(){this.ctrlsService.whenReady(e=>{this.centerRowContainerCtrl=e.centerRowContainerCtrl})}getPreferredWidthForColumn(e,t){const i=this.getHeaderCellForColumn(e);if(!i)return-1;const n=this.rowRenderer.getAllCellsForColumn(e);return t||n.push(i),this.addElementsToContainerAndGetWidth(n)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.addElementsToContainerAndGetWidth([t]):-1}addElementsToContainerAndGetWidth(e){const t=document.createElement("form");t.style.position="fixed";const i=this.centerRowContainerCtrl.getContainerElement();e.forEach(e=>this.cloneItemIntoDummy(e,t)),i.appendChild(t);const n=t.offsetWidth;i.removeChild(t);return n+this.getAutoSizePadding()}getAutoSizePadding(){const e=this.gridOptionsService.getNum("autoSizePadding");return null!=e&&e>=0?e:20}getHeaderCellForColumn(i){let n=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach(e=>{const t=e.getHtmlElementForColumnHeader(i);null!=t&&(n=t)}),n}cloneItemIntoDummy(e,t){const i=e.cloneNode(!0);i.style.width="",i.style.position="static",i.style.left="";const n=document.createElement("div"),r=n.classList;["ag-header-cell","ag-header-group-cell"].some(e=>i.classList.contains(e))?(r.add("ag-header","ag-header-row"),n.style.position="static"):r.add("ag-row");let s=e.parentElement;for(;s;){if(["ag-header-row","ag-row"].some(e=>s.classList.contains(e))){for(let e=0;e<s.classList.length;e++){const t=s.classList[e];"ag-row-position-absolute"!=t&&r.add(t)}break}s=s.parentElement}n.appendChild(i),t.appendChild(n)}};Oc([o("rowRenderer")],Ic.prototype,"rowRenderer",void 0),Oc([o("ctrlsService")],Ic.prototype,"ctrlsService",void 0),Oc([o("rowCssClassCalculator")],Ic.prototype,"rowCssClassCalculator",void 0),Oc([r],Ic.prototype,"postConstruct",null),Ic=Oc([s("autoWidthCalculator")],Ic);var Pc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class kc extends f{constructor(e,t){super(),this.createRowCon=e,this.destroyRowCtrls=t,this.stickyRowCtrls=[],this.containerHeight=0}postConstruct(){this.isClientSide="clientSide"===this.rowModel.getType(),this.ctrlsService.whenReady(e=>{this.gridBodyCtrl=e.gridBodyCtrl})}getStickyRowCtrls(){return this.stickyRowCtrls}checkStickyRows(){let o=0;if(!this.gridOptionsService.isGroupRowsSticky())return void this.refreshNodesAndContainerHeight([],o);const a=[],l=this.rowRenderer.getFirstVisibleVerticalPixel(),c=t=>{var e,i,n;let r;if(a.push(t),this.isClientSide){let e=t;for(;e.expanded;)if(e.master)e=e.detailNode;else if(e.childrenAfterSort){if(0===e.childrenAfterSort.length)break;e=p(e.childrenAfterSort)}r=e.rowTop+e.rowHeight}else if(t.master)r=t.detailNode.rowTop+t.detailNode.rowHeight;else{const o=null===(e=t.childStore)||void 0===e?void 0:e.getStoreBounds();r=(null!==(i=null==o?void 0:o.heightPx)&&void 0!==i?i:0)+(null!==(n=null==o?void 0:o.topPx)&&void 0!==n?n:0)}const s=l+o+t.rowHeight;t.stickyRowTop=r<s?o+(r-s):o,o=0,a.forEach(e=>{const t=e.stickyRowTop+e.rowHeight;o<t&&(o=t)})};for(;;){const e=l+o,t=this.rowModel.getRowIndexAtPixel(e),i=this.rowModel.getRow(t);if(null==i)break;if(i.level<0)break;const n=[];let r=i.parent;for(;r.level>=0;)n.push(r),r=r.parent;const s=n.reverse().find(e=>a.indexOf(e)<0&&e.displayed);if(s)c(s);else{if(!(i.isExpandable()&&i.expanded&&i.rowTop<e))break;c(i)}}this.refreshNodesAndContainerHeight(a,o)}refreshStickyNode(i){const n=[];for(let t=0;t<this.stickyRowCtrls.length;t++){const e=this.stickyRowCtrls[t].getRowNode();e!==i&&n.push(e)}this.refreshNodesAndContainerHeight(n,this.containerHeight),this.checkStickyRows()}refreshNodesAndContainerHeight(t,e){const i=this.stickyRowCtrls.filter(e=>-1===t.indexOf(e.getRowNode())),n=t.filter(t=>-1===this.stickyRowCtrls.findIndex(e=>e.getRowNode()===t)),r={};i.forEach(t=>{r[t.getRowNode().id]=t,this.stickyRowCtrls=this.stickyRowCtrls.filter(e=>e!==t)});for(const t of Object.values(r))t.getRowNode().sticky=!1;this.destroyRowCtrls(r,!1);const s=n.map(e=>(e.sticky=!0,this.createRowCon(e,!1,!1)));this.stickyRowCtrls.push(...s),this.stickyRowCtrls.forEach(e=>e.setRowTop(e.getRowNode().stickyRowTop)),this.stickyRowCtrls.sort((e,t)=>t.getRowNode().rowIndex-e.getRowNode().rowIndex),this.containerHeight!==e&&(this.containerHeight=e,this.gridBodyCtrl.setStickyTopHeight(e))}}Pc([o("rowModel")],kc.prototype,"rowModel",void 0),Pc([o("rowRenderer")],kc.prototype,"rowRenderer",void 0),Pc([o("ctrlsService")],kc.prototype,"ctrlsService",void 0),Pc([r],kc.prototype,"postConstruct",null);var Lc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Fc=class extends f{constructor(){super(...arguments),this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1}postConstruct(){this.ctrlsService.whenReady(()=>{this.gridBodyCtrl=this.ctrlsService.getGridBodyCtrl(),this.initialise()})}initialise(){if(this.addManagedListener(this.eventService,y.EVENT_PAGINATION_CHANGED,this.onPageLoaded.bind(this)),this.addManagedListener(this.eventService,y.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,y.EVENT_BODY_SCROLL,this.onBodyScroll.bind(this)),this.addManagedListener(this.eventService,y.EVENT_BODY_HEIGHT_CHANGED,this.redraw.bind(this)),this.addManagedPropertyListener("domLayout",this.onDomLayoutChanged.bind(this)),this.addManagedPropertyListener("rowClass",this.redrawRows.bind(this)),this.gridOptionsService.isGroupRowsSticky()){const e=this.rowModel.getType();"clientSide"!==e&&"serverSide"!==e||(this.stickyRowFeature=this.createManagedBean(new kc(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this))))}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=this.gridOptionsService.isDomLayout("print"),this.embedFullWidthRows=this.printLayout||this.gridOptionsService.is("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gridOptionsService.is("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=null!=e?e:3;this.cachedRowCtrls=new Gc(t)}}getKeepDetailRowsCount(){const e=this.gridOptionsService.getNum("keepDetailRowsCount");return _(e)&&e>0?e:10}getRowCtrls(){return this.allRowCtrls}getStickyTopRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyRowCtrls():[]}updateAllRowCtrls(){const e=ye(this.rowCtrlsByRowIndex),t=this.gridOptionsService.is("ensureDomOrder"),i=this.gridOptionsService.isDomLayout("print");(t||i)&&e.sort((e,t)=>e.getRowNode().rowIndex-t.getRowNode.rowIndex);const n=ye(this.zombieRowCtrls),r=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];this.allRowCtrls=[...e,...n,...r]}onCellFocusChanged(t){this.getAllCellCtrls().forEach(e=>e.onCellFocused(t)),this.getFullWidthRowCtrls().forEach(e=>e.onFullWidthRowFocused(t))}registerCellEventListeners(){this.addManagedListener(this.eventService,y.EVENT_CELL_FOCUSED,e=>{this.onCellFocusChanged(e)}),this.addManagedListener(this.eventService,y.EVENT_CELL_FOCUS_CLEARED,()=>{this.onCellFocusChanged()}),this.addManagedListener(this.eventService,y.EVENT_FLASH_CELLS,t=>{this.getAllCellCtrls().forEach(e=>e.onFlashCells(t))}),this.addManagedListener(this.eventService,y.EVENT_COLUMN_HOVER_CHANGED,()=>{this.getAllCellCtrls().forEach(e=>e.onColumnHover())}),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,()=>{this.getAllCellCtrls().forEach(e=>e.onDisplayedColumnsChanged())}),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,()=>{this.printLayout&&this.getAllCellCtrls().forEach(e=>e.onLeftChanged())});this.gridOptionsService.isEnableRangeSelection()&&(this.addManagedListener(this.eventService,y.EVENT_RANGE_SELECTION_CHANGED,()=>{this.getAllCellCtrls().forEach(e=>e.onRangeSelectionChanged())}),this.addManagedListener(this.eventService,y.EVENT_COLUMN_MOVED,()=>{this.getAllCellCtrls().forEach(e=>e.updateRangeBordersIfRangeCount())}),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PINNED,()=>{this.getAllCellCtrls().forEach(e=>e.updateRangeBordersIfRangeCount())}),this.addManagedListener(this.eventService,y.EVENT_COLUMN_VISIBLE,()=>{this.getAllCellCtrls().forEach(e=>e.updateRangeBordersIfRangeCount())})),this.refreshListenersToColumnsForCellComps(),this.addManagedListener(this.eventService,y.EVENT_GRID_COLUMNS_CHANGED,this.refreshListenersToColumnsForCellComps.bind(this)),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach(e=>e()),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();const e=this.columnModel.getAllGridColumns();e&&e.forEach(i=>{const e=t=>{this.getAllCellCtrls().forEach(e=>{e.getColumn()===i&&t(e)})},t=()=>{e(e=>e.onLeftChanged())},n=()=>{e(e=>e.onWidthChanged())},r=()=>{e(e=>e.onFirstRightPinnedChanged())},s=()=>{e(e=>e.onLastLeftPinnedChanged())},o=()=>{e(e=>e.onColDefChanged())};i.addEventListener("leftChanged",t),i.addEventListener("widthChanged",n),i.addEventListener("firstRightPinnedChanged",r),i.addEventListener("lastLeftPinnedChanged",s),i.addEventListener("colDefChanged",o),this.destroyFuncsForColumnListeners.push(()=>{i.removeEventListener("leftChanged",t),i.removeEventListener("widthChanged",n),i.removeEventListener("firstRightPinnedChanged",r),i.removeEventListener("lastLeftPinnedChanged",s),i.removeEventListener("colDefChanged",o)})})}onDomLayoutChanged(){const e=this.gridOptionsService.isDomLayout("print"),t=e||this.gridOptionsService.is("embedFullWidthRows"),i=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,i&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsForColumn(i){const n=[];return this.getAllRowCtrls().forEach(e=>{const t=e.getCellElement(i);t&&n.push(t)}),n}refreshFloatingRowComps(){this.refreshFloatingRows(this.topRowCtrls,this.pinnedRowModel.getPinnedTopRowData()),this.refreshFloatingRows(this.bottomRowCtrls,this.pinnedRowModel.getPinnedBottomRowData())}getTopRowCtrls(){return this.topRowCtrls}getBottomRowCtrls(){return this.bottomRowCtrls}refreshFloatingRows(i,e){i.forEach(e=>{e.destroyFirstPass(),e.destroySecondPass()}),i.length=0,e&&e.forEach(e=>{const t=new La(e,this.beans,!1,!1,this.printLayout);i.push(t)})}onPinnedRowDataChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}getRenderedIndexesForRowNodes(n){const r=[];return u(n)||a(this.rowCtrlsByRowIndex,(e,t)=>{const i=t.getRowNode();n.indexOf(i)>=0&&r.push(e)}),r}redrawRows(e){const t=null!=e&&e.length>0;if(t){const t=this.getRenderedIndexesForRowNodes(e);this.removeRowCtrls(t)}this.redrawAfterModelUpdate({recycleRows:t})}getCellToRestoreFocusToAfterRefresh(e){const t=(null==e?void 0:e.suppressKeepFocus)?null:this.focusService.getFocusCellToUseAfterRefresh();if(null==t)return null;const i=this.gridOptionsService.getDocument().activeElement,n=this.gridOptionsService.getDomData(i,Ia.DOM_DATA_KEY_CELL_CTRL),r=this.gridOptionsService.getDomData(i,La.DOM_DATA_KEY_ROW_CTRL);return n||r?t:null}redrawAfterModelUpdate(e={}){this.getLockOnRefresh();const t=this.getCellToRestoreFocusToAfterRefresh(e);this.updateContainerHeights(),this.scrollToTopIfNewData(e);const i=!e.domLayoutChanged&&!!e.recycleRows,n=e.animate&&this.gridOptionsService.isAnimateRows(),r=i?this.getRowsToRecycle():null;i||this.removeAllRowComps(),this.recycleRows(r,n),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),null!=t&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){const t=e.newData||e.newPage,i=this.gridOptionsService.is("suppressScrollOnNewData");t&&!i&&this.gridBodyCtrl.getScrollFeature().scrollToTop()}updateContainerHeights(){if(this.printLayout)return void this.rowContainerHeightService.setModelHeight(null);let e=this.paginationProxy.getCurrentPageHeight();0===e&&(e=1),this.rowContainerHeightService.setModelHeight(e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0}releaseLockOnRefresh(){this.refreshInProgress=!1}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){e&&(this.focusService.setRestoreFocusedCell(e),this.onCellFocusChanged({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,api:this.beans.gridApi,columnApi:this.beans.columnApi,context:this.beans.gridOptionsService.context,type:"mock"}))}stopEditing(t=!1){this.getAllRowCtrls().forEach(e=>{e.stopEditing(t)})}getAllCellCtrls(){const i=[],n=this.getAllRowCtrls(),r=n.length;for(let e=0;e<r;e++){const r=n[e].getAllCellCtrls(),t=r.length;for(let e=0;e<t;e++)i.push(r[e])}return i}getAllRowCtrls(){const e=this.stickyRowFeature&&this.stickyRowFeature.getStickyRowCtrls()||[],t=[...this.topRowCtrls,...this.bottomRowCtrls,...e];for(const e of Object.keys(this.rowCtrlsByRowIndex))t.push(this.rowCtrlsByRowIndex[e]);return t}addRenderedRowListener(e,t,i){const n=this.rowCtrlsByRowIndex[t];n&&n.addEventListener(e,i)}flashCells(e={}){const{flashDelay:t,fadeDelay:i}=e;this.getCellCtrls(e.rowNodes,e.columns).forEach(e=>e.flashCell({flashDelay:t,fadeDelay:i}))}refreshCells(e={}){const t={forceRefresh:e.force,newData:!1,suppressFlash:e.suppressFlash};this.getCellCtrls(e.rowNodes,e.columns).forEach(e=>{if(e.refreshShouldDestroy()){const t=e.getRowCtrl();t&&t.refreshCell(e)}else e.refreshCell(t)}),this.refreshFullWidthRows(e.rowNodes)}getCellRendererInstances(e){var t;const i=this.getCellCtrls(e.rowNodes,e.columns).map(e=>e.getCellRenderer()).filter(e=>null!=e);if(null===(t=e.columns)||void 0===t?void 0:t.length)return i;const n=[],r=this.mapRowNodes(e.rowNodes);return this.getAllRowCtrls().forEach(e=>{if(r&&!this.isRowInMap(e.getRowNode(),r))return;if(!e.isFullWidth())return;const t=e.getFullWidthCellRenderer();t&&n.push(t)}),[...n,...i]}getCellEditorInstances(e){const i=[];return this.getCellCtrls(e.rowNodes,e.columns).forEach(e=>{const t=e.getCellEditor();t&&i.push(t)}),i}getEditingCells(){const i=[];return this.getAllCellCtrls().forEach(t=>{if(t.isEditing()){const e=t.getCellPosition();i.push(e)}}),i}mapRowNodes(e){if(!e)return;const i={top:{},bottom:{},normal:{}};return e.forEach(e=>{const t=e.id;"top"===e.rowPinned?i.top[t]=e:"bottom"===e.rowPinned?i.bottom[t]=e:i.normal[t]=e}),i}isRowInMap(e,t){const i=e.id,n=e.rowPinned;return"bottom"===n?null!=t.bottom[i]:"top"===n?null!=t.top[i]:null!=t.normal[i]}getCellCtrls(e,t){const i=this.mapRowNodes(e),n=[];let r;_(t)&&(r={},t.forEach(e=>{const t=this.columnModel.getGridColumn(e);_(t)&&(r[t.getId()]=!0)}));const s=e=>{const t=e.getRowNode();(null==i||this.isRowInMap(t,i))&&e.getAllCellCtrls().forEach(e=>{const t=e.getColumn().getId();r&&!r[t]||n.push(e)})};return this.getAllRowCtrls().forEach(e=>s(e)),n}destroy(){this.removeAllRowComps(),super.destroy()}removeAllRowComps(){const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}getRowsToRecycle(){const i=[];a(this.rowCtrlsByRowIndex,(e,t)=>{null==t.getRowNode().id&&i.push(e)}),this.removeRowCtrls(i);const n={};return a(this.rowCtrlsByRowIndex,(e,t)=>{const i=t.getRowNode();n[i.id]=t}),this.rowCtrlsByRowIndex={},n}removeRowCtrls(e){e.forEach(e=>{const t=this.rowCtrlsByRowIndex[e];t&&(t.destroyFirstPass(),t.destroySecondPass()),delete this.rowCtrlsByRowIndex[e]})}onBodyScroll(e){"vertical"===e.direction&&this.redraw()}redraw(e=!0){let t;if(this.stickyRowFeature&&rn()&&(t=this.getCellToRestoreFocusToAfterRefresh()||void 0),this.getLockOnRefresh(),this.recycleRows(null,!1,e),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(e),null!=t){const e=this.getCellToRestoreFocusToAfterRefresh();null!=t&&null==e&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(t))}}removeRowCompsNotToDraw(e){const t={};e.forEach(e=>t[e]=!0);const i=Object.keys(this.rowCtrlsByRowIndex).filter(e=>!t[e]);this.removeRowCtrls(i)}calculateIndexesToDraw(e){let n=pn(this.firstRenderedRow,this.lastRenderedRow);const t=(e,t)=>{const i=t.getRowNode().rowIndex;null!=i&&(i<this.firstRenderedRow||i>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(t)&&n.push(i)};return a(this.rowCtrlsByRowIndex,t),a(e,t),n.sort((e,t)=>e-t),n=n.filter(e=>{const t=this.paginationProxy.getRow(e);return t&&!t.sticky}),n}recycleRows(i,n=!1,r=!1){this.rowContainerHeightService.updateOffset(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature&&this.stickyRowFeature.checkStickyRows();const e=this.calculateIndexesToDraw(i);this.removeRowCompsNotToDraw(e),this.printLayout&&(n=!1);const s=[];if(e.forEach(e=>{const t=this.createOrUpdateRowCtrl(e,i,n,r);_(t)&&s.push(t)}),i){r&&!this.gridOptionsService.is("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask(()=>{this.destroyRowCtrls(i,n),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(i,n)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){const t={type:y.EVENT_DISPLAYED_ROWS_CHANGED,afterScroll:e};this.eventService.dispatchEvent(t)}onDisplayedColumnsChanged(){const e=this.columnModel.isPinningLeft(),t=this.columnModel.isPinningRight();(this.pinningLeft!==e||t!==this.pinningRight)&&(this.pinningLeft=e,this.pinningRight=t,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const i=[];this.getFullWidthRowCtrls().forEach(e=>{const t=e.getRowNode().rowIndex;i.push(t.toString())}),this.refreshFloatingRowComps(),this.removeRowCtrls(i),this.redraw()}getFullWidthRowCtrls(e){const i=this.mapRowNodes(e);return this.getAllRowCtrls().filter(e=>{if(!e.isFullWidth())return!1;const t=e.getRowNode();return!(null!=i&&!this.isRowInMap(t,i))})}refreshFullWidthRow(e){this.refreshFullWidthRows([e])}refreshFullWidthRows(e){const t=this.getFullWidthRowCtrls(e);let i=!1;const n=[];t.forEach(e=>{if(e.refreshFullWidth())return;const t=e.getRowNode();t.sticky?this.stickyRowFeature.refreshStickyNode(t):n.push(t.rowIndex),i=!0}),n.length>0&&this.removeRowCtrls(n),i&&this.redraw(!1)}createOrUpdateRowCtrl(e,t,i,n){let r,s=this.rowCtrlsByRowIndex[e];s||(r=this.paginationProxy.getRow(e),_(r)&&_(t)&&t[r.id]&&r.alreadyRendered&&(s=t[r.id],t[r.id]=null));if(!s){if(r||(r=this.paginationProxy.getRow(e)),!_(r))return;s=this.createRowCon(r,i,n)}return r&&(r.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=s,s}destroyRowCtrls(e,i){const n=[];a(e,(e,t)=>{t&&(this.cachedRowCtrls&&t.isCacheable()?this.cachedRowCtrls.addRow(t):(t.destroyFirstPass(),i?(this.zombieRowCtrls[t.getInstanceId()]=t,n.push(()=>{t.destroySecondPass(),delete this.zombieRowCtrls[t.getInstanceId()]})):t.destroySecondPass()))}),i&&(n.push(()=>{this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}),Re(n))}getRowBuffer(){let e=this.gridOptionsService.getNum("rowBuffer");return"number"==typeof e?e<0&&(l(()=>console.warn("AG Grid: rowBuffer should not be negative"),"warn rowBuffer negative"),e=0,this.gridOptionsService.set("rowBuffer",0)):e=10,e}getRowBufferInPixels(){return this.getRowBuffer()*this.gridOptionsService.getRowHeightAsNumber()}workOutFirstAndLastRowsToRender(){let l,c;if(this.paginationProxy.isRowsToRender())if(this.printLayout)l=this.paginationProxy.getPageFirstRow(),c=this.paginationProxy.getPageLastRow();else{const u=this.getRowBufferInPixels(),d=this.ctrlsService.getGridBodyCtrl(),h=this.gridOptionsService.is("suppressRowVirtualisation");let s,o,a=!1;do{const l=this.paginationProxy.getPixelOffset(),{pageFirstPixel:c,pageLastPixel:e}=this.paginationProxy.getCurrentPagePixelRange(),t=this.rowContainerHeightService.getDivStretchOffset(),i=d.getScrollFeature().getVScrollPosition(),n=i.top,r=i.bottom;h?(s=c+t,o=e+t):(s=Math.max(n+l-u,c)+t,o=Math.min(r+l+u,e)+t),this.firstVisibleVPixel=Math.max(n+l,c)+t,a=this.ensureAllRowsInRangeHaveHeightsCalculated(s,o)}while(a);let e=this.paginationProxy.getRowIndexAtPixel(s),t=this.paginationProxy.getRowIndexAtPixel(o);const i=this.paginationProxy.getPageFirstRow(),n=this.paginationProxy.getPageLastRow();e<i&&(e=i),t>n&&(t=n),l=e,c=t}else l=0,c=-1;const u=this.gridOptionsService.isDomLayout("normal"),d=this.gridOptionsService.is("suppressMaxRenderedRowRestriction"),h=Math.max(this.getRowBuffer(),500);u&&!d&&c-l>h&&(c=l+h);const e=l!==this.firstRenderedRow,t=c!==this.lastRenderedRow;if(e||t){this.firstRenderedRow=l,this.lastRenderedRow=c;const u={type:y.EVENT_VIEWPORT_CHANGED,firstRow:l,lastRow:c};this.eventService.dispatchEvent(u)}}dispatchFirstDataRenderedEvent(){if(this.dataFirstRenderedFired)return;this.dataFirstRenderedFired=!0;const e={type:y.EVENT_FIRST_DATA_RENDERED,firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow};window.requestAnimationFrame(()=>{this.beans.eventService.dispatchEvent(e)})}ensureAllRowsInRangeHaveHeightsCalculated(e,t){const i=this.paginationProxy.ensureRowHeightsValid(e,t,-1,-1);return i&&this.updateContainerHeights(),i}getFirstVisibleVerticalPixel(){return this.firstVisibleVPixel}getFirstVirtualRenderedRow(){return this.firstRenderedRow}getLastVirtualRenderedRow(){return this.lastRenderedRow}doNotUnVirtualiseRow(e){const t=e.getRowNode(),i=this.focusService.isRowNodeFocused(t),n=e.isEditing(),r=t.detail;if(!(i||n||r))return!1;return!!this.paginationProxy.isRowPresent(t)}createRowCon(e,t,i){const n=this.cachedRowCtrls?this.cachedRowCtrls.getRow(e):null;if(n)return n;const r=this.gridOptionsService.is("suppressAnimationFrame"),s=i&&!r&&!this.printLayout;return new La(e,this.beans,t,s,this.printLayout)}getRenderedNodes(){const t=this.rowCtrlsByRowIndex;return Object.keys(t).map(e=>t[e].getRowNode())}getRowByPosition(e){let t;const{rowIndex:i}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[i];break;case"bottom":t=this.bottomRowCtrls[i];break;default:t=this.rowCtrlsByRowIndex[i],t||(t=this.getStickyTopRowCtrls().find(e=>e.getRowNode().rowIndex===i)||null)}return t}getRowNode(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}}isRangeInRenderedViewport(e,t){if(null==e||null==t)return!1;const i=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!i}};Lc([o("animationFrameService")],Fc.prototype,"animationFrameService",void 0),Lc([o("paginationProxy")],Fc.prototype,"paginationProxy",void 0),Lc([o("columnModel")],Fc.prototype,"columnModel",void 0),Lc([o("pinnedRowModel")],Fc.prototype,"pinnedRowModel",void 0),Lc([o("rowModel")],Fc.prototype,"rowModel",void 0),Lc([o("focusService")],Fc.prototype,"focusService",void 0),Lc([o("beans")],Fc.prototype,"beans",void 0),Lc([o("rowContainerHeightService")],Fc.prototype,"rowContainerHeightService",void 0),Lc([o("ctrlsService")],Fc.prototype,"ctrlsService",void 0),Lc([r],Fc.prototype,"postConstruct",null),Fc=Lc([s("rowRenderer")],Fc);class Gc{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.getRowNode().id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const e=this.entriesList[0];e.destroyFirstPass(),e.destroySecondPass(),this.removeFromCache(e)}}getRow(e){if(null==e||null==e.id)return null;const t=this.entriesMap[e.id];if(!t)return null;this.removeFromCache(t),t.setCached(!1);return t.getRowNode()!=e?null:t}removeFromCache(e){const t=e.getRowNode().id;delete this.entriesMap[t],ot(this.entriesList,e)}getEntries(){return this.entriesList}}var $c=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Hc=class extends f{formatValue(e,t,i,n,r=!0){let s,o=null;const a=e.getColDef();if(n?s=n:r&&(s=a.valueFormatter),s){const n={value:i,node:t,data:t?t.data:null,colDef:a,column:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};o="function"==typeof s?s(n):this.expressionService.evaluate(s,n)}else if(a.refData)return a.refData[i]||"";return null==o&&Array.isArray(i)&&(o=i.join(", ")),o}};$c([o("expressionService")],Hc.prototype,"expressionService",void 0),Hc=$c([s("valueFormatterService")],Hc);var Bc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Vc=class extends f{init(){this.setPinnedTopRowData(this.gridOptionsService.get("pinnedTopRowData")),this.setPinnedBottomRowData(this.gridOptionsService.get("pinnedBottomRowData"))}isEmpty(e){return ee("top"===e?this.pinnedTopRows:this.pinnedBottomRows)}isRowsToRender(e){return!this.isEmpty(e)}getRowAtPixel(i,e){const n="top"===e?this.pinnedTopRows:this.pinnedBottomRows;if(ee(n))return 0;for(let t=0;t<n.length;t++){const e=n[t];if(e.rowTop+e.rowHeight-1>=i)return t}return n.length-1}setPinnedTopRowData(e){this.pinnedTopRows=this.createNodesFromData(e,!0);const t={type:y.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(t)}setPinnedBottomRowData(e){this.pinnedBottomRows=this.createNodesFromData(e,!1);const t={type:y.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(t)}createNodesFromData(e,s){const o=[];if(e){let r=0;e.forEach((e,t)=>{const i=new R(this.beans);i.data=e;const n=s?R.ID_PREFIX_TOP_PINNED:R.ID_PREFIX_BOTTOM_PINNED;i.id=n+t,i.rowPinned=s?"top":"bottom",i.setRowTop(r),i.setRowHeight(this.gridOptionsService.getRowHeightForNode(i).height),i.setRowIndex(t),r+=i.rowHeight,o.push(i)})}return o}getPinnedTopRowData(){return this.pinnedTopRows}getPinnedBottomRowData(){return this.pinnedBottomRows}getPinnedTopTotalHeight(){return this.getTotalHeight(this.pinnedTopRows)}getPinnedTopRowCount(){return this.pinnedTopRows?this.pinnedTopRows.length:0}getPinnedBottomRowCount(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0}getPinnedTopRow(e){return this.pinnedTopRows[e]}getPinnedBottomRow(e){return this.pinnedBottomRows[e]}forEachPinnedTopRow(e){ee(this.pinnedTopRows)||this.pinnedTopRows.forEach(e)}forEachPinnedBottomRow(e){ee(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(e)}getPinnedBottomTotalHeight(){return this.getTotalHeight(this.pinnedBottomRows)}getTotalHeight(e){if(!e||0===e.length)return 0;const t=p(e);return t.rowTop+t.rowHeight}};var Wc;Bc([o("beans")],Vc.prototype,"beans",void 0),Bc([r],Vc.prototype,"init",null),Vc=Bc([s("pinnedRowModel")],Vc),function(e){e.Applied="Applied",e.StoreNotFound="StoreNotFound",e.StoreLoading="StoreLoading",e.StoreWaitingToLoad="StoreWaitingToLoad",e.StoreLoadingFailed="StoreLoadingFailed",e.StoreWrongType="StoreWrongType",e.Cancelled="Cancelled"}(Wc||(Wc={}));class zc{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}setInactive(){this.active=!1}isActive(){return this.active}depthFirstSearchChangedPath(t,i){if(t.children)for(let e=0;e<t.children.length;e++)this.depthFirstSearchChangedPath(t.children[e],i);i(t.rowNode)}depthFirstSearchEverything(i,n,r){if(i.childrenAfterGroup)for(let t=0;t<i.childrenAfterGroup.length;t++){const e=i.childrenAfterGroup[t];e.childrenAfterGroup?this.depthFirstSearchEverything(i.childrenAfterGroup[t],n,r):r&&n(e)}n(i)}forEachChangedNodeDepthFirst(e,t=!1,i=!1){this.active&&!i?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,i=0;for(;!this.mapToItems[t.id];){const e={rowNode:t,children:null};this.mapToItems[t.id]=e,i++,t=t.parent}return i}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let i=e;for(;i;)this.nodeIdsToColumns[i.id]||(this.nodeIdsToColumns[i.id]={}),t.forEach(e=>this.nodeIdsToColumns[i.id][e.getId()]=!0),i=i.parent}linkPathItems(t,i){let n=t;for(let e=0;e<i;e++){const t=this.mapToItems[n.id],i=this.mapToItems[n.parent.id];i.children||(i.children=[]),i.children.push(t),n=n.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const i=this.createPathItems(e);this.linkPathItems(e,i),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const i=this.nodeIdsToColumns[e.id];return t.filter(e=>i[e.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const i=this.nodeIdsToColumns[e.id];return t.filter(e=>!i[e.getId()])}}class jc extends f{constructor(e){super(),this.state=jc.STATE_WAITING_TO_LOAD,this.version=0,this.id=e}getId(){return this.id}load(){this.state=jc.STATE_LOADING,this.loadFromDatasource()}getVersion(){return this.version}setStateWaitingToLoad(){this.version++,this.state=jc.STATE_WAITING_TO_LOAD}getState(){return this.state}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state=jc.STATE_FAILED,this.processServerFail()),this.dispatchLoadCompleted(!1)}success(e,t){this.successCommon(e,t)}pageLoaded(e,t,i){this.successCommon(e,{rowData:t,rowCount:i})}isRequestMostRecentAndLive(e){const t=e===this.version,i=this.isAlive();return t&&i}successCommon(e,t){this.dispatchLoadCompleted();this.isRequestMostRecentAndLive(e)&&(this.state=jc.STATE_LOADED,this.processServerResult(t))}dispatchLoadCompleted(e=!0){const t={type:jc.EVENT_LOAD_COMPLETE,success:e,block:this};this.dispatchEvent(t)}}jc.EVENT_LOAD_COMPLETE="loadComplete",jc.STATE_WAITING_TO_LOAD="needsLoading",jc.STATE_LOADING="loading",jc.STATE_LOADED="loaded",jc.STATE_FAILED="failed";var Uc,Yc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},qc=function(i,n){return function(e,t){n(e,t,i)}};let Kc=Uc=class extends f{constructor(){super(...arguments),this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();const e=this.gridOptionsService.getNum("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=Tr.debounce(this.performCheckBlocksToLoad.bind(this),e))}setBeans(e){this.logger=e.create("RowNodeBlockLoader")}getMaxConcurrentDatasourceRequests(){const e=this.gridOptionsService.getNum("maxConcurrentDatasourceRequests");return null==e?2:e<=0?void 0:e}addBlock(e){this.blocks.push(e),e.addEventListener(jc.EVENT_LOAD_COMPLETE,this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){Tr.removeFromArray(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchEvent({type:Uc.BLOCK_LOADED_EVENT}),0==this.activeBlockLoadsCount&&this.dispatchEvent({type:Uc.BLOCK_LOADER_FINISHED_EVENT})}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),null!=this.maxConcurrentRequests&&this.activeBlockLoadsCount>=this.maxConcurrentRequests)return void this.logger.log("checkBlockToLoad: max loads exceeded");const e=this.getAvailableLoadingCount(),t=this.blocks.filter(e=>e.getState()===jc.STATE_WAITING_TO_LOAD).slice(0,e);this.registerLoads(t.length),t.forEach(e=>e.load()),this.printCacheStatus()}getBlockState(){if(this.gridOptionsService.isRowModelType("serverSide")){return this.rowModel.getBlockStates()}const n={};return this.blocks.forEach(e=>{const{id:t,state:i}=e.getBlockStateJson();n[t]=i}),n}printCacheStatus(){this.logger.isLogging()&&this.logger.log(`printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = `+JSON.stringify(this.getBlockState()))}isLoading(){return this.activeBlockLoadsCount>0}registerLoads(e){this.activeBlockLoadsCount+=e}getAvailableLoadingCount(){return void 0!==this.maxConcurrentRequests?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0}};Kc.BLOCK_LOADED_EVENT="blockLoaded",Kc.BLOCK_LOADER_FINISHED_EVENT="blockLoaderFinished",Yc([o("rowModel")],Kc.prototype,"rowModel",void 0),Yc([r],Kc.prototype,"postConstruct",null),Yc([qc(0,ze("loggerFactory"))],Kc.prototype,"setBeans",null),Kc=Uc=Yc([s("rowNodeBlockLoader")],Kc);var Xc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Qc=class extends f{constructor(){super(...arguments),this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.pixelOffset=0,this.masterRowCount=0}postConstruct(){this.active=this.gridOptionsService.is("pagination"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedListener(this.eventService,y.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedPropertyListener("pagination",this.onPaginationPageSizeChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPaginationPageSizeChanged.bind(this)),this.onModelUpdated()}ensureRowHeightsValid(e,t,i,n){const r=this.rowModel.ensureRowHeightsValid(e,t,this.getPageFirstRow(),this.getPageLastRow());return r&&this.calculatePages(),r}isPaginateChildRows(){return!(!this.gridOptionsService.is("groupRemoveSingleChildren")&&!this.gridOptionsService.is("groupRemoveLowestSingleChildren"))||this.gridOptionsService.is("paginateChildRows")}onModelUpdated(e){this.calculatePages();const t={type:y.EVENT_PAGINATION_CHANGED,animate:!!e&&e.animate,newData:!!e&&e.newData,newPage:!!e&&e.newPage,keepRenderedRows:!!e&&e.keepRenderedRows};this.eventService.dispatchEvent(t)}onPaginationPageSizeChanged(){this.active=this.gridOptionsService.is("pagination"),this.calculatePages();const e={type:y.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,keepRenderedRows:!0};this.eventService.dispatchEvent(e)}goToPage(e){if(!this.active||this.currentPage===e||"number"!=typeof this.currentPage)return;this.currentPage=e;const t={type:y.EVENT_MODEL_UPDATED,animate:!1,keepRenderedRows:!1,newData:!1,newPage:!0};this.onModelUpdated(t)}getPixelOffset(){return this.pixelOffset}getRow(e){return this.rowModel.getRow(e)}getRowNode(e){return this.rowModel.getRowNode(e)}getRowIndexAtPixel(e){return this.rowModel.getRowIndexAtPixel(e)}getCurrentPageHeight(){return u(this.topRowBounds)||u(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)}getCurrentPagePixelRange(){return{pageFirstPixel:this.topRowBounds?this.topRowBounds.rowTop:0,pageLastPixel:this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0}}isRowPresent(e){if(!this.rowModel.isRowPresent(e))return!1;return e.rowIndex>=this.topDisplayedRowIndex&&e.rowIndex<=this.bottomDisplayedRowIndex}isEmpty(){return this.rowModel.isEmpty()}isRowsToRender(){return this.rowModel.isRowsToRender()}forEachNode(e){return this.rowModel.forEachNode(e)}forEachNodeOnPage(t){const i=this.getPageFirstRow(),n=this.getPageLastRow();for(let e=i;e<=n;e++){const i=this.getRow(e);i&&t(i)}}getType(){return this.rowModel.getType()}getRowBounds(e){const t=this.rowModel.getRowBounds(e);return t.rowIndex=e,t}getPageFirstRow(){return this.topRowBounds?this.topRowBounds.rowIndex:-1}getPageLastRow(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1}getRowCount(){return this.rowModel.getRowCount()}getPageForIndex(e){return Math.floor(e/this.pageSize)}goToPageWithIndex(e){if(!this.active)return;const t=this.getPageForIndex(e);this.goToPage(t)}isRowInPage(e){if(!this.active)return!0;return this.getPageForIndex(e.rowIndex)===this.currentPage}isLastPageFound(){return this.rowModel.isLastRowIndexKnown()}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPageSize(){this.pageSize=this.gridOptionsService.getNum("paginationPageSize"),(null==this.pageSize||this.pageSize<1)&&(this.pageSize=100)}calculatePages(){this.active?(this.setPageSize(),this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly()):this.calculatedPagesNotActive(),this.topRowBounds=this.rowModel.getRowBounds(this.topDisplayedRowIndex),this.topRowBounds&&(this.topRowBounds.rowIndex=this.topDisplayedRowIndex),this.bottomRowBounds=this.rowModel.getRowBounds(this.bottomDisplayedRowIndex),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=this.bottomDisplayedRowIndex),this.setPixelOffset(_(this.topRowBounds)?this.topRowBounds.rowTop:0)}setPixelOffset(e){this.pixelOffset!==e&&(this.pixelOffset=e,this.eventService.dispatchEvent({type:y.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0)return void this.setZeroRows();const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid();const t=this.pageSize*this.currentPage;let i=this.pageSize*(this.currentPage+1)-1;if(i>e&&(i=e),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(t),i===e)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{const e=this.rowModel.getTopLevelRowDisplayedIndex(i+1);this.bottomDisplayedRowIndex=e-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){if(this.masterRowCount=this.rowModel.getRowCount(),0===this.masterRowCount)return void this.setZeroRows();const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>e&&(this.bottomDisplayedRowIndex=e)}calculatedPagesNotActive(){this.pageSize=this.rowModel.getRowCount(),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1}};Xc([o("rowModel")],Qc.prototype,"rowModel",void 0),Xc([r],Qc.prototype,"postConstruct",null),Qc=Xc([s("paginationProxy")],Qc);var Zc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Jc=class extends f{processAllCellClasses(e,t,i,n){this.processClassRules(e.cellClassRules,t,i,n),this.processStaticCellClasses(e,t,i)}processClassRules(n,r,e,s){if(null==n)return;const o=Object.keys(n),a={},l={};for(let i=0;i<o.length;i++){const s=o[i],e=n[s];let t;"string"==typeof e?t=this.expressionService.evaluate(e,r):"function"==typeof e&&(t=e(r)),s.split(" ").forEach(e=>{null!=e&&""!=e.trim()&&(t?a[e]=!0:l[e]=!0)})}s&&Object.keys(l).forEach(s),Object.keys(a).forEach(e)}getStaticCellClasses(e,t){const{cellClass:i}=e;if(!i)return[];let n;if("function"==typeof i){n=i(t)}else n=i;return"string"==typeof n&&(n=[n]),n||[]}processStaticCellClasses(e,t,i){this.getStaticCellClasses(e,t).forEach(e=>{i(e)})}};Zc([o("expressionService")],Jc.prototype,"expressionService",void 0),Jc=Zc([s("stylingService")],Jc);class eu extends as{constructor(e){super(e,"ag-toggle-button")}setValue(e,t){return super.setValue(e,t),this.addOrRemoveCssClass("ag-selected",this.getValue()),this}}class tu extends os{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){const i=super.setValue(e,t);return this.eInput.value=e,i}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}}class iu extends ys{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct(),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this));const e=Qi();this.addManagedListener(this.eInput,"mousedown",()=>{this.isDisabled()||e||this.eInput.focus()}),this.eInput.step="any"}onWheel(e){document.activeElement===this.eInput&&e.preventDefault()}setMin(e){var t;const i=e instanceof Date?null!==(t=wn(null!=e?e:null,!1))&&void 0!==t?t:void 0:e;return this.min===i||(this.min=i,hr(this.eInput,"min",i)),this}setMax(e){var t;const i=e instanceof Date?null!==(t=wn(null!=e?e:null,!1))&&void 0!==t?t:void 0:e;return this.max===i||(this.max=i,hr(this.eInput,"max",i)),this}setStep(e){return this.step===e||(this.step=e,hr(this.eInput,"step",e)),this}getDate(){var e;if(this.eInput.validity.valid)return null!==(e=En(this.getValue()))&&void 0!==e?e:void 0}setDate(e,t){this.setValue(wn(null!=e?e:null,!1),t)}}class nu extends os{constructor(e){super(e,"ag-range-field","range")}postConstruct(){super.postConstruct();const{min:e,max:t,step:i}=this.config;null!=e&&this.setMinValue(e),null!=t&&this.setMaxValue(t),this.setStep(i||1)}addInputListeners(){this.addManagedListener(this.eInput,"input",e=>{const t=e.target.value;this.setValue(t)})}setMinValue(e){return this.min=e,this.eInput.setAttribute("min",e.toString()),this}setMaxValue(e){return this.max=e,this.eInput.setAttribute("max",e.toString()),this}setStep(e){return this.eInput.setAttribute("step",e.toString()),this}setValue(e,t){null!=this.min&&(e=Math.max(parseFloat(e),this.min).toString()),null!=this.max&&(e=Math.min(parseFloat(e),this.max).toString());const i=super.setValue(e,t);return this.eInput.value=e,i}}var ru=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class su extends Qr{constructor(e){super(e,su.TEMPLATE),this.labelAlignment="top"}init(){this.eSlider.addCssClass("ag-slider-field")}onValueChange(t){const e=Zr.EVENT_CHANGED;return this.addManagedListener(this.eText,e,()=>{const e=parseFloat(this.eText.getValue());this.eSlider.setValue(e.toString(),!0),t(e||0)}),this.addManagedListener(this.eSlider,e,()=>{const e=this.eSlider.getValue();this.eText.setValue(e,!0),t(parseFloat(e))}),this}setSliderWidth(e){return this.eSlider.setWidth(e),this}setTextFieldWidth(e){return this.eText.setWidth(e),this}setMinValue(e){return this.eSlider.setMinValue(e),this.eText.setMin(e),this}setMaxValue(e){return this.eSlider.setMaxValue(e),this.eText.setMax(e),this}getValue(){return this.eText.getValue()}setValue(e){return this.getValue()===e||(this.eText.setValue(e,!0),this.eSlider.setValue(e,!0),this.dispatchEvent({type:Zr.EVENT_CHANGED})),this}setStep(e){return this.eSlider.setStep(e),this.eText.setStep(e),this}}su.TEMPLATE='<div class="ag-slider">\n            <label ref="eLabel"></label>\n            <div class="ag-wrapper ag-slider-wrapper">\n                <ag-input-range ref="eSlider"></ag-input-range>\n                <ag-input-number-field ref="eText"></ag-input-number-field>\n            </div>\n        </div>',ru([S("eLabel")],su.prototype,"eLabel",void 0),ru([S("eSlider")],su.prototype,"eSlider",void 0),ru([S("eText")],su.prototype,"eText",void 0),ru([r],su.prototype,"init",null);var ou=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class au extends E{constructor(e={}){super(au.getTemplate(e)),this.suppressEnabledCheckbox=!0,this.suppressOpenCloseIcons=!1;const{title:t,enabled:i,items:n,suppressEnabledCheckbox:r,suppressOpenCloseIcons:s}=e;this.title=t,this.cssIdentifier=e.cssIdentifier||"default",this.enabled=null==i||i,this.items=n||[],this.alignItems=e.alignItems||"center",null!=r&&(this.suppressEnabledCheckbox=r),null!=s&&(this.suppressOpenCloseIcons=s)}static getTemplate(e){const t=e.cssIdentifier||"default";return`<div class="ag-group ag-${t}-group" role="presentation">\n            <div class="ag-group-title-bar ag-${t}-group-title-bar ag-unselectable" ref="eTitleBar" role="button">\n                <span class="ag-group-title-bar-icon ag-${t}-group-title-bar-icon" ref="eGroupOpenedIcon" role="presentation"></span>\n                <span class="ag-group-title-bar-icon ag-${t}-group-title-bar-icon" ref="eGroupClosedIcon" role="presentation"></span>\n                <span ref="eTitle" class="ag-group-title ag-${t}-group-title"></span>\n            </div>\n            <div ref="eToolbar" class="ag-group-toolbar ag-${t}-group-toolbar">\n                <ag-checkbox ref="cbGroupEnabled"></ag-checkbox>\n            </div>\n            <div ref="eContainer" class="ag-group-container ag-group-container-${e.direction||"vertical"} ag-${t}-group-container"></div>\n        </div>`}postConstruct(){if(this.items.length){const e=this.items;this.items=[],this.addItems(e)}const e=this.localeService.getLocaleTextFunc();this.cbGroupEnabled.setLabel(e("enabled","Enabled")),this.title&&this.setTitle(this.title),this.enabled&&this.setEnabled(this.enabled),this.setAlignItems(this.alignItems),this.hideEnabledCheckbox(this.suppressEnabledCheckbox),this.hideOpenCloseIcons(this.suppressOpenCloseIcons),this.setupExpandContract(),this.refreshAriaStatus(),this.refreshChildDisplay()}setupExpandContract(){this.eGroupClosedIcon.appendChild(gr("columnSelectClosed",this.gridOptionsService,null)),this.eGroupOpenedIcon.appendChild(gr("columnSelectOpen",this.gridOptionsService,null)),this.addManagedListener(this.eTitleBar,"click",()=>this.toggleGroupExpand()),this.addManagedListener(this.eTitleBar,"keydown",e=>{switch(e.key){case A.ENTER:case A.SPACE:e.preventDefault(),this.toggleGroupExpand();break;case A.RIGHT:case A.LEFT:e.preventDefault(),this.toggleGroupExpand(e.key===A.RIGHT)}})}refreshAriaStatus(){this.suppressOpenCloseIcons||ki(this.eTitleBar,this.expanded)}refreshChildDisplay(){const e=!this.suppressOpenCloseIcons;w(this.eToolbar,this.expanded&&!this.suppressEnabledCheckbox),w(this.eGroupOpenedIcon,e&&this.expanded),w(this.eGroupClosedIcon,e&&!this.expanded)}isExpanded(){return this.expanded}setAlignItems(e){this.alignItems!==e&&this.removeCssClass("ag-group-item-alignment-"+this.alignItems),this.alignItems=e;const t="ag-group-item-alignment-"+this.alignItems;return this.addCssClass(t),this}toggleGroupExpand(e){return this.suppressOpenCloseIcons?(this.expanded=!0,this.refreshChildDisplay(),w(this.eContainer,!0),this):(e=null!=e?e:!this.expanded,this.expanded===e||(this.expanded=e,this.refreshAriaStatus(),this.refreshChildDisplay(),w(this.eContainer,e),this.dispatchEvent({type:this.expanded?au.EVENT_EXPANDED:au.EVENT_COLLAPSED})),this)}addItems(e){e.forEach(e=>this.addItem(e))}addItem(e){const t=this.eContainer,i=e instanceof E?e.getGui():e;i.classList.add("ag-group-item",`ag-${this.cssIdentifier}-group-item`),t.appendChild(i),this.items.push(i)}hideItem(e,t){w(this.items[t],!e)}setTitle(e){return this.eTitle.innerText=e,this}addCssClassToTitleBar(e){this.eTitleBar.classList.add(e)}setEnabled(e,t){return this.enabled=e,this.refreshDisabledStyles(),this.toggleGroupExpand(e),t||this.cbGroupEnabled.setValue(e),this}isEnabled(){return this.enabled}onEnableChange(t){return this.cbGroupEnabled.onValueChange(e=>{this.setEnabled(e,!0),t(e)}),this}hideEnabledCheckbox(e){return this.suppressEnabledCheckbox=e,this.refreshChildDisplay(),this.refreshDisabledStyles(),this}hideOpenCloseIcons(e){return this.suppressOpenCloseIcons=e,e&&this.toggleGroupExpand(!0),this}refreshDisabledStyles(){this.addOrRemoveCssClass("ag-disabled",!this.enabled),this.suppressEnabledCheckbox&&!this.enabled?(this.eTitleBar.classList.add("ag-disabled-group-title-bar"),this.eTitleBar.removeAttribute("tabindex")):(this.eTitleBar.classList.remove("ag-disabled-group-title-bar"),this.eTitleBar.setAttribute("tabindex","0")),this.eContainer.classList.toggle("ag-disabled-group-container",!this.enabled)}}au.EVENT_EXPANDED="expanded",au.EVENT_COLLAPSED="collapsed",ou([S("eTitleBar")],au.prototype,"eTitleBar",void 0),ou([S("eGroupOpenedIcon")],au.prototype,"eGroupOpenedIcon",void 0),ou([S("eGroupClosedIcon")],au.prototype,"eGroupClosedIcon",void 0),ou([S("eToolbar")],au.prototype,"eToolbar",void 0),ou([S("cbGroupEnabled")],au.prototype,"cbGroupEnabled",void 0),ou([S("eTitle")],au.prototype,"eTitle",void 0),ou([S("eContainer")],au.prototype,"eContainer",void 0),ou([r],au.prototype,"postConstruct",null);class lu extends E{initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.getFocusableElement();const i=[this.eTopGuard,this.eBottomGuard],t={setTabIndex:t=>{i.forEach(e=>null!=t?e.setAttribute("tabindex",t):e.removeAttribute("tabindex"))}};this.addTabGuards(this.eTopGuard,this.eBottomGuard),this.tabGuardCtrl=this.createManagedBean(new Kl({comp:t,eTopGuard:this.eTopGuard,eBottomGuard:this.eBottomGuard,eFocusableElement:this.eFocusableElement,onFocusIn:e.onFocusIn,onFocusOut:e.onFocusOut,focusInnerElement:e.focusInnerElement,handleKeyDown:e.handleKeyDown,onTabKeyDown:e.onTabKeyDown,shouldStopEventPropagation:e.shouldStopEventPropagation}))}createTabGuard(e){const t=document.createElement("div"),i="top"===e?Yl.TAB_GUARD_TOP:Yl.TAB_GUARD_BOTTOM;return t.classList.add(Yl.TAB_GUARD,i),_i(t,"presentation"),t}addTabGuards(e,t){this.eFocusableElement.insertAdjacentElement("afterbegin",e),this.eFocusableElement.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){const e=[this.eTopGuard,this.eBottomGuard];Vn(this.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(e=!1){this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t){cr(e)||(e=e.getGui());const{eBottomGuard:i}=this;i?i.insertAdjacentElement("beforebegin",e):super.appendChild(e,t)}}var cu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class uu extends lu{constructor(e=1){super('<div class="ag-menu-list" role="tree"></div>'),this.level=e,this.menuItems=[]}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)})}onTabKeyDown(e){const t=this.getParentComponent(),i=t&&t.getGui();i&&i.classList.contains("ag-focus-managed")||e.preventDefault(),e.shiftKey&&this.closeIfIsChild(e)}handleKeyDown(t){switch(t.key){case A.UP:case A.RIGHT:case A.DOWN:case A.LEFT:t.preventDefault(),this.handleNavKey(t.key);break;case A.ESCAPE:const e=this.findTopMenu();e&&this.focusService.focusInto(e.getGui())}}clearActiveItem(){this.activeMenuItem&&(this.activeMenuItem.deactivate(),this.activeMenuItem=null)}addMenuItems(e){null!=e&&e.forEach(e=>{"separator"===e?this.addSeparator():"string"==typeof e?console.warn("AG Grid: unrecognised menu item "+e):this.addItem(e)})}addItem(e){const t=this.createManagedBean(new fu(Object.assign(Object.assign({},e),{isAnotherSubMenuOpen:()=>this.menuItems.some(e=>e.isSubMenuOpen())})));t.setParentComponent(this),Oi(t.getGui(),this.level),this.menuItems.push(t),this.appendChild(t.getGui()),this.addManagedListener(t,fu.EVENT_MENU_ITEM_SELECTED,e=>{this.dispatchEvent(e)}),this.addManagedListener(t,fu.EVENT_MENU_ITEM_ACTIVATED,e=>{this.activeMenuItem&&this.activeMenuItem!==e.menuItem&&this.activeMenuItem.deactivate(),this.activeMenuItem=e.menuItem})}activateFirstItem(){const e=this.menuItems.filter(e=>!e.isDisabled())[0];e&&e.activate()}addSeparator(){this.appendChild(Un('\n            <div class="ag-menu-separator" aria-hidden="true">\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n            </div>'))}findTopMenu(){let t=this.getParentComponent();if(!t&&this instanceof uu)return this;for(;;){const e=t&&t.getParentComponent&&t.getParentComponent();if(!e||!(e instanceof uu||e instanceof fu))break;t=e}return t instanceof uu?t:void 0}handleNavKey(t){switch(t){case A.UP:case A.DOWN:const e=this.findNextItem(t===A.UP);return void(e&&e!==this.activeMenuItem&&e.activate())}t===(this.gridOptionsService.is("enableRtl")?A.RIGHT:A.LEFT)?this.closeIfIsChild():this.openChild()}closeIfIsChild(e){const t=this.getParentComponent();t&&t instanceof fu&&(e&&e.preventDefault(),t.closeSubMenu(),t.getGui().focus())}openChild(){this.activeMenuItem&&this.activeMenuItem.openSubMenu(!0)}findNextItem(e){const i=this.menuItems.filter(e=>!e.isDisabled());if(!i.length)return;if(!this.activeMenuItem)return e?p(i):i[0];let n;e&&i.reverse();let r=!1;for(let t=0;t<i.length;t++){const e=i[t];if(r){n=e;break}e===this.activeMenuItem&&(r=!0)}return n||this.activeMenuItem}destroy(){this.clearActiveItem(),super.destroy()}}cu([o("focusService")],uu.prototype,"focusService",void 0),cu([r],uu.prototype,"postConstruct",null);var du=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class hu extends lu{constructor(e){super(),this.wrappedComponent=e,this.setTemplateFromElement(e.getGui())}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)})}handleKeyDown(e){e.key===A.ESCAPE&&this.closePanel()}onTabKeyDown(e){e.defaultPrevented||(this.closePanel(),e.preventDefault())}closePanel(){const e=this.parentComponent;e.closeSubMenu(),setTimeout(()=>e.getGui().focus(),0)}}du([r],hu.prototype,"postConstruct",null);var pu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class fu extends E{constructor(e){super(),this.params=e,this.isActive=!1,this.subMenuIsOpen=!1,this.setTemplate(`<div class="${this.getClassName()}" tabindex="-1" role="treeitem"></div>`)}init(){this.addIcon(),this.addName(),this.addShortcut(),this.addSubMenu(),this.addTooltip();const e=this.getGui();this.params.disabled?(this.addCssClass(this.getClassName("disabled")),Ii(e,!0)):(this.addGuiEventListener("click",e=>this.onItemSelected(e)),this.addGuiEventListener("keydown",e=>{e.key!==A.ENTER&&e.key!==A.SPACE||(e.preventDefault(),this.onItemSelected(e))}),this.addGuiEventListener("mousedown",e=>{e.stopPropagation(),e.preventDefault()}),this.addGuiEventListener("mouseenter",()=>this.onMouseEnter()),this.addGuiEventListener("mouseleave",()=>this.onMouseLeave())),this.params.cssClasses&&this.params.cssClasses.forEach(e=>this.addCssClass(e))}isDisabled(){return!!this.params.disabled}openSubMenu(e=!1){if(this.closeSubMenu(),!this.params.subMenu)return;const t=Un('<div class="ag-menu" role="presentation"></div>');let i;if(this.params.subMenu instanceof Array){const n=Ei(this.getGui()),r=isNaN(n)?1:n+1,s=this.createBean(new uu(r));s.setParentComponent(this),s.addMenuItems(this.params.subMenu),t.appendChild(s.getGui()),this.addManagedListener(s,fu.EVENT_MENU_ITEM_SELECTED,e=>this.dispatchEvent(e)),s.addGuiEventListener("mouseenter",()=>this.cancelDeactivate()),i=()=>this.destroyBean(s),e&&setTimeout(()=>s.activateFirstItem(),0)}else{const{subMenu:e}=this.params,n=this.createBean(new hu(e));n.setParentComponent(this);const r=n.getGui(),s="mouseenter",o=()=>this.cancelDeactivate();r.addEventListener(s,o),i=()=>r.removeEventListener(s,o),t.appendChild(r),e.afterGuiAttached&&setTimeout(()=>e.afterGuiAttached(),0)}const n=this.getGui(),r=this.popupService.positionPopupForMenu.bind(this.popupService,{eventSource:n,ePopup:t}),s=this.localeService.getLocaleTextFunc(),o=this.popupService.addPopup({modal:!0,eChild:t,positionCallback:r,anchorToElement:n,ariaLabel:s("ariaLabelSubMenu","SubMenu")});this.subMenuIsOpen=!0,ki(n,!0),this.hideSubMenu=()=>{o&&o.hideFunc(),this.subMenuIsOpen=!1,ki(n,!1),i()}}closeSubMenu(){this.hideSubMenu&&(this.hideSubMenu(),this.hideSubMenu=null,ki(this.getGui(),!1))}isSubMenuOpen(){return this.subMenuIsOpen}activate(e){this.cancelActivate(),this.params.disabled||(this.isActive=!0,this.addCssClass(this.getClassName("active")),this.getGui().focus(),e&&this.params.subMenu&&window.setTimeout(()=>{this.isAlive()&&this.isActive&&this.openSubMenu()},300),this.onItemActivated())}deactivate(){this.cancelDeactivate(),this.removeCssClass(this.getClassName("active")),this.isActive=!1,this.subMenuIsOpen&&this.hideSubMenu()}addIcon(){if(!this.params.checked&&!this.params.icon&&this.params.isCompact)return;const e=Un(`<span ref="eIcon" class="${this.getClassName("part")} ${this.getClassName("icon")}" role="presentation"></span>`);this.params.checked?e.appendChild(mr("check",this.gridOptionsService)):this.params.icon&&(cr(this.params.icon)?e.appendChild(this.params.icon):"string"==typeof this.params.icon?e.innerHTML=this.params.icon:console.warn("AG Grid: menu item icon must be DOM node or string")),this.getGui().appendChild(e)}addName(){if(!this.params.name&&this.params.isCompact)return;const e=Un(`<span ref="eName" class="${this.getClassName("part")} ${this.getClassName("text")}">${this.params.name||""}</span>`);this.getGui().appendChild(e)}addTooltip(){this.params.tooltip&&(this.tooltip=this.params.tooltip,this.gridOptionsService.is("enableBrowserTooltips")?this.getGui().setAttribute("title",this.tooltip):this.createManagedBean(new Ir(this)))}getTooltipParams(){return{location:"menu",value:this.tooltip}}addShortcut(){if(!this.params.shortcut&&this.params.isCompact)return;const e=Un(`<span ref="eShortcut" class="${this.getClassName("part")} ${this.getClassName("shortcut")}">${this.params.shortcut||""}</span>`);this.getGui().appendChild(e)}addSubMenu(){if(!this.params.subMenu&&this.params.isCompact)return;const t=Un(`<span ref="ePopupPointer" class="${this.getClassName("part")} ${this.getClassName("popup-pointer")}"></span>`),i=this.getGui();if(this.params.subMenu){const e=this.gridOptionsService.is("enableRtl")?"smallLeft":"smallRight";ki(i,!1),t.appendChild(mr(e,this.gridOptionsService))}i.appendChild(t)}onItemSelected(e){if(this.params.action?this.params.action():this.openSubMenu(e&&"keydown"===e.type),this.params.subMenu&&!this.params.action)return;const t={type:fu.EVENT_MENU_ITEM_SELECTED,action:this.params.action,checked:this.params.checked,cssClasses:this.params.cssClasses,disabled:this.params.disabled,icon:this.params.icon,name:this.params.name,shortcut:this.params.shortcut,subMenu:this.params.subMenu,tooltip:this.params.tooltip,event:e};this.dispatchEvent(t)}onItemActivated(){const e={type:fu.EVENT_MENU_ITEM_ACTIVATED,menuItem:this};this.dispatchEvent(e)}cancelActivate(){this.activateTimeoutId&&(window.clearTimeout(this.activateTimeoutId),this.activateTimeoutId=0)}cancelDeactivate(){this.deactivateTimeoutId&&(window.clearTimeout(this.deactivateTimeoutId),this.deactivateTimeoutId=0)}onMouseEnter(){this.cancelDeactivate(),this.params.isAnotherSubMenuOpen()?this.activateTimeoutId=window.setTimeout(()=>this.activate(!0),fu.ACTIVATION_DELAY):this.activate(!0)}onMouseLeave(){this.cancelActivate(),this.isSubMenuOpen()?this.deactivateTimeoutId=window.setTimeout(()=>this.deactivate(),fu.ACTIVATION_DELAY):this.deactivate()}getClassName(e){const t=this.params.isCompact?"ag-compact-menu-option":"ag-menu-option";return e?`${t}-${e}`:t}}fu.EVENT_MENU_ITEM_SELECTED="menuItemSelected",fu.EVENT_MENU_ITEM_ACTIVATED="menuItemActivated",fu.ACTIVATION_DELAY=80,pu([o("popupService")],fu.prototype,"popupService",void 0),pu([r],fu.prototype,"init",null);var gu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class mu extends E{constructor(e){super(mu.getTemplate(e)),this.closable=!0,this.config=e}static getTemplate(e){const t=e&&e.cssIdentifier||"default";return`<div class="ag-panel ag-${t}-panel" tabindex="-1">\n            <div ref="eTitleBar" class="ag-panel-title-bar ag-${t}-panel-title-bar ag-unselectable">\n                <span ref="eTitle" class="ag-panel-title-bar-title ag-${t}-panel-title-bar-title"></span>\n                <div ref="eTitleBarButtons" class="ag-panel-title-bar-buttons ag-${t}-panel-title-bar-buttons"></div>\n            </div>\n            <div ref="eContentWrapper" class="ag-panel-content-wrapper ag-${t}-panel-content-wrapper"></div>\n        </div>`}postConstruct(){const{component:e,closable:t,hideTitleBar:i,title:n,minWidth:r=250,width:s,minHeight:o=250,height:a,centered:l,popup:c,x:u,y:d}=this.config;this.positionableFeature=new Yr(this.getGui(),{minWidth:r,width:s,minHeight:o,height:a,centered:l,x:u,y:d,popup:c,calculateTopBuffer:()=>this.positionableFeature.getHeight()-this.getBodyHeight()}),this.createManagedBean(this.positionableFeature);const h=this.getGui();e&&this.setBodyComponent(e),i?w(this.eTitleBar,!1):(n&&this.setTitle(n),this.setClosable(null!=t?t:this.closable)),this.addManagedListener(this.eTitleBar,"mousedown",e=>{const t=this.gridOptionsService.getDocument();if(h.contains(e.relatedTarget)||h.contains(t.activeElement)||this.eTitleBarButtons.contains(e.target))return void e.preventDefault();const i=this.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");i&&i.focus()}),c&&this.positionableFeature.isPositioned()||(this.renderComponent&&this.renderComponent(),this.positionableFeature.initialisePosition(),this.eContentWrapper.style.height="0")}renderComponent(){const e=this.getGui();e.focus(),this.close=()=>{e.parentElement.removeChild(e),this.destroy()}}getHeight(){return this.positionableFeature.getHeight()}setHeight(e){this.positionableFeature.setHeight(e)}getWidth(){return this.positionableFeature.getWidth()}setWidth(e){this.positionableFeature.setWidth(e)}setClosable(i){if(i!==this.closable&&(this.closable=i),i){const i=this.closeButtonComp=new E(mu.CLOSE_BTN_TEMPLATE);this.getContext().createBean(i);const e=i.getGui(),t=mr("close",this.gridOptionsService);t.classList.add("ag-panel-title-bar-button-icon"),e.appendChild(t),this.addTitleBarButton(i),i.addManagedListener(e,"click",this.onBtClose.bind(this))}else if(this.closeButtonComp){const i=this.closeButtonComp.getGui();i.parentElement.removeChild(i),this.closeButtonComp=this.destroyBean(this.closeButtonComp)}}setBodyComponent(e){e.setParentComponent(this),this.eContentWrapper.appendChild(e.getGui())}addTitleBarButton(e,t){const i=this.eTitleBarButtons,n=i.children,r=n.length;null==t&&(t=r),t=Math.max(0,Math.min(t,r)),e.addCssClass("ag-panel-title-bar-button");const s=e.getGui();0===t?i.insertAdjacentElement("afterbegin",s):t===r?i.insertAdjacentElement("beforeend",s):n[t-1].insertAdjacentElement("afterend",s),e.setParentComponent(this)}getBodyHeight(){return Pn(this.eContentWrapper)}getBodyWidth(){return kn(this.eContentWrapper)}setTitle(e){this.eTitle.innerText=e}onBtClose(){this.close()}destroy(){this.closeButtonComp&&(this.closeButtonComp=this.destroyBean(this.closeButtonComp));const e=this.getGui();e&&e.offsetParent&&this.close(),super.destroy()}}mu.CLOSE_BTN_TEMPLATE='<div class="ag-button"></div>',gu([S("eContentWrapper")],mu.prototype,"eContentWrapper",void 0),gu([S("eTitleBar")],mu.prototype,"eTitleBar",void 0),gu([S("eTitleBarButtons")],mu.prototype,"eTitleBarButtons",void 0),gu([S("eTitle")],mu.prototype,"eTitle",void 0),gu([r],mu.prototype,"postConstruct",null);var vu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class yu extends mu{constructor(e){super(Object.assign(Object.assign({},e),{popup:!0})),this.isMaximizable=!1,this.isMaximized=!1,this.maximizeListeners=[],this.resizeListenerDestroy=null,this.lastPosition={x:0,y:0,width:0,height:0}}postConstruct(){const t=this.getGui(),{movable:e,resizable:i,maximizable:n}=this.config;this.addCssClass("ag-dialog"),super.postConstruct(),this.addManagedListener(t,"focusin",e=>{t.contains(e.relatedTarget)||this.popupService.bringPopupToFront(t)}),e&&this.setMovable(e),n&&this.setMaximizable(n),i&&this.setResizable(i)}renderComponent(){const e=this.getGui(),{alwaysOnTop:t,modal:i,title:n}=this.config,r=this.localeService.getLocaleTextFunc(),s=this.popupService.addPopup({modal:i,eChild:e,closeOnEsc:!0,closedCallback:this.destroy.bind(this),alwaysOnTop:t,ariaLabel:n||r("ariaLabelDialog","Dialog")});s&&(this.close=s.hideFunc)}toggleMaximize(){const n=this.positionableFeature.getPosition();if(this.isMaximized){const{x:n,y:e,width:t,height:i}=this.lastPosition;this.setWidth(t),this.setHeight(i),this.positionableFeature.offsetElement(n,e)}else this.lastPosition.width=this.getWidth(),this.lastPosition.height=this.getHeight(),this.lastPosition.x=n.x,this.lastPosition.y=n.y,this.positionableFeature.offsetElement(0,0),this.setHeight("100%"),this.setWidth("100%");this.isMaximized=!this.isMaximized,this.refreshMaximizeIcon()}refreshMaximizeIcon(){w(this.maximizeIcon,!this.isMaximized),w(this.minimizeIcon,this.isMaximized)}clearMaximizebleListeners(){this.maximizeListeners.length&&(this.maximizeListeners.forEach(e=>e()),this.maximizeListeners.length=0),this.resizeListenerDestroy&&(this.resizeListenerDestroy(),this.resizeListenerDestroy=null)}destroy(){this.maximizeButtonComp=this.destroyBean(this.maximizeButtonComp),this.clearMaximizebleListeners(),super.destroy()}setResizable(e){this.positionableFeature.setResizable(e)}setMovable(e){this.positionableFeature.setMovable(e,this.eTitleBar)}setMaximizable(e){if(!e)return this.clearMaximizebleListeners(),void(this.maximizeButtonComp&&(this.destroyBean(this.maximizeButtonComp),this.maximizeButtonComp=this.maximizeIcon=this.minimizeIcon=void 0));const t=this.eTitleBar;if(!t||e===this.isMaximizable)return;const i=this.buildMaximizeAndMinimizeElements();this.refreshMaximizeIcon(),i.addManagedListener(i.getGui(),"click",this.toggleMaximize.bind(this)),this.addTitleBarButton(i,0),this.maximizeListeners.push(this.addManagedListener(t,"dblclick",this.toggleMaximize.bind(this))),this.resizeListenerDestroy=this.addManagedListener(this,"resize",()=>{this.isMaximized=!1,this.refreshMaximizeIcon()})}buildMaximizeAndMinimizeElements(){const e=this.maximizeButtonComp=this.createBean(new E('<div class="ag-dialog-button"></span>')),t=e.getGui();return this.maximizeIcon=mr("maximize",this.gridOptionsService),t.appendChild(this.maximizeIcon),this.maximizeIcon.classList.add("ag-panel-title-bar-button-icon"),this.minimizeIcon=mr("minimize",this.gridOptionsService),t.appendChild(this.minimizeIcon),this.minimizeIcon.classList.add("ag-panel-title-bar-button-icon"),e}}vu([o("popupService")],yu.prototype,"popupService",void 0);var bu,Cu,wu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};!function(e){e[e.vertical=0]="vertical",e[e.horizontal=1]="horizontal"}(Cu||(Cu={}));let _u=0,Au=bu=class extends f{constructor(){super(...arguments),this.popupList=[]}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridCtrl=e.gridCtrl,this.addManagedListener(this.gridCtrl,y.EVENT_KEYBOARD_FOCUS,()=>{this.popupList.forEach(e=>e.element.classList.add(Zl.AG_KEYBOARD_FOCUS))}),this.addManagedListener(this.gridCtrl,y.EVENT_MOUSE_FOCUS,()=>{this.popupList.forEach(e=>e.element.classList.remove(Zl.AG_KEYBOARD_FOCUS))})})}getPopupParent(){const e=this.gridOptionsService.get("popupParent");return e||this.gridCtrl.getGui()}positionPopupForMenu(e){const t=e.eventSource.getBoundingClientRect(),i=this.getParentRect(),n=this.keepXYWithinBounds(e.ePopup,t.top-i.top,Cu.vertical),r=e.ePopup.clientWidth>0?e.ePopup.clientWidth:200;e.ePopup.style.minWidth=r+"px";const s=i.right-i.left-r;let o;function a(){return t.right-i.left-2}function l(){return t.left-i.left-r}this.gridOptionsService.is("enableRtl")?(o=l(),o<0&&(o=a()),o>s&&(o=0)):(o=a(),o>s&&(o=l()),o<0&&(o=0)),e.ePopup.style.left=o+"px",e.ePopup.style.top=n+"px"}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:i,nudgeY:n,skipObserver:r}=e;this.positionPopup({ePopup:t,nudgeX:i,nudgeY:n,keepWithinBounds:!0,skipObserver:r,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e.type,e.ePopup,null,e.mouseEvent,e.column,e.rowNode)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(t){const i=t.eventSource.getBoundingClientRect(),n=t.alignSide||"left",r=t.position||"over",s=this.getParentRect();this.positionPopup({ePopup:t.ePopup,nudgeX:t.nudgeX,nudgeY:t.nudgeY,keepWithinBounds:t.keepWithinBounds,updatePosition:()=>{let e=i.left-s.left;"right"===n&&(e-=t.ePopup.offsetWidth-i.width);return{x:e,y:"over"===r?i.top-s.top:i.top-s.top+i.height}},postProcessCallback:()=>this.callPostProcessPopup(t.type,t.ePopup,t.eventSource,null,t.column,t.rowNode)})}callPostProcessPopup(e,t,i,n,r,s){const o=this.gridOptionsService.getCallback("postProcessPopup");if(o){o({column:r,rowNode:s,ePopup:t,type:e,eventSource:i,mouseEvent:n})}}positionPopup(n){const{ePopup:r,keepWithinBounds:s,nudgeX:o,nudgeY:a,skipObserver:e,updatePosition:l}=n,c={width:0,height:0},t=(e=!1)=>{let{x:t,y:i}=l();e&&r.clientWidth===c.width&&r.clientHeight===c.height||(c.width=r.clientWidth,c.height=r.clientHeight,o&&(t+=o),a&&(i+=a),s&&(t=this.keepXYWithinBounds(r,t,Cu.horizontal),i=this.keepXYWithinBounds(r,i,Cu.vertical)),r.style.left=t+"px",r.style.top=i+"px",n.postProcessCallback&&n.postProcessCallback())};if(t(),!e){const n=this.resizeObserverService.observeResize(r,()=>t(!0));setTimeout(()=>n(),bu.WAIT_FOR_POPUP_CONTENT_RESIZE)}}getActivePopups(){return this.popupList.map(e=>e.element)}getPopupList(){return this.popupList}getParentRect(){const e=this.gridOptionsService.getDocument();let t=this.getPopupParent();return t===e.body?t=e.documentElement:"static"===getComputedStyle(t).position&&(t=t.offsetParent),Gn(t)}keepXYWithinBounds(e,t,i){const n=i===Cu.vertical,r=n?"clientHeight":"clientWidth",s=n?"top":"left",o=n?"offsetHeight":"offsetWidth",a=n?"scrollTop":"scrollLeft",l=this.gridOptionsService.getDocument(),c=l.documentElement,u=this.getPopupParent(),d=u.getBoundingClientRect(),h=l.documentElement.getBoundingClientRect(),p=u===l.body,f=e[o];let g=p?(n?Ln:Fn)(c)+c[a]:u[r];p&&(g-=Math.abs(h[s]-d[s]));const m=g-f;return Math.min(Math.max(t,0),Math.abs(m))}addPopup(e){const t=this.gridOptionsService.getDocument(),{eChild:i,ariaLabel:n,alwaysOnTop:r,positionCallback:s,anchorToElement:o}=e;if(!t)return console.warn("AG Grid: could not find the document, document is empty"),{hideFunc:()=>{}};const a=this.popupList.findIndex(e=>e.element===i);if(-1!==a){return{hideFunc:this.popupList[a].hideFunc}}this.initialisePopupPosition(i);const l=this.createPopupWrapper(i,n,!!r),c=this.addEventListenersToPopup(Object.assign(Object.assign({},e),{wrapperEl:l}));return s&&s(),this.addPopupToPopupList(i,l,c,o),{hideFunc:c}}initialisePopupPosition(e){const t=this.getPopupParent().getBoundingClientRect();_(e.style.top)||(e.style.top=-1*t.top+"px"),_(e.style.left)||(e.style.left=-1*t.left+"px")}createPopupWrapper(e,t,i){const n=this.getPopupParent(),r=document.createElement("div"),{allThemes:s}=this.environment.getTheme();return s.length&&r.classList.add(...s),r.classList.add("ag-popup"),e.classList.add(this.gridOptionsService.is("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||_i(e,"dialog"),xi(e,t),this.focusService.isKeyboardMode()&&e.classList.add(Zl.AG_KEYBOARD_FOCUS),r.appendChild(e),n.appendChild(r),i?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),r}addEventListenersToPopup(e){const r=this.gridOptionsService.getDocument(),s=this.getPopupParent(),{wrapperEl:o,eChild:a,click:l,closedCallback:c,afterGuiAttached:t,closeOnEsc:i,modal:n}=e;let u=!1;const d=e=>{if(!o.contains(r.activeElement))return;e.key===A.ESCAPE&&f({keyboardEvent:e})},h=e=>f({mouseEvent:e}),p=e=>f({touchEvent:e}),f=(e={})=>{const{mouseEvent:t,touchEvent:i,keyboardEvent:n}=e;this.isEventFromCurrentPopup({mouseEvent:t,touchEvent:i},a)||this.isEventSameChainAsOriginalEvent({originalMouseEvent:l,mouseEvent:t,touchEvent:i})||u||(u=!0,s.removeChild(o),r.removeEventListener("keydown",d),r.removeEventListener("mousedown",h),r.removeEventListener("touchstart",p),r.removeEventListener("contextmenu",h),this.eventService.removeEventListener(y.EVENT_DRAG_STARTED,h),c&&c(t||i||n),this.removePopupFromPopupList(a))};return t&&t({hidePopup:f}),window.setTimeout(()=>{i&&r.addEventListener("keydown",d),n&&(r.addEventListener("mousedown",h),this.eventService.addEventListener(y.EVENT_DRAG_STARTED,h),r.addEventListener("touchstart",p),r.addEventListener("contextmenu",h))},0),f}addPopupToPopupList(e,t,i,n){this.popupList.push({element:e,wrapper:t,hideFunc:i,instanceId:_u++,isAnchored:!!n}),n&&this.setPopupPositionRelatedToElement(e,n)}setPopupPositionRelatedToElement(t,e){const i=this.popupList.find(e=>e.element===t);if(!i)return;if(i.stopAnchoringPromise&&i.stopAnchoringPromise.then(e=>e&&e()),i.stopAnchoringPromise=void 0,i.isAnchored=!1,!e)return;const n=this.keepPopupPositionedRelativeTo({element:e,ePopup:t,hidePopup:i.hideFunc});return i.stopAnchoringPromise=n,i.isAnchored=!0,n}removePopupFromPopupList(t){this.setPopupPositionRelatedToElement(t,null),this.popupList=this.popupList.filter(e=>e.element!==t)}keepPopupPositionedRelativeTo(r){const s=this.getPopupParent(),e=s.getBoundingClientRect(),{element:o,ePopup:a}=r,t=o.getBoundingClientRect(),l=e.top-t.top,c=e.left-t.left;let u=l,d=c;const i=a.style.top,h=parseInt(i.substring(0,i.length-1),10),n=a.style.left,p=parseInt(n.substring(0,n.length-1),10);return new Rr(t=>{this.getFrameworkOverrides().setInterval(()=>{const e=s.getBoundingClientRect(),t=o.getBoundingClientRect();if(0==t.top&&0==t.left&&0==t.height&&0==t.width)return void r.hidePopup();const i=e.top-t.top;if(i!=u){const r=this.keepXYWithinBounds(a,h+l-i,Cu.vertical);a.style.top=r+"px"}u=i;const n=e.left-t.left;if(n!=d){const r=this.keepXYWithinBounds(a,p+c-n,Cu.horizontal);a.style.left=r+"px"}d=n},200).then(e=>{t(()=>{null!=e&&window.clearInterval(e)})})})}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isEventFromCurrentPopup(e,t){const{mouseEvent:i,touchEvent:n}=e,r=i||n;if(!r)return!1;const s=this.popupList.findIndex(e=>e.element===t);if(-1===s)return!1;for(let e=s;e<this.popupList.length;e++){if(_t(this.popupList[e].element,r))return!0}return this.isElementWithinCustomPopup(r.target)}isElementWithinCustomPopup(e){const t=this.gridOptionsService.getDocument();for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||null===e.parentElement)return!0;e=e.parentElement}return!1}isEventSameChainAsOriginalEvent(t){const{originalMouseEvent:i,mouseEvent:n,touchEvent:r}=t;let s=null;if(n?s=n:r&&(s=r.touches[0]),s&&i){const t=n?n.screenX:0,r=n?n.screenY:0,s=Math.abs(i.screenX-t)<5,e=Math.abs(i.screenY-r)<5;if(s&&e)return!0}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const i=this.getWrapper(e);i&&(i.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(i))}bringPopupToFront(e){const t=this.getPopupParent(),i=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),n=i.length,r=Array.prototype.slice.call(t.querySelectorAll(".ag-popup.ag-always-on-top")),s=r.length,o=this.getWrapper(e);if(!o||n<=1||!t.contains(e))return;const a=i.indexOf(o),l=o.querySelectorAll("div"),c=[];if(l.forEach(e=>{0!==e.scrollTop&&c.push([e,e.scrollTop])}),s){o.classList.contains("ag-always-on-top")?a!==n-1&&p(r).insertAdjacentElement("afterend",o):a!==n-s-1&&r[0].insertAdjacentElement("beforebegin",o)}else a!==n-1&&p(i).insertAdjacentElement("afterend",o);for(;c.length;){const e=c.pop();e[0].scrollTop=e[1]}const u={type:"popupToFront",api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,eWrapper:o};this.eventService.dispatchEvent(u)}};Au.WAIT_FOR_POPUP_CONTENT_RESIZE=200,wu([o("focusService")],Au.prototype,"focusService",void 0),wu([o("ctrlsService")],Au.prototype,"ctrlsService",void 0),wu([o("resizeObserverService")],Au.prototype,"resizeObserverService",void 0),wu([r],Au.prototype,"postConstruct",null),Au=bu=wu([s("popupService")],Au);var Eu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Su extends lu{constructor(e="default",t="listbox",i){super(Su.getTemplate(e)),this.cssIdentifier=e,this.ariaRole=t,this.listName=i,this.renderedRows=new Map,this.rowHeight=20}postConstruct(){this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e),focusInnerElement:e=>this.focusInnerElement(e),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)}),this.setAriaProperties(),this.addManagedListener(this.eventService,y.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanged.bind(this))}onGridStylesChanged(){this.rowHeight=this.getItemHeight(),this.refresh()}setAriaProperties(){const e=this.localeService.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),t=this.eContainer;_i(t,this.ariaRole),xi(t,e)}addResizeObserver(){const e=this.resizeObserverService.observeResize(this.getGui(),()=>this.drawVirtualRows());this.addDestroyFunc(e)}focusInnerElement(e){this.focusRow(e?this.model.getRowCount()-1:0)}onFocusIn(e){const t=e.target;return t.classList.contains("ag-virtual-list-item")&&(this.lastFocusedRowIndex=Si(t)-1),!1}onFocusOut(e){return this.getFocusableElement().contains(e.relatedTarget)||(this.lastFocusedRowIndex=null),!1}handleKeyDown(e){switch(e.key){case A.UP:case A.DOWN:this.navigate(e.key===A.UP)&&e.preventDefault()}}onTabKeyDown(e){this.navigate(e.shiftKey)?e.preventDefault():(yt(e),this.forceFocusOutOfContainer(e.shiftKey))}navigate(e){if(null==this.lastFocusedRowIndex)return!1;const t=this.lastFocusedRowIndex+(e?-1:1);return!(t<0||t>=this.model.getRowCount())&&(this.focusRow(t),!0)}getLastFocusedRow(){return this.lastFocusedRowIndex}focusRow(t){this.ensureIndexVisible(t),window.setTimeout(()=>{if(!this.isAlive())return;const e=this.renderedRows.get(t);e&&e.eDiv.focus()},10)}getComponentAt(e){const t=this.renderedRows.get(e);return t&&t.rowComponent}forEachRenderedRow(i){this.renderedRows.forEach((e,t)=>i(e.rowComponent,t))}static getTemplate(e){return`\n            <div class="ag-virtual-list-viewport ag-${e}-virtual-list-viewport" role="presentation">\n                <div class="ag-virtual-list-container ag-${e}-virtual-list-container" ref="eContainer"></div>\n            </div>`}getItemHeight(){return this.environment.getListItemHeight()}ensureIndexVisible(e){const t=this.model.getRowCount();if("number"!=typeof e||e<0||e>=t)return void console.warn("AG Grid: invalid row index for ensureIndexVisible: "+e);const i=e*this.rowHeight,n=i+this.rowHeight,r=this.getGui(),s=r.scrollTop,o=r.offsetHeight,a=s+o<n;if(s>i)r.scrollTop=i;else if(a){const e=n-o;r.scrollTop=e}}setComponentCreator(e){this.componentCreator=e}setComponentUpdater(e){this.componentUpdater=e}getRowHeight(){return this.rowHeight}getScrollTop(){return this.getGui().scrollTop}setRowHeight(e){this.rowHeight=e,this.refresh()}refresh(e){if(null==this.model||!this.isAlive())return;const t=this.model.getRowCount();this.eContainer.style.height=t*this.rowHeight+"px",Le(()=>this.eContainer.clientHeight>=t*this.rowHeight,()=>{this.isAlive()&&(this.canSoftRefresh(e)?this.drawVirtualRows(!0):(this.clearVirtualRows(),this.drawVirtualRows()))})}canSoftRefresh(e){return!!(e&&this.renderedRows.size&&"function"==typeof this.model.areRowsEqual&&this.componentUpdater)}clearVirtualRows(){this.renderedRows.forEach((e,t)=>this.removeRow(t))}drawVirtualRows(e){if(!this.isAlive())return;const t=this.getGui(),i=t.scrollTop,n=i+t.offsetHeight,r=Math.floor(i/this.rowHeight),s=Math.floor(n/this.rowHeight);this.ensureRowsRendered(r,s,e)}ensureRowsRendered(i,n,e){this.renderedRows.forEach((e,t)=>{(t<i||t>n)&&t!==this.lastFocusedRowIndex&&this.removeRow(t)}),e&&this.refreshRows();for(let e=i;e<=n;e++)this.renderedRows.has(e)||e<this.model.getRowCount()&&this.insertRow(e)}insertRow(e){const t=this.model.getRow(e),i=document.createElement("div");if(i.classList.add("ag-virtual-list-item",`ag-${this.cssIdentifier}-virtual-list-item`),_i(i,"tree"===this.ariaRole?"treeitem":"option"),Fi(i,this.model.getRowCount()),Gi(i,e+1),i.setAttribute("tabindex","-1"),"function"==typeof this.model.isRowSelected){const t=this.model.isRowSelected(e);Yi(i,!!t),qi(i,t)}i.style.height=this.rowHeight+"px",i.style.top=this.rowHeight*e+"px";const n=this.componentCreator(t,i);n.addGuiEventListener("focusin",()=>this.lastFocusedRowIndex=e),i.appendChild(n.getGui()),this.renderedRows.has(e-1)?this.renderedRows.get(e-1).eDiv.insertAdjacentElement("afterend",i):this.renderedRows.has(e+1)?this.renderedRows.get(e+1).eDiv.insertAdjacentElement("beforebegin",i):this.eContainer.appendChild(i),this.renderedRows.set(e,{rowComponent:n,eDiv:i,value:t})}removeRow(e){const t=this.renderedRows.get(e);this.eContainer.removeChild(t.eDiv),this.destroyBean(t.rowComponent),this.renderedRows.delete(e)}refreshRows(){const r=this.model.getRowCount();this.renderedRows.forEach((e,t)=>{var i,n;if(t>=r)this.removeRow(t);else{const r=this.model.getRow(t);(null===(n=(i=this.model).areRowsEqual)||void 0===n?void 0:n.call(i,e.value,r))?this.componentUpdater(r,e.rowComponent):this.removeRow(t)}})}addScrollListener(){this.addGuiEventListener("scroll",()=>this.drawVirtualRows(),{passive:!0})}setModel(e){this.model=e}destroy(){this.isAlive()&&(this.clearVirtualRows(),super.destroy())}}Eu([o("resizeObserverService")],Su.prototype,"resizeObserverService",void 0),Eu([S("eContainer")],Su.prototype,"eContainer",void 0),Eu([r],Su.prototype,"postConstruct",null);const Tu=["mouseover","mouseout","mouseenter","mouseleave","mousemove"],xu=["touchstart","touchend","touchmove","touchcancel"];class Du{constructor(){this.renderingEngine="vanilla",this.isOutsideAngular=e=>dt(Tu,e)}setTimeout(e,t){window.setTimeout(e,t)}setInterval(t,i){return new Rr(e=>{e(window.setInterval(t,i))})}addEventListener(e,t,i,n){const r=dt(xu,t);e.addEventListener(t,i,{capture:!!n,passive:r})}dispatchEvent(e,t,i=!1){t()}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}}var Ru=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Mu=class extends f{getNextCellToFocus(e,t,i=!1){return i?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const i=e===A.UP,n=e===A.DOWN,r=e===A.LEFT;let s,o;if(i||n)o=i?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow(),s=t.column;else{const e=this.columnModel.getAllDisplayedColumns(),i=this.gridOptionsService.is("enableRtl");o=t.rowIndex,s=r!==i?e[0]:p(e)}return{rowIndex:o,rowPinned:null,column:s}}getNextCellToFocusWithoutCtrlPressed(e,t){let i=t,n=!1;for(;!n;){switch(e){case A.UP:i=this.getCellAbove(i);break;case A.DOWN:i=this.getCellBelow(i);break;case A.RIGHT:i=this.gridOptionsService.is("enableRtl")?this.getCellToLeft(i):this.getCellToRight(i);break;case A.LEFT:i=this.gridOptionsService.is("enableRtl")?this.getCellToRight(i):this.getCellToLeft(i);break;default:i=null,console.warn("AG Grid: unknown key for navigation "+e)}n=!i||this.isCellGoodToFocusOn(i)}return i}isCellGoodToFocusOn(e){const t=e.column;let i;switch(e.rowPinned){case"top":i=this.pinnedRowModel.getPinnedTopRow(e.rowIndex);break;case"bottom":i=this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);break;default:i=this.rowModel.getRow(e.rowIndex)}if(!i)return!1;return!t.isSuppressNavigable(i)}getCellToLeft(e){if(!e)return null;const t=this.columnModel.getDisplayedColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.columnModel.getDisplayedColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getRowBelow(e){const t=e.rowIndex,i=e.rowPinned;if(this.isLastRowInContainer(e))switch(i){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.paginationProxy.getPageFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}const n=this.rowModel.getRow(e.rowIndex),r=this.getNextStickyPosition(n);return r||{rowIndex:t+1,rowPinned:i}}getNextStickyPosition(t,e){if(!this.gridOptionsService.isGroupRowsSticky()||!t||!t.sticky)return;const i=[...this.rowRenderer.getStickyTopRowCtrls()].sort((e,t)=>e.getRowNode().rowIndex-t.getRowNode().rowIndex),n=e?-1:1,r=i.findIndex(e=>e.getRowNode().rowIndex===t.rowIndex),s=i[r+n];return s?{rowIndex:s.getRowNode().rowIndex,rowPinned:null}:void 0}getCellBelow(e){if(!e)return null;const t=this.getRowBelow(e);return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}isLastRowInContainer(e){const t=e.rowPinned,i=e.rowIndex;if("top"===t){return this.pinnedRowModel.getPinnedTopRowData().length-1<=i}if("bottom"===t){return this.pinnedRowModel.getPinnedBottomRowData().length-1<=i}return this.paginationProxy.getPageLastRow()<=i}getRowAbove(e){const t=e.rowIndex,i=e.rowPinned;if(i?0===t:t===this.paginationProxy.getPageFirstRow())return"top"===i?null:i&&this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;const n=this.rowModel.getRow(e.rowIndex),r=this.getNextStickyPosition(n,!0);return r||{rowIndex:t-1,rowPinned:i}}getCellAbove(e){if(!e)return null;const t=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}getLastBodyCell(){return{rowIndex:this.paginationProxy.getPageLastRow(),rowPinned:null}}getLastFloatingTopRow(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowData().length-1,rowPinned:"top"}}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(t){const i=this.columnModel.getAllDisplayedColumns();let n=t.rowIndex,r=t.rowPinned,s=this.columnModel.getDisplayedColAfter(t.column);if(!s){s=i[0];const e=this.getRowBelow(t);if(u(e))return null;if(!e.rowPinned&&!this.paginationProxy.isRowInPage(e))return null;n=e?e.rowIndex:null,r=e?e.rowPinned:null}return{rowIndex:n,column:s,rowPinned:r}}getNextTabbedCellBackwards(t){const i=this.columnModel.getAllDisplayedColumns();let n=t.rowIndex,r=t.rowPinned,s=this.columnModel.getDisplayedColBefore(t.column);if(!s){s=p(i);const e=this.getRowAbove({rowIndex:t.rowIndex,rowPinned:t.rowPinned});if(u(e))return null;if(!e.rowPinned&&!this.paginationProxy.isRowInPage(e))return null;n=e?e.rowIndex:null,r=e?e.rowPinned:null}return{rowIndex:n,column:s,rowPinned:r}}};Ru([o("columnModel")],Mu.prototype,"columnModel",void 0),Ru([o("rowModel")],Mu.prototype,"rowModel",void 0),Ru([o("rowRenderer")],Mu.prototype,"rowRenderer",void 0),Ru([o("pinnedRowModel")],Mu.prototype,"pinnedRowModel",void 0),Ru([o("paginationProxy")],Mu.prototype,"paginationProxy",void 0),Mu=Ru([s("cellNavigationService")],Mu);var Nu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},Ou=function(i,n){return function(e,t){n(e,t,i)}};let Iu=class extends f{constructor(){super(...arguments),this.consuming=!1}setBeans(e){this.logger=e.create("AlignedGridsService")}init(){this.addManagedListener(this.eventService,y.EVENT_COLUMN_MOVED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_VISIBLE,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PINNED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_GROUP_OPENED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,y.EVENT_COLUMN_RESIZED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,y.EVENT_BODY_SCROLL,this.fireScrollEvent.bind(this))}fireEvent(i){if(this.consuming)return;const e=this.gridOptionsService.get("alignedGrids");e&&e.forEach(t=>{if(t.api){const e=t.api.__getAlignedGridService();i(e)}})}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(t){this.fireEvent(e=>{e.onColumnEvent(t)})}fireScrollEvent(t){"horizontal"===t.direction&&this.fireEvent(e=>{e.onScrollEvent(t)})}onScrollEvent(e){this.onEvent(()=>{this.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}getMasterColumns(e){const t=[];return e.columns?e.columns.forEach(e=>{t.push(e)}):e.column&&t.push(e.column),t}getColumnIds(e){const t=[];return e.columns?e.columns.forEach(e=>{t.push(e.getColId())}):e.column&&t.push(e.column.getColId()),t}onColumnEvent(i){this.onEvent(()=>{switch(i.type){case y.EVENT_COLUMN_MOVED:case y.EVENT_COLUMN_VISIBLE:case y.EVENT_COLUMN_PINNED:case y.EVENT_COLUMN_RESIZED:const e=i;this.processColumnEvent(e);break;case y.EVENT_COLUMN_GROUP_OPENED:const t=i;this.processGroupOpenedEvent(t);break;case y.EVENT_COLUMN_PIVOT_CHANGED:console.warn("AG Grid: pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.")}})}processGroupOpenedEvent(e){const t=e.columnGroup;let i=null;if(t){const e=t.getGroupId();i=this.columnModel.getProvidedColumnGroup(e)}t&&!i||(this.logger.log("onColumnEvent-> processing "+e+" expanded = "+t.isExpanded()),this.columnModel.setColumnGroupOpened(i,t.isExpanded(),"alignedGridChanged"))}processColumnEvent(t){var e;const i=t.column;let n=null;if(i&&(n=this.columnModel.getPrimaryColumn(i.getColId())),i&&!n)return;const r=this.getMasterColumns(t);switch(t.type){case y.EVENT_COLUMN_MOVED:{const e=t,i=t.columnApi.getColumnState().map(e=>({colId:e.colId}));this.columnModel.applyColumnState({state:i,applyOrder:!0},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${t.type} toIndex = ${e.toIndex}`)}break;case y.EVENT_COLUMN_VISIBLE:{const e=t,i=t.columnApi.getColumnState().map(e=>({colId:e.colId,hide:e.hide}));this.columnModel.applyColumnState({state:i},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${t.type} visible = ${e.visible}`)}break;case y.EVENT_COLUMN_PINNED:{const e=t,i=t.columnApi.getColumnState().map(e=>({colId:e.colId,pinned:e.pinned}));this.columnModel.applyColumnState({state:i},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${t.type} pinned = ${e.pinned}`)}break;case y.EVENT_COLUMN_RESIZED:const i=t,n={};r.forEach(e=>{this.logger.log(`onColumnEvent-> processing ${t.type} actualWidth = ${e.getActualWidth()}`),n[e.getId()]={key:e.getColId(),newWidth:e.getActualWidth()}}),null===(e=i.flexColumns)||void 0===e||e.forEach(e=>{n[e.getId()]&&delete n[e.getId()]}),this.columnModel.setColumnWidths(Object.values(n),!1,i.finished,"alignedGridChanged")}const s=this.ctrlsService.getGridBodyCtrl().isVerticalScrollShowing(),o=this.gridOptionsService.get("alignedGrids");o&&o.forEach(e=>{e.api&&e.api.setAlwaysShowVerticalScroll(s)})}};Nu([o("columnModel")],Iu.prototype,"columnModel",void 0),Nu([o("ctrlsService")],Iu.prototype,"ctrlsService",void 0),Nu([Ou(0,ze("loggerFactory"))],Iu.prototype,"setBeans",null),Nu([r],Iu.prototype,"init",null),Iu=Nu([s("alignedGridsService")],Iu);var Pu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},ku=function(i,n){return function(e,t){n(e,t,i)}};let Lu=class extends f{setBeans(e){this.logger=e.create("selectionService"),this.reset()}init(){this.groupSelectsChildren=this.gridOptionsService.is("groupSelectsChildren"),this.addManagedPropertyListener("groupSelectsChildren",e=>this.groupSelectsChildren=e.currentValue),this.rowSelection=this.gridOptionsService.get("rowSelection"),this.addManagedPropertyListener("rowSelection",e=>this.rowSelection=e.currentValue),this.addManagedListener(this.eventService,y.EVENT_ROW_SELECTED,this.onRowSelected.bind(this))}isMultiselect(){return"multiple"===this.rowSelection}setNodesSelected(t){var i;if(0===t.nodes.length)return 0;const{newValue:n,clearSelection:e,suppressFinishActions:r,rangeSelect:s,event:o,source:a="api"}=t;if(t.nodes.length>1&&!this.isMultiselect())return console.warn("AG Grid: cannot multi select while rowSelection='single'"),0;const l=this.groupSelectsChildren&&!0===t.groupSelectsFiltered,c=t.nodes.map(e=>e.footer?e.sibling:e);if(s){if(t.nodes.length>1)return console.warn("AG Grid: cannot range select while selecting multiple rows"),0;const i=this.getLastSelectedNode();if(i){const n=c[0];if(i!==n&&this.isMultiselect()){const e=this.selectRange(n,i,t.newValue,a);return this.setLastSelectedNode(n),e}}}let u=0;for(let e=0;e<c.length;e++){const r=c[e];if(!(l&&r.group)){r.selectThisNode(n,t.event,a)&&u++}this.groupSelectsChildren&&(null===(i=r.childrenAfterGroup)||void 0===i?void 0:i.length)&&(u+=this.selectChildren(r,n,l,a))}if(!r){if(n&&(e||!this.isMultiselect())&&(u+=this.clearOtherNodes(c[0],a)),u>0){this.updateGroupsFromChildrenSelections(a);const t={type:y.EVENT_SELECTION_CHANGED,source:a};this.eventService.dispatchEvent(t)}n&&this.setLastSelectedNode(c[c.length-1])}return u}selectRange(t,e,i=!0,n){const r=this.rowModel.getNodesInRangeForSelection(t,e);let s=0;r.forEach(e=>{if(e.group&&this.groupSelectsChildren||!1===i&&t===e)return;e.selectThisNode(i,void 0,n)&&s++}),this.updateGroupsFromChildrenSelections(n);const o={type:y.EVENT_SELECTION_CHANGED,source:n};return this.eventService.dispatchEvent(o),s}selectChildren(e,t,i,n){const r=i?e.childrenAfterAggFilter:e.childrenAfterGroup;return Tr.missing(r)?0:this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:i,source:n,nodes:r})}setLastSelectedNode(e){this.lastSelectedNode=e}getLastSelectedNode(){return this.lastSelectedNode}getSelectedNodes(){const i=[];return a(this.selectedNodes,(e,t)=>{t&&i.push(t)}),i}getSelectedRows(){const i=[];return a(this.selectedNodes,(e,t)=>{t&&t.data&&i.push(t.data)}),i}getSelectionCount(){return Object.values(this.selectedNodes).length}filterFromSelection(i){const n={};Object.entries(this.selectedNodes).forEach(([e,t])=>{t&&i(t)&&(n[e]=t)}),this.selectedNodes=n}updateGroupsFromChildrenSelections(t,e){if(!this.groupSelectsChildren)return!1;if("clientSide"!==this.rowModel.getType())return!1;const i=this.rowModel.getRootNode();e||(e=new zc(!0,i)).setInactive();let n=!1;return e.forEachChangedNodeDepthFirst(e=>{if(e!==i){const i=e.calculateSelectedFromChildren();n=e.selectThisNode(null!==i&&i,void 0,t)||n}}),n}clearOtherNodes(i,n){const r={};let s=0;return a(this.selectedNodes,(e,t)=>{if(t&&t.id!==i.id){const i=this.selectedNodes[t.id];s+=i.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:n}),this.groupSelectsChildren&&t.parent&&(r[t.parent.id]=t.parent)}}),a(r,(e,t)=>{const i=t.calculateSelectedFromChildren();t.selectThisNode(null!==i&&i,void 0,n)}),s}onRowSelected(e){const t=e.node;this.groupSelectsChildren&&t.group||(t.isSelected()?this.selectedNodes[t.id]=t:delete this.selectedNodes[t.id])}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}syncInOldRowNode(t,i){if(_(i)&&t.id!==i.id&&i){const e=i.id;this.selectedNodes[e]==t&&(this.selectedNodes[i.id]=i)}}syncInNewRowNode(e){_(this.selectedNodes[e.id])?(e.setSelectedInitialValue(!0),this.selectedNodes[e.id]=e):e.setSelectedInitialValue(!1)}reset(){this.logger.log("reset"),this.selectedNodes={},this.lastSelectedNode=null}getBestCostNodeSelection(){if("clientSide"!==this.rowModel.getType())return;const e=this.rowModel.getTopLevelNodes();if(null===e)return;const r=[];return function i(n){for(let t=0,e=n.length;t<e;t++){const e=n[t];if(e.isSelected())r.push(e);else{const r=e;r.group&&r.children&&i(r.children)}}}(e),r}isEmpty(){let i=0;return a(this.selectedNodes,(e,t)=>{t&&i++}),0===i}deselectAllRowNodes(e){const i=e=>e.selectThisNode(!1,void 0,n),t="clientSide"===this.rowModel.getType(),{source:n,justFiltered:r,justCurrentPage:s}=e;if(s||r){if(!t)return void console.error("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'");this.getNodesToSelect(r,s).forEach(i)}else a(this.selectedNodes,(e,t)=>{t&&i(t)}),this.reset();t&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(n);const o={type:y.EVENT_SELECTION_CHANGED,source:n};this.eventService.dispatchEvent(o)}getSelectAllState(e,t){let i=0,n=0;return this.getNodesToSelect(e,t).forEach(e=>{this.groupSelectsChildren&&e.group||(e.isSelected()?i++:e.selectable&&n++)}),(0!==i||0!==n)&&(i>0&&n>0?null:i>0)}getNodesToSelect(e=!1,t=!1){if("clientSide"!==this.rowModel.getType())throw new Error("selectAll only available when rowModelType='clientSide', ie not "+this.rowModel.getType());const n=[];if(t)return this.paginationProxy.forEachNodeOnPage(e=>{if(e.group)if(e.expanded)this.groupSelectsChildren||n.push(e);else{const i=e=>{var t;n.push(e),(null===(t=e.childrenAfterFilter)||void 0===t?void 0:t.length)&&e.childrenAfterFilter.forEach(i)};i(e)}else n.push(e)}),n;const i=this.rowModel;return e?(i.forEachNodeAfterFilter(e=>{n.push(e)}),n):(i.forEachNode(e=>{n.push(e)}),n)}selectAllRowNodes(e){if("clientSide"!==this.rowModel.getType())throw new Error("selectAll only available when rowModelType='clientSide', ie not "+this.rowModel.getType());const{source:t,justFiltered:i,justCurrentPage:n}=e;this.getNodesToSelect(i,n).forEach(e=>e.selectThisNode(!0,void 0,t)),"clientSide"===this.rowModel.getType()&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(t);const r={type:y.EVENT_SELECTION_CHANGED,source:t};this.eventService.dispatchEvent(r)}getServerSideSelectionState(){return null}setServerSideSelectionState(e){}};Pu([o("rowModel")],Lu.prototype,"rowModel",void 0),Pu([o("paginationProxy")],Lu.prototype,"paginationProxy",void 0),Pu([ku(0,ze("loggerFactory"))],Lu.prototype,"setBeans",null),Pu([r],Lu.prototype,"init",null),Lu=Pu([s("selectionService")],Lu);var Fu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Gu=class{sizeColumnsToFit(e){void 0===e&&console.error("AG Grid: missing parameter to columnApi.sizeColumnsToFit(gridWidth)"),this.columnModel.sizeColumnsToFit(e,"api")}setColumnGroupOpened(e,t){this.columnModel.setColumnGroupOpened(e,t,"api")}getColumnGroup(e,t){return this.columnModel.getColumnGroup(e,t)}getProvidedColumnGroup(e){return this.columnModel.getProvidedColumnGroup(e)}getDisplayNameForColumn(e,t){return this.columnModel.getDisplayNameForColumn(e,t)||""}getDisplayNameForColumnGroup(e,t){return this.columnModel.getDisplayNameForColumnGroup(e,t)||""}getColumn(e){return this.columnModel.getPrimaryColumn(e)}getColumns(){return this.columnModel.getAllPrimaryColumns()}applyColumnState(e){return this.columnModel.applyColumnState(e,"api")}getColumnState(){return this.columnModel.getColumnState()}resetColumnState(){this.columnModel.resetColumnState("api")}getColumnGroupState(){return this.columnModel.getColumnGroupState()}setColumnGroupState(e){this.columnModel.setColumnGroupState(e,"api")}resetColumnGroupState(){this.columnModel.resetColumnGroupState("api")}isPinning(){return this.columnModel.isPinningLeft()||this.columnModel.isPinningRight()}isPinningLeft(){return this.columnModel.isPinningLeft()}isPinningRight(){return this.columnModel.isPinningRight()}getDisplayedColAfter(e){return this.columnModel.getDisplayedColAfter(e)}getDisplayedColBefore(e){return this.columnModel.getDisplayedColBefore(e)}setColumnVisible(e,t){this.columnModel.setColumnVisible(e,t,"api")}setColumnsVisible(e,t){this.columnModel.setColumnsVisible(e,t,"api")}setColumnPinned(e,t){this.columnModel.setColumnPinned(e,t,"api")}setColumnsPinned(e,t){this.columnModel.setColumnsPinned(e,t,"api")}getAllGridColumns(){return this.columnModel.getAllGridColumns()}getDisplayedLeftColumns(){return this.columnModel.getDisplayedLeftColumns()}getDisplayedCenterColumns(){return this.columnModel.getDisplayedCenterColumns()}getDisplayedRightColumns(){return this.columnModel.getDisplayedRightColumns()}getAllDisplayedColumns(){return this.columnModel.getAllDisplayedColumns()}getAllDisplayedVirtualColumns(){return this.columnModel.getViewportColumns()}moveColumn(e,t){this.columnModel.moveColumn(e,t,"api")}moveColumnByIndex(e,t){this.columnModel.moveColumnByIndex(e,t,"api")}moveColumns(e,t){this.columnModel.moveColumns(e,t,"api")}moveRowGroupColumn(e,t){this.columnModel.moveRowGroupColumn(e,t)}setColumnAggFunc(e,t){this.columnModel.setColumnAggFunc(e,t)}setColumnWidth(e,t,i=!0,n){this.columnModel.setColumnWidths([{key:e,newWidth:t}],!1,i,n)}setColumnWidths(e,t=!0,i){this.columnModel.setColumnWidths(e,!1,t,i)}setPivotMode(e){this.columnModel.setPivotMode(e)}isPivotMode(){return this.columnModel.isPivotMode()}getPivotResultColumn(e,t){return this.columnModel.getSecondaryPivotColumn(e,t)}setValueColumns(e){this.columnModel.setValueColumns(e,"api")}getValueColumns(){return this.columnModel.getValueColumns()}removeValueColumn(e){this.columnModel.removeValueColumn(e,"api")}removeValueColumns(e){this.columnModel.removeValueColumns(e,"api")}addValueColumn(e){this.columnModel.addValueColumn(e,"api")}addValueColumns(e){this.columnModel.addValueColumns(e,"api")}setRowGroupColumns(e){this.columnModel.setRowGroupColumns(e,"api")}removeRowGroupColumn(e){this.columnModel.removeRowGroupColumn(e,"api")}removeRowGroupColumns(e){this.columnModel.removeRowGroupColumns(e,"api")}addRowGroupColumn(e){this.columnModel.addRowGroupColumn(e,"api")}addRowGroupColumns(e){this.columnModel.addRowGroupColumns(e,"api")}getRowGroupColumns(){return this.columnModel.getRowGroupColumns()}setPivotColumns(e){this.columnModel.setPivotColumns(e,"api")}removePivotColumn(e){this.columnModel.removePivotColumn(e,"api")}removePivotColumns(e){this.columnModel.removePivotColumns(e,"api")}addPivotColumn(e){this.columnModel.addPivotColumn(e,"api")}addPivotColumns(e){this.columnModel.addPivotColumns(e,"api")}getPivotColumns(){return this.columnModel.getPivotColumns()}getLeftDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeLeft()}getCenterDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeCentre()}getRightDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeRight()}getAllDisplayedColumnGroups(){return this.columnModel.getAllDisplayedTrees()}autoSizeColumn(e,t){return this.columnModel.autoSizeColumn(e,t,"api")}autoSizeColumns(e,t){this.columnModel.autoSizeColumns({columns:e,skipHeader:t})}autoSizeAllColumns(e){this.columnModel.autoSizeAllColumns(e,"api")}setPivotResultColumns(e){this.columnModel.setSecondaryColumns(e,"api")}getPivotResultColumns(){return this.columnModel.getSecondaryColumns()}cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid(){setTimeout(Tr.removeAllReferences.bind(window,this,"Column API"),100)}getAllColumns(){return Xt("28.0","getAllColumns","getColumns"),this.getColumns()}getPrimaryColumns(){return Xt("28.0","getPrimaryColumns","getColumns"),this.getColumns()}getSecondaryColumns(){return Xt("28.0","getSecondaryColumns","getPivotResultColumns"),this.getPivotResultColumns()}setSecondaryColumns(e){Xt("28.0","setSecondaryColumns","setPivotResultColumns"),this.setPivotResultColumns(e)}getSecondaryPivotColumn(e,t){return Xt("28.0","getSecondaryPivotColumn","getPivotResultColumn"),this.getPivotResultColumn(e,t)}};Fu([o("columnModel")],Gu.prototype,"columnModel",void 0),Fu([Ve],Gu.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),Gu=Fu([s("columnApi")],Gu);var $u=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Hu=class extends f{constructor(){super(...arguments),this.initialised=!1,this.isSsrm=!1}init(){this.isSsrm=this.gridOptionsService.isRowModelType("serverSide"),this.cellExpressions=this.gridOptionsService.is("enableCellExpressions"),this.isTreeData=this.gridOptionsService.is("treeData"),this.initialised=!0,this.eventService.addEventListener(y.EVENT_CELL_VALUE_CHANGED,e=>this.callColumnCellValueChangedHandler(e),this.gridOptionsService.useAsyncEvents()),this.addManagedPropertyListener("treeData",e=>this.isTreeData=e.currentValue)}getValue(e,t,i=!1,n=!1){if(this.initialised||this.init(),!t)return;const r=e.getColDef(),s=r.field,o=e.getColId(),a=t.data;let l;const c=t.groupData&&void 0!==t.groupData[o],u=!n&&t.aggData&&void 0!==t.aggData[o],d=this.isSsrm&&n&&!!e.getColDef().aggFunc,h=this.isSsrm&&t.footer&&t.field&&(!0===e.getColDef().showRowGroup||e.getColDef().showRowGroup===t.field);if(i&&r.filterValueGetter?l=this.executeFilterValueGetter(r.filterValueGetter,a,e,t):this.isTreeData&&u?l=t.aggData[o]:this.isTreeData&&r.valueGetter?l=this.executeValueGetter(r.valueGetter,a,e,t):this.isTreeData&&s&&a?l=Ae(a,s,e.isFieldContainsDots()):c?l=t.groupData[o]:u?l=t.aggData[o]:r.valueGetter?l=this.executeValueGetter(r.valueGetter,a,e,t):h?l=Ae(a,t.field,e.isFieldContainsDots()):s&&a&&!d&&(l=Ae(a,s,e.isFieldContainsDots())),this.cellExpressions&&"string"==typeof l&&0===l.indexOf("=")){const i=l.substring(1);l=this.executeValueGetter(i,a,e,t)}if(null==l){const i=this.getOpenedGroup(t,e);if(null!=i)return i}return l}getOpenedGroup(e,t){if(!this.gridOptionsService.is("showOpenedGroup"))return;if(!t.getColDef().showRowGroup)return;const i=t.getColDef().showRowGroup;let n=e.parent;for(;null!=n;){if(n.rowGroupColumn&&(!0===i||i===n.rowGroupColumn.getColId()))return n.key;n=n.parent}}setValue(e,t,i,n){const r=this.columnModel.getPrimaryColumn(t);if(!e||!r)return!1;u(e.data)&&(e.data={});const{field:s,valueSetter:o}=r.getColDef();if(u(s)&&u(o))return console.warn("AG Grid: you need either field or valueSetter set on colDef for editing to work"),!1;if(!this.dataTypeService.checkType(r,i))return console.warn("AG Grid: Data type of the new value does not match the cell data type of the column"),!1;const a={node:e,data:e.data,oldValue:this.getValue(r,e),newValue:i,colDef:r.getColDef(),column:r,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};let l;if(a.newValue=i,l=_(o)?"function"==typeof o?o(a):this.expressionService.evaluate(o,a):this.setValueUsingField(e.data,s,i,r.isFieldContainsDots()),void 0===l&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache.onDataChanged(),a.newValue=this.getValue(r,e);const c={type:y.EVENT_CELL_VALUE_CHANGED,event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:a.column,api:a.api,columnApi:a.columnApi,colDef:a.colDef,context:a.context,data:e.data,node:e,oldValue:a.oldValue,newValue:a.newValue,value:a.newValue,source:n};return this.eventService.dispatchEvent(c),!0}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;"function"==typeof t&&t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,columnApi:e.columnApi,context:e.context})}setValueUsingField(t,i,n,r){if(!i)return!1;let s=!1;if(r){const r=i.split(".");let e=t;for(;r.length>0&&e;){const t=r.shift();0===r.length?(s=e[t]==n,s||(e[t]=n)):e=e[t]}}else s=t[i]==n,s||(t[i]=n);return!s}executeFilterValueGetter(e,t,i,n){const r={data:t,node:n,column:i,colDef:i.getColDef(),api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,getValue:this.getValueCallback.bind(this,n)};return"function"==typeof e?e(r):this.expressionService.evaluate(e,r)}executeValueGetter(e,t,i,n){const r=i.getColId(),s=this.valueCache.getValue(n,r);if(void 0!==s)return s;const o={data:t,node:n,column:i,colDef:i.getColDef(),api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,getValue:this.getValueCallback.bind(this,n)};let a;return a="function"==typeof e?e(o):this.expressionService.evaluate(e,o),this.valueCache.setValue(n,r,a),a}getValueCallback(e,t){const i=this.columnModel.getPrimaryColumn(t);return i?this.getValue(i,e):null}getKeyForNode(e,t){const i=this.getValue(e,t),n=e.getColDef().keyCreator;let r=i;if(n){r=n({value:i,colDef:e.getColDef(),column:e,node:t,data:t.data,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context})}return"string"==typeof r||null==r||(r=String(r),"[object Object]"===r&&l(()=>{console.warn("AG Grid: a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")},"getKeyForNode - warn about [object,object]")),r}};$u([o("expressionService")],Hu.prototype,"expressionService",void 0),$u([o("columnModel")],Hu.prototype,"columnModel",void 0),$u([o("valueCache")],Hu.prototype,"valueCache",void 0),$u([o("dataTypeService")],Hu.prototype,"dataTypeService",void 0),$u([r],Hu.prototype,"init",null),Hu=$u([s("valueService")],Hu);var Bu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},Vu=function(i,n){return function(e,t){n(e,t,i)}};let Wu=class extends f{constructor(){super(...arguments),this.expressionToFunctionCache={}}setBeans(e){this.logger=e.create("ExpressionService")}evaluate(e,t){if("string"==typeof e)return this.evaluateExpression(e,t);console.error("AG Grid: value should be either a string or a function",e)}evaluateExpression(t,i){try{const e=this.createExpressionFunction(t);return e(i.value,i.context,i.oldValue,i.newValue,i.value,i.node,i.data,i.colDef,i.rowIndex,i.api,i.columnApi,i.getValue,i.column,i.columnGroup)}catch(e){return console.log("Processing of the expression failed"),console.log("Expression = "+t),console.log("Params =",i),console.log("Exception = "+e),null}}createExpressionFunction(e){if(this.expressionToFunctionCache[e])return this.expressionToFunctionCache[e];const t=this.createFunctionBody(e),i=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, columnApi, getValue, column, columnGroup",t);return this.expressionToFunctionCache[e]=i,i}createFunctionBody(e){return e.indexOf("return")>=0?e:"return "+e+";"}};Bu([Vu(0,ze("loggerFactory"))],Wu.prototype,"setBeans",null),Wu=Bu([s("expressionService")],Wu);var zu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let ju=class extends f{constructor(){super(...arguments),this.templateCache={},this.waitingCallbacks={}}getTemplate(e,t){const i=this.templateCache[e];if(i)return i;let n=this.waitingCallbacks[e];const r=this;if(!n){n=[],this.waitingCallbacks[e]=n;const t=new XMLHttpRequest;t.onload=function(){r.handleHttpResult(this,e)},t.open("GET",e),t.send()}return t&&n.push(t),null}handleHttpResult(e,t){if(200!==e.status||null===e.response)return void console.warn(`AG Grid: Unable to get template error ${e.status} - ${t}`);this.templateCache[t]=e.response||e.responseText;const i=this.waitingCallbacks[t];for(let e=0;e<i.length;e++){(0,i[e])()}}};ju=zu([s("templateService")],ju);var Uu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},Yu=function(i,n){return function(e,t){n(e,t,i)}};let qu=class extends f{setBeans(e){this.logging=e.is("debug")}create(e){return new Ku(e,this.isLogging.bind(this))}isLogging(){return this.logging}};Uu([Yu(0,ze("gridOptionsService"))],qu.prototype,"setBeans",null),qu=Uu([s("loggerFactory")],qu);class Ku{constructor(e,t){this.name=e,this.isLoggingFunc=t}isLogging(){return this.isLoggingFunc()}log(e){this.isLoggingFunc()&&console.log("AG Grid."+this.name+": "+e)}}var Xu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Qu extends f{setComp(e,t,i){this.view=e,this.eGridHostDiv=t,this.eGui=i,this.eGui.setAttribute("grid-id",this.context.getGridId()),this.dragAndDropService.addDropTarget({getContainer:()=>this.eGui,isInterestedIn:e=>e===Js.HeaderCell||e===Js.ToolPanel,getIconName:()=>M.ICON_NOT_ALLOWED}),this.mouseEventService.stampTopLevelGridCompWithGridInstance(t),this.createManagedBean(new da(this.view)),this.addRtlSupport(),this.addManagedListener(this,y.EVENT_KEYBOARD_FOCUS,()=>{this.view.addOrRemoveKeyboardFocusClass(!0)}),this.addManagedListener(this,y.EVENT_MOUSE_FOCUS,()=>{this.view.addOrRemoveKeyboardFocusClass(!1)});const n=this.resizeObserverService.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>n()),this.ctrlsService.registerGridCtrl(this)}isDetailGrid(){var e;const t=this.focusService.findTabbableParent(this.getGui());return(null===(e=null==t?void 0:t.getAttribute("row-id"))||void 0===e?void 0:e.startsWith("detail"))||!1}showDropZones(){return v.__isRegistered(m.RowGroupingModule,this.context.getGridId())}showSideBar(){return v.__isRegistered(m.SideBarModule,this.context.getGridId())}showStatusBar(){return v.__isRegistered(m.StatusBarModule,this.context.getGridId())}showWatermark(){return v.__isRegistered(m.EnterpriseCoreModule,this.context.getGridId())}onGridSizeChanged(){const e={type:y.EVENT_GRID_SIZE_CHANGED,clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight};this.eventService.dispatchEvent(e)}addRtlSupport(){const e=this.gridOptionsService.is("enableRtl")?"ag-rtl":"ag-ltr";this.view.setRtlClass(e)}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){this.view.setCursor(e?"ew-resize":null)}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.gridOptionsService.getDocument(),i=this.view.getFocusableContainers(),n=i.findIndex(e=>e.contains(t.activeElement))+(e?-1:1);return!(n<=0||n>=i.length)&&this.focusService.focusInto(i[n])}focusInnerElement(e){const t=this.view.getFocusableContainers(),i=this.columnModel.getAllDisplayedColumns();if(e){if(t.length>1)return this.focusService.focusInto(p(t),!0);const e=p(i);if(this.focusService.focusGridView(e,!0))return!0}return 0===this.gridOptionsService.getNum("headerHeight")?this.focusService.focusGridView(i[0]):this.focusService.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}}Xu([o("focusService")],Qu.prototype,"focusService",void 0),Xu([o("resizeObserverService")],Qu.prototype,"resizeObserverService",void 0),Xu([o("columnModel")],Qu.prototype,"columnModel",void 0),Xu([o("ctrlsService")],Qu.prototype,"ctrlsService",void 0),Xu([o("mouseEventService")],Qu.prototype,"mouseEventService",void 0),Xu([o("dragAndDropService")],Qu.prototype,"dragAndDropService",void 0);var Zu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Ju extends lu{constructor(e){super(),this.eGridDiv=e}postConstruct(){this.logger=this.loggerFactory.create("GridComp");const e={destroyGridUi:()=>this.destroyBean(this),setRtlClass:e=>this.addCssClass(e),addOrRemoveKeyboardFocusClass:e=>this.addOrRemoveCssClass(Zl.AG_KEYBOARD_FOCUS,e),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:e=>{this.getGui().style.userSelect=null!=e?e:"",this.getGui().style.webkitUserSelect=null!=e?e:""},setCursor:e=>{this.getGui().style.cursor=null!=e?e:""}};this.ctrl=this.createManagedBean(new Qu);const t=this.createTemplate();this.setTemplate(t),this.ctrl.setComp(e,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:e=>this.ctrl.focusInnerElement(e)})}insertGridIntoDom(){const e=this.getGui();this.eGridDiv.appendChild(e),this.addDestroyFunc(()=>{this.eGridDiv.removeChild(e),this.logger.log("Grid removed from DOM")})}updateLayoutClasses(e,t){const i=this.eRootWrapperBody.classList;i.toggle(ca.AUTO_HEIGHT,t.autoHeight),i.toggle(ca.NORMAL,t.normal),i.toggle(ca.PRINT,t.print),this.addOrRemoveCssClass(ca.AUTO_HEIGHT,t.autoHeight),this.addOrRemoveCssClass(ca.NORMAL,t.normal),this.addOrRemoveCssClass(ca.PRINT,t.print)}createTemplate(){return`<div class="ag-root-wrapper" role="presentation">\n                ${this.ctrl.showDropZones()?"<ag-grid-header-drop-zones></ag-grid-header-drop-zones>":""}\n                <div class="ag-root-wrapper-body" ref="rootWrapperBody" role="presentation">\n                    <ag-grid-body ref="gridBody"></ag-grid-body>\n                    ${this.ctrl.showSideBar()?'<ag-side-bar ref="sideBar"></ag-side-bar>':""}\n                </div>\n                ${this.ctrl.showStatusBar()?'<ag-status-bar ref="statusBar"></ag-status-bar>':""}\n                <ag-pagination></ag-pagination>\n                ${this.ctrl.showWatermark()?"<ag-watermark></ag-watermark>":""}\n            </div>`}getFocusableElement(){return this.eRootWrapperBody}getFocusableContainers(){const e=[this.gridBodyComp.getGui()];return this.sideBarComp&&e.push(this.sideBarComp.getGui()),e.filter(e=>jn(e))}}Zu([o("loggerFactory")],Ju.prototype,"loggerFactory",void 0),Zu([S("gridBody")],Ju.prototype,"gridBodyComp",void 0),Zu([S("sideBar")],Ju.prototype,"sideBarComp",void 0),Zu([S("rootWrapperBody")],Ju.prototype,"eRootWrapperBody",void 0),Zu([r],Ju.prototype,"postConstruct",null);var ed,td=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let id=ed=class extends f{progressSort(e,t,i){const n=this.getNextSortDirection(e);this.setSortForColumn(e,n,t,i)}setSortForColumn(e,t,i,n){"asc"!==t&&"desc"!==t&&(t=null);let r=[e];if(this.gridOptionsService.isColumnsSortingCoupledToGroup()&&e.getColDef().showRowGroup){const t=this.columnModel.getSourceColumnsForGroupColumn(e),i=null==t?void 0:t.filter(e=>e.getColDef().sortable);i&&(r=[e,...i])}r.forEach(e=>e.setSort(t,n));(i||this.gridOptionsService.is("alwaysMultiSort"))&&!this.gridOptionsService.is("suppressMultiSort")||this.clearSortBarTheseColumns(r,n),this.updateSortIndex(e),this.dispatchSortChangedEvents(n)}updateSortIndex(e){const t=this.gridOptionsService.isColumnsSortingCoupledToGroup(),i=this.columnModel.getGroupDisplayColumnForGroup(e.getId()),n=t&&i||e,r=this.getColumnsWithSortingOrdered();this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(e=>e.setSortIndex(null));const s=r.filter(e=>e!==n);(n.getSort()?[...s,n]:s).forEach((e,t)=>e.setSortIndex(t))}onSortChanged(e){this.dispatchSortChangedEvents(e)}isSortActive(){const e=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(e=>!!e.getSort());return e&&e.length>0}dispatchSortChangedEvents(e){const t={type:y.EVENT_SORT_CHANGED,source:e};this.eventService.dispatchEvent(t)}clearSortBarTheseColumns(t,i){this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(e=>{t.includes(e)||e.setSort(void 0,i)})}getNextSortDirection(e){let t;if(t=e.getColDef().sortingOrder?e.getColDef().sortingOrder:this.gridOptionsService.get("sortingOrder")?this.gridOptionsService.get("sortingOrder"):ed.DEFAULT_SORTING_ORDER,!Array.isArray(t)||t.length<=0)return console.warn("AG Grid: sortingOrder must be an array with at least one element, currently it's "+t),null;const i=t.indexOf(e.getSort()),n=i<0,r=i==t.length-1;let s;return s=n||r?t[0]:t[i+1],ed.DEFAULT_SORTING_ORDER.indexOf(s)<0?(console.warn("AG Grid: invalid sort type "+s),null):s}getIndexedSortMap(){let e=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(e=>!!e.getSort());if(this.columnModel.isPivotMode()){const r=this.gridOptionsService.isColumnsSortingCoupledToGroup();e=e.filter(e=>{const t=!!e.getAggFunc(),i=!e.isPrimary(),n=r?this.columnModel.getGroupDisplayColumnForGroup(e.getId()):e.getColDef().showRowGroup;return t||i||n})}const r=this.columnModel.getRowGroupColumns().filter(e=>!!e.getSort()),t=this.gridOptionsService.isColumnsSortingCoupledToGroup()&&!!r.length;t&&(e=[...new Set(e.map(e=>{var t;return null!==(t=this.columnModel.getGroupDisplayColumnForGroup(e.getId()))&&void 0!==t?t:e}))]);const s={};e.forEach((e,t)=>s[e.getId()]=t),e.sort((e,t)=>{const i=e.getSortIndex(),n=t.getSortIndex();if(null!=i&&null!=n)return i-n;if(null==i&&null==n){return s[e.getId()]>s[t.getId()]?1:-1}return null==n?-1:1});const i=new Map;return e.forEach((e,t)=>i.set(e,t)),t&&r.forEach(e=>{const t=this.columnModel.getGroupDisplayColumnForGroup(e.getId());i.set(e,i.get(t))}),i}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([e,t],[i,n])=>t-n).map(([e])=>e)}getSortModel(){return this.getColumnsWithSortingOrdered().map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){const t=this.gridOptionsService.isColumnsSortingCoupledToGroup(),i=!!e.getColDef().showRowGroup;return t&&i}getDisplaySortForColumn(e){const t=this.columnModel.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!(null==t?void 0:t.length))return e.getSort();const i=!!e.getColDef().field?[e,...t]:t,n=i[0].getSort();return i.every(e=>e.getSort()==n)?n:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}};id.DEFAULT_SORTING_ORDER=["asc","desc",null],td([o("columnModel")],id.prototype,"columnModel",void 0),id=ed=td([s("sortController")],id);var nd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let rd=class extends f{setMouseOver(e){this.selectedColumns=e;const t={type:y.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(t)}clearMouseOver(){this.selectedColumns=null;const e={type:y.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(e)}isHovered(e){return!!this.selectedColumns&&this.selectedColumns.indexOf(e)>=0}};rd=nd([s("columnHoverService")],rd);var sd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let od=class extends f{constructor(){super(...arguments),this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.animationThreadCount=0}postConstruct(){this.ctrlsService.whenReady(e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active}start(){this.active||this.gridOptionsService.is("suppressColumnMoveAnimation")||this.gridOptionsService.is("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0)}finish(){this.active&&(this.flush(),this.active=!1)}executeNextVMTurn(e){this.active?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&this.gridBodyCtrl.setColumnMovingCss(!1)})}flush(){const e=this.executeNextFuncs;this.executeNextFuncs=[];const t=this.executeLaterFuncs;this.executeLaterFuncs=[],0===e.length&&0===t.length||(window.setTimeout(()=>e.forEach(e=>e()),0),window.setTimeout(()=>t.forEach(e=>e()),300))}};sd([o("ctrlsService")],od.prototype,"ctrlsService",void 0),sd([r],od.prototype,"postConstruct",null),od=sd([s("columnAnimationService")],od);var ad=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let ld=class extends f{postConstruct(){this.ctrlsService.whenReady(e=>{this.centerRowContainerCon=e.centerRowContainerCtrl,this.addManagedListener(this.eventService,y.EVENT_BODY_HEIGHT_CHANGED,this.checkPageSize.bind(this)),this.addManagedListener(this.eventService,y.EVENT_SCROLL_VISIBILITY_CHANGED,this.checkPageSize.bind(this)),this.checkPageSize()})}notActive(){return!this.gridOptionsService.is("paginationAutoPageSize")||null==this.centerRowContainerCon}checkPageSize(){if(this.notActive())return;const i=this.centerRowContainerCon.getViewportSizeFeature().getBodyHeight();if(i>0){const e=()=>{const e=this.gridOptionsService.getRowHeightAsNumber(),t=Math.floor(i/e);this.gridOptionsService.set("paginationPageSize",t)};this.isBodyRendered?Pe(()=>e(),50)():(e(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}};ad([o("ctrlsService")],ld.prototype,"ctrlsService",void 0),ad([r],ld.prototype,"postConstruct",null),ld=ad([s("paginationAutoPageSizeService")],ld);var cd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let ud=class extends f{constructor(){super(...arguments),this.cacheVersion=0}init(){this.active=this.gridOptionsService.is("valueCache"),this.neverExpires=this.gridOptionsService.is("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,i){this.active&&(e.__cacheVersion!==this.cacheVersion&&(e.__cacheVersion=this.cacheVersion,e.__cacheData={}),e.__cacheData[t]=i)}getValue(e,t){if(this.active&&e.__cacheVersion===this.cacheVersion)return e.__cacheData[t]}};cd([r],ud.prototype,"init",null),ud=cd([s("valueCache")],ud);var dd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let hd=class extends f{init(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel),this.addManagedListener(this.eventService,y.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged.bind(this))}onCellValueChanged(e){"paste"!==e.source&&this.doChangeDetection(e.node,e.column)}doChangeDetection(i,n){if(this.gridOptionsService.is("suppressChangeDetection"))return;const r=[i];if(this.clientSideRowModel&&!i.isRowPinned()){const e=this.gridOptionsService.is("aggregateOnlyChangedColumns"),t=new zc(e,this.clientSideRowModel.getRootNode());t.addParentNode(i.parent,[n]),this.clientSideRowModel.doAggregate(t),t.forEachChangedNodeDepthFirst(e=>{r.push(e)})}this.rowRenderer.refreshCells({rowNodes:r})}};dd([o("rowModel")],hd.prototype,"rowModel",void 0),dd([o("rowRenderer")],hd.prototype,"rowRenderer",void 0),dd([r],hd.prototype,"init",null),hd=dd([s("changeDetectionService")],hd);var pd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let fd=class extends f{adaptFunction(e,t){const i=this.componentMetadataProvider.retrieve(e);return i&&i.functionAdapter?i.functionAdapter(t):null}adaptCellRendererFunction(n){return class{refresh(e){return!1}getGui(){return this.eGui}init(e){const t=n(e),i=typeof t;this.eGui="string"!==i&&"number"!==i&&"boolean"!==i?null!=t?t:Un("<span></span>"):Un("<span>"+t+"</span>")}}}doesImplementIComponent(e){return!!e&&(e.prototype&&"getGui"in e.prototype)}};pd([o("componentMetadataProvider")],fd.prototype,"componentMetadataProvider",void 0),fd=pd([s("agComponentUtils")],fd);var gd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let md=class extends f{postConstruct(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[]},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached"]},floatingFilterWrapperComponent:{mandatoryMethodList:[],optionalMethodList:[]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged"]},filterComponent:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]}}}retrieve(e){return this.componentMetaData[e]}};gd([o("agComponentUtils")],md.prototype,"agComponentUtils",void 0),gd([r],md.prototype,"postConstruct",null),md=gd([s("componentMetadataProvider")],md);var vd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};const yd={"ag-theme-custom":{headerHeight:25,headerCellMinWidth:24,listItemHeight:20,rowHeight:25,chartMenuPanelWidth:220},"ag-theme-material":{headerHeight:56,headerCellMinWidth:48,listItemHeight:32,rowHeight:48,chartMenuPanelWidth:240},"ag-theme-balham":{headerHeight:32,headerCellMinWidth:24,listItemHeight:24,rowHeight:28,chartMenuPanelWidth:220},"ag-theme-alpine":{headerHeight:48,headerCellMinWidth:36,listItemHeight:24,rowHeight:42,chartMenuPanelWidth:240}},bd={headerHeight:["ag-header-row"],headerCellMinWidth:["ag-header-cell"],listItemHeight:["ag-virtual-list-item"],rowHeight:["ag-row"],chartMenuPanelWidth:["ag-chart-docked-container"]};let Cd=class extends f{constructor(){super(...arguments),this.calculatedSizes={}}postConstruct(){var e;const t=null!==(e=this.getTheme().el)&&void 0!==e?e:this.eGridDiv;this.mutationObserver=new MutationObserver(()=>{this.calculatedSizes={},this.fireGridStylesChangedEvent()}),this.mutationObserver.observe(t||this.eGridDiv,{attributes:!0,attributeFilter:["class"]})}fireGridStylesChangedEvent(){const e={type:y.EVENT_GRID_STYLES_CHANGED};this.eventService.dispatchEvent(e)}getSassVariable(e){const{themeFamily:t,el:i}=this.getTheme();if(!t||0!==t.indexOf("ag-theme"))return;this.calculatedSizes||(this.calculatedSizes={}),this.calculatedSizes[t]||(this.calculatedSizes[t]={});const n=this.calculatedSizes[t][e];return null!=n?n:(this.calculatedSizes[t][e]=this.calculateValueForSassProperty(e,t,i),this.calculatedSizes[t][e])}calculateValueForSassProperty(e,t,i){const n="ag-theme-"+(t.match("material")?"material":t.match("balham")?"balham":t.match("alpine")?"alpine":"custom"),r=yd[n][e],s=this.gridOptionsService.getDocument();if(i||(i=this.eGridDiv),!bd[e])return r;const o=bd[e],a=s.createElement("div"),l=Array.from(i.classList);a.classList.add(t,...l),a.style.position="absolute";const c=o.reduce((e,t)=>{const i=s.createElement("div");return i.style.position="static",i.classList.add(t),e.appendChild(i),i},a);let u=0;if(s.body){s.body.appendChild(a);const t=-1!==e.toLowerCase().indexOf("height")?"height":"width";u=parseInt(window.getComputedStyle(c)[t],10),s.body.removeChild(a)}return u||r}isThemeDark(){const{theme:e}=this.getTheme();return!!e&&e.indexOf("dark")>=0}chartMenuPanelWidth(){return this.getSassVariable("chartMenuPanelWidth")}getTheme(){const e=/\bag-(material|(?:theme-([\w\-]*)))\b/g;let t=this.eGridDiv,i=null,n=[];for(;t;){if(i=e.exec(t.className),i){const i=t.className.match(e);i&&(n=i);break}t=t.parentElement||void 0}if(!i)return{allThemes:n};const r=i[0];return{theme:r,el:t,themeFamily:r.replace(/-dark$/,""),allThemes:n}}getFromTheme(e,t){var i;return null!==(i=this.getSassVariable(t))&&void 0!==i?i:e}getDefaultRowHeight(){return this.getFromTheme(25,"rowHeight")}getListItemHeight(){return this.getFromTheme(20,"listItemHeight")}setRowHeightVariable(e){const t=e+"px";this.eGridDiv.style.getPropertyValue("--ag-line-height").trim()!=t&&this.eGridDiv.style.setProperty("--ag-line-height",t)}getMinColWidth(){const e=this.getFromTheme(null,"headerCellMinWidth");return _(e)?Math.max(e,10):10}destroy(){this.calculatedSizes=null,this.mutationObserver&&this.mutationObserver.disconnect(),super.destroy()}};vd([o("eGridDiv")],Cd.prototype,"eGridDiv",void 0),vd([r],Cd.prototype,"postConstruct",null),Cd=vd([s("environment")],Cd);var wd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},_d=function(i,n){return function(e,t){n(e,t,i)}};let Ad=class extends f{constructor(){super(...arguments),this.scrollY=0,this.uiBodyHeight=0}agWire(e){this.logger=e.create("RowContainerHeightService")}postConstruct(){this.addManagedListener(this.eventService,y.EVENT_BODY_HEIGHT_CHANGED,this.updateOffset.bind(this)),this.maxDivHeight=on(),this.logger.log("maxDivHeight = "+this.maxDivHeight)}isStretching(){return this.stretching}getDivStretchOffset(){return this.divStretchOffset}updateOffset(){if(!this.stretching)return;const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;this.logger.log(`Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventService.dispatchEvent({type:y.EVENT_ROW_CONTAINER_HEIGHT_CHANGED}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t="number"==typeof e?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventService.dispatchEvent({type:y.EVENT_HEIGHT_SCALE_CHANGED}))}setModelHeight(e){this.modelHeight=e,this.stretching=null!=e&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getUiContainerHeight(){return this.uiContainerHeight}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=e/(this.modelHeight-this.getUiBodyHeight());return this.maxScrollY*t}};wd([o("ctrlsService")],Ad.prototype,"ctrlsService",void 0),wd([_d(0,ze("loggerFactory"))],Ad.prototype,"agWire",null),wd([r],Ad.prototype,"postConstruct",null),Ad=wd([s("rowContainerHeightService")],Ad);var Ed=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Sd=class extends f{init(){this.groupSelectsChildren=this.gridOptionsService.is("groupSelectsChildren"),this.isRowSelectableFunc=this.gridOptionsService.get("isRowSelectable")}updateSelectableAfterGrouping(t){if(this.isRowSelectableFunc){const e=e=>e.childrenAfterGroup;this.recurseDown(t.childrenAfterGroup,e)}}recurseDown(e,i){e&&e.forEach(e=>{if(!e.group)return;let t;if(e.hasChildren()&&this.recurseDown(i(e),i),this.groupSelectsChildren){t=_((i(e)||[]).find(e=>!0===e.selectable))}else t=!!this.isRowSelectableFunc&&this.isRowSelectableFunc(e);e.setRowSelectable(t)})}};Ed([r],Sd.prototype,"init",null),Sd=Ed([s("selectableService")],Sd);var Td=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class xd extends E{constructor(){super(),this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1}postConstruct(){const e=this.gridOptionsService.is("enableRtl");this.setTemplate(this.getTemplate());const{btFirst:t,btPrevious:i,btNext:n,btLast:r}=this;this.activateTabIndex([t,i,n,r]),t.insertAdjacentElement("afterbegin",mr(e?"last":"first",this.gridOptionsService)),i.insertAdjacentElement("afterbegin",mr(e?"next":"previous",this.gridOptionsService)),n.insertAdjacentElement("afterbegin",mr(e?"previous":"next",this.gridOptionsService)),r.insertAdjacentElement("afterbegin",mr(e?"first":"last",this.gridOptionsService)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.onPaginationChanged()}onPaginationChanged(){const e=this.gridOptionsService.is("pagination")&&!this.gridOptionsService.is("suppressPaginationPanel");this.setDisplayed(e),e&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateRowLabels(),this.setCurrentPageLabel(),this.setTotalLabels())}setupListeners(){this.areListenersSetup||(this.addManagedListener(this.eventService,y.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach(e=>{const{el:t,fn:i}=e;this.addManagedListener(t,"click",i),this.addManagedListener(t,"keydown",e=>{e.key!==A.ENTER&&e.key!==A.SPACE||(e.preventDefault(),i())})}),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToFirstPage()}setCurrentPageLabel(){const e=this.paginationProxy.getTotalPages()>0,t=this.paginationProxy.getCurrentPage(),i=e?t+1:0;this.lbCurrent.innerHTML=this.formatNumber(i)}formatNumber(e){const t=this.gridOptionsService.getCallback("paginationNumberFormatter");if(t){return t({value:e})}const i=this.localeService.getLocaleTextFunc();return vn(e,i("thousandSeparator",","),i("decimalSeparator","."))}getTemplate(){const e=this.localeService.getLocaleTextFunc(),t=e("page","Page"),i=e("to","to"),n=e("of","of"),r=e("firstPage","First Page"),s=e("previousPage","Previous Page"),o=e("nextPage","Next Page"),a=e("lastPage","Last Page"),l=this.getCompId();return`<div class="ag-paging-panel ag-unselectable" id="ag-${l}">\n                <span class="ag-paging-row-summary-panel" role="status">\n                    <span id="ag-${l}-first-row" ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-${l}-to">${i}</span>\n                    <span id="ag-${l}-last-row" ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-${l}-of">${n}</span>\n                    <span id="ag-${l}-row-count" ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>\n                </span>\n                <span class="ag-paging-page-summary-panel" role="presentation">\n                    <div ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="${r}"></div>\n                    <div ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="${s}"></div>\n                    <span class="ag-paging-description" role="status">\n                        <span id="ag-${l}-start-page">${t}</span>\n                        <span id="ag-${l}-start-page-number" ref="lbCurrent" class="ag-paging-number"></span>\n                        <span id="ag-${l}-of-page">${n}</span>\n                        <span id="ag-${l}-of-page-number" ref="lbTotal" class="ag-paging-number"></span>\n                    </span>\n                    <div ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="${o}"></div>\n                    <div ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="${a}"></div>\n                </span>\n            </div>`}onBtNext(){this.nextButtonDisabled||this.paginationProxy.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.paginationProxy.goToLastPage()}enableOrDisableButtons(){const e=this.paginationProxy.getCurrentPage(),t=this.paginationProxy.isLastPageFound(),i=this.paginationProxy.getTotalPages();this.previousAndFirstButtonsDisabled=0===e,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const n=this.isZeroPagesToDisplay(),r=t&&e===i-1;this.nextButtonDisabled=r||n,this.lastButtonDisabled=!t||n||e===i-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){Ii(e,t),e.classList.toggle("ag-disabled",t)}updateRowLabels(){const e=this.paginationProxy.getCurrentPage(),t=this.paginationProxy.getPageSize(),i=this.paginationProxy.isLastPageFound(),n=this.paginationProxy.isLastPageFound()?this.paginationProxy.getMasterRowCount():null;let r,s;if(this.isZeroPagesToDisplay()?r=s=0:(r=t*e+1,s=r+t-1,i&&s>n&&(s=n)),this.lbFirstRowOnPage.innerHTML=this.formatNumber(r),this.rowNodeBlockLoader.isLoading()){const e=this.localeService.getLocaleTextFunc();this.lbLastRowOnPage.innerHTML=e("pageLastRowUnknown","?")}else this.lbLastRowOnPage.innerHTML=this.formatNumber(s)}isZeroPagesToDisplay(){const e=this.paginationProxy.isLastPageFound(),t=this.paginationProxy.getTotalPages();return e&&0===t}setTotalLabels(){const e=this.paginationProxy.isLastPageFound(),t=this.paginationProxy.getTotalPages(),i=e?this.paginationProxy.getMasterRowCount():null;if(1===i){const e=this.paginationProxy.getRow(0);if(e&&e.group&&!(e.groupData||e.aggData))return void this.setTotalLabelsToZero()}if(e)this.lbTotal.innerHTML=this.formatNumber(t),this.lbRecordCount.innerHTML=this.formatNumber(i);else{const e=this.localeService.getLocaleTextFunc()("more","more");this.lbTotal.innerHTML=e,this.lbRecordCount.innerHTML=e}}setTotalLabelsToZero(){this.lbFirstRowOnPage.innerHTML=this.formatNumber(0),this.lbCurrent.innerHTML=this.formatNumber(0),this.lbLastRowOnPage.innerHTML=this.formatNumber(0),this.lbTotal.innerHTML=this.formatNumber(0),this.lbRecordCount.innerHTML=this.formatNumber(0)}}Td([o("paginationProxy")],xd.prototype,"paginationProxy",void 0),Td([o("rowNodeBlockLoader")],xd.prototype,"rowNodeBlockLoader",void 0),Td([S("btFirst")],xd.prototype,"btFirst",void 0),Td([S("btPrevious")],xd.prototype,"btPrevious",void 0),Td([S("btNext")],xd.prototype,"btNext",void 0),Td([S("btLast")],xd.prototype,"btLast",void 0),Td([S("lbRecordCount")],xd.prototype,"lbRecordCount",void 0),Td([S("lbFirstRowOnPage")],xd.prototype,"lbFirstRowOnPage",void 0),Td([S("lbLastRowOnPage")],xd.prototype,"lbLastRowOnPage",void 0),Td([S("lbCurrent")],xd.prototype,"lbCurrent",void 0),Td([S("lbTotal")],xd.prototype,"lbTotal",void 0),Td([r],xd.prototype,"postConstruct",null);var Dd,Rd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};!function(e){e[e.Loading=0]="Loading",e[e.NoRows=1]="NoRows"}(Dd||(Dd={}));class Md extends E{constructor(){super(Md.TEMPLATE),this.inProgress=!1,this.destroyRequested=!1,this.manuallyDisplayed=!1}updateLayoutClasses(e,t){const i=this.eOverlayWrapper.classList;i.toggle(ca.AUTO_HEIGHT,t.autoHeight),i.toggle(ca.NORMAL,t.normal),i.toggle(ca.PRINT,t.print)}postConstruct(){this.createManagedBean(new da(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.addManagedListener(this.eventService,y.EVENT_ROW_DATA_UPDATED,this.onRowDataUpdated.bind(this)),this.addManagedListener(this.eventService,y.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.gridOptionsService.isRowModelType("clientSide")&&!this.gridOptionsService.get("rowData")&&this.showLoadingOverlay(),this.gridApi.registerOverlayWrapperComp(this)}setWrapperTypeClass(e){const t=this.eOverlayWrapper.classList;t.toggle("ag-overlay-loading-wrapper",e===Dd.Loading),t.toggle("ag-overlay-no-rows-wrapper",e===Dd.NoRows)}showLoadingOverlay(){if(this.gridOptionsService.is("suppressLoadingOverlay"))return;const e=this.userComponentFactory.getLoadingOverlayCompDetails({}).newAgStackInstance();this.showOverlay(e,Dd.Loading)}showNoRowsOverlay(){if(this.gridOptionsService.is("suppressNoRowsOverlay"))return;const e=this.userComponentFactory.getNoRowsOverlayCompDetails({}).newAgStackInstance();this.showOverlay(e,Dd.NoRows)}showOverlay(e,t){this.inProgress||(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.inProgress=!0,e&&e.then(e=>{this.inProgress=!1,this.eOverlayWrapper.appendChild(e.getGui()),this.activeOverlay=e,this.destroyRequested&&(this.destroyRequested=!1,this.destroyActiveOverlay())}),this.manuallyDisplayed=this.columnModel.isReady()&&!this.paginationProxy.isEmpty(),this.setDisplayed(!0,{skipAriaHidden:!0}))}destroyActiveOverlay(){this.inProgress?this.destroyRequested=!0:this.activeOverlay&&(this.activeOverlay=this.getContext().destroyBean(this.activeOverlay),Vn(this.eOverlayWrapper))}hideOverlay(){this.manuallyDisplayed=!1,this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}destroy(){this.destroyActiveOverlay(),super.destroy()}showOrHideOverlay(){const e=this.paginationProxy.isEmpty(),t=this.gridOptionsService.is("suppressNoRowsOverlay");e&&!t?this.showNoRowsOverlay():this.hideOverlay()}onRowDataUpdated(){this.showOrHideOverlay()}onNewColumnsLoaded(){!this.columnModel.isReady()||this.paginationProxy.isEmpty()||this.manuallyDisplayed||this.hideOverlay()}}Md.TEMPLATE='\n        <div class="ag-overlay" aria-hidden="true">\n            <div class="ag-overlay-panel">\n                <div class="ag-overlay-wrapper" ref="eOverlayWrapper"></div>\n            </div>\n        </div>',Rd([o("userComponentFactory")],Md.prototype,"userComponentFactory",void 0),Rd([o("paginationProxy")],Md.prototype,"paginationProxy",void 0),Rd([o("gridApi")],Md.prototype,"gridApi",void 0),Rd([o("columnModel")],Md.prototype,"columnModel",void 0),Rd([S("eOverlayWrapper")],Md.prototype,"eOverlayWrapper",void 0),Rd([r],Md.prototype,"postConstruct",null);var Nd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Od=class extends f{getFirstRow(){let e,t=0;return this.pinnedRowModel.getPinnedTopRowCount()?e="top":this.rowModel.getRowCount()?(e=null,t=this.paginationProxy.getPageFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(e="bottom"),void 0===e?null:{rowIndex:t,rowPinned:e}}getLastRow(){let e,t=null;const i=this.pinnedRowModel.getPinnedBottomRowCount(),n=this.pinnedRowModel.getPinnedTopRowCount();return i?(t="bottom",e=i-1):this.rowModel.getRowCount()?(t=null,e=this.paginationProxy.getPageLastRow()):n&&(t="top",e=n-1),void 0===e?null:{rowIndex:e,rowPinned:t}}getRowNode(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}}sameRow(e,t){return!e&&!t||!(e&&!t||!e&&t)&&(e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned)}before(e,t){switch(e.rowPinned){case"top":if("top"!==t.rowPinned)return!0;break;case"bottom":if("bottom"!==t.rowPinned)return!1;break;default:if(_(t.rowPinned))return"top"!==t.rowPinned}return e.rowIndex<t.rowIndex}rowMax(e){let t;return e.forEach(e=>{(void 0===t||this.before(t,e))&&(t=e)}),t}rowMin(e){let t;return e.forEach(e=>{(void 0===t||this.before(e,t))&&(t=e)}),t}};Nd([o("rowModel")],Od.prototype,"rowModel",void 0),Nd([o("pinnedRowModel")],Od.prototype,"pinnedRowModel",void 0),Nd([o("paginationProxy")],Od.prototype,"paginationProxy",void 0),Od=Nd([s("rowPositionUtils")],Od);var Id=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Pd=class extends f{createId(e){const{rowIndex:t,rowPinned:i,column:n}=e;return this.createIdFromValues({rowIndex:t,column:n,rowPinned:i})}createIdFromValues(e){const{rowIndex:t,rowPinned:i,column:n}=e;return`${t}.${null==i?"null":i}.${n.getId()}`}equals(e,t){const i=e.column===t.column,n=e.rowPinned===t.rowPinned,r=e.rowIndex===t.rowIndex;return i&&n&&r}};Pd=Id([s("cellPositionUtils")],Pd);class kd{constructor(e){this.cellValueChanges=e}}class Ld extends kd{constructor(e,t,i,n){super(e),this.initialRange=t,this.finalRange=i,this.ranges=n}}class Fd{constructor(e){this.actionStack=[],this.maxStackSize=e||Fd.DEFAULT_STACK_SIZE,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}}Fd.DEFAULT_STACK_SIZE=10;var Gd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let $d=class extends f{constructor(){super(...arguments),this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.onCellValueChanged=e=>{const t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},i=null!==this.activeCellEdit&&this.cellPositionUtils.equals(this.activeCellEdit,t),n=null!==this.activeRowEdit&&this.rowPositionUtils.sameRow(this.activeRowEdit,t);if(!(i||n||this.isPasting||this.isRangeInAction))return;const{rowPinned:r,rowIndex:s,column:o,oldValue:a,value:l}=e,c={rowPinned:r,rowIndex:s,columnId:o.getColId(),newValue:l,oldValue:a};this.cellValueChanges.push(c)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}init(){if(!this.gridOptionsService.is("undoRedoCellEditing"))return;const e=this.gridOptionsService.getNum("undoRedoCellEditingLimit");e<=0||(this.undoStack=new Fd(e),this.redoStack=new Fd(e),this.addRowEditingListeners(),this.addCellEditingListeners(),this.addPasteListeners(),this.addFillListeners(),this.addCellKeyListeners(),this.addManagedListener(this.eventService,y.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged),this.addManagedListener(this.eventService,y.EVENT_MODEL_UPDATED,e=>{e.keepUndoRedoStack||this.clearStacks()}),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,y.EVENT_NEW_COLUMNS_LOADED,this.clearStacks),this.addManagedListener(this.eventService,y.EVENT_COLUMN_GROUP_OPENED,this.clearStacks),this.addManagedListener(this.eventService,y.EVENT_COLUMN_ROW_GROUP_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,y.EVENT_COLUMN_MOVED,this.clearStacks),this.addManagedListener(this.eventService,y.EVENT_COLUMN_PINNED,this.clearStacks),this.addManagedListener(this.eventService,y.EVENT_COLUMN_VISIBLE,this.clearStacks),this.addManagedListener(this.eventService,y.EVENT_ROW_DRAG_END,this.clearStacks),this.ctrlsService.whenReady(()=>{this.gridBodyCtrl=this.ctrlsService.getGridBodyCtrl()}))}getCurrentUndoStackSize(){return this.undoStack?this.undoStack.getCurrentStackSize():0}getCurrentRedoStackSize(){return this.redoStack?this.redoStack.getCurrentStackSize():0}undo(e){const t={type:y.EVENT_UNDO_STARTED,source:e};this.eventService.dispatchEvent(t);const i=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo"),n={type:y.EVENT_UNDO_ENDED,source:e,operationPerformed:i};this.eventService.dispatchEvent(n)}redo(e){const t={type:y.EVENT_REDO_STARTED,source:e};this.eventService.dispatchEvent(t);const i=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo"),n={type:y.EVENT_REDO_ENDED,source:e,operationPerformed:i};this.eventService.dispatchEvent(n)}undoRedo(e,t,i,n,r){if(!e)return!1;const s=e.pop();return!(!s||!s.cellValueChanges)&&(this.processAction(s,e=>e[n],r),s instanceof Ld?this.processRange(s.ranges||[s[i]]):this.processCell(s.cellValueChanges),t.push(s),!0)}processAction(e,o,a){e.cellValueChanges.forEach(e=>{const{rowIndex:t,rowPinned:i,columnId:n}=e,r={rowIndex:t,rowPinned:i},s=this.getRowNode(r);s.displayed&&s.setDataValue(n,o(e),a)})}processRange(s){let o;this.rangeService.removeAllCellRanges(!0),s.forEach((e,t)=>{if(!e)return;const i=e.startRow,n=e.endRow;t===s.length-1&&(o={rowPinned:i.rowPinned,rowIndex:i.rowIndex,columnId:e.startColumn.getColId()},this.setLastFocusedCell(o));const r={rowStartIndex:i.rowIndex,rowStartPinned:i.rowPinned,rowEndIndex:n.rowIndex,rowEndPinned:n.rowPinned,columnStart:e.startColumn,columns:e.columns};this.rangeService.addCellRange(r)})}processCell(e){const t=e[0],{rowIndex:i,rowPinned:n}=t,r={rowIndex:i,rowPinned:n},s=this.getRowNode(r),o={rowPinned:t.rowPinned,rowIndex:s.rowIndex,columnId:t.columnId};this.setLastFocusedCell(o,!!this.rangeService)}setLastFocusedCell(e,t){const{rowIndex:i,columnId:n,rowPinned:r}=e,s=this.gridBodyCtrl.getScrollFeature(),o=this.columnModel.getGridColumn(n);if(!o)return;s.ensureIndexVisible(i),s.ensureColumnVisible(o);const a={rowIndex:i,column:o,rowPinned:r};this.focusService.setFocusedCell(Object.assign(Object.assign({},a),{forceBrowserFocus:!0})),t&&this.rangeService.setRangeToCell(a)}addRowEditingListeners(){this.addManagedListener(this.eventService,y.EVENT_ROW_EDITING_STARTED,e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}}),this.addManagedListener(this.eventService,y.EVENT_ROW_EDITING_STOPPED,()=>{const e=new kd(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null})}addCellEditingListeners(){this.addManagedListener(this.eventService,y.EVENT_CELL_EDITING_STARTED,e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}}),this.addManagedListener(this.eventService,y.EVENT_CELL_EDITING_STOPPED,e=>{this.activeCellEdit=null;if(e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const e=new kd(this.cellValueChanges);this.pushActionsToUndoStack(e)}})}addPasteListeners(){this.addManagedListener(this.eventService,y.EVENT_PASTE_START,()=>{this.isPasting=!0}),this.addManagedListener(this.eventService,y.EVENT_PASTE_END,()=>{const e=new kd(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1})}addFillListeners(){this.addManagedListener(this.eventService,y.EVENT_FILL_START,()=>{this.isRangeInAction=!0}),this.addManagedListener(this.eventService,y.EVENT_FILL_END,e=>{const t=new Ld(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1})}addCellKeyListeners(){this.addManagedListener(this.eventService,y.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,()=>{this.isRangeInAction=!0}),this.addManagedListener(this.eventService,y.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,()=>{let e;e=this.rangeService&&this.gridOptionsService.isEnableRangeSelection()?new Ld(this.cellValueChanges,void 0,void 0,[...this.rangeService.getCellRanges()]):new kd(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1})}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}getRowNode(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}}};Gd([o("focusService")],$d.prototype,"focusService",void 0),Gd([o("ctrlsService")],$d.prototype,"ctrlsService",void 0),Gd([o("rowModel")],$d.prototype,"rowModel",void 0),Gd([o("pinnedRowModel")],$d.prototype,"pinnedRowModel",void 0),Gd([o("cellPositionUtils")],$d.prototype,"cellPositionUtils",void 0),Gd([o("rowPositionUtils")],$d.prototype,"rowPositionUtils",void 0),Gd([o("columnModel")],$d.prototype,"columnModel",void 0),Gd([c("rangeService")],$d.prototype,"rangeService",void 0),Gd([r],$d.prototype,"init",null),$d=Gd([s("undoRedoService")],$d);var Hd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Bd=class extends f{findHeader(e,t){let i,n,r;if(e.column instanceof g?(n="getDisplayedGroup"+t,i=this.columnModel[n](e.column)):(r="getDisplayedCol"+t,i=this.columnModel[r](e.column)),!i)return;let{headerRowIndex:s}=e;if(this.getHeaderRowType(s)===Nl.COLUMN_GROUP){const e=i;if(e.isPadding()&&this.isAnyChildSpanningHeaderHeight(e)){const{nextFocusColumn:n,nextRow:r}=this.getColumnVisibleChild(e,s,t);n&&(i=n,s=r)}}return{column:i,headerRowIndex:s}}isAnyChildSpanningHeaderHeight(e){return!!e&&e.getLeafColumns().some(e=>e.isSpanHeaderHeight())}getColumnVisibleParent(e,t){const i=this.getHeaderRowType(t),n=i===Nl.FLOATING_FILTER,r=i===Nl.COLUMN;let s=n?e:e.getParent(),o=t-1;if(r&&this.isAnyChildSpanningHeaderHeight(e.getParent())){for(;s&&s.isPadding();)s=s.getParent(),o--;o<0&&(s=e,o=t)}return{nextFocusColumn:s,nextRow:o}}getColumnVisibleChild(i,e,n="After"){let r=i,s=e+1;if(this.getHeaderRowType(e)===Nl.COLUMN_GROUP){const e=i.getLeafColumns(),t="After"===n?e[0]:p(e);if(this.isAnyChildSpanningHeaderHeight(t.getParent())){r=t;let e=t.getParent();for(;e&&e!==i;)e=e.getParent(),s++}else r=i.getDisplayedChildren()[0]}return{nextFocusColumn:r,nextRow:s}}getHeaderRowType(e){const t=this.ctrlsService.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}findColAtEdgeForHeaderRow(e,t){const i=this.columnModel.getAllDisplayedColumns(),n=i["start"===t?0:i.length-1];if(!n)return;const r=this.ctrlsService.getHeaderRowContainerCtrl(n.getPinned()).getRowType(e);if(r==Nl.COLUMN_GROUP){return{headerRowIndex:e,column:this.columnModel.getColumnGroupAtLevel(n,e)}}return{headerRowIndex:null==r?-1:e,column:n}}};Hd([o("columnModel")],Bd.prototype,"columnModel",void 0),Hd([o("ctrlsService")],Bd.prototype,"ctrlsService",void 0),Bd=Hd([s("headerPositionUtils")],Bd);var Vd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Wd=class{buildColumnDefs(e,s,o){const a=[],l={};return e.forEach(e=>{let t=!0,i=this.createDefFromColumn(e,s,o),n=e.getOriginalParent(),r=null;for(;n;){let e=null;if(n.isPadding()){n=n.getOriginalParent();continue}const s=l[n.getGroupId()];if(s){s.children.push(i),t=!1;break}if(e=this.createDefFromGroup(n),e&&(e.children=[i],l[e.groupId]=e,i=e,n=n.getOriginalParent()),null!=n&&r===n){t=!1;break}r=n}t&&a.push(i)}),a}createDefFromGroup(e){const t=he(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,i){const n=he(e.getColDef());return n.colId=e.getColId(),n.width=e.getActualWidth(),n.rowGroup=e.isRowGroupActive(),n.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,n.pivot=e.isPivotActive(),n.pivotIndex=e.isPivotActive()?i.indexOf(e):null,n.aggFunc=e.isValueActive()?e.getAggFunc():null,n.hide=!e.isVisible()||void 0,n.pinned=e.isPinned()?e.getPinned():null,n.sort=e.getSort()?e.getSort():null,n.sortIndex=null!=e.getSortIndex()?e.getSortIndex():null,n}};Wd=Vd([s("columnDefFactory")],Wd);var zd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let jd=class{getInitialRowClasses(e){const t=[];return _(e.extraCssClass)&&t.push(e.extraCssClass),t.push("ag-row"),t.push(e.rowFocused?"ag-row-focus":"ag-row-no-focus"),e.fadeRowIn&&t.push("ag-opacity-zero"),t.push(e.rowIsEven?"ag-row-even":"ag-row-odd"),e.rowNode.isRowPinned()&&t.push("ag-row-pinned"),e.rowNode.isSelected()&&t.push("ag-row-selected"),e.rowNode.footer&&t.push("ag-row-footer"),t.push("ag-row-level-"+e.rowLevel),e.rowNode.stub&&t.push("ag-row-loading"),e.fullWidthRow&&t.push("ag-full-width-row"),e.expandable&&(t.push("ag-row-group"),t.push(e.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),e.rowNode.dragging&&t.push("ag-row-dragging"),pt(t,this.processClassesFromGridOptions(e.rowNode)),pt(t,this.preProcessRowClassRules(e.rowNode)),t.push(e.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),e.firstRowOnPage&&t.push("ag-row-first"),e.lastRowOnPage&&t.push("ag-row-last"),e.fullWidthRow&&("left"===e.pinned&&t.push("ag-cell-last-left-pinned"),"right"===e.pinned&&t.push("ag-cell-first-right-pinned")),t}processClassesFromGridOptions(e){const t=[],i=e=>{"string"==typeof e?t.push(e):Array.isArray(e)&&e.forEach(e=>t.push(e))},n=this.gridOptionsService.get("rowClass");if(n){if("function"==typeof n)return console.warn("AG Grid: rowClass should not be a function, please use getRowClass instead"),[];i(n)}const r=this.gridOptionsService.getCallback("getRowClass");if(r){i(r({data:e.data,node:e,rowIndex:e.rowIndex}))}return t}preProcessRowClassRules(e){const t=[];return this.processRowClassRules(e,e=>{t.push(e)},e=>{}),t}processRowClassRules(e,t,i){const n={data:e.data,node:e,rowIndex:e.rowIndex,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};this.stylingService.processClassRules(this.gridOptionsService.get("rowClassRules"),n,t,i)}calculateRowLevel(e){return e.group?e.level:e.parent?e.parent.level+1:0}};zd([o("stylingService")],jd.prototype,"stylingService",void 0),zd([o("gridOptionsService")],jd.prototype,"gridOptionsService",void 0),jd=zd([s("rowCssClassCalculator")],jd);var Ud=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Yd=class extends f{init(){this.isAccentedSort=this.gridOptionsService.is("accentedSort"),this.primaryColumnsSortGroups=this.gridOptionsService.isColumnsSortingCoupledToGroup(),this.addManagedPropertyListener("accentedSort",e=>this.isAccentedSort=e.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=this.gridOptionsService.isColumnsSortingCoupledToGroup())}doFullSort(e,t){const i=e.map((e,t)=>({currentPos:t,rowNode:e}));return i.sort(this.compareRowNodes.bind(this,t)),i.map(e=>e.rowNode)}compareRowNodes(o,e,a){const l=e.rowNode,c=a.rowNode;for(let s=0,e=o.length;s<e;s++){const a=o[s],e="desc"===a.sort,t=this.getValue(l,a.column),i=this.getValue(c,a.column);let n;const r=this.getComparator(a,l);n=r?r(t,i,l,c,e):Tr.defaultComparator(t,i,this.isAccentedSort);if(!isNaN(n)&&0!==n)return"asc"===a.sort?n:-1*n}return e.currentPos-a.currentPos}getComparator(e,t){const i=e.column,n=i.getColDef().comparator;if(null!=n)return n;if(!i.getColDef().showRowGroup)return;const r=!t.group&&i.getColDef().field;if(!r)return;const s=this.columnModel.getPrimaryColumn(r);return s?s.getColDef().comparator:void 0}getValue(t,i){var n,r;if(!this.primaryColumnsSortGroups)return this.valueService.getValue(i,t,!1,!1);if(t.rowGroupColumn===i){if(this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotActive())){if(i.getColDef().keyCreator)return t.key;const r=null===(n=t.allLeafChildren)||void 0===n?void 0:n[0];return r?this.valueService.getValue(i,r,!1,!1):void 0}const e=this.columnModel.getGroupDisplayColumnForGroup(i.getId());if(!e)return;return null===(r=t.groupData)||void 0===r?void 0:r[e.getId()]}return t.group&&i.getColDef().showRowGroup?void 0:this.valueService.getValue(i,t,!1,!1)}};Ud([o("valueService")],Yd.prototype,"valueService",void 0),Ud([o("columnModel")],Yd.prototype,"columnModel",void 0),Ud([r],Yd.prototype,"init",null),Yd=Ud([s("rowNodeSorter")],Yd);var qd,Kd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Xd=qd=class extends f{constructor(){super(...arguments),this.ready=!1,this.readyCallbacks=[]}checkReady(){if(this.ready=null!=this.gridCtrl&&null!=this.gridBodyCtrl&&null!=this.centerRowContainerCtrl&&null!=this.leftRowContainerCtrl&&null!=this.rightRowContainerCtrl&&null!=this.bottomCenterRowContainerCtrl&&null!=this.bottomLeftRowContainerCtrl&&null!=this.bottomRightRowContainerCtrl&&null!=this.topCenterRowContainerCtrl&&null!=this.topLeftRowContainerCtrl&&null!=this.topRightRowContainerCtrl&&null!=this.stickyTopCenterRowContainerCtrl&&null!=this.stickyTopLeftRowContainerCtrl&&null!=this.stickyTopRightRowContainerCtrl&&null!=this.centerHeaderRowContainerCtrl&&null!=this.leftHeaderRowContainerCtrl&&null!=this.rightHeaderRowContainerCtrl&&null!=this.fakeHScrollComp&&null!=this.fakeVScrollComp&&null!=this.gridHeaderCtrl,this.ready){const t=this.createReadyParams();this.readyCallbacks.forEach(e=>e(t)),this.readyCallbacks.length=0}}whenReady(e){this.ready?e(this.createReadyParams()):this.readyCallbacks.push(e)}createReadyParams(){return{centerRowContainerCtrl:this.centerRowContainerCtrl,leftRowContainerCtrl:this.leftRowContainerCtrl,rightRowContainerCtrl:this.rightRowContainerCtrl,bottomCenterRowContainerCtrl:this.bottomCenterRowContainerCtrl,bottomLeftRowContainerCtrl:this.bottomLeftRowContainerCtrl,bottomRightRowContainerCtrl:this.bottomRightRowContainerCtrl,topCenterRowContainerCtrl:this.topCenterRowContainerCtrl,topLeftRowContainerCtrl:this.topLeftRowContainerCtrl,topRightRowContainerCtrl:this.topRightRowContainerCtrl,stickyTopCenterRowContainerCtrl:this.stickyTopCenterRowContainerCtrl,stickyTopLeftRowContainerCtrl:this.stickyTopLeftRowContainerCtrl,stickyTopRightRowContainerCtrl:this.stickyTopRightRowContainerCtrl,centerHeaderRowContainerCtrl:this.centerHeaderRowContainerCtrl,leftHeaderRowContainerCtrl:this.leftHeaderRowContainerCtrl,rightHeaderRowContainerCtrl:this.rightHeaderRowContainerCtrl,fakeHScrollComp:this.fakeHScrollComp,fakeVScrollComp:this.fakeVScrollComp,gridBodyCtrl:this.gridBodyCtrl,gridCtrl:this.gridCtrl,gridHeaderCtrl:this.gridHeaderCtrl}}registerFakeHScrollComp(e){this.fakeHScrollComp=e,this.checkReady()}registerFakeVScrollComp(e){this.fakeVScrollComp=e,this.checkReady()}registerGridHeaderCtrl(e){this.gridHeaderCtrl=e,this.checkReady()}registerCenterRowContainerCtrl(e){this.centerRowContainerCtrl=e,this.checkReady()}registerLeftRowContainerCtrl(e){this.leftRowContainerCtrl=e,this.checkReady()}registerRightRowContainerCtrl(e){this.rightRowContainerCtrl=e,this.checkReady()}registerTopCenterRowContainerCtrl(e){this.topCenterRowContainerCtrl=e,this.checkReady()}registerTopLeftRowContainerCon(e){this.topLeftRowContainerCtrl=e,this.checkReady()}registerTopRightRowContainerCtrl(e){this.topRightRowContainerCtrl=e,this.checkReady()}registerStickyTopCenterRowContainerCtrl(e){this.stickyTopCenterRowContainerCtrl=e,this.checkReady()}registerStickyTopLeftRowContainerCon(e){this.stickyTopLeftRowContainerCtrl=e,this.checkReady()}registerStickyTopRightRowContainerCtrl(e){this.stickyTopRightRowContainerCtrl=e,this.checkReady()}registerBottomCenterRowContainerCtrl(e){this.bottomCenterRowContainerCtrl=e,this.checkReady()}registerBottomLeftRowContainerCtrl(e){this.bottomLeftRowContainerCtrl=e,this.checkReady()}registerBottomRightRowContainerCtrl(e){this.bottomRightRowContainerCtrl=e,this.checkReady()}registerHeaderContainer(e,t){switch(t){case"left":this.leftHeaderRowContainerCtrl=e;break;case"right":this.rightHeaderRowContainerCtrl=e;break;default:this.centerHeaderRowContainerCtrl=e}this.checkReady()}registerGridBodyCtrl(e){this.gridBodyCtrl=e,this.checkReady()}registerGridCtrl(e){this.gridCtrl=e,this.checkReady()}getFakeHScrollComp(){return this.fakeHScrollComp}getFakeVScrollComp(){return this.fakeVScrollComp}getGridHeaderCtrl(){return this.gridHeaderCtrl}getGridCtrl(){return this.gridCtrl}getCenterRowContainerCtrl(){return this.centerRowContainerCtrl}getTopCenterRowContainerCtrl(){return this.topCenterRowContainerCtrl}getBottomCenterRowContainerCtrl(){return this.bottomCenterRowContainerCtrl}getStickyTopCenterRowContainerCtrl(){return this.stickyTopCenterRowContainerCtrl}getGridBodyCtrl(){return this.gridBodyCtrl}getHeaderRowContainerCtrls(){return[this.leftHeaderRowContainerCtrl,this.rightHeaderRowContainerCtrl,this.centerHeaderRowContainerCtrl]}getHeaderRowContainerCtrl(e){switch(e){case"left":return this.leftHeaderRowContainerCtrl;case"right":return this.rightHeaderRowContainerCtrl;default:return this.centerHeaderRowContainerCtrl}}};Xd.NAME="ctrlsService",Xd=qd=Kd([s(qd.NAME)],Xd);var Qd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Zd=class extends f{constructor(){super(...arguments),this.registry={}}register(e){this.registry[e.controllerName]=e.controllerClass}getInstance(e){const t=this.registry[e];if(null!=t)return new t}};Zd=Qd([s("ctrlsFactory")],Zd);var Jd=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class eh extends E{constructor(e,t){super(e),this.direction=t,this.hideTimeout=null}postConstruct(){this.addManagedListener(this.eventService,y.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",tn()||nn())}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.invisibleScrollbar=dn(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const t=this.getGui();["mouseenter","mousedown","touchstart"].forEach(e=>this.addManagedListener(t,e,()=>this.addOrRemoveCssClass("ag-scrollbar-active",!0))),["mouseleave","touchend"].forEach(e=>this.addManagedListener(t,e,()=>this.addOrRemoveCssClass("ag-scrollbar-active",!1)))}onScrollVisibilityChanged(){void 0===this.invisibleScrollbar&&this.initialiseInvisibleScrollbar(),this.animationFrameService.requestAnimationFrame(()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedListener(this.eventService,y.EVENT_BODY_SCROLL,e=>{e.direction===this.direction&&(null!==this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=null),this.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))}),this.addManagedListener(this.eventService,y.EVENT_BODY_SCROLL_END,()=>{this.hideTimeout=window.setTimeout(()=>{this.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),this.hideTimeout=null},400)})}attemptSettingScrollPosition(e){const t=this.getViewport();Le(()=>jn(t),()=>this.setScrollPosition(e),100)}getViewport(){return this.eViewport}getContainer(){return this.eContainer}onScrollCallback(e){this.addManagedListener(this.getViewport(),"scroll",e)}}Jd([S("eViewport")],eh.prototype,"eViewport",void 0),Jd([S("eContainer")],eh.prototype,"eContainer",void 0),Jd([o("scrollVisibleService")],eh.prototype,"scrollVisibleService",void 0),Jd([o("ctrlsService")],eh.prototype,"ctrlsService",void 0),Jd([o("animationFrameService")],eh.prototype,"animationFrameService",void 0);var th=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class ih extends eh{constructor(){super(ih.TEMPLATE,"horizontal")}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedPropertyListener("domLayout",e),this.ctrlsService.registerFakeHScrollComp(this),this.createManagedBean(new Xa(e=>this.eContainer.style.width=e+"px"))}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.enableRtl=this.gridOptionsService.is("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}onPinnedRowDataChanged(){this.refreshCompBottom()}refreshCompBottom(){if(!this.invisibleScrollbar)return;const e=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom=e+"px"}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleService.isVerticalScrollShowing();let t=this.columnModel.getDisplayedColumnsRightWidth();const i=!this.enableRtl&&e,n=this.gridOptionsService.getScrollbarWidth();i&&(t+=n),sr(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=n);let r=this.columnModel.getDisplayedColumnsLeftWidth();this.enableRtl&&e&&(r+=n),sr(this.eLeftSpacer,r),this.eLeftSpacer.classList.toggle("ag-scroller-corner",r<=n)}setScrollVisible(){const e=this.scrollVisibleService.isHorizontalScrollShowing(),t=this.invisibleScrollbar,i=this.gridOptionsService.is("suppressHorizontalScroll"),n=e&&this.gridOptionsService.getScrollbarWidth()||0,r=i?0:0===n&&t?16:n;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),ar(this.getGui(),r),ar(this.eViewport,r),ar(this.eContainer,r),this.setDisplayed(e,{skipAriaHidden:!0})}getScrollPosition(){return Hn(this.getViewport(),this.enableRtl)}setScrollPosition(e){jn(this.getViewport())||this.attemptSettingScrollPosition(e),Bn(this.getViewport(),e,this.enableRtl)}}ih.TEMPLATE='<div class="ag-body-horizontal-scroll" aria-hidden="true">\n            <div class="ag-horizontal-left-spacer" ref="eLeftSpacer"></div>\n            <div class="ag-body-horizontal-scroll-viewport" ref="eViewport">\n                <div class="ag-body-horizontal-scroll-container" ref="eContainer"></div>\n            </div>\n            <div class="ag-horizontal-right-spacer" ref="eRightSpacer"></div>\n        </div>',th([S("eLeftSpacer")],ih.prototype,"eLeftSpacer",void 0),th([S("eRightSpacer")],ih.prototype,"eRightSpacer",void 0),th([o("columnModel")],ih.prototype,"columnModel",void 0),th([o("pinnedRowModel")],ih.prototype,"pinnedRowModel",void 0),th([r],ih.prototype,"postConstruct",null);var nh=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let rh=class extends f{postConstruct(){const e=this.checkContainerWidths.bind(this);this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,y.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,e),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const e=this.gridOptionsService.isDomLayout("print"),t=e?0:this.columnModel.getDisplayedColumnsLeftWidth(),i=e?0:this.columnModel.getDisplayedColumnsRightWidth();t!=this.leftWidth&&(this.leftWidth=t,this.eventService.dispatchEvent({type:y.EVENT_LEFT_PINNED_WIDTH_CHANGED})),i!=this.rightWidth&&(this.rightWidth=i,this.eventService.dispatchEvent({type:y.EVENT_RIGHT_PINNED_WIDTH_CHANGED}))}getPinnedRightWidth(){return this.rightWidth}getPinnedLeftWidth(){return this.leftWidth}};nh([o("columnModel")],rh.prototype,"columnModel",void 0),nh([r],rh.prototype,"postConstruct",null),rh=nh([s("pinnedWidthService")],rh);var sh=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let oh=class extends f{constructor(){super(...arguments),this.events=[]}postConstruct(){"clientSide"==this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel)}dispatchExpanded(e){if(null==this.clientSideRowModel)return void this.eventService.dispatchEvent(e);this.events.push(e);const t=()=>{this.clientSideRowModel&&this.clientSideRowModel.onRowGroupOpened(),this.events.forEach(e=>this.eventService.dispatchEvent(e)),this.events=[]};null==this.dispatchExpandedDebounced&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce(t)),this.dispatchExpandedDebounced()}};sh([o("animationFrameService")],oh.prototype,"animationFrameService",void 0),sh([o("rowModel")],oh.prototype,"rowModel",void 0),sh([r],oh.prototype,"postConstruct",null),oh=sh([s("rowNodeEventThrottle")],oh);var ah=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},lh=function(i,n){return function(e,t){n(e,t,i)}};function ch(e){return!0===e||"true"===e}let uh=class{constructor(){this.destroyed=!1,this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new qe}get context(){return this.gridOptions.context}agWire(e,t){this.gridOptions.api=e,this.gridOptions.columnApi=t,this.api=e,this.columnApi=t}init(){this.gridOptionLookup=new Set([...C.ALL_PROPERTIES,...C.EVENT_CALLBACKS]);const e=!this.is("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandler.bind(this),e),this.getScrollbarWidth()}destroy(){this.gridOptions.api=null,this.gridOptions.columnApi=null,this.destroyed=!0}is(e){return ch(this.gridOptions[e])}get(e){return this.gridOptions[e]}getNum(e){return"number"==typeof(t=this.gridOptions[e])?t:"string"==typeof t?parseInt(t,10):void 0;var t}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return _(this.gridOptions[e])}mergeGridCommonParams(i){if(i){return e=>{const t=e;return t.api=this.api,t.columnApi=this.columnApi,t.context=this.context,i(t)}}return i}set(t,i,n=!1,r={}){if(this.gridOptionLookup.has(t)){const e=this.gridOptions[t];if(n||e!==i){this.gridOptions[t]=i;const n=Object.assign({type:t,currentValue:i,previousValue:e},r);this.propertyEventService.dispatchEvent(n)}}}addEventListener(e,t){this.propertyEventService.addEventListener(e,t)}removeEventListener(e,t){this.propertyEventService.removeEventListener(e,t)}globalEventHandler(e,t){if(this.destroyed)return;const i=C.getCallbackForEvent(e);"function"==typeof this.gridOptions[i]&&this.gridOptions[i](t)}getGridId(){return this.api.getGridId()}getScrollbarWidth(){if(null==this.scrollbarWidth){const e="number"==typeof this.gridOptions.scrollbarWidth&&this.gridOptions.scrollbarWidth>=0?this.gridOptions.scrollbarWidth:cn();null!=e&&(this.scrollbarWidth=e,this.eventService.dispatchEvent({type:y.EVENT_SCROLLBAR_WIDTH_CHANGED}))}return this.scrollbarWidth}isRowModelType(e){return this.gridOptions.rowModelType===e||"clientSide"===e&&u(this.gridOptions.rowModelType)}isDomLayout(e){var t;return(null!==(t=this.gridOptions.domLayout)&&void 0!==t?t:"normal")===e}isRowSelection(){return"single"===this.gridOptions.rowSelection||"multiple"===this.gridOptions.rowSelection}useAsyncEvents(){return!this.is("suppressAsyncEvents")}isGetRowHeightFunction(){return"function"==typeof this.gridOptions.getRowHeight}getRowHeightForNode(i,n=!1,r){if(null==r&&(r=this.environment.getDefaultRowHeight()),this.isGetRowHeightFunction()){if(n)return{height:r,estimated:!0};const e={node:i,data:i.data},t=this.getCallback("getRowHeight")(e);if(this.isNumeric(t))return 0===t&&l(()=>console.warn("AG Grid: The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead."),"invalidRowHeight"),{height:Math.max(1,t),estimated:!1}}if(i.detail&&this.is("masterDetail"))return this.getMasterDetailRowHeight();return{height:this.gridOptions.rowHeight&&this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:r,estimated:!1}}getMasterDetailRowHeight(){return this.is("detailRowAutoHeight")?{height:1,estimated:!1}:this.isNumeric(this.gridOptions.detailRowHeight)?{height:this.gridOptions.detailRowHeight,estimated:!1}:{height:300,estimated:!1}}getRowHeightAsNumber(){if(!this.gridOptions.rowHeight||u(this.gridOptions.rowHeight))return this.environment.getDefaultRowHeight();const e=this.gridOptions.rowHeight;return e&&this.isNumeric(e)?(this.environment.setRowHeightVariable(e),e):(console.warn("AG Grid row height must be a number if not using standard row model"),this.environment.getDefaultRowHeight())}isNumeric(e){return!isNaN(e)&&"number"==typeof e&&isFinite(e)}getDomDataKey(){return this.domDataKey}getDomData(e,t){const i=e[this.getDomDataKey()];return i?i[t]:void 0}setDomData(e,t,i){const n=this.getDomDataKey();let r=e[n];u(r)&&(r={},e[n]=r),r[t]=i}getDocument(){let e=null;return this.gridOptions.getDocument&&_(this.gridOptions.getDocument)?e=this.gridOptions.getDocument():this.eGridDiv&&(e=this.eGridDiv.ownerDocument),e&&_(e)?e:document}getWindow(){return this.getDocument().defaultView||window}getRootNode(){return this.eGridDiv.getRootNode()}getAsyncTransactionWaitMillis(){return _(this.gridOptions.asyncTransactionWaitMillis)?this.gridOptions.asyncTransactionWaitMillis:50}isAnimateRows(){return!this.is("ensureDomOrder")&&this.is("animateRows")}isGroupRowsSticky(){return!(this.is("suppressGroupRowsSticky")||this.is("paginateChildRows")||this.is("groupHideOpenParents"))}isTreeData(){return this.is("treeData")&&v.__assertRegistered(m.RowGroupingModule,"Tree Data",this.api.getGridId())}isMasterDetail(){return this.is("masterDetail")&&v.__assertRegistered(m.MasterDetailModule,"masterDetail",this.api.getGridId())}isEnableRangeSelection(){return this.is("enableRangeSelection")&&v.__isRegistered(m.RangeSelectionModule,this.api.getGridId())}isColumnsSortingCoupledToGroup(){const e=this.gridOptions.autoGroupColumnDef;return this.isRowModelType("clientSide")&&!(null==e?void 0:e.comparator)&&!this.isTreeData()}getGroupAggFiltering(){const e=this.gridOptions.groupAggFiltering;return"function"==typeof e?this.getCallback("groupAggFiltering"):ch(e)?()=>!0:void 0}isGroupMultiAutoColumn(){return this.gridOptions.groupDisplayType?Jt("multipleColumns",this.gridOptions.groupDisplayType):this.is("groupHideOpenParents")}isGroupUseEntireRow(e){return!e&&(!!this.gridOptions.groupDisplayType&&Jt("groupRows",this.gridOptions.groupDisplayType))}};ah([o("gridOptions")],uh.prototype,"gridOptions",void 0),ah([o("eventService")],uh.prototype,"eventService",void 0),ah([o("environment")],uh.prototype,"environment",void 0),ah([o("eGridDiv")],uh.prototype,"eGridDiv",void 0),ah([lh(0,ze("gridApi")),lh(1,ze("columnApi"))],uh.prototype,"agWire",null),ah([r],uh.prototype,"init",null),ah([Ve],uh.prototype,"destroy",null),uh=ah([s("gridOptionsService")],uh);var dh=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let hh=class extends f{getLocaleTextFunc(){const n=this.gridOptionsService.getCallback("getLocaleText");if(n)return(e,t,i)=>n({key:e,defaultValue:t,variableValues:i});const r=this.gridOptionsService.get("localeText");return(e,t,i)=>{let n=r&&r[e];if(n&&i&&i.length){let e=0;for(;!(e>=i.length);){if(-1===n.indexOf("${variable}"))break;n=n.replace("${variable}",i[e++])}}return null!=n?n:t}}};hh=dh([s("localeService")],hh);var ph=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class fh extends eh{constructor(){super(fh.TEMPLATE,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new Ua(this.eContainer)),this.ctrlsService.registerFakeVScrollComp(this),this.addManagedListener(this.eventService,y.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onRowContainerHeightChanged.bind(this))}setScrollVisible(){const e=this.scrollVisibleService.isVerticalScrollShowing(),t=this.invisibleScrollbar,i=e&&this.gridOptionsService.getScrollbarWidth()||0,n=0===i&&t?16:i;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),sr(this.getGui(),n),sr(this.eViewport,n),sr(this.eContainer,n),this.setDisplayed(e,{skipAriaHidden:!0})}onRowContainerHeightChanged(){const e=this.ctrlsService.getGridBodyCtrl().getBodyViewportElement();this.eViewport.scrollTop!=e.scrollTop&&(this.eViewport.scrollTop=e.scrollTop)}getScrollPosition(){return this.getViewport().scrollTop}setScrollPosition(e){jn(this.getViewport())||this.attemptSettingScrollPosition(e),this.getViewport().scrollTop=e}}fh.TEMPLATE='<div class="ag-body-vertical-scroll" aria-hidden="true">\n            <div class="ag-body-vertical-scroll-viewport" ref="eViewport">\n                <div class="ag-body-vertical-scroll-container" ref="eContainer"></div>\n            </div>\n        </div>',ph([r],fh.prototype,"postConstruct",null);var gh=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};const mh={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},vh=["january","february","march","april","may","june","july","august","september","october","november","december"];let yh=class extends f{constructor(){super(...arguments),this.dataTypeDefinitions={},this.isWaitingForRowData=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[]}init(){this.groupHideOpenParents=this.gridOptionsService.is("groupHideOpenParents"),this.addManagedPropertyListener("groupHideOpenParents",()=>{this.groupHideOpenParents=this.gridOptionsService.is("groupHideOpenParents")}),this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",()=>{this.processDataTypeDefinitions(),this.columnModel.recreateColumnDefs("gridOptionsChanged")})}processDataTypeDefinitions(){var e;const n=this.getDefaultDataTypes();this.dataTypeDefinitions={},Object.entries(n).forEach(([e,t])=>{this.dataTypeDefinitions[e]=Object.assign(Object.assign({},t),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(t)})});const r=null!==(e=this.gridOptionsService.get("dataTypeDefinitions"))&&void 0!==e?e:{};this.dataTypeMatchers={},Object.entries(r).forEach(([e,t])=>{const i=this.processDataTypeDefinition(t,r,[e],n);i&&(this.dataTypeDefinitions[e]=i,t.dataTypeMatcher&&(this.dataTypeMatchers[e]=t.dataTypeMatcher))}),this.checkObjectValueHandlers(n),["dateString","text","number","boolean","date"].forEach(e=>{const t=this.dataTypeMatchers[e];t&&delete this.dataTypeMatchers[e],this.dataTypeMatchers[e]=null!=t?t:n[e].dataTypeMatcher})}mergeDataTypeDefinitions(e,t){const i=Object.assign(Object.assign({},e),t);return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(i.columnTypes=[...this.convertColumnTypes(e.columnTypes),...this.convertColumnTypes(t.columnTypes)]),i}processDataTypeDefinition(i,n,r,s){let o;const a=i.extendsDataType;if(i.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),i.extendsDataType===i.baseDataType){const n=s[a];if(!this.validateDataTypeDefinition(i,n,a))return;o=this.mergeDataTypeDefinitions(n,i)}else{if(r.includes(a))return void l(()=>console.warn('AG Grid: Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.'),"dataTypeExtendsCircularRef");const e=n[a];if(!this.validateDataTypeDefinition(i,e,a))return;const t=this.processDataTypeDefinition(e,n,[...r,a],s);if(!t)return;o=this.mergeDataTypeDefinitions(t,i)}return Object.assign(Object.assign({},o),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(o)})}validateDataTypeDefinition(e,t,i){return t?t.baseDataType===e.baseDataType||(l(()=>console.warn('AG Grid: The "baseDataType" property of a data type definition must match that of its parent.'),"dataTypeBaseTypesMatch"),!1):(l(()=>console.warn(`AG Grid: The data type definition ${i} does not exist.`),"dataTypeDefMissing"+i),!1)}createGroupSafeValueFormatter(n){if(n.valueFormatter)return e=>{var t,i;if(!(null===(t=e.node)||void 0===t?void 0:t.group))return this.groupHideOpenParents&&e.column.isRowGroupActive()?"string"!=typeof e.value||(null===(i=n.dataTypeMatcher)||void 0===i?void 0:i.call(n,e.value))?n.valueFormatter(e):void 0:n.valueFormatter(e);{const t=e.column.getAggFunc();if(t){if("first"===t||"last"===t)return n.valueFormatter(e);if("number"===n.baseDataType&&"count"!==t){if("number"==typeof e.value)return n.valueFormatter(e);if("object"==typeof e.value){if(!e.value)return;if("toNumber"in e.value)return n.valueFormatter(Object.assign(Object.assign({},e),{value:e.value.toNumber()}));if("value"in e.value)return n.valueFormatter(Object.assign(Object.assign({},e),{value:e.value.value}))}}}}}}updateColDefAndGetDataTypeDefinitionColumnType(e,t,i){let{cellDataType:n}=t;const{field:r}=t;if(void 0===n&&(n=e.cellDataType),null!=n&&!0!==n||(n=!!this.canInferCellDataType(e,t)&&this.inferCellDataType(r,i)),!n)return void(e.cellDataType=!1);const s=this.dataTypeDefinitions[n];if(s)return e.cellDataType=n,s.groupSafeValueFormatter&&(e.valueFormatter=s.groupSafeValueFormatter),s.valueParser&&(e.valueParser=s.valueParser),s.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,s,i),s.columnTypes;l(()=>console.warn(`AG Grid: Missing data type definition - "${n}"`),"dataTypeMissing"+n)}updateColDefAndGetColumnType(e,t,i){var n,r;const s=this.updateColDefAndGetDataTypeDefinitionColumnType(e,t,i),o=null!==(r=null!==(n=t.type)&&void 0!==n?n:s)&&void 0!==r?r:e.type;return e.type=o,o?this.convertColumnTypes(o):void 0}addColumnListeners(e){if(!this.isWaitingForRowData)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const i=e=>{t.add(e.key)};e.addEventListener(d.EVENT_STATE_UPDATED,i),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.removeEventListener(d.EVENT_STATE_UPDATED,i))}canInferCellDataType(i,e){var t;if("clientSide"!==this.rowModel.getType())return!1;const n={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(this.doColDefPropsPreventInference(e,n))return!1;const r=null===e.type?i.type:e.type;if(r){const i=null!==(t=this.gridOptionsService.get("columnTypes"))&&void 0!==t?t:{};if(this.convertColumnTypes(r).some(e=>{const t=i[e.trim()];return t&&this.doColDefPropsPreventInference(t,n)}))return!1}return!this.doColDefPropsPreventInference(i,n)}doColDefPropsPreventInference(i,n){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([e,t])=>this.doesColDefPropPreventInference(i,n,e,t))}doesColDefPropPreventInference(e,t,i,n){if(!t[i])return!1;const r=e[i];return null===r?(t[i]=!1,!1):void 0===n?!!r:r===n}inferCellDataType(e,t){var i;if(!e)return;let n;const r=this.getInitialData();if(r){const t=e.indexOf(".")>=0&&!this.gridOptionsService.is("suppressFieldDotNotation");n=Ae(r,e,t)}else this.initWaitForRowData(t);if(null==n)return;const[s]=null!==(i=Object.entries(this.dataTypeMatchers).find(([e,t])=>t(n)))&&void 0!==i?i:["object"];return s}getInitialData(){const e=this.gridOptionsService.get("rowData");if(null==e?void 0:e.length)return e[0];if(this.initialData)return this.initialData;{const e=this.rowModel.getRootNode().allLeafChildren;if(null==e?void 0:e.length)return e[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isWaitingForRowData)return;this.isWaitingForRowData=!0;const i=this.isColumnTypeOverrideInDataTypeDefinitions;i&&this.columnModel.queueResizeOperations();const n=this.addManagedListener(this.eventService,y.EVENT_ROW_DATA_UPDATE_STARTED,e=>{const{firstRowData:t}=e;t&&(null==n||n(),this.isWaitingForRowData=!1,this.processColumnsPendingInference(t,i),this.columnStateUpdatesPendingInference={},i&&this.columnModel.processResizeOperations())})}processColumnsPendingInference(e,s){this.initialData=e;const o=[];this.columnStateUpdateListenerDestroyFuncs.forEach(e=>e()),this.columnStateUpdateListenerDestroyFuncs=[];const a={},l={};Object.entries(this.columnStateUpdatesPendingInference).forEach(([e,t])=>{const i=this.columnModel.getGridColumn(e);if(!i)return;const n=i.getColDef();if(!this.columnModel.resetColumnDefIntoColumn(i))return;const r=i.getColDef();if(s&&r.type&&r.type!==n.type){const s=this.getUpdatedColumnState(i,t);s.rowGroup&&null==s.rowGroupIndex&&(a[e]=s),s.pivot&&null==s.pivotIndex&&(l[e]=s),o.push(s)}}),s&&o.push(...this.columnModel.generateColumnStateForRowGroupAndPivotIndexes(a,l)),o.length&&this.columnModel.applyColumnState({state:o},"cellDataTypeInferred"),this.initialData=null}getUpdatedColumnState(e,t){const i=this.columnModel.getColumnStateFromColDef(e);return t.forEach(e=>{delete i[e],"rowGroup"===e?delete i.rowGroupIndex:"pivot"===e&&delete i.pivotIndex}),i}checkObjectValueHandlers(e){const t=this.dataTypeDefinitions.object,i=e.object;this.hasObjectValueParser=t.valueParser!==i.valueParser,this.hasObjectValueFormatter=t.valueFormatter!==i.valueFormatter}convertColumnTypes(e){let t=[];if(e instanceof Array){e.some(e=>"string"!=typeof e)?console.warn("AG Grid: if colDef.type is supplied an array it should be of type 'string[]'"):t=e}else"string"==typeof e?t=e.split(","):console.warn("AG Grid: colDef.type should be of type 'string' | 'string[]'");return t}getDateStringTypeDefinition(){return this.dataTypeDefinitions.dateString}getDateParserFunction(){return this.getDateStringTypeDefinition().dateParser}getDateFormatterFunction(){return this.getDateStringTypeDefinition().dateFormatter}checkType(e,t){var i;const n=e.getColDef();if(!n.cellDataType||null==t)return!0;const r=null===(i=this.dataTypeDefinitions[n.cellDataType])||void 0===i?void 0:i.dataTypeMatcher;return!r||r(t)}validateColDef(e){"object"===e.cellDataType&&(e.valueFormatter!==this.dataTypeDefinitions.object.groupSafeValueFormatter||this.hasObjectValueFormatter||l(()=>console.warn('AG Grid: Cell data type is "object" but no value formatter has been provided. Please either provide an object data type definition with a value formatter, or set "colDef.valueFormatter"'),"dataTypeObjectValueFormatter"),e.editable&&e.valueParser===this.dataTypeDefinitions.object.valueParser&&!this.hasObjectValueParser&&l(()=>console.warn('AG Grid: Cell data type is "object" but no value parser has been provided. Please either provide an object data type definition with a value parser, or set "colDef.valueParser"'),"dataTypeObjectValueParser"))}setColDefPropertiesForBaseDataType(i,r,o){const a=(e,t,i)=>{let n=e.getColDef().valueFormatter;return n===r.groupSafeValueFormatter&&(n=r.valueFormatter),this.valueFormatterService.formatValue(e,t,i,n)},e=v.__isRegistered(m.SetFilterModule,this.context.getGridId()),n=this.localeService.getLocaleTextFunc(),t=e=>{const{filterParams:t}=i;i.filterParams="object"==typeof t?Object.assign(Object.assign({},t),e):e};switch(i.useValueFormatterForExport=!0,i.useValueParserForImport=!0,r.baseDataType){case"number":i.cellEditor="agNumberCellEditor",e&&t({comparator:(e,t)=>{const i=null==e?0:parseInt(e),n=null==t?0:parseInt(t);return i===n?0:i>n?1:-1}});break;case"boolean":i.cellEditor="agCheckboxCellEditor",i.cellRenderer="agCheckboxCellRenderer",i.suppressKeyboardEvent=e=>!!e.colDef.editable&&e.event.key===A.SPACE,t(e?{valueFormatter:e=>_(e.value)?n(String(e.value),e.value?"True":"False"):n("blanks","(Blanks)")}:{maxNumConditions:1,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(e,t)=>t,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(e,t)=>!1===t,numberOfInputs:0}]});break;case"date":i.cellEditor="agDateCellEditor",i.keyCreator=e=>a(e.column,e.node,e.value),e&&t({valueFormatter:e=>{const t=a(e.column,e.node,e.value);return _(t)?t:n("blanks","(Blanks)")},treeList:!0,treeListFormatter:(e,t)=>{if(1===t&&null!=e){const t=vh[Number(e)-1];return n(t,mh[t])}return null!=e?e:n("blanks","(Blanks)")}});break;case"dateString":{i.cellEditor="agDateStringCellEditor",i.keyCreator=e=>a(e.column,e.node,e.value);const r=this.getDateParserFunction();t(e?{valueFormatter:e=>{const t=a(e.column,e.node,e.value);return _(t)?t:n("blanks","(Blanks)")},treeList:!0,treeListPathGetter:e=>{const t=r(null!=e?e:void 0);return t?[String(t.getFullYear()),String(t.getMonth()+1),String(t.getDate())]:null},treeListFormatter:(e,t)=>{if(1===t&&null!=e){const t=vh[Number(e)-1];return n(t,mh[t])}return null!=e?e:n("blanks","(Blanks)")}}:{comparator:(e,t)=>{const i=r(t);return null==t||i<e?-1:i>e?1:0}});break}case"object":i.cellEditorParams={useFormatter:!0},i.comparator=(e,t)=>{const i=this.columnModel.getPrimaryColumn(o),n=null==i?void 0:i.getColDef();if(!i||!n)return 0;const r=null==e?"":a(i,null,e),s=null==t?"":a(i,null,t);return r===s?0:r>s?1:-1},i.keyCreator=e=>a(e.column,e.node,e.value),e?t({valueFormatter:e=>{const t=a(e.column,e.node,e.value);return _(t)?t:n("blanks","(Blanks)")}}):i.filterValueGetter=e=>a(e.column,e.node,this.valueService.getValue(e.column,e.node))}}getDefaultDataTypes(){const t=e=>!!e.match("^\\d{4}-\\d{2}-\\d{2}$"),i=this.localeService.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:e=>""===e.newValue?null:Number(e.newValue),valueFormatter:e=>null==e.value?"":"number"!=typeof e.value||isNaN(e.value)?i("invalidNumber","Invalid Number"):String(e.value),dataTypeMatcher:e=>"number"==typeof e},text:{baseDataType:"text",valueParser:e=>""===e.newValue?null:te(e.newValue),dataTypeMatcher:e=>"string"==typeof e},boolean:{baseDataType:"boolean",valueParser:e=>""===e.newValue?null:"true"===String(e.newValue).toLowerCase(),valueFormatter:e=>null==e.value?"":String(e.value),dataTypeMatcher:e=>"boolean"==typeof e},date:{baseDataType:"date",valueParser:e=>En(null==e.newValue?null:String(e.newValue)),valueFormatter:e=>{var t;return null==e.value?"":e.value instanceof Date&&!isNaN(e.value.getTime())?null!==(t=wn(e.value,!1))&&void 0!==t?t:"":i("invalidDate","Invalid Date")},dataTypeMatcher:e=>e instanceof Date},dateString:{baseDataType:"dateString",dateParser:e=>{var t;return null!==(t=En(e))&&void 0!==t?t:void 0},dateFormatter:e=>{var t;return null!==(t=wn(null!=e?e:null,!1))&&void 0!==t?t:void 0},valueParser:e=>t(String(e.newValue))?e.newValue:null,valueFormatter:e=>t(String(e.value))?e.value:"",dataTypeMatcher:e=>"string"==typeof e&&t(e)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:e=>{var t;return null!==(t=te(e.value))&&void 0!==t?t:""}}}}};gh([o("rowModel")],yh.prototype,"rowModel",void 0),gh([o("columnModel")],yh.prototype,"columnModel",void 0),gh([o("columnUtils")],yh.prototype,"columnUtils",void 0),gh([o("valueService")],yh.prototype,"valueService",void 0),gh([o("valueFormatterService")],yh.prototype,"valueFormatterService",void 0),gh([r],yh.prototype,"init",null),yh=gh([s("dataTypeService")],yh);var bh=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Ch=class extends f{parseValue(e,t,i,n){const r=e.getColDef(),s={node:t,data:null==t?void 0:t.data,oldValue:n,newValue:i,colDef:r,column:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context},o=r.valueParser;return _(o)?"function"==typeof o?o(s):this.expressionService.evaluate(o,s):i}};bh([o("expressionService")],Ch.prototype,"expressionService",void 0),Ch=bh([s("valueParserService")],Ch);class wh{constructor(i,e,t){e?(this.gridOptions=e,(new Ah).create(i,e,e=>{const t=new Ju(i);e.createBean(t)},void 0,t)):console.error("AG Grid: no gridOptions provided to the grid")}destroy(){this.gridOptions&&this.gridOptions.api&&this.gridOptions.api.destroy()}}let _h=1;class Ah{create(e,t,i,n,r){var s;const o=!!t.debug,a=null!==(s=t.gridId)&&void 0!==s?s:String(_h++),l=this.getRegisteredModules(r,a),c=this.createBeansList(t.rowModelType,l,a),u=this.createProvidedBeans(e,t,r);if(!c)return;const d={providedBeanInstances:u,beanClasses:c,debug:o,gridId:a},h=new Ku("AG Grid",()=>t.debug),p=new Ku("Context",()=>d.debug),f=new He(d,p),g=f.getBean("beans");this.registerModuleUserComponents(g,l),this.registerStackComponents(g,l),this.registerControllers(g,l),i(f),g.ctrlsService.whenReady(()=>{this.setColumnsAndData(g),this.dispatchGridReadyEvent(g);const e=v.__isRegistered(m.EnterpriseCoreModule,a);h.log("initialised successfully, enterprise = "+e)}),n&&n(f)}registerControllers(t,e){e.forEach(e=>{e.controllers&&e.controllers.forEach(e=>t.ctrlsFactory.register(e))})}registerStackComponents(e,t){const i=this.createAgStackComponentsList(t);e.agStackComponentsRegistry.setupComponents(i)}getRegisteredModules(e,t){const i=e?e.modules:null,n=v.__getRegisteredModules(t),r=[],s={},o=(t,e,i)=>{var n;s[(n=e).moduleName]||(s[n.moduleName]=!0,r.push(n),v.__register(n,t,i)),e.dependantModules&&e.dependantModules.forEach(e=>o(t,e,i))};return i&&i.forEach(e=>o(!0,e,t)),n&&n.forEach(e=>o(!v.__isPackageBased(),e,void 0)),r}registerModuleUserComponents(t,e){this.extractModuleEntity(e,e=>e.userComponents?e.userComponents:[]).forEach(e=>{t.userComponentRegistry.registerDefaultComponent(e.componentName,e.componentClass)})}createProvidedBeans(e,t,i){let n=i?i.frameworkOverrides:null;u(n)&&(n=new Du);const r={gridOptions:t,eGridDiv:e,globalEventListener:i?i.globalEventListener:null,frameworkOverrides:n};return i&&i.providedBeanInstances&&Object.assign(r,i.providedBeanInstances),r}createAgStackComponentsList(e){let t=[{componentName:"AgCheckbox",componentClass:as},{componentName:"AgRadioButton",componentClass:ls},{componentName:"AgToggleButton",componentClass:eu},{componentName:"AgInputTextField",componentClass:ys},{componentName:"AgInputTextArea",componentClass:tu},{componentName:"AgInputNumberField",componentClass:bs},{componentName:"AgInputDateField",componentClass:iu},{componentName:"AgInputRange",componentClass:nu},{componentName:"AgSelect",componentClass:rs},{componentName:"AgSlider",componentClass:su},{componentName:"AgGridBody",componentClass:ol},{componentName:"AgHeaderRoot",componentClass:Cc},{componentName:"AgSortIndicator",componentClass:Os},{componentName:"AgPagination",componentClass:xd},{componentName:"AgOverlayWrapper",componentClass:Md},{componentName:"AgGroupComponent",componentClass:au},{componentName:"AgPanel",componentClass:mu},{componentName:"AgDialog",componentClass:yu},{componentName:"AgRowContainer",componentClass:bl},{componentName:"AgFakeHorizontalScroll",componentClass:ih},{componentName:"AgFakeVerticalScroll",componentClass:fh}];const i=this.extractModuleEntity(e,e=>e.agStackComponents?e.agStackComponents:[]);return t=t.concat(i),t}createBeansList(t="clientSide",e,i){const n=e.filter(e=>!e.rowModel||e.rowModel===t),r={clientSide:m.ClientSideRowModelModule,infinite:m.InfiniteRowModelModule,serverSide:m.ServerSideRowModelModule,viewport:m.ViewportRowModelModule};if(!r[t])return void console.error("AG Grid: could not find row model for rowModelType = "+t);if(!v.__assertRegistered(r[t],`rowModelType = '${t}'`,i))return;const s=[P,Od,Pd,Bd,ld,O,Mo,fd,md,Rc,Xo,Ad,_c,hh,Zt,Vc,Jo,ai,qe,uh,Au,Lu,sa,ni,mc,Qc,Fc,Wu,Rt,ju,Iu,pl,ud,Hu,qu,si,Ic,Ec,M,Gu,Zl,dl,Cd,Mu,Hc,Jc,ll,id,rd,od,Sd,Pt,hd,Nc,$d,vi,Wd,jd,Kc,Yd,Xd,rh,oh,Zd,yh,Ch],o=this.extractModuleEntity(n,e=>e.beans?e.beans:[]);s.push(...o);const a=[];return s.forEach(e=>{a.indexOf(e)<0&&a.push(e)}),a}extractModuleEntity(e,t){return[].concat(...e.map(t))}setColumnsAndData(e){const t=e.gridOptionsService.get("columnDefs");e.columnModel.setColumnDefs(t||[],"gridInitializing"),e.rowModel.start()}dispatchGridReadyEvent(e){const t={type:y.EVENT_GRID_READY};e.eventService.dispatchEvent(t)}}class Eh{wrap(e,t,i=[],n){const r=this.createWrapper(e,n);return t.forEach(e=>{this.createMethod(r,e,!0)}),i.forEach(e=>{this.createMethod(r,e,!1)}),r}unwrap(e){return e}createMethod(e,t,i){e.addMethod(t,this.createMethodProxy(e,t,i))}createMethodProxy(e,t,i){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(i&&console.warn("AG Grid: Framework component is missing the method "+t+"()"),null)}}}const Sh={columnGroup:["column","stackedColumn","normalizedColumn"],barGroup:["bar","stackedBar","normalizedBar"],pieGroup:["pie","doughnut"],lineGroup:["line"],scatterGroup:["scatter","bubble"],areaGroup:["area","stackedArea","normalizedArea"],histogramGroup:["histogram"],combinationGroup:["columnLineCombo","areaColumnCombo","customCombo"]},Th=["chartSettings","chartData","chartFormat"],xh=["chartUnlink","chartLink","chartDownload"],Dh={settings:"chartSettings",data:"chartData",format:"chartFormat"},Rh=0;var Mh;!function(e){e.InsideBase="insideBase",e.InsideEnd="insideEnd",e.Center="center",e.OutsideEnd="outsideEnd"}(Mh||(Mh={}));const Nh="undefined"==typeof global?{}:global;Nh.HTMLElement="undefined"==typeof HTMLElement?{}:HTMLElement,Nh.HTMLButtonElement="undefined"==typeof HTMLButtonElement?{}:HTMLButtonElement,Nh.HTMLSelectElement="undefined"==typeof HTMLSelectElement?{}:HTMLSelectElement,Nh.HTMLInputElement="undefined"==typeof HTMLInputElement?{}:HTMLInputElement,Nh.Node="undefined"==typeof Node?{}:Node,Nh.MouseEvent="undefined"==typeof MouseEvent?{}:MouseEvent},function(e,t,i){"use strict";i.r(t),i.d(t,"ClientSideRowModelModule",function(){return C});var m=i(0);class a{constructor(e,t,i,n,r,s){this.nextId=0,this.allNodesMap={},this.rootNode=e,this.gridOptionsService=t,this.eventService=i,this.columnModel=n,this.beans=s,this.selectionService=r,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=a.ROOT_NODE_ID,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[],this.postConstruct()}postConstruct(){this.suppressParentsInRowNodes=this.gridOptionsService.is("suppressParentsInRowNodes"),this.isRowMasterFunc=this.gridOptionsService.get("isRowMaster"),this.doingTreeData=this.gridOptionsService.isTreeData(),this.doingMasterDetail=this.gridOptionsService.isMasterDetail()}getCopyOfNodesMap(){return m._.cloneObject(this.allNodesMap)}getRowNode(e){return this.allNodesMap[e]}setRowData(e){if("string"==typeof e)return void console.warn("AG Grid: rowData must be an array, however you passed in a string. If you are loading JSON, make sure you convert the JSON string to JavaScript objects first");this.dispatchRowDataUpdateStartedEvent(e);const t=this.rootNode,i=this.rootNode.sibling;t.childrenAfterFilter=null,t.childrenAfterGroup=null,t.childrenAfterAggFilter=null,t.childrenAfterSort=null,t.childrenMapped=null,t.updateHasChildren(),this.nextId=0,this.allNodesMap={},e?t.allLeafChildren=e.map(e=>this.createNode(e,this.rootNode,a.TOP_LEVEL)):(t.allLeafChildren=[],t.childrenAfterGroup=[]),i&&(i.childrenAfterFilter=t.childrenAfterFilter,i.childrenAfterGroup=t.childrenAfterGroup,i.childrenAfterAggFilter=t.childrenAfterAggFilter,i.childrenAfterSort=t.childrenAfterSort,i.childrenMapped=t.childrenMapped,i.allLeafChildren=t.allLeafChildren)}updateRowData(e,t){this.dispatchRowDataUpdateStartedEvent(e.add);const i={remove:[],update:[],add:[]},n=[];return this.executeRemove(e,i,n),this.executeUpdate(e,i,n),this.executeAdd(e,i),this.updateSelection(n,"rowDataChanged"),t&&m._.sortRowNodesByOrder(this.rootNode.allLeafChildren,t),i}dispatchRowDataUpdateStartedEvent(e){const t={type:m.Events.EVENT_ROW_DATA_UPDATE_STARTED,firstRowData:(null==e?void 0:e.length)?e[0]:null};this.eventService.dispatchEvent(t)}updateSelection(e,t){const i=e.length>0;if(i&&this.selectionService.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),this.selectionService.updateGroupsFromChildrenSelections(t),i){const e={type:m.Events.EVENT_SELECTION_CHANGED,source:t};this.eventService.dispatchEvent(e)}}executeAdd(i,n){var r;const{add:e,addIndex:s}=i;if(m._.missingOrEmpty(e))return;const o=e.map(e=>this.createNode(e,this.rootNode,a.TOP_LEVEL));if("number"==typeof s&&s>=0){const{allLeafChildren:i}=this.rootNode,n=i.length;let t=s;if(this.doingTreeData&&s>0&&n>0)for(let e=0;e<n;e++)if((null===(r=i[e])||void 0===r?void 0:r.rowIndex)==s-1){t=e+1;break}const a=i.slice(0,t),e=i.slice(t,i.length);this.rootNode.allLeafChildren=[...a,...o,...e]}else this.rootNode.allLeafChildren=[...this.rootNode.allLeafChildren,...o];this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren),n.add=o}executeRemove(e,i,n){const{remove:t}=e;if(m._.missingOrEmpty(t))return;const r={};t.forEach(e=>{const t=this.lookupRowNode(e);t&&(t.isSelected()&&n.push(t),t.clearRowTopAndRowIndex(),r[t.id]=!0,delete this.allNodesMap[t.id],i.remove.push(t))}),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren.filter(e=>!r[e.id]),this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren)}executeUpdate(e,i,n){const{update:t}=e;m._.missingOrEmpty(t)||t.forEach(e=>{const t=this.lookupRowNode(e);t&&(t.updateData(e),!t.selectable&&t.isSelected()&&n.push(t),this.setMasterForRow(t,e,a.TOP_LEVEL,!1),i.update.push(t))})}lookupRowNode(t){const i=this.gridOptionsService.getCallback("getRowId");let n;if(i){const e=i({data:t,level:0});if(n=this.allNodesMap[e],!n)return console.error(`AG Grid: could not find row id=${e}, data item was not found for this id`),null}else if(n=this.rootNode.allLeafChildren.find(e=>e.data===t),!n)return console.error("AG Grid: could not find data item as object was not found",t),console.error("Consider using getRowId to help the Grid find matching row data"),null;return n||null}createNode(e,t,i){const n=new m.RowNode(this.beans);return n.group=!1,this.setMasterForRow(n,e,i,!0),t&&!this.suppressParentsInRowNodes&&(n.parent=t),n.level=i,n.setDataAndId(e,this.nextId.toString()),this.allNodesMap[n.id]&&console.warn(`AG Grid: duplicate node id '${n.id}' detected from getRowId callback, this could cause issues in your grid.`),this.allNodesMap[n.id]=n,this.nextId++,n}setMasterForRow(e,t,i,n){if(this.doingTreeData)e.setMaster(!1),n&&(e.expanded=!1);else if(this.doingMasterDetail?this.isRowMasterFunc?e.setMaster(this.isRowMasterFunc(t)):e.setMaster(!0):e.setMaster(!1),n){const t=this.columnModel.getRowGroupColumns(),n=i+(t?t.length:0);e.expanded=!!e.master&&this.isExpanded(n)}}isExpanded(e){const t=this.gridOptionsService.getNum("groupDefaultExpanded");return-1===t||e<t}}a.TOP_LEVEL=0,a.ROOT_NODE_ID="ROOT_NODE_ID";var l,n=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};!function(e){e[e.Normal=0]="Normal",e[e.AfterFilter=1]="AfterFilter",e[e.AfterFilterAndSort=2]="AfterFilterAndSort",e[e.PivotNodes=3]="PivotNodes"}(l||(l={}));let r=class extends m.BeanStub{constructor(){super(...arguments),this.onRowHeightChanged_debounced=m._.debounce(this.onRowHeightChanged.bind(this),100),this.rowsToDisplay=[]}init(){const e=this.refreshModel.bind(this,{step:m.ClientSideRowModelSteps.EVERYTHING}),t=!this.gridOptionsService.is("suppressAnimationFrame"),i=this.refreshModel.bind(this,{step:m.ClientSideRowModelSteps.EVERYTHING,afterColumnsChanged:!0,keepRenderedRows:!0,animate:t});this.addManagedListener(this.eventService,m.Events.EVENT_NEW_COLUMNS_LOADED,i),this.addManagedListener(this.eventService,m.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.addManagedListener(this.eventService,m.Events.EVENT_COLUMN_VALUE_CHANGED,this.onValueChanged.bind(this)),this.addManagedListener(this.eventService,m.Events.EVENT_COLUMN_PIVOT_CHANGED,this.refreshModel.bind(this,{step:m.ClientSideRowModelSteps.PIVOT})),this.addManagedListener(this.eventService,m.Events.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,m.Events.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,m.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,e),this.addManagedListener(this.eventService,m.Events.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanges.bind(this));const n=this.refreshModel.bind(this,{step:m.ClientSideRowModelSteps.MAP,keepRenderedRows:!0,animate:t});this.addManagedPropertyListener("groupRemoveSingleChildren",n),this.addManagedPropertyListener("groupRemoveLowestSingleChildren",n),this.rootNode=new m.RowNode(this.beans),this.nodeManager=new a(this.rootNode,this.gridOptionsService,this.eventService,this.columnModel,this.selectionService,this.beans)}start(){const e=this.gridOptionsService.get("rowData");e&&this.setRowData(e)}ensureRowHeightsValid(r,s,o,a){let l,c=!1;do{l=!1;const e=this.getRowIndexAtPixel(r),t=this.getRowIndexAtPixel(s),i=Math.max(e,o),n=Math.min(t,a);for(let e=i;e<=n;e++){const s=this.getRow(e);if(s.rowHeightEstimated){const r=this.gridOptionsService.getRowHeightForNode(s);s.setRowHeight(r.height),l=!0,c=!0}}l&&this.setRowTopAndRowIndex()}while(l);return c}setRowTopAndRowIndex(){const i=this.environment.getDefaultRowHeight();let n=0;const r=new Set,s=this.gridOptionsService.isDomLayout("normal");for(let t=0;t<this.rowsToDisplay.length;t++){const e=this.rowsToDisplay[t];if(null!=e.id&&r.add(e.id),null==e.rowHeight){const n=this.gridOptionsService.getRowHeightForNode(e,s,i);e.setRowHeight(n.height,n.estimated)}e.setRowTop(n),e.setRowIndex(t),n+=e.rowHeight}return r}clearRowTopAndRowIndex(e,t){const i=e.isActive(),n=e=>{e&&null!=e.id&&!t.has(e.id)&&e.clearRowTopAndRowIndex()},r=t=>{if(n(t),n(t.detailNode),n(t.sibling),t.hasChildren()&&t.childrenAfterGroup){const e=-1==t.level;i&&!e&&!t.expanded||t.childrenAfterGroup.forEach(r)}};r(this.rootNode)}ensureRowsAtPixel(e,t,i=0){const n=this.getRowIndexAtPixel(t),r=this.getRow(n),s=!this.gridOptionsService.is("suppressAnimationFrame");return r!==e[0]&&(e.forEach(e=>{m._.removeFromArray(this.rootNode.allLeafChildren,e)}),e.forEach((e,t)=>{m._.insertIntoArray(this.rootNode.allLeafChildren,e,Math.max(n+i,0)+t)}),this.refreshModel({step:m.ClientSideRowModelSteps.EVERYTHING,keepRenderedRows:!0,keepEditingRows:!0,animate:s}),!0)}highlightRowAtPixel(e,t){const i=null!=t?this.getRowIndexAtPixel(t):null,n=null!=i?this.getRow(i):null;if(!n||!e||n===e||null==t)return void(this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null));const r=this.getHighlightPosition(t,n);this.lastHighlightedRow&&this.lastHighlightedRow!==n&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),n.setHighlighted(r),this.lastHighlightedRow=n}getHighlightPosition(e,t){if(!t){const i=this.getRowIndexAtPixel(e);if(!(t=this.getRow(i||0)))return m.RowHighlightPosition.Below}const{rowTop:i,rowHeight:n}=t;return e-i<n/2?m.RowHighlightPosition.Above:m.RowHighlightPosition.Below}getLastHighlightedRowNode(){return this.lastHighlightedRow}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;const e=this.rootNode.childrenAfterAggFilter;return e?e.length:0}getTopLevelRowDisplayedIndex(e){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return e;let t=this.rootNode.childrenAfterSort[e];if(this.gridOptionsService.is("groupHideOpenParents"))for(;t.expanded&&t.childrenAfterSort&&t.childrenAfterSort.length>0;)t=t.childrenAfterSort[0];return t.rowIndex}getRowBounds(e){if(m._.missing(this.rowsToDisplay))return null;const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){const e=this.gridOptionsService.isAnimateRows();this.refreshModel({step:m.ClientSideRowModelSteps.MAP,keepRenderedRows:!0,animate:e})}onFilterChanged(e){if(e.afterDataChange)return;const t=this.gridOptionsService.isAnimateRows(),i=0===e.columns.length||e.columns.some(e=>e.isPrimary())?m.ClientSideRowModelSteps.FILTER:m.ClientSideRowModelSteps.FILTER_AGGREGATES;this.refreshModel({step:i,keepRenderedRows:!0,animate:t})}onSortChanged(){const e=this.gridOptionsService.isAnimateRows();this.refreshModel({step:m.ClientSideRowModelSteps.SORT,keepRenderedRows:!0,animate:e,keepEditingRows:!0})}getType(){return"clientSide"}onValueChanged(){this.columnModel.isPivotActive()?this.refreshModel({step:m.ClientSideRowModelSteps.PIVOT}):this.refreshModel({step:m.ClientSideRowModelSteps.AGGREGATE})}createChangePath(e){const t=m._.missingOrEmpty(e),i=new m.ChangedPath(!1,this.rootNode);return(t||this.gridOptionsService.isTreeData())&&i.setInactive(),i}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gridOptionsService.is("suppressModelUpdateAfterUpdateTransaction"))return!1;if(null==e.rowNodeTransactions)return!1;const t=e.rowNodeTransactions.filter(e=>null!=e.add&&e.add.length>0||null!=e.remove&&e.remove.length>0);return null==t||0==t.length}buildRefreshModelParams(e){let t=m.ClientSideRowModelSteps.EVERYTHING;const i={everything:m.ClientSideRowModelSteps.EVERYTHING,group:m.ClientSideRowModelSteps.EVERYTHING,filter:m.ClientSideRowModelSteps.FILTER,map:m.ClientSideRowModelSteps.MAP,aggregate:m.ClientSideRowModelSteps.AGGREGATE,sort:m.ClientSideRowModelSteps.SORT,pivot:m.ClientSideRowModelSteps.PIVOT};if(m._.exists(e)&&(t=i[e]),m._.missing(t))return void console.error(`AG Grid: invalid step ${e}, available steps are ${Object.keys(i).join(", ")}`);return{step:t,keepRenderedRows:!0,keepEditingRows:!0,animate:!this.gridOptionsService.is("suppressAnimationFrame")}}refreshModel(e){let t="object"==typeof e&&"step"in e?e:this.buildRefreshModelParams(e);if(!t)return;if(this.isSuppressModelUpdateAfterUpdateTransaction(t))return;const i=this.createChangePath(t.rowNodeTransactions);switch(t.step){case m.ClientSideRowModelSteps.EVERYTHING:this.doRowGrouping(t.groupState,t.rowNodeTransactions,t.rowNodeOrder,i,!!t.afterColumnsChanged);case m.ClientSideRowModelSteps.FILTER:this.doFilter(i);case m.ClientSideRowModelSteps.PIVOT:this.doPivot(i);case m.ClientSideRowModelSteps.AGGREGATE:this.doAggregate(i);case m.ClientSideRowModelSteps.FILTER_AGGREGATES:this.doFilterAggregates(i);case m.ClientSideRowModelSteps.SORT:this.doSort(t.rowNodeTransactions,i);case m.ClientSideRowModelSteps.MAP:this.doRowsToDisplay()}const n=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(i,n);const r={type:m.Events.EVENT_MODEL_UPDATED,animate:t.animate,keepRenderedRows:t.keepRenderedRows,newData:t.newData,newPage:!1,keepUndoRedoStack:t.keepUndoRedoStack};this.eventService.dispatchEvent(r)}isEmpty(){const e=m._.missing(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length;return m._.missing(this.rootNode)||e||!this.columnModel.isReady()}isRowsToRender(){return m._.exists(this.rowsToDisplay)&&this.rowsToDisplay.length>0}getNodesInRangeForSelection(t,i){let n=!i,r=!1;const s=[],o=this.gridOptionsService.is("groupSelectsChildren");return this.forEachNodeAfterFilterAndSort(e=>{if(r)return;if(n&&(e===i||e===t)&&(r=!0,e.group&&o))return void s.push(...e.allLeafChildren);if(!n){if(e!==i&&e!==t)return;n=!0}(!e.group||!o)&&s.push(e)}),s}setDatasource(e){console.error("AG Grid: should never call setDatasource on clientSideRowController")}getTopLevelNodes(){return this.rootNode?this.rootNode.childrenAfterGroup:null}getRootNode(){return this.rootNode}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(t){if(this.isEmpty()||0===this.rowsToDisplay.length)return-1;let i=0,n=this.rowsToDisplay.length-1;if(t<=0)return 0;if(m._.last(this.rowsToDisplay).rowTop<=t)return this.rowsToDisplay.length-1;let r=-1,s=-1;for(;;){const m=Math.floor((i+n)/2),e=this.rowsToDisplay[m];if(this.isRowInPixel(e,t))return m;e.rowTop<t?i=m+1:e.rowTop>t&&(n=m-1);if(r===i&&s===n)return m;r=i,s=n}}isRowInPixel(e,t){const i=e.rowTop,n=e.rowTop+e.rowHeight;return i<=t&&n>t}forEachLeafNode(i){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((e,t)=>i(e,t))}forEachNode(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterGroup||[]],callback:e,recursionType:l.Normal,index:0,includeFooterNodes:t})}forEachNodeAfterFilter(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterAggFilter||[]],callback:e,recursionType:l.AfterFilter,index:0,includeFooterNodes:t})}forEachNodeAfterFilterAndSort(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterSort||[]],callback:e,recursionType:l.AfterFilterAndSort,index:0,includeFooterNodes:t})}forEachPivotNode(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:e,recursionType:l.PivotNodes,index:0,includeFooterNodes:t})}recursivelyWalkNodesAndCallback(e){var t;const{nodes:i,callback:n,recursionType:r,includeFooterNodes:s}=e;let{index:o}=e;const a=i[0];s&&(null===(t=null==a?void 0:a.parent)||void 0===t?void 0:t.sibling)&&i.push(a.parent.sibling);for(let e=0;e<i.length;e++){const t=i[e];if(n(t,o++),t.hasChildren()&&!t.footer){let e=null;switch(r){case l.Normal:e=t.childrenAfterGroup;break;case l.AfterFilter:e=t.childrenAfterAggFilter;break;case l.AfterFilterAndSort:e=t.childrenAfterSort;break;case l.PivotNodes:e=t.leafGroup?null:t.childrenAfterSort}e&&(o=this.recursivelyWalkNodesAndCallback({nodes:[...e],callback:n,recursionType:r,index:o,includeFooterNodes:s}))}}return o}doAggregate(e){this.aggregationStage&&this.aggregationStage.execute({rowNode:this.rootNode,changedPath:e})}doFilterAggregates(e){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:e}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter}expandOrCollapseAll(i){const n=this.gridOptionsService.isTreeData(),r=this.columnModel.isPivotActive(),s=e=>{e&&e.forEach(e=>{const t=()=>{e.expanded=i,s(e.childrenAfterGroup)};if(n){return void(m._.exists(e.childrenAfterGroup)&&t())}if(r){return void(!e.leafGroup&&t())}e.group&&t()})};this.rootNode&&s(this.rootNode.childrenAfterGroup),this.refreshModel({step:m.ClientSideRowModelSteps.MAP});const e=i?"expandAll":"collapseAll",t={type:m.Events.EVENT_EXPAND_COLLAPSE_ALL,source:e};this.eventService.dispatchEvent(t)}doSort(e,t){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,changedPath:t})}doRowGrouping(e,t,i,n,r){if(this.groupStage){if(t?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:t,rowNodeOrder:i,changedPath:n}):(this.groupStage.execute({rowNode:this.rootNode,changedPath:n,afterColumnsChanged:r}),this.restoreGroupState(e)),this.gridOptionsService.is("groupSelectsChildren")){if(this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",n)){const e={type:m.Events.EVENT_SELECTION_CHANGED,source:"rowGroupChanged"};this.eventService.dispatchEvent(e)}}}else this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren,this.rootNode.sibling&&(this.rootNode.sibling.childrenAfterGroup=this.rootNode.childrenAfterGroup),this.rootNode.updateHasChildren()}restoreGroupState(i){i&&m._.traverseNodesWithKey(this.rootNode.childrenAfterGroup,(e,t)=>{"boolean"==typeof i[t]&&(e.expanded=i[t])})}doFilter(e){this.filterStage.execute({rowNode:this.rootNode,changedPath:e})}doPivot(e){this.pivotStage&&this.pivotStage.execute({rowNode:this.rootNode,changedPath:e})}getGroupState(){if(!this.rootNode.childrenAfterGroup||!this.gridOptionsService.is("rememberGroupStateWhenNewData"))return null;const i={};return m._.traverseNodesWithKey(this.rootNode.childrenAfterGroup,(e,t)=>i[t]=e.expanded),i}getCopyOfNodesMap(){return this.nodeManager.getCopyOfNodesMap()}getRowNode(i){if("string"==typeof i&&0==i.indexOf(m.RowNode.ID_PREFIX_ROW_GROUP)){let t=void 0;return this.forEachNode(e=>{e.id===i&&(t=e)}),t}return this.nodeManager.getRowNode(i)}setRowData(e){const t=this.getGroupState();this.nodeManager.setRowData(e),this.selectionService.reset(),this.filterManager.onNewRowsLoaded("rowDataUpdated");const i={type:m.Events.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(i),this.refreshModel({step:m.ClientSideRowModelSteps.EVERYTHING,groupState:t,newData:!0})}batchUpdateRowData(e,t){if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];const e=this.gridOptionsService.getAsyncTransactionWaitMillis();this.applyAsyncTransactionsTimeout=window.setTimeout(()=>{this.executeBatchUpdateRowData()},e)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache.onDataChanged();const i=[],n=[];let r=!1;if(this.rowDataTransactionBatch&&this.rowDataTransactionBatch.forEach(e=>{const t=this.nodeManager.updateRowData(e.rowDataTransaction,void 0);n.push(t),e.callback&&i.push(e.callback.bind(null,t)),"number"==typeof e.rowDataTransaction.addIndex&&(r=!0)}),this.commonUpdateRowData(n,void 0,r),i.length>0&&window.setTimeout(()=>{i.forEach(e=>e())},0),n.length>0){const i={type:m.Events.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:n};this.eventService.dispatchEvent(i)}this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(e,t){this.valueCache.onDataChanged();const i=this.nodeManager.updateRowData(e,t),n="number"==typeof e.addIndex;return this.commonUpdateRowData([i],t,n),i}createRowNodeOrder(){if(this.gridOptionsService.is("suppressMaintainUnsortedOrder"))return;const t={};if(this.rootNode&&this.rootNode.allLeafChildren)for(let e=0;e<this.rootNode.allLeafChildren.length;e++){t[this.rootNode.allLeafChildren[e].id]=e}return t}commonUpdateRowData(e,t,i){const n=!this.gridOptionsService.is("suppressAnimationFrame");i&&(t=this.createRowNodeOrder()),this.refreshModel({step:m.ClientSideRowModelSteps.EVERYTHING,rowNodeTransactions:e,rowNodeOrder:t,keepRenderedRows:!0,keepEditingRows:!0,animate:n}),this.filterManager.onNewRowsLoaded("rowDataUpdated");const r={type:m.Events.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(r)}doRowsToDisplay(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})}onRowHeightChanged(){this.refreshModel({step:m.ClientSideRowModelSteps.MAP,keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}resetRowHeights(){const e=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),e&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let i=!1;return this.forEachNode(e=>{e.setRowHeight(e.rowHeight,!0);const t=e.detailNode;t&&t.setRowHeight(t.rowHeight,!0),i=!0}),i}onGridStylesChanges(){this.columnModel.isAutoRowHeightActive()||this.resetRowHeights()}};n([Object(m.Autowired)("columnModel")],r.prototype,"columnModel",void 0),n([Object(m.Autowired)("selectionService")],r.prototype,"selectionService",void 0),n([Object(m.Autowired)("filterManager")],r.prototype,"filterManager",void 0),n([Object(m.Autowired)("valueCache")],r.prototype,"valueCache",void 0),n([Object(m.Autowired)("beans")],r.prototype,"beans",void 0),n([Object(m.Autowired)("filterStage")],r.prototype,"filterStage",void 0),n([Object(m.Autowired)("sortStage")],r.prototype,"sortStage",void 0),n([Object(m.Autowired)("flattenStage")],r.prototype,"flattenStage",void 0),n([Object(m.Optional)("groupStage")],r.prototype,"groupStage",void 0),n([Object(m.Optional)("aggregationStage")],r.prototype,"aggregationStage",void 0),n([Object(m.Optional)("pivotStage")],r.prototype,"pivotStage",void 0),n([Object(m.Optional)("filterAggregatesStage")],r.prototype,"filterAggregatesStage",void 0),n([m.PostConstruct],r.prototype,"init",null),r=n([Object(m.Bean)("rowModel")],r);var s=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let o=class extends m.BeanStub{execute(e){const{changedPath:t}=e;this.filterService.filter(t)}};s([Object(m.Autowired)("filterService")],o.prototype,"filterService",void 0),o=s([Object(m.Bean)("filterStage")],o);var c=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let u=class extends m.BeanStub{execute(e){const t=this.sortController.getSortOptions(),i=m._.exists(t)&&t.length>0,n=i&&m._.exists(e.rowNodeTransactions)&&this.gridOptionsService.is("deltaSort"),r=t.some(e=>!!this.columnModel.getGroupDisplayColumnForGroup(e.column.getId()));this.sortService.sort(t,i,n,e.rowNodeTransactions,e.changedPath,r)}};c([Object(m.Autowired)("sortService")],u.prototype,"sortService",void 0),c([Object(m.Autowired)("sortController")],u.prototype,"sortController",void 0),c([Object(m.Autowired)("columnModel")],u.prototype,"columnModel",void 0),u=c([Object(m.Bean)("sortStage")],u);var d=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let h=class extends m.BeanStub{execute(e){const t=e.rowNode,i=[],n={value:0},r=this.columnModel.isPivotMode(),s=r&&t.leafGroup,o=s?[t]:t.childrenAfterSort;this.recursivelyAddToRowsToDisplay(o,i,n,r,0);return!s&&i.length>0&&this.gridOptionsService.is("groupIncludeTotalFooter")&&(t.createFooter(),this.addRowNodeToRowsToDisplay(t.sibling,i,n,0)),i}recursivelyAddToRowsToDisplay(l,c,u,d,h){if(m._.missingOrEmpty(l))return;const p=this.gridOptionsService.is("groupHideOpenParents"),f=this.gridOptionsService.is("groupRemoveSingleChildren"),g=!f&&this.gridOptionsService.is("groupRemoveLowestSingleChildren");for(let a=0;a<l.length;a++){const e=l[a],t=e.hasChildren(),i=d&&!t,n=f&&t&&1===e.childrenAfterGroup.length,r=g&&t&&e.leafGroup&&1===e.childrenAfterGroup.length,s=d&&e.leafGroup,o=p&&e.expanded&&!e.master&&!s;if(!(i||o||n||r)&&this.addRowNodeToRowsToDisplay(e,c,u,h),!d||!e.leafGroup)if(t){const l=n||r;if(e.expanded||l){const m=l?h:h+1;this.recursivelyAddToRowsToDisplay(e.childrenAfterSort,c,u,d,m),this.gridOptionsService.is("groupIncludeFooter")&&this.addRowNodeToRowsToDisplay(e.sibling,c,u,m)}}else if(e.master&&e.expanded){const l=this.createDetailNode(e);this.addRowNodeToRowsToDisplay(l,c,u,h)}}}addRowNodeToRowsToDisplay(e,t,i,n){const r=this.gridOptionsService.isGroupMultiAutoColumn();t.push(e),e.setUiLevel(r?0:n)}createDetailNode(e){if(m._.exists(e.detailNode))return e.detailNode;const t=new m.RowNode(this.beans);return t.detail=!0,t.selectable=!1,t.parent=e,m._.exists(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1,e.detailNode=t,t}};d([Object(m.Autowired)("columnModel")],h.prototype,"columnModel",void 0),d([Object(m.Autowired)("beans")],h.prototype,"beans",void 0),h=d([Object(m.Bean)("flattenStage")],h);var p=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let f=class extends m.BeanStub{init(){this.postSortFunc=this.gridOptionsService.getCallback("postSortRows")}sort(i,r,n,e,s,o){const a=this.gridOptionsService.is("groupMaintainOrder"),l=this.columnModel.getAllGridColumns().some(e=>e.isRowGroupActive());let c={};n&&e&&(c=this.calculateDirtyNodes(e));const u=this.columnModel.isPivotMode(),t=e=>{this.pullDownGroupDataForHideOpenParents(e.childrenAfterAggFilter,!0);const t=u&&e.leafGroup;if(a&&l&&!e.leafGroup&&!o){const i=e.childrenAfterAggFilter.slice(0);if(e.childrenAfterSort){const r={};e.childrenAfterSort.forEach((e,t)=>{r[e.id]=t}),i.sort((e,t)=>{var i,n;return(null!==(i=r[e.id])&&void 0!==i?i:0)-(null!==(n=r[t.id])&&void 0!==n?n:0)})}e.childrenAfterSort=i}else e.childrenAfterSort=!r||t?e.childrenAfterAggFilter.slice(0):n?this.doDeltaSort(e,c,s,i):this.rowNodeSorter.doFullSort(e.childrenAfterAggFilter,i);if(e.sibling&&(e.sibling.childrenAfterSort=e.childrenAfterSort),this.updateChildIndexes(e),this.postSortFunc){const i={nodes:e.childrenAfterSort};this.postSortFunc(i)}};s&&s.forEachChangedNodeDepthFirst(t),this.updateGroupDataForHideOpenParents(s)}calculateDirtyNodes(e){const t={},i=e=>{e&&e.forEach(e=>t[e.id]=!0)};return e&&e.forEach(e=>{i(e.add),i(e.update),i(e.remove)}),t}doDeltaSort(e,t,i,n){const r=e.childrenAfterAggFilter,s=e.childrenAfterSort;if(!s)return this.rowNodeSorter.doFullSort(r,n);const o={},a=[];r.forEach(e=>{t[e.id]||!i.canSkip(e)?a.push(e):o[e.id]=!0});const l=s.filter(e=>o[e.id]),c=(e,t)=>({currentPos:t,rowNode:e}),u=a.map(c).sort((e,t)=>this.rowNodeSorter.compareRowNodes(n,e,t));return this.mergeSortedArrays(n,u,l.map(c)).map(({rowNode:e})=>e)}mergeSortedArrays(e,t,i){const n=[];let r=0,s=0;for(;r<t.length&&s<i.length;){this.rowNodeSorter.compareRowNodes(e,t[r],i[s])<0?n.push(t[r++]):n.push(i[s++])}for(;r<t.length;)n.push(t[r++]);for(;s<i.length;)n.push(i[s++]);return n}updateChildIndexes(n){if(m._.missing(n.childrenAfterSort))return;const r=n.childrenAfterSort;for(let i=0;i<r.length;i++){const m=r[i],e=0===i,t=i===n.childrenAfterSort.length-1;m.setFirstChild(e),m.setLastChild(t),m.setChildIndex(i)}}updateGroupDataForHideOpenParents(e){if(!this.gridOptionsService.is("groupHideOpenParents"))return;if(this.gridOptionsService.isTreeData()){const e="AG Grid: The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them (as opposed to Row Grouping, which only has Aggregated Values at the group level).";return m._.doOnce(()=>console.warn(e),"sortService.hideOpenParentsWithTreeData"),!1}const t=e=>{this.pullDownGroupDataForHideOpenParents(e.childrenAfterSort,!1),e.childrenAfterSort.forEach(e=>{e.hasChildren()&&t(e)})};e&&e.executeFromRootNode(e=>t(e))}pullDownGroupDataForHideOpenParents(e,s){this.gridOptionsService.is("groupHideOpenParents")&&!m._.missing(e)&&e.forEach(r=>{this.columnModel.getGroupDisplayColumns().forEach(e=>{const t=e.getColDef().showRowGroup;if("string"!=typeof t)return void console.error("AG Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup");const i=t,n=this.columnModel.getPrimaryColumn(i);if(!(n===r.rowGroupColumn))if(s)r.setGroupValue(e.getId(),void 0);else{const s=r.getFirstChildOfFirstChild(n);s&&r.setGroupValue(e.getId(),s.key)}})})}};p([Object(m.Autowired)("columnModel")],f.prototype,"columnModel",void 0),p([Object(m.Autowired)("rowNodeSorter")],f.prototype,"rowNodeSorter",void 0),p([m.PostConstruct],f.prototype,"init",null),f=p([Object(m.Bean)("sortService")],f);var g=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let v=class extends m.BeanStub{filter(e){const t=this.filterManager.isColumnFilterPresent()||this.filterManager.isQuickFilterPresent()||this.filterManager.isExternalFilterPresent();this.filterNodes(t,e)}filterNodes(s,t){const o=(e,t)=>{e.hasChildren()?e.childrenAfterFilter=s&&!t?e.childrenAfterGroup.filter(e=>{const t=e.childrenAfterFilter&&e.childrenAfterFilter.length>0,i=e.data&&this.filterManager.doesRowPassFilter({rowNode:e});return t||i}):e.childrenAfterGroup:e.childrenAfterFilter=e.childrenAfterGroup,e.sibling&&(e.sibling.childrenAfterFilter=e.childrenAfterFilter)};if(this.doingTreeDataFiltering()){const s=(n,r)=>{if(n.childrenAfterGroup)for(let i=0;i<n.childrenAfterGroup.length;i++){const e=n.childrenAfterGroup[i],t=r||this.filterManager.doesRowPassFilter({rowNode:e});e.childrenAfterGroup?s(n.childrenAfterGroup[i],t):o(e,t)}o(n,r)},e=e=>s(e,!1);t.executeFromRootNode(e)}else{const s=e=>o(e,!1);t.forEachChangedNodeDepthFirst(s,!0)}}doingTreeDataFiltering(){return this.gridOptionsService.isTreeData()&&!this.gridOptionsService.is("excludeChildrenWhenTreeDataFiltering")}};g([Object(m.Autowired)("filterManager")],v.prototype,"filterManager",void 0),v=g([Object(m.Bean)("filterService")],v);var y=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let b=class extends m.BeanStub{postConstruct(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel)}isActive(){const e=this.gridOptionsService.exists("getRowId");return!this.gridOptionsService.is("resetRowDataOnUpdate")&&e}setRowData(e){const t=this.createTransactionForRowData(e);if(!t)return;const[i,n]=t;this.clientSideRowModel.updateRowData(i,n)}createTransactionForRowData(e){if(m._.missing(this.clientSideRowModel))return void console.error("AG Grid: ImmutableService only works with ClientSideRowModel");const r=this.gridOptionsService.getCallback("getRowId");if(null==r)return void console.error("AG Grid: ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!");const s={remove:[],update:[],add:[]},o=this.clientSideRowModel.getCopyOfNodesMap(),a=this.gridOptionsService.is("suppressMaintainUnsortedOrder")?void 0:{};return m._.exists(e)&&e.forEach((e,t)=>{const i=r({data:e,level:0}),n=o[i];if(a&&(a[i]=t),n){n.data!==e&&s.update.push(e),o[i]=void 0}else s.add.push(e)}),m._.iterateObject(o,(e,t)=>{t&&s.remove.push(t.data)}),[s,a]}};y([Object(m.Autowired)("rowModel")],b.prototype,"rowModel",void 0),y([Object(m.Autowired)("rowRenderer")],b.prototype,"rowRenderer",void 0),y([m.PostConstruct],b.prototype,"postConstruct",null),b=y([Object(m.Bean)("immutableService")],b);const C={version:"30.0.6",moduleName:m.ModuleNames.ClientSideRowModelModule,rowModel:"clientSide",beans:[r,o,u,h,f,v,b]}},function(e,t,i){"use strict";i.r(t),i.d(t,"BaseCreator",function(){return n}),i.d(t,"BaseGridSerializingSession",function(){return r}),i.d(t,"CsvCreator",function(){return a}),i.d(t,"CsvExportModule",function(){return d}),i.d(t,"Downloader",function(){return s}),i.d(t,"GridSerializer",function(){return u}),i.d(t,"RowType",function(){return l}),i.d(t,"XmlFactory",function(){return p}),i.d(t,"ZipContainer",function(){return g});class n{setBeans(e){this.beans=e}getFileName(e){const t=this.getDefaultFileExtension();return null!=e&&e.length||(e=this.getDefaultFileName()),-1===e.indexOf(".")?`${e}.${t}`:e}getData(e){const t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}}class r{constructor(e){this.groupColumns=[];const{columnModel:t,valueService:i,gridOptionsService:n,valueFormatterService:r,valueParserService:s,processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c}=e;this.columnModel=t,this.valueService=i,this.gridOptionsService=n,this.valueFormatterService=r,this.valueParserService=s,this.processCellCallback=o,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=c}prepare(e){this.groupColumns=e.filter(e=>!!e.getColDef().showRowGroup)}extractHeaderValue(e){const t=this.getHeaderName(this.processHeaderCallback,e);return null!=t?t:""}extractRowCellValue(e,t,i,n,r){const s=this.gridOptionsService.is("groupHideOpenParents")&&!r.footer||!this.shouldRenderGroupSummaryCell(r,e,t)?this.valueService.getValue(e,r):this.createValueForGroupNode(r);return this.processCell({accumulatedRowIndex:i,rowNode:r,column:e,value:s,processCellCallback:this.processCellCallback,type:n})}shouldRenderGroupSummaryCell(e,t,i){var n;if(!(e&&e.group))return!1;if(-1!==this.groupColumns.indexOf(t)){if(null!=(null===(n=e.groupData)||void 0===n?void 0:n[t.getId()]))return!0;if(e.footer&&-1===e.level){const e=t.getColDef();return null==e||!0===e.showRowGroup||e.showRowGroup===this.columnModel.getRowGroupColumns()[0].getId()}}const r=this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotMode());return 0===i&&r}getHeaderName(e,t){return e?e({column:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}):this.columnModel.getDisplayNameForColumn(t,"csv",!0)}createValueForGroupNode(e){if(this.processRowGroupCallback)return this.processRowGroupCallback({node:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context});const t=e.footer,i=[e.key];if(!this.gridOptionsService.isGroupMultiAutoColumn())for(;e.parent;)e=e.parent,i.push(e.key);const n=i.reverse().join(" -> ");return t?"Total "+n:n}processCell(e){var t;const{accumulatedRowIndex:i,rowNode:n,column:r,value:s,processCellCallback:o,type:a}=e;return o?{value:null!==(t=o({accumulatedRowIndex:i,column:r,node:n,value:s,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,type:a,parseValue:e=>this.valueParserService.parseValue(r,n,e,this.valueService.getValue(r,n)),formatValue:e=>{var t;return null!==(t=this.valueFormatterService.formatValue(r,n,e))&&void 0!==t?t:e}}))&&void 0!==t?t:""}:r.getColDef().useValueFormatterForExport?{value:null!=s?s:"",valueFormatted:this.valueFormatterService.formatValue(r,n,s)}:{value:null!=s?s:""}}}var y=i(0);class s{static download(e,t){const i=document.defaultView||window;if(!i)return void console.warn("AG Grid: There is no `window` associated with the current `document`");const n=document.createElement("a"),r=i.URL.createObjectURL(t);n.setAttribute("href",r),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:i})),document.body.removeChild(n),i.setTimeout(()=>{i.URL.revokeObjectURL(r)},0)}}class h extends r{constructor(e){super(e),this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:i}=e;this.suppressQuotes=t,this.columnSeparator=i}addCustomContent(e){e&&("string"==typeof e?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,"\r\n"),this.result+=e):e.forEach(e=>{this.beginNewLine(),e.forEach((e,t)=>{0!==t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(e.data.value||""),e.mergeAcross&&this.appendEmptyCells(e.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,i,n){0!=i&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(n)}appendEmptyCells(t){for(let e=1;e<=t;e++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){0!=t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,i){var n;0!=t&&(this.result+=this.columnSeparator);const r=this.extractRowCellValue(e,t,t,"csv",i);this.result+=this.putInQuotes(null!==(n=r.valueFormatted)&&void 0!==n?n:r.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(null==e)return'""';let t;"string"==typeof e?t=e:"function"==typeof e.toString?t=e.toString():(console.warn("AG Grid: unknown value type during csv conversion"),t="");return'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+="\r\n"),this.isFirstLine=!1}}var o=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let a=class extends n{postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gridOptionsService:this.gridOptionsService})}getMergedParams(e){const t=this.gridOptionsService.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed())return console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration."),"";const t=this.getMergedParams(e),i=this.getData(t),n=new Blob(["\ufeff",i],{type:"text/plain"});return s.download(this.getFileName(t.fileName),n),i}exportDataAsCsv(e){return this.export(e)}getDataAsCsv(e,t=!1){const i=t?Object.assign({},e):this.getMergedParams(e);return this.getData(i)}getDefaultFileName(){return"export.csv"}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{columnModel:t,valueService:i,gridOptionsService:n,valueFormatterService:r,valueParserService:s}=this,{processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c,suppressQuotes:u,columnSeparator:d}=e;return new h({columnModel:t,valueService:i,gridOptionsService:n,valueFormatterService:r,valueParserService:s,processCellCallback:o||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:c||void 0,suppressQuotes:u||!1,columnSeparator:d||","})}isExportSuppressed(){return this.gridOptionsService.is("suppressCsvExport")}};o([Object(y.Autowired)("columnModel")],a.prototype,"columnModel",void 0),o([Object(y.Autowired)("valueService")],a.prototype,"valueService",void 0),o([Object(y.Autowired)("gridSerializer")],a.prototype,"gridSerializer",void 0),o([Object(y.Autowired)("gridOptionsService")],a.prototype,"gridOptionsService",void 0),o([Object(y.Autowired)("valueFormatterService")],a.prototype,"valueFormatterService",void 0),o([Object(y.Autowired)("valueParserService")],a.prototype,"valueParserService",void 0),o([y.PostConstruct],a.prototype,"postConstruct",null),a=o([Object(y.Bean)("csvCreator")],a);var l,c=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};!function(e){e[e.HEADER_GROUPING=0]="HEADER_GROUPING",e[e.HEADER=1]="HEADER",e[e.BODY=2]="BODY"}(l||(l={}));let u=class extends y.BeanStub{serialize(e,t={}){const i=this.getColumnsToExport(t.allColumns,t.columnKeys);return y._.compose(this.prepareSession(i),this.prependContent(t),this.exportColumnGroups(t,i),this.exportHeaders(t,i),this.processPinnedTopRows(t,i),this.processRows(t,i),this.processPinnedBottomRows(t,i),this.appendContent(t))(e).parse()}processRow(e,t,i,n){const r=t.shouldRowBeSkipped||(()=>!1),s=this.gridOptionsService.context,o=this.gridOptionsService.api,a=this.gridOptionsService.columnApi,l=this.gridOptionsService.is("groupRemoveSingleChildren"),c=this.gridOptionsService.is("groupRemoveLowestSingleChildren"),u=null!=t.rowPositions||!!t.onlySelected,d=this.gridOptionsService.is("groupHideOpenParents")&&!u,h=this.columnModel.isPivotMode()?n.leafGroup:!n.group,p=!!n.footer,f=t.skipGroups||t.skipRowGroups,g=c&&n.leafGroup,m=1===n.allChildrenCount&&(l||g);if(f&&t.skipGroups&&y._.doOnce(()=>console.warn("AG Grid: Since v25.2 `skipGroups` has been renamed to `skipRowGroups`."),"gridSerializer-skipGroups"),!h&&!p&&(t.skipRowGroups||m||d)||t.onlySelected&&!n.isSelected()||t.skipPinnedTop&&"top"===n.rowPinned||t.skipPinnedBottom&&"bottom"===n.rowPinned)return;if(-1===n.level&&!h&&!p)return;if(r({node:n,api:o,columnApi:a,context:s}))return;const v=e.onNewBodyRow(n);if(i.forEach((e,t)=>{v.onColumn(e,t,n)}),t.getCustomContentBelowRow){const i=t.getCustomContentBelowRow({node:n,api:o,columnApi:a,context:s});i&&e.addCustomContent(i)}}appendContent(i){return e=>{const t=i.customFooter||i.appendContent;return t&&(i.customFooter&&y._.doOnce(()=>console.warn("AG Grid: Since version 25.2.0 the `customFooter` param has been deprecated. Use `appendContent` instead."),"gridSerializer-customFooter"),e.addCustomContent(t)),e}}prependContent(i){return e=>{const t=i.customHeader||i.prependContent;return t&&(i.customHeader&&y._.doOnce(()=>console.warn("AG Grid: Since version 25.2.0 the `customHeader` param has been deprecated. Use `prependContent` instead."),"gridSerializer-customHeader"),e.addCustomContent(t)),e}}prepareSession(t){return e=>(e.prepare(t),e)}exportColumnGroups(n,r){return i=>{if(n.skipColumnGroupHeaders)n.columnGroups&&y._.doOnce(()=>console.warn("AG Grid: Since v25.2 the `columnGroups` param has deprecated, and groups are exported by default."),"gridSerializer-columnGroups");else{const e=new y.GroupInstanceIdCreator,t=this.displayedGroupCreator.createDisplayedGroups(r,this.columnModel.getGridBalancedTree(),e,null);this.recursivelyAddHeaderGroups(t,i,n.processGroupHeaderCallback)}return i}}exportHeaders(i,t){return e=>{if(i.skipHeader||i.skipColumnHeaders)i.skipHeader&&y._.doOnce(()=>console.warn("AG Grid: Since v25.2 the `skipHeader` param has been renamed to `skipColumnHeaders`."),"gridSerializer-skipHeader");else{const i=e.onNewHeaderRow();t.forEach((e,t)=>{i.onColumn(e,t,void 0)})}return e}}processPinnedTopRows(i,n){return e=>{const t=this.processRow.bind(this,e,i,n);return i.rowPositions?i.rowPositions.filter(e=>"top"===e.rowPinned).sort((e,t)=>e.rowIndex-t.rowIndex).map(e=>this.pinnedRowModel.getPinnedTopRow(e.rowIndex)).forEach(t):this.pinnedRowModel.forEachPinnedTopRow(t),e}}processRows(l,c){return e=>{const t=this.rowModel,i=t.getType(),n="clientSide"===i,r="serverSide"===i,s=!n&&l.onlySelected,o=this.processRow.bind(this,e,l,c),{exportedRows:a="filteredAndSorted"}=l;if(l.rowPositions)l.rowPositions.filter(e=>null==e.rowPinned).sort((e,t)=>e.rowIndex-t.rowIndex).map(e=>t.getRow(e.rowIndex)).forEach(o);else if(this.columnModel.isPivotMode())n?t.forEachPivotNode(o,!0):t.forEachNode(o);else if(l.onlySelectedAllPages||s){const l=this.selectionService.getSelectedNodes();this.replicateSortedOrder(l),l.forEach(o)}else"all"===a?t.forEachNode(o):n?t.forEachNodeAfterFilterAndSort(o,!0):r?t.forEachNodeAfterFilterAndSort(o):t.forEachNode(o);return e}}replicateSortedOrder(e){const o=this.sortController.getSortOptions(),a=(e,t)=>{var i,n,r,s;return null!=e.rowIndex&&null!=t.rowIndex?e.rowIndex-t.rowIndex:e.level===t.level?(null===(i=e.parent)||void 0===i?void 0:i.id)===(null===(n=t.parent)||void 0===n?void 0:n.id)?this.rowNodeSorter.compareRowNodes(o,{rowNode:e,currentPos:null!==(r=e.rowIndex)&&void 0!==r?r:-1},{rowNode:t,currentPos:null!==(s=t.rowIndex)&&void 0!==s?s:-1}):a(e.parent,t.parent):e.level>t.level?a(e.parent,t):a(e,t.parent)};e.sort(a)}processPinnedBottomRows(i,n){return e=>{const t=this.processRow.bind(this,e,i,n);return i.rowPositions?i.rowPositions.filter(e=>"bottom"===e.rowPinned).sort((e,t)=>e.rowIndex-t.rowIndex).map(e=>this.pinnedRowModel.getPinnedBottomRow(e.rowIndex)).forEach(t):this.pinnedRowModel.forEachPinnedBottomRow(t),e}}getColumnsToExport(e=!1,t){const i=this.columnModel.isPivotMode();if(t&&t.length)return this.columnModel.getGridColumns(t);if(e&&!i){return(this.gridOptionsService.isTreeData()?this.columnModel.getGridColumns([y.GROUP_AUTO_COLUMN_ID]):[]).concat(this.columnModel.getAllGridColumns()||[])}return this.columnModel.getAllDisplayedColumns()}recursivelyAddHeaderGroups(e,t,i){const n=[];e.forEach(e=>{const t=e;t.getChildren&&t.getChildren().forEach(e=>n.push(e))}),e.length>0&&e[0]instanceof y.ColumnGroup&&this.doAddHeaderHeader(t,e,i),n&&n.length>0&&this.recursivelyAddHeaderGroups(n,t,i)}doAddHeaderHeader(e,t,r){const s=e.onNewHeaderGroupingRow();let o=0;t.forEach(e=>{const t=e;let i;i=r?r({columnGroup:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}):this.columnModel.getDisplayNameForColumnGroup(t,"header");const n=t.getLeafColumns().reduce((e,t,i,n)=>{let r=y._.last(e);return"open"===t.getColumnGroupShow()?r&&null==r[1]||(r=[i],e.push(r)):r&&null==r[1]&&(r[1]=i-1),i===n.length-1&&r&&null==r[1]&&(r[1]=i),e},[]);s.onColumn(t,i||"",o++,t.getLeafColumns().length-1,n)})}};c([Object(y.Autowired)("displayedGroupCreator")],u.prototype,"displayedGroupCreator",void 0),c([Object(y.Autowired)("columnModel")],u.prototype,"columnModel",void 0),c([Object(y.Autowired)("rowModel")],u.prototype,"rowModel",void 0),c([Object(y.Autowired)("pinnedRowModel")],u.prototype,"pinnedRowModel",void 0),c([Object(y.Autowired)("selectionService")],u.prototype,"selectionService",void 0),c([Object(y.Autowired)("rowNodeSorter")],u.prototype,"rowNodeSorter",void 0),c([Object(y.Autowired)("sortController")],u.prototype,"sortController",void 0),u=c([Object(y.Bean)("gridSerializer")],u);const d={version:"30.0.6",moduleName:y.ModuleNames.CsvExportModule,beans:[a,u]};class p{static createHeader(t={}){const e=["version"];t.version||(t.version="1.0"),t.encoding&&e.push("encoding"),t.standalone&&e.push("standalone");return`<?xml ${e.map(e=>`${e}="${t[e]}"`).join(" ")} ?>`}static createXml(t,i){let n="";t.properties&&(t.properties.prefixedAttributes&&t.properties.prefixedAttributes.forEach(t=>{Object.keys(t.map).forEach(e=>{n+=this.returnAttributeIfPopulated(t.prefix+e,t.map[e],i)})}),t.properties.rawMap&&Object.keys(t.properties.rawMap).forEach(e=>{n+=this.returnAttributeIfPopulated(e,t.properties.rawMap[e],i)}));let r="<"+t.name+n;return t.children||null!=t.textNode?null!=t.textNode?r+">"+t.textNode+"</"+t.name+">\r\n":(r+=">\r\n",t.children&&t.children.forEach(e=>{r+=this.createXml(e,i)}),r+"</"+t.name+">\r\n"):r+"/>\r\n"}static returnAttributeIfPopulated(e,t,i){if(!t&&""!==t&&0!==t)return"";let n=t;return"boolean"==typeof t&&i&&(n=i(t)),` ${e}="${n}"`}}const f=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);class g{static addFolders(e){e.forEach(this.addFolder.bind(this))}static addFolder(e){this.folders.push({path:e,created:new Date,isBase64:!1})}static addFile(e,t,i=!1){this.files.push({path:e,created:new Date,content:t,isBase64:i})}static getContent(e="application/zip"){const t=this.buildFileStream(),i=this.buildUint8Array(t);return this.clearStream(),new Blob([i],{type:e})}static clearStream(){this.folders=[],this.files=[]}static buildFileStream(i=""){const n=this.folders.concat(this.files),r=n.length;let s="",o=0,a=0;for(const r of n){const{fileHeader:n,folderHeader:e,content:t}=this.getHeader(r,o);o+=n.length+t.length,a+=e.length,i+=n+t,s+=e}return i+s+this.buildFolderEnd(r,a,o)}static getHeader(e,t){const{content:i,path:n,created:r,isBase64:s}=e,{utf8_encode:o,decToHex:a}=y._,l=o(n),c=l!==n,u=this.convertTime(r),d=this.convertDate(r);let h="";if(c){const e=a(1,1)+a(this.getFromCrc32Table(l),4)+l;h="up"+a(e.length,2)+e}const{size:p,content:f}=i?this.getConvertedContent(i,s):{size:0,content:""},g="\n\0"+(c?"\0\b":"\0\0")+"\0\0"+a(u,2)+a(d,2)+a(p?this.getFromCrc32Table(f):0,4)+a(p,4)+a(p,4)+a(l.length,2)+a(h.length,2);return{fileHeader:"PK"+g+l+h,folderHeader:"PK\0"+g+"\0\0\0\0\0\0"+(i?"\0\0\0\0":"\0\0\0")+a(t,4)+l+h,content:f||""}}static getConvertedContent(e,t=!1){return t&&(e=e.split(";base64,")[1]),{size:(e=t?atob(e):e).length,content:e}}static buildFolderEnd(e,t,i){const{decToHex:n}=y._;return"PK\0\0\0\0"+n(e,2)+n(e,2)+n(t,4)+n(i,4)+"\0\0"}static buildUint8Array(t){const i=new Uint8Array(t.length);for(let e=0;e<i.length;e++)i[e]=t.charCodeAt(e);return i}static getFromCrc32Table(t){if(!t.length)return 0;const i=t.length,n=new Uint8Array(i);for(let e=0;e<i;e++)n[e]=t.charCodeAt(e);let r=-1,s=0,o=0,a=0;for(let e=0;e<i;e++)s=n[e],o=255&(r^s),a=f[o],r=r>>>8^a;return-1^r}static convertTime(e){let t=e.getHours();return t<<=6,t|=e.getMinutes(),t<<=5,t|=e.getSeconds()/2,t}static convertDate(e){let t=e.getFullYear()-1980;return t<<=4,t|=e.getMonth()+1,t<<=5,t|=e.getDate(),t}}g.folders=[],g.files=[]},function(e,t,i){"use strict";i.r(t),i.d(t,"InfiniteRowModelModule",function(){return d});var l=i(0),n=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class s extends l.RowNodeBlock{constructor(e,t,i){super(e),this.parentCache=t,this.params=i,this.startRow=e*i.blockSize,this.endRow=this.startRow+i.blockSize}postConstruct(){this.createRowNodes()}getBlockStateJson(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}}setDataAndId(e,t,i){l._.exists(t)?e.setDataAndId(t,i.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){const e=this.createLoadParams();l._.missing(this.params.datasource.getRows)?console.warn("AG Grid: datasource is missing getRows method"):window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}processServerFail(){}createLoadParams(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gridOptionsService.context}}forEachNode(i,n,r){this.rowNodes.forEach((e,t)=>{this.startRow+t<r&&i(e,n.next())})}getLastAccessed(){return this.lastAccessed}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.next());const i=e-this.startRow;return this.rowNodes[i]}getStartRow(){return this.startRow}getEndRow(){return this.endRow}createRowNodes(){this.rowNodes=[];for(let i=0;i<this.params.blockSize;i++){const e=this.startRow+i,t=new l.RowNode(this.beans);t.setRowHeight(this.params.rowHeight),t.uiLevel=0,t.setRowIndex(e),t.setRowTop(this.params.rowHeight*e),this.rowNodes.push(t)}}processServerResult(n){this.rowNodes.forEach((e,t)=>{const i=n.rowData?n.rowData[t]:void 0;!e.id&&e.alreadyRendered&&i&&(this.rowNodes[t]=new l.RowNode(this.beans),this.rowNodes[t].setRowIndex(e.rowIndex),this.rowNodes[t].setRowTop(e.rowTop),e.clearRowTopAndRowIndex()),this.setDataAndId(this.rowNodes[t],i,this.startRow+t)});const e=null!=n.rowCount&&n.rowCount>=0?n.rowCount:void 0;this.parentCache.pageLoaded(this,e)}destroyRowNodes(){this.rowNodes.forEach(e=>{e.clearRowTopAndRowIndex()})}}n([Object(l.Autowired)("beans")],s.prototype,"beans",void 0),n([l.PostConstruct],s.prototype,"postConstruct",null),n([l.PreDestroy],s.prototype,"destroyRowNodes",null);var r=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=function(i,n){return function(e,t){n(e,t,i)}};class a extends l.BeanStub{constructor(e){super(),this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount,this.params=e}setBeans(e){this.logger=e.create("InfiniteCache")}getRow(e,t=!1){const i=Math.floor(e/this.params.blockSize);let n=this.blocks[i];if(!n){if(t)return;n=this.createBlock(i)}return n.getRow(e)}createBlock(e){const t=this.createBean(new s(e,this,this.params));return this.blocks[t.getId()]=t,this.blockCount++,this.purgeBlocksIfNeeded(t),this.params.rowNodeBlockLoader.addBlock(t),t}refreshCache(){0==this.blockCount?this.purgeCache():(this.getBlocksInOrder().forEach(e=>e.setStateWaitingToLoad()),this.params.rowNodeBlockLoader.checkBlockToLoad())}destroyAllBlocks(){this.getBlocksInOrder().forEach(e=>this.destroyBlock(e))}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(this.logger.log(`onPageLoaded: page = ${e.getId()}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(t){const e=this.getBlocksInOrder().filter(e=>e!=t);e.sort((e,t)=>t.getLastAccessed()-e.getLastAccessed());const i=this.params.maxBlocksInCache>0,n=i?this.params.maxBlocksInCache-1:null,r=a.MAX_EMPTY_BLOCKS_TO_KEEP-1;e.forEach((e,t)=>{if(e.getState()===s.STATE_WAITING_TO_LOAD&&t>=r||!!i&&t>=n){if(this.isBlockCurrentlyDisplayed(e))return;if(this.isBlockFocused(e))return;this.removeBlockFromCache(e)}})}isBlockFocused(e){const t=this.focusService.getFocusCellToUseAfterRefresh();if(!t)return!1;if(null!=t.rowPinned)return!1;const i=e.getStartRow(),n=e.getEndRow();return t.rowIndex>=i&&t.rowIndex<n}isBlockCurrentlyDisplayed(e){const t=e.getStartRow(),i=e.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(t,i)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if("number"==typeof t&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const t=(e.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<t&&(this.rowCount=t)}}setRowCount(e,t){this.rowCount=e,l._.exists(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize==0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(t){const i=new l.NumberSequence;this.getBlocksInOrder().forEach(e=>e.forEachNode(t,i,this.rowCount))}getBlocksInOrder(){return l._.getAllValuesInObject(this.blocks).sort((e,t)=>e.getId()-t.getId())}destroyBlock(e){delete this.blocks[e.getId()],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){if(this.isAlive()){this.destroyAllBlocksPastVirtualRowCount();const e={type:l.Events.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(e)}}destroyAllBlocksPastVirtualRowCount(){const t=[];this.getBlocksInOrder().forEach(e=>{e.getId()*this.params.blockSize>=this.rowCount&&t.push(e)}),t.length>0&&t.forEach(e=>this.destroyBlock(e))}purgeCache(){this.getBlocksInOrder().forEach(e=>this.removeBlockFromCache(e)),this.lastRowIndexKnown=!1,0===this.rowCount&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(i,n){const r=[];let t=-1,s=!1;const o=new l.NumberSequence;l._.missing(i)&&(s=!0);let a=!1;this.getBlocksInOrder().forEach(e=>{a||(s&&t+1!==e.getId()?a=!0:(t=e.getId(),e.forEachNode(e=>{const t=e===i||e===n;(s||t)&&r.push(e),t&&(s=!s)},o,this.rowCount)))});return a||s?[]:r}}a.MAX_EMPTY_BLOCKS_TO_KEEP=2,r([Object(l.Autowired)("rowRenderer")],a.prototype,"rowRenderer",void 0),r([Object(l.Autowired)("focusService")],a.prototype,"focusService",void 0),r([o(0,Object(l.Qualifier)("loggerFactory"))],a.prototype,"setBeans",null),r([l.PreDestroy],a.prototype,"destroyAllBlocks",null);var c=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let u=class extends l.BeanStub{getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(e,t,i,n){return!1}init(){this.gridOptionsService.isRowModelType("infinite")&&(this.rowHeight=this.gridOptionsService.getRowHeightAsNumber(),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache()),this.verifyProps())}verifyProps(){if(this.gridOptionsService.exists("initialGroupOrderComparator")){const e="AG Grid: initialGroupOrderComparator cannot be used with Infinite Row Model. If using Infinite Row Model, then sorting is done on the server side, nothing to do with the client.";l._.doOnce(()=>console.warn(e),"IRM.InitialGroupOrderComparator")}}start(){this.setDatasource(this.gridOptionsService.get("datasource"))}destroyDatasource(){this.datasource&&(this.getContext().destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedListener(this.eventService,l.Events.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,l.Events.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,l.Events.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,l.Events.EVENT_STORE_UPDATED,this.onCacheUpdated.bind(this))}onFilterChanged(){this.reset()}onSortChanged(){this.reset()}onColumnEverything(){let e;e=!this.cacheParams||this.isSortModelDifferent(),e&&this.reset()}isSortModelDifferent(){return!l._.jsonEquals(this.cacheParams.sortModel,this.sortController.getSortModel())}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(e,t):[]}reset(){if(!this.datasource)return;null!=this.gridOptionsService.getCallback("getRowId")||this.selectionService.reset(),this.resetCache();const e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}createModelUpdatedEvent(){return{type:l.Events.EVENT_MODEL_UPDATED,newPage:!1,newData:!1,keepRenderedRows:!0,animate:!1}}resetCache(){this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.defaultIfInvalid(this.gridOptionsService.getNum("infiniteInitialRowCount"),1),maxBlocksInCache:this.gridOptionsService.getNum("maxBlocksInCache"),rowHeight:this.gridOptionsService.getRowHeightAsNumber(),overflowSize:this.defaultIfInvalid(this.gridOptionsService.getNum("cacheOverflowSize"),1),blockSize:this.defaultIfInvalid(this.gridOptionsService.getNum("cacheBlockSize"),100),lastAccessedSequence:new l.NumberSequence},this.infiniteCache=this.createBean(new a(this.cacheParams))}defaultIfInvalid(e,t){return e>0?e:t}destroyCache(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))}onCacheUpdated(){const e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}getRow(e){if(this.infiniteCache&&!(e>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(e)}getRowNode(t){let i;return this.forEachNode(e=>{e.id===t&&(i=e)}),i}forEachNode(e){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(i){if(0!==this.rowHeight){const e=Math.floor(i/this.rowHeight),t=this.getRowCount()-1;return e>t?t:e}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache&&this.infiniteCache.refreshCache()}purgeCache(){this.infiniteCache&&this.infiniteCache.purgeCache()}isLastRowIndexKnown(){return!!this.infiniteCache&&this.infiniteCache.isLastRowIndexKnown()}setRowCount(e,t){this.infiniteCache&&this.infiniteCache.setRowCount(e,t)}};c([Object(l.Autowired)("filterManager")],u.prototype,"filterManager",void 0),c([Object(l.Autowired)("sortController")],u.prototype,"sortController",void 0),c([Object(l.Autowired)("selectionService")],u.prototype,"selectionService",void 0),c([Object(l.Autowired)("rowRenderer")],u.prototype,"rowRenderer",void 0),c([Object(l.Autowired)("rowNodeBlockLoader")],u.prototype,"rowNodeBlockLoader",void 0),c([l.PostConstruct],u.prototype,"init",null),c([l.PreDestroy],u.prototype,"destroyDatasource",null),u=c([Object(l.Bean)("rowModel")],u);const d={version:"30.0.6",moduleName:l.ModuleNames.InfiniteRowModelModule,rowModel:"infinite",beans:[u]}},function(e,t,i){var n=i(1),r=(i(0),i(2)),s=i(3),o=i(5);Object.keys(o).forEach(function(e){t[e]=o[e]}),o.ModuleRegistry.register(n.ClientSideRowModelModule),o.ModuleRegistry.register(r.CsvExportModule),o.ModuleRegistry.register(s.InfiniteRowModelModule),o.ModuleRegistry.__setIsBundled()},function(e,t,i){"use strict";i.r(t),i.d(t,"AllCommunityModules",function(){return a});var n=i(1),r=i(3),s=i(2);i.d(t,"ClientSideRowModelModule",function(){return n.ClientSideRowModelModule}),i.d(t,"BaseCreator",function(){return s.BaseCreator}),i.d(t,"BaseGridSerializingSession",function(){return s.BaseGridSerializingSession}),i.d(t,"CsvCreator",function(){return s.CsvCreator}),i.d(t,"CsvExportModule",function(){return s.CsvExportModule}),i.d(t,"Downloader",function(){return s.Downloader}),i.d(t,"GridSerializer",function(){return s.GridSerializer}),i.d(t,"RowType",function(){return s.RowType}),i.d(t,"XmlFactory",function(){return s.XmlFactory}),i.d(t,"ZipContainer",function(){return s.ZipContainer}),i.d(t,"InfiniteRowModelModule",function(){return r.InfiniteRowModelModule});var o=i(0);i.d(t,"ColumnFactory",function(){return o.ColumnFactory}),i.d(t,"ColumnModel",function(){return o.ColumnModel}),i.d(t,"ColumnKeyCreator",function(){return o.ColumnKeyCreator}),i.d(t,"ColumnUtils",function(){return o.ColumnUtils}),i.d(t,"DisplayedGroupCreator",function(){return o.DisplayedGroupCreator}),i.d(t,"GroupInstanceIdCreator",function(){return o.GroupInstanceIdCreator}),i.d(t,"GROUP_AUTO_COLUMN_ID",function(){return o.GROUP_AUTO_COLUMN_ID}),i.d(t,"ComponentUtil",function(){return o.ComponentUtil}),i.d(t,"AgStackComponentsRegistry",function(){return o.AgStackComponentsRegistry}),i.d(t,"UserComponentRegistry",function(){return o.UserComponentRegistry}),i.d(t,"UserComponentFactory",function(){return o.UserComponentFactory}),i.d(t,"ColDefUtil",function(){return o.ColDefUtil}),i.d(t,"BeanStub",function(){return o.BeanStub}),i.d(t,"Context",function(){return o.Context}),i.d(t,"Autowired",function(){return o.Autowired}),i.d(t,"PostConstruct",function(){return o.PostConstruct}),i.d(t,"PreConstruct",function(){return o.PreConstruct}),i.d(t,"Optional",function(){return o.Optional}),i.d(t,"Bean",function(){return o.Bean}),i.d(t,"Qualifier",function(){return o.Qualifier}),i.d(t,"PreDestroy",function(){return o.PreDestroy}),i.d(t,"QuerySelector",function(){return o.QuerySelector}),i.d(t,"RefSelector",function(){return o.RefSelector}),i.d(t,"ExcelFactoryMode",function(){return o.ExcelFactoryMode}),i.d(t,"DragAndDropService",function(){return o.DragAndDropService}),i.d(t,"DragSourceType",function(){return o.DragSourceType}),i.d(t,"HorizontalDirection",function(){return o.HorizontalDirection}),i.d(t,"VerticalDirection",function(){return o.VerticalDirection}),i.d(t,"DragService",function(){return o.DragService}),i.d(t,"Column",function(){return o.Column}),i.d(t,"ColumnGroup",function(){return o.ColumnGroup}),i.d(t,"ProvidedColumnGroup",function(){return o.ProvidedColumnGroup}),i.d(t,"RowNode",function(){return o.RowNode}),i.d(t,"RowHighlightPosition",function(){return o.RowHighlightPosition}),i.d(t,"FilterManager",function(){return o.FilterManager}),i.d(t,"ProvidedFilter",function(){return o.ProvidedFilter}),i.d(t,"SimpleFilter",function(){return o.SimpleFilter}),i.d(t,"ScalarFilter",function(){return o.ScalarFilter}),i.d(t,"NumberFilter",function(){return o.NumberFilter}),i.d(t,"TextFilter",function(){return o.TextFilter}),i.d(t,"DateFilter",function(){return o.DateFilter}),i.d(t,"TextFloatingFilter",function(){return o.TextFloatingFilter}),i.d(t,"HeaderFilterCellComp",function(){return o.HeaderFilterCellComp}),i.d(t,"FloatingFilterMapper",function(){return o.FloatingFilterMapper}),i.d(t,"GridBodyComp",function(){return o.GridBodyComp}),i.d(t,"GridBodyCtrl",function(){return o.GridBodyCtrl}),i.d(t,"RowAnimationCssClasses",function(){return o.RowAnimationCssClasses}),i.d(t,"ScrollVisibleService",function(){return o.ScrollVisibleService}),i.d(t,"MouseEventService",function(){return o.MouseEventService}),i.d(t,"NavigationService",function(){return o.NavigationService}),i.d(t,"RowContainerComp",function(){return o.RowContainerComp}),i.d(t,"RowContainerName",function(){return o.RowContainerName}),i.d(t,"RowContainerCtrl",function(){return o.RowContainerCtrl}),i.d(t,"RowContainerType",function(){return o.RowContainerType}),i.d(t,"getRowContainerTypeForName",function(){return o.getRowContainerTypeForName}),i.d(t,"BodyDropPivotTarget",function(){return o.BodyDropPivotTarget}),i.d(t,"BodyDropTarget",function(){return o.BodyDropTarget}),i.d(t,"CssClassApplier",function(){return o.CssClassApplier}),i.d(t,"HeaderRowContainerComp",function(){return o.HeaderRowContainerComp}),i.d(t,"GridHeaderComp",function(){return o.GridHeaderComp}),i.d(t,"GridHeaderCtrl",function(){return o.GridHeaderCtrl}),i.d(t,"HeaderRowComp",function(){return o.HeaderRowComp}),i.d(t,"HeaderRowType",function(){return o.HeaderRowType}),i.d(t,"HeaderRowCtrl",function(){return o.HeaderRowCtrl}),i.d(t,"HeaderCellCtrl",function(){return o.HeaderCellCtrl}),i.d(t,"SortIndicatorComp",function(){return o.SortIndicatorComp}),i.d(t,"HeaderFilterCellCtrl",function(){return o.HeaderFilterCellCtrl}),i.d(t,"HeaderGroupCellCtrl",function(){return o.HeaderGroupCellCtrl}),i.d(t,"AbstractHeaderCellCtrl",function(){return o.AbstractHeaderCellCtrl}),i.d(t,"HeaderRowContainerCtrl",function(){return o.HeaderRowContainerCtrl}),i.d(t,"HorizontalResizeService",function(){return o.HorizontalResizeService}),i.d(t,"MoveColumnFeature",function(){return o.MoveColumnFeature}),i.d(t,"StandardMenuFactory",function(){return o.StandardMenuFactory}),i.d(t,"TabbedLayout",function(){return o.TabbedLayout}),i.d(t,"simpleHttpRequest",function(){return o.simpleHttpRequest}),i.d(t,"ResizeObserverService",function(){return o.ResizeObserverService}),i.d(t,"AnimationFrameService",function(){return o.AnimationFrameService}),i.d(t,"LargeTextCellEditor",function(){return o.LargeTextCellEditor}),i.d(t,"PopupEditorWrapper",function(){return o.PopupEditorWrapper}),i.d(t,"SelectCellEditor",function(){return o.SelectCellEditor}),i.d(t,"TextCellEditor",function(){return o.TextCellEditor}),i.d(t,"NumberCellEditor",function(){return o.NumberCellEditor}),i.d(t,"DateCellEditor",function(){return o.DateCellEditor}),i.d(t,"DateStringCellEditor",function(){return o.DateStringCellEditor}),i.d(t,"CheckboxCellEditor",function(){return o.CheckboxCellEditor}),i.d(t,"Beans",function(){return o.Beans}),i.d(t,"AnimateShowChangeCellRenderer",function(){return o.AnimateShowChangeCellRenderer}),i.d(t,"AnimateSlideCellRenderer",function(){return o.AnimateSlideCellRenderer}),i.d(t,"GroupCellRenderer",function(){return o.GroupCellRenderer}),i.d(t,"GroupCellRendererCtrl",function(){return o.GroupCellRendererCtrl}),i.d(t,"SetLeftFeature",function(){return o.SetLeftFeature}),i.d(t,"PositionableFeature",function(){return o.PositionableFeature}),i.d(t,"AutoWidthCalculator",function(){return o.AutoWidthCalculator}),i.d(t,"CheckboxSelectionComponent",function(){return o.CheckboxSelectionComponent}),i.d(t,"CellComp",function(){return o.CellComp}),i.d(t,"CellCtrl",function(){return o.CellCtrl}),i.d(t,"RowCtrl",function(){return o.RowCtrl}),i.d(t,"RowRenderer",function(){return o.RowRenderer}),i.d(t,"ValueFormatterService",function(){return o.ValueFormatterService}),i.d(t,"CssClassManager",function(){return o.CssClassManager}),i.d(t,"CheckboxCellRenderer",function(){return o.CheckboxCellRenderer}),i.d(t,"PinnedRowModel",function(){return o.PinnedRowModel}),i.d(t,"ServerSideTransactionResultStatus",function(){return o.ServerSideTransactionResultStatus}),i.d(t,"ChangedPath",function(){return o.ChangedPath}),i.d(t,"RowNodeBlock",function(){return o.RowNodeBlock}),i.d(t,"RowNodeBlockLoader",function(){return o.RowNodeBlockLoader}),i.d(t,"PaginationProxy",function(){return o.PaginationProxy}),i.d(t,"ClientSideRowModelSteps",function(){return o.ClientSideRowModelSteps}),i.d(t,"StylingService",function(){return o.StylingService}),i.d(t,"LayoutCssClasses",function(){return o.LayoutCssClasses}),i.d(t,"AgAbstractField",function(){return o.AgAbstractField}),i.d(t,"AgCheckbox",function(){return o.AgCheckbox}),i.d(t,"AgRadioButton",function(){return o.AgRadioButton}),i.d(t,"AgToggleButton",function(){return o.AgToggleButton}),i.d(t,"AgInputTextField",function(){return o.AgInputTextField}),i.d(t,"AgInputTextArea",function(){return o.AgInputTextArea}),i.d(t,"AgInputNumberField",function(){return o.AgInputNumberField}),i.d(t,"AgInputDateField",function(){return o.AgInputDateField}),i.d(t,"AgInputRange",function(){return o.AgInputRange}),i.d(t,"AgSelect",function(){return o.AgSelect}),i.d(t,"AgSlider",function(){return o.AgSlider}),i.d(t,"AgGroupComponent",function(){return o.AgGroupComponent}),i.d(t,"AgMenuItemComponent",function(){return o.AgMenuItemComponent}),i.d(t,"AgMenuList",function(){return o.AgMenuList}),i.d(t,"AgMenuPanel",function(){return o.AgMenuPanel}),i.d(t,"AgDialog",function(){return o.AgDialog}),i.d(t,"AgPanel",function(){return o.AgPanel}),i.d(t,"Component",function(){return o.Component}),i.d(t,"ManagedFocusFeature",function(){return o.ManagedFocusFeature}),i.d(t,"TabGuardComp",function(){return o.TabGuardComp}),i.d(t,"TabGuardCtrl",function(){return o.TabGuardCtrl}),i.d(t,"TabGuardClassNames",function(){return o.TabGuardClassNames}),i.d(t,"PopupComponent",function(){return o.PopupComponent}),i.d(t,"PopupService",function(){return o.PopupService}),i.d(t,"TouchListener",function(){return o.TouchListener}),i.d(t,"VirtualList",function(){return o.VirtualList}),i.d(t,"AgAbstractLabel",function(){return o.AgAbstractLabel}),i.d(t,"AgPickerField",function(){return o.AgPickerField}),i.d(t,"CellRangeType",function(){return o.CellRangeType}),i.d(t,"SelectionHandleType",function(){return o.SelectionHandleType}),i.d(t,"AutoScrollService",function(){return o.AutoScrollService}),i.d(t,"VanillaFrameworkOverrides",function(){return o.VanillaFrameworkOverrides}),i.d(t,"CellNavigationService",function(){return o.CellNavigationService}),i.d(t,"AlignedGridsService",function(){return o.AlignedGridsService}),i.d(t,"KeyCode",function(){return o.KeyCode}),i.d(t,"Grid",function(){return o.Grid}),i.d(t,"GridCoreCreator",function(){return o.GridCoreCreator}),i.d(t,"GridApi",function(){return o.GridApi}),i.d(t,"Events",function(){return o.Events}),i.d(t,"FocusService",function(){return o.FocusService}),i.d(t,"GridOptionsService",function(){return o.GridOptionsService}),i.d(t,"EventService",function(){return o.EventService}),i.d(t,"SelectableService",function(){return o.SelectableService}),i.d(t,"RowNodeSorter",function(){return o.RowNodeSorter}),i.d(t,"CtrlsService",function(){return o.CtrlsService}),i.d(t,"GridComp",function(){return o.GridComp}),i.d(t,"GridCtrl",function(){return o.GridCtrl}),i.d(t,"Logger",function(){return o.Logger}),i.d(t,"LoggerFactory",function(){return o.LoggerFactory}),i.d(t,"SortController",function(){return o.SortController}),i.d(t,"TemplateService",function(){return o.TemplateService}),i.d(t,"LocaleService",function(){return o.LocaleService}),i.d(t,"_",function(){return o._}),i.d(t,"NumberSequence",function(){return o.NumberSequence}),i.d(t,"AgPromiseStatus",function(){return o.AgPromiseStatus}),i.d(t,"AgPromise",function(){return o.AgPromise}),i.d(t,"Timer",function(){return o.Timer}),i.d(t,"ValueService",function(){return o.ValueService}),i.d(t,"ValueCache",function(){return o.ValueCache}),i.d(t,"ExpressionService",function(){return o.ExpressionService}),i.d(t,"ValueParserService",function(){return o.ValueParserService}),i.d(t,"CellPositionUtils",function(){return o.CellPositionUtils}),i.d(t,"RowPositionUtils",function(){return o.RowPositionUtils}),i.d(t,"HeaderPositionUtils",function(){return o.HeaderPositionUtils}),i.d(t,"HeaderNavigationService",function(){return o.HeaderNavigationService}),i.d(t,"HeaderNavigationDirection",function(){return o.HeaderNavigationDirection}),i.d(t,"PropertyKeys",function(){return o.PropertyKeys}),i.d(t,"ColumnApi",function(){return o.ColumnApi}),i.d(t,"BaseComponentWrapper",function(){return o.BaseComponentWrapper}),i.d(t,"Environment",function(){return o.Environment}),i.d(t,"CustomTooltipFeature",function(){return o.CustomTooltipFeature}),i.d(t,"DEFAULT_CHART_GROUPS",function(){return o.DEFAULT_CHART_GROUPS}),i.d(t,"CHART_TOOL_PANEL_ALLOW_LIST",function(){return o.CHART_TOOL_PANEL_ALLOW_LIST}),i.d(t,"CHART_TOOLBAR_ALLOW_LIST",function(){return o.CHART_TOOLBAR_ALLOW_LIST}),i.d(t,"CHART_TOOL_PANEL_MENU_OPTIONS",function(){return o.CHART_TOOL_PANEL_MENU_OPTIONS}),i.d(t,"__FORCE_MODULE_DETECTION",function(){return o.__FORCE_MODULE_DETECTION}),i.d(t,"BarColumnLabelPlacement",function(){return o.BarColumnLabelPlacement}),i.d(t,"ModuleNames",function(){return o.ModuleNames}),i.d(t,"ModuleRegistry",function(){return o.ModuleRegistry});const a=[n.ClientSideRowModelModule,r.InfiniteRowModelModule,s.CsvExportModule]}])});(function(){var t=function(e){var n={};_.each(e,function(e,i){if(_.isPlainObject(e)){_.each(t(e),function(e,t){n[i+"."+t]=e})}else{n[i]=e}});return n};$.i18n.load(t(window.I18n));window.t=function(){return $.i18n._.apply($.i18n,Array.prototype.slice.call(arguments))}})();AGN=window.AGN||(window.AGN={});AGN.Lib=window.AGN.Lib||(window.AGN.Lib={});AGN.Lib.WM=window.AGN.Lib.WM||(window.AGN.Lib.WM={});AGN.Lib.Dashboard=window.AGN.Lib.Dashboard||(window.AGN.Lib.Dashboard={});AGN.Lib.LB=window.AGN.Lib.LB||(window.AGN.Lib.LB={});AGN.Opt=window.AGN.Opt||(window.AGN.Opt={});AGN.Opt.Fields=window.AGN.Opt.Fields||(window.AGN.Opt.Fields={});AGN.Opt.Forms=window.AGN.Opt.Forms||(window.AGN.Opt.Forms={});AGN.Opt.Controllers=window.AGN.Opt.Controllers||(window.AGN.Opt.Controllers={});AGN.Opt.Templates=window.AGN.Opt.Templates||(window.AGN.Opt.Templates={});AGN.Opt.TableCellRenderers=window.AGN.Opt.TableCellRenderers||(window.AGN.Opt.TableCellRenderers={});AGN.Opt.TableActionsConditions=window.AGN.Opt.TableActionsConditions||(window.AGN.Opt.TableActionsConditions={});AGN.Opt.Table=window.AGN.Opt.Table||(window.AGN.Opt.Table={filters:{},comparators:{}});AGN.Opt.TableHeaderComponents=window.AGN.Opt.TableHeaderComponents||(window.AGN.Opt.TableHeaderComponents={});AGN.Opt.Charts=window.AGN.Opt.Charts||(window.AGN.Opt.Charts={});AGN.Opt.Validators=window.AGN.Opt.Validators||(window.AGN.Opt.Validators={});AGN.Opt.Components=window.AGN.Opt.Components||(window.AGN.Opt.Components={});AGN.url=function(e,t){if(window.agnResolveRelativeUrl){if(e&&e.charAt(0)==="/"){e=e.substring(1)}return window.agnResolveRelativeUrl(e,t)}else{console.error("window.agnResolveRelativeUrl is not defined");return e}};AGN.runAll=function(e){AGN.Lib.CoreInitializer.autorun(e);AGN.Lib.DomInitializer.autorun(e)};(function(c){const e=c("html");let t;Chart.register(ChartZoom);Chart.register(ChartDataLabels);Chart.defaults.color=()=>{if(!t){t=c("body").css("--chart-label-color")}return t};Chart.defaults.maintainAspectRatio=false;Chart.defaults.font.size=e.css("--chart-font-size");Chart.defaults.font.family=e.css("--chart-font-family");Chart.defaults.scale.border.display=false;Chart.defaults.scale.grid.display=false;Chart.controllers.bar.defaults.barPercentage=1;Chart.defaults.plugins.legend.labels.usePointStyle=true;Chart.defaults.plugins.legend.labels.pointStyle="rectRounded";Chart.defaults.plugins.legend.position="right";Chart.defaults.plugins.tooltip.enabled=false;Chart.defaults.plugins.tooltip.external=e=>{const{chart:t,tooltip:o}=e;const i=d(t);if(o.opacity===0){i.css("opacity",0);return}if(o.body){const r=o.title||[];const s=o.body.map(e=>e.lines);const a=c('<div class="tooltip-header">');a.append(c(`<span>${r[0]}</span>`));const l=c('<div class="tooltip-body">');s.forEach((e,t)=>{const i=o.labelColors[t];const n=c("<div>");const r=c('<i class="icon icon-square">').css("color",i.backgroundColor);const s=c('<span class="text-truncate">').text(e);n.append(r);n.append(s);l.append(n)});c(i).empty();c(i).append(a);c(i).append(l)}const n=u(i,t);i.css({opacity:1,left:n.left+"px",top:n.top+"px"})};function u(e,t){const{chartArea:i,tooltip:n}=t;const r=i.right-i.left;const s=i.bottom-i.top;const{offsetLeft:o,offsetTop:a}=t.canvas;const l=o+r;const c=a+s;let u=o+n.caretX;let d=a+n.caretY;if(u+e.outerWidth()>l){u=l-e.outerWidth()}if(d+e.outerHeight()>c){d=c-e.outerHeight()}return{left:Math.max(o,u),top:Math.max(a,d)}}function d(e){let t=c(e.canvas).parent().find(".chart-tooltip");if(!t.exists()){t=c('<div class="chart-tooltip">');c(e.canvas).parent().append(t)}return t}class i extends Chart.DoughnutController{initialize(){this._actualRealValues=this.chart.data.datasets[0].data;this._exactPercentages=AGN.Lib.ChartUtils.calcExactPercentages(this._actualRealValues);this.chart.data.datasets[0].data=a(this._actualRealValues);super.initialize()}}i.id="agnDoughnut";i.defaults=Chart.DoughnutController.defaults;i.overrides=_.merge(_.cloneDeep(Chart.DoughnutController.overrides),{plugins:{legend:{onClick:function(e,i,t){const n=o(t.chart);const r=t.legendItems.map((e,t)=>{if(i.index===t){return e.hidden?n._actualRealValues[t]:0}return e.hidden?0:n._actualRealValues[t]});n._exactPercentages=AGN.Lib.ChartUtils.calcExactPercentages(r);t.chart.data.datasets[0].data=a(r);const s=Chart.DoughnutController.overrides.plugins.legend.onClick;s(e,i,t)}},datalabels:{color:e=>{const t=e.dataset.backgroundColor[e.dataIndex];return AGN.Lib.Helpers.getColorLuminance(t)<.57?"white":"#4B4B4B"},formatter:(e,t)=>{const i=o(t.chart)._exactPercentages;const n=i[t.dataIndex];return n>=10&&t.chart.width>200?`${n.toFixed(1)}%`:""}},tooltip:{callbacks:{label:e=>o(e.chart)._actualRealValues[e.dataIndex]}}}});function o(e){return e.getDatasetMeta(0).controller}function a(e){const t=AGN.Lib.ChartUtils.getTotal(e);return e.map(e=>{if(e<=0){return 0}return Math.max(e/t*100,1)})}Chart.register(i)})(window.jQuery);(function(){var i=$.ui.dialog.prototype._allowInteraction;$.ui.dialog.prototype._allowInteraction=function(e){var t=$(e.target);if(t.closest(".cke_dialog").length||t.closest(".cke_panel_frame").length){return true}return i.apply(this,arguments)}})();if(Function.prototype.bind&&window.console&&typeof console.log=="object"){["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(e){console[e]=this.bind(console[e],console)},Function.prototype.call)}(function(e,t){if(typeof exports=="object"){module.exports=t(e)}else if(typeof define=="function"&&define.amd){define([],t.bind(e,e))}else{t(e)}})(typeof global!="undefined"?global:this,function(e){if(e.CSS&&e.CSS.escape){return e.CSS.escape}var t=function(e){if(arguments.length==0){throw new TypeError("`CSS.escape` requires an argument.")}var t=String(e);var i=t.length;var n=-1;var r;var s="";var o=t.charCodeAt(0);while(++n<i){r=t.charCodeAt(n);if(r==0){s+="";continue}if(r>=1&&r<=31||r==127||n==0&&r>=48&&r<=57||n==1&&r>=48&&r<=57&&o==45){s+="\\"+r.toString(16)+" ";continue}if(n==0&&i==1&&r==45){s+="\\"+t.charAt(n);continue}if(r>=128||r==45||r==95||r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122){s+=t.charAt(n);continue}s+="\\"+t.charAt(n)}return s};if(!e.CSS){e.CSS={}}e.CSS.escape=t;return t});(function(){jQuery.browser=e().browser;function e(){var e=navigator.userAgent.toLowerCase();var t=/(msie) ([\w.]+)/;var i=/(webkit)[ \/]([\w.]+)/;var n=/(opera)(?:.*version)?[ \/]([\w.]+)/;var r=/(mozilla)(?:.*? rv:([\w.]+))?/;var s=i.exec(e)||n.exec(e)||t.exec(e)||e.indexOf("compatible")<0&&r.exec(e)||[];return{browser:s[1]||"",version:s[2]||"0"}}})(jQuery);(function(c){c.extend(true,c.fn.dirty.prototype,{checkValues:function(e){var o=this;var a=false;this.form.find("select").each(function(e,t){var i=c(t);var n=o.isSelectFieldDirty(i);i.data(o.statuses.dataIsDirty,n);a|=n});this.form.find("input, textarea").each(function(e,t){var i=o.isRadioOrCheckbox(t);var n=o.isFileInput(t);var r=c(t);var s;if(i){s=o.isCheckboxDirty(r)}else if(n){s=o.isFileInputDirty(r)}else{if(!r.is(".select2-input[placeholder]")){s=o.isFieldDirty(r)}}r.data(o.statuses.dataIsDirty,s);a|=s});if(a){o.setDirty()}else{o.setClean()}},saveInitialValues:function(){var o=this;this.form.find("input, select, textarea").each(function(e,t){var i=c(t);if(i.attr("id")||i.attr("name")){i.attr("id",i.prop("tagName"+"__"+e))}var n=o.isRadioOrCheckbox(t);var r=o.isFileInput(t);if(n){var s=c(t).is(":checked")?"checked":"unchecked";i.data(o.statuses.dataInitialValue,s)}else if(r){i.data(o.statuses.dataInitialValue,JSON.stringify(t.files))}else{i.data(o.statuses.dataInitialValue,i.val()||"")}})},backupData:function(){var s=this;var o={};s.form.find("input, select, textarea").each(function(e,t){var i=c(t);var n=i.attr("id")||i.attr("name");var r={};r[s.statuses.dataInitialValue]=i.data(s.statuses.dataInitialValue);r[s.statuses.dataIsDirty]=i.data(s.statuses.dataIsDirty);o[n]=r});return o},restoreData:function(s){var o=this;if(s){o.form.find("input, select, textarea").each(function(e,t){var i=c(t);var n=i.attr("id")||i.attr("name");var r=s[n];if(r){i.data(o.statuses.dataInitialValue,r[o.statuses.dataInitialValue]);i.data(o.statuses.dataIsDirty,r[o.statuses.dataIsDirty])}})}o.checkValues()},isSelectFieldDirty:function(e){var t=this;var i=e.data(t.statuses.dataInitialValue)||"";var n=e.val()||"";return!_.isEqual(n,i)},resetForm:function(){var l=this;this.form.find("select").each(function(e,t){var i=c(t);var n=i.data(l.statuses.dataInitialValue);if(i.data("select2")){i.select2("val",n)}else{i.val(n)}});this.form.find("input, textarea").each(function(e,t){var i=c(t);var n=l.isRadioOrCheckbox(t);var r=l.isFileInput(t);if(n){var s=i.data(l.statuses.dataInitialValue);var o=s==="checked";i.prop("checked",o)}if(r){t.value="";c(t).data(l.statuses.dataInitialValue,JSON.stringify(t.files))}else{var a=i.data(l.statuses.dataInitialValue);i.val(a)}});this.checkValues()}})})(jQuery);(function(e){if(e.fn.all){console.error("$.fn.all is already defined")}else{e.fn.extend({all:function(e){return this.filter(e).add(this.find(e))}})}if(e.fn.exists){console.error("$.fn.exists is already defined")}else{e.fn.extend({exists:function(){return this.length>0}})}if(e.fn.json){console.error("$.fn.json is already defined")}else{e.fn.extend({json:function(){return JSON.parse(this.html())}})}e.expr[":"].truncated=function(e){return e.scrollWidth-e.clientWidth>1||e.scrollHeight-e.clientHeight>2};e.expr[":"].truncatedAlt=function(e){const t=e.cloneNode(true);t.style.width="auto";t.style.height="auto";t.style.position="fixed";t.style.overflow="visible";t.style.whiteSpace="nowrap";t.style.visibility="hidden";e.parentElement.appendChild(t);try{const i=t.getBoundingClientRect().width;const n=e.getBoundingClientRect().width;return i>n}finally{t.remove()}}})(jQuery);(function(t){t.fn.extend({ensureLoad:function(e){return this.each(function(){if(this.complete){e.call(this)}else{t(this).on("load",e)}})}})})(jQuery);$.extend(true,$.inputmask.defaults.aliases,{datetime:{regex:{quartspre:new RegExp("0|1|3|4"),quartspost:new RegExp("00|15|30|45"),halfspre:new RegExp("0|3"),halfspost:new RegExp("00|30")},definitions:{q:{validator:function(e,t,i,n,r){var s=r.regex.quartspost.test(e);if(!n&&!s){if(r.regex.quartspost.test(e[0]+"5")){return{c:"5"}}else{return{c:"0"}}}return true},cardinality:2,prevalidator:[{validator:function(e,t,i,n,r){var s=r.regex.quartspre.test(e);s=false;if(!n&&!s){var o=parseInt(e+"0"),a=["00","15","30","45"],l=100,c,u;for(var d=0;d<a.length;d++){var h=a[d];parsedNum=parseInt(h);if(Math.abs(parsedNum-o)<l){l=Math.abs(parsedNum-o);c=h}}u={caret:i+2,insert:[{pos:i,c:c[0]},{pos:i+1,c:c[1]}]};return u}return true},cardinality:1}]},u:{validator:function(e,t,i,n,r){var s=r.regex.halfspost.test(e);if(!n&&!s){return{c:"0"}}return true},cardinality:2,prevalidator:[{validator:function(e,t,i,n,r){var s=r.regex.halfspre.test(e);s=false;if(!n&&!s){var o=parseInt(e+"0"),a=["00","30"],l=100,c,u;for(var d=0;d<a.length;d++){var h=a[d];parsedNum=parseInt(h);if(Math.abs(parsedNum-o)<l){l=Math.abs(parsedNum-o);c=h}}u={caret:i+2,insert:[{pos:i,c:c[0]},{pos:i+1,c:c[1]}]};return u}return true},cardinality:1}]}}},"h:quarts t":{mask:"h:q t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"h:quarts":{mask:"h:q",placeholder:"hh:mm",alias:"datetime",hourFormat:"24"},"h:halfs t":{mask:"h:u t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"h:halfs":{mask:"h:u",placeholder:"hh:mm",alias:"datetime",hourFormat:"24"},"h:00 t":{mask:"h:00 t\\m",placeholder:"hh:00 xm",alias:"datetime",hourFormat:"12"},"h:00":{mask:"h:00",placeholder:"hh:00",alias:"datetime",hourFormat:"24"}});$.fn.serializeObject=function(){var e={};$.each(this.serializeArray(),function(){if(e[this.name]){if(!e[this.name].push){e[this.name]=[e[this.name]]}e[this.name].push(this.value||"")}else{e[this.name]=this.value||""}});return e};$.fn.serializeFormDataObject=function(){var i=this.serializeObject();this.find("input[type=file]").each(function(){if(!$(this).is(":disabled")&&this.name){var e=this.files;if(e.length==0){e=[new File([],"",{type:"application/octet-stream"})]}if(i[this.name]){var t=i[this.name];if($.isArray(t)){i[this.name]=t.concat(e)}else{i[this.name]=[t].concat(e)}}else{if(e.length>1){i[this.name]=e}else{i[this.name]=e[0]}}}});return i};(function(e){if(e.fn.style){console.error("$.fn.style is already defined")}else{e.fn.extend({style:function(t,i,n){if(i===undefined){return this.css(t)}if(e.isFunction(i)){this.each(function(){if(this.style){var e=i.call(this,this.style.getPropertyValue(t));this.style.setProperty(t,e,n)}})}else{this.each(function(){if(this.style){this.style.setProperty(t,i,n)}})}}})}})(jQuery);(function(e){if(String.prototype.trim){e.trim=function(e){return e==null?"":(e+"").trim()}}})(jQuery);$.widget("ui.dialog",$.extend({},$.ui.dialog.prototype,{_title:function(e){if(!this.options.title){e.html("&#160;")}e.html(this.options.title)}}));AGN.Opt.Components.JsPlumbFixedBezierConnector=function(e){var i=jsPlumb.Connectors.AbstractConnector.apply(this,arguments);this.type="FixedBezierConnector";this._compute=function(e){var t=e.anchorOrientation==="opposite"?2:1.5;i.addSegment(this,"Bezier",{x1:e.tx,y1:e.ty,x2:e.sx,y2:e.sy,cp1x:e.tx+e.to[0]*e.w/t,cp1y:e.ty+e.to[1]*e.h/t,cp2x:e.sx+e.so[0]*e.w/t,cp2y:e.sy+e.so[1]*e.h/t})}};_.templateSettings={evaluate:/\{\{(.+?)\}\}/g,interpolate:/\{\{=(.+?)\}\}/g,escape:/\{\{-(.+?)\}\}/g};window.onpopstate=function(){window.location.reload()};(function(e){const i=e.fn.select2.amd.require("select2/defaults");e.extend(i.defaults,{searchInputPlaceholder:"",showSearchIcon:false,language:{noResults:function(e){return t("selects.noMatches",e||"")}}});const n=e.fn.select2.amd.require("select2/dropdown/search");const r=n.prototype.render;n.prototype.render=function(e){const t=r.apply(this,Array.prototype.slice.apply(arguments));this.$search.attr("placeholder",this.options.get("searchInputPlaceholder"));if(this.options.get("showSearchIcon")){this.$searchContainer.addClass("has-search-icon");this.$searchContainer.append(`<i class="icon icon-search select2-search-icon"></i>`)}return t};const s=e.fn.select2.amd.require("select2/selection/search");const o=s.prototype.update;s.prototype.update=function(e,t){o.apply(this,Array.prototype.slice.apply(arguments));if(this.options.get("preventPlaceholderClear")&&this.placeholder?.text){this.$search.attr("placeholder",this.placeholder.text)}};s.prototype.resizeSearch=function(){this.$search.css("width","100%")};const a=e.fn.select2.amd.require("select2/selection/single");const l=e.fn.select2.amd.require("select2/selection/multiple");const c=a.prototype.update;const u=l.prototype.update;a.prototype.update=function(e,t){c.apply(this,Array.prototype.slice.apply(arguments));this.$selection.find(".select2-selection__rendered").removeAttr("title")};l.prototype.update=function(e){u.apply(this,Array.prototype.slice.apply(arguments));this.$selection.find(".select2-selection__choice").removeAttr("title")}})(window.jQuery);!function(e,t){"function"==typeof define&&define.amd?define([],function(){return e.svg4everybody=t()}):"object"==typeof exports?module.exports=t():e.svg4everybody=t()}(this,function(){function p(e,t){if(t){var i=!e.getAttribute("viewBox")&&t.getAttribute("viewBox"),n=document.createDocumentFragment(),r=t.cloneNode(!0);for(i&&e.setAttribute("viewBox",i);r.childNodes.length;){n.appendChild(r.firstChild)}e.appendChild(n)}}function f(e){e.onreadystatechange=function(){if(4===e.readyState){var t=document.createElement("x");t.innerHTML=e.responseText,e.s.splice(0).map(function(e){p(e[0],t.querySelector("#"+e[1].replace(/(\W)/g,"\\$1")))})}},e.onreadystatechange()}function e(e){function a(){for(var e;e=l[0];){var t=e.parentNode;if(t&&/svg/i.test(t.nodeName)){var i=e.getAttribute("xlink:href");if(c&&(!u||u(i,t,e))){var n=i.split("#"),r=n[0],s=n[1];if(t.removeChild(e),r.length){var o=h[r]=h[r]||new XMLHttpRequest;o.s||(o.s=[],o.open("GET",r),o.send()),o.s.push([t,s]),f(o)}else{p(t,document.getElementById(s))}}}}d(a,17)}e=e||{};var l=document.getElementsByTagName("use"),c="polyfill"in e?e.polyfill:/\bEdge\/12\b|\bTrident\/[567]\b|\bVersion\/7.0 Safari\b/.test(navigator.userAgent)||(navigator.userAgent.match(/AppleWebKit\/(\d+)/)||[])[1]<537,u=e.validate,d=window.requestAnimationFrame||setTimeout,h={};c&&a()}return e});AGN.Opt.Templates["select2-result"]="<span>{{- title ? title : text }}</span>";AGN.Opt.Templates["select2-badge-option"]=`
<div class="d-flex align-items-center gap-1">
    {{ if (value) { }}
        <span class="status-badge {{- element.getAttribute('data-badge-class')}}"></span>
    {{ } }}
    <span>{{- text }}</span>
</div>
`;AGN.Opt.Templates["input-feedback"]=`
<div class="form-control-feedback-message">
    <i class="icon icon-state-{{- type === 'success' ? 'success' : 'warning' }}"></i>
    {{ print(message); }}
</div>
`;AGN.Opt.Templates["error"]=`
   <div class="modal modal-alert" tabindex="-1">
        <div class="modal-dialog modal-fullscreen-lg-down">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title">
                        <i class="icon icon-state-warning"></i>
                        {{= headline }}
                    </h1>
  
                    <button type="button" class="btn-close" data-bs-dismiss="modal">
                        <span class="sr-only"><mvc:message code="button.Cancel"/></span>
                    </button>
                </div>
  
                <div class="modal-body">
                    <p>{{= text }}</p>
                </div>
                
                <div class="modal-footer">
                   <button class="btn btn-primary" data-bs-dismiss="modal" onclick="location.reload();">
                        <i class="icon icon-redo"></i>
                        <span class="text">{{= reload }}</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
`;AGN.Opt.Templates["permission-denied"]=`
   <div class="modal modal-alert" tabindex="-1">
        <div class="modal-dialog modal-fullscreen-lg-down">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title">
                        <i class="icon icon-state-alert"></i>
                        {{= title }}
                    </h1>
                </div>

                <div class="modal-body">
                    <p>{{= text }}</p>
                </div>
                
                <div class="modal-footer">
                     <button class="btn btn-primary" data-bs-dismiss="modal">
                        <i class="icon icon-check"></i>
                        <span class="text">{{= btn }}</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
`;AGN.Opt.Templates["autosave-restore"]=`
  <div class="modal" tabIndex="-1">
    <div class="modal-dialog modal-fullscreen-lg-down modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title">{{= title }}</h1>
          <button type="button" class="btn-close js-confirm-negative" data-bs-dismiss="modal">
            <span class="sr-only"><mvc:message code="button.Cancel"/></span>
          </button>
        </div>
        <div class="modal-body">
          <p>{{= content }}</p>
        </div>
  
        <div class="modal-footer">
            <button type="button" class="btn btn-danger js-confirm-negative" data-bs-dismiss="modal">
              <i class="icon icon-times"></i>
              <span class="text">{{= negative }}</span>
            </button>
            <button type="button" class="btn btn-primary js-confirm-positive" data-bs-dismiss="modal">
                <i class="icon icon-check"></i>
                <span class="text">{{= positive }}</span>
            </button>
        </div>
      </div>
    </div>
  </div>
`;AGN.Opt.Templates["tooltip-template"]=`
  <div class="tooltip {{= tooltipStyle }}" role="tooltip">
    <div class="tooltip-arrow {{= arrowStyle }}"></div>
    <div class="tooltip-inner {{= innerStyle }}"></div>
  </div>
`;AGN.Opt.Templates["table-footer"]=`
 {{ if (showRecordsCount === 'simple') { }}
    <div class="table-wrapper__footer"></div>
 {{ } else { }}
    <div class="table-wrapper__footer table-wrapper__footer--pages-{{- totalPages }}">
      {{ if (showRecordsCount) { }}
        <div class="table-wrapper__rows-selection">
          <select data-number-of-rows class="form-control compact js-select" data-select-options="width: 'auto', dropdownAutoWidth: true">
            {{ _.each([20, 50, 100, 200], numberOfRows => { }}       
              <option value="{{- numberOfRows }}" {{- pageSize == numberOfRows ? 'selected="selected"' : ''}}>{{- numberOfRows }}</option>
            {{ }) }}
          </select>       
          <span>${t("defaults.rowsToDisplay")}</span>
        </div>
      {{ } }}
    
      {{ if (pagination && totalPages > 1) { }}
        <ul class="pagination">
          <li class="js-data-table-first-page {{= currentPage == 1 ? 'disabled' : ''¬†}}">
            <span><i class="icon icon-angle-double-left"></i></span>
          </li>
          <li class="js-data-table-prev-page {{= currentPage == 1 ? 'disabled' : ''¬†}}">
            <span><i class="icon icon-angle-left"></i></span>
          </li>
          {{ _.each(pageSelects, page => { }} 
            <li class="{{=¬†page == currentPage ? 'active' : 'js-data-table-page' }}" data-page="{{= page - 1 }}">
              <span>{{= page }}</span>
            </li>
          {{ }) }}
          <li class="js-data-table-next-page {{= currentPage == totalPages ? 'disabled' : ''¬†}}">
            <span><i class="icon icon-angle-right"></i></span>
          </li>
          <li class="js-data-table-last-page {{= currentPage == totalPages ? 'disabled' : ''¬†}}">
            <span><i class="icon icon-angle-double-right"></i></span>
          </li>
        </ul>
      {{ } }}
    </div>
 {{ } }}
`;AGN.Opt.Templates["js-table-wrapper"]=`
  <div class="table-wrapper">
    <div class="table-wrapper__header justify-content-end">
        <div class="table-wrapper__controls">
          <button type="button" class="btn btn-inverse" data-toggle-table-truncation>
            <i class="icon icon-ellipsis-h"></i>
            <span>${t("defaults.toggleTruncation")}</span>
          </button>
          
          <p class="table-wrapper__entries-label">
            <b></b>
            <span class="text-truncate">${t("defaults.entries")}</span>
          </p>
        </div>
    </div>
  </div>
`;AGN.Opt.Templates["session-expired"]=`
<div class="modal modal-warning" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-fullscreen-lg-down modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title">
                    <i class="icon icon-state-warning"></i>
                    ${t("logon.session.expired")}
                </h1>
            </div>

            <div class="modal-body">
                <p>${t("logon.session.notification")}</p>
            </div>
            
            <div class="modal-footer">
               <button class="btn btn-primary" data-bs-dismiss="modal">
                  ${t("defaults.relogin")}
              </button>
            </div>
        </div>
    </div>
</div>
`;AGN.Opt.Templates["datetime-picker"]=`
  <div class="date-time-container">
      <div class="date-picker-container">
        <input type="text" class="form-control js-datepicker" value="{{- date }}" placeholder="{{- window.adminDateFormat }}" {{- extraAttrs }} />
      </div>
      {{ var timeMask = timeMask ? timeMask : 'h:s' }}
      <div class="time-picker-container">
         <input type="text" class="form-control js-timepicker" value="{{- time }}" data-timepicker-options="mask: '{{- timeMask }}'" {{- extraAttrs }} />
      </div>
  </div>
`;AGN.Opt.Templates["plus-btn"]=`
<a href="#" class="btn btn-icon btn-primary" {{= attrs }}>
    <i class="icon icon-plus"></i>
</a>`;AGN.Opt.Templates["trash-btn"]=`
<a href="#" class="btn btn-icon btn-danger" {{= attrs }}>
    <i class="icon icon-trash-alt"></i>
</a>`;AGN.Opt.Templates["notification-info"]=`
  <div class="notification-simple">
      <i class="icon icon-info-circle"></i>
      <span>{{- message }}</span>
  </div>
`;AGN.Opt.Templates["progress"]=`
  {{ if (isNaN(currentProgress) || currentProgress === true) { }}
      <div class="progress loop" style="width: 100%"></div>
  {{ } else { }}
      <div class="progress">
          <div class="progress-bar-white-bg"></div>
          <div class="progress-bar"
                     role="progressbar"
                     aria-valuenow="{{= currentProgress }}"
                     aria-valuemin="0"
                     aria-valuemax="100"
                     style="width: {{= currentProgress }}%"></div>
          <div class="progress-bar-primary-bg"></div>
          <div class="percentage">{{= currentProgress }}%</div>
      </div>
  {{ } }}
`;AGN.Opt.Templates["tile-overlay"]=`
  <div class="tile-overlay tile-overlay--{{= state }}">
      {{ if (state === 'visible') { }}
        <button type="button" class="btn btn-danger btn-lg btn-sm-horizontal" data-edit-tile-visibility>
            <i class="icon icon-eye-slash"></i>
            ${t("editableView.tile.state.visible")}
        </button>
      {{ } else if (state === 'hidden') { }}
        <button type="button" class="btn btn-primary btn-lg btn-sm-horizontal" data-edit-tile-visibility>
            <i class="icon icon-eye"></i>
            ${t("editableView.tile.state.hidden")}
        </button>
      {{ } else { }}
        <button type="button" class="btn btn-dark btn-lg btn-sm-horizontal pe-none">
            <i class="icon icon-minus-circle"></i>
            ${t("editableView.tile.state.main")}
        </button>
      {{ } }}
  </div>
`;AGN.Opt.Templates["deletable-table-column"]=`
  <div class="d-flex gap-1 align-items-center hidden">
    {{ if (!permanent) { }}
      <button type="button" class="icon-btn" data-remove-table-column>
        <i class="icon icon-times-circle text-danger"></i>
      </button>
    {{ } }}
    <span class="text-truncate">{{= text }}</span>
  </div>
`;AGN.Opt.Templates["table-column-picker"]=`
  <div class="dropdown dropstart hidden">
      <button type="button" class="icon-btn" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">
        <i class="icon icon-plus-circle text-primary"></i>
      </button>
      <ul class="dropdown-menu dropdown-menu--table-column mt-4">
          <select class="form-control" multiple data-select-options="preventPlaceholderClear: true, placeholder: '${t("tables.searchOoo")}'">
            {{ _.each(columns, col => { }}
              <option value="{{- col.name }}" {{ col.selected ? print('selected') : print('') }}>
                {{- col.text }}
              </option>
            {{ }); }}
          </select>
      </ul>
  </div>
`;AGN.Opt.Templates["multi-editor-modal"]=`
<div class="modal modal-adaptive modal-editor">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title">{{= title }}</h1>
                <button type="button" class="btn-close js-confirm-negative" data-bs-dismiss="modal">
                    <span class="sr-only">${t("defaults.cancel")}</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="modal-editors-container">
                    <div data-placeholder></div>
                </div>
            </div>
            <div class="modal-footer">
                <a href="#" class="btn btn-primary" data-apply-enlarged>
                    <i class="icon icon-save"></i>
                    <span class="text">{{- btnText }}</span>
                </a>
            </div>
        </div>
    </div>
</div>
`;AGN.Opt.Templates["mailing-locked"]=`
<div class="modal modal-warning" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title">
                    <i class="icon icon-state-warning"></i>
                    {{= t(\'defaults.warning\') }}
                </h1>
                
                <button type="button" class="btn-close" data-bs-dismiss="modal">
                  <span class="sr-only"><mvc:message code="button.Cancel"/></span>
                </button>
            </div>

            <div class="modal-body">
                <p>{{= t(\'error.mailing.exclusiveLockingFailed\', username) }}</p>
            </div>
        </div>
    </div>
</div>
`;AGN.Opt.Templates["double-select-options"]=`
{{ _.forEach(opts, (name, value) => { }}
    <option value="{{- value }}" {{ value == valueSelected ? print('selected') : print('') }}>
      {{- name }}
    </option>
{{ }); }}
`;(function(){if(window.agnTimeZoneId){moment.tz.setDefault(window.agnTimeZoneId)}})();(function(e,t){if(typeof define=="function"&&define.amd){define(["jquery","dot/doT","jquery-extendext"],t)}else if(typeof module==="object"&&module.exports){module.exports=t(require("jquery"),require("dot/doT"),require("jquery-extendext"))}else{t(e.jQuery,e.doT)}})(this,function(m,i){"use strict";var h=function(e,t){e[0].queryBuilder=this;this.$el=e;this.settings=m.extendext(true,"replace",{},h.DEFAULTS,t);this.model=new n;this.status={id:null,generated_id:false,group_id:0,rule_id:0,has_optgroup:false,has_operator_optgroup:false};this.filters=this.settings.filters;this.icons=this.settings.icons;this.operators=this.settings.operators;this.templates=this.settings.templates;this.plugins=this.settings.plugins;this.lang=null;if(h.regional["en"]===undefined){v.error("Config",'"i18n/en.js" not loaded.')}this.lang=m.extendext(true,"replace",{},h.regional["en"],h.regional[this.settings.lang_code],this.settings.lang);if(this.settings.allow_groups===false){this.settings.allow_groups=0}else if(this.settings.allow_groups===true){this.settings.allow_groups=-1}Object.keys(this.templates).forEach(function(e){if(!this.templates[e]){this.templates[e]=h.templates[e]}if(typeof this.templates[e]=="string"){this.templates[e]=i.template(this.templates[e])}},this);if(!this.$el.attr("id")){this.$el.attr("id","qb_"+Math.floor(Math.random()*99999));this.status.generated_id=true}this.status.id=this.$el.attr("id");this.$el.addClass("query-builder form-inline");this.filters=this.checkFilters(this.filters);this.operators=this.checkOperators(this.operators);this.bindEvents();this.initPlugins()};m.extend(h.prototype,{trigger:function(e){var t=new m.Event(this._tojQueryEvent(e),{builder:this});this.$el.triggerHandler(t,Array.prototype.slice.call(arguments,1));return t},change:function(e,t){var i=new m.Event(this._tojQueryEvent(e,true),{builder:this,value:t});this.$el.triggerHandler(i,Array.prototype.slice.call(arguments,2));return i.value},on:function(e,t){this.$el.on(this._tojQueryEvent(e),t);return this},off:function(e,t){this.$el.off(this._tojQueryEvent(e),t);return this},once:function(e,t){this.$el.one(this._tojQueryEvent(e),t);return this},_tojQueryEvent:function(e,t){return e.split(" ").map(function(e){return e+".queryBuilder"+(t?".filter":"")}).join(" ")}});h.types={string:"string",integer:"number",double:"number",date:"datetime",time:"datetime",datetime:"datetime",boolean:"boolean"};h.inputs=["text","number","textarea","radio","checkbox","select"];h.modifiable_options=["display_errors","allow_groups","allow_empty","default_condition","default_filter"];h.selectors={group_container:".rules-group-container",rule_container:".rule-container",filter_container:".rule-filter-container",operator_container:".rule-operator-container",value_container:".rule-value-container",error_container:".error-container",condition_container:".rules-group-header .group-conditions",rule_header:".rule-header",group_header:".rules-group-header",group_actions:".group-actions",rule_actions:".rule-actions",rules_list:".rules-group-body>.rules-list",group_btns:".btn",group_condition:".rules-group-header [name$=_cond]",rule_filter:".rule-filter-container [name$=_filter]",rule_operator:".rule-operator-container [name$=_operator]",rule_value:".rule-value-container :input:not(.icon-help)",add_rule:"[data-add=rule]",delete_rule:"[data-delete=rule]",add_group:"[data-add=group]",delete_group:"[data-delete=group]"};h.templates={};h.regional={};h.OPERATORS={equal:{type:"equal",nb_inputs:1,multiple:false,apply_to:["string","number","datetime","boolean"]},not_equal:{type:"not_equal",nb_inputs:1,multiple:false,apply_to:["string","number","datetime","boolean"]},in:{type:"in",nb_inputs:1,multiple:true,apply_to:["string","number","datetime"]},not_in:{type:"not_in",nb_inputs:1,multiple:true,apply_to:["string","number","datetime"]},less:{type:"less",nb_inputs:1,multiple:false,apply_to:["number","datetime"]},less_or_equal:{type:"less_or_equal",nb_inputs:1,multiple:false,apply_to:["number","datetime"]},greater:{type:"greater",nb_inputs:1,multiple:false,apply_to:["number","datetime"]},greater_or_equal:{type:"greater_or_equal",nb_inputs:1,multiple:false,apply_to:["number","datetime"]},between:{type:"between",nb_inputs:2,multiple:false,apply_to:["number","datetime"]},not_between:{type:"not_between",nb_inputs:2,multiple:false,apply_to:["number","datetime"]},begins_with:{type:"begins_with",nb_inputs:1,multiple:false,apply_to:["string"]},not_begins_with:{type:"not_begins_with",nb_inputs:1,multiple:false,apply_to:["string"]},contains:{type:"contains",nb_inputs:1,multiple:false,apply_to:["string"]},not_contains:{type:"not_contains",nb_inputs:1,multiple:false,apply_to:["string"]},ends_with:{type:"ends_with",nb_inputs:1,multiple:false,apply_to:["string"]},not_ends_with:{type:"not_ends_with",nb_inputs:1,multiple:false,apply_to:["string"]},is_empty:{type:"is_empty",nb_inputs:0,multiple:false,apply_to:["string"]},is_not_empty:{type:"is_not_empty",nb_inputs:0,multiple:false,apply_to:["string"]},is_null:{type:"is_null",nb_inputs:0,multiple:false,apply_to:["string","number","datetime","boolean"]},is_not_null:{type:"is_not_null",nb_inputs:0,multiple:false,apply_to:["string","number","datetime","boolean"]}};h.DEFAULTS={filters:[],plugins:[],sort_filters:false,display_errors:true,allow_groups:-1,allow_empty:false,conditions:["AND","OR"],default_condition:"AND",inputs_separator:" , ",select_placeholder:"------",display_empty_filter:true,default_filter:null,optgroups:{},default_rule_flags:{filter_readonly:false,operator_readonly:false,value_readonly:false,no_delete:false},default_group_flags:{condition_readonly:false,no_add_rule:false,no_add_group:false,no_delete:false},templates:{group:null,rule:null,filterSelect:null,operatorSelect:null,ruleValueSelect:null},lang_code:"en",lang:{},operators:["equal","not_equal","in","not_in","less","less_or_equal","greater","greater_or_equal","between","not_between","begins_with","not_begins_with","contains","not_contains","ends_with","not_ends_with","is_empty","is_not_empty","is_null","is_not_null"],icons:{add_group:"glyphicon glyphicon-plus-sign",add_rule:"glyphicon glyphicon-plus",remove_group:"glyphicon glyphicon-remove",remove_rule:"glyphicon glyphicon-remove",error:"glyphicon glyphicon-warning-sign"}};h.plugins={};h.defaults=function(e){if(typeof e=="object"){m.extendext(true,"replace",h.DEFAULTS,e)}else if(typeof e=="string"){if(typeof h.DEFAULTS[e]=="object"){return m.extend(true,{},h.DEFAULTS[e])}else{return h.DEFAULTS[e]}}else{return m.extend(true,{},h.DEFAULTS)}};h.define=function(e,t,i){h.plugins[e]={fct:t,def:i||{}}};h.extend=function(e){m.extend(h.prototype,e)};h.prototype.initPlugins=function(){if(!this.plugins){return}if(m.isArray(this.plugins)){var t={};this.plugins.forEach(function(e){t[e]=null});this.plugins=t}Object.keys(this.plugins).forEach(function(e){if(e in h.plugins){this.plugins[e]=m.extend(true,{},h.plugins[e].def,this.plugins[e]||{});h.plugins[e].fct.call(this,this.plugins[e])}else{v.error("Config",'Unable to find plugin "{0}"',e)}},this)};h.prototype.getPluginOptions=function(e,t){var i;if(this.plugins&&this.plugins[e]){i=this.plugins[e]}else if(h.plugins[e]){i=h.plugins[e].def}if(i){if(t){return i[t]}else{return i}}else{v.error("Config",'Unable to find plugin "{0}"',e)}};h.prototype.init=function(e){this.trigger("afterInit");if(e){this.setRules(e);delete this.settings.rules}else{this.setRoot(true)}};h.prototype.checkFilters=function(e){var t=[];if(!e||e.length===0){v.error("Config","Missing filters list")}e.forEach(function(n,e){if(!n.id){v.error("Config","Missing filter {0} id",e)}if(t.indexOf(n.id)!=-1){v.error("Config",'Filter "{0}" already defined',n.id)}t.push(n.id);if(!n.type){n.type="string"}else if(!h.types[n.type]){v.error("Config",'Invalid type "{0}"',n.type)}if(!n.input){n.input=h.types[n.type]==="number"?"number":"text"}else if(typeof n.input!="function"&&h.inputs.indexOf(n.input)==-1){v.error("Config",'Invalid input "{0}"',n.input)}if(n.operators){n.operators.forEach(function(e){if(typeof e!="string"){v.error("Config","Filter operators must be global operators types (string)")}})}if(!n.field){n.field=n.id}if(!n.label){n.label=n.field}if(!n.optgroup){n.optgroup=null}else{this.status.has_optgroup=true;if(!this.settings.optgroups[n.optgroup]){this.settings.optgroups[n.optgroup]=n.optgroup}}switch(n.input){case"radio":case"checkbox":if(!n.values||n.values.length<1){v.error("Config",'Missing filter "{0}" values',n.id)}break;case"select":var r=[];n.has_optgroup=false;v.iterateOptions(n.values,function(e,t,i){r.push({value:e,label:t,optgroup:i||null});if(i){n.has_optgroup=true;if(!this.settings.optgroups[i]){this.settings.optgroups[i]=i}}}.bind(this));if(n.has_optgroup){n.values=v.groupSort(r,"optgroup")}else{n.values=r}if(n.placeholder){if(n.placeholder_value===undefined){n.placeholder_value=-1}n.values.forEach(function(e){if(e.value==n.placeholder_value){v.error("Config",'Placeholder of filter "{0}" overlaps with one of its values',n.id)}})}break}},this);if(this.settings.sort_filters){if(typeof this.settings.sort_filters=="function"){e.sort(this.settings.sort_filters)}else{var i=this;e.sort(function(e,t){return i.translate(e.label).localeCompare(i.translate(t.label))})}}if(this.status.has_optgroup){e=v.groupSort(e,"optgroup")}return e};h.prototype.checkOperators=function(i){var n=[];i.forEach(function(e,t){if(typeof e=="string"){if(!h.OPERATORS[e]){v.error("Config",'Unknown operator "{0}"',e)}i[t]=e=m.extendext(true,"replace",{},h.OPERATORS[e])}else{if(!e.type){v.error("Config",'Missing "type" for operator {0}',t)}if(h.OPERATORS[e.type]){i[t]=e=m.extendext(true,"replace",{},h.OPERATORS[e.type],e)}if(e.nb_inputs===undefined||e.apply_to===undefined){v.error("Config",'Missing "nb_inputs" and/or "apply_to" for operator "{0}"',e.type)}}if(n.indexOf(e.type)!=-1){v.error("Config",'Operator "{0}" already defined',e.type)}n.push(e.type);if(!e.optgroup){e.optgroup=null}else{this.status.has_operator_optgroup=true;if(!this.settings.optgroups[e.optgroup]){this.settings.optgroups[e.optgroup]=e.optgroup}}},this);if(this.status.has_operator_optgroup){i=v.groupSort(i,"optgroup")}return i};h.prototype.bindEvents=function(){var s=this;var t=h.selectors;this.$el.on("change.queryBuilder",t.group_condition,function(){if(m(this).is(":checked")){var e=m(this).closest(t.group_container);s.getModel(e).condition=m(this).val()}});this.$el.on("change.queryBuilder",t.rule_filter,function(){var e=m(this).closest(t.rule_container);s.getModel(e).filter=s.getFilterById(m(this).val())});this.$el.on("change.queryBuilder",t.rule_operator,function(){var e=m(this).closest(t.rule_container);s.getModel(e).operator=s.getOperatorByType(m(this).val())});this.$el.on("click.queryBuilder",t.add_rule,function(){var e=m(this).closest(t.group_container);s.addRule(s.getModel(e))});this.$el.on("click.queryBuilder",t.delete_rule,function(){var e=m(this).closest(t.rule_container);s.deleteRule(s.getModel(e))});if(this.settings.allow_groups!==0){this.$el.on("click.queryBuilder",t.add_group,function(){var e=m(this).closest(t.group_container);s.addGroup(s.getModel(e))});this.$el.on("click.queryBuilder",t.delete_group,function(){var e=m(this).closest(t.group_container);s.deleteGroup(s.getModel(e))})}this.model.on({drop:function(e,t){t.$el.remove();s.refreshGroupsConditions()},add:function(e,t,i,n){if(n===0){i.$el.prependTo(t.$el.find(">"+h.selectors.rules_list))}else{i.$el.insertAfter(t.rules[n-1].$el)}s.refreshGroupsConditions()},move:function(e,t,i,n){t.$el.detach();if(n===0){t.$el.prependTo(i.$el.find(">"+h.selectors.rules_list))}else{t.$el.insertAfter(i.rules[n-1].$el)}s.refreshGroupsConditions()},update:function(e,t,i,n,r){if(t instanceof o){switch(i){case"error":s.updateError(t);break;case"flags":s.applyRuleFlags(t);break;case"filter":s.updateRuleFilter(t,r);break;case"operator":s.updateRuleOperator(t,r);break;case"value":s.updateRuleValue(t,r);break}}else{switch(i){case"error":s.updateError(t);break;case"flags":s.applyGroupFlags(t);break;case"condition":s.updateGroupCondition(t,r);break}}}})};h.prototype.setRoot=function(e,t,i){e=e===undefined||e===true;var n=this.nextGroupId();var r=m(this.getGroupTemplate(n,1));r.find(h.selectors.group_btns).addClass(this.settings.readonly?"disabled":"");this.$el.append(r);this.model.root=new c(null,r);this.model.root.model=this.model;this.model.root.data=t;this.model.root.flags=m.extend({},this.settings.default_group_flags,i);this.model.root.condition=this.settings.default_condition;this.trigger("afterAddGroup",this.model.root);if(e){this.addRule(this.model.root)}return this.model.root};h.prototype.addGroup=function(e,t,i,n){t=t===undefined||t===true;var r=e.level+1;var s=this.trigger("beforeAddGroup",e,t,r);if(s.isDefaultPrevented()){return null}var o=this.nextGroupId();var a=m(this.getGroupTemplate(o,r));var l=e.addGroup(a);l.data=i;l.flags=m.extend({},this.settings.default_group_flags,n);l.condition=this.settings.default_condition;this.trigger("afterAddGroup",l);this.trigger("rulesChanged");if(t){this.addRule(l)}return l};h.prototype.deleteGroup=function(e){if(e.isRoot()){return false}var t=this.trigger("beforeDeleteGroup",e);if(t.isDefaultPrevented()){return false}var i=true;e.each("reverse",function(e){i&=this.deleteRule(e)},function(e){i&=this.deleteGroup(e)},this);if(i){e.drop();this.trigger("afterDeleteGroup");this.trigger("rulesChanged")}return i};h.prototype.updateGroupCondition=function(t,e){t.$el.find(">"+h.selectors.group_condition).each(function(){var e=m(this);e.prop("checked",e.val()===t.condition);e.parent().toggleClass("active",e.val()===t.condition)});this.trigger("afterUpdateGroupCondition",t,e);this.trigger("rulesChanged")};h.prototype.refreshGroupsConditions=function(){(function t(e){if(!e.flags||e.flags&&!e.flags.condition_readonly){e.$el.find(">"+h.selectors.group_condition).prop("disabled",e.rules.length<=1).parent().toggleClass("disabled",e.rules.length<=1)}e.each(null,function(e){t(e)},this)})(this.model.root)};h.prototype.addRule=function(e,t,i){var n=this.trigger("beforeAddRule",e);if(n.isDefaultPrevented()){return null}var r=this.nextRuleId();var s=m(this.getRuleTemplate(r));var o=e.addRule(s);o.data=t;o.flags=m.extend({},this.settings.default_rule_flags,i);this.trigger("afterAddRule",o);this.trigger("rulesChanged");this.createRuleFilters(o);if(this.settings.default_filter||!this.settings.display_empty_filter){o.filter=this.change("getDefaultFilter",this.getFilterById(this.settings.default_filter||this.filters[0].id),o)}return o};h.prototype.deleteRule=function(e){if(e.flags.no_delete){return false}var t=this.trigger("beforeDeleteRule",e);if(t.isDefaultPrevented()){return false}e.drop();this.trigger("afterDeleteRule");this.trigger("rulesChanged");return true};h.prototype.createRuleFilters=function(e){var t=this.change("getRuleFilters",this.filters,e);var i=m(this.getRuleFilterSelect(e,t));e.$el.find(h.selectors.filter_container).html(i);this.trigger("afterCreateRuleFilters",e);this.applyRuleFlags(e)};h.prototype.createRuleOperators=function(e){var t=e.$el.find(h.selectors.operator_container).empty();if(!e.filter){return}var i=this.getOperators(e.filter);var n=m(this.getRuleOperatorSelect(e,i));t.html(n);if(e.filter.default_operator){e.__.operator=this.getOperatorByType(e.filter.default_operator)}else{e.__.operator=i[0]}e.$el.find(h.selectors.rule_operator).val(e.operator.type);this.trigger("afterCreateRuleOperators",e,i);this.applyRuleFlags(e)};h.prototype.createRuleInput=function(e){var t=e.$el.find(h.selectors.value_container).empty();e.__.value=undefined;if(!e.filter||!e.operator||e.operator.nb_inputs===0){return}var i=this;var n=m();var r=e.filter;for(var s=0;s<e.operator.nb_inputs;s++){var o=m(this.getRuleInput(e,s));if(s>0)t.append(this.settings.inputs_separator);t.append(o);n=n.add(o)}t.css("display","");n.on("change "+(r.input_event||""),function(){if(!e._updating_input){e._updating_value=true;e.value=i.getRuleInputValue(e);e._updating_value=false}});if(r.plugin){n[r.plugin](r.plugin_config||{})}this.trigger("afterCreateRuleInput",e);if(r.default_value!==undefined){e.value=r.default_value}else{e._updating_value=true;e.value=i.getRuleInputValue(e);e._updating_value=false}this.applyRuleFlags(e)};h.prototype.updateRuleFilter=function(e,t){this.createRuleOperators(e);this.createRuleInput(e);e.$el.find(h.selectors.rule_filter).val(e.filter?e.filter.id:"-1");if(t&&e.filter&&t.id!==e.filter.id){e.data=undefined}this.trigger("afterUpdateRuleFilter",e,t);this.trigger("rulesChanged")};h.prototype.updateRuleOperator=function(e,t){var i=e.$el.find(h.selectors.value_container);if(!e.operator||e.operator.nb_inputs===0){i.hide();e.__.value=undefined}else{i.css("display","");if(i.is(":empty")||!t||e.operator.nb_inputs!==t.nb_inputs||e.operator.optgroup!==t.optgroup){this.createRuleInput(e)}}if(e.operator){e.$el.find(h.selectors.rule_operator).val(e.operator.type);e.__.value=this.getRuleInputValue(e)}this.trigger("afterUpdateRuleOperator",e,t);this.trigger("rulesChanged")};h.prototype.updateRuleValue=function(e,t){if(!e._updating_value){this.setRuleInputValue(e,e.value)}this.trigger("afterUpdateRuleValue",e,t);this.trigger("rulesChanged")};h.prototype.applyRuleFlags=function(e){var t=e.flags;var i=h.selectors;e.$el.find(i.rule_filter).prop("disabled",t.filter_readonly);e.$el.find(i.rule_operator).prop("disabled",t.operator_readonly);e.$el.find(i.rule_value).prop("disabled",t.value_readonly);if(t.no_delete){e.$el.find(i.delete_rule).remove()}this.trigger("afterApplyRuleFlags",e)};h.prototype.applyGroupFlags=function(e){var t=e.flags;var i=h.selectors;e.$el.find(">"+i.group_condition).prop("disabled",t.condition_readonly).parent().toggleClass("readonly",t.condition_readonly);if(t.no_add_rule){e.$el.find(i.add_rule).remove()}if(t.no_add_group){e.$el.find(i.add_group).remove()}if(t.no_delete){e.$el.find(i.delete_group).remove()}this.trigger("afterApplyGroupFlags",e)};h.prototype.clearErrors=function(e){e=e||this.model.root;if(!e){return}e.error=null;if(e instanceof c){e.each(function(e){e.error=null},function(e){this.clearErrors(e)},this)}};h.prototype.updateError=function(e){if(this.settings.display_errors){if(e.error===null){e.$el.removeClass("has-error")}else{var t=this.translate("errors",e.error[0]);t=v.fmt(t,e.error.slice(1));t=this.change("displayError",t,e.error,e);e.$el.addClass("has-error").find(h.selectors.error_container).eq(0).attr("title",t)}}};h.prototype.triggerValidationError=function(e,t,i){if(!m.isArray(t)){t=[t]}var n=this.trigger("validationError",e,t,i);if(!n.isDefaultPrevented()){e.error=t}};h.prototype.destroy=function(){this.trigger("beforeDestroy");if(this.status.generated_id){this.$el.removeAttr("id")}this.clear();this.model=null;this.$el.off(".queryBuilder").removeClass("query-builder").removeData("queryBuilder");delete this.$el[0].queryBuilder};h.prototype.reset=function(){var e=this.trigger("beforeReset");if(e.isDefaultPrevented()){return}this.status.group_id=1;this.status.rule_id=0;this.model.root.empty();this.model.root.data=undefined;this.model.root.flags=m.extend({},this.settings.default_group_flags);this.model.root.condition=this.settings.default_condition;this.addRule(this.model.root);this.trigger("afterReset");this.trigger("rulesChanged")};h.prototype.clear=function(){var e=this.trigger("beforeClear");if(e.isDefaultPrevented()){return}this.status.group_id=0;this.status.rule_id=0;if(this.model.root){this.model.root.drop();this.model.root=null}this.trigger("afterClear");this.trigger("rulesChanged")};h.prototype.setOptions=function(e){m.each(e,function(e,t){if(h.modifiable_options.indexOf(e)!==-1){this.settings[e]=t}}.bind(this))};h.prototype.getModel=function(e){if(!e){return this.model.root}else if(e instanceof r){return e}else{return m(e).data("queryBuilderModel")}};h.prototype.validate=function(s){s=m.extend({skip_empty:false},s);this.clearErrors();var o=this;var e=function i(e){var n=0;var r=0;e.each(function(e){if(!e.filter&&s.skip_empty){return}if(!e.filter){o.triggerValidationError(e,"no_filter",null);r++;return}if(!e.operator){o.triggerValidationError(e,"no_operator",null);r++;return}if(e.operator.nb_inputs!==0){var t=o.validateValue(e,e.value);if(t!==true){o.triggerValidationError(e,t,e.value);r++;return}}n++},function(e){var t=i(e);if(t===true){n++}else if(t===false){r++}});if(r>0){return false}else if(n===0&&!e.isRoot()&&s.skip_empty){return null}else if(n===0&&(!o.settings.allow_empty||!e.isRoot())){o.triggerValidationError(e,"empty_group",null);return false}return true}(this.model.root);return this.change("validate",e)};h.prototype.getRules=function(s){s=m.extend({get_flags:false,allow_invalid:false,skip_empty:false},s);var e=this.validate(s);if(!e&&!s.allow_invalid){return null}var o=this;var t=function i(e){var r={condition:e.condition,rules:[]};if(e.data){r.data=m.extendext(true,"replace",{},e.data)}if(s.get_flags){var t=o.getGroupFlags(e.flags,s.get_flags==="all");if(!m.isEmptyObject(t)){r.flags=t}}e.each(function(e){if(!e.filter&&s.skip_empty){return}var t=null;if(!e.operator||e.operator.nb_inputs!==0){t=e.value}var i={id:e.filter?e.filter.id:null,field:e.filter?e.filter.field:null,type:e.filter?e.filter.type:null,input:e.filter?e.filter.input:null,operator:e.operator?e.operator.type:null,value:t};if(e.filter&&e.filter.data||e.data){i.data=m.extendext(true,"replace",{},e.filter.data,e.data)}if(s.get_flags){var n=o.getRuleFlags(e.flags,s.get_flags==="all");if(!m.isEmptyObject(n)){i.flags=n}}r.rules.push(o.change("ruleToJson",i,e))},function(e){var t=i(e);if(t.rules.length!==0||!s.skip_empty){r.rules.push(t)}},this);return o.change("groupToJson",r,e)}(this.model.root);t.valid=e;return this.change("getRules",t)};h.prototype.setRules=function(e,r){r=m.extend({allow_invalid:false},r);if(m.isArray(e)){e={condition:this.settings.default_condition,rules:e}}if(!e||!e.rules||e.rules.length===0&&!this.settings.allow_empty){v.error("RulesParse","Incorrect data object passed")}this.clear();this.setRoot(false,e.data,this.parseGroupFlags(e));e=this.change("setRules",e,r);var s=this;(function i(e,n){if(n===null){return}if(e.condition===undefined){e.condition=s.settings.default_condition}else if(s.settings.conditions.indexOf(e.condition)==-1){v.error(!r.allow_invalid,"UndefinedCondition",'Invalid condition "{0}"',e.condition);e.condition=s.settings.default_condition}n.condition=e.condition;e.rules.forEach(function(e){var t;if(e.rules!==undefined){if(s.settings.allow_groups!==-1&&s.settings.allow_groups<n.level){v.error(!r.allow_invalid,"RulesParse","No more than {0} groups are allowed",s.settings.allow_groups);s.reset()}else{t=s.addGroup(n,false,e.data,s.parseGroupFlags(e));if(t===null){return}i(e,t)}}else{if(!e.empty){if(e.id===undefined){v.error(!r.allow_invalid,"RulesParse","Missing rule field id");e.empty=true}if(e.operator===undefined){e.operator="equal"}}t=s.addRule(n,e.data,s.parseRuleFlags(e));if(t===null){return}if(!e.empty){t.filter=s.getFilterById(e.id,!r.allow_invalid)}if(t.filter){t.operator=s.getOperatorByType(e.operator,!r.allow_invalid);if(!t.operator){t.operator=s.getOperators(t.filter)[0]}}if(t.operator&&t.operator.nb_inputs!==0){if(e.value!==undefined){t.value=e.value}else if(t.filter.default_value!==undefined){t.value=t.filter.default_value}}if(s.change("jsonToRule",t,e)!=t){v.error("RulesParse","Plugin tried to change rule reference")}}});if(s.change("jsonToGroup",n,e)!=n){v.error("RulesParse","Plugin tried to change group reference")}})(e,this.model.root);this.trigger("afterSetRules")};h.prototype.validateValue=function(e,t){var i=e.filter.validation||{};var n=true;if(i.callback){n=i.callback.call(this,t,e)}else{n=this._validateValue(e,t)}return this.change("validateValue",n,t,e)};h.prototype._validateValue=function(e,t){var i=e.filter;var n=e.operator;var r=i.validation||{};var s=true;var o,a;if(e.operator.nb_inputs===1){t=[t]}for(var l=0;l<n.nb_inputs;l++){if(!n.multiple&&m.isArray(t[l])&&t[l].length>1){s=["operator_not_multiple",n.type,this.translate("operators",n.type)];break}switch(i.input){case"radio":if(t[l]===undefined||t[l].length===0){if(!r.allow_empty_value){s=["radio_empty"]}break}break;case"checkbox":if(t[l]===undefined||t[l].length===0){if(!r.allow_empty_value){s=["checkbox_empty"]}break}break;case"select":if(t[l]===undefined||t[l].length===0||i.placeholder&&t[l]==i.placeholder_value){if(!r.allow_empty_value){s=["select_empty"]}break}break;default:a=m.isArray(t[l])?t[l]:[t[l]];for(var c=0;c<a.length;c++){switch(h.types[i.type]){case"string":if(a[c]===undefined||a[c].length===0){if(!r.allow_empty_value){s=["string_empty"]}break}if(r.min!==undefined){if(a[c].length<parseInt(r.min)){s=[this.getValidationMessage(r,"min","string_exceed_min_length"),r.min];break}}if(r.max!==undefined){if(a[c].length>parseInt(r.max)){s=[this.getValidationMessage(r,"max","string_exceed_max_length"),r.max];break}}if(r.format){if(typeof r.format=="string"){r.format=new RegExp(r.format)}if(!r.format.test(a[c])){s=[this.getValidationMessage(r,"format","string_invalid_format"),r.format];break}}break;case"number":if(a[c]===undefined||a[c].length===0){if(!r.allow_empty_value){s=["number_nan"]}break}if(isNaN(a[c])){s=["number_nan"];break}if(i.type=="integer"){if(parseInt(a[c])!=a[c]){s=["number_not_integer"];break}}else{if(parseFloat(a[c])!=a[c]){s=["number_not_double"];break}}if(r.min!==undefined){if(a[c]<parseFloat(r.min)){s=[this.getValidationMessage(r,"min","number_exceed_min"),r.min];break}}if(r.max!==undefined){if(a[c]>parseFloat(r.max)){s=[this.getValidationMessage(r,"max","number_exceed_max"),r.max];break}}if(r.step!==undefined&&r.step!=="any"){var u=(a[c]/r.step).toPrecision(14);if(parseInt(u)!=u){s=[this.getValidationMessage(r,"step","number_wrong_step"),r.step];break}}break;case"datetime":if(a[c]===undefined||a[c].length===0){if(!r.allow_empty_value){s=["datetime_empty"]}break}if(r.format){if(!("moment"in window)){v.error("MissingLibrary","MomentJS is required for Date/Time validation. Get it here http://momentjs.com")}var d=moment(a[c],r.format);if(!d.isValid()){s=[this.getValidationMessage(r,"format","datetime_invalid"),r.format];break}else{if(r.min){if(d<moment(r.min,r.format)){s=[this.getValidationMessage(r,"min","datetime_exceed_min"),r.min];break}}if(r.max){if(d>moment(r.max,r.format)){s=[this.getValidationMessage(r,"max","datetime_exceed_max"),r.max];break}}}}break;case"boolean":if(a[c]===undefined||a[c].length===0){if(!r.allow_empty_value){s=["boolean_not_valid"]}break}o=(""+a[c]).trim().toLowerCase();if(o!=="true"&&o!=="false"&&o!=="1"&&o!=="0"&&a[c]!==1&&a[c]!==0){s=["boolean_not_valid"];break}}if(s!==true){break}}}if(s!==true){break}}if((e.operator.type==="between"||e.operator.type==="not_between")&&t.length===2){switch(h.types[i.type]){case"number":if(t[0]>t[1]){s=["number_between_invalid",t[0],t[1]]}break;case"datetime":if(r.format){if(!("moment"in window)){v.error("MissingLibrary","MomentJS is required for Date/Time validation. Get it here http://momentjs.com")}if(moment(t[0],r.format).isAfter(moment(t[1],r.format))){s=["datetime_between_invalid",t[0],t[1]]}}break}}return s};h.prototype.nextGroupId=function(){return this.status.id+"_group_"+this.status.group_id++};h.prototype.nextRuleId=function(){return this.status.id+"_rule_"+this.status.rule_id++};h.prototype.getOperators=function(i){if(typeof i=="string"){i=this.getFilterById(i)}var e=[];for(var t=0,n=this.operators.length;t<n;t++){if(i.operators){if(i.operators.indexOf(this.operators[t].type)==-1){continue}}else if(this.operators[t].apply_to.indexOf(h.types[i.type])==-1){continue}e.push(this.operators[t])}if(i.operators){e.sort(function(e,t){return i.operators.indexOf(e.type)-i.operators.indexOf(t.type)})}return this.change("getOperators",e,i)};h.prototype.getFilterById=function(e,t){if(e=="-1"){return null}for(var i=0,n=this.filters.length;i<n;i++){if(this.filters[i].id==e){return this.filters[i]}}v.error(t!==false,"UndefinedFilter",'Undefined filter "{0}"',e);return null};h.prototype.getOperatorByType=function(e,t){if(e=="-1"){return null}for(var i=0,n=this.operators.length;i<n;i++){if(this.operators[i].type==e){return this.operators[i]}}v.error(t!==false,"UndefinedOperator",'Undefined operator "{0}"',e);return null};h.prototype.getRuleInputValue=function(e){var t=e.filter;var i=e.operator;var n=[];if(t.valueGetter){n=t.valueGetter.call(this,e)}else{var r=e.$el.find(h.selectors.value_container);for(var s=0;s<i.nb_inputs;s++){var o=v.escapeElementId(e.id+"_value_"+s);var a;switch(t.input){case"radio":n.push(r.find("[name="+o+"]:checked").val());break;case"checkbox":a=[];r.find("[name="+o+"]:checked").each(function(){a.push(m(this).val())});n.push(a);break;case"select":if(t.multiple){a=[];r.find("[name="+o+"] option:selected").each(function(){a.push(m(this).val())});n.push(a)}else{n.push(r.find("[name="+o+"] option:selected").val())}break;default:n.push(r.find("[name="+o+"]").val())}}n=n.map(function(e){if(i.multiple&&t.value_separator&&typeof e=="string"){e=e.split(t.value_separator)}if(m.isArray(e)){return e.map(function(e){return v.changeType(e,t.type)})}else{return v.changeType(e,t.type)}});if(i.nb_inputs===1){n=n[0]}if(t.valueParser){n=t.valueParser.call(this,e,n)}}return this.change("getRuleValue",n,e)};h.prototype.setRuleInputValue=function(e,t){var i=e.filter;var n=e.operator;if(!i||!n){return}e._updating_input=true;if(i.valueSetter){i.valueSetter.call(this,e,t)}else{var r=e.$el.find(h.selectors.value_container);if(n.nb_inputs==1){t=[t]}for(var s=0;s<n.nb_inputs;s++){var o=v.escapeElementId(e.id+"_value_"+s);switch(i.input){case"radio":r.find("[name="+o+'][value="'+t[s]+'"]').prop("checked",true).trigger("change");break;case"checkbox":if(!m.isArray(t[s])){t[s]=[t[s]]}t[s].forEach(function(e){r.find("[name="+o+'][value="'+e+'"]').prop("checked",true).trigger("change")});break;default:if(n.multiple&&i.value_separator&&m.isArray(t[s])){t[s]=t[s].join(i.value_separator)}r.find("[name="+o+"]").val(t[s]).trigger("change");break}}}e._updating_input=false};h.prototype.parseRuleFlags=function(e){var t=m.extend({},this.settings.default_rule_flags);if(e.readonly){m.extend(t,{header_readonly:true,filter_readonly:true,operator_readonly:true,value_readonly:true,no_delete:true,no_sortable:true})}if(e.flags){m.extend(t,e.flags)}return this.change("parseRuleFlags",t,e)};h.prototype.getRuleFlags=function(i,e){if(e){return m.extend({},i)}else{var n={};m.each(this.settings.default_rule_flags,function(e,t){if(i[e]!==t){n[e]=i[e]}});return n}};h.prototype.parseGroupFlags=function(e){var t=m.extend({},this.settings.default_group_flags);if(e.readonly){m.extend(t,{condition_readonly:true,no_add_rule:true,no_add_group:true,no_delete:true})}if(e.flags){m.extend(t,e.flags)}return this.change("parseGroupFlags",t,e)};h.prototype.getGroupFlags=function(i,e){if(e){return m.extend({},i)}else{var n={};m.each(this.settings.default_group_flags,function(e,t){if(i[e]!==t){n[e]=i[e]}});return n}};h.prototype.translate=function(e,t){if(!t){t=e;e=undefined}var i;if(typeof t==="object"){i=t[this.settings.lang_code]||t["en"]}else{i=(e?this.lang[e]:this.lang)[t]||t}return this.change("translate",i,t,e)};h.prototype.getValidationMessage=function(e,t,i){return e.messages&&e.messages[t]||i};h.templates.group='<div id="{{= it.group_id }}" class="rules-group-container">   <div class="rules-group-header">     <div class="btn-group pull-right group-actions">       <button type="button" class="btn btn-xs btn-success" data-add="rule">         <i class="{{= it.icons.add_rule }}"></i> {{= it.translate("add_rule") }}       </button>       {{? it.settings.allow_groups===-1 || it.settings.allow_groups>=it.level }}         <button type="button" class="btn btn-xs btn-success" data-add="group">           <i class="{{= it.icons.add_group }}"></i> {{= it.translate("add_group") }}         </button>       {{?}}       {{? it.level>1 }}         <button type="button" class="btn btn-xs btn-danger" data-delete="group">           <i class="{{= it.icons.remove_group }}"></i> {{= it.translate("delete_group") }}         </button>       {{?}}     </div>     <div class="btn-group group-conditions">       {{~ it.conditions: condition }}         <label class="btn btn-xs btn-primary">           <input type="radio" name="{{= it.group_id }}_cond" value="{{= condition }}"> {{= it.translate("conditions", condition) }}         </label>       {{~}}     </div>     {{? it.settings.display_errors }}       <div class="error-container"><i class="{{= it.icons.error }}"></i></div>     {{?}}   </div>   <div class=rules-group-body>     <div class=rules-list></div>   </div> </div>';h.templates.rule='<div id="{{= it.rule_id }}" class="rule-container">   <div class="rule-header">     <div class="btn-group pull-right rule-actions">       <button type="button" class="btn btn-xs btn-danger" data-delete="rule">         <i class="{{= it.icons.remove_rule }}"></i> {{= it.translate("delete_rule") }}       </button>     </div>   </div>   {{? it.settings.display_errors }}     <div class="error-container"><i class="{{= it.icons.error }}"></i></div>   {{?}}   <div class="rule-filter-container"></div>   <div class="rule-operator-container"></div>   <div class="rule-value-container"></div> </div>';h.templates.filterSelect='{{ var optgroup = null; }} <select class="form-control" name="{{= it.rule.id }}_filter">   {{? it.settings.display_empty_filter }}     <option value="-1">{{= it.settings.select_placeholder }}</option>   {{?}}   {{~ it.filters: filter }}     {{? optgroup !== filter.optgroup }}       {{? optgroup !== null }}</optgroup>{{?}}       {{? (optgroup = filter.optgroup) !== null }}         <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">       {{?}}     {{?}}     <option value="{{= filter.id }}" {{? filter.icon}}data-icon="{{= filter.icon}}"{{?}}>{{= it.translate(filter.label) }}</option>   {{~}}   {{? optgroup !== null }}</optgroup>{{?}} </select>';h.templates.operatorSelect='{{? it.operators.length === 1 }} <span> {{= it.translate("operators", it.operators[0].type) }} </span> {{?}} {{ var optgroup = null; }} <select class="form-control {{? it.operators.length === 1 }}hide{{?}}" name="{{= it.rule.id }}_operator">   {{~ it.operators: operator }}     {{? optgroup !== operator.optgroup }}       {{? optgroup !== null }}</optgroup>{{?}}       {{? (optgroup = operator.optgroup) !== null }}         <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">       {{?}}     {{?}}     <option value="{{= operator.type }}" {{? operator.icon}}data-icon="{{= operator.icon}}"{{?}}>{{= it.translate("operators", operator.type) }}</option>   {{~}}   {{? optgroup !== null }}</optgroup>{{?}} </select>';h.templates.ruleValueSelect='{{ var optgroup = null; }} <select class="form-control" name="{{= it.name }}" {{? it.rule.filter.multiple }}multiple{{?}}>   {{? it.rule.filter.placeholder }}     <option value="{{= it.rule.filter.placeholder_value }}" disabled selected>{{= it.rule.filter.placeholder }}</option>   {{?}}   {{~ it.rule.filter.values: entry }}     {{? optgroup !== entry.optgroup }}       {{? optgroup !== null }}</optgroup>{{?}}       {{? (optgroup = entry.optgroup) !== null }}         <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">       {{?}}     {{?}}     <option value="{{= entry.value }}">{{= entry.label }}</option>   {{~}}   {{? optgroup !== null }}</optgroup>{{?}} </select>';h.prototype.getGroupTemplate=function(e,t){var i=this.templates.group({builder:this,group_id:e,level:t,conditions:this.settings.conditions,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getGroupTemplate",i,t)};h.prototype.getRuleTemplate=function(e){var t=this.templates.rule({builder:this,rule_id:e,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleTemplate",t)};h.prototype.getRuleFilterSelect=function(e,t){var i=this.templates.filterSelect({builder:this,rule:e,filters:t,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleFilterSelect",i,e,t)};h.prototype.getRuleOperatorSelect=function(e,t){var i=this.templates.operatorSelect({builder:this,rule:e,operators:t,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleOperatorSelect",i,e,t)};h.prototype.getRuleValueSelect=function(e,t){var i=this.templates.ruleValueSelect({builder:this,name:e,rule:t,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleValueSelect",i,e,t)};h.prototype.getRuleInput=function(e,t){var i=e.filter;var n=e.filter.validation||{};var r=e.id+"_value_"+t;var s=i.vertical?" class=block":"";var o="";if(typeof i.input=="function"){o=i.input.call(this,e,r)}else{switch(i.input){case"radio":case"checkbox":v.iterateOptions(i.values,function(e,t){o+="<label"+s+'><input type="'+i.input+'" name="'+r+'" value="'+e+'"> '+t+"</label> "});break;case"select":o=this.getRuleValueSelect(r,e);break;case"textarea":o+='<textarea class="form-control" name="'+r+'"';if(i.size)o+=' cols="'+i.size+'"';if(i.rows)o+=' rows="'+i.rows+'"';if(n.min!==undefined)o+=' minlength="'+n.min+'"';if(n.max!==undefined)o+=' maxlength="'+n.max+'"';if(i.placeholder)o+=' placeholder="'+i.placeholder+'"';o+="></textarea>";break;case"number":o+='<input class="form-control" type="number" name="'+r+'"';if(n.step!==undefined)o+=' step="'+n.step+'"';if(n.min!==undefined)o+=' min="'+n.min+'"';if(n.max!==undefined)o+=' max="'+n.max+'"';if(i.placeholder)o+=' placeholder="'+i.placeholder+'"';if(i.size)o+=' size="'+i.size+'"';o+=">";break;default:o+='<input class="form-control" type="text" name="'+r+'"';if(i.placeholder)o+=' placeholder="'+i.placeholder+'"';if(i.type==="string"&&n.min!==undefined)o+=' minlength="'+n.min+'"';if(i.type==="string"&&n.max!==undefined)o+=' maxlength="'+n.max+'"';if(i.size)o+=' size="'+i.size+'"';o+=">"}}return this.change("getRuleInput",o,e,r)};var v={};h.utils=v;v.iterateOptions=function(e,i){if(e){if(m.isArray(e)){e.forEach(function(e){if(m.isPlainObject(e)){if("value"in e){i(e.value,e.label||e.value,e.optgroup)}else{m.each(e,function(e,t){i(e,t);return false})}}else{i(e,e)}})}else{m.each(e,function(e,t){i(e,t)})}}};v.fmt=function(e,i){if(!Array.isArray(i)){i=Array.prototype.slice.call(arguments,1)}return e.replace(/{([0-9]+)}/g,function(e,t){return i[parseInt(t)]})};v.error=function(){var e=0;var t=typeof arguments[e]==="boolean"?arguments[e++]:true;var i=arguments[e++];var n=arguments[e++];var r=Array.isArray(arguments[e])?arguments[e]:Array.prototype.slice.call(arguments,e);if(t){var s=new Error(v.fmt(n,r));s.name=i+"Error";s.args=r;throw s}else{console.error(i+"Error: "+v.fmt(n,r))}};v.changeType=function(e,t){if(e===""||e===undefined){return undefined}switch(t){case"integer":if(typeof e==="string"&&!/^-?\d+$/.test(e)){return e}return parseInt(e);case"double":if(typeof e==="string"&&!/^-?\d+\.?\d*$/.test(e)){return e}return parseFloat(e);case"boolean":if(typeof e==="string"&&!/^(0|1|true|false){1}$/i.test(e)){return e}return e===true||e===1||e.toLowerCase()==="true"||e==="1";default:return e}};v.escapeString=function(e){if(typeof e!="string"){return e}return e.replace(/[\0\n\r\b\\\'\"]/g,function(e){switch(e){case"\0":return"\\0";case"\n":return"\\n";case"\r":return"\\r";case"\b":return"\\b";default:return"\\"+e}}).replace(/\t/g,"\\t").replace(/\x1a/g,"\\Z")};v.escapeRegExp=function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")};v.escapeElementId=function(e){return e?e.replace(/(\\)?([:.\[\],])/g,function(e,t,i){return t?e:"\\"+i}):e};v.groupSort=function(e,i){var n=[];var r=[];e.forEach(function(e){var t;if(e[i]){t=n.lastIndexOf(e[i]);if(t==-1){t=n.length}else{t++}}else{t=n.length}n.splice(t,0,e[i]);r.splice(t,0,e)});return r};v.defineModelProperties=function(e,t){t.forEach(function(i){Object.defineProperty(e.prototype,i,{enumerable:true,get:function(){return this.__[i]},set:function(e){var t=this.__[i]!==null&&typeof this.__[i]=="object"?m.extend({},this.__[i]):this.__[i];this.__[i]=e;if(this.model!==null){this.model.trigger("update",this,i,e,t)}}})})};function n(){this.root=null;this.$=m(this)}m.extend(n.prototype,{trigger:function(e){var t=new m.Event(e);this.$.triggerHandler(t,Array.prototype.slice.call(arguments,1));return t},on:function(){this.$.on.apply(this.$,Array.prototype.slice.call(arguments));return this},off:function(){this.$.off.apply(this.$,Array.prototype.slice.call(arguments));return this},once:function(){this.$.one.apply(this.$,Array.prototype.slice.call(arguments));return this}});var r=function(e,t){if(!(this instanceof r)){return new r(e,t)}Object.defineProperty(this,"__",{value:{}});t.data("queryBuilderModel",this);this.__.level=1;this.__.error=null;this.__.flags={};this.__.data=undefined;this.$el=t;this.id=t[0].id;this.model=null;this.parent=e};v.defineModelProperties(r,["level","error","data","flags"]);Object.defineProperty(r.prototype,"parent",{enumerable:true,get:function(){return this.__.parent},set:function(e){this.__.parent=e;this.level=e===null?1:e.level+1;this.model=e===null?null:e.model}});r.prototype.isRoot=function(){return this.level===1};r.prototype.getPos=function(){if(this.isRoot()){return-1}else{return this.parent.getNodePos(this)}};r.prototype.drop=function(){var e=this.model;if(!!this.parent){this.parent.removeNode(this)}this.$el.removeData("queryBuilderModel");if(e!==null){e.trigger("drop",this)}};r.prototype.moveAfter=function(e){if(!this.isRoot()){this.move(e.parent,e.getPos()+1)}};r.prototype.moveAtBegin=function(e){if(!this.isRoot()){if(e===undefined){e=this.parent}this.move(e,0)}};r.prototype.moveAtEnd=function(e){if(!this.isRoot()){if(e===undefined){e=this.parent}this.move(e,e.length()===0?0:e.length()-1)}};r.prototype.move=function(e,t){if(!this.isRoot()){if(typeof e==="number"){t=e;e=this.parent}this.parent.removeNode(this);e.insertNode(this,t,false);if(this.model!==null){this.model.trigger("move",this,e,t)}}};var c=function(e,t){if(!(this instanceof c)){return new c(e,t)}r.call(this,e,t);this.rules=[];this.__.condition=null};c.prototype=Object.create(r.prototype);c.prototype.constructor=c;v.defineModelProperties(c,["condition"]);c.prototype.empty=function(){this.each("reverse",function(e){e.drop()},function(e){e.drop()})};c.prototype.drop=function(){this.empty();r.prototype.drop.call(this)};c.prototype.length=function(){return this.rules.length};c.prototype.insertNode=function(e,t,i){if(t===undefined){t=this.length()}this.rules.splice(t,0,e);e.parent=this;if(i&&this.model!==null){this.model.trigger("add",this,e,t)}return e};c.prototype.addGroup=function(e,t){return this.insertNode(new c(this,e),t,true)};c.prototype.addRule=function(e,t){return this.insertNode(new o(this,e),t,true)};c.prototype.removeNode=function(e){var t=this.getNodePos(e);if(t!==-1){e.parent=null;this.rules.splice(t,1)}};c.prototype.getNodePos=function(e){return this.rules.indexOf(e)};c.prototype.each=function(e,t,i,n){if(typeof e!=="boolean"&&typeof e!=="string"){n=i;i=t;t=e;e=false}n=n===undefined?null:n;var r=e?this.rules.length-1:0;var s=e?0:this.rules.length-1;var o=e?-1:1;var a=function(){return e?r>=s:r<=s};var l=false;for(;a();r+=o){if(this.rules[r]instanceof c){if(!!i){l=i.call(n,this.rules[r])===false}}else if(!!t){l=t.call(n,this.rules[r])===false}if(l){break}}return!l};c.prototype.contains=function(t,e){if(this.getNodePos(t)!==-1){return true}else if(!e){return false}else{return!this.each(function(){return true},function(e){return!e.contains(t,true)})}};var o=function(e,t){if(!(this instanceof o)){return new o(e,t)}r.call(this,e,t);this._updating_value=false;this._updating_input=false;this.__.filter=null;this.__.operator=null;this.__.value=undefined};o.prototype=Object.create(r.prototype);o.prototype.constructor=o;v.defineModelProperties(o,["filter","operator","value"]);o.prototype.isRoot=function(){return false};h.Group=c;h.Rule=o;m.fn.queryBuilder=function(e){if(this.length===0){v.error("Config","No target defined")}if(this.length>1){v.error("Config","Unable to initialize on multiple target")}var t=this.data("queryBuilder");var i=typeof e=="object"&&e||{};if(!t&&e=="destroy"){return this}if(!t){var n=new h(this,i);this.data("queryBuilder",n);n.init(i.rules)}if(typeof e=="string"){return t[e].apply(t,Array.prototype.slice.call(arguments,1))}return this};m.fn.queryBuilder.constructor=h;m.fn.queryBuilder.defaults=h.defaults;m.fn.queryBuilder.extend=h.extend;m.fn.queryBuilder.define=h.define;m.fn.queryBuilder.regional=h.regional;h.define("bt-checkbox",function(c){if(c.font=="glyphicons"){this.$el.addClass("bt-checkbox-glyphicons")}this.on("getRuleInput.filter",function(r,e,s){var o=e.filter;if((o.input==="radio"||o.input==="checkbox")&&!o.plugin){r.value="";if(!o.colors){o.colors={}}if(o.color){o.colors._def_=o.color}var a=o.vertical?' style="display:block"':"";var l=0;v.iterateOptions(o.values,function(e,t){var i=o.colors[e]||o.colors._def_||c.color;var n=s+"_"+l++;r.value+="<div"+a+' class="'+o.input+" "+o.input+"-"+i+'">   <input type="'+o.input+'" name="'+s+'" id="'+n+'" value="'+e+'">   <label for="'+n+'">'+t+"</label> </div>"})}})},{font:"glyphicons",color:"default"});h.define("bt-selectpicker",function(i){if(!m.fn.selectpicker||!m.fn.selectpicker.Constructor){v.error("MissingLibrary",'Bootstrap Select is required to use "bt-selectpicker" plugin. Get it here: http://silviomoreto.github.io/bootstrap-select')}var n=h.selectors;this.on("afterCreateRuleFilters",function(e,t){t.$el.find(n.rule_filter).removeClass("form-control").selectpicker(i)});this.on("afterCreateRuleOperators",function(e,t){t.$el.find(n.rule_operator).removeClass("form-control").selectpicker(i)});this.on("afterUpdateRuleFilter",function(e,t){t.$el.find(n.rule_filter).selectpicker("render")});this.on("afterUpdateRuleOperator",function(e,t){t.$el.find(n.rule_operator).selectpicker("render")});this.on("beforeDeleteRule",function(e,t){t.$el.find(n.rule_filter).selectpicker("destroy");t.$el.find(n.rule_operator).selectpicker("destroy")})},{container:"body",style:"btn-inverse btn-xs",width:"auto",showIcon:false});h.define("bt-tooltip-errors",function(n){if(!m.fn.tooltip||!m.fn.tooltip.Constructor||!m.fn.tooltip.Constructor.prototype.fixTitle){v.error("MissingLibrary",'Bootstrap Tooltip is required to use "bt-tooltip-errors" plugin. Get it here: http://getbootstrap.com')}var r=this;this.on("getRuleTemplate.filter getGroupTemplate.filter",function(e){var t=m(e.value);t.find(h.selectors.error_container).attr("data-toggle","tooltip");e.value=t.prop("outerHTML")});this.model.on("update",function(e,t,i){if(i=="error"&&r.settings.display_errors){t.$el.find(h.selectors.error_container).eq(0).tooltip(n).tooltip("hide").tooltip("fixTitle")}})},{placement:"right"});h.extend({setFilters:function(e,t){var i=this;if(t===undefined){t=e;e=false}t=this.checkFilters(t);t=this.change("setFilters",t);var n=t.map(function(e){return e.id});if(!e){(function e(t){t.each(function(e){if(e.filter&&n.indexOf(e.filter.id)===-1){v.error("ChangeFilter",'A rule is using filter "{0}"',e.filter.id)}},e)})(this.model.root)}this.filters=t;(function e(t){t.each(true,function(e){if(e.filter&&n.indexOf(e.filter.id)===-1){e.drop();i.trigger("rulesChanged")}else{i.createRuleFilters(e);e.$el.find(h.selectors.rule_filter).val(e.filter?e.filter.id:"-1");i.trigger("afterUpdateRuleFilter",e)}},e)})(this.model.root);if(this.settings.plugins){if(this.settings.plugins["unique-filter"]){this.updateDisabledFilters()}if(this.settings.plugins["bt-selectpicker"]){this.$el.find(h.selectors.rule_filter).selectpicker("render")}}if(this.settings.default_filter){try{this.getFilterById(this.settings.default_filter)}catch(e){this.settings.default_filter=null}}this.trigger("afterSetFilters",t)},addFilter:function(e,i){if(i===undefined||i=="#end"){i=this.filters.length}else if(i=="#start"){i=0}if(!m.isArray(e)){e=[e]}var t=m.extend(true,[],this.filters);if(parseInt(i)==i){Array.prototype.splice.apply(t,[i,0].concat(e))}else{if(this.filters.some(function(e,t){if(e.id==i){i=t+1;return true}})){Array.prototype.splice.apply(t,[i,0].concat(e))}else{Array.prototype.push.apply(t,e)}}this.setFilters(t)},removeFilter:function(t,e){var i=m.extend(true,[],this.filters);if(typeof t==="string"){t=[t]}i=i.filter(function(e){return t.indexOf(e.id)===-1});this.setFilters(e,i)}});h.define("chosen-selectpicker",function(i){if(!m.fn.chosen){v.error("MissingLibrary",'chosen is required to use "chosen-selectpicker" plugin. Get it here: https://github.com/harvesthq/chosen')}if(this.settings.plugins["bt-selectpicker"]){v.error("Conflict","bt-selectpicker is already selected as the dropdown plugin. Please remove chosen-selectpicker from the plugin list")}var n=h.selectors;this.on("afterCreateRuleFilters",function(e,t){t.$el.find(n.rule_filter).removeClass("form-control").chosen(i)});this.on("afterCreateRuleOperators",function(e,t){t.$el.find(n.rule_operator).removeClass("form-control").chosen(i)});this.on("afterUpdateRuleFilter",function(e,t){t.$el.find(n.rule_filter).trigger("chosen:updated")});this.on("afterUpdateRuleOperator",function(e,t){t.$el.find(n.rule_operator).trigger("chosen:updated")});this.on("beforeDeleteRule",function(e,t){t.$el.find(n.rule_filter).chosen("destroy");t.$el.find(n.rule_operator).chosen("destroy")})});h.define("filter-description",function(r){if(r.mode==="inline"){this.on("afterUpdateRuleFilter afterUpdateRuleOperator",function(e,t){var i=t.$el.find("p.filter-description");var n=e.builder.getFilterDescription(t.filter,t);if(!n){i.hide()}else{if(i.length===0){i=m('<p class="filter-description"></p>');i.appendTo(t.$el)}else{i.css("display","")}i.html('<i class="'+r.icon+'"></i> '+n)}})}else if(r.mode==="popover"){if(!m.fn.popover||!m.fn.popover.Constructor||!m.fn.popover.Constructor.prototype.fixTitle){v.error("MissingLibrary",'Bootstrap Popover is required to use "filter-description" plugin. Get it here: http://getbootstrap.com')}this.on("afterUpdateRuleFilter afterUpdateRuleOperator",function(e,t){var i=t.$el.find("button.filter-description");var n=e.builder.getFilterDescription(t.filter,t);if(!n){i.hide();if(i.data("bs.popover")){i.popover("hide")}}else{if(i.length===0){i=m('<button type="button" class="btn btn-xs btn-info filter-description" data-toggle="popover"><i class="'+r.icon+'"></i></button>');i.prependTo(t.$el.find(h.selectors.rule_actions));i.popover({placement:"left",container:"body",html:true});i.on("mouseout",function(){i.popover("hide")})}else{i.css("display","")}i.data("bs.popover").options.content=n;if(i.attr("aria-describedby")){i.popover("show")}}})}else if(r.mode==="bootbox"){if(!("bootbox"in window)){v.error("MissingLibrary",'Bootbox is required to use "filter-description" plugin. Get it here: http://bootboxjs.com')}this.on("afterUpdateRuleFilter afterUpdateRuleOperator",function(e,t){var i=t.$el.find("button.filter-description");var n=e.builder.getFilterDescription(t.filter,t);if(!n){i.hide()}else{if(i.length===0){i=m('<button type="button" class="btn btn-xs btn-info filter-description" data-toggle="bootbox"><i class="'+r.icon+'"></i></button>');i.prependTo(t.$el.find(h.selectors.rule_actions));i.on("click",function(){bootbox.alert(i.data("description"))})}else{i.css("display","")}i.data("description",n)}})}},{icon:"glyphicon glyphicon-info-sign",mode:"popover"});h.extend({getFilterDescription:function(e,t){if(!e){return undefined}else if(typeof e.description=="function"){return e.description.call(this,t)}else{return e.description}}});h.define("invert",function(i){var n=this;var r=h.selectors;this.on("afterInit",function(){n.$el.on("click.queryBuilder","[data-invert=group]",function(){var e=m(this).closest(r.group_container);n.invert(n.getModel(e),i)});if(i.display_rules_button&&i.invert_rules){n.$el.on("click.queryBuilder","[data-invert=rule]",function(){var e=m(this).closest(r.rule_container);n.invert(n.getModel(e),i)})}});if(!i.disable_template){this.on("getGroupTemplate.filter",function(e){var t=m(e.value);t.find(r.condition_container).after('<button type="button" class="btn btn-xs btn-default" data-invert="group">'+'<i class="'+i.icon+'"></i> '+n.translate("invert")+"</button>");e.value=t.prop("outerHTML")});if(i.display_rules_button&&i.invert_rules){this.on("getRuleTemplate.filter",function(e){var t=m(e.value);t.find(r.rule_actions).prepend('<button type="button" class="btn btn-xs btn-default" data-invert="rule">'+'<i class="'+i.icon+'"></i> '+n.translate("invert")+"</button>");e.value=t.prop("outerHTML")})}}},{icon:"glyphicon glyphicon-random",recursive:true,invert_rules:true,display_rules_button:false,silent_fail:false,disable_template:false});h.defaults({operatorOpposites:{equal:"not_equal",not_equal:"equal",in:"not_in",not_in:"in",less:"greater_or_equal",less_or_equal:"greater",greater:"less_or_equal",greater_or_equal:"less",between:"not_between",not_between:"between",begins_with:"not_begins_with",not_begins_with:"begins_with",contains:"not_contains",not_contains:"contains",ends_with:"not_ends_with",not_ends_with:"ends_with",is_empty:"is_not_empty",is_not_empty:"is_empty",is_null:"is_not_null",is_not_null:"is_null"},conditionOpposites:{AND:"OR",OR:"AND"}});h.extend({invert:function(e,t){if(!(e instanceof r)){if(!this.model.root)return;t=e;e=this.model.root}if(typeof t!="object")t={};if(t.recursive===undefined)t.recursive=true;if(t.invert_rules===undefined)t.invert_rules=true;if(t.silent_fail===undefined)t.silent_fail=false;if(t.trigger===undefined)t.trigger=true;if(e instanceof c){if(this.settings.conditionOpposites[e.condition]){e.condition=this.settings.conditionOpposites[e.condition]}else if(!t.silent_fail){v.error("InvertCondition",'Unknown inverse of condition "{0}"',e.condition)}if(t.recursive){var i=m.extend({},t,{trigger:false});e.each(function(e){if(t.invert_rules){this.invert(e,i)}},function(e){this.invert(e,i)},this)}}else if(e instanceof o){if(e.operator&&!e.filter.no_invert){if(this.settings.operatorOpposites[e.operator.type]){var n=this.settings.operatorOpposites[e.operator.type];if(!e.filter.operators||e.filter.operators.indexOf(n)!=-1){e.operator=this.getOperatorByType(n)}}else if(!t.silent_fail){v.error("InvertOperator",'Unknown inverse of operator "{0}"',e.operator.type)}}}if(t.trigger){this.trigger("afterInvert",e,t);this.trigger("rulesChanged")}}});h.defaults({mongoOperators:{equal:function(e){return e[0]},not_equal:function(e){return{$ne:e[0]}},in:function(e){return{$in:e}},not_in:function(e){return{$nin:e}},less:function(e){return{$lt:e[0]}},less_or_equal:function(e){return{$lte:e[0]}},greater:function(e){return{$gt:e[0]}},greater_or_equal:function(e){return{$gte:e[0]}},between:function(e){return{$gte:e[0],$lte:e[1]}},not_between:function(e){return{$lt:e[0],$gt:e[1]}},begins_with:function(e){return{$regex:"^"+v.escapeRegExp(e[0])}},not_begins_with:function(e){return{$regex:"^(?!"+v.escapeRegExp(e[0])+")"}},contains:function(e){return{$regex:v.escapeRegExp(e[0])}},not_contains:function(e){return{$regex:"^((?!"+v.escapeRegExp(e[0])+").)*$",$options:"s"}},ends_with:function(e){return{$regex:v.escapeRegExp(e[0])+"$"}},not_ends_with:function(e){return{$regex:"(?<!"+v.escapeRegExp(e[0])+")$"}},is_empty:function(e){return""},is_not_empty:function(e){return{$ne:""}},is_null:function(e){return null},is_not_null:function(e){return{$ne:null}}},mongoRuleOperators:{$eq:function(e){return{val:e,op:e===null?"is_null":e===""?"is_empty":"equal"}},$ne:function(e){e=e.$ne;return{val:e,op:e===null?"is_not_null":e===""?"is_not_empty":"not_equal"}},$regex:function(e){e=e.$regex;if(e.slice(0,4)=="^(?!"&&e.slice(-1)==")"){return{val:e.slice(4,-1),op:"not_begins_with"}}else if(e.slice(0,5)=="^((?!"&&e.slice(-5)==").)*$"){return{val:e.slice(5,-5),op:"not_contains"}}else if(e.slice(0,4)=="(?<!"&&e.slice(-2)==")$"){return{val:e.slice(4,-2),op:"not_ends_with"}}else if(e.slice(-1)=="$"){return{val:e.slice(0,-1),op:"ends_with"}}else if(e.slice(0,1)=="^"){return{val:e.slice(1),op:"begins_with"}}else{return{val:e,op:"contains"}}},between:function(e){return{val:[e.$gte,e.$lte],op:"between"}},not_between:function(e){return{val:[e.$lt,e.$gt],op:"not_between"}},$in:function(e){return{val:e.$in,op:"in"}},$nin:function(e){return{val:e.$nin,op:"not_in"}},$lt:function(e){return{val:e.$lt,op:"less"}},$lte:function(e){return{val:e.$lte,op:"less_or_equal"}},$gt:function(e){return{val:e.$gt,op:"greater"}},$gte:function(e){return{val:e.$gte,op:"greater_or_equal"}}}});h.extend({getMongo:function(e){e=e===undefined?this.getRules():e;if(!e){return null}var a=this;return function s(e){if(!e.condition){e.condition=a.settings.default_condition}if(["AND","OR"].indexOf(e.condition.toUpperCase())===-1){v.error("UndefinedMongoCondition",'Unable to build MongoDB query with condition "{0}"',e.condition)}if(!e.rules){return{}}var o=[];e.rules.forEach(function(e){if(e.rules&&e.rules.length>0){o.push(s(e))}else{var t=a.settings.mongoOperators[e.operator];var i=a.getOperatorByType(e.operator);if(t===undefined){v.error("UndefinedMongoOperator",'Unknown MongoDB operation for operator "{0}"',e.operator)}if(i.nb_inputs!==0){if(!(e.value instanceof Array)){e.value=[e.value]}}var n=a.change("getMongoDBField",e.field,e);var r={};r[n]=t.call(a,e.value);o.push(a.change("ruleToMongo",r,e,e.value,t))}});var t={};t["$"+e.condition.toLowerCase()]=o;return a.change("groupToMongo",t,e)}(e)},getRulesFromMongo:function(e){if(e===undefined||e===null){return null}var d=this;e=d.change("parseMongoNode",e);if("rules"in e&&"condition"in e){return e}if("id"in e&&"operator"in e&&"value"in e){return{condition:this.settings.default_condition,rules:[e]}}var t=d.getMongoCondition(e);if(!t){v.error("MongoParse","Invalid MongoDB query format")}return function c(e,t){var i=e[t];var u=[];i.forEach(function(e){e=d.change("parseMongoNode",e);if("rules"in e&&"condition"in e){u.push(e);return}if("id"in e&&"operator"in e&&"value"in e){u.push(e);return}var t=d.getMongoCondition(e);if(t){u.push(c(e,t))}else{var i=Object.keys(e)[0];var n=e[i];var r=d.getMongoOperator(n);if(r===undefined){v.error("MongoParse","Invalid MongoDB query format")}var s=d.settings.mongoRuleOperators[r];if(s===undefined){v.error("UndefinedMongoOperator",'JSON Rule operation unknown for operator "{0}"',r)}var o=s.call(d,n);var a=d.getMongoDBFieldID(i,n);var l=d.change("mongoToRule",{id:a,field:i,operator:o.op,value:o.val},e);u.push(l)}});return d.change("mongoToGroup",{condition:t.replace("$","").toUpperCase(),rules:u},e)}(e,t)},setRulesFromMongo:function(e){this.setRules(this.getRulesFromMongo(e))},getMongoDBFieldID:function(t,e){var i=this.filters.filter(function(e){return e.field===t});var n;if(i.length===1){n=i[0].id}else{n=this.change("getMongoDBFieldID",t,e)}return n},getMongoOperator:function(e){if(e!==null&&typeof e==="object"){if(e.$gte!==undefined&&e.$lte!==undefined){return"between"}if(e.$lt!==undefined&&e.$gt!==undefined){return"not_between"}var t=Object.keys(e).filter(function(e){return!!this.settings.mongoRuleOperators[e]}.bind(this));if(t.length===1){return t[0]}}else{return"$eq"}},getMongoCondition:function(e){var t=Object.keys(e);for(var i=0,n=t.length;i<n;i++){if(t[i].toLowerCase()==="$or"||t[i].toLowerCase()==="$and"){return t[i]}}}});h.define("not-group",function(i){var n=this;this.on("afterInit",function(){n.$el.on("click.queryBuilder","[data-not=group]",function(){var e=m(this).closest(h.selectors.group_container);var t=n.getModel(e);t.not=!t.not});n.model.on("update",function(e,t,i){if(t instanceof c&&i==="not"){n.updateGroupNot(t)}})});this.on("afterAddGroup",function(e,t){t.__.not=false});if(!i.disable_template){this.on("getGroupTemplate.filter",function(e){var t=m(e.value);t.find(h.selectors.condition_container).prepend('<button type="button" class="btn btn-xs btn-default" data-not="group">'+'<i class="'+i.icon_unchecked+'"></i> '+n.translate("NOT")+"</button>");e.value=t.prop("outerHTML")})}this.on("groupToJson.filter",function(e,t){e.value.not=t.not});this.on("jsonToGroup.filter",function(e,t){e.value.not=!!t.not});this.on("groupToSQL.filter",function(e,t){if(t.not){e.value="NOT ( "+e.value+" )"}});this.on("parseSQLNode.filter",function(e){if(e.value.name&&e.value.name.toUpperCase()=="NOT"){e.value=e.value.arguments.value[0];if(["AND","OR"].indexOf(e.value.operation.toUpperCase())===-1){e.value=new SQLParser.nodes.Op(n.settings.default_condition,e.value,null)}e.value.not=true}});this.on("sqlGroupsDistinct.filter",function(e,t,i,n){if(i.not&&n>0){e.value=true}});this.on("sqlToGroup.filter",function(e,t){e.value.not=!!t.not});this.on("groupToMongo.filter",function(e,t){var i="$"+t.condition.toLowerCase();if(t.not&&e.value[i]){e.value={$nor:[e.value]}}});this.on("parseMongoNode.filter",function(e){var t=Object.keys(e.value);if(t[0]=="$nor"){e.value=e.value[t[0]][0];e.value.not=true}});this.on("mongoToGroup.filter",function(e,t){e.value.not=!!t.not})},{icon_unchecked:"glyphicon glyphicon-unchecked",icon_checked:"glyphicon glyphicon-check",disable_template:false});v.defineModelProperties(c,["not"]);h.selectors.group_not=h.selectors.group_header+" [data-not=group]";h.extend({updateGroupNot:function(e){var t=this.plugins["not-group"];e.$el.find(">"+h.selectors.group_not).toggleClass("active",e.not).find("i").attr("class",e.not?t.icon_checked:t.icon_unchecked);this.trigger("afterUpdateGroupNot",e);this.trigger("rulesChanged")}});h.define("sortable",function(n){if(!("interact"in window)){v.error("MissingLibrary",'interact.js is required to use "sortable" plugin. Get it here: http://interactjs.io')}if(n.default_no_sortable!==undefined){v.error(false,"Config",'Sortable plugin : "default_no_sortable" options is deprecated, use standard "default_rule_flags" and "default_group_flags" instead');this.settings.default_rule_flags.no_sortable=this.settings.default_group_flags.no_sortable=n.default_no_sortable}interact.dynamicDrop(true);interact.pointerMoveTolerance(10);var r;var s;var o;var a;this.on("afterAddRule afterAddGroup",function(e,t){if(t==r){return}var i=e.builder;if(n.inherit_no_sortable&&t.parent&&t.parent.flags.no_sortable){t.flags.no_sortable=true}if(n.inherit_no_drop&&t.parent&&t.parent.flags.no_drop){t.flags.no_drop=true}if(!t.flags.no_sortable){interact(t.$el[0]).draggable({allowFrom:h.selectors.drag_handle,onstart:function(e){a=false;o=i.getModel(e.target);s=o.$el.clone().appendTo(o.$el.parent()).width(o.$el.outerWidth()).addClass("dragging");var t=m('<div class="rule-placeholder">&nbsp;</div>').height(o.$el.outerHeight());r=o.parent.addRule(t,o.getPos());o.$el.hide()},onmove:function(e){s[0].style.top=e.clientY-15+"px";s[0].style.left=e.clientX-15+"px"},onend:function(e){if(e.dropzone){l(o,m(e.relatedTarget),i);a=true}s.remove();s=undefined;r.drop();r=undefined;o.$el.css("display","");i.trigger("afterMove",o);i.trigger("rulesChanged")}})}if(!t.flags.no_drop){interact(t.$el[0]).dropzone({accept:h.selectors.rule_and_group_containers,ondragenter:function(e){l(r,m(e.target),i)},ondrop:function(e){if(!a){l(o,m(e.target),i)}}});if(t instanceof c){interact(t.$el.find(h.selectors.group_header)[0]).dropzone({accept:h.selectors.rule_and_group_containers,ondragenter:function(e){l(r,m(e.target),i)},ondrop:function(e){if(!a){l(o,m(e.target),i)}}})}}});this.on("beforeDeleteRule beforeDeleteGroup",function(e,t){if(!e.isDefaultPrevented()){interact(t.$el[0]).unset();if(t instanceof c){interact(t.$el.find(h.selectors.group_header)[0]).unset()}}});this.on("afterApplyRuleFlags afterApplyGroupFlags",function(e,t){if(t.flags.no_sortable){t.$el.find(".drag-handle").remove()}});if(!n.disable_template){this.on("getGroupTemplate.filter",function(e,t){if(t>1){var i=m(e.value);i.find(h.selectors.condition_container).after('<div class="drag-handle"><i class="'+n.icon+'"></i></div>');e.value=i.prop("outerHTML")}});this.on("getRuleTemplate.filter",function(e){var t=m(e.value);t.find(h.selectors.rule_header).after('<div class="drag-handle"><i class="'+n.icon+'"></i></div>');e.value=t.prop("outerHTML")})}},{inherit_no_sortable:true,inherit_no_drop:true,icon:"glyphicon glyphicon-sort",disable_template:false});h.selectors.rule_and_group_containers=h.selectors.rule_container+", "+h.selectors.group_container;h.selectors.drag_handle=".drag-handle";h.defaults({default_rule_flags:{no_sortable:false,no_drop:false},default_group_flags:{no_sortable:false,no_drop:false}});function l(e,t,i){var n,r;var s=h.selectors;n=t.closest(s.rule_container);if(n.length){r="moveAfter"}if(!r){n=t.closest(s.group_header);if(n.length){n=t.closest(s.group_container);r="moveAtBegin"}}if(!r){n=t.closest(s.group_container);if(n.length){r="moveAtEnd"}}if(r){e[r](i.getModel(n));if(i&&e instanceof o){i.setRuleInputValue(e,e.value)}}}h.define("sql-support",function(e){},{boolean_as_integer:true});h.defaults({sqlOperators:{equal:{op:"= ?"},not_equal:{op:"!= ?"},in:{op:"IN(?)",sep:", "},not_in:{op:"NOT IN(?)",sep:", "},less:{op:"< ?"},less_or_equal:{op:"<= ?"},greater:{op:"> ?"},greater_or_equal:{op:">= ?"},between:{op:"BETWEEN ?",sep:" AND "},not_between:{op:"NOT BETWEEN ?",sep:" AND "},begins_with:{op:"LIKE(?)",mod:"{0}%"},not_begins_with:{op:"NOT LIKE(?)",mod:"{0}%"},contains:{op:"LIKE(?)",mod:"%{0}%"},not_contains:{op:"NOT LIKE(?)",mod:"%{0}%"},ends_with:{op:"LIKE(?)",mod:"%{0}"},not_ends_with:{op:"NOT LIKE(?)",mod:"%{0}"},is_empty:{op:"= ''"},is_not_empty:{op:"!= ''"},is_null:{op:"IS NULL"},is_not_null:{op:"IS NOT NULL"}},sqlRuleOperator:{"=":function(e){return{val:e,op:e===""?"is_empty":"equal"}},"!=":function(e){return{val:e,op:e===""?"is_not_empty":"not_equal"}},LIKE:function(e){if(e.slice(0,1)=="%"&&e.slice(-1)=="%"){return{val:e.slice(1,-1),op:"contains"}}else if(e.slice(0,1)=="%"){return{val:e.slice(1),op:"ends_with"}}else if(e.slice(-1)=="%"){return{val:e.slice(0,-1),op:"begins_with"}}else{v.error("SQLParse",'Invalid value for LIKE operator "{0}"',e)}},"NOT LIKE":function(e){if(e.slice(0,1)=="%"&&e.slice(-1)=="%"){return{val:e.slice(1,-1),op:"not_contains"}}else if(e.slice(0,1)=="%"){return{val:e.slice(1),op:"not_ends_with"}}else if(e.slice(-1)=="%"){return{val:e.slice(0,-1),op:"not_begins_with"}}else{v.error("SQLParse",'Invalid value for NOT LIKE operator "{0}"',e)}},IN:function(e){return{val:e,op:"in"}},"NOT IN":function(e){return{val:e,op:"not_in"}},"<":function(e){return{val:e,op:"less"}},"<=":function(e){return{val:e,op:"less_or_equal"}},">":function(e){return{val:e,op:"greater"}},">=":function(e){return{val:e,op:"greater_or_equal"}},BETWEEN:function(e){return{val:e,op:"between"}},"NOT BETWEEN":function(e){return{val:e,op:"not_between"}},IS:function(e){if(e!==null){v.error("SQLParse","Invalid value for IS operator")}return{val:null,op:"is_null"}},"IS NOT":function(e){if(e!==null){v.error("SQLParse","Invalid value for IS operator")}return{val:null,op:"is_not_null"}}},sqlStatements:{question_mark:function(){var i=[];return{add:function(e,t){i.push(t);return"?"},run:function(){return i}}},numbered:function(i){if(!i||i.length>1)i="$";var n=0;var r=[];return{add:function(e,t){r.push(t);n++;return i+n},run:function(){return r}}},named:function(n){if(!n||n.length>1)n=":";var r={};var s={};return{add:function(e,t){if(!r[e.field])r[e.field]=1;var i=e.field+"_"+r[e.field]++;s[i]=t;return n+i},run:function(){return s}}}},sqlRuleStatement:{question_mark:function(t){var i=0;return{parse:function(e){return e=="?"?t[i++]:e},esc:function(e){return e.replace(/\?/g,"'?'")}}},numbered:function(t,i){if(!i||i.length>1)i="$";var n=new RegExp("^\\"+i+"[0-9]+$");var r=new RegExp("\\"+i+"([0-9]+)","g");return{parse:function(e){return n.test(e)?t[e.slice(1)-1]:e},esc:function(e){return e.replace(r,"'"+(i=="$"?"$$":i)+"$1'")}}},named:function(t,i){if(!i||i.length>1)i=":";var n=new RegExp("^\\"+i);var r=new RegExp("\\"+i+"("+Object.keys(t).join("|")+")","g");return{parse:function(e){return n.test(e)?t[e.slice(1)]:e},esc:function(e){return e.replace(r,"'"+(i=="$"?"$$":i)+"$1'")}}}}});h.extend({getSQL:function(c,u,e){e=e===undefined?this.getRules():e;if(!e){return null}u=!!u?"\n":" ";var d=this.getPluginOptions("sql-support","boolean_as_integer");if(c===true){c="question_mark"}if(typeof c=="string"){var t=s(c);c=this.settings.sqlStatements[t[1]](t[2])}var h=this;var i=function a(e){if(!e.condition){e.condition=h.settings.default_condition}if(["AND","OR"].indexOf(e.condition.toUpperCase())===-1){v.error("UndefinedSQLCondition",'Unable to build SQL query with condition "{0}"',e.condition)}if(!e.rules){return""}var l=[];e.rules.forEach(function(i){if(i.rules&&i.rules.length>0){l.push("("+u+a(i)+u+")"+u)}else{var n=h.settings.sqlOperators[i.operator];var e=h.getOperatorByType(i.operator);var r="";if(n===undefined){v.error("UndefinedSQLOperator",'Unknown SQL operation for operator "{0}"',i.operator)}if(e.nb_inputs!==0){if(!(i.value instanceof Array)){i.value=[i.value]}i.value.forEach(function(e,t){if(t>0){r+=n.sep}if(i.type=="boolean"&&d){e=e?1:0}else if(!c&&i.type!=="integer"&&i.type!=="double"&&i.type!=="boolean"){e=v.escapeString(e)}if(n.mod){e=v.fmt(n.mod,e)}if(c){r+=c.add(i,e)}else{if(typeof e=="string"){e="'"+e+"'"}r+=e}})}var t=function(e){return n.op.replace("?",function(){return e})};var s=h.change("getSQLField",i.field,i);var o=s+" "+t(r);l.push(h.change("ruleToSQL",o,i,r,t))}});var t=l.join(" "+e.condition+u);return h.change("groupToSQL",t,e)}(e);if(c){return{sql:i,params:c.run()}}else{return{sql:i}}},getRulesFromSQL:function(e,p){if(!("SQLParser"in window)){v.error("MissingLibrary","SQLParser is required to parse SQL queries. Get it here https://github.com/mistic100/sql-parser")}var f=this;if(typeof e=="string"){e={sql:e}}if(p===true)p="question_mark";if(typeof p=="string"){var t=s(p);p=this.settings.sqlRuleStatement[t[1]](e.params,t[2])}if(p){e.sql=p.esc(e.sql)}if(e.sql.toUpperCase().indexOf("SELECT")!==0){e.sql="SELECT * FROM table WHERE "+e.sql}var i=SQLParser.parse(e.sql);if(!i.where){v.error("SQLParse","No WHERE clause found")}var n=f.change("parseSQLNode",i.where.conditions);if("rules"in n&&"condition"in n){return n}if("id"in n&&"operator"in n&&"value"in n){return{condition:this.settings.default_condition,rules:[n]}}var r=f.change("sqlToGroup",{condition:this.settings.default_condition,rules:[]},n);var g=r;(function e(t,i){if(t===null){return}t=f.change("parseSQLNode",t);if("rules"in t&&"condition"in t){g.rules.push(t);return}if("id"in t&&"operator"in t&&"value"in t){g.rules.push(t);return}if(!("left"in t)||!("right"in t)||!("operation"in t)){v.error("SQLParse","Unable to parse WHERE clause")}if(["AND","OR"].indexOf(t.operation.toUpperCase())!==-1){var n=f.change("sqlGroupsDistinct",i>0&&g.condition!=t.operation.toUpperCase(),g,t,i);if(n){var r=f.change("sqlToGroup",{condition:f.settings.default_condition,rules:[]},t);g.rules.push(r);g=r}g.condition=t.operation.toUpperCase();i++;var s=g;e(t.left,i);g=s;e(t.right,i)}else{if(m.isPlainObject(t.right.value)){v.error("SQLParse","Value format not supported for {0}.",t.left.value)}var o;if(m.isArray(t.right.value)){o=t.right.value.map(function(e){return e.value})}else{o=t.right.value}if(p){if(m.isArray(o)){o=o.map(p.parse)}else{o=p.parse(o)}}var a=t.operation.toUpperCase();if(a=="<>"){a="!="}var l=f.settings.sqlRuleOperator[a];if(l===undefined){v.error("UndefinedSQLOperator",'Invalid SQL operation "{0}".',t.operation)}var c=l.call(this,o,t.operation);var u;if("values"in t.left){u=t.left.values.join(".")}else if("value"in t.left){u=t.left.value}else{v.error("SQLParse","Cannot find field name in {0}",JSON.stringify(t.left))}var d=f.getSQLFieldID(u,o);var h=f.change("sqlToRule",{id:d,field:u,operator:c.op,value:c.val},t);g.rules.push(h)}})(n,0);return r},setRulesFromSQL:function(e,t){this.setRules(this.getRulesFromSQL(e,t))},getSQLFieldID:function(t,e){var i=this.filters.filter(function(e){return e.field.toLowerCase()===t.toLowerCase()});var n;if(i.length===1){n=i[0].id}else{n=this.change("getSQLFieldID",t,e)}return n}});function s(e){var t=e.match(/(question_mark|numbered|named)(?:\((.)\))?/);if(!t)t=[null,"question_mark",undefined];return t}h.define("unique-filter",function(){this.status.used_filters={};this.on("afterUpdateRuleFilter",this.updateDisabledFilters);this.on("afterDeleteRule",this.updateDisabledFilters);this.on("afterCreateRuleFilters",this.applyDisabledFilters);this.on("afterReset",this.clearDisabledFilters);this.on("afterClear",this.clearDisabledFilters);this.on("getDefaultFilter.filter",function(t,i){var n=t.builder;n.updateDisabledFilters();if(t.value.id in n.status.used_filters){var e=n.filters.some(function(e){if(!(e.id in n.status.used_filters)||n.status.used_filters[e.id].length>0&&n.status.used_filters[e.id].indexOf(i.parent)===-1){t.value=e;return true}});if(!e){v.error(false,"UniqueFilter","No more non-unique filters available");t.value=undefined}}})});h.extend({updateDisabledFilters:function(e){var i=e?e.builder:this;i.status.used_filters={};if(!i.model){return}(function t(e){e.each(function(e){if(e.filter&&e.filter.unique){if(!i.status.used_filters[e.filter.id]){i.status.used_filters[e.filter.id]=[]}if(e.filter.unique=="group"){i.status.used_filters[e.filter.id].push(e.parent)}}},function(e){t(e)})})(i.model.root);i.applyDisabledFilters(e)},clearDisabledFilters:function(e){var t=e?e.builder:this;t.status.used_filters={};t.applyDisabledFilters(e)},applyDisabledFilters:function(e){var i=e?e.builder:this;i.$el.find(h.selectors.filter_container+" option").prop("disabled",false);m.each(i.status.used_filters,function(t,e){if(e.length===0){i.$el.find(h.selectors.filter_container+' option[value="'+t+'"]:not(:selected)').prop("disabled",true)}else{e.forEach(function(e){e.each(function(e){e.$el.find(h.selectors.filter_container+' option[value="'+t+'"]:not(:selected)').prop("disabled",true)})})}});if(i.settings.plugins&&i.settings.plugins["bt-selectpicker"]){i.$el.find(h.selectors.rule_filter).selectpicker("render")}}});h.regional["en"]={__locale:"English (en)",__author:'Damien "Mistic" Sorel, http://www.strangeplanet.fr',add_rule:t("querybuilder.common.add_rule"),add_group:t("querybuilder.common.add_group"),delete_rule:t("querybuilder.common.delete_rule"),delete_group:t("querybuilder.common.delete_group"),conditions:{AND:t("querybuilder.conditions.AND"),OR:t("querybuilder.conditions.OR")},operators:{equal:t("querybuilder.operators.equal"),not_equal:t("querybuilder.operators.not_equal"),in:t("querybuilder.operators.in"),not_in:t("querybuilder.operators.not_in"),less:t("querybuilder.operators.less"),less_or_equal:t("querybuilder.operators.less_or_equal"),greater:t("querybuilder.operators.greater"),greater_or_equal:t("querybuilder.operators.greater_or_equal"),between:t("querybuilder.operators.between"),not_between:t("querybuilder.operators.not_between"),begins_with:t("querybuilder.operators.begins_with"),not_begins_with:t("querybuilder.operators.not_begins_with"),contains:t("querybuilder.operators.contains"),not_contains:t("querybuilder.operators.not_contains"),ends_with:t("querybuilder.operators.ends_with"),not_ends_with:t("querybuilder.operators.not_ends_with"),is_empty:t("querybuilder.operators.is_empty"),is_not_empty:t("querybuilder.operators.is_not_empty"),is_null:t("querybuilder.operators.is_null"),is_not_null:t("querybuilder.operators.is_not_null"),before:t("querybuilder.operators.before"),after:t("querybuilder.operators.after"),like:"Like",not_like:"Not like"},errors:{no_filter:t("querybuilder.errors.no_filter"),empty_group:t("querybuilder.errors.empty_group"),radio_empty:t("querybuilder.errors.radio_empty"),checkbox_empty:t("querybuilder.errors.checkbox_empty"),select_empty:t("querybuilder.errors.select_empty"),string_empty:t("querybuilder.errors.string_empty"),string_exceed_min_length:t("querybuilder.errors.string_exceed_min_length"),string_exceed_max_length:t("querybuilder.errors.string_exceed_max_length"),string_invalid_format:t("querybuilder.errors.string_invalid_format"),number_nan:t("querybuilder.errors.number_nan"),number_not_integer:t("querybuilder.errors.number_not_integer"),number_not_double:t("querybuilder.errors.number_not_double"),number_exceed_min:t("querybuilder.errors.number_exceed_min"),number_exceed_max:t("querybuilder.errors.number_exceed_max"),number_wrong_step:t("querybuilder.errors.number_wrong_step"),number_between_invalid:"Invalid values, {0} is greater than {1}",datetime_empty:t("querybuilder.errors.datetime_empty"),datetime_invalid:t("querybuilder.errors.datetime_invalid"),datetime_exceed_min:t("querybuilder.errors.datetime_exceed_min"),datetime_exceed_max:t("querybuilder.errors.datetime_exceed_max"),datetime_between_invalid:"Invalid values, {0} is greater than {1}",boolean_not_valid:t("querybuilder.errors.boolean_not_valid"),operator_not_multiple:t("querybuilder.errors.operator_not_multiple")},invert:t("querybuilder.common.invert"),NOT:"NOT"};h.defaults({lang_code:"en"});return h});(()=>{class e{constructor(e){this.el=e;this.options=_.extend({},AGN.Lib.Helpers.objFromString(e.data("field-options")))}valid(){return true}errors(){return[]}onSubmit(){}isInitializedFor(e){return this.el.is(e)}static create(e){const t=e.data("agn:field");if(t){return t}const i=e.data("field");const n=AGN.Opt.Fields[i]||this;const r=new n(e);e.data("agn:field",r);return r}}AGN.Lib.Field=e})();(()=>{class e extends AGN.Lib.Field{constructor(e){super(e);this._value=this.options.value||this.options.defaultValue||"";this._propertyName=this.el.data("property");this.#prepareDatetimeInput();this.el.on("change",()=>this.setDateTimeFieldValue())}setDateTimeFieldValue(){this.el.find(`[name="${this._propertyName}"]`).val(this.#prepareDateTimeValue())}valid(){return this.errors().length===0}errors(){const e=this.#getDate$();const i=this.#getTime$();if(!e.val()&&i.val()){return[{field:e,msg:t("fields.dateTime.errors.incompleteDate")}]}return[]}onSubmit(){this.setDateTimeFieldValue()}#prepareDateTimeValue(){let e=this.#getDate$().val();const t=this.#getTime$().val()||this.#getDefaultSubmitTime();if(!e){return""}if(this.options.submitDateFormat){e=AGN.Lib.DateFormat.format(moment(e,window.adminDateFormat.toUpperCase()).toDate(),this.options.submitDateFormat)}return this.#formatDateTime(e,t.replaceAll("_","0"))}#getDefaultSubmitTime(){let e=this.options.defaultSubmitTime;if(e!==""&&!e){return"00:00"}if(e==="now"){return moment().format("HH:mm")}return e}#getDate$(){return this.el.find(".js-datepicker")}#getTime$(){return this.el.find(".js-timepicker")}#formatDateTime(e,t){if(/^(\d{2}):(\d{2})$/.test(t)){return`${e} ${t}`}return e}#prepareDatetimeInput(){const e=this.el.data("field-extra-attributes");const t=e?AGN.Lib.Helpers.objFromString(e)||{}:{};const i=$("<input>",{type:"hidden",name:this._propertyName,value:this._value});$.each(t,(e,t)=>i.attr(e,t));this.el.append(AGN.Lib.Template.text("datetime-picker",{date:this._value?this._value.split(" ")[0]:"",time:this.#getTimeFromValue(),timeMask:this.options?.timeMask,extraAttrs:e||""}));this.el.append(i);AGN.runAll(this.el)}#getTimeFromValue(){if(!this._value){return""}const e=this._value.split(" ");return e.length===2?e[1]:""}}AGN.Lib.DateTimeField=e;AGN.Opt.Fields["datetime"]=e})();(()=>{class e extends AGN.Lib.Field{constructor(e){super(e);this.$source=this.el.find("select.js-double-select-trigger");this.$target=this.el.find("select.js-double-select-target");this.$source.off("change");this.$source.on("change",()=>{this.$target.val([]);this.update()});AGN.Lib.DataProvider.get(e).done(e=>{this.options=e;this.update()})}update(){const e=this.$source.find("option:selected").val();const t=this.$target.find("option:selected").val();this.$target.html(AGN.Lib.Template.text("double-select-options",{opts:this.options[e],valueSelected:t}));AGN.Lib.CoreInitializer.run("select",this.$target)}}AGN.Lib.DoubleSelectField=e;AGN.Opt.Fields["double-select"]=e})();(()=>{class e extends AGN.Lib.Field{constructor(e){super(e);this.$strength=this.el.find(".js-password-strength");this.$match=this.el.parent().find(".js-password-match");this.$strength.on("keyup",e=>{if(e.keyCode!==13){if(!this.safe()||this.$strength.val().length===0){this.$match.val("")}this.updateStrength();this.updateMatch()}});this.$match.on("keyup",()=>this.updateMatch())}match(){return this.$strength.val()===this.$match.val()}safe(){return this.#getSecurityIssues().length===0}valid(){if(!this.$match.exists()){return true}return this.match()&&this.safe()}errors(){const i=[];if(this.valid()){return i}if(!this.match()){i.push({field:this.$match,msg:t("fields.password.errors.notMatching")})}const e=this.#getSecurityIssues();if(e.length>0){e.forEach(e=>{i.push({field:this.$strength,msg:e})})}return i}resetStrength(){const e=AGN.Lib.Form.get(this.$strength);e.cleanFieldFeedback(this.$strength)}resetMatch(){const e=AGN.Lib.Form.get(this.$match);e.cleanFieldFeedback(this.$match)}updateStrength(){this.resetStrength();if(this.$strength.val().length===0){return}const e=AGN.Lib.Form.get(this.$strength);const i=this.#getSecurityIssues();if(i.length===0){e.markField(this.$strength,"success");AGN.Lib.Form.appendFeedbackMessage(this.$strength,t("fields.password.safe"),"success")}else{e.markField(this.$strength);i.forEach(e=>AGN.Lib.Form.appendFeedbackMessage(this.$strength,e))}}updateMatch(){this.resetMatch();this.$match.get(0).toggleAttribute("readonly",!this.safe()||this.$strength.val().length===0);if(this.$match.val().length===0){return}const e=AGN.Lib.Form.get(this.$match);if(this.match()){e.markField(this.$match,"success");AGN.Lib.Form.appendFeedbackMessage(this.$match,t("fields.password.matches"),"success")}else{e.markField(this.$match);AGN.Lib.Form.appendFeedbackMessage(this.$match,t("fields.password.matchesNot"))}}#getSecurityIssues(){const i=[];const e=this.$strength.val();if(e.length===0){return i}const n=this.$strength.attr("data-rule");const r=AGN.Lib.PasswordPolicies.findPasswordPolicy(n);const s=r(e);if(s&&s.length){s.forEach(e=>i.push(t(e)))}return i}}AGN.Lib.PasswordField=e;AGN.Opt.Fields["password"]=e})();(()=>{class e extends AGN.Lib.Field{valid(){if(this.options?.ignoreHidden&&!this.el.is(":visible")){return true}if(this.el.exists()){return $.trim(this.el.val())}return true}errors(){const e=[];if(this.valid())return e;e.push({field:this.el,msg:t("fields.required.errors.missing")});return e}}AGN.Lib.RequiredField=e;AGN.Opt.Fields["required"]=e})();(()=>{const e="field-vis";const r="field-vis-show";const s="field-vis-hide";const t=`data-${e}`;const i=`data-${r}`;const n=`data-${s}`;const o="data-field-vis-default";class a extends AGN.Lib.Field{static STR={DATA_FIELD_VIS:t,DATA_FIELD_VIS_SHOW:i,DATA_FIELD_VIS_HIDE:n,DATA_FIELD_VIS_DEFAULT:o};constructor(e){super(e);this.$source=this.el.find(`[${t}]`);this.$source.on("change change.select2",()=>this.update());this.update()}update(){this.#updateDefaults();this.#updateSelects();this.#updateCheckboxes()}#updateSelects(){_.each(this.$source.filter("select"),e=>{this.#toggleFields($(e).find(":selected"))})}#updateDefaults(){_.each(this.el.find(`[${o}]`),e=>{this.#toggleFields($(e))})}#updateCheckboxes(){_.each(this.$source.filter(":checked"),e=>{this.#toggleFields($(e))})}#toggleFields(t){if(t.is(":disabled")&&!t.is("[data-field-vis-nondisabled]")){return}const e=t.data(s);const i=t.data(r);let n=this.el;if(this.el.is("[data-field-vis-scope]")){n=$(this.el.data("field-vis-scope"))}_.each(n.find(e),e=>{t=$(e);t.all(":input").each(function(){const e=$(this);if(!e.prop("disabled")){e.data("field-disabled",true);e.prop("disabled",true)}});t.hide();if(t.data("select2")){t.select2("container").hide();t.select2("enable",false)}if(t.is("option")){t.prop("disabled",true);AGN.Lib.CoreInitializer.run("select",t.parents("select"))}});_.each(n.find(i),e=>{t=$(e);t.all(":input").each(function(){const e=$(this);if(e.data("field-disabled")){e.prop("disabled",false);e.removeData("field-disabled")}});t.show();if(t.data("select2")){t.select2("container").show();t.select2("enable",true)}if(t.is("option")){t.prop("disabled",false);AGN.Lib.CoreInitializer.run("select",t.parents("select"))}})}}AGN.Lib.ToggleVisField=a;AGN.Opt.Fields["toggle-vis"]=a})();(()=>{class e extends AGN.Lib.Field{constructor(e){super(e);this.$target=this.el.find("[data-field-validator]");this.validatorName=this.$target.data("field-validator");const t=this.$target.data("validator-options");this.options=t?AGN.Lib.Helpers.objFromString(t)||{}:{}}valid(){if(!this.$target.exists()||this.$target.prop("disabled")){return true}return this.#getValidators().every(e=>e.valid(this.$target,this.options))}errors(){if(!this.$target.exists()){return[]}return this.#getValidators().map(e=>e.errors(this.$target,this.options)).flat()}#getValidators(){const i=[];this.validatorName.split(",").map(e=>e.trim()).forEach(e=>{const t=AGN.Lib.Validator.get(e);if(t){i.push(t)}else{console.debug(`Validator \`${e}\` doesn't exist`)}});return i}isInitializedFor(e){return super.isInitializedFor(e)||this.$target.is(e)}}AGN.Lib.CustomField=e;AGN.Opt.Fields["validator"]=e})();(()=>{class e extends AGN.Lib.Field{constructor(e){super(e);this.$source=this.el.find("[data-field-split]");this.targets=this.$source.data("field-split").split(/,\s?/);this.rule=new RegExp(this.$source.data("field-split-rule"))}valid(){const i=AGN.Lib.Form.get(this.el);const n=this.$source.val().split(this.rule);_.each(this.targets,(e,t)=>{i.setValueOnce(e,n[t])});return true}}AGN.Lib.ValueSplitField=e;AGN.Opt.Fields["split"]=e})();(()=>{class n{constructor(e,r,t){const s=this;r=_.bind(r,this);if(t&&t.exists()){t=t.first()}else{t=$(document)}_.each(e,(e,n)=>{t.on(n,e,function(e,t){s.event=e;s.trigger=n;s.el=$(this);s.data=t;r(s.el,s.event,s.data,s.trigger);const i=$(s.event.target);if(i.is("a")||i.parent("a").length===1){s.event.preventDefault()}})})}static new(e,t,i){new n(e,t,i)}static translate(e){const i={};_.each(e,function(e,t){e=e.split(/,\s?/);e=_.map(e,e=>`[data-action="${e}"]`).join(", ");i[t]=e});return i}}AGN.Lib.Action=n})();(function(){function o(e,i,n){var r=AGN.Lib.Storage.get("autosave#"+e);if(r){var s=i?i(r.values,r.timestamp):r.values;if(s){var o=AGN.Lib.Template.text("autosave-restore",{title:t("autosave.confirm.title"),content:t("autosave.confirm.question",new Date(r.timestamp).toLocaleString(window.adminLocale,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),negative:t("autosave.discard"),positive:t("autosave.restore")});var a=AGN.Lib.Confirm.create(o).done(function(){n(s===true?r.values:s,r.timestamp);AGN.Lib.Messages(t("autosave.success.title"),t("autosave.success.message"),"success")}).always(function(){AGN.Lib.Storage.delete("autosave#"+e)});return a.promise()}else{AGN.Lib.Storage.delete("autosave#"+e)}}return $.Deferred().reject().promise()}function a(t,i,e){var n=function(){var e=i();if(e){AGN.Lib.Storage.set("autosave#"+t,{timestamp:(new Date).getTime(),values:e})}return e!==false};if(e>0){var r=setInterval(function(){n()||clearInterval(r)},e*1e3)}var s=function(){n()||$(document).unbind("ajax:unauthorized",s)};$(document).on("ajax:unauthorized",s)}AGN.Lib.AutoSave={initialize:function(e,t,i,n,r){var s=o(e,i,n);a(e,t,r);return s}}})();(()=>{AGN.Lib.ChartUtils={getTotal:e=>e.reduce((e,t)=>e+t,0),calcExactPercentages:function(e){const t=this.getTotal(e);return e.map(e=>e/t*100)}}})();(function(){function e(e,t){try{navigator.clipboard.writeText(e).then(function(){t(true)},function(){t(false)})}catch(e){console.warn(e);t(false)}}function n(e,t){var i=true;try{var n=$("<input>");$("body").append(n);n.val(e);n.select();document.execCommand("copy");n.remove()}catch(e){console.warn(e);i=false}if(t){t(i)}}AGN.Lib.Clipboard={set:function(t,i){e(t,function(e){if(e){if(i){i(t,true)}}else{n(t,function(e){if(i){i(t,e)}})}})}}})();(()=>{class i{static DATA_KEY="agn:colorpicker";static get(e){return e.data(i.DATA_KEY)}constructor(t){this.$el=t;this.$trigger=this.#createTriggerInput();t.spectrum({showInput:true,allowEmpty:true,preferredFormat:"hex",move:e=>{t.val(e.toHexString());this.$trigger.val(e.toHexString());this.#updatePipetteColor(e)},change:e=>{this.#updatePipetteColor(e)}});this.#updatePipetteColor(t.spectrum("get"));t.data(i.DATA_KEY,this)}#createTriggerInput(){const t=this.$el.clone();if(this.$el.attr("id")){t.attr("id",this.$el.attr("id")+"_colorpicker")}t.attr("name","");t.removeClass("js-colorpicker");this.$el.before(t);t.on("input",()=>{const e=t.val();this.$el.spectrum("set",e);this.#updatePipetteColor(this.$el.spectrum("get"))});t.on("blur",()=>t.val(this.$el.val()));return t}#updatePipetteColor(e){const t=e?this.#invertColor(e.toHexString()):this.$el.css("--text-color-default");this.$el.parent().find(".sp-preview").css("color",t)}#invertColor(e){return AGN.Lib.Helpers.getColorLuminance(e)>.5?"#000":"#FFF"}}AGN.Lib.Colorpicker=i})();(()=>{class s{constructor(e,t){this.$modal=e;this.deferred=t||$.Deferred()}promise(){return this.deferred.promise()}positive(e){this.deferred.resolve(e);this.$modal.modal("hide");this.$modal.remove()}negative(e){this.deferred.reject(e);this.$modal.modal("hide");this.$modal.remove()}static get(e){const t=s.getWrapper(e);return t.data("_confirm")}static getWrapper(e){return e.closest(".modal")}static create(e,t){const i=AGN.Lib.Modal.create(e);const n=new s(i,t);if(i){i.data("_confirm",n)}return n.promise()}static from(e,t={},i){return s.createFromTemplate(t,e,i)}static createFromTemplate(e,t,i){const n=AGN.Lib.Modal.fromTemplate(t,e);const r=new s(n,i);n.data("_confirm",r);return r.promise()}static request(e){const n=$.Deferred();let t;if(_.isString(e)){t=$.get(e)}else{t=e}t.done(e=>{const t=$(e).all(".modal");if(t.length===1){const i=new s(t,n);t.data("_confirm",i);AGN.Lib.Modal.create(t)}else if(typeof e==="object"&&"success"in e){AGN.Lib.JsonMessages(e.popups,true);e.success?n.resolve():n.reject()}else{AGN.Lib.Page.render(e);n.reject()}}).fail(()=>n.reject());return n.promise()}}AGN.Lib.Confirm=s})();(function(){AGN.Lib.ContextMenu={create:function(e){$.each(e,function(e,i){$.contextMenu({selector:e,build:function(e,t){return n(i,e,t)}})})}};function n(e,n,r){if(e.shown===false||_.isFunction(e.shown)&&e.shown(n,r)===false){return false}var t=e.items;if(_.isFunction(t)){t=t(n,r)}var s={};var o=0;$.each(t,function(e,i){if(!_.isFunction(i.shown)||i.shown(n,r)!==false){var t=s[e]={name:i.name,icon:i.icon};if(_.isFunction(i.disabled)){t.disabled=i.disabled(n,r)===true}else if(i.disabled===true){t.disabled=true}if(_.isFunction(i.clicked)){t.callback=function(e,t){i.clicked(n,e,t)}}o++}});return o?{items:s}:false}})();(()=>{const n=function(e){e=_.bind(e,this);e(this)};n.prototype.addAction=function(e,t){AGN.Lib.Action.new(AGN.Lib.Action.translate(e),t)};n.prototype.addInitializer=function(e,t){AGN.Lib.CoreInitializer.new(e,t)};n.prototype.addDomInitializer=function(e,t){AGN.Lib.DomInitializer.new(e,t)};n.prototype.runInitializer=function(e){AGN.Lib.CoreInitializer.run(e)};n.new=function(e,t){AGN.Opt.Controllers[e]=t};n.newExtended=function(e,t,i){n.new(e,e=>{new n(AGN.Opt.Controllers[t]);_.bind(i,e)(e)})};n.init=function(e=$(document)){e.all("[data-controller]").each(function(){const e=$(this).data("controller");const t=AGN.Opt.Controllers[e];if(t){new AGN.Lib.Controller(t);AGN.Opt.Controllers[e]=undefined}})};AGN.Lib.Controller=n})();(function(){var o={};function e(e){var t=null;var i;if(arguments.length>2){t=arguments[1];i=arguments[2]}else{i=arguments[1]}if(_.isFunction(i)){o["key#"+e]={name:e,handler:i,dependencies:t}}else{console.error("Handler must be a function")}}function a(n,e,r,s){var t="key#"+e.name;if(r[t]){return}if(Array.isArray(e.dependencies)&&e.dependencies.length){s.push(e.name);e.dependencies.forEach(function(e){var t=o["key#"+e];if(t){if(s.includes(e)){var i=s.map(function(e){return"`"+e+"`"}).join(" => ");console.error("Cyclic initializer dependency detected ("+i+" => `"+e+"`)");return}a(n,t,r,s)}else{console.error("Unknown initializer dependency: `"+name+"`")}});s.pop()}try{e.handler.call(e.handler,n)}catch(e){console.error(e)}r[t]=true}function t(i){var n={};var r=[];$.each(o,function(e,t){a(i,t,n,r)})}function n(e,t){if(Array.isArray(e)){e.forEach(function(e){n(e,t)})}else{var i=o["key#"+e];if(i){i.handler.call(i.handler,t);return true}else{console.error("Unknown initializer: `"+e+"`");return false}}}AGN.Lib.CoreInitializer={autorun:t,run:n,new:e}})();(function(){class r{static readActualToken(){if(r.isProtectionEnabled()){return AGN.Lib.Storage.readCookie(window.csrfCookieName)}return""}static getParameterName(){return window.csrfParameterName}static isProtectionEnabled(){return window.csrfHeaderName&&r.getParameterName()&&window.csrfCookieName}static setTokenToReqHeader(e,t){if(r.isProtectionEnabled()&&t!=="GET"){e.setRequestHeader(window.csrfHeaderName,r.readActualToken())}}static updateTokenInDOM(e=$(document)){if(!r.isProtectionEnabled()){return e}const t=!(e instanceof $);if(t){e=$("<div>").append(e)}const i=r.readActualToken();const n=e.find(`input[name="${r.getParameterName()}"]`);_.each(n,e=>{if(t){$(e).attr("value",i)}else{$(e).val(i)}});if(t){return e.html()}}}AGN.Lib.CSRF=r})();(function(){var r={};r.get=function(e){var t=e.data("provider"),i=e.data("provider-src"),n;switch(t){case"opt":n=r.opt(i);break;case"remote":n=r.remote(i);break;default:break}return n};r.opt=function(e){var t=$.Deferred();if(AGN.Opt[e]){setTimeout(function(){t.resolve(AGN.Opt[e])},100)}else{setTimeout(function(){t.reject()},100)}return t};r.remote=function(e){return $.get(e)};AGN.Lib.DataProvider=r})();(function(){let R;const o={"ar-SA":"dd/MM/yy","bg-BG":"dd.M.yyyy","ca-ES":"dd/MM/yyyy","zh-TW":"yyyy/M/d","cs-CZ":"d.M.yyyy","da-DK":"dd-MM-yyyy","de-DE":"dd.MM.yyyy","el-GR":"d/M/yyyy","en-US":"M/d/yyyy","fi-FI":"d.M.yyyy","fr-FR":"dd/MM/yyyy","he-IL":"dd/MM/yyyy","hu-HU":"yyyy. MM. dd.","is-IS":"d.M.yyyy","it-IT":"dd/MM/yyyy","ja-JP":"yyyy/MM/dd","ko-KR":"yyyy-MM-dd","nl-NL":"d-M-yyyy","nb-NO":"dd.MM.yyyy","pl-PL":"yyyy-MM-dd","pt-BR":"d/M/yyyy","ro-RO":"dd.MM.yyyy","ru-RU":"dd.MM.yyyy","hr-HR":"d.M.yyyy","sk-SK":"d. M. yyyy","sq-AL":"yyyy-MM-dd","sv-SE":"yyyy-MM-dd","th-TH":"d/M/yyyy","tr-TR":"dd.MM.yyyy","ur-PK":"dd/MM/yyyy","id-ID":"dd/MM/yyyy","uk-UA":"dd.MM.yyyy","be-BY":"dd.MM.yyyy","sl-SI":"d.M.yyyy","et-EE":"d.MM.yyyy","lv-LV":"yyyy.MM.dd.","lt-LT":"yyyy.MM.dd","fa-IR":"MM/dd/yyyy","vi-VN":"dd/MM/yyyy","hy-AM":"dd.MM.yyyy","az-Latn-AZ":"dd.MM.yyyy","eu-ES":"yyyy/MM/dd","mk-MK":"dd.MM.yyyy","af-ZA":"yyyy/MM/dd","ka-GE":"dd.MM.yyyy","fo-FO":"dd-MM-yyyy","hi-IN":"dd-MM-yyyy","ms-MY":"dd/MM/yyyy","kk-KZ":"dd.MM.yyyy","ky-KG":"dd.MM.yy","sw-KE":"M/d/yyyy","uz-Latn-UZ":"dd/MM yyyy","tt-RU":"dd.MM.yyyy","pa-IN":"dd-MM-yy","gu-IN":"dd-MM-yy","ta-IN":"dd-MM-yyyy","te-IN":"dd-MM-yy","kn-IN":"dd-MM-yy","mr-IN":"dd-MM-yyyy","sa-IN":"dd-MM-yyyy","mn-MN":"yy.MM.dd","gl-ES":"dd/MM/yy","kok-IN":"dd-MM-yyyy","syr-SY":"dd/MM/yyyy","dv-MV":"dd/MM/yy","ar-IQ":"dd/MM/yyyy","zh-CN":"yyyy/M/d","de-CH":"dd.MM.yyyy","en-GB":"dd/MM/yyyy","es-MX":"dd/MM/yyyy","fr-BE":"d/MM/yyyy","it-CH":"dd.MM.yyyy","nl-BE":"d/MM/yyyy","nn-NO":"dd.MM.yyyy","pt-PT":"dd-MM-yyyy","sr-Latn-CS":"d.M.yyyy","sv-FI":"d.M.yyyy","az-Cyrl-AZ":"dd.MM.yyyy","ms-BN":"dd/MM/yyyy","uz-Cyrl-UZ":"dd.MM.yyyy","ar-EG":"dd/MM/yyyy","zh-HK":"d/M/yyyy","de-AT":"dd.MM.yyyy","en-AU":"d/MM/yyyy","es-ES":"dd/MM/yyyy","fr-CA":"yyyy-MM-dd","sr-Cyrl-CS":"d.M.yyyy","ar-LY":"dd/MM/yyyy","zh-SG":"d/M/yyyy","de-LU":"dd.MM.yyyy","en-CA":"dd/MM/yyyy","es-GT":"dd/MM/yyyy","fr-CH":"dd.MM.yyyy","ar-DZ":"dd-MM-yyyy","zh-MO":"d/M/yyyy","de-LI":"dd.MM.yyyy","en-NZ":"d/MM/yyyy","es-CR":"dd/MM/yyyy","fr-LU":"dd/MM/yyyy","ar-MA":"dd-MM-yyyy","en-IE":"dd/MM/yyyy","es-PA":"MM/dd/yyyy","fr-MC":"dd/MM/yyyy","ar-TN":"dd-MM-yyyy","en-ZA":"yyyy/MM/dd","es-DO":"dd/MM/yyyy","ar-OM":"dd/MM/yyyy","en-JM":"dd/MM/yyyy","es-VE":"dd/MM/yyyy","ar-YE":"dd/MM/yyyy","en-029":"MM/dd/yyyy","es-CO":"dd/MM/yyyy","ar-SY":"dd/MM/yyyy","en-BZ":"dd/MM/yyyy","es-PE":"dd/MM/yyyy","ar-JO":"dd/MM/yyyy","en-TT":"dd/MM/yyyy","es-AR":"dd/MM/yyyy","ar-LB":"dd/MM/yyyy","en-ZW":"M/d/yyyy","es-EC":"dd/MM/yyyy","ar-KW":"dd/MM/yyyy","en-PH":"M/d/yyyy","es-CL":"dd-MM-yyyy","ar-AE":"dd/MM/yyyy","es-UY":"dd/MM/yyyy","ar-BH":"dd/MM/yyyy","es-PY":"dd/MM/yyyy","ar-QA":"dd/MM/yyyy","es-BO":"dd/MM/yyyy","es-SV":"dd/MM/yyyy","es-HN":"dd/MM/yyyy","es-NI":"dd/MM/yyyy","es-PR":"dd/MM/yyyy","am-ET":"d/M/yyyy","tzm-Latn-DZ":"dd-MM-yyyy","iu-Latn-CA":"d/MM/yyyy","sma-NO":"dd.MM.yyyy","mn-Mong-CN":"yyyy/M/d","gd-GB":"dd/MM/yyyy","en-MY":"d/M/yyyy","prs-AF":"dd/MM/yy","bn-BD":"dd-MM-yy","wo-SN":"dd/MM/yyyy","rw-RW":"M/d/yyyy","qut-GT":"dd/MM/yyyy","sah-RU":"MM.dd.yyyy","gsw-FR":"dd/MM/yyyy","co-FR":"dd/MM/yyyy","oc-FR":"dd/MM/yyyy","mi-NZ":"dd/MM/yyyy","ga-IE":"dd/MM/yyyy","se-SE":"yyyy-MM-dd","br-FR":"dd/MM/yyyy","smn-FI":"d.M.yyyy","moh-CA":"M/d/yyyy","arn-CL":"dd-MM-yyyy","ii-CN":"yyyy/M/d","dsb-DE":"d. M. yyyy","ig-NG":"d/M/yyyy","kl-GL":"dd-MM-yyyy","lb-LU":"dd/MM/yyyy","ba-RU":"dd.MM.yy","nso-ZA":"yyyy/MM/dd","quz-BO":"dd/MM/yyyy","yo-NG":"d/M/yyyy","ha-Latn-NG":"d/M/yyyy","fil-PH":"M/d/yyyy","ps-AF":"dd/MM/yy","fy-NL":"d-M-yyyy","ne-NP":"M/d/yyyy","se-NO":"dd.MM.yyyy","iu-Cans-CA":"d/M/yyyy","sr-Latn-RS":"d.M.yyyy","si-LK":"yyyy-MM-dd","sr-Cyrl-RS":"d.M.yyyy","lo-LA":"dd/MM/yyyy","km-KH":"yyyy-MM-dd","cy-GB":"dd/MM/yyyy","bo-CN":"yyyy/M/d","sms-FI":"d.M.yyyy","as-IN":"dd-MM-yyyy","ml-IN":"dd-MM-yy","en-IN":"dd-MM-yyyy","or-IN":"dd-MM-yy","bn-IN":"dd-MM-yy","tk-TM":"dd.MM.yy","bs-Latn-BA":"d.M.yyyy","mt-MT":"dd/MM/yyyy","sr-Cyrl-ME":"d.M.yyyy","se-FI":"d.M.yyyy","zu-ZA":"yyyy/MM/dd","xh-ZA":"yyyy/MM/dd","tn-ZA":"yyyy/MM/dd","hsb-DE":"d. M. yyyy","bs-Cyrl-BA":"d.M.yyyy","tg-Cyrl-TJ":"dd.MM.yy","sr-Latn-BA":"d.M.yyyy","smj-NO":"dd.MM.yyyy","rm-CH":"dd/MM/yyyy","smj-SE":"yyyy-MM-dd","quz-EC":"dd/MM/yyyy","quz-PE":"dd/MM/yyyy","hr-BA":"d.M.yyyy.","sr-Latn-ME":"d.M.yyyy","sma-SE":"yyyy-MM-dd","en-SG":"d/M/yyyy","ug-CN":"yyyy-M-d","sr-Cyrl-BA":"d.M.yyyy","es-US":"M/d/yyyy"};R={MONTH_NAMES:["January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],DAY_NAMES:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat"],LZ:function(e){return(e<0||e>9?"":"0")+e},compareDates:function(e,t,i,n){var r=R.parseFormat(e,t);var s=R.parseFormat(i,n);if(r==0||s==0)return-1;else if(r>s)return 1;return 0},format:function(e,t){t=t+"";var i="";var n=0;var r="";var s="";var o=e.getYear()+"";var a=e.getMonth()+1;var l=e.getDate();var c=e.getDay();var u=e.getHours();var d=e.getMinutes();var h=e.getSeconds();var p,f,g,m,v,y,b,C,w,_,A,u,E,S,T,x;var D=new Object;if(o.length<4){o=""+(o-0+1900)}D["y"]=""+o;D["yyyy"]=o;D["yy"]=o.substring(2,4);D["M"]=a;D["MM"]=R.LZ(a);D["MMM"]=R.MONTH_NAMES[a-1];D["NNN"]=R.MONTH_NAMES[a+11];D["d"]=l;D["dd"]=R.LZ(l);D["E"]=R.DAY_NAMES[c+7];D["EE"]=R.DAY_NAMES[c];D["H"]=u;D["HH"]=R.LZ(u);if(u==0){D["h"]=12}else if(u>12){D["h"]=u-12}else{D["h"]=u}D["hh"]=R.LZ(D["h"]);if(u>11){D["K"]=u-12}else{D["K"]=u}D["k"]=u+1;D["KK"]=R.LZ(D["K"]);D["kk"]=R.LZ(D["k"]);if(u>11){D["a"]="PM"}else{D["a"]="AM"}D["m"]=d;D["mm"]=R.LZ(d);D["s"]=h;D["ss"]=R.LZ(h);while(n<t.length){r=t.charAt(n);s="";while(t.charAt(n)==r&&n<t.length)s+=t.charAt(n++);if(D[s]!=null)i+=D[s];else i+=s}return i},_isInteger:function(e){var t="1234567890";for(var i=0;i<e.length;i++)if(t.indexOf(e.charAt(i))==-1)return false;return true},_getInt:function(e,t,i,n){for(var r=n;r>=i;r--){var s=e.substring(t,t+r);if(s.length<i)return null;if(R._isInteger(s))return s}return null},parseFormat:function(e,t){e=e+"";t=t+"";var i=0;var n=0;var r="";var s="";var o="";var a,l;var c=new Date;var u=c.getYear();var d=c.getMonth()+1;var h=1;var p=c.getHours();var f=c.getMinutes();var g=c.getSeconds();var m="";while(n<t.length){r=t.charAt(n);s="";while(t.charAt(n)==r&&n<t.length)s+=t.charAt(n++);if(s=="yyyy"||s=="yy"||s=="y"){if(s=="yyyy")a=4;l=4;if(s=="yy")a=2;l=2;if(s=="y")a=2;l=4;u=R._getInt(e,i,a,l);if(u==null)return 0;i+=u.length;if(u.length==2){if(u>70)u=1900+(u-0);else u=2e3+(u-0)}}else if(s=="MMM"||s=="NNN"){d=0;for(var v=0;v<R.MONTH_NAMES.length;v++){var y=R.MONTH_NAMES[v];if(e.substring(i,i+y.length).toLowerCase()==y.toLowerCase()){if(s=="MMM"||s=="NNN"&&v>11){d=v+1;if(d>12)d-=12;i+=y.length;break}}}if(d<1||d>12)return 0}else if(s=="EE"||s=="E"){for(var v=0;v<R.DAY_NAMES.length;v++){var b=R.DAY_NAMES[v];if(e.substring(i,i+b.length).toLowerCase()==b.toLowerCase()){i+=b.length;break}}}else if(s=="MM"||s=="M"){d=R._getInt(e,i,s.length,2);if(d==null||d<1||d>12)return 0;i+=d.length}else if(s=="dd"||s=="d"){h=R._getInt(e,i,s.length,2);if(h==null||h<1||h>31)return 0;i+=h.length}else if(s=="hh"||s=="h"){p=R._getInt(e,i,s.length,2);if(p==null||p<1||p>12)return 0;i+=p.length}else if(s=="HH"||s=="H"){p=R._getInt(e,i,s.length,2);if(p==null||p<0||p>23)return 0;i+=p.length}else if(s=="KK"||s=="K"){p=R._getInt(e,i,s.length,2);if(p==null||p<0||p>11)return 0;i+=p.length}else if(s=="kk"||s=="k"){p=R._getInt(e,i,s.length,2);if(p==null||p<1||p>24)return 0;i+=p.length;p--}else if(s=="mm"||s=="m"){f=R._getInt(e,i,s.length,2);if(f==null||f<0||f>59)return 0;i+=f.length}else if(s=="ss"||s=="s"){g=R._getInt(e,i,s.length,2);if(g==null||g<0||g>59)return 0;i+=g.length}else if(s=="a"){if(e.substring(i,i+2).toLowerCase()=="am")m="AM";else if(e.substring(i,i+2).toLowerCase()=="pm")m="PM";else return 0;i+=2}else{if(e.substring(i,i+s.length)!=s)return 0;else i+=s.length}}if(i!=e.length)return 0;if(d==2){if(u%4==0&&u%100!=0||u%400==0){if(h>29)return 0}else if(h>28){return 0}}if(d==4||d==6||d==9||d==11)if(h>30)return 0;if(p<12&&m=="PM")p=p-0+12;else if(p>11&&m=="AM")p-=12;var C=new Date(u,d-1,h,p,f,g);return C},parse:function(e,t){if(t){return R.parseFormat(e,t)}else{var i=arguments.length==2?arguments[1]:false;var n=new Array("y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d");var r=new Array("M/d/y","M-d-y","M.d.y","MMM-d","M/d","M-d");var s=new Array("d/M/y","d-M-y","d.M.y","d-MMM","d/M","d-M");var o=[n,i?s:r,i?r:s];var a=null;for(var l=0;l<o.length;l++){var c=o[l];for(var u=0;u<c.length;u++){a=R.parseFormat(e,c[u]);if(a!=0)return new Date(a)}}return null}},toArray:function(e,t){if(e&&e.getMonth){return[e.getFullYear(),e.getMonth(),e.getDate()]}else{return t}},getLocaleShortDateString:function(e){var t=navigator.language?navigator.language:navigator["userLanguage"],i=e.getFullYear(),n=e.getMonth()+1,e=e.getDate();var r=t in o?o[t]:"MM/dd/yyyy";function s(e){e=""+e;return e.length>1?e:"0"+e}r=r.replace(/yyyy/,i);r=r.replace(/yy/,String(i).substr(2));r=r.replace(/MM/,s(n));r=r.replace(/M/,n);r=r.replace(/dd/,s(e));r=r.replace(/d/,e);return r},getLocaleDateFormat:function(){var e=navigator.language?navigator.language:navigator["userLanguage"];var t=e in o?o[e]:"MM/dd/yyyy";return t},getLocalizedShortWeekdays:function(t,e){const i=[];const n=new Date;const r={weekday:"short"};n.setDate(n.getDate()-n.getDay()+e);for(let e=0;e<7;e++){const s=n.toLocaleDateString(t,r);i.push(s);n.setDate(n.getDate()+1)}return i},formatAdminDateTime:function(e){if(!e){return""}const t=window.adminDateTimeFormat.replaceAll("d","D").replaceAll("y","Y");return moment(e).format(t)},formatAdminDate:function(e){if(!e){return""}const t=window.adminDateFormat.replaceAll("d","D").replaceAll("y","Y");return moment(e).format(t)}};AGN.Lib.DateFormat=R})();(function(){var r='script[type="application/json"]';var s="config:";var o={};function a(e,t){this.el=e;if(e.is(r)){this.config=e.json()}else{const n=l(e,t);if(n.exists()){var i=n.attr("type");if(!i||i==="application/json"){this.config=n.json()}else{console.error("Unexpected config script type: `"+i+"`")}}}}function l(e,t){const i="script#"+CSS.escape(s+t);const n=e.find(i);if(n.exists()){return n}return $(i)}a.prototype.addAction=function(e,t){AGN.Lib.Action.new(AGN.Lib.Action.translate(e),t,this.el)};function e(t){var e=t;if(!e){e=$(document)}e.all("[data-initializer]").each(function(){var e=$(this);n(e.data("initializer"),e,t)})}function n(e,t,i){var n=o["key#"+e];if(n){var r=n.call(new a(t,e),t,i);if(r===false){o["key#"+e]=undefined}return true}else{return false}}function t(e,t){if(o["key#"+e]){var i=t;if(!i){i=$(document)}i.all('[data-initializer="'+CSS.escape(e)+'"]').each(function(){n(e,$(this),t)})}}function i(e,t){if(_.isFunction(t)){o["key#"+e]=t}else{console.error("Handler must be a function")}}AGN.Lib.DomInitializer={autorun:e,run:n,try:t,new:i}})();(()=>{const s={MAIN:"main",VISIBLE:"visible",HIDDEN:"hidden"};class o{static DATA_KEY="agn:editable-tile";static SELECTOR="[data-editable-tile]";constructor(e,t){this.$el=e;this.state=t;this.toggle();this.#setOverlay();this.$el.data(o.DATA_KEY,this)}static get(e){const t=e.closest(o.SELECTOR);return t.data(o.DATA_KEY)}toggleState(){if(this.state===s.VISIBLE){this.state=s.HIDDEN}else{this.state=s.VISIBLE}this.#setOverlay()}toggle(){this.$el.toggleClass("tile--hidden",this.state===s.HIDDEN)}#setOverlay(){const e=AGN.Lib.Template.dom("tile-overlay",{state:this.state});if(this.$overlay){this.$overlay.replaceWith(e)}else{this.$el.append(e)}this.$overlay=e}}AGN.Lib.EditableTile=o;class i{static DATA_KEY="agn:editable-view";static SELECTOR="[data-editable-view]";constructor(e,t){this.$el=e;this.name=t;this.inEditMode=false;this.$btn=$(`[data-edit-view="${t}"]`);this.$btnSiblings=this.$btn.closest("li").siblings("li:visible");this.config=AGN.Lib.Storage.get(this.#getStorageKey())||{};this.tiles=this.#initTiles();this.#controlContainersVisibility();this.$el.addClass("is-initialized");this.$el.data(i.DATA_KEY,this);this.#updateControlViewBtn()}static get(e){const t=e.closest(i.SELECTOR);return t.data(i.DATA_KEY)}enableEditMode(){this.inEditMode=true;this.$el.addClass("edit-mode");this.#controlContainersVisibility();this.#updateControlViewBtn();this.$btnSiblings.hide()}applyChanges(){this.inEditMode=false;this.$el.removeClass("edit-mode");this.$btnSiblings.show();const t={};this.tiles.forEach(e=>{e.toggle();if(e.state!==s.MAIN){t[e.$el.attr("id")]=e.state}});this.#controlContainersVisibility();AGN.Lib.Storage.set(this.#getStorageKey(),t);AGN.Lib.Messages.success("editableView.saved");this.#updateControlViewBtn()}#getCountOfHiddenTiles(){return this.#getTilesByState(s.HIDDEN).length}#updateControlViewBtn(){const e=this.$btn.find(".text");if(this.isInEditMode()){e.text(t("editableView.save"))}else{e.text(t("editableView.edit"));const i=this.#getCountOfHiddenTiles();if(i>0){e.append(` (${i} <i class="icon icon-eye-slash"></i>)`)}}}toggleState(e){const t=this.#getTilesByState(s.HIDDEN);const i=o.get(e);if(t.length===this.tiles.length-1&&i.state===s.VISIBLE){AGN.Lib.Messages.alert("editableView.tile.error.cantRemove")}else{i.toggleState()}}#getTilesByState(t){return this.tiles.filter(e=>e.state===t)}isInEditMode(){return this.inEditMode}#initTiles(){const i=this;const n=new Map;this.$el.find(o.SELECTOR).each(function(){const e=$(this);const t=i.getTileState(e);n.set(e,t)});const r=[...n.values()].every(e=>e===s.HIDDEN);return Array.from(n,([e,t])=>new o(e,r?s.VISIBLE:t))}getTileState(e){return e.data("editable-tile")||this.config[e.attr("id")]||s.VISIBLE}#controlContainersVisibility(){const e=this.tiles.flatMap(e=>{const t=e.$el.parentsUntil(this.$el);return t.toArray().map(e=>$(e))});e.forEach(e=>e.toggleClass("tile-container--hidden",this.#areAllTilesHiddenInContainer(e)))}#areAllTilesHiddenInContainer(e){if(this.inEditMode){return false}return e.find(o.SELECTOR).toArray().every(e=>o.get($(e)).state===s.HIDDEN)}#getStorageKey(){return`editable-view#${this.name}`}#contains(e){const t=i.get(e);return t&&this.tiles.includes(t)}add(e){if(this.#contains(e)){return}const t=new o(e,this.getTileState(e));this.tiles.push(t)}}AGN.Lib.EditableView=i})();(function(){var t,i,n,r,s;t=function(e){var t=this,i,n,r,s;this.el=$(e);s=!!this.el.attr("readonly");this.isFullHeight=!!this.el.data("full-height-editor");this.height=parseInt(this.el.attr("rows")||15)*15;i=this.el.attr("id")+"Editor";n=$("#"+i);if(n.length===1){r=i;var o=n.data("full-height-editor");n.css("height",o?"100%":this.height+"px")}else{r=_.uniqueId("Editor");n=$('<div id="'+r+'" class="form-control"></div>');n.css("height",this.isFullHeight?"100%":this.height+"px");n.insertAfter($(this.el))}this.el.hide();this.editor=ace.edit(r);this.editor.setReadOnly(s);this.editor.getSession().setValue(this.el.val());this.editor.getSession().on("change",function(e){t.el.val(t.editor.getSession().getValue());t.el.trigger("editor:change")});this.langTools=ace.require("ace/ext/language_tools");this.decorate();if(this.el.hasClass("js-editor-validate")){this.editor.getSession().setUseWorker(true)}if(this.el.hasClass("js-editor-wrap")){this.editor.getSession().setUseWrapMode(true)}t.el.trigger("editor:create")};t.get=function(e){var t=e.data("_editor");if(t){return t}if(e.hasClass("js-editor")){t=new i(e)}else if(e.hasClass("js-editor-text")){t=new n(e)}else if(e.hasClass("js-editor-eql")){t=new r(e)}else if(e.hasClass("js-editor-css")){t=new s(e)}e.data("_editor",t);return t};t.all=function(){return _.map($(".js-editor, .js-editor-text, .js-editor-eql, .js-editor-css"),function(e){return t.get($(e))})};t.prototype.decorate=function(){if($("body").hasClass("dark-theme")){this.editor.setTheme("ace/theme/idle_fingers")}else{this.editor.setTheme("ace/theme/chrome")}this.editor.session.setUseWrapMode(true);this.editor.session.setWrapLimitRange(null,null);this.editor.setBehavioursEnabled(true);this.editor.setShowPrintMargin(false);this.editor.session.setUseSoftTabs(true);this.editor.getSession().setUseWorker(false);this.editor.setOptions({enableBasicAutocompletion:true,enableSnippets:true,enableLiveAutocompletion:true,minLines:20})};t.prototype.resize=function(){this.editor.resize()};t.prototype.val=function(e,t=false){if(typeof e!=="undefined"){const i=this.editor.getSelection().getCursor();this.editor.getSession().setValue(e);if(t){this.goToLine(i.row+1,i.column)}}else{return this.editor.getSession().getValue()}};t.prototype.goToLine=function(e,t){this.editor.focus();this.editor.gotoLine(e,t)};i=function(e){t.apply(this,e)};i.prototype=Object.create(t.prototype);i.prototype.constructor=i;i.prototype.decorate=function(){t.prototype.decorate.call(this);this.editor.getSession().setMode("ace/mode/html")};n=function(e){t.apply(this,e)};n.prototype=Object.create(t.prototype);n.prototype.constructor=n;n.prototype.decorate=function(){if($("body").hasClass("dark-theme")){this.editor.setTheme("ace/theme/idle_fingers")}else{this.editor.setTheme("ace/theme/chrome")}this.editor.session.setUseWrapMode(false);this.editor.session.setWrapLimitRange(null,null);this.editor.setBehavioursEnabled(true);this.editor.setShowPrintMargin(false);this.editor.session.setUseSoftTabs(true);this.editor.getSession().setUseWorker(false);this.editor.setOptions({enableBasicAutocompletion:false,enableSnippets:false,enableLiveAutocompletion:false,minLines:20});this.editor.getSession().setMode("ace/mode/text")};r=function(e){t.apply(this,e)};r.prototype=Object.create(t.prototype);r.prototype.constructor=r;r.prototype.decorate=function(){if($("body").hasClass("dark-theme")){this.editor.setTheme("ace/theme/idle_fingers")}else{this.editor.setTheme("ace/theme/chrome")}this.editor.session.setUseWrapMode(false);this.editor.session.setWrapLimitRange(null,null);this.editor.setBehavioursEnabled(true);this.editor.setShowPrintMargin(false);this.editor.session.setUseSoftTabs(true);this.editor.getSession().setUseWorker(false);this.langTools.setCompleters([this.langTools.keyWordCompleter,this.langTools.snippetCompleter]);this.editor.setOptions({enableBasicAutocompletion:true,enableSnippets:false,enableLiveAutocompletion:true,minLines:20});ace.config.loadModule("ace/ext/eql_constructions_tokens");ace.config.loadModule("ace/ext/eql_constructions_basic");ace.config.loadModule("ace/ext/eql_constructions_extended");this.editor.getSession().setMode("ace/mode/eql")};s=function(e){t.apply(this,e)};s.prototype=Object.create(t.prototype);s.prototype.constructor=s;s.prototype.decorate=function(){t.prototype.decorate.call(this);this.editor.getSession().setMode("ace/mode/css")};AGN.Lib.Editor=t;AGN.Lib.EditorHtml=i;AGN.Lib.EditorText=n;AGN.Lib.EditorEql=r;AGN.Lib.EditorCss=s})();(()=>{class n{static DATA_ATTR_NAME="agn:endless-scroll";constructor(e,t,i={}){this.$el=e;this.url=t;this.options=i;this.currentPage=0;this.allPagesLoaded=false;this.$loader=i.loader?$(i.loader):null;this.$content=e.find("[data-endless-scroll-content]");if(!this.$content.exists()){this.$content=e.find("> div:first")}this.$content.wrap('<div class="endless_scroll_inner_wrap"></div>');e.endlessScroll({fireOnce:true,fireDelay:1e3,loader:"",insertAfter:"",callback:()=>this.loadContent()});this.loadContent();e.data(n.DATA_ATTR_NAME,this)}static get(e){return e.data(n.DATA_ATTR_NAME)}load(e){this.$content.empty();if(e){this.url=e}this.currentPage=0;this.allPagesLoaded=false;this.loadContent()}loadContent(){if(this.allPagesLoaded){return}const n=this.$loader?.exists()&&this.$el.is(":visible");if(n){AGN.Lib.Loader.prevent();this.$loader.removeClass("hidden")}const e=$.get(this.url,{page:this.currentPage+1});e.done(e=>{this.currentPage+=1;const t=$(e);const i=$(e).children();if(e instanceof Array){this.$content.append(JSON.stringify(e))}this.$content.append(i);this.allPagesLoaded=t.is("[data-endless-scroll-stop]");if(n){this.$loader.addClass("hidden")}if(this.options.onLoad){this.options.onLoad(i)}});return e}}AGN.Lib.EndlessScroll=n})();(function(){class i{static defaults(){return[{active:false,time:""}]}static create(e,t){e=$.extend(i.defaults()[0],e);return AGN.Lib.Template.dom(t?"schedule-extended-time-wrapper":"schedule-time-wrapper",{scheduleElement:e})}static get(e){return e.closest("[data-schedule-time-wrapper]")}}class r{constructor(e){if(!e.exists()){e=r.create({})}this.$rowWrapper=e}static defaults(){return{weekDay:"",scheduledInterval:{active:false,interval:""},scheduledTime:[{active:false,time:""}]}}static get(e){let t;if(e.is("tr[data-schedule-row]")){t=e}else{t=e.closest("tr[data-schedule-row]")}return new r(t)}static create(e){e=$.extend(r.defaults(),e);const n=AGN.Lib.Template.dom("schedule-day-row",{entry:e});const i=new r(n);n.on("row:add-schedule row:remove-schedule",()=>{const e=n.find("[data-schedule-time-wrapper]").length;const t=n.find('[data-action="remove-schedule"]');const i=n.find('[data-action="add-schedule"]');t.addClass("hidden");i.addClass("hidden");if(e>1){t.slice(0,-1).removeClass("hidden")}i.last().removeClass("hidden")});n.find("[data-schedule-interval]").on("change",function(){const e=i.isIntervalSelection();const t=n.find("[data-schedule-time-wrapper]");t.find(".btn").toggleClass("disabled",e);t.find(":input").prop("disabled",e);if(!e&&!t.exists()){i.addSchedule()}});return n}static deserialize(e){if(!e.scheduledInterval.active&&!e.scheduledTime.some(e=>e.active)){return null}return r.create(e)}toJson(){const e=this.$rowWrapper.find("[data-schedule-dayOfTheWeek]").val();const i=this.isIntervalSelection();const t=_.map(this.$rowWrapper.find("[data-schedule-time-wrapper]"),e=>{const t=$(e).find("[data-schedule-time]").val();return{active:!i&&!!t,time:t}});const n={active:i,interval:this.$rowWrapper.find("[data-schedule-interval]").val()};return $.extend(r.defaults(),{weekDay:e,scheduledTime:t,scheduledInterval:n})}isIntervalSelection(e){return this.$rowWrapper.find("[data-schedule-interval]").val()!=="0"}addSchedule(e){const t=i.create(e,true);this.$rowWrapper.find("[data-schedule-time-container]").append(t);AGN.runAll(t);this.$rowWrapper.trigger("row:add-schedule")}removeSchedule(e){i.get(e).remove();this.$rowWrapper.trigger("row:remove-schedule")}getAllScheduleTimes(){const t=[];this.toJson().scheduledTime.forEach(e=>{if(e.active){t.push(parseInt(e.time.replace(":","")))}});return t}isValidTimeIntervals(){const e=this.getAllScheduleTimes();return(new n).valid(e)}validateTimeIntervals(){if(this.isValidTimeIntervals()){this.hideTimeScheduleErrors();return true}this.showTimeScheduleErrors(t("error.delay.60"));return false}showTimeScheduleErrors(e){const t=this.$rowWrapper.find("[data-schedule-time-wrapper]");const i=$(`<div class="form-control-feedback-message js-form-error-msg">${e}</div>`);_.each(t,e=>{const t=$(e);if(!t.find(".js-form-error-msg").exists()){t.find("[data-schedule-time]").parent().append(i.clone());t.addClass("has-alert has-feedback js-form-error")}})}hideTimeScheduleErrors(){const e=this.$rowWrapper.find("[data-schedule-time-wrapper]");e.find(".js-form-error-msg").remove();e.removeClass("has-alert has-feedback js-form-error")}}class s{constructor(e){if(!e.exists()){e=s.create({})}this.$rowWrapper=e}static defaults(){return{type:"1",weekDay:"",monthDay:"",scheduledTime:[{active:false,time:""}]}}static get(e){let t;if(e.is("tr[data-schedule-row]")){t=e}else{t=e.closest("tr[data-schedule-row]")}return new s(t)}static create(e){e=$.extend(s.defaults(),e);const t=AGN.Lib.Template.dom("schedule-period-row",{entry:e});const i=new s(t);t.on("row:add-schedule",function(){const e=t.find("[data-schedule-time-wrapper]");if(e.length>1){t.find('[data-action="remove-schedule"]').closest(".input-group-addon").removeClass("hidden")}});t.on("row:remove-schedule",function(){const e=t.find("[data-schedule-time-wrapper]");if(e.length<2){t.find('[data-action="remove-schedule"]').closest(".input-group-addon").addClass("hidden")}if(e.length===0){i.addSchedule()}});return t}static deserialize(e,t){const i=$.extend(s.defaults(),e);i.type=s._convertTypeToInt(e.type);i.monthDay=s._convertMonthToInt(e.monthDay);return s.create(i)}static _convertTypeToInt(e){switch(e){case"TYPE_MONTHLY":return 2;case"TYPE_WEEKLY":default:return 1}}static _convertMonthToInt(e){switch(e){case"TYPE_MONTHLY_FIRST":return 1;case"TYPE_MONTHLY_15TH":return 15;case"TYPE_MONTHLY_LAST":return 99;default:return 1}}toJson(){const e=this.$rowWrapper.find("[data-schedule-type]").val();let t=undefined;let i=undefined;if(e=="TYPE_MONTHLY"){i=this.$rowWrapper.find("[data-schedule-day-of-month]").val()}else{t=this.$rowWrapper.find("[data-schedule-day-of-week]").val()}const n=_.map(this.$rowWrapper.find("[data-schedule-time-wrapper]"),e=>{const t=$(e).find(".time-checkbox");let i=true;if(t.exists()){i=!t.is(":disabled")&&t.is(":checked")}return{active:i,time:$(e).find("[data-schedule-time]").val()}});return $.extend(s.defaults(),{type:e,weekDay:t,monthDay:i,scheduledTime:n})}addSchedule(e){const t=i.create(e);this.$rowWrapper.find("[data-schedule-time-container]").append(t);AGN.runAll(t);this.$rowWrapper.trigger("row:add-schedule")}removeSchedule(e){i.get(e).remove();this.$rowWrapper.trigger("row:remove-schedule")}}class e{constructor(e){this.$container=e.find("table tbody");this.$container.on("scheduler:add-day scheduler:remove-day",()=>{const e=this.$container.find("[data-schedule-row]").length;const t=this.$container.find('[data-action="remove-day"]');const i=this.$container.find('[data-action="add-day"]');t.addClass("hidden");i.addClass("hidden");if(e>1){t.slice(0,-1).removeClass("hidden")}i.last().removeClass("hidden")})}clean(){this.$container.find("tr[data-schedule-row]").remove()}deleteRow(e){this.deleteRowByNeedle(e.$rowWrapper)}deleteRowByNeedle(e){this.$container.find(e).remove();this.$container.trigger("scheduler:remove-day")}addRow(e){if(e){this.$container.append(e);AGN.runAll(e);this.$container.trigger("scheduler:add-day",e);e.trigger("row:add-schedule",e)}}addEmptyDayRow(){this.addRow(r.create())}addEmptyPeriodRow(){this.addRow(s.create())}getAllDayRows(){const e=this.$container.find("tr[data-schedule-row]");return _.map(e,e=>r.get($(e)))}getAllPeriodRows(){const e=this.$container.find("tr[data-schedule-row]");return _.map(e,e=>s.get($(e)))}getSubmissionJson(e){let t={};if(e=="day"){t=_.map(this.getAllDayRows(),e=>e.toJson())}else if(e=="period"){t=_.map(this.getAllPeriodRows(),e=>e.toJson())}return JSON.stringify(t)}}class n{constructor(e){let t=100;if(e){t=Number(e)}this.intervalPad=t}static hasCorrectInterval(t,e,i){const n=this;let r=true;i.splice(e,1);i.forEach(e=>{if(Math.abs(e-t)<n){r=false}});return r}valid(e){const t=this.intervalPad;return e.every(n.hasCorrectInterval,t)}}AGN.Lib.ScheduleTimeTable=e;AGN.Lib.ScheduleTimeTable.DayRow=r;AGN.Lib.ScheduleTimeTable.PeriodRow=s})();(function(){const n=_.template(`
      {{ const disabled = isDisabled ? 'disabled' : '';}}
      <div class="col-12" data-email-list-manager-row data-action="change-trigger">
        <div class="row g-1">
            <div class="col">
                <input type="text" value="{{= value}}" class="form-control" size="42" maxlength="99" {{- disabled }} />
            </div>
            {{ if (!isDisabled) { }}
                <div class="col-auto">
                     <button type="button" class="btn btn-primary btn-icon" data-action="create-email" data-email-manager-row-add>
                        <i class="icon icon-plus"></i>
                    </button>
                </div>
            {{ } }}
        </div>
      </div>
  `);const o=_.template(`
     <button type="button" class="btn btn-danger btn-icon" data-action="delete-email" data-email-manager-row-delete>
      <i class="icon icon-trash-alt"></i>
    </button>
  `);class r{constructor(e,t,i){this.scope=e;this.data=t;this.options=$.extend({rowTemplate:n,rowSelector:"[data-email-list-manager-row]",addBtnSelector:"[data-email-manager-row-add]",deleteBtnSelector:"[data-email-manager-row-delete]",rowDataMapper:e=>{return{value:e,isDisabled:i.disabled}}},i);_.each(this.data,e=>this.#addFieldRow(this.scope,e,null,this.options))}static initialize(e,t,i){return new r(e,t,i)}createRowAfter(e){this.#addFieldRow(this.scope,"",$(e),this.options)}#addFieldRow(e,t,i,n){const r=n.rowTemplate(n.rowDataMapper(t));if(i&&i.exists()){i.closest(n.rowSelector).after(r)}else{e.append(r)}this.#updateRemoveButtons(e,n)}deleteRow(e){$(e).closest(this.options.rowSelector).remove();this.#updateRemoveButtons(this.scope,this.options)}getJsonData(){const i=[];_.each(this.scope.find(`${this.options.rowSelector} input`),e=>{const t=e.value;if(t.trim()!==""){i.push(t)}});return i}#updateRemoveButtons(e,r){const s=e.find(r.rowSelector);if(s.length===1){s.find(r.deleteBtnSelector).remove()}else{_.each(s,(e,t)=>{const i=$(e);const n=i.find(r.deleteBtnSelector);if(t!=s.length-1&&!n.exists()){i.find(".btn").replaceWith($(o({})))}})}}}AGN.Lib.EmailsListManager=r})();(()=>{const n=AGN.Lib.Field;const i=AGN.Lib.CSRF;class r{static scrollTo(e){const t=this.#findMinScrollPoints(e);const i=this.#findMinScrollPoint(t);t.forEach((e,t)=>{if(t){const i=$(t);i.animate({scrollTop:e-i.offset().top+i.scrollTop()})}});if(AGN.Lib.Helpers.isMobileView()&&!i?.container?.closest(".modal").exists()){const n=$(".tiles-container, .filter-overview");n.animate({scrollTop:i.pos-n.offset().top+n.scrollTop()})}}static#findMinScrollPoints(e){const r=new Map;_.each(e,e=>{const t=$(e);const i=this.#findScrollableContainer$(t).get(0);const n=this.#getFieldContainer(t).offset().top;if(r.has(i)){if(r.get(i)>n){r.set(i,n)}}else{r.set(i,n)}});return r}static#findScrollableContainer$(e){const t=e.closest(".tiles-container > .tile, .filter-overview > .tile, .tiles-block > .tile");return t.exists()?t.find(".tile-body").first():e.closest(".modal-body").first()}static#getFieldContainer(e){const t=e.data("_editor")?.editor;const i=t?$(t.container):e.closest(".has-feedback");return i.exists()?i:e.parent()}static#findMinScrollPoint(e){let i;let n=Infinity;e.forEach((e,t)=>{if(e<n){n=e;i={container:$(t),pos:e}}});return i}}class s{constructor(e){this.group=e;this.$controls=$()}_collect(e){const t=$("[data-controls-group]");if(e==="*"){return t}if(e){return t.filter(function(){return e===$(this).attr("data-controls-group")})}else{return $()}}collect(){if(this.group){this.$controls=this._collect(this.group).filter(function(){const e=$(this);return!e.prop("disabled")&&!e.hasClass("disabled")})}}setDisabled(e){if(e===false){this.$controls.removeClass("disabled");this.$controls.prop("disabled",false)}else{this.$controls.addClass("disabled");this.$controls.prop("disabled",true)}}}class o{constructor(e){this.$form=e;this.form=e[0];this._abort=null;this._data={};this._dataNextRequest={};this.fields=[];this.validatorName=null;this.validatorOptions=null;this.dirtyChecking=e.is("[data-form-dirty-checking]");this.editable=!e.is("[data-editable]")||!!e.data("editable");this.url=e.attr("action");this.urlNextRequest=null;this.methodNextRequest=null;this.method=e.attr("method");this.isMultipart="multipart/form-data"==(e.attr("enctype")||"").toLowerCase();this.isCustomLoader=e.is("[data-custom-loader]");this.controlsToDisable=new s(e.attr("data-disable-controls"));if(e.is("[data-custom-loader]")){this.isCustomLoader=e.attr("data-custom-loader")!=="false"}else{this.isCustomLoader=false}this.initFields();this.initValidator();this.handleMessages($("body"),true);if(this.dirtyChecking){this.#enableDirtyChecking(e)}if(!this.editable){e.find(":input").prop("disabled",true)}}#enableDirtyChecking(e){e.dirty({preventLeaving:true,leavingMessage:t("grid.layout.leaveQuestion")});window.onbeforeunload=()=>{if(!e.dirty("isDirty")===true){AGN.Lib.Loader.show()}}}static get(e){const t=o.getWrapper(e);let i=t.data("_form");if(!i){const n=t.data("form");const r=AGN.Opt.Forms[n]||AGN.Lib.Form;i=new r(t);t.data("_form",i)}return i}static getWrapper(e){let t=$(e.data("form-target"));if(!t.exists()){if(e.attr("form")){t=$(`#${e.attr("form")}`)}if(!t.exists()){t=e.closest("form")}}return t}valid(e){const t=$.Event("validation");e=_.merge({},this.validatorOptions,e);this.$form.trigger(t,e);if(t.isDefaultPrevented()){return false}const i=_.every(this.fields,e=>e.valid());if(this.validatorName){const n=AGN.Lib.Validator.get(this.validatorName);if(n){return n.valid(this,e,i)}}return i}validate(e){if(this.valid(e)){this.cleanFieldFeedback();return true}else{this.handleErrors();return false}}validateField(t){this.cleanFieldFeedback(t);const e=this.fields.find(e=>e.isInitializedFor(t));if(e&&!e.valid()){this.#handleErrors(e.errors())}}get$(){return this.$form}getAction(){if(this.urlNextRequest){const e=this.urlNextRequest;this.urlNextRequest=null;return e}return this.url}setActionOnce(e){this.urlNextRequest=e}setMethodOnce(e){this.methodNextRequest=e}getMethod(){if(this.methodNextRequest){const e=this.methodNextRequest;this.methodNextRequest=null;return e}return this.method}errors(){let e=this.fields.map(e=>e.errors()).flat();if(this.validatorName){const t=AGN.Lib.Validator.get(this.validatorName);if(t){e=e.concat(t.errors(this,this.validatorOptions))}}return e}setValue(e,t){const i=this.form[e];if(typeof i==="object"){const n=$(i);if(n.is("select")){AGN.Lib.Select.get(n).selectValue(t)}else{n.val([t])}n.trigger("change")}else{if(typeof t==="undefined"){delete this._data[e]}else{this._data[e]=t}}}setValueOnce(e,t){if(typeof t==="undefined"){delete this._dataNextRequest[e]}else{this._dataNextRequest[e]=t}}getValue(e){const t=this.form[e];if(typeof t==="object"){return t.value}else{return this._data[e]}}getValues(e){const t=this.form[e];if(t instanceof NodeList){return Array.from(t,e=>e.value)}return[this.getValue(e)]}data(){if(this.isMultipart){const n=new FormData;const i=this.$form.serializeFormDataObject();$.each(this._data,(e,t)=>{if(!i.hasOwnProperty(e)){i[e]=t}});$.each(this._dataNextRequest,(e,t)=>{i[e]=t});$.each(i,(i,e)=>{if($.isArray(e)){$.each(e,(e,t)=>{n.append(i,t)})}else{n.append(i,e)}});return n}else{return _.merge({},this._data,this.$form.serializeObject(),this._dataNextRequest)}}params(){return $.param(this.data(),true)}jqxhr(){var i=this,e=$.ajaxSettings.xhr(),t,s=$.Deferred();this.$form.trigger("form:submit");const n={url:this.getAction(),method:this.getMethod(),loader:this.loader(),xhr:function(){return e}};if(this.isMultipart){n.data=this.data();n.enctype="multipart/form-data";n.processData=false;n.contentType=false}else{n.data=this.params()}if(this.isCustomLoader){var r=function(e){var t=true;if(e.lengthComputable){t=(e.loaded/e.total*100).toFixed(1)}i.$form.trigger("form:progress",{loaded:e.loaded,total:e.total,progress:t})};if("upload"in e){n.xhr=function(){e.upload.onprogress=r;return e}}else{n.xhrFields={onprogress:r}}}if(typeof e.abort==="function"){this._abort=function(){e.abort()}}t=$.ajax(n);this._dataNextRequest={};this.setLoaderShown(true);s.always(function(){i.setLoaderShown(false)});t.done(function(i){var e=$(i),t,n,r;t=e.filter('[data-form="polling"]').add(e.find('[data-form="polling"]'));if(t.length==1){n=o.get(t);r=n.jqhxr();r.done(function(){s.resolve.apply(this,arguments);var e=$("body");var t=$("<div></div>");t.html(i);t.find('script[data-message][type="text/html"]').appendTo(e);t.find('script[data-message][type="text/javascript"]').each(function(){try{eval.call(window,$(this).html())}catch(e){}});t.remove()});r.fail(function(){s.reject.apply(this,arguments)})}else{s.resolve(i)}});t.fail(function(){s.reject.apply(this,arguments)});return s.promise()}_submit(){const t=this;this.setLoaderShown(true);const e=this.jqxhr();e.done(function(e){t.setLoaderShown(false);t.updateHtml(e);t.$form.trigger("submitted",e);if(t.dirtyChecking){t.#changeDirtyState(t.$form)}});return e}#changeDirtyState(e){const t=$("body").has(e).length===0;if(t){e.dirty("destroy")}else{e.dirty("setAsClean")}}_submitStatic(){const e=this.data();if(i.isProtectionEnabled()){e[i.getParameterName()]=i.readActualToken()}const r=$(`<form method="${this.getMethod()}" action="${this.getAction()}"></form>`);_.each(e,(e,t)=>{if(_.isArray(e)){const i=$(`<select multiple name="${t}"></select>`);_.each(e,e=>{const t=$('<option selected="selected"></option>');t.val(e);t.appendTo(i)});i.appendTo(r)}else{const n=$(`<input type="hidden" name="${t}"/>`);n.val(e);n.appendTo(r)}});r.appendTo($("body"));r.submit();r.remove();this._dataNextRequest={}}_submitEvent(){var e=$.Event("submission");this.$form.trigger(e);if(!e.isDefaultPrevented()){this.$form.trigger("submitted");this._dataNextRequest={}}}_submitConfirm(){const e=this.jqxhr();e.done(e=>this.$form.trigger("submitted",e));return e}submit(e,t={}){_.each(this.fields,e=>e.onSubmit());if(this.valid(t)){this.cleanFieldFeedback()}else{this.handleErrors();return false}switch(e){case"static":return this._submitStatic();case"confirm":return this._submitConfirm();case"event":return this._submitEvent();default:return this._submit()}}revertAction(){}reset(){this.$form.trigger("reset");AGN.Lib.CoreInitializer.run("select",this.$form)}abort(){this.$form.trigger("form:abort");if(this._abort){this._abort();this._abort=null}}clear(){_.forEach(this.data(),(e,t)=>this.setValue(t,""))}handleMessages(e,t){const n=this;if(!(e instanceof $)){e=$(e)}e.all('script[data-message][type="text/html"]').each(function(){const e=$(this);const t=e.text();const i=e.data("message");if(t&&i){n.showFieldError(i,t)}});if(t===true){return}const i=e.all("script[data-message]");_.each(i,e=>$("body").append(e))}initFields(e=$(document)){this.fields.length=0;e.all("[data-field]").each((e,t)=>{const i=$(t);if(o.getWrapper(i).is(this.$form)){this.fields.push(n.create(i))}})}initValidator(){this.validatorName=this.$form.data("validator");var e=this.$form.data("validator-options");this.validatorOptions=e?AGN.Lib.Helpers.objFromString(e):null}updateHtml(e){let t;if(this.$form.attr("id")){t=$(e).all(`#${this.$form.attr("id")}`)}else if(this.$form.attr("name")){t=$(e).all(`[name="${this.$form.attr("name")}"]`)}else{t=$(e).all("form")}this.$form.html(t.html());this.handleMessages(e);this.initFields();this.initValidator();AGN.Lib.Controller.init(this.$form);AGN.runAll(this.$form)}loader(){const e=this;return{show:function(){e.controlsToDisable.collect();e.controlsToDisable.setDisabled(true);e.setLoaderShown(true)},hide:function(){e.controlsToDisable.setDisabled(false);e.setLoaderShown(false)}}}setLoaderShown(e){if(this.isCustomLoader){if(e){this.$form.trigger("form:loadershow")}else{this.$form.trigger("form:loaderhide")}}else{if(e){AGN.Lib.Loader.show()}else{AGN.Lib.Loader.hide()}}}cleanFieldFeedback(e){o.cleanFieldFeedback$(e,this.$form);if(!e&&this.$form.attr("id")){const t=$(`:input[form='${this.$form.attr("id")}']`);t.each((e,t)=>o.cleanFieldFeedback$($(t)))}}static cleanFieldFeedback$(e,t){const i=e?o.#findAnchorForFeedback(e).parent():t.find(".js-form-field-feedback");_.each(i,e=>{const t=$(e);t.removeClass("has-feedback has-alert has-success has-warning js-form-field-feedback");t.find(".form-control-feedback-message").remove()})}static appendFeedbackMessage(e,t,i="alert"){o.#findAnchorForFeedback(e).parent().append(AGN.Lib.Template.text("input-feedback",{type:i,message:t}));e.data("_editor")?.editor?.resize()}handleErrors(){this.cleanFieldFeedback();this.#handleErrors(this.errors())}#handleErrors(e){e=e.filter(e=>e.field?.exists());_.each(e,e=>{const t=e.field;this.markField(t);o.appendFeedbackMessage(t,e.msg)});const t=e.map(e=>e.field);r.scrollTo(t)}cleanFieldError(e){if(this.form[e]){this.cleanFieldError$($(this.form[e]))}}cleanFieldError$(e){this.cleanFieldFeedback(e)}showFieldError(e,t,i){if(this.form[e]){this.showFieldError$($(this.form[e]),t,i)}}showFieldError$(e,t,i){o.showFieldError$(e,t,i)}static showFieldError$(e,t,i){o.markField(e);e.closest(".js-form-field-feedback").find(".form-control-feedback-message").remove();o.appendFeedbackMessage(e,t);if(i!==true){o.scrollToField(e)}}markField(e,t="alert"){o.markField(e,t)}static markField(e,t="alert"){const i=o.#findAnchorForFeedback(e);i.parent().addClass(`has-${t} has-feedback js-form-field-feedback`)}static#findAnchorForFeedback(e){if(e.is("[data-feedback-anchor]")){return e.closest(e.data("feedback-anchor"))}const t=e.data("_editor")?.editor;if(!t||!t.container){return e}return $(t.container)}static scrollToField(e){r.scrollTo(e)}}AGN.Lib.Form=o})();(()=>{class i{constructor(e){this.$el=e;this.config=null;$.get(AGN.url(e.data("help"))).done(e=>{this.config=$(e);this.popover();this.show()})}show(){this.$el.popover("show")}getConfig(e){const t=this.config.find(e).text().replace("<![CDATA[","").replace("]]>","");if(!this.$el.is("[data-help-config]")){return t}return _.template(t)($(this.$el.data("help-config")).json())}popover(){if(!this.config){return}this.$el.popover("dispose");const e=AGN.Lib.Popover.create(this.$el,{title:this.getConfig("title"),content:this.getConfig("content"),html:true,trigger:"manual",popperConfig:{placement:"bottom-start"}});const n=$(e.tip);n.attr("tabindex",0);n.css("outline","none");let t=null;const i=()=>{t=setTimeout(()=>e.hide(),100)};const r=()=>clearTimeout(t);n.focusout(i);this.$el.focusout(i);n.focusin(r);this.$el.focusin(r);this.$el.on("shown.bs.popover",function(){const e=n.children(".popover-content");const t=e.css("min-width");const i=e.outerWidth();e.css("min-width","100%");e.css("min-width",e.outerWidth());if(i>e.outerWidth()){e.css("min-width",t||"0px")}})}static show(e){const t=e.data("agn:help");if(t){t.show()}else{e.data("agn:help",new i(e))}}}AGN.Lib.Help=i})();(()=>{let mobileViewThreshold=0;AGN.Lib.Helpers={paramsFromUrl:function(e){var t={};var i;if(e){i=e.indexOf("?")}else{return t}if(i==-1)return t;var n=e.substring(i+1);var r=n.split("&");for(var s=0;s<r.length;s++){var o=r[s].split("=");t[o[0]]=o[1]}return t},objFromString:function(optsAsString){var optsArray,optsSplitRegex=/,\s*(?=(?:[^'\\]*(?:\\.|'(?:[^'\\]*\\.)*[^'\\]*'))*[^']*$)/m,tupleSplitRegex=/:\s*(?=(?:[^'\\]*(?:\\.|'(?:[^'\\]*\\.)*[^'\\]*'))*[^']*$)/m,floatRegex=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,arrayRegex=/^\s?\[.*?\]$/i;opts={};if(optsAsString===""||optsAsString===undefined){return opts}optsArray=optsAsString.split(optsSplitRegex);_.forEach(optsArray,function(opt){var tup=opt.split(tupleSplitRegex),name,value;tup=_.filter(tup);name=tup[0].replace(/^'([^]*?)'$/m,"$1");name=name.replace(/\\/,"");value=tup[1];if(typeof value==="undefined"){value=""}if(value=="true"){value=true}else if(value=="false"){value=false}else if(floatRegex.test(value)){value=parseFloat(value)}else if(arrayRegex.test(value)){value=value.replace(/\[|\]/g,"");value=value.split(/\s+/);value=_.map(value,function(v){if(/^\'(.*?)\'$/.test(v)){return v.replace(/^\'(.*?)\'$/g,"$1")}else{return eval(v)}})}else{value=value.replace(/^'(.*?)'$/m,"$1");value=value.replace(/\\/,"")}opts[name]=value});return opts},disableCSSAnimations:function(){var e=$('<style class="disable-animation">* { -webkit-transition: none !important; -o-transition: none !important; transition: none !important; }</style>');$("body").append(e)},enableCSSAnimations:function(){window.setTimeout(function(){$(".disable-animation").remove()},10)},clearFormField:function(e){var t=$("<form></form>");var i=$("<div></div>");i.insertAfter(e);t.append(e);t.get(0).reset();e.insertBefore(i);i.remove()},renameFile:function(e,t){Object.defineProperty(e,"name",{writable:true,value:t})},formatBytes:function(e,t){if(e==0)return"0 Bytes";if(e==1)return"1 Byte";if(e==-1)return"-1 Byte";var e=Math.abs(e);if(t&&t.toLowerCase()&&t.toLowerCase()=="iec"){var i=Math.pow(2,10);var n=["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]}else{var i=Math.pow(10,3);var n=["Bytes","kB","MB","GB","TB","PB","EB","ZB","YB"]}var r=Math.floor(Math.log(e)/Math.log(i));var s=e/Math.pow(i,r);if(e<0){s*=-1}if(s>=99.995||r==0){return s.toFixed(0)+" "+n[r]}else{return s.toFixed(2)+" "+n[r]}},pad:function(e,t,i){i=i||"0";var n=e+"";if(n.length<t){return new Array(t-n.length+1).join(i)+n}else{return n}},caching:function(e,t){var i=false;var n;if(arguments.length>1){e=_.bind.apply(null,Array.prototype.slice.call(arguments))}return function(){if(!i){i=true;n=e()}return n}},replaceAgnTags:function(e,a){try{return e.replace(/\[(agn[A-Z0-9_]+)(?:[^'"\]]|'.*?'|".*?")+]/g,function(e,t){var i=$("<"+e.substring(1,e.length-1)+">")[0];if(i instanceof HTMLElement){var n=i.attributes;var r={};for(var s=0;s<n.length;s++){var o=n[s];r[o.nodeName]=o.nodeValue}return a({name:t,attributes:r},e)}return e})}catch(e){}return e},escapeAgnTags:function(e){try{if(e){return e.replace(/\[agn[A-Z0-9]+(?:[^'"\]]|'.*?'|".*?")+]/g,function(e){if(e.includes("'")||e.includes('"')){return _.escape(e)}else{return e}})}}catch(e){}return e},unescapeAgnTags:function(e){try{if(e){return e.replace(/\[agn[A-Z0-9]+(?:(?!&#39;|&quot;)[^'"\]]|=\s*&#39;.*?&#39;|=\s*&quot;.*?&quot;)*]/g,function(e){return _.unescape(e)})}}catch(e){}return e},isValidEmail:function(e){const t=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(String(e).toLowerCase())},isUrl:function(e){const t=/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&/=]*)$/;return t.test(e)},isNumber:e=>{return typeof e==="number"},deepFreeze:function(e){Object.freeze(e);const t=Object.getOwnPropertyNames(e);for(const i of t){const n=e[i];if(typeof n==="object"&&n!==null&&!Object.isFrozen(n)){this.deepFreeze(n)}}return e},isMobileView:function(){if(mobileViewThreshold===0){mobileViewThreshold=parseInt($("html").css("--mobile-view-threshold"))}return $(window).width()<=mobileViewThreshold},openHelpModal:function(t="",i={}){const e=t==="manual"?i.key:window.helpKey;$.get(AGN.url(`/support/help-center.action?helpKey=${e}`)).done(e=>{AGN.Lib.Confirm.create(e).done(e=>Page.render(e));if(t){$(`[data-help-tab="${t}"]`).trigger("help-tab:open",i)}})},getColorLuminance:function(e){if(e===undefined||e===null){return e}e=e.replace("#","");const t=parseInt(e.substring(0,2),16);const i=parseInt(e.substring(2,4),16);const n=parseInt(e.substring(4,6),16);return(.299*t+.587*i+.114*n)/255},isFilledTextNode:function(e){return e.nodeType===3&&e.nodeValue?.trim()?.length>0},containsTruncatedElements:function(t){if($(t).is("select, .select2")){return false}if($(t.parentElement).is(":truncated")){return true}if(t.childNodes&&t.childNodes.length>0){for(let e=0;e<t.childNodes.length;e++){const i=this.containsTruncatedElements(t.childNodes[e]);if(i){return i}}}return false},retrieveTextElement:function(t){if(this.isFilledTextNode(t)){return t.parentElement}if(t.childNodes&&t.childNodes.length>0){for(let e=0;e<t.childNodes.length;e++){const i=this.retrieveTextElement(t.childNodes[e]);if(i){return i}}}return null}}})();(()=>{class e{constructor(e=6e4){this.cache=new Map;this.cacheDuration=e}set(e,t){const i=Date.now()+this.cacheDuration;this.cache.set(e,{data:t,expiration:i})}get(e){const t=this.cache.get(e);if(!t){return null}if(t.expiration<Date.now()){this.delete(e);return null}return t.data}clear(){this.cache.clear()}delete(e){this.cache.delete(e)}}AGN.Lib.InMemoryCache=e})();(()=>{const e=AGN.Opt.Templates;const i=_.template(e["plus-btn"]);const n=_.template(e["trash-btn"]);class r{constructor(e,t=[],i){const n=e.find("script[data-config]");this.config=n.exists()?n.json():{readonly:i,data:t};this.readonly=this.config.readonly;this.$container=e;this.rowTemplateMustache=_.template(this.rowTemplate);this.renderTable(this.config.data);this.addActions();this.$container.data("table",this)}static get(e){return $(e).data("table")}get rowTemplate(){if(this._rowTemplate?.length){return this._rowTemplate}this._rowTemplate=this.$container.find("[data-row-template]").html();return this._rowTemplate}get headerTemplate(){if(this._headerTemplate?.length){return this._headerTemplate}this._headerTemplate=this.$container.find("[data-input-table-header-template]").html();return this._headerTemplate}get $rowTemplate(){return $(this.rowTemplate)}renderTable(e,t=true){if(t){this.$table=$("<table>").addClass("input-table").append($("<tbody>"));if(this.readonly){this.$table.addClass("input-table--readonly")}if(this.headerTemplate){const i=$(_.template(this.headerTemplate)());if(!this.readonly){i.append("<th></th>")}this.$table.prepend($("<thead>").append(i))}this.$container.prepend(this.$table)}_.each(e,e=>this.addRow(e));if(!this.readonly){this.addEmptyRow()}}addActions(){const e=this;this.addAction({click:"[data-add-row]"},this.addEmptyRow.bind(this));this.addAction({enterdown:"input"},function(){this.event.preventDefault();e.getNextInputToFocus(this.el).focus()});this.addAction({click:"[data-delete-row]"},function(){e.removeRow(this.el)})}removeRow(e){e.closest("tr").remove();this.$container.trigger("input-table:row-removed")}addAction(e,t){AGN.Lib.Action.new(e,t,this.$table)}collect(e=true){let t=this.$table.find("tr").toArray();if(!e){t=t.slice(0,-1)}return t.filter(e=>!this.isEmptyRow$($(e))).map(e=>this.getRowData($(e)))}getRowData(e){return e.find(":input[data-name]").toArray().reduce((e,t)=>{e[$(t).data("name")]=this.getInputVal($(t));return e},{})}getInputVal(e){if(e.is(":checkbox")){return e.is(":checked")}return e.val()?.trim()}addRow(e){if(!this.isUniqueRow(e)){return}const t=$(this.rowTemplateMustache(e));if(!this.readonly){const i=this.generateRowBtn(e);t.append($("<td>").html(i))}this.$table.append(t);AGN.runAll(t);AGN.Lib.Form.get(this.$table).initFields()}getNextInputToFocus(e){const t=e.closest("tr");if(this.isEmptyRow$(t)){return t.find(':input[type="text"]:first')}const i=t.find(':input[type="text"]');const n=i.index(e);let r=i.eq(n+1);if(r.length){return r}r=t.next().find(':input[type="text"]:first');if(r.length){return r}this.addEmptyRow();return this.$table.find('tbody tr:last input[type="text"]:first')}generateRowBtn(e){return this.#isEmptyRow(e)?this.generateAddBtn():this.generateDeleteBtn()}generateAddBtn(){return i({attrs:`data-add-row data-tooltip='${t("defaults.add")}'`})}generateDeleteBtn(){return n({attrs:`data-delete-row data-tooltip='${t("defaults.clear")}'`})}#isEmptyRow(e){return this.getRowEntries(e).every(([,e])=>this.#isBlank(e))}getNames(){return this.$rowTemplate.find("[data-name]").toArray().map(e=>$(e).data("name"))}getRowEntries(e){const t=this.getNames();return Object.entries(e).filter(([e])=>t.includes(e))}isEmptyRow$(e){return _.every(e.find(':input:not([type="hidden"])'),e=>{const t=$(e);return t.prop("disabled")||this.#isBlank(t.val())})}#isBlank(e){return e===null||e===undefined||String(e).trim()===""}addEmptyRow(){const e=this.$table.find("tbody tr:last");if(!e.length||!this.isEmptyRow$(e)){this.replaceNewButtonWithDeleteButton();this.addRow(this.getNames().reduce((e,t)=>{e[t]="";return e},{}))}this.focusOnLastRow()}focusOnLastRow(){this.$table.find("tbody tr:last input:first").focus()}isUniqueRow(e){if(this.#isEmptyRow(e)){return true}const t=this.getRowEntries(e);return!this.$table.find("tbody tr").toArray().some(i=>{return t.every(([e,t])=>$(i).find(`[data-name="${e}"]`).val()===t)})}replaceNewButtonWithDeleteButton(){const e=this.$table.find("[data-add-row]");const t=$(this.generateDeleteBtn());e.after(t);e.remove();AGN.Lib.CoreInitializer.run("tooltip",t)}#replaceLastDeleteButtonWithNewButton(){const e=$(this.generateAddBtn());this.$table.find("[data-delete-row]:last").after(e).remove();AGN.Lib.CoreInitializer.run("tooltip",e)}removeLastRow(){if(this.$container.find("tbody tr").length>1){this.$container.find("tbody tr:last").remove();this.#replaceLastDeleteButtonWithNewButton()}}clean(){this.$table.find("tbody tr").remove();this.addEmptyRow()}update(e){this.$table.find("tbody tr").remove();this.renderTable(e,false)}get readonlyAttr(){return this.readonly?"readonly":""}}AGN.Lib.InputTable=r})();(()=>{class i{static DATA_KEY="agn:load";constructor(e){this.el=e;this.url=e.data("load");this.interval=parseInt(e.data("load-interval"));this.target=e.data("load-target");if(this.interval){this._interval=window.setInterval(()=>this.load(),this.interval)}this.el.removeAttr("data-load");this.el.data(i.DATA_KEY,this)}stop(){window.clearInterval(this._interval)}load(){if(this.loading){return}this.loading=true;$.get(this.url).always(()=>{if(this.interval){this.loading=false}}).done(e=>{const t=$(e);if(t.all("[data-load-stop]").exists()){this.stop()}let i;if(!this.target){i=e}else if(this.target=="body"){i=/<body[^>]*>((.|[\n\r])*)<\/body>/im.exec(e)[1]}else{i=t.all(this.target)}if(this.el.is("[data-load-replace]")){this.el.replaceWith(i);this.el=i}else{this.el.html(i)}AGN.Lib.Controller.init(this.el);AGN.runAll(this.el)}).fail(()=>this.stop)}static load(e){const t=i.get(e);if(t){t.load();return}if(e.is(":hidden")){return}new i(e).load()}static get(e){return e.data(i.DATA_KEY)}}AGN.Lib.Load=i})();(()=>{let e={},t,i=0,n=false;e.show=function(){window.clearTimeout(t);if(!n){i+=1;$(".loader--main").removeClass("hidden")}else{n=false}};e.hide=function(){i-=1;if(i<=0){t=window.setTimeout(()=>{$(".loader--main").addClass("hidden")},5);i=0}};e.prevent=function(){n=true};AGN.Lib.Loader=e})();(function(){const e=AGN.Lib.Form;class t extends e{constructor(e){super(e);AGN.Lib.Loader.show();this.submit()}jqxhr(){const t=$.Deferred();this.$form.trigger("form:submit");window.setTimeout(()=>{$.ajax({url:this.url,method:this.method,data:this.params(),loader:this.loader()}).done(function(e){t.resolve.apply(this,arguments)})},parseInt(this.$form.data("polling-interval")));return t.promise()}submit(){const e=this.jqxhr();e.done(e=>this.updateHtml(e));return e}updateHtml(e){const t=$(e).all('[data-form="loading"]');if(t.exists()){this.$form.html(t.html());AGN.runAll(this.$form);this.submit()}else{AGN.Lib.Loader.hide();AGN.Lib.Modal.getInstance(this.$form)?.hide();AGN.Lib.Page.render(e)}}}AGN.Lib.LoadingForm=t;AGN.Opt.Forms["loading"]=t})();(()=>{const Messages=function(e,t,i,n,r){const s={timeout:{success:3e3,warning:15e3,alert:6e4}};if(!i){i="info"}const o=s["timeout"][i||"info"]||0;if(findMessagesWithSameContent(e,t).length){return}const a=toastr[i](e,t,{timeOut:o,extendedTimeOut:o,onCloseClick:n,newestOnTop:r});AGN.Lib.Controller.init(a);AGN.runAll(a)};const findMessagesWithSameContent=function(n,r){return $(".popup-tab:not(.arrow)").filter((e,t)=>{const i=$(t).data("options");return n===i.title&&r===i.message})};const displayMessages=function(t,e,i){e.forEach(e=>Messages(t,e,i))};const JsonMessages=function(e,i=false){if(i){_.each($(".popup"),e=>$(e).remove())}if(e){if(e.success){displayMessages(t("defaults.success"),e.success,"success")}if(e.warning){displayMessages(t("defaults.warning"),e.warning,"warning")}if(e.alert){displayMessages(t("defaults.error"),e.alert,"alert")}if(e.fields){$.each(e.fields,function(e,i){if(i){displayMessages(t("defaults.error"),i,"alert")}})}}};const RenderMessages=function($resp){$resp.all('script[data-message][type="text/html"]').appendTo($(document.body));$resp.all('script[data-message][type="text/javascript"]').each(function(){try{eval($(this).html())}catch(exception){console.debug(exception)}})};Messages.success=function(e,...i){Messages.successText(t(e,...i))};Messages.successText=function(e){Messages(t("defaults.success"),e,"success")};Messages.alert=function(e,...i){Messages.alertText(t(e,...i))};Messages.alertText=function(e){Messages(t("Error"),e,"alert")};Messages.warn=function(e,...i){Messages.warnText(t(e,...i))};Messages.warnText=function(e){Messages(t("defaults.warning"),e,"warning")};Messages.info=function(e,...i){Messages.infoText(t(e,...i))};Messages.infoText=function(e){Messages(t("defaults.info"),e,"info")};Messages.defaultSaved=function(){Messages.success("defaults.saved")};Messages.defaultError=function(){Messages.alert("defaults.error")};AGN.Lib.Messages=Messages;AGN.Lib.JsonMessages=JsonMessages;AGN.Lib.RenderMessages=RenderMessages})();(function(){var r={};function e(e){var t="key#"+e;var i=r[t];var n=Array.prototype.slice.call(arguments,1);if(i){r[t]=i.filter(function(e){return e.apply(this,n)!==false})}}function t(e,t){var i="key#"+e;if($.isFunction(t)){if(!r[i]){r[i]=[]}r[i].push(t)}else{console.error("Callback must be a function")}}function i(e,t){if(arguments.length){var i="key#"+e;if(arguments.length>1){r[i]=r[i].filter(function(e){return e!==t})}else{r[i]=[]}}}AGN.Lib.Messaging={send:e,subscribe:t,unsubscribe:i}})();(()=>{class i{static create(e,t){let i=null,n;if(e instanceof $){n=e}else{n=$(e)}const r=n.filter(".modal");const s=n.filter("script");if(r.exists()){i=$(r[0]);i.data("_modal",t);s.each(function(){$(this).appendTo(i)});new bootstrap.Modal(i,{focus:false}).show();AGN.Lib.RenderMessages(n);AGN.Lib.Controller.init(i);AGN.runAll(i)}else{AGN.Lib.RenderMessages(n)}return i}static fromTemplate(e,t={}){return i.create(AGN.Lib.Template.text(e,t),t)}static get(e){const t=i.getWrapper(e);return t.data("_modal")}static getWrapper(e){return e.closest(".modal")}static getInstance(e){const t=i.getWrapper(e);return bootstrap.Modal.getInstance(t)}}AGN.Lib.Modal=i})();(function(){var u=AGN.Lib.Confirm,d={};function r(e){if(e){e=e.toUpperCase();switch(e){case"CONNECT":case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"POST":case"PUT":return e}}return"GET"}d.render=function(e,t){if(/<\s*\/\s*body\s*>/i.test(e)){var i=new DOMParser;var n=i.parseFromString(e,"text/html");if(t!==false&&n.head){var r=$(n.head).data("origin-uri");if(r){t=r}}if(t){window.history.pushState({},"",t)}var s=$(document).scrollTop();setTimeout(function(){AGN.Lib.Controller.init();AGN.runAll();$(document).scrollTop(s)},100);document.body=n.body;document.title=n.title;var o=$(document.body);o.find("script").each(function(e,t){var i=$(t);if(i.attr("src")){var n=$("<script><\/script>");$.each(t.attributes,function(){if(this.specified){n.attr(this.name,this.value)}});try{n.appendTo(o)}catch(e){console.debug(e)}}else if(i.attr("type")=="text/javascript"){try{eval.call(window,i.html())}catch(e){console.debug(e)}}})}else{var a=$(e);var l=a.filter(".modal");if(l.exists()){var c=$.Deferred();AGN.Lib.RenderMessages(a);u.create(a);c.resolve(u.get(a));return c.promise()}else{l=a.all("script[data-load]");if(l.exists()){return d.reload(l.data("load"),true).done(function(){AGN.Lib.RenderMessages(a)})}else{AGN.Lib.RenderMessages(a)}}}};d.reload=function(i,e,t){if(e){i=i||window.location.href;var n=$.Deferred();$.ajax(i,{method:r(t)}).done(function(e){var t=d.render(e,i);if(t){t.done(n.resolve).fail(n.reject)}else{n.resolve()}}).fail(function(){n.reject()});return n.promise()}else{if(i&&i!=window.location.href){window.location.assign(i)}else{window.location.reload(true)}return null}};AGN.Lib.Page=d})();(function(){class i{static policyMap=new Map;static findPasswordPolicy(e){if(i.policyMap.has(e)){return i.policyMap.get(e)}return["password.error.generic_error"]}static registerPolicy(e,t){i.policyMap.set(e,t)}}i.registerPolicy("LENGTH_8_MIXED",e=>{const t=[];if(e.length<8){t.push("password.error.too_short_min8")}if(!e.match("[a-z]")){t.push("password.error.no_lower_case")}if(!e.match("[A-Z]")){t.push("password.error.no_upper_case")}if(!e.match("[0-9]")){t.push("password.error.no_digits")}if(!e.match("[^a-zA-Z0-9]")){t.push("password.error.no_special")}return t});i.registerPolicy("LENGTH_12_SIMPLE",e=>{return e.length<12?["password.error.too_short_min12"]:null});i.registerPolicy("WEBSERVICE",e=>{return e.length<32?["password.error.too_short_min32"]:null});AGN.Lib.PasswordPolicies=i})();(function(){const r=AGN.Lib.Page;const e=AGN.Lib.Form;class t extends e{constructor(e){super(e)}jqhxr(){var n=this,r=$.Deferred();this.$form.trigger("form:submit");window.setTimeout(function(){var e=$.ajax({url:n.url,method:n.method,data:n.params(),loader:n.loader()});e.done(function(e){var t=$(e);var i=t.all('[data-form="polling"]');if(i.length==1){n.$form.data("polling-interval",i.data("polling-interval"));n.jqhxr().done(function(){r.resolve.apply(this,arguments)})}else{r.resolve.apply(this,arguments)}})},parseInt(this.$form.data("polling-interval")));return r.promise()}submit(){var e,t=this;AGN.Lib.Loader.show();e=this.jqxhr();e.done(function(e){AGN.Lib.Loader.hide();t.updateHtml(e)});return e}updateHtml(e){var t,i=$(e),n=this.$form.data("render");if(n=="page"){r.render(e)}else{if(this.$form.attr("id")){t=i.all("#"+this.$form.attr("id"))}else if(this.$form.attr("name")){t=i.all('[name="'+this.$form.attr("name")+'"]')}else{t=i.all("form")}setTimeout(function(){AGN.Lib.Controller.init();AGN.runAll()},100);this.handleMessages(e);this.$form.replaceWith(t)}}}AGN.Lib.PollingForm=t;AGN.Opt.Forms["polling"]=t})();(c=>{const r=function(e,t){const i=c(e);const n=c(t);const r=c(window).scrollTop();const s=c(window).outerHeight();const o=n.outerHeight();const a=n.offset().top-r;const l=a+o;if(i.outerHeight()<=a){return"top"}return s-l>a?"bottom":"top"};const s=(e,t)=>{const i=c(t).outerWidth();if(e.placement==="bottom-end"){return[-i,0]}if(e.placement==="bottom-start"){return[i,0]}return[0,0]};class e{static instances=[];static getOrCreate(e,t){return this.get(e)||this.create(e,t)}static create(e,t){if(e.length!==1){return false}const i={trigger:"hover",container:"body",animation:false,content:e.text(),placement:r,offset:s};const n=new bootstrap.Popover(e[0],c.extend(i,t));this.instances.push(n);return n}static get(e){if(e.length!==1){return null}const t=bootstrap.Popover.getInstance(e);if(t){return t}const i=e.closest("div.popover");if(i.length){return bootstrap.Popover.getInstance(i)}}static remove(e){this.#removePopover(this.get(e));return true}static hide(e){this.get(e)?.hide()}static validate(){_.each(Array.from(this.instances),e=>{if(e._element&&!c.contains(document.body,e._element)){this.#removePopover(e)}})}static#removePopover(e){const t=this.instances.indexOf(e);if(t!==-1){this.instances.splice(t,1)}e?.dispose()}}AGN.Lib.Popover=e})(jQuery);(()=>{class i{static init(e){const t=AGN.Lib.Storage.get(i.#getStorageKey(e));if(t){e.prop("checked",!t.preview);i.#toggleUI(e)}}static toggle(e){i.#toggleUI(e);AGN.Lib.Storage.set(i.#getStorageKey(e),{preview:i.#isPreviewEnabled(e)})}static#toggleUI(e){const t=$(e.data("preview-table"));t.toggleClass("table--preview",i.#isPreviewEnabled(e))}static#isPreviewEnabled(e){return!e.is(":checked")}static#getStorageKey(e){return`preview-table-${e.data("preview-table")}`}}AGN.Lib.PreviewTable=i})();(function(){const e=AGN.Lib.Form;const o=AGN.Lib.Page;class t extends e{constructor(e){super(e);this.resourceSelector=e.data("resource-selector")}getResourceSelector(){if(this.resourceSelectorNextRequest){var e=this.resourceSelectorNextRequest;this.resourceSelectorNextRequest=null;return e}return this.resourceSelector}setResourceSelectorOnce(e){this.resourceSelectorNextRequest=e}updateHtml(e){var t=this.getResourceSelector();if(t){var i=$(e);var n=$(t);var r=i.all(t);if(n.length==1&&r.length==1){var s=false;if(n[0]==this.$form[0]||$.contains(n[0],this.$form[0])){s=true}n.html(r.html());this.handleMessages(i);if(s){this.initFields();this.initValidator()}AGN.Lib.Controller.init(n);AGN.runAll(n)}else{o.render(e);this.handleMessages(e,true)}}else{o.render(e);this.handleMessages(e,true)}}}AGN.Lib.ResourceForm=t;AGN.Opt.Forms["resource"]=t})();(()=>{class n{static DATA_KEY="agn:perfect-scrollbar";static MARKER_ATTR_NAME="agn-scrollbar";static INSTANCES=[];constructor(e,t={}){this.$el=e;this.scrollbar=new PerfectScrollbar(e[0],_.extend(this.options,t));e.attr(n.MARKER_ATTR_NAME,"");e.data(n.DATA_KEY,this);n.INSTANCES.push(this)}get options(){return{wheelSpeed:1,wheelPropagation:false,minScrollbarLength:30}}destroy(){this.scrollbar.destroy();this.$el.data(n.DATA_KEY,null);this.$el.removeAttr(n.MARKER_ATTR_NAME);delete n.INSTANCES[this]}update(){this.scrollbar.update()}static get(e,t=true){const i=e.data(n.DATA_KEY);if(!t){return i}return i||e.closest(`[${n.MARKER_ATTR_NAME}]`).data(n.DATA_KEY)}static updateAll(){n.INSTANCES.forEach(e=>e.update())}}AGN.Lib.Scrollbar=n})();(function(){const e=AGN.Lib.Form;class t extends e{constructor(e){super(e)}updateHtml(e){const t=$(e).find("[data-form-content]");const i=this.$form.is("[data-form-content]")?this.$form:this.$form.find("[data-form-content]");i.html(t.html());this.handleMessages(e);this.initFields(i);AGN.Lib.Controller.init(i);AGN.runAll(i);i.trigger("scrollTo",i)}}AGN.Lib.SearchForm=t;AGN.Opt.Forms["search"]=t})();(()=>{class n{static DATA_KEY="agn:select";constructor(e){this.$select=e;this.select=e[0];this.api=this.$select.data("select2")}static get(e){const t=e;const i=t.data(n.DATA_KEY)||new n(t);t.data(n.DATA_KEY,i);return i}$get(){return this.$select}values(){return _.map(this.$select.find("option"),e=>$(e).val())}hasOption(e){return this.values().indexOf(e)!==-1}clear(){this.selectValue("")}toggleDisabled(e){this.$select.prop("disabled",e)}selectNext(){const e=this.values();const t=this.getSelectedValue();const i=e.indexOf(t)+1;if(i<e.length){this.selectValue(e[i])}}selectValue(e){this.$select.val(e).trigger("change.select2");if(this.isMultiple()){AGN.Lib.CoreInitializer.run("select",this.$select)}}isMultiple(){return this.$select.is("[multiple]")}unselectValue(t){const e=this.$select.val().filter(e=>e!==t);this.selectValue(e)}getFirstValue(){return this.$select.find("option:not(:disabled):first").val()}selectFirstValue(){this.selectValue(this.getFirstValue())}selectValueOrSelectFirst(e){const t=this.values();if(!_.isArray(e)){e=[e]}const i=_.every(e,e=>{return t.indexOf(e+"")!=-1});if(i&&e.length!=0){this.selectValue(e)}else{this.selectFirstValue()}}resetOptions(){this.$select.empty()}setOptions(e){const t=_.reduce(e,(e,t)=>{e+=`<option value="${t.id}">${t.text}</option>`;return e},"");this.$select.html(t)}addFormattedOption(e){this.$select.append(e)}getSelectedValue(){return this.$select.val()||""}addOption(e,t=e){this.$select.append($("<option>",{value:e,text:t}))}selectOptions(e){e.forEach(e=>this.selectOption(e))}selectOption(e){this.$findOption(e).prop("selected",true);this.$select.trigger("change.select2")}isOptionSelected(e){return this.$findOption(e).prop("selected")}$findOption(e){return this.$select.find(`option[value="${e}"`)}getSelectedText(){return this.$select.find("option:selected").text()}disableOptions(i=[],e){const t=this.$select.val();this.$select.find("option").prop("disabled",false);this.$select.find(`option${e?"":":not(:selected)"}`).filter((e,t)=>i.includes($(t).val())).each((e,t)=>$(t).prop("disabled",true));if(e&&!this.isMultiple()&&i.includes(t)){this.selectFirstValue()}this.$select.trigger("change.select2")}disableOption(e,t){this.disableOptions([e],t)}setReadonly(e){if(e){this.$select.attr("readonly","readonly")}else{this.$select.removeAttr("readonly")}}}AGN.Lib.Select=n})();(function(){const e=AGN.Lib.Form;class t extends e{constructor(e){super(e)}jqxhr(){return this.form.submit()}submit(){if(!this.valid()){this.handleErrors();return false}const e=_.merge({},this._data,this._dataNextRequest);this.$form.trigger("form:submit");AGN.Lib.CSRF.updateTokenInDOM(this.$form);_.each(e,(e,t)=>{const i=$(`<input type="hidden" name="${t}"/>`);i.val(e);i.appendTo(this.$form)});this._dataNextRequest={};this.$form.submit();return $.Deferred().promise()}}AGN.Lib.StaticForm=t;AGN.Opt.Forms["static"]=t})();(function(d){var h,p,e,t,i,o,n,r;r=function(i){function t(e,t,i){var n,r;if(i){n=new Date;n.setTime(n.getTime()+i*24*60*60*1e3);r="; expires="+n.toGMTString()}else{r=""}document.cookie=e+"="+t+r+"; path=/"}function n(e){e=JSON.stringify(e);if(i=="session"){window.name=e}else{t("localStorage",e,365)}}function e(){if(i=="session"){window.name=""}else{t("localStorage","",365)}}function r(){var t=i=="session"?window.name:o("localStorage");try{return JSON.parse(t)}catch(e){console.warn("Could not parse storage data: "+t+" cause: "+e)}return{}}var s=r();return{length:0,clear:function(){s={};this.length=0;e()},getItem:function(e,t){if(t===true){var i=r();return i[e]===undefined?null:i[e]}else{return s[e]===undefined?null:s[e]}},key:function(e){var t=0;for(var i in s){if(t==e)return i;else t++}return null},removeItem:function(e){delete s[e];this.length--;n(s)},setItem:function(e,t){s[e]=t+"";this.length++;n(s)}}};o=function(e){var t=e+"=",i=document.cookie.split(";"),n,r;for(n=0;n<i.length;n++){r=i[n];while(r.charAt(0)==" "){r=r.substring(1,r.length)}if(r.indexOf(t)==0){return r.substring(t.length,r.length)}}return null};try{if(!window.localStorage){n=new r("local")}else{n=window.localStorage}}catch(e){n=new r("local")}h=function(t){try{var e=n.getItem(l(t));if(e){return JSON.parse(e)}}catch(e){console.warn("Could not get Storage key: "+t+" cause: "+e)}return undefined};p=function(t,i){try{i=JSON.stringify(i);n.setItem(l(t),i)}catch(e){console.warn("Could not set Storage key:value "+t+":"+i+" cause: "+e)}};e=function(t){try{n.removeItem(l(t))}catch(e){console.warn("Could not remove Storage key:"+t+" cause: "+e)}};t=function(e){e.each(function(){var e=d(this);if(e.is("[data-stored-field]")&&(e.is("input")||e.is("select"))){s(e)}else{e.find("[data-stored-field]").each(function(){s(d(this))})}})};i=function(e){var t=false;e.each(function(){var e=d(this);if(e.is("[data-stored-field]")&&(e.is("input")||e.is("select"))){if(a(e)){t=true}}else{e.find("[data-stored-field]").each(function(){if(a(d(this))){t=true}})}});return t};function s(e){var t=e.data("stored-field")|"";var i=e.prop("name");if(i!=undefined){var n=undefined;if(e.prop("type")=="checkbox"){n=e.is(":checked")}else if(e.is("input")||e.is("select")){n=e.val()}if(n!=undefined){p(g(i,t),n)}}}function a(e){var t=e.data("stored-field")|"";var i=false;var n=e.prop("name");if(n!=undefined){var r=e.prop("type")||e.prop("type");var s=h(g(n,t));if(s===undefined){s=h(f(n,t));if(s===undefined){return false}p(g(n,t),s)}if(r=="radio"){if(e.val()!==s&&e.is(":checked")){e.prop("checked",false);return true}else if(e.val()==s&&!e.is(":checked")){e.prop("checked",true);return true}}else if(r=="checkbox"){if(e.prop("checked")!==s){e.prop("checked",s);i=true}}else if(r=="select-one"){var o=false;e.find("option").each(function(){if(d(this).val()==s){o=true;return false}});if(o&&e.val()!==s){e.val(s).change();i=true}}else if(r=="select-multiple"){var a=[];var l=e.value();e.find("option").each(function(){var i=d(this);d.each(s,function(e,t){if(i.val()==t){a.push(t)}})});a.sort();l.sort();var c=true;if(a.length!=l.length)c=false;for(var u=0;u<a.length;++u){if(a[u]!==l[u])c=false}if(!c){e.val(a).change();i=true}}else if(r=="textarea"||r=="text"){if(e.val()!==s){e.val(s);i=true}}}return i}function f(e,t){var i="stored_field_";if(e){i=i+e}if(t){i=i+"_"+t;return i}return undefined}function g(e,t){var i=f(e,t);if(i){return l(i)}else{return i}}function l(e){if(window.adminId){return window.adminId+"-"+e}return e}AGN.Lib.Storage={get:h,set:p,delete:e,readCookie:o,saveChosenFields:t,restoreChosenFields:i}})(jQuery);(()=>{const s=AGN.Lib.Storage;class e{static init(e){const t=e.data("toggle-tab");const i=this.#getGroupId(e,t);const n=s.get(`toggle_tab${i}`)||{};const r=$(t);if(typeof r.data("tab-show")!=="undefined"){n.hidden=false;r.data("tab-show",undefined)}if(typeof r.data("tab-hide")!=="undefined"){n.hidden=true;r.data("tab-hide",undefined)}if(n.hidden===false||n.hidden!==true&&r.is(":visible")){this.show(e)}}static show(e){const t=e.data("toggle-tab");const i=e.parents("ul").find("[data-toggle-tab]").not(e);const n=$(t);const r=e.find(".tab-toggle");const s=$(e.data("extends-tab"));_.each(i,e=>this.hide($(e)));e.addClass("active");e.closest("nav").find(".chosen-tab > span").text(e.text());r.removeClass("icon-angle-down").addClass("icon-angle-up");n.removeClass("hidden");s.removeClass("hidden");n.trigger("tile:show");this.#updateStorage(e,t,false);AGN.Lib.CoreInitializer.run("load",n)}static hide(e){const t=e.data("toggle-tab");const i=e.find(".tab-toggle");e.removeClass("active");i.removeClass("icon-angle-up").addClass("icon-angle-down");$(t).addClass("hidden");$(t).trigger("tile:hide");this.#updateStorage(e,t,true)}static toggle(e){const t=$(e.data("toggle-tab"));if(t.is(":visible")){this.hide(e)}else{this.show(e)}}static#updateStorage(e,t,i){if(e.attr("data-store-tab-state")==="false"){return}const n=this.#getGroupId(e,t);s.set(`toggle_tab${n}`,{hidden:i})}static#getGroupId(e,t){const i=e.data("tab-group");return i?`/${i}`:t}}AGN.Lib.Tab=e})();(()=>{const n=AGN.Lib.Helpers;const r=AGN.Lib.Popover;class i{constructor(e,t,i,n){this.$el=e;this.$el.append(this.#template);this.$el.data("_table",this);t.forEach(e=>{if(e.cellRenderer){e.cellRenderer=AGN.Opt.TableCellRenderers[e.cellRenderer]}if(e.headerComponent){e.headerComponent=AGN.Opt.TableHeaderComponents[e.headerComponent]}if(e.filter){e.filter=AGN.Opt.Table["filters"][e.filter]}if(e.comparator){e.comparator=AGN.Opt.Table["comparators"][e.comparator]}if(e.hasOwnProperty("suppressSizeToFit")&&!i.length){e.suppressSizeToFit=false}});t[t.length-1].resizable=false;this.gridOptions=_.merge(this.#defaultGridOptions(t),n||{});this.#setTableHeight();this.grid=new agGrid.Grid(this.$table.get(0),this.gridOptions);this.api=this.gridOptions.api;this.columnApi=this.gridOptions.columnApi;this.#setAvailableActionsData(i);this.api.setRowData(this.gridOptions.singleNameTable?i.map(e=>({name:e})):i);this.redraw();this.#bindFilters();this.popoverTimer=undefined;window.setTimeout(()=>AGN.Lib.CoreInitializer.run("scrollable",e),100)}#defaultGridOptions(e){return{autoSizePadding:4,columnDefs:e,accentedSort:true,colResizeDefault:"shift",scrollbarWidth:0,pagination:true,showRecordsCount:true,paginationPageSize:100,rowSelection:"multiple",unSortIcon:true,overlayNoRowsTemplate:`
        <div class="w-100 align-self-start">
         ${AGN.Lib.Template.text("notification-info",{message:t("defaults.table.empty")})}
        </div>
      `,onCellClicked:e=>{if(e.colDef.cellAction==="select"){e.node.setSelected(!e.node.isSelected())}},onCellMouseOver:_.throttle(e=>this.showCellPopoverIfTruncated(e),50),onCellMouseOut:_.throttle(e=>this.hideCellPopover(e),50),onSelectionChanged:()=>this.updateBulkActions(),onRowDataUpdated:()=>{this.api.forEachNode(e=>this.#setAvailableActionsData([e.data]));this.updateBulkActions()},suppressRowClickSelection:true,headerHeight:33,suppressPaginationPanel:true,onPaginationChanged:()=>{this.renderPagination();this.$el.css("--ag-rows-count",this.#getDisplayedRowsCount())},defaultColDef:{filter:true,sortable:true,resizable:true,autoHeight:true,wrapText:true,headerComponentParams:{template:`
          <div class="ag-cell-label-container" role="presentation">
            <!-- <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button"></span> filters are displaying in separate 'Filter' tile-->
            <div ref="eLabel" class="ag-header-cell-label" role="presentation">
              <span ref="eSortAsc" class="ag-header-icon ag-sort-ascending-icon" ></span>
              <span ref="eSortDesc" class="ag-header-icon ag-sort-descending-icon" ></span>
              <span ref="eSortNone" class="ag-header-icon ag-sort-none-icon" ></span>
              <span ref="eText" class="ag-header-cell-text" role="columnheader"></span>
              <!-- <span ref="eFilter" class="ag-header-icon ag-filter-icon"></span> filters are displaying in separate 'Filter' tile-->
              <span ref="eSortOrder" class="ag-header-icon ag-sort-order" ></span>
            </div>
          </div>`},filterParams:{clearButton:true}},columnTypes:{numberColumn:{cellDataType:"text",comparator:AGN.Lib.TableNumberComparator},numberRangeColumn:{filter:"agNumberColumnFilter",filterParams:{inRangeInclusive:true}},dateColumn:{filter:DateRangeFilter,cellRenderer:i.dateCellRenderer},dateTimeColumn:{filter:DateRangeFilter,cellRenderer:i.dateTimeCellRenderer},setColumn:{filter:SetFilter},bulkSelectColumn:{headerName:"",editable:false,checkboxSelection:true,headerCheckboxSelection:true,headerCheckboxSelectionCurrentPageOnly:true,headerComponent:AGN.Opt.TableHeaderComponents["NoLabelHeader"],resizable:false,suppressMenu:true,sortable:false,cellAction:"select",suppressSizeToFit:true,cellStyle:{textAlign:"center"}},tableActionsColumn:{headerName:"",editable:false,resizable:false,suppressMenu:true,sortable:false,cellAction:null,filter:SwitchFilter,cellRenderer:AGN.Opt.TableCellRenderers["TableActionsCellRenderer"],suppressSizeToFit:true},textCaseInsensitiveColumn:{comparator:AGN.Lib.TableCaseInsensitiveComparator},select:{comparator:AGN.Lib.TableCaseInsensitiveComparator}},icons:{menu:'<i class="icon icon-filter"/>',filter:'<i class="icon icon-filter"/>',columns:'<i class="icon icon-handshake-o"/>',sortAscending:'<i class="icon icon-sort-down"/>',sortDescending:'<i class="icon icon-sort-up"/>',checkboxChecked:'<i class="icon icon-check-square"/>',checkboxUnchecked:'<i class="icon icon-square"/>',checkboxIndeterminate:'<i class="icon icon-square-o"/>',checkboxCheckedReadOnly:'<i class="icon icon-check-square-o"/>',checkboxUncheckedReadOnly:'<i class="icon icon-square-o"/>',checkboxIndeterminateReadOnly:'<i class="icon icon-square-o"/>',sortUnSort:'<i class="icon icon-sort"/>'},localeText:window.I18n.tables,onFilterChanged:()=>{const e=this.api.getModel().rowsToDisplay.length;if(e===0){this.api.showNoRowsOverlay()}else{this.api.hideOverlay()}this.api.forEachNode(e=>this.#setAvailableActionsData([e.data]));this.api.deselectAll();this.updateBulkActions()},isRestoreMode:()=>this.isRestoreMode,getRowClass:()=>this.isRestoreMode?"ag-row-no-hover":""}}hideCellPopover(e){clearTimeout(this.popoverTimer);const t=this.#getClosestCell(e.event.target);r.get(t)?.hide()}showCellPopoverIfTruncated(i){this.popoverTimer=setTimeout(()=>{const e=this.#getClosestCell(i.event.target);if(this.#isTruncatedCell(e[0])){const t=$(n.retrieveTextElement(e[0])).text();r.getOrCreate(e,{trigger:"manual",content:t}).show()}},400)}#isTruncatedCell(e){return e&&($(e).is(":truncated")||n.containsTruncatedElements(e))}#getClosestCell(e){const t=$(e);return t.is(".ag-cell")?t:t.closest(".ag-cell")}static dateCellRenderer(e,t=false){const i=t?window.adminDateTimeFormat:window.adminDateFormat;const n=AGN.Lib.TableCellWrapper(e?.api?.gridOptionsService?.gridOptions,e?.data);const r=document.createElement("div");r.classList.add("text-truncate-table");n.appendChild(r);const s=e?.value?.date||e.value;r.innerHTML=s?moment(s).format(i.replaceAll("d","D").replaceAll("y","Y")):"";return n}static dateTimeCellRenderer(e){return i.dateCellRenderer(e,true)}get theme(){return"bootstrap"}get#template(){return`<div class="ag-theme-${this.theme}" style="width: 100%; height: 100%"></div>`}get $table(){if(!this._$table){this._$table=this.$el.find(`.ag-theme-${this.theme}`)}return this._$table}#setTableHeight(){if(!this.gridOptions.showRecordsCount&&!this.gridOptions.pagination){this.$table.height(this.$el.parent().height())}}renderPagination(){const e=this.api;if(!e){return}const t=e.paginationGetCurrentPage()+1;const i=e.paginationGetTotalPages();const n={pagination:this.gridOptions.pagination,showRecordsCount:this.gridOptions.showRecordsCount,currentPage:t,totalPages:i,pageSize:e.paginationGetPageSize(),pageSelects:this.#generatePageNumbers(t,i)};this.#updateDisplayedEntriesCount();const r=AGN.Lib.Template.dom("table-footer",n);const s=this.$el.find(".table-wrapper__footer");if(s.exists()){s.replaceWith(r)}else{this.$el.append(r)}AGN.Lib.CoreInitializer.run("select",r);this.api.redrawRows()}#generatePageNumbers(e,t){const i=parseInt(this.$el.css("--table-max-pages-count"));let n,r;if(t<=i){n=1;r=t}else{if(e<=Math.ceil(i/2)){n=1;r=i}else if(e+Math.floor(i/2)>t){n=t-i+1;r=t}else{n=e-Math.floor(i/2);r=e+Math.floor(i/2)-1}}const s=[];for(let e=n;e<=r;e++){s.push(e)}return s}#updateDisplayedEntriesCount(){const e=this.api;const t=e.getModel().getRootNode().childrenAfterGroup.length;const i=this.gridOptions.pagination?e.paginationGetRowCount():e.getDisplayedRowCount();const n=this.$el.find(".table-wrapper__entries-label");const r=n.children().first();if(t>i){r.text(`${i} / ${t}`)}else{r.text(i)}n.removeClass("hidden")}#getDisplayedRowsCount(){if(!this.gridOptions.pagination){return this.api.getDisplayedRowCount()}const e=this.api.paginationGetRowCount();const t=this.api.paginationGetCurrentPage();const i=this.api.paginationGetPageSize();return Math.min(e-t*i,i)}redraw(){const e=this.columnApi.getAllDisplayedColumns().filter(e=>e.getColDef().suppressSizeToFit===true).map(e=>e.getColId());if(e.length){this.columnApi.autoSizeColumns(e)}this.api.sizeColumnsToFit();this.$el.trigger("table:redraw")}#bindFilters(){$("#filter-tile").on("enterdown",e=>{e.preventDefault();this.applyFilter.bind(this)()});$("#apply-filter").on("click",this.applyFilter.bind(this));$("#reset-filter").on("apply-filter",this.applyFilter.bind(this))}applyFilter(){const e=_.groupBy(this.columnApi.getAllDisplayedColumns(),e=>e.getColDef().type);const t=this.#getFilterModelForTextCols(e["numberColumn"]);const i=this.#getFilterModelForNumberRangeCols(e["numberRangeColumn"]);const n=this.#getFilterModelForTextCols(e["textCaseInsensitiveColumn"]);const r=this.#getFilterModelForSelectCols(e["select"]);const s=this.#getEmptyFilterModelForCols(_.union(e["dateColumn"],e["dateTimeColumn"],e["customColumn"],e["setColumn"],e["tableActionsColumn"]));const o=this.#getFilterModelForTextCols(e["undefined"]);this.api.setFilterModel({...i,...t,...n,...r,...o,...s});this.isRestoreMode=$("#deleted-filter").prop("checked")}#getFilterModelForNumberRangeCols(e=[]){return e.reduce((e,t)=>{const i=t.getColId();const n=$(`#${i}-min-filter`).val()||Number.MIN_SAFE_INTEGER;const r=$(`#${i}-max-filter`).val()||Number.MAX_SAFE_INTEGER;e[i]={filterType:"number",type:"inRange",filter:n,filterTo:r};return e},{})}#getFilterModelForTextCols(e=[]){return e.reduce((e,t)=>{const i=t.getColId();const n=$(`#${i}-filter`.replaceAll(".","\\.")).val()?.toLowerCase();e[i]={type:"contains",filter:n};return e},{})}#getFilterModelForSelectCols(e=[]){return e.reduce((e,t)=>{const i=t.getColId();const n=$(`#${i}-filter`).val()?.toLowerCase();e[i]={type:"equals",filter:n};return e},{})}#getEmptyFilterModelForCols(e=[]){return e.reduce((e,t)=>{e[t.getColId()]={};return e},{})}findRowByElement(e){return this.api.rowModel.getRowNode(e.closest(".ag-row").attr("row-id"))}updateBulkActions(){const e=this.api.getSelectedRows();const t=e.flatMap(e=>e.rowActions);this.$el.trigger("table:updateBulkActions",[e.length,t])}#setAvailableActionsData(e){const i=this.api.getColumnDefs().find(e=>e.type==="tableActionsColumn")?.buttons;if(!i){return}e.forEach(t=>t.rowActions=i.filter(e=>this.allowedToShowRowAction(e,t)).map(e=>e.name))}allowedToShowRowAction(e,t){if(this.isRestoreMode){return e.name==="restore"}if(e.hide===true){return false}const i=AGN.Opt.TableActionsConditions[e.name];return!i||i(t)}static get(e){return i.getWrapper(e).data("_table")}static getWrapper(e){return e.closest(".table-wrapper")}}AGN.Lib.Table=i})();(function(){class i{static DATA_ATTR_NAME="agn:table-manager-col";constructor(e){this.$th=e;this.$td=this.#$findCorrespondingTd();this._name=e.data("table-column");this.#wrapPlainTextInSpan();this.#addControls();this.$th.data(i.DATA_ATTR_NAME,this)}static get(e){return e.data(i.DATA_ATTR_NAME)}get name(){return this._name}get permanent(){return!this.name}get text(){return this.$th.children().first().text().trim()}toggleMode(){this.$controls.toggleClass("hidden");this.$controls.prev().toggleClass("hidden")}toggle(e=false){this.$th.toggleClass("hidden",e);this.$td.toggleClass("hidden",e)}isHidden(){return this.$th.hasClass("hidden")}#addControls(){const e=AGN.Lib.Template.dom("deletable-table-column",{text:this.text,permanent:this.permanent});this.$th.append(e);this.$controls=e}#$findCorrespondingTd(){const e=this.$th.index()+1;return this.$th.closest("table").find(`td:nth-child(${e})`)}#wrapPlainTextInSpan(){if(this.$th.contents().length===1){$(this.$th.contents()[0]).wrap("<span></span>")}}}class r{static DATA_ATTR_NAME="agn:table-column-manager";static SELECTOR="[data-table-column-manager]";static MAX_SELECTED_COLUMNS=8;constructor(e){this.$el=e;const t=e.find("[data-table-column-manager-config]");this.config=t.exists()?t.json():{};this.$btn=e.find("[data-manage-table-columns]");this.$columnPickerCell=e.find("th.columns-picker");this._editModeEnabled=false;this.columns=e.find("[data-table-column]").map(function(){return new i($(this))}).get();this.#addColumnPicker();this.#addUiHandlers();if(this.config.editMode){this.toEditMode();this.$columnPicker.find("> .icon-btn").trigger("click")}this.#hideExcessColumns();e.data(r.DATA_ATTR_NAME,this)}static get(e){return e.closest(r.SELECTOR).data(r.DATA_ATTR_NAME)}toEditMode(){this.#toggleMode()}applyChanges(){this.#toggleMode();this.$el.trigger($.Event("table-column-manager:apply"),{columns:this.#collectSelectedColumns()})}removeColumn(e){const t=i.get(e);this.#removeColumn(t)}isInEditMode(){return this._editModeEnabled}#hideExcessColumns(){const e=this.#findVisibleColumns();if(e.length<=r.MAX_SELECTED_COLUMNS){return}const t=e.length-r.MAX_SELECTED_COLUMNS;const i=this.#collectSelectedColumns();for(let e=0;e<t;e++){const n=this.#findColumnByName(i[e]);this.#removeColumn(n)}}#removeColumn(e){AGN.Lib.Select.get(this.$columnSelect).unselectValue(e.name);e.toggle(true)}#collectSelectableColumns(){return this.columns.filter(e=>!e.permanent)}#collectSelectedColumns(){return this.#collectSelectableColumns().filter(e=>!e.isHidden()).map(e=>e.name)}#toggleMode(){this.columns.forEach(e=>e.toggleMode());this._editModeEnabled=!this._editModeEnabled;this.$el.toggleClass("is-edit-mode");this.$columnPicker.toggleClass("hidden");this.#updateToggleModeBtn();AGN.Lib.CoreInitializer.run("table",this.$columnPickerCell)}#addColumnPicker(){let e=this.config.columns;if(!e){e=this.#collectSelectableColumns().map(e=>{return{text:e.text,name:e.name,selected:!e.isHidden()}})}const t=AGN.Lib.Template.dom("table-column-picker",{columns:e});this.$columnPickerCell.append(t);this.$columnPicker=t;this.$columnSelect=t.find("select");AGN.runAll(t)}#addUiHandlers(){let r;this.$columnPicker.on("show.bs.dropdown",function(){r=$(this).find(".dropdown-menu");$("body").append(r.detach())});this.$columnPicker.on("hidden.bs.dropdown",()=>{this.$columnPicker.append(r.detach())});this.$columnSelect.on("select2:selecting",e=>{if(!this.#isPossibleToAddColumn()){e.preventDefault()}});this.$columnSelect.on("select2:select",e=>{const t=e.params.data.id;const i=this.#findColumnByName(t);if(i){i.toggle()}else{const n=this.#collectSelectedColumns().concat(t);this.$el.trigger($.Event("table-column-manager:add"),{columns:n});r.remove()}})}#isPossibleToAddColumn(){if(this.#findVisibleColumns().length===r.MAX_SELECTED_COLUMNS){AGN.Lib.Messages.warn("defaults.table.maxColumnsSelected");return false}return true}#findVisibleColumns(){return this.columns.filter(e=>!e.isHidden())}#findColumnByName(t){return this.columns.find(e=>e.name===t)}#updateToggleModeBtn(){const e=this.$btn.find("span");if(this.isInEditMode()){e.text(t("defaults.table.saveColumns"))}else{e.text(t("defaults.table.editColumns"))}}}AGN.Lib.TableColumnManager=r})();(()=>{const i=AGN.Lib.CSRF;const n=AGN.Opt.Templates;const r=[];class e{static prepare(e){if(!this.exists(e)){throw new Error(`There's no template \`${e}\` registered`)}if(!r[e]){const t=_.template(n[e]);r[e]=function(){const e=t.apply(this,arguments);return i.updateTokenInDOM(e)}}return r[e]}static text(e,t){return this.prepare(e)(t)}static dom(e,t){return $(this.text(e,t))}static exists(e){return e in n}static register(e,t){AGN.Opt.Templates[e]=t;delete r[e]}}AGN.Lib.Template=e})();(()=>{const n=AGN.Lib.Storage;function r(e,t){const i=e.find("> .tile-header .tile-title .icon");i.toggleClass("icon-caret-down",t);i.toggleClass("icon-caret-up",!t)}function s(e){return`collapsed${e.data("toggle-tile")==="mobile"?"-mobile":""}`}function o(e,t,i){e.toggleClass(s(e),t);r(e,t);if(i&&e.attr("id")){n.set(`toggle_tile#${e.attr("id")}`,{hidden:t})}if(!t){AGN.Lib.CoreInitializer.run("load",e.find(".tile-body"))}}function a(e){const t=e.data("toggle-tile-default-state");if(!t){return}o(e,t!=="open",false)}const e=function(e){const t=e.attr("id");const i=t?n.get("toggle_tile#"+t):undefined;if(!i){a(e);return}o(e,i.hidden,true)};const t=function(e){o(e,!e.hasClass(s(e)),true)};const i=function(e){return e.closest(".tile").find("[data-toggle-tile]")};const l=function(e){o(e,false,true)};const c=function(e){o(e,true,true)};AGN.Lib.Tile={toggle:t,init:e,show:l,hide:c,trigger:i}})();(()=>{const r=AGN.Lib.Template;const e=AGN.Lib.Helpers;const s={};s.get=function(e){const t=bootstrap.Tooltip.getInstance(e);if(t){return t}return null};const n=function(e,t,i){return r.text("tooltip-template",{tooltipStyle:e,arrowStyle:t,innerStyle:i})};function o(e,t,i){return{title:e,container:"body",template:n(t),...i&&{trigger:i}}}s.options=function(t){let i={};if(t.is("[data-tooltip]")){let e=t.data("tooltip");const n=t.data("tooltip-src");if(n){e=r.text(n,{element:t})}i=o(e,t.data("tooltip-style"))}return $.extend(i,e.objFromString(t.data("tooltip-options")))};s.create=function(e,t){s.remove(e);const i=new bootstrap.Tooltip(e,t);e.on("remove",function(){s.remove(e)});if(t.trigger!=="manual"){const n=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){i.hide()}})});n.observe(e[0])}return i};s.remove=function(e){const t=bootstrap.Tooltip.getInstance(e);t?.dispose()};s.setShown=function(e,t){if(t||t===undefined){e.tooltip("show")}else{e.tooltip("hide")}};s.createTip=function(e,t,i,n){return s.create(e,o(t,i,n))};AGN.Lib.Tooltip=s})();(()=>{class e{constructor(e,t,i){const n=this;this.multiple=!t.exists()||t.is("[multiple]");this.selection=[];this.$dropzone=e;this.$file=t;if(e.exists()){e.data("agn:upload",this);new Dropzone(e,{classDragOver:"drag-over",onSelectFiles:function(e){const t=i?i:n;t.#drop(e)}})}else{t.data("agn:upload",this);t.on("change",()=>{const e=i?i:n;e.#drop(t.prop("files"))})}}static get(e,t){if(e.exists()){return e.data("agn:upload")}return t.data("agn:upload")}reset(){this.selection=[];this.$file.val("")}removeSelection(e){this.selection.splice(e,1)}getSelection(){return this.selection.slice(0)}#drop(t){if(!t||t.length<=0){return}let i=false;if(this.multiple){for(let e=0;e<t.length;e++){const n=t[e];if(this.#onDrop(n,this.selection.length)){this.selection.push(n);i=true}}}else{let e=t[0];if(this.#onDrop(e,0)){this.selection=[e];i=true}}if(i){this.$dropzone.trigger("upload:dropped",[this.selection])}}#onDrop(e,t){const i=$.Event("upload:add");const n=this.$dropzone.exists()?this.$dropzone:this.$file;n.trigger(i,{file:e,index:t});return!i.isDefaultPrevented()}}AGN.Lib.Upload=e})();(function(){var n;n=function(e){if(e.init){e.init();delete e.init}return $.extend(this,e)};n.exists=function(e){return AGN.Opt.Validators.hasOwnProperty(e)};n.get=function(e){return n.exists(e)?AGN.Opt.Validators[e]:null};n.new=function(e,t){if(n.exists(e)){console.debug("Validator with name `"+e+"` was overridden")}var i=new n(t);AGN.Opt.Validators[e]=i;return i};n.prototype.valid=function(){return true};n.prototype.errors=function(){return[]};AGN.Lib.Validator=n})();(()=>{const i=AGN.Lib.Storage;class n{static PREFIX="web-storage#";static get(e){try{return i.get(n.PREFIX+$.trim(e))}catch(e){console.error(e)}return null}static set(e,t){i.set(n.PREFIX+$.trim(e),t)}static extend(e,t){let i=n.get(e);if(i!=null){i=$.extend(i,t)}else{i=t}n.set(e,i);return i}}AGN.Lib.WebStorage=n})();AGN.Lib.LB.Definitions={EDITOR:null,IS_BASIC_LB:false,AGN_TAGS_CONFIG:{},EMPTY_ROW_HEIGHT:80,COLLAPSED_BLOCK_SIZE:10,ALL_ENTRIES:-1,ALL_RECIPIENTS:0,DEFAULT_LAYERING_INDEX:-1,TOP_Z:500,UNCOLLAPSIBLE_GUTTER_SIZE:2,AUTOSAVE_INACITVE_INTERVAL:2e3,MAX_UNDO_OPERATIONS_SIZE:100,CONTROLS_STATE:{DISABLED:0,HIDDEN:1,POPOVER:2,INLINE:3},MARKUP_SPAN:{TEXT:"Text",PLACEHOLDER:"Placeholder",TOC_AREA:"TocArea",TOC_PLACEHOLDER:"TocPlaceholder"},PLACEHOLDER:{LABEL:"Label",TEXT:"Text",LINK:"Link",IMAGE:"Image",IMAGE_SRC:"ImageLink",SELECT:"Select",COLOR:"Color",CHECK:"Check",MULTI:"Multi"},TOC_PLACEHOLDER_TYPE_ID:"Id",TOC_PLACEHOLDER_TYPE_NAME:"Name",TOC_ID_PREFIX:"toc_",DIRECTION:{NONE:"",EAST:"e",WEST:"w",NORTH:"n",SOUTH:"s"},CONTAINER_TYPE:{EDITABLE:0,ANCHORED:2,FIXED_AND_ANCHORED:3}};(()=>{function e(e){var t={};if(e){this.data=e.slice();this.data.forEach(function(e){t[e.id]=e.name})}else{this.data=[]}this.map=t}e.prototype.name=function(e){return this.map[e]};e.prototype.list=function(){return this.data.slice()};AGN.Lib.LB.Categories=e})();(()=>{function e(){this.deferred=$.Deferred();this.callback=null}e.prototype.promise=function(){return this.deferred.promise()};e.prototype.bind=function(e){var t=this;if(e===false){t.callback=null}else{var i=t.callback=function(){if(t.callback===i){t.deferred.notifyWith(this,arguments)}};if($.isArray(e)){e.forEach(function(e){e.progress(i)})}else{e.progress(i)}}};AGN.Lib.LB.PromiseProgressWatcher=e})();(()=>{const t=AGN.Lib.LB.Definitions;function e(e){var t={};if(e){this.data=e.slice();this.data.forEach(function(e){t[e.id]=e.name})}else{this.data=[]}this.map=t}e.prototype.name=function(e){return this.map[e==t.ALL_ENTRIES?t.ALL_RECIPIENTS:e]};e.prototype.list=function(){return this.data.slice()};AGN.Lib.LB.Targets=e})();(()=>{const c=AGN.Lib.LB.Definitions;var s={};s.make=function(t,e){s.adjustChildren(t,e);e.forEach(function(e){e.adjustHeight(t.getHeightForSpans(e.getRow(),e.getColumn(),e.getRows(),e.getColumns()))})};s.getChildrenProjections=function(n,e){var a=[];n.each(function(e){a.push({row:e,projections:[]})});var l=[];e.forEach(function(e){var t=[];var i={child:e,height:e.getHeight(),spans:t};var n=e.getRow();var r=n+e.getRows()-1;for(var s=n;s<=r;s++){var o={cascade:i,height:0,margin:0,adjusted:false};t.push(o);a[s-1].projections.push(o)}l.push(i)});$.each(a,function(e,t){var i=n.getRowMargin(t.row.isGuttered());$.each(t.projections,function(e,t){t.margin=i})});$.each(l,function(e,t){s.adjustCascade(t)});return a};s.adjustCascade=function(e){var t=Math.max(e.height,c.COLLAPSED_BLOCK_SIZE);var i=0;var n=e.spans;var r=[];for(var s=0;s<n.length;s++){var o=n[s];if(o.adjusted===false){o.height=c.COLLAPSED_BLOCK_SIZE;r.push(o)}i+=o.height;if(i+o.margin>=t){for(s=s+1;s<n.length;s++){n[s].height=0}break}if(s+1<n.length){i+=o.margin}}var a=t-i;if(a>0&&r.length){var l=a/r.length;$.each(r,function(e,t){t.height+=l})}};s.adjustChildren=function(e,t){$.each(s.getChildrenProjections(e,t),function(e,t){var i=t.projections;if(i.length){var n=0;var r=0;$.each(i,function(e,t){if(t.height>n){n=t.height;r=e}});if(n===0){n=c.EMPTY_ROW_HEIGHT}$.each(i,function(e,t){t.adjusted=true;if(e!==r){t.height=n;s.adjustCascade(t.cascade)}});t.row.setHeight(n)}else{t.row.setHeight(c.EMPTY_ROW_HEIGHT)}})};AGN.Lib.LB.Adjustments=s})();(()=>{const n=AGN.Lib.LB.Definitions;function e(e){this.horizontal=n.DIRECTION.NONE;this.vertical=n.DIRECTION.NONE;for(var t=0;t<e.length;t++){var i=e.charAt(t).toLowerCase();switch(i){case n.DIRECTION.EAST:case n.DIRECTION.WEST:if(this.horizontal===n.DIRECTION.NONE){this.horizontal=i}else{console.error("Ambiguous direction code: "+e)}break;case n.DIRECTION.NORTH:case n.DIRECTION.SOUTH:if(this.vertical===n.DIRECTION.NONE){this.vertical=i}else{console.error("Ambiguous direction code: "+e)}break;default:console.error("Unknown direction code: "+i)}}}e.prototype.isHorizontal=function(){return this.horizontal!==n.DIRECTION.NONE};e.prototype.isVertical=function(){return this.vertical!==n.DIRECTION.NONE};e.prototype.isEast=function(){return this.horizontal===n.DIRECTION.EAST};e.prototype.isWest=function(){return this.horizontal===n.DIRECTION.WEST};e.prototype.isNorth=function(){return this.vertical===n.DIRECTION.NORTH};e.prototype.isSouth=function(){return this.vertical===n.DIRECTION.SOUTH};AGN.Lib.LB.ResizingDirection=e})();(()=>{function e(e,t){var i=e.get$();this.child=e;this.$child=i;this.grid=t}e.prototype.setupConstraints=function(){this.setConstraints(this.grid.getConstraints(this.child,this.direction))};e.prototype.setConstraints=function(e){this.$child.resizable({minWidth:e.minWidth,maxWidth:e.maxWidth,minHeight:e.minHeight,maxHeight:e.maxHeight})};e.prototype.getArea=function(e,t){return this.grid.getArea(this.child,this.direction,e,t)};e.prototype.start=function(e){this.direction=e;this.area={row:this.child.getRow(),column:this.child.getColumn(),rows:this.child.getRows(),columns:this.child.getColumns()};this.z=this.child.getZ();this.setupConstraints();this.grid.setAreaHovered(this.area);this.grid.startResizing(this.child);this.child.setZ(AGN.Lib.LB.Definitions.TOP_Z)};e.prototype.resize=function(e,t){var i=this.getArea(e,t);if(i.row!==this.area.row||i.column!==this.area.column||i.rows!==this.area.rows||i.columns!==this.area.columns){this.area=i;this.grid.setAreaHovered(i)}};e.prototype.stop=function(e,t){this.area=this.getArea(e,t);this.child.setZ(this.z);this.child.setRow(this.area.row);this.child.setColumn(this.area.column);this.child.setRows(this.area.rows);this.child.setColumns(this.area.columns);this.grid.setAreaHovered(null);this.grid.stopResizing(this.child);this.child.adjustSize(this.grid);this.child.adjustCoordinates(this.grid)};AGN.Lib.LB.Resizing=e})();(()=>{const UNKNOWN_GENDER=2;const REFERENCE_TABLES_VALUES_CACHE={};let SALUTATIONS_CACHE;let VOUCHER_CODES_CACHE;class AgnTagsResolver{static resolve(e){return AGN.Lib.Helpers.replaceAgnTags(e,(e,t)=>{if(e.name==="agnIMAGE"){return this.resolveAgnImage(e,t)}if(e.name==="agnDATE"){return AGN.Lib.DateFormat.format(new Date,window.adminDateFormat)}if(e.name==="agnEMAIL"){return this.#getRecipientData("email")||t}if(e.name==="agnNULL"){return""}if(e.name==="agnPROFILE"){return this.resolveAgnForm("profile")}if(e.name==="agnUNSUBSCRIBE"){return this.resolveAgnForm("unsubscribe")}if(e.name==="agnWEBVIEW"||e.name==="agnFULLVIEW"){return`${this.#getRdirDomain()}/fullview.action?agnUID=##AGNUID##`}if(e.name==="agnFORM"){return e.attributes["name"]?this.resolveAgnForm(e.attributes["name"]):t}if(e.name==="agnPUBVIEW"){return`${this.#getRdirDomain()}/v.html?uid=##PUBID:NL##`}if(e.name==="agnTITLE"||e.name==="agnTITLEFIRST"||e.name==="agnTITLEFULL"){return this.resolveAgnTitle(e,t)}if(e.name==="agnDB"){return this.resolveAgnDb(e,t)}if(e.name==="agnAGE"){return this.resolveAgnAge(e,t)}if(e.name==="agnDAYS_UNTIL"){return this.resolveAgnDaysUntil(e,t)}if(e.name==="agnBARCODE"){return this.resolveAgnBarcode(e,t)}if(e.name==="agnQRCODE"){return this.resolveAgnQrCode(e,t)}if(e.name==="agnONEPIXEL"){const i=this.#getUID();return i?`${this.#getRdirDomain()}/g.html?uid=${i}`:t}if(e.name==="agnUID"){return this.#getUID()||t}if(e.name==="agnREDIRECT"){return this.resolveAgnRedirect(e,t)}if(e.name==="agnVOUCHER"){return this.resolveAgnVoucher(e,t)}if(e.name==="agnIMGLINK"){return""}if(e.name==="agnTXTIMG"){return this.resolveAgnTxtImg(e,t)}if(e.name==="agnDYNIMAGE"){return this.resolveAgnDynImage(e,t)}if(e.name==="agnITEM"){return this.resolveAgnItem(e,t)}return t})}static resolveAgnImage(e,t){if(e.attributes["name"]){if(!e.attributes["source"]||e.attributes["source"]==="mediapool"||e.attributes["source"]==="mediapoolbg"){return AGN.url(`/mediapool/content/images/${encodeURIComponent(e.attributes["name"])}/raw.action`)}}return t}static resolveAgnTxtImg(i,e){const t=this.#getUID();if(!t){return e}const{reftbl:n,key:r,col:s}=i.attributes;if(this.#isValueAbsent(n)||this.#isValueAbsent(r)||this.#isValueAbsent(s)){return e}let o=`${this.#getRdirDomain()}/dynimg/${t}?reftbl=${n}&key=${r}&col=${s}`;["width","height","fontsize","fontname","fontstyle","fontcolor"].forEach(e=>{const t=i.attributes[e];if(t){o+=`&${e}=${t}`}});return o}static resolveAgnDynImage(e,t){const{referencetable:i,keycolumn:n,keyvalue:r,imagesource:s}=e.attributes;if(this.#isValueAbsent(i)||this.#isValueAbsent(n)||this.#isValueAbsent(r)){return t}const{licenseId:o}=this.#config();if(s==="mediapool"){return`${this.#getRdirDomain()}/dyn_mediapool_element/${o}/${window.companyId}/${i}.${n}.${r}.jpg`}if(s==="mailing"){const{mailingId:a}=this.#config();if(a>0){return`${this.#getRdirDomain()}/dyn_image/${o}/${window.companyId}/${a}/${i}.${n}.${r}.jpg`}return""}return`${this.#getRdirDomain()}/dyn_extern/${o}/${window.companyId}/${i}.${n}.${r}.jpg`}static resolveAgnItem(e,t){const{table:i,keycolumn:n,keyvalue:r,column:s,keysource:o}=e.attributes;if(this.#isValueAbsent(s)){return t}const a=!this.#isValueAbsent(o);if((this.#isValueAbsent(i)||this.#isValueAbsent(n)||this.#isValueAbsent(r))&&!a){return t}const{referenceContentSettings:l}=this.#config();if(a&&!l){return""}let c=n;let u=r;if(a){const d=/^item([1-9]\d*)$/;const h=o.match(d);if(h){const p=h[1];if(p>l.items.length){return""}c=this.#config()["mailingReferenceContentKeyColumn"];u=l.items[p-1]}}return this.#findReferenceTableData(i,s,c,u)}static resolveAgnBarcode(e,t){const i=this.#getUID();if(!i){return t}let n=`${this.#getRdirDomain()}/barcode?uid=${i}`;const{code:r,column:s,drawtext:o,barheight:a,type:l,voucher:c,default:u}=e.attributes;let d;if(r){d=r}else if(s){d=this.#getRecipientData(s)}else if(c){d=this.#getVoucherCode(c)||u}if(d){n+="&data="+d}if(o==="true"||o==="false"){n+="&drawText="+o}if(this.#isValidInteger(a)&&parseInt(a)>0){n+="&barHeight="+a}if(l){n+="&type="+l}return n}static resolveAgnRedirect(e,t){const{column:i}=e.attributes;if(!i){return t}return`${this.#getRdirDomain()}/redirect?url=##${i}##`}static resolveAgnVoucher(e,t){const{name:i}=e.attributes;if(!i){return t}const n=this.#getVoucherCode(i);if(n){return n}return e.attributes["default"]??""}static resolveAgnQrCode(e,t){const i=this.#getUID();if(!i){return t}let n=`${this.#getRdirDomain()}/qrcode?uid=${i}`;const{data:r,column:s,drawtext:o,height:a,width:l,voucher:c,default:u}=e.attributes;let d;if(r){d=r}else if(s){d=this.#getRecipientData(s)}else if(c){d=this.#getVoucherCode(c)||u}if(d){n+="&data="+d}if(o==="true"||o==="false"){n+="&drawText="+o}if(this.#isValidInteger(a)&&parseInt(a)>0){n+="&height="+a}if(this.#isValidInteger(l)&&parseInt(l)>0){n+="&width="+l}return n}static resolveAgnDb(e,t){const{column:i}=e.attributes;if(!i){return t}const n=this.#getRecipientData(i);return this.#isValueAbsent(n)?t:n}static resolveAgnForm(e){const{companyToken:t}=this.#config();if(t){return`${this.#getRdirDomain()}/form.action?agnCTOKEN=${t}&agnFN=${e}&agnUID=##AGNUID##`}return`${this.#getRdirDomain()}/form.action?agnCI=${window.companyId}&agnFN=${e}&agnUID=##AGNUID##`}static resolveAgnTitle(e,t){const{type:i}=e.attributes;if(!i){return t}const n=this.#getSalutations()[parseInt(i)];if(!n){return t}const r=$.trim(this.#getRecipientData("lastname"));const s=$.trim(this.#getRecipientData("firstname"));const o=$.trim(this.#getRecipientData("title"));let a=r?this.#getRecipientData("gender"):UNKNOWN_GENDER;if(!AGN.Lib.Helpers.isNumber(a)){a=UNKNOWN_GENDER}const l=n[a];if(!l){return t}if(a===UNKNOWN_GENDER){return l}if(e.name==="agnTITLE"){return`${l} ${o?`${o} `:""}${r}`}if(e.name==="agnTITLEFIRST"){return`${l} ${s}`}if(e.name==="agnTITLEFULL"){return`${l} ${o?`${o} `:""}${s} ${r}`}return l}static resolveAgnDaysUntil(e,t){const{column:i}=e.attributes;if(!i){return t}if(!["Date","DateTime"].includes(this.#getSimpleDataType(i))){return t}const n=this.#getRecipientData(i,false);if(this.#isValueAbsent(n)){return t}const r=new Date(n);const s=new Date;const o=r-s;return Math.ceil(o/(1e3*60*60*24))}static resolveAgnAge(tag,tagHtml){const{column}=tag.attributes;if(!column){return tagHtml}if(!["Date","DateTime"].includes(this.#getSimpleDataType(column))){return tagHtml}const dateMs=this.#getRecipientData(column,false);if(this.#isValueAbsent(dateMs)){return tagHtml}const{position:positionAttr,length:lengthAttr,modifier:modifierAttr}=tag.attributes;let result=this.#calculateYearsDifferenceBetweenDates(new Date(dateMs),new Date);if(modifierAttr!==null&&modifierAttr!==undefined){try{result=eval(`${result}${modifierAttr}`)}catch(e){console.error(`Error when process 'modifier' attribute in [agnAGE] tag!`)}}result=String(result);if(this.#isValidInteger(positionAttr)){const position=Math.max(1,parseInt(positionAttr));result=result.substring(position-1)}if(this.#isValidInteger(lengthAttr)){const length=Math.max(0,parseInt(lengthAttr));if(length>0){result=result.substring(0,length)}}return result}static#calculateYearsDifferenceBetweenDates(e,t){let i=t.getFullYear()-e.getFullYear();const n=t.getMonth()-e.getMonth();const r=t.getDate()-e.getDate();if(n<0||n===0&&r<0){i--}return Math.max(0,i)}static#getRdirDomain(){return this.#config()["redirectDomain"]}static#getUID(){return this.#config()["recipientUID"]}static#getRecipientData(e,t=true){const{previewRecipient:i}=this.#config();const n=i?.parameters[e];if(this.#isValueAbsent(n)||!t){return n}const r=this.#getSimpleDataType(e);if(r){if(r==="Date"){return AGN.Lib.DateFormat.format(new Date(n),window.adminDateFormat)}if(r==="DateTime"){return AGN.Lib.DateFormat.format(new Date(n),window.adminDateTimeFormat)}}return n}static#getSimpleDataType(e){const{previewRecipient:t}=this.#config();return t.columnsTypes[e]}static#isValidInteger(e){const t=parseInt(e,10);return!isNaN(t)&&t.toString()===e}static#getSalutations(){if(!SALUTATIONS_CACHE){$.ajax({url:AGN.url("/salutation/list/json.action"),method:"GET",async:false,success:e=>{SALUTATIONS_CACHE={};e.forEach(e=>SALUTATIONS_CACHE[e.id]=e.titleGender)}})}return SALUTATIONS_CACHE}static#getVoucherCode(e){if(!VOUCHER_CODES_CACHE){const t=this.#getRecipientData("customer_id",false);if(t){$.ajax({url:AGN.url("/administration/table/voucherCodes/json.action"),data:{customerId:t},method:"GET",async:false,success:e=>VOUCHER_CODES_CACHE=e})}else{VOUCHER_CODES_CACHE={}}}return VOUCHER_CODES_CACHE[e]}static#findReferenceTableData(e,t,i,n){const r=`${e}-${t}-${i}-${n}`;if(!REFERENCE_TABLES_VALUES_CACHE[r]){$.ajax({url:AGN.url("/administration/table/valueByKeyCol.action"),data:{table:e,column:t,keyCol:i,keyVal:n},method:"GET",async:false,success:e=>REFERENCE_TABLES_VALUES_CACHE[r]=e})}return REFERENCE_TABLES_VALUES_CACHE[r]}static#config(){return AGN.Lib.LB.Definitions.AGN_TAGS_CONFIG}static#isValueAbsent(e){return e===null||e===undefined}}AGN.Lib.LB.AgnTagsResolver=AgnTagsResolver})();(()=>{class i{constructor(e=AGN.Lib.LB.Definitions.MAX_UNDO_OPERATIONS_SIZE){this.maxLength=e;this._stack=[]}add(e){while(this._stack.length>=this.maxLength){this._stack.shift()}this._stack.push(e)}pop(){return this._stack.pop()}isEmpty(){return _.isEmpty(this._stack)}clear(){this._stack=[]}}class e{constructor(e,t={}){this._editor=e;this._operationHandlers={};this.undoStack=new i;this.redoStack=new i;this.onChange=_.isFunction(t.onChange)?t.onChange:_.noop}registerHandler(e,t){this._operationHandlers[e]=t}undo(){if(!this.canUndo()){return false}const e=this.undoStack.pop();e.args=this._operationHandlers[e.operation]?.apply(this,e.args);this.redoStack.add(e);this.onChange();return true}redo(){if(!this.canRedo()){return false}const e=this.redoStack.pop();e.args=this._operationHandlers[e.operation]?.apply(this,e.args);this.undoStack.add(e);this.onChange();return true}canUndo(){return!this.undoStack.isEmpty()}canRedo(){return!this.redoStack.isEmpty()}operation(e){const t=[].slice.call(arguments);t.shift();this.undoStack.add({operation:e,args:t});this.redoStack.clear();this.onChange()}}AGN.Lib.LB.UndoManager=e})();(()=>{const r=AGN.Lib.LB.Definitions;const i=AGN.Lib.LB.ResizingDirection;AGN.Lib.LB.Ui={setShown:function(e,t){e.toggleClass("hidden",!t)},setUndoOptionEnabled:function(e){$("#undo-option").toggleClass("disabled",!e)},setRedoOptionEnabled:function(e){$("#redo-option").toggleClass("disabled",!e)},setTooltip:function(e,t){e.data("tooltip",t);AGN.Lib.Tooltip.createTip(e,t)},removeTooltip:function(e){AGN.Lib.Tooltip.remove(e)},checkHoverState:function(e){if(e.is(":hover")){e.trigger("mouseleave").trigger("mouseenter")}},setLoading:function(e){$("#lb-editor-progress").toggle(!!e);$("#disabled-save-button").parent().toggleClass("hidden",!e);$("#save-button").parent().toggleClass("hidden",!!e)},setEditable:function(e){$("#save-button").parent().toggleClass("hidden",!e);$("#building-blocks-search").toggleClass("disabled",!e);$("#update-text-version").parent().toggle(!!e);$("#visibleTargets").attr("disabled",!e)},setTargetId:function(e){AGN.Lib.Select.get($("#visibleTargets")).selectValue(e)},getAvailableTargetIds:function(){return $("#visibleTargets").children("option").get().map(function(e){return parseInt($(e).val())})},setAvailableTargetIds:function(e){var i=this.getAvailableTargetIds();var n=$("#visibleTargets");n.empty();e.push({id:r.ALL_ENTRIES,name:t("filter.reset")});_.sortBy(e,function(e){if(e.id>r.ALL_RECIPIENTS){return i.indexOf(parseInt(e.id))}else if(e.id==r.ALL_RECIPIENTS){return 1e6}else{return 1000001}}).forEach(function(e){$("<option></option>").val(e.id).text(e.name).appendTo(n)})},imagesAdjusted:function(i,e){var n=$.Deferred();var r=undefined,s=undefined;if(e===true){r=i.outerWidth();s=i.outerHeight()}var t=function(){var e=i.outerWidth(),t=i.outerHeight();if(r!==e||s!==t){r=e;s=t;n.notify()}};i.imagesLoaded().progress(t).always(t);return n.promise()},getHeightAccurate:function(e){return e[0].getBoundingClientRect().height},getResizeHandleDirection:function(e){if(e.hasClass("ui-resizable-ne")){return new i("ne")}if(e.hasClass("ui-resizable-se")){return new i("se")}if(e.hasClass("ui-resizable-nw")){return new i("nw")}if(e.hasClass("ui-resizable-sw")){return new i("sw")}if(e.hasClass("ui-resizable-e")){return new i("e")}if(e.hasClass("ui-resizable-w")){return new i("w")}if(e.hasClass("ui-resizable-n")){return new i("n")}if(e.hasClass("ui-resizable-s")){return new i("s")}console.error("Invalid resizing direction handle");return new i("")}}})();(()=>{const s=AGN.Lib.LB.Definitions;const o=AGN.Lib.LB.AgnTagsResolver;const a=AGN.Lib.LB.Resizing;const l=AGN.Lib.LB.Ui;function c(e){var t={id:0,name:"",targetId:0,row:0,column:0,rows:1,columns:1,z:0,isTocItem:false,isRecycled:false,interestGroup:"",container:{id:0,name:"",isToc:false,isSortable:false,markup:[],content:{},tocItemPlaceholderId:0,type:"",filter:""},content:undefined};this.data=_.merge(t,e);if(this.data.content===undefined){this.data.content=_.clone(this.data.container.content)}this.capsule=new AGN.Lib.LB.Capsule(this);this.layeringIndex=s.DEFAULT_LAYERING_INDEX;this.callbacks={};var i=e.container.modeEdit;if(this.isContainerDeleted()||i===s.CONTAINER_TYPE.ANCHORED||i===s.CONTAINER_TYPE.FIXED_AND_ANCHORED){this.setDraggable(false);if(!s.IS_BASIC_LB){this.setResizable(false)}}}c.get=function(e){return e.data("agn:child")};c.set=function(e,t){e.data("agn:child",t)};c.render=function(e,i,n){var r="";e.forEach(function(t){switch(t.type){case s.MARKUP_SPAN.TEXT:if(t.value){r+=o.resolve(t.value)}else{r+=t.value}break;case s.MARKUP_SPAN.PLACEHOLDER:var e=i[t.id];if(t.markup&&!(t.placeholderType===s.PLACEHOLDER.MULTI&&e)){if(d(t,e)){r+=c.render(t.markup,i,n)}}else{switch(t.placeholderType){case s.PLACEHOLDER.LABEL:case s.PLACEHOLDER.TEXT:case s.PLACEHOLDER.LINK:case s.PLACEHOLDER.COLOR:case s.PLACEHOLDER.SELECT:case s.PLACEHOLDER.CHECK:case s.PLACEHOLDER.MULTI:if(e){r+=$.trim(o.resolve(e))}break;case s.PLACEHOLDER.IMAGE_SRC:if(e){r+=$.trim(o.resolve(e))}else{r+=n.noImageLink}break;case s.PLACEHOLDER.IMAGE:r+=parseInt(e)>0?n.imageUriPattern.replace("{image-id}",e):n.noImageLink;break;default:console.error("Unknown placeholder type: "+t.placeholderType)}}break;case s.MARKUP_SPAN.TOC_AREA:n.toc.forEach(function(e){r+=c.render(t.markup,i,$.extend({tocItem:e},n))});break;case s.MARKUP_SPAN.TOC_PLACEHOLDER:switch(t.placeholderType){case s.TOC_PLACEHOLDER_TYPE_ID:r+=s.TOC_ID_PREFIX+n.tocItem.id;break;case s.TOC_PLACEHOLDER_TYPE_NAME:r+=n.tocItem.name;break;default:console.error("Unknown TOC placeholder type: "+t.placeholderType)}break;default:console.error("Unknown span type: "+t.type)}});return AGN.Lib.Helpers.escapeAgnTags(r)};c.collectPlaceholders=function(e,t,i,n,r){e.forEach(function(e){switch(e.type){case s.MARKUP_SPAN.PLACEHOLDER:if((!r||r.call(r,e))&&!_.has(e.options,"showByValue")){if(n[e.id]===undefined){i.push({id:e.id,type:e.placeholderType,name:e.name,value:t[e.id],options:e.options,help:e.help});n[e.id]=true}}case s.MARKUP_SPAN.TOC_AREA:if(e.markup){c.collectPlaceholders(e.markup,t,i,n,r)}break}})};c.draggableOptions=function(){return{stack:"#lb-childrens .div-container",revert:"invalid",distance:20,cursor:"move",opacity:.4,refreshPositions:true,start:function(){s.EDITOR.setChildrenControlsEnabled(false)},stop:function(){s.EDITOR.setChildrenControlsEnabled(true);s.EDITOR.clearEmptyAddedOnTheFlyRows()},drag:function(e,t){s.EDITOR.processAddedOnTheFlyRows(e)}}};c.resizableOptions=function(n){let r=false;return{handles:"ne, se, sw, nw, w, n, e, s",autoHide:true,create:function(){r=new a(n,s.EDITOR.getGrid())},start:function(e,t){if(r===false){r=new a(n,s.EDITOR.getGrid())}const i=$(e.originalEvent.target);n.setControlsEnabled(false);n.capsule.setResizingEnabled(true);r.start(l.getResizeHandleDirection(i))},stop:function(e,t){r.stop(t.size.width,t.size.height);n.capsule.setResizingEnabled(false);n.setControlsEnabled(true);n.checkHoverState();s.EDITOR.updateToc(false);s.EDITOR.adjust();s.EDITOR.setChanged(true)},resize:function(e,t){r.resize(t.size.width,t.size.height)}}};c.prototype.asSubmittable=function(){return{id:this.data.id,containerId:this.data.container.id,name:this.data.name,targetId:this.data.targetId,interestGroup:this.data.container.isSortable?this.data.interestGroup||"":"",type:this.data.container.type,filter:this.data.container.filter,row:this.data.row,column:this.data.column,rows:this.data.rows,columns:this.data.columns,content:$.extend({},this.data.content),isTocItem:this.data.isTocItem}};c.prototype.get$=function(){return this.capsule.get$()};c.prototype.getId=function(){return this.data.id};c.prototype.getName=function(){return this.data.name};c.prototype.getContainerName=function(){return this.data.container.name};c.prototype.setName=function(e){this.data.name=e||""};c.prototype.getContainerId=function(){return this.data.container.id};c.prototype.isRecycled=function(){return this.data.isRecycled};c.prototype.setRecycled=function(e){if(e){this.setShown(false);this.setRows(1);this.setColumns(1);this.capsule.recycle();this.data.isRecycled=true}else{this.data.isRecycled=false}};c.prototype.setLayeringIndex=function(e){this.layeringIndex=e;this.capsule.setLayeringIndex(e)};c.prototype.getLayeringIndex=function(e){return this.layeringIndex};c.prototype.setOnLayeringRotate=function(e){if(e){this.callbacks.onLayeringRotate=()=>e.call(this)}else{this.callbacks.onLayeringRotate=undefined}};c.prototype.rotateLayering=function(){if(this.callbacks.onLayeringRotate){this.callbacks.onLayeringRotate()}};c.prototype.isInArea=function(e){return!this.isNotInArea(e)};c.prototype.isNotInArea=function(e){var t=e.column,i=t+e.columns-1;var n=e.row,r=n+e.rows-1;var s=this.data.column;var o=s+this.data.columns-1;var a=this.data.row;var l=a+this.data.rows-1;return Math.max(s,o)<t||Math.min(s,o)>i||Math.max(a,l)<n||Math.min(a,l)>r};c.prototype.isMatching=function(e){if(e===s.ALL_ENTRIES||this.data.targetId===s.ALL_RECIPIENTS){return true}return this.data.targetId===e};c.prototype.isToc=function(){return this.data.container.isToc};c.prototype.modeEdit=function(){return this.data.container.modeEdit};c.prototype.isTocItem=function(){return this.data.isTocItem};c.prototype.setTocItem=function(e){this.data.isTocItem=!!e};c.prototype.isSortable=function(){return this.data.container.isSortable};c.prototype.getInterestGroup=function(){if(this.isSortable()){return this.data.interestGroup||""}else{return""}};c.prototype.setInterestGroup=function(e){if(this.isSortable()){this.data.interestGroup=e||""}else{this.data.interestGroup=""}};c.prototype.getTargetId=function(){return this.data.targetId};c.prototype.setTargetId=function(e){this.data.targetId=e>=0?e:s.ALL_RECIPIENTS;this.capsule.updateControls()};c.prototype.getRow=function(){return this.data.row};c.prototype.setRow=function(e){return this.data.row=e};c.prototype.getColumn=function(){return this.data.column};c.prototype.setColumn=function(e){this.data.column=e};c.prototype.getZ=function(){return this.capsule.getZ()};c.prototype.setZ=function(e){this.capsule.setZ(e)};c.prototype.getRows=function(){return this.data.rows};c.prototype.setRows=function(e){this.data.rows=e};c.prototype.getColumns=function(){return this.data.columns};c.prototype.setColumns=function(e){this.data.columns=e};c.prototype.getArea=function(){return AGN.Lib.LB.Grid.area(this.data.row,this.data.column,this.data.rows,this.data.columns)};c.prototype.setArea=function(e){this.setRow(e.row);this.setColumn(e.column);this.setRows(e.rows);this.setColumns(e.columns)};c.prototype.getHeight=function(){return this.capsule.getHeight()};c.prototype.setShown=function(e){this.capsule.setShown(e);if(!this.isContainerDeleted()){this.setDraggable(e);if(!s.IS_BASIC_LB){this.setResizable(e)}}};c.prototype.setBorderHighlighted=function(e){this.capsule.setBorderHighlighted(e)};c.prototype.setHighlighted=function(e){this.capsule.setHighlighted(e)};c.prototype.setSize=function(e,t){this.capsule.setSize(e,t)};c.prototype.setCoordinates=function(e){this.capsule.setCoordinates(e)};c.prototype.setControlsEnabled=function(e){this.capsule.setControlsEnabled(e)};c.prototype.checkHoverState=function(){l.checkHoverState(this.capsule.get$())};c.prototype.adjustSize=function(e,t){const i=s.IS_BASIC_LB?"100%":e.getWidthForSpans(this.getColumns());this.setSize(i,t||"auto")};c.prototype.adjustHeight=function(e){this.capsule.adjustHeight(e)};c.prototype.adjustCoordinates=function(e){this.setCoordinates(e.getCoordinates(this.getRow(),this.getColumn()))};c.prototype.setDraggable=function(e){var t=this.capsule.get$();if(e){t.draggable(c.draggableOptions())}else{try{t.draggable("destroy")}catch(e){}}};c.prototype.setResizable=function(e){var t=this.capsule.get$();if(e){t.resizable(c.resizableOptions(this))}else{try{t.resizable("destroy")}catch(e){}}};c.prototype.getPlaceholders=function(t){var e=this.data.content;var i=[];var n={};var r=undefined;if(t){r=function(e){return e.placeholderType===t}}c.collectPlaceholders(this.data.container.markup,e,i,n,r);i.sort(function(e,t){return e.name.localeCompare(t.name)});return u(i)};c.prototype.getPlaceholder=function(t){const e=this.getPlaceholders();return e.find(e=>e.id==t)};c.prototype.containsMultiPh=function(){return!!this.getMultiPh()};c.prototype.getMultiPh=function(){return this.data.container.markup.find(e=>e.placeholderType===s.PLACEHOLDER.MULTI)};c.prototype.setContent=function(e){$.extend(this.data.content,e)};c.prototype.asTocItem=function(){var t=this.data.container.tocItemPlaceholderId;if(t>0){var e=this.data.content;var i=[];var n={};function r(e){return e.id===t}c.collectPlaceholders(this.data.container.markup,e,i,n,r);if(i.length){var s=i[0];return{id:this.data.id,name:e[s.id]||"",placeholderName:s.name,isEnabled:this.data.isTocItem}}}return null};c.prototype.rebuild=function(e){this.capsule.embrace(c.render(this.data.container.markup,this.data.content,e))};c.prototype.pulse=function(){return this.capsule.pulse()};c.prototype.clone=function(){var e=new c(this.data);e.data.id=0;return e};c.prototype.isContainerDeleted=function(){return this.data.container.isDeleted};c.prototype.isRssTemplateChild=function(){return!!(this.data.container.type&&this.data.container.type.startsWith("rss:contentSourceId="))};c.prototype.isRssImportedChild=function(){const e="rss:import";return!!(this.data.container.type&&this.data.container.type.startsWith(e))||!!(this.data.type&&this.data.type.startsWith(e))};function u(i){const n=new Map(i.filter(function(e){return e.type===s.PLACEHOLDER.CHECK}).map(function(e){return[e.id,e.options.split(",").map(function(t){return i.find(function(e){return t==e.id})})]}));const t=Array.from(n.values()).flat();const r=[];i.filter(function(e){return!t.includes(e)}).forEach(function(e){r.push(e);if(e.type===s.PLACEHOLDER.CHECK){const t=n.get(e.id);t.forEach(function(e){r.push(e)})}});return r}function d(e,t){if(!t){return e.placeholderType===s.PLACEHOLDER.MULTI}if(e.placeholderType!==s.PLACEHOLDER.SELECT){return true}return i(e,t)}function i(e,t){return!_.has(e.options,"showByValue")||n(e.options,t)}function n(e,t){return e?.showByValue===t}AGN.Lib.LB.Child=c})();(()=>{const i=AGN.Lib.LB.Definitions;function e(e){this.data=$.extend({id:0,name:"",isToc:false,markup:[],content:{}},e)}e.draggableOptions=function(){return{stack:"#lb-childrens .div-container",revert:"invalid",distance:20,helper:"clone",appendTo:"#page-wrapper",containment:"window",zIndex:i.TOP_Z,refreshPositions:true,start:function(e,t){t.helper.width($(this).width());i.EDITOR.setChildrenControlsEnabled(false)},stop:function(e,t){t.helper.width("auto");i.EDITOR.setChildrenControlsEnabled(true);i.EDITOR.clearEmptyAddedOnTheFlyRows()},drag:function(e,t){i.EDITOR.processAddedOnTheFlyRows(e)}}};e.prototype.getContainerId=function(){return this.data.id};e.prototype.getRows=function(){return 1};e.prototype.getColumns=function(){return 1};e.prototype.isToc=function(){return this.data.isToc};e.prototype.instantiate=function(){return new AGN.Lib.LB.Child({name:this.data.name,container:this.data})};AGN.Lib.LB.ChildSample=e})();(()=>{const n=AGN.Lib.LB.Definitions;const t=AGN.Lib.LB.Child;function i(e){if(e[0]instanceof t){this.children=e.slice()}else{this.children=e.sort(function(e,t){if(e.z===t.z){if(e.columns===t.columns){return e.column-t.column}return t.columns-e.columns}return e.z-t.z}).map(function(e){return new t(e)})}}i.make=function(e){return new i(e||[])};i.prototype.get=function(){return this.children.slice()};i.prototype.size=function(){return this.children.length};i.prototype.each=function(e){this.children.forEach(e)};i.prototype.sort=function(e){this.children.sort(e)};i.prototype.contains=function(e){return this.children.indexOf(e)>=0};i.prototype.containsToc=function(){for(var e=0;e<this.children.length;e++){if(this.children[e].isToc()){return true}}return false};i.prototype.matching=function(t){return this.select(function(e){return e.isMatching(t)})};i.prototype.unmatching=function(t){return this.select(function(e){return!e.isMatching(t)})};i.prototype.containsRssChildren=function(){return this.active().children.some(function(e){return e.isRssImportedChild()||e.isRssTemplateChild()})};i.prototype.active=function(){return this.select(function(e){return!e.isRecycled()})};i.prototype.recycled=function(){return this.select(function(e){return e.isRecycled()})};i.prototype.select=function(e){return new i(this.children.filter(e))};i.prototype.removeChilds=function(t){this.children=this.children.filter(e=>!t.includes(e))};i.prototype.add=function(e){e.setZ(this.active().calculateMaxZ()+1);this.children.push(e)};i.prototype.groupsMap=function(){var s={};var e=_.groupBy(this.children,function(e){return e.getRow()});$.each(e,function(n,e){var r={};e.forEach(function(e){var t=e.getColumns();if(t>1){var i=e.getColumn();for(var n=1;n<t;n++){r[i+n]=i}}});e.forEach(function(e){var t=e.getColumn();while(r[t]){t=r[t]}var i=n+":"+t;if(s[i]===undefined){s[i]=[]}s[i].push(e)})});return s};i.prototype.groups=function(){var i=[];var e=this.groupsMap();$.each(e,function(e,t){if(t.length){i.push(t)}});return i};i.prototype.collectTargetIds=function(){var t={};this.each(function(e){t[e.getTargetId()]=true});return Object.keys(t).sort()};i.prototype.calculateMaxZ=function(){return this.children.reduce(function(e,t){return Math.max(t.getZ(),e)},0)};i.prototype.calculateRowsCount=function(){return this.children.reduce(function(e,t){return Math.max(t.getRow()+t.getRows()-1,e)},0)};i.prototype.setShown=function(i){this.children.forEach(function(e){e.setShown(i);var t=e.data.container.modeEdit;if(t===n.CONTAINER_TYPE.ANCHORED||t===n.CONTAINER_TYPE.FIXED_AND_ANCHORED){e.setDraggable(false);if(!n.IS_BASIC_LB){e.setResizable(false)}}})};i.prototype.setBorderHighlighted=function(t){this.children.forEach(function(e){e.setBorderHighlighted(t)})};i.prototype.setHighlighted=function(t){this.children.forEach(function(e){e.setHighlighted(t)})};i.prototype.setControlsEnabled=function(t){this.children.forEach(function(e){e.setControlsEnabled(t);if(!e.isContainerDeleted()&&!n.IS_BASIC_LB){e.setResizable(t)}e.checkHoverState()})};i.prototype.asTocItems=function(e){var t;if(e){t=_.map(this.groupsMap(),function(e){return _.maxBy(e,function(e){return e.getZ()})})}else{t=this.children.slice()}var i=t.sort(function(e,t){if(e.getRow()===t.getRow()){if(e.getColumn()===t.getColumn()){return t.getZ()-e.getZ()}return e.getColumn()-t.getColumn()}return e.getRow()-t.getRow()}).map(function(e){return e.asTocItem()}).filter(function(e){return!!e});if(e){return i.filter(function(e){return e.isEnabled})}return i};i.prototype.pulse=function(){var e=this.children.map(function(e){return e.pulse()});return e};i.prototype.rebuildStatic=function(t){this.each(function(e){if(!e.isToc()){e.rebuild(t)}})};i.prototype.rebuildToc=function(t){let i=false;this.each(e=>{if(e.isToc()){e.rebuild($.extend({},t,{toc:this.asTocItems(true)}));i=true}});return i};i.prototype.rotateLayering=function(){const e=this.children.slice().sort((e,t)=>e.getZ()-t.getZ());const i=e.map(e=>e.getZ());e.forEach((e,t)=>{e.setShown(t===1);e.setZ(i[(t+1)%i.length])})};i.prototype.setLayeringByTargets=function(t){const e=this.children.slice().sort((e,t)=>t.getZ()-e.getZ());const i=e.map(e=>e.getZ());_.sortBy(e,e=>t.indexOf(e.getTargetId())).forEach((e,t)=>{e.setShown(t===0);e.setZ(i[t])})};i.prototype.stick=function(t){this.children.forEach(function(e){if(e.isInArea(t)){e.setArea(t)}})};i.prototype.adjustLayering=function(){let t=this.children.length;this.children.forEach(e=>e.setZ(--t))};i.prototype.adjustSizes=function(t){this.children.forEach(function(e){e.adjustSize(t)})};i.prototype.adjustCoordinates=function(t){this.children.forEach(function(e){e.adjustCoordinates(t)})};AGN.Lib.LB.Children=i})();(()=>{const o=AGN.Lib.LB.Definitions;const u="-mobile";function a(e,t,i){this.$el=e;this.child=t;this.options=i;this._displayMediapoolImages();this._controlCheckPhChildrenVisibility();this._updateImageSrcPreview=_.throttle(this._updateImageSrcPreview,300)}a.get=function(){return l().data("agn:child-editor")};a.init=function(e,t){const i=a.get();if(i&&!i.isInitForChild(e)&&!i.applyScheduledChanges()){return}const n=AGN.Lib.Template.dom("div-editing-block",{...t,mobileSuffix:u});const r=AGN.Lib.Template.dom("child-targetgroup-dropdown",{targets:t.targets,targetId:e.getTargetId()});const s=l();c();s.find(".js-wysiwyg").each(function(){window.removeEditor($(this).attr("id"))});s.find(".tile-title").text(e.getContainerName());s.find(".tile-body").empty().append(n);s.find("> .tile-header .tile-controls").empty().removeClass("hidden").append(r);const o=new a(s,e,t);s.data("agn:child-editor",o);AGN.Lib.Controller.init(n);AGN.runAll(s.find("> *"));AGN.Lib.Form.get(s).initFields();o.setupJsEditorChangeDetection()};a.prototype.updateImageSrc=function(e){const t=e.data("placeholder-id");const i=$.trim(e.val());this._updateImageSrcPreview(t,i)};a.prototype._updateImageSrcPreview=function(e,t){const i=$(`#preview-${e}`);if(i.attr("src")!==t){i.attr("src",$.trim(AGN.Lib.LB.AgnTagsResolver.resolve(t))||this.options.noPreviewImageLink)}};a.prototype.updateImage=function(e,t){const i=e.data("placeholder-id");const n=e.prop("files");const r=$(`#content-${i}`);if(n&&n.length){const s=n[0];if(s.type==="image"||s.type.match("image/.*")){const o=new FileReader;if(t){const a=i.replace(u,"");const l=$(`#image-name-${a}`).text();AGN.Lib.Helpers.renameFile(s,this.options.mobileImagePrefix+l)}else{const c=this._buildMobilePlaceholder(i);this._toggleMobileImageBlockVisibility(c,true);this._updateImagePreview(c)}o.onload=e=>this._updateImagePreview(i,e.target.result,s.name,s.name);o.readAsDataURL(s)}else{AGN.Lib.Helpers.clearFormField(e);this._updateImagePreview(i)}}else{this._updateImagePreview(i)}r.val("")};a.prototype.syncImageCategories=function(e,i){const t=$(`#content-${e}`).val();const n=this._findPlaceholdersWithImage(t);n.forEach(e=>{const t=$(`#image-category-id-${e.id}`);AGN.Lib.Select.get(t).selectValue(i)})};a.prototype._findPlaceholdersWithImage=function(t){return this.child.getPlaceholders(o.PLACEHOLDER.IMAGE).filter(e=>t==$(`#content-${e.id}`).val())};a.prototype._updateImagePreview=function(e,t,i,n){const r=$(`#preview-${e}`);const s=$(`#image-name-${e}`);if(r.attr("src")!==t){r.attr("src",t||this.options.noPreviewImageLink)}r.attr("title",n||"");s.text(i||"")};a.prototype._toggleMobileImageBlockVisibility=function(e,t){const i=$(`#image-block-${e}`);AGN.Lib.LB.Ui.setShown(i,t)};a.prototype.chooseImage=function(e){const t=$(`#file-${e}`);if(t.val()||String(e).endsWith(u)){t.trigger("click")}else{this.showMediapoolDialog(e)}};a.prototype.deleteImage=function(e,t){this._clearImageData(e);if(!t){const i=this._buildMobilePlaceholder(e);this._clearImageData(i);this._changeImageControlsState(i,false);this._toggleMobileImageBlockVisibility(i,false);this.savePlaceholder(e)}};a.prototype._clearImageData=function(e){const t=$(`#file-${e}`);const i=$(`#image-name-${e}`);const n=$(`#content-${e}`);const r=$(`#preview-${e}`);AGN.Lib.Helpers.clearFormField(t);i.text("");n.val("");r.attr("src",this.options.noPreviewImageLink)};a.prototype.showMediapoolDialog=function(n){AGN.Lib.Confirm.request(AGN.url("/mediapool/image/pick.action")).done(e=>{this._updateMobileAlternative(e.id,n);let t=e.category.categoryId;const i=this._findPlaceholdersWithImage(e.id);if(i.length>0){t=$(`#image-category-id-${i[0].id}`).val()}$(`#content-${n}`).val(e.id);AGN.Lib.Select.get($(`#image-category-id-${n}`)).selectValue(t);AGN.Lib.Helpers.clearFormField($(`#file-${n}`));this._updateImagePreview(n,e.src,e.fileName,e.title);this.savePlaceholder(n)})};a.prototype._updateMobileAlternative=function(e,t){const i=this._buildMobilePlaceholder(t);this._loadMobileAlternative(e).then(e=>{$(`#content-${i}`).val(e.id);this._updateImagePreview(i,e.src,e.name,e.title);this._changeImageControlsState(i,true)}).catch(()=>{this._updateImagePreview(i);this._changeImageControlsState(i,false)}).finally(()=>{AGN.Lib.Helpers.clearFormField($(`#file-${i}`));this._toggleMobileImageBlockVisibility(i,true)})};a.prototype._changeImageControlsState=function(e,t){const i=$(`#preview-${e}`);$(`#image-delete-button-${e}`).prop("disabled",t);$(`#choose-image-btn-${e}`).prop("disabled",t);i.toggleClass("clickable",!t);i.attr("data-action",t?"":"chooseImage")};a.prototype._loadMobileAlternative=function(i){return new Promise((t,e)=>{$.ajax({url:AGN.url(`/mediapool/content/images/mobile-alternative/${i}/load.action`),type:"GET",success:e=>t(e),error:()=>e(),statusCode:{404:()=>e()}})})};a.prototype._buildMobilePlaceholder=function(e){return e+u};a.prototype.updateChildTarget=function(e){o.EDITOR.setChildTarget(this.child,e)};a.prototype.updateChildInterestGroup=function(){const e=$("#is-interest-sortable").is(":checked")?$("#interest-group").val():"";this.child.setInterestGroup(e);o.EDITOR.setChanged(true)};a.prototype.updateToC=function(){const t={};$("input.js-is-toc-item").each(function(){const e=$(this);t[e.data("child-id")]=e.is(":checked")});o.EDITOR.updateTocItemsUsage(this.child,t)};a.prototype.setTocItem=function(e){o.EDITOR.setTocItem(this.child,e)};a.prototype._saveIfChanged=function(e){if(this._placeholderWasChanged(e)){return this.savePlaceholder(e)}return true};a.prototype._placeholderWasChanged=function(e){const t=this.child.getPlaceholder(e);if(!t){return false}const i=t.value;const n=this._readPlaceholderValue(e);return i!==n};a.prototype.savePlaceholder=function(i){const n=this.child.getPlaceholder(i);if(!this._validatePlaceholder(n)){return false}this._prepareDataBeforeSave(n).done(()=>{if(n.type===o.PLACEHOLDER.TEXT){const t=this._findCkEditor(i);if(t.exists()){AGN.Lib.Editor.get(t).val(t.val(),true)}}const e=this._readPlaceholderValue(i,n.type);o.EDITOR.savePlaceholder(this.child,i,e)});return true};a.prototype.updateCategory=function(e){const t=this.child.getPlaceholder(e);if(this._validatePlaceholder(t)){const i=parseInt($(`#content-${e}`).val());if(i>0){const n=$(`#image-category-id-${e}`).val();this.updateImageCategory(i,n,true).then(e=>{o.EDITOR.getUndoManager().operation("mediapoolImageCategoryChanged",this.child,i,e,n)})}}};a.prototype._readPlaceholderValue=function(e,t){const i=$(`#content-${e}`);if(t===o.PLACEHOLDER.CHECK){return i.prop("checked")?"checked":""}return i.val()};a.prototype._prepareDataBeforeSave=function(e){const t=$.Deferred();if(e.type===o.PLACEHOLDER.IMAGE){this._uploadImage(e).done(()=>t.resolve())}else{t.resolve()}return t.promise()};a.prototype.updateImageCategory=function(e,t,i=false){const n=$.Deferred();$.ajax(AGN.url(`/mediapool/${e}/category/change.action`),{type:"POST",dataType:"json",async:i,data:{categoryId:t}}).done(e=>n.resolve(e.data)).fail(()=>n.reject());return n.promise()};a.prototype._uploadImage=function(e){const t=$.Deferred();const n=[];const i=e.id;const r=this._buildMobilePlaceholder(i);const s=e=>{const t=$(`#file-${e}`).prop("files");if(t&&t.length){n.push({placeholderId:e,image:t[0],categoryId:$(`#image-category-id-${i}`).val()})}};s(i);s(r);if(!n.length){t.resolve()}else{const o=new FormData;n.forEach((e,t)=>{o.append(`images[${t}].file`,e.image);o.append(`images[${t}].fileName`,e.image.name);o.append(`images[${t}].title`,e.image.name);o.append(`images[${t}].categoryId`,e.categoryId)});$.ajax(AGN.url("/mediapool/images/uploadAjax.action"),{type:"POST",dataType:"json",enctype:"multipart/form-data",processData:false,contentType:false,data:o}).done(e=>{AGN.Lib.JsonMessages(e.popups);if(e.data){e.data.forEach((e,t)=>{if(e>0){const i=n[t].placeholderId;$(`#content-${i}`).val(e);AGN.Lib.Helpers.clearFormField($(`#file-${i}`));if(i==r){this._changeImageControlsState(r,true)}}})}if(e.success===true){t.resolve()}else{t.reject()}}).fail(()=>t.reject())}return t.promise()};a.prototype._validatePlaceholder=function(e){if(e.type===o.PLACEHOLDER.CHECK||e.type===o.PLACEHOLDER.COLOR){return true}if(e.type===o.PLACEHOLDER.IMAGE){return this._validateImageCategory(e)&&this._validateImageFormats(e)}if(e.type===o.PLACEHOLDER.TEXT){this.updateCkEditorsValue(e.id)}return this._validateHtml(e)};a.prototype._validateHtml=function(e){const t=$(`#content-${e.id}`).val();if(!$.trim(t)){return true}let i=false;$.ajax({type:"POST",url:AGN.url(`/layoutbuilder/template/${o.EDITOR.getTemplateId()}/validateHtml.action`),contentType:"application/json",async:false,data:JSON.stringify({htmlPlaceholders:{[e.name]:t}})}).done(e=>{AGN.Lib.JsonMessages(e.popups,true);i=!!e.success});return i};a.prototype._validateImageCategory=function(e){const i=e.id;const n=$(`#image-category-id-${i}`);AGN.Lib.Form.cleanFieldFeedback$(n);if(n.val()>0){return true}const r=!!$(`#file-${i}`).val();const s=$(`#content-${i}`).val();if(r||parseInt(s)>0){AGN.Lib.Form.showFieldError$(n,t("error.grid.noCategorySelected"))}return false};a.prototype._validateImageFormats=function(e){const i=e=>{const t=e.match(/[^.\\/]\.([^.\\/]+)$/);if(t){const i=["GIF","JPG","JPEG","PNG","SVG","ICO"];return i.includes(t[1].toUpperCase())}return false};const n=e.id;const r=$(`#file-${n}`).val();const s=$(`#content-${n}`);AGN.Lib.Form.cleanFieldFeedback$(s);if(r&&!i(r)){AGN.Lib.Form.showFieldError$(s,t("grid.divchild.format.error"));return false}return true};a.prototype.updateCkEditorsValue=function(e){const t=this._findCkEditor(e);if(t.exists()){CKEDITOR.instances[t.attr("id")]?.updateElement()}};a.prototype._findCkEditor=function(e){return this.$el.find(`.js-wysiwyg[data-ph-id='${e}']`)};a.prototype._controlCheckPhChildrenVisibility=function(){this.child.getPlaceholders(o.PLACEHOLDER.CHECK).filter(e=>e).forEach(e=>{const t=$(`
            <div id="${e.id}-children" class="bordered-box-sm" data-show-by-checkbox="#content-${e.id}">
                <div class="row g-2"></div>
            </div>
        `);t.insertAfter($(`#content-${e.id}`).parent());e.options.split(",").forEach(e=>{t.find("> .row").append($(`.ph-${e}`))})});AGN.Lib.CoreInitializer.run("checkbox-hider",this.$el)};a.prototype._displayMediapoolImages=function(){const e=this.child.getPlaceholders(o.PLACEHOLDER.IMAGE);const t=e.map(e=>parseInt(e.value)).filter(e=>e>0);if(t.length<=0){return}$.ajax(AGN.url("/mediapool/content/images/loadElementsAsJson.action"),{type:"POST",dataType:"json",traditional:true,contentType:"application/json",data:JSON.stringify(t)}).done(r=>{e.forEach(e=>{const t=parseInt(e.value);if(t>0){const i=r[t];AGN.Lib.Select.get($(`#image-category-id-${e.id}`)).selectValue(i.categoryId);this._updateImagePreview(e.id,i.src,i.name,i.title);const n=this._buildMobilePlaceholder(e.id);if(i.mobileSrc){this._updateImagePreview(n,i.mobileSrc,i.mobileName,i.mobileTitle);this._changeImageControlsState(n,true)}this._toggleMobileImageBlockVisibility(n,true)}})})};a.prototype.setupJsEditorChangeDetection=function(e=this.$el){const s=this;e.find(".js-editor").each(function(){const n=$(this);const r=n.attr("id");s._clearAutoSaveTimeout(n);const e=()=>{s._clearAutoSaveTimeout(n);const e=window.setTimeout(()=>{const e=n.data("ph-id");const t=s.child.getPlaceholder(e).value;const i=CKEDITOR.instances[r]?.getData()||n.val();if(t!==i){s.savePlaceholder(e,t)}},o.AUTOSAVE_INACITVE_INTERVAL);n.data("lb:autosave-timeoutId",e)};n.off("editor:change",e);n.on("editor:change",e);CKEDITOR.instances[r]?.on("change",e)})};a.prototype._clearAutoSaveTimeout=function(e){if(e.data("lb:autosave-timeoutId")){clearTimeout(e.data("lb:autosave-timeoutId"));e.data("lb:autosave-timeoutId",undefined)}};a.prototype.applyScheduledChanges=function(){const i=this;let n=true;this.$el.find(".js-editor").each(function(){const e=$(this);i._clearAutoSaveTimeout(e);const t=i._saveIfChanged(e.data("ph-id"));if(n){n=t}});return n};a.prototype.notifyTabChanged=function(e){const t=e.closest(".tile");const i=t.find(".js-editor").data("ph-id");this.setupJsEditorChangeDetection(t);this._saveIfChanged(i)};a.prototype.get$=function(){return this.$el};a.prototype.isInitForChild=function(e){return this.child===e};function l(){return $("#div-child-edit-tile")}function c(){l().on("keydown",function(e){if(e.key==="Enter"){e.preventDefault()}})}AGN.Lib.LB.ChildEditor=a})();(()=>{function e(e){this.child=e}e.prototype.getOptions=function(){return{targetName:AGN.Lib.LB.Definitions.EDITOR.getTargetName(this.child.getTargetId()),isToc:this.child.isToc(),containerDeleted:this.child.isContainerDeleted(),containerModeEdit:this.child.modeEdit()}};e.prototype.createControls=function(e){var t=AGN.Lib.Template.dom(e,this.getOptions());AGN.Lib.LB.Child.set(t.find("[data-action]"),this.child);AGN.runAll(t);return t};e.prototype.createInlineControls=function(){return this.createControls("child-controls")};e.prototype.createPopoverControls=function(){return this.createControls("child-popover-controls")};AGN.Lib.LB.ControlsFactory=e})();(()=>{const i=AGN.Lib.LB.Definitions;const n=AGN.Lib.LB.Child;function e(e){this.$capsule=e;this.child=n.get(e);this.factory=new AGN.Lib.LB.ControlsFactory(this.child);this.timeoutId=null;this.state=i.CONTROLS_STATE.HIDDEN;this.update();e.on("mouseenter",()=>this.show());e.on("mouseleave",()=>this.hide())}e.popoverOptions=function(e){return{trigger:"manual",html:true,content:function(){return e.getPopoverContent()}}};e.prototype.stopHiding=function(){if(this.timeoutId){clearTimeout(this.timeoutId);this.timeoutId=undefined;return true}return false};e.prototype.popoverShow=function(e=true){if(!this.stopHiding()){this.popover.show();if(e){const t=$(this.popover.tip);t.on("mouseenter",()=>this.popoverShow(false));t.on("mouseleave",()=>this.popoverHide())}}this.state=i.CONTROLS_STATE.POPOVER};e.prototype.popoverHide=function(e){this.stopHiding();if(e===true){this.popover.hide();this.state=i.CONTROLS_STATE.HIDDEN}else{var t=this;this.timeoutId=setTimeout(function(){t.popoverHide(true)},200)}};e.prototype.inlineShow=function(){this.$inlineControls.css("display","flex");this.state=i.CONTROLS_STATE.INLINE};e.prototype.inlineHide=function(){this.$inlineControls.hide();this.state=i.CONTROLS_STATE.HIDDEN};e.prototype.show=function(){if(this.state===i.CONTROLS_STATE.DISABLED){return}this.$inlineControls.css("bottom","");if(this.$inlineControls.height()<=this.$capsule.height()){this.$inlineControls.css("bottom",0);if(this.state===i.CONTROLS_STATE.POPOVER){this.popoverHide(true)}this.inlineShow()}else{if(this.state===i.CONTROLS_STATE.INLINE){this.inlineHide()}this.popoverShow()}};e.prototype.hide=function(e){switch(this.state){case i.CONTROLS_STATE.INLINE:this.inlineHide();break;case i.CONTROLS_STATE.POPOVER:this.popoverHide(e);break}};e.prototype.setEnabled=function(e){if(e){if(this.state===i.CONTROLS_STATE.DISABLED){this.state=i.CONTROLS_STATE.HIDDEN}}else{this.hide(true);this.state=i.CONTROLS_STATE.DISABLED}};e.prototype.update=function(){if(this.$inlineControls){this.$inlineControls.remove()}this.$inlineControls=this.factory.createInlineControls();this.$capsule.append(this.$inlineControls);if(this.popover){AGN.Lib.Popover.remove(this.$capsule)}if(this.$popoverControls){this.$popoverControls=undefined}this.popover=AGN.Lib.Popover.create(this.$capsule,e.popoverOptions(this));if(this.state===i.CONTROLS_STATE.INLINE||this.state===i.CONTROLS_STATE.POPOVER){this.show()}};e.prototype.getPopoverContent=function(){if(this.$popoverControls===undefined){this.$popoverControls=this.factory.createPopoverControls();var e=this.$popoverControls.find("[data-action]");n.set(e,this.child);var t=this;e.on("click",function(){t.popoverHide(true)})}this._updateLayeringBtn(this.child.getLayeringIndex(),this.$popoverControls);var i=this.$popoverControls.clone(true);AGN.runAll(i);return i};e.prototype.updateLayeringBtn=function(e){this._updateLayeringBtn(e,this.$inlineControls);this._updateLayeringBtn(e,this.$popoverControls)};e.prototype._updateLayeringBtn=function(e,t){if(!t){return}const i=t.find(".lb-layering-btn");if(e>0){i.find(".layer-number").text(e);i.off("click");i.on("click",()=>{this.child.rotateLayering();this.hide()})}i.toggleClass("hidden",e<=0)};e.prototype.remove=function(){this.state=i.CONTROLS_STATE.DISABLED;this.stopHiding();this.popover.destroy();this.$popoverControls=undefined;this.$inlineControls.remove();this.$inlineControls=undefined};AGN.Lib.LB.Controls=e})();(()=>{const i=AGN.Lib.LB.Definitions;const r=AGN.Lib.LB.Ui;function s(e){var t=this;var i=$.Deferred();var n=AGN.Lib.Template.dom("div-sandbox");this.promise=i.promise();this.watcher=new AGN.Lib.LB.PromiseProgressWatcher;this.$capsule=n;this.$content=s.stub();if(e.isContainerDeleted()){this.showIsDeleted()}n.find("iframe").on("load",function(){var e=$(this).contents().get(0);$(e.head).append(s.style());$(e.body).append(t.$content);t.watcher.bind(r.imagesAdjusted(t.$content));i.resolveWith(t)});n.appendTo("#lb-childrens");AGN.Lib.LB.Child.set(n,e);this.controls=new AGN.Lib.LB.Controls(n)}s.stub=function(){return $('<div class="div-container"></div>')};s.css=function(){return $("#template-styles").html()};s.style=function(){return $("<style/>",{html:this.css()})};s.prototype.get$=function(){return this.$capsule};s.prototype.updateControls=function(){this.controls.update()};s.prototype.setControlsEnabled=function(e){this.controls.setEnabled(e)};s.prototype.ready=function(e){if(e!==undefined){this.promise.done(e)}return this.promise.state()==="resolved"};s.prototype.setLayeringIndex=function(e){this.controls.updateLayeringBtn(e)};s.prototype.pulse=function(){return this.watcher.promise()};s.prototype.embrace=function(e){var t=$(e).filter("*");if(this.ready()){this.$content.replaceWith(t);this.$content=t;var i=this.$capsule.outerWidth();if(i>0){this.setSize(i,"auto")}this.watcher.bind(r.imagesAdjusted(t,true))}else{this.$content=t}};s.prototype.recycle=function(){var t=this;this.setShown(false);this.ready(function(){var e=s.stub();t.watcher.bind(false);t.$content.replaceWith(e);t.$content=e})};s.prototype.getZ=function(){return this.$capsule.css("z-index")};s.prototype.setZ=function(e){this.$capsule.css("z-index",e)};s.prototype.setShown=function(e){r.setShown(this.$capsule,e)};s.prototype.setBorderHighlighted=function(e){this.$capsule.toggleClass("highlight-border",e)};s.prototype.setHighlighted=function(e){this.$capsule.toggleClass("highlighted",e)};s.prototype.setCoordinates=function(e){this.$capsule.offset(e)};s.prototype.setSize=function(e,t){if(!i.IS_BASIC_LB){this.$content.outerWidth(e)}this.$capsule.outerWidth(e);if(this.ready()){this.$content.style("width",function(e){return e},"important");this.$content.style("height","auto","important");if(t==="auto"){t=this.$content.outerHeight()}this.$capsule.outerHeight(t)}else{if(t==="auto"){this.$capsule.outerHeight(i.EMPTY_ROW_HEIGHT)}else{this.$capsule.outerHeight(t)}}};s.prototype.adjustHeight=function(e){this.$capsule.outerHeight(e)};s.prototype.getHeight=function(){if(this.ready()){return r.getHeightAccurate(this.$content)}else{return i.EMPTY_ROW_HEIGHT}};s.prototype.setResizingEnabled=function(e){if(e){this.$capsule.css("box-sizing","content-box");this.$capsule.css("opacity",.4);this.$content.style("width","100%","important");this.$content.style("height","100%","important")}else{this.$capsule.css("box-sizing","");this.$capsule.css("opacity","")}};s.prototype.showIsDeleted=function(){const e=this.$capsule.find(".div-sandbox-overlay");e.addClass("div--deleted");const i=$(`
        <div data-tooltip="${t("grid.container.deleted")}">
            <button type="button" class="btn btn-icon btn-danger pe-none">
                <i class="icon icon-trash-alt"></i>
            </button>
        </div>
    `);AGN.Lib.Tooltip.create(i,AGN.Lib.Tooltip.options(i));e.append(i)};AGN.Lib.LB.Capsule=s})();(()=>{const n=AGN.Lib.LB.Child;class t{constructor(e){this.$droppable=AGN.Lib.Template.dom("droppable");this.$droppable.data("agn:droppable",this);this.$droppable.droppable(t.options(this));this.row=e;this.callbacks={}}static get(e){return e.data("agn:droppable")}static options(i){return{accept:"[data-building-block]",tolerance:"pointer",deactivate:function(){i.setHovered(false);if(i.callbacks.onHoverChange){i.callbacks.onHoverChange(false)}},drop:function(e,t){i.setHovered(false);if(i.callbacks.onDrop){i.callbacks.onDrop(n.get(t.draggable))}i.row.isEmptyRowAddedOnTheFly=false},over:function(e,t){if(i.callbacks.onHoverChange){i.callbacks.onHoverChange(n.get(t.draggable),true)}else{i.setHovered(true)}},out:function(e,t){if(i.callbacks.onHoverChange){i.callbacks.onHoverChange(n.get(t.draggable),false)}else{i.setHovered(false)}}}}get$(){return this.$droppable}getCoordinates(){return this.$droppable.offset()}getRow(){return this.row}getHeight(){return AGN.Lib.LB.Ui.getHeightAccurate(this.$droppable)}setHeight(e){this.$droppable.outerHeight(e)}setHovered(e){this.$droppable.toggleClass("container-hover-accept",e)}remove(){this.$droppable.droppable("destroy");this.$droppable.remove();this.callbacks.onDrop=undefined;this.callbacks.onHoverChange=undefined}setOnDrop(t){var i=this;this.callbacks.onDrop=function(e){t.call(i,e)}}setOnHoverChange(i){var n=this;this.callbacks.onHoverChange=function(e,t){i.call(n,e,t)}}}AGN.Lib.LB.Droppable=t})();(()=>{const e=AGN.Lib.LB.Definitions;const s=AGN.Lib.LB.Ui;class i{constructor(e,i){this.$row=AGN.Lib.Template.dom("droppables-row");this.$removeButton=AGN.Lib.Template.dom("remove-row-button");this.$row.data("agn:row",this);this.$removeButton.data("agn:row",this);this.droppables=[];this.callbacks={};for(var n=1;n<=e;n++){var r=this.createDroppable();this.droppables.push(r);this.$row.append(r.get$())}this.setGuttered(i);this.$removeButton.appendTo("#lb-sidebar");s.setTooltip(this.$removeButton,t("grid.row.delete"))}static get(e){return e.data("agn:row")}static isEmpty(t){return!e.EDITOR.children.active().children.some(e=>e.getRow()>=t&&e.getRow()+e.getRows()-1<=t)}animateAppearance(){const e=this.$row;const t=e.clone(true);e.hide().after(t);t.show().addClass("container-row-animated");t.one("animationend",function(){e.show();t.remove()})}createDroppable(){var e=new AGN.Lib.LB.Droppable(this);var r=this;e.setOnHoverChange(function(e,t){if(r.callbacks.onHoverChange){var i=this;var n=r.droppables.indexOf(i)+1;if(n>0){r.callbacks.onHoverChange.call(r,i,e,n,t)}}});e.setOnDrop(function(e){if(r.callbacks.onDrop){var t=this;var i=r.droppables.indexOf(t)+1;if(i>0){r.callbacks.onDrop.call(r,e,t,i)}}});return e}get$(){return this.$row}each(e){this.droppables.forEach(e)}getDroppables(){return this.droppables.slice()}getDroppable(e){return this.droppables[e-1]||null}setHeight(t){if(t>0){t=Math.max(t,e.COLLAPSED_BLOCK_SIZE)}else{t=e.EMPTY_ROW_HEIGHT}this.droppables.forEach(e=>e.setHeight(t))}isGuttered(){return this.$row.hasClass("guttered")}setGuttered(e){this.$row.toggleClass("guttered",!!e)}setHovered(n,r,s){if(r===undefined){this.droppables.forEach(e=>e.setHovered(n))}else{if(s===undefined){s=r}this.droppables.forEach((e,t)=>{var i=t+1;if(r<=i&&i<=s){e.setHovered(n)}else{e.setHovered(!n)}})}}remove(){this.droppables.forEach(e=>e.remove());this.droppables=[];s.removeTooltip(this.$removeButton);this.$removeButton.remove();this.$row.remove();this.callbacks.onDrop=undefined}setRemoveButtonShown(e){s.setShown(this.$removeButton,e)}setOnHoverChange(e){this.callbacks.onHoverChange=e}setOnDrop(e){this.callbacks.onDrop=e}getRemoveBtn$(){return this.$removeButton}getCoordinates(){const e=this.$row.offset().left;const t=this.$row.offset().top;return{startX:e,endX:e+this.$row.outerWidth(),startY:t,endY:t+this.$row.outerHeight()}}}AGN.Lib.LB.Row=i})();(()=>{const p=AGN.Lib.LB.Definitions;function f(e,t){this.$template=$("#lb-grid-template");this.$sidebar=$("#lb-sidebar");this.columns=e.columns;this.rows=[];this.gap=e.gap;this.columnWidth=e.columnWidth;this.callbacks={};this.hoveredDroppable=null;for(var i=1;i<=t;i++){var n=this.createRow(e.gutters[i-1]);this.$template.append(n.get$());this.rows.push(n)}this.adjustSidebar()}f.area=function(e,t,i,n){return{row:e,column:t,rows:i,columns:n}};f.prototype.createRow=function(e){var l=new AGN.Lib.LB.Row(this.columns,e);var c=this;l.setOnHoverChange(function(e,t,i,n){var r=c.getRowIndex(l)+1;if(r>0){if(n){c.setAreaHovered(f.area(r,i,t.getRows(),t.getColumns()));c.hoveredDroppable=e}else if(c.hoveredDroppable===e){c.setAreaHovered(false)}}else{c.setAreaHovered(false)}});l.setOnDrop(function(e,t,i){if(c.callbacks.onDrop){var n=c.getRowIndex(l)+1;if(n>0){var r=e.getRows();var s=c.getRows()-n+1;if(r>s){r=s}var o=e.getColumns();var a=c.getColumns()-i+1;if(o>a){o=a}c.callbacks.onDrop.call(c,e,t,f.area(n,i,r,o))}}});return l};f.prototype.each=function(e){this.rows.forEach(e)};f.prototype.getRows=function(){return this.rows.length};f.prototype.getColumns=function(){return this.columns};f.prototype.getRow=function(e){return this.rows[e-1]||null};f.prototype.getDroppable=function(e,t){var i=this.getRow(e);if(i){return i.getDroppable(t)}return null};f.prototype.getRowMargin=function(e){return p.UNCOLLAPSIBLE_GUTTER_SIZE+(e?this.gap:0)};f.prototype.getCoordinates=function(e,t){return this.getDroppable(e,t).getCoordinates()};f.prototype.getConstraints=function(e,t){return $.extend(this.getWidthConstraints(e,t),this.getHeightConstraints(e,t))};f.prototype.getWidthConstraints=function(e,t){const i=e.getColumn();const n=e.getColumns();const r=this.getWidthForSpans(1);let s;if(t.isHorizontal()){if(t.isEast()){s=this.getWidthForSpans(this.getColumns()-i+1)}else{s=this.getWidthForSpans(i+n-1)}}else{s=r}return{minWidth:r,maxWidth:s}};f.prototype.getHeightConstraints=function(e,t){var i=e.getColumns();var n=e.getColumn();var r=n+i-1;var s=e.getRows();var o=e.getRow();var a=o+s-1;var l,c;if(t.isVertical()){if(t.isSouth()){l=this.getMinHeightConstraint(o,n,1,i);a=this.getRows();if(t.isHorizontal()){if(t.isEast()){r=this.getColumns()}else{n=1}}}else{l=this.getMinHeightConstraint(a,n,1,i);o=1}c=this.getMaxHeightConstraint(o,n,a-o+1,r-n+1)}else{l=c=e.getHeight()}return{minHeight:Math.min(l,e.getHeight()),maxHeight:c}};f.prototype.getWidthForSpans=function(e){if(p.IS_BASIC_LB){return this.$template.width()}return this.columnWidth*e+this.gap*(e-1)};f.prototype.getHeightForSpans=function(e,t,i,n,r){var s=this;if(r===undefined){r=function(e,t){return e.getHeight()>t.getHeight()?e:t}}function o(e){return s.rows[e-1].getDroppables().slice(t-1,t+n-1).reduce(r)}var a=e;var l=e+i-1;if(a===l){return o(a).getHeight()}else{var c=o(a).get$();var u=o(l).get$();return u.position().top-c.position().top+u.outerHeight()}};f.prototype.getMinHeightConstraint=function(e,t,i,n){function r(e,t){return e.getHeight()<t.getHeight()?e:t}return this.getHeightForSpans(e,t,i,n,r)};f.prototype.getMaxHeightConstraint=function(e,t,i,n){function r(e,t){return e.getHeight()>t.getHeight()?e:t}return this.getHeightForSpans(e,t,i,n,r)};f.prototype.getArea=function(e,t,i,n){const r=this;let s,o;if(t.isHorizontal()){o=p.IS_BASIC_LB?1:Math.ceil(i/(this.columnWidth+this.gap));if(t.isEast()){s=e.getColumn()}else{s=e.getColumn()+e.getColumns()-o}}else{s=e.getColumn();o=e.getColumns()}function a(e){const t=r.rows[e-1];if(t){return t.getDroppables().slice(s-1,s+o-1).reduce((e,t)=>e.getHeight()>t.getHeight()?e:t)}else{return null}}function l(e){return e.get$().position().top}var c,u;if(t.isVertical()){var d,h;u=1;if(t.isSouth()){c=e.getRow();d=a(c);while(h=a(c+u)){if(n>l(h)-l(d)){u++}else{break}}}else{c=e.getRow()+e.getRows()-1;h=a(c);while(d=a(c-1)){if(n>l(h)-l(d)+h.getHeight()-d.getHeight()){c--;u++}else{break}}}}else{c=e.getRow();u=e.getRows()}return f.area(c,s,u,o)};f.prototype.setAreaHovered=function(i){if(i){this.each(function(e,t){if(t>=i.row-1&&t<=i.row-1+i.rows-1){e.setHovered(true,i.column,i.column+i.columns-1)}else{e.setHovered(false)}})}else{this.each(function(e){e.setHovered(false)})}if(this.callbacks.onAreaHovered){this.callbacks.onAreaHovered.call(this,i)}};f.prototype.startResizing=function(e){if(this.callbacks.onResizingStarted){this.callbacks.onResizingStarted.call(this,e)}};f.prototype.stopResizing=function(e){if(this.callbacks.onResizingStopped){this.callbacks.onResizingStopped.call(this,e)}};f.prototype.adjustRows=function(e){AGN.Lib.LB.Adjustments.make(this,e.get())};f.prototype.getDroppables=function(){var r=[];var t=this.gap;this.each(function(e,i){var n=(e.isGuttered()?t:0)+p.UNCOLLAPSIBLE_GUTTER_SIZE;e.each(function(e,t){r.push({droppable:e,row:i+1,column:t+1,marginBottom:n})})});return r};f.prototype.addRowBefore=function(e){var t=this.getRowIndex(e);if(t>=0){var i=true;if(t>0){i=this.rows[t-1].isGuttered()}var n=this.createRow(i);this.rows[t].get$().before(n.get$());this.rows.splice(t,0,n)}return t+1};f.prototype.addRow=function(){if(this.rows.length>0){this.rows[this.rows.length-1].setGuttered(true)}var e=this.createRow(true);this.$template.append(e.get$());this.rows.push(e);return this.rows.length};f.prototype.removeRow=function(e){var t=this.getRowIndex(e);if(t>=0){this.rows[t].remove();this.rows.splice(t,1)}return t+1};f.prototype.getRowIndex=function(e){return this.rows.indexOf(e)};f.prototype.adjustSidebar=function(){const l=e=>{e.removeClass("btn--small");e.removeClass("btn--detached");e.removeClass("btn--attached");e.css("height","")};const c=(e,t)=>{const i=t.offset().top+t.outerHeight()/2;const n=e.outerHeight()/2;e.offset({top:i-n})};let u=null;this.each(e=>{const t=e.get$();const i=e.getRemoveBtn$();l(i);const n=t.outerHeight();const r=n-i.outerHeight();const s=r>=0;const o=10;if(s){if(r>=o*2){i.css("height",n-o*2)}i.addClass("btn--attached")}else{i.addClass("btn--small");const a=u?.getRemoveBtn$();if(a&&a.hasClass("btn--detached")){i.addClass("btn--attached")}else{i.addClass("btn--detached")}}c(i,t);e.setRemoveButtonShown(true);u=e});this._updateSidebarWidth()};f.prototype._updateSidebarWidth=function(){const e=this.$sidebar.children().get().reduce((e,t)=>{const{left:i}=$(t).position();const n=i+$(t).outerWidth(true);return Math.max(e,n)},0);this.$sidebar.css("width",e)};f.prototype.setOnDrop=function(e){this.callbacks.onDrop=e};f.prototype.setOnAreaHovered=function(e){this.callbacks.onAreaHovered=e};f.prototype.setOnResizingStarted=function(e){this.callbacks.onResizingStarted=e};f.prototype.setOnResizingStopped=function(e){this.callbacks.onResizingStopped=e};AGN.Lib.LB.Grid=f})();(()=>{const r=AGN.Lib.LB.Definitions;function e(){e.prototype.import=function(){const t=this;this.getRssChildrenToReplaceWithNewContent().forEach(function(e){t._importContent(e)})};e.prototype.getRssChildrenToReplaceWithNewContent=function(){return _.union(this._getRssImportedStartChildren(),this.getRssTemplateChildren())};e.prototype._importContent=function(e){if(e.containsMultiPh()){this._fillChildWithRssContent(e)}else{this._replicateRssChild(e)}};e.prototype._fillChildWithRssContent=function(t){$.get(AGN.url("/layoutbuilder/container/"+t.getContainerId()+"/rss.action")).done(e=>r.EDITOR.savePlaceholder(t,t.getMultiPh().id,e))};e.prototype._replicateRssChild=function(t){const i=this;$.get(AGN.url("/layoutbuilder/container/"+t.getContainerId()+"/replicateRss.action")).done(function(e){i.insertRssChildren(i.getRssChildrenFromSamples(e),t)})};e.prototype.insertRssChildren=function(e,t){if(!e.length){return}var i=t.getColumn();var n=t.getRow();r.EDITOR.replaceChildren(t,e[0]);e.slice(1).forEach(function(e){e.setColumn(i);e.setRow(n);const t=r.EDITOR.cloneChild(e);i=t.getColumn();n=t.getRow()})};e.prototype.getRssChildrenFromSamples=function(e){return e.map(function(e){return new AGN.Lib.LB.ChildSample(e).instantiate()})};e.prototype.getImportedRssChildren=function(){return _.groupBy(r.EDITOR.children.active().children.filter(function(e){return e.isRssImportedChild()}),function(e){return e.data.type||e.data.container.type})};e.prototype.getRssTemplateChildren=function(){return r.EDITOR.children.active().children.filter(function(e){return e.isRssTemplateChild()})};e.prototype._removeRssChildrenAndGetPlaceholder=function(e){e.slice(1).forEach(function(e){const t=e.getRow();r.EDITOR.removeChild(e);if(AGN.Lib.LB.Row.isEmpty(t)){r.EDITOR.removeRow(r.EDITOR.grid.getRow(t))}});return e[0]};e.prototype._getRssImportedStartChildren=function(){const t=this;return _.map(this.getImportedRssChildren(),function(e){return t._removeRssChildrenAndGetPlaceholder(e)})}}AGN.Lib.LB.RssImporter=e})();(()=>{const a=AGN.Lib.LB.Definitions;const l=AGN.Lib.LB.Children;const i=AGN.Lib.LB.Categories;const n=AGN.Lib.LB.Targets;const o=AGN.Lib.LB.ChildEditor;const c=AGN.Lib.LB.Child;const u=AGN.Lib.LB.ChildSample;const d=AGN.Lib.LB.Ui;function e(){this.templateId=0;this.targetId=a.ALL_ENTRIES;this.targets=new n;this.categories=new i;this.children=new l([]);this.imageUriPattern="{image-id}";this.watcher=new AGN.Lib.LB.PromiseProgressWatcher;this.removedChildren=[];this.adjust=_.throttle(this.adjust,200);this.watcher.promise().progress(()=>this.adjust(false))}e.prototype.setup=function(e){e=$.extend({templateId:0,targetId:a.ALL_ENTRIES,grid:{},children:[],imageUriPattern:"{image-id}",noPreviewImageLink:"#",mobileImagePrefix:"mobile_",isTextVersionGenerationAllowed:false,serverSideUndoAvailable:false,isEmptyTextVersion:false,targets:[],interestGroups:[],categories:[],translations:{},actions:{}},e);$.i18n.load(e.translations);this.changesNotSaved=false;this.templateId=e.templateId;this.targetId=e.targetId;this.imageUriPattern=e.imageUriPattern;this.noPreviewImageLink=e.noPreviewImageLink;this.textVersionGenerationAllowed=e.isTextVersionGenerationAllowed;this.emptyTextVersion=e.isEmptyTextVersion;this.noImageLink=e.noImageLink;this.targets=new n(e.targets);this.interestGroups=e.interestGroups;this.categories=new i(e.categories);this.children=new l(e.children);this.actions=e.actions;this.mailingId=e.mailingId;this.mobileImagePrefix=e.mobileImagePrefix;this.isServerSideUndoAvailable=e.serverSideUndoAvailable;const t=this.children.active();this.grid=new AGN.Lib.LB.Grid(e.grid,Math.max(1,t.calculateRowsCount()));t.rebuildStatic({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink});t.adjustLayering();this.updateAvailableTargets();if(this.mailingId>0){this.editable=AGN.Opt.Components.MailingContentLock.manageLock(this.mailingId,e.isMailingExclusiveLockingAcquired,e.anotherLockingUserName)}else{this.editable=true}d.setTargetId(this.targetId);this.setTargetId(this.targetId);d.setUndoOptionEnabled(this.isServerSideUndoAvailable);if(this.editable){this.setupInteractions();this.updateRecycleBin();this.restoreUpdateTextVersionCheckbox(e.mailingId);this._setupUndoManager();d.setLoading(false)}else{t.each(function(e){e.setDraggable(false);e.setControlsEnabled(false);if(!a.IS_BASIC_LB){e.setResizable(false)}});d.setLoading(false);d.setEditable(false)}};e.prototype._setupUndoManager=function(){this.undoManager=new AGN.Lib.LB.UndoManager(this,{onChange:()=>{d.setUndoOptionEnabled(this.undoManager.canUndo()||this.isServerSideUndoAvailable);d.setRedoOptionEnabled(this.undoManager.canRedo())}});this.undoManager.registerHandler("placeholderUpdated",(e,t,i)=>{const n=e.getPlaceholder(t).value;this._savePlaceholder(e,t,i);if(o.get().isInitForChild(e)){this.editChild(e)}return[e,t,n]});this.undoManager.registerHandler("childTargetChanged",(e,t)=>{const i=e.getTargetId();this._setChildTarget(e,t);if(o.get().isInitForChild(e)){this.editChild(e)}return[e,i]});this.undoManager.registerHandler("tocItemsUsageUpdated",(e,t)=>{const i=this._collectTocItemsUsages();this._updateTocItemsUsage(e,t);if(o.get().isInitForChild(e)){this.editChild(e)}return[e,i]});this.undoManager.registerHandler("setTocItemChanged",(e,t)=>{const i=e.isTocItem();this._setTocItem(e,t);if(o.get().isInitForChild(e)){this.editChild(e)}return[e,i]});this.undoManager.registerHandler("mediapoolImageCategoryChanged",(e,t,i,n)=>{o.get().updateImageCategory(t,i);if(o.get().isInitForChild(e)){this.editChild(e)}return[e,t,n,i]})};e.prototype.getUndoManager=function(){return this.undoManager};e.prototype.restoreUpdateTextVersionCheckbox=function(){$("#update-text-version").attr("checked",this.getMadeChoice())};e.prototype.setupInteractions=function(){var o=this;this.children.recycled().each(function(e){e.setRows(1);e.setColumns(1)});function t(t,i){o.children.active().matching(o.targetId).each(function(e){if(e!==t){e.setControlsEnabled(i);if(!e.isContainerDeleted()&&!a.IS_BASIC_LB){e.setResizable(i)}if(e.data.container.modeEdit===a.CONTAINER_TYPE.ANCHORED||e.data.container.modeEdit===a.CONTAINER_TYPE.FIXED_AND_ANCHORED){if(!a.IS_BASIC_LB){e.setResizable(false)}}}})}this.grid.setOnResizingStarted(function(e){t(e,false)});this.grid.setOnResizingStopped(function(e){t(e,true);o.children.active().stick(e.getArea())});var e=null;this.grid.setOnAreaHovered(function(t){var i=o.children.active().matching(o.targetId);if(t){i=i.select(function(e){return e.isInArea(t)});if(e){e.each(function(e){if(!i.contains(e)){e.setHighlighted(false)}})}i.setHighlighted(true);e=i}else{i.setHighlighted(false);e=null}});this.grid.setOnDrop(function(e,t,i){var n=o.children.active();var r=false;if(!n.contains(e)){r=true;if(e instanceof u){e=e.instantiate();o.children.add(e)}else if(e.isRecycled()){e.setRecycled(false);o.updateRecycleBin()}else{e=e.clone();o.children.add(e)}if(o.targetId!==a.ALL_ENTRIES){e.setTargetId(o.targetId)}n=o.children.active();if(!e.isToc()){e.rebuild({imageUriPattern:o.imageUriPattern,noImageLink:o.noImageLink})}}e.setArea(i);n.active().stick(i);n.matching(o.targetId).rebuildToc({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink});e.adjustSize(o.grid);e.adjustCoordinates(o.grid);if(r){var s=e.data.container.modeEdit;e.setShown(true);if(s===a.CONTAINER_TYPE.ANCHORED||s===a.CONTAINER_TYPE.FIXED_AND_ANCHORED){e.setDraggable(false);if(!a.IS_BASIC_LB){e.setResizable(false)}}o.adjust();o.watcher.bind(n.matching(o.targetId).pulse())}else{o.adjust()}o.updateAvailableTargets();o.setChanged(true)});$("#lb-childrens").on("click","[data-building-block]",function(e){var t=$(e.target);if(t.is("button")||t.is(".ui-resizable-handle")||t.closest("button").exists()){return}var i=$(this);var n=c.get(i);var r=n.data.container.modeEdit;if(n){if(r===a.CONTAINER_TYPE.EDITABLE||r===a.CONTAINER_TYPE.ANCHORED){a.EDITOR.editChild(n)}}})};e.prototype.updateAvailableTargets=function(){var e=this.children.active();var t=this.targets;var i=e.collectTargetIds();var s=[];e.groups().forEach(function(e){var i={};e.sort(function(e,t){return e.getZ()-t.getZ()}).forEach(function(e,t){i[e.getTargetId()]=t});s.push(i)});i.sort(function(i,n){var r=0;s.forEach(function(e){if(i in e&&n in e){var t=e[i]-e[n];if(t<0){r++}else if(t>0){r--}}});return r});d.setAvailableTargetIds(i.map(function(e){return{id:e,name:t.name(e)}}));if(i.indexOf(String(this.targetId))<0){this.targetId=a.ALL_ENTRIES}d.setTargetId(this.targetId)};e.prototype.getTemplateId=function(){return this.templateId};e.prototype.isTextVersionGenerationAllowed=function(){return this.textVersionGenerationAllowed};e.prototype.saveMadeChoice=function(e){AGN.Lib.WebStorage.set("updateTextVersion_"+this.mailingId,e)};e.prototype.getMadeChoice=function(){return AGN.Lib.WebStorage.get("updateTextVersion_"+this.mailingId)};e.prototype.isEmptyTextVersion=function(){return this.emptyTextVersion};e.prototype.isChanged=function(){return this.changesNotSaved};e.prototype.isEditable=function(){return this.editable};e.prototype.setChanged=function(e){if(!!e){this.controlRssBtn()}this.changesNotSaved=!!e};e.prototype.getGrid=function(){return this.grid};e.prototype.getTargetName=function(e){return this.targets.name(e)};e.prototype.setTargetId=function(e){var t=this.children.active();this.targetId=e;t.unmatching(this.targetId).setShown(false);t=t.matching(this.targetId);t.rebuildToc({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink});t.setShown(true);this.adjust();this.watcher.bind(t.pulse())};e.prototype.setLayeringByTargets=function(t){let i=false;this.children.active().groups().forEach(e=>{if(e.length>1){l.make(e).setLayeringByTargets(t);i=true}});if(i){this.updateToc(true)}this.setChanged(true);this.adjust(false)};e.prototype.setChildrenControlsEnabled=function(e){this.children.active().matching(this.targetId).setControlsEnabled(e)};e.prototype.updateToc=function(e){var t=this.children.active().matching(this.targetId);if(t.rebuildToc({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink})&&e){this.adjustSizes(t);this.adjustCoordinates(t)}};e.prototype.adjustSizes=function(e){if(e===undefined){e=this.children.active().matching(this.targetId)}e.adjustSizes(this.grid);this.grid.adjustRows(e)};e.prototype.adjustCoordinates=function(e){if(e===undefined){e=this.children.active().matching(this.targetId)}this.grid.adjustSidebar();e.adjustCoordinates(this.grid)};e.prototype.adjustLayering=function(e){var s=this;if(e===undefined){e=this.children.active().matching(this.targetId)}var o=e.groupsMap();this.grid.each(function(e,r){e.each(function(e,t){var i=r+1+":"+(t+1);var n=l.make(o[i]);if(n.size()>1){n.setBorderHighlighted(true);n.each((e,t)=>{e.setShown(t===0);e.setLayeringIndex(t+1);e.setOnLayeringRotate(()=>{s.setChanged(true);n.rotateLayering();s.updateToc(true);s.adjust(false)})})}else{n.setBorderHighlighted(false);n.each(e=>{e.setShown(true);e.setLayeringIndex(a.DEFAULT_LAYERING_INDEX);e.setOnLayeringRotate(null)});s.adjust(false)}})})};e.prototype.adjust=function(e){const t=this.children.active().matching(this.targetId);if(e!==false){this.adjustLayering(t)}this.adjustSizes(t);this.adjustCoordinates(t)};e.prototype.addRowBefore=function(e,t){var r=this.grid.addRowBefore(e);var i=this.children.active();var s=false;i.each(function(e){var t=e.getRows();var i=e.getRow();var n=i+t-1;if(r<=i){e.setRow(i+1)}else if(r>i&&r<=n){s=true;e.setRows(t+1)}});if(t!==false){if(s){this.adjust()}else{this.adjustCoordinates(i.matching(this.targetId))}}this.setChanged(true)};e.prototype.addRowAfter=function(e){if(!this.isEditable()){return}if(this.grid.getRowIndex(e)==this.grid.getRows()-1){this.addRow()}else{const t=this.grid.getRowIndex(e);this.addRowBefore(this.grid.rows[t+1])}};e.prototype.addRow=function(e){this.grid.addRow();if(e!==false){this.grid.adjustSidebar()}this.setChanged(true)};e.prototype.removeRow=function(e){var r=this.grid.removeRow(e);var t=this.children.active();var s=false;var o=false;t.each(function(e){var t=e.getRows();var i=e.getRow();var n=i+t-1;if(r>=i&&r<=n){if(t>1){e.setRows(t-1);o=true}else{e.setRecycled(true);s=true}}else if(r<i){e.setRow(i-1)}});if(s){t=this.children.active().matching(this.targetId);t.rebuildToc({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink});this.adjust();this.watcher.bind(t.pulse());this.updateAvailableTargets();this.updateRecycleBin()}else if(o){this.adjust()}else{this.adjustCoordinates()}this.setChanged(true)};e.prototype.removeChild=function(e){if(this.children.contains(e)){e.setRecycled(true);this.updateToc(false);this.adjust();this.updateAvailableTargets();this.updateRecycleBin();this.setChanged(true)}};e.prototype.cloneChild=function(e){var i=this;var c=this.grid.getColumns();var t=this.children.active();function l(e,r,s){var o=[];var a={};e.each(function(e){var t=e.getColumn();if(r===e.getRow()&&t>=s){o.push(e);var i=e.getColumns();a[t]=Math.min(a[t]||t,t);for(var n=1;n<i;n++){a[t+n]=t}}});var t=_.groupBy(o,function(e){var t=e.getColumn();while(a[t]&&a[t]!==t){t=a[t]}return t});var i=[];for(var n=s;n<=c;n++){if(a[n]){var l=t[n];if(l){i.push(l)}}else{i.push([])}}return i}function u(e){var t=0;e.forEach(function(e){if(e.length===0){t++}});return t}function d(e,t){function i(e,i){var n=null,r=null;e.forEach(function(e){var t=e.getColumn();var i=t+e.getColumns()-1;n=Math.min(n||t,t);r=Math.max(r||i,i)});var t=0;if(r+i>c){t=c+1-n-i;i=i+t}e.forEach(function(e){var t=e.getColumn()+i;if(t>c){e.setRow(e.getRow()+1);e.setColumn(t-c)}else{e.setColumn(t)}});return t}for(var n=0;n<e.length&&t>0;n++){var r=e[n];if(r.length>0){t+=i(r,t)}else{t--}}}function h(e){var t=i.grid.getRow(e);if(t){i.addRowBefore(t,false)}else{i.addRow(false)}}function n(e,t,i){var n=t.getRow();var r=t.getColumns();var s=t.getColumn()+r;var o=l(e,n,s);var a=c-s+1;if(a>=r){if(u(o)>=r){d(o,r)}else{h(n+1);d(o,r)}i.setRow(n);i.setColumn(s)}else{h(n+1);d(o,a+r);i.setRow(n+1);i.setColumn(1)}}var r=e.clone();n(t,e,r);r.rebuild({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink});r.setShown(true);this.children.add(r);this.updateToc(false);this.watcher.bind(this.children.active().matching(this.targetId).pulse());this.adjust();this.setChanged(true);return r};e.prototype.replaceChildren=function(e,t){this.removeChild(e);t.setRow(e.getRow());t.setColumn(e.getColumn());t.rebuild({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink});t.setShown(true);this.children.add(t);this.updateToc(false);this.watcher.bind(this.children.active().matching(this.targetId).pulse());this.adjust();this.setChanged(true)};e.prototype.editChild=function(e){if(this.isEditable()){const t={child:{name:e.getName(),containerName:e.getContainerName(),isToc:e.isToc(),isSortable:e.isSortable(),interestGroup:e.getInterestGroup(),targetId:e.getTargetId(),asTocItem:e.asTocItem(),placeholders:e.getPlaceholders()},targets:this.targets.list(),interestGroups:this.interestGroups.slice(),categories:this.categories.list(),imageUriPattern:this.imageUriPattern,noPreviewImageLink:this.noPreviewImageLink,noImageLink:this.noImageLink,mailingId:this.mailingId,mobileImagePrefix:this.mobileImagePrefix,resolveAgnTags:e=>{return e?$.trim(AGN.Lib.LB.AgnTagsResolver.resolve(e)):e}};if(e.isToc()){t.child.toc=this.children.active().asTocItems(false)}if(e.containsMultiPh()){const i=e.getMultiPh();const n=e.containsMultiPh()&&e.data.content[i.id];if(n){const r=[];c.collectPlaceholders(i.markup,e.data.content,r,{},null);const s=r.map(e=>e.id);t.child.placeholders=t.child.placeholders.filter(e=>!s.includes(e.id))}}o.init(e,t)}};e.prototype.setChildTarget=function(e,t){this.undoManager.operation("childTargetChanged",e,e.getTargetId());this._setChildTarget(e,t)};e.prototype._setChildTarget=function(e,t){e.setTargetId(t);const i=e.isMatching(this.targetId);e.setShown(i);if(!i){this.watcher.bind(this.children.active().matching(this.targetId).pulse());if(!e.isToc()&&!e.isTocItem()){this.updateToc(false)}}if(e.isTocItem()){this.updateToc(false)}this.adjust();this.setChanged(true);this.updateAvailableTargets()};e.prototype.updateTocItemsUsage=function(e,t){if(e.isToc()){this.undoManager.operation("tocItemsUsageUpdated",e,this._collectTocItemsUsages());this._updateTocItemsUsage(e,t)}};e.prototype._updateTocItemsUsage=function(e,i){this.children.active().each(e=>{const t=i[e.getId()];if(t===true||t===false){e.setTocItem(t)}});this.updateToc(false);this.adjust();this.setChanged(true)};e.prototype._collectTocItemsUsages=function(){const t={};this.children.active().asTocItems(false).forEach(e=>t[e.id]=e.isEnabled);return t};e.prototype.setTocItem=function(e,t){this.undoManager.operation("setTocItemChanged",e,e.isTocItem());this._setTocItem(e,t)};e.prototype._setTocItem=function(e,t){e.setTocItem(t);this.updateToc(false);this.adjust();this.setChanged(true)};e.prototype.savePlaceholder=function(e,t,i){this.undoManager.operation("placeholderUpdated",e,t,e.getPlaceholder(t).value);this._savePlaceholder(e,t,i)};e.prototype._savePlaceholder=function(e,t,i){e.setContent({[t]:i});if(e.isToc()){this.updateToc(false)}else{e.rebuild({imageUriPattern:this.imageUriPattern,noImageLink:this.noImageLink})}if(!e.isMatching(this.targetId)){this.watcher.bind(this.children.active().matching(this.targetId).pulse())}this.adjust(false);this.setChanged(true)};e.prototype.controlRssBtn=function(){$('[data-action="import-from-content-source"]').parent().toggle(this.children.containsRssChildren())};e.prototype.updateRecycleBin=function(){const e=$("#recyclebin-content");const t=$("#grid-recyclebin-tab").find("[data-no-found-blocks-msg]");const i=$("#recycle-bin-clear-btn");this.children.sort(function(e,t){if(e.isRecycled()===t.isRecycled()){return 0}return e.isRecycled()?1:-1});var n=this.children.recycled().get();d.setShown(t,n.length===0);d.setShown(i,n.length>0);var r=AGN.Lib.Template.dom("recyclebin-blocks",{children:n.map(function(e){return{name:e.getName()||e.getContainerName(),id:e.getId(),containerId:e.getContainerId()}})});e.html(r);r.find("[data-building-block]").each(function(e){var t=$(this);t.draggable(u.draggableOptions());c.set(t,n[e])})};e.prototype.getGuttersAsString=function(){var t=[];this.grid.each(function(e){t.push(e.isGuttered()?"1":"0")});return t.join("|")};e.prototype.getChildrenAsSubmittable=function(){var e=this.children.active().groups();var i=[];var n=d.getAvailableTargetIds();e.forEach(function(e){e=_.sortBy(e,function(e){return n.indexOf(e.getTargetId())});var t=0;e.forEach(function(e){e.setZ(t++);i.push(e.asSubmittable())})});return i};e.prototype.validateOverlaps=function(){var e=this.children.active().select(function(e){return e.getRows()>1}).get();for(var t=0;t<e.length;t++){var i=e[t];var n=i.getRow();var r=n+i.getRows()-1;for(var s=t+1;s<e.length;s++){var o=e[s];var a=o.getRow();var l=a+o.getRows()-1;if(a>n&&a<=r&&l>r||a<n&&l>=n&&l<r){var c=i.getColumn();var u=c+i.getColumns()-1;var d=o.getColumn();var h=d+o.getColumns()-1;if(d>u||h<c){return false}}}}return true};e.prototype.save=function(e){const i=o.get();if(i&&!i.applyScheduledChanges()){return}if(this.validateOverlaps()){const n=AGN.Lib.Form.get($("#grid-template-tile"));this.setChanged(false);n.setValue("forceGenerateTextVersion",e===true);n.setValue("rowGutters",this.getGuttersAsString());n.setValue("childrenJson",JSON.stringify(this.getChildrenAsSubmittable()));n.setValue("removedChildren",this.removedChildren);n.submit("resource")}else{AGN.Lib.Messages(t("defaults.error"),t("error.template.invalidVerticalSpanning"),"alert")}};e.prototype.checkIfDataRestoreNeeded=function(e){const t=this.getChildrenData();const i=e.children;if(t.length!==i.length){return true}return JSON.stringify(t)!==JSON.stringify(i)};e.prototype.getDataForAutoSave=function(){return{children:this.getChildrenData()}};e.prototype.getChildrenData=function(){return this.children.children.map(function(e){return e.data})};e.prototype.clearEmptyAddedOnTheFlyRows=function(){this.grid.each(e=>{if(e.isEmptyRowAddedOnTheFly){this.removeRow(e)}})};e.prototype.processAddedOnTheFlyRows=function(e){if(this.grid.getRows()>0){const{pageX:t,pageY:i}=e;const n=this.grid.rows.find(e=>this.isRowHovered(e,t,i));if(!n||n.isEmptyRowAddedOnTheFly){return}const r=10;const s=n.getCoordinates();const o=Math.abs(i-s.startY);const a=Math.abs(i-s.endY);const l=o<=a;const c=this.grid.getRowIndex(n);const u=this._findRowByIndex(c-1);const d=this._findRowByIndex(c+1);if(u?.isEmptyRowAddedOnTheFly&&l||d?.isEmptyRowAddedOnTheFly&&!l){return}if(l&&i<s.startY||!l&&i>s.endY||Math.min(o,a)<=r){this.appendRowOnTheFlyFor(n,l)}}else{this.appendRowOnTheFly()}};e.prototype._findRowByIndex=function(e){if(e<0||e>=this.grid.rows.length){return null}return this.grid.rows[e]};e.prototype.isRowHovered=function(e,t,i){const n=e.getCoordinates();const r=(e.isGuttered()?this.grid.gap:1)/2;return t>=n.startX&&t<=n.endX&&(i>n.startY-r&&i<n.endY+r)};e.prototype.appendRowOnTheFlyFor=function(e,t){this.clearEmptyAddedOnTheFlyRows();const i=this.grid.getRowIndex(e);let n;if(t){this.addRowBefore(e);n=this._findRowByIndex(i)}else{this.addRowAfter(e);n=this._findRowByIndex(i+1)}n.isEmptyRowAddedOnTheFly=true;n.animateAppearance()};e.prototype.appendRowOnTheFly=function(){this.addRow(false);const e=this._findRowByIndex(0);e.isEmptyRowAddedOnTheFly=true;e.animateAppearance()};e.prototype.getRecycledChildren=function(){return this.children.recycled().get().map(e=>e.getId()).filter(e=>e>0)};e.prototype.clearRecycleBin=function(){const e=this.children.recycled();e.each(e=>{if(e.getId()>0){this.removedChildren.push(e.getId())}});this.children.removeChilds(e.get());this.updateRecycleBin()};e.prototype.undo=function(){return this.undoManager.undo()};e.prototype.redo=function(){return this.undoManager.redo()};AGN.Lib.LB.Editor=e})();(function(){var e={actionbased_mailing:{anchors:[[.07,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.78,0,1]]},mailing_mediatype_sms:{anchors:[[.07,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.78,0,1]]},mailing_mediatype_post:{anchors:[[.07,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.78,0,1]]},archive:{anchors:[[.1,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.8,0,1]]},datebased_mailing:{anchors:[[.07,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.78,0,1]]},deadline:{anchors:[[.1,.5,-1,0],[.5,.05,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},decision:{anchors:[[.06,.5,-1,0],[.5,.06,0,-1],[.94,.5,1,0],[.5,.94,0,1]]},export:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},followup_mailing:{anchors:[[.04,.5,-1,0],[.5,.2,0,-1],[.96,.5,1,0],[.5,.8,0,1]]},form:{anchors:[[.1,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.78,0,1]]},import:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},mailing:{anchors:[[.1,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.78,0,1]]},ownWorkflow:{anchors:[[.1,.5,-1,0],[.5,.22,0,-1],[.9,.5,1,0],[.5,.78,0,1]]},parameter:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},recipient:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},scABTest:{anchors:[[.1,.5,-1,0],[.5,.15,0,-1],[.9,.5,1,0],[.5,.85,0,1]]},scBirthday:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.85,0,1]]},scDOI:{anchors:[[.3,.5,-1,0],[.5,.04,0,-1],[.72,.5,1,0],[.5,.96,0,1]]},welcomeTrack:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},welcomeTrackWithIncentive:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},anniversaryMail:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},birthdayWithCoupon:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},shoppingCartAbandonersSmall:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},shoppingCartAbandonersLarge:{anchors:[[.1,.5,-1,0],[.5,.1,0,-1],[.9,.5,1,0],[.5,.9,0,1]]},start:{anchors:[[0,.5,-1,0],[.5,.15,0,-1],[1,.5,1,0],[.5,.85,0,1]]},stop:{anchors:[[0,.5,-1,0],[.5,.15,0,-1],[1,.5,1,0],[.5,.85,0,1]]}};var t={"*":{deadline:function(e,t){return!t.connections.incoming.some(function(e){return e.source.getType()==="import"})},mailing:function(e,t){return t.connections.incoming.length===0},datebased_mailing:function(e,t){return t.connections.incoming.length===0}},start:{recipient:true,form:true,import:true,export:true},stop:false,decision:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,mailing_mediatype_sms:true,mailing_mediatype_post:true,actionbased_mailing:true,datebased_mailing:true,followup_mailing:true,mailing:true},parameter:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,mailing_mediatype_sms:true,mailing_mediatype_post:true,actionbased_mailing:true,datebased_mailing:true,followup_mailing:true,mailing:true},deadline:{decision:true,parameter:true,recipient:true,archive:true,mailing_mediatype_sms:true,mailing_mediatype_post:true,actionbased_mailing:true,datebased_mailing:true,followup_mailing:true,mailing:true,import:true,export:true},recipient:{decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,mailing_mediatype_sms:true,mailing_mediatype_post:true,actionbased_mailing:true,datebased_mailing:true,followup_mailing:true,mailing:true,import:true,export:true},actionbased_mailing:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,import:true,export:true},datebased_mailing:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,import:true,export:true},followup_mailing:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,import:true,export:true},mailing:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,import:true,export:true},mailing_mediatype_sms:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,import:true,export:true},mailing_mediatype_post:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,import:true,export:true},archive:{decision:true,parameter:true,deadline:true,recipient:true,actionbased_mailing:true,mailing_mediatype_sms:true,mailing_mediatype_post:true,datebased_mailing:true,followup_mailing:true,mailing:true,import:true,export:true},form:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,form:true,archive:true,actionbased_mailing:true,mailing_mediatype_sms:true,mailing_mediatype_post:true,datebased_mailing:true,followup_mailing:true,mailing:true,import:true,export:true},import:{deadline:function(e){return e.connections.outgoing.length===0}},export:{stop:true,decision:true,parameter:true,deadline:true,recipient:true,actionbased_mailing:true,mailing_mediatype_sms:true,mailing_mediatype_post:true,datebased_mailing:true,followup_mailing:true,mailing:true,import:true,export:true,archive:true,form:true}};AGN.Lib.WM.Definitions={KEY_ENTER:13,KEY_SHIFT:16,KEY_CTRL:17,KEY_SPACE:32,KEY_DELETE:46,MOUSE_BUTTON_LEFT:0,MOUSE_BUTTON_MIDDLE:1,DEFAULT_DRAG_MODE:0,GRID_CELL_DRAG_MODE:1,BOTTOM:"BOTTOM",LEFT:"LEFT",RIGHT:"RIGHT",TOP:"TOP",NODE_ANIMATION_DROPPED:"animate-dropped",NODE_ANIMATION_AUTO_DROPPED:"animate-auto-dropped",Z_INDEX_VIEW_PORT:10,Z_INDEX_ICON_PANEL:50,Z_INDEX_DRAGGABLE_BUTTON:60,Z_INDEX_ICON_TITLES_CONTAINER:5,Z_INDEX_CONNECTION_OVERLAY:9,Z_INDEX_ICON:10,Z_INDEX_CONNECTION_HOVER:11,Z_INDEX_CONNECTION_OVERLAY_HOVER:12,Z_INDEX_ICON_HOVER:13,Z_INDEX_ICON_TITLE_HOVER:19,Z_INDEX_DRAGGED_ICON_NODE:20,Z_INDEX_JSPLUMB_DRAG_OPTIONS:25,Z_INDEX_NAVIGATOR_GLOBE:30,Z_INDEX_NAVIGATOR_ARROWS:31,Z_INDEX_CONTEXT_MENU:40,CANVAS_DEFAULT_GRID_SIZE:20,CANVAS_GRID_SIZE:20,NODE_SIZE:64,NODE_MIN_MARGIN:.1,TITLE_WIDTH:94,MINIMAP_PADDING:2,DEFAULT_AUTO_ALIGN_STEP_X:5,GRID_AUTO_ALIGN_STEP_X:2,AUTO_ALIGN_STEP_X:5,AUTO_ALIGN_EXTRA_STEP_X:.5,DEFAULT_AUTO_ALIGN_STEP_Y:6,GRID_AUTO_ALIGN_STEP_Y:2,AUTO_ALIGN_STEP_Y:6,AUTO_ALIGN_STEP_BETWEEN_GROUPS:2,AUTO_DROP_STEP_X:4,AUTO_DROP_STEP_Y:3,MIN_ZOOM:.5,MAX_ZOOM:1.5,DEFAULT_ZOOM:1,ZOOM_STEP:.1,NAVIGATION_STEP:100,MAX_UNDO_STEPS:17,CONNECTION_COLOR:"#C0C0C0",CONNECTION_THICKNESS:3,CONNECTION_OUTLINE_COLOR:"transparent",CONNECTION_OUTLINE_WIDTH:4,CONNECTION_HOVER_COLOR:"#6F6F6F",CONNECTION_ARROW_SIZE:10,NODE_TYPE_START:"start",NODE_TYPE_STOP:"stop",NODE_TYPE_DECISION:"decision",NODE_TYPE_DEADLINE:"deadline",NODE_TYPE_PARAMETER:"parameter",NODE_TYPE_RECIPIENT:"recipient",NODE_TYPE_ARCHIVE:"archive",NODE_TYPE_FORM:"form",NODE_TYPE_MAILING:"mailing",NODE_TYPE_OWN_WORKFLOW:"ownWorkflow",NODE_TYPE_SC_BIRTHDAY:"scBirthday",NODE_TYPE_SC_DOI:"scDOI",NODE_TYPE_SC_ABTEST:"scABTest",NODE_TYPE_BIRTHDAY_WITH_COUPON:"birthdayWithCoupon",NODE_TYPE_WELCOME_TRACK:"welcomeTrack",NODE_TYPE_WELCOME_TRACK_WITH_INCENTIVE:"welcomeTrackWithIncentive",NODE_TYPE_SHOPPING_CART_ABANDONERS_SMALL:"shoppingCartAbandonersSmall",NODE_TYPE_SHOPPING_CART_ABANDONERS_LARGE:"shoppingCartAbandonersLarge",NODE_TYPE_ANNIVERSARY_MAIL:"anniversaryMail",NODE_TYPE_ACTION_BASED_MAILING:"actionbased_mailing",NODE_TYPE_MAILING_MEDIATYPE_SMS:"mailing_mediatype_sms",NODE_TYPE_MAILING_MEDIATYPE_POST:"mailing_mediatype_post",NODE_TYPE_DATE_BASED_MAILING:"datebased_mailing",NODE_TYPE_FOLLOWUP_MAILING:"followup_mailing",NODE_TYPE_IMPORT:"import",NODE_TYPE_EXPORT:"export",NODE_TYPES_MAILING:["mailing","followup_mailing","actionbased_mailing","datebased_mailing","mailing_mediatype_sms","mailing_mediatype_post"],NODE_TYPES_IMPORT_EXPORT:["import","export"],NODE_TYPE_START_ID:0,NODE_TYPE_STOP_ID:1,NODE_TYPE_DECISION_ID:2,NODE_TYPE_DEADLINE_ID:3,NODE_TYPE_PARAMETER_ID:4,NODE_TYPE_RECIPIENT_ID:6,NODE_TYPE_ARCHIVE_ID:7,NODE_TYPE_FORM_ID:8,NODE_TYPE_MAILING_ID:9,NODE_TYPE_OWN_WORKFLOW_ID:10,NODE_TYPE_SC_BIRTHDAY_ID:11,NODE_TYPE_SC_DOI_ID:12,NODE_TYPE_SC_ABTEST_ID:13,NODE_TYPE_ACTION_BASED_MAILING_ID:14,NODE_TYPE_DATE_BASED_MAILING_ID:15,NODE_TYPE_FOLLOWUP_MAILING_ID:16,NODE_TYPE_IMPORT_ID:17,NODE_TYPE_EXPORT_ID:18,NODE_TYPE_MAILING_MEDIATYPE_SMS_ID:19,NODE_TYPE_MAILING_MEDIATYPE_POST_ID:20,MAILING_PARAM_MAILING_LIST:1,MAILING_PARAM_TARGET_GROUPS:2,MAILING_PARAM_ARCHIVE:3,MAILING_PARAM_LIST_SPLIT:4,MAILING_PARAM_PLANNED_DATE:5,MAILING_PARAM_SEND_DATE:6,MAILING_PARAM_ALTGS:7,DEPENDENCY_TYPE_ARCHIVE:1,DEPENDENCY_TYPE_AUTO_EXPORT:2,DEPENDENCY_TYPE_AUTO_IMPORT:3,DEPENDENCY_TYPE_MAILING_DELIVERY:4,DEPENDENCY_TYPE_MAILING_LINK:5,DEPENDENCY_TYPE_MAILING_REFERENCE:6,DEPENDENCY_TYPE_MAILINGLIST:7,DEPENDENCY_TYPE_PROFILE_FIELD:8,DEPENDENCY_TYPE_PROFILE_FIELD_HISTORY:9,DEPENDENCY_TYPE_TARGET_GROUP:11,DEPENDENCY_TYPE_USER_FORM:12,GENDER_PROFILE_FIELD:"gender",FIELD_TYPE_DATE:"date",SPLIT_DEFAULT_PARAMETERS:[5,10,15,20,25,30,33,40,50],TITLE_MAX_TARGETS:2,PDF_SIZE:"A4",PDF_ORIENTATION:"landscape",PAGE_DIMENSIONS:{A4:{width:800,height:1360}},ICONS_CONFIG:e,CONNECTION_CONSTRAINTS:t,NODE_POPOVER_TEMPLATE:'<div class="popover popover-wide" role="tooltip" ><div class="arrow"></div><div class="popover-content" style="width: auto; height: auto; max-width: 300px; max-height: 350px; overflow: auto;"></div></div>',EMPTY_OPTION_PLACEHOLDER:"--"}})();(function(){const n=AGN.Lib.WM.Definitions;const i=AGN.Lib.Helpers;const s=AGN.Lib.DateFormat;AGN.Lib.WM.Utils={checkActivation:function(e){var i=$("#workflow-status").val();if(n.constants.initialWorkflowStatus===n.constants.statusActive&&(i===n.constants.statusActive||i===n.constants.statusTesting)){if(e){AGN.Lib.Messages(t("workflow.defaults.error"),t("error.workflow.saveActivatedWorkflow"),"alert")}return true}else{return false}},isPausedWorkflow:function(){return $("#workflow-status").val()===n.constants.statusPaused},getConfigData:function(e){return i.objFromString(e.data("config"))},mapAsOptionsHtml:function(i){var n="";Object.keys(i).forEach(function(e){var t='value="'+e+'"';n+="<option "+t+">"+i[e]+"</option>"});return n},arrayAsOptionsHtml:function(e){var r="";e.forEach(function(e){var t='value="'+e.id+'"';var i=e.data;if(i){Object.keys(i).forEach(function(e){t+=" data-"+e+'="'+i[e].replace('"',"&quot;")+'"'})}var n=e.text.replace("<","&lt;").replace(">","&gt;");r+="<option "+t+">"+n+"</option>"});return r}};AGN.Lib.WM.DateTimeUtils={toDateTime:function(e,t,i){var n=null;if(!!e&&e.getMonth){n=new Date(e);if(!!t&&t!==0){n.setHours(t)}if(!!i&&i!==0){n.setMinutes(i)}}return n},getDateTimeValue:function(e,t,i){var n=this.toDateTime(e,t,i);return n!=null?n.getTime():null},getDateTimeStr:function(e,t,i,n){if(!e||!e.getMonth){return""}t=t||e.getHours();i=i||e.getMinutes();var r=this.toDateTime(e,t,i);if(!!r){return s.format(r,n)}else{return""}},getDateStr:function(e,t){return this.getDateTimeStr(e,null,null,t)},getCurrentAdminTime(){return $.ajax({url:AGN.url("/workflow/getCurrentAdminTime.action"),async:false}).responseJSON}}})();(function(){function e(e){this.rules=e}e.prototype.isConstraint=function(e){return _.isBoolean(e)||_.isFunction(e)};e.prototype.evaluate=function(e,t,i){if(e===true||e===false){return e}if(_.isFunction(e)){return e(t,i)}return undefined};e.prototype.getRulesToCheck=function(e,t){return[{from:e.type,to:[t.type,"*"]},{from:"*",to:[t.type,"*"]}]};e.prototype.getRelevantConstraints=function(e,t){var r=this.isConstraint;var i=this.getRulesToCheck(e,t);var s=this.rules;var o=[];i.forEach(function(t){var i=true;if(_.has(s,t.from)){var n=s[t.from];if(r(n)){o.push(n);i=false}else{t.to.forEach(function(e){if(_.has(s[t.from],e)){n=s[t.from][e];if(r(n)){o.push(n);i=false}}})}}if(i&&t.from!="*"){o.push(false)}});return o};e.prototype.check=function(e,t){var i=this.getRelevantConstraints(e,t);var n=false;for(var r=0;r<i.length;r++){if(this.evaluate(i[r],e,t)){n=true}else{return false}}return n};AGN.Lib.WM.ConnectionConstraints=e})();(function(){const t=AGN.Lib.Popover;class e{constructor(e){this.node=e;this.getMailingThumbnailWithCache=_.memoize(this.getMailingThumbnail.bind(this));this.#initPopover()}#initPopover(){this.getPopoverContent().then(e=>this.createPopover(e));this.setEnabled(true)}createPopover(e){if(!e){return}this.popover=t.getOrCreate(this.node.get$(),{trigger:"hover",html:true,content:e})}remove(){if(this.popover){this.popover.hide()}t.remove(this.node.get$());this.popover=null}update(){this.remove();this.#initPopover()}async getPopoverContent(){const e=await this.getThumbnail();const t=this.node.getComment();if(!e&&!t?.trim()){return null}return $("<div>").addClass("d-flex flex-column align-items-center").append(e).append($("<div>").text(t))}async getThumbnail(){const e=this.node.getData().mailingId;if(!this.node.isMailingNode()||!e){return""}return this.getMailingThumbnailWithCache(e)}async getMailingThumbnail(e){const t=await this.getMailingThumbnailSrc(e);if(!t){return""}const i=new Image;i.src=t;i.style.width="200px";return i}async getMailingThumbnailSrc(e){const t=await $.get(AGN.url(`/workflow/mailing/${e}/thumbnail.action`));return t>0?AGN.url("/sc?compID="+t):""}setEnabled(e){this.isEnabled=e;if(!this.popover){return}if(e){this.popover.enable()}else{this.popover.disable()}}}AGN.Lib.WM.NodePopover=e})();(()=>{const t=AGN.Lib.WM.DateTimeUtils;const i=AGN.Lib.Template;const l=AGN.Lib.WM.Definitions;const n=AGN.Lib.WM.NodePopover;class c{constructor(e,t){this.id=null;this.x=0;this.y=0;this.type=e;this.title="";this.overlayTitle="";this.filled=false;this.editable=true;this.expandable=false;this.dependent=false;this.inRecipientsChain=false;this.anchors=l.ICONS_CONFIG[e].anchors;this.data=t;this.$element=c.create$(e);this.$element.data("agn:node",this);this.$connectionButton=this.$element.find(".node-connect-button");this.$titleDiv=c.createTitleDiv$();this.$titleSpan=this.$titleDiv.find(".icon-title-span");this.$overlayTitle=this.$element.find(".icon-overlay-title");this.nodePopover=new n(this);this.lastTitleAnchor=l.BOTTOM}static restore(e){var t=e.get$().data("agn:node");if(!t){e.get$().data("agn:node",e)}return e}static get(e){if(e instanceof c){return e}if(e instanceof HTMLElement){e=$(e)}if(!e.is(".node")){e=e.closest(".node")}return e.data("agn:node")}static isDecisionNode(e){return e.getType()===l.NODE_TYPE_DECISION}isMailingNode(){return l.NODE_TYPES_MAILING.includes(this.getType())}static isMailingNode(e){if(!e){return false}return l.NODE_TYPES_MAILING.includes(e.getType())}static isBranchingDecisionNode(e){if(c.isDecisionNode(e)){var t=e.getData();if(t.decisionType===l.constants.decisionTypeDecision){return true}}return false}static isDecisionBranchesOrderFromPositiveToNegative(e,t,i){if(t.y<=e.y&&i.y<=e.y){if(t.y<i.y){return true}else if(i.y<t.y){return false}else{return t.x<i.x}}else if(t.y>e.y&&i.y>e.y){return t.x>i.x}else{return t.y<i.y}}static getDecisionBranches(e){if(e.length===2){var t=c.getPosition(e[0].source.get$());var i=c.getPosition(e[0].target.get$());var n=c.getPosition(e[1].target.get$());if(this.isDecisionBranchesOrderFromPositiveToNegative(t,i,n)){return{positive:e[0],negative:e[1]}}else{return{positive:e[1],negative:e[0]}}}return null}static isCommented(e){return!!_.trim(e.getComment())}static isSelected(e){return e.hasClass("ui-selected")}static setSelected(e,t){return e.toggleClass("ui-selected",!!t)}static isChainSource(e){return e.hasClass("chain-mode-source")}static setChainSource(e,t){e.toggleClass("chain-mode-source",!!t)}static getAnchors(e){var t=c.get(e);if(t){return t.getAnchors()}return l.ICONS_CONFIG[e.data("type")].anchors}static getAnchorsInUse(e){var i={};e.forEach(function(e){var t=e.anchor.getOrientation();if(t[0]>0){i[l.RIGHT]=true}else if(t[0]<0){i[l.LEFT]=true}else if(t[1]>0){i[l.BOTTOM]=true}else if(t[1]<0){i[l.TOP]=true}});return i}static getPosition(e){var t=e.position();return{x:t.left,y:t.top}}static getBox(e){var t=e.position();var i=e[0].getBoundingClientRect();return{minX:t.left,minY:t.top,maxX:t.left+i.width,maxY:t.top+i.height}}static isInRegion(e,t){var i=c.getBox(e);return(i.minX>=t.minX&&i.minX<=t.maxX||i.maxX>=t.minX&&i.maxX<=t.maxX)&&(i.minY>=t.minY&&i.minY<=t.maxY||i.maxY>=t.minY&&i.maxY<=t.maxY)}static getCollisionBox(e){var t=c.getAnchors(e);var i=e.position();var n=e[0].getBoundingClientRect();var r=(t[0][0]-l.NODE_MIN_MARGIN)*n.width;var s=(t[1][1]-l.NODE_MIN_MARGIN)*n.height;var o=(1-t[2][0]-l.NODE_MIN_MARGIN)*n.width;var a=(1-t[3][1]-l.NODE_MIN_MARGIN)*n.height;return{minX:i.left+r,minY:i.top+s,maxX:i.left+n.width-o,maxY:i.top+n.height-a}}static detectBoxCollision=function(e,t){return!(e.minX>t.maxX||e.maxX<t.minX||e.minY>t.maxY||e.maxY<t.minY)};static create$(e){if(["datebased_mailing","actionbased_mailing"].includes(e)){e="mailing"}return i.dom("workflow-node",{type:e})}static createDraggable$(e){return i.dom("workflow-draggable-node",{type:e})}static createTitleDiv$(){return i.dom("workflow-icon-title")}static create(e){var t={iconComment:""};var i=new c(e,t);switch(e){case l.NODE_TYPE_SC_ABTEST:case l.NODE_TYPE_SC_BIRTHDAY:case l.NODE_TYPE_SC_DOI:case l.NODE_TYPE_BIRTHDAY_WITH_COUPON:case l.NODE_TYPE_WELCOME_TRACK:case l.NODE_TYPE_WELCOME_TRACK_WITH_INCENTIVE:case l.NODE_TYPE_SHOPPING_CART_ABANDONERS_SMALL:case l.NODE_TYPE_SHOPPING_CART_ABANDONERS_LARGE:case l.NODE_TYPE_ANNIVERSARY_MAIL:i.setFilled(true);i.setExpandable(true);t.copyContent=true;t.created=false;break;case"ownWorkflow":i.setExpandable(true);t.ownWorkflowId=0;t.copyContent=true;t.created=false;break;case"start":t.startType=null;t.date=null;t.hour=0;t.minute=0;t.sendReminder=false;t.remindAdminId=0;t.remindAtOnce=false;t.scheduleReminder=false;t.remindSpecificDate=false;t.remindDate=new Date;t.remindHour=0;t.remindMinute=0;t.event=null;t.reaction=null;t.mailingId=0;t.profileField="";t.dateProfileField="";t.dateFieldOperator=1;t.dateFieldValue="";t.useRules=false;t.rules=[];t.executeOnce=true;t.comment="";t.recipients="";t.adminTimezone="";break;case"stop":t.endType=null;t.date=null;t.hour=0;t.minute=0;t.sendReminder=false;t.remindAdminId=0;t.remindAtOnce=false;t.scheduleReminder=false;t.remindSpecificDate=false;t.remindDate=new Date;t.remindHour=0;t.remindMinute=0;t.event=null;t.reaction=null;t.mailingId=0;t.profileField="";t.useRules=false;t.rules=[];t.executeOnce=true;t.comment="";t.recipients="";t.adminTimezone="";break;case"decision":t.decisionType=null;t.decisionCriteria=null;t.reaction=null;t.mailingId=0;t.linkId=0;t.profileField="";t.aoDecisionCriteria=null;t.threshold="";t.decisionDate=new Date;t.rules=[];t.includeVetoed=true;break;case"deadline":t.deadlineType=null;t.date=new Date;t.timeUnit=null;t.delayValue=0;t.hour=0;t.minute=0;t.useTime=false;break;case"parameter":t.value=0;break;case"recipient":i.setDependent(false);t.mailinglistId=0;t.targets=[];t.altgs=[];t.targetsOption=null;break;case"archive":t.campaignId=0;t.archived=false;break;case"form":t.userFormId=0;t.formType="form";break;case"mailing":t.mailingId=0;t.skipEmptyBlocks=false;t.doubleCheck=true;break;case"actionbased_mailing":case"datebased_mailing":case"mailing_mediatype_sms":case"mailing_mediatype_post":t.mailingId=0;break;case"followup_mailing":t.baseMailingId=0;t.mailingId=0;t.decisionCriterion="OPENED";break;case"import":case"export":t.importexportId=0;t.errorTolerant=false;break}return i}static isExpandableType(e){switch(e){case l.NODE_TYPE_SC_ABTEST:case l.NODE_TYPE_SC_BIRTHDAY:case l.NODE_TYPE_SC_DOI:case l.NODE_TYPE_BIRTHDAY_WITH_COUPON:case l.NODE_TYPE_WELCOME_TRACK:case l.NODE_TYPE_WELCOME_TRACK_WITH_INCENTIVE:case l.NODE_TYPE_SHOPPING_CART_ABANDONERS_SMALL:case l.NODE_TYPE_SHOPPING_CART_ABANDONERS_LARGE:case l.NODE_TYPE_ANNIVERSARY_MAIL:case l.NODE_TYPE_OWN_WORKFLOW:return true;default:return false}}static deserialize(e){var n=$.extend({},e);var t=new c(e.type,n);t.setId(e.id);t.setCoordinates(e.x,e.y);t.setTitle(e.iconTitle);t.setComment(e.iconComment);t.setFilled(e.filled);t.setEditable(e.editable);if([l.NODE_TYPE_OWN_WORKFLOW,l.NODE_TYPE_SC_BIRTHDAY,l.NODE_TYPE_SC_DOI,l.NODE_TYPE_SC_ABTEST,l.NODE_TYPE_BIRTHDAY_WITH_COUPON,l.NODE_TYPE_WELCOME_TRACK,l.NODE_TYPE_WELCOME_TRACK_WITH_INCENTIVE,l.NODE_TYPE_SHOPPING_CART_ABANDONERS_SMALL,l.NODE_TYPE_SHOPPING_CART_ABANDONERS_LARGE,l.NODE_TYPE_ANNIVERSARY_MAIL].includes(e.type)){t.setExpandable(true)}delete n["id"];delete n["x"];delete n["y"];delete n["type"];delete n["iconTitle"];delete n["filled"];delete n["editable"];["date","remindDate","decisionDate"].forEach(function(e){if(n[e]){var t=n[e].toString();if(t.includes("-")){var i=t.split("-");n[e]=new Date(i[0],i[1]-1,i[2])}else{n[e]=new Date(n[e])}}});return t}static deserializeConnections(e,n){var r=[];e.forEach(function(e){var i=n[e.id];if(i instanceof c){if(e.connections){e.connections.forEach(function(e){var t=n[e.targetIconId];if(t instanceof c){r.push({source:i,target:t})}})}}});return r}static toMap(e){var t={};e.forEach(function(e){t[e.getId()]=e});return t}appendTo(e,t,i){this.$container=e;this.$titlesContainer=t;if(i){this.$element.addClass(i)}e.append(this.$element);t.append(this.$titleDiv);this.$titleDiv.toggleClass("expandable",this.$titleSpan.height()>this.$titleDiv.height())}isAppended(){return!!this.$container}get $inUseBadge(){return this.$element.find(".node-status-badge")}toggleInUseBadge(){return this.$inUseBadge.toggle(l.sentMailings.includes(parseInt(this.data.mailingId)))}get$(){return this.$element}getId(){return this.id}setId(e){this.id=e;this.$element.prop("id",e)}getX(){return this.x}getY(){return this.y}getCoordinates(){return{x:this.x,y:this.y}}setCoordinates(e,t){this.x=e;this.y=t;this.$element.css("left",e*l.CANVAS_GRID_SIZE);this.$element.css("top",t*l.CANVAS_GRID_SIZE)}updateCoordinates(e){var t=c.getPosition(this.$element);this.x=t.x/e/l.CANVAS_GRID_SIZE;this.y=t.y/e/l.CANVAS_GRID_SIZE}getType(){return this.type}setType(e){this.type=e;this.$element.find(".node-image").replaceWith(i.dom("workflow-node-icon",{type:e}))}getTitle(){return this.title}setTitle(e){this.title=e;if(e){this.$titleSpan.text(e);this.positionTitle(this.lastTitleAnchor);this.$titleDiv.toggleClass("expandable",this.$titleSpan.height()>this.$titleDiv.height())}this.setTitleEnabled(!!e)}setTitleEnabled(e){this.$titleDiv.toggle(!!e&&!!this.title)}setTitleExpanded(e){this.$titleDiv.toggleClass("expanded",!!e);if(this.isAppended()){if(e){this.$titleDiv.appendTo(this.$container)}else{this.$titleDiv.appendTo(this.$titlesContainer)}}}positionTitle(e){this.lastTitleAnchor=e;var t=this.x*l.CANVAS_GRID_SIZE;var i=t+l.NODE_SIZE;var n=this.y*l.CANVAS_GRID_SIZE;var r=n+l.NODE_SIZE;switch(e){case l.BOTTOM:this.$titleDiv.css({top:r,left:t+(l.NODE_SIZE-l.TITLE_WIDTH)/2,transform:"none"});break;case l.LEFT:this.$titleDiv.css({top:(n+r)/2,left:t-l.TITLE_WIDTH,transform:"translateY(-50%)"});break;case l.RIGHT:this.$titleDiv.css({top:(n+r)/2,left:i,transform:"translateY(-50%)"});break;case l.TOP:this.$titleDiv.css({top:n,left:t+(l.NODE_SIZE-l.TITLE_WIDTH)/2,transform:"translateY(-100%)"});break;default:return}}getOverlayTitle(){return this.overlayTitle}setOverlayTitle(e){this.overlayTitle=e;this.$overlayTitle.text(_.trim(e))}getComment(){return this.comment}get $commentBtn(){return this.$element.find(".node-comment-button")}setComment(e){this.comment=this.data.iconComment=e;this.updateCommentLabels()}updateCommentLabels(){const e=!!_.trim(this.comment);this.$element.toggleClass("icon-commented",e);this.$commentBtn.toggle(e)}setFootnote(e){if(e>0){this.$element.attr("comment-footnote",e)}else{this.$element.removeAttr("comment-footnote")}}isFilled(){return this.filled}setFilled(e){this.filled=e;this.$element.toggleClass("active",e);if(e&&this.isMailingNode()){this.toggleInUseBadge()}}isEditable(){return this.editable}setEditable(e){this.editable=e}isExpandable(){return this.expandable}setExpandable(e){this.expandable=e}isDependent(){return this.dependent}setDependent(e){this.dependent=e}isInRecipientsChain(){return this.inRecipientsChain}setInRecipientsChain(e){this.inRecipientsChain=e}getAnchors(){return this.anchors}setAnchors(e){this.anchors=e}getData(){return this.data}setData(e){this.data=e}setInteractionEnabled(e){this.$connectionButton.toggle(!!e)}removePopover(){this.nodePopover.remove()}setPopoverEnabled(e){this.nodePopover.setEnabled(e)}setHovered(e){this.setTitleExpanded(e)}remove(){this.nodePopover.remove();this.$element.remove();this.$titleDiv.remove();this.$container=null;this.$titlesContainer=null}serialize(){var e=$.extend({},this.data,{id:this.id,x:this.x,y:this.y,type:this.type,filled:this.filled,editable:this.editable,iconTitle:this.title});if("date"in e&&"hour"in e&&"minute"in e){e.date=t.getDateTimeValue(e.date,e.hour,e.minute)}if("remindDate"in e&&"remindHour"in e&&"remindMinute"in e){e.remindDate=t.getDateTimeValue(e.remindDate,e.remindHour,e.remindMinute)}if("decisionDate"in e){e.decisionDate=t.getDateTimeValue(e.decisionDate)}return e}}AGN.Lib.WM.Node=c})();(function(){var n=AGN.Lib.WM.Node;function r(e){this.id=e.getId();this.node=e;this.position=n.getPosition(e.get$());this.box=n.getBox(e.get$());this.connections={incoming:[],outgoing:[]}}r.nodesToVertices=function(e){return e.map(function(e){return new r(e)})};r.verticesToMap=function(e){var t={};e.forEach(function(e){t[e.id]=e});return t};r.verticesFrom=function(e,t){var i=r.nodesToVertices(e);var n=r.verticesToMap(i);t.forEach(function(e){var t,i;if("sourceId"in e){t=n[e.sourceId];i=n[e.targetId]}else{t=n[e.source.getId()];i=n[e.target.getId()]}t.connections.outgoing.push(i);i.connections.incoming.push(t)});return i};r.compareByPosition=function(e,t){var i=e.box;var n=t.box;if(i.minX==n.minX){return i.minY-n.minY}return i.minX-n.minX};r.filterUnvisited=function(e,t){return e.filter(function(e){if(t[e.id]){return false}else{t[e.id]=true;return true}})};r.getDecisionBranches=function(t){var e=t.connections.outgoing.map(function(e){return{source:t.node,target:e.node,targetVertex:e}});var i=n.getDecisionBranches(e);if(i){return{positive:i.positive.targetVertex,negative:i.negative.targetVertex}}return null};r.getIncomingChains=function(e){var t={};var i=[];s([],e,t,i);return i};r.getOutgoingChains=function(e){var t={};var i=[];o([],e,t,i);return i};r.prototype.getNode=function(){return this.node};r.prototype.siblings=function(){return this.connections.incoming.concat(this.connections.outgoing)};r.prototype.rightSiblingsOrdered=function(){var e=this.connections.outgoing;if(n.isBranchingDecisionNode(this.node)){var t=r.getDecisionBranches(this);if(t){return[t.positive,t.negative]}}return e.sort(function(e,t){return e.node.getY()-t.node.getY()})};function s(t,e,i,n){if(i[e.id]){n.push(t)}else{t.push(e.node);var r=e.connections.incoming;if(r.length){i[e.id]=true;if(r.length==1){s(t,r[0],i,n)}else{r.forEach(function(e){s(t.slice(),e,i,n)})}i[e.id]=false}else{n.push(t)}}}function o(t,e,i,n){if(i[e.id]){n.push(t)}else{t.push(e.node);var r=e.connections.outgoing;if(r.length){i[e.id]=true;if(r.length==1){o(t,r[0],i,n)}else{r.forEach(function(e){o(t.slice(),e,i,n)})}i[e.id]=false}else{n.push(t)}}}AGN.Lib.WM.Vertex=r})();(function(){var r=AGN.Lib.WM.Vertex;function s(e){this.vertices=e;this.box=e.map(function(e){return e.box}).reduce(function(e,t){return{minX:Math.min(e.minX,t.minX),minY:Math.min(e.minY,t.minY),maxX:Math.max(e.maxX,t.maxX),maxY:Math.max(e.maxY,t.maxY)}})}s.detectGroups=function(e){var i=[];var n={};e.forEach(function(e){var t=s.detectGroup(e,n);if(t){i.push(t)}});return i.sort(s.compareByPosition)};s.detectGroup=function(e,t){if(t[e.id]){return null}var i=[];var n=e.siblings();i.push(e);t[e.id]=true;while(n.length){n=_.flatMap(n,function(e){if(t[e.id]){return[]}else{i.push(e);t[e.id]=true;return e.siblings()}})}return new s(i)};s.compareByPosition=function(e,t){var i=e.box.minX+e.box.maxX-(t.box.minX+t.box.maxX);if(i==0){return e.box.minY+e.box.maxY-(t.box.minY+t.box.maxY)}return i};s.prototype.getNodes=function(){return this.vertices.map(function(e){return e.getNode()})};s.prototype.getStartingVertices=function(){var e=this.vertices.filter(function(e){return e.connections.incoming.length==0});if(e.length){return e.sort(r.compareByPosition)}var t=this.vertices.reduce(function(e,t){var i=e.connections.outgoing.length/e.connections.incoming.length;var n=t.connections.outgoing.length/t.connections.incoming.length;if(i==n){return r.compareByPosition(e,t)>=0?e:t}return i>n?e:t});return[t]};AGN.Lib.WM.VertexGroup=s})();(function(){var o=AGN.Lib.WM.Definitions,n=AGN.Lib.WM.DateTimeUtils;var r={};var a=function(){};function i(t,e,i){if(e<=0){return""}if(_.isEmpty(r[t])){$.ajax({url:AGN.url(i),async:false}).done(function(e){r[t]=_.extend({},e)})}var n=r[t][e];return!!n?n:""}a.addArchiveName=function(e,t){r["archive"][e]=t};a.getWebFormName=function(e){return i("form",e,"/workflow/ajax/getWebFormNames.action")};a.getTargetName=function(e){return i("target",e,"/workflow/ajax/getTargetNames.action")};a.getMailingName=function(e){return i("mailing",e,"/workflow/ajax/getMailingNames.action")};a.getArchiveName=function(e){return i("archive",e,"/workflow/ajax/getArchiveNames.action")};a.getAutoExportName=function(e){return i("autoExport",e,"/workflow/ajax/getAutoExportNames.action")};a.getAutoImportName=function(e){return i("autoImport",e,"/workflow/ajax/getAutoImportNames.action")};a.getMailinglistName=function(e){return i("mailinglist",e,"/workflow/ajax/getMailinglistNames.action")};function s(e){switch(e){case o.constants.reactionOpened:return t("workflow.reaction.opened");case o.constants.reactionNotOpened:return t("workflow.reaction.not_opened");case o.constants.reactionClicked:return t("workflow.reaction.clicked");case o.constants.reactionNotClicked:return t("workflow.reaction.not_clicked");case o.constants.reactionBought:return t("workflow.reaction.bought");case o.constants.reactionNotBought:return t("workflow.reaction.not_bought");case o.constants.reactionChangeOfProfile:return t("workflow.reaction.change_of_profile");case o.constants.reactionWaitingForConfirm:return t("workflow.reaction.waiting_for_confirm");case o.constants.reactionOptIn:return t("workflow.reaction.opt_in");case o.constants.reactionOptOut:return t("workflow.reaction.opt_out");case o.constants.reactionClickedLink:return t("workflow.reaction.clicked_on_link");case o.constants.reactionOpenedAndClicked:return t("workflow.reaction.opened_and_clicked");case o.constants.reactionOpenedOrClicked:return t("workflow.reaction.opened_or_clicked")}}function l(e,i){if(e>1){switch(i){case o.constants.deadlineTimeUnitMinute:return t("workflow.deadline.minutes");case o.constants.deadlineTimeUnitHour:return t("workflow.defaults.hours");case o.constants.deadlineTimeUnitDay:return t("workflow.defaults.days");case o.constants.deadlineTimeUnitWeek:return t("workflow.defaults.weeks");case o.constants.deadlineTimeUnitMonth:return t("workflow.defaults.months")}}else{switch(i){case o.constants.deadlineTimeUnitMinute:return t("workflow.deadline.minute");case o.constants.deadlineTimeUnitHour:return t("workflow.defaults.hour");case o.constants.deadlineTimeUnitDay:return t("workflow.defaults.day");case o.constants.deadlineTimeUnitWeek:return t("workflow.defaults.week");case o.constants.deadlineTimeUnitMonth:return t("workflow.defaults.month")}}}function c(e){switch(e){case o.constants.decisionAOCriteriaClickRate:return t("workflow.defaults.ckickrate");case o.constants.decisionAOCriteriaOpenrate:return t("workflow.opening_rate");default:return t("workflow.statistic.revenue")}}function u(e){switch(Number(e)){case 1:return")";case 0:return""}}function d(e){switch(Number(e)){case 1:return"(";case 0:return""}}function h(e,t){if(e&&o.GENDER_PROFILE_FIELD===e.toLowerCase()){return o.constants.genderOptions[!t?0:t]}else{return _.isEmpty(t)?"":t}}function p(i,e){var n="";e.forEach(function(e){n+=(_.isEmpty(n)?"":" "+e.chainOperator+" ")+d(e.parenthesisOpened)+i+" "+o.constants.operatorsMap[e.primaryOperator]+" "+h(i,e.primaryValue)+u(e.parenthesisClosed)});return t("workflow.start.rule")+(!!n?": "+n:"")}function f(e,i){var n=[];for(var r=0;r<o.TITLE_MAX_TARGETS&&r<e.length;r++){n.push(a.getTargetName(e[r]))}var s=", ";if(o.constants.targetOptions[i]){s=" "+o.constants.targetOptions[i]+" "}if(e.length>o.TITLE_MAX_TARGETS){return n.join(s)+" "+t("defaults.andMore",e.length-o.TITLE_MAX_TARGETS)+"..."}else{return n.join(s)}}function g(e,t,i){if(e){if(arguments.length===1){return n.getDateStr(e,o.constants.localeDateTimePattern)}else{return n.getDateTimeStr(e,t,i,o.constants.localeDateTimePattern)}}else{return""}}function m(e,t){return e+" "+l(e,t)}function v(e,i){return t("workflow.reaction.title")+": "+s(e)+",\n"+t("workflow.defaults.mailing")+": "+a.getMailingName(i)}function y(e,i,n){var r=c(e)+(_.isEmpty(i)?"":": "+i)+"\n";if(!!n){r+=t("workflow.defaults.date")+": "+g(n)}return r}function b(e,t,i){return e+" "+o.constants.operatorsMap[t]+(!i?"":" "+i)}function C(e,t,i){if(e){if(t){return t+" ("+s(i)+") "+e}else{return e}}}function w(e,i,n,r){var s="";if(r){s+=t("workflow.mailinglist.short")+": "+a.getMailinglistName(e)}if(!_.isEmpty(i)){if(!_.isEmpty(s)){s+="\n"}s+=t("workflow.target.short")+": "+f(i,n)}return s}a.positionTitle=function(e,t){if(t[o.BOTTOM]){if(t[o.LEFT]){if(t[o.RIGHT]){if(t[o.TOP]){e.positionTitle(o.BOTTOM)}else{e.positionTitle(o.TOP)}}else{e.positionTitle(o.RIGHT)}}else{e.positionTitle(o.LEFT)}}else{e.positionTitle(o.BOTTOM)}};var e=function(e){var i=e.startType;var n="";if(o.constants.startTypeDate===i){n=t("workflow.start.start_date")+":\n"+g(e.date,e.hour,e.minute)}else if(o.constants.startTypeEvent===i){var r=e.event;if(o.constants.startEventReaction===r){n=t("workflow.start.start_event")+":\n"+s(e.reaction)+": ("+g(e.date,e.hour,e.minute)+")"}else if(o.constants.startEventDate===r){n=t("workflow.start.start_event")+":\n"+b(e.dateProfileField,e.dateFieldOperator,e.dateFieldValue)+":\n"+"("+g(e.date,e.hour,e.minute)+")"}}return n};var A=function(e,i,n){var r=e.endType;var s="";if(o.constants.endTypeDate===r){s=t("workflow.stop.end_date")+":\n"+g(e.date,e.hour,e.minute)}else if(o.constants.endTypeAutomatic===r){s=n?t("workflow.stop.automatic_end"):t("workflow.stop.open_end")}return s};var E=function(e){var i=e.deadlineType;var n="";if(o.constants.deadlineTypeFixedDeadline===i){n=t("workflow.deadline.title")+":\n"+g(e.date,e.hour,e.minute)}else if(o.constants.deadlineTypeDelay===i){n=t("workflow.defaults.delay")+":\n"+m(e.delayValue,e.timeUnit)}return n};var S=function(e){var i=e.decisionType;var n="";if(o.constants.decisionTypeAutoOptimization===i){n=t("workflow.mailing.autooptimization")+":\n"+y(e.aoDecisionCriteria,e.threshold,e.decisionDate)}else{if(o.constants.decisionReaction===e.decisionCriteria){n=t("workflow.decision")+",\n"+v(e.reaction,e.mailingId)}else{n=t("workflow.decision")+",\n"+p(e.profileField,e.rules)}}return n};var T=function(e,t){var i,n;var r=t.title;i=a.getMailingName(e.baseMailingId)||"?";n=a.getMailingName(e.mailingId)||"?";var s=C(n,i,e.decisionCriterion);if(s){r=s}return r};var x={title:function(e){return a.getMailingName(e.mailingId)}};var D={"*":{overlayTitle:"",title:""},start:{title:e},stop:{title:A},deadline:{title:E},parameter:{title:"",overlayTitle:function(e){return e.value}},decision:{title:S,branches:{title:function(){return{positive:t("workflow.defaults.yes"),negative:t("workflow.defaults.no")}}}},recipient:{title:function(e,t){return w(e.mailinglistId,e.targets,e.targetsOption,!t.isInRecipientsChain())}},archive:{title:function(e){return a.getArchiveName(e.campaignId)}},form:{title:function(e){return a.getWebFormName(e.userFormId)}},mailing:x,mailing_mediatype_sms:x,mailing_mediatype_post:x,actionbased_mailing:x,datebased_mailing:x,followup_mailing:{title:T},import:{title:function(e){return a.getAutoImportName(e.importexportId)}},export:{title:function(e){return a.getAutoExportName(e.importexportId)}}};function R(e){var t=e.getType();if(o.NODE_TYPES_MAILING.includes(t)||o.NODE_TYPES_IMPORT_EXPORT.includes(t)){return!!e.title}return false}a.getDecisionBranchesLabels=function(){return D.decision.branches.title()};a.updateTitle=function(e,t,i){if(!i&&R(e)){return}if(!e.isFilled()){e.setTitle("");e.setOverlayTitle("");return}e.setTitle(N(e,t));e.setOverlayTitle(M(e))};function M(e){return O(e.getType(),"overlayTitle",e.getData())}function N(e,t){return O(e.getType(),"title",e.getData(),e,t)}function O(e,t){var i=D[e];if(!i.hasOwnProperty(t)){i=D["*"]}var n=i[t];var r=Array.prototype.slice.call(arguments,2);return _.isFunction(n)?n.apply(i,r):n}AGN.Lib.WM.NodeTitleHelper=a})();(function(){const n=AGN.Lib.WM.Node;const l=AGN.Lib.WM.Definitions;const r=50;class s{constructor(e,t){this.minimap=e;this.$element=e.$container.find(t);this.scale=1}setScale(e){this.scale=e}getScale(){return this.scale}getPosition(){var e=this.$element.position();return{x:e.left,y:e.top}}update(){this.reset();var e=this.minimap.getPureIconsBox();var t=l.MINIMAP_PADDING*2;var i=e.maxX-e.minX+t;var n=e.maxY-e.minY+t;var r=(this.minimap.getWidth()-t)/i;var s=(this.minimap.getHeight()-t)/n;this.setScale(Math.min(r,s));var o=-e.minX*this.scale+l.MINIMAP_PADDING;var a=-e.minY*this.scale+l.MINIMAP_PADDING;this.$element.css({transform:"scale("+this.scale+")",width:i,height:n,left:o,top:a});this.renderIcons()}renderIcons(){var i=this;this.minimap.getPureIconsPosition().forEach(function(e){var t=$('<div class="miniview-element"></div>').css({width:l.NODE_SIZE,height:l.NODE_SIZE,left:e.x,top:e.y});i.$element.append(t)})}reset(){this.scale=1;this.$element.css({transform:"scale(1)",width:0,height:0,left:0,top:0});this.$element.html("")}}class o{constructor(e,t,i){this.minimap=e;this.$element=e.get$().find(t);this.onDrag=_.isFunction(i.onPannerDrag)?i.onPannerDrag:_.noop;this.containment=$.extend({mode:"",padding:0},i.containment);this.containmentBox=null;var a=this;var l=0;var c=0;this.$element.draggable({start:function(e,t){l=t.position.left;c=t.position.top;if(!a.containmentBox){a.containmentBox=a.getContainmentBox(a.containment)}},drag:function(e,t){var i=a.getScale();if(a.containmentBox){var n=t.position.left;var r=t.position.top;if(n<a.containmentBox.minX){t.position.left=a.containmentBox.minX}else if(n>a.containmentBox.maxX){t.position.left=a.containmentBox.maxX}if(r<a.containmentBox.minY){t.position.top=a.containmentBox.minY}else if(r>a.containmentBox.maxY){t.position.top=a.containmentBox.maxY}}var s=(l-t.position.left)/i;var o=(c-t.position.top)/i;l=t.position.left;c=t.position.top;a.onDrag.call(a,s,o)}})}getContainmentBox(e){if(!e.mode||e.mode=="none"){return undefined}var t=this.minimap.get$();var i=this.getScaledWidth();var n=this.getScaledHeight();if(e.mode=="panner-box"){return{minX:-i+e.padding,maxX:t.width()-e.padding,minY:-n+e.padding,maxY:t.height()-e.padding}}else if(e.mode=="minimap-box"){return{minX:e.padding,maxX:Math.max(0,t.width()-i)-e.padding,minY:e.padding,maxY:Math.max(0,t.height()-n)-e.padding}}return undefined}getScale(){return this.minimap.getMiniCanvasScale()/this.minimap.getCanvasZoom()}getScaledWidth(){return this.getWidth()*this.getScale()}getScaledHeight(){return this.getHeight()*this.getScale()}getWidth(){return this.$element.width()}getHeight(){return this.$element.height()}update(){var e=this.minimap.getCanvasParent$();var t=e.width();var i=e.height();var n=t+l.MINIMAP_PADDING*2;var r=i+l.MINIMAP_PADDING*2;this.$element.css({width:n,height:r});this.containmentBox=this.getContainmentBox(this.containment);this.updatePosition()}updatePosition(){var e=this.minimap.getCanvasPosition();var t=this.minimap.getMiniCanvasPosition();var i=this.getScale();var n=-e.x*i+t.x;var r=-e.y*i+t.y;this.$element.css({transform:"scale("+i+")",left:n,top:r})}}class e{constructor(e,t){this.$container=$("#minimap");this.canvas=e;this.miniCanvas=new s(this,".minimap-canvas",t);this.miniPanner=new o(this,".minimap-panner",t);this.enabled=false;const i=this.$container.find(".minimap-collapse");const n=$("#collapsed-navigator");this.$container.on("click",".minimap-panner, .minimap-collapse, .minimap-arrow",e=>e.preventFocusOnArea=true);i.on("click",()=>this.toggleMinimap(false));n.on("click",()=>this.toggleMinimap(true));this.$container.on("click",e=>this.moveToClickPos(e));this.$container.find(".minimap-arrow").on("click",e=>{const t=$(e.currentTarget).data("arrow");const i=this.#getStepPos(t);this.moveCanvasTo(i.x,i.y)})}#getStepPos(e){const{x:t,y:i}=this.canvas.getPosition();switch(e){case"up":return{x:t,y:i+r};case"right":return{x:t-r,y:i};case"down":return{x:t,y:i-r};case"left":return{x:t+r,y:i}}}moveToClickPos(e){if(e.preventFocusOnArea){return}const t=this.$container[0].getBoundingClientRect();const i=e.clientX-t.left;const n=e.clientY-t.top;this.focusOnClickedArea(i,n)}get$(){return this.$container}getWidth(){return this.get$().width()}getHeight(){return this.get$().height()}moveCanvasTo(e,t){this.canvas.moveTo(e,t)}getCanvas$(){return this.canvas.get$()}getCanvasParent$(){return this.canvas.get$().parent()}focusOnClickedArea(e,t){var i=this.getMiniCanvasPosition();var n=this.getMiniPannerScale();var r=(e-i.x)/n;var s=(t-i.y)/n;var o=this.getMiniPannerCenter();var a=this.getCanvasZoom();var l=(r-o.x)*a;var c=(s-o.y)*a;this.moveCanvasTo(-l,-c)}toggleMinimap(e){$("#navigator").toggle(e);$("#collapsed-navigator").toggle(!e)}getIcons(){return this.canvas.getIcons()}getPureIconsPosition(){var i=this.getCanvasZoom();return this.getIcons().map(function(e){var t=n.getPosition(e);return{x:t.x/i,y:t.y/i}})}getPureIconsBox(){return this.canvas.getPureIconsBox()}getMiniCanvasScale(){return this.miniCanvas.getScale()}getMiniCanvasPosition(){return this.miniCanvas.getPosition()}getMiniPannerScale(){return this.miniCanvas.getScale()}getMiniPannerCenter(){return{x:this.miniPanner.getWidth()/2,y:this.miniPanner.getHeight()/2}}getCanvasZoom(){return this.canvas.getZoom()}getCanvasPosition(){return this.canvas.getPosition()}updateMinimap(){if(this.enabled){this.miniCanvas.update();this.miniPanner.update()}}onPanZoom(){if(this.enabled){this.miniPanner.updatePosition()}}setEnabled(e){this.enabled=e;if(e){this.updateMinimap();this.get$().show()}else{this.get$().hide()}}}AGN.Lib.WM.Minimap=e})();(function(){const f=AGN.Lib.WM.Definitions;const r=AGN.Lib.WM.Node;const t=AGN.Lib.WM.Minimap;class e{constructor(e){const n=this;this.$canvas=e;this.mouseWheelZoomEnabled=false;this.panningEnabled=false;this.zoomEventHandler=null;this.moveEventHandler=null;this.ignoreNextZoomEvent=false;this.minimap=new t(this,{containment:{mode:"panner-box",padding:5},onPannerDrag:function(e,t){if(e||t){var i=n.getPosition();n.moveTo(i.x+e,i.y+t)}}});this.panzoom=panzoom(e[0],{minZoom:f.MIN_ZOOM,maxZoom:f.MAX_ZOOM,initialZoom:f.DEFAULT_ZOOM,disableKeyboardInteraction:true,smoothScroll:false,onDoubleClick:()=>false,beforeWheel:()=>!n.mouseWheelZoomEnabled,beforeMouseDown:e=>e.button!==f.MOUSE_BUTTON_MIDDLE});this.panzoom.on("zoom",function(){if(n.zoomEventHandler){if(n.ignoreNextZoomEvent){n.ignoreNextZoomEvent=false}else{n.zoomEventHandler.call(null,n.getZoom());n.minimap.onPanZoom()}}});this.panzoom.on("pan",function(){n.minimap.onPanZoom();if(n.moveEventHandler){n.moveEventHandler.call(null,n.getPosition())}})}get$(){return this.$canvas}setMinimapEnabled(e){this.minimap.setEnabled(e)}updateMinimap(){this.minimap.updateMinimap()}setPanningEnabled(e){this.panningEnabled=!!e}setMouseWheelZoomEnabled(e){this.mouseWheelZoomEnabled=e}getZoom(){var e=this.panzoom.getTransform();return e.scale}getPosition(){var e=this.panzoom.getTransform();return{x:e.x,y:e.y}}getVisibleArea(){var e=this.$canvas.parent();var t=e.width();var i=e.height();var n=this.panzoom.getTransform();return{minX:-n.x/n.scale,minY:-n.y/n.scale,maxX:(t-n.x)/n.scale,maxY:(i-n.y)/n.scale}}moveTo(e,t){this.panzoom.moveTo(e,t)}setZoom(e){var t=this.panzoom.getTransform();this.ignoreNextZoomEvent=true;this.panzoom.zoomAbs(t.x,t.y,e);this.minimap.onPanZoom()}setOnZoom(e){this.zoomEventHandler=e}setOnMove(e){this.moveEventHandler=e}getCanvasParent$(){return this.get$().parent()}getIcons(){var i=[];this.get$().children(".node").each(function(e,t){i.push($(t))});return i}getPureIconsBox(){var e=this.getIcons();var t=this.getZoom();if(e.length){var i=e.map(function(e){return r.getBox(e)}).reduce(function(e,t,i){return{minX:Math.min(e.minX,t.minX),minY:Math.min(e.minY,t.minY),maxX:Math.max(e.maxX,t.maxX),maxY:Math.max(e.maxY,t.maxY)}});return{minX:i.minX/t-f.CANVAS_GRID_SIZE,minY:i.minY/t-f.CANVAS_GRID_SIZE,maxX:i.maxX/t+f.CANVAS_GRID_SIZE,maxY:i.maxY/t+f.CANVAS_GRID_SIZE}}else{var n=this.getCanvasParent$();return{minX:-f.CANVAS_GRID_SIZE,minY:-f.CANVAS_GRID_SIZE,maxX:n.width()/t+f.CANVAS_GRID_SIZE,maxY:n.height()/t+f.CANVAS_GRID_SIZE}}}fitPdfPage(e,t){var i=this.getPureIconsBox();var n=i.maxX-i.minX+f.NODE_MIN_MARGIN;var r=i.maxY-i.minY+f.NODE_MIN_MARGIN;if(!f.PAGE_DIMENSIONS[e]){return}var s=f.PAGE_DIMENSIONS[e];var o=t=="landscape";var a=o?s.height:s.width;var l=o?s.width:s.height;var c=0;var u=0;var d=1;if(n>a||r>l){if(n/r<a/l){d=l/r}else{d=a/n}}if(i.minX<0){c=-i.minX*d}if(i.minY<0){u=-i.minY*d}var h="matrix("+d+", 0, 0, "+d+", "+c+", "+u+")";var p="left top 0";this.getCanvasParent$().css({transform:h,"-webkit-transform":h,"transform-origin":p,"-webkit-transform-origin":p,"backface-visibility":"hidden","-webkit-backface-visibility":"hidden",overflow:"visible"})}}AGN.Lib.WM.Canvas=e})();(function(){const i=AGN.Lib.WM.Definitions;const r=AGN.Lib.Confirm;const e={Activation:n,Deactivation:c,confirmTestingStartStop:p,confirmMailingDataTransfer:u,confirmOwnWorkflowExpanding:d,createAutoOpt:h,confirmCopy:f,connectionNotAllowed:g,createMailing:v,mailingInUseDialog:l,simpleDialog:m};function n(e,t){const i=r.createFromTemplate({rows:e.length},"activate-campaign-dialog");if(!t){s(e)}return i}function s(e){const t=o();const i=a();new AGN.Lib.Table($("#activate-modal .table-wrapper"),t,e,i)}function o(){return[{field:"name",headerName:t("defaults.name"),filter:false,suppressMovable:true,sortable:true,sort:"asc",resizable:false,cellRenderer:"NotEscapedStringCellRenderer"}]}function a(){return{pagination:false,singleNameTable:true,showRecordsCount:"simple"}}function l(e){const i=t("workflow.mailing.copyQuestion");const n=`${t("workflow.button.copy")} ${t("workflow.defaults.and")} ${t("workflow.defaults.edit").toLowerCase()}`;return m(e,i,n)}function c(){const e=t("workflow.inactivating.title");const i=t("workflow.inactivating.question");return m(e,i)}function u(e){return r.from("mailing-data-transfer-modal",{Def:i,paramsToAsk:e})}function d(){return r.from("own-workflow-expanding-modal")}function h(){return r.from("create-auto-opt-modal")}function p(e){return r.from("testing-modal",{startTesting:e,shortname:i.shortname})}function f(e){return r.from("workflow-copy-modal",{hasContent:e===true})}function g(){const e=t("workflow.dialog.connectionNotAllowedTitle");const i=t("workflow.dialog.connectionNotAllowedMessage");return m(e,i)}function m(e,i,n=t("defaults.ok")){return r.from("workflow-simple-dialog-modal",{title:e,message:i,btnText:n})}function v(){return r.from("create-mailing-modal")}AGN.Lib.WM.Dialogs=e})();(function(){var a=AGN.Lib.WM.Definitions,r=AGN.Lib.WM.Node;var e={};e.loadSample=function(e,t,i){if([a.NODE_TYPE_SC_ABTEST,a.NODE_TYPE_SC_DOI,a.NODE_TYPE_ANNIVERSARY_MAIL,a.NODE_TYPE_SC_BIRTHDAY,a.NODE_TYPE_BIRTHDAY_WITH_COUPON,a.NODE_TYPE_WELCOME_TRACK,a.NODE_TYPE_WELCOME_TRACK_WITH_INCENTIVE,a.NODE_TYPE_SHOPPING_CART_ABANDONERS_SMALL,a.NODE_TYPE_SHOPPING_CART_ABANDONERS_LARGE].includes(e)){$.ajax({url:AGN.url("/workflow/getSampleWorkflowContent.action"),async:false,data:{type:e,gridEnabled:t},success:n(i)})}else{console.error("Unknown sample type: "+e)}};e.loadAutoOptSample=function(e,t,i){$.get(AGN.url("/workflow/autoOptWorkflowSample.action"),{mailingsCount:e,gridEnabled:t}).done(n(i))};e.loadOwnWorkflow=function(e,t,i){$.ajax({url:AGN.url("/workflow/getWorkflowContent.action"),async:false,data:{workflowId:e,isWithContent:t},success:n(i)})};e.removeStartStop=function(e,t,i,n){if(i||n){var r=[];var s=e.filter(function(e){var t=e.getType();if(i&&t===a.NODE_TYPE_START||n&&t===a.NODE_TYPE_STOP){r.push(e);return false}else{return true}});if(s.length<e.length){Array.prototype.splice.apply(e,[0,e.length].concat(s));var o=t.filter(function(e){return!(r.includes(e.source)||r.includes(e.target))});if(o.length<t.length){Array.prototype.splice.apply(t,[0,t.length].concat(o))}}}};e.adjustPositions=function(e,t,i,n){var r=0,s=0;if(n){var o=h(e);r=o.getX();s=o.getY()}else{var a=0,l=0,c=0,u=0;var d=true;e.forEach(function(e){if(d){a=l=e.getX();c=u=e.getY();d=false}else{a=Math.min(a,e.getX());l=Math.max(l,e.getX());c=Math.min(c,e.getY());u=Math.max(u,e.getY())}});r=Math.round((a+l)/2);s=Math.round((c+u)/2)}e.forEach(function(e){e.setCoordinates(t+e.getX()-r,i+e.getY()-s)})};function n(n){return function(e){var t=e.map(r.deserialize);var i=r.deserializeConnections(e,r.toMap(t));n.call(null,t,i)}}function h(e){var t=e.filter(function(e){return a.NODE_TYPE_START==e.getType()});if(t.length==0){t=e}if(t.length>1){return t.reduce(function(e,t){if(e.getX()==t.getX()){return e.getY()<t.getY()?e:t}else{return e.getX()<t.getX()?e:t}})}else{return t[0]}}AGN.Lib.WM.Snippets=e})();(()=>{const l=AGN.Lib.WM.Definitions;const t=AGN.Lib.WM.Node;const e=".js-draggable-button";function i(o){this.enabled=!!o.enabled;this.$buttons=$(e);const a=this;this.$buttons.each(function(){const e=$(this);e.draggable({revert:true,revertDuration:0,zIndex:l.Z_INDEX_DRAGGABLE_BUTTON,disabled:!a.enabled,cursorAt:function(){const e=this.helper[0].getBoundingClientRect();return[e.width/2-1,e.height/2]},appendTo:"#canvas",helper:function(){return t.createDraggable$(e.data("type"))},start:function(){o.onStart.call(a,e.data("type"))},stop:function(){o.onStop.call(a)},drag:function(e,t){const i=o.getZoom.call(a);t.position.left=Math.round(t.position.left/i/l.CANVAS_GRID_SIZE)*l.CANVAS_GRID_SIZE;t.position.top=Math.round(t.position.top/i/l.CANVAS_GRID_SIZE)*l.CANVAS_GRID_SIZE;o.onDrag.call(a,t.helper)}}).on("dblclick",function(){if(a.enabled){o.onDrop.call(a,null,e.data("type"))}})});$("#viewPort").droppable({accept:e,tolerance:"fit",drop:function(e,t){const i=o.getZoom.call(a);const n=$("#canvas").offset();const r=Math.round((t.offset.left-n.left)/i);const s=Math.round((t.offset.top-n.top)/i);o.onDrop.call(a,t.helper,t.helper.data("type"),{x:Math.round(r/l.CANVAS_GRID_SIZE),y:Math.round(s/l.CANVAS_GRID_SIZE)})}})}i.prototype.setEnabled=function(e){this.enabled=!!e;this.$buttons.draggable("option","disabled",!e)};i.prototype.changeType=function(e,t){this.$buttons.filter(function(){return $(this).data("type")===e}).data("type",t)};AGN.Lib.WM.DraggableButtons=i})();(function(){var o=AGN.Lib.WM.Definitions,s=AGN.Lib.WM.Vertex,r=AGN.Lib.WM.VertexGroup;function a(e,t){this.layers=e;this.height=t}a.fromVertexGroup=function(e){var t=[];var i={};var n=s.filterUnvisited(e.getStartingVertices(),i);var r=0;while(n.length){r=Math.max(r,n.length);t.push(n);n=_.flatMap(n,function(e){return s.filterUnvisited(e.rightSiblingsOrdered(),i)})}return new a(t,r)};a.prototype.align=function(n,r){var s=null;this.layers.forEach(function(e){var t=Math.max(Math.round(o.AUTO_ALIGN_STEP_Y*(r-e.length)/2),1);if(s){var i=Math.abs(s.length-e.length);if(i>1){n+=Math.round(o.AUTO_ALIGN_EXTRA_STEP_X*i)}}e.forEach(function(e){e.node.setCoordinates(n,t);t+=o.AUTO_ALIGN_STEP_Y});n+=o.AUTO_ALIGN_STEP_X;s=e});return n};function e(e){var t=r.detectGroups(e).map(function(e){return a.fromVertexGroup(e)});var i=0;t.forEach(function(e){i=Math.max(i,e.height)});var n=1;t.forEach(function(e){n=e.align(n,i);n+=o.AUTO_ALIGN_STEP_BETWEEN_GROUPS})}AGN.Lib.WM.AutoAlignment={align:e}})();(()=>{const i=AGN.Lib.WM.Definitions;const n=AGN.Lib.WM.Node;class r{constructor(e){this.maxLength=e;this._undoStack=[];this._transactionStack=[];this._transaction=false}add(e){while(this._undoStack.length>=this.maxLength){this._undoStack.shift()}this._undoStack.push(e)}pop(){return this._undoStack.pop().reverse()}addOperation(e){this._transactionStack.push(e)}isEmpty(){return _.isEmpty(this._undoStack)}startTransaction(){this._transaction=true}endTransaction(){this.flush();this._transaction=false}flush(){if(!_.isEmpty(this._transactionStack)){this.add(this._transactionStack)}this._transactionStack=[]}isTransactionStarted(){return this._transaction===true}}class e{constructor(e,t){this.editor=e;this.undoOperations={nodeAdded:this.undoAddNode,nodeDeleted:this.undoDeleteNode,nodeMoved:this.undoMoveNode,nodeDataUpdated:this.undoSaveNodeData,connectionCreated:this.undoCreateConnection,connectionDeleted:this.undoDeleteConnection};this.manualStart=false;this.undoStack=new r(i.MAX_UNDO_STEP);this.onChange=_.isFunction(t.onChange)?t.onChange:_.noop}undoAddNode(e){this.editor.deleteNode(e)}undoDeleteNode(e){if(e instanceof n){this.editor.add(n.restore(e))}else{this.editor.add(n.get(e))}}undoCreateConnection(e){this.editor.deleteConnectionBetween(e.source,e.target)}undoDeleteConnection(e){this.editor.connect(n.get(e.source),n.get(e.target))}undoMoveNode(e){const n=this.editor.getZoom();const r=this;e.forEach(function(e){e.node.setTitleEnabled(false)});this.editor.batch(function(){e.forEach(function(e){var t=e.coordinates;var i=e.node;if(r.editor.getCurrentDragMode()!==e.dragMode){r.editor.convertCoordinates(t)}i.setCoordinates(t.x,t.y);i.updateCoordinates(n)});r.editor.updateOverlays();r.editor.positionTitles();r.editor.updateMinimap()});e.forEach(function(e){e.node.setTitleEnabled(true)})}undoSaveNodeData(e,t){t=t instanceof n?t:n.get(t);e=e instanceof n?e:n.get(e);e.setTitle(t.title);e.setOverlayTitle(t.getOverlayTitle());e.setComment(t.getComment());e.setDependent(t.isDependent());e.setInRecipientsChain(t.isInRecipientsChain());e.setData(t.getData());e.setFilled(t.isFilled());this.editor.positionTitles();e.nodePopover.update()}canUndo(){return!this.undoStack.isEmpty()}startTransaction(){this.manualStart=true;this.undoStack.startTransaction()}endTransaction(){this.undoStack.endTransaction();this.onChange();this.manualStart=false}transaction(e){if(_.isFunction(e)){if(!this.undoStack.isTransactionStarted()){this.manualStart=false;this.undoStack.startTransaction()}e.call();if(!this.manualStart){this.undoStack.endTransaction()}this.onChange()}}operation(e){if(this.undoStack.isTransactionStarted()){var t=[].slice.call(arguments);t.shift();this.undoStack.addOperation({operation:e,args:t})}}undo(){if(this.canUndo()){const e=this.undoStack.pop().sort((e,t)=>{const i=e.operation;const n=t.operation;if(i==="nodeDeleted"&&n!=="nodeDeleted"){return-1}if(i!=="nodeDeleted"&&n==="nodeDeleted"){return 1}return 0});this.editor.batch(()=>{e.forEach(e=>{const t=this.undoOperations[e.operation];t?.apply(this,e.args)})});this.onChange()}}}AGN.Lib.WM.UndoManager=e})();(function(){const n=AGN.Lib.WM.Definitions;const t=AGN.Lib.WM.Utils;const e=AGN.Lib.WM.Node;const i=AGN.Lib.Select;var r=function(){var o={};this.editors=[];this.curEditor;this.curEditingNode;this.getCurrentNodeId=function(){return this.curEditingNode.getId()};this.getCurrentNodeAnchorsInUse=function(){if(o.getNodeAnchorsInUse){return o.getNodeAnchorsInUse(this.curEditingNode)}return{}};this.getCurrentEditor=function(){return this.curEditor};this.assignOptions=function(e){$.extend(o,e)};this.registerEditor=function(e,t){return this.editors[e]=t};this._notAllowedToChangeDuringPause=function(e){return t.isPausedWorkflow()&&!_.union(n.NODE_TYPES_MAILING,[n.NODE_TYPE_STOP]).includes(e.getType())};this.hideNodeEditors=function(){$('#node-editor > [id$="-editor"]').hide()};this.activeNodeIcon=function(e){$(".node").removeClass("under-edit");e.$element.addClass("under-edit")};this.toggleSelectNodeInfoMsg=function(e){$("#select-node-notification").toggle(e)};this.exitNodeEditorIfActive=function(e){if(this.curEditingNode!==e){return}this.hideNodeEditors();this.toggleSelectNodeInfoMsg(true)};this.showEditDialog=function(e){const t=e.getType();this.curEditingNode=e;this.curEditor=this.editors[t];this.curEditor.fillEditor(e);this.activeNodeIcon(e);this.toggleSelectNodeInfoMsg(false);this.hideNodeEditors();const i=this.getEditorPanel(t);AGN.runAll(i.find("form"));$("#node-editor").scrollTop(0);i.show();if(t===n.NODE_TYPE_RECIPIENT){i.parent().find(".recipient-editor-select").prop("disabled",e.isDependent()||e.isInRecipientsChain())}if(this.isReadOnlyMode()){s(i)}if(this.curEditor.saveOnOpen&&!this.isReadOnlyMode()){this.curEditor.save()}};this.isReadOnlyMode=function(){return t.checkActivation(!e.isMailingNode(this.curEditingNode))||this._notAllowedToChangeDuringPause(this.curEditingNode)};this.showIconCommentDialog=function(e){const t=this;this.curEditingNode=e;this.curEditor=this.editors["icon-comment"];this.curEditor.fillEditor(e);this.getEditorPanel("icon-comment").dialog({open:function(){t.getEditorPanel("icon-comment").parent().find(".ui-dialog-titlebar").hide()},width:300,height:"auto",minHeight:"auto",modal:true,resizable:false,fluid:true,position:{my:"left top",at:"left bottom",of:e.get$()}})};this.saveIconComment=function(e){const t=this.curEditingNode;o.getUndoManager().transaction(function(){o.getUndoManager().operation("nodeDataUpdated",t,_.cloneDeep(t));t.setComment(e);o.onChange(t)});t.nodePopover?.update()};this.saveCurrentEditorWithUndo=function(e){_.defer(()=>{o.getUndoManager().startTransaction();this.saveCurrentEditor(e,()=>o.getUndoManager().endTransaction())})};this.saveCurrentEditor=function(t,i){i=_.isFunction(i)?i:_.noop;var n=this;var e=this.curEditingNode;o.getUndoManager().operation("nodeDataUpdated",e,_.cloneDeep(e),n.curEditor);var r=n.curEditor.saveEditor();if(n.isNodeIsMailing(e)){var s=r.mailingId;if(t){t.checkDifferentMailingLists(s,function(e){n.mailingSpecificSave(e,r,t);i()},function(e){n.curEditor.storedMailingContent=e;n.curEditor.storedMailingId=s;n.curEditor.storedEditorData=r;t.initOneMailinglistWarningDialog(t);i()})}}else{$.extend(e.getData(),r);if(!e.isFilled()){e.setFilled(true)}if(e.isFilled()&&_.isFunction(n.curEditor.isSetFilledAllowed)){if(!n.curEditor.isSetFilledAllowed()){e.setFilled(false)}}if(o.supplement){o.supplement(e)}if(o.onChange){o.onChange(e)}i()}};this.resave=function(e){var t=this.curEditingNode;var i=this.curEditor;try{this.curEditingNode=e;this.curEditor=this.editors[e.getType()];this.curEditor.fillEditor(e);this.saveCurrentEditor()}finally{this.curEditingNode=t;this.curEditor=i}};this.modify=function(e,t){o.getUndoManager().operation("nodeDataUpdated",e,_.cloneDeep(e));t(e);if(o.onChange){o.onChange(e)}};this.isNodeIsMailing=function(e){return n.NODE_TYPES_MAILING.includes(e.getType())};this.mailingSpecificSave=function(e,t,i){const n=this.curEditingNode;const r=n.getData();$.extend(r,t);if(n.isFilled()&&_.isFunction(this.curEditor.isSetFilledAllowed)){if(!this.curEditor.isSetFilledAllowed()){n.setFilled(false)}}if(o.supplement){o.supplement(n,i,e)}if(o.onChange){o.onChange(n)}n.nodePopover.update();n.toggleInUseBadge()};this.mailingSpecificSaveAfterMailinglistCheckModal=function(e){this.curEditor.storedMailingContent.mailinglistId=e.configuredMailingData.mailinglistId;this.mailingSpecificSave(this.curEditor.storedMailingContent,this.curEditor.storedEditorData,e)};this.getEditorPanel=function(e){const t=e==="stop"?"start":e;return $(`#${t}-editor`)};this.formToObject=function(e){var t=$('form[name="'+e+'"]').serializeArray();var n={};$.each(t,function(){if(this.name.indexOf("[")!=-1){var e=this.name.substring(0,this.name.indexOf("["));if(n[e]==undefined){n[e]=[]}var t=this.name.substring(this.name.indexOf("[")+1,this.name.indexOf("]"));if(n[e][t]==undefined){n[e][t]={}}if(this.name.indexOf(".")!=-1){var i=this.name.substring(this.name.indexOf(".")+1);n[e][t][i]=this.value}else{n[e][t]=this.value}}else{n[this.name]=this.value||""}});$('form[name="'+e+'"] [type="checkbox"]').each(function(){n[this.name]=$(this).prop("checked")});return n};this.fillFormFromObject=function(e,t,i,n){if(typeof t==="string"){this.fillFormFromObjectItem(e,i,i,t||n)}else{for(var r in t){if(t.hasOwnProperty(r)){var s=t[r];if(!s&&n&&n[r]){s=n[r]}this.fillFormFromObjectItem(e,i,r,s)}}}};this.fillFormFromObjectItem=function(e,t,i,n){if(Object.prototype.toString.call(n)==="[object Array]"){for(var r=0;r<n.length;r++){this.fillFormFromObject(e,n[r],i+"["+r+"]"+".")}}else{var s=$('form[name="'+e+'"] [name="'+t+i+'"]');var o=s.attr("type");switch(o){case"checkbox":s.prop("checked",Boolean(n));break;case"radio":s.filter('[value="'+n+'"]').prop("checked",true);break;default:var a=s.prop("tagName");switch(a){case"SELECT":s.val(n);this.initSelectWithValueOrChooseFirst(s,n);break;default:s.val(n)}}}};this.processForward=function(e,t,i,n){var r=[];r.push("nodeId="+this.curEditingNode.getId());r.push("elementId="+encodeURIComponent(t));if(!!n){r.push(n)}const s={forwardName:e,forwardParams:r.join(";")};if(this.curEditor.safeToSave){this.saveCurrentEditor()}i(false,s)};this.getFirstOptionValue=function(e){return i.get(e).getFirstValue()};this.resetSelect=function(e){i.get(e).clear()};this.initSelectWithFirstValue=function(e){i.get(e).selectFirstValue()};this.initSelectWithValueOrChooseFirst=function(e,t){i.get(e).selectValueOrSelectFirst(t)};this.getNodesByTypes=function(e){if(o.getNodesByTypes){return o.getNodesByTypes(e)}return[]};this.getNodesByType=function(e){return this.getNodesByTypes([e])};this.getNodesByIncomingConnections=function(e){if(o.getNodesByIncomingConnections){return o.getNodesByIncomingConnections(e)}return[]};this.getNodesByOutgoingConnections=function(e){if(o.getNodesByOutgoingConnections){return o.getNodesByOutgoingConnections(e)}return[]};this.getFirstIncomingChain=function(){if(this.curEditingNode&&o.getFirstIncomingChain){return o.getFirstIncomingChain(this.curEditingNode)}return[]};this.forEachPreviousNode=function(t){var i=this;if(this.curEditingNode&&o.forEachPreviousNode){return o.forEachPreviousNode(this.curEditingNode,function(e){return t.call(i,e)})}return[]};this.deleteNode=function(e){if(o.deleteNodeById){o.deleteNodeById(e)}};this.openNode=function(e,t){if(o.editNode){o.editNode(e,t)}}};function s(e){e.find(".disable-for-active").each((e,t)=>$(t).attr("disabled",true));e.find(".hide-for-active").each((e,t)=>$(t).hide());e.find(':input:enabled[type!="hidden"]').not(":button, .select2, .js-select, .js-datepicker").each((e,t)=>{$(t).attr(["radio","checkbox"].includes($(t).prop("type"))?"disabled":"readonly",true)});e.find(":input:enabled.select2, .select2 .btn, :input:enabled.js-select, select").not(".disabled, :disabled").each(function(e,t){if($(t).prop("type")==="text"||$(t).is("input, select")){$(t).attr("disabled",true)}else{$(t).prop("disabled",true)}});e.find(".js-datepicker").each(function(e,t){$(t).attr("disabled",true)})}AGN.Lib.WM.EditorsHelper=new r})();(function(){const w=AGN.Lib.WM.Definitions;const h=AGN.Lib.WM.Node;const p=AGN.Lib.WM.EditorsHelper;const f=AGN.Lib.WM.Utils;const _=AGN.Lib.Messages;const A=AGN.Lib.WM.Dialogs;const E=AGN.Lib.Select;const e=function(e,s){this.MAILING_TYPE_ACTIONBASED=1;this.MAILING_TYPE_DATEBASED=2;this.MAILING_TYPE_FOLLOWUP=3;this.node={};this.mailingsStatus="all";this.defaultMailingsSort=e.defaultMailingsSort;this.defaultMailingsOrder=e.defaultMailingsOrder;this.mailingsSort=this.defaultMailingsSort;this.mailingsOrder=this.defaultMailingsOrder;this.formNameJId='form[name="'+e.form+'"]';this.containerId=e.container;this.mailingType=parseInt(e.mailingType);this.mediaType=e.mediaType;this.mediatypes=e.mediatypes;this.mailingTypesForLoading=e.mailingTypesForLoading;this.statusName=e.mailingStatus;this.selectName=e.selectName;this.selectNameJId="select[name="+e.selectName+"]";this.mailingId=0;this.prevMailingId=0;this.showCreateEditLinks=e.showCreateEditLinks;this.$dropdown=null;if(e.$dropdown){this.$dropdown=e.$dropdown}this.isChangeDecisionOptions=e.isFollowUpBaseMailing;this.followUpContainer=e.followUpContainer;this.advertisingAdditionalOptions=e.advertisingAdditionalOptions;this.nodesChain=[];this.mailingData={};this.configuredMailingData=null;var c=this;this.fillEditorBase=function(e){this.node=e;if(f.checkActivation()){this.mailingsStatus="all"}else{this.mailingsStatus=$(this.formNameJId).find("input[checked=checked]").val()||"all"}this.mailingsSort=this.defaultMailingsSort;this.mailingsOrder=this.defaultMailingsOrder;this.cleanOptions();this.hideSendSettings();this.changeDecisionOptionsSet($(this.containerId),this.isChangeDecisionOptions)};this.cleanOptions=function(){$(this.containerId+" #"+this.statusName+"_all").attr("checked","checked");this.activateInputs();this.setSelectMailingOptions(this.node.data[this.selectName]);this.getMailingsByWorkStatus(this.mailingsStatus,this.mailingsSort,this.mailingsOrder,this.node.data.mailingId)};this.onMailingsStatusChange=function(e){this.setSelectMailingOptions(0);this.getMailingsByWorkStatus(e,this.mailingsSort,this.mailingsOrder);this.changeDecisionOptionsSet($(this.containerId),this.isChangeDecisionOptions)};this.onMailingSelectChange=function(e){this.setSelectMailingOptions(e);this.changeDecisionOptionsSet($(this.containerId),this.isChangeDecisionOptions)};this.changeDecisionOptionsSet=function(e,t){if(t){var i=this.mailingId;var n=$(e.find(this.followUpContainer));var r=this.advertisingAdditionalOptions;$(n.find(".advertisingOption")).remove();if(i){$.ajax({type:"POST",url:AGN.url("/mailing/ajax/"+i+"/isAdvertisingContentType.action")}).done(function(e){if(e&&e.success){var t=AGN.Lib.Template.text("followupAdvertisingOptions",{items:r});n.append(t)}})}}};this.setMailingId=function(e){this.prevMailingId=this.mailingId;this.mailingId=e;if(this.$dropdown){if(this.mailingId>0){this.$dropdown.show()}else{this.$dropdown.hide()}}};this.setSelectMailingOptions=function(e){this.setMailingId(e);if(this.showCreateEditLinks){this.setMailingLinks(e)}};this.setMailingLinks=function(e){const t=$(this.getMailingLink(e));t.addClass("btn btn-icon btn-primary");$(this.containerId+" #mailing_create_edit_link").html(t)};this.getMailingLink=function(e){if(!e||e==="0"){return'<a href="#" data-action="mailing-editor-new"><i class="icon icon-plus"></i></a>'}if(!f.checkActivation()){return'<a href="#" data-action="mailing-editor-edit"><i class="icon icon-pen"></i></a>'}return`<a href="${AGN.url("/mailing/"+e+"/settings.action")}"><i class="icon icon-pen"></i></a>`};this.showSecurityQuestion=function(){this.setSecurityQuestion();this.setIsUsedInCMAttr();if(this.isSentMailing(this.mailingIsSent)||this.mailingIsUsedInCM){const e=this.getSelectedMailingOption();A.mailingInUseDialog(e.html()).then(()=>p.getCurrentEditor().copyMailing()).fail(()=>{this.mailingId=this.prevMailingId||0;this.mailingSelect().selectValue(this.prevMailingId)});const t=$(".modal");const i=AGN.Lib.Confirm.get(t);t.on("modal:close",()=>i.negative());return false}return true};this.isSentMailing=function(e){return e=="mailing.status.sent"||e=="mailing.status.scheduled"||e=="mailing.status.norecipients"};this.getMailingsByWorkStatus=function(i,e,n,r){const s=this;const o=this.$mailingSelect();const a=E.get(o);a.setReadonly(true);$.ajax({url:AGN.url("/workflow/getMailingsByWorkStatus.action"),data:{mailingTypes:this.mailingTypesForLoading.join(","),mediatypes:this.mediatypes?this.mediatypes.join(","):"",status:i,sort:e,order:n},success:function(e){a.resetOptions();a.addOption(0,t("workflow.defaults.no_mailing"));e.forEach(function(e){const t=$("<option></option>",{value:e.MAILING_ID,text:e.SHORTNAME,selected:r==e.MAILING_ID});if(s.isSentMailing(e.WORK_STATUS)){t.css("color","#808080")}t.attr({status:e.WORK_STATUS,senddate:e.SENDDATE});t.data({status:e.WORK_STATUS,"send-date":e.SENDDATE,"dependent-campaigns":e.USEDINWORKFLOWS||""});o.append(t)});a.setReadonly(false);s.mailingsStatus=i;p.initSelectWithValueOrChooseFirst(o,s.mailingId)}})};this.disableInputs=function(){$(this.containerId+' [name="'+this.statusName+'"]').attr("disabled","disabled")};this.activateInputs=function(){$(this.containerId+' [name="'+this.statusName+'"]').removeAttr("disabled")};this.setNodeFields=function(){this.node.setFilled(parseInt(this.mailingId,10)>0)};this.setSecurityQuestion=function(){var e=this.getSelectedMailingOption();this.mailingIsSent="";if(parseInt(this.mailingId,10)>0){this.mailingIsSent=e.data("status")}};this.setIsUsedInCMAttr=function(){var e=this.getSelectedMailingOption();var t=e.data("dependent-campaigns");var i=e.val();this.mailingIsUsedInCM=false;if(parseInt(this.mailingId,10)>0&&i==this.mailingId&&t){var n=w.workflowId||0;if(t>0){if(n>0){this.mailingIsUsedInCM=n!==t}else{this.mailingIsUsedInCM=true}}}};this.getSelectedMailingOption=function(){return $(this.formNameJId+" "+this.selectNameJId+" option[value="+this.mailingId+"]")};this.getSelectedDecisionOption=function(){var e="decisionCriterion";var t=$(this.formNameJId+' select[name="'+e+'"]').val();return $(this.formNameJId+' select[name="'+e+'"] option[value='+t+"]")};this.createNewMailing=function(){if(!i(this.node)){_.warn("error.workflow.notAddedMailingList");return}if([w.NODE_TYPE_MAILING_MEDIATYPE_POST,w.NODE_TYPE_MAILING_MEDIATYPE_SMS].includes(this.node.type)){this.openSelectTemplateToCreateMailingView(w.constants.forwards.MAILING_CREATE_STANDARD.url)}else{A.createMailing().done(e=>this.openSelectTemplateToCreateMailingView(e))}};this.openSelectTemplateToCreateMailingView=function(e){return $.get(AGN.url(e),{workflowId:w.workflowId,workflowForwardParams:this._getCreateMailingForwardParams()}).done(e=>AGN.Lib.Page.render(e))};function i(e){let t=0;p.curEditingNode=e;p.forEachPreviousNode(function(e){if(e.type===w.NODE_TYPE_RECIPIENT){t=e.data.mailinglistId;return false}});return t>0}this._getCreateMailingForwardParams=function(){const e=this.formNameJId+" "+this.selectNameJId;const t={nodeId:p.curEditingNode.getId(),elementId:encodeURIComponent(e),mailingType:this.mailingType};if(this.mediaType){t.mediaType=this.mediaType}if(this.mailingType===this.MAILING_TYPE_FOLLOWUP){t.workflowFollowUpParentMailing=this.node.data.baseMailingId;t.workflowFollowUpDecisionCriterion=this.node.data.decisionCriterion}if(p.curEditor.safeToSave){p.saveCurrentEditor()}return Object.entries(t).map(([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`).join(";")};this.processCopyAndEditMailingForward=function(e,t,i,n){$("#forwardTargetItemId").val(e);const r=["mailingType="+c.mailingType];if(this.mailingType===this.MAILING_TYPE_FOLLOWUP){r.push("workflowFollowUpParentMailing="+this.node.data.baseMailingId);r.push("workflowFollowUpDecisionCriterion="+this.node.data.decisionCriterion)}if(r.length>0){p.processForward(t,i+" "+n,s,r.join(";"))}else{p.processForward(t,i+" "+n,s)}};this.editMailing=function(e){this.processCopyAndEditMailingForward(this.mailingId,e,this.formNameJId,this.selectNameJId)};this.copyMailing=function(e){this.processCopyAndEditMailingForward(this.mailingId,e,this.formNameJId,this.selectNameJId)};this.trySupplementChain=function(e,t,i){if(e.length>0){this.configuredMailingData=o(e);this.nodesChain=e;this.mailingData=t;var n=u(c,true);if(n.length){A.confirmMailingDataTransfer(n).done(function(e){c.transferMailingData(e);c.supplementChain(i)}).fail(function(){c.transferMailingData();c.supplementChain(i)})}else{c.supplementChain(i)}}};this.checkDifferentMailingLists=function(e,r,s){$.get(AGN.url(`/workflow/mailing/${e}/info.action`)).done(e=>{var t=p.getFirstIncomingChain();this.configuredMailingData=o(t);this.nodesChain=t;this.mailingData=e;const i=t.filter(e=>e.getType()===w.NODE_TYPE_MAILING).length;const n=this.configuredMailingData.mailinglistId;if(i>1&&n!=0&&n!=e.mailinglistId){s(e)}else{r(e)}})};var o=function(e){var t={parameterValue:0,campaignId:0,mailinglistId:0,targets:[],date:null};for(var i=e.length-1;i>=0;i--){var n=e[i];var r=n.getData();switch(n.getType()){case w.NODE_TYPE_PARAMETER:t.parameterValue=r.value;break;case w.NODE_TYPE_ARCHIVE:t.campaignId=r.campaignId;break;case w.NODE_TYPE_RECIPIENT:if(t.mailinglistId==0){t.mailinglistId=r.mailinglistId}if(r.targets!==null){r.targets.forEach(function(e){if(!t.targets.includes(e)){t.targets.push(parseInt(e))}})}break;case w.NODE_TYPE_START:if(r.date){t.date=y(r.date);t.date.setHours(r.hour);t.date.setMinutes(r.minute)}else{t.date=null}break;case w.NODE_TYPE_DEADLINE:if(r.deadlineType==w.constants.deadlineTypeFixedDeadline){if(r.date){t.date=y(r.date);t.date.setHours(r.hour);t.date.setMinutes(r.minute)}else{t.date=null}}else if(r.deadlineType==w.constants.deadlineTypeDelay){if(t.date!=null){if(r.timeUnit==w.constants.deadlineTimeUnitMinute){t.date.setMinutes(t.date.getMinutes()+parseInt(r.delayValue))}else if(r.timeUnit==w.constants.deadlineTimeUnitHour){t.date.setHours(t.date.getHours()+parseInt(r.delayValue))}else if(r.timeUnit==w.constants.deadlineTimeUnitDay){t.date.setDate(t.date.getDate()+parseInt(r.delayValue));if(r.useTime||r.useTime=="true"){t.date.setMinutes(t.date.getMinutes()+parseInt(r.minute));t.date.setHours(t.date.getHours()+parseInt(r.hour))}}}}break}}return t};var u=function(e,t){var i=e.configuredMailingData;var n=e.mailingData;var r=[];var s=[];var o=[];if(n.mailinglistId==0){o.push(w.MAILING_PARAM_MAILING_LIST)}else{if(i.mailinglistId==0){r.push(w.MAILING_PARAM_MAILING_LIST)}else{if(i.mailinglistId!=n.mailinglistId){if(t){s.push(w.MAILING_PARAM_MAILING_LIST)}else{r.push(w.MAILING_PARAM_MAILING_LIST)}}}}var a=i.targets;var l=n.targetGroupIds;if(l==null||l.length==0){o.push(w.MAILING_PARAM_TARGET_GROUPS)}else{if(a==null||a.length==0){r.push(w.MAILING_PARAM_TARGET_GROUPS)}else{if(!b(i,n)){if(t){s.push(w.MAILING_PARAM_TARGET_GROUPS)}else{r.push(w.MAILING_PARAM_TARGET_GROUPS)}}}}if(w.constants.isAltgExtended){var c=i.altgs;var u=n.altgIds;if(u==null||u.length==0){o.push(w.MAILING_PARAM_ALTGS)}else{if(c==null||c.length==0){r.push(w.MAILING_PARAM_ALTGS)}else{if(!C(i,n)){if(t){s.push(w.MAILING_PARAM_TARGET_GROUPS)}else{r.push(w.MAILING_PARAM_TARGET_GROUPS)}}}}}var d=e.getParameterValue(n.splitBase,n.splitPart);if(d==null){o.push(w.MAILING_PARAM_LIST_SPLIT)}else{if(i.parameterValue==0){r.push(w.MAILING_PARAM_LIST_SPLIT)}else{if(i.parameterValue!=d){if(t){s.push(w.MAILING_PARAM_LIST_SPLIT)}else{r.push(w.MAILING_PARAM_LIST_SPLIT)}}}}if(n.campaignId==0){o.push(w.MAILING_PARAM_ARCHIVE)}else{if(i.campaignId==0){r.push(w.MAILING_PARAM_ARCHIVE)}else{if(i.campaignId!=n.campaignId){if(t){s.push(w.MAILING_PARAM_ARCHIVE)}else{r.push(w.MAILING_PARAM_ARCHIVE)}}}}var h=i.date;var p=v(n);var f=m(n);if(p==null&&f==null){o.push(w.MAILING_PARAM_PLANNED_DATE)}else{if(h==null){if(p!=null){r.push(w.MAILING_PARAM_PLANNED_DATE)}else{r.push(w.MAILING_PARAM_SEND_DATE)}}else{if(y(p)>y(h)){if(t){s.push(w.MAILING_PARAM_PLANNED_DATE)}else{r.push(w.MAILING_PARAM_PLANNED_DATE)}}else if(p&&y(p)<y(h)){o.push(w.MAILING_PARAM_PLANNED_DATE)}if(f>h){if(t){s.push(w.MAILING_PARAM_SEND_DATE)}else{r.push(w.MAILING_PARAM_SEND_DATE)}}else if(f&&f<h){o.push(w.MAILING_PARAM_SEND_DATE)}}}g(e,o);return t?s:r};var g=function(e,t){var i=e.configuredMailingData;var n=e.mailingData;for(var r=0;r<t.length;r++){switch(t[r]){case w.MAILING_PARAM_MAILING_LIST:n.mailinglistId=i.mailinglistId;break;case w.MAILING_PARAM_TARGET_GROUPS:n.targetGroupIds=i.targets;break;case w.MAILING_PARAM_ALTGS:n.altgIds=i.altgs;break;case w.MAILING_PARAM_ARCHIVE:n.campaignId=i.campaignId;break;case w.MAILING_PARAM_LIST_SPLIT:n.splitBase="";n.splitPart="";break;case w.MAILING_PARAM_PLANNED_DATE:var s=y(i.date);if(s){n.planDate=s.getTime()}else{n.planDate=0}break;case w.MAILING_PARAM_SEND_DATE:n.sendDate=y(i.date);if(i.date){n.sendHour=i.date.getHours();n.sendMinute=i.date.getMinutes()}break}}};this.transferMailingData=function(e){if(e){g(c,e)}else{g(c,u(c,true))}};this.supplementChain=function(e){var n=u(this,false);var r=this.mailingData;var s=this.configuredMailingData;var t=this.nodesChain;var i=false;var o=false;for(var a=1;a<t.length;a++){if(w.NODE_TYPES_MAILING.includes(t[a].getType())){t.splice(a+1);o=true;break}}if(!o){if(n.includes(w.MAILING_PARAM_PLANNED_DATE)||n.includes(w.MAILING_PARAM_SEND_DATE)){if(w.NODE_TYPE_START==t[t.length-1].getType()){i=true}else{var l=p.getNodesByType(w.NODE_TYPE_START);if(l.length==0&&r.mailingType!==this.MAILING_TYPE_ACTIONBASED&&r.mailingType!==this.MAILING_TYPE_DATEBASED){i=true}}if(i){this.supplementSingleNode(w.NODE_TYPE_START,function(e){var t=e.getData();if(n.includes(w.MAILING_PARAM_PLANNED_DATE)){t.date=v(r);var i=s.date;if(i){t.hour=i.getHours();t.minute=i.getMinutes()}p.resave(e)}else if(n.includes(w.MAILING_PARAM_SEND_DATE)){t.date=m(r);t.hour=t.date.getHours();t.minute=t.date.getMinutes()}})}}}if(n.includes(w.MAILING_PARAM_LIST_SPLIT)){this.supplementSingleNode(w.NODE_TYPE_PARAMETER,function(e){var t=e.getData();t.value=c.getParameterValue(r.splitBase,r.splitPart)})}if(n.includes(w.MAILING_PARAM_ARCHIVE)){this.supplementSingleNode(w.NODE_TYPE_ARCHIVE,function(e){var t=e.getData();t.campaignId=r.campaignId})}if(n.includes(w.MAILING_PARAM_MAILING_LIST)||n.includes(w.MAILING_PARAM_TARGET_GROUPS)){this.supplementSingleNode(w.NODE_TYPE_RECIPIENT,function(e){var t=e.getData();if(n.includes(w.MAILING_PARAM_MAILING_LIST)){t.mailinglistId=r.mailinglistId;e.setDependent(true)}if(n.includes(w.MAILING_PARAM_TARGET_GROUPS)){t.targets=r.targetGroupIds;if(w.constants.isAltgExtended){t.targetsOption="ONE_TARGET_REQUIRED"}else{t.targetsOption=w.constants.accessLimitTargetId>0?"ALL_TARGETS_REQUIRED":"ONE_TARGET_REQUIRED"}}if(w.constants.isAltgExtended){if(n.includes(w.MAILING_PARAM_ALTGS)){t.altgs=r.altgIds}}})}if(!i&&(n.includes(w.MAILING_PARAM_PLANNED_DATE)||n.includes(w.MAILING_PARAM_SEND_DATE))){this.supplementSingleNode(w.NODE_TYPE_DEADLINE,function(e){var t=e.getData();if(n.includes(w.MAILING_PARAM_PLANNED_DATE)){t.date=v(r);var i=s.date;if(i){t.date.setHours(i.getHours());t.date.setMinutes(i.getMinutes())}}else if(n.includes(w.MAILING_PARAM_SEND_DATE)){t.date=m(r)}t.deadlineType=w.constants.deadlineTypeFixedDeadline;t.hour=t.date.getHours();t.minute=t.date.getMinutes()})}e(t)};this.supplementSingleNode=function(e,t){var i;switch(e){case w.NODE_TYPE_START:i=false;break;case w.NODE_TYPE_PARAMETER:i=[];break;case w.NODE_TYPE_ARCHIVE:i=[w.NODE_TYPE_PARAMETER];break;case w.NODE_TYPE_RECIPIENT:i=[w.NODE_TYPE_PARAMETER,w.NODE_TYPE_ARCHIVE];break;case w.NODE_TYPE_DEADLINE:i=[w.NODE_TYPE_PARAMETER,w.NODE_TYPE_ARCHIVE,w.NODE_TYPE_RECIPIENT];break;default:console.error("Unexpected supplement node type: "+e);return}if(!n(e,t)){r(e,i,t)}};var n=function(e,t){var i=c.nodesChain;for(var n=1;n<i.length;n++){var r=i[n];if(e==r.getType()){t(r);p.resave(r);return true}}return false};var r=function(e,t,i){var n=c.nodesChain;var r=h.create(e);i(r);if(t===false){n.push(r)}else{for(var s=1;s<n.length;s++){var o=n[s];if(!t.includes(o.getType())){n.splice(s,0,r);return}}n.push(r)}};this.acceptOneMailinglistPerCampaign=function(){p.mailingSpecificSaveAfterMailinglistCheckModal(c)};this.$mailingSelect=function(){return $(this.formNameJId+" "+this.selectNameJId)};this.mailingSelect=function(){return E.get(this.$mailingSelect())};this.validateEditor=function(e){var t=false;if($(this.containerId+" .delivery-settings").length){var i=$(this.containerId+' [name="maxRecipients"]').val();if(parseInt(i)!=i){_.warn("error.workflow.wrongMaxRecipientsFormat");t=true}else if(parseInt(i)<0){_.warn("error.workflow.maxRecipientsLessThanZero");t=true}else if(parseInt(i)>1e9){_.warn("error.workflow.maxRecipientsTooBig");t=true}}var n=$(this.formNameJId+" "+this.selectNameJId);if(n.val()<=0){_.warn("error.workflow.noMailing");t=true}if(!t){if(e){e()}else{p.saveCurrentEditor()}}};this.toggleSendSettings=function(e){if($("#sendSettings_"+e).css("display")=="none"){$("#sendSettingsToggle_"+e).removeClass("toggle_closed");$("#sendSettingsToggle_"+e).addClass("toggle_open")}else{$("#sendSettingsToggle_"+e).removeClass("toggle_open");$("#sendSettingsToggle_"+e).addClass("toggle_closed")}$("#sendSettings_"+e).toggle("blind",200)};this.hideSendSettings=function(){$(".wm-mailing-send-settings-link").removeClass("toggle_open");$(".wm-mailing-send-settings-link").addClass("toggle_closed");$(".wm-mailing-send-settings").css("display","none")};this.getParameterValue=function(e,t){if(e.length>4){for(var i=0;i<e.length/2;i++){if(i+1==t){return e.substring(i*2,(i+1)*2)}}}else{for(var i=0;i<e.length/2;i++){if(e.substring(i*2,(i+1)*2)==t){return e.substring(i*2,(i+1)*2)}}}return null};this.initOneMailinglistWarningDialog=function(e){A.simpleDialog(e.getSelectedMailingOption().html(),t("workflow.mailinglist.onlyOne")).then(()=>e.acceptOneMailinglistPerCampaign()).fail(()=>{this.mailingId=this.prevMailingId||0;this.mailingSelect().selectValue(this.prevMailingId)});const i=$(".modal");const n=AGN.Lib.Confirm.get(i);i.on("modal:close",()=>n.negative())};var a=function(e){return e.sendDate!=undefined&&e.sendDate!=null&&e.sendHour!=null&&e.sendMinute!=null};var l=function(e){return e.planDate>0};var m=function(e){if(a(e)){return new Date(e.sendDate+"T"+e.sendHour+":"+e.sendMinute+":00")}return null};var v=function(e){if(l(e)){return new Date(e.planDate)}return null};var y=function(e){if(e==null){return null}else{return new Date(e.getFullYear(),e.getMonth(),e.getDate())}};var b=function(e,t){var i=e.targets;var n=t.targetGroupIds;if(i==null&&n==null){return true}if(i.length!=n.length){return false}for(var r=0;r<n.length;r++){if(!d(i,n[r])){return false}}return true};var C=function(e,t){var i=e.altgs;var n=t.altgIds;if(i==null&&n==null){return true}if(i.length!=n.length){return false}for(var r=0;r<n.length;r++){if(!d(i,n[r])){return false}}return true};var d=function(e,t){return e.indexOf(t)!=-1}};AGN.Lib.WM.MailingEditorHelper=e})();(function(){const o=AGN.Lib.WM.EditorsHelper;AGN.Lib.WM.MailingSelector=function(e,i,n){this.formNameJId='form[name="'+e+'"]';this.selectNameJId="select[name="+i+"]";this.defaultSortField="date";this.mailingId=0;this.noMailingOption=n;this.cleanOptions=function(){this.getAllMailingSorted(this.defaultSortField,"asc")};this.onMailingSelectChange=function(e){};this.setMailingId=function(e){this.mailingId=e};this.getAllMailingSorted=function(e,i){var n=this;var r=$(this.formNameJId+" "+this.selectNameJId);var s=r.val();if(s!=null){n.mailingId=s}r.attr("readonly","readonly");$.ajax({type:"GET",url:AGN.url("/workflow/getAllMailingSorted.action"),data:{sortField:e,sortDirection:i},success:function(e){r.html("");if(n.noMailingOption){r.append('<option value="0">'+t("workflow.defaults.no_mailing")+"</option>")}for(var i=0;i<e.length;i++){r.append("<option "+' value="'+e[i].mailingID+'">'+e[i].shortname+"</option>")}r.removeAttr("readonly");if(n.mailingId==0&&n.noMailingOption==false&&e.length>0){r.val(e[0].mailingID)}else{r.val(n.mailingId)}o.initSelectWithValueOrChooseFirst(r,r.val())}})};this.getSelectedMailingOption=function(){return $(this.formNameJId+" "+this.selectNameJId+" option[value="+this.mailingId+"]")}}})();(function(){const n=AGN.Lib.WM.Definitions;class e{constructor(e){this.canvas=e;this.$gridBackground=$("#grid-background");this.scale=1;this.#updateCellSize();this.canvas.setOnMove(()=>this.move())}get shown(){return!this.$gridBackground.hasClass("hidden")}setZoom(e){this.scale=e;this.move();this.#updateCellSize()}toggle(){this.$gridBackground.toggleClass("hidden")}move(){const{x:e,y:t}=this.canvas.getPosition();const i=this.#calculateOffsetDelta(e);const n=this.#calculateOffsetDelta(t);this.$gridBackground.css({left:"-"+i+"px",top:"-"+n+"px",width:"calc(100% + "+i+"px)",height:"calc(100% + "+n+"px)"})}#updateCellSize(){const e=n.NODE_SIZE*this.scale;this.$gridBackground.css("background-size",e+"px "+e+"px")}#calculateOffsetDelta(e){if(e<=0){return e*-1}const t=n.NODE_SIZE*this.scale;const i=e/t%1;return t-t*i}}AGN.Lib.WM.GridBackground=e})();(()=>{const v=AGN.Lib.WM.Definitions;const d=AGN.Lib.WM.Node;const r=AGN.Lib.WM.Vertex;const h=AGN.Lib.WM.VertexGroup;const s=AGN.Lib.WM.NodeTitleHelper;const n=AGN.Lib.WM.Canvas;const o=AGN.Lib.WM.GridBackground;const a=AGN.Lib.WM.ConnectionConstraints;const l=AGN.Lib.WM.DraggableButtons;const e=AGN.Lib.WM.AutoAlignment;const c=AGN.Lib.WM.UndoManager;const p=AGN.Lib.WM.EditorsHelper;const u=AGN.Lib.WM.Dialogs;const f=AGN.Lib.WM.Snippets;const g=AGN.Lib.ContextMenu;const m=AGN.Lib.Helpers;const y=AGN.Lib.Messages;const b=AGN.Lib.WM.Utils;const C=50;const w={blurInputFields:function(){if(document.activeElement&&$(document.activeElement).is("input, textarea")){document.activeElement.blur()}},setConnectionLabel:function(e,t){if(t){var i=e.origin.getOverlay("label");if(i){i.setLabel(t);i.show()}else{e.origin.addOverlay(["Label",{location:.5,id:"label",cssClass:"connection-label",label:t}])}}else{e.origin.hideOverlay("label")}},setDeleteButtonEnabled:function(e){$("#deleteButton").toggleClass("disabled",!e);$("#deleteItem").prop("disabled",!e)},setUndoButtonEnabled:function(e){$("#undoButton").toggleClass("disabled",!e);$("#undoItem").prop("disabled",!e)}};class A{constructor(e,t,i){this.$viewport=$("#viewPort");this.$container=$("#canvas");this.$titlesContainer=this.$container.find("#icon-titles-container");this.canvas=new n(this.$container);this.canvasZoomHandler=null;this.instance=jsPlumb.getInstance(A.defaults(this.$container));this.editable=!!e;this.lastAllocatedId=0;this.drag=null;this.chainModeEnabled=false;this.multiConnectionEnabled=false;this.scale=1;this.dragMode=v.DEFAULT_DRAG_MODE;this.gridBackground=new o(this.canvas);this.instance.isHoverSuspended=()=>!this.editable;const s=this;this.canvas.setOnZoom(e=>{this.instance.setZoom(e);this.gridBackground.setZoom(e);if(this.canvasZoomHandler){this.canvasZoomHandler.call(null,e)}});this.draggableButtons=new l({enabled:!!e,getZoom:()=>s.getZoom(),onStart:function(e){this._connections=s.getConnections();this._connectionsHoverAllowed=!d.isExpandableType(e);this._occupiedAreas=s.getNodes$().get().map(e=>d.getCollisionBox($(e)))},onStop:function(){this._connections.forEach(e=>$(e.origin.canvas).removeClass("js-connection-drop-forbidden"));this._connections=null},onDrag:function(e){const t=d.getCollisionBox(e);const i=this._occupiedAreas.some(e=>d.detectBoxCollision(t,e));e.toggleClass("js-collision-detected",i);this._connections.forEach(e=>{$(e.origin.canvas).toggleClass("js-connection-drop-forbidden",e.origin.isHover()&&!this._connectionsHoverAllowed)})},onDrop:function(e,t,i){const n=e?.hasClass("js-collision-detected");const r=s.findHoveredConnection(this._connections);if(!r&&n){return}if(r&&!this._connectionsHoverAllowed){return}s.undoManager.transaction(()=>{if(!r||s.canInsertNodeIntoConnection(d.create(t),r)){const e=s.newNode(t,i);if(r){s.insertNodeIntoConnection(e,r,n)}}})}});this.$viewport.selectable({filter:".node",distance:10,disabled:!this.editable,start:function(){$("#selection-backdrop").show()},stop:function(){$("#selection-backdrop").hide()},selected:function(e,t){s.instance.addToDragSelection(t.selected);s.onSelectionChanged()},unselected:function(e,t){s.instance.removeFromDragSelection(t.unselected);s.onSelectionChanged()}});this.$viewport.on("mousedown",function(e){if(["canvas","viewPort","icon-titles-container"].includes(e.target.id)||$.contains(s.$titlesContainer[0],e.target)){s.deselectAll()}w.blurInputFields()});this.$viewport.on("wheel",e=>{if(this.canvas.mouseWheelZoomEnabled){e.preventDefault();return}const{x:t,y:i}=this.canvas.getPosition();const n=e.originalEvent.wheelDelta>0?1:-1;const r=C*n;const[s,o]=e.shiftKey?[t+r,i]:[t,i+r];this.canvas.moveTo(s,o)});this.instance.bind("connection",function(e){s.undoManager.operation("connectionCreated",e);s.autofillStopNodesIfPossible();s.autoConvertMailingNodesTypeIfPossible();s.updateOverlays();s.positionTitles();s.processRecipientsChains()});this.instance.bind("connectionDetached",function(e){s.undoManager.operation("connectionDeleted",e);s.autofillStopNodesIfPossible();s.autoConvertMailingNodesTypeIfPossible();s.updateOverlays();s.positionTitles();s.processRecipientsChains()});this.instance.bind("mousedown",function(e,t){if(s.editable&&t.button===v.MOUSE_BUTTON_MIDDLE){_.defer(function(){s.undoManager.transaction(function(){s.deleteConnection(e)})})}w.blurInputFields()});this.instance.bind("beforeDrag",function(){s.undoManager.startTransaction()});this.instance.bind("connectionDragStop",function(){s.undoManager.endTransaction()});this.instance.bind("connectionDrag",function(e){s.deselectAll();if(e.source){var t=$(e.source);s.setNodeSelected(t,true);if(s.isChainMode()){d.setChainSource(t,true)}}});this.instance.bind("beforeDrop",function(e){var t=d.get(document.getElementById(e.sourceId));var i=d.get(document.getElementById(e.targetId));var n=s.connect(t,i,true);if(n){return true}if(n===false){u.connectionNotAllowed()}return false});this.$footnotesContainer=$("#footnotes-container ol");this.isFootnotesEnabled=i;this.undoManager=new c(this,{onChange:function(){w.setUndoButtonEnabled(this.canUndo());s.processRecipientsChains();s.autofillStopNodesIfPossible();s.autoConvertMailingNodesTypeIfPossible()}});p.assignOptions({getUndoManager:()=>s.getUndoManager(),getNodesByTypes:e=>s.getNodesByTypes(e),getNodesByIncomingConnections:function(e){return s.getNodeIncomingConnections(e).map(function(e){return e.source})},getNodesByOutgoingConnections:function(e){return s.getNodeOutgoingConnections(e).map(function(e){return e.target})},getFirstIncomingChain:e=>s.getFirstIncomingChain(e),forEachPreviousNode:(e,t)=>s.forEachPreviousNode(e,t),getNodeAnchorsInUse:e=>s.getAnchorsInUse(e),onChange:function(e){s.updateNodeTitle(e,true);s.updateFootnotes();s.updateMinimap()},supplement:function(e){s.supplement.apply(s,arguments)},editNode:function(e,t){alert("Missing editorsHelper.editNode")},deleteNodeById:function(e){alert("Missing editorsHelper.deleteNodeById")}});if(t){g.create(A.contextMenuOptions(s))}}static defaults(e){return{Container:e,Anchor:[[0,.5,-1,0],[.5,0,0,-1],[1,.5,1,0],[.5,1,0,1]],DragOptions:{cursor:"pointer",zIndex:v.Z_INDEX_JSPLUMB_DRAG_OPTIONS},Endpoint:"Blank",Connector:["FixedBezierConnector"],PaintStyle:{stroke:v.CONNECTION_COLOR,strokeWidth:v.CONNECTION_THICKNESS,outlineStroke:v.CONNECTION_OUTLINE_COLOR,outlineWidth:v.CONNECTION_OUTLINE_WIDTH},HoverPaintStyle:{stroke:v.CONNECTION_HOVER_COLOR,strokeWidth:v.CONNECTION_THICKNESS,outlineStroke:v.CONNECTION_OUTLINE_COLOR,outlineWidth:v.CONNECTION_OUTLINE_WIDTH},ConnectionOverlays:[["PlainArrow",{id:"arrow",visible:true,location:1,width:v.CONNECTION_ARROW_SIZE,length:v.CONNECTION_ARROW_SIZE}]]}}static contextMenuOptions(i){return{".jtk-connector":{shown:()=>i.editable,items:{delete:{name:t("workflow.defaults.delete"),icon:"delete",disabled:function(e){return!i.canDeleteConnection(i.getConnectionByConnector$(e))},clicked:function(t){i.undoManager.transaction(()=>{const e=i.getConnectionByConnector$(t);i.deleteConnection(e.origin)})}}}},".node":{shown:()=>true,items:{connect:{name:t("workflow.connect"),icon:"connect",shown:()=>i.editable&&i.getSelectionSize()>1,clicked:function(){i.undoManager.transaction(()=>{if(i.getSelectionSize()==2&&i.multiConnectionEnabled){i.connectBetweenSelected()}else{i.connectSelected()}})}},disconnect:{name:t("workflow.disconnect"),icon:"disconnect",shown:()=>i.editable&&i.getSelectionSize()>1,clicked:function(){i.undoManager.transaction(()=>{i.disconnectSelected()})}},edit:{name:t("workflow.defaults.edit"),icon:"pen",shown:()=>i.getSelectionSize()<=1,clicked:e=>i.editIcon(d.get(e)),disabled:e=>!d.get(e).isEditable()},delete:{name:t("workflow.defaults.delete"),icon:"trash-alt",clicked:function(){i.undoManager.transaction(()=>i.deleteSelected())},disabled:()=>!i.editable},comment:{name:t("workflow.defaults.comment"),icon:"comment-dots",clicked:e=>i.editIconComment(d.get(e)),disabled:()=>!i.editable}}}}}updateFootnotes=_.throttle(()=>{this.forEachNode(e=>e.setFootnote(-1));this.$footnotesContainer.html("");if(this.isFootnotesEnabled){var t=this;var i=1;this.forEachNode(function(e){if(d.isCommented(e)){t.$footnotesContainer.append('<li id="#fn:'+i+'">'+e.getComment()+"</li>");e.setFootnote(i);i++}})}},150);isActionBasedWorkflow(){return this.getNodes().some(e=>e.getType()===v.NODE_TYPE_ACTION_BASED_MAILING)}isDateBasedWorkflow(){return this.getNodes().some(e=>e.getType()===v.NODE_TYPE_DATE_BASED_MAILING)}isNormalWorkflow(){return!this.isActionBasedWorkflow()&&!this.isDateBasedWorkflow()}getNodes$(){return this.$container.find(".node")}getNodes(){return this.getNodes$().get().map(e=>d.get(e))}getVertices(){return r.verticesFrom(this.getNodes(),this.instance.getAllConnections())}getNodesByType(e){return this.getNodesByTypes([e])}getNodesByTypes(t){return this.getNodes().filter(e=>t.includes(e.type))}forEachNode$(e){const t=this.getNodes$();const i=this;t.each(function(){e.call(i,$(this))})}forEachNode(t){this.forEachNode$(e=>t.call(this,d.get(e)))}forEachPreviousNode(t,e){var i=this.getConnections();var n=i.filter(function(e){return e.target===t}).map(e=>e.source);var r={};while(n.length){for(var s=0;s<n.length;s++){var o=n[s];var a=o.getId();var l=e.call(this,o);if(l===false){return}r[a]=true}n=i.filter(function(e){if(n.includes(e.target)){var t=e.source.getId();if(r[t]){return false}else{r[t]=true;return true}}else{return false}}).map(e=>e.source)}}getNodeIncomingChains(t){var e=this.getVertices();var i=e.find(e=>e.node==t);var n=[];if(i){return r.getIncomingChains(i)}return n}getNodeOutgoingChains(t){var e=this.getVertices();var i=e.find(e=>e.node==t);var n=[];if(i){return r.getOutgoingChains(i)}return n}getFirstOutgoingChain(e){const t=this.getNodeOutgoingChains(e);if(t.length){return t[0]}return[]}getFirstIncomingChain(e){var t=this.getNodeIncomingChains(e);if(t.length){return t[0]}return[]}getNodeIncomingConnections(t){return this.getConnections(e=>d.get(e.target)===t)}getNodeOutgoingConnections(t){return this.getConnections(e=>d.get(e.source)===t)}getNodeConnections(t){return this.getConnections(e=>d.get(e.source)===t||d.get(e.target)===t)}isNodeConnected(e){return this.getNodeConnections(e).length>0}hasNodeIncomingConnections(t){return this.instance.getAllConnections().some(e=>d.get(e.target)===t)}hasNodeOutgoingConnections(t){return this.instance.getAllConnections().some(e=>d.get(e.source)===t)}hasConnection(t){return this.instance.getAllConnections().some(function(e){return t.call(null,{origin:e,source:d.get(e.source),target:d.get(e.target)})})}getConnections(e){var t=this.instance.getAllConnections();if(e){t=t.filter(e)}return t.map(function(e){return{origin:e,source:d.get(e.source),target:d.get(e.target)}})}getConnectionByConnector$(t){return this.getConnections(e=>e.canvas==t[0])[0]}getConnectionBetween(t,i){return this.getConnections(e=>$(e.source).is(t)&&$(e.target).is(i))[0]}recycle(){this.instance.reset();this.$container.empty()}batch(){this.instance.batch.apply(this.instance,arguments)}newNode(e,i){var t=this;if(this.editable){if(d.isExpandableType(e)){const s=v.workflowId===0&&t._isInInitialState();switch(e){case v.NODE_TYPE_SC_BIRTHDAY:case v.NODE_TYPE_SC_DOI:case v.NODE_TYPE_BIRTHDAY_WITH_COUPON:case v.NODE_TYPE_WELCOME_TRACK:case v.NODE_TYPE_WELCOME_TRACK_WITH_INCENTIVE:case v.NODE_TYPE_SHOPPING_CART_ABANDONERS_SMALL:case v.NODE_TYPE_SHOPPING_CART_ABANDONERS_LARGE:case v.NODE_TYPE_ANNIVERSARY_MAIL:if(v.workflowId===0&&this._isInInitialState()){this.deleteAllNodes()}this.newSnippetFromSample(e,i);break;case v.NODE_TYPE_SC_ABTEST:u.createAutoOpt().done(e=>{if(s){t.deleteAllNodes()}f.loadAutoOptSample(e,this.gridBackgroundShown,(e,t)=>this.newSnippet(e,t,i))});break;case v.NODE_TYPE_OWN_WORKFLOW:u.confirmOwnWorkflowExpanding().done(function(e){if(s){t.deleteAllNodes()}t.newSnippetFromOwnWorkflow(e.workflowId,e.copyContent,i)});break}}else{var n=d.create(e);var r=v.NODE_ANIMATION_DROPPED;if(!i){i=this.pickNewNodePosition();r=v.NODE_ANIMATION_AUTO_DROPPED}n.setCoordinates(i.x,i.y);t.add(n,r);t.supplement(n);return n}}}_isInInitialState(){return v.intialSchema===this.serializeIcons()}newSnippetFromSample(e,i){f.loadSample(e,this.gridBackgroundShown,(e,t)=>this.newSnippet(e,t,i))}newSnippetFromOwnWorkflow(e,t,i){f.loadOwnWorkflow(e,t,(e,t)=>{if(this.gridBackgroundShown){e.forEach(e=>this.convertNodeCoordinates(e))}this.newSnippet(e,t,i)})}newSnippet(e,t,i){var n=this;var r=i?v.NODE_ANIMATION_DROPPED:v.NODE_ANIMATION_AUTO_DROPPED;var s=this.getNodesByTypes([v.NODE_TYPE_START]).length>0;var o=this.getNodesByTypes([v.NODE_TYPE_STOP]).length>0;f.removeStartStop(e,t,s,o);if(i){f.adjustPositions(e,i.x,i.y,true)}else{i=this.getCenterPosition();f.adjustPositions(e,i.x,i.y,false)}this.undoManager.transaction(()=>{n.batch(function(){var i=n.allocateIds(e.length);n.allocateSpaceForSnippet(e);e.forEach(function(e,t){e.setId(i[t]);n.add(e,r)});t.forEach(function(e){n.connect(e.source,e.target)})})})}allocateId(){return this.allocateIds(1)[0]}allocateIds(e){var t=[];var i={};this.forEachNode(function(e){i[e.getId()]=true});while(e>0){do{this.lastAllocatedId++}while(i[this.lastAllocatedId]);t.push(this.lastAllocatedId);e--}return t}_findMaxNodeId(){var t=0;this.forEachNode(function(e){if(e.getId()>t){t=e.getId()}});return t}pickNewNodePosition(){var e=this.canvas.getVisibleArea();var n=Math.ceil(e.minY/v.CANVAS_GRID_SIZE);var r=Math.floor(e.maxY/v.CANVAS_GRID_SIZE)-(v.AUTO_DROP_STEP_Y>>1);var s=[];var t;this.forEachNode(function(e){var t=e.getCoordinates();s.push({minX:t.x-v.AUTO_DROP_STEP_X+1,minY:t.y-v.AUTO_DROP_STEP_Y+1,maxX:t.x+v.AUTO_DROP_STEP_X-1,maxY:t.y+v.AUTO_DROP_STEP_Y-1})});var i=function(t,i){if(i<n||i>r){return false}var e=!s.some(function(e){return!(t<e.minX||t>e.maxX||i<e.minY||i>e.maxY)});if(e){return{x:t,y:i}}return false};var o=function(){for(var e=0;e+1<arguments.length;e+=2){var t=i(arguments[e],arguments[e+1]);if(t){return t}}return false};var a=Math.round((e.minX+e.maxX-v.NODE_SIZE)/2/v.CANVAS_GRID_SIZE);var l=Math.round((e.minY+e.maxY-v.NODE_SIZE)/2/v.CANVAS_GRID_SIZE);t=o(a,l);if(t){return t}var c=a;var u=a;var d=l;var h=l;var p=0;while(true){t=o(c-v.AUTO_DROP_STEP_X,l,a,d-v.AUTO_DROP_STEP_Y,a,h+v.AUTO_DROP_STEP_Y,u+v.AUTO_DROP_STEP_X,l);if(t){return t}for(var f=1;f<=p;f++){var g=f*v.AUTO_DROP_STEP_X;var m=f*v.AUTO_DROP_STEP_Y;t=o(c-v.AUTO_DROP_STEP_X,l-m,c-v.AUTO_DROP_STEP_X,l+m,a-g,d-v.AUTO_DROP_STEP_Y,a+g,d-v.AUTO_DROP_STEP_Y,a-g,h+v.AUTO_DROP_STEP_Y,a+g,h+v.AUTO_DROP_STEP_Y,u+v.AUTO_DROP_STEP_X,l-m,u+v.AUTO_DROP_STEP_X,l+m);if(t){return t}}t=o(c-v.AUTO_DROP_STEP_X,d-v.AUTO_DROP_STEP_Y,c-v.AUTO_DROP_STEP_X,h+v.AUTO_DROP_STEP_Y,u+v.AUTO_DROP_STEP_X,d-v.AUTO_DROP_STEP_Y,u+v.AUTO_DROP_STEP_X,h+v.AUTO_DROP_STEP_Y);if(t){return t}c-=v.AUTO_DROP_STEP_X;u+=v.AUTO_DROP_STEP_X;d-=v.AUTO_DROP_STEP_Y;h+=v.AUTO_DROP_STEP_Y;p++}}getCenterPosition(){var e=this.canvas.getVisibleArea();var t=Math.round((e.minX+e.maxX-v.NODE_SIZE)/2/v.CANVAS_GRID_SIZE);var i=Math.round((e.minY+e.maxY-v.NODE_SIZE)/2/v.CANVAS_GRID_SIZE);return{x:t,y:i}}getLinkedFilledStartNodes(e){return _.compact(this.getNodeIncomingChains(e).map(function(e){return _.find(e,e=>e.getType()===v.NODE_TYPE_START)})).filter(e=>e.isFilled())}isAutoOptimizationDecisionAllowed(e){const t=this.getLinkedFilledStartNodes(e);if(t.length===0){return true}return t.every(e=>v.constants.startTypeEvent!==e.data.startType)}isAllLinkedFilledStartsHasDateType(e){const t=this.getLinkedFilledStartNodes(e);return!!t.length&&t.every(function(e){return v.constants.startTypeDate===e.data.startType})}autofillStopNodesIfPossible(){const t=this;this.getNodesByTypes([v.NODE_TYPE_STOP]).forEach(function(e){t.autofillAutomaticEndIfPossible(e)})}autofillAutomaticEndIfPossible(e){if(!this.isAllLinkedFilledStartsHasDateType(e)){return}e.data.endType=v.constants.endTypeAutomatic;e.setFilled(true);this.updateNodeTitle(e,true)}_possibleToAutoConvertMailingsTypeToActionBased(e){const t=this.getLinkedFilledStartNodes(e);return!!t.length&&t.every(function(e){return v.constants.startTypeEvent===e.data.startType&&"EVENT_REACTION"===e.data.event})}_possibleToAutoConvertMailingsTypeToDateBased(e){const t=this.getLinkedFilledStartNodes(e);return!!t.length&&t.every(function(e){return v.constants.startTypeEvent===e.data.startType&&"EVENT_DATE"===e.data.event})}autoConvertMailingNodesTypeIfPossible(){const i=this;const e=[v.NODE_TYPE_MAILING,v.NODE_TYPE_ACTION_BASED_MAILING,v.NODE_TYPE_DATE_BASED_MAILING];this.getNodesByTypes(e).forEach(function(e){const t=i._getAutoConvertedMailingTypeIfPossible(e);if(e.type===t){return}e.type=t;if(e.isFilled()){e.data.mailingId=0;e.setFilled(false);i.updateNodeTitle(e,true)}y.warn("workflow.mailing.typeChanged")})}_getAutoConvertedMailingTypeIfPossible(e){if(this.isAllLinkedFilledStartsHasDateType(e)){return v.NODE_TYPE_MAILING}if(this._possibleToAutoConvertMailingsTypeToActionBased(e)){return v.NODE_TYPE_ACTION_BASED_MAILING}if(this._possibleToAutoConvertMailingsTypeToDateBased(e)){return v.NODE_TYPE_DATE_BASED_MAILING}return e.type}allocateSpaceForSnippet(s){const t=this;function n(e,t){const i=e.getCoordinates();const n=t.getCoordinates();return Math.abs(i.x-n.x)<v.AUTO_DROP_STEP_X&&Math.abs(i.y-n.y)<v.AUTO_DROP_STEP_Y}function o(e,i){return e.some(t=>i.some(e=>n(t,e)))}function i(e){let t=0,i=0,n=0,r=0;e.forEach(e=>{t=Math.min(t,e.getX());i=Math.max(i,e.getX());n=Math.min(n,e.getY());r=Math.max(r,e.getY())});return{x:(i-t)/2,y:(r-n)/2}}function r(e,t){if(Math.abs(e.x-t.x)>=Math.abs(e.y-t.y)){return e.x<t.x?{x:-v.AUTO_DROP_STEP_X,y:0}:{x:v.AUTO_DROP_STEP_X,y:0}}else{return e.y<t.y?{x:0,y:-v.AUTO_DROP_STEP_Y}:{x:0,y:v.AUTO_DROP_STEP_Y}}}function a(e,i){e.forEach(e=>{const t=e.getCoordinates();e.setCoordinates(t.x+i.x,t.y+i.y)})}if(s.length){const l=this.getNodes();var e=l.map(e=>{return{node:e,coordinates:e.getCoordinates(),dragMode:t.getCurrentDragMode()}});const c=i(s);const u=h.detectGroups(this.getVertices()).map(e=>{const t=e.getNodes();return{nodes:t,moveDirection:r(i(t),c)}});u.forEach(t=>{if(o(t.nodes,s)){const i=t.moveDirection;const n=t.nodes.slice(0);const r=s.slice(0);let e=u.filter(e=>e!==t);do{a(n,i);let t;do{t=false;e=e.filter(e=>{if(o(n,e.nodes)){if(e.moveDirection.x===i.x&&e.moveDirection.y===i.y){a(e.nodes,i);Array.prototype.push.apply(n,e.nodes);t=true}else{Array.prototype.push.apply(r,e.nodes)}return false}else{return true}})}while(t)}while(o(n,r))}});e=e.filter(e=>{const t=e.node.getCoordinates();const i=e.coordinates;return t.x!==i.x||t.y!==i.y});if(e.length){this.undoManager.operation("nodeMoved",e)}}}allocateSpaceForSupplement(e,t,i=this.#getOccupiedPositionRanges()){let n=0;let r=0;switch(t){case v.LEFT:default:n=-1;break;case v.RIGHT:n=+1;break;case v.TOP:r=-1;break;case v.BOTTOM:r=+1;break}let s=e.getX()+v.AUTO_DROP_STEP_X*n;let o=e.getY()+v.AUTO_DROP_STEP_Y*r;while(!this.#canPlaceNodeAtPosition(s,o,i)){s+=n;o+=r}return{x:s,y:o}}#getOccupiedPositionRanges(t=[]){return this.getNodes().filter(e=>!t.includes(e)).map(e=>{const t=e.getCoordinates();return{minX:t.x-v.AUTO_DROP_STEP_X+1,minY:t.y-v.AUTO_DROP_STEP_Y+1,maxX:t.x+v.AUTO_DROP_STEP_X-1,maxY:t.y+v.AUTO_DROP_STEP_Y-1}})}#canPlaceNodeAtPosition(t,i,e){return!e.some(e=>{return!(t<e.minX||t>e.maxX||i<e.minY||i>e.maxY)})}allocateSpaceForIncomingSupplement(e){const t=this.getAnchorsInUse(e);let i=v.LEFT;if(!t[v.LEFT]&&t[v.TOP]){i=v.TOP}return this.allocateSpaceForSupplement(e,i)}allocateSpaceForOutgoingSupplement(e){const t=this.getAnchorsInUse(e);let i=v.RIGHT;if(!t[v.RIGHT]&&t[v.BOTTOM]){i=v.BOTTOM}return this.allocateSpaceForSupplement(e,i)}add(i,e){var n=this;var r=i.get$();if(!i.getId()){i.setId(this.allocateId())}i.appendTo(this.$container,this.$titlesContainer,e);i.setInteractionEnabled(this.editable);i.updateCommentLabels();this.instance.makeTarget(r,{anchor:i.getAnchors()});this.instance.makeSource(r,{anchor:i.getAnchors(),filter:".node-connect-button svg"});this.initDraggableOptions(r);var s;r.on({mousedown:function(e){if(e.button===v.MOUSE_BUTTON_MIDDLE){if(n.editable){n.undoManager.transaction(()=>n.deleteNode(r))}}else{i.wasDragging=false;s=d.isSelected(r);if(!s){if(n.isChainMode()){if(!n.isChainSourceSelected()){n.setNodeSelected(r,true);d.setChainSource(r,true)}else{var t=n.getChainSource();_.defer(function(){n.undoManager.transaction(()=>{var e=n.connect(d.get(t),i);if(e){n.deselectAll();n.setNodeSelected(r,true);d.setChainSource(r,true)}else if(e===false){u.connectionNotAllowed()}})})}}else if(!e.shiftKey&&!e.ctrlKey){n.deselectAll();n.setNodeSelected(r,true)}else{n.setNodeSelected(r,true)}}}w.blurInputFields()},mouseup:function(e){if(s&&!i.wasDragging){if(n.isChainMode()){n.setNodeSelected(r,false);d.setChainSource(r,false)}else if(e.shiftKey||e.ctrlKey){n.setNodeSelected(r,false)}else{n.deselectAll();n.setNodeSelected(r,true)}}},dblclick:()=>this.editIcon(i),mouseenter:()=>i.setHovered(true),mouseleave:()=>i.setHovered(false)});this.undoManager.operation("nodeAdded",i);this.updateMinimap();this.updateFootnotes();this.updateDraggableButtons()}supplement(e,t,i){var l=this;if(e.isFilled()){if(v.NODE_TYPES_MAILING.includes(e.getType())&&!b.isPausedWorkflow()){const o=this._findFinalParameterNode(e);if(o){this._fillOptimizationFinalMailingIfPossible(o)}t.trySupplementChain(this.getFirstIncomingChain(e),i,function(a){l.batch(function(){var e=a[0];for(var t=1;t<a.length;t++){var i=a[t];if(i.isAppended()){e=i}else{for(var n=t;n<a.length;n++){var r=a[n];if(r.isAppended()){l.deleteConnectionBetween(r.get$(),e.get$());e=r;t=n;break}}}}for(var t=1;t<a.length;t++){var i=a[t];if(!i.isAppended()){var s=a[t-1];var o=l.allocateSpaceForIncomingSupplement(s);i.setCoordinates(o.x,o.y);l.add(i);l.connect(i,s);if(t+1<a.length&&a[t+1].isAppended()){l.connect(a[t+1],i)}p.resave(i)}}})});this.autoConvertMailingNodesTypeIfPossible()}else if(v.NODE_TYPE_RECIPIENT==e.getType()){this.processRecipientsChains()}else if(v.NODE_TYPE_PARAMETER===e.getType()){const o=l._findFinalParameterNode(e);if(o){const a=l._findTestMailingsParamsNodes(o);const c=e.getData().value;l._setParameterNodesValue(a,c);const u=c*a.length;p.modify(o,function(e){e.setFilled(true);e.setEditable(false);e.getData().value=100-u})}}else if(v.NODE_TYPE_START==e.getType()){this.autofillStopNodesIfPossible();this.autoConvertMailingNodesTypeIfPossible()}}else{if(v.NODE_TYPE_IMPORT==e.getType()){var n=!this.hasNodeOutgoingConnections(e);if(n){var r=d.create(v.NODE_TYPE_DEADLINE);var s=this.allocateSpaceForOutgoingSupplement(e);r.setCoordinates(s.x,s.y);this.add(r);this.connect(e,r)}}}}isAutoOptimizationWorkflow(e){const t=this._findFinalParameterNode(e);if(!t){return false}const i=this._findOptimizationFinalMailingNode(t);if(!i){return false}const n=this.getFirstIncomingChain(t).find(function(e){return e.getType()===v.NODE_TYPE_DECISION});return!!n&&n.data.decisionType===v.constants.decisionTypeAutoOptimization}getParametersOptions(e){const t=this._findFinalParameterNode(e);var i=v.SPLIT_DEFAULT_PARAMETERS;if(t){const n=this._findTestMailingsParamsNodes(t);const r=n.length+1;const s=Math.floor(100/r);i=i.filter(function(e){return e<=s})}return i.map(function(e){return{id:e,text:e}})}_fillOptimizationFinalMailingIfPossible(e){if(!this._isAllOptimizationTestMailingsFilled(e)){return}const t=this._findOptimizationFinalMailingNode(e);const i=t.title;p.modify(t,function(e){e.setFilled(true)});t.setTitle(i)}_findFinalParameterNode(e){const t=this.getNodeOutgoingChains(e);for(var i=0;i<t.length;i++){const n=t[i];const r=n.find(function(e,t){return t>0&&v.NODE_TYPE_PARAMETER===e.getType()});if(r){return r}}return null}_findTestMailingsParamsNodes(e){const i=[];this.getNodeIncomingChains(e).forEach(function(e){const t=e.find(function(e,t){return t>0&&v.NODE_TYPE_PARAMETER===e.getType()});if(t){i.push(t)}});return i}_findOptimizationFinalMailingNode(e){const t=this.getFirstOutgoingChain(e);return t.find(function(e){return e.getType()===v.NODE_TYPE_MAILING&&!e.isEditable()})}_isAllOptimizationTestMailingsFilled(e){const t=this._findTestMailingsParamsNodes(e);for(var i=0;i<t.length;i++){const n=t[i];const r=this.getFirstOutgoingChain(n);if(r.length<=1){return false}const s=r[1];if(s.getType()!==v.NODE_TYPE_MAILING||!s.isFilled()||!s.isEditable()){return false}}return true}_setParameterNodesValue(e,t){e.forEach(function(e){p.modify(e,function(e){e.setFilled(true);e.getData().value=t})})}processRecipientsChains=_.debounce(()=>{var e=this._findInitialRecipientsNodes();var r=this;e.forEach(function(n){n.setInRecipientsChain(false);r.updateNodeTitle(n);var e=r.getNodeOutgoingChains(n);e.forEach(function(e){var t=1;for(;t<e.length;++t){var i=e[t];if(i.type!=v.NODE_TYPE_RECIPIENT){break}i.data.mailinglistId=n.data.mailinglistId;i.setInRecipientsChain(true);r.updateNodeTitle(i)}})})},150);_findInitialRecipientsNodes(){var e=this.getNodesByTypes([v.NODE_TYPE_RECIPIENT]);var t=this.getConnections();var i=[];t.filter(function(e){return e.target.type==v.NODE_TYPE_RECIPIENT&&e.source.type==v.NODE_TYPE_RECIPIENT}).forEach(function(e){i.push(e.target.id)});return e.filter(function(e){return!i.includes(e.id)})}getAnchorsInUse(e){var t=e.get$();return d.getAnchorsInUse(this.instance.getEndpoints(t[0]))}getConnectionDirection(e){const t=d.getAnchorsInUse([e.endpoints[1]]);if(t[v.TOP]){return v.BOTTOM}if(t[v.BOTTOM]){return v.TOP}if(t[v.RIGHT]){return v.LEFT}return v.RIGHT}positionTitle(e){s.positionTitle(e,this.getAnchorsInUse(e))}updateNodeTitle(e,t){var i=this.isNormalWorkflow();s.updateTitle(e,i,t);this.positionTitle(e)}updateNodeTitles=_.throttle(t=>{var i=this;var n=this.isNormalWorkflow();this.forEachNode(function(e){s.updateTitle(e,n,t);i.positionTitle(e)})},150);positionTitles=_.throttle(()=>{this.forEachNode(e=>{this.positionTitle(e)})},150);setMinimapEnabled(e){this.canvas.setMinimapEnabled(e)}updateMinimap=_.debounce(function(){this.canvas.updateMinimap()},100);isChainSourceSelected(){return this.$container.find(".node.chain-mode-source").exists()}getChainSource(){return this.$container.find(".node.chain-mode-source")}setNodeSelected(e,t){if(t){this.instance.addToDragSelection(e)}else{this.instance.removeFromDragSelection(e)}d.setSelected(e,!!t);this.onSelectionChanged()}isConnectionPossible(t,i){if(t instanceof d&&i instanceof d){if(t===i){return false}return!this.hasConnection(function(e){return e.source===t&&e.target===i||e.source===i&&e.target===t})}return false}isConnectionAllowed(e,t,i){var n=new a(v.CONNECTION_CONSTRAINTS);var r=this;var s={node:e,type:e.getType(),connections:{}};var o={node:t,type:t.getType(),connections:{}};Object.defineProperty(s.connections,"incoming",{get:m.caching(e=>r.getNodeIncomingConnections(e).filter(e=>i?.origin!==e.origin),r,e)});Object.defineProperty(s.connections,"outgoing",{get:m.caching(e=>r.getNodeOutgoingConnections(e).filter(e=>i?.origin!==e.origin),r,e)});Object.defineProperty(o.connections,"incoming",{get:m.caching(e=>r.getNodeIncomingConnections(e).filter(e=>i?.origin!==e.origin),r,t)});Object.defineProperty(o.connections,"outgoing",{get:m.caching(e=>r.getNodeOutgoingConnections(e).filter(e=>i?.origin!==e.origin),r,t)});if(!i){if(s.type===v.NODE_TYPE_STOP&&!this.hasNodeIncomingConnections(e)){s.type=v.NODE_TYPE_START;s.node.setType(v.NODE_TYPE_START);this.updateDraggableButtons()}if(o.type===v.NODE_TYPE_START&&!this.hasNodeOutgoingConnections(t)){o.type=v.NODE_TYPE_STOP;o.node.setType(v.NODE_TYPE_STOP);this.updateDraggableButtons()}}return n.check(s,o)}connect(e,t,i){if(this.isConnectionPossible(e,t)){if(!this.isConnectionAllowed(e,t)){return false}if(e.getType()===v.NODE_TYPE_STOP){e.setType(v.NODE_TYPE_START)}if(t.getType()===v.NODE_TYPE_START){t.setType(v.NODE_TYPE_STOP)}if(i!==true){this.instance.connect({source:e.get$(),target:t.get$()})}return true}else{return null}}deselectAll(){this.$container.find(".node.ui-selected").removeClass("ui-selected");this.instance.clearDragSelection();this.clearSelectedSource();this.onSelectionChanged()}clearSelectedSource(){this.$container.find(".node.chain-mode-source").removeClass("chain-mode-source")}alignAll(){this.undoManager.transaction(()=>{if(this.#performNodesMove(()=>e.align(this.getVertices()))){this.positionTitles();this.updateMinimap()}})}#performNodesMove(e){const t=this.getNodes();const i={};t.forEach(e=>i[e.getId()]=e.getCoordinates());this.batch(()=>e());const n=t.filter(e=>{const t=i[e.getId()];return t.x!==e.getX()||t.y!==e.getY()}).map(e=>{return{node:e,coordinates:i[e.getId()],dragMode:this.getCurrentDragMode()}});if(n.length){this.undoManager.operation("nodeMoved",n);return true}return false}deleteSelected(){this.deleteNodes(this.getSelectedNodes())}deleteNode(e){if(e instanceof d){}else{e=d.get(e)}if(e.isAppended()){var t=[e];switch(e.getType()){case v.NODE_TYPE_IMPORT:this.getNodeOutgoingConnections(e).forEach(function(e){if(v.NODE_TYPE_DEADLINE==e.target.getType()){t.push(e.target)}});break;case v.NODE_TYPE_DEADLINE:this.getNodeIncomingConnections(e).forEach(function(e){if(v.NODE_TYPE_IMPORT==e.source.getType()){t.push(e.source)}});break}t.forEach(e=>{p.exitNodeEditorIfActive(e);this.undoManager.operation("nodeDeleted",e);this.instance.remove(e.get$());e.remove()});this.updateDraggableButtons();this.onSelectionChanged();this.positionTitles();this.updateFootnotes();this.updateMinimap()}}deleteAllNodes(){this.deleteNodes(this.getNodes())}deleteNodes(e){this.undoManager.transaction(()=>{this.batch(()=>{e.forEach(e=>this.deleteNode(e))})})}disconnectSelected(){this.disconnectNodes(this.getSelectedNodes())}disconnectNode(e){var t=this;this.getNodeConnections(e).forEach(function(e){t.deleteConnection(e)})}disconnectNodes(e){var t=this;this.batch(function(){e.forEach(function(e){t.disconnectNode(e)})})}canDeleteConnection(e){var t,i;if(e.origin){t=e.source;i=e.target}else{t=d.get(e.source);i=d.get(e.target)}return!(v.NODE_TYPE_IMPORT==t.getType()&&v.NODE_TYPE_DEADLINE==i.getType())}deleteConnection(e){if(this.canDeleteConnection(e)){if(e.origin){this.instance.deleteConnection(e.origin)}else{this.instance.deleteConnection(e)}return true}return false}deleteConnectionBetween(e,t){const i=this.getConnectionBetween(e,t);if(i){this.deleteConnection(i)}}connectSelected(){return this.connectNodes(this.getSelectedNodes())}connectBetweenSelected(){var e=this.getSelectedNodes$();if(e.length>=2){return this.connectNodes(this.getNodesBetweenSelected(e[0],e[1]))}else{return false}}getNodesBetweenSelected(e,t){var i=d.getBox(e);var n=d.getBox(t);var r={minX:Math.min(i.minX,n.minX),maxX:Math.max(i.maxX,n.maxX),minY:Math.min(i.minY,n.minY),maxY:Math.max(i.maxY,n.maxY)};return this.getNodes().filter(function(e){return d.isInRegion(e.get$(),r)})}findHoveredConnection(e){return e?.find(e=>e.origin.isHover())}insertNodeIntoConnection(e,t,i=false){if(!this.canInsertNodeIntoConnection(e,t)){return false}const o=this.getConnectionDirection(t.origin);this.deleteConnection(t);this.connect(t.source,e);this.connect(e,t.target);if(i){this.#performNodesMove(()=>{e.setCoordinates(t.source.getX(),t.source.getY());const r=this.getFirstOutgoingChain(e);let s=t.source;r.forEach(e=>{const t=this.#getOccupiedPositionRanges(r.slice(r.indexOf(e)));if(!this.#canPlaceNodeAtPosition(e.getX(),e.getY(),t)){const{x:i,y:n}=this.allocateSpaceForSupplement(s,o,t);e.setCoordinates(i,n)}s=e})})}return true}canInsertNodeIntoConnection(e,t){const i=this.isConnectionAllowed(t.source,e,t)&&this.isConnectionAllowed(e,t.target,t);if(!i){u.connectionNotAllowed()}return i}connectNodes(e){const t=e.sort((e,t)=>{return e.getX()<t.getX()?-1:e.getX()>t.getX()?1:e.getY()<t.getY()?-1:e.getY()>t.getY()?1:0});let i=false;this.undoManager.transaction(()=>{this.batch(()=>{for(let e=0;e<t.length-1;e++){if(this.connect(t[e],t[e+1])){i=true}}})});return i}getSelectedNodes$(){var i=[];this.$container.find(".node.ui-selected").each(function(e,t){i.push($(t))});return i}getSelectedNodes(){return this.getSelectedNodes$().map(function(e){return d.get(e)})}getSelectionSize(){return this.$container.find(".node.ui-selected").length}updateDraggableButtons(){if(this.getNodesByType(v.NODE_TYPE_START).length){this.draggableButtons.changeType(v.NODE_TYPE_START,v.NODE_TYPE_STOP)}else{this.draggableButtons.changeType(v.NODE_TYPE_STOP,v.NODE_TYPE_START)}}onSelectionChanged(){w.setDeleteButtonEnabled(this.getSelectionSize()>0)}setOnInitialized(e){const t=this;const i=function(){e.apply(this);t.lastAllocatedId=t._findMaxNodeId()};this.instance.ready(i)}setOnZoom(e){this.canvasZoomHandler=e}setEditable(t){t=!!t;if(this.editable!==t){this.editable=t;this.draggableButtons.setEnabled(t);this.$viewport.selectable(t?"enable":"disable");this.forEachNode(function(e){e.setInteractionEnabled(t)})}}getZoom(){return this.instance.getZoom()}setZoom(e){this.scale=e;this.canvas.setZoom(e);this.instance.setZoom(e);this.gridBackground.setZoom(e)}toggleGrid(){this.gridBackground.toggle();this.dragMode=this.gridBackgroundShown?v.GRID_CELL_DRAG_MODE:v.DEFAULT_DRAG_MODE;this.adaptToNewDragMode()}get gridBackgroundShown(){return this.gridBackground.shown}convertNodeCoordinates(e){const t=e.getCoordinates();this.convertCoordinates(t);e.setCoordinates(t.x,t.y)}convertCoordinates(e){const t=v.NODE_SIZE/v.CANVAS_DEFAULT_GRID_SIZE;if(this.getCurrentDragMode()===v.GRID_CELL_DRAG_MODE){e.x=e.x/t;e.y=e.y/t}else{e.x=e.x*t;e.y=e.y*t}}adaptToNewDragMode(){this.adaptPropertiesToDragMode();const t=this;this.getNodes$().each(function(){t.instance.destroyDraggable(this);t.initDraggableOptions($(this))});this.forEachNode(function(e){t.convertNodeCoordinates(e)})}adaptPropertiesToDragMode(){if(this.getCurrentDragMode()===v.GRID_CELL_DRAG_MODE){v.CANVAS_GRID_SIZE=v.NODE_SIZE;v.AUTO_ALIGN_STEP_X=v.GRID_AUTO_ALIGN_STEP_X;v.AUTO_ALIGN_STEP_Y=v.GRID_AUTO_ALIGN_STEP_Y}else{v.CANVAS_GRID_SIZE=v.CANVAS_DEFAULT_GRID_SIZE;v.AUTO_ALIGN_STEP_X=v.DEFAULT_AUTO_ALIGN_STEP_X;v.AUTO_ALIGN_STEP_Y=v.DEFAULT_AUTO_ALIGN_STEP_Y}}initDraggableOptions(e){const r=this;const s=d.get($(e));let o;this.instance.draggable(e,{distance:v.CANVAS_GRID_SIZE/2,grid:[v.CANVAS_GRID_SIZE,v.CANVAS_GRID_SIZE],rightButtonCanDrag:false,canDrag:function(){return r.editable},start:function(){s.wasDragging=true;if(r.drag==null){const t=[];const i=[];s.setPopoverEnabled(false);r.forEachNode$(function(e){if(d.isSelected(e)){t.push(e);d.get(e).setTitleEnabled(false)}else{i.push(d.getCollisionBox(e))}});o=r.getConnections();r.drag={lead:e,selected:t,unselected:i,connectionsHoverAllowed:t.length===1&&!r.isNodeConnected(s)}}},stop:function(){r.drag.selected.forEach(e=>{d.get(e).setTitleEnabled(true);e.removeClass("js-collision-detected")});o.forEach(e=>$(e.origin.canvas).removeClass("js-connection-drop-forbidden"));s.setPopoverEnabled(true)},drag:function(){if(r.drag&&e===r.drag.lead){r.drag.selected.forEach(e=>{const t=d.getCollisionBox(e);const i=r.drag.unselected.some(e=>d.detectBoxCollision(e,t));e.toggleClass("js-collision-detected",i)});o.forEach(e=>{$(e.origin.canvas).toggleClass("js-connection-drop-forbidden",e.origin.isHover()&&!r.drag.connectionsHoverAllowed)})}},revert:function(){if(!r.drag){return false}let n=false;r.undoManager.transaction(()=>{const t=r.getZoom();const e=r.drag.selected.some(e=>{const t=d.getCollisionBox(e);return r.drag.unselected.some(e=>d.detectBoxCollision(e,t))});const i=r.findHoveredConnection(o);if(!i&&e){n=true}if(i&&!r.drag.connectionsHoverAllowed){n=true}if(!n&&i){n=!r.insertNodeIntoConnection(s,i,e)}if(!n&&!i){r.undoManager.operation("nodeMoved",r.drag.selected.map(e=>{const t=d.get(e);return{node:t,coordinates:t.getCoordinates(),dragMode:r.getCurrentDragMode()}}));r.drag.selected.forEach(e=>{d.get(e).updateCoordinates(t)})}r.drag=null;r.updateOverlays();r.positionTitles();r.updateMinimap()});return n}})}getCurrentDragMode(){return this.dragMode}setPanningEnabled(e){this.canvas.setPanningEnabled(e);this.$viewport.toggleClass("js-panning",!!e);if(e){this.$viewport.selectable("disable")}else if(this.editable){this.$viewport.selectable("enable")}}setMouseWheelZoomEnabled(e){this.canvas.setMouseWheelZoomEnabled(e)}setMultiConnectionEnabled(e){this.multiConnectionEnabled=e}setChainModeEnabled(e){this.chainModeEnabled=e;this.clearSelectedSource();if(e){var t=this.getSelectedNodes$().shift();if(t){this.deselectAll();this.setNodeSelected(t,true);d.setChainSource(t,true)}}}isChainMode(){return this.chainModeEnabled===true}updateOverlays=_.debounce(()=>{this.forEachNode(function(e){if(d.isDecisionNode(e)){this.updateDecisionBranchesOverlays(e)}})},100);updateDecisionBranchesOverlays(e){var t=this.getNodeOutgoingConnections(e);if(d.isBranchingDecisionNode(e)){var i=d.getDecisionBranches(t);if(i){var n=s.getDecisionBranchesLabels();w.setConnectionLabel(i.positive,n.positive);w.setConnectionLabel(i.negative,n.negative)}else{t.forEach(function(e){w.setConnectionLabel(e,"?")})}}else{t.forEach(function(e){w.setConnectionLabel(e,false)})}}editIcon(e){if(this.drag==null){if(e){if(e.editable){this.deselectAll();p.showEditDialog(e)}}else{var t=this.getSelectedNodes$();if(t.length==1){this.deselectAll();const e=d.get(t[0]);p.showEditDialog(e)}}}}editIconComment(e){p.showIconCommentDialog(e)}serializeIcons(){var e=this.getNodes().map(function(e){return e.serialize()});var i={};this.getConnections().forEach(function(e){var t=i[e.source.id];if(!t){t=[]}t.push(e);i[e.source.id]=t});e.forEach(function(e){var t=i[e.id];if(t){e.connections=t.map(function(e){return{targetIconId:e.target.id}})}else{e.connections=[]}});return JSON.stringify(e)}undo(){this.undoManager.undo()}getUndoManager(){return this.undoManager}hasUnsavedChanges(){return this.getUndoManager().canUndo()}fitPdfPage(){this.canvas.fitPdfPage(v.PDF_SIZE,v.PDF_ORIENTATION)}}AGN.Lib.WM.Editor=A})();(function(){function e(e,t){if(typeof e==="string"&&typeof t==="string"){return e.toLowerCase().localeCompare(t.toLowerCase())}return e.localeCompare(t)}AGN.Lib.TableCaseInsensitiveComparator=e})();class SwitchFilter{init(e){this.column=e.column.colId;this.$el=$(`#${this.column}-filter`);this.checked=this.$el.prop("checked")}getGui(){return document.createElement("div")}doesFilterPass(e){return this.checked===e.data[this.column]}isFilterActive(){return true}getModel(){return this.checked}setModel(e){this.checked=this.$el.prop("checked")}}class DateRangeFilter{init(e){this.params=e;this.column=e.column.colId;this.$fromDate=this.#getDateRangeFilter(e,"from");this.$toDate=this.#getDateRangeFilter(e,"to")}#getDateRangeFilter(e,t){let i=$(`${e.colDef[`filter${_.capitalize(t)}Input`]}`);if(!i.length){i=$(`#${e.column.colId}-${t}-filter`)}return i}#getIsoVal(e){return e.datepicker("getDate")?.toISOString()}isFilterActive(){return this.fromDate||this.toDate}doesFilterPass(e){const t=e.data[this.column]?.date||this.params.valueGetter(e);if(!this.fromDate&&!this.toDate){return true}if(!t){return false}if(this.fromDate&&this.toDate){return t>=this.fromDate&&t<=this.toDate}if(this.fromDate){return t>=this.fromDate}if(this.toDate){return t<=this.toDate}}getModel(){return{fromDate:this.fromDate,toDate:this.toDate}}setModel(e){if(this.$fromDate?.length){const t=this.#getIsoVal(this.$fromDate);this.fromDate=t?new Date(t):null}if(this.$toDate?.length){const i=this.#getIsoVal(this.$toDate);this.toDate=i?new Date(i):null}}getGui(){return document.createElement("div")}}class DeliveryDateFilter extends DateRangeFilter{init(e){super.init(e);this.$filterType=$(`#${this.column}-filter`)}doesFilterPass(e){const t=e.data[this.column];return this.doesDateFilterPass(t)&&super.doesFilterPass(e)||this.doesSoftBounceFilterPass(t)||this.doesHardBounceFilterPass(t)||this.doesNoFeedbackFilterPass(t)}doesDateFilterPass(e){return e&&this.types.includes("date")&&!["soft-bounce","hard-bounce"].includes(e)}doesSoftBounceFilterPass(e){return this.types.includes("soft-bounce")&&e==="soft-bounce"}doesHardBounceFilterPass(e){return this.types.includes("hard-bounce")&&e==="hard-bounce"}doesNoFeedbackFilterPass(e){return this.types.includes("no-feedback")&&!e}isFilterActive(){return this.types.length>0}getModel(){return{...super.getModel(),types:this.types}}setModel(e){super.setModel(e);this.types=[...this.$filterType.val()]}}AGN.Opt.Table["filters"]["DeliveryDateFilter"]=DeliveryDateFilter;(()=>{class e{init(e){this.eGui=AGN.Lib.TableCellWrapper(e.api.gridOptionsService.gridOptions,e.data);this.eGui.innerHTML=AGN.Lib.Template.text(e.templateName,{value:e.value,entry:e.data});AGN.Lib.CoreInitializer.run("tooltip",$(this.eGui))}getGui(){return this.eGui}refresh(){return false}destroy(){}}AGN.Opt.TableCellRenderers["MustacheTemplateCellRender"]=e})();(function(){var e=function(){};e.prototype.init=function(e){this.agParams=e;this.eGui=document.createComment("No label")};e.prototype.getGui=function(){return this.eGui};e.prototype.destroy=function(){};AGN.Opt.TableHeaderComponents["NoLabelHeader"]=e})();(()=>{const e=function(){};e.prototype.init=function(e){this.gui=AGN.Lib.TableCellWrapper(e.api.gridOptionsService.gridOptions,e.data);const t=document.createElement("div");if(e.value){t.innerHTML=e.value}t.classList.add("text-truncate-table");this.gui.appendChild(t)};e.prototype.getGui=function(){return this.gui};e.prototype.refresh=function(){return false};AGN.Opt.TableCellRenderers["NotEscapedStringCellRenderer"]=e})();(function(){function e(e,t,i,n,r){e=parseFloat(e);t=parseFloat(t);if(isNaN(e)||isNaN(t)){if(!isNaN(e)){return r?+1:-1}if(!isNaN(t)){return r?-1:+1}return 0}return e-t}AGN.Lib.TableNumberComparator=e})();(()=>{var n=AGN.Lib.Confirm,r=AGN.Lib.Page,e=function(){};function s(e){if(e.deliveryHistoryEnabled){return AGN.url("/recipient/"+e.recipientId+"/mailing/"+e.data.mailingId+"/deliveryHistory.action")}else{return""}}e.prototype.init=function(i){this.eGui=document.createElement("div");var e=s(i);if(!e){this.eGui.innerHTML=i.value}else{this.eGui.innerHTML='<button type="button" class="table__btn btn btn-inverse"><i class="icon icon-external-link-alt"></i><span>'+i.value+"</span></button>";this.eButton=this.eGui.querySelector(".btn");this.eButton.setAttribute("href",e);this.eventListener=function(e){var t=s(i);if(t){$.get(t).done(function(e){var t=$(e),i;i=t.all(".modal");if(i.length==1){n.create(e)}else{r.render(e)}});e.preventDefault();return false}};this.eButton.addEventListener("click",this.eventListener)}};e.prototype.getGui=function(){return this.eGui};e.prototype.refresh=function(e){if(this.eButton){this.eButton.dataset.url=s(e)}return true};e.prototype.destroy=function(){if(this.eButton){this.eButton.removeEventListener("click",this.eventListener)}};AGN.Opt.TableCellRenderers["RecipientDeliveryInfoRenderer"]=e})();(function(){var n=AGN.Lib.Confirm,r=AGN.Lib.Page,e=function(){};function s(e){if(e.deliveryHistoryEnabled){return AGN.url("/recipient/"+e.recipientId+"/mailing/"+e.data.mailingId+"/successfulDeliveryHistory.action")}else{return""}}e.prototype.init=function(i){this.eGui=document.createElement("div");var e=s(i);if(!e){this.eGui.innerHTML=i.value}else{this.eGui.innerHTML='<button type="button" class="table__btn btn btn-inverse"><i class="icon icon-external-link-alt"></i><span>'+i.value+"</span></button>";this.eButton=this.eGui.querySelector(".btn");this.eButton.setAttribute("href",e);this.eventListener=function(e){var t=s(i);if(t){$.get(t).done(function(e){var t=$(e),i;i=t.all(".modal");if(i.length==1){n.create(e)}else{r.render(e)}});e.preventDefault();return false}};this.eButton.addEventListener("click",this.eventListener)}};e.prototype.getGui=function(){return this.eGui};e.prototype.refresh=function(e){if(this.eButton){this.eButton.dataset.url=s(e)}return true};e.prototype.destroy=function(){if(this.eButton){this.eButton.removeEventListener("click",this.eventListener)}};AGN.Opt.TableCellRenderers["RecipientSuccessDeliveryInfoRenderer"]=e})();class SetFilter{init(e){this.params=e;this.column=e.column.colId;this.$el=$(`#${this.column}-filter`);this.filterValues=this.$el.val()}getGui(){return document.createElement("div")}doesFilterPass(e){if(!this.filterValues.length){return true}let t=e.data[this.column];t=t?.name||t;return this.filterValues.includes(t)}isFilterActive(){return this.filterValues.length>0}getModel(){return{values:this.filterValues}}setModel(e){this.filterValues=this.$el.val()}}(function(){const e=function(){};e.prototype.init=function(e){this.gui=AGN.Lib.TableCellWrapper(e.api.gridOptionsService.gridOptions,e.data);const t=document.createElement("div");if(e.value){t.appendChild(document.createTextNode(e.value))}t.classList.add("text-truncate-table");this.gui.appendChild(t)};e.prototype.getGui=function(){return this.gui};e.prototype.refresh=function(){return false};AGN.Opt.TableCellRenderers["StringCellRenderer"]=e})();(()=>{const n=AGN.Lib.Template;AGN.Lib.TableCellWrapper=function(e,t){if(e?.viewLinkTemplate&&!e.isRestoreMode()){const i=document.createElement("a");if(!n.exists(e.viewLinkTemplate)){n.register(e.viewLinkTemplate,e.viewLinkTemplate)}i.href=AGN.url(n.text(e.viewLinkTemplate,t).trim());i.classList.add("ag-grid-cell-link");if(e.viewInModal){i.setAttribute("data-confirm","")}return i}return document.createElement("div")}})();(()=>{class e{init(i){this.$eGui=$('<div class="d-flex gap-2 justify-content-end"></div>');const n=i.colDef["buttons"];if(!n){return}i.data.rowActions.forEach(t=>{const e=n.find(e=>e.name===t);if(e){this.$eGui.append(AGN.Lib.Template.text(e.template,i.data))}});AGN.Lib.CoreInitializer.run("tooltip",this.$eGui)}getGui(){return this.$eGui.get(0)}refresh(){return true}}AGN.Opt.TableCellRenderers["TableActionsCellRenderer"]=e})();class WorkflowStartFilter extends DateRangeFilter{init(e){super.init(e);this.$filterType=$(`#${this.column}-filter`)}doesFilterPass(e){const t=e.data[this.column]?.type;return this.doesByDateFilterPass(t)&&super.doesFilterPass(e)||this.doesActionBasedFilterPass(t)||this.doesDateBasedFilterPass(t)}doesByDateFilterPass(e){return this.types.includes("startDate")&&e!=="EVENT_REACTION"&&e!=="EVENT_DATE"}doesActionBasedFilterPass(e){return this.types.includes("actionBased")&&e==="EVENT_REACTION"}doesDateBasedFilterPass(e){return this.types.includes("dateBased")&&e==="EVENT_DATE"}isFilterActive(){return this.types.length>0}getModel(){return{...super.getModel(),types:this.types}}setModel(e){super.setModel(e);this.types=[...this.$filterType.val()]}}AGN.Opt.Table["filters"]["WorkflowStartFilter"]=WorkflowStartFilter;class WorkflowStopFilter extends DateRangeFilter{init(e){super.init(e);this.$filterType=$(`#${this.column}-filter`)}doesFilterPass(e){const t=e.data[this.column]?.type;return this.doesByDateFilterPass(t)&&super.doesFilterPass(e)||this.doesAutomaticEndFilterPass(t)}doesByDateFilterPass(e){return this.types.includes("stopDate")&&e!=="AUTOMATIC"}doesAutomaticEndFilterPass(e){return this.types.includes("automaticEnd")&&e==="AUTOMATIC"}isFilterActive(){return this.types.length>0}getModel(){return{...super.getModel(),types:this.types}}setModel(e){super.setModel(e);this.types=[...this.$filterType.val()]}}AGN.Opt.Table["filters"]["WorkflowStopFilter"]=WorkflowStopFilter;(function(){AGN.Lib.FormBuilder=AGN.Lib.FormBuilder||{};AGN.Lib.FormBuilder.Utils={pushControl:function(e,n){if(!Array.isArray(e)){return}e.push(function(e){var t=function(e){var t=e.prototype.constructor;function i(){return t.apply(this,arguments)}i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:true,configurable:true}});i.__proto__=e;if(n.build){i.prototype.build=n.build}if(n.onRender){i.prototype.onRender=n.onRender}Object.defineProperty(i,"definition",{get:n.definition});return i}(e);e.register(n.newControlName,t);return t})}}})();(function(){AGN.Lib.FormBuilder=AGN.Lib.FormBuilder||{};AGN.Lib.FormBuilder.EmmControls={mediapool:function(r){return{newControlName:"mediapool",build:function(){return{field:this.markup("img",null,{}),layout:"agnMediapool"}},onRender:function(e){if(this.preview){var i=$(e.target).parents(".form-field").find(".field-label");i.html(t("userform.formBuilder.mediapoolImage")+": "+r.options.mediapoolImages[this.config.image])}var n=$(this.element);n.attr("src",this.config.image).attr("alt",this.config.alt);if(this.config.width){n.attr("width",this.config.width)}if(this.config.height){n.attr("height",this.config.height)}},definition:function(){return{i18n:{default:t("userform.formBuilder.mediapoolImage")}}}}},nextform:function(){return{newControlName:"formName",build:function(){return{field:this.markup("input",null,{name:"agnFN",type:"hidden"}),layout:"hidden"}},onRender:function(e){if(this.preview){var i=$(e.target).parents(".form-field").find(".field-label");i.html(t("userform.formBuilder.nextForm")+": "+this.config.formName)}$(this.element).attr("value",this.config.formName)},definition:function(){return{i18n:{default:t("userform.formBuilder.nextForm")}}}}}}})();(function(){AGN.Lib.FormBuilder=AGN.Lib.FormBuilder||{};var n={agnCTOKEN:t("userform.formBuilder.tooltips.agnCTOKEN"),agnUID:t("userform.formBuilder.tooltips.agnUID")};const o=2;const i={gender:[{selected:true,label:"Gender Male",value:0},{selected:false,label:"Gender Female",value:1}]};var a=["agnCTOKEN","agnUID","agnMAILINGLIST","agnSUBSCRIBE"];AGN.Lib.FormBuilder.Templates={default:function(){return{onRender:l}},hidden:function(){return{onRender:e}},dateForRender:function(i){var e=this;var t=(this.config.className||"")+" js-datepicker";var n=$.extend({},this.config,{"data-datepicker-options":"format: 'yyyy/mm/dd', formatSubmit: 'yyyy/mm/dd'",className:t});return{field:e.markup("input",null,n),onRender:function(e){var t=$(e.target);t.append('<input type="hidden" name="'+i.name+'_format" value="'+"yyyy/MM/dd"+'">')}}}};function l(e){var t=$(e.target).parents(".form-field"),i=this.config.emmField,n=t.data("currentEmmField"),r=!n,s=i!==n;if(r){t.data("currentEmmField",i)}else if(s){t.data("currentEmmField",i);u(t,this.config,i,n)}}function e(e){var t=this.config.id.replace("-preview","");var i=$(e.target);var n=i.parents(".form-field").find(".form-elements");var r=n.find(".emmField-wrap");if(a.includes(t)){r.hide()}else{r.show()}if(!a.includes(t)){l.apply(this,arguments)}var s=i.parents(".form-field").find(".tooltip-element");c(s,t)}function c(e,t){const i=n[t];if(!i){e.hide();return}e.removeAttr("tooltip").show();AGN.Lib.Tooltip.createTip(e,i)}function u(e,t,i,n){const r=e.find(".form-elements"),s=r.find('input[name="value"]'),o=r.find('input[name="name"]'),a=i!=="none";var l=a?"$!customerData."+i:"",c=a?i:"";s.val(l);o.val(c);if(a){o.prop("disabled",true)}else{o.prop("disabled",false)}if(t.type==="select"){d(i,n,e,t)}}function d(e,t,i,n){const r=g(e);if(r.length>=o){const s={values:r,name:e};h(i,n,s)}else if(g(t).length>0){const s={values:[],name:e};h(i,n,s)}}function h(t,i,n){const r=t.parents(".js-form-builder");const s=r.data("formBuilder");s.actions.removeField(t.prop("id"));f(function(){const e=_.mergeWith(i,n,function(e,t){return _.isArray(t)?t:undefined});s.actions.addField(e,p(t,r))});f(function(){s.actions.toggleFieldEdit(s.actions.getCurrentFieldId())})}function p(i,e){var n=0;_.each(e.find(".form-field"),function(e,t){if($(e).prop("id")===i.prop("id")){n=t}});return n}function f(e){window.setTimeout(function(){e()},0)}function g(e){const t=i[e];return t?t:[]}})();(function(){var e=AGN.Lib.FormBuilder.Utils;var i=AGN.Lib.FormBuilder.EmmControls;var r=AGN.Lib.FormBuilder.Templates;var s="<html>\n"+"    <head>\n"+'        <script type="text/javascript" src="'+AGN.url("/js/lib/jquery/jquery-3.5.1.js",true)+'"><\/script>\n'+'        <script type="text/javascript" src="'+AGN.url("/assets/js/vendor/pickadate-3.5.6.js",true)+'"><\/script>\n'+'        <script type="text/javascript" src="'+AGN.url("/assets/js/vendor/pickadate-3.5.6.date.js",true)+'"><\/script>\n'+'        <script type="text/javascript" src="'+AGN.url("/js/lib/formbuilder/generated-form.js",true)+'"><\/script>\n'+'        <link rel="stylesheet" href="'+AGN.url("/assets/form.css",true)+'">'+"        {{ if (cssUrl) { }}\n"+'        <link rel="stylesheet" href="{{- cssUrl }}">\n'+"        {{ } }}\n"+"    </head>\n"+"    <body>\n"+'        <div class="container" style="margin-top: 50px;">\n'+'            <form action="form.action">\n'+"                {{= generatedHTML}}\n"+"            </form>\n"+"        </div>\n"+"    </body>\n"+"</html>";var o=AGN.Lib.Confirm;var a;var n=["required","label","description","name","className","placeholder","value"];a=function(e,t){this.options=$.extend({},t);var i=this;i.$el=$(e);i.$target=$(this.$el.data("target"));i.initCustomControls();i.builder=i.$el.formBuilder(a.getBuilderDefaultOptions(i));i.defered=$.Deferred();if(i.options.data){i.setJson(i.options.data)}i.builder.promise.then(function(){i.builder=i.$el.data("formBuilder");i.defered.resolve()})};a.getBuilderDefaultOptions=function(e){return{roles:{},disabledAttrs:["access","description"],disableFields:["file","autocomplete"],defaultFields:a.defaultFields(e),disabledActionButtons:["data","save"],actionButtons:[{id:"downloadHtml",className:"btn btn-info",label:t("workflow.reaction.download"),type:"button",events:{click:function(){e.downloadHtml.bind(e)()}}},{id:"generateHtml",className:"btn btn-success",label:t("userform.formBuilder.generateHtml"),type:"button",events:{click:function(){e.generateHtmlToTarget.bind(e)()}}}],editOnAdd:true,typeUserDisabledAttrs:{formName:n,mediapool:n,text:["subtype"],textarea:["subtype"]},typeUserAttrs:c(e),layoutTemplates:{agnMediapool:function(){return document.createElement("span")}},fields:[{type:"text"},{type:"hidden"},{type:"select"},{type:"radio-group"},{type:"checkbox-group"},{type:"number"},{type:"textarea"},{type:"date"}],templates:{text:r.default,hidden:r.hidden,textarea:r.default,date:r.default,select:r.default,"radio-group":r.default,"checkbox-group":r.default,number:r.default},controls:e.controls,i18n:{locale:window.adminLocale,location:AGN.url("/js/lib/formbuilder/translation/")},controlOrder:["header","paragraph","mediapool","","text","date","textarea","number","","select","radio-group","checkbox-group","","hidden","formName","button"],inputSets:a.getDefaultPresetsConfig(e)}};a.defaultFields=function(e){return[{type:"hidden",name:"agnCTOKEN",value:e.options.companyToken},{type:"hidden",name:"agnUID",value:"$!agnUID"}]};a.getDefaultPresetsConfig=function(e){return[{label:u(t("userform.formBuilder.template.subscribe")),name:"subscribe",fields:[{type:"hidden",name:"agnCTOKEN",value:e.options.companyToken,label:" "},{type:"hidden",name:"agnMAILINGLIST",value:"",label:" "},{type:"hidden",name:"agnSUBSCRIBE",value:"1",label:" "},{type:"hidden",name:"agnUID",value:"$!agnUID",label:" "},{type:"text",name:"firstname",value:"$!customerData.firstname",emmField:"firstname",label:"Firstname:"},{type:"text",name:"lastname",value:"$!customerData.lastname",emmField:"lastname",label:"Lastname:"},{type:"text",name:"email",value:"$!customerData.email",emmField:"email",label:"Email:"},{type:"button",subtype:"submit",style:"primary",label:"Subscribe"},{type:"formName",label:" "}]},{label:u(t("userform.formBuilder.template.unsubscribe")),name:"unsubscribe",fields:[{type:"hidden",name:"agnCTOKEN",value:e.options.companyToken,label:" "},{type:"formName",label:" "},{type:"hidden",name:"agnUID",value:"$!agnUID",label:" "},{type:"button",subtype:"submit",style:"primary",label:"Unsubscribe"}]},{label:u(t("userform.formBuilder.template.profile_change")),name:"profile_change",fields:[{type:"hidden",name:"agnCTOKEN",value:e.options.companyToken,label:" "},{type:"hidden",name:"agnUID",value:"$!agnUID",label:" "},{type:"formName",label:" "},{type:"text",name:"firstname",value:"$!customerData.firstname",emmField:"firstname",label:"Firstname:"},{type:"text",name:"lastname",value:"$!customerData.lastname",emmField:"lastname",label:"Lastname:"},{type:"text",name:"email",value:"$!customerData.email",emmField:"email",label:"Email:"},{type:"button",subtype:"submit",style:"primary",label:"Subscribe"}]},{label:u(t("userform.formBuilder.template.other")),name:"other",fields:[{type:"hidden",name:"agnCTOKEN",value:e.options.companyToken,label:" "},{type:"hidden",name:"agnUID",value:"$!agnUID",label:" "}]}]};a.get=function(e,t){var i=$(e);var n=i.data("_form-builder");if(n){return n}n=new a(e,t);i.data("_form-builder",n);return n};a.isCreated=function(e){return!!$(e).data("_form-builder")};a.prototype.initCustomControls=function(){this.controls=[];e.pushControl(this.controls,i.mediapool(this));e.pushControl(this.controls,i.nextform(this))};a.prototype.generateHtml=function(){var e=this.builder.actions.getData();var t=this.options.cssUrl;var i=$("<form/>");i.formRender({formData:e,controls:this.controls,templates:{date:r.dateForRender}});var n;if(s){n=_.template(s)({generatedHTML:i.html(),cssUrl:t})}else{n=i.html()}i.remove();n=d(n);return n};a.prototype.generateHtmlToTarget=function(){var e=this;var t=this.$target;if(!t){return}var i=AGN.Lib.Editor.get(t);if(!i){return}var n=this.options.confirmationModal;if(!n||!i.val()){l(e,i);return}o.createFromTemplate({},"warning-html-generation-modal").done(function(){l(e,i)})};a.prototype.downloadHtml=function(){var e=this.generateHtml();var t=window.btoa(e);var i="Generated form.txt";if(this.options.formName){i=this.options.formName+".txt"}var n=document.createElement("a");n.setAttribute("href","data:application/octet-stream;charset=utf-8;base64,"+t);n.setAttribute("download",i);n.style.display="none";document.body.appendChild(n);n.click();document.body.removeChild(n)};a.prototype.getJson=function(){return this.builder.actions.getData("json",false)};a.prototype.getData=function(){return this.builder.actions.getData()};a.prototype.setJson=function(e){var t=this;t.defered.done(function(){return t.builder.actions.setData(e)})};a.prototype.promise=function(){return this.defered.promise()};a.prototype.getInitJson=function(){return JSON.stringify(this.options.data)};a.prototype.isChanged=function(){var e=this;if(e.options.data){return e.getInitJson()!==e.getJson()}else{return _.isEqual(e.getData(),a.defaultFields(e))}};function l(e,i){i.val(e.generateHtml());AGN.Lib.Messages(t("defaults.success"),t("userform.formBuilder.success.htmlGenerated"),"success")}function c(i){var n={formName:{formName:{label:t("userform.formBuilder.formName"),options:i.options.namesJson.reduce(function(e,t){e[t]=t;return e},{})}},mediapool:{image:{label:t("userform.formBuilder.mediapoolImage"),options:i.options.mediapoolImages},alt:{label:t("userform.formBuilder.imageAlt"),value:""},width:{label:t("userform.formBuilder.imageWidth"),value:0},height:{label:t("userform.formBuilder.imageHeight"),value:0}},date:{emmField:{label:t("userform.formBuilder.emmField"),options:i.options.dateProfileFields}},number:{emmField:{label:t("userform.formBuilder.emmField"),options:i.options.numberProfileFields}},select:{emmField:{label:t("userform.formBuilder.emmField"),options:i.options.profileFieldsForSelect}}};var e=["text","hidden","textarea","radio-group","checkbox-group"];e.forEach(function(e){n[e]={emmField:{label:t("userform.formBuilder.emmField"),options:i.options.textProfileFields}}});return n}function u(e){return t("userform.formBuilder.template.template")+": "+e}function d(e){if(!e||e.length<=0){return e}return e.replace(/<\/.*?>/g,"$&\n")}AGN.Lib.FormBuilder.FormBuilder=a})();AGN.Lib.CoreInitializer.new("ace",function(e){if(!e){e=$(document)}_.each(e.find(".js-editor, .js-editor-text, .js-editor-eql, .js-editor-css"),function(e){AGN.Lib.Editor.get($(e))})});(()=>{AGN.Lib.CoreInitializer.new("checkbox-hider",function(e=$(document)){_.each(e.find("[data-show-by-checkbox]"),e=>{const t=$(e);const i=$(t.data("show-by-checkbox"));r(t,i,true);n(t,i,true)});_.each(e.find("[data-hide-by-checkbox]"),e=>{const t=$(e);const i=$(t.data("hide-by-checkbox"));r(t,i,false);n(t,i,false)});_.each(e.find("[data-show-by-select]"),e=>{const t=$(e);const i=$(t.data("show-by-select"));const{showBySelectValues:n=""}=t.data();if(i.exists()&&(n!==""||t.is("[data-show-if-no-selection]"))){const r=n.toString().split(",").map(e=>e.trim());o(t,i,r,true);s(t,i,r,true)}});_.each(e.find("[data-hide-by-select]"),e=>{const t=$(e);const i=$(t.data("hide-by-select"));const{hideBySelectValues:n=""}=t.data();if(i.exists()&&n!==""){const r=n.toString().split(",").map(e=>e.trim());o(t,i,r,false);s(t,i,r,false)}})});function n(e,t,i){t.change(function(){r(e,t,i)})}function r(e,t,i){if(i){e.toggleClass("hidden",!t.is(":checked"))}else{e.toggleClass("hidden",t.is(":checked"))}AGN.Lib.CoreInitializer.run("truncated-text-popover",e)}function s(e,t,i,n){t.change(function(){o(e,t,i,n)})}function o(e,t,i,n){const r=t.val();const s=Array.isArray(r)?r:[r];const o=s.some(e=>i.includes(e));if(n){e.toggleClass("hidden",!(o||e.is("[data-show-if-no-selection]")&&s.length===0))}else{e.toggleClass("hidden",o)}e.closest("select").trigger("change.select2");AGN.Lib.CoreInitializer.run("truncated-text-popover",e)}})();(function(){var l=AGN.Lib.AutoSave;function c(e,t){var i=e.attr("id"),n=e.data("_editor");if(window.CKEDITOR&&CKEDITOR.instances[i]){CKEDITOR.instances[i].setData(t)}else if(n){n.val(t)}else{e.val(t)}}AGN.Lib.CoreInitializer.new("auto-save",["ace"],function(e){if(!e){e=$(document)}_.each(e.find("[data-autosave-scope]"),function(e){var t=$(e);var i=t.data("autosave-scope");var n=t.data("autosave-period");var r=t.all("[data-autosave]");if(r.length>0){function s(){r=r.filter(function(e,t){return document.body.contains(t)});if(r.length>0){var i={};_.each(r,function(e){var t=$(e);i["value#"+t.data("autosave")]=t.val()});return i}return false}function o(s){var e=$.map(r,function(e){var t=$(e);var i="value#"+t.data("autosave");if(i in s){var n=t.val();var r=s[i];if(n!=r){if(t.is("[data-autorestore]")){c(t,r)}else{return{target:t,value:r}}}return null}});if(e.length>0){return e}return false}function a(e){_.each(e,function(e){c(e.target,e.value)})}l.initialize(i,s,o,a,n)}})})})();(function(){const r=AGN.Lib.DateFormat;const s=AGN.Lib.Template;const i=AGN.url("/calendar/mailings.action");const n=AGN.url("/calendar/mailingsPopoverInfo.action");const t=AGN.url("/mailing/:mailingId:/settings.action");const o=AGN.url("/statistics/mailing/:mailingId:/view.action?init=true");class e{constructor(e,t,i){this.$el=e;this.firstDayOfWeek=t;this.statisticsViewAllowed=i;this.#init()}#init(){const e=new Date;this.#displayWeekDays();this.showMonth(e.getMonth(),e.getFullYear());this.$el.on("change","#month_list, #month_list_year",this.switchMonth.bind(this))}#displayWeekDays(){AGN.Lib.DateFormat.getLocalizedShortWeekdays(window.adminLocale,this.firstDayOfWeek).forEach(e=>{$("#calendar-header").append(`<td><div class="calendar-cell">${e}</div></td>`)})}showMonth(t,e){let i=new Date(e,t,1);let n=this.daysInMonth(t+1,e);let r=i.getDay()-this.firstDayOfWeek;if(r<0){r=7+r}let s=Math.ceil((n+r)/7);let o=new Date(e,t,1-r);let a=new Date(e,t,1+s*7);i=new Date(o);for(let e=0;e<s;e++){const l="row-"+(e+1);const c=this.#getWeek(i);$("#calendar-container").append(`<tr id="${l}"><td><div class="calendar-cell">${c}</div></td></tr>`);for(let e=0;e<7;e++){const u=i.getMonth()!==t;this.addDayToCalendar(i,l,u);i.setDate(i.getDate()+1)}}this.handleCalendarMailings(o,a);this.synchronizeMonthsList(t,e)}daysInMonth(e,t){return new Date(t,e,0).getDate()}removeCurrentCalendar(){$("#calendar-container tr:not(:first)").remove()}addDayToCalendar(e,t,i){const n=!i&&this.isToday(e);const r=this.dateToServiceFormat(new Date(e.getFullYear(),e.getMonth(),e.getDate()));const s="day-"+r;$("#"+t).append(`<td id="${s}"></td>`);$("#"+s).append(`<div class="calendar-cell calendar-day ${n?"calendar-day--today":""} ${i?"calendar-day--alien":""}" id="label-${s}" data-date="${r}">${e.getDate().toString().padStart(2,"0")}</div>`)}isToday(e){const t=new Date;t.setHours(0,0,0,0);e.setHours(0,0,0,0);return e.getTime()===t.getTime()}handleCalendarMailings(e,t){$.get(i,{startDate:this.dateToServiceFormat(e),endDate:this.dateToServiceFormat(t)}).done(e=>this.assignMailingsToCalendarDays(e))}assignMailingsToCalendarDays(e){e.forEach(e=>e.link=this.getMailingLink(e));const t=_.groupBy(e,"sendDate");this.makeDaysSelectable(t);this.makeCurrentDayActive(t)}makeCurrentDayActive(e){const t=this.dateToServiceFormat(new Date);$("#day-"+t).click(()=>this.changeSelectedDay(t,e[t]));this.changeSelectedDay(t,e[t])}makeDaysSelectable(r){_.forEach($(".calendar-day"),e=>{const t=$(e);const i=t.data("date");const n=r[i];if(!_.isEmpty(n)){$("#label-day-"+i).addClass("calendar-day--selectable")}t.click(()=>this.changeSelectedDay(i,_.sortBy(n,"sendTime")))})}changeSelectedDay(e,t){$("#calendar-container").find(".calendar-day--selected").removeClass("calendar-day--selected");$("#label-day-"+e).addClass("calendar-day--selected");const i=r.parseFormat(e,"dd-MM-yy");const n=i.toLocaleString(window.adminLocale,{weekday:"long"});e=AGN.Lib.DateFormat.format(i,window.adminDateFormat);$("#calendar-tile-day-mailings").html(s.dom("dashboard-schedule-day",{dayOfWeek:n,dateStr:e,dayMailings:t}));this.createPopovers(t)}createPopovers(e){if(!e?.length){return}const t=e.map(e=>e.mailingId).join(",");$.get(n,{mailingIds:t}).done(e=>e.forEach(e=>this.createPopover(e)))}createPopover(e){e.thumbnailUrl=AGN.url(this.getMailingThumbnailSrc(e.thumbnailComponentId,e.post));const t=s.dom("calendar-mailing-popover-content",e);const i=$(`.schedule__day-mailing[data-mailing-id="${e.mailingId}"]`);AGN.Lib.Popover.getOrCreate(i,{trigger:"hover",html:true,content:t})}getMailingThumbnailSrc(e,t){if(t){return"/assets/core/images/facelift/post_thumbnail.jpg"}if(e){return"/sc?compID="+e}return"/assets/core/images/facelift/no_preview.svg"}getMailingLink(e){return e.sent&&e.workstatus!=="mailing.status.test"&&this.statisticsViewAllowed?o.replace(":mailingId:",e.mailingId):t.replace(":mailingId:",e.mailingId)}switchMonth(){const e=parseInt($("#month_list option:selected").val());const t=parseInt($("#month_list_year option:selected").val());this.removeCurrentCalendar();this.showMonth(e,t);if(this.lastYearSelected()){this.addYearOption()}}addYearOption(){const e=$("#month_list_year");const t=parseInt(e.find("option:last").val(),10)+1;e.append($("<option></option>").val(t).text(t))}lastYearSelected(){return $("#month_list_year option:selected").index()===$("#month_list_year option").length-1}synchronizeMonthsList(e,t){let i=$("#month_list_year");i[0].selectedIndex=$("#month_list_year option[value = "+t+"]")[0].index;let n=$("#month_list");n[0].selectedIndex=$("#month_list option[value = "+e+"]")[0].index;AGN.runAll(i);AGN.runAll(n)}pad(e,t){let i=e+"";while(i.length<t)i="0"+i;return i}dateToServiceFormat(e){let t=this.pad(e.getDate(),2);let i=this.pad(e.getMonth()+1,2);let n=e.getFullYear();return t+"-"+i+"-"+n}#getWeek(e){var t=new Date(e.valueOf());var i=t.getFullYear();var n=t.getMonth();var r=t.getDate();if(this.firstDayOfWeek===0){r=r+1}n=n+1;var s=Math.floor((14-n)/12);var o=i+4800-s;var a=n+12*s-3;var l=r+Math.floor((153*a+2)/5)+365*o+Math.floor(o/4)-Math.floor(o/100)+Math.floor(o/400)-32045;var c=(l+31741-l%7)%146097%36524%1461;var u=Math.floor(c/1460);var d=(c-u)%365+u;return Math.floor(d/7)+1}}AGN.Lib.Calendar=e})();AGN.Lib.CoreInitializer.new("char-counter",["growing-textarea"],function(e=$(document)){_.each(e.find("[data-show-char-counter]"),function(e){const t=$(e);if(!t.is("input")&&!t.is("textarea")){return}i(t)});function n(e,i){e.text(t("fields.content.charactersEntered",i.val()?.length||0))}function r(e,t){let i=e.find(".tile-footer");if(!i.exists()){i=$('<div class="tile-footer text-dark fs-3 bg-transparent border-top">');e.append(i)}i.prepend(t)}function i(e){const t=$('<span class="text-truncate">');if(e.data("show-char-counter")==="tile-footer"){r(e.closest(".tile"),t)}else{const i=e.is("textarea")?e.parent():e;i.before($(`<div class="char-counter"></div>`).append(t))}n(t,e);e.on("change input editor:create editor:change",_.throttle(()=>n(t,e),100))}});AGN.Lib.CoreInitializer.new("colorpicker",function(e=$(document)){const t=AGN.Lib.Colorpicker;e.find(".js-colorpicker").each(function(){const e=$(this);if(!t.get(e)){new t(e)}})});AGN.Lib.CoreInitializer.new("csrf",function(e=$(document)){e.find('meta[name="_csrf_header"]').each(function(){window.csrfHeaderName=$(this).attr("content");window.csrfCookieName=window.csrfHeaderName});e.find('meta[name="_csrf_parameter"]').each(function(){window.csrfParameterName=$(this).attr("content")});if(AGN.Lib.CSRF.isProtectionEnabled()){e.find(`div > input[type="hidden"][name="${window.csrfParameterName}"]:only-child`).parent("div").hide()}});(function(){AGN.Lib.CoreInitializer.new("dark-theme",function(){if($("body").hasClass("dark-theme")){$("iframe").each(function(){var e=$(this);e.on("load.iframe",function(){e.contents().find("body").addClass("dark-theme")})})}})})();(()=>{const f=AGN.Lib.Helpers;const g="agn:datepicker-opt";AGN.Lib.CoreInitializer.new("datepicker",function(e=$(document)){_.each(e.find(".js-datepicker"),e=>{const i=$(e);i.removeClass("hasDatepicker");let n={showWeek:true,changeMonth:true,changeYear:true,selectOtherMonths:true,dateFormat:window.adminDateFormat,showButtonPanel:true,showOtherMonths:true,weekHeader:t("calendar.common.weekNumber"),monthNamesShort:t("date.monthsFull"),dayNamesMin:t("date.weekdaysShort"),onUpdateDatepicker:function(e){h(i);p(e.dpDiv,i)},beforeShow:function(e,t){if(i.attr("readonly")){return false}t.dpDiv.removeClass("hidden");i.parent().addClass("is-active")},onClose:function(){i.parent().removeClass("is-active")}};n=_.merge({},n,f.objFromString(i.data("datepicker-options")));let r=n.dateFormat?.toLowerCase()?.replace(/d+/,"dd")?.replace(/m+/,"mm")?.replace(/y+/,"yyyy");i.inputmask(r,{placeholder:"_",showMaskOnHover:false});n.dateFormat=u(n.dateFormat);if(n.formatSubmit){n.altFormat=u(n.formatSubmit);n.altField=d(i,n.dateFormat,n.altFormat)}i.data(`${g}-initialMinDate`,n.minDate);i.data(`${g}-initialMaxDate`,n.maxDate);i.datepicker(n);i.datepicker("widget").addClass("hidden");const s=i.closest("[data-date-range]");if(s.exists()){const o=s.find(".js-datepicker");if(i.is(o.get(0))){n.minFor=$(o.get(1))}else{n.maxFor=$(o.get(0))}}if(n.maxFor){i.data(`${g}-maxFor`,n.maxFor);const a=()=>{c(n,i);const e=i.datepicker("getDate")||n.minDate;$(n.maxFor).datepicker("option","maxDate",e)};i.on("change",a);a()}if(n.minFor){i.data(`${g}-minFor`,n.minFor);const l=()=>{c(n,i);const e=i.datepicker("getDate")||n.maxDate;$(n.minFor).datepicker("option","minDate",e)};i.on("change",l);window.setTimeout(l,100)}c(n,i)});function c(e,t){if(e.minDate||e.maxDate){t.datepicker("setDate",$.datepicker.parseDate(e.dateFormat,t.val()))}}function u(e){return e.replace(/M/g,"m").replace(/D/g,"d").replace("YYYY","yyyy").replace("yyyy","yy")}function d(e,t,i){const n=s(e.val(),t,i);const r=$(`<input type="hidden" name="${e.attr("name")}" value="${n}">`);e.attr("name","");r.insertAfter(e);return r}function s(e,t,i){const n=$.datepicker.parseDate(t,e);return $.datepicker.formatDate(i,n)}function h(e){const i=$(".ui-datepicker-buttonpane");i.append(`
        <button id="clear-datepicker-btn" class="btn btn-inverse">
            <i class="icon icon-undo-alt"></i>
            <span class="text">${t("defaults.reset")}</span>
        </button>
      `);i.find("#clear-datepicker-btn").on("click",()=>r(e));if(i.find(".ui-datepicker-current").exists()){i.append(`
            <button id="today-datepicker-btn" class="btn btn-inverse">
                <i class="icon icon-calendar-alt"></i>
                <span class="text">${t("defaults.today")}</span>
            </button>
        `);i.find("#today-datepicker-btn").on("click",()=>n(e))}}function n(e){e.datepicker("setDate",new Date);e.datepicker("hide");e.trigger("change");e.blur()}function r(e){e.val("");e.datepicker("setDate",null);e.datepicker("hide");e.blur();i(e)}function i(e){if(e.data(`${g}-minFor`)){const t=$(e.data(`${g}-minFor`));t.datepicker("option","minDate",t.data(`${g}-initialMinDate`))}if(e.data(`${g}-maxFor`)){const i=$(e.data(`${g}-maxFor`));i.datepicker("option","maxDate",i.data(`${g}-initialMaxDate`))}}function p(e,t){o(t,e.find("select.ui-datepicker-month"));o(t,e.find("select.ui-datepicker-year"));AGN.runAll(e)}function o(e,t){t.addClass("form-control has-arrows");t.attr("data-select-options","minimumResultsForSearch: -1, dropdownParent: '#ui-datepicker-div'")}_.each(e.find(".js-timepicker"),function(e){let t=$(e),i,n,r={mask:"h:halfs",oncomplete:function(){t.trigger("timepicker:complete")},onincomplete:function(){t.trigger("timepicker:incomplete")}};i=_.merge({},r,f.objFromString(t.data("timepicker-options")));n=i.mask;delete i.mask;t.inputmask(n,i);t.attr("placeholder",t.data("_inputmask").opts.placeholder)})})})();AGN.Lib.CoreInitializer.new("delegate",function(e){if(!e){e=$(document)}e.all("[data-delegate]").each(function(){var e=$(this),i=e.data("delegate"),t=e.data("delegate-events")||"click";e.on(t,function(e){var t=$(i);if(t.length>0){t.trigger($.Event(e))}})})});(function(){var s=AGN.Lib.Helpers;AGN.Lib.CoreInitializer.new("display-dimensions",function(e){if(!e){e=$(document)}_.each(e.find("[data-display-dimensions]"),function(i){var e=$(i),t=s.objFromString(e.data("display-dimensions"))["scope"],n=e.parents(t),r=n.find("[data-dimensions]");e.ensureLoad(function(){var e=i.naturalWidth,t=i.naturalHeight;r.html(e+" x "+t+" px")})})})})();AGN.Lib.CoreInitializer.new("dragster",function(e){if(!e){e=$(document)}e.find(".dropzone").each(function(){new Dragster(this)})});AGN.Lib.CoreInitializer.new("dropzone",function(){Dropzone.autoDiscover=false});AGN.Lib.CoreInitializer.new("editable-view",function(e=$(document)){const t=AGN.Lib.EditableView;const i=AGN.Lib.EditableTile;e.all(t.SELECTOR).each(function(){const e=$(this);new t(e,e.data("editable-view"))});if(e.is(i.SELECTOR)){t.get(e)?.add(e)}});AGN.Lib.CoreInitializer.new("endless-scroll",function(e=$(document)){e.find("[data-endless-scroll]").each(function(){const e=$(this);let t={};if(e.is("[data-endless-scroll-opts]")){const i=AGN.Lib.Helpers.objFromString(e.data("endless-scroll-opts"));t=_.extend(t,i)}new AGN.Lib.EndlessScroll(e,e.data("endless-scroll"),t)})});(()=>{const i=AGN.Lib.Form;AGN.Lib.CoreInitializer.new("form",["select","switchable-input"],function(e=$(document)){e.find("form input[type=text], form input[type=password]").on("keyup keypress",function(e){const t=e.keyCode||e.which;if(t===13){e.preventDefault();return false}});const t=e.all("form[data-form-focus]").first();if(t.exists()){setTimeout(()=>{const e=t.find(`[name="${t.data("form-focus")}"]`);if(e.exists()&&!e.is(":disabled")&&!e.is(":hidden")){e.trigger("focus");i.scrollToField(e)}},10)}_.each(e.all("form"),e=>i.get($(e)))})})();AGN.Lib.DomInitializer.new("formbuilder",function(e=$(document)){var i=AGN.Lib.Tooltip;var r=this.config;var n=$("script#"+CSS.escape("config:formbuilderCommon")+'[type="application/json"]');if(n.length===1){r=$.extend(n.json(),r)}_.each(e.find(".js-form-builder"),function(t){AGN.Lib.FormBuilder.FormBuilder.get(t,r).promise().then(function(){var e=$(t);e.find(".form-actions button").each(function(){var e=$(this);i.create(e,{title:e.text()})})})});_.each(e.find(".modal-js-form-builder"),function(e){var t=$(e).attr("data-target-formbuilder");if(!t){return}var i=$(t);if(!i){return}var n=AGN.Lib.FormBuilder.FormBuilder.get(i);AGN.Lib.FormBuilder.FormBuilder.get(e,r).setJson(n.getJson())});document.styleSheets[0].insertRule(`:root { --warn-dialog-title: "${t("defaults.warning")}"; }`,0)});AGN.Lib.CoreInitializer.new("growing-textarea",function(e=$(document)){e.all('textarea.form-control:not([class*="js-editor"])').each(function(){const e=$(this);if(!e.closest(".text-area-grow-wrapper").exists()){e.wrap('<div class="text-area-grow-wrapper"></div>')}e.trigger("input")})});AGN.Lib.CoreInitializer.new("hover-dropdown-btn",function(e=$(document)){const r="agn-isActivedDropdownMenu";_.each(e.find(".js-btn-dropdown"),e=>{const t=$(e);t.removeAttr("data-bs-toggle");const i=t.closest(".dropdown");const n=i.find(".dropdown-menu");t.attr("aria-expanded",false);t.data(r,false);t.on("mouseenter",()=>{n.css("transform",`translate(0px, ${t.outerHeight()+5}px)`);s(i,t,true)});n.on("mouseenter",()=>t.data(r,true));t.on("mouseleave",()=>{setTimeout(()=>{if(!t.data(r)&&!t.is(":hover")){s(i,t,false)}},400)});n.on("mouseleave",()=>{t.data(r,false);s(i,t,false)})});function s(e,t,i){t.attr("aria-expanded",i);e.toggleClass("open",i)}});AGN.Lib.CoreInitializer.new("icons-defs",function(e){if(!e){e=$(document)}_.each(e.find("[data-icon]"),function(e){var t=$(e);var i=AGN.url("assets/icons-defs.svg#"+t.data("icon"),true);t.html('<svg viewBox="0 0 45 45"><use xlink:href="'+i+'"/></svg>')});svg4everybody()});AGN.Lib.CoreInitializer.new("iframe",function(e=$(document)){e.find("iframe:not(.js-fixed-iframe)").each(function(){var s=this,o=$(this);if(o.hasClass("js-simple-iframe")){var e=o.parent(),t=e.parent(),a=parseInt(o.data("max-width")),l=parseInt(o.data("height-extra"))||10,c=o.data("media-query"),u=!!window.sidebar,i,d;i=function(){var e=s.contentDocument?s.contentDocument:s.contentWindow.document,t=e.body,i=e.documentElement,n,r;if(c){r=a}else{r=Math.max(t.scrollWidth,t.offsetWidth,i.clientWidth,i.scrollWidth,i.offsetWidth)}n=Math.min(t.scrollHeight,t.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight);o.height(n);n=Math.max(t.scrollHeight,t.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight);n+=l;o.height(n);if(o.data("max-width")!=="100%"){o.width(r)}if(c&&u){o.contents().find("body").css("overflow","hidden")}d()};d=function(){t.width("auto");if(o.data("max-width")!=="100%"){if(o.width()>a&&a>t.width()){e.width(o.width())}else{e.width(Math.min(a,t.width()))}}};o.off("load.iframe");o.on("load.iframe",function(){window.setTimeout(function(){i();var e=$(s.contentDocument.body);if(typeof e.imagesLoaded==="function"){e.imagesLoaded().progress(_.throttle(i,100)).always(i)}$(window).off("viewportChanged.iframe",d);$(window).on("viewportChanged.iframe",d)},50)})}else{o.on("load.iframe",function(){window.setTimeout(function(){o.iFrameResize({heightCalculationMethod:"grow",enablePublicMethods:true})},50)})}})});AGN.Lib.CoreInitializer.new("image-editor",function(e){if(!e){e=$(document)}_.each(e.find("#editor-canvas"),function(e){var s=e.getContext("2d");var o=new Image;o.src=$("#editor-img").attr("src");$("#editor-result").val("");o.onload=function(){var e=o.width;var t=o.height;s.canvas.width=e;s.canvas.height=t;s.drawImage(o,0,0,e,t);$("#l-editor-img-width").attr("value",e);$("#l-editor-img-height").attr("value",t);$("#l-editor-img-percent").attr("value",100);var i=e+$("#l-img-editor-tools").width()+10;$("#l-img-editor").css("min-width",i);var n=$("#editor-img").data("content-type");var r=s.canvas.toDataURL(n);$("#editor-result").attr("value",r)}})});(function(){var r=AGN.Lib.Helpers;AGN.Lib.CoreInitializer.new("input-mask",function(e){if(!e){e=$(document)}_.each(e.find(".js-inputmask"),function(e){var t=$(e);var i;var n;i=_.merge({},r.objFromString(t.data("inputmask-options")));n=i.mask;delete i.mask;t.inputmask(n,i)})})})();AGN.Lib.CoreInitializer.new("input-table",function(e=$(document)){_.each(e.find("[data-input-table]"),e=>new AGN.Lib.InputTable($(e)))});$.fn.queryBuilder.defaults({templates:{group:`
<dl id="{{= it.group_id }}" class="rules-group-container">
  <dt class="rules-group-header">
    <div class="group-conditions radio-switch">
      {{~ it.conditions: condition }}
        <input id="qb-codition-btn-{{= condition }}-group-{{= it.group_id }}" type="radio" name="{{= it.group_id }}_cond" value="{{= condition }}">
        <label for="qb-codition-btn-{{= condition }}-group-{{= it.group_id }}">{{= it.translate("conditions", condition) }}</label>
      {{~}}
    </div>
    
    <div class="group-actions">
      <button type="button" class="btn btn-inverse btn-icon" data-add="rule" data-tooltip="{{= it.translate("add_rule") }}">
        <i class="{{= it.icons.add_rule }}"></i>
      </button>
      {{? it.settings.allow_groups===-1 || it.settings.allow_groups>=it.level }}
        <button type="button" class="btn btn-inverse btn-icon" data-add="group" data-tooltip="{{= it.translate("add_group") }}">
          <i class="{{= it.icons.add_group }}"></i>
        </button>
      {{?}}
      {{? it.level>1 }}
        <button type="button" class="btn btn-danger btn-icon" data-delete="group" data-tooltip="{{= it.translate("delete_group") }}">
          <i class="{{= it.icons.remove_group }}"></i>
        </button>
      {{?}}
    </div>
    
    {{? it.settings.display_errors }}
      <div class="error-container"><i class="{{= it.icons.error }}"></i></div>
    {{?}}
  </dt>
  <dd class=rules-group-body>
    <ul class=rules-list></ul>
  </dd>
</dl>`}});$.fn.queryBuilder.defaults({templates:{rule:`
<li id="{{= it.rule_id }}" class="rule-container">
  <div class="rule-header">
    <div class="rule-actions">
      <button type="button" class="btn btn-icon btn-danger" data-delete="rule">
        <i class="{{= it.icons.remove_rule }}"></i>
      </button>
    </div>
    <div class="rule-operator-conditions-container"></div>
  </div>
  {{? it.settings.display_errors }}
    <div class="error-container"><i class="{{= it.icons.error }}"></i></div>
  {{?}}
  <div class="rule-filter-container"></div>
  <div class="rule-operator-container"></div>
  <div class="rule-value-container"></div>
</li>`}});$.fn.queryBuilder.defaults({templates:{filterSelect:`
{{ var optgroup = null; }}
<select class="form-control" name="{{= it.rule.id }}_filter" data-select-options="dropdownAutoWidth: true">
  {{? it.settings.display_empty_filter }}
    <option value="-1">{{= it.settings.select_placeholder }}</option>
  {{?}}
  {{~ it.filters: filter }}
    {{? optgroup !== filter.optgroup }}
      {{? optgroup !== null }}</optgroup>{{?}}
      {{? (optgroup = filter.optgroup) !== null }}
        <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">
      {{?}}
    {{?}}
    <option value="{{= filter.id }}">{{= it.translate(filter.label) }}</option>
  {{~}}
  {{? optgroup !== null }}</optgroup>{{?}}
</select>`}});$.fn.queryBuilder.defaults({templates:{ruleValueSelect:'{{ var optgroup = null; }} <select class="form-control js-select" name="{{= it.name }}" {{? it.rule.filter.multiple }}multiple{{?}}>   {{? it.rule.filter.placeholder }}     <option value="{{= it.rule.filter.placeholder_value }}" disabled selected>{{= it.rule.filter.placeholder }}</option>   {{?}}   {{~ it.rule.filter.values: entry }}     {{? optgroup !== entry.optgroup }}       {{? optgroup !== null }}</optgroup>{{?}}       {{? (optgroup = entry.optgroup) !== null }}         <optgroup label="{{= it.translate(it.settings.optgroups[optgroup]) }}">       {{?}}     {{?}}     <option value="{{= entry.value }}">{{= entry.label }}</option>   {{~}}   {{? optgroup !== null }}</optgroup>{{?}} </select>'}});$.fn.queryBuilder.defaults({icons:{add_group:"icon icon-plus-circle",add_rule:"icon icon-plus",remove_group:"icon icon-trash-alt",remove_rule:"icon icon-trash-alt",error:"icon icon-exclamation-triangle"}});(()=>{AGN.Lib.CoreInitializer.new("load",function(e=$(document)){_.each(e.find("[data-load]"),e=>{window.setTimeout(()=>AGN.Lib.Load.load($(e)),100)})})})();AGN.Lib.DomInitializer.new("logon-complete",function(e){var t=AGN.Lib.Form.get(e);var n={};window.adminId=this.config.adminId;if(this.config){$.each(this.config.webStorageBundleNames,function(e,t){try{var i=AGN.Lib.Storage.get("web-storage#"+t);if(i!=null){n[t]=i}}catch(e){console.error(e)}});var i=AGN.Lib.Storage.get("login-page")||{};i.isFrameShown=!!this.config.isFrameShown;AGN.Lib.Storage.set("login-page",i)}t.setValue("webStorageJson",JSON.stringify(n));t.submit()});(()=>{const o=45e3;const a=3*60*6e4;AGN.Opt.Components.MailingContentLock={manageLock:function(e,t,i){if(e>0&&t){var n=Date.now();var r;var s=function(){if(n+a>Date.now()){$.ajax({url:AGN.url("/mailing/ajax/"+e+"/lock.action"),type:"POST",success:function(e){if(e.success!==true){clearInterval(r)}},statusCode:{404:function(){clearInterval(r)}}})}else{clearInterval(r);$(document).trigger("ajax:unauthorized");$.ajax({url:AGN.url("/logout.action"),type:"POST",success:function(){$("body").append(AGN.Lib.Template.text("session-expired"))}})}};r=setInterval(s,o);return true}else{AGN.Lib.Modal.fromTemplate("mailing-locked",{username:i});return false}}}})();AGN.Lib.DomInitializer.new("mailing-content-overview",function(e,t){const i=this.config;const n=$("#myDatePicker");const r=$("#myTimePicker");if(!t){var s=AGN.Lib.Storage.get("mailings-content-dynNameID");if(s){var o=$("tr[data-dyn-name-id='"+s.dynNameID+"']");if(o.exists()){var a=o.position().top;setTimeout(function(){$("body").scrollTop(a)},1);AGN.Lib.Storage.set("mailings-content-dynNameID",{dynNameID:0})}}}if(n.exists()){n.on("change",function(){const e=n.datepicker("getDate");$("#startDay").val(e?e.getDate():0);$("#startMonth").val(e?e.getMonth()+1:0);$("#startYear").val(e?e.getFullYear():0)});r.on("timepicker:complete",function(){var e=r.val();$("#startHour").val(e.substr(0,2));$("#startMinute").val(e.substring(3,5))});r.on("timepicker:incomplete",function(){$("#startHour").val(0);$("#startMinute").val(0)})}function l(){return!i.isMailingExclusiveLockingAcquired&&!AGN.Opt.Components.MailingContentLock.manageLock(i.mailingId,i.isMailingExclusiveLockingAcquired,i.anotherLockingUserName)}if(l()||!i.isEditableMailing){var c=$('[data-controls-group="editing"]');c.prop("disabled",true);c.addClass("disabled")}});AGN.Lib.DomInitializer.new("mailing-content-view",function(e){AGN.Lib.Storage.set("mailings-content-dynNameID",{dynNameID:e.data("dyn-name-id")})});AGN.Lib.Controller.new("mailing-followup-options",function(){var t;var i="";var e=[];this.addDomInitializer("mailing-followup-options",function(){t=$("#followUpType");i=$("#lightWeightMailingList");e=this.config.additionalOptions;r();i.on("change",function(){r()})});var n=function(){return AGN.Lib.Template.text("followupAdvertisingOptions",{items:e})};var r=function(){var e=AGN.Lib.Select.get(i).getSelectedValue();t.children(".advertisingOption").remove();if(e){$.ajax({type:"POST",url:AGN.url("/mailing/ajax/"+e+"/isAdvertisingContentType.action")}).done(function(e){if(e&&e.success){t.append(n())}})}}});AGN.Lib.DomInitializer.new("mediapool-image-pick",function(i){let e;AGN.Lib.Action.new({click:"tbody tr"},function(){if(e){n(e,false)}e=this.el;n(e,true)},i);AGN.Lib.Action.new({dblclick:"tbody tr"},function(){t(this.el)},i);this.addAction({click:"mpAcceptImage"},function(){t(e)});function t(e){if(e){const t=r(e);if(t){AGN.Lib.Confirm.get(i).positive(t)}}else{AGN.Lib.Messages.alert("messages.error.nothing_selected")}}function n(e,t){const i=e.find("input[type=checkbox]");e.toggleClass("picked",t);i.prop("checked",t)}function r(e){return e.find("[data-mediapool-image-info]").json()}});AGN.Lib.CoreInitializer.new("multi-editor",function(e=$(document)){const i=AGN.Lib.Helpers;const n=AGN.Lib.Modal;const r=AGN.Lib.FormBuilder.FormBuilder;const s=AGN.Lib.Editor;class o{constructor(e){const t=e.data("_multi_editor");if(t){return t}this.$el=e;this.$target=e.find("[data-enlarge-target]");if(!this.$target.exists()){this.$target=this.$el}this.$container=this.$target.parent();this.#init()}static defaultOptions(){return{btnText:t("defaults.apply")}}#init(){this.$resizeBtn.on("click",()=>this.resize());this.updateResizeBtn()}resize(){if(this.enlarged){this.apply()}else{this.enlarge()}this.updateResizeBtn()}enlarge(){this.toggleWysiwygIfSelected(false);this.createBackup();this.showModal();this.toggleWysiwygIfSelected(true)}createBackup(){this.backup={};_.each(this.editor$,e=>this.backup[$(e).attr("id")]=s.get($(e)).val());_.each(this.$el.find(".js-form-builder"),e=>this.backup[$(e).attr("id")]=r.get(e).getJson());_.each(this.$el.find("#queryBuilderRules"),e=>{const t=$(e).parent().prop("queryBuilder");this.backup["queryBuilderRules"]=t.getRules({allow_invalid:true,skip_empty:false})})}showModal(){const e=this.$resizeBtn.data("enlarged-modal")||"multi-editor-modal";const t=i.objFromString(this.$resizeBtn.data("modal-set"));this.$modal=n.fromTemplate(e,_.extend(o.defaultOptions(),t));this.$placeholder.replaceWith(this.$target);AGN.Lib.CoreInitializer.run("select",this.$target);this.$applyBtn.on("click",()=>this.resize());this.$modal.on("hide.bs.modal",()=>this.hideModal());this.$el.trigger("enlarged");s.get(this.editor$)?.resize()}hideModal(){if(!this.applyChanges){this.cancel()}this.applyChanges=false;this.updateResizeBtn()}cancel(){this.toggleWysiwygIfSelected(false);this.restore();this.$container.append(this.$target);AGN.Lib.CoreInitializer.run("select",this.$target);this.toggleWysiwygIfSelected(true)}restore(){Object.entries(this.backup).forEach(([e,t])=>{const i=`#${e}`;if(e==="queryBuilderRules"){$(i).parent().prop("queryBuilder")?.setRules(t)}else if(r.isCreated(i)){r.get(i).setJson(t)}else{this.$el.find(i).data("_editor")?.val(t)}})}apply(){this.applyChanges=true;this.toggleWysiwygIfSelected(false);n.getInstance(this.$modal).hide();this.$container.append(this.$target);AGN.Lib.CoreInitializer.run("select",this.$target);this.toggleWysiwygIfSelected(true)}toggleWysiwygIfSelected(e){if(this.wysiwygSelected){this.$el.trigger(e?"tile:show":"tile:hide")}}get editor$(){return this.$el.find(".js-editor")}get wysiwygSelected(){return this.$el.find('[data-multi-editor-option="wysiwyg"]').is(".active")}get enlarged(){return this.$target.closest(".modal").length>0}get $resizeBtn(){return this.$el.find("[data-enlarged-modal]")}get $applyBtn(){return this.$modal?.find("[data-apply-enlarged]")}get $placeholder(){return this.$modal?.find(".modal-body [data-placeholder]")}updateResizeBtn(){this.$resizeBtn.find("i").toggleClass("icon-expand-arrows-alt",!this.enlarged).toggleClass("icon-compress-arrows-alt",this.enlarged);AGN.Lib.Tooltip.remove(this.$resizeBtn);AGN.Lib.Tooltip.createTip(this.$resizeBtn,this.enlarged?"":t("defaults.enlargeEditor"))}}_.each(e.find("[data-multi-editor]"),e=>new o($(e)))});AGN.Lib.CoreInitializer.new("polling-form",function(e){if(!e){e=$(document)}e.find('[data-form="polling"]').each(function(){AGN.Lib.Form.get($(this)).submit()})});AGN.Lib.CoreInitializer.new("popout-window",function(e=$(document)){_.each(e.find("[data-popout-window]"),e=>{const t=$(e);const i=t.attr("src");if(!i){return}t.parent().append($("<figure>").append(t).append($(`
          <figcaption>
            <a class="link-dark-md clickable flex-center overflow-hidden" data-popup="${i}" data-bs-dismiss="modal">
                <span class="text-truncate">${i}</span>
                <i class="icon icon-external-link-alt"></i>
            </a>
          </figcaption>`)))})});AGN.Lib.CoreInitializer.new("popover",function(e=$(document)){const i=AGN.Lib.Popover;const n="data-popover";i.validate();e.all(`[${n}]`).each(function(){const e=$(this);const t=$.extend({content:$.trim(e.attr(n))},e.data("popover-options"));if(t.templateName){t.content=AGN.Lib.Template.text(t.templateName)}if(t.content){i.getOrCreate(e,t)}})});AGN.Lib.CoreInitializer.new("preview-table",function(e=$(document)){e.find("[data-preview-table]").each(function(){AGN.Lib.PreviewTable.init($(this))})});(()=>{AGN.Lib.CoreInitializer.new("target-group-query-builder-extend",function(){if(window.queryBuilderIsExtended){return}window.queryBuilderIsExtended=true;const u=2;let l={};function s(e,t){if(Math.sign(e)===-1){t.push("sub")}else{t.push("add")}}function d(e,t,i){if(i){if(i==="sub"){t="-"+Math.abs(t)}else{t="+"+Math.abs(t)}}e.$el.find("#date-filter").val(t)}const e=$.fn.queryBuilder;const r=e.constructor;const i=r.prototype.init;const o=r.prototype.validate;const a=r.prototype.bindEvents;l=r.utils;const c=r.selectors;Object.assign(c,{rule_include_empty:".rule-include-empty[name*=_include_empty]",rule_operator_conditions_container:".rule-operator-conditions-container",rule_header_inputs:".rule-header :input"});l.defineModelProperties(r.Rule,["includeEmpty"]);e.extend({init:function(e){this.on("afterCreateRuleInput",function(e,t){var i=e.builder.optionsByType[t.filter.type];if(i){var n=i.postCreate;if(n&&typeof n==="function"){n.call(e.builder,t,i)}}});this.on("afterUpdateRuleOperator",function(e,t){var i=e.builder.optionsByType[t.filter.type];if(i){var n=i.postOperatorUpdate;if(n&&typeof n==="function"){n.call(e.builder,t,i)}}});this.on("getGroupTemplate.filter getRuleTemplate.filter",function(e,t){const i=$(e.value);i.find(c.drag_handle).replaceWith(`
                        <button class="btn btn-icon btn-inverse drag-handle" type="button">
                            <i class="icon icon-arrows-alt"></i>
                        </button>
                    `);e.value=i.prop("outerHTML")});this.on("afterAddGroup",function(e,t){AGN.Lib.CoreInitializer.run("tooltip",t.$el)});this.setupInitialRule(e);return i.call(this,e)},isEmptyOrInitial:function(e){if(!e||!e.rules||!e.rules.length){return true}if(e.rules.length===1&&(e.rules[0].initialRule||e.rules[0].empty)){return true}return false},setupInitialRule:function(e){if(this.isEmptyOrInitial(e)){this.initialRule=true;e.rules=[{initialRule:true,empty:true}]}else{this.initialRule=false}},optionsByType:{date:{availableFormats:function(e){if(e&&e.type&&(e.type=="before"||e.type=="after")){return["YYYYMMDD"]}return["DD.MM.YYYY","YYYYMMDD","DDMMYYYY","MMDD","DDMM","DD","MM","YYYY"]},input:function(e,i){return $(` 
                            <div class="form-check form-switch">
                                <input id="${e.id}-today" name="today" type="checkbox" role="switch" class="form-check-input">
                                <label class="form-label form-check-label" for="${e.id}-today">${t("defaults.today")}</label>
                            </div>
                            <div class="input-group">
                                <input class="form-control rounded-2" type="text" id="date-filter"/>
                                <span id="date-offset-label" class="input-group-text input-group-text--dark hidden">${t("defaults.Days")}</span>
                            </div>
                            <div class="qb-dateformat-block">
                                <label class="form-label">
                                    <span>${t("date.formats.label")}</span>
                                    <a href="#" class="icon icon-question-circle" data-help="help_${this.settings.helpLanguage}/targets/DateFormat.xml"></a>
                                </label>
                                <select class="form-control" id="date-format" data-select-options="dropdownAutoWidth: true">
                                    ${n(i.availableFormats(i.operator))}
                                </select>
                            </div>
                        `)},postCreate:function(t){const i=t.$el.find("input[name=today]");const n=t.$el.find("#date-offset-label");const r=t.$el.find("#date-filter");const s=t.$el.find("#date-format");var e=function(){const e=i.prop("checked");n.toggleClass("hidden",!e);n.parent().find(".form-control").toggleClass("rounded-2",!e);r.off("change.offset keyup.offset");if(!t._updating_input){t._updating_value=true;if(e){r.val("+0")}else{r.val(h(new Date,s.val()))}t._updating_value=false}if(e){r.on("change.offset keyup.offset",function(e){var t=r.val();if(t){var i=parseInt(t);if(!isNaN(i)){var n=(i<0?"":"+")+i;if(n!=t){r.val(n)}}}else if(e.type==="change"){r.val("+0")}})}};i.on("change",e)},postOperatorUpdate:function(e,t){var i=e.$el.find("#date-format");i.html(n(t.availableFormats(e.operator)));i.change();i.trigger("change-date-format")},valueSetter:function(e,t){const i=t.slice(0);const n=e.$el.find("input[name=today]");const r=e.$el.find("#date-offset-label");const s=e.$el.find("#date-format");let o=false,a,l,c;if(t.length>u){if(i.shift()==="today"){o=true}c=i.shift();a=i.shift();l=i.shift()}else{c=i.shift();if(c==="today"){o=true;c="+0"}l=i.shift()}r.toggleClass("hidden",!o);r.parent().find(".form-control").toggleClass("rounded-2",!o);d(e,c,a);s.val(l);n.prop("checked",o).change()},valueGetter:function(e){var t=[],i=e.$el.find("#date-filter").val(),n=e.$el.find("#date-format").val(),r=e.$el.find("input[name=today]").is(":checked");if(r){t.push("today");t.push(i);s(i,t)}else{t.push(i)}t.push(n);return t},validate:function(e){if(e.length==2){var t=e[0];var i=e[1];if(t){if("today"!=t&&i){return p(t,i.toUpperCase())?true:["invalid_format"]}else{return true}}else{return["empty_date"]}}else if(e.length==4){var n=e[1];if(!n||n!=parseInt(n)){return["invalid_expression"]}}return true}}},clearInitialRuleSettings:function(){var e=this;e.initialRule=false;$(".initial-rule").removeClass("initial-rule")},isInitial:function(e){if(e.length===1&&e[0].$el.hasClass("initial-rule")){return true}if(this.initialRule&&e.length===1){e[0].$el.addClass("initial-rule");return true}return false},validate:function(e){var t=this;var i=t.model.root.rules;var n=_.clone(e);n=$.extend({skip_filter_validation:true,skip_empty:false},n);if(n.skip_filter_validation){n.skip_empty=true}if(this.isInitial(i)){t.clearErrors();return true}t.clearInitialRuleSettings();return o.call(this,n)},getRuleInput:function(e,t){var i=e.filter;var n=e.filter.validation||{};var r=e.id+"_value_"+t;var s=i.vertical?" class=block":"";var o="";if(typeof i.input==="function"){o=i.input.call(this,e,r)}else if(typeof e.operator.input==="function"){o=e.operator.input.call(this,e,r)}else if(this.optionsByType[e.filter.type]&&typeof this.optionsByType[e.filter.type].input==="function"){o=this.optionsByType[e.filter.type].input.call(this,e,this.optionsByType[e.filter.type],r)}else{switch(i.input){case"radio":case"checkbox":l.iterateOptions(i.values,function(e,t){o+="<label"+s+'><input type="'+i.input+'" name="'+r+'" value="'+e+'"> '+t+"</label> "});break;case"select":o=this.getRuleValueSelect(r,e);break;case"textarea":o+='<textarea class="form-control" name="'+r+'"';if(i.size)o+=' cols="'+i.size+'"';if(i.rows)o+=' rows="'+i.rows+'"';if(n.min!==undefined)o+=' minlength="'+n.min+'"';if(n.max!==undefined)o+=' maxlength="'+n.max+'"';if(i.placeholder)o+=' placeholder="'+i.placeholder+'"';o+="></textarea>";break;case"number":o+='<input class="form-control" type="number" name="'+r+'"';if(n.step!==undefined)o+=' step="'+n.step+'"';if(n.min!==undefined)o+=' min="'+n.min+'"';if(n.max!==undefined)o+=' max="'+n.max+'"';if(i.placeholder)o+=' placeholder="'+i.placeholder+'"';if(i.size)o+=' size="'+i.size+'"';o+=">";break;default:o+='<input class="form-control" type="text" name="'+r+'"';if(i.placeholder)o+=' placeholder="'+i.placeholder+'"';if(i.type==="string"&&n.min!==undefined)o+=' minlength="'+n.min+'"';if(i.type==="string"&&n.max!==undefined)o+=' maxlength="'+n.max+'"';if(i.size)o+=' size="'+i.size+'"';o+=">"}}return this.change("getRuleInput",o,e,r)},getRuleValueSelect:function(e,t){var i=this.templates.ruleValueSelect({builder:this,name:e,rule:t,icons:this.icons,settings:this.settings,translate:this.translate.bind(this)});return this.change("getRuleValueSelect",i,e,t)},updateRuleOperator:function(e,t){var i=e.$el.find(c.value_container);if(!e.operator||e.operator.nb_inputs===0){i.hide();e.__.value=undefined}else{i.css("display","");if(i.is(":empty")||!t||typeof t.input==="function"||typeof e.operator.input==="function"||e.operator.nb_inputs!==t.nb_inputs||e.operator.optgroup!==t.optgroup){this.createRuleInput(e)}}if(e.operator){e.$el.find(c.rule_operator).val(e.operator.type);e.__.value=this.getRuleInputValue(e);this.createExtendedOperatorConditions(e)}this.trigger("afterUpdateRuleOperator",e,t);this.trigger("rulesChanged")},createExtendedOperatorConditions:function(e){var i=this;var n=e.$el.find(c.rule_operator_conditions_container);if(e.operator.type==="not_equal"){e.includeEmpty=true;const r=$(`
                      <div class="form-check form-switch">
                        <input id="${e.id}_include_empty" type="checkbox" class="rule-include-empty form-check-input" name="${e.id}_include_empty" role="switch" checked="checked"/>
                        <label class="form-label form-check-label text-truncate" for="${e.id}_include_empty">${t("querybuilder.common.include_empty")}</label>
                      </div>`);n.html(r);const s=r.find(c.rule_include_empty);s.on("change",function(){e.includeEmpty=i.getRuleIncludeEmptyValue(e)});e.$el.find(c.rule_header_inputs).prop("disabled",e.flags.header_readonly)}else{e.includeEmpty=false;n.html("")}},createRuleOperators:function(e){var t=e.$el.find(c.operator_container).empty();if(!e.filter){return}var i=this.getOperators(e.filter);if(!e.filter.skipOperator){var n=$(this.getRuleOperatorSelect(e,i));t.html(n)}if(e.filter.default_operator){e.__.operator=this.getOperatorByType(e.filter.default_operator)}else{e.__.operator=i[0]}e.$el.find(c.rule_operator).val(e.operator.type);this.trigger("afterCreateRuleOperators",e,i);this.applyRuleFlags(e)},createRuleInput:function(e){var t=e.$el.find(c.value_container).empty();e.__.value=undefined;if(!e.filter||!e.operator||e.operator.nb_inputs===0){return}var i=this;var n=$();var r=e.filter;for(var s=0;s<e.operator.nb_inputs;s++){var o=$(this.getRuleInput(e,s));if(r.canBeNegated){var a=i.getNegateInput();t.prepend(a);n=n.add(a)}if(s>0)t.append(this.settings.inputs_separator);t.append(o);if(typeof r.values==="function"){r.values.call(this,o)}n=n.add(o)}t.css("display","");n.on("change "+(r.input_event||""),function(){if(!e._updating_input){e._updating_value=true;e.negated=i.getNegateValue(e);e.value=i.getRuleInputValue(e);e._updating_value=false}});if(r.plugin){n[r.plugin](r.plugin_config||{})}this.trigger("afterCreateRuleInput",e);if(r.default_value!==undefined){e.value=r.default_value}else{e._updating_value=true;e.negated=i.getNegateValue(e);e.value=i.getRuleInputValue(e);e._updating_value=false}this.applyRuleFlags(e)},setRuleInputValue:function(e,t){var i=e.filter;var n=e.operator;if(!i||!n){return}e._updating_input=true;if(i.valueSetter){i.valueSetter.call(this,e,t)}else if(typeof e.operator.valueSetter==="function"){e.operator.valueSetter.call(this,e,t)}else if(this.optionsByType[e.filter.type]&&typeof this.optionsByType[e.filter.type].valueSetter==="function"){this.optionsByType[e.filter.type].valueSetter.call(this,e,t)}else{var r=e.$el.find(c.value_container);if(n.nb_inputs===1){t=[t]}for(var s=0;s<n.nb_inputs;s++){var o=l.escapeElementId(e.id+"_value_"+s);switch(i.input){case"radio":r.find("[name="+o+'][value="'+t[s]+'"]').prop("checked",true).trigger("change");break;case"checkbox":if(!$.isArray(t[s])){t[s]=[t[s]]}t[s].forEach(function(e){r.find("[name="+o+'][value="'+e+'"]').prop("checked",true).trigger("change")});break;default:if(n.multiple&&i.value_separator&&$.isArray(t[s])){t[s]=t[s].join(i.value_separator)}r.find("[name="+o+"]").val(t[s]).trigger("change");break}}}this.setNegated(e);e._updating_input=false},getRuleInputValue:function(e){var t=e.filter;var i=e.operator;var n=[];if(t.valueGetter){n=t.valueGetter.call(this,e)}else if(typeof e.operator.valueGetter==="function"){n=e.operator.valueGetter.call(this,e)}else if(this.optionsByType[e.filter.type]&&typeof this.optionsByType[e.filter.type].valueGetter==="function"){n=this.optionsByType[e.filter.type].valueGetter.call(this,e)}else{var r=e.$el.find(c.value_container);for(var s=0;s<i.nb_inputs;s++){var o=l.escapeElementId(e.id+"_value_"+s);var a;switch(t.input){case"radio":n.push(r.find("[name="+o+"]:checked").val());break;case"checkbox":a=[];r.find("[name="+o+"]:checked").each(function(){a.push($(this).val())});n.push(a);break;case"select":if(t.multiple){a=[];r.find("[name="+o+"] option:selected").each(function(){a.push($(this).val())});n.push(a)}else{n.push(r.find("[name="+o+"] option:selected").val())}break;default:n.push(r.find("[name="+o+"]").val())}}n=n.map(function(e){if(i.multiple&&t.value_separator&&typeof e=="string"){e=e.split(t.value_separator)}if($.isArray(e)){return e.map(function(e){return l.changeType(e,t.type)})}else{return l.changeType(e,t.type)}});if(i.nb_inputs===1){n=n[0]}if(t.valueParser){n=t.valueParser.call(this,e,n)}}return this.change("getRuleValue",n,e)},getRuleIncludeEmptyValue:function(e){return e.$el.find(c.rule_include_empty).is(":checked")},validateValue:function(e,t){var i=e.filter.validation||{};var n=true;if(i.callback){n=i.callback.call(this,t,e)}else if(typeof e.operator.validate==="function"){n=e.operator.validate.call(this,t,e)}else if(this.optionsByType[e.filter.type]&&typeof this.optionsByType[e.filter.type].validate==="function"){n=this.optionsByType[e.filter.type].validate.call(this,t,e)}else{n=this._validateValue(e,t)}return this.change("validateValue",n,t,e)},getRules:function(s){s=$.extend({get_flags:false,allow_invalid:false,skip_empty:false},s);var e=this.validate(s);if(!e&&!s.allow_invalid){return null}var o=this;var t=function i(e){var r={condition:e.condition,rules:[]};if(e.data){r.data=$.extendext(true,"replace",{},e.data)}if(s.get_flags){var t=o.getGroupFlags(e.flags,s.get_flags==="all");if(!$.isEmptyObject(t)){r.flags=t}}e.each(function(e){if(!e.filter&&s.skip_empty){return}var t=null;if(!e.operator||e.operator.nb_inputs!==0){t=e.value}var i={id:e.filter?e.filter.id:null,field:e.filter?e.filter.field:null,type:e.filter?e.filter.type:null,input:e.filter?e.filter.input:null,operator:e.operator?e.operator.type:null,value:t,includeEmpty:e.includeEmpty};if(e.filter&&e.filter.data||e.data){i.data=$.extendext(true,"replace",{},e.filter.data,e.data)}if(e.filter&&e.filter.canBeNegated){i.negated=e.negated}if(s.get_flags){var n=o.getRuleFlags(e.flags,s.get_flags==="all");if(!$.isEmptyObject(n)){i.flags=n}}r.rules.push(o.change("ruleToJson",i,e))},function(e){var t=i(e);if(t.rules.length!==0||!s.skip_empty){r.rules.push(t)}},this);return o.change("groupToJson",r,e)}(this.model.root);t.valid=e;return this.change("getRules",t)},setRules:function(e,r){r=$.extend({allow_invalid:false},r);this.setupInitialRule(e);if($.isArray(e)){e={condition:this.settings.default_condition,rules:e}}if(!e||!e.rules||e.rules.length===0&&!this.settings.allow_empty){l.error("RulesParse","Incorrect data object passed")}this.clear();this.setRoot(false,e.data,this.parseGroupFlags(e));this.applyGroupFlags(this.model.root);e=this.change("setRules",e,r);var s=this;(function i(e,n){if(n===null){return}if(e.condition===undefined){e.condition=s.settings.default_condition}else if(s.settings.conditions.indexOf(e.condition)==-1){l.error(!r.allow_invalid,"UndefinedCondition",'Invalid condition "{0}"',e.condition);e.condition=s.settings.default_condition}n.condition=e.condition;e.rules.forEach(function(e){var t;if(e.rules!==undefined){if(s.settings.allow_groups!==-1&&s.settings.allow_groups<n.level){l.error(!r.allow_invalid,"RulesParse","No more than {0} groups are allowed",s.settings.allow_groups);s.reset()}else{t=s.addGroup(n,false,e.data,s.parseGroupFlags(e));if(t===null){return}s.applyGroupFlags(t);i(e,t)}}else{if(!e.empty){if(e.id===undefined){l.error(!r.allow_invalid,"RulesParse","Missing rule field id");e.empty=true}if(e.operator===undefined){e.operator="equal"}}t=s.addRule(n,e.data,s.parseRuleFlags(e));if(t===null){return}if(e.id){if(!e.empty){t.filter=s.getFilterById(e.id,!r.allow_invalid)}if(t.filter){t.operator=s.getOperatorByType(e.operator,!r.allow_invalid);if(!t.operator){t.operator=s.getOperators(t.filter)[0]}}t.negated=e.negated;if(t.operator&&t.operator.nb_inputs!==0){t.includeEmpty=!!e.includeEmpty;if(e.value!==undefined){t.value=e.value}else if(t.filter.default_value!==undefined){t.value=t.filter.default_value}}}if(s.change("jsonToRule",t,e)!=t){l.error("RulesParse","Plugin tried to change rule reference")}}});if(s.change("jsonToGroup",n,e)!=n){l.error("RulesParse","Plugin tried to change group reference")}})(e,this.model.root);this.validate();this.trigger("afterSetRules")},getNegateValue:function(e){var t=e.$el.find("select.negate"),i;if(t.length!==0){i=t.val()==="true"}return i},getNegateInput:function(){return $(`
                  <div class="qb-input-negate">
                    <select class="form-control js-select negate" data-select-options="dropdownAutoWidth: true">
                      <option value="false">${t("defaults.yes")}</option>
                      <option value="true">${t("defaults.no")}</option>
                    </select>
                  </div>
                `)},setNegated:function(e){var t=e.$el.find("select.negate");if(t.length!==0){t.val(""+e.negated)}},displayError:function(e){if(this.settings.display_errors){if(e.error===null){e.$el.removeClass("has-error")}else{var t=this.translate("errors",e.error[0]);t=this.constructor.utils.fmt(t,e.error.slice(1));t=this.change("displayError",t,e.error,e);e.$el.addClass("has-error").find(this.constructor.selectors.error_container).eq(0).attr("data-tooltip",t);AGN.Lib.CoreInitializer.run("tooltip",e.$el)}}},bindEvents:function(){a.call(this);var n=this;this.model.on("update",function(e,t,i){if(t instanceof r.Rule&&i==="includeEmpty"){n.updateRuleIncludeEmpty(t)}})},findRuleByField:function(e,t,i){var n=function(e){return e.hasOwnProperty("rules")};if(n(e)){var r=this;return e.rules.find(function(e){if(n(e)){return i?r.findRuleByField(e,i):false}else{return e.field&&e.field===t}})}else{return e.field&&e.field===t}},deleteRuleByField:function(e,t,i){var n=this;if(!e){e=n.model.root;if(!e){return}}var r=false;e.each("reverse",function(e){if(e&&e.filter&&e.filter.id==t){r&=n.deleteRule(n.getModel(e.$el))}},function(e){r&=n.deleteRuleByField(e,t,i)},n);return!!r},setOrReplaceRule:function(e,t,i){if(!e){e=this.getRules({allow_invalid:true,skip_empty:true})}if(t&&t.id){var n=this.findRuleByField(e,t.id,i);if(n){$.extend(n,t)}else{e.rules.push(t)}this.setRules(e);return true}else{return false}},containsNotEmptyRule:function(e){var t=this;var i=t.getModel(e);if(i.rules&&i.rules.length){return i.rules.every(function(e){if(e.hasOwnProperty("rules")){return t.containsNotEmptyRule(e)}else{return!!e.filter}})}else{return!!i.filter}}});r.prototype.updateRuleIncludeEmpty=function(e){var t=e.$el.find(c.rule_include_empty);t.prop("checked",e.includeEmpty);this.trigger("rulesChanged")}});function n(e){var n=[];e.forEach(function(e){var i=$("<option />");i.text(t("date.formats."+e));i.val(e);n.push($("<div/>").append(i).html())});return n.join("")}function h(e,t){return t.replace("DD",AGN.Lib.Helpers.pad(e.getDate(),2)).replace("MM",AGN.Lib.Helpers.pad(e.getMonth()+1,2)).replace("YYYY",AGN.Lib.Helpers.pad(e.getFullYear(),4))}function p(e,t){if(!e){return false}var i=o(t);if(i){for(var n=0;n<i.length;n++){var r=i[n];if(r.isDigitFragment){if(r.isLenient){var s=e.match("^\\d{1,"+r.lexeme.length+"}");if(s){e=e.substring(s[0].length)}else{return false}}else{if(e.length<r.lexeme.length){return false}if(!e.substr(0,r.lexeme.length).match(/^\d+$/)){return false}e=e.substring(r.lexeme.length)}}else{if(e.startsWith(r.lexeme)){e=e.substring(r.lexeme.length)}else{return false}}}return!e}return false}function a(e){var t=["DD","MM","YYYY",".","-","_"];if(e){for(var i=0;i<t.length;i++){if(e.startsWith(t[i])){return t[i]}}}return false}function o(e){var t=["DD","MM","YYYY"];var i=[];while(e){var n=a(e);if(n){var r=false;var s=false;if(t.includes(n)){r=true;s=true;if(i.length){var o=i[i.length-1];if(o.isDigitFragment){o.isLenient=false;s=false}}}i.push({lexeme:n,isDigitFragment:r,isLenient:s})}else{return false}e=e.substring(n.length)}return i.length?i:false}})();AGN.Lib.DomInitializer.new("recipient-report-initializer",function(e){if(!$("body").hasClass("dark-theme")){return}const t=e.find("iframe");t.on("load.iframe",function(){i(t)});function i(e){const t=e.contents().find("body");const i=t.find("center");if(i.length){t.css("background-color","var(--main-bg-color)");i.css("background-color","var(--main-bg-color)")}else{e.contents().find("body").css("color","#fff")}}});AGN.Lib.CoreInitializer.new("relative-href",function(e){if(!e){e=$(document)}e.find("a[data-relative]").each(function(){var e=$(this);e.attr("href",AGN.url(e.attr("href")));e.removeAttr("data-relative")})});AGN.Lib.CoreInitializer.new("restore",function(e=$(document)){const t=AGN.Lib.Storage;_.each(e.find("[data-restore-fields]"),e=>{t.restoreChosenFields($(e));i($(e))});function i(e){return e.on("change",function(){return t.saveChosenFields($(this))})}});(()=>{const n=AGN.Lib.Scrollbar;AGN.Lib.CoreInitializer.new("scrollable",["table"],function(e=$(document)){_.each(e.find(".js-scrollable, .table-wrapper__body, .ag-body-viewport"),e=>{const t=$(e);const i=n.get(t,false);if(AGN.Lib.Helpers.isMobileView()){i?.destroy();return}if(i){i.update()}else{new n(t)}})})})();(()=>{const c=AGN.Lib.Template;const u=AGN.Lib.Select;const d="agn:select-scrollbar";AGN.Lib.CoreInitializer.new("select",["template"],function(e=$(document)){_.each(e.all("select"),e=>{const n=$(e);if(n.data("select2")){n.select2("destroy")}if(n.hasClass("has-arrows")){new m(n)}let i={placeholder:n.attr("placeholder"),minimumResultsForSearch:10,showSearchIcon:true,width:"100%",searchInputPlaceholder:t("tables.searchOoo"),dropdownCssClass:":all:",selectionCssClass:":all:",dropdownParent:g(n),preventPlaceholderClear:false};if(!n.hasClass("js-select")){i.minimumResultsForSearch=0}if(n.is("[data-sort]")){if(n.data("sort")==="alphabetic"){i.sorter=function(e){e.sort((e,t)=>{if($(e.element).is("[data-no-sort]")){return-1}else if($(t.element).is("[data-no-sort]")){return 1}return e.text.toLowerCase().localeCompare(t.text.toLowerCase())});return e}}}if(n.prop("multiple")){i.matcher=p}const r=n.data("result-template");i.templateResult=function(e){if(e.loading){return e.text}if($(e.element).hasClass("hidden")){return null}if(!r){return e.text}return c.dom(r,{element:e.element,isDisabled:e.disabled,text:e.text,title:e.title,value:e.id})};const s=n.data("selection-template");i.templateSelection=function(e){return c.dom(s||"select2-result",{element:Array.isArray(e.element)?e.element[0]:e.element,isDisabled:e.disabled,text:e.text,title:e.title,value:e.id})};if(n.hasClass("dynamic-tags")){i.tags=true;i.preventPlaceholderClear=true}if(n.is("[data-select-options]")){const a=AGN.Lib.Helpers.objFromString(n.data("select-options"));i=_.extend(i,a)}if(i.alignDropdownRight){$(i.dropdownParent).addClass("align-dropdown-right-container")}if(i.tags&&!i.tokenSeparators){i.tokenSeparators=[","," ",";"]}if(n.is("[data-select-tree]")){h(n);n.select2ToTree(i)}else{n.select2(i)}if(n.is("[data-show-create-btn]")||i.tags){const l=f(n);if(i.tags){AGN.Lib.Tooltip.createTip(l,t("defaults.add"));l.on("click",function(){const e=n.data("select2").selection.$search.val();AGN.Lib.Select.get(n).selectOption(e)})}}n.on("select2:open",e=>{const t="scroll.select2";$(e.target).parents().off(t);$(window).off(t);window.setTimeout(()=>{const e=n.data("select2").$dropdown.find(".select2-results__options");n.data(d,new AGN.Lib.Scrollbar(e,{wheelSpeed:.2}))},20)});n.on("select2:closing",e=>n.data(d)?.destroy());const o=n.find("option[data-exclusive]");if(o.length>0){n.on("select2:select",function(e){var t=n.find(`option[value='${e.params.data?.element?.value}'][data-exclusive]`).length>0;if(t){var i=false;n.find("option:selected:not([data-exclusive])").each(function(){i=true;u.get(n).unselectValue($(this).val())});if(i){n.trigger("change")}}else{i=false;n.find("option:selected[data-exclusive]").each(function(){i=true;u.get(n).unselectValue($(this).val())});if(i){n.trigger("change")}}})}})});function h(e){const t=e.find("option");const i=t.map(function(){return String($(this).data("parent")||"")}).get();t.each(function(){const e=$(this);if(e.val()&&i.includes(e.val())){e.attr("data-pup","parent")}else{if(e.data("parent")){e.attr("data-pup",e.data("parent"))}}})}function p(e,t){if(t.selected){return null}if($.trim(e.term)===""){return t}const i=e.term.toLowerCase();const n=t.text.toLowerCase();return n.includes(i)?t:null}function f(e){const t=i(e.data("show-create-btn"));e.next(".select2-container").find(".select2-search").addClass("flex-grow-1").wrap($('<div class="d-flex gap-1"></div>')).parent().append(t);return t}function i(e){return $(`
        <button type="button" class="btn btn-icon btn-primary" ${e}>
          <i class="icon icon-plus"></i>
        </button>
    `)}function g(e){if(e.closest(".modal").exists()){return e.closest(".modal")}if(e.closest(".dropdown-menu").exists()){return e.closest(".dropdown-menu")}return $("#main-view").exists()?"#main-view":"body"}class m{constructor(e){const t=e.data("selectWithArrows");if(t){t.toggleArrows();return t}this.$select=e;this.init()}init(){this.#createPrevBtn();this.#createNextBtn();this.$select.wrap($("<div>").addClass("select-container"));this.$select.closest(".select-container").prepend(this.$prevBtn).append(this.$nextBtn);this.$select.on("change",()=>this.toggleArrows());this.toggleArrows();this.$select.data("selectWithArrows",this)}toggleArrows(){const e=this.$select.prop("selectedIndex");this.$prevBtn.prop("disabled",e===0);this.$nextBtn.prop("disabled",e===this.$select.find("option").length-1)}#createPrevBtn(){this.$prevBtn=this.#createArrowBtn(true);this.$prevBtn.on("click",()=>this.#stepBack())}#createNextBtn(){this.$nextBtn=this.#createArrowBtn(false);this.$nextBtn.on("click",()=>this.#stepForward())}#createArrowBtn(e){return $(`
         <button class="btn btn-outline-primary btn-icon btn-select-control">
           <i class="icon icon-caret-${e?"left":"right"}"></i>
         </button>
       `)}#stepForward(){this.#step(false)}#stepBack(){this.#step(true)}#step(e){const t=e?this.$prevBtn:this.$nextBtn;if(t.prop("disabled")){return}this.$select.prop("selectedIndex",this.$select.prop("selectedIndex")+(e?-1:1)).trigger("change");this.toggleArrows()}}})();AGN.Lib.DomInitializer.new("session-timer",function(){const i=10*60*1e3;const n=5*1e3;const r=401;const s=501;const e=this.config;const t=this.config.creationTime;const o=this.config.lastAccessedTime;let a=this.config.maxInactiveInterval;let l;let c=false;let u=true;let d=false;let h;if(e&&t&&o&&a){l=a*1e3+Date.now();p()}function p(){setInterval(function(){const e=Date.now();const t=l>e?l-e:0;if(!h){h=new b}if((!u||t<=i)&&!c&&!d){h.showTimerBlock(t)}if(!d&&!c&&l+n>e&&l<e){h.showLoading()}if(!c&&!d&&l+n<e){f()}},1e3)}function f(){$.ajax({url:AGN.url("/session/info.action"),global:false,beforeSend:g,success:m,error:v,complete:y})}function g(){d=true}function m(e){if(!!e){a=e.maxInactiveInterval;l=Date.now()+e.maxInactiveInterval*1e3;c=false}else{c=true;h.showSessionExpired()}}function v(e){if(e.status===r){c=true;h.showSessionExpired()}}function y(){d=false;u=false}$(document).ajaxComplete(function(e,t){if(!e.preventSessionTimer&&!c&&!d&&(t.status!==r&&t.status<s)){l=a*1e3+Date.now()}e.preventSessionTimer=true});class b{constructor(){this.timerBlock=$("#session-timer-block");this.timeLabel=$("#session-time-label");this.isSessionExpiredNotification=false;this.refreshIconClass="icon icon-spinner icon-pulse"}showTimerBlock(e){this.timerBlock.removeClass("hidden");this.printTimerText(e)}showSessionExpired(){this.printTimerText(0);if(!this.isSessionExpiredNotification){const e=AGN.Lib.Modal.fromTemplate("session-expired");e.on("modal:close",()=>AGN.Lib.Page.reload(AGN.url("/logonRedesigned.action")));this.isSessionExpiredNotification=true}}showLoading(){const e=`<i class="${this.refreshIconClass}"></i>`;this.changeTimeFieldContent(e)}printTimerText(e){let t="00:00";if(e>0){const i=new Date(e);const n=this.formatTimeComponent(i.getUTCMinutes());const r=this.formatTimeComponent(i.getUTCSeconds());t=`${n}:${r}`}this.changeTimeFieldContent(t)}formatTimeComponent(e){return e>0?e<10?"0"+e:e:"00"}changeTimeFieldContent(e){this.timeLabel.html(e)}}return false});AGN.Lib.CoreInitializer.new("slider",function(e=$(document)){_.each(e.find("[data-toggle-checkboxes]"),function(e){const t=$(e);r(t);n(t).click(()=>r(t));t.on("update-toggle-all",()=>r(t));i(t)});function i(e){e.on("click",function(){const t=$(this);_.each(t.closest(".tile").find(".tile-body [type=checkbox]:enabled:visible"),e=>$(e).prop("checked",t.is(":checked")))})}function n(e){return e.closest(".tile").find(".tile-body").find(".form-check-input:visible")}function r(e){const t=n(e);e.prop("checked",s(t));e.prop("disabled",o(t))}function s(e){return _.every(e.filter(":not(:disabled)"),e=>e.checked)}function o(e){return e.filter(":not(:disabled)").length===0}});AGN.Lib.CoreInitializer.new("switchable-input",function(e=$(document)){const t=AGN.Lib.ToggleVisField.STR;t.DATA_SHOW_ON_SWITCH="data-show-on-switch";t.DATA_HIDE_ON_SWITCH="data-hide-on-switch";t.BODY_SELECTOR=".switchable-input__body";class i{constructor(e){const t=e.data("switchableInput");if(t){return t}this.$el=e;this.#init()}#init(){this.$el.attr("data-field","toggle-vis");this.$checkbox.attr(t.DATA_FIELD_VIS,"").attr(t.DATA_FIELD_VIS_SHOW,this.#getShowOnSwitchElementSelector()).attr(t.DATA_FIELD_VIS_HIDE,this.#getHideOnSwitchElementSelector());this.$switch.prepend(this.#defaultVisHiddenInput());this.$el.data("switchableInput",this)}#getShowOnSwitchElementSelector(){return this.isSwapMode?`[${t.DATA_SHOW_ON_SWITCH}]`:t.BODY_SELECTOR}#getHideOnSwitchElementSelector(){return this.isSwapMode?`[${t.DATA_HIDE_ON_SWITCH}]`:""}#defaultVisHiddenInput(){return $('<div class="hidden"></div>').attr(t.DATA_FIELD_VIS_DEFAULT,"").attr(t.DATA_FIELD_VIS_HIDE,this.#getShowOnSwitchElementSelector()).attr(t.DATA_FIELD_VIS_SHOW,this.#getHideOnSwitchElementSelector())}get $switch(){return this.$el.find(".switchable-input__switch")}get $checkbox(){return this.$switch.find('[role="switch"]')}get isSwapMode(){return this.$body.find(`[${t.DATA_SHOW_ON_SWITCH}]`).length>0&&this.$body.find(`[${t.DATA_HIDE_ON_SWITCH}]`).length>0}get $body(){return this.$el.find(t.BODY_SELECTOR)}}_.each(e.find(".switchable-input"),function(e){new i($(e))})});AGN.Lib.CoreInitializer.new("sync",["ace"],function(e){if(!e){e=$(document)}_.each(e.find("[data-sync]"),function(e){var t=$(e),i=$(t.data("sync")),n=t.data("_editor");if(n){n.val(i.val())}else if(t?.prop("type")?.trim()==="checkbox"){t.prop("checked",i.val()==="true")}else{t.val(i.val())}})});(()=>{AGN.Lib.CoreInitializer.new("tab-related",function(e=$(document)){_.each(e.find("[data-tab-related]"),e=>{const t=$(e);const i=$(t.data("tab-related"));i.on("tile:show",()=>t.removeClass("hidden"));i.on("tile:hide",()=>t.addClass("hidden"))})})})();AGN.Lib.CoreInitializer.new("tab-toggle",function(e=$(document)){_.each(e.find("[data-toggle-tab]"),e=>AGN.Lib.Tab.init($(e)))});(()=>{AGN.Lib.CoreInitializer.new("table",function(e=$(document)){e.all(".fit-content").each(function(){const e=$(this);document.fonts.ready.then(()=>{e.width(o(e)+1)})});e.all("[data-js-table]").each(function(){const e=$(this);const t=e.all(".table-wrapper");const i=e.data("js-table");if(t.exists()&&i){const n=$(`script#${CSS.escape(i)}`);if(n.exists()){const r=n.json();let e;if(t.data("web-storage")){e=_.merge(AGN.Lib.WebStorage.get(t.data("web-storage"))||{},r.options||{})}else{e=r.options||{}}new AGN.Lib.Table(t,r.columns,r.data,e).applyFilter()}}});e.all(".table-wrapper__footer").each(function(){const e=$(this);const t=e.find(".pagination");if(t.exists()){const i=t.find("[data-page]").length;e.addClass(`table-wrapper__footer--pages-${i}`)}});e.all("table th:visible").each((e,t)=>i($(t)));if(AGN.Lib.Storage.get("truncate-table-text")===false){e.all("[data-toggle-table-truncation]").each((e,t)=>{$(t).closest(".table-wrapper").find(".table, .ag-body").toggleClass("no-truncate")})}e.all(".table-wrapper").on("table:redraw",e=>{const t=$(e.currentTarget).find(".ag-header-cell");i(t)});function i(e){e.off("mouseenter mouseleave");e.hover(t,n)}function t(e){const t=$(e.currentTarget);const i=t.is(".ag-header-cell")?t.find(".ag-header-cell-text"):t;if(i.length&&i[0].clientWidth<i[0].scrollWidth){const n=r(t);n.show()}}function n(e){AGN.Lib.Tooltip.get($(e.currentTarget))?.hide()}function r(e){const t=AGN.Lib.Tooltip.get(e);if(t){return t}return AGN.Lib.Tooltip.createTip(e,e.text(),"","manual")}s(e);$(window).on("displayTypeChanged",()=>s(e))});function s(e){e.all("tr.empty").each(function(){const e=$(this);const t=e.closest("table").find("th:visible").length;e.find("td").attr("colspan",t)})}function o(e){const t='<span class="table-cell-inline-wrapper" style="display: inline-flex">';e.contents().wrapAll(t);let i=e.children()?.first()?.width()||0;e.find(".table-cell-inline-wrapper").contents().unwrap();$(`td:nth-child(${e.index()+1})`).each(function(){const e=$(this);if(e.contents().length>0){e.contents().wrapAll(t);i=Math.max(i,e.find("span").first().width());e.find(".table-cell-inline-wrapper").contents().unwrap()}});return i}})();(function(){AGN.Lib.CoreInitializer.new("table-column-manager",function(e=$(document)){const t=AGN.Lib.TableColumnManager;e.all(t.SELECTOR).each(function(){new t($(this))})})})();(()=>{const l=AGN.Lib.Popover;function t(e){const t=e.find("[data-view-row]");if(t.length!==1){return}e.data("link",t.attr("href"));if(t.data("view-row")==="page"){e.data("load-page","true");e.wrap(`<a class="table-row-wrapper" href="${t.attr("href")}"></a>`)}else if(t.data("modal")){i(t,e)}t.remove()}function i(e,n){const r="data-";$.each(e[0].attributes,(e,t)=>{if(t.name.startsWith(r)&&!t.name!=="data-view-row"){const i=t.name.substring(r.length);n.attr(`data-${i}`,t.value)}})}function n(r){const s=r.find(".js-row-popover");if(s.length!==1||r.closest("table").hasClass("table--preview")){l.remove(r);return}let o=false;let a=null;const e=function(){if(o===false){o=$.Deferred();let e=s.children();if(!e.exists()){const t=$("<div></div>");t.css({position:"fixed",visibility:"hidden"});t.html(s.html());e=t.children();$(document.body).append(t);o.done(()=>{e.detach();t.remove()})}o.done(()=>{a=e});const n=e.find("img").add(e.filter("img")).filter(function(){return this.complete?null:this});if(n.length>0){o.done(()=>{const e=l.get(r);if(e){e.setContent();if(r.is(":hover")){r.popover("show")}}});const i=function(){let t=true;for(let e=0;e<n.length;e++){const i=n[e];if(i){if(i.complete){$(i).off("load error");n[e]=null}else{t=false}}}return t};for(let e=0;e<n.length;e++){$(n[e]).on("load error",function(){if(i()){o.resolve()}})}}else{o.resolve()}}return a};l.create(r,{delay:{show:300,hide:100},html:true,content:e})}AGN.Lib.CoreInitializer.new("table-row-actions",function(e=$(document)){e.find(".js-table").each(function(){$(this).find("tr").each(function(){const e=$(this);t(e);n(e)})})})})();(()=>{const A={header_readonly:true,filter_readonly:true,condition_readonly:true,operator_readonly:true,value_readonly:true,no_delete:true,no_add_rule:true,no_sortable:true,no_add_group:true};AGN.Lib.DomInitializer.new("target-group-query-builder",function(e){const s=this.config;const i=AGN.Lib.Form.getWrapper(e);const d="#targetgroup-querybuilder";const n=$(d);const o=s.mailTrackingAvailable;const a=s.isTargetGroupLocked;const l=s.helpLanguage;_.each(n,e=>{const t=$(e);const i=w();const n=p(s.queryBuilderFilters,{mail_tracking_available:o});const r=C(JSON.parse(s.queryBuilderRules),a);t.queryBuilder({filters:n,allow_empty:true,operators:i,helpLanguage:l,readonly:a,plugins:{sortable:{inherit_no_drop:true,inherit_no_sortable:true}},rules:r});AGN.Lib.CoreInitializer.run("select",t);t.on("afterSetRules.queryBuilder afterUpdateRuleFilter.queryBuilder afterCreateRuleFilters.queryBuilder afterAddRule.querybuilder",function(e){AGN.Lib.CoreInitializer.run("select",$(this))});t.on("link-values-set",function(e){AGN.Lib.CoreInitializer.run("select",$(e.target))});t.on("mailing-values-set values-set ",function(e){AGN.Lib.CoreInitializer.run("select",$(e.target))});t.on("change-date-format",function(e){AGN.Lib.CoreInitializer.run("select",$(e.target))});t.on("enterdown","input",function(e){return false})});const r=function(n,r){r=$.extend({ignore_qb_validation:false,skip_empty:false},r);_.each($(d),function(e){const t=$(e);const i=t.prop("queryBuilder");if(!c(n,i,r,t)){return false}})};n.on("qb:validation",r);i.off().on("validation",r);function c(e,t,i,n){t.clearInitialRuleSettings();if(i.ignore_qb_validation){return true}else if(t.validate({skip_filter_validation:false,skip_empty:i.skip_empty})){n.find("#queryBuilderRules").val(u(t,i.skip_empty));return true}else{n.trigger("qb:invalidrules");e.preventDefault();return false}}function u(e,t){return JSON.stringify(e.getRules({allow_invalid:true,skip_empty:t}))}function h(e,t){if(e.is("select")){AGN.Lib.Select.get(e).selectValueOrSelectFirst(t)}else{e.val(t)}}function p(e,t){if(e===null){e=[{id:"?",label:"?",type:"string"}]}else{const i={};e=e.filter(function(e){if(i[e.id]){return false}i[e.id]=true;return true})}g(e,t);return $.extend([],e)}function f(e){if(e){e.flags=A;_.each(e.rules,function(e){e.flags=A;if(e.hasOwnProperty("condition")){f(e)}})}return e}function g(e,i){i=$.extend({mail_tracking_available:false},i);const n=function(e){return $(`
          <div class="qb-select-container">
            <select id="${e.id}" class="form-control mailings js-select" data-select-options="dropdownAutoWidth: true"></select>
          </div>
        `)};const r=function(e){const t=$('<select class="form-control auto-imports js-select"></select>');t.attr("id",e.id);return t};const s=function(e){return e.$el.find(".mailings :selected").val()};const o=function(e){return e.$el.find(".auto-imports :selected").val()};const a=function(r){const s={},o={},a=-1;$(d).on("values-set",r,function(e){if($.isEmptyObject(o)){h($(e.target),a)}else{const t=$(e.target).attr("id"),i=o[t],n=i?i.$el.find(r):$(e.target);h(n,s[t]||a)}});return function(e,t){const i=e.$el.find(r);s[e.id]=t;o[e.id]=e;h(i,t)}};const l=a("select.mailings");const c=a("select.auto-imports");const u={"finished auto-import":{type:"string",input_event:"values-setup-finished",input:r,values:function(e){v(e).done(function(){e.trigger("values-setup-finished")})},valueSetter:c,valueGetter:o,canBeNegated:true,skipOperator:true},"received mailing":{type:"string",input_event:"values-setup-finished",input:n,values:function(e){const t=e.find("select.mailings");m(t).done(()=>t.trigger("values-setup-finished"))},valueSetter:l,valueGetter:s,canBeNegated:true,skipOperator:true},"opened mailing":{type:"string",input_event:"values-setup-finished",input:n,values:function(e){const t=e.find("select.mailings");m(t).done(()=>t.trigger("values-setup-finished"))},valueSetter:l,valueGetter:s,canBeNegated:i.mail_tracking_available,skipOperator:true},"clicked in mailing":{type:"string",input_event:"values-setup-finished",valueSelector:function(e,t){const i=["mailingID","linkID"];return e+"_"+i[t]},input:function(e){return $(`
             <div class="qb-select-container">
               <select id="${e.filter.valueSelector(e.id,0)}" class="form-control js-select mailings" data-rule-id="${e.id}" data-select-options="dropdownAutoWidth: true"></select>
             </div>
             <label class="form-label d-flex align-items-center">Links</label>
             <div class="qb-select-container">
               <select id="${e.filter.valueSelector(e.id,1)}" class="form-control js-select links" data-rule-id="${e.id}" data-select-options="dropdownAutoWidth: true"></select>
             </div>
            `)},values:function(s){const i=s.find("select.mailings");const n=AGN.Lib.Select.get(i);i.change(function(){const e=n.getSelectedValue();b(e,function(e){const i=s.find("select.links");const n=AGN.Lib.Select.get(i);const r=[{id:-1,text:t("querybuilder.common.anyLink")}];$.each(e,function(e,t){r.push({id:t.id,text:t.url})});n.setOptions(r);i.trigger("link-values-set")})});m(i,function(e){const t=[];e.forEach(function(e){t.push({id:e.mailingID,text:e.shortname})});n.setOptions(t);i.trigger("mailing-values-set")})},valueGetter:function(e){const t=0,i=1,n=[];n[t]=e.$el.find("#"+e.filter.valueSelector(e.id,t)).val();n[i]=e.$el.find("#"+e.filter.valueSelector(e.id,i)).val();return n},valueSetter:function(){const s=0,r=1,o={},a={};const e=function(e,t){o[e.id]=t;a[e.id]=e};$(d).on("mailing-values-set",function(e){let t=$(e.target),i=t.data("rule-id"),n=a[i],r;if(n){r=n.$el.find("select.mailings");h(r,o[i][s]);r.trigger("change")}else{h(t);t.trigger("change")}});$(d).on("link-values-set",function(e){let t=$(e.target).data("rule-id"),i=a[t],n;if(i){n=i.$el.find("select.links");h(n,o[t][r]||-1)}else{n=$(e.target);h(n)}n.trigger("values-setup-finished")});return e}(),validation:{callback:function(e){return e.every(function(e){return e})||["string_empty"]}},canBeNegated:i.mail_tracking_available,skipOperator:true},"revenue by mailing":{type:"string",input_event:"values-setup-finished",input:n,values:function(e){const t=e.find("select.mailings");m(t).done(()=>t.trigger("values-setup-finished"))},valueSetter:l,valueGetter:s,canBeNegated:i.mail_tracking_available,skipOperator:true}};if(!i.mail_tracking_available){delete u["received mailing"]}e.forEach(function(e){const t=u[e.id];if(t){$.extend(e,t)}})}function m(n,e){const t=e||function(e){const t=AGN.Lib.Select.get(n);const i=[];e.forEach(e=>i.push({id:e.mailingID,text:e.shortname}));t.setOptions(i);n.trigger("values-set")};return $.ajax({type:"GET",url:AGN.url("/workflow/getAllMailingSorted.action"),data:{sortField:"date",sortDirection:"desc"},success:t})}function v(t,e){const i=e||function(e){e.forEach(function(e){t.append($("<option>",{text:e.shortname,value:e.autoImportId}))});t.trigger("values-set")};return $.ajax({type:"POST",url:AGN.url("/autoimport.do"),data:{method:"listJson"},success:i})}function y(e,i){e.forEach(function(e){const t=$("<option>");t.text(e.shortname);t.val(e.mailingID);i.append(t)})}function b(e,t){$.ajax({url:AGN.url(`/mailing/ajax/${e}/links.action`),success:t})}function C(e,t){if(t){e=f(e)}return $.extend({},e)}function w(){return[{type:"equal",apply_to:["string","number","datetime"]},{type:"not_equal",apply_to:["string","number","datetime"]},{type:"less",apply_to:["string","number"]},{type:"less_or_equal",apply_to:["string","number"]},{type:"greater",apply_to:["string","number"]},{type:"greater_or_equal",apply_to:["string","number"]},{type:"like",nb_inputs:1,apply_to:["string"]},{type:"not_like",nb_inputs:1,apply_to:["string"]},{type:"contains",nb_inputs:1,apply_to:["string"]},{type:"not_contains",nb_inputs:1,apply_to:["string"]},{type:"begins_with",nb_inputs:1,apply_to:["string"]},{type:"not_begins_with",nb_inputs:1,apply_to:["string"]},{type:"mod",nb_inputs:1,apply_to:["number"],valueSelectors:["#first","#operator select","#second"],valueGetter:function(t){const i=[];t.operator.valueSelectors.forEach(function(e){i.push(t.$el.find(e).val())});return i},valueSetter:function(i,n){i.operator.valueSelectors.forEach(function(e,t){i.$el.find(e).val(n[t])})},input:function(e){const t=this.operators.filter(function(e){return e.type!=="mod"&&e.apply_to.includes("number")});const i=this.getRuleOperatorSelect(e,t);return""+"<div class='qb-input-element'>"+"<input class='form-control' id='first' type='number'/>"+"</div>"+"<div class='qb-input-element' id='operator'>"+i+"</div>"+"<div class='qb-input-element'>"+"<input class='form-control' id='second' type='number'/>"+"</div>"},validate:function(e){return e.every(function(e){return e})||["string_empty"]}},{type:"is_empty",nb_inputs:0,apply_to:["string","number","datetime"]},{type:"is_not_empty",nb_inputs:0,apply_to:["string","number","datetime"]},{type:"before",nb_inputs:1,apply_to:["datetime"]},{type:"after",nb_inputs:1,apply_to:["datetime"]}]}})})();AGN.Lib.Controller.new("targets-list",function(){this.addAction({change:"check-favorites"},function(){AGN.Lib.Loader.prevent();$.ajax({type:"GET",url:AGN.url(e(this.el))})});function e(e){var t=e.data("target-id");var i=e.is(":checked");return"/target/"+t+"/"+(i?"addToFavorites":"removeFromFavorites")+".action"}this.addAction({change:"check-admin-favorites"},function(){AGN.Lib.Loader.prevent();const e=this.el.data("target-id");const t=this.el.is(":checked");$.ajax({type:t?"POST":"DELETE",url:AGN.url("/target/"+e+"/favorite.action")})})});AGN.Lib.CoreInitializer.new("template",function(e=$(document)){e.find('script[type="text/x-mustache-template"]').each(function(){const e=$(this);const t=e.attr("id");if(t){AGN.Lib.Template.register(t,e.html())}})});(function(){var t=AGN.Lib.Tile;AGN.Lib.CoreInitializer.new("tile-toggle",function(e){if(!e){e=$(document)}_.each(e.find("[data-toggle-tile]"),function(e){t.init($(e))})})})();AGN.Lib.CoreInitializer.new("tooltip",function(e=$(document)){const t=AGN.Lib.Tooltip;$(".tooltip").remove();e.all("[data-tooltip]").each(function(){const e=$(this);t.create(e,t.options(e))})});AGN.Lib.CoreInitializer.new("trackable-link-extensions",function(e=$(document)){class i extends AGN.Lib.InputTable{constructor(e){super(e)}get rowTemplate(){return`
        <tr>
            <td><input type="text" class="form-control" data-name="name" value="{{- name }}" placeholder="${t("defaults.name")}" ${this.readonly?"disabled":""}></td>
            <td><input type="text" class="form-control" data-name="value" value="{{- value }}" placeholder="${t("defaults.value")}" ${this.readonly?"disabled":""}></td>
        </tr>
      `}get headerTemplate(){return`
        <tr>
            <th>${t("defaults.name")}</th>
            <th>${t("defaults.value")}</th>
        </tr>
      `}addActions(){super.addActions();AGN.Lib.Action.new({click:"[data-delete-all-extensions]"},this.clean.bind(this),this.$container);AGN.Lib.Action.new({click:"[data-add-default-extensions]"},this.addDefaultExtensions.bind(this),this.$container)}addDefaultExtensions(){const e=this.$table.find("tbody tr:last");if(this.isEmptyRow$(e)){e.remove()}_.each(this.config.defaultExtensions,e=>this.addRow(e));this.addEmptyRow()}}_.each(e.find("[data-trackable-link-extensions]"),function(e){new i($(e))})});AGN.Lib.CoreInitializer.new("truncated-text-popover",["table"],function(e=$(document)){const n=AGN.Lib.Popover;const r=AGN.Lib.Helpers;document.fonts.ready.then(()=>{e.find(".text-truncate, table:not(.input-table) td").each((e,t)=>i(t))});function i(e){const t=s(e);const i=n.get(t);if(o(e)){if(!i){n.create(t,{delay:{show:400,hide:50},content:$(r.retrieveTextElement(t[0])).text()}).forTruncatedText=true}}else if(i?.forTruncatedText){n.remove(t)}}function s(e){const t=$(e);const i=t.closest("td");return i.exists()?i:t}function o(e){let t=$(e);if(t.is(".text-truncate-alt")){return t.is(":truncatedAlt")}return t.is(":truncated")||t.is("td")&&r.containsTruncatedElements(e)}});AGN.Lib.DomInitializer.new("upload",function(t){const e=AGN.Lib.Upload;const i=AGN.Lib.Template;const n=d(t);const r=d(t,true);const s=(n.exists()?n:t).find("[data-upload]");if(!s.exists()&&!n.exists()){return}let o=e.get(n,s);if(!o){o=new e(n,s)}if(r.exists()){new e(r,r.find("[data-upload]"),o)}const a=s.data("upload")||"";const l=a.includes("[]");const c=AGN.Lib.Form.get(t);const u=c.get$();if(u.exists()){const y=g();const b=y.data("upload-progress-template")||"progress";m();u.on("form:loadershow",()=>{y.html(i.text(b,{currentProgress:true}));y.show()});u.on("form:loaderhide",()=>y.hide());u.on("form:submit",()=>p());u.on("submitted",h);u.on("form:progress",(e,t)=>{y.html(i.text(b,{currentProgress:t.progress}))});n.on("upload:reset",h);n.on("upload:dropped",(e,t)=>{m();if(n.data("upload-dropzone")==="submit"){n.hide();c.submit()}})}function d(e,t=false){if(t){return e.find('[data-upload-dropzone="extra"]').first()}const i=$(e.data("linked-dropzone"));return i.exists()?i:e.find("[data-upload-dropzone]").first()}function h(){if(l){v().forEach((e,t)=>{c.setValueOnce(f(t),undefined)})}else{c.setValueOnce(a,undefined)}o.reset();m();n.show()}function p(){const e=v();if(l){e.forEach((e,t)=>{c.setValueOnce(f(t),e)})}else{c.setValueOnce(a,e)}}function f(e){return a.replace("[]",`[${e}]`)}function g(){const e=n.nextAll("[data-upload-progress]").first();return e.length?e:t.find("[data-upload-progress]")}function m(){t.data("upload-selection",v())}function v(){return o?o.getSelection():[]}});AGN.Lib.DomInitializer.new("web-storage-persist",function(){if(this.config){$.each(this.config,(e,t)=>{AGN.Lib.WebStorage.extend(e,t)})}});AGN.Lib.DomInitializer.new("workflow-pause-timer",function(){const i=this.config.workflowId;const e=this.config.pauseTime;const n=this.config.defaultExpirationHours;const r=this.config.expirationHours>0?this.config.expirationHours:n;const s=r*60*60*1e3;const o=$("#workflow-pause-timer-text");const a=setInterval(function(){l()},1e3);l();function l(){o.html(u())}function c(){return s-(Date.now()-e)}function u(){const e=c();if(e<=0){if(a){clearInterval(a)}h();return'<i class="icon icon-refresh icon-spin"></i> '+t("workflow.activating.auto")}const i=new Date(e);return d(i.getUTCHours())+":"+d(i.getUTCMinutes())+":"+d(i.getUTCSeconds())}function d(e){return e>0?e<10?"0"+e:e:"00"}function h(){return $.post(AGN.url("/workflow/"+i+"/autoUnpause.action")).done(function(e){if(e.success===true){AGN.Lib.Page.reload(AGN.url("/workflow/"+i+"/view.action"))}else{AGN.Lib.JsonMessages(e.popups)}}).fail(function(){AGN.Lib.Messages.defaultError()})}return false});(()=>{const i=AGN.Lib.Loader,l=AGN.Lib.Page,n=AGN.Lib.CSRF;const c={initialize:function(e){if(e.loader===true||e.loader===undefined){e.loader={show:()=>i.show(),hide:()=>i.hide()}}},show:function(e){const t=e.loader;if(t?.show){try{t.show()}catch(e){console.error(e)}}},hide:function(e){const t=e.loader;if(t?.hide){try{t.hide()}catch(e){console.error(e)}}}};$.ajaxPrefilter(function(e){c.initialize(e)});$(document).ajaxSend(function(e,t,i){c.show(i);n.setTokenToReqHeader(t,i.type)});$(document).ajaxComplete(function(e,t,i){c.hide(i);n.updateTokenInDOM()});$(document).ajaxError(function(i,n,e){c.hide(e);if(n.readyState==0||n.status==0){return}if(e.statusCode&&n.status in e.statusCode){return}if(n.status===401){const r=$.Event("ajax:unauthorized");$(document).trigger(r);if(!r.isDefaultPrevented()&&n.responseText){l.render(n.responseText)}}else if(n.status===403){if(n.responseText){const s=$(n.responseText);const o=s.filter("#csrf-error-message");if(o.exists()){AGN.Lib.Modal.create(_.template(o.html())({}),{});return}}AGN.Lib.Modal.fromTemplate("permission-denied",{title:t("messages.permission.denied.title"),text:t("messages.permission.denied.text"),btn:t("defaults.ok")})}else{let e=true;if(n.responseText){try{const s=$(n.responseText);const a=s.all("[data-message]");if(a.exists()){l.render(n.responseText);e=false}}catch(i){console.debug(i)}}if(e){AGN.Lib.Modal.fromTemplate("error",{headline:t("messages.error.headline"),text:t("messages.error.text"),reload:t("messages.error.reload")})}}});$(document).on("click","a[data-ajax]",function(e){const t=$(this);e.preventDefault();l.reload(t.attr("href"),true,t.data("ajax"))});$(document).on("click","[data-prevent-load]",function(){i.prevent()});window.onbeforeunload=function(){i.show()}})();(()=>{const s=AGN.Lib.Form;const o=AGN.Lib.Confirm;const i=AGN.Lib.Page;AGN.Lib.Action.new({click:"[data-confirm], .js-confirm"},function(){$.get(this.el.attr("href")).done(e=>{const t=$(e).all(".modal");if(t.length!==1){i.render(e);return}o.create(e).done(e=>i.render(e))});this.event.preventDefault()});$(document).on("click","[data-confirm-positive], .js-confirm-positive",function(){const e=$(this);const t=o.get(e);const i=s.getWrapper(e);if(t){if(i.exists()){const n=s.get(i);if(e.is("[data-url]")){n.setActionOnce(e.data("url"))}n.jqxhr().done(e=>t.positive(e))}else{const r=t.$modal.find('[name="confirm-choice"]');if(r.exists()){t.positive(r.val())}else{t.positive(e.data("confirm-positive"))}}}});$(document).on("click","[data-confirm-negative], .js-confirm-negative",function(){const e=$(this);o.get(e)?.negative(e.data("confirm-negative"))})})();(()=>{const o=AGN.Lib.Tooltip;AGN.Lib.Action.new({click:"[data-copyable]"},function(){let e=undefined;let s=this.el;if(this.el.is("[data-copyable-value]")){e=this.el.data("copyable-value")}else{const i=this.el.data("copyable-target");const n=i?$(i):this.el;if(n.exists()){e=n.val()||n.text();s=n}}if(e!==undefined){AGN.Lib.Clipboard.set(e,(e,i)=>{if(i){o.create(s,{title:t("clipboard.copied.tooltip"),trigger:"manual"});o.setShown(s);const n=this.el.data("tooltip-timeout-id");if(n){clearTimeout(n)}const r=setTimeout(()=>{o.remove(s);this.el.removeData("tooltip-timeout-id")},2500);this.el.data("tooltip-timeout-id",r)}})}})})();(()=>{const o=AGN.Lib.Table;const r=AGN.Lib.WebStorage;const s=AGN.Lib.Confirm;const a="[data-restore-row]";const e='[data-bulk-action="restore"]';$(document).on("click",".js-data-table-first-page",function(e){i($(this),e=>e.paginationGoToFirstPage())});$(document).on("click",".js-data-table-prev-page",function(e){i($(this),e=>e.paginationGoToPreviousPage())});$(document).on("click",".js-data-table-page",function(e){const t=$(this);i(t,e=>e.paginationGoToPage(t.data("page")))});$(document).on("click",".js-data-table-next-page",function(e){i($(this),e=>e.paginationGoToNextPage())});$(document).on("click",".js-data-table-last-page",function(e){i($(this),e=>e.paginationGoToLastPage())});function i(e,t){const i=o.get(e).api;t(i);i.deselectAll()}$(document).on("change","[data-js-table] [data-number-of-rows]",function(e){const t=$(this);const i=t.val();o.get(t).api.paginationSetPageSize(i);const n=t.closest(".table-wrapper").data("web-storage");if(n){r.extend(n,{paginationPageSize:parseInt(i)})}});$(window).on("viewportChanged",function(e){$(document).all(".table-wrapper").each(function(){AGN.Lib.Table.get($(this))?.redraw()})});$(document).on("click",".js-data-table-delete",function(e){const i=$(this);const n=o.get(i);$.get(i.attr("href")).done(e=>{if($(e).all(".modal").exists()){s.create(e).done(e=>{const t=n?.findRowByElement(i);if(t){t.data.deleted=true;t.data.active="false";n.api?.applyTransaction(u()?{update:[t.data]}:{remove:[t.data]})}if(typeof e==="object"){AGN.Lib.JsonMessages(e.popups,true)}else{AGN.Lib.RenderMessages($(e))}})}else{AGN.Lib.Page.render(e)}});e.preventDefault()});$(document).on("click",".js-data-table-bulk-delete",e=>t($(e.currentTarget)));$(document).on("click",`${e},
                           ${a}`,e=>n($(e.currentTarget)));function t(e){l(e,false)}function n(e){l(e,true)}function l(e,t){const i=o.get(e);const n=i.api;const r=e.is(a)?[i?.findRowByElement(e)?.data]:n.getSelectedRows();const s=r.map(e=>e.id);d(s,e.data("bulk-url"),t?"POST":e.data("method")).done(()=>c(n,r,t))}function c(e,t,i){t.forEach(e=>{e.active="false";e.deleted=!i});e.applyTransaction(u()?{update:t}:{remove:t})}function u(){return $(e).exists()}function d(e,t,i="GET"){const n=$.Deferred();if(e&&e.length){const r=$.ajax(t,{method:i,traditional:true,data:{bulkIds:e}}).fail(()=>n.reject());s.request(r).then(n.resolve,n.reject)}else{n.reject();AGN.Lib.Messages.alert("messages.error.nothing_selected")}return n.promise()}})();$(document).ready(function(){window.AGN.Lib.Controller.init();window.AGN.runAll()});(function(){$(document).on("dragster:enter",function(e){var t=$(e.target);if(!t.is("[data-upload-dropzone]")){t.addClass("drag-over")}});$(document).on("dragster:leave",function(e){var t=$(e.target);if(!t.is("[data-upload-dropzone]")){t.removeClass("drag-over")}})})();(()=>{const i=AGN.Lib.EditableView;const e=AGN.Lib.Action;e.new({click:"[data-edit-view]"},function(){const e=$(`[data-editable-view="${this.el.data("edit-view")}"]`);const t=i.get(e);if(t.isInEditMode()){t.applyChanges()}else{t.enableEditMode()}});e.new({click:"[data-edit-tile-visibility]"},function(){i.get(this.el).toggleState(this.el)})})();(()=>{$(document).on("click","[data-evaluate-loader]",function(e){const t=$(this);e.preventDefault();let i;return $.ajax({beforeSend:()=>i=AGN.Lib.Modal.fromTemplate(r(t)),xhr:n,url:t.prop("href"),type:"POST",data:t.is("[data-form-target]")?AGN.Lib.Form.get($(t.data("form-target"))).params():""}).done(e=>{if(typeof e==="object"){s(e.data)}else{AGN.Lib.Page.render(e)}}).fail(e=>AGN.Lib.Page.render(e)).always(()=>AGN.Lib.Modal.getInstance(i).hide())});function n(){const e=new XMLHttpRequest;e.addEventListener("progress",e=>{if(e.lengthComputable){$("#progress-text").html(`${e.loaded} bytes`)}});return e}function r(e){return e.data("evaluate-loader")||"evaluate-loader-template"}function s(e){const t=window.onbeforeunload;window.onbeforeunload=null;window.location=AGN.url(e);window.onbeforeunload=t}})();(()=>{const e=AGN.Lib.Action,n=AGN.Lib.Form,r=AGN.Lib.Confirm,t=AGN.Lib.Helpers;e.new({click:"[data-form-change]",change:"select[data-form-change]"},function(){n.get(this.el).setValueOnce("numberOfRowsChanged",true)});e.new({click:"a[data-form-set], button[data-form-set]",change:"select[data-form-set], input[data-form-set]"},function(){const e=t.objFromString(this.el.data("form-set"));const i=n.get(this.el);_.forEach(e,(e,t)=>i.setValueOnce(t,e))});e.new({click:"a[data-form-url], button[data-form-url]",change:"select[data-form-url], input[data-form-url]"},function(){n.get(this.el).setActionOnce(this.el.data("form-url"))});e.new({click:"a[data-form-method], button[data-form-method]",change:"select[data-form-method], input[data-form-method]"},function(){n.get(this.el).setMethodOnce(this.el.data("form-method"))});e.new({click:"a[data-form-resource], button[data-form-resource]",change:"select[data-form-resource], input[data-form-resource]"},function(){const e=n.get(this.el);if(e instanceof AGN.Lib.ResourceForm){e.setResourceSelectorOnce(this.el.data("form-resource"))}});e.new({click:"a[data-form-clear], button[data-form-clear]"},function(){const e=this.el.data("form-clear");if(!e){n.get(this.el).clear();return}i($(e));this.el.trigger("apply-filter")});function i(e){e.find(":input, select").val("").trigger("change");e.find(":checkbox, :radio").prop("checked",false);AGN.Lib.CoreInitializer.run("select",e)}e.new({click:"a[data-form-persist], button[data-form-persist]",change:"select[data-form-persist], input[data-form-persist]"},function(){const e=t.objFromString(this.el.data("form-persist"));const i=n.get(this.el);_.forEach(e,(e,t)=>i.setValue(t,e))});e.new({click:"a[data-form-reset], button[data-form-reset]"},function(){n.get(this.el).reset()});e.new({click:"a[data-form-abort], button[data-form-abort]"},function(){n.get(this.el).abort()});e.new({click:"[data-form-confirm]"},function(){const i=n.get(this.el);i.submit("confirm").done(e=>{const t=$(e).all(".modal");if(!t.exists()){i.updateHtml(e);return}r.create(e).done(e=>i.updateHtml(e)).fail(i.revertAction)})});e.new({click:"a[data-form-submit], button[data-form-submit]",change:"select[data-form-submit], input[data-form-submit]"},function(){setTimeout(()=>n.get(this.el).submit(),5)});e.new({click:"a[data-form-submit-static], button[data-form-submit-static]",change:"select[data-form-submit-static], input[data-form-submit-static]"},function(){setTimeout(()=>n.get(this.el).submit("static"),5)});e.new({click:"a[data-form-submit-event], button[data-form-submit-event]",change:"select[data-form-submit-event], input[data-form-submit-event]"},function(){setTimeout(()=>n.get(this.el).submit("event"),5)});e.new({submit:"[data-form]"},function(){if(this.el.data("form")!=="static"){this.event.preventDefault();setTimeout(()=>n.get(this.el).submit(),5)}});function s(e){const t=e.keyCode||e.which;if(t===13){return true}if(t===229&&e.originalEvent){const i=e.originalEvent.code;if(i==="Enter"||i==="NumpadEnter"){return true}}return false}e.new({keydown:'input[type="text"], input[type="password"], input[type="number"]'},function(){if(s(this.event)){const e=$.Event("enterdown");this.el.trigger(e);if(e.isDefaultPrevented()){return}const t=n.getWrapper(this.el);if(t.exists()){if(t.is("[data-form]")){const i=n.get(t);if(t.is("[data-action]")){i.submit("event")}else{i.submit()}}else{t.submit()}}}})})();(function(){var t=AGN.Lib.Help;$(document).on("click","[data-help]",function(e){t.show($(this));e.preventDefault()})})();(()=>{$(document).on("click","[data-manual]",function(e){const t=$(this);AGN.Lib.Helpers.openHelpModal("manual",{key:t.data("manual")})})})();(()=>{$(document).on("click","label",function(e){if($(e.target).is("[data-help]")){return}const t=$(this);const i=$(`#${t.attr("for")}`);const n=i.data("select2");if(i.length===1&&n){setTimeout(()=>{if(!n.isOpen()){n.open()}},0)}})})();(()=>{const n=window.history;$(document).on("click",'a[href^="#"]',function(e){if(e.isDefaultPrevented()){return}e.preventDefault();t($(this).attr("href"))});function t(e){if(e==="#"){return}var t=window.location.href;var i=t.indexOf("#");if(i>=0){t=t.substring(0,i)}n.replaceState(n.state||{},document.title,t+e)}})();AGN.Lib.Action.new({click:"[data-msg]"},function(){AGN.Lib.Messages(this.el.data("msg"),this.el.data("msg-content"),this.el.data("msg-type"))});(()=>{AGN.Lib.Action.new({click:"[data-modal]"},function(){const e=this.el.data("modal");let t=this.el.data("modal-set");t=typeof t==="object"?t:AGN.Lib.Helpers.objFromString(t);AGN.Lib.Modal.fromTemplate(e,t)});$(document).on("hidden.bs.modal",".modal",function(){const e=$(this);e.trigger("modal:close");setTimeout(()=>e.remove(),100)});$(document).on("shown.bs.modal",".modal",function(){setTimeout(()=>$(this).trigger("modal:open"),0);const e=$(".modal.show");if(e.length>1){t(e.last())}});function t(e){$(".modal-backdrop.show").last().css("z-index",e.css("z-index"))}})();(()=>{$(document).on("click",".date-picker-container",function(){const e=$(this).find(".js-datepicker");if(!e.prop("disabled")&&!e.datepicker("widget").is(":visible")){e.datepicker("show")}})})();AGN.Lib.Action.new({click:"[data-popup]"},function(){const e=window.location.href;const t=e.substring(0,e.lastIndexOf("/"));let i=this.el.data("popup");if(!i||i.indexOf("://")<=0){i=`${t}/${i}`}window.open(i,"help","width=800,height=600,left=0,top=0,scrollbars=yes")});(()=>{const e=$(window);const t={DESKTOP:1,MOBILE:2};let i;let n;const r=function(){if(i){clearTimeout(i)}i=setTimeout(function(){AGN.Lib.CoreInitializer.run(["scrollable","truncated-text-popover"]);_.each(AGN.Lib.Editor.all(),function(e){e.resize()});e.trigger("viewportChanged")},500);if(s()){e.trigger("displayTypeChanged",[n===t.MOBILE])}};function s(){const e=n;n=AGN.Lib.Helpers.isMobileView()?t.MOBILE:t.DESKTOP;return e!==n}e.on("resize",r)})();(()=>{$(document).on("agn:rail-mousedown",function(e,t){$(t).find("iframe").addClass("pe-none")});$(document).on("agn:rail-mouseup",function(e,t){$(t).find("iframe").removeClass("pe-none")});$(window).on("load",function(){new MutationObserver(()=>AGN.Lib.Scrollbar.updateAll()).observe(document.body,{childList:true,subtree:true})})})();(()=>{const i=AGN.Lib.Helpers;AGN.Lib.Action.new({click:"[data-support-type]"},function(){const e=this.el.data("support-type");const t=i.objFromString(this.el.data("support-options"));i.openHelpModal("support",{type:e,opts:t})})})();(()=>{const c=AGN.Lib.FormBuilder.FormBuilder;AGN.Lib.Action.new({"click change":"[data-sync-from]"},function(){var e=this.el.data("sync-from").split(/,\s?/),l=this.el.data("sync-to").split(/,\s?/);_.each(e,function(e,t){var i=$(e),n=$(l[t]),r=i.val(),s=n.attr("id"),o=n.data("_editor"),a=n.data("select2");if(window.CKEDITOR&&CKEDITOR.instances[s]){CKEDITOR.instances[s].setData(r)}else if(o){o.val(r)}else if(a){n.select2("val",r)}else if(c.isCreated("#"+s)){c.get("#"+s).setJson(c.get(e).getJson())}else if(i?.prop("type")?.trim()==="checkbox"){n.val(i.prop("checked"))}else{n.val(r)}})})})();(()=>{const s=AGN.Lib.Tile;const o=AGN.Lib.Tab;const a=AGN.Lib.Form;$(document).on("click","[data-toggle-tab]",function(e){const t=$(this);const i=s.trigger(t);const n=t.data("toggle-tab-method")||"show";if(t.is("[data-form-submit]")){const r=a.getWrapper(t);if(r.exists()&&!a.get(r).valid()){e.preventDefault();return false}}s.show(i);o[n](t);AGN.Lib.Scrollbar.get(t)?.update();e.preventDefault();return false})})();(function(){const e=AGN.Lib.Action;const t=AGN.Lib.TableColumnManager;e.new({click:"[data-manage-table-columns]"},function(){const e=t.get(this.el);if(e.isInEditMode()){e.applyChanges()}else{e.toEditMode()}});e.new({click:"[data-remove-table-column]"},function(){t.get(this.el).removeColumn(this.el.closest("th"))})})();(()=>{const o=AGN.Lib.Helpers;const r=AGN.Lib.Confirm;const a=AGN.Lib.Form;const s=AGN.Lib.Page;$(document).on("click",'.js-table a, .js-table input, .input-table input[type="checkbox"], .js-table select, .js-table .select2, .js-table button, .js-table td:has(input[type="checkbox"]), .js-table .disabled, .js-table a.disable',function(e){e.stopPropagation()});$(document).on("click",".js-table-sort > a",function(e){const t=$(this);if(e.target!==t.get(0)){return}const i=t.attr("href");if(a.getWrapper(t).exists()){const n=a.get(t);const r=o.paramsFromUrl(i);_.each(r,(e,t)=>n.setValue(t,e));n.submit()}else{$.get(i).done(e=>{s.render(e,false)})}e.preventDefault()});$(document).on("click",".js-table-paginate",function(e){const t=$(this);const i=a.get(t);const n=o.paramsFromUrl(t.attr("href"));_.each(n,(e,t)=>i.setValue(t,e));i.submit();e.preventDefault();const r=t.closest(".tile");if(r.exists()){const s=r.offset().top;if(window.scrollY>s){window.scrollTo(0,s-150)}}else{window.scrollTo(0,0)}});function n(e,t){const i=a.get(e);$.get(t).done(e=>{const t=$(e).all(".modal");if(t.exists()){r.create(e).done(e=>i.updateHtml(e))}else{i.updateHtml(e)}})}$(document).on("click",".js-row-delete",function(e){const i=$(this);const t=i.is("button")?i.data("url"):i.attr("href");const n=a.get(i);if(t){$.get(t).done(e=>{const t=$(e).all(".modal");if(t.exists()){r.create(e).done(e=>{i.closest("tr").remove();n.updateHtml(e)})}else{n.updateHtml(e)}})}e.preventDefault()});$(document).on("click",".js-table tr",function(e){if(AGN.Lib.Helpers.isMobileView()){return}const t=$(this);const i=t.data("link");if(typeof i!=="undefined"&&i!=="#"){if(t.data("load-page")){window.location.href=i}else{n(t,i)}}});$(document).on("click",'td:has(input[type="checkbox"])',function(e){e.preventDefault();const t=$(this).find('input[type="checkbox"]');_.each(t,e=>{const t=$(e);if(!t.prop("disabled")){t.prop("checked",!t.prop("checked"));t.trigger("change")}})});$(document).on("click",".disabled, a.disable",function(e){e.preventDefault()});$(document).on("click","[data-toggle-table-truncation]",function(){const e=$(this).closest(".table-wrapper");const t=e.find(".table, .ag-body");t.toggleClass("no-truncate");AGN.Lib.CoreInitializer.run(["truncated-text-popover","scrollable"],e);AGN.Lib.Storage.set("truncate-table-text",!t.hasClass("no-truncate"))});AGN.Lib.Action.new({change:"[data-preview-table]"},function(){AGN.Lib.PreviewTable.toggle(this.el);AGN.Lib.CoreInitializer.run(["table-row-actions","scrollable","truncated-text-popover"],this.el.closest(".table-wrapper"))});$(document).on("change","[data-bulk-checkbox]",function(){const e=$(this).closest(".table-wrapper");const t=e.find("[data-bulk-checkboxes]");const i=e.find("[data-bulk-checkbox]");const n=i.filter(":checked").length;const r=i.length;t.prop("indeterminate",n>0&&n<r);t.prop("checked",n===r);l(e)});$(document).on("change","[data-bulk-checkboxes]",function(){const e=$(this);const t=e.closest(".table-wrapper").find("[data-bulk-checkbox]:not(:disabled)");t.prop("checked",e.prop("checked")).trigger("change")});$(document).on("table:updateBulkActions",".table-wrapper",function(e,t,i){l($(this),t,i)});function l(e,t,i){const n=d(e);if(!n.exists()){return}if(t===null||t===undefined){const r=e.find("[data-bulk-checkbox]:checked").closest("tr");i=c(r);t=r.length}n.find(".bulk-actions__selected span").text(t);u(n,i||[]);n.toggleClass("hidden",t===0)}function c(e){return e.find("[data-bulk-action]").filter((e,t)=>!$(t).prop("disabled")&&!$(t).hasClass("disable")).map((e,t)=>$(t).data("bulk-action")).get()}function u(e,t){if(!t.length){return}const i=new Set(t);e.find("[data-bulk-action]").each(function(){const e=$(this);e.toggleClass("hidden",!i.has(e.data("bulk-action")))})}function d(e){return e.find(".bulk-actions")}})();$(document).on("input change",".text-area-grow-wrapper > textarea",function(e){const t=$(this);t.parent().attr("data-replicated-value",t.val())});(()=>{function n(e){const t=".tile-header .tile-title";return $(e).is(t)||$(e).closest(t).length}function r(e){const t=".tile-header .tile-controls";return $(e).is(t)||$(e).closest(t).length}$(document).on("click","[data-toggle-tile] > .tile-header",function(e){const t=$(this).closest(".tile");const i=AGN.Lib.Helpers.isMobileView();if(t.data("toggle-tile")==="mobile"&&!i){return}if(i&&!r(e.target)||n(e.target)){AGN.Lib.Tile.toggle(t);AGN.Lib.Scrollbar.get(t)?.update();return}e.preventDefault()})})();AGN.Lib.Action.new({change:"[data-toggle-usability]"},e=>{_.each($(e.data("toggle-usability")),e=>{const t=$(e);t.prop("disabled",!t.prop("disabled"))})});AGN.Lib.Action.new({click:"[data-upload-reset]"},function(){const e=$(this.el.data("linked-dropzone"));if(e.exists()){e.trigger("upload:reset")}});(()=>{var s=AGN.Lib.Form,t=AGN.Lib.Editor;$(document).on("tile:show",function(e){var t=$(e.target);var i=t.find(".js-wysiwyg");var n=i.attr("id");if(i.length===1){var r=l(i);window.createEditorExt(n,r.width,r.height,r.browseMailingId,r.isFullHtml,r.isFullHeight,r.allowExternalScript);if(r.isFullHeight){CKEDITOR.instances[n].on("instanceReady",o(i))}}});$(document).on("tile:hide modal:close",function(e){$(e.target).find(".js-wysiwyg").each(function(){if(CKEDITOR.instances[$(this).attr("id")]){CKEDITOR.instances[$(this).attr("id")].updateElement()}if(n($(this))){$(window).off("resize."+a($(this)))}t.get($(this)).val($(this).val());window.removeEditor($(this).attr("id"))})});$(document).on("form:submit",function(e){var t=$(e.target).find(".js-wysiwyg");if(t.length>0&&window.removeAllEditors){window.removeAllEditors()}});function i(e){var t=e.data("browse-mailing-id");if(!!t){return t}var i=e.data("form-target");var n=!!i?$(i):null;if(!n||n.length===0){return null}var r=s.get(n);t=r.getValue("mailingID");if(!t){t=r.getValue("mailingId")}return t}function o(n){return function(e){var t=n.parent().width();var i=n.parent().height();e.editor.resize(t,i);e.editor.resresize_enabledze=false;$(window).on("resize."+a(n),r(n))}}var r=function(t){return function(){var e=t.parent();CKEDITOR.instances[t.attr("id")].resize(e.width(),e.height())}};var a=function(e){return"ck-editor-"+e.attr("id")};var n=function(e){return!!e.data("full-height-editor")};var l=function(e){var t={};t.isFullHtml=!!e.data("full-tags");t.isFullHeight=n(e);t.browseMailingId=i(e);t.height=t.isFullHeight?0:e.height();t.width=t.isFullHeight?e.parent().width():"100%";t.allowExternalScript=false;return _.extend(t,AGN.Lib.Helpers.objFromString(e.data("editor-options")))}})();AGN.Lib.Validator.new("action",{valid:function(e,t,i){return i&&!this.errors(e,t).length},errors:function(e,t){const i=[];if($("#serviceMailOperation").length)this.validateSendServiceOperation(i);return i},validateSendServiceOperation:function(e){validateEmailList($("input[id$=toAddress]"),e,"triggerManager.operation.serviceMail.error.recipientAddress");validateEmail($("input[id$=fromAddress]"),e,"triggerManager.operation.serviceMail.error.senderAddress");validateEmail($("input[id$=replyAddress]"),e,"triggerManager.operation.serviceMail.error.replyAddress");validateSubject($("input[id$=subjectLine]"),e)}});function validateEmailList(e,s,o){e.each(function(e,i){const n=$(i);const r=getEmailsFromField(n);if(!r||!isValidEmailList(r)){s.push({field:n,msg:t(o)})}else{n.val(r.join(","))}})}function validateEmail(e,s,o){e.each(function(e,i){const n=$(i);const r=n.val().trim();if(!AGN.Lib.Helpers.isValidEmail(r)){s.push({field:n,msg:t(o)})}else{n.val(r)}})}function validateSubject(e,s){e.each(function(e,i){const n=$(i);const r=n.val().trim();if(!r||r.length<3){s.push({field:n,msg:t("triggerManager.operation.serviceMail.error.subjectToShort")})}else if(r&&r.length>200){s.push({field:n,msg:t("triggerManager.operation.serviceMail.error.subjectToLong")})}else{n.val(r)}})}function getEmailsFromField(e){const t=e.val();let i=t.trim()&&t.trim().split(/[ ,|]+/);_.map(i,_.trim);return i}function isValidEmailList(e){return e.every(e=>AGN.Lib.Helpers.isValidEmail(e))}(function(){AGN.Lib.Validator.new("client/form",{valid:function(e,t,i){return i&&!this.errors(e,t).length},errors:(e,i)=>{const n=[];$("#technical-contact-block input").each(function(){const e=$(this);const i=e.val();if(!$.trim(i)){n.push({field:e,msg:t("fields.required.errors.missing")})}else if(!AGN.Lib.Helpers.isValidEmail(i)){n.push({field:e,msg:t("import.columnMapping.error.invalidEmail")})}});return n}})})();(function(){AGN.Lib.Validator.new("export/form",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,t){const i=[];n(i);return i}});function n(r){const s=[];_.each($("#custom-column-mappings tbody").find("tr"),function(e){const t=$(e);const i=t.find('[data-name="dbColumn"]');const n=l(i);o(i,r);a(n,s,r,i);s.push(n.toLowerCase())})}function o(e,i){const n=l(e);const r=e.is(":last-child");if(!r&&n.length<3||r&&n&&n.length<3){i.push({field:e,msg:t("export.columnMapping.error.nameToShort")});return}if(!r&&!/^[a-zA-Z0-9_]{3,}$/.test(n)||r&&n&&!/^[a-zA-Z0-9_]{3,}$/.test(n)){i.push({field:e,msg:t("export.columnMapping.error.invalidColName")})}}function a(e,i,n,r){if(e&&i.indexOf(e.toLowerCase())>=0){n.push({field:r,msg:t("export.columnMapping.error.duplicate")})}if(s().indexOf(e.toLowerCase())>=0){n.push({field:r,msg:t("export.columnMapping.error.exist")})}}function l(e){return e.val().trim()}function s(){return $.map($('select[name="userColumns"] option'),function(e){return e.value.toLowerCase()})}})();(function(){let o;AGN.Lib.Validator.new("import-profile-mappings/form",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,t){const i=[];n(i,t.$mappingsBlock);return i}});function a(e,t){return t.length<=l(e)}function l(e){const t=e.simpleDataType.toLowerCase();if(t==="float"||t==="numeric"){return e.numericPrecision+e.numericScale}return e.characterLength}function c(e){let t=e.val();if(t[0]=="'"&&t[t.length-1]=="'"){t=t.substring(1,t.length-1)}return t}function r(e,i){const n=c(e);if(n&&h(e)!==o.doNotImportValue){const r=d(e);const s=r.simpleDataType.toLowerCase();if(r.columnName==="email"&&!AGN.Lib.Helpers.isValidEmail(n)){i.push({field:e,msg:t("import.columnMapping.error.invalidEmail")})}else if(s==="date"||s==="datetime"){if(f(e.val().trim())){return}u(s,n,i,e)}else if(!p(s,n)){i.push({field:e,msg:t("import.columnMapping.error.type",s)})}else if(!a(r,n)){i.push({field:e,msg:t("import.columnMapping.error.length",l(r))})}}}function u(e,i,n,r){if(!i||!p(e,i)){n.push({field:r,msg:t("import.columnMapping.error.dateFormat",e==="datetime"?window.adminDateFormat+" hh:mm":window.adminDateFormat)})}}function n(n,e){_.each(e.find("[data-mapping-defaultValue]"),e=>{const t=$(e);const i=t.closest("[data-mapping-row]");if(!i.is("[data-mapping-new]")||h(t)!==o.doNotImportValue&&!v()){r(t,n)}})}function d(e){return o.columns[h(e)]}function h(e){return e.closest("[data-mapping-row]").find("[data-mapping-db-column]").first().val()}function p(e,t){switch(e){case"numeric":case"float":case"double":return g(t);case"integer":return m(t);case"date":return i(t);case"datetime":return s(t);default:return true}}function f(e){return/^(now|now\(\)|sysdate|sysdate\(\)|current_timestamp|current_timestamp\(\)|today)\s*([+\-]\s*\d+\s*)?$/im.test(e)}function i(e){return moment(e,window.adminDateFormat.toUpperCase(),true).isValid()}function s(e){const t=e.split(" ");return i(t[0])&&/^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/.test(t[1])}function g(e){return!isNaN(parseFloat(e))&&isFinite(e)}function m(e){return/^-?\d+$/.test(e)}function v(){const e=$("[data-action=set-today-date]");return e.exists()&&e.is(":checked")}AGN.Lib.DomInitializer.new("import-profile-mappings-validator",function(){o=this.config})})();AGN.Lib.Validator.new("length",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=e.val();var r=[];if(n){if(i.min>=0&&n.length<i.min){r.push({field:e,msg:t("fields.errors.string_exceed_min_length",i.min)})}else if(i.max>=0&&n.length>i.max){r.push({field:e,msg:t("fields.errors.string_exceed_max_length",i.max)})}}else if(i.min>0||i.required===true){r.push({field:e,msg:t("fields.required.errors.missing")})}return r}});AGN.Lib.Validator.new("logon-new-password/form",{valid:function(){return!this.errors().length},errors:function(){var e=[];var i=$("#password");var n=$("#password-repeat");var r=i.val();if(!$.trim(r)){e.push({field:i,msg:t("fields.required.errors.missing")})}else if(r!=n.val()){e.push({field:n,msg:t("fields.password.errors.notMatching")})}return e}});AGN.Lib.Validator.new("mailing-priorities/form",{valid:function(){if($("#priorityCount").val()>0){return true}AGN.Lib.Messages(t("defaults.error"),t("error.mailing.invalidPriorityCount"),"alert");return false},errors:function(){return[]}});AGN.Lib.Validator.new("mailinglist-exist",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=e.val();var r=AGN.Lib.Validator.get("required-id").errors(e,i);if(r&&r.length<=0&&i&&n&&i.removedMailinglistId==n.trim()){r.push({field:e,msg:t("fields.mailinglist.errors.removed")})}return r}});AGN.Lib.Validator.new("max-length-validator",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=e.val();var r=[];if(e.hasClass("js-wysiwyg")&&!n){n=$("#cke_"+e.attr("id")).find("iframe").contents().find("body").text()}if(n){if(n.length>i.max){r.push({field:e,msg:t("fields.errors.contentLengthExceedsLimit",i.max)})}}else if(i.required===true){r.push({field:e,msg:t("fields.required.errors.missing")})}return r}});(function(){AGN.Lib.Validator.new("number",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=[];if(i.excludeHidden&&e.is(":hidden")){return[]}var r=e.val();if(r){var s=i.float===true?parseFloat(r):parseInt(r);if(isNaN(s)){n.push({field:e,msg:t("fields.errors.number_nan")})}else{if(s<i.min){n.push({field:e,msg:t("fields.errors.number_exceed_min",i.min-1)})}else if(s>i.max){n.push({field:e,msg:t("fields.errors.number_exceed_max",i.max)})}else if(i.strict===true){if($.trim(r)!==s.toString()){if(i.float===true){n.push({field:e,msg:t("fields.errors.number_not_double")})}else{n.push({field:e,msg:t("fields.errors.number_not_integer")})}}}}}else if(i.required===true){n.push({field:e,msg:t("fields.required.errors.missing")})}return n}})})();AGN.Lib.Validator.new("phone-number",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=$.trim(e.val());var r=[];var s=0;var o=1;var a=3;var l=4;var c=5;var u=6;if(n){var d=s;var h=false;var p=false;var f=0;for(var g=0;g<n.length;g++){var m=n.charAt(g);if(m>="0"&&m<="9"){f++;d=a}else if(m=="."||m=="-"||m=="/"){if(d==a||d==u){d=l}else{h=true;break}}else if(m=="("){if(p){h=true;break}d=c;p=true}else if(m==")"){if(d==a&&p){d=u;p=false}else{h=true;break}}else if(m=="+"){if(d==s){d=o}else{h=true;break}}else if(!/\s/.test(m)){h=true;break}}if(h||p||f<3||f>20){r.push({field:e,msg:t("fields.errors.phone_number_invalid")})}}else if(i.required===true){r.push({field:e,msg:t("fields.required.errors.missing")})}return r}});(function(){AGN.Lib.Validator.new("reference-table/form",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,t){var i=[];var n=$('[name="shortname"]');var r=$('[name="keyColumn"]');if(n.length)s(n,i,5,t.isVoucher?27:29,new RegExp("^[a-z]*$","i"),"referenceTables.table.error.name");if(r.length)s(r,i,3,30,/^(?![0-9_])[a-z0-9_]*$/,"referenceTables.table.error.keyColumn");return i}});function s(e,t,i,n,r,s){if(!o(e,t,i,n)){return}a(e,t,r,s)}function o(e,t,i,n){var r=AGN.Lib.Validator.get("length").errors(e,{min:i,max:n,required:true});if(r.length){r.forEach(function(e){t.push(e)});return false}return true}function a(e,i,n,r){if(!e.val().match(n)){i.push({field:e,msg:t(r)})}}})();(()=>{AGN.Lib.Validator.new("reject-not-allowed-chars",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){const n=typeof i.chars==="string"?$(i.chars).json().chars:i.chars;const r=s(e.val(),n);if(!r.length){return[]}return[{field:e,msg:t(i.msgKey,r.map(e=>`'${e}'`).join(", "))}]}});function s(t,e){const i=[];const n=new Set(e);for(let e of t){if(!n.has(e)&&!i.includes(e)){i.push(e)}}return i}})();AGN.Lib.Validator.new("reject-script-element",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=[];var r=(new DOMParser).parseFromString(e.val(),"text/html").querySelector("script");if(r){n.push({field:e,msg:t("fields.errors.illegal_script_element")})}return n}});AGN.Lib.Validator.new("required-id",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){if(e.data("select2")&&!e.parent().find(".select2-container").is(":visible")){return[]}var n=e.val();var r=parseInt(n);var s=[];if(isNaN(r)||r.toString()!==n.toString().trim()||r<=0&&i.positive!==false){s.push({field:e,msg:t("fields.required.errors.missing")})}return s}});AGN.Lib.Validator.new("unique-mobile-base",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=AGN.Lib.Select.get(e).getSelectedValue();var r=e.attr("id");var s=[];if(!this.isUniqueMobileBase(n,r)){s.push({field:e,msg:t("fields.mediapool.errors.mobile_base_duplicate")})}return s},isUniqueMobileBase:function(t,e){if(t==""){return true}var i=$("[id^=image-mobile-base]:not(#"+e+")").filter(function(){var e=$(this);return AGN.Lib.Select.get(e).getSelectedValue()===t});return i.length===0}});AGN.Lib.Validator.new("upload-file/form",{valid:function(e,i,n){let r=true;const s=e.get$();if(s.data("upload-selection").length<1){AGN.Lib.Messages(t("defaults.error"),t("error.upload.file"),"alert");r=false}return n&&r&&!this.errors(e,i).length},errors:function(e,i){const n="error.workflow.shortName";const o="fields.required.errors.missing";var r=[{field:$("#name"),minLength:{val:3,msgKey:n},maxLength:99},{field:$("#firstName"),minLength:{val:3,msgKey:n},maxLength:99},{field:$("#phone"),minLength:{val:1,msgKey:o},maxLength:99},{field:$("#email"),maxLength:99,regexpRules:[{regexp:/\S+@\S+\.\S{2,}/,message:t("error.upload.email")}]}];var a=[];r.forEach(function(e){var i=e.field;var n=i.val();if(!n||n.length<1){a.push({field:i,msg:t(o)});return}if(e.minLength&&n.length<e.minLength.val){a.push({field:i,msg:t(e.minLength.msgKey)});return}if(e.maxLength&&n.length>e.maxLength){a.push({field:i,msg:t("fields.errors.contentLengthExceedsLimit",e.maxLength)});return}if(e.regexpRules&&e.regexpRules.length>0){for(var r=0;r<e.regexpRules.length;++r){var s=e.regexpRules[r];if(!n.match(s.regexp)){a.push({field:i,msg:s.message});return}}}});return a}});AGN.Lib.Validator.new("userform-edit/form",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e,i){var n=[];var r=$('[name="formName"]');if(!r.val().match(/^[a-zA-Z0-9-_]+$/gi)){n.push({field:r,msg:t("userform.error.invalid_name")})}this.validateUrlField(n,"success");this.validateUrlField(n,"error");this.validateTemplateField(n,$("#successTemplate"),"SUCCESS");this.validateTemplateField(n,$("#errorTemplate"),"ERROR");return n},validateUrlField(e,i){const n=$(`#${i}URL`);if($(`[name="${i}Settings.useUrl"]`).prop("checked")&&!AGN.Lib.Helpers.isUrl(n.val())){e.push({field:n,msg:t(`userform.error.invalid_${i}Url`)})}},validateTemplateField:function(e,i,n){const r=n.toLowerCase();if(!$(`[name="${r}Settings.useUrl"]`).prop("checked")&&!i.val().trim()){e.push({field:$(`#${r}-form-editor .tile-body`),msg:t(`userform.error.invalid_${r}Html`)})}if(!this.validateDirectives(e,i)){return false}if(!this.validateHrefPattern(e,i,n)){return false}},validateDirectives:function(e,i){var n=i.val().match(/#(?:include|parse)/gi);if(n){e.push({field:i,msg:t("userform.error.illegal_directive",n.join(", "))});return false}return true},validateHrefPattern:function(e,i,n){var r=i.val();var s=r.search(/\shref\s*=\s*(["'])\s/gi);if(s!=-1){var o=r.slice(0,s).match(/\r?\n/g).length+1;e.push({field:i,msg:t("userform.error.invalid_link",n,o)});return false}return true}});AGN.Lib.Dashboard.Def={LAYOUT:{DEFAULT:{COLS_COUNT:3,ROWS_COUNT:2,SCHEMA:[{id:"mailings"},{id:"statistics"},{id:"imports-exports"},{id:"calendar"},{id:"news"}]}},TileSize:{REGULAR:{dimensions:[1,1],name:"regular"},TALL:{dimensions:[2,1],name:"tall"},WIDE:{dimensions:[1,2],name:"wide"},X_WIDE:{dimensions:[1,3],name:"x-wide"},X_LARGE:{dimensions:[2,3],name:"xl"},from:function(t){for(let e in this){if(this[e].name===t){return this[e]}}return null}}};(()=>{const n=AGN.Lib.Dashboard.Def.TileSize;class e{constructor(e,t,i){this.rows=e;this.cols=t;this.swapper=new AGN.Lib.Dashboard.TileSwapper(this);this.$container=$("#dashboard-tiles");this.$container.on("agn:grid-modified",(e,t)=>this.onGridTileModified(t));this.fillGrid(i)}fillGrid(e){this.#sortTilesByPosition(e);this.removeAllTiles();e.forEach(e=>e.displayIn(this.$container));this.$container.removeClass((e,t)=>(t.match(/\bdashboard-grid-cols-\S+/g)||[]).join(" "));this.$container.addClass(`dashboard-grid-cols-${this.cols}`)}#sortTilesByPosition(e){e.sort((e,t)=>{const i=e.position.rows[0];const n=e.position.cols[0];const r=t.position.rows[0];const s=t.position.cols[0];if(i!==r){return i-r}return n-s})}removeAllTiles(){this.$tiles.each((e,t)=>$(t).data("tile").remove())}get visibleTiles(){return this.tiles.filter(e=>e.$el.css("visibility")!=="hidden")}get schema(){return{COLS_COUNT:this.cols,SCHEMA:this.tiles.map(({id:e,position:t})=>({id:e,position:t}))}}isCellFree(e,t){const i=this.getTile(e,t);return!i||i.isEmpty}canPlaceTile(e,r,s){const[t,o]=e.dimensions;for(let n=0;n<t;n++){for(let i=0;i<o;i++){let e=r+n;let t=s+i;if(e>=this.rows||t>=this.cols||!this.isCellFree(e,t)){return false}}}return true}onGridTileModified(e){this.updateTilesPositions();if(e){this.swapper.initDragAndDrop(e)}}placeTileAtPos(e,t,i){if(!this.canPlaceTile(e.size,t,i)){return}const[n,r]=e.size.dimensions;this.getInterferingTiles(n,r,t,i).forEach(e=>e?.remove());this.insertTile(e,t,i)}getInterferingTiles(e,i,n,r){return _.flatMap(_.range(e),t=>_.range(i).map(e=>this.getTile(n+t,r+e)).filter(Boolean))}insertTile(e,t,i){const n=this.getTile(t,i);const r=this.getPreviousTileOf(n);if(r){e.insertAfter(r)}else if(n){e.insertBefore(n)}else{e.displayIn(this.$container)}}getPreviousTileOf(t){if(!t){return null}const e=this.tiles;const i=e.findIndex(e=>e===t);return i>0?e[i-1]:null}get tiles(){return this.$tiles.toArray().map(e=>$(e).data("tile"))}get tallTiles(){return this.tiles.filter(e=>e.isTall)}get xlTiles(){return this.tiles.filter(e=>e.isXl)}get wideTiles(){return this.tiles.filter(e=>e.isWide)}get xWideTiles(){return this.tiles.filter(e=>e.isXWide)}get $tiles(){return $(".draggable-tile")}getTile(t,i){return this.tiles.find(e=>e.position.rows.includes(t)&&e.position.cols.includes(i))}getPossibleStartPositions(i,e,n){const[r,s]=i.dimensions;const o=[];for(let t=e-r+1;t<=e;t++){for(let e=n-s+1;e<=n;e++){if(t>=0&&e>=0&&this.canPlaceTile(i,t,e)){o.push([t,e])}}}return o}placeTileAroundPos(e,t,i){const n=this.getPossibleStartPositions(e.size,t,i);if(n.length>0){const[r,s]=n[0];this.placeTileAtPos(e,r,s)}}createEmptyTile(){return new AGN.Lib.Dashboard.EmptyTile}removeTile(e){if(!e){return}e.remove();const{rows:t,cols:i}=e.position;t.forEach(t=>i.forEach(e=>this.insertTile(this.createEmptyTile(),t,e)))}updateTilesPositions(){const t=this.tiles;const i={row:0,col:-1};t.forEach(e=>e.position={rows:[],cols:[]});t.forEach(e=>e.position=this.calculateTilePositionInGrid(t,e.size,i))}calculateTilePositionInGrid(e,t,i){i.col=i.col+1;if(i.col>=this.cols){i.row=i.row+1;i.col=0}while(this.isPositionAlreadyTakenByOtherExtendedTile(e,i.row,i.col)){i.col=i.col+1}switch(t){case n.TALL:return{rows:[0,1],cols:[i.col]};case n.WIDE:i.col=i.col+1;return{rows:[i.row],cols:[i.col-1,i.col]};case n.X_WIDE:i.col=i.col+2;return{rows:[i.row],cols:[i.col-2,i.col-1,i.col]};case n.X_LARGE:i.col=i.col+2;return{rows:[0,1],cols:[i.col-2,i.col-1,i.col]};default:return{rows:[i.row],cols:[i.col]}}}isPositionAlreadyTakenByOtherExtendedTile(e,t,i){return e.filter(e=>!e.isRegular).some(e=>e.position.rows.includes(t)&&e.position.cols.includes(i))}}AGN.Lib.Dashboard.DashboardGrid=e})();(()=>{const i=AGN.Lib.Dashboard.Def.TileSize;class e{constructor(e){this.grid=e}toggle(e){this.grid.$tiles.draggable("option","disabled",!e)}initDragAndDrop(e){this.setDraggable(e);this.setDroppable(e)}setDraggable(e){const t=this;e.$el.draggable({containment:this.grid.$container,opacity:.7,zIndex:1e3,cursor:"move",scroll:false,helper:function(e){const t=$(e.currentTarget);return t.clone(true).css({animation:"none",width:t.width(),height:t.height()})},start(){$(this).css({opacity:0});t.switchNotAllowedDroppables($(this),false)},stop(){$(this).css({opacity:1});t.switchNotAllowedDroppables($(this),true)}})}switchNotAllowedDroppables(e,t){this._getNotAllowedDroppablesToSwitch(AGN.Lib.Dashboard.DraggableTile.get(e)).forEach(e=>e.switchDroppable(t))}_getNotAllowedDroppablesToSwitch(e){if(e.isRegular){return this.grid.tiles.filter(e=>!e.isRegular)}if(e.isTall){return[...this.getTilesUnderOrAboveWideTiles(),...this.grid.wideTiles,...this.grid.xWideTiles]}if(e.isWide){return[...this.getTilesLockedByTallTiles(),...this.grid.tallTiles,...this.grid.xWideTiles]}if(e.isXWide){return[...this.grid.tallTiles,...this.grid.xlTiles]}return[]}setDroppable(e){const r=this;e.$el.droppable({accept:".draggable-tile",tolerance:"pointer",activeClass:"draggable-accept",over:function(e,t){r.unhighlightAll();const i=AGN.Lib.Dashboard.DraggableTile.get(t.draggable);const n=AGN.Lib.Dashboard.DraggableTile.get($(this));r.getReadyToSwapTiles(i,n).forEach(e=>e.toggleHighlight(true))},drop:async function(e,t){const i=AGN.Lib.Dashboard.DraggableTile.get(t.draggable);const n=AGN.Lib.Dashboard.DraggableTile.get($(this));await r.swapTiles(i,n);r.grid.updateTilesPositions()},deactivate:()=>r.unhighlightAll()})}getReadyToSwapTiles(e,t){switch(e.size){case i.TALL:case i.X_LARGE:return this.getTilesHoveredByTallTile(t);case i.WIDE:return this.getTilesHoveredByWideTile(e,t);case i.X_WIDE:return this.getTilesHoveredByExtraWideTile(e,t);default:return[t]}}getTilesHoveredByTallTile(e){const{beginCol:t}=e;const i=[this.grid.getTile(0,t)];const n=this.grid.getTile(1,t);if(!i[0].isTall){i.push(n)}return i}getTilesHoveredByWideTile(e,t){return e.beginRow===t.beginRow?this.getTilesHoveredByWideTileAtSameRow(e,t):this.getTilesHoveredByWideTileAtAnotherRow(e,t)}getTilesHoveredByWideTileAtSameRow(e,t){const{beginCol:i,beginRow:n}=e;if(t.beginCol===i-2||t.beginCol===i+3){return[t,this.grid.getTile(n,t.beginCol)]}return[t]}getTilesHoveredByWideTileAtAnotherRow(e,t){const{beginCol:i,beginRow:n}=t;const r=this.grid.getTile(n,i+1);const s=this.grid.getTile(n,i-1);if(!this.isFirstCol(i)&&s.isRegular){return[t,s]}else if(!this.isLastCol(i)&&r.isRegular){return[t,r]}return[]}getTilesHoveredByExtraWideTile(e,t){return e.beginRow===t.beginRow?[t]:this.getTilesHoveredByExtraWideTileAtAnotherRow(e,t)}getTilesHoveredByExtraWideTileAtAnotherRow(e,t){const{beginCol:i,beginRow:n}=t;const r=this.grid.getTile(n,i+1);const s=this.grid.getTile(n,i+2);const o=this.grid.getTile(n,i-1);const a=this.grid.getTile(n,i-2);let l;if(this.isFirstCol(i)){l=[t,r,s]}else if(this.isLastCol(i)){l=[a,o,t]}else{l=e.position.cols.map(e=>this.grid.getTile(n,e))}l=[...new Set(l)];const c=l.filter(e=>e.isRegular).length;const u=l.filter(e=>e.isWide).length;return c===3||c===1&&u===1?l:[]}unhighlightAll(){this.grid.tiles.forEach(e=>e.toggleHighlight(false))}async swapTiles(e,t){switch(e.size){case i.TALL:this.moveTallTile(e,t);break;case i.WIDE:this.moveWideTile(e,t);break;case i.X_WIDE:this.moveExtraWideTile(e,t);break;case i.X_LARGE:this.moveXlTile(e,t);break;default:e.swap(t);break}}moveTallTile(e,t){const i=e.beginCol;const n=t.beginCol;const r=this.grid.getTile(0,n);const s=this.grid.getTile(1,n);const o=this.getPreviousTileOfTallTileBottomPart(i);if(r.$el.is(o.$el)){o.$el.after(s.$el);e.swap(r)}else{e.swap(r);if(!r.isTall){o.$el.after(s.$el)}}}getPreviousTileOfTallTileBottomPart(e){if(this.isFirstCol(e)){return this.grid.getTile(0,this.grid.cols-1)}if(this.grid.getTile(1,e-1).isTall){return this.getPreviousTileOfTallTileBottomPart(e-1)}return this.grid.getTile(1,e-1)}getTilesUnderOrAboveWideTiles(){return[...this.grid.wideTiles,...this.grid.xWideTiles].map(e=>{const t=e.beginRow===0?1:0;return e.position.cols.map(e=>this.grid.getTile(t,e))}).flat()}getTilesLockedByTallTiles(){return this.grid.tiles.filter(e=>e.isRegular&&(this.isFirstCol(e.beginCol)&&this.grid.getTile(e.beginRow,1).isTall)||this.isLastCol(e.beginCol)&&this.grid.getTile(e.beginRow,this.grid.cols-2).isTall)}moveWideTile(e,t){if(e.beginRow===t.beginRow){this.moveWideTileAtSameRow(e,t)}else{this.moveWideTileToAnotherRow(e,t)}}moveWideTileAtSameRow(e,t){const{beginCol:i,beginRow:n}=e;if(t.beginCol===i-2){this.grid.getTile(n,i-2).$el.before(e.$el)}else if(t.beginCol===i+3){this.grid.getTile(n,i+3).$el.after(e.$el)}else{e.swap(t)}}moveWideTileToAnotherRow(e,t){const{beginCol:i,beginRow:n}=t;const r=this.grid.getTile(n,i+1);const s=this.grid.getTile(n,i-1);if(!this.isFirstCol(i)&&s.isRegular){this.replaceWideTileWithDroppableAndPrev(e,t,s)}else if(!this.isLastCol(i)&&r.isRegular){this.replaceWideTileWithDroppableAndNext(e,t,r)}}replaceWideTileWithDroppableAndNext(e,t,i){e.swap(t);t.$el.after(i.$el)}replaceWideTileWithDroppableAndPrev(e,t,i){e.swap(i);i.$el.after(t.$el)}moveExtraWideTile(e,t){if(e.beginRow===t.beginRow){e.swap(t)}else{this.moveExtraWideTileToAnotherRow(e,t)}}moveExtraWideTileToAnotherRow(e,t){const[i,n,r]=this.getTilesHoveredByExtraWideTile(e,t);if(i){e.swap(i)}if(n){i.$el.after(n.$el)}if(r){n.$el.after(r.$el)}}moveXlTile(e,t){const i=t.beginCol;const n=this.grid.getTile(0,i);const r=this.grid.getTile(1,i);if(this.isLastCol(i)){e.$el.before(n.$el)}else{e.$el.after(n.$el)}if(!n.isTall){(this.isLastCol(i)?e.$el:n.$el).after(r.$el)}}isFirstCol(e){return e===0}isLastCol(e){return e===this.grid.cols-1}}AGN.Lib.Dashboard.TileSwapper=e})();(()=>{const e=AGN.Lib.Template;const t=AGN.Lib.Popover;class i{static SELECTOR=".xl-calendar-label";constructor(e){this.data=e;if(!this.$day.exists()&&!this.data.inUnsentList){return}this.create$()}get date(){return this.data.date}get $day(){return $(`${this.Calendar.DAY_SELECTOR}[data-date="${this.date}"]`)}get $elText(){return this.$el.find(`${i.SELECTOR}__text`)}create$(){this.$el=e.dom(this.templateName,this.templateParams);this.attachToCalendar();this.createPopover();this.$el.data("label",this);if(this.draggable){this.initDragging()}AGN.Lib.CoreInitializer.run("tooltip",this.$el);return this.$el}attachToCalendar(){if(this.data.inUnsentList){this.attachToUnsentMailings()}else{this.attachToDay()}}attachToDay(){this.$day.find(`${this.Calendar.DAY_SELECTOR}__body`).append(this.$el)}attachToUnsentMailings(){this.unsentMailings$.append(this.$el);AGN.Lib.CoreInitializer.run(["tooltip","scrollable"],this.unsentMailings$)}get unsentMailings$(){return $(this.Calendar.UNSENT_MAILINGS_LIST_SELECTOR)}get draggable(){return true}get templateParams(){return{labelId:this.labelId}}get labelId(){return`xl-calendar-${this.type}-${this.entityId}`}get entityId(){throw new Error("entityId() must be implemented in extended class")}get templateName(){return`xl-calendar-${this.type}-label`}get type(){return this.constructor.TYPE}get popoverOptions(){throw new Error("popoverOptions() must be implemented in extended class")}get Calendar(){return AGN.Lib.Dashboard.XlCalendar}initDragging(){this.$el.draggable({cursor:"move",containment:$("#xl-calendar-tile .tile-body"),distance:20,appendTo:"body",zIndex:2,helper:function(e){const t=$(e.currentTarget);return t.clone(true).css({width:t.width(),height:t.height()})},start:()=>this.onDragStart(),stop:()=>this.onDragStop(),revert:e=>{if(!e){this.show()}return false}})}createPopover(){t.remove(this.$elText);t.create(this.$elText,this.popoverOptions)}#toggleVisibility(e){this.$el.css({opacity:e?"1":"0"})}show(){this.#toggleVisibility(true)}hide(){this.#toggleVisibility(false)}onDragStart(){this.hide();this.#disableAllPopovers();this.#clearSelection()}onDragStop(){this.#enableAllPopovers()}#disableAllPopovers(){_.each($(i.SELECTOR),e=>t.get($(e))?.disable())}#enableAllPopovers(){_.each($(i.SELECTOR),e=>t.get($(e))?.enable())}#clearSelection(){let e;if(document.selection&&document.selection.empty){document.selection.empty()}else if(window.getSelection){e=window.getSelection();if(e&&e.removeAllRanges)e.removeAllRanges()}}drop(e){if(!this.canMoveTo(e)){this.show();return}this.moveTo(e)}canMoveTo(e){return!e.is(this.$day)}moveTo(e){const t=this.Calendar.getLastLabelOfType(e,this.type);if(t?.length){t.$el.after(this.$el)}else{e.find(`${this.Calendar.DAY_SELECTOR}__body`).append(this.$el)}this.show()}remove(){this.$el.remove()}static get(e){return e.data("label")}static getByEntityId(e,t){return $(`#xl-calendar xl-calendar-${t}-${e}`).data("label")}}AGN.Lib.Dashboard.XlCalendarLabel=i})();(()=>{const t=AGN.Lib.Modal;const e=AGN.Lib.Form;const i=AGN.Lib.Dashboard.XlCalendarLabel;class n extends i{static TYPE="comment";static SELECTOR=i.SELECTOR+"--comment";constructor(e){super(e)}attachToDay(){this.$day.find(`${this.Calendar.DAY_SELECTOR}__body`).prepend(this.$el)}get templateParams(){return _.merge(super.templateParams,{comment:this.data.comment})}get entityId(){return this.data.commentId}get form(){return e.get($("#calendar-comment-form"))}get saveUrl(){return AGN.url("/calendar/saveComment.action")}get popoverOptions(){return{trigger:"hover",html:true,text:this.data.comment.replace(/\n/g,"<br>")}}moveTo(t){this.data.date=t.data("date");$.post(this.saveUrl,this.data).done(e=>{if(e.commentId){t.find(`${this.Calendar.DAY_SELECTOR}__body`).prepend(this.$el)}this.show()})}remove(){$.post(AGN.url("/calendar/removeComment.action"),{commentId:this.entityId}).done(()=>super.remove())}updateComment(e){this.data=e;this.$elText.text(this.data.comment);this.createPopover()}showModal(){n.showModal(this.data)}static showModal(e){e=_.extend(n.createNewEmptyComment(e.date),e);e.comment=e.comment?.replace(/<br>/gi,"\n");if(!e.recipients){e.recipients=[]}e.recipients=(Array.isArray(e.recipients)?e.recipients:e.recipients.split(",")).map(e=>e.trim()).filter(e=>e!=="");e.isCustomRecipients=!!e.recipients.length;e.sendReminder=!!e.deadline;t.fromTemplate("calendar-comment-modal",e)}static createNewEmptyComment(e){return{commentId:0,comment:"",recipients:[],deadline:false,plannedSendDate:e+" 08:00"}}static getOrCreate(e){const t=i.getByEntityId(e.commentId,n.TYPE);if(t){return t}return new n(e)}}AGN.Lib.Dashboard.XlCalendarCommentLabel=n})();(()=>{const i=AGN.Lib.Dashboard.XlCalendarLabel;const e=AGN.Lib.Storage;class o extends i{static TYPE="mailing";constructor(e,t){super(e);this.limit=t}get templateParams(){return _.merge(super.templateParams,{link:this.data.link,mediatype:"mailing.mediatype."+this.data.mediatype?.toLowerCase(),status:this.data.workstatus,shortname:this.data.shortname})}get draggable(){return!(this.data.inUnsentList&&this.data.planned)}get date(){return this.data.sendDate}set date(e){return this.data.sendDate=e}get entityId(){return this.data.mailingId}get isUnsentPlannedListSelected(){return e.get(this.Calendar.UNSENT_MAILINGS_STORAGE_KEY)==="planned"}createPopover(){this.data.$el=this.$elText;AGN.Lib.Dashboard.CalendarBase.createMailingPopover(this.data)}canMoveTo(e){if(!super.canMoveTo(e)){return false}if(this.data.sent===true){return false}if(e.is(this.unsentMailings$)){return!this.isUnsentPlannedListSelected&&this.data.workstatus!=="mailing.status.scheduled"}const t=e.data("date");return moment(t+this.data.sendTime,"DD-MM-YYYY HH:mm").toDate()>=new Date}moveTo(e){if(e.is(this.unsentMailings$)){this.moveToUnsentList()}else{this.moveToDay(e)}}moveToDay(t){const i=t.data("date");$.post(AGN.url("/calendar/moveMailing.action"),{mailingId:this.entityId,date:i}).done(e=>{if(e.success===true){this.insertLabelInDay(t);this.date=i}this.show()})}moveToUnsentList(){$.post(AGN.url(`/calendar/mailing/${this.entityId}/clearPlannedDate.action`)).done(e=>{if(e){this.date="";this.unsentMailings$.append(this.$el)}}).always(()=>this.show())}insertLabelInDay(e){const t=e.data("date");let i=this.data.time;const n=moment(t+i,"DD-MM-YYYY HH:mm").toDate();const r=new Date(n);r.setHours(r.getHours()-3);if(r<new Date){i=null;this.data.time=null}let s=false;if(i){this.Calendar.getLabelsByType(e,o.TYPE).reverse().map(e=>e.data.time<i).forEach(e=>{e.$el.after(this.$el);s=true})}if(!s){super.moveTo(e)}}static getOrCreate(e){const t=i.getByEntityId(e.mailingId,o.TYPE);if(t){return t}return new o(e)}}AGN.Lib.Dashboard.XlCalendarMailingLabel=o})();(()=>{const i=AGN.Lib.Dashboard.XlCalendarLabel;class n extends i{static TYPE="auto-opt";constructor(e){super(e)}get templateParams(){return _.merge(super.templateParams,{link:this.link,mediatype:"mailing.mediatype.email",status:"mailing.status."+this.adaptStatus(this.data.autoOptimizationStatus),shortname:this.data.shortname})}get draggable(){return false}get link(){if(!this.data.workflowId){return"#"}return AGN.url("workflow/"+this.data.workflowId+"/view.action")}adaptStatus(e){switch(e){case"NOT_STARTED":return"new";case"FINISHED":return"sent";default:return e.toLowerCase()}}get templateName(){return"xl-calendar-mailing-label"}get date(){return this.data.sendDate}get entityId(){return this.data.id}get popoverOptions(){return{trigger:"hover",text:this.data.shortname}}static getOrCreate(e){const t=i.getByEntityId(e.id,n.TYPE);if(t){return t}return new n(e)}}AGN.Lib.Dashboard.XlCalendarAutoOptLabel=n})();(()=>{const i=AGN.Lib.Dashboard.XlCalendarLabel;class n extends i{static TYPE="push";constructor(e){super(e)}get draggable(){return this.data.status!==n.pushStatusSent}get templateParams(){return _.merge(super.templateParams,{link:AGN.url(`/push/${this.entityId}/view.action`),mediatype:"status.push",status:"mailing.status."+this.data.status.toLowerCase(),shortname:this.data.name})}get templateName(){return"xl-calendar-mailing-label"}get date(){switch(this.data.status){case n.pushStatusSent:return this.data.sendDate;case n.pushStatusScheduled:return this.data.startDate;default:return this.data.plannedFor}}set date(e){switch(this.data.status){case n.pushStatusSent:this.data.sendDate=e;break;case n.pushStatusScheduled:this.data.startDate=e;break;default:this.data.plannedFor=e;break}}get entityId(){return this.data.id}get popoverOptions(){return{trigger:"hover",text:this.data.name}}canMoveTo(e){if(!super.canMoveTo(e)){return false}const t=e.data("date");switch(this.data.status){case n.pushStatusSent:return false;case n.pushStatusScheduled:return moment(t,"DD-MM-YYYY").toDate()>=new Date;default:return true}}moveTo(t){const i=t.data("date");this.$el.hide();$.post(AGN.url("/calendar/movePushNotification.action"),{pushId:this.entityId,date:i}).done(e=>{if(e.success===true){super.moveTo(t);this.date=i}})}static getOrCreate(e){const t=i.getByEntityId(e.commentId,n.TYPE);if(t){return t}return new n(e)}}AGN.Lib.Dashboard.XlCalendarPushLabel=n})();(()=>{const i=AGN.Lib.Template;const t=AGN.url("/mailing/:mailingId:/settings.action");const n=AGN.url("/statistics/mailing/:mailingId:/view.action?init=true");class r{constructor(e,t){this.$el=e;this.firstDayOfWeek=t.firstDayOfWeek;this.statisticsViewAllowed=t.statisticsViewAllowed}get $year(){throw this.notImplementedError("$year()")}get $month(){throw this.notImplementedError("$month()")}get removeCurrentCalendar(){throw this.notImplementedError("removeCurrentCalendar()")}isToday(e){return moment(e).isSame(moment(),"day")}showMonth(t,e){this.removeCurrentCalendar();const i=this.daysInMonth(t+1,e);let n=new Date(e,t,1);let r=n.getDay()-this.firstDayOfWeek;if(r<0){r=7+r}const s=Math.ceil((i+r)/7);const o=new Date(e,t,1-r);const a=new Date(e,t,1+s*7);n=new Date(o);for(let e=0;e<s;e++){const u="row-"+(e+1);this.addWeekNumber(n,u);for(let e=0;e<7;e++){const d=n.getMonth()!==t;this.addDay(n,d,u);n.setDate(n.getDate()+1)}}const l=this.dateToServiceFormat(o);const c=this.dateToServiceFormat(a);this.fillCalendar(l,c);this.synchronizeMonthsList(t,e)}addWeekNumber(){throw this.notImplementedError("addWeekNumber()")}addDay(){throw this.notImplementedError("addDay()")}fillCalendar(){throw this.notImplementedError("fillCalendar()")}notImplementedError(e){return new Error(`${e} must be implemented in extended class`)}getMailingLink(e){return e.sent&&e.workstatus!=="mailing.status.test"&&this.statisticsViewAllowed?n.replace(":mailingId:",e.mailingId):t.replace(":mailingId:",e.mailingId)}addYearOption(){const e=$("#month_list_year");const t=parseInt(e.find("option:last").val(),10)+1;e.append($("<option></option>").val(t).text(t))}lastYearSelected(){return $("#month_list_year option:selected").index()===$("#month_list_year option").length-1}daysInMonth(e,t){return new Date(t,e,0).getDate()}synchronizeMonthsList(e,t){this.$year[0].selectedIndex=this.$year.find(`option[value=${t}]`)[0].index;this.$month[0].selectedIndex=this.$month.find(`option[value=${e}]`)[0].index;AGN.runAll(this.$year);AGN.runAll(this.$month)}static pad(e,t){let i=e+"";while(i.length<t)i="0"+i;return i}dateToServiceFormat(e){let t=r.pad(e.getDate(),2);let i=r.pad(e.getMonth()+1,2);let n=e.getFullYear();return t+"-"+i+"-"+n}getWeek(e){var t=new Date(e.valueOf());var i=t.getFullYear();var n=t.getMonth();var r=t.getDate();if(this.firstDayOfWeek===0){r=r+1}n=n+1;var s=Math.floor((14-n)/12);var o=i+4800-s;var a=n+12*s-3;var l=r+Math.floor((153*a+2)/5)+365*o+Math.floor(o/4)-Math.floor(o/100)+Math.floor(o/400)-32045;var c=(l+31741-l%7)%146097%36524%1461;var u=Math.floor(c/1460);var d=(c-u)%365+u;return Math.floor(d/7)+1}static createMailingPopover(e){e.thumbnailUrl=AGN.url(r.getMailingThumbnailSrc(e.thumbnailComponentId,e.post));const t=i.dom("calendar-mailing-popover-content",e);AGN.Lib.Popover.getOrCreate(e.$el,{trigger:"hover",html:true,content:t})}static getMailingThumbnailSrc(e,t){if(t){return"/assets/core/images/facelift/post_thumbnail.jpg"}if(e){return"/sc?compID="+e}return"/assets/core/images/facelift/no_preview.svg"}}AGN.Lib.Dashboard.CalendarBase=r})();(()=>{const r=AGN.Lib.DateFormat;const s=AGN.Lib.Template;const i=AGN.Lib.Dashboard.CalendarBase;const n=AGN.url("/calendar/mailingsLight.action");const o=AGN.url("/calendar/mailingsPopoverInfo.action");class e extends i{constructor(e,t){super(e,t);this.$el=e;this.firstDayOfWeek=t.firstDayOfWeek;this.statisticsViewAllowed=t.statisticsViewAllowed;this.#init()}get $month(){return $("#month_list")}get $year(){return $("#month_list_year")}#init(){const e=new Date;this.#displayWeekDays();this.showMonth(e.getMonth(),e.getFullYear());this.$el.on("change","#month_list, #month_list_year",this.switchMonth.bind(this))}#displayWeekDays(){AGN.Lib.DateFormat.getLocalizedShortWeekdays(window.adminLocale,this.firstDayOfWeek).forEach(e=>{$("#calendar-header").append(`<td><div class="calendar-cell">${e}</div></td>`)})}addWeekNumber(e,t){const i=this.getWeek(e);$("#calendar-container").append(`<tr id="${t}"><td><div class="calendar-cell">${i}</div></td></tr>`)}addDay(e,t,i){const n=!t&&this.isToday(e);const r=this.dateToServiceFormat(new Date(e.getFullYear(),e.getMonth(),e.getDate()));const s="day-"+r;$("#"+i).append(`<td id="${s}"></td>`);$("#"+s).append(`<div class="calendar-cell calendar-day ${n?"calendar-day--today":""} ${t?"calendar-day--alien":""}" id="label-${s}" data-date="${r}">${e.getDate().toString().padStart(2,"0")}</div>`)}fillCalendar(e,t){$.get(n,{start:e,end:t}).done(e=>this.assignMailingsToCalendarDays(e))}removeCurrentCalendar(){$("#calendar-container tr:not(:first)").remove()}assignMailingsToCalendarDays(e){e.forEach(e=>e.link=this.getMailingLink(e));const t=_.groupBy(e,"sendDate");this.makeDaysSelectable(t);this.makeCurrentDayActive(t)}makeCurrentDayActive(e){const t=this.dateToServiceFormat(new Date);$("#day-"+t).click(()=>this.changeSelectedDay(t,e[t]));this.changeSelectedDay(t,e[t])}makeDaysSelectable(r){_.forEach($(".calendar-day"),e=>{const t=$(e);const i=t.data("date");const n=r[i];if(!_.isEmpty(n)){$("#label-day-"+i).addClass("calendar-day--selectable")}t.click(()=>this.changeSelectedDay(i,_.sortBy(n,"sendTime")))})}changeSelectedDay(e,t){$("#calendar-container").find(".calendar-day--selected").removeClass("calendar-day--selected");$("#label-day-"+e).addClass("calendar-day--selected");const i=r.parseFormat(e,"dd-MM-yy");const n=i.toLocaleString(window.adminLocale,{weekday:"long"});e=AGN.Lib.DateFormat.format(i,window.adminDateFormat);$("#calendar-tile-day-mailings").html(s.dom("dashboard-schedule-day",{dayOfWeek:n,dateStr:e,dayMailings:t}));this.createPopovers(t)}createPopovers(e){if(!e?.length){return}const t=e.map(e=>e.mailingId).join(",");$.get(o,{mailingIds:t}).done(e=>e.map(e=>({...e,$el:$(`.schedule__day-mailing[data-mailing-id="${e.mailingId}"]`)})).forEach(e=>i.createMailingPopover(e)))}switchMonth(){const e=parseInt($("#month_list option:selected").val());const t=parseInt($("#month_list_year option:selected").val());this.removeCurrentCalendar();this.showMonth(e,t);if(this.lastYearSelected()){this.addYearOption()}}}AGN.Lib.Dashboard.Calendar=e})();(()=>{const e=AGN.Lib.Form;const r=AGN.Lib.Template;const s=AGN.Lib.Modal;const t=AGN.Lib.Storage;const i=AGN.Lib.Select;const l=AGN.Lib.DateFormat;const o=AGN.Lib.Dashboard.XlCalendarLabel;const a=AGN.Lib.Dashboard.XlCalendarCommentLabel;const n=AGN.Lib.Dashboard.XlCalendarMailingLabel;const c=AGN.Lib.Dashboard.XlCalendarAutoOptLabel;const u=AGN.Lib.Dashboard.XlCalendarPushLabel;const d=AGN.Lib.Dashboard.CalendarBase;class h extends d{static TABLE_SELECTOR="#xl-calendar-table";static UNSENT_MAILINGS_LIST_SELECTOR="#xl-calendar-unsent .tile-body";static DAY_CLASS="xl-calendar-day";static DAY_SELECTOR=`.${h.DAY_CLASS}`;static UNSENT_MAILINGS_STORAGE_KEY="dashboard.xlCalendar.unsentType";static SHOW_COMMENTS_STORAGE_KEY="dashboard.xlCalendar.showComments";static MODE_STORAGE_KEY="dashboard.xlCalendar.mode";constructor(e,t){super(e,t);this.config=t;this.dayMailingsLimit=t.showALlMailingsPerDay?-1:5;this.initCalendarTable();this.initUnsentMailings()}get $table(){return $(h.TABLE_SELECTOR)}get week(){return parseInt(this.$week.val())}get month(){return parseInt(this.$month.val())}get year(){return parseInt(this.$year.val())}get $week(){return $("#xl-calendar-week")}get $year(){return $("#xl-calendar-year")}get $month(){return $("#xl-calendar-month")}get $weeksColumn(){return $("#xl-calendar-weeks")}get weeksSelect(){return i.get(this.$week)}get isCommentsShown(){return t.get(h.SHOW_COMMENTS_STORAGE_KEY)!==false}set isCommentsShown(e){t.set(h.SHOW_COMMENTS_STORAGE_KEY,e)}get isWeekMode(){return this.$el.hasClass("tile-x-wide")||t.get(h.MODE_STORAGE_KEY)==="week"}set mode(e){return t.set(h.MODE_STORAGE_KEY,e)}get unsentType(){return t.get(h.UNSENT_MAILINGS_STORAGE_KEY)||"unplanned"}set unsentType(e){return t.set(h.UNSENT_MAILINGS_STORAGE_KEY,e)}get currentDate(){if(this.isWeekMode){return moment(i.get(this.$week).$findOption(this.week).data("first-day"),"DD-MM-YYYY").toDate()}const e=new Date;const t=new Date(this.year,this.month);if(t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()){return e}return t}get unsentMailings$(){return $(h.UNSENT_MAILINGS_LIST_SELECTOR)}$day(e){return this.$table.find(`${h.DAY_SELECTOR}[data-date="${e}"]`)}initCalendarTable(){const e=new Date;if(this.isWeekMode){this.showWeek(e.getDate(),e.getMonth(),e.getFullYear())}else{this.showMonth(e.getMonth(),e.getFullYear())}}removeCurrentCalendar(){this.$table.empty();this.$weeksColumn.empty()}showWeek(e,t,i){this.removeCurrentCalendar();var n=6048e5;var r=new Date(i,t,e);r.setDate(e-r.getDay()-1+this.firstDayOfWeek);var s=new Date(r.getFullYear(),r.getMonth(),r.getDate());s.setDate(s.getDate()+1);if(t===0&&e===1&&this.getWeek(s)!==1){s.setTime(s.getTime()+n);r.setTime(r.getTime()+n)}for(let e=0;e<7;e++){r.setDate(r.getDate()+1);this.addDay(r,false)}const o=this.dateToServiceFormat(s);const a=this.dateToServiceFormat(r);this.fillCalendar(o,a);this.synchronizeWeeksList(e,t,i)}addWeekNumber(e){this.$weeksColumn.append(`<div>${this.getWeek(e)}</div>`)}addDay(e,t){const i=this.dateToServiceFormat(new Date(e.getFullYear(),e.getMonth(),e.getDate()));const n=r.dom("xl-calendar-day",{day:e.getDate(),date:i}).addClass(this.isToday(e)?`${h.DAY_CLASS}--today`:"").addClass(t?`${h.DAY_CLASS}--alien`:"");this.$table.append(n);AGN.Lib.CoreInitializer.run(["scrollable","tooltip"],n)}fillCalendar(e,t){if(this.isCommentsShown){this.getComments(e,t);this.commentsLoaded=true}this.getMailings(e,t,this.dayMailingsLimit);this.getPushNotifications(e,t);this.getAutoOptimizations(e,t);this.initDroppables()}changeYear(){if(this.isWeekMode){this.updateWeeksSelect()}this.flip()}flip(){this.jumpToDate(this.currentDate);if(this.lastYearSelected()){this.addYearOption()}}toggleMode(e){const t=this.currentDate;if(this.isWeekMode){this.synchronizeMonthsList(t.getMonth(),t.getFullYear())}else{this.synchronizeWeeksList(t.getDate(),t.getMonth(),t.getFullYear())}this.mode=e?"week":"month";this.flip()}jumpToDate(e){if(this.isWeekMode){this.showWeek(e.getDate(),e.getMonth(),e.getFullYear())}else{this.showMonth(e.getMonth(),e.getFullYear())}}jumpToday(){this.jumpToDate(new Date)}initDroppables(){$(h.DAY_SELECTOR).droppable({accept:o.SELECTOR,drop:this.dropLabel});this.unsentMailings$.droppable({accept:'[id^="xl-calendar-mailing-"]',drop:this.dropLabel})}dropLabel(e,t){const i=t.draggable;o.get(i).drop($(this))}getComments(e,t){$.get(AGN.url("/calendar/comments.action"),{startDate:e,endDate:t}).done(e=>_.each(e,e=>a.getOrCreate(e)))}initUnsentMailings(){$('[name="not-sent-mailings-list-type"]').on("change",e=>{this.unsentType=$(e.target).val();this.loadUnsentMailings()});this.loadUnsentMailings();$(`#${this.unsentType}-mailings-btn`).prop("checked",true)}loadUnsentMailings(){$.get(AGN.url(`/calendar/unsent-mailings/${this.unsentType}.action`)).done(e=>this.displayUnsentMailings(e))}displayUnsentMailings(e){this.unsentMailings$.empty();e.map(e=>this.asUnsentMailingData(e)).forEach(e=>new n(e))}asUnsentMailingData(e){return{...e,link:AGN.url(`/mailing/${e.mailingId}/settings.action`),mediatype:e.mediatype?.toLowerCase(),workstatus:"mailing.status."+e.status.toLowerCase(),labelId:`xl-calendar-unsent-${e.mailingId}`,inUnsentList:true,planned:this.unsentType==="planned",sent:false,sendTime:false,sentCount:false}}showMoreMailings(e){const t=e.closest(h.DAY_SELECTOR).data("date");this.getMailings(t,t,-1);e.remove()}getMailings(e,t,i){$.get(AGN.url("/calendar/mailings.action"),{startDate:e,endDate:t,limit:this.dayMailingsLimit+1}).done(e=>_.each(e,e=>this.addMailingLabel(e,i)))}addMailingLabel(e,t){const i=this.$day(e.sendDate);if(t>0&&i.find('[id^="xl-calendar-mailing-"]').length>=t){if(!i.find('[data-action="load-more-day-mailings"]').exists()){i.find(`${h.DAY_SELECTOR}__body`).append(r.text("xl-calendar-showMore-btn"))}return}e.link=this.getMailingLink(e);e.sentCount=e.mailsSent;e.subject=e.subject||"";e.thumbnailComponentId=e.preview_component;n.getOrCreate(e)}getAutoOptimizations(e,t){$.get(AGN.url("/calendar/autoOptimization.action"),{startDate:e,endDate:t}).done(e=>_.each(e,e=>c.getOrCreate(e)))}getPushNotifications(e,t){u.pushStatusSent=this.config.pushStatusSent;u.pushStatusScheduled=this.config.pushStatusScheduled;$.get(AGN.url("/calendar/pushes.action"),{startDate:e,endDate:t}).done(e=>_.each(e,e=>u.getOrCreate(e)))}toggleComments(e){this.$table.find(a.SELECTOR).toggle(e);this.isCommentsShown=e;if(e&&!this.commentsLoaded){const t=$(`${h.DAY_SELECTOR}:first`).data("date");const i=$(`${h.DAY_SELECTOR}:last`).data("date");this.getComments(t,i)}}createComment(e){a.showModal({date:e})}saveComment(t){const i=e.get($("#calendar-comment-form"));if(!i.validate()){return}const n=i.data();$.post(AGN.url("/calendar/saveComment.action"),n).done(e=>{if(!e.commentId){AGN.Lib.Page.render(e);return}if(!t){n.commentId=e.commentId;a.getOrCreate(n).$el.toggle(this.isCommentsShown)}else{o.getByEntityId(t,a.TYPE).updateComment(n)}s.getInstance(i.$form).hide()})}removeComment(e){o.getByEntityId(e,a.TYPE).remove()}updateWeeksSelect(){const e=[];var t;var i=6048e5;var n=new Date(this.year,0,1);n.setDate(1-n.getDay()-1+this.firstDayOfWeek);n.setDate(n.getDate()+1);var r=new Date(n.getFullYear(),n.getMonth(),n.getDate());r.setTime(n.getTime()+i-864e5);if(this.getWeek(n)!=1){n.setTime(n.getTime()+i);r.setTime(r.getTime()+i)}do{t={};t.number=this.getWeek(n);t.firstDay=new Date(n.getFullYear(),n.getMonth(),n.getDate());t.lastDay=new Date(r.getFullYear(),r.getMonth(),r.getDate());e.push(t);n.setTime(n.getTime()+i);r.setTime(r.getTime()+i)}while(this.getWeek(n)!==1&&n.getFullYear()===this.year);this.weeksSelect.resetOptions();for(var s in e){if(!e.hasOwnProperty(s))continue;var o=l.format(e[s].firstDay,window.adminDateFormat);var a=l.format(e[s].lastDay,window.adminDateFormat);this.weeksSelect.addOption(e[s].number,e[s].number+" : "+o+" - "+a);this.weeksSelect.$findOption(e[s].number).data("first-day",this.dateToServiceFormat(e[s].firstDay))}}synchronizeWeeksList(e,t,i){var n=6048e5;var r=new Date(i,t,e);r.setDate(e-r.getDay()-1+this.firstDayOfWeek);var s=new Date(r.getFullYear(),r.getMonth(),r.getDate());s.setDate(s.getDate()+1);if(t==0&&e==1&&this.getWeek(s)!=1){s.setTime(s.getTime()+n)}var o=this.getWeek(s);if(o==1){var a=new Date(s.valueOf()+n);if(s.getFullYear()!=a.getFullYear()){i=a.getFullYear()}}this.$year[0].selectedIndex=this.$year.find(`option[value=${i}]`)[0].index;AGN.runAll(this.$year);this.updateWeeksSelect();this.$week[0].selectedIndex=this.$week.find(`option[value=${o}]`)[0].index;AGN.runAll(this.$week)}static getLabelsByType(e,t){return e.find(o.SELECTOR).map(e=>o.get($(e))).filter(e=>e.type===t)}static getLastLabelOfType(e,t){return h.getLabelsByType(e,t).slice(-1)[0]}}AGN.Lib.Dashboard.XlCalendar=h})();(()=>{AGN.Lib.Validator.new("calendar-comment",{valid:function(e,t){return!this.errors(e,t).length},errors:function(){const e=i();if($('[name="isCustomRecipients"]').val()==="true"){e.push(...n())}return e}});function i(){const e=[];const i=$("#comment-text");const n=i.val();if(_.isEmpty(_.trim(n))){e.push({field:i,msg:t("calendar.error.empty_comment")})}if(s(n)>1e3){e.push({field:i,msg:t("calendar.error.long_comment")})}return e}function n(){const i=[];const n=$('[name="recipients"]');const e=n.val().filter(e=>e?.trim()!=="");if(!e?.length){i.push({field:n,msg:t("calendar.error.empty_recipient_list")})}const r=e.join(",");if(s(r)>2e3){i.push({field:n,msg:t("calendar.error.long_recipient_list")})}_.each(e,e=>{if(!AGN.Lib.Helpers.isValidEmail(e)){i.push({field:n,msg:t("calendar.error.invalid_email")+" "+e})}});return i}function s(e){var t=encodeURI(e);if(t.indexOf("%")!=-1){var i=t.split("%").length-1;if(i==0)i++;var n=t.length-i*3;i=i+n}else{i=t.length}return i}})();(()=>{const e=AGN.Lib.Dashboard.Def;const i=e.TileSize;class n{constructor(e){if(new.target===n){throw new TypeError("Cannot construct Abstract Tile instances directly!")}this._controller=e;this.variants=[i.REGULAR];this.size=this.variants[0]}displayIn(e){if(e?.is(".draggable-tile")){e.replaceWith(this.$el)}else{e.append(this.$el)}this.afterTileAdded()}afterTileAdded(){this._$el.data("tile",this);this.$el.trigger("agn:grid-modified",[this]);AGN.runAll(this.$el)}insertAfter(e){e.$el.after(this.$el);this.afterTileAdded()}insertBefore(e){e.$el.before(this.$el);this.afterTileAdded()}remove(){const e=this.$container;this.$el.remove();e.trigger("agn:grid-modified")}switchDroppable(e){this.$el.droppable("option","disabled",!e)}swap(e){const t=$("<span>").hide();this.$el.before(t);e.$el.before(this.$el);t.replaceWith(e.$el)}get $container(){return this.$el.parent()}get id(){return this.constructor.ID}get name(){return t(`dashboard.tile.${this.id}`)}thumbnail(){return AGN.url(`/assets/core/images/dashboard/dashboard-tile-sprite.svg#${this.id}`)}allowed(){return AGN.Lib.Template.exists(this.templateName)}get $el(){if(!this._$el){this._$el=AGN.Lib.Template.dom(this.templateName,this.templateOptions)}return this._$el}get templateOptions(){return{tileName:this.name,tileSize:this.size.name,overlay:this.getOverlay()}}set $el(e){this._$el=e}get position(){if(!this._position){return{rows:[],cols:[]}}return this._position}set position(e){this._position=e}get beginCol(){return this.position.cols[0]}get beginRow(){return this.position.rows[0]}get endCol(){return this.position.cols[1]}get endRow(){return this.position.rows[1]}get isEmpty(){return this.id===AGN.Lib.Dashboard.EmptyTile.ID}get isRegular(){return this.size===i.REGULAR}get isTall(){return this.size===i.TALL}get isXl(){return this.size===i.X_LARGE}get isWide(){return this.size===i.WIDE}get isXWide(){return this.size===i.X_WIDE}get templateName(){return`dashboard-tile-${this.id}`}toggleHighlight(e){this.$el.toggleClass("draggable-accept--hovered",e)}getOverlay(){return AGN.Lib.Template.text("dashboard-tile-overlay")}static get(e){return e.data("tile")}}AGN.Lib.Dashboard.DraggableTile=n})();(()=>{class n extends AGN.Lib.Dashboard.DraggableTile{static FETCHED_DATA_CACHE=new AGN.Lib.InMemoryCache;constructor(){if(new.target===n){throw new TypeError("Cannot construct Abstract BaseMailingStatisticsTile instances directly!")}super();if(this.needsRedrawOnMobile()){this._isMobileView=false;this.#setupDisplayTypeChangeHandler()}this._chart=null;this._chartData={names:[],values:[],mailingId:0}}#setupDisplayTypeChangeHandler(){$(window).on("displayTypeChanged",(e,t)=>{this._isMobileView=t;if(this._chart){this.updateChart(true)}})}displayIn(e){super.displayIn(e);this.updateChartIfCanvasExists()}insertAfter(e){super.insertAfter(e);this.updateChartIfCanvasExists()}insertBefore(e){super.insertBefore(e);this.updateChartIfCanvasExists()}updateChartIfCanvasExists(){if(this.findCanvas$().exists()){this.updateChart()}}async updateChart(e=false){const t=this._chartData.mailingId;this._chartData.mailingId=this.$el.find("[data-statistics-mailing]").val();const i=this._chartData.mailingId!==t;if(!i&&!e){return}if(i){const n=await this.#fetchChartData();this.initChartData(this.extractStatisticsData(n))}this.drawChart()}#fetchChartData(){const e=this._chartData.mailingId;const t=n.FETCHED_DATA_CACHE.get(e);if(t){return t}const i=new Promise((t,i)=>{$.ajax({type:"GET",url:AGN.url("/dashboard/statistics.action"),data:{mailingId:e},success:e=>t(e),error:e=>i(e)})});n.FETCHED_DATA_CACHE.set(e,i);return i}extractStatisticsData(e){throw new Error("Extract statistics function not implemented for statistics tile!")}initChartData(e){this._chartData.names=e.names;this._chartData.values=e.values}drawChart(){this._chart?.destroy();const e=this.findCanvas$()[0].getContext("2d");this._chart=new Chart(e,this.getChartOptions())}findCanvas$(){return this.$el.find("canvas")}getChartOptions(){throw new Error("Chart options not defined for statistics tile!")}needsRedrawOnMobile(){return false}}AGN.Lib.Dashboard.BaseMailingStatisticsTile=n})();(()=>{class e extends AGN.Lib.Dashboard.BaseMailingStatisticsTile{constructor(){if(new.target===e){throw new TypeError("Cannot construct Abstract BaseMailingDeviceStatisticsTile instances directly!")}super()}extractStatisticsData(e){return{percent:this.extractPercent(e)}}extractPercent(e){}initChartData(e){super.initChartData(e);this._chartData.percent=e.percent}getChartOptions(){if(!this._chartData.colors){this._chartData.colors=[this.$el.css("--chart-very-dark-blue-color"),this.$el.css("--chart-dark-blue-color"),this.$el.css("--chart-blue-color"),this.$el.css("--chart-light-blue-color"),this.$el.css("--chart-light-cyan-color")]}return{type:"agnDoughnut",data:{labels:this._chartData.names,datasets:[{data:this._chartData.values,backgroundColor:this._chartData.colors,borderWidth:0}]}}}}AGN.Lib.Dashboard.BaseMailingDeviceStatisticsTile=e})();(()=>{class e extends AGN.Lib.Dashboard.DraggableTile{static ID="empty";getOverlay(){return AGN.Lib.Template.text("dashboard-tile-empty-overlay")}}AGN.Lib.Dashboard.EmptyTile=e})();(()=>{class e extends AGN.Lib.Dashboard.DraggableTile{static ID="add-ons"}AGN.Lib.Dashboard.AddOnsTile=e})();(()=>{class e extends AGN.Lib.Dashboard.DraggableTile{static ID="analysis"}AGN.Lib.Dashboard.AnalysisTile=e})();(()=>{const e=AGN.Lib.Dashboard.Def;const t=e.TileSize;class i extends AGN.Lib.Dashboard.DraggableTile{static ID="calendar";constructor(e){super(e);this._controller.addDomInitializer("dashboard-calendar",this.#domInitializer);this.variants=[t.WIDE,t.TALL];this.size=this.variants[0]}#domInitializer(){new AGN.Lib.Dashboard.Calendar(this.el,this.config)}remove(){super.remove();this.$el=undefined}thumbnail(e){return super.thumbnail()+(e===t.TALL?"-tall":"")}}AGN.Lib.Dashboard.CalendarTile=i})();(()=>{const e=AGN.Lib.Storage;const i=AGN.Lib.Dashboard.Def.TileSize;const n=AGN.Lib.Dashboard.XlCalendarLabel;const r=AGN.Lib.Dashboard.XlCalendar;class t extends AGN.Lib.Dashboard.DraggableTile{static ID="xl-calendar";constructor(e){super(e);const t=this;this.variants=[i.X_LARGE];this.size=this.variants[0];this.#addInitializers(t)}#addInitializers(e){this._controller.addDomInitializer(`dashboard-xl-calendar`,function(){const t=e.calendar=new r(this.el,this.config);this.addAction({change:"toggle-xl-calendar-comments"},e=>t.toggleComments(!e.prop("checked")));this.addAction({change:"toggle-xl-calendar-mode"},e=>t.toggleMode(e.prop("checked")));this.addAction({dblclick:"show-xl-calendar-comment"},e=>n.get(e).showModal());this.addAction({click:"create-xl-calendar-comment"},e=>t.createComment(e.data("date")));this.addAction({click:"load-more-day-mailings"},e=>t.showMoreMailings(e));this.addAction({change:"flip-xl-calendar"},()=>t.flip());this.addAction({change:"xl-calendar-change-year"},()=>t.changeYear());this.addAction({click:"xl-calendar-today"},()=>t.jumpToday())});this._controller.addDomInitializer("xl-calendar-comment-modal",function(){const t=e.calendar;this.addAction({click:"save-xl-calendar-comment"},e=>t.saveComment(e.data("comment-id")));this.addAction({click:"delete-xl-calendar-comment"},e=>t.removeComment(e.data("comment-id")))})}get templateOptions(){return{...super.templateOptions,isWeekMode:this.isWeekMode,isUnsentMailingsPlannedType:this.isUnsentMailingsPlannedType,isCommentsShown:this.isCommentsShown}}get isWeekMode(){return e.get(r.MODE_STORAGE_KEY)==="week"}get isUnsentMailingsPlannedType(){return e.get(r.UNSENT_MAILINGS_STORAGE_KEY)==="planned"}get isCommentsShown(){return e.get(r.SHOW_COMMENTS_STORAGE_KEY)!==false}get templateName(){return`dashboard-tile-${t.ID}`}remove(){super.remove();this.$el=undefined}}AGN.Lib.Dashboard.XlCalendarTile=t})();(()=>{const t=AGN.Lib.Dashboard.Def.TileSize;class e extends AGN.Lib.Dashboard.XlCalendarTile{static ID="week-calendar";constructor(e){super(e);this.variants=[t.X_WIDE];this.size=this.variants[0]}get isWeekMode(){return true}}AGN.Lib.Dashboard.WeekCalendarTile=e})();(()=>{class e extends AGN.Lib.Dashboard.DraggableTile{static ID="imports-exports"}AGN.Lib.Dashboard.ImportExportTile=e})();(()=>{class e extends AGN.Lib.Dashboard.BaseMailingStatisticsTile{static ID="statistics";extractStatisticsData(t){const i=[];const n=[];for(let e=0;e<t["common"].length;e++){i.push(t["common"][e][0]);n.push(parseInt(t["common"][e][1]))}return{names:i,values:n}}getChartOptions(){const e=this._isMobileView;const t=this.$el.css("--chart-blue-color");return{type:"bar",data:{labels:this._chartData.names,datasets:[{data:this._chartData.values,backgroundColor:t,categoryPercentage:e?.7:.9,minBarLength:2}]},options:{indexAxis:e?"y":"x",layout:{padding:{top:e?0:20,right:e?25:0}},scales:{x:{display:!e,ticks:{autoSkip:false,maxRotation:90,minRotation:0}},y:{display:e,ticks:{mirror:true,labelOffset:-37.5}}},plugins:{legend:{display:false},datalabels:{anchor:"end",align:"end",offset:e?0:-5}}}}}needsRedrawOnMobile(){return true}}AGN.Lib.Dashboard.StatisticsTile=e})();(()=>{class e extends AGN.Lib.Dashboard.BaseMailingDeviceStatisticsTile{static ID="clickers";extractStatisticsData(e){const t=[];const i=[];const n=e["clickers"];for(let e=0;e<n.length;e++){const r=parseFloat(n[e][1]);t.push(n[e][0]);i.push(r)}return _.extend(super.extractStatisticsData(e),{names:t,values:i})}drawChart(){const e=AGN.Lib.ChartUtils.getTotal(this._chartData.values);const t=this.findCanvas$();t.toggleClass("hidden",e===0);t.next().toggleClass("hidden",e>0);if(e>0){super.drawChart()}}}AGN.Lib.Dashboard.ClickersTile=e})();(()=>{class e extends AGN.Lib.Dashboard.BaseMailingDeviceStatisticsTile{static ID="openers";extractStatisticsData(e){const t=[];const i=[];const n=e["openers"];for(let e=0;e<n.length;e++){const r=parseFloat(n[e][1]);t.push(n[e][0]);i.push(r)}return _.extend(super.extractStatisticsData(e),{names:t,values:i})}extractPercent(e){return e["openersPercent"][0]}drawChart(){const e=AGN.Lib.ChartUtils.getTotal(this._chartData.values);const t=this.findCanvas$().parent();t.toggleClass("hidden",e===0);t.next().toggleClass("hidden",e===0);t.next().next().toggleClass("hidden",e>0);if(e>0){super.drawChart();this.#updateOpenersPercent(this._chartData.percent)}}#updateOpenersPercent(e){e=this.#roundTo(e*100,1);this.$el.find("#statistics-openers-percent").text(`${e}%`)}#roundTo(e,t){return parseFloat(e).toFixed(t)*1}}AGN.Lib.Dashboard.OpenersTile=e})();(()=>{class i extends AGN.Lib.Dashboard.DraggableTile{static MAILING_CARD_SELECTOR=".mailing-card";static ID="mailings";constructor(e){super(e);const t=this;e.addAction({click:"delete-recent-mailing"},function(){t.deleteAction(this)});e.addAction({click:"copy-recent-mailing"},function(){t.copyAction(this)})}copyAction(e){e.event.preventDefault();const t=this.getRecentMailingId($(e.el));AGN.Lib.Page.reload(AGN.url("/mailing/{mailing-id}/copy.action".replace("{mailing-id}",t)))}deleteAction(e){e.event.preventDefault();const t=$(e.el);$.get({url:AGN.url(`/mailing/deleteMailings.action?bulkIds=${this.getRecentMailingId(t)}`),data:{toPage:"dashboard"}}).done(e=>AGN.Lib.Confirm.create(e).done(e=>{AGN.Lib.RenderMessages($(e));t.closest(i.MAILING_CARD_SELECTOR).remove()}))}getRecentMailingId(e){return e.closest(i.MAILING_CARD_SELECTOR).data("mailing-id")}}AGN.Lib.Dashboard.MailingsTile=i})();(()=>{class e extends AGN.Lib.Dashboard.DraggableTile{static ID="news"}AGN.Lib.Dashboard.NewsTile=e})();(()=>{const e=AGN.Lib.Dashboard.Def;const i=e.TileSize;class n extends AGN.Lib.Dashboard.DraggableTile{static ID="planning";constructor(e){super(e);const t=this;this._controller.addDomInitializer("dashboard-planning",function(){$.i18n.load(this.config.translations);t.#setupDatePickers();t.#displayData(new Date,new Date)});this.variants=[i.TALL];this.size=this.variants[0]}#setupDatePickers(){const e=this.$el.find("#schedule-start-date");const t=this.$el.find("#schedule-end-date");this.#setupDatePicker(e,e,t);this.#setupDatePicker(t,e,t)}#setupDatePicker(e,l,c){const i=this;e.on("change",function(){const e=l.datepicker("getDate");const t=c.datepicker("getDate");if(e&&t){i.#displayData(e,t)}});e.datepicker("option","onChangeMonthYear",function(e,t,i){const n=$(this);const[r,s]=n.datepicker("option","yearRange").split(":");if(parseInt(e)===parseInt(s)){const o=`${r}:${parseInt(s)+1}`;const a=n.is(l)?c:l;i.settings.yearRange=o;a.datepicker("option","yearRange",o)}})}#displayData(e,i){this.#fetchData(e,i,window.adminDateFormat).then(e=>{let i="";if(e.length){i=`<div class="grid w-100" style="--bs-columns: 1">${this.#handleMailings(e)}</div>`}else{i=AGN.Lib.Template.text("notification-info",{message:t("dashboard.schedule.noMailings")})}const n=this.$el.find("#schedule-data-container");n.html(i);AGN.runAll(n)})}#fetchData(e,n,r){return new Promise((t,i)=>{$.get(AGN.url("/dashboard/scheduledMailings.action"),{startDate:AGN.Lib.DateFormat.format(e,r),endDate:AGN.Lib.DateFormat.format(n,r)}).done(e=>t(e)).fail(e=>i(e))})}#handleMailings(e){_.each(e,e=>e.link=AGN.url(`/mailing/send/${e.id}/view.action`));const t=_.groupBy(e,"sendDate");const i=_.sortBy(t,e=>e[0].maildropSendDate).map(e=>_.sortBy(e,"sendTime"));return i.reduce((e,t)=>{const i=new Date(t[0].maildropSendDate);const n=i.toLocaleString(window.adminLocale,{weekday:"long"});const r=t[0].sendDate;const s=AGN.Lib.Template.text("dashboard-schedule-day",{dayOfWeek:n,dateStr:r,dayMailings:t});return e+s},"")}}AGN.Lib.Dashboard.PlanningTile=n})();(()=>{class e extends AGN.Lib.Dashboard.DraggableTile{static ID="workflows"}AGN.Lib.Dashboard.WorkflowsTile=e})();AGN.Lib.Controller.new("dashboard",function(){const e=AGN.Lib.Modal;const t=AGN.Lib.Dashboard.Def;const r=t.TileSize;const s=AGN.Lib.Dashboard.EmptyTile;const i=AGN.Lib.Dashboard.DraggableTile;let n=[new AGN.Lib.Dashboard.MailingsTile(this),new AGN.Lib.Dashboard.PlanningTile(this),new AGN.Lib.Dashboard.StatisticsTile(this),new AGN.Lib.Dashboard.ClickersTile(this),new AGN.Lib.Dashboard.OpenersTile(this),new AGN.Lib.Dashboard.WorkflowsTile(this),new AGN.Lib.Dashboard.ImportExportTile(this),new AGN.Lib.Dashboard.AddOnsTile(this),new AGN.Lib.Dashboard.NewsTile(this),new AGN.Lib.Dashboard.XlCalendarTile(this),new AGN.Lib.Dashboard.CalendarTile(this),new AGN.Lib.Dashboard.WeekCalendarTile(this),new AGN.Lib.Dashboard.AnalysisTile(this)];let o;let a;this.addDomInitializer("dashboard-view",function(){n=n.filter(e=>e.allowed());const e=JSON.parse(this.config.layout)||_.clone(t.LAYOUT.DEFAULT);d(u(e.SCHEMA),e.COLS_COUNT);l();$(window).on("displayTypeChanged",(e,t)=>{if(t){m(false)}});m(false)});function l(){if(!a.visibleTiles.length){AGN.Lib.Messages.info("dashboard.empty")}}function c(e,t){const i=e.position?.rows?.length;const n=e.position?.cols?.length;if(i===2&&n===1){return r.TALL}if(i===1&&n===2){return r.WIDE}if(i===2&&n===3){return r.X_LARGE}return t}function u(e){return e.map(e=>{const t=p(e.id);t.size=c(e,t.size);return t})}function d(e,t){a=new AGN.Lib.Dashboard.DashboardGrid(2,t,e)}this.addAction({click:"delete-tile"},function(){const e=this.el.closest(".draggable-tile");const t=i.get(e);a.removeTile(t)});this.addAction({click:"select-tile"},function(){o=i.get(this.el.closest(".draggable-tile"));e.fromTemplate("dashboard-tiles-selection-modal",{tiles:h()})});function h(){const t=a.visibleTiles.map(e=>e.id);return n.filter(e=>e.id!==s.ID&&!t.includes(e.id)).map(e=>{e.variants.forEach(e=>e.disabled=a.getPossibleStartPositions(e,o.beginRow,o.beginCol).length<=0);return e})}this.addAction({click:"add-tile"},function(){const e=p(this.el.data("tile-id"));const t=r.from(this.el.data("type"));if(t){e.size=t}a.placeTileAroundPos(e,o.beginRow,o.beginCol)});this.addAction({change:"redraw-mailing-statistics"},function(){const e=this.el.closest(".draggable-tile");const t=i.get(e);t.updateChart()});this.addAction({click:"open-mailing-statistics"},function(){const e=this.el.closest(".draggable-tile").find("[data-statistics-mailing]").val();AGN.Lib.Page.reload(AGN.url(`/statistics/mailing/${e}/view.action`))});function p(t){return n[n.findIndex(e=>e.id===t)]||new s}function f(e){if(!e.length){return}$(":focus",e).blur();toastr.clear(e)}this.addAction({click:"edit-dashboard"},function(){m(true);const e=this.el.closest(".popup");f(e)});this.addAction({click:"stop-editing"},function(){m(false);l();g()});function g(){$.ajax({type:"POST",url:AGN.url("/dashboard/layout/save.action"),data:{layout:JSON.stringify(a.schema)},async:false}).done(()=>AGN.Lib.Messages.defaultSaved()).fail(()=>AGN.Lib.Messages.defaultError())}function m(e){$("#dashboard-start-edit-btn").closest("li").toggle(!e);$("body").toggleClass("edit-mode",!!e);a.swapper.toggle(e)}this.addAction({click:"select-layout"},function(){e.fromTemplate("dashboard-layout-selection-modal")});function v(e,t){switch(t){case 3:return e.position.cols.includes(3);case 2:return e.position.cols.includes(2)||e.position.cols.includes(3);default:return false}}function y(i){a.tiles.filter(e=>(e.isXl||e.isXWide)&&v(e,i)).forEach(e=>a.removeTile(e));const e=a.tiles.map(e=>{if(e.isWide&&v(e,i)){const t=new s;t.position={cols:[e.beginCol],rows:[e.beginRow]};return t}return e});return e.filter(e=>!v(e,i))}function b(t,i){for(let e=0;e<a.rows;e++){const n=new s;n.position={rows:[e],cols:[i]};t.push(n)}}function C(t){const i=a.tiles;for(let e=0;e<t-a.cols;e++){b(i,a.cols+e)}return i}function w(e){if(e<a.cols){return y(e)}return C(e)}this.addAction({click:"change-layout"},function(){const e=this.el.data("cols-count");if(e===a.cols){return}const t=w(e);d(t,e)})});(function(){const e=AGN.Lib.WM.EditorsHelper;class t{constructor(){this.formName="iconCommentForm";this.safeToSave=true}fillEditor(e){$("#iconComment").val(e.getComment())}saveEditor(){e.saveIconComment($("#iconComment").val());this.cancelEditor()}cancelEditor(){$("#icon-comment-editor").dialog("close");return false}}AGN.Lib.WM.CommentEditor=t})();(function(){const s=AGN.Lib.WM.Definitions;class e extends AGN.Lib.InputTable{constructor(e,t=[],i,n){e.empty();const r=t.map(e=>({...e,chainOperator:e.chainOperator===parseInt(s.constants.chainOperatorOr)}));super(e,r,i);this.profileFieldsTypes=n;this.#hideFirstChainOperatorSwitch();this.updateOperatorsAvailability()}get $form(){return this.$container.closest("form")}get $profileFieldSelect(){return this.$form.find('[name="profileField"]')}get currentProfileField(){return this.$profileFieldSelect.val()}get currentProfileFieldIsGender(){return this.currentProfileField?.toLowerCase()===s.GENDER_PROFILE_FIELD}addActions(){super.addActions();this.addAction({click:"[data-add-row]"},()=>this.onRowAddedManually());this.addAction({click:"[data-delete-row]"},()=>this.onRowsChangedManually())}addRow(e){const t=this;super.addRow(e);this.$container.find('tr:last [data-name="primaryOperator"]').on("change",function(){t.updateValueInput($(this))})}renderTable(e){super.renderTable(e);this.$container.find('[data-name="primaryOperator"]').toArray().filter(e=>$(e).val()===s.constants.operatorIs).forEach(e=>$(e).data("previous-value",s.constants.operatorIs));if(this.currentProfileFieldIsGender){this.$profileFieldSelect.data("previous-value",s.GENDER_PROFILE_FIELD)}this.removeLastRow()}onRowAddedManually(){this.updateOperatorsAvailability();this.onRowsChangedManually()}onRowsChangedManually(){this.#hideFirstChainOperatorSwitch();this.$container.trigger("change")}#hideFirstChainOperatorSwitch(){this.$container.find('[data-name="chainOperator"]:first').closest(".text-switch").prop("checked",false).closest("td").hide();this.$container.find('[data-name="chainOperator"]:not(:first)').closest(".text-switch").show()}collect(){const e=super.collect();e.forEach(e=>{e.chainOperator=parseInt(e.chainOperator?s.constants.chainOperatorOr:s.constants.chainOperatorAnd);e.parenthesisOpened=parseInt(e.parenthesisOpened);e.parenthesisClosed=parseInt(e.parenthesisClosed);e.primaryOperator=parseInt(e.primaryOperator)});return e}get rowTemplate(){const e=this.$primaryOperatorOptions();const t=this.ruleValueInput();return`
          <tr>
              <td style="max-width: 70px">
                  <label class="text-switch">
                      <input type="checkbox" data-name="chainOperator" value="true" {{- chainOperator ? 'checked' : ''}} ${this.readonlyAttr}>
                      <span>AND</span>
                      <span class="flex-center" style="min-width: 33px;">OR</span>
                  </label>
              </td>
              <td style="max-width: 45px">
                  <select data-name="parenthesisOpened" class="form-control js-select rule-field" ${this.readonlyAttr}>
                      <option value="0" {{- parenthesisOpened === 0 ? 'selected' : ''}}>&nbsp</option>
                      <option value="1" {{- parenthesisOpened === 1 ? 'selected' : ''}}>(</option>
                  </select>
              </td>
              <td>
                  <select data-name="primaryOperator" class="form-control js-select" data-action="start-rule-operator-change" ${this.readonlyAttr} data-select-options="dropdownAutoWidth: true">
                      ${e}
                  </select>
              </td>
              <td>
                  ${t}
              </td>            
              <td style="max-width: 45px">
                  <select data-name="parenthesisClosed" class="form-control js-select rule-field" ${this.readonlyAttr}>
                      <option value="0" {{- parenthesisClosed === 0 ? 'selected' : ''}}>&nbsp</option>
                      <option value="1" {{- parenthesisClosed === 1 ? 'selected' : ''}}>)</option>
                  </select>
              </td>                        
          </tr>`}emptyRuleValueInput(){return`<input type="text" data-name="primaryValue" value="" class="form-control rule-field" ${this.readonlyAttr}/>`}ruleValueInput(){return`
        {{ if (${this.currentProfileField===s.GENDER_PROFILE_FIELD}) { }}
            ${this.genderSelect(true)}
        {{ } else if (primaryOperator == ${s.constants.operatorIs}) { }}
            ${this.operatorIsSelect(true)}
        {{ } else { }}
            ${this.emptyRuleValueInput().replace('value=""','value="{{- primaryValue }}"')}
        {{ } }}`}$primaryOperatorOptions(){let n="";s.constants.operators.forEach(function(e){let t='value="'+e.id+'"';let i=e.data;if(i){Object.keys(i).forEach(function(e){t+=" data-"+e+'="'+i[e].replace('"',"&quot;")+'"'})}n+=`<option ${t} {{- primaryOperator === ${e.id} ? 'selected' : '' }}>${e.text.replace("<","&lt;").replace(">","&gt;")}</option>`});return n}genderSelect(i){const e=Object.entries(s.constants.genderOptions).map(([e,t])=>this.genderOption(e,t,i)).join("");return`<select data-name="primaryValue" class="form-control js-select">${e}</select>`}genderOption(e,t,i){const n=i?`{{- primaryValue == ${e} ? "selected" : "" }}`:"";return`<option value="${e}" ${n}>${t}</option>`}operatorIsSelect(e){const t=`
        <select data-name="primaryValue" class="form-control js-select">
            <option value="NULL">NULL</option>
            <option value="NOT_NULL">NOT NULL</option>
        </select>`;if(e){return t.replace('value="NULL"','value="NULL" {{- primaryValue === "NULL" ? "selected" : "" }}').replace('value="NOT_NULL"','value="NOT_NULL" {{- primaryValue === "NOT_NULL" ? "selected" : "" }}')}return t}updateOperatorsAvailability(){const e=this.$container.find('select[data-name="primaryOperator"]');_.forEach(e.toArray(),e=>this.updateSelectOperatorsAvailability($(e)));e.trigger("change.select2")}updateSelectOperatorsAvailability(e){const t=this.currentProfileField;const i=this.profileFieldsTypes[t];const n=e.children("option").toArray().filter(e=>this.isAllowedOperatorsOption(e,i)).map(e=>e.value);AGN.Lib.Select.get(e).disableOptions(n,true)}isAllowedOperatorsOption(e,t){if(this.currentProfileFieldIsGender){return e.text!=="="&&e.text!=="<>"}const i=$(e).data("types");if(i==="*"||!i){return false}return!i.split(/[\s,]+/).includes(t)}updateValueInput(e){const t=e.closest("tr").find('[data-name="primaryValue"]');if(e.val()===s.constants.operatorIs){const i=$(this.operatorIsSelect());t.closest("td").html(i);e.data("previous-value",s.constants.operatorIs);this.#initSelect(i)}else if(e.data("previous-value")===s.constants.operatorIs){t.closest("td").html(this.emptyRuleValueInput());e.removeData("previous-value")}}onProfileFieldChanged(){this.updateOperatorsAvailability();if(this.currentProfileFieldIsGender){this.changeValueInputsToGenderSelect();this.$profileFieldSelect.data("previous-value",s.GENDER_PROFILE_FIELD)}else if(this.$profileFieldSelect.data("previous-value")===s.GENDER_PROFILE_FIELD){this.changeValueInputsToTextInput();this.$profileFieldSelect.removeData("previous-value")}}changeValueInputsToGenderSelect(){_.each(this.$container.find('[data-name="primaryValue"]'),e=>{const t=$(this.genderSelect());$(e).closest("td").html(t);this.#initSelect(t)})}changeValueInputsToTextInput(){_.each(this.$container.find('[data-name="primaryValue"]'),e=>{$(e).closest("td").html(this.emptyRuleValueInput())})}#initSelect(e){AGN.Lib.CoreInitializer.run("select",e)}}AGN.Lib.WM.FieldRulesTable=e})();(function(){const t=AGN.Lib.WM.EditorsHelper;class e{constructor(){if(this.constructor===e){throw new Error("Cannot instantiate abstract class")}}get saveOnOpen(){return false}get $form(){return $(`form[name="${this.formName}"]`)}get form(){return AGN.Lib.Form.get(this.$form)}get formName(){throw new Error("formName() must be implemented")}$find(e){return $(`form[name="${this.formName}"] ${e}`)}toggle(e,t){this.$find(e).toggle(t)}hide(e){this.toggle(e,false)}show(e){this.toggle(e,true)}dateAsUTC(e){return e?new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())):null}getForwardParams(e){return{nodeId:t.curEditingNode.getId(),elementId:encodeURIComponent(e)}}getForwardParamsStr(){return Object.entries(this.getForwardParams()).map(([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`).join(";")}isValid(){return this.form.validate()}save(){if(this.isValid()){t.saveCurrentEditorWithUndo()}}}AGN.Lib.WM.NodeEditor=e})();(function(){const i=AGN.Lib.WM.EditorsHelper;const n=AGN.Lib.Messages;const e=AGN.Lib.WM.Definitions;class t extends AGN.Lib.WM.NodeEditor{constructor(e){super();this.conf=e;this.safeToSave=true}get formName(){throw new Error("formName() must be implemented")}get $idSelect(){return this.$find("select[name=importexportId]")}get selectedId(){return this.$idSelect.val()}get type(){throw new Error("type() must be implemented")}get $editor(){throw new Error("$editor() must be implemented")}fillEditor(e){const t=e.getData();this.$form.submit(false);this.$form.get(0).reset();i.fillFormFromObject(this.formName,t,"");this.addLinks();if(this.conf.isDisabled==="true"){n.warn(this.missingPermissionMsgCode)}this.isValid()}get missingPermissionMsgCode(){throw new Error("missingPermissionMsgCode() must be implemented")}get dependencyType(){throw new Error("dependencyType() must be implemented")}get inUseMsgCode(){throw new Error("inUseMsgCode() must be implemented")}get notSelectedMsgCode(){throw new Error("notSelectedMsgCode() must be implemented")}isValidDependency(){let t=false;$.ajax({url:AGN.url("/workflow/validateDependency.action"),async:false,data:{workflowId:e.workflowId||0,type:this.dependencyType,entityId:this.selectedId}}).done(e=>{if(e.valid===true){t=true}else{n.warn(this.inUseMsgCode)}}).fail(()=>{n.warn("Error")});return t}isValid(){return super.isValid()&&this.isValidDependency()}save(){if(this.conf.isDisabled==="true"){return}super.save()}onChange(){this.addLinks()}addLinks(){throw new Error("addLinks() must be implemented")}saveEditor(){return i.formToObject(this.formName)}isSetFilledAllowed(){const e=this.$idSelect.find(":selected");return!(this.selectedId==0||e.data("is-available")!=true)}}AGN.Lib.WM.RecipientTransferEditor=t})();(function(){const i=AGN.Lib.WM.MailingSelector;const a=AGN.Lib.WM.FieldRulesTable;const l=AGN.Lib.WM.EditorsHelper;const c=AGN.Lib.WM.DateTimeUtils;const r=AGN.Lib.Template;const p=AGN.Lib.Messages;const u=AGN.Lib.Select;const f=AGN.Lib.WM.Definitions;class e extends AGN.Lib.WM.NodeEditor{constructor(e,t){super();this.editor=e;this.config=t;this.startMailingSelector=new i(t.form,t.selectedName,t.noMailingOption);this.isStartEditor=false;this.timePattern=/^(\d{2}):(\d{2})$/}get saveOnOpen(){return true}get formName(){return"startForm"}get title(){return this.isStartEditor?t("workflow.start.title"):t("workflow.stop.title")}get $endTypeSelect(){return this.$find('[name="endType"]')}get endTypeSelect(){return u.get(this.$endTypeSelect)}get $rulesContainer(){return this.$find("#profileFieldRules")}get requiredMsg(){return t("fields.required.errors.missing")}getStartStopDate(e){e=e||l.formToObject(this.formName);if(this.isStartEditor){switch(e.startType){case f.constants.startTypeDate:return this.$find("#startDate").datepicker("getDate");case f.constants.startTypeEvent:return this.$find("#executionDate").datepicker("getDate")}}else if(e.endType==f.constants.endTypeDate){return this.$find("#startDate").datepicker("getDate")}return null}generateReminderComment(){const e=$('#workflowForm input[name="shortname"]').val();const i=c.getDateStr(this.getStartStopDate(),window.adminDateFormat);return(this.isStartEditor?t("workflow.start.reminder_text"):t("workflow.stop.reminder_text")).replace(/:campaignName/g,e).replace(/:startDate/g,i).replace(/:endDate/g,i)}fillEditor(e){var i=e.getData();this.isStartEditor=e.getType()==="start";const n=this.isStartEditor&&(e.data.startType===f.constants.startTypeEvent||!this.editor.isAutoOptimizationWorkflow(e));this.updateEditorType(this.isStartEditor,n);this.$form.submit(false);this.$find("#remindCalendarDateTitle").text(t(this.isStartEditor?"workflow.start.start_date":"workflow.stop.end_date"));i.adminTimezone=this.config.adminTimezone;i.sendReminder=i.scheduleReminder;l.fillFormFromObject(this.formName,i,"");this.startMailingSelector.setMailingId(i.mailingId);this.startMailingSelector.cleanOptions();const r=new Date;this.$find("#startDate").datepicker("setDate",this.dateAsUTC(i.date??r));this.$find("#executionDate").datepicker("setDate",this.dateAsUTC(i.date??r));this.$find("#remindDate").datepicker("setDate",this.dateAsUTC(i.remindDate??r));const s=i.date?i:c.getCurrentAdminTime();this.$find("#startTime").val(this.formatTime(s.hour,s.minute));this.$find("#remindTime").val(this.formatTime(s.remindHour,s.remindMinute));this.updateVisibility();if(i.startType==f.constants.startTypeEvent&&i.event==f.constants.startEventReaction&&i.reaction==f.constants.reactionClickedLink&&i.mailingId!=0&&i.mailingId!=null){this.onMailingSelectChange(i.mailingId,i.linkId)}if(!i.comment){this.$find("#reminderComment").val(this.generateReminderComment())}u.get($('#start-editor [name="userType"]')).selectOption(i.recipients!=""?2:1);this.form.cleanFieldFeedback();const o=!this.isStartEditor&&this.editor.isAllLinkedFilledStartsHasDateType(e);if(o){this.endTypeSelect.selectOption(f.constants.endTypeAutomatic)}this.endTypeSelect.setReadonly(o);this.rulesTable=new a(this.$rulesContainer,i.rules,l.isReadOnlyMode(),this.config.profileFields)}saveEditor(){const e=l.formToObject(this.formName);e.date=this.getStartStopDate(e);if(e.date==null){e.date=new Date;e.date.setHours(0);e.date.setMinutes(0);e.date.setSeconds(0);e.date.setMilliseconds(0)}var t;var i=this.$find("#startTime").val();if(t=this.timePattern.exec(i)){e.hour=t[1];e.minute=t[2]}else{e.hour=0;e.minute=0}e.scheduleReminder=e.sendReminder;var n=this.$find("#remindTime").val();if(t=this.timePattern.exec(n)){e.remindHour=t[1];e.remindMinute=t[2]}else{e.remindHour=0;e.remindMinute=0}if(this.$find('[name="remindSpecificDate"]').val()==="true"){e.remindDate=this.$find("#remindDate").datepicker("getDate")}else{e.remindDate=e.date;e.remindHour=0;e.remindMinute=0}if(e.rules==undefined){e.rules=[]}if(e.linkId==undefined||e.linkId==null){e.linkId=0}if(e.dateFieldOperator!=this.config.equelsOperatorCode){e.dateFieldOperator=this.config.equelsOperatorCode}if(e.userType==2){e.remindAdminId=0;e.recipients=$.trim(e.recipients).toLowerCase().split(/[,;\s\n\r]+/).filter(function(e){return!!e}).join(", ")}else{e.recipients=""}delete e.userType;e.rules=this.rulesTable.collect();return e}validateEditorInternal(u){const d=this;let h=true;const e=this.isStartEditor?this.$find('select[name="startType"]').val():this.$find('select[name="endType"]').val();if(this.isStartEditor&&e===f.constants.startTypeEvent){t();i()}if(this.isStartEditor&&e===f.constants.startTypeDate||!this.isStartEditor&&e===f.constants.endTypeDate){i()}if(h&&this.$find("#sendReminder").is(":checked")){if(this.$find('[name="userType"]').val()=="2"){n()}}if(h){this.form.cleanFieldFeedback()}return h;function t(){var e=d.$find('select[name="event"]').val();switch(e){case f.constants.startEventDate:var t=d.$find("#executionDate").datepicker("getDate");if(t){var i=d.$find("#startTime").val();if(!d.timePattern.test(i)){h=false}}else{h=false}var n=d.$find("#dateFieldValue");if(!$.trim(n.val())){h=false;if(u){p.warn("error.workflow.startDateOmitted")}}const o=d.$find("#dateProfileField");if(!$.trim(o.val())){h=false;if(u){d.form.showFieldError("dateProfileField",d.requiredMsg)}}break;case f.constants.startEventReaction:var r=d.$find('select[name="reaction"]').val();switch(r){case f.constants.reactionClickedLink:const a=d.$find('select[name="linkId"]').val();if(!a||parseInt(a,10)<=0){h=false;if(u){p.warn("error.workflow.noLinkSelected")}}case f.constants.reactionOpened:case f.constants.reactionClicked:const l=d.$find('select[name="mailingId"]').val();if(parseInt(l,10)<=0){h=false;if(u){p.warn("error.workflow.noMailing")}}break;case f.constants.reactionChangeOfProfile:if(typeof d.config.isBigData!="undefined"&&d.config.isBigData==true){var s=d.$find('select[name="profileField"]').val();if(!s){h=false}}const c=d.$find("#startProfileField");if(!$.trim(c.val())){h=false;if(u){d.form.showFieldError("profileField",d.requiredMsg)}}break;case f.constants.reactionWaitingForConfirm:case f.constants.reactionOptIn:case f.constants.reactionOptOut:break;default:h=false;break}break}}function i(){var e=d.$find("#startDate").datepicker("getDate");if(e){var t=d.$find("#startTime").val();if(!d.timePattern.test(t)){h=false}}else{h=false}}function n(){var e=$.trim(d.$find('textarea[name="recipients"]').val()).split(/[,;\s\n\r]+/).filter(function(e){return!!e});if(!e.length){if(u){h=false;p.warn("error.workflow.emptyRecipientList")}}}}isValid(){return this.validateEditorInternal(true)&&super.isValid()}isSetFilledAllowed(){return this.validateEditorInternal(false)}updateEditorType(e,i){const n=$("#startStopType");n.empty();if(e){n.append(r.text("start-types",{showStartEventTab:i}));$("#eventReaction").html(t("workflow.start.reaction_based"));$("#eventDate").html(t("workflow.start.date_based"))}else{n.append(r.text("stop-types"));if(this.checkPresentNodeOfType([f.NODE_TYPE_ACTION_BASED_MAILING,f.NODE_TYPE_DATE_BASED_MAILING])){$("#endTypeAutomaticLabel").html(t("workflow.stop.open_end"))}else{$("#endTypeAutomaticLabel").html(t("workflow.stop.automatic_end"))}}}onStartTypeChanged(){const e=this.$find("#startIconTime");const t=this.isStartEditor?this.$find('select[name="startType"]').val():this.$find('select[name="endType"]').val();if(this.isStartEditor&&t==f.constants.startTypeDate||!this.isStartEditor&&t==f.constants.endTypeDate){this.toggleFormat();this.hide("#startEventPanel");this.show("#startDatePanel");this.show("#startIconTime");this.$find("#startDatePanel .date-time-container").append(e);this.show("#startRemindAdmin")}else if(this.isStartEditor&&t==f.constants.startTypeEvent){this.hide("#startDatePanel");this.$find("#executionDatePanel .date-time-container").append(e);this.show("#startEventPanel");this.show("#startIconTime");this.show("#startRemindAdmin");this.onStartEventChanged()}else if(this.isStartEditor&&t==f.constants.startTypeOpen||!this.isStartEditor&&t==f.constants.endTypeAutomatic){this.hide("#startDatePanel");this.$find("#executionDatePanel .date-time-container").append(e);this.hide("#startEventPanel");this.hide("#startIconTime");this.hide("#startRemindAdmin")}}onStartEventChanged(){var e=$("#startEvent").val();if(e==f.constants.startEventReaction){this.toggleFormat();this.hide("#dateStartPanel");this.show("#reactionStartPanel");this.onExecutionChanged();this.onProfileFieldChanged()}else if(e==f.constants.startEventDate){this.toggleFormat();this.hide("#reactionStartPanel");this.show("#dateStartPanel");this.hide("#executionDateLabel");this.show("#firstExecutionDateLabel");$("#startIconDateFormat").insertAfter("#startIconDateFieldOperator");this.show("#startIconDateFormat")}}toggleFormat(){this.$find("input#startTime").inputmask(this.isDateBasedStart?"h:00":"h:s")}get isDateBasedStart(){return this.$find("#start-type").val()===f.constants.startTypeEvent&&this.$find("select#startEvent").val()===f.constants.startEventDate}onRuleModeChanged(){this.toggle("#profileFieldRules",$('select[name="useRules"]').val()!=="false")}onProfileFieldChanged(){this.updateDateFormatVisibility();this.rulesTable?.onProfileFieldChanged()}updateDateFormatVisibility(){const e=this.$find('select[name="profileField"]').val();const t=this.config.profileFields[e];if(t&&t.toLowerCase()==f.FIELD_TYPE_DATE){$("#startIconDateFormat").insertAfter("#reactionProfileField");this.show("#startIconDateFormat")}else{this.hide("#startIconDateFormat")}}onExecutionChanged(){const e=this.$find('[name="executeOnce"]').val();this.toggle("#executionDateLabel",e!=="false");this.toggle("#firstExecutionDateLabel",e==="false")}onReactionChanged(){const e=this.$find("#startReaction").val();if(e==f.constants.reactionOpened||e==f.constants.reactionNotOpened||e==f.constants.reactionClicked||e==f.constants.reactionNotClicked||e==f.constants.reactionBought||e==f.constants.reactionNotBought||e==f.constants.reactionClickedLink){this.hide("#reactionStartProfile");this.show("#reactionStartMailing")}else if(e==f.constants.reactionChangeOfProfile){this.hide("#reactionStartMailing");this.show("#reactionStartProfile")}else{this.hide("#reactionStartMailing");this.hide("#reactionStartProfile")}this.toggle("#reactionStartMailingLink",e===f.constants.reactionClickedLink)}onReminderChanged(){if(this.$find('input[name="sendReminder"]').is(":checked")){this.$find("#reminderComment").val(this.generateReminderComment());this.show("#reminderDetails")}else{this.hide("#reminderDetails")}return false}onScheduleReminderDateChanged(){this.toggle("#dateTimePicker",this.$find('select[name="remindSpecificDate"]').val()==="true");return false}onMailingSelectChange(e,t){var i=this.$find('select[name="linkId"]');var n=parseInt(e,10);if(n>0){i.attr("readonly","readonly");$.ajax({url:AGN.url(`/mailing/ajax/${n}/links.action`),success:function(e){i.empty();i.append($("<option></option>",{value:"",text:f.EMPTY_OPTION_PLACEHOLDER}));$.each(e,function(e,t){i.append($("<option></option>",{value:t.id,text:t.url}))});i.removeAttr("readonly");if(t!=null&&t!=undefined){i.val(t);l.initSelectWithValueOrChooseFirst(i,t)}else{l.initSelectWithFirstValue(i)}}})}else{i.empty()}}updateVisibility(){this.onStartTypeChanged();this.onStartEventChanged();this.onReactionChanged();this.onRuleModeChanged();this.onExecutionChanged();this.onReminderChanged();this.onScheduleReminderDateChanged()}formatTime(e,t){var i=0;var n=0;e=parseInt(e,10);if(e>=0){i=e}t=parseInt(t,10);if(t>=0){n=t}return(i<10?"0"+i:i)+":"+(n<10?"0"+n:n)}checkPresentNodeOfType(e){return l.getNodesByTypes(e).length>0}}AGN.Lib.WM.StartStopNodeEditor=e})();(function(){const i=AGN.Lib.WM.EditorsHelper;const n=AGN.Lib.Select;class e extends AGN.Lib.WM.NodeEditor{constructor(e){super();this.campaignEditor=e}get saveOnOpen(){return true}get formName(){return"parameterForm"}get title(){return t("workflow.parameter")}fillEditor(e){n.get(this.$find("select[name=value]")).setOptions(this.campaignEditor.getParametersOptions(e));const t=e.getData();this.$form.submit(false);this.$form.get(0).reset();i.fillFormFromObject(this.formName,t,"")}saveEditor(){return i.formToObject(this.formName)}}AGN.Lib.WM.ParameterNodeEditor=e})();(function(){const e=AGN.Lib.WM.EditorsHelper;const i=AGN.Lib.WM.Definitions;class n extends AGN.Lib.WM.RecipientTransferEditor{constructor(e,t){super(e);this.submitWorkflowForm=t}get formName(){return"importForm"}get title(){return t("auto_import")}get $editor(){return $("#import-editor")}get missingPermissionMsgCode(){return"error.workflow.autoImportPermission"}get dependencyType(){return i.DEPENDENCY_TYPE_AUTO_IMPORT}get inUseMsgCode(){return"error.workflow.autoImportInUse"}get notSelectedMsgCode(){return"error.workflow.noImport"}createNewAutoImport(){e.processForward(i.constants.forwards.AUTO_IMPORT_CREATE.name,"#importexportId",this.submitWorkflowForm)}editAutoImport(){$("#forwardTargetItemId").val(this.selectedId);e.processForward(i.constants.forwards.AUTO_IMPORT_EDIT.name,'form[name="'+this.formName+'"] select[name=importexportId]',this.submitWorkflowForm)}addLinks(){if(this.selectedId>0){$("#import-editor #editAutoImportLink").show();$("#import-editor #createAutoImportLink").hide()}else{$("#import-editor #createAutoImportLink").show();$("#import-editor #editAutoImportLink").hide()}}}AGN.Lib.WM.ImportNodeEditor=n})();(function(){const e=AGN.Lib.WM.EditorsHelper;const i=AGN.Lib.WM.Definitions;class n extends AGN.Lib.WM.RecipientTransferEditor{constructor(e,t){super(e);this.submitWorkflowForm=t}get formName(){return"exportForm"}get title(){return t("auto_export")}get $editor(){return $("#export-editor")}get missingPermissionMsgCode(){return"error.workflow.autoExportPermission"}get dependencyType(){return i.DEPENDENCY_TYPE_AUTO_EXPORT}get inUseMsgCode(){return"error.workflow.autoExportInUse"}get notSelectedMsgCode(){return"error.workflow.noExport"}createNewAutoExport(){e.processForward(i.constants.forwards.AUTO_EXPORT_CREATE.name,'form[name="'+this.formName+'"] select[name=importexportId]',this.submitWorkflowForm)}editAutoExport(){$("#forwardTargetItemId").val(this.selectedId);e.processForward(i.constants.forwards.AUTO_EXPORT_EDIT.name,'form[name="'+this.formName+'"] select[name=importexportId]',this.submitWorkflowForm)}addLinks(){if(this.selectedId>0){$("#export-editor #editAutoExportLink").show();$("#export-editor #createAutoExportLink").hide()}else{$("#export-editor #createAutoExportLink").show();$("#export-editor #editAutoExportLink").hide()}}}AGN.Lib.WM.ExportNodeEditor=n})();(function(){const e=AGN.Lib.WM.Definitions;const i=AGN.Lib.WM.EditorsHelper;const n=AGN.Lib.WM.NodeTitleHelper;class r extends AGN.Lib.WM.NodeEditor{constructor(){super();this.safeToSave=true}get formName(){return"archiveNodeForm"}get title(){return t("workflow.mailing.archive")}get archiveSelectSelector(){return`#${this.formName} #settings_general_campaign`}get archiveSelect(){return AGN.Lib.Select.get(this.$archiveSelect)}get $archiveSelect(){return $(this.archiveSelectSelector)}createNewArchive(){AGN.Lib.Confirm.request($.get(AGN.url(e.constants.forwards.ARCHIVE_CREATE.url),{workflowId:e.workflowId})).done(({archiveId:e,archiveName:t})=>{this.#addArchiveOption(e,t);this.archiveSelect.selectOption(e);i.saveCurrentEditorWithUndo();AGN.Lib.Messages.defaultSaved()})}#addArchiveOption(e,t){this.archiveSelect.addOption(e,t);n.addArchiveName(e,t)}fillEditor(e){const t=e.getData();this.$form.submit(false);this.$form.get(0).reset();i.fillFormFromObject(this.formName,t,"");this.isValid()}saveEditor(){return i.formToObject(this.formName)}}AGN.Lib.WM.ArchiveNodeEditor=r})();(function(){const e=AGN.Lib.WM.Definitions;const i=AGN.Lib.WM.EditorsHelper;class n extends AGN.Lib.WM.NodeEditor{constructor(e){super();this.safeToSave=true;this.mailingEditorBase=e}get formName(){return"mailingForm"}get title(){return t("workflow.defaults.mailing")}get $editor(){return $("#mailing-editor")}fillEditor(e){this.$form.submit(false);this.$form.get(0).reset();i.fillFormFromObject(this.formName,e.getData(),"");this.mailingEditorBase.fillEditorBase(e)}createNewMailing(){this.mailingEditorBase.createNewMailing()}editMailing(){this.mailingEditorBase.editMailing(e.constants.forwards.MAILING_EDIT.name)}saveEditor(){this.mailingEditorBase.setNodeFields();return i.formToObject(this.formName)}saveWithCheckStatus(){const e=this.mailingEditorBase.showSecurityQuestion();if(e){i.saveCurrentEditorWithUndo(this.mailingEditorBase)}}copyMailing(){this.mailingEditorBase.copyMailing(e.constants.forwards.MAILING_COPY.name)}save(){this.mailingEditorBase.validateEditor(()=>this.saveWithCheckStatus())}}AGN.Lib.WM.MailingNodeEditor=n})();(function(){class e extends AGN.Lib.WM.MailingNodeEditor{constructor(e){super(e);this.safeToSave=false}get formName(){return"datebasedMailingForm"}get title(){return t("workflow.mailing.date_based")}get $editor(){return $("#datebased_mailing-editor")}}AGN.Lib.WM.DateBasedMailingNodeEditor=e})();(function(){class e extends AGN.Lib.WM.MailingNodeEditor{constructor(e){super(e);this.safeToSave=false}get formName(){return"actionbasedMailingForm"}get title(){return t("workflow.mailing.action_based")}get $editor(){return $("#actionbased_mailing-editor")}}AGN.Lib.WM.ActionBasedMailingNodeEditor=e})();(function(){const i=AGN.Lib.WM.EditorsHelper;const n=AGN.Lib.Messages;const e=AGN.Lib.WM.Definitions;class r extends AGN.Lib.WM.NodeEditor{constructor(e,t,i){super();this.safeToSave=false;this.disableFollowup=i;this.baseMailingEditorBase=e;this.followupMailingEditorBase=t}get formName(){return"followupMailingForm"}get title(){return t("workflow.mailing.followup")}fillEditor(e){this.followupMailingEditorBase.fillEditorBase(e);this.baseMailingEditorBase.fillEditorBase(e);this.$form.submit(false);this.$form.get(0).reset();i.fillFormFromObject(this.formName,e.getData(),"");if(this.disableFollowup){n.warn("error.workflow.followupPermission");this.baseMailingEditorBase.disableInputs()}}createNewMailing(){this.followupMailingEditorBase.createNewMailing()}editMailing(){this.followupMailingEditorBase.editMailing(e.constants.forwards.MAILING_EDIT.name)}copyMailing(){this.followupMailingEditorBase.copyMailing(e.constants.forwards.MAILING_COPY.name)}saveEditor(){this.setNodeFields();return i.formToObject(this.formName)}saveWithCheckStatus(){var e=this.followupMailingEditorBase.showSecurityQuestion();if(e){i.saveCurrentEditorWithUndo(this.followupMailingEditorBase)}}save(){if(this.disableFollowup){return}var e=$(this.baseMailingEditorBase.formNameJId+" "+this.baseMailingEditorBase.selectNameJId);var t=$(this.followupMailingEditorBase.formNameJId+" "+this.followupMailingEditorBase.selectNameJId);if(e.val()>0&&t.val()>0){this.saveWithCheckStatus()}else{n.warn("error.workflow.noMailing")}}setNodeFields(){this.baseMailingEditorBase.node.setFilled(parseInt(this.baseMailingEditorBase.mailingId,10)>0&&parseInt(this.followupMailingEditorBase.mailingId,10)>0)}}AGN.Lib.WM.FollowupMailingNodeEditor=r})();(function(){const i=AGN.Lib.WM.MailingSelector;const n=AGN.Lib.WM.FieldRulesTable;const c=AGN.Lib.WM.EditorsHelper;const u=AGN.Lib.Messages;const d=AGN.Lib.WM.Definitions;class e extends AGN.Lib.WM.NodeEditor{constructor(e,t){super();this.editor=e;this.config=t;this.mailingSelector=new i(t.form,t.selectName,t.noMailingOption)}get saveOnOpen(){return true}get formName(){return"decisionForm"}get title(){return t("workflow.decision")}get $rulesContainer(){return this.$find("#decisionProfileFieldRules")}get $decisionType(){return this.$find('select[name="decisionType"]')}get $decisionCriteria(){return this.$find('select[name="decisionCriteria"]')}fillEditor(e){this.profileFieldMailingId=0;const t=e.getData();this.$form.submit(false);this.possibleToUseAutoOptimization=this.editor.isAutoOptimizationDecisionAllowed(e);if(t.profileField){t.profileField=t.profileField.toLowerCase()}c.fillFormFromObject(this.formName,t,"");this.mailingSelector.setMailingId(t.mailingId);this.mailingSelector.cleanOptions(1);if(!t.decisionDate){t.decisionDate=new Date}const i=$("#decision-date-time-inputs");if(this.checkPresentNodeOfType([d.NODE_TYPE_ACTION_BASED_MAILING,d.NODE_TYPE_DATE_BASED_MAILING])){i.hide()}else{i.show();this.$find("#decisionDate").datepicker("setDate",this.dateAsUTC(t.decisionDate));this.$find("#decisionTime").val(("0"+t.decisionDate.getHours()).slice(-2)+":"+("0"+t.decisionDate.getMinutes()).slice(-2))}this.updateVisibility();this.updateDateFormatVisibility();if(t.decisionType==d.constants.decisionTypeDecision&&t.decisionCriteria==d.constants.decisionReaction&&t.reaction==d.constants.reactionClickedLink&&(t.mailingId!=0&&t.mailingId!=null)){this.onMailingSelectChange(t.mailingId,t.linkId)}else{c.resetSelect(this.$find('select[name="linkId"]'))}this.rulesTable=new n(this.$rulesContainer,t.rules,c.isReadOnlyMode(),this.config.profileFields);this.form.cleanFieldFeedback()}saveEditor(){const e=c.formToObject(this.formName);if(e.decisionCriteria==d.constants.decisionProfileField&&this.profileFieldMailingId!=0){e.mailingId=this.profileFieldMailingId}this.profileFieldMailingId=0;if(e.rules==undefined){e.rules=[]}if(!e.threshold){e.threshold=""}if(this.checkPresentNodeOfType([d.NODE_TYPE_ACTION_BASED_MAILING,d.NODE_TYPE_DATE_BASED_MAILING])){e.decisionDate=null}else{e.decisionDate=this.$find("#decisionDate").datepicker("getDate");const t=this.$find("#decisionTime").val();e.decisionDate.setHours(t.substring(0,2));e.decisionDate.setMinutes(t.substring(3,5))}e.rules=this.rulesTable.collect();return e}save(){var e=this.$decisionType.val();var i=$("#decisionCriteria").val();var n=this.$find('select[name="mailingId"]').val();var r=this.$find('select[name="linkId"]').val();var s=this.$find('select[name="reaction"]').val();var o=this.$find('input[name="threshold"]').val();if(e==d.constants.decisionTypeDecision&&i==d.constants.decisionReaction&&n==0){u.alert("error.workflow.noMailing")}else if(e==d.constants.decisionTypeDecision&&i==d.constants.decisionReaction&&s==d.constants.reactionClickedLink&&(r==0||r==null)){u.alert("error.workflow.noLinkSelected")}else if(e==d.constants.decisionTypeDecision&&i==d.constants.decisionProfileField){if(this.config.isMailtrackingActive=="true"){const l=this.$find("#decisionProfileField");if(!$.trim(l.val())){this.form.showFieldError("profileField",t("fields.required.errors.missing"))}else{this.form.cleanFieldError("profileField");c.saveCurrentEditorWithUndo()}}}else if(e==d.constants.decisionTypeAutoOptimization){if(o){var a=parseInt(o,10);if(a&&a>0){c.saveCurrentEditorWithUndo()}else{u.alert("error.workflow.noValidThreshold")}}else{c.saveCurrentEditorWithUndo()}}else{c.saveCurrentEditorWithUndo()}}onTypeChanged(){const e=this.$decisionType;const t=e.val();if(!this.possibleToUseAutoOptimization&&t===d.constants.decisionTypeAutoOptimization){u.alert("error.workflow.autoOptimizationDecisionForbidden");e.val(d.constants.decisionTypeDecision);return}if(t==d.constants.decisionTypeDecision){this.hide("#autoOptimizationPanel");this.show("#decisionPanel")}else if(t==d.constants.decisionTypeAutoOptimization){this.hide("#decisionPanel");this.show("#autoOptimizationPanel")}this.updateVisibilityOfRuleMailingReceived()}onDecisionReactionChanged(){var e=this.$find('select[name="reaction"]').val();if(e==d.constants.reactionClickedLink){this.show("#reactionLinkPanel");var t=this.$find('select[name="mailingId"]').val();this.onMailingSelectChange(t,0)}else{this.hide("#reactionLinkPanel")}}onCriteriaChanged(){const e=this.$decisionCriteria.val();if(e==d.constants.decisionReaction){this.hide("#decisionProfileFieldPanel");this.show("#decisionReactionPanel")}else if(e==d.constants.decisionProfileField){this.hide("#decisionReactionPanel");this.show("#decisionProfileFieldPanel")}this.updateVisibilityOfRuleMailingReceived()}onMailingSelectChange(e,t){var i=this.$find('select[name="linkId"]');var n=parseInt(e,10);if(n>0){i.attr("readonly","readonly");$.ajax({url:AGN.url(`/mailing/ajax/${n}/links.action`),success:function(e){i.empty();i.append($("<option></option>",{value:"",text:d.EMPTY_OPTION_PLACEHOLDER}));$.each(e,function(e,t){i.append($("<option></option>",{value:t.id,text:t.url}))});i.removeAttr("readonly");if(t!=null&&t!=undefined){i.val(t);c.initSelectWithValueOrChooseFirst(i,t)}else{c.initSelectWithFirstValue(i)}}})}else{i.empty()}}onProfileFieldChanged(){this.updateDateFormatVisibility();this.rulesTable?.onProfileFieldChanged()}updateDateFormatVisibility(){const e=this.$find('select[name="profileField"]').val();const t=this.config.profileFields[e];this.toggle("#decisionDateFormat",t&&t.toLowerCase()==d.FIELD_TYPE_DATE)}updateVisibility(){this.onTypeChanged();this.onDecisionReactionChanged();this.onCriteriaChanged()}updateVisibilityOfRuleMailingReceived(){const i=this;const e=this.$decisionType.val();if(e==d.constants.decisionTypeAutoOptimization){this.hide("#ruleMailingReceivedWrapper")}else if(e==d.constants.decisionTypeDecision){var t=this.$decisionCriteria.val();if(t==d.constants.decisionReaction){this.hide("#ruleMailingReceivedWrapper")}else if(t==d.constants.decisionProfileField){this.hide("#ruleMailingReceivedWrapper");c.forEachPreviousNode(function(e){if(d.NODE_TYPES_MAILING.includes(e.getType())){var t=e.getData();this.profileFieldMailingId=t.mailingId;i.show("#ruleMailingReceivedWrapper");return false}})}}}checkPresentNodeOfType(e){return c.getNodesByTypes(e).length>0}}AGN.Lib.WM.DecisionNodeEditor=e})();(function(){class e extends AGN.Lib.WM.MailingNodeEditor{constructor(e){super(e);this.safeToSave=false}get formName(){return"smsMailingForm"}get title(){return t("workflow.mailing.mediatype_sms")}get $editor(){return $("#mailing_mediatype_sms-editor")}}AGN.Lib.WM.SmsMailingNodeEditor=e})();(function(){class e extends AGN.Lib.WM.MailingNodeEditor{constructor(e){super(e);this.safeToSave=false}get formName(){return"postMailingForm"}get title(){return t("workflow.mailing.mediatype_post")}get $editor(){return $("#mailing_mediatype_post-editor")}}AGN.Lib.WM.PostMailingNodeEditor=e})();(function(){const i=AGN.Lib.WM.Definitions;const r=AGN.Lib.WM.EditorsHelper;const n=AGN.Lib.Messages;class e extends AGN.Lib.WM.NodeEditor{constructor(){super();this.panelIds=["fixedDeadlinePanel","delayDeadlinePanel"];this.timeUnitIds=["deadlineTimeUnitMinute","deadlineTimeUnitHour","deadlineTimeUnitDay","deadlineTimeUnitWeek","deadlineTimeUnitMonth"]}get saveOnOpen(){return true}get formName(){return"deadlineForm"}getDefaultDelayData(e){if(e===i.constants.deadlineTypeDelay&&this.isPrecededByImportIcon){return{timeUnit:i.constants.deadlineTimeUnitHour,delayValue:i.constants.defaultImportDelayLimit}}return{}}get title(){return t("workflow.deadline.title")}get deadlineType(){return this.$find('[name="deadlineType"]').val()}get timeUnit(){return this.$find('select[name="timeUnit"]').val()}fillEditor(e){const t=e.getData();this.isPrecededByImportIcon=this.checkPrecededByImportIcon(e);this.$form.submit(false);this.$find("#deadlineDate").datepicker("setDate",this.dateAsUTC(t.date||new Date));this.fillDelayData(t);this.$find("#time").val(("0"+t.hour).slice(-2)+":"+("0"+t.minute).slice(-2))}fillDelayData(e){this.$form.get(0).reset();const t=this.deadlineType;const i=this.getDefaultDelayData(t);r.fillFormFromObject(this.formName,e,"",i);this.updateVisibility();const n=e.delayValue||i.delayValue;r.initSelectWithValueOrChooseFirst(this.$find('[name="delayValue"]'),n)}saveEditor(){const e=r.formToObject(this.formName);const t=this.$find("#time").val();e.date=this.$find("#deadlineDate").datepicker("getDate");e.hour=t.substring(0,2);e.minute=t.substring(3,5);return e}updateVisibility(){const e=this.$find("#deadline-type-box");let t=this.deadlineType;if(this.checkPresentNodeOfType([i.NODE_TYPE_ACTION_BASED_MAILING,i.NODE_TYPE_DATE_BASED_MAILING])){e.hide();this.$find("#typeDelay").prop("selected",true);t=i.constants.deadlineTypeDelay}else{e.show()}if(t===i.constants.deadlineTypeDelay){this.switchPanelsVisibility("delayDeadlinePanel");this.switchTimeContainerVisibility(false);switch(this.timeUnit){case i.constants.deadlineTimeUnitMinute:this.switchTimeUnitsVisibility("deadlineTimeUnitMinute");break;case i.constants.deadlineTimeUnitHour:this.switchTimeUnitsVisibility("deadlineTimeUnitHour");break;case i.constants.deadlineTimeUnitDay:this.switchTimeUnitsVisibility("deadlineTimeUnitDay");this.switchTimeContainerVisibility(true);$("#deadlineTimeHelp").removeAttr("style");break;case i.constants.deadlineTimeUnitWeek:this.switchTimeUnitsVisibility("deadlineTimeUnitWeek");break;case i.constants.deadlineTimeUnitMonth:this.switchTimeUnitsVisibility("deadlineTimeUnitMonth");break}this.$find('input[name="useTime"]').show()}else if(t===i.constants.deadlineTypeFixedDeadline){this.switchPanelsVisibility("fixedDeadlinePanel");this.switchTimeContainerVisibility(true);this.hide("#deadlineTimeHelp");this.$find('input[name="useTime"]').hide()}}switchPanelsVisibility(t){const i=this;this.panelIds.forEach(function(e){if(e!==t){i.hide(`#${e}`)}});this.show(`#${t}`)}switchTimeUnitsVisibility(t){const i=this;this.timeUnitIds.forEach(function(e){if(e!==t){i.hide(`#${e}`);$("#"+e+" select").removeAttr("name")}});this.show(`#${t}`);$(`#${t} select`).attr("name","delayValue")}switchTimeContainerVisibility(e){this.toggle("#deadlineTimeContainer",e)}save(){let e=true;if(this.isPrecededByImportIcon){if(this.deadlineType===i.constants.deadlineTypeDelay){if(this.timeUnit===i.constants.deadlineTimeUnitMinute){e=false}else if(this.timeUnit===i.constants.deadlineTimeUnitHour){if($("#deadlineTimeUnitHour select").val()<i.constants.defaultImportDelayLimit){e=false}}}}if(e){super.save()}else{n.warn("error.workflow.deadlineIsTooShortForImport")}}onTimeChanged(){if(this.deadlineType==i.constants.deadlineTypeDelay&&this.timeUnit==i.constants.deadlineTimeUnitDay){this.$find('input[name="useTime"]').prop("checked",true)}}checkPresentNodeOfType(e){return r.getNodesByTypes(e).length>0}checkPrecededByImportIcon(e){return r.getNodesByIncomingConnections(e).some(e=>i.NODE_TYPE_IMPORT==e.getType())}}AGN.Lib.WM.DeadlineNodeEditor=e})();(function(){const i=AGN.Lib.WM.Definitions;const n=AGN.Lib.WM.EditorsHelper;const e=AGN.Lib.Select;const r=AGN.Lib.Messages;class s extends AGN.Lib.WM.NodeEditor{constructor(e){super();this.submitWorkflowForm=e;this.targetSelector="#recipientTargetSelect";this.altgSelector="#recipientAltgSelect";this.safeToSave=true}get formName(){return"recipientForm"}get $targetSelect(){return $(this.targetSelector)}get targetSelect(){return e.get(this.$targetSelect)}get altgSelect(){return new e($(this.altgSelector))}createNewTarget(){n.processForward(i.constants.forwards.TARGET_GROUP_CREATE.name,this.targetSelector,this.submitWorkflowForm)}editTarget(e){$("#forwardTargetItemId").val(e);n.processForward(i.constants.forwards.TARGET_GROUP_EDIT.name,this.targetSelector,this.submitWorkflowForm)}get title(){return t("workflow.recipient")}fillEditor(e){var t=e.getData();if(!i.constants.isAltgExtended){if(i.constants.accessLimitTargetId>0){t.targets=_.union([i.constants.accessLimitTargetId],t.targets);t.targetsOption="ALL_TARGETS_REQUIRED"}}this.$form.submit(false);this.$form.get(0).reset();n.fillFormFromObject(this.formName,t,"");this.targetSelect.selectValue(t.targets);if(i.constants.isAltgExtended){this.altgSelect.selectValue(t.altgs)}this.isValid()}saveEditor(){var e=n.formToObject(this.formName);e.targets=this.targetSelect.getSelectedValue();if(i.constants.isAltgExtended){e.altgs=this.altgSelect.getSelectedValue()}return e}}AGN.Lib.WM.RecipientNodeEditor=s})();AGN.Lib.Controller.new("action-view",function(){const n=AGN.Lib.Form;const r=AGN.Lib.Template;const a=AGN.Lib.Select;let s;let o={};class i{constructor(t){this.$container=t;this.activeModules=[];t.on("remove-module",()=>{const e=t.find("[data-action-module] [data-module-index]");$.each(e,(e,t)=>$(t).html(e+1+"."))});t.on("add-new-module",()=>{const e=t.find("[data-action-module]");e.last().find("[data-module-index]").html(e.length+".")})}clean(){this.$container.empty()}addModule(e){if(e&&e.type){e.index=this._getNextIndex();const i=r.dom("common-module-data",{moduleName:t(`triggerManager.operation.${e.type}`)});const n=r.text(`module-${e.type}`,e.getParameters());i.find(".tile").append(n);this.$container.append(i);AGN.runAll(i);this.$container.trigger("add-new-module");this.activeModules.push(e)}}deleteModule(t){if(t>=0){const e=this.$container.find(`[data-module-content="${t}"]`);e.closest("[data-action-module]").remove();this.$container.trigger("remove-module");this.activeModules=this.activeModules.filter(e=>e.index!==t)}}toJson(){const i=[];this.$container.find("[data-module-content]").each(function(e,t){i.push(l.toJson($(t),e))});return i}getSubmissionJson(){return JSON.stringify(this.toJson())}getModulesByType(t){return this.activeModules.filter(e=>e.type===t)}_getNextIndex(){const e=this.$container.find("[data-module-content]");let t=0;if(e.length>0){const i=e.last().data("module-content");t=i+1}return t}}class l{constructor(e,t,i){this.type=e;this.index=i||0;this.id=t.id||0;this.data=$.extend(l.defaults(e),t)}static defaults(e){const t={};switch(e){case"ActivateDoubleOptIn":t.forAllLists=false;t.mediaTypeCode=0;break;case"ContentView":t.tagName="";break;case"ExecuteScript":t.script="";break;case"GetArchiveList":t.campaignID=0;break;case"GetArchiveMailing":t.expireDate=null;break;case"GetCustomer":t.loadAlways=false;break;case"IdentifyCustomer":t.keyColumn="";t.passColumn="";break;case"SendMailing":t.mailingID=0;t.delayMinutes=0;t.bcc="";t.userStatusesOption=1;break;case"ServiceMail":t.toAddress="";t.fromAddress="";t.replyAddress="";t.subjectLine="";t.mailtype=0;t.textMail="";t.htmlMail="";break;case"SubscribeCustomer":t.doubleCheck=false;t.keyColumn="";t.doubleOptIn=false;break;case"UnsubscribeCustomer":t.mailinglistIds=[];t.allMailinglistsSelected=false;t.additionalMailinglists=false;break;case"UpdateCustomer":t.useTrack=false;t.columnName="";t.updateValue="";t.updateType=1;t.trackingPointId=-1;break}t.readonly=false;return t}static create(e){return new l(e,{})}static deserialize(e,t){const i=o[e.operationType];return new l(i,e,t)}static toJson(e,t){const o={};o.index=t;e.find('[name^="modules[]"]').each(function(e,t){const i=$(t);const n=i.prop("name")||"";const r=n.replace("modules[].","");let s="";if(i.is("select")){s=a.get(i).getSelectedValue()}else if(i.is("input")&&i.prop("type")==="checkbox"){s=i.prop("checked")}else{s=i.val()}o[r]=s});return $.extend(l.defaults(o.type),o)}getParameters(){const e={type:this.type,index:this.index,id:this.id};return _.merge({},this.data,e)}}this.addDomInitializer("action-view",function(){const e=n.get(this.el);o=this.config.operationTypes;s=new i($("#module-list"));s.clean();let t=[];if(this.config.modules){t=JSON.parse(this.config.modules).map((e,t)=>l.deserialize(e,t))}t.forEach(e=>s.addModule(e));e.initFields()});this.addAction({click:"add-new-module"},function(){const e=$("#moduleName").val();const t=l.create(e);if(t.type==="SendMailing"){if(s.getModulesByType("ActivateDoubleOptIn").length>0){t.data.userStatusesOption=0}}s.addModule(t);n.get(this.el).initFields();if(t.type==="ActivateDoubleOptIn"){const i=s.getModulesByType("SendMailing");i.forEach(function(e){const t=$(`#module-${e.index}-userStatusesOption`);a.get(t).selectFirstValue()})}});this.addAction({click:"action-delete-module"},function(){const e=this.el.closest(".tile").find("[data-module-content]").data("module-content");s.deleteModule(e)});this.addAction({submission:"save-action-data"},function(){const e=n.get(this.el);e.setValueOnce("modulesSchema",s.getSubmissionJson());e.submit()});this.addDomInitializer("update-customer-module",function(){const e=$(this.el);const t=e.find('[data-action="toggle-if-first"]:checked');c(e,t.exists())});this.addAction({click:"toggle-if-first"},function(){const e=$(this.el);c(e,e.prop("checked"))});function c(e,t){const i=e.closest("[data-action-module]");const n=i.find("[data-useTrack-trackingPointId]");const r=i.find("[data-useTrack-updateValue]");if(!n.exists()){r.removeClass("hidden");return}if(i.index()===0){n.toggleClass("hidden",!t);r.toggleClass("hidden",t)}}});AGN.Lib.Controller.new("activeness-overview",function(){const n=AGN.Lib.Table;let r;this.addDomInitializer("activeness-overview",function(){r=this.config.url});this.addAction({click:"deactivate-js"},function(){e([s(this.el)],false,this.el)});this.addAction({click:"activate-js"},function(){e([s(this.el)],true,this.el)});this.addAction({click:"bulk-deactivate-js"},function(){e(l(true),false,this.el)});this.addAction({click:"bulk-activate-js"},function(){e(l(true),true,this.el)});function e(e,s,i){if(!a(e)){return}c(i);$.ajax(r,{method:"POST",traditional:true,data:{ids:e,activate:s,fromOverview:true}}).done(e=>{if(e.success){const r=n.get(i);const t=e.data.map(e=>{const t=typeof e==="object";const i=t?e.id:e;const n=o(r,i);if(t){return _.merge(n,e)}return _.merge(n,{active:String(s)})});r.api.applyTransaction({update:t})}AGN.Lib.JsonMessages(e.popups)}).always(()=>c(i))}function o(e,t){const i=[];e.api.forEachNodeAfterFilterAndSort(e=>{if(t===e.data.id){i.push(e.data)}});return i[0]}this.addAction({click:"activate"},function(){t(this.el,true)});this.addAction({click:"deactivate"},function(){t(this.el,false)});this.addAction({click:"bulk-activate"},function(){i(l(),true)});this.addAction({click:"bulk-deactivate"},function(){i(l(),false)});function t(e,t=true){i([s(e)],t)}function i(e,t){if(!a(e)){return}const i=$(".table-wrapper__body").scrollTop();$.ajax(r,{method:"POST",traditional:true,data:{ids:e,activate:t,fromOverview:true}}).done(e=>{AGN.Lib.Form.get($("#table-tile")).updateHtml(e);u(i)})}function a(e){if(e.length>0){return true}AGN.Lib.Messages.alert("messages.error.nothing_selected");return false}function s(e){if(e.closest("table").exists()){return e.closest("tr").find("[data-bulk-checkbox]").val()}return e.data("item-id")}function l(e=false){if(e){return n.get($(".table-wrapper")).api.getSelectedRows().map(e=>e.id)}return $(`[data-bulk-checkbox]:checked`).map(function(){return $(this).val()}).get()}function c(e){if(e.is("a")){e.toggleClass("disabled");e.toggleClass("pe-none")}else{e.prop("disabled",!e.prop("disabled"))}}function u(e){$(".table-wrapper__body").scrollTop(e)}});AGN.Lib.Controller.new("address-management",function(){const r=AGN.Lib.Table;const n=AGN.Lib.Messages;const s=AGN.Lib.Confirm;const i="data-entry-category";let o;this.addDomInitializer("address-management",function(){o=this.config.email});this.addAction({click:"delete-all"},function(){const e=a();s.from("confirm-delete-all-modal",{affectedCategories:e}).done(()=>{$.post(AGN.url(`/address-management/entries/deleteAll.action?email=${o}`)).done(e=>AGN.Lib.Form.get(this.el).updateHtml(e))})});function a(){return $(".btn-category:not([disabled])").map(function(){return $(this).data("entry-category-tab")}).get()}this.addAction({click:"update-all"},function(){e(e=>{$.post(AGN.url(`/address-management/entries/replaceAll.action?email=${o}&newEmail=${e}`)).done(e=>AGN.Lib.Form.get(this.el).updateHtml(e))})});this.addAction({click:"delete-entry"},function(){const e=g(this.el);const t=r.get(this.el).findRowByElement(this.el);s.from("confirm-single-delete-modal",{category:e,data:t.data}).done(()=>{l([h(this.el)],()=>d(this.el))})});this.addAction({click:"bulk-delete"},function(){const i=r.get(this.el);const n=i.api.getSelectedRows();const e=g(this.el);const t=p(n,e);s.from("confirm-bulk-delete-modal",{category:e}).done(()=>{l(t,e=>{const t=n.filter(t=>e.find(e=>e.id===t.id&&e.companyId===t.companyId));c(t,i)})})});function l(e,t){$.ajax({url:AGN.url(`/address-management/entries/delete.action?email=${o}`),type:"POST",contentType:"application/json",data:JSON.stringify(e),dataType:"json",success:e=>{if(e.success){t(e.data)}AGN.Lib.JsonMessages(e.popups,true)},error:n.defaultError})}this.addAction({click:"replace-email"},function(){const e=$("#new-email-address");const i=e.val();if(AGN.Lib.Helpers.isValidEmail(i)){s.get(this.el).positive(i)}else{AGN.Lib.Form.showFieldError$(e,t("import.columnMapping.error.invalidEmail"))}});this.addAction({click:"single-replace"},function(){e(e=>{u(e,[h(this.el)],()=>d(this.el))})});this.addAction({click:"bulk-replace"},function(){e(e=>{const i=r.get(this.el);const n=i.api.getSelectedRows();const t=p(n,g(this.el));u(e,t,e=>{const t=n.filter(t=>e.find(e=>e.id===t.id&&e.companyId===t.companyId));c(t,i)})})});function c(e,t){const i=g(t.$el);t.api.applyTransaction({remove:e});f(i,e.length)}function e(e){s.from("replace-email-modal").done(e)}function u(t,e,i){$.ajax({url:AGN.url(`/address-management/entries/replace.action?oldEmail=${o}&email=${t}`),type:"POST",contentType:"application/json",data:JSON.stringify(e),dataType:"json",success:e=>{if(e.success){if(!t.toLowerCase().includes(o.toLowerCase())){i(e.data)}}AGN.Lib.JsonMessages(e.popups,true)},error:n.defaultError})}function d(e){const t=r.get(e);const i=t?.findRowByElement(e);if(i){const n=g(e);t.api?.applyTransaction({remove:[i.data]});f(n)}}function h(e){return{id:e.data("entry-id"),companyId:e.data("entry-cid"),category:g(e)}}function p(e,t){return e.map(e=>{return{id:e.id,companyId:e.companyId,category:t}})}function f(e,t=1){const i=$(`[data-entry-category-tab=${e}]`);const n=i.find("span");const r=parseInt(n.text())-t;n.text(r);i.prop("disabled",r===0)}function g(e){return e.closest(`[${i}]`).attr(i)}});AGN.Lib.Controller.new("admin-enabling",function(){this.addAction({click:"save-approved-mailing-lists"},function(){var t=this.el;var e=AGN.Lib.Form.getWrapper(t);n(e);var i=AGN.Lib.Form.get(e);i.submit().done(function(e){if(e.success===true){AGN.Lib.JsonMessages(e.popups,true);AGN.Lib.Modal.getWrapper(t).modal("hide")}else{AGN.Lib.JsonMessages(e.popups,true)}})});function n(e){$("input[name*='disabledMailinglistsIds']").remove();t("mailinglist").each(function(){$("<input>").attr({type:"hidden",name:"disabledMailinglistsIds",value:$(this).data("mailinglist")}).appendTo(e)})}function t(e){if(e){return $("input:checkbox:not(:checked)[data-enabling="+e+"]")}else{return $("input:checkbox:not(:checked)[data-enabling]")}}});AGN.Lib.Controller.new("ai-image-generation",function(){let i;let n;let r;let s;let o;let a;this.addDomInitializer("ai-image-generation",function(){i=$("#ai-generated-image");n=$("#remaining-generations-text");r=$("#generate-btn");s=$("#save-btn");o=$("#important-objects-table");a=$("#filters-table");c(this.config.remainingGenerations)});this.addAction({click:"generate"},function(){const e=AGN.Lib.Form.get(this.el);u(e);d(e);e.jqxhr().done(e=>{if(e.success){c(e.data.remainingGenerationsCount);l(e.data.url);s.removeClass("hidden")}else{AGN.Lib.JsonMessages(e.popups)}})});function l(e){i.attr("src",e);i.parent().removeClass("hidden");i.parent().prev().addClass("hidden")}function c(e){if(e<=0){n.text(t(`mediapool.imageGeneration.limitExceeded`));r.parent().remove()}else{n.text(t(`mediapool.imageGeneration.remainingGenerations`,e))}}this.addAction({click:"save"},function(){const e=$("#ai-generated-image").attr("src");$.post(AGN.url("/mediapool/generated-image/save.action"),{url:e}).done(e=>AGN.Lib.Page.render(e))});this.addAction({change:"use-important-objects"},function(){e(o,!this.el.is(":checked"))});this.addAction({change:"use-filters"},function(){e(a,!this.el.is(":checked"))});function e(e,t){const i=e.find(":input");i.prop("disabled",t);i.prev().toggleClass("input-group-text--disabled",t);e.find(".btn").toggleClass("disabled",t);i.filter(".js-colorpicker").spectrum(t?"disable":"enable")}function u(n){const e=AGN.Lib.InputTable.get(o);e.collect().forEach(function(t,i){Object.keys(t).forEach(e=>{n.setValueOnce(`importantObjects[${i}].${e}`,t[e])})})}function d(n){const e=AGN.Lib.InputTable.get(a);const t=_.groupBy(e.collect(),"name");_.forEach(t,function(e,t){const i=_.map(e,"value");n.setValueOnce(`filters[${t}]`,i)})}});AGN.Lib.Controller.new("ai-text-generation",function(){const o=AGN.Lib.Form;let n;this.addDomInitializer("ai-text-generation",function(){const e=AGN.Lib.Select.get(this.el.find("[data-ai-language]"));if(e.hasOption(window.adminLocale)){e.selectValue(window.adminLocale)}});this.addAction({enterdown:"skip-form-submit"},function(){this.event.preventDefault()});this.addAction({click:"generateText"},function(){const i=d(this.el);if(r(i)){const e=l(i);$.post(AGN.url("/mailing/content/generateText.action"),e).done(e=>{n=e.data;c(e.data,i);this.el.find(".text").text(t("ai.regenerateText"))}).fail(()=>AGN.Lib.Messages.defaultError())}});function r(e){let i=true;const n=e.find("[data-ai-numberOfWords]");const r=e.find("[data-ai-contentDescription]");const s=AGN.Lib.Validator.get("number").errors(n,{min:1,required:true});if(s.length>0){i=false;s.forEach((e,t)=>o.showFieldError$(n,e.msg))}else{o.cleanFieldFeedback$(n)}if(!$.trim(r.val())){i=false;o.showFieldError$(r,t("fields.required.errors.missing"))}else{o.cleanFieldFeedback$(r)}return i}this.addAction({click:"applyGeneratedText"},function(){const e=d(this.el);const t=u(e).val();if(e.is(".tile")){const i=this.el.closest("[data-tab-id]").data("tab-id");s(i);a(t,e,i)}else{AGN.Lib.Confirm.get(this.el).positive(t)}});function s(e){const t=$(`[data-toggle-tab*="wysiwyg${e}"]`);if(t.exists()){t.trigger("click");return}const i=$(`[data-toggle-tab*="html${e}"]`);if(i.exists()){i.trigger("click")}}function a(t,e,i){const n=e.find(".js-wysiwyg");if($("#tab-content-wysiwyg").is(":visible")||$(`[id^='tab-grid-wysiwyg${i}']`).is(":visible")){var r=CKEDITOR.instances[n.attr("id")];if(r.status==="ready"){r.setData(t)}else{r.on("instanceReady",e=>e.editor.setData(t))}}if($("#contentEditor").is(":visible")||$(`[id^='tab-grid-html${i}']`).is(":visible")){ace.edit(`${n.attr("name")}Editor`).setValue(t)}}function l(e){return{language:e.find("[data-ai-language]").val(),numberOfWords:e.find("[data-ai-numberOfWords]").val(),tonality:e.find("[data-ai-tonality]").val(),contentDescription:e.find("[data-ai-contentDescription]").val()}}function c(e,t){u(t).val(e).trigger("change");t.find("#ai-apply-text-btn").removeClass("hidden")}function u(e){return e.find("[data-ai-result]")}function d(e){return e.closest(".tile, .modal")}});AGN.Lib.Controller.newExtended("auto-export","auto-import-export-base",function(){let i;this.addDomInitializer("auto-export",function(){e()});this.addDomInitializer("mailing-options-attribute-resolver",function(){i=new t(this.config)});this.addAction({click:"evaluate"},function(){$.post(this.el.attr("href")).done(e=>AGN.Lib.Page.render(e))});this.addAction({change:"select-export-profile"},function(){e()});this.addAction({change:"change-mailing-type"},function(){const e=AGN.Lib.Select.get(this.el).getSelectedValue();const t=AGN.Lib.Select.get($("select#exportType")).getSelectedValue();i.resolve(t,e)});this.addAction({change:"export-type-resolver"},function(){const e=AGN.Lib.Select.get($("select#exportType")).getSelectedValue();const t=AGN.Lib.Select.get($("select#exportMailing")).getSelectedValue();i.resolve(e,t)});this.addAction({submission:"save-scheduler-data"},function(){const e=n(this.el);const t=e.getAllDayRows().every(e=>e.validateTimeIntervals());if(t){const i=AGN.Lib.Form.get($(this.el));i.setValueOnce("intervalAsJson",e.getSubmissionJson("day"));i.submit()}});function e(){const e=$("select#export-profile").val();const t=parseInt(e)>0;$("#add-profile-btn").toggle(!t);$("#edit-profile-btn").toggle(t).attr("href",AGN.url(`/export/${e}/view.action`))}function n(e){return e.closest("[data-controller]").data("_schedule_table")}class t{constructor(e){this.exportType=e.exportType||"";this.mailingType=e.mailingType||-1;this.$oneTimeCheckbox=$('input[name="autoExport.oneTime"]');this.initialOneTimeValues={checked:this.$oneTimeCheckbox.is(":checked"),disabled:this.$oneTimeCheckbox.is(":disabled")};this.toggleOneTimeSwitch()}resolve(e,t){this.exportType=e||"";this.mailingType=t||-1;this.toggleOneTimeSwitch()}toggleOneTimeSwitch(){const e=this.exportType=="Mailing"&&this.mailingType==0;this.$oneTimeCheckbox.prop("checked",e||this.initialOneTimeValues.checked);this.$oneTimeCheckbox.prop("disabled",e||this.initialOneTimeValues.disabled)}}});AGN.Lib.Controller.newExtended("auto-import","auto-import-export-base",function(){let o;let n={};let t=false;this.addDomInitializer("auto-import",function(){o=this.config.isWorkflowDriven;if(s()){e(this.config.contentSourceIdentifier)}i()});this.addAction({click:"save-auto-import"},function(){const e=$("#auto-import-form");const t=l(e);const i=t.getAllDayRows().every(e=>e.validateTimeIntervals());if(i){const n=AGN.Lib.Form.get(e);const r=t.getSubmissionJson("day");const s=a();if(o){n.setValue("intervalAsJson",r);if(s.length){n.setValue("contentSourceID",s[0]);n.setValue("contentSourceType",s[1])}}else{n.setValueOnce("intervalAsJson",r);if(s.length){n.setValueOnce("contentSourceID",s[0]);n.setValueOnce("contentSourceType",s[1])}}n.submit()}});this.addAction({click:"import"},function(){$.post(this.el.attr("href")).done(e=>AGN.Lib.Page.render(e))});this.addDomInitializer("import-profile-mailing-lists",function(){t=this.config.isAutoImportNew;n=this.config.profileMailinglists;const e=$('[name="importProfileId"]').val();r(e,t)});this.addAction({change:"change-import-profile"},function(){const e=AGN.Lib.Select.get($(this.el)).getSelectedValue();r(e,t);i()});function i(){const e=$("select#auto-import-profile").val();const t=parseInt(e)>0;$("#add-profile-btn").toggle(!t);$("#edit-profile-btn").toggle(t).attr("href",AGN.url(`/import-profile/${e}/view.action`))}const r=function(e,t){if(t){const i=n[e];$('input[type=checkbox][name^="mailinglists"]').prop("checked",false);_.each(i,e=>{$(`input[type=checkbox][name="mailinglists[${e}]"]`).prop("checked",true)})}};function e(e){const t=AGN.Lib.Select.get($("#contentSourceId"));if(t.hasOption(e)){t.selectValue(e)}}function a(){if(s()){return $("#contentSourceId").val().split("/")}return[]}function s(){return $("#contentSourceId").exists()}function l(e){return e.closest("[data-controller]").data("_schedule_table")}});AGN.Lib.Controller.new("auto-import-export-base",function(){const s=AGN.Lib.ScheduleTimeTable;const o=AGN.Lib.ScheduleTimeTable.DayRow;let a;this.addDomInitializer("auto-import-export-scheduler",function(){const e=this.el;const t=this.config;const i=t.intervalAsJson||[];a=new s(e);l(e,a);let n=[];if(!_.isEmpty(i)){n=JSON.parse(i).map(e=>o.deserialize(e)).filter(e=>e)}n.forEach(e=>a.addRow(e));if(n.length===0){a.addEmptyDayRow()}const r=AGN.Lib.Form.get(e);r.initFields();if(!r.editable){e.find(":input").prop("disabled",true);e.find("a").addClass("disabled")}});this.addAction({click:"add-day"},function(){a.addEmptyDayRow()});this.addAction({click:"remove-day"},function(){a.deleteRow(o.get(this.el))});this.addAction({click:"add-schedule"},function(){o.get(this.el).addSchedule()});this.addAction({click:"remove-schedule"},function(){o.get(this.el).removeSchedule(this.el)});this.addAction({click:"time-checkbox-toggle"},function(){o.get(this.el).timeCheckboxToggle(this.el)});this.addAction({click:"hour-checkbox-toggle"},function(){o.get(this.el).hourCheckboxToggle(this.el)});this.addAction({change:"validate-changes"},function(){o.get(this.el).validateTimeIntervals()});function l(e,t){e.closest("[data-controller]").data("_schedule_table",t)}this.addAction({click:"check-connection"},function(){const e=AGN.Lib.Form.get(this.el);$.ajax(this.el.attr("href"),{type:"POST",dataType:"html",enctype:"multipart/form-data",processData:false,contentType:false,data:e.data()}).done(e=>AGN.Lib.Page.render(e))})});AGN.Lib.Controller.new("available-building-blocks",function(){let n;let r;let i;function e(){n={};r={}}this.addDomInitializer("available-building-blocks",function(){e();i=AGN.Lib.Form.get(this.el);if(this.config.changedBlockStatus){n=JSON.parse(this.config.changedBlockStatus)}});this.addDomInitializer("available-building-blocks-table",function(){const e=this.config.divContainerList;_.each(e,function(e){const t=e.id;const i=e.active;if(t in r){if(t in n){$(`input:checkbox[data-block-id='${t}']`).prop("checked",!!n[t])}}else{r[t]=i}})});this.addAction({click:"search"},function(){const e=this.el;s();i.setActionOnce(e.data("form-url"));i.setResourceSelectorOnce(e.data("form-resource"));i.submit()});this.addAction({click:"save-changed-data"},function(){const t=this.el;s();i.setActionOnce(t.data("form-url"));i.jqxhr().done(e=>{AGN.Lib.JsonMessages(e.popups);if(e.success){AGN.Lib.Confirm.get(t).positive()}})});this.addAction({change:"change-activation"},function(){const e=this.el;const t=e.data("block-id");if(e.is(":checked")==r[t]){if(t in n){delete n[t]}}else{n[t]=e.is(":checked")}});this.addAction({change:"activate-all"},function(){const e=$("input:checkbox[data-block-id]");e.prop("checked",this.el.is(":checked")).change()});function s(){if(!!i){const e=JSON.stringify(n,(e,t)=>t!==null?t:undefined);i.setValue("changedBlockStatusJson",e)}}});AGN.Lib.Controller.new("birt-reports",function(){let s={},t=0,r=[],o=[],a=[],i,n,l;const c=".form-check-input";this.addDomInitializer("birt-reports",function(){s=this.config;n=s.constant.MAILING_ID;i=s.constant.AFTER_MAILING_TYPE_ID;r=s.filtered.FILTER_ARCHIVE;o=s.filtered.FILTER_MAILINGLIST;a=s.filtered.FILTER_TARGET;t=s.reportType;l=this.el});this.addDomInitializer("report-settings",function(){$("#extended-settings-tile").find("[data-toggle-tab]").on("click",function(e){if(!$(e.target).is(c)){const t=$(this).find(c).is(":checked");u().prop("checked",t)}});e();new p(this.el,this.config)});this.addAction({click:"confirm-deactivate-deliveries"},function(){AGN.Lib.Confirm.createFromTemplate({},"report-deactivate-deliveries")});this.addAction({click:"activate-delivery"},function(){const e=this.el.is(":checked");this.event.stopPropagation();window.setTimeout(()=>this.el.prop("checked",e),0);const t=this.el.closest(".btn").is(".active");if(t){u().prop("checked",e)}});function u(){return $('[data-action="activate-delivery-for-active-tab"]')}this.addAction({click:"activate-delivery-for-active-tab"},function(){const e=this.el.is(":checked");this.event.stopPropagation();window.setTimeout(()=>this.el.prop("checked",e),0);$("#extended-settings-tile").find("[data-toggle-tab].active").find(c).prop("checked",e)});this.addAction({change:"interval-change"},function(){e()});function e(){const e=$("#interval").val();if(e==i){d()}else if(t==i){h()}t=e}function d(){$("#extended-settings-tile").find("[data-toggle-tab]").each(function(){const e=$(this);const t=e.data("toggle-tab");if(t.endsWith(n)){e.trigger("click");return}e.addClass("disabled");AGN.Lib.Tab.hide($(t))})}function h(){$("#extended-settings-tile").find("[data-toggle-tab]").each(function(){$(this).removeClass("disabled")})}class p{constructor(e,t){this.$container=e;this.config=t;this.settingsType=t.settingsType;this.select=AGN.Lib.Select.get(e.find(t.selectors.filterBlockId));this.mailingSelect=AGN.Lib.Select.get(e.find(t.selectors.normalMailing));this.init(t);e.find(t.selectors.mailingType).on("change",e=>{this.handleMailingTypeChanges($(e.target))});e.find(t.selectors.mailingFilter).on("change",e=>{this.handleMailingFilterChanges($(e.target))});e.find(t.selectors.filterBlockId).on("change",e=>{this.handleMailingFilterValueChanges($(e.target))})}init(e){const t=e.data.mailingType;const i=e.data.mailingFilter;const n=e.data.predefineMailing;const r=e.data.selectedMailings;const s=this.updateAllComparisonDependentFields(t,i,n,r);s.done(()=>l.dirty("setAsClean"))}handleMailingTypeChanges(e){const t=this.getMailingFilter();const i=this.getMailingFilterValue();this.updateNormalMailingField(e.val(),t,i)}handleMailingFilterChanges(e){this.updateAllComparisonDependentFields(this.mailingType,e.val())}handleMailingFilterValueChanges(e){const t=this.getMailingFilter();this.updateNormalMailingField(this.mailingType,t,e.val())}updateAllComparisonDependentFields(e,t,i,n){this.select.resetOptions();if(t>0){let e=[];if(t==1){e=r}else if(t==2){e=o}else if(t==4){e=a}_.each(e,e=>this.select.addFormattedOption(`<option value="${e.id}">${e.shortname}</option>`));this.select.selectValueOrSelectFirst(i);i=this.select.getSelectedValue()}return this.updateNormalMailingField(e,t,i,n)}updateNormalMailingField(e,t,i,n){const r=$.Deferred();this.mailingSelect.resetOptions();if(this.settingsType==s.constant.COMPARISON_SETTINGS&&e==2||this.settingsType==s.constant.MAILING_SETTINGS&&e==3){$.ajax({type:"GET",url:AGN.url("/statistics/report/getFilteredMailing.action"),data:{type:t,value:i?i:0,mailingType:s.constant.NORMAL_MAILING_TYPE}}).done(e=>{_.each(e,e=>this.mailingSelect.addFormattedOption(`<option value="${e.id}">${e.shortname}</option>`));this.mailingSelect.selectValue(n?n:"");r.resolve()})}return r.promise()}getMailingFilter(){const e=this.$container.find(this.config.selectors.mailingFilter);return parseInt(e.val())|0}getMailingFilterValue(){return parseInt(this.select.getSelectedValue())|0}get $mailingType(){return this.$container.find(`${this.config.selectors.mailingType}`)}get mailingType(){return parseInt(this.$mailingType.val())||0}}});AGN.Lib.Controller.new("blacklist-list",function(){this.addAction({click:"save"},function(){$.ajax(this.el.data("url"),{type:"POST",data:{email:$("#new-entry-email").val(),reason:$("#new-entry-reason").val()},success:e=>i(e)})});this.addAction({click:"save-edit"},function(){const t=this.el;AGN.Lib.Form.get(t).submit().done(e=>{i(e,()=>AGN.Lib.Modal.getInstance(t).hide())})});function i(e,t){if(e.success===true){AGN.Lib.Form.get($("#blacklist-overview")).submit().done(()=>AGN.Lib.JsonMessages(e.popups,true));if(t){t()}}else if(e.popups){AGN.Lib.JsonMessages(e.popups,true)}else{AGN.Lib.RenderMessages($(e))}}});AGN.Lib.Controller.new("company-insights",function(){const o=AGN.Lib.ChartUtils;const f=50;const g=f+10;let i;let t;let r;let a;let v;let s=[];this.addAction({change:"load-dynamic-statistic"},function(){w()});this.addDomInitializer("company-insights",function(){s=this.config.revenueImages;i=$("#type-of-reactor-chart");t=$("#rebuy-rate-chart");r=$("#revenue-chart");a=$("#reaction-devices-chart");v=$("#devices-progress-chart");w();const e=this.config.chartData;if(this.config.chartData){n(e["reactorType"]);l(e["rebuyRate"]);c(e["revenue"]);u(e)}else{x(i,true);x(t,true);x(r,true)}});function n(e){if(Object.values(e).some(e=>e<=0)){x(i,true);return}const t=[i.css("--chart-very-dark-blue-color"),i.css("--chart-blue-color"),i.css("--chart-light-cyan-color")];new Chart(i[0].getContext("2d"),{type:"agnDoughnut",data:{labels:Object.keys(e),datasets:[{data:Object.values(e),backgroundColor:t,borderWidth:0}]},options:{plugins:{"half-doughnut-label":false,revenueIcon:false,hideXAxisIfLabelsOverlaps:false}}})}function l(r){if(r<=0){x(t,true);return}r=S(r);const e=[t.css("--chart-blue-color"),t.css("--chart-light-grey-color")];const s=t.css("--chart-half-doughnut-label-color");Chart.register({id:"half-doughnut-label",beforeDraw:(e,t)=>{const i=e.getDatasetMeta(0).data[0].y;const n=Math.floor(e.height*.1);e.ctx.textBaseline="middle";e.ctx.textAlign="center";e.ctx.font=`600 ${n}px ${Chart.defaults.font.family}`;e.ctx.fillStyle=s;e.ctx.fillText(`${r}%`,e.width/2,i-n/3)}});new Chart(t[0].getContext("2d"),{type:"doughnut",data:{datasets:[{data:[r,100-r],backgroundColor:e,borderWidth:0}]},options:{rotation:-90,circumference:180,plugins:{legend:{display:false},datalabels:{display:false},tooltip:{external:null},revenueIcon:false,hideXAxisIfLabelsOverlaps:false}}})}function c(e){const n=o.getTotal(Object.values(e));if(n<=0){x(r,true);return}const t=[r.css("--chart-very-dark-blue-color"),r.css("--chart-dark-blue-color"),r.css("--chart-blue-color"),r.css("--chart-light-blue-color")];const p=s.map(e=>{const t=new Image;t.src=e;return t});Chart.register({id:"revenueIcon",afterDraw:d=>{const h=d.getDatasetMeta(0).data;_.each(Object.keys(h),(i,e)=>{const n=p[e];if(n.complete){const r=h[i];const s=r.x-r.width/2;const o=r.y+r.height;const a=n.width/n.height;const l=40*r.width/100;let e=Math.min(l,a*f);let t=e/a;if(t>f){t=f;e=t*a}const c=s+(r.width-e)/2;const u=o-(g-t)/2-t;d.ctx.drawImage(n,c,u,e,t)}else{n.onload=()=>d.draw()}})}});Chart.register({id:"hideXAxisIfLabelsOverlaps",afterRender:e=>{const t=e.getDatasetMeta(0).data;e.options.scales.x.display=!T(e.data.labels,t,e.ctx);e.update()}});new Chart(r[0].getContext("2d"),{type:"bar",data:{labels:Object.keys(e),datasets:[{data:Object.values(e),backgroundColor:t,categoryPercentage:.9,minBarLength:g}]},options:{indexAxis:"x",layout:{padding:{top:20,right:0}},scales:{x:{ticks:{autoSkip:false,maxRotation:0}},y:{display:false}},plugins:{"half-doughnut-label":false,legend:{display:false},datalabels:{anchor:"end",align:"end",offset:-5,formatter:(e,t)=>{const i=(e*100/n).toFixed(1);return`${i}%`}}}}})}function u(e){d(e["favoriteOpeningDays"]);h(e["favoriteOpeningHours"]);p(e["ctr"]);m(e["conversion"]);y(e["pageImpressions"]);b(e["pageImpressionsPerVisit"]);C(e["pageImpressionsPerBuy"])}function d(e){const i=$("#fav-days-stat-block");if(Object.keys(e).length>0){i.empty()}$.each(e,(e,t)=>{i.append(AGN.Lib.Template.dom("company-insights-fav-day-record",{day:e,value:t}))})}function h(e){const i=$("#fav-time-stat-block");if(Object.keys(e).length>0){i.empty()}$.each(e,(e,t)=>{i.append(AGN.Lib.Template.dom("company-insights-fav-time-record",{time:e,value:t}))})}function p(e){$("#ctr-val").text(e.toString().replace(".",",")+" %")}function m(e){if(e!=0){$("#conversion-val").text(e.toString().replace(".",",")+" %")}}function y(e){if(e!=0){$("#pi-val").text(e.toString().replace(",",".")+" √ò")}}function b(e){if(e!=0){$("#pi-visit-val").text(e.toString().replace(",",".")+" √ò")}}function C(e){if(e!=0){$("#pi-buy-val").text(e.toString().replace(",",".")+" √ò")}}function w(){const e=$("#progressOfUsedPeriod").val();const t={};if(e==="MONTH"){t["byMonth"]=true}else if(e=="PERIOD"){t["from"]=$("#progressOfUsedFrom").val();t["till"]=$("#progressOfUsedTill").val()}$.get(AGN.url("/recipient/chart/progressOfUsedDevices.action"),t).done(e=>{A(e);E(e)})}function A(e){const t=e["usedDevices"];const i=[{title:e["windowsTitle"],count:t["windows"]},{title:e["macTitle"],count:t["mac"]},{title:e["androidTitle"],count:t["android"]},{title:e["iosTitle"],count:t["ios"]}];i.sort((e,t)=>t.count-e.count);const n=i.map(e=>e.title);const r=i.map(e=>e.count);n.push(e["otherTitle"]);r.push(t["other"]);if(o.getTotal(r)===0){x(a,true);return}x(a,false);const s=[a.css("--chart-very-dark-blue-color"),a.css("--chart-dark-blue-color"),a.css("--chart-blue-color"),a.css("--chart-light-blue-color"),a.css("--chart-light-cyan-color")];Chart.getChart(a)?.destroy();new Chart(a[0].getContext("2d"),{type:"agnDoughnut",data:{labels:n,datasets:[{data:r,backgroundColor:s,borderWidth:0}]},options:{plugins:{"half-doughnut-label":false,revenueIcon:false,hideXAxisIfLabelsOverlaps:false}}})}function E(t){const e=v.css("--chart-black-color");const i=[];const n=[];const r=[];const s=[];const o=[];const a=[];const l=[];for(let e=0;e<t["usedDevicesByPeriods"].length;e++){const u=t["usedDevicesByPeriods"][e];const{windows:d,mac:h,android:p,ios:f,other:g}=u;const m=d+h+p+f+g;n.push(S(d/m));r.push(S(h/m));s.push(S(p/m));o.push(S(f/m));a.push(S(g/m));l.push(m);i.push(u["date"])}const c=Math.max(...l);if(c===0){x(v,true);return}else{x(v,false)}Chart.getChart(v)?.destroy();new Chart(v[0].getContext("2d"),{type:"bar",data:{labels:i,datasets:[{label:t["numberOfReactions"],data:l,borderColor:e,backgroundColor:e,type:"line",yAxisID:"reactions-y"},{label:t["otherTitle"],backgroundColor:v.css("--chart-light-cyan-color"),data:a},{label:t["iosTitle"],backgroundColor:v.css("--chart-light-blue-color"),data:o},{label:t["androidTitle"],backgroundColor:v.css("--chart-blue-color"),data:s},{label:t["macTitle"],backgroundColor:v.css("--chart-dark-blue-color"),data:r},{label:t["windowsTitle"],backgroundColor:v.css("--chart-very-dark-blue-color"),data:n}]},options:{interaction:{mode:"index"},plugins:{"half-doughnut-label":false,revenueIcon:false,hideXAxisIfLabelsOverlaps:false,datalabels:{display:false},legend:{position:"bottom",reverse:true},tooltip:{callbacks:{label:function(e){let t=e.raw;if(e.datasetIndex>0){t+="%"}return`${e.dataset.label}: ${t}`}},itemSort:(e,t)=>t.datasetIndex-e.datasetIndex}},scales:{x:{stacked:true,ticks:{maxRotation:0}},y:{stacked:true,min:0,max:100,ticks:{callback:(e,t,i)=>`${e}%`}},"reactions-y":{type:"linear",position:"right",min:0,max:c}}}})}function S(e){return Math.round(1e3*e)/10}function T(t,i,n){if(t.length<2){return false}const r=2;const s=t.map(e=>n.measureText(e).width);for(let e=1;e<t.length;e++){const o=i[e].x-s[e]/2;const a=i[e-1].x+s[e-1]/2;if(o-r<=a){return true}}return false}function x(e,t){e.toggleClass("hidden",t);e.next().toggleClass("hidden",!t)}});AGN.Lib.Controller.new("email-list-controller",function(){let i="";let n=" ";let r;const s=()=>{let e=[""];const t=$(`input[name="${i}"]`).val();if(t){e=t.split(n)}return e};const e=()=>{const e=r.getJsonData();$(`input[name="${i}"]`).val(e.join(n))};this.addDomInitializer("email-list-initializer",function(){const e=$(this.el);const t=this.config?.disabled;i=e.data("target-field")||"";n=e.data("data-emails-separator")||n;r=AGN.Lib.EmailsListManager.initialize(e,s(),{disabled:t})});this.addAction({click:"delete-email"},function(){r.deleteRow($(this.el));e()});this.addAction({click:"create-email"},function(){r.createRowAfter($(this.el));e()});this.addAction({change:"change-trigger"},function(){e()})});AGN.Lib.Controller.new("company-view",function(){this.addDomInitializer("company-view",function(){e()});this.addAction({click:"create-postal-field"},function(){const e=this.el.attr("href");const t=AGN.Lib.Form.get(this.el);t.jqxhr().done(()=>AGN.Lib.Page.reload(e))});this.addAction({change:"update-policy"},function(){e()});function e(){const e=$("#passwordPolicy").val();$("#password").attr("data-rule",e)}this.addAction({change:"change-password-expire"},function(){this.el.find('[data-default-password-expire-option="false"]').remove()})});AGN.Lib.Controller.new("content-source-list",function(){this.addAction({click:"bulk-delete"},function(){const t=$("[data-bulk-checkbox]:checked").map(function(){const e=$(this);return{id:e.val(),type:e.data("content-source-type")}}).get();i(this.el.attr("href"),t,e=>{AGN.Lib.Confirm.create(e).done(()=>{i(AGN.url("/administration/content-source/bulkDelete.action"),t,e=>{AGN.Lib.Form.get(this.el).updateHtml(e)})})})});function i(e,t,i){$.ajax({url:e,type:"POST",contentType:"application/json",data:JSON.stringify(t),success:e=>i(e)})}});AGN.Lib.Controller.new("content-source-view",function(){const e=AGN.Lib.Select;const r=AGN.Lib.InputTable;const i=AGN.Lib.Helpers;let n;let s;let o=[];let a;let l;let c;let u;let d;this.addDomInitializer("content-source-view",function(){n=AGN.Lib.Form.get($("#content-source-form"));a=$("#resource-type").val();d=$("#urls-table");l=$("#url-settings");c=e.get($("#content-block-name"));u=e.get($("#target-group-select"));s=this.config.htmlSourcesAllowed;o=this.config.availableMailings;h();p()});function h(){const e=d.find('[data-name="url"]');if(a==="HTML"&&s){e.each((e,t)=>g($(t)));$("[data-add-row]").closest("td").show();$('[data-action="configure-url"]').closest("td").show()}else if(a==="XML"){$("[data-add-row]").closest("td").hide();$('[data-action="configure-url"]').closest("td").hide();e.first().attr("data-field","required");n.initFields()}}this.addAction({change:"change-resource-type"},function(){a=this.el.val();h()});function p(){$("#mailing-name").on("change",f);y(d.find("tr:first"))}function f(){const e=o.find(e=>e.name===$(this).val()).blocks.map(e=>({id:e,text:e}));c.setOptions(e)}function g(e){e.closest("td").next().toggleClass("hidden",!$(e).val())}this.addAction({change:"url-input",keyup:"url-input",paste:"url-input"},function(){g(this.el)});this.addAction({click:"configure-url"},function(){if(!n.validate()){return}b();y(this.el.closest("tr"))});function m(e){u.selectValueOrSelectFirst(e.targetGroup)}function v(e){return a!=="XML"&&e.find('[data-name="url"]')?.val()?.trim()?.length>0}function y(e){const i=r.get(d).getRowData(e);l.toggle(v(e));l.data("urlRow",e);$("#url-ph").text(i.url);const n=i.contentBlockName?{id:i.contentBlockName,text:i.contentBlockName}:{id:"",text:t("contentSource.mailingContentSelect")};c.setOptions([n]);m(i)}function b(){const e=l.data("urlRow");e.find('[data-name="contentBlockName"]').val($("#content-block-name").val());e.find('[data-name="targetGroup"]').val($("#target-group-select").val())}function C(t){if(a==="HTML"){for(let e=0;e<t.length;e++){if(t[e].contentBlockName.trim()?.length<=0){y(d.find("tr").eq(e));return n.validate()}}}return true}this.addAction({submission:"content-source-save"},function(){b();const e=r.get(d).collect();if(!C(e)){return}_.each(e,function(e,t){n.setValue("urls["+t+"].url",e.url);n.setValue("urls["+t+"].contentBlockName",e.contentBlockName);n.setValue("urls["+t+"].targetGroup",e.targetGroup||0)});n.submit()});AGN.Lib.Validator.new("content-source-url",{valid:function(e,t){return!this.errors(e,t).length},errors:function(e){if(!e.val()||i.isUrl(e.val())){return[]}return[{field:e,msg:t("url.invalid")}]}})});AGN.Lib.Controller.new("custom-thumbnail-view",function(){this.addAction({change:"use-custom-thumbnail"},function(){$("#customThumbnailFile").prop("name",this.el.is(":checked")?"customThumbnailFile":"")});this.addAction({change:"custom-thumbnail-image"},function(){const t=this.el;const e=t.prop("files");if(e?.length){const i=e[0];if(i.type=="image"||i.type.match("image/.*")){const n=new FileReader;n.onload=e=>{r(t,i.name,e.target.result)};n.readAsDataURL(i)}else{AGN.Lib.Helpers.clearFormField(t);r(t)}}else{r(t)}});this.addAction({click:"delete-custom-thumbnail-image"},function(){const e=this.el.parent().parent().find('input[type="file"]');if(e.prop("files")?.length){AGN.Lib.Helpers.clearFormField(e);r(e)}});function r(e,t="",i=""){let n=e.data("preview-name");if(n){$(n).text(t)}n=e.data("preview-image");if(n){if(i){$(n).prop("src",i)}else{$(n).each(function(){const e=$(this);e.prop("src",e.data("no-preview-src")||"")})}}}});AGN.Lib.Controller.new("dynamic-report",function(){const s=AGN.Lib.DateFormat;let o;let a;this.addDomInitializer("dynamic-report",function(){o=this.config.mailings;a=this.config.clickersGroupsCount;$.i18n.load(this.config.translations);l();r();e();i()});function e(){const e=_.sortBy(o,["ordersCount"]).reverse();const t=o.length?_.sumBy(o,"revenue")/o.length:0;$("#avg-revenue").text(t.toFixed(2)+" ‚Ç¨");if(e.length){$("#best-performing-mailing").text(n(e[0]))}if(e.length>1){$("#worst-performing-mailing").text(n(e[e.length-1]))}}function i(){const e=["ordersCount","revenue","clickers","openers"];const r=e.map(e=>{return _.sortBy(o,[e]).reverse()});const i=_.sortBy(o,n=>{return e.reduce((e,t,i)=>{return e+_.findIndex(r[i],{id:n.id})},0)});$("[data-performance-mailing-info]").each((e,t)=>{if(e<i.length){$(t).text(n(i[e]))}})}function n(e){let t=`${e.shortname} (ID: ${e.id})`;if(e.sendTime){const i=s.format(new Date(e.sendTime),window.adminDateTimeFormat);t+=` (${i})`}return t}function r(){const e=$("#clickers-chart");const i=[e.css("--chart-very-dark-blue-color"),e.css("--chart-dark-blue-color"),e.css("--chart-blue-color"),e.css("--chart-light-blue-color"),e.css("--chart-light-cyan-color"),e.css("--chart-cyan-color")];const n=[`> ${a} ${t("clicks")}`];const r=[_.sumBy(o,"clickersWithMoreThenXClicksCount")];for(let e=a;e>0;e--){n.push(`${e} ${t("clicks")}`);r.push(_.sumBy(o,`clickersByClicksCountMap.${e}`))}new Chart(e[0].getContext("2d"),{type:"agnDoughnut",data:{labels:n,datasets:[{data:r,backgroundColor:i,borderWidth:0}]}})}function l(){const e=c($("[data-days-count]:selected").data("days-count"));const i=_.groupBy(o,e=>{if(e.sendTime){return s.format(new Date(e.sendTime),window.adminDateFormat)}else{return null}});const n=t=>e.map(e=>_.sumBy(i[e]||[],t));const r=$("#mailing-statistics-chart");new Chart(r[0].getContext("2d"),{type:"line",data:{labels:e,datasets:[{label:t("sentMailings"),data:n("sendCount"),borderColor:r.css("--chart-very-dark-blue-color"),backgroundColor:r.css("--chart-very-dark-blue-color"),pointRadius:1},{label:t("openers"),data:n("openersCount"),borderColor:r.css("--chart-light-blue-color"),backgroundColor:r.css("--chart-light-blue-color"),pointRadius:1},{label:t("clickers"),data:n("clickersCount"),borderColor:r.css("--chart-lime-color"),backgroundColor:r.css("--chart-lime-color"),pointRadius:1}]},options:{scales:{x:{ticks:{maxRotation:0}},y:{display:false}},interaction:{mode:"index",intersect:false},stacked:false,plugins:{legend:{position:"bottom"},datalabels:{display:false}}}})}function c(t){const i=[];let n=new Date;for(let e=0;e<t;e++){i.push(s.format(n,window.adminDateFormat));n.setDate(n.getDate()-1)}return i.reverse()}});AGN.Lib.Controller.new("edit-field-content",function(){this.addAction({click:"calculateRecipients"},function(){const t=$("#recipients-count");const e=AGN.Lib.Form.get(this.el);$.ajax({url:AGN.url("/recipient/calculate.action"),data:{targetId:e.getValue("targetId"),mailinglistId:e.getValue("mailinglistId")}}).always(e=>{t.val(e.count||0)}).fail(()=>{t.val("?");AGN.Lib.Messages.defaultError()})})});AGN.Lib.Controller.new("enlarged-content-editor-controller",function(){var i=AGN.Lib.Modal;var n=AGN.Lib.Confirm;var r;this.addDomInitializer("enlarged-content-editor-initializer",function(e){var t=i.get(e);r=t.content;l(t.editorType);s()});function s(){if(a()==="html"){u()}else{d()}}this.addAction({click:"updateContent"},function(){var e=$(this.el);var t=n.get(e);t.positive(o());$("#enlarged_content_modal").modal("toggle")});var o=function(){return{content:e(),editorType:a()}};var e=function(){var e=$("#tab-enlargedContent-wysiwyg");var t=$("#enlargedContentEditor");if(e.is(":visible")){var i=CKEDITOR.instances["enlargedContent"];return i.getData()}if(t.is(":visible")){var n=ace.edit("enlargedContentEditor");return n.getValue()}};var a=function(){var e=$("#tab-enlargedContent-wysiwyg");if(e.is(":visible")){return"wysiwyg"}var t=$("#enlargedContentEditor");if(t.is(":visible")){return"html"}return""};var l=function(e){if(!e||e===""){return}var t=$('[data-toggle-tab$="'+e+'"]');if(t){t.trigger("click")}};const c=function(e){const i=e.val().length;$('[data-enlarged-char-counter-for="'+e.attr("id")+'"]').find("span:first").text(t("fields.content.charactersEntered",i))};this.addAction({"editor:create":"count-enlarged-textarea-chars","editor:change":"count-enlarged-textarea-chars"},function(){c(this.el)});this.addAction({click:"hide-enlarged-char-counter"},function(){d()});this.addAction({click:"show-enlarged-char-counter"},function(){u()});function u(){$("[data-enlarged-char-counter-for]").first().show()}function d(){$("[data-enlarged-char-counter-for]").first().hide()}});AGN.Lib.Controller.new("export-view",function(){let n;let e;let t;this.addDomInitializer("export-view",function(){n=this.config.bounceUserStatusCode;r();t=AGN.Lib.Form.get($("#exportForm"));e=new a($("#custom-column-mappings"));i()});function i(){const e=$("#user-columns").val();const t=e.includes("lastopen_date")||e.includes("lastclick_date");$("#24h-col-info").toggle(t)}this.addAction({click:"save"},o);this.addAction({click:"evaluate"},o);this.addAction({change:"add-bounce-col-to-choose"},r);this.addAction({change:"user-columns-update"},i);function r(){const e=$("#mailing-bounce-column-option");const t=$("#recipient-export-recipientstatus").find(":selected").val();if(t==n){e.removeAttr("disabled")}else{const i=AGN.Lib.Select.get($("#user-columns"));i.unselectValue("mailing_bounce");e.attr("disabled","disabled")}}function s(i){_.each(e.collect(),function(e,t){i.setValue("customColumns["+t+"].dbColumn",e.dbColumn);i.setValue("customColumns["+t+"].defaultValue",e.defaultValue)})}function o(){if(t.valid({})){s(t);t.submit()}else{t.handleErrors()}}class a extends AGN.Lib.InputTable{addEmptyRow(){if(t.valid({})){t.cleanFieldFeedback();super.addEmptyRow()}else{t.handleErrors()}}}});AGN.Lib.Controller.new("facebook-leadads",function(){var i=AGN_FACEBOOK.Login,o=AGN_FACEBOOK.LeadAds,e=AGN_FACEBOOK.SDK,a=AGN.Lib.Select;var l={};this.addDomInitializer("facebook-leadads",function(){l=this.config;AGN.Lib.Storage.delete("fblst_"+l.FACEBOOK_LEADADS_APP_ID);e.load_sdk(l.FACEBOOK_LEADADS_APP_ID,c)});var n=function(e){$("#mailinglistId").prop("disabled",!e)};var r=function(e){$("#doiMailingId").prop("disabled",!e)};var s=function(e){$('[data-action="connect-page"]').prop("disabled",!e)};var c=function(){var e=function(e){var i=function(){AGN.Lib.Messages(t("defaults.error"),t("messages.error.reload"),"alert")};u();o.list_manageable_pages(e,l.URL.LIST_FACEBOOK_PAGE_BINDINGS_AJAX_URL,"#facebook-pages-table",i)};i.attach_login_function(".facebook-login-btn",e,"pages_read_engagement, leads_retrieval");u()};var u=function(){i.doByLoginStatus(h,d)};var d=function(){a.get($("#mailinglistId")).selectFirstValue();n(false);r(false);s(false);$(".facebook-login-btn").removeClass("hidden")};var h=function(e){$(".facebook-login-btn").addClass("hidden");n(true);o.list_manageable_pages(e,l.URL.LIST_FACEBOOK_PAGE_BINDINGS_AJAX_URL,"#facebook-pages-table");$('[data-action="connect-page"]').data("fbAccessToken",e);o.renew_page_access_tokens(e,l.URL.RENEW_FACEBOOK_PAGE_ACCESS_TOKENS_AJAX_URL,function(e){var i=JSON.parse(e);if(i.count>0){AGN.Lib.Messages(t("defaults.success"),t("facebook.leadAds.renewedPageAccessTokens",i.count),"success")}})};this.addAction({change:"mailinglist-change"},function(){s(false);r(false);var e=$(this.el);var t=a.get(e).getSelectedValue();p(t);r(t!==0)});var p=function(e){var i=a.get($('[data-action="doi-mailing-change"]'));i.resetOptions();i.setOptions([{id:0,text:"---"}]);i.selectFirstValue();if(e!==0){r(false);$.ajax({url:l.URL.LIST_ACTIONBASED_AJAX_URL,type:"GET",data:{mailinglist:e},success:function(e){if(e){var t=_.map(e.mailings,function(e){console.log("mailing "+e.id+": "+e.shortname);return{id:e.id,text:e.shortname}});t.unshift({id:0,text:"---"});i.setOptions(t);i.selectFirstValue()}},error:function(e,i,n){console.log("status = "+i+", error = "+n);AGN.Lib.Messages(t("defaults.error"),t("messages.error.reload"),"alert")},statusCode:{500:function(){if(!!onError){onError()}}}})}};this.addAction({change:"doi-mailing-change"},function(){var e=$(this.el);var t=a.get(e).getSelectedValue();s(t>0)});this.addAction({click:"connect-page"},function(){var e=$(this.el);var i=e.data("fbAccessToken");var n=function(){o.list_manageable_pages(i,l.URL.LIST_FACEBOOK_PAGE_BINDINGS_AJAX_URL,"#facebook-pages-table");AGN.Lib.Messages(t("defaults.success"),t("defaults.saved"),"success")};var r=a.get($('[data-action="mailinglist-change"]')).getSelectedValue();var s=a.get($('[data-action="doi-mailing-change"]')).getSelectedValue();o.connect_pages(i,l.URL.CONNECT_FACEBOOK_PAGE_BINDINGS_AJAX_URL,"#facebook-pages-table",r,s,n,null,function(e){if(!!e){e.page_names.forEach(function(e){AGN.Lib.Messages(t("facebook.leadAds.error.already_bound_to_other_company"),e,"alert")})}})})});AGN.Lib.Controller.new("form-trackable-links",function(){this.addAction({submission:"save-all"},function(){const e=AGN.Lib.Form.get($("#userFormTrackableLinksForm"));t(e,"commonExtensions",$("#links-common-extensions"));e.submit()});this.addAction({submission:"save-individual"},function(){const e=AGN.Lib.Form.get($("#userFormTrackableLinkForm"));t(e,"extensions",$("#link-extensions"));e.submit()});function t(i,n,e){const t=e.data("table").collect();_.each(t,function(e,t){i.setValueOnce(n+"["+t+"].name",e.name);i.setValueOnce(n+"["+t+"].value",e.value)})}});AGN.Lib.Controller.new("building-block-view",function(){this.addAction({click:"activate"},function(){e(true,this.el)});this.addAction({click:"deactivate"},function(){e(false,this.el)});function e(t,i){const n=$("[data-building-block-activeness-toggle]");n.addClass("disabled");$.post(i.data("url")).done(e=>{if(e.success){i.toggleClass("hidden",true);n.not(i).toggleClass("hidden",false);r(t);$("#building-block-delete-option").toggleClass("hidden",t)}AGN.Lib.JsonMessages(e.popups);n.removeClass("disabled")})}function r(e){const t=$("[data-building-block-activeness-indicator]");t.addClass("hidden");t.not($(`[data-building-block-activeness-indicator="${!e}"]`)).removeClass("hidden")}});AGN.Lib.Controller.newExtended("grid-building-block-defaults","building-block-view",function(){const c=AGN.Lib.Helpers;const e=AGN.Lib.Confirm;const r=AGN.Lib.Form;let o;this.addDomInitializer("grid-building-block-defaults",function(){o=this.config;$("img[id^=preview]").each(function(){const e=$(this);const t=e.attr("src");if(t){const i=n(t);if(i!==t){e.attr("src",$.trim(i))}}e.parent().removeClass("hidden")});i()});this.addAction({click:"chooseImage"},function(){const e=u(this.el);if(e>0){if(s(e)){$(`#file-${e}`).trigger("click")}else{a(e)}}});this.addAction({change:"chooseImageFile"},function(){const e=u(this.el);if(e>0){l(this.el,e)}});this.addAction({click:"deleteImage"},function(){const e=u(this.el);if(e>0){p(e)}});this.addAction({click:"showMediapoolDialog"},function(){const e=u(this.el);if(e>0){a(e)}});this.addAction({click:"chooseImageLink"},function(){const e=u(this.el);if(e>0){$(`#content-${e}`).trigger("focus")}});this.addAction({change:"previewImageLink",keyup:"previewImageLink",mouseup:"previewImageLink"},function(){const e=u(this.el);if(e>0){h(e,$.trim(this.el.val()))}});this.addAction({click:"save"},function(){f().done(()=>r.get($("#default-content-tile")).submit())});function n(e){return c.replaceAgnTags(e,(e,t)=>{if(e.name==="agnIMAGE"&&e.attributes["name"]){if(!e.attributes["source"]||e.attributes["source"]==="mediapool"||e.attributes["source"]==="mediapoolbg"){return AGN.url(`/mediapool/content/images/${encodeURIComponent(e.attributes["name"])}/raw.action`)}}return t})}function i(){o.placeholders.filter(e=>e.placeholderType===o.CHECK_PLACEHOLDER_TYPE).forEach(e=>{const t=$(`
            <div id="${e.placeholderId}-children" class="bordered-box-sm" data-show-by-checkbox="#content-${e.placeholderId}">
                <div class="row g-2"></div>
            </div>
        `);t.insertAfter($(`#content-${e.placeholderId}`).parent());e.options.split(",").forEach(e=>{t.find("> .row").append($(`.ph-${e}`))})});AGN.Lib.CoreInitializer.run("checkbox-hider",$("#default-content-tile"))}function u(e){var t=e.closest("[data-ph-id]");return t.exists()?parseInt(t.data("ph-id")):0}function s(e){const t=$(`#file-${e}`);return t.exists()?!!t.val():false}function a(t){e.request(AGN.url("/mediapool/image/pick.action")).done(e=>{$(`#content-${t}`).val(e.id);c.clearFormField($(`#file-${t}`));d(t,e.src,e.name,e.title)})}function l(e,t){const i=e.prop("files");const n=$(`#content-${t}`);const r=$(`#image-category-${t}`).parent();if(i?.length){const s=i[0];if(s.type==="image"||s.type.match("image/.*")){const o=new FileReader;o.onload=e=>{r.removeClass("hidden");d(t,e.target.result,s.name,s.name)};o.readAsDataURL(s)}else{r.addClass("hidden");c.clearFormField(e);d(t)}}else{r.addClass("hidden");d(t)}n.val("")}function d(e,t,i,n){const r=$(`#preview-${e}`);const s=$(`#image-name-${e}`);if(r.attr("src")!==t){r.attr("src",t||o.noPreviewImageLink)}r.attr("title",n||"");s.text(i||"")}const h=_.throttle((e,t)=>{const i=$(`#preview-${e}`);if(i.attr("src")!==t){if(t){i.attr("src",$.trim(n(t)))}else{i.attr("src",t||o.noPreviewImageLink)}}},300);function p(e){c.clearFormField($(`#file-${e}`));$(`#image-name-${e}`).text("");$(`#content-${e}`).val("");$(`#preview-${e}`).attr("src",o.noPreviewImageLink)}function f(){const i=$.Deferred();const o=[];const a=r.get($("#default-content-tile"));let l=true;a.get$().find("input[type=file]").each(function(){const e=$(this);const i=u(e);const n=$(`#image-category-${i}`);const r=e.prop("files");if(r?.length){const s=n.val();if(s>0){o.push({placeholderId:i,image:r[0],categoryId:s});a.cleanFieldFeedback(n)}else{l=false;a.showFieldError$(n,t("error.grid.noCategorySelected"))}}else{a.cleanFieldFeedback(n)}});if(l){if(o.length){const n=new FormData;o.forEach((e,t)=>{n.append(`images[${t}].file`,e.image);n.append(`images[${t}].fileName`,e.image.name);n.append(`images[${t}].title`,e.image.name);n.append(`images[${t}].categoryId`,e.categoryId)});$.ajax(AGN.url("/mediapool/images/uploadAjax.action"),{type:"POST",dataType:"json",enctype:"multipart/form-data",processData:false,contentType:false,data:n}).done(e=>{if(e.success===true){e.data.forEach((e,t)=>{const i=o[t].placeholderId;$(`#content-${i}`).val(e);c.clearFormField($(`#file-${i}`))});i.resolve()}else{AGN.Lib.JsonMessages(e.popups);i.reject()}}).fail(()=>i.reject())}else{i.resolve()}}else{i.reject()}return i.promise()}});AGN.Lib.Controller.newExtended("building-blocks-overview","activeness-overview",function(){this.addDomInitializer("building-blocks-overview",function(){if(location.hash){const e=parseInt(location.hash.substr(1));if(e>0){const t=$(`[data-bulk-checkbox][value="${e}"]`).closest("tr");i(t.position().top-t.height())}}});function i(e){$(".table-wrapper__body").scrollTop(e)}});AGN.Lib.Controller.new("grid-edit",function(){const o=AGN.Lib.Template;let e;let t;this.addDomInitializer("grid-edit",function(){e=this.config;t=AGN.Lib.Form.get($("#gridForm"));n()});this.addAction({submission:"createTemplate"},function(){$("#templateCreationForm").submit()});this.addAction({submission:"saveGrid"},function(){t.submit()});this.addAction({change:"updateColnum"},function(){i(this.el,1,e.maxColumnsCount);h("columnWidth").val(r());n()});this.addAction({change:"updateTemplateWidth"},function(){i(this.el,50,2e3);h("columnWidth").val(r());n()});this.addAction({change:"updateColumnWidth"},function(){i(this.el,10,2e3);h("templateWidth").val(s());n()});this.addAction({change:"updateGutterWidth"},function(){i(this.el,0,500);h("columnWidth").val(r());n()});this.addAction({click:"enableEditing"},function(){$(this.el).prop("disabled",true);h("gridName").prop("disabled",false);if(!e.isGridInUse){$.each(["columnNum","columnWidth","gutter","templateWidth"],(e,t)=>{h(t).prop("disabled",false)})}$("#createTemplateButton").addClass("hidden");$("#saveAndCreateTemplateButton").removeClass("hidden");t.get$().attr("data-action","saveGrid")});function i(e,t,i){const n=parseInt(e.val());if(n!=e.val()||n<t){e.val(t)}if(n>i){e.val(i)}}function n(){const t=l();const i=a();const n=c();const r=$("#grid-preview-block");r.html(o.text("lb-grid-columns-preview",{columnsCount:i,columnWidth:t,gutter:n}));for(let e=0;e<i;e++){const s=e+1;r.append(o.text("lb-grid-row-preview",{columnsCount:i,firstBlockWidth:s,columnWidth:t,gutter:n,percent:Math.floor(s*100/i)}))}}function r(){return Math.floor(u()/a()-c())}function s(){return Math.ceil((l()+c())*a())}function a(){return d("columnNum")}function l(){return d("columnWidth")}function c(){return d("gutter")}function u(){return d("templateWidth")}function d(e){return parseInt(h(e).val())}function h(e){return t.get$().find(`[name='${e}']`)}});AGN.Lib.Controller.newExtended("grid-outer-template","grid-template-base",function(){this.addAction({click:"update-preview"},function(){const e=AGN.Lib.Form.get(this.el);e.setValue("outerHtml",$("#templateOuterHTML").val());e.submit()})});AGN.Lib.Controller.new("grid-overview",function(){this.addAction({submission:"createNewGrid"},function(){const i=AGN.Lib.Form.get(this.el);const e=i.getValue("newGridName");$.get(AGN.url("/layoutbuilder/grid/checkName.action"),{name:e}).done(e=>{if(e.used){i.showFieldError("newGridName",t("fields.name.errors.name_in_use"))}else{i.submit().done(()=>{AGN.Lib.Modal.getInstance(i.get$()).hide()})}})})});AGN.Lib.Controller.new("grid-template-base",function(){const e=AGN.Lib.LB.Definitions;const i=AGN.Lib.LB.Ui;this.addAction({click:"toggle-released"},function(){if(e.EDITOR&&!e.EDITOR.isEditable()){return}const t=$("[data-template-released-toggle]");t.addClass("disabled");$.post(this.el.data("url")).done(e=>{if(e.success){i.setShown(this.el,false);i.setShown(t.not(this.el),true)}AGN.Lib.JsonMessages(e.popups);t.removeClass("disabled")})})});AGN.Lib.Controller.newExtended("grid-template-css","grid-template-base",function(){let i=[];let n=[];let r;let t;this.addDomInitializer("grid-template-css",function(){i=this.config.previewWidths;n=this.config.previewMediaQueries;t=AGN.Lib.Form.get($("#layoutPreviewForm"));r=$('[name="previewSize"]');AGN.Lib.Storage.restoreChosenFields(r);e()});this.addAction({change:"update-css-preview",click:"refresh-preview"},function(){AGN.Lib.Storage.saveChosenFields(r);t.setValue("css",$("#cssContents").val());e()});function e(){const e=parseInt(r.val());s(e);o(e);t.submit()}function s(e){const t=AGN.Lib.Template.dom("template-css-iframe",{previewWidth:i[e],mediaQuery:n[e]});r.closest(".tile").find(".tile-body").html(t);AGN.Lib.CoreInitializer.run("iframe")}function o(e){if(t.getValue("previewSize")===undefined){t.setValueOnce("previewSize",e)}else{t.setValue("previewSize",e)}}});AGN.Lib.Controller.newExtended("grid-template-settings","grid-template-base",function(){this.addAction({submission:"save"},function(){const e=AGN.Lib.Form.get(this.el);t(e);e.submit()});function t(i){const e=$("#mailingParamsTable");if(!e.exists()){return}_.each(e.data("table").collect(),(e,t)=>{i.setValueOnce(`settings.parameters[${t}].name`,e.name);i.setValueOnce(`settings.parameters[${t}].value`,e.value);i.setValueOnce(`settings.parameters[${t}].description`,e.description)})}});AGN.Lib.Controller.newExtended("grid-template-styles","grid-template-base",function(){this.addAction({click:"update-preview"},function(){const t=AGN.Lib.Form.get(this.el);$("#styles-tile").find('input[name^="styles["]').each(function(){const e=$(this);t.setValue(e.attr("name"),e.val())});t.submit()})});AGN.Lib.Controller.new("img-editor",function(){const n=AGN.Lib.Form;let i,r;let s=0,o=0;let e;let a;let l;let c;this.addDomInitializer("img-editor",function(){l=document.getElementById("editor-canvas");c=l.getContext("2d");e=$("#editor-img").attr("src");t();k().prop("disabled",true)});function t(){a=new Image;a.src=$("#editor-img").attr("src");a.onload=function(){l.width=a.width;l.height=a.height;c.drawImage(a,0,0);R();u();d();P()}}function u(e,t){const i=t?.size?.width||l.width;const n=t?.size?.height||l.height;A().val(Math.round(i));_().val(Math.round(n))}function d(){$("#img-percent").val(100)}this.addAction({click:"crop"},async function(){w("crop");if(!T()){D();return}await h()});async function h(){if(s<=1||o<=1){return}const e=function(e,t){e.width=s;e.height=o;t.drawImage(a,i,r,s,o,0,0,s,o)};await f(e);D()}this.addAction({click:"resize"},async function(){await h();w("resize");N()});async function p(e,i){const t=function(e,t){e.width=i.size.width;e.height=i.size.height;t.drawImage(a,0,0,i.size.width,i.size.height)};await f(t)}async function f(e){await g();const t=document.createElement("canvas");const i=t.getContext("2d");e(t,i);l.width=t.width;l.height=t.height;c.clearRect(0,0,l.width,l.height);c.drawImage(t,0,0);await g();d()}async function g(t){await new Promise(e=>{a.src=l.toDataURL();if(!t){k().prop("disabled",false)}a.onload=e})}this.addAction({click:"rotate-clockwise"},m);async function m(){await y(false)}this.addAction({click:"rotate-counterclockwise"},v);async function v(){await y(true)}async function y(i){w();const e=function(e,t){e.width=l.height;e.height=l.width;t.translate(e.width/2,e.height/2);t.rotate((i?-1:1)*Math.PI/2);t.drawImage(a,-a.width/2,-a.height/2)};await f(e);P()}this.addAction({click:"flip-horizontally"},b);async function b(){await C(false)}this.addAction({click:"flip-vertically"},L);async function L(){await C(true)}async function C(e){await g();w();c.clearRect(0,0,l.width,l.height);c.save();if(e){c.scale(1,-1);c.drawImage(a,0,-l.height)}else{c.scale(-1,1);c.drawImage(a,-l.width,0)}c.restore();d();await g()}function w(e){if(e!=="crop"){H()}if(e!=="resize"){B()}}this.addAction({input:"change-size"},()=>E());this.addAction({input:"change-size-via-percentage"},()=>E(true));function _(){return $("#img-height")}function A(){return $("#img-width")}function E(e){w();let{newWidth:t,newHeight:i}=e?G():F();l.width=t;l.height=i;c.save();c.drawImage(a,0,0,t,i);c.restore();_().val(i);A().val(t);P();k().prop("disabled",false)}function F(){const e=a.width;const t=a.height;let i=A().val();let n=_().val();if(M()){if($("#img-width").is(":focus")){const r=i/e;n=Math.round(r*t)}else if($("#img-height").is(":focus")){const r=n/t;i=Math.round(r*e)}}return{newWidth:i,newHeight:n}}function G(){const e=$("#img-percent").val();const t=a.width;const i=a.height;const n=Math.round(t*(e/100));const r=Math.round(i*(e/100));return{newWidth:n,newHeight:r}}function S(e,t){$(`[data-action="${e}"]`).toggleClass("active",t)}function H(){D(false)}function T(){return!!x()}function x(){return $("#editor-canvas").data("Jcrop")}function D(e){if(e===undefined){e=!T()}if(!e){W()}else{z()}S("crop",e)}function R(){if(O().resizable("instance")){O().resizable("destroy")}O().resizable({handles:"ne, se, sw, nw, w, n, e, s",stop:p,resize:u,disabled:true})}function B(){N(false)}this.addAction({change:"lock-proportions"},async function(){let e=M();S("lock-proportions",e);O().resizable("option","aspectRatio",e)});function M(){return $('[data-action="lock-proportions"]').prop("checked")}function N(e){if(e===undefined){e=V()}O().resizable(e?"enable":"disable");S("resize",e)}function O(){return $("#editor-canvas")}function V(){const e=O();return e.resizable("instance")&&e.resizable("option","disabled")}function W(){const e=x();if(typeof e!="undefined"){e.destroy();R();P()}s=0;o=0}function z(){O().Jcrop({onChange:I,onSelect:I,setSelect:[0,0,l.width,l.height]})}function I(e){i=e.x;r=e.y;s=e.w;o=e.h}function P(){const e=O();const t=$(".ui-wrapper");e.css("width",l.width);e.css("height",l.height);t.css("width",l.width);t.css("height",l.height);u()}function k(){return $('[name="encodedFile"]')}this.addAction({click:"save"},async function(){await h();await g(true);const e=k();let t=l.toDataURL();const i=t.indexOf(",");if(i>=0){t=t.substring(i+1)}if(e.val()!=t){e.val(t)}n.get(this.el).submit()});this.addAction({"upload:add":"replace"},function(){w();const e=new FileReader;e.readAsDataURL(this.data.file);e.onload=function(e){$("#editor-img").attr("src",e.target.result);t();k().prop("disabled",false)}});this.addAction({click:"reset"},function(){w();$("#editor-img").attr("src",e);t();k().prop("disabled",true)})});AGN.Lib.Controller.new("import-profile",function(){const s=AGN.Lib.Template;const i=AGN.Lib.Modal;const n=AGN.Lib.Messages;const r=AGN.Lib.Form;const a=AGN.Lib.Select;const o=AGN.Lib.CoreInitializer;const l="agn:db-column";let c;let u;let d;let h;let e;let p;let f;let g;this.addDomInitializer("import-profile-view",function(){c=v().prop("disabled");d=this.config.availableGenderIntValues;j(z(this.config.genderMappings));m()});this.addAction({click:"save"},function(){if(b(C(y()))){const e=r.get(this.el);G(e);U(e);e.submit()}});this.addAction({change:"change-new-recipients-action"},function(){m()});this.addAction({change:"allMailinglists-toggle"},function(){m()});this.addAction({change:"change-mode"},function(){const e=$("#allMalinglistsCheckbox");if(!e.exists()){return}if(!e.parent().is(":visible")){e.prop("checked",false).trigger("change")}});function m(){const e=$("#import_actionnewrecipients");const t=$("#allMalinglistsCheckbox");const i=e.exists()&&e.val()>0;const n=t.exists()&&t.is(":checked");const r=i||c||n;const s=a.get(v());s.toggleDisabled(r);if(r){s.clear()}if(t.exists()){const o=i||c;t.prop("disabled",o);t.parent().toggleClass("hidden",o)}}function v(){return $("#recipient-mailinglists")}function G(i){_.each(H(),(e,t)=>{i.setValue(`genderMapping[${t}]`,e)})}function H(){const r={};_.each(u.find("[data-gender-settings-row]"),e=>{const t=$(e);const i=w(t);const n=B(t);if(i.length){r[n]=!r.hasOwnProperty(n)?i:r[n]+", "+i}});return r}function B(e){const t=e.find("[data-gender-int-value]");return t.is("select")?t.val():t.text()[0]}this.addAction({click:"delete-gender-mapping"},function(){const e=this.el.closest("[data-gender-settings-row]");if(e.is(":first-child")){const t=e.next("[data-gender-settings-row]");t.find(".form-label").removeClass("hidden")}e.remove()});this.addAction({click:"add-gender-mapping",enterdown:"gender-enterdown"},function(){this.event.preventDefault();if(V()){W();A("","");y().find("[data-gender-text-value]").focus()}});function V(){const e=C(y());if(e.size<1){n.alert("import.gender.error.empty");return false}return b(e)}function y(){return u.find("[data-gender-settings-row]:last-child")}function b(t){const i=u.find("[data-gender-settings-row]").toArray();for(let e=0;e<i.length-1;e++){if(_.intersection(Array.from(t),Array.from(C($(i[e])))).length){n.alert("import.gender.error.duplicate");return false}}return true}function C(e){const t=w(e);const i=t.length?t.split(","):[];return new Set(_.without(_.map(i,_.trim),""))}function w(e){const t=e.find("[data-gender-text-value]");if(t.is("input")){return t.val().trim()}return t.text().trim()}function W(){const e=u.find('[data-action="add-gender-mapping"]');e.after(`
        <a href='#' class='btn btn-danger btn-icon' data-action='delete-gender-mapping'>
            <i class='icon icon-trash-alt'></i>
        </a>
    `);e.remove()}const z=t=>{if(!t){t=""}const e=Object.keys(t).map(e=>[e,t[e]]);e.sort((e,t)=>e[1]-t[1]);return e};function j(e){u=$("#gender-mappings-block");_.each(e,e=>{A(e[0],e[1])});A("","")}function A(e,i){const n=u.find("[data-gender-settings-row]").length;const r=_.map(d,e=>({value:e,selected:i==e,title:t(`import.gender.short.${e}`)}));u.append(s.text("gender-settings-table-row",{intValue:i,textValues:e,mappingsCount:n,genders:r}));o.run("select",u.find("[data-gender-int-value]:last-child"))}let E;function U(i){if(T()){return}_.each(D(true),(e,t)=>{i.setValueOnce("columnsMappings["+t+"].id",e.id);i.setValueOnce("columnsMappings["+t+"].fileColumn",e.fileColumn);i.setValueOnce("columnsMappings["+t+"].databaseColumn",e.databaseColumn);i.setValueOnce("columnsMappings["+t+"].mandatory",e.mandatory);i.setValueOnce("columnsMappings["+t+"].encrypted",e.encrypted);i.setValueOnce("columnsMappings["+t+"].defaultValue",e.defaultValue)})}this.addAction({change:"change-auto-mapping"},function(){S()});this.addDomInitializer("import-profile-mappings",function(){E=this.config;if(E){e=E.columnMappings;h=E.doNotImportValue;p=E.columns;g=$("#column-mappings-block");I(e);S()}});function S(){const e=$("#manage-fields-tile");const t=T();e.find(".tile-controls").toggleClass("hidden",t);$("[data-mapping-db-column]").prop("disabled",t);$("[data-mappings-actions]").toggleClass("hidden",t);$("#upload-mappings-btn").prop("disabled",t);$("#uploadFile").prop("disabled",t)}function T(){return $("#import_automapping").is(":checked")}this.addAction({click:"upload-column-mappings"},function(){const e=r.get(this.el);$.ajax(AGN.url("/import-profile/mappings/read.action"),{type:"POST",dataType:"json",enctype:"multipart/form-data",processData:false,contentType:false,data:e.data()}).done(e=>{if(e.success===true){I(Y(e.data))}else{AGN.Lib.JsonMessages(e.popups)}})});function Y(e){const i=D();const t=i.filter(e=>!e.fileColumn);const n=e.map(t=>{const e=i.find(e=>e.fileColumn===t.fileColumn);return e!==undefined?e:t});return[].concat(n,t)}this.addAction({click:"bulk-mappings-delete"},function(){_.each($("[data-mapping-checkbox]:checked"),e=>M($(e)));R()});this.addAction({change:"change-database-column"},function(){const e=this.el.data(l);const t=this.el.val();N(e);L(t);this.el.data(l,t);if(this.el.closest("[data-mapping-row]").is("[data-mapping-new]")){q(t)}});this.addAction({change:"set-today-date"},function(){$("#dateInput").toggleClass("hidden",this.el.is(":checked"));$("#daysInput").toggleClass("hidden",!this.el.is(":checked"));const r=$("#daysCount");r.on("change.offset keyup.offset",function(e){const t=r.val();if(t){const i=parseInt(t);if(!isNaN(i)){const n=(i<0?"":"+")+i;if(n!=t){r.val(n)}}else{r.val(t.replace(/[^\d+-]/g,""))}}else if(e.type==="change"){r.val("+0")}})});function q(e){if(!g.parents("table").exists()){return}const t=Q(e);const i=g.find("[data-mapping-defaultValue]").last();const n=i.val();const r=i.closest("td");if(r.children().first().data("type")!==t){r.empty();r.append(X(t,n));K(r,t)}}function K(e,t){if(t==="date"){AGN.runAll(e)}else if(t==="datetime"){_.each(e.find("[data-field]"),function(e){AGN.Lib.Field.create($(e))})}}function X(e,t){switch(e){case"date":case"datetime":return s.text("date-def-val-input",{withTime:e==="datetime",val:t});default:return s.text("text-def-val-input")}}function Q(e){const t=p[e].simpleDataType.toLowerCase();switch(t){case"date":case"datetime":return t;default:return"text"}}this.addAction({click:"show-column-mappings"},function(){const e=D();const t=i.fromTemplate("column-mappings-modal");t.on("modal:close",()=>{g=$("#column-mappings-block");f=s.prepare("column-mapping-row")});g=$("#extended-column-mappings-block");I(e,true);o.run("table",g.closest("table"))});this.addAction({click:"save-extended-mappings"},function(){if(!x(this.el)){return}const e=D(true);g=$("#column-mappings-block");I(e);i.getInstance(this.el).hide()});this.addAction({click:"add-column-mapping"},function(){if(this.el.closest("table").exists()&&!x(this.el)){return}const e=this.el.closest("[data-mapping-row]");const i=J(e);if(Z(i)){n.alert(t("export.columnMapping.error.duplicate"));return}e.remove();i.index=ie()+1;F(i);P();k()});function x(e){const t=r.get(e);t.validatorOptions={$mappingsBlock:g};if(!t.valid()){t.handleErrors();return false}t.cleanFieldFeedback();return true}function Z(t){if(t.databaseColumn===h){return false}const e=D();return e.some(e=>{return e.fileColumn===t.databaseColumn||e.databaseColumn===t.databaseColumn})}function D(e=false){if(!g||!g.exists()){return[]}const t=_.map(g.find("[data-mapping-row]"),function(e){const t=$(e);return{id:O(t,"id"),fileColumn:O(t,"fileColumn"),databaseColumn:O(t,"db-column"),mandatory:O(t,"mandatory"),encrypted:O(t,"encrypted"),defaultValue:O(t,"defaultValue")}});const i=t[t.length-1];if(!e||h===i.databaseColumn){t.pop()}return t}function J(e){const t=e.find("[data-mapping-mandatory]");const i=e.find("[data-mapping-encrypted]");return{id:0,fileColumn:"",databaseColumn:e.find("[data-mapping-db-column]").val(),mandatory:t.exists()?t.is(":checked"):false,encrypted:i.exists()?i.is(":checked"):false,defaultValue:ee(e)}}function ee(e){if(e.find("[data-action=set-today-date]").is(":checked")){const t=parseInt($("#daysCount").val()||0);const i=t===0?"":t>0?`+${t}`:t;return`CURRENT_TIMESTAMP${i}`}return e.find("[data-mapping-defaultValue]").val()}this.addAction({click:"delete-column-mapping"},function(){M(this.el);R()});function R(){$(".table-wrapper").trigger("table:updateBulkActions")}function M(e){const t=e.closest("[data-mapping-row]");const i=O(t,"db-column");if(t.is(":first-child")){const n=t.next("[data-mapping-row]");n.find(".form-label").removeClass("hidden")}t.remove();N(i)}function N(t){if(t&&t!==h){_.each(g.find("[data-mapping-db-column]"),e=>{te($(e),t)})}}function te(e,t){if(e.val()!==t){a.get(e).addOption(t)}}function O(e,t){const i=e.find(`[data-mapping-${t}]`);if(i.is(":checkbox")){return i.is(":checked")}return i.val()}function I(t,e=false){if(!g.exists()){return}g.empty();f=s.prepare(e?"column-mapping-row-extended":"column-mapping-row");for(let e=0;e<t.length;e++){const i=t[e];i.index=e;F(i)}P();k();g.find("[data-mapping-db-column]").each(function(){const e=$(this);e.data(l,e.val())})}function P(){F({index:-1,id:0,fileColumn:"",databaseColumn:"",mandatory:false,encrypted:false,defaultValue:""})}function k(){g.find("[data-mapping-db-column]").each(function(){L($(this).val())})}function L(t){g.find("[data-mapping-db-column]").each(function(){const e=$(this);if(e.val()!==t&&t!==h){e.find(`[value="${t}"]`).remove()}})}function ie(){return $("[data-mapping-row]").last().data("mapping-row")}function F(e){e.isFirstMapping=g.find("[data-mapping-row]").length==0;const t=$(f(e));g.append(t);AGN.runAll(t)}});AGN.Lib.Controller.newExtended("layout-builder","grid-template-base",function(){const e=AGN.Lib.Action;const s=AGN.Lib.EndlessScroll;const o=AGN.Lib.LB.Definitions;const n=AGN.Lib.LB.ChildEditor;const r=AGN.Lib.LB.Child;const a=AGN.Lib.LB.ChildSample;const l=AGN.Lib.LB.Ui;let c;let u;let i="";window.onbeforeunload=function(e){const i=t("grid.layout.leaveQuestion");e=e||window.event;if(u&&u.isChanged()){if(e){e.returnValue=i}return i}AGN.Lib.Loader.show()};this.addDomInitializer("agn-tags-resolver",function(){o.AGN_TAGS_CONFIG=this.config});this.addDomInitializer("layout-builder",function(){c=$("#grid-components-tab");if(!u){u=new AGN.Lib.LB.Editor;o.EDITOR=u}const i=this.config;i.serverSideUndoAvailable=p().exists();o.IS_BASIC_LB=i.IS_BASIC_LB;const e=function(e){const t=$.extend(i,{children:e.children});d(t);u.setChanged(true)};const t=AGN.Lib.AutoSave.initialize(`template-components/${i.templateId}`,_.bind(u.getDataForAutoSave,u),_.bind(u.checkIfDataRestoreNeeded,u),e,0);t.fail(()=>d(i));u.controlRssBtn();$(document).on("tile:show",function(e){const t=n.get();if(!t){return}const i=$(e.target);if(t.get$().find(i).exists()){t.notifyTabChanged(i)}})});function d(e){u.setup(e);new AGN.Lib.EndlessScroll(c,AGN.url(`/layoutbuilder/template/${u.getTemplateId()}/activeBuildingBlocks.action`),{loader:"#building-blocks-loader",onLoad:e=>{h(e);m()}})}function h(e,i=true){e.each(function(){const e=$(this);const t=e.find("[data-div-cache]");if(i){r.set(e,new a(t.json()))}else{r.set(e,new r(t.json()))}if(u.isEditable()){e.draggable(a.draggableOptions())}t.remove()})}this.addAction({click:"update-available-blocks"},function(){const e=this.el.attr("href");$.get(e).done(e=>{AGN.Lib.Confirm.create(e).done(()=>{s.get(c).load()})})});this.addAction({click:"undo"},()=>{if(!u.undo()){p().trigger("click")}});this.addAction({click:"redo"},()=>u.redo());function p(){return $("#server-undo-option")}this.addAction({change:"visibleTargets"},function(){if(u.isEditable()){u.setTargetId(parseInt(this.el.val()))}});this.addAction({"select2:open":"visibleTargets"},function(){if(!u.isEditable()){return}setTimeout(()=>f(this.el),0)});function f(e){const s=e.data("select2");const i=s.dropdown.$dropdown;const t=i.find(".select2-results__options");const n=i.css("min-width");const r=i.outerWidth();i.find(".select2-results__option").each(function(){const e=$(this);if(s.dataAdapter.item(e).id>o.ALL_RECIPIENTS){e.addClass("sortable")}});t.sortable({items:".select2-results__option.sortable",containment:"parent",tolerance:"pointer",distance:5,opacity:.4,cursor:"move",start:function(e,t){i.css("min-width",r);t.item.removeClass("select2-results__option--selectable")},stop:function(e,t){i.css("min-width",n);t.item.addClass("select2-results__option--selectable")},update:function(e,t){const i=g(s,t.item);const n=t.item.prev();const r=t.item.next();if(n.exists()){g(s,n).after(i)}else if(r.exists()){g(s,r).before(i)}u.setLayeringByTargets(l.getAvailableTargetIds())}})}function g(e,t){return $(e.dataAdapter.item(t).element)}this.addAction({"select2-close":"visibleTargets"},function(){if(!u.isEditable()){return}this.el.data("select2").dropdown.$dropdown.find(".select2-results__options").sortable("destroy")});this.addAction({click:"clear-recycle-bin"},function(){if(!u.isEditable()){return}const e=u.getRecycledChildren();if(e.length){$.ajax(this.el.attr("href"),{method:"POST",traditional:true,data:{children:e}}).done(e=>{if(e.success){u.clearRecycleBin()}})}else{u.clearRecycleBin()}});this.addAction({click:"deleteRow"},function(){if(u.isEditable()){u.removeRow(AGN.Lib.LB.Row.get(this.el));m()}});this.addAction({click:"clone"},function(){if(u.isEditable()){const e=r.get(this.el);if(e){u.cloneChild(e)}}});this.addAction({click:"remove"},function(){if(u.isEditable()){const e=r.get(this.el);if(e){u.removeChild(e);m()}}});this.addAction({change:"previewImageSrc",keyup:"previewImageSrc",mouseup:"previewImageSrc"},function(){if(u.isEditable()){n.get().updateImageSrc(this.el)}});this.addAction({change:"chooseImageFile"},function(){if(u.isEditable()){n.get().updateImage(this.el,false)}});this.addAction({change:"changeImageCategory"},function(){if(u.isEditable()){const e=this.el.data("placeholder-id");n.get().syncImageCategories(e,this.el.val());n.get().updateCategory(e)}});this.addAction({change:"chooseMobileImageFile"},function(){if(u.isEditable()){n.get().updateImage(this.el,true)}});this.addAction({click:"chooseImage"},function(){if(u.isEditable()){const e=this.el.data("placeholder-id");n.get().chooseImage(e)}});this.addAction({click:"deleteImage"},function(){if(u.isEditable()){const e=this.el.data("placeholder-id");n.get().deleteImage(e,false)}});this.addAction({click:"deleteMobileImage"},function(){if(u.isEditable()){const e=this.el.data("placeholder-id");n.get().deleteImage(e,true)}});this.addAction({click:"showMediapoolDialog"},function(){if(u.isEditable()){const e=this.el.data("placeholder-id");n.get().showMediapoolDialog(e)}});this.addAction({change:"set-toc-item"},function(){if(u.isEditable()){n.get().setTocItem(this.el.is(":checked"))}});this.addAction({change:"use-toc-item"},function(){if(u.isEditable()){n.get().updateToC()}});this.addAction({change:"child-target-change"},function(){if(u.isEditable()){n.get().updateChildTarget(parseInt(this.el.val()))}});this.addAction({change:"change-interest-group"},function(){if(u.isEditable()){n.get().updateChildInterestGroup()}});this.addAction({change:"savePlaceholder",enterdown:"savePlaceholder"},function(){if(u.isEditable()){n.get().savePlaceholder(this.el.data("ph-id"))}if(this.event.type==="enterdown"){this.event.preventDefault()}});this.addAction({"ckeditor-save":"save-text-ph"},function(){if(u.isEditable()){n.get().savePlaceholder(this.el.data("ph-id"))}});this.addAction({change:"changeContentPool"},function(){const e=$("#grid-contentpool-tab");const t=e.find("[data-no-found-blocks-msg]");const i=parseInt(this.el.val());if(i>0){const n=s.get(e);const r=AGN.url(`/mailing/${i}/buildingBlocks.action`);if(n){n.load(r)}else{new s(e,r,{loader:"#building-blocks-loader",onLoad:e=>{h(e,false);m()}})}}else{e.find(".lb-building-blocks").empty()}l.setShown(t,i===0)});this.addAction({keyup:"search-building-blocks"},function(){i=this.el.val().toLowerCase();m()});function m(){const e=$("#building-blocks-tile");e.find("[data-building-block]").each(function(){const e=$(this);const t=e.find("[data-building-block-name]").text();e.toggleClass("hidden",!t.toLowerCase().includes(i))});e.find(".tile-body").each(function(){const e=$(this);const t=e.find("[data-building-block]:not(.hidden)").length>0;e.find("[data-no-found-blocks-msg]").toggleClass("hidden",t);if(i.length>0){e.scrollTop(0)}})}this.addAction({submission:"save-content"},function(){if(u.isEditable()){let e=false;if(u.isTextVersionGenerationAllowed()){const t=$("#update-text-version:checked");e=t.length>0}u.saveMadeChoice(e);u.save(e)}});this.addAction({click:"import-from-content-source"},function(){(new AGN.Lib.LB.RssImporter).import()});e.new({"form:loadershow":"form"},function(){l.setLoading(true)});e.new({"form:loaderhide":"form"},function(){l.setLoading(false)})});AGN.Lib.Controller.newExtended("lb-template-list","activeness-overview",function(){this.addAction({submission:"grid-template-validation"},function(){const i=AGN.Lib.Form.get(this.el);const e=$("#newTemplateName").val();if(e===""){i.showFieldError("newTemplateName",t("fields.required.errors.missing"));return}$.get(AGN.url("/layoutbuilder/template/validateTemplateName.action"),{newTemplateName:e}).done(e=>{if(e.newTemplateName===false){i.showFieldError("templateName",t("fields.name.errors.name_in_use"))}else{i.submit("static")}})})});AGN.Lib.Controller.new("login",function(){const r=30;const i="login-page";const n=AGN.Lib.Storage;const e=AGN.Lib.Messages;const s=AGN.Lib.Form;this.addDomInitializer("login",function(){if(this.config.SHOW_TAB_HINT===true&&l()){e(t("defaults.info"),t("logon.info.multiple_tabs"),"info",c,false)}if(this.config.logoutMsg){e.infoText(this.config.logoutMsg)}});function o(){return n.get(i)||{}}function a(e){n.set(i,e)}function l(){const e=o();if(e?.notificationDismissExpiration){return e.notificationDismissExpiration<=Date.now()}const t=localStorage.getItem("closedDate");if(t){const i=new Date;const n=new Date(t);n.setDate(n.getDate()+r);return i-n>0}return true}function c(){const e=o();const t=new Date;t.setDate(t.getDate()+r);e.notificationDismissExpiration=t.getTime();a(e)}function u(){return o().isFrameShown==false}this.addAction({keydown:"password-change"},function(){if(d(this.event)){s.showFieldError$(this.el,t("login.error.capslock"))}});this.addAction({keyup:"password-change"},function(){if(!d(this.event)){s.get(this.el).cleanFieldFeedback(this.el)}});function d(e){const t=e.originalEvent;return t.getModifierState&&t.getModifierState("CapsLock")}this.addAction({click:"showPasswordChangeForm"},function(){$("#suggestion-view").addClass("hidden");$("#submission-view").removeClass("hidden")})});AGN.Lib.Controller.new("mailing-upload-attachment",function(){this.addAction({change:"change-attachment-file"},function(){e(false)});this.addAction({change:"change-upload-file"},function(){e(true)});this.addAction({change:"use-pdf"},function(){e(this.el.is(":checked"))});function e(e){let t="";if(e){t=AGN.Lib.Select.get($("#pdfUploadId")).getSelectedText()}else{const i=$("#attachmentFile").prop("files");if(i&&i.length){t=i[0].name}}$("#attachmentName").val(t)}});AGN.Lib.Controller.new("mailing-content-controller",function(){const i=t("defaults.leaveQuestion");const n=AGN.Lib.Template;const r=AGN.Lib.Messages;const e=AGN.Lib.AutoSave;const s=AGN.Lib.Storage;const o=AGN.Lib.Select;const a=AGN.Lib.Form;let l;let c;let u;let d;this.addDomInitializer("mailing-content-initializer",function(){c=this.config;u=$("#dyn-tag-settings");l=new x(c.dynTags,c.targetGroupList,c.interestGroupList);T();e.initialize(`mailing/${c.mailingId}/content-blocks`,h,f,p);b($(".dyn-tag:first").data("dyn-tag-id"))});this.addDomInitializer("gridTemplate-textContent-initializer",function(){c=this.config;u=$("#dyn-tag-settings");c.isEditableMailing=true;l=new x(this.config.dynTags,this.config.targetGroupList,[],[]);b($(".dyn-tag:first").data("dyn-tag-id"))});function h(){y();return l.dynTags.filter(e=>e.modified).map(e=>e.lightWeight)}function p(e){e.forEach(e=>{const t=l.getDynTagById(e.id);t.interestGroup=e.interestGroup;t.contentBlocks=e.contentBlocks.map(e=>new R(e))});d.trigger("tile:hide");b(e[0].id)}function f(i){return i.some(e=>{const t=l.getDynTagById(e.id);return g(t,i)})}function g(e,i){return i.interestGroup!==e.interestGroup||e.contentBlocks.length!==i.contentBlocks.length||e.contentBlocks.some(e=>{const t=i.getContentBlockByTargetId(e.targetId);return!t||t.content!==e.content})}function m(){$("#dyn-tag-list .dyn-tag").each((e,t)=>v($(t)))}function v(e){const t=e.data("dyn-tag-id");const i=l.getDynTagById(t).isEmpty;e.find(".status-badge").toggleClass("mailing.status.has-content",!i).toggleClass("mailing.status.no-content",i)}this.addAction({"editor:change":"validate-on-change"},function(){a.get(this.el).validateField(this.el)});this.addAction({"editor:change":"validate-sms-content"},function(){a.cleanFieldFeedback$(this.el);const e=AGN.Lib.Validator.get("reject-not-allowed-chars").errors(this.el,{msgKey:"error.mailing.smsSymbolsProhibited",chars:"#gsm-7-bit-chars"});_.each(e,e=>{a.markField(this.el);a.appendFeedbackMessage(this.el,e.msg)})});this.addAction({click:"switch-dyn-tag"},function(){let e=u.data("conf")?.dynTag;if(e&&!e.isValid){this.event.preventDefault();return}y();b(this.el.data("dyn-tag-id"))});function y(){d?.trigger("dynTags:modify")}function b(e){const t=l.getDynTagById(e);const i=C(t);d=n.dom("content-editor-template",i);u.html(d);u.data("conf",i);AGN.Lib.Controller.init(u);AGN.runAll(u);m()}function C(e){return{dynTag:e,targetGroups:_.cloneDeep(l.targetGroups),isFullHtmlTags:e.name==="HTML-Version",showHTMLEditor:e.isHtmlDynTag,usedInSmsContent:c.smsDynNames?.length&&c.smsDynNames.includes(e.name),isEditableMailing:c.isEditableMailing,isContentGenerationAllowed:c.isContentGenerationAllowed}}this.addAction({click:"save"},function(){if(l.dynTags.some(e=>!e.isValid)){return}if(A()){AGN.Lib.Confirm.from("mailing-ai-text-generation-apply-question",{dynTagName:u.data("conf")?.dynTag?.name}).then(E);return}y();S(this.el.data("url"))});function w(){return $("[data-ai-result]").val()?.trim()}function A(){const e=$("#tab-content-ai-text-generation");return e.is(":visible")&&w()}function E(){d.trigger("apply-ai-text-on-save",[w()]);S()}function S(e){const t=l.dynTags.filter(e=>e.modified);$.post({url:e,contentType:"application/json",data:JSON.stringify(t)}).done(e=>{d.trigger("tile:show");AGN.Lib.Page.render(e)})}this.addAction({click:"edit-content-modal"},function(){y();if(l.modified&&!window.confirm(i)){return}const e=c.isEmailMediaTypeActive||c.isMailingGrid;AGN.Lib.Modal.fromTemplate("modal-editor",{showText:e,showHtml:e&&c.mailFormat!==0&&!c.isMailingGrid,showSms:c.isSmsMediaTypeActive})});$(window).on("beforeunload",function(){y();if(l.modified){AGN.Lib.Loader.hide();return i}});const T=function(){const e=$("#content-source-select");if(!e){return}const t="web-storage#last-content-source";const i=s.get(t);if(i){if(o.get(e).hasOption(i.id)){e.val(i.id);e.change()}else{s.delete(t)}}};this.addAction({click:"save-content"},function(){let e=$("#content-form");if(!a.get(e).validate()){return}a.get($("#frame-content-form")).submit().done(e=>AGN.Lib.Page.render(e))});class x{constructor(e,i,n){this.dynTags=Object.entries(e).map(function(e){return new D(e[1])},[]);this.interestGroups=_.cloneDeep(n);this.interestGroups.unshift({column:"",shortname:t("mailing.default.interest_group_name")});this.targetGroups=_.cloneDeep(i);this.targetGroups.unshift({id:0,targetName:t("mailing.default.target_group_name")});this.targetGroupsMap=i.reduce(function(e,t){e[t.id]=t;return e},{})}get modified(){return this.dynTags.some(e=>e.modified)}getDynTagById(t){return this.dynTags.filter(e=>e.id===t)[0]}setDynTag(e){const t=this.getDynTagById(e.id);const i=this.dynTags.indexOf(t);if(i>-1){this.dynTags[i]=e.clone()}}getTargetGroupById(e){return this.targetGroupsMap[e]||{id:0,targetName:t("mailing.default.target_group_name")}}}class D{constructor(e){this.id=e.id||0;this.name=e.dynName===undefined?e.name:e.dynName;this.mailingId=e.mailingID===undefined?e.mailingId:e.mailingID;this.interestGroup=this.interestGroup||"";this.interestGroup=e.interestValue===undefined?e.interestGroup:e.dynInterestGroup;if(e.contentBlocks){this.contentBlocks=e.contentBlocks.map(function(e){return new R(e)})}else{this.contentBlocks=Object.entries(e.dynContent).map(function(e){return new R(e[1])})}this.initState=_.cloneDeep(this.lightWeight)}get defaultContentBlock(){return{id:0,index:0,targetId:0,content:""}}get modified(){const e=!this.initState.contentBlocks.length;if(e&&this.isEmpty&&this.contentBlocks.length===1&&this.contentBlocks[0].targetId===0){return false}return!_.isEqual(this.initState,this.lightWeight)}getContentBlockByTargetId(t){return this.contentBlocks.filter(e=>e.targetId===t)[0]}getContentBlockById(t){return this.contentBlocks.filter(e=>e.uniqueId===t)[0]}createNewContentBlock(e=0){const t=new R(this.defaultContentBlock);t.index=this.contentBlocks.length;t.targetId=e;this.contentBlocks.push(t);this.recalculateIndexes();return t}changeTargetGroup(e,t){const i=this.getContentBlockById(e);i.targetId=t;return i}changeContent(e,t){const i=this.getContentBlockById(e);i.content=t||"";return i}changeOrder(e){const t=function(t){return function(e){return t.getContentBlockById(parseInt(e))}};this.contentBlocks=e.map(t(this));this.recalculateIndexes()}remove(e){const t=this.getContentBlockById(e);const i=this.contentBlocks.indexOf(t);if(i>-1){this.contentBlocks.splice(i,1);this.recalculateIndexes()}}clone(){return new D(this)}get isEmpty(){return this.contentBlocks.every(e=>!e.content)}recalculateIndexes(){this.contentBlocks.forEach((e,t)=>e.index=t+1)}get isValid(){const e=this.collectDynTagErrors();e?.forEach(e=>r.alert(e));return!e?.length}collectDynTagErrors(){const e=[];const t=this.contentBlocks.map(e=>e.targetId);if(new Set(t).size!==t.length){e.push("mailing.validation.target_group_duplicated")}if(t.includes(0)&&_.last(t)!==0){e.push("mailing.validation.all_recipients_not_last")}if(this.isHtmlDynTag&&this.contentBlocks.find(e=>this.#containsIllegalElements(e))){e.push("fields.error.illegal_script_element")}return e}get isHtmlDynTag(){return c.htmlDynTagNames?.includes(this.name)}#containsIllegalElements(e){return(new DOMParser).parseFromString(e,"text/html").querySelector("script")}get lightWeight(){return{id:this.id,interestGroup:this.interestGroup,contentBlocks:this.contentBlocks.map(e=>e.lightWeight)}}}class R{constructor(e){if(typeof R.uniqueIdCounter==="undefined"){R.uniqueIdCounter=0}this.uniqueId=++R.uniqueIdCounter;this.id=e.id;this.index=e.dynOrder===undefined?e.index:e.dynOrder;this.content=e.dynContent===undefined?e.content:e.dynContent;this.targetId=e.targetID===undefined?e.targetId:e.targetID}get lightWeight(){const{id:e,content:t,targetId:i}=this;return{id:e,content:t,targetId:i}}}});AGN.Lib.Controller.new("mailing-content-editor-controller",function(){const n=AGN.Lib.Template;const r=AGN.Lib.Select;const t=".mailingContentNamespace";const s=".target-row";const o="content_entry_";const i='[data-action="edit-content-for-target"]';let a;let l;let c;let u;this.addDomInitializer("mailing-content-editor-initializer",function(e){const t=$("#dyn-tag-settings").data("conf");a=t.dynTag;l=$("#targets-order");c=$("#target_groups");u=$("#interest_groups");g();C(a);w(a.interestGroup);d();h(e)});function d(){$("#enlargeable-settings").on("enlarged",function(e){$(e.target).closest(".modal-body").css("overflow","hidden")})}function h(e){e.on("dynTags:modify",function(){y();e.trigger("tile:hide")});e.on("apply-ai-text-on-save",function(e,t){const i=A();if(i>0){a.changeContent(i,t)}})}function p(){l.find(i).removeClass("disabled");let e=$(`${s}.selected`);e=e.exists()?e:$(`${s}:first`);e.find(i).addClass("disabled")}this.addAction({click:"edit-content-for-target"},function(){if(!a.isValid){return}const e=$(this.el);const t=T(e);const i=a.getContentBlockById(t);x(i)});this.addAction({click:"deleteContentEntry"},function(){this.event.stopPropagation();var e=$(this.el).parent();var t=T(e);var i=e.next(s);i=i.length>0?i:e.prev(s);a.remove(t);e.remove();if(a.contentBlocks.length>0){var n=T(i);var r=a.getContentBlockById(n);x(r)}else{x()}D()});this.addAction({click:"addDynContent"},N);function f(e){const t=e.sortable("toArray");const i=t.map(function(e){return e.replace(o,"")});a.changeOrder(i)}function g(){l.sortable({delay:10,scroll:true,scrollSensitivity:30,scrollSpeed:5,handle:".target-row-handle",cursor:"move",items:s,stop:e=>f($(e.target))})}var m=function(t,e){const i=$("#tab-content-wysiwyg");const n=$("#contentEditor");const r=$("#tab-content-ai-text-generation");if(i.is(":visible")){var s=CKEDITOR.instances["content"];if(s.status==="ready"){s.setData(t)}else{s.on("instanceReady",function(e){e.editor.setData(t)})}}if(n.is(":visible")){var o;if(e===false){o=1}else{o=null}var a=ace.edit("contentEditor");if($("body").hasClass("dark-theme")){a.setTheme("ace/theme/idle_fingers")}a.setValue(t,o)}if(r.is(":visible")){$("#multi-editor").find(".js-wysiwyg").val(t)}};function v(){const e=$("#tab-content-wysiwyg");const t=$("#contentEditor");const i=$("#tab-content-ai-text-generation");if(i.is(":visible")){return e.exists()?$("#content").val():ace.edit("contentEditor").getValue()}if(e.is(":visible")){return CKEDITOR.instances["content"].getData()}if(t.is(":visible")){return ace.edit("contentEditor").getValue()}}var y=function(){const e=A();if(e>0){const t=v();if(t!==undefined){a.changeContent(e,t)}}};function b(e,t){const i=n.dom("mailing-target-content-template",{targetId:e,id:o+t.uniqueId});AGN.Lib.CoreInitializer.run("select",i);return i}function C(e){e.contentBlocks.reverse().forEach(function(e){l.prepend(b(e.targetId,e))});if(a.contentBlocks.length>0){x(a.contentBlocks[0],false)}else{N()}D();M();R()}function w(e){u.val(e).trigger("change");u.off("change"+t);u.on("change"+t,e=>a.interestGroup=$(e.target).val())}var _=function(){return l.find(s+".selected")};var A=function(){var e=_();if(e.length>0){return T(e)}};var E=function(e){l.children().removeClass("selected");const t=S(e,l);t.addClass("selected")};var S=function(e,t){t=t?t:$(document);return t.find("#"+o+e)};function T(e){return parseInt(e.closest(s).attr("id").replace(o,""))}this.addAction({change:"change-target"},function(){a.changeTargetGroup(T(this.el),parseInt(this.el.val()));D()});function x(e,t){y();if(e!==undefined){E(e.uniqueId);m(e.content,t)}else{m("")}p();M()}function e(){return $("#targets-order").find("select").map((e,t)=>$(t).val())?.toArray()}function D(){const i=e();$("#targets-order-box").find("select").each(function(e,t){r.get($(t)).disableOptions(i)});r.get(c).disableOptions(i,true);r.get(c).selectFirstValue()}function R(){l.find('select option[value="0"]:selected').closest(s).appendTo(l);f(l)}function M(){l.animate({scrollTop:l[0].scrollHeight},100)}function N(){const e=parseInt(c.val());const t=a.createNewContentBlock(e);l.append(b(e,t));x(t);M();R();D()}});AGN.Lib.Controller.new("mailing-images",function(){const s=AGN.Lib.Modal;const o=AGN.Lib.Template;const i=AGN.Lib.Form;this.addAction({"upload:add":"image-upload"},function(){const e=this.data.file;const t=this.data.index;let i=$("#components-upload-modal");if(!i.exists()){i=s.fromTemplate("userform-images-upload-modal-template");i.on("modal:close",c)}const n=i.find("#components-uploads-container");const r=o.dom("mailing-upload-image",{index:t,fileName:e.name,previewUrl:l(e),isArchive:a(e)==="zip"});n.append(r);AGN.runAll(r)});function a(e){if(e.name&&e.name.includes(".")){return e.name.substring(e.name.lastIndexOf(".")+1).toLowerCase()}return""}function l(e){if(/^image/.test(e.type)){return URL.createObjectURL(e)}return""}function c(){$("#upload-files").val("");$("#dropzone").trigger("upload:reset")}this.addAction({click:"upload-images"},function(){const e=i.get(this.el);const t=s.getWrapper(this.el);e.$form.on("submitted",()=>{if(document.contains(t[0])){t.css("opacity",1)}});e.submit();t.css("opacity",0)})});AGN.Lib.Controller.new("mailing-overview",function(){const s=AGN.Lib.Form;const i=AGN.Lib.DateFormat;const e=[{key:"isgrid",text:t("mailing.default.grid"),class:"mailing.status.emc"},{key:"isCampaignManager",text:t("workflow.icon"),class:"mailing.status.cm"}];this.addDomInitializer("mailing-overview",function(){r(s.getWrapper(this.el));n(this.config.badgesFilters)});function n(t){if(!t){t=[]}const i=$("#status-filter");const n=AGN.Lib.Select.get(i);_.each(e,e=>{i.append(`<option value="${e.key}" data-badge-class="${e.class}">${e.text}</option>`);if(t.includes(e.key)){n.selectOption(e.key)}});const r=s.get(i);r.get$().on("form:submit",()=>{let t=0;_.each(e,e=>{if(n.isOptionSelected(e.key)){r.setValueOnce(`filterBadges[${t++}]`,e.key);n.$findOption(e.key).attr("disabled",true)}})});r.get$().on("submitted",()=>{e.forEach(e=>{n.$findOption(e.key).attr("disabled",false)})})}function r(e){e.off("form:submit");e.off("submitted")}this.addAction({"table-column-manager:add":"update-columns"},function(){const e=s.get(this.el);e.setValueOnce("selectedFields",this.data.columns);e.setValueOnce("inEditColumnsMode",true);e.submit()});this.addAction({"table-column-manager:apply":"update-columns"},function(){const t=this.data.columns;$.ajax({type:"POST",url:AGN.url("/mailing/setSelectedFields.action"),traditional:true,data:{selectedFields:t}}).done(e=>{if(e.success){AGN.Lib.WebStorage.extend("mailing-overview",{fields:t})}AGN.Lib.JsonMessages(e.popups)})});this.addAction({click:"send-date-filter-period"},function(){u(this.el);o(l(),c());a($("input[name='sendDatePeriod']:checked").length>0)});this.addAction({click:"reset-send-date-filter"},function(){o("","");$('input[name="sendDatePeriod"]:checked').removeAttr("checked");a(false)});function o(e,t){$("#filterSendDateBegin").val(e).trigger("change");$("#filterSendDateEnd").val(t).trigger("change")}function a(e){$("#filterSendDateBegin").get(0).toggleAttribute("readonly",e);$("#filterSendDateEnd").get(0).toggleAttribute("readonly",e)}function l(){const e=$("input[name='sendDatePeriod']:checked").val();if(!e){return""}const t=new Date;t.setDate(t.getDate()-e);return i.format(t,window.adminDateFormat)}function c(){return $("input[name='sendDatePeriod']:checked").length?i.format(new Date,window.adminDateFormat):""}function u(e){if(e.is(":checked")){const t=`input:checkbox[name="${e.attr("name")}"]`;$(t).prop("checked",false);e.prop("checked",true)}else{e.prop("checked",false)}}});AGN.Lib.Controller.new("mailing-params",function(){let e=$("#mailingSettingsForm");let t;let i=$("#mailingParamsTable");this.addDomInitializer("mailing-params",function(){t=this.config.params;e=$("#mailingSettingsForm");e.dirty("setAsClean");e.dirty("refreshEvents");i.on("input-table:row-removed",n)});function n(){if(s()&&!r()){e.dirty("setAsClean")}}function r(){const e=t.map(function(e){const t=_.omit(e,"mailingID","mailingInfoID","changeDate");Object.keys(t).forEach(function(e){if(t[e]===null){t[e]=""}});return t});return JSON.stringify(e)!==JSON.stringify(i.data("table").collect())}function s(){return e.dirty("showDirtyFields").filter((e,t)=>!$(t).closest("#mailingParamsTable").length).length===0}});AGN.Lib.Controller.new("mailing-predelivery",function(){var n={aol:"aolonelinespam",yahoo:"yahoospam",gmailnew:"gmailnewspam",ol2003:"ol2003spam"};this.addAction({change:"adjustSpamProvider"},function(){var e=$(this.el);var t=n[e.attr("name")];if(!t){return}var i=$('[name="'+t+'"]');if(e.prop("checked")){i.prop("disabled",false)}else{i.prop("disabled",true);i.prop("checked",false)}});this.addInitializer("readjustSpamProviders",function(){_.each(n,function(e,t){var i=$("[name="+t+"]");if(i.length===0){return}var n=$('[name="'+e+'"]');if(i.prop("checked")){n.prop("disabled",false)}else{n.prop("disabled",true);n.prop("checked",false)}})});function e(e,t){var i=e.closest(".list-group").find('input[type="checkbox"]:enabled');i.prop("checked",t);i.trigger("change")}this.addAction({click:"toggle-checkboxes-on"},function(){e($(this.el),true)});this.addAction({click:"toggle-checkboxes-off"},function(){e($(this.el),false)})});AGN.Lib.Controller.new("mailing-preview",function(){const i=AGN.Lib.Form;const n=AGN.Lib.Storage;const e=AGN.Lib.Messages;const r=AGN.Lib.Helpers;const s=AGN.Lib.Select;const o=["customerATID","customerEmail","modeType","targetGroupId"];let a;let l=false;this.addDomInitializer("mailing-preview",function(e){a=this.config.MAILING_ID;c();var t=i.get(this.el);if(t.getValue("reload")=="false"){t.setValue("reload",true);t.submit().done(()=>{$("[data-stored-field]").on("change",function(){const e=$(this);n.saveChosenFields(e);l=l||u(e)});t.initFields();t.initValidator();d()})}});this.addAction({change:"refresh-preview",click:"update-preview"},function(){l=false;t()});this.addAction({change:"change-stored-header-data"},function(){if(l){l=false;t()}});this.addAction({change:"change-header-data"},function(){t()});function t(){const e=i.get($("#preview-form"));e.setValue("reload",false);e.submit()}function c(){$("[data-stored-field]").each(function(){n.restoreChosenFields($(this))})}function u(e){const t=e.prop("name");return t&&o.includes(t)}function d(){h();f()}this.addAction({click:"change-preview-customer-options"},function(){f()});function h(){const e=p();if(!e.exists()){return}const t=e.val().length<=0;$("#personalized-test-run-container").toggleClass("hidden",t)}function p(){return $("#personalized-test-recipients")}function f(){const e=!b()&&g();$('[data-action="add-to-personalized-test-run"]').toggle(!!e)}function g(){const e=m();return s.get(p()).getSelectedValue().indexOf(e)===-1}function m(){if(y()){return $("#customerEmail").val()}return $('[name="customerATID"]').find(":selected").data("email")}function v(){return $('[name="modeType"]').val()}function y(){return v()==="MANUAL"}function b(){return v()==="TARGET_GROUP"}function C(){return new Promise(function(t,i){const n=m();if(!r.isValidEmail(n)){e.alert("defaults.invalidEmail");return}$.get(AGN.url(`/mailing/preview/${a}/isRecipient.action`),{email:n}).done(e=>{if(e.success){t(n)}else{AGN.Lib.JsonMessages(e.popups,true);i()}})})}this.addAction({input:"change-personalized-test-recipients",change:"change-personalized-test-recipients"},function(){d()});this.addAction({click:"add-to-personalized-test-run"},function(){C().then(e=>{const t=p();const i=s.get(t);if(!i.hasOption(e)){i.addOption(e)}i.selectOptions(_.union(t.val(),[e]));d()})});this.addAction({click:"personalized-test-run"},function(){const t=p();const e=t.val();$.post(AGN.url(`/mailing/send/${a}/personalized-test.action`),{mailingTestRecipients:e}).done(e=>{if(e&&e.success===true){t.val([]);AGN.Lib.CoreInitializer.run("select",t);h()}AGN.Lib.JsonMessages(e.popups,true)})})});AGN.Lib.Controller.new("mailing-priorities",function(){const i=AGN.Lib.Template;const t=AGN.Lib.Helpers;const n=AGN.Lib.DateFormat;const r=".mailing-priority";const s=".mailing-priority-container";let o;let a;let l;let c;let u;let d;let h;const p=()=>{o=$("#ordered-area");a=$("#unordered-area");c=$("#priorityCount");l=$("#save-btn")};function f(){return _.reduce(_.keys(h.mailingsMap),function(e,t){return e<t?e:t})}const g=()=>{const e=$("#date-picker");const t=_.keys(h.mailingsMap).sort();if(t.length){if(!e.datepicker("getDate")){e.datepicker("setDate",n.parse(f()))}}e.trigger("change")};this.addDomInitializer("mailing-priorities",function(){h=this.config;p();const e=$(".tiles-container");$(s).sortable({handle:".mailing-priority__drag-btn",opacity:.4,connectWith:s,items:r,helper:"clone",containment:e,appendTo:document.body,update:function(){if(this.id===o.attr("id")){v();E()}},out:function(){m($(this),false)},over:function(e,t){m($(e.target),false);m($(this),true)},start:function(){m($(this),true)},stop:function(){m($(this),false)}});g()});this.addAction({change:"priorityCount"},E);this.addAction({input:"priorityCount"},function(){const e=parseFloat(this.el.val());const t=!isNaN(e)&&e>=0?e:0;this.el.val(t)});this.addAction({change:"change-date"},function(){const e=this.el.datepicker("getDate");if(e){y(A([e.getFullYear(),e.getMonth(),e.getDate()]))}else{y()}});this.addAction({click:"save"},function(){const e=AGN.Lib.Form.get(this.el);e.setValueOnce("prioritizedIds",S());e.submit()});const m=(e,t)=>{e.closest(s).toggleClass("highlighted",t)};function v(){let i=1;let n=10;o.children(r).each(function(){const e=$(this);let t=0;if(e.data("type")==h.DATE_BASED_TYPE){t=n;i=n;n+=10}else{t=i;if(i>n){n=Math.round(i/10)*10}}i++;e.find(".mailing-priority__order").text(`${t}.`)})}function y(e){const t=b(e);$(r).remove();w(t);E(true)}function b(e){let t=(h.mailingsMap[e]||[]).filter(e=>e.mailingType!==h.DATE_BASED_TYPE||e.priority>0);const i=t.map(e=>e.id);const n=C(i);return _.union(t,n,"id").sort((e,t)=>e.priority>t.priority?1:-1)}const C=e=>{const t=[];const i=_.clone(e);_.keys(h.mailingsMap).forEach(e=>{h.mailingsMap[e].forEach(e=>{if(e.mailingType==h.DATE_BASED_TYPE&&!i.includes(e.id)){i.push(_.clone(e).id);t.push(e)}})});return t};function w(e){if(e&&e.length){e.forEach(function(e){if(e.thumbnailId){e.thumbnailUrl=h.thumbnailLinkPattern.replace("__thumbnailId__",e.thumbnailId)}else{e.thumbnailUrl=h.noPreviewUrl}const t=i.dom("draggable-mailing-priority-entry",e);if(e.priority){o.append(t)}else{a.append(t)}AGN.runAll(t)})}}function A(e){return`${t.pad(e[0],4)}-${t.pad(parseInt(e[1])+1,2)}-${t.pad(e[2],2)}`}function E(e){const t=S(";");const i=c.val();if(u==null&&d==null||e){u=t;d=i;if(i>0){l.prop("disabled",true)}else{const n=T();c.val(n);l.prop("disabled",!n)}}else{l.prop("disabled",t==u&&i==d)}}function S(e){const t=[];o.children(r).each(function(){const e=$(this).data("id");if(e>0){t.push(e)}});return e?t.join(e):t}function T(){return o.children(r).filter(function(){return $(this).data("id")>0}).length}});AGN.Lib.Controller.new("mailing-recipients",function(){const t=AGN.Lib.Form;this.addAction({"table-column-manager:add":"update-columns"},function(){const e=t.get(this.el);e.setValueOnce("selectedFields",this.data.columns);e.setValueOnce("inEditColumnsMode",true);e.submit()});this.addAction({"table-column-manager:apply":"update-columns"},function(){const t=this.data.columns;$.ajax({type:"POST",url:AGN.url("/mailing/recipients/setSelectedFields.action"),traditional:true,data:{selectedFields:t}}).done(e=>{if(e.success){AGN.Lib.WebStorage.extend("mailing-recipient-overview",{fields:t})}AGN.Lib.JsonMessages(e.popups)})})});AGN.Lib.Controller.new("reference-content-settings",function(){let i;let e=false;let n=false;let t=[];let r;function s(){const e=$("#referenceTableSelect");const t=e.children("option:selected");$("#keyColumnText").val(t.exists()?t.data("key-column"):"")}function o(e,t){return AGN.Lib.Template.dom("mailing-reference-content-item",{name:a(e),value:t,disabled:!n})}function a(e){return"Item"+e}function l(e){const t=o(u().length+1,e);i.append(t)}function c(e){if(!n){l("");return}_.each(e,e=>l(e))}function u(){return $("#reference-content-items .row")}this.addDomInitializer("reference-content-settings",function(){i=$("#reference-content-items");r=$("#mailingSettingsForm");s();e=this.config.isAvailable;n=this.config.isEnabled;c(this.config.items);t=u();d();r.dirty("setAsClean");r.dirty("refreshEvents")});function d(){$("#referenceContentEnabled").on("change",function(){$("#referenceTableSelect").prop("disabled",!$(this).prop("checked"))})}this.addAction({change:"select-reference-table"},function(){s()});this.addAction({click:"add-reference-content-item"},function(){h();l("");r.dirty("setAsDirty")});function h(){const e=i.find('[data-action="add-reference-content-item"]');e.after(_.template(AGN.Opt.Templates["mailing-reference-content-delete-btn"])({disabled:!n}));e.remove()}function p(){return t.length!==u().length||t.some(e=>!u().includes(e))}function f(){u().each((e,t)=>{$(t).find(".input-group-text").text(a(e+1))})}this.addAction({click:"delete-reference-content-item"},function(){this.el.closest(".row").remove();f();if(!p()){r.dirty("setAsDirty")}})});AGN.Lib.Controller.new("mailing-send",function(){const n=AGN.Lib.Form,e=AGN.Lib.Modal,i=AGN.Lib.Confirm,r=AGN.Lib.Page,s=AGN.Lib.Template,o=AGN.Lib.Messages;const a="RECIPIENT";const l="TARGET";const c="SEND_TO_SELF";let u;let d;let t;const h={hideGreenMarks:function(){const e=$(".transmission-mark");e.parent().find("button").removeClass("hidden");e.remove()},updateWorkStatus:function(e,t){const i=$(s.text("mailing-workstatus-icon",{workstatus:e,tooltip:t}));$("#workstatus-icon").replaceWith(i);AGN.Lib.CoreInitializer.run("tooltip",i)}};this.addDomInitializer("test-mailing",function(){u=$("#test-recipients-table");g(this.config.testRecipients);d=JSON.parse(this.config?this.config.approvalOptions:"[]");p();$("#get-approval-switch").on("change",function(){p()});f();$("#test-run-options").on("change",function(){f()})});function p(){const e=$("#get-approval-switch").prop("checked");const t=$("#test-run-options");t.find("option:not([value='"+d.join("']):not([value='")+"']").attr("disabled",e);if(e&&d.indexOf(t.val())===-1){t.val(t.find("option:not(:disabled):first").val()).trigger("change")}}function f(){const e=$("#test-run-options");if(!e.length){return}const t=e.val()==a;const i=e.val()==l;const n=e.val()==c;const r=!t||!$("#save-target-toggle").prop("checked");u.parent().toggleClass("hidden",!t);$("#adminSendButton").parent().toggleClass("hidden",t||i||n);$("#testTargetSaveButton").parent().toggleClass("hidden",r);$("#test-run-target-name-input").toggleClass("hidden",r);$("#testRunOptionSelect").prop("disabled",!i);u.find("input").prop("disabled",!t)}this.addDomInitializer("send-mailing",function(){t=this.config;const n=window.adminLocale==="en-US"?",":".";_.each($(".commaSplitInput"),e=>{const t=$(e);const i=t.val().replace(/\B(?=(\d{3})+(?!\d))/g,n);t.val(i)});E();if(t.approximateMaxDeliverySize>t.errorSizeThreshold){o.warnText(s.text("delivery-size-error-msg"))}});this.addAction({click:"check-links"},function(){$.post(t.urls.CHECK_LINKS).done(e=>AGN.Lib.RenderMessages($(e)))});this.addAction({click:"send-world"},function(){if(t.approximateMaxDeliverySize>t.errorSizeThreshold){o.alertText(s.text("delivery-size-error-msg"));return}const e=()=>{const t=n.get($("#delivery-settings-tile"));t.setActionOnce(AGN.url("/mailing/send/confirm-send-world.action"));t.submit("confirm").done(e=>{i.create(e).done(e=>t.updateHtml(e))})};if(t.approximateMaxDeliverySize>t.warningSizeThreshold){i.createFromTemplate({},"warning-mailing-size-modal").done(e);return}e()});const g=function(t){if(!t.length){const i=s.dom("test-recipient-row",{value:"",newRow:true,sent:false});u.append(i);AGN.runAll(i);return}for(let e=0;e<t.length;e++){const n=e===t.length-1;const i=s.dom("test-recipient-row",{value:t[e],newRow:n,sent:true});u.append(i);AGN.runAll(i)}};this.addAction({change:"save-interval-settings"},function(){const e=n.get(this.el);e.setActionOnce(AGN.url("/mailing/send/interval.action"));e.submit()});this.addAction({click:"resume-sending"},function(){const t=this.el;const e=t.data("link");$.post(e).done(e=>{r.render(e);t.parent().remove()})});this.addDomInitializer("status-mail-recipients",function(){const e=this.config.recipients||"";const t=$("#status-emails-block");e.split(" ").filter(e=>e).forEach(e=>t.append(s.text("status-mail-recipient-row",{email:e,newRow:false})));t.append(s.text("status-mail-recipient-row",{email:"",newRow:true}))});this.addAction({click:"status-mail-recipient-row-delete"},function(){const e=this.el.closest("[data-status-mail-recipient-row]");const t=e.data("mailing-id");e.remove();v(t,m())});this.addAction({click:"status-mail-recipient-row-add",enterdown:"status-mail-recipient-change"},function(){this.event.preventDefault();const e=this.el.closest("[data-status-mail-recipient-row]");const t=e.find("input");const i=t.val();if(i){v(e.data("mailing-id"),m(true),()=>{e.before(s.text("status-mail-recipient-row",{email:i,newRow:false}));t.val("")})}});const m=(e=false)=>{let t=$("[data-status-mail-recipient-row]").find("input");if(!e){t=t.not(":last")}return t.map(function(){return $(this).val().trim()}).get().join(" ")};const v=(e,t,i)=>{$.post(AGN.url(`/mailing/send/${e}/save-statusmail-recipients.action`),{emails:t}).done(e=>{if(e.success&&i){i()}AGN.Lib.JsonMessages(e.popups)}).fail(()=>o.defaultError())};this.addDomInitializer("delivery-status-view",function(){if(!this.config.isTransmissionRunning){h.hideGreenMarks()}const e=this.config.workStatus;const t=this.config.workStatusTooltip;if(e&&t){h.updateWorkStatus(e,t)}if(this.config.deliveryStat){const e=_.extend(this.config.deliveryStat,this.config.deliveryStatExtraInfo);y(e)}});function y(e){const t=s.dom("delivery-status-buttons",e);$(".delivery-status-action").remove();$(".header__actions").append(t)}this.addAction({click:"start-delivery"},function(){if($("#test-run-options").val()==a){const t=$('input[name="mailingTestRecipients"]').get().some(e=>$(e).val().trim());if(!t){o.alert("error.enterEmailAddresses");return}}$("#adminSendButton").addClass("disabled");$("#testSendButton").addClass("disabled");const e=n.get(this.el);e.setActionOnce(this.el.data("url"));e.submit()});this.addAction({click:"add-test-recipient",enterdown:"new-test-recipient"},function(){this.event.preventDefault();const e=this.el.closest("[data-test-recipient-row]");const t=this.el.is("input")?this.el:e.find("input");const i=s.dom("test-recipient-row",{value:t.val()||"",newRow:false,sent:false});e.before(i);t.val("");AGN.runAll(i);t.focus();b(false)});this.addAction({click:"remove-test-recipient"},function(){const e=this.el.closest("[data-test-recipient-row]");e.remove();b(false)});this.addAction({input:"new-test-recipient"},function(){b(false)});this.addAction({input:"edit-test-recipient",enterdown:"edit-test-recipient"},function(){this.event.preventDefault();b(false)});this.addAction({input:"edit-test-run-target-name"},function(){b(false)});this.addAction({enterdown:"edit-test-run-target-name"},function(){this.event.preventDefault()});function b(e){const t=$("#testTargetSaveButton");const i=t.find("i");if(e){i.hide()}t.toggleClass("btn-primary",!e,500);t.toggleClass("btn-success",e,500);if(e){t.css({cursor:"not-allowed","pointer-events":"none"})}else{t.css({cursor:"","pointer-events":""})}i.toggleClass("icon-save",!e);i.toggleClass("icon-check",e);i.show(500)}this.addAction({click:"save-target-for-test-run"},function(){if(!C()){return}w()});function C(){const t=$('input[name="targetName"]');const i=n.get(t);const e=AGN.Lib.Validator.get("length").errors(t,{min:3,required:true});if(!e.length){i.cleanFieldFeedback();return true}e.forEach(e=>i.showFieldError$(t,e.msg));return false}function w(){$.ajax({type:"POST",url:AGN.url("/mailing/send/test/saveTarget.action"),data:{mailingTestRecipients:A(),targetName:$('input[name="targetName"]').val().trim()}}).done(e=>{if(e.success===true){b(true)}else{AGN.Lib.JsonMessages(e.popups)}})}function A(){return $('input[name="mailingTestRecipients"]').map(function(){return this.value.trim()}).get().filter(e=>e)}this.addAction({focusout:"max-recipients-change"},function(){E()});function E(){const e=$("#maxRecipients");if(e.exists()&&e.val()==="0"){e.val("")}}this.addAction({change:"prioritization-toggle"},function(){S($(this.el),"isPrioritizationDisallowed")});this.addAction({change:"encrypted-send-toggle"},function(){S($(this.el),"isEncryptedSend")});this.addAction({change:"sendStatusOnErrorOnly-toggle"},function(){S($(this.el),"statusOnErrorEnabled")});function S(e,t){const i=e.prop("checked");e.prop("disabled",true);const n=()=>{e.prop("checked",!i);o.defaultError()};const r={};r[t]=e.is(":checked");$.ajax({type:"POST",url:e.data("url"),data:r}).done(e=>{if(e&&e.success){o.success("defaults.saved")}else{n()}}).fail(n).always(()=>e.prop("disabled",false))}});AGN.Lib.Controller.new("mailing-separate-statistics",function(){this.addAction({"table-column-manager:add":"update-columns"},function(){const e=AGN.Lib.Form.get(this.el);e.setValueOnce("additionalFields",this.data.columns);e.setValueOnce("inEditColumnsMode",true);e.submit()});this.addAction({"table-column-manager:apply":"update-columns"},function(){const t=this.data.columns;$.ajax({type:"POST",url:AGN.url("/statistics/mailing/setSelectedFields.action"),traditional:true,data:{selectedFields:t}}).done(e=>{if(e.success){AGN.Lib.WebStorage.extend("mailing-separate-stats-overview",{fields:t})}AGN.Lib.JsonMessages(e.popups)})})});AGN.Lib.Controller.new("mailing-settings-view",function(){const r=AGN.Lib.Form;const e=AGN.Lib.Template;const i=AGN.Lib.Select;const n=AGN.Lib.Modal;const s=AGN.Lib.Messages;const o=["#settingsGeneralMailingList","#lightWeightMailingList","#assignTargetGroups","#targetGroupIds","#altgIds","#followUpType"];let a;let l=false;let c=[];let u;let d=0;let h;let p=false;let f;let g;this.addDomInitializer("mailing-settings-view",function(){a=this.config;v();f=m();g=$("#mailingSettingsForm");c=$("#targetGroupIds").val()||[];x(c.length>1);u=i.get($("#settingsGeneralMailingList"));u.setReadonly(false);if(d>0){d=u.selectOption(d);u.get$().trigger("change")}if(a.selectedRemovedMailinglistId){H()}O(a.mailingType);B();y();w();k()});function m(){try{return e.text("edit-with-campaign-btn")}catch(e){return""}}function v(){$(o.join(",")).on("change",function(){l=true;if(!h){return}const e=D();if(!_.isEqual(e,h)){h=null;R("?")}})}function y(){const e=b()===a.TARGET_MODE_OR;$("#target-mode-description").text(t(`mailing.default.targetmode_${e?"or":"and"}`))}function b(){return $("[name='targetMode']:checked").val()}function C(){return $("<div>",{class:"input-group-text input-group-text--disabled border-end-0 pe-0",html:f})}function w(){_.each($('[data-workflow-driven="true"]'),e=>A($(e)))}function A(e){if(e.is('input[type="text"]')){E(e)}if(e.is('input[type="checkbox"]')){S(e)}if(e.is("select")){G(e)}e.prop("disabled",true)}function E(e){e.css("border-left","0").wrap('<div class="input-group">').before(C(f));AGN.Lib.CoreInitializer.run("tooltip",e.parent())}function S(e){e.next().after(f);AGN.Lib.CoreInitializer.run("tooltip",e.parent())}function G(e){const i=e.next(".select2-container");if(e.prop("multiple")){i.find(".select2-selection__rendered").hide();i.find(".select2-search__field").val(t("mailing.default.editWithCampaign"));i.find(".select2-search--inline").prepend(f)}else{i.find(".select2-selection").prepend(f)}AGN.Lib.CoreInitializer.run("tooltip",i)}function H(){const e=r.get(g);e.showFieldError("mailinglistId",t("fields.mailinglist.errors.removed"),true)}function T(){const e=g.dirty("showDirtyFields");if(e.length>0){var t=e.filter(function(e,t){var i=$(t);return!(i.prop("readonly")===true||i.is(":disabled")||i.prop("type")==="hidden")});return t.length===0}else{return false}}function B(){g.dirty("destroy");g.dirty({preventLeaving:true,leavingMessage:t("grid.layout.leaveQuestion"),onDirty:function(){if(T()&&!p){g.dirty("setAsClean")}}});if(T()&&!p){g.dirty("setAsClean")}p=false}window.onbeforeunload=function(){if(!g.dirty("isDirty")===true){AGN.Lib.Loader.show()}};function x(e){$("#target-mode-box").toggle(e);$("#regular-targets-box").toggleClass("border rounded p-2",e)}this.addAction({change:"selectTargetGroups"},function(){const e=this.el.val()||[];if(e.length>1&&c.length<=1){$("#target-mode-and-btn").prop("checked",true)}x(e.length>1);c=e});function V(e){var r={};e.forEach(function(e){var t=$(e);if(t.exists()&&t.is(":visible")&&!t.prop("disabled")){var i=t.prop("name");var n=t.val();if(i){r[i]=n}}});return r}this.addAction({click:"calculateRecipients"},function(){if(a){h=D();$.ajax({type:"POST",url:AGN.url("/mailing/ajax/"+a.mailingId+"/calculateRecipients.action"),traditional:true,data:h}).always(function(e){if(e&&e.success===true){R(e.count)}else{R("?");s.defaultError()}})}});function D(){return $.extend(V(o),{changeMailing:l,targetMode:b(),isWmSplit:a.wmSplit})}function R(e){$("#number-of-recipients").val(e)}this.addAction({change:"set-parent-mail-mailinglist"},function(){M()});this.addAction({change:"change-general-mailing-type"},function(){const e=this;const t=e.el.val();u.setReadonly(false);if(d>0){u.selectOption(d)}O(t)});this.addAction({change:"save-mailing-list-id"},function(){const t=this.el.select2("val");const e=$("#settingsGeneralMailType").val();if(!N(e)){d=t}if(a.selectedRemovedMailinglistId){u.$findOption(a.selectedRemovedMailinglistId).remove();const n=r.get($(this.el));n.cleanFieldError("mailinglistId")}const i=a.mailinglists.find(function(e){return e.id==t});if(i){if(i.senderEmail){$("#emailSenderMail").val(i.senderEmail).trigger("change")}if(i.replyEmail){$("#emailReplyEmail").val(i.replyEmail)}if(i.senderEmail&&i.replyEmail){s.info("mailing.default.sender_and_reply_emails_changed")}else if(i.senderEmail){s.info("mailing.default.sender_email_changed")}else if(i.replyEmail){s.info("mailing.default.reply_email_changed")}}});this.addAction({change:"change-target-mode"},y);function M(){const e=$("#lightWeightMailingList").val();const t=$("#parentmailing-"+e+"-mailinglist").attr("data-mailing-list-id");u.selectOption(t);u.setReadonly(true)}function N(e){return a.FOLLOWUP_MAILING_TYPE==e}function W(e){return a.ACTIONBASED_MAILING_TYPE==e}function z(e){return a.DATEBASED_MAILING_TYPE==e}function O(e){var t=false;if(a.followUpAllowed){if(N(e)){M();t=true}I(t,"#followUpControls")}I(z(e),"#mailing-bcc-recipients");const i=W(e)?a.campaignEnableTargetGroups:true;I(i,"#regular-targets-box, #calculate-recipients-box")}function I(e,t){var i=$(t);if(i){if(e){i.removeClass("hidden");i.show()}else{i.hide()}}}this.addAction({change:"change-mediatype"},function(){var e=$(this.el);var t=P(e);Y(e,t);const i=$("#email-mediatype-switch, #sms-mediatype-switch").is(":checked");$("#edit-frame-content-btn").toggle(i)});function P(e){return e.find("input:checkbox:first").is(":checked")}function j(){var t=$("#mediatypes-list");var e=U();t.empty();e.forEach(function(e){t.append(e)})}function U(){return $("#mediatypes-list li").toArray().sort(function(e,t){var i=$(e);var n=$(t);if(!P(i)&&P(n))return 1;if(P(i)&&!P(n))return-1;return i.data("priority")-n.data("priority")})}function Y(e,t){j();q(e,t)}function q(e,t){if(t){e.find(".form-switch").after(K())}else{e.find(".list-group-item-controls").remove()}k()}function k(){let e=$(".list-group");e.find("a").css("opacity","1");e.find(".icon-angle-up:first, .icon-angle-down:last").css("opacity","0");r.get(e).initFields()}function K(){return`
          <div class='list-group-item-controls'>
              <a href='#' class='icon icon-angle-down fs-2' data-action='prioritise-mediatype-down'></a>
              <a href='#' class='icon icon-angle-up fs-2' data-action='prioritise-mediatype-up'></a>
          </div>`}this.addAction({click:"prioritise-mediatype-up"},function(){L($(this.el).closest("li"),true)});this.addAction({click:"prioritise-mediatype-down"},function(){L($(this.el).closest("li"),false)});function X(e){var t=e.prev();var i=e.attr("data-priority");e.attr("data-priority",t.attr("data-priority"));t.attr("data-priority",i);t.before(e)}function Q(e){var t=e.next();var i=e.attr("data-priority");e.attr("data-priority",t.attr("data-priority"));t.attr("data-priority",i);t.after(e)}function Z(e,t){return t&&e.prev().length||!t&&e.next().length&&P(e.next())}function L(e,t){p=true;if(Z(e,t)){if(t){X(e)}else{Q(e)}g.dirty("setAsDirty");k()}}this.addAction({submission:"save"},F);function F(){const e=r.get(g);J(e);ee(e);e.submit()}function J(n){$("#mediatypes-list li").toArray().forEach(function(e){const t=$(e);const i=t.data("mediatype");n.setValueOnce(i+"Mediatype.priority",t.data("priority"))})}function ee(i){const e=$("#mailingParamsTable");if(!e.exists()){return}_.each(e.data("table").collect(),function(e,t){i.setValueOnce("params["+t+"].name",e.name);i.setValueOnce("params["+t+"].value",e.value);i.setValueOnce("params["+t+"].description",e.description)})}this.addAction({click:"edit-content-modal"},function(){const e=$("#email-mediatype-switch").prop("checked")||a.isMailingGrid;const t=e&&!$("#emailMailFormat").val()==0&&!a.isMailingGrid;const i=$("#sms-mediatype-switch").prop("checked");AGN.Lib.Modal.fromTemplate("modal-editor",{showText:e,showHtml:t,showSms:i})});this.addAction({click:"save-content"},function(){let e=$("#content-form");if(!r.get(e).validate()){return}n.getInstance(e).hide();F()});this.addAction({"editor:change":"validate-on-change"},function(){r.get(this.el).validateField(this.el)})});AGN.Lib.Controller.new("mailing-styles",function(){const e=AGN.Lib.Form;this.addAction({click:"update-preview",submission:"updatePreview"},function(){const t=e.get($("#layoutPreviewForm"));e.get(this.el).get$().find('input[name^="styles["]').each(function(){const e=$(this);t.setValue(e.attr("name"),e.val())});t.submit()})});AGN.Lib.Controller.new("mailinglist-list",function(){this.addAction({click:"bulk-delete"},function(){const n=i(this.el);if(!n){return}const r=n.getSelectedRows();const e=r.map(e=>e.id);t(e,AGN.url("/mailinglist/confirmBulkDelete.action")).done(e=>{if(typeof e=="object"){const t=e.data;const i=r.filter(e=>t.includes(e.id));n.applyTransaction({remove:i});AGN.Lib.JsonMessages(e.popups,true)}else{AGN.Lib.RenderMessages($(e))}})});function t(e,t){const i=$.Deferred();if(e&&e.length){const n=$.ajax(t,{method:"GET",traditional:true,data:{bulkIds:e}}).done(e=>{if(e){AGN.Lib.RenderMessages($(e))}}).fail(()=>i.reject());AGN.Lib.Confirm.request(n).then(i.resolve,i.reject)}else{i.reject();AGN.Lib.Messages.alert("messages.error.nothing_selected")}return i.promise()}function i(e){return AGN.Lib.Table.get(e)?.api}});AGN.Lib.Controller.new("mailloop-reply-view",function(){this.addDomInitializer("mailloop-reply-view",function(){const e=AGN.Lib.Template.dom("mailoop-reply-new-status-badge");$(`[data-reply-status-badge="${this.config.id}"]`).replaceWith(e);AGN.Lib.CoreInitializer.run("tooltip",e)})});AGN.Lib.Controller.new("reference-table-import",function(){const t=AGN.Lib.Form;this.addDomInitializer("ref-table-import-mapping",function(){new e(this.el)});this.addAction({click:"create-mapping"},function(){const e=t.get(this.el);$.ajax(this.el.attr("href"),{type:"POST",dataType:"json",enctype:"multipart/form-data",processData:false,contentType:false,data:e.data()}).done(e=>{if(e.success===true){n().update(e.data)}AGN.Lib.JsonMessages(e.popups)})});this.addAction({click:"import-data"},function(){const e=t.get(this.el);e.setActionOnce(this.el.attr("href"));i(e)});this.addAction({click:"add-contant-value"},function(){$.post(this.el.attr("href")).done(e=>{if(e.success){const t=n();const i=t.collect(false);i.push({sourceColumn:null,targetColumn:"",mandatory:false,format:"",defaultValue:"",encrypted:false});t.update(i)}AGN.Lib.JsonMessages(e.popups,true)})});this.addAction({submission:"save"},function(){i(t.get(this.el))});function i(i){_.each(n().collect(false),(e,t)=>{i.setValueOnce(`mappings[${t}].sourceColumn`,e.sourceColumn);i.setValueOnce(`mappings[${t}].targetColumn`,e.targetColumn);i.setValueOnce(`mappings[${t}].mandatory`,e.mandatory);i.setValueOnce(`mappings[${t}].encrypted`,e.encrypted);i.setValueOnce(`mappings[${t}].defaultValue`,e.defaultValue);i.setValueOnce(`mappings[${t}].format`,e.format)});i.submit()}function n(){return $("#mappingsTable").data("table")}class e extends AGN.Lib.InputTable{generateRowBtn(e){if(e?.sourceColumn){return""}return super.generateRowBtn(e)}}});AGN.Lib.Controller.new("manage-tables-viewfield",function(){var t="true";this.addAction({change:"typeFieldChangeAction"},function(){var e=$("#nullable");if(this.el.val()==="DATE"||this.el.val()==="DATETIME"){t=e.val();e.val("true")}else{e.val(t)}})});AGN.Lib.Controller.new("mediapool-overview",function(){this.addDomInitializer("mediapool-edit",function(){$('[id$="-editor-modal"]').on("modal:close",()=>AGN.Lib.Messages.warn("defaults.changesNotSaved"))});this.addAction({click:"change-category-bulk"},function(){const e=[...$('input[name="bulkIds"]:checked')].map(e=>e.value);if(!e?.length){AGN.Lib.Messages.alert("messages.error.nothing_selected");return}AGN.Lib.Modal.fromTemplate("category-select-modal",{bulkIds:e})})});AGN.Lib.Controller.new("mediapool-upload",function(){const s=AGN.Lib.Template;const o=AGN.Lib.Form;const i="data-mediapool-upload";const n=`[${i}]`;const a={};let r={};let l;let t;let c;this.addDomInitializer("mediapool-upload",function(){r=this.config.fileExtensions;l=$("#components-uploads-container");t=$("#upload-reset-btn");c=$("#dropzone");c.on("upload:reset",function(){l.empty();v(true);y(false)})});this.addAction({"upload:add":"mediapool-upload"},function(){const n=this.data.file;const r=this.data.index;v(false);y(true);p(n.name,e=>{const t=u(n);const i=s.dom("mediapool-upload-item",{index:r,itemId:e.data?e.data.id:0,fileName:n.name,previewUrl:d(n),typeCode:h(t),isArchive:t==="zip"});l.append(i);o.get(l).initFields();AGN.runAll(i)},true)});function u(e){if(e.name&&e.name.includes(".")){return e.name.substring(e.name.lastIndexOf(".")+1).toLowerCase()}return""}function d(e){if(/^image/.test(e.type)){return URL.createObjectURL(e)}return""}function h(e){if(e){for(const t in r){if(r[t].includes(e)){return t}}}return null}this.addAction({click:"upload-files"},function(){const e=o.get(this.el);let s=e.validate();g().each(function(){const t=$(this);const i=t.find('[data-action="overwrite-data"]');const n=t.find('[name$=".fileName"]').val();const r=i.is(":checked");p(n,e=>{if(e.data&&!r){s=false;i.data("item-id",e.data.id);$(`[name='uploads[${m(t)}].id']`).val(e.data.id);b(t,true);AGN.Lib.Messages.warn("fields.mediapool.warnings.overwrite_inactive",n)}else if(!r){b(t,false)}})});if(s){e.submit()}});function p(e,t,i=false){const n=e=>{if(e.data){a[e.data.id]=e.data}t(e)};$.ajax(AGN.url("/mediapool/findElementWithName.action"),{data:{fileName:e},async:i,type:"GET",success:n})}this.addAction({change:"overwrite-data"},function(){const e=$(this.el);const t=e.closest(".tile");const i=e.data("item-id");let n="";let r="";if(e.is(":checked")&&a[i]){const s=a[i];n=s.title;r=String(s.category.categoryId)}t.find('[name$=".title"]').val(n);t.find('[name$=".categoryId"]').val(r).trigger("change")});this.addAction({change:"change-mobile-base"},function(){const e=this.el;const t=AGN.Lib.Helpers.objFromString(e.data("config"));const i=AGN.Lib.Select.get(e).getSelectedValue();const n=i&&i.length>0;const r=n?t.mobilePrefix+i:t.initialValue;const s=e.closest(".tile").find('[name$=".fileName"]');s.val(r).prop("readonly",n)});this.addAction({click:"remove-upload"},function(){const e=m(this.el);const t=o.get(this.el);AGN.Lib.Upload.get(c).removeSelection(e);this.el.closest(".tile").remove();f(e);t.initFields();if(!g().exists()){v(true);y(false)}});function f(t){const e=g().filter(function(){const e=m($(this));return parseInt(e)>parseInt(t)});e.each(function(){const e=$(this);const t=m(e)-1;e.find('[name*="uploads["]').each(function(){const e=$(this);e.attr("name",e.attr("name").replace(/uploads\[\d+]/g,`uploads[${t}]`))});e.attr(i,t)})}function g(){return $(n)}function m(e){const t=e.is(n)?e:e.closest(n);return t.attr(i)}function v(e){l.prev().toggleClass("hidden",!e)}function y(e){t.parent().toggleClass("hidden",!e)}function b(e,t){e.find("[data-duplication-error-block]").toggleClass("hidden",!t);e.find("[data-overwrite-block]").toggleClass("hidden",!t)}});AGN.Lib.Controller.new("navbar",function(){this.addAction({mouseenter:"expand-navbar-tab",mouseleave:"expand-navbar-tab"},function(){this.el.toggleClass("hovered")})});AGN.Lib.Controller.new("news-editor",function(){var r=AGN.Lib.Template;var s=["de","en"];var o;this.addDomInitializer("news-editor-init",function(){o=0;var e=$('input[name="newsId"]').val();var t=$(".existent-news");if(t&&t.length>0&&e==0){$(t).each(function(){var e=$(this).find(".existent-news-language").val();var t=$(this).find(".existent-news-title").val();var i=$(this).find(".existent-news-content").val();n(e,t,i);l();a();$(this).remove()})}else if(e==0){n(i(),"","");l();a()}});this.addAction({click:"addNewsContent"},function(){n(i(),"","");l();a()});this.addAction({click:"removeNewsContent"},function(){var e=$(this.el).closest(".l-news-content-block");$(e).remove();l();a();c()});this.addAction({change:"changeLanguage"},function(){c()});function n(e,t,i){if(e!=""){var n=r.dom("news-content-template-row",{lang:e,index:o,title:t,content:i});n.appendTo("#news-content-editor");AGN.runAll(n);c();o++}}function a(){const e=u();const t=$("#news-content-editor > .l-news-content-block").last().data("index");$("#add-news-"+t).toggle(s.length!=e.length)}function l(){const e=$("#news-content-editor > .l-news-content-block");$("button[id^='add-news-']").hide();const t=$(e).first().data("index");$("#delete-news-"+t).toggle(e.length!=1)}function c(){var e=t();$("#news-content-editor > .l-news-content-block").find("select.news-language").each(function(){$("option",this).not(":selected").remove();var i=$(this);$.each(e,function(e,t){$(i).append($("<option>",{value:t,text:t}))})})}function t(){var i=[];var n=u();$.each(s,function(e,t){if($.inArray(t,n)==-1){i.push(t)}});return i}function u(){var e=$("#news-content-editor > .l-news-content-block").find("select.news-language").find("option:selected");return e.map(function(){return $(this).val()}).toArray()}function i(){var i=u();var n="";if(i.length==0){n=s[0]}else{$.each(s,function(e,t){if(i.indexOf(t)<0){n=t;return false}})}return n}});AGN.Lib.Controller.new("notification-global-stat",function(){let t;let s;let u;this.addDomInitializer("notification-global-stat",function(){t=$("#global-status-chart");s=$("#global-browser-chart");u=$("#global-progress-chart");e();i();n()});this.addAction({change:"update-progress-chart"},function(){n()});function e(){$.get(AGN.url("/push/ajaxGetGlobalStatusStatistic.action")).done(e=>{if(e&&e.warning&&e.warning.length>0){AGN.Lib.JsonMessages(e,true)}else{new Chart(t[0].getContext("2d"),{type:"bar",data:{labels:Object.keys(e),datasets:[{data:Object.values(e),backgroundColor:t.css("--chart-blue-color"),categoryPercentage:1.08,minBarLength:2}]},options:{indexAxis:"x",layout:{padding:{top:20,right:0}},scales:{x:{ticks:{autoSkip:false,maxRotation:90}},y:{display:false}},plugins:{legend:{display:false},datalabels:{anchor:"end",align:"end",offset:-5}}}})}})}function i(){$.get(AGN.url("/push/ajaxGetGlobalBrowserStatistic.action")).done(e=>{if(e&&(e.warning&&e.warning.length>0)){AGN.Lib.JsonMessages(e,true)}else{const t=[];const i=[];for(const r in e){t.push(r);i.push(a(e[r]*100,1))}const n=[s.css("--chart-very-dark-blue-color"),s.css("--chart-dark-blue-color"),s.css("--chart-blue-color"),s.css("--chart-light-blue-color"),s.css("--chart-light-cyan-color")];new Chart(s[0].getContext("2d"),{type:"agnDoughnut",data:{labels:t,datasets:[{data:i,backgroundColor:n,borderWidth:0}]}})}})}function n(){if(!u.exists()||!r()){return}Chart.getChart(u)?.destroy();const o=[];const a=[];const l=[];const c=[];$.get(AGN.url("/push/ajaxGetGlobalProgressStatistic.action"),{dateMode:$("#periodType").val(),selectMonth:$("#selectMonth").val(),selectYear:$("#selectYear").val(),startDay:$("#startDay").val(),endDay:$("#endDay").val()}).done(e=>{if(e&&e.warning&&e.warning.length>0){AGN.Lib.JsonMessages(e,true)}else{for(const i in e){const n=e[i];for(const r in n){if(i==0&&r!="time"){if(a.length==0){a.push(r)}else if(l.length==0){l.push(r)}else if(c.length==0){c.push(r)}}const s=n[r];if(r=="time"){o.push(s)}else if(r==a[0]){a.push(s)}else if(r==l[0]){l.push(s)}else if(r==c[0]){c.push(s)}}}const t=d(o.length);new Chart(u[0].getContext("2d"),{type:"line",data:{labels:o,datasets:[{label:a[0],data:a.slice(1),borderColor:u.css("--chart-very-dark-blue-color"),backgroundColor:u.css("--chart-very-dark-blue-color"),pointRadius:t},{label:l[0],data:l.slice(1),borderColor:u.css("--chart-blue-color"),backgroundColor:u.css("--chart-blue-color"),pointRadius:t},{label:c[0],data:c.slice(1),borderColor:u.css("--chart-light-cyan-color"),backgroundColor:u.css("--chart-light-cyan-color"),pointRadius:t}]},options:{scales:{x:{ticks:{maxRotation:0}},y:{min:0}},interaction:{mode:"index",intersect:false},stacked:false,plugins:{legend:{position:"bottom"},datalabels:{display:false}}}})}})}function r(){if($("#periodType").val()!=="RANGE"){return true}const e=$("#startDay");const t=$("#endDay");if(!e.val()||!t.val()||o(e).getTime()>o(t).getTime()){AGN.Lib.Messages.alert("error.statistic.period_format");return false}return true}function o(e){const t=e.datepicker("option","dateFormat");return $.datepicker.parseDate(t,e.val())}function d(e){if(e<60){return 5}if(e<100){return 4}return 3}function a(e,t){return parseFloat(e).toFixed(t)*1}});AGN.Lib.Controller.new("notification-list",function(){this.addAction({click:"send-update-notification"},function(){$.post(this.el.attr("href")).done(e=>AGN.Lib.JsonMessages(e.popups,true))})});AGN.Lib.Controller.new("notification-schedule",function(){let t;let i;let n;let r;this.addDomInitializer("notification-schedule",function(){const e=this.el.closest(".tile");t=e.find("#startDate");i=e.find("#endDate");n=e.find("#startTime");r=e.find("#endTime");t.on("change",s);n.on("change",s);i.on("change",d);r.on("change",d)});function s(){const e=o();i.unbind("change");if(e){const t=u(e);l(e,t);a(t);c(n.val())}else{l(0,null);a(null);c(null)}i.on("change",d)}function e(){const e=o();if(e){l(e,u(e))}else{l(0,null)}}function o(){return t.datepicker("getDate")}function a(e){i.datepicker("setDate",e)}function l(e,t){i.datepicker("option",{minDate:e,maxDate:t})}function c(e){r.val(e)}function u(e){const t=new Date(e);t.setDate(t.getDate()+28);return t}function d(){i.unbind("change");r.unbind("change");t.unbind("change");t.on("change",e);n.unbind("change");n.on("change",e)}});AGN.Lib.Controller.new("notification-settings",function(){let u;let t;this.addDomInitializer("notification-settings",function(){t=this.config.previewDisabledMsg;if(Notification.permission=="denied"){n()}});this.addAction({click:"preview"},function(){if(Notification.permission!="granted"){Notification.requestPermission(e=>{if(e=="granted"){i()}else if(e=="denied"){n()}})}else{i()}});function i(){const e=new Notification($("#pushTitle").val(),{body:$("#pushContent").val(),icon:$("#pushIcon").val()});e.onclick=e=>{e.preventDefault();window.open($("#pushLink").val(),"_blank")}}function n(){const e=$("#preview-option");e.parent().attr("data-tooltip",t);e.addClass("disabled");AGN.runAll(e.parent())}this.addDomInitializer("notification-stats",function(){u=$(".chart-timeline__handle");$.get(AGN.url(`/push/${this.config.pushId}/ajaxStatistic.action`)).done(e=>{r(e["common"]);s(e["viewsclicks"])})});function r(e){const t=$("#common-stat-chart");new Chart(t[0].getContext("2d"),{type:"bar",data:{labels:Object.keys(e),datasets:[{data:Object.values(e),backgroundColor:t.css("--chart-blue-color"),categoryPercentage:.9,minBarLength:2}]},options:{indexAxis:"x",layout:{padding:{top:20,right:0}},scales:{x:{ticks:{autoSkip:false,maxRotation:90}},y:{display:false}},plugins:{legend:{display:false},datalabels:{anchor:"end",align:"end",offset:-5}}}})}function s(e){if(!e.length){$("#progress-chart-block").addClass("hidden");return}const t=[];const i=[];const n=[];for(const l in e){const c=e[l];for(const u in c){if(c.hasOwnProperty(u)){if(l==0&&u!="time"){if(i.length==0){i.push(u)}else if(n.length==0){n.push(u)}}if(u=="time"){t.push(c[u])}else if(i[0]==u){i.push(c[u])}else if(n[0]==u){n.push(c[u])}}}}const r=p(t.length);const s=$("#progress-chart");const o=$("#progress-chart-minimap");const a=[{label:i[0],data:i.slice(1),borderColor:s.css("--chart-very-dark-blue-color"),backgroundColor:s.css("--chart-very-dark-blue-color"),pointRadius:r},{label:n[0],data:n.slice(1),borderColor:s.css("--chart-violet-color"),backgroundColor:s.css("--chart-violet-color"),pointRadius:r}];new Chart(s[0].getContext("2d"),{type:"line",data:{labels:t,datasets:a},options:{scales:{x:{type:"time",min:t[0],max:t[t.length-1],time:{unit:"day",displayFormats:{day:"yyyy-MM-dd hh:mm"},tooltipFormat:"yyyy-MM-dd hh:mm"},ticks:{autoSkip:true,maxRotation:0}},y:{min:0}},interaction:{mode:"index"},plugins:{legend:{position:"bottom"},datalabels:{display:false},zoom:{pan:{enabled:true,onPan:d,mode:"x"},limits:{x:{min:new Date(t[0]).getTime(),max:new Date(t[t.length-1]).getTime(),minRange:1}},zoom:{enabled:true,wheel:{enabled:true},pinch:{enabled:true},mode:"x",onZoom:d}}}}});new Chart(o[0].getContext("2d"),{type:"line",data:{labels:t,datasets:a.map(e=>({...e,pointRadius:0,borderWidth:.8}))},options:{scales:{x:{display:false},y:{display:false}},plugins:{legend:{display:false},datalabels:{display:false},tooltip:{external:null}}}})}function d({chart:e}){if(!e.timelineInitialized){e.timelineInitialized=true;h(e)}const{labels:t}=e.config.data;const{min:i,max:n}=e.scales["x"];const r=new Date(t[0]).getTime();const s=new Date(t[t.length-1]).getTime();const o=(i-r)/(s-r)*100;const a=(n-r)/(s-r)*100;const l=o>0?Math.min(o,98):0;const c=a<100?Math.max(a,2):100;u.prev().css("width",`${l}%`);u.css("left",`${l}%`);u.css("width",`${c-l}%`);u.next().css("width",`${100-c}%`)}function h(r){const e=new Hammer.Manager(u[0]);e.add(new Hammer.Pinch);e.add(new Hammer.Pan({threshold:10}));let s=0;let o=0;const t=e=>{const t=e.deltaX-s;const i=e.deltaY-o;s=e.deltaX;o=e.deltaY;const n=Math.max(parseFloat(u[0].style.width)/100,.1);r.pan({x:-t/n})};e.on("panstart",e=>{s=0;o=0;t(e)});e.on("panmove",t)}function p(e){if(e<60){return 5}if(e<100){return 4}return 3}});AGN.Lib.Controller.new("profile-field-view",function(){let n;let r;this.addDomInitializer("profile-field-view",function(){r=$("#fixed-values-container");n=this.config.fieldType;t(this.config.fixedValues??[])});this.addAction({click:"delete-fixed-value"},function(){this.el.closest("[data-fixed-value-row]").remove()});this.addAction({click:"add-fixed-value"},function(){const e=this.el.closest("[data-fixed-value-row]");const t=e.find('[name="allowedValues"]').val();e.remove();i(false,t);i(true)});this.addAction({change:"change-field-type"},function(){n=this.el.val();const e=AGN.Lib.Form.get(this.el).getValues("allowedValues");t(e)});function t(e){r.empty();_.each(e,e=>{if(e.trim()!==""){i(false,e)}});i(true)}function i(e,t=""){const i=AGN.Lib.Template.dom("fixed-value-row",{isLastRow:e,value:t,fieldType:n});r.append(i);AGN.Lib.Form.get(r).initFields();AGN.runAll(i)}});AGN.Lib.Controller.new("recipient-duplicates-list",function(){this.addAction({"table-column-manager:apply":"save-selected-columns"},function(){const t=this.data.columns;$.ajax({type:"POST",url:AGN.url("/recipient/duplicate/setSelectedFields.action"),traditional:true,data:{selectedFields:t}}).done(e=>{if(e.success){AGN.Lib.WebStorage.extend("recipient-duplicate-overview",{fields:t})}AGN.Lib.JsonMessages(e.popups)})})});AGN.Lib.Controller.new("recipient-import-errors-edit",function(){this.addDomInitializer("recipient-import-errors-edit",function(){if(e()){AGN.Lib.Page.reload(AGN.url("/recipient/import/chooseMethod.action?cancelImport=true"))}else{window.onbeforeunload=function(){return"If you leave the page, the import will be canceled automatically!"}}});function e(){if(typeof performance==="undefined"||typeof performance.getEntriesByType!=="function"){return false}const e=performance.getEntriesByType("navigation");if(e.length>0){return e[0].type==="reload"}return false}this.addAction({submitted:"save-errors"},function(){t()});this.addAction({click:"ignore-errors"},function(){t();AGN.Lib.Confirm.request(AGN.url("/recipient/import/errors/ignore.action"))});function t(){window.onbeforeunload=null}});AGN.Lib.Controller.new("recipient-import-view",function(){this.addAction({click:"delete-file"},function(){$.post(AGN.url("/recipient/import/file/delete.action")).done(()=>{this.el.parent().remove();$("#import-file").prop("disabled",false).parent().removeClass("hidden")})});this.addDomInitializer("recipient-import-view",function(){const e=this.config.attachmentCsvFileID;if(e>0){$("#useCsvUpload").prop("checked",true).trigger("change")}})});AGN.Lib.Controller.new("recipient-insights",function(){const r=.01;const s="< 1";const i=.001;const n={HIGH_PERFORMER:"#4FB102",OPPORTUNITY:"#0ACD70",LEAD:"#C2C2C2",SLEEPER:"#E12E59"};let o;let h;this.addDomInitializer("recipient-insights",function(){o=this.config.customerId;const e=this.config.insightsData;$.i18n.load(this.config.translations);c(e.weekdayReactionRankData);u(e.hourReactionRankData);d(e.reactionDeviceRankData);p(e.reactionsInProgressData);f(e.mailingReactionPercentageData);m(e.pageImpressionsData);v(e.customerRevenueData);y(e.customerPerformanceData)});this.addAction({change:"selectReactionProgressPeriod"},function(){const e=this.el;const t=e.find("option:selected");let i,n;switch(e.val()){case"YEAR":case"MONTH":i=t.data("min");n=t.data("max");break;case"CUSTOM":const r=l();i=r.min;n=r.max;break;default:console.error(`Unexpected period type: '${e.val()}'`);return}a(i,n)});this.addAction({change:"period-select"},function(){const e=l();a(e.min,e.max)});function a(e,t){if(e&&t){$.ajax(AGN.url("/insights/reactionsInProgress.action"),{type:"GET",data:{customerId:o,min:e,max:t}}).done(e=>p(e))}}function l(){return{min:$("#reactionProgressMinDate").val(),max:$("#reactionProgressMaxDate").val()}}function c(i){i=e(i);const n=Math.max(...i.values);const r=$("#days-reaction-chart");new Chart(r[0].getContext("2d"),{type:"bar",data:{labels:t("date.weekdaysShort"),datasets:[{data:i.values,backgroundColor:e=>{const t=i.values[e.dataIndex]===n;return r.css(t?"--chart-very-dark-blue-color":"--chart-blue-color")},categoryPercentage:.9,minBarLength:2}]},options:{indexAxis:"x",layout:{padding:{top:20,right:0}},scales:{x:{ticks:{autoSkip:false,maxRotation:90}},y:{display:false}},plugins:{legend:{display:false},datalabels:{anchor:"end",align:"end",offset:-5,formatter:(e,t)=>i.percentages[t.dataIndex]+"%"},tooltip:{position:"nearest",callbacks:{label:e=>t("daysWithReactions")+": "+e.formattedValue}}}}})}function u(i){i=e(i);const n=Math.max(...i.values);const r=$("#reaction-hour-chart");new Chart(r[0].getContext("2d"),{type:"bar",data:{labels:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],datasets:[{data:i.values,backgroundColor:e=>{const t=i.values[e.dataIndex]===n;return r.css(t?"--chart-very-dark-blue-color":"--chart-blue-color")},categoryPercentage:.5,minBarLength:2}]},options:{indexAxis:"x",layout:{padding:{top:20,right:0}},scales:{x:{ticks:{autoSkip:true,maxRotation:0}},y:{display:false}},plugins:{legend:{display:false},datalabels:{anchor:"end",align:"end",offset:-5,display:"auto",formatter:(e,t)=>i.percentages[t.dataIndex]+"%"},tooltip:{callbacks:{label:e=>t("reactionTimes")+": "+e.formattedValue}}}}})}function e(e){const t=Object.values(e.values);const i=Object.entries(e.percentages).map(([e,t])=>t);return{values:t,percentages:i}}function d(e){const i=$("#reaction-device-chart");const n=[i.css("--chart-very-dark-blue-color"),i.css("--chart-dark-blue-color"),i.css("--chart-blue-color"),i.css("--chart-light-blue-color"),i.css("--chart-light-cyan-color")];const r=[];const s=[];$.each(e,function(e,i){r.push(i.value);s.push(t(i.deviceClass))});new Chart(i[0].getContext("2d"),{type:"agnDoughnut",data:{labels:s,datasets:[{data:r,backgroundColor:n,borderWidth:0}]}})}function p(n){if(h){h.destroy()}const e=$("#reaction-progress-chart");const i=[];const r=[];const s=[];const o=[];let a=false;let l=false;$.each(n.values,(e,t)=>{i.push(e);r.push(t.reactions);s.push(t.impressions);o.push(t.revenues);if(t.impressions>0){a=true}if(t.revenues>0){l=true}});const c=i.length;let u=3;if(c<60){u=5}else if(c<100){u=4}const d={type:"line",data:{labels:i,datasets:[{label:t("statistic.reactions"),data:r,borderColor:e.css("--chart-very-dark-blue-color"),backgroundColor:e.css("--chart-very-dark-blue-color"),pointRadius:u}]},options:{scales:{x:{ticks:{maxRotation:0}},y:{display:false}},interaction:{mode:"index",intersect:false},stacked:false,plugins:{legend:{position:"bottom"},datalabels:{display:false},tooltip:{callbacks:{title:function(e){const t=e[0].label;const i=n.values[t].mailingIds;if(i.length){return n.mailingNames[i[0]]+" "+t}return t}}}}}};if(a){d.data.datasets.push({label:t("statistic.impressions"),data:s,borderColor:e.css("--chart-blue-color"),backgroundColor:e.css("--chart-blue-color"),pointRadius:u})}if(l){d.data.datasets.push({label:t("statistic.revenue"),data:o,borderColor:e.css("--chart-dark-blue-color"),backgroundColor:e.css("--chart-dark-blue-color"),pointRadius:u})}h=new Chart(e[0].getContext("2d"),d)}function f(e){b("#reactionTypeKpi",e.percentage.percentage);$("#reactionGradeIcon").css("color",g(e.grade))}function g(e){return n[e]||"inherit"}function m(e){b("#impressionsByClickKpi",e.perClick);b("#impressionsByVisitKpi",e.perVisit);b("#impressionsByBuyKpi",e.perBuy)}function v(e){b("#revenueSumKpi",e.value);b("#revenueAvgKpi",e.average)}function y(e){if(e.clicks.percentage>0){b("#performanceClicksKpi",e.clicks.percentage)}else{b("#performanceClicksKpi",e.clicks.value>0?i:0)}b("#performanceRevenueKpi",e.revenue)}function b(e,t){const i=$(e);const n=i.find("[data-kpi-value]");if(t>0){if(t<r){n.text(s)}else{let e="";if(n.is("[data-kpi-sign]")){e=" "+n.data("kpi-sign")}n.text(`${t.toFixed(2)}${e}`)}}}});AGN.Lib.Controller.new("recipient-list",function(){const e=AGN.Lib.Action,t=AGN.Lib.Messages,i=AGN.Lib.Form,n=AGN.Lib.Storage;const r="-1";const s="#targetgroup-querybuilder";const o=["firstname","lastname","email","gender"];let a;let l={};let c=false;e.new({"qb:invalidrules":s},function(){t.alert("querybuilder.errors.invalid_definition")});this.addDomInitializer("recipient-list",function(){a=$(s);l=$.extend({},JSON.parse(this.config.initialRules));if(!this.config.forceShowAdvancedSearchTab){n.restoreChosenFields(p())}u();g();a.on("afterClear.queryBuilder",()=>d(true));a.on("change afterReset.queryBuilder afterDeleteGroup.queryBuilder afterDeleteRule.queryBuilder afterSetRules.queryBuilder afterUpdateRuleFilter.queryBuilder",()=>d())});this.addAction({change:"toggle-filter"},function(){u();n.saveChosenFields(this.el)});this.addAction({"table-column-manager:apply":"save-selected-columns"},function(){const t=this.data.columns;$.ajax({type:"POST",url:AGN.url("/recipient/setSelectedFields.action"),traditional:true,data:{selectedFields:t}}).done(e=>{if(e.success){AGN.Lib.WebStorage.extend("recipient-overview",{fields:t})}AGN.Lib.JsonMessages(e.popups)})});function u(){const e=h();$("#basic-filters-block").toggleClass("hidden",e);$("#filter-query-builder-block").toggleClass("hidden",!e);d()}function d(e=false){$("#target-group-save-button").toggleClass("hidden",e||!h()||!S())}function h(){return p().is(":checked")}function p(){return $("#use-advanced-filter")}this.addAction({click:"create-new-target"},function(){x()?.clearErrors();if(f()){AGN.Lib.Confirm.createFromTemplate({rules:$("#queryBuilderRules").val()},"new-targetgroup-modal").done(e=>y().updateHtml(e))}});function f(e=false){const t=$.Event("qb:validation");a.trigger(t,{ignore_qb_validation:false,skip_empty:e});return!t.isDefaultPrevented()}this.addAction({change:"change-mailinglist-id"},g);function g(){const e=T("mailinglist").val();const t=e===r;T("type").prop("disabled",t);T("status").prop("disabled",t)}this.addAction({enterdown:"search-recipient"},function(){c=true});this.addAction({validation:"search-recipient"},function(){if(c){const e=this.data;this.data=_.merge({},e,{ignore_qb_validation:false,skip_empty:false})}else if(this.data&&this.data.ignore_qb_validation){m()}});function m(){const e=x();if(e){e.clearErrors();e.setRules(l);A()}}this.addAction({submission:"search-recipient"},function(){if(c){b();v({ignore_qb_validation:false})}});this.addAction({click:"search"},function(){if(!h()){b()}v({ignore_qb_validation:false})});function v(e){const t=y();t.setActionOnce(AGN.url("/recipient/search.action"));t.submit("",_.merge({ignore_qb_validation:true,skip_empty:true},t.validatorOptions,e))}function y(){return i.get($("#recipients-overview"))}function b(){const e=o.map(e=>{const t=C(e);const i=t==="string"?"contains":"equal";let n=T(e).val().trim();if(t==="number"&&n!==""){n=Number(n)}return{id:e,value:n,operator:i}});return w(e,true)}function C(e){const t=x().getFilterById(e).type;return $.fn.queryBuilder.constructor.types[t]}function w(e,n){const r=x();if(!r){return false}return e.reduce((e,t)=>{const i=r.getRules({allow_invalid:true,skip_empty:true});if(!t.id){return e}if(typeof t.value==="number"||t.value){return r.setOrReplaceRule(i,t,n)===true||e}return r.deleteRuleByField(null,t.id,n)===true||e},false)}function A(){const t=E();_.each(o,e=>T(e).val(t[e]))}function E(e=o){const i=x();const n={};if(i){const r=i.getRules({allow_invalid:true,skip_empty:true});e.forEach(e=>{const t=i.findRuleByField(r,e,true);n[e]=t?.value||""})}return n}function S(){const e=x();return e?e.containsNotEmptyRule():false}function T(e){return $(`#filter-${e}`)}function x(){return a.prop("queryBuilder")}});AGN.Lib.Controller.new("recipient-statistics-view",function(){const n=AGN.Lib.Form;this.addAction({change:"type-change"},function(){const e=this.el;const t=e.find("option:selected");const i=$("#mailinglist-select");if(t.is("[data-mailinglist-required]")&&i.val()==="0"){AGN.Lib.Select.get(i).selectNext()}n.get(e).submit()});this.addAction({change:"change-period"},function(){n.get(this.el).submit()})});AGN.Lib.Controller.new("recipient-view",function(){const n="OK";const r="USED";const s="BLACKLISTED";const o=AGN.Lib.Form;let a;this.addDomInitializer("recipient-view",function(){const i=o.get(this.el);a=new c(AGN.url(`/recipient/${this.config.id}/checkAddress.action`),e=>{switch(e.status){case n:i.cleanFieldError("email");break;case r:i.showFieldError("email",AGN.Lib.Template.text("duplicated-email-block",e),true);break;case s:i.showFieldError("email",t("error.isBlacklisted"),true);break}});$("#recipient-email").on("change input",_.debounce(function(){a.check($(this).val())},300));e()});function e(){$(".not-allowed-usertype").each(function(){const e=$(this);if(e.prop("selected")){e.parent("select").prop("disabled",true)}else{e.prop("disabled",true)}})}this.addAction({submission:"recipient-save"},function(){const i=o.get(this.el);const e=$("#recipient-email").val();this.event.preventDefault();const n=()=>{$.post(AGN.url("/recipient/checkAltgMatch.action"),i.params()).done(e=>{if(e.popups&&e.popups.alert&&e.popups.alert.length>0){AGN.Lib.JsonMessages(e.popups)}else if(!e.success||e.success.length===0){l(t("recipient.hide.question"),()=>{i.setActionOnce(AGN.url("/recipient/saveAndBackToList.action"));i.submit()})}else{i.submit()}}).fail(()=>i.submit())};if(a&&e&&e.trim()){a.jqxhr(e.trim()).done(e=>{if(e.isBlacklisted===true){l(t("recipient.blacklisted.question"),()=>{if(e.inUse===true){l(t("recipient.duplicate.question"),n)}else{n()}})}else if(e.inUse===true){l(t("recipient.duplicate.question"),n)}else{n()}}).fail(n)}else{n()}});function l(e,t){return AGN.Lib.Confirm.from("recipient-confirmation-modal",{question:e}).done(t)}this.addAction({change:"activate-mediatype"},function(){const e=this.el.data("mediatype");const t=this.el.is(":checked");this.el.closest("[data-mailinglist-tile]").find(`.icon-mediatype-${e}`).toggleClass("text-primary",t);this.el.closest(".tile").find("[data-binding-usertype]").prop("disabled",!t)});this.addAction({focusout:"hide-datasource-popover"},function(){AGN.Lib.Popover.hide(this.el)});class c{constructor(e,t){this.url=e;this.running=false;this.callback=$.isFunction(t)?t:$.noop;this.lastAddress=null;this.lastResult=null;this.scheduledCheck=null}jqxhr(e){return $.get(this.url,{email:e})}scheduleCheck(t){if(this.scheduledCheck){clearTimeout(this.scheduledCheck)}if(this.running){this.scheduledCheck=setTimeout(()=>this.scheduleCheck(t),300)}else{this.running=true;this.lastAddress=null;this.lastResult=null;try{this.jqxhr(t).always(()=>this.running=false).done(e=>{this.lastAddress=t;this.lastResult={status:e.isBlacklisted===true?s:e.inUse===true?r:n,recipientID:e.existingRecipientId||0};this.report()})}catch(e){this.running=false}}}check(e){e=e?.trim()||"";if(!e){this.report(n)}else if(this.lastAddress===e){this.report()}else{this.scheduleCheck(e)}}report(e){if(arguments.length){this.callback.call(null,e)}else{if(this.lastAddress){this.report(this.lastResult)}}}}});AGN.Lib.Controller.new("reference-table-export",function(){let t;let i;this.addDomInitializer("reference-table-export",function(){t=$("#export-time-period-block");i=$("#period-type");e(true)});this.addAction({change:"update-period-type"},function(){e()});function e(e=false){t.html(AGN.Lib.Template.text("referente-table-export-time-period",{type:i.val(),initial:e}))}});AGN.Lib.Controller.new("reference-table-list",function(){this.addAction({click:"bulk-delete"},function(){const n=AGN.Lib.Table.get(this.el)?.api;const r=n.getSelectedRows();const s=r.map(e=>e.id);e(s,this.el.attr("href")).done(e=>{if(s.length>1){const t=e.data;const i=r.filter(e=>t.includes(e.id));n.applyTransaction({remove:i});AGN.Lib.JsonMessages(e.popups,true)}else{n.applyTransaction({remove:r});AGN.Lib.RenderMessages($(e))}})});function e(e,t,i=true){const n=$.Deferred();if(e&&e.length){const r=$.ajax(t,{method:"GET",traditional:true,data:{ids:e}}).done(e=>{if(e){AGN.Lib.RenderMessages($(e))}}).fail(()=>n.reject());AGN.Lib.Confirm.request(r).then(n.resolve,n.reject)}else{n.reject();AGN.Lib.Messages.alert("messages.error.nothing_selected")}return n.promise()}});AGN.Lib.Controller.new("salutation-view",function(){const s=AGN.Lib.Select;let o;let a;let l;let c;let e;this.addDomInitializer("salutation-view",function(){o=$("#recipient");e=this.config.id;a=this.config.AGN_TAG_TITLE;l=this.config.AGN_TAG_TITLE_FIRST;c=this.config.AGN_TAG_TITLE_FULL;t()});this.addAction({change:"switch-salutation",input:"switch-salutation"},()=>t());function t(){$("#salutation-preview").text(i()+",");$("#copy-salutation").data("copyable-value",`[${u()} type='${e}']`)}function u(){return $("#agnTag").val()}function i(){const{title:e,firstname:t,lastname:i,gender:n}=s.get(o).$findOption(o.val()).data();const r=$(`[name="genderMapping[${n}]"]`).val();switch(u()){case a:return`${r} ${e?`${e} `:""}${i}`;case l:return`${r} ${t}`;case c:return`${r} ${e?`${e} `:""}${t} ${i}`;default:return""}}});AGN.Lib.Controller.new("side-menu",function(){const e=AGN.Lib.WebStorage;let i;let n=true;this.addDomInitializer("side-menu",function(){n=!!window.matchMedia("(pointer: fine)").matches;i=n?400:0});this.addAction({click:"switch-to-classic-design"},function(){const e=this.el;const t=e.parent().parent().find(".sidebar__tooltip");r(t,this.event,()=>{$.post(AGN.url("/ui-design/switch.action")).done(()=>{e.prop("disabled",true);window.setTimeout(()=>AGN.Lib.Page.reload(e.data("switch-url")),500)}).fail(()=>e.prop("checked",!e.prop("checked")))})});this.addAction({click:"logout"},function(){const e=this.el.find(".sidebar__tooltip");r(e,this.event,()=>AGN.Lib.Form.get($("#logoutForm")).submit("static"))});this.addAction({click:"open-account-data"},function(){const e=this.el.find(".sidebar__tooltip");r(e,this.event,()=>AGN.Lib.Page.reload(AGN.url(this.el.data("url"))))});this.addAction({click:"open-help"},function(){const e=this.el.find(".sidebar__tooltip");r(e,this.event,AGN.Lib.Helpers.openHelpModal)});function r(e,t,i){if(!n&&!e.hasClass("open")){s(e);t.preventDefault()}else{i()}}this.addAction({mouseenter:"display-tooltip"},function(){if(n){const e=this.el.find(".sidebar__tooltip");s(e)}});function s(e){a(e);clearTimeout(e.data("closeTimerId"));e.addClass("open")}this.addAction({mouseleave:"display-tooltip"},function(){const e=this.el.find(".sidebar__tooltip");e.data("closeTimerId",setTimeout(()=>t(e),i))});this.addAction({mouseenter:"activateSubmenu"},function(){if(!n){return}o(this.el)});this.addAction({click:"activateSubmenu"},function(){const e=this.el.find(".menu-item").next(".submenu");if(e.hasClass("open")){const t=$(this.event.target).closest("a");if(t.exists()&&!t.is("[data-confirm]")){AGN.Lib.Page.reload(t.attr("href"))}}else{o(this.el)}});function o(e){const t=e.find(".menu-item");const i=t.next(".submenu");const n=i.find(".submenu-items-container");a(i);clearTimeout(t.data("closeTimerId"));i.addClass("open");c(i,t);n.addClass("open")}this.addAction({mouseleave:"activateSubmenu"},function(){const e=$(this.el).find(".menu-item");const t=e.next(".submenu");e.data("closeTimerId",setTimeout(()=>l(t),i))});function a(e){$(".sidebar__tooltip.open").not(e).each(function(){t($(this))});$(".submenu.open").not(e).each(function(){l($(this))})}function t(e){e.removeClass("open")}function l(e){e.removeClass("open");e.find(".submenu-items-container").removeClass("open")}function c(e,t){const i=$(window);const n=e.find(".submenu-header");const r=parseInt(t.parent().parent().css("gap"));let s=t.scrollTop()+t.offset().top+t.outerHeight()/2-n.outerHeight()/2-r;const o=e.outerHeight();if(s+o>i.height()+i.scrollTop()){s=i.height()+i.scrollTop()-o-r}if(s-i.scrollTop()<0){s=i.scrollTop()}e.offset({top:s,left:e.offset().left})}});AGN.Lib.Controller.new("help-center",function(){const i=AGN.Lib.Form;const n=AGN.Lib.JsonMessages;const r=AGN.Lib.Template;const e=AGN.Lib.Helpers;const t=()=>{window.hmNavigationFrame=true;window.lazysync=e=>{const t=document.getElementById("manual-iframe").contentWindow;if(t.hmForceRedirect&&t.location&&t.location.href){t.location.href="index.html?"+e}}};t();this.addDomInitializer("help-center",function(){$("[data-help-tab]").on("help-tab:open",function(e,t){const i=$(this);const n=i.data("help-tab");if(n==="support"){l(t.type,t.opts)}if(!i.is(".active")){i.trigger("click")}})});this.addDomInitializer("support-chat",function(){const e=$("#support-chat-tab");o(this.config.initialMessage,true);let t;e.on("form:loadershow",()=>{if(!t){t=s()}});e.on("form:loaderhide",()=>{t.remove();t=null})});this.addAction({submission:"send-message"},function(){const e=$("#support-message");const t=e.val();if(t.length){o(t);i.get(this.el).jqxhr().done(e=>{n(e.popups);if(e.success){o(e.data,true)}});e.val("")}});function s(){const e=r.dom("support-chart-typing-msg");return a(e)}function o(e,t=false){const i=r.dom(t?"support-chart-incoming-message":"support-chart-outgoing-message",{text:e});return a(i)}function a(e){const t=$("#support-chat-tab").find(".chat-content");const i=t.prop("scrollHeight");t.append(e).scrollTop(i);return e}this.addDomInitializer("support",function(){l()});this.addDomInitializer("help-center-docs",function(){const e=this.config.manuals;const t=this.config.translations;e.flatMap(e=>e.files).forEach(e=>{e.link=`manual/${e.lang}/pdf/${e.name}`;e.btnMsgKey=t.download+" "+e.lang.toUpperCase()});$("#help-center-docs-tab").html(r.dom("help-center-docs",{manuals:e}))});this.addAction({submission:"send-support-request"},function(){this.event.preventDefault();i.get(this.el).submit()});this.addAction({submitted:"send-support-request"},function(){n(this.data.popups)});function l(e,t){const i=$("#help-center-support-tab");const n={supportType:e||"",subject:"",subjectChangeable:true,page:c()};i.html(r.text("help-center-support",_.merge({},n,t)));AGN.Lib.CoreInitializer.run(["select","growing-textarea","char-counter"],i)}function c(){var e=window.location;var t=[".action",".do"];var i,n,r;if(e.origin&&e.pathname){var s=(e.pathname+"").replace(/;jsessionid=[a-z0-9]+/i,"");for(i=0;i<t.length;i++){n=t[i];r=s.indexOf(n);if(r>0){s=s.substring(0,r+n.length)}}return e.origin+s+e.search+e.hash}else{var o=(e.href+"").replace(/;jsessionid=[a-z0-9]+/i,"");for(i=0;i<t.length;i++){n=t[i];r=o.indexOf(n);if(r>0){var a=r+n.length;var l=o.indexOf("?",a);if(l<0){l=o.indexOf("#",a)}if(l>0){return o.substring(0,a)+o.substring(l)}else{return o.substring(0,a)}}}}return o}});AGN.Lib.Controller.new("system-status",function(){this.addAction({click:"cancel-imports"},function(){AGN.Lib.Confirm.createFromTemplate({},"cancel-running-imports-modal").done(()=>{$.post(AGN.url("/serverstatus/killRunningImports.action")).fail(()=>AGN.Lib.Messages.defaultError())})})});AGN.Lib.Controller.new("target-create-mailinglist",function(){this.addAction({click:"select-mediatype"},function(){var e=this.el.closest("form");var t=e.find("#createMailinglistOkBtn");if(!e.find('input:checked[name="mediatypes"]').length){t.attr("disabled","disabled")}else{t.removeAttr("disabled")}})});AGN.Lib.Controller.new("target-group-view",function(e){const n=AGN.Lib.Form;const t=AGN.Lib.ScheduleTimeTable;const i=AGN.Lib.ScheduleTimeTable.PeriodRow;let r;AGN.Lib.Action.new({"qb:invalidrules":"#targetgroup-querybuilder"},function(){AGN.Lib.Messages.alert("querybuilder.errors.general")});this.addDomInitializer("target-group-view",function(){if(this.config.errorPositionDetails){s(this.config.errorPositionDetails)}});this.addAction({change:"toggle-editor-tab"},function(){const e=this.el;const t=e.is(":checked");const i=n.get(e);if(!i.validate({skip_empty:true})){e.prop("checked",!t);return false}i.setValueOnce("viewFormat",t?"EQL":"QUERY_BUILDER");i.submit("",{skip_empty:true})});this.addAction({submission:"save-target"},function(){n.get(this.el).submit(this.el.data("submit-type")).done(e=>{if(typeof e=="object"&&!e.success){s(e.data);AGN.Lib.JsonMessages(e.popups)}})});function s(e){const t=AGN.Lib.Editor.get($("#eql")).editor;t.focus();t.gotoLine(e.line,e.column)}this.addDomInitializer("target-scheduler-init",function(){r?.clean();r=new t($("#target-scheduler-block"));let e=[];if(this.config.intervalAsJson){e=JSON.parse(this.config.intervalAsJson).map(e=>i.deserialize(e))}if(e.length===0){r.addEmptyPeriodRow()}else{e.forEach(e=>r.addRow(e))}n.get(this.el).initFields()});this.addAction({click:"activate-schedule"},function(){const e=this.el.attr("href");const t=r.getSubmissionJson("period");$.post(e,{intervalAsJson:t}).done(e=>AGN.Lib.Page.render(e))})});AGN.Lib.Controller.new("temp-file",function(){const i=AGN.Lib.Form;let e;this.addAction({"upload:add":"show-upload-file-form"},function(){if(e){return}e=true;$.ajax({url:AGN.url("/upload/new.action"),type:"GET",async:false,success:e=>{AGN.Lib.Page.render(e);$(".modal").on("modal:close",r)}})});this.addAction({"upload:dropped":"addFilesToModal"},function(){n(this.data);e=false});function n(e){if(e.length>1){a(e);return}const t=$("#file-names");t.append(e[0].name)}function r(){$("#files").val("");$("#dropzone").trigger("upload:reset")}this.addAction({click:"save-file"},function(){const t=i.get(this.el);const e=t.submit();if(e){e.done(e=>{AGN.Lib.Modal.getWrapper(t.get$()).modal("hide");AGN.Lib.JsonMessages(e.popups)});$(".modal").hide()}});function s(){return[{field:"name",headerName:t("defaults.name"),filter:false,suppressMovable:true,cellRenderer:"NotEscapedStringCellRenderer"},{field:"size",headerName:t("defaults.size"),filter:false,suppressMovable:true,width:50,cellRenderer:"NotEscapedStringCellRenderer"}]}function o(e){return e.map(({name:e,size:t})=>({name:e,size:AGN.Lib.Helpers.formatBytes(t)}))}function a(e){const t=new AGN.Lib.Table(AGN.Lib.Template.dom("js-table-wrapper"),s(),o(e),{pagination:false});const i=$('<div class="col-12">').append(t.$el);t.$el.css({"--ag-rows-count":e.length,"max-height":"235px"});l().find(".row:first").prepend(i)}function l(){return $("#upload-form")}});AGN.Lib.Controller.new("template-css",function(){const n=AGN.Lib.Form;this.addAction({click:"saveCss"},function(){const e=n.get($("#gridTemplateForm"));const t=this.el.closest(".modal").find(`[name="templatesToUpdate"]`).val();const i=e.getValue("templateId");if(i){t.push(i)}e.setValueOnce("bulkIds",t);e.submit()})});AGN.Lib.Controller.new("mailing-trackable-links",function(){const e=this;const n=AGN.Lib.Form;var t;var i;var r;this.addDomInitializer("mailing-trackable-links",function(){i=this.config.KEEP_UNCHANGED;r=this.config.SAVE_ALL_URL;if(this.config.scrollToLinkId){s($(`#link-${this.config.scrollToLinkId}`))}});AGN.Lib.Action.new({change:"[id^=link-], #tile-trackableLinkEditAll"},function(){t=this.el.attr("id")});this.addAction({click:"save-bulk-actions"},function(){const i=n.get($("#trackableLinksForm"));const e=$("#bulkActionsForm").serializeFormDataObject();i._data={};$.each(e,function(e,t){i.setValue(e,t)});i.setValue("modifyAllLinksExtensions",false);o(AGN.Lib.InputTable.get("#bulkActionExtensions").collect(),i);i.setActionOnce(r);i.submit();AGN.Lib.Modal.getWrapper(this.el).modal("hide")});this.addAction({click:"save-all"},function(){this.event.preventDefault();const e=n.get($("#trackableLinksForm"));e._data={};e.setValue("modifyBulkLinksExtensions",false);a(e);o(AGN.Lib.InputTable.get("#link-common-extensions").collect(),e);e.setActionOnce(r);e.submit()});this.addAction({scrollTo:"scroll-to"},function(){if(t){s($(this.el).find("#"+t))}});function s(e){if(e&&e.length>0){const t=e.closest(".table-wrapper__body");if(t.exists()){const i=t.find(":first-child").offset().top;const n=e.offset().top;t.scrollTop(0);t.scrollTop(n-i)}}}this.addAction({click:"save-individual"},function(){this.event.preventDefault();const e=n.get($("#trackableLinkForm"));const t=AGN.Lib.InputTable.get("#individual-extensions").collect();o(t,e);e.submit()});this.addAction({change:"link-details-trackable"},function(){e.runInitializer("trackableAction")});this.addInitializer("trackableAction",function(e){const t=$('[data-action="link-details-trackable"] :selected');const i=$("#linkAction");i.prop("disabled",i.prop("disabled")||t.val()==0)});function o(e,i){_.each(e,function(e,t){i.setValue("extensions["+t+"].name",e.name);i.setValue("extensions["+t+"].value",e.value)})}function a(e){e.setValue("bulkUsage",i);e.setValue("bulkAction",i);e.setValue("bulkDeepTracking",i);e.setValue("bulkStatic",i)}});AGN.Lib.Controller.new("trackable-link",function(){var e=this;var t=new AGN.Lib.TrackableLinkExtensions;this.addDomInitializer("trackable-link-extensions",function(){t.load(this.config.extensions,$("#extensions tbody"))});this.addAction({click:"save"},function(){this.event.preventDefault();var e=AGN.Lib.Form.get($("#trackableLinkForm"));i(e);e.submit("static")});function i(i){_.each(t.collect(),function(e,t){i.setValue("extensions["+t+"].name",e.name);i.setValue("extensions["+t+"].value",e.value)})}this.addAction({change:"link-details-trackable"},function(){e.runInitializer("trackableAction")});this.addInitializer("trackableAction",function(e){var t=$('[data-action="link-details-trackable"] :selected');var i=$("#linkAction");i.prop("disabled",i.prop("disabled")||t.val()==0)})});AGN.Lib.Controller.new("user|groups-permissions",function(){let e;this.addDomInitializer("user|groups-permissions",function(){e=t(this.config);c(+a().first().attr("id").match(/\d+/)[0]);s()});function t(e){if(e.isSoapUser){return i(e)}return n(e)}function i(e){const t=e.permissions.map(e=>({...e,name:e.endpointName}));return[...t,...e.permissionGroups]}function n(e){return e.permissionCategories.map(function(e){return e.subCategories}).flatMap(function(e){return Object.values(e)}).flatMap(function(e){return e.permissions})}function o(e){return $(`#${e}-category-permissions`).find(".permission:not(.hidden)")}function r(){return $(".permission-categories__btn")}function s(){_.each(r(),function(e){const t=$(e);const i=t.data("category-index");const n=o(i);const r=n.length;const s=n.find('[role="switch"]:checked').length;$(`label[for="${i}-category-btn"] .permissions-counter`).text(`(${s}/${r})`);t.toggleClass("disabled",r<=0)})}function a(){return $('[id$="-category-permissions"]:visible')}function l(){$(`[id$="-category-permissions"]:visible .tile-body`).scrollTop(0)}function c(e){u(e);l(e);$('[id$="-category-btn"]').prop("checked",false);$(`#${e}-category-btn`).prop("checked",true);E()}function u(e){$('[id$="-category-permissions"]').hide();$(`#${e}-category-permissions`).show();w()}this.addAction({click:"change-category"},function(){c(this.el.data("category-index"))});function d(){e.filter(e=>m(e)).map(e=>$('[id="'+e.name+'"]').closest(".permission")).forEach(e=>e.removeClass("hidden"))}function h(){const e=r().not(".disabled");if(b().length>0||e.length<=0){return}c(+e.first().data("category-index"))}this.addAction({click:"apply-filter",enterdown:"handle-filter-enterdown"},function(){this.event.preventDefault();A();d();w();s();h();l();E()});function p(t){const e=$("#type-filter").val();if(!e?.length){return true}return e.some(e=>v(e)(t))}function f(e){const t=$("#name-filter").val().trim().toLowerCase();const i=$(`#${e.name.replaceAll(".","\\.")}`).parent().find("label").text().toLowerCase().trim();return!t||i.includes(t)}function g(e){const t=$("#right-filter").val()?.trim()?.toLowerCase();return!t||e.name.includes(t)}function m(e){return f(e)&&g(e)&&p(e)}function v(e){switch(e){case"granted":return function(e){return e.granted};case"grantedForUser":return function(e){return e.granted&&!e.showInfoTooltip};case"grantedByGroup":return function(e){return e.showInfoTooltip};case"grantable":return function(e){return!e.granted&&e.changeable};case"notGrantable":return function(e){return!e.granted&&!e.changeable};case"new":return function(e){return e.recent};default:return function(){return true}}}function y(){$(".permission_category-subcategory").show()}function b(){return a().find(".permission:visible")}function C(){const e=b().length<=0;$(".no-results-found").toggle(e)}function w(){y();$(".permission_category-subcategory").each(function(){return $(this).toggle($(this).find("li:visible").length>0)});C()}function A(){$(".permission").addClass("hidden")}function E(){a().find("[data-toggle-checkboxes]").trigger("update-toggle-all")}});AGN.Lib.Controller.new("userform-images",function(){const s=AGN.Lib.Modal;const o=AGN.Lib.Template;const a=AGN.Lib.Form;this.addAction({"upload:add":"image-upload"},function(){const e=this.data.file;const t=this.data.index;let i=$("#components-upload-modal");if(!i.exists()){i=s.fromTemplate("userform-images-upload-modal-template");i.on("modal:close",l)}const n=i.find("#components-uploads-container");const r=o.dom("userform-upload-image",{index:t,fileName:e.name,previewUrl:u(e),isArchive:c(e)==="zip"});n.append(r);a.get(i).initFields();AGN.runAll(r)});function l(){$("#upload-files").val("");$("#dropzone").trigger("upload:reset")}function c(e){if(e.name&&e.name.includes(".")){return e.name.substring(e.name.lastIndexOf(".")+1).toLowerCase()}return""}function u(e){if(/^image/.test(e.type)){return URL.createObjectURL(e)}return""}this.addAction({click:"upload-images"},function(){const e=a.get(this.el);const t=s.getWrapper(this.el);e.$form.on("submitted",()=>{if(document.contains(t[0])){t.css("opacity",1)}});e.submit();t.css("opacity",0)})});AGN.Lib.Controller.new("userform-view",function(){var c=AGN.Lib.FormBuilder.FormBuilder;var u=AGN.Lib.Editor;var o=AGN.Lib.Confirm;var i;let n=0;this.addDomInitializer("userform-view",function(){var e=this.config;i=e.actionURLPattern;n=e.formId;$("#userFormForm").dirty()});this.addAction({click:"activate-and-test"},function(){const t=this.el;const i=t.attr("href");o.createFromTemplate({},"userform-activate-and-test").done(()=>{$.post(AGN.url(`/webform/${n}/activate.action`)).done(e=>{AGN.Lib.JsonMessages(e.popups,true);if(e.success){$("#is-active-switch").prop("checked",true);t.removeAttr("data-action");window.open(i,"_blank")}})})});this.addAction({change:"change-intro-action"},function(){var e=$("#startActionLink");var t=this.el.val();r(e,t)});this.addAction({change:"change-final-action"},function(){var e=$("#finalActionLink");var t=this.el.val();r(e,t)});this.addAction({change:"check-velocity-script"},function(){if(this.el.val()!=="wysiwyg"){return}e(this.el)});this.addAction({submission:"saveUserForm"},function(){var e=l("successFormBuilder");var t=l("errorFormBuilder");var i=e&&a("successTemplate");var n=t&&a("errorTemplate");if(i||n){o.createFromTemplate({needSuccessCodeChoose:i,needErrorCodeChoose:n},"warning-save-different-tabs")}else{var r=e?"FORM_BUILDER":"HTML";var s=t?"FORM_BUILDER":"HTML";d(r,s)}});this.addAction({click:"save-specific-code-mode"},function(){const e=$("#choose-code-format-modal-form");const t=e.find('[name="success_template_mode"]').val();const i=e.find('[name="error_template_mode"]').val();d(t,i)});this.addAction({change:"formTestRecipient"},function(){var e=$("#formTestLink");var t=$("#formTestRecipient");e.attr("href",t.val())});function a(e){var t=CKEDITOR.instances[e];if(t){t.updateElement()}return $("#userFormForm").dirty("isFieldDirty",$("#"+e))}function l(e){if(c.isCreated("#"+e)){return c.get("#"+e).isChanged()}return false}function d(e,t){var i=AGN.Lib.Form.get($("form#userFormForm"));if(c.isCreated("#successFormBuilder")){var n=c.get("#successFormBuilder");if(e==="FORM_BUILDER"){u.get($("#successTemplate")).val(n.generateHtml())}var r=n.getJson();i.setValueOnce("successSettings.formBuilderJson",r);var s=$("#successFormBuilder").find("input:enabled,select:enabled");s.prop("disabled",true)}if(c.isCreated("#errorFormBuilder")){var o=c.get("#errorFormBuilder");if(t==="FORM_BUILDER"){u.get($("#errorTemplate")).val(o.generateHtml())}var a=o.getJson();i.setValueOnce("errorSettings.formBuilderJson",a);var l=$("#errorFormBuilder").find("input:enabled,select:enabled");l.prop("disabled",true)}i.submit();if(s){s.prop("disabled",false)}if(l){l.prop("disabled",false)}}function e(e){const i=AGN.Lib.Helpers.objFromString(e.data("action-options"));const n=AGN.Lib.Editor.get($("#"+i.type+"Template")).val();if(n.match(/#(?:set|include|macro|parse|if|foreach)/gi)){AGN.Lib.Messages(t("defaults.error"),t("userform.error.velocity_not_allowed"),"alert");e.val("html").trigger("change")}}function r(e,t){if(e.exists()){if(t>0){e.attr("href",i.replace(":action-ID:",t));e.removeClass("hidden")}else{e.attr("href","#");e.addClass("hidden")}}}});AGN.Lib.Controller.newExtended("workflow-list","activeness-overview",function(){this.addAction({click:"bulk-delete"},function(){const n=AGN.Lib.Table.get(this.el).api;const r=n.getSelectedRows();const s=r.map(e=>e.id);if(!s.length){AGN.Lib.Messages.alert("messages.error.nothing_selected");return}$.ajax(AGN.url("/workflow/bulkDelete.action"),{method:"GET",traditional:true,data:{bulkIds:s}}).done(e=>{AGN.Lib.Confirm.create(e).done(e=>{if(s.length>1){const t=e.data;const i=r.filter(e=>t.includes(e.id));n.applyTransaction({remove:i});AGN.Lib.JsonMessages(e.popups,true)}else{n.applyTransaction({remove:r});AGN.Lib.RenderMessages($(e))}})})})});AGN.Lib.Controller.new("workflow-view",function(){const s=AGN.Lib.WM.Definitions;const r=AGN.Lib.WM.Editor;const o=AGN.Lib.WM.Node;const h=AGN.Lib.WM.EditorsHelper;const a=AGN.Lib.WM.MailingEditorHelper;const i=AGN.Lib.WM.Dialogs;const l=AGN.Lib.Confirm;const n=AGN.Lib.WM.Utils;const c=AGN.Lib.WM.DateTimeUtils;const u=AGN.Lib.Modal;let d;if(!jsPlumb.Connectors["FixedBezierConnector"]){jsPlumbUtil.extend(AGN.Opt.Components.JsPlumbFixedBezierConnector,jsPlumb.Connectors.AbstractConnector);jsPlumb.Connectors["FixedBezierConnector"]=AGN.Opt.Components.JsPlumbFixedBezierConnector}$(window).on("wheel mousewheel DOMMouseScroll",e=>e.ctrlKey&&e.preventDefault());$(window).on("resize viewportChanged",()=>d?.updateMinimap());$(document).on("keydown",f);$(document).on("keyup",g);$(document).on("mousedown",e);$(document).on("mouseup",p);function e(e){if(e.button===s.MOUSE_BUTTON_MIDDLE){d.setPanningEnabled(true)}}function p(e){if(e.button===s.MOUSE_BUTTON_MIDDLE){d.setPanningEnabled(false)}}function f(e){if($(e?.target).is("input, textarea")){return}switch(e.keyCode){case s.KEY_SHIFT:d.setMultiConnectionEnabled(true);break;case s.KEY_CTRL:d.setMouseWheelZoomEnabled(true);break}}function g(e){if($(e?.target).is("input, textarea")){return}switch(e.keyCode){case s.KEY_DELETE:d.deleteSelected();break;case s.KEY_SHIFT:d.setMultiConnectionEnabled(false);break;case s.KEY_ENTER:d.editIcon();break;case s.KEY_CTRL:d.setMouseWheelZoomEnabled(false);break}}this.addDomInitializer("workflow-view",function(){const e=this.config;s.constants=e.constants;s.workflowId=e.workflowId;s.shortname=e.shortname;s.statisticUrl=e.statisticUrl;s.sentMailings=e.sentMailings||[];h.hideNodeEditors();const t=e.icons.map(o.deserialize);const i=o.deserializeConnections(e.icons,o.toMap(t));if(d){d.recycle()}d=new r(e.isEditable!==false,e.isContextMenuEnabled!==false,e.isFootnotesEnabled===true);d.setOnInitialized(function(){d.batch(function(){t.forEach(function(e){d.add(e)});i.forEach(function(e){d.connect(e.source,e.target)})});d.updateNodeTitles();d.updateFootnotes();if(s.workflowId===0){s.intialSchema=d.serializeIcons()}});d.setMinimapEnabled(e.isMinimapEnabled!==false);var n=$("#slider");if(n.exists()){n.slider({min:s.MIN_ZOOM,max:s.MAX_ZOOM,value:s.DEFAULT_ZOOM,step:s.ZOOM_STEP,create:function(){var t=$(this).slider("instance");d.setZoom(s.DEFAULT_ZOOM);d.setOnZoom(function(e){t.value(e)})},slide:function(e,t){d.setZoom(t.value)}})}if(e.fitPdfPage===true){d.fitPdfPage()}window.status=e.initializerFinishStatus||"";m(e.showStatisticWithoutSave)});function m(t){$(".navbar-nav a[href*='statistic.action']").on("click",e=>{if(t){return}e.preventDefault();A(true,{showStatistic:true})})}this.addDomInitializer("mailing-data-transfer-modal",function(e){var i=e.find("input[data-mailing-param]");var n=e.find("#transferAllSettings");var r={};var s=[];i.on("change",function(){var e=$(this);var t=e.data("mailing-param");if(e.prop("checked")){r[t]=true}else{delete r[t]}s=Object.keys(r);n.prop("checked",s.length==i.length)});n.on("change",function(){var e=n.prop("checked");i.prop("checked",e);if(e){i.each(function(){r[$(this).data("mailing-param")]=true});s=Object.keys(r)}else{r={};s=[]}});this.addAction({click:"transfer-mailing-data"},function(){l.get(e).positive(s)})});this.addDomInitializer("own-workflow-expanding-modal",function(e){this.addAction({click:"expand-own-workflow"},function(){l.get(e).positive({workflowId:e.find("#workflow-select").val(),copyContent:e.find('[name="copyContent"]').val()==="true"})})});this.addDomInitializer("icon-comment-editor-initializer",function(){const e=h.registerEditor("icon-comment",new AGN.Lib.WM.CommentEditor);this.addAction({click:"icon-comment-editor-save"},()=>e.saveEditor());this.addAction({click:"icon-comment-editor-cancel"},()=>e.cancelEditor())});this.addDomInitializer("parameter-editor-initializer",function(){h.registerEditor("parameter",new AGN.Lib.WM.ParameterNodeEditor(d))});this.addDomInitializer("deadline-editor-initializer",function(){const e=h.registerEditor("deadline",new AGN.Lib.WM.DeadlineNodeEditor);this.addAction({change:"deadline-editor-update"},()=>e.updateVisibility());this.addAction({change:"deadline-editor-time-change"},()=>e.onTimeChanged())});this.addDomInitializer("archive-editor-initializer",function(){const e=h.registerEditor("archive",new AGN.Lib.WM.ArchiveNodeEditor(A));this.addAction({click:"archive-editor-new"},()=>e.createNewArchive())});this.addDomInitializer("recipient-editor-initializer",function(){const e=h.registerEditor("recipient",new AGN.Lib.WM.RecipientNodeEditor(A));this.addAction({click:"recipient-editor-create-new-target"},()=>e.createNewTarget());this.addAction({click:"recipient-editor-target-edit"},function(){e.editTarget(this.el.data("target-id"))})});this.addDomInitializer("export-editor-initializer",function(){const e=h.registerEditor("export",new AGN.Lib.WM.ExportNodeEditor(this.config,A));this.addAction({change:"export-editor-change"},()=>e.onChange());this.addAction({click:"export-editor-new"},()=>e.createNewAutoExport());this.addAction({click:"export-editor-autoexport"},()=>e.editAutoExport())});this.addDomInitializer("import-editor-initializer",function(){const e=h.registerEditor("import",new AGN.Lib.WM.ImportNodeEditor(this.config,A));this.addAction({change:"import-editor-change"},()=>e.onChange());this.addAction({click:"import-editor-new"},()=>e.createNewAutoImport());this.addAction({click:"import-editor-update"},()=>e.editAutoImport())});this.addDomInitializer("start-editor-initializer",function(){const e=new AGN.Lib.WM.StartStopNodeEditor(d,this.config);h.registerEditor("start",e);h.registerEditor("stop",e);this.addAction({change:"start-editor-execution-changed"},()=>e.onExecutionChanged());this.addAction({change:"start-editor-event-changed"},()=>e.onStartEventChanged());this.addAction({change:"start-editor-type-changed"},()=>e.onStartTypeChanged());this.addAction({change:"start-editor-rule-changed"},()=>e.onRuleModeChanged());this.addAction({change:"start-editor-reaction-changed"},()=>e.onReactionChanged());this.addAction({change:"start-editor-profile-field-changed"},()=>e.onProfileFieldChanged());this.addAction({click:"start-editor-add-rule"},()=>e.addRule());this.addAction({click:"start-editor-reminder-changed"},()=>e.onReminderChanged());this.addAction({change:"start-editor-schedule-reminder-date-changed"},()=>e.onScheduleReminderDateChanged());this.addAction({change:"start-editor-mailing-select"},function(){e.onMailingSelectChange(this.el.val())});this.addAction({click:"start-editor-rule-remove"},function(){e.removeRuleRow(this.el.data("rule-index"))})});this.addDomInitializer("decision-editor-initializer",function(){const e=h.registerEditor("decision",new AGN.Lib.WM.DecisionNodeEditor(d,this.config));this.addAction({change:"decision-editor-mailing-select"},function(){e.onMailingSelectChange(this.el.val())});this.addAction({click:"decision-editor-rule-remove"},function(){e.removeRuleRow(this.el.data("rule-index"))});this.addAction({click:"decision-editor-rule-add"},()=>e.addRule());this.addAction({change:"decision-editor-type-change"},()=>e.onTypeChanged());this.addAction({change:"decision-editor-criteria-change"},()=>e.onCriteriaChanged());this.addAction({change:"decision-editor-reaction-change"},()=>e.onDecisionReactionChanged());this.addAction({change:"decision-editor-profile-field-change"},()=>e.onProfileFieldChanged())});this.addDomInitializer("mailing-editor-initializer",function(){const t=new a(this.config,A);h.registerEditor("mailing",new AGN.Lib.WM.MailingNodeEditor(t));this.addAction({change:"mailing-editor-base-status-change"},function(){t.onMailingsStatusChange(this.el.val())});this.addAction({change:"mailing-editor-base-select-change"},function(){t.onMailingSelectChange(this.el.val())});this.addAction({click:"mailing-editor-base-toggle-settings"},function(){const e=n.getConfigData(this.el);t.toggleSendSettings(e.editorId)})});this.addDomInitializer("followup-mailing-editor-initializer",function(){const e=this.config.baseMailingData;const i=this.config.followupMailingData;e.$dropdown=$("#followup-m-editor");const n=new a(e,A);const r=new a(i,A);n.selectedFollowUpMailingId=0;n.findPreviousMailingIds=function(){const i=[];h.forEachPreviousNode(function(e){const t=e.getType();if(s.NODE_TYPES_MAILING.includes(t)&&s.NODE_TYPE_FOLLOWUP_MAILING!=t){i.push(e.getId())}});return i};n.getMailingsByWorkStatus=function(o,a,l,c){var u=this;var d=$(this.formNameJId+" "+this.selectNameJId);var e=_.uniq(this.findPreviousMailingIds()).toString();d.attr("readonly","readonly");$.ajax({url:AGN.url("/workflow/getMailingsByWorkStatus.action"),data:{mailingTypes:this.mailingTypesForLoading.join(","),status:o,sort:a,order:l,mailingId:this.selectedFollowUpMailingId,parentMailingId:$(this.formNameJId+" "+this.selectNameJId).val(),mailingStatus:"W",takeMailsForPeriod:true,mailingsInCampaign:e},success:function(e){d.html("");d.append('<option value="0">'+t("workflow.defaults.no_mailing")+"</option>");for(var i=0;i<e.length;i++){var n=e[i];var r="";var s="";if(n.WORK_STATUS=="mailing.status.sent"||n.WORK_STATUS=="mailing.status.norecipients"){r="style='color: #808080;'"}if(c==n.MAILING_ID){s="selected"}d.append("<option "+r+" value='"+n.MAILING_ID+"' status='"+n.WORK_STATUS+"' senddate='"+n.SENDDATE+"' "+s+">"+n.SHORTNAME+"</option>")}d.removeAttr("readonly");u.mailingsStatus=o;u.mailingsSort=a;u.mailingsOrder=l;d.val(u.mailingId);h.initSelectWithValueOrChooseFirst(d,u.mailingId)}})};r.onMailingSelectChange=function(e){n.selectedFollowUpMailingId=e;this.setSelectMailingOptions(e)};h.registerEditor("followup_mailing",new AGN.Lib.WM.FollowupMailingNodeEditor(n,r,i.disableFollowup==="true"));this.addAction({change:"followup-mailing-editor-base-status-change"},function(){r.onMailingsStatusChange(this.el.val())});this.addAction({change:"followup-mailing-editor-base-select-change"},function(){r.onMailingSelectChange(this.el.val())});this.addAction({change:"followup-base-mailing-editor-base-status-change"},function(){n.onMailingsStatusChange(this.el.val())});this.addAction({change:"followup-base-mailing-editor-base-select-change"},function(){n.onMailingSelectChange(this.el.val())})});this.addDomInitializer("sms-mailing-editor-initializer",function(){const e=new a(this.config,A);h.registerEditor("mailing_mediatype_sms",new AGN.Lib.WM.SmsMailingNodeEditor(e));this.addAction({change:"sms-mailing-editor-base-status-change"},function(){e.onMailingsStatusChange(this.el.val())});this.addAction({change:"sms-mailing-editor-base-select-change"},function(){e.onMailingSelectChange(this.el.val())})});this.addDomInitializer("post-mailing-editor-initializer",function(){const e=new a(this.config,A);h.registerEditor("mailing_mediatype_post",new AGN.Lib.WM.PostMailingNodeEditor(e));this.addAction({change:"post-mailing-editor-base-status-change"},function(){e.onMailingsStatusChange(this.el.val())});this.addAction({change:"post-mailing-editor-base-select-change"},function(){e.onMailingSelectChange(this.el.val())})});this.addDomInitializer("action-mailing-editor-initializer",function(){const e=new a(this.config,A);h.registerEditor("actionbased_mailing",new AGN.Lib.WM.ActionBasedMailingNodeEditor(e));this.addAction({change:"action-mailing-editor-base-status-change"},function(){e.onMailingsStatusChange(this.el.val())});this.addAction({change:"action-mailing-editor-base-select-change"},function(){e.onMailingSelectChange(this.el.val())})});this.addDomInitializer("date-based-mailing-editor-initializer",function(){const e=new a(this.config,A);h.registerEditor("datebased_mailing",new AGN.Lib.WM.DateBasedMailingNodeEditor(e));this.addAction({change:"date-mailing-editor-base-status-change"},function(){e.onMailingsStatusChange(this.el.val())});this.addAction({change:"date-mailing-editor-base-select-change"},function(){e.onMailingSelectChange(this.el.val())})});this.addAction({change:"save-node"},function(){if(!h.isReadOnlyMode()){h.getCurrentEditor().save()}});this.addAction({click:"mailing-editor-edit"},()=>h.getCurrentEditor().editMailing());this.addAction({click:"mailing-editor-new"},()=>h.getCurrentEditor().createNewMailing());this.addAction({click:"chain-mode"},function(){d.setChainModeEnabled(!(d.isChainMode()||d.connectSelected()));$(this.el).toggleClass("active",d.isChainMode())});this.addAction({click:"delete-selected"},()=>d.deleteSelected());this.addAction({click:"show-grid"},()=>d.toggleGrid());this.addAction({click:"workflow-save"},()=>A(true,{}));this.addAction({click:"align-all"},()=>d.alignAll());this.addAction({click:"undo"},()=>d.undo());this.addAction({click:"zoom-in"},function(){const e=$("#slider").slider("instance");e.value(e.value()+s.ZOOM_STEP);d.setZoom(e.value())});this.addAction({click:"zoom-out"},function(){const e=$("#slider").slider("instance");e.value(e.value()-s.ZOOM_STEP);d.setZoom(e.value())});this.addAction({click:"workflow-copy"},function(){const t=s.workflowId;const e=d.getNodes().some(e=>e.isFilled());i.confirmCopy(e).done(function(e){window.location.href=AGN.url(`/workflow/copy.action?workflowId=${t}&isWithContent=${e}`);return false})});this.addAction({click:"workflow-generate-pdf"},function(){const e=s.workflowId<=0||!s.shortname;const t=d.hasUnsavedChanges();if(e||t){u.fromTemplate("save-before-pdf-modal")}else{window.location.href=AGN.url("/workflow/"+s.workflowId+"/generatePDF.action");AGN.Lib.Loader.hide()}});this.addAction({click:"workflow-activate"},()=>i.Activation(S()).done(v));this.addAction({click:"workflow-deactivate"},()=>w(true,{status:s.constants.statusInactive}));this.addAction({click:"workflow-pause"},()=>A(true,{status:s.constants.statusPaused}));this.addAction({click:"workflow-unpause"},()=>C({status:s.constants.statusActive}));this.addAction({click:"workflow-dry-run"},function(){let e=false;let t=s.constants.statusOpen;if(s.constants.initialWorkflowStatus!=s.constants.statusTesting){e=true;t=s.constants.statusTesting}i.confirmTestingStartStop(e).done(()=>A(true,{status:t}))});function v(){d.getNodesByType(s.NODE_TYPE_START).filter(y).forEach(b);A(true,{status:s.constants.statusActive})}function y(e){const t=_.clone(e.data.date);if(!t){return false}t.setHours(e.data.hour);t.setMinutes(e.data.minute);t.setSeconds(0);return t<=new Date}function b(e){const{hour:t,minute:i}=c.getCurrentAdminTime()||{};if(!t||!i){return}e.data.date=new Date;const n=e.data.date;n.setHours(parseInt(t,10));n.setMinutes(parseInt(i,10));n.setSeconds(n.getSeconds()>55?n.getSeconds()+120:n.getSeconds()+60);e.data.hour=n.getHours();e.data.minute=n.getMinutes();d.updateNodeTitle(e,true);E().setValueOnce("startTimeAdjusted",true)}function C(e){i.Activation([],true).done(()=>A(true,e))}function w(e,t){i.Deactivation().done(()=>A(e,t))}function A(e,t){if(e&&!T()){return}const i=E();t=$.extend({},t);Object.keys(t).forEach(function(e){i.setValueOnce(e,t[e])});if(d.gridBackgroundShown){d.toggleGrid()}i.setValueOnce("workflowSchema",d.serializeIcons());i.setValueOnce("editorPositionLeft",-1);i.setValueOnce("editorPositionTop",-1);i.submit("static")}function E(){return AGN.Lib.Form.get($("form#workflowForm"))}function S(){return d.getNodesByTypes(s.NODE_TYPES_MAILING).map(e=>e.title).filter(e=>e.trim())}function T(){if($("#name").val().length<3){AGN.Lib.Messages.alert("error.workflow.shortName");return false}return true}this.addDomInitializer("open-edit-icon-initializer",function(e){const t=e.json();const i=t.nodeId;const n=t.elementValue;if(!i||!n){return}const r=o.get($("#"+i));if(!r){return}x(r,n);d.editIcon(r);d.updateNodeTitle(r,true)});function x(e,t){switch(e.type){case s.NODE_TYPE_MAILING:case s.NODE_TYPE_ACTION_BASED_MAILING:case s.NODE_TYPE_MAILING_MEDIATYPE_SMS:case s.NODE_TYPE_MAILING_MEDIATYPE_POST:case s.NODE_TYPE_DATE_BASED_MAILING:case s.NODE_TYPE_FOLLOWUP_MAILING:e.data.mailingId=t;break;case s.NODE_TYPE_RECIPIENT:if(t!="0"&&$.inArray(t,e.data.targets)==-1){e.data.targets.push(t)}break;case s.NODE_TYPE_ARCHIVE:e.data.campaignId=t;break;case s.NODE_TYPE_IMPORT:case s.NODE_TYPE_EXPORT:e.data.importexportId=t;break;default:console.debug("Unknown node type")}}});AGN.Lib.Controller.new("wysiwyg-agn-tags",function(){const s=AGN.Lib.Template;const e=AGN.Lib.Select;const n=AGN.Lib.Confirm;const r={};const o={};let a;r["agnFULLVIEW"]=()=>{const e=a.children("option:selected");const t=e.val();if(!t){return}if(!$("#createLinkToggle").prop("checked")){return`[${t}]`}let i=$("#tagLinkText").val();if(!i){i="fullview"}return`<a href="[${t}]">${i}</a>`};r["agnWEBVIEW"]=r["agnFULLVIEW"];r["agnFORM"]=function(){const e=a.children("option:selected");const t=e.val();const i=e.data("attributes");if(!t){return}if($("#createLinkToggle").prop("checked")===true){let e=$("#tagLinkText").val();if(!e){const n=i.findIndex(function(e){return e.name==="name"});if(n>-1){e=$(`#agn-tag-attribute-${n}`).val()}}if(e){return`<a href="[${t+u(i)}]">${e}</a>`}}return`[${t+u(i)}]`};o["agnFORM"]=function(){const e=$("#createLinkToggle");if(e.prop("checked")!==true){$("#tagLinkText").hide()}e.on("change",function(){$("#tagLinkText").toggle($(this).prop("checked"))})};o["agnFULLVIEW"]=o["agnFORM"];o["agnWEBVIEW"]=o["agnFULLVIEW"];function l(e,t){const i=$("#agn-tag-attributes");i.empty();if(t&&t.length>0){t.forEach(function(e,t){switch(e.type){case"SELECT":i.append(s.text("agn-tag-select-attribute",{index:t,name:e.name,options:e.options}));break;case"TEXT":i.append(s.text("agn-tag-text-attribute",{index:t,name:e.name}));break}})}const n=`${e}-extended-attributes`;if(s.exists(n)){const r=s.dom(n);if(r){i.append(r)}}AGN.runAll(i)}function c(){const e=a.children("option:selected");const t=e.val();if(t){return"["+t+u(e.data("attributes"))+"]"}return null}function u(e){var n="";if(e&&e.length>0){e.forEach(function(e,t){var i=$(`#agn-tag-attribute-${t}`);n+=" "+e.name+'="'+_.escape(i.val())+'"'})}return n}this.addDomInitializer("wysiwyg-agn-tags",function(){a=$("#agn-tag-name");this.config.forEach(function(e){var t=$("<option>",{value:e.name,text:e.name});a.append(t);t.data("attributes",e.attributes)});e.get(a).selectFirstValue();a.trigger("change")});this.addAction({change:"select-agn-tag"},function(){const e=this.el.children("option:selected");const t=e.val();l(t,e.data("attributes"));const i=o[t];if(i){i()}});this.addAction({click:"insert-agn-tag"},function(){const e=a.val();const t=r[e];let i;if(t){i=t()}else{i=c()}if(i){n.get(this.el).positive(i)}})});AGN.Lib.Controller.new("wysiwyg-image-browser",function(){let t;const i=e("CKEditorFuncNum");const n=e("mailingID");function e(e){const t=new RegExp("(?:[?&]|&amp;)"+e+"=([^&]+)","i");const i=window.location.search.match(t);return i&&i.length>1?i[1]:""}this.addDomInitializer("wysiwyg-image-browser",function(){t=this.config;r()});this.addAction({change:"update-image"},function(){r()});function r(){const e=c();const t=$("#image-preview");const i=$("#no-image-message");const n=!!(e&&e.length);i.toggleClass("hidden",n);t.parent().toggleClass("hidden",!n);if(n){t.attr("src",l(e))}}this.addAction({click:"submit-image"},function(){const e=$(".navbar li .active").data("image-tab-name");if(e==="mediapool"){o()}else{s()}});this.addAction({click:"close-window"},function(){window.close()});function s(){const e=l(c());a(e)}function o(){const e=$("tr.picked");if(e.exists()){const t=e.find("img").attr("src");a(t)}else{AGN.Lib.Messages.alert("messages.error.nothing_selected")}}function a(e){window.opener.CKEDITOR.tools.callFunction(i,e);window.close()}function l(e){if(e.substr(0,4).toLowerCase()!=="http"){return`${t.rdirDomain}/image?ci=${t.companyId}&mi=${n}&name=${encodeURIComponent(e)}`}return encodeURI(e)}function c(){return $("#image-dropdown").val()}});(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.interact=e()}})(function(){var e,t,i;return function s(o,a,l){function c(i,e){if(!a[i]){if(!o[i]){var t=typeof require=="function"&&require;if(!e&&t)return t(i,!0);if(u)return u(i,!0);var n=new Error("Cannot find module '"+i+"'");throw n.code="MODULE_NOT_FOUND",n}var r=a[i]={exports:{}};o[i][0].call(r.exports,function(e){var t=o[i][1][e];return c(t?t:e)},r,r.exports,s,o,a,l)}return a[i].exports}var u=typeof require=="function"&&require;for(var e=0;e<l.length;e++)c(l[e]);return c}({1:[function(t,e,i){"use strict";if(typeof window==="undefined"){e.exports=function(e){t("./src/utils/window").init(e);return t("./src/index")}}else{e.exports=t("./src/index")}},{"./src/index":19,"./src/utils/window":52}],2:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var r=e("./utils/extend.js");function s(e,t){for(var i=0;i<t.length;i++){var n;n=t[i];var r=n;if(e.immediatePropagationStopped){break}r(e)}}var o=function(){function t(e){n(this,t);this.options=r({},e||{})}t.prototype.fire=function e(t){var i=void 0;var n="on"+t.type;var r=this.global;if(i=this[t.type]){s(t,i)}if(this[n]){this[n](t)}if(!t.propagationStopped&&r&&(i=r[t.type])){s(t,i)}};t.prototype.on=function e(t,i){if(this[t]){this[t].push(i)}else{this[t]=[i]}};t.prototype.off=function e(t,i){var n=this[t];var r=n?n.indexOf(i):-1;if(r!==-1){n.splice(r,1)}if(n&&n.length===0||!i){this[t]=undefined}};return t}();t.exports=o},{"./utils/extend.js":41}],3:[function(e,t,i){"use strict";function y(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var b=e("./utils/extend");var C=e("./utils/getOriginXY");var w=e("./defaultOptions");var _=e("./utils/Signals").new();var n=function(){function v(e,t,i,n,r,s){var o=arguments.length>6&&arguments[6]!==undefined?arguments[6]:false;y(this,v);var a=e.target;var l=(a&&a.options||w).deltaSource;var c=C(a,r,i);var u=n==="start";var d=n==="end";var h=u?e.startCoords:e.curCoords;var p=e.prevEvent;r=r||e.element;var f=b({},h.page);var g=b({},h.client);f.x-=c.x;f.y-=c.y;g.x-=c.x;g.y-=c.y;this.ctrlKey=t.ctrlKey;this.altKey=t.altKey;this.shiftKey=t.shiftKey;this.metaKey=t.metaKey;this.button=t.button;this.buttons=t.buttons;this.target=r;this.currentTarget=r;this.relatedTarget=s||null;this.preEnd=o;this.type=i+(n||"");this.interaction=e;this.interactable=a;this.t0=u?e.downTimes[e.downTimes.length-1]:p.t0;var m={interaction:e,event:t,action:i,phase:n,element:r,related:s,page:f,client:g,coords:h,starting:u,ending:d,deltaSource:l,iEvent:this};_.fire("set-xy",m);if(d){this.pageX=p.pageX;this.pageY=p.pageY;this.clientX=p.clientX;this.clientY=p.clientY}else{this.pageX=f.x;this.pageY=f.y;this.clientX=g.x;this.clientY=g.y}this.x0=e.startCoords.page.x-c.x;this.y0=e.startCoords.page.y-c.y;this.clientX0=e.startCoords.client.x-c.x;this.clientY0=e.startCoords.client.y-c.y;_.fire("set-delta",m);this.timeStamp=h.timeStamp;this.dt=e.pointerDelta.timeStamp;this.duration=this.timeStamp-this.t0;this.speed=e.pointerDelta[l].speed;this.velocityX=e.pointerDelta[l].vx;this.velocityY=e.pointerDelta[l].vy;this.swipe=d||n==="inertiastart"?this.getSwipe():null;_.fire("new",m)}v.prototype.getSwipe=function e(){var t=this.interaction;if(t.prevEvent.speed<600||this.timeStamp-t.prevEvent.timeStamp>150){return null}var i=180*Math.atan2(t.prevEvent.velocityY,t.prevEvent.velocityX)/Math.PI;var n=22.5;if(i<0){i+=360}var r=135-n<=i&&i<225+n;var s=225-n<=i&&i<315+n;var o=!r&&(315-n<=i||i<45+n);var a=!s&&45-n<=i&&i<135+n;return{up:s,down:a,left:r,right:o,angle:i,speed:t.prevEvent.speed,velocity:{x:t.prevEvent.velocityX,y:t.prevEvent.velocityY}}};v.prototype.preventDefault=function e(){};v.prototype.stopImmediatePropagation=function e(){this.immediatePropagationStopped=this.propagationStopped=true};v.prototype.stopPropagation=function e(){this.propagationStopped=true};return v}();_.on("set-delta",function(e){var t=e.iEvent,i=e.interaction,n=e.starting,r=e.deltaSource;var s=n?t:i.prevEvent;if(r==="client"){t.dx=t.clientX-s.clientX;t.dy=t.clientY-s.clientY}else{t.dx=t.pageX-s.pageX;t.dy=t.pageY-s.pageY}});n.signals=_;t.exports=n},{"./defaultOptions":18,"./utils/Signals":34,"./utils/extend":41,"./utils/getOriginXY":42}],4:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=e("./utils/clone");var u=e("./utils/is");var o=e("./utils/events");var r=e("./utils/extend");var d=e("./actions/base");var a=e("./scope");var s=e("./Eventable");var h=e("./defaultOptions");var p=e("./utils/Signals").new();var l=e("./utils/domUtils"),f=l.getElementRect,g=l.nodeContains,m=l.trySelector,v=l.matchesSelector;var y=e("./utils/window"),b=y.getWindow;var C=e("./utils/arr"),w=C.contains;var _=e("./utils/browser"),A=_.wheelEvent;a.interactables=[];var E=function(){function l(e,t){n(this,l);t=t||{};this.target=e;this.events=new s;this._context=t.context||a.document;this._win=b(m(e)?this._context:e);this._doc=this._win.document;p.fire("new",{target:e,options:t,interactable:this,win:this._win});a.addDocument(this._doc,this._win);a.interactables.push(this);this.set(t)}l.prototype.setOnEvents=function e(t,i){var n="on"+t;if(u.function(i.onstart)){this.events[n+"start"]=i.onstart}if(u.function(i.onmove)){this.events[n+"move"]=i.onmove}if(u.function(i.onend)){this.events[n+"end"]=i.onend}if(u.function(i.oninertiastart)){this.events[n+"inertiastart"]=i.oninertiastart}return this};l.prototype.setPerAction=function e(t,i){for(var n in i){if(n in h[t]){if(u.object(i[n])){this.options[t][n]=c(this.options[t][n]||{});r(this.options[t][n],i[n]);if(u.object(h.perAction[n])&&"enabled"in h.perAction[n]){this.options[t][n].enabled=i[n].enabled===false?false:true}}else if(u.bool(i[n])&&u.object(h.perAction[n])){this.options[t][n].enabled=i[n]}else if(i[n]!==undefined){this.options[t][n]=i[n]}}}};l.prototype.getRect=function e(t){t=t||this.target;if(u.string(this.target)&&!u.element(t)){t=this._context.querySelector(this.target)}return f(t)};l.prototype.rectChecker=function e(t){if(u.function(t)){this.getRect=t;return this}if(t===null){delete this.options.getRect;return this}return this.getRect};l.prototype._backCompatOption=function e(t,i){if(m(i)||u.object(i)){this.options[t]=i;for(var n=0;n<d.names.length;n++){var r;r=d.names[n];var s=r;this.options[s][t]=i}return this}return this.options[t]};l.prototype.origin=function e(t){return this._backCompatOption("origin",t)};l.prototype.deltaSource=function e(t){if(t==="page"||t==="client"){this.options.deltaSource=t;return this}return this.options.deltaSource};l.prototype.context=function e(){return this._context};l.prototype.inContext=function e(t){return this._context===t.ownerDocument||g(this._context,t)};l.prototype.fire=function e(t){this.events.fire(t);return this};l.prototype._onOffMultiple=function e(t,i,n,r){if(u.string(i)&&i.search(" ")!==-1){i=i.trim().split(/ +/)}if(u.array(i)){for(var s=0;s<i.length;s++){var o;o=i[s];var a=o;this[t](a,n,r)}return true}if(u.object(i)){for(var l in i){this[t](l,i[l],n)}return true}};l.prototype.on=function e(t,i,n){if(this._onOffMultiple("on",t,i,n)){return this}if(t==="wheel"){t=A}if(w(l.eventTypes,t)){this.events.on(t,i)}else if(u.string(this.target)){o.addDelegate(this.target,this._context,t,i,n)}else{o.add(this.target,t,i,n)}return this};l.prototype.off=function e(t,i,n){if(this._onOffMultiple("off",t,i,n)){return this}if(t==="wheel"){t=A}if(w(l.eventTypes,t)){this.events.off(t,i)}else if(u.string(this.target)){o.removeDelegate(this.target,this._context,t,i,n)}else{o.remove(this.target,t,i,n)}return this};l.prototype.set=function e(t){if(!u.object(t)){t={}}this.options=c(h.base);var i=c(h.perAction);for(var n in d.methodDict){var r=d.methodDict[n];this.options[n]=c(h[n]);this.setPerAction(n,i);this[r](t[n])}for(var s=0;s<l.settingsMethods.length;s++){var o;o=l.settingsMethods[s];var a=o;this.options[a]=h.base[a];if(a in t){this[a](t[a])}}p.fire("set",{options:t,interactable:this});return this};l.prototype.unset=function e(){o.remove(this.target,"all");if(u.string(this.target)){for(var t in o.delegatedEvents){var i=o.delegatedEvents[t];if(i.selectors[0]===this.target&&i.contexts[0]===this._context){i.selectors.splice(0,1);i.contexts.splice(0,1);i.listeners.splice(0,1);if(!i.selectors.length){i[t]=null}}o.remove(this._context,t,o.delegateListener);o.remove(this._context,t,o.delegateUseCapture,true)}}else{o.remove(this,"all")}p.fire("unset",{interactable:this});a.interactables.splice(a.interactables.indexOf(this),1);for(var n=0;n<(a.interactions||[]).length;n++){var r;r=(a.interactions||[])[n];var s=r;if(s.target===this&&s.interacting()&&!s._ending){s.stop()}}return a.interact};return l}();a.interactables.indexOfElement=function e(t,i){i=i||a.document;for(var n=0;n<this.length;n++){var r=this[n];if(r.target===t&&r._context===i){return n}}return-1};a.interactables.get=function e(t,i,n){var r=this[this.indexOfElement(t,i&&i.context)];return r&&(u.string(t)||n||r.inContext(t))?r:null};a.interactables.forEachMatch=function(e,t){for(var i=0;i<this.length;i++){var n;n=this[i];var r=n;var s=void 0;if((u.string(r.target)?u.element(e)&&v(e,r.target):e===r.target)&&r.inContext(e)){s=t(r)}if(s!==undefined){return s}}};E.eventTypes=a.eventTypes=[];E.signals=p;E.settingsMethods=["deltaSource","origin","preventDefault","rectChecker"];t.exports=E},{"./Eventable":2,"./actions/base":6,"./defaultOptions":18,"./scope":33,"./utils/Signals":34,"./utils/arr":35,"./utils/browser":36,"./utils/clone":37,"./utils/domUtils":39,"./utils/events":40,"./utils/extend":41,"./utils/is":46,"./utils/window":52}],5:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var b=e("./scope");var C=e("./utils");var o=e("./utils/events");var w=e("./utils/browser");var r=e("./utils/domObjects");var _=e("./utils/interactionFinder");var c=e("./utils/Signals").new();var s={};var a=["pointerDown","pointerMove","pointerUp","updatePointer","removePointer"];var A=0;b.interactions=[];var E=function(){function l(e){var t=e.pointerType;n(this,l);this.target=null;this.element=null;this.prepared={name:null,axis:null,edges:null};this.pointers=[];this.pointerIds=[];this.downTargets=[];this.downTimes=[];this.prevCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0};this.curCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0};this.startCoords={page:{x:0,y:0},client:{x:0,y:0},timeStamp:0};this.pointerDelta={page:{x:0,y:0,vx:0,vy:0,speed:0},client:{x:0,y:0,vx:0,vy:0,speed:0},timeStamp:0};this.downEvent=null;this.downPointer={};this._eventTarget=null;this._curEventTarget=null;this.prevEvent=null;this.pointerIsDown=false;this.pointerWasMoved=false;this._interacting=false;this._ending=false;this.pointerType=t;c.fire("new",this);b.interactions.push(this)}l.prototype.pointerDown=function e(t,i,n){var r=this.updatePointer(t,i,true);c.fire("down",{pointer:t,event:i,eventTarget:n,pointerIndex:r,interaction:this})};l.prototype.start=function e(t,i,n){if(this.interacting()||!this.pointerIsDown||this.pointerIds.length<(t.name==="gesture"?2:1)){return}if(b.interactions.indexOf(this)===-1){b.interactions.push(this)}C.copyAction(this.prepared,t);this.target=i;this.element=n;c.fire("action-start",{interaction:this,event:this.downEvent})};l.prototype.pointerMove=function e(t,i,n){if(!this.simulation){this.updatePointer(t);C.setCoords(this.curCoords,this.pointers)}var r=this.curCoords.page.x===this.prevCoords.page.x&&this.curCoords.page.y===this.prevCoords.page.y&&this.curCoords.client.x===this.prevCoords.client.x&&this.curCoords.client.y===this.prevCoords.client.y;var s=void 0;var o=void 0;if(this.pointerIsDown&&!this.pointerWasMoved){s=this.curCoords.client.x-this.startCoords.client.x;o=this.curCoords.client.y-this.startCoords.client.y;this.pointerWasMoved=C.hypot(s,o)>l.pointerMoveTolerance}var a={pointer:t,pointerIndex:this.getPointerIndex(t),event:i,eventTarget:n,dx:s,dy:o,duplicate:r,interaction:this,interactingBeforeMove:this.interacting()};if(!r){C.setCoordDeltas(this.pointerDelta,this.prevCoords,this.curCoords)}c.fire("move",a);if(!r){if(this.interacting()){this.doMove(a)}if(this.pointerWasMoved){C.copyCoords(this.prevCoords,this.curCoords)}}};l.prototype.doMove=function e(t){t=C.extend({pointer:this.pointers[0],event:this.prevEvent,eventTarget:this._eventTarget,interaction:this},t||{});c.fire("before-action-move",t);if(!this._dontFireMove){c.fire("action-move",t)}this._dontFireMove=false};l.prototype.pointerUp=function e(t,i,n,r){var s=this.getPointerIndex(t);c.fire(/cancel$/i.test(i.type)?"cancel":"up",{pointer:t,pointerIndex:s,event:i,eventTarget:n,curEventTarget:r,interaction:this});if(!this.simulation){this.end(i)}this.pointerIsDown=false;this.removePointer(t,i)};l.prototype.end=function e(t){this._ending=true;t=t||this.prevEvent;if(this.interacting()){c.fire("action-end",{event:t,interaction:this})}this.stop();this._ending=false};l.prototype.currentAction=function e(){return this._interacting?this.prepared.name:null};l.prototype.interacting=function e(){return this._interacting};l.prototype.stop=function e(){c.fire("stop",{interaction:this});if(this._interacting){c.fire("stop-active",{interaction:this});c.fire("stop-"+this.prepared.name,{interaction:this})}this.target=this.element=null;this._interacting=false;this.prepared.name=this.prevEvent=null};l.prototype.getPointerIndex=function e(t){if(this.pointerType==="mouse"||this.pointerType==="pen"){return 0}return this.pointerIds.indexOf(C.getPointerId(t))};l.prototype.updatePointer=function e(t,i){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:i&&/(down|start)$/i.test(i.type);var r=C.getPointerId(t);var s=this.getPointerIndex(t);if(s===-1){s=this.pointerIds.length;this.pointerIds[s]=r}if(n){c.fire("update-pointer-down",{pointer:t,event:i,down:n,pointerId:r,pointerIndex:s,interaction:this})}this.pointers[s]=t;return s};l.prototype.removePointer=function e(t,i){var n=this.getPointerIndex(t);if(n===-1){return}c.fire("remove-pointer",{pointer:t,event:i,pointerIndex:n,interaction:this});this.pointers.splice(n,1);this.pointerIds.splice(n,1);this.downTargets.splice(n,1);this.downTimes.splice(n,1)};l.prototype._updateEventTargets=function e(t,i){this._eventTarget=t;this._curEventTarget=i};return l}();for(var l=0;l<a.length;l++){var u=a[l];s[u]=d(u)}function d(y){return function(e){var t=C.getPointerType(e);var i=C.getEventTargets(e),n=i[0],r=i[1];var s=[];if(w.supportsTouch&&/touch/.test(e.type)){A=(new Date).getTime();for(var o=0;o<e.changedTouches.length;o++){var a;a=e.changedTouches[o];var l=a;var c=l;var u=_.search(c,e.type,n);s.push([c,u||new E({pointerType:t})])}}else{var d=false;if(!w.supportsPointerEvent&&/mouse/.test(e.type)){for(var h=0;h<b.interactions.length&&!d;h++){d=b.interactions[h].pointerType!=="mouse"&&b.interactions[h].pointerIsDown}d=d||(new Date).getTime()-A<500||e.timeStamp===0}if(!d){var p=_.search(e,e.type,n);if(!p){p=new E({pointerType:t})}s.push([e,p])}}for(var f=0;f<s.length;f++){var g=s[f];var m=g[0];var v=g[1];v._updateEventTargets(n,r);v[y](m,e,n,r)}}}function h(e){for(var t=0;t<b.interactions.length;t++){var i;i=b.interactions[t];var n=i;n.end(e);c.fire("endall",{event:e,interaction:n})}}var p={};var f=w.pEventTypes;if(r.PointerEvent){p[f.down]=s.pointerDown;p[f.move]=s.pointerMove;p[f.up]=s.pointerUp;p[f.cancel]=s.pointerUp}else{p.mousedown=s.pointerDown;p.mousemove=s.pointerMove;p.mouseup=s.pointerUp;p.touchstart=s.pointerDown;p.touchmove=s.pointerMove;p.touchend=s.pointerUp;p.touchcancel=s.pointerUp}p.blur=h;function g(e,t){var i=e.doc;var n=t.indexOf("add")===0?o.add:o.remove;for(var r in b.delegatedEvents){n(i,r,o.delegateListener);n(i,r,o.delegateUseCapture,true)}for(var s in p){n(i,s,p[s],w.isIOS?{passive:false}:undefined)}}c.on("update-pointer-down",function(e){var t=e.interaction,i=e.pointer,n=e.pointerId,r=e.pointerIndex,s=e.event,o=e.eventTarget,a=e.down;t.pointerIds[r]=n;t.pointers[r]=i;if(a){t.pointerIsDown=true}if(!t.interacting()){C.setCoords(t.startCoords,t.pointers);C.copyCoords(t.curCoords,t.startCoords);C.copyCoords(t.prevCoords,t.startCoords);t.downEvent=s;t.downTimes[r]=t.curCoords.timeStamp;t.downTargets[r]=o||s&&C.getEventTargets(s)[0];t.pointerWasMoved=false;C.pointerExtend(t.downPointer,i)}});b.signals.on("add-document",g);b.signals.on("remove-document",g);E.pointerMoveTolerance=1;E.doOnInteractions=d;E.endAll=h;E.signals=c;E.docEvents=p;b.endAllInteractions=h;t.exports=E},{"./scope":33,"./utils":44,"./utils/Signals":34,"./utils/browser":36,"./utils/domObjects":38,"./utils/events":40,"./utils/interactionFinder":45}],6:[function(e,t,i){"use strict";var n=e("../Interaction");var o=e("../InteractEvent");var r={firePrepared:s,names:[],methodDict:{}};n.signals.on("action-start",function(e){var t=e.interaction,i=e.event;t._interacting=true;s(t,i,"start")});n.signals.on("action-move",function(e){var t=e.interaction,i=e.event,n=e.preEnd;s(t,i,"move",n);if(!t.interacting()){return false}});n.signals.on("action-end",function(e){var t=e.interaction,i=e.event;s(t,i,"end")});function s(e,t,i,n){var r=e.prepared.name;var s=new o(e,t,r,i,e.element,null,n);e.target.fire(s);e.prevEvent=s}t.exports=r},{"../InteractEvent":3,"../Interaction":5}],7:[function(e,t,i){"use strict";var n=e("./base");var r=e("../utils");var s=e("../InteractEvent");var o=e("../Interactable");var a=e("../Interaction");var l=e("../defaultOptions");var c={defaults:{enabled:false,mouseButtons:null,origin:null,snap:null,restrict:null,inertia:null,autoScroll:null,startAxis:"xy",lockAxis:"xy"},checker:function e(t,i,n){var r=n.options.drag;return r.enabled?{name:"drag",axis:r.lockAxis==="start"?r.startAxis:r.lockAxis}:null},getCursor:function e(){return"move"}};a.signals.on("before-action-move",function(e){var t=e.interaction;if(t.prepared.name!=="drag"){return}var i=t.prepared.axis;if(i==="x"){t.curCoords.page.y=t.startCoords.page.y;t.curCoords.client.y=t.startCoords.client.y;t.pointerDelta.page.speed=Math.abs(t.pointerDelta.page.vx);t.pointerDelta.client.speed=Math.abs(t.pointerDelta.client.vx);t.pointerDelta.client.vy=0;t.pointerDelta.page.vy=0}else if(i==="y"){t.curCoords.page.x=t.startCoords.page.x;t.curCoords.client.x=t.startCoords.client.x;t.pointerDelta.page.speed=Math.abs(t.pointerDelta.page.vy);t.pointerDelta.client.speed=Math.abs(t.pointerDelta.client.vy);t.pointerDelta.client.vx=0;t.pointerDelta.page.vx=0}});s.signals.on("new",function(e){var t=e.iEvent,i=e.interaction;if(t.type!=="dragmove"){return}var n=i.prepared.axis;if(n==="x"){t.pageY=i.startCoords.page.y;t.clientY=i.startCoords.client.y;t.dy=0}else if(n==="y"){t.pageX=i.startCoords.page.x;t.clientX=i.startCoords.client.x;t.dx=0}});o.prototype.draggable=function(e){if(r.is.object(e)){this.options.drag.enabled=e.enabled===false?false:true;this.setPerAction("drag",e);this.setOnEvents("drag",e);if(/^(xy|x|y|start)$/.test(e.lockAxis)){this.options.drag.lockAxis=e.lockAxis}if(/^(xy|x|y)$/.test(e.startAxis)){this.options.drag.startAxis=e.startAxis}return this}if(r.is.bool(e)){this.options.drag.enabled=e;if(!e){this.ondragstart=this.ondragstart=this.ondragend=null}return this}return this.options.drag};n.drag=c;n.names.push("drag");r.merge(o.eventTypes,["dragstart","dragmove","draginertiastart","draginertiaresume","dragend"]);n.methodDict.drag="draggable";l.drag=c.defaults;t.exports=c},{"../InteractEvent":3,"../Interactable":4,"../Interaction":5,"../defaultOptions":18,"../utils":44,"./base":6}],8:[function(e,t,i){"use strict";var n=e("./base");var v=e("../utils");var h=e("../scope");var r=e("../interact");var s=e("../InteractEvent");var o=e("../Interactable");var a=e("../Interaction");var l=e("../defaultOptions");var c={defaults:{enabled:false,accept:null,overlap:"pointer"}};var u=false;a.signals.on("action-start",function(e){var t=e.interaction,i=e.event;if(t.prepared.name!=="drag"){return}t.activeDrops.dropzones=[];t.activeDrops.elements=[];t.activeDrops.rects=[];t.dropEvents=null;if(!t.dynamicDrop){f(t.activeDrops,t.element)}var n=t.prevEvent;var r=m(t,i,n);if(r.activate){p(t.activeDrops,r.activate)}});s.signals.on("new",function(e){var t=e.interaction,i=e.iEvent,n=e.event;if(i.type!=="dragmove"&&i.type!=="dragend"){return}var r=t.element;var s=i;var o=g(s,n,r);t.dropTarget=o.dropzone;t.dropElement=o.element;t.dropEvents=m(t,n,s)});a.signals.on("action-move",function(e){var t=e.interaction;if(t.prepared.name!=="drag"){return}y(t,t.dropEvents)});a.signals.on("action-end",function(e){var t=e.interaction;if(t.prepared.name==="drag"){y(t,t.dropEvents)}});a.signals.on("stop-drag",function(e){var t=e.interaction;t.activeDrops={dropzones:null,elements:null,rects:null};t.dropEvents=null});function d(e,t){var i=[];var n=[];for(var r=0;r<h.interactables.length;r++){var s;s=h.interactables[r];var o=s;if(!o.options.drop.enabled){continue}var a=o.options.drop.accept;if(v.is.element(a)&&a!==t||v.is.string(a)&&!v.matchesSelector(t,a)){continue}var l=v.is.string(o.target)?o._context.querySelectorAll(o.target):[o.target];for(var c=0;c<l.length;c++){var u;u=l[c];var d=u;if(d!==t){i.push(o);n.push(d)}}}return{elements:n,dropzones:i}}function p(e,t){var i=void 0;for(var n=0;n<e.dropzones.length;n++){var r=e.dropzones[n];var s=e.elements[n];if(s!==i){t.target=s;r.fire(t)}i=s}}function f(e,t){var i=d(e,t);e.dropzones=i.dropzones;e.elements=i.elements;e.rects=[];for(var n=0;n<e.dropzones.length;n++){e.rects[n]=e.dropzones[n].getRect(e.elements[n])}}function g(e,t,i){var n=e.interaction;var r=[];if(u){f(n.activeDrops,i)}for(var s=0;s<n.activeDrops.dropzones.length;s++){var o=n.activeDrops.dropzones[s];var a=n.activeDrops.elements[s];var l=n.activeDrops.rects[s];r.push(o.dropCheck(e,t,n.target,i,a,l)?a:null)}var c=v.indexOfDeepestElement(r);return{dropzone:n.activeDrops.dropzones[c]||null,element:n.activeDrops.elements[c]||null}}function m(e,t,i){var n={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};var r={dragEvent:i,interaction:e,target:e.dropElement,dropzone:e.dropTarget,relatedTarget:i.target,draggable:i.interactable,timeStamp:i.timeStamp};if(e.dropElement!==e.prevDropElement){if(e.prevDropTarget){n.leave=v.extend({type:"dragleave"},r);i.dragLeave=n.leave.target=e.prevDropElement;i.prevDropzone=n.leave.dropzone=e.prevDropTarget}if(e.dropTarget){n.enter={dragEvent:i,interaction:e,target:e.dropElement,dropzone:e.dropTarget,relatedTarget:i.target,draggable:i.interactable,timeStamp:i.timeStamp,type:"dragenter"};i.dragEnter=e.dropElement;i.dropzone=e.dropTarget}}if(i.type==="dragend"&&e.dropTarget){n.drop=v.extend({type:"drop"},r);i.dropzone=e.dropTarget;i.relatedTarget=e.dropElement}if(i.type==="dragstart"){n.activate=v.extend({type:"dropactivate"},r);n.activate.target=null;n.activate.dropzone=null}if(i.type==="dragend"){n.deactivate=v.extend({type:"dropdeactivate"},r);n.deactivate.target=null;n.deactivate.dropzone=null}if(i.type==="dragmove"&&e.dropTarget){n.move=v.extend({dragmove:i,type:"dropmove"},r);i.dropzone=e.dropTarget}return n}function y(e,t){var i=e.activeDrops,n=e.prevDropTarget,r=e.dropTarget,s=e.dropElement;if(t.leave){n.fire(t.leave)}if(t.move){r.fire(t.move)}if(t.enter){r.fire(t.enter)}if(t.drop){r.fire(t.drop)}if(t.deactivate){p(i,t.deactivate)}e.prevDropTarget=r;e.prevDropElement=s}o.prototype.dropzone=function(e){if(v.is.object(e)){this.options.drop.enabled=e.enabled===false?false:true;if(v.is.function(e.ondrop)){this.events.ondrop=e.ondrop}if(v.is.function(e.ondropactivate)){this.events.ondropactivate=e.ondropactivate}if(v.is.function(e.ondropdeactivate)){this.events.ondropdeactivate=e.ondropdeactivate}if(v.is.function(e.ondragenter)){this.events.ondragenter=e.ondragenter}if(v.is.function(e.ondragleave)){this.events.ondragleave=e.ondragleave}if(v.is.function(e.ondropmove)){this.events.ondropmove=e.ondropmove}if(/^(pointer|center)$/.test(e.overlap)){this.options.drop.overlap=e.overlap}else if(v.is.number(e.overlap)){this.options.drop.overlap=Math.max(Math.min(1,e.overlap),0)}if("accept"in e){this.options.drop.accept=e.accept}if("checker"in e){this.options.drop.checker=e.checker}return this}if(v.is.bool(e)){this.options.drop.enabled=e;if(!e){this.ondragenter=this.ondragleave=this.ondrop=this.ondropactivate=this.ondropdeactivate=null}return this}return this.options.drop};o.prototype.dropCheck=function(e,t,i,n,r,s){var o=false;if(!(s=s||this.getRect(r))){return this.options.drop.checker?this.options.drop.checker(e,t,o,this,r,i,n):false}var a=this.options.drop.overlap;if(a==="pointer"){var l=v.getOriginXY(i,n,"drag");var c=v.getPageXY(e);c.x+=l.x;c.y+=l.y;var u=c.x>s.left&&c.x<s.right;var d=c.y>s.top&&c.y<s.bottom;o=u&&d}var h=i.getRect(n);if(h&&a==="center"){var p=h.left+h.width/2;var f=h.top+h.height/2;o=p>=s.left&&p<=s.right&&f>=s.top&&f<=s.bottom}if(h&&v.is.number(a)){var g=Math.max(0,Math.min(s.right,h.right)-Math.max(s.left,h.left))*Math.max(0,Math.min(s.bottom,h.bottom)-Math.max(s.top,h.top));var m=g/(h.width*h.height);o=m>=a}if(this.options.drop.checker){o=this.options.drop.checker(e,t,o,this,r,i,n)}return o};o.signals.on("unset",function(e){var t=e.interactable;t.dropzone(false)});o.settingsMethods.push("dropChecker");a.signals.on("new",function(e){e.dropTarget=null;e.dropElement=null;e.prevDropTarget=null;e.prevDropElement=null;e.dropEvents=null;e.activeDrops={dropzones:[],elements:[],rects:[]}});a.signals.on("stop",function(e){var t=e.interaction;t.dropTarget=t.dropElement=t.prevDropTarget=t.prevDropElement=null});r.dynamicDrop=function(e){if(v.is.bool(e)){u=e;return r}return u};v.merge(o.eventTypes,["dragenter","dragleave","dropactivate","dropdeactivate","dropmove","drop"]);n.methodDict.drop="dropzone";l.drop=c.defaults;t.exports=c},{"../InteractEvent":3,"../Interactable":4,"../Interaction":5,"../defaultOptions":18,"../interact":21,"../scope":33,"../utils":44,"./base":6}],9:[function(e,t,i){"use strict";var n=e("./base");var c=e("../utils");var u=e("../InteractEvent");var r=e("../Interactable");var s=e("../Interaction");var o=e("../defaultOptions");var a={defaults:{enabled:false,origin:null,restrict:null},checker:function e(t,i,n,r,s){if(s.pointerIds.length>=2){return{name:"gesture"}}return null},getCursor:function e(){return""}};u.signals.on("new",function(e){var t=e.iEvent,i=e.interaction;if(t.type!=="gesturestart"){return}t.ds=0;i.gesture.startDistance=i.gesture.prevDistance=t.distance;i.gesture.startAngle=i.gesture.prevAngle=t.angle;i.gesture.scale=1});u.signals.on("new",function(e){var t=e.iEvent,i=e.interaction;if(t.type!=="gesturemove"){return}t.ds=t.scale-i.gesture.scale;i.target.fire(t);i.gesture.prevAngle=t.angle;i.gesture.prevDistance=t.distance;if(t.scale!==Infinity&&t.scale!==null&&t.scale!==undefined&&!isNaN(t.scale)){i.gesture.scale=t.scale}});r.prototype.gesturable=function(e){if(c.is.object(e)){this.options.gesture.enabled=e.enabled===false?false:true;this.setPerAction("gesture",e);this.setOnEvents("gesture",e);return this}if(c.is.bool(e)){this.options.gesture.enabled=e;if(!e){this.ongesturestart=this.ongesturestart=this.ongestureend=null}return this}return this.options.gesture};u.signals.on("set-delta",function(e){var t=e.interaction,i=e.iEvent,n=e.action,r=e.event,s=e.starting,o=e.ending,a=e.deltaSource;if(n!=="gesture"){return}var l=t.pointers;i.touches=[l[0],l[1]];if(s){i.distance=c.touchDistance(l,a);i.box=c.touchBBox(l);i.scale=1;i.ds=0;i.angle=c.touchAngle(l,undefined,a);i.da=0}else if(o||r instanceof u){i.distance=t.prevEvent.distance;i.box=t.prevEvent.box;i.scale=t.prevEvent.scale;i.ds=i.scale-1;i.angle=t.prevEvent.angle;i.da=i.angle-t.gesture.startAngle}else{i.distance=c.touchDistance(l,a);i.box=c.touchBBox(l);i.scale=i.distance/t.gesture.startDistance;i.angle=c.touchAngle(l,t.gesture.prevAngle,a);i.ds=i.scale-t.gesture.prevScale;i.da=i.angle-t.gesture.prevAngle}});s.signals.on("new",function(e){e.gesture={start:{x:0,y:0},startDistance:0,prevDistance:0,distance:0,scale:1,startAngle:0,prevAngle:0}});n.gesture=a;n.names.push("gesture");c.merge(r.eventTypes,["gesturestart","gesturemove","gestureend"]);n.methodDict.gesture="gesturable";o.gesture=a.defaults;t.exports=a},{"../InteractEvent":3,"../Interactable":4,"../Interaction":5,"../defaultOptions":18,"../utils":44,"./base":6}],10:[function(e,t,i){"use strict";var n=e("./base");var b=e("../utils");var r=e("../utils/browser");var s=e("../InteractEvent");var o=e("../Interactable");var a=e("../Interaction");var l=e("../defaultOptions");var f=r.supportsTouch||r.supportsPointerEvent?20:10;var c={defaults:{enabled:false,mouseButtons:null,origin:null,snap:null,restrict:null,inertia:null,autoScroll:null,square:false,preserveAspectRatio:false,axis:"xy",margin:NaN,edges:null,invert:"none"},checker:function e(t,i,n,r,s,o){if(!o){return null}var a=b.extend({},s.curCoords.page);var l=n.options;if(l.resize.enabled){var c=l.resize;var u={left:false,right:false,top:false,bottom:false};if(b.is.object(c.edges)){for(var d in u){u[d]=g(d,c.edges[d],a,s._eventTarget,r,o,c.margin||f)}u.left=u.left&&!u.right;u.top=u.top&&!u.bottom;if(u.left||u.right||u.top||u.bottom){return{name:"resize",edges:u}}}else{var h=l.resize.axis!=="y"&&a.x>o.right-f;var p=l.resize.axis!=="x"&&a.y>o.bottom-f;if(h||p){return{name:"resize",axes:(h?"x":"")+(p?"y":"")}}}}return null},cursors:r.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"},getCursor:function e(t){if(t.axis){return c.cursors[t.name+t.axis]}else if(t.edges){var i="";var n=["top","bottom","left","right"];for(var r=0;r<4;r++){if(t.edges[n[r]]){i+=n[r]}}return c.cursors[i]}}};s.signals.on("new",function(e){var t=e.iEvent,i=e.interaction;if(t.type!=="resizestart"||!i.prepared.edges){return}var n=i.target.getRect(i.element);var r=i.target.options.resize;if(r.square||r.preserveAspectRatio){var s=b.extend({},i.prepared.edges);s.top=s.top||s.left&&!s.bottom;s.left=s.left||s.top&&!s.right;s.bottom=s.bottom||s.right&&!s.top;s.right=s.right||s.bottom&&!s.left;i.prepared._linkedEdges=s}else{i.prepared._linkedEdges=null}if(r.preserveAspectRatio){i.resizeStartAspectRatio=n.width/n.height}i.resizeRects={start:n,current:b.extend({},n),inverted:b.extend({},n),previous:b.extend({},n),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}};t.rect=i.resizeRects.inverted;t.deltaRect=i.resizeRects.delta});s.signals.on("new",function(e){var t=e.iEvent,i=e.phase,n=e.interaction;if(i!=="move"||!n.prepared.edges){return}var r=n.target.options.resize;var s=r.invert;var o=s==="reposition"||s==="negate";var a=n.prepared.edges;var l=n.resizeRects.start;var c=n.resizeRects.current;var u=n.resizeRects.inverted;var d=n.resizeRects.delta;var h=b.extend(n.resizeRects.previous,u);var p=a;var f=t.dx;var g=t.dy;if(r.preserveAspectRatio||r.square){var m=r.preserveAspectRatio?n.resizeStartAspectRatio:1;a=n.prepared._linkedEdges;if(p.left&&p.bottom||p.right&&p.top){g=-f/m}else if(p.left||p.right){g=f/m}else if(p.top||p.bottom){f=g*m}}if(a.top){c.top+=g}if(a.bottom){c.bottom+=g}if(a.left){c.left+=f}if(a.right){c.right+=f}if(o){b.extend(u,c);if(s==="reposition"){var v=void 0;if(u.top>u.bottom){v=u.top;u.top=u.bottom;u.bottom=v}if(u.left>u.right){v=u.left;u.left=u.right;u.right=v}}}else{u.top=Math.min(c.top,l.bottom);u.bottom=Math.max(c.bottom,l.top);u.left=Math.min(c.left,l.right);u.right=Math.max(c.right,l.left)}u.width=u.right-u.left;u.height=u.bottom-u.top;for(var y in u){d[y]=u[y]-h[y]}t.edges=n.prepared.edges;t.rect=u;t.deltaRect=d});o.prototype.resizable=function(e){if(b.is.object(e)){this.options.resize.enabled=e.enabled===false?false:true;this.setPerAction("resize",e);this.setOnEvents("resize",e);if(/^x$|^y$|^xy$/.test(e.axis)){this.options.resize.axis=e.axis}else if(e.axis===null){this.options.resize.axis=l.resize.axis}if(b.is.bool(e.preserveAspectRatio)){this.options.resize.preserveAspectRatio=e.preserveAspectRatio}else if(b.is.bool(e.square)){this.options.resize.square=e.square}return this}if(b.is.bool(e)){this.options.resize.enabled=e;if(!e){this.onresizestart=this.onresizestart=this.onresizeend=null}return this}return this.options.resize};function g(e,t,i,n,r,s,o){if(!t){return false}if(t===true){var a=b.is.number(s.width)?s.width:s.right-s.left;var l=b.is.number(s.height)?s.height:s.bottom-s.top;if(a<0){if(e==="left"){e="right"}else if(e==="right"){e="left"}}if(l<0){if(e==="top"){e="bottom"}else if(e==="bottom"){e="top"}}if(e==="left"){return i.x<(a>=0?s.left:s.right)+o}if(e==="top"){return i.y<(l>=0?s.top:s.bottom)+o}if(e==="right"){return i.x>(a>=0?s.right:s.left)-o}if(e==="bottom"){return i.y>(l>=0?s.bottom:s.top)-o}}if(!b.is.element(n)){return false}return b.is.element(t)?t===n:b.matchesUpTo(n,t,r)}a.signals.on("new",function(e){e.resizeAxes="xy"});s.signals.on("set-delta",function(e){var t=e.interaction,i=e.iEvent,n=e.action;if(n!=="resize"||!t.resizeAxes){return}var r=t.target.options;if(r.resize.square){if(t.resizeAxes==="y"){i.dx=i.dy}else{i.dy=i.dx}i.axes="xy"}else{i.axes=t.resizeAxes;if(t.resizeAxes==="x"){i.dy=0}else if(t.resizeAxes==="y"){i.dx=0}}});n.resize=c;n.names.push("resize");b.merge(o.eventTypes,["resizestart","resizemove","resizeinertiastart","resizeinertiaresume","resizeend"]);n.methodDict.resize="resizable";l.resize=c.defaults;t.exports=c},{"../InteractEvent":3,"../Interactable":4,"../Interaction":5,"../defaultOptions":18,"../utils":44,"../utils/browser":36,"./base":6}],11:[function(e,t,i){"use strict";var o=e("./utils/raf");var d=e("./utils/window").getWindow;var h=e("./utils/is");var p=e("./utils/domUtils");var n=e("./Interaction");var r=e("./defaultOptions");var f={defaults:{enabled:false,container:null,margin:60,speed:300},interaction:null,i:null,x:0,y:0,isScrolling:false,prevTime:0,start:function e(t){f.isScrolling=true;o.cancel(f.i);f.interaction=t;f.prevTime=(new Date).getTime();f.i=o.request(f.scroll)},stop:function e(){f.isScrolling=false;o.cancel(f.i)},scroll:function e(){var t=f.interaction.target.options[f.interaction.prepared.name].autoScroll;var i=t.container||d(f.interaction.element);var n=(new Date).getTime();var r=(n-f.prevTime)/1e3;var s=t.speed*r;if(s>=1){if(h.window(i)){i.scrollBy(f.x*s,f.y*s)}else if(i){i.scrollLeft+=f.x*s;i.scrollTop+=f.y*s}f.prevTime=n}if(f.isScrolling){o.cancel(f.i);f.i=o.request(f.scroll)}},check:function e(t,i){var n=t.options;return n[i].autoScroll&&n[i].autoScroll.enabled},onInteractionMove:function e(t){var i=t.interaction,n=t.pointer;if(!(i.interacting()&&f.check(i.target,i.prepared.name))){return}if(i.simulation){f.x=f.y=0;return}var r=void 0;var s=void 0;var o=void 0;var a=void 0;var l=i.target.options[i.prepared.name].autoScroll;var c=l.container||d(i.element);if(h.window(c)){a=n.clientX<f.margin;r=n.clientY<f.margin;s=n.clientX>c.innerWidth-f.margin;o=n.clientY>c.innerHeight-f.margin}else{var u=p.getElementClientRect(c);a=n.clientX<u.left+f.margin;r=n.clientY<u.top+f.margin;s=n.clientX>u.right-f.margin;o=n.clientY>u.bottom-f.margin}f.x=s?1:a?-1:0;f.y=o?1:r?-1:0;if(!f.isScrolling){f.margin=l.margin;f.speed=l.speed;f.start(i)}}};n.signals.on("stop-active",function(){f.stop()});n.signals.on("action-move",f.onInteractionMove);r.perAction.autoScroll=f.defaults;t.exports=f},{"./Interaction":5,"./defaultOptions":18,"./utils/domUtils":39,"./utils/is":46,"./utils/raf":50,"./utils/window":52}],12:[function(e,t,i){"use strict";var n=e("../Interactable");var u=e("../actions/base");var r=e("../utils/is");var s=e("../utils/domUtils");var o=e("../utils"),a=o.warnOnce;n.prototype.getAction=function(e,t,i,n){var r=this.defaultActionChecker(e,t,i,n);if(this.options.actionChecker){return this.options.actionChecker(e,t,r,this,n,i)}return r};n.prototype.ignoreFrom=a(function(e){return this._backCompatOption("ignoreFrom",e)},"Interactable.ignoreForm() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue}).");n.prototype.allowFrom=a(function(e){return this._backCompatOption("allowFrom",e)},"Interactable.allowForm() has been deprecated. Use Interactble.draggable({allowFrom: newValue}).");n.prototype.testIgnore=function(e,t,i){if(!e||!r.element(i)){return false}if(r.string(e)){return s.matchesUpTo(i,e,t)}else if(r.element(e)){return s.nodeContains(e,i)}return false};n.prototype.testAllow=function(e,t,i){if(!e){return true}if(!r.element(i)){return false}if(r.string(e)){return s.matchesUpTo(i,e,t)}else if(r.element(e)){return s.nodeContains(e,i)}return false};n.prototype.testIgnoreAllow=function(e,t,i){return!this.testIgnore(e.ignoreFrom,t,i)&&this.testAllow(e.allowFrom,t,i)};n.prototype.actionChecker=function(e){if(r.function(e)){this.options.actionChecker=e;return this}if(e===null){delete this.options.actionChecker;return this}return this.options.actionChecker};n.prototype.styleCursor=function(e){if(r.bool(e)){this.options.styleCursor=e;return this}if(e===null){delete this.options.styleCursor;return this}return this.options.styleCursor};n.prototype.defaultActionChecker=function(e,t,i,n){var r=this.getRect(n);var s=t.buttons||{0:1,1:4,3:8,4:16}[t.button];var o=null;for(var a=0;a<u.names.length;a++){var l;l=u.names[a];var c=l;if(i.pointerIsDown&&/mouse|pointer/.test(i.pointerType)&&(s&this.options[c].mouseButtons)===0){continue}o=u[c].checker(e,t,this,n,i,r);if(o){return o}}}},{"../Interactable":4,"../actions/base":6,"../utils":44,"../utils/domUtils":39,"../utils/is":46}],13:[function(e,t,i){"use strict";var n=e("../interact");var r=e("../Interactable");var s=e("../Interaction");var o=e("../actions/base");var a=e("../defaultOptions");var p=e("../scope");var c=e("../utils");var l=e("../utils/Signals").new();e("./InteractableMethods");var f={signals:l,withinInteractionLimit:m,maxInteractions:Infinity,defaults:{perAction:{manualStart:false,max:Infinity,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}},setActionDefaults:function e(t){c.extend(t.defaults,f.defaults.perAction)},validateAction:d};s.signals.on("down",function(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget;if(t.interacting()){return}var s=h(t,i,n,r);g(t,s)});s.signals.on("move",function(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget;if(t.pointerType!=="mouse"||t.pointerIsDown||t.interacting()){return}var s=h(t,i,n,r);g(t,s)});s.signals.on("move",function(e){var t=e.interaction,i=e.event;if(!t.pointerIsDown||t.interacting()||!t.pointerWasMoved||!t.prepared.name){return}l.fire("before-start",e);var n=t.target;if(t.prepared.name&&n){if(n.options[t.prepared.name].manualStart||!m(n,t.element,t.prepared)){t.stop(i)}else{t.start(t.prepared,n,t.element)}}});function d(e,t,i,n){if(c.is.object(e)&&t.testIgnoreAllow(t.options[e.name],i,n)&&t.options[e.name].enabled&&m(t,i,e)){return e}return null}function u(e,t,i,n,r,s){for(var o=0,a=n.length;o<a;o++){var l=n[o];var c=r[o];var u=d(l.getAction(t,i,e,c),l,c,s);if(u){return{action:u,target:l,element:c}}}return{}}function h(e,t,i,n){var r=[];var s=[];var o=n;function a(e){r.push(e);s.push(o)}while(c.is.element(o)){r=[];s=[];p.interactables.forEachMatch(o,a);var l=u(e,t,i,r,s,n);if(l.action&&!l.target.options[l.action.name].manualStart){return l}o=c.parentNode(o)}return{}}function g(e,t){var i=t.action,n=t.target,r=t.element;i=i||{};if(e.target&&e.target.options.styleCursor){e.target._doc.documentElement.style.cursor=""}e.target=n;e.element=r;c.copyAction(e.prepared,i);if(n&&n.options.styleCursor){var s=i?o[i.name].getCursor(i):"";e.target._doc.documentElement.style.cursor=s}l.fire("prepared",{interaction:e})}s.signals.on("stop",function(e){var t=e.interaction;var i=t.target;if(i&&i.options.styleCursor){i._doc.documentElement.style.cursor=""}});function m(e,t,i){var n=e.options;var r=n[i.name].max;var s=n[i.name].maxPerElement;var o=0;var a=0;var l=0;if(!(r&&s&&f.maxInteractions)){return}for(var c=0;c<p.interactions.length;c++){var u;u=p.interactions[c];var d=u;var h=d.prepared.name;if(!d.interacting()){continue}o++;if(o>=f.maxInteractions){return false}if(d.target!==e){continue}a+=h===i.name|0;if(a>=r){return false}if(d.element===t){l++;if(h!==i.name||l>=s){return false}}}return f.maxInteractions>0}n.maxInteractions=function(e){if(c.is.number(e)){f.maxInteractions=e;return n}return f.maxInteractions};r.settingsMethods.push("styleCursor");r.settingsMethods.push("actionChecker");r.settingsMethods.push("ignoreFrom");r.settingsMethods.push("allowFrom");a.base.actionChecker=null;a.base.styleCursor=true;c.extend(a.perAction,f.defaults.perAction);t.exports=f},{"../Interactable":4,"../Interaction":5,"../actions/base":6,"../defaultOptions":18,"../interact":21,"../scope":33,"../utils":44,"../utils/Signals":34,"./InteractableMethods":12}],14:[function(e,t,i){"use strict";var p=e("./base");var f=e("../scope");var g=e("../utils/is");var n=e("../utils/domUtils"),m=n.parentNode;p.setActionDefaults(e("../actions/drag"));p.signals.on("before-start",function(e){var r=e.interaction,s=e.eventTarget,t=e.dx,i=e.dy;if(r.prepared.name!=="drag"){return}var n=Math.abs(t);var o=Math.abs(i);var a=r.target.options.drag;var l=a.startAxis;var c=n>o?"x":n<o?"y":"xy";r.prepared.axis=a.lockAxis==="start"?c[0]:a.lockAxis;if(c!=="xy"&&l!=="xy"&&l!==c){r.prepared.name=null;var u=s;var d=function e(t){if(t===r.target){return}var i=r.target.options.drag;if(!i.manualStart&&t.testIgnoreAllow(i,u,s)){var n=t.getAction(r.downPointer,r.downEvent,r,u);if(n&&n.name==="drag"&&v(c,t)&&p.validateAction(n,t,u,s)){return t}}};while(g.element(u)){var h=f.interactables.forEachMatch(u,d);if(h){r.prepared.name="drag";r.target=h;r.element=u;break}u=m(u)}}});function v(e,t){if(!t){return false}var i=t.options.drag.startAxis;return e==="xy"||i==="xy"||i===e}},{"../actions/drag":7,"../scope":33,"../utils/domUtils":39,"../utils/is":46,"./base":13}],15:[function(e,t,i){"use strict";e("./base").setActionDefaults(e("../actions/gesture"))},{"../actions/gesture":9,"./base":13}],16:[function(e,t,i){"use strict";var n=e("./base");var r=e("../Interaction");n.defaults.perAction.hold=0;n.defaults.perAction.delay=0;r.signals.on("new",function(e){e.autoStartHoldTimer=null});n.signals.on("prepared",function(e){var t=e.interaction;var i=s(t);if(i>0){t.autoStartHoldTimer=setTimeout(function(){t.start(t.prepared,t.target,t.element)},i)}});r.signals.on("move",function(e){var t=e.interaction,i=e.duplicate;if(t.pointerWasMoved&&!i){clearTimeout(t.autoStartHoldTimer)}});n.signals.on("before-start",function(e){var t=e.interaction;var i=s(t);if(i>0){t.prepared.name=null}});function s(e){var t=e.prepared&&e.prepared.name;if(!t){return null}var i=e.target.options;return i[t].hold||i[t].delay}t.exports={getHoldDuration:s}},{"../Interaction":5,"./base":13}],17:[function(e,t,i){"use strict";e("./base").setActionDefaults(e("../actions/resize"))},{"../actions/resize":10,"./base":13}],18:[function(e,t,i){"use strict";t.exports={base:{accept:null,preventDefault:"auto",deltaSource:"page"},perAction:{origin:{x:0,y:0},inertia:{enabled:false,resistance:10,minSpeed:100,endSpeed:10,allowResume:true,smoothEndDuration:300}}}},{}],19:[function(e,t,i){"use strict";e("./inertia");e("./modifiers/snap");e("./modifiers/restrict");e("./pointerEvents/base");e("./pointerEvents/holdRepeat");e("./pointerEvents/interactableTargets");e("./autoStart/hold");e("./actions/gesture");e("./actions/resize");e("./actions/drag");e("./actions/drop");e("./modifiers/snapSize");e("./modifiers/restrictEdges");e("./modifiers/restrictSize");e("./autoStart/gesture");e("./autoStart/resize");e("./autoStart/drag");e("./interactablePreventDefault.js");e("./autoScroll");t.exports=e("./interact")},{"./actions/drag":7,"./actions/drop":8,"./actions/gesture":9,"./actions/resize":10,"./autoScroll":11,"./autoStart/drag":14,"./autoStart/gesture":15,"./autoStart/hold":16,"./autoStart/resize":17,"./inertia":20,"./interact":21,"./interactablePreventDefault.js":22,"./modifiers/restrict":24,"./modifiers/restrictEdges":25,"./modifiers/restrictSize":26,"./modifiers/snap":27,"./modifiers/snapSize":28,"./pointerEvents/base":30,"./pointerEvents/holdRepeat":31,"./pointerEvents/interactableTargets":32}],20:[function(e,t,i){"use strict";var m=e("./InteractEvent");var c=e("./Interaction");var v=e("./modifiers/base");var y=e("./utils");var b=e("./utils/raf");c.signals.on("new",function(e){e.inertiaStatus={active:false,smoothEnd:false,allowResume:false,startEvent:null,upCoords:{},xe:0,ye:0,sx:0,sy:0,t0:0,vx0:0,vys:0,duration:0,lambda_v0:0,one_ve_v0:0,i:null};e.boundInertiaFrame=function(){return n.apply(e)};e.boundSmoothEndFrame=function(){return r.apply(e)}});c.signals.on("down",function(e){var t=e.interaction,i=e.event,n=e.pointer,r=e.eventTarget;var s=t.inertiaStatus;if(s.active){var o=r;while(y.is.element(o)){if(o===t.element){b.cancel(s.i);s.active=false;t.simulation=null;t.updatePointer(n);y.setCoords(t.curCoords,t.pointers);var a={interaction:t};c.signals.fire("before-action-move",a);c.signals.fire("action-resume",a);var l=new m(t,i,t.prepared.name,"inertiaresume",t.element);t.target.fire(l);t.prevEvent=l;v.resetStatuses(t.modifierStatuses);y.copyCoords(t.prevCoords,t.curCoords);break}o=y.parentNode(o)}}});c.signals.on("up",function(e){var t=e.interaction,i=e.event;var n=t.inertiaStatus;if(!t.interacting()||n.active){return}var r=t.target;var s=r&&r.options;var o=s&&t.prepared.name&&s[t.prepared.name].inertia;var a=(new Date).getTime();var l={};var c=y.extend({},t.curCoords.page);var u=t.pointerDelta.client.speed;var d=false;var h=void 0;var p=o&&o.enabled&&t.prepared.name!=="gesture"&&i!==n.startEvent;var f=p&&a-t.curCoords.timeStamp<50&&u>o.minSpeed&&u>o.endSpeed;var g={interaction:t,pageCoords:c,statuses:l,preEnd:true,requireEndOnly:true};if(p&&!f){v.resetStatuses(l);h=v.setAll(g);if(h.shouldMove&&h.locked){d=true}}if(!(f||d)){return}y.copyCoords(n.upCoords,t.curCoords);t.pointers[0]=n.startEvent=new m(t,i,t.prepared.name,"inertiastart",t.element);n.t0=a;n.active=true;n.allowResume=o.allowResume;t.simulation=n;r.fire(n.startEvent);if(f){n.vx0=t.pointerDelta.client.vx;n.vy0=t.pointerDelta.client.vy;n.v0=u;C(t,n);y.extend(c,t.curCoords.page);c.x+=n.xe;c.y+=n.ye;v.resetStatuses(l);h=v.setAll(g);n.modifiedXe+=h.dx;n.modifiedYe+=h.dy;n.i=b.request(t.boundInertiaFrame)}else{n.smoothEnd=true;n.xe=h.dx;n.ye=h.dy;n.sx=n.sy=0;n.i=b.request(t.boundSmoothEndFrame)}});c.signals.on("stop-active",function(e){var t=e.interaction;var i=t.inertiaStatus;if(i.active){b.cancel(i.i);i.active=false;t.simulation=null}});function C(e,t){var i=e.target.options[e.prepared.name].inertia;var n=i.resistance;var r=-Math.log(i.endSpeed/t.v0)/n;t.x0=e.prevEvent.pageX;t.y0=e.prevEvent.pageY;t.t0=t.startEvent.timeStamp/1e3;t.sx=t.sy=0;t.modifiedXe=t.xe=(t.vx0-r)/n;t.modifiedYe=t.ye=(t.vy0-r)/n;t.te=r;t.lambda_v0=n/t.v0;t.one_ve_v0=1-i.endSpeed/t.v0}function n(){o(this);y.setCoordDeltas(this.pointerDelta,this.prevCoords,this.curCoords);var e=this.inertiaStatus;var t=this.target.options[this.prepared.name].inertia;var i=t.resistance;var n=(new Date).getTime()/1e3-e.t0;if(n<e.te){var r=1-(Math.exp(-i*n)-e.lambda_v0)/e.one_ve_v0;if(e.modifiedXe===e.xe&&e.modifiedYe===e.ye){e.sx=e.xe*r;e.sy=e.ye*r}else{var s=y.getQuadraticCurvePoint(0,0,e.xe,e.ye,e.modifiedXe,e.modifiedYe,r);e.sx=s.x;e.sy=s.y}this.doMove();e.i=b.request(this.boundInertiaFrame)}else{e.sx=e.modifiedXe;e.sy=e.modifiedYe;this.doMove();this.end(e.startEvent);e.active=false;this.simulation=null}y.copyCoords(this.prevCoords,this.curCoords)}function r(){o(this);var e=this.inertiaStatus;var t=(new Date).getTime()-e.t0;var i=this.target.options[this.prepared.name].inertia.smoothEndDuration;if(t<i){e.sx=y.easeOutQuad(t,0,e.xe,i);e.sy=y.easeOutQuad(t,0,e.ye,i);this.pointerMove(e.startEvent,e.startEvent);e.i=b.request(this.boundSmoothEndFrame)}else{e.sx=e.xe;e.sy=e.ye;this.pointerMove(e.startEvent,e.startEvent);this.end(e.startEvent);e.smoothEnd=e.active=false;this.simulation=null}}function o(e){var t=e.inertiaStatus;if(!t.active){return}var i=t.upCoords.page;var n=t.upCoords.client;y.setCoords(e.curCoords,[{pageX:i.x+t.sx,pageY:i.y+t.sy,clientX:n.x+t.sx,clientY:n.y+t.sy}])}},{"./InteractEvent":3,"./Interaction":5,"./modifiers/base":23,"./utils":44,"./utils/raf":50}],21:[function(e,t,i){"use strict";var n=e("./utils/browser");var l=e("./utils/events");var c=e("./utils");var u=e("./scope");var d=e("./Interactable");var r=e("./Interaction");var h={};function p(e,t){var i=u.interactables.get(e,t);if(!i){i=new d(e,t);i.events.global=h}return i}p.isSet=function(e,t){return u.interactables.indexOfElement(e,t&&t.context)!==-1};p.on=function(e,t,i){if(c.is.string(e)&&e.search(" ")!==-1){e=e.trim().split(/ +/)}if(c.is.array(e)){for(var n=0;n<e.length;n++){var r;r=e[n];var s=r;p.on(s,t,i)}return p}if(c.is.object(e)){for(var o in e){p.on(o,e[o],t)}return p}if(c.contains(d.eventTypes,e)){if(!h[e]){h[e]=[t]}else{h[e].push(t)}}else{l.add(u.document,e,t,{options:i})}return p};p.off=function(e,t,i){if(c.is.string(e)&&e.search(" ")!==-1){e=e.trim().split(/ +/)}if(c.is.array(e)){for(var n=0;n<e.length;n++){var r;r=e[n];var s=r;p.off(s,t,i)}return p}if(c.is.object(e)){for(var o in e){p.off(o,e[o],t)}return p}if(!c.contains(d.eventTypes,e)){l.remove(u.document,e,t,i)}else{var a=void 0;if(e in h&&(a=h[e].indexOf(t))!==-1){h[e].splice(a,1)}}return p};p.debug=function(){return u};p.getPointerAverage=c.pointerAverage;p.getTouchBBox=c.touchBBox;p.getTouchDistance=c.touchDistance;p.getTouchAngle=c.touchAngle;p.getElementRect=c.getElementRect;p.getElementClientRect=c.getElementClientRect;p.matchesSelector=c.matchesSelector;p.closest=c.closest;p.supportsTouch=function(){return n.supportsTouch};p.supportsPointerEvent=function(){return n.supportsPointerEvent};p.stop=function(e){for(var t=u.interactions.length-1;t>=0;t--){u.interactions[t].stop(e)}return p};p.pointerMoveTolerance=function(e){if(c.is.number(e)){r.pointerMoveTolerance=e;return p}return r.pointerMoveTolerance};p.addDocument=u.addDocument;p.removeDocument=u.removeDocument;u.interact=p;t.exports=p},{"./Interactable":4,"./Interaction":5,"./scope":33,"./utils":44,"./utils/browser":36,"./utils/events":40}],22:[function(e,t,i){"use strict";var n=e("./Interactable");var r=e("./Interaction");var s=e("./scope");var o=e("./utils/is");var a=e("./utils/events");var l=e("./utils/browser");var c=e("./utils/domUtils"),u=c.nodeContains,d=c.matchesSelector;n.prototype.preventDefault=function(e){if(/^(always|never|auto)$/.test(e)){this.options.preventDefault=e;return this}if(o.bool(e)){this.options.preventDefault=e?"always":"never";return this}return this.options.preventDefault};n.prototype.checkAndPreventDefault=function(e){var t=this.options.preventDefault;if(t==="never"){return}if(t==="always"){e.preventDefault();return}if(a.supportsPassive&&/^touch(start|move)$/.test(e.type)&&!l.isIOS){return}if(/^(mouse|pointer|touch)*(down|start)/i.test(e.type)){return}if(o.element(e.target)&&d(e.target,"input,select,textarea,[contenteditable=true],[contenteditable=true] *")){return}e.preventDefault()};function h(e){var t=e.interaction,i=e.event;if(t.target){t.target.checkAndPreventDefault(i)}}var p=["down","move","up","cancel"];for(var f=0;f<p.length;f++){var g=p[f];r.signals.on(g,h)}r.docEvents.dragstart=function e(t){for(var i=0;i<s.interactions.length;i++){var n;n=s.interactions[i];var r=n;if(r.element&&(r.element===t.target||u(r.element,t.target))){r.target.checkAndPreventDefault(t);return}}}},{"./Interactable":4,"./Interaction":5,"./scope":33,"./utils/browser":36,"./utils/domUtils":39,"./utils/events":40,"./utils/is":46}],23:[function(e,t,i){"use strict";var n=e("../InteractEvent");var r=e("../Interaction");var h=e("../utils/extend");var p={names:[],setOffsets:function e(t){var i=t.interaction,n=t.pageCoords;var r=i.target,s=i.element,o=i.startOffset;var a=r.getRect(s);if(a){o.left=n.x-a.left;o.top=n.y-a.top;o.right=a.right-n.x;o.bottom=a.bottom-n.y;if(!("width"in a)){a.width=a.right-a.left}if(!("height"in a)){a.height=a.bottom-a.top}}else{o.left=o.top=o.right=o.bottom=0}t.rect=a;t.interactable=r;t.element=s;for(var l=0;l<p.names.length;l++){var c;c=p.names[l];var u=c;t.options=r.options[i.prepared.name][u];if(!t.options){continue}i.modifierOffsets[u]=p[u].setOffset(t)}},setAll:function e(t){var i=t.interaction,n=t.statuses,r=t.preEnd,s=t.requireEndOnly;var o={dx:0,dy:0,changed:false,locked:false,shouldMove:true};t.modifiedCoords=h({},t.pageCoords);for(var a=0;a<p.names.length;a++){var l;l=p.names[a];var c=l;var u=p[c];var d=i.target.options[i.prepared.name][c];if(!f(d,r,s)){continue}t.status=t.status=n[c];t.options=d;t.offset=t.interaction.modifierOffsets[c];u.set(t);if(t.status.locked){t.modifiedCoords.x+=t.status.dx;t.modifiedCoords.y+=t.status.dy;o.dx+=t.status.dx;o.dy+=t.status.dy;o.locked=true}}o.shouldMove=!t.status||!o.locked||t.status.changed;return o},resetStatuses:function e(t){for(var i=0;i<p.names.length;i++){var n;n=p.names[i];var r=n;var s=t[r]||{};s.dx=s.dy=0;s.modifiedX=s.modifiedY=NaN;s.locked=false;s.changed=true;t[r]=s}return t},start:function e(t,i){var n=t.interaction;var r={interaction:n,pageCoords:(i==="action-resume"?n.curCoords:n.startCoords).page,startOffset:n.startOffset,statuses:n.modifierStatuses,preEnd:false,requireEndOnly:false};p.setOffsets(r);p.resetStatuses(r.statuses);r.pageCoords=h({},n.startCoords.page);n.modifierResult=p.setAll(r)},beforeMove:function e(t){var i=t.interaction,n=t.preEnd,r=t.interactingBeforeMove;var s=p.setAll({interaction:i,preEnd:n,pageCoords:i.curCoords.page,statuses:i.modifierStatuses,requireEndOnly:false});if(!s.shouldMove&&r){i._dontFireMove=true}i.modifierResult=s},end:function e(t){var i=t.interaction,n=t.event;for(var r=0;r<p.names.length;r++){var s;s=p.names[r];var o=s;var a=i.target.options[i.prepared.name][o];if(f(a,true,true)){i.doMove({event:n,preEnd:true});break}}},setXY:function e(t){var i=t.iEvent,n=t.interaction;var r=h({},t);for(var s=0;s<p.names.length;s++){var o=p.names[s];r.options=n.target.options[n.prepared.name][o];if(!r.options){continue}var a=p[o];r.status=n.modifierStatuses[o];i[o]=a.modifyCoords(r)}}};r.signals.on("new",function(e){e.startOffset={left:0,right:0,top:0,bottom:0};e.modifierOffsets={};e.modifierStatuses=p.resetStatuses({});e.modifierResult=null});r.signals.on("action-start",p.start);r.signals.on("action-resume",p.start);r.signals.on("before-action-move",p.beforeMove);r.signals.on("action-end",p.end);n.signals.on("set-xy",p.setXY);function f(e,t,i){return e&&e.enabled&&(t||!e.endOnly)&&(!i||e.endOnly)}t.exports=p},{"../InteractEvent":3,"../Interaction":5,"../utils/extend":41}],24:[function(e,t,i){"use strict";var n=e("./base");var h=e("../utils");var r=e("../defaultOptions");var s={defaults:{enabled:false,endOnly:false,restriction:null,elementRect:null},setOffset:function e(t){var i=t.rect,n=t.startOffset,r=t.options;var s=r&&r.elementRect;var o={};if(i&&s){o.left=n.left-i.width*s.left;o.top=n.top-i.height*s.top;o.right=n.right-i.width*(1-s.right);o.bottom=n.bottom-i.height*(1-s.bottom)}else{o.left=o.top=o.right=o.bottom=0}return o},set:function e(t){var i=t.modifiedCoords,n=t.interaction,r=t.status,s=t.options;if(!s){return r}var o=r.useStatusXY?{x:r.x,y:r.y}:h.extend({},i);var a=p(s.restriction,n,o);if(!a){return r}r.dx=0;r.dy=0;r.locked=false;var l=a;var c=o.x;var u=o.y;var d=n.modifierOffsets.restrict;if("x"in a&&"y"in a){c=Math.max(Math.min(l.x+l.width-d.right,o.x),l.x+d.left);u=Math.max(Math.min(l.y+l.height-d.bottom,o.y),l.y+d.top)}else{c=Math.max(Math.min(l.right-d.right,o.x),l.left+d.left);u=Math.max(Math.min(l.bottom-d.bottom,o.y),l.top+d.top)}r.dx=c-o.x;r.dy=u-o.y;r.changed=r.modifiedX!==c||r.modifiedY!==u;r.locked=!!(r.dx||r.dy);r.modifiedX=c;r.modifiedY=u},modifyCoords:function e(t){var i=t.page,n=t.client,r=t.status,s=t.phase,o=t.options;var a=o&&o.elementRect;if(o&&o.enabled&&!(s==="start"&&a&&r.locked)){if(r.locked){i.x+=r.dx;i.y+=r.dy;n.x+=r.dx;n.y+=r.dy;return{dx:r.dx,dy:r.dy}}}},getRestrictionRect:p};function p(e,t,i){if(h.is.function(e)){return h.resolveRectLike(e,t.target,t.element,[i.x,i.y,t])}else{return h.resolveRectLike(e,t.target,t.element)}}n.restrict=s;n.names.push("restrict");r.perAction.restrict=s.defaults;t.exports=s},{"../defaultOptions":18,"../utils":44,"./base":23}],25:[function(e,t,i){"use strict";var n=e("./base");var p=e("../utils");var f=e("../utils/rect");var r=e("../defaultOptions");var s=e("../actions/resize");var o=e("./restrict"),g=o.getRestrictionRect;var m={top:+Infinity,left:+Infinity,bottom:-Infinity,right:-Infinity};var v={top:-Infinity,left:-Infinity,bottom:+Infinity,right:+Infinity};var a={defaults:{enabled:false,endOnly:false,min:null,max:null,offset:null},setOffset:function e(t){var i=t.interaction,n=t.startOffset,r=t.options;if(!r){return p.extend({},n)}var s=g(r.offset,i,i.startCoords.page);if(s){return{top:n.top+s.y,left:n.left+s.x,bottom:n.bottom+s.y,right:n.right+s.x}}return n},set:function e(t){var i=t.modifiedCoords,n=t.interaction,r=t.status,s=t.offset,o=t.options;var a=n.prepared.linkedEdges||n.prepared.edges;if(!n.interacting()||!a){return}var l=r.useStatusXY?{x:r.x,y:r.y}:p.extend({},i);var c=f.xywhToTlbr(g(o.inner,n,l))||m;var u=f.xywhToTlbr(g(o.outer,n,l))||v;var d=l.x;var h=l.y;r.dx=0;r.dy=0;r.locked=false;if(a.top){h=Math.min(Math.max(u.top+s.top,l.y),c.top+s.top)}else if(a.bottom){h=Math.max(Math.min(u.bottom-s.bottom,l.y),c.bottom-s.bottom)}if(a.left){d=Math.min(Math.max(u.left+s.left,l.x),c.left+s.left)}else if(a.right){d=Math.max(Math.min(u.right-s.right,l.x),c.right-s.right)}r.dx=d-l.x;r.dy=h-l.y;r.changed=r.modifiedX!==d||r.modifiedY!==h;r.locked=!!(r.dx||r.dy);r.modifiedX=d;r.modifiedY=h},modifyCoords:function e(t){var i=t.page,n=t.client,r=t.status,s=t.phase,o=t.options;if(o&&o.enabled&&!(s==="start"&&r.locked)){if(r.locked){i.x+=r.dx;i.y+=r.dy;n.x+=r.dx;n.y+=r.dy;return{dx:r.dx,dy:r.dy}}}},noInner:m,noOuter:v,getRestrictionRect:g};n.restrictEdges=a;n.names.push("restrictEdges");r.perAction.restrictEdges=a.defaults;s.defaults.restrictEdges=a.defaults;t.exports=a},{"../actions/resize":10,"../defaultOptions":18,"../utils":44,"../utils/rect":51,"./base":23,"./restrict":24}],26:[function(e,t,i){"use strict";var n=e("./base");var l=e("./restrictEdges");var c=e("../utils");var u=e("../utils/rect");var r=e("../defaultOptions");var s=e("../actions/resize");var d={width:-Infinity,height:-Infinity};var h={width:+Infinity,height:+Infinity};var o={defaults:{enabled:false,endOnly:false,min:null,max:null},setOffset:function e(t){var i=t.interaction;return i.startOffset},set:function e(t){var i=t.interaction,n=t.options;var r=i.prepared.linkedEdges||i.prepared.edges;if(!i.interacting()||!r){return}var s=u.xywhToTlbr(i.resizeRects.inverted);var o=u.tlbrToXywh(l.getRestrictionRect(n.min,i))||d;var a=u.tlbrToXywh(l.getRestrictionRect(n.max,i))||h;t.options={enabled:n.enabled,endOnly:n.endOnly,inner:c.extend({},l.noInner),outer:c.extend({},l.noOuter)};if(r.top){t.options.inner.top=s.bottom-o.height;t.options.outer.top=s.bottom-a.height}else if(r.bottom){t.options.inner.bottom=s.top+o.height;t.options.outer.bottom=s.top+a.height}if(r.left){t.options.inner.left=s.right-o.width;t.options.outer.left=s.right-a.width}else if(r.right){t.options.inner.right=s.left+o.width;t.options.outer.right=s.left+a.width}l.set(t)},modifyCoords:l.modifyCoords};n.restrictSize=o;n.names.push("restrictSize");r.perAction.restrictSize=o.defaults;s.defaults.restrictSize=o.defaults;t.exports=o},{"../actions/resize":10,"../defaultOptions":18,"../utils":44,"../utils/rect":51,"./base":23,"./restrictEdges":25}],27:[function(e,t,i){"use strict";var n=e("./base");var r=e("../interact");var M=e("../utils");var s=e("../defaultOptions");var o={defaults:{enabled:false,endOnly:false,range:Infinity,targets:null,offsets:null,relativePoints:null},setOffset:function e(t){var i=t.interaction,n=t.interactable,r=t.element,s=t.rect,o=t.startOffset,a=t.options;var l=[];var c=M.rectToXY(M.resolveRectLike(a.origin));var u=c||M.getOriginXY(n,r,i.prepared.name);a=a||n.options[i.prepared.name].snap||{};var d=void 0;if(a.offset==="startCoords"){d={x:i.startCoords.page.x-u.x,y:i.startCoords.page.y-u.y}}else{var h=M.resolveRectLike(a.offset,n,r,[i]);d=M.rectToXY(h)||{x:0,y:0}}if(s&&a.relativePoints&&a.relativePoints.length){for(var p=0;p<a.relativePoints.length;p++){var f;f=a.relativePoints[p];var g=f;var m=g.x;var v=g.y;l.push({x:o.left-s.width*m+d.x,y:o.top-s.height*v+d.y})}}else{l.push(d)}return l},set:function e(t){var i=t.interaction,n=t.modifiedCoords,r=t.status,s=t.options,o=t.offset;var a=[];var l=void 0;var c=void 0;var u=void 0;if(r.useStatusXY){c={x:r.x,y:r.y}}else{var d=M.getOriginXY(i.target,i.element,i.prepared.name);c=M.extend({},n);c.x-=d.x;c.y-=d.y}r.realX=c.x;r.realY=c.y;var h=s.targets?s.targets.length:0;for(var p=0;p<o.length;p++){var f;f=o[p];var g=f;var m=g.x;var v=g.y;var y=c.x-m;var b=c.y-v;for(var C=0;C<(s.targets||[]).length;C++){var w;w=(s.targets||[])[C];var _=w;if(M.is.function(_)){l=_(y,b,i)}else{l=_}if(!l){continue}a.push({x:M.is.number(l.x)?l.x+m:y,y:M.is.number(l.y)?l.y+v:b,range:M.is.number(l.range)?l.range:s.range})}}var A={target:null,inRange:false,distance:0,range:0,dx:0,dy:0};for(u=0,h=a.length;u<h;u++){l=a[u];var E=l.range;var S=l.x-c.x;var T=l.y-c.y;var x=M.hypot(S,T);var D=x<=E;if(E===Infinity&&A.inRange&&A.range!==Infinity){D=false}if(!A.target||(D?A.inRange&&E!==Infinity?x/E<A.distance/A.range:E===Infinity&&A.range!==Infinity||x<A.distance:!A.inRange&&x<A.distance)){A.target=l;A.distance=x;A.range=E;A.inRange=D;A.dx=S;A.dy=T;r.range=E}}var R=void 0;if(A.target){R=r.modifiedX!==A.target.x||r.modifiedY!==A.target.y;r.modifiedX=A.target.x;r.modifiedY=A.target.y}else{R=true;r.modifiedX=NaN;r.modifiedY=NaN}r.dx=A.dx;r.dy=A.dy;r.changed=R||A.inRange&&!r.locked;r.locked=A.inRange},modifyCoords:function e(t){var i=t.page,n=t.client,r=t.status,s=t.phase,o=t.options;var a=o&&o.relativePoints;if(o&&o.enabled&&!(s==="start"&&a&&a.length)){if(r.locked){i.x+=r.dx;i.y+=r.dy;n.x+=r.dx;n.y+=r.dy}return{range:r.range,locked:r.locked,x:r.modifiedX,y:r.modifiedY,realX:r.realX,realY:r.realY,dx:r.dx,dy:r.dy}}}};r.createSnapGrid=function(c){return function(e,t){var i=c.limits||{left:-Infinity,right:Infinity,top:-Infinity,bottom:Infinity};var n=0;var r=0;if(M.is.object(c.offset)){n=c.offset.x;r=c.offset.y}var s=Math.round((e-n)/c.x);var o=Math.round((t-r)/c.y);var a=Math.max(i.left,Math.min(i.right,s*c.x+n));var l=Math.max(i.top,Math.min(i.bottom,o*c.y+r));return{x:a,y:l,range:c.range}}};n.snap=o;n.names.push("snap");s.perAction.snap=o.defaults;t.exports=o},{"../defaultOptions":18,"../interact":21,"../utils":44,"./base":23}],28:[function(e,t,i){"use strict";var n=e("./base");var p=e("./snap");var r=e("../defaultOptions");var s=e("../actions/resize");var f=e("../utils/");var o={defaults:{enabled:false,endOnly:false,range:Infinity,targets:null,offsets:null},setOffset:function e(t){var i=t.interaction,n=t.options;var r=i.prepared.edges;if(!r){return}t.options={relativePoints:[{x:r.left?0:1,y:r.top?0:1}],origin:{x:0,y:0},offset:"self",range:n.range};var s=p.setOffset(t);t.options=n;return s},set:function e(t){var i=t.interaction,n=t.options,r=t.offset,s=t.modifiedCoords;var o=f.extend({},s);var a=o.x-r[0].x;var l=o.y-r[0].y;t.options=f.extend({},n);t.options.targets=[];for(var c=0;c<(n.targets||[]).length;c++){var u;u=(n.targets||[])[c];var d=u;var h=void 0;if(f.is.function(d)){h=d(a,l,i)}else{h=d}if(!h){continue}if("width"in h&&"height"in h){h.x=h.width;h.y=h.height}t.options.targets.push(h)}p.set(t)},modifyCoords:function e(t){var i=t.options;t.options=f.extend({},i);t.options.enabled=i.enabled;t.options.relativePoints=[null];p.modifyCoords(t)}};n.snapSize=o;n.names.push("snapSize");r.perAction.snapSize=o.defaults;s.defaults.snapSize=o.defaults;t.exports=o},{"../actions/resize":10,"../defaultOptions":18,"../utils/":44,"./base":23,"./snap":27}],29:[function(e,t,i){"use strict";function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=e("../utils/pointerUtils");t.exports=function(){function a(e,t,i,n,r){l(this,a);c.pointerExtend(this,i);if(i!==t){c.pointerExtend(this,t)}this.interaction=r;this.timeStamp=(new Date).getTime();this.originalEvent=i;this.type=e;this.pointerId=c.getPointerId(t);this.pointerType=c.getPointerType(t);this.target=n;this.currentTarget=null;if(e==="tap"){var s=r.getPointerIndex(t);this.dt=this.timeStamp-r.downTimes[s];var o=this.timeStamp-r.tapTime;this.double=!!(r.prevTap&&r.prevTap.type!=="doubletap"&&r.prevTap.target===this.target&&o<500)}else if(e==="doubletap"){this.dt=t.timeStamp-r.tapTime}}a.prototype.subtractOrigin=function e(t){var i=t.x,n=t.y;this.pageX-=i;this.pageY-=n;this.clientX-=i;this.clientY-=n;return this};a.prototype.addOrigin=function e(t){var i=t.x,n=t.y;this.pageX+=i;this.pageY+=n;this.clientX+=i;this.clientY+=n;return this};a.prototype.preventDefault=function e(){this.originalEvent.preventDefault()};a.prototype.stopPropagation=function e(){this.propagationStopped=true};a.prototype.stopImmediatePropagation=function e(){this.immediatePropagationStopped=this.propagationStopped=true};return a}()},{"../utils/pointerUtils":49}],30:[function(e,t,i){"use strict";var v=e("./PointerEvent");var n=e("../Interaction");var y=e("../utils");var r=e("../defaultOptions");var b=e("../utils/Signals").new();var s=["down","up","cancel"];var o=["down","up","cancel"];var a={PointerEvent:v,fire:C,collectEventTargets:w,signals:b,defaults:{holdDuration:600,ignoreFrom:null,allowFrom:null,origin:{x:0,y:0}},types:["down","move","up","cancel","tap","doubletap","hold"]};function C(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget,s=e.type,o=s===undefined?e.pointerEvent.type:s,a=e.targets,l=a===undefined?w(e):a,c=e.pointerEvent,u=c===undefined?new v(o,i,n,r,t):c;var d={interaction:t,pointer:i,event:n,eventTarget:r,targets:l,type:o,pointerEvent:u};for(var h=0;h<l.length;h++){var p=l[h];for(var f in p.props||{}){u[f]=p.props[f]}var g=y.getOriginXY(p.eventable,p.element);u.subtractOrigin(g);u.eventable=p.eventable;u.currentTarget=p.element;p.eventable.fire(u);u.addOrigin(g);if(u.immediatePropagationStopped||u.propagationStopped&&h+1<l.length&&l[h+1].element!==u.currentTarget){break}}b.fire("fired",d);if(o==="tap"){var m=u.double?C({interaction:t,pointer:i,event:n,eventTarget:r,type:"doubletap"}):u;t.prevTap=m;t.tapTime=m.timeStamp}return u}function w(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget,s=e.type;var o=t.getPointerIndex(i);if(s==="tap"&&(t.pointerWasMoved||!(t.downTargets[o]&&t.downTargets[o]===r))){return[]}var a=y.getPath(r);var l={interaction:t,pointer:i,event:n,eventTarget:r,type:s,path:a,targets:[],element:null};for(var c=0;c<a.length;c++){var u;u=a[c];var d=u;l.element=d;b.fire("collect-targets",l)}if(s==="hold"){l.targets=l.targets.filter(function(e){return e.eventable.options.holdDuration===t.holdTimers[o].duration})}return l.targets}n.signals.on("update-pointer-down",function(e){var t=e.interaction,i=e.pointerIndex;t.holdTimers[i]={duration:Infinity,timeout:null}});n.signals.on("remove-pointer",function(e){var t=e.interaction,i=e.pointerIndex;t.holdTimers.splice(i,1)});n.signals.on("move",function(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget,s=e.duplicateMove;var o=t.getPointerIndex(i);if(!s&&(!t.pointerIsDown||t.pointerWasMoved)){if(t.pointerIsDown){clearTimeout(t.holdTimers[o].timeout)}C({interaction:t,pointer:i,event:n,eventTarget:r,type:"move"})}});n.signals.on("down",function(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget,s=e.pointerIndex;var o=t.holdTimers[s];var a=y.getPath(r);var l={interaction:t,pointer:i,event:n,eventTarget:r,type:"hold",targets:[],path:a,element:null};for(var c=0;c<a.length;c++){var u;u=a[c];var d=u;l.element=d;b.fire("collect-targets",l)}if(!l.targets.length){return}var h=Infinity;for(var p=0;p<l.targets.length;p++){var f;f=l.targets[p];var g=f;var m=g.eventable.options.holdDuration;if(m<h){h=m}}o.duration=h;o.timeout=setTimeout(function(){C({interaction:t,eventTarget:r,pointer:i,event:n,type:"hold"})},h)});n.signals.on("up",function(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget;if(!t.pointerWasMoved){C({interaction:t,eventTarget:r,pointer:i,event:n,type:"tap"})}});var l=["up","cancel"];for(var c=0;c<l.length;c++){var u=l[c];n.signals.on(u,function(e){var t=e.interaction,i=e.pointerIndex;if(t.holdTimers[i]){clearTimeout(t.holdTimers[i].timeout)}})}function d(s){return function(e){var t=e.interaction,i=e.pointer,n=e.event,r=e.eventTarget;C({interaction:t,eventTarget:r,pointer:i,event:n,type:s})}}for(var h=0;h<s.length;h++){n.signals.on(s[h],d(o[h]))}n.signals.on("new",function(e){e.prevTap=null;e.tapTime=0;e.holdTimers=[]});r.pointerEvents=a.defaults;t.exports=a},{"../Interaction":5,"../defaultOptions":18,"../utils":44,"../utils/Signals":34,"./PointerEvent":29}],31:[function(e,t,i){"use strict";var o=e("./base");var n=e("../Interaction");o.signals.on("new",l);o.signals.on("fired",c);var r=["move","up","cancel","endall"];for(var s=0;s<r.length;s++){var a=r[s];n.signals.on(a,u)}function l(e){var t=e.pointerEvent;if(t.type!=="hold"){return}t.count=(t.count||0)+1}function c(e){var t=e.interaction,i=e.pointerEvent,n=e.eventTarget,r=e.targets;if(i.type!=="hold"||!r.length){return}var s=r[0].eventable.options.holdRepeatInterval;if(s<=0){return}t.holdIntervalHandle=setTimeout(function(){o.fire({interaction:t,eventTarget:n,type:"hold",pointer:i,event:i})},s)}function u(e){var t=e.interaction;if(t.holdIntervalHandle){clearInterval(t.holdIntervalHandle);t.holdIntervalHandle=null}}o.defaults.holdRepeatInterval=0;o.types.push("holdrepeat");t.exports={onNew:l,onFired:c,endHoldRepeat:u}},{"../Interaction":5,"./base":30}],32:[function(e,t,i){"use strict";var n=e("./base");var r=e("../Interactable");var a=e("../utils/is");var l=e("../scope");var s=e("../utils/extend");var o=e("../utils/arr"),c=o.merge;n.signals.on("collect-targets",function(e){var n=e.targets,r=e.element,s=e.type,o=e.eventTarget;l.interactables.forEachMatch(r,function(e){var t=e.events;var i=t.options;if(t[s]&&a.element(r)&&e.testIgnoreAllow(i,r,o)){n.push({element:r,eventable:t,props:{interactable:e}})}})});r.signals.on("new",function(e){var t=e.interactable;t.events.getRect=function(e){return t.getRect(e)}});r.signals.on("set",function(e){var t=e.interactable,i=e.options;s(t.events.options,n.defaults);s(t.events.options,i)});c(r.eventTypes,n.types);r.prototype.pointerEvents=function(e){s(this.events.options,e);return this};var u=r.prototype._backCompatOption;r.prototype._backCompatOption=function(e,t){var i=u.call(this,e,t);if(i===this){this.events.options[e]=t}return i};r.settingsMethods.push("pointerEvents")},{"../Interactable":4,"../scope":33,"../utils/arr":35,"../utils/extend":41,"../utils/is":46,"./base":30}],33:[function(e,t,i){"use strict";var n=e("./utils");var r=e("./utils/events");var s=e("./utils/Signals").new();var o=e("./utils/window"),a=o.getWindow;var l={signals:s,events:r,utils:n,document:e("./utils/domObjects").document,documents:[],addDocument:function e(t,i){if(n.contains(l.documents,t)){return false}i=i||a(t);l.documents.push(t);r.documents.push(t);if(t!==l.document){r.add(i,"unload",l.onWindowUnload)}s.fire("add-document",{doc:t,win:i})},removeDocument:function e(t,i){var n=l.documents.indexOf(t);i=i||a(t);r.remove(i,"unload",l.onWindowUnload);l.documents.splice(n,1);r.documents.splice(n,1);s.fire("remove-document",{win:i,doc:t})},onWindowUnload:function e(){l.removeDocument(this.document,this)}};t.exports=l},{"./utils":44,"./utils/Signals":34,"./utils/domObjects":38,"./utils/events":40,"./utils/window":52}],34:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var r=function(){function e(){n(this,e);this.listeners={}}e.prototype.on=function e(t,i){if(!this.listeners[t]){this.listeners[t]=[i];return}this.listeners[t].push(i)};e.prototype.off=function e(t,i){if(!this.listeners[t]){return}var n=this.listeners[t].indexOf(i);if(n!==-1){this.listeners[t].splice(n,1)}};e.prototype.fire=function e(t,i){var n=this.listeners[t];if(!n){return}for(var r=0;r<n.length;r++){var s;s=n[r];var o=s;if(o(i,t)===false){return}}};return e}();r.new=function(){return new r};t.exports=r},{}],35:[function(e,t,i){"use strict";function n(e,t){return e.indexOf(t)!==-1}function r(e,t){for(var i=0;i<t.length;i++){var n;n=t[i];var r=n;e.push(r)}return e}t.exports={contains:n,merge:r}},{}],36:[function(e,t,i){"use strict";var n=e("./window"),r=n.window;var s=e("./is");var o=e("./domObjects");var a=o.Element;var l=r.navigator;var c={supportsTouch:!!("ontouchstart"in r||s.function(r.DocumentTouch)&&o.document instanceof r.DocumentTouch),supportsPointerEvent:!!o.PointerEvent,isIOS:/iP(hone|od|ad)/.test(l.platform),isIOS7:/iP(hone|od|ad)/.test(l.platform)&&/OS 7[^\d]/.test(l.appVersion),isIe9:/MSIE 9/.test(l.userAgent),prefixedMatchesSelector:"matches"in a.prototype?"matches":"webkitMatchesSelector"in a.prototype?"webkitMatchesSelector":"mozMatchesSelector"in a.prototype?"mozMatchesSelector":"oMatchesSelector"in a.prototype?"oMatchesSelector":"msMatchesSelector",pEventTypes:o.PointerEvent?o.PointerEvent===r.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"}:null,wheelEvent:"onmousewheel"in o.document?"mousewheel":"wheel"};c.isOperaMobile=l.appName==="Opera"&&c.supportsTouch&&l.userAgent.match("Presto");t.exports=c},{"./domObjects":38,"./is":46,"./window":52}],37:[function(e,t,i){"use strict";var r=e("./is");t.exports=function e(t){var i={};for(var n in t){if(r.plainObject(t[n])){i[n]=e(t[n])}else{i[n]=t[n]}}return i}},{"./is":46}],38:[function(e,t,i){"use strict";var n={};var r=e("./window").window;function s(){}n.document=r.document;n.DocumentFragment=r.DocumentFragment||s;n.SVGElement=r.SVGElement||s;n.SVGSVGElement=r.SVGSVGElement||s;n.SVGElementInstance=r.SVGElementInstance||s;n.Element=r.Element||s;n.HTMLElement=r.HTMLElement||n.Element;n.Event=r.Event;n.Touch=r.Touch||s;n.PointerEvent=r.PointerEvent||r.MSPointerEvent;t.exports=n},{"./window":52}],39:[function(e,t,i){"use strict";var r=e("./window");var s=e("./browser");var o=e("./is");var h=e("./domObjects");var a={nodeContains:function e(t,i){while(i){if(i===t){return true}i=i.parentNode}return false},closest:function e(t,i){while(o.element(t)){if(a.matchesSelector(t,i)){return t}t=a.parentNode(t)}return null},parentNode:function e(t){var i=t.parentNode;if(o.docFrag(i)){while((i=i.host)&&o.docFrag(i)){continue}return i}return i},matchesSelector:function e(t,i){if(r.window!==r.realWindow){i=i.replace(/\/deep\//g," ")}return t[s.prefixedMatchesSelector](i)},indexOfDeepestElement:function e(t){var i=[];var n=[];var r=void 0;var s=t[0];var o=s?0:-1;var a=void 0;var l=void 0;var c=void 0;var u=void 0;for(c=1;c<t.length;c++){r=t[c];if(!r||r===s){continue}if(!s){s=r;o=c;continue}if(r.parentNode===r.ownerDocument){continue}else if(s.parentNode===r.ownerDocument){s=r;o=c;continue}if(!i.length){a=s;while(a.parentNode&&a.parentNode!==a.ownerDocument){i.unshift(a);a=a.parentNode}}if(s instanceof h.HTMLElement&&r instanceof h.SVGElement&&!(r instanceof h.SVGSVGElement)){if(r===s.parentNode){continue}a=r.ownerSVGElement}else{a=r}n=[];while(a.parentNode!==a.ownerDocument){n.unshift(a);a=a.parentNode}u=0;while(n[u]&&n[u]===i[u]){u++}var d=[n[u-1],n[u],i[u]];l=d[0].lastChild;while(l){if(l===d[1]){s=r;o=c;i=[];break}else if(l===d[2]){break}l=l.previousSibling}}return o},matchesUpTo:function e(t,i,n){while(o.element(t)){if(a.matchesSelector(t,i)){return true}t=a.parentNode(t);if(t===n){return a.matchesSelector(t,i)}}return false},getActualElement:function e(t){return t instanceof h.SVGElementInstance?t.correspondingUseElement:t},getScrollXY:function e(t){t=t||r.window;return{x:t.scrollX||t.document.documentElement.scrollLeft,y:t.scrollY||t.document.documentElement.scrollTop}},getElementClientRect:function e(t){var i=t instanceof h.SVGElement?t.getBoundingClientRect():t.getClientRects()[0];return i&&{left:i.left,right:i.right,top:i.top,bottom:i.bottom,width:i.width||i.right-i.left,height:i.height||i.bottom-i.top}},getElementRect:function e(t){var i=a.getElementClientRect(t);if(!s.isIOS7&&i){var n=a.getScrollXY(r.getWindow(t));i.left+=n.x;i.right+=n.x;i.top+=n.y;i.bottom+=n.y}return i},getPath:function e(t){var i=[];while(t){i.push(t);t=a.parentNode(t)}return i},trySelector:function e(t){if(!o.string(t)){return false}h.document.querySelector(t);return true}};t.exports=a},{"./browser":36,"./domObjects":38,"./is":46,"./window":52}],40:[function(e,t,i){"use strict";var v=e("./is");var y=e("./domUtils");var b=e("./pointerUtils");var C=e("./pointerExtend");var n=e("./window"),r=n.window;var s=e("./arr"),a=s.contains;var u=[];var d=[];var w={};var h=[];var p=function(){var e=false;r.document.createElement("div").addEventListener("test",null,{get capture(){e=true}});return e}();function f(e,t,i,n){var r=E(n);var s=u.indexOf(e);var o=d[s];if(!o){o={events:{},typeCount:0};s=u.push(e)-1;d.push(o)}if(!o.events[t]){o.events[t]=[];o.typeCount++}if(!a(o.events[t],i)){e.addEventListener(t,i,p?r:!!r.capture);o.events[t].push(i)}}function g(e,t,i,n){var r=E(n);var s=u.indexOf(e);var o=d[s];if(!o||!o.events){return}if(t==="all"){for(t in o.events){if(o.events.hasOwnProperty(t)){g(e,t,"all")}}return}if(o.events[t]){var a=o.events[t].length;if(i==="all"){for(var l=0;l<a;l++){g(e,t,o.events[t][l],r)}return}else{for(var c=0;c<a;c++){if(o.events[t][c]===i){e.removeEventListener("on"+t,i,p?r:!!r.capture);o.events[t].splice(c,1);break}}}if(o.events[t]&&o.events[t].length===0){o.events[t]=null;o.typeCount--}}if(!o.typeCount){d.splice(s,1);u.splice(s,1)}}function o(e,t,i,n,r){var s=E(r);if(!w[i]){w[i]={selectors:[],contexts:[],listeners:[]};for(var o=0;o<h.length;o++){var a=h[o];f(a,i,m);f(a,i,_,true)}}var l=w[i];var c=void 0;for(c=l.selectors.length-1;c>=0;c--){if(l.selectors[c]===e&&l.contexts[c]===t){break}}if(c===-1){c=l.selectors.length;l.selectors.push(e);l.contexts.push(t);l.listeners.push([])}l.listeners[c].push([n,!!s.capture,s.passive])}function l(e,t,i,n,r){var s=E(r);var o=w[i];var a=false;var l=void 0;if(!o){return}for(l=o.selectors.length-1;l>=0;l--){if(o.selectors[l]===e&&o.contexts[l]===t){var c=o.listeners[l];for(var u=c.length-1;u>=0;u--){var d=c[u],h=d[0],p=d[1],f=d[2];if(h===n&&p===!!s.capture&&f===s.passive){c.splice(u,1);if(!c.length){o.selectors.splice(l,1);o.contexts.splice(l,1);o.listeners.splice(l,1);g(t,i,m);g(t,i,_,true);if(!o.selectors.length){w[i]=null}}a=true;break}}if(a){break}}}}function m(e,t){var i=E(t);var n={};var r=w[e.type];var s=b.getEventTargets(e),o=s[0];var a=o;C(n,e);n.originalEvent=e;n.preventDefault=A;while(v.element(a)){for(var l=0;l<r.selectors.length;l++){var c=r.selectors[l];var u=r.contexts[l];if(y.matchesSelector(a,c)&&y.nodeContains(u,o)&&y.nodeContains(u,a)){var d=r.listeners[l];n.currentTarget=a;for(var h=0;h<d.length;h++){var p=d[h],f=p[0],g=p[1],m=p[2];if(g===!!i.capture&&m===i.passive){f(n)}}}}a=y.parentNode(a)}}function _(e){return m.call(this,e,true)}function A(){this.originalEvent.preventDefault()}function E(e){return v.object(e)?e:{capture:e}}t.exports={add:f,remove:g,addDelegate:o,removeDelegate:l,delegateListener:m,delegateUseCapture:_,delegatedEvents:w,documents:h,supportsOptions:p,_elements:u,_targets:d}},{"./arr":35,"./domUtils":39,"./is":46,"./pointerExtend":48,"./pointerUtils":49,"./window":52}],41:[function(e,t,i){"use strict";t.exports=function e(t,i){for(var n in i){t[n]=i[n]}return t}},{}],42:[function(e,t,i){"use strict";var n=e("./rect"),a=n.resolveRectLike,l=n.rectToXY;t.exports=function(e,t,i){var n=e.options[i];var r=n&&n.origin;var s=r||e.options.origin;var o=a(s,e,t,[e&&t]);return l(o)||{x:0,y:0}}},{"./rect":51}],43:[function(e,t,i){"use strict";t.exports=function(e,t){return Math.sqrt(e*e+t*t)}},{}],44:[function(e,t,i){"use strict";var n=e("./extend");var r=e("./window");var l={warnOnce:function e(t,i){var n=false;return function(){if(!n){r.window.console.warn(i);n=true}return t.apply(this,arguments)}},_getQBezierValue:function e(t,i,n,r){var s=1-t;return s*s*i+2*s*t*n+t*t*r},getQuadraticCurvePoint:function e(t,i,n,r,s,o,a){return{x:l._getQBezierValue(a,t,n,s),y:l._getQBezierValue(a,i,r,o)}},easeOutQuad:function e(t,i,n,r){t/=r;return-n*t*(t-2)+i},copyAction:function e(t,i){t.name=i.name;t.axis=i.axis;t.edges=i.edges;return t},is:e("./is"),extend:n,hypot:e("./hypot"),getOriginXY:e("./getOriginXY")};n(l,e("./arr"));n(l,e("./domUtils"));n(l,e("./pointerUtils"));n(l,e("./rect"));t.exports=l},{"./arr":35,"./domUtils":39,"./extend":41,"./getOriginXY":42,"./hypot":43,"./is":46,"./pointerUtils":49,"./rect":51,"./window":52}],45:[function(e,t,i){"use strict";var h=e("../scope");var p=e("./index");var d={methodOrder:["simulationResume","mouseOrPen","hasPointer","idle"],search:function e(t,i,n){var r=p.getPointerType(t);var s=p.getPointerId(t);var o={pointer:t,pointerId:s,pointerType:r,eventType:i,eventTarget:n};for(var a=0;a<d.methodOrder.length;a++){var l;l=d.methodOrder[a];var c=l;var u=d[c](o);if(u){return u}}},simulationResume:function e(t){var i=t.pointerType,n=t.eventType,r=t.eventTarget;if(!/down|start/i.test(n)){return null}for(var s=0;s<h.interactions.length;s++){var o;o=h.interactions[s];var a=o;var l=r;if(a.simulation&&a.simulation.allowResume&&a.pointerType===i){while(l){if(l===a.element){return a}l=p.parentNode(l)}}}return null},mouseOrPen:function e(t){var i=t.pointerId,n=t.pointerType,r=t.eventType;if(n!=="mouse"&&n!=="pen"){return null}var s=void 0;for(var o=0;o<h.interactions.length;o++){var a;a=h.interactions[o];var l=a;if(l.pointerType===n){if(l.simulation&&!p.contains(l.pointerIds,i)){continue}if(l.interacting()){return l}else if(!s){s=l}}}if(s){return s}for(var c=0;c<h.interactions.length;c++){var u;u=h.interactions[c];var d=u;if(d.pointerType===n&&!(/down/i.test(r)&&d.simulation)){return d}}return null},hasPointer:function e(t){var i=t.pointerId;for(var n=0;n<h.interactions.length;n++){var r;r=h.interactions[n];var s=r;if(p.contains(s.pointerIds,i)){return s}}},idle:function e(t){var i=t.pointerType;for(var n=0;n<h.interactions.length;n++){var r;r=h.interactions[n];var s=r;if(s.pointerIds.length===1){var o=s.target;if(o&&!o.options.gesture.enabled){continue}}else if(s.pointerIds.length>=2){continue}if(!s.interacting()&&i===s.pointerType){return s}}return null}};t.exports=d},{"../scope":33,"./index":44}],46:[function(e,t,i){"use strict";var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var r=e("./window");var s=e("./isWindow");var o={array:function e(){},window:function e(t){return t===r.window||s(t)},docFrag:function e(t){return o.object(t)&&t.nodeType===11},object:function e(t){return!!t&&(typeof t==="undefined"?"undefined":n(t))==="object"},function:function e(t){return typeof t==="function"},number:function e(t){return typeof t==="number"},bool:function e(t){return typeof t==="boolean"},string:function e(t){return typeof t==="string"},element:function e(t){if(!t||(typeof t==="undefined"?"undefined":n(t))!=="object"){return false}var i=r.getWindow(t)||r.window;return/object|function/.test(n(i.Element))?t instanceof i.Element:t.nodeType===1&&typeof t.nodeName==="string"},plainObject:function e(t){return o.object(t)&&t.constructor.name==="Object"}};o.array=function(e){return o.object(e)&&typeof e.length!=="undefined"&&o.function(e.splice)};t.exports=o},{"./isWindow":47,"./window":52}],47:[function(e,t,i){"use strict";t.exports=function(e){return!!(e&&e.Window)&&e instanceof e.Window}},{}],48:[function(e,o,t){"use strict";function i(e,t){for(var i in t){var n=o.exports.prefixedPropREs;var r=false;for(var s in n){if(i.indexOf(s)===0&&n[s].test(i)){r=true;break}}if(!r&&typeof t[i]!=="function"){e[i]=t[i]}}return e}i.prefixedPropREs={webkit:/(Movement[XY]|Radius[XY]|RotationAngle|Force)$/};o.exports=i},{}],49:[function(e,t,i){"use strict";var l=e("./hypot");var n=e("./browser");var r=e("./domObjects");var s=e("./domUtils");var o=e("./domObjects");var a=e("./is");var c=e("./pointerExtend");var u={copyCoords:function e(t,i){t.page=t.page||{};t.page.x=i.page.x;t.page.y=i.page.y;t.client=t.client||{};t.client.x=i.client.x;t.client.y=i.client.y;t.timeStamp=i.timeStamp},setCoordDeltas:function e(t,i,n){t.page.x=n.page.x-i.page.x;t.page.y=n.page.y-i.page.y;t.client.x=n.client.x-i.client.x;t.client.y=n.client.y-i.client.y;t.timeStamp=n.timeStamp-i.timeStamp;var r=Math.max(t.timeStamp/1e3,.001);t.page.speed=l(t.page.x,t.page.y)/r;t.page.vx=t.page.x/r;t.page.vy=t.page.y/r;t.client.speed=l(t.client.x,t.page.y)/r;t.client.vx=t.client.x/r;t.client.vy=t.client.y/r},isNativePointer:function e(t){return t instanceof r.Event||t instanceof r.Touch},getXY:function e(t,i,n){n=n||{};t=t||"page";n.x=i[t+"X"];n.y=i[t+"Y"];return n},getPageXY:function e(t,i){i=i||{};if(n.isOperaMobile&&u.isNativePointer(t)){u.getXY("screen",t,i);i.x+=window.scrollX;i.y+=window.scrollY}else{u.getXY("page",t,i)}return i},getClientXY:function e(t,i){i=i||{};if(n.isOperaMobile&&u.isNativePointer(t)){u.getXY("screen",t,i)}else{u.getXY("client",t,i)}return i},getPointerId:function e(t){return a.number(t.pointerId)?t.pointerId:t.identifier},setCoords:function e(t,i,n){var r=i.length>1?u.pointerAverage(i):i[0];var s={};u.getPageXY(r,s);t.page.x=s.x;t.page.y=s.y;u.getClientXY(r,s);t.client.x=s.x;t.client.y=s.y;t.timeStamp=a.number(n)?n:(new Date).getTime()},pointerExtend:c,getTouchPair:function e(t){var i=[];if(a.array(t)){i[0]=t[0];i[1]=t[1]}else{if(t.type==="touchend"){if(t.touches.length===1){i[0]=t.touches[0];i[1]=t.changedTouches[0]}else if(t.touches.length===0){i[0]=t.changedTouches[0];i[1]=t.changedTouches[1]}}else{i[0]=t.touches[0];i[1]=t.touches[1]}}return i},pointerAverage:function e(t){var i={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0};for(var n=0;n<t.length;n++){var r;r=t[n];var s=r;for(var o in i){i[o]+=s[o]}}for(var a in i){i[a]/=t.length}return i},touchBBox:function e(t){if(!t.length&&!(t.touches&&t.touches.length>1)){return}var i=u.getTouchPair(t);var n=Math.min(i[0].pageX,i[1].pageX);var r=Math.min(i[0].pageY,i[1].pageY);var s=Math.max(i[0].pageX,i[1].pageX);var o=Math.max(i[0].pageY,i[1].pageY);return{x:n,y:r,left:n,top:r,width:s-n,height:o-r}},touchDistance:function e(t,i){var n=i+"X";var r=i+"Y";var s=u.getTouchPair(t);var o=s[0][n]-s[1][n];var a=s[0][r]-s[1][r];return l(o,a)},touchAngle:function e(t,i,n){var r=n+"X";var s=n+"Y";var o=u.getTouchPair(t);var a=o[1][r]-o[0][r];var l=o[1][s]-o[0][s];var c=180*Math.atan2(l,a)/Math.PI;return c},getPointerType:function e(t){return a.string(t.pointerType)?t.pointerType:a.number(t.pointerType)?[undefined,undefined,"touch","pen","mouse"][t.pointerType]:/touch/.test(t.type)||t instanceof o.Touch?"touch":"mouse"},getEventTargets:function e(t){var i=a.function(t.composedPath)?t.composedPath():t.path;return[s.getActualElement(i?i[0]:t.target),s.getActualElement(t.currentTarget)]}};t.exports=u},{"./browser":36,"./domObjects":38,"./domUtils":39,"./hypot":43,"./is":46,"./pointerExtend":48}],50:[function(e,t,i){"use strict";var n=e("./window"),r=n.window;var s=["ms","moz","webkit","o"];var o=0;var a=void 0;var l=void 0;for(var c=0;c<s.length&&!r.requestAnimationFrame;c++){a=r[s[c]+"RequestAnimationFrame"];l=r[s[c]+"CancelAnimationFrame"]||r[s[c]+"CancelRequestAnimationFrame"]}if(!a){a=function e(t){var i=(new Date).getTime();var n=Math.max(0,16-(i-o));var r=setTimeout(function(){t(i+n)},n);o=i+n;return r}}if(!l){l=function e(t){clearTimeout(t)}}t.exports={request:a,cancel:l}},{"./window":52}],51:[function(e,t,i){"use strict";var n=e("./extend");var s=e("./is");var r=e("./domUtils"),o=r.closest,a=r.parentNode,l=r.getElementRect;var c={getStringOptionResult:function e(t,i,n){if(!s.string(t)){return null}if(t==="parent"){t=a(n)}else if(t==="self"){t=i.getRect(n)}else{t=o(n,t)}return t},resolveRectLike:function e(t,i,n,r){t=c.getStringOptionResult(t,i,n)||t;if(s.function(t)){t=t.apply(null,r)}if(s.element(t)){t=l(t)}return t},rectToXY:function e(t){return t&&{x:"x"in t?t.x:t.left,y:"y"in t?t.y:t.top}},xywhToTlbr:function e(t){if(t&&!("left"in t&&"top"in t)){t=n({},t);t.left=t.x||0;t.top=t.y||0;t.right=t.right||t.left+t.width;t.bottom=t.bottom||t.top+t.height}return t},tlbrToXywh:function e(t){if(t&&!("x"in t&&"y"in t)){t=n({},t);t.x=t.left||0;t.top=t.top||0;t.width=t.width||t.right-t.x;t.height=t.height||t.bottom-t.y}return t}};t.exports=c},{"./domUtils":39,"./extend":41,"./is":46}],52:[function(e,t,i){"use strict";var n=t.exports;var r=e("./isWindow");function s(e){n.realWindow=e;var t=e.document.createTextNode("");if(t.ownerDocument!==e.document&&typeof e.wrap==="function"&&e.wrap(t)===t){e=e.wrap(e)}n.window=e}if(typeof window==="undefined"){n.window=undefined;n.realWindow=undefined}else{s(window)}n.getWindow=function e(t){if(r(t)){return t}var i=t.ownerDocument||t;return i.defaultView||i.parentWindow||n.window};n.init=s},{"./isWindow":47}]},{},[1])(1)});"undefined"==typeof jQuery.migrateMute&&(jQuery.migrateMute=!0),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(e){return t(e,window)}):"object"==typeof module&&module.exports?module.exports=t(require("jquery"),window):t(jQuery,window)}(function(a,n){"use strict";function e(e){return 0<=function(e,t){for(var i=/^(\d+)\.(\d+)\.(\d+)/,n=i.exec(e)||[],r=i.exec(t)||[],s=1;s<=3;s++){if(+r[s]<+n[s])return 1;if(+n[s]<+r[s])return-1}return 0}(a.fn.jquery,e)}a.migrateVersion="3.3.2",n.console&&n.console.log&&(a&&e("3.0.0")||n.console.log("JQMIGRATE: jQuery 3.0.0+ REQUIRED"),a.migrateWarnings&&n.console.log("JQMIGRATE: Migrate plugin loaded multiple times"),n.console.log("JQMIGRATE: Migrate is installed"+(a.migrateMute?"":" with logging active")+", version "+a.migrateVersion));var i={};function l(e){var t=n.console;a.migrateDeduplicateWarnings&&i[e]||(i[e]=!0,a.migrateWarnings.push(e),t&&t.warn&&!a.migrateMute&&(t.warn("JQMIGRATE: "+e),a.migrateTrace&&t.trace&&t.trace()))}function t(e,t,i,n){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){return l(n),i},set:function(e){l(n),i=e}})}function r(e,t,i,n){e[t]=function(){return l(n),i.apply(this,arguments)}}a.migrateDeduplicateWarnings=!0,a.migrateWarnings=[],void 0===a.migrateTrace&&(a.migrateTrace=!0),a.migrateReset=function(){i={},a.migrateWarnings.length=0},"BackCompat"===n.document.compatMode&&l("jQuery is not compatible with Quirks Mode");var s,o,c,u={},d=a.fn.init,h=a.find,p=/\[(\s*[-\w]+\s*)([~|^$*]?=)\s*([-\w#]*?#[-\w#]*)\s*\]/,f=/\[(\s*[-\w]+\s*)([~|^$*]?=)\s*([-\w#]*?#[-\w#]*)\s*\]/g,g=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;for(s in a.fn.init=function(e){var t=Array.prototype.slice.call(arguments);return"string"==typeof e&&"#"===e&&(l("jQuery( '#' ) is not a valid selector"),t[0]=[]),d.apply(this,t)},a.fn.init.prototype=a.fn,a.find=function(t){var i=Array.prototype.slice.call(arguments);if("string"==typeof t&&p.test(t))try{n.document.querySelector(t)}catch(e){t=t.replace(f,function(e,t,i,n){return"["+t+i+'"'+n+'"]'});try{n.document.querySelector(t),l("Attribute selector with '#' must be quoted: "+i[0]),i[0]=t}catch(e){l("Attribute selector with '#' was not fixed: "+i[0])}}return h.apply(this,i)},h)Object.prototype.hasOwnProperty.call(h,s)&&(a.find[s]=h[s]);r(a.fn,"size",function(){return this.length},"jQuery.fn.size() is deprecated and removed; use the .length property"),r(a,"parseJSON",function(){return JSON.parse.apply(null,arguments)},"jQuery.parseJSON is deprecated; use JSON.parse"),r(a,"holdReady",a.holdReady,"jQuery.holdReady is deprecated"),r(a,"unique",a.uniqueSort,"jQuery.unique is deprecated; use jQuery.uniqueSort"),t(a.expr,"filters",a.expr.pseudos,"jQuery.expr.filters is deprecated; use jQuery.expr.pseudos"),t(a.expr,":",a.expr.pseudos,"jQuery.expr[':'] is deprecated; use jQuery.expr.pseudos"),e("3.1.1")&&r(a,"trim",function(e){return null==e?"":(e+"").replace(g,"")},"jQuery.trim is deprecated; use String.prototype.trim"),e("3.2.0")&&(r(a,"nodeName",function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},"jQuery.nodeName is deprecated"),r(a,"isArray",Array.isArray,"jQuery.isArray is deprecated; use Array.isArray")),e("3.3.0")&&(r(a,"isNumeric",function(e){var t=typeof e;return("number"==t||"string"==t)&&!isNaN(e-parseFloat(e))},"jQuery.isNumeric() is deprecated"),a.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){u["[object "+t+"]"]=t.toLowerCase()}),r(a,"type",function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?u[Object.prototype.toString.call(e)]||"object":typeof e},"jQuery.type is deprecated"),r(a,"isFunction",function(e){return"function"==typeof e},"jQuery.isFunction() is deprecated"),r(a,"isWindow",function(e){return null!=e&&e===e.window},"jQuery.isWindow() is deprecated")),a.ajax&&(o=a.ajax,c=/(=)\?(?=&|$)|\?\?/,a.ajax=function(){var e=o.apply(this,arguments);return e.promise&&(r(e,"success",e.done,"jQXHR.success is deprecated and removed"),r(e,"error",e.fail,"jQXHR.error is deprecated and removed"),r(e,"complete",e.always,"jQXHR.complete is deprecated and removed")),e},e("4.0.0")||a.ajaxPrefilter("+json",function(e){!1!==e.jsonp&&(c.test(e.url)||"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&c.test(e.data))&&l("JSON-to-JSONP auto-promotion is deprecated")}));var m=a.fn.removeAttr,v=a.fn.toggleClass,y=/\S+/g;function b(e){return e.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()})}a.fn.removeAttr=function(e){var i=this;return a.each(e.match(y),function(e,t){a.expr.match.bool.test(t)&&(l("jQuery.fn.removeAttr no longer sets boolean properties: "+t),i.prop(t,!1))}),m.apply(this,arguments)};var C,w=!(a.fn.toggleClass=function(t){return void 0!==t&&"boolean"!=typeof t?v.apply(this,arguments):(l("jQuery.fn.toggleClass( boolean ) is deprecated"),this.each(function(){var e=this.getAttribute&&this.getAttribute("class")||"";e&&a.data(this,"__className__",e),this.setAttribute&&this.setAttribute("class",!e&&!1!==t&&a.data(this,"__className__")||"")}))}),_=/^[a-z]/,A=/^(?:Border(?:Top|Right|Bottom|Left)?(?:Width|)|(?:Margin|Padding)?(?:Top|Right|Bottom|Left)?|(?:Min|Max)?(?:Width|Height))$/;a.swap&&a.each(["height","width","reliableMarginRight"],function(e,t){var i=a.cssHooks[t]&&a.cssHooks[t].get;i&&(a.cssHooks[t].get=function(){var e;return w=!0,e=i.apply(this,arguments),w=!1,e})}),a.swap=function(e,t,i,n){var r,s,o={};for(s in w||l("jQuery.swap() is undocumented and deprecated"),t)o[s]=e.style[s],e.style[s]=t[s];for(s in r=i.apply(e,n||[]),t)e.style[s]=o[s];return r},e("3.4.0")&&"undefined"!=typeof Proxy&&(a.cssProps=new Proxy(a.cssProps||{},{set:function(){return l("JQMIGRATE: jQuery.cssProps is deprecated"),Reflect.set.apply(this,arguments)}})),a.cssNumber||(a.cssNumber={}),C=a.fn.css,a.fn.css=function(e,t){var i,n,r=this;return e&&"object"==typeof e&&!Array.isArray(e)?(a.each(e,function(e,t){a.fn.css.call(r,e,t)}),this):("number"==typeof t&&(i=b(e),n=i,_.test(n)&&A.test(n[0].toUpperCase()+n.slice(1))||a.cssNumber[i]||l('Number-typed values are deprecated for jQuery.fn.css( "'+e+'", value )')),C.apply(this,arguments))};var E,S,T,x,D=a.data;a.data=function(e,t,i){var n,r,s;if(t&&"object"==typeof t&&2===arguments.length){for(s in n=a.hasData(e)&&D.call(this,e),r={},t)s!==b(s)?(l("jQuery.data() always sets/gets camelCased names: "+s),n[s]=t[s]):r[s]=t[s];return D.call(this,e,r),t}return t&&"string"==typeof t&&t!==b(t)&&(n=a.hasData(e)&&D.call(this,e))&&t in n?(l("jQuery.data() always sets/gets camelCased names: "+t),2<arguments.length&&(n[t]=i),n[t]):D.apply(this,arguments)},a.fx&&(T=a.Tween.prototype.run,x=function(e){return e},a.Tween.prototype.run=function(){1<a.easing[this.easing].length&&(l("'jQuery.easing."+this.easing.toString()+"' should use only one argument"),a.easing[this.easing]=x),T.apply(this,arguments)},E=a.fx.interval||13,S="jQuery.fx.interval is deprecated",n.requestAnimationFrame&&Object.defineProperty(a.fx,"interval",{configurable:!0,enumerable:!0,get:function(){return n.document.hidden||l(S),E},set:function(e){l(S),E=e}}));var R=a.fn.load,L=a.event.add,F=a.event.fix;a.event.props=[],a.event.fixHooks={},t(a.event.props,"concat",a.event.props.concat,"jQuery.event.props.concat() is deprecated and removed"),a.event.fix=function(e){var t,i=e.type,n=this.fixHooks[i],r=a.event.props;if(r.length){l("jQuery.event.props are deprecated and removed: "+r.join());while(r.length)a.event.addProp(r.pop())}if(n&&!n._migrated_&&(n._migrated_=!0,l("jQuery.event.fixHooks are deprecated and removed: "+i),(r=n.props)&&r.length))while(r.length)a.event.addProp(r.pop());return t=F.call(this,e),n&&n.filter?n.filter(t,e):t},a.event.add=function(e,t){return e===n&&"load"===t&&"complete"===n.document.readyState&&l("jQuery(window).on('load'...) called after load event occurred"),L.apply(this,arguments)},a.each(["load","unload","error"],function(e,t){a.fn[t]=function(){var e=Array.prototype.slice.call(arguments,0);return"load"===t&&"string"==typeof e[0]?R.apply(this,e):(l("jQuery.fn."+t+"() is deprecated"),e.splice(0,0,t),arguments.length?this.on.apply(this,e):(this.triggerHandler.apply(this,e),this))}}),a.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,i){a.fn[i]=function(e,t){return l("jQuery.fn."+i+"() event shorthand is deprecated"),0<arguments.length?this.on(i,null,e,t):this.trigger(i)}}),a(function(){a(n.document).triggerHandler("ready")}),a.event.special.ready={setup:function(){this===n.document&&l("'ready' event is deprecated")}},a.fn.extend({bind:function(e,t,i){return l("jQuery.fn.bind() is deprecated"),this.on(e,null,t,i)},unbind:function(e,t){return l("jQuery.fn.unbind() is deprecated"),this.off(e,null,t)},delegate:function(e,t,i,n){return l("jQuery.fn.delegate() is deprecated"),this.on(t,e,i,n)},undelegate:function(e,t,i){return l("jQuery.fn.undelegate() is deprecated"),1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},hover:function(e,t){return l("jQuery.fn.hover() is deprecated"),this.on("mouseenter",e).on("mouseleave",t||e)}});function M(e){var t=n.document.implementation.createHTMLDocument("");return t.body.innerHTML=e,t.body&&t.body.innerHTML}function N(e){var t=e.replace(O,"<$1></$2>");t!==e&&M(e)!==M(t)&&l("HTML tags must be properly nested and closed: "+e)}var O=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,G=a.htmlPrefilter;a.UNSAFE_restoreLegacyHtmlPrefilter=function(){a.htmlPrefilter=function(e){return N(e),e.replace(O,"<$1></$2>")}},a.htmlPrefilter=function(e){return N(e),G(e)};var I,$=a.fn.offset;a.fn.offset=function(){var e=this[0];return!e||e.nodeType&&e.getBoundingClientRect?$.apply(this,arguments):(l("jQuery.fn.offset() requires a valid DOM element"),arguments.length?this:void 0)},a.ajax&&(I=a.param,a.param=function(e,t){var i=a.ajaxSettings&&a.ajaxSettings.traditional;return void 0===t&&i&&(l("jQuery.param() no longer uses jQuery.ajaxSettings.traditional"),t=i),I.call(this,e,t)});var P,k,H=a.fn.andSelf||a.fn.addBack;return a.fn.andSelf=function(){return l("jQuery.fn.andSelf() is deprecated and removed, use jQuery.fn.addBack()"),H.apply(this,arguments)},a.Deferred&&(P=a.Deferred,k=[["resolve","done",a.Callbacks("once memory"),a.Callbacks("once memory"),"resolved"],["reject","fail",a.Callbacks("once memory"),a.Callbacks("once memory"),"rejected"],["notify","progress",a.Callbacks("memory"),a.Callbacks("memory")]],a.Deferred=function(e){var s=P(),o=s.promise();return s.pipe=o.pipe=function(){var r=arguments;return l("deferred.pipe() is deprecated"),a.Deferred(function(n){a.each(k,function(e,t){var i="function"==typeof r[e]&&r[e];s[t[1]](function(){var e=i&&i.apply(this,arguments);e&&"function"==typeof e.promise?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[t[0]+"With"](this===o?n.promise():this,i?[e]:arguments)})}),r=null}).promise()},e&&e.call(s,s),s},a.Deferred.exceptionHook=P.exceptionHook),a});